# StackOverflow 问答 10390000-10390999

# ios - NSString componentsSeparatedByString "&" 但忽略 "& amp;"

> ID：10390003
> 
> 赞同：3
> 
> 时间：2012-04-30T20:16:14.137
> 
> 标签：ios, objective-c, nsstring

需要分隔一个字符串 on`&`但不是 on `&amp;`。

有没有一种更优雅的方式来编写代码，而不是先替换它然后将它分开`&`？像这样...

```
query = [query stringByReplacingOccurrencesOfString:@"&amp;" withString:@"~~~"];
NSArray * kvpairs = [query componentsSeparatedByString:@"&"];

NSMutableArray *mArr = [[NSMutableArray alloc] init];
for (NSString *kvp in kvpairs) {
    [mArr addObject:[kvp stringByReplacingOccurrencesOfString:@"~~~" withString:@"&amp;"]];
}
kvpairs = [NSArray arrayWithArray:mArr];
[mArr release]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:11:08.813

您可以使用来枚举匹配但不[`NSRegularExpression`](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)匹配的正则表达式上的字符串，例如：. 这将比您当前的方法更麻烦但更准确，因为它可以在不修改原始字符串的情况下工作并且不依赖于令牌值。`&``&amp;``@"&(?!amp;)"`

如果你控制了这个方法的输入，并且可以保证`~~~`不会正常出现，那么使用`~~~`. 但是，如果您*不*控制输入，那么您应该尝试在不修改的情况下解析字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:24:02.070

这并没有什么问题，只要您 100% 确定该字符串`~~~`不会出现在您的查询中。

如果不是，我的下一步将是实现一种将字符串解析为数组的方法。在这种方法中，您可以找到每个 &，然后检查它是否跟在 amp; 后面。如果是，请继续下一个，如果不是，请剪断那里的绳子并重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:26:59.850

HTML 实体和引用确实不是在 URL 中闲逛的好东西。除非有**很好**的理由**必须**使用 HTML 实体，否则我建议在 URL 中使用 '%26' 对 & 符号进行编码。

话虽如此，如果 '&' 不是唯一的 HTML 实体或引用，您将遇到问题，因此除非您绝对确定 '&' 是唯一的，否则您将需要更强大的解决方案。

# ruby-on-rails - 在 Mac os X 10.6.8 上安装 Rails？

> ID：10390006
> 
> 赞同：1
> 
> 时间：2012-04-30T20:16:52.700
> 
> 标签：ruby-on-rails, ruby, macos, installation

我是 Ruby on Rails 的新手，我正在尝试在 mac os x 10.6.8 上安装 rails（我已经有`ruby: ruby 1.8.7 (2010-01-10 patchlevel 249) [universal-darwin10.0]`），但是当我尝试查看使用安装的 rails 版本时`$ rails -v`，我得到：

```
rails is not currently installed on this system. To get the latest version, simply type: 
```

我试图运行：

```
$ sudo gem install rails 
```

然后，您可以重新运行“rails”命令。

当然，我也尝试输入 sudo gem install rails 和其他选项，但没有解决方案，我也尝试安装 rvm，这就是我所拥有的：

```
$ rvm -v

rvm 1.13.0 (master) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/] 
```

我该怎么做才能让它一起工作？或者我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T20:19:30.613

好的，我在这里查看说明：[http ://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec:up_and_running](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec:up_and_running)

根据您的评论，您的系统上没有安装正确版本的 ruby​​。

```
rvm get head && rvm reload
rvm install 1.9.3
rvm use 1.9.3@current --create --default 
```

最后一行创建了一个名为`current`.

`which gem`现在检查以确保通过在终端中键入 RubyGems 已正确安装。现在更新你的宝石。

```
gem update --system 1.8.24 
```

最后安装导轨。

```
gem install rails -v 3.2.3 
```

我希望这有效，如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T03:53:30.943

运行 OSX 10.7.4 时我遇到了同样的问题。我用以下方法解决了它。

确定您正在使用的 gem 管理器：

```
$ which gem 
/Users/peter/.rvm/ruby-1.9.2-p320/bin/gem 
```

然后对该特定版本进行 gem 更新：

```
$ gem update --system 1.9.2 
```

这需要很长时间才能完成，但一旦完成，就会`rails -v`返回：

```
Rails 3.2.8 
```

诚然，生活不应该如此艰难。虽然我习惯使用命令行的东西，但我希望看到一个图形工具，它允许您混合、匹配和确认您的系统上安装了哪些 Ruby/Gems。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T01:18:02.580

我在 OSX 上使用[Rails Ready脚本非常幸运。](https://github.com/joshfng/railsready)不能从个人经验中谈论 Lion，但它在 Snow Leopard 上总是很有效。

# linux - 使用外部 redis 服务器测试 tcl 脚本

> ID：10390008
> 
> 赞同：2
> 
> 时间：2012-04-30T20:16:54.283
> 
> 标签：linux, testing, redis, tcl

我正在运行 Ubuntu 11.10。

我正在尝试使用外部 redis 服务器运行 TCL 测试脚本。

使用以下内容：

```
sb@sb-laptop:~/Redis/redis$ tclsh tests/test_helper.tcl --host 192.168.1.130 --port 6379 
```

收到以下错误：

```
 Testing unit/type/list
[exception]: Executing test client: couldn't open socket: connection refused.
couldn't open socket: connection refused
    while executing
"socket $server $port"
    (procedure "redis" line 2)
    invoked from within
"redis $::host $::port"
    (procedure "start_server" line 9)
    invoked from within
"start_server {tags {"protocol"}} {
    test "Handle an empty query" {
        reconnect
        r write "\r\n"
        r flush
        assert_equal "P..."
    (file "tests/unit/protocol.tcl" line 1)
    invoked from within
"source $path"
    (procedure "execute_tests" line 4)
    invoked from within
"execute_tests $data"
    (procedure "test_client_main" line 9)
    invoked from within
"test_client_main $::test_server_port " 
```

设置为`redis.conf`默认绑定，但它被注释掉了。

如果这是可能的，我做错了什么？

附加信息：

下面是负责启动服务器的tcl代码

```
proc start_server {options {code undefined}} {
    # If we are runnign against an external server, we just push the
    # host/port pair in the stack the first time
    if {$::external} {
        if {[llength $::servers] == 0} {
            set srv {}
            dict set srv "host" $::host
            dict set srv "port" $::port
            set client [redis $::host $::port]
            dict set srv "client" $client
            $client select 9

            # append the server to the stack
            lappend ::servers $srv
        }
        uplevel 1 $code
        return
    }

    # setup defaults
    set baseconfig "default.conf"
    set overrides {}
    set tags {}

    # parse options
    foreach {option value} $options {
        switch $option {
            "config" {
                set baseconfig $value }
            "overrides" {
                set overrides $value }
            "tags" {
                set tags $value
                set ::tags [concat $::tags $value] }
            default {
                error "Unknown option $option" }
        }
    }

    set data [split [exec cat "tests/assets/$baseconfig"] "\n"]
    set config {}
    foreach line $data {
        if {[string length $line] > 0 && [string index $line 0] ne "#"} {
            set elements [split $line " "]
            set directive [lrange $elements 0 0]
            set arguments [lrange $elements 1 end]
            dict set config $directive $arguments
        }
    }

    # use a different directory every time a server is started
    dict set config dir [tmpdir server]

    # start every server on a different port
    set ::port [find_available_port [expr {$::port+1}]]
    dict set config port $::port

    # apply overrides from global space and arguments
    foreach {directive arguments} [concat $::global_overrides $overrides] {
        dict set config $directive $arguments
    }

    # write new configuration to temporary file
    set config_file [tmpfile redis.conf]
    set fp [open $config_file w+]
    foreach directive [dict keys $config] {
        puts -nonewline $fp "$directive "
        puts $fp [dict get $config $directive]
    }
    close $fp

    set stdout [format "%s/%s" [dict get $config "dir"] "stdout"]
    set stderr [format "%s/%s" [dict get $config "dir"] "stderr"]

    if {$::valgrind} {
        exec valgrind --suppressions=src/valgrind.sup src/redis-server $config_file > $stdout 2> $stderr &
    } else {
        exec src/redis-server $config_file > $stdout 2> $stderr &
    }

    # check that the server actually started
    # ugly but tries to be as fast as possible...
    set retrynum 100
    set serverisup 0

    if {$::verbose} {
        puts -nonewline "=== ($tags) Starting server ${::host}:${::port} "
    }

    after 10
    if {$code ne "undefined"} {
        while {[incr retrynum -1]} {
            catch {
                if {[ping_server $::host $::port]} {
                    set serverisup 1
                }
            }
            if {$serverisup} break
            after 50
        }
    } else {
        set serverisup 1
    }

    if {$::verbose} {
        puts ""
    }

    if {!$serverisup} {
        error_and_quit $config_file [exec cat $stderr]
    }

    # find out the pid
    while {![info exists pid]} {
        regexp {\[(\d+)\]} [exec cat $stdout] _ pid
        after 100
    }

    # setup properties to be able to initialize a client object
    set host $::host
    set port $::port
    if {[dict exists $config bind]} { set host [dict get $config bind] }
    if {[dict exists $config port]} { set port [dict get $config port] }

    # setup config dict
    dict set srv "config_file" $config_file
    dict set srv "config" $config
    dict set srv "pid" $pid
    dict set srv "host" $host
    dict set srv "port" $port
    dict set srv "stdout" $stdout
    dict set srv "stderr" $stderr

    # if a block of code is supplied, we wait for the server to become
    # available, create a client object and kill the server afterwards
    if {$code ne "undefined"} {
        set line [exec head -n1 $stdout]
        if {[string match {*already in use*} $line]} {
            error_and_quit $config_file $line
        }

        while 1 {
            # check that the server actually started and is ready for connections
            if {[exec cat $stdout | grep "ready to accept" | wc -l] > 0} {
                break
            }
            after 10
        }

        # append the server to the stack
        lappend ::servers $srv

        # connect client (after server dict is put on the stack)
        reconnect

        # execute provided block
        set num_tests $::num_tests
        if {[catch { uplevel 1 $code } error]} {
            set backtrace $::errorInfo

            # Kill the server without checking for leaks
            dict set srv "skipleaks" 1
            kill_server $srv

            # Print warnings from log
            puts [format "\nLogged warnings (pid %d):" [dict get $srv "pid"]]
            set warnings [warnings_from_file [dict get $srv "stdout"]]
            if {[string length $warnings] > 0} {
                puts "$warnings"
            } else {
                puts "(none)"
            }
            puts ""

            error $error $backtrace
        }

        # Don't do the leak check when no tests were run
        if {$num_tests == $::num_tests} {
            dict set srv "skipleaks" 1
        }

        # pop the server object
        set ::servers [lrange $::servers 0 end-1]

        set ::tags [lrange $::tags 0 end-[llength $tags]]
        kill_server $srv
    } else {
        set ::tags [lrange $::tags 0 end-[llength $tags]]
        set _ $srv
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:01:15.430

要么没有在 host `192.168.1.130`， port上监听`6379`（好吧，猜测），要么你的防火墙配置阻止了连接。不可能说哪个，因为所有代码*真正*看到的是“连接不起作用；某事说‘不’……”。

# javascript - 选择/突出显示文本时触发 jQuery .click()

> ID：10390010
> 
> 赞同：37
> 
> 时间：2012-04-30T20:17:08.943
> 
> 标签：javascript, jquery, javascript-events

我有`<div>`一堆文字。这`<div>`也有一个`.click()`使用 jQuery 的事件。

我遇到的问题是`.click()`在选择/突出显示文本时被触发。甚至在松开鼠标之前按住鼠标几秒钟。

这是一个显示问题的 JSFiddle：http: [//jsfiddle.net/ym5JX/](http://jsfiddle.net/ym5JX/)

我期望的行为是突出显示文本与单击元素不同。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-04-30T20:23:42.633

那是因为 a`click`是 a`mousedown`后跟 a `mouseup`。我的建议是检查处理程序[`getSelection`](https://developer.mozilla.org/en/DOM/window.getSelection)内部`click`。如果已设置，则您选择了某些内容，否则您只需单击即可。

```
$('#click').click(function() {
    var sel = getSelection().toString();
    if(!sel){
        alert("clicked");
    }
});​ 
```

演示：http: [//jsfiddle.net/ym5JX/3/](http://jsfiddle.net/ym5JX/3/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-30T20:24:41.727

正如我在评论中发布的那样，`mosuedown + mouseup = click`这正是突出显示的作用。有解决方法..见下文，

```
var isClick = 0;
$('#click').click(function() {
    if (isClick == 1) {
        alert("clicked");
    }
}).mousedown(function () {
    isClick = 1;
}).mousemove(function () {
    isClick = 0;
}); 
```

[**演示**](http://jsfiddle.net/ym5JX/6/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T20:24:44.310

jsFiddle：http: [//jsfiddle.net/ym5JX/8/](http://jsfiddle.net/ym5JX/8/)

```
$('#click').click( function()
{
    if ( getSelection() == "" )
    {
        alert("clicked");
    }
}); 
```

# c - Ubuntu 上的 strdup() 崩溃

> ID：10390012
> 
> 赞同：1
> 
> 时间：2012-04-30T20:17:20.590
> 
> 标签：c, ubuntu, crash, strdup

当我尝试在 Ubuntu 上运行时，我的 C 程序出现分段错误。这是堆栈跟踪。感谢任何帮助

```
0  0x015383f1 in ?? () from /lib/tls/i686/cmov/libc.so.6
#1  0x01538075 in strdup () from /lib/tls/i686/cmov/libc.so.6
#2  0x00c0a4af in cvtToString (ign=0xc10b80, target=0x83ba0a8, off=56, 
    source=0x0, setter=0xc044c3 <UxString_SetValue>) at xmlSerialPrimitives.c:28
#3  0x00c09adb in _setValue (xs=0x83b3520, inst=0x83ba0a8 "\020", prop=0xc103dc, 
    value=0x0) at xmlDeserializer.c:214
#4  0x00c09b71 in ctSetValue (xs=0x83b3520, property=0xc103dc, parent=0x83ba0a8, 
    val=0x0) at xmlDeserializer.c:237
#5  0x00c0a1aa in _closeElement (xs=0x83b3520, element=0x83ba1a0)
    at xmlDeserializer.c:419
#6  0x00c0a3da in xmlDeserialize (xs=0x83b3520, xtr=0x83b6218)
    at xmlDeserializer.c:533
#7  0x00c0ab14 in xmlDeserializeFromFile (xs=0x83b3520, 
    file=0x83b34f0 "/usr/v/xlayout.xml")
    at xmlSerializer.c:60
#8  0x00c07280 in load_uxUserModel (
    file=0x83b34f0 "/usr/v/xlayout.xml", data=0xbffff4dc)
    at UxUserModel.c:718
#9  0x00c073d0 in UxUserModel_LoadUserModel (name=0x8148e60 "x.xml")
    at UxUserModel.c:771
#10 0x00bf7f5d in UxModelLoad (umif=0x8397c58, filename=0x8148e60 "x.xml") 
```

这是崩溃的功能

```
static int cvtToString( PCType * ign, void * target, int off, char * source, 
                        void_f    setter)
   {
        /* do we want to copy the string? */
        if (source && strncmp( source, "usermodel://", 12) == 0)
                return 0;
        source = strdup( source);
        if (setter)
               (*setter)( target, source);
        else
               (void) memcpy( target+off, &source, sizeof(char*));

        return 1;
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:28:09.690

```
if (!source || !strncmp( source, "usermodel://", 12))
            return 0; 
```

顺便说一句：这一行：

```
(void) memcpy( target+off, &source, sizeof(char*)); 
```

尝试对 void 指针执行算术运算。编译器应该（至少）抱怨。

# c++ - 递归多项式乘法

> ID：10390015
> 
> 赞同：-6
> 
> 时间：2012-04-30T20:17:24.933
> 
> 标签：c++, recursion, polynomial-math

我写了以下递归多项式乘法，但它给了我错误，代码在这里

```
#include<iostream>
#include<vector>
using namespace std;
#define N 4
float *mult(float p[],float q[],int n)
{
    float pl[N/2],ql[N/2],ph[N/2],qh[N/2];
    float t1[N/2],t2[N/2];
    float r[2*N-2],rl[N],rm[N],rh[N];
    int i,N2;
    if(N==1)
    {
        r[0]=p[0]*q[0]; return (float *)r;
            }
    for(i=0;i<N/2;i++)
    {
        pl[i]=p[i];
        ql[i]=q[i];
    }
    for(i=N/2;i<N;i++)
    {
        ph[i-N/2]=p[i];
        qh[i-N/2]=q[i];

    }
    for(i=0;i<N/2;i++) t1[i]=pl[i]*ph[i];
    for(i=0;i<N/2;i++) t2[i]=ql[i]*qh[i];
    rm=mult(t1,t2,N/2);
    rl=mult(pl,ql,N/2);
    rh=mult(ph,qh,N/2);
    for(i=0;i<N-1;i++) r[i]=rl[i];
    r[N-1]=0;
    for(i=0;i<N-1;i++) r[N+i]=rh[i];
    for(i=0;i<N-1;i++)
        r[N/2+i]+=rm[i]-(rl[i]+rh[i]);
    return (float *)r;
} 
```

错误是这些

```
(13): warning C4172: returning address of local variable or temporary
(28): error C2440: '=' : cannot convert from 'float *' to 'float [4]' There are no conversions to array types, although there are conversions to references or pointers to arrays
(29): error C2440: '=' : cannot convert from 'float *' to 'float [4]' There are no conversions to array types, although there are conversions to references or pointers to arrays
(30): error C2440: '=' : cannot convert from 'float *' to 'float [4]' There are no conversions to array types, although there are conversions to references or pointers to arrays
(36): warning C4172: returning address of local variable or temporary 
```

我不明白什么是原因？请帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:21:18.117

> 警告 C4172：返回局部变量或临时地址

这意味着您正在调用未定义的行为，因为您正在返回一个变量的地址，该变量将在退出某个范围时不再存在。我可以看到一个例子：

```
float *mult(float p[],float q[],int n) 
```

创建本地数组`r`并返回它的地址。像往常一样，还有很多其他错误，但我会停止这个。

你可以通过返回一个向量来避免这个问题：

```
std::vector<float> mult( .... ) { fill vector with values you would put in array and return it } 
```

这只是一种可能的解决方案。这里的好处是您不必担心内存管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:35:20.777

如果您使您的数组`r, rl, rm, rh`动态化会更好，这也将消除警告和错误。

```
#include <iostream>
#include <vector>
using namespace std;
#define N 4
float* mult(float p[],float q[],int n)
{
    float pl[N/2],ql[N/2],ph[N/2],qh[N/2];
    float t1[N/2],t2[N/2];
    float* r = new float[2*N-2]; // Create it dynamically so it can be safely returned
    float *rl, *rm, *rh; // They don't need to be allocated because they will be assigned later down there.
    int i,N2;
    if(N==1)
    {
        r[0]=p[0]*q[0];
        return r;
    }
    for(i=0;i<N/2;i++)
    {
        pl[i]=p[i];
        ql[i]=q[i];
    }
    for(i=N/2;i<N;i++)
    {
        ph[i-N/2]=p[i];
        qh[i-N/2]=q[i];

    }
    for(i=0;i<N/2;i++) t1[i]=pl[i]*ph[i];
    for(i=0;i<N/2;i++) t2[i]=ql[i]*qh[i];
    rm=mult(t1,t2,N/2);
    rl=mult(pl,ql,N/2);
    rh=mult(ph,qh,N/2);
    for(i=0;i<N-1;i++) r[i]=rl[i];
    r[N-1]=0;
    for(i=0;i<N-1;i++) r[N+i]=rh[i];
    for(i=0;i<N-1;i++)
        r[N/2+i]+=rm[i]-(rl[i]+rh[i]);
    return r;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T20:32:35.263

你有几个不同的问题，但它们是相互关联的。

你得到的第一个和最后一个警告是因为`r`它是你的函数中的一个局部变量，当函数返回时它会消失——这意味着像你一样返回它的地址是在自找麻烦。调用者将获得一个不再指向任何有意义的指针。（很可能，很多时候代码仍然可以工作，但这只是因为你很幸运。）

其他错误是因为您有一个返回指向数组的指针的函数，并且您试图将该返回值分配给数组变量。我不确定您是否希望 (1) 数据的内容将被复制到数组中，或者 (2) 数组变量将开始引用函数返回的数据，但实际上两者都不会发生.

这两个问题的解决方案是相同的：对数组和指针之间的区别以及您正在操作的数据实际存在的位置要更加清晰和小心。您可以采取三种主要方法来完成这项工作。

首先，您可以将数据放在 C++ 之类的东西中，`vector<float>`而不是 C 样式的数组中。这些*可以*按值传递，与您尝试做的方式大致相同，它会正常工作。但是，它可能涉及大量数据复制，这可能会使您的代码比您想要的要慢。

其次，您可以继续使用 C 风格的原始内存块，但始终使用指针而不是数组，并使用`new`and`delete`或 with显式分配它们，`malloc`并`free`注意所有内容都只释放一次。

第三，你可以继续使用 C 风格的数组，但是——而不是试图从你的函数返回数组——将一个指向数组开头的指针传递给函数，并填充它的新内容。这样，内存管理是你的`mult`函数调用者的责任，如果你做对了，你可能会避免需要任何类型的内存分配`mult`。（你可能会发现调用者需要传入一个指向某个临时空间的指针；如果你组织得当，递归调用将能够使用相同的临时空间。）

第一种方法是最简单的。最后一个可能是表现最好的。我真的不推荐中间那个。

# c# - 返回列表 这样调用者就无法修改它

> ID：10390017
> 
> 赞同：1
> 
> 时间：2012-04-30T20:17:37.860
> 
> 标签：c#

我将`List<string>`其作为属性公开，但希望避免在对象之外对其进行修改。在 C# 中最好的方法是什么，我是创建一个新副本`List<string>`还是做其他事情..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T20:19:18.940

这对于类型是不可能的`List<T>`。最好的方法是公开`ReadOnlyCollection<T>`类型的属性（[MSDN](http://msdn.microsoft.com/en-us/library/ms132476.aspx)）。

您可能会认为它显式实现`ICollection`了公开`Add()`方法的接口，但不要担心并记住：

> **ICollection.Add**
> 
> 将项目添加到 ICollection。此实现总是抛出 NotSupportedException。

顺便说一句，为什么你需要`List<T>`类型？也许暴露类型的属性`IEnumerable<T>`就足够了？您正在使用哪个特定功能`List<T>`，可能是内置的排序/搜索方法？无论如何，如果你真的需要`List<T>`- 你可以将它用作属性支持字段的类型，并通过`ReadonlyCollection<T>(IList<T> list)`构造函数或使用`List<T>.AsReadonly()`方法调用对其进行转换，实际上没有区别，因为`AsReadonly()`它是单行方法`return new ReadOnlyCollection<T>(this);`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T20:20:02.913

添加`AsReadOnly()`到列表的末尾

```
ReadOnlyCollection<string> test = new List<string> {"test"}.AsReadOnly(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T20:20:26.057

返回`IEnumberable<String>`。这样，即使您更改了实现（您可能会觉得使用数据`XYZ`结构使程序更高效），调用者也不必更改代码。

我只是想知道你为什么要强制执行这样的约束。如果可能，请向社区提供更多详细信息，他们可能会更好地帮助您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T20:27:14.640

尝试：

```
MyClass myClass = new MyClass();

class MyClass
{
    public MyClass()
    {
        _MyProperty = new List<string>();
        _MyProperty.Add("Test 1");
        _MyProperty.Add("Test 2");
    }
    private List<string> _MyProperty;
    public System.Collections.ObjectModel.ReadOnlyCollection<string> MyProperty 
    {
        get { return _MyProperty.AsReadOnly(); }
    }        
} 
```

# list - 定义新列表并通过在 Prolog 中追加来递归地在列表中添加项目

> ID：10390018
> 
> 赞同：1
> 
> 时间：2012-04-30T20:17:38.827
> 
> 标签：list, prolog, append, new-operator, add

我正在尝试对给定的列表项进行一些操作，并尝试声明一个新列表并向其中添加满足特定条件的项。我必须递归调用这个函数。所以，第一次列表为空，我想在其中插入一个项目。第二次，它将有一个元素，添加另一个元素会产生两个元素。第三次有两个元素，然后再添加一个元素，依此类推。

请帮助我如何通过附加递归函数调用来在 prolog 和 addr 元素中声明列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:37:09.677

Prolog中不需要声明term；一旦你把它们写下来，它们就存在了。所以如果你写[]，它是空列表。您提到的是两个列表之间的关系：一个列表，称为 List0，另一个列表，称为 List，即 List0 与附加元素。所以你有这样的关系

```
list0_list(List0, List) :-
    .... 
```

如果 List 是具有您想要的元素的 List0 则成立。您只需描述这种关系何时成立，并通过在规则正文中说明必要条件来做到这一点。

# javascript - django 的 CSS/JavaScript 管理器

> ID：10390019
> 
> 赞同：1
> 
> 时间：2012-04-30T20:17:46.710
> 
> 标签：javascript, python, css, django

django 有 CSS 和/或 JavaScript 管理器模块吗？

我在功能中寻找什么：

*   我希望能够在每个视图的基础上定义要加载的样式表和 javascript 文件（这本身在裸 django 中很容易做到，但请耐心等待......）
*   我希望插件自动组合/优化“源”CSS/JS 并将输出插入到适当的视图中。

存在这样的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:30:48.430

看看[django-mediagenerator](http://www.allbuttonspressed.com/projects/django-mediagenerator)。

# javascript - 百分比的正则表达式

> ID：10390023
> 
> 赞同：0
> 
> 时间：2012-04-30T20:18:05.717
> 
> 标签：javascript, regex

我有以下 RegExp 验证值是 100%

```
(^100([.]0{1,2})?)$|(^\\d{1,2}([.]\\d{1,2})?)$ 
```

我试图让它接受没有前导零的百分比，例如

`.5`而不仅仅是`0.5`.

如果有人可以帮助我纠正这个表达，以便它接受两者，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:22:50.767

[在这里](http://regexlib.com/Search.aspx?k=percent&AspxAutoDetectCookieSupport=1)您应该找到正确的正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:24:32.763

您可以添加`^([.]\d{1,2})?)`另一个可能的字符串：

```
(^100([.]0{1,2})?)$|(^\d{1,2}([.]\d{1,2})?)$|(^([.]\d{1,2})?)$ 
```

# iphone - 直接发布到应用程序的墙上

> ID：10390035
> 
> 赞同：1
> 
> 时间：2012-04-30T20:19:27.573
> 
> 标签：iphone, ios, facebook

我正在尝试直接从我的 iOS 应用程序发布到 Facebook 应用程序页面，但没有运气。

我已将这篇 [iOS 帖子阅读到 Facebook 应用程序墙上](https://stackoverflow.com/questions/7495472/ios-post-to-the-facebook-app-wall) ，而这篇 [尝试直接发布到应用程序墙上](https://stackoverflow.com/questions/8173699/trying-to-post-directly-to-an-applications-wall)

但没有运气。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:46:09.937

```
-(void)postToFacebookAppPage
{
    NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   @"##########...", @"app_id",
                                   @"##########...",@"to",

                                   //@"http://www.facebook.com/pages/AppPageURL", @"link",
                                   //@"icon.png", @"picture",
                                   //@"App Page Name", @"name",
                                   //@"Post to App Facebook Page", @"caption",
                                   @"Do Stuff Facebook page.", @"description",
                                   nil];

    AppDelegate *sharedAppDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    [sharedAppDelegate.facebook dialog:@"feed" andParams:params andDelegate:self]; 
} 
```

数字#### 用于您的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T18:15:12.360

```
-(void)postToFacebookAppPage
{
    NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   @"##########...", @"app_id",

                                   //@"http://www.facebook.com/pages/AppPageURL", @"link",
                                   //@"icon.png", @"picture",
                                   //@"App Page Name", @"name",
                                   //@"Post to App Facebook Page", @"caption",
                                   @"Do Stuff Facebook page.", @"description",
                                   nil];

    AppDelegate *sharedAppDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    [sharedAppDelegate.facebook dialog:@"pageid/feed" andParams:params andDelegate:self]; 
} 
```

# ruby-on-rails - 无法将瘦服务器作为服务启动，RubyGems：找不到瘦服务器

> ID：10390040
> 
> 赞同：5
> 
> 时间：2012-04-30T20:19:50.727
> 
> 标签：ruby-on-rails, thin

我使用以下说明在带有 Rails 3.2.3 的 Ubuntu 10.04.4 上安装和配置瘦服务器作为服务：

[http://articles.slicehost.com/2008/5/6/ubuntu-hardy-thin-web-server-for-ruby](http://articles.slicehost.com/2008/5/6/ubuntu-hardy-thin-web-server-for-ruby)

瘦服务器工作正常，从应用程序根目录运行它，使用“瘦启动”

但是，当我尝试使用以下任何命令运行服务时：

```
service thin start
sudo service thin start
/etc/init.d/thin start
sudo /etc/init.d/thin start 
```

我收到以下错误：

```
/home/myuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find thin (>= 0) amongst [bigdecimal-1.1.0, io-console-0.3, json-1.5.4, minitest-2.5.1, rake-0.9.2.2, rdoc-3.9.4] (Gem::LoadError)
    from /home/myuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'
    from /home/myuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems.rb:1210:in `gem'
    from /home/myuser/.rvm/gems/ruby-1.9.3-p125/bin/thin:18:in `<main>' 
```

这似乎不是 PATH 的问题，'which thin' 正确返回：

```
home/myuser/.rvm/gems/ruby-1.9.3-p125/bin/thin 
```

我还验证了 **/bin/thin 的存在，无论它被引用到哪里

我尝试使用“gem uninstall thin”、“gem install thin”重新安装 gem，但没有成功

有谁之前经历过这个吗？我只发现了这个问题的另一个实例： [无法通过远程机器重新启动瘦](https://stackoverflow.com/questions/10314138/cannot-restart-thin-via-remote-machine)

这个问题似乎只是通过 ssh，而我什至无法在本地启动瘦服务

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T14:16:51.577

由于从您的堆栈跟踪中看起来您正在使用 rvm，并且您正在使用作为 gem 安装的瘦，因此您需要使用 rvm 包装器才能使服务正常工作。首先删除服务端重新安装它`rvmsudo thin install`而不是`sudo thin install`. 您还应该`rvmsudo thin config`在创建配置文件时使用。

要创建一个包装器，

```
rvm wrapper <your_rvm_ruby_version>@<your_rvm_gemset_in_use> bootup thin 
```

您可以分别通过 using`rvm list`和`rvm gemset`list 找到名称。包装器将具有名称`bootup_thin`，您可以通过该名称确认它使用的是正确的 rvm `bootup_thin`。你可以在创建它时给它起任何你想要的名字。然后你需要编辑瘦脚本

```
sudo nano /etc/init.d/thin 
```

把原来的DAEMON改成

```
DAEMON=location_of_bootup_thin 
```

这应该是`which bootup_thin`. 然后就可以启动服务了。

```
sudo service thin start 
```

我希望这有帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T22:31:26.307

似乎每个启动作业都加载了自己的外壳。`rvm`所以，在尝试开始瘦之前尝试加载：

```
#! /bin/sh
# Load RVM into a shell session *as a function*
if [[ -s "$HOME/.rvm/scripts/rvm" ]] ; then

  # First try to load from a user install
  source "$HOME/.rvm/scripts/rvm"

elif [[ -s "/usr/local/rvm/scripts/rvm" ]] ; then

  # Then try to load from a root install
  source "/usr/local/rvm/scripts/rvm"

else

  printf "ERROR: An RVM installation was not found.\n"

fi

rvm use 1.9.3
cd /path/to/your/application/code
bundle exec thin -d 
```

将其放入`/etc/init.d/thin_service`并运行

```
$ sudo update-rc.d  thin_service defaults 
```

最后，您可以通过简单地键入`sudo start thin_service`&`sudo stop start_thin`而不是重新启动来进行测试。如果这仍然不起作用，请尝试 railsgems-bundler 和 rvm 包装器。另外，请阅读[rvm 的部署最佳实践](https://rvm.io/deployment/best-practices/)

# node.js - Node.js - 使用异步库 - 带有对象的 async.foreach

> ID：10390041
> 
> 赞同：53
> 
> 时间：2012-04-30T20:19:53.833
> 
> 标签：node.js, loops, object, asynchronous, node-async

我正在使用*节点异步*库 - [https://github.com/caolan/async#forEach](https://github.com/caolan/async#forEach)并希望遍历一个对象并打印出它的索引键。完成后，我想执行一个回调。

这是我到目前为止所拥有的，但`'iterating done'`从未见过：

```
 async.forEach(Object.keys(dataObj), function (err, callback){ 
        console.log('*****');

    }, function() {
        console.log('iterating done');
    }); 
```

1.  为什么最终函数没有被调用？

2.  如何打印对象索引键？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-04-30T20:43:46.283

最终函数不会被调用，因为`async.forEach`需要您`callback`为每个元素调用该函数。

使用这样的东西：

```
async.forEach(Object.keys(dataObj), function (item, callback){ 
    console.log(item); // print the key

    // tell async that that particular element of the iterator is done
    callback(); 

}, function(err) {
    console.log('iterating done');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-23T18:32:32.983

async.each 是由 Async Lib 提供的非常有用和强大的功能。它有 3 个字段 1-集合/数组 2-迭代 3-回调 集合指的是对象的数组或集合，迭代指的是每次迭代并且回调是可选的。如果我们要回调，那么它将返回响应或说出您想在前端显示的结果

将函数 iteratee 并行应用于 coll 中的每个项目。使用列表中的项目调用 iteratee，并在完成时回调。如果迭代者将错误传递给它的回调，主回调（对于每个函数）会立即使用错误调用。

请注意，由于此函数将 iteratee 并行应用于每个项目，因此无法保证 iteratee 函数将按顺序完成。

例子——

```
 var updateEventCredit = function ( userId, amount ,callback) {
    async.each(userId, function(id, next) {
    var incentiveData = new domain.incentive({
    user_id:userId,
        userName: id.userName,
        amount: id.totalJeeneePrice,
        description: id.description,
    schemeType:id.schemeType
    });

    incentiveData.save(function (err, result) {
        if (err) {
            next(err);
        } else {
                 domain.Events.findOneAndUpdate({
                    user_id: id.ids
                }, {
                    $inc: {
                        eventsCredit: id.totalJeeneePrice
                    }
                },{new:true}, function (err, result) {
                    if (err) {
                        Logger.info("Update status", err)
                        next(err);
                    } else {
                     Logger.info("Update status", result)
                     sendContributionNotification(id.ids,id.totalJeeneePrice);
                     next(null,null);       
                    }
                });
        }
    }); 
```

# c# - 基于三个键/值查询值

> ID：10390042
> 
> 赞同：0
> 
> 时间：2012-04-30T20:19:55.007
> 
> 标签：c#, datatable

我有这个下表（我想把它作为一个`datatable`，但我很灵活）：

```
ID(int)   Branch(string)   Department(string)   Available(Boolean)

 101          North           Sales               True
 101          North           Marketing           False
 102          North           Security            True
 103          South           Sales               True
 ...          ...             ...                 ... 
```

我希望能够通过`Available`查询`[ID][Branch][Department]`

所以类似的东西`[101]["North"]["Marketing"]`会给我`False`，或者至少告诉我`[101]["North"]["Marketing"]`表中是否存在包含的行。

解决此问题的最有效方法是什么？如果您认为它比`datatable`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:22:46.167

您可以使用 DataTable 的[Select](http://msdn.microsoft.com/en-us/library/system.data.datatable.select.aspx)方法。像

```
datatable.Select("ID = 101 AND Branch='North' AND Department = 'Marketing'"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:33:22.577

您可以将 DataTable 的 PrimaryKey 设置为前 3 列，然后使用 DataTable 的 Rows.Find(101, "North", "Marketing") 找出该行或如果它不存在则为 null！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T20:33:44.320

> 我应该补充一点，它不会出现在某个数据库中。它只是作为一个小的查找表在内存中。可能不会超过 20 行。

在这种情况下，对于性能和内存占用而言，最*有效*的方法是对 Branch 和 Department 使用枚举，并使用您的三重嵌套数组方法。

话虽如此，它和简单的数据表都将是维护的噩梦。我建议您考虑定义明确的类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T20:52:56.870

如果是内存中的少量数据，为什么不使用 LINQ to 对象并为您的数据创建自定义业务对象？它会比`DataTable`.

```
public class Branch
{
  public int ID {get;set;}
  public string BranchName {get;set;}
  public string Department {get;set;}
  public bool Available {get;set;}
}

public bool BranchExists(int id, string branch, string dept)
{
   //assume "Branches" is your in-memory list
   return Branches.Any(b => b.id == id && b.BranchName == branch && b.Department == dept);
} 
```

# permissions - 可以在没有管理权限的情况下编写 NSIS 卸载信息吗？

> ID：10390049
> 
> 赞同：2
> 
> 时间：2012-04-30T20:20:14.277
> 
> 标签：permissions, registry, nsis, uninstallation, user-permissions

最近，我将基于 NSIS 的安装程序从安装到“程序文件”文件夹中更改为安装到本地用户文件夹中，以使普通用户帐户无需管理 UAC 提升即可安装（类似于 SkyDrive 或 Google Chrome 的做法）。

要启用卸载，安装程序使用了类似的东西：

```
; Shortcut for the key.
!define REG_U "Software\Microsoft\Windows\CurrentVersion\Uninstall\ZetaUploader"

; Write uninstall strings.
WriteRegStr HKLM "${REG_U}" "DisplayName" "Zeta Uploader ${VERSION}"
WriteRegStr HKLM "${REG_U}" "DisplayVersion" "${VERSION}"
WriteRegStr HKLM "${REG_U}" "UninstallString" '"$INSTDIR\uninstall.exe"'
WriteRegStr HKLM "${REG_U}" "Publisher" "Zeta Software GmbH"
WriteRegStr HKLM "${REG_U}" "URLInfoAbout" "https://www.zeta-uploader.com" 
```

这在使用管理权限运行时效果很好，但在使用用户权限运行时会失败（静默）。

**因此，我的问题是：**

是否有可能在没有管理权限的情况下添加到中央卸载控制面板窗口？

我试图搜索`HKCU`类似于`HKLM`卸载密钥的密钥，但没有找到。此外，我知道我可以编写一个开始菜单项来卸载，但我不希望我的用户太容易删除应用程序。

**更新 1 / 解决方案：**

根据[Anders 的回答](https://stackoverflow.com/a/10393798/107625)，我发现[这篇博客文章](http://www.klopfenstein.net/lorenz.aspx/simple-nsis-installer-with-user-execution-level)使用[这个示例 NSI 脚本](http://ontopreplica.codeplex.com/SourceControl/changeset/view/a65fdbb263dd#Installer/script.nsi)以同样的方式解释它。

所以最终的解决方案如下：

```
; Shortcut for the key.
!define REG_U "Software\Microsoft\Windows\CurrentVersion\Uninstall\ZetaUploader"

; Write uninstall strings.
WriteRegStr HKCU "${REG_U}" "DisplayName" "Zeta Uploader ${VERSION}"
WriteRegStr HKCU "${REG_U}" "DisplayVersion" "${VERSION}"
WriteRegStr HKCU "${REG_U}" "UninstallString" '"$INSTDIR\uninstall.exe"'
WriteRegStr HKCU "${REG_U}" "Publisher" "Zeta Software GmbH"
WriteRegStr HKCU "${REG_U}" "URLInfoAbout" "http://www.zeta-uploader.com" 
```

（请注意，`HKLM`第一个代码片段被替换为`HKCU`）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T05:06:41.890

您在正确的轨道上，与 HKLM 具有相同子路径的 HKCU 是正确的位置。

它默认不存在，但可以在任何最新版本的 Windows 上运行（不适用于 Win9x，不确定 NT4 和 2000）

# javascript - 如何观察数组变化并查看添加了哪些新元素？

> ID：10390050
> 
> 赞同：5
> 
> 时间：2012-04-30T20:20:15.230
> 
> 标签：javascript, ember.js

```
onArrayChanged: function(obj, keyName, value) {

    // What is value here, exactly?

}.property('array.@each') 
```

当一个元素被添加到数组中时，我如何知道添加了哪个值？同样，当从数组中删除一个值时，我如何访问它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T08:17:38.243

看看[addArrayObserver](https://github.com/emberjs/ember.js/blob/master/packages/ember-runtime/lib/mixins/array.js#L214-251)，见[http://jsfiddle.net/pangratz666/EE65Z/](http://jsfiddle.net/pangratz666/EE65Z/)：

```
var a = Ember.A('a b c d e f g'.w());

var o = Ember.Object.create({
    arrayWillChange: Ember.K,
    arrayDidChange: function(array, start, removeCount, addCount) {
        console.log(arguments);
    }
});

a.addArrayObserver(o); 
```

# mp4 - 在我的网站上嵌入 MP4 视频

> ID：10390054
> 
> 赞同：3
> 
> 时间：2012-04-30T20:20:34.840
> 
> 标签：mp4

有没有办法以原始大小显示 MP4 视频。看起来我们必须提供宽度和高度，如果我们不提供，它将默认为原始大小以外的某个值。

```
<OBJECT CLASSID="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" 
CODEBASE="http://www.apple.com/qtactivex/qtplugin.cab" WIDTH="160" HEIGHT="136" >
<PARAM NAME="src" VALUE="videofilename_mp4.mov" >
<PARAM NAME="autoplay" VALUE="true" >
<EMBED SRC="videofilename_mp4.mov" TYPE="image/x-macpaint" 
PLUGINSPAGE="http://www.apple.com/quicktime/download" WIDTH="160" HEIGHT="136" AUTOPLAY="true"></EMBED>
</OBJECT> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T20:25:11.830

如果我没记错的话，您将不得不从元数据中读取它。我目前使用 Flowplayer 的免费版本。

你可以给它传递一个选项“scale:fit” [http://flowplayer.org/documentation/api/clip.html](http://flowplayer.org/documentation/api/clip.html)

这告诉 Flash Flowplayer 读取文件元数据并缩放视频以适应具有适当纵横比的播放器容器。

我知道您可能不想要闪存解决方案，但这是一种选择。

# objective-c - 如何在一个视图控制器中设置多个 uitableview 和 uiview

> ID：10390057
> 
> 赞同：1
> 
> 时间：2012-04-30T20:20:43.413
> 
> 标签：objective-c, ios

我正在设置一个带有 4 个按钮的 uivewcontroller，当我单击这些按钮时，它们会将下面的视图更改为不同的视图。它可以是 uitableview 或只是带有一些文本的常规 uiview。我在这里看到了一个我喜欢的答案，但我再也找不到了。有一种方法可以将视图拆分为不同的文件，以便更有条理。我正在使用情节提要，我应该只将 4 个视图放在一起，然后隐藏其中的 3 个吗？另外我正在考虑为每个文件设置一个单独的文件，以便我可以在主视图控制器中设置它们。

也至于委托。我需要这样设置uitableview吗？

```
@interface PeopleTableView : UITableView <UITableViewDelegate, UITableViewDataSource> 
```

然后创建一个单独的协议，以便 mainviewcontroller 可以将数据发送到 peopletableview

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:10:13.757

是的，你可以按照一般的方式来创建你的表格视图等等，但是在像你这样的情况下，有一个叫做`tag`被使用的东西。我相信你知道。

比如说tableviews，当你在row count或者设置titles时，你可以先查看tableview的tag来了解哪个是启用的。

希望这可以帮助..

# ruby - 修改自我，Ruby

> ID：10390070
> 
> 赞同：6
> 
> 时间：2012-04-30T20:21:29.013
> 
> 标签：ruby

```
module Pigged
  String.class_eval do
    def pig
      newstring = self + self[0]; newstring[0] = ""; newstring += "ay"
      return newstring
    end
  end
end 
```

是相关代码。我想做的是制作一个`pig!`修改原始字符串的方法。我该怎么做，而不修改自我，因为那是不允许的......？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-30T23:10:26.077

我已经压缩了你的代码并添加了`pig!`方法：

```
module Pigged
  String.class_eval do
    def pig
      self[1..-1] + self[0] + 'ay'
    end
    def pig!
      self.replace(pig) #self.replace(self[1..-1] + self[0] + 'ay')
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T20:30:53.657

你不应该修改 self.

使用`replace`或自定义方法。

阅读'[写作方法“改变！” 对于 String](http://www.ruby-forum.com/topic/110734) ' 了解更多信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-30T20:32:56.570

对于 String，您可以使用 self.replace 来更改内容。

对于其他类，我不认为它可以修改自己，除非创建一个新对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-30T21:25:33.673

修改没有错`self`，你不能分配给它，但是如果你可以直接访问它们，你可以使用访问器方法来修改它或修改实例变量。`String#replace`在这种特殊情况下是访问器。

另一个例子：

```
class Array
  def delete_first_element!
    self[0..0] = []
  end
end

a = [1,2,3]
b = a

a.delete_first_element!

puts a.inspect # [2,3]
puts b.inspect # [2,3]! 
```

要记住的一件事——你改变了同一个对象的所有引用（`b`在我的例子中）！

# cics - COMMAREA 在 CICS 的什么位置？

> ID：10390072
> 
> 赞同：1
> 
> 时间：2012-04-30T20:21:49.630
> 
> 标签：cics

在IBM 的[这个页面上，我阅读了以下内容 -](http://publib.boulder.ibm.com/infocenter/txformp/v6r0m0/index.jsp?topic=/com.ibm.cics.te.doc/erziaz0049.htm)

“客户端应用程序通过使用称为 COMMAREA 的数据区域与 CICS 服务器程序进行通信，该数据区域在调用时传递到 CICS 区域。”

我的问题是，这个数据区在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:02:17.610

CICS 将在实例之间为您维护它。让您知道将完全允许您打破这种抽象。

在某些情况下，它将保留在 CICS 存储中。如果您处于多区域设置中，很可能会使用各种选项中的任何一种进行传递，VSAM 数据集、共享内存、VTAM 或 TCP/IP。

但你真的不想知道。您的事务第一次运行时，它可以设置它喜欢的任何commarea。在每个 RETURN（除了最后一个 RETURN）上，将该逗号传递回 CICS。然后，CICS 将在下次您的交易运行时完全不受干扰地将您的 commarea 交还给您。

此外，逗号有一些严重的限制。如果您正在做新的开发，您应该考虑通道和容器，以消除 commarea 限制。

# random - Swi-Prolog：未定义的程序：random_permutation/2

> ID：10390074
> 
> 赞同：0
> 
> 时间：2012-04-30T20:21:55.817
> 
> 标签：random, prolog, swi-prolog

为什么这个谓词`random_permutation`不起作用？

[http://www.swi-prolog.org/pldoc/doc_for?object=random_permutation/2](http://www.swi-prolog.org/pldoc/doc_for?object=random_permutation/2)

```
?- use_module(library(random)).
%  library(pairs) compiled into pairs 0.00 sec, 8,880 bytes
% library(random) compiled into random 0.04 sec, 333,032 bytes
true.

?- L=[1,2,3,4,5], random_permutation(L,P).
ERROR: toplevel: Undefined procedure: random_permutation/2 (DWIM could not correct goal) 
```

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T06:06:17.617

请仔细检查您使用的版本。我使用的是 5.10.5，库的大小似乎不匹配。

```
3 ?- use_module(library(random)).
%  library(pairs) compiled into pairs 0.00 sec, 4,568 bytes
% library(random) compiled into random 0.03 sec, 46,624 bytes
true.

4 ?- L=[1,2,3,4,5], random_permutation(L,K).
L = [1, 2, 3, 4, 5],
K = [1, 3, 2, 4, 5]. 
```

# perl - 我无法让 Apache::VMonitor 在 Apache2 中工作

> ID：10390079
> 
> 赞同：6
> 
> 时间：2012-04-30T20:22:12.787
> 
> 标签：perl, apache, apache2, mod-perl, mod-perl2

我正在从 Apache 1.3 迁移到 Apache 2.063，并且无法让[Apache::VMonitor](http://search.cpan.org/~mjh/Apache-VMonitor-2.06/lib/Apache/VMonitor.pm)正常工作。

我尝试了这样的设置，类似于我在旧 Apache 中的设置：

```
<Perl>
  use Apache::VMonitor();
  $Apache::VMonitor::Config{BLINKING} = 1;
  $Apache::VMonitor::Config{refresh}  = 0;
  $Apache::VMonitor::Config{verbose}  = 1;
  $Apache::VMonitor::Config{system}   = 1;
  $Apache::VMonitor::Config{apache}   = 1;
  $Apache::VMonitor::Config{procs}    = 1;
  $Apache::VMonitor::Config{mount}    = 1;
  $Apache::VMonitor::Config{fs_usage} = 1;
  $Apache::VMonitor::Config{apache_sort_by}  = 'vsize';
  $Apache::VMonitor::PROC_REGEX = join "\|", qw(.*)
</Perl>

<Location /vmonitor>
  SetHandler perl-script
  PerlHandler Apache::VMonitor
  Order deny,allow
  Deny from all
  Allow from 127.0.0.1
  Allow from X.X.X.X ## really a valid IP
</Location> 
```

当我尝试启动服务器时，出现此错误：

> ap_scoreboard_image 不存在于...

我在 Apache::VMonitor 文档中发现了一条注释，上面写着：

> 注意 对于 2.0.53 之后的 Apache 版本（在 2.0.54、2.0.55 和 2.0.58 上验证），由于 Apache 初始化记分牌对象。

问题是它没有说明何时可以在更高版本的 Apache 中初始化记分牌对象。我试图省略“使用”语句并得到这个错误：

> 恐慌：全局销毁期间的 del_backref。
> 
> ***错误代码 255

有谁知道如何让它工作？我并没有坚持使用 Apache::VMonitor，如果有人可以建议另一种方法来解析和显示来自 Apache 记分牌的数据，我愿意接受建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T15:51:27.680

我已将 V2.07 推送到 CPAN，它应该可以解决问题（如果您不需要 GTop 提供的信息或在 Windows 上运行，还删除了对 GTop 的依赖）。

使用以前的版本（V2.06），您应该能够在您的脚本/应用程序中初始化它。基本上在启动阶段之后的任何地方，如果我没记错的话，在创建子线程/进程之前没有记分牌。

如果您需要，源代码在 github ( [http://github.com/mjharwood/Apache--VMonitor-2.0 ) 上。](http://github.com/mjharwood/Apache--VMonitor-2.0)

# jquery - 在 POST 之前，在按钮提交时从 SelectList 中选择所有选项

> ID：10390080
> 
> 赞同：2
> 
> 时间：2012-04-30T20:22:13.193
> 
> 标签：jquery, html, asp.net-mvc, events, razor

我有一个正在审核的用户下拉列表、一个员工选择列表和一个空的已分配审核者选择列表。当管理员双击 SelectList 中的员工时，它会附加到正在审核的用户的分配审阅者选择列表中。

这是一张视觉图片：

![调查 SelectList jQuery 选择的选项 Reviewers Employee](../Images/725bbf9272bfd6317104bd9ee731ba9a.png)

如您所见，我让 jQuery 选择了 Assigned Reviewers SelectList 中的所有选项，但是如果您单击其中一个，它将取消选择其他选项，并且仅将所选选项附加到表中。我将能够禁用此列表，但我希望用户也能够从此列表中删除。我尝试在 bttn 提交时使用此代码，但它只附加了我选择的代码：

```
 submit_bttn.click(function () {
        $('.selectionList select option').prop('selected', true);
    }); 
```

我什至尝试在双击时添加第二个函数以将选定的属性附加到选项中，该选项有效，但一旦用户单击超出范围就会被删除。

我想做的一件事是将值存储在隐藏的输入字段中，但我觉得这是不必要的，并且将是更多用于从列表中删除的代码。

另外，我正在使用剃刀视图：@Html.ListBox(selectList from viewbag)。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T06:17:38.130

你忘记了“。” 在 selectionList 的 className 处：

```
submit_bttn.click(function () {
    $('.selectionList select option').prop('selected', true);
}); 
```

*   如果另一个选择具有类 selectionList 则选择器应该是“select.selectionList option”（没有空格）或只是“.selectionList option”

**编辑**：
根据您的评论，调试问题，挂钩到表单的提交以取消它并查看是否选择了所有选项：

> //假设页面上只有一个表单..
> $("form").submit(function(event){event.preventDefault() });

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T16:00:33.700

经过一番研究，我发现在DOM中设置属性是选择所有选项并将selected属性设置为true，而不是选中的正确方法。

在 bttn 提交时，所有选项都会突出显示！

```
 submit_bttn.click(function () {
        $('.selectionList option').each(function () {
            $(this).attr('selected', true);
        });
    }); 
```

# assembly - 基本装配程序

> ID：10390081
> 
> 赞同：2
> 
> 时间：2012-04-30T20:22:13.937
> 
> 标签：assembly, x86-16

我想编写我的第一个汇编程序。我在论文上做了一些程序，但这是我第一次使用编译器。我正在使用[ideone](http://ideone.com)。我的程序很简单，翻译`A = 5 - A`成汇编

```
NEG A
ADD A, 5 
```

现在我想运行这个程序并检查它。我如何用编译器做到这一点？请帮帮我。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:27:33.950

您提供的网站似乎无法运行此代码，因为它设置了特定的语言。汇编不是一种语言，而是一系列处理器指令。下载一个 8086 模拟器来运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T20:31:14.390

这不是很有效的 8086 汇编语言。至少，它不是我所知道的任何汇编语法。

*   一方面，8086 寄存器的名称有两个字母（它们被命名为 AX、BX、CX、DX、BP、SP、SI 和 DI..加上一些不能用于数学）。
*   如果那`A`是一个内存位置，那么您需要在某处为它贴上标签。而且你需要让汇编器知道它应该是一个字指针，因为你没有把它放在寄存器中。（寄存器大小可以使指针语义明显，但您在这里没有使用寄存器。：P）

相应的 8086 代码（非常相似）将是

```
neg ax
add ax, 5 
```

或者，为了记忆：

```
neg  word [A]
add  word [A], 5

... other stuff here ...
A: resw 1             ; some assemblers say this; others say `dw ?` 
```

（MASM 有时可以不用括号。我不知道 MASM 语法，所以希望其他人可以清除该部分。哦，这不是几乎所有其他汇编程序做事的方式。：P）

现在，有了它，您需要一个汇编程序（如[Yasm](http://yasm.tortall.net/)）将该代码转换为可执行文件。（不过，您需要更多代码。您在这里所拥有的将无法按原样正确运行。至少，您需要 a`ret`在最后，这样 CPU 就不会脱轨。）您可以想象使用编译器并将所有内容嵌入到一个`__asm`块中（或您的编译器的等效项），但如果您使用纯汇编语言编写，您通常不会这样做。这有点像用大锤敲钉子。

# iphone - Objective-C，NSLocalizedString 随机崩溃

> ID：10390082
> 
> 赞同：1
> 
> 时间：2012-04-30T20:22:16.230
> 
> 标签：iphone, objective-c, nslocalizedstring

由于 NSLocalizedString，我遇到了奇怪的崩溃。-[CFString 保留]：消息发送到已释放的实例 0x3c6ad0。

我确信这是由于 NSLocalizedString 当我用静态字符串替换它时。一切顺利。这是我得到错误的那一行。

```
[_backButton setTitle:NSLocalizedString(sBackButtonDefaultTitle, nil) forState:UIControlStateNormal]; 
```

sBackButtonDefaultTitle 是“返回”。

让它随机的原因是它有时会崩溃，有时不会。

**编辑：**

sBackButtonDefaultTitle 在头文件中定义

```
#define sBackButtonDefaultTitle @"Back" 
```

当然，标头会导入到 .m 文件中。

**编辑：**

更多详细信息...此后退按钮标题在应用程序范围内使用。几乎在每个控制器中。但是，崩溃仅发生在按下某个控制器之后。

此控制器包含一个 Web 视图。如果我点击返回按钮，控制器就会弹出。没有崩溃。但是，如果我用相同的“返回”按钮按下任何控制器，应用程序就会崩溃，并给出我上面说明的错误。

这真的很神秘。我希望有人可以帮我解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:28:34.530

当然是因为`sBackButtonDefaultTitle`当你调用`NSLocalizedString`.

我猜这是一个自动释放的字符串。

您可能需要检查是否启用了 NSZombie。

您可能需要在`sBackButtonDefaultTitle`创建字符串时保留它，并在`NSLocalizedString`调用后释放它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:27:46.920

此崩溃是由于`sBackButtonDefaultTitle`在您的代码中的该点之前发布的。检查以确保在您拥有它时保留它，并且在该行代码中使用它**后释放它。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T22:11:28.847

使用 NSLocalizedString 的一个很好的理由是为您的应用程序支持多种语言。NSLocalizedString 通常与字符串资源文件配合得很好，这样系统就可以动态地决定它应该用来填充你的 UI 的语言。我从来没有像你那样尝试过使用 NSLocalizedString，但我可以告诉你使用字符串资源文件肯定会起作用。查看[Apple 的国际化指南](https://developer.apple.com/library/ios/#documentation/MacOSX/Conceptual/BPInternational/Articles/InternationalGuidelines.html) 和[字符串资源文件](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/LoadingResources/Strings/Strings.html#//apple_ref/doc/uid/10000051i-CH6)

希望能帮助到你。

# php - 在表格行鼠标悬停时显示提交按钮

> ID：10390083
> 
> 赞同：3
> 
> 时间：2012-04-30T20:22:26.260
> 
> 标签：php, javascript, html

首先，请原谅我是 Javascript 和 PHP 的初学者。

第二：我有一个包含一些订单信息的表格，每行的第一个单元格包含一个提交按钮，该按钮会将信息从该行发送到将显示它的第二页。

我编写了一个小的 Javascript 函数，以便隐藏提交按钮，直到有人将鼠标悬停在它们上面。但我的问题是按钮的提交 ID 分配给了第一个按钮，所以无论我将鼠标悬停在哪一行，都只会显示第一个提交按钮。

显示功能如下：

```
 function showButton(id) 
    {
        var e = document.getElementById(id);
        if(e.style.display == 'block')
           e.style.display = 'none';
        else
           e.style.display = 'block';
    } 
```

该行定义为：

```
 tr onmouseover='showButton("submitButton");'
                   onmouseout='showButton("submitButton");'> 
```

在新行的每次迭代中生成的按钮是：

```
 input type='submit' id='submitButton' value='Submit' 
                   style='cursor: pointer; display: none;' /> 
```

任何帮助将不胜感激。我希望鼠标悬停时每行旁边出现正确的提交按钮。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T20:24:09.870

这可以通过 CSS 轻松实现，如下所示：

```
tr input { display: none; }
tr:hover input { display: inline; } 
```

# debugging - 需要查看已发送的帖子标题

> ID：10390092
> 
> 赞同：1
> 
> 时间：2012-04-30T20:23:16.000
> 
> 标签：debugging, post, network-programming, firebug, wireshark

我正在尝试向 google OAuth 发送发布请求，但它返回了无效请求。我发送的所有信息都是正确的，所以我想查看我发送的帖子（在发送之前），以便我可以调试并查看是否以及错误在哪里。

我正在尝试使用 Wireshark 或 Firebug，但没有成功。也许有这方面经验的人可以为我指出正确的方向来查看我的帖子？

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T06:45:12.337

我在不使用任何外部程序的情况下解决了它，答案是使用 Google OAuth 你需要设置标题：

```
headers={'content-type':'application/x-www-form-urlencoded'} 
```

不管怎么说，还是要谢谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:30:23.340

Firefox 的 http fox 怎么样？

[https://static-ssl-cdn.addons.mozilla.net/img/uploads/previews/full/18/18903.png?modified=1331247702](https://static-ssl-cdn.addons.mozilla.net/img/uploads/previews/full/18/18903.png?modified=1331247702)

或者也许有一个 http-fire-bug-fox 插件正在某个地方工作？

# wix - 用于部署 Petrel 插件的 Windows Installer XML (WiX) 模板或指南？

> ID：10390094
> 
> 赞同：0
> 
> 时间：2012-04-30T20:23:26.080
> 
> 标签：wix, ocean, petrel

是否有任何模板或指南可用于创建用于部署 Petrel 插件的 Windows Installer XML (WiX) 项目？

WiX 没有被选为旧 *.vdproj/MSI 推荐的自然继承者有什么原因吗？

有没有人尝试过用于 Petrel 插件的 WiX？我有兴趣交流想法和经验。我是 WiX 的新手，很难上手。

（题外话：“新”PIP 范式精简而简单，但不适合企业使用，客户希望能够重新打包 MSI 以通过例如组策略促进大规模部署。我将发布另一个这个问题。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T14:59:20.443

无论 MSI 生成方式如何（WiX 只是生成它们的另一种方式），Ocean/Petrel 仍然支持 MSI 部署。

在 Ocean/Petrel 2012.1 中，您需要分别在安装和卸载步骤中定义自定义动作调用命令行工具和`PluginManager.exe`切换。自定义操作是使用WiX 中的标签定义的。从 MSI 自定义操作调用时，您需要记住两个技巧：`/install``/uninstall``<CustomAction>``PluginManager.exe`

*   您需要在`/installerId:your_installer_id`安装期间在命令行开关中提供您的 MSI 安装程序 ID（通常是 GUID）。这将在卸载 Petrel 时启用插件的自动 MSI 卸载

*   您需要在卸载过程中`PluginManager.exe`使用`/runFromInstaller`switch 运行。通过这样做，您可以让 PluginManager 知道您从 MSI 安装程序运行它，因此无需再次运行 MSI 卸载

您可以在 Ocean.chm 中的插件身份和部署白皮书中找到这些和其他提示和技巧以及完整的 PluginManager.exe 命令行规范（“如何在 MSI 安装程序中使用 PluginManager.exe”部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-07T18:56:33.473

**Petrel 2013 的重要信息**：

我们有可以使用 MSI 安装或卸载的插件，这些插件是用 Wix 创建的。`PluginManager.exe`在不使用参数的情况下安装 PIP 时，使用`/installerId:<msi_installer_id>`Petrel 卸载插件会物理删除所有文件，但会在 Windows 卸载程序插件中产生不一致。如果我们使用参数`/installerId:<msi_installer_id>`使用 Petrel 卸载插件，则只会在逻辑上删除插件，将其物理保存在其原始目录中。这允许它随后也由 Petrel 安装。在后一种情况下，没有不一致，因为windows卸载插件并能够删除所有文件。

问题是使用 Petrel 2013 卸载插件并没有调用它的 MSI 卸载程序。不应该吗？这看起来像一个错误。

# html - 在 MVC 控制器中检索复选框值

> ID：10390095
> 
> 赞同：1
> 
> 时间：2012-04-30T20:23:32.850
> 
> 标签：html, model-view-controller, views, asp.net-mvc-controller

我有以下代码来包含一个复选框，以将已删除的项目显示为列表的一部分：

```
 <input name="DeletedItems" value="ShowDeleted" type="checkbox">
    <label for="showdeleted">Show deleted itmes</label> 
```

此代码位于视图中。我的问题是：如何在此视图的控制器中检索此值。我需要检索此值以确定是否显示已删除的项目。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T08:07:32.907

您可以使用 FormCollection 对象来检索复选框值..

**看法：**

> <:input name="DeletedItems" value="ShowDeleted" type="checkbox">

**控制器：**

> [HttpPost]
> 
> 公共 ActionResult YourAction(FormCollection 结果) {
> 
> 字符串 CheckBoxValue=result["DeletedItems"];
> 
> }

# asp.net - ASP.NET MVC 4 后退按钮 -> 表单提交 -> 404

> ID：10390098
> 
> 赞同：1
> 
> 时间：2012-04-30T20:23:47.827
> 
> 标签：asp.net, asp.net-ajax, http-status-code-404, asp.net-mvc-4, back-button

有一些奇怪的行为，我希望得到一些反馈，因为我似乎无法在任何地方找到关于这类事情的任何细节......

**设置：** 使用 ASP.NET MVC 4 和 VS 2010，我创建了一个带有搜索页面和详细信息页面的公司目录应用程序，该页面根据搜索选择显示公司树。

搜索页面非常基本，使用 ajax.beginform 它会根据所选条件返回一个人员列表。单击此人后，您会得到一个“树”，显示该人、他们的主管和任何下属。

**问题** 用户搜索某人，点击他们的结果，看到树。当他们单击后退按钮（在树视图上执行或不执行任何其他操作）时，他们将返回到搜索屏幕。他们输入的标准在那里，但结果却不是（如我所料）。如果他们点击搜索或按回车键，用户会收到 404 page not found 错误...

**我尝试过** 的内容从我读过的内容来看，我一直专注于围绕缓存的可能解决方案，我尝试过使页面过期或将页面设置为无缓存，但这似乎并没有解决问题.

**代码**

搜索视图：

```
@using (Ajax.BeginForm("PersonList", "Home", new AjaxOptions { UpdateTargetId = "results", InsertionMode=InsertionMode.Replace }))
{

        @Html.LabelFor(model => model.LastName)
        @Html.TextBoxFor(model => model.LastName)<br />

        @Html.LabelFor(model => model.FirstName)
        @Html.TextBoxFor(model => model.FirstName)<br />

        <input type="submit" value="Search" />

        <div id="results">
        </div>
} 
```

用于搜索结果的块。这是一个部分视图，也可用于树视图。这就是为什么您会看到块顶部的链接处于条件状态。如果要从搜索页面使用链接，则它是一个强制更改整个页面的 html 链接。但是，如果您已经在树视图上，则导航是通过 ajax 完成的。我收到的 404 错误发生在树视图页面上根本没有导航：

```
<div id="p@{ Html.DisplayFor(model => model.Id); }" class="personCard">
    <img class="personImg" id="img@{ Html.DisplayFor(model => model.Id); }" src="@Url.Content("~/Photos")/@Html.DisplayFor(model => model.Id)" />
    <div>
        @if(ViewBag.IsForSearch == null) {
            @Ajax.ActionLink(this.Model.FullName, "PersonHierarchy", new { id = this.Model.Id }, new AjaxOptions { HttpMethod = "POST", InsertionMode = InsertionMode.Replace, UpdateTargetId = "tree" })
        } else {
            @Html.ActionLink(this.Model.FullName, "Person", new { id = this.Model.Id })
        }
        @if(this.Model.TeamSize > 0) {
            @:&nbsp;(
            @Html.DisplayFor(model => model.TeamSize)
            @:)
        }
        <br />
        @Html.DisplayFor(model => model.Title)<br />
        @Html.DisplayFor(model => model.MailLocationCode), @Html.DisplayFor(model => model.WorkNumber) &nbsp;&nbsp; @Html.DisplayFor(model => model.ExtensionForDisplay)<br />
        @if (this.Model.CellNumber.Trim() != string.Empty)
        {
            @:Cell:
            @Html.DisplayFor(model => model.CellNumber)
            @:<br />
        }
        @Html.DisplayFor(model => model.EmailAddress)
    </div>
</div> 
```

来自服务器的响应：

> ## “/”应用程序中的服务器错误。
> 
> 无法找到该资源。说明：HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除、名称已更改或暂时不可用。请查看以下 URL 并确保其拼写正确。
> 
> 请求的网址：/
> 
> -------------------------------------------------- ------------------ 版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

**编辑：** **这似乎特定于 IE 9（在所有模式下）。这种行为在 Chrome 中不会发生，并且搜索表单在使用后退按钮后会完美地重新提交......**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T15:46:24.910

好的...我似乎找到了答案：

回顾一下，特别是在 IE 9 中使用 ASP.NET MVC Ajax 时，使用后退按钮导航回具有 ajax 表单的页面并尝试提交该表单会导致 404 错误。

我最初研究了各种缓存解决方案，试图迫使 IE 意识到需要“重新加载”页面（即使 Chrome 和其他浏览器在使用后退按钮时使表单再次工作没有问题）。这显然是正确的路径，但不幸的是我没有走得足够远。解决方案最终将控制器操作（或整个控制器）的 OutputCache 设置为：

```
[OutputCache(NoStore = true, Duration = 0, VaryByParam = "*")] 
```

将该注释添加到控制器中的操作或整个控制器类中解决了问题...感谢 IE...

**有关这方面的更多信息，请参阅我的来源：** [http ://dougwilsonsa.wordpress.com/2011/04/29/disabling-ie9-ajax-response-caching-asp-net-mvc-3-jquery/](http://dougwilsonsa.wordpress.com/2011/04/29/disabling-ie9-ajax-response-caching-asp-net-mvc-3-jquery/)

感谢所有试图提供帮助的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:36:23.733

您是否尝试过使用开发人员工具 [F12]、Fiddler、Firebug 等来查看返回 404 错误消息的请求是什么？通过确定返回 404 的请求，您可能可以找出请求不正确的原因。

# c# - 如何检索请求的操作方法的属性

> ID：10390099
> 
> 赞同：7
> 
> 时间：2012-04-30T20:23:56.587
> 
> 标签：c#, asp.net-mvc-3, reflection, html-helper

我试图在 MVC 3 应用程序中查看可能在我的控制器中装饰操作方法的任何身份验证属性。我在自己的 HtmlHelper 扩展方法中执行此操作，这些方法基本上是 ActionLink 的包装器（为您提供我在运行时可用的信息的上下文）。我有一个基本的解决方案，但是重载的方法让它爆炸了。我知道该框架在内部将 url 解析为操作方法，但是在查看 System.Web.Mvc.LinkExtensions 的代码之后，我仍然没有确切地找到这是如何发生的，所以我有点不知道如何来解决这个问题。

这是我迄今为止用于解决相关方法的代码：

```
private static bool _IsUserAuthorized(HtmlHelper html,
  string controllerName, string actionName)
{
  controllerName = controllerName ??
    html.ViewContext.RouteData.GetRequiredString("controller");

  var factory = ControllerBuilder.Current.GetControllerFactory();
  var controller = factory.CreateController(
    html.ViewContext.RequestContext, controllerName);

  Type controllerType = controller.GetType();
  var methodInfo = controllerType.GetMethod(actionName,
    BindingFlags.IgnoreCase | BindingFlags.Public | BindingFlags.Instance);

  ... check authentication
} 
```

所以我目前的问题是，当一个方法被覆盖时，我得到“找到模糊匹配”的异常。我猜我需要处理 RouteValues 来解析方法的任何参数，这样我就可以明确地识别出正确的参数。有没有人有一些关于如何做到这一点的指示？或者，该框架是否已经提供了一种解决所需确切方法的方法？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T13:37:30.897

[编辑：更新了方法以包含来自此页面](http://vivien-chevallier.com/Articles/create-an-authorized-action-link-extension-for-aspnet-mvc-3)的见解。这个最终版本会查看请求的操作方法的 AuthorizationFilters，并检查用户是否有权执行该操作。

所以我在 System.Web.Mvc.ControllerActionInvoker 中挖掘并找到了我需要的方法和构造函数。ControllerDescriptor.FindAction() 最终成为关键。下面，我复制了我编写的~~检索所有属性的方法~~

```
private static bool _IsUserAuthorized(HtmlHelper htmlHelper,
  string controllerName, string actionName)
{
  ControllerContext controllerContext = null;
  //if controllerName is null or empty, we'll use the 
  // current controller in HtmlHelper.ViewContext.
  if (string.IsNullOrEmpty(controllerName))
  {
    controllerContext = htmlHelper.ViewContext.Controller.ControllerContext;
  }
  else //use the controller factory to get the requested controller
  {
    var factory = ControllerBuilder.Current.GetControllerFactory();
    ControllerBase controller = (ControllerBase)factory.CreateController(
      htmlHelper.ViewContext.RequestContext, controllerName);
    controllerContext = new ControllerContext(
      htmlHelper.ViewContext.RequestContext, controller);
  }

  Type controllerType = controllerContext.Controller.GetType();
  ControllerDescriptor controllerDescriptor = new ReflectedControllerDescriptor(controllerType);
  ActionDescriptor actionDescriptor = controllerDescriptor.FindAction(controllerContext, actionName);
  if (actionDescriptor == null)
    return false;

  FilterInfo filters = new FilterInfo(FilterProviders.Providers.GetFilters(
    controllerContext, actionDescriptor));

  AuthorizationContext authContext = new AuthorizationContext(controllerContext, actionDescriptor);
  foreach (IAuthorizationFilter authFilter in filters.AuthorizationFilters)
  {
    authFilter.OnAuthorization(authContext);
    if (authContext.Result != null)
      return false;
  }
  return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:59:37.320

添加授权代码的常规方法是使用[Authorization Filter](http://msdn.microsoft.com/en-us/library/gg416513%28v=vs.98%29.aspx)。

[IAuthorizationFilter.OnAuthorization](http://msdn.microsoft.com/en-us/library/system.web.mvc.iauthorizationfilter.onauthorization%28v=vs.98%29.aspx)提供了一个具有属性的[AuthorizationContext对象。](http://msdn.microsoft.com/en-us/library/system.web.mvc.authorizationcontext%28v=vs.98%29.aspx)`ActionDescriptor`

# spring - 带注释的 Spring MVC @ModelAttribute 自动映射不适用于关联对象

> ID：10390107
> 
> 赞同：1
> 
> 时间：2012-04-30T20:24:24.037
> 
> 标签：spring, jsf, spring-mvc

我正在使用带有注释的 Spring MVC。这是我的问题的简要概述。

我的域名：

```
public class Restaurant {    
    private String name;
    private Address address = new Address();
    //Get and set....
}

public class Address{
    private String street;
    //Get and set....
} 
```

我的控制器：

```
//Configure and show restaurant form.
public ModelAndView showAction() {
   ModelAndView mav = new ModelAndView("/restaurant/showRestaurant");
   restaurant = new Restaurant();
   mav.addObject("restaurant", restaurant);
   return mav;
}

//Save restaurant
public ModelAndView saveAction(@ModelAttribute(value="restaurant") Restaurant restaurant,BindingResult result) {
    restaurant.getName();//<- Not is null
    restaurant.getAddress().getStreet(); //<- is null
} 
```

我的观点：

```
 <form>
    <span class="full addr1"> 
      <label for="Nome">Name<span class="req">*</span></label>
      <h:inputText class="field text large" value="#{restaurant.name}" 
         id="name" forceId="true" styleClass="field text addr"/>
    </span> 

    <span class="full addr1">
      <label for="Nome">Street <span class="req">*</span></label>
      <h:inputText class="field text large" value="#{restaurant.address.street}" 
         id="street" forceId="true" styleClass="field text addr"/>
    </span>  
 </form> 
```

我的问题是，当我填写名称和街道以调用方法“saveAction”时，当我尝试填写餐厅时，名称来自街道但没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T20:36:00.997

我对 jsf 不是很熟悉，但是对于春季绑定，您通常需要完整路径，即`name="address.street"`，以便正确绑定街道名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T22:46:23.650

尝试使用 spring 表单标签[http://static.springsource.org/spring/docs/2.0.x/reference/spring-form.tld.html](http://static.springsource.org/spring/docs/2.0.x/reference/spring-form.tld.html)进行绑定。它很容易。

# php - 带有可选部分的正则表达式

> ID：10390110
> 
> 赞同：1
> 
> 时间：2012-04-30T20:24:36.720
> 
> 标签：php, regex

我对正则表达式很陌生。只是试图分析一个“BB-Code”，它可以做这样的事情：

* * *

图案：

```
\[element title=(.*)picture=(\d+)](.*)(?:\[caption](.*):?\[/caption])?\[/caption].* 
```

* * *

搜索：

> [元素标题=元素标题图片=32]Lorem ipsum dolor[标题]摄影：John Doe[/caption][/element]
> 
> [元素标题=元素标题图片=32]Lorem ipsum dolor[/元素]

* * *

好吧，标题部分应该是可选的，两个条目都应该给出结果。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:36:50.920

这个怎么样：

```
\[element title=(.*)picture=(\d+)\](.*?)(\[caption\](.*)\[/caption\])?\[/element\] 
```

它将匹配两者：

```
[element title=element title picture=32]Lorem ipsum dolor[caption]Photo by John Doe[/caption][/element]

[element title=element title picture=32]Lorem ipsum dolor[/element] 
```

## 例子

在 PHP 中，你可以这样使用它：

```
$regex = '#\[element title=(.*)picture=(\d+)\](.*?)(\[caption\](.*)\[/caption\])?\[/element\]#i';
$text = '[element title=element title picture=32]Lorem ipsum dolor[caption]Photo by John Doe[/caption][/element]';    

preg_match ( $regex, $text, $match );

print_r( $match ); 
```

该数组`$match`将有几个元素。这些是用圆括号`(`和`)`正则表达式包围的字符串。其中之一是标题文本。

程序执行和输出可以在这里看到 [`http://ideone.com/vQ1T0`](http://ideone.com/vQ1T0)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:36:37.970

```
\[element title=(.*) picture=[0-9]+\](.*)(\[caption\](.)*\[\caption\])?\[/element\] 
```

# java - 使用 CriteriaBuilder 时编译错误

> ID：10390115
> 
> 赞同：5
> 
> 时间：2012-04-30T20:25:09.677
> 
> 标签：java, generics, jpa

我正在尝试将此 JPA QL 转换为标准生成器。JBoss 6.0。

```
"SELECT ba FROM BankAccount ba WHERE ba.balance >= :amt ORDER BY ba.ownerName ASC" 
```

我根据几个教程编写了这段代码。

```
public List<BankAccount> findWithBalance(int amount) {
    CriteriaBuilder cb = em.getCriteriaBuilder();
    CriteriaQuery<BankAccount> cq = cb.createQuery(BankAccount.class);
    Root<BankAccount> from = cq.from(BankAccount.class);

    ParameterExpression<Integer> balance = cb.parameter(Integer.class);
    cq.select(from);

    Predicate predicate = cb.gt(from.get("balance"), balance);
    cq.where(predicate);

    cq.orderBy(cb.asc(from.get("ownerName")));

    TypedQuery<BankAccount> query = em.createQuery(cq);

    return query.getResultList();
} 
```

但是，我在该行中遇到编译错误：

```
Predicate predicate = cb.gt(from.get("balance"), balance); 
```

错误是：

```
The method gt(Expression<? extends Number>, Expression<? extends Number>) in the type CriteriaBuilder is not applicable for the arguments (Path<Object>, ParameterExpression<Integer>) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-03T19:00:01.187

好吧，我终于找到了调用 gt() 方法的正确方法。这是完整的解决方案。在 JBoss 6 中经过全面测试。

```
public List<BankAccount> findWithBalance(int amount) {
    CriteriaBuilder cb = em.getCriteriaBuilder();
    CriteriaQuery<BankAccount> cq = cb.createQuery(BankAccount.class);
    Root<BankAccount> from = cq.from(BankAccount.class);

    ParameterExpression<Integer> balance = cb.parameter(Integer.class);
    cq.select(from);

    //Here is the trick!
    Predicate predicate = cb.gt(from.<Integer> get("balance"), balance);

    cq.where(predicate);
    cq.orderBy(cb.asc(from.get("ownerName")));

    TypedQuery<BankAccount> query = em.createQuery(cq);

    query.setParameter(balance, amount);

    return query.getResultList();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T21:00:18.807

JPA 中的类型安全特性限制了这种与不兼容类型的比较，编译器本身会引发错误。

在这里，`from.get("balance")`返回`Path<Object>`，但该方法可以接受 type 的参数`java.lang.Number`，因此会导致错误。

你可以试试下面的代码。

```
//--
    Metamodel metamodel = em.getMetamodel();
    EntityType<BankAccount> pClass = metamodel.entity(BankAccount.class);
    Predicate predicate = cb.gt(from.get(pClass.getSingularAttribute("balance", Integer.class)), balance);
//-- 
```

如果您使用的是 Metamodel API，那么您可以通过指定 ClassName_.field 来直接检索，`cb.gt(from.get(BankAccount_.balance), balance)`这样更清洁且易于调试。

但是，如果您有许多实体，那么如果 JPA 提供者不生成它们，那么手动编写它们的元模型类可能会很困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:12:53.700

编译器抱怨是因为`amount`is an `int`，而不是 an `Expression`，看看你是否能弄清楚如何构建`Expression`一个常量并使用它，你应该很好。

# jquery - 从浏览器到另一台服务器的 HTTP POST 请求

> ID：10390120
> 
> 赞同：3
> 
> 时间：2012-04-30T20:25:59.487
> 
> 标签：jquery, ajax

我正在尝试实现这个[http://wiki.kolmisoft.com/index.php/MOR_API_login](http://wiki.kolmisoft.com/index.php/MOR_API_login)。我已启用服务器中的设置以允许 API。Javascript 的问题是，我的主要网站在 domain website.com 下运行，而星号服务器在 voip.website.com 中运行。因此，当我尝试使用 jQuery 调用 url 时，我得到 XMLHttpRequest cannot load [http://voip.website.com/.../.../](http://voip.website.com/.../.../) ..... Origin [http://sites](http://sites) is not allowed by Access -控制-允许-来源。

我不确定实现这一目标的最佳方法是什么。任何一点都会有很大帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T20:31:10.017

所有浏览器都执行包括整个主机（website.com 与 voip.website.com）[的同源策略。](http://www.w3.org/Security/wiki/Same_Origin_Policy)除非主机相同，否则您无法处理从 Ajax 帖子返回的 JSON。

有一种称为 JSONP 的解决方法。诀窍是您将回复包装在 JavaScript 函数中。你看，同源策略只适用于数据，而不是成熟的脚本本身。因此，如果响应是 JavaScript 而不是数据，浏览器会认为您需要运行此脚本。

例如，假设您的响应将是这个 JSON：

```
{
  firstName: 'Abed',
  lastName: 'Nadir',
  school: 'Greendale Community College'
} 
```

相反，你会这样回应：

```
({
  firstName: 'Abed',
  lastName: 'Nadir',
  school: 'Greendale Community College'
}) 
```

需要注意的是，前后的括号使它成为 JavaScript 匿名函数而不是 JSON 数据。您所做的就是接收该响应并在前后剥离 JavaScript 代码。

听起来很笨拙？确实如此，但每个人都这样做，包括 Flickr、谷歌、亚马逊、Facebook 等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T20:32:50.880

您将需要使用 JSONP 将数据包装在回调中并对其进行 mimetype`text/javascript`以规避跨域策略。

[使用 JSONP 与 .net 对话的 JQuery 有哪些好的示例？](https://stackoverflow.com/questions/448879/what-are-some-good-examples-of-jquery-using-jsonp-talking-to-net)

标题提到了 .net，但服务器端环境与客户端实现无关。

一个可行的替代方法是在您自己的域上设置一个服务器端脚本，该脚本将使用 CURL（或任何其他 http lib）转发请求，然后将响应输出到脚本的 XHR 请求。此方法在您的客户端脚本和您尝试访问的远程域之间设置了一个包罗万象，因为 curl 或任何其他服务器端 http lib 不受跨域策略的约束。

**编辑**

由于您说您需要发送帖子，因此我将做更多详细说明我的第二种方法。就像概念证明一样，我将使用 PHP 来详细说明需要做什么，但是将这个一般想法移植到另一种脚本语言应该很简单。

假设我可以在您的域上制作一个包罗万象的脚本，`www.yourdomain.com/data.php` 该文件中的逻辑需要从 http 请求中读取我所有的帖子变量，将它们作为对新域的请求放入 curl 实例中，执行该请求，然后将请求的响应输出回我的 ajax XHR，这样就好像一开始就没有中介。

我喜欢使用[jscol 的 OOCurl](https://github.com/jsocol/oocurl/)来使 curl 的语法更漂亮一些。

```
<?
reqire_once('path/to/oocurl.php');
$c = new Curl('voip.otherdomain.com/api'); // instantiate with the url endpoint for the api
$c->post = True;
// Set the postfields for the child request to the same as the parent
$c->postfields = $_POST;
//Bust if there is an error and output that instead  
$c->failoneerror = True;
$response = $c->exec();
if($c->errno()){
  //there was an error, what was it?
  header('Status:' . $c->info(CURLINFO_HTTP_CODE));
  echo $c->error();
}else{
  //success, echo output
  header('Content-type: application/json');
  echo $response;
}
?> 
```

将您的 ajax 请求发送到这种脚本将透明地将它们传递给 CURL 的构造函数中指定的其他域。请注意，我假设返回的 mimetype 是 json - 您可能需要调整它以适合您的 API。

如果您有 api 的身份验证凭据，则需要将它们手动编码到请求中作为附加的 post vars，并使用[hmac](http://php.net/manual/en/function.hash-hmac.php)保护端点。这确实特定于您如何进行客户端/服务器端交互，并且有点超出了重定向器的范围......基本上只需确保您有一个服务器定义的哈希盐，并让摘要与您的发布请求一起发送，确保第三方不能简单地发布到您的中介终端。

**编辑**

万一有人从谷歌偶然发现，我用我自己的方法创建了一个库，可以[在这里找到。](https://github.com/DeaconDesperado/forwardr)

# dicom - DICOM 中布尔值的最佳值表示是什么？

> ID：10390121
> 
> 赞同：7
> 
> 时间：2011-12-09T17:40:25.387
> 
> 标签：dicom

AFAIK 没有布尔值表示，我需要在私有标记中指定布尔值 true/false。

我想到了一个`SH`（短字符串），说`TRUE`or `FALSE`。是否有标准或广泛使用的方法来指定它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-12-12T02:39:58.680

您可以将编码字符串 (CS) VR 与`TRUE`编码`FALSE`值一起使用。这是在增强型 PET 采集模块中`Time of Flight Information Used`元素*(0018, 9755)的标准中完成的。*

# perl - print via system() in perl via xampp (windows-7-x64) not working

> ID：10390123
> 
> 赞同：0
> 
> 时间：2012-04-30T20:26:06.417
> 
> 标签：perl, xampp, windows-7-x64

I need to print a generated text-file with perl. I'm using xampp, Windows7 64 bit. My perl-script is containing the print system call:

```
$system = "print\ /d:\\\\SERVER\\PRINTER\ C:\\xampp\\cgi-bin\\textfile.txt";
system ($system); 
```

When i try the same line in the cmd-shell, the print works.

The answer is:

```
C:\xampp\cgi-bin\textfile.txt wird momentan gedruckt. 
```

but nothing else happens.

I then tried to create a batch-file. Starting the batch-file manually starts the print. From a system()-call nothing happens.

Then i tried another way, showing the file in Firefox first. I copied the file to my htdocs-dir and changed my batch-file to:

```
cd "c:\Program Files (x86)\Mozilla Firefox"
firefox.exe -new-window http://localhost/textfile.txt 
```

Doubleclicking the bat starts my firefox and my textfile. The system()-call ist not working.

Any Ideas?

Tom

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T12:05:56.620

My brother found the reason. THANKS CHRIS! It was a problem with the permissions. The apache service is running without normal user permissions. To set user permissions (or, better: special defined, new permissions) in Windows 7 pro 64 bit: (Sorry, this is german)

Task-Manager "Dienste" rechts unten auf "[Adminzeichen] Dienste" Auf Dienst "Apache" rechtsklick "Eigenschaften" Reiter: "Anmelden" Auswahl: "Dieses Konto" User und Passwort rein "Übernehmen" und "OK"

Dann nochmal auf "Apache" linksklick und links auf "neu starten"

# java - Java - 在一种方法中重绘 JPanel 2 次

> ID：10390124
> 
> 赞同：0
> 
> 时间：2012-04-30T20:26:09.677
> 
> 标签：java, swing, repaint

这是我的问题的简单版本。我有 3 个类： 公共类 TopographyFrame 扩展 JFrame - 带有 JPAnel 和按钮的简单 JFrame 公共类 TopograpyPanel 扩展 JPanel - JPanel 以填充矩形 公共类 Siec - 执行计算并在 JAnale 上调用重绘的类

在 JPanel 我重写了 paintComponent() 方法

```
public void paintComponent (Graphics g) {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        System.out.println(rectangles.length);
        for(int i = 0 ; i < rectangles.length ; i++){
            g2.setPaint(neurony[i].winner);
            g2.fillRect((int)rectangles[i].x,(int)rectangles[i].y,(int)rectangles[i].width, (int)rectangles[i].height);
        }
    } 
```

神经元 - 具有公共颜色获胜者字段的对象数组

在 Siec 类中，我参考了 JPanel 以在 JFrame 类中重新绘制它，我有一个带有私有操作侦听器的按钮：

```
class MyListener implements ActionListener{
        Siec s;
        public MyListener(Siec s){
            this.s = s;
        }
        public void actionPerformed(ActionEvent arg0) {
            try {
                s.forPaint();
            } catch (Exception e) {
                e.printStackTrace();
            }
        } 
```

Siec 中的 forPaint() 方法如下所示：

```
public void forPaint(){

        setTopography();

        try {
            Thread.sleep(3000);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        setTopography();
    }
public void setTopography() {
    for (int i = 0; i < vector.colors.length; i++) {
            neurony[i].winner = vector.colors[(int)(random() * 900 % vector.colors.length)];
    }
    panel.repaint();
} 
```

vector.color 是颜色数组

所以我的问题是：当我单击一个按钮时，我想立即重新绘制 JPanel，然后在 3 秒后重新绘制一次。Insted JPanel 在 3 秒延迟后仅重绘一次。}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:31:07.430

*您永远*不能在事件处理线程上休眠、等待或以其他方式暂停。这样做会阻止处理所有事件，包括绘画事件。您的第一幅绘画无法发生，因为您正在事件线程上睡觉，从而阻止它发生。

做任何类型的动画——即使是像这样简单的东西——的正确方法是创建自己的线程。第二个线程可以调用 repaint()，休眠 3 秒，然后再次调用 repaint()。[SwingWorker](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)类名义上是一种更简单的方法，但老实说，初学者总是发现创建自己的线程更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:38:20.810

您正在调度 UI 线程上的重绘，然后休眠（阻塞）UI 线程 3 秒，然后再次请求另一个重绘。**这两个要么在**此方法完成后（3 秒后）彼此非常接近，要么合并为一个更新（之后也是如此）。而不是`sleep(3000)`然后`setTopography`再次调用您，您可以安排`setTopography`在 UI 线程上的调用在 3 秒后发生。

例如，看看 Swing Timer：http: [//docs.oracle.com/javase/tutorial/uiswing/misc/timer.html](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)

所以类似于：

```
javax.swing.Timer timer = new javax.swing.Timer(3000, new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        setTopography();
    }
});
timer.setRepeats(false);
timer.start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T20:43:40.213

由于您的睡眠是在[Event Dispatch Thread](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)上执行的，因此在等待结束之前无法执行 repaint() 事件。改为这样做：

```
private Timer timer = new Timer(); // use java.util.Timer

public void forPaint() {

    setTopography();

    timer.schedule(new TimerTask() {

        @Override
        public void run() {
            setTopography();
        }

    }, 3000);

}

public void setTopography() {
    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {

            for (int i = 0; i < vector.colors.length; i++) {
                neurony[i].winner = vector.colors[(int)(random() * 900 % vector.colors.length)];
            }
            panel.repaint();
        }
    });
} 
```

请记住，对 Swing 组件（例如您的 JPanel）的所有修改都必须在 EDT 上进行。

# jquery - 通过jquery找到与多个元素共享一个类的特定元素

> ID：10390125
> 
> 赞同：0
> 
> 时间：2012-04-30T20:26:16.993
> 
> 标签：jquery, css, ajax

我正在尝试在我的网站上为“喜欢”功能实现 AJAX。我有 create.js.haml 文件的以下代码：

```
$(".postlike_unlike").html("#{escape_javascript(render('unlike'))}"); 
```

我的视图页面循环浏览所有帖子，因此它们都共享同一个类。这是视图页面的片段：

```
- @post.each do |post|
  ...
  %ul.dropdown-menu
    %li
      ...    
    %li
      .postlike_unlike
        .form_for
          ... 
```

呈现的html：

```
<div class='post content'>
  <p>post 1</p>
</div>
<div class='btn-group dropup'>
  <a class='btn btn-primary' href='/post/3/view?view=true' method='get'>
    <i class='icon-info-sign icon-large'></i>
    View Detailed Post 1
  </a>
  <a class='btn btn-primary dropdown-toggle' data-toggle='dropdown'>
    <span class='caret'></span>
  </a>
  <ul class='dropdown-menu'>
    <li>
      <div class='postlike_unlike'>
        <form accept-charset="UTF-8" action="/likes" class="new_like" data-remote="true" id="new_like" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="McQDJsBJF6UHTeMGQNDTBCRzF/PmP5JWWuACqv1ONCA=" /></div>
          <input id="like_likee_id" name="like[likee_id]" type="hidden" value="3" />
          <a href='javascript:void(0)' onclick="$(this).closest('form').submit()">
            <i class='icon-heart-empty icon-large'></i>
            Like this Post
          </a>
        </form>
      </div>
    </li>
    <li class='divider'></li>
  </ul>
</div>

<div class='post content'>
  <p>post 2</p>
</div>
<div class='btn-group dropup'>
  <a class='btn btn-primary' href='/post/3/view?view=true' method='get'>
    <i class='icon-info-sign icon-large'></i>
    View Detailed Post 2
  </a>
  <a class='btn btn-primary dropdown-toggle' data-toggle='dropdown'>
    <span class='caret'></span>
  </a>
  <ul class='dropdown-menu'>
    <li>
      <div class='postlike_unlike'>
        <form accept-charset="UTF-8" action="/likes" class="new_like" data-remote="true" id="new_like" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="McQDJsBJF6UHTeMGQNDTBCRzF/PmP5JWWuACqv1ONCA=" /></div>
          <input id="like_likee_id" name="like[likee_id]" type="hidden" value="3" />
          <a href='javascript:void(0)' onclick="$(this).closest('form').submit()">
            <i class='icon-heart-empty icon-large'></i>
            Like this Post
          </a>
        </form>
      </div>
    </li>
    <li class='divider'></li>
  </ul>
</div> 
```

**我遇到的问题：当我单击“喜欢”按钮时，它会在****每个**帖子上呈现“不喜欢”样式。我意识到每个帖子都有“postlike_unlike”类（这是一个循环），但我想知道是否有办法只更改相关帖子上的类：即只更新被喜欢的帖子上的“喜欢”。

我是 jQuery 的新手，所以我不熟悉是否有一种简单的方法来完成我想要完成的工作。如果您有任何问题，请随时提问。

感谢您的帮助和时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:31:21.920

假设您将点击处理程序附加到每个喜欢/不喜欢，您可以执行以下操作

```
$('.postlike_unlike').click(function(){
     //edit the html
     $(this).html("#{escape_javascript(render('unlike'))}");
}) 
```

每次点击它都会找到您点击的那个（由`this`关键字引用），并应用您的 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:42:09.173

或`$(this).parent()`或某事

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T14:47:04.510

因为它是一个循环，所以我决定使用以下方法为每个 from 创建唯一的 div 容器：

```
%div{:class => "postlike_unlike#{@post.id}} 
```

现在在我的 js 文件中，我引用了以下内容：

```
$(".postlike_unlike#{@post.id}").html("#{escape_javascript(render('unlike'))}"); 
```

这样，我只会更改相应帖子的“喜欢”按钮。

感谢大家的帮助。

# ruby - ramaze 锁定上传的文件？

> ID：10390127
> 
> 赞同：0
> 
> 时间：2012-04-30T20:26:37.620
> 
> 标签：ruby, rack, ramaze

有没有其他人在 Windows 上遇到过 Ramaze 的文件锁定问题？我所有上传的文件都被锁定（我正在使用上传帮助程序）。

我正在使用 - Ruby 1.93 - Ramaze-2012.04.14 - Rack-1.4.1

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T13:59:43.527

回答我自己的问题。看起来罪魁祸首是 ramaze/helper/upload.rb 中的这一行

```
@realfile = File.new(path) #--->this opens the uploaded/saved file, thus locking it 
```

我用这个修补了我本地的upload.rb副本——

```
class UploadedFile
    include Ramaze::Traited

    # Suggested file name
    # @return [String]
    attr_reader :filename

    # MIME-type
    # @return [String]
    attr_reader :type

    # Saved file object
    # @return [File]
    attr_reader :realfile #---> expose the variable so we can close it from the caller 
```

然后在您的调用者中，只需在保存文件后关闭文件，就像这样......

```
get_uploaded_files.each_pair{|k, v|
    v.save "upload/#{v.filename}"
    v.realfile.close #close the file handle
} 
```

我会尽快提交补丁...

# java - 服务器上的 SSL 不工作，在本地机器上工作正常

> ID：10390131
> 
> 赞同：0
> 
> 时间：2012-04-30T20:26:56.013
> 
> 标签：java, ssl, cxf

这更像是一个一般的 java SSL 问题而不是任何东西......

我正在使用 CXF 连接到安全的 Web 服务。当我在本地 Windows 开发机器上运行它时，它会连接并工作，但是，一旦我将它部署到我的应用程序服务器（glassfish 3.1），它就不再工作了。我明白了：

```
Caused by: javax.net.ssl.SSLHandshakeException: SSLHandshakeException invoking https://vendorUrl: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
        at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:1458)
        at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1443)
        at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:56)
        at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:659) 
```

我已经尝试将证书添加到 domain\config\cacerts.jks 文件、lib\security\cacerts 文件等中，但由于这已经被问了很多次，所以我没有问为什么这不起作用（尽管，我想知道为什么）。

让我感到困惑的是，为什么这可以在我的本地开发机器上运行而不向任何密钥库添加任何内容？我的意思是，我没有通过浏览器连接到他们的 URL，我没有添加任何东西——它只是第一次从 Eclipse 中工作。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T20:46:09.713

> 让我感到困惑的是，为什么这可以在我的本地开发机器上运行而不向任何密钥库添加任何内容？我的意思是，我没有通过浏览器连接到他们的 URL，我没有添加任何东西——它只是第一次从 Eclipse 中工作。

您发布的信息没有帮助（这是我至少可以说的）。
您所说的可能仅在 2 种情况下发生：
1）服务器使用已在 java 的信任库`cacert`（例如 Verisign）中由受信任的 CA 签名的证书
2）您已启用`anonymous`密码套件

因为当您将它部署在另一台机器上时，您会遇到握手异常抱怨验证，我想我们可以排除（1）。
根据您的描述，（2）似乎也不可能，因为您尚未启用匿名密码套件。
所以....请用更准确的信息更新您的帖子。还从好坏案例中调试信息

# performance - 在“CASE 语句”中使用局部变量时 t-sql TVF 功能变慢

> ID：10390132
> 
> 赞同：2
> 
> 时间：2012-04-30T20:27:06.967
> 
> 标签：performance, tsql, case

我在 Multi-Step Table 值函数中有如下所示的 sql。我将查询缩短了一点以使其易于理解。

```
CREATE FUNCTION [dbo].[fn_ph] 
(
    -- Add the parameters for the function here
    @pAsOfDate date,
    @pAccountId nvarchar(15)
)
RETURNS @HH TABLE 
(
    -- Add the column definitions for the TABLE variable here
    AsOfDate date,
    AccountId nvarchar(15), 
    LongName varchar(100),
    ShortName varchar(100)
)
AS

BEGIN

declare @longOrShortIndicator int
select @longOrShortIndicator = COUNT(distinct LongOrShortIndicator) from table1 a

select a.*,
 case 
    when a.SecType='CASH' and @longOrShortIndicator > 1 then 'C'
    else a.LongOrShortIndicator
 end as LongOrShortIndicator
from Table1 a

END 
```

表达`when a.SecType='CASH' and @longOrShortIndicator > 1 then 'C'`是瓶颈。

如果我删除`@longOrShortIndicator > 1`查询运行速度快

如果我在函数之外运行查询，它会快速返回......

为什么局部变量会减慢整个查询的速度？任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:49:57.920

该清单没有显示您想对返回表@HH 做什么，但在@longOrShortIndicator 中，您显然是在计算table1 中的行数。如果你做了很多次，例如对于你返回表的所有行，那么它确实很慢，即使在死星上也会很慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T03:18:55.470

在这里猜测：也许您可以尝试将 @LongOrShortIndicator 变量从查询中移出并放入 IF 语句中：

```
declare @longOrShortIndicator int
select @longOrShortIndicator = COUNT(distinct LongOrShortIndicator) from table1 a

IF @longOrShortIndicator > 1 BEGIN
    select a.*,
        CASE when a.SecType='CASH' then 'C'
        else a.LongOrShortIndicator
        end as LongOrShortIndicator
    from Table1 a
END ELSE BEGIN
    select a.*, a.LongOrShortIndicator
    from Table1 a
END 
```

# asp.net - ASP.NET：如何设置我的资源，以便我可以将相同的位置用于开发站点和生产版本？

> ID：10390146
> 
> 赞同：1
> 
> 时间：2012-04-30T20:28:09.847
> 
> 标签：asp.net, vb.net, resources, web

我目前有我的资源（图像）...

```
C:\inetpub\wwwroot\images 
```

我的生产服务器上的相同位置也有图像。如何设置它，这样我就不必经常同步文件夹？似乎是一件容易的事情，但我不确定......

任何其他信息让我知道，我会提供。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:30:11.143

为什么不将它们包含在您的 Web 项目中？这样，当您部署 Web 项目时，默认情况下会包含图像:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T20:34:28.580

如果您不想每次都重新部署应用程序，您还可以使用 SCM 之一（例如 SVN 或 GIT）来保持文件同步。但是您应该“签出”以同步文件或制作一个 .bat 文件，它会自动执行此操作。

# javascript - 在 jsTree 中，如何通过节点 id 获取节点信息？

> ID：10390150
> 
> 赞同：5
> 
> 时间：2012-04-30T20:28:43.683
> 
> 标签：javascript, jquery, jquery-plugins, jquery-selectors, jstree

在 jsTree 中，如何通过节点 id 获取节点信息？

我知道以下节点的 id 即 295 然后如何获取完整的节点信息

```
<item id="295" parent_id="192" title="itemTitle"   version="1">    
            <content><name>Bhushan Sambhus</name></content>  
</item> 
```

**上面的xml部分渲染成jsTree如下**

```
 $("#treeViewDiv").jstree({ 
        "xml_data" : {
            "data" : "" + 
"<root>" + 
    "<item id="295" parent_id="192" title="itemTitle"   version="1">"+    
            "<content><name>Bhushan Sambhus</name></content>  "+
     "</item>"
        }
        "plugins" : [ "themes", "xml_data","ui" ]
    }); 
```

类似于以下伪代码

```
 function getNodeByNodeID(node_id){
          // some code
          // $.jstree.get_node ...... etc ?
          // 
           return relatedNodeInformation;
        }

var nodeInfo =  getNodeByNodeID(providedNodeID) // psudo code
      // any api in jstree to get nodeInfo by  providedNodeID?

       var parent_id_value = nodInfo.attr("parent_id");    
       var title_value     = nodInfo.attr("title");    
       var version_value   = nodInfo.attr("version");
       var node_name       = nodInfo.children("a").text()
alert(parent_id_value+" :: "+title_value+" :: "+version_value+" :: "+node_name); 
```

输入：**295**

输出：**192 :: node_name :: 1 :: node_name**

对此问题的任何帮助或指导将不胜感激

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-30T20:41:58.717

如果我正确理解您的问题，您可以像这样完成您想做的事情：

```
var nodInfo = $("#" + providedNodeId);

var parent_id_value = nodInfo.attr("parent_id");    
var title_value     = nodInfo.attr("title");    
var version_value   = nodInfo.attr("version");
var node_name       = nodInfo.children("a").text();

alert(parent_id_value+" :: "+title_value+" :: "+version_value+" :: "+node_name); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-01T12:54:54.583

只是想帮助保持答案是最新的。使用 jstree 3.1.0，使用以下代码获取节点对象（不是 DOM 对象）：

```
var treeMain;  // reference holder

$(document).ready( function () {           // when the DOM is ready
     treeMain = $('#treeMenus').jstree();  // create the tree and get the reference
});

function getNode( sNodeID)
{
    return $.jstree.reference(treeMain).get_node(sNodeID);  // use the tree reference to fetch a node
} 
```

我在 StackOverflow 上看到了这个问题的几个答案，它们都在谈论回到树项的 DOM 对象。我敢打赌，大多数问这个问题的人真的想回到树项的底层 JSON 数据对象，这就是为什么他们说他们想要节点对象（具有 .original 属性）。具体来说，您需要它来实现诸如“创建”功能之类的东西，您需要创建一个新的 JSON 数据对象，其 ParentID 设置为父 JSON 数据对象的 ID。我搜索了 2 天，并没有在 jstree 文档中找到任何明确的解释：

```
$.jstree.reference(treeMain).get_node(sNodeID); 
```

简单的调用。在他们的辩护中，他们确实有一个 1 行示例埋在这里：

[http://www.jstree.com/docs/interaction/](http://www.jstree.com/docs/interaction/)

但这是一个大多数人不会关心的例子（用户大部分时间都会选择节点），当然也不清楚它实际上能做什么。无论如何...希望这有助于节省其他人几天的时间。=)

# c++ - 如何使用 COMMTIMEOUTS 等待字节可用但读取多个字节？

> ID：10390151
> 
> 赞同：3
> 
> 时间：2012-04-30T20:28:49.520
> 
> 标签：c++, winapi, serial-port, communication

我有一个 C++ 串行端口类，它具有无阻塞和阻塞模式用于读取操作。对于阻塞模式：

```
COMMTIMEOUTS cto;
GetCommTimeouts(m_hFile,&cto);
// Set the new timeouts
cto.ReadIntervalTimeout = 0;
cto.ReadTotalTimeoutConstant = 0;
cto.ReadTotalTimeoutMultiplier = 0;
SetCommTimeouts(m_hFile,&cto) 
```

对于非阻塞模式：

```
COMMTIMEOUTS cto;
GetCommTimeouts(m_hFile,&cto);
// Set the new timeouts
cto.ReadIntervalTimeout = MAXDWORD;
cto.ReadTotalTimeoutConstant = 0;
cto.ReadTotalTimeoutMultiplier = 0;
SetCommTimeouts(m_hFile,&cto) 
```

我想添加另一种模式来等待任意数量的字节并读取它们。

来自 MSDN [COMMTIMEOUTS 结构](http://msdn.microsoft.com/en-us/library/aa363190%28v=vs.85%29.aspx)：

如果应用程序将**ReadIntervalTimeout**和**ReadTotalTimeoutMultiplier**设置为**MAXDWORD**并将 ReadTotalTimeoutConstant 设置为大于零且小于 MAXDWORD 的值**，****则**在调用 ReadFile 函数时会发生以下情况之一：

*   如果输入缓冲区中有任何字节，ReadFile 会立即返回缓冲区中的字节。
*   如果输入缓冲区中没有字节，ReadFile 会等到一个字节到达，然后立即返回。
*   如果在 ReadTotalTimeoutConstant 指定的时间内没有字节到达，ReadFile 超时。

这看起来像这样的代码：

```
COMMTIMEOUTS cto;
GetCommTimeouts(m_hFile,&cto);
// Set the new timeouts
cto.ReadIntervalTimeout = 100;
cto.ReadTotalTimeoutConstant = MAXDWORD;
cto.ReadTotalTimeoutMultiplier = MAXDWORD;
SetCommTimeouts(m_hFile,&cto) 
```

但这会在第一个字节上返回。这是一个问题，因为我正在循环读取端口，并且字节的处理速度非常快，以至于下次我读取端口时，只有另一个字节可用。最终结果是我在循环中一次读取一个字节，并使用 100% 的内核运行该线程。

我想使用`cto.ReadIntervalTimeout`MSDN 文档中的类似内容，但仍要等到至少一个字节可用。有人有想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-24T01:25:43.683

您想要的行为将来自：

```
cto.ReadIntervalTimeout = 10;
cto.ReadTotalTimeoutConstant = 0;
cto.ReadTotalTimeoutMultiplier = 0; 
```

对于第一个字节，它会阻塞任意长（根据文档，通过将后两个字段设置为零来禁用总超时），然后只要数据流入，就会读取到缓冲区大小。如果数据中有 10 毫秒的间隙，它将返回到目前为止已收到的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T22:14:17.160

如果您使用 100%（甚至接近）的 CPU，听起来您在其他地方做错了什么。正如我在[之前的回答](https://stackoverflow.com/a/6037377/179910)中所展示的那样，多年来我一直使用将超时设置为 1 的代码。我最初将它设置为这种方式只是对可能至少可以工作的东西的疯狂猜测，目的是调整它之后。它工作得很好，以至于我根本没有时间调整它。举例来说，它会使用几乎无法估量的 CPU 时间从我的 GPS 读取输入（这是我唯一拥有的甚至不再模仿使用串行端口的东西）——经过数小时从GPS，它仍然显示使用的 CPU 时间为 0:00:00 秒（无论它是否正在运行，我都看不出 CPU 使用率有任何差异）。

现在，我肯定会承认 GPS 不是（甚至接近于）最快的串行设备，但我们仍然在谈论 ~100% 与 ~0%。这显然是一个非常严重的区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T04:51:32.773

```
if (dwEvtMask == EV_RXCHAR )
{
   Sleep(1);
   if (dwLength > 2)
    {
      Sleep(1);
      Readfile( m_Serial->m_hCom, data,dwLength, &dwBytesRead, &Overlapped);
      pDlg->PostMessage(WM_RECEIVE,0,0);
    }
} 
```

# c++ - 使 boost C++ UdpConnection 类线程安全

> ID：10390160
> 
> 赞同：2
> 
> 时间：2012-04-30T20:30:12.737
> 
> 标签：c++, boost, boost-asio

我已经使用 Boost ASIO 实现了一些连接类，以替换应用程序中的一些低级 C 代码，除了一个问题外，一切都运行良好。

基本上，我有一个进行同步读写的 UdpConnection 类，但它使用异步方法来处理超时，如 boost 示例。问题是我不知道如何使它成为线程安全的。

我尝试向事件处理程序添加链以使此类线程安全（下面的代码），但这不起作用。我怀疑这是因为超时的实现方式。我已将我的代码包含在 pastebin 的 4 个类中。

单线程工作正常。我还有不需要在多个线程之间共享的 TcpConnection 和 UnixSocketConnection 类，它们工作正常。但是，我无法让多线程 UDP 代码工作。

我错过了什么吗？

*   Connection.h && AsioConnection.h [http://pastebin.com/Cbbw37gL](http://pastebin.com/Cbbw37gL)
*   UdpConnection.h && UdpConnection.cpp [http://pastebin.com/VLnHBnPs](http://pastebin.com/VLnHBnPs)

编辑按照建议附加代码：

**AsioConnection.h**

```
/*
 * AsioConnection.h
 *
 *  Created on: 2011-04-08
 *      Author: cdunphy
 *
 * All classes that want to use the ASIO io_service
 * and deadline timers will want to subclass this.
 */

#ifndef ASIOCONNECTION_H_
#define ASIOCONNECTION_H_

#include "Connection.h"

#include <boost/shared_ptr.hpp>
#include <boost/asio.hpp>
#include <boost/array.hpp>
#include <boost/bind.hpp>

namespace shaw_rsc
{

/*
 * This exception throws if there is a timeout when connecting
 * to a remote socket.
 */
struct SocketTimeoutException : public std::runtime_error
{
    SocketTimeoutException(const std::string& msg) : std::runtime_error(msg)
    { }
}
;

/*
 * This is the root class of every Connection
 * class that wants to make use of boost asio.
 */
class AsioConnection : public Connection
{
public:
    AsioConnection(
        int c_timeout,
        int r_timeout
    ) : Connection(),
            conn_timeout_int(c_timeout),
            read_timeout_int(r_timeout),
            conn_timeout(c_timeout),
            read_timeout(r_timeout),
            io_service(),
            strand(io_service),
            deadline(strand.get_io_service()),
            error()
    {
        reset_deadline();
    }

    const boost::system::error_code& getError() const
    {
        return error;
    }

    int get_read_timeout() const
    {
        return read_timeout_int;
    }
    int get_conn_timeout() const
    {
        return conn_timeout_int;
    }

    /*
        * These are the callback handlers for our asynchronous
        * IO operations.
        */
    void handle_write(const boost::system::error_code& ec,
                      std::size_t len,
                      boost::system::error_code* out_ec,
                      std::size_t* out_len)
    {
        *out_ec = ec;
        *out_len = len;
    }

    /*
       * These are the callback handlers for our asynchronous
       * IO operations.
       */
    void handle_send(const boost::system::error_code& ec,
                     std::size_t len,
                     boost::system::error_code* out_ec,
                     std::size_t* out_len)
    {
        *out_ec = ec;
        *out_len = len;
    }

    void handle_read(const boost::system::error_code& ec,
                     std::size_t len,
                     boost::system::error_code* out_ec,
                     std::size_t* out_len)
    {
        *out_ec = ec;
        *out_len = len;
    }

    void handle_receive(const boost::system::error_code& ec,
                        std::size_t len,
                        boost::system::error_code* out_ec,
                        std::size_t* out_len)
    {
        *out_ec = ec;
        *out_len = len;
    }

    void handle_connect(const boost::system::error_code& ec,
                        boost::system::error_code* out_ec)
    {
        *out_ec = ec;
    }

protected:
    int conn_timeout_int;
    int read_timeout_int;
    boost::posix_time::seconds conn_timeout;
    boost::posix_time::seconds read_timeout;
    boost::asio::io_service io_service;
    boost::asio::strand strand;
    boost::asio::deadline_timer deadline;
    boost::system::error_code error;

    void reset_deadline()
    {
        // No deadline is required until the first socket operation is started. We
        // set the deadline to positive infinity so that the actor takes no action
        // until a specific deadline is set.
        deadline.expires_at(boost::posix_time::pos_infin);
    }
};

}

#endif /* ASIOCONNECTION_H_ */ 
```

**连接.h**

```
/*
 * Connection.h
 *
 *  Created on: 2011-02-25
 *      Author: cdunphy
 */

#ifndef CONNECTION_H_
#define CONNECTION_H_

#include <vector>
#include <string>
#include <sstream>
#include <stdexcept>

#include <boost/thread.hpp>
#include <boost/shared_ptr.hpp>

namespace shaw_rsc
{

class Connection;

const std::size_t BUF_SIZE = 128;

/*
 * This is the type of reference we will
 * provide to the clients.
 */
typedef boost::shared_ptr<Connection> ConnPtr;

typedef std::vector<char> DataBuffer;
typedef DataBuffer::iterator DB_Iter;
typedef DataBuffer::const_iterator DB_CIter;

// This is the mode we are using for the connection
enum Mode {
    CLIENT,
    SERVER
};

/*
 * This is a generic class that allows data to be read or
 * written to using a connection.  This is quite abstract
 * and it can be used both for file operations and for
 * network operations.
 */
class Connection
{
public:
    Connection() { }
    virtual ~Connection() { }

    /*
     * This method writes the current contents of the data buffer
     * to the connected resource.  Be sure to set the right data
     * in the buffer by calling the setData method first.
     *
     * The number of bytes written is returned.
     */
    virtual std::size_t write(const DataBuffer& data) = 0;

    /*
     * This method reads data from the connected resource and stores
     * it in our data buffer which we pass in by reference.
     * Please note that it clears whatever data was in the buffer prior to
     * reading.
     *
     * The number of bytes read is returned.
     */
    virtual std::size_t read(DataBuffer& data) = 0;

    virtual const std::string str() const = 0;
};

inline std::vector<unsigned char> convert_data_to_unsigned(const DataBuffer& data)
{
    return std::vector<unsigned char>(data.begin(), data.end());
}

inline std::string dataBufferToStr(const DataBuffer& data)
{
    return std::string(data.begin(), data.end());
}

}

#endif /* CONNECTION_H_ */ 
```

**udpConnection.h**

```
/*
 * UdpConnection.h
 *
 *  Created on: 2011-02-25
 *      Author: cdunphy
 */

// Portions Copyright (c) 2003-2011 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0\. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//
#ifndef DATAGRAMCONNECTION_H_
#define DATAGRAMCONNECTION_H_

#include "AsioConnection.h"

#include <boost/lexical_cast.hpp>

namespace shaw_rsc
{

struct UdpException: public std::runtime_error
{
    UdpException(const std::string& msg) : std::runtime_error(msg) { }
};

/*
 * This is the concrete class that manages UDP connections.
 */
class UdpConnection: public AsioConnection
{
public:
    /*
     * Use this constructor for clients (connecting to a remote socket).
     */
    UdpConnection(
        const std::string& _host,
        const std::string& _port,
        int r_timeout,
        Mode mode
    ) : AsioConnection(0, r_timeout),
            socket(strand.get_io_service()),
            remote_endpoint(),
            host(_host),
            port(_port)
    {
        check_deadline();
        connect(mode);
    }

    std::size_t write(const DataBuffer& data);
    std::size_t read(DataBuffer& data);
    const std::string str() const;

private:

    void connect(Mode mode);
    void check_deadline();

    boost::asio::ip::udp::socket socket;
    boost::asio::ip::udp::endpoint remote_endpoint;
    std::string host;
    std::string port;
};

}

#endif /* DATAGRAMCONNECTION_H_ */ 
```

**udpConnection.cpp**

```
/*
 * UdpConnection.cpp
 *
 *  Created on: 2011-02-25
 *      Author: cdunphy
 */

#include "UdpConnection.h"

using std::string;
using std::endl;
using std::stringstream;
using std::exception;

using boost::asio::buffer;
using boost::asio::ip::udp;
using boost::system::error_code;
using boost::system::system_error;
using boost::asio::deadline_timer;
using boost::bind;
using boost::lexical_cast;

namespace shaw_rsc
{

size_t UdpConnection::write(const DataBuffer& data)
{
    size_t bytes_written = 0;

    /*
     * Check to see if the socket is bad before writing
     */
    if (error &&
            error.value() != boost::asio::error::operation_aborted &&
            error.value() != boost::asio::error::timed_out &&
            error != boost::asio::error::try_again)
        throw UdpException(error.message());

    socket.async_send_to(buffer(data), remote_endpoint,
                         strand.wrap(bind(&AsioConnection::handle_send, this, _1, _2,
                                          &error, &bytes_written)));

    do
    {
        strand.get_io_service().run_one();
    }
    while (error == boost::asio::error::would_block
            || error == boost::asio::error::try_again || bytes_written == 0);

    if (error)
    {
        if (error.value() == boost::asio::error::operation_aborted
                || error.value() == boost::asio::error::timed_out)
            throw SocketTimeoutException(error.message());
        else
            throw UdpException(error.message());
    }

    reset_deadline();
    return bytes_written;
}

size_t UdpConnection::read(DataBuffer& data)
{
    /*
    * Check to see if the socket is bad before writing
    */
    if (error &&
            error.value() != boost::asio::error::operation_aborted &&
            error.value() != boost::asio::error::timed_out &&
            error != boost::asio::error::try_again)
        throw UdpException(error.message());

    data.clear();

    /*
     * Reset the deadline timer to expire according
     * to the configured read timeout.
     */
    deadline.expires_from_now(read_timeout);

    size_t bytes_read = 0;
    boost::array<char, BUF_SIZE> buff;

    error = boost::asio::error::would_block;
    socket.async_receive_from(buffer(buff), remote_endpoint,
                              strand.wrap(boost::bind(&AsioConnection::handle_receive, this, _1, _2, &error,
                                                      &bytes_read)));

    do
    {
        strand.get_io_service().run_one();
    }
    while (error == boost::asio::error::would_block ||
            error == boost::asio::error::try_again || bytes_read == 0);

    /*
     * Check for errors after the read.
     */
    if (error)
    {
        if (error.value() == boost::asio::error::operation_aborted
                || error.value() == boost::asio::error::timed_out)
            throw SocketTimeoutException(error.message());
        else
            throw UdpException(error.message());
    }
    else
        data.insert(data.end(), buff.begin(), buff.begin() + bytes_read);

    // Reset the deadline timer so we can leave this socket open as long
    // as we want.
    reset_deadline();
    return bytes_read;
}

void UdpConnection::connect(Mode mode)
{
    socket.open(boost::asio::ip::udp::v4());
    if (mode == SERVER)
    {
        socket.bind(
            udp::endpoint(udp::v4(),
                          lexical_cast<int>(port)), error);
    }
    else if (mode == CLIENT)
    {
        udp::resolver resolver(strand.get_io_service());
        udp::resolver::query query(udp::v4(), host, port);
        remote_endpoint = *resolver.resolve(query, error);
    }
}

void UdpConnection::check_deadline()
{
    // Check whether the deadline has passed. We compare the deadline against
    // the current time since a new asynchronous operation may have moved the
    // deadline before this actor had a chance to run.
    if (deadline.expires_at() <= deadline_timer::traits_type::now())
    {
        // The deadline has passed. The outstanding asynchronous operation needs
        // to be cancelled so that the blocked receive() function will return.
        //
        // Please note that cancel() has portability issues on some versions of
        // Microsoft Windows, and it may be necessary to use close() instead.
        // Consult the documentation for cancel() for further information.
        socket.cancel();

        // There is no longer an active deadline. The expiry is set to positive
        // infinity so that the actor takes no action until a new deadline is set.
        reset_deadline();
    }

    // Put the actor back to sleep.
    deadline.async_wait(strand.wrap(boost::bind(&UdpConnection::check_deadline, this)));
}

/*
 * This member function is good for diagnostic purposes
 */
const string UdpConnection::str() const
{
    stringstream sstr;
    sstr << "Host: " << host << endl;
    sstr << "Port: " << port << endl;
    sstr << "Read timeout: " << read_timeout_int << endl;
    sstr << "Remote Endpoint Address: " << remote_endpoint.address().to_string()
    << endl;
    sstr << "Remote Endpoint Port: " << remote_endpoint.port() << endl;

    try
    {
        sstr << "Socket Remote Endpoint Address: "
        << socket.remote_endpoint().address().to_string() << endl;
        sstr << "Socket Remote Endpoint Port: "
        << socket.remote_endpoint().port() << endl;
    }
    catch (exception& e)
    { }

    try
    {
        sstr << "Socket Local Endpoint Address: "
        << socket.local_endpoint().address().to_string() << endl;
        sstr << "Socket Local Endpoint Port: " << socket.local_endpoint().port()
        << endl;
    }
    catch (exception& e)
    { }

    return sstr.str();
}

} 
```

编辑2：

这是我试图开始工作的测试代码：

用 C++ 回复的服务器。除了线程 Udp 测试之外，所有测试都在工作：

```
#define BOOST_TEST_DYN_LINK
#define BOOST_TEST_MODULE TestLibRSCAsio

#include <cstdio>
#include <cstdlib>
#include <cstdio>
#include <ctime>
#include <iostream>
#include <string>
#include <exception>
#include <sstream>

#include <boost/asio.hpp>
#include <boost/array.hpp>
#include <boost/date_time.hpp>
#include <boost/thread.hpp>
#include <boost/lexical_cast.hpp>
#include "boost/date_time/posix_time/posix_time.hpp"

#include <rsc_asio/Connection.h>
#include <rsc_asio/TcpConnection.h>
#include <rsc_asio/UdpConnection.h>
#include <rsc_asio/UnixSocketConnection.h>

#include "Util.h"
#include "sha1/Sha1Calc.h"

#include "servers/TestTcpServer.h"

#include <boost/test/unit_test.hpp>

using std::vector;
using std::string;
using std::size_t;
using std::cerr;
using std::cout;
using std::endl;
using std::flush;
using std::exception;
using std::time;
using std::stringstream;

using boost::lexical_cast;
using boost::thread;
using boost::mutex;
using boost::unique_lock;

using namespace shaw_rsc;

const size_t TCP_BYTE_SZ = 1000000;
const size_t UDP_BYTE_SZ = 64;

const std::string FILE_SOCKET = "/tmp/rofl";
const std::string SERVER_HOST = "0.0.0.0";
const std::string SERVER_PORT = "10999";
const std::string EXPECTED_UDP_REQUEST = "GOT_ANSWER?";

const int TIMEOUT = 3;
const int THREAD_TIMEOUT = 10;

DataBuffer write_data(ConnPtr client, Sha1Calc& sha1calc, size_t size, size_t iter)
{
    unique_lock<mutex>(global_mutex);
    cout << "Iter: " << iter << endl;
    DataBuffer data = getRandomData(size);
    sha1calc.calc_client_digest(data);
    size_t bytes_written = client->write(data);
    cout << "Wrote " << bytes_written << " -> " << dataBufferToStr(data) << " to socket: " << endl << client->str() << endl;
    return data;
}

void write_data_threaded(ConnPtr client, Sha1Calc& sha1calc, size_t size, size_t iter)
{
    cout << "Iter: " << iter << endl;
    DataBuffer data = getRandomData(size);
    sha1calc.calc_client_digest(data);
    size_t  bytes_written = client->write(data);
    cout << "Wrote " << bytes_written << " -> " << dataBufferToStr(data) << " to socket: " << endl << client->str() << endl;
}

DataBuffer read_data(ConnPtr server, Sha1Calc& sha1calc, size_t iter)
{
    cout << "Iter: " << iter << endl;
    DataBuffer data;
    size_t bytes_read = server->read(data);
    cout << "Read " << bytes_read << " -> " << dataBufferToStr(data) << " from socket: " << endl << server->str() << endl;
    sha1calc.calc_server_digest(data);
    return data;
}

/*
 * This is a suite of tests to provide unit tests
 * for the RRE.
 */
BOOST_AUTO_TEST_SUITE(TestLibRSCAsioSuite)

BOOST_AUTO_TEST_CASE(TcpTest)
{
    boost::asio::io_service io_service;

    cout << endl << "**** TCP Test ****" << endl;
    Sha1Calc sha1calc;
    cout << endl << "Generating " << TCP_BYTE_SZ << " bytes of data to serve up." << endl;
    DataBuffer dataToServe = getRandomData(TCP_BYTE_SZ);
    sha1calc.calc_server_digest(dataToServe);
    cout << "SHA1 hash of server data: " <<
    sha1_to_str(sha1calc.get_server_digest()) << endl;
    SrvPtr server(new TestTcpServer(std::atoi(SERVER_PORT.c_str()), dataToServe, io_service));
    server->start();

    try
    {
        // Fire up a basic TCP client for testing
        cout << "Firing up TCP client on port: " << SERVER_PORT << endl;
        DataBuffer clientData;
        ConnPtr client(new TcpConnection(SERVER_HOST, SERVER_PORT, TIMEOUT, TIMEOUT, io_service));
        size_t bytesRead = client->read(clientData);

        BOOST_REQUIRE( bytesRead == TCP_BYTE_SZ );
        BOOST_REQUIRE( clientData.size() == TCP_BYTE_SZ );
        sha1calc.calc_client_digest(clientData);
        BOOST_REQUIRE( sha1calc.compare() );// SHA-1 hashes better matctype filter texth

    }
    catch (SocketTimeoutException& e)
    {
        cerr << "Socket timeout: " << e.what() << endl;
        BOOST_FAIL("Socket Timeout");
    }
    catch (const TcpException& e)
    {
        cerr << "TCP Error: " << e.what() << endl;
        BOOST_FAIL("TCP Exception");
    }
    catch (const exception& e)
    {
        cerr << "Other Error: " << e.what() << endl;
        BOOST_FAIL("Unknown Exception");
    }

}

BOOST_AUTO_TEST_CASE(UdpTest)
{
    boost::asio::io_service io_service;
    std::stringstream error;
    try
    {
        cout << endl << "**** UDP Test ****" << endl;

        ConnPtr client(new UdpConnection(SERVER_HOST, SERVER_PORT, TIMEOUT, CLIENT, io_service));
        ConnPtr server(new UdpConnection(SERVER_HOST, SERVER_PORT, TIMEOUT, SERVER, io_service));

        for (int i = 0; i != 10; ++i)
        {
            Sha1Calc sha1calc;

            // Write the data to the client
            DataBuffer clientData = write_data(client, sha1calc, UDP_BYTE_SZ, i);

            // Read the data from the server
            DataBuffer serverData = read_data(server, sha1calc, i);

            // Make sure the client data matches the server data
            BOOST_REQUIRE( sha1calc.compare() );

            cout << endl; // new-line
        }
    }
    catch (const SocketTimeoutException& e)
    {
        error << "Socket timeout: " << e.what() << endl;
        BOOST_FAIL(error.str());
    }
    catch (const UdpException& e)
    {
        error << "UDP Exception: " << e.what() << endl;
        BOOST_FAIL(error.str());
    }
    catch (const exception& e)
    {
        error << "Other Error: " << e.what() << endl;
        BOOST_FAIL(error.str());
    }
}

BOOST_AUTO_TEST_CASE(UdpThreadTest)
{
    boost::asio::io_service io_service;
    std::stringstream error;
    try
    {
        cout << endl << "**** UDP Multi-thread Test ****" << endl;
        ConnPtr server(new UdpConnection(SERVER_HOST, SERVER_PORT, THREAD_TIMEOUT, SERVER, io_service));
        Sha1Calc sha1calc;

        for (int i = 0; i != 10; ++i)
        {
            // Read the data from the server, make sure it matches
            // the expected request?
            DataBuffer serverData = read_data(server, sha1calc, i);
            BOOST_REQUIRE(dataBufferToStr(serverData) == EXPECTED_UDP_REQUEST);

            // Repply on the remote socket
            thread t1(bind(&write_data_threaded, server, sha1calc, UDP_BYTE_SZ, i));
            cout << endl; // new-line

        }
    }
    catch (const SocketTimeoutException& e)
    {
        error << "Socket timeout: " << e.what() << endl;
        BOOST_FAIL(error.str());
    }
    catch (const UdpException& e)
    {
        error << "UDP Exception: " << e.what() << endl;
        BOOST_FAIL(error.str());
    }
    catch (const exception& e)
    {
        error << "Other Error: " << e.what() << endl;
        BOOST_FAIL(error.str());
    }
}

BOOST_AUTO_TEST_CASE(UnixSocketTest)
{
    boost::asio::io_service io_service;
    try
    {
        cout << endl << "**** UNIX Socket Test ****" << endl;

        std::remove(FILE_SOCKET.c_str());
        ConnPtr server(new UnixSocketConnection(FILE_SOCKET, TIMEOUT, SERVER, io_service));
        ConnPtr client(new UnixSocketConnection(FILE_SOCKET, TIMEOUT, CLIENT, io_service));

        Sha1Calc sha1calc;

        DataBuffer clientData = write_data(client, sha1calc, UDP_BYTE_SZ, 0);
        cout << "Wrote the data to the Unix Socket client:" << dataBufferToStr(clientData) << endl;

        DataBuffer serverData = read_data(server, sha1calc, 0);
        cout << "Read from UDP Server: " << dataBufferToStr(serverData) << endl;

        BOOST_REQUIRE( sha1calc.compare() );
        cout << sha1_to_str(sha1calc.get_server_digest()) << endl;

    }
    catch (const SocketTimeoutException& e)
    {
        cerr << "Socket timeout: " << e.what() << endl;
        BOOST_FAIL("Socket Timeout");
    }
    catch (const UnixSocketException& e)
    {
        cerr << "UNIX Socket Error: " << e.what() << endl;
        BOOST_FAIL("UNIXSocket Exception");
    }
    catch (const exception& e)
    {
        cerr << "Other Error: " << e.what() << endl;
        BOOST_FAIL("Unknown Exception");
    }

    std::remove(FILE_SOCKET.c_str());
}

BOOST_AUTO_TEST_SUITE_END()

    } 
```

用Java编写的客户端：

```
package com.shaw.udp.sender;

import java.net.*;
import java.nio.ByteBuffer;
import java.nio.channels.DatagramChannel;

public class Client {

    public static void main(String[] args) throws Exception {

        DatagramChannel channel = DatagramChannel.open();
        SocketAddress address = new InetSocketAddress(0);
        SocketAddress client = new InetSocketAddress(SERVER_HOST, 10999);
        DatagramSocket socket = channel.socket();

        // This is the local socket
        socket.setSoTimeout(5000);
        socket.bind(address);

        for (int i = 0; i != 10; ++i) {
            // Send the data to the remote server
            ByteBuffer buffer = ByteBuffer.wrap("GOT_ANSWER?".getBytes());
            channel.send(buffer, client);
            System.out.println("Iter: " + i + " => Sent request: "
                    + new String(buffer.array()));

            // Listen for reply from the server
            buffer = ByteBuffer.allocate(64);
            channel.receive(buffer);
            System.out.println("Iter: " + i + " => Got reply: "
                    + new String(buffer.array()));
        }
    }
} 
```

# c# - 我应该使用单个 DataGrid、多个 DataGrid 还是完全不同的东西？

> ID：10390162
> 
> 赞同：2
> 
> 时间：2012-04-30T20:30:22.283
> 
> 标签：c#, wpf, datagrid

我有一组我们称之为 People 的对象，每个对象由 Name、ID 和 Time 字符串组成。这些人必须显示在类似于固定数量的行和 9 列的网格上。这个想法是将人员作为行添加到网格左侧的第 1、2 和 3 列。一旦最后一行被填充，后续行将添加到第 4、5 列组的“顶部”和6 在“包装”效果。在该分组填满后，使用最后一组 7、8 和 9。

我正在尝试决定是使用单个 DataGrid 来执行此操作，还是使用三个单独的 DataGrid。数据将每隔几秒钟更新一次，因此性能是一个问题。但是，我主要关心的是哪种方法更容易实施。是否有具有这种“包装”功能的第三方网格控件？

这是一个使用 WPF 的 C# 应用程序。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:34:00.000

我根本不会使用任何类型的 DataGrid，只使用带有[WrapPanel](http://msdn.microsoft.com/en-us/library/system.windows.controls.wrappanel.aspx)内容演示器和定义明确的 ItemsTemplate 的 ListView。

这是一个示例样式，可帮助您入门：

```
<Style TargetType="{x:Type ListView}">
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate>
          <ScrollViewer Margin="{TemplateBinding Padding}">
            <WrapPanel ItemWidth="150" IsItemsHost="True" MinWidth="100"
                       Width="{Binding ActualWidth,RelativeSource={RelativeSource AncestorType=ScrollContentPresenter}}">
            </WrapPanel>
          </ScrollViewer>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

# php - 一个带有长 SQL 语句的巨大 XML 文件？

> ID：10390164
> 
> 赞同：2
> 
> 时间：2012-04-30T20:30:25.263
> 
> 标签：php, mysql, google-maps, google-maps-api-3

我有一个包含大约 10 个表的数据库，它们都以某种方式相互连接（外键、关联表）。

我想使用所有这些数据在我的谷歌地图实例上绘制它作为带有信息框的标记，并能够过滤地图。

从[Google Maps Articles](https://developers.google.com/maps/documentation/javascript/articles)来看，您必须将 XML 与数据库中的数据一起使用来绘制标记和其他所有内容。

但是生成该 XML 文件的正确方法是什么？在加载网页和地图时，有一个巨大的 SQL 语句来生成一个包含所有表的全部数据的 XML 文件，还是有更正确的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:38:09.233

您绝对不必使用 XML 在 Google 地图的实例上放置标记。你**可以**，但如果它看起来很困难，你不必这样做。我经常使用 Google Maps V3 API，我建议您将数据导出为 JSON 并使用 PHP 将其嵌入到您的文档中，或者使用 Ajax 使其可供 JavaScript 加载。

从数据创建交互式标记非常容易。您只需要遍历您的数据，为您想要在地图上的每个点创建一个 Marker 对象，提供一些您希望在信息窗口中显示的 HTML，并在 Marker 的点击事件中显示该信息窗口。

我将向您[推荐 Google Maps API v3 初学者教程](https://developers.google.com/maps/documentation/javascript/tutorial)，而不是用茶匙的准确性指导您，其中包括如何创建标记并将其显示在地图上的示例。

有趣的是，您可以控制为每个标记显示哪个图标（您可以为所需的任何图像提供 URL），以及使它们反弹。总而言之，使用 JavaScript 比使用 XML 拥有更多的控制权。

**关于性能**，我会听取 cilosis 的建议，并以您最终选择的任何格式缓存您的 MySQL 数据。如果你要使用 JSON，你也可以缓存它的结果。您可以简单地将输出保存在名为“mysql-export-1335797013.json”之类的文件中。该数字是一个 Unix 时间戳，您可以使用它推断何时需要刷新数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T20:33:23.760

**第**一次使用 SQL为特定查询生成 XML，然后缓存该 XML 输出以供以后使用。第一次它可能很慢，但之后它已经生成并且会非常快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T06:38:58.990

如果您想使用 XML，因为 PHP 和 AJAX 使其相对容易，那么就这样做。这就是示例使用它的原因。但是您*绝对*不限于 XML。JSON 是常用的，因为它也很容易与 PHP 一起使用，下载量比 XML 小，并且以 Javascript 可直接使用的形式交付。或者您可以使用任何其他可以由您的页面的 Javascript 操作的东西。

至于是否使用一个庞大的查询和数据下载，您也不必这样做。你可以这样做：它可能很慢——不仅要进行查询，还要传输数据，缓存查询结果无济于事。您的用户将不得不等待数据到达，然后由您的 Javascript 操作以显示在地图上。

您可能会考虑执行一个相当简单的查询来获取要显示的基本数据，以便用户可以合理地快速查看某些内容，然后进行更多查询，也许是需要数据。如果用户不打算单击并查看它，那么下载大量 InfoWindow 数据是没有意义的。在这种情况下，提供标记数据和基本信息窗口数据，并且仅在用户实际请求时才获取详细数据（即，使用两阶段信息窗口）。

# perl - 获取当前进程的 perl 可执行文件的绝对路径

> ID：10390173
> 
> 赞同：9
> 
> 时间：2012-04-30T20:31:10.863
> 
> 标签：perl, raku

有没有办法为当前进程获取 Perl 可执行文件的*绝对路径？*

`$^X`会给我 Perl 可执行文件的名称，但文档指出它有时是相对路径，例如在 OS X 上似乎是这样。

`ExtUtils::MakeMaker`似乎有一些魔法可以找到绝对路径，因为它在我的 OS X 上生成的 Makefile 包含

```
PERL = /usr/local/bin/perl
FULLPERL = /usr/local/bin/perl 
```

但我不知道它是如何做到这一点的，也不知道其他人是否容易获得魔法。

编辑：感谢鲍罗丁的`$Config{perlpath}`提示。为此`ExtUtils`，我在 中找到了这个花絮`ExtUtils::MM_Unix::_fixin_replace_shebang`，我猜这是 MakeMaker 用来替换`#!perl`正确的 shebang 行的东西。

```
if ( $Config{startperl} =~ m,^\#!.*/perl, ) {
    $interpreter = $Config{startperl};
    $interpreter =~ s,^\#!,,;
}
else {
    $interpreter = $Config{perlpath};
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T04:16:52.147

我想你要找的是`$Config{perlpath}`.

如果您希望您的代码非常便携，您可能必须将文件类型附加到该值；这在[`perlport`](http://perldoc.perl.org/perlport.html#Command-names-versus-file-pathnames)文档中有所描述。否则，您只需要这样：

```
use Config;
my $perl = $Config{perlpath}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T23:47:48.417

您可以通过核心[Config](http://search.cpan.org/~flora/perl/configpm)模块获取它。

```
use Config;
say $Config{perl5};   # current perl binary 
```

我*认为*应该始终包含绝对路径，但我不能保证。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-30T21:10:14.510

Perl 包含核心模块[File::Spec](http://p3rl.org/File%3a%3aSpec)，它可以将相对路径转换为绝对路径。

```
my $full_path_to_perl = File::Spec->rel2abs($^X); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-03-04T21:04:22.273

对于 perl6 (raku)：`$*EXECUTABLE-NAME`包含当前运行的 Raku 解释器的完整路径（如`sys.executable`Python）

要获取完整的命令行：

```
say ($*EXECUTABLE-NAME, $*PROGRAM-NAME, |@*ARGS).join(' '); 
```

更多[变量文档](https://docs.perl6.org/language/variables#$*EXECUTABLE-NAME)

# c# - MVC DataAnnotations 删除错误消息

> ID：10390176
> 
> 赞同：1
> 
> 时间：2012-04-30T20:31:15.523
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3

我有以下视图模型字段：

```
[Required]
[StringLength(9)]
[RegularExpression(@"\d{9}", ErrorMessageResourceName = "Number_Format", ErrorMessageResourceType = typeof(MyTypeOfResource))]
public string Number{ get; set; } 
```

正则表达式过滤器将处理大于 9 个字符和正确格式的输入并显示其验证消息，但`StringLength`也会显示其自己的默认错误消息。删除`[StringLength(9)]`将解决两个不同消息的问题，但我假设此过滤器为 SQL 提供有关数据类型最大大小的有价值信息。还有其他方法吗？谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:36:54.337

如果您删除`StringLength`并且只有：

```
[Required]
[RegularExpression(@"\d{9}", ErrorMessageResourceName = "Number_Format", ErrorMessageResourceType = typeof(MyTypeOfResource))]
public string Number{ get; set; } 
```

你应该很好。将`RequiredAttribute`验证该属性是否已设置，`RegularExpressionAttribute`并将验证它是一个由 9 个字符组成的字符串，这些字符都是数字。

**编辑：**

关于假设过滤器为 SQL 提供有价值信息的评论......不，它不是为了这样做。DataAnnotations 旨在架起客户端和表示层验证之间的桥梁。MVC 确实在内部使用 DataAnnotations 来验证 ViewModel，但 ViewModel 不一定（阅读：不应该）被视为域模型。ViewModel 是您希望向用户显示的模型，而域模型通常代表数据。

不久前，我写了一篇博客，向您介绍了 MVC 3 中的 DataAnnotations，以及该框架如何将它们转变为客户端上不显眼的 JavaScript 验证。绝对值得一试。

[代码在这里](https://github.com/jimschubert/ContainsAttributeExample)，[博客在这里](http://www.ipreferjim.com/2011/08/dataannotations-mvc3-unobtrusive-validations/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:33:33.060

更改 StringLength 属性以包含空白错误消息，如下所示：

```
[StringLength(9, ErrorMessage = "")] 
```

# ruby - ruby - 奇怪的参数行为

> ID：10390179
> 
> 赞同：-1
> 
> 时间：2012-04-30T20:31:31.280
> 
> 标签：ruby, sinatra

我不小心创建了以下检查，效果很好，但我很好奇为什么:)

1.  首先，我知道我可以分配`:a`而不是 'a' ;)
2.  我知道这个检查的正确公式，我只是好奇为什么会这样
3.  我不在乎优化这个（阅读2）

```
if params['a'] < 0 || params['a'] > params['b || params[:b] < 1] 
```

为什么这行得通，如果`['b`.

除此之外，一切正常，直到我删除 last`]`或将其更改为其他内容。

更新：

这是红宝石的输出：

```
irb> params

 => {"a"=>3, "id2"=>"2", "b"=>2, "id"=>"1", :id=>"2"}

irb> if params['a'] < 0 || params['a'] > params['b' || params[:b] < 1]
irb>   puts 'strange...'
irb> end

strange...

=> nil 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:59:05.400

好吧，看起来你有一个开放的报价，它在其他地方被关闭，后来在路上，在另一条线上。

有趣的事实：

```
ruby_hash = {}
ruby_hash['class Atom
def initialize
end
end'] = 0 
```

作品。因为它只是一个字符串键。因此，您只是将一个巨大的长字符串评估为“参数”哈希的键，该哈希肯定会评估为*nil*，因为它不是哈希中的现有键。

* * *

编辑！您编辑了问题并提供了更多信息。让我们分解一下。

```
params = {"a"=>3, "id2"=>"2", "b"=>2, "id"=>"1", :id=>"2"}
# Simple enough, nothing strange here.
if params['a'] < 0 || params['a'] > params['b' || params[:b] < 1]
    puts 'strange...'
end
The plot thickens, or does it? 
```

如果！

```
params['a'] < 0 
```

这当然意味着：如果 params 中“a”的值小于 0

```
|| 
```

...这意味着“或”

```
params['a'] > 
```

停在这里一秒钟 - 如果 'a' 的值大于....

```
params['b' || params[:b] < 1] 
```

等等，什么？让我们更深入地了解一下。

```
params[ => We look inside the hash
'b' || params[:b] < 1 ## HERE IS THE 'MAGIC' => 'b' || params[:b] < 1
] # end of the key 
```

所以神奇的是：我们想要 OR 语句的结果：

*   字符串'b'
*   'params[:b] < 1 的评估

那么到底发生了什么？好吧，事实上，因为 'b' 不是假的，它只会返回 params['b'] 的值，所以这就是你的 if 语句的真正含义：

```
if params['a'] < 0 || params['a'] > params['b'] 
```

如果'b'由于某种原因被评估为假，你最终会得到“params [params [b：] < 1]”，在你的情况下它是假的，然后意味着“params [假]。

这有意义吗？

# c++ - 是否可以使用 .pro 文件基于计算机体系结构动态包含共享对象？

> ID：10390180
> 
> 赞同：2
> 
> 时间：2012-04-30T20:31:36.100
> 
> 标签：c++, qt

我目前正在与同事一起开发 QT 应用程序。我这个应用程序的特定部分需要使用第三方库。由于我们只需要这个库的一小部分，我们决定制作一个 .so 文件以包含在我们的项目中，以避免不必要地将文件传输到我们的存储库。我们最近遇到了麻烦，但当我们被提醒由于我们有不同的架构（32 位与 64 位）时，.so 文件基本上没用。由于我们有这些 .so 文件，是否可以同时包含这两个文件，并且在构建项目时动态检测它正在构建的架构并包含适当的共享对象文件？

我无法弄清楚的部分是识别 .pro 文件中的架构。我在[qt forums](http://qt-project.org/faq/answer/how_can_i_detect_in_the_.pro_file_if_i_am_compiling_for_a_32_bit_or_a_64_bi)上找到了这个答案，但正如有人评论的那样，这个解决方案仅在 Windows 上可用。我还找到了关于使用环境变量 $MACHTYPE 来检测架构的建议，但如果我没记错的话，那是一个仅限 linux 的解决方案。是否有一种真正的跨平台检测架构的方法？

我们也考虑过将第三方库源的 tarball 打包到应用程序中，但我们认为要求用户在使用我们的程序之前自己编译库是“不方便用户的”。我们同意，如果可能的话，这个程序应该尽可能独立。感谢您阅读本文！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:47:35.380

我现在正在做同样的事情。Qt SDK 1.2 有 QMAKE_HOST.arch

```
contains( QMAKE_HOST.arch, x86_64 ) {
   LIBS += 64bitlib.a
}
else {
   LIBS += 32bitlib.a
} 
```

# ubuntu - 如何卸载 Xen

> ID：10390181
> 
> 赞同：2
> 
> 时间：2012-04-30T20:31:38.943
> 
> 标签：ubuntu, xen

我最近在服务器上安装了 Xen，现在我无法远程访问服务器，并且即使运行`/etc/init.d/networking restart`.

我现在想从我的服务器上**完全卸载 Xen。**我该怎么做呢？我在网上找不到任何卸载指南。另外，我必须从命令行而不是 GUI 界面来完成。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:54:55.107

从源代码：

```
make uninstall 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-04T16:55:30.160

apt-get autoremove [包名]

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-09T19:31:39.907

如果您刚开始使用 Xen，请尝试从 Ubutnu 存储库安装它，而不是从源代码安装。然后，当您对它有更多了解时，从源代码进行自定义安装可能会更好地满足您的要求。

apt-cache 搜索 xen

找到你想要的包，然后：

sudo apt-get install xen_package_name_that_you_found

# jquery - 更早地为 jQuery 选项卡应用 UI？

> ID：10390182
> 
> 赞同：0
> 
> 时间：2012-04-30T20:31:40.717
> 
> 标签：jquery, asp.net

我有这个页面：[http ://www.shopdesertridge.com/events/full-calendar/](http://www.shopdesertridge.com/events/full-calendar/)

如果您正在加载它，您会注意到一段时间“May”选项卡在页面加载时是蓝色的，并且在加载页面内容**之后调用****了正确的样式**（js 方法）。

 **你知道任何让这个 UI 样式更早的技巧吗？

对于 asp.net 程序员：TAB 是一个特定月份的中继器，所以我什至尝试在何时调用 js 方法，`ItemDataBound`但结果与在准备好文档时调用它时相同......

用于呈现选项卡 UI 的 js：

```
function tabsUi(){
    $("#tabs").tabs();
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:37:41.480

让样式更快应用的最有效方法是将所需的类直接包含在标记中。

```
<div class="ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs">
   <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
     <li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#tabs-1">Nunc tincidunt</a></li>
     <li class="ui-state-default ui-corner-top"><a href="#tabs-2">Proin dolor</a></li>
   </ul>
   <div class="ui-tabs-panel ui-widget-content ui-corner-bottom" id="tabs-1">
      <p>Tab one content goes here.</p>
   </div>
    ...
</div> 
```

这样，一旦加载 css，内容就会被设置样式，而不是等待 DOMReady 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:39:27.017

你可以试试`display:none`默认，然后`tabs()`，然后`show()`

```
<div id="tabs" style="display:none">
    <ul>
        <li><a href="#tabs-1">1</a></li>
        <li><a href="#tabs-2">2</a></li>
        <li><a href="#tabs-3">3</a></li>
    </ul>
    <div id="tabs-1">1</div>
    <div id="tabs-2">2</div>
    <div id="tabs-3">3</div>
</div>

<script>
    $(function()
    {
        $( "#tabs" ).tabs();
        $( "#tabs" ).show();
    });
</script>​ 
```**

# c# - 在屏幕上画线？

> ID：10390183
> 
> 赞同：2
> 
> 时间：2012-04-30T20:31:45.543
> 
> 标签：c#, asp.net, drawing

我一直在阅读一些 asp.net 文章，并尝试了一些代码，但我想我可能会感到困惑。您能否使用 c# 在 ASP.NET webform 上使用代码在屏幕上画线？

如果是这样，有人可以指导我举一些例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T20:33:01.700

您不能直接在网络表单上绘图。您可以在图像上绘图，然后将其嵌入到您的网络表单中（就像任何其他图像一样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:35:14.737

你可以做一个**画布**，然后你可以在上面画任何你想画的东西。但是直接画是不可能的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T20:36:09.223

如果你对 HTML5 没问题，你可以尝试 lineto Javascript 方法：

```
<script>
  context.lineTo(100, 200);
</script> 
```

请参考@以下链接了解更多详情： [http ://www.html5canvastutorials.com/tutorials/html5-canvas-lines/](http://www.html5canvastutorials.com/tutorials/html5-canvas-lines/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T20:41:10.047

因为您的服务器端代码没有屏幕。您的代码生成 HTML、JavaScript 等，然后浏览器使用该内容在客户端屏幕上呈现它。因此，您的选择是在服务器端代码中生成图像（绘制您需要的所有内容）并将其发送到浏览器，或者您可以使用 JavaScript 并向浏览器发送如何绘制线条的说明。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T20:42:50.080

您可能可以使用 System.Drawing 命名空间类创建一个新图像，然后执行一些操作，例如将其动态加载到`<img />`标签中......但根据您要完成的工作，使用 JavaScript 库可能会容易得多某种或使用某种非常简单的线条图像并使用 css 调整长度/高度。

需要更多细节来了解您要做什么。正如其他人指出的那样，您的 C# 代码没有直接的方式与页面交互。您必须在页面上有一些东西，比如 img 标记，然后将它的源设置为 C# 文件，比如处理程序 (.ashx)。在该处理程序中，您可以生成图像，然后将响应内容类型设置为 image/jpg 并将原始字节写入响应流......

不过，对于可以使用 CSS 或 javascript 完成的事情，这似乎有点过头了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-30T20:36:26.213

不确定“画一条线”是什么意思，但如果您使用的是网络浏览器，则需要某种 HTML 对象来显示这条“线”。如果您只需要一条水平线，您可以添加一个 HR html 标签并使用 CSS 玩具对其进行样式化。您还可以在图像或 HTML5 Canvas 中包含此行。

# c++ - 远程对象的 C++ 调用方法（类似 RPC）

> ID：10390184
> 
> 赞同：3
> 
> 时间：2012-04-30T20:32:33.013
> 
> 标签：c++, windows, ipc, pipe, rpc

我正在寻找一个允许我在另一个进程（在 Windows 上）中调用对象的成员函数的 RPC 库。

我目前遇到的问题是一些服务器端对象已经存在并且有多个实例。服务器应该能够将指针/标识符传递给客户端，客户端实现代理，然后将调用定向到远程对象实例。所以我基本上想要的是这样的：

```
Client:
TestProxy test = RemoteTestManager.GetTestById(123);
test.echo("bla"); 
```

其中 Test 的实例已经存在于服务器上，而 RemoteTestManager 是客户端在另一个 rpc 调用中获得的服务器上的管理器类。此外，它最好在命名管道上运行，因为同一台机器上可以有多个服务器（实际上我想要更像一个简单的 IPC：D）。

所以我的问题实际上是：C++ 是否有类似的东西，还是我必须自己编写一个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T00:19:16.903

就跨网络协议缓冲区的低级序列化消息而言，这是一种常见的选择......

[http://code.google.com/p/protobuf/](http://code.google.com/p/protobuf/)

如需更完整的 RPC 堆栈，请查看 Apache Thrift...

[http://thrift.apache.org/](http://thrift.apache.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T05:00:10.193

COM 怎么样？似乎完全符合您的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-10T19:47:17.057

您可能已经找到了解决方案。仅供参考，我创建了一个与您在此处询问的内容相匹配的库。看看[CppRemote](http://www.cppremote.com)库。该库具有以下与您的描述相匹配的功能：

*   按名称（std::string）获取指向服务器对象的指针。
*   在服务器上绑定现有对象（非侵入式），然后从客户端获取该对象的代理。
*   服务器可以绑定到多个现有对象的实例。
*   它已命名管道传输。
*   轻巧且易于使用。

服务器代码

```
Test test1, test2;
remote::server svr;
svr.bind<itest>(&test1, "test1");
svr.bind<itest>(&test2, "test2");
svr.start(remote::make_basic_binding<text_serializer, named_pipe_transport>("pid"));
... 
```

客户代码

```
remote::session client;
client.start(remote::make_basic_binding<text_serializer, named_pipe_transport>("pid"));

auto test1 = client.get<itest>("test1");
auto test2 = client.get<itest>("test2");
test1->echo("bla");
test2->echo("bla"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T21:48:28.737

[ZeroMQ](http://www.zeromq.org/)可能是目前最好的 IPC 系统，它允许客户端/服务器拓扑的多种组合。它也非常快速和高效。

你如何访问服务器对象取决于它们是如何实现的，CORBA 有这个功能，但我现在不会尝试使用 CORBA（或者然后是 TBH）。许多 RPC 系统允许您根据需要创建对象，或连接到单个实例。连接到为您创建并在该会话期间为每次调用保留的对象（即为每个客户端创建并保持活动的对象）仍然相当普遍。对象池也相当常见。但是，您必须管理这些服务器对象的生命周期，我不能真正建议您，因为您还没有说明如何管理您的对象。

我怀疑你想要命名管道，坚持 tcp/ip 连接 - 连接到 localhost 是一个非常轻量级的操作（COM 在这个配置中实际上是零开销）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-19T15:54:53.603

There are candidates on top of the list. But it depends on problem space. A quick look, Capnproto, by kenton varda, maybe a fit. CORBA is a bit old but used in many systems and frameworks such as ACE. One of the issues is PassByCopy of capability references which in capnproto PassByReference and PassByConstruction also provided. COM system also got some problems which needs it's own discussion. ZeroMQ is really cool which I caught a cold once. And it does not support RPC which means you have to implement it on level zero messaging. Also Google protobuf, kenton varda, could be a choice if you are not looking for features such as capabilities security, promise pipelining and other nice features provided by capnproto. I think you better give it a try and experiment yourself.

As a reminder, RPC is not only about remote object invocation. Areas of concern such as adequate level of abstraction and composition, pipelining, message passing, lambda calculus, capability security, ... are the important ones which have to be paid close attention. So, the better solution is finding the efficient and elegant one to your problem space.

Hope to be assistfull.

Bests, Omid

# xcode - install_name_tool 报告格式错误的对象

> ID：10390186
> 
> 赞同：9
> 
> 时间：2012-04-30T20:32:41.390
> 
> 标签：xcode, osx-snow-leopard, install-name-tool

每次我尝试在我的机器上使用 install_name_tool 时，它都会报告以下内容

```
install_name_tool: object: Abacate malformed object (unknown load command 4) 
```

我读到在构建二进制文件时可能是一个错误。为了检查，我创建了最简单的 hello world c++ 程序并尝试使用 install_name_tool 进行更改。没用。我究竟做错了什么？

目前我有运行 Snow Leopard OS 的 XCode 4.2。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-09T20:35:27.457

显然，当 XCode 更新时 install_name_tool 没有更新。您需要从 XCode Preferences 安装命令行工具。另请参阅[OS X Lion 上的 install_name_tool](https://stackoverflow.com/questions/11598082/install-name-tool-on-os-x-lion)。这为我解决了同样的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-23T11:24:19.400

设法使其适用于 Mac OS 10.9.3

[https://github.com/Homebrew/homebrew/issues/26544](https://github.com/Homebrew/homebrew/issues/26544)

$$:~ otool -L /usr/bin/install_name_tool

> /usr/bin/install_name_tool：/usr/lib/libxcselect.dylib（兼容版本 1.0.0，当前版本 1.0.0） /usr/lib/libSystem.B.dylib（兼容版本 1.0.0，当前版本 1197.1.1 )

$$:~ pkgutil --file-info /usr/bin/install_name_tool

> 卷：/路径：/usr/bin/install_name_tool pkgid：com.apple.pkg.Essentials pkg-version：10.9.0.1.1.1306847324 安装时间：1390577801 uid：0 gid：0 模式：755

wget 上没有更多错误：

> $$:~ wget dyld：库未加载：
> 
> @@HOMEBREW_PREFIX@@/opt/openssl/lib/libssl.1.0.0.dylib 引用自：/usr/local/bin/wget 原因：找不到图像

# delphi - 将 HTML 组件安装到 Delphi XE

> ID：10390189
> 
> 赞同：4
> 
> 时间：2012-04-30T20:32:53.967
> 
> 标签：delphi, delphi-xe

我认为 pbear 的组件 HTML Components，v 9.45，正是我所需要的。他的免费下载只有 Delphi 2006 和更早版本的软件包。我有德尔福 XE。我如何将他的组件安装到我的 Delphi 中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T20:44:24.970

试试这个 Google 代码下载网站[THtmlViewer](http://code.google.com/p/thtmlviewer/)。似乎更新到 XE2 版本加上 Lazarus。

另请参阅[SO](https://stackoverflow.com/a/9146591/576719) question [How to display an email images on Pbear Html viewer component？](https://stackoverflow.com/q/9143306/576719).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:33:16.123

你考虑过使用[Delphi Chromium Embedded](http://code.google.com/p/delphichromiumembedded/)吗？这是[Google 的 Chromium](http://en.wikipedia.org/wiki/Chromium_%28web_browser%29)的 Delphi API ，由 Google Chrome 网络浏览器使用。支持几个 Delphi 版本，包括 XE 和 XE2。

除非您只需要基本的浏览器支持，否则使用对现代 Web 标准提供可靠支持的最新浏览器是有意义的。

该存储库包括用于 VCL 和 FireMonkey的 Delphi[示例项目。](http://code.google.com/p/delphichromiumembedded/source/browse/#svn/trunk/demos)

# javascript - 如果我只能使用 javascript，如何按日期过滤列表？

> ID：10390196
> 
> 赞同：0
> 
> 时间：2012-04-30T20:33:10.613
> 
> 标签：javascript

我有这个列表结构：

```
<ul class="pol list">                       
<li>
    <div class="tekst">
        <h2><span class="name"></span></h2>
        <p class="description"></p>                 
        <div class="commentsBar1">
            <div class="commentsBarL1">
                    <h5>
                    <strong class="category">
                    <span style="display:none;"></span>
                    <span class="d">27.12.2011</span>
                    </strong>    
                </h5>
                <h5><strong></strong></h5>
            </div>
        </div>
    </div>
</li>
<li>
    <div class="tekst">
        <h2><span class="name"></span></h2>
        <p class="description"></p>                 
        <div class="commentsBar1">
            <div class="commentsBarL1">
                <h5>
                    <strong class="category">
                    <span style="display:none;"></span>
                    <span class="d">03.03.2012</span>
                    </strong>    
                </h5>
                <h5><strong></strong></h5>
            </div>
        </div>
    </div>
</li>
</ul> 
```

我需要 js 来隐藏所有包含特定范围之外的日期的列表标签。日期范围由用户给出，开始和结束日期的给出方式与列表中的日期相同 (dd.mm.yyyy)。

```
<input id="Date1" name="Date1"> 
<input id="Date2" name="Date2"> 
```

我有这个日期比较代码：

```
var dControl = document.getElementsByClassName("d");
var d1Control = document.getElementById("Date1");
var d2Control = document.getElementById("Date2");

var arrD = dControl.value.split(".");
var dd0 = new Date(arrStartDate[2], arrStartDate[1], arrStartDate[0]);
var arrD1 = d1Control.value.split(".");
var dd1 = new Date(arrStartDate[2], arrStartDate[1], arrStartDate[0]);
var arrD2 = d2Control.value.split(".");
var dd2 = new Date(arrStartDate[2], arrStartDate[1], arrStartDate[0]);

    if((dd0 <= dd2 && dd0 >= dd1)) {
            return true;
    }
    return false; 
```

还有一件事......列表元素的数量因页面而异，因此我还需要了解列表大小，但我认为“长度”很容易做到。

任何想法我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T20:40:32.293

您将需要编写 javascript 来根据您拥有的日期构建 dom。我建议使用诸如 mustache 或 handlebars 之类的模板框架来保持代码整洁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:06:42.730

只需遍历具有“d”类的元素并检查它们是否符合您的日期标准，如果不符合，则将该 li 设置为显示“无”。您必须在 DOM 节点树中找到比您的日期高 8 级的 li。

# android - 为什么单击按钮时活动不改变？

> ID：10390203
> 
> 赞同：1
> 
> 时间：2012-04-30T20:33:47.253
> 
> 标签：android, android-intent, onclick, android-activity, android-button

当您尝试通过单击按钮来更改活动时，我发现您必须使用 Intent。但是在我的代码中使用它似乎不起作用。我的代码有问题吗？

```
 public class SearchActivity extends Activity implements OnClickListener{

    private ListView recipes;
    Intent intent;
    Button button;
    EditText input;

    public void onCreate(Bundle savedInstanceState) {
          super.onCreate(savedInstanceState);

          setContentView(R.layout.searchlist);

          //EditText input = (EditText)findViewById(R.id.recipeName);
          button = (Button)findViewById(R.id.submit);
          input = (EditText)findViewById(R.id.recipeName);

          //recipes = (ListView)findViewById(R.id.recipes);
          //recipes.setAdapter(new ArrayAdapter<String> (this, R.layout.main, getResources().getStringArray(R.array.BaconSandwich)));
          button.setOnClickListener(this);
      }

      public void onClick(View clicked) {

          String value = input.getText().toString();
          Toast.makeText(this, value, Toast.LENGTH_SHORT).show();

          if(clicked == button) {
            recipes = (ListView)findViewById(R.id.recipes);
            Toast.makeText(this, "It is working for this item.", Toast.LENGTH_SHORT).show();
            Intent i = new Intent(SearchActivity.this, RecipeMethodActivity.class);
            SearchActivity.this.startActivity(i);
          }
      } 
```

我不确定这是否只是一个简单的命名错误，或者我调用它的方式是错误的。任何帮助都会很棒。

此外，我已将要更改为 (RecipeMethodActivity) 的活动添加到 Android 清单中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:47:56.807

您需要在 onClick 方法中检查视图的 ID，如下所示：

```
public void onClick(View clicked) {

      String value = input.getText().toString();
      Toast.makeText(this, value, Toast.LENGTH_SHORT).show();

      if(clicked.getId() == R.id.submit) {
        recipes = (ListView)findViewById(R.id.recipes);
        Toast.makeText(this, "It is working for this item.", Toast.LENGTH_SHORT).show();
        Intent i = new Intent(SearchActivity.this, RecipeMethodActivity.class);
        SearchActivity.this.startActivity(i);
      }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:50:20.693

在您的`onClick`方法中，您正在比较两个`View`对象的实例是否相同。显然，`View`传递给您的`onClick`方法的对象不是`==`私有实例变量`Button button`。

您需要比较他们的 ID：

`if (view.getId() == R.id.button)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T20:47:48.697

我从未尝试使用 测试视图`clicked == button`，但这应该在您的 onCreate() 中起作用：

```
button.setOnClickListener(new OnClickListener() {
    public void onClick(View view) {
        Toast.makeText(this, "It is working for this item.", Toast.LENGTH_SHORT).show();
        Intent i = new Intent(SearchActivity.this, RecipeMethodActivity.class);
        SearchActivity.this.startActivity(i);
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T20:49:16.533

```
button.setOnClickListener(new View.OnClickListener() {
    public void onClick(View view) {
        Toast.makeText(this, "It is working for this item.",Toast.LENGTH_SHORT).show();
        Intent i = new Intent(view.getContext(), RecipeMethodActivity.class);
        i.putExtra("extra", extra);
        //use this ^ to transfer data from one activity to another
        startActivity(i);
        }}); 
```

# c# - 为什么放置在 TableLayoutPanels 中的控件不“对齐”它们的“单元格”？

> ID：10390205
> 
> 赞同：0
> 
> 时间：2012-04-30T20:34:05.530
> 
> 标签：c#, winforms, dynamic, tablelayoutpanel

我正在动态创建一个 TableLayoutPanel，然后动态创建标签和文本框以放入其中。

我可以将列数和行数分配给 TableLayoutPanel，这似乎是合乎逻辑的：

```
tableLayoutPanelGreatGooglyMoogly = new TableLayoutPanel();
tableLayoutPanelGreatGooglyMoogly.RowCount = NUMBER_OF_ROWS;
tableLayoutPanelGreatGooglyMoogly.ColumnCount = NUMBER_OF_COLUMNS; 
```

...创建放置在其中的控件：

```
Label lbl = new Label();
lbl.Parent = tableLayoutPanelGreatGooglyMoogly;
. . . 
```

...然后将创建的控件 [s] 放入指定的“单元格”（列和行）中：

```
tableLayoutPanelGreatGooglyMoogly.SetColumn(lbl, ACol); // "ACol" is the current column
tableLayoutPanelGreatGooglyMoogly.SetRow(lbl, i); // "i" is the current row 
```

...但这不起作用 - 如果我为动态创建的子控件指定宽度和高度值，或者我没有指定（在这种情况下它们太大 - 具体来说，它们的宽度太大）。

## 更新

我添加了这段代码，它没有任何区别：

// 行

```
tableLayoutPanelGreatGooglyMoogly.RowCount = NUMBER_OF_ROWS;
TableLayoutRowStyleCollection rowStyles =
    this.tableLayoutPanelGreatGooglyMoogly.RowStyles;

    foreach (RowStyle rStyle in rowStyles) {
        rStyle.SizeType = SizeType.Percent;
        rStyle.Height = 8;
    }

// COLUMNS
tableLayoutPanelGreatGooglyMoogly.ColumnCount = TOTAL_NUMBER_OF_COLUMNS;
TableLayoutColumnStyleCollection columnStyles =
    this.tableLayoutPanelGreatGooglyMoogly.ColumnStyles;

    foreach (ColumnStyle cStyle in columnStyles) {
        cStyle.SizeType = SizeType.Percent;
        cStyle.Width = 12;
    } 
```

## 更新到更新

我看到在设计时，标签或文本框（可能是任何控件）具有 Cell[col,row] 属性。如果它不是只读的，我想动态访问它，以便我可以设置：

```
lbl.Cell = i,i
txtbox.Cell = i+1,i 
```

这可以在代码中完成吗？当时似乎没有识别“Cell”属性（我猜是可以理解的）。

## 更新到 UPDATE REVISITED

我添加了这行代码：

```
tableLayoutPanelGreatGooglyMoogly.CellBorderStyle = TableLayoutPanelCellBorderStyle.Single; 
```

...现在我看到标签和文本框实际上位于我希望它们居住的单元格（列和行）中*。*

但是，我需要让标签从其单元格的左上角向下移动到单元格的中心（垂直和水平）。

即使在设计时（在表单上有一个“测试”/临时 TableLayoutPanel），添加的标签在位于 TableLayoutPanel 单元格内时也不会响应对 TextAlign 属性的更改 - 无论我将 TextAlign 设置为什么（“中间中心”似乎是最明智的），它们顽固地固定在牢房的左上角。

同样，在设计时更改标签的 Location.X 和 Location.Y 没有任何作用。标签贴在牢房的西北角，就像藤壶贴在失散已久的锚上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T06:14:16.437

很少提及使用 GridLayoutPanel 的一个重要部分是在子控件中使用 Anchor 属性。

Anchor 属性确定每个子控件将扩展到单元格的哪个边缘。

创建标签时，您可以这样做：

```
Label lbl = new Label();
lbl.Anchor = AnchorStyles.Top | AnchorStyles.Bottom | AnchorStyles.Left | AnchorStyles.Right;
lbl.Parent = tableLayoutPanelGreatGooglyMoogly; 
```

它应该将标签拉伸到单元格的完整大小。

请参阅“使用停靠和锚定在单元内定位控件”部分中的 http://msdn.microsoft.com/en-us/library/w4yc3e8c(v=vs.80).aspx [。](http://msdn.microsoft.com/en-us/library/w4yc3e8c(v=vs.80).aspx)

# c++ - 在 C++ 中创建对象

> ID：10390206
> 
> 赞同：-2
> 
> 时间：2012-04-30T20:34:11.670
> 
> 标签：c++, oop, object, constructor

我是 C++ 新手。这是我的问题。我在 h 文件中将总线、步进器声明为私有实例：

```
class Motor_control
{
public:
       ...
private:
    IICBus bus ;
    IICStepper stepper ;
    IICStepper stepper_r ;
    IICStepper stepper_l ;
}; 
```

然后在构造函数中初始化它们

```
Motor_control::Motor_control(){
    IICBus bus ("/dev/i2c-2",0,"");
    IICStepper stepper (bus,0x00, "Global addr");
    IICStepper stepper_r (bus,0x6e, "Stepper Modul");
    IICStepper stepper_l (bus,0x66, "Stepper Modul");
} 
```

IICStepper 在 .cpp 中声明：

```
 IICStepper::IICStepper(IICBus& bus, int addr, const string& name) : IICBase(bus,addr, name) { } in cpp 
```

在.h中：

```
class IICStepper : public IICBase { public: IICStepper(IICBus& bus, int addr, const std::string& name); virtual ~IICStepper(){}; ...} 
```

它比较

```
 ../src/Motor_control.h:15: error: no matching function for call to 'IICStepper::IICStepper()'
../src/Stepper.h:41: note: candidates are: IICStepper::IICStepper(IICBus&, int, const std::string&)
../src/Stepper.h:38: note:                 IICStepper::IICStepper(const IICStepper&)
../src/Motor_control.h:15: error: no matching function for call to 'IICBus::IICBus()'
../src/Bus.h:28: note: candidates are: IICBus::IICBus(const std::string&, int, const std::string&)
../src/Bus.h:17: note:                 IICBus::IICBus(const IICBus&)
../src/Motor_control.h:15: error: no matching function for call to 'IICStepper::IICStepper()'
../src/Stepper.h:41: note: candidates are: IICStepper::IICStepper(IICBus&, int, const std::string&)
../src/Stepper.h:38: note:                 IICStepper::IICStepper(const IICStepper&)
../src/Motor_control.h:15: error: no matching function for call to 'IICStepper::IICStepper()'
../src/Stepper.h:41: note: candidates are: IICStepper::IICStepper(IICBus&, int, const std::string&)
../src/Stepper.h:38: note:                 IICStepper::IICStepper(const IICStepper&)
../src/Motor_control.h:15: error: no matching function for call to 'IICStepper::IICStepper()'
../src/Stepper.h:41: note: candidates are: IICStepper::IICStepper(IICBus&, int, const std::string&)
../src/Stepper.h:38: note:                 IICStepper::IICStepper(const IICStepper&) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:35:39.643

在构造函数体进入之前，所有的用户类型都被初始化。因为你没有默认构造函数`IICStepper`，你会得到错误。

您需要使用初始化列表：

```
Motor_control::Motor_control() : 
   bus("/dev/i2c-2", 0, ""),
   stepper(bus, 0, "Global addr"),
   stepper_r(bus, 0x6e, "Stepper Modul"),
   stepper_l(bus, 0x66, "Stepper Modul") 
{

} 
```

您的版本不仅不会初始化成员，它还会创建您以后永远不会使用的新临时对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:39:04.647

我最好的猜测是，当您将字符串作为参数传递时，例如

```
"Global addr" 
```

，字符串作为“const char*”而不是“const std::string&”传递。从我的角度来看，您只是传递了错误类型的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T20:53:04.387

这是错误的：

```
Motor_control::Motor_control(){
    IICBus bus ("/dev/i2c-2",0,"");
    IICStepper stepper (bus,0x00, "Global addr");
    IICStepper stepper_r (bus,0x6e, "Stepper Modul");
    IICStepper stepper_l (bus,0x66, "Stepper Modul");
} 
```

上面的代码并没有按照你的想法做。具体来说，它创建了三个局部变量（构造函数的局部变量），它们的名称恰好与*其他*三个变量的名称相同——您的成员变量。此代码不会**初始化**您的成员变量。

您看到的错误消息是由成员变量的默认初始化引起的。为避免默认初始化，您必须在初始化列表中列出您的成员变量，如下所示：

```
Motor_control::Motor_control() : bus("/dev/i2c-2", 0, ""),
    stepper(bus, 0, "Global addr"),
    stepper_r(bus, 0x6e, "Stepper Modul"),
    stepper_l(bus, 0x66, "Stepper Modul") {
} 
```

# asp.net - 强制 asp:content 甚至 div 在滚动时保持在顶部？

> ID：10390207
> 
> 赞同：1
> 
> 时间：2012-04-30T20:34:17.060
> 
> 标签：asp.net, css

我有一个 asp:content 标签，里面有一个 div：

```
<asp:Content ID="btnContent" ContentPlaceHolderID="ButtonContent" runat="server">
  <div id="dButtons" runat="server" visible="false">
    Some CONTENT
  </div>
</asp:Content> 
```

当我向下滚动页面时，我不再看到此内容面板 (div)。即使我向下滚动，有什么方法可以强制显示它。它应该始终是可见的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:43:59.197

在 css中，`position: fixed`即使页面正在滚动，也会使元素保持原位。

# asp.net-mvc - MVC3 Web 应用程序中的自定义身份验证模块

> ID：10390208
> 
> 赞同：1
> 
> 时间：2012-04-30T20:34:20.873
> 
> 标签：asp.net-mvc, authentication, httpmodule

语境：

我们有一个内部的 Asp.Net Web 应用程序，它被配置为使用 Windows 身份验证。作为此身份验证方面的一部分，我们有一个 HttpModule，它基本上抓取 HttpContext.Current.Identity.Name 并返回一个 UserInfo 对象，该对象被放入 HttpContext.Items 集合中。

在通过 MVC3 迁移它时，我有一个基本控制器和 OnActionExecuting，我根本无法在集合中看到这个 UserInfo 项。任何见解都会很棒。这是我的设置：

基础控制器：

```
protected override void OnActionExecuting(ActionExecutingContext ctx)
        {
            if (ctx.HttpContext.Items["UserInfo"] != null)
            {
                UserInfo currentUser = (UserInfo)ctx.HttpContext.Items["UserInfo"];
                dynamic viewBag = ctx.Controller.ViewBag;
                viewBag.CurrentUser = currentUser;
            }
            else
            {
                // Unauthorized do something
            }            

            base.OnActionExecuting(ctx);
        } 
```

网络配置：

```
<system.web>
    <httpModules>
      <add type="WFS.SIG.Client.Security.Authentication.WindowsAuthentication, WFS.SIG.Client.Security" name="AuthenticationModule"/>
    </httpModules>
</system.web>....

<system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="AuthenticationModule" type="WFS.SIG.Client.Security.Authentication.WindowsAuthentication, WFS.SIG.Client.Security" />
    </modules>
</system.webServer> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T20:49:57.497

我认为您的代码应如下所示：

```
protected override void OnActionExecuting(ActionExecutingContext ctx) 
{ 
    if (ctx.HttpContext.Items["UserInfo"] != null) 
    { 
        UserInfo currentUser = (UserInfo)ctx.HttpContext.Items["UserInfo"]; 
        ViewBag.CurrentUser = currentUser; 
    } 
    else 
    { 
        // Unauthorized do something 
    }             
    base.OnActionExecuting(ctx); 
} 
```

对 HttpContext 的访问应该像这样工作。但是您可以直接访问 ViewBag。

您能否检查您的身份验证模块是否真的被调用并且是否在 HttpContext 中存储了一个对象？可以设置断点吗？

# mercurial - Hudson - 无法轮询 Mercurial

> ID：10390212
> 
> 赞同：2
> 
> 时间：2012-04-30T20:34:53.760
> 
> 标签：mercurial, hudson

我有 Hudson 2.1.2（不是 Jenkins），并且我已经将我的项目设置为每小时轮询我的 Mercurial 存储库以检查更改。我为我的 hudson 用户生成了一个公钥，并将它添加到我的 Mercurial 服务器上的授权密钥中。在进行每小时投票时，有时某些项目无法投票 Mercurial。这是我在 Mercurial 轮询日志中看到的示例：

```
Started on Apr 30, 2012 2:00:30 PM
[workspace] $ /usr/bin/hg incoming --style /opt/home/hudson/jobs/MyProject/workspace/tmp7506244240405638202style --no-merges --rev default --newest-first
remote: ssh_exchange_identification: Connection closed by remote host
abort: no suitable response from remote hg!
Done. Took 5.3 sec
No changes 
```

但是，如果我单击“立即构建”，它会成功轮询、获取更改并构建。

```
Started by user sdoca
Cleaning the workspace because project is configured to clean the workspace before each build.
$ /usr/bin/hg clone --rev default ssh://hudson@my.mercurial.server:22//opt/hg/current/MyProject /opt/home/hudson/jobs/MyProject/workspace
requesting all changes
adding changesets
adding manifests
adding file changes
added 31 changesets with 40 changes to 11 files
updating working directory
5 files updated, 0 files merged, 0 files removed, 0 files unresolved
[workspace] $ /usr/bin/hg log --rev . --template {node}
[INFO] Using bundled Maven 3 installation
[INFO] Checking Maven 3 installation environment
...
<snip> 
```

任何想法为什么我在自动投票中出错？

# c++ - 外部函数调用期间指针地址更改

> ID：10390217
> 
> 赞同：0
> 
> 时间：2012-04-30T20:35:10.297
> 
> 标签：c++, c, pointers, cuda, extern

我正在编写一个程序，其中 C++ 文件调用外部“C”函数以启动多个 CUDA 内核函数。在调试代码时，我发现当我进入 extern 函数时，我的一个指针的目标地址发生了变化。

这是有问题的代码（在我的 .cpp 文件中）：

```
cout << "knnIndices before launch: " << knnIndices_d << endl;

launch_kernel(numParticles, dptr /*positions_d*/, velocities_d, embedded_d, 
    forces_d, 
  #ifndef USE_ATOMIC_FLOAT
    externalForces_d, 
  #endif
    masses_d, knnIndices_d, dt);

cout << "knnIndices after launch complete: " << knnIndices_d << endl; 
```

在 .cu 文件中：

```
extern "C" void launch_kernel(int numParticles, float4* positions, float4* velocities,
    float4* embedded, float4* forces,
#ifndef USE_ATOMIC_FLOAT
    int4* externalForces,
#endif
    float* masses, int* knnIndices, float dt)
{
    std::cout << "knnIndices at launch start: " <<  knnIndices << std::endl; 
```

输出是：

```
knnIndices before launch: 0x200420000
knnIndices at launch start: 0x200321400
knnIndices after launch complete: 0x200420000 
```

我已经没有试图解释这种行为的想法，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:38:24.723

在我看来，您`USE_ATOMIC_FLOAT`只在其中一个来源中定义过。所以参数的真实索引是错误的，尝试打印前后的参数（或者只是检查代码）来确认。

这是 C 函数的一方面，通常如果它们在不同的目标文件中，符号只包含函数的名称，而不包含参数......

# ruby-on-rails - 在 rails 3 应用程序中正确布局用户

> ID：10390220
> 
> 赞同：0
> 
> 时间：2012-04-30T20:35:18.007
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3

好的，所以我有一个全新的 rails 3.2.3 应用程序，我需要具有许多其他属性（如流派和生日等）的用户。我正在寻求构建数据库的最佳方法。我在想用户和个人资料

```
class Profile < ActiveRecord::Base
  belongs_to :contact

class User < ActiveRecord::Base
  has_one :profile 
```

并将名字和姓氏以及密码信息放在用户表中，将其他数据放在配置文件表中。我使用设计作为用户身份验证。但是我有一个注册表单，其中包含所需的所有信息，所以有没有一种简单的方法可以避免表单中两个表的嵌套。有没有一种简单的方法可以做到这一点......这看起来很基本，但让我有点困惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:43:02.217

就个人而言，我喜欢在同一个表中拥有指向同一个实体的数据，

用户 => 名称、地址、密码……#use role_id 用于不同的角色，即管理员、测试人员、查看者？取决于你需要什么以及它有多复杂。

你想用`belongs_to => :user #module\table name`

您的表格需要更新以获取类似`user.profile.password`...的个人资料数据（这是我从您的问题中理解的简单方法）

当您想要编辑时，您可以使用诸如`edit_user_profile_path(current_user, @profile)`注意路径 user_profile 之类的东西，这是它知道从哪里获取它的地方。

就像在这个答案中一样[https://stackoverflow.com/a/4753856/643500](https://stackoverflow.com/a/4753856/643500)

* * *

附带说明一下，如果您不精通 Rails，请考虑从头开始编写您的第一个身份验证系统。通过这种方式，您将了解一切的去向，并能够知道如何定制它，或者像设计这样的东西。教程在这里[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

# ruby-on-rails - 存储数组的 redis 等价物是什么？

> ID：10390221
> 
> 赞同：2
> 
> 时间：2012-04-30T20:35:20.627
> 
> 标签：ruby-on-rails, redis

出于显而易见的原因，我想使用 Redis 而不是我的会话。

旧国家代码：

```
session[:some_stuff] = @my_objects.map(&:id) 
```

然后稍后：

```
session[:some_stuff].each{|obj| .. 
```

或者，

我想将这个 id 映射存储到 redis 中。然后检索它们。我在其他网络资源上找不到任何相关的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:18:05.823

您还没有写过如何设置 Redis 连接/适配器，但它基本上`SADD`是用于将元素添加到 Redis 集并`SMEMBERS`检索所有元素。

[http://redis.io/commands#set](http://redis.io/commands#set)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-02T09:02:41.287

我尝试使用`redis-store`可以解决一些问题的宝石思维，但事实证明它不起作用。甚至可能是稳定的 1.0.0 版本。

所以这就是我所做的，而且效果非常好：

```
def first_method
  $redis = Redis.new
  @customers.map(&:id).each{|c|$redis.sadd('export', c)}

def other_method
  @customers = [] 
  $redis.smembers('export').each{|c|@customers << Customer.find(c)} 
```

**备注**：

您只需要在一种方法中识别 $redis 是一次。然后它将自己保存到 MVC 架构之外的无状态位置。

# ruby - 确定 http://foo.com 是否重定向到 http://www.foo.com

> ID：10390226
> 
> 赞同：3
> 
> 时间：2012-04-30T20:35:59.593
> 
> 标签：ruby, web-scraping

我有一个大约 150 个 URL 的列表。我需要找出每个域是否解析`www.domain.com`为`domain.com`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T22:23:53.230

域名可以通过多种方式“解析”或“重定向”到另一个：

1.  发出 HTTP 请求`foo.com`可能会使用301 之类的[HTTP 重定向响应代码](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#3xx_Redirection)`www.foo.com`进行响应，将浏览器发送到.

    ```
    phrogz$ curl -I http://adobe.com
    HTTP/1.1 301 Moved Permanently
    Date: Mon, 30 Apr 2012 22:19:33 GMT
    Server: Apache
    Location: http://www.adobe.com/
    Content-Type: text/html; charset=iso-8859-1 
    ```

2.  服务器发回的网页可能包含[`<meta>`重定向](http://en.wikipedia.org/wiki/Meta_refresh#For_redirection)：

    ```
    <meta http-equiv="refresh" content="0; url=http://www.adobe.com/"> 
    ```

3.  服务器发回的网页可能包含 JavaScript 重定向：

    ```
    location.href = 'http://www.adobe.com'; 
    ```

*您需要测试哪些？*

## 读取 HTTP 响应标头

要检测 #1，请使用Ruby 内置的[`net/http`库：](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/index.html)

```
require "net/http"
req = Net::HTTP.new('adobe.com', 80)
response = req.request_head('/')
p response.code, response['Location']
#=> "301"
#=> "http://www.adobe.com/" 
```

## 阅读 HTML 元标题

要检测 #2，您需要实际获取页面、解析它并查看内容。我会为此使用 Nokogiri：

```
require 'open-uri' # …if you don't need #1 also, this is easier
html = open('http://adobe.com').read

require 'nokogiri'
doc = Nokogiri.HTML(html)
if meta = doc.at_xpath('//meta[@http-equiv="refresh"]')
  # Might give you "abobe.com" or "www.adobe.com"
  domain = meta['content'][%r{url=([^/"]+(\.[^/"])+)},1]
end 
```

## 阅读 JavaScript

……你一个人，在这里。:) 您可以尝试自己解析 JavaScript 代码，但您需要实际运行 JS 以了解它是否真的重定向到另一个页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T01:42:52.640

机械化方式：

```
require 'mechanize'
Mechanize.new.head('http://google.com').uri.host
#=> "www.google.com.ph" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T21:21:31.643

我已经看到使用[resolv std library](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/resolv/rdoc/Resolv.html)非常成功地完成了这项工作。

```
require 'resolv'
["google.com", "ruby-lang.org"].map do |domain|
  [domain, Resolv.getaddress(domain)]
end 
```

# powershell - Powershell 批量查找 ActiveDirectory 对象

> ID：10390228
> 
> 赞同：5
> 
> 时间：2012-04-30T20:36:02.543
> 
> 标签：powershell, active-directory, adsi

我正在尝试开发一个 powershell 脚本来帮助管理 AD 组成员资格。我们有一些大型组（30k-60k+ 对象），我们想用来自另一个系统的数据进行更新。

该脚本从文本文件加载应该在组中的对象。然后，每个对象都必须使用`System.DirectoryServices.DirectorySearcher`. 之后，每个对象都被添加到组成员中。

该脚本花费了大约 80% 的时间来查找每个对象，是否有大量方法可以使用 powershell 在 AD 中查找对象？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:26:35.497

这是我在经验中发现的查询 AD 的快速方法，您需要更改查询以查找特定对象，在此代码中，您将在`$objRecordSet`.

```
$Ads_Scope_SubTree = 2        
$objConnection = new-Object  -com "ADODB.Connection"
$objCommand = new-Object -com "ADODB.Command"

$objConnection.Provider = "ADsDSOObject"
$objConnection.Open( "Active Directory Provider")
$objCommand.ActiveConnection = $objConnection

$objCommand.Properties.Item("Page Size").value = 1000
$objCommand.Properties.item("Searchscope").value = $Ads_Scope_SubTree 

$objCommand.CommandText = "Select Name From 'LDAP://DC = int, DC= my, DC = local' Where objectCategory = 'Person'" 

$objRecordSet = $objCommand.Execute()
$objRecordSet.RecordCount 
```

更多[信息在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa746471%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T16:02:29.863

*如果您开始看到超时问题，请适当设置超时参数，如下所示*

```
$ADDPConnect = New-Object System.DirectoryServices.Protocols.LdapConnection $serverName
$ADDPConnect.Timeout = "1000" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:50:06.253

您也许可以尝试[System.DirectoryServices.Protocols (S.DS.P)](http://msdn.microsoft.com/en-us/library/bb332056.aspx)，本机（非托管）版本非常有效。

这是一个 PowerShell 启动脚本：

```
# ADDP-Connect.PS1

Clear-Host
# Add the needed assemblies
Add-Type -AssemblyName System.DirectoryServices.Protocols

# Connexion
$serverName = "WM2008R2ENT" 
$ADDPConnect = New-Object System.DirectoryServices.Protocols.LdapConnection $serverName

$userName = "JPB"
$pwd = "PWD"
$domain = "Dom"
$ADDPConnect.Credential = New-Object system.Net.NetworkCredential -ArgumentList $userName,$pwd,$domain

# Create a searcher
$searchTargetOU = "dc=dom,dc=fr"
$searchFilter = "(samAccountName=user1)"
$searchScope = [System.DirectoryServices.Protocols.SearchScope]::Subtree
$searchAttrList = $null

foreach($user in "user1","user2","user3")
{
  $searchFilter = "(samAccountName=$user)"
  $searchRequest = New-Object System.DirectoryServices.Protocols.SearchRequest -ArgumentList $searchTargetOU,$searchFilter,$searchScope,$searchAttrList

  $searchResponse = $ADDPConnect.SendRequest($searchRequest)

  foreach($searchEntries in $searchResponse.Entries)
  {
    $searchEntries.DistinguishedName
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T15:41:56.463

如果您在执行期间看到超时问题，以下内容会有所帮助

```
$ADDPConnect = New-Object System.DirectoryServices.Protocols.LdapConnection $serverName
$ADDPConnect.Timeout = "1000" 
```

# ruby-on-rails - gmaps 和 gmaps4rails 之间的区别

> ID：10390230
> 
> 赞同：0
> 
> 时间：2012-04-30T20:36:12.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gmaps4rails

当我使用这个时，我可以显示我的标记：

```
<%= gmaps4rails(@my_json_data) %> 
```

但是，如果我只是为这一行更改该行：

```
<%= gmaps("markers" => { "data" => @my_json_data }) %> 
```

@my_json_data**值**是：

```
@my_json_data = '[{"description":"test","lat":"37.564486","lng":"-122.323672"}]' 
```

地图没有集中在我有标记的地方。我必须缩小并检查它们在哪里。当我缩小时，我也可以看到水平复制的地图。为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:13:30.560

`gmaps4rails`只是`gmaps`一些默认选项的方便快捷方式。

[见源代码](https://github.com/apneadiving/Google-Maps-for-Rails/blob/new_gen/lib/gmaps4rails/helper/gmaps4rails_helper.rb)。

水平复制地图是谷歌地图的默认行为，具体取决于您的地图大小和缩放级别。

# javascript - IE 9 onhashchange 传递未定义的事件对象

> ID：10390231
> 
> 赞同：1
> 
> 时间：2012-04-30T20:36:12.493
> 
> 标签：javascript, internet-explorer

我有一个简单的事件监听器：

```
window.onhashchange = function(e){
   alert(e.newURL);
} 
```

除了 IE 9（不测试以前的版本）之外，它在任何东西上都很好用。在 IE 中，我得到一个未定义的事件对象......知道我错过了什么吗？这还不完全支持吗？

这里的例子：

[http://hupcapstudios.com/projects/hash.php#](http://hupcapstudios.com/projects/hash.php#)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:05:14.883

一些旧版本的 IE9 不会将事件作为参数传递给事件处理程序，您必须从 获取它`window.event`，这应该可以：

```
window.onhashchange = function(e){
    e = e || window.event;
    alert(e.newURL);
} 
```

# objective-c - xcode 4.2 崩溃

> ID：10390237
> 
> 赞同：0
> 
> 时间：2012-04-30T20:36:40.980
> 
> 标签：objective-c, xcode4

今天我尝试运行我的第一个 iPhone 应用程序（该应用程序是斯坦福课程的作业）。在我要求在界面生成器中定义和实例化类的作业中，我定义了运行模拟器的类，一切正常。当我尝试将类（和对象）连接到 UI 然后运行模拟器时，xcode 崩溃并显示此消息：

```
Thread 1:signal sigABRT 
```

当我删除类与 UI 之间的连接时（我删除了应用程序视图中的插座和标签之间的连接），一切都再次正常工作。我试图通过断点了解问题出在哪里，而崩溃出现在这行代码中（在主文件中）：

```
 return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class])); 
```

请帮助我，这让我发疯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:52:37.960

Xcode 4.x 不太擅长告诉您真正的错误在哪里，而是在 main.m 中显示该行。尝试用显示更多信息的代码替换它：

```
@try {
  return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
}
@catch (NSException *exception) {
  NSLog(@"Exception %@\n%@", [exception description], [exception callStackSymbols]);
} 
```

# ruby-on-rails - 迁移数据未保存

> ID：10390241
> 
> 赞同：0
> 
> 时间：2012-04-30T20:36:50.173
> 
> 标签：ruby-on-rails, ruby, migration

我把它放在“def up)”中的迁移文件中

```
User.find(:all).each do |user|
    user.login = user.name
    user.save
end 
User.find(:all).each do |user|
    puts user.login
end 
```

我知道 user.name 绝对不是空的。对于这段代码，第二个循环仍然没有输出任何内容。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T22:45:13.977

由于验证错误，用户可能尚未保存。

如果不想处理验证错误，则应使用 bang 版本保存 ( `user.save!`)。这意味着你会得到一个错误。

为了防止验证，您可以在迁移中定义模型。

```
class CopyUserNameToLogin < ActiveRecord::Migration

  class User < ActiveRecord::Base
  end

  def up
    User.find_each do |user|
      user.login = user.name
      user.save!
    end
  end

  def down
    raise ActiveRecord::IrreversibleMigration
  end

end 
```

提示：使用`find_each`做批量获取用户，这样会减少内存使用。

提示 2：您可能想要使用事务。

# python - 如何使用 django-storages 和 Amazon S3 设置 Django 项目，但静态文件和媒体文件使用不同的文件夹？

> ID：10390244
> 
> 赞同：95
> 
> 时间：2012-04-30T20:36:55.277
> 
> 标签：python, django, amazon-s3, django-settings, django-storage

我正在配置一个 Django 项目，该项目使用服务器文件系统来存储应用程序静态文件 ( `STATIC_ROOT`) 和用户上传的文件 ( `MEDIA_ROOT`)。

我现在需要在 Amazon 的 S3 上托管所有这些内容，因此我为此创建了一个存储桶。使用存储后端，我设法将收集到的静态数据上传到 S3 存储桶[`django-storages`](http://readthedocs.org/docs/django-storages/en/latest/)：`boto`

```
MEDIA_ROOT = '/media/'
STATIC_ROOT = '/static/'

DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
AWS_ACCESS_KEY_ID = 'KEY_ID...'
AWS_SECRET_ACCESS_KEY = 'ACCESS_KEY...'
AWS_STORAGE_BUCKET_NAME = 'bucket-name'
STATICFILES_STORAGE = 'storages.backends.s3boto.S3BotoStorage' 
```

然后，我遇到了一个问题：`MEDIA_ROOT`和`STATIC_ROOT`没有在存储桶中使用，因此存储桶根目录包含静态文件和用户上传的路径。

那么我可以设置：

```
S3_URL = 'http://s3.amazonaws.com/%s' % AWS_STORAGE_BUCKET_NAME
STATIC_URL = S3_URL + STATIC_ROOT
MEDIA_URL = 'S3_URL + MEDIA_ROOT 
```

并在模板中使用这些设置，但在使用`django-storages`.

如何做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-05-30T23:32:45.940

我认为以下应该有效，并且比 Mandx 的方法更简单，尽管它非常相似：

创建一个`s3utils.py`文件：

```
from storages.backends.s3boto import S3BotoStorage

StaticRootS3BotoStorage = lambda: S3BotoStorage(location='static')
MediaRootS3BotoStorage  = lambda: S3BotoStorage(location='media') 
```

然后在你的`settings.py`：

```
DEFAULT_FILE_STORAGE = 'myproject.s3utils.MediaRootS3BotoStorage'
STATICFILES_STORAGE = 'myproject.s3utils.StaticRootS3BotoStorage' 
```

可以在[此处](https://github.com/mstarinteractive/django-s3storage)`example_`的两个文件中看到一个不同但相关的示例（我已经实际测试过） 。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-16T20:31:08.830

我目前在一个单独的`s3utils`模块中使用此代码：

```
from django.core.exceptions import SuspiciousOperation
from django.utils.encoding import force_unicode

from storages.backends.s3boto import S3BotoStorage

def safe_join(base, *paths):
    """
    A version of django.utils._os.safe_join for S3 paths.

    Joins one or more path components to the base path component intelligently.
    Returns a normalized version of the final path.

    The final path must be located inside of the base path component (otherwise
    a ValueError is raised).

    Paths outside the base path indicate a possible security sensitive operation.
    """
    from urlparse import urljoin
    base_path = force_unicode(base)
    paths = map(lambda p: force_unicode(p), paths)
    final_path = urljoin(base_path + ("/" if not base_path.endswith("/") else ""), *paths)
    # Ensure final_path starts with base_path and that the next character after
    # the final path is '/' (or nothing, in which case final_path must be
    # equal to base_path).
    base_path_len = len(base_path) - 1
    if not final_path.startswith(base_path) \
       or final_path[base_path_len:base_path_len + 1] not in ('', '/'):
        raise ValueError('the joined path is located outside of the base path'
                         ' component')
    return final_path

class StaticRootS3BotoStorage(S3BotoStorage):
    def __init__(self, *args, **kwargs):
        super(StaticRootS3BotoStorage, self).__init__(*args, **kwargs)
        self.location = kwargs.get('location', '')
        self.location = 'static/' + self.location.lstrip('/')

    def _normalize_name(self, name):
        try:
            return safe_join(self.location, name).lstrip('/')
        except ValueError:
            raise SuspiciousOperation("Attempted access to '%s' denied." % name)

class MediaRootS3BotoStorage(S3BotoStorage):
    def __init__(self, *args, **kwargs):
        super(MediaRootS3BotoStorage, self).__init__(*args, **kwargs)
        self.location = kwargs.get('location', '')
        self.location = 'media/' + self.location.lstrip('/')

    def _normalize_name(self, name):
        try:
            return safe_join(self.location, name).lstrip('/')
        except ValueError:
            raise SuspiciousOperation("Attempted access to '%s' denied." % name) 
```

然后，在我的设置模块中：

```
DEFAULT_FILE_STORAGE = 'myproyect.s3utils.MediaRootS3BotoStorage'
STATICFILES_STORAGE = 'myproyect.s3utils.StaticRootS3BotoStorage' 
```

我必须重新定义`_normalize_name()`私有方法以使用该`safe_join()`函数的“固定”版本，因为原始代码给了我`SuspiciousOperation`合法路径的例外。

我将其发布以供考虑，如果有人可以提供更好的答案或改进此答案，将非常受欢迎。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-10T18:06:01.010

* * *

> 文件：PROJECT_NAME/custom_storages.py

```
from django.conf import settings
from storages.backends.s3boto import S3BotoStorage

class StaticStorage(S3BotoStorage):
    location = settings.STATICFILES_LOCATION

class MediaStorage(S3BotoStorage):
    location = settings.MEDIAFILES_LOCATION 
```

> 文件：PROJECT_NAME/settings.py

```
STATICFILES_LOCATION = 'static'
MEDIAFILES_LOCATION = 'media'

if not DEBUG:
    STATICFILES_STORAGE = 'PROJECT_NAME.custom_storages.StaticStorage'
    DEFAULT_FILE_STORAGE = 'PROJECT_NAME.custom_storages.MediaStorage'
    AWS_ACCESS_KEY_ID = 'KEY_XXXXXXX'
    AWS_SECRET_ACCESS_KEY = 'SECRET_XXXXXXXXX'
    AWS_STORAGE_BUCKET_NAME = 'BUCKET_NAME'
    AWS_HEADERS = {'Cache-Control': 'max-age=86400',}
    AWS_QUERYSTRING_AUTH = False 
```

并运行：`python manage.py collectstatic`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-01T16:15:28.073

我认为答案很简单，默认情况下就完成了。这适用于我在带有 Django 1.6.5 和 Boto 2.28.0 的 AWS Elastic Beanstalk 上：

```
STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
)

TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
)

DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
STATICFILES_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
AWS_ACCESS_KEY_ID = os.environ['AWS_ACCESS_KEY_ID']
AWS_SECRET_ACCESS_KEY = os.environ['AWS_SECRET_KEY'] 
```

AWS 密钥是从容器配置文件传入的，我没有`STATIC_ROOT`或根本没有`STATIC_URL`设置。此外，不需要`s3utils.py`文件。这些细节由存储系统自动处理。这里的诀窍是我需要在我的模板中正确且动态地引用这个未知路径。例如：

```
<link rel="icon" href="{% static "img/favicon.ico" %}"> 
```

这就是我如何处理我在本地（部署前）的网站图标`~/Projects/my_app/project/my_app/static/img/favicon.ico`。

当然，我有一个单独的`local_settings.py`文件用于在开发环境中本地访问这些东西，它确实有 STATIC 和 MEDIA 设置。我必须做大量的实验和阅读才能找到这个解决方案，它始终如一地工作，没有错误。

我了解您需要静态和根分离，并且考虑到您只能提供一个存储桶，我会指出，此方法将我本地环境中的所有文件夹放在下面`~/Projects/my_app/project/my_app/static/`，并在存储桶根目录中创建一个文件夹（即：S3bucket/img/如上例所示）。所以你确实得到了文件的分离。例如，您可以在`media`文件夹中有一个文件`static`夹并通过以下模板访问它：

```
{% static "media/" %} 
```

我希望这有帮助。我来到这里寻找答案，并努力寻找比扩展存储系统更简单的解决方案。相反，我阅读了有关 Boto 预期用途的文档，发现我需要的很多东西都是默认内置的。干杯!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-27T07:35:40.620

如果您想在媒体或静态分隔之前拥有子文件夹，您可以在 bradenm answer 之上使用 AWS_LOCATION。参考：[https ://django-storages.readthedocs.io/en/latest/backends/amazon-S3.html#usage](https://django-storages.readthedocs.io/en/latest/backends/amazon-S3.html#usage)

```
AWS_STORAGE_BUCKET_NAME = 'bucket_name'
AWS_LOCATION = 'path1/path2/' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-30T04:31:58.780

**[Bradenm 的答案](https://stackoverflow.com/questions/10390244/how-to-set-up-a-django-project-with-django-storages-and-amazon-s3-but-with-diff#10825691)**已过时且不起作用，因此我在***2021 年 3 月***对其进行了更新。

### 更新一：

* * *

`s3utils.py`在“settings.py”的同一文件夹中创建一个：

```
from storages.backends.s3boto3 import S3Boto3Storage

StaticRootS3Boto3Storage = lambda: S3Boto3Storage(location='static')
MediaRootS3Boto3Storage  = lambda: S3Boto3Storage(location='media') 
```

然后，添加 2 行代码`settings.py`并将“ ***myproject*** ”更改为您的文件夹名称：

```
DEFAULT_FILE_STORAGE = 'myproject.s3utils.MediaRootS3Boto3Storage'
STATICFILES_STORAGE = 'myproject.s3utils.StaticRootS3Boto3Storage' 
```

* * *

正如我在下面强调的那样，更新后的有多个“ ***3s ”。***

s3utils.py：

```
from storages.backends.s3boto"3" import S3Boto"3"Storage

StaticRootS3Boto"3"Storage = lambda: S3Boto"3"Storage(location='static')
MediaRootS3Boto"3"Storage  = lambda: S3Boto"3"Storage(location='media') 
```

设置.py：

```
DEFAULT_FILE_STORAGE = 'myproject.s3utils.MediaRootS3Boto"3"Storage'
STATICFILES_STORAGE = 'myproject.s3utils.StaticRootS3Boto"3"Storage' 
```

检查并与**[Bradenm 的（过时的）答案](https://stackoverflow.com/questions/10390244/how-to-set-up-a-django-project-with-django-storages-and-amazon-s3-but-with-diff#10825691)**进行比较。

***“我尊重布雷登姆的回答。”***

# mysql - MySQL搜索不带OR的多列

> ID：10390246
> 
> 赞同：0
> 
> 时间：2012-04-30T20:37:04.460
> 
> 标签：mysql, select, multiple-columns

我有一个页面，它根据`$_POST`变量构建了一个非常长的查询。我试图在没有 MySQL 的情况下这样做的原因`OR`是因为我必须重述整个查询只是为了在最后更改一个小参数，这似乎是一种资源浪费。

这是我的伪查询：

```
SELECT * FROM names WHERE 
person = '$var1' AND
place = '$var2' AND
location_a = '$var3' AND
location_b = '$var3' 
```

如果我使用`OR`，这个胖丑的查询将是：

```
SELECT * FROM names WHERE 
person = '$var1' AND
place = '$var2' AND
location_a = '$var3' OR

person = '$var1' AND
place = '$var2' AND
location_b = '$var3' 
```

有没有办法在不使用的情况下同时搜索`location_a`和`location_b`搜索？`$var3``OR`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T20:41:40.467

使用括号：

```
SELECT * FROM names WHERE 
person = '$var1' AND
place = '$var2' AND
(
location_a = '$var3' OR location_b = '$var3'
) 
```

其实我不明白你的问题。您不必重述整个查询。也许你显示你的代码？有什么不好的`OR`？只需使用括号。

# javascript - IE 和 Chrome 上的 jquery formatcurrency 错误

> ID：10390247
> 
> 赞同：2
> 
> 时间：2012-04-30T20:37:05.617
> 
> 标签：javascript, jquery, currency, caret

使用 jQuery Format Currency 和 jCaret 插件时，我在 IE 和 Chrome 上遇到问题。

问题在这里描述：[http ://code.google.com/p/jquery-formatcurrency/issues/detail?id=23&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary%20Opened](http://code.google.com/p/jquery-formatcurrency/issues/detail?id=23&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary%20Opened)

使用此处显示的修复程序时，键入时的格式仅适用于 Firefox。在其他浏览器上，光标在输入控件上保持“阻塞”，您无法选择其他控件。似乎 focus() 事件正在循环。

我创建了一个 jsFiddle 来测试这种情况：http: [//jsfiddle.net/B3xA6/4/](http://jsfiddle.net/B3xA6/4/)

帮助使这个工作（特别是在 IE 上）表示赞赏。

谢谢

# java - 基于刻度值的颜色java JSlider

> ID：10390251
> 
> 赞同：1
> 
> 时间：2012-04-30T20:37:17.337
> 
> 标签：java, swing, colors, jslider

我想要一个具有三种颜色的 JSlider，每种颜色都占据一个值范围（例如，1 到 10 是绿色，10 到 20 是黄色，20 到 30 是红色），如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:13:22.460

**编辑：**

糟糕，出于某种原因，我认为`paintBackground()`JComponent 中有一个方法。我想您必须这样做`setOpaque(false)`（这样`super`就不会绘制背景），然后`paintComponent()`像这样覆盖：

```
protected void paintComponent(Graphics g) {
   int w = getWidth();
   int h = getHeight();
   int x1 = w / 3;
   int x2 = w * 2 / 3;

   g.setColor(Color.GREEN);
   g.fillRect(0, 0, x1, h)
   g.setColor(Color.YELLOW);
   g.fillRect(x1, 0, x2 - x1, h)
   g.setColor(Color.RED);
   g.fillRect(x2, 0, w - x2, h)

   super.paintComponent();
} 
```

# jquery - SCRIPT87：无效参数

> ID：10390252
> 
> 赞同：2
> 
> 时间：2012-04-30T20:37:18.080
> 
> 标签：jquery, jquery-animate

我有一个适用于所有浏览器的 jquery 函数，但不适用于兼容模式下的 ie7 和 ie9。问题出在这个函数中：

```
$('.non-attivo').live('click',function(){
    clearInterval(start_slide);
    n_btn = "";
    for(var i=1;i<$(this).attr('id').length; i++)
        n_btn += $(this).attr('id')[i] + "";
    slide_pos = parseInt(n_btn, 10);
    var margin_slider = slide_pos * 780;
    $('#immagini').animate({ marginLeft: "-" + margin_slider + "px"}, 500 );
    $('.attivo').attr('class', 'non-attivo');
    $(this).attr('class', 'attivo');
    start_slide = setInterval(rotate, 4000);
}); 
```

错误是：

> SCRIPT87：参数无效。
> 
> jquery.min.js，第 4 行字符 23894

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:58:58.010

您确定的方式`margin_slider`很可能是导致问题的原因。它必须返回一个`NaN`in `parseInt`。

`alert(margin_slider)`之前尝试一下`.animate`，看看它会返回什么。

另外，这取决于您要迭代的内容。进行更多调试以查看返回的`n_btn`内容和预期的内容。如果`n_btn`返回一个数字字符串或任何以数字开头的字符串应该返回你是数字.. 但似乎它没有。

尝试`.charAt(i)`改用`$(this).attr('id')[i]`. 你可以`var thisId = this.id`然后使用 var 而不是`$(this).attr('id')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T15:39:56.263

几天前我遇到了这个问题。

万一其他人也偶然发现了这一点，问题是我使用的是 IE9- 似乎不知道如何处理的 HTML 按钮元素。添加 HTML 垫片解决了这个问题。

# javascript - raphael.js 如何将 id 添加到路径

> ID：10390253
> 
> 赞同：4
> 
> 时间：2012-04-30T20:37:20.203
> 
> 标签：javascript, path, svg, raphael

我刚开始使用 Raphael.js，我很难为路径添加 id。我已经阅读了很多关于如何做到这一点的帖子，但我认为我的文件设置方式不允许我轻松翻译这些解决方案。

我有一个 init.js 文件和一个 path.js 文件

初始化.js

```
var r = Raphael('man', 500, 573),
    attributes = {
        fill: '#204ad3',
        opacity: '0.0',
        'stroke-linejoin': 'round'

    },
arr = new Array();

for (var muscles in paths) {

    var obj = r.path(paths[muscles].path);

    obj.attr(attributes);

    arr[obj.id] = muscles;

    obj
    .hover(function(){
        this.animate({
            fill: '#204ad3',
            opacity: '0.3'
        }, 300);
    }, function(){
        this.animate({
            fill: attributes.fill,
            opacity: attributes.opacity
        }, 300);
    })
    .click(function(){
        document.location.hash = arr[this.id];

        var point = this.getBBox(0);

        $('#man').next('.point').remove();

        $('#man').after($('<div />').addClass('point'));

        $('.point')
        .html(paths[arr[this.id]].name)
        .prepend($('<a />').attr('href', '#').addClass('close').text('Close'))
        .prepend($('<img />').attr('src', 'flags/'+arr[this.id]+'.png'))
        .css({
            left: point.x+(point.width/2)-80,
            top: point.y+(point.height/2)-20
        })
        .fadeIn();

    });

    $('.point').find('.close').live('click', function(){
        var t = $(this),
            parent = t.parent('.point');

        parent.fadeOut(function(){
            parent.remove();
        });
        return false;
    });
} 
```

path.js 文件：

```
var paths = { 
    neck: {
        name: 'Neck',
    path: 'd="M412.294,73.035c0,0,7.661,28.869,9.406,31.78c1.746,2.911,4.657,2.911,9.896,2.911 s9.313-1.746,9.896-5.239c0.582-3.493,6.985-28.523,6.985-28.523s-2.963,2.599-6.232,5.984c-2.543,2.632-7.2,5.904-11.088,5.904 c-3.889,0-6.705-2.431-10.367-5.04C418.063,78.868,418.08,79.22,412.294,73.035z"',
},
pecks: {
    name: 'Pecks',
    path: 'd="M379.581,117.994c0,0,0.396-1.586,6.936-4.558c6.539-2.972,13.475-5.351,16.844-6.737 c3.369-1.387,4.559-1.784,4.559-1.784s13.674,2.973,15.061,3.17c1.387,0.198,4.36,1.982,8.72,1.982s9.511-1.387,11.097-2.18 s10.307-2.973,11.693-3.171s1.387-0.198,1.387-0.198s12.286,3.369,16.845,4.36c4.558,0.991,8.917,2.378,9.116,3.765 c0.197,1.387,1.584,4.954,1.584,6.341s-0.197,5.945-0.396,6.738c-0.198,0.792-3.171,15.457-4.757,21.997 c-1.585,6.54-1.188,8.918-7.331,11.494s-10.899,7.53-22.79,2.378s-13.277-5.549-17.241-5.152s-11.098,3.963-14.862,5.351 c-3.766,1.387-16.251,2.179-20.412-0.198c-4.162-2.378-10.9-9.314-12.881-16.844c-1.981-7.531-3.963-16.052-4.359-17.638 C377.995,125.525,377.798,121.165,379.581,117.994z"',
},
} 
```

生成的 SVG 元素没有 id，我也不知道如何在其中获取一个。任何建议/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T14:06:53.033

这会将`id`属性添加到 svg 路径元素：

```
var id = 0;

for (var muscles in paths) {

    var obj = r.path(paths[muscles].path);
    obj.node.id = "muscles_or_whatever_you_want_" + id;
    id++

    //.... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T20:11:32.813

为 SVG 元素添加 id `paper.path( path data ).node.id = 'pathIdString';`.... 测试...尝试`alert( document.getElementById("pathIdString").id );`。应该返回 id

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:08:00.857

看起来您要做的是在单击的路径上方弹出一个带有图像和关闭链接的 div。问题是您将路径对象的 Raphael id 与`paths`数组中的索引混淆了。您可能希望`arr`完全消除并通过闭包将索引传递给您的处理程序：

```
.click(function(index) { return function() {
    document.location.hash = index;

    var point = this.getBBox(0);

    $('#man').next('.point').remove();

    $('#man').after($('<div />').addClass('point'));

    $('.point')
    .html(paths[index].name)
    .prepend($('<a />').attr('href', '#').addClass('close').text('Close'))
    .prepend($('<img />').attr('src', 'flags/'+index+'.png'))
    .css({
        left: point.x+(point.width/2)-80,
        top: point.y+(point.height/2)-20
    })
    .fadeIn();

}; }(muscles)); 
```

# java - 如何将字符串写入文本文件？

> ID：10390254
> 
> 赞同：9
> 
> 时间：2012-04-30T20:37:31.590
> 
> 标签：java, string, text-files

我有一个字符串，用于存储几个文件的处理结果。如何将该字符串写入项目中的 .txt 文件？我有另一个字符串变量，它是 .txt 文件的所需名称。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-30T20:47:26.277

尝试这个：

```
//Put this at the top of the file:
import java.io.*;
import java.util.*;

BufferedWriter out = new BufferedWriter(new FileWriter("test.txt"));

//Add this to write a string to a file
//
try {

    out.write("aString\nthis is a\nttest");  //Replace with the string 
                                             //you are trying to write
}
catch (IOException e)
{
    System.out.println("Exception ");

}
finally
{
    out.close();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-30T20:43:07.513

你的意思是喜欢吗？

```
FileUtils.writeFile(new File(filename), textToWrite); 
```

[FileUtils](https://commons.apache.org/proper/commons-io/javadocs/api-2.5/org/apache/commons/io/FileUtils.html)在 Commons IO 中可用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-30T20:55:03.493

使用基于字节的流创建的文件以二进制格式表示数据。使用基于字符的流创建的文件将数据表示为字符序列。文本文件可以由文本编辑器读取，而二进制文件由将数据转换为人类可读格式的程序读取。

类`FileReader`和`FileWriter`执行基于字符的文件 I/O。

如果您使用的是 Java 7，则可以使用`try-with-resources`大大缩短方法：

```
import java.io.PrintWriter;
public class Main {
    public static void main(String[] args) throws Exception {
        String str = "写字符串到文件"; // Chinese-character string
        try (PrintWriter out = new PrintWriter("output.txt", "UTF-8")) {
            out.write(str);
        }
    }
} 
```

您可以使用 Java 的`try-with-resources`语句自动**关闭**资源（不再需要时必须关闭的对象）。您应该考虑资源类必须实现`java.lang.AutoCloseable`接口或其`java.lang.Closeable`子接口。

# android - 如何以编程方式在 Google+ 上发布我的状态更新

> ID：10390257
> 
> 赞同：-1
> 
> 时间：2012-04-30T20:37:52.917
> 
> 标签：android, google-plus

我目前正在考虑使用适用于 Android 的 Google+ API。我不知道如何在 Google+ 上发布我的状态更新

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T20:43:04.067

您无法收集它，因为 API 不支持它。[Google+ API](https://developers.google.com/+/api/latest/)是只读的。

# c# - 使用 Shell32 进行 P/Invoke，绕过 Interop.Shell32.dll 生成

> ID：10390260
> 
> 赞同：3
> 
> 时间：2012-04-30T20:38:10.793
> 
> 标签：c#, interop, pinvoke, dllimport, shell32

所以我使用以下代码将每个扩展文件属性转储到调试控制台...

```
ShellClass shellClass = new ShellClass();
Folder dir = shellClass.NameSpace(Path.GetDirectoryName(sFilePath));
FolderItem item = dir.ParseName(Path.GetFileName(sFilePath));
for (int i = 0; i < 267; i++)
{
   System.Debug.WriteLine(dir.GetDetailsOf(item, i));
} 
```

由于 Shell32 是一个非托管库，我不能直接在程序中嵌入 DLL 资源，它必须生成一个互操作帮助 DLL。

任何人都知道 Shell32 中这些函数的 DLLImport 命令行来绕过整个互操作 DLL 的生成？我检查了 pinvoke.net 并且在 Shell32 条目下，他们要么没有我要找的东西，要么没有命名我所期望的。

如果无法使用 DLLImport 来完成此操作，是否有人知道使用托管 DLL 提取有关文件的所有扩展属性的方法，或者至少有一种方法可以在我不必生成的情况下执行此操作帮助 DLL 并需要安装程序和我正在开发的应用程序？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T21:17:37.347

大多数 Windows Shell API 功能都有返回 COM 接口的 P/Invoke 入口点，因此您应该很少需要显式创建 ShellClass CoClass 实例。（您使用的对象`Folder`和`FolderItem`主要用于后期绑定的客户端，例如脚本语言；使用 C# 可以做得更好。）

为避免生成互操作程序集，您只需在 C# 代码中声明与外壳已实现的 P/Invoke 函数和 COM 接口匹配的适当类型。在您的情况下，您正在寻找的是[`IShellFolder2`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775055%28v=vs.85%29.aspx)界面（与`Folder`对象基本相同）。

通常，要执行您的要求，您会：

1.  调用[`SHGetDesktopFolder`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762175%28v=vs.85%29.aspx)返回一个[`IShellFolder`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775075%28v=vs.85%29.aspx)指向桌面文件夹的接口。
2.  调用`IShellFolder::ParseDisplayName`您想要的文件夹，它会为您提供一个“指向标识符列表的指针”（一个 PIDL），代表该文件夹的内部外壳标识符。
3.  将您的`IShellFolder`转换为`IShellFolder2`（使用`as`，像任何其他接口一样）。
4.  调用[`IShellFolder2::GetDetailsOf()`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775053%28v=vs.85%29.aspx)，传递来自步骤 2 的 PIDL 和您想要的列。

您需要翻译两个 COM 接口，以及一个结构和一个 P/Invoke 函数，并将 C# 代码放入您的项目中。您可以摆脱`IntPtr`很多这种情况（例如 PIDL），因为您只需要在 COM 方法之间传递它们。（MSDN 文章会告诉您，您有责任在完成后释放内存；CLR 的互操作代码将在几乎所有情况下为您处理这些事情。）

pinvoke.net 将在这里为您提供帮助，这一[系列](http://blog.kutulu.org/2012/01/com-interop-part-10-recapping-and.html)关于从 MSDN 文章中进行 COM 互操作翻译的精彩博文也将提供帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T00:29:52.260

根据我的经验，从托管代码中使用 shell API 的最有效方法是使用[Windows API Code Pack](http://archive.msdn.microsoft.com/WindowsAPICodePack)。这包含了 shell API 的所有有用部分，并使其可以从托管代码中轻松访问。下载包含许多示例，可帮助您上路。

# mysql - 在 Ubuntu 10.04 上 apt 安装 Cacti 数据库失败

> ID：10390264
> 
> 赞同：0
> 
> 时间：2012-04-30T20:38:34.127
> 
> 标签：mysql, ubuntu, installation, apt, cacti

我已经成功地在两台 debian 服务器上安装了 Cacti，没有出现太多问题。这就是 apt 应该如何工作的权利？

现在是在我们的生产服务器上安装它的时候了，但它对我来说根本不起作用。它似乎卡在创建仙人掌数据库、报告用户错误和“Chown invalid user root:staff”消息的问题上。我宁愿不手动编译，因为我不能冒任何停机的风险。

以下是 /var/log/apt/term.log 的大部分输出：

```
Selecting previously deselected package cacti.
(Reading database ... 152051 files and directories currently installed.)
Unpacking cacti (from .../cacti_0.8.7e-2ubuntu0.2_all.deb) ...
Setting up cacti (0.8.7e-2ubuntu0.2) ...
dbconfig-common: writing config to /etc/dbconfig-common/cacti.conf
Creating config file /etc/dbconfig-common/cacti.conf with new version
Creating config file /etc/cacti/debian.php with new version
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '/usr/bin/mysql' at line 1.
unable to connect to mysql server.
error encountered creating user:
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '/usr/bin/mysql' at line 1
dbconfig-common: cacti configure: trying again.
dbconfig-common: writing config to /etc/dbconfig-common/cacti.conf
Replacing config file /etc/cacti/debian.php with new version
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '/usr/bin/mysql' at line 1.
unable to connect to mysql server.
error encountered creating user:
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '/usr/bin/mysql' at line 1
dbconfig-common: cacti configure: trying again.
dbconfig-common: writing config to /etc/dbconfig-common/cacti.conf
Replacing config file /etc/cacti/debian.php with new version
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '/usr/bin/mysql' at line 1.
dbconfig-common: cacti configure: aborted.
dbconfig-common: flushing administrative password
dpkg: error processing cacti (--configure):
subprocess installed post-installation script returned error exit status 1
Errors were encountered while processing:
cacti
Log ended: 2012-04-30  19:25:04

Log started: 2012-04-30  19:26:57
Setting up cacti (0.8.7e-2ubuntu0.2) ...
dbconfig-common: writing config to /etc/dbconfig-common/cacti.conf
Replacing config file /etc/cacti/debian.php with new version
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '/usr/bin/mysql' at line 1.
unable to connect to mysql server.
error encountered creating user:
ERROR 1064 (42000) at line 1: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '/usr/bin/mysql' at line 1
dbconfig-common: cacti configure: ignoring errors from here forwards
populating database via sql...  done.
dbconfig-common: flushing administrative password

Creating config file /etc/cacti/apache.conf with new version
chown: invalid group: `root:staff'

Log ended: 2012-04-30  19:27:14 
```

我不确定它为什么要尝试使用 root:staff 组，因为它甚至不存在。有任何想法吗？干杯 **_**

刚刚发现这听起来很相似：尝试这些解决方案... [http://ubuntuforums.org/showthread.php?p=11871002](http://ubuntuforums.org/showthread.php?p=11871002)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:15:22.873

我相信这是由于 /etc/groups 文件损坏所致。

我最终安装了一个解决问题的新操作系统。

# php - 在codeigniter中传递php变量的javascript错误

> ID：10390266
> 
> 赞同：0
> 
> 时间：2012-04-30T20:38:37.517
> 
> 标签：php, javascript, codeigniter

```
function something(frm,i){
//var ch=frm.outof1.value;
for(var j=1;j<=i;j++)
{
    //var b="outof" + j;
    alert(frm.outof+j.value);

}
//alert("outof" + i);
return false;
}

 $js='onClick="something(this.form,\''. $ii .'\')"';
  echo form_button('mybutton', 'Click Me', $js); 
```

并在 html 中获取输出 NAN 这是 // echo form_input('outof'.$i,''); // 表单输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:54:10.270

首先，您需要确保`$ii`使用`parseInt`. `'outof'`然后通过连接和评估之前的数字来构造表单输入名称`.value`。

```
function something(frm, i)
{
    for(var j = 1; j <= parseInt(i); ++j) {
        alert(frm['outof' + j].value);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:42:19.997

```
alert(parseInt(frm.outof) + parseInt(j.value)) 
```

最有可能的是，您正在尝试总结字符串，而不是整数

# google-maps - 使用 sql 数据库中的信息向谷歌地图添加标记

> ID：10390268
> 
> 赞同：1
> 
> 时间：2012-04-30T20:38:47.457
> 
> 标签：google-maps, google-maps-markers

我在数据库中有一组坐标，我想用它在谷歌地图上添加标记

我创建了以下代码

```
var map;
function initialize() 
  {
    var latloncenter = new google.maps.LatLng(51,-1.4469157);
    var myOptions = 
    {
      zoom: 4,
      center: latloncenter,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

  }; 

  <? while($row = mysql_fetch_assoc($result)){?>

      var lon = "<?php echo($row['Longitude']); ?>"; 
      var lat = "<?php echo($row['Latitude']); ?>"; 

     //alert_test(lat,lon);
     setmarker(lat,lon);

<? } ?>

function setmarker(lat,lon)
{

var latlongMarker = new google.maps.LatLng(lat,lon);

var marker = new google.maps.Marker
    (
        {
            position: latlongMarker, 
            map: map,
            title:"Hello World!"
        }
    ); 

}

function alert_test(lat,lon)
{
    alert(lat +" "+ lon);
} 
```

```
<body onload="initialize()"><div id="map_canvas"></div></body> 
```

它正在加载地图，我知道来自数据库的查询工作正常，但是我认为我在 setmarker() 方法中做错了....有人知道如何让它工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:51:53.480

您必须将 PHP-setmarker 循环放入`initialize()`. 请尝试一下。

我不知道 JavaScript 的所有复杂性，但我认为`var`只编写一次是个好主意`var lat, var lon`（它在 PHP 循环中重复）。好吧，JS 解释器可能并不关心这两种方式。

# json - 如何使用 jquery 从 db 中正确获取 django 模型？

> ID：10390269
> 
> 赞同：0
> 
> 时间：2012-04-30T20:38:56.393
> 
> 标签：json, django-models, google-cloud-datastore

我正在尝试从 django 获取模型，但没有显示任何内容。该应用程序部署在 Google App Engine 上。

这是我看到的错误：

```
AttributeError at /get_companies_json

'str' object has no attribute 'status_code'

Request Method:     GET
Request URL:    http://127.0.0.1:8000/get_companies_json
Django Version:     1.3
Exception Type:     AttributeError
Exception Value:    

'str' object has no attribute 'status_code' 
```

以下是我的网址，查看功能：

网址：

```
('^get_companies_json$', 'companies.views.all_companies_json') 
```

视图功能：

```
def all_companies_json(request):
    # json_serializer = serializers.get_serializer("json")();
    companies_json = serializers.serialize("json", Company.objects.filter(approved = True));
    return companies_json; 
```

jQuery：

```
$.getJSON("/get_companies_json",
            function(data){
                $.each(data.items, function(i, item){
                    console.log(item);
                });             
            }
        ); 
```

我正在关注 jQuery 网站上的示例：http: [//api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:51:17.213

我认为这个功能

```
def all_companies_json(request):
    # json_serializer = serializers.get_serializer("json")();
    companies_json = serializers.serialize("json", Company.objects.filter(approved = True));
    return companies_json; 
```

需要改为

```
def all_companies_json(request):
    # json_serializer = serializers.get_serializer("json")();
    companies_json = serializers.serialize("json", Company.objects.filter(approved = True));
    return HttpResponse(companies_json, mimetype="application/json") 
```

# visual-studio-2010 - 滚动视觉工作室电话模拟器

> ID：10390272
> 
> 赞同：1
> 
> 时间：2012-04-30T20:39:13.213
> 
> 标签：visual-studio-2010, windows-phone-7

我需要模拟器中的滚动查看器的帮助。在 xaml 中一切正常，但在模拟器中我有......嗯错误？或者这是我的错。当我想向下滚动时，它会下降......所有屏幕的 1/3......当我释放它时它会自动上升到上一个位置（起始位置）我不知道这是我的坏还是模拟器漏洞...

```
<phone:PhoneApplicationPage 
    x:Class="Excercises.Weider_s_six"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait" Orientation="Portrait"
    mc:Ignorable="d" shell:SystemTray.IsVisible="True" d:DesignHeight="768" d:DesignWidth="480">

    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="#FF1FB0DB">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--ContentPanel - place additional content here-->

        <ScrollViewer>
            <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0" Height="1500">

                <TextBlock HorizontalAlignment="Left" Margin="1,15,0,85" Width="Auto" Height="Auto" Name="TextBlock1" TextWrapping="Wrap"> 
                <LineBreak />
            <Run FontFamily="Segoe WP" FontSize="27" FontWeight="ExtraBlack" TextDecorations="Underline">
               Weider 6 pack Training is a perfect exercise for flat stomach. 
                </Run>
                <LineBreak />
            <Run Text="This easy training programme has many advantages." FontSize="27" />
            <LineBreak />
            <Run Text="1\. It's perfect for beginners and for experts" FontWeight="ExtraBlack" TextDecorations="Underline" FontSize="27" />
            <Run Text=" – exercises are easy and begin with the basic level, so every beginner can use them but they get more complicated pretty fast so advanced sportsmen can also be interested in them." FontSize="27" />
            <LineBreak />
            <Run Text="2.It helps not only carve your muscles but also burn fat" FontWeight="ExtraBlack" TextDecorations="Underline" FontSize="27" />
            <Run Text=" – during the exercise you not only use your abdominal rectus but you also move your legs and arms. It is also because W6 puts pressure on the number of repetitions. It carves your muscles but also burns fat. You can train W6 for about 40 minutes without taking any breaks – you use up all glycogen in blood and start burning the fat." FontSize="27" />
            <LineBreak />
            <Run Text="3.It is easy " FontStyle="Normal" FontWeight="ExtraBlack" TextDecorations="Underline" FontSize="27" />
            <Run Text="– it is a really easy training set which you can train almost anywhere. All you need is flat ground." FontSize="27" />
            <LineBreak />
            <Run Text="4.It gives excellent results" FontStyle="Normal" FontWeight="ExtraBlack" TextDecorations="Underline" FontSize="27" />
            <Run Text=" – if you want to have a flat stomach W6 is designed just for you. You can see the first effects after just a week and after a whole series it is really impressive." FontSize="27" />"
            <LineBreak />
                </TextBlock>

            </Grid>
        </ScrollViewer>

    </Grid>

    <!--Sample code showing usage of ApplicationBar-->
    <!--<phone:PhoneApplicationPage.ApplicationBar>
        <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True">
            <shell:ApplicationBarIconButton IconUri="/Images/appbar_button1.png" Text="Button 1"/>
            <shell:ApplicationBarIconButton IconUri="/Images/appbar_button2.png" Text="Button 2"/>
            <shell:ApplicationBar.MenuItems>
                <shell:ApplicationBarMenuItem Text="MenuItem 1"/>
                <shell:ApplicationBarMenuItem Text="MenuItem 2"/>
            </shell:ApplicationBar.MenuItems>
        </shell:ApplicationBar>
    </phone:PhoneApplicationPage.ApplicationBar>-->

</phone:PhoneApplicationPage> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T01:33:53.007

您需要在此处进行一些更改才能使其正常工作。首先，您的 ScrollViewer 确实应该在网格内。其次，摆脱网格上的高度。它最终看起来像这样：

```
<!--LayoutRoot is the root grid where all page content is placed-->
<Grid x:Name="LayoutRoot" Background="#FF1FB0DB">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!--ContentPanel - place additional content here-->

  <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0" >
    <ScrollViewer>

      <TextBlock HorizontalAlignment="Left" Margin="1,15,0,85" Width="Auto" Height="Auto" Name="TextBlock1"
                 TextWrapping="Wrap">
        <LineBreak />
        <Run FontFamily="Segoe WP" FontSize="27" FontWeight="ExtraBlack" TextDecorations="Underline">
          Weider 6 pack Training is a perfect exercise for flat stomach.
        </Run>
        <LineBreak />
        <Run Text="This easy training programme has many advantages." FontSize="27" />
        <LineBreak />
        <Run Text="1\. It's perfect for beginners and for experts" FontWeight="ExtraBlack"
             TextDecorations="Underline" FontSize="27" />
        <Run
            Text=" – exercises are easy and begin with the basic level, so every beginner can use them but they get more complicated pretty fast so advanced sportsmen can also be interested in them." FontSize="27" />
        <LineBreak />
        <Run Text="2.It helps not only carve your muscles but also burn fat" FontWeight="ExtraBlack"
             TextDecorations="Underline" FontSize="27" />
        <Run Text=" – during the exercise you not only use your abdominal rectus but you also move your legs and arms. It is also because W6 puts pressure on the number of repetitions. It carves your muscles but also burns fat. You can train W6 for about 40 minutes without taking any breaks – you use up all glycogen in blood and start burning the fat." FontSize="27" />
        <LineBreak />
        <Run Text="3.It is easy " FontStyle="Normal" FontWeight="ExtraBlack" TextDecorations="Underline"
             FontSize="27" />
        <Run Text="– it is a really easy training set which you can train almost anywhere. All you need is flat ground." FontSize="27" />
        <LineBreak />
        <Run Text="4.It gives excellent results" FontStyle="Normal" FontWeight="ExtraBlack"
             TextDecorations="Underline" FontSize="27" />
        <Run Text=" – if you want to have a flat stomach W6 is designed just for you. You can see the first effects after just a week and after a whole series it is really impressive." FontSize="27" />
        "
        <LineBreak />
      </TextBlock>

    </ScrollViewer>
  </Grid>

</Grid> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T00:14:21.647

造成这个问题的原因是 ScrollViewer 在需要滚动之前不知道它可以占用多少空间，因此占用了无限空间，因此不需要滚动它的内容。您看到的反弹是当您尝试移动到滚动查看器容器的末端之外时发生的情况。

您可以通过从 LayoutRoot 中删除 RowDefinitions 来解决这个问题，因为它是网格中的唯一项目。

目前它在一行中，可以根据需要增长（这就是将行高设置为“自动”的意思）。这与网格空间无关。您需要限制 ScrollViewer 可以占用的空间量，以便它知道它需要滚动其内容。

# php - 如何更改SC 编辑器？

> ID：10390276
> 
> 赞同：0
> 
> 时间：2012-04-30T20:39:29.857
> 
> 标签：php, jquery

我一直在使用 SC Editor，但对于字体大小，它使用`<font size="number"></font>`. 反正有没有改成`<span class="font+number"></span>`？

我一直在寻找插件JS，但找不到任何东西。任何人都可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-04T17:28:52.013

您需要指定 xhtml 插件，即使您使用的是 xhtml 版本的 sceditor

```
$("textarea").sceditor({
    plugins: "xhtml"
}); 
```

# razor - Razor 语法的 DRY 方法标记网页当前查看的选项卡

> ID：10390278
> 
> 赞同：1
> 
> 时间：2012-04-30T20:39:38.267
> 
> 标签：razor, dry

我在网页顶部有一些标签：主页、功能、联系人等。

我需要将我当前所在的类别标记为 .

如何使用 razor 语法对我的 _Layout.cshtml 页面进行适当的编码，这样我就不必手动将每个页面的相应选项卡标记为 class="current" ？

```
<li class="current">@Html.ActionLink("Home", "Index", "Home")
<li>@Html.ActionLink("Blog", "Blog", "Home")
<li>@Html.ActionLink("Portfolio", "Portfolio", "Home") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:53:03.350

您可以做到的示例方式。

```
@helper BuildLink(string name, string action, string controller)
{
    var url = Url.Action(action, controller);
    bool isActive = Request.Url.AbsolutePath.Equals(url, StringComparison.InvariantCultureIgnoreCase);
    <li class="@(isActive ? "current" : String.Empty)"><a href="@(url)">@name</a></li>
}

@BuildLink("Home", "Index", "Home")
@BuildLink("Blog", "Blog", "Home")
@BuildLink("Portfolio", "Portfolio", "Home") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:57:53.453

您可以在每个控制器上设置 ViewData["Home"] = "activeTab" 类，并在视图中使用该信息。

如果采用该 viewData 字典的值，这将使选项卡处于活动状态。很简单也很干净。

内部控制器设置 viewdata 像这样

```
ViewData["SomeTab"] = "activeTab";
    return View("Index"); 
```

视图面：

```
<li class="<@ ((string)ViewData["SomeTab"] ?? "") >"><@Html.ActionLink("SomeTab", "Index", "Home")></li>
<li class="<@ ((string)ViewData["MyPage"] ?? "") %>"><@Html.ActionLink("MyPage", "MyPage", "")></li> 
```

# asp.net - 在文本中显示脚注字符

> ID：10390281
> 
> 赞同：1
> 
> 时间：2012-04-30T20:40:17.703
> 
> 标签：asp.net, text, formatting

我有一个复选框，文本需要显示脚注字符“1”，但无法弄清楚 + 或 & 序列以使其正确显示。任何人都可以帮忙吗？

```
<asp:CheckBox ID="cbSFAAViolationObserved3" runat="server" Text=" Ashtray(s) present^1" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:52:03.423

我认为您需要 sup 标签。像这样：

```
<asp:CheckBox ID="cbFootNote" runat="server" Text="footnote here<sup>1</sup>" /> 
```

# erlang - 配置文件和 Reltool

> ID：10390282
> 
> 赞同：1
> 
> 时间：2012-04-30T20:40:23.600
> 
> 标签：erlang

我正在使用 Reltool 构建一个版本。该应用程序需要配置文件才能启动。它使用以下函数读取配置文件：

```
read_config(Filename) ->
    {ok, [Config]} = file:consult(filename:join(
                                  [filename:dirname(code:which(?MODULE)),
                                   "..", "config", Filename])),
    Config. 
```

使用配置文件以便 Reltool 构建工作版本的好方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T05:24:57.217

如果您需要更专业的配置文件`rebar`，您可以将文件复制到您的版本中，例如。使用文件中的选项（不是标准配置选项）进入`etc`应用程序下的文件夹（默认`rebar`创建）：`etc``overlay``reltool.config``overlay``reltool`

```
%% reltool.config
{overlay, [{copy, "../path/foo.config", "etc/foo.config"}, ... 
```

您可以使用以下文件将配置文件作为参数传递给 vm `vm.args`：

```
%% vm.args
-config etc/foo.config 
```

您的启动脚本应该将 vm.args 文件作为参数传递给 vm（再次`rebar`生成一个自动执行此操作的脚本）。

该函数`init:get_argument`允许您向 vm 读取更专业的参数，例如：

```
%% vm.args
-very_special_config etc/foo.config 
```

和

```
case init:get_argument(very_special_config) of
  {ok, Arg} -> Arg;
  _ -> fail
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T23:01:09.843

您不需要拥有自己的配置文件，除非它用于非常特殊的目的。如果您的配置文件因版本而异，您可以将这些不同的配置添加到您的`<application>/ebin/<application>.app`.

您可以将默认配置变量设置为`<application>/ebin/<application>.app`. 有关这方面的更多详细信息，请参阅[http://www.erlang.org/doc/man/app.html](http://www.erlang.org/doc/man/app.html)

然后，您可以使用 `application:get_env(<application_name>, <key>, <default_value>)`. 如果没有定义，也可以用`application:set_env/3`. 有关更多信息，请查看此[http://www.erlang.org/doc/man/application.html](http://www.erlang.org/doc/man/application.html)

然后，您还可以通过定义覆盖这些应用程序变量`<any_name_or_system_name>.config`，然后在使用`erl`命令开始时使用该变量`--config <file_name>.config`。你可以看看这个启动命令选项，[http://www.erlang.org/doc/man/erl.html](http://www.erlang.org/doc/man/erl.html)

启动命令时，您还可以使用`-<application> <key> <value>`.

您还可以查看此应用程序的配置文件语法。 [http://www.erlang.org/doc/man/config.html](http://www.erlang.org/doc/man/config.html)

一旦你成功地构建了一个 OTP 应用程序，它对你来说似乎很容易。

# ocean - 通过例如组策略大规模部署 PIP？

> ID：10390285
> 
> 赞同：2
> 
> 时间：2012-04-30T20:40:51.763
> 
> 标签：ocean, petrel

关于如何使用例如组策略促进 Petrel PIP 文件（插件包）的大规模部署，是否有任何建议？

包内容（插件文件）很简单，但用户特定的 PluginManagerSettings.xml 文件需要小心处理。对于希望能够为此目的自定义和重新打包 MSI 文件的客户来说，这个概念不太适合。

斯伦贝谢谨慎的做法是提供该领域的一些文档和建议的最佳实践。如果文档存在，我深表歉意，并希望得到指点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T14:57:30.157

在 Ocean 2012（现在处于 beta 测试中）中，新的 PluginManager.exe 可以通过命令行从 pip 文件安装卸载启用和禁用插件。其中一些命令可以添加到 msi 文件中。这在 Ocean chm 帮助中的 2012 版白皮书“Plug-in Identity and Deployment”中有说明。

# c - 逐行写入？

> ID：10390290
> 
> 赞同：1
> 
> 时间：2012-04-30T20:41:28.793
> 
> 标签：c, fwrite

我有下面的代码。我想逐行写入所有新数据，我该怎么做？我的代码工作正常，但它将数据彼此相邻写入。

```
////////////////////////////////////
char timedate[13];
char USERID[] ="100050"; 
char *p;
p=fetch_time(); //the function returns a string (char[13])
strcpy(timedate, p);

char log_sensor_event[20];
sprintf(log_sensor_event, "%s %s",timedate, USERID);

FILE *fp2;
fp2=fopen("/home/eagle/Desktop/log_file.txt", "ab");
if(fp2 == NULL){
    perror("log_file.txt open failed");
    exit(EXIT_FAILURE);
}
write(log_sensor_event, sizeof(log_sensor_event[0]), sizeof(log_sensor_event)/sizeof>(log_sensor_event[0]), fp2);
fputc('\n', fp2);
fclose(fp2); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:45:27.957

您创建没有换行符的字符串：

```
sprintf(log_sensor_event, "%s %s",timedate, USERID); 
```

试试这个：

```
sprintf(log_sensor_event, "%s\n %s",timedate, USERID); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T20:46:09.590

您需要`'\n'`在字符串之间插入换行符 ( ) ：

```
sprintf(log_sensor_event, "%s %s\n",timedate, USERID); 
```

注意结尾的“\n”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T09:04:40.200

为什么不更换你的

```
char log_sensor_event[20];
sprintf(log_sensor_event, "%s %s",timedate, USERID);

...
write(log_sensor_event, sizeof(log_sensor_event[0]), sizeof(log_sensor_event)/sizeof>(log_sensor_event[0]), fp2);
fputc('\n', fp2); 
```

只需通过

```
fprintf(fp2, "%s %s\n", timedate, USERID); 
```

这避免了很多调用和本地缓冲区。

I/O 的缓冲可以用 设置`setvbuf`。

# sql-server - 在 SQL Server 中停止查询的命令

> ID：10390292
> 
> 赞同：2
> 
> 时间：2012-04-30T20:41:35.377
> 
> 标签：sql-server

我有一个很长的 SQL 脚本，我运行它来预填充一些临时表。在脚本的底部，我有一些手动运行的查询，以及一些其他的即席查询。我打开查询，然后启动它（需要几分钟才能运行）。但是，我不希望脚本末尾的所有查询都运行 - 我只想填充临时表。

`SQL Server 2008 Management Studio`有一个“断点”功能，可以在该点停止脚本，但是如果您关闭应用程序并重新打开它，它将忘记断点（仅持续到您设置它的会话）。

我可以注释掉底部的查询并手动运行它们。但是，对我来说理想的解决方案是在我的脚本中包含一个命令来阻止脚本运行。

`SQL Server 2008`是否有一个命令可以放入我的脚本中，该命令将在特定位置停止处理 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T20:45:39.623

只需在要停止执行脚本的地方放一个 RETURN 即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T20:48:44.927

另一个可能的解决方案是放置一个 waitfor 命令，以便脚本暂停。如果您可以确定脚本已经到达该点，您可以随时停止它，只要您等待的时间不超过 waitfor。例如

```
-- first part of script

RAISERROR('Finished above section, about to wait...', 0, 1) WITH NOWAIT;
WAITFOR DELAY '23:59:59';

-- rest of script 
```

您也可以有条件地执行此操作，例如

```
DECLARE @stop BIT = 0;

-- first part of script

IF @stop = 1
BEGIN
    RAISERROR('Finished above section, about to wait...', 0, 1) WITH NOWAIT;
    WAITFOR DELAY '23:59:59';
END

-- rest of script 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T20:46:36.560

添加类似的东西

如果（假）然后运行您的查询

并在您想执行它们时将其更改为 true

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-04-30T20:43:55.633

但是最后的查询包含在注释块中，例如

/*

您的查询在这里

*/

# ios - 在 C4 中为形状设置动画时的伪影 - c4framework

> ID：10390294
> 
> 赞同：3
> 
> 时间：2012-04-30T20:41:46.987
> 
> 标签：ios, c4

在 C4 中对形状进行动画处理时，形状的未定义预设特征（例如线宽和填充色）也会进行动画处理。是否有解决此问题的方法或解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:15:37.500

C4Shapes 设置为使用默认颜色 C4Red（用于 strokeColor）和 C4Blue（用于 fillColor）。此外，默认动画持续时间设置为 0.25 秒。

从技术上讲，正在发生的事情是，C4Shape 正在使用 C4Red / C4Blue 颜色构建自己，然后在它碰到画布时立即启动从这些颜色到任何新颜色的动画。

要解决这些问题并生成您自己的设置，您可以将 C4Shape 子类化并将着色/计时/其他属性更改添加到您的类自己的 init 方法中。

在 MyShape 类的实现（.m 文件）中，我有：

```
@implementation MyShape
-(id)initWithFrame:(CGRect)frame {
    self = [super initWithFrame:frame];
    if(self != nil) {
        self.animationDuration = 0.0f;
        self.fillColor = [UIColor purpleColor];
        self.strokeColor = [UIColor greenColor];
    }
    return self;
}
@end 
```

...我的 C4WorkSpace.m 看起来像这样：

```
#import "C4WorkSpace.h"
#import "MyShape.h"

@implementation C4WorkSpace

-(void)setup {
    MyShape *ms = [MyShape new];
    [ms ellipse:CGRectMake(100, 100, 100, 100)];
    [self.canvas addShape:ms];
}

@end 
```

我知道目前这有点粗糙，但我们还没有在对象碰到画布之前设置默认颜色。

# grails - 为什么我不能让我的记录器写入 Grails 中的文件附加程序？

> ID：10390304
> 
> 赞同：2
> 
> 时间：2012-04-30T20:42:28.963
> 
> 标签：grails, logging, groovy, grails-2.0, grails-config

我有一个控制器和一个名为`ApiController`and的服务`ApiService.groovy`。我有我的 Config.groovy 文件设置来使用附加程序将`error`和`info`日志写入文件。当我调用`log.info("foo")`我的服务时，它只写入 STDOUT 而不是文件。文件已创建，但从未写入。

这是我的 Config.groovy

```
// log4j configuration
def isProd = Environment.current == Environment.PRODUCTION

def catalinaBase = System.properties.getProperty('catalina.base')
if (!catalinaBase) catalinaBase = '.'   // just in case

def logDirectory = "${catalinaBase}/logs"
if (!isProd) {
    logDirectory = 'logs'
}

log4j = {
    // Example of changing the log pattern for the default console
    // appender:
    //
    appenders {
        appenders {
            console name: 'debug,info,warn,error,stdout,logfile', layout: pattern(conversionPattern: '%c{2} %m%n')
            appender new RollingFileAppender(name: "apiLog", maxFileSize: 1024, file: "${logDirectory}/api.log")
            appender new RollingFileAppender(name: "pingDupLog", maxFileSize: 1024, file: "${logDirectory}/pingDup.log")
            appender new RollingFileAppender(name: "fraudLog", maxFileSize: 1024, file: "${logDirectory}/fraud.log")
            appender new RollingFileAppender(name: "appLog", maxFileSize: 1024, file: "${logDirectory}/app.log")
        }
    }

    error   apiLog: ['grails.app.services.com.ono.catfish.ApiService',
                     'grails.app.controllers.com.ono.catfish.ApiController'],

            'org.codehaus.groovy.grails.web.servlet',  //  controllers
            'org.codehaus.groovy.grails.web.pages', //  GSP
            'org.codehaus.groovy.grails.web.sitemesh', //  layouts
            'org.codehaus.groovy.grails.web.mapping.filter', // URL mapping
            'org.codehaus.groovy.grails.web.mapping', // URL mapping
            'org.codehaus.groovy.grails.commons', // core / classloading
            'org.codehaus.groovy.grails.plugins', // plugins
            'org.codehaus.groovy.grails.orm.hibernate', // hibernate integration
            'org.springframework',
            'org.hibernate',
            'net.sf.ehcache.hibernate'

    info    apiLog: ['grails.app.services.com.ono.catfish.ApiService',
                     'grails.app.controllers.com.ono.catfish.ApiController']

    root {
        info 'stdout', 'appLog'
    }
} 
```

这是我的服务`grails-app/com/ono/catfish/ApiService.groovy`：

```
package com.ono.catfish

class ApiService {

    def ping(Map params) {

        log.info("Received submission: ${params.toMapString()}")
        log.error("Testing Error Log")

    }
} 
```

谁能帮我弄清楚我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:23:40.487

我的猜测是你应该像这样`apiLog`附加到你的`root`记录器；

```
root {
    info 'stdout', 'appLog', 'apiLog'
} 
```

此外，您的控制台附加程序名称是错误的，它应该是`"stdout"`唯一的。

# ios - 导航控制器上未添加按钮

> ID：10390308
> 
> 赞同：0
> 
> 时间：2012-04-30T20:42:51.670
> 
> 标签：ios

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    ac = [[AddContacts alloc]init];
    self.navigationController = [[UINavigationController alloc] initWithRootViewController:ac];
    [self.view addSubview:navigationController.view];

    UIBarButtonItem *anotherButton = [[UIBarButtonItem alloc] initWithTitle:@"Show" style:UIBarButtonItemStylePlain target:self action:@selector(refreshPropertyList:)];          
    self.navigationController.navigationItem.rightBarButtonItem = anotherButton;
} 
```

为什么我的按钮没有添加到导航控制器上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:50:09.700

`UIBarButtonItem`s 不是由导航控制器控制的，而是由它包含的每个视图控制器控制的——每个控制器都可以`UIViewController`有不同的按钮。尝试：

```
ac = [[AddContacts alloc]init];
UIBarButtonItem *anotherButton = [[UIBarButtonItem alloc] initWithTitle:@"Show" style:UIBarButtonItemStylePlain target:self action:@selector(refreshPropertyList:)];          
ac.navigationItem.rightBarButtonItem = anotherButton; 
```

`UINavigationController`然后像你一直在做的那样初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T20:53:40.667

这里有几件事可能会导致问题。

可能主要问题是这一行：

```
self.navigationController.navigationItem.rightBarButtonItem = anotherButton; 
```

我很确定您要设置的是`ac`视图控制器导航项上的右栏按钮项。

```
ac.navigationItem.rightBarButtonItem = anotherButton 
```

不过还有一些其他的事情：

*   不要有两个字母的变量名。“ac”非常模糊，“addContacts”会提供更多信息，“addContactsViewController”会提供更多信息
*   您是否在子类中实现自己的`navigationController`属性`UIViewController`？不建议这样做，因为它会覆盖已有的`navigationController`属性。`UIViewController`给它一个不同的名字。
*   父视图控制器上的`-viewDidLoad`方法是分配 AddContacts 对象的右栏按钮的地方吗？考虑改为将设置栏按钮的代码放在 AddContacts 的实现中。

# ruby-on-rails - 在带有日期时间的 Rails 中使用 Accepts_nested_attributes_for

> ID：10390315
> 
> 赞同：0
> 
> 时间：2012-04-30T20:43:22.633
> 
> 标签：ruby-on-rails, datetime, nested-forms, datetime-select, time-select

我正在尝试使用 accept_nested_attributes_for 在 Rails 应用程序中使用可重复的日期时间部分。

我有以下内容：

```
accepts_nested_attributes_for :meetings, :allow_destroy => true, :reject_if => lambda { |a| a[:starting_at].blank? } 
```

在我看来，我目前正在使用 rails`date_select`和`time_select`.

虽然它不会保存提交，但我认为这是因为它是`starting_at`一个多部分的日期时间属性。我`a[:starting_at].blank?`过去在使用 text_fields 时使用过，但它似乎不适用于 date_select/time_select 字段。

任何人都可以解释一下吗？

我的另一个选择是使用 a`text_field`但我不知道如何做到这一点，以便日期和时间很容易（并且用户友好地选择），因为如果我使用`f.text_field :starting_at`它将日期和时间结合在一个文本字段中.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T08:33:11.240

最后，最简单的方法是使用`text_field`. 我现在只需要找到一个日期时间选择器（可能是 jquery UI 之一）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T23:34:40.777

您可以轻松使用 text_field，并找出最好的方法。

你保持在你的视野中

> f.text_field :starting_at

在您的模型中：

```
def starting_at=(input)
  # use a shared converter to convert the format from your textfield
  x = self.string_to_date(input, I18n.t('date.formats.default'))
  write_attribute(:starting_at, x)
end

def starting_at
  # Same but in reverse
  return date_to_string(read_attribute(:starting_at), I18n.t('date.formats.default') )
end 
```

# javascript - 我的动画 gif（带有 alpha）在我的模态窗口顶部是不透明的

> ID：10390316
> 
> 赞同：0
> 
> 时间：2012-04-30T20:43:27.160
> 
> 标签：javascript, html, image, dom

相同的 gif 在其他页面上显示得很好，但在 jQuery SimpleModal 控件上却没有。该问题在 IE、FireFox、Chrome 中重复出现。

```
$("#id_MainImg").attr("src", "img/loading_.gif");

// first, show modal, and processing clock.
$("#id_show_individual").modal('', {
    closeHTML:"",
    containerCss:{
        backgroundColor:"#fff",
        borderColor:"#fff",
        height:160,
        padding:0,
        width:350
    },
    overlayClose:true
}); 
```

这就是我首先显示处理时间流逝的方式。直到我从服务器获得结果。

![在此处输入图像描述](../Images/afc6bc522e33e94e46f699cf18841468.png)

然后我将其更改为正确的图像。

可能是什么问题呢 ？

# wpf - 使用“附加属性”是输入捕获的好习惯吗？

> ID：10390332
> 
> 赞同：2
> 
> 时间：2012-04-30T20:45:42.943
> 
> 标签：wpf, xaml, attached-properties

我正在寻找一种通用方法来支持我的 WPF TextBox 控件的键盘楔形扫描。

（当谈到更高级的 WPF 功能时，我真的是一个新手，所以在我投入大量时间进行研究之前，我想问问我是否朝着正确的方向前进。）

我想要做的是向我的 TextBoxes 添加一个附加属性（或其他东西），这将导致它读取所有输入到框中，然后使用扫描的输入调用自定义“ScanCompleted”命令。

如果附加属性不适合此，那么有没有办法在文本框上获取此命令，而无需降低我自己的自定义“ScanableTextBox”？

（注意：扫描（而不是输入数据）的标准是以暂停键 (#19) 开始，以返回键 (#13) 结束。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T20:51:28.030

我认为这可能可以通过附加属性（行为）来完成，但是简单地继承`TextBox`并覆盖`OnTextChanged`、`OnKeyDown`和`OnKeyUp`类似方法来添加自定义功能会更简单、更直接。

您为什么不想以这种方式创建自己的控件？

### 更新：附加行为

如果您真的不想要派生控件，请使用以下附加行为来完成此操作（以下说明）：

```
 public class ScanReading
  {
    private static readonly IDictionary<TextBox, ScanInfo> TrackedTextBoxes = new Dictionary<TextBox, ScanInfo>();

    public static readonly DependencyProperty ScanCompletedCommandProperty =
      DependencyProperty.RegisterAttached("ScanCompletedCommand", typeof (ICommand), typeof (ScanReading), 
      new PropertyMetadata(default(ICommand), OnScanCompletedCommandChanged));

    public static void SetScanCompletedCommand(TextBox textBox, ICommand value)
    {
      textBox.SetValue(ScanCompletedCommandProperty, value);
    }

    public static ICommand GetScanCompletedCommand(TextBox textBox)
    {
      return (ICommand) textBox.GetValue(ScanCompletedCommandProperty);
    }

    private static void OnScanCompletedCommandChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
      var textBox = d as TextBox;
      if (textBox == null)
        return;

      var command = (ICommand) e.NewValue;

      if (command == null)
      {
        textBox.Unloaded -= OnTextBoxUnloaded;
        textBox.KeyUp -= OnTextBoxKeyUp;
        TrackedTextBoxes.Remove(textBox);
      }
      else
      {
        textBox.Unloaded += OnTextBoxUnloaded;
        TrackedTextBoxes.Add(textBox, new ScanInfo(command));

        textBox.KeyUp += OnTextBoxKeyUp;
      }
    }

    static void OnTextBoxKeyUp(object sender, KeyEventArgs e)
    {
      var textBox = (TextBox) sender;

      var scanInfo = TrackedTextBoxes[textBox];
      if (scanInfo.IsTracking)
      {
        if (e.Key == Key.Return)
        {
          scanInfo.ScanCompletedCommand.Execute(textBox.Text);
          scanInfo.IsTracking = false;
        }
      }
      else if (string.IsNullOrEmpty(textBox.Text) && e.Key == Key.Pause)
      {
        TrackedTextBoxes[textBox].IsTracking = true;
      }
    }

    static void OnTextBoxUnloaded(object sender, RoutedEventArgs e)
    {
      var textBox = (TextBox) sender;
      textBox.KeyUp -= OnTextBoxKeyUp;
      textBox.Unloaded -= OnTextBoxUnloaded;
      TrackedTextBoxes.Remove(textBox);
    }
  }

  public class ScanInfo
  {
    public ScanInfo(ICommand scanCompletedCommand)
    {
      ScanCompletedCommand = scanCompletedCommand;
    }

    public bool IsTracking { get; set; }
    public ICommand ScanCompletedCommand { get; private set; }
  } 
```

通过声明`TextBox`这样的方式来使用它（`local`您的附加属性的命名空间在哪里，并且`ScanCompleted`在`ICommand`您的视图模型上）：

```
<TextBox local:ScanReading.ScanCompletedCommand="{Binding ScanCompleted}" /> 
```

现在，当设置此属性时，我们将`TextBox`与关联的 一起添加到静态集合中`ICommand`。

每次按下一个键，我们检查它是否是`Pause`键。如果是，*并且如果`TextBox`是空*的，我们设置一个标志`true`来开始寻找`Enter`密钥。

现在每次按下一个键，我们检查它是否是`Enter`键。如果是，我们执行命令，传入`TextBox.Text`值，并将标志重置`false`为`TextBox`.

我们还为事件添加了一个处理程序`TextBox.Unloaded`来清理我们的事件订阅并`TextBox`从静态列表中删除。

# c# - Linq 从视图中选择行？

> ID：10390337
> 
> 赞同：2
> 
> 时间：2012-04-30T20:46:18.310
> 
> 标签：c#, linq, linq-to-sql

我在我的 sql 数据库中有一个视图，它映射在我的 dbml 文件中。让我们称之为`userview`

```
using(FooDataContext db = new FooDataContext()){
var users = from ur in db.userview
            where ur.username == "james"   //username is a colomn of userview
            select ur;
} 
```

我收到以下错误

> 找不到源类型“TestProject.Models.userview”的查询模式的实现。未找到“选择”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:02:47.473

您是否已将 System.Linq 添加到您的代码文件中？

# jquery - 精益模式不是一个功能

> ID：10390338
> 
> 赞同：1
> 
> 时间：2012-04-30T20:46:18.713
> 
> 标签：jquery

希望你能帮我解决这个问题。我在我的网站上使用了一些 jQuery 脚本（一个是`leanModal`，我过去曾多次使用过，没有任何问题）。我正在处理的网站（使用 WP）运行良好，直到几个小时前该模式停止工作。查看错误控制台，它指出：

```
$ is not a function
$("a#go").leanModal();

$ is not a function
$(function() { 
```

两者都与`leanModal`. 任何想法为什么会突然发生这样的错误？

参考站点在这里（[http://richgc.com/freelance/industry/](http://richgc.com/freelance/industry/)），通过单击“信息”触发模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:50:39.240

看起来你`$`以某种方式覆盖了。

`$`是`undefined`
`jQuery`返回一个 jQuery 对象。( `function (a,b){return new e.fn.init(a,b,h)}`)

* * *

正如在您的源代码中找到的**@Rocket ：**

你`jQuery.noConflict();` [在这里使用](http://richgc.com/freelance/industry/index.php?wpsc_user_dynamic_js=true&ver=3.%E2%80%8C%E2%80%8B8.8.525805)

将变量释放`$`到之前的状态 ( `undefined`)

阅读`noConflict` [文档](http://api.jquery.com/jQuery.noConflict/)：

> 说明：放弃jQuery对$变量的控制

# zend-framework - Zend 框架，如果 (!$row) 不起作用，则回显消息

> ID：10390339
> 
> 赞同：0
> 
> 时间：2012-04-30T20:46:20.960
> 
> 标签：zend-framework

如果行数为 0 我想回显一条消息，这应该是直截了当的。这是我所拥有的：

```
public function getClubComment($id) {
$id = (int) $id;
$row = $this->fetchRow('club_id = ' . $id);
if (!$row) {
    echo 'No comments';
    }
    return $row->toArray();
    var_dump($row);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T15:24:13.783

fetchRow返回一个对象，即使没有结果，这就是为什么if语句中的条件总是为假，试试这个

```
if (!count($row)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T07:06:50.083

也许尝试类似：

```
//not sure if this will work as I don't do this kind of request anymore
public function getClubComment($id) {
$id = (int) $id;
$row = $this->fetchRow('club_id = ?',  $id);
if (!$row) {echo 'No comments';}
    return $row->toArray();
    var_dump($row);
} 
```

我认为你会更高兴做这样的事情，消除大部分猜测。

```
public function getClubComment($id) {
$id = (int) $id;
//create instance of Zend_Db_Select object
$select = $this select();
$select->where('club_id = ?', $id);
//fetchRow using Zend_Db_Select object
$row = $this->fetchRow($select);
//fetchRow() returns NULL so may as well test for that.
if ($row === NULL) {
    throw new Zend_Db_Table_Exception();
    }
    return $row->toArray();
    var_dump($row);
} 
```

[Zend_Db_Select](http://framework.zend.com/manual/en/zend.db.select.html)在模型中使用非常有用，因为它通常负责正确引用值，并且很容易使用任何 sql 构建相当复杂的 sql 查询。在这个例子中，我对 select() 的每个部分都使用了离散的行，但我可以很容易地将它们串在一起。我个人喜欢将每一行分开，这样我就可以轻松更改或排除故障。

# css - opa 文本区域宽度

> ID：10390341
> 
> 赞同：0
> 
> 时间：2012-04-30T20:46:25.327
> 
> 标签：css, twitter-bootstrap, textarea, opa

我正在使用 bootstrap 和 opa 来显示一个 textarea，但我没有设法将我的 textarea 跨越整个屏幕宽度。

我正在使用以下简单代码：

```
import stdlib.themes.bootstrap;
import stdlib.widgets.bootstrap;

WB = WBootstrap;

textInput = <textarea style="width=30%" rows=30> This is a text area </textarea>
text2Input = <textarea style="width=100%" rows=1> another textarea </textarea>

content = WB.Grid.row([{span:4, offset:none, content: text2Input}]) <+>
 WB.Grid.row([{span:16, offset:none, content: textInput}])

Server.start(
   Server.http,
   [
     {page: function() {content}, title: "test" }
   ]
) 
```

我也尝试使用以下 css ：

```
textarea
{
    border:1px solid #999999;
    width:10%;
    margin:5px 0;
    padding:3px;
} 
```

但它也不起作用。

似乎 WBoostrap 覆盖了我的所有更改。"width:100%" 样式不会出现在 opa 生成的 xhtml 中。

这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:28:31.127

那么您的代码中有多个问题：

*   首先，有一个错字：它是`style="width:100%"`

*   其次，Twitter Bootstrap 2.0 现在是 12 列宽，所以`span16`没有任何意义，你最多可以写`span12`（如果你查看[http://bootstrap.opalang.org](http://bootstrap.opalang.org)，它说最多 16，因为它是为 BS <= 1.4 编写的)

*   第三，你在哪里写的 CSS ？如果它直接在 Opa (css = ...) 中，它确实会被 Bootstrap CSS 覆盖（因为 Opa CSS 将在所有其他资源之前包含在内），因此您可能需要包含外部 CSS（您可以查看[https://github.com/Aqua-Ye/OpaChat](https://github.com/Aqua-Ye/OpaChat)）

*   最后，`WBootstrap.Grid`似乎并没有真正适应制作 100% 宽度的元素。

# jquery - 为什么jQuery自动小写属性值？

> ID：10390346
> 
> 赞同：25
> 
> 时间：2012-04-30T20:47:02.363
> 
> 标签：jquery

我正在使用直接放入 HTML 文件的 SVG

```
<svg>
   Contents...
</svg> 
```

使用 javascript/jQuery 我想向 SVG 添加一个属性

```
$("svg").attr("viewBox", "0 0 166 361"); 
```

这是运行上述脚本后修改后的 SVG

```
<svg viewbox="0 0 166 361">
   Contents...
</svg> 
```

注意它把 viewbox 放在 viewBox 上。由于 viewbox（小写）没有做任何事情，我需要它是 viewBox（camelcase）

有任何想法吗？

** 更新 **

我运行了一个小测试，从服务器端渲染 viewBox 属性，然后运行上面的脚本。可以看到 1\. 从服务端渲染的时候，没问题。2\. jQuery 无法识别camelCase viewBox 属性并插入另一个全小写的属性。

```
<svg version="1.1" id="Layer_1" x="0pt" y="0pt" width="332" 
     height="722" viewBox=" 0 0 100 100" viewbox="0 0 166 332">
...
</svg> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-30T20:53:17.480

我可能取决于您的编码文档类型。 [XHTML 文档的所有 HTML 元素和属性名称必须使用小写](http://www.w3.org/TR/xhtml1/#h-4.2)。我不确定HTML。

**更新 2**

我能找到的唯一解决方案是使用：

```
$("svg")[0].setAttribute("viewBox", "0 0 166 361"); 
```

**更新**

我无法以任何理由解释它，我在自己的主机上进行了测试，因为 JsFiddle 总是使用 XHTML（嘘！）。在所有情况下它都是小写的，但它仍然是 FF、Chrome 和 IE9 中的 SVG 元素（我不知道它们是否有效，因为我害怕我不知道 SVG）。

![火狐示例](../Images/3f4ca66ab9383cdb9c6d3473b14f85d5.png) ![铬示例](../Images/f60f6bfe058030fbdee13e9aa9cf02bf.png) ![IE 示例](../Images/a35aba1054514d766f47a786122bd5a7.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-05T11:27:29.380

因为 html 不区分大小写并且 xhtml 标签和属性应该小写，所以 jQuery 将属性名称转换为小写。因为 xml 区分大小写，所以当嵌入式 xml 语言像 SVG 那样使用驼峰式属性名称时，这是一个问题。

您可以使用 jQuery 挂钩来处理您希望不转换大小写的属性名称。如果要设置 jQuery `jQuery.attrHooks[attributename].set` ，它将使用它来设置属性。当`jQuery.attrHooks[attributename].get`它尝试检索属性值时也是如此。例如：

```
['preserveAspectRatio', 'viewBox'].forEach(function(k) {
  $.attrHooks[k.toLowerCase()] = {
    set: function(el, value) {
      el.setAttribute(k, value);
      return true; // return true if it could handle it.
    },
    get: function(el) {
      return el.getAttribute(k);
    },
  };
}); 
```

现在 jQuery 将使用您的 setter/getter 来操作这些属性。

**注意**：`el.attr('viewBox', null)`会失败；你的钩子设置器不会被调用。相反，您应该使用 el.removeAttr('viewBox')。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-23T21:29:40.643

[http://docs.jquery.com/Won't_Fix#SVG.2FXML.2FVML_Bugs](http://docs.jquery.com/Won%27t_Fix#SVG.2FXML.2FVML_Bugs)

jQuery 认识到他们 toLower 所有属性名称但不关心例外/删除这一行，因为与 SVG 相关的错误被忽略（在我看来 toLower 是多余的）。

# c++ - 用 Qt 替换 HTML 文件中的特殊占位符

> ID：10390348
> 
> 赞同：1
> 
> 时间：2012-04-30T20:47:12.303
> 
> 标签：c++, qt, markers

祝大家有美好的一天！

我有这种 HTML 文件：

```
 <tr>
    <td>
      <p>First name: </p>
    </td>
    <td>
      <p> %first_name% </p>
    </td>
  </tr>
  <tr>
    <td>
      <p>Last name: </p>
    </td>
    <td>
      <p"> %last_name% </p>
    </td>
  </tr> 
```

我正在寻找一种用具体数据替换类型(%smth%) 的特殊标记的方法。项目正在Qt下开发，所以我想知道一些Qt的方法是否可以做到。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T05:58:01.407

最简单的解决方案可能是使用[QString & **QString::replace** ( const QString & before, const QString & after, Qt::CaseSensitivity cs = Qt::CaseSensitive )](http://qt-project.org/doc/qt-5.1/qtcore/qstring.html#replace-8)，它将*之前*的字符串替换为*之后*的字符串并返回一个引用到这个字符串。

将 html 文件的内容放入 QString 中，然后调用 QString::replace() 以用具体数据替换特殊标记。例如：

```
QString firstName("John");
html.replace("%first_name%", firstName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:03:27.527

至于[不能使用](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)正则表达式，我建议使用[xmlpatterns](http://qt-project.org/doc/qt-5.0/qtxmlpatterns-module.html)库支持的 XSLT。

**编辑**

由于有人认为在这种情况下他仍然可以用正则表达式解析 html，我将给出一些示例，这将显示正则表达式失败：

1.  您在属性中有标记（并且您不希望它被替换）

    ```
    <p class="%first name"> 
    ```

2.  有人会想注入：

    ```
    map: %firstname -> <srcipt language ="javascript">....</script> 
    ```

    XSLT 替换后会自动转义。

# javascript - 调试器中缺少 Javascript 文件引用

> ID：10390349
> 
> 赞同：2
> 
> 时间：2012-04-30T20:47:14.207
> 
> 标签：javascript

我不确定我做了什么导致这种情况，但直到几分钟前，我一直能够使用 FireFox firebug 调试我的 JavaScript 文件（在我正在使用的 .aspx 页面中使用脚本标记引用）工具。突然，我无法通过 FireFox 脚本选项卡列表查看该文件。我滚动页面中包含的脚本文件列表，但没有看到我希望在列表中出现的特定 Javascript 文件。但是，我能够确认 JavaScript 文件与页面信息一起加载，位于 Firefox 的 HTML 标记下。

```
**No Javascript on this page**

If <script> tags have a "type" attribute, it should equal "text/javascript" or "application/javascript". Also scripts must be parsable (syntactically correct). 
```

我在使用 chrome 时遇到了类似的问题。当我拉出完全加载的文件时，我能够确认我的 JavaScript 文件被正确引用。但由于某种原因，我无法验证脚本正在运行或调试它。

Web 应用程序工作文件的其余部分。问题只是一页。

**一个解决方案** 我创建了一个新的 aspx 文件。从错误页面复制代码并运行它，它在 Firefox 和 chrome 上都运行良好。

# sip - 如何开始编写基于 SIP / VoIP 的软件

> ID：10390353
> 
> 赞同：2
> 
> 时间：2012-04-30T20:47:41.663
> 
> 标签：sip, voip, rtp, stun

我需要在我公司的基于 Windows 的软件中添加一些基于 SIP 的功能，允许用户呼叫分机并从注册到 SIP 服务器的分机接收呼叫。本质上，我将创建一个简单的软电话。该软件可能在不同的网络上运行，因此需要考虑 NAT、防火墙和 STUN 服务器。

我想知道其他人是否做过这种事情，如果是这样，您对如何开始有任何建议。

我应该从头开始编写自己的 SIP 堆栈吗？

我应该考虑使用 OPAL 吗？它看起来很理想，但他们只列出了一家他们知道使用他们的图书馆的公司，这让我很担心。

我应该考虑其他 3rd 方库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T10:15:30.437

[http://www.opensips.org/](http://www.opensips.org/)是为服务器端实现工作的不错选择。如果你要做一个 SIP 客户端，尝试搜索 webphones。带有 javascripts 的东西很酷。

这是一个列表： [http ://www.voip-info.org/wiki/view/Open+Source+VOIP+Software](http://www.voip-info.org/wiki/view/Open+Source+VOIP+Software)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T07:56:41.797

Opal 已存在多年 - 代码已提供给各种商业用户。该代码已经在许多恶劣的环境中进行了测试。

好的软件就像酒——它会随着年龄的增长而成熟。欧泊已经成熟得很好。

该库是极端的 C++ - 我希望你很了解 C++。

使用 Opal - 因为当他们要求 h.323 时，这很容易。

代码已经在很多编译器上测试过——（win、gcc、mac），每一个编译器都可以看作是一双新的眼睛，或者另一个CPP质量检查系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:37:56.730

您应该避免编写自己的实现，因为这个 voip 是一个庞大而复杂的主题。我也不推荐 OPAL（那已经过时了）。只需搜索“SIP SDK”，您就会看到很多现成可用的解决方案，然后选择更适合您需求的解决方案。

# c# - 使用内存流进行序列化/反序列化

> ID：10390356
> 
> 赞同：49
> 
> 时间：2012-04-30T20:47:53.103
> 
> 标签：c#, serialization, deserialization, memorystream

我在使用内存流进行序列化时遇到问题。这是我的代码：

```
/// <summary>
/// serializes the given object into memory stream
/// </summary>
/// <param name="objectType">the object to be serialized</param>
/// <returns>The serialized object as memory stream</returns>
public static MemoryStream SerializeToStream(object objectType)
{
    MemoryStream stream = new MemoryStream();
    IFormatter formatter = new BinaryFormatter();
    formatter.Serialize(stream, objectType);
    return stream;
}

/// <summary>
/// deserializes as an object
/// </summary>
/// <param name="stream">the stream to deserialize</param>
/// <returns>the deserialized object</returns>
public static object DeserializeFromStream(MemoryStream stream)
{
    IFormatter formatter = new BinaryFormatter();
    stream.Seek(0, SeekOrigin.Begin);
    object objectType = formatter.Deserialize(stream);
    return objectType;
} 
```

我得到的错误如下：流不是有效的二进制格式。起始内容（以字节为单位）是：blah....

我不确定是什么导致了错误。任何帮助将不胜感激。

调用示例：

```
Dog myDog = new Dog();
myDog.Name= "Foo";
myDog.Color = DogColor.Brown;

MemoryStream stream = SerializeToStream(myDog)

Dog newDog = (Dog)DeserializeFromStream(stream); 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-30T21:14:41.387

这段代码对我有用：

```
public void Run()
{
    Dog myDog = new Dog();
    myDog.Name= "Foo";
    myDog.Color = DogColor.Brown;

    System.Console.WriteLine("{0}", myDog.ToString());

    MemoryStream stream = SerializeToStream(myDog);

    Dog newDog = (Dog)DeserializeFromStream(stream);

    System.Console.WriteLine("{0}", newDog.ToString());
} 
```

类型是这样的：

```
[Serializable]
public enum DogColor
{
    Brown,
    Black,
    Mottled
}

[Serializable]
public class Dog
{
    public String Name
    {
        get; set;
    }

    public DogColor Color
    {
        get;set;
    }

    public override String ToString()
    {
        return String.Format("Dog: {0}/{1}", Name, Color);
    }
} 
```

实用方法是：

```
public static MemoryStream SerializeToStream(object o)
{
    MemoryStream stream = new MemoryStream();
    IFormatter formatter = new BinaryFormatter();
    formatter.Serialize(stream, o);
    return stream;
}

public static object DeserializeFromStream(MemoryStream stream)
{
    IFormatter formatter = new BinaryFormatter();
    stream.Seek(0, SeekOrigin.Begin);
    object o = formatter.Deserialize(stream);
    return o;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-08-29T19:31:48.870

使用方法从内存中序列化和反序列化集合对象。这适用于集合数据类型。此方法会将任何类型的集合序列化为字节流。创建一个单独的类`SerilizeDeserialize`并添加以下两个方法：

```
public class SerilizeDeserialize
{

    // Serialize collection of any type to a byte stream

    public static byte[] Serialize<T>(T obj)
    {
        using (MemoryStream memStream = new MemoryStream())
        {
            BinaryFormatter binSerializer = new BinaryFormatter();
            binSerializer.Serialize(memStream, obj);
            return memStream.ToArray();
        }
    }

    // DSerialize collection of any type to a byte stream

    public static T Deserialize<T>(byte[] serializedObj)
    {
        T obj = default(T);
        using (MemoryStream memStream = new MemoryStream(serializedObj))
        {
            BinaryFormatter binSerializer = new BinaryFormatter();
            obj = (T)binSerializer.Deserialize(memStream);
        }
        return obj;
    }

} 
```

如何在你的类中使用这些方法：

```
ArrayList arrayListMem = new ArrayList() { "One", "Two", "Three", "Four", "Five", "Six", "Seven" };
Console.WriteLine("Serializing to Memory : arrayListMem");
byte[] stream = SerilizeDeserialize.Serialize(arrayListMem);

ArrayList arrayListMemDes = new ArrayList();

arrayListMemDes = SerilizeDeserialize.Deserialize<ArrayList>(stream);

Console.WriteLine("DSerializing From Memory : arrayListMemDes");
foreach (var item in arrayListMemDes)
{
    Console.WriteLine(item);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T21:49:21.780

`BinaryFormatter`在某些特定情况下可能会产生无效的输出。例如，它将省略未配对的代理字符。接口类型的值也可能存在问题。阅读此[文档页面](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx)，包括社区内容。

如果您发现您的错误持续存在，您可能需要考虑使用 XML 序列化程序，如`DataContractSerializer`或`XmlSerializer`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-26T08:40:34.897

它可以通过使用[System.Text.Json](https://docs.microsoft.com/en-us/dotnet/api/system.text.json?view=net-6.0)在 .Net 6 中使用 System.Text.Json 轻松完成；

```
Examlple ex = JsonSerializer.Deserialize<Example>(ms);
Console.WriteLine(ex.Value);

class Example
{
    string Value {get; set; }
} 
```

请参阅[此](https://docs.microsoft.com/en-us/dotnet/api/system.text.json.jsonserializer.serialize?view=net-6.0#System_Text_Json_JsonSerializer_Serialize_System_IO_Stream_System_Object_System_Type_System_Text_Json_JsonSerializerOptions_)进行序列化。

# iphone - 核心数据：无法将持久存储添加到协调器

> ID：10390358
> 
> 赞同：0
> 
> 时间：2012-04-30T20:47:57.563
> 
> 标签：iphone, objective-c, ios, core-data

我正在制作一个基于某些属性（例如名称、颜色、重量等）显示生物体的应用程序，但这些属性要到运行时才能知道。这就是我以编程方式创建 NSManagedObjectModel 的原因。似乎我能够正确初始化模型，因为我使用 NSLog 语句来显示有机体实体的属性。但是当我调用该方法时：

```
[orgPersistentStoreCoordinator 
addPersistentStoreWithType:NSSQLiteStoreType                                        
configuration:nil URL:storUrl options:nil error:&error] 
```

它返回 NO 并且我在持久存储协调器方法中收到错误消息：

> “无法添加持久存储：操作无法完成。（Cocoa 错误 256。）”

我试过打开这些选项，但我仍然遇到同样的错误：

```
NSString * const NSMigratePersistentStoresAutomaticallyOption;
NSString * const NSInferMappingModelAutomaticallyOption; 
```

这是完整的代码：

```
- (NSPersistentStoreCoordinator *)orgPersistentStoreCoordinator {

if (orgPersistentStoreCoordinator != nil) {
    return orgPersistentStoreCoordinator;
}
NSURL *storUrl = [NSURL fileURLWithPath: [[self applicationDocumentsDirectory]
                                          stringByAppendingPathComponent:@"organisms.sqlite"]];
NSError *error = nil;

orgPersistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc]
                              initWithManagedObjectModel:[self orgManagedObjectModel]];

NSLog(@"Entities: %@",[[self orgManagedObjectModel] entities]);

if (![orgPersistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType 
                                                 configuration:nil URL:storUrl options:nil error:&error]) {
        /*Error for store creation should be handled in here*/
    NSLog(@"Could not add persistent store:%@",[error localizedDescription]);
}

return orgPersistentStoreCoordinator;

} 
```

这是我如何以编程方式创建 ManagedObjectModel 的片段。

```
+ (NSManagedObjectModel *) orgManagedObjectModel 
{
FieldGuide *f = [FieldGuide sharedFieldGuide];

NSManagedObjectModel *orgModel = [[NSManagedObjectModel alloc]init];

NSEntityDescription *organismEntity = [[NSEntityDescription alloc]init];
[organismEntity setName:@"OrganismCoreData"];
[organismEntity setManagedObjectClassName:@"OrganismCoreData"];
[orgModel setEntities:[NSArray arrayWithObject:organismEntity]];

NSMutableArray *orgEntityProperties = [[NSMutableArray alloc]init];

 // 1\. Name attributes
for (NameParameter *n in f.nameAttributes) 
{
    NSAttributeDescription *nameAttr = [[NSAttributeDescription alloc]init];
    [nameAttr setName:n.name];
    [nameAttr setAttributeType:NSStringAttributeType];
    [orgEntityProperties addObject:nameAttr];
}
[organismEntity setProperties:orgEntityProperties];

return orgModel;
} 
```

最后，当我尝试插入一些生物体并通过 NSManagedObjectContext 保存时，应用程序终止并在日志中显示：

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'This NSPersistentStoreCoordinator has no persistent stores.  It cannot perform a save operation.' 
```

任何帮助或指导将不胜感激，谢谢！

编辑：是的，我已经尝试从模拟器中删除应用程序，清理目标，并通过finder从文档文件夹中删除organism.sqlite。

编辑#2：我忘了添加 addPersistentStore 方法也返回另一个错误：

```
2012-04-30 14:13:46.109 biodex[7510:14803] CoreData: error: (1) I/O error for database at /Users/junryandelacruz/Library/Application Support/iPhone Simulator/5.1/Applications/ACE957AF-2FC0-4EAF-B226-5019F70FAB90/Documents/organisms.sqlite.  SQLite error code:1, 'near "OR": syntax error' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:52:24.937

看起来你的`storeURL`. 这是“未知文件读取错误”，通常与文件的路径有关。

从[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html)中：

```
NSFileReadUnknownError = 256, 
```

第二个错误当然与添加持久存储无关。检查您的代码中的“OR”谓词。

# objective-c - Xcode 错误地声明“Cloud.h”不存在

> ID：10390359
> 
> 赞同：0
> 
> 时间：2012-04-30T20:48:01.503
> 
> 标签：objective-c, ios, xcode, cloud

我正在创建一个使用[CloudApp](https://github.com/cloudapp/objective-c)的应用程序。我正在使用“TestHarness”来查看将其导入我的应用程序时会发生什么。问题是，Xcode 一直在说“找不到'Cloud.h'文件”，而实际上它在目录中。要查看我在说什么，请单击[此处](http://cl.ly/0p3x2g3A0W3Y1A070Y0T)。

我试图找到与我的问题类似的任何东西，但要么什么也没找到，要么它可能或什至可能不接近我所要求的东西，而且它适用于较低版本的 Xcode（我使用的是 Xcode 4.2，如图所示）。

我会很感激我能得到的任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:53:13.147

你需要使用：

```
#import "Cloud/Cloud.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:25:50.317

您需要在应用程序中添加 CloudApp 头文件的路径：

*   选择目标，
*   转到“构建设置”，
*   '标题搜索路径'

（可能需要检查“递归路径”）。

# java - 无法使用 Jersey 从 rest 服务获取数据字段

> ID：10390363
> 
> 赞同：0
> 
> 时间：2012-04-30T20:48:27.933
> 
> 标签：java, rest, webclient

每个人！我正在开发这个宁静的 Web 服务客户端，但我在尝试获取嵌套元素时遇到了问题。这是我收到的 XML。

```
<InstalledProducts>
 <InstalledProduct>
 <uri>
 <url>
 http://immix-test.natinst.com/ib-rest/1.0/installed-product/NIC:458513.xml
 </url>
 <urn>urn:installed-product:NIC:458513</urn>
 </uri>
 <instanceId>458513</instanceId>
 <site>NIC</site>
 <serialNumber>A49AD1</serialNumber>
 <productNumber>459513</productNumber>
 <ibStatus>Latest</ibStatus>
 <ibCreationDate>1998-10-14</ibCreationDate>
 <partNumber>
  <urn>urn:product-item:181830E-01</urn>
 </partNumber>
 <latestServiceContracts>
 <url>
 http://immix-test.natinst.com/ib-rest/1.0/installed-product/NIC:458513/latestServiceContracts.xml
 </url>
 </latestServiceContracts>
 <allServiceContracts>
  <url>
   http://immix-test.natinst.com/ib-rest/1.0/installed-product/NIC:458513/allServiceContracts.xml
  </url>
  </allServiceContracts>
 </InstalledProduct>
</InstalledProducts> 
```

这是处理 InstalledProduct RootElement 的 Java 类

```
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

import org.apache.log4j.Logger;

@XmlRootElement(name = "InstalledProduct")
public class InstalledProductDTO {
private ContractsURL latestServiceContracts;
private PartNumber partNumber;
public static Logger logger = Logger.getLogger(InstalledProductDTO.class);
private int instanceId;
private String status;

@XmlElement(name = "serviceStatus")
public String getStatus() {
    return status;
}

public void setStatus(String status) {
    this.status = status;
}

@XmlElement(name = "instanceId")
public int getInstanceId() {
    return instanceId;
}

public void setInstanceId(int instanceId) {
    this.instanceId = instanceId;
}

@XmlElement(name = "partNumber") 
public PartNumber getpartNumberURN(){
    return partNumber;      
}

public void setProductNumber(PartNumber partNumber){
    this.partNumber = partNumber;
}

@XmlElement(name = "latestServiceContracts")
public ContractsURL getLatestServiceContractsURL(){
    return latestServiceContracts;
}

public void setAllServiceContractsURL(ContractsURL latestServiceContractsURL){
    this.latestServiceContracts = latestServiceContractsURL;
}
} 
```

这是处理 partNumber 标签的类，这就是问题所在。

```
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name = "partNumber")
public class PartNumber {

private String urn;

@XmlElement(name = "urn")
public String getURN()
{
    return urn;
}

public void setUrn(String urn){
    this.urn = urn;
}

} 
```

当我尝试获取 partNumber 时，我得到一个空值。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T14:44:51.197

好的，我刚刚解决了。至少这对我有用。检查在 InstalledProductDTO 类中，partNumber xml 标记的集合和获取与文字 xml 标记不匹配。标签是“partNumber”，但 get 和 set 被称为 getPartNumberURN 和 setPartNumberURN。所以我只是将它们更改为 getPartNumber 和 setPartNumber，这很有效。如果这对您有用，请让我知道以确认这一点。如果我错了，请纠正我。谢谢，希望这会有所帮助！

# javascript - Jquery Mobile - “notext”擦除按钮图标

> ID：10390364
> 
> 赞同：2
> 
> 时间：2012-04-30T20:48:35.800
> 
> 标签：javascript, jquery, html, css, jquery-mobile

好的，所以我的标题中有 2 个内联按钮，其 HTML 结构如下：

```
 <div id="applicationHeader" data-role="header"  data-theme="b">
        <h1 id="chatHeader" class="ui-title" tabindex="0" role="heading" aria-level="1">Room</h1>
        <a id="chatroomBackButton" href="#listOfChatsPage" class="ui-btn-left" data-role="button" data-icon="back"   data-transition="reverse slide">Back</a>
        <div data-type="horizontal"  class="ui-btn-right">
            <a role="button" aria-haspopup="true"  class="ui-btn-inline" style="margin-right:10px" >                    
                <select id="additionalOptions" data-icon="plus" data-iconpos="notext" data-native-menu="false">
                    <option id="addTask" value="0" href="#taskEntryPage">Add Task</option>
                    <option id="fetchMessages" value="1">Get More Messages</option>
                </select>
            </a>
            <a role="button" aria-haspopup="true"  class="ui-btn-inline ">
                <select id="subchatList" data-icon="grid" data-iconpos="notext">
                    <!--<option value="0">Main Chat</option>-->
                </select>
            </a>
        </div>

    </div> <!--end header--> 
```

但由于某种原因，当我升级到 1.1 时，`data-iconpos="notext"`不再呈现图标。这是一个 jsfiddle 链接：[示例](http://jsfiddle.net/UkjeM/)

任何帮助将不胜感激，我一直在为此苦苦挣扎。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:07:13.577

添加`data-mini="true"`到您的`select`标签中，这应该可以解决您的问题。

# php - strtotime 二月错误

> ID：10390370
> 
> 赞同：0
> 
> 时间：2012-04-30T20:48:57.470
> 
> 标签：php, strtotime

好的，所以我明白如果我在 29 日或更高的一天运行 strtotime 函数，我将引发二月错误并获得三月的结果。

我也知道如果我将日期设置为 2 月 1 日，我可以避免这个问题。

但问题就在这里。我正在滚动过去 12 个月的记录，以生成用于跟踪的销售/帐单号码。当我的循环看起来像这样时，如何在二月份询问所有记录？

```
setlocale( LC_MONETARY, 'en_US' );

$i = 0;
while( $i <= 11 ) {                 
  $select = "SELECT * FROM `my_table` " . 
            "WHERE YEAR( billing_date )  = '" . date( 'Y', strtotime( -$i . ' month' )) . "' " . 
            "  AND MONTH( billing_date ) = '" . date( 'm', strtotime( -$i . ' month' )) . "'";

  $result   = mysql_query( $select );
  $num_rows = mysql_num_rows( $result );

  $sales    = 16 * $num_rows;

  echo "<p align='center'>";
  echo   "Sales for " . date( 'M, Y', strtotime( '-' . $i . ' month' ) ) .
         "&nbsp" . money_format( '%i', $sales );
  echo "</p>";

  $i++;
} 
```

如何避免二月错误？会是`if`表态吗？那会是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:56:23.067

这是一个纯 SQL 解决方案（如果我正确理解了场景）：

```
SELECT 
    YEAR(billing_date) AS billing_year,  
    MONTH(billing_date) AS billing_month,
    16 * COUNT(*) AS sales /* Why x16?!!! */
FROM my_table
GROUP BY YEAR(billing_date), MONTH(billing_date) 
```

这将直接在 SQL 中计算销售额，因此在 PHP 中您只需要一个显示循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:01:10.517

> 我如何要求二月份的所有记录...

SELECT * FROM `table`WHERE MONTH(billing_date) = 2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T20:53:55.990

二月虫？这不是一个错误。标准化日期是一个（有用的）功能！:-)

如果您想要 2 月的最后一天，请询问 3 月 0 日。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T20:53:58.083

我不知道“二月错误”，但您可以尝试使用 MySQL 减去 1 个月。查看

```
SELECT DATE_SUB(billing_date, INTERVAL 1 MONTH) FROM my_table 
```

=>[手册](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

# database - 哪个数据库具有良好的标准全文搜索能力

> ID：10390372
> 
> 赞同：0
> 
> 时间：2012-04-30T20:49:02.167
> 
> 标签：database, full-text-search

多年来我一直在愉快地使用 MySQL，但现在在使用它时遇到了一个问题，我想知道我应该从这里去哪里。我的问题是全文索引。除非您使用第三方插件，如 Lucene 等，否则 MySQL 在大型表中使用此功能时表现不佳。

我不介意为数据库付费，但更喜欢免费服务。我没有可以维护它的数据库管理团队，只有我一个人，所以它必须易于维护、开发和扩展。我在 Windows IIS7 环境中开发，通常在 ASP.NET 和 Classic ASP 中。我的应用程序在全文表中可能最多有 1000 万行，所以不是很大但相当庞大。

我可以很容易地抓住 Lucene 并将其与 MySQL 一起使用，但我真的很想知道哪个 DB 使用全文索引执行得最好，直接开箱即用，可以这么说？

任何建议或经验都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:00:53.450

除了说sql server 上的[全文令人惊叹之外，无能为力。](http://msdn.microsoft.com/en-us/library/ms142571.aspx)起初它看起来很复杂（因为目录，索引结束了一切）但是一旦你试一试，你会发现实现起来非常简单。[该](http://blog.sqlauthority.com/2008/09/05/sql-server-creating-full-text-catalog-and-index/)网站显示了一个带有屏幕的示例

您还有几个函数来操作（搜索）数据（saurus、stoplists 等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:53:19.723

[邮递员](http://www.postgresql.org/docs/8.3/static/textsearch.html)。

此外，还有[Ruby gem](http://rubygems.org/search?utf8=%E2%9C%93&query=pg_search)可以轻松利用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T10:10:10.427

我在一个使用 Oracle 进行全文搜索的地方工作，他们对此很满意，直到他们找到了 Lucene——现在他们正在转向 Lucene。

我听说过有关 Postgres 全文搜索的好消息，但我从未见过它的实际应用。

Lucene.NET 是 Lucene 的直接 .NET 端口，并且性能良好。

# .net - Windows 服务无法连接到数据库 - ConnectionString 属性尚未初始化。

> ID：10390378
> 
> 赞同：0
> 
> 时间：2012-04-30T20:49:21.693
> 
> 标签：.net, windows-services, sqlconnection

我试图建立一个从基于 C# 的 Windows 服务到我的数据库的 SQL 连接。

> connectionString = System.Configuration.ConfigurationManager.AppSettings["SQLConnection"];

我已经配置了 app.config 文件并指定了`<connectionStrings>`. Scheduler.exe.config 位于调度程序安装文件夹中。

> 2012-04-30+16:41:59|System.InvalidOperationException：ConnectionString 属性尚未初始化。

我的设置有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:07:01.220

确保将连接字符串设置为 SqlConnection，并使用`ConnectionStrings`Web 配置中的集合。这是一个例子：

```
 SqlConnection c = new SqlConnection();
  c.ConnectionString = ConfigurationManager.ConnectionStrings["MySqlServer"].ConnectionString; 
```

您当前正在使用该`AppSettings`集合，但您声明您的值位于`<connectionStrings>`.config 的节点中。

# c++ - QT 套接字读取丢失字节

> ID：10390379
> 
> 赞同：1
> 
> 时间：2012-04-30T20:49:26.627
> 
> 标签：c++, qt

我正在尝试使用 Qt 处理长度在前的 TCP 消息。我有以下方法：

```
QByteArray con::read()
{
    QByteArray s;
    s = _pSocket->read(4);
    if (s.length() == 4) {
        int size = char_to_int32(s);
        s = _pSocket->read(size);
    }
    return s;
} 
```

好吧，它不起作用。看起来我在读取前 4 个字节后丢失了所有数据：第一次读取工作正常，但`read(size)`没有返回任何内容。有没有办法解决这个问题？

char_to_int32 是：

```
int char_to_int32(QByteArray s)
{
    int size = 0;
    size |= (s.at(0) << 24);
    size |= (s.at(1) << 16);
    size |= (s.at(2) << 8);
    size |= (s.at(3));
    return size;
} 
```

**编辑 ：**

发送函数（纯 C）：

```
int send(int connfd, const unsigned char* message, unsigned int size) {
    int c;
    unsigned char* bytes = (unsigned char*) malloc(4 + size);
    int32_to_char(size, bytes); // converts message size to 4 bytes
    memcpy(bytes + 4, message, size);
    c = write(connfd, bytes, 4 + size);
    free(bytes);
    if (c <= 0)
        return -1;
    else
        return 0;
} 
```

顺便说一句，当我调用 _pSocket->readAll() 时，会读取整个数据包，包括 4 字节大小和消息本身。

**编辑 ：**

```
void int32_to_char(uint32_t in, char* bytes) {
    bytes[0] = (in >> 24) & 0xFF;
    bytes[1] = (in >> 16) & 0xFF;
    bytes[2] = (in >> 8) & 0xFF;
    bytes[3] = in & 0xFF;
    return;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T22:25:37.217

当您使用该[`QByteArray QIODevice::read(qint64 maxSize)`](http://qt-project.org/doc/qt-4.8/qiodevice.html#read-2)功能时，您可能无法正确检测错误：

> 该功能无法报错；返回一个空的 QByteArray() 可能意味着当前没有数据可供读取，或者发生了错误。

一些事情要尝试：

*   使用[`qint64 QIODevice::read(char* data, qint64 maxSize)`](http://qt-project.org/doc/qt-4.8/qiodevice.html#read)which 报告错误：

    > 如果发生错误...此函数返回 -1。

*   打电话[`QIODevice::errorString`](http://qt-project.org/doc/qt-4.8/qiodevice.html#errorString)并[`QAbstractSocket::error`](http://qt-project.org/doc/qt-4.8/qabstractsocket.html#error)找出问题所在。

    *   对于奖励积分，请听`QAbstractSocket::error`错误信号。
*   如果这是您正在创建的新协议，请尝试使用[`QDataStream`](http://qt-project.org/doc/qt-4.8/qdatastream.html)序列化，这会自动处理长度前缀并且与平台无关。`char_to_int32`如果您混合具有不同[endienness](http://en.wikipedia.org/wiki/Endianness)的平台，您将会中断，并且可能会在不同的操作系统或编译器之间中断，因为`int`不保证是 32 位（它被定义为[至少 16 位](http://en.wikipedia.org/wiki/C_data_types)）。

    *   如果你不能使用`QDataStream`，至少使用[htons, ntohs ...](http://beej.us/guide/bgnet/output/html/multipage/htonsman.html)函数。

**编辑**

这是一些显示 hton/ntoh 用法的示例代码。请注意，使用`uint32_t`and not`int`因为它保证为 32 位。我还在`memcpy`编码/解码中使用而不是指针转换来防止混叠和对齐问题（为简洁起见，我刚刚在测试函数中进行了转换）。

```
#include <stdio.h>
#include <string.h>
#include <arpa/inet.h>

void encode(uint32_t in, char* out)
{
    /* Host to Network long (32 bits) */
    const uint32_t t = htonl(in);
    memcpy(out, &t, sizeof(t));
}

uint32_t decode(char* in)
{
    uint32_t t;
    memcpy(&t, in, sizeof(t));
    /* Network to Host long (32 bits) */
    return ntohl(t);
}

void test(uint32_t v)
{
    char buffer[4];
    printf("Host Input:  %08x\n", v);
    encode(v, buffer);
    printf("Network:     %08x\n", *((uint32_t*)buffer));
    printf("Host Output: %08x\n\n", decode(buffer));
}

int main(int argc, char** argv)
{
    test(0);
    test(1);
    test(0x55);
    test(0x55000000);
    return 0;
} 
```

# jquery - 选择 jstree 节点时加载图像

> ID：10390380
> 
> 赞同：0
> 
> 时间：2012-04-30T20:49:30.783
> 
> 标签：jquery, jstree

jstree 和 java 脚本的新手。需要创建一个 jstree，当单击一个节点时，我需要加载一个图像。单击不同的节点应加载不同的图像。到目前为止，我有这个：

```
 <html>
<head>
    <title>Tree</title>

    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="jquery.jstree.js"></script>
    <Script type="text/javascript">

 $(document).ready(function(){

     $("#test1").jstree({   

         "xml_data" : {  

             "ajax" : {  

                 "url" : "/URL/tree.xml

             },  

             "xsl" : "nest" 

         },  

         "plugins" : ["themes", "xml_data", "ui","types"] 

     });  

    });

</Script>

</script>

</head>
<body>
<div id='tree.xml1'></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T05:26:06.993

既然您提前知道图像名称和 ID，为什么不在 CSS 中完成这一切呢？无需编程，图像更新全部在 css 文件中完成。

```
#f_def.jstree-open > a > ins{
    background: url("../images/f_def.png") no-repeat scroll 0px 0px transparent ! important;
}

#f_def.jstree-open > a > ins,
#f_def.jstree-open > a{
    width:100px;
    height:100px;
}

#f_def.jstree-closed > a > ins {
    /* Use Default Icon for closed */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:21:48.183

你已经问了很多，但我认为这会对你有所帮助。这是基于您提供的代码：

```
<html>
<head>
    <title>Tree</title>

    <link href="jqueryUI/css/ui-lightness/jquery-ui-1.8.19.custom.css" rel="stylesheet" type="text/css">
    <script src="jquery-1.7.1.js"></script>
    <script src="jqueryUI/js/jquery-ui-1.8.19.custom.min.js"></script>

    <script type="text/javascript" src="jstree/jquery.jstree.js"></script>

    <script type="text/javascript">

        $(document).ready(function(){

            $("#test1").jstree({   
                "html_data" : {
                    "data" : "<li id='root'><a href='#'>My Images</a><ul>" +
                        "<li id='image1.png'><a href='#'>Image 1</a></li>" +
                        "<li id='image2.png'><a href='#'>Image 2</a></li>" +
                        "<li id='image3.png'><a href='#'>Image 3</a></li>" +
                        "</ul></li>"
                },

                "plugins" : ["themes", "html_data", "ui","types"] 
            }).bind("select_node.jstree", function (event, data) {
                $("#imageDisplay").html("Load " + data.rslt.obj.attr("id") + " here"); 
            });  
        });

</script>

</head>

<body>
    <table>
        <tr><td><div id='test1'></div></td>
        <td><div id='imageDisplay'></div></td>
        </tr>
    </table>
</body>
</html> 
```

显然，这段代码没有实际的图像可以显示，但我相信你可以填补空白。另请注意，我使用了“html_data”插件而不是“xml_data”，因为我不知道您的 XML 文件是如何格式化的。

# css - less.js 可以处理图像的相对路径吗？

> ID：10390381
> 
> 赞同：1
> 
> 时间：2012-04-30T20:49:43.023
> 
> 标签：css, less

使用less.js的时候，图片可以不使用相对路径吗？喜欢背景：url（../img/header.jpg）

它似乎将其转换为绝对路径，这是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:20:56.877

尝试引用 URL，我总是这样做以保持整洁，

```
@header-image: "../img/header.jpg";

background: url(@header-image); 
```

另外，可以在[github](https://github.com/cloudhead/less.js/blob/master/lib/less/tree/url.js)上查看 URL 代码。如果您在浏览器中运行，它似乎已添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-21T17:03:06.493

我知道这是一个较老的问题，但是我遇到了类似的问题，并且接受的答案对我不起作用..确实如此。

将 @img-path 变量设置为所需的相对路径，然后使用该变量强制 LESS 使用该路径而不是绝对路径进行渲染。

> @img-path: "/assets/images";
> 
> 背景图片: url("@{img-path}/your-image.jpg");

查看我发现的另一个答案，它指出了我正确的道路： [https ://stackoverflow.com/a/6296706/1896352](https://stackoverflow.com/a/6296706/1896352)

# iphone - 意见：如何叠加？

> ID：10390382
> 
> 赞同：0
> 
> 时间：2012-04-30T20:49:48.017
> 
> 标签：iphone

我想使用 UIProgressView，但我希望背景是图像，以使事情看起来更漂亮。我不知道如何把一个放在另一个上面。背景图像包含 UIProgressView 很重要。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:01:33.247

`UIImageView`您可以简单地为您的背景图像创建一个，然后添加一个`UIProgressView`作为子视图。

您可以在 Interface Builder 或代码中执行此操作，例如`[myBackgroundImageView addSubView:myProgressView];`

显然，您需要为两者设置正确的框架，以确保它们处于正确的位置。

查看[Apple 参考中的 addSubview](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html) :。

# android - 防止 AutoCompleteTextView 在自己的框中显示结果

> ID：10390391
> 
> 赞同：1
> 
> 时间：2012-04-30T20:50:16.003
> 
> 标签：android, autocompletetextview

我正在使用 AutoCompleteTextView 来显示用户可以选择的项目列表。当用户选择一个项目时，这个选定的项目会填充 AutoCompleteTextView 下方的 ListView。到目前为止，一切都很好。

问题：从 AutoCompleteTextView 中选择项目后，AutoCompleteTextView 主体本身（这个“文本框”）被一些文本填满，这是 SimpleCursorAdapter 资源（实际显示的文本是：android.widget。 SimpleCursorAdapter@4107d010)。

我希望拥有什么：我希望 AutoCompleteTextView 刷新并在其自身的正文中不显示任何文本，以便用户可以立即输入更多文本并从下拉列表中选择更多项目。

你能给我一个提示，我怎么能做到这一点？

补充资料：

谢谢凯尔。我所做的是将 SimpleCursorAdapter 扩展到 SimpleCursorAdapterNoText。然后我就像你说的那样覆盖了 convertToString() 。我没有更改 BindView，因为我阅读了两次文档，但我仍然不明白我应该在 BindView 中更改什么。无论如何-这并没有解决问题-我仍然在自动完成中得到相同的字符串。这是我的代码：

```
@SuppressWarnings("deprecation")
private void populateListView()
{
   // Get all of the notes from the database and create the item list
  Cursor tournamentXCursor = mDbHelper.retrieveTrounamentX(mRowId);
  startManagingCursor(tournamentXCursor);

  // Create an array to specify the fields we want to display in the list (only name)
  String[] from = new String[] {StournamentConstants.TblX.TBL_COLUMN_X_NAME};

  // and an array of the fields we want to bind those fields to (in this case just name)
  int[] to = new int[]{R.id.competitor_row};

  // Now create an array adapter and set it to display using our row
  SimpleCursorAdapterNoText tournamentX = new SimpleCursorAdapterNoText(this, R.layout.competitor_row, tournamentXCursor, from, to);

  tournamentX.convertToString(tournamentXCursor);
  setListAdapter(tournamentX);      
} 
```

任何人都知道我做错了什么？

编辑：这是我继承的 SimpleCursorAdapter 类

```
 public class SimpleCursorAdapterNoText extends SimpleCursorAdapter 
{
    public SimpleCursorAdapterNoText(Context context, int layout, Cursor c,
        String[] from, int[] to) 
    {
        super(context, layout, c, from, to);
    // TODO Auto-generated constructor stub
    }

    @Override
    public CharSequence convertToString(Cursor cursor) 
    {
    //Empty string so AutoComplete shows no text
    return "";
    }

    @Override
    public void bindView(View view, Context context, Cursor cursor) {
    // TODO Auto-generated method stub
    super.bindView(view, context, cursor);
    }
} 
```

我更改了呼叫代码并消除了

```
tournamentX.convertToString(tournamentXCursor); 
```

我确信不仅要在我的子类中覆盖它，而且还要在我的调用代码中使用它，以便消除 AutoComplete 中的文本，这一点很重要。

我很沮丧地说这仍然没有帮助 - 在我从 AutoComplete 选择列表中选择一项之后，我继续在 AutoCompleteBox 中获取 android.database.sqlite.SQLiteCursor@41377578 。

感谢：D。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T21:49:19.970

如果您只想在用户单击下拉列表中的项目时清除文本，请将 AutoComplete 定义为成员变量并覆盖它的 setOnItemClickListener。像这样：

```
mAutoComplete.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        mAutoComplete.setText("");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T22:48:56.300

如果您使用简单的光标适配器来填充 textView，则需要对其进行子类化并覆盖以下方法。您可能还必须覆盖 bindview。

```
@Override
public CharSequence convertToString (Cursor cursor){
   return "";
} 
```

您需要将上述内容放在您的 SimpleCursorAdapterNoText 类中，而不是从顶级代码中调用它。

```
class extends SimpeCursorAdpaterNotText{
// ... whatever other code you have here
@Override
    public CharSequence convertToString (Cursor cursor){
       return "";
    }
} 
```

# multithreading - 使用 Perl 线程共享二维散列

> ID：10390393
> 
> 赞同：1
> 
> 时间：2012-04-30T20:50:18.437
> 
> 标签：multithreading, perl, hash, multidimensional-array

我正在使用多线程来解析 IHS 日志文件。我为每个文件句柄分配一个单独的线程并计算 500 个错误的数量。

```
sub parse_file { 

  my $file = shift; 
  my @srv = split /\//,$file;
  my $filename = $srv[$#srv];
  my $TD = threads->tid();

  $sem->down;
    print "Spawning thread $TD to process file \"$filename\"\n" if ($verbose);
    $rTHREADS++;
    $TIDs{$TD} = 1;
  $sem->up;

  open (FH, "$file") || die "Cannot open file $file $!\n";  
  while (<FH>){    
    if (/^(\d{13}).*?(\d{3}) [\-0-9] \d+ \d+ \//){   
      my $epoch = $1/1000; 
      my $http_code = $2;
      my $ti = scalar localtime($epoch);
      $ti =~ s/(\d{2}):\d{2}:\d{2}/$1/;

      if ($http_code eq '500'){
        unless ( exists $error_count{$ti} && exists $error_count{$ti}{$http_code} ){
          lock(%error_count);
          $error_count{$ti} = &share({});
          $error_count{$ti}{$http_code}++;
        }
      }
    }
  }
  close (FH);  

  $sem->down;
    print "Thread [$TD] exited...\n" if ($verbose);
    $rTHREADS--;
    delete $TIDs{$TD};
  $sem->up;

} 
```

问题是，使用 print Dumper(%http_count) 的输出如下所示：

```
$VAR1 = 'Mon Apr 30 08 2012';
$VAR2 = {
          '500' => '1'
        };
$VAR3 = 'Mon Apr 30 06 2012';
$VAR4 = {
          '500' => '1'
        };
$VAR5 = 'Mon Apr 30 09 2012';
$VAR6 = {
          '500' => '1'
        };
$VAR7 = 'Mon Apr 30 11 2012';
$VAR8 = {
          '500' => '1'
        };
$VAR9 = 'Mon Apr 30 05 2012';
$VAR10 = {
           '500' => '1'
         };
$VAR11 = 'Mon Apr 30 07 2012';
$VAR12 = {
           '500' => '1'
         };
$VAR13 = 'Mon Apr 30 10 2012';
$VAR14 = {
           '500' => '1'
         };
$VAR15 = 'Mon Apr 30 12 2012';
$VAR16 = {
           '500' => '1'
         }; 
```

作业耗时 79 秒

每个日期的 500 计数始终设置为 1。我无法让它显示正确的计数。似乎该声明`$error_count{$ti} = &share({});`是罪魁祸首，但我不知道如何解决它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:12:40.063

根据您代码中的逻辑，每个值只增加一次：当它在`%error_count`.

要每次都增加值，但仅在必要时创建脚手架（您必须使用共享容器而不是依赖自动激活），请使用

```
if ($http_code eq '500') {
  lock(%error_count);

  unless (exists $error_count{$ti} && exists $error_count{$ti}{$http_code}) {
    $error_count{$ti} = &share({});
  }

  $error_count{$ti}{$http_code}++;
} 
```

如果锁定整个散列过于宽泛，请考虑改用[Thread::Semaphore](http://search.cpan.org/perldoc?Thread%3a%3aSemaphore)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:13:31.390

```
$error_count{$ti} = &share({}); 
```

您每次都分配一个新的哈希引用，然后在下一行中增加计数。将其更改为：

```
$error_count{$ti} ||= &share({}); 
```

这将有条件地初始化散列表成员。`undef`准确的说是当值为 或者为`0`空字符串时才生效。

# mysql - 如何在 phpMyAdmin 中更改外键

> ID：10390397
> 
> 赞同：2
> 
> 时间：2012-04-30T20:50:32.397
> 
> 标签：mysql, foreign-keys

我在我的mysql数据库中设置了一个外键：

```
ALTER TABLE `gameplayers` ADD CONSTRAINT `FK_GAMENUMBER` FOREIGN KEY (`GameNumber`) REFERENCES `games`(`GameNumber`) ON UPDATE CASCADE ON DELETE CASCADE; 
```

但是，我不确定我是否需要 ON UPDATE 和 ON DELETE。

所以我进入我的 phpAdmin，单击结构选项卡的索引部分中的编辑铅笔图标，我得到了这个：

警告：（“PRIMARY”必须是主键的名称，并且只能是主键的名称！）

是否只需要手动进行更改？即铅笔图标将不起作用。

ALSO：外键对mysql搜索有同样的速度加成效果，类似于索引吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T21:37:32.763

外键需要索引，因此有效地，外键约束创建和索引，它可以像普通索引一样用于解析查询。

我不确定您使用的是哪个版本的 phpMyAdmin，我认为最新版本支持外键包含，但您似乎没有列出外键索引，并且主键不是您要查找的。但是，您可以使用普通 SQL 修改键：

```
ALTER TABLE `gameplayers` DROP FOREIGN KEY FK_GAMENUMBER,
    ADD CONSTRAINT `FK_GAMENUMBER` FOREIGN KEY (`GameNumber`) REFERENCES `games`(`GameNumber`) ON UPDATE NO ACTION ON DELETE NO ACTION; 
```

# facebook - 脸书发展

> ID：10390398
> 
> 赞同：0
> 
> 时间：2012-04-30T20:50:34.110
> 
> 标签：facebook, facebook-graph-api

我愿意开发与 facebook 的交互。我看到有很多关于这个主题的问题，但我不知道从哪里开始。有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:41:39.203

我认为这个问题是合理的；大部分文档都是针对那些已经在 Facebook 集成中吸引眼球的人。

教程还不错。例如，如果您有 iPad/iPhone 和网络服务器，请从[http://developers.facebook.com/docs/guides/mobile/web/](http://developers.facebook.com/docs/guides/mobile/web/)开始，然后慢慢浏览。即使在那里，您也会发现它对新手并不友好，但如果您能够成功地获得一些示例，它可能会增强您的信心，并且您可以尝试浏览更复杂的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T20:59:57.350

[这里](http://developers.facebook.com/)有很多很棒的资源，包括入门部分。祝你好运！

# ssas - 计算两个日期匹配的交叉点

> ID：10390400
> 
> 赞同：0
> 
> 时间：2012-04-30T20:50:37.480
> 
> 标签：ssas, mdx

我有几个角色扮演维度，它们是日期维度的 FK。我如何最好地计算日期维度中的日期与角色扮演维度中的日期匹配的交集？

在 SQL 中，它类似于：

```
 Select  DimDate,
            COUNT(1)
    From    DimDateTable        D
    join    RolePlayingTable    R   on D.Date = R.Date
    Group by DimDate 
```

我认为这会起作用：

```
 With
    Member  [Measures].[First Date In]      as
        (
        [Measures].[Account Count],
        [Sprocket Date].[Date].CurrentMember
        )
    Member  [Measures].[First Date Out]     as
        (
        [Measures].[Account Count],
        [Widget Date].[Date].CurrentMember
        )

    Select  
            {
            [Measures].[First Date In],
            [Measures].[First Date Out]
            } on 0,

            Non Empty
            [Dim Calendar].[Date].[Date] on 1

    From    [Cube-Bert] 
```

但它只计算交叉点而不是 Sproket.Date = Calendar.Date

我也试过这个，但也不对：

```
 with 
    Member  [Measures].[Count] as
        Sum(
            Exists(
                {[Sproket Date].[Date].[Date]},
                {[Dim Calendar].[Date].[Date]}
                )
            ,[Measures].[Account Count]
            )

    select  [Measures].[Count] on 0,
            Non Empty
            [Dim Calendar].[Date].members on 1
    from    [Cube-Bert] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T14:33:22.503

我将日期匹配逻辑放入 DSV 并在事实表中生成了一个标志列，1 = true，0 = false。

# javascript - Mootools 视频“结束”绑定不起作用

> ID：10390402
> 
> 赞同：1
> 
> 时间：2012-04-30T20:50:41.253
> 
> 标签：javascript, jquery, mootools

我需要将工作的 jQuery 脚本迁移到 Mootools 以满足我的项目要求。

工作的jQuery代码是：

```
$('#video').bind('ended', function() {
  //Functions on end here.
}); 
```

我已经用 Mootools 尝试了以下操作......

```
document.id('video').addEvent('ended', function () {
    //Functions here
}); 
```

和

```
document.id('video').addEvent('ended', function () {
    //Functions here
}.bind(this)); 
```

但是没有效果:(有人能指出我正确的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T13:24:13.533

MooTools 不支持 HTML5 媒体标签事件。添加块后[写在这里](http://www.chipwreck.de/blog/2010/03/02/html-5-video-mootools/)你可以使用：

```
$('myVideo').addEvent('ended', function(){
//Functions here
}); 
```

这里**myVideo**是标签的 id：

```
<video id="myVideo"></video> 
```

# bash - 在 bash 中使用 :- （冒号破折号）

> ID：10390406
> 
> 赞同：93
> 
> 时间：2012-04-30T20:51:01.500
> 
> 标签：bash, syntax

这种风格在bash中的含义是什么？

```
${PUBLIC_INTERFACE:-eth0} 
```

目的是`:-`什么？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2012-04-30T20:52:42.570

如果`$PUBLIC_INTERFACE`存在且不为 null，则返回其值，否则返回`"eth0"`。

实际上，[bash 手册页](http://linux.die.net/man/1/bash)中记录了其中一些：

> ***${parameter:-word}***使用默认值。如果参数未设置或为空，则替换单词的扩展。否则，参数的值被替换。
> 
> ***${parameter:=word}***分配默认值。如果参数未设置或为空，则将单词的扩展分配给参数。然后替换参数的值。不能以这种方式分配位置参数和特殊参数。
> 
> ***${parameter:?word}***如果为 Null 或未设置，则显示错误。如果 parameter 为 null 或未设置，则 word 的扩展（或如果 word 不存在，则将显示消息）写入标准错误，并且 shell，如果它不是交互式的，则退出。否则，参数的值被替换。
> 
> ***${parameter:+word}***使用备用值。如果 parameter 为 null 或未设置，则不替换任何内容，否则替换 word 的扩展。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-02-15T06:33:08.230

`:-`用于[shell 参数扩展](https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameter-Expansion)：如果为 null 或未设置，则扩展为 的值，否则扩展为 的值。`${*parameter*:-*word*}` *`parameter`**`word`**`parameter`*

例子：

```
$ str=
$ echo "${str:-default}"
default 
```

这个和使用`:=`,`:+`的类似扩展`:?`都有两种风格：带和不带冒号。不同之处在于，*带有*冒号的扩展用于“未设置**或空**”，而*没有*冒号，它只是“未设置”。

观察：

```
$ str=                      # Null, but not unset
$ echo "${str-default}"     # Expands to value of $str, the empty string

$ echo "${str:-default}"    # Expands to "default"
default 
```

这在哪里有用？几个例子：

*   **默认值**

    *   调用编辑最后一个命令的编辑器[`fc`](https://www.gnu.org/software/bash/manual/bash.html#index-fc)是扩展的结果`${FCEDIT:-${EDITOR:-vi}}`：`$FCEDIT`如果已定义且不为空，或者`$EDITOR`如果已定义且不为空，或者否则`vi`。

    *   脚本中的循环如果作为参数提供，则应从文件读取，否则从标准输入读取，可能如下所示：

        ```
        while IFS= read -r line; do
            # do something
        done < "${1:-/dev/stdin}" 
        ```

*   **使用时`set -u`**

    `set -u`是一种通过在遇到未设置的变量时终止脚本来强制执行更简洁的脚本编写的便捷方法，例如[本文](http://redsymbol.net/articles/unofficial-bash-strict-mode/)所提倡的（不是我赞同其中的所有内容¹）。如果我们想检查某个变量是否具有 的值`[[ $var ]]`，如果未设置，脚本现在就会`var`终止，即使这可能是合法的。

    解决这个问题的方法是使用`[[ ${var:-} ]]`，并且`set -u`不会抱怨。（这基本上是再次使用默认值，但在这种情况下替换的值是空字符串^(。2)）

顺便说一下，这些扩展并不是 Bash 独有的：[POSIX shell 规范](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02)也拥有它们。

* * *

^(¹另请参阅BashFAQ/112，使用[(或)](http://mywiki.wooledge.org/BashFAQ/112)[的优点和缺点是什么？`set -u``set -o nounset`](http://mywiki.wooledge.org/BashFAQ/112))

^(²只是`${var-}`代替`${var:-}`实际上就足够了：`set -u`不关心已设置但包含空字符串的变量；只有未设置的会触发错误。)

# c - 按块发送数据

> ID：10390408
> 
> 赞同：1
> 
> 时间：2012-04-30T20:51:13.437
> 
> 标签：c, sockets, tcp

在 C 语言中，我必须使用 tcp/ip (~6.5mo) 发送一堆数据，我使用的是“经典”send()。您认为将要发送的整个数据大小的一部分提供给函数是一个好主意，还是我应该更喜欢块方式（例如，64ko 的切片......）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T20:58:12.687

给它完整的大小，然后用缓冲区的其余部分再次调用它（根据返回值）。

你处理你的逻辑，让操作系统处理发送逻辑。

# c# - 数据绑定 DataGridView 显示新行符号

> ID：10390411
> 
> 赞同：2
> 
> 时间：2012-04-30T20:51:23.940
> 
> 标签：c#, winforms, data-binding, datagridview

我有一个 C# (.Net 3.5) 应用程序，我试图在我的数据绑定数据网格视图中强制/显示 NewRow 符号 (* - asterick/star)。我的数据网格视图绑定到一个通用列表。

**myRecordRow 类：**

```
class myRecordRow {
    private string _recordName;
    private string _recordLocation;
    public string RecordName { 
        get { return _recordName; }
        set { _recordName = value; } 
    }
    public string RecordLocation { 
        get { return _recordLocation; }
        set { _recordLocation = value; }
    }
    public myRecordRow() {
        _recordName = string.Empty;
        _recordLocation = string.Emtpy;
    }
    public myRecordRow(string name, string location) {
        _recordName = name;
        _recordLocation = location;
    }
} 
```

**我的记录类：**

```
class myRecord {
    private List<myRecordRow> _recordRows;
    public List<myRecordRow> RecordRows { 
        get { return _recordRows; }
        set { _recordRows = value; }
    }
} 
```

现在在我的**Winform form1_Load()**事件中，我有以下内容：

```
private form1_Load() {
    BindingSource bindingSource1 = new BindingSource();

    myRecord rec = new myRecord();
    myRecordRow newRow = new myRecordRow("name1", "location1");
    myRecordRow newRow2 = new myRecordRow("name2", "location2");
    rec.RecordRows.Add(newRow); rec.RecordRows.Add(newRow2);

    dataGridView1.AutoGenerateColumns = false;
    dataGridView1.AllowDrop = true;
    dataGridView1.AllowUserToAddRows = true;
    int colIndex = dataGridView1.Columns.Add("RecordName", "myRecord Name");
    dataGridView1.Columns[colIndex].DataPropertyName = "RecordName";
    colIndex = dataGridView1.Columns.Add("RecordLocation", "myRecord Location");
    dataGridView1.Columns[colIndex].DataPropertyName = "RecordLocation";

    bindingSource1 = new BindingSource();
    bindingSource1.DataSource = rec.RecordRows;
    dataGridView1.DataSource = bindingSource1;
} 
```

注意：我有拖放事件，可以将数据正确添加到底层数据源（通用列表）。

当我的表单第一次加载时，我的数据网格视图填充了 2 个条目，但没有显示 NewRow()（带有星号/星号的那个） - 如何让我的 datagridview 显示一个 NewRow？此外，一旦用户开始添加数据（通过拖放），我也希望显示 NewRow。

显示 NewRow 的主要原因是允许添加数据的另一种（替代）方法 - 通过在任一单元格/列中输入必要的数据。我的数据绑定使用拖放操作，但似乎无法显示 NewRow，因此用户可以开始编辑单元格。而且我不想使用按钮将新行“插入”到我的基础数据源中。

任何帮助/帮助表示赞赏。我浏览了这个论坛并找到了会“隐藏”NewRow 的答案——我的正好相反，尤其是数据有界的 datagridview。谢谢你。

*   洛伦兹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:58:15.673

好的 - 我的问题是我的 BindingSource。AllowNew 属性设置为 false - 我将其设置为 true 并得到了我所需要的。有时最难的问题会得到简单的答案。

```
bindingSource1 = new BindingSource();
bindingSource1.AllowNew = true; 
```

# android - 将字符串解析为 JSONObject 的异常（在本地服务器上工作，但不在在线服务器上）android

> ID：10390413
> 
> 赞同：3
> 
> 时间：2012-04-30T20:51:31.537
> 
> 标签：android, string, json

编码：

```
public JSONArray getJSONFromUrl(String url, List<NameValuePair> params) {

    // Making HTTP request
    try {
        // defaultHttpClient
        HttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "UTF-8"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line);
        }
        is.close();
        json = sb.toString();       
        Log.e("JSON", json);
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        JSONObject json_data = new JSONObject(json);
        JSONArray hashMap_names = json_data.names();
        JSONArray hashMap_names2 = new JSONArray();
        Map hashMap = new HashMap(json_data.length());
        for (int i=0; i!=hashMap_names.length(); i++){
            //Object obj = chaves.next();
        hashMap.put(String.valueOf(i),json_data.get(String.valueOf(i)));
            hashMap_names2.put(String.valueOf(i));
        }
        JSONObject hashMap_obj = new JSONObject (hashMap);
        jArr = hashMap_obj.toJSONArray(hashMap_names2);
        Log.e("JSON Parser", "succesful parsing data " + jArr.toString());
    } catch (Exception e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
        jArr = null;
    }

    return jArr;

} 
```

在 stringbuilder.toString() 之后，json 具有以下值：

```
{"0":"27124","1":"Adsad adadda daddadadad ","2":"asdasdas@gmail.com","3":"732bcv874uhfebfehuif9724uhife","4":"wasd","5":"","6":"M","7":"","8":"","9":"","10":"","11":"","12":"06\/05\/1989","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"BR","21":"","22":"0","23":"","24":"","25":"","26":"Y","27":"Y","28":"Y","29":"N","30":"0","31":"30\/04\/2012 16:48:20","32":"17\/04\/2012 01:09:27","33":"367","34":"50","35":"0","36":"79","37":"34","38":"","39":"17\/04\/2012 01:16:54","40":"3649","41":[null,null,null,null,null,null,null,null,null,null,null]} 
```

在我看来，这是一个完美格式化的 JSON 文本。

但是当我尝试创建一个新的 JSONObject(json) 时，得到异常

```
Error parsing data org.json.JSONException: Value  of type java.lang.String cannot be converted to JSONArray 
```

但我只在使用在线服务器时收到此错误。如果我使用本地的（xammp），json 被解析为 JSONObject 并且应用程序可以工作。

我试过设置`json = "{'0':'1212','1':'username','2':'email','3':'pass'}";`，它奏效了！但是在使用时`json = "\""+json.replace('\"', '\'')+"\"";`遇到了同样的异常

顺便说一句，我使用 hashmap 只是为了在解析后对 de JSONObject 进行排序。

也许问题是因为在本地我使用的是 php 5.3，而在线服务器使用的是 php 5.2？这些版本的标头之间有什么区别吗？我怎么能验证这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T09:43:00.833

```
HttpURLConnection connection;
                    OutputStreamWriter request = null;
                    URL url = null;

                     String parameters = "parameter1="+parameter;

                    try {
                        url = new URL("http://myserver.com/samplejson.php");

                        connection = (HttpURLConnection) url.openConnection();
                        connection.setDoOutput(true);
                        connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
                        connection.setRequestMethod("POST");

                        request = new OutputStreamWriter(connection.getOutputStream());
                        request.write(parameters);
                        request.flush();
                        request.close();
                        String line = "";
                        InputStreamReader isr = new InputStreamReader(
                                connection.getInputStream());
                        BufferedReader reader = new BufferedReader(isr);
                        StringBuilder sb = new StringBuilder();
                        while ((line = reader.readLine()) != null) {
                            sb.append(line + "\n");
                        }

                        response = sb.toString();
                         ///you will get response here..

                        isr.close();
                        reader.close();

                    } catch (MalformedURLException e) {

                        e.printStackTrace();
                    } catch (IOException e) {
                        e.printStackTrace();
                    } 
```

# java - MySQL：操作后返回 SUCCESS

> ID：10390420
> 
> 赞同：1
> 
> 时间：2012-04-30T20:51:41.987
> 
> 标签：java, mysql, database, jdbc

我有一个软件，一次由 2 个用户使用，他们通过几个步骤进行交互。有时一个用户必须等待另一个用户，直到他将数据插入数据库。然后必须再次检索相同的数据。
令人困惑的是，有时我会收到所有数据，有时只是部分数据，有时甚至没有来自数据库的数据，而无需更改代码。
有没有可能，我只是“太快”地检索它？检索发生在插入后**几毫秒。**也许数据库需要一些时间进行操作。
**如果是这样，是否有可能收到“成功消息”之类的东西，表明所有内容都已插入？**

这是插入功能。它在循环中被调用多次并插入一些数据。之后，它更新另一个表中*准备好的*标志：

```
public void insert(String name, int id) {
    try {
        stmt = conn.prepareStatement("INSERT INTO user(name) VALUES (?)");
        stmt.setString(1, name);
        stmt.executeUpdate();
        stmt = conn.prepareStatement("UPDATE session set ready = 1 WHERE id = ?");
        stmt.setInt(1, id);
        stmt.executeUpdate();
        stmt.close();
    } catch (SQLException ex) {
        System.err.println(ex);
    }
} 
```

然后，这两个函数每秒检查一次是否已设置其他用户的*准备就绪标志。*

```
 timer.schedule(new TimerTask() {

        @Override
        public void run() {
            if (DB.INSTANCE.check(5)) {
                // retrieving data from database...
                timer.cancel();
            }
        }
    }, 0, 1000); 
```

如果设置了标志，则返回*true*，然后上面的函数再次检索数据。

```
public boolean check(int id) {
    boolean notify = false;
    try {
        stmt = conn.prepareStatement("SELECT * FROM session WHERE id = ?");
        stmt.setString(1, id);
        stmt.executeQuery();
        while (stmt.getResultSet().next()) {
            if (stmt.getResultSet().getInt("ready") == 1) {
                notify = true;
            }
        }
        stmt.close();
    } catch (SQLException ex) {
        System.err.println(ex);
    }
    return notify;
} 
```

到目前为止，这是我的解决方案，不幸的是，如上所述，它不起作用。

**编辑**
设置标志时调用此函数：

```
public void load() {
    data= DB.INSTANCE.loadChosen(id);
    if (data.isEmpty()) {
        model.addElement("Nothing!");
    } else {
        for (Map.Entry e : data.entrySet()) {
            System.out.println(e.getKey() + " = " + e.getValue());
            model.addElement(e.getKey());
        }
    }
} 
```

它正在被识字并放入模型（JList）中。
这是数据库类中的对应函数：

```
public HashMap load(int id) {
    try {
        stmt = conn.prepareStatement("SELECT * FROM users WHERE id LIKE ?");
        stmt.setString(1, id);
        stmt.executeQuery();
        while (stmt.getResultSet().next()) {
            String name = stmt.getResultSet().getString("name");
            int coe1 = stmt.getResultSet().getInt("coe1");
            chosenNames.put(name, coe1);
        }
        stmt.close();
    } catch (SQLException ex) {
        System.err.println(ex);
    }
    return data;
} 
```

检索到的实际数据并不重要，这些只是名称和数字，所有内容都放在 HashMap 中。
当我在控制台中返回数据时，即使它们中的一些有时会丢失，尽管它们在数据库中。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-30T20:55:59.483

您的表使用什么存储引擎？如果您使用的是 MyISAM，请考虑切换到处理行级锁定和其他好东西的 InnoDB。使用 InnoDB 会产生性能成本，因此您需要确定它是否适合您的应用程序。

**编辑2：答案不正确，请忽略。**

# unit-testing - 如何验证是否调用了 Microsoft Fakes（测试版）存根/垫片（如 Rhino Mocks 中的 AssertWasCalled）？

> ID：10390422
> 
> 赞同：9
> 
> 时间：2012-04-30T20:51:48.903
> 
> 标签：unit-testing, rhino-mocks, microsoft-fakes

我在 Visual Studio 11 中使用 Microsoft Fakes 测试版。如何验证我的测试系统是否调用了依赖项的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-30T20:52:34.473

由于验证功能不包含在 Microsoft Fakes Beta 中，因此下面的代码是对是否调用依赖项上的方法的基本测试。您可以增强`true`测试以测试正确调用的参数值或其他条件。

测试：

```
[TestMethod]
public void TestMethod1()
{
    var secondDoItCalled = false;
    var secondStub = new Fakes.ShimSecond();
    secondStub.DoIt = () => { secondDoItCalled = true; };
    var first = new First(secondStub);
    first.DoIt();
    Assert.IsTrue(secondDoItCalled);
} 
```

课程：

```
public class First
{
    readonly Second _second;
    public First(Second second) { _second = second; }
    public void DoIt() { 
        //_second.DoIt();
    }
}

public class Second {public void DoIt(){}} 
```

取消注释上面的行以查看测试通过。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-10T04:12:02.437

使用 Microsoft Fakes 框架进行行为验证的另一个选择是使用 Microsoft.QualityTools.Testing.Fakes.Stubs 命名空间中包含的 StubObserver 类。使用该框架，您可以为依赖项生成一个存根。然后在您的 Stub 上，您可以将 InstanceObserver 属性设置为新的 StubObserver。使用 StubObserver 类，您可以“查询”对您的依赖项进行的方法调用。您的测试方法如下所示

```
//Arrange
var dependency = new StubIDependency { InstanceObserver = new StubObserver() };
var sut = new SystemClass(dependency);

// Act
sut.DoSomething();

// Assert
var observer = (StubObserver)dependency.InstanceObserver;      
Assert.IsTrue(
    observer.GetCalls().Any(call => call.StubbedMethod.Name == "DoSomething")); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-12T05:15:44.040

看看这篇文章：[http ://www.peterprovost.org/blog/2012/11/29/visual-studio-2012-fakes-part-3/](http://www.peterprovost.org/blog/2012/11/29/visual-studio-2012-fakes-part-3/)

干杯

# c# - 带有文本和索引的列表视图图片

> ID：10390428
> 
> 赞同：0
> 
> 时间：2012-04-30T20:52:07.633
> 
> 标签：c#, winforms, listview, imagelist

我有一个带有图像列表的列表视图，因此我可以在列表视图中的文本附近显示图片。

问题是应用程序每次按下按钮时都会重新下载一张新图片，这意味着它会删除之前下载的图片。  

如何避免这种情况？

```
 try
    {
        var req = WebRequest.Create(string.Format("http://minotar.net/avatar/{0}/24.png", textBox1.Text));
        var stream = req.GetResponse().GetResponseStream();
        var img = Image.FromStream(stream);
        var imageList1 = new ImageList();
        pictureBox1.Image = img;

        imageList1.Images.Add(Image.FromFile(img2));
        listView1.SmallImageList = imageList1;

        for (int _index = 0; _index < imageList1.Images.Count; _index++)
        {
            var item = new ListViewItem();
            item.ImageIndex = _index;
            listView1.Items.Add(item).Text = " " + textBox1.Text;
        }
    }
    catch (Exception)
    {
        pictureBox1.Image = Properties.Resources._200;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:05:58.383

创建一个缓存 - 并检查您是否已经拥有它。如果图像没有更改，您可以将其更改为缓存到磁盘 (image.Save)。

```
// Class-level variable
var _imageDictionary = new Dictionary<string,Image>();

// Logic in method
Image image;
if(_imageDictionary.ContainsKey(textBox1.Text))
 image = _imageDictionary[textBox1.Text];
else {
   image = // code to retrieve image from web
   _imageDictionary[textBox1.Text] = image;
}

// ... add it to your image list 
```

# c# - 内联后台工作者

> ID：10390431
> 
> 赞同：0
> 
> 时间：2012-04-30T20:52:26.870
> 
> 标签：c#, backgroundworker

在 C# 中，我有两个代码块，它们打开并写入我打开的进程，我希望它们在同一个函数中同时运行。我[用匿名方法找到了 BackgroundWorker？](https://stackoverflow.com/questions/2077762/backgroundworker-with-anonymous-methods)但是当我试图暗示它时，它不会运行 lambda 表达式中的代码。

```
BackgroundWorker bgwanalysis = new BackgroundWorker();
bgwanalysis.DoWork += delegate
{
 ...codehere..
};

while (bgwanalysis.IsBusy)
{
  Thread.Sleep(2000);
} 
```

我知道我错过了一些基本的东西有人可以填补我吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T20:56:35.153

从您所展示的内容来看，我没有看到这条线：

```
bgwanalysis.RunWorkerAsync(); 
```

所以你的代码变成：

```
BackgroundWorker bgwanalysis = new BackgroundWorker();
bgwanalysis.DoWork += delegate
{
 ...codehere..
};

bgwanalysis.RunWorkerAsync();

while (bgwanalysis.IsBusy)
{
  Thread.Sleep(2000);
} 
```

# javascript - 如何在javascript中检查拖放文件的文件名中的括号？

> ID：10390447
> 
> 赞同：1
> 
> 时间：2012-04-30T20:53:43.717
> 
> 标签：javascript, html, drag-and-drop

我在将图像拖放到网站上时遇到问题，如果文件名带有 [ 或 ] 之类的括号，则会导致上传出现问题。我如何检查文件名是否有这个，如果有，那么我该如何删除它？

```
function process_drop(evt) {
    evt.stopPropagation(); 
    evt.preventDefault(); 
    var files = evt.dataTransfer.files; 

    //CHECK TO SEE IF FILE NAME HAS A BRACKET ?

    // run through each file individually.
    for (var i = 0, f; f = files[i]; i++) {

    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:58:00.010

```
string.indexOf("]") != -1 
```

indexOf 返回字符串在另一个字符串中的位置。如果没有找到，它将返回 -1。

从这里[JavaScript: 字符串包含](https://stackoverflow.com/q/1789945/103959)

* * *

对于您的其他问题：

```
var files = evt.dataTransfer.files;
//number of files
var count = files.length;
//the first file's info
var first = files[0];
//the first file's name
var name = first.name; 
```

我为你找到了一个很好的链接：[HTML5 Drag and drop file api tutorial](http://www.thebuzzmedia.com/html5-drag-and-drop-and-file-api-tutorial/)

# wordpress - 页面过多导致 Wordpress 管理员无法使用

> ID：10390461
> 
> 赞同：0
> 
> 时间：2012-04-30T20:55:06.417
> 
> 标签：wordpress

我们有一个 WordPress 网站，在导入许多定位目标页面后，它现在有大约 9k 个页面。前端运行得非常好，没有性能损失（在我用自定义 MySQL 查询替换 wp_list_pages 之后），但页面管理部分甚至无法触及。管理员的所有其他部分都可以正常打开。即使我导航到前端的页面并使用“编辑页面”链接，它也永远无法拉出“编辑页面”屏幕。更改永久链接结构没有帮助，我知道这是 WordPress 3.0 之前的问题。还尝试禁用所有插件并运行 w3cache，那里没有帮助。我在 WordPress 3.3.2 上运行。

我认为我唯一的选择是将网站拆分为构建在 Wordpress 网络上的较小子网站，但这会导致整个网站的重组延迟至少一个月。

**编辑** 一位 wordpress 开发人员提到我可以“关闭 edit.php 中的分层显示。wp_edit_posts_query() 中的过滤器可能能够适应这个”作为一种潜在的解决方法。有没有人有处理类似事情的经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:32:42.443

问题不在于 WordPress。它是完全可扩展的。问题在于您的服务器以及您使用插件所做的事情。

W3TC 不会帮助管理员。也停用 W3TC 缓存；它可能与服务器上的 APC php 配置和数据库缓存冲突。尝试[WP Super Cache](http://wordpress.org/extend/plugins/wp-super-cache/)和 php（不是 mod_rewrite）缓存。

您需要做的是使用您的 MySQL 服务器并运行[https://github.com/rackerhacker/MySQLTuner-perl](https://github.com/rackerhacker/MySQLTuner-perl)来优化 my.cnf 和 MySQL。管理员正在对数据库运行大量查询以在管理员中构建页面列表，而 MySQL 在分配内存和缓存查询方面需要帮助。

如果您无权访问您的 MySQL 服务器和 my.cf，那么是时候获取 VPS 或专用服务器了。您无法在廉价的共享主机上运行那么大的 WP 站点。

**还将您在 php.ini 中的 PHP 内存分配提高**到 128M，您可以使用它。或者在 wp-config.php 中，尝试

`define('WP_MEMORY_LIMIT', '128M');`

就在 W3TC 插入的缓存调用打开之后`<?php`和下方。

# ruby-on-rails - Rails ajax 表单提交消息

> ID：10390462
> 
> 赞同：3
> 
> 时间：2012-04-30T20:55:16.597
> 
> 标签：ruby-on-rails, ruby

我正在构建我的第一个 rails 应用程序，并且对 ruby​​ 和 rails 都很陌生。通过ajax提交表单后，我试图在页面上呈现提交消息。

我在表单中添加了 :remote => true 参数。但是，我似乎无法在我的应用程序中呈现消息。作为测试，我设置了一个新的 Rails 应用程序，并使用脚手架生成了带有表单的帖子模型和视图等。

我将远程 :remote => true 添加到生成的表单中。它将数据很好地提交给数据库。我已经读过我可以更新控制器以包含带有 format.js 的 js，在这种情况下将 posts_controller.rb 函数更新为

```
def new
  @post = Post.new

  respond_to do |format|
    format.html # new.html.erb
    format.js
  end
end 
```

一些教程说你可以在views/posts文件夹中添加一个new.js.erb或create.js.erb（不确定应该是哪个），这应该被执行，但除了提交的数据之外什么都没有发生.

我也试过：

```
format.js { render :js => "alert('Hello Rails');" } 
```

作为测试。

我正在使用 rails 3.1 并且不知道接下来应该尝试什么

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T22:00:20.503

您快到了。提交的表单由 create 操作处理，而不是由 new 处理。你已经掌握了处理 html 或 js 的语法——你只需要在你的 create 操作中使用它，以及一个包含你想要渲染的 js 的 create.js.erb。

你的 PostsController 应该有一个 create 函数，类似于

```
def create
  @post = Post.new(params[:post])

  respond_to do |format|
    if @post.save
      format.html 
      format.js 
    else
      format.html { render :action => 'new' }
      format.js   { render 'fail_create.js.erb' }
    end
  end
end 
```

创建一个名为 create.js.erb 的文件（在帖子的视图目录中），包含

```
alert('Hello Rails'); 
```

对于成功案例，您应该很高兴。创建另一个名为fail_create.js.erb 的文件，其中包含您希望在失败时呈现的任何javascript（例如，当提交的表单数据未通过模型的验证时）。

# asp.net - 回发后保留动态绑定下拉列表的选定值

> ID：10390465
> 
> 赞同：1
> 
> 时间：2012-04-30T20:55:32.320
> 
> 标签：asp.net, drop-down-menu, selectedvalue

我有一个下拉列表，我在 aspx 标记上声明如下：

```
<asp:DropDownList ID="State" runat="server"></asp:DropDownList> 
```

然后我像这样在页面加载时绑定它：

```
protected void Page_Load(object sender, EventArgs e)
    {
       BindDropdowns();
    }
private void BindDropdowns()
    {
        State.DataSource = DataAccess.GetStates();
        State.DataValueField = "FieldId";
        State.DataTextField = "FieldName";
        State.DataBind();
    } 
```

回发后不保留所选值，我也无法触发 selectedindexchangedevent。怎么了 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T20:58:40.317

请像这样更改您的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
   if (!Page.IsPostback)
       BindDropdowns();
} 
```

这意味着您的下拉控件仅在第一次页面加载时绑定一次

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T21:02:50.880

你必须使用`AutoPostBack="true"`.

```
<asp:DropDownList ID="State" AutoPostBack="true" 
 runat="server"></asp:DropDownList> 
```

并声明女巫事件处理程序是这样的：

```
<asp:DropDownList ID="State" AutoPostBack="true" 
OnSelectedIndexChanged="State_SelectedIndexChanged" 
runat="server"></asp:DropDownList> 
```

然后在代码中。仅在不回发时绑定：

```
protected void Page_Load(object sender, EventArgs e)
{
   if (!Page.IsPostback)
       BindDropdowns();
}

protected void State_SelectedIndexChanged(object sender, System.EventArgs e)  
{  
    var somevalue= State.SelectedValue;  
} 
```

# delphi - 为什么从服务安装时我的钩子 DLL 不起作用？

> ID：10390466
> 
> 赞同：2
> 
> 时间：2012-04-30T20:55:35.037
> 
> 标签：delphi, dll, windows-vista, hook

我在我的 DLL 中声明了这些函数。如果我在独立应用程序中使用它们，一切顺利，但在服务中使用它们时，我没有得到任何结果。没有钩子。

```
function HookProc(code: Integer; wParam: WPARAM; lParam: LPARAM): LRESULT; stdcall;
begin
  Result := CallNextHookEx(Code, code, wParam, lParam)
end;

procedure StartHook; stdcall;
begin
  HookHandle := SetWindowsHookEx(WH_GETMESSAGE, HookProc, hInstance, 0);
end;

procedure StopHook; stdcall;
begin
  UnhookWindowsHookEx(HookHandle);
end; 
```

问题仅存在于 Vista 及更高版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T00:31:02.710

您正在尝试将应用程序挂接到不同的桌面上。参数的文档`dwthreadId`告诉[`SetWindowsHookEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990.aspx)您不能这样做：

> 与挂钩过程关联的线程的标识符。如果此参数为零，则挂钩过程与在与调用线程相同的桌面上运行的所有现有线程相关联。

请记住，Vista up 中的会话 0 隔离意味着您的服务在与任何交互式桌面不同的会话（因此也就是不同的桌面）中运行。

我想还有其他原因会从会话 0 停止此工作。您将需要从与您希望挂钩的进程位于同一桌面的进程中运行此代码。

# iphone - Child的孩子的反比关系

> ID：10390469
> 
> 赞同：0
> 
> 时间：2012-04-30T20:55:50.047
> 
> 标签：iphone, ios, ipad, core-data, relationship

我正在尝试使用核心数据关系在孩子的子对象之间建立反向关系。

这是我要实现的目标的示例：

我有好几个文件柜，每个文件柜有几个抽屉，每个抽屉有几个文件。

*   文件柜有一个多对多抽屉
*   抽屉与文件柜相反
*   抽屉有一个 to-many to File
*   文件与抽屉相反

> 但是，当我将文件添加到抽屉时，抽屉将自身设置为文件的倒数，但我也希望在 aa 文件上使用自动**柜子倒数。**所以我可以做一些像`[file cabinet]`标准一样的事情`[file drawer]`现在，我不能创建这个特定的逆。

我知道我可以使用`[[file drawer] cabinet]`，但这是我用例的一个简单示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T22:31:07.870

为什么不给你的`NSManagedObject`子类添加一个方法呢？

```
- (Cabinet *)cabinet;
{
    return self.drawer.cabinet;
} 
```

# javascript - 如何使用自定义帖子清除 jqGrid 添加/编辑表单？

> ID：10390471
> 
> 赞同：0
> 
> 时间：2012-04-30T20:56:10.120
> 
> 标签：javascript, jquery, jqgrid

我目前正在处理 jqGrid 添加/编辑表单。我正在添加和编辑上实现自定义按钮。使用其中一个自定义按钮，我实现了 javascript 以将表单发布到服务器并重新加载网格。这目前工作正常，但是表单并没有清除输入的数据。

即我想知道如何在提交后清除添加表单的字段？

见下面的代码：

```
beforeShowForm: function () {
    $('<a href="#">Save and New<span class="ui-icon ui-icon-disk"></span></a>')
        .click(function () {
            $.post('<c:url value="/programmes/create"/>',
                $('#FrmGrid_list2').serialize(),
                function (data) {
                    $('#list2').trigger("reloadGrid");
                });
        }).addClass("fm-button ui-state-default ui-corner-all fm-button-icon-left")
          .prependTo("#Act_Buttons>td.EditButton");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:03:37.850

可能您忘记使用`recreateForm: true`（请参阅[我以前的答案](https://stackoverflow.com/a/10324302/315935)）。我多次推荐托尼将设置设为默认值。无论如何，我建议您始终使用该选项或更改一些常见 JavaScript 文件中的默认值，这些文件在 jqGrid 之后包含在所有页面中：

```
$.extend($.jgrid.edit, { recreateForm: true }); 
```

# java - 如何找出方法所在的库？

> ID：10390477
> 
> 赞同：1
> 
> 时间：2012-04-30T20:56:35.150
> 
> 标签：java, jar, junit, jmock

具体来说：MockObjectTestCase 在什么库中？

我正在关注这个链接：[http ://therning.org/niklas/2005/05/jmock-solid-testing/](http://therning.org/niklas/2005/05/jmock-solid-testing/)

有没有一种简单的方法可以找到此类信息？有没有办法搜索 JMock jar 中的所有文件？

我的构建路径中有 jmock-2.5.1.jar、jmock-junit4-2.5.1.jar、junit-4.10.jar，但是 eclipse 没有找到 MockObjectTestCase 作为我扩展的超类选择

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T20:59:30.987

在您的情况下，包裹似乎是： `org.jmock.cglib.MockObjectTestCase`

并且根据 [http://www.jarfinder.com/index.php/java/info/org.jmock.MockObjectTestCase](http://www.jarfinder.com/index.php/java/info/org.jmock.MockObjectTestCase) 似乎可以在 1.x 版本的 Jmock 中找到。

你链接到的那个帖子似乎很老了。由于您使用的是更高版本，因此该类可能不再存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T22:05:17.490

我用[findjar](http://www.findjar.com/index.x)做这种事情。在你的情况下：

*   [http://www.findjar.com/index.x?query=MockObjectTestCase](http://www.findjar.com/index.x?query=MockObjectTestCase)

点击任何结果（我不知道为什么有这么多——链接都指向同一个地方），你会得到一个罐子列表。从这些中单击，您将获得有关罐子的一些信息。

我怀疑 findJAR 和 jarFinder 主要是从 Maven Central 索引人工制品。你可以直接搜索：

*   [http://search.maven.org/#advancedsearch|gav](http://search.maven.org/#advancedsearch|gav)

在你的情况下：

*   [http://search.maven.org/#search|ga|1|c%3A%22MockObjectTestCase%22](http://search.maven.org/#search|ga|1|c%3A%22MockObjectTestCase%22)

发现相当多的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T21:26:18.837

谷歌运作良好。但有时您必须恢复到磁盘上的数据：

```
jar tf SomeJarFile.jar | grep ClassName 
```

遍历所有的罐子。

# ios - 从 WebView 中的链接打开 Mobile Safari

> ID：10390479
> 
> 赞同：27
> 
> 时间：2012-04-30T20:56:40.830
> 
> 标签：ios, webview

是否有将 Mobile Safari 打开到特定 URL 的 URI 方案？

例如，

```
<a href="safari://open_url/?url=google.com">Open Google in Safari</a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T00:59:51.247

**更新**：因此，从 iOS 6.0.2 开始，仍然没有特定于 MobileSafari 的 URL 方案（见下文）。然而，Federico Viticci 发布了一个[有趣的 hack](http://www.macstories.net/tutorials/chrome-for-ios-send-a-webpage-back-to-safari-via-bookmarklet/)，允许你从 Chrome for iOS 调用 Safari。它的功能不如 Chrome-to-Safari 小书签，但它确实表明可以从 Chrome for iOS 启动 MobileSafari。

**原始答案**：事实证明，您无法仅使用 URI 方案在 Safari 中打开链接。其他应用程序中的超链接可以在 safari 中使用`openURL`（参见其他答案）打开，但 MobileSafari 本身没有方案（如果您要使用 Chrome 或 Opera for iOS 中的超链接在 Safari 中打开链接，则需要该方案）。

Google Chrome 有以下两种 URI 方案：`googlechrome://`和`googlechromes://`（用于 HTTPS）与任何其他应用程序特定方案（例如`dayone://`、`things://`或`sms://`）一样工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T21:39:08.600

好的，我想我明白你的要求了。

让一个类实现[UIWebViewDelegate](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIWebViewDelegate_Protocol/Reference/Reference.html)协议。实现方法

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
```

每当用户单击 webview 中的链接时，都会调用此方法。您可以获取用户在检查`request`参数时单击的 URL。然后，您可以拦截要在移动 Safari 中而不是在 webView 中打开的任何链接，然后`-openURL:`像我的其他答案一样调用共享应用程序。

```
[[UIApplication sharedApplication] openURL:URLFromRequest]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T21:00:10.257

试试这个：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.google.com/"]]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-26T13:39:00.980

```
window.location.replace("x-web-search://?your search here"); 
```

Safari 的 URI 方案是 - **x-web-search://**

这将在 Safari 浏览器中打开您的搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-16T12:09:56.787

您还可以使用 webkit javascript 桥[https://github.com/marcuswestin/WebViewJavascriptBridge](https://github.com/marcuswestin/WebViewJavascriptBridge)

这允许您将消息从 javascript 发送到 xcode。我用它从 html 页面关闭 webview：

```
self.bridge = [WebViewJavascriptBridge bridgeForWebView:self.webView handler:^(id data, WVJBResponseCallback responseCallback) {
            NSLog(@"Received message from javascript: %@", data);
            if ([data isEqual:@"closewin!"])
                [self dismissModal];
        }]; 
```

但你也可以用它来跳转到 safari 或任何你想要的东西

# unit-testing - EF4.1+代码优先：使用事务进行测试

> ID：10390481
> 
> 赞同：1
> 
> 时间：2012-04-30T20:56:45.917
> 
> 标签：unit-testing, entity-framework-4.1, ef-code-first

在研究 EF 和 Code First 时，我刚才问了一个问题（[参考这个线程](https://stackoverflow.com/questions/8870707/entity-framework-code-first-tests-overlapping-each-other)），关于如何防止测试相互重叠。我想为数据库播种，并且对每个测试类都这样做（使用 MSTest）：

```
 public class CustomerSmokeTests {
    private const string CONNECTION_STRING = "server=localhost;database=CPT_CustomerDataSync_SmokeTests;uid=sa;pwd=Password1!;";

    private DatabaseFactory _dbfactory;
    private CustomerCacheContext _customerContext;

    [TestInitialize]
    public void Setup() {
      // set initializer to create new DB
      Database.SetInitializer(new SmokeTestCreateDbWithDataIfNotExists());
      Database.SetInitializer(new SmokeTestDropCreateDbWithDataAlways());

      // create new DB connection to local SQL Server
      _dbfactory = new DatabaseFactory(CONNECTION_STRING);

      // connect to DB to auto generate it
      _customerContext = _dbfactory.GetDataContext();
    }

    [TestCleanup]
    public void Cleanup() {
      _customerContext.Dispose();
      _dbfactory.Dispose();
    }

    // tests
} 
```

然而，这里的问题是每个测试都会创建/破坏数据库（不理想，因为它们相互重叠并失败......如果你单独运行测试，它们都会按需要通过......而且这会大大减慢测试速度）。

一个[好的解决方案是将它们包装在 TransactionalScopes 中](https://stackoverflow.com/questions/7023200/entitity-framework-4-1-code-first-unit-testing-data-access-layer/7023534#7023534)，但是我想确保在测试运行开始时，使用种子信息重新生成数据库（因为种子在我的开发人员开发的测试中发生变化）。

一种蛮力的方法是在测试初始化​​中创建某种处理程序，它将检查数据库是否是最近创建的，如果没有，则使用种子信息创建它。如果不是，它将忽略该步骤。然后它会创建一个 TransactionalScope() 将在测试清理中回滚。

但是有没有更好的方法来处理这个问题？用这种蛮力方法获得过度设计的感觉......想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T10:07:32.873

Marvel 的回应让我朝着正确的方向思考……让它发挥作用，在这里解释有点长，所以我在这里写了博客：[http ://www.andrewconnell.com/blog/archive/2012/05/02/isolating -integration-tests-with-ef4-x-code-first-amp-mstest.aspx](http://www.andrewconnell.com/blog/archive/2012/05/02/isolating-integration-tests-with-ef4-x-code-first-amp-mstest.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T06:35:11.643

通常，这些测试与每次检查都与持续集成服务器高度集成。因此，我认为如果您可以将 dbCreation 测试作为测试设置中的第一个测试，会更好，因为它会创建具有所有必要映射的 db。之后，在第一次测试时创建它，其他测试可以在您的基础 TestFixture 类中使用 Transactionscope 来满足您现在使用它的方式，并且您的集成测试可以有效地工作，因为您没有使用 TestInitialize 和 TestCleanup 创建数据库。

```
public class BaseTestFixture
{

TransactionScope transactionScope;

    [TestInitialize]
    public void InitializeTests()
    {            

        if (IsTransactionScopeNeeded)
        {
            transactionScope = new TransactionScope();
        } 
    }

    [TestCleanup]
    public void CleanUp()
    {
        if (transactionScope != null)
            transactionScope.Dispose();

    } 
```

}

```
public class DbContextTests : BaseTestFixture
{

    protected override bool IsTransactionScopeNeeded
    {
        get
        {
            return false;
        }
    }

    //This test should run first 
    [TestMethod]
    public void CreateDatabase_DatabaseNotExistedOrObselete_DatabaseCreated()
    {
    }
} 
```

# sql - SQL Server 日期比较忽略年份

> ID：10390485
> 
> 赞同：4
> 
> 时间：2012-04-30T20:57:05.153
> 
> 标签：sql, sql-server, sql-server-2005

我在 SQL Server 2005 上运行查询以查找日期范围内的记录。该`WHERE`子句如下所示：

```
WHERE (CONVERT(NVARCHAR, fldPublishedDate, 101) >= '" & toDate & 
   "' AND CONVERT(NVARCHAR, fldPublishedDate, 101) <= '" & fromDate & "')" 
```

`toDate`和`fromDate`像这样输入`04/01/2005`和`04/30/2005`。

我得到的结果肯定都是在 4 月 1 日至 30 日之间，但来自不同年份，从 2005 年（数据收集开始时）到 2012 年。看起来这一年在比较中被忽略了。我在这里错过了什么吗？

感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T21:01:07.230

你为什么要转换成字符串？当然，这不会按预期工作。你在说：

```
IF '12/02/2010' > '09/12/2012' 
```

这当然是真的。你应该说：

```
WHERE fldPublishedDate >= '20050401'
  AND fldPublishedDate < DATEADD(DAY, 1, '20050430'); 
```

只有在比较日期范围时才需要将该列转换为日期。最重要的是，您应该以不受区域和语言设置（例如`YYYYMMDD`）影响的明确格式传递日期。101 不是一种安全的风格，因为对于英格兰人来说 04/06/2012 是几月？那是六月，不是四月。我怀疑您应该在您的（经典 ASP？）代码中更好地格式化这些日期，或者从您使用的任何语言传递正确的日期时间数据类型。最后，不要使用没有长度的 NVARCHAR：

*   [要踢的坏习惯：在没有（长度）的情况下声明 VARCHAR](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T21:06:33.640

如果`fldPublishedDate`是 SQL 服务器中的日期，那么为什么将其转换为 a`nvarchar`进行比较。您可以将`toDate`and转换`fromDate`为日期时间并进行比较

```
declare @toDate nvarchar(50)
declare @fromDate nvarchar(50)

set @toDate  = '04/01/2005'
set @fromDate  = '04/30/2005'

select cast(@toDate as datetime), cast(@fromDate as datetime)

results:
ToDate                      FromDate
2005-04-01 00:00:00.000     2005-04-30 00:00:00.000 
```

然后在您的`WHERE`条款中：

```
WHERE fldPublishedDate >= cast(@toDate as datetime)
 AND fldPublishedDate <= cast(@fromDate as datetime) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T21:08:06.570

假设`fldPublishedDate`是`datetime`, 并且您只想比较`date`。

在 SQL 2008 中，使用方便的日期类型：

```
WHERE CONVERT(date, fldPublishedDate) >= CONVERT(date, '" & toDate & 
"' AND CONVERT(date, fldPublishedDate) <= CONVERT(date, '" & fromDate & "'" 
```

在 < SQL 2008 中，您可以使用疯狂的语法：

```
WHERE DATEADD(dd, DATEDIFF(dd, 0, fldPublishedDate), 0) >= CONVERT(datetime, '" & toDate & 
"' AND DATEADD(dd, DATEDIFF(dd, 0, fldPublishedDate), 0) <= CONVERT(datetime, '" & fromDate & "'" 
```

从技术上讲，SQL 会`datetime`为您转换您的字符串——因此您可以不进行值的转换。

此外，您应该阅读 SQL 注入和参数 - 它更易于编写、更易于阅读且更安全。赢，赢，赢。

# sql - 显示实际月份而不是数字

> ID：10390486
> 
> 赞同：0
> 
> 时间：2012-04-30T20:57:08.460
> 
> 标签：sql

我希望使用以下语句显示实际月份：

```
SELECT (MONTH(now()) - Month(cases.date_entered)) AS 'Call Month' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:05:07.277

在 SQL Server 中，您可以像这样获取月份名称：

```
 SELECT DATENAME(month, GETDATE()) AS 'Current Month' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:05:33.217

不管数据库如何，一种方法是创建一个包含月份数字和月份名称的表，并加入它。

这在您的情况下不起作用，因为您的查询并没有真正返回月份数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:17:53.640

对于 MySQL（我怀疑是您使用该函数的 RDBMS `NOW()`），您可以这样做：

```
SELECT DATE_FORMAT(NOW(),'%M') AS 'Current Month' 
```

# python - 类 lambda 回调 NameError

> ID：10390487
> 
> 赞同：1
> 
> 时间：2012-04-30T20:57:21.290
> 
> 标签：python, class, lambda, callback, nameerror

我究竟做错了什么？我希望'refreshB'按钮调用'update' def，但我得到一个nameError

```
class monitor():
    def update(self):
        print "Called"

    mon = Tk()
    mainFrame = Frame(mon)
    mainFrame.grid(row=1, column=1)

    optionFrame = Frame(mainFrame)
    optionFrame.grid(row=1, column=1)

    refreshB = ttk.Button(optionFrame, text='Refresh', command=lambda: update('self') )
    refreshB.grid(row=1, column=1)

    mon.mainloop()

monitor()

**NameError: global name 'update' is not defined** 
```

我对类不是很熟悉，还有什么我应该添加的吗？

如果上面的脚本不是一个类，那么我会使用：

```
refreshB = ttk.Button(optionFrame, text='Refresh', command=lambda: update ) 
```

哪个可以正常工作...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:07:25.880

将所有初始化代码放在初始化函数中。然后引用`update()`为`self.update()`。

```
 class Monitor(object):
        def update(self, event):
            print "Called"

        def __init__(self):
            self.mon = Tk()
            self.mainFrame = Frame(self.mon)
            self.mainFrame.grid(row=1, column=1)

            self.optionFrame = Frame(self.mainFrame)
            self.optionFrame.grid(row=1, column=1)

            self.refreshB = ttk.Button(self.optionFrame, text='Refresh', command=self.update)
            self.refreshB.grid(row=1, column=1)

        def run(self):
            self.mon.mainloop()

    monitor = Monitor()
    monitor.run() 
```

引用在`update()`这里不起作用，因为它是实例方法而不是类方法。不是因为使用了 lambda——尽管我不知道你为什么需要使用 lambda 函数。我的解决方案涉及您创建一个`Monitor`. 这很有用，因为它允许您控制其中的代码何时`Monitor`执行。（否则，您的类主体中的代码将在定义时执行。所有调用`monitor()`只是返回该类的一个实例`monitor`——它不执行代码主体）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:09:58.740

您不应该在类中直接拥有具有副作用的代码。您几乎肯定希望所有代码都在`__init__`函数中，在`monitor`创建对象后调用它：

```
def __init__(self):
    mon = Tk()
    etc... 
```

接下来，`update`是一个实例方法，因此必须在对象上调用它。你可能想要这个：

```
refreshB = ttk.Button(optionFrame, text='Refresh', command=lambda: self.update('self') ) 
```

但是，由于您的`update`方法不接受隐式参数之外的任何`self`参数，您实际上可能想要这个：

```
refreshB = ttk.Button(optionFrame, text='Refresh', command=lambda: self.update() ) 
```

最后，`lambda`是无用的间接。为什么不直接将方法作为回调提供，而不是将其包装在 a 中`lambda`？

```
refreshB = ttk.Button(optionFrame, text='Refresh', command=self.update ) 
```

# java - Ant 找不到主类错误

> ID：10390488
> 
> 赞同：0
> 
> 时间：2012-04-30T20:57:22.107
> 
> 标签：java, ant, build, noclassdeffounderror, build-script

这是我第一次使用 Ant，`java.lang.NoClassDefFoundError`当它尝试运行时出现异常。这是我的 Ant 构建脚本，

```
<project name="LearnKirtan" basedir="." default="main">

    <property name="src.dir" value="src" />
    <property name="lib.dir" value="lib" />

    <property name="build.dir" value="build" />
    <property name="classes.dir" value="${build.dir}/classes" />
    <property name="jar.dir" value="${build.dir}/jar" />

    <path id="classpath">
        <fileset dir="${lib.dir}" includes="**/*.jar" />
    </path>

    <property name="main-class" value="gsingh.learnkirtan.Main" />

    <target name="clean">
        <delete dir="${build.dir}" />
    </target>

    <target name="compile">
        <mkdir dir="${classes.dir}" />
        <javac srcdir="${src.dir}" destdir="${classes.dir}" includeantruntime="false" classpathref="classpath" />
    </target>

    <target name="jar" depends="compile">
        <mkdir dir="${jar.dir}" />
        <jar destfile="${jar.dir}/${ant.project.name}.jar" basedir="${classes.dir}">
            <manifest>
                <attribute name="Main-Class" value="${main-class}" />
            </manifest>
        </jar>
    </target>

    <target name="run" depends="jar">
        <java classname="${main-class}" fork="true" />
        <classpath>
            <path refid="classpath" />
            <path location="${jar.dir}/${ant.project.name}.jar" />
        </classpath>
    </target>

    <target name="clean-build" depends="clean,jar" />

    <target name="main" depends="clean,run" />

</project> 
```

构建没有错误。运行目标给出了异常。我检查了 jar 文件中生成的清单，它看起来像这样，

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.8.2
Created-By: 1.6.0_30-b12 (Sun Microsystems Inc.)
Main-Class: gsingh.learnkirtan.Main 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T21:02:28.357

您的运行目标看起来有点不稳定，它`<java classname="${main-class}" fork="true" />`是自动关闭的，因此该`classpath`元素从未使用过

```
<target name="run" depends="jar">
    <java classname="${main-class}" fork="true" >
        <classpath>
            <path refid="classpath" />
            <path location="${jar.dir}/${ant.project.name}.jar" />
        </classpath>
    </java>
</target> 
```

可以为你工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:04:07.833

问题是您没有`java`正确指定任务的类路径。

试试这个：

```
<java classname="${main-class}" fork="true">
    <classpath>
        <path refid="classpath" />
        <path location="${jar.dir}/${ant.project.name}.jar" />
    </classpath>
</java> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T06:50:25.830

我有可能的问题。我的脚本如下：

```
<java classname="SchedulerManager" fork="true">
          <jvmarg value="-Ddb.username=${db.user}"/>
          <jvmarg value="-Ddb.password=${db.password}"/>
          <jvmarg value="-Ddb.url=${db.url}"/>

          <classpath>
             <pathelement location="${tomcat.home}/webapps/${project.war}-admin/WEB-INF/lib/${jar_name}"/>
             <pathelement path="com.${company}.${project}.scheduler.SchedulerManager"/>
          </classpath>
      </java> 
```

当我运行时，我收到以下错误：

```
 [java] Exception in thread "main" java.lang.NoClassDefFoundError: com/<company>/<project>/scheduler/SchedulerManager
 [java] Caused by: java.lang.ClassNotFoundException: com.<company>.<project>.scheduler.SchedulerManager
 [java]     at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
 [java]     at java.security.AccessController.doPrivileged(Native Method)
 [java]     at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
 [java]     at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
 [java]     at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
 [java]     at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
 [java] Could not find the main class: com.<company>.<project>.scheduler.SchedulerManager.  Program will exit.
 [java] Java Result: 1 
```

但如果我 CD 到文件夹“ `${tomcat.home}/webapps/${project.war}-admin/WEB-INF/lib/`”并运行：

```
java -cp "*" -Ddb.username=${db.user} -Ddb.password=${db.password} -Ddb.url=${db.url} com.<company>.<project>.scheduler.SchedulerManager (of course I gave real parameters) 
```

有效！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T13:31:48.683

终于找到了决定！我们用以下方式重写了脚本：

```
 <path id="master-classpath">
    <fileset dir="${tomcat.home}/webapps/${project.war}-admin/WEB-INF/lib">
       <include name="*.jar"/>
    </fileset>

    <fileset dir="${workspace.path}/artifacts">
       <include name="${jar_name}"/>
    </fileset>

    <fileset dir="${workspace.path}/deploy_scripts/libs/app">
       <include name="${jdbc_jar_name}"/>
    </fileset>
  </path>
  <java classname="com.${company}.${project}.scheduler.SchedulerManager" fork="true">
      <jvmarg value="-Ddb.username=${db.user}"/>
      <jvmarg value="-Ddb.password=${db.password}"/>
      <jvmarg value="-Ddb.url=${db.url}"/>

      <classpath refid="master-classpath"/>
  </java> 
```

# 2d - fftw c2c：转换后的真实数据中缺少对称性

> ID：10390490
> 
> 赞同：3
> 
> 时间：2012-04-30T20:57:26.160
> 
> 标签：2d, fft, fftw

最近我遇到了一些关于使用 fftw 及其 c2c 转换的问题（参见：[3d c2c fft with fftw library](https://stackoverflow.com/questions/10374656/3d-c2c-fft-with-fftw-library)）。当我发现我在使用 fftw 库时遇到的问题时，我创建了一个新问题，以便以更具体的方式讨论这种情况。由于我正在使用真实数据进行复杂到复杂的转换，因此傅立叶空间中的转换数据应该是对称的： F[n] = con(F[Nn])

现在我对小块测试数据进行了一些转换，以检查转换后的数据是否具有这种对称性。对于一维变换，每件事都按预期工作，但对于更高维度，我得到了真正意想不到的结果。

我正在使用`fftwf_plan_dft_2d`将 8x8 灰度图像转换为傅立叶空间，复杂结果由下式给出：

```
n 
0 real 7971 imag 0 
1 real -437.279 imag -802.151 
2 real -289 imag -566 
3 real -182.721 imag 15.8486 
4 real 31 imag 0 
5 real -182.721 imag -15.8486 
6 real -289 imag 566 
7 real -437.279 imag 802.151 
8 real -1499.79 imag -315.233 
9 real 182.693 imag -74.5563 
10 real 55.9239 imag -12.8234 
11 real -84.7868 imag -9.10052 
12 real -14.4264 imag 211.208 
13 real 289.698 imag 214.723 
14 real 452.659 imag -246.279 
15 real 1136.35 imag -763.85 
16 real 409 imag -134 
17 real -141.865 imag 42.6396 
18 real -33 imag 122 
19 real 129.075 imag -49.7868 
20 real 1 imag -150 
21 real 109.865 imag -84.6396 
22 real 95 imag -142 
23 real -841.075 imag -92.2132 
24 real -108.207 imag -89.2325 
25 real -127.213 imag 28.8995 
26 real -36.6589 imag -8.27922 
27 real -74.6934 imag 43.4437 
28 real 70.4264 imag 29.2082 
29 real -88.3545 imag -81.8499 
30 real -127.924 imag -190.823 
31 real 230.302 imag 8.7229 
32 real -53 imag 0 
33 real -73.1127 imag -22.8578 
34 real -85 imag -82 
35 real -10.8873 imag 51.1421 
36 real -65 imag 0 
37 real -10.8873 imag -51.1421 
38 real -85 imag 82 
39 real -73.1127 imag 22.8578 
40 real -108.207 imag 89.2325 
41 real 230.302 imag -8.7229 
42 real -127.924 imag 190.823 
43 real -88.3545 imag 81.8499 
44 real 70.4264 imag -29.2082 
45 real -74.6934 imag -43.4437 
46 real -36.6589 imag 8.27922 
47 real -127.213 imag -28.8995 
48 real 409 imag 134 
49 real -841.075 imag 92.2132 
50 real 95 imag 142 
51 real 109.865 imag 84.6396 
52 real 1 imag 150 
53 real 129.075 imag 49.7868 
54 real -33 imag -122 
55 real -141.865 imag -42.6396 
56 real -1499.79 imag 315.233 
57 real 1136.35 imag 763.85 
58 real 452.659 imag 246.279 
59 real 289.698 imag -214.723 
60 real -14.4264 imag -211.208 
61 real -84.7868 imag 9.10052 
62 real 55.9239 imag 12.8234 
63 real 182.693 imag 74.5563 
```

很抱歉这么长的数据列表，但它显示了我的问题。

例如对于`F[3]=-182.721 + 15.8486i`我的预期`F[64-3] = F[61] = -182.721 - 15.8486i`，但正如你所看到的那样`-84.7868 + 9.10052i`。相反， 的共轭`F[3]`位于索引 5 处。其他对也是如此。

如果有系统我找不到它。

这是完整的代码：

```
QImage image("/Users/wolle/Desktop/wolf.png");
int w = image.width();
int h = image.height();
int size  = w * h;

cl_float *rawImage = imageToRaw(image); // converts a QImage into an rgb array [0..255]

fftwf_complex *complexImage = (fftwf_complex*) fftwf_malloc(sizeof(fftwf_complex) * size);
fftwf_complex *freqBuffer = (fftwf_complex*) fftwf_malloc(sizeof(fftwf_complex) * size);

// real data to complex data
for (int i = 0; i < size; i++)
{
    complexImage[i][0] = (float)rawImage[i];
    complexImage[i][1] = 0.0f;
}

fftwf_plan forward = fftwf_plan_dft_2d(w, h, complexImage, freqBuffer, FFTW_FORWARD, FFTW_ESTIMATE);

fftwf_execute(forward);

for (int y = 0; y < h; y++)
{
    for (int x = 0; x < w; x++)
    {
        int gid = y * w + x;
        qDebug() << gid  << "real" << freqBuffer[gid][0] << "imag" << freqBuffer[gid][1];
    }
} 
```

我会很感激一些帮助。:-D

问候

狼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:10:58.753

对于二维傅里叶变换，当 x 为实数时，FFT(x) 仍然是共轭对称的。但这是在两个维度上。所以索引 16*x+y 处的 (x,y) 元素应该是索引 16*(16-x mod 16)+(16-y mod 16) 处的 (16-x,16-y) 元素的共轭，当 y 不为 0 时为 272-16*xy mod 256。

但是我认为尽管您说的是 16x16，但实际上是指 8x8。所以 8*x+y 处的 (x,y) 与 8*(8-x mod 8) + (8-y mod 8) 处的 (8-x,8-y) 共轭。

特别是，例如，当 x=0 时，共轭元素是 y 和 8-y - 包括例如 3 和 5，如您所见。

（当 x=0 或 y=0 时，上面的“8-y mod 8”表示 0。）

# php - Mysqli 在多个字段中搜索值

> ID：10390494
> 
> 赞同：1
> 
> 时间：2012-04-30T20:57:48.023
> 
> 标签：php, mysql

我试图弄清楚如何搜索可能在 Field1、Field2 或 Field3 中的 Value1。我知道我的语法是错误的，因为它显然不起作用，但这是我的破解：

```
$query = "SELECT *
   FROM table1
  WHERE city = '$city'
    AND state = '$state'
    AND location = '$location'
    AND (field1 = '$field1U' OR field1 = '$field2U' OR field1 = '$field3U')
  ORDER BY date_created LIMIT 5";
$data = mysqli_query($dbc, $query); 
```

我想也许我可以使用 where field1 in (1,2,3) 但我无法让它工作。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T12:20:25.337

代替

```
AND (field1 = '$field1U' OR field1 = '$field2U' OR field1 = '$field3U') 
```

和

```
AND (field1 = '$search' OR field2 = '$search' OR field3 = '$search') 
```

（请注意，我正在搜索 field1、field2 或 field3）但是请，请，请（！！）转义那些 $search 字符串！例如：

```
$search = mysqli_real_escape_string($link, $search) 
```

$link 是在哪里设置的

```
$link = mysqli_connect(...) 
```

请参考[http://php.net/manual/de/mysqli.real-escape-string.php](http://php.net/manual/de/mysqli.real-escape-string.php) 这是用来防止 SQL 注入的（https://en.wikipedia.org/wiki/SQL_injection）

哦，尝试将文本与变量分开，我个人认为这是更安全、更好的编码风格。对于您的用例：

```
AND (field1 = '" . $search . "' OR field2 = '" . $search . "' OR field3 = '" . $search . "') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:01:28.317

如果要查找所有记录，其中：

`field1 = someValue`

或者`field2 = someValue`

或者`field3 = someValue`

那么你可以使用这个：

```
 $query = "SELECT * FROM table1 WHERE city = '$city' AND state = '$state' AND    location = '$location' AND (field1 = '$Value1' OR field2 = '$Value1' OR field3 = '$Value1') ORDER BY date_created LIMIT 5";
    $data = mysqli_query($dbc, $query); 
```

# vhdl - 无法推断寄存器，因为它的行为与 Quartus II 中任何支持的模型都不匹配

> ID：10390497
> 
> 赞同：0
> 
> 时间：2012-04-30T20:58:11.023
> 
> 标签：vhdl, quartus

编码：

```
 library IEEE;
        use IEEE.std_logic_1164.all;
        use ieee.numeric_std.all;
        use ieee.std_logic_unsigned.all;
        entity decoder10 is 
        port( in_data:  in STD_LOGIC_VECTOR (7 downto 0);
                clk : in STD_LOGIC;
                out_data:  out STD_LOGIC_VECTOR (7 downto 0));
        end decoder10;

        architecture behavioral of decoder10 is
        signal int_bus1 : STD_LOGIC_VECTOR (63 downto 0);
        signal int_bus2 : STD_LOGIC_VECTOR (63 downto 0);
        signal int_bus3 : STD_LOGIC_VECTOR (31 downto 0);
        signal lower : STD_LOGIC_VECTOR (31 downto 0);
        signal higher : STD_LOGIC_VECTOR (31 downto 0);
        signal intermid : STD_LOGIC_VECTOR (31 downto 0);
        signal curr_key : STD_LOGIC_VECTOR (31 downto 0);
        signal got_data: std_logic;      --data written in    
        signal variable_test: std_logic:= '0';      
        signal n_ready: std_logic; --code assembled
        signal k_ready: std_logic; --key selected
        signal k_added: std_logic; --key added
        signal sub_ready: std_logic; --blocks substituted
        signal sh_ready: std_logic; --shift done
        signal xor_ready: std_logic; --xor done
        signal out_ready: std_logic; --ready for output
        signal sent_data: std_logic; --data written out  
        signal start_again: std_logic; --start the main step again
        type arr is array (0 to 15) of std_logic_vector(31 downto 0);
        type key is array (0 to 7) of std_logic_vector(31 downto 0);
        type key_num is array (0 to 31) of integer;
        signal key_it : key_num := (0,1,2,3,4,5,6,7,
                                             7,6,5,4,3,2,1,0,
                                             7,6,5,4,3,2,1,0,
                                             7,6,5,4,3,2,1,0);

        signal tab : arr := (X"00000001",
                                    X"00000002",
                                    X"00000003",
                                    X"00000004",
                                    X"00000005",
                                    X"00000006",
                                    X"00000007",
                                    X"00000008",
                                    X"00000009",
                                    X"0000000a",
                                    X"0000000b",
                                    X"0000000c",
                                    X"0000000d",
                                    X"0000000e",
                                    X"0000000f",
                                    X"00000000");  

        signal tab_key : key := (X"00000007",
                                         X"00000006",
                                         X"00000005",
                                         X"00000004",
                                         X"00000003",
                                         X"00000002",
                                         X"00000001",
                                         X"00000000");

        component adder is 
        port(   dataa       : IN STD_LOGIC_VECTOR (31 DOWNTO 0);
                datab       : IN STD_LOGIC_VECTOR (31 DOWNTO 0);
                result      : OUT STD_LOGIC_VECTOR (31 DOWNTO 0));
        END component;

        begin

        add1: adder
            port map (lower, curr_key, int_bus3);

        process (clk, in_data)
        variable i: INTEGER := 0;
        variable j: INTEGER := 0;
        variable k: INTEGER := 0;

        begin
          -- assembling input code into one piece
          if (rising_edge(clk)) then
              if (i<8) then
                 int_bus1(63 downto 56)<=in_data;
                got_data <= '1';
                n_ready <= '0';
                 if (got_data = '1') then 
                     --shift right 8 bits 
                     int_bus1(55 downto 0) <= int_bus1(63 downto 8);
                     i := i + 1;
                     got_data <= '0';
                 end if;
              end if;

                 if (i = 8 and n_ready = '0' and out_ready = '0') then
                     lower<=int_bus1(31 downto 0);
                     higher<=int_bus1(63 downto 32);
                     n_ready <= '1';
                     start_again <= '1';
                 end if;
          end if; 

          if (n_ready ='1') then
          -- base encryption step
             if (rising_edge(clk)) then
             if (j <32 and start_again = '1') then
             -- key/step dependence
                 curr_key <= tab_key(key_it(j));
                k_ready <= '1';
                start_again <= '0';
             end if;   

             if (k_ready = '1') then 
                    lower <= curr_key + lower;
                    k_added <= '1';
                    k_ready <='0';
             end if;

             if (k_added = '1') then
                    --block substitution
                    lower(3 downto 0) <= tab(CONV_INTEGER(lower(3 downto 0)))(3 downto 0);
                    lower(7 downto 4) <= tab(CONV_INTEGER(lower(7 downto 4)))(7 downto 4);
                    lower(11 downto 8) <= tab(CONV_INTEGER(lower(11 downto 8)))(11 downto 8);
                    lower(15 downto 12) <= tab(CONV_INTEGER(lower(15 downto 12)))(15 downto 12);
                    lower(19 downto 16) <= tab(CONV_INTEGER(lower(19 downto 16)))(19 downto 16);
                    lower(23 downto 20) <= tab(CONV_INTEGER(lower(23 downto 20)))(23 downto 20);
                    lower(27 downto 24) <= tab(CONV_INTEGER(lower(27 downto 24)))(27 downto 24);
                    lower(31 downto 28) <= tab(CONV_INTEGER(lower(31 downto 28)))(31 downto 28);
                    sub_ready <= '1';
                    k_added <= '0';
             end if;    

             if (sub_ready = '1') then
                  --shift 11 bits right cyclically
                    lower(31 downto 21) <= lower(10 downto 0);
                    lower(20 downto 0) <= lower(31 downto 11);
                    sh_ready<= '1';
                    sub_ready <= '0';
             end if;

             if (sh_ready = '1') then
                    higher <= lower xor higher;
                    lower <= higher;
                    sh_ready<= '0';
                    j:=j+1;
                    start_again <= '1';
                    out_ready <= '0'; 
              end if;
              end if; 
             end if;     

         if (rising_edge(clk)) then
              if (j = 32 and out_ready = '0') then
                j:=j+1;
                variable_test <= '1'; --artifact of testing the behavior of variables
              end if;   

         end if;
          -- assembling output code into one piece
          if (rising_edge(clk)) then  
            if (out_ready = '0' and variable_test = '1') then
                 int_bus2 (63 downto 32) <= higher;
                 int_bus2 (31 downto 0) <= lower;
                 out_ready <= '1';
                 n_ready <= '0';
            end if;

             if (out_ready = '1' and k<8) then
                 out_data<=int_bus2(7 downto 0);
                 sent_data <= '1';
                 if (sent_data ='1') then 
                    --shift right 8 bits 
                     int_bus2(55 downto 0) <= int_bus2(63 downto 8);
                     k := k + 1;
                     sent_data <= '0';
                 end if;
            end if;
         end if;
        end process; 
        end behavioral; 
```

我收到以下错误：

> 错误 (10821)：decoder10.vhd(106) 处的 HDL 错误：无法推断寄存器，`start_again`因为它的行为与任何受支持的寄存器模型都不匹配
> 信息 (10041)：推断解码器`start_again`10.vhd(75) 处的锁存器
> 错误 (10821) ：decoder10.vhd(106) 处的 HDL 错误：无法推断寄存器，`higher[0]`因为它的行为与任何支持的寄存器模型都不匹配
> 信息 (10041)：推断出解码器`higher[0]`10.vhd(75) 的锁存器（
> 前 18 位继续“更高”的）

为什么不能合成？为什么不能只`higher`推断出前 18 位？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T06:15:02.307

这很可能是因为您的时钟启用比您的时钟具有更高的优先级，并且不存在允许这样做的 FPGA 硬件。每当您为综合编写代码时，您都需要考虑这是否真的可以映射到底层硬件。所以而不是

```
if (n_ready ='1') then
  -- base encryption step
  if (rising_edge(clk)) then
    (...) 
```

尝试：

```
if(rising_edge(clk)) then
  if(n_ready = '1') then
    (...) 
```

看看[Get your priority right](http://www.xilinx.com/support/documentation/white_papers/wp275.pdf) - 它是为 Xilinx FPGA 编写的，但我猜类似的东西也适用于其他品牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T08:03:41.103

第一个答案，通过 sonicwave 在所有架构中都不是严格正确的，尽管我认为在这种情况下是正确的。
if 后跟边沿可以通过门控时钟实现，但这并不是一个好主意，或者它在所有类型的 FPGA 或 CPLD 架构中都受支持。

一些提示：将 tab 和 tab_key 更改为常量。它们从未被分配，因此不需要信号。使它们成为信号可能意味着它们在某些架构中被统一化。

整个事情应该使用流程，而不是使用顺序逻辑。这会导致“推断锁存器”错误，这取决于代码 start_again 的路径可能会也可能不会被写入。为避免推断锁存器，请确保通过所有路径写入信号或在进程内计时。

您需要记住，VHDL 不是一种编程语言，它是一种描述语言。除非系统是同步的，否则所有行都会同时执行。例如，在第 147 行，您有两条线同时操作更高和更低。

如果您告诉我您要达到的目标，我可以为您重新编写它。

# c# - Crystal Report Viewer 需要很长时间才能运行

> ID：10390499
> 
> 赞同：1
> 
> 时间：2012-04-30T20:58:18.727
> 
> 标签：c#, asp.net, crystal-reports, reportviewer

所以我继承了一个使用水晶报表来显示我们的报表的网络应用程序。我发现在网络应用程序上运行报告的性能太长了（在某些情况下超过 2-3 分钟。）

我已经分解了应用程序的所有组件，以找到数据瓶颈所在，结果证明它是水晶报表查看器。在数据库中运行存储过程只需要 1-2 秒，在我们的 Web 服务中获取我们的数据结果最多需要 4-5 秒。但是当我使用水晶运行报告时，它需要几分钟。

我想知道的是水晶报告查看器中是否出现某种错误，或者是否有人对如何加快使用水晶报告查看器加载报告的时间有任何想法？

我已经广泛地寻找这个问题的答案，其中包括对[.net 框架](http://social.msdn.microsoft.com/forums/en-US/vscrystalreports/thread/f70cad38-dea9-4c4b-a812-9b2f2a7b4c08/)进行更改但我希望对水晶报告本身有一些了解，以了解为什么会发生这种情况。

任何建议的帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T10:58:22.403

第一次调用报表时，Crystal 报表需要很长时间来加载其 DLL。SAP 建议在第一个应用程序执行时使用线程或后台工作程序加载一个虚拟报告，以便在调用生产报告时准备好 DLL。希望能帮助到你。

# php - 大文件下载后PHP脚本未完成

> ID：10390500
> 
> 赞同：0
> 
> 时间：2012-04-30T20:58:35.623
> 
> 标签：php

我正在为一个网站开发一个 PHP 页面，该页面将压缩文件并允许用户下载它。zip 的文件大小可以从几 MB 到 100 MB 不等。我的 PHP 脚本在临时目录中创建 zip 文件，然后将文件内容写入浏览器。完成后，脚本会更新 MySQL 数据库中的下载计数器并从 temp 目录中删除 zip 文件。

这一切都很好，直到我遇到一个需要超过 30 秒的大型 zip 下载。 `max_execution_time`在 php.ini 文件中设置为 30 所以这是有道理的，但是如果我尝试使用`set_time_limit(0)`或更改`max_execution_time`相同的结果。zip 文件从浏览器中成功下载，其中包含所有正确的文件，但脚本似乎随后停止，因为数据库未更新并且服务器上的临时 zip 文件未删除。

这是一个带有 Apache 和 PHP 5.2 的 Linux 环境。

该网站托管在 GoDaddy 上，因此我不确定他们是否对更改脚本可以执行的时间限制有限制，但基本上我想让这个特定的脚本无限期地运行，直到它完成。

关于为什么我无法设置时间限制或任何解决方法的任何想法？

这是我的代码：

```
<?php

// Don't stop the script if the user 
// closes the browser
ignore_user_abort(true);
set_time_limit(0);

// Generate random name for ZIP file
$zip_file = "";
$characters = "0123456789abcdefghijklmnopqrstuvwxyz";

do
{
    $zip_file = "tmp/";

    for ($p = 0; $p < 10; $p++)
        $zip_file .= $characters[mt_rand(0, strlen($characters))];

    $zip_file .= ".zip";
} while (file_exists($zip_file));

// Prepare ZIP file
$zip = new ZipArchive();

/* Open and add files to ZIP (this part works fine)
.
.
.
*/

// Close and save ZIP
$zip->close();

// Check browser connection
if (connection_status() == 0)
{
    // Send ZIP
    header("Content-Type: application/zip");
    header("Content-Length: " . filesize($zip_file));
    header("Content-Disposition: attachment; filename=Download.zip");
    header("Cache-Control: no-store, no-cache, must-revalidate");
    header("Cache-Control: post-check=0, pre-check=0", false);
    header("Pragma: no-cache");
    header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");
    header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");

    // Save and then delete file
    //readfile($zip_file);
    if ($file = fopen($zip_file, "r"))
    {
        // Set buffer size
        $buffer_size = 1024 * 8;

        // While we're still transmitting
        // send over bytes!
        while(!feof($file) && (connection_status() == 0))
        {
            print(fread($file, $buffer_size));
            flush();
            usleep(10000); //<!-- Download speed cap
        }

        // Close file descriptor
        fclose($file);  
    }
}

/* Update database download counter if connection_status() == 0
.
.
.
*/

// Delete the file
unlink($zip_file);

?> 
```

**更新：**我刚刚尝试从本地 Web 服务器进行另一次下载，并将`usleep`命令提高到 10000 以减慢下载时间。总下载时间用了 1 分钟多一点，数据库已更新，文件已从 /tmp 中删除。我的本地环境在 Windows 7 机器上运行带有 Apache 和 PHP 5.3 的 EasyPHP。似乎这可能与 GoDaddy 有关。

此外，在 GoDaddy 和本地站点上，我在脚本调用`max_execution_time`之前和之后打印出来`set_time_limit`，结果分别为 30 和 0，所以我不确定 GoDaddy 方面发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:11:07.443

1.  也许你的 HTTP 服务器配置有问题？你在用什么，配置是什么？
2.  另一种变体，当下载结束时，连接状态可能不等于0。因此，根本不会评估您在数据库更新条件下的代码。
3.  php.ini 中是否配置了任何错误日志记录？如果是，您是否查看了 php.error.log，可能存在一些内存泄漏和“内存不足”错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:54:29.783

您应该能够在 php5.ini 中设置 max_execution_time 并使用 PHP 信息页面进行检查。你能提供你的 php5.ini 的部分和你从 PHPinfo 页面的输出吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:02:26.077

仍然不确定为什么我上面使用的代码在托管站点上不起作用，但我找到了一种解决方法。如果我`register_shutdown_function`在实时站点上使用 PHP 调用，则数据库会正确更新并删除文件。

这是关机功能代码：

```
<?php

$filesize = 0;
$total_bytes_read = 0;
$download_query = "";
$zip_file = "tmp/download.zip";

register_shutdown_function("shutdown");

/* Other code for creating ZIP file and reading it out to the browser
.
.
.
*/

function shutdown()
{
    global $filesize;
    global $total_bytes_read;
    global $zip_file;
    global $download_query;

    // Update the database if file was fully downloaded
    if ($filesize != 0 && $filesize == $total_bytes_read)
    {
        /* Do database update with $download_query
        .
        .
        .
        */
    }

    // Delete the file
    unlink($zip_file);
}

?> 
```

# stored-procedures - Microsoft Enterprise Library 5.0 数据访问 - 是否可以执行“示例查询”功能？

> ID：10390502
> 
> 赞同：0
> 
> 时间：2012-04-30T20:58:51.597
> 
> 标签：stored-procedures, enterprise-library, data-access

我正在评估在工作中使用 Data Access Application Block 5.0，因为在可预见的未来我们将与存储过程结婚。我喜欢其中包含的简单性和 Mapper，但让我感到厌烦的是似乎没有一种方法可以指定参数数组，甚至没有更好的某种“通过示例查询”对象，到存储过程调用，它将根据您的条件自动创建参数。想象一个搜索客户功能，您可以在其中指定一个或多个需要搜索的属性（假设我们已经创建了一个带有可为空字段的存储过程）。

我想做的是这样的：

```
var customerQuery = new { FirstName = "John", LastName = "Doe" }
var result = db.ExecuteSprocAccessor("SearchCustomers", customerQuery); 
```

并将匿名对象变成各种`SqlParameter`对象。

这样的事情可能吗？我在 MSDN 上看到的示例似乎只是显示手动指定单个参数，不知道哪个参数是哪个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T06:06:40.570

企业库数据访问应用程序块支持各种映射器：输出映射器、结果集映射器和[参数](http://msdn.microsoft.com/en-us/library/ff664530%28v=pandp.50%29.aspx)映射器。参数映射器是您在这种情况下感兴趣的。如果您使用的是 SqlDatabase 或 OracleDatabase，则支持默认参数映射机制。默认映射很简单，并且基于参数的位置，但如果需要，您可以创建自己的映射器。

考虑一个带有 2 个 int 参数的存储过程，那么代码片段将如下所示：

```
var logs = db.ExecuteSprocAccessor<Log>("usp_getLogs", 
               new object[] { 1, -1 } // parameters as array
           ).ToList(); 
```

您可以构建一些辅助方法来创建适当的对象数组。

# php - 如何在 Eclipse 中验证 INI 文件格式

> ID：10390510
> 
> 赞同：4
> 
> 时间：2012-04-30T20:59:44.550
> 
> 标签：php, eclipse, validation, syntax, ini

我想用 Eclipse 验证 INI 文件的格式（语法检查）。我更喜欢使用 PHP 脚本的 DLTK 验证器（只需检查 @parse_ini_file 的返回值）。

如何在 Eclipse 中进行设置？

当我尝试设置脚本时，它会忽略我的 INI 文件，只检查 *.php 文件的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T07:18:43.210

在菜单窗口/首选项、常规/内容类型、测试/配置文件中，在“文件关联：”框中

检查：`*.ini (locked)`是否存在？如果不加进去。

然后为 PHP INI 文件[添加 DLTK 验证器。](http://wiki.eclipse.org/DLTK_Validators_User_Guide#How_to_edit_validators)

# python - 使用 Memcache 缓存 Matplotlib（Wont Pickle）

> ID：10390521
> 
> 赞同：4
> 
> 时间：2012-04-30T21:00:27.223
> 
> 标签：python, memcached, matplotlib, pickle

我有一个渲染的图表需要 3 秒，然后可以从所述图表制作子图表，其中添加了一些东西。我想缓存主图表中的轴，以便稍后在渲染子图表时检索并修改它。我怎样才能克服这个错误？

下面是一个示例测试代码：

```
import pylibmc
cache = pylibmc.Client(["127.0.0.1"], binary=True, behaviors={"tcp_nodelay": True, "ketama": True})
import matplotlib.pyplot as plt

cache_name = 'test'
fig = plt.figure(figsize=(20, 7))
ax = fig.add_axes([0, 0.15, 0.98, 0.85])
cache.set(cache_name, ax, 300) 
```

这给出了以下错误：

```
cPickle.PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed 
```

无论如何我可以让它工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T21:34:29.310

那里有关于 matplotlib 图形能够被序列化的愿望的讨论。我还没有看到任何报告这已被解决甚至被接受为目标。因此，如果您尝试通过网络将它们发送到 memcached，它显然会失败。我在搜索时发现的讨论表明，matplotlib 的当前设计不能轻易满足这个目标，它需要对内部进行重构。参考： http: [//old.nabble.com/matplotlib-figure-serialization-td28016714.html](http://old.nabble.com/matplotlib-figure-serialization-td28016714.html)

为了显着减少执行时间，您可以做的是将数据重新组织到数据集中，并且只调用`ax.bar()`一次。然后可以将数据集序列化并以您想要的任何格式存储（例如，存储到 memcached 中）。

这是一个代码示例，显示了您的方法之间的测试，以及将它们组合成数据集的方法。如果需要，您可以更轻松地在此处查看：[https ://gist.github.com/2597804](https://gist.github.com/2597804)

```
import matplotlib.pyplot as plt
from random import randint 
from time import time 

DATA = [
    (i, randint(5,30), randint(5,30), randint(30,35), randint(1,5)) \
    for i in xrange(1, 401)
]

def mapValues(group):
    ind, open_, close, high, low = group
    if open_ > close: # if open is higher then close
        height = open_ - close # heigth is drawn at bottom+height
        bottom = close
        yerr = (open_ - low, high - open_)
        color = 'r' # plot as a white barr
    else:
        height = close - open_ # heigth is drawn at bottom+height
        bottom = open_
        yerr = (close - low, high - close)
        color = 'g' # plot as a black bar

    return (ind, height, bottom, yerr, color)

#
# Test 1
#
def test1():
    fig = plt.figure()
    ax = fig.add_subplot(111)

    data = map(mapValues, DATA)

    start = time()

    for group in data: 

        ind, height, bottom, yerr, color = group

        ax.bar(left=ind, height=height, bottom=bottom, yerr=zip(yerr), 
                color=color, ecolor='k', zorder=10,
                error_kw={'barsabove': False, 'zorder': 0, 'capsize': 0}, 
                alpha=1)

    return time()-start

#
# Test 2
#
def test2():
    fig = plt.figure()
    ax = fig.add_subplot(111)

    # plotData can be serialized
    plotData = zip(*map(mapValues, DATA))

    ind, height, bottom, yerr, color = plotData

    start = time()

    ax.bar(left=ind, height=height, bottom=bottom, yerr=zip(*yerr), 
            color=color, ecolor='k', zorder=10,
            error_kw={'barsabove': False, 'zorder': 0, 'capsize': 0}, 
            alpha=1)

    return time()-start

def doTest(fn):
    end = fn()
    print "%s - Sec: %0.3f, ms: %0d" % (fn.__name__, end, end*1000)

if __name__ == "__main__":
    doTest(test1)
    doTest(test2)

    # plt.show() 
```

结果：

```
python plot.py 
test1 - Sec: 1.592, ms: 1592
test2 - Sec: 0.358, ms: 357 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:41:42.777

从 matplotlib 1.2 开始，您应该能够腌制和取消腌制数字。

这是一个非常“实验性”的功能，但是如果您确实发现任何问题，请在 mpl 邮件列表中告知我们或在 github.com/matplotlib/matplotlib 上提出问题

高温高压

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-04T05:32:55.987

查看[文档](http://matplotlib.sourceforge.net/api/figure_api.html#matplotlib.figure.Figure.add_axes)，它似乎`fig.add_axes()`需要一个元组作为参数，您正在传递一个列表。因此，它没有返回`Axes`对象（因为它没有被创建），所以 ax 被分配了函数本身。

# opencv - cvBlobsLib 的特征向量和特征值

> ID：10390523
> 
> 赞同：0
> 
> 时间：2012-01-26T21:32:39.813
> 
> 标签：opencv, computer-vision

我使用[cvBlobsLib](http://opencv.willowgarage.com/wiki/cvBlobsLib)进行斑点检测。目前我需要大小特征值和相应的特征向量。我在库文档中可以找到的所有内容都是`CBlobGetMajorAxisLength`和`CBlobGetMinorAxisLength`. 如果我是对的：首先给我大特征值，第二个 - 小特征值。但现在我还需要在图书馆找不到的特征向量。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-01-27T14:51:41.827

看起来有一种方法可以获取 blob 的方向角。翻阅文档（[这里](http://opencv.willowgarage.com/wiki/cvBlobsLib?action=AttachFile&do=view&target=cvblobslib_OpenCV_v8_3.zip)下载，不是英文的，但可以看懂）我发现：

> CBlobGetOrientation 类参考
> 
> 公共成员函数

```
double  operator() (const CBlob &blob) const 
```

> Aplica l'operació al blob。

```
const char *    GetNom () const 
```

> Obté el nom de l'operador。

所以，如果你有轴的大小和它的方向，你应该能够推导出其他的一切。唯一的技巧是，我不确定这个角度是指什么。

# c# - 通过反射实例化编译已知类型的类型化 IEnumerable

> ID：10390525
> 
> 赞同：1
> 
> 时间：2012-04-30T21:00:48.530
> 
> 标签：c#, generics, reflection

仅使用 .net 3.5 我有示例类：

```
public class Table1
{
   public IEnumerable<Table2> Items { get; set; }
} 
```

它是一种 ORM，我需要通过惰性计算类型实现集合

我试图找到将实例分配给属性 **Items**的方法，例如通过`List<Table2>`

当我通过 Activator 创建实例时，它返回对象，我无法将其转换为所需的类型

```
var t = typeof(List<>);
var gt = t.MakeGenericType(typeof(Table2));
object instance = Activator.CreateInstance(gt);

var table1 = new Table1();
table1.Items = instance; //canot use cast here 
```

将“对象”变量分配给类型化的 IEnumerable 是个问题

它在大多数 OR-mapers 中是如何工作的？

我可以使用 Reflection.Emit 来生成具体类型吗？
我可以使用Castle/Linfu吗？

编辑：

我不能使用任何直接演员，因为它需要参考表**2**，我不能硬编码

解决方案：

一段时间后，我自己找到了解决方案。它需要对集合实例使用反射：

```
var table1 = new Table1();
var table1Type = typeof(Table1);
var prop = table1Type.GetProperty("Items");
prop.SetValue(table1, instance, null); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:12:01.027

我认为您只是缺少一个简单的演员表：

代替：

```
table1.Items = instance; 
```

做了：

```
table1.Items = instance as IEnumerable<Table2>; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:16:12.957

如果你知道你想要一个 List 为什么你不能使用`new List<Table2>()`？通常，您仅`Activator.CreateInstance`在直到运行时才知道类型时才使用，通常使用基于字符串的配置值。

但是，您需要做的只是明确地`instance`转换为`IEnumerable<Table2>`or `List<Table2>`，任何一个都应该工作：

```
table1.Items = (IEnumerable<Table2>) instance; 
```

# python - 无法将标准输出、标准错误重定向到 Celery 中的另一个记录器

> ID：10390537
> 
> 赞同：1
> 
> 时间：2012-04-30T21:01:41.403
> 
> 标签：python, celery

无法将标准输出重定向到 Celery 中的另一个记录器，我使用特殊的处理程序为 Celery 创建了特殊的记录器对象。我想捕获执行任务时发生的所有异常。我在 celery 中添加 setup_logging 信号的处理程序，以安装我自己的记录器：

```
import sys
import logging.config

from pika.adapters import BlockingConnection
from pika.connection import ConnectionParameters
from pika import BasicProperties

from celery.signals import setup_logging, after_setup_logger

class RabbitMqHandler(logging.Handler):
    '''
    Special logging handler which stores log messages in RabbitMq server
    It can used for async delivering message to clients
    '''

    HOST = 'localhost'
    QUEUE = 'hermes.standard'

    def emit(self, record):
        con = BlockingConnection(ConnectionParameters(self.HOST))
        # Open the channel
        channel = con.channel()

        # Declare the queue
        channel.queue_declare(queue=self.QUEUE, durable=True,
                              exclusive=False, auto_delete=False)

        channel.basic_publish(exchange='', routing_key=self.QUEUE, body=self.format(record)) #','.join(dir(record)))
        con.close()

LOGGING = {
    'version': 1,
    'disable_existing_loggers': True,
    'formatters': {
        'verbose': {
            'format': '%(levelname)s %(asctime)s %(module)s %(process)d %(thread)d %(message)s'
        },
        'simple': {
            'format': '%(levelname)s %(message)s'
        },
        'timed': {
            'format': '[%(asctime)s: %(levelname)s] %(message)s'
        },
    },
    'handlers': {
        'null': {
            'level':'DEBUG',
            'class':'django.utils.log.NullHandler',
        },
        'console':{
            'level':'DEBUG',
            'class':'logging.StreamHandler',
            'formatter': 'timed'
        },
        'rabbit': {
            'level': 'INFO',
            'class': 'logconfig.RabbitMqHandler',
            'formatter': 'timed'
        },
        'celery': {
            'level': 'ERROR',
            'class': 'logging.FileHandler',
            'filename': '1.log',
            'formatter': 'timed',
            }
    },
    'loggers': {
        'celery': {
            'handlers': ['celery'],
            'level': 'INFO',
        },
        'hermes': {
            'handlers': ['console', 'rabbit'],
            'level': 'INFO',
        }
    }
}

from celery.log import LoggingProxy

@setup_logging.connect
def setup_logconfig(**kwargs):
    logging.config.dictConfig(LOGGING)
    #return logging.getLogger('hermes') 
```

我自己的名为“hermes”的记录器工作正常，但所有异常都发生了捕获标准芹菜的记录器名称=芹菜。我试图用设置覆盖：

CELERY_REDIRECT_STDOUTS =假

但它也不起作用。所有例外都适用于标准 celery 记录器。

# cors - XDomainRequest - 获取错误响应正文

> ID：10390539
> 
> 赞同：3
> 
> 时间：2012-04-30T21:02:20.720
> 
> 标签：cors, xdomainrequest

我在使用 XDomainRequest`onerror`处理程序时遇到问题。发生错误时，我似乎无法获取 HTTP 响应的正文（通过`xdr.responseText`）。成功的请求（200 OK）工作正常。

这是请求：

```
POST http://localhost/path HTTP/1.1
Accept: */*
Origin: http://localhost
Accept-Language: cs-CZ
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Host: localhost
Content-Length: 34
Connection: Keep-Alive
Pragma: no-cache

[Data] 
```

这是回应：

```
HTTP/1.1 400 Bad Request
Content-Length: 54
Content-Type: application/json; charset=utf-8
Server: Microsoft-IIS/7.5
Access-Control-Allow-Origin: *
Date: Mon, 30 Apr 2012 20:57:32 GMT

[Data] 
```

是否可以获得响应体？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T22:41:19.237

不幸的是，不可能让响应正文出错。您只知道发生了错误。请在此处查看我的相关问题：[是否可以捕获 CORS 错误？](https://stackoverflow.com/questions/4844643/is-it-possible-to-trap-cors-errors)

一种可能的解决方法（如果您可以控制服务器）是始终返回 HTTP 200，但在响应正文中包含错误代码。

# r - 快速测试 xy 坐标是否在给定的矩形内并避免循环？

> ID：10390546
> 
> 赞同：1
> 
> 时间：2012-04-30T21:03:15.820
> 
> 标签：r

我需要确定位于给定矩形内的一组 xy 坐标的分数。该矩形定义为边距坐标系边缘给定距离的区域（在这种情况下，坐标系的边界大致为 (-50, -20), (-50, 20), (50, 20 ), (50, -20)。另外，我希望能够在距边缘不同距离的矩形上测试结果。我的方法如下：

```
 # set initial limits to the coordinate system
  lim.xleft = -50
  lim.xright = 50
  lim.ybottom = -20
  lim.ytop = 20

frac.near.edge <- function(coord.pairs, tolerance){
  # set the coordinates of the rectangle of interest
  exclude.xleft = lim.xleft + tolerance
  exclude.xright = lim.xright - tolerance
  exclude.ybottom = lim.ybottom + tolerance
  exclude.ytop = lim.ytop - tolerance
  out <- vector()
  # loop through the pairs testing whether the point is inside the rectangle or outside
  for(i in 1:nrow(coord.pairs)){
    if(coord.pairs[i, 1] > exclude.xleft & coord.pairs[i, 1] < exclude.xright &  coord.pairs[i, 2] > exclude.ybottom & coord.pairs[i, 2] < exclude.ytop){
      out[i] <- "in"
    } else {
      out[i] <- "out"
    }
  }
  # return how many points were inside the rectangle and how many were outside
  return(table(out))
}

# try it out on something much bigger!
foo <- data.fram(x = runif(100), y = runif(100))
system.time(frac.near.edge(foo,  tolerance = 5)) 
```

这对于大型数据集来说*非常*慢（我的数据集包含大约 10^5 xy 对）。我怎样才能加快速度？绕过循环的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:17:34.437

这可能更适合 SE 代码审查 ( [https://codereview.stackexchange.com/questions/tagged/r](https://codereview.stackexchange.com/questions/tagged/r) )。我不知道这段编码是否有帮助，但你的问题真的不是关于编程，而是更多的代码改进。我还生成了一个更好的数据集，因为你们都生成了一个响应。

```
foo <- data.frame(x = sample(-100:100, 100, replace=TRUE), 
    y = sample(-100:100, 100, replace=TRUE))

xleft = -50
xright = 50
ybottom = -2
ytop = 20
foo$x >= xleft & foo$x <= xright  & foo$y >= ybottom & foo$y <= ytop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:29:54.347

```
exclude.xleft = lim.xleft + tolerance
exclude.xright = lim.xright - tolerance
exclude.ybottom = lim.ybottom + tolerance
exclude.ytop = lim.ytop - tolerance
out <- c("out", "in")[1+( findInterval(coord.pairs[ , 1], c(exclude.xleft, exclude.xright))==1 &
                       findInterval(coord.pairs[ , 2], c(exclude.ybottom,   exclude.ytop))==1)] 
```

在 50K 的测试用例上，您的方法需要 0.01 秒而不是 19 秒：

```
coord.pairs<- cbind(rnorm(50000, 0,50), rnorm(1000,0,20)); tolerance=10 
```

# ios - 如何在 C4 中生成随机数？[C4框架]

> ID：10390549
> 
> 赞同：3
> 
> 时间：2012-04-30T21:03:29.707
> 
> 标签：ios, c4

如何使用 C4 Alpha Api 生成随机数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:23:11.460

在 C4 中，您可以使用 C4Math 类，它有一个名为 randomInt 的类级方法...

`[C4Math randomInt:255];`会给你一个 0 到 255 之间的随机数。

还有一种`randomIntBetweenA:andB:`方法...

`[C4Math randomIntBetweenA:100 andB:200]`会给你一个介于 100 到 200 之间的 randomInt ......

在引擎盖下，这些方法如下所示：

```
+(NSInteger)randomInt:(NSInteger)value {
    srandomdev();
    return ((NSInteger)random())%value;
}

+(NSInteger)randomIntBetweenA:(NSInteger)a andB:(NSInteger)b{
    NSInteger returnVal;
    if (a == b) {
        returnVal = a;
    }
    else {
        NSInteger max = a > b ? a : b;
        NSInteger min = a < b ? a : b;
        NSAssert(max-min > 0, @"Your expression returned true for max-min <= 0 for some reason");
        srandomdev();
        returnVal = (((NSInteger)random())%(max-min) + min);
    }
    return returnVal;
} 
```

# c# - 让 Create 在 ViewModel 中工作？

> ID：10390551
> 
> 赞同：0
> 
> 时间：2012-04-30T21:03:41.933
> 
> 标签：c#, asp.net-mvc-3, razor

好的，所以我有一个半工作的博客，我试图让评论功能齐全。现在，我的所有帖子都正确显示，并带有所有相应的评论。这样做的一个问题是您实际上无法通过该站点添加评论（我只是手动进行的）。

我以前在我的控制器中创建了“创建”方法，但只能通过自动脚手架。

现在我将一个 ViewModel 传递给页面，如下所示（这会抓取与博文本身相关的主题和评论。

```
public ActionResult Post(int id)
{
    var post = (from p in db.Set<BlogPost>()
                where p.id == id
                select new PostViewModel
                           {
                              Id = p.id,
                              Title = p.Title,
                              DateCreated = p.DateCreated,
                              Content = p.Content,
                              Topics = p.Topics,
                              Comments = p.Comments,
                              CommentCount = p.Comments.Count
                          }).Single();

    return View(post);
} 
```

然后我把它作为我的 Post.cshtml ......

```
<div class="blogpost">
    <h2>@Model.Title</h2>
    <div class="post_info">@Model.DateCreated<span class="right">Blog</span></div>
    <p>@Html.Raw(Model.Content)</p>
    <div class="post_close">
        <span class="left">
            @foreach (var topic in Model.Topics)
            {
                <text>@Html.DisplayFor(modelItem => topic.Name) </text>
            }
        </span>
        <span class="right">
            <img src="../../Content/images/comment.jpg" alt="" />
            @if (Model.CommentCount > 1 || Model.CommentCount == 0)
            { 
                @Model.CommentCount <text>comments</text> }
            else
            {
                @Model.CommentCount <text>comment</text>
            }
        </span>
    </div>
</div>
<div id="comments">
    @foreach (var comment in Model.Comments)
    {
        <b>@Html.DisplayFor(modelItem => comment.Name)</b> <text>says... </text><br />
        <i>@Html.DisplayFor(modelItem => comment.Content)</i><br />
    }
</div> 
```

在“评论” div 中，我想为人们添加一种创建新评论的方式。显然，这不会以传统方式完成，ViewModel 是 Model 而不仅仅是 Comments 模型。关于从哪里开始的任何建议？

我基本上是 MVC3 的新手，与我习惯使用 Web 表单相比，回发的整个想法非常令人困惑。任何帮助都会很有用，谢谢！

（我将使用某人可能需要的任何其他信息来编辑这篇文章）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:24:19.153

我还没有，我强烈建议你开始学习一些 jquery。我自己会创建一个带有提交按钮的 ajax 样式评论框，只有经过身份验证的用户、openid 或自定义成员资格提供程序才能访问该评论框。

您将想要学习如何在 jquery 中使用 $.ajax 和 $.post 方法，以及构建与这些方法一起使用的 json 对象。

```
<input type="textarea" id="commentBox"></input>
<input type="button" onclick="submitComment();" value="SUBMIT" />

function submitComment(){
     var newComment = {
         comment: $("#commentBox").val(),
         blogpostid: $("#PostID").val()
     }

     $.post("/BlogPost/AddComment",newComment,function(data){
           // append text to bottom of comments
           if(data.Error){
               alert(data.ErrorMessage);
           } else {
               $("#comments").append('<div id="commentDiv">' + newComment.comment + '</div'>);
           }
     });
} 
```

您的 BlogPost 控制器

```
public JsonResult AddComment(string comment, int blogpostid)
{
      // snag user info from authenticated session

      // save comment

      // return an object that has a boolean and a string it would look something like this.

      var commentResult = new object{ Error = true, ErrorMessage = 'we could not save the comment'};

      return Json(commentResult);
} 
```

这并没有涵盖所有内容，您还需要在客户端和服务器端编写更多代码，包括安全措施。

# ruby-on-rails - 设计 LDAP 和空白用户对象属性的 NoMethodError

> ID：10390554
> 
> 赞同：0
> 
> 时间：2012-04-30T21:04:00.330
> 
> 标签：ruby-on-rails, devise

我按照这些说明在我的 Rails 应用程序中通过 Devise 设置基本 LDAP 身份验证：http: [//blackfistsecurity.blogspot.dk/2011/12/rails-authentication-using-devise-and.html](http://blackfistsecurity.blogspot.dk/2011/12/rails-authentication-using-devise-and.html)

使用 AD 帐户首次登录会在数据库中创建相应的用户，从 get_ldap_param() 找到的 AD 帐户的对象属性中填充姓氏、名字、显示名和电子邮件

该过程运行良好，除非 AD 用户具有空白属性，例如空白姓氏（AD 属性“sn”）——这会导致以下错误：

```
NoMethodError in Devise::SessionsController#create
undefined method `sn' for #<Net::LDAP::Entry:0x00000004920758> 
```

用户模型如下：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable
  devise :ldap_authenticatable, :registerable, :recoverable, :rememberable, :trackable, :validatable

  attr_accessible :username, :email, :password, :password_confirmation, :remember_me, :firstname, :lastname, :displayname

  before_save :get_ldap_lastname, :get_ldap_firstname, :get_ldap_displayname, :get_ldap_email

  def get_ldap_lastname
      Rails::logger.info("### Getting the users last name")
      tempname = Devise::LdapAdapter.get_ldap_param(self.username,"sn")
      puts "\tLDAP returned lastname of " + tempname
      self.lastname = tempname
  end

  def get_ldap_firstname
      Rails::logger.info("### Getting the users first name")
      tempname = Devise::LdapAdapter.get_ldap_param(self.username,"givenname")
      puts "\tLDAP returned firstname of " + tempname
      self.firstname = tempname
  end

  def get_ldap_displayname
      Rails::logger.info("### Getting the users display name")
      tempname = Devise::LdapAdapter.get_ldap_param(self.username,"displayname")
      self.displayname = tempname
  end

  def get_ldap_email
      Rails::logger.info("### Getting the users email address")
      tempmail = Devise::LdapAdapter.get_ldap_param(self.username,"mail")
      self.email = tempmail
  end
end 
```

错误来自此调用：

```
Devise::LdapAdapter.get_ldap_param(self.username,"sn") 
```

当 get_ldap_param 遇到空白属性时，我希望它返回空白而不是未定义。

我尝试使用以下代码解决该问题，但它不起作用，因为错误发生在调用 get_ldap_param 时。

```
if tempname.none?
  tempname = ""
end 
```

我是否需要修改 Devise gem 才能做到这一点，还是可以在通话后以某种方式完成？

请原谅我的新手

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:27:44.253

这看起来像是[devise_ldap_authenticatable](https://github.com/cschiewek/devise_ldap_authenticatable)设计模块中的一个错误。它使用[LDAP 条目属性值的方法访问器而不是哈希运算符](https://github.com/cschiewek/devise_ldap_authenticatable/blob/master/lib/devise_ldap_authenticatable/ldap_adapter.rb#L102)：

```
 def ldap_param_value(param)
    filter = Net::LDAP::Filter.eq(@attribute.to_s, @login.to_s)
    ldap_entry = nil
    @ldap.search(:filter => filter) {|entry| ldap_entry = entry}

    if ldap_entry
      if ldap_entry[param]
        DeviseLdapAuthenticatable::Logger.send("Requested param #{param} has value #{ldap_entry.send(param)}")
        value = ldap_entry.send(param)
        value = value.first if value.is_a?(Array) and value.count == 1
        value 
```

根据 ruby​​-net-ldap 的文档，应该使用哈希访问器来检索如下值：

```
 def ldap_param_value(param)
    filter = Net::LDAP::Filter.eq(@attribute.to_s, @login.to_s)
    ldap_entry = nil
    @ldap.search(:filter => filter) {|entry| ldap_entry = entry}

    if ldap_entry
      if value = ldap_entry[param]
        DeviseLdapAuthenticatable::Logger.send("Requested param #{param} has value #{value}")
        value = value.first if value.is_a?(Array) and value.count == 1
        value 
```

这是一个错误，您可以使用此信息更新您使用 devise_ldap_authenticable[提交的问题。](https://github.com/cschiewek/devise_ldap_authenticatable/issues/82)

# c# - 内部类的公共成员是什么意思？

> ID：10390560
> 
> 赞同：7
> 
> 时间：2012-04-30T21:05:13.500
> 
> 标签：c#, class, internal

例如：

```
internal class C
{
    public void M()
    {
        Console.WriteLine("foo");
    }
} 
```

对我来说，这就是“**一种任何人都可以访问的方法，无论程序集是否存在于只能从同一程序集中的代码中访问的类中**”。

我对编译器的经验告诉我，如果我做了类似的事情并且没有收到警告，那么可能有一个正当的理由来拥有它。

所以，我想要么

1.  我对保护级别的理解有些欠缺。
2.  可能会有警告，但没有警告。

（如果是 2，这不是试图抱怨它 - 我只是想了解）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-30T21:52:08.043

> 对我来说，这就是“一种任何人都可以访问的方法，无论程序集是否存在于只能从同一程序集中的代码中访问的类中”。

对我来说，这意味着“C 的可访问域仅限于此程序集；M*的可访问域是其容器 C 的可访问域的不受限制的子集*”。

"public" means that to me because *that's what the specification says it means*. I encourage you to read the portion of the specification which covers accessibility domains if you have questions or concerns about this.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-30T21:07:34.417

该`internal`关键字将限制`M()`对仅在`C`驻留程序集中进行的调用的访问。

`public`只是意味着任何人都可以访问该成员。`public`不知道也不关心在类层次结构中对它施加的限制，也不应该这样做。

换句话说，这是“设计使然”。当你添加`public`一个方法时，编译器假设你已经知道，如果你对类本身施加更多的限制，那么你必须知道你在做什么。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-30T21:08:30.513

有关其功能的详细答案，请参阅此[SO Question](https://stackoverflow.com/questions/711361/public-vs-internal-methods-on-an-internal-class)。

根据我的经验，我喜欢将内部成员标记为公开，以期将来我想将课程的范围更改为公开。这样我就可以做到这一点，并且所有以前标记的内部方法都是自动公开的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-30T21:10:42.030

类的范围是内部的，因此虽然拥有公共属性似乎没有意义，但只有那些也在名称空间中的类才能看到类以查看属性。如果在某个时候您决定公开该课程，那将是一个庞大的 PIA 来检查每个成员并更改其范围。

# android - 访问最顶层对话框

> ID：10390566
> 
> 赞同：1
> 
> 时间：2012-04-30T21:05:59.220
> 
> 标签：android, unit-testing

有没有办法访问最顶层的 AlertDialog/ProgressDialog？

我正在为 android 应用程序编写单元测试，我想测试是否基于特定条件显示带有指定消息的 AlertDialog。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T15:48:43.507

我相信这样做的正确方法是引入为您显示对话框的可模拟类（也许已经存在一个？我正在关注单元测试标签）。然后对于您的单元测试，您提供一个拦截消息并执行检查的类。

# ios - ios将项目转换为arc

> ID：10390569
> 
> 赞同：1
> 
> 时间：2012-04-30T21:06:07.333
> 
> 标签：ios, cocoa, automatic-ref-counting

让我们假设我有一个看起来像这样的方法。

```
-(void)doSmth {
    NSString *one = [[NSString alloc] initWithFormat:@"%@",someNumber];

    NSString *two = [[NSString alloc] initWithFormat:@"%@",someOtherNumer];

    [one release];
} 
```

项目是在没有 ARC 的情况下创建的。我想将其转换为 ARC。

我的问题是：转arc后会有泄漏吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:35:46.070

不会。ARC 转换器将删除对 的显式调用`release`，并且编译器将在编译时自动插入对两者的释放`one`调用`two`。

最终结果：这里没有泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:08:39.287

您必须`[one release];`像在 ARC 中那样删除，这会产生错误。

关于您的问题，在切换到 ARC（并删除发布声明）后，它不会泄漏。

编辑：编写这样的代码可能会更好：

```
NSString *one = [[NSString alloc] initWithFormat@"one"]; 
```

或像这样：

```
NSString *one = @"one"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-07T09:00:35.420

[![在此处输入图像描述](../Images/1e798acdfc23e76585c12af2bbc7921f.png)](https://i.stack.imgur.com/gXeUr.png)

如果我们需要将完整的项目转换为 ARC，那么 Edit ->convert -> to Objective-C ARC

或者如果你需要转换一个特定的文件，那么 projectNav ->build Phases ->compile source in that specific .m file add -fno-objc-arc

[![在此处输入图像描述](../Images/443fd8a73c37cabd3b5cb33c94fdf689.png)](https://i.stack.imgur.com/uB8Te.png)

# ruby-on-rails - :dependent => :delete_all 不工作

> ID：10390570
> 
> 赞同：0
> 
> 时间：2012-04-30T21:06:07.667
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有 2 个具有 1 对多关联的模型，我试图让 Rails 级联删除工作。

我对rails很陌生，我已经尝试了所有我能做的事情，但我仍然无法让它工作......

这是我的 2 个模型

```
class CmsHomeSlide < ActiveRecord::Base
    attr_accessible :slide_order, :start_datetime, :end_datetime, :slide_type, :header, :headline, :cta_text, :cta_link, :active
    has_many :cms_home_slide_detail, :dependent => :delete_all
    validates_presence_of :slide_type, :slide_order
end

class CmsHomeSlideDetail < ActiveRecord::Base
    attr_accessible :start_datetime, :end_datetime, :position, :image_url, :link, :cms_home_slide, :active
    belongs_to :cms_home_slide
end 
```

以及我正在使用的测试脚本（作为跑步者，但开发环境和测试环境以同样的方式失败）

```
CmsHomeSlide.delete_all
CmsHomeSlideDetail.delete_all

slide = Factory(:home_slide)
det1 = Factory(:home_slide_detail, :cms_home_slide => slide, :position => 1)
det2 = Factory(:home_slide_detail, :cms_home_slide => slide, :position => 2)

puts "Slides length #{CmsHomeSlide.all.length}"
puts "Details length #{CmsHomeSlideDetail.all.length}"

slide.delete

puts "Slides length #{CmsHomeSlide.all.length}"
puts "Details length #{CmsHomeSlideDetail.all.length}" 
```

输出是

```
Slides length 1
Details length 2
Slides length 0
Details length 2 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:11:17.273

您需要使用`:dependent => :delete`或`:dependent => :destroy`

从指南：

> 如果将 :dependent 选项设置为 :destroy，则删除此对象将调用关联对象的 destroy 方法以删除该对象。如果将 :dependent 选项设置为 :delete，则删除此对象将删除关联的对象，而无需调用其 destroy 方法。

[http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

# android - Custom ContentProvider for complex sql database with multiple tables

> ID：10390572
> 
> 赞同：2
> 
> 时间：2012-04-30T21:06:22.963
> 
> 标签：android, android-contentprovider

I am trying to create a library that includes functionality in an already written app. The old app uses a complex sqlite database. I am trying to reuse the old database as the backend for a content provider and can't figure out what would be "best practice" for what I am trying to do and how to adapt the various examples ([this](http://mobile.tutsplus.com/tutorials/android/android-sdk_content-providers/), [this](https://github.com/vladimirvivien/workbench/tree/master/android-tutorials/ContentProviderSample/src/demo/contentprovider), and others) I have found to my situation.

Supoose you have this database structure

```
+------+-------------+-------------+-------------+
| Root |   Folder    |    Item     |  Subitem   |
+------+-------------+-------------+-------------+
| _id  | _id         | _id         | _id         |
| uuid | parent_uuid | parent_uuid | parent_uuid |
|      | uuid        | uuid        | uuid        |
|      | name        | name        | name        |
|      | data        | data        | data        |
+------+-------------+-------------+-------------+
Root->Folder->Item->Subitem 
```

Before, I used a DbAdapter class where I provided function calls that took parameters such as parent_uuid, handled all the sql query stuff inside the function, then returned a cursor with the results

example function stubs:

*   get_items_by_parent_uuid(folder_uuid)
*   get_item_by_uuid(uuid)
*   same for Subitem also

Complex queries

*   get_items_for_root(root_uuid)
    *   returns cursor with item uuid, item name, item data, folder name
*   get_items_with_subitem_count(folder_uuid)
    *   returns cursor with item uuid, item name, item data, count of subitems where subitem.parent_uuid == item.uuid

I can't figure out the best way to provide the functionality above with 1 `ContentProvider`. I don't need someone to write me tons of code (but if you do I'm ok with that too), I just want someone to help me understand how to modify the above linked examples to do these things, because I do mostly understand the examples, just not enough to translate them to my current needs.

**TL;DR;** - How do I write a single `ContentProvider` that handles multiple tables, doesn't depend on _id as the unique identifier, and handles joins along with selects that may have inner-selects/queries (such as `select count(*)`)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T23:20:52.117

> How do I write a single ContentProvider that handles multiple tables

Step #1: Design a REST interface for your schema, limiting yourself to a simple JSON object as the data structure (i.e., no nested arrays or objects, just a map of keys to simple values)

Step #2: Convert that design to a `ContentProvider`, replacing the `http://sooperapp.jp36.com/` with `content://com.jp36.sooperapp` and replacing the JSON with `Cursors` and `ContentValues`

So, for example, you might support `content://com.jp36.sooperapp/folder` and `content://com.jp36.sooperapp/item` and `content://com.jp36.sooperapp/subitem` as the basis of retrieving/modifying information about one or more of each of those types.

> doesn't depend on _id as the unique identifier

If you plan on using `CursorAdapter`, and assuming that by `uuid` you really do mean a UUID (which is typically a string), then you have no choice but to also have `_id`. If, however, you do not plan on using `CursorAdapter`, you have no particular need for `_id`.

> and handles joins along with selects that may have inner-selects/queries (such as select count(*))

That's all a matter of your REST interface/`ContentProvider` design. If you want to have `content://com.jp36.sooperapp/folder/count` be something you query upon that, behind the scenes, does `SELECT COUNT(*) FROM Folder`, knock yourself out.

(note: do not literally knock yourself out)

If you want `content://com.jp36.sooperapp/omg/omg/omg/this/is/a/long/path` to `INSERT` an `Item` and 17 `Subitems` based upon some `insert()` call to the provider, go right ahead. `ContentProvider` is merely a facade; it is up to you to define what the `Uri` means, what the `ContentValues` mean, what the `query()` parameters mean, etc.

Personally, I would recommend that you step back and ask yourself why you are bothering with a `ContentProvider`.

# android - 限制 ContentResolver.query() 函数中的行数

> ID：10390577
> 
> 赞同：42
> 
> 时间：2012-04-30T21:06:44.587
> 
> 标签：android, database, contacts

有没有办法限制游标返回的行数？我的手机有大约 4000 个联系人，我只需要其中的一些。

这是我正在使用的代码

```
 db = new dBHelper(this);
        ContentResolver cr = getContentResolver();
        Cursor cursor;

        cursor = cr.query(ContactsContract.Contacts.CONTENT_URI,null, null, null, ContactName + " ASC");
        Log.i(TAG, CLASSNAME + " got contacts entries");
        for (int it = 0; it <100 ; it++){//cursor.getCount()
            Log.i(TAG, CLASSNAME + " getting string");
            String mytimes_contacted = cursor.getString(cursor.getColumnIndex(dBHelper.times_contacted)); 
            Log.i(TAG, CLASSNAME + " done from the string");
        } 
```

我得到的日志是

```
I/Check(11506): [ContactsPicker] got contacts entries
I/Check(11506): [ContactsPicker] getting first string
D/AndroidRuntime(11506): Shutting down VM
W/dalvikvm(11506): threadid=1: thread exiting with uncaught exception (group=0x2aac8578)
D/dalvikvm(11541): GC_CONCURRENT freed 923K, 46% free 4000K/7303K, external 1685K/2133K, paused 1ms+8ms
E/AndroidRuntime(11506): FATAL EXCEPTION: main
E/AndroidRuntime(11506): java.lang.RuntimeException: Unable to start activity ComponentInfo{~~my package name~~}: android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 3537 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-04-30T21:20:09.337

要限制光标中的结果数量，请尝试：

```
cursor = cr.query(ContactsContract.Contacts.CONTENT_URI,null, null, null, ContactName + " LIMIT 100");
while(cursor.moveToNext()) {
    // something clever
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2020-07-14T09:20:13.790

接受的答案对于 android 11 不再有效。在 android 11 中添加了一个约束，不允许在排序值中使用 LIMIT。您需要将查询与捆绑参数一起使用。例如：

```
 val bundle = Bundle().apply {
            putInt(ContentResolver.QUERY_ARG_LIMIT, 100)
        }
        resolver.query(
                ContactsContract.Contacts.CONTENT_URI,
                projection,
                bundle,
                null
        ) 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2020-08-23T19:29:19.010

从 Android 11 开始，上述解决方案将不起作用，您可以尝试使用此解决方案来获取数据。

```
 /**
 * Call to fetch all media on device, it but be called synchronously since function is called on a background thread
 */
private fun fetchGalleryImages(
    context: Context,
    offset: Int,
    limit: Int
): List<MediaItem> {
    val galleryImageUrls = mutableListOf<MediaItem>()
    try {
        if (EasyPermissions.hasPermissions(
                context,
                Manifest.permission.WRITE_EXTERNAL_STORAGE
            )
        ) {
            // Define the columns that will be fetched
            val projection = arrayOf(
                MediaStore.Files.FileColumns._ID,
                MediaStore.Files.FileColumns.DATA,
                MediaStore.Files.FileColumns.DATE_ADDED,
                MediaStore.Files.FileColumns.MEDIA_TYPE,
                MediaStore.Files.FileColumns.MIME_TYPE,
                MediaStore.Files.FileColumns.TITLE,
                MediaStore.Video.Media.DURATION
            )
            val selection =
                "${MediaStore.Files.FileColumns.MEDIA_TYPE} = ? OR ${MediaStore.Files.FileColumns.MEDIA_TYPE} = ?"
            val selectionArgs = arrayOf(
                MediaStore.Files.FileColumns.MEDIA_TYPE_IMAGE.toString(),
                MediaStore.Files.FileColumns.MEDIA_TYPE_VIDEO.toString()
            )
            /**
             * Change the way to fetch Media Store
             */
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
                // Get All data in Cursor by sorting in DESC order
                context.contentResolver.query(
                    contentUri(),
                    projection,
                    Bundle().apply {
                        // Limit & Offset
                        putInt(ContentResolver.QUERY_ARG_LIMIT, limit)
                        putInt(ContentResolver.QUERY_ARG_OFFSET, offset)
                        // Sort function
                        putStringArray(     // <-- This should be an array. I spent a whole day trying to figure out what I was doing wrong
            ContentResolver.QUERY_ARG_SORT_COLUMNS,
            arrayOf(MediaStore.Files.FileColumns.DATE_MODIFIED)
        )

                        putInt(
                            ContentResolver.QUERY_ARG_SORT_DIRECTION,
                            ContentResolver.QUERY_SORT_DIRECTION_DESCENDING
                        )
                        // Selection
                        putString(ContentResolver.QUERY_ARG_SQL_SELECTION, selection)
                        putStringArray(
                            ContentResolver.QUERY_ARG_SQL_SELECTION_ARGS,
                            selectionArgs
                        )
                    }, null
                )
            } else {
                val sortOrder =
                    "${MediaStore.Files.FileColumns.DATE_MODIFIED} DESC LIMIT $limit OFFSET $offset"
                // Get All data in Cursor by sorting in DESC order
                context.contentResolver.query(
                    contentUri(),
                    projection,
                    selection,
                    selectionArgs,
                    sortOrder
                )
            }?.use { cursor ->
                while (cursor.moveToNext()) {
                    galleryImageUrls.add(
                        MediaItem(
                            cursor.getLong(cursor.getColumnIndex(MediaStore.Files.FileColumns._ID)),
                            ContentUris.withAppendedId(
                                contentUri(),
                                cursor.getLong(cursor.getColumnIndex(MediaStore.Files.FileColumns._ID))
                            ),
                            cursor.getString(cursor.getColumnIndex(MediaStore.Files.FileColumns.DATA)),
                            cursor.getStringOrNull(cursor.getColumnIndex(MediaStore.Files.FileColumns.MIME_TYPE)),
                            cursor.getLongOrNull(cursor.getColumnIndex(MediaStore.Video.Media.DURATION))
                        )
                    )
                }
            }
        }
    } catch (ex: Exception) {
        ex.printStackTrace()
    }
    return galleryImageUrls
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-03-17T12:34:00.907

在android 26 查询方法升级。该函数正在使用这些参数。Uri uri, String[] 投影, Bundle queryArgs, CancellationSignal 取消信号

下面的例子我得到了最近的 5 张照片。

```
 val whereArgs = arrayOf("image/jpeg", "image/png", "image/jpg")

    val projection = arrayOf(MediaStore.Images.ImageColumns._ID,
            MediaStore.Images.ImageColumns.DATA,
            MediaStore.Images.ImageColumns.BUCKET_DISPLAY_NAME,
            MediaStore.Images.ImageColumns.DATE_TAKEN,
            MediaStore.Images.ImageColumns.MIME_TYPE)

    val selection =
            "${MediaStore.Files.FileColumns.MIME_TYPE} = ? OR ${MediaStore.Files.FileColumns.MIME_TYPE} = ?  OR ${MediaStore.Files.FileColumns.MIME_TYPE} = ?"

    val queryArgs = Bundle()
    val sortArgs = arrayOf(MediaStore.Images.ImageColumns.DATE_TAKEN)

    queryArgs.putStringArray(ContentResolver.QUERY_ARG_SORT_COLUMNS, sortArgs)
    queryArgs.putInt(ContentResolver.QUERY_ARG_SORT_DIRECTION, ContentResolver.QUERY_SORT_DIRECTION_DESCENDING)
    queryArgs.putInt(ContentResolver.QUERY_ARG_LIMIT, 5)
    queryArgs.putString(ContentResolver.QUERY_ARG_SQL_SELECTION, selection)
    queryArgs.putStringArray(ContentResolver.QUERY_ARG_SQL_SELECTION_ARGS, whereArgs)

    val cursor = context!!.contentResolver.query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
            projection,
            queryArgs,
            null)

    if (cursor!!.moveToFirst()) {
        do {
            val imageLocation = cursor.getString(1)
            val imageFile = File(imageLocation)

            if (imageFile.exists()) {
              //access you file from imageLocation
            }
        } while (cursor.moveToNext())
        fiveRecentlyImagesAdapter!!.notifyDataSetChanged()
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-19T12:03:30.750

如果有人正在寻找上述 Ignacio Tomas Crespo 答案的 Java 版本，

```
 if (Build.VERSION.SDK_INT < Build.VERSION_CODES.R) {

            cursor = context.getContentResolver().query(
                    MediaStore.Images.Media.EXTERNAL_CONTENT_URI
                            .buildUpon()
                            .encodedQuery("limit=" + offSet + "," + "100")
                            .build(),
                    columns,
                    null,
                    null,
                    null);
        } else {
            Bundle bundle = new Bundle();
            bundle.putInt(ContentResolver.QUERY_ARG_LIMIT, 100);

            cursor = context.getContentResolver()
                    .query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                            columns,
                            bundle,
                            null);
        } 
```

# javascript - CouchDB 中的过滤和排序视图？

> ID：10390583
> 
> 赞同：2
> 
> 时间：2012-04-30T21:07:18.867
> 
> 标签：javascript, json, couchdb

我在 CouchDB 中有一些带有`timestamp`字段和`group`字段的项目。我使用此视图函数来获取 group == "foo" 的所有项目的列表：

```
{
  "map" : "function(doc) { emit(doc.group, doc); }"
} 
```

`http://localhost:5984/my_database/_temp_view?key="foo"`

现在我想让输出按`timestamp`字段排序。我怎么做？基本上，我想要这个 SQL 查询的等价物：

`SELECT * FROM SomeTable WHERE group=? ORDER BY timestamp`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:22:34.093

将时间戳作为第二列发出：

```
function(doc) { emit([doc.group,doc.timestamp]); } 
```

然后，使用以下参数进行查询：

```
view?startkey=["foo"]&endkey=["foo",""] 
```

我假设您的时间戳是数字，而不是字符串。阅读[本文](http://wiki.apache.org/couchdb/View_collation)`["foo"]`以了解如何在和之间对数字时间戳进行排序`["foo",""]`。

另外，不要`doc`作为值发出，它会占用大量存储空间。如果您确实需要该文档，`include_docs=true`请在您的查询中使用。

# linux - 强制 GCC 静态链接，例如 pthreads（而不是动态链接）

> ID：10390584
> 
> 赞同：7
> 
> 时间：2012-04-30T21:07:21.067
> 
> 标签：linux, gcc, linker, shared-libraries, static-libraries

我的程序是作为加载器和许多共享库的模块构建的。现在其中一个库使用 pthreads，它似乎动态绑定到模块（在启动时加载）。现在，如果我可以强制 pthread 链接到模块文件中会更简单。Linux上的GCC，我该怎么做？我想 libpthread.a 是必要的....

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-30T21:35:56.343

虽然理论上可以链接`libpthread.a`到共享库，但这是一个*非常糟糕的主意*。原因是`libpthread`是 的一部分`glibc`，并且的*所有*部分`glibc` *必须*完全匹配，否则您会看到奇怪且无法解释的崩溃。

因此，链接`libpthread.a`到您的共享库将：

1.  移动到具有不同版本的计算机时导致程序崩溃`glibc`
2.  当您当前的机器升级时，导致您现有的程序崩溃`glibc`，但您的模块没有重新链接到 updated `libpthread.a`。

不要让自己生气，不要那样做。

# javascript - 是否可以将自定义函数而不是事件绑定到 JQuery 中的 div？

> ID：10390585
> 
> 赞同：0
> 
> 时间：2012-04-30T21:07:24.413
> 
> 标签：javascript, jquery

我想知道这是否可能，我可以用 AS3 做到这一点。是否可以在仅侦听鼠标事件的 div 上绑定侦听器。所以假设我有一个名为“lion”的 div，通常这是绑定鼠标事件的方式：

```
 $("#mouse").bind("click", function(e)
  {
     alert(e.currentTarget.id);
  } 
```

但是正如你所看到的，鼠标事件已经被声明为“点击”。我想做的是编写一个函数，然后将该函数绑定到“狮子”div。并且当狮子遇到这样的鼠标事件时，函数能够捕获鼠标事件类型。这是功能：

```
 $.fn.chkType = function(e)
  {
    var evt = e.type;
    var str = "";

    switch(evt)
    {
      case "mouseover":
      str = "MOUSE OVER";
      break;

      case "mouseout":
      str = "MOUSE OUT";
      break;

      case "click":
      str = "CLICK";
      break;

      default:
      break;
   }

   alert(str);
  } 
```

现在，如果我想将此功能分配给“狮子”，我不确定这怎么可能？我做了很多搜索，最接近的是：

[http://api.jquery.com/bind/](http://api.jquery.com/bind/)

我会很感激你的意见。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:12:45.460

我建议绑定到您要绑定的所有事件。

```
$("#mouse").bind("click mouseover mouseout", function(e) {
    //alert(e.currentTarget.id);
    //alert(e.type);
    console.log(this.id);
    console.log(e.currentTarget.id);
    console.log(e.type);
}); 
```

**更新**
该方法的目的是什么`$.chkType`？为什么不直接提醒类型？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:12:27.020

您可以制作自己的自定义事件，并将它们绑定到元素。您甚至可以将同一个函数绑定到多个事件。（PS 在 jQuery 1.7+ 中，使用`on`代替`bind`）

```
$("#mouse").on("lion click", function(e){
    alert(e.type);
}); 
```

现在`#mouse`有一个`lion`附加到它的事件。很明显，浏览器不能触发这个事件，但是你可以。

```
$("#mouse").trigger('lion');​ 
```

这将触发您的自定义`lion`事件。

演示：http: [//jsfiddle.net/bav4K/2/](http://jsfiddle.net/bav4K/2/)

注意：`$.fn`用于将函数附加到 jQuery 对象。在你的情况下，这没有多大意义（你不会打电话`$('#mouse').chkType()`），我建议`$.chkType`改用。

# c# - 方法的自定义属性声明

> ID：10390586
> 
> 赞同：0
> 
> 时间：2012-04-30T21:07:25.120
> 
> 标签：c#, codedom, pex

我正在使用 CodeDom 生成一个包含一些方法的类。我能够为我的方法声明一个属性，使其看起来与 Pex 在创建参数化单元测试时所做的相似：

```
[PexMethod]
public void myMethod() 
```

但是，我想在其中添加更多内容，例如：

```
[PexMethod (Max Branches = 1000)]
public void myMethod() 
```

但我无法包含`((Max Branches = 1000))`. 你能帮我一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:13:10.860

属性值中不能有空格，它们只是自定义属性类中公共属性的包装。例如：

```
public class TestAttribute : Attribute
{
    public bool Enabled { get; set; }
} 
```

你可以像这样使用它

```
[TestAttribute(Enabled = true)]
void Foo(){} 
```

因此，由于属性映射到一个属性，它必须遵循正常的语法命名规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T21:39:05.400

我不确定您的问题是什么，但您可以简单地将[属性`Value`设置](http://msdn.microsoft.com/en-us/library/system.codedom.codeattributeargument.value.aspx)为[`CodeAttributeArgument`](http://msdn.microsoft.com/en-us/library/system.codedom.codeattributeargument.aspx)：

```
var method =
    new CodeMemberMethod
    {
        Name = "MyMethod",
        CustomAttributes =
        {
            new CodeAttributeDeclaration
            {
                Name = "PexMethod",
                Arguments =
                {
                    new CodeAttributeArgument
                    {
                        Name = "MaxBranches",
                        Value = new CodePrimitiveExpression(1000)
                    }
                }
            }
        }
    }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:16:15.660

MaxBranches属性[位于](http://research.microsoft.com/en-us/um/redmond/projects/pex/wiki/MaxBranches.html)基类 ( [PexSettingsAttributeBase](http://research.microsoft.com/en-us/um/redmond/projects/pex/wiki/PexSettingsAttributeBase.html) ) 上。这可能就是你遇到麻烦的原因。您可能正在反思错误的类型以找到要设置的 PropertyInfo。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-21T13:13:25.253

```
 CodeAttributeArgument codeAttr = new CodeAttributeArgument(new CodePrimitiveExpression("Max Branches = 1000"));
     CodeAttributeDeclaration codeAttrDecl = new CodeAttributeDeclaration("PexMethod",codeAttr);

 mymethod.CustomAttributes.Add(codeAttrDecl); 
```

# math - 随机位到范围内的整数

> ID：10390598
> 
> 赞同：1
> 
> 时间：2012-04-30T21:08:25.870
> 
> 标签：math, random

假设我有一些来自 random.org 的随机数据（这是为了好玩..）

假设我想将随机数据转换为 1-100 范围内的数字。

* * *

伪代码

```
top:
word = get_next_7_bits()
if word is 0 or word > 100 goto top 
```

* * *

虽然这很浪费，但它会提供从随机位到整数范围的准确转换，还是期望正确分布（二进制->十进制转换）是天真的？

这只是为了满足我的好奇心，我不需要实现任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:13:14.443

如果有 50-50 的机会得到 0 或 1，并且这些位是独立生成的，那么是的，这会给你一个均匀的分布。

# java - 使用键绑定移动图像

> ID：10390601
> 
> 赞同：1
> 
> 时间：2012-04-30T21:08:34.263
> 
> 标签：java, swing, key-bindings

我正在尝试创建坦克游戏，但仍在学习如何用 Java 进行图形编程。我最初尝试使用 KeyListeners 移动两个图像之一（哪个取决于哪个播放器）。有人告诉我，键绑定可能是解决此问题的更有效方法。这是我的一些代码：

```
 public class FrameMain extends JFrame{
    ...
        public FrameMain(){

           this.addBindings(); 
```

addBindings() 方法：

```
 protected void addBindings() {
       InputMap inputMap = pnlPlay.getInputMap();       

       KeyStroke key = KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, Event.KEY_PRESS);
       inputMap.put(key, pnlPlay.pnlGame.MoveTank(2, pnlPlay.nPlayer));

       key = KeyStroke.getKeyStroke(KeyEvent.VK_LEFT, Event.KEY_PRESS);   
       inputMap.put(key, pnlPlay.pnlGame.MoveTank(-2, pnlPlay.nPlayer));
} 
```

移动坦克方法：

```
 public int MoveTank(int xChange, int nPlayer){

       System.out.println("move "+nPlayer);

       if(nPlayer==0){
           tank1.x+=xChange;
       }else tank2.x+=xChange;

       repaint();
       return 1;
} 
```

我遇到的问题是，当我按下右箭头键或左箭头键时，我没有得到任何响应。它应该打印“move #”，但事实并非如此。如果有人知道我做错了什么，或者可以指出一些做同样事情的代码的方向，我将不胜感激。我最好从按工作顺序查看代码然后玩弄它来学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:18:50.917

这段代码有两件事：

*   我没有看到有关行动图的任何信息。输入映射将键映射到动作标识符，动作映射是标识符和实际动作之间的链接。所以你通常有类似的代码

    ```
    InputMap inputMap = component.getInputMap( );
    ActionMap actionMap =  component.getActionMap();
    Action actionToTrigger = ...;
    actionMap.put( "myAction", actionToTrigger );
    inputMap.put( key, "myAction" ); 
    ```

*   如果使用正确的标识符将您的操作放入操作映射中，但仍然无法正常工作，则您可能使用了错误的输入映射。Swing 键绑定指南中解释了 3 种不同的输入映射。和其他人一起尝试

也许您应该再次查阅[Swing 键绑定教程](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)，因为它更详细地解释了所有这些 + 包含代码示例

# python - 带有dict（1 = ...）的python SyntaxError，但{1：...}有效

> ID：10390606
> 
> 赞同：11
> 
> 时间：2012-04-30T21:09:13.950
> 
> 标签：python, dictionary, notation

Python 似乎在接受 dicts 的密钥类型方面存在不一致。或者，换一种说法，它允许某些类型的键以一种定义 dicts 的方式，而不是其他方式：

```
>>> d = {1:"one",2:2}
>>> d[1]
'one'
>>> e = dict(1="one",2=2)
  File "<stdin>", line 1
  SyntaxError: keyword can't be an expression 
```

符号是否`{...}`更基本，`dict(...)`只是语法糖？是因为 Python 根本没有办法`parse dict(1="one")`吗？

我很好奇...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-30T21:10:44.540

这不是`dict`问题，而是 Python 语法的产物：关键字参数必须是有效的标识符，并且`1`不是`2`。

当您想使用任何不是遵循 Python 标识符规则的字符串作为键时，请使用`{}`语法。在某些特殊情况下，构造函数关键字参数语法只是为了方便。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-30T21:11:05.433

`dict`是函数调用，函数关键字必须是标识符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-04T16:34:51.507

正如其他答案所述，[dict](https://docs.python.org/2/library/functions.html#func-dict)是一个函数调用。它具有三种句法形式。

表格：

```
dict(**kwargs) -> new dictionary initialized with the name=value pairs
   in the keyword argument list.  For example:  dict(one=1, two=2) 
```

键（或`name`本例中使用的键）必须是有效的 Python[标识符](https://docs.python.org/2/reference/lexical_analysis.html#identifiers)，并且 int 无效。

限制不仅是功能`dict`您可以像这样演示它：

```
>>> def f(**kw): pass
... 
>>> f(one=1)    # this is OK
>>> f(1=one)    # this is not
  File "<stdin>", line 1
SyntaxError: keyword can't be an expression 
```

但是，您可以使用其他两种语法形式。

有：

```
dict(iterable) -> new dictionary initialized as if via:
       d = {}
       for k, v in iterable:
           d[k] = v 
```

例子：

```
>>> dict([(1,'one'),(2,2)])
{1: 'one', 2: 2} 
```

从映射中：

```
dict(mapping) -> new dictionary initialized from a mapping object's
   (key, value) pairs 
```

例子：

```
>>> dict({1:'one',2:2})
{1: 'one', 2: 2} 
```

虽然这可能看起来不多（来自 dict 文字的 dict），但请记住[Counter](https://docs.python.org/2/library/collections.html#collections.Counter)和[defaultdict](https://docs.python.org/2/library/collections.html#collections.defaultdict)是映射，这就是您将其中一个转换为 dict 的方式：

```
>>> from collections import Counter
>>> Counter('aaaaabbbcdeffff')
Counter({'a': 5, 'f': 4, 'b': 3, 'c': 1, 'e': 1, 'd': 1})
>>> dict(Counter('aaaaabbbcdeffff'))
{'a': 5, 'c': 1, 'b': 3, 'e': 1, 'd': 1, 'f': 4} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-04T16:21:32.003

如果您阅读[文档](https://docs.python.org/2/tutorial/datastructures.html#dictionaries)，您将了解到`dict = {stringA = 1, stringB = 2}`当键是简单字符串时该表示法是有效的：

> 当键是简单字符串时，有时使用关键字参数指定对更容易：
> 
> ```
> >>>
> >>> dict(sape=4139, guido=4127, jack=4098)
> {'sape': 4139, 'jack': 4098, 'guido': 4127} 
> ```

由于整数（或其他数字）不是有效的关键字参数，因此`dict = {1 = 2, 3 = 4}`如果您在用数字命名时将参数传递给它，那么任何对函数的调用都会失败：

```
>>> def test(**kwargs):
...     for arg in kwargs:
...         print arg, kwargs[arg]
... 
>>> test(a=2,b=3)
a 2
b 3
>>> test(1=2, 3=4)
  File "<stdin>", line 1
SyntaxError: keyword can't be an expression 
```

# php - PHP用两个字段回显表单，提交焦点不改变只是在键盘上按Enter键？

> ID：10390607
> 
> 赞同：1
> 
> 时间：2012-04-30T21:09:16.503
> 
> 标签：php, forms

我有一个网站，其中有一个由 php 创建的表单：

```
echo "<form width='300px' action='results.php' method='post'>";
 echo "<fieldset>";
 echo "<legend>Find Resources!</legend>";
 echo "<label for='euoff'>Quick List of Services</label><br />";
      echo "<select name='offering' id='euoff'>";
      echo "<option value=''>--Select One--</option>";
        foreach ($values as $eu){
            echo "<option class='$reg' value='$eu[0]'>$eu[1]</option>";
        }
     echo "</select>";
 echo "<input type='submit' class='btn' name='submit' value='GO' />";
 echo "</fieldset>";
  echo "<fieldset>";
 echo "<legend>Quick Resource Search</legend>";
 echo "<label for='soff'>Enter your search term below.</label><br />";
      echo "<input class='align-left' name='soffering' type='text' size='50' maxlength='25' id='soff' />";
 echo "<input type='submit' class='btn' name='ssubmit' value='GO' />";
 echo "</fieldset>";
 echo "</form>";
 echo "</div>"; 
```

当用户从选择列表中选择一个项目时，他们必须用鼠标单击 GO 按钮，不知道为什么......有什么建议吗？此外，如果用户在第二个输入中输入数据 - “soffering” - 他们必须单击 GO，因为键盘上的输入不会触发第二个提交 (ssubmit) 按钮。

任何人都可以回答为什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:14:08.297

我猜你想要的是 ENTER/RETURN 键在 a`<select>`聚焦时提交表单。这是不可能的，因为 ENTER/RETURN 键用于在使用键盘导航时选择一个选项。因为这是默认行为，所以我不建议更改它（使用 JS 或类似的东西），因为会产生可用性噩梦。

如果这不能回答您的问题，请提供更多详细信息；具体来说，您到底想要完成什么

# asp.net-mvc - 将click事件绑定到具有特定类名的div中的所有链接

> ID：10390609
> 
> 赞同：1
> 
> 时间：2012-04-30T21:09:26.473
> 
> 标签：asp.net-mvc, jquery

document.ready 中 jquery 调用的第一部分是伪代码。如何正确执行 $('.mainLink').each().click() 以便 NavigationPanel 中类名称 mainLinks 的所有链接都绑定到单击事件。不使用 id 作为链接是不是很糟糕？

```
$(document).ready(function () {

        $('.mainLink').each().click(function (e) {
                e.preventDefault();                
                $.ajax({
                    url: this.href,
                    beforeSend: OnBegin,
                    complete: OnComplete,
                    success: function (html) {
                        $('#ContentPanel').html(html);
                    }
                });
            });
        });  

<div id="NavigationPanel">  

        @Html.ActionLink("1", "Index", "First", null, new { @class = "mainLink" })
        @Html.ActionLink("2", "Index", "Two", null, new { @class = "mainLink"  })
        @Html.ActionLink("3", "Index", "Three", null, new { @class = "mainLink" })    
    </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:10:29.113

只需做`$('.mainLink').click(function (e) {`应该将所有链接与类绑定`.mainLink`

如果您想要 div ID 中的所有链接，请`NavigationPanel`尝试以下操作，

`$('.mainLink', $('#NavigationPanel')).click(function (e) {`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:11:36.850

如果您只想绑定到`.mainLink`内的所有内容`#NavigationPanel`，则可以使用以下方法：

```
$("#NavigationPanel").on("click", ".mainLink", function(e){
    e.preventDefault();                
    $.ajax({
        url: this.href,
        beforeSend: OnBegin,
        complete: OnComplete,
        success: function (html) {
            $('#ContentPanel').html(html);
        }
    });
}); 
```

# jquery - jQuery 时间戳格式

> ID：10390613
> 
> 赞同：1
> 
> 时间：2012-04-30T21:09:44.257
> 
> 标签：jquery, timestamp

我正在寻找一种在 jquery 中获取时间戳的方法，就像我们在 php by 中那样`time()`（这是自 1970 年 1 月 1 日以来的秒数）。

我试过`event.timeStamp`了，但它输出以 9 开​​头的 9 位数字，我知道这是不正确的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T21:12:29.043

使用 jquery.now() [http://jsbin.com/icesab/edit#javascript,html](http://jsbin.com/icesab/edit#javascript,html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T21:12:00.300

试试这个：

```
Math.floor(+new Date() / 1000) 
```

# cocos2d-iphone - 检查所有动作是否完成 cocos2d

> ID：10390614
> 
> 赞同：0
> 
> 时间：2012-04-30T21:09:54.367
> 
> 标签：cocos2d-iphone

我的问题是：我做了很多代码`ccTouchEnded`，我希望`CCTouchDispacher`停止所有输入，直到屏幕上的所有操作都结束。问题是，当我反复点击屏幕时，`ccTouchEnded`每次都会被调用，这会破坏一切。我试图停止输入，但我不知道将执行哪些操作..所以我不能只运行 a`CCSequence`以及何时完成重新启用输入。

我的代码看起来像这样：

```
if (taped in a rect)..do action, change some things around,do another action, call method 1
if (condition)..do action,check something,(if (check) do action, else call method 2) 
```

值得注意的是，这些方法在不同的层做不同的事情，需要不同的时间。

所以我的问题是：有什么方法可以检查屏幕上的所有操作是否都已完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T08:05:47.370

检查节点/精灵/层上运行的动作数量是否为零：

[http://www.cocos2d-swift.org/docs/api/Classes/CCNode.html#//api/name/numberOfRunningActions](http://www.cocos2d-swift.org/docs/api/Classes/CCNode.html#//api/name/numberOfRunningActions)

如：

`[mySprite numberOfRunningActions]==0`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T03:46:18.220

你有 isDone 函数告诉你一个 CCAction 是否完成。从文档：

> (BOOL) - 如果操作完成，isDone 返回 YES

# c++ - 在 20 行程序中创建 C 线程。为什么它不起作用？

> ID：10390616
> 
> 赞同：9
> 
> 时间：2012-04-30T21:10:05.757
> 
> 标签：c++, multithreading

我正在尝试运行一个短程序，该程序在 for 循环中创建三个线程，每个线程都将“内部”写入屏幕。Cygwin 在不同机器上同时运行 XP 和 Vista 时会发生这种情况。这是当前的代码。

```
#include <iostream>
#include <unistd.h>
#include <pthread.h>
#include <semaphore.h>
using namespace std;
void* printInside(void* arg);

int main()
{
    pthread_t threads[3];
    for(int i = 0; i < 3; i++)
    {
        pthread_create(&threads[i], 0, printInside, 0);
    }
    return 0;
}
void* printInside(void* arg)
{
    cout << "inside";
        return 0;
} 
```

它不起作用。如果我在 for 循环内部添加一个 cout，它似乎会减慢它的工作速度。

```
for(int i = 0; i < 3; i++)
{
    cout << "";
    pthread_create(&threads[i], 0, printInside, 0);
} 
```

关于为什么会这样的任何建议？

编辑：

我收到了在循环后添加连接的回复

```
int main()
 {
     pthread_t threads[3];
     for(int i = 0; i < 3; i++)
    {
        pthread_create(&threads[i], 0, printInside, 0);
    }
     for(int i = 0; i < 3; i++)
    {
        void* result;
        pthread_join(threads[i],&result);
    }
}
 void* printInside(void* arg)
 {
    cout << "inside";
    return 0;
} 
```

但是还是不行，是join做错了吗？

固定的

> > “输出通常由标准库缓冲。它在某些情况下会被刷新，但有时你必须手动完成。所以即使线程运行并产生输出，除非你刷新它，否则你不会看到它。”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T21:11:25.340

您需要加入，否则主线程将退出：

```
for(int i = 0; i < 3; i++)
{
    pthread_create(&threads[i], 0, printInside, 0);
}
/* Join here. */ 
```

> 如果我在 for 循环内部添加一个 cout，它似乎会减慢它的工作速度。

做事`I/O`通常是艰难而缓慢的。这为其他线程提供了足够的 CPU 时间来运行。

请记住，当使用多个线程时，**如果一个调用`exit`它们都死了**。

### 编辑

> 在“内部”的末尾添加一个 endl 确实可以使它更好地工作，但这似乎是一个逃避解决方案。只是想知道为什么即使存在加入也是必要的。

输出通常由标准库缓冲。它在某些情况下会被刷新，但有时您必须手动进行。因此，即使线程运行并产生输出，除非您刷新它，否则您也不会看到它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T21:12:50.027

*   您无需等待即可启动所有线程，并在它们开始执行之前退出主线程（因此整个程序）。

*   在返回之前调用[`pthread_join`](http://sourceware.org/pthreads-win32/manual/pthread_join.html)将等待其他线程完成。

*   `cout`帮助，因为它生成上下文切换和其他线程运行的窗口。

# javascript - DerbyJS 和身份验证

> ID：10390619
> 
> 赞同：14
> 
> 时间：2012-04-30T21:10:17.347
> 
> 标签：javascript, node.js, derbyjs

当前形式的 DerbyJS 是否可以实现身份验证，如果可以，最好的方法是什么？不是他们有什么工作要做吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-16T18:28:24.777

我很高兴与大家分享 Derby 发布了 Racer 级别的 Access Control 的第一个版本。初始详细信息位于[https://github.com/codeparty/racer/blob/master/src/accessControl/README.md](https://github.com/codeparty/racer/blob/master/src/accessControl/README.md)的 Racer 包中。

您通过此 github 问题跟踪其持续进展 - [https://github.com/codeparty/derby/issues/47#issuecomment-6337980](https://github.com/codeparty/derby/issues/47#issuecomment-6337980)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-14T19:58:23.357

使用 derby-auth npm 模块：[https ://github.com/lefnire/derby-auth](https://github.com/lefnire/derby-auth)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-01T06:47:58.397

不，它还没有，尽管开发人员说这是他们正在做的最重要的事情之一。[https://twitter.com/#!/derbyjs/status/194463304440221698](https://twitter.com/#!/derbyjs/status/194463304440221698)

您也许可以将它构建到您的应用程序中，但在这一点上，它似乎并不值得。除非您尽快需要它，否则我会等到开发人员正式发布集成身份验证。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T21:12:57.577

您可以简单地使用反向代理来提供安全性和 https 终止。

我目前正在尝试 NGINX。

限制 Derby 服务器在 localhost 上侦听，并让 NGINX 成为 https 终止符，同时提供基本身份验证 - 或者在 Derby 中建立您自己的基于表单的登录，并将 NGINX 作为 https 终止符/代理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-09T21:57:41.737

您已经可以使用 Derby 和 Racer 的当前功能集实现简单的身份验证。查看聊天示例的来源以获得一些灵感。

还有一个名为 HabitRPG 的开源 Derby 应用程序，它更进一步。开发人员[正在努力](https://github.com/lefnire/habitrpg/issues/3)将 EveryAuth 集成到身份验证过程中。

[此外，预计](https://groups.google.com/d/msg/derbyjs/xVAXsaCNwXA/Lrtkqw97GNAJ)未来几周 Derby 和 Racer 的作者将提供一个官方的 EveryAuth 示例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-28T21:24:25.970

[请参阅https://github.com/codeparty/derby-examples](https://github.com/codeparty/derby-examples)中的“auth”示例

刚刚提交了这个拉取请求 :: [https://github.com/redaktor/derby-examples/commit/0edbbcc7e471e4c2441cfbd4e969007024bfd06e](https://github.com/redaktor/derby-examples/commit/0edbbcc7e471e4c2441cfbd4e969007024bfd06e)

它尚未合并，但如果您也更改了拉取请求中的 2 行，那么一切都应该开箱即用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-16T13:47:29.893

用于登录的最新 derby 模块在这里[github.com/derbyparty/derby-login](http://github.com/derbyparty/derby-login)

# hyperlink - SWF 文件适用于 Mac 浏览器，但不适用于 PC 浏览器

> ID：10390621
> 
> 赞同：0
> 
> 时间：2012-04-30T21:10:25.427
> 
> 标签：hyperlink, flash

好的，这对我来说是一个新文件，我有一个 SWF 文件，其中的链接仅适用于 Mac 浏览器，但不适用于 PC 浏览器：

[http://luc.edu/wwwtest/studyabroad/](http://luc.edu/wwwtest/studyabroad/)

我正在使用 SWF 的绝对路径并检查 FLA 文件，并且链接将转到正确的位置。谁能帮我为什么会这样？我还检查了我的目标代码，它似乎是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:23:29.303

而不是[http://luc.edu/wwwtest/studyabroad/](http://luc.edu/wwwtest/studyabroad/)使用[http://www.luc.edu/wwwtest/studyabroad/](http://www.luc.edu/wwwtest/studyabroad/)

或代替：

`<param name="allowScriptAccess" value="sameDomain">`

做

`<param name="allowScriptAccess" value="Always">`

# python - 解释列出所有排列的 Python 代码

> ID：10390623
> 
> 赞同：1
> 
> 时间：2012-04-30T21:10:39.780
> 
> 标签：python, generator, permutation

```
class Permutation:
    def __init__(self,justalist):
        self._data = justalist[:]
        self._sofar = []
    def __iter__(self):
        return self.next()
    def next(self):
        for elem in self._data:
            if elem not in self._sofar:
                self._sofar.append(elem)
                if len(self._sofar) == len(self._data):
                    yield self._sofar[:]
                else:
                    for v in self.next():
                        yield v
                self._sofar.pop() 
```

在网上找到了这段代码（[http://users.softlab.ntua.gr/~ttsiod/yield.html](http://users.softlab.ntua.gr/~ttsiod/yield.html)）。试图弄清楚，但没有取得太大进展。真正让我绊倒的部分是：

```
 for v in self.next():
                    yield v
                 self._sofar.pop() 
```

通过执行以下操作运行该类的代码：

```
 for i in Permutation(a):
         print(i) 
```

我读过这个：

> “通过调用yield，下一个成员现在是一个生成器函数，所以我们不能只是简单地再次调用next——如果我们这样做了，我们将丢失返回的生成器对象，因此，返回的排列！我们必须改为循环在 self.next() 中使用简单的 for v 返回结果：yield v。这样，结果会正确传播到“父”调用。

我不知道这是否能解释发生了什么，但这对我来说毫无意义。（我以为我了解生成器。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:15:05.270

这个类是一个递归调用自身（`self.next()`）的生成器。

这有点奇怪，因为当您向生成器询问其所有值时，它并没有像您期望的那样通过返回`self`（具有函数的对象）来真正遵循迭代协议。`.next()`相反，它返回 的结果`self.next()`，这是相当糟糕的措辞。该`next`函数应该只是被调用`permutations()`，因为该函数实际上与迭代协议中需要`next`一个函数这一事实没有任何关系。`next`

无论如何，如果您使用递归深度参数扩充函数，您可以看到它的递归跟踪：

```
class Permutation:
    def __init__(self,justalist):
        self._data = justalist[:]
        self._sofar = []
    def __iter__(self):
        return self.next()
    def next(self, depth=0):
        debug = lambda text:print('\t'*depth+' '+text)
        for elem in self._data:
            #print( 'self._data: {}'.format(self._data) )
            #print( 'self._sofar: {}'.format(self._sofar) )
            if elem not in self._sofar:
                self._sofar.append(elem)
                if len(self._sofar) == len(self._data):
                    debug( 'yielding self._sofar[:]: {}'.format(self._sofar[:]) )
                    yield self._sofar[:]
                else:
                    for v in self.next(depth+1):
                        debug( 'yielding elements of self.next() one-by-one: {}'.format(v) )
                        yield v
                self._sofar.pop() 
```

演示：

```
>>> list( Permutation(range(4)) )
                         yielding self._sofar[:]: [0, 1, 2, 3]
                 yielding elements of self.next() one-by-one: [0, 1, 2, 3]
         yielding elements of self.next() one-by-one: [0, 1, 2, 3]
 yielding elements of self.next() one-by-one: [0, 1, 2, 3]
                         yielding self._sofar[:]: [0, 1, 3, 2]
                 yielding elements of self.next() one-by-one: [0, 1, 3, 2]
         yielding elements of self.next() one-by-one: [0, 1, 3, 2]
 yielding elements of self.next() one-by-one: [0, 1, 3, 2]
                         yielding self._sofar[:]: [0, 2, 1, 3]
                 yielding elements of self.next() one-by-one: [0, 2, 1, 3]
         yielding elements of self.next() one-by-one: [0, 2, 1, 3]
 yielding elements of self.next() one-by-one: [0, 2, 1, 3]
                         yielding self._sofar[:]: [0, 2, 3, 1]
                 yielding elements of self.next() one-by-one: [0, 2, 3, 1]
         yielding elements of self.next() one-by-one: [0, 2, 3, 1]
 yielding elements of self.next() one-by-one: [0, 2, 3, 1]
                         yielding self._sofar[:]: [0, 3, 1, 2]
                 yielding elements of self.next() one-by-one: [0, 3, 1, 2]
         yielding elements of self.next() one-by-one: [0, 3, 1, 2]
 yielding elements of self.next() one-by-one: [0, 3, 1, 2]
                         yielding self._sofar[:]: [0, 3, 2, 1]
                 yielding elements of self.next() one-by-one: [0, 3, 2, 1]
         yielding elements of self.next() one-by-one: [0, 3, 2, 1]
 yielding elements of self.next() one-by-one: [0, 3, 2, 1]
                         yielding self._sofar[:]: [1, 0, 2, 3]
                 yielding elements of self.next() one-by-one: [1, 0, 2, 3]
         yielding elements of self.next() one-by-one: [1, 0, 2, 3]
 yielding elements of self.next() one-by-one: [1, 0, 2, 3] 
```

如您所见，数据流如下：递归进行到最深的级别（在本例中为 4，`len([0,1,2,3])`即 4），产生一个排列，并将其返回到前一个级别。该级别将其返回到之前的级别，依此类推。在最高级别，收益率将其返回。

**总之，这是一个破碎而糟糕的实现**，因为：

1.  它可以通过带有这个额外的类废话的递归函数模式来完成
2.  它`next()`以一种强烈暗示某事的方式定义，但实际上做了其他事情。
3.  如果任何值重复，它将失败，例如`Permutation([0,1,1])`将失败

你应该只使用[http://docs.python.org/library/itertools.html#itertools.permutations](http://docs.python.org/library/itertools.html#itertools.permutations) ( `from itertools import permutations`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:24:53.407

关键思想是产生以开头`Permutation.next()`的项目的所有排列。`_data``_sofar`

为此，我们尝试将每个可能的元素添加到`_sofar`. 然后有两种情况：一种`_sofar`是足够长的（即，我们有一个完整的排列），在这种情况下，我们只产生它的一个副本；或者它不是（即，我们有一个部分排列），在这种情况下我们递归调用`next`- 通常会产生很多排列，所以我们必须自己一个一个地产生它们。

顺便说一句，我认为如果代码更像这样（危险：未经测试的代码），代码会更简洁，更容易理解：

```
def next(self):
    if len(self._sofar) == len(self._data):
        yield self._sofar[:]
    else:
        for elem in self._data:
            if elem not in self._sofar:
                self._sofar.append(elem)
                for v in self.next():
                    yield v
                self._sofar.pop() 
```

which also has the merit of giving the right answer when there are no elements (there's exactly one permutation, the empty sequence; the code as given yields none). There are a few optimizations I'd be inclined to make, too, but they aren't important.

# python-2.7 - 如何存储用户从列表框中选择的输入

> ID：10390627
> 
> 赞同：2
> 
> 时间：2012-04-30T21:10:49.643
> 
> 标签：python-2.7

这很像一个旅行推销员问题。我有一个包含大学名称的列表框（以我从 Facebook 图表中获取的坐标为后盾）。我将选择模式设置为多个。我需要知道允许我使用他们选择的大学的代码，以便我可以通过距离方法对他们进行介绍。我只需要知道代码就可以看到他们选择了什么。我尝试使用 curselection() 但我仍然不明白。

这是一些代码：

```
 self.listbox = Listbox(self.mid_frame,width = 42,selectmode ="multiple",
                                        highlightcolor = "orange",
                                        highlightthickness = "10",bd = "5")

    coordinates = []
    collegelist = []
    f = open(sys.argv[1],'r')
    # grab the college's lat and long from facebook graph
    for identity in f:
        urlquery='https://graph.facebook.com/'+identity
        obj = json.load(urllib2.urlopen(urlquery))
        college = obj["name"]
        latitude = obj["location"]["latitude"]
        longitude = obj["location"]["longitude"]
        coordinates.append((college,latitude, longitude))
        collegelist.append(college)

    #sort the colleges so they appear alphabetical order
    sortcollege = sorted(collegelist)
    #fill Listbox with the College names imported from a text file
    for college in sortcollege:
        self.listbox.insert(END, college)

    self.listbox.pack(side = LEFT)
    #The label where I would put the total distance
    self.output_totaldist_label = Label(self.mid_frame,
                                    width = 11,
                                    textvariable = self.totaldistance)
    self.totaldistance = StringVar()
    self.output_label = Label(self.mid_frame,
                              textvariable = self.totaldistance)
    self.output_totaldist_label.pack(side = LEFT)
    self.output_label.pack(side = LEFT) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T06:59:25.943

很高兴看到您如何尝试使用 curselection 来查看问题所在。

就像是：

```
for idx in self.listbox.curselection():
    selitem = self.listbox.get(idx) 
```

应该做的伎俩。你试过吗？

# internet-explorer - Internet Explorer“混合内容”警告——如何压制？

> ID：10390640
> 
> 赞同：1
> 
> 时间：2012-04-30T21:11:38.347
> 
> 标签：internet-explorer, internet-explorer-8

我有一个 Facebook 应用程序（意味着它必须是 HTTPS），并且客户端报告说在 IE 中，弹出了丑陋的“混合内容”警告。请参阅：http: [//blogs.msdn.com/b/askie/archive/2009/05/14/mixed-content-and-internet-explorer-8-0.aspx](http://blogs.msdn.com/b/askie/archive/2009/05/14/mixed-content-and-internet-explorer-8-0.aspx)

现在，这些弹出的原因是因为我正在从我无法控制的 CDN 加载一些图像。CDN 仅支持 HTTP——不支持 HTTPS。但是我的应用程序需要 HTTPS，因为它是一个 Facebook 应用程序（这只是一个很好的做法）。

所以我觉得我是介于两难之间......显然这些“混合内容”警告是不利的，但我无法更改 CDN 以支持 HTTPS。

有什么我可以做的吗？

# xaml - 在正常状态下更改 Metro TextBox 的背景

> ID：10390641
> 
> 赞同：0
> 
> 时间：2012-04-30T21:11:47.927
> 
> 标签：xaml, textbox, windows-8, windows-runtime, winrt-xaml

我有一个带有 TextBox 的 C#/XAML Metro 风格应用程序。默认情况下，TextBox 以灰色背景显示。当我用鼠标悬停在它上面时，背景会变亮。当我将焦点放在 TextBox 中时，它有一个白色背景。

我想创建一个 XAML 样式，该样式将导致 TextBox 始终具有白色背景，无论我的鼠标位置如何或我的焦点在应用程序中的哪个位置 - 我该怎么做？

谢谢！

安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T21:27:39.380

您需要编辑控制模板。

# visual-studio-2010 - 无法添加对 Windows Phone 7.1 项目的服务引用（对话框不可用）

> ID：10390644
> 
> 赞同：1
> 
> 时间：2012-04-30T21:12:02.370
> 
> 标签：visual-studio-2010, windows-phone-7

我过去添加了对项目 A 的服务引用。我删除了引用并尝试通过右键单击项目来“添加服务引用”，但该选项不再存在。菜单中只有“添加参考”。在顶部的项目菜单中也是如此。

我打开了我的另一个 Windows Phone 项目（项目 B），右键单击该项目后，我能够看到“添加服务引用”...

我比较了 cjproj 文件并将项目 B 的 csproj 文本复制到项目 A，但没有用。

我很迷惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T13:33:05.187

我最终不得不创建一个新的 Windows Phone 项目并迁移每个文件和文件夹。不好玩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T22:25:05.703

似乎是[一个已知问题](http://connect.microsoft.com/VisualStudio/feedback/details/558449/wp7-tools-add-service-reference-menu-missing-from-visual-studio-2010-ultimate)。尝试清洁溶液并重新加载。此外，删除可能位于项目文件夹中的所有服务引用。

# java - 从方法 java 返回“常量”值

> ID：10390645
> 
> 赞同：1
> 
> 时间：2012-04-30T21:12:09.470
> 
> 标签：java, memoization

我不太确定这是否可能，所以我问你们。我想编写一个方法，知道它之前是否被访问过，以及它是否返回了与上次访问时相同的值。我不能为此使用字段/实例变量。

这是我想做的，没有实例变量 foo：

```
private FooObject foo = null;
public int setFoo(FooObject in)
{
    if(foo == null)
        foo = in;

    return foo.getX();
} 
```

这可以做到吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T21:15:23.430

> 知道它是否曾被访问过

了解之前发生的事情需要记忆，也就是[*state*](http://en.wikipedia.org/wiki/State_%28computer_science%29)。因此，您将需要一些东西来存储该知识；你无法避免它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:35:32.217

我同意@Oli Charlesworth，没有状态你不能这样做。但是使用字段来保存状态只是众多选项之一。例如，您可以使用 System.setProperty() 和 System.getProperty() 将状态保存为系统属性，或者将状态保存到文件中。您甚至可以将状态保存到数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:15:24.067

不使用实例变量？不，这是不可能的。您需要一种方法让方法在调用之间“记住”某些内容 - 局部变量不起作用，它必须是在方法调用之外“存在”的东西。这就是实例变量的用途：保存状态，对所有实例方法都可见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T21:46:06.487

您可以使用缓存。从缓存中读取以查找输入。如果输入已经在缓存中，则从缓存中返回值。如果没有，则将该条目放入缓存中并返回新的计算值。

```
CacheManager singletonManager = CacheManager.create();
Cache memoryOnlyCache = new Cache("testCache", 5000, false, false, 5, 2);
manager.addCache(memoryOnlyCache);
Cache cache = singletonManager.getCache("testCache"); 
```

放入新条目

```
Element element = new Element("key1", "value1");
cache.put(element); 
```

在 chache 中寻找：

```
Element element = cache.get("key1");
Object value = element.getObjectValue(); 
```

对于删除：

```
cache.remove("key1"); 
```

您可以将其保存到磁盘。

有关详细信息，请参阅[http://ehcache.org/](http://ehcache.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T22:39:23.513

您可以使用[Preferences API](http://docs.oracle.com/javase/1.4.2/docs/guide/lang/preferences.html)。但是，这允许您跨应用程序加载存储内存，因此如果您希望每次加载时都重新启动它，您需要[设置一个关闭挂钩](http://onjava.com/onjava/2003/03/26/shutdownhook.html)以清除 Preferences API 中的值。

# android - 在 LabeledIntent 中包装 Intent 用于显示目的

> ID：10390646
> 
> 赞同：5
> 
> 时间：2012-04-30T21:12:09.737
> 
> 标签：android, android-intent

**要求：**

我的应用程序中有一个“分享”按钮。我需要通过 Facebook 分享。我需要选择是否安装本机 Facebook 应用程序。如果未安装应用程序，我们的决定是将用户发送到 facebook.com 进行分享。

**当前状态：**

我可以检测何时未安装本机应用程序（通过包名称），并向选择器添加其他意图。

**问题：**

用户必须选择通过“Facebook 的网站”共享的项目显示“浏览器”并带有 Android 浏览器图标。LabeledIntent 项目未出现，我收到“未找到 Intent { act=android.intent.action.VIEW dat=...} 的活动

**代码（简化...）：**

```
Intent intent = new Intent(Intent.ACTION_SEND);
intent.putExtra(Intent.EXTRA_SUBJECT, "check this out");
intent.putExtra(Intent.EXTRA_TEXT, urlToShare);
boolean facebookInstalled = false;

Intent chooser = Intent.createChooser(intent, "Share this link!");
if (!facebookInstalled)
{
    Intent urlIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.facebook.com/sharer/sharer.php?u=" + Uri.encode(urlToShare)));
    Intent niceUrlIntent = new LabeledIntent(urlIntent, context.getApplicationContext().getPackageName(), "Facebook's Website", R.drawable.icon);

    // Ideally I would only add niceUrlIntent in the end, but that doesn't add anything to the chooser as-is
    chooser.putExtra(Intent.EXTRA_INITIAL_INTENTS, new Intent[urlIntent, niceUrlIntent]);
}
context.startActivity(chooser); 
```

**解决方案**

正如@CommonsWare 指出的那样，解决方案是使用 LabeledIntent 来包装一个指向我创建的新 Activity 的意图，该意图只是将 ACTION_VIEW 意图发送到适当的 Uri。

```
Intent myActivity = new Intent(context, ViewUriActivity.class);
myActivity.putExtra(ViewUriActivity.EXTRA_URI, "http://...");
Intent niceUrlIntent = new LabeledIntent(myActivity, context.getApplicationContext().getPackageName(), "Facebook's Website", R.drawable.icon);
chooser.putExtra(Intent.EXTRA_INITIAL_INTENTS, new Intent[]{niceUrlIntent}); 
```

ViewUriActivity 如下所示：

```
public final class ViewUriActivity extends Activity
{
    public static final String EXTRA_URI = ViewUriActivity.class.getSimpleName() + "EXTRA_URI";

    protected void onCreate(final Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        Intent urlIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(getIntent().getExtras().getString(EXTRA_URI)));
        startActivity(urlIntent);
        finish();
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-08T05:28:27.097

虽然没有记录，但看起来 LabeledIntents 仅适用于已解决的 Intent。因此，除非意图已经定义了特定的活动和包，否则您将无法使用它。

这并不奇怪，因为一个 LabeledIntent 可能会解决许多活动，并且您的选择器活动会将所有图标和名称显示为相同。

因此，在您的情况下，您必须先解决活动，然后再使用 LabeledIntent。但这可能会导致用户无法选择他选择的浏览器。使用以下函数从您的意图中获取 LabeledIntent。

```
Intent urlIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.facebook.com/sharer/sharer.php?u=" + Uri.encode(urlToShare)));
Intent niceUrlIntent = getLabelintent(urlIntent, "Facebook's Website", R.drawable.icon); 
```

和 getLabelIntent

```
public LabeledIntent getLabelintent(Intent in, String name, int drawable) {
    PackageManager pm = getPackageManager();
    ComponentName launchname = in.resolveActivity(pm);
    if (launchname != null) {
        Intent resolved = new Intent();
        resolved.setComponent(launchname);
        resolved.setData(in.getData());
        LabeledIntent niceUrlIntent = new LabeledIntent(resolved,
                getPackageName(), name, drawable);

        return niceUrlIntent;
    }
    return null;
} 
```

# javascript - 用 onkeyup() 替换 JQuery.keyup() 是一种安全的做法吗？

> ID：10390647
> 
> 赞同：2
> 
> 时间：2012-04-30T21:12:21.143
> 
> 标签：javascript, jquery, html, onkeyup

我正在尝试提高 HTML 页面的加载速度。

使用 JQuery 的方法将一些 Javascript 方法附​​加到一些输入字段`keyup()`。到目前为止，我已经设法安全地删除了页面中所有 JQuery 的使用，但这是最后一个问题。如果可能的话，我想在这个页面上完全摆脱 JQuery。

像这样（从 HTML 代码中）直接将我的 Javascript 方法链接到我的输入字段是否是一种可接受且安全的做法：

```
<input type="text" id="my_id" onkeyup="do_something()" /> 
```

我的担忧如下：

1）我知道 JQuery 处理浏览器中的许多角落案例和错误，但我只对支持最新的浏览器版本感兴趣（例如，不是 IE 8、7、6）。我害怕引入一个错误。

2) 将样式与 HTML 分开被认为是一种很好的做法，但是 Javascript 代码呢？是否有充分的理由继续使用 JQuery 分配我的 Javascript 方法？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:25:03.110

> 将样式与 HTML 分开被认为是一种很好的做法，但是 Javascript 代码呢？

这可能是主观的。在我们公司，我们尽量保持 HTML 中没有脚本，并且只使用脚本文件参考。在该文件中，我们将方法绑定到我们需要的字段的事件。不显眼的 JavaScript 使 HTML 保持干净。我猜是直接通过 jQuery 还是 JavaScript 取决于你。此外，如果需要，可以最小化 js 文件，这是我们目前所做的。

> 是否有充分的理由继续使用 JQuery 分配我的 Javascript 方法？

jQuery 是跨浏览器兼容的。在 FireFox 中有效的将在 IE 和 Chrome 中有效（据我所知）。如果您计划支持任何版本的 IE 和任何其他浏览器，根据脚本的功能，您可能需要解决浏览器兼容性问题。

这绝不意味着使用 jQuery，您会发现很多参数表明您不需要它。
事实上，众所周知，一些 jQuery 方法效率很低，`.live()` 例如，我相信它是一个非常消耗内存的方法，现在已被弃用，因为`on()`它显然更好地解决了这个问题。

# html - 如何创建水平项目列表？

> ID：10390648
> 
> 赞同：1
> 
> 时间：2012-04-30T21:12:22.293
> 
> 标签：html, css, html-lists

我正在尝试创建一个水平项目列表，以便它们可以用作导航。但由于某种原因，将显示设置`inline`为不起作用。我也尝试将显示设置为`inline-block`没有结果。有什么建议么？

**CSS**

```
#page {
    margin-top: 2em;
    background: #00000
}

#pageborder {
    background-color: white;
    margin-left: 150px;
    margin-right: 150px;
}

body, html {
    padding: 0;
    margin: 0;
    background-color: #EEEEEE;
    height: 100%;
    font-family:"Monospace", Lucida Console;
    font-size: 16;
}

h1 {
    font-size: 28pt;
}

h2 {
    margin:0;
    padding-bottom: 7px;
    font-size: 22;
}

p {
    margin-bottom:0px;
    padding-bottom:0px;
}

#header {
    height:50px;
    background-color: none;
    border-color: #E7E7E7;
    font-size: 28pt;
    color: white;
    padding-top: 20px;
    padding-bottom: 5px;
    margin-top: 108px;
}

#content {
    position: left;
    color: #5E5849;
    background-color: white;
    border: 2px solid;
    border-color: #EEEEEE;
    text-align: left;
    padding: 1em 2em 4em;
    margin-left: 20px;
    margin-right: 322px;
}

#sidebar {
    float:right;
    margin-right: 180px;
    position: absolute;
    top:;
    right:0;
    text-align: left;
    width: 250px;
    border: 2px solid;
    border-color: #EEEEEE;
    padding-top: 8px;
    padding-left: 40px;
}

#twitter {
    display: inline;
    float: left;
    margin-bottom: 10px;
    margin-right: 20px;
}

#youtube {
    display: inline;
    float: left;
    margin-bottom: 10px;
    margin-right: 20px;
}

#google {
    display: inline;
    float: left;
    margin-bottom: 10px;
    margin-right: 20px;
    padding-bottom: 2px;
}

#justin {
    display: inline;
    float: left;
    margin-bottom: 10px;
    margin-right: 20px;
}

#Social {
    border-bottom: solid thin grey;
    padding-bottom: 7px;
    font-size: 15px;
    margin-top: 10px;
}

#profilepic {
    margin-bottom: 10px;
}

* {
    margin: 0;
}

.footer {
    margin-left: 100px;
    height: 2em;
    color: white;
    clear: both;
    background-color: black;
}

th {
    text-align: left;
    padding-right: 2em;
}

#nav {
    width:100%;
    height:30px;
    background-color:#999;
}

#nav ul {
    display: inline-block;
    list-style-type: none;
    height:150px;
    color: red;
    padding-left: 150px;
}

#nav ul li {
    display:inline;
} 
```

**HTML**

```
<html>
<head>
    <link rel="stylesheet" type="text/css" href="template.css" />
    <title>Template</title>
</head>
<body>
    <div id="page">
        <div id="pageborder">
            <div id="header">
                <img src="banner.png" width=600 height=74.18>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about">About</a></li>
                    <li><a href="links">Links</a></li>
                </ul>
            </div>
            <div id="sidebar">
                <table>
                    <tr>
                        <div id="Social"><p><b>Social</b></p></div>
                        <p>
                            <div id="youtube">
                                <a href="http://www.youtube.com/ksheehan77" target="_blank">
                                    <img src="youtube_icon.png" width=36 height=36>
                                </a>
                        </div>
                            <div id="twitter">
                                <a href="http://www.twitter.com/#!/ksheehan77" target="_blank">
                                    <img src="Twitter.png" width=32 height=32>
                                </a>
                            </div>
                            <div id="justin">
                                <a href="http://www.justin.tv/ksheehan77" target="_blank">
                                    <img src="justintv.png" width=32 height=32>
                                </a>
                            </div>
                            <div id="google">
                                <a rel="author" href="https://profiles.google.com/110661467085975877308/" target="_blank">
                                    <img src="http://ssl.gstatic.com/images/icons/gplus-32.png" width="32" height="32">
                                </a>
                            </div>
                        </p>
                    </tr>
                </table>
            </div>
            <div id="content"> 
                <h2>Content</h2>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus nunc eget sem iaculis pharetra. Integer sodales interdum accumsan. In et diam neque. Praesent eget erat id lectus rutrum placerat a a purus. Integer molestie arcu vel orci iaculis sagittis consequat mauris hendrerit. Fusce placerat leo ac tortor fringilla posuere. Quisque et enim nisl, eu laoreet nibh. Sed vitae turpis leo. Etiam dictum pretium faucibus. Nam quis ornare nibh. Sed ultricies lacinia dolor ac ullamcorper. Sed dictum enim ut urna consequat quis bibendum mi eleifend. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec blandit nisi vitae dui blandit ultrices.</p>

                    <p>Aliquam enim ligula, pharetra at scelerisque eu, imperdiet vel lorem. Phasellus faucibus nunc ac purus imperdiet eleifend. Praesent id scelerisque massa. Suspendisse sed ornare lectus. Duis eget lacus quam, quis pharetra magna. Phasellus rhoncus, lectus et dictum accumsan, diam justo volutpat urna, ac auctor leo velit in augue. Proin eget nisi vel turpis hendrerit tempor sed a odio. Phasellus lacinia placerat lobortis. Vestibulum consequat bibendum semper. Vivamus cursus eros non felis gravida fermentum. Donec pulvinar, nisl a varius volutpat, ante lectus varius erat, ac sodales nisl nulla sed eros. Nam bibendum cursus bibendum. Nam id orci vitae odio consequat vestibulum eu vitae ipsum. Fusce ullamcorper pretium est, eget elementum mauris tristique vitae.</p>

                    <p>Suspendisse facilisis mauris eget mi tempus porta. Morbi viverra, libero sed posuere porta, est purus commodo nunc, ac interdum lacus eros et turpis. Pellentesque consequat sagittis elit vel imperdiet. Pellentesque elementum, eros eget vestibulum tempor, justo metus volutpat purus, sed viverra justo odio et erat. Maecenas id urna quam. Praesent auctor congue venenatis. Aenean dolor nisl, viverra vitae ornare sed, pretium sed nibh. Pellentesque pharetra pellentesque ipsum, in ornare lacus iaculis vel. Aliquam quis arcu lectus, eu pretium est. Integer a urna dui, vel tincidunt magna.</p>

                    <p>Nulla mauris felis, mollis at egestas at, suscipit at sem. Donec tincidunt, tellus at consectetur consectetur, elit nisi ullamcorper dolor, vel posuere odio sapien quis ligula. Proin nunc arcu, commodo id hendrerit pulvinar, hendrerit a ligula. Nulla sagittis iaculis est, eleifend mollis dolor ullamcorper a. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nunc non urna non nulla mollis rhoncus. Mauris eu urna tortor, et tincidunt diam.</p>

                    <p>Ut vehicula sodales nisi eu viverra. Donec nec sollicitudin nisi. Quisque tristique massa vel felis gravida iaculis. Proin a urna quis lacus facilisis viverra. In lacus nunc, faucibus sed luctus sit amet, tempor vitae nunc. Sed erat urna, ultricies non pretium at, vehicula id nibh. Sed sed dolor nisl. Duis nisi felis, euismod sit amet pulvinar ac, hendrerit vel tellus. Fusce vehicula tristique pellentesque. Cras molestie laoreet viverra.</p>
                </div>
            </div>
        </div>
    </div>
    <center>
        <div class="footer">Kieran Sheehan - 2012</div>
    </center>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:22:03.133

使用：

```
<html>
  <head>
    <style type="text/css">
      #nav{
        width:100%;
        height:30px;
        background-color:#999;
      }

      #nav ul{
        height:150px;
        color: red;
        padding-left: 150px;
      }

      #nav ul li{
        display:inline;
        list-style-type: none;}
    </style>
   </head>

   <div id="nav">
   <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="about">About</a></li>
      <li><a href="links">Links</a></li>
   </ul>
  </div>
</html> 
```

尝试使用 Ctrl+F5 刷新浏览器 - 它可能缓存了一些不起作用的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:16:19.527

很适合我。您是否还有其他一些可能与这些规则冲突的 CSS 规则？您可以使用 chrome 开发人员控制台检查哪些样式应用于您的“li”。

顺便说一下，“list-style-type”是用来和“ul”或“ol”一起使用的，而不是和“li”一起使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T23:42:08.053

尽管您的 css 不包含这样的属性，但请确保您的 li 元素不清除（即 clear:left / clear:right / clear:both）

要仔细检查，请将其添加到您的 css 中（使用 !important 不好，仅用于测试）

```
#nav ul li{
    clear: none !important;
} 
```

尝试添加浮动，看看你是否设法让你的元素出现在同一行。如果您仍然没有运气，那么您的设置肯定有问题，这在您粘贴的代码中并不明显。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T14:30:37.217

```
#nav ul{
display: inline-block;
list-style-type: none;
height:150px;
color: red;
***padding-left: 150px;***} 
```

我认为你在这里做错了；删除 ul 的填充，可能会起作用

# java - 如何将现有的关系数据库模型转换为适合无 sql 数据库的模型（如 Mongo DB 或 Amazon Dynamo DB）

> ID：10390649
> 
> 赞同：9
> 
> 时间：2012-04-30T21:12:23.560
> 
> 标签：java, sql, mongodb, amazon-dynamodb

我想修改现有的 java 购物车应用程序，使其与 Amazon Dynamo DB 或 Mongo DB 等 nosql 数据库一起使用......但传统的 MySQL 数据库是一个关系数据库-它具有复合键/主键/外键 - 在相比之下，在 Amazon Dynamo DB 中，要么有一个主键，要么有一个由 2 个字段组成的复合主键......

我有关系数据库的详细数据模型......现在我该如何转换它，以便我在 Amazon Dynamo DB 中有一个能够使应用程序与 Dynamo DB 一起工作的数据库（即没有 Sql 数据库）？执行此操作时是否必须牢记任何最佳实践/预防措施？这是否也会涉及大量重写应用程序代码的工作？或者我可以在数据库级别本身处理所有更改，而不修改应用程序的逻辑？此外，是否有任何工具可以完成大部分/大部分工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T09:22:42.803

没有自动化的方法。像 MongoDB 这样的 NoSQL 数据库不像 MySQL 那样映射数据结构。有不同的性能特征和存储数据的不同方式。在某些情况下，您会将两个 SQL 表合并到一个集合中，您只需将连接的数据包含在同一个文档中。

如何以及何时执行此操作完全取决于您在逻辑上如何对数据进行分组，但同样取决于您对数据施加的工作量。例如，对于大量读取和少量写入，您可能会以不同于大量写入和少量读取的情况存储数据。

除了必须重做从应用程序到数据库的接口之外，您还必须重新构建数据模型。这将与设计 SQL 结构一样多，而且最好*不要*考虑如何在 SQL 中完成它。NoSQL 与 SQL 是两种完全不同的野兽，需要区别对待！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T01:02:15.807

这是一个开始： http: [//mongify.com/](http://mongify.com/)这不是一个“全自动”解决方案，但它看起来可能是一个有用的工具，至少可以用作逆向工程 SQl 应用程序的“大纲”以作为MongoDB 应用程序。

# node.js - 如何处理 node.js 中的代码异常？

> ID：10390658
> 
> 赞同：28
> 
> 时间：2012-04-30T21:12:50.747
> 
> 标签：node.js, express

我浏览了 Express 的文档，[描述错误处理的部分](http://expressjs.com/en/guide/error-handling.html)对我来说完全不透明。

我认为`app`他们指的是一个实例`createServer()`，对吧？但是我不知道如何在处理请求期间发生异常时阻止 node.js 炸毁应用程序进程。

我真的不需要任何花哨的东西；每当出现异常时，我只想返回 500 的状态，再加上一个空响应。节点进程**不能**仅仅因为某处有未捕获的异常而终止。

有没有一个简单的例子来说明如何实现这一点？

* * *

```
var express = require('express');
var http = require('http');

var app = express.createServer();

app.get('/', function(req, res){
    console.log("debug", "calling")
    var options = {
        host: 'www.google.com',
        port: 80,
        path: "/"
    };
    http.get(options, function(response) {
       response.on("data", function(chunk) {
           console.log("data: " + chunk);
           chunk.call(); // no such method; throws here
       });
    }).on('error', function(e) {
       console.log("error connecting" + e.message);
    });
});

app.configure(function(){
    app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.listen(3000); 
```

使整个应用程序崩溃，产生回溯

```
mypath/tst.js:16
           chunk.call(); // no such method; throws here
                 ^ TypeError: Object ... has no method 'call'
    at IncomingMessage.<anonymous> (/Library/WebServer/Documents/discovery/tst.js:16:18)
    at IncomingMessage.emit (events.js:67:17)
    at HTTPParser.onBody (http.js:115:23)
    at Socket.ondata (http.js:1150:24)
    at TCP.onread (net.js:374:27) 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-04-09T21:48:44.137

如果你真的想捕获所有异常并提供一些处理而不是退出 Node.js 进程，你需要处理 Node 的[uncaughtException](http://nodejs.org/api/process.html#process_event_uncaughtexception)事件。

如果你仔细想想，这是 Node 的事情，而不是 Express 的事情，因为如果你从任意一段代码中抛出异常，就不能保证 Express 能够或将永远看到它，或者能够捕获它. （为什么？异常与 Node 风格的异步事件驱动的回调代码交互得不是很好。异常沿着调用堆栈向上移动以找到`catch()`抛出异常时范围内的块。如果`myFunction`将一些工作推迟到当某个事件发生时运行的回调函数，然后返回事件循环，然后当调用该回调函数时，它直接从主事件循环中调用，并且`myFunction`不再在调用堆栈上；如果该回调函数抛出异常，即使`myFunction`有一个 try/catch 块，它不会捕获异常。）

这在实践中意味着，如果您抛出异常并且自己没有捕获它，并且您在 Express 直接调用的函数中这样做，那么 Express 可以捕获异常并调用您已安装的错误处理程序，假设您已经配置了一些错误处理中间件，例如`app.use(express.errorHandler())`. 但是，如果您在响应异步事件而调用的函数中抛出相同的异常，Express 将无法捕获它。（它可以捕获它的唯一方法是侦听全局 Node`uncaughtException`事件，这首先是个坏主意，因为这是全局的，您可能需要将它用于其他事情，其次因为 Express 将不知道关联的请求有这个特例。）

这是一个例子。我将这段路由处理代码添加到现有的 Express 应用程序中：

```
app.get('/fail/sync', function(req, res) {
   throw new Error('whoops');
});
app.get('/fail/async', function(req, res) {
   process.nextTick(function() {
      throw new Error('whoops');
   });
}); 
```

现在，如果我`http://localhost:3000/fail/sync`在浏览器中访问，浏览器会转储一个调用堆栈（显示 express.errorHandler 正在运行）。但是，如果我`http://localhost:3000/fail/async`在浏览器中访问，浏览器会生气（Chrome 显示“未收到数据：错误 324，net::ERR_EMPTY_RESPONSE：服务器关闭连接但未发送任何数据”消息），因为节点进程已退出，在我调用它的终端中显示 stdout 的回溯。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-02T11:49:23.530

为了能够捕获异步错误，我使用 domain. 使用 Express，您可以尝试以下代码：

```
function domainWrapper() {
    return function (req, res, next) {
        var reqDomain = domain.create();
        reqDomain.add(req);
        reqDomain.add(res);

        res.on('close', function () {
            reqDomain.dispose();
        });
        reqDomain.on('error', function (err) {
            next(err);            
        });
        reqDomain.run(next)
    }
}
app.use(domainWrapper());
//all your other app.use
app.use(express.errorHandler()); 
```

此代码将使您的异步错误被捕获并发送到您的错误处理程序。在此示例中，我使用 express.errorHandler，但它适用于任何处理程序。

有关域的更多信息：[http ://nodejs.org/api/domain.html](http://nodejs.org/api/domain.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T22:44:55.120

您可以使用 express 使用的默认错误处理程序，它实际上是[连接错误处理程序](http://www.senchalabs.org/connect/middleware-errorHandler.html)。

```
var app = require('express').createServer();

app.get('/', function(req, res){
  throw new Error('Error thrown here!');
});

app.configure(function(){
    app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.listen(3000); 
```

**更新** 对于您的代码，您实际上需要捕获错误并将其传递给这样的表达

```
var express = require('express');
var http = require('http');

var app = express.createServer();

app.get('/', function (req, res, next) {
  console.log("debug", "calling");
  var options = {
    host:'www.google.com',
    port:80,
    path:"/"
  };
  http.get(options,
    function (response) {
      response.on("data", function (chunk) {
        try {
          console.log("data: " + chunk);
          chunk.call(); // no such method; throws here

        }
        catch (err) {
          return next(err);
        }
      });
    }).on('error', function (e) {
      console.log("error connecting" + e.message);
    });
});

app.configure(function () {
  app.use(express.errorHandler({ dumpExceptions:true, showStack:true }));
});

app.listen(3000); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-22T23:38:27.583

[express 5.0.0-alpha.7 27 天前出来了](https://github.com/expressjs/express/releases/tag/5.0.0-alpha.7)。使用这个非常具体的预发布版本，您现在终于可以在请求处理程序中拒绝一个承诺，它会被正确处理：

> 中间件和处理程序现在可以返回 Promise，如果 Promise 被拒绝，next(err) 将被调用， err 是拒绝的值。[（资源）](https://github.com/expressjs/express/issues/2259#issuecomment-433586394)

例如：

```
app.get('/', async () => {
    throw new Error();
});
app.use((err, req, res, next) => {
    res.status(500).send('unexpected error :(');
}); 
```

但是，仅将其用作后备。正确的错误处理仍应发生在请求处理程序本身的捕获短语中，并带有正确的错误状态代码。

# solr - NoSql 的搜索索引器，特别是 Cassandra

> ID：10390660
> 
> 赞同：2
> 
> 时间：2012-04-30T21:12:53.047
> 
> 标签：solr, nosql, cassandra, sphinx, elasticsearch

我希望将 Cassandra 实现与搜索索引解决方案集成。我遇到的一些选项是 Sphinx、Solr (Solandra)、Elastic Search。

我需要支持繁重的读写操作。我目前使用 Solr，它适用于大量读取，但与大量写入结合使用时效果不佳。

我需要支持各种查询，如全文、通配符、范围等。

将不胜感激任何关于最佳方式的指示。与 Cassandra 有良好集成并支持大量读写操作的产品确实是理想的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T22:15:05.683

ElasticSearch 是一个很好的候选者。写入和读取一样，横向无缝地分布在分片中。在功能方面，它是 Solr 的超集。我还不知道 ES 没有从 Solr 支持或改进的任何东西。ES 也比后期分发 Solr 的努力成熟得多。

ES 不直接与 Cassandra 集成，但您可以轻松编写代码来索引数据。如果你精通 Java，你可以把它变成[River](http://www.elasticsearch.org/blog/2010/09/28/the_river.html)。

您也可以考虑使用 ES 作为键/值存储本身而不是 Cassandra。它们都类似于发电机，但 ES 在检索数据方面要好得多。

# django-models - Django 多个外键还是一个就够了？

> ID：10390663
> 
> 赞同：0
> 
> 时间：2012-04-30T21:13:08.293
> 
> 标签：django-models, django-orm

我对 Django 还很陌生，到目前为止，我已经习惯了它显示来自其他来源的数据。

我正在着手一个新项目，并且对 Django 处理模型关系的方式进行了查询（对于这个特定实例，一些搜索是否找不到太多），并且想知道完成它的最有效方法。

我有 3 个模型、用户（显然是：S）、项目和报告。现在报告是项目的一部分并由用户完成，但项目也由用户“拥有”。因为其他用户无法看到其他用户的报告/项目。我需要两个外键来报告还是只需要一个（例如，用户创建 projectA 和 Report1，因为 Report1 链接到项目，它也链接到用户），即：

```
Class Report(models.Model):
    user = models.ForeignKey(User)
    project = models.ForeignKey(Project) 
```

或者

```
Class Report(models.Model):
    project = models.ForeignKey(Project) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:22:29.810

如果报告仅通过项目与用户相关联（这特别意味着，**与项目不同的用户拥有报告是没有意义的**），那么第二个更好。您将始终能够通过`(report object).project.user`或在搜索查询中访问用户`'project__user'`。如果您使用第一个，则可能会导致报告和项目的用户数据不同步，这对您的应用程序没有意义。

# javascript - jQuery添加类，如果它存在于别处

> ID：10390665
> 
> 赞同：0
> 
> 时间：2012-04-30T21:13:09.187
> 
> 标签：javascript, jquery, dry

我刚刚编写了下面的代码，将一个类添加到它匹配的外部 div 中。现在我知道必须有一种更优雅的方式来实现以下目标！

```
if ($(".cur").hasClass("one")) { $("#outer").addClass("one"); }
if ($(".cur").hasClass("two")) { $("#outer").addClass("two"); }
if ($(".cur").hasClass("three")) { $("#outer").addClass("three"); }
if ($(".cur").hasClass("four")) { $("#outer").addClass("four"); }
if ($(".cur").hasClass("five")) { $("#outer").addClass("five"); }
if ($(".cur").hasClass("six")) { $("#outer").addClass("six"); } 
```

任何改进都将很高兴收到:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:16:29.733

```
var classNames = '';    
$('.cur').each(function(){
    if (classNames.indexOf(this.className + ' ') === -1)
        classNames += this.className + ' ';
});

var classes = classNames.split​(" ");​​​
var $outer = $('#outer');    
$.each(classes, function(index, value){
    if (value !== 'cur')  
        $outer.addClass(value);
}); 
```

[**现场演示**](http://jsfiddle.net/pKdq7/5/)

**笔记：**

*   使用此代码，您无需“烧录”`.cur`代码中的类，它会自动完成。
*   它会复制所有的类`.cur`（除了`cur`它自己），所以由你决定它是否对你有好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T21:37:20.677

您可以使用 regEx 找到匹配的类，然后将匹配的类添加到#outer。见下文，

```
$(function () {
    var regClasses = /(one|two|three|four|five|six)/g;
    var $cur = $('.cur'),
        $outer = $('#outer');

    $cur.each(function () {        
        $outer.addClass(this.className.match(regClasses).join(' '));
    });
}); 
```

[**演示**](http://jsfiddle.net/pKdq7/7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T21:16:50.883

这个怎么样：

```
var classes = ['one', 'two', 'three'],
    $cur = $('.cur'),
    $outer = $("#outer");

$.each(classes, function(i, v) {
    if ($cur.hasClass(v)) $outer.addClass(v); 
}) 
```

或者迭代可以实现为纯js，如：

```
for (var i in classes) {
    var v = classes[i];
    ....
} 
```

或（更好）`for`改用：

```
var len = classes.length;
for (var i = 0; i < len; i++) {
    var v = classes[i];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T21:23:37.760

这应该更快，因为它不会`.hasClass`在每次迭代中调用：

```
// define which classes you want to match
match_classes = ["one", "two", "three", "four"];
// grab all the classes on the inner element
elm_classes = $(".cur").attr("class").split(" ");
// cache the outer element for quick access
$outer = $("#outer");

// iterate over the list of classes you want to match
$.each(match_classes, function(i, val){
// if one of those classes exists on inner, add it to outer
  if(elm_classes.indexOf(val) > -1) $outer.addClass(val);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T21:23:00.117

```
var classes = ['one', 'two', 'three', 'four', 'five', 'six'];
$.each(classes, function(key, value){
    if($('.cur').hasClass(value)) $('.cur').closest('div').addClass(value); 
}); 
```

应该做的伎俩，它使用最接近（'div'）来获取外部div。

# asp.net - 无法在 AJAX 错误处理程序中获得正确的状态代码

> ID：10390668
> 
> 赞同：1
> 
> 时间：2012-04-30T21:13:22.090
> 
> 标签：asp.net, jquery, http-status-codes

我无法在 AJAX 请求的错误处理程序中获得正确的错误代码。每次发生错误时，它都会返回 statusCode = 500。我尝试在我的服务中将其显式设置为`HttpContext.Current.Response.StatusCode = 403;`，但它仍然给我 status = 500。

这就是我的 AJAX 请求的样子：

```
$.ajax({
            type: "POST",
            url: "Services/someSvc.asmx/SomeMethod",
            cache: true,
            contentType: "application/json; charset=utf-8",
            data:"{}",
            dataType: "json"
            error: ajaxFailed
        });

        function ajaxFailed(xmlRequest) {
                alert(xmlRequest.status + ' \n\r ' + //This is always 500.
                xmlRequest.statusText + '\n\r' + 
                xmlRequest.responseText);
        } 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T22:30:20.823

看起来你快到了，这是一个示例 [WebMethod]，它会抛出 StatusCode 403。

```
 [WebMethod]
    public static string HelloWorld(string name)
    {
        HttpContext.Current.Response.Clear();
        HttpContext.Current.Response.StatusCode = 403;
        return null;
    } 
```

这是调用 jQuery 代码。

```
 $(document).ready(function ()
    {
        var jsonRequest = { name: "Zach Hunter" };

        $.ajax({
            type: 'POST',
            url: 'Demo.aspx/HelloWorld',
            data: JSON.stringify(jsonRequest),
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            success: function (data, text)
            {
                $('#results').html(data.d);
            },
            error: function (request, status, error)
            {
                $('#results').html('Status Code: ' + request.status);
            }
        });
    }); 
```

如果您没有返回方法签名中指定的值，您将返回状态代码 500。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:20:56.687

根据[文档](http://api.jquery.com/jQuery.ajax/)：

> 错误（jqXHR，textStatus，errorThrown）
> 
> 请求失败时调用的函数。该函数接收三个参数：jqXHR（在 jQuery 1.4.x 中，XMLHttpRequest）对象，一个描述发生的错误类型的字符串和一个可选的异常对象（如果发生）。第二个参数（除了 null）的可能值是“timeout”、“error”、“abort”和“parsererror”。发生 HTTP 错误时，errorThrown 会接收 HTTP 状态的文本部分，例如“未找到”或“内部服务器错误”。从 jQuery 1.5 开始，错误设置可以接受一个函数数组。每个函数都会被依次调用。注意：跨域脚本和 JSONP 请求不调用此处理程序。这是一个 Ajax 事件。

因此，将您的代码更改为更像这样的内容：

```
$.ajax({
    type: "POST",
    url: "Services/someSvc.asmx/SomeMethod",
    cache: true,
    contentType: "application/json; charset=utf-8",
    data:"{}",
    dataType: "json",
    error: ajaxFailed (jqXHR, textStatus, errorThrown)
}); 

function ajaxFailed(jqXHR, textStatus, errorThrown) {
    alert(errorThrown + ' \n\r ' + textStatusText);         
} 
```

您可能还会发现[此答案提供了一些附加](https://stackoverflow.com/questions/377644/jquery-ajax-error-handling-show-custom-exception-messages)信息。

# xaml - 在网格背景上绘制黑色三角形而不是 WinRT 中的网格内容

> ID：10390675
> 
> 赞同：0
> 
> 时间：2012-04-30T21:13:52.403
> 
> 标签：xaml, background, grid, windows-runtime, winrt-xaml

所以我有一个带背景的网格。网格内部是一个 WebView，然后是屏幕左侧的一些空间，我现在刚刚在其中放置了一个 Button。

当程序运行时，左侧栏（显示带有背景的网格和放置在其上的按钮）没有呈现，而是我得到了背景，上面没有控件和黑色三角形（或几何形状）底端。

我怀疑这是虚拟机和视频驱动程序的问题。几年前我在 WPF 上遇到过类似的问题，MS 的回应是我有一个不兼容的视频驱动程序，导致表单始终无法正确呈现（这是非常相同的行为）。

我能做些什么来防止这种情况发生？我包括一个图像。

我将包含我使用的小型 XAML，然后是行为的屏幕截图（我手动重新键入的 XAML）：

```
<Grid>
    <Grid.Background>
        <ImageBrush ImageSource="Media/Background.jpg" />
    </Grid.Background>
    <TextBlock FontSize="24" Margin="15,15,0,0">Sample Label</TextBlock>
    <WebView x:Name="wv1" Margin="250,0,0,0"></WebView>
    <Button Content="Do Something" HorizontalAlignment="Left" Height="42" Margin="57,131,0,0" VerticalAlignment="Top" Width="170" Click="Button_Click1" />
</Grid> 
```

![在此处输入图像描述](../Images/d930b7be877d159a00aed5dcd217ca33.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:46:49.603

虚拟机不适用于多媒体。您应该预料到视频会出现各种问题。

# c# - 如何使用事务范围？

> ID：10390680
> 
> 赞同：2
> 
> 时间：2012-04-30T21:14:24.293
> 
> 标签：c#, .net, db2, transactionscope, distributed-transactions

我正在尝试在分布式事务下更新 DB2 数据库（通过 NHibernate），但它一直失败。

这是我写的代码：

```
public bool ExecuteUsingDTC(List<Func<bool>> tasks)
{
    var result = false;
    using (var scope = new TransactionScope(TransactionScopeOption.Required))
    {
        using (var session = sessionFactory.OpenSession())
        using (var transaction = session.BeginTransaction())
        {
            //carry out db modification tasks
            tasks.ForEach(task => { result = result && task.Invoke(); })
            transaction.Commit();
        }
        scope.Complete();
    }

    return result;
} 
```

我不断收到异常：

```
NHibernate.TransactionException was unhandled by user code
Message=Begin failed with SQL exception
Source=NHibernate
StackTrace:
   at NHibernate.Transaction.AdoTransaction.Begin(IsolationLevel isolationLevel)
   at NHibernate.Transaction.AdoTransaction.Begin()
   at NHibernate.AdoNet.ConnectionManager.BeginTransaction()
   at NHibernate.Impl.SessionImpl.BeginTransaction()
   at DTCProofOfConcept_Repository.ExecuteUsingDTC(List`1 tasks) in C:\Project\Infrastructure\GlobalRepositories\DTCProofOfConcept_Repository.vb:line 20
   at 

InnerException: IBM.Data.DB2.DB2Exception
   ErrorCode=-2147467259
   Message=ERROR [HY011] [IBM] CLI0126E  Operation invalid at this time. SQLSTATE=HY011
   Source=IBM.Data.DB2
   StackTrace:
        at IBM.Data.DB2.DB2Connection.HandleError(IntPtr hHandle, SQL_HANDLE hType, RETCODE retcode)
        at IBM.Data.DB2.DB2Transaction.set_AutoCommit(Boolean value)
        at IBM.Data.DB2.DB2Transaction.BeginTransaction()
        at IBM.Data.DB2.DB2Connection.BeginTransactionObject(IsolationLevel isolevel)
        at IBM.Data.DB2.DB2Connection.BeginTransaction(IsolationLevel isolevel)
        at IBM.Data.DB2.DB2Connection.BeginTransaction()
        at IBM.Data.DB2.DB2Connection.System.Data.IDbConnection.BeginTransaction()
        at NHibernate.Transaction.AdoTransaction.Begin(IsolationLevel isolationLevel)
   InnerException: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:36:00.740

像这样使用 TransactionScope

```
using(var scope = new TransactionScope(...))
{

    transaction.Complete();
} 
```

开始并为您提交事务。如果抛出异常，则事务将被正在处理的范围中止，而不会调用 Complete。

我怀疑您的问题是您对 BeginTransaction/Commit 有一个额外的显式调用。删除这些并假设 NHibernate 可以很好地与 TransactionScope 一起使用应该没问题。

使用 TransactionScope 可能涉及使用分布式事务协调器 (DTC)。如果是这样，您需要打开管理工具|组件服务。导航到分布式事务协调器|本地 DTC。右键，属性，安全选项卡。启用安全性并作为开始启用一切。如果这可行，请阅读 DTC 安全性并将其减少到最低限度。

或者按照 DanVallejo 的建议删除 TransactionScope 并使用您的显式事务。

# android - 包括带有 APK 的图标/背景图片

> ID：10390686
> 
> 赞同：0
> 
> 时间：2012-04-30T21:15:15.860
> 
> 标签：android

我想在下一次应用程序更新中包含一些壁纸和自定义图标。在Android中最好的方法是什么？我一直在做一些搜索，但我没有看到任何令人满意的东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:23:17.697

只需更改图标和背景并更新应用程序。还是你的意思是别的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T22:48:35.807

我知道如果您的应用程序将文件移动/复制到用户的 SD 卡，那么媒体扫描仪应该将其拾取并包含在图库应用程序中。然后可以用作墙纸。但至于直接从您的应用程序中使用它们，我不确定。

最好不要将它们直接包含在应用程序中，但允许用户选择从您的应用程序中下载它们（如果您有服务器或外部站点，您可以在其上托管它们）。这将使您的应用程序的大小保持较小，并允许您将它们直接下载到用户的 SD 卡。

# python - django中的抽象模型类，但带有表格

> ID：10390689
> 
> 赞同：1
> 
> 时间：2012-04-30T21:15:24.277
> 
> 标签：python, django

在Django中，如果我做一个抽象模型类，然后有实际的派生类，只有这些类会有关联表，抽象类不能自己实例化。如果我删除 abstract=True 元信息，则会为基类创建一个实际表，但这样做允许客户端代码创建基类的对象。

有没有办法强制客户端代码总是实例化派生类，同时有一个与基类关联的表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T04:44:46.887

您可以尝试在课堂上返回或`None`提高，我不知道这是否会影响其他任何事情，但值得一试。`NotImplemented``__new__`

# javascript - 缩小外部网址和多个样式表

> ID：10390691
> 
> 赞同：0
> 
> 时间：2012-04-30T21:15:32.313
> 
> 标签：javascript, html, css, minify

使用 minify 时的 2 部分问题。终于让它在本地主机上工作。

1) 我有一些可以外部链接到 CDN 的脚本，我如何将它们包含在 minify 中？

```
 <script type="text/javascript" src="/min/b=highaccess/js&amp;f=styleswitcher.js,jquery-1.7.2.js,jquery-ui-1.8.19.custom.min.js,downloadxml.js,geometa.js"></script> 
```

我还需要包括这个：http://maps.google.com/maps/api/js?key=AIzaSyAOpIKcVcsbojjjFIwnAOSsDwi_lARLp8o&sensor=false

如果可能的话，我将使用托管脚本。

2）我已经设法缩小 CSS，但是我有一个用于 3 种布局的样式切换器，当我将它们包含在缩小它们级联中时，这不是我想要的。有没有办法缩小这个或者我必须为每种样式设置单独的元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:30:41.907

1) 从 CDN 中缩小外部资产首先违背了使用 CDN 的目的。您正在将内容卸载到另一台服务器，并且您获得了这些文件可能已经被缓存的好处（当用户访问使用与您相同的 CDN 的站点时下载）。如果您必须将它们缩小，只需获取您自己的本地副本并将其包含在您的缩小脚本中。否则，我会将它们保留为单独的脚本调用。

2) 缩小 CSS 意味着将所有内容合并到一个请求中，所以是的，稍后添加的样式将覆盖早期的样式。如果您有 3 个单独的主题，则每个主题都需要有 3 个单独的缩小过程。只需使用 javascript 在标签中动态加载它们，它们就会在您切换时覆盖。

# javascript - 如何将一长串数字转换为短串？

> ID：10390700
> 
> 赞同：2
> 
> 时间：2012-04-30T21:16:08.047
> 
> 标签：javascript, compression

我正在构建一个网格，其中每个框使用 HTML 和 Javascript 具有不同的颜色值。

示例：一个 5x5 网格，我有 25 个值要跟踪。我希望能够通过“网格”参数发送网格的信息，这样当任何用户想要查看这个特定的网格时，他们都会看到完全绘制的网格。最初，该 URL 为：www.mysite.com?grid=0123401234012340123401234 理想情况下，该参数应少于 25 个字符。

我将如何将 '0123401234012340123401234' 转换为更小的字符串？最好使用压缩算法还是仅使用十进制到十六进制转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:19:21.037

您可以使用更高的基础。像 30 之类的东西，例如：`(123401234012340123401234).toString(30) --> "8i015nb02ib0c4ik"`. 请注意，要使其正常工作，`123401234012340123401234`必须是数字而不是字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:29:50.407

如果每个单元格都包含一种颜色，则意味着每个单元格需要 3 个字节（如果在 Alpha 通道中包含更改，则需要 4 个字节）。这意味着如果您以十六进制编码，则每个单元格需要 6 个十六进制字符。

这不是最优的，所以我建议使用`a-zA-Z0-9`which equals `26 + 26 + 10 = 62`characters 。然后使用这两个字符 - 和 _ 来获得完整的 64 个字符。使用十六进制，您需要 6 个字符来编码 2^(24) 个可能的值（如果您使用的是 alpha 通道，则需要 2^32）。

使用 64 个基本字符，每个单元格只需要 4 个字符。我提到这一点的原因是因为 a-zA-Z0-9 - 和 _ 是有效的 url 字符。

当然，所有这些都是假设您使用所有颜色。如果限制域，则可以大幅减少每个单元格的字符数，但仍应使用相同的编码方案。

# sql - 如何根据字段值从几乎重复的行中选择一行？

> ID：10390701
> 
> 赞同：1
> 
> 时间：2012-04-30T21:16:12.337
> 
> 标签：sql, sql-server-2005

如果我有这些数据的行：

```
ID |Name        |ContractType|
---|------------|------------|
 1 |Aaron Shatz | 6-month    |
 2 |Jim Smith   |12-month    |
 3 |Jim Smith   | 6-month    |
 4 |Mark Johnson|12-month    | 
```

我不能使用 Id 来确定要使用的记录：我必须使用*ContractType*。我想从一个表中选择所有记录，但是如果存在具有相同*名称*值的记录，我想选择*12 个月的*合同记录。

查询的结果应该是：

```
ID |Name        |ContractType|
---|------------|------------|
 1 |Aaron Shatz | 6-month    |
 2 |Jim Smith   |12-month    |
 4 |Mark Johnson|12-month    | 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T21:24:20.567

# 硬编码版本

该解决方案假设只有两种合同类型，即 6 个月和 12 个月。请滚动到底部查看**`dynamic`**版本。

[**单击此处查看 SQL Fiddle 中的演示。**](http://sqlfiddle.com/#!6/59d08/1)

*脚本*：

```
CREATE TABLE contracts
(
        id              INT         NOT NULL IDENTITY
    ,   name            VARCHAR(30) NOT NULL
    ,   contracttype    VARCHAR(30) NOT NULL
);

INSERT INTO contracts (name, contracttype) VALUES
    ('Aaron Shatz',     '6-month'),
    ('Jim Smith',       '12-month'),
    ('Jim Smith',       '12-month'),
    ('Mark Johnson',    '12-month'),
    ('John Doe',        '6-month'),
    ('Mark Johnson',    '6-month'),
    ('Aaron Shatz',     '6-month');

SELECT id   
    ,   name
    ,   contracttype
FROM
(
    SELECT  id  
        ,   name
        ,   contracttype
        ,   ROW_NUMBER() OVER(PARTITION BY name ORDER BY contracttype) AS rownum
    FROM    contracts
) T1 
WHERE rownum = 1
ORDER BY id; 
```

*输出*：

```
id  name          contracttype
--  ------------  ------------
1   Aaron Shatz   6-month
2   Jim Smith     12-month
4   Mark Johnson  12-month
5   John Doe      6-month 
```

# 动态版

这会将*合同类型*数据移动到它自己的带有*序列*列的表中。根据合同类型的排序方式，查询将获取适当的记录。

[**单击此处查看 SQL Fiddle 中的演示。**](http://sqlfiddle.com/#!6/9c16a/1)

*脚本*：

```
CREATE TABLE contracts
(
        id              INT         NOT NULL IDENTITY
    ,   name            VARCHAR(30) NOT NULL
    ,   contracttypeid  INT         NOT NULL
);

CREATE TABLE contracttypes 
(
        id              INT         NOT NULL IDENTITY
    ,   contracttype    VARCHAR(30) NOT NULL
    ,   sequence        INT         NOT NULL 
)

INSERT INTO contracttypes (contracttype, sequence) VALUES
    ('12-month', 1),
    ('6-month',  3),
    ('15-month',  2);

INSERT INTO contracts (name, contracttypeid) VALUES
    ('Aaron Shatz',     2),
    ('Jim Smith',       2),
    ('Jim Smith',       3),
    ('Mark Johnson',    1),
    ('John Doe',        2),
    ('Mark Johnson',    2),
    ('Aaron Shatz',     2);

SELECT  id  
    ,   name
    ,   contracttype
FROM
(
    SELECT  c.id    
        ,   c.name
        ,   ct.contracttype
        ,   ROW_NUMBER() OVER(PARTITION BY name ORDER BY ct.sequence) AS rownum
    FROM            contracts           c
    LEFT OUTER JOIN contracttypes       ct
    ON              c.contracttypeid    = ct.id
) T1 
WHERE rownum = 1
ORDER BY id; 
```

*输出*：

```
id  name          contracttype
--  ------------  ------------
1   Aaron Shatz   6-month
3   Jim Smith     15-month
4   Mark Johnson  12-month
5   John Doe      6-month 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T21:18:51.573

这*仅*是因为 OP 已确认只有两种合同类型是可能的，而他想要的（对于每个承包商）恰好是按字母顺序排列的第一个。因此，一些巧合使这个解决方案变得直截了当。

```
;WITH x AS
(
  SELECT ID, Name, ContractType, rn = ROW_NUMBER() OVER
    (PARTITION BY Name ORDER BY ContractType)
  FROM dbo.some_table
)
SELECT ID, Name, ContractType 
  FROM x
  WHERE rn = 1
  ORDER BY ID; 
```

如果您需要使其更具动态性，我想您可以说：

```
DECLARE @PreferredContractType VARCHAR(32);
SET @PreferredContractType = '12-month';

;WITH x AS
(
  SELECT ID, Name, ContractType, rn = ROW_NUMBER() OVER
    (PARTITION BY Name ORDER BY CASE ContractType
      WHEN @PreferredContractType THEN 1 ELSE 2 END
    )
  FROM dbo.some_table
)
SELECT ID, Name, ContractType 
  FROM x
  WHERE rn = 1
  ORDER BY ID; 
```

# php - 从字符串转换日期和/或时间时 PHP mssql_query 错误

> ID：10390707
> 
> 赞同：0
> 
> 时间：2012-04-30T21:16:35.877
> 
> 标签：php, sql-server

我正在使用 PHP 查询 SQL Server 2008 R2 上的一些数据并收到以下错误：

*   PHP 警告：mssql_query()：消息：从字符串转换日期和/或时间时转换失败。（严重性 16）在 /var/www/html/BSC_Entry.php 第 14 行
*   PHP 警告：mssql_query()：一般 SQL Server 错误：在第 14 行的 /var/www/html/BSC_Entry.php 中检查来自 SQL Server（严重性 16）的消息

这是代码块：

```
 3 <?php // Initialise all database actions
  4     //IP of server
  5     $server = 'x.x.x.x';
  6 
  7     // Connection to MSSQL - possibly use password file
  8     $link = mssql_connect($server, 'user', 'pass');
  9     if (!$link) {
 10         die('Something went wrong while connecting to MSSQL');
 11     }
 12 
 13     // Declare query to return BSC_Name, BSC_Owner and  
 14     $qBSCInfo = mssql_query('SELECT * FROM dbo.BSC_Info;', $link);
 15 
 16 ?> 
```

最初，我将下面的 SQL 作为参数传递给 mssql_query，但在收到错误后，在“BSC_Info”上方创建了数据库视图（具有适当的权限），以防查询过于复杂而无法处理 mssql_query：

```
SELECT DISTINCT 
    dbo.BSC.BSC_ID,
    dbo.BSC.BSC_Name, 
    dbo.BSC.BSC_Owner, 
    DATEDIFF(M, MAX(CONVERT(DATETIME, LEFT(dbo.BSCDataSet.DatePeriod, 4) 
                      + RIGHT(dbo.BSCDataSet.DatePeriod, 2) + '01')), CONVERT(DATETIME, LEFT(CONVERT(VARCHAR, GETDATE(), 120), 4) + RIGHT(LEFT(CONVERT(VARCHAR, GETDATE(), 
                      120), 7), 2) + '01')) AS Periods_to_Current
FROM dbo.BSC 
LEFT OUTER JOIN dbo.BSCDataSet 
ON dbo.BSC.BSC_ID = dbo.BSCDataSet.BSC_ID
GROUP BY dbo.BSC.BSC_ID, dbo.BSC.BSC_Name, dbo.BSC.BSC_Owner 
```

为了澄清，该查询在 SQL Server Management Studio 中工作，返回表中的一些字段以及当前日期和较早日期之间的差异（以月为单位）（以 VARCHAR - YYYYMM 格式存储在数据库中）。为了防止部分月份出现任何问题，我已将比较日期设置为该月的第一天。我确信有一种更优雅的方法可以做到这一点，但我对 SQL Server 或 PHP 的经验很少！

数据类型有：

*   BSC_ID - 数字（5,0）
*   BSC_Name - varchar(50)
*   BSC_Owner - varchar(50)
*   Periods_to_Current - int

任何帮助将非常感激。大家干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T14:49:12.357

所以这段代码有很多问题：

*   php.ini 文件需要 mssql 设置：*mssql.datetimeconvert = 0*
*   任何 CONVERT-ed 日期字段都需要日期格式 121
*   原始代码尝试在可能为 NULL 的日期字段上执行转换、日期算术和 MAX() 函数 - 哎呀

我现在已将代码修改为更合适（并且有效）：

```
SELECT 
  dbo.BSC.BSC_ID,
  dbo.BSC.BSC_Name, 
  dbo.BSC.BSC_Owner, 
  CASE maxview.maxDate 
    WHEN NULL THEN NULL 
    ELSE DATEDIFF(M,CONVERT(DATETIME, LEFT(maxview.maxdate, 4)+ RIGHT(maxview.maxdate, 2) + '01', 121),GETDATE()) 
  END 
FROM dbo.BSC 
LEFT OUTER JOIN (SELECT BSC_ID, MAX(dbo.BSCDataSet.DatePeriod) as maxDate 
FROM dbo.BSCDataSet GROUP BY BSC_ID) maxview 
ON dbo.BSC.BSC_ID = maxview.BSC_ID; 
```

希望这会帮助别人！

# scala - 在 Scala 中覆盖柯里化函数

> ID：10390708
> 
> 赞同：6
> 
> 时间：2012-04-30T21:16:37.410
> 
> 标签：scala

我的印象是，这

```
// short syntax
def foo(bar: Bar)(baz: Baz): Quux 
```

是语法糖

```
// long syntax
def foo(bar: Bar): (Baz) => Quux 
```

但在继承方面，我似乎无法将两者混为一谈。整个树必须以短句法或长句法定义；从不两者兼而有之。

例如：

```
case class Context
case class Work

trait ContextualWorker {
  def workWithContext(ctxt: Context)(work: Work): Traversable[Work]
}

class ShortConcreteWorker extends ContextualWorker {
  override def workWithContext(ctxt: Context)(work: Work) = Nil
}

class LongConcreteWorker extends ContextualWorker {
  // error on next line: method workWithContext overrides nothing    <-------------
 override def workWithContext(ctxt: Context): (Work) => Traversable[Work] = {
    val setupCode = 1
    { work => Nil }
  }
} 
```

如果我将特征更改为使用长语法，则 ShortConcreteWorker 不会编译。

**有没有理由说明这些不能互换/继承？你是怎么解决的？**

现在最灵活的方法似乎是用长语法定义树，也许委托给 ShortConcreteWorker 中的实现类，如下所示：

```
case class Context
case class Work

trait ContextualWorker {
  def workWithContext(ctxt: Context): (Work) => Traversable[Work]
}

class ShortConcreteWorker extends ContextualWorker {
  override def workWithContext(ctxt: Context) = workWithContextImpl(ctxt)_ 
  private def workWithContextImpl(ctxt: Context)(work: Work) = Nil
}

class LongConcreteWorker extends ContextualWorker {
  override def workWithContext(ctxt: Context): (Work) => Traversable[Work] = {
    val setupCode = 1
    { work => Nil }
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T21:39:21.420

所描述的两种方法具有不同的签名。REPL 证实了这一点：

```
scala> def foo1(a: Int)(b: Int): Int = a + b
foo1: (a: Int)(b: Int)Int

scala> def foo2(a: Int): (Int => Int) = (b: Int) => a + b
foo2: (a: Int)Int => Int 
```

第一个是需要两个参数的函数，在单独的参数列表中给出，并返回一个`Int`. 第二个是一个函数，它接受*一个*参数并从to返回一个*函数*。虽然这两个东西在概念上是相似的，但实际上它们是不同的构造，Scala 是这样对待它们的。`Int``Int`

这不限于具有多个参数列表的函数。它在这里的工作方式相同：

```
scala> def foo3(a: Int): Int = a + 1
foo3: (a: Int)Int

scala> def foo4: (Int => Int) = (a: Int) => a + 1
foo4: Int => Int 
```

请注意，使用也有不同的后果。使用`foo2`, 因为它只接受一个参数，所以我们可以只用一个参数调用它。然而，`foo1`需要两个参数，一个所以我们不能简单地用一个来调用它。但是，您*可以*使用`_`语法将其转换为可调用函数。

```
foo2(2)    // Int => Int = <function1>
foo1(2)    // error: missing arguments for method foo1
foo1(2) _  // Int => Int = <function1> 
```

所以直接回答你的问题：它们不可互换的原因是因为它们不一样。如果它们相同，我们将能够以相同的方式调用它们。如果您可以在扩展时更改签名，那么 Scala 怎么知道允许哪种调用语法？“解决”这个问题的方法是简单地使签名保持一致。

# php - 在php中组合数组

> ID：10390709
> 
> 赞同：1
> 
> 时间：2012-04-30T21:16:39.030
> 
> 标签：php, arrays, associative

假设我想组合 2 个数组，这些数组是名称 $year_into 和 $likes_dislikes。他们共享一个名为“名称”的密钥。我怎样才能做到这一点：

$year_info

```
Array
(
    [0] => Array
        (
            [name] => JOE MONROE
            [year] => 1950
            [info] => his ghost still haunts us
        )
    [1] => Array
        (
            [name] => FUTUREMAN
            [year] => 1930
            [info] => RIP
        )
) 
```

还有这个 $likes_dislikes

```
Array
(
    [0] => Array
        (
            [name] => JOE MONROE
            [likes] => cornbread
            [dislikes] => pain
        )
    [1] => Array
        (
            [name] => E. Case
            [likes] => chaos
            [dislikes] => order
        )
    [2] => Array
        (
            [name] => FUTUREMAN
            [likes] => mustard
            [dislikes] => mayo
        )
) 
```

可以组合成一个数组 $complete，如下所示，如果“name”值匹配，则将来自第二个数组的信息添加到第一个数组中：

```
Array
(
    [0] => Array
        (
            [name] => JOE MONROE
            [year] => 1950
            [info] => his ghost still haunts us
            [likes] => cornbread
            [dislikes] => pain
        )
    [1] => Array
        (
            [name] => FUTUREMAN
            [year] => 1930
            [info] => RIP
            [likes] => mustard
            [dislikes] => mayo
        )
) 
```

我查看了已经提出的问题，但没有看到任何内容，也许我使用了错误的术语来描述问题。我被困在 foreach 循环中，因为如果我这样说

```
foreach ($year_info as $y){
    $complete[]=array('name'=>$y['name'], 'year'=>$y['year'], 'info'=>$y['info'], 'likes'=$likes_dislikes[0]['likes'],'dislikes'=>$likes_dislikes[0]['dislikes'] )
} 
```

我会为所有人的喜欢/不喜欢得到相同的值。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:26:07.540

这是一个疯狂的单线（我想它在技术上算作一条线），应该可以。

```
$complete = array_map(function($a) use($likes_dislikes){
    foreach($likes_dislikes as $ld){
        if($a['name'] === $ld['name']){
            return $a + $ld;
            break;
        }
    }
}, $year_info); 
```

这仅适用于 PHP 5.3+，否则您可以这样做：

```
$complete = array();
foreach($year_info as $a){
    foreach($likes_dislikes as $ld){
        if($a['name'] === $ld['name']){
            $complete[] = $a + $ld;
            break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:22:04.280

超级懒惰，额外说明性的方法：

```
$complete = array();

foreach($year_info as $yr){
  $name = $yr['name'];
  foreach($likes_dislikes as $ld){
    if($ld['name']!=$name){
      continue;
    }else{
      $new_entity = array();
      $new_entity['name'] = $name;
      $new_entity['year'] = $yr['year'];
      $new_entity['info'] = $yr['info'];
      $new_entity['likes'] = $ld['likes'];
      $new_entity['dislikes'] = $ld['dislikes'];
      $complete[] = $new_entity;
      break;
    }
  }
} 
```

尽管这在大型数组中表现不佳，但如果可能，更改数据结构会更有意义。最好有简单地按名称键入的数据结构。你能控制你的输入吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T21:23:10.957

只需遍历两个数组即可创建第三个数组。

```
$complete = array();
foreach ($year_info as $year) {
foreach ($like_dislikes as $like {
if ($year['name'] == $like['name']) {
$complete[] = array_merge($year, $like);
}
}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T21:24:23.000

我会尝试做的是遍历两组数组（嵌套的 foreach 循环是一个不错的选择），检查两个数组中名称属性相同的实例。当它们存在时，您可以使用 array_merge() 将它们合并到一个新数组中。一个例子是：

```
$newArray = array();
foreach ($arr1 as $first) {
    foreach ($arr2 as $second) {
        if($first["name"] == $second["name"]){
            array_push($newArray, array_merge($first, $second));
        }
    }
} 
```

假设您将数组命名为 $arr1 和 $arr2。

# php - Highcharts 图表的格式数据

> ID：10390714
> 
> 赞同：1
> 
> 时间：2012-04-30T21:16:53.323
> 
> 标签：php, highcharts

我正在尝试从 mysql 创建 Highcharts 图表，我有这样的代码：

```
 xAxis: {
   categories: [<?php  echo  implode($column, ','); ?>]
 } 
```

并且列已从 mysql 中获取：

```
 $column = array();
  $column[] = $row['blabla']; 
```

我实际得到的是：

```
 xAxis: {
   categories: [data1,data2,data3,data4,data5]
 } 
```

但它必须是这样的：

```
 xAxis: {
   categories: ["data1","data2","data3","data4","data5"]
 } 
```

我怎样才能像这样格式化它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T00:38:30.460

[`json_encode`](http://php.net/manual/en/function.json-encode.php)会将您的字符串数组格式化为 JSON 对象，包括转义等，然后可以使用以下内容将其传递给 HighCharts：

```
xAxis: {
    categories: <?php echo json_encode($column); ?>
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T18:36:57.897

这也可以。

> 类别： ["<\?php echo implode($column, '","'); ?>"]

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-01T00:35:25.580

只需输入带引号的数据。

`$column[] = '"'.$row['blabla'].'"';`

# sql - 如何从 SQL Server 2008 地理线获取纬度经度？

> ID：10390717
> 
> 赞同：2
> 
> 时间：2012-04-30T21:17:17.333
> 
> 标签：sql, sql-server, sql-server-2008, mapping

我是地图世界的新手，我正在尝试将 SQL Server 地理线列转换回它的纬度\经度点以在地图上绘制。

这条线是这样设置的

```
Set @GeoPoly = geography::STGeomFromText('LINESTRING('+@Polyline+')',4326) 
```

有人知道怎么做吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:44:53.633

我很幸运：

```
DECLARE @g geography;
SET @g = geography::STLineFromText(
   'LINESTRING(-122.360 47.656, -122.343 47.656 )'
    , 4326
); 
SELECT @g.STPointN(1).ToString(), @g.STPointN(2).ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T08:30:06.960

Does your LineString consist of only one straight line segment connecting two points? If so, you can retrieve the latitude and longitude of those points as:

```
SELECT
  @GeoPoly.STStartPoint.Lat AS Start_Lat,
  @GeoPoly.STStartPoint.Long AS Start_Long,
  @GeoPoly.STEndPoint.Lat AS End_Lat,
  @GeoPoly.STEndPoint.Long AS End_Long; 
```

If your LineString consists of multiple line segments connecting a series of points then you can retrieve the Well-Known Text representation using the ToString() method, and then parse the resulting string into coordinate pairs by splitting on commas:

```
SELECT @GeoPoly.ToString() 
```

The result will be in the format: LINESTRING(Lon1 Lat1, Lon2, Lat2, .... , Lonn, Latn)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-12T11:10:15.910

您可以通过组合 STasText()、STRING_SPLIT()、CROSS APPLY 和 STRING_AGG() 在查询中实现此目的。这是一个示例查询：

```
WITH Links AS (
    SELECT Id, REPLACE(REPLACE(PosList.STAsText(), 'LINESTRING (', ''), ')', '') as points_string
    FROM LinkSequenceProjections
    WHERE ImportFileId = 1
    AND Id < 5
)
, Points AS (
    SELECT Id, ltrim(value) as point_string, row_number() OVER (PARTITION BY Id ORDER By Id) as Nr
    FROM Links
    CROSS APPLY STRING_SPLIT(points_string, ',')
)
, Coords AS (
    SELECT Id, Nr, CAST(value AS [varchar](max)) AS coord
    FROM Points
    CROSS APPLY STRING_SPLIT(point_string, ' ')
)
, GroupedByNr AS (
    SELECT Id, Nr, MIN(coord) AS Lon, MAX(coord) AS Lat
    FROM Coords
    GROUP BY Id, Nr
)
, GroupedById AS (
    SELECT Id, 'LINSESTRING (' + STRING_AGG(Lon + ' ' + Lat, ', ') WITHIN GROUP (ORDER BY Nr) + ')' as wkt2
    FROM GroupedByNr
    GROUP BY Id
)
SELECT Id, geography::STGeomFromText(wkt2, 4326) AS PosList2
FROM GroupedById 
```

# iphone - MWPhotoBrowser 在标签栏导航应用程序中使用时不会旋转到横向

> ID：10390722
> 
> 赞同：1
> 
> 时间：2012-04-30T21:17:34.803
> 
> 标签：iphone, landscape

我正在开发我的第一个 iOS 应用程序。这是一个简单的标签栏导航应用程序，带有链接到照片库的自定义按钮。

该应用程序将 MWPhotoBrowser 库用于图库功能。

画廊工作完美，除了它不旋转到横向方向。

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
NSLog(@"ShouldAutoRotate CALLED! - The FIELD");
return YES;}

- (IBAction)showRenderings:(id)sender {
NSMutableArray *photos = [[NSMutableArray alloc] init];
MWPhoto *photo;

photo = [MWPhoto photoWithFilePath:[[NSBundle mainBundle] pathForResource:@"field_rendering_1" ofType:@"jpg"]];
photo.caption = @"The Field Rendering 1";
[photos addObject:photo];

photo = [MWPhoto photoWithFilePath:[[NSBundle mainBundle] pathForResource:@"field_rendering_2" ofType:@"jpg"]];
photo.caption = @"The Field Rendering 2";
[photos addObject:photo];

photo = [MWPhoto photoWithFilePath:[[NSBundle mainBundle] pathForResource:@"field_rendering_3" ofType:@"jpg"]];
photo.caption = @"The Field Rendering 3";
[photos addObject:photo];

_photos = photos;

// Create MWPhotoBrowser
MWPhotoBrowser *browser = [[MWPhotoBrowser alloc] initWithDelegate:self];

browser.displayActionButton = YES;
browser.wantsFullScreenLayout = YES;
[browser setInitialPageIndex:0];

[self.navigationController pushViewController:browser animated:YES]; 
```

}

`- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation`我在我的视图控制器和 MWPhotoBrowser 中检查了所有内容。他们都返回YES。

为什么 MWPhotoBrowser 不旋转到横向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-25T06:00:55.940

在这种情况下，当您将导航控制器用于多个方向时，您需要创建 UINavigationController 的子类，然后在该子类中为方向支持编写适当的代码，然后在您的应用程序中使用它。[这里](http://www.disalvotech.com/blog/app-development/iphone/ios-6-rotation-solution/)有一些示例代码，所以你可以看看..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T17:55:35.120

正如您在问题中的评论所写的那样，我遇到了同样的问题。

我的问题是我使用的是 Tabbar。Tabbar 和旋转的秘诀在于，tabbar 中的所有视图控制器都必须支持横向模式。通过在此方法中返回 YES 来执行此操作：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
```

参考：[为什么我的 UITableView 不会旋转？](https://stackoverflow.com/a/686005/373455)

修正后对我来说就像魅力一样！

# c# - 从控制器构造函数中选择数据库

> ID：10390728
> 
> 赞同：1
> 
> 时间：2012-04-30T21:18:13.437
> 
> 标签：c#, asp.net-mvc-2

在这里做一些奇怪的事情。为安全起见，项目经理希望此 ASP.Net MVC Web 应用程序为每个客户端使用单独的数据库。我已经知道我将使用 DataContext 类的重载，该类接受连接字符串作为“热交换”到另一个数据库的参数。我面临的问题是我*知道*我不想在每个动作中都写这个逻辑，读入 URL 的第一个参数（在这种情况下是客户端的名称）并选择他们的数据库来构建DataContext 反对。

所以..我怎样才能获取这些数据并以某种方式装配它来创建 DataContext 是控制器的构造函数，它使用一些值来连接到正确的数据库？

我希望这是有道理的。更多详细信息——Web 应用程序将为多个客户端运行，每个客户端都有自己的数据库，其中包含供应商、项目、设置等……我真的不确定这里有哪些相关数据。:P 请原谅我！

**编辑**：为什么投反对票？如果我以错误的方式接近某事......你能给我一个提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:23:34.037

看起来我要回击并解释这是可扩展性的一个大问题，而是使用`Client`列来区分不同的数据集。

感谢您的输入！

# php - posts_per_page 返回一个额外的帖子

> ID：10390730
> 
> 赞同：4
> 
> 时间：2012-04-30T21:18:35.933
> 
> 标签：php, wordpress

我想获得最新的两个帖子。我正在尝试使用以下查询，但由于一些奇怪的原因，它给我返回了一个额外的帖子（总共 3 个帖子而不是 2 个）。同样，如果我在查询中输入 3，它将返回 4 个帖子。为什么会发生这种情况，我该如何解决？谢谢。

```
<?php query_posts( 'posts_per_page=2' ); ?>
    <?php if( have_posts() ) : while( have_posts() ) : the_post(); ?>
            <?php the_title(); ?>                       
        <?php endwhile; endif;?>
    <?php wp_reset_query();?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:24:27.073

做这个：

```
<?php $my_query = new WP_Query('category_name=mycatname&showposts=2'); ?>

<?php while ($my_query->have_posts()) : $my_query->the_post(); ?>

<?php the_title(); ?>

<?php endwhile; ?> 
```

不需要`wp_reset_query`；此循环可以在模板中多次使用。

`category_name=mycatname&`如果您不需要类别名称，请删除。

# c# - 调用了错误的函数或方法没有重载

> ID：10390731
> 
> 赞同：0
> 
> 时间：2012-04-30T21:18:40.820
> 
> 标签：c#, function, methods

我有一个函数，用于在用户浏览目录后验证某些文本框的内容。

```
private void CheckValidation(object sender, EventArgs e)
{
    bool OK = true;
    if (PhotograherNumber.Text == string.Empty || errorProvider1.GetError(PhotograherNumber)!="")
    {
        OK = false;
    }
    if (EventNumber.Text == string.Empty || errorProvider1.GetError(EventNumber)!="")
    {
        OK = false;
    }
    if (OK)
    {
        EnableProcessNow();
    }
    else
    {
        DisableProcessNow();
    }

} 
```

这很好用。

`Validated`但后来我在文本框上 添加了事件要调用的函数。

一旦我这样做了，它就创建了这个：

```
private void CheckValidation()
{

} 
```

`Validated`同样，这对Event来说不是问题。但是，在我程序的另一部分中，我调用了 function `CheckValidation();`。但是当我这样做时，它不会调用正确的。

显然，如果我删除空的

```
private void CheckValidation()
{

} 
```

然后我收到错误“方法检查验证没有重载需要 0 个参数”。

那么我如何`CheckValidation`从我的代码中调用正确的但仍然确保我仍然可以从事件中调用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T21:23:47.977

根据我对您的问题的理解，您想运行相同的方法，但都能够在没有参数的情况下手动调用它并允许它成为事件处理程序？

如果您想从代码中调用处理程序方法，您可以调用`CheckValidation(null, EventArgs.Empty);`- 但是更好的解决方案是将代码放入`CheckValidation()`重载（不带参数）并从处理程序调用：

```
private void CheckValidation(object sender, EventArgs e)
{
    CheckValidation();
}

private void CheckValidation()
{
    // Code here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:21:46.670

如果您没有使用 CheckValidation 方法作为某些事件处理程序，则只需从此函数中删除参数。你可以这样称呼它`CheckValidation();`。如果此方法用作某些事件处理程序，则还要从 CheckValidation 方法中删除参数（无论如何您不使用它们）并在该事件处理程序中调用它：

```
private void SomeEventHandler(object sender, EventArgs e)
{
    CheckValidation();
} 
```

还可以考虑从您的方法中删除布尔标志：

```
private void CheckValidation()
{
    if (PhotograherNumber.Text == "" || errorProvider1.GetError(PhotograherNumber)!= "")
    {
        DisableProcessNow();
        return;
    }

    if (EventNumber.Text == "" || errorProvider1.GetError(EventNumber)!= "")
    {
         DisableProcessNow();
         return;
    }

    EnableProcessNow();
} 
```

更进一步，我将创建描述您实际检查的内容的方法：

```
private void CheckValidation()
{
    if (!IsAllInputValid())
    {
        DisableProcessNow();
        return;
    }

    EnableProcessNow();
}

private bool IsAllInputValid()
{
    if (!HasValidInput(PhotograherNumber))
        return false;

    if (!HasValidInput(EventNumber))
        return false;

    return true;
}

private bool HasValidInput(TextBox textBox)
{
    if (String.IsNullOrEmpty(textBox.Text)
        return false;

    return errorProvider1.GetError(textBox) != "";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:28:53.917

如果您调用`CheckValidation();`它将运行不带参数的重载。如果调用`CheckValidation(null, EventArgs.Empty);`它，它将使用对象、EventArgs 参数运行重载。

确保您的外部调用传递了正确数量的参数来完成这项工作。

就个人而言，如果我调用表单事件使用的方法，我将`this`作为发送者传递，但这取决于您使用的模型和您的对象安全性（某些对象不能安全地传递）。

```
objectReference.CheckValidation(this, EventArgs.Empty); 
```

另请注意，如果您在外部调用该方法，则它必须是公共的，并且必须从类的实例中调用（除非该方法是静态的，必须从类型名称中调用它）。

# php - Doctrine2：发现表的最后一个 ID？

> ID：10390735
> 
> 赞同：0
> 
> 时间：2012-04-30T21:19:01.620
> 
> 标签：php, symfony, doctrine-orm

我正在编写一个查询，我必须使用 Doctrine 发现表中最后插入的项目的 ID。

我不得不：

```
$this->getDoctrine()->getConnection()->prepare("SELECT MAX(id) FROM Commit"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T06:04:39.897

当您刷新时，Doctrine 会将实体 id 分配给您的实体。假设您的实体是：

```
class MyEntity {
  protectd $id;

  public function getId() {
     return $this->id;
  }

  public function setId($id) {
     $this->id = $id;
  }
} 
```

当您执行 EntityManager::flush() 时，最后插入的 Id 将分配给 $id 属性。然后您只需执行 $myEntity->getId() 即可获取最后插入的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T11:56:08.867

正如 Cerad 所说，您真的不应该通过执行另一个查询来检索您的实体 ID。相反，您可以让实体管理器使用它在插入时获得的标识符填充（更新）您的实体。一个例子是..

```
$myEntity = new \Entities\MyEntity();
$myEntity->setProperty($someValue);

// Save my entity ($em = EntityManager)
$em->persist($myEntity);

// Flush my entity manager
try {
   $em->flush();
} catch (\Exception $e)
{
}

// Refresh my entity (populate the identifier)
$em->refresh($myEntity);

// Tada
echo $myEntity->getId(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T06:58:09.633

Doctrine 没有任何方法可以做到这一点，flush 仅在最近插入时才有效，并且仅适用于插入它的用户。但是，如果您不想查询该表，因为它很大或因为其他原因，您可以创建另一个表来存储该 ID，并在每次某些用户向该表添加新元素时更新该表。如果你不想那样做，那么你必须按照你说的去做。

# c++ - 当线程在 PThreads 或 Windows 中退出时调用函数

> ID：10390738
> 
> 赞同：8
> 
> 时间：2012-04-30T21:19:24.053
> 
> 标签：c++, windows, linux, multithreading, pthreads

我正在为 Linux（带有 PThreads）和 Windows（带有内置 WinThreads）创建一个 C++ 库，它可以附加到任何程序，并且需要在线程退出时调用一个函数，类似于 atexit 的工作原理过程。

我知道 pthreads 的 pthread_cleanup_push 和 pthread_cleanup_pop ，但它们对我不起作用，因为它们是添加另一个词法范围的宏，而我想在第一次调用我的库时声明这个函数，然后允许程序本身运行它自己的代码，但它需要。我在 Windows 中没有发现任何类似的东西。

请注意，这并不意味着我希望在线程停止时提醒外部线程，甚至我可以更改线程退出的方式，因为这是由程序本身控制的，我的库只是附加的乘车。

所以问题是：**在这种情况下，当我无法控制线程的创建或销毁方式时，在 Windows 或 Linux 中，当线程关闭时调用我编写的函数，最好的方法是什么？ ?**

例如在主程序中：

```
void* threadFunc(void* arg)
{
    printf("Hello world!\n");
    return NULL;
}

int main(int argc, char** argv)
{
    int        numThreads = 1;
    pid_t*     pids       = NULL;
    pids     = (pid_t*)     calloc(sizeof(pid_t), numThreads);

    pthread_create(&ntid, NULL, threadFunc, &nVal);
    pthreads[0] = ntid;

    pthread_join(pthreads[0], NULL);
    return 0;
} 
```

在图书馆：

```
void callMeOnExit()
{
    printf("Exiting Thread!\n");
} 
```

我希望在线程达到 return NULL 时调用 callMeOnExit；在这种情况下，以及当主线程到达时返回 0;。包装 pthread_exit 将适用于其他情况，并且可能是一种解决方案，但如果可能的话，我想要一个更好的解决方案。

如果有人对我如何能够做到这一点有任何想法，那就太好了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T19:31:23.257

因此，经过几次代码审查后，我们能够在 Linux 中找到一种更优雅的方式来执行此操作，它既符合 Windows 对 Fibers 所做的（正如 Neeraj 指出的那样），也符合我开始研究时期望找到的内容这个问题。

关键是[pthread_key_create](http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_key_create.html)作为第二个参数接受一个指向析构函数的指针，当任何已初始化此 TLS 数据的线程死亡时调用该析构函数。我已经在每个线程的其他地方使用了 TLS，但是一个简单的存储到 TLS 中也可以获得这个功能，以确保它被调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T23:14:32.683

改变这个：

```
pthread_create(&ntid, NULL, threadFunc, &nVal); 
```

进入：

```
struct exitInformData
{
   void* (CB*)(void*);
   void* data;
   exitInformData(void* (cp*)(void*), void* dp): CB(cp) data(dp) {}
};
pthread_create(&ntid, NULL, exitInform, new exitInformData(&threadFunc, &nVal)); 
```

然后加：

```
void* exitInform(void* data)
{
    exitInformData* ei = reinterpret_cast<exitInformData*>(data);

    void* r = (ei.CB)(ei.data);   // Calls the function you want.
    callMeOnExit();               // Calls the exit notification.
    delete ei;
    return r;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-05T17:43:14.220

对于 Windows，您可以尝试[Fls Callbacks](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682665%28v=vs.85%29.aspx)。它们的 FLS 系统可用于为每个线程分配（忽略“光纤”部分，每个线程包含一根光纤）存储。您获得此回调以释放存储空间，但也可以在回调中执行其他操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T22:06:12.113

我发现[这](https://stackoverflow.com/questions/9612775/run-function-when-pthread-exits)已经被问过了，尽管当时给出的解决方案可能与您想要的不同......

另一个想法可能是简单地从 pthread_t 类/结构扩展，并覆盖 pthread_exit 调用以根据需要调用另一个函数，然后调用超类 pthread_exit

# javascript - 我可以从手机上触摸的 div 中清除焦点吗？

> ID：10390743
> 
> 赞同：1
> 
> 时间：2012-04-30T21:20:08.290
> 
> 标签：javascript, jquery, android, mobile

我有一个用于桌面和移动设备的页面，该页面具有允许用户触摸并按住它们进行调整的按钮。[这个 jsfiddle](http://jsfiddle.net/ianb/XMbFU/)说明了这种行为。

问题是在我的 Android 手机上，作为按钮的 div 被突出显示。然后它将不再响应触摸事件，直到焦点从它身上移开（通过按下另一个按钮）并返回到它。

是否可以清除或禁用元素的焦点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T13:19:54.263

e.preventDefault 会是一个选项吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:34:23.427

你可以试试 $("#id").blur()，或者只关注其他东西，比如 $("#otherid").focus()

# jquery - jquery动画延迟

> ID：10390745
> 
> 赞同：1
> 
> 时间：2012-04-30T21:20:15.373
> 
> 标签：jquery, jquery-animate, delay, opacity, fadein

我希望用更少的代码编写以下内容。基本上，我想学习一种更面向对象的方法来编写一个循环，该循环将遍历#canvas，找到每个孩子，将其淡入，然后在短暂延迟后继续下一个。

```
$(document).ready(function(){
    $(".g").find('img').hide();
    do_anim();
});
function do_anim(){
    $('#g1').find('img').fadeIn(300);
    $('#g2').find('img').delay(600).fadeIn(300);
    $('#g3').find('img').delay(1200).fadeIn(300);
    $('#g4').find('img').delay(1800).fadeIn(300);
    $('#g5').find('img').delay(2400).fadeIn(300);
    $('#g6').find('img').delay(3000).fadeIn(300);
    $('#g7').find('img').delay(3600).fadeIn(300);
    $('#g8').find('img').delay(4200).fadeIn(300);
}; 
```

我的 HTML 结构是：

```
<div id="canvas">
<div id="g1" class="g"><img src="_img/g1.png" width="83" height="101" class="g1" /></div>
    <div id="g2" class="g"><img src="_img/g2.png" width="99" height="58" class="g2" /></div>
    <div id="g3" class="g"><img src="_img/g3.png" width="96" height="58" class="g3" /></div>
    <div id="g4" class="g"><img src="_img/g4.png" width="78" height="86" class="g4" /></div>
    <div id="g5" class="g"><img src="_img/g5.png" width="140" height="99" class="g5" /></div>
    <div id="g6" class="g"><img src="_img/g6.png" width="99" height="45" class="g6" /></div>
    <div id="g7" class="g"><img src="_img/g7.png" width="97" height="60" class="g7" /></div>
    <div id="g8" class="g"><img src="_img/g8.png" width="83" height="102" class="g8" /></div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:23:51.300

未测试，但试试这个：

```
$(document).ready(function(){
    $(".g img").hide().each(function(i){
        $(this).delay(i*600).fadeIn(300);
    });
}); 
```

# python - 我将如何修改 jinja2 以在包含的文件中保留 CSS 和 JavaScript 以及相应的 HTML？

> ID：10390746
> 
> 赞同：1
> 
> 时间：2012-04-30T21:20:18.527
> 
> 标签：python, jinja2

这是我有史以来第一个关于 SO 的问题，我很高兴提出任何改进建议。要温柔 ：）

为了提高可维护性，我试图将 CSS、JS 和 HTML 放在同一个文件中。这对于包含文件或宏等变得很困难。最终输出`template.render()`应该抓取所有 CSS 和 JS，并将其放置在基本 HTML 模板的顶部和底部。

示例应该解释我的意思：

**base.html**

```
<html>
<head>
  <style>
    {{ print_css() }}
  </style>
</head>
<body>
  {% include 'bolded_text.html' %}
  <script>
    {{ print_js() }}
  </script>
</body>
</html> 
```

**加粗文本.html**

```
{# this doesn't need to be a filter. It could be a block, or anything else that would make this work #}
{% filter add_css %}
   strong {
     background: #ccc;
   }
{% endfilter %}
<strong>Bolded text</strong>
{% filter add_js %}
   alert('javascript included!');
{% endfilter %} 
```

输出当然是：

```
<html>
<head>
  <style>
    strong {
      background: #ccc;
    }
  </style>
</head>
<body>
  {% include 'bolded_text.html' %}
  <script>
    alert('javascript included!')
  </script>
</body>
</html> 
```

可以预见，问题是 print_css() 什么也不输出。

我尝试使用上下文过滤器执行此操作，在上下文中的位置`add_js`和附加到变量，`add_css`然后输出该变量。这对于 JavaScript 来说工作得很好而且很简单，因为 print 语句遵循所有的过滤器。`print_css``print_js`

但是，我想不出一种使它与 CSS 一起工作的方法。如果我可以使`print_css()`调用变得懒惰，或者以某种方式在 jinja2 AST 中交换输出，那可能会起作用。我试图避免 hacky 字符串操作（例如在底部输出 CSS，然后使用正则表达式将其移动到顶部）。

我想可能有一种方法可以优雅地做到这一点，而我对 jinja2 的低级 API 的经验是有限的。

非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T13:37:51.087

[宏](http://jinja.pocoo.org/docs/templates/#macros)会做到这一点，但我不明白为什么你不使用样式表，这使浏览器能够更好地缓存并且也更容易维护。

**编辑**：

例子：

```
{% macro generate_css(strong_bg='#ccc', additional_options=None) -%}
    strong {
        background: {{ strong_bg }};
    }
{%- endmacro %}

<head>
  <style>
    {{ generate_css() }}
  </style>
</head> 
```

# php - PHP 链接参数引导我到 localhost/xampp，而不是运行它应该运行的脚本

> ID：10390747
> 
> 赞同：0
> 
> 时间：2012-04-30T21:20:31.333
> 
> 标签：php, html

“changeUserRole”操作总是将我带到 localhost... 这是 xampp index.php，而不是 myproject/index.php?setting=userlist。我不明白为什么我在不同的文件中为不同的设置实现了相同的技术。

它应该重定向到的文件是 action_changeuserrole.php，它运行 SQL 查询并重定向回这个文件，只是没有参数。

```
function showUserlistManagement() {  

if (@$_GET['action'] == "addUser") {
    require_once('actions/userlist/adduser.php');
}
else if (@$_GET['action'] == "changeUserRole" ) {
    require_once('actions/userlist/action_changeuserrole.php');
}
else {
    echo "<a href='?setting=userlist&action=addUser'><button>Add User</button></a>";

    $i = 0;
    $sql = "SELECT doctorID, username, isAdmin FROM doctor ORDER BY isAdmin DESC";
    $result = query($sql);

    echo "<table border='1'>";
    while ($row = mysql_fetch_array($result)) {
        $i = $i + 1;
        echo "<tr><td>" . $i . "</td><td>" . $row['username'] . "</td><td>" . isAdminText($row['isAdmin']) . "</td><td><a href='?setting=userlist&action=changeUserRole&userID=" . $row['doctorID'] . "&userRole=" . $row['isAdmin'] . "'><button>" . changeUserRoleButton($row['isAdmin']) . "</button></a></td></tr>";
    }
}

function isAdminText($isAdmin) {
    if ($isAdmin) {
        return "admin";
    }
    else return "user";
}

function changeUserRoleButton($isAdmin) {
    if ($isAdmin) {
        return 'Demote';
    }
    else return 'Promote';
}

} 
```

action_changeuserrole.php 文件：

```
<?php
    //$sql = "UPDATE doctor SET (isAdmin = '1') WHERE doctorID = " . $_GET['userID'];        
    //$result = query($sql);
?>

<meta http-equiv='refresh' content='0; URL=../../index.php?setting=userlist'> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:35:32.743

很难理解你在问什么以及你的代码中到底发生了什么，但这也许会有所帮助。

由于路径是相对的，它引导您将取决于当前 url 是什么（或基本标记值）。

如果您的网址是：

`foo/bar/something/something/test.php`

`../../index.php`然后会导致：

`foo/bar/index.php`

另一方面，如果您的网址是：

`foo/bar/test.php`

`../../index.php`然后会导致：

`index.php`

为了帮助缓解这种情况，有些人`<base>`在他们的 HTML 中使用了这个标签。此标记允许您指定所有相对 URL 将用于计算最终路径的基本 URL。不能 100% 确定这是否适用于元刷新。你将不得不测试。

# python - 修改 TabularInline 中元素的呈现方式

> ID：10390749
> 
> 赞同：2
> 
> 时间：2012-04-30T21:20:43.037
> 
> 标签：python, django, django-admin

对于这个特定的管理页面，我想将“当前值”（用红色圆圈标出）变成一个链接，该链接可以返回到该特定对象的管理页面。

但我找不到去哪里做这个改变。我知道我需要以某种方式覆盖它的显示方式，但我无法弄清楚。

我需要重写什么来做我想做的事？

![当前管理界面](../Images/9128afb771576750b1b41ca3ecc942f9.png)

管理模型定义：

```
class FirmwareConfigElementsChoiceInline(admin.TabularInline):
    model = FirmwareConfigElements
    extra = 1

class FirmwareConfigAdmin(admin.ModelAdmin):
    save_as = True
    list_display = ('name', 'description')
    inlines = [FirmwareConfigElementsChoiceInline] 
```

* * *

使用 Filip 的巨大帮助，我得到了这个：

```
class FirmwareConfigElementsForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        klass = FirmwareConfigElementsForm
        super(klass, self).__init__(*args, **kwargs)

        if self.instance.type == 'incfw':
            value = self.instance.value
            url = '#'  # TODO: get the URL for the value
            hyperlink = '<a href="%s">%s</a>' % (url, value)
            label = self.fields['type'].label.replace(value, hyperlink)
            self.fields['type'].label = label 
```

但在上面的代码`self.fields['type'].label`中，内容`Type`并不`Include another FW Config - BASE:IBM-HS22/HS22V`像我预期的那样。

我已经在调试器中对其进行了探索，但我无法弄清楚如何获得我想要更改的特定标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:46:32.307

内联管理模型有一个[模板属性](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#inlinemodeladmin-options)，您可以使用它来提供自定义模板。从那里，您需要修改代码以添加 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T11:32:06.310

您需要为`ModelForm`模型提供一个自定义`FirmwareConfigElements`，将其设置为`FirmwareConfigElementsChoiceInline.form`类属性的值。

在这里，您需要覆盖`ModelForm.__init__()`实例方法，以便在绑定表单时为要覆盖的字段分配新标签：

```
class FirmwareConfigElementsForm(models.ModelForm):
    def __init__(self, *args, **kwargs):
        klass = FirmwareConfigElementsForm
        super(klass, self).__init__(*args, **kwargs)

        if form.is_bound and 'value' in self.data:
            value = self.data['value']
            url = ''  # TODO: get the URL for the value
            hyperlink = '<a href="%s">%s</a>' % (url, value)
            label = self.fields['type'].label.replace(value, hyperlink)
            self.fields['type'].label = label

class FirmwareConfigElementsChoiceInline(admin.TabularInline):
    model = FirmwareConfigElements
    extra = 1
    form = FirmwareConfigElementsForm 
```

现在，如果您希望标签随着用户更改表单数据而动态更改，那么它会变得更加丑陋，您将不得不求助于[引用 JavaScript 媒体](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#modeladmin-media-definitions)并即时执行上述操作。

# ruby - 为什么在转换为字符串然后转换为符号时，空数组和哈希的处理方式不同？

> ID：10390752
> 
> 赞同：3
> 
> 时间：2012-04-30T21:20:58.743
> 
> 标签：ruby

在 Ruby 中，为什么这两个操作对于空数组和散列是不同的？

空数组：

```
[].to_s.to_sym => :[] 
```

空哈希：

```
{}.to_s.to_sym => :"{}" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T21:28:35.837

它们并没有真正的不同，只是它们的显示方式不同。该`{`字符不能作为符号的开头，因此用引号引起来。如果你想创建一个包含 a 的符号，你会做同样的事情`-`，否则它会被解释为减法运算符。事实上，您可以进入 IRB 并测试引号不会真正影响交易品种。

```
:[] == :"[]" #=> true 
```

因此，基本上，一个可以使用更短的形式，而另一个必须更详细，以便解析器能够理解它。但两者的含义或形式没有本质区别。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T21:27:27.777

因为 [] 的字符串表示是“[]”，而 {} 的字符串表示是“{}”。顺便说一句，`:[]`等于`:"[]"`。不同之处在于你可以写`:"[]"`不带括号的符号，但你不能这样做，因为`:"{}"`Ruby 语法不允许这样做。

# php - 如果我在 php 类中有超过一百个数据成员（变量），它会显着变慢吗？

> ID：10390754
> 
> 赞同：1
> 
> 时间：2012-04-30T21:21:32.620
> 
> 标签：php, oop, class

我有一个名为 Vehicle 的 PHP 类，它管理与汽车、摩托车和卡车有关的一切。我有一百多个与汽车、自行车、卡车表中的每个数据库字段相关联的私有变量。

例如：一辆车有：-油耗-最大马力-最大扭矩..等等..所以我有数据成员

```
private $fuel;
private $horsepower;
private $toque; 
```

当我进行数据库查询以通过 id 查找汽车时，我将所有行存储在其相应的变量中。

car 表有大约 50 个字段，bikes 表有 30 个字段，而卡车有 30 个字段。所以有超过110个数据成员。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:24:15.717

继承和多态是你的朋友！汽车应该是一类（有 50 个属性），自行车 - 另一个（30 个属性），卡车 - 另一个（30 个属性）。它们都应该扩展 Vehicle 基类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:24:59.290

您可以尝试[延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)：在构造函数（或任何获取汽车 id 的函数）中，您只将 id 存储在类中，并且对于每个其他变量，您只在真正需要时从数据库加载它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:27:24.370

除了代码管理之外，变量的数量很少有影响。利用多态性的面向对象编程是保持域对​​象井井有条的第一步。一旦你有了它，你可以研究一个 ORM（对象关系映射）来获取和从 db [PHP Active Record](http://www.phpactiverecord.org/)获取变量将是一个很好的起点。

另外，当您说“自行车有 30 行”时，您的意思是字段，对吗？通常，如果您有一个用于“自行车”的数据库表，则每一行都是不同的自行车，每个字段都是给定自行车的不同属性。

# reporting-services - SSRS 向他人报告访问权限

> ID：10390756
> 
> 赞同：1
> 
> 时间：2012-04-30T21:21:40.403
> 
> 标签：reporting-services

我在装有 IIS 7.0 的 PC 上开发了一份 SSRS 2008 报告。目前，我可以访问报告。如何通过我的本地主机向其他人提供能够查看报告的权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T10:54:44.187

如果您在域组中，您应该可以。也许其他用户无权访问您的计算机（似乎是 SSRS 的本地实例）。

您也可以尝试（当然只是为了测试）添加“所有人”并授予权限以查看他们是否可以访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:29:02.530

您应该在报告管理器中配置权限。默认情况下：[http://localhost/ReportManager](http://localhost/ReportManager)

或开始 -> 程序 -> Microsoft SQL Server 2008 -> 配置 -> Reporting Services 配置管理器

然后，您可以直接将您的用户链接到您的计算机或将 IIS 配置为指向自定义报告页面。

# xml - Oracle XMLtype 查询

> ID：10390763
> 
> 赞同：0
> 
> 时间：2012-04-30T21:22:11.943
> 
> 标签：xml, oracle

我正在努力提高 Oracle XML 学习曲线。我有一个主要包含任何级别的“错误/文本”元素的 XML 文档。我想查询文档并将每条错误消息的文本作为自己的记录。到目前为止，在我的尝试中，文本被连接在一起形成一个记录。我怎样才能让它们出现在他们自己的记录中？谢谢你。

```
with xmldoc_ as (
SELECT xmltype('
<B>
<A>
<Error><Text>Error #1</Text></Error>
</A>
<C>
<D>
<Error><Text>Error #2</Text></Error>
</D>
</C>
</B>
') object_value from dual)
select
XMLcast(
   XMLquery('//Error/Text' passing object_value returning content) 
   as varchar2(200)
) message
from xmldoc_ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T14:32:20.953

起初我想如果你把 XPath 表达式更改为

```
//Error[1]/Text 
```

它会做你想做的事，但它不会。以下稍作调整的代码将为您提供所需的内容。如果您想开始做很多与 XMLTYPE 相关的事情，最好阅读 XML 开发人员指南，因为 Oracle 可以用 XML 做很多事情。

```
with XML as
    (select xmltype(
    '<B>
<A>
<Error><Text>Error #1</Text></Error>
</A>
<C>
<D>
<Error><Text>Error #2</Text></Error>
</D>
</C>
</B>') as OBJECT_VALUE from dual
   )
   select column_value
     from XML,
          XMLTABLE
          (
             '//Error/Text/text()'
             passing OBJECT_VALUE
      )
/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T14:49:45.913

通过使用[XMLTable](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions253.htm)：

```
SQL> with xmldoc_ as
  2  ( SELECT xmltype
  3           ( '<B>
  4               <A>
  5                <Error>
  6                 <Text>Error #1</Text>
  7                </Error>
  8               </A>
  9               <C>
 10                <D>
 11                 <Error>
 12                  <Text>Error #2</Text>
 13                 </Error>
 14                </D>
 15               </C>
 16              </B>'
 17           ) object_value
 18      from dual
 19  )
 20  select text
 21    from xmldoc_
 22       , xmltable
 23         ( '//Error'
 24           passing object_value
 25           columns text varchar2(20) path 'Text'
 26         )
 27  /

TEXT
--------------------
Error #1
Error #2

2 rows selected. 
```

问候，
罗布。

# c# - MongoDb 的 .NET 驱动程序：有什么方法可以避免属性名称硬编码？

> ID：10390770
> 
> 赞同：0
> 
> 时间：2012-04-30T21:23:05.390
> 
> 标签：c#, mongodb, mongodb-.net-driver

我可以`collection.Insert<T>`用于插入实例和`collection.Save<T>`更新它们，我看不出为什么 MongoDb 的 c# 驱动程序不提供类似的方法来删除特定实例。他们的`Remove`方法要求 IMongoQuery 参数，这似乎需要硬编码属性名称，例如`Query.EQ("Id", BsonValue.Create(id))`. 我想指定整个实例来删除它`Remove<T>`，或者使用 RemoveById，或者使用特定输入类型构建类似 LINQ 的查询，或者任何其他方式来摆脱属性硬编码， - 我在 MS Entity 中使用的东西框架 POCO。有没有这样的方法？

更新：好的，我找到了一种方法：

```
IMongoQuery mq = new QueryDocument(entity.ToBsonDocument());
customers.Remove(mq); 
```

这是唯一的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T22:50:19.167

目前还没有一种方法可以满足您的要求，但它是一个经常被要求的功能。您可以为此 JIRA 请求投票支持该功能：

[https://jira.mongodb.org/browse/CSHARP-457](https://jira.mongodb.org/browse/CSHARP-457)

您发现的方法有效，但相当笨拙。它使用整个文档作为查询。是的，它确实与您尝试删除的文档相匹配，但是通过网络传输的数据比必要的要多。

# postgresql - 是否可以在 Postgres 的索引中使用稳定的函数？

> ID：10390777
> 
> 赞同：3
> 
> 时间：2012-04-30T21:23:31.380
> 
> 标签：postgresql, postgresql-9.0

我一直在从事一个工作项目，并意识到我必须在几个查询的 WHERE 子句中调用一个函数。性能并不完全*糟糕*，但我很想改进它。所以我查看了[文档](http://www.postgresql.org/docs/9.0/static/sql-createindex.html)中提到的索引：

> 索引字段可以是根据表格行的一个或多个列的值计算的表达式。

惊人的。所以我尝试创建一个索引：

`CREATE INDEX idx_foo ON foo_table (stable_function(foo_column));`

并收到一个错误：

> 错误：索引表达式中的函数必须标记为 IMMUTABLE

然后我读到了关于稳定波动率的[函数波动率类别：](http://www.postgresql.org/docs/9.0/interactive/xfunc-volatility.html)

> 特别是，在索引扫描条件中使用包含此类函数的表达式是安全的。

基于措辞“索引扫描条件”，我猜这并不意味着实际的索引。那么这是什么意思呢？是否可以在索引中使用稳定的函数？还是我们必须一路走下去，确保它可以作为一个不可变的函数工作？

我们正在使用 Postgres v9.0.1。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T22:00:05.467

“索引扫描条件”是*搜索*条件，可以使用 volatile 函数，该函数将为处理的每一行调用。索引*定义*只能使用不可变的函数——也就是说，当使用任何给定的参数集调用该函数时，该函数将始终返回相同的值，并且没有用户可见的副作用。如果您稍微考虑一下，您应该能够看到如果该函数可能返回与创建索引条目时不同的值，您会遇到什么样的麻烦。

您可能很想对数据库撒谎并声明一个函数是不可变的，这不是真的；但是如果你这样做了，数据库可能会做一些你不希望它做的令人惊讶的事情。

9.0.1 有可修复的错误。请升级到 9.0。*最近的事*。

[http://www.postgresql.org/support/versioning/](http://www.postgresql.org/support/versioning/)

# php - jQuery AJAX 数据库查询并使用结果更新 HTML 列表

> ID：10390781
> 
> 赞同：0
> 
> 时间：2012-04-30T21:23:56.183
> 
> 标签：php, jquery, mysql, html, ajax

我在搜索我的数据库和输出数据时遇到了一点问题。

这是我的模板。别介意`$page->_()`. 这是因为我的框架。想想phps`echo`

```
<?php
$movies = array();
if( isset($_POST['searchtext']) && isset($_POST['ajax']) && $_POST['ajax']==1 )
    $movies = Movie::getByTitle( $_POST['searchtext'] );
$list = '<ul id="results">'; 
if( isset( $movies ) && $movies!=null )
    foreach($movies as $movie)
         $list.= '<li>'.$movie->getTitle().'</li>';
else if( isset($_POST['ajax']) && $_POST['ajax']==1 )
    $list.='<li>No Results!</li>';
$list.= '</ul>';

if(isset($_POST['ajax']) && $_POST['ajax']==1){
    $json = array(
        'success' => true,
        'html' => $list
    );
    header('Cache-Control: no-store, no-cache, must-revalidate');
    header('Expires: 0');
    header('Content-type: text/json');
    echo json_encode($json);
    die();
}
$page->_(
'<section class="dialog-fixed small">',
    '<form id="search-form" method="post" action="#home">',
        '<fieldset>',
            '<input type="text" name="searchtext" />',
            '<input type="submit" name="moviesubmit" value="Search"/>',
        '</fieldset>',
    '</form>'
);
$page->_($list);
$page->_('</section>');
?> 
```

`Movie::getByTitle`只是做一个`SELECT * FROM movies WHERE title LIKE '%".$title."%' LIMIT 30"`查询，为每个结果创建一个电影对象并返回一个包含对象的数组

我的 jQuery AJAX 请求是这样工作的：

```
var f0 = $('#search-form');
if( f0.length>0 ) {
    f0.each(function(){
        var f = $(this);
        $(this).submit(function(ev){
            ev.preventDefault();
            $.ajax({
                type: 'post',
                url: BASEURL+f.attr('action'),
                data: f.serialize()+'&ajax=1',
                dataType: 'json',
                success: function(data) {
                    if(data.success){
                        $('#results').replaceWith(data.html);
                    }
                },
                error: function(xhr,txt,err) {
                    alert(txt+' ('+err+')');
                }
            });
        });
    });
} 
```

现在..我查询的数据库表有大约 1.000.000 行（电影），例如，如果我搜索“阿甘正传”，它工作得很好......但是如果我搜索字符较少的东西，让我们说“一个”它不会返回任何东西。我尝试在 phpmyadmin 中的数据库中搜索“One”，它返回了大约 15.000 个结果……好吧，我认为这对于我的脚本来说可能太多了，所以我放了一个`LIMIT 30`如您所见，在我的数据库查询结束时..也不起作用。在搜索“一个”之后，我没有得到任何回报，甚至没有得到应有的“无结果”（实际上它不应该，但你知道我的意思）。我的脚本只是停止工作。如果我搜索“One”之类的内容，之后我将无法搜索任何内容。甚至“阿甘正传”也没有给我任何结果。实在想不通问题出在哪里。我的萤火虫对我没有帮助；）

有什么提示吗？

编辑：好的，我发现我的问题出在哪里。json_encode($json) 不起作用。我还没弄清楚原因。此解决方案有效：script.js：

```
$.ajax({
                type: 'post',
                url: BASEURL+f.attr('action'),
                data: f.serialize()+'&ajax=1',
                dataType: 'text',
                success: function(data) {
                    if(data!=''){
                        $('#results').replaceWith(data);
                    }
                },
                error: function(xhr,txt,err) {
                    alert(txt+' ('+err+')');
                }
            }); 
```

php模板：

```
if(isset($_POST['ajax']) && $_POST['ajax']==1){
header('Cache-Control: no-store, no-cache, must-revalidate');
header('Expires: 0');
header('Content-type: text/html');
echo utf8_encode($list);
die();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:10:50.497

好的。。发现问题了。我数据库中的一些字符串不是正确的 UTF-8 ...json_encode() 有这个问题所以在我的 php 模板中我不得不更改`$list.= '<li>'.$movie->getTitle().'</li>';`为`$list.= '<li>'.utf8_encode($movie->getTitle()).'</li>';`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:29:50.007

您是否使用全文搜索？如果是这样，MySQL 在进行全文搜索时必须提供最少字符数，否则它不会返回任何内容。那将是我的第一个猜测。

这是可配置的，尽管我不知道该怎么做。这是有充分理由的，因为全文搜索通常意味着搜索巨大的巨大字符串，因此如果你只给它“一个”，它将返回许多大量的行。如果这不是您使用它的方式，那么您可能会减少字符的数量，尽管这也会让您的用户有更多的浏览量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:33:33.327

您正在搜索的字段上的索引。主索引将为您提供非重复内容，或使用全文索引。[文档中的](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)详细信息

# c# - 为什么我们不能在没有装箱的情况下覆盖值类型中的 Equals()？

> ID：10390782
> 
> 赞同：9
> 
> 时间：2012-04-30T21:23:56.813
> 
> 标签：c#

我知道我可以通过添加自己的 Equals 实现来避免装箱。

```
public struct TwoDoubles
{
    public double m_Re;
    public double m_Im;

    public TwoDoubles(double one, double two)
    {
        m_Re = one;
        m_Im = two;
    }

    public override bool Equals(object ob)
    {
           return Equals((TwoDoubles)ob);
    }
    public bool Equals(TwoDoubles ob)
    {
        TwoDoubles c = ob;
        return m_Re == c.m_Re && m_Im == c.m_Im;
    }
} 
```

我不能将其称为重载，而是称其为重载。通过运行时的魔力，它确实`Equals()`根据调用者的类型正确调用了正确的实现。

为什么我不能根据`TwoDoubles`需要覆盖和更改参数类型并让装箱通过运行时的力量发生？是因为 C# 不支持参数逆变（如果这是原因，那么为什么不支持它......似乎是一小步`object o = new TwoDoubles()`）？

**更新**
说明 ： `object`是结构继承层次结构的一部分。为什么我们不能将派生程度更高的类型指定为参数来覆盖派生程度较低的类型的实现？这将允许我们编写：

```
 public override bool Equals(TwoDoubles ob)
 {
        TwoDoubles c = ob;
        return m_Re == c.m_Re && m_Im == c.m_Im;    
 } 
```

当变量是 TwoDouble 时，即使所述变量已被装箱为对象类型，也应调用该变量。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-30T22:50:17.327

> 为什么我不能覆盖并将参数类型更改为 TwoDoubles？

因为那不是类型安全的！

```
class B
{
  public virtual void M(Animal animal) { ... }
}
class D : B
{
  public override void M(Giraffe animal) { ... }
}

B b = new D();
b.M(new Tiger()); 
```

而现在你只是将一只老虎传给了一个实际上只需要一只长颈鹿的方法！

你的情况也一样。您正在使用只能采用结构的方法覆盖采用*任何对象的方法；*这不是类型安全的。

> 是因为 C# 不支持参数类型*逆变*吗？

不，这是因为您要求参数类型*covariance*，这不是类型安全的。

C# 也不支持参数类型逆变，但这不是您所要求的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T21:38:18.510

您可以更改 的参数（重载）`Equals`，就像您所做的那样，并且将根据需要进行装箱（即，每当调用 Equals(object) 时）

因为一切都从对象继承（或通过装箱隐式继承），所以您无法阻止人们能够在您的类型上使用 Equals(object)。但是，通过这样做，您会收到一个盒装电话。

如果您可以控制调用代码，请始终使用新的重载选项，即`Equals(TwoDouble)`

请注意，正如一位评论员已经说过的，您的代码有些不正确，请改为：

```
public override bool Equals(object ob)
{
  if (ob is TwoDoubles)
    return Equals((TwoDoubles)ob);
  else
    return false;
}
public bool Equals(TwoDoubles c)
{
  return m_Re == c.m_Re && m_Im == c.m_Im;
} 
```

**按照明智的建议进行编辑**，您应该完成相同的任务，但在这种情况下使用 IEquatable 接口`IEquatable<TwoDouble>`（注意，我们所做的代码与签名匹配，因此无需更改代码）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T22:16:40.600

如果它按照您的建议工作，那么`public override bool Equals(TwoDoubles c) { return m_Re == c.m_Re && m_Im == c.m_Im; }`覆盖该`Equals(object)`方法所需的全部内容在哪里，这段代码会做什么？

```
TwoDoubles td = new TwoDoubles();
object o = td;
bool b = o.Equals(new object()); // Equals(object) overridden with Equals(TwoDouble) 
```

第 3 行应该发生什么？

*   它应该调用`Equals(TwoDouble)`吗？如果是这样，用什么参数？一个全零的默认 TwoDouble？这违反了围绕平等的规则。
*   它应该抛出一个强制转换异常吗？我们正确地遵循了方法签名，所以这不应该发生。
*   它应该总是返回false吗？现在编译器必须知道 Equals 方法的*含义*，并且必须区别于其他方法来处理它。

没有很好的方法来实现这一点，而且它很快就会导致比它解决的问题更多的问题。

# scala - 在 Scala 中期望 null。应该使用 Option 吗？

> ID：10390783
> 
> 赞同：2
> 
> 时间：2012-04-30T21:23:58.930
> 
> 标签：scala, playframework

我有一个播放模板，其中参数的最典型场景是“null”。
我知道惯用的 Scala 更喜欢 Option 。
我来自 java 的第一个直觉是使用 null。

带有 null 的情况：
在控制器中

```
views.html.addPost(errors.errorsAsJson) 
```

在视图中

```
@(errors: play.api.libs.json.JsValue = null) 
...
@if(errors != null){@errors} 
```

带选项的案例：
在控制器中

```
views.html.addPost(Option(errors.errorsAsJson)) 
```

在视图中

```
@(errors: Option[play.api.libs.json.JsValue] = None)
...
@{errors match {
      case None => {}
      case _ => {errors.get}
    }
} 
```

**更新：**我现在明白了。
代替：

```
@{errors match {
    case None => {}
    case _ => {errors.get}
 }
} 
```

我可以做

```
@errors 
```

**更新 2：** 显然我也不必对 null 进行 null 检查？也许有`Play framework`什么魔法？调用空变量无异常。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-30T21:29:59.303

原因`Option`不那么冗长，因为您不需要进行那些空值检查。换句话说，您的`match/case`冗长是不必要的。

假设我们有这两个变量：

```
val x: Option[Int] = Some(5)
val y: Option[Int] = None 
```

如果我们想调用一个函数`Some`而不是`None`，我们不需要空检查：

```
x foreach println  // prints 5
y foreach println  // nothing printed 
```

或者，如果我们想应用一个函数并获得一个新的结果，它也是类似的，并跟踪输入是否存在。

```
val f = (i: Int) => i + 1
x map f  // Some(6)
y map f  // None 
```

还有很多关于如何`Option`清理的例子，但这应该给你一个想法。

# c# - 我如何结合表达 >[]？

> ID：10390784
> 
> 赞同：5
> 
> 时间：2012-04-30T21:24:01.940
> 
> 标签：c#, linq, expression-trees

我有一个数组

```
Expression<Func<MyClass,bool>> 
```

但是，我想将它们全部组合在一起以获得该类型的单个项目。我该怎么做呢？我可以转换 Expression.And 的结果吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T22:10:20.187

如果您使用以下扩展方法：

```
public static Expression<Func<T, bool>> And<T> (this Expression<Func<T, bool>> expr1,
                                                       Expression<Func<T, bool>> expr2)
{
    var invokedExpr = Expression.Invoke (expr2, expr1.Parameters.Cast<Expression> ());
    return Expression.Lambda<Func<T, bool>>
          (Expression.AndAlso (expr1.Body, invokedExpr), expr1.Parameters);
} 
```

从这里：[http ://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)

然后你可以写这个来把它们全部折叠成一个表达式。

```
public Expression<Func<T, bool>> AggregateAnd(Expression<Func<T,bool>>[] input)
{
    return input.Aggregate((l,r) => l.And(r));
} 
```

# asp.net - 使用 asp.net 在数据列表中显示单选按钮列表

> ID：10390785
> 
> 赞同：1
> 
> 时间：2012-04-30T21:24:10.943
> 
> 标签：asp.net, datalist, radiobuttonlist

我有两个下拉列表，我想要当第一个和第二个下拉列表触发器然后填充 updatepanel_sehiri_izmir_radiolist 但我无法创建动态radiobutonlist。我认为使用datalist和radiobuton列表。但我无法运行代码

```
<asp:UpdatePanel ID="UpdatePanel_sehiri_izmir_radiolist" runat="server" ChildrenAsTriggers="True"
   UpdateMode="Conditional">
      <ContentTemplate>
      <asp:DataList ID="DataList_sehiri_izmir_yeni" runat="server" DataSourceID="SqlDataSource_sehir_izmir"
      OnItemCommand="DataList_sehiri_izmir_yeni_ItemCommand">
          <ItemTemplate>
              <asp:RadioButtonList ID="rb_sehiri_izmir" runat="server" AutoPostBack="True" RepeatDirection="Horizontal"
              CommandArgument="gonder" RepeatColumns="1" RepeatLayout="Flow" OnSelectedIndexChanged="rb_sehiri_izmir_SelectedIndexChanged">
              <asp:ListItem id="TestedYes" runat="server" Value='<%# Eval("imp_id") %>' Text='<%# Eval("imp_id") %>' />
              <asp:ListItem id="TestedNo" runat="server" Value="False" Text="No" />
              </asp:RadioButtonList>
        </ItemTemplate>
     </asp:DataList>
<asp:SqlDataSource ID="SqlDataSource_sehir_izmir" runat="server" ConnectionString="<%$ ConnectionStrings:Web_KentrehberiConnectionString %>"
    SelectCommand="SELECT * FROM [Important_places]"></asp:SqlDataSource>
    </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="drp_sehiri_izmir_ulke_adi" EventName="SelectedIndexChanged" />
            <asp:AsyncPostBackTrigger ControlID="drp_sehiri_izmir_sehir_adi" EventName="SelectedIndexChanged" />
        </Triggers>
</asp:UpdatePanel> 
```

# ruby - 使用符号读取和写入 Sinatra 参数，例如 params[:id]

> ID：10390786
> 
> 赞同：6
> 
> 时间：2012-04-30T21:24:11.113
> 
> 标签：ruby, sinatra

我的表单通过 POST 接收数据。当我这样做时，`puts params`我可以看到：

```
{"id" => "123", "id2" => "456"} 
```

现在命令：

```
puts params['id']    # =>  123
puts params[:id]     # =>  123

params['id'] = '999'
puts params          # => {"id" => "999", "id2" => "456"} 
```

但是当我这样做时：

```
params[:id] = '888'
puts params 
```

我明白了

```
{"id" => "999", "id2" => "456", :id => "888"} 
```

在 IRB 中它工作正常：

```
params
# => {"id2"=>"2", "id"=>"1"}

params[:id]
# => nil

params['id']
# => "1" 
```

**为什么我可以使用 读取值`:id`，但不能使用它设置值？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-30T21:32:16.787

Ruby 中的哈希允许将任意对象用作键。由于字符串（例如`"id"`）和符号（例如`:id`）是不同类型的对象，因此哈希可以将具有相同视觉内容的字符串和符号作为键，而不会发生冲突：

```
irb(main):001:0> { :a=>1, "a"=>2 }
#=> {:a=>1, "a"=>2} 
```

*这与 JavaScript 明显不同，在 JavaScript 中，对象的键始终是字符串。*

因为 web 参数（无论是通过 GET 还是 POST）总是字符串，Sinatra 有一个“便利”，允许您使用符号请求参数，它会在查找关联值之前将其转换为字符串。它通过使用`to_s`在查找不存在的值时调用的自定义 default_proc 来做到这一点。

这是[当前的实现](https://github.com/sinatra/sinatra/blob/71c1e2aa1855720f41c1e699006439352f97be0f/lib/sinatra/base.rb#L1083)：

```
def indifferent_hash
  Hash.new {|hash,key| hash[key.to_s] if Symbol === key }
end 
```

但是，它不提供该`[]=(key, val)`方法的自定义实现，因此您可以设置符号而不是字符串。

# c# - Flajaxian 自定义文件夹保存位置

> ID：10390794
> 
> 赞同：0
> 
> 时间：2012-04-30T21:24:43.880
> 
> 标签：c#, asp.net, ajax, flajaxian, httpfilecollection

我看到很多人想出了一些过度的方法来使用[flajaxian](http://flajaxianfileupload.codeplex.com/license)多文件上传控制即时更改文件夹位置。

只是想知道更有经验的人是否可以看看我想出的方式，让我知道是否有任何我应该关注的重大问题。（假设我有适当的错误检查。）

我计划初始化控件，如下所示。：

```
<cc1:FileUploader ID="FileUploader1" runat="server" OnFileReceived="fileUploader_FileReceived" RequestAsPostBack="true">

    </cc1:FileUploader> 
```

（我`RequestAsPostBack="true"`还有一些其他控件需要检查我的事件处理程序）

我只是更改`HttpFileCollection.SaveAs`. `fileUploader_FileReceived event`由于flajaxian 一次只上传一个文件，我们可以预期集合中只有一个文件（否则我们可以使用循环）。

```
protected void fileUploader_FileReceived(object sender, 
com.flajaxian.FileReceivedEventArgs e)
 {

        HttpFileCollection files = Request.Files;
        // Change path to whichever folder I need
        String TempFileName = "C:\\NEW\\PATH\\TO\\Folder\\" + files[0].FileName;
        // Save the file.
        files[0].SaveAs(TempFileName);
} 
```

只要文件夹存在，此实现似乎就可以很好地工作！我只是想知道这样`technically`的实现是否有任何问题，再次假设所有错误检查都已到位。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T16:22:53.643

更好的方法是使用适配器，并在 `OnFileNameDetermining`事件中重写文件夹位置。这样，我们还可以通过适配器获得所有好处。

```
<cc1:FileUploader ID="FileUploader1" runat="server"` OnFileReceived="fileUploader_FileReceived" RequestAsPostBack="true">
            <Adapters>
                <cc1:FileSaverAdapter runat="server" FolderName="Ups" OnFileNameDetermining="fileUploader_FileDetermined" />
            </Adapters>
</cc1:FileUploader> 
```

在文件确定事件中，我们可以以编程方式更改文件夹位置

```
protected void fileUploader_FileDetermined(object sender, com.flajaxian.FileNameDeterminingEventArgs e)
{
    e.FileName = "C:\\NewFolder\\" + e.File.FileName;
} 
```

我们可以使用 FileReceived 事件来检查文件夹是否存在，如果不存在，则创建它。

```
protected void fileUploader_FileReceived(object sender, com.flajaxian.FileReceivedEventArgs e)
{
     int fileIndex = e.Index;
     if (fileIndex == 0)
     {
        // We are on our first file, check if the new folder exists, if not, create it
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:15:34.230

您所做的很好，但是，如果您要在网站内保存文件，请考虑使用 MapPath 方法从网站内的虚拟路径创建物理文件夹

```
MapPath("/Images/User1") 
```

这是我的最小 APSX 实现

```
<fjx:FileUploader ID="FileUploader1" runat="server" OnFileReceived="FileUploader2_FileReceived">
</fjx:FileUploader> 
```

未指定适配器或文件夹。当 FileRecevied 事件触发时，我将文件保存到基于表单身份验证用户名的文件夹（名称不使用文件夹名称中不允许的字符）。

另请注意，FileReceivedEventArgs 引用了 (HTTP) 文件

```
e.File 
```

FileUploader 控件将显示所有已处理的文件 - 如果出现错误，您甚至可以设置状态码（例如 550），然后将其返回给客户端。

请注意，对 FileReceived 事件的服务器调用不会发生在正常页面回发中，即使您指定

```
RequestAsPostBack="true" 
```

因此，不会发生 PagePreRender。

唯一的问题是，上传完成后如何在客户端执行任何其他处理（例如显示上传的图像）。

为此我正在进行的工作是使用客户端事件

```
FileStateChanged 
```

处理最后一个文件时

```
if (file.state > Flajaxian.File_Uploading && isLast) { 
```

我使用 JQuery 单击隐藏的提交按钮。回发查看保存文件时存储的会话值，并将图像渲染回 DIV。

但是，由于某种原因，立即提交会导致 FileReceived 事件中的空会话出现问题（我假设是因为内部异步回调尚未完成）。在启动回发之前暂停几秒钟可以正常工作。

# powerpoint - Powerpoint 中的幻灯片

> ID：10390796
> 
> 赞同：0
> 
> 时间：2012-04-30T21:24:53.517
> 
> 标签：powerpoint

我有一个 pdf PowerPoint 演示文稿。在每张幻灯片上，左侧都有带有幻灯片标题的小项目符号。因此，您只需单击一个小项目符号即可转到幻灯片。每张幻灯片上还有页码。

您如何获得幻灯片上的小项目符号和页码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-19T15:20:55.840

转到**插入**，然后是**页眉和页脚**。

从这里，在**幻灯片**选项卡下，选中**幻灯片编号**框，然后单击**全部应用**

这将使幻灯片编号出现在您的页面上。

![插入 --> 页眉和页脚](../Images/f6623fccdc3e3fd78cf0a5d20152d41f.png) ![检查幻灯片编号 --> 应用到所有](../Images/9880192985c966627a264e03616ba3a9.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T14:36:27.673

在每张幻灯片上获取页码在某种程度上取决于您拥有的 PPT 版本，但基本上，您转到幻灯片母版并使用 Powerpoint 自己的命令添加幻灯片编号页脚。

至于子弹，很难确切地知道你看到了什么。它听起来不像普通的 PDF 缩略图窗格。要获得相同的效果，您可以将项目符号（实际上是任何形状）添加到幻灯片母版，添加幻灯片标题，然后将链接添加到每张幻灯片。如果您是手动完成的，那就太棒了；不过，我希望它可以用代码完成。

# ios - 从一个 UIView 类到另一个 UIView 类的手指绘画

> ID：10390801
> 
> 赞同：1
> 
> 时间：2012-04-30T21:25:17.437
> 
> 标签：ios, uitouch

我有一个 UIViewController 类，它包含 2 个自定义 UIView 类，它们是：

项目视图

绘图视图

在 UIViewController ViewDidLoad 方法中，我有以下代码：

```
- (void)viewDidLoad
{

    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    item = [[ItemView alloc] initWithFrame:CGRectMake(self.view.frame.size.width/2, self.view.frame.size.height/2, 230, 230)];
    item.opaque = NO;

    [self.view addSubview:item];

    drawing = [[DrawingView alloc] initWithFrame:self.view.frame];
    [self.view insertSubview:drawing aboveSubview:item];
    [item release];
    [drawing release];

} 
```

DrawingView 类获取 UITouches 并相应地在屏幕上绘制。

我的问题是：

除了在 ItemView 类对象的顶部之外，我可以在整个屏幕上绘制。DrawingView 类无法绘制到 ItemView。

让我用另一个词来解释它：

除 itemView 子视图区域外，DrawView 类在屏幕上工作。在 itemView 之上，DrawView 不能进行任何绘制，但除了 itemView 区域之外，它可以进行绘制。

我能做些什么？可能是什么问题？如何在所有屏幕上进行绘图，包括 ViewController 类上 addSubview 添加的 itemView 区域？

编辑：我正在添加一个屏幕截图以便更好地解释问题

**![在此图像链接中，您可以看到，我可以在白色区域上绘制，但不能在由 ItemView 类加载的图像的面上绘制。](../Images/90ed1a6f5e41e868bfc9bf77b3ee3a0f.png)**

编辑2：我发现问题与不透明度有关。在 ItemView 类中，我将添加的 UIImageView 对象 alpha 值更改为 0.5f。结果是半透明视图，现在我的手指画是可见的。然而，这不是我想要的。我想在视图的顶部绘图。我不想玩 alpha 值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T11:49:33.283

最后，我自己找到了答案。这不是我想要的，但我的解决方案基于 CALayer。

我没有使用像 ItemView 这样的自定义 UIView 类，而是在 ItemView 类中添加了以下类方法：

```
+(CALayer *)imgLayer
{
    UIImage *img = [UIImage imageNamed:@"face.png"];
    CALayer *layer = [CALayer layer];
    CGFloat nativeWidth = CGImageGetWidth(img.CGImage);
    CGFloat nativeHeight = CGImageGetHeight(img.CGImage);
    CGRect startFrame = CGRectMake(0, 0, nativeWidth, nativeHeight);
    layer.contents = (id)img.CGImage;
    layer.frame = startFrame;
    return layer;

} 
```

在我的 UIVIewController 类中，我调用了我的静态函数，如下所示：

```
 CAGradientLayer *bgLayer =  [GradientView greyGradient];
    bgLayer.frame = self.view.bounds;
    [self.view.layer insertSublayer:bgLayer atIndex:0];

    CALayer *imgLayer =[ItemView imgLayer];
    imgLayer.frame = self.view.bounds;
    [self.view.layer insertSublayer:imgLayer above:bgLayer]; 
```

它有效！现在我可以在我的图像上画画了。

# android - Android 在屏幕旋转后从嵌套的 AsyncTask onPostExecute 保存数据

> ID：10390803
> 
> 赞同：2
> 
> 时间：2012-04-30T21:25:20.833
> 
> 标签：android, android-asynctask, screen-rotation

我花了很多时间寻找解决方案并需要帮助。

我的 Android 应用程序 Activity 中有一个嵌套的 AsyncTask，我希望允许用户在处理过程中旋转他的手机，而无需启动新的 AsyncTask。我尝试使用 onRetainNonConfigurationInstance() 和 getLastNonConfigurationInstance()。

我能够保留任务；但是，在旋转之后，它不会将 onPostExecute() 的结果保存到外部类变量中。当然，我尝试过 getter 和 setter。当我在 onPostExecute 中转储变量时，就可以了。但是当我尝试从 onClick 侦听器访问变量时，它为空。

也许代码会让你清楚问题。

```
public class MainActivity extends BaseActivity {

    private String possibleResults = null;
    private Object task = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            this.task = getLastNonConfigurationInstance();

            setContentView(R.layout.menu);

            if ((savedInstanceState != null)
                            && (savedInstanceState.containsKey("possibleResults"))) {
                    this.possibleResults = savedInstanceState
                                    .getString("possibleResults");
            }

            if (this.possibleResults == null) {
                    if (this.task != null) {
                            if (this.task instanceof PossibleResultWebService) {
                                    ((PossibleResultWebService) this.task).attach();
                            }

                    } else {
                            this.task = new PossibleResultWebService();
                            ((PossibleResultWebService) this.task).execute(this.matchToken);
                    }
            }

            Button button;
            button = (Button) findViewById(R.id.menu_resultButton);
            button.setOnClickListener(resultListener);
    }

    @Override
    protected void onResume() {
            super.onResume();
    }

    OnClickListener resultListener = new OnClickListener() {
            @Override
            public void onClick(View v) {

                    Spinner s = (Spinner) findViewById(R.id.menu_heatSpinner);
                    int heatNo = s.getSelectedItemPosition() + 1;
                    Intent myIntent = new Intent(MainActivity.this,
                                    ResultActivity.class);
                    myIntent.putExtra("matchToken", MainActivity.this.matchToken);
                    myIntent.putExtra("heatNo", String.valueOf(heatNo));
                    myIntent.putExtra("possibleResults",
                                    MainActivity.this.possibleResults);

                    MainActivity.this.startActivityForResult(myIntent, ADD_RESULT);
            }
    };

    private class PossibleResultWebService extends AsyncTask<String, Integer, Integer> {

            private ProgressDialog pd;
            private InputStream is;
            private boolean finished = false;
            private String possibleResults = null;

            public boolean isFinished() {
                    return finished;
            }

            public String getPossibleResults() {
                    return possibleResults;
            }

            @Override
            protected Integer doInBackground(String... params) {
                // quite long code
            }

            public void attach() {
                    if (this.finished == false) {
                            pd = ProgressDialog.show(MainActivity.this, "Please wait...",
                                            "Loading data...", true, false);
                    }
            }

            public void detach() {
                    pd.dismiss();
            }

            @Override
            protected void onPreExecute() {
                    pd = ProgressDialog.show(MainActivity.this, "Please wait...",
                                    "Loading data...", true, false);
            }

            @Override
            protected void onPostExecute(Integer result) {
                    possibleResults = convertStreamToString(is);
                    MainActivity.this.possibleResults = possibleResults;

                    pd.dismiss();
                    this.finished = true;
            }
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {

            super.onSaveInstanceState(outState);

            if (this.possibleResults != null) {
                    outState.putString("possibleResults", this.possibleResults);
            }

    }

    @Override
    public Object onRetainNonConfigurationInstance() {
            if (this.task instanceof PossibleResultWebService) {
                    ((PossibleResultWebService) this.task).detach();
            }
            return (this.task);
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:29:45.213

这是因为您每次实例化 Activity 时都在创建 OnClickListener（因此每次您获得一个全新的、新的 OuterClass.this 引用），但是您在 Activity 实例化之间保存 AsyncTask 并保留对第一个实例化 Activity 的引用通过引用 OuterClass.this 在其中。

有关如何正确执行此操作的示例，请参阅[https://github.com/commonsguy/cw-android/tree/master/Rotation/RotationAsync/](https://github.com/commonsguy/cw-android/tree/master/Rotation/RotationAsync/)

你会看到他在他的 RotationAwareTask 中有一个 attach() 和 detach() 方法来解决这个问题。

要确认 AsyncTask 中的 OuterClass.this 引用将始终指向第一个实例化的 Activity，如果您在屏幕方向更改之间保持它（使用 onRetainNonConfigurationInstance），那么您可以使用一个静态计数器，该计数器每次由默认构造函数递增并保持在每次创建时设置为计数的实例级别变量，然后打印该变量。

# php - Chrome“卸载”图像？

> ID：10390804
> 
> 赞同：2
> 
> 时间：2012-04-30T21:25:28.570
> 
> 标签：php, google-chrome, resize

我正在编写一个 PHP 脚本来动态调整图像大小。图像 ID（来自 MySQL 数据库）是这样传入的：“http://localhost/getimage/1.htm”。

当我使用上面的 URL 直接进入脚本时，图像被完美地吐出。但是由于某种原因（仅在 Chrome 中），当我将该 URL 链接到标签时，它开始表现得很奇怪。当页面第一次加载图像加载正常，但随后加载栏旋转约 5 秒，图像突然消失，Chrome 显示“加载资源失败”错误。

有谁知道可能是什么原因造成的，如果是这样，如何阻止它？我认为它可能与 AdBlocker 有关，但我已禁用它并且它仍在发生。

干杯。

编辑：这是我正在使用的代码：

```
 header('Content-Type:'.$file['type']);
    header('Content-Length: ' . $file['bytes']);

    // Get size of original image
    list($o_width, $o_height) = getimagesize($file['src']);

    // Default width and height
    if (is_null($width)) {
        $width = $o_width;
    }

    if (is_null($height)) {
        $height = $width;
    }

    // Create image frame
    $image_p = imagecreatetruecolor($width, $height);

    // Generate image depending on source type
    switch ($file['type']) {
        case "image/jpeg":
        default:
            $image = imagecreatefromjpeg($file['src']);
            break;
        case "image/gif":
            $image = imagecreatefromgif($file['src']);
            break;
        case "image/png":
            $image = imagecreatefrompng($file['src']);
            break;
    }

    imagecopyresampled($image_p, $image, 0, 0, 0, 0, $width, $height, $o_width, $o_height);

    // Output
    imagejpeg($image_p, null, 100);
    exit; 
```

As you can see I am setting the content types. If it was the htm extension, confusing it, would that explain why the image loads correctly, and then unloads itself?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T10:46:44.543

this is not Chrome only, but IMHO it is wrong that you have this at the beginning: header('Content-Length: ' . $file['bytes']); because you don't know the actual file size, since you create the image on the fly with imagejpeg($image_p, null, 100); Try commenting out the header('Content-Length... line, it might fix it.

# wcf - 将 Ninject/Ninject WCF 扩展升级到最新版本 3.0.0.5

> ID：10390809
> 
> 赞同：9
> 
> 时间：2012-04-30T21:26:07.760
> 
> 标签：wcf, ninject, ninject-extensions

我目前在我的 WCF 服务中使用 Ninject (2.2.1.4) 和 Ninject.Extensions.Wcf (2.2.0.4)。我想升级到 Ninject (3.0.0.15) 和 Ninject.Extensions.Wcf (3.0.0.5)，看起来我不能再使用我目前的方法了。谁能给我一些关于如何让最新版本的 Ninject 与 WCF 项目一起工作的示例或帖子。

我目前的做法：

我写了一个模块：

```
public class NinjectDependencyResolver : NinjectModule
{
    public override void Load()
    {
        // Declare bindings
    }
} 
```

我将工厂属性添加到我的 .svc 文件中

```
Factory="Ninject.Extensions.Wcf.NinjectServiceHostFactory" 
```

我在 WCF 项目中添加了 Global.asax

```
public class Global : NinjectWcfApplication
{
    protected override IKernel CreateKernel()
    {
        return new StandardKernel(new NinjectDependencyResolver());
    }
} 
```

现在我可以修改我的服务中的默认构造函数并使用构造函数注入。

任何关于我如何升级的指示都表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-30T23:25:32.553

添加 Ninject.Web.Common 并从 NinjectHttpApplication 派生或使用 NuGet 包附带的 App_Start 文件。

# sql - 在 Oracle SQL 中使用外键显示文本数据

> ID：10390815
> 
> 赞同：0
> 
> 时间：2012-04-30T21:26:40.690
> 
> 标签：sql, oracle10g, foreign-keys

Oracle SQL 的新手，我认为这是一个非常直接的问题，但我找不到直接的答案。我的数据库中有一个员工表。其中一列是“emp_state”，用于显示员工居住的州。我还有一个“客户”表和一个“办公室”表，它们也都有一个“州”字段。为了减少数据库中的冗余数据量，我创建了一个“状态”表，其中包含具有相应 ID 的所有状态。我想在提到的其他表中引用此表。在设置我的表时，我应该在相关表中定义什么作为外键？应该是“State_id”还是“State_name”？我希望状态名称出现在运行的任何查询中，而不是状态 ID 对用户来说毫无意义。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:31:11.257

*   您应该使用 state_id。`join`if上 a `INT`then a的速度要快得多`VARCHAR`。
*   如果你需要这个名字，如果一个州，你应该`JOIN`放在桌子上并得到它
*   如果您打算更新州名，那么您需要更新所有相关表。如果您有一个 id，那么您只需要更新 name 列。
*   您可能不会有两次相同的州名。但如果你这样做呢？然后您必须更改它或在州名称上附加一些奇怪的数字。

所以底线：始终使用 id

# asp.net-mvc-3 - Ninject 和自定义成员资格提供程序 Mvc3

> ID：10390816
> 
> 赞同：0
> 
> 时间：2012-04-30T21:26:42.673
> 
> 标签：asp.net-mvc-3, ninject, membership-provider

> **可能重复：**
> [使用 Ninject 将存储库注入自定义成员资格提供程序](https://stackoverflow.com/questions/5596441/inject-repository-to-custom-membership-provider-with-ninject)

我已经对这个主题进行了太多搜索，最接近的答案是这里 [MVC 3 ninject custom members contextposed error](https://stackoverflow.com/questions/7305067/mvc-3-ninject-custom-membership-context-disposed-problem/10390517#10390517) 但我不知道我的应用程序中的所有细节是一个包含我的实体和存储库抽象的域当我像这样使用我的 Ninject 绑定时，实现一切正常

```
 public class NinjectControllerFactory : DefaultControllerFactory{
    readonly IKernel _kernel;

    public NinjectControllerFactory(){
        _kernel=new StandardKernel();
        AddBindings();
    }

    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType){
        return controllerType == null
            ? null
            : (IController) _kernel.Get(controllerType);
    }
 void AddBindings(){
        _kernel.Bind<IٍSomeRepository>()
            .To<EFSomeRepository>(); 
```

但我不知道如何绑定我读过的客户会员提供者，我必须通过 poperty 注入但我不知道如何，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:49:33.993

首先，您应该使用 Ninject.MVC3 而不是您自己的控制器工厂。Ninject.MVC3 负责连接所有内容，您只需在 App_Start\NinjectWebCommon.cs 中提供映射

其次，不要使用 Ninject for Membership，除非您使用的是自定义会员提供程序。即使这样，如果您不将 Ninject 和 Membership 混合使用，痛苦也会少很多。我建议不要打扰它，除非你真的知道你在做什么。

问题是 Membership 是一个静态类，它创建了 Membership Provider 的静态实例。这意味着它不会在请求结束时被销毁。有很多方法可以解决这个问题，但总的来说，按原样使用 Membership 比尝试使其与 DI 一起使用要容易得多。

您链接到的问题解决了一个特定问题，与将业务逻辑注入您的自定义成员资格提供程序有关。如果您需要这样做，那么它可能是一个不错的选择。但是，我发现大多数自定义会员提供者往往非常简单。

# git - 用于 Git 版本控制和协作的最灵活的 Open Office Word 文档格式（不是 MS Word）

> ID：10390817
> 
> 赞同：3
> 
> 时间：2012-04-30T21:26:45.653
> 
> 标签：git, github, openoffice.org, openoffice-writer

我希望在 Git 中创建一个协作式 Word 文档，并且想知道最好的格式是什么？

**我对本文档的一些松散要求是**：可以轻松添加一些简单的标记，例如粗体、斜体，可能还有一些字体大小或突出显示（没什么技术含量的）。无需太多复杂命令即可在 git 中无缝工作，因为不是项目中的每个人都会成为 git 大师，甚至可能是第一次使用的用户。轻的东西

我已经对 Microsoft Word 有偏见，因为我不想为它付费，而且它有很多我不需要的花里胡哨，坦率地说，我觉得很烦人。

我已经倾向于使用带有 ODF 格式的 OpenOffice Writer。有没有人这样做，或者对为什么这不是一个好主意有任何建议？有很多格式可供选择，比如这张图：![在此处输入图像描述](../Images/6c2bd03e3d84bca0e703e78e450742c7.png)

这有点势不可挡。

我使用 OpenOffice 的理由是它是免费的，它可以安装在大多数计算机上，而且它是开源的。这个项目也是开源的，使用开源工具似乎是真正的精神。

我知道这不是一个讨论论坛，我真的在寻找关于文件类型的明确答案，或者任何有在 Git 中对文字/文本文档进行版本控制的人的一些建议。在这个项目中使用SVN是完全不可能的，主要是因为它很烂。谢谢！

**更新：这个想法是在Github**中对此进行版本化

 **该项目是关于工程师、语言学家和其他有兴趣清理、标准化和全面改进我们用来指代计算机语言概念的语言的程序员。

下面有一个关于在 Github README 中使用[Markdown](http://daringfireball.net/projects/markdown/)的好建议，这对我来说听起来很棒，但我不确定这是否会吓跑非 github、非计算机技术人员。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T21:31:23.690

您可能已经意识到源代码控制机制往往不适合像 Word 那样对文档进行版本*控制*。相反，您可能希望考虑的是具有[Markdown](http://daringfireball.net/projects/markdown/)格式的简单文本文件，特别是因为您使用的是 GitHub。学习起来并不难，GitHub 会在显示时自动显示格式，比如 README.md。

您使用的文档类型与使用 Git 的学习曲线几乎没有关系，无论您使用什么版本控制，学习曲线都是相似的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T10:53:35.803

有许多开源文档管理系统可以处理不同程度的开放性 OoO 文档。

这有一个清单。

[http://wiki.i-rs.ru/wiki/OpenOffice.org_Solutions#Content_.26_Document_Management_Systems.2C_Search_Technology](http://wiki.i-rs.ru/wiki/OpenOffice.org_Solutions#Content_.26_Document_Management_Systems.2C_Search_Technology)

但是，我确实认为您仅解压缩 OoO 文件并将它们存储在 Git 中的建议非常优雅。我怀疑它已经完成了，可能是作为一个插件。如果该插件有办法查看提交消息，那就太好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:14:21.530

假设您想坚持使用 OpenOffice（其他答案/评论似乎表明这不是硬性要求），最新版本的 OO 允许您以未压缩的 XML 格式（在本例中为 .fodt）保存，该格式实际上非常适合存储在a VCS，尽管文件比压缩​​格式大得多，但后续版本的增量相当接近文件实际更改的大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T19:21:47.103

Markdown 是一个开放标准，许多大公司都在使用它。

您的用户可以使用一个出色的工具来编辑降价文件：

[http://markdownpad.com/](http://markdownpad.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T19:35:44.157

我会说 github 使用[kramdown](http://kramdown.rubyforge.org./quickref.html)，这是降价的超集。我支持脚注、表格和其他标准 Markdown 不支持的东西。由于您可能需要其中之一，请考虑设置支持 kramdown 的本地编辑器，或者更确切地说[是 php extras kramdown 实现](http://michelf.com/projects/php-markdown/extra/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-02T22:16:02.163

[gollum](https://github.com/github/gollum)看起来像是另一种可能的选择，尽管我对此了解不多。这是一个由 github 构建的 wiki，很惊讶没有人提到这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-02T05:00:05.570

我决定使用[wikispaces](http://www.wikispaces.com)的 wiki 。我觉得它满足了我的所有需求。我将总结使用两者的一些优点和缺点。

Github 优点：

*   很棒的社区和协作

Github 缺点：

*   不是超级好用（虽然这值得商榷）

维基优点：

*   易于使用，适合各种不同的人

维基缺点：

*   很丑，我不喜欢版本控制系统，而且社区看起来很枯燥。

**最终，我不得不选择易用性而不是 Github 的所有酷功能。**

我应该感谢上面的@Karl。

我非常感谢所有的帮助，并从中受益匪浅。特别了解了 Github 的一些很酷的功能。

谢谢！**

# .net - 使用 JavaScriptSerializer 序列化为 JSON 时遇到问题

> ID：10390819
> 
> 赞同：1
> 
> 时间：2012-04-30T21:27:09.867
> 
> 标签：.net, asp.net-mvc-3, javascriptserializer

我在使用 System.Web.Script.Serialization.JavaScriptSerializer 将对象序列化为 JSON 字符串时遇到了一些问题。每当我尝试这样做时，我的字符串都会自动进行 html 编码。有没有办法防止这种情况发生？如果可能的话，我真的很想避免使用外部库（代码适用于 .NET 4）。这是我的代码：

```
class Program
{
    static void Main(string[] args)
    {
        string myHtml = "<div class=\"blueBackground\">This is a really cool div:)</div>";
        int someOtherValue = 5;

        var jsonSerializer = new JavaScriptSerializer();

        string jsonObj = jsonSerializer.Serialize(new MyClass
        {
            StringProperty = myHtml,
            IntProperty = someOtherValue
        });

        Console.WriteLine(jsonObj);
        Console.ReadLine();
    }

    class MyClass
    {
        public string StringProperty { get; set; }
        public int IntProperty { get; set; }
    }
} 
```

它输出字符串

> {"StringProperty":"\u003cdiv class=\"blueBackground\"\u003e这是一个非常酷的 div:)\u003c/div\u003e","IntProperty":5}

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:34:10.440

您的字符串不是 HTML 编码的。它们是 javascript 编码的。JSON 旨在由 javascript 解释器读取，并且您的输出是完全有效的 javascript，如[本现场演示](http://jsfiddle.net/DgFkR/)中所示。它是有效的 JSON，任何标准的 JSON 反序列化器都能够理解此输出并将其反序列化回原始字符串。所以没什么好担心的。

# android - 服务中的位置侦听器发送通知问题

> ID：10390823
> 
> 赞同：0
> 
> 时间：2012-04-30T21:27:29.510
> 
> 标签：android

我想要做的是每当位置改变时从服务内发送通知。当用户点击通知时，我希望通知关闭并开始活动。我设法发送了通知，但是当点击通知时，它并没有清除，也没有启动活动。我看不出我哪里出了问题！？这是代码：

```
package com.oxinos.android.moc;

import android.app.Application;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.app.Service;
import android.content.Context;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.IBinder;
import android.widget.SimpleAdapter.ViewBinder;
import android.widget.Toast;

public class mocService extends Service implements OnClickListener{

    NotificationManager nm;
    static final int uniqueID1= 190910;
    PendingIntent pi;
    Context con;

    @Override
    public IBinder onBind(Intent intent) {

        return null;

    }

    @Override
    public void onCreate() {
        super.onCreate();
        con = getApplicationContext();

        Intent intent = new Intent(this, mocActivity2.class);

        pi = PendingIntent.getService(this, 0, intent, 0);
        nm = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);

        // Acquire a reference to the system Location Manager
        LocationManager locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

        // Define a listener that responds to location updates
        LocationListener locationListener = new LocationListener() {
            public void onLocationChanged(Location location) {
                // Called when a new location is found by the network location provider.
                String locStr = "New loc: "+location.getLatitude()+","+location.getLongitude();
                String title = "New MOC notification";

                Notification startupNotification = new Notification(R.drawable.ic_launcher, locStr, System.currentTimeMillis());
                startupNotification.setLatestEventInfo(con, title,locStr, pi);
                startupNotification.defaults = Notification.DEFAULT_ALL;
                nm.notify(uniqueID1, startupNotification);
                //nm.cancel(uniqueID1);

            }

            public void onProviderEnabled(String provider) {}

            public void onProviderDisabled(String provider) {}

            public void onStatusChanged(String arg0, int arg1, Bundle arg2) {
                // TODO Auto-generated method stub

            }
        };

        // Register the listener with the Location Manager to receive location updates
        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 100000, 50, locationListener);
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 100000 , 50, locationListener);

    }

    @Override
    public void onDestroy() {
        super.onDestroy();

        Toast.makeText(this, "Service Destroyed", Toast.LENGTH_LONG).show();

    }

    @Override
    public void onStart(Intent intent, int startId) {

        super.onStart(intent, startId);

        Toast.makeText(this, "Service Started", Toast.LENGTH_LONG).show();

    }

    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub
        startActivity(new Intent(this, mocActivity2.class));
        nm.cancel(uniqueID1);
    }
} 
```

有任何想法吗？？？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:52:41.403

您正在创建您的`PendingIntent`using `getService()`。如果你想用 开始一个活动`PendingIntent`，你需要使用`getActivity()`.

# jquery - 多输入验证

> ID：10390825
> 
> 赞同：-6
> 
> 时间：2012-04-30T21:27:48.053
> 
> 标签：jquery, ajax

我有 3 个输入需要检查是否为空，然后运行 ​​ajax 调用。

有人可以协助编写 IF 语句

```
$('input[name=newsave]').click(function(){
            var neworgy = $('input[name=neworg]').val();
            var newurly = $('input[name=newurl]').val();
            var newtrackingy = $('input[name=newtracking]').val();
            var dataString = 'email=<?php echo $userid;?>&neworg='+ neworgy +'&newurl='+ newurly +'&newtracking='+ newtrackingy;
              $.ajax({
                type: "POST",
                url: "new-token.php",
                data: dataString,
                success: function() {
                    location.reload();
                    }
              });
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:31:29.953

```
var isValid = !$('input[name=neworg], input[name=newurl], input[name=newtracking]')
    .filter(function() {
        return !this.value;
    }).length;​

if (isValid){
    // Do what you want
} 
```

对于查询字符串，您可以使用 jQuery[`serialize()`](http://api.jquery.com/serialize/)函数。

# javascript - 因浏览器 javascript DOMParser 和 XSL 的最新变化而受阻

> ID：10390826
> 
> 赞同：2
> 
> 时间：2012-04-30T21:27:55.620
> 
> 标签：javascript, firefox, xslt, dom, cross-browser

以下内容曾经适用于 Firefox 3.5.x 和 3.6.x，但不再适用于 Firefox 11.x 或 Safari 5.1.x。Javascript 不是我的专长，所以我跟不上最近的变化。

具体来说，“浏览”按钮显然仍然“成功”加载了一个文件（这应该是从 FCP 导出的 XML 序列，尽管这没有经过验证），但是在按下“处理”按钮时，XSLT 的结果不再出现在“输出”DIV就像他们过去使用以前的浏览器版本一样。

它可以在[http://johnpilgrim.net/color/jProcess.html的上下文中看到](http://johnpilgrim.net/color/jProcess.html)

可在 [http://johnpilgrim.net/color/sample.xml上找到用于测试的适当示例 XML 文件](http://johnpilgrim.net/color/sample.xml)

html、javascript 或 xsl 没有任何变化，因此这似乎是最近浏览器的变化。我只设计和测试了它在 Firefox 中的工作，所以从来没有在其他任何东西上测试过。

想法？解决方案？

谢谢！约翰

```
<head>

    <script type="text/javascript">

        function jProcess(){
            // Get the file contents locally, using the nifty Firefox 3 nsIDOMFile interface
            var file_contents = document.getElementById('xml_file').files.item(0).getAsText("utf8");

            // Cast/Convert to an XML Document
            var parser = new DOMParser();
            xmlDoc = parser.parseFromString(file_contents, "text/xml");

            // XSLT Transformation
            var xslt = document.implementation.createDocument("", "", null);
            xslt.async = false;
            xslt.load("jProcess.xsl");
            var process = new XSLTProcessor();
            process.importStylesheet(xslt);
            var result = process.transformToFragment(xmlDoc, document);

            // Show the output
            document.getElementById('output').innerHTML= " ";               
            document.getElementById('output').appendChild(result);

            return false;
        };
    </script>
</head>

<body>
<form method="post" onsubmit="return jProcess();">
<fieldset>
    <legend>Select the XML file for the FCP sequence you want to process into HTML.</legend>
    <input type="file" size=100 name="xml_file" id="xml_file">
    <input type="submit" value="Convert">
</fieldset>
</form>
<div id="output"></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T09:58:27.953

我在 Windows 上使用 Firefox 12 尝试了您的示例，错误控制台显示错误

```
Timestamp: 01.05.2012 11:23:43
Error: document.getElementById("xml_file").files.item(0).getAsText is not a function
Source File: http://johnpilgrim.net/color/jProcess.html
Line: 40 
```

`File`因此，由于在输入 type="file" 控件上公开的 API 的变化以及在该控件公开的对象中公开的对象，代码根本不再工作`FileList`。基于[https://developer.mozilla.org/en/DOM/File](https://developer.mozilla.org/en/DOM/File)方法 getAsText 在 Gecko/FF 7 中已过时，并且可能稍后会被删除。要读取文件的内容，您现在应该使用[https://developer.mozilla.org/en/DOM/FileReader#readAsText%28%29](https://developer.mozilla.org/en/DOM/FileReader#readAsText%28%29)。这似乎是一个更进一步的异步 API，因此您将不得不重组您的代码：[http](http://home.arcor.de/martin.honnen/xml/test2012050101.html) ://home.arcor.de/martin.honnen/xml/test2012050101.html （该示例适用于当前版本的 Firefox、Opera 和铬合金）。

所以一个使用 FileReader 的例子看起来像

```
function transform(file, sheetUrl) {
  if (typeof FileReader !== 'undefined') {
    var fileReader = new FileReader();
    fileReader.onload = function(evt) {
      var doc = new DOMParser().parseFromString(this.result, 'application/xml');
      var proc = new XSLTProcessor();
      var req = new XMLHttpRequest();
      req.open('GET', sheetUrl, false);
      req.send(null);
      proc.importStylesheet(req.responseXML);
      document.body.appendChild(proc.transformToFragment(doc, document));
    };
    fileReader.readAsText(file);
  }
  else {
    console.log('No FileReader support.');
  }
} 
```

# php - 如何使用 keyup 事件使我的分页在搜索结果中正常工作？

> ID：10390827
> 
> 赞同：-1
> 
> 时间：2012-04-30T21:27:58.993
> 
> 标签：php, jquery, mysql

我正在使用 keyup() 函数将变量发送到具有 mysql 选择的 php 页面 (consult.php) 以带来我的搜索结果。

索引.php

```
<html>
<head>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript">
$(function(){
 $('#input').keyup(function(){
  var inputVal=$('#input').val();
  $.ajax({
   type: 'POST',
   data: ({word : inputVal}),
   url: 'consult.php',
   success: function(data) {
    $('#content').html(data);
   }
  });
 });
 $("#menu li").click(function(){
  $.ajax({
   type: 'POST',
   data: ({word : inputVal}),
   url: 'consult.php',
   success: function(data) {
    $('#content').html(data);
  }
  });
 });
});
</script>
<style>
 #menu ul{
  margin:0;
  padding:0;
  list-style:none;
 }
 #menu ul li{
  padding:5px;
  margin-right:2px;
  float:left;
  border:#00F solid 1px;
  background-color:#faa8ad;
}
</style>
</head>
<body>
 <div>Write<br>
  <input type="text" id="input" name="input"/>
 </div>
<div id="content"></div>
</body>
</html> 
```

咨询.php

```
<?
 include('conn.php');
 $word = isset($_POST['word']) ? $_POST['word'] : $_GET['word'];
 if($word){

  $perPag = 4;
  $query = mysql_query("SELECT COUNT(carro_id) FROM carros WHERE carro_modelo LIKE '$word%'");
  $totalResult = ceil(mysql_result($query, 0)/$perPag);

  $pag = (isset($_GET['pag']) and (int)$_GET['pag'] > 0) ? (int)$_GET['pag'] : 1;
  $ini = ($pag - 1) * $perPag;

  $queryTotal = mysql_query("SELECT carro_modelo FROM carros WHERE carro_modelo LIKE '$word%' ORDER BY carro_id LIMIT $ini, $perPag");
      while($row = mysql_fetch_assoc($queryTotal)){
       echo "<div>".$row['carro_modelo']."</div>";
      }
  if($totalResult >= 1 && $pag <= $totalResult){
   for($i = 1; $i <= $totalResult; $i++){
    echo($i == $pag) ? '<div id="menu"><ul><li><strong><a href="?pag='.$i.'&word='.$word.'">'.$i.'</a></strong></li></ul></div> ' : '<div id="menu"><ul><li><a href="?pag='.$i.'&word='.$word.'">'.$i.'</a></li></ul></div> ';
   }
  }
 }else{
  $queryTotalReult = mysql_query("SELECT * FROM carros");
  while($rowTotal = mysql_fetch_assoc($queryTotalReult)){
   echo "<div>".$rowTotal['carro_modelo']."</div>";
  }
 }
?> 
```

问题是，当我点击分页的链接时，它会加载返回 index.php 中的结果，从而再次忽略搜索。

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T16:15:07.487

索引.php

```
<html>
<head>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript">
function ajaxCall(inPage,inWord)
{

      $.ajax({
       type: 'POST',
       data: ({word : inWord, pag : inPage}),
       url: 'consult.php',
       success: function(data) {
        $('#content').html(data);
       }});
}
    $(function(){
     $('#input').keyup(function(){
      var inputVal=$('#input').val();
      $.ajax({
       type: 'POST',
       data: ({word : inputVal}),
       url: 'consult.php',
       success: function(data) {
        $('#content').html(data);
       }
      });
     });
    });
    </script>
    <style>
     #menu ul{
      margin:0;
      padding:0;
      list-style:none;
     }
     #menu ul li{
      padding:5px;
      margin-right:2px;
      float:left;
      border:#00F solid 1px;
      background-color:#faa8ad;
    }
    </style>
    </head>
    <body>
     <div>Write<br>
      <input type="text" id="input" name="input"/>
     </div>
    <div id="content"></div>
    </body>
    </html> 
```

咨询.php

```
<?
 include('conn.php');
 $word = isset($_POST['word']) ? $_POST['word'] : $_GET['word'];
 if($word){
  $perPag = 4;
  $query = mysql_query("SELECT COUNT(carro_id) FROM carros WHERE carro_modelo LIKE '$word%'");
  $totalResult = ceil(mysql_result($query, 0)/$perPag);
  $pag = (isset($_GET['pag']) and (int)$_GET['pag'] > 0) ? (int)$_GET['pag'] : 1;
  $ini = ($pag - 1) * $perPag;
  $queryTotal = mysql_query("SELECT carro_modelo FROM carros WHERE carro_modelo LIKE '$word%' ORDER BY carro_id LIMIT $ini, $perPag");
      while($row = mysql_fetch_assoc($queryTotal)){
       echo "<div>".$row['carro_modelo']."</div>";
      }
  if($totalResult >= 1 && $pag <= $totalResult){
   for($i = 1; $i <= $totalResult; $i++){
    echo($i == $pag) ? '<div id="menu"><ul><li><strong><a onclick="ajaxCall('.$i.',\''.$word.'\')">'.$i.'</a></strong></li></ul></div> ' : '<div id="menu"><ul><li><a onclick="ajaxCall('.$i.',\''.$word.'\')">'.$i.'</a></li></ul></div> ';
   }
  }
 }else{
  $queryTotalReult = mysql_query("SELECT * FROM carros");
  while($rowTotal = mysql_fetch_assoc($queryTotalReult)){
   echo "<div>".$rowTotal['carro_modelo']."</div>";
  }
 }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:33:12.643

在您的查询中您有 $initial，但在作业中您有 $ini。也许尝试使这些相同:)

# sql - 进行非常复杂的 SQL 分组的有效方法：

> ID：10390828
> 
> 赞同：2
> 
> 时间：2012-04-30T21:28:16.433
> 
> 标签：sql

假设你有一张这样的桌子：

```
ID | Type | Reference #1 | Reference #2
0  | 1    | [A]          | {a}
1  | 2    | [B]          | {b}
2  | 2    | [B]          | {c}
3  | 1    | [C]          | {d}
4  | 1    | [D]          | {d}
5  | 1    | [E]          | {d}
6  | 1    | [C]          | {e} 
```

有没有什么好的方法可以将“参考#1”和“参考#2”作为“后备”进行分组，因为没有更好的方法来放置它......

例如，我想将以下 ID 组合在一起：

```
{0} [Unique Reference #1], 
{1,2} [Same Reference #1],
{3,4,5,6} [{3,4,5} have same Reference #2 and {3,6} have same Reference #1] 
```

我对如何做到这一点完全不知所措......有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T23:07:32.507

在 mellamokb 的查询中，分组取决于输入的顺序。

IE。

```
VALUES
    (0, 1, '[A]', '{a}'),
    (1, 2, '[B]', '{b}'),
    (2, 2, '[B]', '{c}'),
    (3, 1, '[C]', '{d}'), // group 3
    (4, 1, '[D]', '{d}'), // group 3
    (5, 1, '[E]', '{d}'), // group 3
    (6, 1, '[C]', '{e}'); // group 3 
```

产生不同的结果

```
VALUES
    (0, 1, '[A]', '{a}'),
    (1, 2, '[B]', '{b}'),
    (2, 2, '[B]', '{c}'),
    (3, 1, '[C]', '{e}'), //group 3
    (4, 1, '[D]', '{d}'), // group 4
    (5, 1, '[E]', '{d}'), // group 4
    (6, 1, '[C]', '{d}'); // group 3 
```

如果您可以指定的引用有一些自然顺序，这可能是有意的，但如果它们不是，则它是一个问题。***“解决”这个问题或指定另一个问题的方法是说所有相等的 Reference1 创建一组元素，这些元素的成员就是它们自己，而那些 Reference2至少***等于该集合的一个成员的元素。

在 SQL 中：

```
with groupings as (
  select
    ID,Reference1,Reference2,
    (select min(ID) from Table1 t2
     where t2.Reference1=t1.Reference1 or t2.Reference2=t1.Reference2 ) as minID
  from
    Table1 t1
)
select
    t1.ID,t1.Reference1,t1.Reference2,t1.minid as round1,
    (select min(t2.minid) from
            groupings t2
      INNER JOIN groupings t3 ON t1.Reference2=t2.Reference2
) as minID
  from
    groupings t1 
```

这应该每次都产生完整的分组。

# c# - 是否可以与正在运行的进程“交谈”？

> ID：10390829
> 
> 赞同：3
> 
> 时间：2012-04-30T21:28:16.823
> 
> 标签：c#, .net, xml, sockets

我想创建一些将作为简单过程运行的服务，并为其他一些应用程序提供向他发送 xml 流的可能性。

我的意思是用无限循环创建简单的进程（exe） - 任何应用程序都可以将 XML（文件/流）发送到这个进程 =>，这个进程会将 xml 发送到某个套接字。

没有管道可以做到吗？我想做一些类似 COM 的事情——它可以“捕获”工作进程的实例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T21:30:55.390

当然。

您可以在 c# 中使用命名管道类：

服务器 ：

```
using (var s = new NamedPipeServerStream ("myPipe"))
{
 s.WaitForConnection();
 s.WriteByte (100);
 Console.WriteLine (s.ReadByte());
} 
```

客户端代码：

```
using (var s = new NamedPipeClientStream ("myPipe"))
{
 s.Connect();
 Console.WriteLine (s.ReadByte());
 s.WriteByte (200);  
} 
```

## 编辑

你可以通过文件来做。+ systemfileWatcher 类

将文件放入文件夹中。

另一个进程将审核此文件夹。

现在您可以传输信息了。

## 编辑2

你可以使用 memoryMappedFile

并在每个进程中打开一个视图以查看相同的内存区域 - 并传输数据。我认为它是最好的。

## 过程A：

```
 static void Main(string[] args)
        {
            using (MemoryMappedFile mmf = MemoryMappedFile.CreateNew("testmap", 4000))
            {
                bool mutexCreated;
                Mutex mutex = new Mutex(true, "testmapmutex", out mutexCreated);
                using (MemoryMappedViewStream stream = mmf.CreateViewStream())
                {
                    BinaryWriter writer = new BinaryWriter(stream);
                    string st = "Hellow";
                    int stringSize = Encoding.UTF8.GetByteCount(st); //6
                    writer.Write(st);
                    writer.Write(123); //6+4 bytes = 10 bytes
                }
                mutex.ReleaseMutex();
                Console.WriteLine("Start Process B and press ENTER to continue.");
                Console.ReadLine();
                mutex.WaitOne();
                using (MemoryMappedViewStream stream = mmf.CreateViewStream())
                {
                    BinaryReader reader = new BinaryReader(stream);
                    Console.WriteLine("Process  A  says: {0}", reader.ReadString());
                    Console.WriteLine("Process  A says: {0}", reader.ReadInt32());
                    Console.WriteLine("Process  B says: {0}", reader.ReadInt32());
                }
                mutex.ReleaseMutex();
            }
        } 
```

## 进程 B 写入其区域

```
 static void Main(string[] args)
        {
            try
            {
                using (MemoryMappedFile mmf = MemoryMappedFile.OpenExisting("testmap"))
                {
                    Mutex mutex = Mutex.OpenExisting("testmapmutex");
                    mutex.WaitOne();
                    using (MemoryMappedViewStream stream = mmf.CreateViewStream(11, 0)) // From the 11 byte....
                    {
                        BinaryWriter writer = new BinaryWriter(stream, Encoding.UTF8);
                        writer.Write(2);
                    }
                    mutex.ReleaseMutex();
                }
            }
            catch (FileNotFoundException)
            {
                Console.WriteLine("Memory-mapped file does not exist. Run Process A first.");
            }
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T21:31:04.227

只需使用 C# 套接字来侦听来自其他进程的连接并编写自定义 XML 文件接收器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T21:30:41.793

是的，当然你可以使用 TCP[套接字](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx)连接。如果你想避免网络连接，如评论中所启发的那样，你可以使用共享内存方法，例如[Memory-Mapped Files](http://msdn.microsoft.com/en-us/library/dd997372.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-30T21:39:29.957

您正在寻找的是某种形式的 IPC（进程间通信）。有很多可能性：

1.  常规文件。Windows 专门为临时文件提供位置 (%TEMP%)
2.  对于小数据，您可以使用注册表，尽管在大多数情况下它不是正确使用
3.  内存映射文件，它类似于文件，但在 RAM 中
4.  正如 Royi 正确提到的，如果您决定尝试管道，NamedPipeStream 是一种方法
5.  您可以创建一个 WCF 端点。听起来很拖沓，但 Visual Studio 会为你创建所有的脚手架，所以最终不是这样的问题
6.  如果您正在开发表单应用程序，则可以使用窗口消息，有时即使不是
7.  您提到数据是 XML，所以这种方法不适合您，但我还是要提一下：您可以使用命名的内核对象，例如：互斥体、事件、信号量将信号从一个程序传递到另一个程序。

# c++ - 如何使用退出代码正确关闭应用程序

> ID：10390844
> 
> 赞同：2
> 
> 时间：2012-04-30T21:29:50.047
> 
> 标签：c++, command-line, initialization, wxwidgets, exit-code

在我的 wxWidgets 应用程序中，我正在检查命令行参数，如果找到，我会执行一个操作，然后关闭窗口。但是，我似乎无法让应用程序正确关闭。我想用退出代码关闭程序，例如 3。当我检查 wxApp::OnInit 中的命令行参数时，我尝试调用`exit(3)`，但是，这似乎不合适，因为它导致 wxwidgets 中某处的内存泄漏.

然后我尝试存储退出代码，覆盖 OnRun 并返回那里，但是，当我这样做时，`init.cpp`我`472`在`return wxTheApp->OnRun();`.

有谁知道在检测到应用程序应该关闭后如何使用来自 wxApp 的自定义退出代码正确关闭应用程序？我也尝试过重载`wxApp::OnExit`，但是，即使我没有重载，它也永远不会被调用`OnRun`。

[http://codepad.org/WYiOJq55](http://codepad.org/WYiOJq55)上的代码示例，由于某些原因，此帖子中不允许使用该代码

**编辑**粘贴代码：

```
int SomeApplication::OnRun()
{
    if(mExitCode != 0)
    {
        ExitMainLoop();
        return mExitCode;
    }
    else
        return wxApp::OnRun();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T22:23:59.387

根据您的评论，您似乎从未启动 wxFrame 并且只想尽快退出应用程序。为此，请让您的构造函数`SomeApplication`初始化`mExitCode`为`0`. 然后`OnInit`在进行命令行参数检查期间，如果您想在检查后立即关闭应用程序，请设置`mExitCode`为您的退出代码并`return true`从`OnInit`.

以下是您的`OnRun`函数如何在不打开另一个窗口的情况下工作。

```
int SomeApplication::OnRun()
{
    if(mExitCode == 0)
        wxApp::OnRun();

    return mExitCode;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:45:18.467

当我像这样覆盖 wxAPP::OnRun() 时：

```
int MyApp::OnRun()
{
    wxApp::OnRun();
    return 3;
} 
```

一切正常

如果我创建一个小批处理文件

```
minimal.exe
echo el is %ERRORLEVEL% 
```

它产生预期的结果

```
>test.bat

>minimal.exe

>echo el is 3
el is 3 
```

我认为你的代码有问题

```
int SomeApplication::OnRun()
{
    if(mExitCode != 0)
    {
        ExitMainLoop();
        return mExitCode;
    }
    else
        return wxApp::OnRun();
} 
```

是您在检查退出代码之前没有调用基类 OnRun，可能是在 wxAPP::OnRun() 执行的代码中设置的

所以我猜这对你有用

```
int SomeApplication::OnRun()
{
    wxApp::OnRun();
    return mExitCode;
 } 
```

# android - Android 官方开发者教程中 Hello World 项目中的 NAND 错误

> ID：10390846
> 
> 赞同：2
> 
> 时间：2012-04-30T21:29:50.133
> 
> 标签：android, eclipse, adt

我正在[http://developer.android.com/resources/tutorials/hello-world.html处理 Hello World 项目](http://developer.android.com/resources/tutorials/hello-world.html)

当我运行应用程序时，麻烦就来了。我收到的消息序列类似于：

```
[2012-04-30 15:13:19 - HelloAndroid] ------------------------------
[2012-04-30 15:13:19 - HelloAndroid] Android Launch!
[2012-04-30 15:13:19 - HelloAndroid] adb is running normally.
[2012-04-30 15:13:19 - HelloAndroid] Performing com.example.helloandroid.HelloAndroid activity launch
[2012-04-30 15:13:19 - HelloAndroid] Automatic Target Mode: launching new emulator with compatible AVD 'my_avd'
[2012-04-30 15:13:19 - HelloAndroid] Launching a new emulator with Virtual Device 'my_avd'
[2012-04-30 15:13:25 - Emulator] NAND: could not write file /tmp/android-jhsu/emulator-7iTL7m, File exists 
```

究竟是什么阻止了进程正常执行？我需要做什么来解决这个问题？

更新 1：

好的，我尝试了您有关清除 avd 的建议。

我进入我的 android_sdk_linux 目录并输入“tools/android list avd”。输出是：

```
Available Android Virtual Devices:
Name: my_avd
Path: /home/jhsu/.android/avd/my_avd.avd
Target: Android 4.0.3 (API level 15)
ABI: armeabi-v7a
Skin: WVGA800 
```

所以我输入了“工具/模拟器 -avd my_avd -wipe-data”。输出是：

```
NAND: could not write file /tmp/android-jhsu/emulator-5FHEn7, File exists 
```

但是我查看了 /tmp/android-jhsu 目录并没有看到任何文件，甚至没有看到隐藏文件。

我从这里去哪里？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-04-11T19:30:21.050

我能够修复它导出`ANDROID_TMP`

```
export ANDROID_TMP=/home/myuser 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-16T19:16:08.900

至少对我来说，我会让我的磁盘空间不足而没有意识到。

这是第一个失败的项目只是巧合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-13T19:19:02.640

当错误不能完全详细地描述问题时，这是一个真正令人不安的情况！最后我发现所有这些错误消息（“文件存在”和“没有空间”）是由于 /tmp 文件夹上的少量安装空间造成的。在 Linux 中尝试`mount`，你会看到 tmpfs 和 /tmp 的指定参数

更改 $ANDROID_TMP 值不是一个合适的解决方案，甚至根本不起作用。

尝试编辑**fstab**

```
sudo gedit /etc/fstab 
```

并将 /tmp 大小增加到对您有意义的更大值（例如：1500M）然后**重新启动**系统

*PS：它不依赖于 IDE（Eclipse 或 Android-Studio），而是处理 AVD Emulator*

# bash - 十进制数转换

> ID：10390850
> 
> 赞同：1
> 
> 时间：2012-04-30T21:30:01.257
> 
> 标签：bash, numbers, decimal

在 bash 中，我试图用小数（带分数）的数字编写条件。然后我发现我不能在 bash 中做小数。我拥有的脚本如下：

```
 a=$(awk '/average TM cross section = / {CCS=$6}; END {printf "%15.4E \n",CCS}' ${names}_$i.out)
 a=$(printf '%.2f\n' $a)
 echo $a 
```

在`*.out`文件中，数字采用科学计数法。最后，`echo $a`我得到一个数字 245.35（或我文件中的其他数字）。所以，我想知道如何将输出编号 245.35 更改为 24535，以便我可以在 bash 中执行条件。

我试图乘以，显然没有用。任何人都可以帮助进行这种转换吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T00:34:27.740

根据我们的扩展对话

```
 a=$(awk '/average TM cross section = / {CCS=$6}; END {printf "%15d\n",CCS * 100}' ${names}_$i.out) 
```

现在你的输出将是一个整数。

请注意，awk 设计用于处理大文件和测试逻辑。您的所有/大部分处理都可能在一个 awk 进程中完成。如果您正在处理大量数据，则可以节省大量时间。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:35:46.297

除了算术之外，你最好使用其他东西`bash`——调用一些更强大的东西。您可能会发现以下链接既鼓舞人心又令人恐惧：[http](http://blog.plover.com/prog/bash-expr.html) ://blog.plover.com/prog/bash-expr.html （“shell 脚本中的算术表达式”）和[http://blog.plover.com/prog/ spark.html](http://blog.plover.com/prog/spark.html) ("bash 中的疯狂计算"); 如果您认真尝试进行基于 bash 的算术，恐怕这就是您最终可能会遇到的事情。特别是，`to_rational`第二篇文章中的函数包括一些使用正则表达式拆分小数的代码，尽管他用它们做的事情比听起来更复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:34:35.857

根据您提供的信息，这与任何算术运算无关。

把它当作字符串。找到小数点并将其删除。这就是我的理解

[http://www.cyberciti.biz/faq/unix-linux-replace-string-words-in-many-files/](http://www.cyberciti.biz/faq/unix-linux-replace-string-words-in-many-files/)

[http://www.thegeekstuff.com/2010/07/bash-string-manipulation/](http://www.thegeekstuff.com/2010/07/bash-string-manipulation/)

# actionscript-3 - as3 访问父 MovieClip 或 Loader 中的变量？

> ID：10390857
> 
> 赞同：1
> 
> 时间：2012-04-30T21:30:53.670
> 
> 标签：actionscript-3, flash, variables, global-variables, scope

下面是我的代码。这很简单。我只需要获取在主舞台上定义的 var，并让每个外部 swf 都可以访问该 var。

这是不起作用的代码：

在主要 SWF 中：

```
var ThePath:String;
ThePath = "happy/go/lucky/"; 
```

/// 下面的代码是来自上面主上一个时间线的 A LOADED SWF。（现在在这里显示完整的代码）

```
var myMC:MovieClip;
myMC= parent as MovieClip;

trace("Your VAR PATH IS " + myMC.ThePath); /// DOES NOT WORK. 
```

谢谢快乐的堆垛机！

**2012 年 4 月 31 日更新**

简而言之：我需要在主阶段创建一个全局变量，并允许所有其他外部加载的 swf 访问该变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:34:37.467

```
var myMC:MovieClip = MovieClip(this.parent.parent);
myMC.ThePath 
```

您应该使用 camelCase 作为变量定义。

**编辑：**

另一种解决方案是在加载器中加载子 swf 时将引用传递给父级（通过设置值，设置引用），然后子级可以引用父级。

IE：

**家长：**

函数 startLoad() { var mLoader:Loader = new Loader(); var mRequest:URLRequest = new URLRequest(“Child.swf”); mLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onCompleteHandler); mLoader.load(mRequest); }

函数 onCompleteHandler(loadEvent:Event) { var childMC:MovieClip = loadEvent.currentTarget.content; addChild(childMC:MovieClip); childMC.refToMainSWF = 这个；}

**供参考： http:** [//genaboo.wordpress.com/2008/03/27/as2_vs_as3_root_parent_communicating_between_swfs/](http://genaboo.wordpress.com/2008/03/27/as2_vs_as3_root_parent_communicating_between_swfs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-07T15:59:06.823

创建一个具有静态属性（变量）的类，根据需要导入该类以进行全局访问。请参阅[此相关问题](https://stackoverflow.com/questions/13783017/as3-static-class-versus-singleton)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:34:58.310

尝试：

```
trace("Your VAR PATH IS " + root.ThePath); 
```

# python - 如何杀死由 Python subprocess.Popen() 创建的进程

> ID：10390861
> 
> 赞同：1
> 
> 时间：2012-04-30T21:31:05.860
> 
> 标签：python, subprocess

我需要从 Python 调用一个 DOS .exe 文件并在计算后删除这个 .exe。我可以使用 调用它`subprocess.Popen`，`os.system`但是，如果它被调用，我无法删除这个 .exe 文件`subprocess.Popen`。错误是`WindowsError: [Error 5] Access is denied`。谁能让我知道如何杀死这个过程？谢谢！

`subprocess`方法（不起作用）：

```
a = subprocess.Popen("dos.exe", stdin=subprocess.PIPE,
                     stdout=subprocess.PIPE, stderr=subprocess.PIPE)
time.sleep(5)
a.kill()
os.remove("dos.exe")

# gets error msg "WindowsError: [Error 5] Access is denied" 
```

`os.system`方法（作品）：

```
a=os.system("dos.exe")
os.remove("dos.exe") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:37:23.213

在删除 .exe 之前，您需要等待该过程完成。在删除 .exe 之前调用 a.communicate() 或 a.wait()

# javascript - 关闭模态对话框屏幕

> ID：10390863
> 
> 赞同：0
> 
> 时间：2012-04-30T21:31:20.070
> 
> 标签：javascript, jquery, html, css

我目前正在我的网站中为注册页面实现一个模式对话框屏幕，为您节省时间，我不会撒谎并说我正在关注本教程 - [http://raventools.com/blog/create-a- modal-dialog-using-css-and-javascript/](http://raventools.com/blog/create-a-modal-dialog-using-css-and-javascript/)

一切正常，只是它没有显示如何在用户单击对话框外部时关闭对话框，就像在它周围的其他身体部位一样。

我怎样才能做到这一点？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:34:33.337

您只需`overlay()`从要触发关闭的任何事件中再次调用。它切换覆盖层的可见性（如果覆盖层可见，则调用`overlay()`隐藏它，反之亦然）：

```
function overlay() {
    el = document.getElementById("overlay");
    el.style.visibility = (el.style.visibility == "visible") ? "hidden" : "visible";
} 
```

您也可以考虑使用类似[jQuery UI 的对话框小部件](http://jqueryui.com/demos/dialog/)。

# jquery - 无法在带有 jQ uery Mobile 1.0.1 或 1.1.0 的 Android 2.2、2.3.3 中水平滚动；2.3.3

> ID：10390868
> 
> 赞同：1
> 
> 时间：2012-04-30T21:31:41.403
> 
> 标签：jquery, android, jquery-mobile, android-emulator, android-2.2-froyo

我无法在 Android 2.2 和 2.3.3 版本中水平滚动。我已经在 Android Emulator SDK 2.2 和 2.3.3 版本以及 Android 2.2 设备上确认了这一点。我启用了缩放功能，这是设计使然。这非常令人沮丧，并且发生在最常见的 Android 操作系统版本之一上。在模拟器上，如果我按下鼠标并尝试水平滚动，我会说它运行良好 - 不到 10 次。就好像 DOM 被冻结了一样。我不明白为什么会这样。

有人有答案和解决方案吗？我和其他人将不胜感激任何反馈。再次感谢您的帮助。

# oracle - NHibernate 3.3： 执行 Oracle 11g 存储过程

> ID：10390871
> 
> 赞同：1
> 
> 时间：2012-04-30T21:31:49.163
> 
> 标签：oracle, nhibernate, stored-procedures, parameters, sql-insert

我将 Oracle 11g 存储过程映射为 NHibernate 的 .hbm.xml 映射文件中的命令，如下所示：

```
 <class name="Person" table="PERSONS">
    <id name="Id" column="COD_PERSON" />
    <property name="Name" column="NAME" />

    <property name="AuditField1" column="AUDITFIELD1" />
    <property name="AuditField2" column="AUDITFIELD2" />
    <property name="AuditField3" column="AUDITFIELD3" />

    <sql-insert>exec PKG_PERSONS.insert_sp ?,?</sql-insert>
  </class> 
```

这是存储过程：

```
create or replace package body PKG_PERSONS is
  procedure insert_sp(pcod_person  persons.cod_person%type, 
                      pname        persons.name%type) is
  begin
    insert into persons(cod_person, name) values(pcod_person, pname);
  end; 
```

从这个映射中，我期望“Id”和“Name”属性将作为参数发送，但可以肯定的是，这不会发生；我从 Oracle 收到此错误：**ORA-01036: invalid variable name/number**。NHibernate 在控制台窗口中显示了一些日志，似乎 NH 尝试映射所有属性，包括 AuditFields，以调用存储过程。

也许这是消息来源的错误？

这是预期的行为吗？

是否可以使用 NH3/Oracle 指定哪些属性作为参数发送？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:22:02.410

已确认，NH 尝试将映射到`<sql-insert>/<sql-update>`存储过程的每个实体的属性作为参数发送，但您可以使用 insert/update=false 进行例外处理。

另一个问题是执行 Oracle11g 存储过程的正确 sintaxis，这是适用于 NH3.3 和 Oracle.DataAccess 4.112.2.0 的映射：

```
 <class name="Person" table="PERSONS">
    <id name="Id" column="COD_PERSON" />
    <property name="Name" column="NAME" />

    <property name="AuditField1" column="AUDITFIELD1" insert="false" update="false" />
    <property name="AuditField2" column="AUDITFIELD2" insert="false" update="false" />
    <property name="AuditField3" column="AUDITFIELD3" insert="false" update="false" />

    <sql-insert check="none">begin PKG_PERSONS.insert_sp(:p0,:p1); end;</sql-insert>
  </class> 
```

我不得不重新定义参数的顺序，因为 Id 属性是在最后一个位置发送的：

```
create or replace package body PKG_PERSONS is
  procedure insert_sp(pname        persons.name%type,
                      pcod_person  persons.cod_person%type
                      ) is
  begin
    insert into persons(cod_person, name) values(pcod_person, pname);
  end; 
```

也许这会对其他人有所帮助，谢谢。

# php - 如何构建适合所有用户的动态 mysql 查询

> ID：10390873
> 
> 赞同：0
> 
> 时间：2012-04-30T21:31:52.897
> 
> 标签：php, mysql, dynamic

我需要您对我的网站搜索功能的帮助。我正在开发一个会员区，用户可以在其中根据某些标准或标准组合搜索其他注册用户。

我现在的问题是如何构建一个动态 mysql 查询以适应每种搜索条件组合的需要，其中条件的数量是可变的。

通常，我可以使用预先确定的一组标准来编写

```
 WHERE param1 = '$param1'
   AND param2 = '$param2'
   AND param3 = '$param3' 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:45:56.143

如果问题是您不知道用户将选择哪个标准，但想要返回“空白”标准的结果，您可以使用以下方法：

```
$criteria_1 = $_POST['criteria_1'];
$criteria_2 = $_POST['criteria_2'];
$criteria_3 = $_POST['criteria_3'];

if(!$criteria_1 && !$criteria_2 && !$criteria_1) {

     echo "You must select at least one criteria!";

} else {

   // Run query mentioned below and return results.       

} 
```

查询将如下所示：

```
SELECT * from mytable
WHERE
(criteria1 = '$criteria_1' OR '$criteria_1' = '') AND
(criteria2 = '$criteria_2' OR '$criteria_2' = '') AND
(criteria3 = '$criteria_3' OR '$criteria_3' = '') 
```

这会将任何空白（未选择）参数视为空白并忽略它们。请注意，如果没有给出标准，它将返回所有结果。

上面的另一种写法是：

```
SELECT * from mytable
WHERE
criteria1 IN ('$criteria_1', '') AND
criteria2 IN ('$criteria_2', '') AND
criteria3 IN ('$criteria_3', '') 
```

同样，根本不允许输入以返回所有条件 1 结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:36:02.887

这是您要问的通用示例：

```
$query = "SELECT * FROM mytable";

if ($_POST['name'] == "Jack") {
   $query .= " WHERE name = 'Jack'";
}
if ($_POST['name'] == "Bob") {
   $query .= " WHERE name = 'Bob'";
}

if ($_POST['state'] != "") {
   $query .= " AND state = '" . mysql_real_escape_string($state) . "'";
}

//So now, in total, your query might look like this
//"SELECT * FROM mytable WHERE name = 'Bob' AND state = '$state'"    

$result = mysql_query($query); 
```

您只需`$query`使用语句添加到字符串中，然后在检查所有变量`if`后执行查询。`$_POST`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T21:50:54.800

我见过这样的查询，因此如果您不想为特定列输入值，则为该列传递 NULL：

```
SELECT *
FROM users
WHERE param1 = :param1
UNION
SELECT *
FROM users
WHERE param2 = :param2
UNION
SELECT *
FROM users
WHERE param3 = :param3 
```

这假设您将为每一列建立索引，并且您正在执行布尔 AND 搜索（并使用 PDO）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T21:36:46.540

使用您的脚本语言（php）循环输入...

然后有这样的结构：

```
WHERE 1=1 
```

然后添加你的

```
AND paramx = '$px' 
```

对它...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T21:40:07.073

```
$criteria = array();

//Populate your criteria and parameter arrays with input from the web page here
...
// $criteria should now have stuff in it

$sql = "SELECT * FROM mytable ";//Or whatever your sql query is
$count = 0;
foreach ($criteria as $key => $parameter) {
  if ($count == 0) {
    $sql = $sql."WHERE ".$key." = ".$parameter;
  } else {
    $sql = $sql."AND ".$key." = ".$parameter;
  }
  $count++;
} 
```

也就是说，这很容易受到 sql 注入攻击。尝试使用[PHP PDO](http://php.net/manual/en/book.pdo.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-30T21:40:45.337

一个选项也是从 php/asp 或任何你使用的东西构建查询，像这样

```
$param1 = (isset($searchParam1) ? "param1 = $searchParam2" : "1");
$param2 = (isset($searchParam2) ? "param2 = $searchParam2" : "1");
$param3 = (isset($searchParam3) ? "param3 = $searchParam3" : "1"); 
```

查询就像

选择 ... 在哪里 $param1 $param2 $param3

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-16T00:02:38.987

想分享此代码以使用 PHP Thx 构建动态 mysql 查询

```
$vocabulary = (($page == "vocabulary") ? "image_name <> ''" : ""); 
$groupcat = (($group != "") ? "group = $group" : ""); 

$var = array($vocabulary, $groupcat);   

$counter = "0";
$param = "";
for ($i=0;$i<count($var);$i++)
{
    if ($counter == "0" && $var[$i] != "" )     $param = "WHERE ";
    if ($counter > "0" && $var[$i] != "" ) $param = " AND ";

    if ($param  != "") 
    {
        $condition .= $param . $var[$i];
        $param="";
        $counter++;
    }
}   
echo "Condition : ". $condition; 
```

# eclipse - Tomcat Eclipse 上的 Java Servlet 部署 - 需要参考

> ID：10390878
> 
> 赞同：2
> 
> 时间：2012-04-30T21:32:23.550
> 
> 标签：eclipse, tomcat7, web-deployment

我可能会感到困惑，或者自 2 天以来我正在犯同样的错误。请纠正我在哪里做错了，我也想参考更具体到我的问题的正确文档。

1.  我创建了动态 Web 项目并在 eclipse 中添加了 tomcat v7.0 作为服务器。当我尝试运行服务器时，它给出了一个错误。项目（右键单击）--> 运行方式--> 在服务器上运行--> Tomcat v7.0--> 项目名称（已配置）--> 完成。

错误：（服务器选项卡）

```
Apr 30, 2012 4:19:20 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files\Java\jre7\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\ThinkPad\Bluetooth Software\;C:\Program Files\ThinkPad\Bluetooth Software\syswow64;C:\Program Files\Microsoft SQL Server\100\DTS\Binn\;C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\;C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\;C:\Program Files\Microsoft SQL Server\100\Tools\Binn\;C:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies\;C:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\;C:\PROGRA~2\IBM\SQLLIB\BIN;C:\PROGRA~2\IBM\SQLLIB\FUNCTION;C:\Program Files\SlikSvn\bin;C:\Program Files\TortoiseSVN\bin;.
Apr 30, 2012 4:19:20 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:de.vogella.jersey.first' did not find a matching property.
Apr 30, 2012 4:19:20 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Apr 30, 2012 4:19:20 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Apr 30, 2012 4:19:20 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 556 ms
Apr 30, 2012 4:19:20 PM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Apr 30, 2012 4:19:20 PM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.27
Apr 30, 2012 4:19:20 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]]
    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)
    at java.util.concurrent.FutureTask.get(Unknown Source)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1128)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:782)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    ... 7 more
Caused by: java.lang.NoSuchMethodError: javax.servlet.ServletContext.getSessionCookieConfig()Ljavax/servlet/SessionCookieConfig;
    at org.apache.catalina.deploy.WebXml.configureContext(WebXml.java:1309)
    at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1357)
    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:855)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:345)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

Apr 30, 2012 4:19:20 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/de.vogella.jersey.first]]
    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)
    at java.util.concurrent.FutureTask.get(Unknown Source)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1128)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:782)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/de.vogella.jersey.first]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    ... 7 more
Caused by: java.lang.NoSuchMethodError: javax.servlet.ServletContext.getSessionCookieConfig()Ljavax/servlet/SessionCookieConfig;
    at org.apache.catalina.deploy.WebXml.configureContext(WebXml.java:1309)
    at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1357)
    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:855)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:345)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

Apr 30, 2012 4:19:20 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)
    at java.util.concurrent.FutureTask.get(Unknown Source)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1128)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:675)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:450)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1136)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:782)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

Apr 30, 2012 4:19:20 PM org.apache.catalina.startup.Catalina start
SEVERE: Catalina.start: 
org.apache.catalina.LifecycleException: Failed to start component [StandardServer[8005]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:675)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:450)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardService[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 9 more
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1136)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 11 more

Apr 30, 2012 4:19:20 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 260 ms 
```

测试： (i) eclipse 控制台显示 ![在此处输入图像描述](../Images/9841de62522bc081bd455045a089871c.png)

(ii) [http://localhost:8080/](http://localhost:8080/) -- 不指向 tomcat 主页

(iii) 即使启动批处理文件也会抛出同样的错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:08:20.987

只需重新发布来自**user384706**的答案。

`servlet.jar`中删除`classpath`。我只是搜索`servlet.jar`并删除了除`lib`文件夹之外的所有内容。这帮助我摆脱了这个错误:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-08T13:32:43.883

我试图通过添加 Tomcat 7 服务器在 eclipse 中配置我的应用程序。
我试过但没有奏效：
1\. 从我的应用程序类路径中删除所有 servlet api jar
2\. 在类路径中添加 Tomcat servlet api jar。

什么有效：
通过将 tomcat servlet-api jar 复制到 $JAVA_HOME/jre/lib/ext 解决了我的问题
注意：删除任何 servlet api jar

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T20:28:58.617

对于出现问题的页面，

双击服务器，打开超时并根据需要增加开始时间

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-16T07:04:19.073

很可能您添加了另一个依赖项，该依赖项正在拉取旧版本的 servlet api。例如，Hadoop 1.0.3 将在类路径中引入较旧的 servlet api 库。

# c# - 单页 ASP.NET 网站中的错误 BC30456

> ID：10390879
> 
> 赞同：0
> 
> 时间：2012-04-30T21:32:30.957
> 
> 标签：c#, asp.net

我刚刚开始阅读 ASP.NET C# 指南，以帮助我完成下周开始的实习。我熟悉 OO，但从未使用过 C# 或 ASP.NET。在本教程的开头，我创建了一个简单的网页，用于分析 IRA 帐户的兴趣。有两个按钮，它们使用引用 C# 代码隐藏文件的事件处理程序进行标记。编译并运行程序后，我从浏览器收到以下错误：

C:\Users\Kyle\Documents\Visual Studio 2010\WebSites\WebSite2\Default.aspx(49)：错误 BC30456：“btnCalculate_click”不是“ASP.default_aspx”的成员。

```
 AddHandler __ctrl.Click, AddressOf Me.btnCalculate_click
                                           ~~~~~~~~~~~~~~~~~~~~~ 
```

C:\Users\Kyle\Documents\Visual Studio 2010\WebSites\WebSite2\Default.aspx(52)：错误 BC30456：“btnClear_Click”不是“ASP.default_aspx”的成员。

```
 AddHandler __ctrl.Click, AddressOf Me.btnClear_Click
                                           ~~~~~~~~~~~~~~~~~ 
```

这是我的 .aspx 文件：

```
 <xmlns="http://www.w3.org/1999/xhtml">
<html>
<head runat="server">
<title>Chapter 2: Future Value</title>
<style type ="text/css">
.style1 
{
    color: #0000FF;
    font-size: x-large;
}
.style2 
{
    width:100%;
}
.style3 
{
    width: 140px;
    height: 23px;
}
</style>
</head>
<body>
<form id="form1" runat="server">
<div>
<span class="style1"><strong>401K Future Value</strong></span> <br /> <br />
<table class = "style2">
    <tr>
            <td class="style3">Montly investment</td>
            <td><asp:DropDownList ID="ddlMonthlyInvestment" runat="server" Width="106px"></asp:DropDownList></td>
        </tr>

        <tr>
            <td class="style3">Annual interest rate</td>
            <td><asp:TextBox ID="txtInterestRate" runat="server" Width="100px">6.0</asp:TextBox></td>
        </tr>

        <tr>
            <td class="style3">Number of years</td>
            <td><asp:TextBox ID="txtYears" runat="server" Width="100px">10</asp:TextBox></td>
        </tr>

        <tr>
            <td class="style3">Future Value</td>
            <td><asp:Label ID="lblFutureValue" runat="server" Font-Bold="true"></asp:Label></td>
        </tr>

        <tr>
        <td class="style3">
            <asp:Button ID="Calculate" runat="server" onclick="btnCalculate_click" Text="Calculate" />
            </td>
        <td>
            <asp:Button ID="Clear" runat="server" onclick="btnClear_Click" Text="Clear" />
            </td>                        
        </tr>
</table>

</div></form>
</body>  
</html> 
```

这是我的代码隐藏文件：

```
 using System;
    using System.Web;
    using System.Web.UI;
    using System.Web.UI.WebControls;

    public partial class _Default : System.Web.UI.Page
    {

protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
        for (int i = 50; i <= 500; i += 50)
            ddlMonthlyInvestment.Items.Add(i.ToString());
}

protected void btnCaluculate_Click(object sender, EventArgs e)
{
    if (IsValid)
    {
        int monthlyInvestment = Convert.ToInt32(ddlMonthlyInvestment.SelectedValue);
        decimal yearlyInterestRate = Convert.ToDecimal(txtInterestRate.Text);
        int years = Convert.ToInt32(txtYears.Text);

        int months = years * 12;
        decimal monthlyInterestRate = yearlyInterestRate / 12 / 100;

        decimal futureValue = this.CalculateFutureValue(monthlyInvestment, monthlyInterestRate, months);

        lblFutureValue.Text = futureValue.ToString("c");

    }
}

protected decimal CalculateFutureValue(int monthlyInvestment, decimal monthlyInterestRate, int months)
{
    decimal futureValue = 0;
    for (int i = 0; i < months; i++)
    {
        futureValue = (futureValue + monthlyInvestment) * (1 + monthlyInterestRate);
    }
    return futureValue;
}

protected void btnClear_Click(object sender, EventArgs e)
{
    ddlMonthlyInvestment.SelectedIndex = 0;
    txtInterestRate.Text = "";
    txtYears.Text = "";
    lblFutureValue.Text = "";
} 
```

}

有人可以让我知道为什么会出现这些错误吗？我已经从源头重新输入了这两个。是否有我可能需要更改的设置？我从未使用过 VS2010，所以我也不是 100% 熟悉它。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:38:38.390

在您的 ASPX 文件中，我没有看到您的`@Page`and`CodeFile`声明。

根据您的问题，它看起来像这样：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %> 
```

此外，您可能需要阅读部分类，因为这是代码隐藏模型的工作方式：

[http://msdn.microsoft.com/en-us/library/wa80x488(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/wa80x488(v=vs.100).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:48:31.710

你也有

```
onclick="btnCalculate_click" 
```

但

```
protected void btnCaluculate_Click(object sender, EventArgs e) 
```

拼写不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-28T21:50:12.610

此错误可能是由于对 aspx 页面或 ascx 用户控件进行复制/粘贴而不清理原始或副本的类名（vb 文件）和引用（aspx 文件）造成的。

如果您发布了“混乱”的文件，您可以尝试重新复制 BIN 文件夹。这发生在我身上，某处缓存了一些东西。我尝试停止和启动 IIS ，所有池。最后重新启动修复了它。

这里有一个锁定的线程，可以看到很多好东西。

[http://forums.asp.net/t/1000979.aspx?BC30456+Theme+is+not+a+member+of+ASP+default_aspx+](http://forums.asp.net/t/1000979.aspx?BC30456+Theme+is+not+a+member+of+ASP+default_aspx+)

# visual-studio-2010 - 更改 VS2010 的默认根目录

> ID：10390884
> 
> 赞同：2
> 
> 时间：2012-04-30T21:33:15.017
> 
> 标签：visual-studio-2010

我不完全确定这个问题是否属于这里；如果没有，请告诉我，我会将其移至相应的 StackExchange 网站。

我试图找出一种方法来确保 Visual Studio 2010 不会在默认位置 ( `C:\Users\XXX\Documents\Visual Studio 2010`) 中创建目录。我已成功更改以下目录的设置：

*   项目
*   设置
*   模板

但是当我启动 VS2010 时，它仍然会创建以下目录：

> C:\Users\XXX\Documents\Visual Studio 2010\StartPages\

该目录完全是空的，我找不到任何可以让我调整默认位置的设置`StartPages`。

有没有办法将 Visual Studio 的根目录从全局更改`C:\Users\XXX\Documents\Visual Studio 2010`为其他目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T22:00:04.077

尝试修改以下注册表项下的值

```
HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\10.0 
```

# flash - flash to html5 fallback for a file（无视频）

> ID：10390886
> 
> 赞同：0
> 
> 时间：2012-04-30T21:33:27.813
> 
> 标签：flash, html

我有几个 Flash 动画（带有显示/隐藏图层、幻灯片等按钮的地图）。我正在寻找第一次加载 Flash 动画 (file.swf) 的代码，如果无法显示/加载（即在 iOS 设备中），则回退到 HTML5 文件。（file.html；可能在 iframe 中）

我正在使用 Swiffy 将一些 SWF 转换为 HTML5，但结果并不总是好的。所以，我更喜欢在第一次尝试加载 SWF 文件。

我找到的所有代码都是用于视频和音频的。我不知道如何使它们适应 SWF 和 HTML 文件，而不是 SWF 和 MP4/OGG。

任何建议都将受到欢迎。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T23:01:53.080

看看[SWFObject](http://blog.deconcept.com/swfobject/#howitworks)，它是在网页中嵌入 Flash 的标准方法。如果您使用的是 CS5，您可以更改发布设置，以便生成的 HTML 自动包含 SWFObject 代码（请参阅[本教程](http://www.cloudninecreative.co.uk/flash/how-to-publish-as-html-swfobject-with-flash-cs5/)）。

此方法将允许您通过用 Flash 内容替换特定 div 的内容（应该包含您的后备方法）来[逐步增强您的页面，但前提是用户的浏览器支持 Flash。](http://en.wikipedia.org/wiki/Progressive_enhancement)此方法适用于任何不支持 Flash 的浏览器/设备。

# python - Pysandbox 配置问题

> ID：10390888
> 
> 赞同：3
> 
> 时间：2012-04-30T21:33:40.120
> 
> 标签：python, configuration, eval, sandbox

我有两个关于 Pysandbox 的问题：

1.  如何实现的功能`eval`？我理解`sandbox.execute()`相当于`exec`，但我找不到任何东西，如果输入的代码是`2 + 2`，那么它将返回`4`，或者类似的东西。

2.  默认情况下，`sandbox.execute()`将传入的环境设为只读——即如果我这样做`sandbox.execute('data.append(4)', locals={'data': [1, 2, 3]})`，则会发生错误。如何使传入的环境可读写？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:23:43.330

啊哈，我看到上一个 PySandbox 版本 (1.5) 的行为与您描述的一样。我正在尝试 git master 分支。

对于问题 1，我认为 PySandbox 1.5 没有任何直接的选项。该代码是专门编写的，以尝试禁止在沙箱内修改或传输任何状态。`sandbox.call(eval, CODE)`不是一个好的选择，因为你不能很容易地传入本地和全局命名空间（你可以尝试，但沙箱会代理它们，然后 eval() 将失败，因为本地和全局必须是真正的字典）。而且我相信您希望能够在这里设置本地和全局。

出于类似的原因，问题 2 也不简单。在当前的 git master 分支上，这两种方法都是可能的，但不清楚是因为错误还是设计：)

所以这里有两个问题的解决方案，它扩展了沙盒功能并使用了可能意味着私有接口的东西，但仍应与沙盒一样安全：

```
from sandbox.proxy import proxy
from sandbox.sandbox_class import _call_exec

def proxyNamespace(d):
    return dict((str(k), proxy(v)) for k, v in d.iteritems())

def wrapeval(codestr, globs, locs):
    subglobs = proxyNamespace(globs)
    sublocs = proxyNamespace(locs)
    return eval(codestr, subglobs, sublocs)

def eval_in_sandbox(sandbox, codestr, globs=None, locs=None):
    if globs is None:
        globs = {}
    if locs is None:
        locs = globs
    return sandbox._call(wrapeval, (codestr, locs, globs), {})

def exec_in_sandbox_with_mutable_namespace(sandbox, codestr, globs=None, locs=None):
    if globs is None:
        globs = {}
    if locs is None:
        locs = globs
    subglobs = proxyNamespace(globs)
    sublocs = proxyNamespace(locs)
    sandbox._call(_call_exec, (codestr, subglobs, sublocs), {})
    globs.update(subglobs)
    locs.update(sublocs) 
```

现在，说了这么多，我强烈建议*不要*将任何实际生产代码或系统的安全性建立在这个 PySandbox 模块上。在查看代码时，它似乎完全充满了缺陷和漏洞。我认为攻击者不会花费超过一个小时左右的时间来找到通过这种安全性的方法。我也不认为这经过安全专业人士的任何认真审查，甚至整个社区的很大一部分。如果你想运行不受信任的代码并且让它根本无法影响你的进程，你需要更强大的东西，可能基于 AppArmor 或类似的东西。如果您只担心意外行为不当的代码，而不是恶意代码，这可能没问题，但实际上我什至不确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T05:42:24.323

问题一：

```
sandbox.call(eval, "2+2") 
```

问题2：

```
from sandbox import Sandbox, SandboxConfig
cfg=SandboxConfig('stdout')
import sys

out1 = sys.stdout
err1 = sys.stderr
with open("logfile.txt", "w") as f:    
    sys.stdout = sys.stderr = f
    sandbox = Sandbox(cfg)
    indata={'data': [1, 2, 3]}
    sandbox.execute('a=list(data);a.append(4); print(str(a))', locals=indata)

sys.stdout = out1
sys.stderr = err1

with open("logfile.txt", "r") as f: 
    indata=eval(f.read())
    print indata 
```

关于问题 2 的一些评论，很难获得一个 Readable-Writebale 对象并同时从外部看到它。我想看看一些更聪明的方法。

**输出：**

```
$ python test.py 
[1, 2, 3, 4] 
```

# redirect - Paypal 付款数据传输不适用于“单击此处”链接

> ID：10390890
> 
> 赞同：0
> 
> 时间：2012-04-30T21:33:58.927
> 
> 标签：redirect, paypal, payment-gateway

我有一个网站使用 Paypal 允许客户从我们公司购买服务。当客户在 PayPal 上完成交易时，我正在使用支付数据传输 (PDT) 将交易 ID 传输回我们的网站（作为 GET 参数）。

如果用户按照最终 PayPal 页面上的说明等待 10 秒，这将正常工作。**但是**，如果他们单击“单击此处返回”的链接，则会将他们重定向到我们的网站**，但没有包含交易 ID 的 GET 参数！**

这对我们来说是个问题，因为我们需要交易 ID 才能继续购买。我已经记录了 PayPal 的一个故障，但他们说他们正在解决这个问题，而且看起来他们不会很快修复它。

当用户被重定向到我们的网站时，我还有其他方法可以获取交易 ID 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T21:32:33.530

今天早上我收到一条来自 PayPal 的消息说

> 感谢您的耐心等待。此消息是为了通知您该问题已通过最近的实时站点更新得到解决。

我已经检查并可以确认这现在可以正常工作。

# ios - NSSortDescriptor 将字符串字段排序为数字，比较器块不起作用

> ID：10390894
> 
> 赞同：5
> 
> 时间：2012-04-30T21:34:27.647
> 
> 标签：ios, core-data

我有一个充满第三方 id 的字段。id 是数字，但作为字符串写入数据库。

我想对按此 id 排序的整数值进行排序。所以我将这个添加`NSSortDescriptor`到`NSFetchRequest`.

```
NSNumberFormatter *numFormatter = [[NSNumberFormatter alloc] init];
[numFormatter setNumberStyle:NSNumberFormatterDecimalStyle];
NSSortDescriptor *sortBy = [[NSSortDescriptor alloc] initWithKey:@"someId" ascending:YES comparator:^(id a, id b) {
    return [[numFormatter numberFromString:a] compare:[numFormatter numberFromString:b]];
}];
[fetchRequest setSortDescriptors:[NSArray arrayWithObject:sortBy]]; 
```

但我得到如下结果。这些仍然按字母顺序排序为字符串。

```
730275292
73900038
730172867
7350727
830138437
835164
837287901
8338804
930274
9324376 
```

我对使用这个比较器块有什么不明白的地方？

编辑 2012 年 5 月 1 日美国东部标准时间上午 9:20

为了测试是否正在使用比较器块，我尝试了以下根据字段长度进行排序。

```
NSSortDescriptor *sortBy = [[NSSortDescriptor alloc] initWithKey:@"fbId" ascending:YES comparator:^(id a, id b) {
    if ([a length] < [b length]) {
        return NSOrderedAscending;
    } else if ([a length] > [b length]) {
        return NSOrderedDescending;
    } else {
        return NSOrderedSame;
    }
}];
[fetchRequest setSortDescriptors:[NSArray arrayWithObject:sortBy]]; 
```

我仍然得到按字母顺序排序的结果！所以这让我觉得比较器块甚至没有被使用。

```
716164250
726354466
73900038
739600038
7450727
810138437
801164
801375346
8213997 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-06-16T00:30:53.003

尝试这个 ！

```
[NSSortDescriptor sortDescriptorWithKey:@"name"
ascending:YES
selector:@selector(localizedStandardCompare:)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T13:50:21.697

我不使用 NSFetchRequest 所以我不能具体评论它，但它似乎与它相关。您在比较器块中使用的代码很好。我设置了您显示的确切数字的数组，然后使用您的代码对它们进行排序，一切正常：

```
 NSArray *array = [NSArray arrayWithObjects:@"730275292",
                      @"73900038",
                      @"730172867",
                      @"7350727",
                      @"830138437",
                      @"835164",
                      @"837287901",
                      @"8338804",
                      @"930274",
                      @"9324376", nil];
    NSNumberFormatter *numFormatter = [[NSNumberFormatter alloc] init];
    [numFormatter setNumberStyle:NSNumberFormatterDecimalStyle];
    NSArray *sArray = [array sortedArrayUsingComparator:^(id a, id b) {
        return [[numFormatter numberFromString:a] compare:[numFormatter numberFromString:b]];
    }];
    NSLog(@"%@",sArray); 
```

当上面的代码运行时，我得到一个日志：

```
(
    835164,
    930274,
    7350727,
    8338804,
    9324376,
    73900038,
    730172867,
    730275292,
    830138437,
    837287901
) 
```

我相信这是您正在寻找的订单。您可能会考虑在收到获取请求的结果后将它们排序到一个数组中。我怀疑数组是否进行排序或获取请求是否进行排序是否重要。很可能使用其中一种并没有性能提升。

如果您仍然希望 NSFetchRequest 进行排序，那么您可能会缺少一些东西以使其正确排序。老实说，我不确定，因为我没有使用过它。

更新

快速浏览 NSFetchRequest 文档，我发现有一些参数会影响排序。例如，在它的文档中`resultType`它给出了这个消息：

> 您可以使用 setResultType: 设置执行请求返回的对象的实例类型——有关可能的值，请参阅“NSFetchRequestResultType”。如果您将该值设置为 NSManagedObjectIDResultType，如果您未在请求中包含属性值，这会将任何排序顺序降级为“尽力而为”提示。

所以看起来返回类型可能会影响您的排序。

# python - 如何向使用生成器参数构造的 dict() 添加额外的键值对？

> ID：10390899
> 
> 赞同：8
> 
> 时间：2012-04-30T21:35:05.790
> 
> 标签：python, syntax

[可以使用生成器（ PEP-289](http://www.python.org/dev/peps/pep-0289/) ）创建字典：

```
dict((h,h*2) for h in range(5))
#{0: 0, 1: 2, 2: 4, 3: 6, 4: 8} 
```

是否可以在同一个 dict() 调用中添加一些额外的键值对？以下语法不正确，但更好地解释了我的问题：

```
dict((h,h*2) for h in range(5), {'foo':'bar'})
#SyntaxError: Generator expression must be parenthesized if not sole argument 
```

换句话说，是否可以在单个 dict() 调用中构建以下内容：

```
{0: 0, 1: 2, 2: 4, 3: 6, 4: 8, 'foo': 'bar' } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-30T21:39:55.320

构造函数：

```
dict(iterableOfKeyValuePairs, **dictOfKeyValuePairs) 
```

例子：

```
>>> dict(((h,h*2) for h in range(5)), foo='foo', **{'bar':'bar'})
{0: 0, 1: 2, 2: 4, 3: 6, 4: 8, 'foo': 'foo', 'bar': 'bar'} 
```

（请注意，如果不是唯一的参数，则需要将生成器表达式括起来。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:43:50.433

```
dict([(h,h*2) for h in range(5)] + [(h,h2) for h,h2 in {'foo':'bar'}.items()]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:38:43.117

您可以使用`itertools.chain`（请参阅[Concatenate generator 和 item](https://stackoverflow.com/questions/2443252/python-concatenate-generator-and-item)）将您的额外内容添加到对`dict()`.

不过，用简单的方法可能更清楚：一次调用`dict`，然后显式添加额外的项目。

# python - python、Json 和字符串索引必须是整数，而不是 str

> ID：10390900
> 
> 赞同：7
> 
> 时间：2012-04-30T21:35:11.147
> 
> 标签：python, json, url, httplib2

我正在使用 Python，我向 URL 发送了一个请求，并使用 httplib2 收到了回复。我得到的回复是在 JSon 中，我如何访问特定的参数。我目前拥有的是：

```
resp, content = parser.request(access_token_uri, method = 'POST', body = params, headers =     headers)
raise Exception(content['access_token']) 
```

我得到了错误

```
string indices must be integers, not str 
```

我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T21:41:34.473

好吧，如果响应类型是 json 并且它的类型为 str。

如果您正在运行 2.4 的 Python，请使用 simplejson 如果 2.6 使用 json：

```
import json
# Your code
  retdict = json.loads(content) 
```

然后像字典一样对待它。

```
accesstoken = retdict['access_token'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T11:05:18.273

你可以使用转储；

```
result = json.dumps(content)

result = json.loads(result) 
```

# php - 将 HTML Frame src 设置为 google.com；不工作

> ID：10390901
> 
> 赞同：0
> 
> 时间：2012-04-30T21:35:31.583
> 
> 标签：php, html, google-chrome

我有以下 php 代码：

```
<?php
require_once("support.php");

$query = $_POST["search"];

$google = "http://www.google.com/search?q=" . $query;
$bing = "http://www.bing.com/search?q=" . $query;
$yahoo ="http://search.yahoo.com/search?p=" . $query;
$ask = "http://www.ask.com/web?q=" . $query;

$body= "<html><head>";
$body .= "<script src=\"scripts.js\"></script>";
$body .= "</head>";
$body .= "<frameset rows=\"50%,50%\" cols=\"50%,50%\" >";
$body .= "<frame src=\"$google\" />";
$body .= "<frame src=\"$bing\" />";
$body .= "<frame src=\"$yahoo\" />";
$body .= "<frame src=\"$ask\" />";
$body .= "</frameset>";

$body .= "</html>";

echo $body;
?> 
```

生成以下html：

```
<html>
  <head>
      <script src="scripts.js"></script>
  </head>
  <frameset rows="50%,50%" cols="50%,50%" >
       <frame src="http://www.google.com/search?q=adf" />
       <frame src="http://www.bing.com/search?q=adf" />
       <frame src="http://search.yahoo.com/search?p=adf" />
       <frame src="http://www.ask.com/web?q=adf" />
  </frameset>
</html> 
```

当我在 google chrome 中打开它时，我从上面的 url 中得到了 4 个带有预期内容的帧。但在第一帧中，谁的 src 来自谷歌，我什么也没得到；只是一个空白框架。知道这里发生了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T21:45:52.417

Google 将其[`X-Frame-Options`](https://developer.mozilla.org/en/The_X-FRAME-OPTIONS_response_header)标头设置为`SAMEORIGIN`，这会禁止非 Google.com 网站嵌入其页面。大多数现代浏览器都尊重此设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T16:14:36.067

您可以使用 curl 让服务器下载 google 搜索结果页面，并将其提供给您的框架。

```
<?php 
function getHtml($url) {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);    
    curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']);  
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); 
    $result = curl_exec($ch);
    curl_close($ch);
    return $result;
}

$google = getHtml("https://encrypted.google.com/search?q=".$query) or die("dead!");
#....
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:44:30.857

您可以将开发人员工具用作 chrome 扩展。Firebug 也会做类似的工作。从您的网页中按 Ctrl+Shift+J，chrome 应该会弹出开发人员工具界面。

从这里，单击控制台，然后检查是否有任何错误消息。我记得使用 Same-Origin x-frame 选项遇到了类似的问题 - 但这是针对存在身份验证问题的 GDocs。在我的情况下没有简单的解决方法，我使用了一个单独的选项卡。

该主题也可能有所帮助： [如何将 Google Docs 集合嵌入到 iframe 中？](https://stackoverflow.com/questions/9103154/how-can-i-embed-a-google-docs-collection-in-an-iframe)

# c# - 以编程方式将边距和/或填充分配给标签

> ID：10390904
> 
> 赞同：5
> 
> 时间：2012-04-30T21:35:33.147
> 
> 标签：c#, winforms, padding, margin, tablelayoutpanel

在尝试让 TableLayoutPanel 中的一些标签从其单元格的左上角移动到单元格的中心时，我正在尝试添加填充和/或边距。

但是，我没有尝试过任何工作。这是我尝试过的代码和结果：

```
// Setting the padding just cuts off the bottom part of the text
//lbl.Padding = new System.Windows.Forms.Padding(1);

// How to set Margin?
//lbl.Margin = new System.Windows.Forms.Margin(1); <- This mimics "Padding" but is not recognized
//lbl.Margin = new Thickness(6); <- This is the only example I could find, but it's for WPF 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-30T21:38:53.837

尝试：

```
lbl.Margin = new Padding(1); 
```

您可能还想这样做：

```
lbl.Dock = DockStyle.Fill;
lbl.TextAlign = ContentAlignment.MiddleCenter;
lbl.AutoSize = false; 
```

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2015-02-06T14:25:28.120

```
labelName.Style.Add("Margin", "10px"); 
```

# php - 使用 PHP 和证书作为身份验证连接到 FTPS

> ID：10390907
> 
> 赞同：6
> 
> 时间：2012-04-30T21:35:43.653
> 
> 标签：php, curl, certificate, ftps

我很难建立与 FTPS 的连接。

我应该使用 SSL/TLS 和 AUTH（显式标准）进行连接。我有一个服务器地址和一个端口（：60000）和一个来自服务器所有者的公钥以及我自己的证书。

在谷歌搜索之后，我认为 curl 是我最好的选择，但我真的不知道使用什么 curl 选项。

有没有人有一个关于将文件连接并上传/下载文件到这样的 FTPS 的片段的工作示例？

这个页面有一些信息[http://php.net/manual/en/function.curl-setopt.php](http://php.net/manual/en/function.curl-setopt.php) 东同样认为但使用用户名/密码

```
$username = 'username';
$password = 'password';
$url = 'example.com';
$ftp_server = "ftp://" . $username . ":" . $password . "@" . $url;

echo "Starting CURL.\n";
$ch = curl_init();
echo "Set CURL URL.\n";

//curl FTP
curl_setopt($ch, CURLOPT_URL, $ftp_server);

//For Debugging
//curl_setopt($ch, CURLOPT_VERBOSE, TRUE);   

//SSL Settings
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);
curl_setopt($ch, CURLOPT_FTP_SSL, CURLFTPSSL_TRY);

//List FTP files and directories
curl_setopt($ch, CURLOPT_FTPLISTONLY, TRUE);

//Output to curl_exec
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

echo "Executing CURL.\n";
$output = curl_exec($ch);
curl_close($ch);
echo "Closing CURL.\n";
echo $output . "\n";
$files = explode("\n", $output);
print_r($files); 
```

有什么想法可以改用证书吗？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-21T14:22:33.363

我知道反应迟钝，但我也一直在为此苦苦挣扎，以下两段代码最终为我工作，所以即使对你来说为时已晚，也许它会帮助其他人。就我而言，我只需要使用 CA 证书验证对等方，因此如果您需要通过对等方验证自己（当然除了用户/通行证之外），您可能需要集成下面的第三块代码。

**下载（仅限 CA 证书）**

```
$ftp_server = 'ftps://YOUR-SERVER-NAME/';
$ftp_user = 'FTP-USER-NAME';
$ftp_password = 'FTP-PASSWORD';

$ftp_certificate = 'PATH TO CA CERT'; 
// ...e.g./var/www/certs/ssl-certificate.pub.crt    
$source_file = 'REMOTE-FILE-PATH';
$destination_file = 'LOCAL-FILE-PATH';

$file = fopen($destination_file, 'w');

$ch = curl_init();

curl_setopt($ch, CURLOPT_VERBOSE, TRUE);
curl_setopt($ch, CURLOPT_URL, $ftp_server . $source_file);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERPWD, $ftp_user . ':' . $ftp_password);
curl_setopt($ch, CURLOPT_TIMEOUT, 400);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 400);
curl_setopt($ch, CURLOPT_FILE, $file);

//SSL
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_CAINFO, $ftp_certificate);
curl_setopt($ch, CURLOPT_FTP_SSL, CURLFTPSSL_ALL);
curl_setopt($ch, CURLOPT_FTPSSLAUTH, CURLFTPAUTH_SSL);

curl_exec($ch);
$error_no = curl_errno($ch);
$error_msg = curl_error($ch);
curl_close ($ch);
if ($error_no == 0) {
    $msg = 'File downloaded succesfully.';
} else {
    $msg = 'File download error:' . $error_msg . ' | ' . $error_no;
}
fclose($file);
echo $msg; 
```

* * *

**上传（仅限 CA 证书）**

```
$ftp_server = 'ftps://YOUR-SERVER-NAME/';
$ftp_user = 'FTP-USER-NAME';
$ftp_password = 'FTP-PASSWORD';

$ftp_certificate = 'PATH TO CA CERT'; 
// ...e.g./var/www/certs/ssl-certificate.pub.crt    
$source_file = 'LOCAL-FILE-PATH';
$destination_file = 'REMOTE-FILE-PATH';

$file = fopen($source_file, 'r');

$ch = curl_init();

curl_setopt($ch, CURLOPT_VERBOSE, TRUE);
curl_setopt($ch, CURLOPT_URL, $ftp_server . $destination_file);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERPWD, $ftp_user . ':' . $ftp_password);
curl_setopt($ch, CURLOPT_TIMEOUT, 400);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 400);

curl_setopt($ch, CURLOPT_UPLOAD, 1);
curl_setopt($ch, CURLOPT_INFILE, $file);
curl_setopt($ch, CURLOPT_INFILESIZE, filesize($source_file));

//SSL stuff
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_CAINFO, $ftp_certificate);

curl_setopt($ch, CURLOPT_FTP_SSL, CURLFTPSSL_ALL);
curl_setopt($ch, CURLOPT_FTPSSLAUTH, CURLFTPAUTH_SSL);

$upload_result = curl_exec($ch);
$upload_info = curl_getinfo($ch);
$error_no = curl_errno($ch);
$error_msg = curl_error($ch);
curl_close ($ch);
if ($error_no == 0) {
    $msg = 'File uploaded succesfully.';
} else {
    $msg = 'File upload error:' . $error_msg . ' | ' . $error_no;
}

fclose($file);
echo $msg . '(' . filesize($source_file) . ')'; 
```

您可以像这样检查响应代码，例如：

```
if ($upload_info['http_code'] == '226') {...} 
```

* * *

**添加公钥/私钥（在之前添加`curl_exec`）**

```
// A private SSL key.
// If your key file has a password, you will need to set
// this with CURLOPT_SSLKEYPASSWD
curl_setopt($ch, CURLOPT_SSLKEY, $keyFile);

// A PEM formatted certificate- with CURLOPT_SSLCERTTYPE
// you could also use DER or ENG formats
curl_setopt($ch, CURLOPT_SSLCERT, $certFile);
curl_setopt($ch, CURLOPT_SSLCERTPASSWD, $certPass); 
```

当然，您可能不得不摆弄 PHP、Apache 和 nginx 中的超时限制，就像我在安装麻烦的 Plesk 时所做的那样，如果文件很大并且传输速度很慢。

# ios - 放大动画 - c4framework

> ID：10390910
> 
> 赞同：1
> 
> 时间：2012-04-30T21:35:46.490
> 
> 标签：ios, c4

我正在使用 alpha C4 框架玩不同的动画。

我正在尝试从画布的中间开始塑造形状，直到它完全覆盖它......有没有可以创建缩放效果的动画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T22:53:17.140

是的，您可以像这样更改 C4Shape 并为其设置动画：

```
shape.animationDuration = 1.0f; //1 second animation duration
[shape rect:(-1,-1,769,1025)]; 
```

请注意，以上是针对四边都比 iPad 屏幕大 1 像素的矩形。要制作一个椭圆，您必须计算出包含覆盖整个屏幕的椭圆的框架的大小。

# javascript - 强制发布请求在新页面加载之前完成提交

> ID：10390915
> 
> 赞同：1
> 
> 时间：2012-04-30T21:36:02.277
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery $.post 方法在单击某个元素时向 PHP 脚本提交 ajax 请求。我不关心服务器返回的值 - 我只想确保我的数据已提交。

但是，接收点击的元素可能包含超链接图像或带有多个链接的 flash 元素。即使用户离开页面，如何确保我的脚本接收到发布请求（同样，我不关心它的响应）？我正在使用下面的代码：

```
jQuery(document).ready(function($) {
    $(".click-track").mousedown(function(e) { // click() will not pass through a flash movie, so we must use mousedown
        ad_id = $(this).data("ad-id");
        var data = {
            action: 'log_click',
            adId: ad_id
        };
        $.ajaxSetup({async: false});
        $.post(myscript.php, data, function(data) {
            // Do nothing because we don't care about the response
        }, 'html');
    });
}); 
```

我不是浏览器脚本专家，这段代码让我很困惑。我将不胜感激您能提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:38:47.290

在 Javascript 中处理重定向，并在收到响应后使其发生。此外，您可能不想要 AJAX——您可能想要同步发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:50:36.047

如果您在 mousedown 处理程序中执行 e.preventDefault() ，您可以在 $.post 调用中简单地执行此操作：

```
$(".click-track").mousedown(function(e) { // click() will not pass through a flash movie, so we must use mousedown
    e.preventDefault();
    ad_id = $(this).data("ad-id");
    var data = {
        action: 'log_click',
        adId: ad_id
    };
    $.ajaxSetup({async: false});
    var jqxhr = $.post(myscript.php, data, function(data) {
        // Do nothing because we don't care about the response

    }, 'html');
    jqxhr.complete(function(){ $(this).trigger('click'); });
}); 
```

这应该创建一个 ajax 对象并在 POST 请求完成时附加一个函数，该函数应该触发对最初 mousedown 元素的单击。我已经让它与非 Flash 元素一起使用，不确定它是否适用于 Flash 对象，但它应该。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T22:30:15.870

如果你想强制你的代码阻塞直到帖子完成，我建议使用 .ajax() 代替并将 async 字段设置为 false。像这样：

```
$.ajax({
 //some fields
 async:false,
 //some more fields
}); 
```

现在，您的 js 将阻塞，直到调用返回。虽然我会警告你这不是首选。

编辑：如果元素是超链接，则需要调用 event.preventDefault()。将链接的 href 属性设置为“javascript:void(0);”也是值得的。

# php - 如何定位图片弹出按钮

> ID：10390918
> 
> 赞同：0
> 
> 时间：2012-04-30T21:36:05.580
> 
> 标签：php, javascript, html, css

所以我有这个问题。我想将我的弹出窗口居中，但这是关键。我不知道图片的尺寸是多少，因为它是用户上传的图片。如果我把屏幕变小，我也不会让图片消失。我试图将位置设置为相对，但随后它会将我的图像/文本推到弹出窗口后面。

```
<div id="imageFlyout<?=$step['order']+1?>" class="popUpWrapper" style="display:none;position:absolute;top:100px;left:<script type="text/JavaScript">
            int w = screen.width;
            <?php $tempSize=getimagesize("guidebook_images/".$step['attachment']); if($tempSize[0] > 935){?>w/2<?php }else{?>w-<?php echo($tempSize[0]/2);}?></script>px;"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T14:53:41.427

Centering in HTML is an easy two step process:

**Give the parent:**

```
text-align:center; 
```

**Give the element:**

```
margin:auto; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T16:03:40.477

演示：http: [//jsfiddle.net/uriahjamesgd_73/kNFGj/22/](http://jsfiddle.net/uriahjamesgd_73/kNFGj/22/)

我使用 CSS 值 VW（查看器宽度）和 VH（查看器高度）来指定浮出控件是给定实例中视口的百分比。希望这允许在移动设备中调整视口的大小。

```
<!-- HTML -->
<div class="wrap">
  <div class="product">
    <span class="flyOut"></span>
  </div>
</div>​

/* CSS */
body { margin: 50px; }
.wrap { position: relative; }
.product { background-color: #555; position: relative; width: 100px; height: 75px; }
span.flyOut { display: none; background-color: #ddd; position: absolute; width: 50vw; height: 37.5vh; left: 100%; }
.product:hover > span.flyOut { display: inline-block; } 
```

​</p>

# ant - Apache Ant 1.6.5 - 清理未使用的 Jar 文件

> ID：10390919
> 
> 赞同：0
> 
> 时间：2012-04-30T21:36:08.653
> 
> 标签：ant, jar

我在发帖前搜索了论坛。但我可以找到合适的答案。

我们正在使用 Apache Ant 1.6.5 来构建我们的 Java 企业应用程序。我们正在使用大量外部 jar 文件来编译和构建应用程序。我想清理未使用的 jar 文件。

识别和删除未使用的罐子的简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:57:54.140

查看 Jboss的[tattletale](http://www.jboss.org/tattletale)工具。

# java - 如何让 JTIdy 使 HTML 文档格式正确？

> ID：10390922
> 
> 赞同：7
> 
> 时间：2012-04-30T21:36:36.733
> 
> 标签：java, html, xml, parsing, jtidy

我正在使用 JTidy v. r938。我正在使用此代码来尝试清理页面……</p>

```
final Tidy tidy = new Tidy();
tidy.setQuiet(false);
tidy.setShowWarnings(true);
tidy.setShowErrors(0);
tidy.setMakeClean(true);
Document document = tidy.parseDOM(conn.getInputStream(), null); 
```

但是当我解析这个 URL 时—— [http://www.chicagoreader.com/chicago/EventSearch?narrowByDate=This+Week&eventCategory=93922&keywords=&page=1](http://www.chicagoreader.com/chicago/EventSearch?narrowByDate=This+Week&eventCategory=93922&keywords=&page=1)，事情并没有得到清理。例如，页面上的 META 标签，如

```
<META http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

保持为

```
<META http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

而不是具有“</META>”标签或显示为“<META http-equiv="Content-Type" content="text/html; 字符集=UTF-8"/>"。我通过将生成的 JTidy org.w3c.dom.Document 作为字符串输出来确认这一点。

我可以做些什么来使 JTidy 真正清理页面——即使其格式正确？我意识到那里还有其他工具，但这个问题特别与使用 JTIdy 有关。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T22:04:42.233

如果你想要 XML 格式，你需要为 Tidy 指定几个标志

```
private String cleanData(String data) throws UnsupportedEncodingException {
    Tidy tidy = new Tidy();
    tidy.setInputEncoding("UTF-8");
    tidy.setOutputEncoding("UTF-8");
    tidy.setWraplen(Integer.MAX_VALUE);
    tidy.setPrintBodyOnly(true);
    tidy.setXmlOut(true);
    tidy.setSmartIndent(true);
    ByteArrayInputStream inputStream = new ByteArrayInputStream(data.getBytes("UTF-8"));
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    tidy.parseDOM(inputStream, outputStream);
    return outputStream.toString("UTF-8");
} 
```

或者只是如果想要 XHTML 表单

```
Tidy tidy = new Tidy();
tidy.setXHTML(true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T16:22:35.030

使用 tidy.setXmlTags(true); 解析 XML 而不是 HTML

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-05T21:27:31.330

即使发现错误，也要使用`Tidy.setForceOutput(true)`（风险自负）生成输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-06T06:01:25.493

我解析 HTML 2 次以获得格式良好的 xml

```
 BufferedReader br = new BufferedReader(new StringReader(str));
  StringWriter sw = new StringWriter();

  Tidy t = new Tidy();
  t.setDropEmptyParas(true);
  t.setShowWarnings(false); //to hide errors
  t.setQuiet(true); //to hide warning
  t.setUpperCaseAttrs(false);
  t.setUpperCaseTags(false);
  t.parse(br,sw);
  StringBuffer sb = sw.getBuffer();
  String strClean = sb.toString();
  br.close();
  sw.close();

  //do another round of tidyness
  br = new BufferedReader(new StringReader(strClean));
  sw = new StringWriter();

  t = new Tidy();
  t.setXmlTags(true);
  t.parse(br,sw);
  sb = sw.getBuffer();
  String strClean2 = sb.toString();
  br.close();
  sw.close(); 
```

# php - PHP中的simplexml解析

> ID：10390924
> 
> 赞同：0
> 
> 时间：2012-04-30T21:36:44.663
> 
> 标签：php, simplexml

我在 php 中使用 print_r() 得到了以下信息。

```
SimpleXMLElement Object
(
    [@attributes] => Array
        (
            [term] => hello world
            [scheme] => Organization
        )
) 
```

如何使用 php simplexml 访问方案节点？由于@符号，我无法使用节点@attributes

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:44:42.093

您将使用这样的数组表示法访问属性：

```
$scheme = $obj['scheme']; 
```

请参阅PHP 手册页中的[Basic SimpleXML Usage](http://www.php.net/manual/en/simplexml.examples-basic.php)。它显示了访问属性以及其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:45:43.723

如果您的对象被分配给一个名为 $my_xml 的变量，您可以通过 $my_xml['term'] 和 $my_xml['scheme'] 访问这两个属性。[http://php.net在](http://php.net)[http://php.net/manual/en/simplexml.examples-basic.php](http://php.net/manual/en/simplexml.examples-basic.php)有一些很好的例子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T23:16:40.757

在这里，您将了解如何使用 simplexml 访问对象和属性

```
$xml->object
$xml['attribute'] 
```

[http://php.net/manual/en/simplexml.examples-basic.php](http://php.net/manual/en/simplexml.examples-basic.php)下的更多基础知识

# python - 樱桃服务器上的瓶子+ ssl

> ID：10390927
> 
> 赞同：12
> 
> 时间：2012-04-30T21:36:50.187
> 
> 标签：python, ssl, cherrypy

我正在尝试在 Cherrypy 的服务器上运行 Bottle。我想获得 SSL 支持。

到目前为止，我已经尝试过：

```
from bottle import Bottle, route
from cherrypy import wsgiserver

app = Bottle()

@app.route("/")
def index():
  return "Hello"

server = wsgiserver.CherryPyWSGIServer(
            ('0.0.0.0', 443), app)

server.ssl_adapter.private_key = 'server.key'
server.ssl_adapter.certificate = 'server.crt'
server.start() 
```

但是上面抛出了一个 ArgumentError，我无法在 None 对象（ssl_adpater）上设置属性。显然我需要将 ssl_adapter 属性设置为从 SSLAdapter 派生的某个对象，但我找不到任何示例。

我正在使用 Python 2.7 和 Cherrypy 3.2.2

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-30T21:49:03.433

尝试使用以下内容：

```
import web
from web.wsgiserver import CherryPyWSGIServer
from web.wsgiserver.ssl_builtin import BuiltinSSLAdapter

ssl_cert = "path/to/ssl_certificate"
ssl_key = "path/to/ssl_private_key"

CherryPyWSGIServer.ssl_adapter = BuiltinSSLAdapter(ssl_cert, ssl_key, None) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-30T21:55:05.000

我没有尝试以下方法，但希望它应该为您指明正确的方向。

[WSGI](http://en.wikipedia.org/wiki/Web_Server_Gateway_Interface)通常用于 Apache Httpd 等 Web 服务器和 Python Web 应用程序之间的通信，其中请求由 Web 服务器处理并由 Python 应用程序处理。由于您想要一个独立的应用程序，因此使用 WSGI 适配器听起来不太正确，尽管[本文档中提到了这一点](http://webpy.org/cookbook/ssl)（但对于旧版本的 CherryPy）。

较新版本的 CherryPy`cherrypy.quickstart(...)`用于其独立服务器。这听起来更适合您的应用程序。我建议使用[本页](http://www.zacwitte.com/using-ssl-https-with-cherrypy-3-2-0-example)所述的配置，如下所示：

```
config={
    'server.socket_port': 443,
    'server.ssl_module':'pyopenssl',
    'server.ssl_certificate':'/.../host.crt',
    'server.ssl_private_key':'/.../host.key',
    'server.ssl_certificate_chain':'/.../ca_certs.crt'
}

cherrypy.config.update(config)
cherrypy.quickstart(...) 
```

这也将更符合[`_cserver`文档](http://docs.cherrypy.org/stable/refman/_cpserver.html#module-cherrypy._cpserver)。

（顺便说一下，HTTPS 的默认端口是 443，而不是 433。）

# python - “for-in 循环”的学习指数

> ID：10390935
> 
> 赞同：1
> 
> 时间：2012-04-30T21:37:39.497
> 
> 标签：python

我有一个列表，它包含列表。内部列表可能为空。这是结构：

```
[[],[a,b],[],[c],[d]] 
```

我的代码：

```
for inner in list:
   for char in inner:
      print char           # I want to add indexes of inner lists here 
```

输出是：

```
abcd 
```

我希望输出为：

```
2a2b4c5d 
```

这些数字是内部列表的索引。有没有快速的方法来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T21:41:24.420

请注意，您不应将`list`其用作变量名，因为它`shadows`是内置`list`类型。

```
>>> lst = [[],['a','b'],[],['c'],['d']]
>>> for idx, inner in enumerate(lst):
      for char in inner:
        print idx, char

1 a
1 b
3 c
4 d 
```

您会看到`enumerate()`从零开始计数。您可以指定第二个参数作为开始，以匹配您的基于一的预期输出：

```
>>> for idx, inner in enumerate(lst, 1):
    for char in inner:
        print idx, char

2 a
2 b
4 c
5 d 
```

但只有在必要时才这样做，python 按照惯例从 0 开始计数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T21:46:34.883

要获得准确的输出，一种方法是直接写入 sys.stdout。打印命令（在 2.x 中）最多只能在每个索引 + 字符之间留下空格。

```
import sys
for ndx, inner in enumerate([[],['a','b'],[],['c'],['d']], 1):
    for char in inner:
        sys.stdout.write('%d%s' % (ndx, char)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T21:41:36.323

```
for i, inner in enumerate(myList):  # just add an index variable here
    for char in inner:
        print i          # and use it wherever you need to
        print char 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T21:44:01.343

这应该有效：

```
for i in range(len(list)):
    for char in list[i]:
        print i+1
        print char 
```

（键入此 oO 时出现三个新答案）

# forms - 从数组填充的选择表单中回显选定的选项

> ID：10390939
> 
> 赞同：1
> 
> 时间：2012-04-30T21:38:19.907
> 
> 标签：forms, wordpress, select, options, selected

我正在构建一个自定义插件并对我的所有代码进行排序，我的数据被保存到数据库中并且我可以检索它，但是有两件事让我感到困惑。

1，当我从数组填充表单回显保存的数据时，我收到了！索引号，没有任何值....

2，我的数组是下拉形式，如何从数据库中检索数据并将其作为“选定”选项回显？

非常感谢。

```
<td><select name="league1_driver1_team"><?php foreach($l1teams as $team_id => $team_name){?> <option <?php selected( $l1d1t, 1 ); ?> value="<?php echo $team_id; ?>"><?php echo $team_name ?></option> <?php } ?> </select></td> 
```

# php - 有条件的二维数组的最大值？

> ID：10390942
> 
> 赞同：0
> 
> 时间：2012-04-30T21:38:47.090
> 
> 标签：php, arrays, multidimensional-array

我有一个包含这些值的数组：

```
Array
(
    [0] => Array
    (
        [0] => John
        [1] => 2012-03-29
        [2] => 1
    )
    [1] => Array
    (
        [0] => Doe
        [1] => 2012-03-30
        [2] => 1
    )
    [2] => Array
    (
        [0] => John
        [1] => 2012-03-31
        [2] => 2
    )
    [3] => Array
    (
        [0] => Doe
        [1] => 2012-03-31
        [2] => 5
    )
    [4] => Array
    (
        [0] => John
        [1] => 2012-04-02
        [2] => 5
    )
    [5] => Array
    (
        [0] => John
        [1] => 2012-04-02
        [2] => 21
    )
) 
```

`array[][2]`我正在尝试获取中每个日期的最大值`array[][1]`。

例如，在数组中

```
Array[2][1] = 2012-03-31 | Array[2][2] = 2
Array[3][1] = 2012-03-31 | Array[3][2] = 5 
```

这两天我想保留`Array[3]`和丢弃`Array[2]`。

我尝试了一个 foreach 函数：

```
foreach ($days as $k) {
    $max_vals[] = array($k[0], $k[1], max($k[2]));
} 
```

却发现那是不行的日子。如何对这个数组进行排序，保持每天的最高值，然后丢弃其余的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:51:58.503

这是解决此问题的一种方法：

*   使用 foreach 遍历数组

*   在 foreach 循环中，按名称、日期、数字对新数组进行分组

*   如果存在，则与以前的值进行比较，如果数字更高，则覆盖

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:57:41.300

试试这个：

```
$bigArray=array(
array('John','2012-03-29',1),
array('Doe','2012-03-30',1),
array('John','2012-03-31',2),
array('Doe','2012-03-31',5),
array('John','2012-04-02',5),
array('John','2012-04-02',21),
array('John','2012-03-07',21)   
);
$output=array();
foreach($bigArray as $element){
if($element[1]>$output[$element[2]]){
$output[$element[2]]=$element[1];
}}

echo '<pre>';
print_r($output); 
```

这输出：

```
Array
(
    [1] => 2012-03-30
    [2] => 2012-03-31
    [5] => 2012-04-02
    [21] => 2012-04-02
) 
```

或得到相反的结果：

```
 $bigArray=array(
    array('John','2012-03-29',1),
    array('Doe','2012-03-30',1),
    array('John','2012-03-31',2),
    array('Doe','2012-03-31',5),
    array('John','2012-04-02',5),
    array('John','2012-04-02',21),
    array('John','2012-03-07',20)   
    );
$output=array();
    foreach($bigArray as $element){
    if($element[2]>$output[$element[1]]){
    $output[$element[1]]=$element[2];
    }}
echo '<pre>';
print_r($output); 
```

这打印：

```
Array
(
    [2012-03-29] => 1
    [2012-03-30] => 1
    [2012-03-31] => 5
    [2012-04-02] => 21
    [2012-03-07] => 20
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-30T21:59:56.713

以下代码将遍历 $data 中的每个值，将新遇到的日期添加到`$cache`或检查它是否更大。

```
$cache = array();
// Note: $data is the array you provided above, replace with your variable name.
foreach ($data as $k => $v) {
  if (isset($cache[$v[1]])) {
    if ($cache[$v[1]] < $v[2]) {
      $cache[$v[1]] = $v[2];
    }
  } else {
    $cache[$v[1]] = $v[2];
  }
} 
```

完成后，`$cache`将是一个数组，其值为日期，键为`array[][2]`.

# css - 覆盖锚颜色以继承默认颜色

> ID：10390945
> 
> 赞同：9
> 
> 时间：2012-04-30T21:38:56.630
> 
> 标签：css, inheritance

我正在尝试覆盖锚颜色并将颜色设置为通常没有链接的颜色。

```
a .right {
    color:inherit;
}
a:link .right {
    color:inherit;
}
```

```
<a href="...">
    <div class="right">
        <div class="text">
            Some Text
        </div>
    </div>
</a>
```

两者似乎都不起作用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-30T21:52:58.047

在锚本身上放置一个类，然后设置：

```
.yourAnchorClass { color: inherit; } 
```

[请参阅小提琴示例。](http://jsfiddle.net/PN2Pj/2/)

继承来自*父*元素。所以你所有的解决方案都是告诉`div`s 继承锚的颜色。`div`顺便说一句，在`a`标签内（内联元素内的块级元素）实际上是无效的 HTML4 。如果可以的话，最好将它们更改为`span`然后设置`display: block`在`a`.

# javascript - Chrome 桌面通知点击关注内容

> ID：10390946
> 
> 赞同：15
> 
> 时间：2012-04-30T21:39:04.057
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在将桌面通知构建到我正在开发的 chrome 扩展中。我需要的功能要求用户在单击通知窗口时被带到导致通知的选项卡。我可以使用 chrome.tabs API 使其正常工作，但我无法弄清楚当点击通知时如何将 Chrome 置于最前面。

我知道 window.focus() 在 chrome 中被禁用，但这绝对是可能的，因为这是 Gmail 桌面通知的行为。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-30T21:45:23.183

```
notification = webkitNotifications.createNotification(...)
notification.onclick = function(){
    window.focus();
    this.cancel();
};
notification.show() 
```

...按预期工作，没有任何额外的权限。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T07:21:24.380

用于[`chrome.tabs.update(tabId, {active: true});`](http://code.google.com/chrome/extensions/tabs.html#method-update)聚焦选项卡（不要与 混淆[`chrome.windows.update`](http://code.google.com/chrome/extensions/windows.html#method-update)）。

通常`tabId`通过[`Tab`type](http://code.google.com/chrome/extensions/tabs.html#type-Tab)获得。该对象被传递给许多方法/事件监听器（有时通过[`MessageSender`type](http://code.google.com/chrome/extensions/extension.html#type-MessageSender)）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-29T22:48:46.573

```
function msg(){
    var notification = new Notification("Title", {body: "Yore message", icon: "img.jpg" });
    notification.onshow = function() { setTimeout(notification.close(), 15000); };
    notification.onclick = function(){
        window.focus();
        this.cancel();
    };
}
msg(); 
```

# iphone - 我有一个 iPad 应用程序由于未捕获的异常“NSInternalInconsistencyException”而不断终止应用程序

> ID：10390948
> 
> 赞同：0
> 
> 时间：2012-04-30T21:39:13.067
> 
> 标签：iphone, ios, uitableview

第一个按钮显示总统列表，当您单击他们时，您会看到他们的维基百科页面。一切正常，直到我添加另一个按钮，让您将页面的语言从英语更改为德语等。我在调试器中不断收到此错误：

-[UITableView _createPreparedCellForGlobalRow:withIndexPath:], /SourceCache/UIKit_Sim/UIKit-1914.84/UITableView.m:6061 2012-04-30 17:30:01.293 Presidents[11151:f803] 中的断言失败*** 由于未捕获的异常而终止应用程序' NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:' *** First throw call stack:

我正在阅读一本书教程，我再次认为他们缺少代码。任何想法都会很棒！

编辑：菜鸟继续前进，伙计们，我粘贴了错误的代码部分：这个新部分是我在 BIDMasterViewController 之后添加的自定义弹出框，它工作正常。这个新部分是问题出现的地方：

```
 #import "BIDLanguageListController.h"
#import "BIDDetailViewController.h"

@interface BIDLanguageListController ()

@end

@implementation BIDLanguageListController

@synthesize languageNames;
@synthesize languageCodes;
@synthesize detailViewController;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.languageNames = [NSArray arrayWithObjects:@"English", @"French",
                          @"German", @"Spanish", nil];
    self.languageCodes = [NSArray arrayWithObjects:@"en", @"fr", @"de", @"es", nil];
    self.clearsSelectionOnViewWillAppear = NO;
    self.contentSizeForViewInPopover = CGSizeMake(320.0, [self.languageCodes count] * 44.0);

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

- (void)viewDidUnload
{
    [super viewDidUnload];

    self.detailViewController = nil;
    self.languageNames = nil;
    self.languageCodes = nil;
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{

    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.
    return [self.languageCodes count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...
    cell.textLabel.text = [languageNames objectAtIndex:[indexPath row]];

    return cell;
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
   detailViewController.languageString = [self.languageCodes objectAtIndex:
                                          [indexPath row]];
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T23:06:50.723

你从来没有真正实例化单元格！网上有很多关于如何重用 UITableViewCells 的优秀文档。

Apple 的 Table View Programming Guide 非常棒，绝对值得一读：http: [//developer.apple.com/library/ios/documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html#//apple_ref/doc/uid/TP40007451 -CH7-SW1](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html#//apple_ref/doc/uid/TP40007451-CH7-SW1)

同时，为了快速修复，请将您的方法更改为：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    //THIS IS THE IMPORTANT PART YOU ARE MISSING
    if(cell == nil) {
        //AND IF YOU PUT AN NSLOG IN HERE, YOU'LL SEE THIS IS CALLED ABOUT THE
        //NUMBER OF TIMES FOR THE INITIALLY VISIBLE CELLS ON THE SCREEN, PLUS 1 OR 2
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...
    cell.textLabel.text = [languageNames objectAtIndex:[indexPath row]];

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T14:58:32.560

注意到 Xcode 的模板犯了与教程中提到的相同的错误，我决定进一步调查并得出不同的结论。问题不在于单元格的实例化，而在于 cellIdentifier。当一个人在 .xib*或*类中更改 cellIdentifier 时，就会出现问题，但两者都没有。当第一次加载 .xib 时，显然单元格以 .xib 中指定的标识符排队。然后，当代码运行时，单元格总是可以出队，除非代码坚持使用不同的单元格标识符，例如@"Cell"。检查单元格是否为 nil 并实例化单元格会违背可重用单元格的目的。所以，我的回答是，去掉所有 `if(cell == nil)`语句，然后检查你的单元格标识符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T23:06:35.353

如果一个 UITableViewCell 不能从你的 UITableView 中出列，你必须启动一个 UITableViewCell。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if(cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...
    cell.textLabel.text = [languageNames objectAtIndex:[indexPath row]];

    return cell;
} 
```

# cakephp - Cakephp 不保存下拉列表

> ID：10390949
> 
> 赞同：0
> 
> 时间：2012-04-30T21:39:20.060
> 
> 标签：cakephp, model, drop-down-menu, save

我有一个关系游戏属于类型。在游戏的添加视图中，我看到一个带有各种类型标题的下拉列表，它们在我的表中是 VARCHAR。但是当我选择一个并按保存时，它会保存类型的 ID 而不是标题（尽管在我的下拉列表中我选择了标题。当我在 PHPmyAdmin 中创建游戏时，一切正常。我的代码：

游戏模型

```
class Game extends AppModel {

    public $name = 'Game';
    public $primaryKey = 'id';
    public $belongsTo =  array

     (
  'Type' => array (
        'className' => 'Type',
        'foreignKey' => 'type_id'
     )); 
```

在 GameController 中添加功能

```
 public function add() {
$types = $this->Game->Type->find('list',array('fields' => array('title')));
$this->set('types',$types);

    if ($this->request->is('game')) {
        if ($this->Game->save($this->request->data)) {
            $this->Session->setFlash('Your game has been created.');
            $this->redirect(array('action' => 'index'));
        } else {
            $this->Session->setFlash('Unable to add your game.');
        }
    }
} 
```

添加类型视图

```
 <h1>Add Game</h1>
<?php
echo $this->Form->create('Game',array('action' => 'edit'));
echo $this->Form->input('tablename',array('rows' => '1'));
echo $this->Form->input('date');
echo $this->Form->input('type_id');
echo $this->Form->end('Save Games');
?> 
```

我希望有人能找到解决办法。如果需要更多信息，请随时询问。

提前感谢您和最良好的祝愿。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T21:45:31.983

```
//Add function in your controller

$types= $this->Game->find('list', array(
    'conditions' => array('Game.type_id'),
    'fields'     => array('Game.id', 'Game.title')
));
$this->set(compact('types'));

// view
echo $this->Form->input('type_id', array(
    'type'    => 'select',
    'options' => $types,
    'empty'   => false
)); 
```

# ruby-on-rails - Rails 3.1 ActionMailer：“弃用警告：不推荐使用 charset()”

> ID：10390951
> 
> 赞同：0
> 
> 时间：2012-04-30T21:39:22.510
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, actionmailer

回复：Rails 的 ActionMailer 中的这段代码...

[https://github.com/rails/rails/commit/b5f9a9fce316e96ffb9ab3a69e9311f8b1e56fde#actionmailer/lib/action_mailer/base.rb-P14](https://github.com/rails/rails/commit/b5f9a9fce316e96ffb9ab3a69e9311f8b1e56fde#actionmailer/lib/action_mailer/base.rb-P14)

上面的链接包含一个关于 ActionMailer 产生的警告的代码注释：

```
DEPRECATION WARNING: charset() is deprecated and will be removed in future versions. 
```

有什么已知的解决方案吗？

**更新**

你可能讨厌它，但为了继续我的一天，我只是把它放在我的邮件类中，直到我可以升级到 rails 3.2：

```
def charset
  @charset
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T22:37:55.867

你确定这仍然是一个问题？Mail gem 中的 charset 方法没有任何关于弃用警告的信息。我想知道这是否适用于特定版本的邮件 gem，并且它已被更改。

[https://github.com/mikel/mail/blob/master/lib/mail/message.rb#L1423](https://github.com/mikel/mail/blob/master/lib/mail/message.rb#L1423)

# php - MySQL + PHP - 根据之前的选择结果选择信息

> ID：10390953
> 
> 赞同：0
> 
> 时间：2012-04-30T21:39:51.730
> 
> 标签：php, mysql, select

我正在整合 PHP 和 MySQL。以下代码工作正常：

```
<?php
include_once("conf.php");

$sql = "SELECT Name,Address FROM customers";
$rs = mysqli_query($connect,$sql) or die("can't connect to DB");
$temp = mysqli_num_rows($rs);

while($row = mysqli_fetch_array($rs))
{
  $convert = mb_convert_encoding ($row['Name'],"UTF-8","gbk");
  $print .= "<tr><td>".$convert."</td><td>".$row['Address']."</td><td>".$sql2."</td></tr>\n";
} 
```

此代码正在运行，但现在我需要根据此表的结果（名称）从另一个表中选择特定信息。

所以，这将是另一个 MySQL 选择：

```
$sql2 = "select History from Delivery where Name="$convert"; 
```

根据我客户的**“姓名”**（来自客户表），我需要在**交付**表中获取他的**“历史记录” 。**

 **所以，我会打印他的：姓名+地址+历史

最好的解决方案是什么？

@@@@@@@@@ 解决了 @@@@@@@@@@

```
$sql = 'SELECT * FROM customers c 
            INNER JOIN Delivery d 
            ON c.Name = d.Name';

$result = mysqli_query($connect, $sql);
$temp = mysqli_num_rows($rs);

while($row = mysqli_fetch_array( $result))
{
  $convert = mb_convert_encoding ($row['Name'],"UTF-8","gbk");
  $print .= "<tr><td>".$convert."</td><td>".$row['Address']."</td><td>".$row['History']."</td></tr>\n";
} 
```

我目前的情况是：我需要从三个表中获取信息。

表：客户、用户、历史。

从客户那里我需要大量的客户。

从交货开始，我需要历史记录（基于客户数量）。

来自用户我需要姓名（实际上它几乎是一个昵称）。

**由于这三个表有一个“名称”列并且我不能更改列名，我如何使用该 INNER JOIN 语句从用户而不是客户或交付中获取名称？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:41:48.723

听起来您只想对名称上的这两个表进行 INNER JOIN 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:42:05.933

在第一个表上进行连接以一次获取您需要的所有数据：

```
$sql = 'SELECT * FROM customers c 
            INNER JOIN Delivery d 
            ON c.Name = d.Name';

$result = mysqli_query($connect, $sql);

while($row = mysqli_fetch_array( $result))
{
    echo $row['History'] . ' ' . $row['Name'];
} 
```

这使您不再需要第二个查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T03:09:02.970

Darkeden，您可以执行 SELECT customers.* 或者您可以执行 SELECT customers.name as 'CName' 等。使用这样的别名，您可以稍后执行 echo $row['CName']。**

# python - Pygame 刷新率慢

> ID：10390956
> 
> 赞同：0
> 
> 时间：2012-04-30T21:40:17.197
> 
> 标签：python, pygame

我创建了 Pygame，它具有在屏幕上随机移动的对象（球），并且鼠标控制用户移动的角色以避免其他对象。但是在屏幕上移动的随机球刷新率很慢（你可以看到它们在移动时闪烁）。

不知道是哪部分代码惹的祸，四处走动的对象都加载在这里：

```
ballpic = pygame.image.load('ball.png').convert_alpha() 
```

我不怪游戏的其他部分，所以我可以包含问题，所以我创建了一个包含游戏代码（短游戏）的 pastebin [http://pastebin.com/H6KkTvZU 。](http://pastebin.com/H6KkTvZU)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T22:16:01.397

您调用循环`display.update()`的每次迭代 `for i in range(enemies)`。`blit`在完成所有精灵之后，尝试每帧执行一次。

更妙的是，学会`display.flip()`正确使用；如果您更新大部分屏幕，它会更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:13:33.857

[Pygame 新手教程](http://www.pygame.org/docs/tut/newbieguide.html)还有一些其他有用的建议，特别是如果您的帧速率仍然太低，如何使用“脏矩形动画”。

# php - 在 PHP 中将 Mongo DB 和 Collection 名称指定为变量

> ID：10390957
> 
> 赞同：3
> 
> 时间：2012-04-30T21:40:19.567
> 
> 标签：php, mongodb

MongoDB 的 PHP 库允许我连接到这样的集合（[来自示例](http://www.php.net/manual/en/mongo.tutorial.php)）：

```
$m = new Mongo(); 
$db = $m->comedy; 
$collection = $db->cartoons; 
```

但是如何将数据库和/或集合名称指定为变量？我想做的是这样的：

```
$m = new Mongo();
$dbname = "comedy"; 
$collectionname = "cartoons"; 
$db = $m[$dbname]; 
$collection = $db[$collectionname]; 
```

我可以[使用 Python API](http://api.mongodb.org/python/2.1.1/tutorial.html)来做到这一点，所以我发现我无法使用 PHP 来做到这一点很奇怪。

更新：这是我在使用上述方法时遇到的错误，这让我相信没有使用变量名来处理 MongoDB 集合的内置方法？

```
Fatal error: Cannot use object of type Mongo as array 
```

答案：根据下面接受的答案，这将起作用：

```
$db = $m->$dbname; 
$collection = $db->$collectionname; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:44:52.233

您仍然可以使用 -> 即`$m->$dbname`通过[http://php.net/manual/en/mongo.tutorial.php通过变量获取它](http://php.net/manual/en/mongo.tutorial.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-22T10:25:59.740

更新的`mongodb`库代码：

```
$dbname = "comedy";
$collectionname = "cartoons";
$collection = (new MongoDB\Client("mongodb://".$config["MONGO_USER"].":".$config["MONGO_PASS"]."@".$config["MONGO_SERVER"]."/".$dbname))
        ->{$dbname}->{$collectionname};

$insertOneResult = $collection->insertOne([
    'data'=>"my data"
]); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-15T12:24:44.923

这将适用于使用的“名称”是 PHP 中的有效 var 名称的规定（例如，如果您在“集合”名称上使用空格，它将失败）。

# ios - 如何创建一个开源的 iOS 项目？

> ID：10390958
> 
> 赞同：6
> 
> 时间：2012-04-30T21:40:33.150
> 
> 标签：ios, xcode, provisioning, provisioning-profile

我将如何为 iOS 创建一个任何人都可以编译的 Xcode 项目？

我想做的是编写一个简单的应用程序并将整个内容（只需归档整个项目文件夹）发送给朋友，以便他可以编译它并在自己的设备上进行测试。

我们俩都分别注册为独立的 iOS 开发者；我们都可以下载示例项目并成功运行它们；*我*可以在我的iPad 上运行我的应用程序。但是，当我将存档发送给我的同事时，他无法对其进行测试（他说它会构建但不会尝试在设备上安装或运行，只会抱怨“找不到有效的签名身份”）。

显然，我不了解开发配置文件如何工作的过程中的某些内容。肯定有某种方法可以生成任何人都可以编译的项目，并且不需要我的配置文件在机器上，或者示例项目将无法编译？（为什么只有源代码形式的项目甚至需要附加一个配置文件？）

我是否正确理解 1) 我以某种方式将我的个人开发人员信息捆绑到纯源项目中，这阻止了另一个未连接的开发人员构建它，以及 2) 如果是这样，实际上可以共享项目这样？我将如何将项目与配置文件分开？

我隐约意识到这也是共享项目的“错误”方式：我也愿意接受改变它的建议，但仍然想了解我做错了什么，以及我错过了一些必须显而易见的事情在配置过程中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T21:53:46.953

> 我将如何为 iOS 创建一个任何人都可以编译的 Xcode 项目？

您将像为其他平台上的项目一样提供项目文件、资源和代码。不要提供您的开发人员配置文件或密钥——每个想要构建项目的人都必须自己提供这些。

> 但是，当我将存档发送给我的同事时，他无法对其进行测试（他说它会构建但不会尝试在设备上安装或运行，只会抱怨“找不到有效的签名身份”）。

他需要提供自己的开发人员资料和密钥。

> 为什么只有源代码形式的项目甚至需要附加一个配置文件？

因为 iOS 设备不会执行未正确签名的代码。

> 我将如何将项目与配置文件分开？

这里没什么可做的——您的配置文件和密钥存储在您的钥匙串中，而不是项目本身中。

> 我隐约意识到这也是共享项目的“错误”方式

这确实不是“错误的”，但如果您要经常分享，这不是最简单的方法。有一些服务可以为小型团体或开源项目提供[廉价](http://beanstalkapp.com/)或[免费的](https://github.com/plans) [版本](http://code.google.com/hosting/) [控制，并且以这种方式共享比来回邮寄项目副本要容易得多。](http://www.atlassian.com/software/bitbucket/overview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T21:58:06.607

它与 OpenSource 项目无关，只是您的合作伙伴正在尝试使用您的证书进行编译。转到项目设置 -> 构建设置，在代码签名部分下查找代码签名身份，并将其更改为**iPhone Developer**。这样，XCode 将选择与 App ID 匹配的签名身份。如果这不起作用，请确保您有符合条件的配置文件，然后转到 Window -> Organizer 并检查 Developer Profile 和 Provisioning Profiles 部分。

附带说明一下，要在人们之间共享项目，我建议您使用控制版本系统，例如 Subversion 或 Github。OpenSource 项目有很多免费的存储库。

如果您需要更多信息，请告诉我。

# .net - 如何在其 Tag 属性中找到具有特定值的 TreeViewItem

> ID：10390959
> 
> 赞同：2
> 
> 时间：2012-04-30T21:40:40.940
> 
> 标签：.net, wpf, treeview, treeviewitem

我正在尝试查找`TreeViewItem`其`Tag`属性设置为特定值的特定对象。以下`FindNode`仅适用于第一级项目或如果父级`TreeViewItem`展开，则适用于其他级别。在下面的示例中，如果“FFF”被扩展，则按`FindNode`预期工作。我假设`ContainerFromItem`返回 null 因为项目尚未创建。有没有办法强制创建所有 TreeViewItems？

```
 <TreeView x:Name="__items">

        <TreeViewItem Header="AAA"
                      Tag="{x:Static my:Node.A}" />

        <TreeViewItem Header="BBB"
                      Tag="{x:Static my:Node.B}">

            <!-- Items will be added later. -->

        </TreeViewItem>

        <TreeViewItem Header="CCC"
                      Tag="{x:Static my:Node.C}" />

        <TreeViewItem Header="DDD"
                      Tag="{x:Static my:Node.D}" />

        <TreeViewItem Header="EEE"
                      Tag="{x:Static my:Node.E}" />

        <TreeViewItem Header="FFF"
                      Tag="{x:Static my:Node.F}">

            <TreeViewItem Header="GGG"
                          Tag="{x:Static my:Node.G}" />

            <TreeViewItem Header="HHH"
                          Tag="{x:Static my:Node.H}" />

        </TreeViewItem>

        <TreeViewItem Header="III"
                      Tag="{x:Static my:Node.I}" />

    </TreeView> 
```

* * *

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        this.Loaded += new RoutedEventHandler(MainWindow_Loaded);    
    }

    private void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        TreeViewItem a = FindNode(__items.ItemContainerGenerator, __items.Items, Node.H); 
    }

    private TreeViewItem FindNode(ItemContainerGenerator gen, ItemCollection items, Node value)
    {
        TreeViewItem oResult = null;

        foreach (var oItem in items)
        {
            TreeViewItem oTreeViewItem = (TreeViewItem)gen.ContainerFromItem(oItem);

            if (oTreeViewItem == null) { continue; }

            if ((Node)oTreeViewItem.Tag == value) { oResult = oTreeViewItem; break; }

            if (oTreeViewItem.Items.Count > 0)
            {
                oResult = FindNode(oTreeViewItem.ItemContainerGenerator, oTreeViewItem.Items, value);

                if (oResult != null) { break; }
            }
        }
        return oResult;
    }

}

public enum Node { A, B, C, D, E, F, G, H, I, J, } 
```

* * *

根据 hbarck 的回答，正确的`FindNode`实现是：

```
 private TreeViewItem FindNode(ItemCollection items, Node value)
    {
        TreeViewItem oResult = null;

        foreach (var oItem in items)
        {
            TreeViewItem oTreeViewItem = (TreeViewItem)oItem;

            if ((Node)oTreeViewItem.Tag == value) { oResult = oTreeViewItem; break; }

            if (oTreeViewItem.Items.Count > 0)
            {
                oResult = FindNode(oTreeViewItem.Items, value);

                if (oResult != null) { break; }
            }
        }
        return oResult;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T14:01:04.477

是的，您可以强制在 ItemsControl 中创建项目。访问 ItemContainerGenerator，然后（这就是魔法；））将其转换为 IItemContainerGenerator，因为接口是显式实现的。使用 StartAt 和 GenerateNext 可以强制创建项目。

请参阅：[为什么 ItemContainerGenerator 返回 null？](https://stackoverflow.com/questions/3289116/wpf-why-itemcontainergenerator-returns-null) 您只需要为所有项目执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:24:50.700

确保您的 TreeViewItems 存在的最简单方法可能是在它们中的每一个上设置 IsExpanded="True"，并在 TreeView 上将 IsVirtualizing 设置为 False。只是出于好奇：如果您不使用 ItemGenerator 而是直接迭代 Items 集合会发生什么？由于您没有使用 DataTemplate，我想 Items 集合应该包含 XAML 文件中的硬编码项。

我做了以下测试：

```
<Window x:Class="MainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="MainWindow" Height="350" Width="525">
<StackPanel>
    <TreeView x:Name="TestTreeView">
        <TreeViewItem Header="Item 1">
            <TreeViewItem Header="Item 1 1"/>
            <TreeViewItem Header="Item 1 2"/>
        </TreeViewItem>
        <TreeViewItem Header="Item 2"/>
    </TreeView>
    <Button x:Name="TestButton" Click="TestButton_Click">Test</Button>
</StackPanel>
</Window> 
```

和后面的代码：

```
Class MainWindow 

    Private Sub TestButton_Click(sender As System.Object, e As System.Windows.RoutedEventArgs)

        Stop
        For Each t As TreeViewItem In Me.TestTreeView.Items
            Debug.Print("Item: {0}, Child count:{1}", t.Header, t.Items.Count)
        Next
    End Sub
End Class 
```

调试窗口中的输出是

```
Item: Item 1, Child count:2
Item: Item 2, Child count:0 
```

这意味着项目被实例化并且可以迭代，即使在子级别中也是如此。可能会影响您的是 ItemContainerGenerator，它实际上仅在您使用 DataTemplates 时才需要。此外，您可能必须等到窗口的 Loaded 事件之后才能实例化所有项目。

# c++ - C++ Xerces-c - 如何判断节点是否为占位符

> ID：10390962
> 
> 赞同：1
> 
> 时间：2012-04-30T21:40:51.067
> 
> 标签：c++, xml-parsing, xerces-c

我一直在使用 C++ 和 Xerces-c 开发 XML 解析器，但我似乎遇到了一个我无法解决的问题（不是主要问题，我可以解决但不想“破解“我的方式:))

我有一个这样的 XML 文件

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Config>
<Person>
    <Title>Mr.</Title>
    <Forename>Stephen</Forename>
    <Surname>Cassidy</Surname>
    <Job>
        <Title>Position1</Title>
        <Position>Worker</Position>
        <Salary>£6.40</Salary>
    </Job>
    <Job>
        <Title>NewJob</Title>
        <Position>PositionWorker1</Position>
        <Position>AnotherPosition</Position>
        <Salary>£12,000</Salary>
    </Job>
</Person> 
```

我想要做的是弄清楚一个节点是否只是其他子节点的“占位符”，例如`<Person>`节点或`<Job>`节点，并检查它是否有子节点，而不是尝试任何处理。

这样做的原因是我将节点值存储在一个类中，该类存储节点名称（例如 Title）和值（例如 NewJob），以及子条目列表，所以 Job 将是一个节点条目，然后是 Title， Position 和 Salary 都将是 Job 的“子”条目。但是，我希望能够检查 Job 是否已经有 Position 条目，而不是创建一个新条目并将其添加到 Job，只需将 Position 的值添加到已经存在的 Position 条目......如果这样对任何人都有意义:)

任何帮助将不胜感激，我不希望有人为我编写代码或任何东西，只是一些提示或指针:)！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T16:20:01.163

在这种情况下，我建议使用 SAX 解析器。如果您构建自己的对象，则不需要创建 DOM，并且可以在 SAX 运行期间轻松填充自己的对象。这将减少内存消耗，并且在处理大文件时可能会更快。

基本上，使用 SAX 解析器是一个序列

```
SAX2XMLReaderImpl*  sax_parser = new SAX2XMLReaderImpl();
MyDefaultHandler*  docHandler = new MyDefaultHandler(); // derived from DefaultHandler

sax_parser->setContentHandler(docHandler);
sax_parser->parse(pszPath); 
```

SAX 接口的详细文档可以在这里找到： [SAX2XMLReader](http://xerces.apache.org/xerces-c/apiDocs-3/classSAX2XMLReader.html#a1885becac34443e9648ccaeeed733f5)

当 Xerces 解析 XML 时，将通过在 MyDefaultHandler 类中实现的回调调用您。根据您的需要在那里填充您的对象。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T16:27:58.010

`Job`应该有 type`ELEMENT_NODE`而另一个应该有 type `TEXT_NODE`。您可以使用该[`getNodeType()`](http://xerces.apache.org/xerces-c/apiDocs-3/classDOMNode.html#4ceca7c2d979f1e42c4d96329fbd7bc1)成员检查类型，然后根据需要进行操作。

# vhdl - 硬件中的叠加图

> ID：10390964
> 
> 赞同：1
> 
> 时间：2012-04-30T21:41:05.007
> 
> 标签：vhdl

特别是它一个简单的鼠标光标。我已经在软件中实现了这一点，但在硬件中很难做到这一点。在软件中，我可以将位图存储为一个常量数组，然后引用它以获得 vga 显示所需的颜色信息。我在硬件中尝试了类似的方法，但意识到恒定信号只存在于模拟中而不存在于合成中。

我在精神上被困在一个盒子里，想要一些建议来帮助我摆脱它，这样我就可以完成这个。正如我的老师经常说的那样，我需要在硬件方面进行思考。

该软件是这样的：

```
 const char mouse_data{ 0xff, 0x bb ... };
 color = mouse_data[1];
 vga_write(vga_base, offset, color); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:44:35.197

是的，考虑硬件是 FPGA 编程时要做的第一件事。

因此，在您的软件实现中，您的`const char`阵列存储在计算机的内存中 - 因此解决方案可能是在您的 FPGA 设备中创建一些内存，然后将其存储在那里。大多数 FPGA 都有某种内置内存，您可以推断（编写代码使其自动映射到内存块）或实例化（编写代码以直接使用特定的内存块类型）。通常，您还可以指定一个数据块以在配置期间预加载它。

例如，在 Xilinx 芯片上，您可以添加一个新的 IP 内核，选择 Xilinx Memory Generator，然后生成一个只读 BlockRam，预加载您的光标数据。这是一种可能性，尽管不一定是最好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T07:44:24.397

“成本”当然是可以综合的。因此，您必须向我们提供您的代码，以了解为什么它不适合您。

根据使用的语法， const 在大多数综合 VHDL 中被实现为解码器/多路复用器。
可能导致您出现问题的是“char”，它可能无法合成，但没有什么可以阻止您创建一个“char”类型。

想象一个 N:1 多路复用器，其中 N 的输入值固定为 0 或 1 而不是信号。这是一个 const 可以用作寄存器输入的某种赋值。

# javascript - D3：精炼序数比例以返回颜色组？

> ID：10390971
> 
> 赞同：6
> 
> 时间：2012-04-30T21:41:38.143
> 
> 标签：javascript, d3.js

我在[D3.js](https://github.com/mbostock/d3/wiki/API-Reference)中设置了一个序数比例，如下所示，到目前为止效果很好：

```
var color = d3.scale.ordinal().range([ 'blue', 'red', 'green' ]); 
color.domain();  
console.log(color(0)); // returns 'blue' 
```

但是，我真正想做的是能够将**两个**数字传递给比例，并让它返回一个特定的蓝色、红色或绿色子阴影——主要阴影取决于第一个数字，子阴影取决于第二个数字。

也许我可以以某种方式将[d3.scale.ordinal()](https://github.com/mbostock/d3/wiki/Ordinal-Scales#wiki-ordinal)与[d3.interpolateRgb()](https://github.com/mbostock/d3/wiki/Transitions#wiki-d3_interpolateRgb)结合使用来做到这一点？我不确定 interpolateRgb 是否是正确的选择，因为颜色是否一致很重要，具体取决于输入数字。

所以这就是我想要实现的目标：

```
color(0, 256); // return a shade of blue
color(0, 257); // return a second shade of blue
color(0, 256); // return the first shade of blue again 
```

在 D3 中实现这一点的任何想法？感谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T01:40:58.317

你可以考虑这样的事情：

```
var colorgroup = d3.scale.ordinal()
    .domain(d3.range(3))
    .range([ 'blue', 'red', 'green' ]); 
var brightrange = d3.scale.linear()
    .domain([0,300])
    .range([0,3]);  
function color(group,shift) {
     if (shift >= 0) {return d3.hsl(colorgroup(group)).darker(brightrange(shift));}
     else {return d3.hsl(colorgroup(group)).brighter(brightrange(-shift));}             
} 
```

例子：

```
console.log(color(0,255)); //dark blue
console.log(color(0,0)); //med blue
console.log(color(0,-150)); //light blue 
```

# java - Netbeans 没有正确生成 javadoc

> ID：10390976
> 
> 赞同：0
> 
> 时间：2012-04-30T21:41:56.180
> 
> 标签：java, javadoc, netbeans-7

这是我为我的项目编写的课程示例，并以意大利语记录：

```
/**
 * Eccezione da lanciare nel caso si verifichi un guasto al motore.
 * Eredita da <a  href="http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Exception.html">
 * java.lang.Exception </a>.
 * 
 * @author Ramy Al Zuhouri
 * @version 1.0
 */
package truckingCompany.utilities;

public class EngineFailureException extends Exception
{
    /**
     * Viene chiamato il costruttore della superclasse Exception, con un 
     * messaggio che descrive l' accaduto.
     */
    public EngineFailureException()
    {
        super("Guasto al motore durante il rientro alla base");
    }
} 
```

但是生成javadoc有一个问题：在生成的html页面中看不到注释的上半部分。
所以这部分：

```
/*
 * Eccezione da lanciare nel caso si verifichi un guasto al motore.
 * Eredita da <a  href="http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Exception.html">
 * java.lang.Exception </a>.
 * 
 * @author Ramy Al Zuhouri
 * @version 1.0
 */ 
```

未显示在页面中。如何强制 netbeans 也包含这些评论？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:48:23.723

这是因为那不是 javadoc 注释。Javadoc 注释如下所示：

```
/**
*
*
*/ 
```

而你的是：

```
/*
*
*
*/ 
```

注意到第一行的区别了吗？如果您将另一个添加`*`到顶行以使其`/**`正常工作。

有关 Java 中注释类型的更多信息，[请阅读此处。](http://www.roseindia.net/java/language/java-comments.shtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T09:06:13.467

您是否尝试将其放在类之上而不是包之上？

# sql - 从应用程序向表中添加新列时的数据库设计问题

> ID：10390982
> 
> 赞同：5
> 
> 时间：2012-04-30T21:42:31.243
> 
> 标签：sql, sql-server, sql-server-2008, database-design

我目前正在处理一个项目。现在出现的问题是，我必须处理数据库表中的动态列。

我有一张表，其中将存储`Charges`与每个费用对应的不同费用的数量。`Client`假设此表具有以下列-

```
Client_Id     Charge_1     Charge_2     Charge_3     Charge_4 
```

现在，管理员可以`new Charges`为客户申请更多。在这种情况下，新费用将添加到`Charges`表中`column`。这需要在应用程序运行时而不是数据库设计时处理。这是我的想法。

但是，它看起来不适合我。

有没有更好的办法来处理这个问题？？请给我建议。

提前致谢。我是这个数据库设计的新手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T21:49:40.297

做一个复合表，即ClientCharges

您可以保留原始费用表和客户表，并且在客户费用表中包含以下列：

ClientChargeId、ClientId、ChargeId

在您的费用表中，您可以继续添加（您需要多少费用），然后在 ClientCharges 表中引用 ChargeId。

```
CREATE TABLE ClientCharges
(
    ClientChargeId          INT IDENTITY(1,1)
    , ClientId              INT 
    , ChargeId              INT
)

INSERT INTO ClientCharges
(ClientId, ChargeId)
VALUES
(1, 1),
(1,2),
(1,3),
(1,4),
(2,1),
(3,1),
(3,2),
(4,3),
(4,4) 
```

*   客户 1 的费用为 1、2、3 和 4
*   客户 2 有费用 1
*   客户 3 有费用 1 和 2
*   客户 4 有费用 3 和 4

然后在 ClientId 和 ChargeId 字段上添加外键约束。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-30T22:09:26.993

听起来您真正想要的是一对多的表关系。

您要做的是创建一个包含两列 Client_id 和费用的表，然后为每个费用添加一个新行。

我不清楚你打算如何使用它。这些“收费”是个人交易吗？还是他们与客户相关的收费类型？无论如何，像这样修改数据模型是不好的形式。

当您拥有这些类型的重复字段时，只需将它们设为自己的表格即可。

# c++ - 要引用的默认值，c++

> ID：10390987
> 
> 赞同：0
> 
> 时间：2012-04-30T21:42:49.187
> 
> 标签：c++, reference, return, default

所以我制作了一个链接列表，其中包含我创建的类对象的引用。

我想做一个在链接列表中搜索并返回对对象的 const 引用（如果它存在）的方法，否则，如果对象不存在，则返回一些值。

它应该是什么值？如果是 int，我会返回 0，如果是指针，我会返回 NULL....

```
const Node& NodeList::NodeNumSearch(int num) const
{
    Member *TempHead=MemberHead;
    while(TempHead!=NULL)
    {
        if(TempHead->GetNode().getNum() == num)
            return TempHead->GetNode();
        TempHead=TempHead->GetNext();
    }

    return ???;
} 
```

PS一个Member对象是链表的成员。Node对象是链表的Member对象中的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T21:46:52.820

在这种情况下是一个异常，或者`throw`将您的函数更改为通过指针返回。只是没有一种理智的方法可以在这里返回“空”引用。

或者采用标准库方法并按值返回类似交互器的代理，然后您可以检查它是否正确`end`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T21:56:05.877

您可以将自己的 NullNode 定义为静态成员 var 并返回它。

```
// header
class NodeList
{
    .....

    static Node k_NullNode;
};

// cpp
/* static */ Node NodeList::k_NullNode; // you might need to pass a special argument to make it different from normal nodes.

const Node& NodeList::NodeNumSearch(int num) const
{
    ....

    return k_NullNode;
}

// test
void test()
{
    const Node& ret = NodeNumSearch(0);
    if( ret == NodeList::k_NullNode ) // you might need to override == operator.
    {
        // failed to search..
    }
    else
    {
        // succeeded..
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T21:50:17.253

我认为在 C/C++ 中，通常您传递一个指针来保存结果，并根据函数是否工作实际返回一个值。或者，如果它不起作用，您应该抛出异常，而不是传回默认对象。仅当您希望其他代码使用该默认值时才将默认值传回 - 对于似乎不太可能的搜索。

```
// Inject Node pointer to hold the reference
// Returns 1 if it worked, 0 otherwise
const int NodeList::NodeNumSearch(int num, Node* node) const
{
  //your code here
} 
```

# python - 在 .txt 文件中查找最常用单词的 Python 程序，必须打印单词及其计数

> ID：10390989
> 
> 赞同：15
> 
> 时间：2012-04-30T21:42:53.633
> 
> 标签：python

截至目前，我有一个替换 countChars 函数的函数，

```
def countWords(lines):
  wordDict = {}
  for line in lines:
    wordList = lines.split()
    for word in wordList:
      if word in wordDict: wordDict[word] += 1
      else: wordDict[word] = 1
  return wordDict 
```

但是当我运行程序时，它会吐出这个可憎的东西（这只是一个例子，旁边有大约两页字数很大）

```
before 1478
battle-field 1478
as 1478
any 1478
altogether 1478
all 1478
ago 1478
advanced. 1478
add 1478
above 1478 
```

虽然这显然意味着代码足够健全，可以运行，但我并没有从中得到我想要的。它需要打印文件中每个单词有多少次（gb.txt，这是葛底斯堡地址）显然文件中的每个单词都不在那里精确 1478 次..

我对编程很陌生，所以我有点难过..

```
from __future__ import division

inputFileName = 'gb.txt'

def readfile(fname):
  f = open(fname, 'r')
  s = f.read()
  f.close()
 return s.lower()

def countChars(t):
  charDict = {}
  for char in t:
    if char in charDict: charDict[char] += 1
    else: charDict[char] = 1
  return charDict

def findMostCommon(charDict):
  mostFreq = ''
  mostFreqCount = 0
  for k in charDict:
    if charDict[k] > mostFreqCount:
      mostFreqCount = charDict[k]
      mostFreq = k
  return mostFreq

def printCounts(charDict):
  for k in charDict:
    #First, handle some chars that don't show up very well when they print
    if k == '\n': print '\\n', charDict[k]  #newline
    elif k == ' ': print 'space', charDict[k]
    elif k == '\t': print '\\t', charDict[k] #tab
    else: print k, charDict[k]  #Normal character - print it with its count

def printAlphabetically(charDict):
  keyList = charDict.keys()
  keyList.sort()
  for k in keyList:
    #First, handle some chars that don't show up very well when they print
    if k == '\n': print '\\n', charDict[k]  #newline
    elif k == ' ': print 'space', charDict[k]
    elif k == '\t': print '\\t', charDict[k] #tab
    else: print k, charDict[k]  #Normal character - print it with its count

def printByFreq(charDict):
  aList = []
  for k in charDict:
    aList.append([charDict[k], k])
  aList.sort()     #Sort into ascending order
  aList.reverse()  #Put in descending order
  for item in aList:
    #First, handle some chars that don't show up very well when they print
    if item[1] == '\n': print '\\n', item[0]  #newline
    elif item[1] == ' ': print 'space', item[0]
    elif item[1] == '\t': print '\\t', item[0] #tab
    else: print item[1], item[0]  #Normal character - print it with its count

def main():
  text = readfile(inputFileName)
  charCounts = countChars(text)
  mostCommon = findMostCommon(charCounts)
  #print mostCommon + ':', charCounts[mostCommon]
  #printCounts(charCounts)
  #printAlphabetically(charCounts)
  printByFreq(charCounts)

main() 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-01T13:55:27.927

如果您需要计算文章中的单词数，那么最好使用正则表达式。

让我们从一个简单的例子开始：

```
import re

my_string = "Wow! Is this true? Really!?!? This is crazy!"

words = re.findall(r'\w+', my_string) #This finds words in the document 
```

结果：

```
>>> words
['Wow', 'Is', 'this', 'true', 'Really', 'This', 'is', 'crazy'] 
```

请注意，“是”和“是”是两个不同的词。我的猜测是，您希望对它们进行相同的计数，因此我们可以将所有单词大写，然后对它们进行计数。

```
from collections import Counter

cap_words = [word.upper() for word in words] #capitalizes all the words

word_counts = Counter(cap_words) #counts the number each time a word appears 
```

结果：

```
>>> word_counts
Counter({'THIS': 2, 'IS': 2, 'CRAZY': 1, 'WOW': 1, 'TRUE': 1, 'REALLY': 1}) 
```

你到这里还好吗？

现在我们需要做和上面一样的事情，只是这次我们正在读取一个文件。

```
import re
from collections import Counter

with open('your_file.txt') as f:
    passage = f.read()

words = re.findall(r'\w+', passage)

cap_words = [word.upper() for word in words]

word_counts = Counter(cap_words) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-30T21:47:05.910

如果您使用强大的工具，这个程序实际上是一个 4 行：

```
with open(yourfile) as f:
    text = f.read()

words = re.compile(r"[\w']+", re.U).findall(text)   # re.U == re.UNICODE
counts = collections.Counter(words) 
```

正则表达式将查找所有单词，而不管与它们相邻的标点符号（但将撇号计为单词的一部分）。

计数器的作用几乎就像字典一样，但您可以执行`counts.most_common(10)`、 和添加计数等操作。请参阅`help(Counter)`

我还建议您不要制作 functions `printBy...`，因为只有没有副作用的函数才易于重用。

```
def countsSortedAlphabetically(counter, **kw):
    return sorted(counter.items(), **kw)

#def countsSortedNumerically(counter, **kw):
#    return sorted(counter.items(), key=lambda x:x[1], **kw)
#### use counter.most_common(n) instead

# `from pprint import pprint as pp` is also useful
def printByLine(tuples):
    print( '\n'.join(' '.join(map(str,t)) for t in tuples) ) 
```

演示：

```
>>> words = Counter(['test','is','a','test'])
>>> printByLine( countsSortedAlphabetically(words, reverse=True) )
test 2
is 1
a 1 
```

*编辑以解决 Mateusz Konieczny 的评论：用 [\w'] 替换 [a-zA-Z'] ... 字符类 \w，根据 python 文档，“匹配 Unicode 单词字符；这包括大多数可以任何语言的单词的一部分，以及数字和下划线。如果使用 ASCII 标志，则仅匹配 [a-zA-Z0-9_]。（...但显然不匹配撇号...）但是 \w 包括 _ 和 0-9，所以如果你不想要这些并且你没有使用 unicode，你可以使用 [a-zA -Z']; 如果您正在使用 unicode，您需要做一个否定断言或从 \w 字符类中减去 [0-9_] 的东西*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T21:49:02.493

~~你有一个简单的错字，`words`你想要的地方`word`。~~

~~编辑：您似乎已经编辑了源代码。请使用复制和粘贴在第一时间正确处理。~~

**编辑2：**显然你不是唯一一个容易出现拼写错误的人。真正的问题是你有`lines`你想要的地方`line`。对于指责您编辑源代码，我深表歉意。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-05-06T21:31:36.747

```
 words = ['red', 'green', 'black', 'pink', 'black', 'white', 'black', 
'eyes','white', 'black', 'orange', 'pink', 'pink', 'red', 'red', 
'white', 'orange', 'white', "black", 'pink', 'green', 'green', 'pink', 
'green', 'pink','white', 'orange', "orange", 'red']

 from collections import Counter
 counts = Counter(words)
 top_four = counts.most_common(4)
 print(top_four) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-30T22:09:09.537

这是一个可能的解决方案，不像 ninjagecko 那样优雅，但仍然：

```
from collections import defaultdict

dicto = defaultdict(int)

with open('yourfile.txt') as f:
    for line in f:
        s_line = line.rstrip().split(',') #assuming ',' is the delimiter
        for ele in s_line:
            dicto[ele] += 1

 #dicto contians words as keys, word counts as values

 for k,v in dicto.iteritems():
     print k,v 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-05T07:36:33.483

导入集合并定义函数

```
from collections import Counter 
def most_count(n):
  split_it = data_set.split() 
  b=Counter(split_it)  
  return b.most_common(n) 
```

调用指定您想要的前 'n' 个单词的函数。在我的情况下 n=15

```
most_count(15) 
```

# ruby-on-rails - RoR 需要为员工 - 用户正确编码

> ID：10390991
> 
> 赞同：0
> 
> 时间：2012-04-30T21:43:01.253
> 
> 标签：ruby-on-rails

我有一个用户表和一个员工表。他们是一对一的关系。当我创建时间输入记录时，我想自动分配当前员工。我可以访问的是 current_user。雇员表有一个外键（user_id）。

我在表格中尝试了这个 - 但它没有用：

```
<%= f.hidden_field :employee_id, :value => current_user.employee.employee_id %> 
```

我需要向 user table = employee_id 添加外键吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T22:15:28.593

所以你的员工模型

```
belongs_to :user 
```

和你的用户模型

```
has_one :employee 
```

是对的吗？

如果是这样，它可能就像将隐藏字段值更改为一样简单

```
current_user.employee.id 
```

（而不是 current_user.employee.employee_id）。

如果这不起作用，您能否准确发布您是如何构建一对一关系的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T22:43:16.443

您最好的选择可能是`employee_id`在控制器中设置。如果是您正在为其构建表单`@entry`的模型实例（调用它），请考虑执行以下操作：`Entry`

```
# in controller +new+ method:
@entry.employee_id = current_user.employee.id 
```

然后应该自动填充隐藏字段的值：

```
<%= f.hidden_field :employee_id %> 
```

当然，您甚至可能根本不需要在表单中进行设置。假设表单被发布到`create`某处的方法，为什么不在那里设置变量呢？

```
# in controller +create+ method:
@entry = Entry.new(params[:entry])
@entry.employee_id = current_user.employee.id

if @entry.save
  # do stuff
end 
```

因为您可能至少需要检查 id 以确保没有发生有趣的事情，这可能是要走的路。

# c# - 基于 DB 条目动态创建对象

> ID：10390992
> 
> 赞同：0
> 
> 时间：2012-04-30T21:43:05.507
> 
> 标签：c#, dynamic

工作在升C。我制作了一个面板，其中包含许多对象，例如文本框、复选框、dateTimepicker 等。我希望这些由数据库条目填充。那部分没问题。我很难弄清楚的是如何根据数据库中的条目数使用对象制作面板的新实例。

如果您查看 MS Outlook，电子邮件会列出主题、发件人，并带有标记按钮等。电子邮件越多，列表和滚动条就越长。我希望我的软件做同样的事情。

如果你看我的 scetch，有两个面板可以显示我的数据。我希望根据条目数从我的数据库中创建并填充数据。参见 www.hagafoto.no/dreiekunst/scetch.jpg 上的 scetch

我知道这是大量的代码，但是任何人都可以为我指出正确的方向来搜索和了解更多信息。任何帮助appriciated！// 托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T22:06:30.203

为了给你指明一个方向，你可以采取：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        this.AutoScroll = true;
        int i = 0;
        Mypanel[] p = new Mypanel[10];
        for (int j = 0; j < 10; j++)
        {
            p[j] = new Mypanel();
            p[j].Location = new Point(0, (i++) * 80);
            this.Controls.Add(p[j]);
        }
    }
}

public class Mypanel : Panel
{
    Label label1 = new Label { Text = "first" };
    Label label2 = new Label { Text = "second", Location = new Point(0, 30) };
    public Mypanel()
    {
        this.BackColor = Color.White;
        this.Height = 60;
        this.Controls.Add(label1);
        this.Controls.Add(label2);
    }
} 
```

# c# - 如何添加或减去相同类/类型的两个实例

> ID：10390995
> 
> 赞同：18
> 
> 时间：2012-04-30T21:43:56.613
> 
> 标签：c#, types

我有一个代表数字类型的类型。在本例中，我使用的是兆瓦，因此我创建了一种称为兆瓦的类型。我希望能够像使用 Int、Double 或任何类型的 c# 数字类型一样使用这些兆瓦。这可能吗？如果是这样，我该怎么做？

例子：

```
public class Megawatt{
    public double Value { get; set; }
} 
```

我希望能够做到这一点：

```
var startOfDay = new Megawatts{value=100};
var endOfDay = new Megawatts{value=65};
Megawatt result = startOfDay - endOfDay; 
```

这可以通过 DateTime... 您可以从另一个 DateTime 中减去一个 DateTime 并获得一个 TimeSpan。我希望做类似的事情。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-30T21:57:18.897

除了到目前为止发布的好答案之外：**您应该使您的类型成为不可变结构而不是可变值类型**。这正是不可变值类型的设计目的。

```
struct Megawatt
{
    private double Value { get; private set; }
    public Megawatt(double value) : this()
    {
        this.Value = value;
    }
    public static Megawatt operator +(Megawatt x, Megawatt y)
    {
        return new Megawatt(x.Value + y.Value);
    }
    public static Megawatt operator -(Megawatt x, Megawatt y)
    {
        return new Megawatt(x.Value - y.Value);
    }
    // unary minus
    public static Megawatt operator -(Megawatt x)
    {
        return new Megawatt(-x.Value);
    }
    public static Megawatt operator *(Megawatt x, double y)
    {
        return new Megawatt(x.Value * y);
    }
    public static Megawatt operator *(double x, Megawatt y)
    {
        return new Megawatt(x * y.Value);
    }
} 
```

等等。请注意，您可以将 2 兆瓦相加，但不能将 2 兆瓦相乘；你只能将兆瓦乘以两倍。

您还可以添加更多包含单元的类型。例如，您可以创建一个 MegawattHour 类型和一个 Hour 类型，然后说 Megawatt 乘以 Hour 等于 MegawattHour。您也可以说存在另一种焦耳类型，并且存在从兆瓦时到焦耳的隐式转换。

有许多编程语言支持这些类型的操作，而且比 C# 更简洁；如果你做了很多这类事情，你可能会研究 F#。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-30T21:45:54.117

您应该编写自己的运算符重载：

样本 ：

```
 public static Megawatt operator +(Megawatt c1, Megawatt c2) 
   {
      return new Megawatt(c1.value+ c2.value);
   } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-30T21:45:48.113

这称为运算符重载。我建议你阅读这篇文章：

[http://msdn.microsoft.com/en-us/library/aa288467(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa288467(v=vs.71).aspx)

这是一个关于该过程的教程。基本上，您更改了`-`这些类型的运算符的含义。

作为示例（从链接中窃取）

```
public static Megawatt operator -(Megawatt c1, Megawatt c2) 
{
  // do whatever you want here
} 
```

这样你的减号现在可以减去兆瓦

您可以对任何类型或类型组合执行此操作。如果您愿意，您甚至可以返回第三种类型。许多语言支持这个概念并且它非常有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-30T22:09:21.847

扩展答案：在这种情况下，运算符重载肯定是要走的路。重载运算符是 C# 中的一个很好的选择，它允许使用运算符代替类中的方法。

当您重载运算符时，例如`+`相应的复合赋值运算符也会重载，例如`+=`

正如您对它们的使用所想象的那样，运算符重载必须是`static`并使用`operator`@RoyiNamir 的答案中的关键字。

只是为了扩展答案，除了数学运算符之外，以下二进制比较运算符只能成对重载：

1.  `==`和`!=`
2.  `>`和`<`
3.  `>=`和`<=`

至于代码设计建议，就像@RoyiNamir 所说，运算符重载应该存在于它们重载运算符的类中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T22:20:26.580

创建自己的类型是个好主意；它可以防止火星着陆器出现增加公斤和磅的问题。但是，我建议将它们`struct`设为 s，而不是类，因为这将使它们不可变并消除初始化 null 值的可能性。此外，将`value`其设为私有，以便您可以执行以下操作：

```
var startOfDay = new Megawatts(100);
var endOfDay = new Megawatts(65);
Megawatt result = startOfDay - endOfDay; 
```

您还应该考虑实现`IComparable<>`, `IEquatable<>`, 转换运算符等。这将允许您对 s 进行比较并构建其集合`Megawatt`。

做所有这些工作量很大。请参阅[C# 规范形式](http://en.csharp-online.net/CSharp_Canonical_Forms%E2%80%94Type-Safe_Forms)。

# objective-c - NSFetchedResultsController 不排序

> ID：10390996
> 
> 赞同：0
> 
> 时间：2012-04-30T21:43:58.240
> 
> 标签：objective-c, core-data, nsfetchedresultscontroller

我有一个基于 SQL 的核心数据托管文档，并使用由 NSFetchedResultsController 支持的 tableview 呈现其内容。数据确实显示出来了，而且都在那里，但即使我真的试图让它排序，它也没有排序。这是我设置获取结果控制器的方法：

```
- (void)setupFetchedResultsController // attaches an NSFetchRequest to this UITableViewController
{

    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Notebook"];
    NSSortDescriptor *descriptor=[[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES];
    request.sortDescriptors = [NSArray arrayWithObject:descriptor];
    // no predicate because we want ALL the notebooks

    self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                                                    managedObjectContext:self.dbContext
                                                                      sectionNameKeyPath:nil
                                                                               cacheName:nil];

} 
```

name 是字符串类型的属性。我还尝试了另一个 NSDate 类型的属性。它们都不起作用 - 即使在对文档应用任何更改之前应用程序启动时立即显示 tableview 时，数据也不会排序。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T21:49:52.793

初始化你的 *descriptor 如下（注意 "selector:" stuff ）

```
 NSSortDescriptor *descriptor=[[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)]; 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T14:05:36.370

尝试将 performFetch 移动到您引用的方法的末尾。我正在使用的成功方法具有设置和调用以在一种方法中执行获取，而不是分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T16:56:21.063

好的，我猜这个进入堆栈溢出的 X 文件部分。问题已解决，我不知道我做了什么来解决它，如果有的话。在过去的几天里，我一直在研究我的应用程序的其他部分，并且在某些时候，获取的结果控制器的结果再次开始被排序。也许是 Xcode 中的一些错误在我重新启动时解决了，或者我在应用程序的另一部分更改了一些东西，我只是不知道。感谢您尝试帮助我...