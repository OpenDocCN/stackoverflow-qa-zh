# StackOverflow 问答 000502000-000502999

# c# - 如何在不干扰应用程序正常操作的情况下自动加密我的 c#.net 应用程序配置文件？

> ID：502001
> 
> 赞同：1
> 
> 时间：2009-02-02T01:46:50.007
> 
> 标签：c#, .net, encryption

在不干扰应用程序正常操作的情况下，自动加密我的 c#.net 应用程序配置文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T01:58:52.633

*   这是微软的[建议](http://msdn.microsoft.com/en-us/library/ms998280.aspx)。
*   显然，不要加密整个文件。只需加密敏感数据，如数据库连接字符串。
*   您应该考虑只加密`/configuration/appSettings/add[@value]`部分。
*   使用您最喜欢的 System.Security.Cryptography 类。
*   不要忘记这是一个文本文件，所以将二进制转换为十六进制（例如`\n`=> `0A`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T01:53:14.143

如果您创建单独的函数来加密和解密文件，如此[处](http://support.microsoft.com/kb/307010)所述，而不是试图将其合并到现有例程中，那么您可以在加载文件之前简单地调用解密例程（即在“加载”函数的顶部） ) 并在保存后调用加密例程（即在从“保存”函数返回之前）。

# powershell - 如何使用 PowerShell 将文件移动到回收站？

> ID：502002
> 
> 赞同：53
> 
> 时间：2009-02-02T01:47:04.373
> 
> 标签：powershell

默认情况下，当您使用 PowerShell 删除文件时，它会被永久删除。

我实际上希望将已删除的项目放入回收站，就像我通过 shell 删除一样。

如何在 PowerShell 中对文件对象执行此操作？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-01-14T16:25:17.223

如果您不想总是看到确认提示，请使用以下命令：

```
Add-Type -AssemblyName Microsoft.VisualBasic
[Microsoft.VisualBasic.FileIO.FileSystem]::DeleteFile('d:\foo.txt','OnlyErrorDialogs','SendToRecycleBin') 
```

（谢伊利维提供的解决方案）

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2017-02-01T17:28:54.183

**2017 答案**：使用[回收模块](https://www.powershellgallery.com/packages/Recycle/1.0.2)

```
Install-Module -Name Recycle 
```

然后运行：

```
Remove-ItemSafely file 
```

我喜欢为此创建一个别名`trash`。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-02-02T02:22:01.137

它在 PowerShell 中的工作方式与 Chris Ballance 在 JScript 中的解决方案几乎相同：

```
 $shell = new-object -comobject "Shell.Application"
 $folder = $shell.Namespace("<path to file>")
 $item = $folder.ParseName("<name of file>")
 $item.InvokeVerb("delete") 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-02T16:14:19.257

这是一个较短的版本，可以减少一些工作

```
$path = "<path to file>"
$shell = new-object -comobject "Shell.Application"
$item = $shell.Namespace(0).ParseName("$path")
$item.InvokeVerb("delete") 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-11-29T10:15:30.640

这是一个改进的函数，它支持目录和文件作为输入：

```
Add-Type -AssemblyName Microsoft.VisualBasic

function Remove-Item-ToRecycleBin($Path) {
    $item = Get-Item -Path $Path -ErrorAction SilentlyContinue
    if ($item -eq $null)
    {
        Write-Error("'{0}' not found" -f $Path)
    }
    else
    {
        $fullpath=$item.FullName
        Write-Verbose ("Moving '{0}' to the Recycle Bin" -f $fullpath)
        if (Test-Path -Path $fullpath -PathType Container)
        {
            [Microsoft.VisualBasic.FileIO.FileSystem]::DeleteDirectory($fullpath,'OnlyErrorDialogs','SendToRecycleBin')
        }
        else
        {
            [Microsoft.VisualBasic.FileIO.FileSystem]::DeleteFile($fullpath,'OnlyErrorDialogs','SendToRecycleBin')
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-01-17T13:57:47.073

删除文件到回收站：

```
Add-Type -AssemblyName Microsoft.VisualBasic
[Microsoft.VisualBasic.FileIO.FileSystem]::DeleteFile('e:\test\test.txt','OnlyErrorDialogs','SendToRecycleBin') 
```

删除文件夹到回收站：

```
Add-Type -AssemblyName Microsoft.VisualBasic
[Microsoft.VisualBasic.FileIO.FileSystem]::Deletedirectory('e:\test\testfolder','OnlyErrorDialogs','SendToRecycleBin') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-15T06:06:31.277

这是一个完整的解决方案，可以添加到您的用户配置文件中，以使“rm”将文件发送到回收站。在我有限的测试中，它比以前的解决方案更好地处理相对路径。

```
Add-Type -AssemblyName Microsoft.VisualBasic

function Remove-Item-toRecycle($item) {
    Get-Item -Path $item | %{ $fullpath = $_.FullName}
    [Microsoft.VisualBasic.FileIO.FileSystem]::DeleteFile($fullpath,'OnlyErrorDialogs','SendToRecycleBin')
}

Set-Alias rm Remove-Item-toRecycle -Option AllScope 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-25T21:15:30.730

这是 sba923s 的好答案的轻微修改。

我改变了一些东西，比如参数传递，并添加了一个`-WhatIf`来测试文件或目录的删除。

```
function Remove-ItemToRecycleBin {

  Param
  (
    [Parameter(Mandatory = $true, HelpMessage = 'Directory path of file path for deletion.')]
    [String]$LiteralPath,
    [Parameter(Mandatory = $false, HelpMessage = 'Switch for allowing the user to test the deletion first.')]
    [Switch]$WhatIf
    )

  Add-Type -AssemblyName Microsoft.VisualBasic
  $item = Get-Item -LiteralPath $LiteralPath -ErrorAction SilentlyContinue

  if ($item -eq $null) {
    Write-Error("'{0}' not found" -f $LiteralPath)
  }
  else {
    $fullpath = $item.FullName

    if (Test-Path -LiteralPath $fullpath -PathType Container) {
      if (!$WhatIf) {
        Write-Verbose ("Moving '{0}' folder to the Recycle Bin" -f $fullpath)
        [Microsoft.VisualBasic.FileIO.FileSystem]::DeleteDirectory($fullpath,'OnlyErrorDialogs','SendToRecycleBin')
      }
      else {
        Write-Host "Testing deletion of folder: $fullpath"
      }
    }
    else {
      if (!$WhatIf) {
        Write-Verbose ("Moving '{0}' file to the Recycle Bin" -f $fullpath)
        [Microsoft.VisualBasic.FileIO.FileSystem]::DeleteFile($fullpath,'OnlyErrorDialogs','SendToRecycleBin')
      }
      else {
        Write-Host "Testing deletion of file: $fullpath"
      }
    }
  }

}

$tempFile = [Environment]::GetFolderPath("Desktop") + "\deletion test.txt"
"stuff" | Out-File -FilePath $tempFile

$fileToDelete = $tempFile

Start-Sleep -Seconds 2 # Just here for you to see the file getting created before deletion.

# Tests the deletion of the folder or directory.
Remove-ItemToRecycleBin -WhatIf -LiteralPath $fileToDelete
# PS> Testing deletion of file: C:\Users\username\Desktop\deletion test.txt

# Actually deletes the file or directory.
# Remove-ItemToRecycleBin -LiteralPath $fileToDelete 
```

# c# - 如何在 C# 中将小数四舍五入为特定分数？

> ID：502021
> 
> 赞同：5
> 
> 时间：2009-02-02T02:13:45.990
> 
> 标签：c#, .net, algorithm, math

在 C# 中，对数字进行四舍五入很容易：

```
Math.Round(1.23456, 4); // returns 1.2346 
```

但是，我想对一个数字进行四舍五入，以便数字的小数部分四舍五入到预定义分数的最接近的小数部分（例如 1/8），并且我试图找出 .NET 库是否已经内置了这个.

所以，例如，如果我想将一个十进制数四舍五入到八分之一，那么我想调用类似的东西：

```
Math.RoundFractional(1.9, 8); // and have this yield 1.875
Math.RoundFractional(1.95, 8); // and have this yield 2.0 
```

所以第一个参数是我要舍入的数字，第二个参数决定舍入分数。所以在这个例子中，四舍五入后，小数点后面的数字只能是八个值之一：.000、.125、.250、.375、.500、.625、.750、.875

问题：这个函数是否内置在 .NET 的某个地方？如果没有，是否有人有一个资源链接来解释如何解决这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-02T02:17:11.707

你可以这样做：

```
Math.Round(n * 8) / 8.0 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-02T02:18:00.613

不知道它是否内置在 .NET 中，但我会这样做：

```
Math.Round(x * 8, 0) / 8; 
```

将其四舍五入到最接近的 8 位。

用您最喜欢的数字代替其他“决议”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-24T03:07:03.953

这是一个迟到的回应，但对于任何寻求更全面的解决方案来转换原始帖子描述的双精度数的人。下面是一个静态类，它为双打提供了扩展方法，以各种方式完成此任务。

```
using System;

/// <summary>
/// Author: Aniceto Moreno Jr
/// Email:  amorenojr@outlook.com
/// Date:   03/23/2020
/// </summary>
public static class DoubleExtensions
{
    /// <summary>
    /// Rounds the value to the nearest increment. 
    /// Assumes mid-point rounding, value >= 0.5 rounds up, value < 0.5 rounds down.
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="increment">Enter the increment value to round toward.</param>
    /// <returns>Returns the value rounded to the nearest increment value.</returns>
    public static double RoundToNearest(this double Value, double increment)
    {
        // Returning the value rounded to the nearest increment value.
        return Math.Round(Value * Math.Pow(increment, -1), 0) * increment;
    }

    /// <summary>
    /// Rounds down the value to the nearest increment. 
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="increment">Enter the increment value to round down toward.</param>
    /// <returns>Returns the value rounded down to the nearest increment value.</returns>
    public static double FloorToNearest(this double Value, double increment)
    {
        // Returning the value rounded down to the nearest increment value.
        return Math.Floor(Value * Math.Pow(increment, -1)) * increment;
    }

    /// <summary>
    /// Rounds up the value to the nearest increment. 
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="increment">Enter the increment value to round up toward.</param>
    /// <returns>Returns the value rounded up to the nearest increment value.</returns>
    public static double CeilingToNearest(this double Value, double increment)
    {
        // Returning the value rounded up to the nearest increment value.
        return Math.Ceiling(Value * Math.Pow(increment, -1)) * increment;
    }

    /// <summary>
    /// Rounds the value down to the nearest imperial fractional increment
    /// and converts the value into an Inch-Fraction (IF) string. 
    /// Note: Assumes value is in inches and does not convert to Feet-Inch-Fraction (FIF)
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="maxDenominator">Enter the maximum denominator to round toward (i.e. 1/16 --> 16)</param>
    /// <returns>Returns the value rounded down to the nearest increment value based on the maxDenominator.</returns>
    public static string FloorToInchFraction(this double Value, int maxDenominator)
    {
        // Returning the rounded value converted into an Inch-Fraction (IF) string.
        return Value.FloorToNearest(Math.Pow(maxDenominator, -1)).ToInchFraction(maxDenominator);
    }

    /// <summary>
    /// Rounds the value up to the nearest imperial fractional increment
    /// and converts the value into an Inch-Fraction (IF) string. 
    /// Note: Assumes value is in inches and does not convert to Feet-Inch-Fraction (FIF)
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="maxDenominator">Enter the maximum denominator to round toward (i.e. 1/16 --> 16)</param>
    /// <returns>Returns the value rounded up to the nearest increment value based on the maxDenominator.</returns>
    public static string CeilingToInchFraction(this double Value, int maxDenominator)
    {
        // Returning the rounded value converted into a fraction string.
        return Value.CeilingToNearest(Math.Pow(maxDenominator, -1)).ToInchFraction(maxDenominator);
    }

    /// <summary>
    /// Rounds the value to the nearest increment value based on the maximum denominator specified.
    /// Assumes mid-point rounding, value >= 0.5 rounds up, value < 0.5 rounds down.
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="maxDenominator">Enter the maximum denominator to round toward (i.e. 1/16 --> 16)</param>
    /// <returns>Returns the value rounded to the nearest increment value based on the maxDenominator.</returns>
    public static string ToInchFraction(this double Value, int maxDenominator)
    {
        // Calculating the nearest increment of the value
        // argument based on the denominator argument.
        double incValue = Value.RoundToNearest(Math.Pow(maxDenominator, -1));

        // Identifying the whole number of the argument value.
        int wholeValue = (int)Math.Truncate(incValue);

        // Calculating the remainder of the argument value and the whole value.
        double remainder = incValue - wholeValue;

        // Checking for the whole number case and returning if found.
        if (remainder == 0.0) { return wholeValue.ToString() + (char)34; }

        // Iterating through the exponents of base 2 values until the
        // maximum denominator value has been reached or until the modulus
        // of the divisor.
        for (int i = 1; i < (int)Math.Log(maxDenominator, 2) + 1; i++)
        {
            // Calculating the denominator of the current iteration
            double denominator = Math.Pow(2, i);

            // Calculating the divisor increment value
            double divisor = Math.Pow(denominator, -1);

            // Checking if the current denominator evenly divides the remainder
            if ((remainder % divisor) == 0.0) // If, yes
            {
                // Calculating the numerator of the remainder 
                // given the calculated denominator
                int numerator = Convert.ToInt32(remainder * denominator);

                // Returning the resulting string from the conversion.
                return (wholeValue > 0 ? wholeValue.ToString() + "-" : "") + numerator.ToString() + "/" + ((int)denominator).ToString() + (char)34;
            }
        }

        // Returns Error if something goes wrong.
        return "Error";
    }

    /// <summary>
    /// Rounds the value down to the nearest imperial fractional increment
    /// and converts the value into an Feet-Inch-Fraction (FIF) string. 
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="maxDenominator">Enter the maximum denominator to round toward (i.e. 1/16 --> 16)</param>
    /// <returns>Returns the value rounded down to the nearest increment value based on the maxDenominator.</returns>
    public static string FloorToFeetInchFraction(this double Value, int maxDenominator)
    {
        // Returning the rounded value converted into an Feet-Inch-Fraction (FIF) string.
        return Value.FloorToNearest(Math.Pow(maxDenominator, -1)).ToFeetInchFraction(maxDenominator);
    }

    /// <summary>
    /// Rounds the value up to the nearest imperial fractional increment
    /// and converts the value into an Feet-Inch-Fraction (FIF) string. 
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="maxDenominator">Enter the maximum denominator to round toward (i.e. 1/16 --> 16)</param>
    /// <returns>Returns the value rounded up to the nearest increment value based on the maxDenominator.</returns>
    public static string CeilingToFeetInchFraction(this double Value, int maxDenominator)
    {
        // Returning the rounded value converted into a fraction string.
        return Value.CeilingToNearest(Math.Pow(maxDenominator, -1)).ToFeetInchFraction(maxDenominator);
    }

    /// <summary>
    /// Rounds the value to the nearest increment value based on the maximum denominator specified.
    /// Assumes mid-point rounding, value >= 0.5 rounds up, value < 0.5 rounds down.
    /// </summary>
    /// <param name="Value"></param>
    /// <param name="maxDenominator">Enter the maximum denominator to round toward (i.e. 1/16 --> 16)</param>
    /// <returns>Returns the value rounded to the nearest increment value based on the maxDenominator.</returns>
    public static string ToFeetInchFraction(this double Value, int maxDenominator)
    {
        // Calculating the nearest increment of the value
        // argument based on the denominator argument.
        double incValue = Value.RoundToNearest(Math.Pow(maxDenominator, -1));

        // Calculating the remainder of the argument value and the whole value.
        double FeetInch = Math.Truncate(incValue) / 12.0;

        // Calculating the remainder of the argument value and the whole value.
        int Feet = (int)Math.Truncate(FeetInch);

        // Calculating remaining inches.
        incValue -= (double)(Feet * 12.0);

        // Returns the feet plus the remaining amount converted to inch fraction.
        return (Feet > 0 ? Feet.ToString() + (char)39 + " " : "") + incValue.ToInchFraction(maxDenominator);
    }
} 
```

使用和实现示例：

```
double testValue0 = 1.0625; // 1―1/16"
Console.WriteLine(testValue0.ToInchFraction(32)); // 1―1/16"

double testValue1 = 1.515625; // 1―33/64"
Console.WriteLine(testValue1.CeilingToInchFraction(16)); // 1―9/16"

double testValue2 = 1.03125; // 1―1/32"
Console.WriteLine(testValue2.FloorToInchFraction(16)); // 1"

double testValue3 = 5 / 25.4; // 5 mm = 0.1969 in
Console.WriteLine(testValue3.ToInchFraction(32)); // 3/16"
Console.WriteLine(testValue3.ToInchFraction(64)); // 13/64" 
```

# numerical-analysis - 如何在特定机器上找到尾数长度？

> ID：502022
> 
> 赞同：3
> 
> 时间：2009-02-02T02:13:55.863
> 
> 标签：numerical-analysis, rounding-error, mantissa

我想在特定计算机上找到尾数位数和单位舍入。我了解这些是什么，只是不知道如何找到它们-尽管我知道它们可能因计算机而异。

我需要这个数字来执行数值分析的某些方面，比如分析错误。

我目前在想的是，我可以编写一个小的 c++ 程序来缓慢递增一个数字，直到发生溢出，但我不确定要使用什么类型的数字。

我在正确的轨道上吗？究竟如何计算这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T02:31:47.980

我认为您使用的任何语言都会指定浮点数的存储方式。我知道 Java 通过使用特定的 IEEE 标准（我认为是 754）来做到这一点。

如果未指定，我认为您可以通过将 0.5 添加到 1 来进行自己的检查，以查看实际数字是否发生变化。如果是，则将 0.25 添加到 1，将 0.125 添加到 1，依此类推，直到数字不变，例如：

```
float a = 1;
float b = 0.5;
int bits = 0;
while (a + b != a) {
    bits = bits + 1;
    b = b / 2;
} 
```

如果你只有 3 个尾数位，那么 1 + 1/16 将等于 1。

然后你已经用尽了你的尾数位。

您实际上可能需要基数为 2 而不是 1，因为 IEEE754 在开头使用隐含的“1+”。

编辑：

似乎上述方法可能存在一些问题，因为它为显然具有 4 字节浮点数的系统提供了 63 位。

这是否与中间结果有关（我对此表示怀疑，因为具有显式强制转换 [ `while (((float)(a + b) != (float)(a))`] 的相同代码有类似的问题）还是（我相信更有可能）单位值可以通过调整`a`更接近小数的位来表示的可能性`b`指数，我还不知道。

目前，最好依靠我上面提到的语言信息，例如 IEEE754 的使用（如果该信息可用）。

我会把有问题的代码留给谨慎的玩家。也许有更多浮点知识的人然后我可以留下一个注释来解释它为什么会奇怪（没有猜想，请:-)。

编辑2：

这段代码通过确保中间体存储在浮点数中来修复它。事实证明 Jonathan Leffler 是对的——这是中间结果。

```
#include <stdio.h>
#include <float.h>

int main(void) {
    float a = 1;
    float b = 0.5;
    float c = a + b;
    int bits = 1;
    while (c != a) {
        bits = bits + 1;
        b = b / 2;
        c = a + b;
    }
    printf("%d\n",FLT_MANT_DIG);
    printf("%d\n",bits);
    return 0; 
```

}

此代码输出 (24,24) 以显示计算值与头文件中的值匹配。

虽然它是用 C 编写的，但它应该适用于任何语言（特别是一种信息在标题中不可用或由于它在语言文档中指定的语言）。我只在 C 中进行了测试，因为 Eclipse 需要很长时间才能在我的 Ubuntu 机器上启动 :-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T02:49:51.877

对于 C 和扩展 C++，信息位于`<float.h>`或`<cfloat>`标头中。

对于 C99，信息在标准的第 5.2.4.2.2 节中：

*   `FLT_RADIX`
*   `FLT_MANT_DIG`
*   `FLT_DIG`
*   `FLT_EPSILON`
*   `FLT_MIN_EXP`
*   `FLT_MIN`
*   `FLT_MIN_10_EXP`
*   `FLT_MAX_EXP`
*   `FLT_MAX`
*   `FLT_MAX_10_EXP`

`DBL_RADIX`对于大多数这些（否或`LDBL_RADIX`）的 DBL 和 LDBL 变体也是如此。该标准建议了适合 IEEE 754 的值（IEEE 754 标准的旧版本，1999 年生效；我相信，2008 年发布了一个新版本）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T03:35:33.967

您可能想查看`<limits>`您的 C++ 库：

```
#include <iostream>
#include <limits>
#include <typeinfo>

template <typename T>
void printDetailsFor() {
    std::cout
        << "Printing details for " << typeid(T).name() << ":\n"
        << "\tradix:        " << std::numeric_limits<T>::radix        << "\n"
        << "\tradix digits: " << std::numeric_limits<T>::digits       << "\n"
        << "\tepsilon:      " << std::numeric_limits<T>::epsilon()    << "\n"
        << std::endl;
}

int main() {
    printDetailsFor<int>();
    printDetailsFor<float>();
    printDetailsFor<double>();
    printDetailsFor<long double>();
    return 0;
} 
```

我认为你想要`std::numeric_limits<T>::digits`的应该比尾数位数多一。我的机器打印出来：

```
Printing details for i:
    radix:        2
    radix digits: 31
    epsilon:      0

Printing details for f:
    radix:        2
    radix digits: 24
    epsilon:      1.19209e-07

Printing details for d:
    radix:        2
    radix digits: 53
    epsilon:      2.22045e-16

Printing details for e:
    radix:        2
    radix digits: 64
    epsilon:      1.0842e-19 
```

# javascript - 谷歌邮件如何在textarea中实现rtf？

> ID：502027
> 
> 赞同：4
> 
> 时间：2009-02-02T02:17:18.150
> 
> 标签：javascript, html, css, textarea

我打算开发一个类似于谷歌邮件的丰富输入文本区域。有什么理想或资源可以分享吗？提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T02:22:08.513

我的建议是使用[TinyMCE](http://tinymce.moxiecode.com/)，它是一个很棒的富文本框。雅虎还有一个[非常棒的富文本编辑器](http://developer.yahoo.com/yui/editor/)（已被弃用）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T03:25:08.917

顺便说一句，这些*不是*文本区域 - 它们是 IFRAME，包含由编辑器代码管理的完整 HTML。我还推荐 FCKeditor - 非常可配置且易于集成。您可以使用 textareas 编写代码，进行 javascript 调用，然后这些 textareas 会被隐藏，并且 IFRAME 会被注入到位。提交后，html 会被复制回 textarea。所以真的不需要做太多...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T02:21:38.500

我不确定谷歌使用什么，但我使用过[FCKEditor](http://www.fckeditor.net/)并且效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T03:13:35.867

Look at the ContentEditable tag. And also have a look at [Squire on gihub](https://github.com/neilj/Squire) which is an open source rich text editor that is very lightweight and flexible (used in opera's mail client)

The editors given in the other answers are very heavy and come with their own (outdated, bloated) UI components.

# cocoa - 在一个窗口中使用 mouseMoved 的多个自定义控件

> ID：502038
> 
> 赞同：0
> 
> 时间：2009-02-02T02:25:25.293
> 
> 标签：cocoa, events, controls, mouse

起初，我有一个带有自定义控件的窗口。为了让它接受鼠标移动的事件，我只需将其放入 awakeFromNib：

代码：

[[自我窗口] makeFirstResponder:self]; [[自窗口] setAcceptsMouseMovedEvents:YES];

现在我在同一个窗口中对其中的四个做一些事情，这不再那么漂亮了。首先，我将它们从控件的 awakeFromNib 中取出并决定使用我的 appController 来管理它，即 [window makeFirstResponder:View]

我的问题是，如果我希望每个都响应鼠标移动事件，我如何在同一视图中管理其中的四个？现在，我已经告诉窗口响应 mouseMoved 事件，但没有一个视图响应 mouseMoved。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T22:32:23.267

您还需要覆盖 -acceptsFirstResponder 以返回 YES。

```
    #pragma mark NSResponder 覆盖
    - (BOOL)acceptsFirstResponder
    {
    返回是；
    }

```

-mouseMoved 事件很昂贵，所以当我的控件的 -mouseExited 消息被调用时我关闭鼠标移动事件并在 -mouseEntered 中打开它。

```
    - (void)mouseEntered:(NSEvent *)theEvent
{
    [[自窗口] setAcceptsMouseMovedEvents:YES];
    [[自我窗口] makeFirstResponder:self];
}

- (void)mouseMoved:(NSEvent *)theEvent
{
...
}

- (void)mouseExited:(NSEvent *)theEvent
{
    [[自我窗口] setAcceptsMouseMovedEvents:NO];
}

```

我在我的自定义控件应用程序中快速测试了这一点。我在 nib 文件中多次复制了控件，它按预期工作。

您可能还需要：

```
- (void)awakeFromNib
{
    [[自窗口] setAcceptsMouseMovedEvents:YES];
    [self addTrackingRect:[self bounds] owner:self userData:NULL assumeInside:YES];
}

```

我不认为 -setAcceptsMouseMovedEvents 是必要的，但我很确定跟踪 rect 代码是必要的。您可能还需要尝试使用assumeInside: 参数的值，但这已记录在案。

# javascript - 如何在插入大量 dom 元素时显示“工作”指示器

> ID：502042
> 
> 赞同：3
> 
> 时间：2009-02-02T02:33:29.320
> 
> 标签：javascript, dom

在创建和插入 DOM 元素时，用于任务的函数似乎在元素显示在页面中之前返回。

在开始插入元素之前，我将 div 的显示属性设置为“块”，在插入元素后，我将属性设置为“无”，问题是，指示器没有显示在页面中。有可能做到这一点吗？其中 $ 是 document.getElementById 的别名。

```
$('loading').className="visible";
var container = document.getElementById('container');
    for(var i=0; i< 50000; i++){
    var para = document.createElement('p');
    para.appendChild(document.createTextNode('Paragraph No. ' + i));
    container.appendChild(para);    
    }
$('loading').className="hidden"; 
```

它显示为 createElement 和/或 appendChild 异步运行，所以我几乎立即隐藏了指标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T03:20:04.450

setTimeout() 就是答案。为您提供一个简单的“单行”更改：

```
$('loading').className="visible";
setTimeout(function() {
    var container = document.getElementById('container');
    for(var i=0; i< 50000; i++){
        var para = document.createElement('p');
        para.appendChild(document.createTextNode('Paragraph No. ' + i));
        container.appendChild(para);    
    }
    $('loading').className="hidden";
}, 0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T02:36:47.707

我相信 DOM 在脚本完成运行之前不会刷新。

要使其异步运行，您可以尝试将其包装在`setTimeout`调用中，超时为零毫秒。在伪代码中：

```
showLoadingIndicator();
setTimeout(addElements, 0);
function addElements() {
    // perform your loop here
    hideLoadingIndicator();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T03:30:01.467

您永远不希望在浏览器中花费太长时间。它杀死了 UI，包括（不幸的是）用作无限进度指示器的动画 gif。

解决方案是将过程分解为，例如，使用 setTimeout() 对添加 1000 个元素的函数进行 50 次调用。

# aptana - 如何在 Aptana Jaxer 中调试服务器端代码？

> ID：502046
> 
> 赞同：0
> 
> 时间：2009-02-02T02:36:53.150
> 
> 标签：aptana, jaxer

我正在尝试调试在 Aptana Jaxer 中运行的一些服务器端 JavaScript 代码，但没有成功。我什至无法找到有关此问题的任何教程或帖子。有谁知道这是否可能，如果可以，我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T02:38:55.430

你可以设置你 Jaxer.Config.DEV_MODE = true; 在浏览器中获取一些错误信息。还可以使用 Jaxer.Log 进行调试。希望这个对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-29T03:48:12.060

尾 -f /opt/AptanaJaxer/logs/jaxer.log

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-28T01:12:41.320

Jaxer 和 Aptana Studio 尚不能从客户端调试远程脚本。也就是说，您不能单步执行回调并让代码窗口向您显示远程方法中的第一行代码。当然，这在他们的愿望清单上，但要做好会非常棘手。

就个人而言，我使用日志记录。Jaxer 在 Jaxer.Log.* 中为此提供了强大的功能。

很多人对“printf() 调试”嗤之以鼻，但事实是，它确实有效，而且设置起来通常比交互式调试器更容易，尤其是对于服务器应用程序和远程方法调用。您只需将日志消息撒在您想知道当时系统状态的任何地方，然后让您的应用程序尝试执行失败的事情。研究原木，冲洗，重复。

# c - 在 C 中传递数组的指针

> ID：502059
> 
> 赞同：7
> 
> 时间：2009-02-02T02:48:33.250
> 
> 标签：c, arrays, pointers

所以我有一些看起来像这样的代码：

```
int a[10];
a = arrayGen(a,9); 
```

arrayGen 函数如下所示：

```
int* arrayGen(int arrAddr[], int maxNum)
{
    int counter=0;
    while(arrAddr[counter] != '\0') {
        arrAddr[counter] = gen(maxNum);
        counter++;
    }
    return arrAddr;
} 
```

现在编译器告诉我“警告：传递 'arrayGen' 的参数 1 从指针中生成整数而不进行强制转换”

我的想法是我传递'a'，一个指向a [0]的指针，然后由于数组已经创建，我可以填写a [n]的值，直到我a [n] =='\ 0'。我认为我的错误是 arrayGen 被编写为接收一个数组，而不是指向一个数组的指针。如果这是真的，我不确定如何继续，是否将值写入地址，直到一个地址的内容为“\0”？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-02T02:58:49.423

这里的基本魔法是 C 中的这个身份：

```
*(a+i) == a[i] 
```

好的，现在我将使它成为可读的英语。

问题是：数组名不是左值；不能分配给它。所以你有

```
a = arrayGen(...) 
```

是问题所在。看这个例子：

```
int main() {
    int a[10];

    a = arrayGen(a,9);

    return 0;
} 
```

这给出了编译错误：

```
gcc -o foo foo.c
foo.c: In function 'main':
foo.c:21: error: incompatible types in assignment

Compilation exited abnormally with code 1 at Sun Feb  1 20:05:37 
```

您需要有一个指针，它*是*一个左值，用于分配结果。

这段代码，例如：

```
int main() {
    int a[10];
    int * ip;

    /* a = arrayGen(a,9);  */
    ip = a ; /* or &a[0] */
    ip = arrayGen(ip,9);

    return 0;
} 
```

编译得很好：

```
gcc -o foo foo.c

Compilation finished at Sun Feb  1 20:09:28 
```

请注意，由于顶部的标识，您可以根据需要将 ip 视为一个数组，如以下代码所示：

```
int main() {
    int a[10];
    int * ip;
    int ix ;

    /* a = arrayGen(a,9);  */
    ip = a ; /* or &a[0] */
    ip = arrayGen(ip,9);

    for(ix=0; ix < 9; ix++)
        ip[ix] = 42 ;

    return 0;
} 
```

* * *

### 完整的示例代码

为了完整起见，这是我的完整示例：

```
int gen(int max){
    return 42;
}

int* arrayGen(int arrAddr[], int maxNum)
{
    int counter=0;
    while(arrAddr[counter] != '\0') {
        arrAddr[counter] = gen(maxNum);
        counter++;
    }
    return arrAddr;
}

int main() {
    int a[10];
    int * ip;
    int ix ;

    /* a = arrayGen(a,9);  */
    ip = a ; /* or &a[0] */
    ip = arrayGen(ip,9);

    for(ix=0; ix < 9; ix++)
        ip[ix] = 42 ;

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T03:12:20.393

为什么还要返回 arrAddr？您通过引用传递 a[10] ，因此将修改数组的内容。除非您需要*另一个*对数组的引用，否则 charlies 的建议是正确的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T03:45:48.517

嗯，我知道您的问题已得到解答，但有关代码的其他一些问题困扰着我。为什么要使用针对 '\0' 的测试来确定数组的结尾？我很确定这只适用于 C 字符串。在建议的修复之后，代码确实可以编译，但是如果你遍历你的数组，我很想知道你是否得到了正确的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T04:20:21.973

我不确定您要做什么，但是将指针值分配给数组是[Charlie](https://stackoverflow.com/questions/502059/passing-pointers-of-arrays-in-c/502072#502072)提到的困扰编译器的问题。我很好奇检查 NUL 字符常量`'\0'`。您的示例数组是未初始化的内存，因此比较`arrayGen`不会按照您的意愿进行。

您使用的参数列表最终与以下内容相同：

```
int* arrayGen(int *arrAddr, int maxNum) 
```

用于大多数目的。标准中的实际声明是：

> 将参数声明为“*类型*数组”应调整为“*类型*限定指针”，其中类型限定符（如果有）是在数组类型派生的 [ 和 ] 中指定的那些。如果关键字**`static`**也出现在数组类型派生的 [ 和 ] 中，则对于函数的每次调用，对应的实际参数的值应提供对数组的第一个元素的访问，该数组的元素至少与指定的一样多大小表达式。

如果您真的想强制调用者使用数组，请使用以下语法：

```
void accepts_pointer_to_array (int (*ary)[10]) {
    int i;
    for (i=0; i<10; ++i) {
        (*ary)[i] = 0; /* note the funky syntax is necessary */
    }
}

void some_caller (void) {
    int ary1[10];
    int ary2[20];
    int *ptr = &ary1[0];
    accepts_pointer_to_array(&ary1); /* passing address is necessary */
    accepts_pointer_to_array(&ary2); /* fails */
    accepts_pointer_to_array(ptr);   /* also fails */
} 
```

如果您使用不是指向 10 个整数数组的指针的任何内容调用它，您的编译器应该会抱怨。我可以诚实地说，尽管我从未在各种书籍（[The C Book](https://rads.stackoverflow.com/amzn/click/com/0201544334)、[Expert C Programming](https://rads.stackoverflow.com/amzn/click/com/0131774298)）之外的任何地方看到过这本书……至少在 C 编程中没有。然而，在 C++ 中，我有理由在一种情况下使用这种语法：

```
template <typename T, std::size_t N>
std::size_t array_size (T (&ary)[N]) {
    return N;
} 
```

不过，您的里程可能会有所不同。如果你真的想深入研究这样的东西，我不能高度推荐[专家 C 编程](https://rads.stackoverflow.com/amzn/click/com/0131774298)。您还可以在[gbdirect](http://publications.gbdirect.co.uk/c_book/)在线找到[The C Book](https://rads.stackoverflow.com/amzn/click/com/0201544334)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T02:55:26.840

尝试调用您的参数`int* arrAddr`，而不是`int arrAddr[]`. 尽管当我考虑它时，该`main`方法的参数是相似的，但仍然有效。所以不确定解释部分。

编辑：嗯，我可以在互联网上找到的所有资源都说它应该可以工作。我不确定，我自己总是将数组作为指针传递，所以以前从未遇到过这个问题，所以我对解决方案非常感兴趣。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T04:30:00.190

您使用它的方式 arrayGen() 不需要返回值。您还需要将 '\0' 放在最后一个元素中，它不会自动完成，或者传递最后一个元素的索引来填充。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T04:40:14.010

@jeffD 传递索引将是首选方式，因为不能保证您不会在最后一个 '\0' 之前命中其他 '\0'（我当然是在测试它时）。

# asp.net - WebForm_PostBackOptions 文档

> ID：502060
> 
> 赞同：39
> 
> 时间：2009-02-02T02:48:37.043
> 
> 标签：asp.net, documentation

是否有关于 WebForm_PostBackOptions 参数的任何文档？我用谷歌搜索找不到任何东西。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-11T18:11:54.220

没有关于此的官方文档。但是，如果您查看 javascript 源代码，您会看到：

```
function WebForm_PostBackOptions(eventTarget, eventArgument, validation, validationGroup, actionUrl, trackFocus, clientSubmit) 
```

我认为参数名称是不言自明的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-04-09T16:31:16.030

看看 Gh0sT 所说的 javascript 声明：

```
function WebForm_PostBackOptions(eventTarget, eventArgument, validation, validationGroup, actionUrl, trackFocus, clientSubmit) 
```

然后查看服务器端 PostBackOptions 类的文档，您可以了解参数是什么：http: [//msdn.microsoft.com/en-us/library/system.web.ui.postbackoptions_members (v=VS.90 ).aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.postbackoptions_members(v=VS.90).aspx)

对于 asp.net 中的大多数验证逻辑，客户端类尝试模仿服务器端。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-21T04:32:13.060

我目前正在使用 ASP.NET 2.0，页面中的代码如下所示...

```
function WebForm_DoPostBackWithOptions(options) {
var validationResult = true;
if (options.validation) {
    if (typeof(Page_ClientValidate) == 'function') {
        validationResult = Page_ClientValidate(options.validationGroup);
    }
}
if (validationResult) {
    if ((typeof(options.actionUrl) != "undefined") && (options.actionUrl != null) && (options.actionUrl.length > 0)) {
        theForm.action = options.actionUrl;
    }
    if (options.trackFocus) {
        var lastFocus = theForm.elements["__LASTFOCUS"];
            if ((typeof(lastFocus) != "undefined") && (lastFocus != null)) {
                if (typeof(document.activeElement) == "undefined") {
                    lastFocus.value = options.eventTarget;
                }
                else {
                    var active = document.activeElement;
                    if ((typeof(active) != "undefined") && (active != null)) {
                        if ((typeof(active.id) != "undefined") && (active.id != null) && (active.id.length > 0)) {
                            lastFocus.value = active.id;
                        }
                        else if (typeof(active.name) != "undefined") {
                            lastFocus.value = active.name;
                        }
                    }
                }
            }
        }
    }
    if (options.clientSubmit) {
        __doPostBack(options.eventTarget, options.eventArgument);
    }
} 
```

你为什么卡住了？代码只是没有出现在页面中吗？在 ASP.NET 1.1 中，WebUIValidation.js 文件必须存在于光盘上的特定目录中（我忘了具体是哪个目录）。在 2.0 中，脚本与框架集成在一起。

# java - Mercurial 和一种 Java 项目的持续集成工作流

> ID：502064
> 
> 赞同：0
> 
> 时间：2009-02-02T02:50:20.207
> 
> 标签：java, mercurial, continuous-integration

我工作的Java中有一个项目。

要在 Mercurial 中拥有该项目，我知道我必须为所有类创建一个存储库。

由于有很多类，我想如果我可以拥有一个由存储库副本加上我必须做的修改组成的 jar 副本。

所以用 Mercurial 术语来说有：

1.  一个包含所有类的主仓库
2.  一个带有修改和新类的小仓库

我想从 B 回购合并到 A 回购。然后我只想提取和更新 B 存储库中存在的类 (*.java)。

我试过这个没有成功：

1.  要创建 B 存储库，我克隆 A 存储库并删除所有文件。
2.  当我必须修改 .java 时，我会 `wget`在我的本地机器中的 mercurial 服务器上执行特定文件。当文件是新文件时，我只运行 hg add。
3.  为了完成我`hg commit -I file1 -i file2 ... -i fileN`对 B repo 工作文件夹中存在的所有文件的提交。

然后是不成功的部分：

1.  我不能只对现有文件进行 hg 更新。
2.  当 B 存储库合并到 A 存储库时，一切正常。但是我不能运行带有`-I` 参数的合并状态的 hg commit。它的全部或全部。
3.  当我从 A repo 中提取并尝试更新时，我遇到了同样的问题 4。

我知道`hg pull -f`从 B 回购的不相关回购开始，而不是克隆。但它有同样的更新问题。而且看起来很丑。

我认为[移植插件](http://www.selenic.com/mercurial/wiki/index.cgi/TransplantExtension)可能会有所帮助。我还阅读了[如何在 Mercurial 中结合两个项目？](https://stackoverflow.com/questions/12843/how-to-combine-two-projects-in-mercurial).

必须在 A Repo 中保留文件的历史记录，即使此历史记录是在 B Repo 中生成的。

您知道实现这一目标的最佳方法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T03:46:27.627

您要查找的内容称为[部分克隆](http://www.selenic.com/mercurial/wiki/index.cgi/PartialClone)，并且在 mercurial 中不受支持。

老实说，您的工作流程听起来很糟糕——创建一个子集 repo 并试图使其保持同步正在与这些工具的预期使用方式作斗争。为什么不只是从完整的仓库构建你需要的 jar，而是在 ant（我希望）`<jar>`标签中只包含特定的类。我们有一个包含数千个类的存储库，并且`build all`输出许多不同的 jar，每个 jar 都是整个类的一个子集。

也就是说，如果您必须坚持当前的工作流程，您应该修改它。不要克隆完整的存储库，然后删除不需要的文件，因为您仍然包含它们的完整历史记录。

相反，使用`hg convert`（[转换扩展](http://www.selenic.com/mercurial/wiki/index.cgi/ConvertExtension?highlight=%28Convert%29)`filemap`）使用 a和`--filemap`选项构建您的子集存储库。使用源存储库类型`hg`和目标类型，`hg`您可以使用文件映射仅包含您想要的文件。您最终不会得到一个克隆，而是一个全新的存储库，其中包含所有原始变更集，但仅适用于您指定的文件。使用 convert 的内置增量模式将使仅转换来自完整 repo 的新更改成为一种更新。

# asp.net - 指示浏览器在继续处理时不要等待更多内容

> ID：502077
> 
> 赞同：0
> 
> 时间：2009-02-02T03:03:29.990
> 
> 标签：asp.net

我如何指示浏览器不要期望有更多内容出现？有点像服务器说“我得到了我需要的东西，你不需要等待我完成页面处理”。

我有一个服务器端任务，当某个页面被点击时启动。该任务可能很耗时，但呈现的 HTML 将始终相同，即像“感谢您启动任务”消息。

我正在考虑启动一个新线程来处理该任务，但我相信必须有一个更优雅的解决方案，您只需将正确的标头/指令发送到浏览器，然后继续处理。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T03:06:10.033

这会将您的消息发送到浏览器：

```
Response.Flush() 
```

但是，我相信通知客户端传输完成的责任是由 IIS 完成的，直到 ASP.NET 引擎完成它作为请求的一部分并将控制权交还给 IIS 时才会这样做。最好的办法是启动一个新线程，这不会导致任何问题，因为请求线程将在新线程开始后几乎立即结束……每个请求仍然只有一个线程。

# artificial-intelligence - 对于一群本科生来说，你对一个好的 AI 项目有什么想法？

> ID：502083
> 
> 赞同：5
> 
> 时间：2009-02-02T03:06:16.803
> 
> 标签：artificial-intelligence

有两门课程：“AI”和“AI in Games”，均为 15 名学生，为期 15 周。我想让他们保持积极性和创造力。我知道我想要某种竞争（对于后者来说很明显）。也许像马拉松比赛或 ICFP 这样的比赛。我需要良好的可视化，所以如果它已经存在那就太好了。一个想法是为“韦诺之战”编写 AI，但我想这是多样化/无聊的。另一个围棋游戏。但这太难了。

你有什么想法？

它将以 3 名学生为一组，为期 15 周。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-02T03:19:46.090

麻省理工学院举办了一场名为[BattleCode](https://web.archive.org/web/20160506215719/http://battlecode.mit.edu/2009/info)的比赛。

> BattleCode，是一款即时战略游戏。两队机器人在屏幕上漫游，管理资源并使用不同种类的武器互相攻击。然而，在 BattleCode 中，每个机器人都是自主运行的；在后台，它运行着一个加载了团队播放器程序的 Java 虚拟机。游戏中的机器人通过无线电进行通信，必须共同努力以实现目标。
> 
> 一到四名学生进入的团队将获得 BattleCode 软件和游戏规则规范。每个团队都开发了一个玩家程序，该程序将在 BattleCode 比赛期间由他们的每个机器人运行。参赛者经常使用人工智能、寻路、分布式算法和/或网络通信来编写他们的播放器。在最后的锦标赛中，自主玩家将在一场戏剧性的面对面锦标赛中相互对抗。麻省理工学院锦标赛的最后几轮比赛在现场观众面前进行，排名靠前的球队将获得现金奖励。

[![替代文字](https://i.stack.imgur.com/jSg6B.png)](https://i.stack.imgur.com/jSg6B.png)
[（来源：[mit.edu](http://battlecode.mit.edu/2009/img/battlecode-screenshot.png)）]

*战斗代码在行动。*

基本上，麻省理工学院为您提供了 BattleCode 软件，您的学生可以为他们的机器人编写 AI 程序。他们有一个测试套件，因此您可以在练习场上练习自己运行自主机器人。在学期末，他们可以参加[麻省理工学院的公开锦标赛](https://web.archive.org/web/20100701161000/http://battlecode.mit.edu/2009/tournaments/index)，在那里他们可以与他们的软件 AI 机器人对抗全国各地的学校。高达 40,000 美元的现金和奖品以及吹嘘获胜的权利被送出。

如果你想教他们[人工智能](https://en.wikipedia.org/wiki/Rubberband_effect)、[寻路](https://en.wikipedia.org/wiki/Pathfinding)、[群体智能](https://en.wikipedia.org/wiki/Swarm_intelligence)等。我想不出更有趣的方法。

愿最好的人工智能机器人获胜！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T03:08:21.153

Wii[手势识别](http://en.wikipedia.org/wiki/Gesture_recognition)使用[隐马尔可夫模型](http://en.wikipedia.org/wiki/Hidden_Markov_model)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T03:45:04.540

我不会指望Go。围棋 AI 在计算上很难与顶级人类棋手竞争，但围棋的简单规则（与国际象棋相比）使其成为一个相对容易编写 AI 的游戏。您的学生的程序只需要相互竞争，而不是与[Dan](http://en.wikipedia.org/wiki/Go_ranks_and_ratings#Kyu_and_Dan_ranks)级别的人类玩家竞争。有关大量 Go 编程资源，请参阅[计算机 Go 领域和相关 Internet 资源简介。](http://www.itee.uq.edu.au/~janetw/Computer%20Go/CS-TR-339.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T04:39:32.183

我认为选择一个既足够具有挑战性以至于无法完全解决的主题，又能让用户看到它在现实世界中的价值，而不是一个玩具问题，这是一个好主意。因此，我的建议是：

1.  分词问题（例如将“iamaboy”转换为“i'am a boy”）
2.  词义消歧（例如“苹果很好吃”——苹果是水果还是公司？）
3.  光学字符识别

我刚刚列出的是自然语言处理的一些更基本的东西。如果您的学生更倾向于技术，您可能可以将其提升到一个新的水平，让他们解决机器翻译的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T17:00:39.350

[帝国](http://www.classicempire.com/)，[无论什么都让人](http://www.classicempire.com/epyx.html)[上瘾](http://www.classicempire.com/letters.html)，并且有开源[D](http://www.digitalmars.com/d/1.0/)版本（[1](ftp://ftp.classicempire.com/empiresrc.zip)和[2](ftp://ftp.classicempire.com/stewart.zip)）和[不太免费的 c++ 版本](http://www.classicempire.com/shop.html)。

# c# - 我如何处理我在 asp.net 中的异常？

> ID：502087
> 
> 赞同：0
> 
> 时间：2009-02-02T03:07:18.923
> 
> 标签：c#, asp.net, asp.net-mvc, logging, error-handling

我正在开发一个 ASP.NET MVC 应用程序，并且刚刚开始进行错误处理。帮助我解决将错误消息返回给用户的问题。

我有一个控制器：

```
 [AcceptVerbs(HttpVerbs.Get)]
    public ActionResult Show(string callNumber)
    {
        ServiceCallService sc = new ServiceCallService();
        return View(sc.GetServiceCallByCallNumber("", callNumber));
    } 
```

服务：

```
 public ServiceCall GetServiceCallByCallNumber(string custID, string callNumber)
    {
        ServiceCall sc = new ServiceCall();
        sc = _serviceCallRepository.GetServiceCallByCallNumber(custID, callNumber);
        return sc;
    } 
```

存储库：

```
 public ServiceCall GetServiceCallByCallNumber(string custID, string callNumber)
    {
        ServiceCall sc = new ServiceCall();

        try
        {
            LoginToDB();
            sc.CallNumber = "123";
        }
        catch (Exception e)
        {
            logger.error(Server.GetLastError());
        }
        finally
        {
            LogoutFromDB();
        }
        return sc;
    } 
```

假设 LoginToDB() 方法有问题。我正在记录错误，但如何将错误消息返回到控制器，然后返回到视图。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T03:22:28.283

最简单的方法是：-

1) 在 ASP.NET MVC Release Canditate 1 中使用内置模型验证（从 asp.net/mvc 下载）。

2）重新抛出异常并在控制器操作中捕获它，然后将一个很好的自定义错误消息传递给视图以呈现给用户 - 使用 ViewData["error"] 或类似的东西传递它。

# mysql - 在 MySQL 查询中使用“distinct”

> ID：502094
> 
> 赞同：0
> 
> 时间：2009-02-02T03:13:54.540
> 
> 标签：mysql

我有以下查询。

```
SELECT p.author_name, p.author_id,
DISTINCT p.topic_id, t.title
FROM `ibf_posts` p, `ibf_topics` t
WHERE p.topic_id = t.tid
ORDER BY pid DESC
LIMIT 8" 
```

当我运行它时，我得到以下 MySQL 错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DISTINCT p.topic_id, t.title FROM `ibf_posts` p, `ibf_topics` t WHERE p' at line 1 
```

如果我删除了`DISTINCT`关键字，那么查询就没有问题了。

我究竟做错了什么？

该方案来自 Invision Power Board 帖子和主题表。我正在尝试获取最新帖子的最后 8 个主题的标题。在最热门的帖子列表中，我不希望同一主题出现多次。我想要一个唯一的标题列表。

表：ibf_posts -pid -author_name -author_id -topic_id

表：ibf_topics -tid -title

tid 与 topic_id 相同

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T03:16:33.787

它是

```
SELECT DISTINCT ... 
```

您不能`DISTINCT`只为单个列指定；它仅适用于将完整的重复记录保留在结果集中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T03:16:18.733

不同的需要在 p.author_name 之前。在这种情况下，您不能只选择 p.topic_id 来区分。如果您想要做的是我认为的那样，您应该查找 GROUP BY 子句。

# mathematical-optimization - 最佳开源混合整数优化求解器

> ID：502102
> 
> 赞同：52
> 
> 时间：2009-02-02T03:19:18.370
> 
> 标签：mathematical-optimization, linear-programming, convex-optimization, cplex

我正在使用 CPLEX 来解决巨大的优化模型（超过 10 万个变量）现在我想看看我是否可以找到一个开源替代方案，我解决了混合整数问题 (MILP) 并且 CPLEX 效果很好，但是如果我们想要扩展，所以我真的需要找到替代方案或开始编写我们自己的临时优化库（这会很痛苦）

任何建议/见解将不胜感激

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-02T22:41:03.953

我个人发现[GLPK](http://www.gnu.org/software/glpk/)比 LP_SOLVE 更好（即更快）。它支持各种文件格式，另一个优势是它的库接口，可以与您的应用程序顺利集成。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-09-29T05:49:28.607

[COIN-OR 的](http://coin-or.org)另一个背书。我们发现线性优化器组件 (Clp) 非常强大，并且混合整数组件 (Cbc) 可以通过一些分析很好地调整。我们与 LP-Solve 和 GLPK 进行了比较。

对于真正棘手的问题，商业解决方案是必经之路。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-05-21T21:30:16.710

试试 SCIP 求解器。我已将它用于具有超过 300K 变量且性能良好的 MILP 问题。它的 MILP 性能比 GLPK 好得多。Gurobi 在 MILP 问题上也有出色的表现（通常比 SCIP（2011 年 5 月）更好），但如果您不是学术用户，它可能会很昂贵。Gurobi 将使用多核来加速求解器。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-11-06T10:16:01.380

如果我是你，我会尝试使用多求解器接口，例如 Osi (C++) 或 PuLP (python)，这样你就可以编写一次代码，并使用多个求解器对其进行测试。

如果您要求解的整数程序很大，我会推荐使用 Python 而不是 C++，因为您的代码看起来会更简洁，并且 99% 的时间都花在求解器上。

*   [https://projects.coin-or.org/Osi](https://projects.coin-or.org/Osi)
*   [http://code.google.com/p/pulp-or/](http://code.google.com/p/pulp-or/)

相反，如果问题很小，那么将问题从 python 内存复制到求解器（来回）的时间就不再被忽视：在这种情况下，您可以使用编译语言尝试一些显着的性能改进.

但是如果问题非常巨大，那么编译语言将再次获胜，因为内存占用将大致除以 2（python 中没有问题的副本）。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-02T05:11:49.157

你试过[`lp_solve`](http://lpsolve.sourceforge.net/)吗？对于 Java，以下问题中还有一些其他建议：

*   [Java的数学优化库——免费还是开源推荐？](https://stackoverflow.com/questions/143020/mathematical-optimization-library-for-java-free-or-open-source-recommendation)
*   [Java的线性编程工具/库](https://stackoverflow.com/questions/260442/linear-programming-tool-libraries-for-java)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-06T01:11:35.390

我建议查看 COIN 项目。 [硬币或](http://www.coin-or.org/index.html "硬币或")

这里有许多优秀的求解器，包括用于非线性问题的 ipOPT 和几个混合整数求解器。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-01-20T17:35:17.403

[scip](http://scip.zib.de/)还不错！

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-01-25T18:10:09.147

尽管这可能不是您想听到的，但一方面商业求解器 CPLEX 和 Gurobi 与开源求解器之间存在光年。

尽管如此，你还是很幸运的，你的模型可以很好地与 GLPK、Coin 等类似，但总的来说，开源解决方案远远落后于商业求解器。如果不同，没有人愿意为 Gurobi 许可证支付 12.000 美元，甚至为 CPLEX 许可证支付更多。

在过去的几年里，我看到了许多对开源求解器来说非常困难的模型。相信我...

这不是大小的问题，而是数字难度的问题。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-11-15T13:39:16.090

我很惊讶没有人提到 MIPCL ( [http://www.mipcl-cpp.appspot.com/index.html](http://www.mipcl-cpp.appspot.com/index.html) )。该求解器声称在 LGPL 许可下是开源的（来源： http: [//www.mipcl-cpp.appspot.com/licence.html](http://www.mipcl-cpp.appspot.com/licence.html)），因此它也适用于非开源应用程序。但是真正开源所缺少的是求解器本身的源代码。

Hans Mittelmann 最近（2017 年 9 月 10 日）做了混合整数线性规划基准测试： http: [//plato.asu.edu/ftp/milpc.html](http://plato.asu.edu/ftp/milpc.html)（您可能也有兴趣查看概览页面[http://plato.asu .edu/bench.html](http://plato.asu.edu/bench.html)或他的演讲幻灯片：http: [//plato.asu.edu/talks/informs2017.pdf](http://plato.asu.edu/talks/informs2017.pdf)）。

在具有 12 个线程和 2 小时时间限制的混合整数线性规划基准测试中，MIPCL 设法解决了 79 个实例。只有商业求解器 CPLEX、Gurobi 和 XPRESS 能够在给定的约束（分别为 86 或 87 个实例）下解决更多问题。

同样在选择的性能指标（再次使用 12 个线程）方面，MIPCL 比基准 SCIP 衍生产品（FSCIPC、FSCIPS）和开源求解器 CBC 更快。同样，只有商业求解器 CPLEX、Gurobi 和 XPRESS 在性能方面明显胜过 MIPCL。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-08-13T14:46:17.423

100k 个变量是个大问题。许多开源库不能很好地处理这么多变量。从我读过的内容来看， lp_solve 仅针对大约 30k 变量进行了测试。使用商业系统可能是您唯一的选择。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-07-05T21:58:42.237

我使用 DICOPT 使用 NEOS 服务器（[http://www.neos-server.org/neos/solvers/minco:DICOPT/GAMS.html](http://www.neos-server.org/neos/solvers/minco:DICOPT/GAMS.html)）来解决大型（大约 1k 个变量和 1k 个约束）混合整数非线性程序并发现它很棒。

对于我的问题，DICOPT 比 Neos 服务器 BARON/KNITRO/LINDO/SBB 等上列出的其他 MINLP 求解器做得更好。

向 NEOS 提交作业有一定的限制，而且有点麻烦，但是免费访问强大的商业求解器足以弥补它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-10-11T23:31:15.037

我将在已经很好的答案中添加以下内容。

虽然正如其他人所指出的那样，商业求解器比免费替代方案更快、更有能力，重要的是要考虑你可以接受多少最优性差距。对于具有许多整数变量的大型问题，如果您可以接受 1% 甚至更大的最优性差距（默认值往往在 0.01% 左右或更小），您可能会获得更快的求解时间。

当然，如果您正在解决一个 1% 转化为数百万美元的问题，这是不可接受的 - 因此市场需要一流的解决方案。[（这里](http://www.gurobi.com/resources/switching-to-gurobi/open-source-solvers)Gurobi 与免费求解器的一些比较）

我同意其他人的观点，即使用生成独立于求解器的问题文件（例如 *.mps、*.lp 文件）的平台是值得的，因为您可以尝试其他求解器。我正在使用[PuLP](http://pythonhosted.org/PuLP/solvers.html?highlight=mps#pulp.solvers.COIN_CMD.readsol_MPS)并且正在找到它，以及免费的 COIN_CBC 求解器，非常好。虽然仅限于许多整数变量的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-03-12T17:15:28.880

不是开源的，但如果您拥有 Microsoft Academic Alliance 许可证，则包括[Microsoft Solver Foundation](http://code.msdn.microsoft.com/solverfoundation) (MSF) 企业版。[Gurobi](http://www.gurobi.com/)对于学术目的也是免费的，我在我的论文研究中使用了它。

# asp.net - 绑定到字符串数组的网格视图的 dataKeyName 是什么？

> ID：502106
> 
> 赞同：3
> 
> 时间：2009-02-02T03:23:36.957
> 
> 标签：asp.net, gridview

谁能给我一个简短的片段，给定一个最初绑定到简单字符串数组的 GridView，并给定一个 GridViewRow 行，将返回绑定到该行的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T05:57:46.287

您不能，System.String 的唯一属性是 Length，而 DataKeyName 需要您绑定到的对象的属性。要回答您的第二个问题，这里有一个从 GridViewRow 获取字符串值的示例。

在您的 ASPX 文件中：

```
<asp:GridView ID="GridView1" runat="server"
    OnRowDataBound="GridView1_RowDataBound" AutoGenerateColumns="false">
    <Columns>
        <asp:TemplateField HeaderText="String Value">
            <ItemTemplate>
                <%# Container.DataItem %>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

在您的代码隐藏中：

```
protected void Page_Load(object sender, EventArgs e) {
    string[] arrayOfStrings = new string[] { "first", "second", "third" };
    GridView1.DataSource = arrayOfStrings;
    GridView1.DataBind();
}

protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e) {
    if (e.Row.RowType == DataControlRowType.DataRow) {
        // e.Row is of type GridViewRow
        // e.Row.DataItem contains the original value that was bound,
        // but it is of type object so you'll need to cast it to a string.
        string value = (string)e.Row.DataItem;
    }
} 
```

该问题的唯一合理解决方法是创建一个具有属性的包装类。或者，如果您使用的是 .NET 3.5，则可以使用 LINQ 创建一个临时列表，其中仅包含您的值作为类的属性。[vtcoder](http://social.msdn.microsoft.com/en-US/profile/?user=vtcoder#sort=recent&page=0&filter=allcontent)[在 MSDN 论坛上有一个这种技术](http://social.msdn.microsoft.com/Forums/en-US/winformsdatacontrols/thread/860e8b9a-6aea-410b-b3ed-acf9f43a6110/)的例子。

```
List<string> names = new List<string>(new string[] { "John", "Frank", "Bob" });

var bindableNames = from name in names
                    select new {Names=name};

GridView1.DataSource = bindableNames.ToList(); 
```

那么“名称”将是 DataKeyName 和 BoundField DataField。

# asp.net - “静默”处理请求验证

> ID：502112
> 
> 赞同：4
> 
> 时间：2009-02-02T03:28:44.903
> 
> 标签：asp.net, validation, events

我正在尝试覆盖 web 表单的 onError 事件处理程序，以允许在表单中处理“从客户端检测到潜在危险的 Request.Form 值”类型错误，而不是在应用程序级错误处理程序处结束。

我发现了一些这样的示例代码：

```
 protected override void OnError(EventArgs e)
{
    // At this point we have information about the error
    HttpContext ctx = HttpContext.Current;

    Exception exception = ctx.Server.GetLastError();

    string errorInfo =
       "<br>Offending URL: " + ctx.Request.Url.ToString() +
       "<br>Source: " + exception.Source +
       "<br>Message: " + exception.Message +
       "<br>Stack trace: " + exception.StackTrace;

    ctx.Response.Write(errorInfo);

    // --------------------------------------------------
    // To let the page finish running we clear the error
    // --------------------------------------------------
    ctx.Server.ClearError();

    base.OnError(e);

} 
```

它令人满意地捕获了错误并将错误消息写入屏幕，但我真正想做的是在 Page_Load 触发时注意错误，以便能够在 webform 上显示“正常”错误消息。

我确定有一个好方法可以做到这一点，但我不知道！建议？

（顺便说一句，出于各种原因，我不想在表单或应用程序级别关闭检查，我也不希望依赖 Javascript - 谢谢）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T20:31:39.300

您实际上可以在页面级别捕获错误，但它会终止页面生命周期。所以你必须使用一个技巧来绕过它。例子：

```
public override void ProcessRequest(HttpContext context)
{
  try
  {
    base.ProcessRequest(context);
  }
  catch(HttpRequestValidationException ex)
  {
      context.Response.Redirect("HandleValidationError.aspx");
  }
} 
```

HandleValidationError.aspx 可以是任何东西，包括重定向回同一页面（可能使用带有错误信息的查询字符串，例如“ContactForm.aspx?error=Invalid+Request”）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T04:41:13.290

我想我明白你想做什么，但恐怕这不可能。当您的 ASP.NET 页面执行回发时，会在服务器上创建一个新线程来处理请求。在您的页面生命周期甚至有机会开始之前，就会发现有问题的 XSS 并引发异常。一旦抛出此异常，您将被“驱逐”出 ASP.NET 页面生命周期，并且无法重新进入它。此时，您在客户端唯一可以做的就是输出错误，或者重定向到错误页面。

您似乎想要做的是捕获异常，将其写在页面上的某个位置，然后继续 ASP.NET 页面生命周期（即恢复控件树、恢复视图状态、调用事件处理程序等）。问题是一旦抛出未处理的异常，您就无法再访问 ASP.NET 页面生命周期。在这种特殊情况下，没有地方可以放置 try/catch 块，因为异常是在调用您自己的代码之前从 ASP.NET 生命周期内部引发的。

我知道您说过您不想依赖 Javascript，但在这种情况下，我认为使用 Javascript 是获得所需行为的唯一方法。您仍然可以保留服务器端验证，以防您的用户禁用 Javascript 或键入一些您的 Javascript 无法处理的输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T04:07:59.020

我认为您无法处理 Page_load 事件中的错误。在[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)验证事件发生在页面加载之后。

也许您可以添加一个包含“正常错误消息”的隐藏 div (<asp:Panel Visible=false ...)。如果 OnError 事件触发，则显示错误消息 div。

杰森

# ruby-on-rails - Rails：脚手架自动做一对多关系

> ID：502119
> 
> 赞同：14
> 
> 时间：2009-02-02T03:37:28.177
> 
> 标签：ruby-on-rails, foreign-key-relationship, scaffold

不确定我是否没看错，[但](https://stackoverflow.com/questions/163797)Scaffold 似乎不会完全建立一对多的关系。例如，如果我`messages`用脚手架创建然后我想要`comments`那些`messages`（一个`message`-> 多个`comments`），我必须经历并改变一切。例如，我必须在`comment`'s`new`视图中更改它

```
<% form_for(@comment) do |f| %> 
```

对此

```
<% form_for([@message, @comment]) do |f| %> 
```

然后更改 Action 以设置`@message`var... 除其他外。

**目前这不能用 Scaffold 自动完成，对吧？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-02T05:11:12.090

是的。脚手架适用于模型和相关控制器。它不照顾或处理关系。

Scaffold 的主要目标是让 CRUD 使用控制器和相关视图在模型上运行。就这样。任何其他需求（如关系）都必须手动编码。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-05T20:18:43.360

这是真的，但是，这不是故事的结局。至少有两种替代 Scaffold 的方法，它们都工作得很好，并且可以自动获取类之间的关系（基于你的 ActiveRecord 关系指标，比如 has_many）。这些替代方案之一是[Streamlined](http://github.com/relevance/streamlined/tree/master)，另一个是[ActiveScaffold](http://activescaffold.com/)。

它们主要有助于输入系统需要的非用户输入数据的数据。例如，我将它们用于表上的管理任务，其中没有必要为 CRUD 构建完整的 UI，而其中一个脚手架替代方案可以很好地完成一项很少使用的功能。不过，您不希望将它们用于对消息的评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-12T21:02:10.970

请注意，有像[Hobo](http://hobocentral.net/) for Rails 这样的项目允许您将字段和关联保留在模型本身中。你不能建立关联，但它非常接近。

您最终会通过在背后构建更多应用程序来为这种糖分付出代价。您通常不是自己滚动，而是从大量预构建的行为中减去您需要的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-12T15:38:56.010

您不需要繁重的 Rails 管理框架来获得一对多的关系。

您可以使用脚手架来实现大部分目标。

在控制器和 _form 视图中做更多的工作会让你完成剩下的工作。

就是这样...

```
Story: Select a beer for a developer

In order to select a beer for a developer
As an admin
I want a mainly scaffolded interface to select that beer

Scenario 1: Select beer for new developer
Given I have clicked the <new> button  and entered the developer's name
When I click the beer dropdown
Then I should be presented with a list of beers to choose from
And that beer will be saved when I click <ok>

Scenario 2: Select a different beer for existing developer
Given I have clicked the <edit> button on the index page for a particular developer
When I click the beer dropdown
Then I should be presented with a list of beers to choose from
And that beer will be saved when I click <ok> 
```

假设我们有一张**啤酒**桌：

```
 create_table "beers", force: true do |t|
    t.string   "name"
    t.datetime "created_at"
    t.datetime "updated_at"
  end 
```

还有一个**开发者**表，它有一个引用 beers 表的外键 (beer_id)：

```
 create_table "developers", force: true do |t|
    t.string   "name"
    t.integer  "beer_id"
    t.datetime "created_at"
    t.datetime "updated_at"
  end 
```

我们可以使用脚手架来创建两个表：

> $ rails g 脚手架啤酒名称
> 
> $ rails g 脚手架开发人员名称 beer_id:integer

脚手架命令为每个模型创建控制器和视图。

我们需要稍微修改一下我们的控制器和视图，以便让下拉菜单为每个开发人员选择一种啤酒：

**app/views/developers/_form.html.erb**

将生成的 text_field 和 beer_id 标签替换为以下内容：

```
 <div class="field">
    <%= f.label :beer_id %><br />
    <%= collection_select(:developer, :beer_id, @beers, :id, :name, {:prompt => false}) %> 
  </div> 
```

**应用程序/控制器/developer_controller.rb**

编辑控制器的 new 和 edit 方法：

```
 # GET /developers/new
  def new
    @developer = Developer.new
    @beers = Beer.all
    respond_to do |format|
      format.html # new.html.erb
    end
  end

  # GET /developers/1/edit
  def edit
    @beers = Beer.all
    respond_to do |format|
      format.html # new.html.erb
    end    
  end 
```

**屏幕截图**

![在此处输入图像描述](https://i.stack.imgur.com/4PDCw.png)

![在此处输入图像描述](https://i.stack.imgur.com/CEyk0.png)

![在此处输入图像描述](https://i.stack.imgur.com/9f4K1.png)

**笔记**

Rails 脚手架很棒。查看它为您创建的所有文件：

```
$ be rails g scaffold beer name
      invoke  active_record
      create    db/migrate/20140912144218_create_beers.rb
      create    app/models/beer.rb
      invoke    rspec
      create      spec/models/beer_spec.rb
      invoke      factory_girl
      create        spec/factories/beers.rb
      invoke  resource_route
       route    resources :beers
      invoke  scaffold_controller
      create    app/controllers/beers_controller.rb
      invoke    erb
      create      app/views/beers
      create      app/views/beers/index.html.erb
      create      app/views/beers/edit.html.erb
      create      app/views/beers/show.html.erb
      create      app/views/beers/new.html.erb
      create      app/views/beers/_form.html.erb
      invoke    rspec
      create      spec/controllers/beers_controller_spec.rb
      create      spec/views/beers/edit.html.erb_spec.rb
      create      spec/views/beers/index.html.erb_spec.rb
      create      spec/views/beers/new.html.erb_spec.rb
      create      spec/views/beers/show.html.erb_spec.rb
      create      spec/routing/beers_routing_spec.rb
      invoke      rspec
      create        spec/requests/beers_spec.rb
      invoke    helper
      create      app/helpers/beers_helper.rb
      invoke      rspec
      create        spec/helpers/beers_helper_spec.rb
      invoke    jbuilder
      create      app/views/beers/index.json.jbuilder
      create      app/views/beers/show.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/beers.js.coffee
      invoke    scss
      create      app/assets/stylesheets/beers.css.scss
      invoke  scss
      create    app/assets/stylesheets/scaffolds.css.scss 
```

您所要做的就是知道当您想要的不仅仅是基本的 CRUD 操作时要修改哪些文件。

希望有帮助。〜莱克斯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T13:04:32.227

脚手架是脚手架。当您想要除 CRUD 以外的任何东西时（这是脚手架的作用），您需要更改生成的脚手架代码，或滚动您自己的代码。

# precision - 避免精度损失的最佳算法？

> ID：502122
> 
> 赞同：7
> 
> 时间：2009-02-02T03:39:55.660
> 
> 标签：precision, numerical-analysis

我最近收到的一项家庭作业要求我们采用在计算机中执行时可能会造成精度损失的表达式，并对其进行更改以避免这种损失。

不幸的是，这样做的方向还不是很清楚。通过观看各种示例，我知道有一些方法可以做到这一点：使用泰勒级数，如果涉及平方根则使用共轭，或者当两个分数相减时找到一个公分母。

但是，我很难准确地注意到何时会发生精度损失。到目前为止，我唯一确定的是，当您减去两个接近相同的数字时，会发生精度损失，因为高位数字很重要，并且您会从四舍五入中丢失这些数字。

我的问题是我应该寻找哪些其他常见情况，以及哪些被认为是接近它们的“好”方法？

例如，这里有一个问题：

```
f(x) = tan(x) − sin(x)  when x ~ 0 
```

从这三个选择中评估这个的最佳和最差算法是什么：

```
(a) (1/ cos(x) − 1) sin(x),
(b) (x^3)/2
(c) tan(x)*(sin(x)^2)/(cos(x) + 1). 
```

我知道当 x 接近于零时，tan(x) 和 sin(x) 几乎相同。我不明白这些算法如何或为什么在解决问题方面更好或更差。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T03:50:57.180

通常使用的另一个经验法则是：当添加一长串数字时，从最接近零的数字开始添加，并以最大的数字结束。

解释为什么这是好的有点棘手。当您将小数添加到大数时，它们有可能会被完全丢弃，因为它们小于当前大数尾数中的最低位。以这种情况为例：

```
a = 1,000,000;
do 100,000,000 time:
   a += 0.01; 
```

如果 0.01 小于最低尾数位，则循环不执行任何操作，最终结果为 a == 1,000,000 但如果您这样做：

```
a = 0;
do 100,000,000 time:
   a += 0.01;
a += 1,000,000; 
```

比低数字缓慢增长，您更有可能最终得到接近 == 2,000,000 的值，这是正确的答案。
这当然是一个极端的例子，但我希望你明白这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T03:53:35.740

当我还是本科生的时候，我不得不上一门数字课，这非常痛苦。总之，[IEEE 754](http://en.wikipedia.org/wiki/IEEE_754)是现代 CPU 通常实现的浮点标准。了解它的基础知识很有用，因为这让您对不该做什么有很多直觉。对它的简化解释是，计算机以类似于 base-2 科学记数法的方式存储浮点数，其中指数和尾数具有固定数量的数字（位）。这意味着一个数字的绝对值越大，表示它的精度就越低。对于 IEEE 754 中的 32 位浮点数，一半可能的位模式表示介于 -1 和 1 之间，即使高达约 10^38 的数字可以用 32 位浮点数表示。对于大于 2^24（约 1670 万）的值，32 位浮点数不能准确表示所有整数。

这对您来说意味着您通常希望避免以下情况：

1.  当预期最终答案很小时，中间值很大。
2.  在大数中添加/减去小数。例如，如果你写了类似的东西：

    for（浮点索引 = 17000000；索引 < 17000001；索引++）{}

此循环永远不会终止，因为 17,000,000 + 1 向下舍入为 17,000,000。如果你有类似的东西：

```
float foo = 10000000 - 10000000.0001 
```

由于舍入误差，foo 的值将是 0，而不是 -0.0001。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-08T15:04:09.993

> 我的问题是我应该寻找哪些其他常见情况，以及哪些被认为是接近它们的“好”方法？

有几种方法可能会导致严重甚至灾难性的精度损失。

最重要的原因是浮点数的位数有限，例如双精度数有 53 位。这意味着如果您有“无用”的数字，这些数字不是解决方案的一部分，但必须存储，您就会失去精度。

例如（我们使用十进制类型进行演示）：

2.5987650000000000000000000000100 -

2.5987650000000000000000000000099

有趣的部分是 100-99 = 1 的答案。由于 2.598765 在两种情况下都相等，因此不会改变结果，但会浪费 8 位。更糟糕的是，由于计算机不知道这些数字是无用的，它被迫存储它并在其后填入 21 个零，浪费了所有 29 个数字。不幸的是，没有办法因差异而规避它，但还有其他情况，例如 exp(x)-1，它是物理学中经常出现的函数。

0 附近的 exp 函数几乎是线性的，但它强制将 1 作为前导数字。所以 12 位有效数字 exp(0.001)-1 = 1.00100050017 - 1 = 1.00050017e-3

如果我们使用函数 expm1()，则使用泰勒级数：

1 + x +x^2/2 +x^3/6 ... -1 =

x +x^2/2 +x^3/6 =: expm1(x)

expm1(0.001) = 1.00500166667e-3

好多了。

第二个问题是具有非常陡峭斜率的函数，例如 pi/2 附近 x 的切线。tan(11) 的斜率为 50000，这意味着之前由舍入误差引起的任何小偏差都会被放大 50000 倍！或者，如果结果接近 0/0，则您有奇点，这意味着它可以具有任何值。

在这两种情况下，您都创建了一个替代函数，只是简化了原始函数。强调不同的解决方法是没有用的，因为如果不进行培训，您将根本无法“看到”问题。

一本非常适合学习和培训的书：Forman S. Acton：Real Computing made real

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T04:32:47.143

要避免的另一件事是减去几乎相等的数字，因为这也会导致对舍入误差的敏感性增加。对于接近 0 的值，cos(x) 将接近 1，因此 1/cos(x) - 1 是您希望尽可能避免的减法之一，所以我会说 (a) 应该避免.

# lambda-calculus - 你知道哪些优雅且图灵完备的机器*？书里有没有？

> ID：502123
> 
> 赞同：1
> 
> 时间：2009-02-02T03:40:05.393
> 
> 标签：lambda-calculus, turing-complete

Lambda 演算当然是相当优雅的，但是函数的输入和输出之间存在这种不对称，你不会感到困扰吗？即你可以让函数接受两个参数（通过返回一个函数），但你不能让它返回两个值。我不认为我们可以在[The Book](http://en.wikipedia.org/wiki/Proofs_from_THE_BOOK)中找到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T03:42:35.497

您可以让它返回一个*函数*，其评估返回两个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-14T03:38:02.410

或者您可以返回一个复合结构。就像一个向量函数返回一个向量，其中有单独的组件。

顺便说一句，您的标题问题与您提出的实际问题有什么关系？

# .net - C# 索引搜索类似于 AVA 查找

> ID：502132
> 
> 赞同：0
> 
> 时间：2009-02-02T03:46:27.923
> 
> 标签：.net

您可能知道 AVA Find，它首先索引整个硬盘，然后您可以非常快速地搜索文件，可以非常快速地找到文件（即使在低端 SPU 中也可以在一秒钟内）。如果使用 SQL server 做同样的事情，首先在 sql server db 中索引文件名，然后搜索，这将需要很长时间。我们如何在 C# 或 dot net 中创建类似 AVA Find 的程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T03:49:05.797

我不确定 avafind 或者这是否是您正在寻找的东西，但总是有 Lucene.Net，一个开源 .net 搜索引擎：http: [//incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/)

# ide - 您最喜欢的各种语言的骨架文件是什么？

> ID：502134
> 
> 赞同：5
> 
> 时间：2009-02-02T03:47:19.340
> 
> 标签：ide, code-generation

拥有可以复制并用作新脚本或应用程序基础的骨架或模板文件很有用。

例如，我使用以下这些（带有自动插入模块的 emacs 在我创建新文件时会自动打开相应骨架文件的副本）。

**珀尔**：

```
#!/usr/bin/perl -w 

use strict;
use Getopt::Long;

my $verbose = 1;

GetOptions("verbose!" => \$verbose
) or die("options error"); 
```

**C++**：

```
#include <iostream>
#include <stdexcept>

int main(int argc, char** argv){
  try{

  }
  catch(std::exception& e){
    std::cerr << e.what() << std::endl;
    return EXIT_FAILURE;
  }
  return EXIT_SUCCESS;
} 
```

可以说，一个可以包括基本代码`boost::program_options`等。

你最喜欢的骨架文件是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T03:52:40.673

我的 Perl 模板如下所示：

如果我打开一个 .pm 模块：

```
use MooseX::Declare;
class What::Ever {

};

1; 
```

或者，如果不在[MooseX::Declare](http://search.cpan.org/perldoc?MooseX::Declare)项目中：

```
package What::Ever;
use Moose;

1; 
```

如果是 .pl 文件：

```
#!/usr/bin/env perl
use strict;
use warnings;
use feature ':5.10'; 
```

因为我使用 autoinsert.el，所以我也让它问我是否要使用 FindBin；如果是这样：

```
#!/usr/bin/env perl
use strict;
use warnings;
use feature ':5.10';

use FindBin qw($Bin);
use lib "$Bin/../lib"; 
```

必要的 emacs 代码位于我的 elisp 存储库中，网址为[http://github.com/jrockway/elisp/blob/fd5d73530a117a13ddcde92bc1c22aba1bfde1f0/_local/auto-inserts.el](http://github.com/jrockway/elisp/blob/fd5d73530a117a13ddcde92bc1c22aba1bfde1f0/_local/auto-inserts.el)。

最后，我认为你会更喜欢[MooseX::Getopt](http://search.cpan.org/perldoc?MooseX::Getopt)而不是普通的 Getopt。这是编写“一次性”脚本的一种更易于维护的方法。（接下来的几行类似于：

```
use My::Script;                    # that's why we did the "use lib" thing
My::Script->new_with_options->run; # this parses the command line, creates a new object, and runs the script 
```

所有重要的代码都放在一个可以进行单元测试、粘合到 Web 应用程序等的类中。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T03:53:52.713

我拥有的唯一骨架文件是用于 LaTeX。

```
\documentclass{article}
%\documentclass[11pt]{amsart}
\usepackage[dvips]{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{cancel}
\oddsidemargin0cm
\topmargin-1cm
\textwidth16.5cm
\textheight23.5cm
\parskip1ex
\parindent0ex
\begin{document}
\title{ ... }
\author{ ... }
\date{ ... }
\maketitle

\end{document} 
```

显然我用它来写数学论文。

否则，我总是从头开始。我想不出任何一种编程语言，其中必要的基础设施比你可以在大脑中保留或花费超过 20 秒的时间来输入更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T15:11:37.993

**伯恩壳牌**

```
#!/bin/sh

usage() {
cat <<EOF
  $0 <cmd>
cmd:
  samplecmd
EOF
}

cmd=${1}
shift

case ${cmd} in
    samplecmd)
        arg1=${arg1:-${1}} # arg list takes precedence over env var
        if [ "x${arg1}" = "x" ] ; then
            usage
        fi
        samplecmd ${arg1}
        ;;
    *)
        usage
        ;;
esac 
```

我喜欢制作像这样的小帮助脚本来记录我在 shell 中键入的命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T04:29:26.697

在 Visual Studio 中，它们被称为项目文件；我目前最喜欢的是 Windows 应用程序 ;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T05:00:09.133

**爪哇**

```
package edu.vt;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

public class Template
{
   private Log log = LogFactory.getLog(getClass());

   /* Constructors
   ***************************************************************************/

   public Template()
   {
   }

   /* Accessors/Mutators
   ***************************************************************************/

   /* Local Methods
   ***************************************************************************/
} 
```

和

```
package testing.edu.vt;

import edu.vt.Template;
import junit.framework.TestCase;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

public class TemplateTestCase extends TestCase
{
   private final Log log = LogFactory.getLog(getClass());

    public TemplateTestCase(final String name)
    {
      super(name);
    }

    protected void setUp()
    {
    }

    protected void tearDown()
    {
    }

    public void testLifeCycle() throws Exception
    {
      assertTrue(true);
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T05:06:16.297

Python 很简单，但如果您使用快捷方式名称导入内容，它仍然会有所帮助，例如：

```
import sys
import numpy as np
import pylab as pyb
import matplotlib.pyplot as plt
import matplotlib as mpl 
```

但不要这样做：导入天网。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T04:17:22.590

当我编写将成为 OSS 的代码时，我有一个简单的样板模板，我可以输入许可证和许可证文本的 URL。样板有作者详细信息，以及其他硬编码的废话。

对于商业开发，我有一个包含公司信息和标准版权声明的样板。

我没有保留任何标准骨架，因为我发现我只是剪掉了内容并添加了自己的内容。大多数情况都足够不同，以至于改变骨架以匹配需要只要用手猛击它就可以了。

# javascript - Javascript 逗号运算符

> ID：502138
> 
> 赞同：0
> 
> 时间：2009-02-02T03:52:03.717
> 
> 标签：javascript, comma-operator

将赋值与逗号结合使用时（您可能不应该这样做），javascript 如何确定分配的值？考虑这两个片段：

```
function nl(x) { document.write(x + "<br>"); }
var i = 0;
nl(i+=1, i+=1, i+=1, i+=1);
nl(i); 
```

和：

```
function nl(x) { document.write(x + "<br>"); }
var i = 0;
nl((i+=1, i+=1, i+=1, i+=1));
nl(i); 
```

第一个输出

```
1
4 
```

而第二个输出

```
4
4 
```

括号在这里做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T03:53:00.750

我在这里混淆了两件事。对“nl”的第一次调用是一个带有四个参数的函数调用。第二个是将逗号评估为一个参数。

所以，答案是：由“，”分隔的表达式列表的[值是最后一个表达式](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Special_Operators/Comma_Operator)的值。

# c# - 我可以使用命令行，还是从托管代码运行批处理文件？（。网）

> ID：502156
> 
> 赞同：5
> 
> 时间：2009-02-02T04:05:42.347
> 
> 标签：c#, .net, command-line

正如题主所说。我希望能够从控制台应用程序运行 iisreset、批处理文件等。我可以/我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T04:08:17.083

这是很有可能的，例如：

```
 System.Diagnostics.Process.Start(@"C:\listfiles.bat"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T04:09:07.643

[从C# Station](http://www.csharp-station.com/HowTo/ProcessStart.aspx)检查这个例子

```
using System;
using System.Diagnostics;

namespace csharp_station.howto
{
    /// <summary>
    /// Demonstrates how to start another program from C#
    /// </summary>
    class ProcessStart
    {
        static void Main(string[] args)
        {
            Process notePad = new Process();

            notePad.StartInfo.FileName   = "notepad.exe";
            notePad.StartInfo.Arguments = "ProcessStart.cs";

            notePad.Start();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T04:23:09.160

你也可以这样做：

```
 System.Diagnostics.ProcessStartInfo info = new System.Diagnostics.ProcessStartInfo();
  info.UseShellExecute = true;
  info.FileName = "iisreset";
  System.Diagnostics.Process.Start(info);

  Console.ReadLine(); 
```

# visual-studio - 如何在 Visual Studio 2008 中使用 IronPython

> ID：502173
> 
> 赞同：12
> 
> 时间：2009-02-02T04:21:53.547
> 
> 标签：visual-studio, ironpython, ironpython-studio

我尝试使用 Microsoft 提供的 IronPython 集成扩展。但它不适用于 Visual Studio 2008。

IronPython 是否有合适的 VS 2008 IDE 扩展？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T01:34:30.170

对于 IronPython 1.1 支持（其语法反映 CPython 2.4），我成功地构建并安装了来自[Visual Studio 2008 SDK 1.0](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=30402623-93ca-479a-867c-04dc45164f5b)和 Visual Studio 2008 SP1 专业版的示例。它适用于从 Standard 到 Team Suite 的任何版本。由于 Express 内置的限制，它绝对不适用于 Express Edition。

对于 IronPython 2.0（其语法与 CPython 2.5 一致），目前没有在 Visual Studio 2008 下编写和调试的好方法，不幸的是，将[IronPython Studio](http://www.codeplex.com/IronPythonStudio)改编为托管 IronPython 2.0 将是一项重大任务——这是重大更新之一在 IronPython 2.0 中是基于[Dynamic Language Runtime](http://www.codeplex.com/dlr)，这打破了以前使用的启用 IntelliSense 的技巧，例如静态编译。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T04:28:55.827

您是否尝试过[用于 VS 2008 Shell 的 IronPython Studio](http://blogs.msdn.com/vsxteam/archive/2007/12/14/IronPython-Studio-for-VS-2008-Shell-released.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T05:43:56.033

目前，没有在 Visual Studio 上运行 IronPython v2.0 的扩展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T22:29:45.340

我是 VS2008 和 IronPython 的新手（但不是 Python 本身）：但在我看来，我确实在 VS 2008 Pro 下运行 IronPython 2.0.1，尽管方式相当麻烦。

1.  按照[http://blogs.msdn.com/aaronmar/archive/2006/02/16/533273.aspx](http://blogs.msdn.com/aaronmar/archive/2006/02/16/533273.aspx)上的说明进行操作，并进行一些修改：在 MS 网站上搜索 VS 2008 SDK，以及 IronPythonIntegration 解决方案的路径因此处于稍微不同（但可预测）的位置。
2.  接下来-“然后，只需按 CTRL+F5 进行构建和运行即可。这将使用“实验配置单元”启动 Visual Studio。”。是的，这会在第一个实例之上启动*另一个VS 实例，但幸运的是，您只需在第一次完成构建过程时等待。*

其余的说明对我有用：我构建了一个简单的测试控制台应用程序，它按我的预期工作。不过，我还没有尝试过任何.Net 的东西。

现在，如果只有一种简单的方法可以更改 sys.path 以使用普通的 Python 库......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T18:42:52.427

```
string code = @"100 * 2 + 4 / 3";

ScriptEngine engine = Python.CreateEngine();
ScriptSource source =
  engine.CreateScriptSourceFromString(code, SourceCodeKind.Expression);

int res = source.Execute<int>();
Console.WriteLine(res); 
```

有关完整的教程和示例代码，请查看以下链接：

**使用 IronPython 扩展您的 C# 应用程序**

[http://blogs.microsoft.co.il/blogs/berniea/archive/2008/12/04/extending-your-c-application-with-ironpython.aspx](http://blogs.microsoft.co.il/blogs/berniea/archive/2008/12/04/extending-your-c-application-with-ironpython.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-17T05:59:09.997

如果您只是想在 ASP .NET 网站中使用 IronPython（不支持的项目），请查看[如何安装 Microsoft ASP.NET Futures（2007 年 7 月）](http://startclass0830.blogspot.com/2009/03/using-ironpython-in-asp-net-vs-2008.html)

# java - 基本数组初始化和排序问题

> ID：502178
> 
> 赞同：2
> 
> 时间：2009-02-02T04:25:53.197
> 
> 标签：java, arrays, new-operator

这是一个相当基本的java问题

我有一个包含字符串的数组，我想使用 java.util.Arrays.sort 对其进行排序

当我写

```
String[] myArray = {"A","B","C"};
java.util.Arrays.sort(myArray); 
```

它被正确排序

但是当我有

```
String[] myArray = new String[10];
myArray[0] = "A";
myArray[1] = "B";
myArray[2] = "C";

java.util.Arrays.sort(myArray); 
```

排序抛出一个空引用异常

我很确定它真的很愚蠢，我只是现在不明白。我必须新的字符串，因为硬编码默认值不会让任何人，任何地方。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T04:28:24.220

初始化第二个数组时，只初始化前三个元素。其他元素初始化为 null，因此无法排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T04:46:54.650

在源代码中，该方法使用 compareTo() 作为排序条件。*显然，在null*上调用 compareTo()会引发 NullPointerException。正如它在 Java Docs 中提到的那样，

> 数组中的所有元素必须相互比较（即 e1.compareTo(e2) 不得为数组中的任何元素 e1 和 e2 抛出 ClassCastException）

当然，这里不是关于 ClassCastException，但对comapreTo() 的调用是显而易见的。

**[已编辑]**

PS 从异常堆栈跟踪中找出这一点是您最好的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T08:47:11.453

尝试以下仅对前三个元素进行排序。

```
Arrays.sort(myArray, 0, 3); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T04:28:35.280

发生的情况是，当您拥有包含十个项目的数组时，其他项目未初始化。因此，当排序算法工作时，它会尝试获取字符串的值，但什么也得不到，并抛出异常。

您需要确保不要尝试对空间比放入其中的内容更多的数组进行排序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T04:28:36.870

我认为，由于您`myArray`存储了 10 个元素，因此它（有效地）在末尾添加了 7 个空值，然后`Arrays.sort()`无法针对字符串对空元素进行排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T04:37:03.657

它无法处理最初创建数组时存在的空字符串。为了避免要么明确地将所有内容设为“”，要么根据需要分配。

虽然不知道这是否是 API 级别的失误，因为他们可以满足空对象（我们在 SQL orderby 中获取的方式）或者还有更多内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T04:29:23.330

您将数组大小定义为 10，但仅初始化 3 个索引。将数组大小更改为 3 或初始化所有十个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T04:30:29.613

该数组有 10 个项目，但你只在里面放了 3 个。因此，其他 7 个为 NULL。考虑改用 ArrayList。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-10-05T04:34:15.247

应该使用数组列表，因为有 3 个元素而不是 10 个。

数组的其他 7 个元素将具有空值。

正是这些空值在排序时导致空指针问题。

# visual-studio - Visual Studio 自定义构建步骤规则？

> ID：502194
> 
> 赞同：11
> 
> 时间：2009-02-02T04:32:30.077
> 
> 标签：visual-studio, visual-studio-2008, custom-build-step

使用 Visual Studio 2008，当我向 C++ 项目添加一个不是`.c/.cpp/.h/.rc`或任何 IDE 无法识别的文件时，会弹出一个对话框，询问我是否要为此类文件创建自定义构建步骤规则。

有人知道如何在不添加文件的情​​况下进入此对话框吗？我似乎无法在任何菜单中找到。

* * *

编辑：我对`.rules`文件了如指掌。我所说的是 Visual Studio 2008 中的一个 GUI 对话框，它允许您创建和编辑这些`.rules`文件。这是我提到的对话框，当您添加具有未知扩展名的文件时会弹出该对话框。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T00:45:01.190

如果您添加一个带有未知扩展名的项目，您将收到一个标题为“未找到匹配自定义构建规则”的消息框，询问您是否要创建一个新规则文件来定义自定义构建规则来构建文件那个扩展。如果单击“是”，您将看到“新建规则文件”对话框。

如果您只想获得相同的“新规则文件”对话框：

1.  右键单击您的项目
2.  选择“自定义构建规则...”
3.  单击“新建规则文件...”按钮

如果您询问如何获取“未找到匹配的自定义构建规则”消息框本身，我不确定您将如何做到这一点。（如果这就是你想要做的，你可能想在你的问题中澄清这一点）

# html - HTML/CSS：创建一个具有最小宽度的居中 div

> ID：502196
> 
> 赞同：4
> 
> 时间：2009-02-02T04:33:34.240
> 
> 标签：html, width, css

我想在我的页面上有一个`div`居中并具有一定宽度的页面，但如果内容需要，它会超出该宽度。我正在这样做：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <style type="text/css">
            .container-center {
                text-align: center;
            }
            .container-minwidth {
                min-width: 5em;
                display: inline-block;
                border: 1px solid blue;
            }
        </style>
    </head>
    <body>
        <div class="container-center">
            <div class="container-minwidth">
                a
            </div>
        </div>
    </body>
</html> 
```

这在 Firefox/Safari 上效果很好，但在不理解`display: inline-block`. 关于如何在 IE6 上进行这项工作的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T04:49:06.440

它不是一个完美的解决方案，但我已经解决了一些 IE6 缺乏对 min-width 支持的问题。

```
<style type="text/css">            
            .container-minwidth {
                min-width: 5em;

                width: auto !important;
                width: 500px; /* IE6 ignores the !important tag */

                /* would help for expanding content if it blows past 500px; */
                overflow:auto; 

                display: inline-block;
                border: 1px solid blue;
            }        
</style> 
```

在这种情况下可能有帮助的另一个标签是溢出标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T04:49:51.663

实际上 Alessandro IE6 确实理解`display: inline-block`，它不理解你的代码的是`min-width`. 有[很多技巧可以让它工作](http://www.google.com/search?q=min-width+ie6)，但我不推荐其中任何一个。如果您要使用它们中的任何一个，请确保将它们放在特定于 IE6 的样式表中，这样它就不会干扰您的其他更标准的投诉浏览器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T02:45:37.287

```
<style type="text/css">            
        .container-minwidth {
            min-width: 5em;
            _width: 500px;
            white-space:nowrap;

            display: inline-block;
            *display:inline;
            *zoom:1;

            border: 1px solid blue;
        }        
</style> 
```

# c# - 将 WPF (XAML) 控件转换为 XPS 文档

> ID：502198
> 
> 赞同：49
> 
> 时间：2009-02-02T04:36:09.913
> 
> 标签：c#, wpf, xaml, xps, xpsviewer

我可以使用现有的 WPF (XAML) 控件，对其进行数据绑定并将其转换为可以使用 WPF XPS 文档查看器显示和打印的 XPS 文档吗？如果是这样，怎么做？如果没有，我应该如何使用 XPS/PDF/等在 WPF 中进行“报告”？

基本上，我想采用现有的 WPF 控件，对其进行数据绑定以获取有用的数据，然后使其可打印并可供最终用户保存。理想情况下，文档创建将在内存中完成，除非用户专门保存文档，否则不会访问磁盘。这可行吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-02-03T01:21:52.317

实际上，在处理了一堆不同的样本之后，所有这些样本都非常复杂，需要使用 Document Writers、Containers、Print Queues 和 Print Tickets，我发现 Eric Sinks 关于[在 WPF 中打印的](http://www.ericsink.com/wpf3d/B_Printing.html)
文章 简化的代码只有 10 行长

```
public void CreateMyWPFControlReport(MyWPFControlDataSource usefulData)
{
  //Set up the WPF Control to be printed
  MyWPFControl controlToPrint;
  controlToPrint = new MyWPFControl();
  controlToPrint.DataContext = usefulData;

  FixedDocument fixedDoc = new FixedDocument();
  PageContent pageContent = new PageContent();
  FixedPage fixedPage = new FixedPage();

  //Create first page of document
  fixedPage.Children.Add(controlToPrint);
  ((System.Windows.Markup.IAddChild)pageContent).AddChild(fixedPage);
  fixedDoc.Pages.Add(pageContent);
  //Create any other required pages here

  //View the document
  documentViewer1.Document = fixedDoc;
} 
```

我的示例相当简单，它不包括页面大小和方向，其中包含一组完全不同的问题，这些问题无法按您的预期工作。它也不包含任何保存功能，因为 MS 似乎忘记在文档查看器中包含一个保存按钮。

保存功能相对简单（也来自 Eric Sinks 文章）

```
public void SaveCurrentDocument()
{
 // Configure save file dialog box
 Microsoft.Win32.SaveFileDialog dlg = new Microsoft.Win32.SaveFileDialog();
 dlg.FileName = "MyReport"; // Default file name
 dlg.DefaultExt = ".xps"; // Default file extension
 dlg.Filter = "XPS Documents (.xps)|*.xps"; // Filter files by extension

 // Show save file dialog box
 Nullable<bool> result = dlg.ShowDialog();

 // Process save file dialog box results
 if (result == true)
 {
   // Save document
   string filename = dlg.FileName;

  FixedDocument doc = (FixedDocument)documentViewer1.Document;
  XpsDocument xpsd = new XpsDocument(filename, FileAccess.ReadWrite);
  System.Windows.Xps.XpsDocumentWriter xw = XpsDocument.CreateXpsDocumentWriter(xpsd);
  xw.Write(doc);
  xpsd.Close();
 }
} 
```

所以答案是肯定的，您可以使用现有的 WPF (XAML) 控件，对其进行数据绑定并将其转换为 XPS 文档——这并不难。

# c# - 如何从我的应用程序中打开网页？

> ID：502199
> 
> 赞同：154
> 
> 时间：2009-02-02T04:36:39.617
> 
> 标签：c#, .net, wpf

我想让我的 WPF 应用程序打开默认浏览器并转到某个网页。我怎么做？

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2009-02-02T04:39:39.220

对于 .NET 的桌面版本：

```
System.Diagnostics.Process.Start("http://www.webpage.com"); 
```

对于 .NET Core，默认 for[`ProcessStartInfo.UseShellExecute`](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo.useshellexecute)已从 更改`true`为`false`，因此您必须将其显式设置为才能`true`使其正常工作：

```
System.Diagnostics.Process.Start(new ProcessStartInfo
    {
        FileName = "http://www.webpage.com",
        UseShellExecute = true
    }); 
```

更复杂的是，*不能*为 UWP 应用程序设置此属性`true`（因此这些解决方案都不适用于 UWP）。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2019-10-17T18:50:53.743

接受的答案不再适用于**.NET Core 3**。要使其工作，请使用以下方法：

```
var psi = new ProcessStartInfo
{
    FileName = url,
    UseShellExecute = true
};
Process.Start (psi); 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-02-02T04:39:47.333

我一直在使用这一行来启动默认浏览器：

```
System.Diagnostics.Process.Start("http://www.google.com"); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2015-11-06T18:22:41.717

虽然已经给出了一个很好的答案（使用`Process.Start`），但将其封装在一个检查传递的字符串是否确实是 URI 的函数中会更安全，以避免在机器上意外启动随机进程。

```
public static bool IsValidUri(string uri)
{
    if (!Uri.IsWellFormedUriString(uri, UriKind.Absolute))
        return false;
    Uri tmp;
    if (!Uri.TryCreate(uri, UriKind.Absolute, out tmp))
        return false;
    return tmp.Scheme == Uri.UriSchemeHttp || tmp.Scheme == Uri.UriSchemeHttps;
}

public static bool OpenUri(string uri) 
{
    if (!IsValidUri(uri))
        return false;
     System.Diagnostics.Process.Start(uri);
     return true;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-13T16:34:44.180

您无法从提升的应用程序启动网页。这将引发 0x800004005 异常，可能是因为 explorer.exe 和浏览器运行时未提升。

要在非提升的 Web 浏览器中从提升的应用程序启动网页，请使用 [Mike Feng 编写的代码](http://social.msdn.microsoft.com/Forums/is/vbgeneral/thread/3c9aa0fa-c860-4a26-bde0-4ccf8a3793b3)。我试图将 URL 传递给 lpApplicationName 但这不起作用。当我将 CreateProcessWithTokenW 与 lpApplicationName = "explorer.exe" （或 iexplore.exe）和 lpCommandLine = url 一起使用时也不会。

以下解决方法确实有效：创建一个具有一项任务的小型 EXE 项目：Process.Start(url)，使用 CreateProcessWithTokenW 运行此 .EXE。在我的 Windows 8 RC 上，这可以正常工作并在 Google Chrome 中打开网页。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-23T12:19:43.303

这是我的完整代码如何打开。

有2个选项：

1.  使用默认浏览器打开（行为就像在浏览器窗口内打开）

2.  通过默认命令选项打开（行为就像您使用“RUN.EXE”命令）

3.  通过“资源管理器”打开（行为就像您在文件夹窗口 url 中写入 url）

[可选建议] 4.使用iexplore进程位置打开需要的url

### 代码：

```
internal static bool TryOpenUrl(string p_url)
    {
        // try use default browser [registry: HKEY_CURRENT_USER\Software\Classes\http\shell\open\command]
        try
        {
            string keyValue = Microsoft.Win32.Registry.GetValue(@"HKEY_CURRENT_USER\Software\Classes\http\shell\open\command", "", null) as string;
            if (string.IsNullOrEmpty(keyValue) == false)
            {
                string browserPath = keyValue.Replace("%1", p_url);
                System.Diagnostics.Process.Start(browserPath);
                return true;
            }
        }
        catch { }

        // try open browser as default command
        try
        {
            System.Diagnostics.Process.Start(p_url); //browserPath, argUrl);
            return true;
        }
        catch { }

        // try open through 'explorer.exe'
        try
        {
            string browserPath = GetWindowsPath("explorer.exe");
            string argUrl = "\"" + p_url + "\"";

            System.Diagnostics.Process.Start(browserPath, argUrl);
            return true;
        }
        catch { }

        // return false, all failed
        return false;
    } 
```

### 和助手功能：

```
internal static string GetWindowsPath(string p_fileName)
    {
        string path = null;
        string sysdir;

        for (int i = 0; i < 3; i++)
        {
            try
            {
                if (i == 0)
                {
                    path = Environment.GetEnvironmentVariable("SystemRoot");
                }
                else if (i == 1)
                {
                    path = Environment.GetEnvironmentVariable("windir");
                }
                else if (i == 2)
                {
                    sysdir = Environment.GetFolderPath(Environment.SpecialFolder.System);
                    path = System.IO.Directory.GetParent(sysdir).FullName;
                }

                if (path != null)
                {
                    path = System.IO.Path.Combine(path, p_fileName);
                    if (System.IO.File.Exists(path) == true)
                    {
                        return path;
                    }
                }
            }
            catch { }
        }

        // not found
        return null;
    } 
```

希望我有所帮助。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-01-28T04:39:38.970

老派的方式；）

```
public static void openit(string x) {
   System.Diagnostics.Process.Start("cmd", "/C start" + " " + x); 
} 
```

采用：`openit("www.google.com");`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-10-26T11:56:53.953

由于我今天有类似的问题，因此我有解决方案。

假设您想从以管理员权限运行的应用程序打开[http://google.com ：](http://google.com)

```
ProcessStartInfo startInfo = new ProcessStartInfo("iexplore.exe", "http://www.google.com/");
Process.Start(startInfo); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-10T19:32:09.190

```
 string target= "http://www.google.com";
try
{
    System.Diagnostics.Process.Start(target);
}
catch (System.ComponentModel.Win32Exception noBrowser)
{
    if (noBrowser.ErrorCode==-2147467259)
    MessageBox.Show(noBrowser.Message);
}
catch (System.Exception other)
{
    MessageBox.Show(other.Message);
} 
```

# .net - LINQ to SQL：自引用实体 - ParentID/ChildID 关联

> ID：502206
> 
> 赞同：3
> 
> 时间：2009-02-02T04:40:02.747
> 
> 标签：.net, linq-to-sql

我的 Linq to SQL dbml 中有一个任务实体。它使用 ID 和 ParentID 列进行自引用。我有一个将两个 ID 关联在一起的关联。

似乎在智能感知中一切正常。它会让我输入 Task.Parent.ID 甚至 Task.Parent.Parent.ID 等。但是，它给了我“未设置对象实例的对象引用”。错误。

我所有的其他关联都可以与我的其他实体一起正常工作。只有自引用实体错误。

我需要做一些特别的事情来让它工作还是我最好添加第二个 Task 实体并将其命名为 ParentTask 并以这种方式建立关联？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T05:09:39.177

如果您尝试获取实体的父级，而实际上它没有父级，则会发生错误。你指定的一切都很好，我已经多次实施类似的关系。

你提到了一个例外，但你没有提到它何时发生。在更新期间？也许有 FK 违规？在插入期间？还是只是一个查询？

Task.Parent.Parent.Parent.Parent 不是你可以无限做的事情。当然它会编译，代码不知道有数据支持该语句。但在运行时，每个 .Parent 调用都需要由等效的 ParentID 列匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T04:49:26.097

在 LINQ to SQL 中正确建模单表关系没有任何问题。我运行了一个快速测试用例来重现您所描述的内容并且效果很好（Item.Parent.ID、Item.Parent.Parent.Parent.Parent.ID 等）

设置 SQL 探查器并查看 LINQ 提供程序尝试生成的 SQL。还可以查看designer.cs 文件中的实体类，看看Task 上的Parent 属性的getter 是否看起来很奇怪。

# java - 针对 Java 应用程序中的恶意代码的沙盒

> ID：502218
> 
> 赞同：96
> 
> 时间：2009-02-02T04:50:18.200
> 
> 标签：java, plugins, sandbox

在允许用户提交自己的代码以由服务器运行的模拟服务器环境中，任何用户提交的代码在沙箱中运行显然是有利的，这与 Applet 在浏览器中的情况不同。我希望能够利用 JVM 本身，而不是添加另一个 VM 层来隔离这些提交的组件。

使用现有的 Java 沙箱模型似乎可以实现这种限制，但是是否有一种动态方法可以仅针对正在运行的应用程序的用户提交部分启用该限制？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-02-02T06:49:38.380

1.  在自己的线程中运行不受信任的代码。例如，这可以防止无限循环等问题，并使未来的步骤更容易。让主线程等待线程完成，如果时间过长，使用 Thread.stop 将其终止。Thread.stop 已被弃用，但由于不受信任的代码不应访问任何资源，因此将其杀死是安全的。

2.  在该线程上设置一个[SecurityManager 。](http://java.sun.com/javase/6/docs/api/java/lang/SecurityManager.html)创建一个 SecurityManager 的子类，它覆盖[checkPermission(Permission perm)](http://java.sun.com/javase/6/docs/api/java/lang/SecurityManager.html#checkPermission(java.security.Permission))以简单地为除少数几个权限之外的所有权限抛出[SecurityException 。](http://java.sun.com/javase/6/docs/api/java/lang/SecurityException.html)这里有一个方法列表和它们所需的权限：[Java ^(TM) 6 SDK](http://java.sun.com/javase/6/docs/technotes/guides/security/permissions.html)中的权限。

3.  使用自定义 ClassLoader 加载不受信任的代码。您的类加载器将被不受信任的代码使用的所有类调用，因此您可以执行诸如禁用对单个 JDK 类的访问之类的操作。要做的事情是有一个允许的 JDK 类的白名单。

4.  您可能希望在单独的 JVM 中运行不受信任的代码。虽然前面的步骤可以使代码安全，但隔离代码仍然可以做一件烦人的事情：尽可能多地分配内存，这会导致主应用程序的可见占用空间增加。

[JSR 121：应用程序隔离 API 规范](http://jcp.org/en/jsr/detail?id=121)旨在解决这个问题，但遗憾的是它还没有实现。

这是一个非常详细的话题，我主要是在脑海中写下这一切。

但无论如何，一些不完美的，使用风险自负，可能有错误（伪）代码：

*类加载器*

```
class MyClassLoader extends ClassLoader {
  @Override
  public Class<?> loadClass(String name) throws ClassNotFoundException {
    if (name is white-listed JDK class) return super.loadClass(name);
    return findClass(name);
  }
  @Override
  public Class findClass(String name) {
    byte[] b = loadClassData(name);
    return defineClass(name, b, 0, b.length);
  }
  private byte[] loadClassData(String name) {
    // load the untrusted class data here
  }
} 
```

*安全管理器*

```
class MySecurityManager extends SecurityManager {
  private Object secret;
  public MySecurityManager(Object pass) { secret = pass; }
  private void disable(Object pass) {
    if (pass == secret) secret = null;
  }
  // ... override checkXXX method(s) here.
  // Always allow them to succeed when secret==null
} 
```

*线*

```
class MyIsolatedThread extends Thread {
  private Object pass = new Object();
  private MyClassLoader loader = new MyClassLoader();
  private MySecurityManager sm = new MySecurityManager(pass);
  public void run() {
    SecurityManager old = System.getSecurityManager();
    System.setSecurityManager(sm);
    runUntrustedCode();
    sm.disable(pass);
    System.setSecurityManager(old);
  }
  private void runUntrustedCode() {
    try {
      // run the custom class's main method for example:
      loader.loadClass("customclassname")
        .getMethod("main", String[].class)
        .invoke(null, new Object[]{...});
    } catch (Throwable t) {}
  }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-02T06:24:53.330

显然，这样的方案引发了各种安全问题。Java 有一个严格的安全框架，但它并不是微不足道的。不应该忽视搞砸它并让非特权用户访问重要系统组件的可能性。

除了这个警告之外，如果您以源代码的形式获取用户输入，您需要做的第一件事就是将其编译为 Java 字节码。AFIAK，这不能在本地完成，因此您需要对 javac 进行系统调用，并将源代码编译为磁盘上的字节码。[这是](http://www.devdaily.com/java/edu/pj/pj010016/pj010016.shtml)一个可以用作此起点的教程。 **编辑**：正如我在评论中了解到的，您实际上可以使用[javax.tools.JavaCompiler从源代码本地编译 Java 代码](http://java.sun.com/javase/6/docs/api/javax/tools/JavaCompiler.html)

一旦有了 JVM 字节码，就可以使用[ClassLoader 的](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassLoader.html) [defineClass](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassLoader.html#defineClass(java.lang.String,%20byte[],%20int,%20int,%20java.security.ProtectionDomain))函数将其加载到 JVM 中。要为这个加载的类设置一个安全上下文，你需要指定一个[ProtectionDomain](http://java.sun.com/j2se/1.4.2/docs/api/java/security/ProtectionDomain.html)。[ProtectionDomain](http://java.sun.com/j2se/1.4.2/docs/api/java/security/ProtectionDomain.html)的最小构造函数需要 CodeSource 和[PermissionCollection](http://java.sun.com/j2se/1.4.2/docs/api/java/security/PermissionCollection.html)。PermissionCollection 是您在这里主要使用的对象 - 您可以使用它来指定加载的类具有的确切权限。这些权限最终应该由 JVM 的[AccessController](http://java.sun.com/javase/6/docs/api/java/security/AccessController.html)强制执行。

这里有很多可能的错误点，在你实施任何东西之前，你应该非常小心地完全理解一切。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-11-17T21:13:07.513

**[Java-Sandbox](http://sourceforge.net/projects/dw-sandbox/)**是一个用于执行具有有限权限的 Java 代码的库。

它可用于仅允许访问一组列入白名单的类和资源。它似乎无法限制对单个方法的访问。它使用带有自定义类加载器和安全管理器的系统来实现这一点。

我没有使用过它，但它看起来设计得很好并且记录得很好。

@waqas 给出了一个非常有趣的答案，解释了如何实现自己。但是将此类安全关键和复杂的代码留给专家会更安全。

**注意：**该项目自 2013 年以来没有更新，创建者将其描述为“实验性”。它的主页已经消失，但 Source Forge 条目仍然存在。

改编自项目网站的示例代码：

```
SandboxService sandboxService = SandboxServiceImpl.getInstance();

// Configure context 
SandboxContext context = new SandboxContext();
context.addClassForApplicationLoader(getClass().getName());
context.addClassPermission(AccessType.PERMIT, "java.lang.System");

// Whithout this line we get a SandboxException when touching System.out
context.addClassPermission(AccessType.PERMIT, "java.io.PrintStream");

String someValue = "Input value";

class TestEnvironment implements SandboxedEnvironment<String> {
    @Override
    public String execute() throws Exception {
        // This is untrusted code
        System.out.println(someValue);
        return "Output value";
    }
};

// Run code in sandbox. Pass arguments to generated constructor in TestEnvironment.
SandboxedCallResult<String> result = sandboxService.runSandboxed(TestEnvironment.class, 
    context, this, someValue);

System.out.println(result.get()); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-08-26T02:32:08.690

要解决已接受答案中的问题，即自定义`SecurityManager`将应用于 JVM 中的所有线程，而不是基于每个线程，您可以创建一个`SecurityManager`可以为特定线程启用/禁用的自定义，如下所示：

```
import java.security.Permission;

public class SelectiveSecurityManager extends SecurityManager {

  private static final ToggleSecurityManagerPermission TOGGLE_PERMISSION = new ToggleSecurityManagerPermission();

  ThreadLocal<Boolean> enabledFlag = null;

  public SelectiveSecurityManager(final boolean enabledByDefault) {

    enabledFlag = new ThreadLocal<Boolean>() {

      @Override
      protected Boolean initialValue() {
        return enabledByDefault;
      }

      @Override
      public void set(Boolean value) {
        SecurityManager securityManager = System.getSecurityManager();
        if (securityManager != null) {
          securityManager.checkPermission(TOGGLE_PERMISSION);
        }
        super.set(value);
      }
    };
  }

  @Override
  public void checkPermission(Permission permission) {
    if (shouldCheck(permission)) {
      super.checkPermission(permission);
    }
  }

  @Override
  public void checkPermission(Permission permission, Object context) {
    if (shouldCheck(permission)) {
      super.checkPermission(permission, context);
    }
  }

  private boolean shouldCheck(Permission permission) {
    return isEnabled() || permission instanceof ToggleSecurityManagerPermission;
  }

  public void enable() {
    enabledFlag.set(true);
  }

  public void disable() {
    enabledFlag.set(false);
  }

  public boolean isEnabled() {
    return enabledFlag.get();
  }

} 
```

`ToggleSecurirtyManagerPermission`只是一个简单的实现，`java.security.Permission`以确保只有授权代码才能启用/禁用安全管理器。它看起来像这样：

```
import java.security.Permission;

public class ToggleSecurityManagerPermission extends Permission {

  private static final long serialVersionUID = 4812713037565136922L;
  private static final String NAME = "ToggleSecurityManagerPermission";

  public ToggleSecurityManagerPermission() {
    super(NAME);
  }

  @Override
  public boolean implies(Permission permission) {
    return this.equals(permission);
  }

  @Override
  public boolean equals(Object obj) {
    if (obj instanceof ToggleSecurityManagerPermission) {
      return true;
    }
    return false;
  }

  @Override
  public int hashCode() {
    return NAME.hashCode();
  }

  @Override
  public String getActions() {
    return "";
  }

} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-06-14T23:07:19.777

这是该问题的线程安全解决方案：

[https://svn.code.sf.net/p/loggifier/code/trunk/de.unkrig.commons.lang/src/de/unkrig/commons/lang/security/Sandbox.java](https://svn.code.sf.net/p/loggifier/code/trunk/de.unkrig.commons.lang/src/de/unkrig/commons/lang/security/Sandbox.java)

```
package de.unkrig.commons.lang.security;

import java.security.AccessControlContext;
import java.security.Permission;
import java.security.Permissions;
import java.security.ProtectionDomain;
import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import java.util.WeakHashMap;

import de.unkrig.commons.nullanalysis.Nullable;

/**
 * This class establishes a security manager that confines the permissions for code executed through specific classes,
 * which may be specified by class, class name and/or class loader.
 * <p>
 * To 'execute through a class' means that the execution stack includes the class. E.g., if a method of class {@code A}
 * invokes a method of class {@code B}, which then invokes a method of class {@code C}, and all three classes were
 * previously {@link #confine(Class, Permissions) confined}, then for all actions that are executed by class {@code C}
 * the <i>intersection</i> of the three {@link Permissions} apply.
 * <p>
 * Once the permissions for a class, class name or class loader are confined, they cannot be changed; this prevents any
 * attempts (e.g. of the confined class itself) to release the confinement.
 * <p>
 * Code example:
 * <pre>
 *  Runnable unprivileged = new Runnable() {
 *      public void run() {
 *          System.getProperty("user.dir");
 *      }
 *  };
 *
 *  // Run without confinement.
 *  unprivileged.run(); // Works fine.
 *
 *  // Set the most strict permissions.
 *  Sandbox.confine(unprivileged.getClass(), new Permissions());
 *  unprivileged.run(); // Throws a SecurityException.
 *
 *  // Attempt to change the permissions.
 *  {
 *      Permissions permissions = new Permissions();
 *      permissions.add(new AllPermission());
 *      Sandbox.confine(unprivileged.getClass(), permissions); // Throws a SecurityException.
 *  }
 *  unprivileged.run();
 * </pre>
 */
public final
class Sandbox {

    private Sandbox() {}

    private static final Map<Class<?>, AccessControlContext>
    CHECKED_CLASSES = Collections.synchronizedMap(new WeakHashMap<Class<?>, AccessControlContext>());

    private static final Map<String, AccessControlContext>
    CHECKED_CLASS_NAMES = Collections.synchronizedMap(new HashMap<String, AccessControlContext>());

    private static final Map<ClassLoader, AccessControlContext>
    CHECKED_CLASS_LOADERS = Collections.synchronizedMap(new WeakHashMap<ClassLoader, AccessControlContext>());

    static {

        // Install our custom security manager.
        if (System.getSecurityManager() != null) {
            throw new ExceptionInInitializerError("There's already a security manager set");
        }
        System.setSecurityManager(new SecurityManager() {

            @Override public void
            checkPermission(@Nullable Permission perm) {
                assert perm != null;

                for (Class<?> clasS : this.getClassContext()) {

                    // Check if an ACC was set for the class.
                    {
                        AccessControlContext acc = Sandbox.CHECKED_CLASSES.get(clasS);
                        if (acc != null) acc.checkPermission(perm);
                    }

                    // Check if an ACC was set for the class name.
                    {
                        AccessControlContext acc = Sandbox.CHECKED_CLASS_NAMES.get(clasS.getName());
                        if (acc != null) acc.checkPermission(perm);
                    }

                    // Check if an ACC was set for the class loader.
                    {
                        AccessControlContext acc = Sandbox.CHECKED_CLASS_LOADERS.get(clasS.getClassLoader());
                        if (acc != null) acc.checkPermission(perm);
                    }
                }
            }
        });
    }

    // --------------------------

    /**
     * All future actions that are executed through the given {@code clasS} will be checked against the given {@code
     * accessControlContext}.
     *
     * @throws SecurityException Permissions are already confined for the {@code clasS}
     */
    public static void
    confine(Class<?> clasS, AccessControlContext accessControlContext) {

        if (Sandbox.CHECKED_CLASSES.containsKey(clasS)) {
            throw new SecurityException("Attempt to change the access control context for '" + clasS + "'");
        }

        Sandbox.CHECKED_CLASSES.put(clasS, accessControlContext);
    }

    /**
     * All future actions that are executed through the given {@code clasS} will be checked against the given {@code
     * protectionDomain}.
     *
     * @throws SecurityException Permissions are already confined for the {@code clasS}
     */
    public static void
    confine(Class<?> clasS, ProtectionDomain protectionDomain) {
        Sandbox.confine(
            clasS,
            new AccessControlContext(new ProtectionDomain[] { protectionDomain })
        );
    }

    /**
     * All future actions that are executed through the given {@code clasS} will be checked against the given {@code
     * permissions}.
     *
     * @throws SecurityException Permissions are already confined for the {@code clasS}
     */
    public static void
    confine(Class<?> clasS, Permissions permissions) {
        Sandbox.confine(clasS, new ProtectionDomain(null, permissions));
    }

    // Code for 'CHECKED_CLASS_NAMES' and 'CHECKED_CLASS_LOADERS' omitted here.

} 
```

请给出意见！

铜

阿诺

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-12T23:51:06.373

好吧，现在给出任何建议或解决方案已经很晚了，但我仍然面临着类似的问题，更多的是面向研究的。基本上，我试图为电子学习平台中的 Java 课程的编程作业提供规定和自动评估。

1.  一种方法可能是，为每个学生创建一个单独的虚拟机（不是 JVM），但实际的虚拟机具有最低配置可能的操作系统。
2.  根据您的编程语言安装 JRE for Java 或库，无论您希望学生在这些机器上编译和执行哪种。

我知道这听起来很复杂而且任务很多，但是 Oracle Virtual Box 已经提供了 Java API 来动态创建或克隆虚拟机。 [https://www.virtualbox.org/sdkref/index.html](https://www.virtualbox.org/sdkref/index.html)（注意，即使 VMware 也提供 API 来做同样的事情）

对于最小尺寸和配置的 Linux 发行版，您可以在这里参考[http://www.slitaz.org/en/](http://www.slitaz.org/en/)，

所以现在如果学生搞砸了或试图这样做，可能是内存或文件系统或网络、套接字，他可能会损坏他自己的虚拟机。

在这些 VM 内部，您还可以提供额外的安全性，例如 Java 的 Sandbox（安全管理器）或在 Linux 上创建用户特定帐户，从而限制访问。

希望这可以帮助 ！！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T05:44:16.780

您可能需要使用自定义[SecurityManger](http://java.sun.com/javase/6/docs/api/java/lang/SecurityManager.html)和/或[AccessController](http://java.sun.com/javase/6/docs/api/java/security/AccessController.html)。有关详细信息，请参阅Sun的[Java 安全架构](http://java.sun.com/javase/6/docs/technotes/guides/security/spec/security-specTOC.fm.html)和[其他安全文档。](http://java.sun.com/javase/6/docs/technotes/guides/security/index.html)

# architecture - 编写概念证明 (PoC) 应用程序的最佳方式是什么？

> ID：502226
> 
> 赞同：6
> 
> 时间：2009-02-02T05:03:35.303
> 
> 标签：architecture, modeling

我目前正在做一个项目，我需要编写一些概念验证应用程序。我以前写过 PoC 应用程序，但它们真的很小，而且还没有很多层，因为我现在写的应用程序有：

*   表单层 - 与数据层对话。
*   数据层 - 与数据库和互操作层对话。
*   互操作层 - 与 COM 对象对话。
*   COM 对象

编写程序以显示我可以从 A 到 B 以及所需的过程的最佳方法是什么，而无需花费大量时间来编写 PoC。

我的脑海中已经有了关于应该如何组合在一起的想法，但是我在向我的队友展示我的意思时遇到了一些麻烦。

任何人都可以在编写 PoC 时推荐任何提示/技巧吗？或者是否有更好的方法来解释我的意思，而不是编写代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T05:33:52.857

我同意其他关于制作原型的回应。确保原型保持原样的一种方法是使用绝对不会在最终产品中使用的语言或工具链，从而强制将其重写为生产质量。我用过的一些想法：

*   `netcat`使用 shell 脚本（以及很多`bash`）编写一个预先编写好的网络客户端
*   用 Python、Ruby 或其他您熟悉的 RAD 语言编写服务器
*   使用比你的生产技术更简单的技术（通过静态文件而不是 TCP 进行通信，或者使用非常简单的 RPC 机制而不是中间件产品）
*   使用具有不兼容许可的软件，因此无法发布产品（GPL 对此有好处，对于任何实际分发的东西）。
*   将 Web 表单编写为静态 HTML 页面（没有样式或任何东西，丑陋至极）
*   如果可能的话，用本地对象交互替换任何远程交互（数据库、网络），挥手说“这两个步骤真的会分开发生”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T05:06:34.580

以我的经验，让这一切快速发展的最好方法是在一个（或尽可能少的）层中尽可能快地编写代码，这真是令人讨厌和令人心碎。然后，一旦您的代码栏正常工作，就从列表中的一层开始并分开。重复，直到你有你想要的层。

这还有一个额外的好处，那就是能够拉出一个特定的位并让你的同事假装它被分开了。如果他们能做到这一点，你就不必花时间实际去做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T05:07:02.067

作为概念证明 - 我会单独处理每一位，并为其余部分编写假包装器。制作原型和概念验证的危险之一是，如果它们足够接近功能性，它们往往最终会成为最终产品。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T05:13:34.770

对于概念应用程序的原型验证，有时使用非常适合快速应用程序开发的编程语言会很有用。

Python 就是一个很好的例子。您有一个巨大的框架来利用和创建您在帖子中提到的各个抽象层，同时仍将概念证明应用程序代码大小保持在最低限度。

工作应用胜于雄辩，因此如果您可以快速制作一个原型供您的团队查看和使用，这将有助于使不倒翁适合他们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T05:41:58.783

尽可能多地使用 Python 等高生产力语言在单元测试框架中编写。

Python 单元测试使用反射来推断事物是测试并捕获正常的断言。总而言之，它只需要很少的努力即可开始 - 我以这种方式使用 Python 来制定网络协议以及使用 Saxon jar 包装命令行 XSLT 转换。

通过以测试驱动的方式使用片段，您将防止您的 PoC 应用程序变得过于纠缠，您将为未来实施中的测试奠定基础。

即使您致力于主应用程序的特定语言，也请考虑为任何帮助程序提供更轻量级的东西，例如测试网络协议的简单服务器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T05:07:56.730

最初设置可能需要更长的时间，但如果您可以立即使用依赖注入/IoC 框架，那么更换各种实现会变得容易得多。Spring/Spring.NET 极大地帮助了我。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T05:08:58.630

我发现画图和图表总是能帮助我理解我的观点。当我遇到问题时，它还可以帮助我自己思考问题。

你可以让你的队友更好地理解你在说什么，只需向他们展示一些你的想法的图纸。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T07:16:36.160

I once did a similar project using Delphi 7 and MIDAS. Implemented the Interop layer (in-process AppServer in my case) as dll files allowing the project to access various data sources (e.g. SQL, Access, Excel and COM objects, etc).

# asp.net - Orkut 的 URL 编写方法

> ID：502228
> 
> 赞同：1
> 
> 时间：2009-02-02T05:05:23.083
> 
> 标签：asp.net, friendly-url

我对 orkut 的新 URL 编写方法有疑问。

早些时候主页就像

[http://www.orkut.com/Home.aspx](http://www.orkut.com/Home.aspx)

现在它改为

[http://www.orkut.co.in/Main#Home.aspx](http://www.orkut.co.in/Main#Home.aspx)

“#”的意义是什么？为什么它在那里，为什么他们使用它？

不是“#”用于在锚标记中使用 name="blah" 导航到页面的特定部分吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T01:17:32.950

URL 片段 (#name) 历史上用于页内锚点，因此您可以标记一个部分并让页面在链接到它时滚动正确的内容。

但是，由于 JavaScript 代码也可以看到 URL 片段，因此许多黑客已经变得流行，允许您将同一页面用于多种目的。对于浏览器历史记录而言，它可能比做出任何类型的表示决策更有用，但这两种技术都很常见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T08:07:49.020

他们可能在他们的 Javascript 中使用它。通常 ajax 重页使用 # 以便书签和浏览器后退按钮仍然有效。

# php - PHP/mySQL 中的类似 Google 的搜索引擎

> ID：502238
> 
> 赞同：23
> 
> 时间：2009-02-02T05:10:04.463
> 
> 标签：php, mysql, search-engine

我们拥有 OCRed 数千页的报纸文章。每页的报纸、期号、日期、页码和 OCRed 文本都已放入 mySQL 数据库。

我们现在想用 PHP 构建一个类似 Google 的搜索引擎来查找给定查询的页面。它必须很快，任何搜索都不会超过一秒钟。

我们应该怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-02T05:50:43.367

你也可以试试[SphinxSearch](http://www.sphinxsearch.com/)。Craigslist 使用 sphinx，它可以连接到 mysql 和 postgresql。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-02T05:23:23.923

有一些有趣的搜索引擎供您查看。我不知道您所说的“Google like”是什么意思，所以我将忽略这部分。

*   看一下[Lucene](http://lucene.apache.org)引擎。原版是高性能的，但是用 Java 编写的。有一个[Lucene 到 PHP 的端口](http://framework.zend.com/manual/en/zend.search.lucene.html)（已经在别处提到过），但它太慢了。
*   认真看看[Xapian 项目](http://xapian.org/)。它很快。它是用 C++ 编写的，因此您很可能必须为您的目标服务器构建它，但具有 PHP 绑定。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-02T08:44:26.747

如果 MySQL 的全文搜索每次查询需要 20 秒，那么您要么配置错误，要么运行在动力不足的硬件上——一些*大型*网站成功地使用了普通的旧 MyISAM 搜索。

但是，我投票支持[Solr](http://lucene.apache.org/solr)。它基于 Lucene，因此您可以获得该最佳产品的所有丰富性和性能，但使用 RESTful API，使其非常容易[从 PHP](http://wiki.apache.org/solr/SolPHP)中实现。甚至还有[一篇 dW 文章](http://www.ibm.com/developerworks/library/os-php-apachesolr/index.html)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-18T16:08:13.063

您可以将所有文件放在 Google Docs 上，然后将结果抓取到您自己的网站上。

我担心的是 OCR 准确性仍然是一个问题，因此搜索要求的一个考虑因素是执行“模糊”搜索的能力。模糊的意思是当 OCR 错误地将“帽子”一词识别为“热”时，搜索引擎将足够聪明，可以返回相似但不准确的结果。在 Oracle 中，有一个名为 UTL_MATCH 的函数可以比较两个字符串之间的相似性：http: [//docs.oracle.com/cd/E11882_01/appdev.112/e25788/u_match.htm#ARPLS352](http://docs.oracle.com/cd/E11882_01/appdev.112/e25788/u_match.htm#ARPLS352)

像这样的功能会很有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T05:24:48.210

您的情况表明，您想自己动手；一般搜索引擎的良好起点包括：

*   [互联网应用软件工程/搜索](http://philip.greenspun.com/seia/search)
*   一些人[对大型超文本 Web 搜索引擎的剖析](http://infolab.stanford.edu/~backrub/google.html)
*   如果您的文档结构暗示了相互链接的功能，您可以在排名系统中利用它，请参阅[PageRank](http://en.wikipedia.org/wiki/Pagerank)

如果您想使用现成的解决方案：

*   如果您的应用程序是基于网络的，并且可用于公共互联网，那么您真的必须想出一个很好的理由*不*使用[Google Site Search](http://www.google.com/sitesearch/)
*   [Lucene 有一个 PHP 端口](http://framework.zend.com/manual/en/zend.search.lucene.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T05:33:51.203

为什么不试试 Google Search Appliance 或 Google Enterprise 之类的东西？它会产生相关成本，但它会让您免于重新发明轮子并为您提供“类似谷歌”的搜索。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T05:16:52.343

检查 PHP 的这个[Lucene](http://lucene.apache.org)端口：

*   [`Zend_Search_Lucene`](http://framework.zend.com/manual/en/zend.search.lucene.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T05:28:22.413

您可能需要检查[Sphider](http://www.sphider.eu/)。根据我的经验，它非常快并且会自动进行索引。它也是开源的，因此您可以获取代码并根据需要对其进行修改。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-28T04:32:47.693

sqlite 具有相当不错的全文搜索能力（查找 sqlite FTS 3/4 - 它出奇的好）

如果你想要一个简单的 PHP diy 方法索引使用由被索引的术语的哈希分割的大量小文件可以很好地工作并且即使在 php 中搜索也可以非常快，如果你小心设计它。（这个想法是对一个术语进行搜索，只需要搜索一个非常小的文件，其中包含与哈希和记录 ID 匹配的术语 - 如果你想节省 HD 空间，你可以使用位数组切片来表示记录 ID）.. 但是做对全文的每个单词的索引在 php 中会很慢。那部分应该在 c 中完成

对于“模糊”搜索，可能会考虑使用变音位哈希。

对于预先构建的全文工具，请查看以下内容：sqlite FTS 3/4（sqlite 具有非常好的全文搜索功能！）、Sphinx、kinoSearch（kinoSearch 有点像 Lucene，但后端是 c，带有一个非常简单的 perl 包装器 -还有cLucene，但我认为那仍然是pre-alpha）

Java Lucene（或任何基于 Java 的）可能需要留出大量内存来运行 JVM——所以如果你有预算的话，可能不是那么好

# silverlight - 如何在带有对象标签的 HTML 页面上包含 Silverlight？

> ID：502245
> 
> 赞同：0
> 
> 时间：2009-02-02T05:13:57.000
> 
> 标签：silverlight

我想在 HTML 页面中包含一个 silverlight 应用程序（.xap 文件）。

使用这些[MSDN 指令](http://msdn.microsoft.com/en-us/library/cc189089(VS.95).aspx)，我创建了这个 HTML 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="content-type" content="text/html;charset=utf-8"/>
        <title>Test Silverlight Page</title>
    </head>

    <body>

<object id="SilverlightPlugin1" width="300" height="300"
    data="data:application/x-silverlight-2," 
    type="application/x-silverlight-2" >
    <param name="source" value="MultiplePages.xap"/>

    <!-- Display installation image. -->
    <a href="http://go.microsoft.com/fwlink/?LinkID=124807" 
        style="text-decoration: none;">
        <img src="http://go.microsoft.com/fwlink/?LinkId=108181" 
            alt="Get Microsoft Silverlight" 
            style="border-style: none"/>
    </a>
</object>
    </body>
</html> 
```

但是当我在 Firefox 中查看它时，我会弹出一个窗口，询问我是否要运行 .xap 文件：

[替代文字 http://tanguay.info/web/external/silverlightPopup.png](http://tanguay.info/web/external/silverlightPopup.png)

我需要使用什么 HTML/Object 代码才能使 Silverlight 应用程序简单地在浏览器内运行，而不是让浏览器要求执行它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T05:28:18.343

服务器是否为 XAP 扩展注册了 MIME 类型的 application/x-silverlight-app？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T07:40:17.950

您不是通过开发 Web 服务器运行该页面，而是通过您的文件系统运行该页面。如果您从开发 Web 服务器或 IIS 运行该页面，它应该可以正常运行。

你可以从浏览器中的 URL 看到：不是 http:// 而是 file://

# .net - 绑定到 WPF 中的方法？

> ID：502250
> 
> 赞同：91
> 
> 时间：2009-02-02T05:16:27.133
> 
> 标签：.net, wpf, data-binding, xaml

在这种情况下，如何在 WPF 中绑定到对象方法？

```
public class RootObject
{
    public string Name { get; }

    public ObservableCollection<ChildObject> GetChildren() {...}
}

public class ChildObject
{
    public string Name { get; }
} 
```

XAML：

```
<TreeView ItemsSource="some list of RootObjects">
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="{x:Type data:RootObject}" 
                                  ItemsSource="???">
            <TextBlock Text="{Binding Path=Name}" />
        </HierarchicalDataTemplate>
        <HierarchicalDataTemplate DataType="{x:Type data:ChildObject}">
            <TextBlock Text="{Binding Path=Name}" />
        </HierarchicalDataTemplate>
    </TreeView.Resources>
</TreeView> 
```

在这里，我想绑定到`GetChildren`每个`RootObject`树上的方法。

**编辑**绑定到一个`ObjectDataProvider`似乎不起作用，因为我绑定到一个项目列表，并且`ObjectDataProvider`需要一个静态方法，或者它创建它自己的实例并使用它。

例如，使用马特的回答我得到：

> System.Windows.Data 错误：33：ObjectDataProvider 无法创建对象；类型='Ro​​otObject'; Error='构造函数的参数错误。'
> 
> System.Windows.Data 错误：34：ObjectDataProvider：尝试调用类型方法失败；方法='GetChildren'; 类型='Ro​​otObject'; 'Error='指定的成员不能在目标上调用。' TargetException:'System.Reflection.TargetException: 非静态方法需要一个目标。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-10T08:39:15.940

另一种可能对您有用的方法是创建一个[`IValueConverter`](http://msdn.microsoft.com/en-us/library/ms613620.aspx)将方法名称作为参数的自定义，以便像这样使用它：

```
ItemsSource="{Binding 
    Converter={StaticResource MethodToValueConverter},
    ConverterParameter='GetChildren'}" 
```

该转换器将使用反射找到并调用该方法。这要求该方法没有任何参数。

以下是此类转换器源的示例：

```
public sealed class MethodToValueConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var methodName = parameter as string;
        if (value==null || methodName==null)
            return value;
        var methodInfo = value.GetType().GetMethod(methodName, new Type[0]);
        if (methodInfo==null)
            return value;
        return methodInfo.Invoke(value, new object[0]);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotSupportedException("MethodToValueConverter can only be used for one way conversion.");
    }
} 
```

以及相应的单元测试：

```
[Test]
public void Convert()
{
    var converter = new MethodToValueConverter();
    Assert.AreEqual("1234", converter.Convert(1234, typeof(string), "ToString", null));
    Assert.AreEqual("ABCD", converter.Convert(" ABCD ", typeof(string), "Trim", null));

    Assert.IsNull(converter.Convert(null, typeof(string), "ToString", null));

    Assert.AreEqual("Pineapple", converter.Convert("Pineapple", typeof(string), "InvalidMethodName", null));
} 
```

请注意，此转换器不强制执行该`targetType`参数。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-02T05:24:35.743

不确定它在您的场景中的效果如何，但您可以使用该[`MethodName`](http://msdn.microsoft.com/en-us/library/system.windows.data.objectdataprovider.methodname.aspx)属性`ObjectDataProvider`使其调用特定方法（使用您的`MethodParameters`属性的特定参数）来检索其数据。

这是直接取自 MSDN 页面的片段：

```
<Window.Resources>
    <ObjectDataProvider ObjectType="{x:Type local:TemperatureScale}"
        MethodName="ConvertTemp" x:Key="convertTemp">
        <ObjectDataProvider.MethodParameters>
            <system:Double>0</system:Double>
            <local:TempType>Celsius</local:TempType>
        </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>
</Window.Resources> 
```

这`ObjectDataProvider`就是调用类`ConvertTemp`实例的方法`TemperatureScale`，传递两个参数（`0`和`TempType.Celsius`）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-02T10:22:35.363

你必须绑定到方法吗？

你能绑定到一个getter是方法的属性吗？

```
public ObservableCollection<ChildObject> Children
{
   get
   {
      return GetChildren();
   }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-02T11:47:01.200

除非您可以添加一个属性来调用该方法（或创建一个添加该属性的包装类），否则我知道的唯一方法是使用 ValueConverter。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-10T08:37:41.170

您可以使用`System.ComponentModel`动态定义类型的属性（它们不是已编译元数据的一部分）。我在 WPF 中使用了这种方法来启用绑定到将其值存储在字段中的类型，因为无法绑定到字段。

和类型可以让你实现你想要的[`ICustomTypeDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.icustomtypedescriptor.aspx)。[`TypeDescriptionProvider`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typedescriptionprovider.aspx)根据[这篇文章](http://msdn.microsoft.com/en-us/magazine/cc163804.aspx)：

> `TypeDescriptionProvider`允许您编写一个单独的类来实现`ICustomTypeDescriptor`，然后将该类注册为其他类型的描述提供者。

我自己没有尝试过这种方法，但我希望它对您的情况有所帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-02T17:24:20.993

ObjectDataProvider 还有一个 ObjectInstance 属性，可以用来代替 ObjectType

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-22T16:48:42.893

要在 WPF 方案中绑定到对象的方法，可以绑定到返回委托的属性。

# java - java中的对象引用

> ID：502256
> 
> 赞同：4
> 
> 时间：2009-02-02T05:19:30.950
> 
> 标签：java, object

考虑这个简单的 servlet 示例：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response){
    Cookie cookie = request.getCookie();
    // do weird stuff with cookie object
} 
```

我总是想知道..如果您修改对象`cookie`，是通过对象还是通过引用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T05:38:57.103

> 如果您修改对象`cookie`，是通过对象还是通过引用？

取决于您在这里“修改”的意思。如果更改引用的值，即`cookie = someOtherObject`，则不会修改原始对象本身；只是你失去了对它的引用。但是，如果您更改对象的状态，例如通过调用`cookie.setSomeProperty(otherValue)`，那么您当然是在修改对象本身。

查看这些以前的相关问题以获取更多信息：

*   [Java，按值传递，引用变量](https://stackoverflow.com/questions/498747/java-pass-by-value-reference-variables)
*   [Java 是通过引用传递的吗？](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T05:25:10.797

Java 方法**通过 value 传递对象引用**。因此，如果您更改参考本身，例如

```
cookie = new MySpecialCookie(); 
```

方法调用者不会看到它。但是，当您对引用进行操作以更改对象包含的数据时：

```
cookie.setValue("foo"); 
```

那么这些更改将对调用者可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T05:55:02.143

在以下代码行中

```
Cookie cookie = request.getCookie(); /* (1) */ 
```

该`request.getCookie()`方法将引用传递给`Cookie`对象。

如果你以后改变`cookie by`做类似的事情

```
cookie = foo_bar(); /* (2) */ 
```

然后你正在改变内部参考。它绝不会影响您`cookie`在 (1) 中的原始对象

但是，如果您`cookie`通过执行以下操作进行更改

```
cookie.setFoo( bar ); /* assuming setFoo changes an instance variable of cookie */ 
```

然后您正在更改 (1) 中收到的原始对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-18T08:10:25.177

对象引用与对象不同。例如：

```
class Shape
{
    int x = 200;
}

class Shape1
{
    public static void main(String arg[])
    {
        Shape s = new Shape();   //creating object by using new operator
        System.out.println(s.x);
        Shape s1;                //creating object reference
        s1 = s;                  //assigning object to reference
        System.out.println(s1.x);
    }
} 
```

# sql-server - 有人可以解释一下下面的 SQL 查询是如何获得“n”最高薪水的吗

> ID：502258
> 
> 赞同：0
> 
> 时间：2009-02-02T05:22:55.717
> 
> 标签：sql-server, sql-server-2005

SELECT * FROM employee A WHERE 3=(select count(*) +1 from employee B where B.salary > A.salary)

这获得了第三高的薪水；有人可以解释这个查询背后的逻辑以及它是如何工作的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T05:33:05.447

换句话说，这个查询将是“选择有另外两个薪水更高的员工”。因此，结果是薪水第三高的员工。

请注意，如果有两个或更多人的薪水完全相同，则此查询可能会失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T05:38:05.047

这仅适用于不同的薪水：

对于每个员工，计算薪水大于员工薪水的行数。如果计数为 2 + 1，则返回员工

因此它将返回第三名员工。

我会用 SELECT TOP 1 FROM (SELECT TOP 3 * FROM Employee ORDER BY Salary DESC) a ORDER BY SALARY ASC 来做到这一点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T05:39:27.883

这就是所谓的相关子查询。您可以将其视为对外部查询中的所有记录进行循环，并且对于每一条记录，它都会在 where 子句中评估查询。（发生这种情况是因为 where 子句中的查询引用了外部查询的别名“A”）

因此，对于每个员工，获取薪水较高的员工数量。

通过使用 ROW_NUMBER 函数，您可能可以在 SQL 2005 和 2008 中更快地实现此逻辑。

例如。

```
WITH SalaryOrder AS
(
SELECT *
   , ROW_NUMBER() OVER(ORDER BY Salary DESC) SalaryRank
FROM employee
)
SELECT * 
FROM SalaryOrder
WHERE SalaryRank = 3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T05:45:06.547

只是用一个例子来说明这一点，假设工资如下；重复 B 的数据，

EmpA EmpB

5000 5000

3000 3000

2000 2000

1500 1500

1000 1000

500 500

在第一个解析中，A.Salary 是 5000，所以 B 中超过 5000 的工资计数都是 0。加一和它的 1。现在这将是最高工资。在您的示例中，A.Salary 为 2000，因此 B 中超过 2000 的所有薪水计数将为 2，加 1 为 3。加入 3=3 并选择值为 2000 的 A.Salary。

# performance - 在 MATLAB 中交换两个元素的性能

> ID：502261
> 
> 赞同：6
> 
> 时间：2009-02-02T05:24:10.987
> 
> 标签：performance, matlab

纯粹作为一个实验，我在 MATLAB 中编写排序函数，然后通过 MATLAB 分析器运行这些函数。我发现最令人困惑的方面与交换元素有关。

我发现交换矩阵中两个元素的“官方”方式

```
self.Data([i1, i2]) = self.Data([i2, i1]) 
```

运行速度比用四行代码慢得多：

```
e1 = self.Data(i1);
e2 = self.Data(i2);
self.Data(i1) = e2;
self.Data(i2) = e1; 
```

第二个示例所占用的总时间比第一个示例中的单行代码少**12 倍。**

有人会解释为什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T00:31:44.930

根据发布的建议，我进行了更多测试。当在分配的 LHS 和 RHS 中都引用相同的矩阵时，性能似乎会受到影响。

我的理论是 MATLAB 使用内部引用计数/写时复制机制，这会导致整个矩阵在被双方引用时在内部被复制。（这是一个猜测，因为我不知道 MATLAB 内部）。

这是调用函数 885548 次的结果。（这里的区别是 4 倍，而不是我最初发布的 12 倍。每个函数都有额外的函数包装开销，而在我最初的帖子中，我只是总结了各个行）。

```
交换 1：12.547 秒
 交换 2：14.301 秒
 交换 3：51.739 秒

```

这是代码：

```
 methods (Access = public)
     function swap(self, i1, i2)
        swap1(self, i1, i2);
        swap2(self, i1, i2);
        swap3(self, i1, i2);
        self.SwapCount = self.SwapCount + 1;
    end
 end

 methods (Access = private)
    %
    % swap1: stores values in temporary doubles
    %         This has the best performance
    %
    function swap1(self, i1, i2)
        e1 = self.Data(i1);
        e2 = self.Data(i2);
        self.Data(i1) = e2;
        self.Data(i2) = e1;
    end

    %
    % swap2: stores values in a temporary matrix
    %        Marginally slower than swap1
    %
    function swap2(self, i1, i2)
        m = self.Data([i1, i2]);
        self.Data([i2, i1]) = m;
    end

    %
    % swap3: does not use variables for storage.
    %        This has the worst performance
    %
    function swap3(self, i1, i2)
        self.Data([i1, i2]) = self.Data([i2, i1]);
    end

end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T05:31:17.963

在第一种（慢速）方法中，RHS 值是一个矩阵，所以我认为 MATLAB 在创建一个新矩阵来存储这两个元素时会导致性能损失。第二种（快速）方法通过直接使用元素来避免这种情况。

查看 MathWorks 上的“[提高性能的技巧](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/matlab_prog/f8-784135.html)”一文，了解改进 MATLAB 代码的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T14:41:21.127

你也可以这样做：

```
tmp = self.Data(i1);
self.Data(i1) = self.Data(i2);
self.Data(i2) = tmp; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T15:25:01.070

Zach 可能是正确的，因为可以制作矩阵的临时副本来执行第一个操作，尽管我会冒险猜测 MATLAB 中有一些内部优化试图避免这种情况。它可能是您正在使用的 MATLAB 版本的函数。我在版本 7.1.0.246（几年前）中尝试了你的两个案例，只看到大约 2-2.5 的速度差异。

这可能是通过所谓的“循环展开”提高速度的一个例子。在进行向量运算时，在内部代码中的某个级别可能存在一个 FOR 循环，该循环遍历您正在交换的索引。通过在第二个示例中执行标量操作，您可以避免循环产生的任何开销。注意这两个（有点傻）的例子：

```
vec = [1 2 3 4];

%Example 1:
for i = 1:4,
  vec(i) = vec(i)+1;
end;

%Example 2:
vec(1) = vec(1)+1;
vec(2) = vec(2)+1;
vec(3) = vec(3)+1;
vec(4) = vec(4)+1; 
```

诚然，简单地使用向量操作会容易得多，例如：

```
vec = vec+1; 
```

但以上示例仅用于说明目的。当我多次重复每个示例并对其计时时，示例 2 实际上比示例 1 快一些。对于具有已知数字（在示例中只有 4）的小循环，放弃循环实际上可能更有效。当然，在这个特定的例子中，上面给出的向量运算实际上是最快的。

我通常遵循这个规则：尝试一些不同的事情，然后为你的具体问题选择最快的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-16T16:44:36.227

这篇文章值得更新，因为 JIT 编译器现在是一个东西（[从 R2015b 开始](https://www.mathworks.com/products/matlab/matlab-execution-engine.html)），因此`timeit`（[从 R2013b 开始](https://uk.mathworks.com/help/matlab/ref/timeit.html)）更可靠的功能时序。

下面是一个用于在大型数组中交换元素的简短基准测试函数。我已经使用术语“直接交换”和“使用临时变量”来分别描述问题中的两种方法。

结果非常惊人，与使用临时变量相比，使用直接交换 2 个元素的性能越来越差。

[![阴谋](https://i.stack.imgur.com/NLmPR.png)](https://i.stack.imgur.com/NLmPR.png)

```
function benchie()
    % Variables for plotting, loop to increase size of the arrays
    M = 15; D = zeros(1,M); W = zeros(1,M);
    for n = 1:M; 
        N = 2^n;
        % Create some random array of length N, and random indices to swap
        v = rand(N,1);
        x = randi([1, N], N, 1);
        y = randi([1, N], N, 1);
        % Time the functions
        D(n) = timeit(@()direct);
        W(n) = timeit(@()withtemp);
    end
    % Plotting
    plot(2.^(1:M), D, 2.^(1:M), W);
    legend('direct', 'with temp')
    xlabel('number of elements'); ylabel('time (s)')

    function direct()
    % Direct swapping of two elements
        for k = 1:N
            v([x(k) y(k)]) = v([y(k)  x(k)]);
        end
    end

    function withtemp()
    % Using an intermediate temporary variable
        for k = 1:N
            tmp = v(y(k));
            v(y(k)) = v(x(k));
            v(x(k)) = tmp;
        end
    end
end 
```

# javascript - 为什么“onmouseover”事件使用“return true”来防止默认行为？

> ID：502271
> 
> 赞同：7
> 
> 时间：2009-02-02T05:29:12.193
> 
> 标签：javascript, events, onmouseover, event-handling

我一直在寻找这个，但没有任何解释。

对于 javascript 中的“onclick”和其他事件，返回***false***的事件处理程序意味着“阻止默认操作”。但是，“onmouseover”有一个例外。对于“onmouseover”，返回***true***表示“阻止默认操作”。

为什么“onmouseover”会有这样一个奇怪的例外情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T05:43:39.013

不要使用 return **false** / **true**来防止默认事件行为，而是使用事件对象的默认方法/属性：

```
elem.onmouseover = function(e) {
    if (!e) var e = window.event; // IE
    if(e.preventDefault) {
        e.preventDefault();
    } else {
        e.returnValue = false; // IE
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T10:52:13.977

据我所知，返回`true`以防止链接的 url 显示在状态栏中是 IE 特定的（错误）功能。试图理解为什么 IE 以它的方式做事往往是一个失败的原因 - 只是忍受它......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T05:48:26.773

谁知道为什么真的。就是这样：您从 onmouseover 返回 TRUE 以防止 url 出现在状态栏中，这确实是默认行为。

# c++ - 创建 Visual C++ 中缺少的 GUID 菜单项

> ID：502278
> 
> 赞同：0
> 
> 时间：2009-02-02T05:34:50.497
> 
> 标签：c++, visual-studio, visual-studio-2005, create-guid

我没有在菜单项 Tools -> 下看到“创建 GUID”选项。我正在使用 Visual Studio 2005 。

我必须为此安装任何东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T05:37:57.310

它可能会丢失，因为您选择的配置文件不包含该特定选项。尝试以下

1.  工具 -> 导入和导出设置
2.  选择“重置所有设置”并点击下一步
3.  选择“不，只是重置设置，覆盖我当前的设置”，然后点击下一步
4.  选择“常规开发设置”并点击完成

现在“创建 GUID”菜单项应该出现在菜单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T05:45:03.427

在您的机器上搜索“guidgen”。

# python - 使用 GTK 查找工作区大小（屏幕大小减去任务栏）

> ID：502282
> 
> 赞同：6
> 
> 时间：2009-02-02T05:38:09.103
> 
> 标签：python, gtk, pygtk

如何创建一个填充整个桌面**而不覆盖（或被覆盖）任务栏**且不**被最大化**的主窗口？我可以找到整个屏幕尺寸并相应地设置主窗口：

```
window = gtk.Window()
screen = window.get_screen()
window.resize(screen.get_width(), screen.get_height()) 
```

但窗口底部被任务栏覆盖。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T18:09:21.253

为此，您完全受制于窗口管理器，这里的关键问题是：

> **没有被最大化**

所以我们留下了一些技巧，因为基本上最大化和调整大小是两个独立的事情，以便您能够记住它在未最大化时的位置。

因此，在我向您展示这个可怕的 hack 之前，我敦促您考虑使用适当的最大化并对此感到满意。

所以这里是：

```
import gtk

# Even I am ashamed by this
# Set up a one-time signal handler to detect size changes
def _on_size_req(win, req):
    x, y, w, h = win.get_allocation()
    print x, y, w, h   # just to prove to you its working
    win.disconnect(win.connection_id)
    win.unmaximize()
    win.window.move_resize(x, y, w, h)

# Create the window, connect the signal, then maximise it
w = gtk.Window()
w.show_all()
w.connection_id = w.connect('size-request', _on_size_req)
# Maximizing will fire the signal handler just once,
# unmaximize, and then resize to the previously set size for maximization.
w.maximize()

# run this monstrosity
gtk.main() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-29T13:41:20.163

你的意思是让窗口*全屏*？

Gtk 具有使窗口全屏和返回的功能，请参阅[`gtk_window_fullscreen()`](http://developer.gnome.org/gtk3/stable/GtkWindow.html#gtk-window-fullscreen)和[`gtk_window_unfullscreen()`](http://developer.gnome.org/gtk3/stable/GtkWindow.html#gtk-window-unfullscreen).

# c# - 如何在 C# 中实现通用堆栈？

> ID：502290
> 
> 赞同：1
> 
> 时间：2009-02-02T05:43:21.697
> 
> 标签：c#, stack

我正在使用 Visual C# 使用 Stack 编写 RPN 计算器。问题是我不知道该怎么做。我正在使用 System.Collections.Generic，但是

```
Stack<double> s = new Stack<double>(); 
```

产生错误：

> 使用泛型类型“System.Collections.Generic.Stack”需要“1”类型参数

我在这里很无知。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T05:45:19.760

尝试这个

```
Stack<int> s = new Stack<int>(); 
```

将 int 替换为您存储在堆栈中的任何类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T05:44:55.033

您需要指定将存储在堆栈中的元素的类型，例如整数堆栈：

```
Stack<int> s = new Stack<int>(); 
```

# c# - 如何以编程方式获取 .NET 2.0 中应用程序的 GUID

> ID：502303
> 
> 赞同：116
> 
> 时间：2009-02-02T05:49:28.067
> 
> 标签：c#, .net, visual-studio-2005, .net-2.0, guid

我需要在 C# .NET 2.0 中访问我的项目的程序集。

我可以在项目属性下的“装配信息”对话框中看到 GUID，目前我刚刚将它复制到代码中的 const 中。GUID 永远不会改变，所以这不是一个糟糕的解决方案，但直接访问它会很好。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2009-02-02T06:03:26.697

试试下面的代码。您要查找的值存储在附加到程序集的 GuidAttribute 实例中

```
using System.Runtime.InteropServices;

static void Main(string[] args)
{
    var assembly = typeof(Program).Assembly;
    var attribute = (GuidAttribute)assembly.GetCustomAttributes(typeof(GuidAttribute),true)[0];
    var id = attribute.Value;
    Console.WriteLine(id);
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-14T18:00:25.453

另一种方法是使用[Marshal.GetTypeLibGuidForAssembly](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.gettypelibguidforassembly.aspx)。

根据[MSDN](https://en.wikipedia.org/wiki/Microsoft_Developer_Network)：

> 将程序集导出到类型库时，会为类型库分配一个 LIBID。您可以通过在程序集级别应用 System.Runtime.InteropServices.GuidAttribute 来显式设置 LIBID，也可以自动生成它。Tlbimp.exe（类型库导入程序）工具根据程序集的标识计算 LIBID 值。GetTypeLibGuid 返回与 GuidAttribute 关联的 LIBID（如果应用了该属性）。否则，GetTypeLibGuidForAssembly 返回计算值。或者，您可以使用 GetTypeLibGuid 方法从现有类型库中提取实际的 LIBID。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-02T05:52:08.403

您应该能够通过反射读取程序集的 GUID 属性。这将获得当前程序集的 GUID

```
 Assembly asm = Assembly.GetExecutingAssembly();
    object[] attribs = asm.GetCustomAttributes(typeof(GuidAttribute), true);
    var guidAttr = (GuidAttribute) attribs[0];
    Console.WriteLine(guidAttr.Value); 
```

如果您想阅读诸如 AssemblyTitle、AssemblyVersion 等内容，您也可以将 GuidAttribute 替换为其他属性。

如果您需要读取外部程序集的这些属性（例如，在加载插件时），您还可以加载另一个程序集（Assembly.LoadFrom 和所有程序集）而不是获取当前程序集。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-08-30T17:19:20.123

或者，同样简单：

```
string assyGuid = Assembly.GetExecutingAssembly().GetCustomAttribute<GuidAttribute>().Value.ToUpper(); 
```

这个对我有用...

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-12-19T21:25:29.483

对于一个开箱即用的工作示例，这是我根据之前的答案最终使用的。

```
using System.Reflection;
using System.Runtime.InteropServices;

label1.Text = "GUID: " + ((GuidAttribute)Attribute.GetCustomAttribute(Assembly.GetExecutingAssembly(), typeof(GuidAttribute), false)).Value.ToUpper(); 
```

或者，这种方式允许您从静态类中使用它：

```
 /// <summary>
    /// public GUID property for use in static class </summary>
    /// <returns>
    /// Returns the application GUID or "" if unable to get it. </returns>
    static public string AssemblyGuid
    {
        get
        {
            object[] attributes = Assembly.GetEntryAssembly().GetCustomAttributes(typeof(GuidAttribute), false);
            if (attributes.Length == 0) { return String.Empty; }
            return ((System.Runtime.InteropServices.GuidAttribute)attributes[0]).Value.ToUpper();
        }
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-08T18:49:31.597

其他答案在这里没有任何运气，但我设法用这个漂亮的单线解决了这个问题：

```
((GuidAttribute)(AppDomain.CurrentDomain.DomainManager.EntryAssembly).GetCustomAttributes(typeof(GuidAttribute), true)[0]).Value 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-01T07:34:26.493

要获取 appID，您可以使用以下代码行：

```
var applicationId = ((GuidAttribute)typeof(Program).Assembly.GetCustomAttributes(typeof(GuidAttribute), true)[0]).Value; 
```

为此，您需要包括`System.Runtime.InteropServices;`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-25T19:38:01.810

```
 string AssemblyID = Assembly.GetEntryAssembly().GetCustomAttribute<GuidAttribute>().Value; 
```

或者，VB.NET：

```
 Dim AssemblyID As String = Assembly.GetEntryAssembly.GetCustomAttribute(Of GuidAttribute).Value 
```

# web-frameworks - Web 开发包的稳定性？

> ID：502306
> 
> 赞同：0
> 
> 时间：2009-02-02T05:51:37.843
> 
> 标签：web-frameworks, stability

我对网络框架的经验是它们相对“不稳定”。并不是说它们崩溃了，而是有很多更改会迫使人们重新编写代码。我想知道您使用过哪些 Web 开发包以及维护该代码的工作量是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T06:00:26.843

“变化是要求的一部分。”

我不认为我们设计的 web 包有很大的变化。如果它改变了，那么它就是一个糟糕的设计。如果我们使用外部 API，则很少有一些会被弃用，否则大多数都是相同的。

一些用作 JAVA/J2EE 程序员的包： - MVC - Struts - 一些 AJAX 框架

这些是非常基本的使用方法。大多数其他的都是自行开发的，一旦网络包的设计完成，我们不会更改设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T06:01:09.120

任何正在积极开发的库都将是不稳定的。以 .NET 为例，每个月都有一种新的更好的方法来处理旧的东西。另一方面，开源库更倾向于抛弃旧的不推荐使用的方法，因为它使代码更好，这就是让他们高兴的原因。

但是我不建议使用任何旧的和不受支持的东西，尽管环境会完全稳定，但你会靠自己。

最好的方法似乎只是冻结您开始使用的库版本并切换到新版本，只有这样做会有巨大的好处。至少每个人都是这样做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T06:03:05.887

.NET 和 jQuery 等框架在很大程度上向后兼容，允许您慢慢使用新功能。

然而，Mootools……API 破坏了从 1.11 到 1.2 再到 1.3 的许多东西。在这种情况下，升级并不简单。

作为一项规则，我会尝试等待某些内容完成测试，然后再将其包含在生产代码中。认可也有很长的路要走——因为微软称 jQuery 是客户端框架的赢家，所以很容易鼓励其他人也接受它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T07:20:08.710

我的大部分经验是使用 Ruby on Rails，所以我将分享我在过去几年中所看到的。

Rails 以相当不错的速度更新，但除非您需要功能或罕见的安全补丁，否则您实际上不需要更新。例如，我现在在我们公司运行一个 Rails 应用程序，它是大约 2.5 年前编码的，今年只需要对其进行一次工作即可将其升级到与 apache mod_rails 兼容的新版本，它我相信最初是针对 Rails 1.2 编写的。当然，那是一个没有任何安全要求的内网应用程序。总而言之，它非常无痛。如果我一直使用 mongrel + mod_proxy，它就不需要为安全补丁更新一次。

Rails 非常安全，漏洞之间也相距甚远。如果我没记错的话，Ruby 漏洞比 Rails 漏洞要多一些，但总而言之，它非常可靠，升级你的 ruby​​ 不应该破坏轨道，特别是如果你使用一个向后移植安全修复程序的发行版。

# jquery - 如何为 jQuery 日期选择器制作自定义显示？

> ID：502311
> 
> 赞同：0
> 
> 时间：2009-02-02T05:53:44.063
> 
> 标签：jquery, format, datepicker

是否可以使用 jquery datepicker 显示如下所示的日历。

```
 OCT-2009
Mon      Tue     Wed     Thur     Fri        Sat    Sun
 28       29      30        1       2          3      4        
  5        6       7        8       9         10     11      
 12       13      14       15      16         17     18     
 19       20      21       22      23         24     25      
 26       27      28       29      30         31      1 
```

前四个日期来自上个月，最后一个日期来自下个月。我只想为所有月份生成这种格式的日期选择器日历。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T06:02:57.710

这是给你的插件

[http://marcgrabanski.com/pages/code/jquery-ui-datepicker](http://marcgrabanski.com/pages/code/jquery-ui-datepicker)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T08:50:38.637

尝试这个

```
$('.selector').datepicker({ showOtherMonths: true }); 
```

# updatepanel - 从另一个 UpdatePanel ASP.Net 访问 View 内的 UpdatePanel

> ID：502315
> 
> 赞同：1
> 
> 时间：2009-02-02T05:56:40.970
> 
> 标签：updatepanel, multiview

我有两个更新面板

*   UpdatePanel1 包含一个按钮
*   UpdatePanel2 在 Multiview View1 内：

.

```
<Multiview>
  <View1>
    <UpdatePanel2>
    </UpdatePanel2>
  </View1>
</Multiview> 
```

多视图 ActiveIndex 设置为 -1。

现在我在 UpdatePanel2 上附加了一个 AsyncPostBackTrigger，它与按钮单击相关联。

当我单击 UpdatePanel1 中的按钮时，我想显示 View1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T00:04:40.100

您需要将更新面板放在 MultiView 周围，而不是 View1 内：

```
<UpdatePanel2><MultiView><View1></View1></MultiView></UpdatePanel2> 
```

UpdatePanel 将在页面上呈现为 div 或 span（默认为 div）。

当您执行回调时（例如当您单击 UpdatePanel 内的按钮时），ASP.NET 会向浏览器发送一条消息，告诉它如何更新代表 UpdatePanel 的 div 的内容。此消息在 javascript 中接收和处理。

如果您在第一次到达页面时没有显示 View1，则 UpdatePanel2 根本不会被呈现。因此，当您的按钮单击导致回调时，呈现的页面上没有 div 可供 javascript 更改其内容。

# java - 使用集合对象构建结果集

> ID：502318
> 
> 赞同：0
> 
> 时间：2009-02-02T05:58:12.493
> 
> 标签：java, collections, jdbc, resultset

我在使用 java 构建结果集时遇到了问题。来了……

我正在存储一个集合对象，该对象从结果集对象中按行组织，并将集合对象（存储为向量/数组列表）放入缓存中，并尝试检索相同的集合对象。在这里，我需要使用集合对象再次构建结果集。现在我怀疑是否可能以这种方式构建结果集？请尽快让我知道。

提前致谢，

巴斯卡尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T07:20:24.590

如果您使用集合代替缓存，最好的办法是使用[CachedRowSet](http://java.sun.com/j2se/1.5.0/docs/api/javax/sql/rowset/CachedRowSet.html)而不是 ResultSet。CachedRowSet 是 ResultSet 的子接口，但是数据已经被缓存了。这比将所有数据写入 ArrayList 简单得多。
CachedRowSets 也可以自己查询。

```
CachedRowSet rs;
.......................
.......................
Integer id;
String name;

while (rs.next())
{               
     if (rs.getInt("id") == 13)
     {
          id   = rs.getInt("id");
          name = rs.getString("name")); 
     }              
} 
```

因此，您只需在需要信息时调用 CachedRowSet。它几乎和切片面包一样好。:)

**编辑：**
ResultSet 没有设置方法，而有更新方法。使用 Update 方法来重建 ResultSet 的问题在于它需要选择要更新的行。ResultSet 释放自身后，所有行都设置为空。不能调用空引用。List of Lists 模仿 ResultSet 本身，或者更准确地说，数组数组模仿 ResultSet。

尽管 Vector 是线程安全的，但它们会产生巨大的开销。请改用 ArrayList。在创建每个嵌套列表并将其放入外部嵌套列表时，以这种方式插入它。

```
nest.add(Collections.unmodifiableList(nested)); 
```

插入所有嵌套列表后，将嵌套列表也返回为 umodifiableList。这将为您提供一个线程安全的集合，而不会产生向量的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T12:08:29.813

看看[这个页面](http://h2database.com/html/features.html#user_defined_functions)。尝试查看 SimpleResultSet 类是否适合您的需求。

如果您将[它的源代码](http://www.google.com/codesearch/p?hl=en#nNQkx37hnf0/trunk/h2/src/main/org/h2/tools/SimpleResultSet.java&q=SimpleResultSet%20package:http://h2database%5C.googlecode%5C.com)组合成一组独立的类，它应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T06:06:29.733

据我所知，您的代码可能是这样的：

```
List collection = new ArrayList();
collection.add(" A collection in some order");

List cache = new ArrayList();
cache.add(collection); ... 
```

现在，当您检索时，我认为您会按顺序获得您的收藏，因为您使用了 List。

如果这不是您所期望的，请发表评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T07:35:13.953

我会建议你使用 CachedRowSet。有关 CachedRowSet 的更多信息，请参阅[http://www.onjava.com/pub/a/onjava/2004/06/23/cachedrowset.html这篇文章。](http://www.onjava.com/pub/a/onjava/2004/06/23/cachedrowset.html)创建此 CachedRowSet 后，您可以断开与数据库的连接，对缓存的数据进行一些更改，甚至可以打开数据库连接并将更改提交回数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T07:37:33.573

您应该考虑的另一个选择是重构您的代码以接受集合而不是结果集。

我假设您将该 ResultSet 传递给迭代它的方法。您不妨更改方法以迭代 ArrayList ...

# usb - 从 U 盘携带和处理整个开发盒。可行的？

> ID：502319
> 
> 赞同：2
> 
> 时间：2009-02-02T05:59:32.740
> 
> 标签：usb, vmware, portability, xen

最近我一直在考虑投资一个有价值的 USB 笔式驱动器（类似于[此](http://scanmalta.com/item.php?WebCategory=flashmem&ProductCode=BACK-L20703)的东西），并在虚拟机上安装操作系统并开始在它们上进行开发。

我的想法是，我希望能够携带我的开​​发箱，作为.Net 开发的**Windows 发行**版和用于 RoR、Perl 之类的东西的**Linux 发行版**，这样我就可以随身携带它们需要......无论是工作，学校，家里的不同电脑等......

我正在考虑这样做也是出于备份目的...即将我的几乎单个 VM 文件备份到外部 hd，而不是定期更新我的普通 Windows Box。我也在考虑甚至可能在源代码控制下提交 VM 框（*这是否可行？*）

*那么，我在正确的轨道上吗？你建议我尝试实现这一点吗？*

**将您的开发盒安装在通过 USB 笔式驱动器运行的虚拟机上是否可行？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T06:20:09.907

这篇关于 USB 拇指驱动器的文章指出 [，](http://ask-leo.com/can_a_usb_thumbdrive_wear_out.html)

> 切勿直接针对存储在拇指驱动器上的文件运行磁盘密集型应用程序。

USB 拇指驱动器使用闪存，并且在发生损坏和损坏之前具有**最大写入次数。**之前链接文章的作者发现它在 10,000 - 100,000 次写入范围内，但如果您使用的是磁盘密集型应用程序，这可能是个问题。

因此，如果您这样做，请**制定积极的备份策略**来备份您的工作。同样，如果当您运行您的开发套件时，如果它可以写入本地硬盘驱动器作为临时工作区，这将是理想的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T06:41:00.490

我完全同意你要去的地方。我希望自己做这件事。

但是，如果您还不知道，这不仅仅是关于驱动器大小，相信与否**USB 闪存驱动器可能比您的旋转磁盘驱动器慢得多**！

如果您打算**直接从 USB 驱动器实际运行虚拟机，**这**可能是一个大问题！**

 **我尝试在 32GB Corsair Survivor 上运行 4GB Windows XP VM，但 VM 几乎无法使用！将我的 4GB 虚拟机复制到驱动器上的速度也很慢——大约需要 10 分钟才能将其复制到驱动器上。

如果您有 esata 端口**，我强烈建议您查看高速 ESata**选项，例如[Kanguru 32GB ESata/USB 闪存驱动器](http://www.kanguru.com/eflash.html)或[OCZ 的 32GB](http://www.ocztechnology.com/products/flash_drives/ocz_throttle_esata_flash_drive)驱动器。

这些驱动器的读写速度比 ESata 比其他 USB 驱动器高得多。如果您没有 ESata 端口，您仍然可以将它们用作 USB。虽然如果您没有 ESata 端口，您可以在线购买 PCI 到 ESata 卡，甚至可以为您的笔记本电脑购买 ESata ExpressCards。

*编辑：附带说明，您会发现 USB 闪存驱动器使用 FAT 而不是 NTFS。您不想使用 NTFS，因为它会在磁盘上进行更多的读取和写入操作，并且您的驱动器在死前只能进行有限数量的读取和写入。但是通过使用 FAT，您将被限制为最大 2GB 文件大小，这可能是您的 VM 的问题。如果是这种情况，您可以将 VM 磁盘拆分为 2GB 块。还要确保你每天备份你的虚拟机，以防你的驱动器确实达到了它的最大写入次数。:)*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T06:11:20.860

希望您谈论的是解释性语言项目。我无法想象在 VM 上编译任何大小的 C/C++，更不用说使用 USB 驱动器运行的 VM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T06:11:50.220

我经常用 Xen 做这件事，但在驱动器上还包含一个裸机可引导内核。这在处理 Live CD 所基于的内容时特别有用。

不好的一面是 VM 映像的膨胀，以使其可在许多机器上启动.. 所以你通常只构建一个非常精简和平均的半虚拟化内核.. 你还必须包括一个包含厨房水槽在内的所有东西（向上到你想要的，即你需要音频，还是令牌环等？）

我通常带两根棍子，一根有 Xen + 一个打过补丁的 Linux 2.6.26，另一根有我的各种来宾映像，它们可以随时启动。一个 debootstrapped 的 Debian 或 Ubuntu 副本是创建前者的一个很好的起点。

如果没有别的，修补它很有趣。抱歉有点以 GNU/Linux 为中心，但那是我专门使用的 :) 当我不得不找到一条奇怪的路径来升级我的发行版时，我开始搞砸了，这比现在的发行版晚了两年。所以，我绑了一个客人，安装了我想要的东西，并将 GRUB 指向我的根文件系统的新 LV。在里面，我刚刚安装了我的旧 /home LV，然后我就走了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T06:10:49.363

查看 MojoPac：

[http://www.mojopac.com/](http://www.mojopac.com/)

铁杆游戏玩家使用它随身携带魔兽世界——它应该可以很好地满足您的开发需求，至少在 Windows 上是这样。使用 cygwin 来满足您的 unix-dev 需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T07:18:37.793

我曾经这样做过，发现编译速度非常慢，不值得。

请记住，与随机写入性能（将大量小文件写入已经有大量文件的分区）的硬盘驱动器相比，USB 闪存驱动器非常慢（可能慢 10 到 100 倍）。

使用 GNU 工具的典型构建过程会创建大量小文件 - 一个简单的配置脚本会创建数千个小文件并再次删除它们，以便在开始编译之前测试环境。你可能要等很久。

# linq-to-sql - 将“is null”转换为 linq to sql 语句

> ID：502328
> 
> 赞同：2
> 
> 时间：2009-02-02T06:03:33.933
> 
> 标签：linq-to-sql

我无法将以下 sql 复制为 LINQ 语句

```
select TableA.* from TableA left outer join TableAinTableB on TableA.Id = TableAId where TableBId is null 
```

以下不返回任何行

```
from TableA in db.TableA join AinB in db.TableAinTableB on TableA.Id equals TableAId where AinB.TableBId == null select TableA 
```

还尝试了其他一些不起作用的东西。

```
from TableA in db.TableA join AinB in db.TableAinTableB on TableA.Id equals TableAId where AinB == null select TableA 
```

TableAinTableB 是一个多对多表。我想要的查询将从 TableA 中提取所有在中间表中没有记录的记录。我的 sql 做我想做的事，但我不知道如何将它转换为 LINQ to SQL。

我最终通过执行 db.ExecuteQuery("working sql"); 来解决它。但我想知道查询是否可以在 LINQ 中进行以及如何编写，或者指向涵盖此场景的文档的指针。我的搜索没有发现任何我认为有用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T06:17:05.483

您可以使用[DefaultIfEmpty](http://msdn.microsoft.com/en-us/library/bb360179.aspx)来模拟外连接。看看这个[样本](http://msdn.microsoft.com/en-us/vbasic/bb737929.aspx)。

在您的示例中，它类似于：

```
var q = from a in TableA
            join b in TableB on a.Id equals b.Id into g
            from b in g.DefaultIfEmpty()
            select a; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T08:44:32.440

对于“IS NULL”，尝试这样的事情

```
from TableA in db.TableA 
join AinB in db.TableAinTableB 
on TableA.Id equals TableAId 
where object.Equals(AinB.TableBId, null)
select TableA; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T10:46:26.857

您也可以使用`ExecuteQuery`LINQ 的方法，例如：

```
string query = "select TableA.* from TableA left outer join TableAinTableB on TableA.Id = TableAId where TableBId is null";
TestDataContext db = new TestDataContext();
IEnumerable<TableA> objUser = db.ExecuteQuery<TableA>(query).ToList(); 
```

其中是映射的数据库`TestDataContext`的 LINQ-to-SQL 。`DataContext``TableA`

# sharepoint - SharePoint 404 页面

> ID：502336
> 
> 赞同：5
> 
> 时间：2009-02-02T06:08:38.433
> 
> 标签：sharepoint

是在 web.config customError 部分中为 SharePoint 设置 404 错误页面的最佳位置，还是在网站集/Web 应用程序上有配置设置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T06:29:38.080

请阅读[此博客](http://blogs.msdn.com/jingmeili/archive/2007/04/08/how-to-create-your-own-custom-404-error-page-and-handle-redirect-in-sharepoint-2007-moss.aspx)

粘贴：

1.  在您的 MOSS 服务器中，复制 %systemdrive%\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\1033\sps404.html 并将其命名为 my404.html

2.  在您的 MOSS 根 Web 应用程序下的 IIS 中创建一个虚拟目录。例如/错误

3.  创建您自己的重定向 aspx 页面，例如 /errors/my404redirect.aspx 并在其中编写您的重定向逻辑。这是一个普通的 asp.net 页面。
4.  在 my404.html 中，进行以下更改： STSNavigate("/errors/my404redirect.aspx?oldUrl=" + requestedUrl);
5.  创建一个控制台应用程序并插入以下代码并在 MOSS 服务器中运行它

    *System.Uri webApplicationUri = new Uri( [http://MyMOSSServer/](http://MyMOSSServer/) ); SPWebApplication webApplication = SPWebApplication.Lookup(webApplicationUri); webApplication.FileNotFoundPage = "my404.html"; webApplication.Update();*

6.  现在，当您浏览到一个不存在的页面时，您应该期望被带到重定向的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-01T14:53:48.307

我知道这已经得到了回答，但替代方案是以下网址：[http](http://sharepointsmart404.codeplex.com/) ://sharepointsmart404.codeplex.com/ - 它仍应导致 404 状态代码，以便搜索引擎从缓存中删除页面（最终）

# c++ - 什么时候为一个类定义 ostream 运算符 <<？

> ID：502345
> 
> 赞同：2
> 
> 时间：2009-02-02T06:12:19.033
> 
> 标签：c++

这个问题可能是主观的，所以语法

```
std::ostream& operator << (std::ostream & o, const SomeClass &a) {
    return o << a.accessor().. ; 
} 
```

你通常什么时候为你写的类定义这个，你什么时候避免为你的类写这个友元函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T08:20:07.450

如果我想流式传输课程，我通常会这样写：

```
std::ostream& operator << (std::ostream& o, const SomeClass& a)
{
    a.print(o);
    return o; 
} 
```

然后在 SomeClass 上打印一个 const 方法，该方法知道如何将类序列化为流。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T06:19:55.617

我只会重载 operator<< 当它与流式传输或移位有关并且该类是纯数字时。对于将某些内容写入 ostream，就像在您的代码中一样，我认为这很好。我认为，其他任何事情都会引起混乱，我最好将成员函数用于其他目的。另一个应用程序，我认为我仍然会作为规则的例外来做，正在做这样的事情：

```
StringList list;
list << "foo" << "bar" << "baz"; 
```

这就是 Qt 使用它的字符串列表的方式，我觉得这很不错。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T08:54:31.513

Martin 上述回答的一个好处是您还可以免费获得多态性。如果你创建`print(ostream&)`一个**虚**函数，那么 << 操作符也像一个虚函数！

至于何时重载运算符，请在您认为应该能够将类写入流（文件、套接字等）的任何时候这样做。这甚至可能仅用于调试目的。能够输出类的内部结构通常很有用，因此重载此运算符并没有真正的缺点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T12:43:47.043

I would consider using it for something like logging. So you can do:

```
SystemLog systemLog;
systemLog << "Processing Item #15";
systemLog << "Error 0014: Bad things happened.";
systemLog << system.executeCommand(cmd); // returns a result string 
```

Or maybe for networking as in:

```
NetworkInterface networkInterface;
string message("Hello World! I'm a server.");
networkInterface << message; 
```

Of course implementing these things as regular function is also possible and might just be preferable. Generally, you should beware of operator overloading. Only use it when it really fits.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T06:15:40.197

我从来没有在生产代码中重载过这个。尽管如果您记录很多，您可能想要这样做，但它会很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T12:20:06.110

I implement this if, and only if, I intend to make use of that operator. This is pretty much never... my reasons for not implementing it are therefore not using it. If its for public use then include it for completeness, but certainly I wouldn't include this in every class in a project of your own, since for the most part you will not need to output a class to a stream. e.g. If you wrap your entry point in a class, providing this operator will be pointless.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T20:10:49.357

我经常这样做，因为它使将对象转储到日志以进行调试非常方便。

# c# - StringBuilder 字符串是不可变的吗？

> ID：502346
> 
> 赞同：6
> 
> 时间：2009-02-02T06:14:18.437
> 
> 标签：c#, .net, string

StringBuilder 被誉为比简单地连接字符串更快的字符串操作工具。不管这是否属实，我都想知道 StringBuilder 操作的结果以及它们产生的字符串。

快速浏览 Reflector 表明 StringBuilder.ToString() 并不总是返回一个副本，有时它似乎返回一个内部字符串的实例。它似乎还使用一些内部函数来操作内部字符串。

那么，如果我这样做，我会得到什么？

```
string s = "Yo Ho Ho";
StringBuilder sb = new StringBuilder(s);
string newString = sb.ToString();
sb.Append(" and a bottle of rum.");
string newNewString = sb.ToString(); 
```

newString 和 newNewString 是不同的字符串实例还是相同？我试图通过反射器来解决这个问题，但我只是不太了解所有内容。

这段代码怎么样？

```
StringBuilder sb = new StringBuilder("Foo\n");
StringReader sr = new StringReader(sb.ToString());
string s = sr.ReadLine();
sb.Append("Bar\n");
s = sr.ReadLine(); 
```

最后一条语句会返回 null 还是“Bar”？如果它返回一个或另一个，这是定义的还是未定义的行为？换句话说，我可以依赖它吗？

文档在这个主题上非常简洁，我不愿意依赖观察到的行为而不是规范。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T06:21:41.060

在 mscorlib 之外，System.String 的任何实例都是不可变的。

StringBuilder 在内部对字符串进行了一些有趣的操作，但最终它不会向您返回字符串，然后以您的代码可见的方式对其进行变异。

至于后续对 StringBuilder.ToString() 的调用是返回相同的 String 实例还是返回具有相同值的不同 String ，这取决于实现，您不应依赖此行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T06:22:32.553

`newString`并且`newNewString`是不同的字符串实例。

虽然`ToString()`返回当前字符串，但它会清除其当前线程变量。这意味着下次追加时，它将在追加之前获取当前字符串的副本。

我不*完全*确定您在第二个问题中得到了什么，但`s`将为空：如果文件中的最后一个字符是前一行的行终止字符，则该行*不*被视为具有这些字符和文件末尾之间的空行。之前读取的字符串对此没有影响。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T06:30:59.230

> 是`newString`和`newNewString` 不同`string`的实例还是相同的？我试图通过反射器来解决这个问题，但我只是不太了解所有内容。

它们是不同的`string`实例：`newString`is " `Yo Ho Ho`" 和`newNewString`is " `Yo Ho Ho and a bottle of rum.`"。`strings`是不可变的，并且当您调用`StringBuilder.ToString()`该方法时，会返回一个`string`表示*当前*状态的不可变对象。

> 最后一条语句会返回`null`还是“ `Bar`”？如果它返回一个或另一个，这是定义的还是未定义的行为？换句话说，我可以依赖它吗？

它会返回`null`。`StringReader`正在处理您在构造函数中传递给它的不可变对象`string`，因此它不受您对`StringBuilder`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T06:25:12.707

这个类的全部目的是使字符串可变，实际上就是这样。我相信（但不确定）只有在没有对这个对象做任何其他事情的情况下，它才会返回进入它的相同字符串。所以之后

```
String s_old = "Foo";
StringBuilder sb = new StringBuilder(s_old);
String s_new = sb.ToString(); 
```

s_old 将与 s_new 相同，但在任何其他情况下都不会。

我应该注意，Java 编译器会自动将多个字符串添加转换为使用 StringBuilder（或类似但更快的 StringBuffer）类的操作，如果 .NET 编译器也不进行这种转换，我会感到非常惊讶。

# redirect - www 和非 www 重定向问题。有人帮忙！

> ID：502352
> 
> 赞同：0
> 
> 时间：2009-02-02T06:16:52.143
> 
> 标签：redirect

我有一个网站 ABC.com，事情是 www.ABC.com 正在工作，而 ABC.com 却没有。我为两者都设置了域转发以指向 www.ABC.com，但浏览器说它是一个无限循环。因此，我在 ABC.example.com 中设置了一个子域，并将 ABC.com 和 www.ABC.com 都指向 ABC.example.com，但 URL 被屏蔽。从 SE 的角度来看会有什么问题吗？现在它似乎工作正常。此外，我绝对不希望我的访问者知道它托管在 example.com 因为这是一个自定义域问题，我没有 .htaccess 或 301 重定向权限

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T06:47:31.990

> 我为两者都设置了域转发以指向 www.ABC.com 但浏览器说它是一个无限循环

您可能不希望 www.ABC.com 转发到 www.ABC.com，因为是的，这确实是一个无限循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T08:44:55.293

您不应该重新定向，请联系您的主机并询问您在哪里可以找到在有人只是键入（在您的情况下）ABC.com 的情况下自动附加 URL 和 www 的设置 - 这是大多数主机的一个突出功能软件，默认情况下应启用。

# ruby - 什么时候结束事件被调用？

> ID：502359
> 
> 赞同：3
> 
> 时间：2009-02-02T06:20:49.093
> 
> 标签：ruby, shoes

使用鞋子，我想在窗口破坏时执行一个块。我以为我可以使用*完成*事件，但在下面的代码中，显示了“开始”，但从未显示“完成”。

* * *

```
Shoes.app(:title => "Test") do

    flow do
        start do |obj|
            alert("Starting")
        end

        finish do |obj|
            alert("Finished")
        end

        button "Hello"
    end
end 
```

* * *

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T06:52:03.010

在做了一些更多的研究之后......

*目前，Shoes 中的完成*事件似乎仅用于下载。

此外，目前似乎没有*onclose*事件，但已经讨论过了。

[http://article.gmane.org/gmane.comp.lib.shoes/2976](http://article.gmane.org/gmane.comp.lib.shoes/2976)

很抱歉回答我自己的问题，但把知识放在那里给别人。

# math - 复数应该如何呈现？

> ID：502362
> 
> 赞同：4
> 
> 时间：2009-02-02T06:23:52.520
> 
> 标签：math, notation, complex-numbers

数学天真的问题：

表示 14+1i 的“规范”方式是什么？

```
14+i1 
```

或者

```
14+i 
```

类似地，在“现实世界”中，科学记数法是否可能会潜入复数以吓坏复数解析器？例如，

```
1.2345E+02-1.7002E-09i 
```

**编辑：**最后，是吗

```
8.45358210351126e+066i 
```

或者

```
8.45358210351126e+66i 
```

即在虚数上是否将一个零归档到三位数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T06:28:54.803

我的偏好是：

```
14 + i 
```

不知何故，它比 14 + 1i 更令人赏心悦目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T06:52:59.903

MATLAB没有问题：

```
>> 5+i
ans =
  5.0000 + 1.0000i

>> 5+1i
ans =
   5.0000 + 1.0000i

>> 1.2345E+02-1.7002E-09i
ans =
  1.2345e+002 -1.7002e-009i 
```

我认为这表明`E`复数的科学记数法（“”）在“现实世界”中得到了很好的处理......在某种程度上，MATLAB 是那个世界的一个有影响力的部分 =）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T06:26:55.337

我将您的第一个示例表示为：

```
14 + 1i 
```

我当然希望看到复数的科学记数法。例如，Python 很乐意接受以下内容（`j`根据 Python 要求使用）：

```
>>> 1.2345E+02-1.7002E-09j
(123.45-1.7002e-09j) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T06:35:38.770

“14 + 1i”比“14+i1”好，但我更可能说或写“14 + i”。

此外，`1.7002E-09i`（我在数学中没有见过，尽管毫无疑问它发生在工程或其他东西中）如果没有上标字体（你的意思是`1.7002*(10 ** -9)*i`还是`1.7002*(10 ** -9*i)`？）看起来有点模棱两可，因此`(1.7002E-09)i`可能会更好。

# javascript - Javascript中的结构

> ID：502366
> 
> 赞同：128
> 
> 时间：2009-02-02T06:25:38.150
> 
> 标签：javascript, struct

以前，当我需要存储许多相关变量时，我会创建一个类。

```
function Item(id, speaker, country) {
  this.id = id;
  this.speaker = speaker;
  this.country = country;
}
var myItems = [new Item(1, 'john', 'au'), new Item(2, 'mary', 'us')]; 
```

但我想知道这是否是一个好习惯。还有其他*更好*的方法来模拟 JavaScript 中的结构吗？

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2009-02-02T06:41:56.040

对象字面量和构造对象之间的唯一区别是从原型继承的属性。

```
var o = {
  'a': 3, 'b': 4,
  'doStuff': function() {
    alert(this.a + this.b);
  }
};
o.doStuff(); // displays: 7 
```

* * *

你可以做一个结构工厂。

```
function makeStruct(names) {
  var names = names.split(' ');
  var count = names.length;
  function constructor() {
    for (var i = 0; i < count; i++) {
      this[names[i]] = arguments[i];
    }
  }
  return constructor;
}

var Item = makeStruct("id speaker country");
var row = new Item(1, 'john', 'au');
alert(row.speaker); // displays: john 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-02-02T06:28:43.057

我总是使用对象字面量

```
{id: 1, speaker:"john", country: "au"} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-11-07T01:37:21.720

真正的问题是语言中的结构应该是值类型而不是引用类型。建议的答案建议使用对象（引用类型）代替结构。虽然这可以达到其目的，但它回避了程序员实际上想要使用值类型（如原语）代替引用类型的好处。一方面，值类型不应导致内存泄漏。

编辑：有[一项提案正在制定中](https://github.com/tc39/proposal-record-tuple)以涵盖此目的。

```
//today
var obj = {fname: "Kris", lname: "Kringle"}; //vanilla object
var gifts = ["truck", "doll", "slime"]; //vanilla array

//records and tuples - not possible today
var obj = #{fname: "Buddy", lname: "Hobbs"};
var skills = #["phone calls", "basketball", "gum recycling"]; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-08-13T22:56:52.907

我认为创建一个类来模拟类似 C 的结构，就像你一直在做的那样，是**最好**的方法。

这是对相关数据进行分组并简化将参数传递给函数的好方法。考虑到模拟真正的面向对象功能所需 的[额外工作](http://javascript.crockford.com/private.html)，我还认为 JavaScript 类更像是 C++ 结构而不是 C++ 类。

我发现试图让 JavaScript 更像另一种语言会很快变得复杂，但我完全支持将 JavaScript 类用作无功能的结构。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-10-14T05:48:30.207

按照 Markus 的[回答](https://stackoverflow.com/a/502384/4212710)，在较新版本的 JS（我认为是 ES6）中，您可以更简单地使用[箭头函数](http://es6-features.org/#StatementBodies)和[Rest Parameter](http://es6-features.org/#RestParameter)创建一个“结构”工厂，如下所示：

```
const Struct = (...keys) => ((...v) => keys.reduce((o, k, i) => {o[k] = v[i]; return o} , {}))
const Item = Struct('id', 'speaker', 'country')
var myItems = [
    Item(1, 'john', 'au'),
    Item(2, 'mary', 'us')
];

console.log(myItems);
console.log(myItems[0].id);
console.log(myItems[0].speaker);
console.log(myItems[0].country); 
```

运行结果如下：

```
[ { id: 1, speaker: 'john', country: 'au' },
  { id: 2, speaker: 'mary', country: 'us' } ]
1
john
au 
```

你可以让它看起来类似于 Python 的 namedtuple：

```
const NamedStruct = (name, ...keys) => ((...v) => keys.reduce((o, k, i) => {o[k] = v[i]; return o} , {_name: name}))
const Item = NamedStruct('Item', 'id', 'speaker', 'country')
var myItems = [
    Item(1, 'john', 'au'),
    Item(2, 'mary', 'us')
];

console.log(myItems);
console.log(myItems[0].id);
console.log(myItems[0].speaker);
console.log(myItems[0].country); 
```

结果：

```
[ { _name: 'Item', id: 1, speaker: 'john', country: 'au' },
  { _name: 'Item', id: 2, speaker: 'mary', country: 'us' } ]
1
john
au 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-02T06:29:00.263

我将对象 JSON 样式用于哑结构（无成员函数）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-02T01:05:50.580

设置工作量更大，但如果可维护性胜过一次性工作，那么这可能就是您的情况。

```
/**
 * @class
 */
class Reference {

    /**
     * @constructs Reference
     * @param {Object} p The properties.
     * @param {String} p.class The class name.
     * @param {String} p.field The field name.
     */
    constructor(p={}) {
        this.class = p.class;
        this.field = p.field;
    }
} 
```

好处：

*   不受参数顺序的约束
*   易于扩展
*   类型脚本支持：

[![在此处输入图像描述](https://i.stack.imgur.com/g7Kns.png)](https://i.stack.imgur.com/g7Kns.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-13T17:15:27.230

如果您使用 ES6 兼容性，我创建了一个小型库来定义 struct。

它是一个 JKT 解析器，您可以在此处查看项目存储库[JKT Parser](http://github.com/slaveofcode/jkt)

例如，您可以像这样创建结构

```
const Person = jkt`
    name: String
    age: Number
`

const someVar = Person({ name: "Aditya", age: "26" })

someVar.name // print "Aditya"
someVar.age // print 26 (integer)

someVar.toJSON() // produce json object with defined schema 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-27T13:13:35.257

这是一个老问题，似乎还没有解决。对于它的价值，我使用不变性来获得类似的行为。使用打字稿：

```
export class Point {
   public readonly X: number;
   public readonly Y: number;

   constructor(x: number, y: number)
   {
       this.X = x;
       this.Y = y;
   }

   public static SetX(value: number) : Point {
       return new Point(value, this.Y);
   }

   public static SetY(value: number) : Point {
       return new Point(this.X, value);
   }
} 
```

这为您带来了复杂值类型的主要好处，即您不会通过对它的引用意外地修改对象。

当然，缺点是如果您确实想要修改成员，则必须创建一个新实例，因此需要静态`SetX`和`SetY`函数。

这是很多语法糖，但我认为对于特殊情况是值得的，例如`Point`，如果值被意外更改，可能会被大量使用并导致大量错误。

# authentication - 登录超时：您在什么情况下使用它们？

> ID：502372
> 
> 赞同：0
> 
> 时间：2009-02-02T06:29:31.450
> 
> 标签：authentication, session-timeout

我想知道何时使用登录超时，特别是在使用相同会话（相同浏览器会话）时。在我最近完成的一些网站上，我添加了 60 分钟的超时时间，它们似乎会导致问题，例如用户无法填写较大的表格（如简历提交——人们不会考虑复制他们的简历从另一个程序或部分保存）。在一个站点上，我实现了一个 div/popup 强制用​​户输入密码以继续当前会话，而无需再次登录。

但在 Facebook 等其他网站上，只要您使用相同的浏览器窗口，即使没有“记住”您的密码，您似乎也永远不会注销。

我通常使用超时的主要原因是为了确保数据安全，这样几小时后另一方就无法坐在计算机前并以原始用户身份使用系统。

我想知道您如何决定网站何时因不活动而使用户超时？

我认为答案将与语言无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T07:22:27.020

IMO，它们在以下情况下有效：

1.  安全至关重要（即银行业务）
2.  座位交换的可能性很高（即公共终端）

无论如何，可能存在像您的简历系统这样的情况，您希望公共终端上的人们能够执行一项可能使他们处于非活动状态的时间超过您期望或必要的超时时间。

我想你只需要以一种聪明的方式处理它——要么想办法让他们更快地获取数据（这将是王牌，花一个小时填写表格并不好玩——他们可以上传文件吗？） ，或确保他们在被提示重新登录后可以继续操作而不会丢失任何数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T06:43:18.457

尽管 60 分钟填写一个表单似乎很长（也许表单应该分成多个页面？），您可能可以使用 SlidingExpiration 来解决即使浏览器会话处于活动状态，您的用户也会退出的问题.

我认为 auth cookie 的超时是安全级别的决定。如果您的站点是 SSL 安全的，您可能会有最小的超时值（用户会话将在几分钟内到期）。另一方面，对于具有非关键安全性的站点，您可以设置中等超时值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T06:54:10.477

例如，当我登录网上银行时，它会询问我是否在使用“公共终端”：如果我说是，那么它会执行更严格的安全性，或者如果不是，则更宽松。

# javascript - Ajax 使用文件上传

> ID：502375
> 
> 赞同：5
> 
> 时间：2009-02-02T06:32:12.567
> 
> 标签：javascript, html, ajax, upload

我正在创建用于发送邮件的邮件页面。我需要在发送前附加一些文件。我怎么能用 AJAX 做到这一点？最初我需要将这些文件存储在服务器中，然后我必须发送邮件。这些操作在一个发送按钮中完成。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-02T06:53:50.433

检查这些问题：

*   [JavaScript 文件上传](https://stackoverflow.com/questions/408735/javascript-file-uploads)
*   [如何为我的网络应用获取类似 Gmail 的文件上传？](https://stackoverflow.com/questions/135123/how-can-i-get-gmail-like-file-uploads-for-my-web-app)
*   [什么是最好的多文件 JavaScript / Flash 文件上传器？](https://stackoverflow.com/questions/207298/what-is-the-best-multiple-file-javascript-flash-file-uploader)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-15T12:40:32.710

查看下面的片段，它发送文本数据和附加的多文件。由`content-type='multipart/form-data'`浏览器自动设置，文件名也自动添加到`filename`FormData 参数中（并且服务器可以轻松读取）。

```
async function sendEmail() {
  let formData = new FormData();
  let msg = { message: emailText.value };

  formData.append("email", JSON.stringify(msg)); 
  [...attachment.files].map( (file,i) => formData.append("file"+i, file) );

  try {
    await fetch('your/api/upload/email', { method: "POST", body: formData });
    alert("Email was send!");
  } catch(e) {
    alert("Problem with email sending");
  }
}
```

```
<textarea id="emailText" placeholder="Type message here"></textarea><br>

<input type="file" id="attachment" multiple /><br><br>
<input type="button" value="Send email" onclick="sendEmail()" />

<br><br><span style="color:red">In this snippet API not exists so exception will be thrown but you can look on your request in:<br> chrome console> network tab</span>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T06:41:43.157

我希望你知道如何正常上传。使用 ajax 调用单击按钮时调用上传/读取和更新文件。您必须发送本地系统文件路径作为输入，然后响应应包含服务器中的路径或错误。如果没有错误，请使用响应更新附件链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T08:51:58.230

您应该在 DOM 中动态创建一个隐藏的 iframe，并将上传表单的目标设置为此 iframe。不要忘记将表单方法设置为 POST。

您可以一次性完成上传和消息字段填写。

您绝对应该为您选择的 javascript 库检查准备好的组件。

# .net - WPF 数据网格文本列中的绑定

> ID：502389
> 
> 赞同：27
> 
> 时间：2009-02-02T06:50:14.450
> 
> 标签：.net, wpf, data-binding, xaml, datagrid

我正在尝试构建一个数据网格，其中一列是以该字体显示的字体名称。以前，我正在使用一个列表框，我在其中定义了以下模板：

```
<TextBlock Text="{Binding Path=Name}" FontFamily="{Binding Path=Name}"/> 
```

这工作得很好。所以，我调整了数据结构（Name 变成了 Font.Name）并移动到数据网格上来试试这个：

```
<dg:DataGridTextColumn Binding="{Binding Font.Name}" 
    FontFamily="{Binding Font.Name}" IsReadOnly="True" Header="Font"/> 
```

现在字体名称都以默认字体显示，我得到这个错误：

```
System.Windows.Data Error: 2 : Cannot find governing FrameworkElement or 
FrameworkContentElement for target element. 
BindingExpression:Path=Font.Name; DataItem=null; target element is 
'DataGridTextColumn' (HashCode=56915998); target property is 'FontFamily' 
(type 'FontFamily') 
```

一些处理自定义控件的 Google 结果建议将属性从 DependencyObject 更改为 FrameworkElement，但我必须继承 DataGridTextColumn 并定义我自己的属性才能这样做 - 必须有更好的方法。

我尝试了几种不同的绑定方法，包括尝试在我的数据类中使用不同的属性（即`FontSize="{Binding FontSize}"`）仅更改字体大小。他们都导致了与上述相同的错误。

有人知道我在这里做错了什么吗？

**编辑：**

感谢Jared的回复，我发现了以下内容：

[https://docs.microsoft.com/en-us/archive/blogs/jaimer/forwarding-the-datagrids-datacontext-to-its-columns](https://docs.microsoft.com/en-us/archive/blogs/jaimer/forwarding-the-datagrids-datacontext-to-its-columns)

该方法看起来不错，但我需要为每一行创建一个引用 DataContext 中正确元素的绑定，而不是为整个列共享一个值。

后面的代码：

```
fontDataGrid.DataContext = from font 
    in new InstalledFontCollection().Families; 
```

XAML：

```
Binding="{Binding Font.Name}"
FontFamily="{Binding (FrameworkElement.DataContext).Font.Name, 
    RelativeSource={x:Static RelativeSource.Self}}" 
```

使用上面的 XAML 显然是不正确的，因为 DataContext 是整个字体集合。但我无法索引集合，因为我不知道行号是什么（或者我知道吗？）。有什么方法可以用来实现这一目标吗？

还有一个次要问题 - 为什么 Binding 属性似乎工作得很好，即使没有 DataContext？它是在看 ItemsSource 吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-03T00:31:10.937

Jared 的回答是正确的，但我找到了解决我问题的具体解决方案。

[http://blogs.msdn.com/vinsibal/archive/2008/12/17/wpf-datagrid-dynamically-updating-datagridcomboboxcolumn.aspx](http://blogs.msdn.com/vinsibal/archive/2008/12/17/wpf-datagrid-dynamically-updating-datagridcomboboxcolumn.aspx)

按照此示例，我将 DataGridTextColumn 定义更改为：

```
<dg:DataGridTextColumn Binding="{Binding Font.Name}" IsReadOnly="True" Header="Font">
    <dg:DataGridTextColumn.ElementStyle>
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="{Binding Font.Name}" />
        </Style>
    </dg:DataGridTextColumn.ElementStyle>
</dg:DataGridTextColumn> 
```

而且我不需要担心继承DataContext的列。这给了我想要的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T14:45:40.683

尝试

```
TextBlock.FontFamily="{Binding Font.Name}" 
```

有时绑定系统在查找属性声明的位置时遇到问题，因此您需要为其提供一些帮助。

# jquery-ui - jQuery 选项卡 - 仅在单击时加载内容

> ID：502391
> 
> 赞同：15
> 
> 时间：2009-02-02T06:52:16.660
> 
> 标签：jquery-ui, jquery, tabs

我对 jQuery 和 Web 开发比较陌生。

我正在使用 jQuery UI 选项卡来创建选项卡。

但是我希望仅在选择特定选项卡时才加载内容。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-02T07:16:09.670

好的，我假设当用户单击选项卡时，您打算通过 AJAX 动态获取内容。这实际上涉及两件事，**甚至为您的选项卡设置 onclick**并**通过 ajax 获取数据**。

**设置 onclick 事件**

给你的标签一个类，例如*my_tab*。假设当用户单击选项卡时，您希望*触发 handle_tab_click()*函数。这是将*onclick*事件绑定到*my_tab*选项卡的示例：

```
$(".my_tab").bind("click", handle_tab_click); 
```

您的*handle_tab_click()*函数将获得一个*事件*参数，该参数能够为您提供有关触发事件的元素（在本例中为类名为*my_tab*的元素）的信息。

```
function (event) {
    if ($(event.target).hasClass("my_tab")) { /* handle tab click */ }
    if ($(event.target).hasClass("my_tab_2")) { /* a different tab click */ }
    if ($(event.target).hasClass("my_tab_3")) { /* ... */ }
} 
```

[在此处](http://docs.jquery.com/Events/bind#typedatafn)查看 JQuery*事件*文档以获取更多详细信息。

**通过ajax获取数据**

获取数据将要求您调用远程脚本，同时提供有关单击了哪个选项卡的信息（以便获取适当的信息）。在下面的代码片段中，我们调用远程脚本*myscript.php*，提供 HTTP GET 参数*tab_clicked=my_tab*并在脚本返回时调用函数*tab_fetch_cb 。*最后一个参数是返回的数据类型（由您选择）。

```
$.get("myscript.php", {tab_clicked, "my_tab"}, tab_fetch_cb, "text/json/xml") 
```

由您来设计*myscript.php*来处理*tab_clicked*参数，获取适当的数据并将其返回（即，将其写回客户端）。

这是*tab_fetch_cb*的示例：

```
function tab_fetch_cb(data, status) {
    // populate your newly opened tab with information 
    // returned from myscript.php here
} 
```

您可以在此处阅读有关 JQuery *get*函数的更多信息，并[在此处](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)阅读有关JQuery ajax 函数的更多[信息](http://docs.jquery.com/Ajax)

很抱歉，我无法在示例中更具体，但很多处理确实取决于您的任务。正如它已经指出的那样，您可能会寻找一些 JQuery 插件来解决您的问题。话虽如此，学习如何使用 JQuery 手动完成这些工作永远不会受到伤害。

祝你好运。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-02T06:56:57.260

UI/Tabs 支持通过 Ajax 按需加载选项卡内容，请查看[此](http://docs.jquery.com/UI/Tabs#Ajax_mode)示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T06:59:56.847

通过 Ajax 加载内容增加了处理书签/浏览器后退按钮的复杂性。根据您的情况，您应该考虑使用整页请求加载新内容。处理书签/浏览器返回涉及使用在 URL 中添加锚信息。

此外，请查看[LavaLamp](http://www.gmarwaha.com/blog/?p=7)以进行选项卡选择。它看起来很漂亮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-15T21:58:23.457

默认情况下，选项卡小部件将在 onClick 选项卡部分之间交换，但可以通过选项将事件更改为 onHover。通过在选项卡上设置 href，可以通过 Ajax 加载选项卡内容。

来源：[http ://docs.jquery.com/UI/Tabs](http://docs.jquery.com/UI/Tabs)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-03T13:30:10.743

如果你使用 Rails，你可以试试这个 gem [bettertabs](https://github.com/agoragames/bettertabs)

它支持 ajax 选项卡。

# php - 在 php 应用程序中拒绝访问 IIS 7 中的特定文件夹

> ID：502393
> 
> 赞同：0
> 
> 时间：2009-02-02T06:53:23.320
> 
> 标签：php, configuration, iis-7

我有一个在 IIS7 上运行的 PHP 应用程序。我想通过修改来保护特定文件夹`web.config`。我不想`<location>`在配置中使用标签，因为这会将用户重定向到登录页面。相反，我想实施`HttpNotFoundHandler`.

例如，[http](http://domain.com/SecureFolder) ://domain.com/SecureFolder是我要实现的目录`HttpNotFoundHandler`。当用户尝试访问该文件夹时，应显示 404 页面。

安全文件夹只能通过子域访问。下面是我正在尝试做的配置文件，但这不起作用。

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings />
  <appSettings />
    <system.web>
      <customErrors mode="RemoteOnly"></customErrors>
      <httpHandlers>
        <add path="~/securefolder" verb="*" type="System.Web.HttpNotFoundHandler" validate="true"/>
      </httpHandlers>
    </system.web>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T07:03:33.173

您将需要通配符映射。查看：http: [//blogs.iis.net/ruslany/archive/2008/09/30/wildcard-script-mapping-and-iis-7-integrated-pipeline.aspx](http://blogs.iis.net/ruslany/archive/2008/09/30/wildcard-script-mapping-and-iis-7-integrated-pipeline.aspx)

从那里，您可以解析 url 并确定是否应该抛出 404。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T19:50:43.263

您可以使用[URL 重写模块](http://learn.iis.net/page.aspx/465/url-rewrite-module-configuration-reference/)来编写自定义响应操作。

> CustomResponse 操作使 URL 重写模块使用用户指定的状态代码、子代码和原因来响应 HTTP 客户端。使用 CustomResponse 操作意味着在执行此操作后不会为当前 URL 评估后续规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-23T20:03:53.260

实际上，我的建议是在 IIS 级别执行此操作，而使用专为请求过滤而设计的功能。您可以添加一个配置文件，如：

```
<configuration>
 <system.webServer>
    <security>
      <requestFiltering>
                <hiddenSegments>
                    <add segment="securefolder" />
                </hiddenSegments>
      </requestFiltering>
    </security>
 </system.webServer>
 </configuration> 
```

请参阅：[请求过滤以获取更多信息](http://www.iis.net/learn/manage/configuring-security/use-request-filtering)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-14T11:11:38.790

路径不应该是这样的`path="securefolder/*.*"`吗？

我在 IIS6 上工作，但仍然没有分配给 ASP.NET ISAPI 过滤器的文件扩展名由 IIS 提供（即 *.txt），所以我必须将 .txt 分配给 IIS 上的 ASP.NET ISAPI 过滤器。

# emacs - 你如何学习正确的 Emacs？

> ID：502399
> 
> 赞同：62
> 
> 时间：2009-02-02T06:57:47.990
> 
> 标签：emacs, editor, workflow

我即将学习 Emacs，已经通过教程并借用了 O'Reilly 关于 Emacs 的书。但问题仍然是——如何学习好的 Emacs*工作流程*？我想，你不会像你使用的那样使用 Emacs，例如[Vim](http://en.wikipedia.org/wiki/Vim_%28text_editor%29)。

这个问题对我来说似乎很重要： -[我在哪里可以找到使用 Emacs 的专业人士的视频？](https://stackoverflow.com/questions/140336)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-05T23:59:21.653

我不敢相信没有人提到这一点，但是阅读与 Emacs 捆绑的信息页面是了解晦涩功能的好方法。每当您需要中断编码时，请点击`M-x info`并选择一个随机页面进行阅读。你的 emacs 能力会以惊人的速度提高。

了解 emacs 的自我文档化如何帮助您工作也很重要。比如说，你想知道如何缩放字体大小。你可以问 emacs，而不是打断你的流程并在这里、或在 IRC 或 Google 上提问！在我们的例子中，只需点击`C-h a`( `M-x command-apropos`) 并输入搜索词`scale`。如果有匹配的函数，它们的名称、键绑定和文档将出现。有，现在你刚刚发现`text-scale-increase`和`text-scale-decrease`。

还有其他值得学习的自我文档功能`C-h m`将告诉您当前主要和次要模式中可用的键绑定和命令。这是发现您不知道的功能的好方法。

“通过渗透学习”的另一种方法是`M-x customize-group`针对您经常使用的模式。（`customize`是几乎所有模式都支持的交互式配置编辑器。）

最后要做的是学习 Emacs Lisp。使用现有工具很好，但有时您需要自己的工具。如果你试图避免学习 Lisp，你将总是被一些不太正常的东西所困扰，这是一种耻辱。

Emacs 是一个很好的自定义环境。Emacs 包括两个 Lisp 手册，可以通过`M-x info`. 它是自记录的，因此您可以说`C-h f`或`M-x describe-function`获取任何功能的文档。您甚至可以按`TAB ENT`跳转到该函数的源代码，看看它是如何实现的。当您认为“我希望我有类似的东西`foo`，但只是略有不同”时，这很棒。您可以阅读如何`foo`实现，在缓冲区中进行更改`*scratch*`，然后查看您是否喜欢更改。没有编辑/编译/测试周期。您按下一个键，您的 emacs 会话立即具有您刚刚编写的功能。

你在学习 emacs 上付出的努力越多，emacs 就越能让你的工作更轻松。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-02-02T07:43:10.833

一旦掌握了基础知识（打开/关闭文件、导航、基本编辑），就可以使用它。与许多其他工具一样，熟能生巧...

但是，我会留出一些时间来改进您当前使用编辑器的方式，但作为您正常工作流程的一部分，而不是仅仅为了它而去切线并学习东西。

我发现一些有用的资源是[EmacsWiki](http://www.emacswiki.org/)和[Planet Emacsen 博客](http://planet.emacsen.org/)。我同时使用这两种方法，主要是使用 Planet Emacsen 来获得“灵感”，然后浏览 EmacsWiki 并在那里搜索特定主题。我发现，除非你至少对你要找的东西有一个模糊的概念，否则可用的信息只会让你不知所措，而不是真正有用。

更不用说 StackOverflow 上有一些非常有用的资源，例如[这里的问题](https://stackoverflow.com/questions/298065/which-are-the-gnu-emacs-modes-extensions-you-cant-live-without/299003#299003)。Emacs 是一个非常强大的工具，它往往能够做的比一个人需要的要多得多，但最终它允许你准确地挑选*你*需要的那些部分。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-02T11:37:01.280

我的建议是停止使用除 Emacs 之外的任何东西，当你遇到问题时，看看你是否可以在 Emacs 中解决它，然后再退回去（如果你没有时间或者它不起作用）。至于工作流程，它与您通常的工作几乎相同。即对于正常的 ide 会话，您可以正常打开/编辑文件，然后正常提交（在 Cx vv 中）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-02T19:40:36.843

我同意这里的其他海报，你只需要使用它！我是这样做的：

一旦我掌握了非常基础的知识（可以在缓冲区之间切换、打开/保存文件等），我就打印了一张参考卡并放在手边。[这是一个很好的](https://logicalchaos.com/stuff/emacsref.pdf)。回顾一下，这样你就知道上面有什么，然后每当你发现自己重复做卡片上的事情时，开始使用快捷方式！在不知不觉中，您将记住相当多的命令。但是请记住，可能没有人使用 emacs 可以做的所有事情。

当你最终发现自己重复做一些没有快捷方式的事情时，这是学习键盘宏的好时机。一旦你得到它们，你会发现它们无处不在！从那里开始编写 elisp （如果您是程序员）是一个短暂的跳跃。

emacs 的伟大之处在于**您不需要“emacs 工作流程”，emacs 围绕您的工作流程工作！**

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-02T07:11:28.353

您无需学习 emacs 工作流程。完成本教程并掌握基本知识后，您将不得不采用某种程度的一夫一妻制，并且只使用 Emacs。最终你会想到你真正希望存在的功能；大多数时候其他人也会有，解决方案只是一次搜索！随着时间的推移，你会情不自禁地学习，最终你会学到足够的东西来开发自己的个人工作流程。

如果您希望加快这个过程，Emacs wiki 提供了各种技巧，但实际上最好的方法就是使用 Emacs 做事。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-02T08:02:35.380

你可以看看 Bram Molenaar 关于高效文本编辑的演讲，[http://video.google.com/videoplay?docid=2538831956647446078&ei=EqiGSau8KZ-QiQLi-Nn8Cg&q=bram+molenaar+editing](http://video.google.com/videoplay?docid=2538831956647446078&ei=EqiGSau8KZ-QiQLi-Nn8Cg&q=bram+molenaar+editing)

尽管他是一个 vim 人（他写的），但您可能会了解如何最好地使用适用于 emacs 的文本编辑器变得更加熟练。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-02T07:27:20.020

老实说，我所做的只是学习我需要的键绑定。我没有充分发挥 emacs 的潜力，因为我不需要它的全部潜力。我的建议是只学习你需要的东西，不要担心你不需要的东西。每天学习一个新的键绑定，大约 300 年后你会全部了解它们；）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T12:31:01.250

As previously stated, the best advice is to use nothing but Emacs for the next year. Once you develop your finger memory, things get to be much easier.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-05T06:07:33.630

您如何为任何事情学习“良好的工作流程”？通过使用它，了解它，让它成为你的。没有“正确”使用 Emacs。

至于了解它：*询问 Emacs——*使用它的帮助系统。这也有帮助：[http ://www.emacswiki.org/emacs/EmacsNewbieWithIcicles](http://www.emacswiki.org/emacs/EmacsNewbieWithIcicles)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-02T08:01:12.217

从以前的 Amiga 时代开始，我就在我目前正在使用的所有平台上使用 emacs。

使用 emacs 的最佳方式是好奇心。我仍然经常使用 apropos (Ch a) 和 Mx（用于长函数名而不是键绑定）来查找功能。

“正确使用” Emacs 的一个关键概念是，学习非常简单的 elisp（lisp 的简单派生）并编写自己的小帮手（自己的注释样式、下划线、模板）并知道在哪里更改值（制表符大小、编译器、电子邮件）

第三件事：一切都在 emacs 中：我使用 dired（目录编辑器）来浏览文件。我为所有文本文件使用了很多缓冲区（每种类型的文件（c、ruby、list、sql、latex、...）都有适当的模式），这些文件在退出 emacs 时存储并在调用时恢复。我从 emacs 启动编译器并使用跳转到错误功能。

宏是日常生活（浏览代码并在途中更改）。

我喜欢图片模式，它允许通过替换向下键入，这使得重新编号常量块变得容易（好老的 c #defines））

有一座高山要爬，但如果你登顶了，你可以从脚下看到整个世界，再也不想错过这种体验。我知道，周围有很多优秀的编辑器（我自己通过 Eclipse 工作）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-02T07:10:20.430

这就是 Emacs 的强大之处，您可以随心所欲地使用它。您只需根据自己的喜好进行配置。

# c# - 在运行时更改连接字符串并重新加载 app.config

> ID：502411
> 
> 赞同：55
> 
> 时间：2009-02-02T07:07:54.180
> 
> 标签：c#, configuration

当我使用此代码更改连接字符串时，它不会`app.config`在运行时重新加载。我希望它重新加载类似于我们如何重新加载`app.config`。

```
config.ConnectionStrings.ConnectionStrings["JVVNL_NEW.Properties.Settings.JVVNL_NEWConnectionString1"].ConnectionString = ConString;
config.ConnectionStrings.ConnectionStrings["CMS_NEW.Properties.Settings.JVVNL_NEWConnectionString1"].ConnectionString = ConString;
config.Save(ConfigurationSaveMode.Modified,true);
ConfigurationManager.RefreshSection(config.ConnectionStrings.SectionInformation.SectionName); 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-01-09T22:45:19.807

不得不做这件事。这是对我有用的代码：

```
var config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
var connectionStringsSection = (ConnectionStringsSection)config.GetSection("connectionStrings");
connectionStringsSection.ConnectionStrings["Blah"].ConnectionString = "Data Source=blah;Initial Catalog=blah;UID=blah;password=blah";
config.Save();
ConfigurationManager.RefreshSection("connectionStrings"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-02T07:42:10.430

IIRC， ConfigurationManager.RefreshSection 需要一个字符串参数，指定要刷新的部分的名称：

```
ConfigurationManager.RefreshSection("connectionStrings"); 
```

我认为 ASP.NET 应用程序应该在 ConnectionStrings 元素被修改时自动重新加载，并且不需要手动重新加载配置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-04T06:33:06.347

```
//You can apply the logic in "Program.cs"

//Logic for getting new connection string
//****
//

MyDBName="mydb";

//
//****

//Assign new connection string to a variable
string newCnnStr = a="Data Source=.\SQLExpress;Initial Catalog=" + MyDBName + ";Persist Security Info=True;User ID=sa;Password=mypwd";

//And Finally replace the value of setting
Properties.Settings.Default["Nameof_ConnectionString_inSettingFile"] = newCnnStr;

//This method replaces the value at run time and also don't needs app.config for the same setting. It will have the va;ue till the application runs.

//It worked for me. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T08:06:18.757

是的，当 ASP.NET web.config 得到更新时，整个应用程序会重新启动，这意味着 web.config 会重新加载。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T09:55:15.543

您还可以完整地刷新配置：

```
ConnectionStringSettings importToConnectionString = currentConfiguration.ConnectionStrings.ConnectionStrings[newName];

if (importToConnectionString == null)
{
    importToConnectionString = new ConnectionStringSettings();
    importToConnectionString.ConnectionString = importFromConnectionString.ConnectionString;
    importToConnectionString.ProviderName = importFromConnectionString.ProviderName;
    importToConnectionString.Name = newName;
    currentConfiguration.ConnectionStrings.ConnectionStrings.Add(importToConnectionString);
}
else
{
    importToConnectionString.ConnectionString = importFromConnectionString.ConnectionString;
    importToConnectionString.ProviderName = importFromConnectionString.ProviderName;
}

Properties.Settings.Default.Reload(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-25T13:04:13.627

首先，您可能要添加

```
using System.Configuration; 
```

到您的 .cs 文件。如果它不可用，请通过项目引用添加它，因为默认情况下它不包含在新项目中。

这是我对这个问题的解决方案。首先，我创建了 ConnectionProperties 类，它将我需要更改的项目保存在原始连接字符串中。ConnectionProperties 类中的 _name 变量作为 connectionString 的名称很重要。第一个方法采用连接字符串并使用新值更改您想要的选项。

```
private String changeConnStringItem(string connString,string option, string value)
    {
        String[] conItems = connString.Split(';');
        String result = "";
        foreach (String item in conItems)
        {
            if (item.StartsWith(option))
            {
                result += option + "=" + value + ";";
            }
            else
            {
                result += item + ";";
            }
        }
        return result;
    } 
```

您可以更改此方法以适应您自己的需要。我有 mysql 和 mssql 连接，所以我需要它们。当然，您可以自己完善此代码草案。

```
private void changeConnectionSettings(ConnectionProperties cp)
{
     var cnSection = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
     String connString = cnSection.ConnectionStrings.ConnectionStrings[cp.Name].ConnectionString;
     connString = changeConnStringItem(connString, "provider connection string=\"data source", cp.DataSource);
     connString = changeConnStringItem(connString, "provider connection string=\"server", cp.DataSource);
     connString = changeConnStringItem(connString, "user id", cp.Username);
     connString = changeConnStringItem(connString, "password", cp.Password);
     connString = changeConnStringItem(connString, "initial catalog", cp.InitCatalogue);
     connString = changeConnStringItem(connString, "database", cp.InitCatalogue);
           cnSection.ConnectionStrings.ConnectionStrings[cp.Name].ConnectionString = connString;
     cnSection.Save();
     ConfigurationManager.RefreshSection("connectionStrings");
} 
```

因为我不想添加琐碎的信息，所以我省略了代码的 Properties 区域。如果您希望它起作用，请添加它。

```
class ConnectionProperties
{
    private String _name;
    private String _dataSource;
    private String _username;
    private String _password;
    private String _initCatalogue;

    /// <summary>
    /// Basic Connection Properties constructor
    /// </summary>
    public ConnectionProperties()
    {

    }

    /// <summary>
    /// Constructor with the needed settings
    /// </summary>
    /// <param name="name">The name identifier of the connection</param>
    /// <param name="dataSource">The url where we connect</param>
    /// <param name="username">Username for connection</param>
    /// <param name="password">Password for connection</param>
    /// <param name="initCat">Initial catalogue</param>
    public ConnectionProperties(String name,String dataSource, String username, String password, String initCat)
    {
        _name = name;
        _dataSource = dataSource;
        _username = username;
        _password = password;
        _initCatalogue = initCat;
    }
// Enter corresponding Properties here for access to private variables
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-04T15:22:21.200

//这里是如何在 Windows App.Config 中执行此操作

```
public static bool ChangeConnectionString(string Name, string value, string providerName, string AppName)
    {
        bool retVal = false;
        try
        {

            string FILE_NAME = string.Concat(Application.StartupPath, "\\", AppName.Trim(), ".exe.Config"); //the application configuration file name
            XmlTextReader reader = new XmlTextReader(FILE_NAME);
            XmlDocument doc = new XmlDocument();
            doc.Load(reader);
            reader.Close();
            string nodeRoute = string.Concat("connectionStrings/add");

            XmlNode cnnStr = null;
            XmlElement root = doc.DocumentElement;
            XmlNodeList Settings = root.SelectNodes(nodeRoute);

            for (int i = 0; i < Settings.Count; i++)
            {
                cnnStr = Settings[i];
                if (cnnStr.Attributes["name"].Value.Equals(Name))
                    break;
                cnnStr = null;
            }

            cnnStr.Attributes["connectionString"].Value = value;
            cnnStr.Attributes["providerName"].Value = providerName;
            doc.Save(FILE_NAME);
            retVal = true;
        }
        catch (Exception ex)
        {
            retVal = false;
            //Handle the Exception as you like
        }
        return retVal;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-22T20:10:25.737

这是我使用的方法：

```
public void AddOrUpdateAppConnectionStrings(string key, string value)
{
    try
    {
        var configFile = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
        var settings = configFile.ConnectionStrings.ConnectionStrings;
        if (settings[key] == null)
        {
            settings.Add(new ConnectionStringSettings(key,value));
        }
        else
        {
            settings[key].ConnectionString = value;
        }
        configFile.Save(ConfigurationSaveMode.Modified);
        ConfigurationManager.RefreshSection(configFile.ConnectionStrings.SectionInformation.Name);
        Properties.Settings.Default.Reload();
    }
    catch (ConfigurationErrorsException)
    {
        Console.WriteLine("Error writing app settings");
    }
} 
```

# apache-flex - 您如何以编程方式将 Flex TextArea 的插入符号移到末尾？

> ID：502414
> 
> 赞同：6
> 
> 时间：2009-02-02T07:08:24.037
> 
> 标签：apache-flex, flex3, textarea, textfield, caret

在从我的代码中附加一些文本后，我试图将 Flex TextArea 中的插入符号移到末尾。我查看了 TextArea 及其基础 TextField 的参考文档，但似乎没有提供处理此问题的方法。

我尝试过的一种方法是将焦点设置到文本区域并调度 KeyUp KeyboardEvent 并将事件的键代码设置为“结束”键，但这不起作用。

关于如何做到这一点的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-02T07:24:22.633

试试这个

```
textArea.selectionBeginIndex = textArea.length;
textArea.selectionEndIndex = textArea.length; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-02-21T22:08:20.297

对于寻找 Spark 组件方式的人来说，Flex 4.5，使用`selectRange(anchorIndex, activeIndex)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-17T10:54:57.207

要将插入符号设置在 textArea 中的任何位置，您需要做的就是

textArea.setSelection(beginIndex, endIndex);

如果您将 beginIndex 和 endIndex 设置为相同的值（在您的情况下为 textArea.text.length），插入符号将放置在该位置。如果将其设置为不同的值，则该范围内的文本将突出显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T19:31:17.050

我相信你可以直接设置textarea的滚动条

```
verticalScrollPosition : Number
textArea.verticalScrollPosition(i); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-17T13:48:48.587

@Paul Stewart verticalScrollPosition 是属性而不是方法，因此您必须像使用字段一样使用它，例如：

```
var newPosition:NUmber = 1;
textArea.verticalScrollPosition = newPosition; 
```

使用它而不是 selectionBeginIndex/selectionEndIndex 的优点是您不必设置焦点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-24T14:15:51.207

将文本添加到 TextArea 后，只需添加以下代码：

```
textArea.verticalScrollPosition = textArea.maxVerticalScrollPosition; 
```

# linq - 如何在单个 linqToSql 语句中使用 subquery、groupby、max 和 top？

> ID：502415
> 
> 赞同：3
> 
> 时间：2009-02-02T07:08:32.120
> 
> 标签：linq, linq-to-sql

使用 LinqToSql，我需要为连接表 (CL) 中的最新 modDate 返回一个 (L)。

表：
L (Lid, meta1, meta2, ...)
CL (Cid, Lid, ModDate)

这是产生预期结果的sql

```
SELECT l.*
FROM L l
INNER JOIN (
    SELECT TOP 1 cl.Lid, MAX(cl.ModDate) as ModDate
    FROM CL cl
    INNER JOIN L l ON cl.Lid = l.Lid AND l.meta1 = 5
    GROUP BY cl.Lid
    ORDER BY MAX(cl.ModDate) DESC
) As m ON l.Lid = m.Lid 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T19:23:16.223

很简单。子查询将我们投射到 id。该查询获取那些具有匹配 id 的记录。

```
var subquery = db.L
    .Where(L => L.meta1 = 5)
    .SelectMany(L => L.CLs)
    .GroupBy(CL => CL.Lid)
    .OrderByDescending(g => g.Max(CL => CL.ModDate))
    .Select(g => g.Key)
    .Take(1)

var query = db.L
  .Where(L => subquery.Any(id => L.Lid == id)) 
```

进一步考虑这一点，您可以摆脱子查询：

```
var query = db.L
  .Where(L => L.meta1 = 5)
  .SelectMany(L => L.CLs)
  .GroupBy(CL => CL.Lid)
  .OrderByDescending(g => g.Max(CL => CL.ModDate))
  .Select(g => g.First().L); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T07:31:31.993

我的 SQL-fu 不是很好，而且是在我第一次喝咖啡之前，所以我假设外部查询中的“l”最终与子查询中的“l”完全不同？

我*认为*这样做可以，但是您必须尝试确定:) 检查生成的 SQL 的外观非常值得。如果您不介意它作为两个查询执行，当然，它会更简单一些。

```
// Can't do the "Take(1)" here or it will be executed separately
var subquery = from cl in context.CL
               join l in context.L on cl.Lid = l.Lid
               where l.meta1 = 5 // could put this in join clause
               group cl.ModDate by cl.lid into grouped
               order by grouped.Max() descending
               select grouped.Key;

// But can take the first result of the join
// This may be simpler using dot notation instead of a query expression
var query = (from l in context.L
            join lid in subquery
            select l).Take(1); 
```

（编辑：我之前没有采用最大 ModDate。Doh。还通过使用 ID 作为键（它已经是）简化了分组，所以我们只需要 ModDate 作为组值。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T08:02:08.500

作为您提供的查询，我可以解释为这个 Linq。

```
var query = from l in Context.L
            join m in (from cl in Context.CL
                       join l in Context.L on cl.Lid equals l.Lid 
                       where l.meta1 == 5
                       group new { l.Lid, cl.ModDate } by cl.Lid into grp
                       select new { Lid = grp.Key, ModDate = grp.Max(g => g.ModDate) }  into grp
                       order by grp.ModDate descending
                       select grp).Take(1) on l.Lid equals m.Lid
            select l; 
```

# jquery - 集成另一个库时 jQuery 中的等效代码

> ID：502420
> 
> 赞同：0
> 
> 时间：2009-02-02T07:14:16.507
> 
> 标签：jquery, ajax, mootools

我正在使用[MooTools](http://en.wikipedia.org/wiki/MooTools) 1.11 和[jQuery](http://en.wikipedia.org/wiki/JQuery) 1.2。以下代码的 Ajax 函数无法正常工作。

```
jQuery(document).ready(function($) {
    confirm("Hello");
    function confirm(message){
        $.ajax({
            url: 'ajax.php',
            ....
        });
     }
}); 
```

我应该做哪些修改才能正确执行 Ajax 功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T14:12:59.127

[`confirm`](http://www.tizag.com/javascriptT/javascriptconfirm.php)是一个内置函数（保留名称）...尝试为它使用不同的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T07:24:55.847

或者也许（未经测试）您可以使用：

```
jQuery(document).ready(function(jQuery.noConflict(true)) { 
```

而且还在`$`里面使用。

# php - 如何在 PHP 中实现“谁在线”功能？

> ID：502427
> 
> 赞同：4
> 
> 时间：2009-02-02T07:18:45.703
> 
> 标签：php, mysql, timestamp, connection, membership

如何使用 PHP 实现“谁在线”功能？当然，这将涉及使用时间戳，并且在查看 phpBB 的会话表之后，可能涉及将最新访问存储在数据库中。

这是一种有效的方法，还是有更好的方法来实现这个想法？

**编辑**：我无意中创建了这个社区 wiki，因为当时我还是 Stack Overflow 的新手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T07:25:04.673

使用数据库来跟踪每个登录的人几乎是做到这一点的唯一方法。

我要做的是，在表中或当有人登录时插入一行包含用户信息和时间戳的行，并在每次与该用户有活动时更新时间戳。我会假设在过去 5 分钟内进行过活动的所有用户当前都在线。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T07:34:10.040

根据您实施（以及是否实施）会话的方式，您可以使用相同的存储媒体来获取活动用户的数量。例如，如果您使用基于文件的会话模型，只需扫描包含会话文件的目录并返回会话文件的数量。如果您使用数据库存储会话数据，则返回会话表中的行数。当然，这是假设您对会话的超时值感到满意（即，如果您的会话有 30 分钟的超时，您将获得最近 30 分钟内的活跃用户列表）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-10T08:02:48.153

我想这样做：

当用户登录时，他的用户 ID 和时间戳将被插入到一个表中。然后每隔 5 分钟，我将通过 ajax 调用一个 php 脚本来检查用户是否已登录，如果是，则更新他在表中的时间戳。

如果用户没有登录，只需删除他的记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-07T02:42:42.743

有很多方法可以实现这一点。

您可以简单地通过轮询来实现这一点。

每隔一定时间检查客户端，统计回复的客户端数量。

该值可以用作在线用户数。

我认为更好的方法是使用推送技术，而不是每隔 x 秒或 x 分钟检查一次在线用户。

它只是让服务器知道人们何时进入和离开事件。

因此，当事件来自客户端时，服务器只是增加和减少在线用户计数变量。

我推荐[Socket.IO](http://socket.io)，[APE](http://ape-project.org)看看。

还有许多其他需要考虑的，例如[XMPP](http://xmpp.org)、[Jabber](http://jabber.org)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-05T04:33:27.063

我想你可以简单地用 php

创建表用户包括，用户名，密码和状态（1,0）

1.  在登录系统中分析用户名和密码
2.  然后如果用户名和密码匹配，运行查询从表用户中选择，并获取它
3.  然后获取状态
4.  更新用户，设置状态为1，表示在线
5.  当你点击注销时，分析会话用户名和密码，选择从tbl用户查询并得到状态，然后将状态设置为0表示离线。

# java - 将“const”变量传递给Java中的方法

> ID：502430
> 
> 赞同：12
> 
> 时间：2009-02-02T07:20:27.103
> 
> 标签：java, c++, syntax, constants

Java 中是否存在与 C++ 中传递 const 引用的等价物？
在方法签名方面是否遗漏了“常量”误导？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-02T07:44:31.640

不，没有。

Java“final”不完全等同于 C++“const”。以下（最终变量的延迟初始化）在 Java 中有效：

```
final double x;
int w = 1;
if (w > 2)
{
    x = 0.5;
}
else
{
    x = - 0.5;
} 
```

但它不适用于将“final”替换为“const”的 C++。

在方法声明中的变量上使用“final”在 Java 中可能很有用，因为允许您在方法内创建的任何匿名类中使用此变量。

PS。我最初对 Java 中缺少“const”感到失望，但后来学会了接受“final”。

PS2。该线程中链接到的 Java 词汇表 ( [http://mindprod.com/jgloss/immutable.html](http://mindprod.com/jgloss/immutable.html) ) 有一个问题：不，您没有 100% 保证最终变量不会改变其值：

1）它从“未定义”变为“已定义”，但编译器会告诉你是否在初始化之前引用它

2) 在 Linux 上，存储在寄存器中时 double 具有 80 位精度，但存储在内存中时具有 64 位精度。当最终的 double 变量被推出寄存器时，它将被截断并更改其值。正如乔尔·斯波尔斯基（Joel Spolsky）所说，“抽象出现了漏洞”。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-02T07:39:52.647

Java 没有 C++ 的 const 概念。这是一些争论的焦点，尽管有趣的是 .NET 也没有。我相信原因是：

*   获得可理解的语法变得非常棘手（IMO） - 区分可变 StringBuilders 的 const 列表和 const StringBuilders 等的可变列表之间的区别是困难的。（我当然发现在 C++ 中很难，尽管这可能是由于缺乏实践。）
*   我强烈怀疑允许在托管语言中抛弃常量是不可接受的。这将违背整个事情的本质。在许多情况下，这可能会使他们更难合作。
*   在执行时传播有关 constness 的信息（以避免它被丢弃的可能性）在性能方面可能很困难和/或昂贵
*   由于 Java（和 .NET）过去没有 constness，因此在游戏后期引入它是*非常*困难的 - 除非所有常见的库都支持它（并且每一步都*正确*！）你最终会得到一个令人讨厌的混搭，如果您需要使用两个库，其中一个不知道 constness 而另一个只提供 const 值，则确实可能完全不可行。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-02T08:52:16.153

顺便说一句：Java 确实有*const*作为关键字，但你不能在任何地方使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T07:31:04.053

请参阅此以在 Java 中实现此目的：Java 中的 [不可变对象](http://www.javamex.com/java_equivalents/const_java.shtml)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T07:57:05.873

如上所述，Java 中没有 const。但是当我们想在 Java 中实现“接近”相同的结果时，我们使用

```
public static final Object x = somedata; 
```

这会在该点设置数据并暴露抽象泄漏等，您可以获得尽可能接近的等价物。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T07:36:16.867

最接近的 Java 等价物`const`是`final`.

```
void func(final SomeClass x) {
  // The following causes a compiler error
  x = ...;

  // The following works. If you don't want it to, then you have to make
  // somevar final or write a getter (but not a setter) for it in SomeClass.
  x.somevar = ...;
} 
```

# html - HTML 标签中的条件格式

> ID：502431
> 
> 赞同：10
> 
> 时间：2009-02-02T07:21:08.990
> 
> 标签：html

是否有任何选项可以在 HTML 标记中使用 IF-ELSE 条件

```
 <if true>  do something   </if>  
 <else>     do something   </else> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-02T07:30:58.237

有，但[实际上只在IE](http://www.quirksmode.org/css/condcom.html)中用于区分不同版本：

```
<!--[if IE6]>
    Things here!
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-02T07:28:44.667

不要迂腐，但 HTML 是一种标记语言，对条件逻辑没有用处。

话虽如此，听起来您正在寻找的是一些javascript。如果您可以为您的问题添加更多细节，我可以详细说明如何使用 javascript 执行具有条件逻辑的任务。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-02T07:32:20.183

HTML 是为文档布局而设计的，因此 noscript 和 noframes 与 HTML 处理条件语句差不多。你可以想象用 javascript 来解决这个问题。

```
<div id='if-part' style='visibility: hidden;'>do something</div>
<div id='else-part' style='visibility: hidden'>do something</div>

<script>
    var node;
    if(true) {
        node = document.getElementById('if-part');
    }
    else {
        node = document.getElementById('else-part');
    }
    node.style.visibility = 'visible';
</script> 
```

当然，这仅在客户端打开了 javascript 时才有效。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-02T07:33:12.897

HTML 的条件渲染并不是一个新概念，但它不能完全使用 HTML 来完成。您需要使用客户端脚本或服务器端代码来提供相应地呈现 HTML 的条件逻辑。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T14:54:35.313

As has been said in other posts, HTML does not support conditional logic. You have two choices here:

1) Generate the HTML dynamically using technologies such as PHP or XSLT

2) Modify the HTML DOM after the fact using Javascript

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-21T18:12:57.467

你有没有写过电子邮件？你所有的java脚本都被谷歌剥离了。此外，android 上的 gmail 不支持媒体查询，并且不同版本的 Outlook 有自己的怪癖。如果您想要在各种电子邮件客户端上呈现良好的电子邮件，您别无选择，只能使用条件 HTML。

这很像第二个例子：

```
<!--[if gte mso 9]>
    <style type="text/css">
    /* Your Outlook-specific CSS goes here. */
    </style>
<![endif]--> 
```

但是，如果您不使用电子邮件客户端，我将不得不同意其他所有人的观点，并说您应该使用 Java Script。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-23T20:13:57.227

感谢 Kevin Loney 和他的 javaScript 解决方案，我们还应该考虑 CSS 条件。如果条件基于浏览器感知/响应式设计，则可以绕过 javaScripting：

```
<div class='if-part'>show something</div>
<div class='else-part'>show something</div> 
```

“显示某些东西”的意思是您只会隐藏不适用的条件。在下面的示例中，“if-part”仅显示在移动设备上。“else-part”显示在较大的屏幕上。

```
@media screen and (max-width:767px){
    .if-part{display:initial;}
    .else-part{display:none}
}
@media screen and (min-width:768px){
    .if-part{display:none;}
    .else-part{display:initial}
} 
```

[这个答案](https://stackoverflow.com/questions/1129699/can-you-use-if-else-conditions-in-css)提供了更多可供考虑的 CSS 选项。

# c++ - 我应该将我所有的 c++ 代码包装在它自己的命名空间中吗？

> ID：502435
> 
> 赞同：26
> 
> 时间：2009-02-02T07:24:22.960
> 
> 标签：c++, namespaces

我来自 ac# 背景，一切都有自己的命名空间，但这种做法在 c++ 世界中似乎并不常见。我应该将我的代码包装在它自己的命名空间、未命名的命名空间还是没有命名空间？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-02T07:37:55.117

遗憾的是，许多 C++ 开发人员不使用名称空间。当我开始使用 C++ 时，我很长一段时间都没有使用它们，直到我得出结论，我可以使用命名空间做得更好。

许多库通过在名称之前放置前缀来解决命名空间问题。例如，wxWidgets 将字符“wx”放在所有内容之前。Qt 把“Q”放在一切之前。这并没有什么问题，但是它要求您重新输入该前缀，即使可以从上下文中推断出您所指的声明。命名空间具有层次顺序。在词法上更接近引用它们的点的名称更早被发现。因此，如果您在 GUI 框架中引用“Window”，它将找到“my::gui::Window”，而不是“::Window”。

命名空间启用了一些没有它们就无法使用的不错的功能。例如，如果您将类放入命名空间，您可以在该命名空间中定义自由函数。然后，您可以通过导入所有名称或选择性地仅将其中一些名称导入当前范围（“使用声明”）来调用该函数而不将名称空间放在前面。

如今，我不再做任何项目而不使用它们。它们使得不再重复键入相同的前缀变得如此容易，但仍然具有良好的组织和避免全局命名空间的名称污染。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-02T07:30:48.097

取决于，如果您的代码是库代码，请将其包装在命名空间中，这是 C++ 中的做法。如果您的代码只是一个非常简单的应用程序，它不与其他任何东西交互，例如一个 hello world 类型的应用程序，那么就不需要命名空间，因为它是多余的。

由于不需要命名空间，网络上的代码片段和示例很少使用它们，但大多数实际项目都使用它们。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-09-28T19:44:30.287

我刚刚发现了 Google 的 c++ 风格指南，他们有[命名空间指南。](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Namespaces)

整个指南值得一读，但总而言之，他们说：

*   将未命名的命名空间添加到 .cc 文件，而不是 .h 文件。
*   将整个（在包含/声明之后）.cc 和 .h 文件包装在命名的命名空间中。
*   命名空间不会增加缩进级别。
*   在命名空间 write 的右大括号处`} // namespace`。
*   不要在 中声明任何东西`std`，因为它是未定义的。
*   禁止使用该`using`指令。
*   在`using`函数、方法和类中允许声明。
*   任何地方都允许命名空间别名。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T07:33:10.197

这实际上取决于您是否期望有任何冲突。

两种情况；

1) 如果您正在创建可能被其他人使用的代码（例如库），那么可能会出现名称空间冲突，因此使用您自己的名称空间是个好主意。

2) 如果您使用第三方库，他们的代码可能没有命名空间并且可能与您的冲突。

我还要说，如果您希望您的代码相当大并且涵盖许多不同的领域（数学/物理/渲染），那么使用命名空间确实会使代码更容易理解，特别是对于那些没有明显分类的类型。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T14:12:53.837

我们在使用我们的通用库的托管 C++ 中包装代码时遇到了问题。

一些类与 .NET 库中的 System 类具有相同的名称（即 System.Console）。
我们不得不做一些丑陋的宏补丁来解决这些问题。

在开始时使用命名空间会阻止这种情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T07:29:52.450

如果存在名称冲突的风险，您只需要命名空间 - 一些全局可见的函数或变量或类被多次定义。否则你会在没有命名空间的情况下做得很好——只需命名你的类，这样它们就不会重复运行时库类，并使全局函数/变量成为一些合理类的静态成员。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T08:30:50.737

> 但这种做法在 c++ 世界中似乎并不常见

真的。我看到的所有代码似乎都包装在一个命名空间中。
我使用在 Java 中看到的相同类型的约定（除了我删除了 com）。

在 Java 中

```
package com.<Company>.<Product>.<Package>; 
```

在 C++ 中

```
namespace <Company>
{
     namespace <Product>
     {
         namespace <Package>
         {
         }
     }
 } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-09-28T20:05:06.213

我会说这是一个好主意，如果没有其他原因，只是为了防止你的东西在与其他第三方代码混合时被踩到。

通过将尽可能多的变量和函数放入类中，我试图走得更远。但这有时比它应该做的更难（与其他 OO 语言相比）。

# visual-studio-2008 - 在 VS2008 中查看版本树

> ID：502436
> 
> 赞同：1
> 
> 时间：2009-02-02T07:24:54.940
> 
> 标签：visual-studio-2008, version-control, ide, clearcase

谁能告诉我如何直接查看在 VS2008 中打开的文件的 ClearCase 版本树？我在编辑器中有源代码控制工具栏，它有所有其他选项（签入、签出等），但没有用于查看文件版本树的按钮。我可以配置一下吗？另外，我有一个清晰的案例加载项 dll，它在我的 VC6 编辑器中运行良好。有什么办法可以在 VS2008 中使用这个 dll 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T14:05:25.007

我想这取决于你在哪里找到了你的 ClearCase 插件。

我只是与我的一位 ClearCase VS2008 用户核实：

他有 2 个工具栏（一个 CC UCM，一个带有版本树按钮的 Base CC）

对于 VS2008，您需要首先安装 VS2005 之类的 CC 插件，然后添加一些文件和 .reg 以将此安装更新为兼容 VS2008 的 CC 插件。

* * *

这是我们当前的 ClearCase-VS2008 集成过程：

如果在 VS .NET 2005/2003 之前安装了 ClearCase，请遵循此[IBM 技术](http://www-1.ibm.com/support/docview.wss?uid=swg21259189)说明，以便在自定义设置窗口步骤中添加**“ `IBM Rational ClearCase Client for VS .NET`”**。

[获取本IBM 技术](http://www-01.ibm.com/support/docview.wss?rs=984&uid=swg24017991)说明中提到的 CC-CQ-VS2008.zip并执行**“ `reg_VS2008.bat`”**

* * *

然后告诉我您是否仍然看不到任何“版本树”按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-01T20:44:26.077

将您自己的自定义命令添加到上下文菜单。 [http://randomconsultant.blogspot.com/2009/03/adding-clearcase-commands-to-visual.html](http://randomconsultant.blogspot.com/2009/03/adding-clearcase-commands-to-visual.html)

# c++ - 素数程序

> ID：502443
> 
> 赞同：2
> 
> 时间：2009-02-02T07:29:17.973
> 
> 标签：c++, primes

我目前正在尝试一些问题，只是为了练习我的编程技能。（还没有在学校或任何东西上学习，自学）我遇到了这个问题，需要我从给定的 txt 文件中读取一个数字。这个数字是 N。现在我想找到 N <= 10 000 的第 N 个素数。找到它之后，我想把它打印到另一个 txt 文件中。现在对于问题的大部分部分，我能够理解并设计一种获得 N 的方法。问题是我正在使用一个数组来保存以前找到的素数，以便使用它们来检查未来的数字。即使我的数组大小为 100，只要输入整数大约 < 15，程序就会崩溃。

```
#include <cstdio>
#include <iostream>
#include <cstdlib>
#include <fstream>
using namespace std;

int main() {
    ifstream trial;
    trial.open("C:\\Users\\User\\Documents\\trial.txt");
    int prime;
    trial >> prime;
    ofstream write;
    write.open("C:\\Users\\User\\Documents\\answer.txt");
    int num[100], b, c, e;
    bool check;
    b = 0;
    switch (prime) {
        case 1:
        {
            write << 2 << endl;
            break;
        }
        case 2:
        {
            write << 3 << endl;
            break;
        }
        case 3:
        {
            write << 5 << endl;
            break;
        }
        case 4:
        {
            write << 7 << endl;
            break;
        }
        default:
        {
            for (int a = 10; a <= 1000000; a++) {
                check = false;
                if (((a % 2) != 0) && ((a % 3) != 0) && ((a % 5) != 0) && ((a % 7) != 0)) // first filter
                {
                    for (int d = 0; d <= b; d++) {
                        c = num[d];
                        if ((a % c) == 0) {
                            check = true; // second filter based on previous recorded primes in array
                            break;
                        }

                    }
                    if (!check) {
                        e = a;
                        if (b <= 100) {
                            num[b] = a;
                        }

                        b = b + 1;
                    }
                }
                if ((b) == (prime - 4)) {
                    write << e << endl;
                    break;
                }
            }
        }
    }
    trial.close();
    write.close();
    return 0;
} 
```

我完全根据我的傻瓜指南和我自己做到了这一点，所以请原谅我算法的一些代码效率低下和一般新手。对于最多 15 个，它也能正确显示素数。

谁能告诉我应该如何改进当前的代码？我正在考虑使用 txt 文件代替数组。那可能吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-02T08:22:54.607

由于您的问题是关于编程而不是数学，所以我也会尽量保持我的回答。

第一眼你的代码让我想知道你到底在做什么......如果你阅读答案，你会意识到他们中的一些人并没有费心理解你的代码，而有些人只是将你的代码转储到调试器看看发生了什么。是我们这么不耐烦吗？或者仅仅是你的代码对于一个相对简单的问题来说太难理解了？

要改进您的代码，请尝试问自己一些问题：

1.  什么是`a`、、、`b`等`c`？给更有意义的名字不是更好吗？
2.  你的算法到底是什么？你能用英文写下你正在做的事情的清晰段落吗（以准确的方式）？您能否将段落修改为一系列步骤，您可以在精神上对任何输入执行并且可以确定它是正确的？
3.  所有步骤都需要吗？我们可以合并甚至消除其中的一些吗？
4.  有哪些步骤用英语很容易表达，但在 C/C++ 中需要超过 10 行？
5.  您的步骤列表是否有任何结构？循环？大（可能是重复的）块可以作为一个步骤与子步骤一起放置吗？

完成问题后，您可能会得到一个布局清晰的伪代码来解决问题，并且易于解释和理解。之后，您可以用 C/C++ 或实际上任何通用语言实现您的伪代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T07:49:10.163

我还没有查看您的代码，但是您的数组必须足够大以包含您将存储在其中的所有值。对于这个问题的大多数输入，100 肯定是不够的。

例如这段代码..

```
int someArray[100];
someArray[150] = 10; 
```

写入比数组大的位置 (150 > 100)。这称为内存覆盖。根据该内存位置发生的情况，您的程序可能会立即、稍后或根本不会崩溃。

使用数组时的一个好习惯是以某种方式断言您正在写入的元素在数组的范围内。或者使用执行此检查的数组类型类。

对于您的问题，最简单的方法是使用 STL 向量类。虽然您必须添加元素 (vector::push_back())，但您可以稍后使用数组运算符 [] 访问元素。Vector 也会给你最好的迭代性能。

这是一些将数字 0-100 添加到向量然后打印它们的示例代码。请注意，在第二个循环中，我们使用存储在向量中的项目数。

```
#include <vector> // std::vector

...

const int MAX_ITEMS = 100;

std::vector<int> intVector;

intVector.reserve(MAX_ITEMS); // allocates all memory up-front

// add items
for (int i = 0; i < MAX_ITEMS; i++)
{
  intVector.push_back(i);  // this is how you add a value to a vector;
}

// print them
for (int i = 0; i < intVector.size(); i++)
{
  int elem = intVector[i]; // this access the item at index 'i'
  printf("element %d is %d\n", i, elem);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T07:50:18.727

您可能需要考虑两种测试素数的方法：

1.  问题域足够小，仅循环数字直到找到第 N 个素数可能是一个可接受的解决方案，并且只需不到几毫秒即可完成。您可以对这种方法进行许多简单的优化，例如您只需要测试它是否可以被 2 整除一次，然后您只需检查奇数并且您只需检查小于或等于的数字到被测数字的平方根。
2.  [埃拉托色尼筛法](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)非常有效且易于实施，并且在数学方面非常轻松。

至于你的代码为什么会崩溃，我怀疑改变了读取的行

```
for( int d=0; d<=b; d++) 
```

到

```
for( int d=0; d<b; d++) 
```

将解决问题，因为您正试图从可能包含垃圾的数组的潜在未初始化元素中读取。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T10:22:25.283

我现在正在尝试改进我的函数式编程，所以我只是快速编写了筛子。我想我会把它贴在这里。如果你还在学习，你可能也会觉得它很有趣。

```
#include <iostream>
#include <list>
#include <math.h>
#include <functional>
#include <algorithm>

using namespace std;

class is_multiple : public binary_function<int, int, bool>
{
    public:
        bool operator()(int value, int test) const
        {
            if(value == test) // do not remove the first value
                return false;
            else
                return (value % test) == 0;
        }
};

int main() 
{
    list<int> numbersToTest;
    int input = 500;

    // add all numbers to list
    for(int x = 1; x < input; x++)
        numbersToTest.push_back(x);

    // starting at 2 go through the list and remove all multiples until you reach the squareroot
    // of the last element in the list
    for(list<int>::iterator itr = ++numbersToTest.begin(); *itr < sqrt((float) input); itr++)
    {
        int tmp = *itr;
        numbersToTest.remove_if(bind2nd(is_multiple(), *itr));  
        itr = find(numbersToTest.begin(), numbersToTest.end(), tmp); //remove_if invalidates iterator 
                                                                 // so find it again. kind of ugly
    }

    // output primes
    for(list<int>::iterator itr = numbersToTest.begin(); itr != --numbersToTest.end(); itr++)
        cout << *itr << "\t";

    system("PAUSE");

    return 0;
} 
```

顺便说一句，任何关于如何改进这一点的建议都将受到欢迎。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-30T13:55:25.603

这是我的代码。处理大数字时，速度非常慢！它可以计算您输入的数字中的所有素数！

```
#include <iostream>
#include <fstream>
#include <cmath>
using namespace std;

int main()
{
    int m;
    int n=0;
    char ch;
    fstream fp;
    cout<<"What prime numbers do you want get within?  ";
    if((cin>>m)==0)
    {
                 cout<<"Bad input! Please try again!\n";
                 return 1;
    }
    if(m<2)
    {
        cout<<"There are no prime numbers within "<<m<<endl;
        return 0;
    }
    else if(m==2)
    {
        fp.open("prime.txt",ios::in|ios::out|ios::trunc);//create a file can be writen and read. If the file exist, it will be overwriten.
        fp<<"There are only 1 prime number within 2.\n";
        fp<<"2\n";
        fp.close();
        cout<<"Congratulations! It has worked out!\n";
        return 0;
    }
    else
    {
        int j;
        int sq;
        fp.open("prime.txt",ios::in|ios::out|ios::trunc);
        fp<<"2\t\t";
        n++;
        for(int i=3;i<=m;i+=2)
        {
            sq=static_cast<int>(sqrt(i))+1;
            fp.seekg(0,ios::beg);
            fp>>j;
            for(;j<sq;)
            {
                if(i%j==0)
                {
                    break;
                }

                else
                {
                    if((fp>>j)==NULL)
                    {
                        j=3;
                    }
                }
            }
            if(j>=sq)
            {
                fp.seekg(0,ios::end);
                fp<<i<<"\t\t";
                n++;
                if(n%4==0)
                    fp<<'\n';
            }
        }
        fp.seekg(0,ios::end);
        fp<<"\nThere are "<<n<<" prime number within "<<m<<".\n";
        fp.close();
        cout<<"Congratulations! It has worked out!\n";
        return 0;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T07:44:24.823

由于这是出于教学目的，我建议实施[Eratosthenes 筛](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T07:50:25.200

一方面，如果您没有针对 3、5 和 7 的特殊情况，您将拥有更少的代码（这总是一件好事！）。

此外，如果您仅设置 num[b] = 2 并且仅测试数组中事物的可分性，则可以避免 2 的特殊情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T07:52:16.790

看起来当您绕过主 for() 循环时， b 的值会增加。

然后，这会导致崩溃，因为您访问数组末尾的内存：

```
 for (int d = 0; d <= b; d++) {
                    c = num[d]; 
```

我认为您需要更清楚地了解算法，然后再次处理代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T07:53:29.547

通过调试器运行您的代码，我发现它在“”处因浮点异常而崩溃`if ((a % c) == 0)`。这样做的原因是你没有在 num 中初始化任何东西，所以你正在做“a % 0”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-02T07:55:59.947

> 据我所知，在 C/C++ 中，int 是 16 位类型，因此不能容纳 100 万个（限制为 2^16=32k）。尝试并声明“a”

我认为 C 标准说它`int`至少`short`和`long`.

实际上`int`是 4 个字节，因此它可以容纳 和 之间`-2^31`的数字`2^31-1`。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-02T08:19:14.333

您也应该对此感兴趣：[http ://en.wikipedia.org/wiki/Primality_test](http://en.wikipedia.org/wiki/Primality_test)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-02T10:22:40.667

```
for(int currentInt=2; currentInt<=1000000; currentInt++) 

{check = false;  // Basically the idea for this for loop is to run checks against integers. This is the main for loop in this program. I re initialize check to false ( check is a bool declared above this. )

for( int arrayPrime=0; arrayPrime<currentPrime; arrayPrime++) // This for loop is used for checking the currentInt against previously found primes which are stored in the num array.

{ c=num[arrayPrime];
        if ((currentInt%c)==0) { check = true;// second filter based on previous recorded primes in array
                break;}  // this is the check. I check the number against every stored value in the num array. If it's divisible by any of them, then bool check is set to true.

if ( currentInt == 2)
{ check = false; } // since i preset num[0] = 2 i make an exception for the number 2.

if (!check)
{
e=a;
if(currentPrime <= 100){
num[currentPrime]= currentInt;} // This if uses check to see if the currentInt is a prime. 

currentPrime = currentPrime+1;} // increases the value of currentPrime ( previously b ) by one if !check.

if(currentPrime==prime)
{
write<<e<<endl;
break;}           // if currentPrime == prime then write the currentInt into a txt file and break loop, ending the program. 
```

感谢您的建议 polythinker =)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-02T15:15:29.203

```
#include <cstdio>
#include <iostream>
#include <cstdlib>
#include <fstream>

using namespace std;

int main()
{
ifstream trial;
trial.open("C:\\Users\\User\\Documents\\trial.txt");
int prime, e;
trial>>prime;
ofstream write; 
write.open("C:\\Users\\User\\Documents\\answer.txt");
int num[10000], currentPrime, c, primePrint;
bool check;
currentPrime=0;
num[currentPrime] = 2;
currentPrime=1;

for(int currentInt=2; currentInt<=1000000; currentInt++) 
{check = false; 
for( int arrayPrime=0; arrayPrime<currentPrime; arrayPrime++) 
        { c=num[arrayPrime];
            if ((currentInt%c)==0) { check = true;// second filter based on previous recorded primes in array
                    break;}
               }

 if (!check)
    { e=currentInt;  
    if( currentInt!= 2 ) { 
    num[currentPrime]= currentInt;}
    currentPrime = currentPrime+1;}
    if(currentPrime==prime)
    {
    write<<e<<endl;
    break;}
    }
trial.close();
write.close();
return 0;
} 
```

这是基于我的原始代码的最终版本。它工作得很好，如果你想增加素数的范围，只需增加数组数。感谢您的帮助 =)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-02T16:04:40.290

[由于以后的问题](http://projecteuler.net/index.php?section=problems&id=10)需要更大的素数，我建议你听从 dreeves 的建议，做一个筛子。这是一个非常有用的箭，放在你的箭袋里。

# f# - 合并/加入 seq 的 seq

> ID：502447
> 
> 赞同：4
> 
> 时间：2009-02-02T07:30:54.507
> 
> 标签：f#, sequence

慢慢掌握了列表匹配和尾递归的窍门，我需要一个函数将列表列表“缝合”在一起，留下中间值（显示比解释更容易）：

合并 [[1;2;3];[3;4;5];[5;6;7]] //-> [1;2;3;4;5;6;7]

List.merge 函数的代码如下所示：

```
///Like concat, but removes first value of each inner list except the first one
let merge lst = 
    let rec loop acc lst = 
        match lst with
        | [] -> acc
        | h::t -> 
            match acc with
            | [] -> loop (acc @ h) t
            | _ -> loop (acc @ (List.tl h)) t //first time omit first value
    loop [] lst 
```

*（好吧，它不太像concat，因为它只处理两级列表）*

问题：如何为 Seq of Seqs 执行此操作（不使用可变标志）？

**更新**（来自朱丽叶的评论）：我的代码创建了由基于选项类型的“段”组成的“路径”：

```
type SegmentDef = Straight of float | Curve of float * float
let Project sampleinterval segdefs = //('clever' code here) 
```

当我执行 List.map (Project 1.) ListOfSegmentDefs 时，我会返回一个列表，其中每个段开始于前一个段结束的同一点。我想将这些列表连接在一起以获得一个路径，只保留每个重叠的“顶部/尾部” - 但我不需要做一个“设置”，因为我知道我没有任何其他重复项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T03:34:26.090

这与您的第一个解决方案基本相同，但更简洁一点：

```
let flatten l =
    seq {
        yield Seq.hd (Seq.hd l) (* first item of first list *)
        for a in l do yield! (Seq.skip 1 a) (* other items *)
    } 
```

**[编辑添加]：**

如果您需要此代码的 List 版本，`|> Seq.to_list`请在方法末尾使用 append ：

```
let flatten l =
    seq {
        yield Seq.hd (Seq.hd l) (* first item of first list *)
        for a in l do yield! (Seq.skip 1 a) (* other items *)
    } |> Seq.to_list 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-07-08T23:22:01.640

```
let merge = function
  | [] -> []
  | xs::xss -> xs @ [for _::xs in xss do yield! xs] 
```

或者：

```
let merge = function
  | [] -> []
  | xs::xss -> xs @ List.collect List.tail xss 
```

# perl - 我可以使用 MooseX::Declare 在类之外定义函数吗？

> ID：502463
> 
> 赞同：8
> 
> 时间：2009-02-02T07:42:03.877
> 
> 标签：perl, module, moose

我最近开始使用模块[MooseX::Declare](http://search.cpan.org/dist/MooseX-Declare)。我喜欢它的语法。它优雅而整洁。有没有人遇到过您想在一个类中编写许多函数（其中一些很大）并且类定义运行到页面中的情况？是否有任何解决方法可以使类定义仅在类外部声明函数和真正的函数定义？

我正在寻找的是这样的 -

```
class BankAccount {
    has 'balance' => ( isa => 'Num', is => 'rw', default => 0 );
    # Functions Declaration.
    method deposit(Num $amount);
    method withdraw(Num $amount);
}

# Function Definition.
method BankAccount::deposit (Num $amount) {
    $self->balance( $self->balance + $amount );
}

method BankAccount::withdraw (Num $amount) {
    my $current_balance = $self->balance();
    ( $current_balance >= $amount )
    || confess "Account overdrawn";
    $self->balance( $current_balance - $amount );
} 
```

我可以看到有一种方法可以使类可变。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T11:33:59.227

容易（但需要添加到文档中）。

```
class BankAccount is mutable {
} 
```

顺便说一句，你为什么要在类之外定义你的方法？

你可以去

```
class BankAccount is mutable {
    method foo (Int $bar) {
         # do stuff
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T06:12:56.987

我希望我的类定义简短，并给出类用途的抽象概念。我喜欢它在 C++ 中完成的方式，您可以选择使用范围解析运算符在内联或类外定义函数。这使得类定义简洁明了。这就是我要找的。

谢谢你的时间。

# .net - 用于单击一次的 Google Chrome 扩展程序？

> ID：502472
> 
> 赞同：20
> 
> 时间：2009-02-02T07:50:39.943
> 
> 标签：.net, winforms, google-chrome, clickonce

我有一个客户想在我们开发的内部网络应用程序中使用 Google Chrome（我不怪他，我真的很喜欢使用 chrome！）

问题是我们有一个用户可以从浏览器启动的 win forms 应用程序，只需单击一次即可部署。我早就知道 chrome 不支持单击一次，但我认为现在可能会有一些支持。

我花了几分钟搜索堆栈溢出和谷歌，并没有发现任何明显的迹象表明是否有人计划使用它或开发了 Chrome 的一次点击扩展（类似于 FFClickOnce）。

那么，有没有人在 chrome 下工作时点击过，或者有没有人看到任何支持点击一次的插件/扩展的消息？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-09-17T02:36:31.007

Google Chrome 并不真正支持将 .NET 版本添加到用户代理的扩展，但对于普通启动 .applications 可以尝试一下：

[https://chrome.google.com/extensions/detail/eeifaoomkminpbeebjdmdojbhmagnn​​cl](https://chrome.google.com/extensions/detail/eeifaoomkminpbeebjdmdojbhmagnncl)（不再可用）

[https://chrome.google.com/webstore/detail/clickonce-helper/mdooolbdbmjaobhdondofgdmnbidlgfh](https://chrome.google.com/webstore/detail/clickonce-helper/mdooolbdbmjaobhdondofgdmnbidlgfh)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-03T04:43:51.973

Chrome 无法像资源管理器那样自动启动 setup.exe，但 Chrome 会像下载任何其他文件一样下载它。用户在下载后运行它并不困难，直到 Chrome 想出一种让它自动启动的方法。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-12-02T14:28:48.637

安装[IETab for Chrome](http://www.chromeextensions.org/utilities/ie-tab/)，然后设置规则以始终使用 IETab 打开启动页面。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-01-11T00:53:18.427

现在有一个来自 Chrome 的扩展程序，可让您启动一次点击应用程序（[适用于 Chrome 的 ClickOnce](https://chrome.google.com/extensions/detail/eeifaoomkminpbeebjdmdojbhmagnncl)）。

不幸的是，它不会更新用户代理，因此无法知道网站是否支持它。有一种方法可以更改 Chrome 中的用户代理，但我不希望普通用户可以这样做。但是，[这是 Chrome 帮助论坛上的一个答案](http://www.google.com/support/forum/p/Chrome/thread?tid=64e4e45037f55919&hl=en)，解释了如何参考。

基本上创建 Chrome 的快捷方式并将此命令行参数添加到目标。

```
--user-agent="Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/534.10 (KHTML, like Gecko) Chrome/8.0.552.224 Safari/534.10 .NET CLR 3.5.21022; .NET CLR 3.5.30729; .NET4.0E" 
```

您可能需要确保您拥有当前的用户代理。[这是一个](http://www.iopus.com/imacros/demo/v5/user-agent.htm)将为您显示它的网站。您要添加到用户代理的部分是“.NET CLR 3.5.21022; .NET CLR 3.5.30729;” （当然这也可能取决于机器上安装的内容）。

这种方法的另一个缺点是，修改后的用户代理似乎在 Javascript 中不可用（我仍然得到未修改的版本）。

------**编辑**------

如果您想知道 ClickOnce 在客户端上是否可用，这是我编写的一个 Javascript 函数，它将告诉您...

```
this.hasClickOnce = function () {
    var userAgent = navigator.userAgent.toUpperCase();
    if (userAgent.indexOf('.NET CLR 3.5') >= 0) return true;
    if (window.clientInformation && window.clientInformation.plugins) {
        // check to see if a ClickOnce extension is installed.
        for (var i = 0; i < clientInformation.plugins.length; i++)
            if (clientInformation.plugins[i].name == 'ClickOnce plugin for Chrome') return true;
    }
    return false;
}; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T08:54:05.853

Google Chrome 目前没有扩展或扩展架构。扩展架构仍然是他们正在[计划/设计](http://dev.chromium.org/developers/design-documents/extensions)的东西，我想不会很快可用。然而，有[迹象](http://codereview.chromium.org/7254)表明 Chrome 中的 Greasemonkey 支持即将到来。无论如何，某种类型的 Javascript 代码似乎是你目前唯一的希望。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-27T19:08:49.157

这是 [https://chrome.google.com/webstore/detail/eeifaoomkminpbeebjdmdojbhmagnn​​cl](https://chrome.google.com/webstore/detail/eeifaoomkminpbeebjdmdojbhmagnncl)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T08:45:52.983

微软前段时间为 Firefox 发布了一个插件，所以他们确实支持其他浏览器。随着插件是用 javascript 编写的，我想应该可以查看源代码以确定它是如何完成的，也可以自己编写。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-24T08:11:37.767

您可以创建 NPAPI 插件并以这种方式显示您的表单，然后从那里与 Extensions 框架进行通信。

[http://code.google.com/chrome/extensions/npapi.html](http://code.google.com/chrome/extensions/npapi.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-25T20:02:09.057

我们的产品使用单击一次部署和更新，也使用单点登录。由于我们的客户也想使用 Chrome，我们不得不寻找替代方案。

[https://chrome.google.com/webstore/search/clickonce?hl=en-US](https://chrome.google.com/webstore/search/clickonce?hl=en-US)

在撰写本文时，有 3 个第三方插件可用： - Window Remix ClickOnce - Meta4 ClickOnce - ClickOnce for google

但这些需要自行决定使用。

[![在此处输入图像描述](https://i.stack.imgur.com/WjJZS.png)](https://i.stack.imgur.com/WjJZS.png)

# matlab - 歌声与音乐的分离

> ID：502475
> 
> 赞同：4
> 
> 时间：2009-02-02T07:52:25.930
> 
> 标签：matlab, fft

我想知道如何为歌曲的声乐和非声乐片段分类执行“光谱变化检测”。我们需要从光谱图中找到光谱变化。关于此的任何详细信息，特别是涉及 MATLAB？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T21:29:50.413

从音频中分离出不同的信号是一个非常活跃的研究领域，也是一个非常困难的问题。这在文献中通常称为[盲信号分离](http://www.tsi.enst.fr/~cardoso/guidesepsou.html)。（上一个链接中有一些 MATLAB 演示代码。

当然，如果你知道音乐中有人声，你可以使用许多人[声分离](http://www.google.com/search?hl=en&q=vocal+separation+algorithm)算法中的一种。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T22:23:50.367

正如其他人所指出的，仅使用原始频谱分析来解决这个问题是一个非常困难的问题，而且您不太可能找到一个好的解决方案。充其量，您可能能够从混音中提取一些人声和一些额外的交叉频率。

但是，如果您可以更具体地了解您在此处使用的音频材料的性质，您可能会更进一步。

在最坏的情况下，您的素材将是普通歌曲的普通 mp3——即，一个完整的乐队 + 歌手。我有一种感觉，鉴于您的问题的性质，您可能正在考虑这种情况。

在最好的情况下，您可以访问多轨录音室录音，并且至少拥有完整的混音和乐器音轨，在这种情况下，您可以从混音中提取人声频率。您可以通过从其中一个轨道生成脉冲响应并将其应用到另一个轨道来做到这一点。

在中间情况下，您正在处理简单的音乐，您可以应用某种针对音乐参数调整的算法。例如，如果您正在处理电子音乐，您可以利用轨道的立体声宽度来消除所有单声道元素（即低音线 + 底鼓）以提取人声 + 其他声像乐器，然后应用某种类型的从那里进行过滤和频谱分析。

简而言之，如果您打算制作一个通用算法来从任意源材料生成干净的无伴奏合唱，那么您可能会咬得比您在这里咀嚼的更多。如果您可以明确限制您的源材料，那么您可以根据这些来源的性质使用多种算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T08:43:08.340

这很难。如果你能可靠地做到这一点，你将成为一名有成就的计算机科学家。我读到的最有前途的方法是使用歌词生成一个只有语音的轨道以进行比较。再说一次，如果你能做到这一点并写一篇关于它的论文，你就会出名（在计算机科学家中）。另外，您可以通过自动生成卡拉 OK 时间来赚很多钱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T13:21:03.993

如果您只想确定一段音乐是干净的无伴奏合唱还是具有乐器背景，您可以通过将信号带宽与正常的人类歌手带宽进行比较来做到这一点。此外，您可以检查基本频率，它只能在人声的非常有限的频率范围内。

不过，这可能并不容易。但是，助听器一直都是这样做的，所以显然是可行的。（尽管他们通常会寻找演讲，而不是唱歌）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-02-25T00:41:33.183

首先将乐器与原件同步，确保它们具有相同的长度和比特率，并在准确的时间开始和结束，并将它们转换为 .wav

然后做类似的事情

```
I = wavread(instrumental.wav);
N = wavread(normal.wav);
i = inv(I);
A = (N - i); // it could be A = (N * i) or A = (N + i) you'll have to play around
wavwrite(A, acapella.wav) 
```

应该这样做..一点线性代数有很长的路要走。

# cocoa-touch - UILabel 文本在更新时重叠？

> ID：502482
> 
> 赞同：5
> 
> 时间：2009-02-02T07:57:29.367
> 
> 标签：cocoa-touch

在我的应用程序中，我将文本标签的值从初始值 0 更改为在触摸事件上递增。有时，但不是所有时候，新值会覆盖在 0 上，这并不酷。

这是相关代码：

```
UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
UILabel *label = (UILabel *)[cell viewWithTag:1000];
label.text = qtyString; 
```

我尝试从视图中删除标签，然后添加另一个具有新值的标签，但这根本不影响问题。当我将单元格（标签是表格单元格的一部分）滚动出屏幕并返回时，标签会正确显示。哦，我也试过做

```
[tableView reloadData]; 
```

它工作得更好，但是如果我选择一个单元格然后在它被突出显示时滚动它会在那个单元格上弹出。

请帮忙 ：（

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-01-19T12:26:52.260

检查“清除图形上下文”对我有用，我一开始不小心取消了它~~

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T06:58:48.250

在您的 UILabel 选项下取消选中“不透明”，这将解决它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-30T14:52:14.033

我遇到了同样的问题，UILabel 的文本变得混乱，我只是阅读了其他解决方案，去了 IB，然后检查了“绘图前清除上下文”，这就解决了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T14:30:49.917

恕我直言，解决此问题的最佳方法是将 else 添加到：

```
 UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
}else {
    NSArray *cellSubs = cell.contentView.subviews;
    for (int i = 0 ; i < [cellSubs count] ; i++) {
        [[cellSubs objectAtIndex:i] removeFromSuperview];
    }
} 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T23:04:20.653

改变不透明并不会改变它，尽管它本来是逻辑的。如果给你的标签一个准确的高度，你可以做什么..这个高度将与你的井高度相匹配。如果您正在使用

*   (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
    { return 80; //返回将用于指定行索引处的单元格行高的浮点数
    }

就像我所做的那样，然后将标签的高度设置为 80，这将阻止它..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-17T21:29:03.653

就我而言，将 Opaque 更改为 NO 解决了更新 UILabel.text 的问题，我在 awakeFromNib 中创建了 uilabel。

# user-interface - 为什么 GUI 代码的计算成本如此之高？

> ID：502483
> 
> 赞同：14
> 
> 时间：2009-02-02T07:57:39.273
> 
> 标签：user-interface, language-agnostic

所有你Stackoverflowers，

我想知道为什么 GUI 代码要负责吸走很多很多 cpu 周期。原则上，图形渲染远没有 Doom 复杂（尽管大多数公司的 GUI 会引入大量的装饰）。事件处理层似乎也是一个沉重的成本，然而，一个编写良好的实现似乎应该在具有大量内存/缓存的现代处理器上有效地在上下文之间切换。

如果有人在他们的大型 GUI 应用程序或通用 API 本身上运行了分析器，我会对瓶颈所在的位置感兴趣。

可能的解释（我想象的）可能是：

1.  硬件和应用程序接口之间的高级抽象
2.  对要执行的正确代码的许多间接级别
3.  低优先级（与其他进程相比）
4.  行为不端的应用程序通过调用淹没 API
5.  过度面向对象？
6.  在 API 中完成糟糕的设计选择（不仅仅是问题，还有设计理念）

一些 GUI 框架比其他框架好得多，所以我想听听不同的观点。例如，Unix/X11 系统与 Windows 甚至与 WinForms 有很大不同。

**编辑：**现在是一个社区维基 - 去吧。我还有一件事要补充——我是学校里的一名算法专家，如果 GUI 代码中存在低效的算法以及它们是什么算法，我会很感兴趣。再说一次，这可能只是实现开销。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-02T08:08:07.553

我一般不知道，但我想在您的列表中添加另一个项目 - 字体渲染和计算。在字体中找到矢量字形并将它们转换为具有抗锯齿的位图表示并非易事。并且通常需要执行两次 - 首先计算文本的宽度/高度以进行定位，然后在正确的坐标处实际绘制文本。

此外，当今大多数绘图代码都依赖于裁剪机制来更新 GUI 的一部分。所以，如果只需要重绘一部分，代码实际上会在后台重绘整个窗口，然后只取需要的部分进行实际更新。

**添加：**

在评论中我发现了这个：

> 我对这个也很感兴趣。不能只使用 cpu 渲染 gui，因为如果您的 gfx 卡没有合适的驱动程序，桌面图形渲染速度会*非常*慢。如果您有 gfx 驱动程序，那么 desktop-gfx 会运行得有点快，但永远不会像 directx/opengl 应用程序那样快。

这是我理解的交易：今天的每张显卡都支持通用的绘图界面。我不确定它是否被称为“VESA”、“SVGA”，或者这些只是过去的旧名称。无论如何，这个接口涉及通过中断做所有事情。对于每个像素，都有一个中断调用。或类似的东西。然而，适当的 VGA 驱动程序能够利用 DMA 和其他增强功能，从而减少整个过程的 CPU 密集度。

**添加 2：**啊，对于 OpenGL/DirectX - 这是当今显卡的另一个功能。它们针对独占模式下的 3D 操作进行了优化。这就是为什么速度。普通的 GUI 只使用基本的 2D 绘图程序。因此，它每次想要更新时都会发送整个屏幕的内容。然而，3D 应用程序将一堆纹理和三角形定义发送到 VRAM（视频 RAM），然后将它们重新用于绘图。他们只是说“将三角形集#38 与纹理集#25 并绘制它们”。所有这些东西都缓存在 VRAM 中，所以这又快了很多。

我不确定，但我怀疑现代 3D 加速 GUI（Vista Aero、Linux 上的 compiz 等）也可能利用这一点。他们可以预先将通用位图发送到 VGA，然后直接从 VRAM 中重用它们。然而，任何应用程序绘制的表面仍然需要每次都直接发送以进行更新。

**新增 3：**更多想法。:) 用于 Windows、Linux 等的现代 GUI 是面向小部件的（即面向 Windows 扬声器的控制）。这样做的问题是每个小部件都有自己的绘图代码和相关的绘图表面（或多或少）。当窗口需要重绘时，它会调用其所有子窗口小部件的绘图代码，而这些子窗口小部件又会调用其子窗口小部件的绘图代码等。每个窗口小部件都会重绘其整个表面，即使其中一些被遮挡由其他小部件。使用上面提到的剪辑技术，一些绘制的信息会立即被丢弃，以减少闪烁和其他伪影。但仍然有很多手动绘图代码，包括位图位图传输、拉伸、倾斜、绘制线条、文本、填充等。所有这些都被转换为一系列 putpixel 调用，这些调用通过剪辑过滤器/蒙版和其他东西进行过滤。啊，是的，Alpha 混合在今天也很流行，因为效果很好，这意味着更多的工作。所以......是的，你可以说这是因为大量的抽象和间接。但是……你真的能做得更好吗？我不这么认为。只有 3D 技术可能会有所帮助，因为它们利用 GPU 进行 alpha 计算和裁剪。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T08:59:36.810

让我们首先说编写库比编写独立代码要困难得多。您的抽象在尽可能多的上下文中可重用的要求，包括您还没有想到的上下文，这使得即使对于经验丰富的程序员来说，这项任务也具有挑战性。

在库中，编写 GUI 工具包库是一个众所周知的难题。这是因为使用 GUI 库的程序涵盖了非常广泛的领域，具有非常不同的需求。Why 先生和 Martin DeMollo 不久前[讨论了 GUI 库的需求](http://hackety.org/2008/06/12/martinDemellosGooeyChallenge.html)。

自己编写 GUI 小部件很困难，因为计算机用户对界面行为的微小细节非常敏感。非本地小部件永远不会感觉正确，不是吗？为了使非本地小部件正确——事实上，为了使任何小部件正确——您需要花费大量时间来调整行为的细节。

因此，GUI 很慢，因为用于创建高度可重用组件的抽象机制引入的效率低下，一旦花费了如此多的时间来获得正确的行为，就会增加可用于优化代码的时间的短缺。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T08:54:11.110

嗯，确实不少。

最简单但可能显而易见的答案是，这些 GUI 应用程序背后的程序员是非常糟糕的程序员。你可以继续编写代码来做最奇怪的事情，它会更快，但似乎很少有人关心如何做到这一点，或者他们认为这是一种昂贵的、无利可图的浪费时间的努力。

直接将计算卸载到 GPU 不一定能解决任何问题。GPU 就像 CPU 一样，只是它的通用性较低，而更像是一个数据并行处理器。它可以非常出色地进行图形计算。无论您拥有何种图形 API/OS 和驱动程序组合都没有那么重要……好吧，以 Vista 为例，他们改变了桌面组合引擎。这个引擎在只处理那些发生变化的地方要好得多，而且由于 GUI 应用程序的头号瓶颈是重绘，这是一种巧妙的优化策略。这种虚拟化您的计算需求的想法，每次只更新最小的变化。

Win32 在需要重绘窗口时会向窗口发送 WM_PAINT 消息，这可能是窗口相互遮挡的结果。但是，由窗口本身来确定实际发生了什么变化。不仅如此，没有任何改变，或者所做的改变是微不足道的，以至于它可能只是在你拥有的最上面的表面上进行。

这种图形处理今天不一定存在。我会说人们避免编写真正高效和虚拟化的渲染解决方案，因为收益/成本比率相当低/高（坏）。

Windows Presentation Foundation (WPF) 所做的事情，我认为远优于大多数其他 GUI API 是它将布局更新和渲染更新分成两个单独的通道。虽然 WPF 是托管代码，但渲染引擎不是。渲染发生的情况是托管 WPF 渲染引擎构建一个命令队列（这是 DirectX 和 OpenGL 所做的），然后将其交给本机渲染引擎。这里更优雅的是，WPF 将尝试保留任何不改变视觉状态的计算。如果可以的话，这是一个技巧，您可以避免昂贵的渲染调用不需要渲染（虚拟化）的东西。

与告诉 Win32 窗口重新绘制自身的 WM_PAINT 相比，WPF 应用程序将检查该窗口的哪些部分需要重新绘制，并且只重新绘制最小的更改。

现在 WPF 不是至高无上的，它是 Microsoft 的坚实努力，但它还不是圣杯……运行管道的代码仍然可以改进，任何托管应用程序的内存占用仍然比我想要的要多。但我希望这是您正在寻找的答案。

WPF 能够异步地做一些相当不错的事情，如果你想制作一个真正响应的低延迟/低 CPU 用户界面，这是一个巨大的交易。异步操作不仅仅是在不同的线程上卸载工作。

总而言之，缓慢而昂贵的 GUI 意味着过多的重绘和非常昂贵的重绘，即整个表面区域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T08:59:34.377

我确实在某种程度上取决于语言。您可能已经注意到，Java 和 RealBasic 应用程序比基于 C（C++、C#、Objective-C）的应用程序要慢一些。

然而，GUI 应用程序比命令行应用程序复杂得多。终端窗口只需要绘制一个不支持按钮的简单窗口。

还有多个循环用于额外的输入和功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T16:02:19.000

我认为您可以在 James Gosling（Java 人，也以他在 X11 之前的窗口系统方面的工作而闻名）的“窗口系统设计：如果我在 2002 年重新做一遍”中找到关于这个主题的一些有趣的想法。可[在此处在线获取[pdf]](http://www.hack.org/mc/texts/gosling-wsd.pdf)。

这篇文章关注的是积极的一面（如何让它变快），而不是消极的一面（是什么让它变慢了），但它仍然是一个很好的主题读物。

# c# - C#.NET 如何在报表查看器中添加超链接

> ID：502484
> 
> 赞同：0
> 
> 时间：2009-02-02T07:59:11.737
> 
> 标签：c#, reportviewer, hyperlink

如何在引用 page.aspx?id='Fields!RelativePath.Value' 的报告中放置超链接？我已将 EnableHyperlink 属性设置为 true。

提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T21:17:02.997

我想你的问题已经在[这里](https://stackoverflow.com/questions/401664/can-reportviewer-render-a-hyperlink-with-a-relative-path)得到了回答。

编辑：例如，在文本框上：右键单击 > 属性 > 导航 > 跳转到 URL 这应该设置为：="page.aspx?id=" & Fields!RelativePath.Value

如果它不起作用，可能是因为相对路径问题。我建议使用 System.AppDomain.CurrentDomain.BaseDirectory 来构建您想要到达的任何地方的绝对 URL。

# asp.net - 如果在 ASP.NET 完成页面处理之前触发后台线程执行会发生什么？

> ID：502485
> 
> 赞同：5
> 
> 时间：2009-02-02T08:00:49.173
> 
> 标签：asp.net, multithreading, behavior

如果我在 ASP.NET 页面生命周期完成之前分离一个线程来执行一个长时间运行的进程会发生什么？ASP.NET 运行时会杀死线程吗？这会导致不确定的行为吗？

这是一个代码示例，它在 Page_Load 事件中旋转后台线程。这是安全的事情吗？

```
protected void Page_Load(object sender, EventArgs e)
{
    Thread newThread = new Thread(new ThreadStart(SomeLongRunningMethod));
    newThread.IsBackground = true;
    newThread.Start();
}

private void SomeLongRunningMethod()
{
    // some long running process goes here...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T08:42:10.307

我已经对相同类型的代码进行了一些试验，在单独的线程中进行了一些耗时的日志记录。它似乎运行良好，但我尚未在生产环境中对其进行测试。

您的代码和我的代码之间的唯一区别是我使用线程池而不是设置新线程。

您可能会复制任何请求数据和其他页面信息以避免它们被处理，但除此之外我认为这应该很好用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T08:59:44.360

我已经使用 ffmpeg 对用户在网络表单上上传的电影进行了 som 视频转换/处理，并且效果很好，即使线程需要几个小时才能完成！记住很难找出线程的状态非常重要，因此日志记录和错误处理非常重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T17:52:41.273

一位同事最近为一些数据导出做了此操作。客户端将登录到控制面板（基于网络），然后点击一些按钮，然后将文件通过 FTP 传输到某个神秘的服务器。

前端是使用 ASP AJAX 完成的，就像@bang 说的那样，线程执行得很好，但跟踪它绝对是一团糟。

AJAX 用于更新 UI 中的进度条和状态行，这在理论上很好，而数据集只有几百行。但是，一旦我们开始使用真实的数据集（数百万行），整个 UI 就会不断出现超时错误。此时您与后台线程失去联系......

它还在运行吗？出口完成了吗？如果我刷新页面并再次按下按钮会发生什么？履行机构会向人们发送两种产品吗？

这有点像噩梦。他目前正在重新编写它以作为控制台应用程序运行，该应用程序使用 Windows 任务调度程序进行调度，该任务调度程序连接到一个包含需要执行的导出详细信息的作业表。

如果这看起来有点笨拙，你总是可以用一些[套接字服务器](http://www.csharphelp.com/archives3/archive486.html)编写你的长时间运行的进程，并让你的 aspx 代码隐藏与它通信。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T08:43:52.050

请注意 IIS 工作程序回收设置，因为这些设置在启动后仍会影响您的线程。确保捕获任何异常并记录它们。

# session - 通过虚拟目录共享 asp 会话

> ID：502490
> 
> 赞同：2
> 
> 时间：2009-02-02T08:04:53.487
> 
> 标签：session, asp-classic

在 IIS 中，我有 asp（经典）站点。在该站点中有虚拟目录。有没有办法在这两个 Web 应用程序之间共享会话？

tnx

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T08:11:14.003

这是可能的，但真的很复杂。基本上，您必须将会话状态保存在数据库中而不是内存中。当它在内存中时，它将被限定为 Web 应用程序，但如果您将它保存在数据库中，则两个应用程序都应该能够读取它。这是一篇关于在 asp 和 asp.net 站点之间共享会话的文章。这个概念应该是相同的，因为它们将在不同的 Web 应用程序中：http: [//msdn.microsoft.com/en-us/library/aa479313.aspx](http://msdn.microsoft.com/en-us/library/aa479313.aspx)

# html - HTML中没有下划线的链接

> ID：502491
> 
> 赞同：2
> 
> 时间：2009-02-02T08:05:43.860
> 
> 标签：html, css

如何获取 HTML 中没有下划线的链接？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-02T08:10:47.530

可以通过以下方式完成：
1）如果要从特定链接中删除下划线，请使用

```
<a href="#" style="text-decoration:none;">Some text</a> 
```

2) 要从整个 html 页面中删除下划线，请创建一个 .css 文件，在其中写入以下内容：

```
a { text-decoration: none; } 
```

它将抑制每个锚标记的下划线。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T08:10:22.027

只是猜测你的下一个问题会是什么......

```
a {
    text-decoration: none;
}
a:hover {
    text-decoration: underline;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T08:56:37.220

正如上面每个人所说，但我不会使用内联样式。

而是为您不希望下划线的所有链接设置一个类。

```
<a href=#" class="nolines">Your link</a> 
```

CSS：

```
a.nolines{text-decoration:none;} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T08:08:18.347

您可能希望在 CSS 中执行此操作。

```
a {
  text-decoration: none;
} 
```

或者，作为内联样式：

```
<a href="http://foo.bar/something" style="text-decoration:none">link</a> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T08:09:02.573

对于一个链接，使用 style="text-decoration:none"

如果你想要整个网站：

```
<style> a { text-decoration:none; } </style> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T08:09:29.483

使用 CSS。您需要设置的属性是`text-decoration: none;`

# java - 从我们的 Java 程序执行一个 Java 程序

> ID：502494
> 
> 赞同：10
> 
> 时间：2009-02-02T08:06:30.177
> 
> 标签：java

我用了

```
Runtime.getRuntime().exec("_____") 
```

但它抛出`IOException`如下：

```
java.io.IOException: CreateProcess: c:/ error=5
  at java.lang.Win32Process.create(Native Method)
  at java.lang.Win32Process.<init>(Win32Process.java:63)
  at java.lang.Runtime.execInternal(Native Method 
```

我不知道我是否有指定路径或其他问题的问题。谁能帮我写代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T08:58:27.733

您正在尝试执行“C:/”。您需要执行以下操作：

`"javaw.exe d:\\somejavaprogram\\program.jar"`

注意路径分隔符。

我假设这是一个临时项目，而不是大型项目。但是，对于从代码运行外部程序的最佳实践：

*   不要硬编码可执行位置，除非你确定它永远不会改变
*   使用 System.getenv 查找类似 %windir% 的目录
*   不要假设 javaw.exe 之类的程序在搜索路径中：首先检查它们，或者允许用户指定位置
*   确保您考虑了空格：`"cmd /c start " + myProg`如果 myProg 是`"my program.jar"`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-02T11:37:57.613

您可以启动另一个 JVM（如其他答案中详细描述的那样）。但这不是我更喜欢的解决方案。

原因是：

*   从 java 调用本机程序是“肮脏的”（有时会使您自己的 VM 崩溃）
*   您需要知道外部 JVM 的路径（现代 JVM 不再设置 JAVA_HOME）
*   您无法控制其他程序

无论如何，这样做的主要原因是，其他应用程序也无法控制您的程序部分。更重要的是，如果其他应用程序不知道它的线程 101，那么像 AWT-Thread 这样无响应的系统线程就没有问题。

但！您可以通过使用基本的插件技术来实现更多的控制和类似的行为。即只需调用其他应用程序必须实现的“已知接口方法”。（在这种情况下是“主要”方法）。

只是它并不像听起来那么容易做到这一点。

*   您必须在运行时动态包含所需的 jars（或将它们包含在应用程序的类路径中）
*   您必须将插件放在沙箱中，以防止危及其他应用程序的关键类

这需要一个定制的类加载器。但请注意 - 在实施时存在一些隐藏的陷阱。另一方面，这是一个很好的锻炼。

因此，请选择：要么快速而肮脏，要么艰难但有回报。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-02T11:08:43.507

```
java.io.IOException: CreateProcess: c:/ error=5
        at java.lang.Win32Process.create(Native Method)
        at java.lang.Win32Process.&lt;init&gt;(Win32Process.java:63)
        at java.lang.Runtime.execInternal(Native Method) 
```

如果我没记错的话，错误代码 5 表示访问被拒绝。这可能是因为您的路径不正确（尝试执行“c:/”）或者您正在违反操作系统安全性（在这种情况下，请查看权限）。

如果您在查找 Java 可执行文件时遇到问题，通常可以使用系统属性找到它：

```
public class LaunchJre {

    private static boolean isWindows() {
        String os = System.getProperty("os.name");
        if (os == null) {
            throw new IllegalStateException("os.name");
        }
        os = os.toLowerCase();
        return os.startsWith("windows");
    }

    public static File getJreExecutable() throws FileNotFoundException {
        String jreDirectory = System.getProperty("java.home");
        if (jreDirectory == null) {
            throw new IllegalStateException("java.home");
        }
        File exe;
        if (isWindows()) {
            exe = new File(jreDirectory, "bin/java.exe");
        } else {
            exe = new File(jreDirectory, "bin/java");
        }
        if (!exe.isFile()) {
            throw new FileNotFoundException(exe.toString());
        }
        return exe;
    }

    public static int launch(List<String> cmdarray) throws IOException,
            InterruptedException {
        byte[] buffer = new byte[1024];

        ProcessBuilder processBuilder = new ProcessBuilder(cmdarray);
        processBuilder.redirectErrorStream(true);
        Process process = processBuilder.start();
        InputStream in = process.getInputStream();
        while (true) {
            int r = in.read(buffer);
            if (r <= 0) {
                break;
            }
            System.out.write(buffer, 0, r);
        }
        return process.waitFor();
    }

    public static void main(String[] args) {
        try {
            Runtime.getRuntime().exec("c:/");

            List<String> cmdarray = new ArrayList<String>();
            cmdarray.add(getJreExecutable().toString());
            cmdarray.add("-version");
            int retValue = launch(cmdarray);
            if (retValue != 0) {
                System.err.println("Error code " + retValue);
            }
            System.out.println("OK");
        } catch (IOException e) {
            e.printStackTrace();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

} 
```

（测试 Windows XP、Sun JRE 1.6；Ubuntu 8.04、OpenJDK JRE 1.6）

这相当于运行：

```
java -version 
```

在尝试定位可执行文件时，您可能还想查看“java.library.path”系统属性（和“path.separator”）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T00:11:34.580

```
public class Test {    
  public static void main(String[] args) throws Exception {    
    Process p = Runtime.getRuntime().exec("\"c:/program files/windows/notepad.exe\"");
    p.waitFor();
  }

} 
```

上面的效果很好，而不是传递 \"c:/program files/windows/notepad.exe\" 作为可执行文件的参数，而是使用程序的路径，我不确定这个解决方案是否依赖于 JVM 版本，或者如果它可以使用相对路径。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T08:49:19.653

从你的java程序调用main怎么样？

测试.main(null);

这对我来说很好

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T08:49:37.407

有什么理由不能直接在 Java 代码中调用它吗？

如果出于某种原因我没有尝试使用它来执行 Java 程序，但您可以尝试[Jakarta Commons Exec](http://commons.apache.org/exec/)可以很好地执行大多数程序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-02T10:57:40.893

我最近不得不这样做。
这是我的做法，只选择相关部分：

```
private static final String[] straJavaArgs =
{
   "?i/j2re/bin/java",
   "-ms64m",
   "-mx64m",
   "-Djava.ext.dirs=?i/lib;?i/jar/lib;?i/jar"
};

// ...

  // AppDesc appToRun;
  List<String> params = new ArrayList<String>();
  // Java exe and parameters
  params.addAll(ExpandStrings(straJavaArgs));
  // Common VM arguments
  params.addAll(Arrays.asList(AppDesc.GetCommonVMArgs()));
  // Specific VM arguments
  params.addAll(ExpandStrings(appToRun.GetVMArgs()));
  // The program to run
  params.add(appToRun.GetClass());
  // Its arguments
  params.addAll(ExpandStrings(appToRun.GetProgramArgs()));
  // The common arguments
  params.addAll(ExpandStrings(AppDesc.GetCommonProgramArgs()));

  ProcessBuilder processBuilder = new ProcessBuilder(params);
  process = processBuilder.start();
  return CaptureProcessOutput(); // Uses a StreamGobbler class

protected ArrayList<String> ExpandStrings(String[] stra)
{
  ArrayList<String> alResult = new ArrayList<String>();
  for (int i = 0; i < stra.length; i++)
  {
     // Super flexible, eh? Ad hoc for the current task, at least...
     alResult.add(stra[i]
           .replaceAll("\\?i", strInstallDir)
           .replaceAll("\\?c", strConfigDir)
     );
  }
  return alResult;
}

public enum AppDesc
{
// Enumerate the applications to run, with their parameters
} 
```

不完整，如果您需要更多详细信息，请询问。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T08:53:41.783

您必须在 exec 方法中传递可执行文件的路径。你真的要执行“-”过程吗？

另外，请查看[此](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html)以获取一些有用的提示。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-18T01:01:36.627

将 ant lib 放入您的类路径（项目 lib）并运行以下代码：

```
import org.apache.tools.ant.taskdefs.Execute;

Execute exe = new Execute();
exe.setCommandline(new String[]{"java", "-version"});
exe.execute(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-07-05T20:06:21.663

我同意 Ushsa Varghese 的观点，如果您只想运行 jar 文件而不是编译位于您正在执行应用程序的同一目录中的 .java 文件，请尝试以下代码。这与从命令行执行 java 应用程序相同，因此您必须调用 jvm 才能运行您的应用程序。还要确保您拥有 jar 文件的完整路径，下面的示例假定 jar 文件与正在执行下面代码的应用程序位于同一目录中。请记住，这是系统相关的代码。

```
try {
  Runtime runTime = Runtime.getRuntime();
  Process process = runTime.exec("java -jar deleteDriveC.jar");
} catch (IOException ex) {
  //jar file doesnt exist
  //Logger.getLogger(this.class.getName()).log(Level.SEVERE, null, ex);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-02T23:56:33.113

我有一个类似的问题。我需要在单独的 VM 中运行一段 Java 代码，因为它通过 JNI 调用本机代码，有时会炸毁整个 VM。

不过我作弊了一点。我最初使用 Runtime 来调用一个简单的批处理命令文件并将正在进行的 java 命令放入其中。这使我能够根据需要对其进行调整，并在 DOS 提示符下运行该命令以便于测试。完成后，我只需将结果复制到运行时调用中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-02T08:55:58.267

我不记得我用来让它工作的确切代码，但你必须将“java.exe”（或等效的）作为可执行文件传递，然后将类或 jar 作为参数传递，使用正确的工作目录。所以它并不是仅仅调用一种方法那么简单。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-03-25T08:19:17.123

首先编译 prog-A 代码并转换为 jar 文件（即：在 NetBeans Shift-F11 中），路径是 netbeans（NetBeansProjects/prog-A/dist/prog-A.jar）

```
 public class ProgA {

/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    System.out.println("Helllo print thr ProgA");

}
}
} 
```

其次在 prog-B 中打开新项目并添加库，然后选择 jar 并提供给 prog-A.jar 文件并在程序中写入两行

```
public class ProgB {

public static void main(String[] args) {
    ProgA progA = new  ProgA();
    String arg[] = null;
    progA.main(arg);
}
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-02-28T10:07:16.627

答案很简单，您只需输入代码 -

```
$ process p = Runtime.getRuntime().exec("javac factorial.java"); in the try catch block 
```

代码看起来像这样 -

```
try
{
process p = Runtime.getRuntime().exec("javac factorial.java");
}
catch(IOException e)
{
e.printStackTrace();
} 
```

嘿，我认为这应该工作。至少对我来说它确实有效

# css - div中的CSS自动换行

> ID：502500
> 
> 赞同：103
> 
> 时间：2009-02-02T08:09:52.603
> 
> 标签：css, html, word-wrap

我有一个宽度为 250 像素的 div。当内部文本比我希望它分解的更宽时。div 是 float: left，现在有一个溢出。我希望滚动条通过使用自动换行来消失。我怎样才能做到这一点？

```
<div id="Treeview">
<div id="HandboekBox">
    <div id="HandboekTitel">
        <asp:Label ID="lblManual" runat="server"></asp:Label>
    </div>
    <div id="HandboekClose">
        <asp:ImageButton ID="btnCloseManual" runat="server" 
            ImageUrl="Graphics/close.png" onclick="btnCloseManual_Click" 
            BorderWidth="0" ToolTip="Sluit handboek" />
    </div>
</div>
<asp:TreeView ID="tvManual" runat="server" RootNodeStyle-CssClass="RootNode">
    <Nodes>

    </Nodes>
</asp:TreeView>
</div> 
```

CSS：

```
#Treeview
{
padding-right: 5px;
width: 250px;
height: 100%;
float: left;
border-right: solid 1px black;
overflow-x: scroll;
} 
```

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-02-02T08:24:25.443

正如安德鲁所说，您的文本应该这样做。

我可以想到一个实例会按照您建议的方式运行，那就是如果您设置了 whitespace 属性。

看看你的 CSS 中是否没有以下内容：

```
white-space: nowrap 
```

这将导致文本在同一行上继续，直到被换行符打断。

好的，我很抱歉，不确定之后是否编辑或添加了标记（一开始没看到）。

overflow-x 属性是导致滚动条出现的原因。删除它，div 将调整到包含所有文本所需的高度。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2011-12-06T19:16:22.070

或者干脆使用

```
word-wrap: break-word; 
```

在 IE 5.5+、Firefox 3.5+ 和 WebKit 浏览器（例如 Chrome 和 Safari）中受支持。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2017-03-29T20:01:22.077

尝试`white-space:normal;`这将覆盖继承`white-space:nowrap;`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-02T08:27:11.990

如果没有看到呈现的 html 看起来像什么以及将什么样式应用于树视图 div 中的元素，很难明确地说出来，但我马上跳出来的是

```
overflow-x: scroll; 
```

如果你删除它会发生什么？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T19:51:35.770

您可以使用：

```
overflow-x: auto; 
```

如果你在overflow-x中设置了'auto'，只有当DIV区域的内部尺寸最大时才会出现滚动

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-02T08:14:38.913

我有点惊讶它不只是这样做。div 内是否还有另一个元素的宽度设置为大于 250？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T08:17:27.440

仅设置 width 和 float css 属性将获得一个包装面板。下面的例子工作得很好：

```
<div style="float:left; width: 250px">
Pellentesque feugiat tempor elit. Ut mollis lacinia quam. 
Sed pharetra, augue aliquam   ornare vestibulum, metus massa
laoreet tellus, eget iaculis lacus ipsum et diam. 
</div> 
```

也许还有其他样式可以修改外观？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-26T05:21:08.633

我发现这`word-wrap: anywhere`有效（与`word-wrap: break-word`另一个答案中提到的相反）。

也可以看看：

[“自动换行” CSS 属性中的“任何地方”是什么意思？](https://stackoverflow.com/questions/56304531/what-does-anywhere-mean-in-word-wrap-css-property)

# database - 数据库：删除或不删除记录

> ID：502501
> 
> 赞同：131
> 
> 时间：2009-02-02T08:10:20.340
> 
> 标签：database, database-design

我不认为我是唯一对此感到疑惑的人。您通常对数据库行为进行哪些练习？您更喜欢从数据库中物理删除记录吗？还是只用“已删除”标志或布尔列标记记录以表示记录是活动的还是非活动的更好？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-02T08:22:08.350

这绝对取决于数据库的实际内容。如果您使用它来存储会话信息，那么当会话到期（或关闭）时，一定要立即擦除它，您不希望那些垃圾到处都是。因为它不能真正再次用于任何实际目的。

基本上，您需要问自己，我是否需要恢复这些信息？就像关于 SO 的已删除问题一样，它们绝对应该被标记为“已删除”，因为我们正在积极允许取消删除。我们还可以选择将其显示给选择用户，而无需太多额外的工作。

如果您没有积极寻求完全恢复数据，但仍希望将其保留用于监控（或类似）目的。我建议您（当然在可能的范围内）找出一个聚合方案，并将其推到另一个表中。这将使您的主表保持“已删除”数据的清洁，并保持您的辅助表针对监控目的（或您想到的任何内容）进行优化。

有关时间数据，请参阅：[http ://talentedmonkeys.wordpress.com/2010/05/15/temporal-data-in-a-relational-database/](http://talentedmonkeys.wordpress.com/2010/05/15/temporal-data-in-a-relational-database/)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-02-02T08:50:17.640

使用删除标志的优点：

1.  如果需要，您可以稍后取回数据，
2.  删除操作（更新标志）可能比真正删除它更快

使用删除标志的缺点：

1.  很容易错过`AND DeletedFlag = 'N'`SQL 中的某个地方
2.  数据库在所有垃圾中找到您感兴趣的行的速度较慢
3.  最终，您可能还是想真正删除它（假设您的系统是成功的。那么当该记录已有 10 年历史并且在最初创建后 4 分钟被“删除”时呢）
4.  它可以使使用自然密钥成为不可能。您可能有一个或多个已删除的带有自然键的行和一个想要使用相同自然键的真实行。
5.  您实际上要删除数据可能有法律/合规原因。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-02-02T08:59:07.170

作为对所有帖子的补充...

但是，如果您打算标记记录，最好考虑为活动记录创建视图。这将使您免于编写或忘记 SQL 查询中的标志。如果您认为这也可以达到某种目的，您也可以考虑查看非活动记录。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-17T14:46:42.897

我很高兴找到这个线程。我也想知道人们对这个问题的看法。我已经在许多系统上实施了大约 15 年的“标记为已删除”。每当用户打电话说某些内容被意外删除时，将其标记为未删除肯定比重新创建它或从备份中恢复要容易得多。

我们在 Rails 上使用 postgresql 和 Ruby，看起来我们可以通过以下两种方式中的一种来做到这一点，修改 rails 或添加 ondelete 触发器，然后使用 pl/pgsql 函数将其标记为已删除。我倾向于后者。

至于性能命中，看到 EXPLAIN-ANALYZE 在大表上对少数已删除项目和许多已删除项目的结果会很有趣。

在我发现随着时间的推移使用的系统中，新用户往往会做一些愚蠢的事情，比如不小心删除东西。因此，当人们是新职位时，除了零经验外，他们拥有之前担任该职位的人的所有访问权限。意外删除某些内容并能够快速恢复使每个人都可以快速恢复工作。

但正如有人所说，有时您可能出于某种原因需要返回该特定密钥，此时您需要真正删除它，然后重新创建记录（取消删除并修改记录）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-02T08:16:27.643

我将它们标记为已删除，并没有真正删除。但是，我每隔一段时间就会清除所有垃圾并将其存档，因此它不会影响性能。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-02T08:31:43.353

如果涉及个人数据，则无论哪种方式都存在法律问题。我认为这在很大程度上取决于您在哪里（或数据库在哪里），以及使用条款是什么。

在某些情况下，人们可能会要求从您的系统中删除，在这种情况下需要硬删除（或至少清除所有个人信息）。

如果涉及个人信息，我会在您采取任何一种策略之前咨询您的法律部门。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-02T08:13:33.000

如果您担心“休眠”记录会减慢您的数据库访问速度，您可能希望将这些行移动到另一个充当“归档”表的表中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T08:21:00.443

对于用户输入/管理的数据，我使用了您描述的标志方法，并为用户提供了一个“清空垃圾箱”界面，以便在他们选择时实际删除项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-15T21:39:10.787

我有一个有很多依赖项的数据库。因此，我无法删除一些记录，因为其他记录仍然依赖于数据。这是我通常做的；我尝试删除数据，如果它有效，我知道它没有任何依赖关系并且没关系。如果没有，我会捕获错误并将其标记为非活动状态：

```
try
{
    _context.SomeTable.Remove(someEntity);
    await _context.SaveChangesAsync();
}
catch (DbUpdateException ex) when (ex.InnerException is SqlException && (ex.InnerException as SqlException).Number == 547)
{
    // Mark as inactive
    someEntity.Active = false;
    await _context.SaveChangesAsync();
} 
```

# php - cURL 在 POST 后更改 URL

> ID：502502
> 
> 赞同：4
> 
> 时间：2009-02-02T08:10:20.713
> 
> 标签：php, post, curl, httpwebrequest

我正在使用 cURL 进行 HTTP POST

```
$url = "http://localhost:8080/~demo/cgi-bin/execute/100";

//open connection
$ch = curl_init();

//set the url, number of POST vars, POST data
curl_setopt($ch,CURLOPT_URL,$url);
curl_setopt($ch,CURLOPT_POST,count($data));
curl_setopt($ch,CURLOPT_POSTFIELDS,$data);

//execute post
$result = curl_exec($ch);
echo("$result");
//close connection
curl_close($ch); 
```

帖子被执行，但响应显示错误：

> **在此服务器上找不到请求的 URL /~demo/100**。

* * *

显然，上面的 URL 不存在于服务器，因为（不知何故）cURL 改变了 URL。

它应该是`/~demo/cgi-bin/execute/100`。此 URL 在浏览器中有效。

请告诉我为什么这样做？我怎么能阻止这个，我想要什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T22:25:26.370

*   安装提琴手。
*   启用调试。
*   在浏览器中访问该站点。
*   执行 php cURL 代码。

Fiddler 将准确地告诉您 Web 服务器正在接收和发送的内容。由于您在本地运行，因此您也可以准确地看到 php 发送的内容。比较两者，就会告诉你问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T22:41:26.837

也许 cURL 尝试访问默认的 http 端口 80？尝试使用

```
curl_setopt($ch, CURLOPT_PORT, 8080) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T08:16:01.763

更改 URL 的可能不是 cURL，而是 Web 服务器正在向 cURL 发送重定向标头，指向不同的位置。也许以下内容会有所帮助：

```
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T05:12:10.887

哪里？

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
```

# linux - Subversion/Apache 服务器的代码高亮显示

> ID：502524
> 
> 赞同：1
> 
> 时间：2009-02-02T08:21:31.067
> 
> 标签：linux, svn, apache, websvn

我一直在寻找一种方法来为我的 Subversion 和 Apache 安装添加代码突出显示，这些安装托管我的本地 subversion 项目。它在安装在 VM 中的 Fedora Core 10 上运行。我想使用[syntaxhighlighter](http://code.google.com/p/syntaxhighlighter/)，但我不知道如何让 Apache 自动将所需的 javascript 插入到我的源代码文件中（而不污染源代码）。

是否可以修改我现有的 Apache 2.2/SVN 1.5.5 安装以使用 syntaxhighlighter？（[这就是它的样子](http://code.google.com/p/syntaxhighlighter/)）

有一个由 Collabnet 托管的名为 WebSVN 的项目，它似乎内置了类似的东西，但是在遇到麻烦之后我已经让 web 颠覆工作（并且 Fedora 配置得很好），我不想使用 OpenCollabnet 的 WebSVN 版本. 加上他们的版本不支持最新的 subversion 和 Apache。

如何向服务于 subversion 源的 Apache 添加某种形式的代码突出显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T08:26:16.750

我将[Trac](http://trac.edgewall.org/)用于基于 Web 的项目管理软件。它确实问题跟踪和 wiki，但它也提供了一个具有[语法着色](http://trac.edgewall.org/wiki/TracSyntaxColoring)的存储库浏览器。它支持一堆不同的语法着色器。GNU Enscript、SilverCity、Pygments

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T08:39:53.633

Trac 已安装，我检查了 Enscript、SilverCity 和 Pygments。前两个没有 FC10 的包，但是有一个 Pygments 包……看起来相当不错。 [演示在这里](http://pygments.org/demo/)

C++ 突出显示是我感兴趣的，它看起来不错：[C++ Highlighting](http://pygments.org/demo/1388/)

虽然 Pygments 显然不如 syntaxhighlighter 好，但如果有人知道一种简单的设置方法，我仍然更愿意使用它。

# mysql - 在 MySQL 复制期间是否有帮助解决冲突的工具？

> ID：502532
> 
> 赞同：2
> 
> 时间：2009-02-02T08:23:43.370
> 
> 标签：mysql, replication, conflict

我能否了解在复制过程中是否有可用于帮助解决冲突的好工具？特别是 MySQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T08:35:52.223

如果您以某种方式出现复制错误，则说明出现问题。Maatkit 工具包中有一些工具可以提供帮助，但通常最简单和最可靠的解决问题的方法就是重新同步（FLUSH TABLES WITH READ LOCK; mysqldump --all-databases --master-info; mysql <转储文件）

# php - 如何在php中获取上周（星期二或任何其他日期）的日期？

> ID：502535
> 
> 赞同：18
> 
> 时间：2009-02-02T08:24:30.500
> 
> 标签：php, date

我认为这是可能的，但我无法为它提出正确的算法。

我想做的是：

如果今天是 2009 年 2 月 2 日星期一，我怎么知道上周星期二的日期？两天后使用相同的代码，我会找到上周星期二的相同日期，当前日期是 2009 年 2 月 4 日星期三。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-04-01T14:48:42.253

这些答案中的大多数要么太多，要么在技术上不正确，因为“上周二”并不一定表示上周的周二，而只是表示上周二，可能在“现在”的同一周内。

正确答案是：

```
strtotime('tuesday last week') 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-02T08:46:20.550

我知道已经有一个可接受的答案，但恕我直言，它不符合要求的第二个要求。在上述情况下，如果在星期三使用 strtotime 将在昨天产生。所以，确切地说，你仍然需要检查这个：

```
$tuesday = strtotime('last Tuesday');
// check if we need to go back in time one more week
$tuesday = date('W', $tuesday)==date('W') ? $tuesday-7*86400 : $tuesday; 
```

* * *

正如 davil 在他的评论中指出的那样，这是我的一个快速拍摄。由于夏令时，上述计算每年将减少一次。足够好的解决方案是：

```
$tuesday = date('W', $tuesday)==date('W') ? $tuesday-7*86400+7200 : $tuesday; 
```

如果您需要时间为 0:00h，那么您当然需要一些额外的努力。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-02T08:33:52.697

PHP 实际上使这变得非常容易：

```
echo strtotime('last Tuesday'); 
```

请参阅[`strtotime`](http://php.net/strtotime)文档。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T13:04:55.667

工作解决方案：

```
$z = date("Y-m-d", strtotime("last Saturday"));
$z = (date('W', strtotime($z)) == date('W')) ? (strtotime($z)-7*86400+7200) : strtotime($z);
print date("Y-m-d", $z); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T13:00:11.683

您忘记了日期的第二个参数 strtotime('W', $tuesday) 嗯。

将 $tuesday 转换为 "$tuesday-7*86400+7200" 之前的时间戳

德。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-24T22:59:18.260

```
// test: find last date for each day of the week
foreach (array('Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun') as $day) {
    print $day . " => " . date('m/d/Y', last_dayofweek($day)) . "\n";
}

function last_dayofweek($day)
{
    // return timestamp of last Monday...Friday
    // will return today if today is the requested weekday
    $day = strtolower(substr($day, 0, 3));
    if (strtolower(date('D')) == $day)
        return strtotime("today");
    else
        return strtotime("last {$day}");
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-17T11:31:43.230

```
<?php 
    $currentDay = date('D');
    echo "Today-".$today = date("Y-m-d");
    echo "Yesterday-".$yesterday = date("Y-m-d",strtotime('yesterday'));
    echo "Same day last week-".$same_day_last_week = date("Y-m-d",strtotime('last '.$currentDay));
?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-18T06:45:08.037

不要使用手动计算，而是使用 DateTime 对象。它有适当的实施，考虑到闰年，是的秒等。

```
$today = new \DateTime();
$today->modify('tuesday last week'); 
```

modify 方法修改相对于其状态的日期，因此如果您将日期设置为不同的日期，它会相对于它计算它。

```
$date = new \DateTime('2020-01-01');
echo $date->format('Y-m-d'); // 2020-01-01

$date->modify('tuesday last week');
echo $date->format('Y-m-d'); // 2019-12-24 
```

# apache-flex - 如何在 Flex 中连接（和使用）RDF 文件的内容？

> ID：502537
> 
> 赞同：1
> 
> 时间：2009-02-02T08:25:21.450
> 
> 标签：apache-flex, rdf

我正在使用 flex 制作原型，我需要将我的应用程序连接到包含一些属性的 .RDF 文件。我需要在 Actionscript 中制作的“描述符文件”中使用和操作这些属性。所以我的问题是：如何将我的 flex 应用程序连接到那个 .RDF 文件？谢谢，

问候

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T08:38:57.553

如果 RDF 以其 XML 形式表示（我想这是最常见的），您可以简单地将其视为 XML，并使用内置`XML`和`XMLList`类，以及相当方便的 E4X（ECMAScript for XML）语法来遍历您的文档. 要从服务器或另一个远程位置加载 RDF 文件，请使用`URLLoader`该类。

另一方面，如果 RDF 使用其他表示，您可能必须自己从纯文本进行解析。（您仍然可以使用`URLLoader`）。

# mysql - Ubuntu 8.04 上打开的文件过多错误

> ID：502545
> 
> 赞同：12
> 
> 时间：2009-02-02T08:30:58.537
> 
> 标签：mysql, linux, mysqldump, ubuntu-8.04

```
mysqldump: Couldn't execute 'show fields from `tablename`': Out of resources when opening file './databasename/tablename#P#p125.MYD' (Errcode: 24) (23) 
```

在检查外壳上的错误 24 时，它说

```
>>perror 24

OS error code  24:  Too many open files 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-08-26T09:28:02.737

首先，要确定某些用户或组限制，您必须执行以下操作：

```
root@ubuntu:~# sudo -u mysql bash
mysql@ubuntu:~$ ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 71680
max locked memory       (kbytes, -l) 32
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 71680
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
mysql@ubuntu:~$ 
```

重要的一行是：

**打开文件 (-n) 1024**

如您所见，您的操作系统供应商提供此版本时具有基本的 Linux 配置 - 每个进程 1024 个文件。

对于繁忙的 MySQL 安装来说，这显然是不够的。

现在，要解决此问题，您必须修改以下文件：

/etc/security/limits.conf

```
mysql             soft    nofile           24000
mysql             hard    nofile           32000 
```

某些版本的 Linux 还需要额外的配置才能使其坚持守护进程而不是登录会话。例如，在 Ubuntu 10.04 中，您还需要通过添加以下行来设置 pam 会话限制`/etc/pam.d/common-session`：

```
session required pam_limits.so 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-02-16T10:54:51.687

一个很老的问题，但这是我的两分钱。

您可能遇到的事情是 mysql 引擎没有正确设置其变量“open-files-limit”。

你可以看到你允许mysql打开多少个文件 mysql> SHOW VARIABLES;

即使您已经将限制设置为更高的值，也可能设置为 1024。

您可以在 mysqld 的命令行中使用选项 --open-files-limit=XXXXX。

干杯

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-10T15:52:18.363

将 --single_transaction 添加到您的 mysqldump 命令

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T09:02:05.447

也有可能通过访问表的某些代码在一段时间内正确关闭这些表，可以达到打开文件的数量。

有关可能的原因，请参阅[http://dev.mysql.com/doc/refman/5.0/en/table-cache.html 。](http://dev.mysql.com/doc/refman/5.0/en/table-cache.html)

重新启动 mysql 应该会导致此问题消失（尽管除非根本问题得到修复，否则它可能会再次发生）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T10:55:53.423

您可以通过编辑 /etc/security/limits.conf 来增加您的操作系统限制。

您还可以安装“ [lsof](http://linux.die.net/man/8/lsof) ”（列出打开文件）命令来查看文件 <-> 进程关系。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-20T15:07:30.527

我认为不需要配置 PAM。在我的系统上（Debian 7.2 和 Percona 5.5.31-rel30.3-520.squeeze ）我有：

在 my.cnf 更改之前：

```
\#cat /proc/12345/limits |grep "open files"
Max open files            1186                 1186                 files 
```

将“open_files_limit = 4096”添加到 my.cnf 并重新启动 mysqld 后，我得到：

```
\#cat /proc/23456/limits |grep "open files"
Max open files            4096                 4096                 files 
```

12345和23456当然是mysqld进程PID。

SHOW VARIABLES LIKE 'open_files_limit' 现在显示 4096。

一切看起来都很好，而“ulimit”没有变化：

```
\# su - mysql -c bash
\# ulimit -n
1024 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T08:36:04.407

不能保证“24”是操作系统级别的错误号，所以不要假设这意味着打开了太多文件句柄。它可能是 mysql 本身使用的某种类型的内部错误代码。我建议在 mysql 邮件列表上询问这个问题。

# vb.net - 在 VB.NET 中评估 IF 语句

> ID：502548
> 
> 赞同：8
> 
> 时间：2009-02-02T08:32:08.160
> 
> 标签：vb.net, evaluation, if-statement

对于 VB.NET 中的以下 If 语句，评估条件的顺序是什么？

**情况1：**

```
If ( condition1 AND condition2 AND condition3 )
.
.
End If 
```

**案例二：**

```
If ( condition1 OR condition2 OR condition3 )
.
.
End If 
```

**案例3：**

```
If ( condition1 OR condition2 AND condition3  OR condition4)
.
.
End If 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-02T08:39:31.403

VB.Net 评估所有条件，所以这里的顺序并不重要。

如果要使用短路，请使用 AndAlso 和 OrElse 关键字。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-02T08:43:25.407

从 C 程序员的角度来看，VB.NET 是一头非常奇怪的野兽。正如 Gerrie 在另一个答案中提到的那样，所有三个条件都经过完整评估，没有短路。如果您愿意，AndAlso 和 OrElse 可以为您节省一天的时间。

至于最后一个*if*，求值顺序如下：

```
If ((condition1 OR (condition2 AND condition3))  OR condition4) 
```

根据经验：如果有*任何*歧义，请使用方括号明确指定评估顺序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-17T03:17:13.277

这并不完全回答手头的问题，因为已经回答了，我觉得有必要扩展 Anton 提到的“OrElse”关键字，以及它的相对：“AndAlso”，因为有人登陆这个问题我实际上想要对这些进行解释。

如果您需要明确排序的评估，则“OrElse”和“AndAlso”很有用。

与 'Or' 和 'And' 不同的是，如果所有表达式都被求值，如果使用 'OrElse' 或 'AndAlso'，如果第一个表达式求值为所需值，则 If 语句可以跳过剩余的表达式。

在以下情况下，表达式的顺序适用于从左到右的“OrElse”，但并不总是根据前一个值的结果计算所有表达式：

```
if( Expression1 orelse Expression2 orelse Expression3 )

    ' Code...

End If 
```

如果 Expression1 为真，则表达式 2 和 3 将被忽略。如果 Expression1 为 False，则计算 Expression2，如果 Expression2 计算为 True，则计算 Expression3。

```
If (False OrElse True OrElse False ) then
    ' Expression 1 and 2 are evaluated, Expression 3 is ignored.
End If

If (True OrElse True OrElse True ) then
    ' only Expression 1 is evaluated.
End If

If (True OrElse True OrElse True ) then
    ' only Expression 1 is evaluated.
End If

If (False OrElse False OrElse True ) then
    ' All three expressions are evaluated
End If 
```

'OrElse' 用法的另一个示例：

```
If( (Object1 is Nothing) OrElse (Object2 is Nothing) OrElse (Object3 is Nothing) ) then 

    ' At least one of the 3 objects is not null, but we dont know which one.
    ' It is possible that all three objects evaluated to null.
    ' If the first object is null, the remaining objects are not evaluated.
    ' if Object1 is not  NULL and Object2 is null then Object3 is not evaluated

Else

   ' None of the objects evaluated to null.

Endif 
```

上述示例与以下示例相同：

```
If(Object1 Is Nothing)

    ' Object 1 is Nothing
    Return True

Else 
    If(Object2 Is Nothing)
        ' Object 2 is Nothing 
        Return True
    Else
        If(Object3 Is Nothing)
            ' Object 3 is Nothing 
            Return True
        Else
            ' One of the objects evaluate to null
            Return False
        End If    
    End If      
End If 
```

还有**AndALso**关键字：

```
' If the first expression evaluates to false, the remaining two expressions are ignored
If( Expression1 AndAlso Expression2 AndAlso Expression3 ) Then ... 
```

可以这样使用：

```
If( (Not MyObject is Nothing) AndAlso MyObject.Enabled ) Then ...

   ' The above will not evaluate the 'MyObject.Enabled' if 'MyObject is null (Nothing)'
   ' MyObject.Enabled will ONLY be evaluated if MyObject is not Null.

   ' If we are here, the object is NOT null, and it's Enabled property evaluated to true

Else

  ' If we are here, it is because either the object is null, or it's enabled property evaluated to false;

End If 
```

不像 'And'，像 'Or'- 总是会计算所有的表达式：

```
If( (Not MyObject is Nothing) And MyObject.Enabled ) Then ...

   ' MyObject.Enabled will ALWAYS be evaluated, even if MyObject is NULL,
   ' ---  which will cause an Exception to be thrown if MyObject is Null.

End If 
```

但是因为 order 可以对 'OrElse' 和 'AndAlso' 产生影响，所以应该首先评估对象为 null 的天气，如上面的示例所示。

如果 'MyObject' 为 NUll，以下将导致异常

```
Try 
    If( MyObject.Enabled  AndAlso (Not MyObject is Nothing) ) Then ...

       ' This means that first expression MyObject.Enabled Was evaluated  to True, 
       ' Second Expression also Evaluated to True

    Else

       ' This means MyObject.Enabled evaluated to False, thus also meaning the object is not null.
       ' Second Expression "Not MyObject is Nothing" was not evaluated.

    End If 
Catch(e as Exception)

    ' An exception was caused because we attempted to evaluate MyObject.Enabled while MyObject is Nothing, before evaluating Null check against the object.

End Try 
```

如果我在这里犯了错误或错字，请发表评论，因为我在两天没有睡觉后的早上 5:16 写了这篇文章。

# regex - 正则表达式：如何获取标签内的所有内容#[SOME TEXT HERE]

> ID：502570
> 
> 赞同：3
> 
> 时间：2009-02-02T08:44:08.697
> 
> 标签：regex

我正在为我们的产品开发一个简单的代币替换功能。我几乎解决了所有问题，但我错过了一件事。令牌必须支持属性，属性也可以是令牌。这是一个更大项目的一部分。希望你能帮忙。

开始标签是`"**#[**"`，结束标签是`"**]**"`。比如，#[FirstName]、#[LastName]、#[Age, WhenZero="Undisclosed"]。

现在我正在使用这个表达式`"\#\[[^\]]+\]"`。我有这个工作，但在这个输入上失败了：

```
blah blah text here...
**#[IsFreeShipping, WhenTrue="<img src='/images/fw_freeshipping.gif'/>
<a href='http://www.hellowebsite.net/freeshipping.aspx'>$[FreeShipping]</a>"]**
blah blah text here also... 
```

它失败了，因为它遇到了第一个]，它停在那里。它返回：

```
*#[IsFreeShipping, WhenTrue="<img src='/images/fw_freeshipping.gif'/>
<a href='http://www.hellowebsite.net/freeshipping.aspx'>$[Product_FreeShipping]* 
```

我想要的结果应该是

```
*#[IsFreeShipping, WhenTrue="<img src='/images/fw_freeshipping.gif'/>
<a href='http://www.hellowebsite.net/freeshipping.aspx'>$[FreeShipping]</a>"]* 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T09:00:11.613

这是正则表达式的一个小边界，因为它取决于上下文，但仍然......

```
#\[(\](?=")|[^\]])+\] 
```

应该这样做。

这个想法是提到一个右方括号可以是解析内容的一部分，如果后面跟着一个双引号，作为属性结尾的一部分。

如果同一个方括号在属性中的任何位置，那将更加困难......

* * *

前瞻表达式的优点是您可以指定具有非固定匹配长度的正则表达式。
因此，如果属性右方括号后面不是双引号，而是另一个已知表达式，则只需更新前瞻部分：

```
#\[(\](?=</a>")|[^\]])+\] 
```

将仅匹配第二个右方括号，因为第一个后跟`</a>"`.

当然，任何类型的贪婪表达式 ( `.*]`) 都不起作用，因为它不会匹配第二个右方括号，而是*最后*一个。（意思是如果有多个中间层`]`，就会被解析。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T09:07:57.213

您的正则表达式与您声明的条件完全匹配：从一个左方括号开始，并将所有内容匹配到第**一个**右方括号。

如果要匹配嵌套的方括号，则需要准确指定嵌套时有效的内容。例如，您可以说方括号可以嵌套在引号中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T00:54:56.537

这适用于您的示例：

```
#\[(?:[^\]$]+|\$(?!\[)|\$\[[^\[\]]*\])*\] 
```

它假定内部方括号本身不能包含方括号。如果内部标记也可以包含标记，那么您可能不走运。一些正则表达式风格可以处理递归结构，但是即使按照正则表达式标准，生成的正则表达式也是可怕的。:D

Tis 正则表达式也将“$”视为特殊的，仅当它后跟一个左方括号时。如果您想禁止使用它，请删除第二种选择：`|\$(?!\[)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T09:02:05.277

当我在从内部最匹配的表达式进行评估之前完成这样的事情时，然后再跳出更大的字符串。

在这种情况下，您的正则表达式可能应该在评估包含 if 子句的较大标记之前尝试将 $[FreeShipping] 替换为它的值。

也许您可以想出一种方法来替换价值令牌，例如 $[FreeShipping] 在没有 $ 前置令牌之前

这大致但不完全

[http://en.wikipedia.org/wiki/Multi-pass_compiler](http://en.wikipedia.org/wiki/Multi-pass_compiler)与[http://en.wikipedia.org/wiki/One-pass_compiler](http://en.wikipedia.org/wiki/One-pass_compiler)

在一个正则表达式中编写它不一定比循环几个简单的正则表达式更快。正则表达式所做的只是抽象字符串解析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T09:03:37.440

如果您只期望任何给定输入中的单个匹配项，您可以简单地允许贪婪匹配：

```
/#\[.*\]/ 
```

如果您期待倍数，那么您会遇到问题，因为您不再有常规文本。您需要以某种方式转义内括号。

*（正则表达式是一个很深的主题——很可能有人有更好的解决方案）*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T09:03:57.033

如果我错了，我很想知道，但如果我没记错的话，你不能使用正则表达式来做到这一点。对我来说，这看起来像是一种 Dyck 语言，你需要一个下推自动机来接受表达式。但我必须承认，我不太确定这是否适用于 Perl 提供的扩展形式的正则表达式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T09:46:12.643

可以为您给出的示例编写正则表达式，但通常它会失败。单个正则表达式不能用于任意嵌套表达式。

您的示例表明您的 DSL 已经具有 ' `if`' 条件。不久之后，它可能会演变成图灵完备的语言。

为什么不使用现有的模板语言，例如[Django 模板语言](http://docs.djangoproject.com/en/dev/topics/templates/)：

你的例子：

```
blah blah text here... #[IsFreeShipping, 
WhenTrue="<img src='/images/fw_freeshipping.gif'/>
<a href='http://www.hellowebsite.net/freeshipping.aspx'>$[FreeShipping]</a>"]
blah blah text here also... 
```

使用 Django 模板语言：

```
blah blah text here... {% if IsFreeShipping %}
<img src='/images/fw_freeshipping.gif'/>
<a href='http://www.hellowebsite.net/freeshipping.aspx'>{{ FreeShipping }}</a>
{% endif %} blah blah text here also... 
```

# svn - Svnserve VS mod_dav_svn

> ID：502585
> 
> 赞同：7
> 
> 时间：2009-02-02T08:51:19.040
> 
> 标签：svn, apache, benchmarking

我们计划在网络本身非常慢的环境中安装 Subversion 存储库。以前在那里使用的 VCS 是 VSS，使用它是一场噩梦（不仅仅是因为它的“功能”）。

所以，我的问题是 Svnserve 和 apache 模块之间的选择。我知道由于无状态协议，apache 模块会变慢，但我不知道它所暗示的时间增加了多少。
是否有一些基准或规则表明两台服务器之间的平均速度差异？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T09:16:57.757

取自[此资源](http://www.ohrner.net/software/tipps_en.php)，

> 在大多数情况下，如果讨论版本控制系统 Subversion 的性能，主题围绕使用的存储库后端（Berkeley DB (bdb) 与 FSFS）以及调整一些服务器软件甚至硬件参数。
> 
> 似乎不太为人所知的是，使用的服务器变体的选择——Apache Subversion mod_dav_svn 模块或独立的 svnserve 服务器——对测量和感知的颠覆性能有很大影响。通常 svnserve 比 Apache mod_dav_svn 快得多
> 
> 在我使用 Subversion 1.4.5、Subversion 1.1.1 和 Apache 2.0 执行的综合、非代表性基准测试中，mod_dav_svn 的性能比 svnserve 慢 30% 到 400%。svnserve 的性能接近于使用 svn 命令行工具对存储库进行本地直接访问。
> 
> 最显着的性能损失是在针对 mod_dav_svn 服务器的 svn log 和 svn merge 操作期间测量的 - 例如，您会立即注意到更差的 svn log 性能。使用 Eclipse Subversion 插件 Subclipse。

作者还提供了一个比较两者[的基准。](http://www.ohrner.net/download/sonstiges/krimskrams/svn_bench.csv)

我运行 snvserv，它在[Berkely DB](http://en.wikipedia.org/wiki/Berkeley_DB)后端为大约 50 个存储库提供服务，并且对性能没有任何抱怨。不过，附带说明一下，只有 10 个用户。

实际上，我发现 svnserve 非常易于安装和维护，并且不会因为缺乏未来而惩罚您。可以为 svnserve 启用 SSH，如果您是史蒂夫·罗宾斯所说的“一个存储库，多个项目”类型的人，那么基于路径的安全性也是可能的 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T09:09:47.537

从我自己的基准测试中，我发现 DAV、SVN 和 FILE 在对 500meg 左右的 repo 进行操作时几乎没有区别。DAV 模型的主要优势是您可以获得更细粒度的安全性，特别是如果您是“一个 repo，许多项目”类型的人，

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-05T15:41:09.383

您可能有兴趣知道 SVN 的 1.7 版本将采用[更快的 HTTP 协议](http://subversion.tigris.org/issues/show_bug.cgi?id=3371)。新`mod_dav_svn`模块将同时支持旧的和新的 HTTP 协议。

我会使用 HTTP 并升级到 SVN 1.7 以稍后解决性能损失。它需要做更多的工作，但它的优点是您可以使用任何 Apache 身份验证模块。这对于避免引入另一个用户密码非常有用。例如，您可以与您的 Windows 域控制器集成。

# asp.net-mvc - 使用 Stackoverflow 之类的查询字符串对 CSS 文件进行版本控制？

> ID：502600
> 
> 赞同：19
> 
> 时间：2009-02-02T08:57:05.317
> 
> 标签：asp.net-mvc, css, query-string

如果您查看 Stackoverflow.com 的源代码，您会看到对他们的 css 文件的引用是：

```
<link href="/Content/all.min.css?v=2383" rel="stylesheet" type="text/css" /> 
```

这是如何完成的，以便他们可以通过查询字符串传递版本并提供正确的 CSS 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T09:04:34.787

[这篇文章（PHP/.htaccess 示例）](http://particletree.com/notebook/automatically-version-your-css-and-javascript-files/)解释了它背后的想法。基本上，您可以将上次修改文件的时间戳附加到文件名，但仍提供原始文件。这样每次保存新版本的 CSS 文件时，文件名都会改变，这将迫使浏览器下载新版本。这适用于多种文件，包括 CSS 和 JS 文件。*（使用文件名的替代方法是使用查询字符串。）*

一个 ASP.NET 示例是这样的：

```
public static string GetBreaker(string fileName)
{
    string cacheBreaker = null;
    try
    {
        if (fileName.StartsWith("~"))
        {
            fileName = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, fileName.Remove(0));
        }
        cacheBreaker = File.GetLastWriteTime(fileName).ToFileTime().ToString();
    }
    catch { }

    return string.IsNullOrEmpty(cacheBreaker) ? string.Empty : string.Format("?cachebreaker={0}", cacheBreaker);
} 
```

您以这种方式在 MasterPage 中调用此方法：

```
<link href="<%= this.ResolveClientUrl("~/CSS/style.css") %><%=CacheBreaker.GetBreaker("~/CSS/style.css") %>"
            rel="stylesheet" type="text/css" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T09:02:23.043

这样您的浏览器就不会缓存 css 文件。并且使用版本号很方便，因为 css 文件可能在每个版本中都发生了变化。

这不是调用正确 css 文件的方法。该文件始终是相同的，但版本号使您的浏览器不以为然并再次获取它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T09:05:01.633

如果您想知道它是如何完成的，他们在之前的博客文章中简短地提到了它：它是由他们的构建过程自动完成的。[请参阅此博客文章](https://blog.stackoverflow.com/2009/01/podcast-38/)（第 3 个要点）。

不幸的是，没有详细信息，但也许您可以通过评论该博客文章或联系 stackoverflow 团队获得更多信息。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-06-09T12:32:31.017

每次更改文件时更改文件名以达到相同的效果可能会更容易。

```
file001.css
file002.css 
```

我有一种感觉，保持文件名相同并附加`?ver=1234`是为了使源代码控制更容易。

# java - java.net.MalformedURLException：URL 中有非法字符

> ID：502601
> 
> 赞同：0
> 
> 时间：2009-02-02T08:57:13.507
> 
> 标签：java, url, character, urlencode

我正在使用struts。我在一个应用程序中加密密码并通过打开的url连接将加密密码传递给另一个应用程序。有时如果我再次单击链接系统会抛出“java.net.MalformedURLException：非法字符在URL”。请帮帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T09:00:45.840

您是否对密码进行 URLEncoding？

[http://java.sun.com/javase/6/docs/api/java/net/URLEncoder.html](http://java.sun.com/javase/6/docs/api/java/net/URLEncoder.html)

# python - 在单独的线程中运行 SimpleXMLRPCServer 并关闭

> ID：502610
> 
> 赞同：6
> 
> 时间：2009-02-02T08:59:40.927
> 
> 标签：python, multithreading, simplexmlrpcserver

我有一个类，我希望通过 python 中的 SimpleXMLRPCServer 进行测试。我设置单元测试的方式是创建一个新线程，并在其中启动 SimpleXMLRPCServer。然后我运行了所有的测试，最后关机了。

这是我的服务器线程：

```
class ServerThread(Thread):
    running = True
    def run(self):
        self.server = #Creates and starts SimpleXMLRPCServer

        while (self.running):
            self.server.handle_request()

    def stop(self):
        self.running = False
        self.server.server_close() 
```

问题是，调用 ServerThread.stop()，然后调用 Thread.stop() 和 Thread.join() 不会导致线程正确停止，如果它已经在等待 handle_request 中的请求。而且由于这里似乎没有我可以使用的任何中断或超时机制，我不知道如何干净地关闭服务器线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-04-02T19:38:11.620

我遇到了同样的问题，经过数小时的研究，我通过从使用自己的**handle_request()**循环切换到**serve_forever()**来启动服务器来解决它。

**serve_forever()**像你一样开始一个内部循环。这个循环可以通过调用**shutdown()**来停止。**停止循环后，可以使用server_close()**停止服务器。

我不知道为什么这行得通，而**handle_request()**循环却不行，但确实如此；P

这是我的代码：

```
from threading import Thread
from xmlrpc.server import SimpleXMLRPCServer
from pyWebService.server.service.WebServiceRequestHandler import WebServiceRquestHandler

class WebServiceServer(Thread):
    def __init__(self, ip, port):
        super(WebServiceServer, self).__init__()
        self.running = True
        self.server = SimpleXMLRPCServer((ip, port),requestHandler=WebServiceRquestHandler)
    self.server.register_introspection_functions()

    def register_function(self, function):
        self.server.register_function(function)

    def run(self):
        self.server.serve_forever()

    def stop_server(self):
        self.server.shutdown()
        self.server.server_close()

print("starting server")
webService = WebServiceServer("localhost", 8010)
webService.start()
print("stopping server")
webService.stop_server()
webService.join()
print("server stopped") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T11:54:29.483

两个建议。

建议一是使用单独的进程而不是单独的线程。

*   创建一个独立的 XMLRPC 服务器程序。

*   开始它`subprocess.Popen()`。

*   测试完成后杀死它。在标准操作系统（不是 Windows）中，kill 效果很好。然而，在 Windows 中，没有简单的 kill 功能，但有一些方法可以做到这一点。

另一个建议是在您的 XMLRPC 服务器中设置一个导致服务器自毁的功能。您定义一个调用或引发类似异常的函数，该`sys.exit()`异常`os.abort()`将停止进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-21T06:52:12.093

这是我的方式。向自己发送 SIGTERM。（为我工作）

服务器代码

```
import os
import signal
import xmlrpc.server

server = xmlrpc.server.SimpleXMLRPCServer(("0.0.0.0", 8000))
server.register_function(lambda: os.kill(os.getpid(), signal.SIGTERM), 'quit')
server.serve_forever() 
```

客户端代码

```
import xmlrpc.client

c = xmlrpc.client.ServerProxy("http://localhost:8000")
try:
    c.quit()
except ConnectionRefusedError:
    pass 
```

# java - 类型擦除、覆盖和泛型

> ID：502614
> 
> 赞同：36
> 
> 时间：2009-02-02T09:00:20.647
> 
> 标签：java, generics, overriding, type-erasure

有人可以向我解释为什么

```
@Override
public void fooMethod(Class<?> c) 
```

不覆盖

```
public void fooMethod(Class c) 
```

并给我以下错误：

```
- 名称冲突：方法 fooMethod(Class<?>)
SubClass 类型的擦除与 fooMethod(Class) 的相同
输入 SuperClass 但不覆盖它

 - 类型的方法 fooMethod(Class<?>)
子类必须覆盖超类方法

```

?

*编辑：* “ `java -version`”表示 Java(TM) 2 运行时环境，标准版（内部版本 1.5.0_16-b06-284）。至于代码片段，它已经在上面了，差不多了；上面扩展了下面的。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-02T10:23:23.067

的签名与擦除后`fooMethod(Class<?>)`的签名相同`fooMethod(Class)`，因为 的擦除`Class<?>`很简单`Class`（[JLS 4.6](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html)）。因此，`fooMethod(Class)`是一个子签名，`fooMethod(Class<?>)`但不是相反的（[JLS 8.4.2](http://java.sun.com/docs/books/jls/third_edition/html/classes.html)）。

对于使用实例方法进行覆盖，您需要将覆盖方法作为被覆盖方法的子签名（[JLS 8.4.8.1](http://java.sun.com/docs/books/jls/third_edition/html/classes.html)）。这显然不是这里的情况。

现在我们已经确定了您的子类方法不会根据 JLS 覆盖超类方法这一事实，让我们看看发生类型擦除时的运行时影响。我们现在有两个看起来完全一样的方法（相同的名称，相同的参数类型），但不会相互覆盖。如果它们不覆盖，它们必须在子类型上都作为单独的方法可用，但它们具有相同的运行时签名：冲突。所以Java必须禁止它。

允许使用原始参数类型覆盖泛型参数类型*，*因为原始类型的存在正是出于这个原因：它们是一种方便的机制，具有特定的不健全的类型规则，以适应与遗留代码的交互。所以这里的类型系统将决定子类方法*确实*覆盖超类方法，它们在类型擦除后*是*相同的，我们永远不会发生冲突。由于这个库可以独立于现有的非泛型代码进行泛型。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-02-02T09:04:10.950

因为`Class<?>`比刚才更具体`Class`。

例如，`foo(Class<List>)`不能覆盖`foo(Class<Collection>)`. 我忘记了这个术语，但是具有泛型的类型总是与没有泛型的类型不同。

# javascript - 如何在 JavaScript 中进行修剪操作以删除文本字段中的空格字符？

> ID：502630
> 
> 赞同：-2
> 
> 时间：2009-02-02T09:07:54.763
> 
> 标签：javascript

如何在 JavaScript 中进行修剪操作以删除文本字段中的空格字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T09:09:15.167

这个问题的完全欺骗：

[在javascript中修剪（）的最佳方法是什么](https://stackoverflow.com/questions/196925/what-is-the-best-way-to-trim-in-javascript)

除非您实际上并不是要修剪，而是实际上想要替换所有空格？在这种情况下，您只需要：

```
var myString = "foo bar ddd";
myString = myString.replace(/ /g, ""); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T09:59:34.300

如果你的意思*是*修剪：

`x.replace(/^\s*|\s*$/g,'');`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T08:09:57.387

在 FF 和 Chrome 中试试这个

```
var myString = "                  some text                  ";

alert(myString.trim()); 
```

在 IE 中首先使用它并像上面的示例一样调用。

```
// Adding trim function to String object
if(typeof String.prototype.trim !== 'function') {
  String.prototype.trim = function() {
    return this.replace(/^\s+|\s+$/g, '');
  }
} 
```

从这里[http://goo.gl/L802W](http://goo.gl/L802W)

# c++ - 禁用/启用 MFC 功能包的功能区按钮

> ID：502640
> 
> 赞同：4
> 
> 时间：2009-02-02T09:13:59.633
> 
> 标签：c++, mfc, mfc-feature-pack

我正在使用 MFC 功能包，并且在功能区栏上有一些按钮，即 CMFCRibbonButton 的实例。问题是我想在某些条件下启用和禁用其中的一些，但在运行时。我怎样才能做到这一点？因为对此没有特定的方法...我听说解决方案是在运行时附加/分离事件处理程序，但我不知道如何...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-02T17:48:03.730

创建`CMFCRibbonButton`对象时，您必须指定关联的命令 ID（请参阅[此处](http://msdn.microsoft.com/en-us/library/bb982247.aspx)`CMFCRibbonButton`的构造函数文档）。然后使用 MFC 中的常用命令更新机制，使用类来启用和禁用功能区按钮。[`CCmdUI`](http://msdn.microsoft.com/en-us/library/6kc4d8fh.aspx)

例如，如果您有一个命令 ID 为的功能区按钮，`ID_MYCOMMAND`并且您想在应用程序的视图类中处理此命令，则应将这些函数添加到该类中：

```
// MyView.h
class CMyView : public CView {
    // ...
    private:
        afx_msg void OnMyCommand();
        afx_msg void OnUpdateMyCommand(CCmdUI* pCmdUI);
        DECLARE_MESSAGE_MAP()
}; 
```

并在 .cpp 文件中实现它们：

```
// MyView.cpp
void CMyView::OnMyCommand() {
    // add command handler code.
}

void CMyView::OnUpdateMyCommand(CCmdUI* pCmdUI) {
    BOOL enable = ...; // set flag to enable or disable the command.
    pCmdUI->Enable(enable);
} 
```

您还应该在类的消息映射中添加`ON_COMMAND`和`ON_UPDATE_COMMAND_UI`条目`CMyView`：

```
// MyView.cpp
BEGIN_MESSAGE_MAP(CMyView, CView)
    ON_COMMAND(ID_MYCOMMAND, &CMyView::OnMyCommand)
    ON_UPDATE_COMMAND_UI(ID_MYCOMMAND, &CMyView::OnUpdateMyCommand)
END_MESSAGE_MAP() 
```

有关 MFC 中消息映射的详细信息，请参阅[TN006：](http://msdn.microsoft.com/en-us/library/0812b0wa.aspx) MSDN 中的消息映射。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T23:00:21.683

ChrisN 给出了一个非常完美的答案。[您可以通过从此处](http://www.microsoft.com/downloads/details.aspx?FamilyId=01AE159F-08CD-495B-8BF4-A48CC395AD7B)下载 VS2008 示例包并打开 MSOffice2007Demo 解决方案来查看如何完成此操作的示例。

运行示例时，请查看功能区“视图”选项卡中的“缩略图”复选框，它已被禁用。

这是由`CMSOffice2007DemoView::OnUpdateViewThumb`which calls控制的`pCmdUI->Enable(FALSE);`。您可以将其更改为调用`TRUE`或`FALSE`在运行时分别启用/禁用按钮。

# php - 使用远程 shell 访问进行 PHP 调试

> ID：502641
> 
> 赞同：3
> 
> 时间：2009-02-02T09:14:15.827
> 
> 标签：php, debugging, methodology, remote-debugging

作为我的 PHP 学习过程的一部分，我正在使用共享托管服务使用 PHP 博客应用程序。服务提供商有一个典型的具有远程 ssh 访问的 LAMP 环境。

Vim 一直是我探索 PHP 代码的最佳朋友。但是，我发现有时在出现错误时很难跟踪代码中的内容。例如，有时我访问一个页面，我得到一个空白响应，没有任何错误消息。我应该如何调试这个？有什么有用的工具吗？

我的经验主要是在 C/C++、Perl 和一些 CGI 编程方面。所以 PHP 对我来说是一次非常令人耳目一新的体验 :-)

万一这很重要，我正在玩的应用程序是[Lyceum](http://lyceum.ibiblio.org/)，我对 LAMP 环境本身没有太多选择。

编辑：首选免费软件工具:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T09:36:46.080

我假设您的托管服务提供商配置了他们的 PHP 安装并关闭了[display_errors](http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors)，这是一件好事。这就是您看到空白页的原因。所以目前最实用的解决方案是有一个 .htaccess 文件来打开它：

```
php_flag display_errors on 
```

您还需要将[error_reporting](http://www.php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)设置为适当的值：

```
php_flag error_reporting "E_ALL | E_STRICT" 
```

无论如何，请记住在让用户访问您的网站之前将其关闭。

对于高级调试，我建议在服务器上安装[Xdebug ，并使用](http://xdebug.org/)[Eclipse PDT](http://www.eclipse.org/pdt/)或[带有 PHP 支持的 NetBeans IDE](http://www.netbeans.org/downloads/index.html)作为您的编辑器。他们都是很好的调试客户端，但我真的怀疑任何提供商都会在他们的实时服务器上安装 Xdebug。因此，如果您没有开发环境，您几乎可以使用日志记录功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T10:00:34.020

访问您自己的本地开发环境（例如，通过 XAMPP）可以让您安装 XDebug。

PhpEd 可以让您调试它，还可以调试 Eclipse 的 PDT 环境。

通过编辑 php 的 ini 配置文件进行错误跟踪和记录也是一种好方法，特别是如果您可以管理它以记录信息。此外，还可以考虑添加跟踪语句并使用 FirePHP，例如。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T09:22:15.280

就个人而言，我会推荐[jEdit](http://www.jedit.org/)而不是 vim。SFTP 插件允许您直接在服务器上编辑（加载和保存）PHP 文档，PHPParser 插件会给您一些错误识别。

此外，如果您得到一个没有错误消息的空白页面，那么这些消息很可能只是对您隐藏。确保在您的[配置](http://de.php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)或代码中启用了错误报告，如下所示：

```
// Report all PHP errors
error_reporting(E_ALL); 
```

如果启用了错误报告并且您仍然看不到任何消息，请[启用日志记录](http://de.php.net/manual/en/errorfunc.configuration.php#ini.log-errors)或启用[到浏览器的输出](http://de.php.net/manual/en/errorfunc.configuration.php#ini.display-errors)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T19:38:57.673

如果你得到一个空白页，这可能是因为一个致命错误，`display_errors`关闭。默认情况下，PHP 会将错误记录到 Apache 的错误日志中，但您也可以将其配置为将[错误记录到单独的日志](http://www.php.net/manual/en/errorfunc.configuration.php#ini.log-errors)中。

对于调试，您可能还想查看 Xdebug。这个扩展可以做很多事情，包括交互式调试。你需要一个客户端来使用调试器，但是有一个 vim 插件可以做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T09:20:42.523

尝试 NuSphere PhpED

# c# - 加入已通过下载拆分的二进制文件

> ID：502642
> 
> 赞同：1
> 
> 时间：2009-02-02T09:14:52.317
> 
> 标签：c#, asp.net, proxy

我正在尝试加入一些在下载过程中拆分的二进制文件。该要求源于项目[http://asproxy.sourceforge.net/](http://asproxy.sourceforge.net/)。在此项目中，作者允许您通过提供 url 来下载文件。

问题来自我的服务器没有足够的内存来保存大于 20 兆的文件在内存中。所以为了解决这个问题，我修改了代码以不下载大于 10 兆的文件，如果文件更大，它会然后允许用户下载前 10 兆。然后用户必须继续下载并希望获得第二个 10 兆。现在我已经完成了所有这些工作，除非用户需要加入他们下载的文件，否则我最终会得到损坏的文件，据我所知，正在通过下载添加或删除某些内容。

我目前正在通过读取所有文件然后将它们写入一个文件来将文件连接在一起。这应该可以工作，因为我正在读取和写入字节。我用来加入文件的代码在这里列出[http://www.geekpedia.com/tutorial201_Splitting-and-joining-files-using-C.html](http://www.geekpedia.com/tutorial201_Splitting-and-joining-files-using-C.html)

我的 atm 没有确切的代码，只要我回家，如果有人愿意帮忙，我会发布确切的代码。

如果我遗漏了什么或者是否有更好的方法可以做到这一点，请告诉我，即我可以用什么来替代内存流。我更改的原始项目的源代码可以在这里找到[http://asproxy.sourceforge.net/download.html](http://asproxy.sourceforge.net/download.html)，应该注意我使用的是 5.0 版。我修改的文件称为 WebDataCore.cs 并且我将第 606 行修改为仅加载了 10 兆数据以继续执行。

让我知道我是否遗漏了什么。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T09:33:19.487

您不应该出于内存原因拆分...拆分的原因通常是为了避免在失败的情况下重新下载所有内容。如果内存是一个问题，那么你做错了......例如，你不应该在内存中缓冲。

下载文件的最简单方法很简单：

```
using(WebClient client = new WebClient()) {
    client.DownloadFile(remoteUrl, localPath);
} 
```

* * *

重新您的拆分/加入代码 - 再次，问题是您正在缓冲内存中的所有内容；`File.ReadAllBytes`除非您知道自己有小文件，否则这是一件坏事。你应该拥有的是这样的：

```
byte[] buffer = new byte[8192]; // why not...
int read;
while((read = inStream.Read(buffer, 0, buffer.Length)) > 0)
{
    outStream.Write(buffer, 0, read);
} 
```

这使用适度的缓冲区在两者之间以流的形式泵送数据。效率高很多。循环说：

*   尝试读取一些数据（最多是缓冲区大小）
*   （这将读取至少 1 个字节，或者我们已经到达流的末尾）
*   如果我们读到一些东西，将这么多字节从缓冲区写入输出

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T04:47:26.870

最后，我发现通过使用 FTP 请求，我能够解决内存问题并且文件被正确保存。

感谢所有的帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T09:37:13.037

该示例将每个整个块加载到内存中，而不是您可以执行以下操作：

```
int bufSize = 1024 * 32;
byte[] buffer = new byte[bufSize];

using (FileStream outputFile = new FileStream(OutputFileName, FileMode.OpenOrCreate,
FileAccess.Write, FileShare.None, bufSize))
{
    foreach (string inputFileName in inputFiles)
    {
        using (FileStream inputFile = new FileStream(inputFileName, FileMode.Append,
            FileAccess.Write, FileShare.None, buffer.Length))
    {
    int bytesRead = 0;

    while ((bytesRead = inputFile.Read(buffer, 0, buffer.Length)) != 0)
    {
        outputFile.Write(buffer, 0, bytesRead);
    }
} 
```

# perl - 如何在 Perl 中进行单元测试？

> ID：502644
> 
> 赞同：66
> 
> 时间：2009-02-02T09:15:21.783
> 
> 标签：perl, unit-testing, testing

我一直在做一些 OO Perl 编程，我想知道：执行单元测试的最佳方法是什么？

到目前为止，我一直在使用[Test::Simple](https://metacpan.org/pod/Test::Simple)模块来执行测试，但感觉不足以满足我的需求。

你能为我指出一些不错的模块吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-02T11:49:07.823

[`Test::More`](https://metacpan.org/pod/Test::More)在继续进行 Perl 测试之前，我会投票赞成。[Perl 测试社区](http://web.archive.org/web/20180628054858/http://perl-qa.hexten.net/wiki/index.php/Main_Page)在[Test Anything Protocol](http://testanything.org/)周围非常团结，您需要[`Test::More`](https://metacpan.org/pod/Test::More)尝试了解它的工作原理以及工具如何喜欢[`prove`](http://search.cpan.org/dist/Test-Harness/bin/prove)并`Test::Harness::Archive`帮助自动化和分发测试。

如果您只想“直接进入”，我认为[`Test::Class`](https://metacpan.org/pod/Test::Class)提供带有[TAP](http://testanything.org/)后端的 xTest 设施。我根本没用过（我[`Test::More`](https://metacpan.org/pod/Test::More)自己就是一个人），但是[评价很高](http://cpanratings.perl.org/dist/Test-Class)。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-02T09:18:04.527

一旦您掌握了 Test::Simple 的窍门，Test::More 应该会为您带来更多收益。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-02T12:02:46.033

从您对 melaos 答案的评论来看，我会说[Test::Class](https://metacpan.org/pod/Test::Class)或[Test::Unit](https://metacpan.org/pod/Test::Unit)是您正在寻找的。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-02T16:59:15.313

简单的测试示例：

```
#!/usr/bin/perl -w

use strict;
use warnings 'all';
use Test::More plan => 4;  # or use Test::More 'no_plan';

use_ok('My::Module', 'Loaded My::Module');
ok( my $obj = My::Module->new(), 'Can create instance of My::Module');

ok( $obj->value('hello'), 'Set value to hello' );
is( $obj->value => 'hello', 'value is still hello'); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-03T16:07:28.490

您可以在此[示例中看到](https://stackoverflow.com/questions/499967/programmatically-determining-the-longest-similar-portion-of-several-strings/500518#500518)[Test::Class](http://search.cpan.org/perldoc?Test::Class)用法。

# ruby-on-rails - NoMethodError：在 map.root 调用中使用已定义的命名路由

> ID：502646
> 
> 赞同：0
> 
> 时间：2009-02-02T09:16:10.833
> 
> 标签：ruby-on-rails

如果我尝试使用 Rails-App 的 Root-URL，我会收到以下错误：

> NoMethodError 未定义方法 `[]' for :company_url:Symbol

```
# (part of the) content of my config/routes.rb
ActionController::Routing::Routes.draw do |map|
  map.company 'company', :controller => 'companies', :action => 'index'
  map.root :company_url
end 
```

但是 ActionController::Routing 的 API-Doc 明确表示：

> 您还可以在 map.root 调用中指定已定义的命名路由：
> 
> ```
> # In routes.rb
> map.new_session :controller => 'sessions', :action => 'new'
> map.root :new_session 
> ```

我究竟做错了什么？:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T16:30:47.537

您没有将您的命名路由（公司）映射到您的根目录，而是映射和未定义的路由（company_url）。

我*认为*您感到困惑的是自动生成的 URL，`map.resources :company`它会自动生成一组 *_url 路由。您正在使用 map.company，一个命名路线——而不是 map.resources。

# perl - 有什么好的工具可以重构 Perl Web 代码吗？

> ID：502648
> 
> 赞同：14
> 
> 时间：2009-02-02T09:17:19.817
> 
> 标签：perl, refactoring, lamp

我目前正在开发一个 perl 网络应用程序 LAMP 样式，最近偶然发现了一些以前的开发人员留下的代码死亡迷宫。他留下了这么多神奇的数字和奇怪的逻辑，以至于每次我必须通过它时都让我头疼。

我现在正在学习单元测试，所以我想找到一些有用的工具来重构代码并编写单元测试，以确保我不会意外破坏任何东西。

对 LAMP perl 的任何好的重构工具有什么建议吗？最好是免费的:)

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-02T11:29:40.860

我认为[Eclipse / EPIC](http://www.epic-ide.org/)有“一些”Perl 重构工具......但不要引用我的话 ;-)

可能也值得一试[Komodo](http://www.activestate.com/komodo/)。但是完整版不像 Eclipse / EPIC 那样免费。您可以尝试他们的开源版本[Komodo Edit](http://www.activestate.com/komodo_edit/)，但我猜它不会具备所有功能？

我没有使用上述或任何其他重构工具......我使用 vi/vim 和 TextMate 编辑器以及它们提供的内容（或者到目前为止我在每个编辑器中找到的内容！）。

进行单元测试是一个好的开始。还可以看看[perltidy / Perl::Tidy](http://search.cpan.org/dist/Perl-Tidy/)和[Perl::Critic](http://search.cpan.org/dist/Perl-Critic/)，这可能有助于通过混乱来寻找一些“代码气味”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-02T09:23:34.357

可能，[Refactor :my => 'code' 的](http://refactormycode.com/codes/recent/perl)志愿者可以帮助你。无论如何，它是免费问:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-02T14:40:42.020

Perl 的动态特性意味着很难为它创建重构工具。

但是，关于测试，您应该能够组合一些回归测试来帮助您。这通过从现在的代码开始并捕获其当前输出来工作。这可能是从命令行运行 CGI 脚本并将生成的 HTML 保存到文件中。

捕捉到这一点后，您可以更改代码，并在检查时检查 HTML 是否未更改，这意味着代码没有损坏。当确实发生更改时，您可以找到错误，或者更改测试以接受新的 HTML 为正确的。

这可能有点麻烦，但从长远来看会让你的生活更轻松。您应该尝试自动化这些测试以使其易于运行。签出 Test::WWW::Mechanize 和 Test::LongString 以及所有其他。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-02T12:32:01.827

虽然它并没有真正进行深度重构，但这个[PerlMonks 节点](http://www.perlmonks.org/?node_id=707431)描述了几个 Vim 映射，用于使用[B::Deparse](https://metacpan.org/pod/B::Deparse)对 perl 代码进行反混淆。

他们的例子：

在正常模式下，您可以`_d`在光标位于此行上时键入：

```
--$|&&s|\n|-|; 
```

...它将被替换为：

```
s/\n/-/ if --$|; 
```

而这一行：

```
$foo and $bar or $baz = 1; 
```

...将被替换为：

```
$baz = 1 unless $foo and $bar; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T02:48:04.857

带有 EPIC 插件的 Eclipse 确实有一些重构支持。不像 IntelliJ 对 Java 工具的重构那么复杂。不是 100% 确定它会帮助您解决问题。我使用它的方式是突出显示代码块并将它们移动到函数/方法中。在您的情况下，您可能会想要对那些神奇的数字进行大量搜索/替换......

我假设您将使用 Test::More 来编写单元测试。其他一些 EPIC 工具可以帮助解决这个问题（例如“todo”标签）。

您还可以使用 Test::WWW::Mechanize 和 Test::WWW::Selenium - 在您的情况下定义 selenium 测试以确保您不会破坏任何最终用户功能会很有用。虽然 EPIC 没有任何特别的帮助，但它*应该*可以在调试时使用它来逐步执行代码。

祝你好运。:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T21:42:59.157

请参阅 Devel::Refactor - 用于重构 Perl 代码的 Perl 扩展。 [https://metacpan.org/pod/Devel::重构](https://metacpan.org/pod/Devel::Refactor)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T09:51:39.543

`vim`！（或任何其他文本编辑器）

真的没有什么神奇的工具可以重构你的代码，有一些工具可以（例如）重命名变量/函数，但它无法神奇地修复可怕的代码结构或奇怪的逻辑。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-11T13:23:23.397

Padre 有一些重构工具。现在（两年左右）重命名变量的效果很好。

[http://padre.perlide.org/](http://padre.perlide.org/)

免责声明：我是 Padre 的贡献者。

# ruby - bash 中的环境路径加载不正确

> ID：502651
> 
> 赞同：0
> 
> 时间：2009-02-02T09:18:08.783
> 
> 标签：ruby, macos, bash, environment-variables

我最近安装了 Ruby19 的 Macports 端口，它改变了我的环境设置，在第一个实例中指向 opt/local，而不是我安装标准 1.8.7 的 usr/local。

我尝试通过添加通常的导出路径等作为最后一行来更新我的 ~/.profile 但无济于事。每次打开新的终端窗口/选项卡时，我都必须运行 .profile 文件，它很快就变成了皇家皮塔饼。

我对 OS X 相当陌生，所以有人能指出我正确的方向吗？

有没有办法直接编辑 environment.plist ？有一个更好的方法吗？作为一个附带主题（如果允许这样的事情），任何人都可以推荐一些好的资源来了解更多关于 OS X 的内部工作原理吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T11:10:40.647

Mac OS X 上的 bash 更喜欢 '.bash_profile' 而不是 '.profile'。试试看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T09:27:05.723

[Missing Manual](http://missingmanuals.com/)系列相当不错。我为 OS X 买了一个，当我需要做一些我知道应该很容易但不知道该怎么做的事情时，可以参考它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T09:40:31.237

这取决于您希望何时进行此设置。如果在会话开始时，放置它的位置是`~/.MacOSX/environment.plist`. 这样，无论您是否在外壳中，它都可以在任何地方使用。

编辑：添加示例

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>CVS_RSH</key>
    <string>ssh</string>
  </dict>
</plist> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T09:22:36.420

我从未拥有过 Mac，但我熟悉 Linux。由于两者都是 Unix，我想可能有相似之处。尝试将通常的“导出路径”添加到“~/.bashrc”而不是“~/.profile”。无论如何，这适用于Linux。

编辑：OS X 和 Linux 之间似乎存在一些差异。我的建议似乎无助于解决问题。无论如何，请参阅[此处](http://www.osxfaq.com/tips/unix-tricks/week105/wednesday.ws)以获取每个初始化脚本的简短描述。

# php - 计算 2xadult + 2xchild 组合的数量

> ID：502657
> 
> 赞同：0
> 
> 时间：2009-02-02T09:21:48.933
> 
> 标签：php, math

*   一个票务网站提供“家庭”票的折扣。
*   家庭票是 2 位成人，2 位儿童。
*   售票页面允许用户输入任意数量的成人票和儿童票。

**我如何确定如何申请家庭票折扣，然后按相关费用收取所有剩余票的费用（即成人票比儿童票贵）？**

这是我到目前为止所拥有的（似乎有效，但对它不是 100% 有信心（php））

```
# Work out how many pairs of people there are
$numAdultPairs = floor($oForm->adult / 2);
$numChildPairs = floor($oForm->child / 2);

# work out the number of matching pairs for child / adult
if ( $numAdultPairs > $numChildPairs ) {
    $numberOfFamilyTickets = $numAdultPairs - $numChildPairs;
} else if ( $numAdultPairs < $numChildPairs ){
    $numberOfFamilyTickets = $numChildPairs - $numAdultPairs;
} else if ( $numAdultPairs == $numChildPairs ) {
    $numberOfFamilyTickets = $numAdultPairs;
}

# work out the remaining tickets required
$remainingAdult = $oForm->adult % 2;
$remainingChild = $oForm->child % 2; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T09:27:53.913

这些方面的东西（伪代码）：

```
adultPairs = totalAdults / 2
childPairs = totalChildren / 2

familyPairs = min(adiltPairs, childPairs)
adults = totalAdults - familyPairs * 2
children = totalChildren - familyPairs * 2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T09:35:13.850

我认为您的方法实际上行不通。假设您有 6 个成人和 4 个孩子。在这种情况下，您的第一个`if`将是真实的，您最终将获得`3 - 2 = 1`家庭票。不过，正确的结果应该是两张家庭票和两张成人票。

您需要最少的对数来确定家庭票的数量。尝试这样的事情：

```
$numberOfFamilyTickets = min($numAdultPairs, $numChildPairs);
$remainingAdult = $oForm->adult - 2 * $numberOfFamilyTickets;
$remainingChild = $oForm->child - 2 * $numberOfFamilyTickets; 
```

假设您确定`$oForm->adult`并且`$oForm->child`是非负数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T09:51:37.297

大概是这样的。。

minfamilies = min(NumberOfAdults , NumberOfChildren)/2
RemaningAdults = NumberOfAdults - (minfamilies * 2)
RemainingChildren = NumberOfChildren - (minfamilies * 2)

编辑：多余的评论。上面的两条评论很有道理，我刚加入：D

# wpf - 为什么我不能将 WPFToolkit DataGrid ItemSource 绑定到 DataTable？

> ID：502667
> 
> 赞同：7
> 
> 时间：2009-02-02T09:28:42.897
> 
> 标签：wpf, data-binding, datagrid, telerik, wpftoolkit

在`Telerik`控件中，我能够将 a`DataTable`直接绑定到`ItemSource`，但是当我切换到 Codeplex 时`WPFToolkit` `Datagrid`：

```
<dg:DataGrid Name="theGrid"/>
---
theGrid.ItemsSource = dt; 
```

我收到此错误：

```
Cannot implicitly convert type 'System.Data.DataTable' to 'System.Collections.IEnumerable'. 
```

我怎样才能绑定`DataTable`到`WPFToolkit` `DataGrid`？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-03T19:04:28.163

我发现最简单的方法是：

```
myDataGrid.ItemsSource = myDataTable.DefaultView; 
```

因为 DefaultView 实现了 IEnumerable

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T10:32:27.013

我假设将来会添加对此的支持，但现在您可以使用`IListSource`on的实现`DataTable`。调用该`GetList()`方法并将其用作您的数据源。这是一个显式接口实现，因此您需要强制转换：

```
var data = (myDataTable as IListSource).GetList(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T09:45:12.490

您必须将数据表投影到实现 IEnumerable 的东西中，因为这是 DataGrid 所期望的。网格是 Telerik 版本的不同实现，因此很难期望两者具有相同的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-23T08:13:44.187

在这种情况下，我将 ItemsSource 绑定到 XAML 中的 DataContex，即

```
ItemsSource={Binding} 
```

然后在代码隐藏中我做

```
theGrid.DataContext = dt 
```

这会有所帮助。

# documentation - 技术白皮书：如何编写一份

> ID：502669
> 
> 赞同：16
> 
> 时间：2009-02-02T09:31:07.447
> 
> 标签：documentation

伙计们，

研究和展示技术白皮书的最佳方式是什么？我不是指格式、概述、部分和此类内容。

我从来没有写过 - 我想知道白皮书是否需要非常通用（概念）或具体（例如支持特定的工具/方法）

如果您的答案支持通用方法，我想知道如何进行研究。专注于较小的用例场景，从小处着手，使用特定的工具/方法，获得良好的理解，然后进行更多研究并对该主题形成广泛的看法，会更好吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T10:13:04.680

是的，尝试阅读其他技术白皮书。但不要只是阅读任何白皮书。阅读更好的。您*通常*可以通过检查论文被引用的次数来确定哪个是“更好”的（我为此访问的一个网站是[cite seer](http://citeseer.ist.psu.edu)和谷歌学者）。一些一般指导方针是：

1.  尽量直截了当，不要拐弯抹角。
2.  始终如一地使用您的首字母缩略词。
3.  借此机会陈述以前方法的弱点，因为这有点表明您已经努力审查/调查其他方法。
4.  A technical paper needs to be very specific. State exactly how your method works, state exactly how you conduct the experiments (so that others can replicate your experiments), state exactly your findings (lots of graphs would be nice), and finally, conclude it in 40-60 words or so.
5.  Emphasis on stuff that are new (Stuff that you are proposing) and less on stuff that are old (That would be your background). Make the distinction clear.
6.  Generally, you don't include your source code in your paper. If you must, published in a web page together with links to your paper.

P/S: My advice is a bit biased towards academic paper. But I think it should apply in your case.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-02T09:39:08.587

白皮书的目的通常是倡导特定观点或提出特定问题的解决方案。

但是，如果您的白皮书只是营销或推销，那么您就不会提出很好的案例。传统的建议是，您必须首先阐明您的听众的需求（商务演讲中的“痛点”），然后解决您的需求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T09:40:40.937

这听起来有点无益，但白皮书有各种形式，从非常具体到非常笼统。确定最终目标是什么。你是想卖东西，或者描述一个新的技术小部件是如何工作的，或者描述一种体验？此外，确定您的受众是商业、技术、家庭等。

看看例子——大多数大公司（IBM 等）在他们的网站上都有数百个。阅读一些内容，看看你印象中的优点和缺点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T09:34:57.847

我的 0.02：

阅读一对夫妇，并尝试制作思维导图，试图想出它们的样子。

完成此分析后，返回并选择白皮书需要的部分。特别是，使用您的文档结构构建*另一个*思维导图。

数据也是传递信息的重要方式。因此，在绘制数据图表之前，请考虑一下数据可视化技术。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T09:41:12.700

白皮书可以是一般性的，也可以是非常具体的。这完全取决于主题、受众和意图。

例如，一篇关于 R+D 主题的论文，或者在学术界发表的论文，或者旨在提供一些未来工作的概念性草图的论文，都将以更被动的语态写成，几乎是 Q+A 格式。一个讨论。您可能会提出多个想法，并且可能会支持/反对它们，而不必得出一个固定的结论。

关于特定技术的白皮书，为了客户的澄清，或说明或记录某些结果，将非常坚定、固定，并有明确的结论。数字。

您通常可以说的唯一一件事是该过程从模糊 -> 具体开始。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T10:00:42.893

[如何撰写白皮书——关于白皮书的白皮书](http://www.stelzner.com/copy-HowTo-whitepapers.php)
那篇文章的作者还写了一本书：
[撰写白皮书：如何吸引读者并保持他们的参与度](http://www.amazon.co.uk/Writing-White-Papers-Capture-Readers/dp/0977716937)

# ruby-on-rails - 如何查找上个月创建的记录？

> ID：502671
> 
> 赞同：10
> 
> 时间：2009-02-02T09:31:24.263
> 
> 标签：ruby-on-rails, ruby

我有一张表，每天都会添加新记录。我将如何查找上个月创建的记录？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-02T10:04:39.940

设置命名范围：

```
named_scope :in_last_month, :conditions => [ "records.created_at > ?", 1.month.ago ] 
```

调用它（在你的控制器中）：

```
Record.in_last_month 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-03T03:35:29.100

我认为这`named_scope`是一种相当优雅的方式，但是如果您采用这种方式，您将希望将它与一种`lambda`方法一起使用，这样时间就不会局限于最初加载应用程序的时间。

例如，这个：

```
named_scope :last_month, :conditions => 
  ['created_at > ? AND created_at < ?', 
  Date.today.last_month.beginning_of_month, Date.today.beginning_of_month] 
```

在您的应用程序启动的第一个月将正常工作，但在下个月不正常，除非应用程序重新启动。

但是这个：

```
named_scope :last_month, lambda {
  {:conditions => ['created_at > ? AND created_at < ?', 
   Date.today.last_month.beginning_of_month, Date.today.beginning_of_month]}} 
```

每次都会工作，因为 lambda 方法在每次调用时都会执行，重新评估`Date.today`s.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-27T20:05:18.950

接受的答案和 lambda 改进在 Rails 4 中不起作用。

Rails 4 更新：

```
scope :last_month, -> {
    where( 'created_at > ? AND created_at < ?', 
            Date.today.last_month.beginning_of_month, 
            Date.today.beginning_of_month )} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T10:01:05.453

假设您的记录带有时间戳，您可以执行以下操作：

```
Thing.find(:all, :conditions => ["created_at > ?", Time.now - 1.month]) 
```

如果它们没有时间戳，您应该开始存储信息，因为这是您以后要查找的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T01:39:59.067

谢谢大家，我最终选择了这个：

```
find(:all, :conditions => ['created_at > ? AND created_at < ?', Date.today.last_month.beginning_of_month, Date.today.beginning_of_month]) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-06T19:37:08.197

在我的一个项目中，我使用了这种方式：

```
Thing.where('created_at BETWEEN ? AND ? ', DateTime.now.beginning_of_month - 1.month, DateTime.now.beginning_of_month) 
```

在 Rails 3 中使用 last_month 会引发错误：`Date.today.last_month.beginning_of_month`

> NoMethodError：未定义的方法“last_month”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-12T18:50:01.073

在 Rails 4+ 上试试这个，注意这`Date.current`将使用你的应用程序的时区（在 application.rb 中指定）：

```
scope :created_last_month, lambda {
  where(created_at: Date.current.last_month.beginning_of_month..Date.current.last_month.end_of_month)
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T09:42:10.937

你的桌子上有“常用”字段吗？有关它们的列表，请参阅[RoR wiki](http://wiki.rubyonrails.org/rails/pages/MagicFieldNames)。这样，您可以表达特殊查询以找到答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T12:56:22.277

```
Thing.find(:all, :conditions => ["created_at > ?", 1.month.ago.at_beginning_of_month]) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-07T00:16:46.733

这是 SQL 的**BETWEEN**语法的一个很好的候选者

```
named_scope :last_month, :conditions => ['created_at BETWEEN ? AND ?', Date.today.last_month.beginning_of_month, Date.today.beginning_of_month]) 
```

# php - 多数据库连接类

> ID：502672
> 
> 赞同：3
> 
> 时间：2009-02-02T09:32:40.033
> 
> 标签：php, class, singleton, object

如何使用单例模式创建多个数据库连接？或者也许有更好的方法，共享同一个类但有多个连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T09:37:32.880

如何使用工厂模式为每个连接返回相同的实例，例如

```
ConnectionFactory::getInstance(ConnectionFactory::DEVELOPMENT); 
```

返回一个`Connection`连接到开发数据库的实例。

的实例化`Connection`只能由 执行`ConnectionFactory`，它可以将这些实例的引用保存在静态数组中，由连接类型键入。这避免了单例模式，但确保您只维护每个`Connection`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T09:37:19.853

连接池。

在java的情况下：

[http://java.sun.com/developer/onlineTraining/Programming/JDCBook/Code/JDCConnectionPool.java](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/Code/JDCConnectionPool.java)

这个例子只是展示了方法，你可以用更好的方式来实现它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T09:39:53.607

如果你想要的是多个，那么放弃单例模式怎么样？最近，Singleton 已成为一种反模式，因此即使您需要单个连接，您也应该放弃它。更不用说在 PHP 中扩展 Singleton 目前是相当困难的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T10:16:53.267

正如其他人所说，放弃单例，然后，我可能会做这样的事情：

```
interface Connection_Interface
{
    public function connect();
    public function disconnect();
    public function exec($sql);
    // etc...
}

class Connection implements Connection_Interface
{
    public function __construct($host, $username, $password, $database);
    public function connect();
    public function disconnect();
    public function exec($sql);
    // etc...
} 
```

然后，另一个需要多个连接的类：

```
class Connection_Multiple implements Connection_Interface
{
    protected $_connections = array();        

    public function __construct();
    public function add(Connection $connection);
    public function connect();
    public function disconnect();
    public function exec($sql)
    {
        // decide here which connection you want to use, then...
        return $connection->exec($sql);
    }
    // etc...
} 
```

由于单个连接和多个连接类都实现了相同的接口，因此您可以以完全相同的方式使用它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T12:50:17.483

我想出了这个解决方案：

```
class Database {
    private static $instances = array();

    public static function getInstance($connection='default') {
        if (!array_key_exists($connection,self::$instances)) {
            self::$instances[$connection] = new Database($connection);
        }
        return self::$instances[$connection];
    }

    private function __construct($connection) {
        $this->credentials = // getting credentials from config by $connection...
        $this->connect(); // connect using credentials
    }
}

$DB1 = Database::getInstance('development');
$DB2 = Database::getInstance('production'); 
```

似乎对我有用。这是单例模式还是混合模式？

# database - 如何测试代码生成工具？

> ID：502684
> 
> 赞同：9
> 
> 时间：2009-02-02T09:37:45.547
> 
> 标签：database, unit-testing, testing, code-generation

我目前正在开发我的一个小项目，它以动态方式生成 SQL 调用以供其他软件使用。事先不知道 SQL 调用，因此我希望能够对生成 SQL 的对象进行单元测试。

您是否知道如何做到这一点的最佳方法？请记住，不可能知道所有可能生成的 SQL 调用。

目前我唯一的想法是使用正则表达式从数据库创建接受的 SQL 的测试用例，并确保 SQL 将编译，但这并不能确保调用返回预期的结果。

编辑：添加更多信息：

我的项目是 Boo 的扩展，它允许开发人员用一组属性标记他的属性。此属性用于标识开发人员希望如何将对象存储在数据库中。例如：

```
# This attribute tells the Boo compiler extension that you want to
# store the object in a MySQL db. The boo compiler extension will make sure that you meet
# the requirements
[Storable(MySQL)] 
class MyObject():
    # Tells  the compiler that name is the PK
    [PrimaryKey(Size = 25)]
    [Property(Name)]
    private name as String

    [TableColumn(Size = 25)]
    [Property(Surname)]
    private surname as String

    [TableColumn()]
    [Property(Age)]
    private age as int 
```

好主意是生成的代码不需要使用反射，而是会在编译时添加到类中。是的，编译需要更长的时间，但根本不需要使用反射。我目前的代码正在生成在编译时返回 SQL 的所需方法，它们被添加到对象中并且可以被调用，但我需要测试生成的 SQL 是否正确：P

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T09:45:35.657

单元测试的重点是您知道与代码结果进行比较的答案。您必须找到一种事先了解 SQL 调用的方法。

老实说，正如其他回答者所建议的那样，您最好的方法是提出一些预期的结果，并在单元测试中对这些结果进行硬编码。然后您可以运行您的代码，获取结果，并与硬编码的期望值进行比较。

也许您可以记录实际生成的 SQL，而不是执行它并比较结果？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T16:34:13.473

这似乎是一个先有后继的情况。您不确定生成器会吐出什么，并且您有一个移动目标要测试（真正的数据库）。所以你需要把松散的末端系起来。

创建一个小型测试数据库（例如使用 HSQLDB 或 Derby）。此数据库应使用与真实数据库相同的功能，但不要复制！您将想了解测试数据库中的每个事物的用途以及它存在的原因，因此请花一些时间来提出一些合理的测试用例。针对这个（静态）测试数据库使用您的代码生成器，将结果保存为测试用例中的固定字符串。从单个功能开始。不要尝试构建完美的测试数据库作为第 1 步。你会到达那里。

当您更改代码生成器时，请运行测试。他们应该只在预期的地方休息。如果您发现错误，请在您的测试数据库中复制有问题的功能。创建一个新的测试，检查结果。它看起来正确吗？如果您可以看到错误，请修复测试中的预期输出。之后，修复生成器，使其产生正确的结果。关闭错误并继续前进。

这样，您可以在沼泽中建造越来越多的安全地带。做一些你知道的事情，检查它是否有效（忽略其他一切）。如果您满意，请继续。不要试图一次解决所有问题。一步一步来。测试不会忘记，因此*您*可以忘记正在测试的所有内容并专注于下一个功能。该测试将确保您的稳定基础不断增长，直到您可以在其上架起摩天大楼。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T09:45:01.647

> 正则表达式

我认为SQL的语法是非常规的，但是是上下文无关的；子表达式是实现这一点的关键。您可能想为 SQL 编写一个上下文无关的解析器来检查语法错误。

但是问问自己：你想测试*什么*？你的正确性标准是什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T10:16:29.430

如果您正在生成代码，为什么不同时生成测试呢？

除此之外，我将测试/调试生成的代码，就像在没有单元测试的情况下测试/调试任何其他代码一样（即通过阅读、运行和/或让其他人审查它）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T09:44:49.620

您不必测试所有案例。收集示例调用，确保包含函数必须处理的尽可能多的困难方面，然后查看生成的代码是否正确。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T09:44:57.933

我会有一套测试，输入已知的输入并检查生成的 SQL 是否符合预期。

您永远无法为每个场景编写测试，但如果您编写的代码足以涵盖至少最常规的模式，您可以相当确信您的生成器按预期工作。

如果您发现它在特定场景中不起作用，请为该场景编写另一个测试并修复它。

# visual-studio-2008 - Visual Studio 2008 调试器的问题

> ID：502695
> 
> 赞同：4
> 
> 时间：2009-02-02T09:43:28.123
> 
> 标签：visual-studio-2008, debugging

在我的一个项目中，我对 Visual Studio 2008 有一个奇怪的问题。当我在一行代码上设置断点时，它会正常运行，但是当我尝试“跳过”或其他任何应该越过该断点并在下一行停止的东西时，代码就会被执行并继续，好像我按 F5 一样。即使我在这一行之后有另一个断点，也会发生这种情况，奇怪的是，第二个断点被忽略（有时）。

任何人，任何想法？

**更新**

这是一个示例代码。但似乎在我有一个抛出异常的 try...catch 块的任何地方，我都有这个问题。

在以下代码示例中，“return (T)bFormatter.Deserialize(mStream)”会引发异常。

```
public static T LoadEncryptedObject<T>(string location) where T : class
{
    if( string.IsNullOrEmpty(location) || !System.IO.File.Exists(location) )
        return default(T);

    System.IO.FileStream fs = null;
    try
    {
        fs = new System.IO.FileStream(location, System.IO.FileMode.Open,
            System.IO.FileAccess.Read, System.IO.FileShare.ReadWrite);
        BinaryFormatter bFormatter = new BinaryFormatter();

        byte[] encryptedBytes = new byte[fs.Length];
        fs.Read(encryptedBytes, 0, encryptedBytes.Length);
        MemoryStream mStream = new MemoryStream(Cryptography.Decrypt(encryptedBytes));

        return (T)bFormatter.Deserialize(mStream);
    }
    catch( SerializationException sx )
    {
        System.Diagnostics.Debug.WriteLine(sx.Message);
        return default(T);
    }
    finally
    {
        if( fs != null )
            fs.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-30T00:51:24.787

VS2008 的已知问题。[此处](http://support.microsoft.com/kb/957912)提供了补丁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T09:46:53.377

通常这可能是由于未捕获的异常。尝试在 IDE 中捕获所有异常。

在菜单栏上单击**Debug->Exceptions...**并选中**Common Language Runtime Exceptions**的“Thrown”复选框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T13:55:50.253

Cryptography.Decrypt 是 COM Encryption Provider 框架的包装器吗？每当您评估在 COM 中实现的某些内容时，您都会遇到一些不寻常的线程问题，这些问题听起来与您所描述的相似。

很多时候，对我有帮助的是关闭手表、汽车和本地窗口，然后非常小心不要将鼠标悬停在任何东西上以避免触发调试器评估。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-30T00:36:23.507

我的怀疑是，当您在断点处暂停时，另一个线程上会发生异常。当您跨步时，异常优先，调试器跳转到该线程。

简单的解决方案是确保您只调试一个线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-28T18:31:42.340

我有同样的问题。这是因为我的应用程序正在使用另一个应用程序，即 Dbmonitor 来跟踪数据库事件，但在调试时我没有运行 Dbmonitor。所以检查你是否添加任何代码来使用任何第三方应用程序。这可能会帮助你:)

# asp.net - 我可以为多个 ASP.NET 应用程序使用一个 BIN 文件夹吗？

> ID：502715
> 
> 赞同：2
> 
> 时间：2009-02-02T09:56:53.887
> 
> 标签：asp.net, iis, assemblies, gac

请记住，我不想使用 GAC，因为我的程序集经常更新，并且我不希望在每次更新后注册它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T09:59:10.823

您可能可以使用 NTFS 目录连接。我没有测试，但他们应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T00:06:54.357

这引发了有关不良部署和源代码控制实践的标志。这些库是否在多个应用程序之间共享？您确定这些库都应该独立于它们各自的应用程序进行更新吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T09:58:54.397

[探索私人路径](http://msdn.microsoft.com/en-us/library/823z9h8w(VS.80).aspx)有什么帮助吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T10:19:48.567

我认为由于没有提到框架版本，因此需要进一步澄清指定公共 BIN 文件夹的目的。您是否打算拥有一个公共输出目录，或者您想从一个公共目录加载已编译的程序集？

我相信该`codebase`元素在这种情况下是合适的，因为该`probing`元素只能指定应用程序的子目录。

看看这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/4191fzwb(VS.80).aspx)

# svn - 如何对设计文档进行最佳版本化？

> ID：502716
> 
> 赞同：11
> 
> 时间：2009-02-02T09:57:15.587
> 
> 标签：svn, version-control, documentation

[之前关于如何对办公文档进行版本控制的 SO（此处](https://stackoverflow.com/questions/36820/version-control-for-word-documents "word文档的版本控制")和[此处](https://stackoverflow.com/questions/29810/is-version-control-ie-subversion-applicable-in-document-tracking "版本控制是否适用于文档跟踪")）进行了一些讨论，但是我认为我的问题仍然有些不同。

我的编程项目从一个空的项目文件夹开始，除了一个名为“Design Documents”的子文件夹，其中包含项目功能规范的草稿，然后扩展为包含 API 规范或其他任何需要的东西。

当然，我也会将这些文件签入 SVN。**我正在寻找的是良好的文件格式和策略，以便在整个版本控制、差异化和合并过程中发挥良好的作用。**例如，我认为最好将文字处理器文件存储为 XML，或者差异对于人类读者来说是丑陋的和无用的？这是我想做的：

*   区分和合并文本文档（必备的 OOo，必备的 MS Word）
*   diff（也可能是合并，尽管这在概念上可能很困难）模式图，如 UML 图。我在想这些可能是独立的 XML/SVG 文件并链接到文本文档中，但我对这些文档的工作原理知之甚少，无法判断这是否真的可行。
*   在文本文档中显示自动更新的修订号（可能使用[svn:keywords](http://svnbook.red-bean.com/en/1.0/ch07s02.html#svn-ch-7-sect-2.3.4)）

有没有人做过这种事情？可能有许多关于 OOo 文件等的文档和教程可供我查阅，但我也很欣赏这些方面的指针，但我主要是在寻找在实践中有效或无效的事情的第一手资料。

* * *

**编辑：**可以肯定的是，这里不涉及“非技术用户”。它只是程序员，这些文档仅用于编程项目。可能会有要发布的 PDF 文件，但这只是另一个构建工件，不需要进行版本控制。

不过，我们*真的*不想使用 Tex 或类似的东西。我知道这很棒，但我就是不想为一个简单的文本文档而烦恼。我们必须学习它，正确获取所有额外的包，将 Tex-to-PDF 渲染添加到我们的构建过程等。这就像一个仅针对两三个文档的小型编程项目。如果有的话，我宁愿使用 HTML，但文字处理器对我来说仍然是一个不错的选择，除了我想要好的版本控制。

还有一个想法：有没有类似 OOo 的 SVN 插件之类的东西？甚至，将 SVN 支持添加到 OOo 需要什么？就像“文件”菜单中的“同步”选项和“修订号”文本字段一样。我的意思是，这不会真正成为我们业务的一部分，但它会很酷，毕竟，我是老板。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T16:14:46.277

WYSIWYG 编辑器（Word、OpenOffice）通常看不到任何其他人应该弄乱他们的文件的原因，因此不可能找到一个非技术用户可以使用*并且*对版本控制系统友好的编辑器。例外：git 有一个[过滤器可以查看 OpenOffice 文件](http://git.or.cz/gitwiki/GitTips#head-1cdd4ab777e74f12d1ffa7f0a793e46dd06e5945)。不过，我不确定您是否可以使用关键字扩展。

我建议使用 wiki 并为您的用户进行为期一周的培训如何使用它。它解决了您的所有问题（某些 wiki 甚至可以检查到版本控制系统中）。正如我在[另](https://stackoverflow.com/questions/473169/recommendations-for-storing-project-documents-for-shared-access)一篇文章中所说，唯一的障碍是用户需要几天时间才能习惯这个想法。在那之后，他们会喜欢它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T10:10:30.940

在可能的情况下，我将所有“原始”文件保存为文本格式（即 XML/DocBook、纯文本、LaTeX），以及在版本版本控制下渲染的 PDF。另外，我尝试使用 Subversion 存储库修订号作为文档的版本号。

如果您不能使用自动修订号（即在 Word 文档中），我建议使用最后修改日期。确保使用上次编辑的日期而不是当前日期宏，因为当前日期宏将填写您打印文档时的任何日期，这可能不是您想要的。另一种方法当然是使用传统的增量版本号，但根据我的经验，人们通常很难在只看到一个数字时知道哪个版本是最新的。人们通常更了解旧日期。

将日期和/或修订号作为每个页面的页眉/页脚的一部分也是一个很大的优势，这样您就可以避免人们在办公桌上混淆不同的版本......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T08:54:26.583

正如 Aaorn Digulla 所指出的，wiki 是一个好主意。您必须意识到，真正实现您想要的唯一方法是重新考虑您的整个文档策略。

没有软件可以解决文件格式不兼容以及无法比较不同版本的问题。您现在使用的工具不适合这项工作。改变你的工具集和你的思维方式会很困难、不舒服，而且可能很昂贵，但这是能够实现你想要的东西的成本，最终会为自己付出 10 倍的代价。

回想一下您最初在使用模式文档、UML 图，甚至像规划 Word 文档这样简单的事情时遇到的困难。那些一直工作到现在，他们让你走到了这一步，但唯一真正的前进方式是继续使用为你*现在*需要的东西而设计的工具。

注意：最终的解决方案可能不是 wiki，但也绝对不是您现在使用的。您需要进行一些探索并尝试一些事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T02:12:37.460

用于 SVN 的 TortoiseSVN 客户端 (Windows) 对 Open Office 有足够的了解，当您要求它对它们进行比较时，一旦它掌握了必要的版本，它就会在打开两个文档的情况下打开 Office，显示差异。我经常使用这个。我想那里甚至还有更高级的解决方案，以及 Mac/Linux/OS/360 或其他类似的东西，但对于这个非常技术性的用户来说，因为他想要他的午餐，TortoiseSVN（[http://tortoisesvn.tigris ）经常感到非常不专业.org/](http://tortoisesvn.tigris.org/) ) 交付。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T12:01:06.920

wiki 在这里似乎是个好主意，但如果这不合适，您可能想考虑将[Sphinx](http://sphinx.pocoo.org/)（或类似的）与[ReStructured Text](http://en.wikipedia.org/wiki/ReStructuredText)一起使用。

虽然这也将是一个“小编程项目”，但它会为您提供 HTML 作为输出，同时保持差异的美观和可读性。我相信，设置它比使用 LaTeX 更容易。学习曲线会小很多；如果您将来需要 LaTeX 和 PDF，它就在那里等着您。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T08:26:36.220

我们使用 wiki 来获取我们一些项目的文档。它对每个条目都有很好的版本跟踪，但不是在文档级别，所以我们导出了文档并检查了基线。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T10:06:09.577

OOo 的问题在于文件格式实际上是一个 zip 压缩文件组（尝试将文件扩展名更改为 .zip 或 .7z）。这使得很难进行差异化。

我一直在看 LaTex 和 DocBook，但是建立一个样式模板来使用是相当困难的。这是所有教程都掩盖的难点。

所以基本上我已经放弃了从文档中获取有意义的差异。它以二进制 blob 的形式签入。

# c# - 了解是否为“所有用户”安装了应用程序

> ID：502717
> 
> 赞同：3
> 
> 时间：2009-02-02T09:58:09.250
> 
> 标签：c#, .net

如何检测我的应用是为“所有用户”安装的，还是只为一个用户安装的。

`Environment.SpecialFolder.CommonApplicationData`今天我检查安装程序或安装程序放入的文件`Environment.SpecialFolder.ApplicationData`。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T13:51:28.513

要扩展 Sachin Gaur 的答案：

S-1-5-18 ^(**(*)**)文件夹用于本地系统用户 - 在为所有用户安装时使用。当前用户的安装会将产品密钥放在以该用户的安全标识符 (S-something-else) 命名的文件夹中。

[`System.Security.Principal.WindowsIdentity.GetCurrent()`](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.getcurrent.aspx)要获取当前用户的 SID，请使用[`WindowsIdentity`](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx). 然后，使用该[`User`](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.user.aspx)属性获取[`SecurityIdentifier`](http://msdn.microsoft.com/en-us/library/system.security.principal.securityidentifier.aspx). 然后用于[`ToString()`](http://msdn.microsoft.com/en-us/library/system.security.principal.securityidentifier.tostring.aspx)获取字符串值。

有关用于访问注册表的 GetValue 方法，请参阅[MSDN 。](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry.getvalue.aspx)

^(**(*)**) `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T12:20:31.600

我希望这可能对你有用。

您可以通过读取注册表值来了解是否为所有用户安装了应用程序。为此，您必须知道应用程序的产品代码：

> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\

要在 C# 中读取注册表项，可以使用Microsoft.Win32 中**Registry**类的**GetValue()**方法。

 **# python - 在 DD/MM/YYYY 和 YYYY-MM-DD 之间转换日期？

> ID：502726
> 
> 赞同：57
> 
> 时间：2009-02-02T10:01:49.243
> 
> 标签：python, date

使用 Python 脚本，我需要读取日期格式为 DD/MM/YYYY 的 CVS 文件，并将其转换为 YYYY-MM-DD，然后再将其保存到 SQLite 数据库中。

这几乎可以工作，但因为我没有提供时间而失败：

```
from datetime import datetime

lastconnection = datetime.strptime("21/12/2008", "%Y-%m-%d")

#ValueError: time data did not match format:  data=21/12/2008  fmt=%Y-%m-%d
print lastconnection 
```

我假设 datetime 对象中有一个方法可以很容易地执行此转换，但我找不到如何执行此操作的示例。谢谢你。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-02-02T10:09:22.130

您的示例代码是错误的。这有效：

```
import datetime

datetime.datetime.strptime("21/12/2008", "%d/%m/%Y").strftime("%Y-%m-%d") 
```

对 strptime() 的调用根据第二个中指定的格式解析第一个参数，因此这两个需要匹配。然后您可以调用 strftime() 将结果格式化为所需的最终格式。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-02T10:07:57.810

您首先需要将字符串转换为日期时间元组，然后将该日期时间元组转换为字符串，如下所示：

```
lastconnection = datetime.strptime("21/12/2008", "%d/%m/%Y").strftime('%Y-%m-%d') 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-01-26T12:37:02.750

我是编程新手。我想从 to 转换为`yyyy-mm-dd`以`dd/mm/yyyy`我所在地区的人们使用和识别的格式打印出日期。

上面接受的答案让我走上了正确的轨道。

我最终对我的问题的答案是：

```
import datetime

today_date = datetime.date.today()
print(today_date)

new_today_date = today_date.strftime("%d/%m/%Y")
print (new_today_date) 
```

导入语句后的前两行以美国格式 (2017-01-26) 给出今天的日期。最后两行将其转换为英国和其他国家/地区认可的格式 (26/01/2017)。

您可以缩短此代码，但我保留它是因为它对我作为初学者很有帮助。我希望这对其他初学者程序员有所帮助！

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-02T10:53:43.927

有没有其他人认为将这些字符串转换为日期/时间对象是一种浪费，最终是一个简单的文本转换？如果您确定传入的日期是有效的，您可以使用：

```
>>> ddmmyyyy = "21/12/2008"
>>> yyyymmdd = ddmmyyyy[6:] + "-" + ddmmyyyy[3:5] + "-" + ddmmyyyy[:2]
>>> yyyymmdd
'2008-12-21' 
```

这几乎肯定会比日期转换更快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-04-05T19:10:57.550

如果您需要转换一整列（从`pandas` `DataFrame`），首先将其（`pandas` `Series`）转换为`datetime`使用格式`to_datetime`，然后使用`.dt.strftime`：

```
def conv_dates_series(df, col, old_date_format, new_date_format):

    df[col] = pd.to_datetime(df[col], format=old_date_format).dt.strftime(new_date_format)

    return df 
```

##### 示例用法：

```
import pandas as pd

test_df = pd.DataFrame({"Dates": ["1900-01-01", "1999-12-31"]})

old_date_format='%Y-%m-%d'
new_date_format='%d/%m/%Y'

conv_dates_series(test_df, "Dates", old_date_format, new_date_format)

    Dates
0   01/01/1900
1   31/12/1999 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-04-10T13:19:04.700

```
#case_date= 03/31/2020   

#Above is the value stored in case_date in format(mm/dd/yyyy )

demo=case_date.split("/")
new_case_date = demo[1]+"-"+demo[0]+"-"+demo[2]
#new format of date is (dd/mm/yyyy) test by printing it 
print(new_case_date) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-05-09T08:16:07.207

最简单的方法

在读取 csv 文件时，输入一个参数`parse_dates`

```
df = pd.read_csv("sample.csv", parse_dates=['column_name']) 
```

这会将提到的列的日期转换为 YYYY-MM-DD 格式

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-02T09:42:17.923

根据您的问题将日期格式 DD/MM/YYYY 转换为 YYYY-MM-DD，您可以使用这个：

```
from datetime import datetime
lastconnection = datetime.strptime("21/12/2008", "%d/%m/%Y").strftime("%Y-%m-%d")
print(lastconnection) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-30T08:33:27.813

*   `df`是你的数据框
*   `Dateclm`是您要更改的列

此列应为`DateTime`数据类型。

```
df['Dateclm'] = pd.to_datetime(df['Dateclm'])

df.dtypes

#Here is the solution to change the format of the column

df["Dateclm"] = pd.to_datetime(df["Dateclm"]).dt.strftime('%Y-%m-%d')

print(df) 
```

# windows - 内存释放例程是否触及被释放的块？

> ID：502727
> 
> 赞同：5
> 
> 时间：2009-02-02T10:02:13.530
> 
> 标签：windows, memory-management, free, msvcrt

Windows HeapFree、msvcrt free：它们是否会导致被释放的内存被分页？我试图估计在退出时不释放内存是否会显着加速应用程序关闭。

注意：这是一个非常具体的技术问题。这与应用程序是否应该`free`在退出时调用无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T10:34:43.513

如果您在应用程序关闭时没有干净地释放所有资源，那么几乎不可能检测到您是否有任何真正严重的问题 - 例如内存泄漏 - 这比缓慢关闭更成问题。如果 UI 很快消失，那么用户会认为它已经快速关闭，即使它还有很多工作要做。对于 UI，速度感知比实际速度更重要。当用户选择“退出应用程序”选项时，主应用程序窗口应立即消失。应用程序在此之后是否需要几秒钟才能优雅地释放所有内容并退出并不重要，用户不会注意到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-18T06:47:17.320

我对`HeapFree`. 以下程序`HeapFree`在 i = 31999 处存在访问冲突：

```
#include <windows.h>

int main() {

    HANDLE heap = GetProcessHeap();
    void * bufs[64000];

    // populate heap
    for (unsigned i = 0; i < _countof(bufs); ++i) {
        bufs[i] = HeapAlloc(heap, 0, 4000);
    }

    // protect a block in the "middle"
    DWORD dwOldProtect;
    VirtualProtect(
        bufs[_countof(bufs) / 2], 4000, PAGE_NOACCESS,
        &dwOldProtect);

    // free blocks
    for (unsigned i = 0; i < _countof(bufs); ++i) {
        HeapFree(heap, 0, bufs[i]);
    }
} 
```

堆栈是

```
ntdll.dll!_RtlpCoalesceFreeBlocks@16()  + 0x12b9 bytes  
ntdll.dll!_RtlFreeHeap@12()  + 0x91f bytes  
shutfree.exe!main()  Line 19    C++ 
```

所以看起来答案是“是”（这也适用`free`，因为它在`HeapFree`内部使用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T10:17:01.630

我几乎可以肯定速度改进问题的答案是“是”。释放一个块可能会或可能不会触及有问题的实际块，但无论如何它肯定必须更新其他簿记信息。如果您分配了无数小对象（它发生了），那么释放它们所需的努力可能会产生重大影响。

如果你可以安排它，你可以尝试设置你的应用程序，如果它知道它会退出，保存所有待处理的工作（配置、文档等）并不正常地退出。

# sql-server - 如何安装带有高级服务的 SQL Server Express 2008？

> ID：502729
> 
> 赞同：1
> 
> 时间：2009-02-02T10:03:37.960
> 
> 标签：sql-server, installation, sql-server-2008-express

有没有人成功安装了带有高级服务的 SQL Server Express 2008？

我已经尝试了几次，安装过程中途总是出现错误：

> 下载的文件似乎已损坏。

我在 MSDN 上找到[了这个线程](http://social.msdn.microsoft.com/forums/en-US/Vsexpressinstall/thread/ea446b54-f03a-4e08-a582-bebbef3ad181/)，但似乎没有人可以让它工作。他们只成功安装了“带有工具的 SQL Server 2008 Express”（默认）选项。

我需要全文搜索，所以我需要“高级服务”选项。如果有人成功安装了这个，那么他们会愿意分享使用的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T20:14:15.433

我在 XP Pro SP3 中的经验以及我是如何通过它的。我转到下载页面并单击下载链接以安装任何下载引导程序 (SQLEXP32_x86_ENU_Bootstraper.exe) 的版本，如果您选择高级服务版本，则无法加载安装文件 (SQLEXPRADV_x86_ENU.exe)。经过许多头痛，磁盘清理等。我尝试了特定高级服务版本的链接。这会下载文件 (SQLEXPRADV_x86_ENU.exe) 本身，然后可以运行该文件。我必须从命令提示符运行它，但这可能只是我的顽固系统。无论如何，虽然前面可能还有更多问题，但至少这可以让安装程序运行起来。它附带 SQL Server 安装，您必须手动逐步完成。

顺便说一句，我试图将其发布到 social.microsoft 网站，但无法登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T20:41:49.480

只是好奇您是否尝试过从 Microsoft 的服务器重新下载文件？如果我没记错的话，有一个“昙花一现”，其中一些发布到服务器的文件实际上已损坏。

我同意 Thomas 的观点，即 XP SP3 和 SQL Server 2008 安装会发生一些非常有趣的事情，尤其是在您使用非英语语言环境时。但在这种情况下，日志文件应该会产生表明 MSXML 6 问题的问题（由于 MSXML 文件受到保护），而不是损坏的下载文件。

如果您再次下载该文件并运行它，您能否发布您在 C: 驱动器上找到的最新 Summary*.txt 文件的内容？只需搜索 summary*.txt ，它应该在一个文件夹中，如...

```
%Program Files%\Microsoft SQL Server\Setup Bootstrap\Log\ 
```

...（但我忘记了 Express 把它放在哪里）。此日志文件可能会产生比 GUI 已编码处理的少数异常更好的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T09:40:35.417

访问[http://forums.extremeoverclocking.com/t303972.html](http://forums.extremeoverclocking.com/t303972.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-20T17:03:10.047

截至 2009 年 11 月，SQLEXPRADVx86ENU.exe 在下载页面上声称为 502M，但下载为 356M，并且不执行。这发生在 T1 和 DSL 连接上，所以我很确定这不是下载失败。

通过使用令人不快的 Web 平台安装程序，我能够安装“具有高级服务的运行时”。

# scrum - Scrum - 你什么时候估计产品待办事项的工作量？

> ID：502731
> 
> 赞同：32
> 
> 时间：2009-02-02T10:04:48.767
> 
> 标签：scrum

您的团队在 Scrum 流程的哪个部分对完成给定产品 backlog 项目所需的工作量进行了有根据的估计？

例如，假设您有一个产品 backlog 项目，上面写着“用户将能够提供他们的电子邮件地址并收到一封电子邮件，其中包含用于重置密码的链接”，计划用于 Sprint 1。

您是否以非常粗略的估计开始 sprint 并对其进行改进？这个“用户故事”什么时候变成程序员可以及时估计的细化行动项目？（例如：“使用一个文本框和提交按钮构建 Web 表单”= 2 小时）

在 sprint 开始之前，您是否进行了更精细、更准确的估算？在冲刺开始时？或者在设计人员/程序员最终遇到任务的冲刺期间？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-13T12:28:47.220

通常，估算应该在每个 sprint 开始时分 2 个级别进行：故事级别和任务级别。为了获得最佳结果，产品负责人和团队每次都应该一起做，尽管有时团队在没有产品负责人在场的情况下进行任务级别的估计是可以接受的。

## 项目估算/路线图构建（故事级别）

在您的第一个 sprint 中，您必须估计至少 80% 的积压项目（我假设产品负责人已经对其进行了优先排序）以构建合理的项目路线图，该路线图将包括按 sprint 分组的故事和初始估计预测的项目长度。

此时，每个故事的估计不是使用小时、天或周，而是使用相对大小的单位（同时包含努力、复杂性和风险），例如故事点。我们在这个阶段使用斐波那契尺度和[规划扑克](http://en.wikipedia.org/wiki/Planning_poker)。整个团队积极参与这个过程是很重要的。

之后，团队必须猜测他们能够在第一个 sprint 中完成多少个故事，这将是他们最初估计的速度（点/迭代）。通常，最好不要使用 1 个月的 sprint，而是使用 2 周或 1 周的 sprint 长度来提高估计的准确性。第一次计划通常需要一整天甚至 2 天，具体取决于积压工作的大小、团队规模和冲刺的长度。

在第一轮故事估算之后，产品负责人和团队可能希望重新确定积压工作的优先级以优化成本/收益比，因此在达成协议之前可能会来回一些。

你应该得到这样的结果：

```
PROJECT ACME ROADMAP

SPRINT 1 (38 points) <= estimated velocity
--------
Story 1 (21 points)
Story 2 (13 points)
Story 3 (4 points)

SPRINT 2 (40 points)
--------
Story 4 (13 points)
Story 5 (13 points)
Story 6 (8 points)
Story 7 (5 points)

SPRINT 3 (39 points)
--------
... 
```

在接下来的 sprint 中，此路线图将在每个 sprint 开始时反复修改，将速度调整为团队获得的实际速度，并根据需要重新计算项目长度。有时，随着团队的发展和需求的变化，重新评估故事也是必要的。但是，修改路线图的时间应该不超过半天。

利益相关者应该使用燃尽图可以看到此级别的进度，其中 X 轴是冲刺，Y 轴是故事点。

## Sprint 估计（任务级别）

每个 sprint 计划阶段的第二部分用于将每个故事分解为任务。在这里，任务本质上应该是高度技术性的，并且使用小时来估计。我们有一个政策，如果任务估计超过 8 小时，那么无论如何都需要将其分解为更详细的任务。结果将是 sprint backlog，任务按故事分组，以及 sprint 燃尽图，其中 X/Y 轴应该分别是 sprint 的天数和小时数。

它应该如下所示：

```
Sprint 8
--------
Story 17
  Task 1: 8 hours
  Task 2: 6 hours
  Task 3: 2 hours

Story 18
  Task 1: 8 hours
  Task 2: 6 hours

Story 19
  Task 1: 6 hours
  Task 2: 3 hours
... 
```

所以基本上，这些是你应该在每个 sprint 开始时进行的两种类型的估计，通常第一个 sprint 需要更多的努力来构建初始项目路线图。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-02T10:20:18.970

粗略估计应该在 sprint 计划之前完成，这个特定项目应该由团队挑选。通常，我们会在上下文切换或 sprint 停机期间检查产品积压，以对“故事点”中的新项目进行粗略估计，以便产品所有者可以在下一个 sprint 计划之前正确确定它们的优先级。

我们的 sprint 计划通常在新 sprint 开始时将时间限制为 2 小时。这是我们与产品负责人会面并从积压中挑选项目的时候，其中大多数是粗略估计并正确确定优先级的。缺失的估计是在现场完成的，然后我们在这个时间窗口内对故事进行“细粒度”任务（这通常是非常紧张的工作），利用公司其他人都知道这一点的事实，以及采购订单和利益相关者可以整理出下落不明的细节。

当然，有时执行任务顺序会与计划任务不同，则必须对其进行调整，并且可能需要重新调整燃尽图。

**任务**
的燃尽 我们只是使用任务的数量来衡量燃尽。通常你会做一些像实际时间或理想时间这样的事情，但这对我们来说已经足够好了，而且显然很有趣，需要一些澄清。

我们不估计这些任务的时间，重要的是故事的故事点估计（粗略估计），我们把它放在理想的人日中。

故事如何划分为任务更多的是团队分配和一般进度指标，而不是为我们做出准确的小时估算。

最后，我们处理了 x 数量的故事点，并从中获得了与冲刺团队中实际可用工时相关的重点因素。

最后，故事点的粗略估计是我们选择故事的基础（即，我们在一个 sprint 中可以做多少 sp）。我们倾向于在粗略估计上做得更好——我认为这很重要，因为产品负责人主要基于此来确定待办事项中的项目的优先级，而不是基于任务估计——因为这是团队内部的。

由于任务本身没有明确的时间估计，因此重点是故事点的粗略估计。如果这些任务一起花费的时间超过了估计的故事点 * 焦点因素，我们只是粗略估计错误，或者应该在 sprint 计划期间纠正它，而此时大多数信息应该已经可用或整理出来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T10:24:05.530

目前，我们会在 sprint 开始之前生成详细的任务分解和估算。这有两个原因：

1) 我们的业务需要估算来帮助他们确定优先级。

2) 开发团队面临着交付估计和不偏离自然烧毁的压力。

在我看来，这是错误的方法，因为它消除了敏捷的能力。我觉得流程应该是这样的……

1) 企业应使用计划会议期间产生的斐波那契数来帮助他们确定优先级。或者至少只期待开发团队的“悬而未决”的估计。

2) 燃尽图应被视为项目进展情况的指南，以表明是否需要添加更多 PBI 或删除优先级较低的 PBI，而不是作为将完成的明确“目标”。

以这种方式工作可以让我们在规划和设计上花费更少的时间。我们仍然会在 sprint 开始时产生一个高水平的估计，随着 sprint 的进行可以改进。

在与我的业务进行斗争之前，我将有兴趣获得对此的评论。

# .net - Pinvoke 调用获取 Windows 序列号？

> ID：502735
> 
> 赞同：0
> 
> 时间：2009-02-02T10:07:07.610
> 
> 标签：.net, winapi, compact-framework, wmi, pinvoke

获取 Windows 序列号的常规方法是 WMI。

```
 ManagementObjectSearcher mos = new ManagementObjectSearcher("Select * From Win32_OperatingSystem");
 // ...
 // Select number from managementobject mo["SerialNumber"] 
```

我不想使用 WMI，因为紧凑的框架不支持它。该程序集必须在桌面和紧凑框架端工作，因此我无法添加参考。

如何使用 pinvoke 调用获得相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T10:20:38.113

您需要为 WindowsCE 调用 KernelIOControl。

这是c++代码，没时间转换成c#

```
#include <WINIOCTL.H> 
extern "C" __declspec(dllimport) 
BOOL KernelIoControl( DWORD dwIoControlCode, LPVOID lpInBuf, DWORD nInBufSize, LPVOID lpOutBuf, DWORD nOutBufSize, LPDWORD lpBytesReturned ); 
#define IOCTL_HAL_GET_DEVICEID CTL_CODE(FILE_DEVICE_HAL, 21, METHOD_BUFFERED, FILE_ANY_ACCESS) 

CString GetSerialNumberFromKernelIoControl() { 
    DWORD dwOutBytes; 
    const int nBuffSize = 4096; 
    byte arrOutBuff[nBuffSize]; 
    BOOL bRes = ::KernelIoControl(IOCTL_HAL_GET_DEVICEID, 0, 0, arrOutBuff, nBuffSize, &dwOutBytes); 
    if (bRes) { CString strDeviceInfo; for (unsigned int i = 0; i<dwOutBytes; i++) { 
        CString strNextChar; strNextChar.Format(TEXT("%02X"), arrOutBuff[i]); strDeviceInfo += strNextChar; 
    } 
    CString strDeviceId = strDeviceInfo.Mid(40,2) + strDeviceInfo.Mid(45,9) + strDeviceInfo.Mid(70,6); 
    return strDeviceId; 
    } else { 
        return _T(""); 
    } 
} 
```

**编辑：（pinvoke kernelIOControl c#）**

```
[DllImport("coredll.dll")]
    public static extern bool KernelIoControl(long dwIoControlCode, IntPtr lpInBuff, long dwInBuffSize, IntPtr lpOutBuff, long dwOutBuffSize, IntPtr lpBytesReturned); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T15:21:27.567

首先，您不会在桌面和设备上进行一次通话。只是不会发生。您可以做的是通过如下调用确定运行时环境：

```
if(Environment.OSVersion.Platform == PlatformID.WinCE) { ... } 
```

这将使您分离桌面和设备。

然后你必须增加设备的复杂性，为此你需要了解你的目标硬件。对于 Windows Mobile 5.0 和更高版本，您想要调用[GetDeviceUniqueID](http://blogs.msdn.com/windowsmobile/archive/2006/01/09/510997.aspx)，因为 KernelIoControl 调用很可能会受到保护。对于 Pocket PC 2003 和更早版本，KernelIoControl P/Invoke 是合理的，尽管已知许多设备会呈现相同的结果，所以不能保证唯一。

对于通用 Windows CE 设备，它的种类要多得多。没有什么可以保证平台实现 IOCTL_HAL_GET_DEVICEID，因此您需要保护故障并找到一些其他机制（通常 OEM 实现自己的 ID API）。对于 CE 6.0，KernelIoControl 对应用程序非常有限，如果没有来自 OEM 的内核或驱动程序包装 API，您不太可能调用它。

# java - 串口双向通信java

> ID：502736
> 
> 赞同：1
> 
> 时间：2009-02-02T10:07:49.247
> 
> 标签：java, core

嗨，我是 java 初学者，在我的项目数据记录器连接到 com 端口中，我必须向端口发送 15 个整数值，然后其他设备将返回 15 作为响应，现在我正在写入输出流，但我没有得到响应。如何解决这个问题请帮助我。（我正在使用 javax.com 包）

谢谢您的回复

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T10:23:16.593

你也必须得到一个 InputStream，你不能从 OutputStream 中读取。还是我错过了什么？

另外，请记住在写入输出后执行 OutputStream.flush()，否则您的数据可能会被缓冲以便稍后发送 - 如果响应者正在等待您的数据，这很可能是出现问题的地方。

话虽如此： javax.comm 包真的很旧。上次我使用它时，它几乎似乎被 Sun 弃用了，或者至少没有以任何方式维护。您可能想查看其他解决方案（想到[SerialIO ）。](http://serialio.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T09:04:53.920

尝试以下示例代码

```
public static void init(String port) {
portList = CommPortIdentifier.getPortIdentifiers();
while (portList.hasMoreElements()) {
portId = (CommPortIdentifier) portList.nextElement();
if (portId.getPortType() == CommPortIdentifier.PORT_SERIAL){
System.out.println(portId.getName());
    if (portId.getName().equals(port)) {

try {sPort = (SerialPort) portId.open("PORT_NAME", 2000);
             reader = new sms();
             break;
            } 
        catch (Exception e) { System.out.println(e);continue;}
   }
} 
```

}

并使用 com 端口名称（如 COM15、COM11、COM12 等）**调用 init()**方法，检查它所连接的设备 com 端口。

# asp.net - 删除目录会导致应用程序重新启动

> ID：502743
> 
> 赞同：4
> 
> 时间：2009-02-02T10:11:46.227
> 
> 标签：asp.net, session, directory, delete-directory

我有一个包含 2 个目录（书籍和导出）的应用程序。
如果我们在应用程序中创建一本书或一本书的页面，则会添加一个带有页面 id 的目录（这是用于上传资源）。
如果我们删除一个页面，该页面（及其目录）将从数据库和文件系统中删除。

但是，这会导致会话丢失（甚至是应用程序重新启动）。我在 google 上查找了一些东西，并找到了以下[链接](http://web.archive.org/web/20110303233125/ttp://www.vikramlakhotia.com/Deleting_Directory_in_ASPnet_20.aspx)。
这似乎是 ASP.NET 2.0（和 3.5）中的一个问题。

我们现在正在考虑编写一个在晚上清理目录的服务。
但是必须有另一种解决方案来解决这个问题吗？
哦，将目录放在虚拟目录之外不是一种选择。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T10:29:01.653

尝试禁用文件系统的监控。这将阻止您的会话活动。 [这篇文章](http://dotnetslackers.com/Community/blogs/haissam/archive/2008/11/12/disable-session-expiration-when-using-directory-delete.aspx)可能对你有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T10:19:25.993

> 哦，将目录放在虚拟目录之外不是一种选择。

将目录放在虚拟目录之外是我找到的唯一解决方案（到目前为止）。您可以做的是在文件系统中创建一个链接（联结），以便该目录出现在虚拟目录中，例如：

*   我们的网站（虚拟目录）位于 C:\projectX\website
*   数据目录（我们创建/删除文件和文件夹的地方）位于 C:\projectX\data
*   然后我们创建一个链接，使数据文件夹可用作 C:\projectX\website\data

该链接是使用程序 Linkd.exe（可在 Windows 资源工具包中获得）使用以下命令创建的：

```
linkd c:\projectX\website\data c:\projectX\data 
```

现在 c:\projectX\website\data 是指向真实数据目录的链接/连接点。您可以像使用物理目录一样使用该链接。

例如，在您的网站中，您可以使用以下代码访问它：

```
Server.MapPath("~/data") 
```

您还可以使用 windows 文件资源管理器并浏览到 C:\projectX\website\data。它看起来就像一个真实的目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T10:18:04.467

我有同样的问题。解决方案是使用 ASP.Net State 服务将会话处理外部化。唯一的缺点是您放置在会话中的每个对象都需要可序列化，因为它被传输到状态服务并返回。

我目前无法提供更多链接，但谷歌会帮助你，因为你知道要搜索什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T10:50:26.117

似乎有一个受支持的修补程序可以实现与 Sachin 提到的文章相同的效果（关闭网站中的文件更改通知）。

查看[microsoft KB 中的这篇文章以](http://support.microsoft.com/kb/911272)获取更多信息。

但是由于您在评论中提到您无权访问服务器，我想这对您的情况也无济于事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T10:59:53.103

要存储经常更新、创建和删除的数据文件，您需要使用网站根目录中的 App_Data 文件夹。App_Data 文件夹的 MSDN 状态：

> 包含应用程序数据文件，包括 MDF 文件、XML 文件以及其他数据存储文件。ASP.NET 2.0 使用 App_Data 文件夹来存储应用程序的本地数据库，该数据库可用于维护成员资格和角色信息。

另请查看 App_Data 文件夹用法的问答部分：[App_Data 文件夹问题](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressinstall/thread/3f941c2d-d603-4998-978f-32de9a397761/)

# java - 以编程方式将视频转换为 FLV

> ID：502753
> 
> 赞同：19
> 
> 时间：2009-02-02T10:17:12.627
> 
> 标签：java, video, flv, opencms, transcode

我目前正在开发一个 Web 应用程序，该应用程序需要接受用户以任何格式（.avi、.mov 等）上传的视频，并将它们转换为 flv 以便在基于 Flash 的播放器中播放。

由于该站点是基于 OpenCms 的，最好的解决方案是 OpenCms 的现成插件，允许在后台上传和播放视频进行转码操作，但只需一组 Java 类来进行转码就可以了我可以自己制作上传表格和播放部分。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-02T10:32:32.580

有一个很棒的开源工具叫[FFmpeg](http://ffmpeg.org/)，我用它来转码我的视频。我使用 PHP 进行 shell 调用来让它变得生动起来，但我无法想象让它与 Java 一起玩会太难了。[（也许这对你来说是一个很好的起点。）](http://fmj-sf.net/ffmpeg-java/getting_started.php)

我每周为我的装置提供 30 多个演出批次，而且它总是以优质材料的形式出现。对我来说唯一棘手的部分是编译它以处理各种视频格式。从好的方面来说，这为我提供了我需要的繁重工作。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-12-11T22:39:26.080

您可以使用[Xuggler](http://www.xuggle.com/xuggler)在 Java 中编码视频，这是一个 Java API，在后台使用 FFmpeg 的 C 代码。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-25T16:55:02.633

如果您想托管、转码和流式传输 flv 文件（并且不想购买视频转码应用程序），您基本上有两个选择：您可以调用 FFMpeg/MEncoder，或者您可以使用外部 Web 服务。您还可以通过允许他们在您的网站上嵌入 YouTube 视频来完全回避这个问题。

如果您选择“本地 FFMpeg 路线”，我建议您简单地使用 ProcessBuilder 并构建一个命令行来执行 FFMpeg。这样您就可以完全控制执行的内容，避免使用 JNI，这绝对是一场噩梦，并且您可以将特定于操作系统的代码排除在应用程序之外。您可以找到适用于几乎任何平台的所有花里胡哨的 FFMPeg。它很有可能已经在您的服务器上。

'Local FFMPeg' 路线的好处是您不必为任何额外的托管付费，一切都在本地运行，尽管如果您使用大量的磁盘和 CPU，您的托管管理员可能会开始抱怨。还有一些其他 StackOverflow 问题讨论了[使用 FFMpeg](https://stackoverflow.com/questions/97781/what-is-the-best-tool-to-convert-common-video-formats-to-flv-on-a-linux-cli)创建可以在 Flash 播放器中实际播放的 flv 的一些陷阱。

Web 服务路由很好，因为涉及的设置较少。我没有使用[Hey!Watch](http://heywatch.com/page/home)，但它看起来很有希望。[PandaStream](http://pandastream.com/)易于设置且运行良好，而且您可以在 S3 上轻松获取所有视频。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T12:01:10.197

这可能有点切题，但我发现[Panda Stream](http://pandastream.com/)是解决各种视频编码问题的非常有用的解决方案。

您所要做的就是将视频文件上传到运行 Panda 的 Amazon EC2 实例，它会将视频编码为您想要的格式和质量，并在完成后向您的应用程序服务器发出回调并提供详细信息。然后，您可以使用捆绑的 Flash 视频播放器或您自己的播放器来播放您网站上的视频。

与滚动您自己的解决方案相比，它是一个非常可扩展（感谢 Amazon EC2 和 S3）、经济高效且可定制的解决方案。

强烈推荐。

**更新：**

Panda的架构如下：

[![熊猫流的架构](https://i.stack.imgur.com/DmPrH.gif "熊猫流的架构")](https://i.stack.imgur.com/DmPrH.gif "熊猫流的架构")
[（来源：[pandastream.com](http://pandastream.com/images/panda_arch.gif)）]

1.  页面在 iframe 或弹出窗口中显示 Panda 的上传表单
2.  使用 AJAX 进度条上传视频
3.  编码完成时的 API 回调
4.  视频流式传输给用户

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T11:32:06.117

MPlayer 使用了一个名为[mencoder的](http://es.wikipedia.org/wiki/MEncoder)[开源库](http://www.mplayerhq.hu/)，它支持 FLV 以及许多其他编解码器。

有一个[Java GUI](http://jmencode.sourceforge.net/faq.html)，你可以看到是如何制作的

[这也有帮助](http://lj4newbies.blogspot.com/2007/10/encoding-avi-to-mpg-with-mencoder.html)。

我似乎无法找到任何*未*从控制台调用的示例，因此它可能对您没有用处。:S

*编辑* 也看看[这个问题](https://stackoverflow.com/questions/404322/programmatically-transcode-mpeg-2-videos)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T16:27:14.443

您可以尝试使用[HeyWatch 之](http://heywatch.com/page/home)类的在线服务来转换您的视频。从未使用过，但他们声称

> “透明上传，从您的网站透明地发送视频”

不是 java 解决方案，但您不必担心您的 Web 应用程序在什么操作系统上。

如果操作系统不是问题，我同意[theBadDawg](https://stackoverflow.com/users/48832/thabaddawg)给出的答案。我不知道也没有运气找到一个纯 Java 解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T10:34:56.480

将一种格式的文件编码为另一种格式需要大量的开发时间才能正确完成，这就是为什么能够完成这些壮举的解码器/编码器如此之少的原因。众所周知和使用最多的是ffmpeg和mencoder。

您可能想要查看的是您正在运行的平台（Windows/Mac OS X/其他 unix）是否具有一组您可以使用的底层 API 调用，这些调用能够解码文件并重新编码它们. Windows 有 DirectShow，Mac OS X 有 Quicktime。不确定您是否可以使用 Java 访问这些 API。

FFMpeg 确实有一个可用的 Java 包装器：[FFMPEG Java](http://fmj-sf.net/ffmpeg-java/getting_started.php "ffmpeg-java")，还有[FOBS](http://fobs.sourceforge.net/)，它有一个 JNI 可用于围绕 ffmpeg 的 C++ 包装器。我找到的最后一个[jFFmpeg](http://jffmpeg.sourceforge.net/)，但是我在 Google 上发现了一些帖子，表明该项目可能不再存在。

您最好的选择是来自 mplayer 和或 ffmpeg 的 mencoder。Ffmpeg 可以作为单独的二进制文件安装，然后使用默认的“shell”命令从其他代码中调用。但是，如果您无法执行命令，则可能需要使用 Mark Robinson 建议的在线转换网站进行查看。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T10:58:43.093

在视频转码方面，FFMpeg 是最好的。

您可以为 ffmpeg 使用 java 包装器 - [http://fmj-sf.net/ffmpeg-java/getting_started.php](http://fmj-sf.net/ffmpeg-java/getting_started.php) [http://sourceforge.net/projects/jffmpeg/](http://sourceforge.net/projects/jffmpeg/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-04-09T04:43:23.430

如果你想用 java 来做，你可以很容易地用 Xuggle 来做。

他们有一个很棒的网站，解释如何做所有事情

文档在这里： [http ://build.xuggle.com/view/Stable/job/xuggler_jdk5_stable/javadoc/java/api/index.html](http://build.xuggle.com/view/Stable/job/xuggler_jdk5_stable/javadoc/java/api/index.html)

还有一个很好的教程告诉你如何做你想做的事：http://blog.xuggle.com/2009/06/05/introduction-to-xuggler-mediatools/

它们提供了一种简单的方法来完成第一个教程中想要的操作，即简单的代码转换。

我发现它可以正常编码为flv。它在幕后所做的是使用 ffmpeg，因此任何会绊倒 ffmpeg 的东西也会因 xuggle 而失败。

相关的示例java代码是：

```
 // create a media reader
 IMediaReader reader = ToolFactory.makeReader("videofile.flv");

 // add a viewer to the reader, to see the decoded media
 reader.addListener(ToolFactory.makeWriter("output.mov", reader));

 // read and decode packets from the source file and
 // and dispatch decoded audio and video to the writer
 while (reader.readPacket() == null)
   ; 
```

我从 http://wiki.xuggle.com/MediaTool_Introduction

如果你想要一些完整的 clojure 代码......这里是:)

```
(import '(com.xuggle.mediatool ToolFactory))
(import '(com.xuggle.mediatool IMediaDebugListener IMediaDebugListener$Event))

    (defn readerRecurse
      "calls .readPacket until there's nothing left to do2"
      [reader]
      (if (not (nil? (.readPacket reader))) ; here .readPacket actually does the processing as a side-effect.
        true                                   ; it returns null when it has MORE ro process, and signals an error when done... 
        (recur reader)))

    (defn convert
      "takes video and converts it to a new type of video"
      [videoInput videoOutput]
      (let [reader (ToolFactory/makeReader videoInput)]
        (doto reader
          (.addListener (ToolFactory/makeWriter videoOutput reader))
          (.addListener (ToolFactory/makeDebugListener (into-array [IMediaDebugListener$Event/META_DATA]))))
        (readerRecurse reader))) 
```

现在你所要做的就是：

```
(convert "/path/to/some_file.stupid_extention" "/path/to/awesome.flv") 
```

你就完成了！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-26T15:44:20.640

您可能还想知道我们现在也将 Panda 作为托管服务发布，这使得设置和扩展更容易:)

[http://pandastream.com](http://pandastream.com)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-09-16T09:25:12.877

是的，ffmpeg 是这项工作的最佳选择......我们使用 ffmpeg 转换视频很长一段时间，它适用于所有视频格式......有很多选项......

# configuration - EpiServer CMS 5 R2：自定义页面提供程序拒绝加载

> ID：502755
> 
> 赞同：1
> 
> 时间：2009-02-02T10:18:09.553
> 
> 标签：configuration, episerver

我最近开始使用 EpiServer 开展一个新项目，我对它完全陌生。我的一项任务要求我编写一个自定义页面提供程序。

我已经让示例页面提供程序工作并加载。我还确保我拥有 Enterprise Developer 许可证，因为该功能仅适用于该许可证。

所以我已经完成了我的页面提供程序的框架实现，并将信息输入到我的测试站点上的 web.config 中，就像 XmlPageProvider 示例一样：

```
 <pageProvider>
      <providers>
        <add entryPoint="26" capabilities="Create,Edit,Delete,Move,MultiLanguage" 
          name="custom" type="MyWebsite.CustomProvider,CustomPageProvider" />
  <!--  <add filePath="~/externalPages.xml" entryPoint="26" capabilities="Create,Edit"
          name="xml" type="CodeSamples.XmlPageProvider,XmlPageProvider" />-->
      </providers>
    </pageProvider> 
```

当我们在这里时，entryPoint 属性指的是什么？我在任何地方都找不到令人满意的解释。但是，当我点击页面时，我看到以下内容。

> 错误发生于 2009 年 2 月 2 日上午 10:07:26 用户 IP fe80::d0e0:16bf:c536:ad4d%10 用户代理 Mozilla/4.0（兼容；MSIE 7.0；Windows NT 6.0；SLCC1；.NET CLR 2.0.50727 ; .NET CLR 3.5.21022; .NET CLR 3.5.30729; .NET CLR 3.0.30618) 网址[http://ioc-dev-uk5:17003/cms/admin/default.aspx 引荐来源网址](http://ioc-dev-uk5:17003/cms/admin/default.aspx) （无）
> 
> 异常详细信息：TypeInitializationException：“EPiServer.DataFactory”的类型初始化程序引发异常。
> 
> 堆栈跟踪：
> 
> [TypeInitializationException：'EPiServer.DataFactory' 的类型初始化程序引发异常。] EPiServer.Web.InitializationModule.Initialize(EPiServerSection config, Settings settings, ConnectionStringSettingsCollection connectionStringSettings) 在 EPiServer.Web.InitializationModule.StaticInitialization() 在 EPiServer.Web。 InitializationModule.Application_BeginRequest(Object sender, EventArgs e) at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
> 
> [内部异常 ArgumentException：无法在 EPiServer.Core.PageProviderMap.LoadPageProviders(ProviderSettingsCollection pageProvidersCollection) 在 EPiServer.Core.PageProviderMap.AddPageProvider(ProviderSettings pageProviderSetting) 在 EPiServer.Core.PageProviderMap..ctor 创建类型 MyWebsite.CustomProvider,CustomPageProvider 的实例(ProviderSettingsCollection pageProviders) 在 EPiServer.DataFactory..cctor()

正如你所看到的，这是相当无益的。我尝试获得另一个许可证，重置 IIS，重新启动机器，尝试使用反射器查看 EpiServer DataFactory 中的代码，但均无济于事。

我知道这很简单，但是什么？！大约 2 天以来，它一直让我有点发疯。

普莱塞哈普！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T11:31:59.357

猜猜我自己在回答这个问题。

这真的很简单。

带着反光板进去，发现了这个：

```
private void AddPageProvider(ProviderSettings pageProviderSetting)
{
    if (Type.GetType(pageProviderSetting.Type) == null)
    {
        throw new ArgumentException("Cannot create an instance of type " + pageProviderSetting.Type);
    }
    PageProviderBase pageProvider = this.CreatePageProviderInstance(pageProviderSetting);
    pageProvider.Initialize(pageProviderSetting.Name, pageProviderSetting.Parameters);
    if (this._pageProviders.ContainsKey(UrlSegment.ReplaceIllegalChars(pageProvider.Name)))
    {
        throw new ArgumentException(string.Format("There is already a page provider with name {0} registered", pageProvider.Name));
    }
    this.AddPageProvider(pageProvider, false);
} 
```

类型名称需要完整的命名空间，所以我的 web.config 现在看起来像：

```
<pageProvider>
  <providers>
    <add entryPoint="26" capabilities="Create,Edit,Delete,Move,MultiLanguage" 
      name="custom" type="MyWebsite.CustomProvider,MyWebsite.CustomProvider.CustomPageProvider" />
  </providers>
</pageProvider> 
```

我们都起来工作了...

错误消息传递的另一个示例。它应该说“找不到类型”会省去很多麻烦。

# javascript - Flash Player 信任文件不适用于 Linux 上的嵌入式浏览器

> ID：502756
> 
> 赞同：0
> 
> 时间：2009-02-02T10:18:42.233
> 
> 标签：javascript, browser, flash, xulrunner

我有一个应用程序，它嵌入了一个基于`Xulrunner`它的浏览器。我有几个需要在浏览器中加载的 flash swf 文件。当我浏览 URL 中的内容时，swf 文件与 JavaScript 对话以更改页面标题并更改 URL。我需要更改 URL，因为我需要记住我在 flash 内容中的位置，以便下次打开浏览器时可以直接转到 flash 文件中的那个位置。

为了让 swf 文件执行此操作，我创建了一个 cfg 文件并将其放入 Flash Player 信任文件夹中（我尝试了本地文件夹`/home/user/.macromedia/Flash_Player/#Security/FlasPlayerTrust`和全局信任文件位置`/etc/adobe/FlashPlayerTrust`），但没有得到预期的结果。我调试了我的应用程序，发现 swf 从未重置页面的标题（这表明 JavaScript 被阻止）。它可以在 Firefox 浏览器中正常工作，但不能在我的嵌入式浏览器中工作。我的应用程序在 windows 和 Mac 上也可以正常工作。这仅在 Linux 上观察到。任何人都可以想到我还需要做什么才能让我的 javascript 嵌入到 flash 文件中工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T19:37:14.697

不要在桌面应用程序内的嵌入式浏览器中使用 Flash 应用程序依赖项。

# c# - 处理 WPF 用户控件

> ID：502761
> 
> 赞同：127
> 
> 时间：2009-02-02T10:20:20.267
> 
> 标签：c#, .net, wpf, user-controls, dispose

我创建了一个供第三方使用的自定义 WPF 用户控件。我的控件有一个一次性的私有成员，我想确保一旦包含的窗口/应用程序关闭，它的 dispose 方法将始终被调用。但是，UserControl 不是一次性的。

我尝试实现 IDisposable 接口并订阅 Unloaded 事件，但在主机应用程序关闭时都没有被调用。MSDN 说可能根本不会引发 Unloaded 事件。它也可能被触发不止一次，即当用户更改主题时。

如果可能的话，我不想依赖我控制的消费者记住调用特定的 Dispose 方法。

```
 public partial class MyWpfControl : UserControl
 {
     SomeDisposableObject x;

     // where does this code go?
     void Somewhere() 
     {
         if (x != null)
         {
             x.Dispose();
             x = null;
         }

     }
 } 
```

到目前为止，我发现的唯一解决方案是订阅 Dispatcher 的 ShutdownStarted 事件。这是一个合理的方法吗？

```
this.Dispatcher.ShutdownStarted += Dispatcher_ShutdownStarted; 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-02-02T10:24:33.610

此处有趣的博客文章：[Dispose of a WPF UserControl (ish)](https://web.archive.org/web/20091029112834/http://geekswithblogs.net/cskardon/archive/2008/06/23/dispose-of-a-wpf-usercontrol-ish.aspx)

它提到订阅[Dispatcher.ShutdownStarted](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.shutdownstarted.aspx)以处置您的资源。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-12-18T09:57:54.350

`Dispatcher.ShutdownStarted`事件仅在应用程序结束时触发。值得在控件停止使用时调用处置逻辑。特别是在应用程序运行期间多次使用控件时，它会释放资源。所以**ioWint**的解决方案更可取。这是代码：

```
public MyWpfControl()
{
     InitializeComponent();
     Loaded += (s, e) => { // only at this point the control is ready
         Window.GetWindow(this) // get the parent window
               .Closing += (s1, e1) => Somewhere(); //disposing logic here
     };
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-07-07T22:31:22.007

你必须小心使用析构函数。这将在 GC Finalizer 线程上调用。在某些情况下，您释放的资源可能不喜欢在与创建它们的线程不同的线程上释放。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-10-22T09:07:03.900

我使用以下交互行为向 WPF 用户控件提供卸载事件。您可以在 UserControls XAML 中包含该行为。因此，您无需将逻辑放置在每个 UserControl 中即可拥有该功能。

XAML 声明：

```
xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"

<i:Interaction.Behaviors>
    <behaviors:UserControlSupportsUnloadingEventBehavior UserControlClosing="UserControlClosingHandler" />
</i:Interaction.Behaviors> 
```

CodeBehind 处理程序：

```
private void UserControlClosingHandler(object sender, EventArgs e)
{
    // to unloading stuff here
} 
```

行为代码：

```
/// <summary>
/// This behavior raises an event when the containing window of a <see cref="UserControl"/> is closing.
/// </summary>
public class UserControlSupportsUnloadingEventBehavior : System.Windows.Interactivity.Behavior<UserControl>
{
    protected override void OnAttached()
    {
        AssociatedObject.Loaded += UserControlLoadedHandler;
    }

    protected override void OnDetaching()
    {
        AssociatedObject.Loaded -= UserControlLoadedHandler;
        var window = Window.GetWindow(AssociatedObject);
        if (window != null)
            window.Closing -= WindowClosingHandler;
    }

    /// <summary>
    /// Registers to the containing windows Closing event when the UserControl is loaded.
    /// </summary>
    private void UserControlLoadedHandler(object sender, RoutedEventArgs e)
    {
        var window = Window.GetWindow(AssociatedObject);
        if (window == null)
            throw new Exception(
                "The UserControl {0} is not contained within a Window. The UserControlSupportsUnloadingEventBehavior cannot be used."
                    .FormatWith(AssociatedObject.GetType().Name));

        window.Closing += WindowClosingHandler;
    }

    /// <summary>
    /// The containing window is closing, raise the UserControlClosing event.
    /// </summary>
    private void WindowClosingHandler(object sender, CancelEventArgs e)
    {
        OnUserControlClosing();
    }

    /// <summary>
    /// This event will be raised when the containing window of the associated <see cref="UserControl"/> is closing.
    /// </summary>
    public event EventHandler UserControlClosing;

    protected virtual void OnUserControlClosing()
    {
        var handler = UserControlClosing;
        if (handler != null) 
            handler(this, EventArgs.Empty);
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-08-03T20:34:33.830

我的场景略有不同，但意图是相同的 （我们正在 WPF PRISM 应用程序上实现 MVP 模式）。

我只是想在用户控件的 Loaded 事件中，我可以将 ParentWindowClosing 方法连接到 Parent windows Closing 事件。这样我的用户控件就可以知道父窗口何时关闭并采取相应的行动！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-31T20:04:02.237

我在想卸载在 4.7 中几乎不存在。但是，如果您正在使用旧版本的 .Net，请尝试在您的加载方法中执行此操作：

```
e.Handled = true; 
```

我认为在处理加载之前不会卸载旧版本。之所以发帖，是因为我看到其他人仍在问这个问题，并且还没有将其视为解决方案。我一年只接触过几次.Net，几年前就遇到过这种情况。但是，我想知道它是否像在加载完成之前不调用卸载一样简单。似乎它对我有用，但在较新的 .Net 中，即使加载未标记为已处理，它似乎总是调用 unload。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-02-02T12:58:38.543

UserControl 有一个析构函数，你为什么不使用它呢？

```
~MyWpfControl()
    {
        // Dispose of any Disposable items here
    } 
```

# java - Prefuse Toolkit：动态添加节点和边

> ID：502763
> 
> 赞同：4
> 
> 时间：2009-02-02T10:21:39.547
> 
> 标签：java, layout, graph-theory, prefuse

有没有人有使用 prefuse 图形工具包的经验？是否可以更改已显示的图形，即。添加/删除节点和/或边缘，并使显示正确适应？

例如，prefuse 带有一个可视化朋友网络的示例：

> [http://prefuse.org/doc/manual/introduction/example/Example.java](http://prefuse.org/doc/manual/introduction/example/Example.java)

我想做的事情是这样的：

```
// -- 7\. add new nodes on the fly -------------------------------------
new Timer(2000, new ActionListener() {
    private Node oldNode = graph.nodes().next(); // init with random node

    public void actionPerformed(ActionEvent e) {
        // insert new node //
        Node newNode = graph.addNode();

        // insert new edge //
        graph.addEdge(oldNode, newNode);

        // remember node for next call //
        oldNode = newNode;
    }
}).start(); 
```

但这似乎不起作用。有什么提示吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T10:25:29.910

您应该知道几个 prefuse 层：

*   数据
*   可视化
*   展示

简而言之，三层可以这样链接：

```
Graph graph = new Graph(eg. yourXML_file);
Visualization viz = new Visualization();
viz.add(GRAPH, graph);
Display disp = new Display();
disp.setVisualization(viz); 
```

显示是您像往常一样添加到面板的图形组件。

这里只修改数据层。

```
Node newNode = graph.addNode();
graph.addEdge(oldNode, newNode); 
```

您现在需要更新可视层：

```
viz.run("repaint"); 
```

必须定义*重绘*操作。

```
ActionList repaint = new ActionList();
repaint.add(new RepaintAction());
viz.putAction("repaint", repaint); 
```

我真的建议你阅读[prefuse 文档](http://prefuse.org/doc/manual/)。[你可以在官方论坛](http://sourceforge.net/forum/forum.php?forum_id=343013)上找到很多资源

至少，我可以说你 prefuse 目前对于实时图更新并不是很有效。

但这还不够，当您修改图形结构时，您必须在可视化中重新生成它（即重新计算节点位置等......）。您的示例代码中已经定义了两个操作。在您的 actionPerformed 结束时运行它们。

```
viz.run("color");
viz.run("layout"); 
```

这种方法效率不高，因为每次添加一个节点都会增加很多计算量，但目前还没有其他的prefuse。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-06T12:01:10.730

正如我在另一篇文章中所指出的，新节点和边在原始示例中不可见的原因是节点的颜色等设置不正确。解决此问题的一种方法是显式调用 vis.run("color"); 每当添加节点或边时。

或者，我们可以通过稍微不同地初始化我们添加它的 ActionList（在原始示例中称为“颜色”）来确保颜色操作始终运行：

代替

```
ActionList color = new ActionList(); 
```

我们可以写

```
ActionList color = new ActionList(Activity.INFINITY); 
```

这使动作列表无限期地运行，因此新节点/边将自动初始化以使其视觉外观。

但是，我不清楚这是否真的是首选方法 - 对于动态布局操作（例如 ForceDirectedLayout），这样的声明非常有意义，但对于颜色，在我看来，持续运行的着色操作主要是高架。

因此，也许之前发布的解决方案是在图形扩展时明确地（但只运行一次）“颜色”操作，这可能是更好的选择......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T09:31:36.817

好的，在挖掘了一些 prefuse 资源之后，我现在对引擎盖下的工作原理有了更好的了解。我发现实际上我用上面的代码创建的新节点不仅正确地添加到了图表中，可视化也注意到了它！

因此，与 Jerome 建议的不同，没有必要显式调用 vis.run("layout") 。

我认为节点未正确添加的原因是它们是在白色背景上*用白色背景、边框和文本颜色*绘制的。毫不奇怪，它们有点难以发现。

要解决这个问题，必须在插入新节点后调用颜色操作，如下所示：

```
// insert new edge //
graph.addEdge(oldNode, newNode);
vis.run("color"); // <- this is new 
```

（请注意，此操作在 //-- 4 下的 Example.jar 代码中进一步定义。）

我现在不确定的最后一件事是调用此操作是否会使 prefuse 再次遍历所有图形节点并设置它们的颜色 - 当然，对于非常大的图形，这将是不受欢迎的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T11:27:37.133

您需要告诉控制容器（'d'，在 example.java 中）确实被重绘。调用 invalidate() 应该就足够了（虽然不确定）。

[无论如何，这可能会对您有所帮助。](http://www.jguru.com/faq/view.jsp?EID=88716)

# ios - Iphone，获取 NSArray 中的国家/地区列表

> ID：502764
> 
> 赞同：43
> 
> 时间：2009-02-02T10:22:24.863
> 
> 标签：ios, objective-c, iphone, xcode, cocoa-touch

我有一个菜单让用户选择一个国家。与地址字段中的contacts.app国家菜单中的完全一样。

有谁知道获取国家列表的简单方法？我已经使用 NSLocale 生成了一系列国家/地区，但不幸的是，它只是国家/地区代码，而不是人类可读的等价物。我不想要“GB”，我想要英国。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-02-02T11:09:46.937

谢谢查克。

如果有人有兴趣或想在这里找到相同的解决方案，这里是我的国家排序数组代码。

**目标-C：**

```
NSLocale *locale = [NSLocale currentLocale];
NSArray *countryArray = [NSLocale ISOCountryCodes];

NSMutableArray *sortedCountryArray = [[NSMutableArray alloc] init];

for (NSString *countryCode in countryArray) {

    NSString *displayNameString = [locale displayNameForKey:NSLocaleCountryCode value:countryCode];
    [sortedCountryArray addObject:displayNameString];

}

[sortedCountryArray sortUsingSelector:@selector(localizedCompare:)]; 
```

**迅速：**

```
let locale = NSLocale.currentLocale()
let countryArray = NSLocale.ISOCountryCodes()
var unsortedCountryArray:[String] = []
for countryCode in countryArray {
    let displayNameString = locale.displayNameForKey(NSLocaleCountryCode, value: countryCode)
    if displayNameString != nil {
        unsortedCountryArray.append(displayNameString!)
    }
}
let sortedCountryArray = sorted(unsortedCountryArray, <) 
```

**斯威夫特 3**

```
 let locale = NSLocale.current
    let unsortedCountries = NSLocale.isoCountryCodes.map { locale.localizedString(forRegionCode: $0)! }
    let sortedCountries = unsortedCountries.sorted() 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-02T11:04:30.443

使用`[[NSLocale currentLocale] displayNameForKey:NSLocaleCountryCode value:countryCode]`（其中 countryCode 是国家代码列表中的一项）在用户当前的语言环境中获取国家名称。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-04-07T10:37:06.010

您可能想要定义语言环境......
并且自动释放的内存太多，这可能很关键，你永远不知道。所以也要在 for 循环内创建自动释放池。我有这个：

```
NSMutableArray * countriesArray = [[NSMutableArray alloc] init]; 
NSLocale *locale = [[[NSLocale alloc] initWithLocaleIdentifier: @"en_US"] autorelease];

NSArray *countryArray = [NSLocale ISOCountryCodes]; 
for (NSString *countryCode in countryArray) 
{
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    NSString *displayNameString = [locale displayNameForKey:NSLocaleCountryCode value:countryCode];
    [countriesArray addObject:displayNameString];
    [pool release];

}

[countriesArray sortUsingSelector:@selector(compare:)]; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-13T06:07:05.403

**斯威夫特 3**

```
let locale = Locale.current
let countries = Locale.isoRegionCodes.map {
    locale.localizedString(forRegionCode: $0)!
}.sorted() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-13T14:49:34.270

与上面的答案几乎相同，只是用来`flatMap`更短更快捷。

```
let locale = NSLocale.currentLocale()
var countries = NSLocale.ISOCountryCodes().flatMap { countryCode in
    return locale.displayNameForKey(NSLocaleCountryCode, value: countryCode)
}
countries.sortInPlace() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-13T07:48:35.483

让这个在操场上工作

```
let locale = NSLocale(localeIdentifier: "FI")
let unsortedCountries = NSLocale.isoCountryCodes.flatMap { locale.localizedString(forCountryCode: $0) }
let sortedCountries = unsortedCountries.sorted() 
```

# javascript - 如何在 Google Annotated Time Line 上使用 rangechange() 仅获取所选范围的数据？

> ID：502768
> 
> 赞同：0
> 
> 时间：2009-02-02T10:23:02.303
> 
> 标签：javascript, google-visualization

我有大量数据点，我想使用[Google Visualization: Annotated Time Line](http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html)来绘制图表。我想`data.setValue`在 JS 中输出 100,000 个点（[使用类似于此处描述的方法的 PHP](http://groups.google.com/group/google-visualization-api/browse_thread/thread/4dc84221fbd3ade5/d57109c9b45fd741)）来构建 DataTable 会导致性能问题。相反，我想输出一个小数字，然后根据选择的日期范围增加。

时间线包括一个在范围更改时触发的事件 - [rangechange()](http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html#Events)。

当触发 rangechange() 方法时，是否可以查询 URL 以返回该日期范围的数据，然后更新时间线以显示该数据？执行此操作的代码是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-17T13:09:02.950

是的，

您只需从服务器向服务器发出另一个请求以获取新的 DataTable（为其提供查询参数以定义您感兴趣的时间范围）。

然后将返回的数据与之前使用的数据表中的数据结合起来（使用 addRows() 方法）。

然后重新创建图表并将范围设置为创建之前的范围。

这应该会给你你正在寻找的效果。

*   鲍勃·莱特

# php - 如何有效地管理 Web 应用程序的多个安装？

> ID：502774
> 
> 赞同：17
> 
> 时间：2009-02-02T10:26:51.767
> 
> 标签：php, web-applications, module, release-management

根据我的经验，我们在 web 开发过程中遇到的一个更大的问题是在不同的服务器上保持不同的设置更新和安全。

我的公司拥有自己的 CMS，目前安装在 100 多台服务器上。目前，我们使用基于 FTP 的黑客方法，结合特定位置的升级脚本来升级我们所有的 CMS 设置。当涉及多个自定义模块时，有效管理这些设置变得越来越困难和风险。

*   保持 Web 应用程序的多个设置安全和最新的最佳方法是什么？
*   *你是怎么*做到的？
*   是否有任何关于应用程序模块化的具体技巧，以保持对我们客户的灵活性，但仍然能够有效地管理应用程序的多个“分支”？

一些上下文信息：我们主要在 LAMP 堆栈上开发。帮助我们销售 CMS 的主要因素之一是我们几乎可以插入客户想要的任何东西。这可以是 10 到 10.000 行自定义代码。

**许多定制工作由非常小的代码组成；在 Subversion 中管理所有这些小段代码对我来说似乎相当乏味和低效（因为我们每周交付大约 2 个网站，这会导致*很多*分支）。**

如果有什么我忽略了，我很想听听你的意见。

提前致谢。

* * *

**综述：**首先，感谢您的所有回答。所有这些都非常有帮助。

我很可能会使用基于 SVN 的方法，这使得[benlumley](https://stackoverflow.com/users/39161/benlumley)的解决方案最接近我将使用的解决方案。由于这个问题的答案在其他用例中可能会有所不同，因此我将在运行结束时接受得票最多的答案。

**请检查答案并投票给您认为具有最大附加值的答案。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T15:17:52.473

我认为使用版本控制系统并“分支”您必须修改的代码部分可能会成为健壮性和效率方面的最佳方法。

分布式版本系统可能最适合您的需求，因为它允许您在不同的“分支”上无缝更新您的“核心”功能，同时在需要时将一些更改保留在本地。

**编辑：**我很确定使用分布式版本系统保持所有最新状态将远没有您预期的那么乏味：您可以保留您确定永远不会在本地其他地方需要的更改，并且分布式方面意味着您部署的每个应用程序实际上都独立于其他应用程序，并且只有您要传播的修复程序才会传播。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T05:58:36.470

如果定制您的应用程序涉及更改许多小段代码，这可能表明您的应用程序设计存在缺陷。您的应用程序应该具有一组稳定的核心代码、可插入自定义库的扩展点、使用模板更改外观的能力，以及使用配置文件更改行为和安装插件的能力。这样一来，您就不需要为每个客户端创建一个单独的 SVN 分支。相反，将核心代码和扩展插件库照常保存在源代码管理中。在另一个存储库中，为每个客户端创建一个文件夹并将其所有模板和配置文件保存在那里。

目前，创建 SVN 分支可能是帮助您保持理智的唯一解决方案。在您目前的状态下，您几乎不可避免地会犯错误并弄乱客户的网站。至少对于分支，您可以保证每个客户端都有稳定的代码库。SVN 分支的唯一问题是，如果您在分支中移动或重命名文件，则无法将该更改合并回主干（您必须手动进行）。

祝你好运！

编辑：有关使用我上面概述的所有原则的精心设计的应用程序的示例，请参阅[Magento E-Commerce](http://www.magentocommerce.com/)。Magento 是迄今为止我使用过的最强大、可扩展且易于定制的 Web 应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-05T02:44:53.677

我可能错了，但在我看来，Aron 追求的*不是*版本控制。版本控制很棒，我确信他们已经在使用它，但是要管理数百个自定义安装的更新，您需要其他东西。

我在想一些类似于**专门构建的包系统**的东西。您将希望模块的每个版本都跟踪其各自的依赖关系和“保证的兼容性”，并使用此信息仅自动更新“安全”模块。

例如，假设您已经构建了“Wiki”模块的新版本 3。您希望将新版本传播到运行您的应用程序的所有服务器，但您已经对 Wiki 模块中的一个接口从版本 2 开始进行了更改。现在，对于所有默认安装，这没问题，但它会中断在旧界面之上使用自定义扩展进行安装。一个精心策划的包装系统会解决这个问题。

为了解决安全问题，您应该考虑在补丁上使用数字签名。有很多很好的库可用于基于公钥的签名，所以只要选择似乎是您选择的平台的标准的任何东西。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-07T08:50:36.073

不知道是不是有人说的，这里有很多很长的回复，我没有全部看完。

我认为更好的版本控制方法是让您的 CMS 在自己的存储库中独立运行，每个项目都在自己的存储库中。（或者，我猜所有这些都可能是一个仓库中的子文件夹）

然后，您可以在每个需要它的项目中使用它的主干（或者如果您愿意，也可以使用特定的分支/标签）作为 svn:external 。这样，您对 CMS 所做的任何更新都可以提交回其存储库，并在 svn 更新（或外部是 svn:switch 'ed）时被拉入其他项目。

作为使这更容易的一部分，您需要确保 CMS 和自定义功能位于不同的文件夹中，以便 svn externals 正常工作。

IE：

```
project
 project/cms <-- cms here, via svn external
 project/lib <-- custom bits here
 project/www <-- folder to point apache/iis at 
```

（如果需要，您可以在 www 文件夹下拥有 cms 和 lib）

这将使您可以根据需要对每个项目进行分支/标记。您还可以在每个分支/标签的基础上切换 svn:external 位置。

在实时更改方面，我建议您立即摆脱 ftp 并使用 rsync 或 svn checkout/exports。两者都很好，选择取决于您。

我对 rsync 路由最有经验，将 svn 导出同步到服务器。如果你走这条路，写一些 shell 脚本，你可以创建一个测试 shell 脚本来向你展示它将上传的文件，而不用上传它们，使用 -n 标志。我通常为每个环境使用一对脚本——一个用于测试，一个用于实际执行。

共享密钥身份验证，因此您不需要密码来发送上传也可能很有用，具体取决于授予访问权限的服务器的安全程度。

您还可以维护另一个用于批量升级的 shell 脚本，它只需为要升级的每个项目调用相关的 shell 脚本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T12:34:49.683

你看过 Drupal 吗？不，不是为了部署和替换你所拥有的，而是为了看看他们如何处理定制和特定于站点的模块？

基本上，有一个“站点”文件夹，其中包含您托管的每个站点的目录。每个文件夹中都有一个单独的 settings.php，它允许您指定不同的数据库。最后，您可以（可选）在站点中拥有“主题”和“模块”文件夹。

这允许您对特定模块进行特定于站点的自定义，并将某些模块限制在这些站点中。结果，您最终会得到一个网站，其中绝大多数内容都完全相同，只有不同之处被重复。结合它处理升级和更新的方式，你可能会有一个可行的模型。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-09T09:50:46.270

**在代码中构建一个自我更新的过程。
它将检查更新并在您为客户端配置它的时间/地点/方式运行它们。**

您将必须创建某种模块列表（自定义或非自定义），这些模块需要在推出之前使用新版本进行测试。部署更新时，您必须确保正确测试和集成这些更新。希望您的设计可以处理这个问题。

理想情况下，更新是几个关键步骤。

1.  a)**备份，以便您可以退出。**您应该能够随时退出整个更新。因此，这意味着首先创建应用程序和数据库的本地存档。

    b)**更新监控过程**- 让 CMS 系统打电话回家寻找新版本。

    c)**根据可用性安排更新**- 您可能不希望更新在可用的第二个运行。这意味着您必须创建某种类型的 cron/agent 才能在半夜自动进行系统更新。您还可以考虑客户要求在周末或特定日期更新。您还可以错开推出更新，这样您就不会在 1 天内更新 1000 个客户端并获得技术支持。某种形式的交错推出可能对您有益。

    d)**添加维护模式以更新站点**——将站点踢入维护模式。

    e) **SVN checkout 或可下载的软件包**——理想情况下，您可以通过 svn checkout 进行部署，如果没有，请设置您的服务器以将 svn 生成的软件包交付到可以部署在客户端站点上的存档中。

    f)**部署数据库脚本**- 备份数据库、更新它们、填充它们

    g)**更新站点代码**- 所有这些工作一步。

    h)**对其进行一些测试。** 如果您的代码内置了自测试，那将是理想的选择。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-09T10:15:07.520

这就是我要做的...

## 特定于客户端的包含路径

*   共享，通用代码在**shared/current_version/lib/**
*   特定于站点的代码位于**clients/foo.com/lib**
*   包含路径设置为包含从**clients/foo.com/lib**，然后**share/lib**
*   整个事情都在一个版本控制系统中

这可以确保代码尽可能使用共享文件，但是如果我出于某种原因需要覆盖特定的类或文件，我可以在他们的文件夹中编写客户端特定的版本。

## 别名公用文件

我的虚拟主机配置将包含一行

```
Alias /common <path>/shared/current_version/public_html/common 
```

允许跨项目共享通用 UI 元素、图标等

## 使用每个站点版本标记公共代码

在每个站点发布后，我通过创建一个分支来标记公共代码以有效地冻结该时间点。这允许我将 /shared/version_xyz/ 部署到实时服务器。然后我可以让虚拟主机使用特定版本的公共文件，或者如果我希望它获取最新更新，则让它指向 current_version。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T10:35:53.137

您是否查看过诸如[Puppet](http://reductivelabs.com/trac/puppet)（用于系统管理，包括应用程序部署）或[Capistrano](http://www.capify.org/)（在 RubyOnRails 中部署应用程序但不限于这些）之类的工具？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-02T10:36:41.200

一种选择是设置只读版本控制系统（Subversion）。您可以将对存储库的访问集成到您的 CMS 中并通过菜单调用更新，或者如果您不希望用户选择更新（可能很关键），则可以自动调用更新。使用版本控制系统还可以让您轻松地保留不同的分支

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-05T02:27:14.353

正如人们已经提到的那样，使用版本控制（由于功能我更喜欢 Subversion）和分支将是最好的选择。sourceforge 上的另一个开源软件叫做 Cruisecontrol。令人惊奇的是，您使用 subversion 配置 Cruisecontrol，这样任何代码修改或在服务器中添加的新代码，Cruise Control 都会自动知道并为您构建。它会节省你的时间。

我在公司也做过同样的事情。我们有四个项目，必须在不同的服务器上部署该项目。我已经设置了 Cruiseconrol，使得代码库中的任何修改都会触发自动构建。另一个脚本将在服务器上部署该构建。你很高兴。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-05T03:37:16.957

如果您使用 LAMP 堆栈，我肯定会将解决方案文件转换为您的分发包，并将其用于传播更改。我推荐 Redhat/Fedora 因为 RPM 并且这是我的经验。无论如何，您也可以使用任何基于 Debian 的发行版。

前段时间，我制作了一个 LAMP 解决方案来管理 ISP 托管服务器。他们有多个服务器来处理网络托管，我需要一种方法来部署我的经理的更改，因为每台机器都是独立的并且有一个在线经理。我制作了一个 RPM 包，其中包含解决方案文件（主要是 php）和一些使用 RPM 运行的部署脚本。

对于自动更新，我们在 yum.conf 中的每台服务器上都设置了自己的 RPM 存储库。我设置了一个 crontab 作业，每天使用来自该受信任存储库的最新 RPM 更新服务器。

也可以实现信任，因为您可以在 RPM 包中使用信任设置，例如使用您的公钥文件对其进行签名并仅接受签名包。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-07T08:58:05.123

嗯，添加配置文件是个好主意吗？你写了很多小脚本都在做某事。现在，如果您将它们构建到源代码中并使用配置文件引导它们，那不应该“轻松”吗？

另一方面，为每个客户开设分支机构对我来说似乎是指数级增长。你如何“知道”你在哪些领域做了一些事情，并且不要忘记在所有其他分支中也“做出”改变。这对我来说看起来很丑陋。

似乎修订控制、配置选项和/或部署收据的组合似乎是一个“好”的主意.....

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-09T06:39:54.247

由于您的核心软件有如此多的变化，我认为您确实需要一个版本控制系统来随时将更新从主干推送到各个客户端站点。

因此，如果您认为 Subversion 会很乏味，那么您对痛点会有一个很好的了解……就个人而言，我不会为此推荐 Subversion，因为它在管理和跟踪分支方面并不是那么好。尽管 benlumley 建议为您的核心软件使用外部代码是一个很好的建议，但如果您需要为您的客户站点调整核心代码，这将失效。

查看 Git 的版本控制，它是为分支而构建的，而且速度很快。

查看 Capistrano 以管理您的部署。这是一个 ruby​​ 脚本，经常与 Rails 一起使用，但它可以用于远程服务器上的各种文件管理，甚至是非 ruby​​ 站点。它可以通过包括 ftp、scp、rsync 在内的各种策略将内容发送到远程端，并自动从您的存储库中检出最新版本。它提供的不错的功能包括部署过程的每个步骤的回调挂钩（例如，您可以复制可能不在版本控制中的特定于站点的配置文件），以及一个发布日志系统——通过符号链接完成——所以你如果出现问题，可以快速回滚到以前的版本。

我建议使用包含分支列表及其托管位置的配置文件，然后使用脚本依次检查每个分支并上传最新更改。这可能是 cron'd 自动进行夜间更新。

# java - 在 Hudson 或其他 CI 工具中使用 Ant 自动签出和编译 Eclipse 项目的最佳方法？

> ID：502776
> 
> 赞同：9
> 
> 时间：2009-02-02T10:28:30.483
> 
> 标签：java, eclipse, continuous-integration, hudson, cvs

我们有几个产品有很多共享代码并且必须维护几个版本。

为了解决这个问题，我们使用了很多 Eclipse 项目，有些包含库 jar，有些包含共享源代码（在几个项目中，以避免获得具有大量依赖项的巨大堆，同时能够从头开始编译所有内容以确保源代码和二进制文件是持续的）。我们使用 projectSet.psf 管理这些项目，因为它们可以直接从 CVS 中拉出所有项目并留下一个准备充分的工作区。我们不直接进行 ant 构建或使用 maven。

我们现在希望能够将所有这些项目及其各种版本放入一个持续集成工具中——我喜欢 Hudson，但这只是个人喜好问题——这本质上意味着我们需要一种自动的方式来检查项目以一个新的工作区，并按照每个项目的项目文件中的描述编译源文件夹。Hudson 没有提供这样的方法来构建项目，所以我一直在考虑最好的方法是什么。

想法已经

*   查找或编写一个能理解 projectSet.psf 并映射到 cvs-checkout 和编译标签的 ant 插件/转换器。
*   从 Eclipse 中创建 build.xml 文件并使用它们。我试过这个，发现结果很冗长，而且绝对位置不适合自动工具将文件放在他们想要的位置。
*   编写一个理解 projectSet.psf 的 Hudson 插件以派生配置并构建它。
*   只要硬着头皮手动创建和更新 CI 配置就可以了——我不喜欢这样 :)

我真的很想听听其他人的经历，所以我可以决定如何处理这个问题。

* * *

编辑：另一种选择可能是使用更了解 Eclipse 项目和/或项目集的 CI。我们不信教——这只是让东西运行起来而不必自己做所有事情的问题。巡航控制可能是一个更好的选择吗？其他的？

* * *

编辑：发现 ant4eclipse 有一个“团队项目集”设施。 [http://ant4eclipse.sourceforge.net/](http://ant4eclipse.sourceforge.net/)

* * *

编辑：使用 ant4eclipse 和 ant-contrib ant 扩展来构建一个完整的工作区作为 sjgned 可运行 jar 文件，类似于 Eclipse 3.5M6 中的可运行 Jar 工具。我仍然依赖 Eclipse 来创建初始的空工作区，并提取 ProjectSet，所以这是下一个障碍。

* * *

编辑：以双重配置结束，即 Hudson 从 CVS 中提取与 ProjectSet.pdf 文件中列出的相同的模块集（需要具有相同的标签），从而使它们彼此相邻。然后 ant4eclipse 可以很好地与嵌入在主模块中的 projectSet.psf 文件配合使用。警告：必须手动更新 Hudson 中的模块列表，并且之后似乎需要手动清理工作空间，以便让 Hudson “发现”现在比以前有更多的项目。几个月来，这对我们来说效果很好，但是让所有的东西都在 ant 文件中工作是相当乏味的。

* * *

编辑：在哈德逊的 CVS 项目中，使用 ant4eclipse 和 Ctrl-A、Ctrl-C 在项目面板中使用 Ctrl-V 的“使用团队项目”已经证明工作得很好，我们可以忍受（对于成熟的项目，这个很少改变）。我正在等待 ant4eclipse 1.0 的发布——http://www.ant4eclipse.org/ [，](http://www.ant4eclipse.org/)目前处于里程碑 2——看看有多少本土功能可以被 ant4eclipse 东西取代。

编辑：ant4eclipse 在 M4 中是截至 20100609 的，所以[http://www.ant4eclipse.org/node?page=1](http://www.ant4eclipse.org/node?page=1)上的时间表有所下滑。

* * *

编辑：在长时间使用我们的 ant4eclipse 方法后，我的结论是构建脚本变得非常粗糙并且难以维护。Team ProjectSet 工具（ant4eclipse 用来定位项目）也适用于基于 CVS 的存储库，但在我们迁移到 git 之后就不行了（这本身就是一件大事）。新项目很可能基于 maven，因为这在 Jenkins 中得到了很好的支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T16:31:00.017

我不完全确定我理解这个问题，但听起来根本问题是你有很多项目，其中一些依赖于其他项目。一些更接近依赖树“叶子”的项目需要能够使用更多“核心”项目的“稳定”（或先前“发布”）版本。

[我使用Hudson](http://hudson-ci.org/)、[ant](http://ant.apache.org/)和[ivy](http://ant.apache.org/ivy)解决了这个问题。我遵循 Clark 在[Pragmatic Project Automation](https://rads.stackoverflow.com/amzn/click/com/0974514039)中演示的模式（他没有演示依赖问题和解决方案，他使用 CruiseControl 而不是 hudson。）

我有一个手写的 ant 构建文件（我们称之为“cc-build.xml”，因为我们的 CruiseControl 根。）该文件负责从 CM 存储库中刷新项目的工作空间并标记内容以供将来使用参考。然后它将控制权交给每个项目的开发人员提供的另一个手写的 ant 构建文件 (build.xml)。该项目负责传统的构建步骤（编译、打包等）。它需要将可安装的工件、单元测试报告等吐出到 Hudson 工件目录。根据我的经验，自动生成的构建文件（通过 Eclipse 或其他类似的 IDE）永远不会接近获得足够健壮以在 CI 场景中使用的能力。

此外，它使用 ivy 来解决它自己的依赖关系。Ivy 支持精确指定的依赖版本（例如“使用 1.1 版”），它支持“模糊版本”（例如“使用 1.1+ 版”或“在集成状态下使用最新版本”）。我们的项目通常开始指定一个非常正在进行开发的内部项目的“模糊”版本，当它们接近发布点时，它们“冻结”依赖版本，以便东西停止在它们下面移动。

非叶子项目（依赖于其他项目的项目）也使用 ivy 将其工件发布到我们内部的 ivy 存储库。该存储库保留依赖项的所有过去构建，因此任何项目都可以始终依赖任何其他先前版本。

最后，Hudson 中的每个项目都配置有一个构建触发器，当其任何依赖项目成功构建时，该触发器会导致重新构建。这导致它们使用（可能）新的 ivy 依赖版本再次构建。

值得注意的是，一旦你启动并运行它，自动构建输入的一致自动“标签”或“标记”对你来说将是至关重要的 - 否则对构建后问题进行故障排除将导致不得不解开一个寻找马蜂窝的原始来源。

为我们的环境完成所有这些设置需要付出相当多的努力（主要是设置 ivy 存储库和 ant 构建文件），但它已经为自己付出了很多倍的代价，因为它节省了手动管理依赖项和减少故障排除工作的麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T17:59:10.667

> 编写一个理解 projectSet.psf 的 Hudson 插件以派生配置并构建它。

这对我来说似乎是成功的答案。

我使用 CruiseControl 而不是 Hudson，但根据我的经验，如果您可以创建一个插件来解决您的问题，它将很快得到回报。编写一个适合您的解决方案的插件通常很容易，而不是一个需要在类似情况下为每个人工作的插件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T08:44:37.417

我已经为我们的 CI 解决方案尝试了 Cruise Control (CC) 和 Hudson。我们（作为一家公司）决定选择 Hudson。但是对于您的问题“CC 是否支持 Eclipse 项目构建”，据我所知，答案是否定的。CC 支持更多不同的构建工具和源代码控制系统，但配置和使用有点困难。至于Hudson，配置和使用起来更简单。我们为 CC 和 Hudson 开发了我们的定制插件，用于我们构建周期中它们未按原样提供的部分。至于插件开发，如果你知道/使用 Maven，Hudson 也更简单。但是如果你对 Maven 不熟悉，首先你需要学习 maven 的基本用法，才能成功开发一个 Hudson 插件。但是一旦你了解了 maven 的基本用法，在 Hudson 中插件开发、测试甚至调试都会变得更简单。

对于您的具体问题，我可以考虑使用 Eclipse 插件的解决方案。您可以开发自己的 Eclipse 插件，例如从（可配置的）文件夹中获取 psf 文件，并使用 Eclipse 内部来处理这些 psf。我的意思是您可以使用现有的带有 psf 文件的 Eclipse 源代码，检查它的项目定义并编译这些项目。您的这个 Eclipse 插件可能有一个首选项页面（您可以通过 Eclipse -> Window -> Preferences 访问该页面）并配置它将使用哪个文件夹来查找 psf 文件。您的 Eclipse 插件还应该有一种无需用户交互即可启动 psf 处理的方法。为此，您可以使用 ipc 来触发您的进程。我的意思是你的 Eclipse 插件可以监听一个端口，您可以编写另一个 java 应用程序，该应用程序将通过此端口连接到您的插件并触发其进程。至于 CI 部分，您可以使用 CC 或 Hudson 并使用它们的外部流程执行支持。如果您使用的是 Windows，您可以编写一个 bat 文件（用于 Linux sh 文件），该文件首先启动安装了您的插件的 Eclipse。然后它会启动您的 java 应用程序，该应用程序将与您的 Eclipse 插件通信以触发您的进程。从您的 CI 工具中，您将需要运行您的 bat / sh 文件来触发您的进程。然后它会启动您的 java 应用程序，该应用程序将与您的 Eclipse 插件通信以触发您的进程。从您的 CI 工具中，您将需要运行您的 bat / sh 文件来触发您的进程。然后它会启动您的 java 应用程序，该应用程序将与您的 Eclipse 插件通信以触发您的进程。从您的 CI 工具中，您将需要运行您的 bat / sh 文件来触发您的进程。

# c++ - vc++折线图示例

> ID：502779
> 
> 赞同：0
> 
> 时间：2009-02-02T10:29:06.143
> 
> 标签：c++, visual-c++, visual-c++-6

有人可以向我提供有关如何在 vc++ 6.0 中绘制折线图的提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T21:36:59.307

在 MFC 中：

请参阅CDC 的[LineTo](http://msdn.microsoft.com/en-us/library/wzc1344s(VS.80).aspx)和 MoveTo。

并使用 CPaintDC 来绘制 OnPaint 事件，就像[这里](http://www.gidforums.com/t-5963.html)一样。

# .net - WCF - 优点和缺点

> ID：502780
> 
> 赞同：16
> 
> 时间：2009-02-02T10:29:37.953
> 
> 标签：.net, wcf

我想从使用过 Windows Communication Foundation 或仅从理论上了解它的人那里了解它的优点和缺点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T21:14:26.403

**主要优势**：一旦您克服了学习曲线，WCF 就可以相对容易地公开和使用软件组件。即，给定一个组件将功能烘焙到 WCF 服务合同中，开发人员可以在进程中、跨单个框上的进程、跨 Windows 内部网或整个 Internet 公开相同的组件，所有这些都只需更改主机和配置信息。同样，所述组件的客户也很容易在任何这些场景中使用它。

**主要缺点**：学习曲线。当许多开发人员第一次开始研究 WCF 时，他们似乎非常害怕。在尝试进入 Juval Lowy 的“Programming WCF Services”时，我做了几次错误的尝试。虽然我发现一旦我开始实际创建和使用组件，就会很快理解。

*要记住的关键*是 WCF 让您编写一些不错的函数式代码并将其包装到一个组件中，然后您可以相对轻松地在几乎任何地方使用它，并具有几乎任何数量的安全性、可靠性和耐用性。

与我们之前被迫使用的相比，WCF 真是太棒了！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T10:45:57.953

一个主要优点是 WCF 允许开发人员对 Windows 通信技术进行单一一致的访问，从而使 SOA 应用程序的开发更加容易。微软已经抽象了很多管道工作以实现这一点。

一个缺点是，WCF 是 Microsoft 的 SOA 实现，因此它的 API 完全由 MS 控制，这使得互操作性有点困难。此外，要部署 WCF 应用程序，您将需要运行 WCF 应用程序的平台上的更多底层硬件资源，因为要处理一个额外的抽象层。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T10:40:24.500

对我来说，您以后通过 SOAP、WS*、TCP、MSMQ、命名管道或任何其他传输方式进行通信的代码是相同的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T10:50:28.753

**优点**

*   它由许多不同的组件组成，因此您可以为安全、传输、身份验证创建新组件
*   它比 ASMX 快
*   支持扩展/负载均衡
*   它的互操作性，适用于 java 等等。

**缺点** - 了解所有不同的传输类型/安全规范的学习曲线。

*如果您想要更快的速度，则必须进入 TCP 级别*

**编辑**还很难掌握与连接客户端有关的并发性

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T16:14:45.427

The advantage is a standard architecture for SOA applications. You *can* customize the components of the architecture to enable connection with any kind of non-Windows clients, however there is a steep learning curve.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T11:36:01.750

除了必须使用 WinStack 之外，我认为不应该存在固有的权衡。WCF 应该取代 .NET 远程处理和沼泽标准 Web 服务（或者更确切地说，WCF 也可以做 Web 服务）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T11:13:38.410

我发现它很容易设置和学习。在没有任何使用 WCF 的经验的情况下，我在几个小时内运行了一个 Web 服务。我现在可以在几分钟内完成。

这样做的缺点是我仍然对 Web 服务几乎一无所知。这可能会转过身来咬你。基于对事物工作方式的错误假设，很容易做出错误的设计决策。例如，在您的服务类中维护状态非常容易，但这会在以后导致扩展问题。

# c# - 自动创建 ListViewSubItems

> ID：502782
> 
> 赞同：0
> 
> 时间：2009-02-02T10:31:06.577
> 
> 标签：c#, listview, .net-2.0, controls

海，

我尝试创建一个**ListViewControl**（平铺模式）并添加了一个*ListViewItem*。我是这样创造的，

```
ListViewItem aFooItem = new ListViewItem("foo");
listView1.Items.Add(aFooItem);  //Adding the ListViewItem to the ListViewControl 
```

现在我运行应用程序并尝试调试第一行。我发现aFooItem 的子项数是1，和aFooItem 本身类似。有人可以帮我为什么 aFooItem 的 SubItems.Count 是 1，即使你我没有明确地向它添加一个项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T10:54:21.977

ListViewItem 的“SubItems”是它包含的列的列表。通过使用默认字符串 ("foo") 初始化 ListViewItem，您添加了一个子项（使用 Text == "foo"）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T10:57:06.713

a 的默认值`ListViewItem` *是*索引 0 处子项的值。当您创建 a`ListViewItem`时，它会自动为您创建默认子项。

# android - 带有 ItemizedOverlay 和地图滚动的 MapView

> ID：502788
> 
> 赞同：5
> 
> 时间：2009-02-02T10:35:09.940
> 
> 标签：android, map, android-mapview

我在 Android 的 MapView 上遇到了自定义 ItemizedOverlay 的问题。

**我所做的：**非常简单的 ItemizedOverlay 类的后代，它只包装我自己类型的项目并使用 ItemizedOverlay 进行所有艰苦的工作。

**什么有效：**几乎所有东西 - 正确绘制物品，我可以点击它们等。

**问题：**如果我通过地图本身在视图中拖动地图，我可以毫无问题地滚动它。但是，如果我尝试开始将地图移动到我的叠加层中的一个项目上（例如“逐项拖动地图”），它就不会移动。

这确实是个问题，因为如果我有“更多”项目，就无法拖动地图（没有取消缩放和抓取项目外的地图）。

即使我不处理由 ItemizedOverlay 生成的任何事件（例如，在我的叠加层中注释掉 onTap()），也会出现此问题。

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T10:22:30.880

好的，我们解决了这个问题。

但我们找到的唯一解决方案是编写我们自己的“ItemizedOverlay”版本（不继承它）。例如。我们正在绘制自己的叠加层并处理“点击事件”。

# html - 如何让 HTML 页面读取文本文档的内容？

> ID：502790
> 
> 赞同：0
> 
> 时间：2009-02-02T10:35:52.980
> 
> 标签：html

如何获取 HTML 页面 (.html) 来读取与 .html 文件位于同一文件夹中的文本文档的内容？服务器是 IIS。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T10:38:14.927

[用于服务器端的](http://www.google.com/search?q=IIS+includes)Google包括.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T10:39:01.710

似乎您可以在 IIS 中使用#include 指令。

[http://msdn.microsoft.com/en-us/library/ms525185.aspx](http://msdn.microsoft.com/en-us/library/ms525185.aspx)

但老实说，我强烈建议使用脚本语言，PHP 或 ASP 家族中的某种语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T10:41:43.077

有人犹豫建议[iframe](http://www.w3schools.com/TAGS/tag_iframe.asp)，但出于完整性考虑...

*（您可能需要服务器端包含，但通常您可能有更大的问题）*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T10:44:13.133

通过将以下 JavaScript 代码添加到网页的元素中：

```
<script>

function clientSideInclude(id, url) 
{

  var req = false;

  // For Safari, Firefox, and other non-MS browsers

  if (window.XMLHttpRequest)
 {
    try {
      req = new XMLHttpRequest();
    } catch (e) {
      req = false;
    }
  } else if (window.ActiveXObject) {
    // For Internet Explorer on Windows
    try {
      req = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e) {
      try {
        req = new ActiveXObject("Microsoft.XMLHTTP");
      } catch (e) {
        req = false;
      }
    }
  }
 var element = document.getElementById(id);
 if (!element) {
  alert("Bad id " + id + 
   "passed to clientSideInclude." +
   "You need a div or span element " +
   "with this id in your page.");
  return;
 }
  if (req) {
    // Synchronous request, wait till we have it all
    req.open('GET', url, false);
    req.send(null);
    element.innerHTML = req.responseText;
  } else {
    element.innerHTML =
   "Sorry, your browser does not support " +
      "XMLHTTPRequest objects. This page requires " +
      "Internet Explorer 5 or better for Windows, " +
      "or Firefox for any system, or Safari. Other " +
      "compatible browsers may also exist.";
  }
}
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T10:46:50.853

[IIS 可以做服务器端包含](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/eced0b89-e052-42ff-baa8-751dd191c3b5.mspx?mfr=true). 但是，如果您不能这样做，并且想要在 HTML 中包含文本文件，您可以使用 XMLHTTPRequest 对象获取文件并使用 Javascript 将其插入到 DOM 中。

自然地，一个 JS 库将使这更容易。例如在[原型](http://www.prototypejs.org/api/ajax/updater)中：

```
new Ajax.Updater($('id_of_div'), 'http://yourdomain/path/to/file.txt'); 
```

这将抓取文件并将内容放入`<div id="id_of_div"></div>`

或者在[jQuery](http://docs.jquery.com/Ajax/load#urldatacallback)中：

```
$("#id_of_div").load("http://yourdomain/path/to/file.txt"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T10:39:30.977

您可以直接在文本文件中放置一个url，用户将通过点击下载它。如果这不是您想要的，那么您可能可以使用服务器端包含（请参阅[此处](http://www.4images.com/ntperl/isiall.htm)和[此处](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/eced0b89-e052-42ff-baa8-751dd191c3b5.mspx?mfr=true)）。如果这不起作用，您必须编写一个脚本 (ASP?) 来读取该文件。

# sql - SQL 数据规范化/性能

> ID：502792
> 
> 赞同：0
> 
> 时间：2009-02-02T10:36:29.047
> 
> 标签：sql, sql-server, sql-server-2005, performance, denormalization

我正在为保险业开发一个 Web API，并试图为保险报价制定合适的数据结构。

数据库已经包含一个“评级”表，基本上是：

```
sysID (PK, INT IDENTITY)
goods_type (VARCHAR(16))
suminsured_min (DECIMAL(9,2))
suminsured_max (DECIMAL(9,2))
percent_premium (DECIMAL(9,6))
[Unique Index on goods_type, suminsured_min and suminsured_max] 
```

[编辑] 每种类型的商品通常有 3 - 4 个投保范围 [/编辑]

goods_types 列表很少更改，大多数保险查询将涉及价值低于 100 美元的商品。因此，我正在考虑使用以下格式的表格进行反规范化（对于从 $0.00 到 $100.00 的所有值）：

```
Table Name: tblRates[goodstype]
suminsured (DECIMAL(9,2)) Primary Key
premium (DECIMAL(9,2)) 
```

对这些数据进行非规范化应该很容易维护，因为费率通常最多每月更新一次。所有价值大于 100 美元的请求将始终在主表中查找并计算。

我的问题是：
1\. 我最好将总和值存储为 DECIMAL(9,2) 还是存储在 BIGINT 中的美分值？
2\. 这种反规范化方法涉及在可能的 20 个表中存储 10,001 个值（0.00 美元到 100.00 美元，增量为 0.01 美元）。这可能比查找 percent_premium 并执行计算更有效吗？- 还是我应该坚持使用主表并进行计算？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T11:11:35.827

不要创建新表。您已经有了关于商品、最小值和最大值的索引，所以这个 sql 用于（已知商品及其价值）：

```
SELECT percent_premium 
FROM ratings 
WHERE goods='PRECIOUST' and :PREC_VALUE BETWEEN suminsured_min AND suminsured_max 
```

将有效地使用您的索引。

您要查找的数据类型是***smallmoney***。用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T11:24:30.277

您建议的计划将使用 a `binary search`on `10001`rows 而不是`3`or `4`。

这几乎不是性能改进，不要那样做。

至于算术，`BIGINT`会稍微快一点，我想你几乎不会注意到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T10:56:06.170

我不完全确定我们在谈论什么计算，但除非它们非常复杂，否则它们很可能比在几个不同的表中查找数据要快得多。如果可能，请在数据库中执行计算（即使用存储过程）以最小化应用程序层之间的数据流量。

即使数据加载会更快，我认为必须每月（甚至每季度一次）更新非规范化数据的想法非常可怕。您可能可以很快完成这项工作，但是下一个处理系统的人呢？您是否会要求他们学习数据库结构，记住每次需要更新的 20 多个表中的哪一个，并正确执行？我想说，去规范化可能带来的性能提升对于用不正确的信息污染数据的风险来说并不值得。

# sql - SQL - min() 获得最低值，max() 获得最高值，如果我想要第二个（或第五个或第 n 个）最低值怎么办？

> ID：502794
> 
> 赞同：4
> 
> 时间：2009-02-02T10:37:39.590
> 
> 标签：sql, postgresql

我要解决的问题是我有一个这样的表：

a 和 b 指的是不同表上的点。距离是点之间的距离。

```
| id | a_id | b_id | distance | delete |
| 1  |  1   |   1  |  1       |   0    |
| 2  |  1   |   2  |  0.2345  |   0    |
| 3  |  1   |   3  |  100     |   0    |
| 4  |  2   |   1  |  1343.2  |   0    |
| 5  |  2   |   2  |  0.45    |   0    |
| 6  |  2   |   3  |  110     |   0    |
.... 
```

我正在寻找的重要列是a_id。如果我想为每个 a 保留壁橱 b，我可以这样做：

```
update mytable set delete = 1 from (select a_id, min(distance) as dist from table group by a_id) as x where a_gid = a_gid and distance > dist;
delete from mytable where delete = 1; 
```

这会给我一个这样的结果表：

```
| id | a_id | b_id | distance | delete |
| 1  |  1   |   1  |  1       |   0    |
| 5  |  2   |   2  |  0.45    |   0    |
.... 
```

即对于a_id 的每个值，我需要一行，并且该行应该具有每个a_id 的最低距离值。

但是我想为每个 a_gid 保留 10 个最近的点。我可以使用 plpgsql 函数来做到这一点，但我很好奇是否有更多 SQL-y 方式。

min() 和 max() 返回最小值和最大值，如果有一个像 nth() 这样的聚合函数，它会返回第 n 个最大/最小值，那么我可以以与上述类似的方式执行此操作。

我正在使用 PostgeSQL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T10:56:30.630

我喜欢 postgres，所以当我看到这个问题的那一刻就把它当作一个挑战。

所以，对于表：

```
 Table "pg_temp_29.foo"
 Column |  Type   | Modifiers 
--------+---------+-----------
 value  | integer | 
```

使用以下值：

```
 SELECT value FROM foo ORDER BY value;
 value 
-------
     0
     1
     2
     3
     4
     5
     6
     7
     8
     9
    14
    20
    32
(13 rows) 
```

你可以做一个：

```
SELECT value FROM foo ORDER BY value DESC LIMIT 1 OFFSET X 
```

其中 X = 0 表示最高值，1 表示第二高，2 ......等等。

这可以进一步嵌入子查询中以检索所需的值。因此，要使用原始问题中提供的数据集，我们可以通过执行以下操作获得具有前十个最低距离的 a_id：

```
SELECT a_id, distance FROM mytable
 WHERE id IN
  (SELECT id FROM mytable WHERE t1.a_id = t2.a_id
   ORDER BY distance LIMIT 10);
 ORDER BY a_id, distance;

 a_id | distance 
------+----------
    1 |   0.2345
    1 |        1
    1 |      100
    2 |     0.45
    2 |      110
    2 |   1342.2 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T12:25:02.790

试试这个：

```
SELECT  *
FROM    (
    SELECT  a_id, (
        SELECT b_id
        FROM mytable mib
        WHERE mib.a_id = ma.a_id
        ORDER BY
            dist DESC
        LIMIT 1 OFFSET s
        ) AS b_id
    FROM    (
        SELECT DISTINCT a_id
        FROM mytable mia
        ) ma, generate_series (1, 10) s
    ) ab
WHERE   b_id IS NOT NULL 
```

检查 PostgreSQL 8.3

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T10:44:21.467

PostgreSQL 有解析函数 rank() 吗？如果是这样尝试：

```
select a_id, b_id, distance
from
( select a_id, b_id, distance, rank() over (partition by a_id order by distance) rnk
  from mytable
) where rnk <= 10; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-05T18:34:58.340

这条 SQL 应该会发现你在 SQL Server、MySQL、DB2、Oracle、Teradata 和几乎任何其他 RDBMS 中工作的薪水最低的第 N 位：（注意：由于子查询导致性能低下）

```
SELECT * /*This is the outer query part */
FROM mytable tbl1
WHERE (N-1) = ( /* Subquery starts here */
SELECT COUNT(DISTINCT(tbl2.distance))
FROM mytable tbl2
WHERE tbl2.distance < tbl1.distance) 
```

在上面的查询中要理解的最重要的事情是，每次外部查询处理一行时都会评估子查询。换句话说，内部查询不能独立于外部查询进行处理，因为内部查询也使用 tbl1 值。

为了找到第 N 个最低值，我们只需找到恰好比自身低 N-1 个值的值。

# asp.net-mvc - 如何在不首先加载实体框架模型的情况下删除它？

> ID：502795
> 
> 赞同：39
> 
> 时间：2009-02-02T10:38:02.430
> 
> 标签：asp.net-mvc, entity-framework, linq-to-entities

我很确定我已经在某处看到了这个问题的答案，但是由于我在 SO 或谷歌上进行了几次搜索都找不到它，所以我还是再问一次......

在实体框架中，删除数据对象的唯一方法似乎是

```
MyEntityModel ent = new MyEntityModel();
ent.DeleteObject(theObjectToDelete);
ent.SaveChanges(); 
```

但是，这种方法需要先将对象加载到控制器，在这种情况下，首先要删除它。有没有办法删除仅引用其 ID 的业务对象？

如果有更聪明的方式使用 Linq 或 Lambda 表达式，那也很好。但是，主要目标是避免加载数据只是为了删除它。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-06-13T22:18:04.547

值得一提的是，Entity Framework 同时支持 Linq to Entities 和 Entity SQL。如果您发现自己想要进行可能影响许多记录的删除或更新，您可以使用`ExecuteNonQuery`.

在 Entity SQL 中，这可能看起来像

```
 Using db As New HelloEfEntities

        Dim qStr = "Delete " & _
                  "FROM Employee"
        db.ExecuteStoreCommand(qStr)
        db.SaveChanges()
    End Using 
```

在这个例子中，`db`是我的`ObjectContext`. 另请注意，该`ExecuteStoreCommand`函数采用可选的参数数组。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-02T11:31:39.637

我找到[了这篇文章](http://www.thejoyofcode.com/Working_with_Ids_in_the_Entity_Framework.aspx)，其中指出确实没有更好的方法来删除记录。给出的解释是该记录唯一的所有外键、关系等也被删除，因此 EF 需要具有有关该记录的正确信息。我对为什么不来回加载数据就无法实现这一点感到困惑，但由于它不会经常发生，我决定（现在）我不会打扰。

如果您确实有解决此问题的方法，请随时告诉我=）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T14:02:48.523

提前道歉，但我不得不质疑你的目标。

如果您删除一个对象而没有阅读它，那么您无法知道在您确认要删除该对象和实际删除之间是否有其他用户更改了该对象。在“普通旧 SQL”中，这就像做：

```
DELETE FROM FOO
WHERE ID = 1234 
```

当然，大多数人实际上并没有这样做。相反，他们会做类似的事情：

```
DELETE FROM FOO
WHERE ID = 1234
  AND NAME = ?ExpectedName AND... 
```

关键是如果另一个用户在此期间更改了记录，则删除应该失败（什么也不做）。

有了这个更好的问题陈述，使用实体框架时有两种可能的解决方案。

1.  在您的 Delete 方法中，现有实例，比较属性的预期值，如果它们相同则删除。在这种情况下，实体框架将负责编写包含属性值的 DELETE 语句。

2.  编写一个接受 IDE 和其他属性值的存储过程，然后执行它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T11:44:00.437

有一种方法可以通过重新计算实体的 EntityKey 来欺骗加载实体。它看起来有点像 hack，但可能是在 EF 中执行此操作的唯一方法。

[关于删除而不获取](http://sqlskills.com/BLOGS/BOBB/post/Entity-Framework-Beta3-Deleting-without-fetching.aspx)的博客文章

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-06-14T04:22:16.130

您可以创建一个具有相同 id 的对象并将其传递给删除，但如果您有复杂的关系，您可能需要更多的关系，它对简单对象很有用

```
 var user = new User { ID = 15 };
                context.Entry(user).State = EntityState.Deleted;
                context.SaveChanges(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-05-08T02:32:14.897

```
var toDelete = new MyEntityModel{
    GUID = guid,
    //or ID = id, depending on the key
    };
Db.MyEntityModels.Attach(toDelete);
Db.MyEntityModels.DeleteObject(toDelete);
Db.SaveChanges(); 
```

如果您的键包含多个列，您需要提供所有值（例如 GUID、columnX、columnY 等）。

如果您喜欢花哨的东西，还可以[在这里](http://www.britishdeveloper.co.uk/2011/03/delete-by-id-entity-framework-how-to.html)查看通用功能。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-23T07:07:59.473

使用 Entity Framework 5 有[Entity Framework Extended Library](https://github.com/loresoft/EntityFramework.Extended)。在 NuGet 上可用。然后你可以写这样的东西：

```
context.Users.Delete(u => u.Id == id); 
```

它对于批量删除也很有用。

# xml - Flash 中部分加载的 XML

> ID：502804
> 
> 赞同：0
> 
> 时间：2009-02-02T10:41:54.917
> 
> 标签：xml, flash, actionscript, download

在 Flash 中，可以在加载 XML 文件时读取 XML 数据吗？即**读取部分下载的 XML 字符串**作为其余下载，因此我们可以尽快处理它。

1.  您是否收到每次下载小块数据时都会触发的**事件？**像 URLLoader 一样？
2.  由于无法解析部分 XML ，您是否可以访问**原始字符串？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T11:09:04.397

我很确定你不能开箱即用，即使你找到了一种方法 - 也许通过调用 php 脚本来分块加载文件 - 我不太明白你会用它做*什么*现在有一个格式不正确的 XML 块，您需要尝试优雅地解析它。我无法想象那将是微不足道的。如果您真的想将数据分成几部分，将文件分成更小但完整的部分是否可行？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T01:54:05.157

您可以使用 URLStream 对象从 URL 加载数据并在下载时读取它。

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLStream.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLStream.html)

但是，您必须使用一些特殊的 SAX / 事件驱动解析器，因为本机 XML 对象无法处理“部分”xml 字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T13:21:38.027

来自 Adob​​e Flex 语言参考：

> 请注意，使用 URLLoader 对象，在完全接收数据之前无法访问数据。

所以问题 1 的答案是不，您不能访问仅部分下载的数据。

至于 2，URLLoader 不对加载的数据进行任何形式的解析，您可以通过加载器实例的 data 属性访问原始字节。如果您*知道*`new XML(loader.data)`它的 XML，则可以通过显式调用将其转换为 XML 结构。

总之，如果你想要部分下载，你必须编写自己的服务器端解决方案，将文件分成更小的块，并按照 Andrew 的建议单独下载这些块。

# c - sizeof (int) == sizeof (void*)?

> ID：502811
> 
> 赞同：14
> 
> 时间：2009-02-02T10:45:03.663
> 
> 标签：c, integer, pointers

是否存在与指针大小相同的整数类型？保证所有微架构？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-02T10:51:20.623

根据[此 Wikipedia page](http://en.wikipedia.org/wiki/Stdint.h#Integers_wide_enough_to_hold_pointers_.28optional.29)，在 C99 中，您的 stdint.h 标头*可能会*声明 intptr_t 和 uintptr_t，但那当然需要

*   C99
*   选择实现标准的这个可选部分的编译器实现者

所以总的来说，我认为这个很难。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-02T10:59:34.197

简单地说，没有。不保证适用于所有架构。

我的问题是：为什么？如果你想分配一个足够大的类型来存储 a `void*`，最好的分配是（令人惊讶的是:-) a `void*`。为什么需要把它放在一个`int`?

编辑：根据您对重复问题的评论，您希望存储指针 (1,2,3) 的特殊值以指示额外信息。

*不！！不要这样做！*. 不能保证 1、2 和 3 不是完全有效的指针。在需要在 4 字节边界上对齐指针的系统中可能就是这种情况，但是，由于您询问了所有体系结构，我假设您具有高价值的可移植性。

找到另一种正确的方法。例如，使用联合（内存中的语法，可能是错误的）：

```
typedef struct {
    int isPointer;
    union {
        int intVal;
        void *ptrVal;
    }
} myType; 
```

然后您可以使用 isPointer 'boolean' 来决定是否应该将联合视为整数或指针。

编辑：

如果执行速度是最重要的，那么 typedef 解决方案就是要走的路。基本上，您必须为要运行的每个平台定义所需的整数。您可以通过条件编译来做到这一点。我还将添加运行时检查以确保您已正确编译每个平台（我在源代码中定义它，但您会将其作为编译器标志传递，如“ `cc -DPTRINT_INT`”）：

```
#include <stdio.h>
#define PTRINT_SHORT
#ifdef PTRINT_SHORT
    typedef short ptrint;
#endif
#ifdef PTRINT_INT
    typedef int ptrint;
#endif
#ifdef PTRINT_LONG
    typedef long ptrint;
#endif
#ifdef PTRINT_LONGLONG
    typedef long long ptrint;
#endif

int main(void) {
    if (sizeof(ptrint) != sizeof(void*)) {
        printf ("ERROR: ptrint doesn't match void* for this platform.\n");
        printf ("   sizeof(void*    ) = %d\n", sizeof(void*));
        printf ("   sizeof(ptrint   ) = %d\n", sizeof(ptrint));
        printf ("   =================\n");
        printf ("   sizeof(void*    ) = %d\n", sizeof(void*));
        printf ("   sizeof(short    ) = %d\n", sizeof(short));
        printf ("   sizeof(int      ) = %d\n", sizeof(int));
        printf ("   sizeof(long     ) = %d\n", sizeof(long));
        printf ("   sizeof(long long) = %d\n", sizeof(long long));
        return 1;
    }

    /* rest of your code here */

    return 0;
} 
```

在我的系统（Ubuntu 8.04，32 位）上，我得到：

```
ERROR: ptrint typedef doesn't match void* for this platform.
   sizeof(void*    ) = 4
   sizeof(ptrint   ) = 2
   =================
   sizeof(short    ) = 2
   sizeof(int      ) = 4
   sizeof(long     ) = 4
   sizeof(long long) = 8 
```

在这种情况下，我知道我需要使用 PTRIINT_INT（或 long）进行编译。可能有一种方法可以在编译时使用#if 来捕捉它，但我现在懒得研究它。如果您遇到的平台没有足够的整数类型来保存指针，那么您就不走运了。

请记住，使用特殊指针值 (1,2,3) 来表示整数也可能不适用于所有平台 - 这实际上可能是指针的有效内存地址。

不过，如果你要无视我的建议，我也无能为力阻止你。毕竟这是你的代码:-)。一种可能性是检查 malloc 的所有返回值，如果您得到 1、2 或 3，则再次使用 malloc（即，有一个 mymalloc() 自动执行此操作）。这将是一个轻微的内存泄漏，但它可以保证您的特殊指针和真实指针之间没有冲突。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-02T11:00:47.673

C99 标准定义了标准 int 类型：

> 7.18.1.4 能够保存对象指针的整数类型 以下类型指定了一个有符号整数类型，其属性是任何指向 void 的有效指针都可以转换为该类型，然后转换回指向 void 的指针，结果将等于原指针：
> 
> ```
>  intptr_t 
> ```
> 
> 以下类型指定了一个无符号整数类型，其属性是任何指向 void 的有效指针都可以转换为此类型，然后转换回指向 void 的指针，结果将与原始指针进行比较：
> 
> ```
>  uintptr_t 
> ```
> 
> 这些类型是可选的。

C99 还定义了 size_t 和 ptrdiff_t：

> 类型是
> 
> ```
>  ptrdiff_t 
> ```
> 
> 这是两个指针相减结果的有符号整数类型；
> 
> ```
>  size_t 
> ```
> 
> 这是 sizeof 运算符结果的无符号整数类型；和

我见过的架构的对象的最大大小等于整个内存，所以 sizeof(size_t) == sizeof(void*)，但我不知道有什么可以移植到 C89（即`size_t`）并保证足够大（即`uintptr_t`）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-02T10:51:13.463

这在标准的 32 位系统上是正确的，但肯定不能保证，而且您可以找到许多不正确的架构。例如，一个常见的误解是 x86_64 上的 sizeof(int) 将是 8（我猜是因为它是 64 位系统），但事实并非如此。在 x86_64 上，sizeof(int) 仍为 4，但 sizeof(void*) 为 8。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T13:01:44.590

The standard solution to this problem is to write a small program which checks the sizes of all int types (short int, int, long int) and compares them to void*. If there is a match, it emits a piece of code which defines the intptr type. You can put this in a header file and use the new type.

It's simple to include this code in the build process (using `make`, for example)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-02T10:59:03.043

不，最接近可移植指针的整数类型将是`intptr_t`and `ptrdiff_t`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T11:57:40.193

Usually sizeof(*void) depends on memory bus width (although not necessarily - pre-RISC AS/400 had 48-bit address bus but 64-bit pointers), and int usually is as big as CPU's general-purpose register (there are also exceptions - SGI C used 32-bit ints on 64-bit MIPS).

So there is no guarantee.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T10:52:34.477

不。

我不相信 C 标准甚至指定[标准 int 大小](http://en.wikipedia.org/wiki/C_variable_types_and_declarations)。将其与现有的所有架构（8/16/32/64 位等）结合起来，就无法保证任何事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T10:58:21.500

int 数据类型将是大多数架构的答案。

但是对于**任何**（微）架构都**不能**保证这一点。

 *** * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-02T10:58:41.233

答案似乎是“否”，但如果您需要的只是一种可以同时充当两者的类型，则可以使用联合：

```
union int_ptr_t {
    int i;
    void* p;
}; 
```

# xml - 在 XML 中存储 base64 数据？

> ID：502814
> 
> 赞同：47
> 
> 时间：2009-02-02T10:46:17.420
> 
> 标签：xml, language-agnostic, base64, cdata

如何在 XML 中存储 base64 字符串？

您是否使用 CDATA 在 XML 中存储 base64 字符串？它允许在字符串中使用 < > 会有所帮助吗？

如果某些字符与 XML 冲突，base64 是否可配置？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-02-02T10:52:18.297

您可以将其存储为文本或属性值；无需转义或`CDATA`部分。标准的 base 64 字符`+`和`/`（除了`a-z`,`A-Z`和`0-9`）根本不会干扰 XML 解析。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-02T10:51:04.370

[Base64](http://en.wikipedia.org/wiki/Base64)仅使用字母数字字符和“+”（加号）、“/”（斜线）和“=”（等于）。无需为 XML 编码任何东西。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-02T10:51:22.730

Base64 字符集中没有任何字符会与 XML 字符串发生冲突。

# html - 如何远程更新网页？使用网络服务或电子邮件，无需直接访问服务器

> ID：502817
> 
> 赞同：1
> 
> 时间：2009-02-02T10:48:57.510
> 
> 标签：html

如何远程更新网页？是否有网络服务或者我可以通过电子邮件进行，我无法直接访问服务器。

我们只需要在紧急情况下添加一个警报设施。例如，主页顶部的简单短信说“我们今天因恶劣天气而关闭”。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T12:33:44.583

我不能说我明白你的意思，但我会以一般方式回答

1-**如果您从头开始构建整个站点：您可以通过**[dotNetNuke](http://www.dotnetnuke.com/)或[joomla](http://www.joomla.org/)等任何 CMS 创建您的站点，这将允许您登录和编辑您想要的内容

2-**如果您只是从头开始构建此页面：**您可以在构建页面时考虑在线编辑，在这种情况下，我建议构建两个页面，一个用于查看内容，另一个用于在线编辑，您可以使用任何 HTML -像[FCKEditor一样的编辑器控件](http://www.fckeditor.net/)

3-**如果您正在处理已构建的页面：**构建管理页面会更容易，您可以将新版本的内容页面上传到它，并且管理页面负责替换内容页面

希望这可以帮助您，如果没有，请随时清除您的需求，以便我们提供更多帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T12:55:53.400

On a general basis, yes it's possible, that's what most blog engines and CMS are for. It's also fairly easy to develop an ad-hoc program if all you need is to be able to put an offline page. If what you mean however is you need to do today witout any access to the server, contacting the person hosting your site or your DNS are indeed your best chances.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T13:36:03.240

我建议让某人在页面上放置一个[twitter](http://twitter.com/)小部件，然后您可以发送短信/电子邮件或使用网络浏览器发送您的更新，它们将自动出现在网站上。

你有可能让别人为你做这件事吗？[Twittercard](http://twittercard.com/)可用于生成要插入的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T11:16:37.360

联系您拥有 DNS/主机服务/名称解析的主机服务器公司，并要求他们将 DNS 调用重定向到您选择的另一台服务器，并告知您希望人们在尝试访问您的页面时看到的通知。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-30T22:14:11.043

看起来这个帖子有点过时了，但对于仍在寻找[使用电子邮件更新您的网站](https://www.sitemailcms.com/)的方法的任何人，您可能需要查看[https://www.sitemailcms.com/](https://www.sitemailcms.com/)。这是我为此开发的一项服务。

# php - 如何获取 MySQL 中的每 n 行？

> ID：502818
> 
> 赞同：9
> 
> 时间：2009-02-02T10:49:45.043
> 
> 标签：php, mysql, mysqli

我有一个表，其中包含每分钟记录的数据，所以我每分钟都有一行。在返回数据进行处理时，要求最后 6 小时的准确度，但在此之后，较低的准确度就足够了，例如每 5 分钟一次。

我可以将所有数据返回到一个数组中，然后删除除第 5 个元素之外的所有元素，但这需要 MySQL 返回所有数据，然后先读入数组 - 相当多的数据。

如何返回 MySQL 中的每 n 行？我已经阅读[了这篇](http://marksitblog.blogspot.com/2008/06/mysql-challenge-limit-rows-accessed.html)博客文章，其中建议使用 primaryKey % 5 = 0 其中 primaryKey 是 auto_increment 但这

a) 不使用索引 b) 将仅返回可被 5 整除的 primaryKey 值，并且在删除的情况下，实际上可能不是每 5 行

这可以仅在 SQL 查询中完成，还是需要使用游标逐行遍历结果集？

我在 PHP 中使用[MySQLi](http://www.php.net/manual/en/book.mysqli.php)连接到数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T11:07:18.953

每 5 分钟的时间戳列表：

```
SELECT
  MIN(logtimestamp) AS first_of_five_minutes
FROM tLog
GROUP BY
  DATE(logtimestamp),
  HOUR(logtimestamp),
  MINUTE(logtimestamp) - (MINUTE(logtimestamp) % 5) 
```

现在，您可以将其用作子选择，通过`logtimestamps`加入`first_of_five_minutes`. 当然，`WHERE`必须在内部和外部复制额外的 - 子句，以便获得“正确”的时间戳。

另外，请注意，这将返回每五分钟间隔内的第一个时间戳，而直接使用`minutes%5 = 0`仅返回日志条目的解决方案实际上是 :05 的倍数，如果您在记录日志或类似方面有延迟，则可能会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T10:57:16.040

完全未经测试，但这可能有效

```
SELECT Row, col_a 
FROM (SELECT @row := @row + 1 AS Row, col1 AS col_a FROM table1) As derived1 
WHERE Row%5 = 0; 
```

# ssl - 我需要什么 SSL 证书？

> ID：502822
> 
> 赞同：23
> 
> 时间：2009-02-02T10:50:36.740
> 
> 标签：ssl, ssl-certificate

我正在开发将使用 clickonce（在网站 foo.com 上）部署的软件，然后将使用带有加密传输的 WCF 连接到我的服务器

所以我需要一个 SSL 证书，它将：

*   确定我的 foo.com 网站确实是我的网站
*   将我使用 clickonce 部署的 exe 识别为正版
*   确定我的应用程序服务器确实是我的应用程序服务器。

我还希望我的 SSL 证书由公众已知的权威机构签署（即 firefox 或 windows 不会要求用户先安装权威机构的证书！）

您会购买什么 SSL 证书？

我浏览了 Verisign 网站，“Secure Site EV”证书每年花费 1150 欧元（“Pro”版本似乎仅用于与旧浏览器兼容）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-02T16:07:27.257

听起来您正在寻找两种不同类型的证书：

1 - SSL 证书 - 用于验证您的网站/应用程序服务器。

2 - 代码签名证书 - 用于您提供的 exe 的完整性/身份验证。

通常，它们是两个不同的证书，具有两个不同的证书配置文件。至少，您需要一个具有两种不同密钥用法或扩展密钥用法的证书。

一些没有特定顺序的想法：

*   检查您的目标浏览器，它们每个都应该有一组预配置的根证书——这些是最广泛认可的公共证书来源。我可能会同时检查 Firefox 和 IE。我知道的大牌证书供应商有 - Versign、GeoTrust、RSA、Thawte、Entrust。但也有 GoDaddy 和许多其他人。提供的浏览器中作为受信任的根证书提供的任何内容都将允许您连接到您的用户而无需额外的 greif。

*   我建议用谷歌搜索“代码签名证书”和“SSL 证书”。

*   您如何配置您的站点将决定您的网站是否经过验证或您的身份验证服务器是否经过验证。如果证书存储在应用服务器上，那么您的用户将一直获得 SSL 加密到服务器。但是许多站点将 SSL 证书放在更靠前的位置——比如放在防火墙上，然后在其后面放置一组应用服务器。只要网络经过仔细配置，我看不出其中存在安全漏洞。对于外部用户来说，这两种配置看起来是一样的——他们会锁定他们的浏览器和一个证书，告诉他们 www.foo.com 正在提供它的凭据。

我看到 SSL 证书非常优惠： - GoDaddy - 12.99 美元 - Register.com - 14.99 美元

但它们不一定是*代码签名证书*。例如，虽然 GoDaddy 的 SSL 证书是 12.99 美元，但他们的[代码签名证书](http://www.godaddy.com/gdshop/ssl/signing.asp?isc=sslqgo003a&ci=13314)是 199.99 美元！这是许多证书供应商商业模式的一部分——用廉价的 SSL 证书引诱你，让你为代码签名付费。可以证明代码签名证书的责任相对较高。而且……他们必须以某种方式补贴廉价的 SSL 证书。

从理论上讲，应该可以制作一个同时进行代码签名和 SSL 的证书，但我不确定你是否想要这样。如果发生了什么事，能够隔离这两个功能会很好。此外，我很确定您必须致电证书供应商并询问他们是否这样做，如果他们不这样做，让他们这样做可能会抬高价格。

至于供应商，需要考虑的事项：

*   技术几乎都是一样的。这些天来，目标是至少 128 位密钥，我可能会将它提高到 256，但我很偏执。
*   除了浏览器可接受性之外，支付更多费用的唯一原因是名称识别。在偏执的安全专家中，我希望 RSA、Thawte、Verisign 和 GeoTrust 有很好的声誉。也可能是 EnTrust。这可能仅在您处理以安全为重点的产品时才重要。我认为您的普通用户不会那么清楚。
*   从安全极客的角度来看 - 您的安全性取决于您的根 CA（证书颁发机构）的安全性。对于真正偏执的人来说，要做的事情是深入了解公司如何托管其根和发行 CA 的背景材料，它们是如何进行物理安全的？网络安全？人员访问控制？另外 - 他们是否有公共 CRL（证书吊销列表），您如何吊销证书？他们是否提供 OCSP（在线证书状态协议）？他们如何检查证书请求者以确保他们将正确的证书提供给正确的人？...如果您提供的东西必须高度安全，那么所有这些东西真的很重要。医疗记录、财务管理应用程序、税务信息等应得到高度保护。大多数网络应用程序都不是

在最后一颗子弹上——如果你深入研究世界上的 Verisigns——非常昂贵的证书——你可能会看到它的价值。他们拥有庞大的基础设施，并且非常重视 CA 的安全性。我不太确定超级便宜的托管服务。也就是说，如果您的风险很低，那么与 12.99 美元相比，300 美元的 SSL 证书没有多大意义！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-02T15:02:16.483

因此，对于网站/应用程序服务器，您需要 SSL 证书。您*不需要*EV 证书。为此，我使用了来自 QuickSSL 的证书，因为与其他一些廉价证书提供商不同，它们不需要在服务器上安装中间证书 - 这对我来说是没有人的。

用于签署完全不同类型证书的应用程序（有点，它仍然是 X509 证书，但您用于网站的证书不能用于签署应用程序）。您需要来自[Verisign](http://www.verisign.com/products-services/security-services/code-signing/digital-ids-code-signing/)或[Globalsign](http://www.globalsign.com/developer/code-signing-certificate/index.htm)之类的验证码签名证书。这些证书比普通的旧 SSL 证书贵一个数量级，并且要求您成为一家注册公司并制作这些文件。

# database - DBMS 中使用的数据结构

> ID：502827
> 
> 赞同：8
> 
> 时间：2009-02-02T10:51:45.023
> 
> 标签：database, data-structures, rdbms

像 Oracle、MySQL 和 Sqlite 等 DBMS 中用于存储和检索记录的数据结构是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T11:01:22.897

[通常是B 树](http://en.wikipedia.org/wiki/B-tree)的巧妙实现

从上面链接的维基百科文章：

> m阶B树（每个节点的最大子节点数）是一棵满足以下属性的树：
> 
> 1.  每个节点最多有 m 个子节点。
> 2.  每个节点（除了根节点和叶子节点）至少有 m⁄2 个子节点。
> 3.  如果根不是叶节点，则根至少有两个子节点。
> 4.  所有叶子都出现在同一级别，并携带信息。
> 5.  具有 k 个子节点的非叶节点包含 k–1 个键

其优点是可以在对数时间内访问数据，就像大多数搜索树（例如标准二叉树）一样，但在平均情况下时序属性更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T11:22:25.943

**MySQL**具有可插拔的存储系统。这意味着引擎可以使用不同的存储。它目前有 5-6 个可供您使用。而且由于它是开源的，您可以看到它是如何完成的。

**SQLite**使用它自己的带有日志的 B-Tree 实现。开源——你可以看看。

**Firebird**和**Interbase**正在使用具有多记录版本控制系统的 B-Trees 进行存储。Firebird 是开源的。值得一看。

无法判断**Oracle**、**MS SQL Server**或其他专有数据库系统，因为它们对存储信息保密。

# php - 如何将子域合并到 MVC 框架中

> ID：502835
> 
> 赞同：3
> 
> 时间：2009-02-02T10:55:30.693
> 
> 标签：php, model-view-controller

随着时间的推移，我开发了自己的框架，它运行良好 - 它很轻，速度很快，并且被证明可以处理不错的负载。

现在我正在开发一个可以被描述为在线商店的项目，每个用户都将拥有他的子域，在那里他的物品可以出售。

我的框架通过 / 拆分请求 url 并确定什么是控制器、操作参数等来工作。

这很好用，但是如何处理子域呢？

我已经修改了我的请求对象，所以当我输入时让我们说：

[http://kodi.shop.local/](http://kodi.shop.local/)

（我添加了 SeverAlias *.shop.local ）

这就是我的请求对象的样子：

```
DPLS_Request Object
(
    [_request] => Array
        (
            [0] => 
            [1] => 
            [action] => defaultAction
            [controller] => home
        )

    [_params] => Array
        (
        )

    [_rurl:private] => kodi.shop.local
    [_segment] => kodi
    [get_params] => Array
        (
        )

) 
```

所以 _segment 是子域，后来我可以在代码中使用它来验证它与用户名和其他东西，但在此之前我就遇到了概念问题。我的问题是我的框架希望传递一些控制器和操作，并且因为他在 URL 末尾得到的只是 / 他假设它应该显示索引页面:(

那么接下来要做什么......如何将子域合并到整个 mvc 控制器/动作故事中？

一种快速而肮脏的解决方案是修改我的请求类的一部分：

```
if($this->_request['controller']==''){ 
    $this->_request['controller'] = DEFAULT_CONTROLLER; 
}
if($this->_request['action']==''){
    $this->_request['action'] = DEFAULT_ACTION; 
} 
```

并将其包装在另一个**if**中以测试是否存在 _segment，如果将其分配给控制器 DEFAULT _SHOP _CONTROLLER，我将在配置文件中定义它，例如“存储”

所以上面的请求类似于输入[http://shop.local/store/](http://shop.local/store/) （它将运行“存储”控制器和默认操作）

在这种情况下你会怎么做？处理子域、控制器和操作时是否有任何“最佳实践”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T16:18:07.777

听起来，对我来说，您描述的方法是实现您正在添加的功能的合乎逻辑的下一步。新功能会带来一些额外的复杂性，但是您的请求对象/路由器应该很好地封装“提供段时我调用什么控制器？提供段和控制器时？”的逻辑。等我说去吧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T17:18:27.093

我个人不会开始将各种“特定”条件添加到与子域相关的框架中，因为子域在一种情况下的含义在另一种情况下并不一定意味着相同的东西。（此外，框架假设的越多，它就越糟糕）

例如，有些人使用子域来定义语言环境（英文版为 en.site.com，法文版为 fr.site.com...），但是通过这种设置，无论哪种语言，它都会使用“相同”的控制器该网站被翻译成。

只需执行一个简单的重写规则，例如：将 *.store.site.com 重写为 *.site.com/store/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T11:08:48.983

你所说的听起来像是多租户。Mike Hadlow 在他正在构建的 ASP.NET MVC 应用程序中对他解决问题的方法做了很好的描述，您可以在此处阅读：http: [//mikehadlow.blogspot.com/2008/11/multi-tenancy-part-2 -components-and.html](http://mikehadlow.blogspot.com/2008/11/multi-tenancy-part-2-components-and.html)

# eclipse - 为 Java 和 PHP 设置 Eclipse

> ID：502838
> 
> 赞同：15
> 
> 时间：2009-02-02T10:56:14.733
> 
> 标签：eclipse

我已经安装了用于 Java 开发的 Eclipse。我还想为 PHP、CSS/HTML 和 Javascript 安装插件，但我检查过的所有网站都只提供“一体化”包，所以我可以下载一体化 Java 包或一个多合一的 PHP 包，但不能同时使用两者。

如何设置我现有的安装也支持 PHP 文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-02T11:01:48.420

我使用可以作为[常规 Eclipse 软件更新安装的](http://www.phpeclipse.com/wiki/Installation)[PHPEclipse](http://www.phpeclipse.com/)

[PDT](http://wiki.eclipse.org/PDT/)也可以作为[更新安装](http://wiki.eclipse.org/PDT/Installation#From_Update_Site)。

对于 HTML/CSS 等，可以[以类似的方式安装](http://download.eclipse.org/webtools/updates/)[WTP](http://www.eclipse.org/webtools/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-02T11:02:34.893

如果您已经安装了 Eclipse，请按照[PDT 安装](http://wiki.eclipse.org/PDT/Installation#From_Update_Site)中的说明安装 PDT（PHP 开发工具）。这将包括 Web Tools Project (WTP)，它为 HTML 和 CSS 带来了编辑器和工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-03T23:01:43.440

这个问题让我抓狂 2\. 首先我下载了​​ PDT eclipse，它不会使用 google 插件或 apache ant。然后我下载了 Eclipse SDK 以使用 java ant GWT 并且无法将 php 加载到它上面。

如果你问我，这个程序很烂。我喜欢这个想法，但是更新几乎没有用，而且它不像它所说的那样支持多种编码语言。该网站也令人震惊，因为它为您提供了 100 个下载选项。

难道刚刚制作了一个平台，然后提供了插件的链接？？？

如果我错了，请纠正我，但试图让 PHP 和 Java 在 Eclipse 中工作是一种折磨。我已经卡了3天了，安装和卸载。

最后吐槽一下，eclipse服务器的下载速度都在10kb以下，安装一个更新大概需要半天时间。

我的问题是，我必须使用它，因为我正在使用的项目是用 Eclipse 存档的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T11:02:30.883

您是否按照此[安装页面](http://wiki.eclipse.org/PDT/Installation)上提供的步骤进行操作？有一个**来自更新站点**的部分，他们在其中描述了如何从“软件更新”菜单安装它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T11:03:14.453

我[最近遇到了这个问题](http://www.digital-utopia.com/blogs/graham.reeds/?p=207)。

我从 J2EE Ganymede 设置开始，然后添加了 PDT 工具（通过更新）。

然后我在之后添加了 Subclipse。

G。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T11:10:13.660

（*我希望他们不会一直更改 Eclipse 页面......*）
在 PDT 的下载页面上寻找“运行时”（[http://www.eclipse.org/pdt/downloads/](http://www.eclipse.org/pdt/downloads/)）

为什么要在一个安装中安装 JDT 和 PDT？我通常为不同的东西设置不同的安装。它就是这么简单，因为你真的不需要安装任何东西。我有两个 PDT 设置和至少 5 个 JDT 设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T11:18:21.567

安装**Aptana Studio**插件。根据我的经验，它比 PHPEclipse 或 PDT 要好得多。然而，YMMV。

# c++ - C++ 中的 size_t 和 int 有什么区别？

> ID：502856
> 
> 赞同：192
> 
> 时间：2009-02-02T11:03:54.047
> 
> 标签：c++, c, types, int

在几个 C++ 示例中，我看到了`size_t`我会使用简单`int`. 有什么区别，为什么`size_t`应该更好？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2009-02-02T11:07:04.150

来自[友好的维基百科](http://en.wikipedia.org/wiki/Size_t#Member_data_types)：

> stdlib.h 和 stddef.h 头文件定义了一个名为**size_t**的数据类型，用于表示对象的大小。采用大小的库函数期望它们的类型为 size_t，并且 sizeof 运算符的计算结果为 size_t。
> 
> size_t 的实际类型取决于平台；一个常见的错误是假设 size_t 与 unsigned int 相同，这可能导致编程错误，尤其是在 64 位体系结构变得越来越普遍的情况下。

另外，检查[为什么 size_t 很重要](http://www.embedded.com/electronics-blogs/programming-pointers/4026076/Why-size-t-matters)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-02T11:48:12.677

size_t 是用于表示大小的类型（顾名思义）。它依赖于平台（甚至可能是实现），并且应该仅用于此目的。显然，表示一个大小，size_t 是无符号的。许多 stdlib 函数，包括 malloc、sizeof 和各种字符串操作函数都使用 size_t 作为数据类型。

默认情况下对 int 进行签名，尽管它的大小也取决于平台，但在大多数现代机器上它将是固定的 32 位（尽管 size_t 在 64 位架构上是 64 位，但 int 在这些架构上保持 32 位长）。

总结一下：在其他情况下使用 size_t 表示对象的大小和 int （或 long ）。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-10-16T06:52:11.473

该`size_t`类型被定义为`sizeof`运算符的无符号整数类型。在现实世界中，您经常会看到`int`定义为 32 位（为了向后兼容），但`size_t`在 64 位平台上定义为 64 位（因此您可以声明大小超过 4 GiB 的数组和结构）。如果 a`long int`也是 64 位，这称为 LP64 约定；如果`long int`是 32 位，但`long long int`指针是 64 位，那就是 LLP64。您也可能得到相反的结果，该程序使用 64 位指令来提高速度，但使用 32 位指针来节省内存。此外，`int`已签名和`size_t`未签名。

从历史上看，还有许多其他平台的地址比`int`. 事实上，在 70 年代和 80 年代初期，这种情况比较普遍：所有流行的 8 位微机都有 8 位寄存器和 16 位地址，而 16 位和 32 位之间的转换也产生了许多机器地址比他们的寄存器更宽。我偶尔还会在这里看到有关用于 MS-DOS 的 Borland Turbo C 的问题，它的巨大内存模式在 16 位 CPU 上以 32 位存储 20 位地址（但它可以支持 80386 的 32 位指令集）；摩托罗拉 68000 有一个 16 位 ALU，带有 32 位寄存器和地址；有 15 位、24 位或 31 位地址的 IBM 大型机。您还可以在嵌入式系统中看到不同的 ALU 和地址总线大小。

Any time `int` is smaller than `size_t`, and you try to store the size or offset of a very large file or object in an `unsigned int`, there is the possibility that it could overflow and cause a bug. With an `int`, there is also the possibility of getting a negative number. If an `int` or `unsigned int` is wider, the program will run correctly but waste memory.

You should generally use the correct type for the purpose if you want portability. A lot of people will recommend that you use signed math instead of unsigned (to avoid nasty, subtle bugs like `1U < -3`). For that purpose, the standard library defines `ptrdiff_t` in `<stddef.h>` as the signed type of the result of subtracting a pointer from another.

That said, a workaround might be to bounds-check all addresses and offsets against `INT_MAX` and either `0` or `INT_MIN` as appropriate, and turn on the compiler warnings about comparing signed and unsigned quantities in case you miss any. You should always, always, always be checking your array accesses for overflow in C anyway.

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-02T11:06:29.563

这是因为 size_t 可以是除 int 以外的任何东西（可能是结构）。这个想法是将其工作与底层类型分离。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-05-24T16:27:26.090

的定义`SIZE_T`位于： [https](https://msdn.microsoft.com/en-us/library/cc441980.aspx) ://msdn.microsoft.com/en-us/library/cc441980.aspx和[https://msdn.microsoft.com/en-us/library/cc230394.aspx](https://msdn.microsoft.com/en-us/library/cc230394.aspx)

**在此处粘贴所需的信息：**

`SIZE_T`是`ULONG_PTR`表示指针可以指向的最大字节数。

该类型声明如下：

```
typedef ULONG_PTR SIZE_T; 
```

A`ULONG_PTR`是用于指针精度的无符号长类型。在将指针转换为 long 类型以执行指针运算时使用它。

该类型声明如下：

```
typedef unsigned __int3264 ULONG_PTR; 
```

# xml - 使用 CDATA 存储原始二进制流？

> ID：502857
> 
> 赞同：7
> 
> 时间：2009-02-02T11:03:59.880
> 
> 标签：xml, binary, base64, cdata

我想知道您是否可以直接将双字节二进制流存储到 XML 文件中，使用 CDATA 或将其注释掉，而不是[将二进制文件保存为 Base64](https://stackoverflow.com/questions/502814/storing-base64-data-in-xml)的开销？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-02T11:07:14.447

Nul 字符（C 中的 '\0' ）在 XML 中的任何地方都无效，即使作为转义符（ & #0; ）也是如此。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-07-05T09:35:35.127

不，您不能单独使用 CDATA 在 XML 文件中注入二进制数据。

在 XML1.0 中（因为 XML 1.1 更宽松，但不是关于控制字符），以下限制适用于 CDATA 字符：

```
CData      ::=      (Char* - (Char* ']]>' Char*)) 
Char       ::=      #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF] 
```

这意味着有几个字符是非法的，其中包括：

*   非法 XML 控制字符 0x00 到 0x20，换行符、回车符和制表符除外
*   非法 UTF-8 序列，如 0xFF 或非规范 0b1100000x 0b10xxxxxx

除此之外，在没有 CDATA 的标准实体内容中：

*   “<”和“>”的使用是非法的
*   “&”的使用受到限制（`&eacute;`可以，`&zajdalkdza;`不是）

因此，CDATA 只是一种允许“<”、“>”和“&”的方式，而是通过限制“]]>”。它没有解决主要问题的非法 XML、Unicode 和 UTF-8 字符问题。

解决方案：

1.  使用**[Base64](https://stackoverflow.com/questions/19893/how-do-you-embed-binary-data-in-xml)**，开销为 33%，但对所有编程语言都有很大的支持，而且它是一种标准
2.  使用**[BaseXML](https://stackoverflow.com/a/17478683/2227298)**的实现仍然有限，但只有 20% 的开销
3.  尽可能不要在 XML 中编码二进制数据，单独传输

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T11:27:48.257

XML 是一种纯文本格式——不要用它来存储二进制数据。将二进制 blob 放在单独的文件中，并向引用这些文件的 XML 添加一个元素。如果要将所有二进制 blob 存储在单个文件中，请添加偏移属性或类似的东西...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-02T11:09:23.927

您可以将其存储为 CDATA，但存在某些字节序列将评估为关闭 CDATA 部分的有效 XML 的风险。快速浏览[http://www.w3.org/TR/2006/REC-xml-20060816/#sec-cdata-sect](http://www.w3.org/TR/2006/REC-xml-20060816/#sec-cdata-sect)后，您似乎可以使用除“]]>”之外的任何字符序列。看看[什么是有效的 XML 字符](http://www.w3.org/TR/2006/REC-xml-20060816/#NT-Char)。

# crystal-reports - 水晶报表挂起

> ID：502860
> 
> 赞同：2
> 
> 时间：2009-02-02T11:06:22.310
> 
> 标签：crystal-reports, .net-2.0, iis-6

该公司最近实施了不是我们编写的软件。该软件使用水晶报表，每当有人绘制一个特别大的报表并在报表加载完成之前关闭他们的浏览器，我们就无法再绘制报表了。修复它的唯一方法是重置 iis，这显然是非常糟糕的做法。

关于如何克服这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-20T16:23:01.727

因此，如果一个人过早地关闭了浏览器，那么该应用程序会为所有人中断吗？两个人可以尝试一次加载这些长期运行的报告之一吗？是否有多个模板，而这只破坏了一个而其他的都可以吗？

听起来有点像水晶应用程序的实现对原始模板持有独占锁，因此当用户过早退出时，应用程序不会释放模板供其他用户使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T16:13:39.773

如果它是从中提取数据的 SQL 服务器，则可以终止 SQL 服务器上的 SPID，这可能会使 CR 进程更优雅地退出；如果您使用的是 IIS6，则可以将工作进程配置为在固定数量的请求或时间范围后自动循环。创建多个工作进程也可能有所帮助。

我想知道为什么它会挂起，如果您等待足够长的时间让先前的查询和当前的查询完成，它会成功吗？

找到一种方法来加快查询速度也是一个好主意；或者让大型报告在非工作时间运行并交付给用户。

# php - PHP Exchange 2007 服务器 SMTP、NTLM 身份验证领域

> ID：502863
> 
> 赞同：3
> 
> 时间：2009-02-02T11:07:10.640
> 
> 标签：php, smtp, exchange-server, ntlm

我正在尝试通过连接到 sherweb.com 上的托管 Exchange 设置。PHP 使用带有 NTLM 身份验证的 SMTP。连接时，我需要进入 NTLM 身份验证领域。

我从 PHP 脚本收到以下错误，“未定义请求的凭据工作站”我正在使用 phpclasses.org 中的 SMTP 类和 SASL 类进行 NTLM 身份验证。

如何找到 NTLM 身份验证领域？技术。在 sherweb.com 上的支持就像与一堵砖墙交谈，如果不在他们的知识库中，那么他们就毫无头绪。

**更新**

我知道我可以使用 Exchange 2007 Web 服务，但是我尝试了一些示例代码，似乎 Exchange WDSL 有错误。本质上，如果可能的话，我更喜欢使用 SMTP。NTLM 身份验证。

# c# - 分析一个 ASP.NET webservice 的使用

> ID：502877
> 
> 赞同：2
> 
> 时间：2009-02-02T11:12:10.253
> 
> 标签：c#, .net, web-services

很久以前，我编写了仍在使用的 web 服务。现在我打算重构它。该网络服务充满了最有可能未使用的功能，我不知道客户如何使用它。为了剥离未使用的函数，我需要分析当前安装的 web 服务的函数调用和数据。

是否有（免费/开源）工具可以让我记录网络服务的所有活动。

我正在寻找的工具的理想输出可能是一个包含所有调用函数的数据库以及每次调用发送给它的数据列表。

### 解决方案

在 Martins 回答的帮助下，我创建了这个 HttpModule，它完全符合我的要求：

```
public class LoggingModule : IHttpModule
{
    void IHttpModule.Init(HttpApplication context)
    {
        context.BeginRequest += new EventHandler(BeginRequest);
    }

    private void BeginRequest(object sender, EventArgs e)
    {   
        TryAppendLog("Content-Type");
        TryAppendLog("SOAPAction");
    }

    void TryAppendLog(string key)
    {
        string value = HttpContext.Current.Request.Headers[key];
        if (string.IsNullOrEmpty(value)) { return; }            
        HttpContext.Current.Response
            .AppendToLog(string.Format("{0}: {1} ", key, value));           
    }

    #region IHttpModule Member
    public void Dispose() { }
    #endregion
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T11:29:57.007

正如 Kobi 所写，您可以在 IIS 日志文件中找到所需的信息（即在 c:\WINDOWS\system32\LogFiles\W3SVC1 中）。

如果您想将使用情况记录到数据库中，您可以编写一个简单的 HttpModule，它会检查每个请求，如果它是对您的 Web 服务的调用，则将其记录到数据库中。例如，这是一个非常简单的 HttpModule 的相关部分，它记录对 mywebservice.asmx 的调用：

```
public class MyWebServiceDiagnosticsModule : IHttpModule
{
    public MyWebServiceDiagnosticsModule ()
    {
    }
    void IHttpModule.Init(HttpApplication context)
    {
        context.BeginRequest += new EventHandler(BeginRequest);
    }
    private void BeginRequest(object sender, EventArgs e)
    {
        HttpContext ctx = HttpContext.Current;
        string url = ctx.Request.Url.ToString().ToLower();
        if (url.Contains("mywebservice.asmx"))
        {
            LogMethodCall(url); // parse URL and write to DB
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T11:18:21.053

您可以编写自己的 IHttpHandler 来记录所有信息，然后将调用委托给适当的 .NET HTTP 处理程序，但这不是一项简单的任务。

还有一个关于术语的词。“重构”并不是要改变外部行为，所以如果重构确实是您的目标，我建议保持 Web 服务的公共合同（接口）完好无损。相反，推出仅具有核心功能的同一服务的新版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T11:19:06.887

您可以在 IIS 中启用日志记录，它们可以根据您的选择获得非常详细的信息。
有专门用于分析 IIS 日志的工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T11:27:29.553

根据您的负载/关键性和类似的限制，您也可能只是通过 Soap 代理（如[SoapUI](http://www.soapui.org/) ）路由流量，以在一段时间内捕获和分析流量。如果您在防火墙级别设置代理并重新路由，则它对最终用户应该是透明的。

对于负载较重的系统，我还*没有尝试过。*被警告。

# c++ - 如何在 Windows 平台上从原生 C++ 处理 SQL Server？

> ID：502882
> 
> 赞同：0
> 
> 时间：2009-02-02T11:15:39.030
> 
> 标签：c++, sql-server, database

除了丑陋的 ADO 之外，还有其他解决方案，因为它不好且记录不充分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T14:21:48.873

In the past, we used the DTL library and were relatively happy with it.

SOCI looks like something deserving attention too. I never used it, though.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T11:47:58.187

You could use the sqlncli.dll library, but is a ugly method.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T17:50:45.363

试一试我的[CSQLBinding](http://networkdls.com/Software.Asp?Review=70)类。它为您处理大部分事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T11:27:17.433

您可能想看看 Qt 工具包，它提供了一个 SQL 接口，可以与不同的数据库后端（包括通过 ODBC 的 MS-SQL）进行通信。

[QSql](http://doc.trolltech.com/4.4/qtsql.html)

[支持的驱动程序](http://doc.trolltech.com/4.4/sql-driver.html)

干杯，米奇

# gnu - 如何更改 GNU Screen 中的“[remote detached]”消息

> ID：502894
> 
> 赞同：1
> 
> 时间：2009-02-02T11:25:53.020
> 
> 标签：gnu, gnu-screen, detach

当我远程分离屏幕会话并自己连接到它时（screen -r -d），我在分离的会话中看到以下内容。

`[remote detached]`

是否可以更改此消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T11:51:54.417

它在屏幕源代码中硬编码（行：屏幕 v 4.0.3 中的）`1745`：`screen.c`

```
#ifdef REMOTE_DETACH
    case D_REMOTE:
      AddStr("[remote detached]\r\n");
      sign = SIG_BYE;
      break;
#endif 
```

您可以尝试编辑该部分并重新编译源代码。

# visual-studio - Visual Studio 设置和部署：添加先决条件

> ID：502896
> 
> 赞同：5
> 
> 时间：2009-02-02T11:27:24.810
> 
> 标签：visual-studio, visual-studio-2008, setup-deployment, prerequisites

如何添加到我希望客户端具有更多组件的设置和部署项目中，例如：

```
Microsoft Chart Controls
Microsoft SQL 2008 Express Edition (not 2005) 
```

ETC...

[替代文字 http://img55.imageshack.us/img55/2586/200902021225eu9.png](http://img55.imageshack.us/img55/2586/200902021225eu9.png)

此选项不在 VS 2008 中，并且在窗口（上图）中它只有一个指向“[检查 Microsoft 更新以获取更多可再发行组件](http://msdn.microsoft.com/en-us/vstudio/bb898654.aspx)”的链接，但它转到带有 2 个“引导程序包”的页面（我什至不知道这是什么）

关于如何将其添加到项目中而不是要求用户手动安装的任何想法？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T03:30:13.880

看看文章

[为 Visual Studio 2005 创作自定义引导程序包](http://msdn.microsoft.com/en-us/library/aa730839(VS.80).aspx)

如果您找到文件夹 C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages (VS 2005)，或者对于 VS 2008，C:\Program Files\Microsoft SDKs\Windows\v6.0A\引导程序\包

“包”下的每个文件夹都是您在列表中看到的先决条件，如屏幕截图所示。

因此，如果您想添加一个名为 MyPrereq 的应用程序作为先决条件，您需要在“Packages”下创建自己的文件夹“MyPrereq”。然后你制作一个与此类似的 product.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<Product ProductCode="MyPrereq" xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper">
  <PackageFiles CopyAllPackageFiles="false">
    <PackageFile Name="MyPrereq.exe" />
  </PackageFiles>
  <InstallChecks>
  </InstallChecks>
  <Commands Reboot="None">
    <Command PackageFile="MyPrereq.exe" EstimatedInstallSeconds="90">
      <InstallConditions>
      </InstallConditions>
      <ExitCodes>
    <ExitCode Value="0" Result="Success"/>
        <DefaultExitCode Result="Fail" String="GeneralFailure" FormatMessageFromSystem="true" />
      </ExitCodes>
    </Command>
  </Commands>
</Product> 
```

和你的 package.xml 文件与此类似

```
<?xml version="1.0" encoding="utf-8"?>
<Package Name="MyPrereq" Culture="Culture" xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper">
  <Strings>
    <String Name="Culture">en</String>
    <String Name="DisplayName">MyPrereq</String>
    <String Name="GeneralFailure">A fatal error occurred. The installation failed.</String>
  </Strings>
</Package> 
```

并将这些文件和您的安装程序包 (MyPrereq.exe) 放在文件夹中。检查现有包作为示例，以查看放置文件的位置。

如果您正确执行所有操作，您将能够在“选择要安装的先决条件”列表中看到您的 MyPrereq 选项。

# hibernate - Hibernate 在运行时更改获取模式

> ID：502898
> 
> 赞同：6
> 
> 时间：2009-02-02T11:27:30.473
> 
> 标签：hibernate, mapping

我有两个使用一对多关系关联在一起的表：员工->部门：以及通过员工表中的部门ID的关系。

我使用休眠：我的休眠映射文件是：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
                                   "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping default-lazy="false">
 <class catalog="moi"
  name="com.ebla.moi.correspondence.model.entity.user.User" table="user">
  <id name="id" type="java.lang.Long">
   <column name="id"/>
   <generator class="identity"/>
  </id>
  <many-to-one
   class="com.ebla.moi.correspondence.model.entity.department.Department"
   fetch="select" name="department">
   <column name="department_id"/>
  </many-to-one>
  <property generated="never" lazy="false" name="name" type="java.lang.String">
   <column length="128" name="name" not-null="true"/>
  </property>
  <property generated="never" lazy="false" name="email" type="java.lang.String">
   <column length="128" name="email" not-null="true" unique="true"/>
  </property>
  <property generated="never" lazy="false" name="maritalStatus" type="java.lang.Short">
   <column name="marital_status" not-null="true"/>
  </property>
  <property generated="never" lazy="false" name="hireDate" type="java.lang.String">
   <column length="64" name="hire_date"/>
  </property>
 </class>
</hibernate-mapping> 
```

第二个映射文件是：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
                                   "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping default-lazy="false">
 <class catalog="moi"
  name="com.ebla.moi.correspondence.model.entity.department.Department" table="department">
  <id name="id" type="java.lang.Long">
   <column name="id"/>
   <generator class="identity"/>
  </id>
  <property generated="never" lazy="false" name="name" type="java.lang.String">
   <column length="256" name="name" unique="true"/>
  </property>
  <set inverse="true" name="users" sort="unsorted">
   <key>
    <column name="department_id"/>
   </key>
   <one-to-many class="com.ebla.moi.correspondence.model.entity.user.User"/>
  </set>
 </class>
</hibernate-mapping> 
```

我的问题是：有时我需要获取员工和他的部门，而其他时候我只需要没有部门信息的员工信息.....同样的事情与部门和员工....使用上面的映射文件如果我需要员工，休眠会带来部门及其用户......如何定义我的休眠需求以获取我需要的东西......

谢谢你

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-02T11:44:35.523

您可以将关系映射为“惰性”并编写两个查询来获取数据：

*   获取数据的常用简单查询（“惰性”）。例如“从员工 e 中选择 e ...”

*   使用“fetch join”来强制 Hibernate 获取“childs”的相同查询。例如“select e from Employee left join fetch e.department where ...”

律师事务所，安德里亚

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-02T11:52:04.963

You can use ICriteria to fetch your Employee.

You can use the SetFetchMode method of the ICriteria to determine whether the Department should be fetched, or not:

This will make sure that the Department is not fetched:

```
ICriteria crit = theSession.CreateCriteria (typeof(Employee));
crit.SetFetchMode ("Department", FetchMode.Lazy) 
```

With this code, the department will be fetched.

```
ICriteria crit = theSession.CreateCriteria (typeof(Employee));
crit.SetFetchMode ("Department", FetchMode.Join) 
```

Some say that it is best-practice to use the default fetchmode in the mappings (which would be lazy, i guess), and specify the fetch-mode in every specific scenario. (That is, in your repositories).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T12:21:29.053

One way of doing this is to have two classes representing an employee:

*   `Employee` which has department information mapped through;
*   `EmployeeSummary` which only has the employee data itself.

Both classes then have independent bindings onto the `employee` table, but only `Employee` also has the relationship onto `department` defined.

Then when you need all the information you load `Employee` instances, and when you just need employee information you load `EmployeeSummary` instances.

You can remove any duplication of ORM bindings and business logic by introducing a common superclass like `AbstractEmployee` to both of the employee classes.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T05:41:15.613

我认为您正在寻找的是[fetch profiles](http://blog.frankel.ch/hibernate-hard-facts-part-6) 。也看看这个例子：[http ://arjan-tijms.omnifaces.org/2012/04/fetching-arbitrary-object-graphs-in-jpa.html](http://arjan-tijms.omnifaces.org/2012/04/fetching-arbitrary-object-graphs-in-jpa.html)

# xml - Flash - 更改 CDATA 结束字符？

> ID：502899
> 
> 赞同：0
> 
> 时间：2009-02-02T11:27:37.120
> 
> 标签：xml, flash, actionscript, cdata

由于我想将原始二进制流存储在 XML 文件的 CDATA 部分中，因此 3 个字符的 CDEnd 代码可能会错误地匹配我的二进制文件。

有什么方法可以更改 Flash 的 CDEnd 代码？我想要它 10 字符只是为了可靠性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T11:48:30.743

我不认为这是可能的。也许[base64](http://en.wikipedia.org/wiki/Base64)编码二进制而不是？

# c++ - Visual Studio 2008 中的 axxdsp.h

> ID：502902
> 
> 赞同：0
> 
> 时间：2009-02-02T11:29:23.137
> 
> 标签：c++

我有一个在 VS 2005 中正确构建的 dll。该 dll 包括默认位置 (C:\Program Files\Microsoft Visual Studio 8\VC\atlmfc\include) 中的“afxdisp.h”头文件。

// 一段代码

# ifndef _AFX_NO_OLE_SUPPORT

#include “afxdisp.h”

# 万一

// 结束

在 Visual Studio 2008 中没有构建相同的 dll。它给出了很多编译时错误，说许多变量未定义。

Visual Studio 2008 中是否还有其他等效的 afxdisp.h 。

PS：我使用在 afxdisp.h (VS 2005) 中定义的类 COleVariant。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T16:11:18.630

My guess would that one of your VS installations is using some version of the Windows Platform SDK ([http://msdn.microsoft.com/en-us/windows/bb980924.aspx](http://msdn.microsoft.com/en-us/windows/bb980924.aspx)) which comes with its own version of ATL (ATL 7) and that your code either depends on that or depends on the older ATL 3\.

Compare the standard include paths in the preferences of both VS installations (i.e. not the project-specific include paths).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T21:57:12.117

该文件在 Visual Studio 2008 中仍然存在。检查以确保您的包含路径正确。确保它们指向您的 Visual Studio 2008 目录。也许如果您在项目中包含前几个错误/警告，我可以进一步帮助您。

# c# - C# int 到 enum 的转换

> ID：502905
> 
> 赞同：74
> 
> 时间：2009-02-02T11:30:14.010
> 
> 标签：c#, enums

> **可能重复：**
> [在 C# 中将 int 转换为枚举](https://stackoverflow.com/questions/29482/cast-int-to-enum-in-c-sharp)

如果我有以下代码：

```
enum foo : int
{
    option1 = 1,
    option2,
    ...
}

private foo convertIntToFoo(int value)
{
    // Convert int to respective Foo value or throw exception
} 
```

转换代码会是什么样子？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-02-02T14:04:54.820

只需将您的 int 转换为 Foo 就可以了：

```
int i = 1;
Foo f = (Foo)i; 
```

如果您尝试强制转换未定义的值，它仍然可以工作。这可能带来的唯一危害是您以后如何使用该值。

如果你真的想确保你的值是在枚举中定义的，你可以使用 Enum.IsDefined：

```
int i = 1;
if (Enum.IsDefined(typeof(Foo), i))
{
    Foo f = (Foo)i;
}
else
{
   // Throw exception, etc.
} 
```

但是，使用 IsDefined 的成本不仅仅是强制转换。您使用哪个取决于您的实现。您可能会考虑限制用户输入，或在使用枚举时处理默认情况。

另请注意，您不必指定枚举从 int 继承；这是默认行为。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-02T11:32:15.533

我很确定您可以在这里进行显式转换。

```
foo f = (foo)value; 
```

只要您说枚举从 int 继承（？），就可以了。

```
enum foo : int 
```

**编辑**是的，事实证明，默认情况下，枚举基础类型是 int。但是，您可以使用除 char 之外的任何整数类型。

您还可以从不在枚举中的值进行强制转换，从而产生无效的枚举。我怀疑这只是通过更改引用的类型而不是实际更改内存中的值来实现。

[enum（C# 参考）](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)
[枚举类型（C# 编程指南）](http://msdn.microsoft.com/en-us/library/cc138362.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-02T12:13:04.517

铸造应该足够了。如果您使用的是 C# 3.0，您可以制作一个方便的扩展方法来解析枚举值：

```
public static TEnum ToEnum<TInput, TEnum>(this TInput value)
{
    Type type = typeof(TEnum);

    if (value == default(TInput))
    {
        throw new ArgumentException("Value is null or empty.", "value");
    }

    if (!type.IsEnum)
    {
        throw new ArgumentException("Enum expected.", "TEnum");
    }

    return (TEnum)Enum.Parse(type, value.ToString(), true);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-02T11:47:00.763

```
if (Enum.IsDefined(typeof(foo), value))
{
   return (Foo)Enum.Parse(typeof(foo), value);
} 
```

希望这可以帮助

**编辑** 在我的示例中，这个答案被否决了，因为值是一个字符串，而问题要求一个 int。我的申请；以下应该更清楚:-)

```
Type fooType = typeof(foo);

if (Enum.IsDefined(fooType , value.ToString()))
{
   return (Foo)Enum.Parse(fooType , value.ToString());
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-02T11:38:26.037

你不需要继承。你可以做：

```
(Foo)1 
```

它会起作用的；）

# xml - 为什么 xslt 创建一个新表但不使用模板之一

> ID：502913
> 
> 赞同：0
> 
> 时间：2009-02-02T11:33:18.887
> 
> 标签：xml, xslt

我有一个这样的xml文件

```
<Root>
 ...
 <x></x>
 <node>
  ...
  <x></x>
  <y></y>
 </node>
</Root> 
```

我的 xslt 是

```
<xsl:template match="/">
 <!-- proceed the treatment of the statement before x-->
 <tr>
  <xsl:apply-templates match="Root/x"/>
 </tr>
 <tr>
  <xsl:apply-templates match="Root"/>
 </tr>
</xsl:template>

<xsl:template match="x">
  ...
</xsl:template match="x">

<xsl:template match="Root">
 <!--Proceed the treatment of the statement before x-->
 <tr>
  <xsl:apply-templates match="x"/>
 </tr>
 <!--Deal with y--> 
```

匹配“/”的模板将创建一个表并用 xml 文件中的所有节点填充它。x 可以出现在像“节点”这样的每个元素中，并且每次都可能不同。“节点”也可以出现多次，内容不同。

但是当我使用这个 xslt 时，在处理完 x 之后，它会为 x 之后的元素创建一个新表，因此节点将在一个新表中，也为 y。

有谁知道该怎么做？感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T14:39:18.527

It looks like you are processing stuff in your "/" template, then processing it all again in the "Root" template, since the "/" template explicitly applies the Root template as well.

Try deleting the definition of the "/" template and just doing all the work in the template for "Root"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T12:54:09.893

To divo,

match="x" template deals with the child elements of "x". Sorry for making you misunderstand, i just ignored the code for creating the table. The table is created in the match="/" template. Thanks

# yahoo-boss-api - 如何在 Yahoo BOSS 上获得更好的建议（拼写）？

> ID：502915
> 
> 赞同：3
> 
> 时间：2009-02-02T11:35:05.060
> 
> 标签：yahoo-boss-api

我一直在使用雅虎 BOSS 很短的时间。这是一个简单的搜索 API，但拼写建议支持确实不是那么强大。这里的人有什么想法可以在 BOSS 上获得更好的拼写建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-18T00:55:45.577

不幸的是，即使在几年后，Yahoo BOSS API 上的拼写建议还是非常基本的，并没有那么有用:(

我将来自 BOSS API 的单个单词查询的结果与您在 Google 中看到的结果（您的意思是 ____？）进行了比较，其中包含 100 个随机英文单词，其中包含计算机生成的拼写错误。谷歌 98% 的时间都猜对了。雅虎只有 2%。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-13T16:26:43.490

由于您最初提出问题，因此他们似乎添加了“拼写服务”。

[http://developer.yahoo.com/boss/search/boss_api_guide/Spelling_Suggest.html](http://developer.yahoo.com/boss/search/boss_api_guide/Spelling_Suggest.html)

看看它是否能完成你想要达到的目标。

# python - Django：如何动态创建模型仅用于测试

> ID：502916
> 
> 赞同：69
> 
> 时间：2009-02-02T11:35:52.657
> 
> 标签：python, django, unit-testing, django-models, mocking

我有一个 Django 应用程序，它需要`settings`以下形式的属性：

```
RELATED_MODELS = ('appname1.modelname1.attribute1',
                  'appname1.modelname2.attribute2', 
                  'appname2.modelname3.attribute3', ...) 
```

然后挂钩他们的 post_save 信号以根据`attributeN`定义更新一些其他固定模型。

我想测试这种行为，即使这个应用程序是项目中唯一的一个，测试也应该可以工作（除了它自己的依赖项，不需要安装其他包装应用程序）。如何仅为测试数据库创建和附加/注册/激活模拟模型？（或者有可能吗？）

允许我使用测试夹具的解决方案会很棒。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-02T14:49:31.953

您可以将测试放在`tests/`应用程序的子目录（而不是`tests.py`文件）中，并将 a`tests/models.py`包含在仅测试模型中。

然后提供一个测试运行脚本（[示例](https://github.com/carljm/django-model-utils/blob/master/runtests.py)），其中包含您的`tests/`“应用程序” `INSTALLED_APPS`。（这在从实际项目中运行应用程序测试时不起作用，其中没有测试应用程序`INSTALLED_APPS`，但我很少发现从项目中运行可重用的应用程序测试很有用，并且 Django 1.6+ 默认情况下不会。 )

（**注意**：下面描述的替代动态方法仅适用于 Django 1.1+，如果您的测试用例子类`TransactionTestCase`- 这会显着减慢您的测试 - 并且在 Django 1.7+ 中根本不再适用。它仅出于历史兴趣而留在这里；不要用它。）

在测试开始时（即在 setUp 方法中，或在一组 doctests 开始时），您可以动态添加`"myapp.tests"`到 INSTALLED_APPS 设置，然后执行以下操作：

```
from django.core.management import call_command
from django.db.models import loading
loading.cache.loaded = False
call_command('syncdb', verbosity=0) 
```

然后在测试结束时，您应该通过恢复旧版本的 INSTALLED_APPS 并再次清除应用缓存来进行清理。

[此类](http://www.djangosnippets.org/snippets/1011/)封装了该模式，因此它不会使您的测试代码非常混乱。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-04-20T04:00:49.257

@paluh 的答案需要将不需要的代码添加到非测试文件中，根据我的经验，@carl 的解决方案不适`django.test.TestCase`用于使用固定装置所需的解决方案。如果要使用`django.test.TestCase`，则需要确保`syncdb`在加载固定装置之前调用。这需要重写`_pre_setup`方法（将代码放在`setUp`方法中是不够的）。我使用我自己的版本`TestCase`让我可以添加带有测试模型的应用程序。定义如下：

```
from django.conf import settings
from django.core.management import call_command
from django.db.models import loading
from django import test

class TestCase(test.TestCase):
    apps = ()

    def _pre_setup(self):
        # Add the models to the db.
        self._original_installed_apps = list(settings.INSTALLED_APPS)
        for app in self.apps:
            settings.INSTALLED_APPS.append(app)
        loading.cache.loaded = False
        call_command('syncdb', interactive=False, verbosity=0)
        # Call the original method that does the fixtures etc.
        super(TestCase, self)._pre_setup()

    def _post_teardown(self):
        # Call the original method.
        super(TestCase, self)._post_teardown()
        # Restore the settings.
        settings.INSTALLED_APPS = self._original_installed_apps
        loading.cache.loaded = False 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-09-28T14:17:53.437

我分享了我在项目中使用的[解决方案](https://github.com/erm0l0v/django-fake-model)。也许它可以帮助某人。

`pip install django-fake-model`

创建假模型的两个简单步骤：

1）在任何文件中定义模型（我通常在测试用例附近的测试文件中定义模型）

```
from django_fake_model import models as f

class MyFakeModel(f.FakeModel):

    name = models.CharField(max_length=100) 
```

2）将装饰器添加`@MyFakeModel.fake_me`到您的*TestCase*或测试功能。

```
class MyTest(TestCase):

    @MyFakeModel.fake_me
    def test_create_model(self):
        MyFakeModel.objects.create(name='123')
        model = MyFakeModel.objects.get(name='123')
        self.assertEqual(model.name, '123') 
```

该装饰器在每次测试之前在您的数据库中创建表，并在测试后删除该表。

您也可以手动*创建*/*删除*`MyFakeModel.create_table()`表： /`MyFakeModel.delete_table()`

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-12-01T16:24:59.860

`django`此解决方案仅适用于(before `1.7`)的早期版本。您可以轻松检查您的版本：

```
import django
django.VERSION < (1, 7) 
```

原始回复：

这很奇怪，但我的工作方式非常简单：

1.  将 tests.py 添加到您要测试的应用程序中，
2.  在这个文件中只定义测试模型，
3.  下面放置您的测试代码（doctest 或 TestCase 定义），

下面我放了一些代码，它定义了仅用于测试的 Article 模型（它存在于 someapp/tests.py 中，我可以使用以下命令对其进行测试：*./manage.py test someapp*）：

```
class Article(models.Model):
    title = models.CharField(max_length=128)
    description = models.TextField()
    document = DocumentTextField(template=lambda i: i.description)

    def __unicode__(self):
        return self.title

__test__ = {"doctest": """
#smuggling model for tests
>>> from .tests import Article

#testing data
>>> by_two = Article.objects.create(title="divisible by two", description="two four six eight")
>>> by_three = Article.objects.create(title="divisible by three", description="three six nine")
>>> by_four = Article.objects.create(title="divisible by four", description="four four eight")

>>> Article.objects.all().search(document='four')
[<Article: divisible by two>, <Article: divisible by four>]
>>> Article.objects.all().search(document='three')
[<Article: divisible by three>]
"""} 
```

单元测试也适用于此类模型定义。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-01-20T13:08:48.687

我已经找到了一种用于 django 1.7+ 的仅测试模型的方法。

基本思想是，制作`tests`一个应用程序，然后将您的应用程序添加`tests`到`INSTALLED_APPS`.

这是一个例子：

```
$ ls common
__init__.py   admin.py      apps.py       fixtures      models.py     pagination.py tests         validators.py views.py

$ ls common/tests
__init__.py        apps.py            models.py          serializers.py     test_filter.py     test_pagination.py test_validators.py views.py 
```

而且我有不同`settings`的用途（参考：[拆分设置文件](https://code.djangoproject.com/wiki/SplitSettings#Accessingandmodifyingexistingsettings)），即：

*   `settings/default.py`：基本设置文件
*   `settings/production.py`: 用于生产
*   `settings/development.py`: 开发
*   `settings/testing.py`： 供测试用。

在 中`settings/testing.py`，您可以修改`INSTALLED_APPS`：

`settings/testing.py`：

```
from default import *

DEBUG = True

INSTALLED_APPS += ['common', 'common.tests'] 
```

并确保您为测试应用程序设置了正确的标签，即，

`common/tests/apps.py`

```
from django.apps import AppConfig

class CommonTestsConfig(AppConfig):
    name = 'common.tests'
    label = 'common_tests' 
```

`common/tests/__init__.py`，设置正确`AppConfig`（参考：[Django Applications](https://docs.djangoproject.com/en/1.9/ref/applications/)）。

```
default_app_config = 'common.tests.apps.CommonTestsConfig' 
```

然后，生成数据库迁移

```
python manage.py makemigrations --settings=<your_project_name>.settings.testing tests 
```

最后，您可以使用 param 运行测试`--settings=<your_project_name>.settings.testing`。

如果您使用 py.test，您甚至可以将`pytest.ini`文件与 django 的`manage.py`.

`py.test`

```
[pytest]
DJANGO_SETTINGS_MODULE=kungfu.settings.testing 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-01-03T22:10:32.480

我选择了一种稍微不同但更耦合的方法来动态创建模型，仅用于测试。

我将所有测试保存`tests`在我的应用程序中的一个子目录中`files`。子目录中的`models.py`文件包含我的仅测试模型。`tests`耦合部分在这里，我需要将以下内容添加到我的`settings.py`文件中：

```
# check if we are testing right now
TESTING = 'test' in sys.argv

if TESTING:
    # add test packages that have models
    INSTALLED_APPS += ['files.tests',] 
```

我还在我的测试模型中设置了 db_table ，否则 Django 会创建名为 的表`tests_<model_name>`，这可能会导致与另一个应用程序中的其他测试模型发生冲突。这是我的测试模型：

```
class Recipe(models.Model):

    '''Test-only model to test out thumbnail registration.'''

    dish_image = models.ImageField(upload_to='recipes/')

    class Meta:
        db_table = 'files_tests_recipe' 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-03-17T12:34:18.393

引用[相关答案](https://stackoverflow.com/a/6960879/2179211)：

> 如果您只想为测试定义模型，那么您应该查看 [Django 票 #7835](https://code.djangoproject.com/ticket/7835)，特别是[评论 #24](https://code.djangoproject.com/ticket/7835#comment:24)，其中部分如下：
> 
> > 显然，您可以直接在您的 tests.py 中简单地定义模型。Syncdb 从不导入 tests.py，因此这些模型不会同步到普通数据库，但它们会同步到测试数据库，并且可以在测试中使用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-04-18T21:55:11.757

这是我用来执行此操作的模式。

我已经编写了在 TestCase 的子类版本上使用的这个方法。它是这样的：

```
@classmethod
def create_models_from_app(cls, app_name):
    """
    Manually create Models (used only for testing) from the specified string app name.
    Models are loaded from the module "<app_name>.models"
    """
    from django.db import connection, DatabaseError
    from django.db.models.loading import load_app

    app = load_app(app_name)
    from django.core.management import sql
    from django.core.management.color import no_style
    sql = sql.sql_create(app, no_style(), connection)
    cursor = connection.cursor()
    for statement in sql:
        try:
            cursor.execute(statement)
        except DatabaseError, excn:
            logger.debug(excn.message)
            pass 
```

然后，我创建了一个特殊的特定于测试的 models.py 文件，该文件`myapp/tests/models.py`不包含在 INSTALLED_APPS 中。

在我的 setUp 方法中，我调用 create_models_from_app('myapp.tests') 并创建正确的表。

这种方法的唯一“陷阱”是您真的不想在每次`setUp`运行时创建模型，这就是我捕获 DatabaseError 的原因。我想这个方法的调用可以放在测试文件的顶部，这样会更好一些。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-05-18T18:13:06.933

结合你的答案，特别是@slacy's，我这样做了：

```
class TestCase(test.TestCase):
    initiated = False

    @classmethod
    def setUpClass(cls, *args, **kwargs):
        if not TestCase.initiated:
            TestCase.create_models_from_app('myapp.tests')
            TestCase.initiated = True

        super(TestCase, cls).setUpClass(*args, **kwargs)

    @classmethod
    def create_models_from_app(cls, app_name):
        """
        Manually create Models (used only for testing) from the specified string app name.
        Models are loaded from the module "<app_name>.models"
        """
        from django.db import connection, DatabaseError
        from django.db.models.loading import load_app

        app = load_app(app_name)
        from django.core.management import sql
        from django.core.management.color import no_style
        sql = sql.sql_create(app, no_style(), connection)
        cursor = connection.cursor()
        for statement in sql:
            try:
                cursor.execute(statement)
            except DatabaseError, excn:
                logger.debug(excn.message) 
```

有了这个，您不会尝试多次创建数据库表，也不需要更改 INSTALLED_APPS。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-23T10:10:49.130

如果您正在编写一个可重用的 django-app，**请为它创建一个最小的测试专用应用程序**！

```
$ django-admin.py startproject test_myapp_project
$ django-admin.py startapp test_myapp 
```

将`myapp`和都添加`test_myapp`到 中`INSTALLED_APPS`，在那里创建您的模型，一切顺利！

我已经阅读了所有这些答案以及 django ticket [7835](https://code.djangoproject.com/ticket/7835)，最后我采用了一种完全不同的方法。我希望我的应用程序（以某种方式扩展 queryset.values() ）能够被单独测试；此外，我的包确实包含一些模型，我希望在测试模型和包模型之间有一个清晰的区别。

那时我意识到在包中添加一个非常小的 django 项目更容易！这也允许更清晰地分离代码恕我直言：

在那里你可以干净利落地定义你的模型，并且你知道当你从那里运行测试时它们会被创建！

如果您没有编写一个独立的、可重用的应用程序，您仍然可以这样：创建一个`test_myapp`应用程序，并将其添加到您的 INSTALLED_APPS 中，仅在一个单独的`settings_test_myapp.py`!

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-12-27T22:36:42.303

有人已经提到了[Django ticket #7835](https://code.djangoproject.com/ticket/7835)，但似乎有一个更新的回复，对于更新的 Django 版本看起来更有希望。特别是[#42](https://code.djangoproject.com/ticket/7835#comment:42)，它提出了一个不同的`TestRunner`：

```
from importlib.util import find_spec
import unittest

from django.apps import apps
from django.conf import settings
from django.test.runner import DiscoverRunner

class TestLoader(unittest.TestLoader):
    """ Loader that reports all successful loads to a runner """
    def __init__(self, *args, runner, **kwargs):
        self.runner = runner
        super().__init__(*args, **kwargs)

    def loadTestsFromModule(self, module, pattern=None):
        suite = super().loadTestsFromModule(module, pattern)
        if suite.countTestCases():
            self.runner.register_test_module(module)
        return suite

class RunnerWithTestModels(DiscoverRunner):
    """ Test Runner that will add any test packages with a 'models' module to INSTALLED_APPS.
        Allows test only models to be defined within any package that contains tests.
        All test models should be set with app_label = 'tests'
    """
    def __init__(self, *args, **kwargs):
        self.test_packages = set()
        self.test_loader = TestLoader(runner=self)
        super().__init__(*args, **kwargs)

    def register_test_module(self, module):
        self.test_packages.add(module.__package__)

    def setup_databases(self, **kwargs):
        # Look for test models
        test_apps = set()
        for package in self.test_packages:
            if find_spec('.models', package):
                test_apps.add(package)
        # Add test apps with models to INSTALLED_APPS that aren't already there
        new_installed = settings.INSTALLED_APPS + tuple(ta for ta in test_apps if ta not in settings.INSTALLED_APPS)
        apps.set_installed_apps(new_installed)
        return super().setup_databases(**kwargs) 
```

# asp.net - 如何在单独的 dll 项目中配置 WCF

> ID：502919
> 
> 赞同：7
> 
> 时间：2009-02-02T11:37:15.727
> 
> 标签：asp.net, wcf, service-reference, wcf-configuration

我正在开发一个将使用许多 Web 服务的 Web 应用程序 (ASP.NET 3.5)。我为每个 Web 服务创建了一个单独的 dll 项目：这些项目包含服务引用和客户端代码。

但是，调用网站必须在其 web.config 中包含`<system.serviceModel>`信息（`<bindings>`和`<client>`节点），即使此信息也在 dll 的 app.config 文件中！我尝试将 serviceclass.dll.config 复制到网站的 bin 目录，但这没有帮助。

有没有办法集中配置 WCF 客户端？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T12:47:39.813

我只有有限的 WCF 经验，全部使用 BasicHTTP 绑定。但我对 WCF 的 xml 文件过敏，并且到目前为止已经设法避免使用它们。我一般不建议这样做，但我将配置详细信息放在我的应用程序现有配置存储中，然后以编程方式应用它们。例如，对于 Web 服务代理，我使用客户端的构造函数，该构造函数采用“绑定”和“端点”，并以编程方式将设置应用于绑定和端点。

这里似乎描述了一个更优雅的解决方案：[Reading WCF Configuration from a Custom Location](http://www.paraesthesia.com/archive/2008/11/26/reading-wcf-configuration-from-a-custom-location.aspx)，但我还没有尝试过。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-02T13:57:59.187

根据我的经验，库项目从不读取 app.config。

所以你可以真正删除文件，因为它没有被使用。而是读取库的主机配置，因此这是端点和绑定配置的唯一位置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T13:35:59.200

可以放弃 xml 配置并在构造函数或自定义“服务工厂”中建立与服务关联的 Binding 和 Endpoint 类。iDesign 对此有一些很好的信息： [http](http://www.idesign.net/idesign/DesktopDefault.aspx?tabindex=5&tabid=11) ://www.idesign.net/idesign/DesktopDefault.aspx?tabindex=5&tabid=11 （参见在 Proc Factory 中）

在他们的方法中，您在服务上设置属性以在较高级别上指定它们应该如何工作（即[Internet]、[Intranet]、[BusinessToBusiness]），并且服务工厂根据每个场景的最佳实践配置服务。他们的书描述了构建这种服务： [http ://www.amazon.com/Programming-WCF-Services-Juval-Lowy/dp/0596526997](https://rads.stackoverflow.com/amzn/click/com/0596526997)

如果您只想共享配置 XML 配置，可以使用 configSource 属性指定配置路径：[http ://weblogs.asp.net/cibrax/archive/2007/07/24/configsource-attribute-on-system-服务模型-section.aspx](http://weblogs.asp.net/cibrax/archive/2007/07/24/configsource-attribute-on-system-servicemodel-section.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-02T14:10:22.330

请记住，配置文件是由具有入口点的可执行文件读取的。库 dll 没有入口点，因此它不是将读取它的程序集。正在执行的程序集必须有一个要读取的配置文件。

如果您想集中您的网络配置，那么我建议您考虑将它们嵌套在带有虚拟目录的 IIS 中。这将允许您使用配置继承来集中您需要的任何内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-16T19:14:46.103

有 2 个选项。

**选项 1\. 使用渠道。**

如果您直接使用通道，.NET 4.0 和 .NET 4.5 具有[ConfigurationChannelFactory](http://msdn.microsoft.com/en-us/library/dd575311%28v=vs.100%29.aspx)。[MSDN](http://msdn.microsoft.com/en-us/library/ee960149%28v=vs.100%29.aspx)上的示例如下所示：

```
ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();
fileMap.ExeConfigFilename = "Test.config";
Configuration newConfiguration = ConfigurationManager.OpenMappedExeConfiguration(
    fileMap,
    ConfigurationUserLevel.None);

ConfigurationChannelFactory<ICalculatorChannel> factory1 = 
    new ConfigurationChannelFactory<ICalculatorChannel>(
        "endpoint1", 
        newConfiguration, 
        new EndpointAddress("http://localhost:8000/servicemodelsamples/service"));
ICalculatorChannel client1 = factory1.CreateChannel(); 
```

正如 Langdon 所指出的，您可以通过简单地传入 null 来使用配置文件中的端点地址，如下所示：

```
var factory1 = new ConfigurationChannelFactory<ICalculatorChannel>(
        "endpoint1", 
        newConfiguration, 
        null);
ICalculatorChannel client1 = factory1.CreateChannel(); 
```

这在 MSDN[文档](http://msdn.microsoft.com/en-us/library/dd575430.aspx)中进行了讨论。

**选项 2\. 使用代理。**

如果您正在使用代码生成的代理，您可以读取配置文件并加载[ServiceModelSectionGroup](http://msdn.microsoft.com/en-us/library/system.servicemodel.configuration.servicemodelsectiongroup.aspx)。与简单地使用相比，涉及的工作更多，`ConfigurationChannelFactory`但至少您可以继续使用生成的代理（在后台使用 a`ChannelFactory`并`IChannelFactory`为您管理。

Pablo Cibraro 在这里展示了一个很好的例子：[Getting WCF Bindings and Behaviors from any config source](http://weblogs.asp.net/cibrax/archive/2010/05/11/getting-wcf-bindings-and-behaviors-from-any-config-source.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T00:10:53.493

首先，类库 (DLL) 没有自己的配置，但是它们可以读取其主机的配置（Web/可执行文件等）。话虽如此，我仍然在库项目中维护一个 app.config 文件作为模板和易于参考。

就服务配置本身而言，WCF 配置可以很容易地让人大吃一惊。这是一个过度设计的过于复杂的作品。您的应用程序的目标应该是最少依赖配置，同时保持产品将遇到的部署场景的灵活性。

# xml - 为什么即使在 CDATA 部分中也不允许使用空字符？

> ID：502927
> 
> 赞同：3
> 
> 时间：2009-02-02T11:42:45.093
> 
> 标签：xml, null, cdata

XML，为什么即使在 CDATA 部分中也不允许使用空字符？

它似乎在那里终止了文件。

有什么解决办法吗？Base64？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T11:59:19.100

因为它不是[有效的 XML 字符](http://www.w3.org/TR/xml/#charsets)，即它应该产生一个解析错误。这可能是由于历史原因（以空结尾的字符串）和 XML 的纯文本性质：不鼓励支持 Unicode 的编辑器阻塞的任何内容...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T11:57:47.620

您可能会在上一个问题中找到答案：

[为什么 XML 1.0 中的“控制”字符是非法的？](https://stackoverflow.com/questions/404107/why-are-control-characters-illegal-in-xml)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T12:40:11.573

它不应该“终止文件”，但应该产生格式正确的错误。这是不允许的，因为世界上仍有很多地方仍在使用以空字符结尾的字符串处理，因此允许 \0 可能会在处理链中的某个未指定点造成麻烦。

这甚至可能是一个安全漏洞；过去有许多漏洞利用依赖于允许 \0 的系统接口以及将其作为终结者的系统接口。因此，最安全的做法就是禁止它。

其他控制字符可以转义为 &#...; XML 1.1 中其他地方的字符引用，但不在 CDATA 部分中。在 XML 1.0 中，根本无法获取控制字符。毕竟，它应该是一种基于文本的、人类可读的格式。

> Base64？

是的。但是，如果您主要处理大块二进制文件，则将其封装在 XML 中可能不是一个合理的选择。

# gtk - GtkTreeViews 上的列大小

> ID：502934
> 
> 赞同：3
> 
> 时间：2009-02-02T11:46:03.493
> 
> 标签：gtk, gnome, glade, gtktreeview

如何在 GtkTreeView 上设置特定列的水平大小？我的 TreeView 上有 4 列，最后一列扩展了剩余的可用空间。如何设置要在可用空间上扩展的第一列或第二列以在所有列上设置固定宽度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T20:12:56.170

您可以使用`gtk_tree_view_get_column`获取树视图的第 n 列，然后在其上使用`gtk_tree_view_column_set_sizing`with `GTK_TREE_VIEW_COLUMN_FIXED`。

您还可以通过 告诉列展开`gtk_tree_view_column_set_expand`。引用[文档](http://library.gnome.org/devel/gtk/unstable/GtkTreeViewColumn.html)：

> 设置列以占用可用的额外空间。此空间在扩展设置为 TRUE 的所有列之间平均共享。如果没有列设置此选项，则最后一列将获得所有额外空间。默认情况下，每列都是使用此 FALSE 创建的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T09:00:57.960

**Ruby 示例：**

```
col = Gtk::TreeViewColumn.new("Headline", renderer, :text => 1)
col.expand = true # Expands the column

col.sizing = Gtk::TreeViewColumn::FIXED # Sets the column on a fixed width
col.min_width = 150 
```

# asp.net-mvc - IE6的后退键和转发

> ID：502935
> 
> 赞同：0
> 
> 时间：2009-02-02T11:46:20.590
> 
> 标签：asp.net-mvc, internet-explorer-6, back-button, ieframe.dll

我的网站是一个 asp.net-mvc(beta1) 网站，完全验证并在所有浏览器中运行（显然在 IE6 中除外）。

我可以通过执行以下操作来重现错误：

1.  使用一些参数发出 POST 请求
2.  从结果中单击生成的 GET 链接之一
3.  从结果页面按“返回”按钮。

有时后退按钮什么都不做（最后一个请求的页面保持在屏幕上，状态显示“完成”）
有时会显示一个完全空白的页面，其中包含正确的 URL 和“完成”状态
有时是*res://ieframe.dll/repost.htm*页面显示为“找不到服务器”标题。

我还没有找到触发因素..

我猜 IE 没有在那里缓存任何东西，所以它会重新发布 url。不过，似乎什么都没有击中我的控制器。

怎么了？我怎样才能开始调试这个甚至更好：修复这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T11:52:11.297

实施[POST+REDIRECT+GET](http://en.wikipedia.org/wiki/Post/Redirect/Get)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T12:28:55.717

IE 不会在不提示用户的情况下重新发布。如果 IE 没有缓存结果页面（检查您发送的缓存标头），您应该得到重新发布提示。我不知道为什么你会得到“找不到服务器”——听起来像是一个混乱的 IE 安装。（它是多 IE 设置吗？）

正如 cletus 所提到的，post-redirect-get 通常对于成功的帖子形式是可取的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T12:29:56.337

要分析浏览器和服务器之间的流量，您应该将[Fiddler](http://www.fiddlertool.com/fiddler/)放在中间。

通过这种方式，您会发现 IE6 在点击后退按钮时是否将任何请求发送回服务器。

# windows - Altering windows form from userControl

> ID：502948
> 
> 赞同：0
> 
> 时间：2009-02-02T11:50:59.257
> 
> 标签：windows, forms, user-controls

i'm quite new with windows forms and i have a small issue.

i have a form that contains a userControl. the form also contains a button with enabled = false, and upon some user selection in the userControl sets the button to enabled = true. basically, i want to know what's the best way to change something in the form upon a change in the userControl.

I saw on the internet that event/delegates might be the answer, but it seems too complicated for such a small thing. anyone has another solution?

thanks Bosco

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T11:56:26.297

Events are your friends. They're really not that complicated. Just find an apropriate event for your user selection and set the button property.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T13:44:00.480

用户控件旨在由不同的表单或其他用户控件托管。这就是为什么它们应该与它们的主机控件分离。

恕我直言，将用户控件与其父级分离的最佳方法是使用事件。另一种方法是实现[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)。事件是 .NET 中观察者模式的一种特殊实现。

# sql-server - 是否可以在没有模式名称的情况下调用用户定义的函数？

> ID：502949
> 
> 赞同：18
> 
> 时间：2009-02-02T11:51:18.053
> 
> 标签：sql-server, sql-server-2005, schema

我正在使用 MS SQL 2005，当我创建一个函数时，我需要输入架构名称来调用它：

```
select dbo.MyFunc 
```

我所有的表也在“dbo”模式中，我不需要模式名称来引用它，所以我想知道我是否缺少一些可以对函数执行相同操作的配置。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-02T12:05:32.970

简短的回答，不，不是。

您应该考虑为**所有**数据库对象添加架构所有者的前缀，以避免让 sql 服务器“查找”。

它使您的语句更具可读性并略微提高了性能（尽管您可能不会注意到它）。

问候， 利文

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-07T14:58:32.587

与所有其他数据库对象（表、视图和存储过程）不同，用户定义的函数在引用时总是需要模式名称。这是 SQL Server 的一个怪癖。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-05-27T18:46:36.280

*标量值函数必须至少使用函数的两部分名称来调用

[http://msdn.microsoft.com/en-us/library/ms186755.aspx](http://msdn.microsoft.com/en-us/library/ms186755.aspx)

+1 家长

鲍里克

# database - 数据库部署最佳实践

> ID：502952
> 
> 赞同：10
> 
> 时间：2009-02-02T11:52:01.360
> 
> 标签：database, deployment

大多数情况下，我们会更改现有的数据库表、存储过程、函数或表中的参数以进行软件升级/错误修复。当需要将我们的更改部署到另一个环境（如生产或预生产）时，我们的数据库更改的某些部分会被遗忘。

在我们公司，一些开发人员使用数据库差异分析应用程序来找出测试和生产环境之间的差异。一些开发人员存储他们在 db 上所做的每个更改的 t-sql，比如我。

我想知道你在做什么来将数据库更改部署到生产环境。你为什么选择那种方式？或者必须做什么？

感谢您的回复！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-02T11:57:18.277

我们在源代码控制下有我们的数据库。以这种方式跟踪任何更改。其他任何事情都将是一场噩梦。

杰夫也有一篇关于它的文章 - [http://blog.codinghorror.com/get-your-database-under-version-control/](http://blog.codinghorror.com/get-your-database-under-version-control/)

SQL Server 具有[生成和发布脚本向导](https://docs.microsoft.com/en-us/sql/relational-databases/databases/publish-a-database-sql-server-management-studio?view=sql-server-2017)，如果您想将现有数据库放入源代码管理中，它会非常有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-10-01T11:21:56.440

每个数据库对象都应存储在版本控制系统中的单独文件中。版本控制系统可能包含如下示例中的文件：

```
|- tables
     |- employees.sql
     |- contracts.sql
|- packages
     |- contract_api.sql
|- functions
     |- get_employee_name.sql
...etc... 
```

每当您修改某个 DB 对象时，您还必须在版本控制系统中修改相应的 SQL (DDL) 文件。例如，如果您修改包*contract_api*，则更新文件*contract_api.sql*。由于此文件已被修改 - 它可以通过持续集成引擎进行安装。

但是，如您所知，有些 DDL 脚本不能执行两次。例如 'CREATE TABLE mytable...' 脚本只能执行一次。如果您的系统已经投入生产，那么您将无法承受“CREATE TABLE...”脚本标题中的“DROP TABLE mytable”语句。因此，对于生产系统，您需要创建只提供更改的所谓*delta 脚本。*在这种情况下，您可以简单地创建一个名为 employees_upd01.sql 的新文件，其中包含语句“ALTER TABLE mytable ADD COLUMN...”。

一段时间后，您的存储库可能如下所示：

```
|- tables
     |- employees.sql
     |- employees_upgr20091001.sql
     |- employees_upgr20091004.sql
     |- contracts.sql
|- packages
     |- contract_api.sql
|- functions
     |- get_employee_name.sql
...etc... 
```

这没关系，因为：1）当您需要将今天的增量更改交付到数据库时 - 您部署今天修改的文件 2）如果您需要部署系统的全新安装 - 您按顺序运行所有脚本，例如首先是*employees.sql*，然后是*employees_upgr20091001.sql*等。

由于每个 DB 对象都在版本控制系统中的单独文件中，因此您可以很好地控制所有更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T12:02:15.520

在一个项目中，我在 DDL 脚本中进行了所有数据库更改。这些脚本包含将数据库升级到某个版本所必需的 SQL 语句。脚本的文件名还包含数据库将升级到的数据库的版本号 (_versionnumber.sql)

接下来，我有一个小型应用程序，通过以正确的顺序（从数据库的当前版本号到最后一个脚本文件）执行这些脚本文件，将数据库升级到最新版本。

对于新项目，我现在使用 Migrator.NET。此框架允许您在 C# 类中编写数据库更改。该框架有一个控制台应用程序，您可以使用它执行数据库更改，也可以将它与 msbuild 一起使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T11:55:31.760

编写和存储您在 SQL 中所做的每项更改是 IMO 的最佳方式。

# javascript - 如何获得未截断的文本值 元素？

> ID：502958
> 
> 赞同：2
> 
> 时间：2009-02-02T11:55:34.847
> 
> 标签：javascript, internet-explorer, dom, text

我有类似这样的 HTML 输出：

```
<select>
<option value="1">Item1 </option>
</select> 
```

**如何使用 JavaScript 获取值“Item1”（带空格）而不是“Item1”？**

在 Internet Explorer 中，我尝试过的所有属性，例如*text*、*innerHTML*、*data*、*nodeValue*都返回“Item1”而不是“Item1”。

有趣的是，在 Firefox 中，*textContent*和*innerHTML*返回未截断的值，而*text*返回截断的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T12:05:25.217

抱歉，IE 的解析器确实丢弃了 <option> 中的尾随空格。奇怪的是，如果您将带有尾随空格的字符串分配给 innerHTML，IE 会设法记住其中一个。可能最好不要依赖。

通常，如果您想要可见的尾随空格（在任何浏览器中），您必须使用不间断空格字符（例如   字符引用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T12:10:05.740

你永远不应该依赖从字面上解释的间距。也许您的输出应该呈现为：`<option value="1">Item1&nbsp;</option>`

PS：它说 HTML 在代码块中被忽略，但我的实体在这里被转义。（降价）

# java - Eclipse: How to build an executable jar with external jar?

> ID：502960
> 
> 赞同：47
> 
> 时间：2009-02-02T11:56:55.313
> 
> 标签：java, eclipse, jar, classpath, external

I am trying to build an executable jar program which depends on external jar downloaded. In my project, I included them in the build path and can be run and debug within eclipse.

When I tried to export it to a jar, I can run the program but I can't when I try to press a button which includes function calls and classes from the external jar. I have edited the environment variables (Windows XP) CLASSPATH to include paths of all the external jar, but it doesn't work.

A point to note is that I got compile warnings while exporting my executable jar, but it doesn't show up any description about the warnings.

Would someone kindly provide a thorough guide on how to include an external jar program using eclipse?

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-04-29T17:53:19.633

Eclipse 3.5 可以选择将所需的库打包到可运行的 jar 中。文件 -> 导出... 选择可运行的 jar 并单击下一步。可运行的 jar 导出窗口有一个单选按钮，您可以在其中选择将所需的库打包到 jar 中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-02T12:08:34.557

You can do this by [writing a manifest](http://java.sun.com/docs/books/tutorial/deployment/jar/manifestindex.html) for your [jar](http://java.sun.com/docs/books/tutorial/deployment/jar/). Have a look at the [Class-Path](http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html) header. Eclipse has an option for choosing your own manifest on export.

The alternative is to add the dependency to the classpath at the time you invoke the application:

```
win32: java.exe -cp app.jar;dependency.jar foo.MyMainClass
*nix:  java -cp app.jar:dependency.jar foo.MyMainClass 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-12-30T00:21:12.987

**如何将项目的 jar 包含到可运行的 jar 中：**

我正在使用 Eclipse 版本：在 Ubuntu 12.10 上运行的 3.7.2。我还将向您展示如何制作，`build.xml`以便您可以`ant jar`从命令行执行并创建您的 jar，并将其他导入的 jar 提取到其中。

基本上，您要求 Eclipse 为您构建将库导入 jar 的 build.xml。

1.  启动 Eclipse 并创建一个新的 Java 项目，创建一个新包“mypackage”，添加您的主类：`Runner` 将这段代码放在那里。

    ![在此处输入图像描述](https://i.stack.imgur.com/Fsc3D.png)

2.  现在包括`mysql-connector-java-5.1.28-bin.jar` [来自 Oracle](http://dev.mysql.com/downloads/connector/j/)的，它使我们能够编写 Java 来连接到 MySQL 数据库。通过右键单击项目 -> 属性 -> java 构建路径 -> 添加外部 Jar -> 选择 mysql-connector-java-5.1.28-bin.jar 来执行此操作。

3.  在 Eclipse 中运行程序，它应该会运行，并告诉您用户名/密码无效，这意味着 Eclipse 已正确配置了 jar。

4.  在 Eclipse 中转到`File`-> `Export`-> `Java`-> `Runnable Jar File`。您将看到此对话框：

    ![在此处输入图像描述](https://i.stack.imgur.com/dhr80.png)

    确保设置“另存为 ant 脚本”复选框。这就是它的原因，因此您可以使用命令行`ant jar`稍后进行操作。

5.  然后去终端查看ant脚本：

    ![在此处输入图像描述](https://i.stack.imgur.com/TD4sI.png)

所以你看，我运行了 jar 并没有出错，因为它发现包含的`mysql-connector-java-5.1.28-bin.jar`嵌入在里面`Hello.jar`。

查看 Hello.jar: 内部 `vi Hello.jar`，您会看到许多对`com/mysql/jdbc/stuff.class`

要`ant jar`在命令行上自动执行所有这些操作：重命名`buildant.xml`为`build.xml`，并将目标名称从 更改`create_run_jar`为`jar`。

然后，从`MyProject`您的内部输入`ant jar`并发出声音。你在 MyProject 中有你的 jar。你可以使用它来调用它`java -jar Hello.jar`，这一切都有效。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-04T15:22:34.850

作为一种好的做法，您可以使用[Ant 脚本](http://ant.apache.org/)（Eclipse 自带）来生成 JAR 文件。在这个 JAR 中，您可以拥有所有依赖库。

您甚至可以将 MANIFEST 的 Class-path 标头设置为指向文件系统中的文件，但这不是一个好习惯。

Ant build.xml 脚本示例：

```
<project name="jar with libs" default="compile and build" basedir=".">
<!-- this is used at compile time -->
<path id="example-classpath">
    <pathelement location="${root-dir}" />
    <fileset dir="D:/LIC/xalan-j_2_7_1" includes="*.jar" />
</path>

<target name="compile and build">
    <!-- deletes previously created jar -->
    <delete file="test.jar" />

    <!-- compile your code and drop .class into "bin" directory -->
    <javac srcdir="${basedir}" destdir="bin" debug="true" deprecation="on">
        <!-- this is telling the compiler where are the dependencies -->
        <classpath refid="example-classpath" />
    </javac>

    <!-- copy the JARs that you need to "bin" directory  -->
    <copy todir="bin">
        <fileset dir="D:/LIC/xalan-j_2_7_1" includes="*.jar" />
    </copy>

    <!-- creates your jar with the contents inside "bin" (now with your .class and .jar dependencies) -->
    <jar destfile="test.jar" basedir="bin" duplicate="preserve">
        <manifest>
            <!-- Who is building this jar? -->
            <attribute name="Built-By" value="${user.name}" />
            <!-- Information about the program itself -->
            <attribute name="Implementation-Vendor" value="ACME inc." />
            <attribute name="Implementation-Title" value="GreatProduct" />
            <attribute name="Implementation-Version" value="1.0.0beta2" />
            <!-- this tells which class should run when executing your jar -->
            <attribute name="Main-class" value="ApplyXPath" />
        </manifest>
    </jar>
</target> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T12:04:16.110

Try the fat-jar extension. It will include all external jars inside the jar.

*   Update url: [http://kurucz-grafika.de/fatjar](http://kurucz-grafika.de/fatjar)
*   Homepage: [http://fjep.sourceforge.net/](http://fjep.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-17T08:42:51.193

看@ [java-jar-ignores-classpath-Workaround](http://www.tiwoc.de/blog/archives/22-java-jar-ignores-classpath-Workaround.html)

# function - 方案功能是一种衬里吗？

> ID：502968
> 
> 赞同：3
> 
> 时间：2009-02-02T12:00:49.440
> 
> 标签：function, scheme, sicp

我正在关注*计算机程序的结构和解释，*在尝试解决 Ex 1.3 时，我第一次尝试得到以下代码：

```
(define (sumsq a b c)(
(define highest (if (> (if (> a b) a b) (if (> a c) a c)) (if (> a b) a b) (if (> a c) a c)))
(define second_h (if (> (if (> a b) b a) (if (> a c) c a)) (if (> a b) b a) (if (> a c) c a)))
(+ (* highest highest) (* second_h second_h))) 
```

它不起作用，我查找了解决方案并在[SICP Wiki上找到了它们](http://community.schemewiki.org/?sicp-ex-1.3)

```
;; ex 1.3
;; implemented using only techniques covered to this point

(define (square x) (* x x))

(define (sum-of-squares x y)
  (+ (square x) (square y)))

(define (largest-two-of-three x y z)
  (if (>= x y)
      (sum-of-squares x (if (>= y z) y z))
      (sum-of-squares y (if (>= x z) x z)))) 
```

不同之处在于我使用多个语句来定义变量，然后对平方求和，而正确的方法是将我的每一行定义为函数。

方案一中的函数是线性的吗？还是我错过了整件事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T15:02:19.650

您应该使用适当的缩进和换行来了解您的程序流程。然后，您的第一个提案如下所示：

```
（定义（sumsq abc）
  （（定义最高
     （如果（>（如果（> ab）ab）
            （如果（> ac）ac））
         (如果 (> ab) ab)
         （如果（> ac）ac）））
   （定义第二个 h
     （如果（>（如果（> ab）ba）
            （如果（> ac）ca））
         （如果（> ab）ba）
         （如果（> ac）ca）））
   (+ (* 最高最高)
      (* second-h second-h)))

```

首先要注意：括号不匹配；开放的比封闭的多。仔细检查发现第二行的一个左括号是错误的。顺便说一句，这是在您的第一行末尾以某种方式悬空的那个。我冒昧地猜测，当您尝试对此进行评估时，什么都没有发生，因为读者正在等待声明的结尾。

正确的缩进非常重要。我认为 SICP 没有明确解释它，尽管示例通常是这样完成的。[我在这里](http://mumble.net/~campbell/scheme/style.txt)找到了风格指南。

第二个观察：你经常重复自己。在所有这些嵌套`if`语句中，我不确定你是否真的得到了正确的值。查看您找到的解决方案，了解如何大大简化。

您试图通过给子结果名称来分解复杂性。分解复杂性是好的，但通常最好不要命名结果，而是命名概念。想想你在做什么，然后为这些活动命名。这些是函数，它们构成了您最终几乎可以轻松解决问题的语言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T15:16:58.093

你写的（减去一个额外的括号）是：

```
(define (sumsq a b c)
  (define highest
    (if (> (if (> a b) a b)
           (if (> a c) a c))
      (if (> a b) a b)
      (if (> a c) a c)))
  (define second_h
    (if (> (if (> a b) b a)
           (if (> a c) c a))
      (if (> a b) b a)
      (if (> a c) c a)))
  (+ (* highest highest) (* second_h second_h))) 
```

他们的解决方案将平方和平方和分成单独的函数，但我认为这并不重要。不写`(+ (* a a) (* b b))` **会让**你不必命名你正在计算的两个值，这会让你在最后把函数写成一个大表达式，但现在有更大的事情要担心。

我认为您遇到的问题是您的 (if.​​..) 表达式太大而难以理解。请注意，有两种模式多次出现：`(if (> a b) a b)`和`(if (> a b) b a)`。这些是 max 和 min 函数，因此这样定义它们很有用：

```
(define (min a b) (if (< a b) a b))
(define (max a b) (if (< a b) b a)) 
```

这样，您可以将解决方案重写为：

```
(define (sumsq a b c)
  (define highest
    (if (> (max a b) (max a c))
      (max a b)
      (max a c)))
  (define second_h
    (if (> (min a b) (min a c))
      (min a b)
      (min a c)))
  (+ (* highest highest) (* second_h second_h))) 
```

再次简化它给出：

```
(define (sumsq a b c)
  (define highest
    (max (max a b) (max a c)))
  (define second_h
    (max (min a b) (min a c)))
  (+ (* highest highest) (* second_h second_h))) 
```

请注意，这种写法更容易推理，`(max (max a b) (max a c))`显然是`a` `b`和的最大值，`c`实际上可以重写为`(max (max a b) c)`。但是，看着`second_h`，并不明显它是正确的。`a`当三个值中的最小值是什么时会发生什么？

他们在解决方案中使用的技巧是首先比较`x`和`y`。如果`x < y`，那么你知道它`y`不是三个中最小的，所以它要么是最高的，要么是第二高的。您将要使用的另一个数字是 和 中的较高者`x`，`z`因为这两个中的较小者将是三个中的最小者，您要忽略它。类似的逻辑适用于`y < x`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-02T12:05:34.483

Scheme 的一个想法是`bottom-up programming`为每个概念操作创建一个函数。这是许多函数式编程语言中推荐的方法。

使用这种方法，您最终会得到许多对参数执行一个逻辑操作的小函数。这样你的代码最终变得更加模块化和干净。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-02T13:39:32.813

您的解决方案具有以下形式： (define (func param) (define...) (define...))

但是定义需要这种形式：(define (func param) body)

主体是函数的实现......它做什么，它返回什么。你的身体只是更多的定义，从不做任何事情。这就解释了为什么 Scheme 解释器不接受您的解决方案。

回答“方案函数是单行的吗？”这个问题。您需要调查“开始”表单，如下所示： (begin (+ 1 1) (+ 2 2)) => 4

在上面的例子中，(+ 1 1) 的结果只是被抛出，所以你可以看到 begin 只有当它里面的东西有副作用时才真正有意义。

您应该知道，Scheme 的某些部分（尤其是 let 和 lambda）在它们的主体周围有隐式开始。所以这是有效的：

```
 (let ((x 1))
    (+ 1 1)
    (+ 2 2)) 
```

即使没有开始。这使得代码更容易编写。

最后，当您继续学习 Scheme 时，请始终尝试找到一种没有开始也没有副作用的方法。尤其是在大多数 Scheme 书籍的前几章中，如果你在想，“我想设置那个变量，然后我想做这个，然后这个......”你可能陷入了你的旧编程方式而不是做它是Scheme的方式。副作用完全没有问题，但是大量使用它们意味着您并没有真正按照 Scheme 的最佳工作方式进行编程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-18T13:55:16.943

练习 1.3 要求你定义一个过程，它接受三个数字作为参数并返回两个较大数字的平方和。使用内置的 Scheme 过程`square`、`max`和定义这样的过程很容易`min`，但是我们在本书中还没有遇到过这些过程，所以我也会定义它们。

```
(define (square x)
   (* x x))

(define (max x y)
   (if (> x y) x y))

(define (min x y)
   (if (< x y) x y))

(define (sum-of-highest-squares x y z)
   (+ (square (max x y))
      (square (max (min x y) z)))) 
```

该`sum-of-highest-squares`过程通过将 x 和 y 的最大值的平方（这两个的最大值从三个中的最小值中消除）和其余两个的最大值的平方（x 和 y 的最小值）相加来工作，这将是第一步留下的任何值）和z。

注意：这是来自我的博客文章[SICP 练习 1.1 - 1.5](http://www.billthelizard.com/2009/10/sicp-exercises-11-15.html)。还有一些链接可以将您带到那里的许多其他 SICP 解决方案。

# eclipse - Eclipse 未在 JavaDoc 视图中显示图像

> ID：502971
> 
> 赞同：1
> 
> 时间：2009-02-02T12:02:25.007
> 
> 标签：eclipse

由于某种原因，图像在我的 Eclipse 的 Javadoc 视图中不可见。

[没有图像可见 http://shlinkr.com/images/CropperCapture-12.Png](http://shlinkr.com/images/CropperCapture-12.Png)

但是*相同*的Javadocs 在浏览器中工作得非常好：

[图像可见 http://shlinkr.com/images/CropperCapture-13.Png](http://shlinkr.com/images/CropperCapture-13.Png)

我的 Eclipse 实例有什么问题吗？我需要更改设置吗？想法？

**更新：**在这种情况下，我使用的是 3.4.1（Ganymede），但我刚刚在 3.3 Europa 中打开了同一个项目，它也有同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T12:21:11.410

您是否设法在 eclipse javadoc 中显示任何图像？

因为它似乎是[一个已知的限制，最近在 3.5 流中得到了修复](http://dev.eclipse.org/newslists/news.eclipse.tools.jdt/msg23081.html)......

那么......你使用的是什么日食？3.4 ? 3.4.1 ? 3.5Mx ?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-21T09:25:54.203

使用`@docRoot`注释

```
<img src="{@docRoot}/logo.png"> 
```

请在此处查看更多 java 文档

# linq - Collections from LINQ to SQL and the ability to filter

> ID：502974
> 
> 赞同：1
> 
> 时间：2009-02-02T12:03:18.000
> 
> 标签：linq, collections, filtering

I have asked this question on more than one forums and it seems no one would even want to take a crak at it.

My problem is simple and i would guess everyone has run into it when using LINQ to SQL.

If your have a LINQ object called: Person and you would like to poulate a list box based on all of the people you have in your DB the task is simple:

```
BindingListCollectionView view;
view = (BindingListCollectionView)CollectionViewSource.GetDefault (dataContext.Persons); 
```

Now say you wish to have a text box over the list to filter the results. that would not work since IBindingList interface implemented by the LINQ to SQL objects returns false on "CanFilter" property.

What most people do is create an ObservebleCollection, the folloing is an example im sure most of you use.

```
ObservebleCollection<Person> col = new ObservebleCollection<Person>(dataContext.Persons.ToList());
ListCollectionView view = (ListCollectionView)CollectionViewSource.GetDefault(col); 
```

Since this will return a ListCollectionView and not a BindingListCollectionView it will be filterbale and all is well with the world.

Here comes the problem, say you have Multi levels of Forign key relations: Person<---Alias<---Tickets

and now you wish to have 3 list boxes binded when a person is selected the second list box will diplay only his Alias's and when an Alias is selected only it's Ticket's are shown, this is very simple with binding and syncronizing. the problem is if i want to add a textbox filter on tob of all of the listboxes ( say a person has over 1000 Aliases and i want to be able to filter them to choose 1 ).

The prvious solution of ObservebleCollection will not work since all the Person objects returned will have EntitySet objects for the forgin relation, and this will again return a none filterbale BindingListCollectionView and not a ListCollectionView.

The only way i found around this is to manually bulid an ObserverbleCollection based on the retunred Query this is tedious work and causes me to tie the BusnessObjects layer and the application Layer. also its very slow since you need to make many trips to the database...

Does anyone have a solution to this?

Thanks, Eric.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T12:40:38.063

I think the Model View View-Model pattern (MVVM) will help you out here. Create a view for your first listbox and ensure it exposes its collection as something that implements INotifyCollectionChanged. Same with your second and third listboxes. You can also make any of them include properties for binding to your textbox for filtering. When the value changes, you simple adjust the in-memory collection that the list is bound to.

Have a google for MVVM since it works quite well. Most examples will relate to WPF but are still applicable for what you are doing.

Also check out a product on codeplex called 'Bindable Linq' which allows you to do things like:

```
var q = from p in Persons.AsBindable() select p; 
```

# user-interface - “GUI-Element”有通用术语吗？

> ID：502975
> 
> 赞同：1
> 
> 时间：2009-02-02T12:03:34.893
> 
> 标签：user-interface

是否有一个通用的、被广泛理解的 GUI 元素术语。我编写了这么多 GUI 工具包，我不知道纯 Windows 的程序员是否知道 Java 人群在谈论`widgets`. GTK+ 用户知道 a`control`是什么吗？除了我还有人记得`gadgets`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-02T12:05:45.280

Qt 使用小部件，Swing 使用组件。当您说滚动小部件/组件时，大多数 gui 程序员都会理解您的意思。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T12:19:01.773

由于组件是通用的，我会说：视觉组件。

它只是准确地描述了它是什么：一个可见的、自包含的元素，它完成了一些明确定义的任务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T12:19:54.470

根据我的人机交互老师和这本[HCI 手册](https://rads.stackoverflow.com/amzn/click/com/0132398648)的说法，名称是“widget”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T12:04:46.640

零件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T12:13:43.033

我会说“元素”。“组件”为我唤起了 COM 对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-02T12:14:33.093

我认为没有一个术语可以涵盖它，但是*window*、*component*、*widget*和*control*都被广泛使用，所以我认为大多数开发人员都理解它们，尽管它们在不同框架中可能意味着略有不同的东西（即是框架中最低的通用类/组件）。

实际上，我认为*GUI 元素*（或*图形元素/界面元素*）是一个很好的包罗万象的术语。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-02T12:15:16.570

正如这个[SO question](https://stackoverflow.com/questions/421965)中所指出的，命名很困难，这使得这个问题与程序非常相关！

正如 org.eclipse.swt.widgets.Widget 的 javadoc 中所指定的，Widget 通常指的是“用户界面对象”。
所以它可能比过于笼统的术语“组件”更精确。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-02T12:20:10.523

Symbian（当前）使用控件，但 S60 正在向 QT 迁移，因此很可能会迁移到小部件。

我建议你坚持你的 GUI 框架的约定。这样，那些花时间学习框架的人就会知道你的意思，而那些不知道的人直到他们学会了才会知道你的意思。如果是针对独立于框架的文章或类似的文章，请在开头或附录中定义您的意思（例如：控件 - 一个 GUI 元素，通常也称为组件、小部件等）。

# workflow - 运行时 WF 验证错误

> ID：502976
> 
> 赞同：0
> 
> 时间：2009-02-02T12:03:57.297
> 
> 标签：workflow, workflow-foundation, rules

我有两个编译良好的工作流基础（.NET 3.5 SP 1）应用程序。它有两个声明性规则条件。两者都很简单，例子：
- !this.Shutdown - this.Runtime == null

该项目可以正确构建，没有错误或警告，但是当我运行应用程序时，它会失败并出现以下异常：`error 1342: Activity 'whileNotShutdown' validation failed: Can not find the condition "Shutdown not requested".`

在另一个应用程序中，我在策略中使用了一个更复杂的规则集，它会生成以下异常：`error 1398: Activity 'Defaults' validation failed: Can not find the rule set "Rule Set1". Check if rule set is defined in the rules file.`

我尝试删除 .rules 文件并通过重新创建这两个规则来重新创建它，但这并没有帮助。

问题是：导致此错误的原因是什么？

我尝试过的一些事情：

*   将工作流规则放在更大的工作流中对问题没有影响。
*   这个问题现在影响了解决方案中的所有工作流程（甚至那些曾经工作的工作流程）。
*   使用代码规则条件没有相同的问题 - 问题与规则文件有关。
*   重建工作流程没有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T17:07:26.857

编译器不检查声明性工作流规则，因此那里没有帮助。当您在规则中引用“this”时，它表示工作流程。因此，您的属性 Shutdown 和 Runtime 必须在工作流级别声明。我认为 Runtime 是指 WorkflowRuntime ，这有点不寻常，不建议在您的工作流程中使用，因此这里可能存在设计问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-01T07:00:18.667

最终找到了原因——是类名中的空格引起的，导致规则文件中有空格，这似乎是导致问题的原因。

例如这将导致错误：

[替代文字 http://img512.imageshack.us/img512/661/clipboard01wdu.png](http://img512.imageshack.us/img512/661/clipboard01wdu.png)

但是这不会：
[替代文字 http://img140.imageshack.us/img140/9366/clipboard02t.png](http://img140.imageshack.us/img140/9366/clipboard02t.png)

# windows - 从映射的网络驱动器快速复制文件

> ID：502992
> 
> 赞同：2
> 
> 时间：2009-02-02T12:10:20.777
> 
> 标签：windows, networking, windows-xp, mapping

谁能告诉我如何从映射的网络驱动器快速复制文件？

Windows Copy Paste 的工作速度非常慢，并且会影响系统的性能。

我使用了 XCOPY 源目标 /i /s /z /q

这足够快并复制了一些文件，后来抛出错误“指定的网络名称不可用”

我记得有人使用解决方法从映射的网络驱动器快速复制文件。

任何人都可以建议我这样做吗？

我使用的是 Windows XP，所以请不要建议我使用 RoboCopy。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T12:25:33.197

RoboCopy 在 WinXP 上运行良好。包含 RoboCopy 的 Windows Server 2003 资源工具包可以在 XP 上正常安装。

[http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T12:27:46.997

仅使用操作系统附带的工具，没有可靠、快速和简单的方法在 Windows 计算机之间复制文件。

您的选择是：

*   [齐声](http://www.cis.upenn.edu/~bcpierce/unison/)
*   RoboCopy（有关XP[的说明，请参阅这篇文章）](http://theos.in/windows-server/free-download-windows-xp-2003-robocopy-software/)
*   rsync（与[Cygwin](http://www.cygwin.com/)一起提供）

请注意，您可以下载 Windows 2003 服务器工具并在 XP 上解压缩它们。它可以在 XP 上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T14:02:10.210

我发现[Total Commander](http://www.ghisler.com "总司令")比任何内置复制机制都要快得多，包括通过网络复制文件时**。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-13T14:01:17.877

使用 Ipmessanger 我可以在我的千兆以太网上以 55 MB /秒（两台 PC 上的 SATA2 7200 RPMS 硬盘）复制

# java - Spring IoC 和通用接口类型

> ID：502994
> 
> 赞同：37
> 
> 时间：2009-02-02T12:10:57.813
> 
> 标签：java, spring, inversion-of-control, types, generics

我正在尝试将 Spring IoC 与这样的接口一起使用：

```
public interface ISimpleService<T> {
    void someOp(T t);
    T otherOp();
} 
```

Spring 能否提供基于泛型类型参数 T 的 IoC？我的意思是，像这样：

```
public class SpringIocTest {
    @Autowired
    ISimpleService<Long> longSvc;

    @Autowired
    ISimpleService<String> strSvc;
    //...
} 
```

当然，我上面的例子不起作用：

```
expected single matching bean but found 2: [serviceLong, serviceString]
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessAfterInstantiation(AutowiredAnnotationBeanPostProcessor.java:243)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:957) 
```

我的问题：是否可以在对接口或实现类进行最少修改的情况下提供类似的功能？例如，我知道我可以使用@Qualifiers，但我想让事情尽可能简单。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-02T12:15:34.463

我不相信这是可能的，因为擦除。在进行全自动装配时，我们通常会切换到强类型子接口：

```
public interface LongService extends ISimpleService<Long> {}
public interface StringService extends ISimpleService<String> {} 
```

进行此切换后，我们发现我们实际上非常喜欢它，因为它使我们能够更好地进行“查找使用”跟踪，这是泛型接口所松散的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-04T13:43:31.807

我认为没有资格赛是不可能的

生病尝试用genericDAO展示我的解决方案，如果有点详细，抱歉

接口和实现类定义

```
public interface GenericDAO<T, ID extends Serializable> (...)

public class GenericDAOImpl<T, ID extends Serializable>
    implements GenericDAO<T, ID> 
    (...) important is this constructor
    public GenericDAOImpl(Class<T> persistentClass) {
       this.persistentClass = persistentClass;
    } 
```

spring bean 定义，注意 abstract="true"

```
<bean id="genericHibernateDAO" class="de.optimum24.av.pers.ext.hibernate.dao.GenericDAOImpl"
      abstract="true">
    <description>
        <![CDATA[
            Definition des GenericDAO.
        ]]>
    </description>
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

**在没有特殊实现的情况下使用这个 genericDAO 类**

```
 <bean id="testHibernateChildDao" class="de.optimum24.av.pers.ext.hibernate.dao.GenericDAOImpl">
    <property name="sessionFactory" ref="sessionFactory" />
    <constructor-arg>
        <value>de.optimum24.av.pers.test.hibernate.domain.TOChild</value>
    </constructor-arg>
</bean> 
```

注意带有具体类的constructor-arg，如果你使用Spring Annotation，你需要做：

```
@Autowired
@Qualifier(value = "testHibernateChildDao")
private GenericDAO<TOChild, Integer> ToChildDAO; 
```

区分 genericDao Beans 的各种版本（注意 Qualifier with direct Reference to the Beanname）

**将此 genericDAO 与特殊实现类一起使用**

接口和类

```
public interface TestHibernateParentDAO extends GenericDAO<TOParent, Integer>{
  void foo();
}
public class TestHibernateParentDAOImpl extends GenericDAOImpl<TOParent, Integer>
                              implements TestHibernateParentDAO {
  @Override
  public void foo() {
      //* no-op */
  }
} 
```

Bean 定义，注意上面抽象 genericDAO 的“父”引用

```
<bean id="testHibernateParentDao" class="de.optimum24.av.pers.test.hibernate.dao.TestHibernateParentDAOImpl"
      parent="genericHibernateDAO" /> 
```

以及使用 Spring Annotation

```
@Autowired
private TestHibernateParentDAO ToParentDAO; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-16T16:55:25.307

如果泛型类型在编译时完全具体化，则可以通过擦除来做到这一点。在这种情况下，类型信息可通过以下任一方式获得：

```
Class#getGenericInterfaces()
Class#getGenericSuperclass() 
```

这是 Spring 中缺少的 Guice 的主要特性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-05T04:49:30.060

不要让你的界面通用。制定您的方法，而不是：

```
public interface ISimpleService {
    public <T> T doSomething(T param);
} 
```

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-16T08:23:57.900

当使用某些持久层执行此操作时，[Spring Data](http://www.springsource.org/spring-data)会为您执行此操作。如果您使用 JPA、Neo4j、MongoDB 或其他它支持的东西，Spring Data 是一个非常棒的节省时间和简化工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-26T20:40:55.563

另一种选择是在一侧使用名称注释实现 bean 的接口，并在另一侧使用指向创建名称的限定符进行注释:) 这是我在项目中使用的一个快速示例：

```
 public interface IDAO<T> {

         public void insert(T model);
         public void update(T model);
         public void delete(T model);
  } 
```

作为前身的抽象类：

```
public abstract class AbstractHibernateDAO {

         protected SessionFactory sessionFactory;

         protected Session currentSession() {
             return sessionFactory.getCurrentSession();
         }
    } 
```

实体用户抽象类的实现：

```
@Repository(value = "userRepository") 
public class UserDAO extends AbstractHibernateDAO implements IDAO<User> {

    @Autowired
    public UserDAO(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }

    @Override
    public void insert(User user) {
        currentSession().save(user);
    }

    @Override
    public void update(User user) {
        currentSession().update(user);
    }

    @Override
    public void delete(User user) {
        currentSession().delete(user);
    } 
```

}

最后注入正确的实现：

```
@Resource
@Qualifier(value = "userRepository")
IDAO<User> userPersistence; 
```

# delphi - Delphi：检查文件是否正在使用

> ID：502996
> 
> 赞同：10
> 
> 时间：2009-02-02T12:11:12.023
> 
> 标签：delphi, file, handle

我想写入/删除一个文件，但如果该文件正在被另一个程序使用，有时我会崩溃。如何检查文件是否被另一个进程打开或者我可以打开它进行写入？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-02T12:51:55.937

问题是，在您检查是否可以获得独占访问和打开文件之间，其他东西获得了对该文件的独占访问，并且无论如何您都会遇到异常。

查看是否可以在文件上获得排他锁的唯一万无一失的方法是尝试在文件上获得排他锁，如果你得到它，你就拥有它。

如果没有，你会捕获异常，并且要么

*   去做点别的
*   稍等片刻再试一次

这是生活中的一种情况，最好是请求宽恕而不是允许:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-03T10:43:28.837

有一种新方法可以获取 Vista 及以上文件锁定的来源： [http ://www.remkoweijnen.nl/blog/2011/01/03/cannot-access-files-but-need-the-origin/](http://www.remkoweijnen.nl/blog/2011/01/03/cannot-access-files-but-need-the-origin/)

UserMode：写入锁定文件的最佳方式是要求用户在其他进程中将其关闭。在批处理过程中，您应该忽略此类文件并记录问题。提供其他进程的名称是为用户找到解决方案的好方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T12:14:22.970

不确定您要检查是否可以写入文件的编程语言。在 Java 中，[java.io.File.canWrite()](http://java.sun.com/j2se/1.4.2/docs/api/java/io/File.html#canWrite())可以为您完成这项工作。

一般的：

在类 UNIX 操作系统中，您可以使用[lsof](http://en.wikipedia.org/wiki/Lsof)命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T12:21:09.507

如果您想查看哪个程序拥有您文件的句柄，请使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)（从 MicroSoft 下载）。

该工具有一个命令行界面，因此您可以使用您的语言的脚本界面（例如`java.lang.Process`）来运行该工具并显示有用的错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T12:58:59.743

[在http://delphi.about.com/cs/adptips1999/a/bltip0999_3.htm](http://delphi.about.com/cs/adptips1999/a/bltip0999_3.htm)中给出的 IsFileInUse******