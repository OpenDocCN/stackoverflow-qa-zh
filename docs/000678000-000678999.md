# StackOverflow 问答 000678000-000678999

# installation - 将 InstallScope 更改为“perMachine”后如何修复 wix 设置的升级逻辑

> ID：678002
> 
> 赞同：15
> 
> 时间：2009-03-24T15:44:17.817
> 
> 标签：installation, wix, windows-installer

我们使用 wix 为我们的应用程序创建设置。对于用户已经安装了我们应用程序的旧版本的情况，我们使用[MajorUpgrade XML 元素](http://wixtoolset.org/documentation/manual/v3/xsd/wix/majorupgrade.html)进行重大升级。这一切都按预期工作：如果安装了旧版本，它会透明地升级。如果存在较新版本，安装程序将中止并显示一条明确消息。

但是，我现在想将[InstallScope](http://www.joyofsetup.com/2008/04/01/new-wix-feature-setting-package-installation-scope/)从“perUser”更改为“perMachine”。不幸的是，这打破了升级逻辑。新的安装程序似乎没有检测和删除以前的“perUser”安装。相反，它只是将自身安装在同一 ProgramFiles 位置的旧版本之上。用户可以在“添加/删除程序”列表中看到两个条目，并在桌面上看到两个相同的快捷方式（旧的用户特定快捷方式和新的 perMachine 快捷方式）。

如何在不破坏升级逻辑的情况下将安装程序从“perUser”转换到“perMachine”安装范围？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T16:31:23.867

可悲的是，Windows 安装程序不支持这一点。您的软件包之外的某些进程（引导程序/链接程序？）将必须管理从每个用户到每台机器的升级。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-01-28T14:40:58.210

从每台机器的配置开始。

```
<Property Id="ALLUSERS" Value="1" /> 
```

这将运行一个自动的每台机器检查（如果你有 MajorUpgrade 元素工作，我想），它不会选择以前的每用户安装：

```
Action start 15:46:35: FindRelatedProducts.
MSI (c) (D0:0C) [15:46:35:496]: FindRelatedProducts: current install is per-machine.  Related install for product '{0C6604FB-58EC-48B9-8259-5871EFDADEB9}' is per-user.  Skipping...
MSI (c) (D0:0C) [15:46:35:496]: FindRelatedProducts: current install is per-machine.  Related install for product '{0C6604FB-58EC-48B9-8259-5871EFDADEB9}' is per-user.  Skipping... 
```

因此，在安装之前，请确保您`FindRelatedProducts`对已安装在用户范围内的产品运行另一个调用（例如，像这样）：

```
<!-- temporarily switch to per-user install scope-->   
<Publish Dialog="MyWelcomeDlg" Control="Next" Property="ALLUSERS" Value="{}">1</Publish>
<!-- find related products that have been installed per-user -->
<Publish Dialog="MyWelcomeDlg" Control="Next" Event="DoAction" Value="FindRelatedProducts">1</Publish>
<!-- switch back to per-machine install scope-->
<Publish Dialog="MyWelcomeDlg" Control="Next" Property="ALLUSERS" Value="1">1</Publish> 
```

这反过来会找到每个用户的安装：

```
Action start 15:46:36: FindRelatedProducts.
FindRelatedProducts: Found application: {0C6604FB-58EC-48B9-8259-5871EFDADEB9}
MSI (c) (D0:88) [15:46:36:716]: PROPERTY CHANGE: Adding WIX_UPGRADE_DETECTED property. Its value is '{0C6604FB-58EC-48B9-8259-5871EFDADEB9}'.
MSI (c) (D0:88) [15:46:36:716]: PROPERTY CHANGE: Adding MIGRATE property. Its value is '{0C6604FB-58EC-48B9-8259-5871EFDADEB9}'. 
```

无论在哪个检查中找到现有产品，都将被删除。

```
Action start 15:46:41: RemoveExistingProducts.
RemoveExistingProducts: Application: {0C6604FB-58EC-48B9-8259-5871EFDADEB9} 
```

*附带说明*：这并不能避免当您有双重用途安装程序时出现的基本困难：机器上的 User1 可能会在每个用户范围内安装，然后 User2 会在每个机器上安装。User1 将在他的程序/功能表中看到这两个安装，我不知道哪个优先。因此，请考虑仅使用每台机器安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-01T13:23:30.907

您可以使用此技术从每台机器安装中检测每用户安装：http: [//www.mail-archive.com/wix-users@lists.sourceforge.net/msg35197.html](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg35197.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-05T20:15:31.417

这会找到现有的 perUser 和/或 perMachine 安装。并强制新安装到 perMachine 安装（显然可以按照您的意愿应用使该条件成为条件的逻辑）。这在作为普通安装运行和在 LocalSystem 下静默安装（静默升级）时有效。请记住，它只能在以该用户身份运行时找到 perUser 安装。

创建自定义操作（在 DLL 中）

```
#pragma comment(linker, "/EXPORT:RunFindRelatedProducts=_RunFindRelatedProducts@4")
extern "C" __declspec(dllexport) UINT __stdcall RunFindRelatedProducts(MSIHANDLE a_hInstall)
{
MsiSetProperty(a_hInstall, "ALLUSERS", "1");
MsiDoAction(a_hInstall, "FindRelatedProducts");
MsiSetProperty(a_hInstall, "ALLUSERS", "");
MsiDoAction(a_hInstall, "FindRelatedProducts");
MsiSetProperty(a_hInstall, "ALLUSERS", "1");
return ERROR_SUCCESS;
}//end function 
```

然后用自定义操作“替换”标准 FindRelatedProducts

```
<InstallUISequence>
  <FindRelatedProducts>0</FindRelatedProducts>
  <Custom Action="RunFindRelatedProducts" Before='FindRelatedProducts'>NOT Installed</Custom>
</InstallUISequence>
<InstallExecuteSequence>
  <FindRelatedProducts>0</FindRelatedProducts>
  <Custom Action="RunFindRelatedProducts" Before='FindRelatedProducts'>NOT Installed</Custom>
</InstallExecuteSequence> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-04-16T17:02:11.660

我实现了 Mike Fuchs 方法，虽然它在技术上确实有效（又名安装按预期运行），但该程序并未出现在其他用户的 APR 中。

在考虑这一点时，这是有道理的，因为安装程序如何知道所有每用户安装都已删除/更新到新的 perMachine 版本。

# svn - 使用 Subversion 作为大型开发公司的标准源代码控制存储库

> ID：678007
> 
> 赞同：5
> 
> 时间：2009-03-24T15:44:58.987
> 
> 标签：svn

我正在寻找以前的经验和最佳实践来建立一家大型开发公司以使用 Subversion 作为源代码控制存储库。

在这里，我指的是数百名开发人员/用户！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T15:48:44.157

*   从一开始就选择正确的目录结构 - 以后要更改它是一个婊子。
    *   我倾向于认为“最好的”是按项目组织的，每个项目下都有一个主干/标签/分支
*   每个人都不需要检查每个项目。只检查你需要什么
*   找出一些在开发人员之间共享工具的方法。像 SQL diff 程序这样的小东西可以从服务器上抓取 procs 并对其进行比较，这是非常宝贵的。
*   尽量不要让任何一个项目太大。尝试在 1GB 的文件夹中更新或提交计算时间很长
*   找出颠覆服务器的一些升级策略
*   当然备份您的存储库 - 具有完整的修订历史记录
*   Trac 对于将人们直接链接到 changelongs 和 diffs 很有用
*   让它变得有趣。周末在 repo 上运行关键字搜索，并绘制人们在代码中说脏话的频率。 [运行代码群](http://vis.cs.ucdavis.edu/~ogawa/codeswarm/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T16:36:43.997

我曾在一个团队工作，该团队在 3 个地理位置和数百名开发人员和 100 多个项目中实施了内部 Subversion 托管。一些关键的学习

1.  使用 Apache mod_svn 而不是 svnserve。然后，您可以将“颠覆身份验证”链接到 LDAP（或 ActiveDirectory 身份验证），这样团队就不必再记住一个登录名和密码了。

2.  在同一台服务器上创建多个存储库，而不是为每个项目创建一个具有不同子文件夹的大型存储库。这种方式简化了用户管理和访问控制。还简化了在完成项目时关闭和归档存储库的任务。

3.  我们开发了简单的 python cgi-scripts 来管理电子邮件通知和 RSS 提要的用户、权限和 svn-hook 脚本。这些脚本有助于项目团队更快地接受 svn。

4.  您可以放置​​一个反向代理，并从公司网络外部通过“https”访问选择性地公开少数项目。通过这种方式，外部供应商/承包商团队可以对项目进行受控访问。

总体而言，我们在大约一年内将所有项目团队转移到了新系统（包括从 CVS 和 Visual SourceSafe 等现有系统迁移数据）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T18:19:52.360

I totally agree to Nitin Bhide. My additions:

if you used to CVS some workflows in SVN are *very* different, for example *vendor branches*, which are non-existent in CVS, because you just deleted all files in the vendor folder and copy the new version inside. This will not work in SVN anymore.

Also if you are used to eclipse, a lot of things in subversive as in subclipse are different. You should train the users to get used to global revision numbers as the most difficult to grasp point for CVS users

Also important is a migration strategy to avoid stall time for developerteams if their repository migration was not successful

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T15:46:51.010

我工作的那家公司为数百名用户使用 Subversion，但没有自己的服务器。相反，它是来自[Collabnet](http://www.collab.net/)的托管服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T15:55:56.807

我已经看到数百名开发人员在数百个项目中使用 CVS，所以 svn 应该可以做到。我知道的唯一问题是用于工作目录及其备份的磁盘空间。

# string - 什么是用字符串播种 prng 的好的散列算法？

> ID：678013
> 
> 赞同：3
> 
> 时间：2009-03-24T15:45:53.807
> 
> 标签：string, hash, seed, prng

我正在寻找一种散列算法，它产生一个 31/32 位有符号/无符号整数作为 utf8 字符串的摘要，目的是使用输出播种 prng，例如 Park-Miller-Carta LCG 或 Mersenne-捻线机。

我研究过 FNV1 和 FNV1a，但它们为最后一个字符不同的相似字符串提供了非常接近的值；我希望有一个低冲突哈希，它会在对输入字符串的最小修改时彻底改变。性能不是问题。

我目前的方法包括使用字符代码和素数作为乘数的脏 LCG：

```
a = 524287;
for ( i = 0; i < n; i ++ )
a = ( a * string.charCodeAt ( i ) * 16807 + 524287 ) % 2147483647; 
```

请让我知道任何更好的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T15:57:28.490

使用[SHA-2](http://en.wikipedia.org/wiki/SHA1#SHA-256_.28a_SHA-2_variant.29_pseudocode)

它是目前最好/最新的散列算法。始终建议使用标准算法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T16:01:06.937

如果要生成 32 位值，请考虑使用经典 CRC32。FNV 应该是 CRC 的快速替代品，你是说，性能不是问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T16:36:36.850

任何加密的强哈希都将具有您想要的属性，但会生成更多位，但将结果简单截断为 32 位就可以了。我认为加密强度不是实际要求，因此像 MD5 这样有缺陷（但被广泛使用）的哈希方案就足够了——并且在许多库中很容易获得。

# perl - 为什么 Win32::TieRegistry 不能列出子键？

> ID：678015
> 
> 赞同：3
> 
> 时间：2009-03-24T15:46:27.423
> 
> 标签：perl, winapi, registry, tie

使用 Cygwin Perl v5.8.8 和 Win32::TieRegistry 0.26。

我们可以为 HKEY_CURRENT_USER 获得一个绑定的哈希对象：

```
$ perl -e '
my %RegHash;
use Win32::TieRegistry( TiedHash => \%RegHash );
use Data::Dumper;
my $Key = $RegHash{"HKEY_CURRENT_USER"};
print Dumper $Key;'
$VAR1 = bless( {}, 'Win32::TieRegistry' ); 
```

这适用于子键：

```
$ perl -e '
my %RegHash;
use Win32::TieRegistry( TiedHash => \%RegHash );
use Data::Dumper;
my $Key = $RegHash{"HKEY_CURRENT_USER\\Software"};
print Dumper $Key;'
$VAR1 = bless( {}, 'Win32::TieRegistry' ); 
```

我们可以打印密钥的信息：

```
$ perl -e '
my %RegHash;
use Win32::TieRegistry( TiedHash => \%RegHash );
use Data::Dumper;
my $Key = $RegHash{"HKEY_CURRENT_USER\\Software"};
print Dumper $Key->Information;'
$VAR1 = 'CntSubKeys';
$VAR2 = 48;
$VAR3 = 'MaxSubClassLen';
$VAR4 = 21;
... 
```

然而文档暗示我们可以简单地通过将其视为哈希来列出子键：

```
$ perl -e '
my %RegHash;
use Win32::TieRegistry( TiedHash => \%RegHash );
use Data::Dumper;
my $Key = $RegHash{"HKEY_CURRENT_USER\\Software"};
print Dumper keys %$Key; ' 
```

但是数组是空的。是坏了还是我做错了什么？还有另一种列出子键的方法吗？

这也不起作用：

```
$ perl -e '
my %RegHash;
use Win32::TieRegistry( TiedHash => \%RegHash );
use Data::Dumper;
my $Key = $RegHash{"HKEY_CURRENT_USER\\Software"};
print Dumper $Key->SubKeyNames;'
Can't use an undefined value as an ARRAY reference at
/usr/lib/perl5/vendor_perl/5.8/cygwin/Win32/TieRegistry.pm line 720. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:30:16.163

使用您的代码：

```
my %RegHash;
use Win32::TieRegistry( TiedHash => \%RegHash );
use Data::Dumper;
my $Key = $RegHash{"HKEY_CURRENT_USER\\Software"};
print Dumper keys %$Key; 
```

我在我的机器上得到了这个结果（WinXP，ActiveState Perl v5.10.0，Win32-TieRegistry 0.25）：

```
$VAR1 = 'Adobe\\';
...
$VAR101 = 'Classes\\';
$VAR102 = '\\'; 
```

这就是我从您的第二个代码示例中得到的：

```
$VAR1 = 'Adobe';
...
$VAR101 = 'Classes'; 
```

因此，至少在 ActiveState Perl 和 Windows XP 上，您的两个代码示例都可以正常工作。

编辑：这看起来像一个更普遍的问题/错误：

*   [TieRegistry 模块无法枚举](http://community.activestate.com/forum-topic/tieregistry-module-fails)community.activestate.com 上的值
*   prlmnks.org上的 Win32::TieRegistry[错误（还是我？）](http://prlmnks.org/html/495251.html)
*   weblog.siliconrebrate.com 上[的一篇博文](http://weblog.siliconcerebrate.com/cerebrate/2008/02/scripting_games_event_2beginne.html)
*   整个事情似乎与Windows Vista有关

# ruby-on-rails - 你对使用 Rails 脚手架生成器的看法

> ID：678019
> 
> 赞同：6
> 
> 时间：2009-03-24T15:46:58.623
> 
> 标签：ruby-on-rails

我正在尝试学习 Ruby on Rails。我对基础知识和编写自己的模型、控制器和视图非常有信心，尽管我只知道基础知识。

最近我发现，当我开始一个新的应用程序时，我的大多数模型都很好地符合 REST 哲学，而且我最终还是手动编写了大部分相同的脚手架生成的代码。在这种情况下，您认为从使用`script/generate scaffold`我所需的每个模型开始，然后根据需要修改代码是否可以接受？我所看到的普遍观点似乎是脚手架是一种“新手技巧”，真正的开发人员不会使用它，但对于大多数应用程序来说，它似乎创建了相当多的可用代码（而不是糟糕的代码） .

你怎么认为？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T16:13:05.330

我不确定这种文化是否真的反对脚手架，但我，一方面，喜欢它。

现在，我所知道的是，有一段时间对脚手架有一种小小的反弹。这是因为基本上每个 Rails 教程基本上都是“哇，只需键入

```
ruby script/generate scaffolding Post title:string body:text 
```

**你有一个**博客！完毕！'

实际上并非如此，社区开始撤回使用脚手架作为这种示例，因为当你这样做时，**你还没有完成**。

脚手架的真正力量，也是我喜欢它的原因，在于它的快速原型制作能力。您可以生成网站的一半，开始编写后端代码，并且仍然有一个可用的界面来实际玩弄一切是如何工作的，而不必担心编写界面代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:50:45.743

我认为这个想法是您使用它来生成“通用”代码，然后根据您的特定要求对其进行重写/重构。

~~我认为使用开箱~~即用的代码生成器没有问题，如果它可以满足您的需求 - 只要您从安全的角度记住它的全部功能（例如，如果您不希望您的界面允许这样做）

为了避免大量重复生成的代码，我喜欢的一件事是[make_resourceful](http://mr.hamptoncatlin.com/)插件 - 它抽象了重复的默认代码并允许您根据需要覆盖它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T15:55:30.210

脚手架仅适用于新手，这是一个神话。这是一个很好的工具，可以真正快速地启动您的应用程序。当然，您需要修改生成的代码以满足您的要求。话虽如此，拥有一个现成的代码并没有什么坏处，其中大部分将按原样使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T16:05:04.413

Rails 对选择智能默认值的狂热投入正是您观察到当您手写代码最终看起来像脚手架生成的代码的原因。就我个人而言，我真的很喜欢使用脚手架，因为对于那些真正基本的 CRUD 类型操作，最后只需要进行一些调整（布局、CSS、验证等）。

即使您遇到更复杂的事情，也很容易从脚手架开始并朝着您想要的方向前进。绝对不仅仅是新手的工具。

# c# - 编译后将属性注入 .NET 类

> ID：678024
> 
> 赞同：1
> 
> 时间：2009-03-24T15:47:40.587
> 
> 标签：c#, wpf, mvvm, postsharp, code-injection

我想在不引用 WPF 程序集的情况下实现 WPF 的 MVVM 模式的 ViewModel 部分。有问题的部分是命令路由，它要求 ViewModel 实现类型的属性，`ICommand`以便命令绑定可以工作。

现在，我可以避免`ICommand`并简单地将属性声明为`object`. 一切仍然有效，就是这样。但困扰我的是，**我仍然必须声明它们**，我真的不想这样做，因为它们感觉就像**样板代码**。

我的 ViewModel 目前看起来像这样：

```
public class HelloWorldViewModel : ViewModel
{
    [BoundProperty]
    public string Name { get; set; }

    [CommandHandler("SayHello")]
    public bool CanSayHello()
    {
        return Name != "" && Name != null;
    }

    [CommandHandler("SayHello")]
    public void SayHello()
    {
        View.ShowMessage("Hello, {0}!", Name);
    }

    public object SayHello { get; private set; }
} 
```

启用命令处理程序（一个和一个可选）的`CommandHandlerAttribute`运行时发现，而实际上是将自身注入属性设置器和调用的**一个方面**。我通过使用**编译时 IL weaver**来实现这一点。`Action``Func<bool>``BoundPropertyAttribute`**`INotifyPropertyChanged`**

 ****理想情况下，我也想隐含最后一行（SayHello 属性）。如果不是 WPF 的要求，那么将它放在源代码中是没有意义的。

因此，很自然地，我正在考虑使用`CommandHandlerAttribute`方面将必要的 IL 注入到类中，并从本质上**创建属性 post-compile**。这是相当困难的，尽管一个好的 IL 编织器（例如**PostSharp**）可以大大简化它。

在我踏上这段旅程之前，我想听听大家对我的方法的看法。好听吗？有没有更好的办法？你会/怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T16:33:29.057

对我来说，这听起来太聪明了。发生了太多的“魔术”。特别是，我不喜欢您的 CommandHandlerAttribute 的魔术字符串和其他方面。也就是说，如果我要走这条路，我会使用类似于 EventAggregator 的东西，但用于命令。IOW，SayHello 根本不存在于您的 ViewModel 上。任何魔术都会创建与 SayHell() 和 CanSayHello() 的命令绑定，而是将命令定位在全局 CommandAggregator 中。只要我们为此使用魔术字符串，CommandAggregator 中的命令就可以被延迟创建，因此您不需要“样板”编码。剩下的就是创建一些 XAML 魔法（标记扩展）来指定 ICommandSource 上的命令。

```
<Button Command="{my:AggregateCommand SayHello}"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-05T12:05:57.143

我建议您看看这是如何实施的，它将有所帮助：

**“一种魔法”** 毫不费力的 INotifyPropertyChanged

[http://visualstudiogallery.msdn.microsoft.com/d5cd6aa1-57a5-4aaa-a2be-969c6db7f88a][1]

作为将其添加到一个属性的示例：

```
[Magic] 
public string Name { get { return _name; } set { _name = value; } } 
string _name; 
```

将其添加到所有类属性的另一个示例：

```
[Magic] 
public class MyViewModel: INotifyPropertyChanged 
{ 
  public string Name { get; set; } 
  public string LastName { get; set; } 
  ..... 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T16:19:39.950

玩了 Prism 一段时间后，但在我看起来像 MVVM 之前，我想出了一个我仍然认为有一定有效性的策略：

我创建了一个基于反射的 ICommand 接口的实现。构造函数接受一个目标对象和一个操作名称。使用反射，代码查找名称为“[operation]”的方法、名称为“Can[operation]”或“[operation]Enabled”的属性或方法以及名称为“Can[operation]Changed”或“[操作]启用更改”。只有第一个是必需的，但反射的方法/属性/事件被连接到 ICommand 接口的一个非常基本的实现。

然后，我创建了 IValueConverter 的实现，它将创建前一个类的实例，将要转换的值作为目标对象传递，转换器的参数是操作名称。

有了上述组件，我就可以将按钮的 Command 属性直接绑定到操作的源（以及指定转换器），并将按钮的 CommandParameter 属性设置为操作的名称。通过这种方式，我获得了声明性命令绑定，而命令源没有任何 WPF 的肉体知识。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T15:54:06.750

我个人认为这很有趣，但我一般会避免它。

避免样板代码（或感觉像样板代码的代码）会产生后果。这似乎是个好主意，因为您不会不断地重新输入内容，但从长远来看，您会降低它的可读性和可理解性。

就个人而言，我尝试设置好的代码模板来为我插入样板代码，并将其包装在区域中，以便我可以将其隐藏在源代码中。在这种情况下，用样板文件填写文件所需的 30 秒（对我而言）比两年后我试图理解代码时花费的 2 小时更痛苦，或者更糟糕的是，两周后有人else 两年后，当他们试图理解我的代码时......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T17:52:11.643

我认为最好的方法是代理或装饰器模式。您可以在运行时使用 UI/WPF 成员包装/装饰的低级实体。这是最简单但有效的方法，可以节省您的时间，并且不用担心框架、注入等。

唯一的事情是您必须设计一些小型基础设施来用适当的装饰器包装您的实体。

# .net - Windows Mobile 中的 .net 内存不足异常 - 如何解决此问题？

> ID：678025
> 
> 赞同：0
> 
> 时间：2009-03-24T15:47:47.670
> 
> 标签：.net, email, windows-mobile, memory-management, compact-framework

我目前正在使用 CF.NET 在 Windows Mobile 中编写一个小型应用程序。

该应用程序的行为与电子邮件应用程序非常相似，即我使用 POP3 从我的邮件服务器帐户下载消息和附件，以存储在存储卡上，以便使用 MIME 工具进行进一步处理。

我的问题是下载大型附件，因为在某个时候我得到了 OutOfMemory 异常。[通过阅读前几天在此处](https://stackoverflow.com/questions/673526/sql-ce-outofmemoryexception-consuming-web-service "这里")发布的以下问题和答案，我发现了一些有趣的事情。由于我的附件可以达到 4-5MB（mp3 歌曲），我意识到我遇到了严重的问题。但是，同时 Pocket Outlook 能够毫无问题地下载高达 4-5MB 的 mp3 歌曲（使用 WIFI 连接），所以一定有办法做到这一点！

目前，我将下载缓冲区（转换为字符串）保存到一个简单的字符串变量中。我尝试将缓冲区的内容添加到字符串生成器中，但仍然出现 OutOfMemory 异常。

我可以采用什么策略/技术来克服这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T15:52:10.450

每当您处理大量数据时，您都希望确保不会一次将整个数据保存在内存中。

您的下载管道是一个流，因此您可以分块加载数据。将文件写入磁盘时，您有一个流，因此您可以一次写入一个块。

想想将拖拉机拖车卸载到仓库中。使用您的 stringbuilder 解决方案，您基本上是在说，“我将站在拖车的后面，我希望您将拖车的全部内容装载到我的怀里，然后我会把它带入仓库” . 你会被负载压垮的！相反，您想要的是，“给我足够我可以实际携带的量，然后我将它带入仓库，然后再回来进行下一次装载”。

# php - 通过引用将变量传递到 PHP 扩展

> ID：678026
> 
> 赞同：8
> 
> 时间：2009-03-24T15:47:49.743
> 
> 标签：php, pass-by-reference, php-extension

我正在编写一个 PHP 扩展，它引用一个值并改变它。示例 PHP：

```
$someVal = "input value";
TestPassRef($someVal);
// value now changed 
```

什么是正确的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T15:54:00.463

**编辑 2011-09-13**：执行此操作的正确方法是使用`ZEND_BEGIN_ARG_INFO()`宏系列 - 请参阅[扩展和嵌入 PHP 第 6 章（Sara Golemon，开发人员库）](https://rads.stackoverflow.com/amzn/click/com/067232704X)。

此示例函数通过值（由于`ZEND_ARG_PASS_INFO(0)`调用）获取一个字符串参数，之后通过引用获取所有其他参数（由于第二个参数为`ZEND_BEGIN_ARG_INFO`1）。

```
const int pass_rest_by_reference = 1;
const int pass_arg_by_reference = 0;

ZEND_BEGIN_ARG_INFO(AllButFirstArgByReference, pass_rest_by_reference)
   ZEND_ARG_PASS_INFO(pass_arg_by_reference)
ZEND_END_ARG_INFO()

zend_function_entry my_functions[] = {
    PHP_FE(TestPassRef, AllButFirstArgByReference)
};

PHP_FUNCTION(TestPassRef)
{
    char *someString = NULL;
    int lengthString = 0;
    zval *pZVal = NULL;

    if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "sz", &someString, &lengthString, &pZVal) == FAILURE)
    {
        return;
    }

    convert_to_null(pZVal);  // Destroys the value that was passed in

    ZVAL_STRING(pZVal, "some string that will replace the input", 1);
} 
```

在添加之前，`convert_to_null`它会在每次调用时泄漏内存（我不知道添加`ZENG_ARG_INFO()`调用后是否有必要）。

# c - 如何避免类似 ISR 之间的代码重复？

> ID：678033
> 
> 赞同：0
> 
> 时间：2009-03-24T15:48:50.287
> 
> 标签：c, refactoring, embedded

我有两个中断服务例程 (ISR)，它们基本上做同样的事情，但每个都处理来自不同设备的中断（尽管设备类型相同）。因此，逻辑是相同的，但它们访问不同的 CPU 寄存器和内存位置。

作为一个简单的示例，请考虑以下代码：

```
extern volatile unsigned int dev1_rx_buffer;
extern volatile unsigned int dev2_rx_buffer;

volatile unsigned char data;

void __attribute__((__interrupt__)) _dev1_interrupt(void)
{
    /* Clear interrupt flag */
    dev1.IF = 0;

    if (dev1.IS_FULL) {
         /* Read data from device */
         data = dev1_rx_buffer;
    } else {
         /* do something else using registers of device 1 */
    }
    /* More stuff using registers of device 1 */
}

void __attribute__((__interrupt__)) _dev2_interrupt(void)
{
    /* Clear interrupt flag */
    dev2.IF = 0;

    if (dev2.IS_FULL) {
         /* Read data from device */
         data = dev2_rx_buffer;
    } else {
         /* do something else using registers of device 2 */
    }
    /* More stuff using registers of device 2 */
} 
```

如何使用适用于 ISR 的限制来避免代码重复（即我不能将参数传递给 ISR，并且应该避免函数调用，因为它们的开销）。

我曾考虑编写一个模板，使用更高级别的脚本语言从中生成两个 ISR，但我更喜欢仅使用 C 或 C 预处理器宏的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T16:27:44.187

在这种情况下，我通常让 ISR（向量入口点）的前端设置一个指向设备特定块的指针，然后使用指向该块的指针调用公共代码。

大致（不用担心 ISR 语法等）

```
void __attribute__((__interrupt__)) Isr1(void)
{
   CommonISR(&dev1info);
}

void __attribute__((__interrupt__)) Isr2(void)
{
   CommonISR(&dev2info);
}

void CommonISR(Foo *devptr)
{
    devptr->count = 0;
    devptr->reset();
    etc...
} 
```

dev1info 和 dev2info 在启动时配置/初始化；他们可能有指向硬件寄存器等的指针……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T15:58:32.120

如果他们正在处理相同类型的设备，那么只有一个中断处理程序处理多个中断是非常合理的。您可以检查在顶部设置了哪个标志并从那里继续。但是，如果两个中断处理程序用于不同类型的设备并且具有相同的逻辑流程，我不建议这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T15:59:21.760

为什么不使用内联辅助函数来获取指向设备和缓冲区的指针？

不过，我会检查生成的程序集以确保编译器符合我的预期。

您也可以使用宏，但恕我直言，对这么长的函数执行此操作并不好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T16:29:36.460

你确定你的编译器不会优化函数调用吗？
您当然可以使用宏自动生成此代码，但会有点难看：

```
#define __CONCAT(a,b)    a ## b

#define ISR_DECLARE(name) \
\
void __attribute__((__interrupt__)) _CONCAT(name,_interrupt)(void) \
{ \         
    /* Clear interrupt flag */ \
    name.IF = 0; \
    \
    if (name.IS_FULL) \
    { \
        /* Read data from device */ \
        data = _CONCAT(name, _rx_buffer); \
    } \
    else \
    { \
        /* do something else using registers of device 1 */ \
    }\ 
    /* More stuff using registers of device 1 */ \ 
```

}

进而：

```
ISR_DECLARE(dev_1)

ISR_DECLARE(dev_2) 
```

但我强烈建议首先检查您的编译器是否会使用内联优化代码，如之前的帖子中所建议的那样。

# ruby - 允许在类定义中执行“class << self; def foo; end; end”的方法和运算符在哪里定义？

> ID：678037
> 
> 赞同：3
> 
> 时间：2009-03-24T15:50:08.617
> 
> 标签：ruby

这是如何解释的？我可以用其他对象替换 self 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T17:18:45.313

这种语法在 ruby​​ 中用于访问对象的元类或单例类。元类用于存储单个对象的方法。

```
obj = # whatever...
class <<obj
  # here, self is defined as obj's metaclass
  # so foo will be an instance method of obj's metaclass
  # meaning that we can call obj.foo
  def foo
    # ...
  end
end
# this is equivalent to the above
def obj.foo
  # ...
end 
```

这是语言的核心部分，没有在任何库中定义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T20:00:56.017

另请参阅 _why 对元类的解释：

[http://whytheluckystiff.net/articles/seeingMetaclassesClearly.html](http://whytheluckystiff.net/articles/seeingMetaclassesClearly.html)

同样关于“自我”和替换它，我已经看到这提到了其他一些地方 - 我很难为该功能想到一个好的用例，尽管它肯定会让我感到困惑。也许有一个。在任何情况下，在 Ruby 中尝试更改“self”的值都是无效的语法：

```
>> self = Object.new
SyntaxError: compile error
(irb):1: Can't change the value of self
self = Object.new
     ^
from (irb):1
from :0 
```

在 Ruby 和所有其他具有“self”或“this”概念的语言中，它被用作指向“here”的指针，例如当前对象、类、元类或任何代表什么的对象“这里”的意思。由于 Ruby 是逐行解释的，因此当编译器遇到该关键字时，“self”表示封闭对象。

```
class Array
  self # Means Array class (which is an object, actually)

  def self.class_method
    self # still means Array class, since you're in a class method
  end

  def hello
    self # Means the current instance of Array
  end

  class << self
    self # Means the metaclass (or "eigenclass") of the Array
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T17:27:31.690

您使用该语法来添加您在类上调用的类方法，而不是在该类的特定实例上。

例如：

```
 class Foo
    class << self
      def do_foo
        # something useful
      end
    end
  end 
```

现在，即使您没有 Foo 类型的对象，您也可以调用 Foo.do_foo。

这是等价的：

```
 class Foo
    def self.do_foo
      # something useful
    end
  end 
```

# perl - 如何在 Perl 中更改文件名的大小写？

> ID：678038
> 
> 赞同：2
> 
> 时间：2009-03-24T15:50:25.557
> 
> 标签：perl, filenames

我正在尝试创建一个将我的所有文件名重命名为 Camel/Capital Case 的过程。我必须到达那里最接近的是：

```
perl -i.bak -ple 's/\b([a-z])/\u$1/g;' *.txt # or similar .extension. 
```

这似乎创建了一个备份文件（我将在验证这符合我的要求时将其删除）；但不是重命名文件，而是重命名文件内的文本。有没有更简单的方法来做到这一点？理论是我有几个不同格式的办公文件，因为我有点保持肛门，并希望它们看起来像这样：

```
新文档.odt
罗弗勒.ogg
等等等等
鲍勃·卡特.flac
猫狗.avi

```

perl 可以做到这一点，还是我需要更改为另一种语言/它们的组合？

另外，是否有办法使这个递归，例如 /foo/foo/documents 重命名所有文件，就像 /foo/foo/documents/foo 一样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-24T15:51:42.170

您需要使用**[重命名](http://perldoc.perl.org/functions/rename.html)**。

这是它的签名：

```
 rename **OLDNAME,NEWNAME** 
```

要使其递归，请将其与**[File::Find一起使用](http://search.cpan.org/perldoc?File::Find)**

```
 use strict;
use warnings;
use File::Basename;
use File::Find;

#default searches just in current directory
my @directories = (".");

find(\&wanted,  @directories);

sub wanted {
  #renaming goes here
} 
```

下面的代码片段将针对找到的所有文件执行内部**想要的代码。**你必须完成一些代码里面**想做**你想做的事情。

编辑：我尝试使用 File::Find 来完成这项任务，但我认为你不能轻易实现它。您可以按照以下步骤成功：

*   如果参数是目录，则大写，获取所有文件

*   对于每个文件，如果是目录，则以该文件作为参数返回开头

*   如果文件是普通文件，则大写

Perl 只是在编写这个脚本时妨碍了我。我用 ruby​​ 写了这个脚本：

```
 require "rubygems"
require "ruby-debug"

# camelcase files

class File
    class << self
        alias :old_rename :rename
    end

    def self.rename(arg1,arg2)
        puts "called with #{arg1} and #{arg2}"
        self.old_rename(arg1,arg2)
    end
end

def capitalize_dir_and_get_files(dir)
    if File.directory?(dir)
        path_c          = dir.split(/\//)
        #base           = path_c[0,path_c.size-1].join("/")
        path_c[-1].capitalize!  
        new_dir_name    = path_c.join("/")
        File.rename(dir,new_dir_name)
        files = Dir.entries(new_dir_name) - [".",".."]
        files.map! {|file| File.join(new_dir_name,file)}
        return files 
    end
    return []
end

def camelize(dir)
    files = capitalize_dir_and_get_files(dir)
    files.each do |file|
        if File.directory?(file)
            camelize(file.clone)
        else
            dir_name    = File.dirname(file)
            file_name   = File.basename(file)
            extname     = File.extname(file)
            file_components = file_name.split(/\s+/)
            file_components.map! {|file_component| file_component.capitalize}           
            new_file_name = File.join(dir_name,file_components.join(" "))
            #if extname != ""
            #   new_file_name += extname
            #end
            File.rename(file,new_file_name)
        end
    end
end

camelize(ARGV[0]) 
```

我在我的电脑上尝试了这个脚本，它按照你提到的规则将所有目录、子目录和文件大写。我认为这是您想要的行为。很抱歉没有提供 perl 版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T09:49:38.537

大多数系统都有重命名命令....

NAME rename - 重命名多个文件

概要 重命名 [ -v ] [ -n ] [ -f ] perlexpr [ 文件 ]

描述 "rename" 重命名根据指定为第一个参数的规则提供的文件名。perlexpr 参数是一个 Perl 表达式，它被期望为至少一些指定的文件名修改 Perl 中的 $_ 字符串。如果给定的文件名没有被表达式修改，它不会被重命名。如果命令行上没有给出文件名，文件名将通过标准输入读取。

```
 For example, to rename all files matching "*.bak" to strip the extension, you might say

           rename 's/\.bak$//' *.bak

   To translate uppercase names to lower, you’d use

           rename 'y/A-Z/a-z/' * 
```

选项 -v，--verbose 详细：打印成功重命名的文件名。

```
 -n, --no-act
           No Action: show what files would have been renamed.

   -f, --force
           Force: overwrite existing files. 
```

作者拉里·沃尔

诊断 如果你给出一个无效的 Perl 表达式，你会得到一个语法错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T16:00:53.660

由于 Perl 在多个平台上运行良好，让我警告您 FAT（和 FAT32 等）文件系统将忽略仅更改文件名大小写的重命名。这在 Windows 和 Linux 下是正确的，对于支持 FAT 文件系统的其他平台可能也是如此。

因此，除了[Geo's answer](https://stackoverflow.com/questions/678038/how-to-change-filename-case/678045#678045)之外，请注意您可能必须实际更改文件名（例如，通过在末尾添加一个字符），然后将其更改回您想要的名称，并使用正确的大小写。

如果您只重命名 NTFS 文件系统或 ext2/3/4 文件系统（或其他 UNIX/Linux 文件系统）上的文件，那么您可能不需要担心这一点。我不知道 Mac OSX 文件系统是如何工作的，但由于它基于 BSD，我认为它只允许您通过更改名称的大小写来重命名文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T16:21:01.793

另一个：

```
find . -type f -exec perl -e'
  map {
        ( $p, $n, $s ) = m|(.*/)([^/]*)(\.[^.]*)$|;
        $n =~ s/(\w+)/ucfirst($1)/ge;
        rename $_, $p . $n . $s;
      } @ARGV
  ' {} + 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T20:30:07.023

我只是使用 find 命令递归子目录和 mv 进行重命名，但仍然利用 Perl 来获得正确的重命名。

```
find /foo/foo/documents -type f \
     -execdir bash -c 'mv "$0" \
                          "$(echo "$0" \
                              | perl -pe "s/\b([[:lower:]])/\u\$1/g; \
                                          s/\.(\w+)$/.\l\$1/;")"' \
              {} \; 
```

神秘，但它有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T16:42:24.003

请记住，在记住大小写的文件系统 (FAT/NTFS) 上，您需要先将文件重命名为其他名称，然后再更改大小写。从“etc.etc”直接重命名为“Etc.Etc”将失败或被忽略，因此您需要进行两次重命名：“etc.etc”为“etc.etc~”，然后为“etc.etc~”例如，“Etc.Etc”。

# debugging - 在 Workflow Foundation (WF) 设计器中设置断点

> ID：678055
> 
> 赞同：1
> 
> 时间：2009-03-24T15:54:10.227
> 
> 标签：debugging, workflow-foundation

当外部调用时，您不能在 VS.NET 2008 工作流设计器中为存储在库中的工作流打断点，这是真的吗？

我在同一个解决方案中有一个顺序工作流库项目和一个控制台应用程序项目。我使用如下代码（VB.NET）从应用程序调用工作流：

```
Dim wr As WorkflowRuntime = New WorkflowRuntime()
Dim wi As WorkflowInstance = _
    wr.CreateWorkflow(GetType(PaymentWorkflow), parameters)
wi.Start() 
```

我将控制台应用程序设置为启动项目，并在工作流设计器中为以这种方式调用的工作流设置了一个断点，但我得到了可怕的“断点不会被命中”符号，实际上，它没有被命中。

不能调试以这种方式调用的工作流吗？我希望这不是真的，因为我的目标是创建一个将从外部进程调用的工作流库，而且我肯定需要调试它们。

谢谢你，比尔道森

（环境：VS.NET 2008 SP (9.0.30729.1)、.NET 3.5 SP1，并安装了用于调试的 KB957912 补丁。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:19:01.223

您需要做的是将您的库与工作流一起设置为您的启动程序。现在进入项目设置并告诉它在使用调试选项卡中的启动外部程序运行时执行您的控制台应用程序。这样，调试器将在您的工作流程中的断点处停止，并允许您单步执行它们。

# oracle - 使用 CLOB 绑定通过 JDBC 执行 sql 语句

> ID：678060
> 
> 赞同：1
> 
> 时间：2009-03-24T15:55:51.177
> 
> 标签：oracle, jdbc, clob, sqlbindparameter, ora-01461

我有以下查询（列日志的类型为 CLOB）：

```
UPDATE table SET log=? where id=? 
```

当使用 setAsciiStream 方法将超过 4000 个字符的值放入日志列时，上面的查询可以正常工作。

但是我不想替换该值，而是想附加它，因此我的查询如下所示：

```
UPDATE table SET log=log||?||chr(10) where id=? 
```

上面的查询不再起作用，我收到以下错误：

```
java.sql.SQLException: ORA-01461: can bind a LONG value only for insert into a LONG column 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:33:23.410

BLOB 在 SQL 中是不可变的（嗯，除了将它们设置为 NULL），因此要追加，您必须先下载 blob，在本地连接，然后再次上传结果。

通常的解决方案是使用一个公共键和一个告诉数据库如何对行进行排序的序列将几条记录写入数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T22:44:51.020

在我看来，你必须使用 PL/SQL 块来做你想做的事。以下对我有用，假设有一个条目为`id`1：

```
import oracle.jdbc.OracleDriver;
import java.sql.*;
import java.io.ByteArrayInputStream;

public class JDBCTest {

    // How much test data to generate.
    public static final int SIZE = 8192;

    public static void main(String[] args) throws Exception {

        // Generate some test data.
        byte[] data = new byte[SIZE];
        for (int i = 0; i < SIZE; ++i) {
            data[i] = (byte) (64 + (i % 32));
        }

        ByteArrayInputStream stream = new ByteArrayInputStream(data);

        DriverManager.registerDriver(new OracleDriver());
        Connection c = DriverManager.getConnection(
            "jdbc:oracle:thin:@some_database", "user", "password");

        String sql =
            "DECLARE\n" +
            "  l_line    CLOB;\n" +
            "BEGIN\n" +
            "  l_line := ?;\n" +
            "  UPDATE table SET log = log || l_line || CHR(10) WHERE id = ?;\n" +
            "END;\n";

        PreparedStatement stmt = c.prepareStatement(sql);
        stmt.setAsciiStream(1, stream, SIZE);
        stmt.setInt(2, 1);
        stmt.execute();
        stmt.close();

        c.commit();

        c.close();
    }
} 
```

# java - 在 Obj-C 中实现类似 Java 的 ByteBuffer 的最佳方法是什么？

> ID：678069
> 
> 赞同：3
> 
> 时间：2009-03-24T15:57:37.770
> 
> 标签：java, objective-c, porting

我正在尝试为 iPhone 构建一个应用程序，尽管我对 Obj-C 完全陌生。对于一个问题，我会在 Java 中使用 ByteBuffer，但我在 Apple 的文档中没有看到任何合适的类。所以我可能必须自己实现它。

我的问题是，如何做到最好：

*   Obj-C 中有类似的类吗？（那将是最好的解决方案；））
*   我应该使用像 NSData 这样的 Obj-C 类吗？
*   还是我应该继续使用纯 C 代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T16:12:53.367

你可能想要 NSMutableData。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T17:29:32.433

`java.nio.ByteBuffer`我对（从很久以前使用 Java 开始）的回忆是，它`ByteBuffer`实现了对字节数组的顺序读/写。这类似于`NSInputStream`由`NSData`（用于输入）支持的：

```
NSInputStream *inputStream = [NSInputStream inputStreamwithData:myData]; //assuming myData is NSData*

float myFloat;

if([inputStream hasBytesAvailable]) { // NO if you've already read to the end of myData
  NSInteger bytesRead = [inputStream read:&myFloat maxLength:sizeof(myFloat)];
  NSAssert(bytesRead == sizeof(myFloat);
} 
```

您可以通过`NSOutputStream`写入`NSData`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-06T17:54:05.527

我有一个类似的问题。[伊利亚用他的回答指出我这里](https://stackoverflow.com/a/18658871/529543)。

> 我的目标是实现一个功能齐全的 Obj-C 版本的 java.nio.ByteBuffer。只是想知道我应该用什么来到达那里

那将是您的自定义课程。

对于我的情况，我认为`NSInputStream`并且`NSOutputStream`应该使用。肯定不是`NSMutableData`如何被接受且大多数人赞成的答案。

# asp.net - 免费商业测绘服务

> ID：678076
> 
> 赞同：1
> 
> 时间：2009-03-24T15:59:18.547
> 
> 标签：asp.net

任何人都有使用以下任何一种的经验；

MapQuest 平台： http: [//platform.mapquest.com](http://platform.mapquest.com)

开放层：http : [//openlayers.org](http://openlayers.org)

您会推荐以上哪一项，对使用该服务有任何反馈？

还是您认为值得从 Virtual Earth 或 Google Maps 购买商业许可，在线获取更多可用文档，让更多用户从 API 中获取知识和帮助？

成本是一个明显的问题，因此我们正在寻找免费的商业选项。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:13:11.213

当我的公司对此进行评估时，我们最终购买了谷歌地图。

*   Mapquest，在我的偏见看来，看起来像垃圾。
*   每个人都已经熟悉的谷歌地图，运行良好，并且拥有庞大的爱好者社区
*   我们负担得起

也就是说，谷歌地图很贵，起价 10K。我们从未讨论过 VE 的合同，所以我不知道他们收取什么费用。

您需要考虑的另一件事是您是否要在地图上放置数百或数千个标记。如果是这样，任何解决方案都不会为您提供开箱即用的解决方案 - 它们在 javascript 中运行速度太慢。在这种情况下，您需要在服务器上的自定义图块集或图块叠加层中添加标记。而且我怀疑有很多与此相关的延迟问题。

OpenLayers 与[OpenStreetMap](http://www.openstreetmap.org/)结合可能足以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-02T08:42:25.643

OpenLayers 不能直接与其他映射提供程序进行比较。它只是一个显示各种地图的前端脚本，它不包含它自己的任何地图。您可以使用各种免费和商业地图（例如 OpenStreetMap.org），它还能够嵌入 Yahoo 地图或 Google 地图等内容，并为所有这些地图提供相同的 API。

# smalltalk - 海边编程和其他网络编程有什么区别

> ID：678082
> 
> 赞同：10
> 
> 时间：2009-03-24T16:02:09.290
> 
> 标签：smalltalk, seaside, aida

对我来说，Seaside 的主要观点似乎是它更像是普通的“桌面”编程。

控制流看起来更像“传统”编程而不是“网络”编程。这是正确的印象吗？

我知道它是关于 Web 编程的，但从程序员的角度来看，它看起来不像。它看起来不仅仅是驱动“桌面”应用程序。这是否稍微澄清了这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-24T21:43:17.177

Seaside 的重点并不是真正类似于桌面编程，尽管它确实试图消除 Web 开发的大部分痛苦。Seaside 以您可能认为“类似桌面应用程序”的两件事而闻名：

1.  使用延续来允许您编写提示用户输入信息的多步骤流程
2.  每当单击链接、提交表单等时，使用块（闭包）在代码中提供类似事件处理程序的“回调”。

这些东西极大地简化了某些 Web 开发任务，尽管第一个最终在实践中很少使用。

不过，Seaside 提供了许多其他功能：

*   在 Smalltalk 中编写 Web 应用程序的能力（非常高效和愉快）
*   可组合、可重复使用的“组件”
*   组件可以委托给其他组件，它只替换页面的那部分
*   会话状态的轻松管理和某些状态可以在用户使用后退按钮时标记为回滚，因此在执行回调时它始终具有正确的值
*   一个非常好的 Canvas API，用于以编程方式生成 HTML、JQuery、Scriptaculous
*   能够在运行的站点上实时调试和修复错误

其中大多数不是 Seaside 独有的，但它们有些不寻常。那么它与其他网络编程有什么不同呢？你可以在 Smalltalk 中写作。您不必在代码和模板语言之间来回转换上下文。您不必担心表单字段名称、URL 等，除非/直到您愿意。如果您使用 Seaside，您可能不会那么讨厌 Web 编程。

人们可能会因为 Seaside 的“桌面编程功能”而发现它，但他们通常会为所有其他东西闲逛。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-24T21:08:07.277

你的印象是正确的。Seaside 是为我所说的树状控制流而设计的，就像桌面 GUI 应用程序一样。与另一个 Smalltalk Web 框架[Aida/Web](http://www.aidaweb.si)相比，它用于类似图形的控制流，这实际上就是您在 Web 上所拥有的。

但是树状控制流在诸如确认对话框之类的情况下非常有用，或者对于这些天在 Facebook 上非常频繁的弹出窗口非常有用。这也是我们在 Aida/Web 中引入树状控制流的原因，也就是说，我们将两个控制流结合在一起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T16:16:53.777

[Seaside](http://en.wikipedia.org/wiki/Seaside_software)是一个应用程序框架，用于开发用 smalltalk 编写的 Web 应用程序。看起来像“传统”编程是什么意思

**编辑**-

> *Seaside 架构*不同于它的网页构建为单独的、有状态的组件的树，每个组件都封装了页面的一小部分

# git - 如何从 USB 记忆棒运行 Git 1.6.x for Windows

> ID：678085
> 
> 赞同：12
> 
> 时间：2009-03-24T16:02:37.667
> 
> 标签：git, usb-drive

我想从 USB 记忆棒运行适用于 Windows 的 Git 1.6.x。

有一个 Windows 版本的 Git 可用：[http ://code.google.com/p/msysgit/](http://code.google.com/p/msysgit/)

从本地硬盘 c:\ 安装和运行它绝对没有问题。但是，我无法找出如何从 USB 记忆棒运行它。这篇[文章](http://osdir.com/ml/version-control.msysgit/2008-06/msg00079.html)建议人们可以从 c:\ 获取二进制文件并将它们复制到 USB 记忆棒。

我不明白的要点是：

1.  可以为 Git 设置全局设置，例如姓名和电子邮件地址：它们存储在哪里？%userprofile% 下的某个地方？
2.  假设我只是将二进制文件移动到 USB 记忆棒： Git 不会在 %userprofile% 下而不是我的 USB 驱动器下寻找 c:\ 上的全局设置，并且是否有路径设置（在某些 Git 配置文件中，而不是Windows 路径变量），例如可以指向 e:\git\settings，其中 e: 是我的 USB 驱动器？

谢谢你的任何提示。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-24T18:40:16.460

今天我去[msysgit 下载页面](http://code.google.com/p/msysgit/downloads/list)时，有一个“PortableGit”的下载链接，它是 2009 年 3 月 22 日新的。使用此版本可能会为您提供更多所需的控制。我没有尝试过，但顾名思义，它更适合 USB 记忆棒安装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T16:31:25.850

我认为这些存储在存储库本地副本的用户部分中。如果不是，那么您始终可以在 .git 目录中的用户设置中覆盖它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-22T16:06:06.160

[您可以使用来自http://code.google.com/p/msysgit/](http://code.google.com/p/msysgit/)的便携式版本

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T20:01:50.163

您的电子邮件地址、姓名和许多其他设置都存储在您主目录中的全局配置文件 .gitconfig 中。

[混帐配置](http://git-scm.com/docs/git-config)

也许 -f 选项可以帮助您指定配置文件的不同位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-14T13:12:59.423

我不确定，如果它与提到的应用程序相同，但由于 Google Code 不再存在，您可以尝试在 Sourceforge 上[移植 Git 。](https://sourceforge.net/projects/gitportable/)

# sql - 如何使用 SQL Server 2008 通过连续数据复制实现多个活动（读取和写入）站点（数据中心）？

> ID：678087
> 
> 赞同：0
> 
> 时间：2009-03-24T16:03:04.043
> 
> 标签：sql, database, sql-server-2008, replication, cluster-computing

我需要 SQL 在 2 个主动/主动数据中心 (DC) 上运行。这里有很多挑战要做，以下是我的要求。

1.  数据同步必须是异步的。（为了更高的性能）
2.  我需要能够在两个 DC 上读/写
3.  当 Site1 宕机时，所有流量都将路由到 Site2，当 Site1 恢复正常运行时，流量将再次共享。在这种情况下，数据必须在 1-2 小时内同步回来（显然基于停机时间）
4.  SQL 事务复制或其他 SQL 复制似乎不是一个好的选择，原因如下。一种。如果复制中断，重建复制将需要 500GB 传输到其他站点。湾。我们有时需要中断 repl 以进行更改，例如添加新表或更改主键。C。有时出于某种原因，复制会自行中断，甚至 MS 也无法找到解决方案。d。我不确定点对点复制是否会解决这个问题。e. 合并复制看起来很可怕，我们不太了解它的含义，我们不想携带额外的 GUID。
5.  今天将是 2 个 DC，但明天我们将添加更多 DC，并且有可能在欧洲和亚洲分别拥有一个。
6.  理想的复制延迟是 MAX 15 分钟。
7.  最重要的是，我需要一个没有头痛或最少的解决方案。
8.  我们正在获得 EMC 恢复点，但这在 ACTIVE/ACTIVE 方案中对我没有帮助，因为它只是 DR。
9.  我已经评估了以下产品，但没有一个产品在另一端为我提供了可行的数据库。

我将感谢您在此问题上的帮助。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T23:06:52.877

SQL Server 的唯一主动/主动选项是复制。在撰写本文时，SQL Server 没有其他主动/主动选项。

# visual-studio - VS Installer 添加不明依赖

> ID：678088
> 
> 赞同：0
> 
> 时间：2009-03-24T16:03:55.133
> 
> 标签：visual-studio, vb6, installation

我正在使用 Visual Studio Installer Enterprise Tools v6.0 中的 Visual Studio Installer 为 VB6 应用程序创建安装包。我的问题是安装程序在依赖项下添加了一个奇怪的项目，简称为“3”。该项目的“Sourcefile”和“Target”属性也仅显示为“3”。“ComponentId”属性值显示“{EC1441E1-073C-4AD6-886F-1C6C6E998CAD}”的 GUID，它没有显示在我 PC 上的 regedit 中的搜索中。我无法在 VB6 项目的引用或组件中识别出任何可以解释对仅名为“3”的文件的依赖关系的内容。

有没有人以前见过这个，或者对这种依赖可能来自哪里有所了解？

提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T16:28:18.260

可能是一些恶意软件 COM 组件！使用良好的防病毒软件对您的计算机进行彻底扫描。

哦，是的，如果它不是恶意软件，那么使用从注册表中注销依赖项

`regsvr32 /u <offending guid>`

然后重新运行您的应用程序以查看它是否崩溃（进行彻底测试），如果没有，那么您不需要它。如果确实如此，则调试并找出谁在使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-01T13:27:37.187

没有恶意软件 - 在网上搜索发现其他人有同样的问题，但没有解决方案。从那时起完成的构建不再具有依赖关系，因此它仍然是一个谜。

# .net - 在 web.config 中设置 debug=false 作为构建的一部分

> ID：678096
> 
> 赞同：6
> 
> 时间：2009-03-24T16:05:30.060
> 
> 标签：.net, asp.net, build-automation, nant

是否可以指示 aspnet_compiler 在 web.config 中设置 debug=false？

我的意图是将其作为 nant 构建过程的一部分自动化。我对 xml 解析以外的建议持开放态度

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T16:17:43.090

你有没有想过使用`<xmlpoke>`？

```
<xmlpoke file="${Build.WebConfig}" 
    xpath="/configuration/system.web/compilation/@debug" 
    value="false">
</xmlpoke> 
```

[NAnt 主页](http://nant.sourceforge.net/)

[XML 戳文档](http://nant.sourceforge.net/release/0.86-beta1/help/tasks/xmlpoke.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T16:21:51.143

我建议为每个环境使用完全不同的配置文件（在我们的例子中是 prod、test、staging）。根据构建，您只需使用所需的配置，没有混乱，少大惊小怪。[Hanselmen](http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx)有关于如何在 Visual Studio 中执行此操作的示例，如果您阅读了第一条评论，Phil Hack 已经将其与[NAnt](http://www.cptloadtest.com/2007/09/22/ManagingMultipleEnvironmentConfigurationsThroughNAnt.aspx)一起使用。

```
 <target name="configMerge">  
     <copy file="${sourcefile}"  
         tofile="${destinationfile}" overwrite="true">  
       <filterchain>  
         <expandproperties />  
       </filterchain>  
     </copy>  
   </target> 
```

此外，如果您使用的是 VS 2010，您现在可以使用[web.config 转换](http://weblogs.asp.net/gunnarpeipman/archive/2009/06/16/visual-studio-2010-web-config-transforms.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T16:14:55.170

我解决这个问题的方法是我为每个部署环境都有单独的配置文件：

*   生产
*   分期
*   发展

在“构建脚本”上，我复制了我正在构建的类型的配置文件。例如，在 Staging 中，我会将 /configs/staging/*.config 复制到网站的根目录中。然后，我的脚本会调用 aspnet_compiler 来编译应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T16:30:49.813

我一直在使用这个工具作为我构建链的一部分。它允许基于构建设置在单个 xml 文件中进行条件配置设置。

[http://xmlpreprocess.sourceforge.net/](http://xmlpreprocess.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T17:42:41.590

使用 Web 部署项目，您可以在构建后交换 web.config 的不同部分。

# .net - 一个生产质量的 OpenSocial .NET 库？

> ID：678097
> 
> 赞同：3
> 
> 时间：2009-03-24T16:06:12.477
> 
> 标签：.net, opensocial, apache-shindig

我正在寻找生产质量的 OpenSocial/Shindig .NET 库，包括容器和客户端。

我只找到[了 Baadal](http://sites.google.com/site/baadalsharp/)（以及[CodePlex 上的一个死项目](http://www.codeplex.com/OpenSocial)）。你们都在用什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T13:47:20.570

作为客户端库，您可以使用[http://code.google.com/p/opensocial-net-client/](http://code.google.com/p/opensocial-net-client/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T21:35:40.377

您可以尝试[http://code.google.com/p/pesta/](http://code.google.com/p/pesta/)和[http://www.codeplex.com/raya](http://www.codeplex.com/raya)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-08T01:41:37.453

Myspace 刚刚开源了他们的 OpenSocial 小工具解析器和渲染器，并将添加一个完整的 opensocial 容器实现。

[http://code.google.com/p/negroni/](http://code.google.com/p/negroni/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T12:08:46.967

几个月前，我开始着手在 .NET 上实现 opensocial 规范。我认为在 .NET 上实现 opensocial 容器会很有用，它可以通过 nuget 包轻松集成到现有的 ASP.NET (MVC) 站点中。现在还远未完成，但我有一些结果，如果您有兴趣，可以在这里查看：

*   [catpic.codeplex.com](http://catpic.codeplex.com) - 项目网站
*   *安装包 Catpic* - nuget 包 - 只需创建新的 ASP.NET MVC 3 站点并尝试安装它
*   [catpic.apphb.com](http://catpic.apphb.com) - 带有演示站点的 CI 构建

# c# - Json 导入失败 - C#

> ID：678103
> 
> 赞同：2
> 
> 时间：2009-03-24T16:07:05.907
> 
> 标签：c#, asp.net, json, json.net, jayrock

我有以下类结构

```
public class AreaFields
{
    public List<Fields> Fields { set; get; }
}

public class Fields
{
    public string Name { set; get; }
    public string Value {set; get; }
} 
```

当我使用 导出到 Json 时`Jayrock.Json.Conversion.JsonConvert.ExportToString(List<AreaField> obj)`，一切正常。问题是当我尝试将其导入到 AreaField 列表时，本机导入失败。我想要的是

```
Jayrock.Json.Conversion.JsonConvert.Import(strJson) 
```

有没有办法覆盖导入方法？

编辑：是的，jayrock 知道对象的类型。我猜这与我序列化列表有关。

```
Export -
List<AreaField> list = GetAListOfAreaFields();
string sJson = Jayrock.Json.Conversion.JsonConvert.ExportToString(list)

Import -
List<AreaField> list = (AreaField)JsonConvert.Import(typeof(AreaField, sJson); 
```

异常 - 无法从 JSON 数组值导入 AreaField。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T19:54:17.920

看起来您正在导出一个`List<AreaField>`但试图导入一个`AreaField`（单数）。尝试：

```
List<AreaField> list = (List<AreaField>)JsonConvert.Import(typeof(List<AreaField>, sJson); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T12:23:00.010

List<> 不起作用，但数组起作用。像这样：

```
AreaField[] list = JsonConvert.Import<AreaField[]>(sJson); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T16:15:08.820

“它不起作用”不是一个好的开始。例外？数据错误？Jayrock 知道对象的类型吗？

```
AreaFields af = (AreaFields)Jayrock.Json.Conversion.JsonConvert.Import(typeof(AreaFields), strJson); 
```

# asp.net - 如何使用 ASP.NET 的动态数据脚手架将表设为只读

> ID：678110
> 
> 赞同：3
> 
> 时间：2009-03-24T16:09:22.937
> 
> 标签：asp.net, asp.net-3.5, dynamic-data

如何将单个表和/或列设为只读，以使编辑按钮不会显示在 ASP.NET 的动态数据框架中？

我将它用于实体数据上下文。

是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T17:40:22.750

请参阅我的文章[通过 ReadOnlyAttribute 将字段设置为只读 - 动态数据](http://csharpbits.notaclue.net/2009/01/making-field-read-only-via.html)应该可以满足您的需求。

# c# - C# 中的问题/响应串行端口处理

> ID：678113
> 
> 赞同：1
> 
> 时间：2009-03-24T16:10:18.067
> 
> 标签：c#, multithreading, serial-port

好的，这就是问题所在（这与我以前的帖子有关）

我需要能够为串行通信建立一个问题/响应系统，其工作方式如下：

问题：你好回应：世界？问题：不，你好 护士回复：嗯，你不好玩。

这意味着我说“你好”，远程单元预计会发回“世界？” 在某个时间范围内，如果没有，我应该有办法访问该缓冲区，所以这就是我的想法，请给我反馈

ReaderWriterLock'd 'readBuffer' 将写入流的问题方法 将监视 readBuffer 的响应方法，直到它包含我期望的内容或直到超时到期。

**首先，stackoverflow 社区将如何设计这个类，其次，他们将如何编写 datarecieved 事件？第三，他们将如何使该代码更加健壮，以便该类的多个实例可以存在于并行线程中以进行同时通信？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T18:56:31.990

这基本上是一个[生产者-消费者](http://en.wikipedia.org/wiki/Producer-consumer_problem)问题，所以这应该是一般设计的基础。

以下是对此的一些想法：

**a) FIFO 缓冲区（队列）**

首先，您应该为类的每个实例都有一个线程安全队列（FIFO 缓冲区）的实例。一个线程将接收数据并填充它，而另一个线程将以线程安全的方式读取数据。这仅意味着您必须在每个入队/出队操作上使用锁。

FIFO 队列将使您能够同时处理工作线程中的数据，同时从通信线程中填充数据。如果您需要接收大量数据，您可以在工作线程中将**一些**数据出列并在收到所有数据之前对其进行解析。否则，您需要等到所有数据都收到后才能一次全部解析。在大多数情况下，您不知道应该获取多少数据，直到您开始解析它。

**b) 等待数据的工作线程**

我会创建一个工作线程，它会等待收到新数据的信号。您可以使用`ManualResetEvent.WaitOne(timeOut)`超时，以防有一段时间没有任何事情发生。收到数据后，您必须根据当前状态对其进行解析——这将是[状态机](http://en.wikipedia.org/wiki/Finite_State_Machine#Software_applications)的实现。

**c) 端口抽象**

要处理不同类型的端口，您可以将串行端口包装在一个接口中，该接口至少可以具有以下方法（我可能忘记了一些东西）：

```
 interface IPort
 { 
      void Open();
      void Close();
      event EventHandler<DataEventArgs> DataReceived;
      void Write(Data data);
 } 
```

这将帮助您将特定的通信代码与状态机分开。

**注意：（** 根据 Microsoft）*DataReceived 事件不保证为收到的每个字节引发。使用 BytesToRead 属性来确定缓冲区中还有多少数据要读取*。所以你可以创建你自己的 IPort 实现，它会定期轮询 SerialPort 以确保你不会错过一个字节（有一个 SO 问题已经解决了这个问题）。

**d) 接收数据**

要接收数据，您必须为`IPort.DataReceived`事件附加一个处理程序（或者`SerialPort.DataReceived`，如果您不包装它），并将接收到的数据排入处理程序内的队列。在该处理程序中，您还可以设置提及`ManualResetEvent`以通知工作线程已收到新数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:32:16.877

我在为格式化数据编写异步套接字侦听器时遇到了类似的设计问题。我想出的转换成 SerialPort / DataReceived 模型将是这样的：

主类封装了问题/响应系统——它将包含基于输入生成响应的逻辑。类的每个实例都将绑定到一个可以在构造期间或之后设置的串行端口。将有一个 StartCommunications 类型的方法 - 它将 DataReceived 事件连接到类中的另一个方法。该方法负责从端口抓取数据，并确定是否有完整的消息到达。如果是这样，它会引发自己的事件（在类上定义），该事件将有一个适当的方法连接到它。你也可以让它在你的类上调用一个预定义的方法，而不是引发一个事件——我定义了一个事件来提高灵活性。

该基本设计在生产系统中运行良好，并且可以处理比连接到它的其他系统更多的输入。

# .net - 紧凑框架应用程序中的挂钩关闭 (X) 按钮

> ID：678115
> 
> 赞同：1
> 
> 时间：2009-03-24T16:11:59.530
> 
> 标签：.net, compact-framework

我想在紧凑的框架应用程序中点击（单击）以关闭按钮（右上角的 X）执行我自己的操作。我正在使用 Windows Mobile 6.1。

通常我想要默认行为，但有时我想更改当前表单上的用户控件。我怎样才能达到它？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T19:56:15.293

(X) 按钮*不是*关闭按钮，它是智能最小化按钮，您不能直接挂接到它（您可能会收到一个 Deactivated 事件，但您不能取消它）。

您可以将 Form 的 MinimizeButton 属性更改为 false ，它将更改为（确定）按钮，您可以处理（正如 Petros 指出的那样）。您可能会使用 IMessageFilter 或子类表单来挂钩其 WinProc 以也获取最小化事件。

也可以看看：

*   [如何检测智能最小化](https://stackoverflow.com/questions/365773/pocket-pc-windows-mobile-how-to-detect-smart-minimize)
*   [皇上无亲](http://blogs.msdn.com/windowsmobile/archive/2006/10/05/The-Emperor-Has-No-Close.aspx)
*   [子类化 CF 应用程序](http://blogs.msdn.com/raffael/archive/2008/02/26/subclassing-netcf-applications.aspx)
*   [使用本机回调子类化按钮](http://msdn.microsoft.com/en-us/library/ms229661.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-16T19:10:42.963

您正在寻找的功能是[SHDoneButton](http://msdn.microsoft.com/en-us/library/aa930127.aspx)。

使用 SHDB_SHOWCANCEL 的 dwState 调用它会将“智能最小化”按钮的行为更改为仅发出 WM_COMMAND 消息。[然后，您只需要通过设置自定义 WndProc](https://stackoverflow.com/questions/200924/in-c-i-have-a-intptr-to-a-win32-wndproc-what-is-the-syntax-for-calling-it)来监听 WM_COMMAND 消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T16:17:03.417

如果我明白你想做什么：

```
private void Form1_Closing(object sender, CancelEventArgs e)
{
     e.Cancel = true;
     //Do my own thing
} 
```

您可以为表单的“关闭”事件提供事件处理程序。通过 e.Cancel = true 你说你不希望表单关闭，然后你可以做任何你想做的事情。

# web-services - SOA - 业务服务的数据访问是否作为单独的 Web 服务？

> ID：678121
> 
> 赞同：0
> 
> 时间：2009-03-24T16:13:56.453
> 
> 标签：web-services, soa, data-access

目前在我的组织内部，我们正在尝试为试点 SOA 项目提出一些约定。乍一看，我们认为最好是强制服务用户使用业务服务而不直接访问任何数据端点.. 但是否存在不正确的特定场景，或者它可能对开发人员“有效”访问服务之外的特定数据端点？

我总是担心，如果我们打开它，它实际上会损害重用，因为每个人都会使用与可用的相同后端数据“重新发明”类似的业务服务，并且“理论上......更容易”编写一个新的业务服务，而不是问“这个使用我的数据库的其他服务做什么？”

因为即使服务几乎是直接传递到数据库，我们也有能力应用可以节省开发人员时间并最终节省业务资金的规则。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T16:22:38.380

无论如何，您的 Web 服务不会只是您的业务层的薄包装器吗？除了一些愚蠢的 DTO 之外，您的服务层可能不应该比您的业务层更多。然后没有人问“这个使用我的数据库的其他服务做什么？” 因为它没有使用你的数据库，它正在使用你的 BL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:26:04.193

当您描述“强迫”用户做任何事情时，您正在挥舞危险信号。也许您可以考虑一下您的问题并将其改写为“启用”用户之类的术语，因为这应该是您做出决定的起点，并且 SOA 为不同的 UI 策略提供了优缺点。

# castle-windsor - Windsor MixIn 是单身人士？

> ID：678131
> 
> 赞同：0
> 
> 时间：2009-03-24T16:16:43.247
> 
> 标签：castle-windsor, aop, mixins, castle-dynamicproxy

我有一个 MixIn 需要一些状态才能运行。

我是这样注册的。。

```
 container.Register(Component.For(Of ICat) _
                        .ImplementedBy(Of Cat) _
                        .LifeStyle.Transient _
                        .Proxy.MixIns(New MyMixin())) 
```

当我调用 container.Resolve(of ICat) 时，我得到了 ICat 的代理，它也实现了 IMixin。

但是，如果我再次调用 container.Resolve(of ICat)，我会得到一个新的 ICat 代理，但 MyMixin 是相同的实例。（这是有道理的，因为我没有告诉容器以任何方式创建 IMixin）

所以，IMixin 是一个 Singleton，尽管组件的生活方式是 Transient。

我如何通过 Fluent Interface 告诉 Windsor 为组件创建一个新的 MyMixIn 实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T15:56:31.557

我想我解决了这个问题。

我没有使用**Proxy.Mixins**，而是创建了一个自定义**Activator** ()

```
Public Class MixInActivator(Of T)
   Inherits Castle.MicroKernel.ComponentActivator.DefaultComponentActivator

  Public Sub New(ByVal model As Castle.Core.ComponentModel, ByVal kernel As Castle.MicroKernel.IKernel, ByVal OnCreation As Castle.MicroKernel.ComponentInstanceDelegate, ByVal OnDestruction As Castle.MicroKernel.ComponentInstanceDelegate)
    MyBase.New(model, kernel, OnCreation, OnDestruction)
  End Sub

  Protected Overrides Function InternalCreate(ByVal context As Castle.MicroKernel.CreationContext) As Object

    Dim obj As Object = MyBase.InternalCreate(context)
    If GetType(T).IsAssignableFrom(obj.GetType) = False Then
        Dim options As New Castle.DynamicProxy.ProxyGenerationOptions
        Dim gen As New Castle.DynamicProxy.ProxyGenerator
        options.AddMixinInstance(Kernel.Resolve(Of T))
        obj = gen.CreateInterfaceProxyWithTarget(Model.Service, obj, options)
    End If
    Return obj
 End Function
End Class 
```

所以现在，组件是这样注册的

```
 container.Register(Component.For(Of ICat) _
                     .ImplementedBy(Of Cat) _
                     .LifeStyle.Is(Castle.Core.LifestyleType.Transient) _
                     .Activator(Of MixInActivator(Of IMixin))) 
```

而IMixin注册如下

```
container.Register(Component.For(Of IMixin) _
                       .ImplementedBy(Of MyMixin) _
                       .LifeStyle.Is(Castle.Core.LifestyleType.Transient) _
                       .Named("MyMixin")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T16:21:16.707

我不确定它是如何冒泡到 Windsor 的，但在 DynamicProxy 级别，每个代理类型都有 mixin Instance。因此，如果您正在创建自己的 mixin 实例，您也可能每次都在生成新的代理类型。为了避免这种情况，请在您的混合类型中覆盖 Equals 和 GetHashCode。

但是，我可能不对，因此您可能需要先确定一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-23T19:33:02.057

如果您使用 transcient Lifestyle 注册 mixin，它将为每个组件创建一个新实例：

```
container.Register(
    Component.For<ICat>().ImplementedBy<Cat>()
        .LifestyleTransient()
        .Proxy.MixIns(m => m.Component("mixin")),
    Component.For<MyMixin>().LifestyleTransient().Named("mixin")
); 
```

# document - 跟踪（功能）设计文档的更改

> ID：678133
> 
> 赞同：6
> 
> 时间：2009-03-24T16:16:53.387
> 
> 标签：document

我正在寻找一种使设计文档与最新决策保持同步的好方法。

我们是一个小团队（两名开发人员、游戏设计师、平面设计师、项目经理、销售人员）。我们的大多数项目持续几个月。在项目开始时进行设计，但我们通常会发现自己在整个项目中做出改变或做出新的决定。大多数这些变化都是改进，所以我们希望保持这样的流程。（如果更改的设计导致需要更多时间，这通常会得到处理，因此该部分是可以的）

然而，目前我们没有很好的方法来捕获对初始设计文档的更改，这导致初始设计在编码时很快被放弃作为源。这当然是浪费精力。

目前我们的文档是 OpenOffice/Word，跟踪这些文档更改的最佳方法可能是在文档顶部添加一个更改列表并同时对文本进行更改——我认为这不是一个理想的选择.

我看过需求管理软件，但这看起来很专业。这些文档可以存储在颠覆中，但我认为这有点太低了，无法深入了解这些变化。

有谁知道跟踪此类更改并使设计文档成为整个项目的宝贵资源的好方法？

编辑：目前我们主要依靠对原始设计的更改放入 bugtracker 中，这样它们至少在*某个地方*。

编辑：相关问题

*   [版本控制（即 Subversion）是否适用于文档跟踪？](https://stackoverflow.com/questions/29810)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T16:21:54.297

我发现一个带有修订日志的 wiki 可以作为 Word 文档的升级版，前提是用户数量相对较少。找到一个可以轻松进行快速编辑的工具有助于确保其保持最新状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T16:31:43.540

openoffice 和 word 都包含显示/隐藏文档编辑的功能。假设对更改有抵抗力，那么这是您的最佳选择 - 要么导出为文本并将其放入任何源代码控制软件。\

或者，为更改描述文本维护一个单独的（使用适当的工具可区分的）文档，并在适当的时间点保存存档版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-10T10:16:46.600

这个问题在我们的编程商店中也是一个长期存在的问题。有趣的是，程序员倾向于从错误的优化角度看待这个问题：“将所有东西都放在一个地方”。在我看来，你有两个主要问题：

*   更改的描述必须**易于阅读**（“那么有什么新功能？”）
*   应该**优化该过程以编写**规范以达成一致，然后开始工作！

想象一下如何在另一个环境中解决这个问题：政府立法。每次政府添加另一项法律或更改一项法律时，法律手册都不会在开启“跟踪更改”的情况下重写……

最好的方法是永远不要触摸已发布的文档。不要把所有东西都塞到同一个文件中，你会得到：

*   **可怕的版本历史表**
*   **永恒的地位“草案”**，
*   分散的不一致，
*   非常仓促的句子，以及
*   作者风格的恶臭混合

相反，发布一个附录，仅详细描述更改，并可能替换原始的完整段落/页面。

## 以我们项目的规模，这永远行不通，不是吗？

在我迄今为止最大的项目中，我发布了一个基本规范和 5 个连续的附录。每页约 5 页。**像魅力一样工作！**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T16:24:55.770

我不知道有什么好的、免费的配置管理工具，但为什么不将您的设计置于源代码控制之下呢？只需将其添加到 SVN、CVS 或您正在使用的任何内容中。这很好，因为：

1）它始终是最新的（当然，如果您签入）

2）中心化

3) 您可以使用内置的比较功能来跟踪更改，该功能几乎在任何源代码控制系统中都可用

它可能不是您想要的“企业”解决方案，但无论如何您都是一小群开发人员，因此对于这种情况，它非常完美。

编辑：我现在看到您已经提到了源代码控制系统，这是我的错误。不过，我认为它应该运作良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T16:25:51.603

使用谷歌文档。它是免费的、基于 Web 的实时多用户，您可以选择谁可以访问您的文档并保持版本控制。您还可以上传所有 Word 文档，它会为您转换它们。更多信息：[http ://www.google.com/google-ds/intl/en/tour2.html](http://www.google.com/google-d-s/intl/en/tour2.html)

# c# - XML 标记名称被定义的类型覆盖

> ID：678139
> 
> 赞同：0
> 
> 时间：2009-03-24T16:18:10.250
> 
> 标签：c#, xml

我们正在使用基于该第 3 方开发的标准的 XML 文件与第 3 方服务进行通信。他们为每个“事务”提供了一个 XML 模板，我们使用 System.Data.DataSet.ReadXML 将其读入 DataSet，在 DataSet 中设置适当的值，然后使用 System.Data.DataSet.WriteXML 将 XML 写回。此过程适用于几个不同的文件。但是，我现在要添加一个附加文件，该文件要求在其中一个字段上设置整数数据类型。这是一个缩小版：

```
<EngineDocList>
    <DocVersion>1.0</DocVersion>
    <EngineDoc>
        <MyData>
            <FieldA></FieldA>
            <FieldB></FieldB>
            <ClientID DataType="S32"></ClientID>
        </MyData>
    </EngineDoc>
</EngineDocList> 
```

当我查看通过对该文件调用 ReadXML 创建的 DataSet 时，MyData 表包含 FieldA、FieldB 和 MyData_ID 列。如果我随后设置 MyData_ID 的值，然后调用 WriteXML，则导出 XML 没有 ClientID 的值。再一次，如果我采用 DataType 的方式，那么我确实有一个 ClientID 列，我可以正确设置它，并且导出的 XML 具有正确的值。但是，第三方要求定义此数据类型。

关于为什么 ReadXML 会重命名此标记或我如何才能使此过程正常工作的任何想法？或者，我可以修改我们阅读和编写 XML 的方式，但显然我宁愿不走这条路，尽管这些建议也会受到欢迎。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:23:04.683

我不会对 DataSet 执行此操作。它特别关注模拟关系模型。许多 XML 不会遵循该模型。当 DataSet 看到与它的世界观念不符的事物时，它要么忽略它们，要么改变它们。在这两种情况下，这都不是一件好事。

我会为此使用 XmlDocument。

# c# - 如何设置创建 IIS 虚拟目录时使用的 .NET Framework 版本？

> ID：678146
> 
> 赞同：1
> 
> 时间：2009-03-24T16:20:23.427
> 
> 标签：c#, .net, iis, installation

我有一个创建虚拟目录的方法。在创建虚拟目录时如何将 .NET Framework 设置为版本 2？

到目前为止，我的方法看起来像这样：

```
private static void CreateVDir(string metabasePath, string vDirName, string physicalPath)
{
    //  metabasePath is of the form "IIS://<servername>/<service>/<siteID>/Root[/<vdir>]"
    //    for example "IIS://localhost/W3SVC/1/Root".
    //  vDirName is of the form "<name>", for example, "MyNewVDir".
    //  physicalPath is of the form "<drive>:\<path>", for example, "C:\Inetpub\Wwwroot".
    Console.WriteLine("\nCreating virtual directory {0}/{1}, mapping the Root application to {2}:",
                      metabasePath, vDirName, physicalPath);

    DirectoryEntry site = new DirectoryEntry(metabasePath);
    string className = site.SchemaClassName;
    if ((className.EndsWith("Server")) || (className.EndsWith("VirtualDir")))
    {
        DirectoryEntries vdirs = site.Children;
        DirectoryEntry newVDir = vdirs.Add(vDirName, (className.Replace("Service", "VirtualDir")));
        newVDir.Properties["Path"][0] = physicalPath;
        newVDir.Properties["AccessScript"][0] = true;
        // These properties are necessary for an application to be created.
        newVDir.Properties["AppFriendlyName"][0] = vDirName;
        newVDir.Properties["AppIsolated"][0] = "1";
        newVDir.Properties["AppRoot"][0] = 
           "/LM" +
           metabasePath.Substring(metabasePath.IndexOf("/", ("IIS://".Length)));
        newVDir.CommitChanges();
        Console.WriteLine(" Done.");
    }
    else
        Console.WriteLine(
            " Failed. A virtual directory can only be created in a site or virtual directory node.");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:28:53.560

“ScriptMaps”属性是存储配置映射的地方。也就是说，您可以在此处映射 *.aspx 文件以供 ASP.NET 处理。*[以编程方式创建 ISAPI 映射](http://forums.asp.net/p/1379301/2910972.aspx)*中的一个示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:29:24.153

创建虚拟目录后，您可以从您选择的 .NET 框架目录运行 aspnet_regiis -s。

在我的系统上，命令看起来像这样：

C:\Windows\Microsoft.NET\Framework64\v2.0.50727\aspnet_regiis -s W3SVC/1/ROOT/SampleApp1

我已通过安装程序中的自定义操作成功完成此操作。

# wpf - WPF 样式触发器

> ID：678160
> 
> 赞同：0
> 
> 时间：2009-03-24T16:25:44.833
> 
> 标签：wpf, triggers

如果数据网格中复选框的值为真，我试图让数据网格中的一行变为红色。有任何想法吗？这是我到目前为止所拥有的。如果鼠标在行上滚动，我目前正在将列变为红色。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T21:22:09.317

Take a look at [this blog post by Vincent Sibal](http://blogs.msdn.com/vinsibal/archive/2008/09/16/wpf-datagrid-styling-rows-and-columns-based-on-header-conditions-and-other-properties.aspx "Styling WPF DataGrid rows/columns"). Sibal gives several code examples of what you're trying to do and he also provides a good sample project you can download to see the source.

# .net - 在数组、列表等上使用 foreach 时的排序顺序

> ID：678162
> 
> 赞同：5
> 
> 时间：2009-03-24T16:26:04.020
> 
> 标签：.net, arrays, foreach

使用 foreach 遍历数组时，是否可以保证返回元素的顺序是数组 [0]、数组 [1]、数组 [2]、...

我知道这就是现在实现 Array 类的方式，但是对框架的未来版本有任何保证吗？List<> 也有同样的问题。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-24T17:08:17.960

到目前为止，我不得不不同意所有的答案。

首先，C# 3.0 标准保证了数组上 foreach 的顺序：

> foreach 遍历数组元素的顺序如下： 对于单维数组，元素以索引递增的顺序遍历，从索引 0 开始，以索引 Length – 1 结束。对于多维数组，遍历元素这样最右边维度的索引首先增加，然后是下一个左边的维度，依此类推到左边。

-- [C# 语言规范版本 3.0](http://download.microsoft.com/download/3/8/8/388e7205-bc10-4226-b2a8-75351c669b09/CSharp%20Language%20Specification.doc)，第 240 页。

其次，在对象上，foreach (C#) 和 For Each (VB.NET) 通过使用对象 ( [source](http://msdn.microsoft.com/en-us/library/9yb8xew9.aspx) ) 上的 MoveNext、Reset 和 Current 成员来工作。这些通常是 IEnumerator 接口的一部分。

在具有顺序的集合中（阅读：实现 IList 或 IList(T) 的事物），这意味着元素将按照后备存储存储它们的顺序返回。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T16:30:57.003

没有任何保证。大多数列表/数组实现将按顺序返回值，但肯定有例外，特别是在一些不太常见的集合类中。（例如，在 C5 中，许多集合返回值的顺序与枚举时添加的顺序非常不同。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T16:33:07.810

没有设计保证。foreach 旨在用于无序枚举，并暗示运行时甚至可能并行处理多个元素。您永远不应该依赖任何枚举顺序。

# c# - DLL 与程序集

> ID：678164
> 
> 赞同：1
> 
> 时间：2009-03-24T16:26:23.943
> 
> 标签：c#, asp.net, dll, assemblies

DLL和程序集有什么区别

* * *

**完全重复**：[程序集和 DLL 之间的区别](https://stackoverflow.com/questions/674312/difference-between-assembly-and-dll)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T16:29:11.500

DLL 是程序集，而程序集可以是 DLL 或 EXE。这是昨天问的...

# html - 自由格式日期字段

> ID：678165
> 
> 赞同：1
> 
> 时间：2009-03-24T16:26:59.183
> 
> 标签：html

我在 sw [http://www.joelonsoftware.com/articles/TwoStories.html上阅读了关于 joel 的这个档案](http://www.joelonsoftware.com/articles/TwoStories.html)

在这里他提到他想制作一个日期字段自由格式。然后我想有人会怎么做？当然在gmail中搜索可以做到。

以前有人实施过吗？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T16:35:48.443

您可以查看以下任何日期解析实现

*   谷歌在谷歌代码上的 parsedatetime ( [http://code.google.com/p/parsedatetime/](http://code.google.com/p/parsedatetime/) )
*   python-dateutil ( [http://labix.org/python-dateutil](http://labix.org/python-dateutil) )
*   javascript 库 ( [http://www.datejs.com/](http://www.datejs.com/) )
*   perl ( [http://metacpan.org/pod/DateTime::Format::Flexible](http://metacpan.org/pod/DateTime::Format::Flexible) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:30:54.057

PHP 的[strtotime()](http://is2.php.net/manual/en/function.strtotime.php)是一个非常好的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T16:57:34.180

如果您在大西洋两岸都有用户，则需要明确防止 09/10/11 样式的日期，因为会发生很多混乱 - 要么要求使用字母的月份，要么使用下拉菜单并放弃自由格式。请记住 09/11 是欧洲的 11 月 9 日。使用 IP 地址的位置来消除歧义是失败的，因为欧洲人和美国人可以跨越大西洋！

# c# - 按实体查询（示例）

> ID：678167
> 
> 赞同：3
> 
> 时间：2009-03-24T16:27:40.053
> 
> 标签：c#, linq, entity-framework

我正在寻找一种工具，它可以从给定的实体动态生成 Linq to Entity 查询，如果你愿意的话，一个 Query By Entity (Example)。给定一个实体及其所属的对象上下文，生成器返回一个 ObectQuery 或 IQueryable，可以进一步修改或执行。理想情况下，查询构建器不会直接引用实体模型，而是使用对象上下文从模型构建查询。我想象代码看起来像这样：

```
 QueryBuilder qb = new QueryBuilder(new EntitiesContext());
        Customer c = new Customer();
        qb.Add(c);  
        c.FirstName = "Jim";
        var qry = qb.BuildQuery();
        int total = qry.Count(); 
```

底层查询看起来像这样：

```
var query = from c in ctx.Customers
            where c.FirstName == "Jim"
            select c; 
```

这样的东西是否已经存在于某个地方？我可以想象自己编写这样的代码，但我宁愿开始使用已经存在的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T23:17:25.140

我不确定您的目标是什么，如果您要发布有关您的上下文的更多信息（一个实际问题），但 Dynamic Linq 可能会帮助您动态构建 linq 查询：

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

维贝

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:14:11.330

您可以使用动态 Linq 在运行时构建您的 Linq 表达式 - 只需将方法附加到现有的 Linq 查询（在执行之前）。话虽如此，正如 Chris 所提到的，“QueryBuilder”类的概念值得怀疑。

严格来说，Linq 本身就是一个查询构建器，因为它需要一个 Linq 语句并构建一个“图”，然后查询提供者可以使用它来完成底层工作（为 Linq-To-SQL 编译 SQL 语句，或枚举Linq-For-Objects 的对象）。如果您想为最终用户提供动态构建查询的能力，请考虑通过添加 Chris 指出的查询方法来创建构建 Linq 语句的 UI。请记住，使用 Linq 查询，您可以添加任意数量的表达式 - 查询仅在枚举器被触发时执行。

即选择名为 Jim 的 65 岁以下最年长的客户：

```
Dim qry = From customer in DataContext.Customers
qry = qry.Where( Function (c as Customer) c.Name="Jim" )
qry = qry.Where( Function (c as Customer) c.Age < 65 )
qry = qry.OrderByDescending( Function (c as Customer) c.Age )
qry = qry.Take(1) 
Dim oldJim as Customer = qry.FirstOrDefault() 
```

FirstOrDefault 方法与使用 ToArray 或 For Each 一样，会触发枚举器并因此处理查询。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T07:06:32.297

我并没有真正看到 QueryBuilder 中的价值。如果它像您的示例一样简单，您只能使用它来查找完全匹配。如果您需要更复杂的查询，最好直接使用 Linq。

你知道你可以链接你的查询吗？这可能不是你正在寻找的，但你可以做

```
IQueryable<Customers> source=context.Customers;

if (...)
{
  source = from c in source
           where c.FirstName.StartsWith("Jim")
           select c;
}

if (...)
{
  source = from c in source
           where contries.Contains(c.Country)
           select c;
}

// ... 
```

# php - Constant Contact - PHP wrapper for REST API?

> ID：678169
> 
> 赞同：1
> 
> 时间：2009-03-24T16:27:51.800
> 
> 标签：php, email, constantcontact

Anyone written or know of a decent PHP helper class written for Constant Contact's new REST API?

I've looked at their sample application... has a bunch of inline examples... helpful, but I'm thinking I want to either find or write a helper class to fully encapsulate the API so that all one has to do is interact with the PHP object.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-10T00:04:47.493

I actually just started this project myself. It does almost everything the REST APIs allow. It will probably help you get off the ground with your integration.

[http://www.envoymediagroup.com/Code/CTCT-Web-Services-PHP-Library.html](http://www.envoymediagroup.com/Code/CTCT-Web-Services-PHP-Library.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:32:13.647

They have a PHP sample application:

[http://img.constantcontact.com/webservices/samples/PHPSample.zip](http://img.constantcontact.com/webservices/samples/PHPSample.zip)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-15T17:36:07.987

This is an old thread, but I thought it would be helpful to add in the official Constant Contact PHP SDK wrapper: [https://github.com/constantcontact/php-sdk](https://github.com/constantcontact/php-sdk)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-26T23:11:33.667

An old thread, but thought people might be interested in a V3 PHP client:

[https://packagist.org/packages/phpfui/constantcontact](https://packagist.org/packages/phpfui/constantcontact)

# c# - 如何将 list<> 转换为多维数组？

> ID：678178
> 
> 赞同：5
> 
> 时间：2009-03-24T16:29:12.937
> 
> 标签：c#, .net, arrays, list

我有以下方法签名：

```
public void MyFunction(Object[,] obj) 
```

我创建了这个对象：

```
List<List<Object>> obj = new List<List<Object>>; 
```

有没有一种简单的方法可以将其转换为`Object[,]`?

* * *

### 更新：

事实上，我喜欢使用`List`s，因为我可以轻松添加新项目。有没有办法可以声明我的`List<>`对象来满足这个需求？我知道我的列数，`Object[,]`但不知道行数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T16:35:15.620

不。事实上，这些不一定是兼容的数组。

`[,]`定义一个多维数组。 `List<List<T>>`将更多地对应于锯齿状数组 ( `object[][]`)。

问题是，对于您的原始对象，`List<object>`列表列表中包含的每个对象都可以有不同数量的对象。您需要**制作一个内部列表最大长度的多维数组，并用空值**或类似的东西填充以使其匹配。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-24T16:39:42.227

你不会得到一个*非常*简单的解决方案（即几行）。在这种情况下， LINQ/`Enumerable`该类不会为您提供帮助（尽管如果您想要一个锯齿状数组，即它可以`Object[][]`）。在这种情况下，普通嵌套迭代可能是最好的解决方案。

```
public static T[,] To2dArray(this List<List<T>> list)
{
    if (list.Count == 0 || list[0].Count == 0)
        throw new ArgumentException("The list must have non-zero dimensions.");

    var result = new T[list.Count, list[0].Count];
    for(int i = 0; i < list.Count; i++)
    {
        for(int j = 0; j < list[i].Count; j++)
        {
            if (list[i].Count != list[0].Count)
                throw new InvalidOperationException("The list cannot contain elements (lists) of different sizes.");
            result[i, j] = list[i][j];
        }
    }

    return result;
} 
```

我在函数中包含了一些错误处理，只是因为如果在非方形嵌套列表中使用它可能会导致一些令人困惑的错误。

这种方法当然假设每个`List<T>`作为父元素包含的元素具有`List`相同的长度。（否则你真的需要使用锯齿状数组。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-04T21:11:21.210

这是使用 Linq`Aggregate`扩展的解决方案。

请注意，下面不检查，也不关心是否得到一个锯齿状的子列表，它使用所有子列表的最大大小并根据当前列表填充。如果这是一个问题，可以添加一个检查以`if`检查所有子列表中的相同计数。

```
public static T[,] To2DArray<T>(this List<List<T>> lst)
{

    if ((lst == null) || (lst.Any (subList => subList.Any() == false)))
        throw new ArgumentException("Input list is not properly formatted with valid data");

    int index = 0;
    int subindex;

    return 

       lst.Aggregate(new T[lst.Count(), lst.Max (sub => sub.Count())],
                     (array, subList) => 
                        { 
                           subindex = 0;
                           subList.ForEach(itm => array[index, subindex++] = itm);
                           ++index;
                           return array;
                         } );
} 
```

## 测试/使用

```
var lst = new List<List<string>>() { new List<string>() { "Alpha", "Beta", "Gamma" },
                                     new List<string>() { "One", "Two", "Three" },
                                     new List<string>() { "A" }
                                 };
var newArray = lst.To2DArray(); 
```

结果：

[![在此处输入图像描述](https://i.stack.imgur.com/AbJiM.png)](https://i.stack.imgur.com/AbJiM.png)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-24T16:34:35.997

坦率地说，答案是否定的，不容易。

也许您想编辑您的问题，为我们提供更多关于为什么需要这些声明的背景信息，我们可以帮助您解决根本问题？

* * *

### 重新更新：

我假设您无法更改需要将其传递到的函数。

我不明白为什么您不能只使用 an`object[,]`开头。这是我的建议。

我怀疑这会对您的情况有所帮助，但它可能会使某些阵列在您开始时更容易工作。你知道关于[`.ToArray()`](http://msdn.microsoft.com/en-us/library/x303t819.aspx)a 的方法`List`吗？

# php - 是否可以使用 PHP 在网页中显示 RTF 文件？

> ID：678192
> 
> 赞同：14
> 
> 时间：2009-03-24T16:31:26.817
> 
> 标签：php, document, rtf

我有一个 RTF 文件，我想在标签被用户输入替换后显示在网页中。

我希望能够显示 RTF 文件，而不必在显示之前将其转换为某些东西。

每次我现在尝试它时，它都会给我弹出打开/保存框，即使我告诉它内联显示它：

```
header("Content-type: application/msword");
header("Content-Disposition: inline; filename=mark.rtf");
header("Content-length: " . strlen($output));

echo $output; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T16:57:27.050

大多数浏览器不能可靠地显示 RTF 内容。可以将 RTF 解析为 HTML，然后在您的网页上显示 HTML 内容。

您需要某种程序来解析 RTF 并将其转换为 HTML。我假设它必须是免费的。我不知道任何可靠的免费 RTF 解析或 RTF 到 PHP 中的 HTML 库。

我建议你使用像 RTF2HTML 这样的命令行转换程序：[http ://sageshome.net/?w=downloads/soft/RTF2HTML.html](http://sageshome.net/?w=downloads/soft/RTF2HTML.html)

您需要在您的网络服务器上下载并安装此程序，允许用户将文件上传到临时目录，然后使用 shell_exec() 从 PHP 调用命令行应用程序：

```
$html_output_path = '/path/for/processing/files/'
$html_output_filename = $username . $timestamp;
if (is_uploaded_file($_FILES['userfile']['tmp_name'])
{
  shell_exec('rtf2html ' . 
    escapeshellarg($_FILES['userfile']['tmp_name']) . " " .
    $html_output_path . $html_output_filename);
}
$html_to_display = file_get_contents($html_output_path . 
  $html_output_filename); 
```

然后，将结果解析为 HTML 并显示出来。不错的策略。请注意，如果您要在另一个网页中显示内容，您可能需要删除 head、body 和可能的其他标签。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-18T13:41:44.547

您可能想查看[https://github.com/tbluemel/rtf.js](https://github.com/tbluemel/rtf.js)以了解客户端 RTF 渲染。它仍处于早期阶段，但它甚至可以渲染嵌入式图形。但是，对渲染嵌入式 WMF 图稿的支持仍然非常有限，并且需要浏览器支持该标签。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-15T08:52:47.860

您需要一个用 PHP 编写的 RTF 到 HTML 转换器。我认为此页面包含您的解决方案：

[http://www.websofia.com/2014/05/a-working-rtf-to-html-converter-in-php/](http://www.websofia.com/2014/05/a-working-rtf-to-html-converter-in-php/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T16:50:56.877

首先：您的内容类型错误。对于 RTF 它是**`text/rtf`**

第二：您将只能内嵌显示这种类型的内容，这些内容可以由 Web 浏览器呈现。RTF 不是其中之一。因此，如果不进行转换，或者没有浏览器的某些插件，您将无法在线显示它。当然，转换可能是即时的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T16:50:32.200

网页只能包含 HTML。您需要一个像 flash 这样的浏览器插件来显示其他文件类型。例如，参见[Scribd 。](http://scribd.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-13T12:52:16.347

这不完全是您问题的答案，但您可能想要做的一件事是从标题中删除“filename=mark.rtf”。如果我在标题中包含“文件名”，即使“内容处置”是“内联”，浏览器也会将某些内容视为下载。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-03-24T16:34:49.710

您不能只从 PHP 代码中输出文件。您需要从中提取数据，然后内联打印内容。

php 函数 'file_get_contents' 可以满足您的需要。功能手册在这里：[http ://us2.php.net/filegetcontents](http://us2.php.net/filegetcontents)

示例用法在这里：

```
$contents = file_get_contents('yourfile.rtf'); 
```

# sql - MySQL ORDER 问题

> ID：678196
> 
> 赞同：3
> 
> 时间：2009-03-24T16:32:13.647
> 
> 标签：sql, mysql

我有一个非常简单的 SQL 查询，但缺少一些东西，我还没有找到这个问题的答案。问题是我选择了一些具有多个 id 的字段，并且我希望以这个特定的顺序对结果进行排序。

查询如下

```
SELECT `content`.* 
FROM   `content` 
WHERE  (user_id = "1" AND ( id = "4" OR id = "7" OR id = "5" OR id = "8" )) 
```

默认顺序是“id ASC”（id 是我的主键），但在这种特殊情况下，我希望顺序为 4、7、5、8。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T16:37:50.280

> ```
> ORDER BY CASE user_id  
>     WHEN "4" THEN 1  
>     WHEN "7" THEN 2  
>     WHEN "5" THEN 3  
>     WHEN "8" THEN 4  
>     ELSE 5  
> END 
> ```

如果你想概括它，你可以创建一个包含两列的新表——“user_id”和“order_by_val”，加入它，以及“ORDER BY order_by_val”。

* * *

编辑：根据@Tim，如果您不关心可移植性或函数返回值不可优化的问题，MySQL 有一个专有函数 - FIELD() - 如他的帖子中所述。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T17:09:55.943

这将做你想要的：

```
select * 
from myTable
order by field(myID, 8, 7, 6) desc; 
```

您可以设置您想要出现的任何 ID（或其他）的顺序，之后任何其他 ID 都会跟随。希望有帮助。

更多关于这个@ [http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_field](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_field)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T16:38:06.003

我通常做这种奇怪排序的方式是使用 case 语句：

```
order by case id
             when "4" then 1
             when "7" then 2
             when "5" then 3
             when "8" then 4
             else 99
         end 
```

不确定这是否直接转换为 mysql，但这个想法应该。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T16:39:21.523

```
ORDER BY CASE id WHEN 4 THEN 1 
                 WHEN 7 THEN 2 
                 WHEN 5 THEN 3 
                 WHEN 8 THEN 4 
                 ELSE 99
         END; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T16:39:56.157

您可以尝试将以下内容添加到查询的末尾。

```
ORDER BY CASE ID WHEN 4 THEN 1 WHEN 7 THEN 2 WHEN 5 THEN 3 WHEN 8 THEN 4 ELSE 5 END 
```

# sql-server - 当 SSRS 报告包含 char 值高于 127 的 Wingdings 时，将其导出为 PDF

> ID：678198
> 
> 赞同：3
> 
> 时间：2009-03-24T16:32:25.783
> 
> 标签：sql-server, reporting-services

在 Report Builder 2008 中，我使用诸如

```
=Chr(224) 
```

在文本框表达式中获取 Wingdings 字符，例如向上、向下、直箭头等。我运行报告，它在屏幕上看起来很棒，并导出到 Excel。

但是，如果我导出为 PDF，我注意到任何字符值高于 127 的 Wingdings 都不会在 PDF 中正确显示（只是一个空的小框。）在 Acrobat 中，我转到文件属性，查看字体选项卡，然后我看到Wingdings嵌入成功了，但是编码设置为ANSI。（如果我使用 OpenOffice 出色的 PDF 导出功能从 OpenOffice 导出文档，编码显示为“内置”并且 Wingdings 字符看起来都很棒。）

Chr(127) 下的 Wingdings 在 SSRS 报告中看起来不错。知道我是否可以对更高的字符做任何事情吗？

谢谢，比尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T14:17:25.163

解决方法：我想使用一个空方块和一个带有复选框的方块。最初我使用的是绕组字符 254 和 168。

基本上尽量用128以下的字符，别忘了还有wingdings 2、3和webdings。我发现 Wingdings 2 characters 82 和 Wingdings 111 可以代替。

此外，您可以通过为表达式的字体属性设置表达式来混合和匹配多种字体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-17T11:40:35.320

其他人的注意事项：如果您正在寻找文档的基本标记，您可以切换到 WebDings 并使用小写的“a”。这会正确导出为 PDF 作为一个勾号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T12:00:48.843

我在官方 Sql Server Reporting Service[论坛上](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/a8904e83-f291-4364-a9da-18ac1a2e3b96/)得到了答案。

总而言之：这是一个错误。我将按照 Andre Milbrandt 的建议提交问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-30T05:17:28.460

我在中文语言环境中遇到了同样的问题。然后我通过在服务器（运行 SQL 报告服务的地方）上安装中文解决了这个问题。

通过安装 SQL CU6 更新（不安装语言包）也解决了同样的问题。这是该更新的链接[http://support.microsoft.com/kb/2489376](http://support.microsoft.com/kb/2489376)

# xml - 生成没有 REF 元素的 XSD 文件 - 我只想要一个“文字”XSD 文件

> ID：678202
> 
> 赞同：2
> 
> 时间：2009-03-24T16:33:26.733
> 
> 标签：xml, visual-studio, xsd, biztalk

当我使用 XML 示例文件生成 XSD 时，同时使用 Visual Studio 和 Oxygen，它会使用 ton of 生成一个文件`<xs:element ref="ELEMENTNAME" />`，其中 elementname 是实际的元素名称。在文件的后面，它有一个元素`<xs:element name="ELEMENTNAME" type="xs:string" />`，它定义了该元素是什么。例如，这里有一段摘录：

```
<xs:element name="Header">
  <xs:complexType>
    <xs:sequence>
      <xs:element ref="VersionNumber" /> 
      <xs:element ref="BillerGroupID" /> 
      <xs:element ref="BillerGroupShortName" /> 
      <xs:element ref="BillerID" /> 
      <xs:element ref="BillerShortName" /> 
      <xs:element ref="FileIndicator" /> 
    </xs:sequence>
  </xs:complexType>
</xs:element>
<xs:element name="VersionNumber" type="xs:string" /> 
<xs:element name="BillerGroupID" type="xs:string" /> 
<xs:element name="BillerGroupShortName" type="xs:string" /> 
<xs:element name="BillerID" type="xs:string" /> 
<xs:element name="BillerShortName" type="xs:string" /> 
<xs:element name="FileIndicator" type="xs:string" /> 
```

这就是问题所在 - 我正在使用 Microsoft Biztalk，它会将每个“元素”标签视为可用架构，因为它们都位于根级别 - 标题以及每个子元素。我只想让一个模式可用——在这种情况下是标题——并隐藏其余的。

显而易见的解决方案似乎是手动编辑我的文件，使其看起来像这样，手动删除 REF 语句：

```
<xs:element name="Header">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="VersionNumber" type="xs:string" /> 
      <xs:element name="BillerGroupID" type="xs:string" /> 
      <xs:element name="BillerGroupShortName" type="xs:string" /> 
      <xs:element name="BillerID" type="xs:string" /> 
      <xs:element name="BillerShortName" type="xs:string" /> 
      <xs:element name="FileIndicator" type="xs:string" /> 
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

但是，由于我的文件很大并且包含数千个元素，因此这并不可行。有没有办法告诉我的工具在不使用 REF 的情况下生成文件，而只是将元素的副本放在它应该在的位置而不是根级别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T19:41:28.403

如果您有 Visual Studio BizTalk 项目，您可以选择“添加生成的项目..”，然后选择“生成架构”。

在下拉列表中选择“格式良好的 xml”，如果在您必须运行脚本激活它之前没有人使用该选项，请参见下面的链接。

VS 现在将生成你想要的那种模式。如果 VS 猜错了，您将不得不调整数据类型 :)

查看此人的示例[添加生成的架构](http://www.codeproject.com/KB/biztalk/AutoGenSchema.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:40:15.813

我怀疑编写一个为您执行此转换的 XSLT 会相对容易。您可以检测 ref 属性并使用 XPath 中的值来查找真正的定义，然后将其复制到输出。应该不难写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T18:26:41.640

你用的是哪个版本的VS？我在 Visual Studio 2008 中尝试了您的示例，它以您似乎想要的方式生成了 XSD：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Header">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="VersionNumber" type="xs:string" />
        <xs:element name="BillerGroupID" type="xs:string" />
        <xs:element name="BillerGroupShortName" type="xs:string" />
        <xs:element name="BillerID" type="xs:string" />
        <xs:element name="BillerShortName" type="xs:string" />
        <xs:element name="FileIndicator" type="xs:string" />
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

看起来[VS 2005](http://msdn.microsoft.com/en-us/library/aa302298.aspx#xmltools_topic3)会做同样的事情。

我查看了 VS 选项对话框，但没有看到任何可以控制如何生成 XSD 的内容。（也许某处有配置文件？）

# c# - 存储/使用多种语言的最佳方式

> ID：678204
> 
> 赞同：1
> 
> 时间：2009-03-24T16:33:36.997
> 
> 标签：c#

如果我想创建支持多种语言的 ac# 应用程序，我应该如何存储它们？

我可能会在应用程序中使用常量作为值持有者。

如：Console.Write(FILE_NOT_FOUND);

编译后会变成由语言决定的字符串。我可能会坚持使用 3 种语言（丹麦语、英语、德语），但我认为这并不重要。

每种语言都有一个类文件，这似乎是一种浪费，这些文件都是在编译应用程序时处理的。这也意味着每次要更改字符串时都必须重新编译和重新分发整个程序。据我所知，硬编码字符串是一件坏事。

也许是一个文本文件？English.txt 第 1 行：FILE_NOT_FOUND=找不到文件。再试一次 Line2 Line3 等。

Danish.txt Line1: FILE_NOT_FOUND=Filen blev ikke fundet。Prøv igen Line2 Line3 等

等等。如果用户选择英语，它会读取文本文件并设置不同的常量值。

我能想到的最后一个是将它放在 SQL 数据库中。

你能给我一些意见吗？:)

另外，我尝试写 FILE _ NOT _ FOUND （没有空格，但文本编辑器不会让我

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T16:37:16.600

使用资源文件。这是处理本地化的标准方法。

有关详细信息，[请参阅本教程。](http://www.codeproject.com/KB/dotnet/Localization.aspx)

- - 编辑 - -

此处提供了替代教程[。](http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=211&printer=t) 这个使用了更好的命名，所以它可能更清楚它是如何工作的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T16:50:42.043

我认为您最好的选择是使用 .NET Framework 的内置本地化资源。[您可以在此处](http://msdn.microsoft.com/en-us/library/f45fce5x(VS.80).aspx)阅读有关其机制的更多信息。

至于使用数据库存储本地化元素（文本、图像等），这当然是一种常见的选择，但我认为这主要是因为开发人员更了解从数据库获取数据，而不是使用附属程序集等。使用数据库有很多问题，所以我只列举几个：1) 增加了应用程序部署的复杂性 2) 数据库服务器上的额外负载，3) 你在哪里存储本地化消息来说明数据库已关闭:)

使用某种文本文件（可能是 XML）也会带来一些部署问题，但更重要的是，“即时”更改文本的灵活性被高估了。除了拼写错误和笨拙的措辞之外，随着应用程序文本的更改，您几乎总是会发布新版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T16:37:58.250

在此处查看本地化/国际化示例：

[http://msdn.microsoft.com/en-us/goglobal/bb688096.aspx](http://msdn.microsoft.com/en-us/goglobal/bb688096.aspx)

我也听说过[这本书](https://rads.stackoverflow.com/amzn/click/com/0321341384)的好消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T16:41:30.007

这个话题太大了，无法回复。

使程序为新语言做好准备的过程通常称为“国际化”或“i18n”，而将其实际运行的过程称为“本地化”或“l10n”。

简而言之，正如您所说，您希望用字符串资源替换硬编码字符串，然后通常为不同的语言创建不同的资源文件。假设您在 .NET 中工作（对于 C# 来说是一个相当好的假设），Microsoft 做了很多事情来使它更容易。

请记住，除了语言之外，还有其他本地化问题。例如，丹麦货币符号可能不是“$”，而是欧元符号，日期的缩写几乎肯定不同，许多地方使用“,”作为小数点和“.”。为千位分隔符，与英语的做法相反。

# internet-explorer - 为什么我的 javascript 文件没有在 IE7 中“一致地”加载？

> ID：678206
> 
> 赞同：13
> 
> 时间：2009-03-24T16:34:14.283
> 
> 标签：internet-explorer, javascript, asp.net

在似乎是随机发生的情况下，**javascript 文件未加载**。

我相信这个诊断是正确的，因为 a) 我有代码要检查，b) 我已经单步执行了代码，c) 使用这些文件中的函数时出现“'myfunction' is undefined”错误。

有时这不会发生一个小时，有时它会在我每次加载页面时发生，有时它会在我加载页面时发生。似乎每次我识别出一致的行为以便我可以重复并诊断它时，它都会改变！

有谁知道可能是什么原因造成的？

我正在使用 ：

*   IE 版本 7.0.5730.11（已卸载 IE8 Beta）
*   VS2008

现在，它似乎只发生在我的同事和我的开发环境中。

有一个脚本似乎比其他任何一个都缺少。这是脚本标签。

```
<script language="javascript" 
        type="text/javascript" 
        src="js/Ajax.Utility.js?<%= ConfigurationManager.AppSettings["WebApp.JavaScript.FileVersion"].ToString() %>"></script> 
```

评估为

```
<script language="javascript" 
        type="text/javascript" 
        src="js/Ajax.Utility.js?090324a"></script> 
```

版本查询字符串参数似乎也没有任何效果，因为我在更改它后立即遇到并且没有遇到问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-10-02T21:11:28.367

我以前遇到过两次这个问题。它始终是 Javascript 代码中的语法错误。很可能是一个额外的支架或缺少一个。所有其他浏览器都允许它通过，但 IE7 没有。

反复试验（删除代码块和代码块）使我找到了解决方案。

我希望这有帮助 ：-）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T03:05:15.730

以防万一给出的答案没有奏效-

默认情况下，IE7 不会从本地文件加载 Javascript。通常，您会看到信息栏下拉并指出这一点。您必须单击该栏并选择“允许阻止的内容”，然后 IE7 将重新加载启用 Javascript 的页面。

这种行为是一致的。但是，如果某些系统禁用了信息栏的显示，现在您可以通过方法了解问题所在。

我的建议是在您的 HTML 页面顶部添加一个 < noscript > 标记，并使用 CSS 使用粗体红色背景对其进行样式化，这样您就不会错过它。StackOverflow 使用了这种技术。

通过这种方式，您肯定会知道是否由于安全原因未加载 Javascript。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-11T14:23:30.217

对于任何有同样问题的人来说，仅供参考。

这从未解决，但我现在相信它与 Visual Studio 开发服务器有关，我怀疑如果我使用 IIS 是否会发生这种情况。不幸的是，我不再从事那个项目，所以我无法测试它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-10-09T03:26:45.970

我遇到了与原始海报完全相同的问题，并且尝试了许多提供的解决方案均无济于事。

我终于通过更新运行 apache 服务器的机器上的日期和时间来修复它。它关闭了几天（在 VM 中间歇性运行的结果）

希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T16:47:01.287

而不是`src="js/AjaxTry.Utility.js"`试试这个：

```
src="<% ResolveUrl("~/path/from/root/to/js/Ajax.Utility.js") %> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T16:43:36.880

另一个想法：您是否在测试之间刷新浏览器缓存？浏览器完全可以自由地缓存它认为合适的脚本，除非阻止这样做 - 通常你只会在编辑脚本、样式表和图像时注意到

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T16:55:14.137

您是否使用[Fiddler](http://www.fiddler2.com/fiddler2/)之类的工具检查了对该 .js 文件的调用是否正在对服务器或浏览器缓存进行，并且浏览器实际上正在正确接收文件，并且没有得到 404 或类似的信息？

您应该在实际调用相关方法的页面上检查这一点 - 因为您的路径是相对 url（即不以“/”开头），所以您调用它的页面是否有任何可能性在 js 文件夹下面，但可能在它旁边？

从站点的根目录想象这样的站点结构：

```
/page1.aspx
/folder/page2.aspx
/js/Ajax.Utility.js 
```

如果 page1 和 page2 都调用了 .js 文件，那么实际上只有 page1 能够正确使用检索它 - page2 将有效地寻找：

```
/folder/js/Ajax.Utility.js 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-14T20:36:52.607

我在使用 IE7 时遇到了同样的问题，问题在于我使用“super”作为保留关键字的属性，而 IE7 静默地没有加载页面。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-12-18T10:12:33.343

大多数浏览器似乎都可以容忍额外的逗号，例如在对象属性列表的定义中：

```
var obj = {prop1: 'value',
           prop2: 'value',}; 
```

Internet Explorer 不能容忍最后的逗号。每当我遇到这个问题时，它总是被证明是由于一个额外的逗号。此外，IE 调试器不会标记源问题，它只是从未正确加载的文件中删除缺少的定义。

# asp.net-mvc - 单声道 2.2 上的 ASP.NET mvc

> ID：678212
> 
> 赞同：6
> 
> 时间：2009-03-24T16:35:31.797
> 
> 标签：asp.net-mvc, mono

我有麻烦了。我正在尝试在单声道 2.2 上运行 asp.net mvc 1.0。我已将 system.web.mvc.dll 复制到 bin 目录。我已经完成了 HttpContext.Current.RewritePath("/Home/Index");。我仍然有错误：

“/”应用程序中的服务器错误传入的请求与任何路由都不匹配

说明：HTTP 500。处理请求时出错。

堆栈跟踪：

> System.Web.HttpException：传入的请求与 System.Web.Routing.UrlRoutingHandler.ProcessRequest (System.Web.HttpContextBase httpContext) [0x00000] 的 System.Web.Routing.UrlRoutingHandler.ProcessRequest (System.Web. HttpContext httpContext) [0x00000] 在 System.Web.Routing.UrlRoutingHandler.System.Web.IHttpHandler.ProcessRequest (System.Web.HttpContext 上下文) [0x00000] 在 MvcApplication4._Default.Page_Load (System.Object 发件人，System.EventArgs e) [0x00000] 在 System.Web.UI.Control.OnLoad (System.EventArgs e) [0x00000] 在 System.Web.UI.Control.LoadRecursive () [0x00000] 在 System.Web.UI.Page.ProcessLoad () [ 0x00000] 在 System.Web.UI.Page.ProcessPostData () [0x00000] 在 System.Web.UI.Page.InternalProcessRequest () [0x00000] 在 System.Web.UI.Page.ProcessRequest (System.Web.HttpContext 上下文) [0x00000]

版本信息：Mono 版本：2.0.50727.1433；ASP.NET 版本：2.0.50727.1433

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-26T16:17:43.963

我终于设法让它运行起来。似乎 ASP.NET 3.5 MVC 应用程序无需修改即可使用来自 svn 的最新单声道（它们不在单声道 2.2 上）。编译它的详细说明在这里：[http ://www.mono-project.com/Compiling_Mono_From_SVN](http://www.mono-project.com/Compiling_Mono_From_SVN)

显然，您需要将 System.Web.Mvc.dll 复制到应用程序的 bin/ 子目录中。

如果有人在 32 位 Linux 上需要 Mono 和 xsp，这是我的构建：[http ://www.speedyshare.com/283727620.html](http://www.speedyshare.com/283727620.html)

更新：2.4 版本已经发布，快去获取吧！

另一个更新：2.6.1 是截至 2010 年 3 月 15 日的最新版本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T20:39:35.963

正如在[另一个](https://stackoverflow.com/questions/202430)问题中提到的，它将与 2.4 一起使用。我非常相信它不会与其他任何东西一起使用，尽管 2.2 确实涵盖了 .NET 3.5 SP1 中的路由......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T16:42:44.073

这是一个“是否已插入”的问题-您是否移动了`Global.asax`文件？您看到的错误的第一个原因是缺失`Global.asax`，因为该文件包含您的所有路线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T18:11:44.593

好吧，我没有更改 global.asax 文件中的任何内容。使用 .net 它运行完美。如果我使用单声道，则会发生此错误。

# .net - 将 DTO 映射到域对象的最佳实践？

> ID：678217
> 
> 赞同：91
> 
> 时间：2009-03-24T16:36:42.590
> 
> 标签：.net, asp.net, design-patterns, dto

我见过很多与将[DTO](https://en.wikipedia.org/wiki/Data_transfer_object)映射到域对象相关的问题，但我觉得他们没有回答我的问题。我以前用过很多方法，也有自己的看法，但我正在寻找更具体的方法。

**情况：**

我们有很多领域对象。我们正在使用 CSLA 模型，因此我们的域对象可能非常复杂，并且它们包含自己的数据访问权限。你不想在电线上传递这些。我们将编写一些新服务，这些服务将以多种格式（.Net、JSON 等）返回数据。出于这个（和其他原因），我们还创建了一个精简的数据传输对象以在网络上传递。

**我的问题是：DTO 和 Domain 对象应该如何连接？**

我的第一反应是使用[Fowler，DTO 模式类型的解决方案](http://martinfowler.com/eaaCatalog/dataTransferObject.html)。我已经看过很多次了，这对我来说是正确的。域对象不包含对 DTO 的引用。调用外部实体（“映射器”或“组装器”）从域对象创建 DTO。通常在域对象端有一个[ORM](https://en.wikipedia.org/wiki/Object-relational_mapping)。这样做的缺点是“映射器”对于任何实际情况都会变得极其复杂，并且可能非常脆弱。

提出的另一个想法是域对象“包含” DTO，因为它只是一个精益数据对象。域对象属性将在内部引用 DTO 属性，并且可以在需要时返回 DTO。我看不出这有什么问题，但感觉不对。我看过一些文章，使用[NHibernate](https://nhibernate.info/)的人似乎使用了这种方法。

**还有其他方法吗？以上方法之一值得使用吗？如果是或不是，为什么？**

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-24T16:47:52.050

当您仅支持单个映射时，将映射器置于域和 DTO 之间的好处并不明显，但随着映射数量的增加，将该代码与域隔离有助于使域更简单和更精简。您不会因为过多的额外重量而使您的域混乱。

就个人而言，我尝试将映射排除在我的域实体之外，并将责任放在我所谓的“管理器/服务层”中。这是一个位于应用程序和存储库之间的层，并提供诸如工作流协调之类的业务逻辑（如果您修改 A，您可能还必须修改 B，以便服务 A 可以与服务 B 一起使用）。

如果我有很多可能的结束格式，我可能会考虑创建一个可以使用访问者模式的可插入格式化程序，例如转换我的实体，但我还没有发现需要如此复杂的任何东西。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-24T16:41:44.390

您可以使用自动映射器，例如[Jimmy Bogard 编写](http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/01/22/automapper-the-object-object-mapper.aspx)的自动映射器，它在对象之间没有任何联系，并且依赖于遵守的命名约定。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2019-06-21T22:23:48.180

将映射逻辑保留在实体内部意味着您的域对象现在知道它不需要知道的“实现细节”。通常，DTO 是您通往外部世界的网关（来自传入请求或通过从外部服务/数据库读取）。由于实体是业务逻辑的一部分，因此最好将这些详细信息保留在实体之外。

将映射保存在其他地方将是唯一的选择——但它应该去哪里呢？我已经尝试过引入映射对象/服务，但毕竟说了又做了，这似乎是过度工程（并且可能是）。我在使用 Automapper 等小型项目方面取得了一些成功，但像 Automapper 这样的工具也有其自身的缺陷。我很难找到与映射相关的问题，因为 Automapper 的映射是隐式的，并且与您的其余代码完全解耦（不像“关注点分离”，而更像是“上帝遗弃的映射在哪里”）所以他们有时很难追踪。并不是说 Automapper 没有它的用​​途，因为它有。我只是认为映射应该是尽可能明显和透明的东西，以避免出现问题。

我没有创建映射服务层，而是成功地将我的映射保存在我的 DTO 中。由于 DTO 始终位于应用程序的边界，因此可以让它们了解业务对象并弄清楚如何映射到它们。即使映射的数量扩展到合理的数量，它也可以干净地工作。所有映射都在一个地方，您不必在数据层、反腐败层或表示层内管理一堆映射服务。相反，映射只是委托给与请求/响应相关的 DTO 的实现细节。由于序列化程序通常仅在您通过网络发送属性和字段时对其进行序列化，因此您不应该遇到任何问题。就个人而言，我发现这是最干净的选择，根据我的经验，我可以说，

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-12-02T09:40:17.763

我们使用 T4 模板来创建映射类。

Pro's - 在编译时可用的人类可读代码，比运行时映射器更快。100% 控制代码（可以使用部分方法/模板模式来临时扩展功能）

Con's - 不包括某些属性、领域对象的集合等，学习 T4 语法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-06-25T14:23:53.940

您如何看待在 DTO 类中实现一个将域对象作为参数的构造函数？

说...像这样的东西

```
class DTO {

     // attributes 

     public DTO (DomainObject domainObject) {
          this.prop = domainObject.getProp();
     }

     // methods
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-22T08:37:05.357

另一种可能的解决方案：http: [//glue.codeplex.com](http://glue.codeplex.com)。

特征：

*   双向映射
*   自动映射
*   不同类型之间的映射
*   嵌套映射和展平
*   列表和数组
*   关系验证
*   测试映射
*   属性、字段和方法

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-30T21:22:42.647

你也可以试试 Otis，一个对象到对象的映射器。概念类似于 NHibernate 映射（属性或 XML）。

[http://code.google.com/p/otis-lib/wiki/GettingStarted](http://code.google.com/p/otis-lib/wiki/GettingStarted)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-07T23:46:51.750

我可以推荐一个我创建的工具，它是托管在 CodePlex 的开源工具：[EntitiesToDTOs](http://entitiestodtos.codeplex.com)。

从 DTO 到实体的映射，反之亦然，是通过扩展方法实现的，这些方法构成了每一端的汇编器端。

您以如下代码结束：

```
Foo entity = new Foo();
FooDTO dto = entity.ToDTO();
entity = dto.ToEntity();

List<Foo> entityList = new List<Foo>();
List<FooDTO> dtoList = entityList.ToDTOs();
entityList = dtoList.ToEntities(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-08T15:15:23.427

另一种选择是使用[ModelProjector](https://github.com/glaures/modelprojector)。它支持所有可能的场景，并且非常易于使用且占用空间极小。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-11-01T13:56:09.257

为此，我们可以使用 Factory、Memento 和 Builder 模式。工厂隐藏有关如何从 DTO 创建域模型实例的详细信息。Memento 将负责域模型与 DTO 的序列化/反序列化，甚至可以访问私有成员。Builder 将允许从 DTO 映射到具有流畅界面的域。

# visual-studio-2008 - VS2008 中的 Web 安装程序

> ID：678234
> 
> 赞同：1
> 
> 时间：2009-03-24T16:40:53.393
> 
> 标签：visual-studio-2008, installation

1.  如何配置我的虚拟目录以通过安装程序检查 Windows 集成安全性和匿名检查。

2.  如何将我新创建的虚拟目录分配给已在 IIS6.0 上创建的指定 appPool？

任何代码片段以及如何通过自定义操作编辑器/任何网站执行这些操作将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-01T08:29:26.017

除了查看我最近开始查看的[Windows Installer XML (WiX)](http://wix.sourceforge.net/)之外，我无法为您提供完整的答案。下面的两个链接提供了一些 WiX 代码片段的起点

*   [Windows 安装程序 XML (WiX) 3.0 片段](http://blog.wharton.com.au/2007/06/windows-installer-xml-wix-30-snippets.html)
*   [使用 WiX 创建虚拟目录是一种享受](http://strangelights.com/blog/archive/2004/10/08/179.aspx)

VS2k8 中的安装程序/安装程序项目并不是特别可扩展（至少我发现了！），因此更改为 WiX 之类的可能是您最好的选择。有点一步学习曲线，但希望你所追求的。

# python - 如何从 Python 中的路径获取不带扩展名的文件名？

> ID：678236
> 
> 赞同：1387
> 
> 时间：2009-03-24T16:41:03.283
> 
> 标签：python, string, path

如何从 Python 中的路径获取不带扩展名的文件名？

例如，如果我有`"/path/to/some/file.txt"`，我会想要`"file"`。

* * *

## 回答 #1

> 赞同：1582
> 
> 时间：2009-03-24T16:43:15.493

获取不带扩展名的文件名：

```
import os
print(os.path.splitext("/path/to/some/file.txt")[0]) 
```

印刷：

```
/path/to/some/file 
```

[的文档`os.path.splitext`](https://docs.python.org/3/library/os.path.html#os.path.splitext)。

*重要提示：*如果文件名有多个点，则仅删除最后一个后的扩展名。例如：

```
import os
print(os.path.splitext("/path/to/some/file.txt.zip.asc")[0]) 
```

印刷：

```
/path/to/some/file.txt.zip 
```

如果您需要处理这种情况，请参阅下面的其他答案。

* * *

## 回答 #2

> 赞同：853
> 
> 时间：2017-11-26T13:32:33.110

[`.stem`](https://docs.python.org/3/library/pathlib.html#pathlib.PurePath.stem)在[`pathlib`](https://docs.python.org/library/pathlib.html)Python 3.4+ 中使用

```
from pathlib import Path

Path('/root/dir/sub/file.ext').stem 
```

将返回

```
'file' 
```

请注意，如果您的文件有多个扩展名，`.stem`则只会删除最后一个扩展名。例如，`Path('file.tar.gz').stem`将返回`'file.tar'`.

* * *

## 回答 #3

> 赞同：712
> 
> 时间：2009-03-24T16:49:53.043

您可以自己制作：

```
>>> import os
>>> base=os.path.basename('/root/dir/sub/file.ext')
>>> base
'file.ext'
>>> os.path.splitext(base)
('file', '.ext')
>>> os.path.splitext(base)[0]
'file' 
```

重要提示：如果文件名中有多个`.`，则仅删除最后一个。例如：

```
/root/dir/sub/file.ext.zip -> file.ext

/root/dir/sub/file.ext.tar.gz -> file.ext.tar 
```

有关解决该问题的其他答案，请参见下文。

* * *

## 回答 #4

> 赞同：258
> 
> 时间：2009-08-04T16:44:50.867

```
>>> print(os.path.splitext(os.path.basename("/path/to/file/hemanth.txt"))[0])
hemanth 
```

* * *

## 回答 #5

> 赞同：105
> 
> 时间：2017-08-24T16:08:01.677

在 Python 3.4+ 中，您可以使用该[`pathlib`](https://docs.python.org/library/pathlib.html#pathlib.PurePath.stem)解决方案

```
from pathlib import Path

print(Path(your_path).resolve().stem) 
```

* * *

## 回答 #6

> 赞同：70
> 
> 时间：2018-07-23T09:20:15.853

[https://docs.python.org/3/library/os.path.html](https://docs.python.org/3/library/os.path.html)

在 python 3 pathlib 中，“pathlib 模块提供了高级路径对象。” 所以，

```
>>> from pathlib import Path

>>> p = Path("/a/b/c.txt")
>>> p.with_suffix('')
WindowsPath('/a/b/c')
>>> p.stem
'c' 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2016-06-11T05:17:08.293

如果扩展中有多个点，os.path.splitext()**将不起作用。**

例如，images.tar.gz

```
>>> import os
>>> file_path = '/home/dc/images.tar.gz'
>>> file_name = os.path.basename(file_path)
>>> print os.path.splitext(file_name)[0]
images.tar 
```

您可以在基本名称中找到第一个点的索引，然后对基本名称进行切片以仅获取不带扩展名的文件名。

```
>>> import os
>>> file_path = '/home/dc/images.tar.gz'
>>> file_name = os.path.basename(file_path)
>>> index_of_dot = file_name.index('.')
>>> file_name_without_extension = file_name[:index_of_dot]
>>> print file_name_without_extension
images 
```

* * *

## 回答 #8

> 赞同：30
> 
> 时间：2013-10-21T07:46:11.183

如果您想保留文件的路径并删除扩展名

```
>>> file = '/root/dir/sub.exten/file.data.1.2.dat'
>>> print ('.').join(file.split('.')[:-1])
/root/dir/sub.exten/file.data.1.2 
```

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2017-05-23T20:09:13.030

@IceAdor's 在对@user2902201 的解决方案的评论中引用 rsplit。rsplit 是支持多个周期的最简单的解决方案。

这里是这样写的：

```
file = 'my.report.txt'
print file.rsplit('.', 1)[0] 
```

我的报告

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2009-03-24T16:45:02.103

> 但即使我导入 os，我也无法将其命名为 path.basename。是否可以像 basename 一样直接调用它？

`import os`，然后使用`os.path.basename`

`import`ing`os`并不意味着您可以`os.foo`在不引用的情况下使用`os`.

* * *

## 回答 #11

> 赞同：20
> 
> 时间：2018-02-27T07:41:35.603

以为我会在不需要使用数组索引的情况下对[os.path.splitext的使用进行更改。](https://docs.python.org/3/library/os.path.html#os.path.splitext)

该函数始终返回一`(root, ext)`对，因此可以安全使用：

`root, ext = os.path.splitext(path)`

例子：

```
>>> import os
>>> path = 'my_text_file.txt'
>>> root, ext = os.path.splitext(path)
>>> root
'my_text_file'
>>> ext
'.txt' 
```

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2019-06-11T14:49:05.210

其他方法不会删除多个扩展名。有些还存在没有扩展名的文件名问题。这个片段处理这两个实例，并且在 Python 2 和 3 中都有效。它从路径中获取基本名称，将值拆分为点，然后返回第一个，它是文件名的初始部分。

```
import os

def get_filename_without_extension(file_path):
    file_basename = os.path.basename(file_path)
    filename_without_extension = file_basename.split('.')[0]
    return filename_without_extension 
```

这是一组要运行的示例：

```
example_paths = [
    "FileName", 
    "./FileName",
    "../../FileName",
    "FileName.txt", 
    "./FileName.txt.zip.asc",
    "/path/to/some/FileName",
    "/path/to/some/FileName.txt",
    "/path/to/some/FileName.txt.zip.asc"
]

for example_path in example_paths:
    print(get_filename_without_extension(example_path)) 
```

在每种情况下，打印的值都是：

```
FileName 
```

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2019-09-29T01:26:09.943

```
import os
filename, file_extension =os.path.splitext(os.path.basename('/d1/d2/example.cs')) 
```

*   文件名是“示例”

*   文件扩展名是'.cs'

'

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2021-02-12T15:51:47.920

## 两个或更少的分机

正如其他 Pathlib 答案的评论中所提到的，处理多个后缀可能很尴尬。`.with_suffix('')`使用and处理两个或更少的后缀并不是那么糟糕`.stem`。

```
from pathlib import Path

pth = Path('foo/bar/baz.baz/thefile.tar.gz')

fn = pth.with_suffix('').stem

print(fn)      # thefile 
```

## 任意数量的扩展

如果可能有两个以上的扩展，您可以使用循环来处理可能有 0、1 或许多后缀的一般情况。

```
pth = Path('foo/bar/baz/thefile.tar.gz.bz.7zip')

pth.name       # 'thefile.tar.gz.bz.7zip'
pth.suffixes   # ['.tar', '.gz', '.bz', '.7zip'] 
```

所以

```
fn = pth.name
for s in pth.suffixes:
    fn = fn.rsplit(s)[0]

print(fn)      # thefile 
```

或者

```
fnp = Path(pth.name)  
for _ in fnp.suffixes:
    fnp = fnp.with_suffix('')

print(fnp)     # thefile 
```

注意这里`fnp`是一个路径，while`fn`是一个字符串，它可以决定首选的循环形式。

### *如果您知道第一个扩展名*

例如，如果扩展名可以是`.tar`, `.tar.gz`, `.tar.gz.bz`, 等；您可以简单地`rsplit`使用已知扩展名并获取第一个元素：

```
 pth = Path('foo/bar/baz.baz/thefile.tar.gz')

fn = pth.name.rsplit('.tar')[0]

print(fn)      # thefile 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2017-01-10T23:29:40.280

`import os`

```
filename = C:\\Users\\Public\\Videos\\Sample Videos\\wildlife.wmv 
```

这将返回`filename`没有`extension`(C:\Users\Public\Videos\Sample Videos\wildlife)

```
temp = os.path.splitext(filename)[0] 
```

现在你可以`filename`从 temp 中得到

```
os.path.basename(temp)   #this returns just the filename (wildlife) 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-10-18T13:15:08.703

一个多扩展感知过程。适用于`str`和`unicode`路径。在 Python 2 和 3 中工作。

```
import os

def file_base_name(file_name):
    if '.' in file_name:
        separator_index = file_name.index('.')
        base_name = file_name[:separator_index]
        return base_name
    else:
        return file_name

def path_base_name(path):
    file_name = os.path.basename(path)
    return file_base_name(file_name) 
```

行为：

```
>>> path_base_name('file')
'file'
>>> path_base_name(u'file')
u'file'
>>> path_base_name('file.txt')
'file'
>>> path_base_name(u'file.txt')
u'file'
>>> path_base_name('file.tar.gz')
'file'
>>> path_base_name('file.a.b.c.d.e.f.g')
'file'
>>> path_base_name('relative/path/file.ext')
'file'
>>> path_base_name('/absolute/path/file.ext')
'file'
>>> path_base_name('Relative\\Windows\\Path\\file.txt')
'file'
>>> path_base_name('C:\\Absolute\\Windows\\Path\\file.txt')
'file'
>>> path_base_name('/path with spaces/file.ext')
'file'
>>> path_base_name('C:\\Windows Path With Spaces\\file.txt')
'file'
>>> path_base_name('some/path/file name with spaces.tar.gz.zip.rar.7z')
'file name with spaces' 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2015-05-28T13:24:52.347

```
import os
path = "a/b/c/abc.txt"
print os.path.splitext(os.path.basename(path))[0] 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2020-04-19T20:50:23.703

非常非常非常简单，没有其他模块！！！

```
import os
p = r"C:\Users\bilal\Documents\face Recognition python\imgs\northon.jpg"

# Get the filename only from the initial file path.
filename = os.path.basename(p)

# Use splitext() to get filename and extension separately.
(file, ext) = os.path.splitext(filename)

# Print outcome.
print("Filename without extension =", file)
print("Extension =", ext) 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2013-08-19T09:12:48.097

在 Windows 系统上，我也使用了 drivername 前缀，例如：

```
>>> s = 'c:\\temp\\akarmi.txt'
>>> print(os.path.splitext(s)[0])
c:\temp\akarmi 
```

所以因为我不需要驱动器号或目录名，所以我使用：

```
>>> print(os.path.splitext(os.path.basename(s))[0])
akarmi 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2021-07-16T05:05:24.827

我已经阅读了答案，我注意到有很多好的解决方案。因此，对于那些希望获得（名称或扩展名）的人来说，这里有另一个解决方案，使用[os 模块](https://docs.python.org/3/library/os.html)，这两种方法都支持具有多个扩展名的文件。

```
import os

def get_file_name(path):
    if not os.path.isdir(path):
        return os.path.splitext(os.path.basename(path))[0].split(".")[0]

def get_file_extension(path):
    extensions = []
    copy_path = path
    while True:
        copy_path, result = os.path.splitext(copy_path)
        if result != '':
            extensions.append(result)
        else:
            break
    extensions.reverse()
    return "".join(extensions) 
```

注意：Windows 上的此解决方案不支持带有“\”字符的文件名

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2015-01-10T07:05:52.910

我们可以做一些简单的`split`/`pop`魔术，如这里（[https://stackoverflow.com/a/424006/1250044](https://stackoverflow.com/a/424006/1250044)）所见，提取文件名（尊重 windows 和 POSIX 差异）。

```
def getFileNameWithoutExtension(path):
  return path.split('\\').pop().split('/').pop().rsplit('.', 1)[0]

getFileNameWithoutExtension('/path/to/file-0.0.1.ext')
# => file-0.0.1

getFileNameWithoutExtension('\\path\\to\\file-0.0.1.ext')
# => file-0.0.1 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2016-09-22T20:23:28.693

为方便起见，一个简单的函数包装了两个方法[`os.path`](https://docs.python.org/3/library/os.path.html)：

```
def filename(path):
  """Return file name without extension from path.

  See https://docs.python.org/3/library/os.path.html
  """
  import os.path
  b = os.path.split(path)[1]  # path, *filename*
  f = os.path.splitext(b)[0]  # *file*, ext
  #print(path, b, f)
  return f 
```

使用 Python 3.5 测试。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-10-24T01:51:55.023

解决这个问题的最简单方法是

```
import ntpath 
print('Base name is ',ntpath.basename('/path/to/the/file/')) 
```

这可以节省您的时间和计算成本。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2020-06-11T21:21:13.737

我看起来不是很努力，但我没有看到有人使用正则表达式来解决这个问题。

我将问题解释为“给定路径，返回不带扩展名的基本名称”。

例如

`"path/to/file.json"`=>`"file"`

`"path/to/my.file.json"`=>`"my.file"`

在 Python 2.7 中，我们仍然没有`pathlib`...

```
def get_file_name_prefix(file_path):
    basename = os.path.basename(file_path)

    file_name_prefix_match = re.compile(r"^(?P<file_name_pre fix>.*)\..*$").match(basename)

    if file_name_prefix_match is None:
        return file_name
    else:
        return file_name_prefix_match.group("file_name_prefix") 
```

```
get_file_name_prefix("path/to/file.json")
>> file

get_file_name_prefix("path/to/my.file.json")
>> my.file

get_file_name_prefix("path/to/no_extension")
>> no_extension 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2021-06-09T14:38:56.373

改进@spinup 答案：

```
fn = pth.name
for s in pth.suffixes:
    fn = fn.rsplit(s)[0]
    break

print(fn)      # thefile 
```

这也适用于没有扩展名的文件名

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-06-01T13:27:06.207

```
import os
list = []
def getFileName( path ):
for file in os.listdir(path):
    #print file
    try:
        base=os.path.basename(file)
        splitbase=os.path.splitext(base)
        ext = os.path.splitext(base)[1]
        if(ext):
            list.append(base)
        else:
            newpath = path+"/"+file
            #print path
            getFileName(newpath)
    except:
        pass
return list

getFileName("/home/weexcel-java3/Desktop/backup")
print list 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-12-15T14:28:23.993

下面的呢？

```
import pathlib
filename = '/path/to/dir/stem.ext.tar.gz'
pathlib.Path(filename).name[:-len(''.join(pathlib.Path(filename).suffixes))]
# -> 'stem' 
```

还是这个等价物？

```
pathlib.Path(filename).name[:-sum(map(len, pathlib.Path(filename).suffixes))] 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2021-10-19T14:31:59.253

```
# use pathlib. the below works with compound filetypes and normal ones
source_file = 'spaces.tar.gz.zip.rar.7z'
source_path = pathlib.Path(source_file)
source_path.name.replace(''.join(source_path.suffixes), '')
>>> 'spaces' 
```

尽管上面描述了许多工作实现，但我添加了这个 ^，因为它仅使用 pathlib 并且适用于复合文件类型和普通文件类型

# css - 转换提交按钮的锚样式？

> ID：678250
> 
> 赞同：3
> 
> 时间：2009-03-24T16:45:49.853
> 
> 标签：css

我有一个 CSS 类，使我的链接看起来像漂亮的按钮。我希望能够将相同的样式应用于提交按钮并使它们看起来也一样。最棘手的部分是锚标签需要在其中有一个跨度，我认为表单提交按钮不可能做到这一点。那么有谁知道我如何使提交按钮与链接匹配？

这是CSS：

```
a.button {
    background: transparent url('images/all_pages/bg_button_a.jpg') no-repeat scroll top right;
    color: #FFF;
    display: block;
    font-family:Verdana, Arial, Helvetica, sans-serif;
    font-size:16px;
    font-weight:bold;
    height: 24px;
    margin-right: 6px;
    padding-right: 18px; /* sliding doors padding */
    text-decoration: none;
}

a.button span {
    background: transparent url('images/all_pages/bg_button_span.jpg') no-repeat;
    display: block;
    line-height: 14px;
    padding: 5px 0 5px 18px;
}

a.button:hover {
    background-position: bottom right;
}

a.button:hover span {
    background-position: bottom left;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T16:48:01.940

尝试使用`<button>`标签而不是`<input type="submit">`. `<button>`标签允许您嵌套元素，例如，`<span>`并且通常为您提供更多样式自由。

将表单的提交按钮切换为使用`<button>`标签后，您可以将相同的 CSS 应用于您的链接和按钮：

```
a.button,
button {
  /* ... */
}
a.button span,
button span {
  /* ... */
}
a.button:hover,
a.button:focus,
button:hover,
button:focus {
  /* ... */
}
a.button:hover span,
a.button:focus span,
button:hover span,
button:focus span {
  /* ... */
} 
```

为了提高可访问性，`:hover`上面的每个样式块也扩展为覆盖`:focus`状态。

这是一篇关于使用`<button>`标签的不错的文章：http: [//particletree.com/features/rediscovering-the-button-element/](http://particletree.com/features/rediscovering-the-button-element/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:48:24.717

用 a`<button type="submit"><span>Submit!</span></button>`代替怎么样？

此外，您可能会发现[这里描述的技术](http://stopdesign.com/archive/2009/02/04/recreating-the-button.html)很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T16:49:06.477

您可以使用`<a href="javascript: document.myform.submit()"></a>`或类似的东西通过常规链接提交表单。然后，您不需要按钮。:)

# tsql - 列的 SQL 服务器名称作为变量

> ID：678251
> 
> 赞同：0
> 
> 时间：2009-03-24T16:46:30.993
> 
> 标签：tsql, variables

我在存储过程中有以下语句。我将列的名称作为参数传递，还有要在另一个变量中检查的值。是否可以在 SQL Server 中完成此操作。请告诉我。

* * *

```
 SELECT CaseId FROM app_Case 
        where @SearchCat=@keywords
        ORDER BY CreatedDate DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:49:12.547

我认为这样做的唯一方法是生成动态 SQL 语句。另一种选择是将所有列值作为参数，将它们默认为空，然后检查它。

IE

```
WHERE (cola = @cola OR @cola IS NULL) AND (colb = @colb OR @colb IS NULL) etc. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T16:51:15.303

您需要在 SP 中创建一个 SQL 字符串并执行它。

```
Declare @SQL As VARCHAR(8000)

SET @SQL = 'SELECT CaseId FROM app_Case where ' + 
           @SearchCat + ' = '' + @keywords + 
           '' ORDER BY CreatedDate DESC'

EXEC(@SQL) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T16:59:13.787

您可以构建动态查询本质上您构建一个字符串然后执行它。（注意 SQL 注入攻击）。

另一种方法是使用 case 语句，如果您没有很多选择，可能值得尝试：

```
select CaseId from app_Case
where case when @searchCat='field1'
         then field1 
         else @searchVal 
      end = @searchVal and
      case when @searchCat='field2' 
         then field2 
         else @searchVal 
      end = @searchVal 
```

另一种方法是使用 or 子句做同样的事情：

```
 select CaseId from app_Case
   where (@searchCat='Field1' and Field1=@searchVal) OR
         (@serachCat='Field2' and Field2=@searchVal) 
```

# c - 如果两个库提供同名函数产生冲突怎么办？

> ID：678254
> 
> 赞同：115
> 
> 时间：2009-03-24T16:47:28.417
> 
> 标签：c, conflict, name-collision

如果我有两个提供同名函数的库，我该怎么办？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-24T17:20:40.333

It is possible to rename symbols in an object file using `objcopy --redefine-sym old=new file` (see man objcopy).

Then just call the functions using their new names and link with the new object file.

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-03-24T17:02:43.823

*   如果您控制一个或两个：编辑一个以更改名称并重新编译或等效地查看[Ben](https://stackoverflow.com/questions/678254/c-function-conflict/678375#678375)和[unknown](https://stackoverflow.com/questions/678254/c-function-conflict/678350#678350)的答案，这将在*无需*访问源代码的情况下工作。
*   如果您不控制其中任何一个，则可以将其中一个包裹起来。那就是编译*另一个*（**静态链接**！）库，除了重新导出原始符号之外的所有符号之外什么都不做，除了有问题的符号，这是通过具有备用名称的包装器到达的。真麻烦。
*   **稍后添加：**由于 qeek 说他在谈论动态库，因此[Ferruccio](https://stackoverflow.com/questions/678254/c-function-conflict/678453#678453)和[mouviciel](https://stackoverflow.com/questions/678254/c-function-conflict/678309#678309)建议的解决方案可能是最好的。（我似乎生活在很久以前静态链接是默认设置的时代。它影响了我的思考。）

适当的评论：通过“导出”，我的意思是使链接到库的模块可见——相当于`extern`文件范围内的关键字。这是如何控制的取决于操作系统和链接器。这是我*必须经常*查找的东西。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-03-24T17:38:04.237

Under Windows, you could use [LoadLibrary()](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx) to load one of those libraries into memory and then use [GetProcAddress()](http://msdn.microsoft.com/en-us/library/ms683212(VS.85).aspx) to get the address of each function you need to call and call the functions through a function pointer.

e.g.

```
HMODULE lib = LoadLibrary("foo.dll");
void *p = GetProcAddress(lib, "bar");
// cast p to the approriate function pointer type (fp) and call it
(*fp)(arg1, arg2...);
FreeLibrary(lib); 
```

would get the address of a function named bar in foo.dll and call it.

I know Unix systems support similar functionality, but I can't think of their names.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-12-29T08:19:36.303

If you have .o files there, a good answer here: [https://stackoverflow.com/a/6940389/4705766](https://stackoverflow.com/a/6940389/4705766)

Summary:

1.  `objcopy --prefix-symbols=pre_string test.o` to rename the symbols in .o file

or

2.  `objcopy --redefine-sym old_str=new_str test.o` to rename the specific symbol in .o file.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-24T17:12:23.503

Here's a thought. Open one of the offending libraries in a hex editor and change all occurrences of the offending strings to something else. You should then be able to use the new names in all future calls.

UPDATE: **I just did it on this end and it seems to work.** Of course, I've not tested this thoroughly - it may be no more than a really good way to blow your leg off with a hexedit shotgun.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-24T17:01:38.460

你不应该一起使用它们。如果我没记错的话，链接器会在这种情况下发出错误。

我没有尝试，但可能有一个解决方案，`dlopen()`它允许您以编程方式处理动态库。如果您不需要同时使用这两个函数，您可以打开第一个库，使用第一个函数并关闭第一个库，然后再使用第二个库/函数。`dlsym()``dlclose()`

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-07-04T14:12:34.637

Assuming that you use linux you first need to add

```
#include <dlfcn.h> 
```

Declare function pointer variable in proper context, for example,

```
int (*alternative_server_init)(int, char **, char **); 
```

Like Ferruccio stated in [https://stackoverflow.com/a/678453/1635364](https://stackoverflow.com/a/678453/1635364) , load explicitly the library you want to use by executing (pick your favourite flags)

```
void* dlhandle;
void* sym;

dlhandle = dlopen("/home/jdoe/src/libwhatnot.so.10", RTLD_NOW|RTLD_LOCAL); 
```

Read the address of the function you want to call later

```
sym = dlsym(dlhandle, "conflicting_server_init"); 
```

assign and cast as follows

```
alternative_server_init = (int (*)(int, char**, char**))sym; 
```

Call in a similar way than the original. Finally, unload by executing

```
dlclose(dlhandle); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-24T16:54:43.093

发誓？据我所知，如果您有两个库公开了具有相同名称的链接点并且您需要链接这两个库，那么您无能为力。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-24T17:02:52.653

这个问题是 c++ 有命名空间的原因。对于 2 个具有相同名称的第三方库，在 c 中并没有真正好的解决方案。

如果它是动态对象，您可能能够显式加载共享对象（LoadLibrary/dlopen/etc）并以这种方式调用它。或者，如果您不需要在同一代码中同时使用两个库，您可以使用静态链接来做一些事情（如果您有 .lib/.a 文件）。

当然，这些解决方案都不适用于所有项目。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-24T17:07:11.847

You should write a wrapper library around one of them. Your wrapper library should expose symbols with unique names, and not expose the symbols of the non-unique names.

Your other option is to rename the function name in the header file, and rename the symbol in the library object archive.

Either way, to use both, it's gonna be a hack job.

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-11-01T19:59:43.527

The question is approaching a decade old, but there are new searches all the time...

As already answered, objcopy with the --redefine-sym flag is a good choice in Linux. See, for example, [https://linux.die.net/man/1/objcopy](https://linux.die.net/man/1/objcopy) for full documentation. It is a little clunky because you are essentially copying the entire library while making changes and every update requires this work to be repeated. But at least it should work.

For Windows, dynamically loading the library is a solution and a permanent one like the dlopen alternative in Linux would be. However both dlopen() and LoadLibrary() add extra code that can be avoided if the only issue is duplicate names. Here the Windows solution is more elegant than the objcopy approach: Just tell the linker that the symbols in a library are known by some other name and use that name. There a few steps to doing it. You need to make a def file and provide the name translation in the EXPORTS section. See [https://msdn.microsoft.com/en-us/library/hyx1zcd3.aspx](https://msdn.microsoft.com/en-us/library/hyx1zcd3.aspx) (VS2015, it will eventually get replaced by newer versions) or [http://www.digitalmars.com/ctg/ctgDefFiles.html](http://www.digitalmars.com/ctg/ctgDefFiles.html) (probably more permanent) for full syntax details of a def file. The process would be to make a def file for one of the libraries then use this def file to build a lib file and then link with that lib file. (For Windows DLLs, lib files only are used for linking, not code execution.) See [How to make a .lib file when have a .dll file and a header file](https://stackoverflow.com/questions/9360280/how-to-make-a-lib-file-when-have-a-dll-file-and-a-header-file) for the process of building the lib file. Here the only difference is adding the aliases.

For both Linux and Windows, rename the functions in the headers of the library whose names are being aliased. Another option that should work would be, in files referring to the new names, to #define old_name new_name, #include the headers of the library whose exports are being aliased, and then #undef old_name in the caller. If there are a lot of files using the library, an easier alternative is to make a header or headers that wraps the defines, includes and undefs and then use that header.

Hope this info was helpful!

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-24T17:06:22.083

我从未使用过 dlsym、dlopen、dlerror、dlclose、dlvsym 等，但我正在查看手册页，它提供了打开 libm.so 并提取 cos 函数的示例。dlopen 是否会经历寻找碰撞的过程？如果没有，OP 可以手动加载这两个库，并为他的库提供的所有功能分配新名称。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-21T11:57:34.170

If it's a builtin function. for example, torch has range method(deprecated)and builtin has range method as well.

I was having some issues and all it took was adding `__builtins__` before the function name. range() => torch **builtins**.range()

# perforce - 强制锁定分支？

> ID：678257
> 
> 赞同：7
> 
> 时间：2009-03-24T16:47:52.407
> 
> 标签：perforce

目前在我创建发布分支之后，但是当我们在发布之前有一段时间时，我有时会打开整个分支进行编辑，然后锁定所有文件，以防止任何人在发布分支的“代码冻结”期间修改任何内容.

有没有更好的办法？以我目前的方式这样做似乎可能是对锁定功能的错误使用，有没有更好的方法来阻止某人在不使用分支的情况下签入代码。我虽然是 P4 保护，但我不是这个 perforce 实例的管理员，而且处理可能有 100 行的保护文件也会变得很麻烦。

有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-24T17:42:47.923

作为构建工程师，我一直在这样做。我使用“p4保护”将每个人对树的访问限制为只读：

```
super group everyone * -//depot/project/branch/...
read group everyone * //depot/project/branch/...
super user me * //depot/project/branch/... 
```

第一行关闭所有用户对分支的所有权限（假设组 'everyone' 已正确定义。）

第二行重新建立每个人的读取权限。

最后一行重新建立了对我的所有权限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-27T17:22:56.230

The way to do this in modern Perforce is to use streams -- named branches that update in place on your local system, and can have permissions applied to encourage you to do the right thing when merging and copying between streams.

You can optionally restrict a stream so only the stream owner can check in (and you can lock the stream so no one but the owner can edit its properties). See [http://www.perforce.com/perforce/doc.current/manuals/p4guide/chapter.codelines.html#codelines.streams](http://www.perforce.com/perforce/doc.current/manuals/p4guide/chapter.codelines.html#codelines.streams)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T16:24:40.437

p4 protect 绝对是更好的选择——它就是为此而存在的。我强烈建议您将所有用户分组，并且只在保护表中使用组 - 更易于管理。

You can protect at any level of granularity you like, so is not unwieldy. Note also that the 2008.1 server release has a new protect feature that allows you to specify what you can do in a slightly different way. Change note:

```
#152278 **
    'p4 protect' now allows specification of permission 'rights'.
    Previously, 'p4 protect' only allowed using permission levels 
    which include the specified access (ie 'read') and also all
    of its lesser permissions (ie 'read' = 'read' + 'list').
    Permission rights make it possible to deny individual rights
    without having to re-grant lesser rights.  The new 
    permission rights are '=read', '=branch', '=open',
    and '=write'. This functionality was previously undocumented,
    and is now fully supported for 2008.1 
```

If you really have an issue with having to be an admin to lock & unlock this, then you should take a look at the "group owner" feature introduced in 2007.3\. This will let a non-super user to be able to add & remove people from a group. So combine that with the protections table. I.e. get site admin to set up the protections table, and restrict rights to a group named "Rel 1.0 Authorised", and make you the group owner. You can then add and remove users (or subgroups) from that group to control access.

The trigger option is a possibility, but you still need to be an admin to set up the trigger in the first place. You could also affect performance of all submissions, which is something to look out for. But the main issue with triggers is that you would be using them to emulate a built in feature designed for that purpose - i.e. protections table. And, if you wanted to be safe, you would still need to find some way of preventing anyone else modifying the reference file. It just seems like a lot of work to emulate an existing feature.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-13T09:40:49.667

As a slight addition to one of the other answers. First set up a group "everyone" which has all users in it. Then add this to p4 protect

```
write group everyone * -//depot/project/1.0/...
read group everyone * //depot/project/1.0/...
write group 1.0 * //depot/project/1.0/... 
```

This will allow you to create a group "1.0" into which you can add any users who are allowed write access.

If you are using server 2008.1 you can do this.

```
=write group everyone * -//depot/project/1.0/...
write group 1.0 * //depot/project/1.0/... 
```

The first line removes only the write access ( not read and list ) from the group everyone.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T23:25:43.207

正如其他答案中所解释的，P4 保护可能是大多数人的正确答案。

但是在我的组织中，我不能成为管理员，因此这样做的方法是在 perforce 中使用一个触发脚本，该脚本读取非管理员具有写入权限的文本文件并检查分支是否出现在列表中。这样就不需要像 p4 Protect 这样的管理员访问权限。

# php - 登录系统通常如何与 OOP 一起工作？

> ID：678259
> 
> 赞同：1
> 
> 时间：2009-03-24T16:48:15.357
> 
> 标签：php, oop, authentication

抱歉，如果这是一个格式错误的问题，但我正在尝试使我的 Web 应用程序（使用 PHP）更加面向对象。*EDIT* 我正在自己开发框架 */EDIT* 到目前为止一切都很好，我已经制作了一个接入 MVC 系统的前端控制器系统。FC 找出你想要的页面，加载特定的页面控制器（*EDIT*，它扩展了一个抽象的控制器对象 */EDIT*），它从模型中获取它需要的任何东西，然后调用适当的视图。很基础。

但是现在，我需要创建一个管理部分（准 CMS）。登录系统如何适应宏伟的计划？您是否将控制器设置为需要登录？如果是这样，怎么做？如果您只想要需要登录的控制器的某些视图怎么办？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T16:52:38.917

您使用的是哪个框架？我建议使用 Zend 或 CodeIgniter 之类的框架，而不是使用自己的框架。

无论如何，我问的原因是因为这些框架通常都有可用的登录框架。

它通常是如何工作的，每个控制器子类化一个抽象控制器类。在您的控制器构造函数中，您所做的是设置一个标志来表示它需要有效的登录。然后抽象类将检查每个请求的有效登录，并可以采取适当的行动（即重定向到登录控制器）。

显然，您可以使其比这更细粒度/更复杂，即在逐个方法的基础上。

# open-source - 开源服务有风险吗？

> ID：678264
> 
> 赞同：0
> 
> 时间：2009-03-24T16:49:18.457
> 
> 标签：open-source, service

依赖开源服务有风险吗？

与开源 dll 或组件不同，服务显然需要不断运行，因此依赖它是否存在业务风险？如果开源服务因某种原因消失会怎样？

所讨论的服务不会用于关键业务应用程序，但如果成功，它显然会变得重要吗？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T16:52:11.057

如果它真的是“开源”（而不是仅仅免费），您可以下载源代码并自己运行它，原始提供者会消失。当然，您需要提前下载源代码，因为如果服务提供商离开了，则不能保证会有一个站点可供下载。此外，如果可以的话，您可能希望自己保留数据备份。

但是，如果您误用“开源”一词来表示像 Google Maps API 这样的免费服务，那么是的，如果它消失了，那您就完蛋了。但如果谷歌地图消失了，一半的网络也会消失。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T16:53:50.757

究竟什么是“开源服务”？

*   任何提供 API 的旧网站？是的，这取决于风险——他们可能会破产或开始收费
*   或者一个发布它在开源许可下运行的软件的网站？只需下载一个副本，如果该站点消失，您始终可以选择自己运行它

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T16:54:08.680

更好的问题是：

**如果您依赖的付费企业倒闭了，而您没有任何代码，也没有任何支持，会发生什么？**

回想起来，开源保证了未来。你所要做的就是找人破解它。另一方面，专有的法律欢闹随之而来。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T16:54:21.597

恕我直言，与闭源服务相同。

通常，两者都有相同的被关闭的机会，当然通常会有惊喜，谷歌和微软也会在没有任何事先通知的情况下关闭服务。

正如保罗所说，如果它变得非常重要，如果它关闭，或者你需要它的大东西，你可以运行该服务。

但最重要的是，除了开源或闭源之外，您可以访问您的数据……以防服务关闭或您需要离开……您是否可以访问所有原始数据以进行迁移？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T16:58:20.823

可能是。但如果它不是任务关键型应用程序，它可能没问题。

我个人会尽量避免它，因为它的未来模糊。但是你永远不会真正知道商业服务是否会持续到明年。

只是不要紧紧地绑定到这个服务，也不要严格地为它设计。设计以便于将来切换到另一个类似的服务，甚至是非常不同的方法。

为类似服务系列设计。并且总是想一个逃生计划，以防这项服务消失，甚至是班级的所有服务。

我对此服务也有类似的考虑：[http ://www.webservicex.net](http://www.webservicex.net)

似乎可以免费访问，但谁真正运行它，谁能保证它明天会在那里？

至于明天，即使是谷歌邮件，也有几天会宕机。那么你想要免费的开源服务是什么？:)

# sql - 可以从没有西班牙语字符的表中检索值吗？

> ID：678286
> 
> 赞同：1
> 
> 时间：2009-03-24T16:54:55.090
> 
> 标签：sql, postgresql

可以从没有西班牙字符的任何给定表中检索一个值（用西班牙字符如“ñ”或“á”存储）？IE：

如果我存储了“Japón”值，请像“Japon”一样检索它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T16:58:33.817

[这可能会有所帮助（已](http://www.laudatio.com/wordpress/2008/11/05/postgresql-83-to_ascii-utf8/)[在此处](https://stackoverflow.com/questions/659076/how-can-i-do-a-accent-insensitive-search-in-postgres-8-3-x-with-a-db-in-utf-8)作为类似问题的答案提及）。

# c++ - C++ 序列化性能

> ID：678289
> 
> 赞同：7
> 
> 时间：2009-03-24T16:56:14.713
> 
> 标签：c++, serialization, boost, protocol-buffers

我正在构建一个分布式 C++ 应用程序，该应用程序需要对存储在 std 容器中的数据进行大量序列化和反序列化。

目前采用的是Boost.serialization。然而，它的表现很糟糕。我们的 B-tree 也使用了 Boost.serialization 来存储键值对数据，但是，如果我们将 Boost.serialziation 改为 memcpy，访问速度将提高 10 倍或更多。鉴于目前的分布式平台，需要进行如此多的数据交换，因此也需要易于编程和高性能。我知道协议缓冲区也可以用作序列化机制，但是，我不确定 Boost.serialization 和协议缓冲区之间的性能比较，另一个问题是，是否存在更好的解决方案来提供接近 memcpy 的更高性能？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T22:14:41.313

有人问了一个非常相似的问题： [C++ Serialization Performance](https://stackoverflow.com/questions/321619/c-serialization-performance)

看起来协议缓冲区是一个不错的选择，尽管在不了解应用程序要求的情况下，很难推荐任何特定的库或技术。

# database - 在文件系统中存储图像时，使用相对路径还是绝对路径？

> ID：678293
> 
> 赞同：3
> 
> 时间：2009-03-24T16:56:52.137
> 
> 标签：database, language-agnostic, architecture, image

我正在开发一个网络应用程序，我决定（在阅读了许多关于 SO 的帖子之后）将实际图像存储在文件系统中并将元数据存储在数据库中。

我应该存储相对路径还是绝对路径。

我可以想到每个选择的一些优点。

**绝对：**

*优点：*

文件的位置很明显，其他读取数据库的应用程序甚至
可以将照片放在驱动器上的任何位置（需要处理程序）

*缺点：*

需要将绝对路径转换为在站点中使用的相对路径或创建处理程序
如果我迁移到另一台服务器，我可能必须更改所有路径

**相对的：**

*优点：*

只需将链接添加到 html 即可

*缺点：*

如果我更改应用程序根目录，我必须移动图片或更改所有路径
必须将图片放在公共目录中（或者我对绝对路径一无所获）

好的，这些是我现在脑海中发生的一些事情。

我无法决定。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T17:04:51.680

我会在数据库中存储一个相对路径。这为您提供了最大的灵活性。加载图像很简单，只需添加一个“IMAGE_ROOT”变量（可能应该是可配置的）来获取文件系统路径。这很重要，因为您可能想要移动存储图像的位置（例如，将它们放在更快的驱动器上）。然后它只是更改可配置的 IMAGE_ROOT。

在将图片的引用放入页面时，我会放入完整的 URL。同样，这只是将 URL_ROOT 添加到相对路径。如果您发现负载需要专用服务器来提供图像，则这使您能够轻松切换服务器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T17:02:55.897

如果您对数据库中信息的可移植性感兴趣，只需在数据库中存储一个基本路径即可。这样，当您移动文件时，您需要做的就是修改您存储在数据库中的基本路径。此信息应与文件路径分开存储。将此类信息存储在同一行中会产生很多不必要的重复。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T17:04:39.857

我更喜欢将它们存储为相对路径，因此应用程序不依赖于它的位置。使用 ASP.NET 有“~”来自动表示应用程序根目录，您可以这样做，然后在使用它时简单地将其替换为常量，这样您就不必担心更改应用程序根目录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T17:05:18.357

如果您使用的是 SQL Server 2008，则可以使用新的[FILESTREAM 数据类型](http://technet.microsoft.com/en-us/library/bb933993.aspx)巧妙地解决此问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T17:05:27.467

我同意。存储相对路径意味着数据库中的信息更少，如果您将基本路径存储在某处，则只需修改一次。然后，通过将较短的链接从数据库添加到基本路径来构建完整的 url。

# actionscript-3 - ActionScript 3 - 从组件中创建的 TexInput 检索文本值

> ID：678304
> 
> 赞同：0
> 
> 时间：2009-03-24T16:59:38.933
> 
> 标签：actionscript-3

我有一个包含 TextInputs 和文本字段列表的磁贴布局，我使用以下代码在自定义组件中创建了这些字段；

```
var newTextInputs:Array = [];
        var newTextLabels = [];
        var space:Number = 30;
        var count:Number = 0;
        for (var i:String in columnsData)
        {
            //create text labels
            var label:Text = new Text();
            label.name = "label" + count;
            label.text = i;
            newTextLabels[count] = label;
            addChild(newTextLabels[count]);

            // create text fields
            var field:TextInput = new TextInput();
            field.name = "field" + count;
            field.width = 100;
            field.height = 25;
            field.text = columnsData[i];
            newTextInputs[count] = field;
            addChild(newTextInputs[count]);
            count++;    
        } 
```

允许用户编辑每个 TextInput 字段中的值，现在我需要检索新更新的值但是我如何访问这些字段？因为标识符是动态创建的，所以我不能简单地使用 componentName.InputFieldName，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T17:10:16.473

我认为您正在寻找的是[getChildByName](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/DisplayObjectContainer.html#getChildByName())

**稍后编辑：**用 Flash 和 TextField 测试，它可以工作：

```
trace(TextField(getChildByName('textfield')).text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T17:07:41.003

您可以为 TileList CHANGE 事件添加事件处理程序；当它触发时，我认为 event.target 属性将具有特定的 TextInput 字段。或者，您可以查看 TileList.SelectedItem 属性。

您还可以将 DataProvider 绑定到 TileList 而不是您的代码，如图所示，它将自动为您处理。尝试将您的 NewTextLabels 数组分配为 dataProvider。

# java - 找不到带有 javax.comm api 的端口

> ID：678305
> 
> 赞同：1
> 
> 时间：2009-03-24T16:59:58.463
> 
> 标签：java, api, javax.comm

我正在尝试在一台机器上安装 javax.comm api（我已经安装在另一台机器上并且它工作正常）但是当我运行示例“BlackBox”应用程序时，我收到一条消息，上面写着“没有找到串行端口！”。我按照说明将win32com.dll放在jdk的bin目录下，comm.jar放在jdk的lib目录下，javax.comm.properties放在jdk的lib目录下。由于我使用的是 jdk 而不是 jre，因此我还将 comm.jar 文件添加到类路径中。所有这一切，我仍然无法让 BlackBox 找到任何串行端口。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T18:57:08.243

您的 JDK 目录中有一个`jre`目录。使用`<jdk>/jre/lib`，不使用`<jdk>/lib`。此外，如果您已将`comm.jar`位于其他位置的另一个副本显式添加到您的类路径中，请将其取出。

您可能希望在`System.out.println(System.getProperty("java.home")`代码中添加一条语句，以确保将内容放在正确的目录中；即使你在运行时`<jdk>/bin/java`，`java.home`属性也应该是`<jdk>/jre`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-22T03:20:57.457

它在我的 Windows XP（32 位）和 jdk1.6.0_21 上运行良好，如下所示：

1）设置环境变量：

```
JAVA_HOME=C:\Program Files\Java\jdk1.6.0_21
Path=...;C:\Program Files\Java\jdk1.6.0_21\bin; 
```

2）安装三个文件：

```
C:\Program Files\Java\jre6\lib\comm.jar
C:\Program Files\Java\jre6\lib\javax.comm.properties
C:\Program Files\Java\jre6\bin\win32com.dll 
```

3）从终端运行如下：

```
cd commapi\samples

java -classpath "C:\Program Files\Java\jre6\lib\comm.jar";BlackBox\BlackBox.jar BlackBox 
```

# java - 将 Java 移植到 J# 的问题

> ID：678307
> 
> 赞同：4
> 
> 时间：2009-03-24T17:00:22.037
> 
> 标签：java, clr, j#

我在 java 中有一个中型（25k 行代码，25k 行测试）代码库，并希望将其移植到 CLR 和 JVM 上运行。

只有主类和一些测试实用程序以任何方式处理文件系统或操作系统。其余代码广泛使用通用集合 API、java.util.regex、java.net（但不是 URL 或 URLConnection）、用于字符集编码/解码的 java.io、用于 unicode 规范化的 java.text 和 org.w3c。用于 XML 操作的 dom。

是否可以在 J# 和 Java 下编译大部分代码库，然后移植其余的？

如果是这样，我可能会遇到什么样的陷阱？

在此先感谢，迈克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T17:26:18.680

查看 IKVM：[http ://www.ikvm.net/](http://www.ikvm.net/)

它允许您在 .Net CLR 中运行（特别编译的）Java 代码。

我的一些同事已经成功地将它与超过 100 万行代码的 Java 代码库一起使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T17:15:47.613

陷阱：

*   像这样的事情让我害怕。等待发生的真正微妙的错误数量是巨大的。
*   J# 仅支持 Java 1.1.4 AFAIK - 再见泛型等。
*   Visual Studio 2008 不支持 J# - 基本上它是一个死项目。

我怀疑您实际上会发现用 C# 重写它更简单（包括学习 C#，如果您还不知道它 - 这是一种乐趣）。如果相关的话，您最终也会以这种方式获得一个更惯用的类似 .NET 的库：如果您希望其他 .NET 开发人员使用您的代码，他们可能会对“纯”.NET 更满意。 NET 项目，而不是使用 J# 的项目。

不利的一面是，展望未来，还需要在两个地方进行任何更改。那里肯定有痛苦，但我真的认为使用“普通”.NET 会有更好的体验。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T17:27:25.700

正如乔恩指出的那样：J# 已经死了。

[不过，使用IKVM](http://www.ikvm.net/)在 .NET 上运行您的（普通）Java 代码可能是另一种选择。

# python - 有人知道 Django 中的 RTF 报告生成器吗？

> ID：678308
> 
> 赞同：3
> 
> 时间：2009-03-24T17:00:38.773
> 
> 标签：python, django, report, rtf

我知道 PDF 报告生成器，但我需要改用 RTF。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:40:03.573

有[PyRTF](http://pypi.python.org/pypi/PyRTF/0.45)，但有一段时间没有更新了。

如果这不起作用并且您愿意进行一些黑客攻击，那么我还可以将您指向具有 RTF 报告生成器的[GRAMPS 项目（查看 gramps/docgen/RTFDoc.py）。](http://www.gramps-project.org/wiki/index.php?title=Main_Page)该代码非常适合他们的家谱报告需求，但它干净且记录得当，因此可以作为一个很好的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-26T18:11:14.677

`(can't comment yet so I post it as an answer)`

PyRTF 有一个名为[pyrtf-ng](http://code.google.com/p/pyrtf-ng/)的分支，它得到维护并支持 Unicode。根据我所见，文档不存在，但 api 看起来不错，您可以从`tests`dir 中的测试中找出很多东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-23T00:31:39.077

[Windward Reports](http://www.windwardreports.com/)有一个非常好的 RTF 生成器。而且您在 Word 中创建模板非常易于使用。（免责声明 - 我是 Windward 的 CTO。）是的，Java 引擎可以从 Python 调用。

# regex - 正则表达式匹配不被括号包围的下划线？

> ID：678316
> 
> 赞同：3
> 
> 时间：2009-03-24T17:04:27.080
> 
> 标签：regex

任何人都可以建议一个正则表达式来匹配以下示例中的下划线：

```
test_test
test[_test
test_] 
```

但不匹配这个：

```
test[_]test 
```

这是使用 .Net 正则表达式库。我正在使用这个 RegEx 测试器来检查：

[http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx](http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T17:13:05.530

试试这个：

```
_[^\]]|[^[]_ 
```

它由`_[^\]]`（下划线和非`]`）和`[^[]_`（非`[`和下划线）的交替组成。

或者，如果您想使用环视断言来真正匹配下划线而不是周围的字符：

```
_(?=[^\]])|_(?<=[^[]_) 
```

这匹配任何后面没有`]`( `(?=[^\]])`，正向预测) 的下划线或任何前面没有`[`( `(?<=[^[]_)`，负向预测) 的下划线。这可以结合为：

```
_(?:(?=[^\]])|(?<=[^[]_)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:16:40.747

```
_(?!\](?<=\[_\])) 
```

如果下划线后面没有右括号，则负前瞻立即成功。否则，它会向后查找，以确定下划线*之前*是否也有一个左括号。您可以用点替换“_]”，以表明您这次只对左括号感兴趣：

```
_(?!\](?<=\[..)) 
```

如果你愿意，你可以先做lookbehind：

```
_(?<!\[_(?=\])) 
```

重要的是，第二个环视必须嵌套在第一个环内，以实现“ `NOT (x AND y)`”语义。

在 EditPad Pro 中测试它，它匹配除最后一个字符串之外的所有下划线：

```
test_test
test[_test
test_]
_]Test
Test[_
test[_]test 
```

编辑：这是一个更易于阅读的版本：

```
(?<!\[)_|_(?!\]) 
```

我喜欢嵌套环视版本的地方在于，它在实际找到下划线之前什么都不做。除非正则表达式引擎足够聪明，将其优化掉，否则这个“ `(NOT x) OR (NOT y)`”版本将对每个位置进行负面回顾。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T17:08:18.427

我不了解.Net，但正则表达式将由两部分组成，一个匹配除括号后跟下划线之外的任何字符，另一个匹配反之亦然：

```
[^\[](_)|(_)[^\]] 
```

编辑：刚刚注意到您需要添加下划线位于开头或结尾的情况：

```
[^\[](_)|(_)[^\]]|^_|_$ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T17:24:06.487

((?|(?!]))

它使用负前瞻/后视（而不是正前瞻/后视和排除字符）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T17:11:26.597

尝试

```
^.*(\[_[^\]])|([^\[]_\])|([^\[]_[^\]]).*$ 
```

**编辑：**现在处理

```
test_test 
```

未测试，但已阅读：任何字符串，后跟then 任何字符**but** *或***any**字符*but* then`[_` *`]` ***`[``_]`****

 ****请注意，对于像这样的情况，这可能会失败

```
_]Test
Test[_ 
```

不知道这对你有没有问题？

使用您的所有示例成功测试

# asp.net - 刷新登录屏幕时，Mac Safari 随机重新创建 cookie。很奇怪

> ID：678319
> 
> 赞同：0
> 
> 时间：2009-03-24T17:05:05.237
> 
> 标签：asp.net, safari, forms-authentication, cookies

我们在我们的应用程序中发现了一个问题，即 Mac 上的 Safari 从已注销的会话中随机重新创建登录 cookie。

[我在这里](http://mcintyre321.googlepages.com/SafariCookieProblem.zip)有一个带有这种行为的提琴手档案。请注意，已从中删除了一些内容以使其更易于获取，但没有删除任何设置 cookie 或任何内容的内容 - 仅重复请求 3-8。

我会告诉你运行顺序

*   请求 1：用户通过调用 /logout.aspx 注销 - Set-Cookie 返回设置 cookie 到期日期为 1999
*   请求 2-8：用户刷新登录页面，向 root 或 /res/en-US/s.js 发送调用 - 没有 cookie 发送到服务器或接收回，并且访问被拒绝。我已经从日志中删除了很多这种性质的请求，因为它们很无聊
*   请求 9：请求 /res/en-US/s.js - Hv3 身份验证 cookie 神秘地再次出现！笏。没有设置饼干！WTFF！
*   请求 10+：现在 cookie 重新出现，站点再次登录用户

在 Safari 中检查时，cookie 看起来像

```
<dict>
    <key>Created</key>
    <real>259603523.26834899</real>
    <key>Domain</key>
    <string>.mysite.dev</string>
    <key>Expires</key>
    <date>2010-03-24T16:05:22Z</date>
    <key>HttpOnly</key>
    <string>TRUE</string>
    <key>Name</key>
    <string>.Hv3</string>
    <key>Path</key>
    <string>/</string>
</dict> 
```

需要注意的一件事是，在 Safari 中，cookie 域是 .mysite.dev 而不是 mysite.dev（这是 web.config 中指定的 cookie 域） - 但是，鉴于请求 2-8 中拒绝访问，它看起来像cookie 已过期 OK。如果您在 2-8 期间查看浏览器中的 cookie 列表，则 .Hv3 cookie 不存在。

这是我们的错误还是 Safari 的？我能做些什么来阻止它的发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T14:12:55.970

某些浏览器的 cookie 处理存在已知问题。

请参阅以下论文： [Cookie 后的 iSEC 清理](http://www.isecpartners.com/files/iSEC_Cleaning_Up_After_Cookies.pdf)

另请参阅Apple.com 上关于重新出现 cookie 的[讨论。](http://discussions.apple.com/thread.jspa?messageID=9262463)

# sql - SSRS 设计器中的数据集面板（报告数据）消失了

> ID：678322
> 
> 赞同：184
> 
> 时间：2009-03-24T17:05:41.133
> 
> 标签：sql, visual-studio, user-interface, reporting-services, toolbox

在 SSRS 设计器（例如 Visual Studio）的布局屏幕中，我丢失了报表数据面板。

它已经消失了，我不记得为了找回它而叫什么。

这通常列出以下项目：

*   内置字段
*   参数
*   图片
*   数据源
*   数据集

以前它与通用工具箱和服务器资源管理器面板位于同一区域。

有谁知道如何恢复它？

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2009-04-06T16:13:35.780

在解决方案中选择报告 (rdl) 文件后，选择**View**，然后选择**Report Data**。

它是`Ctrl`++的`Alt`快捷方式`D`。

[![在此处输入图像描述](https://i.stack.imgur.com/vMagC.png)](https://i.stack.imgur.com/vMagC.png)

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-06-16T22:56:38.620

如果您在 SQL 2008 R2 中使用 BIDS，则只能通过在实际报告布局本身内部单击来获得“报告数据”菜单。

1.  在实际报告布局内单击。

2.  现在从主菜单栏中选择“查看”。

3.  现在选择“报告数据”，这是最后一项。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2015-08-19T05:50:30.957

选择 .rdl、.rdlc 或类似文件后，您可以：

*   单击查看 -> 报告数据或...
*   使用键盘快捷键`***CTRL***`+ `***ALT***`+`***D***`

[![例子](https://i.stack.imgur.com/ahxvh.png)](https://i.stack.imgur.com/ahxvh.png)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2019-03-21T18:37:18.093

对于未来的人 CTRL+ALT+D 或只是在古代 ssrs 2008 VS BI 中查看 > 报告数据。在较新的 2017 SSRS 中，它仍然是一样的。有趣的是他们如何改变周围的一堆东西，但保持不变。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-24T17:15:56.677

查看 -> 数据集（菜单底部，刷新上方）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-02-28T06:24:07.213

首先你必须点击报告，然后查看 -> 报告数据

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-03-01T05:47:01.040

如果您使用的是 SQL 2008 R2，那么从`View`---->`Report`底部的数据选项

# html - Scriptaculous Ajax.InPlaceEditor 不适用于 HTML

> ID：678323
> 
> 赞同：1
> 
> 时间：2009-03-24T17:05:42.520
> 
> 标签：html, ajax, scriptaculous

我正在使用 Scriptaculous Ajax.InPlaceEditor 来编辑数据库中的数据。

实际上，当数据库中没有数据时，它一开始就可以正常工作；这是我的导航器源代码中的内容：

```
<p id="edit" title="Click to edit" >
New text to edit here
</p> 
```

借助 Ajax.InPlaceEditor，我可以创建一条新记录，自动添加一些 HTML 来更改设计，并且一次又一次地更改而没有问题。此时，源代码如下所示：

```
<p id="edit" title="Click to edit" >
<ol>
<li>item1</li>
<li>item2</li>
</ol>
</p> 
```

好的，这简直太完美了。这在数据库中也很完美......

但是如果我重新加载整个页面，那么可编辑段落的初始值现在是直接来自数据库的 HTML，这就是我在源代码中的内容：

```
<p id="edit" title="Click to edit"/>
<ol>
<li>item1</li>
<li>item2</li>
</ol> 
```

如您所见，</p> 莫名其妙地丢失了，并且该段落不再可编辑... Rich 注意到该段落实际上是自动关闭的... 我还尝试将 HTML 文本手动设置到数据库中，并且结果是一样的：</p> 不见了……

你知道发生了什么，以及如何解决它吗？

非常感谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T17:12:20.057

假设您正确复制了 HTML，原始 HTML 块末尾的 p 标签是多余的，因为您已经用斜杠关闭了第一个块中的 p 标签：

```
<p id="edit" title="Click to edit"/>
                                  ^closes the p tag 
```

我假设编辑器“修复”了 HTML，因此删除了最后的关闭 p 标签，因为 p 标签在有序列表开始之前关闭

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:11:35.793

你不能将 s 包裹`ol`在`p`s 中。也就是说，`<ol>`关闭的`p`时间比你想象的要早。我建议使用`div`intsead。

# c++ - UNIX下C++中删除文件

> ID：678325
> 
> 赞同：25
> 
> 时间：2009-03-24T17:05:56.280
> 
> 标签：c++, unix, file-io, posix

你们通常如何删除 Linux 操作系统上的文件？我正在考虑使用`unlink`函数调用，但我想知道您是否有更好的主意，因为 C++ 标准没有提及文件删除操作并且它是系统相关的。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-24T17:07:16.403

是的——C++ 标准把这些东西留给了操作系统，所以如果你在 Linux（或任何 POSIX 系统）上，[`unlink()`](http://opengroup.org/onlinepubs/007908775/xsh/unlink.html)这就是你所拥有的。

C 标准提供[`remove()`](http://en.cppreference.com/w/cpp/io/c/remove)，您可以尝试，但请记住，它的[行为](http://www.open-std.org/JTC1/SC22/WG15/docs/rr/9945-1/9945-1-59.html)对于“常规文件”以外的任何内容都未指定，因此它并不能真正保护您免于进入特定于平台的文件系统详细信息（链接等） .

如果您想要更高级别、更健壮和更便携的东西，请查看[Boost Filesystem](http://www.boost.org/doc/libs/1_38_0/libs/filesystem/doc/index.htm)。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-24T17:10:46.737

该标准包括一个名为[remove](http://www.cplusplus.com/reference/clibrary/cstdio/remove.html)的函数。虽然我更喜欢`boost.filesystem`那个（如果我已经使用了 boost）。

```
#include <cstdio>

int main() {
    std::remove("/home/js/file.txt");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T17:13:36.467

`unlink()`由[POSIX](http://en.wikipedia.org/wiki/POSIX)标准定义，因此将存在于任何与 POSIX 兼容的系统上，并且存在于相当多的不兼容 POSIX 的系统上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T17:07:36.837

取消链接是正确的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T17:26:28.373

请注意，最近的内核还提供`unlinkat`. 这个函数比`unlink`目录本身有文件描述符要快。

# .net - 如何在 WPF DataGrid 中定义我自己的列？

> ID：678327
> 
> 赞同：8
> 
> 时间：2009-03-24T17:06:29.633
> 
> 标签：.net, linq-to-sql, xaml

我有一个`AutoGenerateColumns`WPF-DataGrid 在代码隐藏中绑定到 LINQ-to-SQL，它工作正常。

但是当我删除`AutoGenerateColumns`并定义我自己的列时，它告诉我“*在使用 ItemsSource 之前，项目集合必须为空。* ”

但我没有`ItemSource`在我的 XAML 中绑定，所以我不明白为什么它不是空的。**我需要更改什么才能定义自己的列？**

**XAML：**

```
<UserControl x:Class="TestDataGrid566.AppPages.ManageCustomers"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/wpf/2008/toolkit"
             Loaded="UserControl_Loaded">
    <toolkit:DataGrid x:Name="TheDataGrid" 
                      CanUserAddRows="False"
                      AlternatingRowBackground="#ddd"
                      CanUserSortColumns="true"
                      PreviewKeyDown="TheDataGrid_PreviewKeyDown"
                      AutoGenerateColumns="False"
                      RowEditEnding="TheDataGrid_RowEditEnding">

        <toolkit:DataGridTextColumn Header="Contact Name" Width="SizeToCells"  
                                    Binding="{Binding ContactName}" 
                                    IsReadOnly="False"/>
    </toolkit:DataGrid>
</UserControl> 
```

**代码隐藏：**

```
public partial class ManageCustomers : UserControl
{
    private NorthwindDataContext _db = new NorthwindDataContext();

    public ManageCustomers()
    {
        InitializeComponent();
    }

    private void UserControl_Loaded(object sender, RoutedEventArgs e)
    {
        LoadData();
    }

    public void LoadData()
    {
        var customers = from c in _db.Customers
                        select c;
        TheDataGrid.ItemsSource = customers.ToList();
    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-24T17:09:18.970

您试图将列直接放入`DataGrid`（因此它试图将列放入网格的`Items`集合中，这解释了您的错误）。你需要把它放在`Columns`集合中：

```
<toolkit:DataGrid x:Name="TheDataGrid" 
                          CanUserAddRows="False"
                          AlternatingRowBackground="#ddd"
                          CanUserSortColumns="true"
                          PreviewKeyDown="TheDataGrid_PreviewKeyDown"
                          AutoGenerateColumns="False"
                          RowEditEnding="TheDataGrid_RowEditEnding">
    <toolkit:DataGrid.Columns>        
        <toolkit:DataGridTextColumn Header="Contact Name" Width="SizeToCells"  
                                       Binding="{Binding ContactName}" 
                                       IsReadOnly="False"/>
    </toolkit:DataGrid.Columns>
</toolkit:DataGrid> 
```

# linq - 如何使用 linq 对 ntlm 进行身份验证到 sql 表？

> ID：678328
> 
> 赞同：0
> 
> 时间：2009-03-24T17:06:47.777
> 
> 标签：linq, authentication

给定 1\. 最初的想法，[链接文本](http://tinyurl.com/d5pw6l)和 2\. 创建嵌套循环[链接文本](http://tinyurl.com/debzo6)

我可以在这里使用 linq 还是应该如何按摩它来验证 WindowsPrincipal 到 sql 表？谢谢，-格雷格

```
protected void Page_Load(object sender, EventArgs e)
{
    string UserIdentityName = Server.HtmlEncode(User.Identity.Name);  
    Boolean Match = CompareUserName(UserIdentityName);
}

private Boolean CompareUserName(string PassedInValue)
{
    VerifyUserNameDataContext db = new VerifyUserNameDataContext();
    char[] delimiterChars = { ' ', ',', '.', ':', '\t' , '\\' };
    string[] words = PassedInValue.Split(delimiterChars);

    foreach (string split_up_domain_username in words)  
    {
       foreach (User users in db.Users) 
       {
            var user = (from u in db.Users
                        where u.Name.ToString() == split_up_domain_username.ToString()
                        select u).First();
            if (user != null) return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T12:39:34.853

使用 Enumerable.SingleOrDefault 而不是 Enumerable.First

var user =（来自 db.Users 中的 u.Name.ToString() == split_up_domain_username.ToString() 选择 u）。**单或默认**（）；

# web-services - SharePoint Web 服务凭据

> ID：678335
> 
> 赞同：0
> 
> 时间：2009-03-24T17:08:19.690
> 
> 标签：web-services, sharepoint, infopath

我正在尝试在 InfoPath 表单的代码隐藏中使用标准 SharePoint Web 服务 GetWeb。该表单作为工作流的一部分托管，因此使用 Forms Services 加载到浏览器中。因此，它在登录到 SharePoint 的当前用户的凭据上运行。如果用户在站点的 Owner 组中，则 Web 服务运行，但如果用户在 Contributor 或 Reader 组中，则会给出“HTTP 401 Unauthorized”错误。在此之后我还使用了 GetLists Web 服务，但只要用户具有 Reader 权限，它就会运行。

我只使用 GetWeb 调用来获取 GetList 调用所需的 WebId 作为参数。我通过将 WebId 传递到表单而不是让表单查找它来解决我的权限问题。所以现在一切都好。

但是，我想知道为什么 GetWeb 需要更高的权限以及如何/是否可以控制这些权限。我没有找到任何关于不同开箱即用 Web 服务所需权限的文档，更不用说您如何更改它们了。

[注意] 我没有使用数据连接文件是有原因的，但还是感谢您提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T18:10:38.293

You can eliminate the need to hard coding web service credentials by managing the web service details in Data Connection libraries. The UDCX file includes the schema to store web service credentials and the file itself can be centrally managed from Central Admin.

Using data connection files in central admin: [http://aidangarnish.net/blog/post/2008/11/Using-centrally-managed-SharePoint-data-connection-files-with-InfoPath-2007.aspx](http://aidangarnish.net/blog/post/2008/11/Using-centrally-managed-SharePoint-data-connection-files-with-InfoPath-2007.aspx)

Web service credentoils at (7): [http://sheetal-d.spaces.live.com/Blog/cns!237C3DEA7120098B!658.entry](http://sheetal-d.spaces.live.com/Blog/cns!237C3DEA7120098B!658.entry)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-21T07:19:01.953

如果您将 sharepoint 客户端用于 GetList。然后你可以看看下面的代码。

```
ClientContext context = new ClientContext(siteURL);
UserInfo user = new UserInfo();
SecureString passWord = new SecureString();
foreach (char c in user.Pwd.ToCharArray()) passWord.AppendChar(c);
context.Credentials = new SharePointOnlineCredentials(user.UserName, passWord);
//context.Credentials = new System.Net.NetworkCredential(userName, password);
Web web = context.Web;
List list = web.Lists.GetByTitle(documentLibraryName);

CamlQuery query = new CamlQuery();
ListItemCollection items = list.GetItems(query);
context.Load(items);
context.ExecuteQuery(); 
```

# .net - 使用 .NET 将数据加载到 ORACLE 数据库的最快方法是什么？

> ID：678339
> 
> 赞同：4
> 
> 时间：2009-03-24T17:09:31.123
> 
> 标签：.net, oracle, text-files, loader

我目前有一个日常流程，使用调用 sql_loader 的 shell 脚本将大量数据从 TXT 文件加载到 ORACLE 数据库中。我想将其迁移到 .NET 服务，但不想依赖从我的服务执行 sql_loader。

实现这一目标的最佳（和最快）方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T18:36:24.427

将数据加载到 DataTable 中，并使用[OracleBulkCopy](http://download.oracle.com/docs/html/E10927_01/OracleBulkCopyClass.htm)类（来自[Oracle Data Provider for .NET](http://www.oracle.com/technology/tech/windows/odpnet/index.html)）一次将其全部加载到数据库中。这仅在您仅将数据插入数据库时​​才有效，您不能使用 OracleBulkCopy 进行更新。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T20:04:58.440

我假设您不喜欢 SQL *Loader，因为它的命令行界面和（有点）笨重的控制文件。但这不是使用“SQL* Loader”的唯一方法

Oracle 现在有一个叫做外部表的东西。[你可以在这里](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_7002.htm#i2153251)看到一个例子。

简单地说，您将文件放入目录（定义文件系统目录的数据库对象），定义表参数等...只需查看示例。现在突然之间，您的平面文件看起来就像 Oracle 的一个表。

您执行“INSERT INTO perm_Table SELECT * FROM external_table”。

因此，现在您的 .net 应用程序只需将文件重命名为外部表指向的任何内容，然后执行 INSERT，然后重命名文件。

瞧。

您已加载数据。这一切都是用 SQL 完成的，比 ADO 或您可以使用的任何其他库要快得多。不再笨拙的命令行界面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T17:28:23.153

SQL Server 的 ADO.Net 提供程序支持模拟 SQL Server BCP 的 SqlBulkCopy 函数。

我对 Oracle 提供程序一无所知，但我会开始查看该提供程序是否支持与 sql_loader 类似的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T17:39:14.610

我会看看DevArt （以前的 CoreLab）的[第 3 方 dotConnect 库。](http://devart.com/dotconnect/oracle/ "DevArt dotConnect for Oracle 主页")虽然我没有专门使用他们的[OracleLoader](http://devart.com/dotconnect/oracle/docs/Devart.Data.Oracle~Devart.Data.Oracle.OracleLoader.html "DevArt OracleLoader 组件 - 文档")组件，但我每天都使用他们的连接、命令、datareader 和 dataadapter 对象，并且发现它们确实非常快。

希望有帮助:o)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T19:37:35.450

如果您有可用的 SSIS，那将是一个很好的工具。在 .NET 方面，我建议使用上面提到的 Oracle 类，但 SSIS 或任何 ETL 工具会是更好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T15:27:55.763

我实际上使用另一种方法解决了我自己的问题：我编写了一个存储过程来加载数据并使用[UTL_FILE](http://www.adp-gmbh.ch/ora/plsql/utl_file.html)包。我不知道这是否是最快的方法，但它非常快速且非常灵活（我可以在加载时随意操作文本数据）。

感谢所有回复，我刚刚发布此内容是为了向遇到同样问题的人展示另一种选择。

# sql - 防止在 SQL 中插入重复信息

> ID：678341
> 
> 赞同：3
> 
> 时间：2009-03-24T17:10:09.407
> 
> 标签：sql, constraints

有没有一种快速的方法来防止重复数据插入到表中？我的意思是，密钥总是不同的，但条目的其余部分可以重复，因此，将有 2+ 个不同的密钥标识相同的数据。

我可以搜索整张桌子，但我担心这样做会失去性能。

注意：我刚刚开始学习 SQL，如果这对您来说是一个愚蠢的问题，请多多包涵。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T17:13:59.897

您希望对表有一个[UNIQUE 约束](http://msdn.microsoft.com/en-us/library/ms191166.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:17:06.550

正如 Joel 所说，您可以在不需要重复数据的多个字段上使用 UNIQUE 约束。

此外，如果您可以确保您的主键始终标识唯一记录，那么您永远不会遇到这个麻烦。

例如：如果我们使用我的身份证号码作为主键，我的个人记录总是与你的不同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T17:16:01.653

UNIQUE-constraint 负责防止数据被插入两次。在您的 DBMS 文档中了解有关它的更多信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-24T17:14:50.957

识别和删除数据库中的重复条目实际上是学术研究的主题。除了“最佳实践”之外，几乎不可能给出唯一真实的答案。

我们在公司注册数据（如地址、电话等）方面也遇到了这个问题。您只需要缩小所有可能的数据变化范围，然后进行简单的检查。可能没有（好的）方法可以使这些检查对任何数据产生完美的结果。

# asp.net - 总结gridview

> ID：678344
> 
> 赞同：0
> 
> 时间：2009-03-24T17:10:22.183
> 
> 标签：asp.net, mysql, gridview

在一个asp.net 页面中，我有五个gridviews 列出了一些数字。在每个 gridview 的标题中，我想总结列表中的数字。因此，如果列表包含编号为 1、2、3 的行，则标题中的标题将为 6。

我在对 gridview 的查询中找不到执行此操作的方法（SELECT number,SUM(number) FROM tbl，不起作用）。

再次连接到数据库以汇总这些数字似乎是一种不好的方法，因为我已经连接了五次以获取网格视图的数据。

这样做的最佳解决方案是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T17:32:01.630

您可以做的是在 Page Pre_Render 事件中循环遍历这些行。网格视图1：

```
int Total = 0;
GridView1.HeaderRow.Cells[0].Text = GetTotals();
private String GetTotals()
{
Foreach(GridviewRow row in GridView1.Rows)
{
Total += int.Parse(((Label)row.FindControl("RowValue")).Text);
}
return Total.ToString();
} 
```

应该为你工作。

# c# - 在 aspx 合并代码中写引号

> ID：678346
> 
> 赞同：0
> 
> 时间：2009-03-24T17:11:13.740
> 
> 标签：c#, asp.net

为什么这段代码不起作用？

```
OnClientClick='<%# String.Format("return confirm('¿Está seguro que desea eliminar el registro {0}?);'", Eval("data")) %>' 
```

错误是：

> 服务器标签的格式不正确。

我怎样才能写这个让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T17:14:35.013

第二个 ' 是告诉字符串结束。使用反斜杠转义它。与结束撇号相同。

```
OnClientClick='<%# String.Format("return confirm(\'¿Está seguro que desea eliminar el registro {0}?);\'", Eval("data")) %>' 
```

试试看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T17:17:22.900

在字符串的开头使用@，以便不处理转义字符。请参阅[http://msdn.microsoft.com/en-us/library/362314fe(VS.71).aspx](http://msdn.microsoft.com/en-us/library/362314fe(VS.71).aspx)

```
OnClientClick='<%# Eval("data", @"return confirm('¿Está seguro que desea eliminar el registro {0}?);'") %>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T17:25:39.837

似乎确认函数中的字符串在关闭括号之前没有关闭。应该：

```
confirm('¿Está seguro que desea eliminar el registro {0}?'); 
```

# php - imap_header, recent = N, unseen = ""...但是我还没看

> ID：678356
> 
> 赞同：1
> 
> 时间：2009-03-24T17:14:41.720
> 
> 标签：php, imap

在 LeaseWeb 服务器上使用 PHP 5.2.0-8+etch13，我的代码通过 imap 接收电子邮件来处理通过电子邮件发送到某个地址的文件。我打电话`imap_open`（检查错误但没有发现任何错误），通过 获取消息的数量`imap_num_msg`，然后查看然后调用`imap_header`每个消息。所有运行都没有错误。

然后我检查`if ('U' == $header->Unseen || 'N' == $header->Recent)`。这适用于 ModWest 共享服务器上的相同代码，但在 Leaseweb 和 ModWest VPS 服务器上找不到新消息。`print_r`在运行代码之前发送的一封测试电子邮件的标题显示...

```
stdClass Object
(
    [date] => Tue, 24 Mar 2009 17:57:55 +0100
    [Date] => Tue, 24 Mar 2009 17:57:55 +0100
    [subject] => Data 200903
    [Subject] => Data 200903
    [in_reply_to] => <example@mail.gmail.com>
    [message_id] => <example@mail.gmail.com>
    [references] => <example@mail.gmail.com>  <example@mail.gmail.com>
    [toaddress] => data@example.com
    [to] => Array
        (
            [0] => stdClass Object
                (
                    [mailbox] => data
                    [host] => example.com
                )

        )

    [fromaddress] => "me" <me@example.com> 
    [from] => Array
        (
            [0] => stdClass Object
                (
                    [personal] => me
                    [mailbox] => me
                    [host] => example.com
                )

        )

    [reply_toaddress] => "me" <me@example.com> 
    [reply_to] => Array
        (
            [0] => stdClass Object
                (
                    [personal] => me
                    [mailbox] => me
                    [host] => example.com
                )

        )

    [senderaddress] => me@gmail.com
    [sender] => Array
        (
            [0] => stdClass Object
                (
                    [mailbox] => me
                    [host] => gmail.com
                )

        )

    [Recent] => N
    [Unseen] =>  
    [Flagged] =>  
    [Answered] =>  
    [Deleted] =>  
    [Draft] =>  
    [Msgno] =>    1
    [MailDate] => 24-Mar-2009 17:57:55 +0100
    [Size] => 8802
    [udate] => 1237913875
) 
```

1.  我正在做的事情是否会导致它被“读取”？
2.  我怎么知道这是一条“新”消息。

谢谢，埃德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T04:02:42.660

只是在黑暗中拍摄，但是在这种其他类型的服务器上访问标头信息的特定方法是否可以被解释为被读取？

# flash - Flash 中的本地化

> ID：678359
> 
> 赞同：2
> 
> 时间：2009-03-24T17:15:31.157
> 
> 标签：flash, actionscript-3, localization

我有一个我正在处理的 Flash 项目，最终需要移植到多种语言。

我的方法是加载一个包含本地化信息的 XML 文件，就像 ASP.NET 中的资源文件一样

我想知道是否有更好的方法来解决这个问题，或者这是否是最直接的方法。

这个项目在 Action Script 3 中，我相信所有的国际语言都会从左到右，但我对此并不乐观。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T10:12:20.323

Instead of rolling your own, you might also want to consider using [Gettext](http://www.gnu.org/software/gettext/) for the job.

Gettext supports features like variables within sentences or pluralization and is rock-solid. Localized resources are compiled, so nobody can tamper with them. Plus, you can use tools like Poedit for translating your files / checking someone else's translation and making sure that all strings are properly translated and still up to date in case you change the underlying source code. I've tried both rolling my own and using Gettext instead and I have to say that Gettext plus [PoEdit](http://www.poedit.net/) were way superior.

There is also a free [Gettext reader](http://code.google.com/p/gettext-for-flash/) for Flash.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:23:32.963

你看过[资源模块](http://livedocs.adobe.com/flex/3/html/help.html?content=l10n_2.html)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T10:15:15.620

If you're gonna be using LTR languages such as Hebrew, you better be using Flash CS4, or you will have to save a reversed version of each string.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-10T11:53:53.767

我知道我迟到了将近 2 年，但我刚刚发布了我的 AS3 本地化管理器 Babel Flash，你可以在这里阅读：

[http://gltovar.com/blog/?p=193](http://gltovar.com/blog/?p=193)

并在此处获取源代码

[http://code.google.com/p/gltovar/](http://code.google.com/p/gltovar/)

# html - 在 IE/Opera 中运行在其框外的文本

> ID：678372
> 
> 赞同：0
> 
> 时间：2009-03-24T17:20:02.470
> 
> 标签：html, css, joomla, html-table

页面： http: [//www.visitherefordshire.net/news](http://www.visitherefordshire.net/news)

在 Internet Explorer 7 和 Opera 9.6 中，文本在框外运行。这似乎是由于表格是 100% 宽度：如果我设置像素宽度（例如 700 像素），那么它们适合。

据我所见，所有的“外部”div 都不比可见框宽，那么为什么桌子上的 100% 宽度会将其拉伸这么远？

PS 可怕的代码，我知道；这就是适合你的 Joomla。从长远来看，我们会努力让它变得更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T11:28:20.030

我现在发现了这个问题。其中一篇文章中有一大串空格，导致桌子伸展。现在已经修复了。真的有点傻！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:16:04.397

只需在您的 joomla_classes.css （最后）中放入以下 ​​CSS

```
table.contentpaneopen p{
width: 99%;
} 
```

现在它应该看起来很好。

# c# - C# TreeView.GetNodeAt() 单击图像的问题

> ID：678373
> 
> 赞同：2
> 
> 时间：2009-03-24T17:20:16.137
> 
> 标签：c#, winforms, treeview, click, treenode

当在 TreeView 中单击节点时，我正在使用 TreeView 上的单击事件来做一些事情。我通过使用鼠标坐标调用 GetNodeAt() 来获取单击的节点，如下所示：

```
private void TreeView_Click(object sender, System.EventArgs e)
{
    MouseEventArgs mouseEventArgs = e as MouseEventArgs;

    if (mouseEventArgs == null)
        return;

    // Get the node that is being clicked.                  
    TreeNode node = this.GetNodeAt(mouseEventArgs.X, mouseEventArgs.Y);

    // Do other stuff...
} 
```

但是，GetNodeAt() 方法仅在单击节点标签时有效，当单击节点图像时，GetNodeAt() 返回 null。这有点烦人，因为单击图像时实际上选择了节点，但我无法找出它是什么节点。

有人有什么建议吗？

更新：我得到了一些使用 SelectedNode 的建议。我不能，因为它是在触发 Click 事件之后设置的。这实际上是在一个继承 TreeView 的控件中，它所做的是触发它自己的 Clicked 事件，但使用 TreeNode 表示的底层数据而不是 TreeNode 本身。

更新：原来有人在我们的代码中重写了 GetNodeAt() 方法，它引入了这种行为，我没有意识到。所以这个问题是无效的，GetNodeAt() 方法没有问题。为什么有人会这样做仍然是个谜。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T17:26:42.767

您是否尝试过 BeforeSelect 或 AfterSelect 事件？您可以直接从 TreeViewCancelEventArgs 中获取所选节点，然后在您的 Click 事件中使用它。

编辑：附加想法：我能看到的唯一问题是 BeforeSelect 事件实际上是在 Click 和 MouseClick 事件***之后***触发的。

另一个编辑：如果您需要在 Click 之前触发的事件，您可以使用 NodeMouseClick - TreeNodeMouseClickEventArgs 具有 Node 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:22:15.273

为什么不直接使用`TreeView.SelectedNode`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T17:24:19.420

尝试：

```
TreeNode node = this.SelectedNode; 
```

编辑：被肖恩打败

# .net - .NET 中是否有可用的只读通用字典？

> ID：678379
> 
> 赞同：187
> 
> 时间：2009-03-24T17:21:30.533
> 
> 标签：.net, dictionary, readonly

我在我的只读属性中返回对字典的引用。如何防止消费者更改我的数据？如果这是一个`IList`我可以简单地返回它`AsReadOnly`。我可以用字典做类似的事情吗？

```
Private _mydictionary As Dictionary(Of String, String)
Public ReadOnly Property MyDictionary() As Dictionary(Of String, String)
    Get
        Return _mydictionary
    End Get
End Property 
```

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2009-03-24T17:27:00.037

## .NET 4.5

.NET Framework 4.5 BCL 引入[`ReadOnlyDictionary<TKey, TValue>`](https://msdn.microsoft.com/en-us/library/gg712875(v=VS.110).aspx)（[来源](https://msdn.microsoft.com/en-us/magazine/jj133817.aspx)）。

由于 .NET Framework 4.5 BCL 不包含`AsReadOnly`for 字典，因此您需要自己编写（如果需要）。它类似于以下内容，其简单性可能突出了为什么它不是 .NET 4.5 的优先事项。

```
public static ReadOnlyDictionary<TKey, TValue> AsReadOnly<TKey, TValue>(
    this IDictionary<TKey, TValue> dictionary)
{
    return new ReadOnlyDictionary<TKey, TValue>(dictionary);
} 
```

## .NET 4.0 及以下

在 .NET 4.5 之前，没有 .NET 框架类可以[`Dictionary<TKey, TValue>`](https://msdn.microsoft.com/en-us/library/xfhwa508.aspx)像[ReadOnlyCollection](https://msdn.microsoft.com/en-us/library/ms132474.aspx)一样包装[List](https://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)。但是，创建一个并不难。

[这是一个例子——如果你](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=29)[用谷歌搜索 ReadOnlyDictionary](https://www.google.com/search?q=ReadOnlyDictionary)，还有很多其他的例子。

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2009-08-12T23:42:24.767

这是一个包装字典的简单实现：

```
public class ReadOnlyDictionary<TKey, TValue> : IDictionary<TKey, TValue>
{
    private readonly IDictionary<TKey, TValue> _dictionary;

    public ReadOnlyDictionary()
    {
        _dictionary = new Dictionary<TKey, TValue>();
    }

    public ReadOnlyDictionary(IDictionary<TKey, TValue> dictionary)
    {
        _dictionary = dictionary;
    }

    #region IDictionary<TKey,TValue> Members

    void IDictionary<TKey, TValue>.Add(TKey key, TValue value)
    {
        throw ReadOnlyException();
    }

    public bool ContainsKey(TKey key)
    {
        return _dictionary.ContainsKey(key);
    }

    public ICollection<TKey> Keys
    {
        get { return _dictionary.Keys; }
    }

    bool IDictionary<TKey, TValue>.Remove(TKey key)
    {
        throw ReadOnlyException();
    }

    public bool TryGetValue(TKey key, out TValue value)
    {
        return _dictionary.TryGetValue(key, out value);
    }

    public ICollection<TValue> Values
    {
        get { return _dictionary.Values; }
    }

    public TValue this[TKey key]
    {
        get
        {
            return _dictionary[key];
        }
    }

    TValue IDictionary<TKey, TValue>.this[TKey key]
    {
        get
        {
            return this[key];
        }
        set
        {
            throw ReadOnlyException();
        }
    }

    #endregion

    #region ICollection<KeyValuePair<TKey,TValue>> Members

    void ICollection<KeyValuePair<TKey, TValue>>.Add(KeyValuePair<TKey, TValue> item)
    {
        throw ReadOnlyException();
    }

    void ICollection<KeyValuePair<TKey, TValue>>.Clear()
    {
        throw ReadOnlyException();
    }

    public bool Contains(KeyValuePair<TKey, TValue> item)
    {
        return _dictionary.Contains(item);
    }

    public void CopyTo(KeyValuePair<TKey, TValue>[] array, int arrayIndex)
    {
        _dictionary.CopyTo(array, arrayIndex);
    }

    public int Count
    {
        get { return _dictionary.Count; }
    }

    public bool IsReadOnly
    {
        get { return true; }
    }

    bool ICollection<KeyValuePair<TKey, TValue>>.Remove(KeyValuePair<TKey, TValue> item)
    {
        throw ReadOnlyException();
    }

    #endregion

    #region IEnumerable<KeyValuePair<TKey,TValue>> Members

    public IEnumerator<KeyValuePair<TKey, TValue>> GetEnumerator()
    {
        return _dictionary.GetEnumerator();
    }

    #endregion

    #region IEnumerable Members

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    #endregion

    private static Exception ReadOnlyException()
    {
        return new NotSupportedException("This dictionary is read-only");
    }
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-09-21T23:35:48.887

在最近的[BUILD 会议上](http://www.buildconf.com)宣布，从 .NET 4.5 开始，该接口`System.Collections.Generic.IReadOnlyDictionary<TKey,TValue>`被包括在内。证明在[这里](http://permalink.gmane.org/gmane.comp.gnome.mono.patches/182606)（单声道）和[这里](http://msdn.microsoft.com/en-us/magazine/jj133817.aspx#ctl00_MTContentSelector1_mainContentContainer_ctl07)（微软）；）

不确定是否`ReadOnlyDictionary`也包括在内，但至少对于接口，现在创建一个公开官方 .NET 通用接口的实现应该不难:)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-08-01T21:23:41.490

随意使用我的简单包装器。它不实现 IDictionary，因此它不必在运行时为会更改字典的字典方法抛出异常。根本没有改变方法。我为它创建了自己的接口，称为 IReadOnlyDictionary。

```
public interface IReadOnlyDictionary<TKey, TValue> : IEnumerable
{
    bool ContainsKey(TKey key);
    ICollection<TKey> Keys { get; }
    ICollection<TValue> Values { get; }
    int Count { get; }
    bool TryGetValue(TKey key, out TValue value);
    TValue this[TKey key] { get; }
    bool Contains(KeyValuePair<TKey, TValue> item);
    void CopyTo(KeyValuePair<TKey, TValue>[] array, int arrayIndex);
    IEnumerator<KeyValuePair<TKey, TValue>> GetEnumerator();
}

public class ReadOnlyDictionary<TKey, TValue> : IReadOnlyDictionary<TKey, TValue>
{
    readonly IDictionary<TKey, TValue> _dictionary;
    public ReadOnlyDictionary(IDictionary<TKey, TValue> dictionary)
    {
        _dictionary = dictionary;
    }
    public bool ContainsKey(TKey key) { return _dictionary.ContainsKey(key); }
    public ICollection<TKey> Keys { get { return _dictionary.Keys; } }
    public bool TryGetValue(TKey key, out TValue value) { return _dictionary.TryGetValue(key, out value); }
    public ICollection<TValue> Values { get { return _dictionary.Values; } }
    public TValue this[TKey key] { get { return _dictionary[key]; } }
    public bool Contains(KeyValuePair<TKey, TValue> item) { return _dictionary.Contains(item); }
    public void CopyTo(KeyValuePair<TKey, TValue>[] array, int arrayIndex) { _dictionary.CopyTo(array, arrayIndex); }
    public int Count { get { return _dictionary.Count; } }
    public IEnumerator<KeyValuePair<TKey, TValue>> GetEnumerator() { return _dictionary.GetEnumerator(); }
    IEnumerator IEnumerable.GetEnumerator() { return _dictionary.GetEnumerator(); }
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-08-12T23:20:10.583

IsReadOnly on`IDictionary<TKey,TValue>`继承自`ICollection<T>`( `IDictionary<TKey,TValue>`extends `ICollection<T>`as `ICollection<KeyValuePair<TKey,TValue>>`)。它不以任何方式使用或实现（实际上通过使用显式实现关联`ICollection<T>`成员“隐藏”）。

我可以看到至少有 3 种方法可以解决这个问题：

1.  按照建议实现自定义只读`IDictionary<TKey, TValue>`并包装/委托给内部字典
2.  根据值的使用将集合返回 `ICollection<KeyValuePair<TKey, TValue>>`为只读或 `IEnumerable<KeyValuePair<TKey, TValue>>`
3.  使用复制构造函数克隆字典`.ctor(IDictionary<TKey, TValue>)`并返回一个副本 - 这样用户可以随意使用它，并且不会影响托管源字典的对象的状态。请注意，如果您要克隆的字典包含引用类型（不是示例中显示的字符串），您将需要“手动”复制并克隆引用类型。

作为旁白; 公开集合时，旨在公开尽可能小的接口 - 在示例情况下，它应该是 IDictionary，因为这允许您在不破坏类型公开的公共合同的情况下改变底层实现。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-05-24T09:12:05.627

只读字典在某种程度上可以替换为`Func<TKey, TValue>`- 如果我只希望人们执行查找，我通常在 API 中使用它；这很简单，特别是如果您愿意，更换后端也很简单。但是，它不提供键列表；这是否重要取决于你在做什么。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-24T17:26:48.477

不，但很容易自己动手。IDictionary 确实定义了 IsReadOnly 属性。只需包装一个 Dictionary 并从适当的方法中抛出一个 NotSupportedException 。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-24T18:27:44.837

BCL 中没有可用的。但是我在我的[BCL Extras 项目中发布了一个 ReadOnlyDictionary（名为 ImmutableMap）](http://code.msdn.com/bclextras)

除了是一个完全不可变的字典之外，它还支持生成一个实现 IDictionary 的代理对象，并且可以在任何使用 IDictionary 的地方使用。每当调用其中一个变异 API 时，它都会抛出异常

```
void Example() { 
  var map = ImmutableMap.Create<int,string>();
  map = map.Add(42,"foobar");
  IDictionary<int,string> dictionary = CollectionUtility.ToIDictionary(map);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-24T17:26:02.910

您可以创建一个仅实现字典的部分实现并隐藏所有添加/删除/设置功能的类。

在内部使用外部类将所有请求传递给的字典。

但是，由于您的字典可能包含引用类型，因此您无法阻止用户对字典保存的类设置值（除非这些类本身是只读的）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-24T17:27:52.437

我认为没有一种简单的方法可以做到这一点......如果您的字典是自定义类的一部分，您可以使用索引器来实现它：

```
public class MyClass
{
  private Dictionary<string, string> _myDictionary;

  public string this[string index]
  {
    get { return _myDictionary[index]; }
  }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-04-16T12:19:55.227

+1 干得好，托马斯。我使 ReadOnlyDictionary 更进一步。

就像 Dale 的解决方案一样，我想从 IntelliSense 中删除`Add()`、`Clear()`、`Remove()`等。但我希望我的派生对象实现`IDictionary<TKey, TValue>`.

此外，我想打破以下代码：（同样，戴尔的解决方案也这样做）

```
ReadOnlyDictionary<int, int> test = new ReadOnlyDictionary<int,int>(new Dictionary<int, int> { { 1, 1} });
test.Add(2, 1);  //CS1061 
```

Add() 行导致：

```
error CS1061: 'System.Collections.Generic.ReadOnlyDictionary<int,int>' does not contain a definition for 'Add' and no extension method 'Add' accepting a first argument 
```

调用者仍然可以将其转换为`IDictionary<TKey, TValue>`，但`NotSupportedException`如果您尝试使用非只读成员（来自 Thomas 的解决方案），则会引发。

无论如何，对于任何也想要这个的人来说，这是我的解决方案：

```
namespace System.Collections.Generic
{
    public class ReadOnlyDictionary<TKey, TValue> : IDictionary<TKey, TValue>
    {
        const string READ_ONLY_ERROR_MESSAGE = "This dictionary is read-only";

        protected IDictionary<TKey, TValue> _Dictionary;

        public ReadOnlyDictionary()
        {
            _Dictionary = new Dictionary<TKey, TValue>();
        }

        public ReadOnlyDictionary(IDictionary<TKey, TValue> dictionary)
        {
            _Dictionary = dictionary;
        }

        public bool ContainsKey(TKey key)
        {
            return _Dictionary.ContainsKey(key);
        }

        public ICollection<TKey> Keys
        {
            get { return _Dictionary.Keys; }
        }

        public bool TryGetValue(TKey key, out TValue value)
        {
            return _Dictionary.TryGetValue(key, out value);
        }

        public ICollection<TValue> Values
        {
            get { return _Dictionary.Values; }
        }

        public TValue this[TKey key]
        {
            get { return _Dictionary[key]; }
            set { throw new NotSupportedException(READ_ONLY_ERROR_MESSAGE); }
        }

        public bool Contains(KeyValuePair<TKey, TValue> item)
        {
            return _Dictionary.Contains(item);
        }

        public void CopyTo(KeyValuePair<TKey, TValue>[] array, int arrayIndex)
        {
            _Dictionary.CopyTo(array, arrayIndex);
        }

        public int Count
        {
            get { return _Dictionary.Count; }
        }

        public bool IsReadOnly
        {
            get { return true; }
        }

        public IEnumerator<KeyValuePair<TKey, TValue>> GetEnumerator()
        {
            return _Dictionary.GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return (_Dictionary as IEnumerable).GetEnumerator();
        }

        void IDictionary<TKey, TValue>.Add(TKey key, TValue value)
        {
            throw new NotSupportedException(READ_ONLY_ERROR_MESSAGE);
        }

        bool IDictionary<TKey, TValue>.Remove(TKey key)
        {
            throw new NotSupportedException(READ_ONLY_ERROR_MESSAGE);
        }

        void ICollection<KeyValuePair<TKey, TValue>>.Add(KeyValuePair<TKey, TValue> item)
        {
            throw new NotSupportedException(READ_ONLY_ERROR_MESSAGE);
        }

        void ICollection<KeyValuePair<TKey, TValue>>.Clear()
        {
            throw new NotSupportedException(READ_ONLY_ERROR_MESSAGE);
        }

        bool ICollection<KeyValuePair<TKey, TValue>>.Remove(KeyValuePair<TKey, TValue> item)
        {
            throw new NotSupportedException(READ_ONLY_ERROR_MESSAGE);
        }
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-01-09T16:41:15.417

现在，有[Microsoft 不可变集合](https://msdn.microsoft.com/en-us/library/mt452182(v=vs.110).aspx)( `System.Collections.Immutable`)。[通过 NuGet](https://www.nuget.org/packages/System.Collections.Immutable/)获取它们。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-24T17:32:20.693

```
public IEnumerable<KeyValuePair<string, string>> MyDictionary()
{
    foreach(KeyValuePair<string, string> item in _mydictionary)
        yield return item;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-02-12T20:31:21.347

这是一个糟糕的解决方案，见底部。

对于那些仍在使用 .NET 4.0 或更早版本的人，我有一个类与已接受答案中的类一样工作，但它要短得多。它扩展了现有的 Dictionary 对象，覆盖（实际上是隐藏）某些成员，让它们在调用时抛出异常。

如果调用者试图调用内置 Dictionary 具有的 Add、Remove 或其他一些变异操作，编译器将抛出错误。我使用 Obsolete 属性来引发这些编译器错误。这样，您可以使用此 ReadOnlyDictionary 替换 Dictionary 并立即查看任何问题可能出在哪里，而无需运行您的应用程序并等待运行时异常。

看一看：

```
public class ReadOnlyException : Exception
{
}

public class ReadOnlyDictionary<TKey, TValue> : Dictionary<TKey, TValue>
{
    public ReadOnlyDictionary(IDictionary<TKey, TValue> dictionary)
        : base(dictionary) { }

    public ReadOnlyDictionary(IDictionary<TKey, TValue> dictionary, IEqualityComparer<TKey> comparer)
        : base(dictionary, comparer) { }

    //The following four constructors don't make sense for a read-only dictionary

    [Obsolete("Not Supported for ReadOnlyDictionaries", true)]
    public ReadOnlyDictionary() { throw new ReadOnlyException(); }

    [Obsolete("Not Supported for ReadOnlyDictionaries", true)]
    public ReadOnlyDictionary(IEqualityComparer<TKey> comparer) { throw new ReadOnlyException(); }

    [Obsolete("Not Supported for ReadOnlyDictionaries", true)]
    public ReadOnlyDictionary(int capacity) { throw new ReadOnlyException(); }

    [Obsolete("Not Supported for ReadOnlyDictionaries", true)]
    public ReadOnlyDictionary(int capacity, IEqualityComparer<TKey> comparer) { throw new ReadOnlyException(); }

    //Use hiding to override the behavior of the following four members
    public new TValue this[TKey key]
    {
        get { return base[key]; }
        //The lack of a set accessor hides the Dictionary.this[] setter
    }

    [Obsolete("Not Supported for ReadOnlyDictionaries", true)]
    public new void Add(TKey key, TValue value) { throw new ReadOnlyException(); }

    [Obsolete("Not Supported for ReadOnlyDictionaries", true)]
    public new void Clear() { throw new ReadOnlyException(); }

    [Obsolete("Not Supported for ReadOnlyDictionaries", true)]
    public new bool Remove(TKey key) { throw new ReadOnlyException(); }
} 
```

此解决方案存在@supercat 指出的问题，此处说明：

```
var dict = new Dictionary<int, string>
{
    { 1, "one" },
    { 2, "two" },
    { 3, "three" },
};

var rodict = new ReadOnlyDictionary<int, string>(dict);
var rwdict = rodict as Dictionary<int, string>;
rwdict.Add(4, "four");

foreach (var item in rodict)
{
    Console.WriteLine("{0}, {1}", item.Key, item.Value);
} 
```

而不是像我预期的那样给出编译时错误，或者像我希望的那样给出运行时异常，这段代码运行时没有错误。它打印四个数字。这使我的 ReadOnlyDictionary 成为 ReadWriteDictionary。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-08-18T19:09:59.847

对于使用 .NET Core 来解决此问题的任何人，请查看[System.Collections.Immutable](https://docs.microsoft.com/en-us/dotnet/api/system.collections.immutable?view=netcore-3.1)。

特别是对于不可变字典，您可以使用[`ImmutableDictionary<TKey, TValue>.Builder`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.immutable.immutabledictionary-2.builder?view=netcore-3.1)：

```
public static ImmutableDictionary<string, string> ToReadOnly(this IDictionary<String, string> d)
{
    var builder = new ImmutableDictionary<string, string>.Builder();
    builder.AddRange(d);
    return builder.ToImmutable();
} 
```

# xslt - 使用 XSLT 变量作为字段名称

> ID：678384
> 
> 赞同：3
> 
> 时间：2009-03-24T17:22:31.793
> 
> 标签：xslt, variables, field

我有一个 XSLT 变量，我正在创建并使用样式表顶部的属性值填充，如下所示......

```
 <xsl:variable name="MyAttributeValue" select="/Source/Fields/Field[@SpecialAttribute]/@MyAttributeValue" /> 
```

稍后在处理过程中，我想使用 $MyAttributeValue 作为**字段名称**，就像使用硬编码字符串一样。例如：

```
<xsl:value-of select="MyField"/> 
```

这将在 XSLT 处理时正确返回 XML 中 MyField 的值。我想使用我之前定义的变量来执行此操作。例如：

```
<xsl:value-of select="$MyAttributeValue"/> 
```

因此，$MyAttributeValue 包含“MyField”，但我希望在使用变量时显示 XML 中 MyField 的***值***，而不是文字文本“MyField”。

怎么可能呢？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T17:26:08.870

```
<xsl:value-of select="*[local-name() = $MyAttributeValue]" /> 
```

将返回名称与`$MyAttributeValue`.

如果您的变量包含命名空间限定名称，例如`"foo:MyField"`，请改用该`name()`函数：

```
<xsl:value-of select="*[name() = $MyAttributeValue]" /> 
```

# php - 使用 PHP 写入目录：这是权限问题吗？

> ID：678388
> 
> 赞同：1
> 
> 时间：2009-03-24T17:24:06.457
> 
> 标签：php, linux, apache, file, permissions

我的 PHP 脚本写入一个文件，以便它可以创建一个 jpg 图像。

```
fwrite($handle, $GLOBALS['HTTP_RAW_POST_DATA']);
fclose($handle);    
print $newfile.'.jpg'; 
```

我已将此脚本放在新服务器上，但图像永远不会保存。它保存到的文件夹的权限是 755 但它不拥有它。上次，我想我通过将目录所有者更改为 apache 解决了这个问题，因为这就是 PHP 运行的方式。我不能再这样做了，因为我不是 root。

首先，还有其他解决方法吗？其次，如果我可以像上次一样更改目录的所有者，这会解决问题吗？

谢谢大家的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T17:41:03.513

1.  将文件夹的权限更改为 777 ( `rwxrwxrwx`)
2.  从 PHP 使用[mkdir创建子目录](http://www.php.net/manual/en/function.mkdir.php)
3.  将您的目录权限改回 755 ( `rwxr-xr-x`) 甚至更好的 711 ( `rwx--x--x`)
4.  从现在开始，将您的图像保存在子目录中，该子目录现在归 www-data（或 Apache 使用的任何用户）所有。

顺便提一句。您可以减少以下代码：

```
fopen($newfile.'.jpg','wb');
fwrite($handle, $GLOBALS['HTTP_RAW_POST_DATA']);
fclose($handle);    
print $newfile.'.jpg'; 
```

到：

```
file_put_contents($newfile.'.jpg', 
                  file_get_contents('php://input', 
                                      FILE_BINARY), 
                  FILE_BINARY) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T17:43:23.180

如果您不是所有者，那么是的，目录为 755 是一个问题。

分解它，755 是：

*   用户（所有者）已读取 (4)、写入 (2) 和执行 (1)
*   组已读取 (4) 并执行 (1)
*   其他人已阅读 (4) 并执行 (1)

请注意，**只有**所有者拥有 755 的写入权限。

如果打开失败，PS fopen 应该返回错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T09:50:20.307

用这个：

```
>chown dir_name www-data 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T17:40:06.340

几周前我遇到了类似的问题。它最终成为服务器中设置的 PHP 安全模式。

检查出！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T17:41:45.243

将 error_reporting(E_ALL) 放在脚本的顶部，并检查它是否在尝试保存图像时打印出任何警报。

# perl - 为什么不使用 CPAN 模块？

> ID：678393
> 
> 赞同：23
> 
> 时间：2009-03-24T17:24:31.680
> 
> 标签：perl, cpan

ETA：当我问“你为什么不使用 CPAN 模块？”时，我指的是那些拒绝使用**任何CPAN 模块（包括像**[DBI](http://search.cpan.org/dist/DBI/DBI.pm)这样的高质量模块）的人。并非所有的 CPAN 代码都是高质量的，远离琐碎或基于实验代码的模块是可以的（前几天我对一个开发人员很生气，因为他想要引入[Time::Format](http://search.cpan.org/dist/Time-Format/lib/Time/Format.pm)只是因为他没有'不知道 strftime 在[POSIX](http://perldoc.perl.org/POSIX.html)中）。

最近在[Perl Beginners](http://www.nntp.perl.org/group/perl.beginners/)上，有人想知道如何在不借助通常为该功能建议的 Perl 模块的情况下做某事。他或她不想从 CPAN 安装模块。这让我想到了我看到人们避免使用 CPAN 的原因，我想出了这种行为的五个原因以及每个原因的解决方案：

1.  他们吓到你（回答，克服它）
2.  他们吓到你的系统管理员（回答，通过在你的主目录中安装并使用 lib pragma 来解决它们）
3.  您正在使用阻止您安装模块的托管服务（回答，获得更好的服务，有些便宜的服务不像白痴）
4.  目标机器不一定有所需的模块（回答，使用 PAR 或 PAR::Packer）
5.  目标机器完全被锁定（即您登录到 rbash 并且必须向第三方提供代码以包含在盒子上）（4 的组合并通过官僚机构）
6.  您正在使用无法加载模块的 Perl 嵌入式版本（没有答案，您被卡住了，但这非常罕见）

那么，如果您不使用 CPAN，为什么以及为什么上面的答案不够充分？请注意，我不是在问您为什么不直接从 CPAN 在生产 boxen 上安装，而是在问您为什么避免使用 CPAN 中的模块（通过打包系统安装对我来说算作使用 CPAN）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-25T09:30:00.953

我有时建议人们不要使用某些 CPAN 模块有几个原因。并非所有 CPAN 都是高质量的代码，并且针对不同的发行版有不同的维护级别。每个人都应该考虑他们必须做多少工作才能使用特定的 CPAN 模块以及该模块为他们节省了什么（即总拥有成本）。使用任何特定的 CPAN 模块并不总是有益的。我并不是说人们不应该使用任何 CPAN，但他们应该考虑他们真正需要什么。

1.  外部模块依赖项允许其他人破坏您的应用程序。CPAN 工具链只关心模块的最新版本，当它看到你有一个早期版本时可能会升级你的安装。当底层的外部依赖项引入新的错误、不推荐使用的功能等时，我已经看到许多应用程序崩溃。这是我一直在为公司开发我的工具来托管他们自己的 CPAN 存储库以便他们可以控制它的原因之一。还有其他方法可以缓解这种情况，但没有多少人足够成熟，可以有一个好的流程。

2.  您在必须批准所有代码的环境中工作。对很多人来说，这似乎是一个愚蠢的要求，但风险​​管理人员也有工作要做。有时，这种合规性是由各种法律、护理标准等规定的。除非该模块真的可以节省大量时间和精力，否则可能不值得为完成该过程而付出努力。真的，你们中有多少人认真检查过从 CPAN 获得的代码？里面可能有任何东西。

3.  一些 CPAN 模块实现了简单编码的功能。仅仅因为它在 CPAN 上而使用一个模块并且您不想自己编写这三行代码有点愚蠢。你可以随心所欲地谈论代码重用，但归根结底，那就是*reductio ad absurdum*。

4.  某些模块的安装可能非常棘手、脆弱和不可预测，有时这是由于构建和测试模块的依赖项列表很长，即使您不需要这些依赖项来实际使用该模块。在自动化测试环境中处理这些情况需要做很多工作。

5.  一些 CPAN 作者是实验性编码人员，而不是维护人员。在他们的工作上创建依赖关系意味着您最终会得到一个不受支持的模块，该模块没有得到修补，也没有其他人真正关心过。对于一些重要的项目来说，让你的补丁被接受是一件非常重要的事情，如果不求助于一些使用本地补丁版本的过程并且不会被 CPAN 工具链覆盖，你就无法修复无响应的作者。

对于使用其他服务、在本地目录中安装等的 glib 答案，您不会逃避这些原因。您不能将反论点应用于每种情况和设置。任何告诉您其他情况的人，例如Leon 链接到的[不使用模块的七大（坏）理由](http://www.perlmonks.org/?node_id=750190)中的顶部帖子，并没有真正考虑任何人的情况，并且有许多深思熟虑的反反论点。

永远不要从认为任何人应该或不应该使用 CPAN 的立场开始。评估当地情况，评估风险和回报，制定风险保障措施，明智地使用模块。这与任何其他类型的严肃软件开发或商业实践没有什么不同。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T18:02:43.837

您可能会发现[这篇文章](http://perlmonks.org/?node_id=750190)（及其评论）很有趣。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-25T17:44:23.357

我很高兴你问。

我想问一个问题，比如“为什么 CPAN 必须这么烂？” 但是当我（认为我）已经知道答案时，我决定牺牲我的声誉是不值得的。由于这个问题被标记为“主观”，我会感谢你没有缓和我对这个问题的个人看法，即使你认为我是错误的或愚蠢的。

首先是一些背景知识：我在 90 年代中期编写了很多 Perl 编码并且很喜欢它，但最终得出结论，该语言缺少许多“真正的”面向对象编程所需的特性。我成为 C++ 开发人员已有好几年了，现在是一名技术含量很高的项目经理。我仍然使用 Perl 进行脚本和数据处理以及其他零碎的工作，并且最近开始使用 Perl 脚本来测试我们的编码人员开发的 Web 服务。

无论如何，我来到堆栈溢出是为了项目管理，但为了 Perl 而留了下来。我很高兴看到这门语言已经成长起来，并且拥有各种很棒的模块，比如 Moose 和 MVC 以及模板等等，并且很想使用它们……我会的。但这需要时间，而且我现在只有几个小时来处理它。为什么不容易？

但是要回答这个问题...

1.  首先是显而易见的答案：大多数 Perl 程序不需要 CPAN 模块。

2.  有不止一种方法可以做到这一点。我不需要模块来做很多我会使用模块的事情，如果这样做很容易的话。例如，我一直在用 split() 和正则表达式解析 XML 文档。我知道这是错误的（但恢复的第一步是承认你有问题）。但是我可以在几秒钟内复制并粘贴代码来完成这项工作，或者我可以离开并尝试让 cpan 再工作一个月左右。

3.  现在让我们有一点争议。CPAN 很脆弱。今年早些时候，我尝试使用 cpan 安装 Moose，因为我阅读了关于它的精彩内容，并且热衷于在 Perl 中进行正确的 OO 编程，并且它不难/难看。所以我按照安装说明，按了数百次（看起来）“Y”，然后在最后一步被编译器警告的页面和页面倾倒。我现在该怎么办？我的主开发盒有某种半损坏的 Moose 模块，正等着（我敢肯定）在我最不期待的时候咬我的屁股。那是大约两个月前的事了，我还没有回来。我推测很多 Perl/CPAN 都依赖于其他编程语言，这使得它更加脆弱（与库以相同语言编码的语言相反）。

4.  CPAN 初学者的文档很差。无论如何，权威的 CPAN 文档在哪里？初学者的介绍和教程在哪里？我怎么会知道呢？我已经断断续续地阅读了几个月的 CPAN 文档，并且开始弄清楚事情在哪里。（我看到几乎所有 CPAN 上的单个 Perl 模块在内部都有精美的文档，但我花了很长时间才找到该文档。）

5.  安装过程太难了。十年前，包少、依赖少的时候，四步百提示可能还行，但现在就很烂了。为什么我不能在我的 shell 中输入“cpan-install Moose”之类的内容并完成它？这特别奇怪，因为高级用户经常声称可移植性是一种美德，引用了我仍然没有得到的包和 PAR 之类的东西。既然有这么多人似乎想要在本地安装，为什么还要更难呢？

6.  有一些令人烦恼的问题，例如我应该使用 cpan 还是使用包管理系统安装 CPAN 模块，其中建议不一致。更一般地说：有不止一种方法可以做到这一点。当你开始学习高级 Perl 时，你必须决定如何安装模块、使用哪些模块以及从哪里开始？请记住，您是初学者，文档有点零散，学习曲线陡峭。我的解决方案是在我阅读更多内容时尝试通过不使用 cpan 来解决这个问题。

7.  最后，高级 Perl 的学习曲线非常陡峭。高级 Perl 用户显然不记得这一点，也看不到它。IMO 在使用 Perl 最初的构想（作为具有强大正则表达式的实用提取和报告语言）与将其用作具有 OO、模板和 MVC 以及各种其他好东西的现代开发平台之间存在天壤之别. 我还没有找到一条从普通 Perl 使用到高级 Perl 使用的温和、渐进的路径。

所以你去。为咆哮道歉。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-24T18:20:23.620

在本地安装 Perl 模块有点挑战。这是我的过程：

设置用户本地化的 CPAN 配置：

```
mkdir -p ~/.cpan/CPAN
touch ~/.cpan/CPAN/MyConfig.pm 
```

如果 CPAN 之前是为站点范围的管理员设置的（也就是说，您在自己的机器上并且已经启动并配置了 CPAN），您可以通过以下方式更改为用户本地：“ `perl -MCPAN -e mkmyconfig`”。然后，编辑“ `~/.cpan/CPAN/MyConfig.pm`”：

```
'makepl_arg' => q[LIB=/home/your_name/perllib], 
```

否则，您可以正常启动 CPAN：“ `perl -MCPAN -e shell`”或简单地“ `cpan`”。系统将提示您进行配置。在“'perl Makefile.PL' 命令的参数？”处，输入：“ `PREFIX=~ LIB=~/lib/perl5`”。

要在您的 Perl 脚本中引用本地安装的模块，您可以执行`use lib`pragma，但我认为当您的应用程序中有大量 perl 脚本和模块要更新时，这是一个烦人的依赖项。这更像是一种解决方法。

相反，我可以将环境变量设置`PERL5LIB`为本地安装模块的路径，例如“ `$HOME/lib/perl5`”。要设置`PERL5LIB`CGI 环境，请弄清楚如何在服务器配置中设置环境变量。在 Apache 中，我可以在`httpd.conf`或`.htaccess`使用 mod_env 中做到这一点。（谢谢，布赖恩·d·福伊）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-24T18:37:01.430

您可能将 Perl 脚本引擎嵌入到主机应用程序（例如 Web 服务器或任何需要脚本的复杂应用程序）中，并且在该嵌入式上下文中有很多限制，例如无法加载文件。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-24T22:15:07.037

如果事情“吓坏了系统管理员”，他们不希望你把它们*放在*机器上，不管你认为你会把它们放在哪里。商店有标准是有原因的。

CPAN 模块没有责任分配。在我目前工作的商店中，我们与封装的会计软件提供商达成了这样的协议。如果我们的应用程序出现故障并且我们需要他们的专业知识，我们会在半夜给他们打电话。因为如果我们的计算搞砸了，我们与他们的合同确保*他们*将支付部分账单，这取决于他们对给定问题的暴露程度。

当您进入现实世界时，Perl 脚本可以与 40 岁的成熟、顽固的 COBOL 一起运行，您可能会明白管理人员运行 COBOL 比使用“脚本”更轻松，这很大程度上取决于热心爱好者，无论多么聪明。

也就是说，我目前的商店对非关键脚本和报告的 Perl 有点满意，并且会偶尔安装 CPAN 模块，但审批过程很严格，沙盒测试很长（而且很昂贵！），但它使之成为可能。我只能想象他们可以批准一两个新模块，而不是 50 多个新模块，因为这会使他们面临多少新情况。因此，如果任何依赖项显示“不推荐用于生产代码”或“实验性”，那么由“让我们只使用 CPAN”人群创建的模块几乎都被淘汰了。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-25T19:46:10.270

这是我能想到的一个正当理由：您想弄清楚如何自己做。这很好，只要您意识到生产环境不适合您自己的个人实验。

有人可能会说“看看 CPAN 模块是如何做到的”，但阅读别人的实现并不能代替自己做。老实说，很多 CPAN 实现有点可怕。这可能是对 CPAN 代码质量的贬低，但它也是一个成功案例，说明 CPAN 模块的封装和测试程度在很大程度上是您没有注意到的。

至于所有关于“CPAN shell 很难设置”的变体答案，我同意。但是，这是一个 O(1) 问题。你解决它一次，然后你就可以在你的余生中轻松访问 CPAN。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-20T04:11:26.323

一些模块基于开源库，在您拥有的所有疯狂环境中都无法编译或运行良好。例如考虑需要在 NCR、HP、SUN、Linux 和 AIX 上运行。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-25T11:09:49.030

> 目标机器不一定有需要的模块

这在某些环境中可能是有效的。我的一个朋友在一个跨越国家和大陆的大型企业集团工作。他经常使用 perl 让磁带驱动器在世界各地做事。脚本必须部署在数以千计的机器上，并且安装模块非常重要——通常在每个物理位置都涉及一个委员会和多个系统管理员。他倾向于不惜一切代价避免他们，我不能说我责怪他。

有解决方案吗？我真的不认为有。

（以上是我对关于 permonks 的一个非常相似的问题的回答的剪切和粘贴。）

[http://perlmonks.org/?node_id=750387](http://perlmonks.org/?node_id=750387)

> （回答，使用 PAR 或 PAR::Packer）

我曾经向他建议过 PAR，但根本不实用。没有一台机器足够相似，以至于 PAR 在一般情况下真正有用。他的选择是：不使用模块或维护 1300 个 PAR 二进制文件。即使您肯定知道目标模式，PAR 也很难很好地工作，因此他选择不使用模块。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-09-04T15:49:33.813

目标主机有一个笨拙的操作系统，CPAN 模块不能很好地支持（部分原因是缺乏[CPAN 测试](http://www.cpantesters.org/)器）。

此类示例是 AIX 和 HP-UX。他们有一个旧的 perl，要么没有 C 编译器，要么有一个旧的/损坏的库和旧的/损坏的库，所以太多的 XS 模块无法开箱即用地安装。修补它们需要时间（尤其是当 CPAN 作者几个月都没有回复时），并且在实践中尝试解决 XS 模块是不可能的（好吧，如果你真的想这样做，你将不得不经常修补纯 perl 模块依赖于 XS 模块）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-16T13:22:27.370

这是积极方法的答案，即它说明了如何解决使您无法使用 CPAN 模块的限制：[是的，即使您可以使用 CPAN](http://perlmonks.org/?node_id=693828)。

# sql - 带有准备好的语句的 SQL 注入？

> ID：678400
> 
> 赞同：11
> 
> 时间：2009-03-24T17:26:28.913
> 
> 标签：sql, sql-injection, prepared-statement

如果我没记错的话，我认为 Jeff 在 Stack Overflow 播客中提到了 SQL 准备语句中可能存在的弱点。我想知道他指的是哪种弱点？可能只是[使用不当](http://www.owasp.org/index.php/Preventing_SQL_Injection_in_Java#Prepared_Statements)，还是更险恶？

在我的记忆中，播客并没有深入探讨这个主题，只是顺便说一句。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T17:37:48.437

我认为他说的是，当您使用 Prepared Statements 时，SQL Server 可以缓存您的查询执行计划，因此，即使您修改执行查询的某些参数，服务器也可能选择错误的（可能是缓存的）执行计划那会表现得很糟糕。

他还提到了 SQL Server 2008 的一项新功能，即强制引擎重新评估他用来克服这种情况的执行计划。

使用Prepared Statements，我唯一的问题就是这个。考虑以下 Java 代码：

```
String sql = "select * from table where name like ?";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setString(1, "PATTERN%");
ResultSet rs = pstmt.executeQuery(); 
```

在这里，您会期望，如果您在 table(name) 上有一个索引，它将被查询计划使用。好吧，它不会。因为 PraparedStatement 必须预编译并预期最坏的情况：例如，'%PATTERN%'。所以，它不会优化。我花了一段时间才弄清楚这一点。它导致我的数据库受到影响。:(

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:36:37.097

除了正常的 sql 注入（我们可以称之为一阶）攻击之外，还有二级攻击。例如，存储过程使用字符串连接来构建查询然后执行的情况并不少见。如果检索到的字段值的结果包含在这样的连接中，则存在注入的危险。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T17:36:13.213

如果准备好的语句具有以任何方式动态构造的参数，那么这很可能是弱点的根源。

如果您使用带有经过测试的类的适当数据库库来设置参数，那么您在任何时候都不会打开自己的 SQL 注入，无论是否准备好语句。

请记住，仅仅因为准备了一条语句，或者因为您正在使用存储过程，这并不意味着您可以免受注入攻击。只有当您使用数据库提供程序代码来清理参数的输入（以及将其应用于所有可以使用的参数）时，您才能获得 SQL 注入保护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T17:35:10.500

我没有听过播客，但根据我的经验，只有准备好的陈述才是好的。它通常可以提高应用程序的性能并防止 SQL 注入（如果使用得当，而不是作为链接中的第二个示例）。

# python - 带有 mod_wsgi/cherrypy 的soaplib

> ID：678409
> 
> 赞同：1
> 
> 时间：2009-03-24T17:28:40.343
> 
> 标签：python, soap, mod-wsgi, cherrypy

我已经按照教程使用 mod_wsgi 设置 Apache 来连接cherrypy 并创建一个运行它的站点。这是我的“myapp.wsgi”，打开[http://localhost/](http://localhost/)效果很好。打开[http://localhost/ape/](http://localhost/ape/)实际上返回文本而不是肥皂响应，并且[http://localhost/ape/service.wsdl](http://localhost/ape/service.wsdl)返回 500 HTTP 错误代码。在运行如此简单的 SOAP 服务时我做错了什么？我怎样才能让它返回有效的 WSDL？我的代码如下

干杯

尼克

```
import atexit, threading, cherrypy,sys
from soaplib.wsgi_soap import SimpleWSGISoapApp
from soaplib.service import soapmethod
from soaplib.serializers.primitive import String, Integer, Array

sys.stdout = sys.stderr
cherrypy.config.update({'environment': 'embedded'})

class Root(object):
    def index(self):
        return 'Hello World!'
    index.exposed = True

    @soapmethod(_returns=String)
    def ape(self):
       return 'Ape!!'
    ape.exposed = True

application = cherrypy.Application(Root(), None) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T17:59:45.217

我刚刚通过将文件的最后一行替换为

```
cherrypy.quickstart(Root(), "/") 
```

它对我来说很好。我建议尝试一下，看看它是否适合你；如果确实如此，那么您将知道这是与在 Apache/mod_wsgi 下运行它有关的问题，而不是您的代码的固有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T00:27:15.690

以利是对的；仅仅创建一个 Application 实例是不够的。您必须将它安装在cherrypy.tree 上，quickstart() 会为您完成。

# python - 如何将非连续数字添加到范围？

> ID：678410
> 
> 赞同：8
> 
> 时间：2009-03-24T17:28:44.883
> 
> 标签：python, range

我正在尝试遍历范围（750、765）并添加非连续数字 769、770、774。如果我尝试在范围函数之后添加数字，它会返回范围列表，然后是单个数字：

```
 >>> for x in range(750, 765), 769, 770, 774: print x
... 
[750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764]
769
770
774 
```

如何在一个列表中获取所有数字？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-24T17:31:23.177

使用内置的 + 运算符将非连续数字附加到范围。

```
for x in range(750, 765) + [769, 770, 774]: print x 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-24T17:33:50.300

有两种方法可以做到这一点。

```
>>> for x in range(5, 7) + [8, 9]: print x
...
5
6
8
9
>>> import itertools
>>> for x in itertools.chain(xrange(5, 7), [8, 9]): print x
...
5
6
8
9 
```

[itertools.chain()](http://docs.python.org/library/itertools.html#itertools.chain)远远优于它，因为它允许您使用任意可迭代对象，而不仅仅是列表和列表。它也更有效，不需要列表复制。它允许您使用 xrange，在循环时您应该使用它。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-24T17:34:51.563

此页面上的其他答案将为您提供很好的服务。请注意，在 Python3.0 中，`range`是一个迭代器（就像 xrange 在 Python2.x 中一样...... xrange 在 3.0 中消失了）。如果您尝试在 Python 3.0 中执行此操作，请确保在添加之前从范围迭代器创建一个列表：

```
for x in list(range(750, 765)) + [769, 770, 774]: print(x) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T17:32:18.447

你在找这个吗：

```
mylist = range(750, 765)
mylist.extend([769, 770, 774]) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-04T12:05:24.730

在 python3 中，由于您不能将列表添加到范围，如果由于某种原因您不想导入 itertool，您也可以手动执行相同的操作：

```
for r in range(750, 765), [769, 770, 774]:
    for i in r: 
        print(i) 
```

或者

```
for i in [i for r in [range(750, 765), [769, 770, 774]] for i in r]: 
    print(i) 
```

# java - 如何在大型项目中处理 UI 小部件的翻译？

> ID：678412
> 
> 赞同：2
> 
> 时间：2009-03-24T17:29:02.420
> 
> 标签：java, internationalization, verification

我正在开发一个包含大量 GUI 小部件的大型 Java 1.4.2 项目（约 3000 个文件...）。需要将 UI 小部件上的所有文本翻译成不同的语言（意大利语、法语、德语），此时仅限欧洲语言。

1.  您将如何为此类问题设计解决方案？
2.  一旦实施，您将如何验证该解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T17:36:39.263

1.  我将使用类似于用于[Swing 应用程序框架](https://appframework.dev.java.net/intro/index.html)中的小部件的[属性文件](http://java.sun.com/developer/technicalArticles/javase/swingappfr/#resource)的解决方案。这将允许您将所有相关属性（按钮名称、工具提示等）放入类似于 massProjectFrench.properties 或 massProjectGerman.properties 的内容中。

2.  此时，您可以将每个语言版本分配给母语人士/专家，以确保您的拼写、语法（片段）等正确无误。

    作为一项单独的工作，您需要运行每个版本以确保可能被剪裁的按钮名称和其他属性实际上适合适当的范围。如果没有，您需要做一些适合语言的缩写或重新设计以允许更大/更小的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T17:37:31.227

只是一般的想法.. 您可以构建一个或多个关联数组来保存所有文本并将其声明为常量。然后，根据您需要的语言以不同方式导入它们。

# text - 在文本文件顶部添加行，保留格式

> ID：678419
> 
> 赞同：0
> 
> 时间：2009-03-24T17:30:42.883
> 
> 标签：text, formatting

我有一个配置文件，我需要在文件顶部添加几行。当我尝试从命令行执行此操作时，它会从我的文件中删除换行符并给我一个未格式化的文件。

所以，我的问题是：我可以在已经存在的文件的顶部添加一些行，并且它应该保留其格式并且新行保留为新行吗？

我正在从另一个文件向现有文件添加新行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T17:41:11.033

在 Windows 中，您可以使用附加信息创建一个新文件，然后将其与原始文件一起复制到一个新文件中。假设您有一个名为 config.txt 的现有文件和一个名为 new.txt 的新文件：

复制 new.txt+config.txt newConfig.txt

或者，您可以**键入**旧文件并附加到 new.txt：

键入 config.txt >> new.txt

我认为第二个选项可以在 Linux 中使用，使用**cat**命令而不是**type**。

无论哪种方式，您都需要删除旧的配置文件并重命名新的配置文件。

如果你想在代码中做到这一点：

*   分配一个足够大的缓冲区来保存组合文件（即旧文件的长度 + 新文件的长度）
*   在缓冲区的开头将新文件读入内存
*   从新文件结束后的字节开始将旧文件读入内存
*   将缓冲区保存到磁盘

# freebase - Freebase MQL 过滤器在哪里 value != null？

> ID：678420
> 
> 赞同：7
> 
> 时间：2009-03-24T17:30:58.250
> 
> 标签：freebase, mql

我正在尝试编写一个过滤掉空值的 MQL 查询。

我现在的查询（可以使用[MQL 查询编辑器](http://www.freebase.com/tools/queryeditor)执行）：

```
[
  {
    "/common/topic/image" : [
      {
        "id" : null
      }
    ],
    "article" : [
      {
        "content" : null
      }
    ],
    "name" : "bill gates",
    "type" : "/common/topic"
  }
] 
```

我得到的结果：

```
[
  {
    "/common/topic/image" : [
      {
        "id" : "/guid/9202a8c04000641f8000000004fb4c01"
      },
      {
        "id" : "/wikipedia/images/commons_id/4486276"
      }
    ],
    "article" : [
      {
        "content" : null
      },
      {
        "content" : "/guid/9202a8c04000641f800000000903535d"
      }
    ],
    "name" : "Bill Gates",
    "type" : "/common/topic"
  }
] 
```

我试图弄清楚如何在查询时过滤掉“内容”：“文章”数组中的空匹配。我查看了 MQL 文档，但没有找到明确的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T18:39:24.857

要过滤掉没有分配任何内容的文章，您必须扩展内容 id 属性并将可选指令设置为 false。

```
[
  {
    "/common/topic/image" : [
      {
        "id" : null
      }
    ],
    "article" : [
      {
        "content" : {
          "id" : null,
          "optional" : false
        }
      }
    ],
    "name" : "bill gates",
    "type" : "/common/topic"
  }
] 
```

这将为您提供以下结果：

```
[
  {
    "/common/topic/image" : [
      {
        "id" : "/guid/9202a8c04000641f8000000004fb4c01"
      },
      {
        "id" : "/wikipedia/images/commons_id/4486276"
      }
    ],
    "article" : [
      {
        "content" : {
          "id" : "/guid/9202a8c04000641f800000000903535d"
        }
      }
    ],
    "name" : "Bill Gates",
    "type" : "/common/topic"
  }
] 
```

有关使用可选指令的更多信息，请参阅[此处](http://mql.freebaseapps.com/ch03.html#optionaldirective)的文档。

# lex - 命令在 lex 中失败

> ID：678425
> 
> 赞同：0
> 
> 时间：2009-03-24T17:32:22.100
> 
> 标签：lex, fall-through

我在我的程序中使用 lex，我遇到了一个需要帮助的问题。

我的程序以 [something " something] 的形式接受其输入。这工作正常。

但是，我还需要接受 [something"something] 形式。

有没有一种方法可以让我在 lex 中有某种第一种情况，所有输入都通过（如预处理），然后在我的程序的其余部分继续进行相同的修改输入？

这就是我所说的：

```
%%
.* {
   do preprocessing
   }

something{
   return SOMETHING;
   }

\" {
   return QUOTE;
   }
%% 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T18:03:28.967

好吧，您实际上可以在 lex 中编写一个预处理器并将其放入您的构建系统中，但这*可能是*矫枉过正！

您可以使用开始条件，使用 BEGIN 在它们之间切换，并首先解析输入，然后使用 unput 将字符推回流中，然后可以使用不同的开始条件来解析结果（参见[Flex 手册](http://westes.github.io/flex/manual/Actions.html/)）。

我最近为类似 python 的配置语言编写了一个解析器，它就是这样做的。解析器有两种模式（开始条件），一种是在行首计算制表符以确定范围，另一种是进行实际解析。

这些方法很好，但通常有更好的方法，特别是如果您的输入方案不是非常复杂。

对于您的程序，[something "something] 和 [something"something] 之间是否存在语法差异？空白饮食规则可以解决问题吗？

能多描述一下你的语言和语法吗……？

评论后：

好的，所以基本上你有两个标记，SOMETHING 和 QUOTE。如果您的令牌由空格分隔，您可以执行以下操作：

```
%%
\"     {
       //this will match a single quote
       return QUOTE;
       }

[^" \t\n\r]+   {
               //this will match a run of anything thats not a quote, space, tab or line ending
               return SOMETHING;
               }

[ \t\n\r]      {
               //do nothing: i.e. ignore whitespace
               }

%% 
```

对于您的 SOMETHING 令牌，您还可以匹配类似`[A-Za-z_][A-Za-z0-9_]*`字母或下划线后跟 0 个或多个字母、下划线和数字的内容。

这有帮助吗？

# tsql - ISNULL 在 TSQL Select 中不起作用

> ID：678430
> 
> 赞同：0
> 
> 时间：2009-03-24T17:33:55.997
> 
> 标签：tsql, select, isnull

我有一个可以返回空值的 TSQL SELECT。我尝试使用 ISNULL 将其替换为 0 但由于某种原因它不起作用。从中选择的表具有以下列：

*   storeID --> int
*   惩罚百分比->小数（9,2）
*   惩罚日期 --> 日期时间

```
SELECT  ISNULL(penaltyPercent, 0.0) AS penaltyPercent  
FROM    dbo.Penalty  
WHERE   (penaltyDate = (SELECT     MAX(penaltyDate) AS date  
                        FROM       dbo.Penalty AS Penalty_1  
                        WHERE      (penaltyDate <= @date) AND (storeID = @storeID))) AND
        (storeID = @storeID) 
```

当日期在第一个惩罚日期之前（应该有 0 惩罚），不返回结果。不知道为什么这不起作用。我有一个解决方法，但它困扰着我。

以下是正在使用的数据示例：

```
storeID  penaltyDate             penaltyPercent  
182      10/1/2008 12:00:00 AM   0.020000  
182      11/1/2008 12:00:00 AM   0.040000  
182      12/1/2008 12:00:00 AM   0.070000 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T17:43:25.537

当您说“当日期在第一个处罚日期之前”时，您的意思是当 的值`@date`小于从该查询返回的值时？

```
SELECT MIN(penaltyDate)
FROM Penalty 
```

因为你的内部查询将返回 null，并且（如果你使用 ANSI nulls）这部分将返回 false，

```
WHERE (penaltyDate = ... 
```

因为与 null 的比较总是返回 null。因此，您没有选择任何行，而不是选择具有空值的一行。

附录：

要确认这是问题所在，请将外部查询的第一行更改为

```
SELECT ISNULL(MAX(penaltyPercent),0.0) AS penaltyPercent 
```

由于我上面描述的内容，它将起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:44:24.597

如果@date < 惩罚日期，则不返回任何行，因此 ISNULL 没有值可根据。您可能希望将惩罚百分比选择到变量中，然后选择结果集`ISNULL(@pentaltyPercent)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T17:45:10.680

您是否真的有数据表明它的日期早于第一个惩罚日期？如果您的查询不返回记录，您的 IsNull 子句将执行任何操作，因为它适用于任何操作。

# http - 手动设置响应状态码

> ID：678433
> 
> 赞同：2
> 
> 时间：2009-03-24T17:34:31.110
> 
> 标签：http, redirect

我有一个 try catch 块来处理我的应用程序遇到的错误。我想要一种简单的方法来设置对状态代码 403 或禁止的响应，然后将用户重定向到登录页面或自定义错误页面。

设置状态代码和重定向后，我遇到了一些问题。有人有设置状态码然后重定向的示例吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T17:38:22.333

```
Response.Status = "403 Forbidden";
Response.Addheader("Location", "http://stackoverflow.com/"); 
```

这在 C# 中，但概念在大多数语言中应该几乎相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T22:30:35.770

重复：[当资源被禁止但有备用资源时，HTTP 响应应该是什么？](https://stackoverflow.com/questions/199737/what-should-the-http-response-be-when-the-resource-is-forbidden-but-theres-an-al)

发送[位置标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30)仅适用于 3xx（重定向）或 201 Created 响应。尽管它可能适用于大多数客户端，但恕我直言，它不是 HTTP 的设计方式。

如果您真的关心正确的状态代码并遵循 HTTP 规范，为什么不回复 303 See Other 或使用[HTTP authentication](http://www.ietf.org/rfc/rfc2617.txt)。

# javascript - 如何从中检索值使用 jQuery？

> ID：678434
> 
> 赞同：8
> 
> 时间：2009-03-24T17:34:32.390
> 
> 标签：javascript, jquery

我必须隐藏输入字段，例如：

```
<input name="foo" value="bar">
<input name="foo1" value="bar1"> 
```

我想检索这两个值并使用 jQuery 将它们发布到服务器。如何使用 jQuery 选择器引擎来获取这些值？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-24T17:40:21.503

由于 "foo" 和 "foo1" 是您输入字段的*名称*，因此您将无法使用 jQuery (#) 的 id 选择器，但您必须使用属性选择器：

```
var foo = $("[name='foo']").val();
var foo1 = $("[name='foo1']").val(); 
```

就性能而言，这不是最佳选择。您最好设置输入字段的 id 并使用 id 选择器（例如 $("#foo")）或至少为属性选择器提供上下文：

```
var form = $("#myForm"); // or $("form"), or any selector matching an element containing your input fields
var foo = $("[name='foo']", form).val();
var foo1 = $("[name='foo1']", form).val(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T17:39:34.623

您应该使用 id 或 classes 来加快获取价值的过程。

ID 版本（假设输入有 id='foo'）

```
var value1 = $('#foo').val(); 
```

类版本（假设输入有 class='foo'）

```
var value1 = $('.foo').val(); 
```

# linux - SVN 就地导入和签出

> ID：678437
> 
> 赞同：28
> 
> 时间：2009-03-24T17:34:55.370
> 
> 标签：linux, svn, version-control

使用 Linux 命令行和[Subversion](http://en.wikipedia.org/wiki/Apache_Subversion)，是否可以获取目录并为其添加版本控制？

基本上，我想将目录导入到新创建的存储库中，但也希望目录成为工作副本，而无需检查它。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-24T17:44:03.287

假设您使用 svnadmin 在 /svn/foo/mydirname 创建了一个存储库，并且您想对 /home/user/mydirname 进行版本控制（这就是您的意思吗？）。

然后执行以下操作：

```
cd /home/user/mydirname
svn co file:///svn/foo/mydirname . #This only creates the ".svn" folder for version control
svn add ./*                        #Tell svn you want to version control all files in this dir
svn ci                             #Check the files in 
```

您的目录现在是版本控制的！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-30T08:41:28.877

是的，您可以将现有目录（包含内容）导入 SVN 存储库，并将当前位置用作受版本控制的工作副本。如下所示：

假设您的（未版本化的）项目源位于 /home/user/projectx，并且您的存储库已在 file:///svnrepo 中准备就绪

1.  首先，在项目树之外的某处创建一个空目录，例如`/tmp/empty`. 在您的 Subversion 存储库中导入该空目录：

    ```
    cd /tmp/empty

    svn import . file:///svnrepo/projectx 
    ```

2.  进入您填充的项目目录。现在查看您在步骤 1 中创建的存储库位置：

    ```
    cd /home/user/projectx

    svn checkout file:///svnrepo/projectx . 
    ```

这会将 .svn 文件添加到您填充的项目目录中，但它不会做任何其他事情，因此您现有的文件是安全的。

3.  接下来，将包含文件的目录添加到存储库：

    ```
    svn add *

    svn commit -m 'initial commit' 
    ```

完毕。

# opengl - 在将点转换为形状方面需要帮助

> ID：678440
> 
> 赞同：2
> 
> 时间：2009-03-24T17:35:47.783
> 
> 标签：opengl, draw, points

下面是我从 NEHE Pr​​oduction（第 25 课）复制的一整段代码。我只是想玩，但似乎无法将每个点更改/转换为单个球体或圆柱体。
不知何故当我做了我的调整它们没有按照他们设想的方式排列，它们不会旋转..
我计划稍后在本教程中添加光..

在此先感谢您的帮助=]

```
int InitGL(GLvoid)
{
    glBlendFunc(GL_SRC_ALPHA,GL_ONE);
    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
    glClearDepth(1.0);
    glDepthFunc(GL_LESS);
    glEnable(GL_DEPTH_TEST);
    glShadeModel(GL_SMOOTH);
    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);
    maxver=0;
    objload("data/sphere.txt",&morph1);
    objload("data/torus.txt",&morph2);
    objload("data/Tube.txt",&morph3);

    objallocate(&morph4,10300);

    for(int i=0;i<10300;i++)
    {
        morph4.points[i].x=((float)(rand()%14000)/1000)-7;
        morph4.points[i].y=((float)(rand()%14000)/1000)-7;
        morph4.points[i].z=((float)(rand()%14000)/1000)-7;
    }

    objload("data/Tube.txt",&helper);
    sour=dest=&morph1;

    return TRUE;
}

void DrawGLScene(GLvoid)
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    glTranslatef(cx,cy,cz);
    glRotatef(xrot,1,0,0);
    glRotatef(yrot,0,1,0);
    glRotatef(zrot,0,0,1);

    xrot+=xspeed; yrot+=yspeed; zrot+=zspeed;

    GLfloat tx,ty,tz;
    VERTEX q;
    glPointSize(2.0f);

    //glBegin(GL_POINTS);
    for(int i=0;i<morph3.verts;i++)
    {
        if(morph) 
            q=calculate(i); 
        else 
            q.x=q.y=q.z=0;

        helper.points[i].x-=q.x;
        helper.points[i].y-=q.y;
        helper.points[i].z-=q.z;
        tx=helper.points[i].x;
        ty=helper.points[i].y;
        tz=helper.points[i].z;

        glColor3f(0,1,1);
        glPushMatrix(); //i have modified this part onwards
        gltranslaste(tx,ty,tz);
        glutSolidSphere(2,6,6);
        glPopMatrix();

        /*glVertex3f(tx,ty,tz);
        glColor3f(0,0.5f,1);
        tx-=2*q.x; ty-=2*q.y; ty-=2*q.y;
        glVertex3f(tx,ty,tz);
        glColor3f(0,0,1);
        tx-=2*q.x; ty-=2*q.y; ty-=2*q.y;
        glVertex3f(tx,ty,tz);*/
    }
    //glEnd();

    if(morph && step<=steps)
        step++; 
    else 
    { 
        morph=FALSE; sour=dest; step=0;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T19:21:38.857

一个好的起点是将 glBegin(GL_POINTS) 替换为 glBegin(GL_TRIANGLES) 或 GL_QUADS 或 GL_POLYGONS。

[请在此处](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/begin.html)查看 glBegin/End 的帮助页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T19:03:58.213

这看起来像[教程代码](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=25)，完好无损。或者更重要的是，我没有看到任何代码试图绘制球体或圆柱体。你尝试了什么？它是怎么出错的？

如果您正在寻找指针，我建议您首先隔离绘制点的代码。尝试编写一个函数，根据参数中的属性绘制一个点。

（请注意，您也应该将 glBegin()-glEnd() 对移动到函数内部。在绘制每个点之前调用 glBegin() 并在绘制每个点之后调用 glEnd() ，即作为第一行和最后一行。这是因为当您最终从内部调用 gluSphere() 时，您将不得不摆脱它们。在 glBegin()-glEnd() 对之间可以调用的 GL 函数并不多。）

针对问题的编辑进行编辑：

您的代码有效。显然，用 替换它可以绘制青色形状而不是普通的`gltranslaste`点。`glTranslatef`当然，这些形状看起来很丑，一点也不像球体，但它们就在那里，甚至“变形”。有什么问题？

您可能想要使用材质和照明选项以使它们看起来更好。（或者只是分配一个纹理，以便您可以看到它们的对齐方式。）至于旋转它们，您应该能够`glRotate()`在推动和弹出 [MV] 矩阵之间调用。

# c - 获取 C 中时区的夏令时转换日期

> ID：678445
> 
> 赞同：8
> 
> 时间：2009-03-24T17:36:31.060
> 
> 标签：c, timezone, dst

在 C 中，是否有一种简单的跨平台方法来检索给定时区开始和结束夏令时的日期？

我已经有了时区偏移信息以及当前是否正在观察夏令时，但我确实需要夏令时开始和结束的日期（对于我无法控制的外部依赖）。在 Windows 中，我使用[GetTimeZoneInformation](http://msdn.microsoft.com/en-us/library/ms724421(VS.85).aspx)来获取[TimeZoneInfo](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)，但我找不到适用于 Linux/Solaris/Mac 的类似功能。我还应该指出，我不能仅仅依靠美国的夏令时采用规则，因为我无法预测它将在哪些国家/地区使用。

我知道获取此信息的唯一方法是通过[zdump](http://www.linuxcommand.org/man_pages/zdump8.html)或直接查看 /usr/share/lib/zoneinfo 文件本身，但我希望有更好的解决方案。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T18:10:12.990

The portable and **consistent** way to deal with this is to **build a year-round TZ offset table** (for each day in the current year in the current timezone) at application startup. Resolve each day's midnight local time to UTC (GMT), and record the effective timezone offset vis-a-vis UTC (GMT) for the day in question. Look for transitions in the effective TZ offsets year-round (transitions will indicate DST changes.) This approach is **consistent and portable** in that only depends on `localtime`/`gmtime` functioning reliably on the platform in question, and will return results fully consistent with `localtime`/`gmtime` calls. However, it becomes a bit **more complicated if you require DST information for other timezones** (than the process' default timezone.)

You can also **directly use the [TZ/Olson database](http://www.twinsun.com/tz/tz-link.htm)** (code available for both *nix and Windows), for **maximum flexibility**, but unless the underlying runtime/OS use the exact same timezone information (and your application uses TZ/Olson timezone information *and* `gmtime`/`localtime` interchangeably) then you're in for unpleasant surprises.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:57:03.973

I'm not sure there's a good cross-platform way to do this, but there is a programmatic interface to the `/usr/share/zoneinfo` files (or at least a description of the format) in [`tzfile.h`](http://www.gsp.com/cgi-bin/man.cgi?section=5&topic=tzfile), (available on Mac OS X and Linux).

Windows uses slightly different mappings from tzinfo, but there's a [conversion table](http://unicode.org/cldr/data/diff/supplemental/windows_tzid.html) you could use to generify your interface between Windows and Unix.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T22:01:21.313

> 在 C 中，是否有一种简单的跨平台方法来检索给定时区 > 开始和结束夏令时的日期？

不。

我在 90 年代后期在 VMS 上为 DEC 实现了 TZ 支持。

首先，没有跨平台的解决方案。

其次，日期每年都不同，也因立法而异。事实上，没有完全可靠的*程序化*解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-13T05:30:46.697

如果您需要 C++（不是 C），请查看 boost::date_time 库[http://www.boost.org/doc/libs/1_38_0/doc/html/date_time.html](http://www.boost.org/doc/libs/1_38_0/doc/html/date_time.html)

# asp.net-membership - 如何定义 ASP.NET 成员资格提供程序的密码规则？

> ID：678454
> 
> 赞同：2
> 
> 时间：2009-03-24T17:38:10.773
> 
> 标签：asp.net-membership, passwords

当使用 ASP.NET Membership 提供程序的 Web 表单身份验证时，我们默认使用一些相当严格的密码规则。我认为需要八个字符，包括一个非字母字符。

我不想让它们都随意松动，但通常我不会在自己的密码中使用非字母字符，并且觉得自己像个伪君子，强迫我的用户这样做。

我做了一些查找，但无法弄清楚该规则的定义位置。我确定我只是缺少一些简单的东西-有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T17:56:50.357

您可以使用 web 配置的 configuration\system.web\membership\providers\add 部分的 passwordStrengthRegularExpression 属性。

如果密码不抱怨指定的正则表达式，我不知道 ASP.NET 是否允许用户创建帐户。

[这里](http://msdn.microsoft.com/en-us/library/system.web.security.membership.passwordstrengthregularexpression.aspx)有一个例子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T18:01:56.443

请参阅本文，您可以在其中设置 minRequiredNonAlphanumericCharacters 设置：

[http://msdn.microsoft.com/en-us/library/ms998347.aspx#paght000022_sqlmembershipproviderconfig](http://msdn.microsoft.com/en-us/library/ms998347.aspx#paght000022_sqlmembershipproviderconfig)

# assembly - 使用程序集关闭计算机

> ID：678458
> 
> 赞同：20
> 
> 时间：2009-03-24T17:38:53.020
> 
> 标签：assembly, shutdown

如何仅使用汇编代码关闭计算机？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-24T18:08:33.277

You need to say what processor family it is and which OS you're using. Also what privileges your code is running under - if it's kernel code then it has more privileges than user code.

Assuming you're using some member of the Windows NT family (including XP or Vista) on an Intel x86 family CPU, and your code is normal (userspace) code, then... you need to call the Windows built-in function to do this. You can't just execute some magic sequence of assembly.

Even if you *could* just execute some magic sequence of assembly, you wouldn't want to - you almost certainly want to give the OS chance to write data from the disk cache to disk, and do other graceful-shutdown stuff.

If you're writing your own OS for x86, then you need to look at the ACPI (or APM) specs. If GPL code is OK, then the relevent Linux kernel routines are [here (ACPI)](http://lxr.linux.no/linux+v2.6.29/drivers/acpi/sleep.c#L696) and [here (APM)](http://lxr.linux.no/linux+v2.6.29/arch/x86/kernel/apm_32.c#L926).

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-03-09T01:14:02.110

这是我多年来一直用来在 DOS 模式下关闭计算机的 29 字节程序。

```
;Connect to APM API
MOV     AX,5301
XOR     BX,BX
INT     15

;Try to set APM version (to 1.2)
MOV     AX,530E
XOR     BX,BX
MOV     CX,0102
INT     15

;Turn off the system
MOV     AX,5307
MOV     BX,0001
MOV     CX,0003
INT     15

;Exit (for good measure and in case of failure)
RET 
```

您可以在[DJGPP使用](http://www.delorie.com/djgpp/doc/rbinter/ix/15/53.html)[Ralf Brown 的中断列表](http://www.cs.cmu.edu/~ralf/files.html)[查找](http://www.ctyme.com/rbrown.htm)更多功能。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-09-25T23:16:23.060

在 Linux 中读取 reboot(2)。

感兴趣的源文件：

kernel/sys.c kernel/exit.c 和 arch/x86/kernel/apm.c

不是一个完整的答案，但我认为这是一个好的开始。我必须阅读我的 BIOS 机器代码才能了解它们的作用。但这部分是特定于机器的。如果你知道主板上的 IC 控制电源，你可以找出你需要的 IO 端口、寄存器和命令。然后设置正确的板/设备状态，然后发出命令关闭电源。

BIOS 管理电源通过 INT 15h ah=53h（所谓的高级电源管理又名 APM）函数 al=07 在 Linux 中使用是设置电源状态 cmd。参数 bx=0001h 表示所有设备，cx=0003k 表示停止。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-04-22T18:37:28.583

来自 arch/x86/kernel/amp.c：

```
/**
 * apm_power_off - ask the BIOS to power off
 *
 * Handle the power off sequence. This is the one piece of code we
 * will execute even on SMP machines. In order to deal with BIOS
 * bugs we support real mode APM BIOS power off calls. We also make
 * the SMP call on CPU0 as some systems will only honour this call
 * on their first cpu.
 */

static void apm_power_off(void)
{
 unsigned char po_bios_call[] = {
  0xb8, 0x00, 0x10, /* movw  $0x1000,ax  */
  0x8e, 0xd0,  /* movw  ax,ss       */
  0xbc, 0x00, 0xf0, /* movw  $0xf000,sp  */
  0xb8, 0x07, 0x53, /* movw  $0x5307,ax  */
  0xbb, 0x01, 0x00, /* movw  $0x0001,bx  */
  0xb9, 0x03, 0x00, /* movw  $0x0003,cx  */
  0xcd, 0x15  /* int   $0x15       */
 };

 /* Some bioses don't like being called from CPU != 0 */
 if (apm_info.realmode_power_off) {
  set_cpus_allowed_ptr(current, cpumask_of(0));
  machine_real_restart(po_bios_call, sizeof(po_bios_call));
 } else {
  (void)set_system_power_state(APM_STATE_OFF);
 }
} 
```

代码现在位于[apm_32.c](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=arch/x86/kernel/apm_32.c;hb=HEAD)中。搜索“apm_power_off”。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-08-22T10:17:09.593

将上面的@larz 答案转换为 nasm 程序集如下：

先决条件：博克斯，纳斯姆

这个例子是在带有标准包的 debian wheezy 上运行的。

代码（文件名：shutdown.asm）：

```
 org 0x7c00
    jmp main

Shutdown:
    mov ax, 0x1000
    mov ax, ss
    mov sp, 0xf000
    mov ax, 0x5307
    mov bx, 0x0001
    mov cx, 0x0003
    int 0x15

WaitForEnter:
    mov ah, 0
    int 0x16
    cmp al, 0x0D
    jne WaitForEnter
    ret

main:   
    call WaitForEnter
    call Shutdown

times 510-($-$$) db 0
dw 0xaa55 
```

Nasm 编译：

```
nasm -f bin -o boot_sect.img shutdown.asm 
```

Bochs 配置文件（文件名：.bochsrc）与代码（shutdown.asm）在同一目录中

```
display_library: sdl
floppya: 1_44=boot_sect.img, status=inserted
boot: a 
```

*注意我正在使用 bochs 的 sdl 库，它是与 bochs 本身分开的包

运行 bochs（来自与以前相同的目录）：

```
bochs 
```

按回车键关闭

*注意我不确定 Shutdown 标签和 WaitForEnter 标签之间的所有行都是必需的

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-06-14T19:01:01.630

这很容易。另外，伙计们，OP可能正在研究他自己的电源管理器。我正在做同样的事情。这是一个允许用户关闭机器的示例。很简单，只是给用户一个带有 OK 和 Cancel 的消息框。如果用户点击OK，机器将关闭，如果用户点击cancel，程序将退出。它在基于 NT 的 windows 版本上进行了测试，应该可以在 ME、95 和 98 等旧版本上运行。

这是我自己的代码，大家可以自由使用。 [http://pastebin.com/ccw3mWtw](http://pastebin.com/ccw3mWtw)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T17:49:08.720

Call the ExitWindowsEx API function in kernel32.dll

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-27T15:13:46.777

## 格鲁布

```
$ bzr branch http://bzr.savannah.gnu.org/r/grub/trunk/grub
$ vi grub/grub-core/commands/acpihalt.c +303 
```

或在 Github 镜像上：

[https://github.com/dajhorn/grub/blob/trunk/grub/grub-core/commands/acpihalt.c#L303](https://github.com/dajhorn/grub/blob/trunk/grub/grub-core/commands/acpihalt.c#L303)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-28T08:13:33.680

你可以尝试在`x86`Linux 机器上使用 shellcode，这不是你知道的恶意代码，只是为了好玩。此 shellcode 仅`/sbin/poweroff`在 Debian 版本上执行测试`5.0.5`。

```
#include <stdio.h>
#include <string.h>

char *shellcode = "\x31\xc0\x50\x68\x72\x6f\x66"
                  "\x66\x68\x70\x6f\x77\x65\x68"
                  "\x6e\x2f\x2f\x2f\x68\x2f\x73"
                  "\x62\x69\x89\xe3\x50\x53\x89"
                  "\xe1\xb0\x0b\xcd\x80\x31\xc0"
                  "\x50\x89\xe3\xb0\x01\xcd\x80";

int main(int argc, char *argv[]) {
    printf("shellcode length ->  %d bytes\n", (int)strlen(shellcode));
    int (*ret)()=(int(*)())shellcode;
    ret();

    return 0;
} 
```

或者这个 shellcode 执行`shutdown -h now`（运行`root`）：

```
#include <stdio.h>
#include <string.h>

char *shellcode =  "\x31\xc0\x31\xd2\x50\x66\x68\x2d"
                   "\x68\x89\xe7\x50\x6a\x6e\x66\xc7"
                   "\x44\x24\x01\x6f\x77\x89\xe7\x50"
                   "\x68\x64\x6f\x77\x6e\x68\x73\x68"
                   "\x75\x74\x68\x6e\x2f\x2f\x2f\x68"
                   "\x2f\x73\x62\x69\x89\xe3\x52\x56"
                   "\x57\x53\x89\xe1\xb0\x0b\xcd\x80";

int main(int argc, char *argv[]) {
    printf("shellcode length ->  %d bytes\n", (int)strlen(shellcode));
    int (*ret)()=(int(*)())shellcode;
    ret();

    return 0;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-09-09T05:18:20.133

对于使用此代码的 32 位操作系统：

```
BITS 32

global _start
section .text

_start:

; Local variables:
;
; [ebp-4] Address of ntdll.dll
; [ebp-8] Address of ntdll.dll's export table
; [ebp-12] Space for RtlAdjustPrivilege's output

push ebp
mov ebp,esp
sub esp,12

; Save registers

push ebx
push esi
push edi

jmp get_delta_offset ; Get the delta offset

get_delta_offset2:
    pop ebx
    jmp start ; Jump to main code

get_delta_offset:
    call get_delta_offset2

data:
    NtShutdownSystem_s db "NtShutdownSystem"
    NtShutdownSystem_len equ $-NtShutdownSystem_s

    RtlAdjustPrivilege_s db "RtlAdjustPrivilege"
    RtlAdjustPrivilege_len equ $-RtlAdjustPrivilege_s

get_function_address:

    ; Save registers

    push ebx
    push esi
    push edi

    mov eax,[ebp-8]
    mov ebx,[eax+0x20] ; ebx now points to the export names array

    add ebx,[ebp-4]
    xor eax,eax

    .get_function_address_loop:
        mov esi,edx ; esi now points to the function
        mov edi,[ebx+eax*4]
        add edi,[ebp-4] ; edi now points to the export name

        push ecx ; Save the function name length
        cld ; Clear the direction flag

        rep cmpsb ; Do the comparison
        pop ecx ; Restore the length

        je .get_function_address_end
        inc eax

        cmp eax,[ebx+0x14]
        jl .get_function_address_loop

    .get_function_address_fail:
        pop edi
        pop esi
        pop ebx

        xor eax,eax
        ret

    .get_function_address_end:
        mov ebx,[ebp-8]
        mov ecx,[ebx+0x1c]

        add ecx,[ebp-4] ; ecx now points to the function addresses array

        mov edx,[ebx+0x24]
        add edx,[ebp-4] ; edx now points to the ordinals array

        movzx eax,word [edx+eax*2] ; eax now holds the ordinal
        mov eax,[ecx+eax*4] ; eax now holds the RVA of the function

        add eax,[ebp-4] ; eax now holds the address of the function

        ; Restore registers

        pop edi
        pop esi
        pop ebx

        ret

start:

xor ecx,ecx
mov eax,[fs:ecx+0x30] ; eax now points to the PEB

mov eax,[eax+0xc] ; eax now points to loader data
mov eax,[eax+0x14]

mov eax,[eax+ecx]
mov eax,[eax+0x10] ; eax now holds the address of ntdll.dll

mov [ebp-4],eax ; Save the address of ntdll.dll

add eax,[eax+0x3c] ; eax now points to the PE header
mov eax,[eax+0x78] ; eax now points to the export directory
add eax,[ebp-4] ; eax now points to the export table

mov [ebp-8],eax
xor ecx,ecx

mov cl,NtShutdownSystem_len
mov edx,ebx

add ebx,ecx ; Move to next string
call get_function_address

test eax,eax
je exit

mov esi,eax
xor ecx,ecx

mov cl,RtlAdjustPrivilege_len
mov edx,ebx

call get_function_address

test eax,eax
je exit

mov edi,eax
xor eax,eax

; Enable SeShutdownPrivilege

lea ecx,[ebp-12]

push ecx
push eax ; CurrentThread = FALSE
push 1 ; Enable = TRUE
push 19 ; SeShutdownPrivilege

call edi ; Call RtlAdjustPrivilege
xor eax,eax

push eax ; ShutdownNoReboot
call esi ; Call NtShutdownSystem

exit:

pop edi
pop esi
pop ebx

mov esp,ebp
pop ebp
ret 
```

# jsp - Can a Tomcat web app programmatically change the jsp servlet's "development=true" parameter?

> ID：678469
> 
> 赞同：1
> 
> 时间：2009-03-24T17:41:29.567
> 
> 标签：jsp, tomcat

I am referring to the following parameter of Tomcat's `web.xml` file:

```
<servlet>
    <servlet-name>jsp</servlet-name>
    <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>
         . . . 
    <init-param>
        <param-name>development</param-name>
        <param-value>true</param-value>
    </init-param>
         . . . 
</servlet> 
```

Is there any way for a web application to **programmatically** toggle this value -- at least for itself if not for all web applications -- so this can be temporarily changed on a running web server without having to stop and restart Tomcat?

Failing this, is there a way to force a single JSP to recompile without having to wait the few non-deterministic minutes it may take otherwise? I know that if you change a JSP, it will eventually (within a few minutes) be compiled, but I'm looking for a way to say, "On the next access, recompile it."

NOTE: Solutions which require restarting the web application or which will result in a web app restart or a container restart won't help me. I already know how to do this (by hand) for times when I can restart Tomcat. What I am trying to do is to temporarily switch the "development" value from false to true on a Tomcat instance in production, where I cannot interrupt current sessions.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-09T16:37:22.163

的默认行为`JspServlet`是每次访问时检查源 JSP，如果它发生了变化，则重新编译。此设置在 99% 的情况下都能正常工作，包括开发和生产。在*非常*高的负载下，禁用它可能会加快速度，但我还没有看到这是必要的。

如果您看到*最终*重新编译 JSP 的行为，那么您必须已将 Tomcat 配置为这种行为。您是否启用了后台重新编译标志，如此[处](http://tomcat.apache.org/tomcat-5.5-doc/jasper-howto.html#Configuration)详述？此设置可能会隐式禁用自动按访问重新编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:11:43.907

As far as I know, if you modify a web app's web.xml, the container (tomcat) is restarted automatically. Also the parameter values in web.xml can only be read programatically.

If you want to your JSP recompiled right away, just request that JSP's URL, or change the default ModificationTestInterval for JSP to 0 seconds:

```
 <init-param>
            <param-name>modificationTestInterval</param-name>
            <param-value>0</param-value>
        </init-param>
        <init-param>
            <param-name>development</param-name>
            <param-value>true</param-value>
        </init-param> 
```

. Hope this helps.

# .net - What are good programming practices to prevent malware in standalone applications?

> ID：678471
> 
> 赞同：1
> 
> 时间：2009-03-24T17:42:10.063
> 
> 标签：.net, security, malware

Does anyone have any thoughts on how to prevent malware attacks on standalone applications. Let's say this is a program on a Windows machine connected to the internet, this is the most common scenario.

I'm also wondering what type of attacks are possible. I believe .NET will do some type of static check on the code before it runs it, using a type of checksum. This would detect a statically attached malicious code snippet. Can this be gotten around?

What about dynamically injected code. Separate program spaces prevent this to some degree. What about infecting data files? Is it safer to store data in a database and only use service calls no file operations?

What about memory usage techniques to increase security? I know it's not a standalone case, but, the problem with DNS server corruption had to do with a predictable use of, I think, IP addresses. Should memory usage be made more unpredictable?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T18:04:06.127

> I'm also wondering what type of attacks are possible.

What you can check for varies depending on your application. Here are some thoughts that may help you get started:

*   Assuming you have a image editor you will want to be sure that people don't exploit buffer overruns due to bugs in the image encoder/decoder libraries.

*   If you have a browser or a document viewer, you need to check every URL before allowing the user to browse to that URL -- you should disable javascript injection.

*   If you are dealing with sockets, see that you don't allow any arbitrary connections.

*   If you are reading/writing from system clipboard, double check the data and don't leave anything behind. Do proper cleanup.

*   Sign your own binaries and other distributables.

*   If your application deals with security:

*   use a good Crypto library

*   have a threat analysis
*   don't use static passwords

and many many more...

> What about dynamically injected code.

This is almost always because of some bugs in your code. Run your code through a static analysis tool and check for buffer overruns and friends.

> What about memory usage techniques to increase security?

In a multiuser scenario, your application is already sandboxed to run in each user's own process space. However, it doesn't make sense to sandbox different applications for a single user.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T18:28:12.900

最重要的是：不要以管理员身份运行，或要求您以管理员身份运行。使用 CAS 拒绝自己不需要的权限。那样的话，如果所有其他方法都失败了，而你完全拥有，你只是搞砸了自己，而不是你的整个 PC。

# java - 无法序列化/反序列化 ArrayList

> ID：678481
> 
> 赞同：5
> 
> 时间：2009-03-24T17:46:12.847
> 
> 标签：java, serialization

我正在尝试序列化和反序列化包含对象的数组列表：

```
HairBirt param = new HairBirt();
param.setName("name");
param.setValue(2.3f);

HairBirt param2 = new HairBirt();
param2.setName("name2");
param2.setValue(2.4f);

ArrayList<HairBirt> list = new ArrayList<HairBirt>();

list.add(param);

list.add(param2);

ByteArrayOutputStream bos = null;
try {
    bos = new ByteArrayOutputStream();
    ObjectOutputStream obj_out = new ObjectOutputStream(bos);
    obj_out.writeObject(list);
} catch (IOException e) {
    e.printStackTrace();
}

String encoded = bos.toString();
try {
    encoded = URLEncoder.encode(encoded, "UTF-8");
} catch (UnsupportedEncodingException e1) {
    e1.printStackTrace();
}
System.out.print("The serialized output is: " + encoded);   

//DECODE

ArrayList<HairBirt> paramDecoded;

String myParam = null;
try {
    myParam = URLDecoder.decode(encoded, "UTF-8");
} catch (UnsupportedEncodingException e1) {
    e1.printStackTrace();
}
System.out.println("Got parameters");
ByteArrayInputStream bis = new ByteArrayInputStream(myParam.getBytes());

try {
    ObjectInputStream obj_in = new ObjectInputStream(bis);

    paramDecoded = (ArrayList<HairBirt>) obj_in.readObject();
} catch (IOException e) {
    e.printStackTrace();
} catch (ClassNotFoundException e) {
    e.printStackTrace();
} 
```

HairList 对象也是一个可序列化的对象。

此代码执行返回以下错误：

> `java.io.InvalidClassException: java.util.ArrayList; local class incompatible: stream classdesc serialVersionUID = 8664875232659988799, local class serialVersionUID = 8683452581122892189`

排队`paramDecoded = (ArrayList<HairBirt>) obj_in.readObject();`

我不知道我做错了什么。你能给个小费吗？

更新：

**已解决：** 只需使用 HairBirt 的本机数组而不是 ArrayList 就可以了：

```
HairBirt[] list = new HairBirt[x]; 
```

代替

```
ArrayList<HairBirt> list = new ArrayList<HairBirt>(); 
```

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-24T17:52:36.637

不要使用`ByteArrayOutputStream.toString()`- 相反，使用`toByteArray()`和 base64 编码该二进制数据以将其转换为字符串而不会丢失信息。

我强烈怀疑这是主要问题 - 您在序列化后丢失了数据。您可能还应该关闭或至少刷新`ObjectOutputStream`. 我不知道在这种情况下这是否真的有任何作用，但这似乎是个好主意。

我不相信 Java 中直接有任何 base64 支持（无论如何，在公共类中），但是您可以使用各种 3rd 方库，例如[Apache Commons Codec library 中的那个](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T17:53:54.620

您是否尝试过通过在自定义类中声明自己的 serialVersionUID 来覆盖此行为？

您是否有特定原因执行通过字符串进行序列化的额外步骤？通常，您只需通过 ObjectOutputStream 反序列化。

# cross-platform - wxNotebook 关闭按钮？

> ID：678484
> 
> 赞同：6
> 
> 时间：2009-03-24T17:46:48.833
> 
> 标签：cross-platform, tabs, wxwidgets, wxnotebook

我正在使用 wxWidgets（C++ 版本）开发记事本应用程序，并且正在努力实现多文件支持。使用 wxNotebook 类，我似乎找不到任何关于向页面添加关闭按钮的文档，因此我可以轻松关闭单个文件。是否有使用类本身启用此功能的跨平台方法？如果没有，您建议我通过哪些方式将所述按钮添加到 wxNotebook 页面？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T00:02:45.710

你有两种选择；

1.  wxAuiNotebook 是 wxwidgets 发行版的一部分，所以你可以直接使用它。
2.  wxFlatNotebook 是一个很酷的替代品。你可以在[这里找到](http://sourceforge.net/project/showfiles.php?group_id=156698)

昨天我不得不在两者之间做出选择。在 Windows / VS2008 平台上，安装 wxFlatNotebook 非常困难，你必须构建它的 lib，这给了我一系列错误，所以我还是选择了 wxAuiNotebook，尽管 wxFlatNotebook 有一些非常好的视觉增强。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T18:33:20.673

如果你需要一个关闭按钮，那么你应该使用 wxFlatNotebook 或 wxAuiNotebook。wxFlatNotebook 可以在[wxForum找到](http://wxforum.shadonet.com)

# iphone - 如何在 iPhone 上获取 MCC 和 MNC

> ID：678485
> 
> 赞同：5
> 
> 时间：2009-03-24T17:47:36.570
> 
> 标签：iphone

根据主题 - 是否有 API 可以在 iPhone OS 2.1 或更高版本上获取 MCC/MNC？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2010-07-24T19:56:47.700

在 iOS4 中添加

```
CTTelephonyNetworkInfo *netInfo = [[CTTelephonyNetworkInfo alloc] init];
CTCarrier *carrier = [netInfo subscriberCellularProvider];
NSString *mcc = [carrier mobileCountryCode];
NSString *mnc = [carrier mobileNetworkCode]; 
```

[http://developer.apple.com/library/ios/#Documentation/NetworkingInternet/Reference/CTCarrier/Reference/Reference.html](http://developer.apple.com/library/ios/#Documentation/NetworkingInternet/Reference/CTCarrier/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T18:05:56.277

不，移动网络信息不能通过 API 获得。如果您正在寻找唯一的设备 ID，请查看 UIDevice 的 uniqueIdentifer 方法；如果您正在寻找设备所在的国家/地区，则需要定位服务；如果您想很好地指示用户的家庭区域，请查看 NSLocale；对于其他任何事情，只需询问用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T13:05:07.827

我认为您可以获取[iPhone 的电话号码](https://stackoverflow.com/questions/193182/programmatically-get-own-phone-number-in-iphone-os)并将其解析为国家代码。

# excel - How do I find start and end rows of merged cells in Excel with VBSCript?

> ID：678486
> 
> 赞同：5
> 
> 时间：2009-03-24T17:47:46.523
> 
> 标签：excel, vbscript, merge, range

From a VBS script I have to work with an Excel book with the format:

```
 |     A     |     B     |     C     |
----|-----------|-----------|-----------|
  1 |  Header1  |  Header2  |  Header3  |
----|-----------|-----------|-----------|
  2 |  FOLDER1  |           |           |
----|-----------|-----------|-----------|
  3 |   Item1   |    111    |    222    |
----|           |-----------|-----------|
  4 |           | Item1Info | Item1Data |
----|           |-----------|-----------|
 .. |           |    ...    |    ...    |
----|           |-----------|-----------|
 11 |           |    333    |    444    |
----|-----------|-----------|-----------|
 12 |   Item2   |    555    |    666    |
----|-----------|-----------|-----------|
 13 |  FOLDER2  |           |           |
----|-----------|-----------|-----------|
 14 |   Item1   |    777    |    888    |
----|-----------|-----------|-----------|
 .. |    ...    |    ...    |    ...    | 
```

So: Column A has 1st level and 2nd level categories (Folders/Items), and Columns B and C hold the data for the items. The trouble here is that one item can span several rows, as shown; Item1 is a merged cell from rows 3 to 11).

I need to create a .csv from this data that looks as follows:

```
Header1,Header2,Header3
111,Item1,FOLDER1
Item1Info,Item1,FOLDER1
...
555,Item2,FOLDER1
777,Item1,FOLDER2
... 
```

The data in Column C can be discarded.

Basically, what I need to know is how to detect if a cell is merged (that is; more than one row of information per item) **and** how many rows are merged together. Any idea?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T19:00:31.967

您可以使用：

```
if (Cell.MergeCells) Then ... 
```

确定单元格是否是合并范围的一部分，以及

```
Cell.MergeArea.Cells(1,1).value 
```

访问包含在该合并范围中的值。

这是一些示例代码，可帮助您入门。我省略了实际编写 CSV 文件的细节：

```
Public Sub MakeCSV()
    Dim rowIndex As Integer
    Dim itemColumn As Range
    Dim dataColumn As Range
    Dim itemCell As Range
    Dim FolderName As String
    Dim ItemName As String
    Dim CSVLine As String

    Set itemColumn = Range("A2:A100")
    Set dataColumn = Range("B2:B100")

    For rowIndex = 1 To dataColumn.Rows.Count
        If dataColumn.Cells(rowIndex, 1).value = "" Then
            Rem // determine the current folder name
            FolderName = itemColumn.Cells(rowIndex, 1).value
        Else
            Rem // determine the item name (accounting for merged cells)
            Set itemCell = itemColumn.Cells(rowIndex, 1)
            If itemCell.MergeCells Then
                ItemName = itemCell.MergeArea.Cells(1, 1).value
            Else
                ItemName = itemCell.value
            End If

            Rem // write a line to the CSV file
            CSVLine = dataColumn.Cells(rowIndex, 1).value
            CSVLine = CSVLine & "," & ItemName
            CSVLine = CSVLine & "," & FolderName
        End If
    Next rowIndex
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T07:40:09.580

感谢您的回复。eJames 我想你已经回答了我想知道的一切，如何检测合并的单元格以及 FolderName / ItemName 分配。再次感谢。

我可以毫无问题地编写 CSV，经过仔细检查，我注意到 FOLDERn 单元格也合并了列（AC），所以我可能也可以检查 Mister Lucky 代码：

```
mergedColumns = cellRange.MergeArea.Columns.Count 
```

如果 mergeColumns > 1 那么它是一个文件夹名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:29:38.743

要测试合并的单元格是否覆盖多于一行：

```
cellRange = ExcelApplication.Cells(rowIndex, columnIndex)    
mergedColumns = cellRange.MergeArea.Rows.Count
if mergedColumns > 1 then ' merged 
```

# excel - 在 Excel 中启用 WrapText 时，运行 ClearContents 的性能非常慢

> ID：678493
> 
> 赞同：2
> 
> 时间：2009-03-24T17:50:07.047
> 
> 标签：excel, vba, excel-2007

我在 Excel 2007 VBA 中调试以下代码，这看起来很简单。由于某种原因，处理 900 行数据大约需要 30 分钟。我想我已经把它缩小到一些单元格格式，特别是 WrapText 选项。我在这里缺少什么可以在删除这些行时提高性能。

```
Sub ClearContentsOfActive()

    Application.EnableEvents = False
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual

    Dim NumLines
    NumLines = ActiveSheet.UsedRange.Rows.Count

    Range("2:" & NumLines + 3).Select
    Selection.ClearContents
    Selection.Delete Shift:=xlUp

    Application.EnableEvents = True
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic

End Sub 
```

此外，使用相同的代码，用户在 Excel 2003 中没有遇到这些延迟。提前致谢

## 更新

为了响应 ClearContents 行的冗余，这是在 Excel 2003 中工作的原始代码，这就是我离开它的原因。评论这条线是我尝试的第一件事，因为我同意它可能是多余的。有关我的伪性能指标，请参见下文。

**测试1**

```
Selection.ClearContents  ''//  Takes ~30 mins
Selection.Delete Shift:=xlUp  ''// then this takes <1min 
```

**测试2**

```
'Selection.ClearContents  '// If this line is commented
Selection.Delete Shift:=xlUp  ''// then this line takes ~30 mins 
```

我认为它与 WrapText 功能有关的原因是，当您清除它执行的 WrapText 行和行上的 AutoFit 操作时。我认为隐藏屏幕更新或禁用事件会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T18:14:45.367

在调用.Delete之前真的有必要调用.ClearContents吗？在我看来，对 .ClearContents 的调用是多余的。您正在清空一系列单元格中的值，您只需在下一行中将其从存在中删除。

我不知道这是否有助于解决性能问题，但值得一试。

**编辑：**响应您的更新，如何避免选择，只需执行以下操作：

```
Range("2:" & NumLines + 3).Delete shift:=xlUp 
```

您还可以尝试提前摆脱文本换行：

```
Range("2:" & NumLines + 3).WrapText = False
Range("2:" & NumLines + 3).Delete shift:=xlUp 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T21:15:02.860

所以它似乎与单元格的 ColorIndex 属性有关，而不是 WrapText 功能。该页面的宏具有以下代码

```
For r = 0 to 1000
  For c = 0 to 15
    Sheets.Cells(r, c).ColorIndex = 14
  Next c
Next r 
```

我建议用户使用 ConditionalFormatting，将宏全部丢弃，从而解决了他的性能问题。

ConditionalFormatting 基于整个工作表上的公式，如果以下评估为真，则该公式变为黄色

```
=IF(ROW()>10, FALSE, LEN($A1)>0) 
```

# sorting - VB6 - How to do a multi level sort with MSFlexGrid?

> ID：678495
> 
> 赞同：1
> 
> 时间：2009-03-24T17:50:36.080
> 
> 标签：sorting, gridview, vb6, msflexgrid

I currently have a VB6 program that essential reads data from an excel worksheet and spits it out into a MSFlexGrid.

Below is the excel sheet data that is read in. Data is filled into the occurence column for the **left half** of the table.

[![](https://i.stack.imgur.com/tDJBi.png)](https://i.stack.imgur.com/tDJBi.png)
[(source: [dipzo.com](http://www.dipzo.com/initial.PNG))]

The VB6 Application then read this data into a multi dimensional array which is then fed into a MSFlexGrid object. Here is the code to do that:

```
Private Sub GridSort(temp() As String)
fgData.Rows = UBound(temp)
x = 0
 Do While x < fgData.Rows
    fgData.Row = x
    fgData.Col = 0
    fgData.Text = temp(x, 0)
    fgData.Col = 1
    fgData.Text = temp(x, 1)
    x = x + 1
  Loop
  fgData.ColSel = 1
  fgData.Sort = flexSortGenericDescending
  x = 0
  Do While x < fgData.Rows
    fgData.Row = x
    fgData.Col = 0
    temp(x, 0) = fgData.Text
    fgData.Col = 1
    temp(x, 1) = fgData.Text
    x = x + 1
  Loop

End Sub 
```

Now this works to a degree. It sorts the Data by occurences and outputs as so:

[![](https://i.stack.imgur.com/vqiED.png)](https://i.stack.imgur.com/vqiED.png)
[(source: [dipzo.com](http://www.dipzo.com/end.PNG))]

However, you can see that it messed up the order of the first column. I want the data to be sorted by occurences first, but for data with the same amount of occurences, I want them sorted by operation. Does anybody know a way to accomplish this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T19:18:01.253

MSFlexGrid 通过从左到右对列进行排序，并且始终以相同的顺序（降序/升序）对多列中的数据进行排序。因此，您可以交换“发生”和“操作”列来实现您的目标。

否则，我在[这里](http://www.xtremevbtalk.com/t35110.html)找到了一个很好的 MSFlexGrid 函数集合，还有一个用于多列排序的条目。查找条目“对多列进行排序”。没测试过，不过你可以试试。

# django - 在 django 中为不同类型的用户提供不同配置文件的最佳方式是什么？

> ID：678496
> 
> 赞同：6
> 
> 时间：2009-03-24T17:50:39.340
> 
> 标签：django, django-profiles

在我的申请中，我有学生、教授和工作人员。工作人员不需要个人资料，但教授和学生都需要不同的个人资料。我宁愿不自己实现它（中间件和诸如此类的东西），所以无论如何只有 get_profile() 根据用户的角色返回不同的配置文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T18:23:27.093

使用目前处于测试阶段的 Django 1.1，我将实现一个[代理模型](http://docs.djangoproject.com/en/dev/topics/db/models/#proxy-models)。

```
class MyUser(User):

  class Meta:
    proxy = True

  def get_profile(self):
    if self.role == 'professor':
      return ProfessorProfile._default_manager.get(user_id__exakt=self.id)
    elif self.role == 'student':
      return StudentProfile._default_manager.get(user_id__exakt=self.id)
    else:
      # staff
      return None 
```

get_profile 需要原始的缓存代码等等。但基本上你可以做类似的事情。

使用 Django 1.0.x，您可以实现基于 User 的派生类，但这可能会破坏其他地方的代码。对于这样的东西，我喜欢代理类，它只是添加 python 功能而不更改数据库模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:13:53.513

你有 rad [http://docs.djangoproject.com/en/dev/topics/auth/#auth-profiles](http://docs.djangoproject.com/en/dev/topics/auth/#auth-profiles)吗？

这就是标准解决方案。

# silverlight - Silverlight 3.0“推送”能力信息

> ID：678504
> 
> 赞同：1
> 
> 时间：2009-03-24T17:53:21.783
> 
> 标签：silverlight, silverlight-3.0, push, xmpp

有没有人有一个很好的参考点，或者可以提供在 Silverlight 3.0 中更改/添加的增强“推送”实现的摘要？

我想将此区域与 Silverlight 2.0 和 XMPP/Jabber 进行比较。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T12:16:54.983

您可以通过两种主要方式在 Silverlight 3 中获得推送功能。第一种是您在 MIX 上看到的使用双工通道的方式。SL3 中的双工通道与 SL2 中的双工通道基本没有变化……主要区别在于现在您可以在 Visual Studio 2008 中添加对双工通道服务的引用，并且构建双工通道客户端/服务器对的整个操作是容易得多。

您可以获得推送的另一种方法是使用“彗星服务器”。基本上这个系列中的所有服务器都允许客户端打开一个套接字，然后不断地吸出那个套接字，从而允许数据从服务器推送到套接字中。这就是 Google 和大约 300 亿个其他 Ajax 站点/框架处理向客户端推送的方式。一些流行的彗星/推送服务器包括 Kaazing 和 Lightstreamer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:08:03.557

你看过[Mix'09](http://sessions.visitmix.com)的演讲吗？[这一点](http://sessions.visitmix.com/MIX09/T42F)尤其可能是相关的。

# iphone - 让视图临时扩展以填满 iPhone 屏幕的最佳方式

> ID：678511
> 
> 赞同：1
> 
> 时间：2009-03-24T17:54:51.513
> 
> 标签：iphone, uiview

我有一个库，它以编程方式构造一个 UIView 来展示我的自定义行为。这个库可以放入视图层次结构中不同位置的许多不同应用程序中。在某些情况下，视图需要“扩展”以填充屏幕空间。我目前正在这样做，让我的代码遍历视图层次结构，直到找到没有父视图的视图，构造一个新视图并将其作为找到的视图的子视图插入，然后在两者之间执行动画转换。退出该新视图只是隐藏它的问题，它会恢复以前的状态。

我有两个问题。

1.  有一个更好的方法吗？（特别是，我不太喜欢像那样遍历视图层次结构。）
2.  这种方法会发生什么坏事？例如，可能出错的一件事是，之前显示的视图不知道这已经发生，因此可能会出现异常行为。（这可以通过为这种行为发明一个委托协议或使用我目前不知道的现有协议来解决。）

显然，这里的目标是要求包含的应用程序/视图/控制器尽可能少地做，而不是创建一个矩形并构造我的视图的控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T18:00:05.277

为什么不直接调用 presentModalViewController？默认情况下，它从底部动画到屏幕上，但您可以通过将 NO 作为动画选项传递，然后控制您自己的动画选项来防止这种情况。

这是视图/控制器/应用程序暂时将 UI 控制权交给另一个模块的设计方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T18:21:20.233

安德鲁，我认为他没有这样做，因为他不想要上滑动画。

顶层视图是一个 UIWindow；您可以通过调用获取关键（当前）窗口`[UIApplication sharedApplication].keyWindow`。（几乎所有应用程序都只有一个窗口。）除此之外，在视图层次结构中向上走是完全合法的。

**编辑**：我刚刚注意到 UIView 有一个`window`属性可以让你直接进入视图的窗口，所以你根本不需要遍历层次结构。

至于发生的坏事，我真的想不出来，除非应用程序的其他部分决定添加或删除关键窗口的直接子视图。另一个可能的问题是，当您添加视图时，文本字段是否是第一响应者；键盘*可能会*停留在您的视野上方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-16T14:00:34.517

顽固，

我制作了一个 youtube 教程，展示了如何像在 facebook iPhone 应用程序中一样使视图扩大和缩小。

希望对您有所帮助：[How to make expand/shrinking views on iPhone SDK](http://www.youtube.com/watch?v=-dJJgUqCH0w&feature=PlayList&p=E97B882FB8C8C0D6&index=0&playnext=1)

亚当

# jquery - Hijacking Form Submission on ASP.NET MVC with jQuery (or other)

> ID：678518
> 
> 赞同：1
> 
> 时间：2009-03-24T17:56:40.840
> 
> 标签：jquery, asp.net-mvc, validation

I'm using ASP.NET MVC (v1.0) on an app and want to integrate simple client-side form validation. IE: Numeric-Only fields, required fields, etc.

Is there good, and potentially eye-candy fancy, method of validating in jQuery on the client that will cancel form submission on failed validation?

I've perused and experimented with quite a few of the jQuery form plugins available on the jQuery site already. But I've not found one yet that hijacks the form submission; MVC always routes to my controller action without validating.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:06:16.137

I can report that I use the [validation](http://bassistance.de/jquery-plugins/jquery-plugin-validation/) plugin and it works as advertised. Have you checked that you're not having javascript errors that are causing no javascript to run and thus not preventing the default submission mechanism to go through? I ran into this problem with AJAX form submissions when I was missing one of the AJAX javascript libraries.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T04:55:18.820

建议你看看[xVal](http://xval.codeplex.com/)，一个 asp.net mvc 的验证框架。它使用 jQuery 验证插件，集成到服务器端验证等等......

**[xVal](http://xval.codeplex.com/)**

*去引用*

> xVal 是 ASP.NET MVC 应用程序的验证框架。它使您可以轻松地将您选择的服务器端验证机制与您选择的客户端验证库链接起来，巧妙地适应 ASP.NET MVC 体系结构和约定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T11:05:24.980

看看[这篇博客文章](https://devermind.wordpress.com/2009/06/21/asp-net-mvc-tip-3-how-to-cover-all-your-client-side-form-validation-needs-without-writing-any-javascript-part1/#comments)。它描述了如何使用 xVal 自动生成客户端验证规则，以及如何自动实现远程客户端验证。

# php - What payment processing frameworks, like ActiveMerchant, are available for other languages?

> ID：678525
> 
> 赞同：7
> 
> 时间：2009-03-24T17:59:00.397
> 
> 标签：php, python, ruby-on-rails, programming-languages, activemerchant

Rails has frameworks such as [ActiveMerchant](http://www.activemerchant.org/) and [Freemium](http://github.com/cainlevy/freemium/tree/master) (which uses ActiveMerchant) to simplify dealing with payment processing. What other frameworks are there for other programming languages such as PHP or Python?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:04:01.337

**Edit** For processing payments, there are several GetPaid modules available for Python. Check out the [core package](http://pypi.python.org/pypi/getpaid.core/0.7.3), as well as [some extensions for different payment methods](http://pypi.python.org/pypi?%3Aaction=search&term=getpaid&submit=search).

*----------original answer------------*

From a [StackOverflow search](https://stackoverflow.com/questions/76420/best-php-ruby-python-e-commerce-solution): [Satchmo](http://www.satchmoproject.com/) is a Python alternative.

See that question link above for other ideas.

# c# - 使用 WPF 捕获视频的第一帧

> ID：678540
> 
> 赞同：2
> 
> 时间：2009-03-24T18:03:26.330
> 
> 标签：c#, asp.net, wpf

我需要捕获上传到 asp.net 网站的视频的第一帧。我真的很想用 WPF 做到这一点（如果可能的话），但如果有人知道更简单的方法，我也愿意。

我已经在 WPF 中看到了使用 MediaPlayer 和 RenderTargetBitmap 的示例，但每个示例都假定视频可以通过 URI 访问。在我的场景中，我只有文件字节，我不想将视频直接存储在 FS 上。

[http://blogs.msdn.com/delay/archive/2008/09/03/video-frame-grabbing-made-easy-how-to-quickly-capture-multiple-video-frames-with-wpf.aspx](http://blogs.msdn.com/delay/archive/2008/09/03/video-frame-grabbing-made-easy-how-to-quickly-capture-multiple-video-frames-with-wpf.aspx)

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T18:23:52.630

我根本不知道这是可取的，因为它很可能需要您运行某种消息泵，这在 ASP.NET 站点中是一个非常糟糕的主意。

相反，我会使用 DirectShow API 来尝试处理视频。您*应该*能够使用它将内容作为字节流式传输，并且您不需要消息循环来处理视频。

您可以使用位于此处的 DirectShow .NET 包装器通过 .NET 访问它：

[http://directshownet.sourceforge.net/](http://directshownet.sourceforge.net/)

您将需要查看 MSDN 上的 Sample Grabber 示例：

[http://msdn.microsoft.com/en-us/library/ms787867(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms787867(VS.85).aspx)

请注意，您可能不一定想要第一帧，就像许多视频一样，它们可能是黑色的，并不是真正适合缩略图的候选者。相反，您可能想要做 Vista 所做的事情并寻找第一个非黑色帧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:15:53.747

我最终使用[FFMpeg.exe](http://ffmpeg.org)（[从此处下载](http://ffdshow.faireal.net/mirror/ffmpeg)）来捕获上传到我网站的第一帧视频。这可能不是最理想的解决方案，但我没有任何 DirectShow 经验，而且在我看来，这个解决方案比提到的其他建议要简单得多。

我无法将文件保存到文件系统，所以我只是将上传的字节写到磁盘上的一个临时文件中，使用 FFMpeg 执行工作，然后删除在此过程中生成的每个文件。

对此的处理是在与请求线程不同的线程上完成的。如果我发现这是一个问题，我有一个单独的 Windows 服务，我可以毫无问题地将工作卸载到该服务上。

获取单帧的语法如下：

```
FFMpeg.exe -i "c:\MyPath\MyVideo" -vframes 1 "c:\MyOutputPath\MyImage%d.jpg" 
```

%d 非常重要。如果你不包括这个，FFMpeg 会抛出一个错误。写出文件时，%d 将替换为序列号。

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T21:10:42.807

[http://directshownet.sourceforge.net/](http://directshownet.sourceforge.net/)

使用 MediaDet 示例或此示例 - [http://wpfmediakit.codeplex.com/SourceControl/changeset/view/17356#245585](http://wpfmediakit.codeplex.com/SourceControl/changeset/view/17356#245585)

-杰尔

# vb6 - 免费的 VB 6.0 反编译器？

> ID：678544
> 
> 赞同：3
> 
> 时间：2009-03-24T18:04:18.183
> 
> 标签：vb6, decompiling

有没有 VB 6.0 反编译器之类的东西？

如果是这样，是否有任何免费产品可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:05:55.497

您可以在[Program Transformation](http://www.program-transformation.org/) wiki的[Visual Basic Decompilers 页面](http://www.program-transformation.org/Transform/VisualBasicDecompilers)上试试运气。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-22T17:31:24.867

**VB ReFormer**和**VB 反编译**器。它们非常易于使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T18:06:30.207

VB6 编译成机器码，所以你能做的就是反汇编它。

[http://en.wikipedia.org/wiki/Disassembler](http://en.wikipedia.org/wiki/Disassembler)

有一些工具声称可以解析和翻译机器代码，但我从未尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-14T13:26:29.650

Vb 6 编译为本机 EXE 文件，而不是 P 代码。因此，您将破解 ASM。

# javascript - yui 或 yui3

> ID：678546
> 
> 赞同：11
> 
> 时间：2009-03-24T18:05:11.037
> 
> 标签：javascript, ajax, yui, yui3

YUI3准备好成熟了吗？它与 YUI 的优缺点是什么

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-24T19:03:09.930

安迪，

Corwin 关于 yui.yahooapis.com 服务器上的文件更改是不正确的——如果您使用我们服务器上的 YUI 3 PR 2 版本，即使后续版本发布，这些文件也会保留在那里。

确实，随着我们向 beta 1（计划于 6 月发布）和 GA 移动，API 会发生一些变化。毫无疑问，我们会在您升级时做出需要您注意和时间的更改。这——以及 YUI 3 不包含 YUI 2.7.0（2.x 代码行中的当前版本）的所有功能这一事实——是现在推迟的主要原因。

您可以在此处了解有关 YUI 3 以及它与 2.7.0 有何不同的更多信息：

[http://video.yahoo.com/watch/3711767/10207432](http://video.yahoo.com/watch/3711767/10207432)

我们正在雅虎主页的下一个版本中使用 YUI 3。你可以在这里阅读：

[http://yuiblog.com/blog/2008/11/11/frontpage-and-yui3/](http://yuiblog.com/blog/2008/11/11/frontpage-and-yui3/)

问候， 埃里克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T00:45:22.443

自 PR2 发布以来，我一直在专门使用 YUI3。从那以后发生了很多变化，但我的特定应用程序代码不必更改太多。在过去的几个月里，我也一直在跟踪 YUI3 的所有主要变化。

现在是 6 月，事情似乎接近 beta 1，因为我看到了大量与文档相关的提交。如果你正在寻找非常好的、功能丰富的基础 JavaScript 库，我会推荐使用 YUI3 over 2。如果你需要一堆通用的小部件，可以同时运行 YUI2 和 YUI3，虽然事情会很复杂，而且你的代码会使用混合 API；但你可能想坚持使用 YUI2。

YUI3 正在成为一个非常棒的库和框架，自 PR2 以来，它在功能、性能和内聚性方面都非常成熟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T18:19:51.533

YUI3 仍在不断变化中。如果您直接链接到 yahoo 服务器上的 YUI3 文件，代码库将不断变化，您现在依赖的功能或语法可能会突然发生变化。YUI2 功能强大，如果您不想重写代码以适应不可预见的变化，这将是更安全的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-25T13:41:41.870

我会选择YUI3。

不过，您可能会发现一些尚未移植到 YUI3 的功能（例如，几个月前我需要自动完成功能，而此时，YUI3 AC 仍处于测试阶段），在这种情况下，您可以试试这个: [https://github.com/yui/2in3](https://github.com/yui/2in3)它可以帮助您在使用 YUI3 时导入 YUI2 依赖项。

# c# - .NET 的 HttpWebResponse 是否会自动解压缩 GZiped 和 Deflated 响应？

> ID：678547
> 
> 赞同：50
> 
> 时间：2009-03-24T18:05:55.420
> 
> 标签：c#, .net, httpwebrequest, gzip, deflate

我正在尝试做一个接受压缩响应的请求

```
var request = (HttpWebRequest)HttpWebRequest.Create(requestUri);
request.Headers.Add(HttpRequestHeader.AcceptEncoding, "gzip,deflate"); 
```

我想知道当我添加第二行时，我是否必须手动处理减压。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-03-24T18:35:55.877

我找到了答案。

您可以将代码更改为：

```
var request = (HttpWebRequest)HttpWebRequest.Create(requestUri);
request.AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate; 
```

而且你会自动解压。无需更改其余代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-06-12T21:07:10.403

对于 .NET Core 来说，事情要复杂一些。A`GZipStream`是必需的，因为没有属性（截至撰写时）`AutomaticCompression` 考虑以下`GET`示例：

```
var req = WebRequest.CreateHttp(uri);

/*
 * Headers
 */
req.Headers[HttpRequestHeader.AcceptEncoding] = "gzip, deflate";

/*
 * Execute
 */
try
{
    using (var resp = await req.GetResponseAsync())
    {
        using (var str = resp.GetResponseStream())
        using (var gsr = new GZipStream(str, CompressionMode.Decompress))
        using (var sr = new StreamReader(gsr))

        {
            string s = await sr.ReadToEndAsync();  
        }
    }
}
catch (WebException ex)
{
    using (HttpWebResponse response = (HttpWebResponse)ex.Response)
    {
        using (StreamReader sr = new StreamReader(response.GetResponseStream()))
        {
            string respStr = sr.ReadToEnd();
            int statusCode = (int)response.StatusCode;

            string errorMsh = $"Request ({url}) failed ({statusCode}) on, with error: {respStr}";
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-24T18:11:22.677

GZIP 和 Deflate 响应不会自动处理。有关详细信息，请参阅本文：[HttpWebRequest 和 GZip Http 响应](http://www.west-wind.com/WebLog/posts/102969.aspx)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-24T18:10:37.157

我认为您必须自己解压缩流。这是一篇关于如何做到这一点的文章：

> [http://www.west-wind.com/WebLog/posts/102969.aspx](http://www.west-wind.com/WebLog/posts/102969.aspx)

# schema - Biztalk映射问题，请想法

> ID：678552
> 
> 赞同：0
> 
> 时间：2009-03-24T18:06:38.943
> 
> 标签：schema, mapping, biztalk

我正在研究一个中等复杂的平面文件模式，我遇到了一个曲线球。这是输入的样子：

BCT121,C,7.35,6.5,0.39,7216,"SMITH, TRACEY",13456321,CLASS DRESSMAKING SHOPPE,CLASS DRESSMAKING SHOPPE,VAN,BC,20090109,20090112,20090127,V,0.46, BCT121,C,14.7,13.01, 0.78,7216,"SMITH, TRACEY",13456321,CLASS DRESSMAKING SHOPPE,CLASS DRESSMAKING SHOPPE,VAN,BC,20090110,20090112,20090127,V,0.91,BCT121,C,60.27,53.34,3.2,5812,"SMITH, TRACEY ",13456321,ME-N-ED'S PIZZA PARLORS,ME-N-ED'S PIZZA PARLORS,VAN,BC,20090110,20090112,20090127,V,3.73, BCT121,C,201.56,179.96,0,5200,”SMITH, TRACEY ",13456321,家得宝#7145,家得宝#7145,VAN,BC,20090110,20090112,20090127,V,21.6,REF.#^1^

好的，所以客户端想要的输出如下：

每个人/卡号有 1 个名为 PRQT 的标题行，上面的每个交易都有一个行。所以对于 Tracy，我们将有 1 个 PRQT 行和 4 个 PRLN 行，它们是交易详细信息。所以它看起来像一些东西像：

PRQT、SMIT6321、13456321、详情、详情等

PRLN、SMIT6321、7.35、6.5等

PRLN、SMIT6321、14.7、13.01等

PRLN 等

PRLN 等

好的，所以我的主要问题是如何只为标题插入一个 prqt 记录？我正在查看逻辑 functoids 以查看是否有一个可以查找以查看是否已为输出模式创建了现有值。我的主键是 SMIT6321（姓氏 + 卡号的最后四位数字）。因此，基本上，如果我在 C# 中对此进行编码，我将创建一个先前插入的 PRQT 键的数组，并且在我的循环期间，当我遇到时我会对此进行查找以查看我是否已经创建了一条记录。如果我已经创建了，我会跳过，所以我没有创建重复的 PRQT 记录。请注意，记录是在源文档中按时间顺序创建的，因此上述记录可能会混乱，而不像上面的示例那样按顺序排列。

谁能指出我正确的方向？我应该使用什么仿函数？Biztalk Mapper 可以处理这种事情吗？我确定它可以...我只需要弄清楚。

谢谢，

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T02:49:10.747

埃里克，

我会考虑在自定义 XSLT 中制作地图。映射器（虽然它本身很强大）不会在不经过循环的情况下为您提供 100% 的您想要的东西。通过使用自定义 XSLT，您将能够对字段执行完整排序并正确导航文档以获得所需的输出。为了在未来处理此类问题，APress 出版了一本名为 BizTalk 2009 Pro Mapping 的新书，该书涉及您的此类问题。

-布莱恩

# c# - 文件是图像吗？

> ID：678556
> 
> 赞同：11
> 
> 时间：2009-03-24T18:08:03.557
> 
> 标签：c#, image

在 C# 中，判断特定文件是否为图像的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T18:12:24.437

大多数图片格式在图像的前几个字节中指定文件类型。您可以读取几个字节并查找正确的标头。

从技术上讲，文件扩展名不包含有关图像的任何重要数据。它只是帮助操作系统找出使用什么程序来打开它。（但是，检查 extn 可能是最简单的方法，而且通常是正确的。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-24T18:13:03.687

这未经测试，但它是这样的：

```
private string MimeType (string Filename)
{
    string mime = "[default]";
    string ext = GetExtension(Filename).ToLower();
    Microsoft.Win32.RegistryKey rk = Microsoft.Win32.Registry.ClassesRoot.OpenSubKey(ext);
    if (rk != null && rk.GetValue("Content Type") != null)
        mime = rk.GetValue("Content Type").ToString();
    return mime;
} 
```

（对不起，我已经有一段时间没有做注册表了）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-24T18:24:20.273

我们这样做的方式（我现在找不到确切的代码，因此以下内容未经测试）是尝试将图像加载为位图。如果失败，则不是图像

```
bool isImage;
try
{
  Bitmap.FromFile(filePath);
  isImage = true;
}
catch
{
  isImage = false;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-24T18:14:59.470

除了尝试加载和显示图像之外，我认为没有任何方法可以保证给定文件（或任何字节集）必然代表图像。

但是，如果您有一些神秘的字节，您可以随时检查某些字节签名以尝试推断它是否是格式良好的图像文件。您可以在 wikipedia 上查找文件标题，但这里有一些我在单元测试中用于验证第三方报告工具的输出的代码：

```
// Some signatures:

const string _pdfSignature = "%PDF-";
readonly byte[] _bmpSignature = new byte[2] { 0x42, 0x4D };
readonly byte[] _pngSignature = new byte[8] {0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A};
readonly byte[] _gifSignature = new byte[6] { 0x47, 0x49, 0x46, 0x38, 0x39, 0x61 }; 
```

对于 JPG：

```
Assert.That(_theBytes[0] == 0xFF && _theBytes[1] == 0xD8);    //Start of jpg file
Assert.That(_theBytes[_theBytes.Length - 2] == 0xFF && _theBytes[_theBytes.Length - 1] == 0xD9); //End of jpg file 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T18:12:40.707

大多数图像文件在文件的开头都有一个或两个魔术字节。解码器和图像查看器使用它来识别文件类型。没有一条规则可以帮助您。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T18:13:07.540

如果您需要验证该文件是否是有效的图像格式，那么您将不得不使用某种代码尝试并根据您期望的文件类型解析内容。为此，您将调用 Image 类的静态 FromFile 方法来尝试获取 Image 实例。

您可以检查前几个字节以查看特定图像格式的标记是否存在，但就像检查文件扩展名一样，它不能保证内容是有效的图像格式。

如果您不需要验证，检查文件扩展名或 mime 类型就可以了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T18:09:57.437

检查文件扩展名

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T18:43:55.407

诚然，我对此并没有做太多，但这不是简单地查找 mime 类型吗？

[http://www.iana.org/assignments/media-types/](http://www.iana.org/assignments/media-types/)

# queue - 在排队论中，处理时间和平均排队延迟之间有什么关系？

> ID：678565
> 
> 赞同：3
> 
> 时间：2009-03-24T18:11:19.680
> 
> 标签：queue

考虑一个系统，其中作业按 FIFO 顺序排队和处理。它们目前平均等待 N 秒才能被处理。如果作业平均需要 M 秒来处理，如果我们将处理时间减少到 M/2 秒，对 N 会有什么影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T18:22:47.720

您可能想阅读这两个关于排队论的链接。后者包含许多有用的公式，用于计算队列的平均长度和等待时间，并很好地解释了所涉及的因素。

[傻瓜排队论](http://www.embedded.com/story/OEG20010312S0101)（无意冒犯！）

[如何调整消息队列的大小](http://www.embedded.com/9901103?_requestid=647333)

# jboss - JBoss 4.0.5 MDB 配置

> ID：678582
> 
> 赞同：0
> 
> 时间：2009-03-24T18:17:02.147
> 
> 标签：jboss, jboss-mdb, jbossmq

这个在打我，我一直想不通……所以就这样吧。我想在我的应用程序中添加一个 Message Drive Bean，它被打包为一个 .ear 文件

按照文档，我创建了一个 jboss.xml 和一个 ejb-jar.xml，我试图将它们放在 META-INF 和根目录以及 WEB-INF 上，但我只是不认为它工作（即MDB 永远不会加载，也不会收到消息。

我的耳朵文件看起来像：

```
META-INF/
META-INF/MANIFEST.MF
META-INF/application.xml
myapp.war 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-04T21:01:43.407

我的最终解决方案是将 MDB 代码（和支持类）分离到耳内的单独文件（myapp-mdb.jar）中，并使用相同的休眠映射和类来支持它，休眠相关文件被打包在 myapp 上。哈尔。

```
META-INF\MANIFEST.MF
META-INF\application.xml
META-INF\jboss-app.xml
myapp-mdb.jar
myapp.har
myapp.war 
```

只是发布答案以供参考。

# c# - C#/Windows 窗体 - 如何确定某人当前是否在“拖动”？（不在 DragOver 事件中）

> ID：678583
> 
> 赞同：0
> 
> 时间：2009-03-24T18:17:13.863
> 
> 标签：c#, winforms

假设我在一个在 Windows Forms 类的 Timer 中调用的函数中......我如何判断用户当前是否正在尝试“拖动”某些东西？

例子：

```
public void SomeMethod()
{
    // This doesn't exist of course :)
    if (Mouse.IsDragging) ...
} 
```

编辑：我应该指定我知道我可以覆盖 DragEnter 和 DragLeave 来设置我自己的私有变量......但如果存在的话，我正在询问/寻找一个“.Nety”解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T19:08:07.673

简单的：

```
 bool mDragging;
...
            mDragging = true;
            DoDragDrop("test", DragDropEffects.All);
            mDragging = false; 
```

普遍的：

```
 public static bool IsDragging()
    {
        StackFrame[] frames = new StackTrace(false).GetFrames();
        foreach (StackFrame frame in frames)
        {
            System.Reflection.MethodBase mb = frame.GetMethod();
            if (mb.Module.Name == "System.Windows.Forms.dll" && mb.Name == "DoDragDrop")
                return true;
        }
        return false;
    } 
```

# javascript - 如何避免嵌套开关？

> ID：678593
> 
> 赞同：4
> 
> 时间：2009-03-24T18:22:49.590
> 
> 标签：javascript, nested, switch-statement

我正在为 Web 应用程序在 JavaScript 中创建上下文菜单。菜单可以出现在许多上下文中，并且有不同的选择。对于每个上下文/选择，我可以有不同的功能：

```
grid1_delete()
grid1_duplicate()
grid2_delete()
grid2_add()
grid2_duplicate() 
```

并在构建菜单时对其进行硬编码。我不喜欢的是可能会有很多重复的代码。所以我正在考虑使用调度程序函数，但它可能会导致可能很长的嵌套 switch 语句：

```
function contextMenuClick(context, menuItem) {
    var action = menuItem.innerHTML;
    switch (context) {
        case 'grid1':
            switch(action) {
                 case('delete'):
                      // do delete for grid1
                      break;
                 case('duplicate'):
                      // do duplicate for grid1
                      break;
                 default:
                      console.log('undefined action in contextMenuClick/grid1: ' + context);
            }
            break;
        case 'grid2':
            switch(action) {
                 case('add'):
                      // do add for grid2
                      break;
                 case('delete'):
                      // do delete for grid2
                      break;
                 case('duplicate'):
                      // do duplicate for grid2
                      break;
                 default:
                      console.log('undefined action in contextMenuClick/grid2: ' + context);
            }
            break;
        default:
            console.log('undefined context in contextMenuClick: ' + context);
        } 
```

呸。一定有更好的方法。也许调度员的麻烦多于它的价值。我查看了一些[相关](https://stackoverflow.com/questions/494506/dealing-with-nested-if-then-else-nested-switch-statements)[的](https://stackoverflow.com/questions/496189/what-is-the-best-easiest-way-to-use-nested-switch-case-statements) [帖子](http://www.codinghorror.com/blog/archives/000486.html)，但我不太了解如何将它们应用于这种确切的情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T19:18:45.463

Javascript 中很少需要 switch 语句。一般来说，您可以只使用字典/地图之类的对象并直接进行查找：`foo.bar`相当于`foo['bar']`.

此外，对于“全局”变量，`some_global_func()`等价于`window.some_global_func()`，也可以写成*：*`var f = 'some_global_func'; window[f]()`您不需要根据变量名称动态选择变量或调用函数。但是，一般而言，这样做时，您应该更喜欢将函数存储在对象中而不是全局范围（即对象中）。*`eval``window`*

 *因此，假设`grid1_delete`and`grid2_delete`根本不同并且不能组合成通用函数，您可以执行以下操作而无需过多更改代码：

```
var grid_actions = {
    'grid1': {
        'delete': function() { /* ... */ },
        'duplicate': function() { /* ... */ }
    },
    'grid2': {
        'delete': function() { /* ... */ },
        'add': function() { /* ... */ },
        'duplicate': function() { /* ... */ }
    }
}

function contextMenuClick(context, menuItem) {
    var action = menuItem.innerHtml;
    if (context in grid_actions) {
        if (action in grid_actions[context]) {
            grid_actions[context][action]();
        } else {
            console.log('undefined action in contextMenuClick/' + context + ': ' + action);
        }
    } else {
        console.log('undefined context in contextMenuClick: ' + context);
    }
} 
```

不过，更好的解决方案是重构事物，让这些函数成为每个上下文的对象方法，就像[@le dorfier](https://stackoverflow.com/users/31641/le-dorfier)建议的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T18:47:37.817

如何为“上下文”传递一个实际的对象引用而不仅仅是一个字符串？这样，您只有一个 switch 语句：

```
function contextMenuClick(grid, menuItem) {
    var action = menuItem.innerHTML;
    switch(action) {
       case('delete'):
          grid.delete();
          break;
       case('duplicate'):
          grid.duplicate();
          break;
    }
} 
```

更好的是，只需将处理程序直接绑定到正确的对象/方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T18:24:44.483

最简单的好简化是让每个开关都包含一个开关的功能。

如果每个上下文都有一个对象，则可以向每个接受菜单作为参数的对象添加一个函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T18:26:54.637

使用 eval(context + "_" + action + "();") 可能会起作用，但非常危险，因为它会允许您的客户端在您的脚本中执行几乎任意的函数。（任何与 X_Y 匹配的东西）。是的。eval 主要是邪恶的。

怎么样

```
switch(context+"_"+action) { 
    case ("grid1_add"):  grid1_add(); 
[...]
} 
```

# ruby-on-rails - 在 Rails 中，如何将多个模型与一个模型相关联？

> ID：678596
> 
> 赞同：2
> 
> 时间：2009-03-24T18:23:08.153
> 
> 标签：ruby-on-rails, database-design, model, associations

假设我有四个完全独立的模型（`Movie`、`Book`、`Game`、`Album`）来控制我在媒体收藏中拥有的事物的类型。有了它们，我可以对单个专辑、电影等进行 CRUD 和标记。

但我需要跟踪，并做一些共同的事情，所有这些。所以我想我需要一个`Item`模型来给我这样的表格`item`：

```
| 编号 | item_id | 项目类型 | 状态 | 占有|
+----+---------+------------+--------+------------+
| 01 | 01 | 1 | 3 | 2 |  

```

`status`和`possession`位可以让我跟踪该项目是新的还是用过的，是我的还是借给的（给谁，在另一张桌子上）等等，而桌子本身会让我知道我总共有多少物品。所有这些都没有触及原始的四个模型及其对象，我认为应该只知道它们是什么，而不是我可以对它们做什么。编辑：请注意，每次添加电影或书籍时，它还必须`items`使用其相关信息更新表。

我是一个新手，我对如何去做有一些想法，但没有一个被证明是成功的。我知道有很多问题要问，但我想知道，我怎样才能做到这一点？

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T18:29:43.943

最简单的方法是使用[多态关联](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T18:34:16.443

您在 ActiveRecord 中描述多态关联。查看这些网址：

*   [Railscasts - 多态关联](http://railscasts.com/episodes/154-polymorphic-association)
*   [Active Record 关联指南 - 多态关联](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T18:29:39.590

Rails 中的继承（在我看来）还有很多不足之处，因为它只允许单表继承。

我要做的是将您的每个模型（电影、书籍等）以一对一的关系与一个项目相关联。

```
class Book < ActiveRecord::Base
  belongs_to :item
end 
```

**编辑**：在查看了多态的东西（老实说，我忘记了 Rails 有的东西）之后，我认为这可能是你想要的更多。我的方式可行，但我认为另一种方式会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T19:45:29.970

对属性名称的快速评论...

“状态”是恕我直言可怕。也许是“采集类型”。

“项目类型”还不错，但“媒体类型”可能更合适。

这是关于实体命名约定的非常全面的“最新技术”指南，至少值得略读。[http://www.uscg.mil/directives/ci/5000-5999/CI_5230_42A.pdf](http://www.uscg.mil/directives/ci/5000-5999/CI_5230_42A.pdf)

# architecture - 您如何获得公司所有应用程序的列表？

> ID：678605
> 
> 赞同：2
> 
> 时间：2009-03-24T18:25:42.953
> 
> 标签：architecture, standards, lifecycle

（更新：我已将其移至[ServerFault](https://serverfault.com/questions/2378/how-would-you-get-a-list-of-all-the-applications-in-use-at-your-company)）

我负责维护我公司所有应用程序的列表（大约 250 个）。范围从跟踪 80k 员工的 HR 系统，到负责数亿美元收入的制造型系统，再到用户群较小且不会出现很大风险的 Web 应用程序。

这些技术主要分为 SAP、.Net 和 Java，但我们有几乎所有您能想象到的所有其他技术的遗留示例。

清单的重点是能够管理风险并识别改进机会。例如，当我们找到负责用 Clipper 编写的核心业务功能的系统时，我们会尝试找一些钱来重新编写它们。我们将景观中高风险应用程序的图片称为“热图”。

该列表非常简单——它实际上只需要名称、描述、ID、数据库平台、应用程序平台（例如，SAP、.Net、Weblogic 上的 Java、大型机等）、关键接口和关键服务。

任何人都有建立/维护这样的列表的经验吗？我应该记住什么？

干杯

K A

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T18:28:56.050

有疑问时使用excel。至少要开始。

当您开始组织它们时，您将看到使用哪些类型的组织工具来改进您的管理。但它很可能最终成为你所需要的一切。

理想情况下，您需要一些自动化的东西，以便您的“主列表”知道某个应用程序何时关闭。对于跨不同语言和平台的许多应用程序，这可能不可行。

# assembly - 解释 Dhamdhere 教科书中玩具 ISA 的装配列表

> ID：678607
> 
> 赞同：-1
> 
> 时间：2009-03-24T18:26:02.237
> 
> 标签：assembly, disassembly, mnemonics

考虑以下汇编器输出列表：

```
START 100
MOVER BREG, ONE                                101) + 04 2 105 
MOVEM BREG, RESULT                             102) + 05 2 106
PRINT RESULT                                   103) + 10 0 106
STOP                                           104) + 00 0 000
ONE DC '1'                                     105) + 00 0 001
RESULT DS 1                                    106) 
```

1.  代码前的+号是什么意思？
2.  为什么 `ONE`给定的地址`001`？
3.  为什么最后一条语句后面的条目`RESULT DS 1`留空？

此列表出现在 Dhamdhere的[Systems Programming and Operating Systems中（编者注：由回答者发现）。](http://books.google.com/books?id=Yx1sRW3BQzcC&pg=PA91&lpg=PA91&dq=%22mover+breg,+1%22&source=bl&ots=y9SRiqH6cZ&sig=BI05iB67cJK691flcvx1-V7VUFs&hl=en&ei=5U7JScfeI8TDtwfYv8ioAw&sa=X&oi=book_result&resnum=1&ct=result#PPA87,M1)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:35:25.410

我不知道您使用的是哪个汇编程序（在您的问题中提供该信息可能是明智的），因此这些不是特别明智的答案：

1.  不知道 - 你的汇编手册怎么说
2.  不是——这就是价值
3.  DS 只是保留一些空间

**编辑：**汇编程序是一种计算机程序，它采用包含汇编语言的文本并将其转换为机器代码。它还可以以人类可读的形式产生输出，这就是您发布的代码的样子。人类可读形式的格式特定于您正在使用的特定汇编器（即程序） - 它并不特定于汇编器为其发出机器代码的机器体系结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T21:36:23.027

这似乎使用了[系统程序和操作](http://books.google.com/books?id=Yx1sRW3BQzcC&pg=PA91&lpg=PA91&dq=%22mover+breg,+1%22&source=bl&ots=y9SRiqH6cZ&sig=BI05iB67cJK691flcvx1-V7VUFs&hl=en&ei=5U7JScfeI8TDtwfYv8ioAw&sa=X&oi=book_result&resnum=1&ct=result#PPA87,M1)第 4 章中的简单汇编语言。

在操作码输出的描述中，它说，“符号不是指令的一部分”。快速阅读文本并没有揭示它*是*什么的一部分，并且所有示例在该列中都有“+”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-01T07:24:02.597

1.  “+”号不是指令的一部分。（数字指令的那一面是机器指令）

2.  ONE 的地址是 105，001 是使用 DC 分配给 ONE 的值，DC 是声明常量的缩写形式。

    DC 保留内存字空间并分配常数。

3.  RESULT DS 1 的条目留空，因为 DS 保留给定要求的存储空间，这里只给出 1，因此它只保留一个存储字位置。

只有数字部分的另一面是机器指令，它遵循以下格式

```
Sign opcode register_opcode memory_operand 
```

例如，

```
101) memory location
+ Sign (not part of instruction)
04 Machine opcode ( occupy 2 digits )
2 Register operand ( occupy 1 digit )
105 Memory operand ( occupy 3 digits ) 
```

注意：它是用于假设计算机的简单汇编语言，用于说明汇编程序的功能和技术。

# cocoa - 为什么 -[NSTextStorage replaceCharactersInRange: withAttributedString:] 有时，有时不尊重其他字符集中的字体？

> ID：678620
> 
> 赞同：5
> 
> 时间：2009-03-24T18:29:16.907
> 
> 标签：cocoa, nsattributedstring

我正在尝试诊断 UKSyntaxColoredTextDocument 0.4 [http://www.zathras.de/angelweb/blog-uksctd-oh-four.htm](http://www.zathras.de/angelweb/blog-uksctd-oh-four.htm)中的问题，其中实际使用与您指定的字体不同的字体的文本会随着您消失类型。（您可以下载并试用这个很酷的实用程序来亲自查看这个问题......）

这是背景：这是一些在您键入时重新着色的语法着色代码。它工作得很好，但是如果您输入一些不属于该文本视图的字体集的字符（例如 Monaco、Helvetica）......例如，一个符号字符或日语中的某些东西，它实际上使用 ZapfDingbatsITC 之类的字体或HiraKakuProN-W3 显示它，然后在您键入时不会显示这些字符。

假设您有这样的文本：fdsafd[☀]sfds‡[☀☀☀][日本语]...

如果您将其粘贴到文本字段中，并从弹出窗口中切换语法着色，则会调用`oldRecolorRange:`，并使用以下行：

```
[[textView textStorage] replaceCharactersInRange: range withAttributedString: vString]; 
```

在这里，事情的表现和我预期的一样。ASCII 文本、符号和日文文本都是可见的。[textView textStorage] 的值开始和结束，是这样的：（ *这是 gdb 的输出；它没有显示 unicode 字符，不用担心。）*

```
df{
    NSFont = "LucidaGrande 20.00 pt. P [] (0x001a3380) fobj=0x001a4970, spc=6.33";
}?{
    NSFont = "ZapfDingbatsITC 20.00 pt. P [] (0x001ae720) fobj=0x001bb370, spc=5.56";
}fdsafd[{
    NSFont = "LucidaGrande 20.00 pt. P [] (0x001a3380) fobj=0x001a4970, spc=6.33";
}?{
    NSFont = "HiraKakuProN-W3 20.00 pt. P [] (0x001b59e0) fobj=0x001bb600, spc=6.66";
}]sfds[{
...

```

...即使将新值设置为

```
dffdsafd[?]sfds[???][???] Nihddfdfffdfdd{
    NSFont = "LucidaGrande 20.00 pt. P [] (0x001a3380) fobj=0x001a4970, spc=6.33";
}

```

换句话说，显示此字符串所需的“外来”字体以某种方式自动保留，即使在替换字符串中未指定字体。

但是，当您一次输入一个字符时，`replaceCharactersInRange:withAttributedString:`方法中的不同调用会`recolorRange:`导致属性字符串*仅*使用基本字体——没有为我们添加外来字符字体，因此主要字体的范围根本不可见！

```
dffdsafd[?]sfds[???][???] Nihddfdfffdfddx{
    NSFont = "LucidaGrande 20.00 pt. P [] (0x001a3380) fobj=0x001a4970, spc=6.33";
}

```

知道为什么这种方法在一种情况下会以一种方式工作而不是在另一种情况下吗？是否有某种开关可以传递给`NSTextStorage`/`NSAttributedString`提示我们希望文本显示外来字符？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T19:52:51.700

尝试 [[textView textStorage] fixFontAttributeInRange:range]; 在 recolorRange 中的 [[textView textStorage] replaceCharactersInRange: range withAttributedString: vString] 之后：

我认为问题在于再次编辑文本存储以响应 processEditing，这已经是编辑的结尾。-[NSTextStorage processEditing] 使用 fixFontAttributeInRange:，但由于您再次尝试编辑，出现问题并且修复行为被删除。

当您对整个文档执行此操作时，会有一个正常的 beginEditing/endEditing/processEditing 序列，这会导致 fixFontAttributeInRange: 被愉快地调用。

# c# - 使用 Microsoft Jet OLEDB 对 CSV 的列限制

> ID：678623
> 
> 赞同：4
> 
> 时间：2009-03-24T18:30:21.273
> 
> 标签：c#, .net, asp.net, csv, oledb

我正在从包含大约 350 列的 CSV 导入数据。这个 CSV 导入是固定的，我完全无法控制它。

如果我尝试在 Excel 2003 中打开 CSV，由于列限制为 255 (IV)，它只能部分加载。

当我使用 OleDb 和 Microsoft.Jet.OLEDB.4.0 将 CSV 加载到数据集中时，它也只显示 255 列。更糟糕的是，当尝试访问这 255 列中的某些列的数据时，它会显示不正确的数据，并且会不一致地拆分值。

如果我在 Excel 中打开 CSV，让它截断数据并重新保存，我的导入工作正常。

我的问题是，有没有其他人遇到过 Jet.OLEDB 提供程序的这种限制。如果是，是否有解决该问题的方法？如果没有，是否有可以加载如此大的 CSV 的替代解决方案？

注意：这不是一次性的任务，我需要为最终用户提供一个浏览/上传按钮，以便在他们需要时执行此导入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:47:15.850

我们已经成功地使用了[http://www.codeproject.com/KB/database/CsvReader.aspx](http://www.codeproject.com/KB/database/CsvReader.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-15T09:13:57.353

您可以浏览此代码，使用 [ExcelDataReader](https://exceldatareader.codeplex.com)并在您的项目中添加参考。并使用下面的代码...

```
FileStream stream = File.Open(strFileName, FileMode.Open, FileAccess.Read);
IExcelDataReader excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);
DataSet result = excelReader.AsDataSet();
excelReader.Close();
return result.Tables[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T20:43:26.337

我建议以面向对象的方式进行。尝试使用 File Helpers 库。[http://www.filehelpers.com/](http://www.filehelpers.com/)。它允许您为文件中的每一行提供一个对象表示。然后，您可以将此对象持久保存到数据库中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T10:24:37.803

将`schema.ini`文件放在与 CSV 文件相同的文件夹中。有关完整语法，请参见[此处](http://msdn.microsoft.com/en-us/library/ms709353%28VS.85%29.aspx)。

# templates - 我在哪里可以获得 MediaWiki 的模板？

> ID：678626
> 
> 赞同：21
> 
> 时间：2009-03-24T18:31:05.297
> 
> 标签：templates, mediawiki, mediawiki-templates

我注意到很多基于 mediawiki 的网站都使用 Robelbox、Ambox 等模板。我在哪里可以获得它们以及应该如何安装它们？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-25T20:23:05.730

这是一个[PITA](http://www.urbandictionary.com/define.php?term=pita)，不幸的是（与扩展或媒体文件不同）没有罐装模板的存储库。模板加载其他模板，这些模板依次加载其他模板，等等。

转到 Wikipedia 并复制您要查找的模板名称，转到 Special:Export 并将模板名称粘贴到大文本框中，例如 Template:Infobox。选中“包含模板”并选中“仅包含当前版本，而不是完整历史记录”，（否则文件会太大）。单击导出以转储模板的 .xml 文件。然后将其导入目标 wiki。

导入后打开模板进行编辑，检查编辑框下方的列表“页面嵌入到当前版本的页面：”。如果有任何红色链接，请为这些模板重复上述步骤。在一切正常之前，您可能还需要复制 MediaWiki:Common.css 页面中的样式和 MediaWiki:Common.js 中的 Javascript。最后编辑模板以自定义您的 wiki。

如果它仍然无法正常工作，并且大括号和 if 语句的页面杂乱无章，那么您需要安装[ParserFunctions](http://www.mediawiki.org/wiki/Extension:ParserFunctions)扩展。如果有`{{#invoke: }}`模板代码，您还需要安装[Scribunto 扩展](https://www.mediawiki.org/wiki/Extension:Scribunto)。

MediaWiki[帮助：模板](http://www.mediawiki.org/wiki/Help:Templates#Copying_from_one_wiki_to_another)更详细地解释了该过程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-06-25T21:01:07.607

您可以直接从维基百科复制模板。一个很好的例子是[Keypress](http://en.wikipedia.org/wiki/Template:Keypress)模板。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-09T09:19:28.537

此任务比仅导出和导入要复杂一些。

可以在此处找到“简单”概述 ->[如何将 Wikipedia 模板添加到您自己的 Mediawiki](http://www.ryadel.com/en/how-to-add-wikipedia-mbox-templates-to-your-own-mediawiki/)

> *   将我们的 MediaWiki 升级到最新的稳定版本，希望能与 Wikipedia 匹配。
>     
>     
> *   安装 Scribunto 扩展并正确配置它。
>     
>     
> *   导出/导入您想要使用的（元）模板使用的 LUA 模块，并将它们导入您的 MediaWiki。
>     
>     
> *   导出/导入您要使用的维基百科模板，连同所有必需的元模板，并将它们导入您的
>     MediaWiki。
>     
>     
> *   从 Wikipedia 的 Common.css 文件中复制相关的 CSS 类并将它们粘贴到您的 MediaWiki 的 Common.css 中。
>     
>     
> *   激活 MediaWiki IsantCommons 功能以自动从 commons.wikipedia.com 存储库中获取模板图像文件。

# c# - 字符串函数

> ID：678627
> 
> 赞同：0
> 
> 时间：2009-03-24T18:31:10.727
> 
> 标签：c#, string

我想在另一个字符串中搜索给定的字符串（例如，查找“something”是否存在于“something like this”中。我该如何执行以下操作？：

1.  知道“某物”所在的位置（在当前的例子中，这是 = 0。
2.  提取左侧或右侧的所有内容，直到字符。发现（见 1）。
3.  提取一个从找到的字符串开始的子字符串，一直到 X 数量的字符（在 Visual Basic 6/VBA 中，我将使用 Mid 函数）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T18:35:06.520

```
string searched = "something like this"; 
```

1.

```
int pos = searched.IndexOf("something"); 
```

2.

```
string start = searched.Substring(0, pos);
string endstring = searched.Substring(pos); 
```

3.

```
string mid = searched.Substring(pos, x); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T18:34:21.700

你看过 String.SubString() 方法吗？您可以先使用 IndexOf() 方法查看子字符串是否存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:10:57.150

我会避免使用拆分，因为它旨在为您提供多个结果。我会坚持使用第一个示例中的代码，尽管第二个块实际上应该读...

```
string start = searched.Substring(0, pos);
string endstring;

if(pos < searched.Length - 1)
endstring = searched.Substring(pos + "something".Length);
else
endstring = string.Empty 
```

关键区别在于要考虑要查找的字符串的长度（因此看起来相当奇怪的“某物”.Length，因为这个示例旨在让您能够插入自己的变量）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T18:34:51.137

看看[System.String](http://msdn.microsoft.com/en-us/library/system.string_members(VS.71).aspx)成员函数，特别是[IndexOf](http://msdn.microsoft.com/en-us/library/system.string.indexof(VS.71).aspx)方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T18:35:35.037

使用[`int String.IndexOf(String)`](http://msdn.microsoft.com/en-us/library/k8b1470s.aspx).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T18:44:16.763

我会做这样的事情：

```
string s = "I have something like this";

//question No. 1
int pos = s.IndexOf("something");  

//quiestion No. 2
string[] separator = {"something"};
string[] leftAndRightEntries = s.Split(separator, StringSplitOptions.None);  

//question No. 3

int x = pos + 10;
string substring = s.Substring(pos, x); 
```

# ruby-on-rails - 如何在 Rails 中的单独域上设置 cookie

> ID：678628
> 
> 赞同：6
> 
> 时间：2009-03-24T18:31:39.943
> 
> 标签：ruby-on-rails, cookies, cross-domain

如何在使用 javascript 调用调用我的站点的不同域上设置 cookie？它适用于FF3，但不适用于IE6。

我的服务器是从单独的站点和域上的 javascript 标记调用的。结果返回用数据填充其页面的javascript（它是一个小部件）。我正在尝试使用 domain=".mydomain.com" 和 path="/" 设置 cookie。它适用于 Firefox，但不适用于 IE。如果我从自己的域测试 javascript 调用，它在 IE 中工作正常。

有谁知道如何使用 Rails 让跨域 cookie 设置在 IE 中工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T18:34:15.773

只要您的服务器在其自己的域内或从其域的子域设置 cookie，这应该可以工作

```
cookies[cookie_name] = {
   :value => 'a value',
   :expires => 1.year.from_now,
   :domain => 'example.com'
 } 
```

它不适用于任何其他域。

要让它在 IE6 中工作，您可能需要一个有效的[P3P](http://www.w3.org/P3P/)策略标头

像这样作为标头发送的东西应该这样做：

```
headers["p3p"] = 'CP="CAO PSA OUR"' 
```

# java - 如何在 Android 上使用 cookie 发出 http 请求？

> ID：678630
> 
> 赞同：124
> 
> 时间：2009-03-24T18:31:56.120
> 
> 标签：java, android, http, url, cookies

我想在正确处理 cookie 的同时向远程服务器发出 http 请求（例如，存储服务器发送的 cookie，并在我发出后续请求时发送这些 cookie）。保留任何和所有 cookie 会很好，但实际上我唯一关心的是会话 cookie。

对于 java.net，似乎首选的方法是使用 java.net.CookieHandler（抽象基类）和 java.net.CookieManager（具体实现）。Android有java.net.CookieHandler，但是好像没有java.net.CookieManager。

我可以通过检查 http 标头来手动编码，但似乎必须有一种更简单的方法。

在保留 cookie 的同时在 Android 上发出 http 请求的正确方法是什么？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-03-26T20:28:16.373

[事实证明，Google Android 附带 Apache HttpClient 4.0，我能够使用HttpClient 文档](https://hc.apache.org/httpcomponents-client-ga/examples.html)中的“基于表单的登录”示例弄清楚如何做到这一点：

[https://github.com/apache/httpcomponents-client/blob/master/httpclient5/src/test/java/org/apache/hc/client5/http/examples/ClientFormLogin.java](https://github.com/apache/httpcomponents-client/blob/master/httpclient5/src/test/java/org/apache/hc/client5/http/examples/ClientFormLogin.java)

* * *

```
import java.util.ArrayList;
import java.util.List;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.cookie.Cookie;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.HTTP;

/**
 * A example that demonstrates how HttpClient APIs can be used to perform
 * form-based logon.
 */
public class ClientFormLogin {

    public static void main(String[] args) throws Exception {

        DefaultHttpClient httpclient = new DefaultHttpClient();

        HttpGet httpget = new HttpGet("https://portal.sun.com/portal/dt");

        HttpResponse response = httpclient.execute(httpget);
        HttpEntity entity = response.getEntity();

        System.out.println("Login form get: " + response.getStatusLine());
        if (entity != null) {
            entity.consumeContent();
        }
        System.out.println("Initial set of cookies:");
        List<Cookie> cookies = httpclient.getCookieStore().getCookies();
        if (cookies.isEmpty()) {
            System.out.println("None");
        } else {
            for (int i = 0; i < cookies.size(); i++) {
                System.out.println("- " + cookies.get(i).toString());
            }
        }

        HttpPost httpost = new HttpPost("https://portal.sun.com/amserver/UI/Login?" +
                "org=self_registered_users&" +
                "goto=/portal/dt&" +
                "gotoOnFail=/portal/dt?error=true");

        List <NameValuePair> nvps = new ArrayList <NameValuePair>();
        nvps.add(new BasicNameValuePair("IDToken1", "username"));
        nvps.add(new BasicNameValuePair("IDToken2", "password"));

        httpost.setEntity(new UrlEncodedFormEntity(nvps, HTTP.UTF_8));

        response = httpclient.execute(httpost);
        entity = response.getEntity();

        System.out.println("Login form get: " + response.getStatusLine());
        if (entity != null) {
            entity.consumeContent();
        }

        System.out.println("Post logon cookies:");
        cookies = httpclient.getCookieStore().getCookies();
        if (cookies.isEmpty()) {
            System.out.println("None");
        } else {
            for (int i = 0; i < cookies.size(); i++) {
                System.out.println("- " + cookies.get(i).toString());
            }
        }

        // When HttpClient instance is no longer needed, 
        // shut down the connection manager to ensure
        // immediate deallocation of all system resources
        httpclient.getConnectionManager().shutdown();        
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-04-11T16:45:22.973

cookie 只是另一个 HTTP 标头。在使用 apache 库或 HTTPUrlConnection 进行 HTTP 调用时，您始终可以设置它。无论哪种方式，您都应该能够以这种方式读取和设置 HTTP cookie。

您可以阅读[这篇文章](http://android-developers.blogspot.in/2011/09/androids-http-clients.html)以获取更多信息。

我可以分享我的代码和平，以展示你可以多么容易地做到这一点。

```
public static String getServerResponseByHttpGet(String url, String token) {

        try {
            HttpClient client = new DefaultHttpClient();
            HttpGet get = new HttpGet(url);
            get.setHeader("Cookie", "PHPSESSID=" + token + ";");
            Log.d(TAG, "Try to open => " + url);

            HttpResponse httpResponse = client.execute(get);
            int connectionStatusCode = httpResponse.getStatusLine().getStatusCode();
            Log.d(TAG, "Connection code: " + connectionStatusCode + " for request: " + url);

            HttpEntity entity = httpResponse.getEntity();
            String serverResponse = EntityUtils.toString(entity);
            Log.d(TAG, "Server response for request " + url + " => " + serverResponse);

            if(!isStatusOk(connectionStatusCode))
                return null;

            return serverResponse;

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }

        return null;
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-04-13T04:35:06.073

由于**不推荐使用 Apache 库**，对于那些想要使用的人，我编写了这个类来在[这个答案](https://stackoverflow.com/a/16171708/2101822)`HttpURLConncetion`的帮助下发送 Get 和 Post 请求：

```
public class WebService {

static final String COOKIES_HEADER = "Set-Cookie";
static final String COOKIE = "Cookie";

static CookieManager msCookieManager = new CookieManager();

private static int responseCode;

public static String sendPost(String requestURL, String urlParameters) {

    URL url;
    String response = "";
    try {
        url = new URL(requestURL);

        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setReadTimeout(15000);
        conn.setConnectTimeout(15000);
        conn.setRequestMethod("POST");

        conn.setRequestProperty("Content-Type", "application/json; charset=utf-8");

        if (msCookieManager.getCookieStore().getCookies().size() > 0) {
            //While joining the Cookies, use ',' or ';' as needed. Most of the server are using ';'
            conn.setRequestProperty(COOKIE ,
                    TextUtils.join(";", msCookieManager.getCookieStore().getCookies()));
        }

        conn.setDoInput(true);
        conn.setDoOutput(true);

        OutputStream os = conn.getOutputStream();
        BufferedWriter writer = new BufferedWriter(
                new OutputStreamWriter(os, "UTF-8"));

        if (urlParameters != null) {
            writer.write(urlParameters);
        }
        writer.flush();
        writer.close();
        os.close();

        Map<String, List<String>> headerFields = conn.getHeaderFields();
        List<String> cookiesHeader = headerFields.get(COOKIES_HEADER);

        if (cookiesHeader != null) {
            for (String cookie : cookiesHeader) {
                msCookieManager.getCookieStore().add(null, HttpCookie.parse(cookie).get(0));
            }
        }

        setResponseCode(conn.getResponseCode());

        if (getResponseCode() == HttpsURLConnection.HTTP_OK) {

            String line;
            BufferedReader br = new BufferedReader(new InputStreamReader(conn.getInputStream()));
            while ((line = br.readLine()) != null) {
                response += line;
            }
        } else {
            response = "";
        }
    } catch (Exception e) {
        e.printStackTrace();
    }

    return response;
}

// HTTP GET request
public static String sendGet(String url) throws Exception {

    URL obj = new URL(url);
    HttpURLConnection con = (HttpURLConnection) obj.openConnection();

    // optional default is GET
    con.setRequestMethod("GET");

    //add request header 
    con.setRequestProperty("User-Agent", "Mozilla");
    /*
    * https://stackoverflow.com/questions/16150089/how-to-handle-cookies-in-httpurlconnection-using-cookiemanager
    * Get Cookies form cookieManager and load them to connection:
     */
    if (msCookieManager.getCookieStore().getCookies().size() > 0) {
        //While joining the Cookies, use ',' or ';' as needed. Most of the server are using ';'
        con.setRequestProperty(COOKIE ,
                TextUtils.join(";", msCookieManager.getCookieStore().getCookies()));
    }

    /*
    * https://stackoverflow.com/questions/16150089/how-to-handle-cookies-in-httpurlconnection-using-cookiemanager
    * Get Cookies form response header and load them to cookieManager:
     */
    Map<String, List<String>> headerFields = con.getHeaderFields();
    List<String> cookiesHeader = headerFields.get(COOKIES_HEADER);
    if (cookiesHeader != null) {
        for (String cookie : cookiesHeader) {
            msCookieManager.getCookieStore().add(null, HttpCookie.parse(cookie).get(0));
        }
    }

    int responseCode = con.getResponseCode();

    BufferedReader in = new BufferedReader(
            new InputStreamReader(con.getInputStream()));
    String inputLine;
    StringBuffer response = new StringBuffer();

    while ((inputLine = in.readLine()) != null) {
        response.append(inputLine);
    }
    in.close();

    return response.toString();
}

public static void setResponseCode(int responseCode) {
    WebService.responseCode = responseCode;
    Log.i("Milad", "responseCode" + responseCode);
}

public static int getResponseCode() {
    return responseCode;
}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T20:01:20.180

我不使用 google android，但我想你会发现让它工作并不难。如果您阅读[了 java 教程的相关部分，](http://java.sun.com/docs/books/tutorial/networking/cookies/cookiehandler.html)您会看到已注册的 cookiehandler 从 HTTP 代码中获取回调。

因此，如果没有默认值（您是否检查过是否`CookieHandler.getDefault()`真的为空？）那么您可以简单地扩展 CookieHandler，实现 put/get 并使其几乎自动工作。如果您走那条路线，请务必考虑并发访问等。

编辑：显然，您必须将自定义实现的实例设置为默认处理程序`CookieHandler.setDefault()`才能接收回调。忘了提那个。

# c# - 如何从服务器上找出客户端的下载速度？

> ID：678635
> 
> 赞同：4
> 
> 时间：2009-03-24T18:33:33.653
> 
> 标签：c#, javascript, download-speed

根据客户端的下载速度，我想以低质量或高质量显示视频。任何 Javascript 或 C# 解决方案都是可以接受的。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T18:39:20.860

没有任何方法可以确定。您只能衡量向客户端发送数据的速度。如果没有来自客户端的任何类型的输入来表明它获取信息的速度，那么您无能为力。

您可以将客户端重定向到使用 javascript 下载页面中已知大小的元素的页面。然后，在下载开始和结束时花时间，并将页面重定向到通过客户端上的 javascript 构建的 URL，该 URL 会向您发送下载元素所花费的时间。

鉴于您知道元素的大小，然后您可以估计速率并猜测下载速度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T18:52:01.190

这是一篇关于 gmail 如何工作以及它如何找到用户的互联网速度的[帖子。](http://www.sajithmr.com/gmail-architecture/)你可以得到一些想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T18:56:56.687

也许，在 javascript 中，您可以执行以下操作：

```
var testImg = document.createElement('img');
testImg.src="src.jpg"; // image with known size
var imageSize = 10; // for 10 k image
testImg.onload = function(){
   var downloadRateKPerSrc = imageSize/((new Date().getTime() - startTime)/1000);
};

testImg.style.display='none';
var startTime = new Date().getTime();
document.body.appendChild(testImg); 
```

未经测试的代码 - 但这个想法可能有效吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T18:41:53.007

大多数网站只是让用户选择高质量或低质量版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T18:44:56.730

这是一个坏主意，尤其是因为大多数用户可以自己控制他们的带宽（即我正在运行使用大量带宽的 P2P 应用程序，但如果有其他需要优先考虑的事情，我会关闭它们。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T18:47:53.400

您可以使用 Silverlight 或 Flash 作为上传插件。这将使您能够真正控制客户端上传的内容、状态以及上传开始时的上传速度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T19:35:06.873

您可以在 GeoIP Netspeed 中查找他们的地址：http: [//www.maxmind.com/app/geolocation](http://www.maxmind.com/app/geolocation)

# mysql - MAMP 中包含的 MySQL 是否不包含配置文件？

> ID：678645
> 
> 赞同：96
> 
> 时间：2009-03-24T18:35:40.510
> 
> 标签：mysql, mamp

我似乎找不到[MAMP](http://www.mamp.info/en/index.html)附带的 MySQL 的 my.cnf 或其他配置文件。它不包括一个吗？

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2010-05-19T21:51:53.887

MAMP（非 PRO）的 MySQL 服务器将在没有任何 my.cnf 文件的情况下启动。但是您可以创建自己的 my.cnf 文件。

1.  停止服务器
2.  在中创建`my.cnf`文件`/Applications/MAMP/conf/`
3.  将您的内容添加到`my.cnf`
4.  节省`my.cnf`
5.  启动服务器

您不必在 my.cnf 文件中放置完整的配置。您可以只添加配置的一部分......例如：

```
[mysqld]
max_allowed_packet = 64M 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-08-23T20:07:02.220

可以在 /Applications/MAMP/Library/support-files/ 找到一些标准的 my.cnf 变体

调用`mysqld --verbose --help | less`MAMP mysqld 二进制报告：

> 默认选项按给定顺序从以下文件中读取： /etc/my.cnf /etc/mysql/my.cnf /Applications/MAMP/conf/my.cnf ~/.my.cnf

将 /Applications/MAMP/Library/support-files/ 中的变体之一复制到上面 mysqld 搜索顺序中的位置之一，重新启动守护程序后你应该很高兴。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-07-26T11:06:09.410

由于 MAMP 服务器`my.cnf`在 MAMP 服务器启动时动态生成，因此最好使用以下步骤来添加或编辑 MySQL 配置：

1.  停止 MAMP 服务器
2.  转到文件>编辑模板> MySQL
3.  进行必要的更改并保存
4.  重启 MAMP

我在 MAMP PRO 3.5 上试过这个。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-10-19T03:37:25.167

对于 Mac El Capitan 上的 MAMP 3.5，只有这对我有用：

1.  停止服务器
2.  在中创建`my.cnf`文件`/Applications/MAMP/Library/`
3.  将您的内容添加到`my.cnf`like

    `[mysqld] max_allowed_packet = 64M`

4.  节省`my.cnf`

5.  启动服务器

不需要更改文件的所有权，它应该可以工作。通过在 phpmyadmin 中运行进行验证`SHOW VARIABLES`并查找您更改的设置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T18:39:32.420

不，它不附带 my.cnf 文件

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-05T12:16:18.653

我发现如果没有提供 ~/my.cnf，MAMP PRO 会在启动时默认在 MAMP/tmp 目录下创建一个 my.cnf ... grepping ps aux 你可能会在 /Applications/MAMP/tmp 下找到默认位置/我的.cnf ...

```
 ps aux | grep mysql 
```

其中提供了以下...

```
root       284   0.0  0.1  2435544    532   ??  Ss    12:00AM   0:00.06 /bin/sh     /Applications/MAMP/Library/bin/mysqld_safe 
--defaults-file=/Applications/MAMP/tmp/mysql/my.cnf 
--port=8889 --socket=/Applications/MAMP/tmp/mysql/mysql.sock 
--user=mysql --pid-file=/Applications/MAMP/tmp/mysql/mysql.pid 
--log-error=/Applications/MAMP/logs/mysql_error_log.err 
--tmpdir=/Applications/MAMP/tmp/mysql/tmpdir 
--datadir=/Library/Application Support/appsolute/MAMP PRO/db/mysql 
```

# sed - 无法通过 SED/AWK 过滤包含“是目录”的行

> ID：678652
> 
> 赞同：1
> 
> 时间：2009-03-24T18:36:58.340
> 
> 标签：sed, awk

我运行代码给了我以下示例数据

```
md5deep find * | awk '{ print $1 }' 
```

**输出样本**

```
 /Users/math/Documents/Articles/Number theory: Is a directory
    258fe6853b1bfb2d07f512ff6bec52b1
    /Users/math/Documents/Articles/Probability and statistics: Is a directory
    4811bfb2ad04b9f4318049c01ebb52ef
    8aae4ac3694658cf90005dbdea37b4d5
    258fe6853b1bfb2d07f512ff6bec52b1 
```

我试图通过 SED过滤包含**Is a directory的行未成功**

```
md5deep find * | awk '{ print $1 }' | sed s/\/*//g 
```

它的样本输出是

```
/Users/math/Documents/Articles/Number theory: Is a directory
/Users/math/Documents/Articles/Topology: Is a directory
/Users/math/Documents/Articles/useful: Is a directory 
```

**如何通过 SED/AWK 过滤掉包含“是目录”的每一行？**

**[澄清]** 我想过滤掉包含*Is a directory*的行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T19:12:56.833

我没有使用过该`md5deep`工具，但我相信这些行是错误消息；他们将进入[标准错误](http://en.wikipedia.org/wiki/Standard_streams)而不是标准输出，因此他们将直接进入您的终端而不是通过管道。因此，您的 sed 命令不会过滤它们。您可以通过合并标准错误和标准输出流来过滤它们，但是

看起来（我不确定，因为您缺少反引号）您正在尝试调用

```
md5deep `find *` 
```

并且 find 正在返回所有文件和目录。

关于您可能想要做的一些说明：

*   看起来`md5deep`有一个 -r 表示“递归”选项。因此，您可能想尝试：

    ```
    md5deep -r * 
    ```

    而不是 find 命令。

*   如果您确实希望使用`find`命令，可以使用 将其限制为仅文件`-type f`，而不是文件和目录。此外，您不需要传递`*`到 find 命令（`find`如果文件的名称看起来像可以`find`理解的选项，这可能会造成混淆）；传入`.`将递归搜索当前目录。

    ```
    find . -type f 
    ```

*   如果你想在`sed`你的模式中使用斜线，用 \ 正确引用它们可能会很痛苦。您可以改为选择不同的字符来分隔正则表达式；`sed`将使用`s`命令后的第一个字符作为分隔符。您的模式也缺少`.`; 在正则表达式中，表示您使用的任何字符的一个实例`.`，并表示您使用的“零个或多个前面的表达式” `*`，因此`.*`表示“零个或多个任何字符”（这与全局模式不同，其中`*`单独意思是“零个或多个任何字符”）。

    ```
    sed "s|/.*||g" 
    ```

*   如果您确实想在标准输出中包含标准错误流，那么它将通过管道，那么您可以运行：

    ```
    md5deep `find *` 2>&1 | awk ... 
    ```

*   如果您只想忽略 stderr，可以将其重定向到`/dev/null`，这是一个特殊文件，它只会丢弃其中的任何内容：

    ```
    md5deep `find *` 2>/dev/null | awk ... 
    ```

总之，我认为下面的命令将帮助您解决当前的问题，如果我没有理解您正在寻找的内容，上面列出的其他建议可能会对您有所帮助：

```
md5deep -r * | awk '{ print $1 }' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T20:38:43.500

具体回答澄清：如何使用awk和sed过滤掉行：

```
awk '/Is a directory/ {next} {print}'
sed 'g/Is a directory/d' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T18:51:23.390

为什么不使用 grep 代替？

IE，

```
md5deep find * | grep "Is a directory" | awk '{ print $1 }' 
```

编辑：我只是重新阅读了您的问题，如果您想删除带有 Is a directory 的行，请使用 grep 的 -v 标志，即：

```
md5deep find * | grep -v "Is a directory" | awk '{ print $1 }' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T19:00:08.643

我对 md5deep 不是很熟悉，但这*可能会*做一些你想做的事情。

```
find -type f -exec md5sum {} + 
```

# php - 当 PHP 出现解析错误时，如何运行自定义函数/代码位

> ID：678655
> 
> 赞同：1
> 
> 时间：2009-03-24T18:37:46.060
> 
> 标签：php, error-handling

我希望为 PHP 的解析错误运行一些自定义错误处理 - 语法错误时的类型，你会得到那些白屏死机。

（需要明确的是，运行格式错误的代码时会产生的类型如下：

```
<?php
if () {
?> 
```

)

我查看了设置自定义错误处理程序，但没有发生任何事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T19:12:51.670

另一个想法：如果您有自己的根服务器或只想在本地 PC 上执行脚本，您可以执行以下操作：

将要测试的代码放在一个新文件中，比如`failure.php`. 在您要检查错误的脚本（同一目录）中，这样做：

```
$path_to_test = 'failure.php';
$result = `php -l $path_to_test`; 
```

然后你有解析错误消息`$result`，因为该标志`-l`使 PHP 只解析代码。它永远不会执行任何事情。您可以自行解析错误消息，甚至从中获取行号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T18:46:15.277

通常你会使用[`set_error_handler`](http://us3.php.net/set-error-handler)这个，但文档注意到这一点：

> 以下错误类型不能用用户定义的函数处理：`E_ERROR`, `E_PARSE`, `E_CORE_ERROR`, `E_CORE_WARNING`, `E_COMPILE_ERROR`, `E_COMPILE_WARNING`, 和大部分在调用`E_STRICT`的文件中引发。`set_error_handler()`

你所拥有的是一个`PARSE_ERROR`并且不能被这个捕获的。在`set_error_handler`页面的“用户评论”部分，有很多解决方案可以捕获所有错误，有些人说它有效，有些人说它无效，所以我建议你仔细检查一下，看看是否真的有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T18:47:16.553

这不是*致命错误*，因为该术语在 PHP 中使用。这是一个*解析错误*。这意味着 PHP 无法理解您的代码，因此它根本不会执行代码。因此，您无法捕获此类错误。如果您确定要测试的代码不包含任何有害注入，则可以对其进行评估：

```
if ( !@eval( 'if () {' ) )
{

    echo "An error occured.";

} 
```

但请务必阅读有关如何以及何时使用[`eval()`](http://www.php.net/eval). 这可能非常危险。

# ruby - 如何使用 Ruby 客户端访问 Selenium 中的“newPageLoaded”标志？

> ID：678658
> 
> 赞同：0
> 
> 时间：2009-03-24T18:38:10.567
> 
> 标签：ruby, selenium

通过阅读 Selenium 文档，我可以看到执行页面加载操作时会设置一个“newPageLoaded”标志。我试图找出是否有办法在页面加载时获取该标志的值。

如何使用 Ruby 客户端做到这一点会很棒。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T18:57:56.073

你可以试试这样的东西吗？

```
selenium.getEval("selenium.browserbot.isNewPageLoaded()"); 
```

# ruby-on-rails - 对于 Visual Studio 用户来说，最好的 Ruby on Rails 环境是什么？

> ID：678661
> 
> 赞同：39
> 
> 时间：2009-03-24T18:38:42.517
> 
> 标签：ruby-on-rails, visual-studio, ide, development-environment

自 1997 年以来，我一直是 Visual Studio 用户，并在此之前使用过 VB 3.0。我的整个职业生涯都在 Microsoft 开发环境中度过。

现在我想扩展到 Ruby on Rails 来尝试一些不同的东西，它没有 C# 那样的供应商支持（出于非常明显的原因）。

对于来自 Visual Studio 世界的人来说，在 Windows 上为 RoR 开发设置的最佳整体环境（IDE、工具、gem 等）是什么，可以使过渡更容易？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-24T20:53:03.457

如果您想坚持使用 Visual Studio，您可以随时使用[Sapphire Steel的](http://SapphireSteel.Com/)[Ruby in Steel](http://SapphireSteel.Com/Ruby-In-Steel-Developer-Overview)插件。用于 Ruby 的最佳传统 IDE 可能是[NetBeans](http://NetBeans.Org/)，它甚至还有一个特别精简的[Ruby 版本](http://NetBeans.Org/features/ruby/)。

但是，请注意，与 Java、C# 或 VB.NET 等表达能力较差的语言不同，与传统的静态 IDE 相比，使用良好的文本编辑器不仅可以应付，而且甚至可以*提高工作效率。*NetBeans、Eclipse 和 Visual Studio 等 IDE 在设计时考虑到了静态语言，试图将 Ruby 强制加入该生态系统是不自然的。

您可能想阅读 Fabio Akita撰写[*的关于 Windows 上 Rails 的最佳环境的*](http://www.akitaonrails.com/2009/01/13/the-best-environment-for-rails-on-windows)一篇不错的文章。虽然我不同意他写的所有内容（主要是因为我不使用 Rails），但它很好地介绍了您可能希望如何专门为 Rails 设置开发环境。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-14T16:22:26.603

试试 JetBrains [RubyMine](http://www.jetbrains.com/ruby/)。安装时，您可以选择将其设置为匹配 Visual Studio 环境设置。所有的捷径都与 Visual Studio 相同。它甚至可以在 Mac 上将复制和粘贴键从命令切换到控制。考虑到有多少免费选项，这有点贵，但在我看来这是值得的。

这个东西是如此高度可定制的，它几乎是压倒性的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-24T18:40:07.973

网豆！它具有最相似的功能。在切换之前，我在 VS 中开发了多年。这是我唯一真正喜欢并且使用起来很舒服的一个。

[Netbeans.org](http://www.netbeans.org/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-06T16:45:44.127

您可能会发现 RadRails (Aptana) 是一个很好的选择：( [http://www.aptana.com/rails](http://www.aptana.com/rails) ) -**注意**：请务必查看“功能和比较”选项卡，因为 RadRails 具有许多引人注目的功能。此外，我使用 Aptana Studio 进行 JQuery 开发，它帮助我提高工作效率。

我已经尝试过 Netbeans，它看起来也很有希望，但被多次提及，所以我想提供另一种我知道的方法。

希望这可以帮助！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-01T10:30:25.077

我使用 netbeans 有两个原因。我喜欢 Visual Studio 风格的导航窗格和调试器。

但请注意，Netbeans 非常慢。它并没有那么困扰我，因为我也很慢。

我也不喜欢文件名选项卡，因为除非您将鼠标悬停在选项卡上，否则您很容易对正在处理的文件感到困惑，因为没有目录信息。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-03-01T09:33:56.960

2018 年？[视觉工作室代码](https://code.visualstudio.com/)！这些事情似乎总是绕了一圈，对吧？

# reverse-proxy - Squid 缓存最佳实践

> ID：678664
> 
> 赞同：2
> 
> 时间：2009-03-24T18:39:14.170
> 
> 标签：reverse-proxy, squid

我已经为缓存设置了 squid 并使用了来自[Last.fm post 的](http://blog.last.fm/2007/08/30/squid-optimization-guide)指针。

虽然我有大容量的服务器，但由于 Squid 只能使用处理器核心，CPU 使用率似乎非常高。有没有更好的方法来优化 squid 以使用更少的 CPU？

我尝试过使用 tcmalloc 并禁用 ESI，但这些都没有帮助。

# asp.net - 并发 ASP.NET 最佳实践 最差实践

> ID：678669
> 
> 赞同：1
> 
> 时间：2009-03-24T18:39:54.153
> 
> 标签：asp.net, concurrency

在哪些情况下您需要注意 ASP.NET 中的并发问题（例如使用锁）？

*   关于这个主题是否有“最佳实践”
*   文档？
*   例子？
*   '最坏的做法......'或你见过的可能导致灾难的事情......？

我很好奇例如单例（即使它们被认为是不好的做法 - 不要开始讨论这个），静态函数（你需要在这里注意吗？），...？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T19:02:18.340

由于 ASP.NET 是一个 Web 框架并且主要是无状态的，因此需要解决的并发问题非常少。

我唯一需要处理的是管理应用程序缓存，但这很容易通过封装 .NET 缓存机制的缓存管理类型来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T19:08:56.283

一个让我们非常痛苦的大问题是在我们的主 Web 服务中使用模块与类。这是在我们真正知道我们在做什么之前，并且已经修复。

使用模块的一个大问题是，默认情况下，任何模块级变量对 ASP 工作进程的每个实例都是可见的。我们传入多个数据集并对其进行操作，然后将它们返回给客户端。因为我们使用的是模块，所以保存这些数据集的变量会被一次发生的多个调用破坏。

在我们弄清楚如何正确加载测试我们的 Web 服务之前，这并没有在测试中发现并且很难重现。在我们准确地重现它之前，每秒需要大约 10-20 个请求。

最后，我们只是将所有模块更改为类，然后使用这些类而不是对模块的调用，这解决了这个并发问题，因为每个实例化的类在内存中都有自己的数据集副本。

# .net - 使用 XmlAttributeOverrides 预编译 XmlSerializer

> ID：678676
> 
> 赞同：9
> 
> 时间：2009-03-24T18:43:50.007
> 
> 标签：.net, xml-serialization, sgen

在 .NET 中构造 XmlSerializer 实例时，会动态生成用于序列化和反序列化指定类型的程序集。这是一个耗时的过程。Microsoft 的 sgen.exe 工具可用于预编译 XmlSerializer 实例以供以后使用，而无需动态生成它们。不幸的是，这对于使用 XmlAttributeOverrides 的 XmlSerializer 实例是不可能的。

有没有办法预编译这些 XmlSerializer 实例以避免在运行时生成？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-09-20T14:38:27.420

Andreas，这不是 sgen 工具本身的问题，这是由于 XmlSerializer 实现所致。

当您创建 XmlSerializer 的实例时，使用只有一个 Type 参数的构造函数，它会检查缓存并查找预生成的程序集。但是，当您将构造函数与 XmlAttributeOverrides 一起使用时，XmlSerializer 不会检查任何缓存并立即生成临时程序集。

这很可能是因为序列化逻辑发生了相当大的变化，您可以使用 XmlAttributeOverrides 参数实现，而 sgen 等工具在编译时无法“预见”这些变化。

如果你需要预编译一些东西，你 [叹气] 必须避免 XmlAttributeOverrides。如果这不可能，请尝试提前创建所需的 XmlSerializer 实例，可能在后台线程中。

只是为了您的兴趣，这里是默认构造函数的代码（检查缓存并尝试查找预生成的程序集）：

```
public XmlSerializer(Type type, string defaultNamespace)
{
    this.events = new XmlDeserializationEvents();
    if (type == null)
    {
        throw new ArgumentNullException("type");
    }
    this.mapping = GetKnownMapping(type, defaultNamespace);
    if (this.mapping != null)
    {
        this.primitiveType = type;
    }
    else
    {
        this.tempAssembly = cache[defaultNamespace, type];
        if (this.tempAssembly == null)
        {
            lock (cache)
            {
                this.tempAssembly = cache[defaultNamespace, type];
                if (this.tempAssembly == null)
                {
                    XmlSerializerImplementation implementation;
                    Assembly assembly = TempAssembly.LoadGeneratedAssembly(type, defaultNamespace, out implementation);
                    if (assembly == null)
                    {
                        this.mapping = new XmlReflectionImporter(defaultNamespace).ImportTypeMapping(type, null, defaultNamespace);
                        this.tempAssembly = GenerateTempAssembly(this.mapping, type, defaultNamespace);
                    }
                    else
                    {
                        this.mapping = XmlReflectionImporter.GetTopLevelMapping(type, defaultNamespace);
                        this.tempAssembly = new TempAssembly(new XmlMapping[] { this.mapping }, assembly, implementation);
                    }
                }
                cache.Add(defaultNamespace, type, this.tempAssembly);
            }
        }
        if (this.mapping == null)
        {
            this.mapping = XmlReflectionImporter.GetTopLevelMapping(type, defaultNamespace);
        }
    }
} 
```

这是与 XmlAttributeOverrides 一起使用的构造函数（总是生成序列化程序集）：

```
public XmlSerializer(Type type, XmlAttributeOverrides overrides, Type[] extraTypes, XmlRootAttribute root, string defaultNamespace, string location, Evidence evidence)
{
    this.events = new XmlDeserializationEvents();
    if (type == null)
    {
        throw new ArgumentNullException("type");
    }
    XmlReflectionImporter importer = new XmlReflectionImporter(overrides, defaultNamespace);
    for (int i = 0; i < extraTypes.Length; i++)
    {
        importer.IncludeType(extraTypes[i]);
    }
    this.mapping = importer.ImportTypeMapping(type, root, defaultNamespace);
    if (location != null)
    {
        this.DemandForUserLocation();
    }
    this.tempAssembly = GenerateTempAssembly(this.mapping, type, defaultNamespace, location, evidence);
} 
```

# graphics - 如何在 .NET 3.5 中保存 EXIF 格式的图像文件

> ID：678682
> 
> 赞同：4
> 
> 时间：2009-03-24T18:45:52.220
> 
> 标签：graphics, image-processing, gdi+, exif, imaging

我想使用 System.Drawing.Image.Save 或使用 .NET 框架 v3.5 的 C# 应用程序中的类似方法以 EXIF 格式保存图像。MSDN 文档将 EXIF 列为 ImageFormat 的一个选项。但是，它似乎不受支持 - 至少在我不知道某些配置的情况下不支持。当我通过 ImageCodecInfo.GetImageEncoders() 枚举内置编码器时，不包括 EXIF。（在我的机器（Vista Ultimate x64）上内置的编码器是：BMP、JPEG、GIF、TIFF 和 PNG。）如果我使用 ImageFormat.Exif 属性保存图像，我只需获得默认的 PNG 格式。

如何使用 .NET 3.5 以 EXIF 格式保存图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-12T23:33:13.853

EXIF 本身不是一种图像文件格式，而是一种在 JPEG 图像中发现的元数据格式，符合 JEITA 指定的 DSC（数码相机）标准。

GDI+（即 Microsoft .NET Framework）允许您通过 Image.PropertyItems 读取/写入元数据图像属性，但是 GDI+ 公开的 EXIF 属性非常麻烦，并且不会按照您期望的方式转换值。实际上需要做很多工作才能本地读取/写入这些值（例如，您需要根据 JEITA 规范解压缩包含特殊编码值的二进制字段）。

[可以在http://code.google.com/p/exif-utils/](http://code.google.com/p/exif-utils/)找到实现所有标准 EXIF 属性的直接开源库。这可能是最简单的方法。请参阅[简单的包含演示](http://code.google.com/p/exif-utils/source/browse/trunk/ExifUtils/ExifDemo/Program.cs)，它读取文件，打印出所有 EXIF 属性，然后将属性添加到图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T08:25:38.220

你见过吗：[Lossless JPEG Rewrites in C#](http://www.eggheadcafe.com/articles/20030706.asp)

# sql-server - 存储在 SQL Server 中的法语文本出现错误，如何使其正确显示

> ID：678683
> 
> 赞同：2
> 
> 时间：2009-03-24T18:45:53.123
> 
> 标签：sql-server, unicode, text, character-encoding, nvarchar

我有一个由以下结构组成的表。

```
 CREATE TABLE [dbo].[tblData](
    [ID] [numeric](18, 0) NOT NULL,
    [QID] [varchar](25) NOT NULL,
    [Data] [nvarchar](255) NULL,
  CONSTRAINT [PK_tblData] PRIMARY KEY CLUSTERED 
   (
      [ID] ASC,
      [QID] ASC
   )
 ) ON [PRIMARY] 
```

在上面的示例中，[data] 列中混合了不同的语言。我们通过设置适当代码页的网站收集这些数据。我了解插入到我们表格中的数据是收集数据时网页上设置的代码页。我们将此信息存储在其他地方。

我们使用的每种语言都很好。例如，中文会根据我们的需要出现并显示。我们正在尝试将此数据转储到 Unicode 文本文件中。具体来说：“UCS-2 LE” 只有一种语言没有出现，那就是法语。由于某种原因，通常重音的字符完全错误。我发现数据（我希望）似乎被“存储”为错误的字符。

一位同事认为表中的数据可能是正确的，我们只需将其转换为正确的字符集或正确的代码页以正确显示数据，然后再将数据放入 UCS-2 LE 文本文件。

任何人都可以对我的问题提供任何见解吗？ ***谢谢！***

**更新**：我发现了这个： http: [//windowsitpro.com/windowsstorage/Article/ArticleID/14045/windowsstorage_14045.html](http://windowsitpro.com/windowsstorage/Article/ArticleID/14045/windowsstorage_14045.html) - 这基本上是说我需要做的事情不能做吗？我认为我想做的事情略有不同，但这会导致 [false-] 希望。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T19:12:00.813

你的同事是对的。由于数据以 UNICODE 数据类型存储，因此应保留本机语言格式。

需要发生的是，当您选择数据时，您要确保为执行请求的用户（即他们的语言环境）使用适当的排序规则。

有关在 SQL Server 中使用排序规则的信息，请参阅以下联机丛书参考

[http://msdn.microsoft.com/en-us/library/ms144260(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms144260(SQL.90).aspx)

希望这可以帮助。干杯。

# javascript - 在页面加载时调用 Flash 外部接口 AS3 函数

> ID：678687
> 
> 赞同：2
> 
> 时间：2009-03-24T18:46:32.497
> 
> 标签：javascript, flash, actionscript-3

我在 AS3 中定义了一个函数，它将通过 JavaScript 从客户端调用。AS3 函数在调用时只是在 SWF 屏幕上打印一些值。

当我将 onclick 事件处理程序设置为按钮并调用 AS3 函数时，它工作正常。但是，我想在页面加载后立即调用此 AS3 函数。我在项目中使用 jQuery，并将对 AS3 函数的调用放在 $(document).ready() 中，但这在 FF2 firebug 中给了我以下错误：

getFlashMovie("my_movie_name").my_as3_function 不是函数

然后，我尝试通过在 上设置 onLoad 事件处理程序来调用 ，但这也不起作用 - 产生相同的错误。

所以，我的问题是，如何在页面加载后自动调用 AS3 函数？在我的项目中，一旦页面加载，我需要将一些客户端初始化信息传递给闪存。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-24T18:55:02.493

您需要让您的 Flash 在页面中调用一个函数来通知它 Flash 已加载并初始化，然后将其用作您的入口点。

在闪光灯中：

```
ExternalInterface.call('flashReady'); 
```

在页面中：

```
<script>
function flashReady() {
   ..
}
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T01:34:58.473

如果您使用[swfObject](http://code.google.com/p/swfobject/)嵌入您的 SWF（无论如何可能是个好主意），那么您可以使用它的 addDomLoadEvent() 函数，它允许您在 SWF 完全加载后执行某些操作

```
swfobject.addDomLoadEvent(function() {
   $("#swfobject").get(0).inited('you are loaded!'); 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T12:55:41.990

我不想在这里成为一个聪明人，但你会在服务器上测试你的工作吗？

外部接口，addcallback 在本地文件系统上不起作用，最终您可能必须添加：

flash.system.Security.allowDomain(' [http://localhost](http://localhost) ');

如果您在本地运行。

:P

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T18:53:18.410

问题是页面完成加载时 Flash 对象尚未初始化。从 AS3 中执行此初始化可能会更安全。如果要从 HTML 页面传递值，请使用 flashVars。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T09:03:17.570

几周前我自己遇到了这个问题。解决方案非常简单:)

首先，您需要在 DOM 中放入一个 div

```
<div id="timewriter"><div> 
```

您还将使用[jQuery Timers 插件](http://jquery.offput.ca/timers/)来计时加载。经过这些准备，事情会变得非常容易。以下代码将进入您的 $(document).ready();

```
var movie = getFlashMovie('my_movie_name');

if(movie.PercentLoaded() != 100)
{
    $("#timewriter").everyTime(100, function () 
    {
        if(movie.PercentLoaded() == 100)
        {

            $("#timewriter").stopTime();
            //the movie is loaded, call here your functions; usually this happens if you don't use cache

        }
    });
}
else
{
    //the movie is loaded, call here your functions; usually you get here if you use cache
} 
```

稍后编辑：请注意 HTML 页面加载并不意味着 swf 已加载，这发生在网页加载完成事件之后。我的解决方案也是基于[jQuery](http://www.jquery.com) javascript 库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T01:27:27.103

似乎答案集合提供了最接近其全部的答案。

正如大卫哈纳克所说，闪存对象还不能被访问，因为它正在初始化，尽管我不同意我们必须依赖闪存变量，尽管我喜欢它们。

Tweakt 是对的，但是在调用 javascript 中的函数时，请调用回调到您的 swf 的 javascript 函数；通过这种方式，我们知道 flash 在发送第一个调用时已准备就绪。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T18:23:01.073

Tweakt 和 Bogdan 的答案都是可行的。如果您可以访问 Actionscript，请使用tweakt 的方法。如果你不这样做，请使用 Bogdan's。我一直在寻找除了轮询之外的替代方法（当您无法访问 Actionscript 时），但到目前为止我一直没有找到一个。这里提到了事件：http: [//www.adobe.com/support/flash/publishexport/scriptingwithflash/scriptingwithflash_03.html](http://www.adobe.com/support/flash/publishexport/scriptingwithflash/scriptingwithflash_03.html)但似乎没有人知道如何使用它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-30T00:24:56.370

For the sake of completion, you would also have to use `import flash.external.*;` to make everything work.

# wpf - 如何在 WPF ListView ( GridView ) 中创建组页脚

> ID：678690
> 
> 赞同：27
> 
> 时间：2009-03-24T18:47:21.950
> 
> 标签：wpf, .net-3.5, styles

我有一个显示销售订单的 ListView，并按状态对它们进行分组。在 WinForms 中，我在每个组的底部都有一个页脚，显示每个组的总售价，我想在 WPF 中做同样的事情。

我已经知道如何对订单进行分组，但我不知道如何创建页脚。

这是我目前的小组风格：

```
<ListView.GroupStyle>
            <GroupStyle HidesIfEmpty="True">
                <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                        <!--CollectionViewGroup.Name will be assigned the value of Status for that group.-->
                        <!--http://stackoverflow.com/questions/639809/how-do-i-group-items-in-a-wpf-listview-->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="{Binding Path=Name}" HorizontalAlignment="Left" FontWeight="Bold"  Foreground="Black"/>
                            <Line Grid.Column="1" Stroke="Black" X2="500" Fill="Black" VerticalAlignment="Center" />
                        </Grid>
                    </DataTemplate>
                </GroupStyle.HeaderTemplate>
            </GroupStyle>
        </ListView.GroupStyle> 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-25T02:18:14.893

如果您正在寻找这样的东西：

[![WPF 总和分组](https://i.stack.imgur.com/qi3q6.png)](https://i.stack.imgur.com/qi3q6.png)
[（来源：[bendewey.com](http://www.bendewey.com/code/GroupingSum.png)）]

然后，您可以将 ContainerStyle 的 Template 属性用于 GroupStyle。在此示例中，我使用 DockPanel，您提供的 Grid 停靠在底部，而 ItemsPresenter 填充其余部分。此外，为了获得项目总数，您必须使用底部提供的转换器。

## 窗口.xaml

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Class="WpfApplication1.Window3"
    x:Name="Window"
    Title="Window3"
    xmlns:local="clr-namespace:WpfApplication1"
    Width="640" Height="480">
    <Window.Resources>
        <local:MyDataSource x:Key="MyData" />
        <CollectionViewSource x:Key="ViewSource" Source="{Binding Source={StaticResource MyData}, Path=Users}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Country" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>
    <Grid x:Name="LayoutRoot">
      <ListView ItemsSource="{Binding Source={StaticResource ViewSource}}">
        <ListView.GroupStyle>
            <GroupStyle>
                <GroupStyle.ContainerStyle>
                    <Style TargetType="{x:Type GroupItem}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type GroupItem}">
                                      <DockPanel>
                                        <Grid DockPanel.Dock="Bottom">
                                            <Grid.Resources>
                                                <local:TotalSumConverter x:Key="sumConverter" />
                                            </Grid.Resources>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Grid.Column="0" Text="Total: " FontWeight="Bold"/>
                                                <TextBlock Grid.Column="0" Text="{Binding Path=Name}" />
                                            </StackPanel>
                                            <Line Grid.Column="1" Stroke="Black" X2="500" Fill="Black" VerticalAlignment="Center" />

                                            <TextBlock Grid.Row="1" Grid.Column="1" HorizontalAlignment="Right" Text="{Binding Path=Items, Converter={StaticResource sumConverter}}" />
                                        </Grid>
                                    <ItemsPresenter />
                                </DockPanel>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </GroupStyle.ContainerStyle>
            </GroupStyle>
        </ListView.GroupStyle>
        <ListView.View>
           <GridView>
            <GridViewColumn Width="140" Header="Name" DisplayMemberBinding="{Binding Name}"/>
            <GridViewColumn Width="140" Header="Phone Number" DisplayMemberBinding="{Binding Phone}"/>
            <GridViewColumn Width="140" Header="Country" DisplayMemberBinding="{Binding Country}" />
            <GridViewColumn Width="140" Header="Total" DisplayMemberBinding="{Binding Total}" />
           </GridView>
          </ListView.View>
      </ListView>

    </Grid>
</Window> 
```

## 我的数据源.cs

```
public class MyDataSource
{
    public ObservableCollection<User> Users { get; set; }

    public MyDataSource()
    {
        Users = new ObservableCollection<User>();
        LoadDummyData();
    }

    private void LoadDummyData()
    {
        Users.Add(new User()
        {
            Name = "Frank",
            Phone = "(122) 555-1234",
            Country = "USA",
            Total = 432
        });

        Users.Add(new User()
        {
            Name = "Bob",
            Phone = "(212) 555-1234",
            Country = "USA",
            Total = 456
        });

        Users.Add(new User()
        {
            Name = "Mark",
            Phone = "(301) 555-1234",
            Country = "USA",
            Total = 123
        });

        Users.Add(new User()
        {
            Name = "Pierre",
            Phone = "+33 (122) 555-1234",
            Country = "France",
            Total = 333
        });

        Users.Add(new User()
        {
            Name = "Jacques",
            Phone = "+33 (122) 555-1234",
            Country = "France",
            Total = 222
        });

        Users.Add(new User()
        {
            Name = "Olivier",
            Phone = "+33 (122) 555-1234",
            Country = "France",
            Total = 444
        });
    }
} 
```

## 用户.cs

```
public class User
{
    public string Name { get; set; }
    public string Phone { get; set; }
    public string Country { get; set; }
    public double Total { get; set; }
} 
```

## TotalSumConverter.cs

```
public class TotalSumConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var users = value as IEnumerable<object>;
        if (users == null)
            return "$0.00";

        double sum = 0;

        foreach (var u in users)
        {
            sum += ((User)u).Total;
        }

        return sum.ToString("c");
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new System.NotImplementedException();
    }
} 
```

# lucene.net - Lucene.net 和 3.5

> ID：678695
> 
> 赞同：4
> 
> 时间：2009-03-24T18:48:00.077
> 
> 标签：lucene.net

在针对 lucene.net 的 2.0 构建构建 3.5 应用程序时，是否有任何特殊注意事项需要注意？

我发现有几个人会发布他们的 lucene 项目文件，但不确定这是否是正确的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T02:38:14.577

Lucene.NET 端口并不是真正的 .NET。它确实是 Java Lucene 项目的准确移植。这意味着诸如搜索结果之类的东西不实现 IEnumerable<T> 而是实现了一个丑陋的 Java 迭代器，需要 Close() 的对象不实现 IDisposable，应该是枚举的值是公共字段，其他丑陋。

尽管如此，我们还是对 Lucene 的性能和一般可配置性感到非常满意。它可以做任何你想让搜索引擎做的事情。

您还应该了解[Linq-to-Lucene](http://www.codeplex.com/linqtolucene)，这是一个 .NET 3.5 项目，可让您使用 LINQ 语法查询 Lucene（而不是必须学习特定于域的 Lucene 查询语法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:03:06.763

我已经在 .NET Framework 3.5 应用程序中使用 Lucene.NET 一个月左右，没有出现任何问题。

# c++ - 关于 C++ 中的 exit() 函数

> ID：678696
> 
> 赞同：1
> 
> 时间：2009-03-24T18:48:36.207
> 
> 标签：c++, exit, turbo-c++

getche() 函数没有正确终止程序，所以我想尝试 exit(int status) 函数。它在 Turbo C++ 编程语言中是如何工作的？我无法理解相关帮助模块中的解释，我寻求更好的解释……例如，函数的参数由什么组成？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:54:21.480

不是 100% 确定你的意思。退出函数的参数（“int status”）是一个返回给 shell 的数字。传统上，如果您的程序成功，则该值为 0；如果程序由于某种原因失败，则该值为 >0。该功能将清理各种东西，然后退出您的程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T19:14:09.593

出色地。`getch..`像通常从键盘或标准输入中获取字符的函数。它们有时在这样的程序结束时使用

```
int main() {
    // do many stuff...
    // ...
    getch(); 
} 
```

getch/getche（我不知道 turbo-c++ 中的 e 代表什么）然后用于在终端窗口关闭（通常发生在窗口中）之前为用户提供更改以查看程序的输出。请注意，`getchar`在 C 和 C++ 中调用了一个可移植函数，它也可以完成这项工作（另外还等待输入，但这不会造成伤害）。

但它不用于终止程序。按下一个键后，控制继续，然后在 main 完成后，程序存在。C++ 和最近的 C 版本`return 0;`在主函数的最后一条语句之后隐式插入一个（0 代表“成功”）。这意味着您的 main 函数将返回值`0`返回给操作系统。但是，如果您明确编写返回值并将另一个值放在那里，则可以返回其他值。该值是`exit`预期的。它终止您的程序，并将给定的值返回给操作系统。

```
int main() {
    // some stuff...
    exit(42);
    // other stuff (note: never reached!)
} 
```

该程序将向操作系统返回值 42。通常你就`return 42;`在那里，它具有相同的效果（*）。

* * *

(*) 好吧，不完全是：如果你有局部变量，那么如果你使用`exit`. 但是它们被彻底破坏了，并且在您使用时会调用析构函数`return n;`。因此，尽可能选择`return n;`主要。exit 在除 main 之外的其他函数中调用也会终止您的程序，因此可能需要使用它，因为 return there 只会从这些特定函数返回并且根本不会终止程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T18:57:39.820

Exit() 的参数是一个 int，表示退出进程的原因或状态。

男孩，听起来不太好。让我再试一次：这是一个传递回启动进程（使用 CreateProcess() 或 ShellExecute() 来启动正在退出的进程的进程）的值，或者在控制台应用程序的情况下传递给可以通过 ERRORLEVEL 访问的命令 shell。

如果您正常退出，通常设置 status = 0，另一个值（如果您想要接收它的进程可能有意义）来指示错误或问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T18:50:54.203

该参数是一个整数状态代码，它作为进程的退出状态传递回调用 shell。退出本身应该退出进程并清理您的进程正在使用的所有打开的资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T06:43:34.630

该参数是一个整数状态代码，它作为进程的退出状态传递回调用 shell。退出本身应该退出进程并清理您的进程正在使用的所有打开的资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T07:21:24.087

有关“退出”功能的更多信息

“exit”函数正常终止进程，执行定期清理以终止进程。

首先，通过调用“atexit”注册的所有函数都按照注册的相反顺序执行。然后，关闭所有流并删除临时文件，最后将控制权返回给宿主环境。

作为退出参数提供的值作为程序的返回码或退出码返回给操作系统（主机环境）。按照惯例，返回码为零表示程序成功完成。

希望这可以消除您的疑问。

# c# - .Net RegularExpressionValidator 匹配不同于 Regex 类

> ID：678698
> 
> 赞同：4
> 
> 时间：2009-03-24T18:49:39.870
> 
> 标签：c#, .net, asp.net, regex

当我使用 .Net RegularExpressionsValidator 控件时，验证表达式与 EXACT 文本匹配。当我这么说时，我的意思是，对于我给它验证的字符串，如果它完全偏离正则表达式模式，则字符串不会验证。

**例如：** (([0-1][0-9])|([2][0-3])):([0-5][0-9]) 如果在 RegularExpressionsValidator 控件中给出，则仅匹配字符串like -> 12:00, 07:15, 23:59 但不匹配字符串 12:00foo, bar23:00, foobar。

现在，当我在后面的代码中使用 Regex 类并为其提供相同的正则表达式时，它会匹配所有包含匹配项和任何其他字符的字符串。

**例如：（**使用与上一个示例相同的正则表达式）如果我使用 Regex 类，则以下字符串将匹配 -> 12:00、07:15、23:59 AND 12:00foo（包含匹配项）、bar23:00 （包含匹配）。

是否有理由对它们进行不同的处理，是否有办法模仿与 RegularExpressionValidator 控件相同的行为？

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T18:51:08.073

正在发生的事情是正则表达式验证器将您的字符串作为一行文本处理。它隐式地将 ^ 和 $ 匹配器放在正则表达式的开头。

这就像在说：

```
^(([0-1][0-9])|([2][0-3])):([0-5][0-9])$ 
```

上面的表达式`Regex Class`将产生与验证器控件相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:54:04.447

让正则表达式精确匹配字符串的一种简单、通用的方法是强制它从字符串的开头匹配到结尾，如下所示：

```
^pattern$ 
```

# flash - 逆向工程闪存

> ID：678702
> 
> 赞同：12
> 
> 时间：2009-03-24T18:50:56.887
> 
> 标签：flash, reverse-engineering

我有一些 Flash SWF 文件，我需要了解它们是如何工作的。他们有什么好的工具可以对 SWF 文件进行逆向工程吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T18:57:11.707

[用Flasm](http://www.nowrap.de/flasm.html)拆解 SWF 。

注意：不幸的是，仅适用于 flash 8 或更早版本。

[SWFTools](http://www.swftools.org/about.html)可能还会为您提供有关 SWF 文件的一些信息。它们似乎是最近的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-12T12:28:07.310

作为经常使用 SWF 文件格式和 ActionScript 2 和 3 字节码的人，我强烈推荐[ASV](http://www.buraks.com/asv)。与其他反编译器不同，它旨在查看 SWF 文件，而不仅仅是将它们转换为 FLA。

此外，您还需要阅读以下文件：

[SWF 文件格式规范 v10](http://www.adobe.com/content/dam/Adobe/en/devnet/swf/pdf/swf_file_format_spec_v10.pdf)

[AVM2 概述](http://www.adobe.com/content/dam/Adobe/en/devnet/actionscript/articles/avm2overview.pdf)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T19:10:28.650

我讨厌给出“只是谷歌它”的答案，但如果你[知道要使用什么术语](http://www.google.com/search?q=flash+decompiler&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)，它真的就这么简单。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-05T09:09:29.480

FWIW：我创建了一个[ActionScript 3（反）汇编器](http://blog.thecybershadow.net/2010/05/05/announcing-rabcdasm/)（它允许您组装回修改后的代码，即使是混淆文件）。它在功能上与 flasm 相似，但它针对 AVM（用于较新的 Flash 版本），并直接使用 AS 字节码而不是整个 SWF 文件。要编辑文件的其余部分，您可以使用[SWiX](http://www.swixkit.com/)等工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T01:21:37.087

除了获取 Flash 反编译器之外，您可能还需要阅读[SWF 文件格式规范](http://www.adobe.com/devnet/swf/)文档。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-09T03:06:11.407

我个人使用[Trillix 的 Flash 反编译器](http://www.flash-decompiler.com)。它完成了我希望它完成的工作。但它是付费软件，我一遍又一遍地使用演示版（我每年只使用 10 次）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-15T16:42:32.887

我在[http://www.ave-imperator.com/与 AVE Imperator 合作非常幸运](http://www.ave-imperator.com/)

它甚至帮助我获得了与里面的元素一起工作的动作脚本。它也有不止一种反编译方法，因此您通常可以调整反编译方式以获得所需的内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-24T03:15:35.917

[Sothink Flash Decompiler](http://www.sothink.com/product/flashdecompiler/download.htm) 也相当不错，并且在[CNET 的](http://download.cnet.com/Sothink-SWF-Decompiler-Flash-Decompiler/3000-6676_4-10073491.html)下载反编译器列表中表现不错。

# tsql - sql变量

> ID：678703
> 
> 赞同：1
> 
> 时间：2009-03-24T18:51:06.200
> 
> 标签：tsql, variables

有人可以帮我弄清楚为什么 sql 语句不喜欢下面的行 ' 和 ' + @SearchCat + 'like '%'+@Keywords+'%''。它与单引号的数量有关，但我无法弄清楚。引号是如何工作的。逻辑是什么？

```
DECLARE @strStatement varchar(550) 
declare @state as varchar(50)
declare @district as varchar(50)
declare @courttype as varchar(50)
declare @SearchCat as varchar(50)
declare @KeyWords as varchar (50)

select @State ='FL'
select @district = '11'
select @courtType = '1'
select @SearchCat='CaseNumber'
select @KeyWords='File'

select @strStatement= 'SELECT CaseNumber FROM app_Case 
            where State ='''+ @State+
            ''' and District='''+ @District+
            ' and ' + @SearchCat + 'like '%'+@Keywords+'%''

exec (@strStatement) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T20:10:51.717

> 我在“喜欢”之前缺少一个空格

您的 '%' 字符周围的单引号数量也错误，这会使它感到困惑。

顺便说一句，您已经从 SQL 本身内部给自己制造了一个不错的小[SQL 注入安全漏洞！](http://en.wikipedia.org/wiki/SQL_Injection)如果其中一个参数包含撇号，则您的 sqlStatement 将中断，并且将执行参数名称中的任何恶意 SQL。

您可以使用 REPLACE 函数将单引号加倍以防止这种攻击：

```
' AND '+QUOTENAME(@SearchCat)+' LIKE ''%'+REPLACE(@Keywords, '''', '''''')+'%''...' 
```

（如果列名包含带外字符或者是保留字，则需要 QUOTENAME。）

[生成 SQL 的一种更简洁（但相当冗长）的方法是使用sp_executesql](http://msdn.microsoft.com/en-us/library/ms188001.aspx)，而不是自己繁琐地替换每个字符串文字。例如：

```
SELECT @strStatement= N'
    SELECT @Number= CaseNumber FROM app_Case 
    WHERE State=@State AND District=@District
    AND '+QUOTENAME(@SearchCat)+N' LIKE ''%''+@Keywords+''%''
';
SELECT @params= N'@State varchar(50), @District varchar(50), @Keywords varchar(50), @Number int OUTPUT';

EXECUTE sp_executesql @strStatement, @params, @State, @District, @Keywords, @Number OUTPUT; 
```

顺便说一句，如果 @searchCat 只能有少量不同的值，您可以使用一种变通方法来避免任何这种费力的动态 SQL 废话：

```
SELECT CaseNumber FROM app_Case
WHERE State=@State AND District=@District
AND CASE @searchCat
    WHEN 'searchableColumnA' THEN searchableColumnA
    WHEN 'searchableColumnB' THEN searchableColumnB
END LIKE '%'+@Keywords+'%'; 
```

有关更多背景知识和您面临的一些风险，请参阅[这篇](http://www.sommarskog.se/dynamic_sql.html)对 T-SQL 中动态创建的 SQL 语句的相当好的探索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:57:35.483

我想通了。我在“喜欢”之前缺少一个空格

# svn - 为什么 git-svn 不使用 Subversion 存储库 UUID 而不是它的 URL

> ID：678710
> 
> 赞同：3
> 
> 时间：2009-03-24T18:52:30.673
> 
> 标签：svn, git-svn

重新定位 Subversion 存储库的 git-svn 镜像并非易事：

[git-svn：相当于`svn switch —relocate`什么？](https://stackoverflow.com/questions/268736/git-svn-whats-the-equivalent-to-svn-switch-relocate)

那么为什么 git-svn 不使用存储库的 UUID 而不是它在 git-svn-id 中的 URL 呢？UUID 唯一标识存储库，因此它似乎是一个自然的标识符，并且可以更轻松地处理重定位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-29T20:54:24.733

git wiki 有答案，请使用此处记录的第一种方法：

[https://git.wiki.kernel.org/index.php/GitSvnSwitch](https://git.wiki.kernel.org/index.php/GitSvnSwitch)

我刚刚在测试仓库中对其进行了测试，它似乎可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T12:34:33.800

我没有你的问题的答案，但 git-svn 使用 repo UUID*以及*URL。两者都必须是正确的 git-svn 不打印`Unable to determine upstream SVN information from working tree history`。我真的希望它会输出类似“repo UUID 不匹配”之类的东西，因为我花了几个小时试图弄清楚这一点......

# javascript - 防止网页在表单提交时滚动到顶部

> ID：678711
> 
> 赞同：4
> 
> 时间：2009-03-24T18:52:35.790
> 
> 标签：javascript, forms, submit

我正在通过锚标记和 javascript 提交表单。

```
<a onclick="submit_form();">Submit</a> 
```

单击按钮后，页面立即滚动到页面顶部并继续正常的表单提交过程。

如何防止页面滚动到顶部，为什么要这样做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T18:55:45.363

将您的 OnClick 事件更改为在 HREF 中。

```
<a href="JavaScript:submit_form();">Submit</a> 
```

或者返回 False 以便它不会继续处理点击

```
<a onClick="submit_form(); return false;">Submit</a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T18:54:36.083

你可以在表格中有一个名字锚

```
<a name="name"></a>
<form action="example.html#name"> 
```

这样做是因为表单提交是一个新的页面请求。

# c# - 为什么单身人士被认为是一种不好的做法？

> ID：678713
> 
> 赞同：0
> 
> 时间：2009-03-24T18:52:56.103
> 
> 标签：c#, asp.net

### 复制：

> [单身人士有什么不好的？](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)

我正在阅读[这个](https://stackoverflow.com/questions/678669/concurrency-asp-net-best-practises-worst-practises)问题，并且惊讶地发现（s）他认为单身人士被认为是“不好的做法”，并且实际上认为这是常识。

在任何使用 iBatis 从 XML 加载查询的项目中，我都大量使用了单例。在这些情况下，它极大地提高了速度。我不确定为什么你不会在这种情况下使用它们。

那么......为什么他们不好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T18:56:21.960

它们不一定是坏的，只是被滥用和过度使用。人们似乎莫名其妙地被这种模式所吸引，并寻找新的和创造性的方法将其硬塞到他们的应用程序中，无论它是否真的适用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T18:57:03.173

它们是一种工具，就像任何工具一样，有时你应该使用它们，有时你应该使用其他东西。在这种情况下，在乍一看似乎适合单例的情况下，其他东西（工厂、静态类）通常会更好。

当`Design Patterns`它出来的时候，似乎每个人都加入了 Singleton 的潮流——他们无处不在，甚至是他们不应该去的地方。你现在看到的是（也许是当之无愧的）强烈反对。并不是说您根本不应该使用它们，但退后一步并查看所有可用选项可能是个好主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T18:57:01.350

单身人士一点也不坏。事实上，它们在许多情况下都非常有用。但他们确实有两个成熟的滥用和/或失败的主要领域：

*   单元可测试性
*   多线程

两者都可以处理，但初学者经常忽略这样做（通常是由于无知），最终造成的麻烦比他们知道如何处理要多得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T18:57:20.553

它们不一定是坏的，它往往被过度使用，并且在不需要时使用了很多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T18:57:54.623

它们通常与单元测试一起被认为是不好的。

如果你有一个单例，这意味着你的一个或多个类在某些方法的某个地方使用它。这是在对类进行单元测试时无法欺骗的依赖项，因为该类直接使用它，而无需通过其构造函数或属性请求它。

这就是人们通常说他们“坏”的原因。

此外，在多线程应用程序中，很多人对它们的实现非常糟糕，以至于有可能多次调用实例化。

# c# - 在 C# 中管理 COM 对象

> ID：678723
> 
> 赞同：2
> 
> 时间：2009-03-24T18:54:31.917
> 
> 标签：c#, com, interop, kill

我有一个从 C# 调用的 ATL COM exe。我将引用导入到 C# 中，一切正常，生成了 exe，我可以在其上调用函数。现在，我实例化了其中几个 COM 对象。偶尔其中一个会挂起。释放 COM 对象没有任何作用，因为它仍在运行。我无法终止该过程，因为然后我会丢失所有其他表现良好的对象。所以，

1.  有没有办法真正杀死一个人？
2.  有没有办法为每个请求的 com 对象启动一个 exe？
3.  如果我的客户端意外退出，COM exe 永远不会被清理。有没有什么办法解决这一问题？

理想情况下，我将能够为每个对象实例启动一个 COM exe，并能够对其进行 Process.Kill()。是否可以选择其中任何一个？下面是我用来创建对象的类，在这种情况下，RandomID()（人为地）需要很长时间才能返回。另外，如果有办法用另一种语言做到这一点，我也愿意尝试一下。谢谢。

```
public class MyComObject:IDisposable
{
    private bool disposed = false;
    MyMath test;

    public MyComObject()
    {
        test = new MyMath();
    }

    public double GetRandomID()
    {
        if (test != null)
            return test.RandomID();
        else
            return -1;
    }

    public void Dispose()
    {
        Dispose(true);

        GC.SuppressFinalize(this);
    }

    private void Dispose(bool disposing)
    {
        if (!this.disposed)
        {
            if (test != null)
                Marshal.ReleaseComObject(test);

            disposing = true;
        }
    }
} 
```

编辑：看起来如果我可以将其设置为“单次使用”，一切都会按我的意愿工作。但是，我找不到在 VS 2008 中设置此选项的位置

编辑：在谷歌群组上找到答案

```
class CMathServerModule : public CAtlExeModuleT< CMathServerModule >
   {

    public :
   DECLARE_LIBID(LIBID_MathServerLib)
   DECLARE_REGISTRY_APPID_RESOURCEID(IDR_MATHSERVER, "{2FA977F0-050C-4010-A09F-4FE6D75F3024}")
   HRESULT RegisterClassObjects(DWORD dwClsContext, DWORD dwFlags) 
   throw() 
    { 
        dwFlags = ((dwFlags & ~(REGCLS_MULTIPLEUSE | REGCLS_MULTI_SEPARATE )) | 
                REGCLS_SINGLEUSE); 
        return CAtlExeModuleT<CMathServerModule>::RegisterClassObjects(dwClsContext, dwFlags); 
    } 
   }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T19:00:55.600

当对象挂起时会发生什么？即你怎么知道它挂了？

它可能挂起的原因有很多，但其中一个是系统中某处的线程已初始化 COM，但未发送 Windows 消息。

你控制 COM 服务器 exe 的源代码吗？它作为 DLL 服务器可能要简单得多，因此您可以在进程中加载​​它，而这些问题都不存在。

**更新：**

鉴于评论中的信息，您正在使用 COM exe-remoting 来解决 32/64 位 thunking 的问题。

我对 COM exe 服务器的体验非常糟糕。COM DLL 是非常简单的东西，COM exe 是非常复杂且不可靠的东西。它们可以正常工作 - 只是 - 在一些交互式 GUI 场景中。

但是你可能会更好地推出自己的 IPC 机制，这听起来很奇怪。其实没那么难。假设 64.exe 创建了一个监听套接字，它还维护了一个 32.exe 进程的句柄，按需创建它。它可以随心所欲地创造尽可能多的或尽可能少的，并随心所欲地杀死它们。当 32.exe 启动时，它会连接到套接字并读取它——这就是它开始工作的方式。64.exe 通过接受的套接字连接发送指令，它与相应的进程句柄一起存储。

这样做的好处是，如果 64.exe 突然死掉，32.exe 会在读取套接字时出错，并且知道也会死掉。

您通过套接字发送的内容的格式可以非常简单。计数缓冲区是理想的（发送长度，然后是那么多字节的数据）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:42:47.293

我不知道这是否是答案，但您的 Dispose 方法中的代码将 disposing 设置为 true，而不是 dispose。它允许多次调用 ReleaseComObject。

我会设置为true，然后看看你是否有同样的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T21:46:01.693

我开发了一些服务导出 COM 接口并且没有问题，这是在服务器池中运行的。
我的建议是尝试使用 WinDbg 监控您的应用程序，编译包含调试信息的代码并一起安装 pdb 文件。

# memory - 低级编程：如何在另一个正在运行的进程的内存中查找数据？

> ID：678728
> 
> 赞同：4
> 
> 时间：2009-03-24T18:55:33.990
> 
> 标签：memory, assembly, process, reverse-engineering, low-level

我正在尝试通过从游戏的进程内存中提取值来为游戏编写统计工具（因为没有其他方法）。最大的挑战是找出存储我感兴趣的数据所需的地址。更难的是动态内存分配——我不仅需要找到存储数据的地址，还需要找到指向这些内存块的指针，因为每次游戏重新启动时地址都会发生变化。

现在我只是使用内存编辑器（ArtMoney）手动搜索游戏内存，并寻找随着数据变化（或不变化）而改变其值的地址。找到地址后，我正在寻找一个以类似方式指向该内存块的指针。

我想知道这些任务有哪些技术/工具？也许有一些我可以阅读的文章？掌握反汇编程序是唯一的出路吗？例如，游戏培训师正在解决类似的任务，但他们在几天内就完成了，而我已经苦苦挣扎了好几个星期。

谢谢。

PS。一切都在窗户下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T04:37:37.880

> 掌握反汇编程序是唯一的出路吗？

是的; [从http://www.microsoft.com/whdc/devtools/debugging/default.mspx](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)下载 WinDbg ，或者如果你有一些钱要花，IDA Pro 可能是最好的工具

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T04:46:22.213

你可以看看[DynInst](http://www.dyninst.org/) (Dynamic Instrumentation)。特别是查看[动态探针类库 (DPCL)](http://www.dyninst.org/tools.html)。这些工具将允许您通过调试器接口附加到正在运行的进程，并在它们运行时将您自己的工具（通过特殊的探针类）插入其中。您可能会使用它来检测访问数据结构的例程，并在创建或修改您感兴趣的值时进行跟踪。

以这种方式执行此操作可能比手动执行所有操作更容易。这些页面上有很多论文，您可以查看其他人如何构建类似的工具。

我相信 Windows 支持得到维护，但我自己没有使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T04:29:53.577

如果您知道如何用 C 编写代码，则很容易搜索内存值。如果您不懂 C，如果您可以使用 C# 编写代码，此[页面](http://www.codeproject.com/KB/trace/minememoryreader.aspx)可能会为您提供解决方案。将他们拥有的 C# 移植到 Java 并不难。

# c# - .Net Excel 互操作删除工作表

> ID：678736
> 
> 赞同：29
> 
> 时间：2009-03-24T18:56:35.813
> 
> 标签：c#, .net, excel, interop

我正在尝试使用互操作 Excel 类（对于 excel 2003）从 .Net c# 3.5 应用程序的 excel 文档中删除工作表。

我尝试了很多事情，例如：

```
Worksheet worksheet = (Worksheet)workbook.Worksheets[1];
worksheet.Delete(); 
```

它不起作用，也不会引发任何错误......

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-24T19:09:44.610

经过一个多小时的寻找，我找到了答案：

```
xlApp.DisplayAlerts = false;
worksheet.Delete();
xlApp.DisplayAlerts = true; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-07-01T14:53:11.077

在处理删除*Excel Worksheets*时，需要了解两件重要的事情：

1.  Excel 互操作从 1 开始计数（而不是从零开始），因此，删除第二项将导致第三项取而代之！。因此，删除工作表的正确方法是从**最后一个到第一个**：

    ```
    // Remove LAST worksheet
    MyWorkBook.Worksheets[3].Delete();

    // and only then remove the second (which is the last one)
    MyWorkBook.Worksheets[2].Delete(); 
    ```

    或者，您可以删除列表中的第二项 ([2])**两次**，这将为您提供相同的结果。

2.  当您只剩下一个工作表时，以下行将**引发异常：**

    ```
     MyWorkBook.Worksheets[1].Delete(); 
    ```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-28T21:30:48.740

同样重要的是要注意工作簿必须至少包含一个工作表；这意味着您不能删除工作簿中的所有工作表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-20T05:26:12.263

```
Microsoft.Office.Interop.Excel.Worksheet worksheet = Microsoft.Office.Interop.Excel.Worksheet)xlWorkBook.Worksheets[1];
worksheet.Delete(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-04-29T08:00:21.220

尝试按名称查找工作表：

```
var app = new Microsoft.Office.Interop.Excel.Application();
var workbook = app.Workbooks.Add();
((Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets["Sheet3"]).Delete(); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-06-22T10:24:49.133

我们从 ac# 控制台应用程序中删除 excel 工作表，如下所示：

```
 Microsoft.Office.Interop.Excel.Worksheet worksheet = 
 (Worksheet)workbook.Worksheets["Worksheet_Name" (or) "Countings"];
 worksheet.Delete(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-09-07T10:39:33.737

我们可以像这样删除工作表

```
 Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();

                if (xlApp == null)
                {

                    return;
                }

                xlApp.DisplayAlerts = false;
                string filePath = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location)
                                        + "\\Sample.xlsx";
                Excel.Workbook xlWorkBook = xlApp.Workbooks.Open(filePath, 0, false, 5, "", "", false, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, "", true, false, 0, true, false, false);
                Excel.Sheets worksheets = xlWorkBook.Worksheets;

                worksheets[4].Delete();
                worksheets[3].Delete();
                xlWorkBook.Save();
                xlWorkBook.Close();

                releaseObject(worksheets);
                releaseObject(xlWorkBook);
                releaseObject(xlApp); 
```

并使用它

```
 static void releaseObject(object obj)
        {
            try
            {
                System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
                obj = null;
            }
            catch (Exception ex)
            {
                obj = null;
                throw ex;

            }
            finally
            {
                GC.Collect();
            }
        } 
```

# apache-flex - 用 OS Native Scrollbar 替换 ScrollPane Scrollbar

> ID：678742
> 
> 赞同：1
> 
> 时间：2009-03-24T18:57:00.133
> 
> 标签：apache-flex, flash, actionscript-3, flex3

有没有一种简单的方法可以用操作系统的本机滚动条替换 ScrollPane 滚动条？

如果 Flash 应用程序具有与用户操作系统相同的皮肤，则它们看起来更加集成——这并不总是容易检测（Vista Aero 与 Classic？）。

你们有没有遇到过这样的 Flash 应用程序示例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T20:25:08.737

设置这样的东西将是一项大而肮脏的工作。如果您非常关心操作系统外观集成，那么您最好使用本机浏览器控件而不是 Flash 或其他插件。

可以说，您可以将您的 Flash 应用程序分解为单独的 SWF 模块，并将它们中的每个模块放入页面中它们自己的滚动 div 或 iframe 中。然后，您必须通过 ExternalInterface 或 LocalConnection 进行通信才能在 SWF 之间传递数据。就个人而言，我只愿意将其作为对自己的技术挑战来尝试，但我怀疑这是否值得为生产应用程序付出努力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-30T04:05:16.430

出于好奇，我们将滚动窗格组件分离成一个独立的 swf，并在小部件的右侧和底部放置一组两个嵌套的 div。

以垂直滚动条为例，外部 div 被设置为滚动窗格的高度，并且有一个`overflow-x`CSS和`hidden`一个`overflow-y`。`auto`然后将子 div 设置为任意宽度，高度等于滚动窗格内容的 px 高度。

浏览器将显示一个适当大小的“滚动手柄”，我们可以快速读取外部 div 上的垂直滚动偏移量，以了解 Flash 滚动窗格的偏移量。相同的技术，经过适当的修改，被用于水平滚动条。

我们还包括一些逻辑来根据容器的溢出自动隐藏容器。结果与本机操作系统行为非常接近。

While this may sound like a huge hack, we were able to widely deploy the solution ([scribd.com](http://scribd.com "Scribd.com")) without any major issues.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:22:23.877

讨厌这么说，但没有办法做到这一点。您可以使用受操作系统启发的皮肤/主题，但即便如此，用户也有可能使用自定义颜色、大小等修改其外观设置。

# php - php fopen 不打开文件，它的读取权限没有授予世界/公众？

> ID：678751
> 
> 赞同：0
> 
> 时间：2009-03-24T18:57:46.840
> 
> 标签：php, file, file-permissions

如果文件权限为440，则php fopen无法打开文件进行读取。我不想给文件444权限，这样就无法通过URL直接访问它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T19:01:32.820

假设您将 Apache 与 PHP 一起使用，解决此问题的最简单方法是使用 Apache 限制对文件的访问，但允许全局读取访问。这样做的方法是将所有你想要禁止的文件保存在它们自己的目录中，并在 .htaccess 文件中放置：

```
Order Allow , Deny
Deny from all 
```

现在您可以拥有全局读取权限，但如果您尝试直接从 Web 访问该文件，您将收到 Permission Denied 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:41:38.573

您可以按照*tj111 的*建议进行操作，使用 .htaccess 阻止它。

但更好的主意是将其放在 www 根目录之外。

例如，如果您的 PHP 文件位于**/home/ *user* /public_html/**中，则将您的文件以有限的访问权限放置在 **/home/ *user* /includes**中，给它们 644 ( `rw-r--r--`)。`rwx--x--x`您可以将目录权限限制为 711（不过，这并不妨碍您使用 PHP 读取或包含这些文件。

# sharepoint - 如何将来自多个员工博客的条目合并到一个 RSS 提要中

> ID：678760
> 
> 赞同：5
> 
> 时间：2009-03-24T19:00:52.247
> 
> 标签：sharepoint, rss

我们当前的 SharePoint 环境将 Mysites 设置为用户创建博客的单独网站集。单独了解这些博客是一个真正的挑战，我通常在第一次访问时获取 RSS 提要，然后从 Outlook 中订阅。为了帮助非技术人员，我们希望能够将我们门户上的一些顶级（常规）博主的条目整合到一个单一的提要中，然后可以使用该提要从 Outlook 订阅或显示在门户的页面上。

任何关于如何解决这个问题的想法都将不胜感激。感谢您的宝贵时间，祝您有美好的一天。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T13:22:25.547

我会将这些顶级提要合并到一个[OPML](http://en.wikipedia.org/wiki/OPML)文件中。这是一个[很好的例子](http://www.scripting.com/feeds/top100.opml)。[Outlook](http://office.microsoft.com/en-us/outlook/HA012299401033.aspx) 2007 可以对其进行解析并将其添加为提要的集合。

您还可以编写一个快速 Web 部件来解析 OPML 文件并从每个提要下载前*n个帖子。*Sahil Malik 已经完成了这项艰巨的工作，您可以使用他的[示例](http://blah.winsmarts.com/2006-7-Sharepoint_Webparts_AS_-_Writing_the_WebParts_-_The_OPMLEditor_WebPart.aspx)作为起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T19:08:17.360

**编辑 - 如果您的提要不公开，这将不起作用。

[http://pipes.yahoo.com/pipes/](http://pipes.yahoo.com/pipes/)

> 关于管道
> 
> Pipes 是一个强大的组合工具，用于聚合、操作和混搭来自网络的内容。
> 
> 与 Unix 管道一样，可以将简单的命令组合在一起以创建满足您需求的输出：
> 
> ```
> * combine many feeds into one, then sort, filter and translate it.
> * geocode your favorite feeds and browse the items on an interactive 
> ```
> 
> 地图。* 您网站上的电源小部件/徽章。* 以 RSS、JSON、KML 和其他格式获取任何管道的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T20:32:45.737

我不是 PHP 的粉丝，显然你正在使用一些 MS 产品，但这里有一个 PHP 脚本可以做到这一点。

[http://www.feedforall.com/rssmesh.htm](http://www.feedforall.com/rssmesh.htm)

也许您可以将此作为 asp/asp.net 页面的基础，为您完成此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T01:09:10.987

您需要将文件发布到您的 _layouts 目录，对其进行编码以向用户发送 RSS 提要。也许使用查询字符串来决定从哪些 RSS 提要中读取。

也许从[Eric Shupp 的](http://sharingpoint.blogspot.com/2007/05/sharepoint-2007-rss-aggregator-web-part.html)webpart 开始，然后从那里取得进展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T01:19:00.323

如果您喜欢开源自托管的东西，您可以尝试名为[Planet](http://www.planetplanet.org/)的基于 python 的 webapp 。它具有 RSS 和 html 输出（支持模板）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T18:43:27.840

在此处查看我们的解决方案： [员工博客解决方案剖析](http://community.zevenseas.com/Blogs/Daniel/archive/2008/11/16/anatomy-of-a-sharepoint-solution-blogs-home-screenshots.aspx)

我谈论的是我们是如何实现它的。我们也非常接近将其作为解决方案发布，所以如果您有兴趣，请随时给我发电子邮件 (daniel@zevenseas.com)。或者试试我们的演示：[http ://demo.zevenseas.com](http://demo.zevenseas.com)

# java - 致力于 .NET 解决方案的 Java 开发人员的最佳资源

> ID：678768
> 
> 赞同：0
> 
> 时间：2009-03-24T19:03:03.893
> 
> 标签：java, .net

我公司最近收购了几家公司。我们是一家 Java 商店，但现在同时拥有 VB .NET 和 C# .NET 代码库。我即将开始支持这些系统，但很难找到好的资源来查找 .NET 和 Java 中的相似之处/不同之处。我看过几本书，但不知道该买哪一本，它们看起来基本相同。如果有人知道在线资源而不是将信息隐藏在 700 页的黑白书中，那就太好了。

具体来说，我想找一些比较宏观和微观层面差异的资源。包括“HashMap、ArrayList 和 Queue 的 .NET 等价物是什么”、“我如何与数据库交互”或“ASP 和 JSP 之间有什么区别”之类的内容。

我真的在寻找一些关于哪些资源是最好的来自处于类似情况的人（Java 开发人员到 .NET）的意见。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T19:13:41.917

阅读[这个](http://msdn.microsoft.com/en-us/library/kx37x362.aspx)，最重要的是[编程指南，并为](http://msdn.microsoft.com/en-us/library/67ef8sbd.aspx)[参考](http://msdn.microsoft.com/en-us/library/618ayhy6.aspx)添加书签。

我来自 Java 背景，最近开始使用 C#，发现 MSDN 非常有帮助。自动完成搜索字段经常为我找到我正在寻找的参考页面。

强迫自己学习[LINQ](http://msdn.microsoft.com/en-us/library/bb397676.aspx)。点击后很漂亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:16:26.013

MSDN。说真的，MSDN 很可能是关于 C# 库的具体细节的最佳技术级别的文档。或者，如果您想要更详尽的处理，Jeffrey Richter 的“CLR via C#”确实让您对 CLR 的能力有一个很好的感觉。

# arm - 如何为 ARM 处理器的算法计算 MIPS

> ID：678771
> 
> 赞同：12
> 
> 时间：2009-03-24T19:03:32.707
> 
> 标签：arm, benchmarking

最近有人要求我为我们开发的算法生成 MIPS（每秒百万条指令）。该算法由一组 C 风格的函数公开。我们已经在戴尔 Axim 上运行了代码，以对不同输入下的性能进行基准测试。

这个问题来自我们的硬件供应商，但我主要是一个 HL 软件开发人员，所以我不知道如何回应这个请求。也许具有类似硬件/软件背景的人可以提供帮助...

1.  由于我们的算法不是实时的，我认为我们不需要将其量化为 MIPS。是否可以简单地引用汇编指令的总数？

2.  如果 1 为真，那么一般或专门针对 ARM/XScale，您如何执行此操作（即如何测量汇编指令的数量）？

3.  2 可以在 WM 设备上执行还是通过 VS2005 中提供的 Device Emulator 执行？

4.  3可以自动化吗？

非常感谢你的帮助。查尔斯

* * *

感谢你的帮助。我认为 S.Lott 击中了钉子。作为后续行动，我现在有更多问题。

5 关于如何测量 MIPS 的任何建议？我听说有人建议运行我们的算法并将其与 Dhrystone/Whetstone 基准进行比较以计算 MIS。

6 既然算法不需要实时运行，那么MIPS真的是一个有用的度量吗？（例如阶乘（N））还有哪些其他方法可以量化处理要求？（我已经测量了运行时性能，但这不是一个令人满意的答案。）

7 最后，我假设 MIPS 是一个粗略的估计，并且会是依赖的。关于编译器、优化设置等？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T19:26:07.007

我敢打赌，您的硬件供应商正在询问您需要多少 MIPS。

如“您需要 1,000 MIPS 处理器还是 2,000 MIPS 处理器？”

管理层将其翻译成“多少 MIPS？”

硬件提供 MIPS。软件消耗 MIPS。

你有两个自由度。

*   处理器固有的 MIPS 产品。

*   您消耗那么多 MIPS 的秒数。

如果处理器没有足够的 MIPS，您的算法将“慢”。

如果处理器有足够的 MIPS，你的算法将是“快的”。

我将“快”和“慢”放在引号中，因为您需要有一个性能要求来确定“足够快以满足性能要求”或“太慢而无法满足性能要求”。

在 2,000 MIPS 处理器上，您可能需要可接受的 2 秒。但在 1,000 MIPS 处理器上，这会爆炸到无法接受的 4 秒。

* * *

您需要多少 MIPS？

1.  为您的处理器获取官方 MIPS。见[http://en.wikipedia.org/wiki/Instructions_per_second](http://en.wikipedia.org/wiki/Instructions_per_second)

2.  在一些数据上运行你的算法。

3.  测量准确的运行时间。平均一堆样本以减少不确定性。

4.  报告。750 MIPS 处理器上的 3 秒——嗯—— 750 MIPS 下的 3 秒。MIPS 是一个速率。时间就是时间。距离是速率*时间的乘积。750 MIPS 的 3 秒是 750*3 百万条指令。

记住速率（每秒指令数）* 时间（以秒为单位）为您提供指令。

别说是3*750 MIPS。不是；它是 22.5 亿条指令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T05:56:49.993

一些注意事项：

1.  MIPS 通常用作处理器的一般“容量”度量，特别是在您确实希望确保不会使处理器工作过载的软实时/嵌入式领域。注意这是每秒指令，因为时间很重要！

2.  以这种方式使用的 MIPS 是非常不科学的。

3.  以这种方式使用的 MIPS 通常仍然是用于确定系统大小和确定处理器速度的最佳近似值。它可能会降低 25%，但没关系……

4.  计算 MIPS 需要一个与您正在使用的处理器相近的处理器。正确的指令集显然是至关重要的，它可以从正在使用的实际编译器中捕获实际指令流。

您无法以任何方式在 PC 上近似此值。您需要使用以下工具之一来正确执行此操作：

1.  为目标架构使用指令集模拟器，例如 Qemu、ARM 自己的工具、Synopsys、CoWare、Virtutech 或 VaST。这些速度很快，但可以很好地计算指令，并且支持正确的指令集。除非大量使用诸如整数除法之类的昂贵指令（请不要使用浮点），否则这些数字往往非常接近。

2.  为您的目标处理器（或类似的东西）找到​​一个时钟周期精确的模拟器，它可以很好地估计流水线效果等。再一次，从 ARM 或 Carbon SoCDesigner 获得它。

3.  为您的目标处理器系列或与其设计相近的 ARM 获取开发板，并在那里配置应用程序。您不使用 ARM9 来分析 ARM11，但 ARM11 可能是 ARM Cortex-A8/A9 的一个很好的近似值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T19:21:50.463

[MIPS](http://en.wikipedia.org/wiki/Million_instructions_per_second#Million_instructions_per_second)通常用于衡量处理器的能力。

算法通常采用：

1.  一定的时间（在某个处理器上运行时）
2.  一定数量的指令（取决于架构）

用每秒指令来描述算法似乎是一种奇怪的衡量标准，但我当然不知道你的算法是做什么的。

为了提出一个有意义的衡量标准，我建议您设置一个测试，让您可以衡量完成算法所需的平均时间。组装说明的数量是一个合理的衡量标准，但很难计算它们！你最好的选择是这样的（伪代码）：

```
const num_trials = 1000000
start_time = timer()
for (i = 1 to num_trials)
{
    runAlgorithm(randomData)
}
time_taken = timer() - start_time
average_time = time_taken / num_trials 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:14:30.060

MIPS 是衡量 CPU 速度的指标，而不是算法性能。我只能假设沿线的某个地方，有人有点困惑。他们想知道什么？我能想到的唯一可能的情况是他们试图帮助您确定他们需要多快的处理器才能让您满意地运行您的程序。

由于您可以根据指令数量来衡量算法（这无疑将取决于输入数据，因此这很重要），因此您需要一些时间来获得 MIPS——例如，说“我需要每秒调用它 1000 次”。如果您的算法是针对该特定情况的 1000 条指令，那么您最终会得到：

```
1000 instructions / (1/1000) seconds = 1000000 instructions per second = 1 MIPS. 
```

我仍然认为这是尝试做事的一种非常奇怪的方式，因此您可能想要求澄清。至于您的具体问题，我将把它留给更熟悉 Visual Studio 的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T06:05:23.653

还要记住，不同的编译器和编译器选项会产生巨大的差异。相同的源代码可以以许多不同的速度运行。因此，您可以使用 1/2mips 处理器并使用编译器选项，而不是购买 2mips 处理器。或者把钱花在更好的编译器上并使用更便宜的处理器。

基准测试充其量是有缺陷的。作为一种爱好，我曾经在来自不同供应商的不同编译器上为相同的硬件编译相同的 dhrystone（和 whitstone）代码，并且数字到处都是，数量级。相同的源代码相同的处理器，dhrystone 没有任何意义，作为基线没有用。基准测试中重要的是您的算法运行速度有多快，它最好比它需要的速度快或快。根据距离终点线的距离，您可以允许大量的坡度。早期可能希望比您需要的运行速度快 5 或 10 或 100 倍，以便在项目结束时您至少比您需要的速度快一点。

我同意我认为 S. Lott 所说的，这都是销售、营销和管理方面的谈话。作为管理层介于两者之间的人，那么您需要做的是让他们根据您将要购买的彩色饼图和图表，让他们购买他们愿意花费的最快的处理器和最好的工具凭空产生为正当理由。如果在接近尾声时它不能完全满足性能，那么您可以返回到 stackoverflow，但同时管理层将被迫以几乎任何价格购买不同的工具链或更换处理器并重新旋转电路板。到那时您应该知道您离目标有多近，我们需要 1.0，如果我们购买的处理器速度是我们购买的处理器的两倍，我们应该达到 1.25。

您是否可以自动化这些事情或模拟它们取决于工具，有时是，有时不是。我不熟悉您所说的工具，因此无法直接与他们交谈。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-14T21:20:08.670

此回复并非旨在直接回答该问题，而是提供有关为何提出此问题的更多背景信息。

算法的 MIPS 仅与需要在规定时间内响应事件的算法相关。

例如，考虑一个控制器，该控制器设计用于检测风速并在风速超过 25 英里/小时时在一秒钟内移动执行器。假设需要 1000 条指令来计算风速并将其与阈值进行比较。此算法的 MIPS 要求是每秒 1 千条指令 (KIP)。如果控制器基于 1 MIPS 处理器，我们可以轻松地说控制器中有更多的汁液可以添加其他功能。

控制器上还可以添加哪些其他功能？这取决于要添加的函数/算法的 MIPS。如果有另一个功能需要在一秒钟内执行 100,000 条指令（即 100 KIP），我们仍然可以容纳这个新功能，并且还有一些空间可以添加其他功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T07:13:44.963

对于第一个估计，PC 上的基准可能是有用的。

但是，在您使用特定的设备和时钟频率之前，您应该获得针对 ARM 目标架构的开发板（或一些 PDA？）并在那里对其进行基准测试。

影响当今机器速度的因素有很多（缓存、管道、不同的指令集……），因此您在 PC 上的基准测试可能与 ARM 相差甚远。

# windows - 使用服务器设置强制 IE 在 Word 中而不是在 IE 中打开 Word 文档

> ID：678775
> 
> 赞同：0
> 
> 时间：2009-03-24T19:04:14.547
> 
> 标签：windows, apache, internet-explorer, ms-office

我一直在拼命想弄清楚如何强制 IE 下载并在 Word 中打开 Word 文档，而不是在嵌入 IE 的 Word 窗口中打开。谷歌搜索，我只能找到这样的说明[http://www.shaunakelly.com/word/sharing/OpenDocInIE.html](http://www.shaunakelly.com/word/sharing/OpenDocInIE.html)，它显示了如何在 Windows“文件类型”中配置设置。这很好用，但我无法确保访问我网站的每个人的 Window 设置都相同。

我知道这是可能的，因为当我使用相同的 IE 浏览器从我们公司的网络邮件（或 Gmail）站点下载作为附件发送给我的 Word 文档时，附件总是在 Word 中下载和打开，而不是在 IE 中嵌入的 Word。网络服务器是否发送了某种标题来迫使这种情况发生？

我们使用的是 IE6、Office 2003 和 Windows XP。如果重要的话，该网站正在使用在 Apache 和 mod_wsgi 上运行的 Django。

谢谢！

**更新：**

我添加了以下几行`.htaccess`，现在 IE 直接在 Word 中打开文件。

```
<Files *.doc>
  Header set Content-Disposition attachment
</Files> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T19:13:22.683

您需要将“Content-Disposition”标头添加到响应中并建议要使用的文件名。此示例适用于 Excel，但同样适用于 word，它是浏览器看到的标题，然后在浏览器中显示文件或建议保存文件时对其进行操作。

请参阅此处标题为“使用 HTML 美化您的输出”的部分：

[http://www.aspnetpro.com/NewsletterArticle/2003/09/asp200309so_l/asp200309so_l.asp](http://www.aspnetpro.com/NewsletterArticle/2003/09/asp200309so_l/asp200309so_l.asp)

# c# - 什么时候应该在 C# 中使用 using(...){...}？

> ID：678781
> 
> 赞同：1
> 
> 时间：2009-03-24T19:06:37.940
> 
> 标签：c#

我看到它被使用，我在这里和那里读到它，它与内存管理有关。问题是，你怎么知道什么时候应该使用它？如果不使用会导致问题的变量或实例之间的区别，您如何区分？

**完全重复**：[什么是 C# Using 块，我为什么要使用它？](https://stackoverflow.com/questions/212198/what-is-the-c-using-block-and-why-should-i-use-it)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T19:08:02.400

每当实例化实现 IDisposable 的类的对象时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:08:57.717

using 语句与实现 IDisposable 的类一起使用。using 语句为类的 Disposable 实例提供范围，并在退出范围时调用对象的 Dispose 方法。每当您想要主动释放一些托管资源或在您的托管对象被垃圾收集（或处置）时需要清理非托管资源时，您都可以实现 IDisposable。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:11:12.203

> 它与内存管理有关

并不真地。它与*非托管*资源有关：计算机可以使用的几乎所有东西，*除了*内存。

问题是您不能（好吧：不应该）强制垃圾收集器在特定时间清理您的对象。但是，对于数据库连接、套接字、信号量等资源，您不希望保留它们的时间过长。通常你必须使用 try/finally 构造。该`using`语句只是提供了一个更好的机制来处理这种情况。*只要您有任何*实现该接口的对象，就可以找到一个`using`语句。*`IDisposable`*

 *# visual-studio-2008 - Visual Studio - 脚本内的标记语法高亮显示[type:txt/html]

> ID：678801
> 
> 赞同：8
> 
> 时间：2009-03-24T19:11:04.047
> 
> 标签：visual-studio-2008, syntax-highlighting, markup

有谁知道 Visual Studio 2008 如何或是否可以像 aspx/html 页面上的任何其他标记一样突出显示类型为“text/html”的脚本块中的 html 语法。我正在使用脚本块来容纳我的客户端模板模板。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-06T18:05:44.580

想到两个想法，假设页面本身是 ASP.NET 页面（而不是纯 HTML 页面）：

1.  `script`创建一个发出标签和结束标签的自定义控件。通过使用自定义控件，您将欺骗 IDE 使其不知道`script`标签，因此您将获得与封闭页面的 HTML 相同的语法着色
2.  将脚本块的内容提取到用户控件中，并将该用户控件的实例放置在脚本块中。由于 VS 不知道用户控件的内容将在脚本块内，因此您将获得语法着色。

我更喜欢第一个选项，因为它不会强迫您将页面拆分为多个文件。

如果它是一个纯 HTML 页面，那么没有很多简单的方法可以做到这一点。如果“不容易”是可以的，那么您总是可以创建一个[HttpModule](http://msdn.microsoft.com/en-us/library/ms227673.aspx)来替换源代码（例如`<myscript>`）中的占位符标记，在输出给用户时，使用真实的 text/html 脚本标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T19:54:24.560

如果您添加 Web Tools 2012.2，这现在是 Visual Studio 的一部分：

[http://vswebessentials.com/features/html](http://vswebessentials.com/features/html)

请务必在脚本标签上使用 type="text/html"。

# c# - 动态填充的 TableLayoutPanel 性能下降

> ID：678805
> 
> 赞同：5
> 
> 时间：2009-03-24T19:11:44.793
> 
> 标签：c#, .net, winforms, tablelayoutpanel

我有一个包含 2 列 TableLayoutPanel 的用户控件，并接受命令以动态添加行以显示在单独控件中选择的项目的详细信息。因此，用户将在另一个控件（DataGridView）中选择一行，并在 DataGridView 的 SelectedItemChanged 事件处理程序中清除详细信息控件，然后为新选定项重新生成所有行（可能具有完全不同的详细信息从先前选择的项目中显示）。这在一段时间内效果很好。但是如果我长时间从一个选定的项目移动到另一个，刷新会变得非常慢（每次 3-5 秒）。这听起来好像我没有正确处理所有东西，但我无法弄清楚我错过了什么。这是我清除 TableLayoutPanel 的代码：

```
private readonly List<Control> controls;

public void Clear()
{
    detailTable.Visible = false;
    detailTable.SuspendLayout();
    SuspendLayout();
    detailTable.RowStyles.Clear();
    detailTable.Controls.Clear();
    DisposeAndClearControls();
    detailTable.RowCount = 0;
    detailTable.ColumnCount = 2;
}

private void DisposeAndClearControls()
{
    foreach (Control control in controls)
    {
        control.Dispose();
    }
    controls.Clear();
} 
```

一旦我完成将我想要的所有控件加载到 TableLayoutPanel 中以进行下一个详细显示，这就是我所说的：

```
public void Render()
{
    detailTable.ResumeLayout(false);
    detailTable.PerformLayout();
    ResumeLayout(false);
    detailTable.Visible = true;
} 
```

我在 TableLayoutPanel 中只使用标签（很少使用 TextBox），我在创建它们时将标签和文本框添加到控件列表（在 DisposeAndClearControls() 中引用）。我尝试只是迭代 detailTable.Controls 并以这种方式处理它们，但它似乎错过了一半的控件（通过在调试器中单步执行来确定）。这样我就知道我得到了所有。

我会对提高绘图性能的任何建议感兴趣，尤其是导致多项选择下降的原因。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T13:56:18.500

只需使用从 TableLayoutPanel 继承的自定义控件并将 DoubleBuffered 属性设置为 true，效果很好……尤其是当您动态添加或删除行时。

```
public CustomLayout()
{
   this.DoubleBuffered = true;
   InitializeComponent();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-25T16:33:27.607

我对 TableLayout 也有类似的问题。如果我使用**TableLayout.Controls.Clear()**方法，子控件永远不会被释放，但是当我简单地删除 TableLayout 而不清除它时，泄漏就停止了。回想起来，有趣的是我使用 Clear 方法来*防止*某种泄漏。

显然，Clear 方法没有显式处理控件（这是有道理的，因为您从 TableLayout 中删除它们并不意味着您已经完成了它们）并且从 TableLayout 中删除子控件会阻止清理例程处理当 LayoutTable 本身被处置时的孩子（它根本不知道他们了）。

我的建议：删除**detailTable.Controls.Clear();** **行，从父控件**集合中删除 detailTable 本身并处理它，然后为下一轮创建一个全新的 TableLayout。也完全失去 DisposeAndClearControls 方法，因为您不需要它。根据我的经验，它运作良好。

这样，您不必再回收整个用户控件，而只需回收其中的 TableLayout。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T19:39:58.627

不幸的是，我能提供的唯一建议是自己处理控件的放置。以我的经验，.NET TableLayoutPanel 虽然非常有用，但它会泄漏一些东西，并且随着它的增长变得非常缓慢（而且达到这一点也不需要不合理数量的单元格）。这种行为也可以在设计器中看到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:58:30.390

我更改了包含表单，以便在每次选择更改时构建我的用户控件的新版本。它处理旧的并构建一个新的。这似乎表现得很好。无论如何，出于性能原因，我最初只重用了一个。显然这并不能提高性能。如果我处理旧的并创建一个新的，性能不是问题。

不幸的是，TableLayoutPanel 像那样泄漏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-14T18:46:46.207

我遇到了同样的问题，找到了一个不用太多改动的好方法：

在 VB.net

```
Dim tp As Type = tlpMyPanel.GetType().BaseType
Dim pi As Reflection.PropertyInfo = _
    tp.GetProperty("DoubleBuffered", _ 
    Reflection.BindingFlags.Instance _
    Or Reflection.BindingFlags.NonPublic)
pi.SetValue(tlpMyPanel, True, Nothing) 
```

或在 C# 中：

```
Type tp = tlpMyPanel.GetType().BaseType;
System.Reflection.PropertyInfo pi = 
    tp.GetProperty("DoubleBuffered",
    System.Reflection.BindingFlags.Instance 
    | System.Reflection.BindingFlags.NonPublic);
pi.SetValue(tlpMyPanel, true, null); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-04T20:29:36.700

TableLayoutPanel.Controls.Clear() 对我来说很好用，也许是因为我从与显示的不同的选项卡中清除它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-31T23:33:47.190

```
List<Control> controls = new List<Control>();
foreach (Control control in tableLayoutPanelEnderecoDetalhes.Controls)
{
    controls.Add(control);
}

foreach (Control control in controls)
{
    control.Dispose();
} 
```

# iphone - iPhone - 使用自签名证书的 HTTPS 连接到服务器

> ID：678806
> 
> 赞同：1
> 
> 时间：2009-03-24T19:11:48.053
> 
> 标签：iphone, certificate, self, signed

> **可能重复：**
> [我可以使用 NSURLCredentialStorage 进行 HTTP 基本身份验证吗？](https://stackoverflow.com/questions/501231/can-i-use-nsurlcredentialstorage-for-http-basic-authentication)

我将如何接受自签名服务器证书？使用下面的代码，我只能在使用 Safari 接受服务器证书后进行连接/身份验证。

```
- (void)secure:(NSString *)username credentials:(NSString *)login
{
  NSURLCredential *userCredentials = [NSURLCredential credentialWithUser:username
                                                                password:login
                                                             persistence:
                                                        NSURLCredentialPersistenceForSession];

  NSURLProtectionSpace *space = [[NSURLProtectionSpace alloc] initWithHost:LIST_URL_HTTPS
                                                                      port:443
                                                                   protocol:@"https"
                                                                     realm:@"Restricted Area"
                                                      authenticationMethod:NSURLAuthenticationMethodHTTPBasic];

  [[NSURLCredentialStorage sharedCredentialStorage] setCredential:userCredentials
                                               forProtectionSpace:space];

  NSMutableURLRequest *urlRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:imageURL]
                                                            cachePolicy:NSURLCacheStorageNotAllowed
                                                        timeoutInterval:30];

  NSURLResponse *response;
  NSError *error;

  NSData *returnData = [NSURLConnection sendSynchronousRequest:urlRequest
                                             returningResponse:&response
                                                         error:&error];

} 
```

# asp.net - 我可以使用 ASP.NET 提前刷新缓冲区吗？

> ID：678811
> 
> 赞同：11
> 
> 时间：2009-03-24T19:12:50.767
> 
> 标签：asp.net, optimization

[从雅虎加速您的网站的最佳实践](http://developer.yahoo.com/performance/rules.html)包括以下建议：

> 当用户请求页面时，后端服务器可能需要 200 到 500 毫秒来将 HTML 页面拼接在一起。在此期间，浏览器处于空闲状态，等待数据到达。在 PHP 中，您有函数 flush()。它允许您将部分就绪的 HTML 响应发送到浏览器，以便浏览器可以在后端忙于 HTML 页面的其余部分时开始获取组件。好处主要体现在繁忙的后端或轻量级的前端。
> 
> 一个考虑刷新的好地方是在 HEAD 之后，因为 head 的 HTML 通常更容易生成，它允许您包含任何 CSS 和 JavaScript 文件，以便浏览器在后端仍在处理时开始并行获取。
> 
> 例子：

```
... <!-- css, js -->
</head>
<?php flush(); ?>
<body>
... <!-- content --> 
```

请注意，此处发生刷新的点是在写入头标记之后。这很有意义，因此浏览器可以开始加载图像和脚本，同时渲染和提供页面的其余部分。

有没有办法显式使用 ASP.NET 在头部（或页面的任何其他部分）之后刷新？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T19:15:33.583

您应该能够将以下内容放在页面的头部结尾和正文语句的开头之间：

```
<% Response.Flush(); %> 
```

但是，如果您使用的是脚本管理器或任何其他类型的控件，这些控件将在 html 的 head 部分中注册自己以进行输出，请在此处小心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T19:22:26.873

您可能还希望在页面顶部的 @Page 标记中显式设置 Buffer=true 以避免 Response.Flush() 引发错误。

# javascript - 三元运算符和 if A, B, else C. 有什么重要的区别吗？

> ID：678816
> 
> 赞同：-1
> 
> 时间：2009-03-24T19:13:29.297
> 
> 标签：javascript, conditional, logic, boolean

在 javascript 中有几种方法可以做到这一点。

最重要、最易读和最灵活的可能是：

```
if (a){
    //b
}
else {
    //c
} 
```

仅* 可用于分配且可读性较差的其他内容是：

```
var foo = 'c';
if (a){
    foo = 'b';
} 
```

不过，我的主要问题是关于我能想到的最后两种方法：

```
var foo = a ? b : c;

var foo = a && b || c; 
```

这两种表达方式有区别吗？除了两者都缺乏的可读性。

*尽管您*可以*将 foo 分配为一个函数，然后在 if 语句之后执行它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T19:39:03.590

认为：

```
var a = false, b = '', c = 'bar'; 
```

然后：

```
var foo = a ? b : c; // foo == ''
var foo = a && b || c; // foo == 'bar' 
```

两者不等价；您永远不应该使用布尔运算符代替条件运算符。像其他回答者一样，我也认为条件运算符并不缺乏简单表达式的可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T19:24:19.973

三元运算符对我来说当然是可读的。甚至比第一个示例更重要，因为简洁，逻辑代码总是比执行相同操作的多行控制代码更容易理解。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T19:28:22.337

我不同意只要正确使用第一个缺乏可读性，IOW a、b 和 c 本身就是简单的表达式。尽管在不应该的情况下，该运算符确实会被滥用。

类似地，第二个表达式，使用结果 foo 作为布尔值以外的任何东西都不好。使用布尔运算符返回非布尔值，因为它们的工作方式令人困惑。然而，作为一个布尔表达式，它是合理的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:21:25.753

```
var foo = a ? b : c;    // foo is b when a is true else c.
var foo = a && b || c;  // foo is true if a and b are true or c is true. 
```

它们不会得到相同的结果，因为后者是一个布尔表达式，不使用三元运算符。

# skype - 在网页中使用 Skype 拨打号码

> ID：678820
> 
> 赞同：10
> 
> 时间：2009-03-24T19:13:56.737
> 
> 标签：skype

我正在尝试向网页添加链接或按钮，以便用户可以在安装了 Skype 后直接拨打号码。似乎链接就像

skyp:....？打电话....

但找不到任何样本或文件。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T19:24:47.990

这是链接的格式：

```
<a href="skype:echo123?call">Click</a> (make a call to echo123) 
```

如果访问者安装了 Skype，它将起作用。

如果他/她没有安装 Skype，您可以找到所有选项和替代 javascript 来重定向用户下载 Skype。

[http://dev.skype.com/skype-uri](http://dev.skype.com/skype-uri)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T19:23:44.703

Skype 在其开发者网站上对其 URI 进行了描述：

[http://dev.skype.com/skype-uri](http://dev.skype.com/skype-uri)

这些工作的好坏完全取决于您的浏览器和操作系统。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-01-22T17:41:47.003

```
<a href="skype:+CountryCodePhoneNumber?call">Click</a> 
```

（拨打任何电话号码）

请注意，国家代码是必需的。没有它，看涨期权将不会显示。如果您的数据库有没有国家代码的数字，您可以在脚本中将国家代码添加为 +1。然后，Skype 将让您在拨打电话之前选择更改国家/地区代码，以便您可以根据需要更改到所需的国家/地区。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:17:40.583

Skype 是一个客户端程序。您可能有两种选择：编写一个调用 Skype 的 url 处理程序并使用该 url。有点像 my-skype://。

还有一个插件（至少对于 IE）。您需要确保您的号码是可识别的（格式正确）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-05T02:49:39.100

这已经改变，现在您必须创建一个 javascript 函数来创建一个按钮，以便从浏览器进行调用。

您可以拥有这样的功能并发送您要拨打的号码。

您将需要来自 Skype 的 js url 才能正常工作。请访问此 url 的 Skype sdk 文档，这可以更改。

```
 function CreateSkypeButton(id, number) {

            Skype.ui({
                name: "call",
                element: "call_",
                participants: ["+1" + number],
                imageSize: 24,
                imageColor: "blue"
            });

        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T19:17:38.180

如果安装了 Skype 及其网络工具栏，它会自动检测网页中的电话号码并在电话号码附近添加一个菜单。所以我不认为你应该做任何事情在你的网页中启用它。

# java - 和有什么区别？和 Java 泛型中的对象？

> ID：678822
> 
> 赞同：151
> 
> 时间：2009-03-24T19:14:12.243
> 
> 标签：java, generics

我正在使用 Eclipse 来帮助我清理一些代码以正确使用 Java 泛型。大多数时候，它在推断类型方面做得很好，但在某些情况下，推断的类型必须尽可能通用：Object. 但是 Eclipse 似乎给了我一个选项，可以在对象类型和“？”类型之间进行选择。

那么有什么区别：

```
HashMap<String, ?> hash1; 
```

和

```
HashMap<String, Object> hash2; 
```

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-03-24T19:19:59.093

`HashMap<String, String>`匹配`Map<String, ?>`但不是的实例`Map<String, Object>`。假设你想写一个方法来接受从`String`s 到任何东西的映射：如果你想写

```
public void foobar(Map<String, Object> ms) {
    ...
} 
```

你不能提供一个`HashMap<String, String>`. 如果你写

```
public void foobar(Map<String, ?> ms) {
    ...
} 
```

有用！

在 Java 的泛型中有时会被误解的一件事是它`List<String>`不是`List<Object>`. （但`String[]`实际上是 的子类型`Object[]`，这就是泛型和数组不能很好混合的原因之一。（Java 中的数组是协变的，泛型不是，它们是*不变*的））。

示例：如果您想编写一个接受`List`s 的`InputStream`s 和 s 的子类型的方法`InputStream`，您可以编写

```
public void foobar(List<? extends InputStream> ms) {
    ...
} 
```

顺便说一句：当您想了解 Java 中不那么简单的事情时，[Joshua Bloch 的 Effective Java是一个极好的资源。](https://rads.stackoverflow.com/amzn/click/com/0201310058)（你上面的问题在书中也很好地涵盖了。）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-03-25T16:13:50.187

考虑这个问题的另一种方法是

```
HashMap<String, ?> hash1; 
```

相当于

```
HashMap<String, ? extends Object> hash1; 
```

将这些知识与*[Java 泛型和集合](http://oreilly.com/catalog/9780596527754/)*中第 (2.4) 节中的“获取和放置原则”相结合：

> Get and Put 原则：当你只从结构中获取值时使用扩展通配符，当你只将值放入结构时使用超级通配符，当你同时获取和放置时不要使用通配符。

希望外卡可能会开始变得更有意义。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-24T19:22:17.810

`Collection<Object>`如果您还记得那只是一个包含 type 对象的泛型集合，那么很容易理解`Object`，但`Collection<?>`它是所有集合类型的超类型。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-11-26T11:00:04.710

协方差之上的答案涵盖了大多数情况，但遗漏了一件事：

“？” 包括类层次结构中的“对象”。您可以说 String 是 Object 的一种类型，而 Object 是 ? 的一种类型。并非所有内容都与 Object 匹配，但所有内容都匹配 ?。

```
int test1(List<?> l) {
  return l.size();
}

int test2(List<Object> l) {
  return l.size();
}

List<?> l1 = Lists.newArrayList();
List<Object> l2 = Lists.newArrayList();
test1(l1);  // compiles because any list will work
test1(l2);  // compiles because any list will work
test2(l1);  // fails because a ? might not be an Object
test2(l2);  // compiled because Object matches Object 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-24T19:20:28.313

你不能安全地把任何东西放进去`Map<String, ?>`，因为你不知道这些值应该是什么类型。

您可以将任何对象放入 a `Map<String, Object>`，因为已知该值是 a `Object`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-07-04T18:38:13.210

声明`hash1`为 a`HashMap<String, ?>`表示该变量`hash1`可以包含任何`HashMap`具有键的`String`任何类型的值。

```
HashMap<String, ?> map;
map = new HashMap<String, Integer>();
map = new HashMap<String, Object>();
map = new HashMap<String, String>(); 
```

以上所有内容都是有效的，因为该**变量** `map`可以存储任何这些哈希映射。该变量不关心它所持有的 hashmap 的 Value 类型是什么。

但是，拥有通配符并不**能让**您将任何类型的对象放入地图中。事实上，使用上面的哈希映射，您不能使用`map`变量将任何内容放入其中：

```
map.put("A", new Integer(0));
map.put("B", new Object());
map.put("C", "Some String"); 
```

以上所有的方法调用都会导致编译时错误，因为Java不知道里面的HashMap的Value类型是什么`map`。

您仍然可以从哈希映射中获取值。尽管您“不知道值的类型”（因为您不知道变量中的哈希映射的类型），但您可以说一切都是子类`Object`，因此，无论您从映射中得到什么将是对象类型：

```
HashMap<String, Integer> myMap = new HashMap<>();// This variable is used to put things into the map.

myMap.put("ABC", 10);

HashMap<String, ?> map = myMap;
Object output = map.get("ABC");// Valid code; Object is the superclass of everything, (including whatever is stored our hash map).

System.out.println(output); 
```

上面的代码块将 10 打印到控制台。

* * *

因此，最后，`HashMap`当您不关心（即，没关系）的类型是什么时，请使用带通配符的 a `HashMap`，例如：

```
public static void printHashMapSize(Map<?, ?> anyMap) {
    // This code doesn't care what type of HashMap is inside anyMap.
    System.out.println(anyMap.size());
} 
```

否则，请指定您需要的类型：

```
public void printAThroughZ(Map<Character, ?> anyCharacterMap) {
    for (int i = 'A'; i <= 'Z'; i++)
        System.out.println(anyCharacterMap.get((char) i));
} 
```

在上述方法中，我们需要知道 Map 的键是 a `Character`，否则，我们将不知道使用什么类型从中获取值。然而，所有对象都有一个`toString()`方法，因此映射可以有任何类型的对象作为其值。我们仍然可以打印这些值。

# c# - 在我的 C# 项目中哪里可以找到 application.exe.config 文件？

> ID：678828
> 
> 赞同：6
> 
> 时间：2009-03-24T19:16:47.060
> 
> 标签：c#, configuration

在我的 C# 项目中哪里可以找到 application.exe.config 文件？

我正在尝试启用 JIT 调试器，但找不到配置文件。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T19:18:57.770

它通常位于项目的根目录中。如果它不在那里，你可能没有。您可以通过右键单击您的项目并添加新项目来添加它。

此时它称为 App.Config。编译后，它会重命名为 AppName.exe.Config，并与构建输出一起放置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T09:04:48.297

我必须了解解决方案中的每个项目都可以有一个设置文件。但是启动项目中的那个是在您的输出文件夹中成为 application.exe.config 的那个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T19:18:49.533

它应该在您编译的程序集旁边的`\bin\Debug`or中。`\bin\Release`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-04T14:28:01.673

它将是 app.config 。App.exe.config 将在 windows 应用程序、测试项目或 asp 项目或任何其他显示输出的项目的情况下创建

# c++ - 一些随机的 C 问题（ascii 魔术和位运算符）

> ID：678829
> 
> 赞同：5
> 
> 时间：2009-03-24T19:17:20.833
> 
> 标签：c++, c, bit-manipulation, bitwise-operators

我正在尝试学习 C 编程，我正在研究一些源代码，有些东西我不明白，尤其是关于位运算符。我阅读了一些有关此的网站，并且对它们的作用有所了解，但是当我回头查看这些代码时，我无法理解它们为什么以及如何使用它们。

我的第一个问题与按位运算符无关，而是与一些 ascii 魔术有关：

1.  有人可以向我解释以下代码是如何工作的吗？

    ```
    char a = 3;
    int x = a - '0'; 
    ```

    我知道这样做是为了将 char 转换为 int，但是我不明白它背后的逻辑。为什么/它是如何工作的？

2.  现在，关于按位运算符，我觉得这里真的很迷茫。

    *   这段代码有什么作用？

        ```
        if (~pointer->intX & (1 << i)) { c++; n = i; } 
        ```

        我在某处读到〜反转位，但我看不到这个语句在做什么以及为什么这样做。

        与此行相同：

        ```
        row.data = ~(1 << i); 
        ```

    *   其他问题：

        ```
        if (x != a)
          {
            ret |= ROW;
          } 
        ```

        |= 运算符到底在做什么？根据我的阅读，|= 是 OR，但我不太明白这个语句在做什么。

        有什么方法可以重写此代码以使其更易于理解，以便它不使用此按位运算符？我发现它们很难理解，所以希望有人能指出正确的方向来理解它们如何更好地工作！

* * *

我现在对位运算符有了更好的理解，整个代码现在更有意义了。

最后一件事：显然没有人回应是否会有一种“更清洁”的方式来重写此代码，使其更易于理解，并且可能不是“位级”。有任何想法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-24T19:27:37.780

这将产生垃圾：

```
char a = 3; 
int x = a - '0'; 
```

这是不同的 - 请注意引号：

```
char a = '3'; 
int x = a - '0'; 
```

`char`数据类型存储一个标识字符的数字。数字 0 到 9 的字符在字符代码列表中都是相邻的，所以如果你从 '9' 的代码中减去 '0' 的代码，你会得到答案 9。所以这将变成一个数字字符代码转换为数字的整数值。

```
(~pointer->intX & (1 << i)) 
```

`if`如果它不为零，则该语句将其解释为真。使用了三种不同的位运算符。

~ 运算符翻转数字中的所有位，因此如果`pointer->intX`是`01101010`，那么`~pointer->intX`将是`10010101`。（请注意，自始至终，我都在说明一个字节的内容。如果它是一个 32 位整数，我必须写 32 位 1 和 0）。

& 运算符通过分别处理每个位将两个数字组合成一个数字。如果两个输入位均为 1，则结果位仅为 1。因此，如果左侧为`00101001`，右侧为`00001011`，则结果将为`00001001`。

最后，`<<`表示左移。如果从 00000001 开始并将其左移三个位置，则将得到 00001000。因此表达式 (1 << i) 产生一个值，其中第 i 位打开，其他位全部关闭。

将它们放在一起，它会测试位`i`是否在`pointer->intX`.

所以你也许能够弄清楚是什么`~(1 << i)`。如果`i`是`4`，括号中的内容将是`00010000`，因此整个内容将是`11101111`。

```
ret |= ROW; 
```

那相当于：

```
ret = ret | ROW; 
```

`|`运算符类似于，`&`但如果任一输入位为 ，则结果位为 1 `1`。所以如果`ret`is`00100000`和`ROW`is `00000010`，结果将是`00100010`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T19:22:41.287

`ret |= ROW;`

相当于

`ret = ret | ROW;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:24:06.637

单引号用于指示使用单个字符。因此，'0' 是字符 '0'，其 ASCII 代码为 48。3-'0'=3-48

'1<<i' 将 1 i 位向左移动，因此只有右侧的第 i 位为 1。
~pointer->intX 否定字段 intX，因此当 intX 具有逻辑 AND 时返回真值（非 0）除了右边的第 i 位之外的每一位都没有设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T19:25:43.073

```
char a = '3';  
int x = a - '0'; 
```

你在这里有一个错字（注意 3 周围的 '），这将字符 3 的 ascii 值分配给 char 变量，然后下一行取 '3' - '0' 并将其分配给 x，因为ascii 值的工作方式，x 将等于 3（整数值）

在第一次比较中，我从来没有见过 ~ 以前那样用在指针上，可能是另一个错字？如果我要读出以下代码：

```
(~pointer->intX & (1 << i)) 
```

我会说“（从指针取消引用的值 intX）和（1 左移 i 次）”

1 << i 是将 1 乘以 2 的幂的快速方法，即如果 i 为 3，则 1 << 3 == 8

在这种情况下，我不知道为什么要反转指针的位..

在第二次比较中，x |= y 与 x = x | 相同。是的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T19:27:20.887

因为`char a = 3; int x = a - '0';`我认为你的意思是`char a = '3'; int x = a - '0';`。如果您意识到 ASCII 中的数字是按顺序排列的，那就很容易理解了，例如“0”、“1”、“2”……所以如果“0”是 48，“1”是 49，那么“1” ' - '0' 是 1。

对于按位运算，在您开始查看位之前很难掌握它们。当您查看二进制数的这些操作时，您可以确切地看到它们是如何工作的......

```
010 & 111 = 010
010 | 111 = 111
010 ^ 111 = 101
~010 = 101 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T19:27:33.663

我想你可能有一个错字，意思是：

```
char a = '3'; 
```

这样做的原因是所有数字都按顺序排列，而“0”是第一个。显然，'0' - '0' = 0。'1' - '0' = 1，因为 '1' 的字符值比 '0' 的字符值大 1。等等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T19:28:30.963

1) char 实际上只是一个 8 位整数。'0' == 48，这意味着。

2) (~(pointer->intX) & (1 << i)) 评估是否未设置任何指针指向的 intX 成员中的第 i 位（从右边开始）。~ 反转位，因此所有 0 变为 1，反之亦然，然后 1 << i 将单个 1 放在所需位置， & 组合这两个值，以便只保留所需位，整个事情评估如果该位开始时为 0，则为 true。

3) | 是按位或。它获取两个操作数中的每一位并执行逻辑或，如果任一操作数设置了该位，则产生一个结果，其中设置了每个位。0b11000000 | 0b00000011 == 0b11000011。|= 是赋值运算符，就像 a+=b 表示 a=a+b，a|=b 表示 a=a|b 一样。

在某些情况下，不使用位运算符可以使事情更容易阅读，但如果没有强大的编译器优化，它通常也会使您的代码显着变慢。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T19:28:41.023

您引用的减法技巧有效，因为 ASCII 数字按升序排列，从零开始。因此，如果 ASCII '0' 是 48 的值（确实如此），那么 '1' 是 49 的值，'2' 是 50，等等。因此 ASCII('1') - ASCII('0') = 49 - 48 = 1。

就位运算符而言，它们允许您对变量执行位级操作。

让我们分解你的例子：

`(1 << i)`-- 这是将常数 1 左移 i 位。因此，如果 i=0，则结果为十进制 1。如果 i = 1，则将第 1 位向左移动，用零回填，产生二进制 0010，或十进制 2。如果 i = 2，则将第 2 位移动到左，用零回填，产生二进制 0100 或十进制 4 等。

`~pointer->intX`-- 这是取指针的 intX 成员的值并将其位反转，将所有零设置为 1，反之亦然。

`&`-- & 运算符进行按位与比较。如果表达式的左侧和右侧均为 1，则此结果将为 1，否则为 0。

`pointer->intX`因此，如果在右侧第 i 个位置有一个 0 位，则测试将成功。

此外，`|=`表示进行按位或比较并将结果分配给表达式的左侧。对于相应的左侧或右侧位为 1 的每个位，按位或的结果为 1，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T19:36:18.837

**1）有人可以向我解释以下代码是如何工作的吗？字符 a = 3; int x = a - '0'; 我知道这样做是为了将 char 转换为 int，但是我不明白它背后的逻辑。为什么/它是如何工作的？**

当然。变量*a*是 char 类型，并且通过在 0 周围加上单引号导致 C 也将其视为 char。最后，整个语句被自动类型转换为其等效整数，因为*x*被定义为整数。

**2）现在，关于按位运算符，我觉得这里真的很迷茫。--- 这段代码是做什么的？if (~pointer->intX & (1 << i)) { c++; n = 我; 我在某处读到 ~ 反转位，但我看不到这个语句在做什么以及为什么这样做。**

```
(~pointer->intX & (1 << i)) is saying: 
```

否定 intX，并将其与 1 左移 i 位

因此，如果 intX = 1011 且 i = 2，您将得到什么，等于

```
(0100 & 0100) 

-negate 1011 = 0100

-(1 << 2) = 0100

0100 & 0100 = 1 :) 
```

然后，如果 AND 操作返回 1（在我的示例中，它确实如此）{ c++; n = 我; }

因此，将 c 加 1，并将变量 n 设置为 i

**与此行相同： row.data = ~(1 << i);**

```
Same principle here.
Shift a 1 to the left by i places, and negate.

So, if i = 2 again

(1 << 2) = 0100

~(0100) = 1011 
```

**--- 其他问题：

```
if (x != a) { ret |= ROW; } 
```

|= 运算符到底在做什么？根据我的阅读，|= 是 OR，但我不太明白这个语句在做什么。**

if (x != a) （希望这对你来说很明显......如果变量 x 不等于变量 a）

```
ret |= ROW;

equates to

ret = ret | ROW; 
```

这意味着，二进制 OR ret 与 ROW

对于 AND 和 OR 操作完成的确切示例，您应该对二进制逻辑有一个很好的理解。

检查维基百科的真值表......即

[位运算](http://en.wikipedia.org/wiki/Bitwise_AND)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T19:42:21.240

1.  我假设你的意思是 char a='3'; 对于第一行代码（否则你会得到一个相当奇怪的答案）。基本原则是数字的ASCII码是连续的，即'0'=48的代码，'1'=49的代码，等等。减去“0”只是将 ASCII 码转换为实际数字，例如“3”-“0”=3，依此类推。请注意，这仅在您从中减去“0”的字符是实际数字时才有效 - 否则结果将没有什么意义。

2.  一个。如果没有上下文，就无法说出这段代码的“为什么”。至于它在做什么，当指针->intX 的位 i 未设置时，if 语句的计算结果似乎为真，即该特定位为 0。我相信 & 运算符在 ~ 运算符之前执行，因为 ~运算符的优先级很低。该代码可以更好地使用括号来使预期的操作顺序更清晰。在这种情况下，操作的顺序可能并不重要——我相信结果是一样的。

    湾。这只是创建一个除第 i 位之外的所有位都设置为 1 的数字。为第 i 位创建掩码的一种简便方法是使用表达式 (1<<i)。

3.  本例中的按位或运算用于将 ROW 常量指定的位设置为 1。如果未设置这些位，则设置它们；如果它们已经设置，则没有效果。

# .net - Vista下如何使用WIA 1进行开发？

> ID：678844
> 
> 赞同：3
> 
> 时间：2009-03-24T19:20:50.513
> 
> 标签：.net, windows-vista, windows-xp, wia

我在 Vista SP1 下使用 VS2008 SP1。我的 .Net 程序使用对 WIA（Microsoft Windows 图像采集库 v2.0）的 COM 引用。我正在使用 CommonDialogClass.ShowAcquireImage 扫描文档，它工作正常。我的一位客户正在运行 XP。据我了解 WIA，在 XP 下您必须使用 WIALib (WIA 1.0)。是否可以在 Vista 下使用 WIA1 进行开发？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-04-06T06:26:44.667

[MS 确实允许您在此处](http://www.microsoft.com/downloads/en/details.aspx?familyid=a332a77a-01b8-4de6-91c2-b7ea32537e29&displaylang=en)下载 XP 的 WIA 2.0 库。这样您的客户就可以按原样使用您的应用程序。

另外，比起 1.0，我更喜欢 WIA 2.0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T14:13:51.203

我在 Windows XP 下使用 VS2008 设置了一个小型 WIALib 项目，并将创建的 Interop.WIALib.dll 复制到我的 Vista 机器上。当我在 C# 项目中引用这个文件时，我可以编译它。现在我有两个项目，一个用于 XP，一个用于 Vista。通过 GetVersionEx 调用，我确定了我的 C++ 程序中正在运行的 Windows 版本，并调用了适当的 Dll 的方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-24T19:29:18.153

一般来说，你可以。但是，您仍然需要在您的 Vista 系统上安装 WIA1 Dll。我过去这样做的方法是将 WIA1 Dlls 从 XP 复制到 XP 框。我没有注册 WIA1 dll，只是引用它们。通过引用它们，您的代码现在使用 WIA1。理论上，您仍然可以在 Vista 上运行和测试，因为 WIA2 应该向后兼容 WIA1。尽管您应该使用 XP 进行测试以确保安全。

如果您没有另一台机器，我建议您查看 VMWare，以便您可以安装新的 XP 并以这种方式获取 Dll。

# tdd - TDD 和服务（类什么做某事但没有返回）

> ID：678855
> 
> 赞同：1
> 
> 时间：2009-03-24T19:23:03.657
> 
> 标签：tdd, mocking

我试图在开发服务类的过程中遵循 TDD（我是新手），该类构建了服务客户端传递的任务。然后将构建的对象传递给其他系统。换句话说，该服务接受任务但不返回任何结果——它将构建的任务传递给其他服务。所以我想知道如何为它编写测试，因为没有什么可以断言的。我正在考虑使用模拟来跟踪服务内部的交互，但我有点害怕使用模拟，因为我将与服务的内部实现捆绑在一起。

提前谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T20:07:42.240

为此使用模拟没有问题，因为您将有效地模拟在组件内部使用的组件的*外部接口。*这确实是 mocking 的用途，听起来很适合您的用例。

在进行 TDD 时，它还应该允许您获得那些被认为是良好实践的快速周转周期，因为您可以只创建这些外部服务的模拟。这些模拟将很容易让您编写另一个失败的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T23:50:06.060

你可以考虑把它分成几节课。一个负责构建将要执行的任务列表，另一个负责执行它交给的任务列表。这样您就可以直接测试构建任务列表的代码。

也就是说，我想添加一个我在另一个[问题](https://stackoverflow.com/questions/589603/how-can-i-improve-my-junit-tests/589620#589620)上发布的示例，关于在涉及外部系统时我如何查看 TDD 流程。

> 假设您必须检查某些给定的逻辑是否发送电子邮件，将信息记录在文件中，将数据保存在数据库中，并调用 Web 服务（我知道不是一下子，但您开始为每一个添加测试） . 在您不想触及外部系统的每个测试中，您真正想要测试的是逻辑是否会调用您期望它执行的那些系统。因此，当您编写一个测试来检查创建用户时是否发送了电子邮件时，您测试的是逻辑是否调用了执行该操作的依赖项。请注意，您可以编写这些测试和相关逻辑，而无需实际实现发送电子邮件的代码（然后必须访问外部系统以了解发送的内容......）。这将帮助您专注于手头的任务并帮助您获得一个解耦的系统。它还将使测试发送到这些系统的内容变得简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T15:33:54.840

不确定您使用的是哪种语言，因此在伪代码中可能是这样的：

```
when_service_is_passed_tasks
  before_each_test
    mockClients = CreateMocks of 3 TaskClients
    tasks = GetThreeTasks()
    myService = new TaskRouter(mockClients)

  sends_all_to_the_appropriate_clients
    tasks = GetThreeTasks()
    myService.RouteTaks(tasks)
    Assert mockClients[0].AcceptTask(tasks[0]) was called
    Assert mockClients[1].AcceptTask(tasks[1]) was called
    Assert mockClients[2].AcceptTask(tasks[2]) was called

  if_one_routing_fails_all_fail
    tasks = GetTasksWhereOneIsFailing()
    myService.RouteTaks(tasks)
    Assert mockClients[0].AcceptTask(*) was not called
    Assert mockClients[1].AcceptTask(*) was not called
    Assert mockClients[2].AcceptTask(*) was not called 
```

# iphone - Safari 和/或 WebKit 是否实现了 window.navigator.online 的等效功能？

> ID：678857
> 
> 赞同：1
> 
> 时间：2009-03-24T19:23:27.120
> 
> 标签：iphone, safari, webkit

Safari 是否有任何与 window.navigator.online 的 HTML 5.0 规范等效的东西？

[http://www.whatwg.org/specs/web-apps/current-work/#browser-state](http://www.whatwg.org/specs/web-apps/current-work/#browser-state)

如果没有，是否有任何替代轮询来建立连接状态的方法？

我的问题与 Safari 4.0+ 和 iPhone 软件 2.1+ 有关

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-10-01T19:35:34.287

它在那里，但显然不起作用（对我来说，在装有 iOS 3.2.2 的 iPad 上）。我的代码显示它始终返回 true，在飞行模式和无线显式关闭（我没有打开 3G）下。如果 iPad 上的其他人有此功能，我会很想知道它。

如果 Apple 采用 navigator.connection（请参阅[链接文本](http://www.mobilexweb.com/blog/android-froyo-html5-accelerometer-flash-player)）也很好，但在此之前，这显然将是 Hades 寒冷的一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T12:10:08.103

是的。我认为它从 3.0 开始就在 Safari 中，但我还没有检查过。对 iPhone 的快速测试表明它可以从 iPhone OS 2.2 使用。

# html - 讨厌的 HTML 布局：如何在保留布局的同时隐藏元素？

> ID：678861
> 
> 赞同：3
> 
> 时间：2009-03-24T19:24:05.247
> 
> 标签：html, css

我想隐藏一个表单输入字段。但是调用 setVisible('inputID', false) 会导致我的液体布局崩溃。我不想要那个。

这里有一些简单的解决方法吗？我想过尝试将输入字段的前景色、背景色和边框色渲染为全白。但这变得不必要地复杂了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T19:33:26.487

使用 css 隐藏元素有两种方式：

*   `display`将属性设置为`none`

*   将`visibility`属性设置为`hidden`

第一个选项从流中删除元素，而第二个选项隐藏元素但仍让它占用流中的空间。

您正在使用第一个选项，而您想使用第二个选项。

例子：

```
document.getElementById('inputID').style.visiblity = 'hidden'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T19:30:32.080

如果将元素的“可见性”样式设置为“隐藏”，它将隐藏该元素，但不会影响其他元素的布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:28:39.230

没有看到你的代码很难给出更好的建议，但你可以做一些事情：

1.  鉴于您使用的是 JavaScript，您可以获取要删除的表单输入的宽度和高度，使用这些尺寸创建一个新的 div，将其注入表单元素之后，然后隐藏表单元素。有点破解，但它的工作原理。

2.  在你的 HTML 中用 div 包围你的输入，并在你的 CSS 中给它一个明确的宽度和/或高度。然后像你已经做的那样用 JavaScript 删除输入。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-24T19:36:50.600

[这就是相对定位](http://www.barelyfitz.com/screencast/html-training/css/positioning/)元素的定义。

只要给它相对定位和远离屏幕的坐标。

例如

```
position:relative
left:-2000px 
```

它应该将元素放在屏幕之外，但会在本来应该存在的地方留下一个“洞”。

# function - 如何从 Clojure 中的字符串定义函数？

> ID：678867
> 
> 赞同：15
> 
> 时间：2009-03-24T19:24:37.400
> 
> 标签：function, clojure, metaprogramming, eval, defn

我想这样做（在 REPL 或任何地方）

```
(defn (symbol "print-string") [k] (println k)) 
```

然后能够做到

```
(print-string "lol") 
```

或者，如果有任何其他方法可以从宏中的自定义字符串创建 defn，您能否将我推向正确的方向？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-24T21:40:53.233

```
(defmacro defn-with-str [string args & body]
 `(defn ~(symbol string) ~args ~@body))

(defn-with-str "print-string" [k] (println k))

(print-string "lol") 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-24T23:03:01.647

dnolen 的解决方案在宏扩展时有效，Brian Carper 在读取时有效。现在，这是运行时的一个：

```
(intern *ns* (symbol "a") (fn [k] (println k))) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-24T21:59:52.643

我更喜欢 dnolen 的回答，但你也可以这样做：

```
(defn #=(symbol "print-string") [k] (println k))
```

`#=()`在读取时进行评估。我不知道 Clojure 的一个特性有多稳定，我不会指望它在未来不改变。宏是我的做法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-03-10T00:53:47.763

仅供参考 - dnolen 的答案仅适用于文字字符串，不适用于 def'd 或 let'd 变量中的字符串。

(defmacro defn-with-str [string args & body] `(defn ~(symbol string) ~args ~@body))

(def hisym "hi") (defn-with-str hisym [] (println "hi"))

你现在有一个名为“hisym”的函数

(hi) -> java.lang.Exception: Unable to resolve symbol: hi in this context (NO_SOURCE_FILE:6) (hisym) -> 打印“hi”

为避免这种情况，请评估宏中的函数名称字符串

`(defmacro defn-with-str [string args & body]
`(defn ~(symbol (eval string)) ~args ~@body))`

# c# - 比较具有相同数据的两个对象

> ID：678869
> 
> 赞同：1
> 
> 时间：2009-03-24T19:24:51.190
> 
> 标签：c#, reflection, serialization, comparison

我想比较两个对象，例如：

```
 DirectoryInfo di1 = new DirectoryInfo("C:\\");
 DirectoryInfo di2 = new DirectoryInfo("C:\\"); 
```

好的，是的，我知道我们这里有不同的参考，这个类没有实现 IComparable，甚至 GetHashCode 也返回了不同的结果。

但他们是一样的！（逻辑上:)）

我知道我可以使用反射来比较类之间的每个字段和属性，但是它太慢了。

我也可以使用序列化；序列化每个对象并比较二进制数据，但这更慢！

还有其他想法吗？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T19:40:08.330

我建议在`IEqualityComparer<DirectoryInfo>`其中创建一个实现并封装相等性检查代码。以下是有关文档的链接`IEqualityComparer<T>`：

[http://msdn.microsoft.com/en-us/library/ms132151.aspx](http://msdn.microsoft.com/en-us/library/ms132151.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T19:30:41.050

有什么问题`di1.FullPath == di2.FullPath`？

如果完整路径相同，即使实例属性不同，您也可以得出它们是相同的目录。在大多数情况下，更深入的比较似乎毫无意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T19:27:27.797

编写一个进行比较的函数。例如，给定这种类型：

```
class Foo
{
    public int Bar;
} 
```

写一个这样的函数：

```
static Boolean areEqual(Foo first, Foo second)
{
    return first.Bar == second.Bar;
} 
```

**编辑**

这是作为扩展方法执行此操作的方法：

```
static class Extensions
{
    public static Boolean Equals(this Foo source, Foo foo)
    {
        return first.Bar == second.Bar;
    }
} 
```

这将允许你这样做：

```
Foo first = new Foo();
Foo second = new Foo();
Boolean areEqual = first.Equals(second); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:34:12.993

是的，理想情况下 GetHashCode() 应该为相同的数据返回相同的值，但是 .NET 框架中有很多类依赖于为不同的引用提供不同值的默认行为。

话虽如此，返回相同值的 GetHashCode() 不应用作任何类的相等指标。此函数旨在帮助哈希表（和类似）结构的内存存储，其中可用于近似相等或接近值函数。

在您的情况下，您唯一真正的选择是编写自己的。如果这是用于 IDictionary 之类的东西，那么您只需创建一个实现 IEqualityComparer 接口的具体类。

简而言之，没有一种通用的、一刀切的方法来确定引用类型上的数据相等性，因为不同类型的含义可以（并且将会）改变。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T21:00:01.240

你真正想比较什么？

1.  路径
2.  每个目录中的文件数及其路径
3.  所有子文件路径
4.  所有子文件及其所有属性（这是很多比较）
5.  所有子目录
6.  所有子文件及其所有属性（同上 3）
7.  上述所有的

一旦你弄清楚了，你就可以开始用哈希码或 IComparable、IComparer、Equals、Equatable 等编写比较。

Windows 路径是我亲自检查的，使用字符串的哈希码。你不能有 "C:\blah" 和 "C:\Blah"，但是你可以在基于 Unix 的操作系统中（或者 C:\ 是 / 或 ~/）。

因此，在我看来，检查这两条路径很好。正如迈克尔梅多斯所写的那样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T19:28:39.790

这是接口存在的理由`IEquatable`，它是旧`object.Equals()`方法的强类型版本。（或者也许`IComparable`，但你提到它没有实现它。）

如果您使用“平等”的合理含义而不是“相同的引用”来派生自己的对象，那么您应该实现`IEquatable`和/或覆盖`object.Equals()`。鉴于您使用的对象没有这些，您必须创建一个函数来以您认为合适的任何方式比较它们的相关属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T19:28:41.150

是您要比较的 DirectoryInfo 路径吗？使用 .ToString() 并以字符串格式比较路径。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T19:36:24.127

我认为反思是唯一可行的方法。您可以使用代码生成甚至使用 LINQ 表达式对其进行优化。

# asp.net-mvc - 如何在 MVC 调用之间持久化数据集

> ID：678872
> 
> 赞同：2
> 
> 时间：2009-03-24T19:26:59.593
> 
> 标签：asp.net-mvc, model-view-controller

以下设置类型有效，但不是正确使用 TempData，并且在第一次使用后会下降。我怀疑我应该使用 ViewData，但我正在寻找一些指导来正确地做到这一点。

在我的 Home 控制器中，我有一个 Index 操作，显示哪些成员需要创建字母：

```
Function Index() As ActionResult
    Dim members = GetMembersFromSomeLongRunningQuery()
    TempData("members") = members
    Return View(members)
End Function 
```

在索引视图中，我有一个创建字母的链接：

```
<%=Html.ActionLink("Create Letters", "CreateLetters", "Home")%> 
```

回到 Home 控制器，我有一个 CreateLetters 函数来处理这个问题：

```
Function CreateLetters() As ActionResult
    Dim members = TempData("members")
    For Each member In members
        '[modify member data regarding the letter]
    Next
    TempData("members") = members
    Return RedirectToAction("Letter", "Home")
End Function 
```

最后，有一个创建实际字母的字母视图。它的 ContentType 是“application/msword”，因此数据实际上是在 Word 而不是浏览器中出现的。

就像我说的，这在第一次通过时效果很好。然而，由于字母出现在 Word 中，当用户返回浏览器时，他们仍然坐在带有“创建字母”链接的屏幕上。如果他们再次尝试点击它（即第一次尝试后卡纸），他们会在 CreateLetters 中收到错误，因为 TempData("members") 现在为空。我知道这就是 TempData 的工作方式（单次请求），这就是我试图摆脱它的原因。

这将如何重构以使用 ViewData？或者，如何同时显示 Letter 页面（即 Word 文档）并将应用程序重定向回索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T20:27:12.520

我只是在另一个视图上再次检索该对象，但为什么不在第一次检索该对象时缓存该对象

```
Function Index() As ActionResult
    Dim members = GetMembersFromSomeLongRunningQuery()

// Pseudo code (am a C# man sorry)
    Cache.Remove("MembersItem")
    Cache.Add(members,"MembersItem", CacheExpiry....)

    TempData("members") = members
    Return View(members)
End Function

Function CreateLetters() As ActionResult
    Dim members = Cache.Get("MembersItem")

    For Each member In members
        '[modify member data regarding the letter]
    Next
    TempData("members") = members
    Return RedirectToAction("Letter", "Home")
End Function 
```

您还应该考虑将查询结果缓存指定时间或使其依赖于更新。如果会话对象是用户特定的数据，您也可以使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-13T02:31:17.733

TempData 旨在通过重定向保留数据，而 ViewData 旨在将数据传递到视图。尽管 TempData 可以通过创建可以在 Letter 操作中调用的扩展方法（以及替换 TempData("members") = members CreateLetters 中的行）

```
using System.Web.Mvc;

namespace GoFetchV2.ExtensionMethods
{
    public static class TempDataExtensions
    {
        public static void Keep( this TempDataDictionary tempData, string key )
        {
            var value = tempData[ key ];
            tempData[ key ] = value;
        }
    }
} 
```

像...一样使用

```
Function CreateLetters() As ActionResult
    Dim members = TempData("members")
    ' Do something with members but want to keep it for the next action '
    TempData.Keep("members")
    Return RedirectToAction("Letter", "Home")
End Function

Function Letter() As ActionResult
    Dim members = TempData("members")
    ' Do something with members but want to keep it for the next action '
    TempData.Keep("members")
    ' Return the msword binary data '
End Function 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-24T19:34:37.530

你能把它塞进一个应用程序变量吗？应用程序（“成员”）？

# c# - 使用 Registry.LocalMachine.OpenSubKey 时出现 SecurityException

> ID：678873
> 
> 赞同：9
> 
> 时间：2009-03-24T19:27:07.487
> 
> 标签：c#, security, windows-vista, registry

我正在开发一个需要写入注册表的应用程序。它在 XP 上运行良好，但是当我从 Visual Studio 在 Vista 上运行它时，我得到了一个安全异常：

Registry.LocalMachine.OpenSubKey("软件", true);

我正在尝试将新密钥写入注册表的该分支。

这样做的正确方法是什么，首先我可以在 Vista 上从 VS 运行我的应用程序，其次让我的用户不会在 Vista 上运行时遇到问题。

谢谢...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T19:37:45.293

在 XP 和 Vista 上，您需要管理员权限才能在 LocalMachine 下编写新密钥。

您会发现这在 XP 上有效，而在 Vista 上由于不同的帐户默认值而失败。

快速而肮脏的解决方案是确保您的应用程序在这两种情况下都以管理员权限运行，尽管在 Vista 中这往往是不受欢迎的。

更好的解决方案是稍微重新设计一些东西 - 新的子密钥可以由您的安装程序（以管理员权限运行）编写，还是您可以将您的信息存储在其他地方？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T19:35:54.767

标准用户和在 Vista 上使用 UAC 运行的管理员无权写入本地计算机注册表项。如果您以标准用户身份运行，这在 XP 上也会失败。

您的选择是：

*   如果设置是针对每个用户的，请改用 Registry.CurrentUser。
*   以管理员身份运行您的应用
*   松开密钥上的 ACL，以便任何人都可以写 - 绝对不建议这样做，因为盒子上的任何恶意软件都可以烤密钥。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T19:36:17.497

如果您以管理员身份运行，则只能写入该密钥。因此，您需要以管理员身份运行 VS，而您的用户需要以管理员身份运行应用程序。

我的建议是看看你是否真的需要写信给 LocalMachine。您可以在没有管理员权限的情况下写入 CurrentUser。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:38:00.220

我认为它“在 XP 下工作”是因为每个人都在 XP 下以管理员身份运行它？

*   您可以尝试规避（在安装期间创建密钥或使用 CurrrentUser 下的密钥或其他东西）。

*   您可以在安装过程中将权限授予您的应用程序。恐怕我对如何做到这一点的细节有点缺乏。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-03-30T13:34:02.520

使用 Registry.CurrentUser

# c# - 起订量有什么用？

> ID：678878
> 
> 赞同：24
> 
> 时间：2009-03-24T19:27:28.313
> 
> 标签：c#, moq

我一直在 DotNetKicks 等上看到这一点......但无法确切知道它是什么（英文）或它的作用？你能解释一下它是什么，或者我为什么要使用它吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-24T19:29:18.620

[Moq](https://github.com/Moq/moq4)是 C#/.NET 的模拟框架。它在单元测试中用于将被测类与其依赖项隔离开来，并确保调用依赖对象上的正确方法。有关模拟的更多信息，您可能需要查看关于[Mock Objects](http://en.wikipedia.org/wiki/Mock_object)的 Wikipedia 文章。

其他模拟框架（用于 .NET）包括[JustMock](https://www.telerik.com/products/mocking.aspx)、[TypeMock](http://www.typemock.com/)、 [RhinoMocks](http://ayende.com/projects/rhino-mocks.aspx)、[nMock](http://nmock.org/)等。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-08-14T19:13:20.850

简单来说，Moq 是一个库，当您将其包含在项目中时，您可以轻松地进行单元测试。为什么？因为一个函数可能会调用另一个函数，然后是另一个函数，依此类推。但实际上需要的是第一次调用的返回值以继续下一行。Moq 有助于忽略该方法的实际调用，而是返回该函数返回的内容。并在所有代码行执行后验证，你想要的是你得到什么。英语太多了，举个例子：

```
String Somethod()
{
  IHelper help = new IHelper();
  String first = help.firstcall();
  String second= secondcall(first);
  return second;
} 
```

现在，这里`first`需要 for `secondcall()`，但您实际上不能`help.firstcall()`在其他层调用它。所以 Mocking 完成了，假装该方法被调用：

```
[TestMethod]
public void SomeMethod_TestSecond
{
  mockedIHelper.Setup(x=>x.firstcall()).Returns("Whatever i want");  
} 
```

在这里，想想，`SetUP`作为伪造的方法调用，我们只是对`Returns`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T19:29:29.447

Moq 是一个用于 .Net TDD 的模拟引擎。

# ms-access - 神秘的 HAVING 子句

> ID：678900
> 
> 赞同：0
> 
> 时间：2009-03-24T19:32:08.783
> 
> 标签：ms-access

谁能解释一下 Access 数据库中的以下 HAVING 子句？Format with all '0' 如何返回一串空格？

```
HAVING Format([PerNr],'0000000') <> '       ' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T19:34:33.957

如果字段值设置为空格，则可能...

VBA：

```
Dim x As String
x = "       "
MsgBox "x = " & Format(x, "0000000") & " : Len(x) = " & Len(Format(x, "0000000")) 
```

# c# - 数据表和视图状态

> ID：678903
> 
> 赞同：1
> 
> 时间：2009-03-24T19:33:09.483
> 
> 标签：c#, asp.net, datatable

看起来 DataTable.Rows 属性未保存在 ViewState 中，但 Columns 属性是，因为我无法解释为什么列在回发之间存在而数据不存在。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T19:48:59.710

DataTable 类在 ViewState 中根本不存储任何内容。DataTable 类并非特定于 Web 应用程序，也不使用任何特定于 Web 的功能。

如果 DataTable 对象中的任何数据存储在 ViewState 中，那是因为您将其用作在 ViewState 中存储信息的 Web 控件的数据源，例如 DataGrid。该控件从 DataTable 中复制它需要在回发时重新创建控件的信息。一旦页面被发送到浏览器，最初用于数据绑定控件的 DataTable 对象将不再存在。

DataGrid 控件的 Columns 属性（例如）是 DataGridColumn 对象的集合，它与作为 DataColumn 对象集合的 DataTable 类的 Columns 属性不同，尽管 DataTable 的列中的大部分信息是当 DataGrid 是数据绑定时，复制到 DataGrid 的列。

# windows - 在 Windows 上解压缩多部分压缩包

> ID：678905
> 
> 赞同：6
> 
> 时间：2009-03-24T19:33:21.310
> 
> 标签：windows, tar, archive

我有一系列名为*filename.part0.tar、filename.part1.tar、... filename.part8.tar 的文件。*

我猜 tar 在归档时可以创建多个卷，但我似乎找不到在 Windows 上取消归档它们的方法。我尝试使用 7zip（GUI 和命令行）、WinRAR、tar114（不能在 64 位 Windows 上运行）、WinZip 和[ZenTar](http://www.zentastic.com/blog/zentar-win32-untar-utility/)（我找到的一个小实用程序）解压它们。

所有程序运行通过*part0*文件，解压3个rar文件，然后退出报错。其他部分文件均不被识别为*.tar、.rar、.zip*或*.gz。*

我尝试使用 DOS 复制命令将它们连接起来，但这不起作用，可能是因为*part0*到*part6*和*part8*都是 100Mb，而*part7*是 53Mb，因此很可能是最后一部分。我已经为串联文件尝试了几种不同的逻辑顺序，但没有任何乐趣。

除了安装 Linux、寻找实时发行版或追踪为我留下这些文件的人之外，我该如何解压这些文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T19:40:31.150

安装 7-zip。右键单击第一个 tar。在上下文菜单中，转到“7zip -> 在此处提取”。

像魅力一样工作，不需要命令行功夫:)

编辑：我现在才注意到您提到已经尝试过 7zip。如果您尝试通过“打开方式”-> 7zip 来“打开”tar，它可能会犹豫 - 他们用于打开文件的命令行有点不正统，因此您必须通过 7zip 而不是通过构建的文件关联系统进行关联- 进入窗户。但是，如果您尝试右键单击->“7-zip”->“在此处提取”，那应该可以-我自己测试了解决方案（尽管在32位Windows机器上-没有64位可用）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-03T15:07:45.523

1) 下载 gzip [http://www.gzip.org/](http://www.gzip.org/) for windows 并解压
2) gzip -c filename.part0.tar > foo.gz
gzip -c filename.part1.tar >> foo.gz
...
gzip -c 文件名.part8.tar >> foo.gz
3) 解压 foo.gz

为我工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-22T15:14:38.740

如上所述，我遇到了同样的问题并遇到了这个旧线程。对我来说，在安装 Siebel VM 时，这是一个严重的 RTFM 案例。这些说明直接来自手册：

```
cat \
OVM_EL5U3_X86_ORACLE11G_SIEBEL811ENU_SIA21111_PVM.tgz.1of3 \
OVM_EL5U3_X86_ORACLE11G_SIEBEL811ENU_SIA21111_PVM.tgz.2of3 \
OVM_EL5U3_X86_ORACLE11G_SIEBEL811ENU_SIA21111_PVM.tgz.3of3 \
 | tar xzf – 
```

为我工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T19:43:29.117

该`tar -M`开关应该在 Windows 上为您服务（我使用的是 tar.exe）。

`tar --help`说：

```
-M, --multi-volume             create/list/extract multi-volume archive 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-16T17:34:30.893

我找到了这个线程，因为我对这些文件有同样的问题。是的，与您拥有的完全相同的文件。以下是正确的顺序：042358617（即从 part0 开始，然后是 part4，等等）

按该顺序连接，您将获得一个可以解压缩的 tarball。（我不在 Windows 上，所以我无法建议使用什么应用程序。）请注意，其中包含的 19 个项目中，有 3 个是 zip 文件，一些非归档实用程序将报告为已损坏。其他应用程序将允许您提取 99% 的内容。同样，我不在 Windows 上，因此您必须自己进行试验。

享受！;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-09T07:48:55.410

这对我来说适用于多卷 tar 存档（编号为 .tar.1、.tar.2 等），甚至允许 --list 或 --get 其中的特定文件夹或文件：

```
#!/bin/bash
TAR=/usr/bin/tar
ARCHIVE=bkup-01Jun
RPATH=home/user
RDEST=restore/
EXCLUDE=.*
mkdir -p $RDEST
$TAR vf $ARCHIVE.tar.1 -F 'echo '$ARCHIVE'.tar.${TAR_VOLUME} >&${TAR_FD}' -C $RDEST --get $RPATH --exclude "$EXCLUDE" 
```

复制到脚本文件，然后只需更改参数：

*   TAR=tar 二进制文件的位置
*   ARCHIVE=存档基本名称（不带 .tar.multivolumenumber）
*   RPATH=要恢复的路径（为完全恢复留空）
*   RDEST=恢复目标文件夹（相对或绝对路径）
*   EXCLUDE=要排除的文件（使用模式匹配）

对我来说有趣的是你真的不要使用 -M 选项，因为这只会问你问题（插入下一卷等）

# .net - 将事务与业务流程和存储库模式一起使用

> ID：678922
> 
> 赞同：7
> 
> 时间：2009-03-24T19:36:28.900
> 
> 标签：.net, transactions, repository-pattern

我有一种情况（我猜这很标准），我需要执行一些业务计算并在数据库中创建一堆记录。如果在任何时候出现任何问题，我需要从数据库中回滚所有内容。显然我需要某种交易。我的问题是我在哪里实现事务支持。这是我的例子

```
//BillingServices - This is my billing service layer. called from the UI
public Result GenerateBill(BillData obj)
{
     //Validate BillData

     //Create a receivable line item in the receivables ledger 
     BillingRepository.Save(receivableItem);

     //Update account record to reflect new billing information
     BillingRepository.Save(accountRecord);

     //...do a some other stuff
     BillingRepository.Save(moreStuffInTheDatabase);
} 
```

如果对数据库的任何更新失败，我需要将其他更新回滚并退出。我是否只是通过我可以调用的存储库公开一个 Connection 对象

Connection.BeginTransaction()

还是我只是在服务层中进行验证，然后在存储库中调用一种方法来保存所有对象并处理事务？这对我来说似乎不太正确。似乎它会迫使我在数据层中投入大量的业务逻辑。

什么是正确的方法？如果我需要跨越存储库（或者那将是糟糕的设计）怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T19:47:39.183

我假设您在这里使用.NET。在这种情况下，您可以简单地将整个代码部分包装在带有实例的[`using`语句](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.110%29.aspx)[`TransactionScope`](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)中，它将为您处理事务语义。您只需在最后调用该[`Complete`方法](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.complete.aspx)：

```
//BillingServices - This is my billing service layer. called from the UI
public Result GenerateBill(BillData obj)
{
     // Create the transaction scope, this defaults to Required.
     using (TransactionScope txScope = new TransactionScope())
     {
          //Validate BillData

          //Create a receivable line item in the receivables ledger 
          BillingRepository.Save(receivableItem);

          //Update account record to reflect new billing information
          BillingRepository.Save(accountRecord);

          //...do a some other stuff
          BillingRepository.Save(moreStuffInTheDatabase);

          // Commit the transaction.
          txScope.Complete();
     }
} 
```

如果发生异常，这具有`Complete`退出代码块时不调用的效果；退出语句 范围时调用[接口](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)实现上的方法[`Dispose`。](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)`TransactionScope`[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)`using`

在`Dispose`调用中，它检查事务是否完成（`Complete`成功时设置此状态）。如果未设置该状态，它将执行回滚。

然后，您可以将其嵌套在其他`TransactionScope`实例中（在同一线程上的调用堆栈中更深），以跨多个存储库创建更大的事务。

# css - 使用“滑动门”设置输入按钮的样式

> ID：678925
> 
> 赞同：1
> 
> 时间：2009-03-24T19:37:02.987
> 
> 标签：css, forms, input, button

我有一个使用无法更改的第三方 HTML 的网页。但是，我可以编辑 CSS 样式表。我有一个“滑动门”样式的按钮，我想将其替换为页面上的默认输入按钮，但我不知道如何仅使用 CSS 来做到这一点。

这是按钮的 HTML：

```
<div>
    <input type="button" style="margin: 10px 0pt 0pt; width: 60px; height: 25px; font-size: 11px;" name="search_btn" value="Search" onclick="DoSearchSalesExpanded(searchform);"/>
</div> 
```

这是我拥有的使用“滑动门”方法的现有按钮的 CSS：

```
.clear { 
    /* generic container (i.e. div) for floating buttons */
    overflow: hidden;
    width: 100%;
}
a.button_oval {
    background: transparent url('http://mydomain.com/projects/buttons/sliding-doors/images/bg_button_oval_a.gif') no-repeat scroll top right;
    color: #222;
    display: block;
    float: left;
    font: normal 12px arial, sans-serif;
    height: 24px;
    margin-right: 6px;
    padding-right: 18px; /* sliding doors padding */
    text-decoration: none;
}
a.button_oval span {
    background: transparent url('http://mydomain.com/projects/buttons/sliding-doors/images/bg_button_oval_span.gif') no-repeat;
    display: block;
    line-height: 14px;
    padding: 5px 0 5px 18px;
} 
a.button_oval:active {
    background-position: bottom right;
    color: #000;
    outline: none; /* hide dotted outline in Firefox */
}
a.button_oval:active span {
    background-position: bottom left;
    padding: 6px 0 4px 18px; /* push text down 1px */
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T20:52:08.297

您需要两个元素来进行嵌套背景连接（也称为滑动门）：一个外部（背景）和一个内部（前景，包含背景图像的末端）。如果你只有一个独立的 <input> 你就卡住了。

如果您能找到一种方法来选择您提到的 <div> ，则可以将其用作外部元素，将按钮（删除其自然背景颜色）用作内部元素。但是，您必须确保外部 div 与内部 <input> 的宽度/高度相同，也许可以通过将其向左浮动（以激活浮动附带的“缩小以适应”行为）。您还需要考虑按钮的上边距及其上的任何填充。

```
#something div {
    float: left;
    background: transparent url('http://mydomain.com/projects/buttons/sliding-doors/images/bg_button_oval_a.gif') no-repeat 0 10px;
}
#something div input {
    background: transparent url('http://mydomain.com/projects/buttons/sliding-doors/images/bg_button_oval_span.gif') no-repeat;
    border: none;
    padding: 0;
} 
```

但是，由于所讨论的按钮在页面上具有固定像素大小，因此您根本不需要使用嵌套背景。您可以只为按钮制作一个正确尺寸的背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-07T05:09:41.850

如果您能够使用*按钮*元素而不是*输入*元素。以下文章非常有用。

*   [http://jedisthlm.com/2008/03/27/flexible-css-buttons/](http://jedisthlm.com/2008/03/27/flexible-css-buttons/)
*   [http://robertnyman.com/2008/03/13/styling-buttons-and-achieving-sliding-doors-with-them/](http://robertnyman.com/2008/03/13/styling-buttons-and-achieving-sliding-doors-with-them/)

您仍然可以像输入一样使用类型提交和发布

但是，如果您依赖使用此按钮作为提交，请注意在使用 IE 时。它还将提交按钮的内容，这将为 .net Web 应用程序提供安全例外。

*编辑，发现与原始链接不同的链接不再有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-21T10:16:37.317

您唯一的其他选择是使用 javascript 动态插入...我的按钮文本...通常用于滑动门按钮的标签。但是，不建议这样做，因为它不适用于禁用 JS。

# python - 为 Django 存档页面选择不同的年份和月份

> ID：678927
> 
> 赞同：13
> 
> 时间：2009-03-24T19:37:30.050
> 
> 标签：python, django, datetime, django-views, django-queryset

我想为我的 django 站点创建一个 archive_index 页面。但是，基于日期的通用视图确实没有任何帮助。我希望视图返回的字典包含至少存在一个对象类型实例的所有年份和月份。因此，如果我的博客于 2007 年 9 月开始，但在 2008 年 4 月没有帖子，我可以得到这样的东西

```
2009 年 - 1 月、2 月、3 月
2008 - 一月、二月、三月、五月、六月、七月、八月、九月、十月、十一月、十二月
2007 年 - 9 月、10 月、11 月、12 月
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-24T20:26:37.327

这将为您提供唯一发布日期的列表：

```
Posts.objects.filter(draft=False).dates('post_date','month',order='DESC') 
```

当然，您可能不需要草稿过滤器，并将“post_date”更改为您的字段名称等。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-24T20:39:09.950

我找到了自己问题的答案。

它在文档[的这个页面上。](http://docs.djangoproject.com/en/dev/ref/models/querysets/)

有一个名为 dates 的函数可以为您提供不同的日期。所以我可以

Entry.objects.dates('pub_date','month') 获取日期时间对象列表，每个年/月一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T19:46:38.780

您应该能够从内置视图中获取您描述的所有信息。你能更具体地说明你不能得到什么吗？这应该有你需要的一切：

```
django.views.generic.date_based.archive_month 
```

[参考页面](http://docs.djangobrasil.org/ref/generic-views.html)（在该页面上搜索上述字符串）

# silverlight - Silverlight 示例应用程序

> ID：678934
> 
> 赞同：1
> 
> 时间：2009-03-24T19:38:18.410
> 
> 标签：silverlight, sample

几个月以来我一直在开发小型 Silverlight 应用程序，现在我正在寻找一些资源来改进我的应用程序。我阅读了大量示例并且了解了基本技术，现在我正在寻找一个完整、强大的 Silverlight 应用程序，我可以学习该应用程序以学习最佳的 SL 应用程序设计方法。我不是在寻找小代码块，而是在寻找具有适当设计的完整应用程序。显示它如何调用的东西，逻辑放置在哪里，如何处理事件并将 UI 组件链接在一起等。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T19:43:22.097

[Microsoft Health Common User Interface](http://www.mscui.net/)组有一些非常简洁和复杂的Silverlight 演示器。从数据的角度来看，没有完全成熟的功能性应用程序，但是比简单的教程更深入地展示了许多 UI 概念。

# arrays - 多维数组的线性仿真

> ID：678938
> 
> 赞同：9
> 
> 时间：2009-03-24T19:40:09.967
> 
> 标签：arrays, language-agnostic, linear-algebra, multidimensional-array

`[x + y * width]`我知道如何使用线性索引来模拟线性数组中的二维数组。

我可以将其扩展到 3d 数组：`[x + y * width + z * width * height]`.

N维数组有通用公式吗？

我正在寻找与语言无关的答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T19:47:14.990

当然。只需扩展您的示例即可`x + y*width + z*width*height + w*width*height*depth + ...`

换句话说，`dim1 + dim2*size1 + dim3*size1*size2 + dim4*size1*size2*size3 + ...`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:55:07.403

嗯，如果你想要一些代码... :-) C 语言已经足够独立了，是吗？

假设输入：位置[维度]

假设存在一个表 maxBound[dimensions] 包含表的每个维度的最大边界。

```
int index = 0;
int multiplier = 1;
for (int i = 0;i < dimensions;i++)
{
  index += location[i] * multiplier;
  multiplier *= maxBound[i];
} 
```

您的索引将最终出现在索引字段中。

```
Test:
location = [3,4,5]
maxBound = [10,20,30]
loop initial: index = 0, multiplier = 1.
loop i=0: index = 3, multiplier = 10.
loop i=1: index = 43, multiplier = 200.
loop i=2: index = 1043, multipler = 6000. 
```

我认为这是有道理的，但这只是我的想法。

# c++ - 如何创建一次只接受一个连接的 TCP 服务器？

> ID：678944
> 
> 赞同：9
> 
> 时间：2009-03-24T19:40:57.157
> 
> 标签：c++, linux, sockets

我正在使用 Linux 套接字在 C++ 中编写客户端-服务器对。我希望服务器监听连接，当一个客户端连接时，服务器应该拒绝任何其他尝试连接的客户端。

我尝试通过将[监听](http://linux.die.net/man/3/listen)函数中的 backlog 参数设置为 0 和 1 来实现这一点，但这些值中的任何一个似乎都不起作用。第一个客户端按预期连接，但任何后续客户端都会在第一个客户端完成时阻塞。真正让我困惑的是，它们不会阻止连接到服务器，而是会在第一次读取时阻止。

我使用[这里的代码](http://tldp.org/LDP/LG/issue74/tougher.html)开始编写我的客户端和服务器。有谁知道我需要更改什么以使服务器仅接受一个客户端连接并放弃任何后续连接尝试？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T19:44:06.837

当您接受连接时，将创建一个新套接字。旧的仍然用于监听未来的连接。

由于您一次只允许 1 个连接，您可以只接受连接，然后在检测到您已经在处理另一个连接时关闭新接受的套接字。

与在接受后立即关闭新接受的套接字相比，您正在寻找净差异吗？客户端将在尝试使用其套接字时立即知道（或者如果它已经通过读取调用在服务器上等待），最后一个错误是：服务器主动关闭连接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T19:45:16.227

只是不要`fork()`追求`accept()`。

这个伪 C 代码一次只接受一个客户端。

```
while(1) {
    listen()
    accept()
    *do something with the connection*
    close()
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-24T19:48:22.707

您可以在接受第一个连接后关闭正在侦听连接的原始套接字。我不知道您使用的套接字类是否允许您这样做。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T19:51:15.260

听起来您需要手动实现它。让客户端连接，然后如果已经有另一个客户端连接，则从服务器向客户端发送断开连接消息。如果客户端收到此消息，则让它自行断开连接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-31T08:25:29.073

> 由于您一次只允许 1 个连接，您可以只接受连接，然后在检测到您已经在处理另一个连接时关闭新接受的套接字。

我认为应该关闭监听套接字。当第一个连接建立时，你关闭原来的监听套接字。之后就不能再建立连接了。

第一个连接结束后，可以创建一个新的socket再次监听。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T19:57:27.600

如果您可以控制客户端，则可以使套接字非阻塞。在这种情况下，他们将返回错误消息`EINPROGRESS`。

我仍在寻找如何将套接字更改为非阻塞。如果有人知道如何副手，请随时编辑答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T20:03:04.093

让监听套接字在接受并开始新连接后死掉。然后，当该连接完成后，让它启动一个新的侦听套接字。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T20:06:24.397

您可能[`TCP_DEFER_ACCEPT`](http://linux.die.net/man/7/tcp)在侦听套接字上设置了套接字选项：

```
TCP_DEFER_ACCEPT（从 Linux 2.4 开始）
    仅当数据到达套接字时才允许唤醒侦听器。
    取一个整数值（秒），这可以限制最大数量
    TCP 将尝试完成连接。这个选项应该
    不能在旨在可移植的代码中使用。

```

`connect`我认为它会导致您描述的效果，即连接客户端不会阻塞`read`. 我不确定选项默认设置是什么以及应该设置什么来禁用此行为，但可能值为零值得一试：

```
int opt = 0;
setsockopt(sock, IPPROTO_TCP, TCP_DEFER_ACCEPT, &opt, sizeof(opt)); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-10T12:38:11.323

据我所知，不可能只听一个连接。

Tcp 涉及 3 次握手。收到第一个`syn`数据包后，内核将该“连接”放入等待队列中，以 an 回答`syn/ack`并等待最后一个`ack`. 收到此消息后，它将连接从等待队列移动到接受队列，应用程序可以在其中使用`accept()`调用来获取连接。（详情请看[这里](http://veithen.github.io/2014/01/01/how-tcp-backlog-works-in-linux.html)。）

在 linux 上，积压参数仅限制接受队列的大小。但是内核仍然会执行 3 次握手魔术。客户端接收到 syn/ack 和带有最终 ack 的应答，并调用已建立的连接。

您唯一的选择是，在您接受第一个连接后立即关闭侦听套接字。（但这可能会导致其他连接已经可用。）或者您主动接受其他连接并立即关闭它们以通知客户端。

您拥有的最后一个选项是您已经在使用的选项：让服务器将您的连接排队并一个接一个地处理它们。在这种情况下，您的客户将阻止。

# c++ - 什么是最好的免费便携式 3d/2d 引擎？

> ID：678956
> 
> 赞同：6
> 
> 时间：2009-03-24T19:43:46.573
> 
> 标签：c++, game-engine

我喜欢为 pc/mac/linux 制作非常简单的 3d/2d 游戏，什么是最好的免费 3d/2d 引擎？我没有游戏编程经验，所以我想它必须很容易用 C++ 学习，谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T19:51:55.320

虽然“最佳”在很大程度上取决于您的情况，但我过去使用的取得巨大成功的方法是[OGRE 3D](http://www.ogre3d.org)。

它是跨平台的，编写得非常好（C++），并且运行良好。然而，让我与众不同的一件事是伟大的社区——无论你的问题多么简单，你总能得到帮助，而且他们的论坛/wiki上有很多指南/教程。文档也很好。

非常值得一试。

嗯，读到这几乎听起来我有既得利益——我没有！我真的很喜欢过去的经验！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T19:46:24.773

尝试在[DevMaster 的游戏和图形引擎数据库](http://www.devmaster.net/engines/)中搜索 3D 引擎。这个问题在他们的[论坛](http://www.devmaster.net/forums/)中也被问过很多次并回答[了](http://www.devmaster.net/forums/showthread.php?t=13873&highlight=2d+engine) [很多](http://www.devmaster.net/forums/showthread.php?t=13627&highlight=C+game+engine)次。

[C4 Engine](http://www.terathon.com/c4engine/index.php)、[irrLicht](http://irrlicht.sourceforge.net/)和[Torque](http://www.garagegames.com/)通常被推荐用于 C++ 中的 3D，但这实际上取决于您的个人需求，或者您是否真的需要引擎。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T19:58:35.163

我推荐[Irrlicht](http://irrlicht.sourceforge.net/)。它简单、轻巧但快速而强大。它不像 Ogre3D 那样功能强大，但我发现它更易于使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:50:39.550

[Panda3D](http://panda3d.org/)非常简单：

1.  您可以将它与 C++（或 Python）一起使用。
2.  它有据可查，并提供了许多很好的示例。

它主要是面向 3d 的，因此请注意，尽管任何 3d 引擎都会涉及学习曲线，但 Panda3D 将是最短的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T01:14:54.233

如果您正在寻找更多简单的 API 而不是成熟的游戏引擎，您应该尝试[SDL](http://www.libsdl.org/)。这将为您提供一种独立于平台的方式来使用 OpenGL 进行渲染、处理输入、进行基本音频等。如果您正在寻找一种方法来制作简单的 2D 游戏项目，它会特别方便。

# java - 在 eclipse for java 中是否有类似 Visual Studio Custom Debugger Visualizers 的东西

> ID：678961
> 
> 赞同：3
> 
> 时间：2009-03-24T19:45:23.620
> 
> 标签：java, eclipse, debugging

在 Visual Studio 中为任何 .Net 类型创建自定义调试可视化工具的能力是一个有趣的功能。java对象的eclipse中是否有类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T19:48:43.143

我没有对 VS 调试可视化工具进行足够的调查，无法知道它是否*完全*对应，但 Eclipse 确实允许您以指定的方式将给定类型的实例转换为字符串以进行调试。

请参阅首选项 -> Java/Debug/Detail Formatters。

[这是](http://web.archive.org/web/20100808063922/http://blog.jcake.com/2008/03/05/eclipse-debugger-part-i-detailed-formatters/)一篇博客文章，提供了一个示例的演练。（还有很多其他的——搜索 Eclipse 和“详细格式化程序”会找到负载。不过这个看起来很合理。）

同一菜单中还有“逻辑结构”选项，[另一篇博客文章](http://web.archive.org/web/20100808063157/http://blog.jcake.com/2008/03/09/eclipse-debugger-part-ii-logical-structures/)（实际上是较早文章的第二部分）和另一个示例。

编辑 6.2 2012：更改链接以使用存档，因为原件不再可用。

# asp.net - 关闭使用 window.open 打开的窗口后丢失会话状态

> ID：678963
> 
> 赞同：1
> 
> 时间：2009-03-24T19:45:42.387
> 
> 标签：asp.net, session, session-state

目前我们正在使用 window.open 打开一个新的 aspx 页面。window.open 位于当前 aspx 页面中的 javascript 函数 (openNewWindow()) 中，单击 asp.net 超链接控件时会调用该函数。

链接是由我们的框架在页面上动态创建的，因此我想避免更改该功能。

问题似乎是当这个新的“子”窗口关闭时，会话状态会丢失。我应该提到，在“子”窗口关闭后，会话在子窗口中可用，但在“父”窗口中不可用。

有趣的是，似乎在我们应用程序的其他地方，如果通过在超链接控件的代码隐藏单击事件上使用 ClientScriptManager.RegisterStartupScript 调用将 open.window 调用添加到页面（而不是调用在aspx) 会话被保留。

如果不进行重大更改和所有需要的回归测试，后一种解决方案将难以在当前框架代码中实现。

任何人都知道如何在子窗口关闭后保持会话状态处于活动状态。

顺便说一句，这发生在 IE7 中，我们的应用程序是基于 asp.net 2.0 的。

提前感谢您对这个问题的深刻而优雅的解决方案！;o)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-11T16:07:08.570

IE 7 改变了新窗口的行为。基本上，每个窗口都是在它自己的进程中打开的。选项卡仍然在同一进程中打开。

这意味着每个新窗口都有自己的 cookie 袋。这意味着新窗口没有自动分配 Session_ID cookie。.Net 链接控件会将 cookie 发送到新窗口。但是，仅使用直接 javascript 打开一个新窗口可能不会这样做。

FireFox 一直这样，我相信 Chrome 一直都是这样。IE 6 和以前的共享进程空间，即使对于多个窗口也是如此，所以一切都在两者之间共享，这给严格在 IE 中调试站点带来了无尽的麻烦。

**更新**
[这是一个](http://sqlblogcasts.com/blogs/jonsayce/archive/2007/11/06/Browsers_2C00_-processes_2C00_-cookies-and-session-state.aspx)详细描述问题的链接。您会注意到这种行为有些不一致。原因是有时 IE 7 决定在自己的进程中打开新窗口，有时它会在新窗口中打开。

有两个真正的解决方案。要么完全停止依赖会话（我的第一选择，我对此有很强的技术原因），要么您需要切换到无 cookie 会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T14:37:42.213

我应该纠正自己（抱歉无法编辑原始问题）并说触发 javascript 以执行“window.open”的控件是链接按钮而不是超链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-24T04:14:09.680

它也发生在我的 Chrome 中。

我通过添加解决了这个问题：

```
<link rel="shortcut icon" href="../../img/favicon.ico"> 
```

在`<head></head>`将打开的页面中。

# decorator - 在 ASP.NET 中装饰方法？

> ID：678967
> 
> 赞同：4
> 
> 时间：2009-03-24T19:46:55.083
> 
> 标签：decorator

又是我……我在我读过/看过的教程中经常听到“装饰/装饰”这个方法。但我就是不明白这意味着什么以及它实际上做了什么？谁能指出我开始使用它们的一些信息的方向（非常新手教程会很好）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T19:49:28.773

.NET 没有“装饰器”，但它确实有属性。开发人员经常使用“装饰”一词来表示属性的使用。 [这是一篇很好的文章，解释了它们如何工作以及如何使用它们。](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-1044870.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T19:49:27.573

看看[这篇文章](http://www.codeproject.com/KB/cs/dotnetattributes.aspx)的介绍和教程。

要在 .NET 中进行装饰，您可以使用充当元数据的属性，这些属性在运行时可供您使用，有助于描述代码中的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:50:10.347

如果您谈论装饰器设计模式，[dofactory.com](http://www.dofactory.com/Patterns/PatternDecorator.aspx)上有一个非常清晰的示例。

希望这可以帮助

# iphone - 布尔逻辑故障

> ID：678980
> 
> 赞同：0
> 
> 时间：2009-03-24T19:50:04.140
> 
> 标签：iphone, objective-c

我对布尔逻辑有一个奇怪的问题。我一定是在做一些愚蠢的事情，但我想不通。在下面的代码中，firstMeasure.isInvisibleArea 为 true，而 measureBuffer1 为 nil。即使 test1 出于某种原因评估为 NO，它仍然会落入我的 if 语句中。如果我使用注释掉的行，它可以正常工作。知道为什么会这样吗？

```
BOOL firstVisible = firstMeasure.isInVisibleArea;
BOOL notFirstVisible = !(firstMeasure.isInVisibleArea);
BOOL measureBufferNil = measureBuffer1 == nil;

BOOL test1 = measureBuffer1 == nil && !firstMeasure.isInVisibleArea;
BOOL test2 = measureBufferNil && !firstVisible;

if (measureBuffer1 == nil && !firstMeasure.isInVisibleArea)
//if (measureBufferNil && !firstVisible)    
{
    //do some action
} 
```

* * *

更新1：

我将问题隔离到 !firstMeasure.isInVisibleArea 因为我已经完全采用了 measureBuffer 位。isInVisible 区域内部是一个小计算（虽然它没有修改任何内容），但计算使用的是 self.view.frame。我也要把这个排除在外，看看会发生什么。我的预感是 self.view.frame 在两次调用 isInVisibleArea 之间发生了变化。

* * *

更新 2：这确实是问题所在。我在下面更详细地添加了答案

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T20:05:28.737

如有疑问，您应该用括号括起来。在不查找优先级规则的情况下，我认为发生的事情是 = 的优先级高于 == 或 &&。所以试试：

```
BOOL test1 = ((measureBuffer1 == nil) && !firstMeasure.isInVisibleArea); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T20:16:46.713

虽然您当然可以加括号，但您也应该知道`nil`对象的计算结果为 boolean`NO`和非 nil 对象的计算结果为 boolean `YES`。所以你可以很容易地写这个：

```
BOOL firstVisible = firstMeasure.isInVisibleArea;
BOOL notFirstVisible = !(firstMeasure.isInVisibleArea);
BOOL measureBufferNil = measureBuffer1;

BOOL test1 = !measureBuffer1 && !firstMeasure.isInVisibleArea;
BOOL test2 = measureBufferNil && !firstVisible;

if (measureBuffer1 && !firstMeasure.isInVisibleArea) {
    //do some action
} 
```

你最终会得到相同的结果。不过，我同意 GoatRider 的观点。将条件表达式括起来以阐明您真正想要发生的事情总是比依靠语言的运算符优先级为您做这件事要好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T20:04:14.557

如果 test1 如您所说的那样评估为 NO，则将 test1 放入 if 语句中：

```
if(test1){
    //see if this executes?
} 
```

看看有什么作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T09:04:28.193

我的预感是正确的，它与调用 firstMeasure.isInVisible 区域之间的视图框架变化有关。

响应视图移动调用整个例程。我想我需要在方法开始时获取 firstMeasure.isInVisibleArea 的值，并在整个过程中使用该值。

呸。布尔逻辑没有被破坏。世界上一切都好。

感谢您的输入

# optimization - 如何在海量数据集上实现自动完成

> ID：678987
> 
> 赞同：46
> 
> 时间：2009-03-24T19:53:19.250
> 
> 标签：optimization, autocomplete

我正在尝试在我正在构建的网站上实现类似于 Google 建议的功能，并且很好奇如何在一个非常大的数据集上进行操作。当然，如果您有 1000 个项目，您可以缓存这些项目并循环它们。但是，当您拥有一百万件物品时，您将如何处理呢？此外，假设这些项目不是一个词。具体来说，我对 Pandora.com 印象深刻。例如，如果您搜索“wet”，它会返回“Wet Sand”，但也会返回 Toad The Wet Sprocket。他们的自动完成功能很快。我的第一个想法是按前两个字母对项目进行分组，所以你会有类似的东西：

```
Dictionary<string,List<string>> 
```

其中关键是前两个字母。没关系，但是如果我想做类似于 Pandora 的事情并允许用户看到匹配字符串中间的结果怎么办？根据我的想法：Wet 永远不会与 Toad the Wet Sprocket 匹配，因为它将位于“TO”桶而不是“WE”桶中。那么也许你*可以*把绳子分开，把“Toad the Wet Sprocket”放在“TO”、“WE”和“SP”桶里（去掉“THE”这个词），但是当你说的是一百万每个条目可能不得不说几句话，这看起来你很快就会开始消耗大量内存。好的，这是一个很长的问题。想法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-24T20:00:57.903

[正如我在如何在列表上实现增量搜索中](https://stackoverflow.com/questions/658235/how-to-implement-incremental-search-on-a-list/658336#658336)指出的那样，您应该使用[Trie](http://en.wikipedia.org/wiki/Trie)或[Patricia trie](http://en.wikipedia.org/wiki/Radix_tree)之类的结构来搜索大型文本中的模式。

对于在某些文本中间发现模式，有一个简单的解决方案。我不确定这是否是最有效的解决方案，但我通常按以下方式进行。

当我在 Trie 中插入一些新文本时，我只是插入它，然后删除第一个字符，再次插入，删除第二个字符，再次插入......等等，直到整个文本被消耗掉。然后，您只需从根开始一次搜索即可发现每个插入文本的每个子字符串。生成的结构称为[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)，并且有很多优化可用。

而且速度真的非常快。要查找包含给定的 n 个字符序列的所有文本，您必须检查最多 n 个节点并在每个节点的子列表中执行搜索。根据子节点集合的实现（数组、列表、二叉树、跳过列表），假设仅不区分大小写的拉丁字母，您可能只需 5 个搜索步骤即可识别所需的子节点。插值排序可能有助于大型字母和具有许多子节点的节点，因为这些节点通常在根附近发现。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-24T20:56:11.423

不要试图自己实现这个（除非你只是好奇）。使用 Lucene 或 Endeca 之类的东西 - 它会节省您的时间和头发。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-24T20:22:26.013

在算法上与您的要求无关，但请确保您在 kaypress(es) 之后有 200 毫秒或更多的延迟（滞后），以便确保用户在发出异步请求之前已停止输入。这样，您将减少对服务器的冗余 http 请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T20:01:13.443

我会使用类似[trie](http://en.wikipedia.org/wiki/Trie)的东西，并让每个叶节点的值成为包含叶节点表示的单词的可能性列表。您可以按可能性顺序对它们进行排序，或者根据用户在搜索框中输入的其他词对它们进行动态排序/过滤，等等。它将在合理数量的 RAM 中快速执行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T20:02:53.267

您将项目保存在服务器端（如果数据集非常大且复杂，则可能在数据库中）并从客户端浏览器发送 AJAX 调用，该调用使用 json/xml 返回结果。您可以响应用户键入或使用计时器来执行此操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-16T20:18:30.347

如果你不想要一个 trie 并且你想要字符串中间的东西，你通常想要运行某种编辑距离函数（levenshtein distance），它会给你一个数字，表明 2 个字符串的匹配程度。这不是一个特别有效的算法，但对于像单词这样的东西来说并不重要，因为它们相对较短。如果您正在对 8000 个字符串进行比较，则可能需要几秒钟。我知道大多数语言都有实现，或者你可以在互联网上很容易地找到它的代码/伪代码。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-05-27T21:40:50.713

我已经为这个场景构建了[AutoCompleteAPI](http://autocompleteapi.com)。

注册以获取私有索引，然后上传您的文档。

在文档“New York”上使用 curl 上传示例：

```
curl -X PUT -H "Content-Type: application/json" -H "Authorization: [YourSecretKey]" -d '{
"key": "New York",
"input": "New York"
}' "http://suggest.autocompleteapi.com/[YourAccountKey]/[FieldName]" 
```

索引所有文档后，要获得自动完成建议，请使用：

```
http://suggest.autocompleteapi.com/[YourAccountKey]/[FieldName]?prefix=new 
```

您可以使用任何客户端自动完成库向用户显示这些结果。

# .net - 从 MVC 控制器类中删除数据库调用的最佳实践

> ID：678990
> 
> 赞同：1
> 
> 时间：2009-03-24T19:53:59.200
> 
> 标签：.net, asp.net, asp.net-mvc, linq-to-sql

我在 ASP.NET MVC 控制器类中有一个 Action 方法，它处理来自相当基本的“创建/编辑用户”页面的表单帖子。我是 MVC 的新手，所以我一直在关注各种 Microsoft 教程中的代码示例，这是该方法当前的样子：

```
[AcceptVerbs(HttpVerbs.Post)]
public ViewResult Save([Bind(Prefix = "ServiceUser")]ServiceUser SUser)
{
        if (SUser.ServiceUserId == 0) //new service user
            ServiceUserHelper.AddServiceUser(SUser);
        else //update to existing service user
        {
            using (ProjectDataContext db = DatabaseHelper.CreateContext())
            {
                this.UpdateModel(db.ServiceUsers.Single(su => su.ServiceUserId == SUser.ServiceUserId), "ServiceUser");
                db.SubmitChanges();
            }
        }

        //return a confirmation view
} 
```

这很好用；但是我的直觉告诉我“ProjectDataContext ...”代码不属于控制器。如果我将 Update 功能移动到另一个类（以我使用 Insert 方法的方式），我将失去 Controller 的 UpdateModel() 方法的便利性，并且可能最终不得不做一些非常冗长的事情读取现有实体，更新其属性并提交更改。

所以我的问题是，实现这一目标的最佳方法是什么？是否有类似于 LINQ 中某处的 UpdateModel() 的方法可以在提交之前将两个相同类型的实体合并在一起？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T20:08:01.460

大多数人会建议使用“存储库模式”将数据访问代码移出控制器（并使用模拟对象而不是真实数据库进行单元测试）。

这里有一些地方可以阅读更多：

*   [使用 Linq to Sql 和 C# 的 Repository 模式的实现示例](https://stackoverflow.com/questions/125453/implementation-example-for-repository-pattern-with-linq-to-sql-and-c)
*   [专业 ASP.NET MVC 第 1 章](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)（第 32 页）

**编辑：**

我强烈建议阅读上面链接的整个 Scott Guthrie 章节。它有很多好的建议。也就是说，这里有一些相关的例子（本章除外）......

首先，我通常喜欢对“更新”和“添加”有不同的操作。即使它们是呈现表单的相同视图，使用不同的 URL 来发布编辑与发布新记录通常感觉更清晰。因此，这是控制器更新操作中使用的存储库模式的样子：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(int id, FormCollection formValues)
{
    //get the current object from the database using the repository class
    Dinner dinner = dinnerRepository.GetDinner(id);
    try
    {
        //update the object with the values submitted
        UpdateModel(dinner);
        //save the changes
        dinnerRepository.Save();
        //redirect the user back to the read-only action for what they just edited
        return RedirectToAction("Details", new { id = dinner.DinnerID });
    }
    catch
    {
        //exception occurred, probably from UpdateModel, so handle the validation errors
        // (read the full chapter to learn what this extention method is)
        ModelState.AddRuleViolations(dinner.GetRuleViolations());
        //render a view that re-shows the form with the validation rules shown
        return View(dinner);
    }
} 
```

这是“添加”示例：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create()
{
    //create a new empty object
    Dinner dinner = new Dinner();
    try
    {
        //populate it with the values submitted
        UpdateModel(dinner);
        //add it to the database
        dinnerRepository.Add(dinner);
        //save the changes
        dinnerRepository.Save();
        //redirect the user back to the read-only action for what they just added
        return RedirectToAction("Details", new { id = dinner.DinnerID });
    }
    catch
    {
        //exception occurred, probably from UpdateModel, so handle the validation errors
        // (read the full chapter to learn what this extention method is)
        ModelState.AddRuleViolations(dinner.GetRuleViolations());
        //render a view that re-shows the form with the validation rules shown
        return View(dinner);
    }
} 
```

对于上面的两个示例，DinnerRepository 如下所示：

```
public class DinnerRepository
{
    private NerdDinnerDataContext db = new NerdDinnerDataContext();
    //
    // Query Methods
    public IQueryable<Dinner> FindAllDinners()
    {
        return db.Dinners;
    }
    public IQueryable<Dinner> FindUpcomingDinners()
    {
        return from dinner in db.Dinners
               where dinner.EventDate > DateTime.Now
               orderby dinner.EventDate
               select dinner;
    }
    public Dinner GetDinner(int id)
    {
        return db.Dinners.SingleOrDefault(d => d.DinnerID == id);
    }
    //
    // Insert/Delete Methods
    public void Add(Dinner dinner)
    {
        db.Dinners.InsertOnSubmit(dinner);
    }
    public void Delete(Dinner dinner)
    {
        db.RSVPs.DeleteAllOnSubmit(dinner.RSVPs);
        db.Dinners.DeleteOnSubmit(dinner);
    }
    //
    // Persistence
    public void Save()
    {
        db.SubmitChanges();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T14:45:13.257

我同意 Lee D 我也一直在寻找一些东西。在模型中使用的 MVC 预览中，我对反射做了类似的事情，而不是控制器。这不是最好的代码，并认为会在 MVC final 中添加一些东西。没有东西卡在控制器中。如果使用强类型视图，最好将表单或模型通过控制器传递到模型中，并在那里完成所有验证和数据移动。现在，即使是做得不好的控制器也无法处理数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T16:41:23.147

您目前拥有我所说的 2 层架构，其中包括您的 MVC 应用程序层（即控制器）和您的数据访问层。

您可能希望通过在控制器和 DAL 之间插入服务层来迁移到 3 或 4 层架构。所以你最终会得到：

控制器 -> 服务 -> DAL

4 层架构可能包括存储库层

控制器 -> 服务 -> 存储库 -> DAL

您的控制器只负责 3 件事

1) 参数处理 2) 调用你的服务层来做工作 2) 应用程序流

您上面的示例可能类似于：

```
[AcceptVerbs(HttpVerbs.Post)]
public ViewResult Save([Bind(Prefix = "ServiceUser")]ServiceUser SUser)
{
        // validate arguments
        if (SUser == null)
        {
              throw new ArgumentException("SUser can not be null");
        }

        // process form fields / query params / etc.
        this.TryUpdateModel(SUser, "ServiceUser");

        // update your model 
        // (toss in a try/catch to deal with validation errors etc)
        _userService.Save(SUser);

        //return a confirmation view
} 
```

然后你的服务层将负责做实际的工作：

```
 public class UserService : IUserService
   {
       public void Save(ServiceUser SUser)
       {
            // insert or update user info

            if (SUser.ServiceUserId == 0) //new service user
                ServiceUserHelper.AddServiceUser(SUser);
            else //update to existing service user
            {
                using (ProjectDataContext db = DatabaseHelper.CreateContext())
                {
                    db.ServiceUsers.Single(su => su.ServiceUserId == 
                                           SUser.ServiceUserId);
                    db.SubmitChanges();
                }
            }
       }
   } 
```

# c# - 使用 Interfaces ASP.Net Cluster Environment 执行 foreach 循环时的空引用

> ID：678992
> 
> 赞同：1
> 
> 时间：2009-03-24T19:54:24.363
> 
> 标签：c#, asp.net, interface, foreach

当控件创建它的子控件时，我在 Web 控件中有一个列表我通过字段列表执行 foreach 循环

```
foreach (IField field in this._fields)
{
   /* Do some work here */
} 
```

本地主机、开发环境和我们的暂存环境一切都很好。但是当我们部署到我们的开发集群时，每个“字段”在循环期间都是空的。什么会导致这些对象为空？当我从另一个数据列表加载此列表时，一切都加载正常并且该数据不为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T20:33:15.033

确保您没有在应用程序中使用应用程序级缓存来存储 IField 的内容，因为它不会在集群中的服务器之间复制。

如果您使用会话缓存，请再次确保在集群中运行时将其持久化到 SQL Server。如果是进程内的 Session 缓存，它对集群中的每个服务器都是唯一的（类似于 Application 缓存）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T20:21:01.913

首先检查：你是如何收集这些字段的？您是否在沿途某处作为 IField 做一些事情？如果它不实现 IField，这将有效地给出 null。

如果不是上述情况，那将是一个非常奇怪的情况。唯一想到的是，我在另一个提供商开发的应用程序中的一些清晰代码中看到了一些非常糟糕的东西：

```
void Clear()
{
    //some normal code to clear info on some controls
    myTextBox = null;
    anotherTextBox = null;
} 
```

虽然这样做没有意义，但它实际上会给 asp.net 带来麻烦。在某些特定的回发场景中，asp.net 在其生命周期的某些内部部分中失败并出现 nullreferenceexception。

因此，还要检查是否有一些奇怪的例程将 null 分配给页面上声明的控件。

# sql-server - 从 sp_HelpConstraint 拉取/捕获数据

> ID：678996
> 
> 赞同：0
> 
> 时间：2009-03-24T19:55:06.203
> 
> 标签：sql-server

在 SQL Server 2005 T-SQL 中，我真的很想提取这些列：

```
约束类型、约束名称和约束键
```

来自**sp_HelpConstraint**的输出。但是它返回 3 个结果集（如果您传入 'nomsg'，则返回 2 个），因此您不能这样做来捕获它：

```
CREATE TABLE #Constraints
(
...
)

INSERT INTO #Constraints
        (...        )
    EXECUTE sp_HelpConstraint 'TableName', 'nomsg' 
```

我能想到的唯一方法不是好的方法：

*   只需从 sp_HelpConstraint 复制我需要的代码
*   “修复” sp_HelpConstraint 所以“nomsg”也删除了最后一个结果集

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T20:01:46.997

希望您使用 SQL 2005+ [sys.default_constraints](http://msdn.microsoft.com/en-us/library/ms189783(SQL.90).aspx)等以允许标准 SELECT

否则，您可以在 SQL 2000 + 上使用[信息架构视图](http://msdn.microsoft.com/en-us/library/ms186778(SQL.90).aspx)

# function - 用于基于短字符串计算整数哈希键的 CPAN 模块

> ID：678998
> 
> 赞同：0
> 
> 时间：2009-03-24T19:55:18.697
> 
> 标签：function, hash, integer, cpan

我正在寻找一个需要短字符串的 CPAN 模块：

```
my $hash_value = hash_this('short string not too long'); 
```

并将其散列成一个整数键：

```
say $hash_value;

12345671234    # an integer key 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T20:29:13.733

摘要::MD5 应该可以工作：

[http://metacpan.org/pod/Digest::MD5](http://metacpan.org/pod/Digest::MD5)

使用二进制文件，您应该能够使用它进行转换：

数学::BaseCnv

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-01T14:36:42.893

如果您需要一个只有 32 位或 64 位长的散列*，也就是说，如果您需要计算机科学术语中使用的类型的散列，例如“[散列表](http://en.wikipedia.org/wiki/Hash_table)”，而不是[密码学意义上的散列](http://en.wikipedia.org/wiki/Cryptographic_hash_function)（即不能同时又短又强）您可以使用 CRC32 或其朋友之一。

OTOH，如果您需要加密强大的哈希函数，我现在会[避免使用 MD5](http://en.wikipedia.org/wiki/MD5#Vulnerability)并使用 SHA-256。

```
use String::CRC32;

$crc = crc32("some string"); 
```

*: 我不知道 perl 整数值有多大，所以我可能错了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-21T16:44:06.440

我写了[Algorithm::Nhash](http://metacpan.org/pod/Algorithm::Nhash)来解决这个确切的问题。它从一个字符串生成一个廉价的散列，并可选地进行模运算以将字符串放入存储桶中。**********