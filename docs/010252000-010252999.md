# StackOverflow 问答 10252000-10252999

# jquery - 如何在jquery中随机将字符串拆分为数组

> ID：10252000
> 
> 赞同：2
> 
> 时间：2012-04-20T19:00:03.067
> 
> 标签：jquery, arrays, split

我有这个代码：

```
var str = 'one, two, three';
var substr = str.split(', '); 
```

这将按照我们的预期创建数组。但是有没有办法拆分单词，打乱它们然后将它们插入到 substr 数组中？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T19:09:45.160

本机 sort() 函数可以获取一个函数作为参数，让您决定如何对数组进行排序。

所以你可以给它一个函数来生成随机结果。

```
var str = 'one, two, three';
var substr = str.split(', ');

substr.sort(function () {
    return( parseInt( Math.random()*10 ) %2 );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:22:08.963

我得到的答案大多与 keune 相同，只是风格不同:)

```
var random_results = 'one, two, three'.
                        split(/\s*,\s*/).
                        sort(function(){
                            return (-1 + Math.floor((Math.random() * 3))) 
                        }) 
```

*   我将您的显式 ', ' 拆分为正则表达式。如果您打算只匹配那个特定的子字符串，那很好，但是如果您正在处理用户输入，那么编写拆分很方便，这样您就可以处理逗号之前或之后存在的空格，并由`split`功能。
*   keune 和我都为我们的`sort()`函数计算不同的返回值。两者都提供随机结果；只要您返回一个可能是负数或正数的随机整数值，您就可以获得您的洗牌数组。

此外，作为一个次要的风格说明，这与 JQuery 无关。这是纯 JavaScript。

# php - 有人可以看看这个 php 文件，看看他们是否能发现问题。我很难过

> ID：10252002
> 
> 赞同：-2
> 
> 时间：2012-04-20T19:00:06.547
> 
> 标签：php

我的主要网站在文档开头引用了这个 php 文件，如下所示

```
<?php
include('db.php');
include('func.php');
?> 
```

db.php 是一个数据库参考文件，它工作正常。但是，一旦我引用 func.php，该网站就会出现以下错误：

HTTP 错误 500（内部服务器错误）：服务器尝试完成请求时遇到了意外情况。

因此，如果您查看以下代码并查看是否可以发现导致这种情况发生的错误，我会很高兴。先感谢您。

```
<?php
require_once('models.php');
require_once('phpspellcheck/include.js');
$spellcheckObject = new PHPSpellCheck();
$spellcheckObject -> LicenceKey = "TRIAL";
$spellcheckObject -> DictionaryPath = ("phpspellcheck/dictionaries/");
$spellcheckObject -> LoadDictionary("English (International)") ;
$spellcheckObject -> LoadCustomDictionary("custom.txt");

$ckfile = tempnam('/tmp', 'ADCOOK');

//**************************************
//     Page load dropdown results     //
//**************************************
function getTierOne()
{
    /*$result = mysql_query("SELECT DISTINCT vmake FROM vmake") 
    or die(mysql_error());

      while($tier = mysql_fetch_array( $result )) 

        {
           echo '<option value="'.$tier['vmake'].'">'.$tier['vmake'].'</option>';
        }*/

}

//**************************************
//     First selection results     //
//**************************************
if(isset($_GET['func']) && $_GET['func'] == "vmake") { 
   vmake($_GET['drop_var']); 
}

function vmake($drop_var)
{  
    /*include_once('db.php');
    $result = mysql_query("SELECT * FROM vmake WHERE vmake='$drop_var'") 
    or die(mysql_error());

    echo '
          <option style="width:242" value=" " selected="selected">Model</option>';

           while($drop_2 = mysql_fetch_array( $result )) 
            {
              echo '<option style="width:242" value="'.$drop_2['vmodel'].'">'.$drop_2['vmodel'].'</option>';
            }

*/

}

if(isset($_POST['email'])) {
    // Keep count
    $count = 0;

    // Time to process searches!

    // Is it a familiar zip code?
    if(substr($_POST['zip'], 0, 2) == '45') {
        if($_POST['homesearch'] == true) {
            $count = craigs('http://ogden.craigslist.org/search/sss', $_POST['city'] . ' ' . $_POST['propertytype'], $_POST['pricemin'], $_POST['pricemax']);
        } elseif($_POST['carsearch'] == true) {
            $count = craigs('http://ogden.craigslist.org/search/sss', $_POST['vmake'] . ' ' . $_POST['vmodel'], $_POST['pricemin'], $_POST['pricemax']);
        } else {
            $count = craigs('http://ogden.craigslist.org/search/sss', $_POST['item'], $_POST['pricemin'], $_POST['pricemax']);
        }
    } elseif(substr($_POST['zip'], 0, 2) == '65') {
        if($_POST['homesearch'] == true) {
            $count = craigs('http://boise.craigslist.org/search/sss', $_POST['city'] . ' ' . $_POST['propertytype'], $_POST['pricemin'], $_POST['pricemax']);
        } elseif($_POST['carsearch'] == true) {
            $count = craigs('http://boise.craigslist.org/search/sss', $_POST['vmake'] . ' ' . $_POST['vmodel'], $_POST['pricemin'], $_POST['pricemax']);
        } else {
            $count = craigs('http://boise.craigslist.org/search/sss', $_POST['item'], $_POST['pricemin'], $_POST['pricemax']);
        }
    }
    // Okay, it's neither.
    // Is it a home search?
    elseif(isset($_POST['homesearch']) && $_POST['homesearch'] == true) {
        // First off, let's split up the cities.
        $cities = explode(',', $_POST['city']);

        // Now, let's translate our owner types.
        if($_POST['homeseller'] == 'owner') {
            $homeseller = '1';
        } elseif($_POST['homeseller'] == 'agent') {
            $homeseller = '0';
        } else {
            $homeseller = '';
        }

        // Now, let's translate our apartment types.
        if($_POST['propertytype'] == '') {
            $propertytype = 0;
        } elseif($_POST['propertytype'] == 'apartment') {
            $propertytype = 3;
        } elseif($_POST['propertytype'] == 'singlefamily') {
            $propertytype = 1;
        } elseif($_POST['propertytype'] == 'townhome') {
            $propertytype = 2;
        } elseif($_POST['propertytype'] == 'manufactured') {
            $propertytype = 4;
        } elseif($_POST['propertytype'] == 'horse') {
            $propertytype = 5;
        } elseif($_POST['propertytype'] == 'vacation') {
            $propertytype = 6;
        } elseif($_POST['propertytype'] == 'multi') {
            $propertytype = 7;
        } else {
            $propertytype = '';
        }

        //function house($item = null, $type = 0, $city = null, $state = null, $zip = null, $distance = null, $seller = null, $pricemin = null, $pricemax = null, $minsqft = null, $maxsqft = null, $minacres = null, $maxacres = null, $minbed = null)
        foreach($cities as $city) {
            $count = house($_POST['item'], $propertytype, $_POST['city'], $_POST['state'], $_POST['zip'], $_POST['distance'], $homeseller, $_POST['pricemin'], $_POST['pricemax'], $_POST['minsqfeet'], $_POST['maxsqfeet'], $_POST['minacres'], $_POST['maxacres'], $_POST['minbedrooms']);
        }
    } elseif(isset($_POST['carsearch']) && $_POST['carsearch'] == true) {
        //function car($pricemin, $pricemax, $vmake, $vmodel, $minmileage, $maxmileage, $year, $carseller, $doors)
        $count = car($_POST['pricemin'], $_POST['pricemax'], $_POST['vmake'], $_POST['vmodel'], $_POST['minmileage'], $_POST['maxmileage'], $_POST['year'], $_POST['carseller'], $_POST['doors']);
    } else {
        $count = ksl($_POST['item'], $_POST['zip'], $_POST['distance'], $_POST['pricemin'], $_POST['pricemax']);
    }

    $perDay = round($count/7);

    if ($count > 14) {
        echo "<p>Based on your search criteria, we estimate that you will receive approximately $perDay alerts a day.</p><p>If this is ok, just press SUBMIT. If not, please press edit and be more specific in your search criteria.</p><p><input type=\"submit\" value=\"Submit\" onclick=\"doSubmit()\" /><input type=\"submit\" value=\"Edit\" onclick=\"$('.loading').dialog('destroy')\" /></p>";
    } elseif ($count > 0) {
        doSubmit();
    } else {
        $bad = false;
        $words = explode(" ", $_POST['item']) {
        if(count($words) > 0) {
            foreach($words as $word) {
                if(!$spellcheckObject->SpellCheckWord($word)) { $bad = true; }
            }
        }
        if($bad) {
            echo "<p>Current estimates show no results based on your current criteria.</p><p>Please ensure the all details are accurate before proceeding.</p><p><input type=\"submit\" value=\"Submit\" onclick=\"doSubmit()\" /><input type=\"submit\" value=\"Edit\" onclick=\"$('.loading').dialog('destroy')\" /></p>";
        } else { 
            doSubmit();
        }
    }
}

// curl
function curl($url, $post=false, $cookie=false) {
    global $ckfile;

    $curl_handle = curl_init();

    if($cookie == 'init') {
        curl_setopt($curl_handle, CURLOPT_COOKIEJAR, $ckfile);
    }

    curl_setopt($curl_handle, CURLOPT_COOKIEFILE, $ckfile);
    curl_setopt($curl_handle, CURLOPT_URL, $url);
    curl_setopt($curl_handle, CURLOPT_CONNECTTIMEOUT, 5);
    curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER, 1);

    if($post <> false) {
        curl_setopt($curl_handle, CURLOPT_POST, TRUE);
        curl_setopt($curl_handle, CURLOPT_POSTFIELDS, $post['data']);
    }

    $result = curl_exec($curl_handle);
    curl_close($curl_handle);

    return $result;
}

// craigslist
function craigs($url, $item = null, $pricemin = null, $pricemax = null)
{
    $i = 0;

    // http://ogden.craigslist.org/search/sss?query={item}&srchType=A&minAsk={pricemin}&maxAsk={pricemax}
    $result = curl("$url?query=$item&srchType=A&minAsk=$pricemin&maxAsk=$pricemax");

    if(strpos($result, 'Nothing found for that search') === false) {
        preg_match_all('/<p class="row">.*?<\/p>/is', $result, $output, PREG_PATTERN_ORDER);

        $sevenDaysAgo = strtotime('8 days ago');
        $total = 0;

        foreach($output[0] as $out) {
                if($i < 100) {
                        preg_match_all('/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s*\d{1,2}/is', $out, $date, PREG_PATTERN_ORDER);

                        foreach($date[0] as $day) {
                                // Total count
                                $total++;

                                // Let's strip extra spaces...
                                $finalDay = preg_replace('/\s\s+/is', ' ', $day);

                                // Let's compare the dates...
                                if ($sevenDaysAgo < strtotime($finalDay)) {
                                        $i++;
                                }
                        }
                }
        }
    } else {
        // Nothing found.
    }

    return $i;
}

// ksl
function ksl($item = null, $zip = null, $distance = null, $pricemin = null, $pricemax = null)
{
    $i = 0;

    // http://www.ksl.com/index.php?nid=231&search=radio&zip=45174&distance=10&min_price=1&max_price=500&addisplay=%5BNOW-7DAYS+TO+NOW%5D&sort=5&nocache=1&viewNumResults=70&sort=5
    $result = curl("http://www.ksl.com/index.php?nid=231&search=$item&zip=$zip&distance=$distance&min_price=$pricemin&max_price=$pricemax&addisplay=%5BNOW-7DAYS+TO+NOW%5D&sort=5&nocache=1&viewNumResults=70&sort=5");

    if(strpos($result, 'There are no listings for this search.') === false) {
        preg_match_all('/<div class="adBox">.*?<\/div>/is', $result, $output, PREG_PATTERN_ORDER);

        $i = count($output[0]);
    } else {
        // Nothing found.
    }

    return $i;
}

// house
function house($item = null, $type = 0, $city = null, $state = null, $zip = null, $distance = null, $seller = null, $pricemin = null, $pricemax = null, $minsqft = null, $maxsqft = null, $minacres = null, $maxacres = null, $minbed = null)
{
    // http://www.ksl.com/index.php?si=5017903&nid=651&city=Salt+Lake+City&zipcode=&distance=&state=&start=&end=25000&keyword=&sellertype=&acresstart=&acresend=&sqftstart=&sqftend=&bedrooms=&type=&homes_search=Search

    $done = false;
    $pid = 1;
    $i = 0;
    $sevenDaysAgo = strtotime('8 days ago');
    $total = 0;

    while(!$done) {
        $result = curl("http://www.ksl.com/index.php?sid=5017903&nid=651&city=$city&zipcode=$zip&distance=$distance&state=$state&start=$pricemin&end=$pricemax&keyword=$item&sellertype=$seller&acresstart=$minacres&acresend=$maxacres&sqftstart=$minsqft&sqftend=$maxsqft&bedrooms=$minbed&type=&homes_search=Search&pid=$pid");

        if(strpos($result, '0 results') === false) {
            preg_match_all('/<div class="postDate">.*?<\/div>/is', $result, $output, PREG_PATTERN_ORDER);

            if(count($output[0] != 0)) {
                foreach($output[0] as $out) {
                    // Check the date on this entry.
                    preg_match_all('/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s*\d{1,2}/is', $out, $date, PREG_PATTERN_ORDER);
                    foreach($date[0] as $day) {
                        // Total count
                        $total++;
                        // Let's strip extra spaces...
                        $finalDay = preg_replace('/\s\s+/is', ' ', $day);
                        // Let's compare the dates...
                        if ($sevenDaysAgo < strtotime($finalDay)) {
                            $i++;
                        }
                    }
                }

                if ($i >= 70) {
                    $done = true;
                }

                $pid++;
            } else {
                $done = true;
            }
        } else {
            $done = true;
        }
    }

    return $i;
}

// car search
function car($pricemin, $pricemax, $vmake, $vmodel, $minmileage, $maxmileage, $year, $carseller, $doors)
{
    // Car values
    // $carMake = array(); - This is included in an external file.

    // $carModel = array(); - This is included in an external file.

    $carSeller = array(
                'dealer' => 288110,
                'owner' => 20);

    // Let's setup our post data:
    if(trim($vmake) <> "") {
        $fields['make'][$carMake[$vmake]] = 1;
    }

    if (trim($vmodel) <> "" && $vmodel <> 0) {
        $fields['model'][$carModel[$vmodel]] = 1;
    }

    if ($pricemin <> "") {
        $fields['sell_price'][$pricemin] = 1;
    }

    if ($pricemax <> "") {
        $fields['sell_price'][$pricemax] = 1;
    }

    if ($minmileage <> "") {
        $fields['mileage'][$minmileage] = 1;
    }

    if ($maxmileage <> "") {
        $fields['mileage'][$maxmileage] = 1;
    }

    if(is_array($doors)) {
        foreach($doors as $door) {
            $fields['doors'][$door] = 1;
        }
    }

    if(is_array($year)) {
        foreach($year as $yr) {
            $fields['year'][$yr] = 1;
        }
    }

    if(is_array($carseller)) {
        foreach($carseller as $seller) {
            if($seller == '' || $seller == ' ') { 
                $fields['seller_type']['0'] = 1;
            } else {
                $fields['seller_type'][$carSeller[$seller]] = 1;
            }
        }
    }

    // We need to firstly initiate a cookie. This is done like so.
    curl('http://www.ksl.com/index.php?sid=0&nid=443', false, 'init');

    // Then, we need to set our search values. We can send a post value to do this.

    $data = 'call='.urlencode('save_query').'&sdata='.urlencode(urlencode(serialize($fields))).'&run='.urlencode('resources/community/java/community_rpc.php');

    $post['count'] = 3;
    $post['data'] = $data;

    // Submit our post data...

    $done = false;
    $pid = 0;
    $i = 0;
    $sevenDaysAgo = strtotime('8 days ago');

    while(!$done) {
        // do curl here
        $result = curl("http://www.ksl.com/index.php?sid=0&nid=443&tab=list&pid=$pid", false, true);
        $f = fopen('f.txt', 'w');
        fwrite($f, $result);
        fclose($f);

        if(strpos($result, 'There are no listings for this search.') === false) {
            preg_match_all('/<div class="adTime">.*?<\/div>/is', $result, $output, PREG_PATTERN_ORDER);

            if(count($output[0] != 0)) {
                foreach($output[0] as $out) {
                    // Check the date on this entry.
                    preg_match_all('/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s*\d{1,2}/is', $out, $date, PREG_PATTERN_ORDER);

                    foreach($date[0] as $day) {
                        // Let's strip extra spaces...
                        $finalDay = preg_replace('/\s\s+/is', ' ', $day);
                        // Let's compare the dates...
                        if ($sevenDaysAgo < strtotime($finalDay)) {
                            $i++;
                        }
                    }
                }

                if ($i >= 70) {
                    $done = true;
                }

                $pid++;
            } else {
                $done = true;
            }
        } else {
            $done = true;
            // Nothing found.
        }
    }

    return $i;
}

function doSubmit() {
foreach($_POST as $key => $value) {
    // This should trim any extra spaces in addition to any newlines or tabs.
    $_POST[$key] = preg_replace(array('/\s{2,}/', '/[\t\n]/'), ' ', $value);
}

$email=$_POST['email'];
$phone=$_POST['phone'];
$item=$_POST['item'];
$pricemin=$_POST['pricemin'];
$pricemax=$_POST['pricemax'];
$zip=$_POST['zip'];
$miles=$_POST['miles'];
$carsearch=$_POST['carsearch'];
$vmake=$_POST['vmake'];
$vmodel=$_POST['vmodel'];
$minmileage=$_POST['minmileage'];
$maxmileage=$_POST['maxmileage'];
$year=$_POST['year'];
$carseller=$_POST['carseller'];
$doors=$_POST['doors'];
$homesearch=$_POST['homesearch'];
$propertytype=$_POST['propertytype'];
$city=$_POST['city'];
$state=$_POST['state'];
$homeseller=$_POST['homeseller'];
$minacres=$_POST['minacres'];
$maxacres=$_POST['maxacres'];
$minsqfeet=$_POST['minsqfeet'];
$maxsqfeet=$_POST['maxsqfeet'];
$minbedrooms=$_POST['minbedrooms'];
$maxbedrooms=$_POST['maxbedrooms'];

// check email & phone validity
if(!preg_match("/^[_a-z0-9-]+(.[_a-z0-9-]+)*@[a-z0-9-]+(.[a-z0-9-]+)*(.[a-z]{2,3})$/i", $email) && !preg_match("/^([1]-)?[0-9]{3}-[0-9]{3}-[0-9]{4}$/i", $phone)) {
    die();
}
$url="id.txt";
$id=file($url);
$next=$id[0]+1;

$fp=fopen("form$next.txt", "a");
$fh=fopen($url, 'w') or die ("cant open file");
$savestring =  $carsearch . "\n" . $homesearch . "\n" . $next . "\n" . $email . "\n" . $phone . "\n" . $item . "\n" . $pricemin . "\n" . $pricemax . "\n"  . $zip . "\n"   . $miles . "\n"   . $vmake . "\n"  . $vmodel . "\n"  . $minmileage . "\n" . $maxmileage . "\n"  . implode(",",$_POST['year']) . "\n" . implode(",",$_POST['carseller']) . "\n" . implode(",",$_POST['doors']) . "\n"  . $propertytype . "\n"  . $city . "\n"  . $state . "\n"  . $homeseller . "\n"  . $minacres . "\n"  . $maxacres . "\n"  . $minsqfeet . "\n"  . $maxsqfeet . "\n"  . $minbedrooms . "\n"  . $maxbedrooms . "\n";
fwrite($fp, $savestring);
fclose($fp);
unlink("id.txt");
$fa=fopen("id.txt", "a");
fwrite($fa, $next);
fclose($fa)

//header("Location:http://www.mywebsite.com/formsubmit.html");
echo "<script type=\"text/javascript\">window.location = \"http://www.mywebsite.com/formsubmit.html"\"</script";
}

unlink($ckfile);
?> 
```

它有很多东西要看，但我现在完全被难住了。再次感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:03:40.597

我认为您需要添加分号。:)

```
<?php
  include('db.php')
  include('func.php')
?> 
```

应该成为

```
<?php
  include('db.php');
  include('func.php');
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:09:48.977

这是你的问题：

```
 $words = explode(" ", $_POST['item']) { 
```

应该

```
 $words = explode(" ", $_POST['item']); 
```

# javascript - 从 JavaScript 将文件写入 Windows 操作系统以保留浏览器配置

> ID：10252006
> 
> 赞同：-2
> 
> 时间：2012-04-20T19:00:17.800
> 
> 标签：javascript, windows, file, save

此示例允许您在单击“保存到磁盘”按钮后选择将文件保存到磁盘的位置。但是，我想自动执行此操作，而无需选择文件位置。在 JavaScript 中发生事件后，我想根据预先确定的路径/文件创建文件或更新文件。如何才能做到这一点？

[http://pixelgraphics.us/downloadify/test.html](http://pixelgraphics.us/downloadify/test.html)

我正在尝试跟踪浏览器配置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:01:15.570

不能这样做，出于安全原因，我认为这很明显。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:12:58.170

您无法将文件写入光盘，但您确实有几个选择：

*   [饼干](https://developer.mozilla.org/en/DOM/document.cookie)
*   [索引数据库](https://developer.mozilla.org/en/IndexedDB)

# entity-framework - 创建 ADO.Net 实体数据模型时出错

> ID：10252007
> 
> 赞同：0
> 
> 时间：2012-04-20T19:00:17.877
> 
> 标签：entity-framework, sql-server-ce

前段时间，我创建了一个小型应用程序，它使用带有实体框架的 SQL CE 4.0 数据库。

无法从 4.0 数据库生成模型，我从相同的 3.5 数据库模式生成它，然后重新指向配置文件并更新了提供程序引用。

今天我需要更新架构。

我更新了 3.5 数据库模式，更新了模型，然后将配置指向 4.0 数据库。

现在我在构建时收到错误：“错误 175：在配置中找不到指定的商店提供程序，或者无效”

经过几个小时的尝试解决这个问题，我创建了一个全新的解决方案，将其指向 3.5 数据库，并尝试创建一个新的 ADO.Net 实体数据模型。模型已生成，但在构建解决方案时，我得到与以前相同的错误。

在我的机器上，SQL CE 3.5 和 SQL CE 4.0 都安装了。

除了从机器上删除两个框架并重新安装它们之外，我不知道接下来要尝试什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T06:05:21.633

您可以使用我的 SQL Server Compact 工具箱 VS 插件在您的项目中创建更新的 edmx 文件，并且通过 about 对话框您还可以检查 4.0 DbProvider 是否已正确安装。

为此，请在数据库名称 ([your_database].sdf) 上单击鼠标右键，然后单击“将实体数据模型添加到当前项目”

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-21T12:56:42.060

卸载所有版本的 SQL Compact，重新启动并重新安装 SQL CE 3.5

现在一切正常。

# jquery - 模糊事件也包括提交按钮/jquery

> ID：10252008
> 
> 赞同：1
> 
> 时间：2012-04-20T19:00:20.120
> 
> 标签：jquery, button, submit, blur

当我在输入文本字段中使用模糊事件时，它包括所有页面，但也包括提交按钮。那么如何避免模糊事件不包含提交按钮呢？

这是html代码：

```
<form>
   <input type="text" value="EMAIL ADDRESS_" id="text" />
   <input type="submit" val="" id="submit" />
</form> 
```

和脚本：

```
$('form input[type!=submit]').focus(function(){
     $(this).val("");
     });
$('form input[type!=submit]').blur(function(){
     if(this.value==""){
     $(this).val("EMAIL ADDRESS_");
  }
}); 
```

我从上一个问题中获取了这段代码，但它不起作用。Blur 事件仍然包括提交按钮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:05:05.300

我认为与其避免选择一个字段，不如指定要考虑选择的项目。否则，如果某人/您将来可能会在表单中添加一个新元素，您可能想知道“刚刚添加的元素”的这种行为（模糊和焦点）来自哪里！

```
$(function(){
 $("form input[type='text']").focus(function(){
       $(this).val("");
     });
 $("form input[type='text']").blur(function(){
     if(this.value==""){
        $(this).val("EMAIL ADDRESS_");
      }
  });
}); 
```

请注意，您仍然针对**所有类型为 text 的输入字段**。因此，如果可能，请尝试通过将类名应用于这些元素并将其用作选择器来使其更具体。或者您也可以使用元素的**id**。

```
$("form #yourElemntId").focus(function(){
   //do stuff
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T15:26:05.260

您的解决方案几乎很好，您只是缺少之间的引号`submit`

```
$("form input[type!='submit']").focus(function(){
     $(this).val("");
     });
$("form input[type!='submit']").blur(function(){
     if(this.value==""){
     $(this).val("EMAIL ADDRESS_");
  }
}); 
```

# python - 将类实例序列化为 JSON

> ID：10252010
> 
> 赞同：236
> 
> 时间：2012-04-20T19:00:21.920
> 
> 标签：python, json, serialization, pickle

我正在尝试创建一个类实例的 JSON 字符串表示并且遇到了困难。假设这个类是这样构建的：

```
class testclass:
    value1 = "a"
    value2 = "b" 
```

对 json.dumps 的调用是这样的：

```
t = testclass()
json.dumps(t) 
```

它失败并告诉我测试类不是 JSON 可序列化的。

```
TypeError: <__main__.testclass object at 0x000000000227A400> is not JSON serializable 
```

我也尝试过使用 pickle 模块：

```
t = testclass()
print(pickle.dumps(t, pickle.HIGHEST_PROTOCOL)) 
```

它提供类实例信息，但不提供类实例的序列化内容。

```
b'\x80\x03c__main__\ntestclass\nq\x00)\x81q\x01}q\x02b.' 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2012-04-20T19:09:39.850

基本问题是 JSON 编码器`json.dumps()`默认只知道如何序列化一组有限的对象类型，所有内置类型。在此处列出：[https ://docs.python.org/3.3/library/json.html#encoders-and-decoders](https://docs.python.org/3.3/library/json.html#encoders-and-decoders)

一种好的解决方案是让您的类继承`JSONEncoder`并实现该`JSONEncoder.default()`函数，并使该函数为您的类发出正确的 JSON。

一个简单的解决方案是调用该实例`json.dumps()`的`.__dict__`成员。这是一个标准的 Python `dict`，如果你的类很简单，它将是 JSON 可序列化的。

```
class Foo(object):
    def __init__(self):
        self.x = 1
        self.y = 2

foo = Foo()
s = json.dumps(foo) # raises TypeError with "is not JSON serializable"

s = json.dumps(foo.__dict__) # s set to: {"x":1, "y":2} 
```

此博客文章中讨论了上述方法：

    [*使用 _ dict* _将任意 Python 对象序列化为 JSON](http://www.marcstober.com/blog/2007/07/07/serializing-arbitrary-python-objects-to-json-using-__dict__/)

当然，Python 提供了一个内置函数`.__dict__`供您访问，称为`vars()`.

所以上面的例子也可以这样写：

```
s = json.dumps(vars(foo)) # s set to: {"x":1, "y":2} 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2016-12-17T16:25:13.633

有一种方法对我很有用，您可以尝试一下：

`json.dumps()`可以采用可选参数**默认值**，您可以在其中为未知类型指定自定义序列化程序函数，在我的情况下看起来像

```
def serialize(obj):
    """JSON serializer for objects not serializable by default json code"""

    if isinstance(obj, date):
        serial = obj.isoformat()
        return serial

    if isinstance(obj, time):
        serial = obj.isoformat()
        return serial

    return obj.__dict__ 
```

前两个 if 用于日期和时间序列化，然后`obj.__dict__`返回任何其他对象。

最后的调用看起来像：

```
json.dumps(myObj, default=serialize) 
```

当您序列化一个集合并且您不想`__dict__`为每个对象显式调用时，它特别好。在这里它会自动为您完成。

到目前为止对我来说效果很好，期待你的想法。

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2017-06-27T10:21:37.983

您可以`default`在函数中指定命名参数`json.dumps()`：

```
json.dumps(obj, default=lambda x: x.__dict__) 
```

解释：

形成文档（[2.7](https://docs.python.org/2/library/json.html#basic-usage)，[3.6](https://docs.python.org/3/library/json.html#basic-usage)）：

```
``default(obj)`` is a function that should return a serializable version
of obj or raise TypeError. The default simply raises TypeError. 
```

（适用于 Python 2.7 和 Python 3.x）

注意：在这种情况下，您需要`instance`变量而不是`class`变量，正如问题中的示例试图做的那样。（我假设提问者是`class instance`一个类的对象）

我首先从@phihag[在这里](https://stackoverflow.com/questions/7408647/convert-dynamic-python-object-to-json)的回答中了解到这一点。发现它是完成这项工作的最简单和最干净的方法。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2017-03-05T17:57:41.643

使用[jsonpickle](http://jsonpickle.github.io/)

```
import jsonpickle

object = YourClass()
json_object = jsonpickle.encode(object) 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2013-07-10T14:36:02.750

我只是做：

```
data=json.dumps(myobject.__dict__) 
```

这不是完整的答案，如果你有某种复杂的对象类，你肯定不会得到所有东西。但是，我将它用于一些简单的对象。

一个非常有效的方法是您从 OptionParser 模块获得的“选项”类。在这里，它与 JSON 请求本身一起出现。

```
 def executeJson(self, url, options):
        data=json.dumps(options.__dict__)
        if options.verbose:
            print data
        headers = {'Content-type': 'application/json', 'Accept': 'text/plain'}
        return requests.post(url, data, headers=headers) 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-08-19T04:34:59.917

Python3.x

我能用我的知识达到的最好方法就是这个。
请注意，此代码也处理 set()。
这种方法是通用的，只需要类的扩展（在第二个例子中）。
请注意，我只是对文件执行此操作，但根据您的喜好修改行为很容易。

然而，这是一个编解码器。

通过更多的工作，您可以以其他方式构建您的类。我假设一个默认构造函数来实例化它，然后我更新类字典。

```
import json
import collections

class JsonClassSerializable(json.JSONEncoder):

    REGISTERED_CLASS = {}

    def register(ctype):
        JsonClassSerializable.REGISTERED_CLASS[ctype.__name__] = ctype

    def default(self, obj):
        if isinstance(obj, collections.Set):
            return dict(_set_object=list(obj))
        if isinstance(obj, JsonClassSerializable):
            jclass = {}
            jclass["name"] = type(obj).__name__
            jclass["dict"] = obj.__dict__
            return dict(_class_object=jclass)
        else:
            return json.JSONEncoder.default(self, obj)

    def json_to_class(self, dct):
        if '_set_object' in dct:
            return set(dct['_set_object'])
        elif '_class_object' in dct:
            cclass = dct['_class_object']
            cclass_name = cclass["name"]
            if cclass_name not in self.REGISTERED_CLASS:
                raise RuntimeError(
                    "Class {} not registered in JSON Parser"
                    .format(cclass["name"])
                )
            instance = self.REGISTERED_CLASS[cclass_name]()
            instance.__dict__ = cclass["dict"]
            return instance
        return dct

    def encode_(self, file):
        with open(file, 'w') as outfile:
            json.dump(
                self.__dict__, outfile,
                cls=JsonClassSerializable,
                indent=4,
                sort_keys=True
            )

    def decode_(self, file):
        try:
            with open(file, 'r') as infile:
                self.__dict__ = json.load(
                    infile,
                    object_hook=self.json_to_class
                )
        except FileNotFoundError:
            print("Persistence load failed "
                  "'{}' do not exists".format(file)
                  )

class C(JsonClassSerializable):

    def __init__(self):
        self.mill = "s"

JsonClassSerializable.register(C)

class B(JsonClassSerializable):

    def __init__(self):
        self.a = 1230
        self.c = C()

JsonClassSerializable.register(B)

class A(JsonClassSerializable):

    def __init__(self):
        self.a = 1
        self.b = {1, 2}
        self.c = B()

JsonClassSerializable.register(A)

A().encode_("test")
b = A()
b.decode_("test")
print(b.a)
print(b.b)
print(b.c.a) 
```

* * *

**编辑**

通过更多的研究，我找到了一种无需**SUPERCLASS**注册方法调用即可泛化的方法，使用**元类**

```
import json
import collections

REGISTERED_CLASS = {}

class MetaSerializable(type):

    def __call__(cls, *args, **kwargs):
        if cls.__name__ not in REGISTERED_CLASS:
            REGISTERED_CLASS[cls.__name__] = cls
        return super(MetaSerializable, cls).__call__(*args, **kwargs)

class JsonClassSerializable(json.JSONEncoder, metaclass=MetaSerializable):

    def default(self, obj):
        if isinstance(obj, collections.Set):
            return dict(_set_object=list(obj))
        if isinstance(obj, JsonClassSerializable):
            jclass = {}
            jclass["name"] = type(obj).__name__
            jclass["dict"] = obj.__dict__
            return dict(_class_object=jclass)
        else:
            return json.JSONEncoder.default(self, obj)

    def json_to_class(self, dct):
        if '_set_object' in dct:
            return set(dct['_set_object'])
        elif '_class_object' in dct:
            cclass = dct['_class_object']
            cclass_name = cclass["name"]
            if cclass_name not in REGISTERED_CLASS:
                raise RuntimeError(
                    "Class {} not registered in JSON Parser"
                    .format(cclass["name"])
                )
            instance = REGISTERED_CLASS[cclass_name]()
            instance.__dict__ = cclass["dict"]
            return instance
        return dct

    def encode_(self, file):
        with open(file, 'w') as outfile:
            json.dump(
                self.__dict__, outfile,
                cls=JsonClassSerializable,
                indent=4,
                sort_keys=True
            )

    def decode_(self, file):
        try:
            with open(file, 'r') as infile:
                self.__dict__ = json.load(
                    infile,
                    object_hook=self.json_to_class
                )
        except FileNotFoundError:
            print("Persistence load failed "
                  "'{}' do not exists".format(file)
                  )

class C(JsonClassSerializable):

    def __init__(self):
        self.mill = "s"

class B(JsonClassSerializable):

    def __init__(self):
        self.a = 1230
        self.c = C()

class A(JsonClassSerializable):

    def __init__(self):
        self.a = 1
        self.b = {1, 2}
        self.c = B()

A().encode_("test")
b = A()
b.decode_("test")
print(b.a)
# 1
print(b.b)
# {1, 2}
print(b.c.a)
# 1230
print(b.c.c.mill)
# s 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-04-20T19:13:39.493

JSON 并不是真正用于序列化任意 Python 对象。它非常适合序列化`dict`对象，但该`pickle`模块确实是您通常应该使用的。的输出`pickle`并不是真正的人类可读的，但它应该可以很好地解开。如果您坚持使用 JSON，您可以查看`jsonpickle`模块，这是一种有趣的混合方法。

[https://github.com/jsonpickle/jsonpickle](https://github.com/jsonpickle/jsonpickle)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-10-10T17:23:07.090

这是用于序列化任何非复杂类的两个简单函数，如前所述，没有什么花哨的。

我将它用于配置类型的东西，因为我可以在不调整代码的情况下将新成员添加到类中。

```
import json

class SimpleClass:
    def __init__(self, a=None, b=None, c=None):
        self.a = a
        self.b = b
        self.c = c

def serialize_json(instance=None, path=None):
    dt = {}
    dt.update(vars(instance))

    with open(path, "w") as file:
        json.dump(dt, file)

def deserialize_json(cls=None, path=None):
    def read_json(_path):
        with open(_path, "r") as file:
            return json.load(file)

    data = read_json(path)

    instance = object.__new__(cls)

    for key, value in data.items():
        setattr(instance, key, value)

    return instance

# Usage: Create class and serialize under Windows file system.
write_settings = SimpleClass(a=1, b=2, c=3)
serialize_json(write_settings, r"c:\temp\test.json")

# Read back and rehydrate.
read_settings = deserialize_json(SimpleClass, r"c:\temp\test.json")

# results are the same.
print(vars(write_settings))
print(vars(read_settings))

# output:
# {'c': 3, 'b': 2, 'a': 1}
# {'c': 3, 'b': 2, 'a': 1} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-01-04T21:33:38.613

我相信，与其在接受的答案中建议继承，不如使用多态性。否则，您必须有一个大的 if else 语句来自定义每个对象的编码。这意味着为 JSON 创建一个通用的默认编码器：

```
def jsonDefEncoder(obj):
   if hasattr(obj, 'jsonEnc'):
      return obj.jsonEnc()
   else: #some default behavior
      return obj.__dict__ 
```

然后`jsonEnc()`在要序列化的每个类中都有一个函数。例如

```
class A(object):
   def __init__(self,lengthInFeet):
      self.lengthInFeet=lengthInFeet
   def jsonEnc(self):
      return {'lengthInMeters': lengthInFeet * 0.3 } # each foot is 0.3 meter 
```

然后你打电话`json.dumps(classInstance,default=jsonDefEncoder)`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-09-19T18:11:12.190

关于如何开始这样做有一些很好的答案。但是有一些事情要记住：

*   如果实例嵌套在大型数据结构中怎么办？
*   如果还想要类名怎么办？
*   如果你想反序列化实例怎么办？
*   如果您使用`__slots__`而不是`__dict__`怎么办？
*   如果你只是不想自己做呢？

[json-tricks](https://github.com/mverleg/pyjson_tricks)是一个库（我创建并且其他人贡献了），它已经能够做到这一点很长一段时间了。例如：

```
class MyTestCls:
    def __init__(self, **kwargs):
        for k, v in kwargs.items():
            setattr(self, k, v)

cls_instance = MyTestCls(s='ub', dct={'7': 7})

json = dumps(cls_instance, indent=4)
instance = loads(json) 
```

您将取回您的实例。这里的 json 看起来像这样：

```
{
    "__instance_type__": [
        "json_tricks.test_class",
        "MyTestCls"
    ],
    "attributes": {
        "s": "ub",
        "dct": {
            "7": 7
        }
    }
} 
```

如果您想制作自己的解决方案，您可能会查看源代码，`json-tricks`以免忘记一些特殊情况（如`__slots__`）。

它还处理其他类型，如 numpy 数组、日期时间、复数；它还允许发表评论。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-02-04T13:08:54.723

这可以使用[pydantic](https://pydantic-docs.helpmanual.io/)轻松处理，因为它已经内置了此功能。

选项1：正常方式

```
from pydantic import BaseModel

class testclass(BaseModel):
    value1: str = "a"
    value2: str = "b"

test = testclass()

>>> print(test.json(indent=4))
{
    "value1": "a",
    "value2": "b"
} 
```

选项 2：使用 pydantic 的数据类

```
import json
from pydantic.dataclasses import dataclass
from pydantic.json import pydantic_encoder

@dataclass
class testclass:
    value1: str = "a"
    value2: str = "b"

test = testclass()
>>> print(json.dumps(test, indent=4, default=pydantic_encoder))
{
    "value1": "a",
    "value2": "b"
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-10-11T08:24:20.143

您可以使用*Jsonic*将几乎所有内容序列化为 JSON：

[https://github.com/OrrBin/Jsonic](https://github.com/OrrBin/Jsonic)

例子：

```
class TestClass:
def __init__(self):
    self.x = 1
    self.y = 2

instance = TestClass()
s = serialize(instance): # instance s set to: {"x":1, "y":2}
d = deserialize(s) # d is a new class instance of TestClass 
```

*Jsonic*有一些不错的特性，比如声明类属性瞬态和类型安全反序列化。

（答案晚了几年，但我认为它可能对其他人有所帮助）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-11-19T09:31:14.540

我在 Flask 应用程序中使用的一种将 Class 实例序列化为 JSON 响应的方法。

[Github项目供参考](https://github.com/prayagkr/flask_bootstrap)

```
from json import JSONEncoder
import json
from typing import List

class ResponseEncoder(JSONEncoder):
    def default(self, o):
        return o.__dict__

class ListResponse:
    def __init__(self, data: List):
        self.data = data
        self.count = len(data)

class A:
    def __init__(self, message: str):
        self.message = message

class B:
    def __init__(self, record: A):
        self.record = record

class C:
    def __init__(self, data: B):
        self.data = data 
```

现在创建一个 A、B、C 的实例，然后进行编码。

```
data_a = A('Test Data')
data_b = B(data_a)
data_c = C(data_b)

response = ResponseEncoder().encode(data_c)
json_response = json.loads(response) 
```

**输出**

```
{
    "data": {
        "record": {
            "message": "Test Data"
        }
    }
} 
```

**对于列表类型响应**

```
records = ['One', 'Two', 'Three']
list_response = ListResponse(records)
response = ResponseEncoder().encode(list_response)
json_response = json.loads(response) 
```

**输出**

```
{
    "data": [
        "One",
        "Two",
        "Three"
    ],
    "count": 3
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-01-23T02:14:59.637

还有另一种非常简单和优雅的方法可以在这里应用，它只是子类'dict'，因为它默认是可序列化的。

```
from json import dumps

class Response(dict):
    def __init__(self, status_code, body):
        super().__init__(
            status_code = status_code,
            body = body
        )

r = Response()
dumps(r) 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-02-03T11:40:56.157

使用任意、可扩展的对象，然后将其序列化为 JSON：

```
import json

class Object(object):
    pass

response = Object()
response.debug = []
response.result = Object()

# Any manipulations with the object:
response.debug.append("Debug string here")
response.result.body = "404 Not Found"
response.result.code = 404

# Proper JSON output, with nice formatting:
print(json.dumps(response, indent=4, default=lambda x: x.__dict__)) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-03-29T18:13:01.897

我为此做了一个函数，效果很好：

```
def serialize(x,*args,**kwargs):
    kwargs.setdefault('default',lambda x:getattr(x,'__dict__',dict((k,getattr(x,k) if not callable(getattr(x,k)) else repr(getattr(x,k))) for k in dir(x) if not (k.startswith('__') or isinstance(getattr(x,k),x.__class__)))))
    return json.dumps(x,*args,**kwargs) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-08-28T21:50:40.763

你可以试试`objprint`，它是一个用于打印 Python 对象的轻量级库，它支持 json 输出。

```
pip install objprint 
```

```
from objprint import objjson
t = testclass()
json_obj = objjson(t)
print(json.dumps(json_obj)) 
```

`objjson`基本上将任意对象转换为 jsonifiable 对象，`.type`如果它不是 dict、list 等内置类型，则它具有原始 Python 类型的特殊键。

如果您只是想打印它，您可以使用`op`通常用于以人类可读格式打印对象的它。

```
from objprint import op
t = testclass()
op(t, format="json", indent=2)

# If you want to dump to a file
with open("my_obj.json", "w") as f:
    # This is the same usage as print
    op(t, format="json", file=f) 
```

# c# - 字符串化成员名称，类似于 C 中的 #define str(s) #s

> ID：10252020
> 
> 赞同：0
> 
> 时间：2012-04-20T19:01:02.460
> 
> 标签：c#, .net, inotifypropertychanged

有什么方法可以像在 C 中那样使用`#define str(s) #s`宏在 C# 中为 .NET 4.0 字符串化成员名称？

```
public Double MyDouble
{
    get { return _MyDouble;}
    set 
    { 
        _MyDouble = value; 
        RaisePropertyChanged("MyDouble");
        // The below item would refactor correctly if C# had a stringify pre-processor
        // RaisePropertyChanged(str(MyDouble));
    }
}
private Double _MyDouble; 
```

如果我已禁用，则重新分解会破坏 raise 属性更改事件，`Search in Strings`或者如果启用它，则会破坏完全不相关的字符串。有时我不会注意到，直到 UI 元素不再响应更改。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T19:05:26.667

不，不幸的是。目前，您必须使用 PostSharp 或[NotifyPropertyWeaver 之](http://github.com/SimonCropp/NotifyPropertyWeaver)类的东西才能可靠地执行此操作。

请注意，在 C# 5 中，您将能够做到这一点：

```
public void RaisePropertyChanged([CallerMemberName] string member = "")
{
} 
```

你会像这样使用它：

```
public Double MyDouble
{
    get { return _MyDouble;}
    set 
    { 
        _MyDouble = value; 
        RaisePropertyChanged();
    }
} 
```

并且 C# 5 编译器会自动填写可选参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:14:25.657

对于您`OnPropertyChanged`可以做的最好的具体情况如下（尽管显然不理想）...

```
this.OnPropertyChanged(x => x.Member); 
```

...和...

```
protected void OnPropertyChanged(Expression<Func<T, object>> property)
{
    var propertyName = GetPropertyName(property.Body);
    if (this.PropertyChanged != null) this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
}
private static string GetPropertyName(Expression expression)
{
    switch (expression.NodeType)
    {
        case ExpressionType.MemberAccess:
            var memberExpression = (MemberExpression)expression;
            var supername = GetPropertyName(memberExpression.Expression);

            if (String.IsNullOrEmpty(supername))
                return memberExpression.Member.Name;

            return String.Concat(supername, '.', memberExpression.Member.Name);

        case ExpressionType.Call:
            var callExpression = (MethodCallExpression)expression;
            return callExpression.Method.Name;

        case ExpressionType.Convert:
            var unaryExpression = (UnaryExpression)expression;
            return GetPropertyName(unaryExpression.Operand);

        case ExpressionType.Parameter:
            return String.Empty;

        default:
            throw new ArgumentException();
    }
} 
```

......沿着这些线......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-15T10:22:39.863

我不熟悉 C 构造，但它听起来非常像[`nameof`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/nameof)C# 6 中引入的关键字，即

> 用于获取变量、类型或成员的简单（非限定）字符串名称。

如果我们将其接线：

```
public Double MyDouble
{
    get { return _MyDouble; }
    set
    {
        _MyDouble = value;

        RaisePropertyChanged(nameof(MyDouble));
    }
} 
```

...并设置一个属性值，`RaisePropertyChanged`接收一个字符串参数“MyDouble”。

# xcode - PackageMaker 集成到 XCode 中，没有临时目录

> ID：10252028
> 
> 赞同：0
> 
> 时间：2012-04-20T19:01:32.640
> 
> 标签：xcode, macos, installation, environment-variables, packagemaker

我目前在 XCode 中有一个目标，它从脚本调用“packagemaker”命令行工具，并且能够毫无问题地运行它。但是我不知道如何在我的 .pmdoc 文件中设置路径。我让它工作的唯一方法是通过构建后步骤复制到每个目标的临时目录，这些目标的二进制文件是安装程序的消费者，然后我在 .pmdoc 文件中的路径被硬编码到临时目录。

我希望我可以在 .pmdoc 路径条目中使用环境变量，但它们似乎不受支持。

我是否不得不将所有内容复制到临时目录，还是有其他方法可以清理它们？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:34:17.033

Packagemaker 也是一个非 GUI 终端工具。因此，您可以编写将路径、变量...作为参数并构建 pkg 文件的 shell 脚本。您可以在[手册页](http://www.unix.com/man-page/OSX/1/packagemaker/)中查看更多详细信息。

# iphone - 在录制的音频文件的末尾添加静音

> ID：10252032
> 
> 赞同：0
> 
> 时间：2012-04-20T19:01:47.420
> 
> 标签：iphone, ios, cocoa-touch, audio, avaudioplayer

目前我允许用户录制自己的声音不超过 30 秒。一旦他们完成了他们的音频录制，我就会抓住他们音频的持续时间。我运行这个快速数学 (SixtySeconds-TheirAudioDuraion) = TimeNeededToFill。基本上我需要最终得到一个精确的 1 分钟轨道。其中一部分是实际音频，其余部分是静音音频。我目前正在使用 AVAudioPlayer 来完成我所有的录音。有没有一种编程方式来实现这一点，而不是一些蛮力破解，我开始将无声音轨文件塞在一起以创建单个文件？

需要简单的光彩，我们将不胜感激。

我最好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:40:13.320

这可以很容易地使用`AVMutableComposionTrack insertEmptyTimerange`.

```
// Create a new audio track we can append to
AVMutableComposition* composition = [AVMutableComposition composition];
AVMutableCompositionTrack* appendedAudioTrack = 
    [composition addMutableTrackWithMediaType:AVMediaTypeAudio
                             preferredTrackID:kCMPersistentTrackID_Invalid];

// Grab the audio file as an asset
AVURLAsset* originalAsset = [[AVURLAsset alloc]
    initWithURL:[NSURL fileURLWithPath:originalAudioPath] options:nil];

NSError* error = nil;

// Grab the audio track and insert silence into it
// In this example, we'll insert silence at the end equal to the original length 
AVAssetTrack *originalTrack = [originalAsset tracksWithMediaType:AVMediaTypeAudio];
CMTimeRange timeRange = CMTimeRangeMake(originalAsset.duration, originalAsset.duration);
[appendedAudioTrack insertEmptyTimeRange:timeRange];

if (error)
{
    // do something
    return;
}

// Create a new audio file using the appendedAudioTrack      
AVAssetExportSession* exportSession = [AVAssetExportSession
                                       exportSessionWithAsset:composition
                                       presetName:AVAssetExportPresetAppleM4A];
if (!exportSession)
{
    // do something
    return;
}

NSString* appendedAudioPath= @""; // make sure to fill this value in    
exportSession.outputURL = [NSURL fileURLWithPath:appendedAudioPath];
exportSession.outputFileType = AVFileTypeAppleM4A; 
[exportSession exportAsynchronouslyWithCompletionHandler:^{

    // exported successfully?
    switch (exportSession.status)
    {
        case AVAssetExportSessionStatusFailed:
            break;
        case AVAssetExportSessionStatusCompleted:
            // you should now have the appended audio file
            break;
        case AVAssetExportSessionStatusWaiting:
            break;
        default:
            break;
    }
    NSError* error = nil;

}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:21:06.373

我将录制 60 秒的静音已经“录制”，将其附加到用户录制，然后将总长度修剪为 60 秒。

这个 SO 问题[avaudiorecorder-avaudioplayer-append-recording-to-file](https://stackoverflow.com/questions/4649918/avaudiorecorder-avaudioplayer-append-recording-to-file) 在 Siddarth 的回答中对附加声音文件有一些参考。

这个 SO question [trim-audio-with-ios](https://stackoverflow.com/questions/4238219/trim-audio-with-ios)包含有关修剪声音文件的信息。

# javascript - 如何使用 arry 作为循环

> ID：10252039
> 
> 赞同：-4
> 
> 时间：2012-04-20T19:02:05.423
> 
> 标签：javascript, html

好吧，解释我需要做什么有点困难，但是：

我有一个由 21 个字符串组成的数组，并且我有一个每 3 秒运行一次的 javascript 函数，如下所示：

```
function Ready(){
    t=setTimeout("change()",3000);
}
$(document).ready(function() {
    Ready();
}); 
```

我不知道该怎么做是：如何每 3 秒更改一个 div 元素（称为“id1”），用数组中的新文本替换它的文本，从 1 到 21，然后再回到 1？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:06:32.043

这使用了一种称为“匿名函数”的东西，它在您的问题中取代了“change()”。这是使用 setTimeout 的正确方法。

```
var arrPtr = 0;  // <-- this is the array pointer varialble.
vat txtArr = "a,b,c,d".split(",") //<-- this contains your string array

function Ready() {
   t=setTimeout(function(){
       $('#id1').html(txtArr[arrPtr]); //<-- this puts the value or the arrayat position "arrPtr" into your page
       arrPtr++; // <-- this increments the position to the next element
       if(arrPtr>txtArr.length) {
          arrPtr = 0;  // <--- this resets the position to zero when it gets to the end of the array
       }  
   },3000);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:06:01.503

```
var str = ["Hello", "World"];
var changeInterval = null;
var changeIteration = 0;
var change = function(){
   $('#id1').text(str[changeIteration++ % str.length]);
}

$(document).ready(function(){
    change();
    changeInterval = setInterval(change,3000);
}); 
```

[**JS小提琴**](http://jsfiddle.net/feKcm/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:09:37.500

Try this:

```
$(document).ready(function() {
    var myStrings = ["string 1", "string 2", "string 3"];
    var interval = setInterval(changeValue, 3000);
    var index = 0;

    function changeValue() {
        var idx = (index + myStrings.length) % myStrings.length;
        document.getElementById("id1").innerHTML = myStrings[idx];
        index++;
    }
}); 
```

[**Example fiddle**](http://jsfiddle.net/huHJx/1/)

# vhdl - 我可以从 Verilog 模块访问 VHDL 记录输出吗？

> ID：10252049
> 
> 赞同：2
> 
> 时间：2012-04-20T19:03:05.257
> 
> 标签：vhdl, verilog, records

我有一个顶级 Verilog 模块，它用一些记录的输出实例化一个 VHDL 块。

有没有一种从我的 Verilog 顶部访问这些记录的好方法，或者我最好只是将这些记录分开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T03:10:20.120

你可以（有警告）。创建与“记录”相同类型的“结构”。只要您不重新排序连接，这两个将 1:1 映射。如果您的工具确实支持它，请注意。

# jquery - jquery mobile 在注入的内容上加载实际内容

> ID：10252050
> 
> 赞同：0
> 
> 时间：2012-04-20T19:03:07.550
> 
> 标签：jquery, jquery-mobile

我有一个带有空 div 的 jQuery Mobile 页面，我想像这样将内容加载到这个 div 中：

单独的js脚本

```
$('#myPage').live('pagebeforecreate', function(event) {
    $("#content").html('<p>My html</p>');
}); 
```

html

```
<div data-role="content" id="content">
</div> 
```

页面加载后，我可以在一秒钟内看到我的内容，但之后 jQuery Mobile 只显示空 div。我怎样才能防止这种情况并保留我的内容？我使用了 pagebeforeload 事件，因为我想要 jQuery Mobile 来增强我的标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:08:27.350

查看`pagebeforeload`事件的文档：

> **加载前的页面**
> 
> 在发出任何加载请求之前触发...

*来源：http: [//jquerymobile.com/demos/1.1.0/docs/api/events.html](http://jquerymobile.com/demos/1.1.0/docs/api/events.html)*

`pagebeforeload`仅对通过 AJAX 引入的页面触发，因此当此事件触发时，该`#content`元素不存在。

请注意同一文档页面的摘录：

> **页面加载**
> 
> 在页面成功加载并插入 DOM 后触发。

这是您要使用的事件，或者`pageinit`将为所有页面触发，而不仅仅是外部页面。我相信该`pageload`事件在页面实际初始化之前触发，因此您添加到 HTML 的任何小部件都应该自动初始化。

# google-app-engine - GAE 中的长期工作

> ID：10252052
> 
> 赞同：0
> 
> 时间：2012-04-20T19:03:18.807
> 
> 标签：google-app-engine

我正在编写一个从 GAE 上的 twitter 读取消息的应用程序。应用程序应该一直阅读消息并对它们做出反应。因为我目前正在测试一个我不想使用后端的想法，这是满足这种需求的自然选择。我正在使用每分钟运行一次的 cron 作业和 servlet，它通过运行长达 50 秒的连续读取消息来处理该作业。

1.  我注意到 GAE 最多开放 3 个实例来处理此流量，这很糟糕吗？
2.  后端是完成此类工作的正确工具，对吧？
3.  没有后端有没有更好的方法？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T07:03:30.217

1.  实例的启动由[应用程序设置](https://developers.google.com/appengine/docs/adminconsole/performancesettings)控制。如果您的请求需要很长时间才能完成，那么它可能会触发新实例的启动 - 取决于所述设置。

2.  使用任务队列可以非常有效地获取数据。为此，您不需要后端。当您需要在请求之间将数据保存在内存中时，后端非常有用，从而有效地节省了 Datastore 请求。

3.  如前所述 - 查看任务队列以获取任务：数据获取任务需要多长时间？您需要他们多久执行一次？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T00:34:33.367

> 我注意到 GAE 最多开放 3 个实例来处理此流量，这很糟糕吗？

我不认为这很糟糕，因为多亏了这 3 个实例，您的 cron 可以继续正常工作。

Cron 执行可能会延迟几秒钟，启动实例也可能需要一些额外的时间，除此之外，在 50 秒之后，您的应用程序可能会运行一些代码，这也可能需要一些时间。

如果您有一些证据表明在调用特定的 cron 请求时运行之前的 cron 的实例处于可用状态，请在此处分享。

> 后端是完成此类工作的正确工具，对吧？

绝对地。

> 没有后端有没有更好的方法？

除非知道什么对您“更好”，否则很难回答。现在的策略有问题吗？

# jquery - 将 div 添加到 dom 后如何运行 jquery 函数？

> ID：10252060
> 
> 赞同：0
> 
> 时间：2012-04-20T19:03:58.183
> 
> 标签：jquery, dom

我正在使用一个使用 jquery 创建手风琴的插件。但是，我的 jquery 函数在 dom 被操作之前运行，并且我在函数中定位的 div id 已经创建。这是我的功能。

```
jQuery('#_Offer_Something').click(function(){

      if( !confirm('Delete?') ) { //show confirm dialog
            return false; //do nothing if cancel is clicked (prevent the browser from following clicked link)
      }else{
           window.location.replace("http://stackoverflow.com"); 
    }
}); 
```

所以基本上这不起作用，因为 div 还不存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T19:07:09.420

**编辑**

在您的具体情况下，您可以使用：[.on()](http://api.jquery.com/on/)

```
(function($){  // remap the '$' symbol to jQuery

   $(document).on('click', '#_Offer_Something',function(){
   // ^^^^ or 'body' or a parent element
       if( !confirm('Delete?') ) { //show confirm dialog
            return false; //do nothing if cancel is clicked (prevent the browser from following clicked link)
       }else{
            window.location.replace("http://stackoverflow.com"); 
       }
   });

})(jQuery); 
```

以上将作为现已弃用的 jQuery`.live()`方法。
确保将 jQuery`<script>`标签放在标签之前`</body>`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:10:11.247

如果您的 DOM 对象是在页面加载后的某个时间动态创建的，那么您将需要使用委托事件处理以便从中获取事件，即使您的事件处理程序安装在相关对象之前也是如此。您可以使用 jQuery 1.7+ 的动态形式来做到这一点`.on()`：

```
jQuery(document).on('click', '#_Offer_Something', function(){

      if( !confirm('Delete?') ) { //show confirm dialog
            return false; //do nothing if cancel is clicked (prevent the browser from following clicked link)
      }else{
           window.location.replace("http://stackoverflow.com"); 
    }
}); 
```

从技术上讲，它的工作方式是所有点击事件都在祖先链上冒泡（除非沿途的某些对象停止冒泡过程）。在这种情况下，我们在对象上安装了一个点击处理程序`document`，它会监视源自与选择器匹配的对象的点击事件`#_Offer_Something`。

For best performance, you wouldn't actually bind this event handler to the `document` object. Instead, you would pick a static parent object (some parent of `#_Offer_Something`) that does exist at the time you install the event handler. I picked the `document` object here only because you didn't disclose the rest of your HTML so I don't know what a better choice would be.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:07:27.447

`on`仅在插入元素后使用 jQuery绑定或绑定元素。有关示例，请参阅[http://api.jquery.com/on/](http://api.jquery.com/on/)。快速示例：

```
$(document).on('click', '#_Offer_Something', function(){}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:05:19.930

```
$(document).ready(function(){
  ... code here ...
}); 
```

或者

```
$(function(){
  ... Code here ...
}); 
```

# r - 如何从谷歌代码和/或launchpad.net安装R包的开发版本？

> ID：10252062
> 
> 赞同：0
> 
> 时间：2012-04-20T19:04:02.730
> 
> 标签：r, installation, package

R 包的一些开发版本托管在 google 代码和/或 launchpad.net 上。

是否可以像从其他存储库一样直接从 google 代码和/或 launchpad.net 安装这些软件包的最新版本？

*IE。不通过浏览器从站点下载源代码，然后尝试安装源代码*

如果是这样，怎么做？

我想安装的包是“igraph”。

该软件包的开发版本似乎托管在：

[http://code.google.com/p/igraph/downloads/list](http://code.google.com/p/igraph/downloads/list)
和
[https://code.launchpad.net/~igraph/igraph/0.6-main](https://code.launchpad.net/~igraph/igraph/0.6-main)

作为奖励，是否可以对托管在 sourceforge.net 上的软件包执行相同的操作？

PS：我相信这与我过去的问题足够不同，需要一个单独的问题： [如何安装 R 包 github 存储库的开发版本](https://stackoverflow.com/questions/9656016/how-to-install-development-version-of-r-packages)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:20:56.903

您必须从源代码构建，除非开发人员为您的特定系统（OS 和 R 版本）提供预构建的二进制文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:03:47.893

使用这个`devtools`包，有一个`install_url`功能可以自动下载源代码、构建包和安装它。

```
install_url("http://igraph.googlecode.com/files/igraph_nightly_0.6-2689-20120412.tar.gz") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:10:44.617

*不*下载源代码需要有人为您构建二进制文件。这只发生在 CRAN、R-Forge 和 RForge.net 包上，所以你不走运。

从源代码安装是要走的路。

# r - 与多个用户共享 R 功能而不暴露代码

> ID：10252065
> 
> 赞同：4
> 
> 时间：2012-04-20T19:04:31.093
> 
> 标签：r, rstudio, obfuscation, source-code-protection

我有代码可以读取和处理我希望允许多个用户使用的数据，但我不想让他们看到代码。

有没有办法使用 R 或 RStudio 做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T19:20:00.960

一种选择是使用 Rserve 之类的工具将您的功能公开为服务。但是，这将要求您托管为您的用户运行代码的服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T14:22:33.440

当您使用 R 代码时，imo 无法向用户隐藏代码。您可以分发包的二进制包，但这仍然包括明文形式的 R 代码。此外，当代码加载到 R 中时，用户可以通过在不带括号的命令行上键入任何函数来查看其源代码。

我不确定你为什么要隐藏代码。也许您可以在您的问题中对此发表评论，以使事情更清楚。此外，除了隐藏代码之外，我们也许能够提出可能回答您问题的解决方案。如果隐藏代码是为了让没有经验的用户了解实现细节，您可以执行以下操作。

1.  为希望向用户提供其功能的函数创建包装函数。这样的包装函数可能类似于：

    ```
    spam_wapper = function(a, b) {
       return(.spam(a = a, b = b))
    }) 
    ```

2.  使所有非包装函数对用户不可见。他们仍然可以通过明确说明包的命名空间来访问它们：

    ```
    pkgname::.spam 
    ```

    但更难找到代码，使得没有经验的 R 程序员更难找到。但是一旦他们学会了诀窍，这将不再有用。

如果您的原因是因为您想使用您的 R 代码赚钱，请隐藏您精心制作的 R 代码（在这种情况下，我肯定会分享它:)），或者隐藏您的代码以防止任何可能窃取您想法的竞争。在这种情况下，@baptiste 的建议可能会奏效。但我想用 Fortran、C 或 C++ 重写你的代码需要大量的工作......我想说，只要给他们源代码......

# c - 简单的usb驱动

> ID：10252066
> 
> 赞同：6
> 
> 时间：2012-04-20T19:04:36.877
> 
> 标签：c, linux-kernel

我是一个新手，学习如何为 USB 设备编写 Linux 设备驱动程序。编译代码时出现错误。注释行有问题。我正在为 USB 驱动器制作一个模块，如下所示：

```
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/usb.h>

static int pen_probe(struct usb_interface *intf,const struct usb_device_id *id)
{
    printk(KERN_ALERT"\nthe probe is successful");
    return 0;
}

static void pen_disconnect(struct usb_interface *intf)
{
    printk(KERN_ALERT"pen drive removed");
}

const struct usb_device_id pen_table = {
    USB_DEVICE(0x058f,0x6387),
};

MODULE_DEVICE_TABLE(usb,pen_table);

static struct usb_driver pen_driver = {
    .name = "pen_driver",
    .id_table = pen_table,   // error coming at this line
    .probe = pen_probe,
    .disconnect = pen_disconnect,
};

static int __init pen_init(void)
{
    int ret;
    ret = usb_register(&pen_driver);
    printk(KERN_ALERT"THE RET::%d\n",ret);
    return 0;
}

static void __exit pen_exit(void)
{
    usb_deregister(&pen_driver);
}

module_init(pen_init);
module_exit(pen_exit);

MODULE_LICENSE("GPL"); 
```

它给我一个错误如下：

```
 :26:5: error: initializer element is not constant

  /home/karan/practice/usb/usb1.c:26:5: error: (near initialization for ‘pen_driver.id_table’) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:18:34.003

`id_table`结构的成员属于类型`const struct usb_device_id *`，但您正在分配`const struct usb_device_id`. 尝试更改`pen_table`为`&pen_table`in 结构初始化。
希望这可以帮助！
编辑：它实际上看起来像你有`pen_table`不正确的声明。应该是：

```
const struct usb_device_id pen_table[] = { 
   {USB_DEVICE(0x058f,0x6387)},
   {}  
}; 
```

并且初始化应该`pen_table`（而不是`&pen_table`像以前建议的那样）就像您在代码中所做的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T12:25:17.770

```
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/usb.h>

static int pen_probe(struct usb_interface *interface, const struct usb_device_id *id)
{
printk(KERN_INFO "Pen drive (%04X:%04X) plugged\n", id->idVendor, id->idProduct);
return 0;
}

static void pen_disconnect(struct usb_interface *interface)
{
printk(KERN_INFO "Pen drive removed\n");
}

static struct usb_device_id pen_table[] =
{
{ USB_DEVICE(0x058F, 0x6387) },
{} /* Terminating entry */
};
 MODULE_DEVICE_TABLE (usb, pen_table);

   static struct usb_driver pen_driver =
  {
.name = "pen_driver",
.id_table = pen_table,
.probe = pen_probe,
.disconnect = pen_disconnect,
};

   static int __init pen_init(void)
 {
return usb_register(&pen_driver);
    }

 static void __exit pen_exit(void)
  {
usb_deregister(&pen_driver);
  }

  module_init(pen_init);
   module_exit(pen_exit); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-10T12:22:00.567

```
obj-m +=usbDemo1.o

KVERSION = $(shell uname -r)
all:
       make -C/lib/modules/$(KVERSION)/build M=$(PWD) modules
clean:
       make -C/lib/modules/$(KVERSION)/build M=$(PWD) clean 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-11-30T13:31:16.943

obj-m +=usbDemo1.o

KVERSION = $(shell uname -r) all: make -C/lib/modules/$(KVERSION)/build M=$(PWD) modules clean: make -C/lib/modules/$(KVERSION)/build M= $(PWD) 清洁

# apache - MAMP 对 Apache“文档根”的更改无效

> ID：10252067
> 
> 赞同：5
> 
> 时间：2012-04-20T19:04:37.820
> 
> 标签：apache, mamp, document-root, phpinfo

我寻求帮助找出为什么 MAMP 无法对 Apache 的“文档根”进行更改，并解决了这个问题。原始文件的第二次编辑包括大量附加信息，可能有助于识别解决方案。

Apache 最近停止响应 Apache httpd.conf 的“主”服务器配置部分中的“DocumentRoot”指令的更改。Apache 继续运行良好，只是它仍然停留在先前的“DocumentRoot”设置上。我会重视您的帮助，找到这个问题的根源并修复它。

我使用 Lion 在 2011 年初的 MacBookPro 上运行 Apache 2.0.64。为方便起见，我在 MAMP 2.0.5 中工作，其中包括 Apache 2.0.64。我一直在开发多个网站，位于不同路径下的不同目录中。为了在这些路径和目录之间切换 localhost，我经常使用 MAMP（不是 MAMP Pro）GUI 操作序列
“首选项...”>“Apache”>“文档根目录”>“选择...”
在两个路径之间切换.

一个多星期前，这个 GUI 开关背后的一些设置或过程卡在了其中一个路径上（“路径 p”，为简单起见）。GUI本身没有卡住；它显示“文档根”，就好像它在路径 p 和路径 q 之间来回切换一样。但是，只有路径 p 下的站点才能在 localhost/path 上运行。如果我将“文档根目录”的 MAMP 设置切换到路径 q，然后尝试运行 localhost 站点 q，q 将无法运行，即使它在问题首次出现之前运行良好；但任何通过路径 p 可访问的站点仍将运行。

查看 MAMP GUI 的后面，'phpinfo' 报告 'DOCUMENT_ROOT' 在 phpinfo 的 'Apache Environment' 部分和 '_SERVER("DOCUMENT_ROOT")' 中更改为 'path q' 在 'PHP 变量' 部分。当我更改 MAMP 的“Document_Root”设置时，我可以使用 TextWrangler 实时查看设置在“httpd.conf”中的更新。

Mac 的“活动监视器”显示七个正在运行的“httpd”进程。使用“检查”显示所有这些都在 MAMP 中运行。Mac 'Spotlight' 搜索 httpd.conf 只显示上面讨论的一个 'httpd.conf' 文件。

通过 MAMP/logs/apache_error.log 访问的相关错误消息总是（时间戳除外）：

-- 恢复正常操作 [Sun Apr 22 12:34:22 2012] [notice] 捕获 SIGTERM，正在关闭 [Sun Apr 22 12:34:24 2012] [notice] 摘要：为摘要身份验证生成密钥 ... [Sun 2012 年 4 月 22 日 12:34:24] [通知] 摘要：完成 [2012 年 4 月 22 日星期日 12:34:24] [通知] Apache/2.2.21 (Unix) mod_ssl/2.2.21 OpenSSL/0.9.8r DAV/2 PHP/5.3.6 已配置——恢复正常操作

如果我理解正确，Apache 的运行版本是 2.2.21，而不是 Apache 2.0.64，MAMP 的常见问题解答页面（显示为访问从 GUI 的“打开开始页面”按钮打开的网页屏幕的选项卡）说的是安装的版本。

控制台常规错误日志中对应的错误消息为：

2012 年 4 月 21 日 9:40:27.746 PM [0x0-0xcd0cd].de.appsolute.MAMP: 120421 21:40:27 来自 pid 文件 /Applications/MAMP/tmp/mysql/mysql.pid 的 mysqld_safe mysqld 于 4/21 结束/12 9:40:28.653 PM [0x0-0xcd0cd].de.appsolute.MAMP：警告：DocumentRoot [/Applications/MAMP/Library/docs/dummy-host2.example.com] 不存在 4/21/12 9 :40:28.721 PM [0x0-0xcd0cd].de.appsolute.MAMP: 120421 21:40:28 mysqld_safe 记录到“/Applications/MAMP/logs/mysql_error_log.err”。2012 年 4 月 21 日 9:40:28.871 PM [0x0-0xcd0cd].de.appsolute.MAMP: 120421 21:40:28 mysqld_safe 使用 /Applications/MAMP/db/mysql 中的数据库启动 mysqld 守护程序 2012 年 4 月 21 日 9 ：40：29.799 PM [0x0-0xcd0cd].de.appsolute.MAMP：警告：DocumentRoot [/Applications/MAMP/Library/docs/dummy-host2.example.com] 不存在

除日期和时间外，对于通过 MAMP 对“DocumentRoot”进行的任何更改，这些消息都保持不变。我无法识别这些消息中的任何有用信息。

在此问题发生前不久，我重新安装了 MAMP 以修复 MySQL 服务器的问题。在尝试在 MAMP 中调试 MySQL 服务器时，我和一位更熟练的计算机科学家还安装了 MacPorts。

似乎 MAMP 实际上正在打开一个可能已由 MacPorts 安装的 Apache 版本 2.2.21，而不是可能随 MAMP 2.0.5 一起安装的版本 2.0.64；但是 MAMP 的那部分仍然表现得好像 Apache 2.0.64 是可操作版本。如果这是真的，它可能会很快找到一个解决方案，尽管我对 MAMP 或 Apache 如何工作来完成这一点了解不足。

我广泛搜索了在线建议，测试了为多个用户设置 WordPress 格式的建议，并尝试更改“etc/hosts”，现在已恢复为默认值。大多数相关网站都是用 XHTML、PHP 和 CSS 硬编码的；少数人使用 WordPress。

在我将此问题发布到“堆栈溢出”的第二天，作为问题 #10252067，尚未收到回复，我将此查询的早期版本附加到有关 PHP 不起作用的 MAMP 论坛线程。该帖子尚未发布，可能正在审核中。当我更仔细地研究这个问题时，在我看来，与 httpd.conf 交互的 MAMP 接口部分可能正在正常工作，并且问题可能与 httpd 如何读取和解释 httpd 中的设置有关。 conf，或 MAMP 如何识别和交互几个可能的 Apache 版本。

非常感谢您的指导，以解决实施 Apache 'DocumentRoot' 设置失败的问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-02-22T02:42:01.347

有相同的症状并通过发现以下行在

/Applications/MAMP/conf/apache/httpd.conf 文件：

```
# Virtual hosts
Include /Applications/MAMP/conf/apache/extra/httpd-vhosts.conf 
```

这是因为在我之前使用我的计算机的人设置 MAMP 为 Zend Framework 2 工作并设置了一个覆盖 DocumentRoot 设置的虚拟主机。我重新注释了该行，现在首选项中的 DocumentRoot 按预期工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T23:42:49.803

### 更改 Apache 'document root' 时修复 MAMP 无效

1.  退出 MAMP
2.  打开终端并输入：`sudo killall -9 httpd`
3.  重启 MAMP

### 修复 MySQL 未启动时的 MAMP

1.  退出 MAMP
2.  打开终端并输入：`sudo killall -9 mysqld`
3.  重启 MAMP

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-23T09:56:06.947

这是一个老问题，但我今天遇到了这个问题。我以这种方式解决了它：

1) 关闭 MAMP

2）`"/Applications/MAMP/conf/apache/http.conf"`用文本编辑器打开并检查是否有类似的东西：

……

```
<VirtualHost *>
DocumentRoot "/Applications/MAMP/htdocs"
ServerName localhost
</VirtualHost> 
```

……

3) 将 DocumentRoot 之后的字符串替换为新的 Path。

基本上您需要手动更改虚拟主机的路径

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:50:44.950

我解决了这个问题：

*   停止 MAMP 中的服务器
*   杀死活动监视器中的所有 httpd 进程
*   在 MAMP 中启动服务器

到目前为止，这对我有用。我无法解释为什么它不起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-14T08:24:18.627

如果您想与 一起使用名称/虚拟主机`localhost`，请确保在`localhost`中明确定义`/Applications/MAMP/conf/apache/extra/httpd-vhosts.conf`，就像已经定义的任何其他虚拟主机一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-01T18:54:16.703

聚会迟到了，但想指出我遇到了类似的问题。就我而言，我正在编辑：

```
/Applications/MAMP/conf/apache/original/httpd.conf 
```

当我应该编辑时：

```
/Applications/MAMP/conf/apache/httpd.conf 
```

非常愚蠢的错误，但是……我浪费了 45 分钟

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-24T17:55:09.820

检查 apache/conf/extras/httpd-conf.conf

我的 DocumentRoot 错误

```
<VirtualHost *:80>
    DocumentRoot /Users/..../..
    ServerName localhost
</VirtualHost> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-24T21:02:32.397

在我的情况下，ssl 配置中的 DocumentRoot 不正确：

```
 apache/conf/extras/httpd-ssl.conf 
```

因为我在本地启用了 HTTPS。

MAMP 接口仅更改 HTTP 根。

# r - 根据单列中的值删除 R 中的行

> ID：10252068
> 
> 赞同：16
> 
> 时间：2012-04-20T19:04:40.667
> 
> 标签：r

我在 R 中有 anx 3 矩阵，并且想要删除最后一列小于 x 的所有行。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-21T09:03:32.837

您也可以使用该`subset()`功能。

```
a <- matrix(1:9, nrow=3)  
threshhold <- 8  
subset(a, a[ , 3] < threshhold) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T19:27:17.507

与@JeffAllen 相同的方法，但更详细一点，并且可以推广到任何大小的矩阵。

```
 data <- rbind(c(1,2,3), c(1, 7, 4), c(4,6,7), c(3, 3, 3), c(4, 8, 6))
    data
         [,1] [,2] [,3]
    [1,]    1    2    3
    [2,]    1    7    4
    [3,]    4    6    7
    [4,]    3    3    3
    [5,]    4    8    6
    #
    # set value of x
    x <- 3
    # 
    # return matrix that contains only those rows where value in 
    # the final column is greater than x. 
    # This will scale up to a matrix of any size 
    data[data[,ncol(data)]>x,]
         [,1] [,2] [,3]
    [1,]    1    7    4
    [2,]    4    6    7
    [3,]    4    8    6 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T19:18:07.093

```
m <- matrix(rnorm(9), ncol=3)
m <- m[m[,3]>0,] 
```

创建一个矩阵，然后重新定义该矩阵以仅包含第三列大于 0 的行 ( `m[,3] > 0`)。

# android - Android：如何获取以编程方式创建的 WebView 的句柄以重新加载它们（虽然它们没有 id）

> ID：10252072
> 
> 赞同：0
> 
> 时间：2012-04-20T19:05:02.920
> 
> 标签：android, android-webview

我创建了一个应用程序，该应用程序具有 (X) 个选项卡，每个选项卡都是动态创建的，并为其创建了关联的 WebView。

我还有一个带有“重新加载”按钮的菜单我想在单击此菜单时重新加载所有动态创建的 webview，我的问题是如何获取这些没有 ID 的 WebView 的句柄。

这是创建 WebView 的 Activity 片段。

// 请注意，在下面的代码中 2 个字符串`@myId`是`@url`从另一个活动传递的。

```
WebView browse;
    protected void onCreate(Bundle savedInstanceState) {

        final Activity activity = this;     

        super.onCreate(savedInstanceState);
        browse=new WebView(this);
        browse.getSettings().setLayoutAlgorithm(LayoutAlgorithm.SINGLE_COLUMN );        
        setContentView(browse);
        Intent sender=getIntent();
        String myUrl = sender.getStringExtra("url");
        int myId = Integer.parseInt( sender.getStringExtra("webid") );      
        browse.setId( myId );
        browse.setWebViewClient( new Youm7WebViewClient());
        browse.getSettings().setJavaScriptEnabled(true);        
        browse.loadUrl( myUrl );

    } 
```

现在在另一个活动中，我尝试通过单击“重新加载”按钮执行以下操作

*请注意，`i`这与上述活动中发送的值相同`MyId`*

```
// this crashes the app
for(int i=0;i<tabs.length;i++){
     String X = String.valueOf(i);
     WebView ourWebview = (WebView) findViewById(i);
     ourWebview.reload();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:08:32.330

只要您不重新使用名为“browse”的 WebView 引用，那么您就可以调用`browse.reload();`If 但是您正在重新使用该引用（即，您制作另一个新的 WebView 并将相同的浏览设置为与新的相同。）然后您可以保留一个 ArrayList 或其他一些数据结构来保存您的 WebView 引用。然后你可以遍历它并在每个对象索引上调用 .reload() 。

# vbscript - 有没有办法接受带有 QTP 的 UAC 提示？

> ID：10252078
> 
> 赞同：2
> 
> 时间：2012-04-20T19:05:19.013
> 
> 标签：vbscript, automated-tests, uac, qtp, gui-testing

我创建了一个需要运行可执行文件（在本例中为卸载脚本）的自动化测试。这会导致 Windows 7 显示用户帐户控制提示，在继续 QTP 测试之前需要接受该提示。

就目前而言，我不得不将 UAC 降低到“不要使我的桌面变暗”级别，以便将对话框添加到对象存储库中。我尝试单击“是”按钮进行录制，但 QTP 没有注意到我的操作，因此我不得不手动添加对象。

即使那样，当我添加 line 时，我也会从 QTP`Dialog("User Account Control").WinButton("Yes").Click`收到。`Unspecified Error`

**编辑：** 我还尝试使用下面的代码单击屏幕上的任意点（“是”按钮恰好在该点）。

```
Set dr = CreateObject("Mercury.DeviceReplay")
dr.MouseClick 1030, 550, LEFT_MOUSE_BUTTON 
```

好消息是光标正好落在“是”按钮上，不幸的是点击不起作用。

**QTP 有没有办法接受 UAC 提示，而不完全禁用 UAC？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-03T03:54:58.760

我不知道 QTP 是什么，但问题是它试图单击不允许的按钮。

Windows 阻止应用程序以编程方式单击**同意**对话框。这样做是为了防止所谓的[*Shatter Attack*](http://en.wikipedia.org/wiki/Shatter_attack)。此外，如果允许代码查看并单击 UAC 同意对话框，恶意软件可能会单击 UAC 提示本身。

有一种机制允许程序声明它们需要能够驱动用户界面；允许软件查看并单击 UAC 对话框。这是一个足够严重的安全风险，应用程序需要：

*   进行数字签名
*   从程序文件运行

# 声明你需要权利

如果您要求 QTP 的开发人员更改他们的程序集清单；打开`**uiAccess=true**`选项：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 

    <!-- Disable Windows Vista UAC compatability heuristics -->
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
        <security>
            <requestedPrivileges>
                <requestedExecutionLevel level="asInvoker" uiAccess="true"/>
            </requestedPrivileges>
        </security>
    </trustInfo> 
</assembly> 
```

然后他们对 QTP 可执行文件进行数字签名，然后将其安装在**Program Files**中，然后它将能够单击 UAC 对话框。

# 奖金阅读

来自 Chris Jackson 的[*使用 requestedExecutionLevel 的 uiAccess 属性来改进提供桌面远程控制的应用程序*](http://blogs.msdn.com/b/cjacks/archive/2009/10/15/using-the-uiaccess-attribute-of-requestedexecutionlevel-to-improve-applications-providing-remote-control-of-the-desktop.aspx)：

> 现在，大多数人并不真正理解这是为了什么，而 UAC 清单通常只是一个复制/粘贴事件。但是远程桌面开发人员关注它是值得的。对于任何常规软件，您通常都希望远离它——它很危险，并且回避了重要的安全功能 (UIPI)。但是，如果您正在远程处理桌面，这正是您想要的——您需要能够看到所有内容！
> 
> 事实上，这很危险，**我们不允许您在没有对您的应用程序进行数字签名的情况下进行设置**。默认情况下，您还**必须将其安装在安全位置**（例如 Program Files）。

# objective-c - 这是在 iPhone 上生成随机字符串的好方法吗？

> ID：10252080
> 
> 赞同：7
> 
> 时间：2012-04-20T19:05:20.077
> 
> 标签：objective-c, ios, security

这是我想出的代码：

```
NSString *randomString = @"";
for (int x=0;x<NUMBER_OF_CHARS;x++) {
  randomString = [randomString stringByAppendingFormat:@"%c", (char)(65 + (arc4random() % 25))];
}
return randomString; 
```

**编辑：**

要回答评论：

1）我主要关心代码的简洁性。

2）我还想知道如果 NUMBER_OF_CHARS 是一个大数字（比如 40），这对于猜测字符串是否安全，和/或防止冲突是安全的 - 不是针对此应用程序，而是在其他情况下。

3）另外，如果有一天我想制作大量的字符串，有没有更快的方法？这似乎会很慢，因为它每次通过循环都会创建一个对象。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T19:21:25.843

如果`NUMBER_OF_CHARS`是编译时常量，您可以通过避免重复创建对象来加速您的代码。您也可以将程序缩短一行：

```
char data[NUMBER_OF_CHARS];
for (int x=0;x<NUMBER_OF_CHARS;data[x++] = (char)('A' + (arc4random_uniform(26))));
return [[NSString alloc] initWithBytes:data length:NUMBER_OF_CHARS encoding:NSUTF8StringEncoding]; 
```

据我所知，`arc4random_uniform`对于加密应用程序来说应该已经足够好了，但如果您计划保护的数据对您或特别是对您的客户具有很高的价值，您可能需要咨询加密专家。

**编辑：**针对[nielsbot](https://stackoverflow.com/users/210171/nielsbot)的评论进行了编辑。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T22:58:48.683

FWIW，我赞成 Vincent Gable 使用 UUID 的建议。如果您设置了建议的算法，则可以通过使用类似 nielsbot 代码的这种变体来获得更多差异（只需将字符串替换为您想要包含在随机字符串中的任何内容）...

```
const NSUInteger NUMBER_OF_CHARS = 40 ;
NSString * CreateRandomString()
{
    static char const possibleChars[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    unichar characters[NUMBER_OF_CHARS];
    for( int index=0; index < NUMBER_OF_CHARS; ++index )
    {
        characters[ index ] = possibleChars[arc4random_uniform(sizeof(possibleChars)-1)];
    }

    return [ NSString stringWithCharacters:characters length:NUMBER_OF_CHARS ] ;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T21:35:08.083

您也可以考虑使用[UUID](https://stackoverflow.com/questions/427180/how-to-create-a-guid-uuid-using-the-iphone-sdk)，因为它们已经被[很好地研究和广泛使用](http://en.wikipedia.org/wiki/Universally_unique_identifier#Random_UUID_probability_of_duplicates)。在尝试保证我的手动解决方案中发生冲突的可能性之前，我可能会从那里开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:53:44.383

这是一个快速的方法，如果你会经常这样做

```
const NSUInteger NUMBER_OF_CHARS = 40 ;

NSString * CreateRandomString()
{
    unichar characters[NUMBER_OF_CHARS];
    for( int index=0; index < NUMBER_OF_CHARS; ++index )
    {
        characters[ index ] = 'A' + arc4random_uniform(26) ;
    }

    return [ NSString stringWithCharacters:characters length:NUMBER_OF_CHARS ] ;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-11T09:03:44.787

现有答案的另一个变体。我发布这个是因为它（似乎）性能更好，因为它对 ARC4 API 进行了一次调用。

```
NSString *random32CharacterString() {
    static const int N = 32; // must be even

    uint8_t buf[N/2];
    char sbuf[N];
    arc4random_buf(buf, N/2);
    for (int i = 0; i < N/2; i += 1) {
        sprintf (sbuf + (i*2), "%02X", buf[i]);
    }    
    return [[NSString alloc] initWithBytes:sbuf length:N encoding:NSASCIIStringEncoding];
} 
```

# c# - 从数据库值创建 C# Treeview

> ID：10252084
> 
> 赞同：1
> 
> 时间：2012-04-20T19:05:33.393
> 
> 标签：c#, database, winforms, treeview, odbc

我正在通过 odbc 从数据库中提取一列信息。该列将包含从 1 到 9999999 的数字。我希望能够通过以下方式将值组织到具有多达 3 个级别（父级、子级和孙子级）的树视图中：

理想的结构是： AAABBCC
父： AAA0000
子： AAABB00
孙： AAABBCC

但是，如果上面的级别不存在，则该值会向上移动一个级别。例如，假设数据包含以下{1, 101, 200, 204, 1200, 1205, 1304, 290000, 291500, 291502,410204}

-- 1
-- 101
-- 200
-------- 204
--1200
--------1205
--1304
--290000
--------291500
-------- ---------291502
--410204

任何帮助将不胜感激。
标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T23:14:18.130

这真的是一个非常简单的问题。

1.  `.ToString("D7")`通过调用每个数字将您的数字列表转换为字符串。
2.  对转换后的列表进行排序。
3.  以 SubString(0,3) 获取您的父值。
4.  使用 SubString(3,2) 来获取您的子值。
5.  取 Substring(5,2) 以获得您的孙子值。
6.  如果您的孩子值为 00，则创建一个新的 TreeNode 父节点并将其添加到 TreeNodeCollection。
7.  如果您的子值不是 00 而您的孙值是 00，则创建一个新的 TreeNode childNode 并将其添加到 parentNode。
8.  如果您的孙值不是 00，则创建一个新的 TreeNode 孙节点并将其添加到您的 childNode。

如果您需要按顺序填补空白，则需要一些额外的逻辑，但这相当微不足道。

# php - 如何使 REST 请求像 RPC 一样对用户更友好？

> ID：10252085
> 
> 赞同：0
> 
> 时间：2012-04-20T19:05:33.940
> 
> 标签：php, api, rest, rpc

我一直在高度考虑创建 REST 服务而不是 RPC，但在我看来，与 RPC 服务相比，客户端/用户必须编写大量代码才能实现相同的目标。此外，实现 REST 服务需要用户具备一些有关 REST 的基本知识。在 PHP 中进行说明：

**休息**

*   要发送 GET、POST、PUT、DELETE 请求，用户必须使用 CURL 发送他的请求
*   当然这需要他的服务器启用 CURL，这对某些共享主机不利
*   除了用户需要发送的数据参数之外，CURL 还需要额外的代码行来发送请求。

**RPC**

*   要使用 RPC 服务发送类似的请求，用户只需调用 URL 和数据参数即可。即：example.com?foo=bar&baz=quz

有没有办法让 REST 像 RPC 一样“简单”。我正在考虑用 RPC 方法封装 REST 请求，但这打破了整个想法，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:27:12.120

REST 不会强迫您使用 GET、POST、PUT 和 DELETE。它只是意味着单个 URL 代表单个内容。您还可以像这样实现 RESTful 行为：

```
GET /index.php
GET /item.php?id=x
POST /create.php
POST /update.php
POST /delete.php 
```

甚至创建、更新和删除都可以通过 get 请求来完成……

# c# - 在活动项目列表中显示非活动选定项目

> ID：10252086
> 
> 赞同：1
> 
> 时间：2012-04-20T19:05:39.053
> 
> 标签：c#, asp.net-mvc, drop-down-menu

我有一个下拉框，它只显示列表中的活动项目。但是用户可能已经选择了一个项目并保存了，然后同一项目可能会处于非活动状态。当用户编辑他们的选择时。他们之前选择的非活动项目应该是编辑页面列表中的默认项目以及其他活动项目。我不知道如何检查。这是我的代码，它填充了我的列表。

```
var meetingTypes = _meetingTypeRepository.FindAll().OrderBy(m => m.Description);
viewModel.MeetingTypes = meetingTypes.Where(a=> a.IsActive ?? false)
                                     .ToSelectList("MeetingTypeId", 
                                                   "Description",                
                                              viewModel.MeetingTypeId.ToString()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T19:49:58.360

我能够弄清楚以防万一另一个人碰巧有同样的情况。由于我使用的 viewModel 包含我需要比较的所有项目 ID，因此我在 Where 子句中使用了它，这就是我的 where 子句如何更改为：

```
.Where(a=>a.IsActive == true || a.MeetingTypeId == viewModel.MeetingTypeId) 
```

这允许我在下拉列表中显示用户先前选择的项目，即使该项目当前处于非活动状态。

# database-design - 数据库设计：多路径完整性约束

> ID：10252088
> 
> 赞同：1
> 
> 时间：2012-04-20T19:05:45.210
> 
> 标签：database-design, constraints

考虑以下情况：学生获得不同主题的成绩，其中*n*年级学生只参加涵盖*n*年级主题的课程。因此，我们得到一个可交换的“属于”方：

```
 Grades -----> Students
   |             |
   |             |
   v             v
 Topics -----> Levels 
```

这就是我所说的主题中的“多路径”。

(1) 这种约束的技术术语是什么？

现在添加以下数据：主题被分组为主题，并且有进一步的数据 X 附加到某些对（学生，主题），所以 X 本质上是笛卡尔积学生 x 主题的子集。现在已知以下事实（F）：成绩总是对应于在 X 中有记录的对（学生，学科），因此我们可以将表成绩中的学生外键提升为引用 X 的外键：

```
 Grades -------> X -------> Students
   |             |
   |             |
   v             v
 Topics ----> Subjects 
```

引入另一个多路径约束（但另一方面确保条件（F））。

（2）关于这些事情的理论观点是什么？

如果这太模糊，让我将其限制为以下内容：

(2') 首选设计是什么：“不相交”的方式使得表格成绩具有学生和主题的外键，或者以引入约束为代价引用更接近的表格 X 的“紧密”方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T17:55:40.540

实际上，目前我对[如何为与具有公共外键的两个源表相关的关联表提供约束中给出的解决方案感到满意？](https://stackoverflow.com/questions/7762485/how-to-provide-constraint-to-an-associative-table-relating-to-two-source-tables)

总结：在 Grades 中添加一列 level_id，并具有分别引用 Topic 和 Student 的多列外键 (topic_id, level_id) 和 (student_id, level_id)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T05:49:01.893

我会用下面的表格设计来处理它：

a) 主题 - 科目

b) 主题 - 所有可用主题的列表，每个主题都有一个 FK 主题

c) 学生 - 学生的详细信息

d) student_subject - 分配给学生的科目，其他元数据包括级别或班级、开始日期或结束日期（因为学生可能会重复）

e) 成绩 - FK 到 student_subject 组合，带有额外的元数据、日期、成绩、评论等。

# python - Python For/If 语法错误

> ID：10252089
> 
> 赞同：0
> 
> 时间：2012-04-20T19:05:53.237
> 
> 标签：python, syntax, if-statement, for-loop

这是我的代码：

```
for i in tuples:
    if i[0] == "U_shape":
        pieces.append(U_shape(i[1], boardLength, i[2])
    if i[0] == "I_shape":
        pieces.append(I_shape(i[1], i[2])
    if i[0] == "L_shape":
        pieces.append(L_shape(i[1], boardLength, i[2])
    if i[0] == "T_shape":
        pieces.append(T_shape(i[1], boardLength, i[2])
    if i[0] == "X_shape":
        pieces.append(X_shape(i[1], boardLength, i[2]) 
```

这是错误：

```
if i[0] == "I_shape":
                    ^
SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T19:07:52.847

You're missing closing parentheses on every line that calls `pieces.append`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T19:13:55.573

```
pieceType = {
    "U_shape": U_shape,
    "I_shape": I_shape,
    "L_shape": L_shape,
    "T_shape": T_shape,
    "X_shape": X_shape
}

pieces = [pieceType[a](b, boardLength, c) for a,b,c in tuples] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:09:46.047

As others have said, you are missing closing brackets, but that has been said, there is more needed to be done on your code structure:

This is a really bad way of doing what you want to do. A much better solution is to use a `dict`:

```
mapping = {"U_shape": U_shape, "I_shape": I_shape, ...}
pieces.append(mapping[i[0]](i[1], boardLength, i[2])) 
```

Now, this does rely on all your classes taking the same arguments - and while they don't appear to, this (given the errors already in your code) could be a mistake. If it's not, you could separate out *that* case, and use the mapping for the other cases.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T20:54:56.760

另一个直接的改进是：

```
for i in tuples:
    if i[0] == "U_shape":
        pieces.append(U_shape(i[1], boardLength, i[2]))
    elif i[0] == "I_shape":
        pieces.append(I_shape(i[1], i[2]))
    elif i[0] == "L_shape":
        pieces.append(L_shape(i[1], boardLength, i[2]))
    elif i[0] == "T_shape":
        pieces.append(T_shape(i[1], boardLength, i[2]))
    elif i[0] == "X_shape":
        pieces.append(X_shape(i[1], boardLength, i[2])) 
```

我猜 Hugh Bothwell 的会是最快的，但是...

```
>>> import this
The Zen of Python, by Tim Peters
...
In the face of ambiguity, refuse the temptation to guess.
...
>>> 
```

并使用 timeit 模块进行测量。

# json - Set-Cookie 标头在响应中，但浏览器未在下一个请求中设置 Cookie

> ID：10252094
> 
> 赞同：10
> 
> 时间：2012-04-20T19:06:05.217
> 
> 标签：json, http, session, rest, cookies

我正在开发一个需要有状态的 REST Api（没有解决方法，我使用的是没有可序列化对象等的本机库）

此 Rest API 公开在域 domainA 上的 Web 服务器上。响应包含一个设置为 * 的 Access-Control-Allow-Origin 标头，所以我不需要 JSON-P。（我不知道这个细节是否在乎）。

我在请求 DomainA 的 domainB 上做了这个 API 的 GWT 使用示例。浏览器不会添加之前设置的 cookie。它“无状态”地工作。

样本也必须在 DomainA 上吗？是否有解决方法或特定标题要设置？

**编辑**：我在 Cookie 中设置了一个主域。它不起作用。浏览器仍然没有在下一个请求标头中设置 cookie 会话。

要求：

```
HeadersPreviewResponseCookiesTiming
Request URL:http://subdomainB.mydomain.com/request
Request Method:POST
Status Code:200 OK
Request Headersview source
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4
Connection:keep-alive
Content-Length:1185
Content-type:application/x-www-form-urlencoded
Host:subdomainB.mydomain.com
Origin:http://subdomainA.mydomain.com
Referer:http://subdomainA.mydomain.com/BLABLABLA
User-Agent:Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.8 (KHTML, like Gecko) Chrome/20.0.1105.0 Safari/536.8 
```

回复：

```
Response Headersview source
Access-Control-Allow-Origin:*
Cache-Control:no-cache, no-store, max-age=0
Connection:Keep-Alive
Content-Language:fr-FR
Content-Type:application/json;charset=UTF-8
Date:Wed, 25 Apr 2012 07:59:03 GMT
Expires:Thu, 01 Jan 1970 00:00:00 GMT, Thu, 01 Jan 1970 00:00:00 GMT
Keep-Alive:timeout=15, max=100
Pragma:no-cache
Server:Jetty(7.5.4.v20111024)
Set-Cookie:JSESSIONID=cookieValue;Path=/;Domain=.mydomain.com
Transfer-Encoding:chunked 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-27T00:15:23.717

根据[标准规范](https://www.rfc-editor.org/rfc/rfc6265#page-9)，正确的语法是：

> set-cookie-header = "Set-Cookie:" SP set-cookie-string
> set-cookie-string = cookie-pair *( ";" SP cookie-av )
> cookie-pair = cookie-name "=" cookie-value
> ...

因此，您似乎缺少的是每个分号后的空格字符。

# python - 每次我尝试将用户添加到数据库时，Django 中的 date_joined 和 last_login 都需要错误

> ID：10252095
> 
> 赞同：0
> 
> 时间：2012-04-20T19:06:08.230
> 
> 标签：python, django

每次我填写表格以注册用户时，该过程都会停止，因为 last_login 和 date_joined 需要自动设置，或者我可以在哪里添加它们才能正常注册？视图.py

```
import datetime

@csrf_exempt
def EmployerRegistration(request):
    print 'before'
    if request.user.is_authenticated():
        return HttpResponseRedirect('/profile/')
    if request.method == 'POST':
            form = SignUpForm(request.POST)
            print form
            print"then"
            print form.errors
            if form.is_valid():
                print 'hello'
                employer =Employer.objects.create(username=form.cleaned_data["username"],password= form.cleaned_data['password'],first_name=form.cleaned_data['first_name'],last_name=form.cleaned_data['last_name'],email=form.cleaned_data['email'],address=form.cleaned_data['address'],mobile=form.cleaned_data['mobile'])
                employer.save()
                return HttpResponseRedirect('/login/')  

            else:
                print 'notvalid'
                return render_to_response('Sign_up_Employer.html',{'form':form}, context_instance=RequestContext(request))
            #return render_to_response('/lol/',{'form':form}, context_instance=RequestContext(request))
                last_login

    else:
        #user is not submitting show them the registeration form
                print 'not post'
                form= SignUpForm()
                context = {'form':form}
                return render_to_response('Sign_up_Employer.html',context,context_instance=RequestContext(request)) 
```

表格.py

```
from django.contrib.auth.forms import UserCreationForm
from django.contrib.auth.models import User
from django import forms
from django.forms import ModelForm
from shoghlanah.models import *
import datetime

class SignUpForm(ModelForm):

    username      = forms.CharField(label=(u'Username'))
    first_name    = forms.CharField(label=(u'First name'))
    last_name     = forms.CharField(label=(u'Last name'))
    address       = forms.CharField(label=(u'Address'))
    email         = forms.EmailField(label=(u'Email Address'))
    password      = forms.CharField(label=(u'Password'),widget=forms.PasswordInput(render_value=False))
    password1     = forms.CharField(label=(u'Verify Password'),widget=forms.PasswordInput(render_value=False))
    mobile        = forms.IntegerField(label=(u'Mobile'))
    ## is it valid to put the here??
    last_login    =datetime.datetime.now()
    date_joined   =datetime.datetime.now()

    class Meta:
            model = Employer
        ## check whats Exclude !!!!
            exclude = ('user',)

    def clean_username(self):
            username = self.cleaned_data['username']
            try:
                User.objects.get(username=username)
                raise forms.ValidationError("That username already exists.Please select another")
            except User.DoesNotExist:
                return username 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:01:17.550

尽管您没有添加有关该问题的一些重要信息（例如 Employer 的模型），但您的问题可能是您在此行保存和 Employer 时：

```
employer =Employer.objects.create(username=form.cleaned_data["username"],password= form.cleaned_data['password'],first_name=form.cleaned_data['first_name'],last_name=form.cleaned_data['last_name'],email=form.cleaned_data['email'],address=form.cleaned_data['address'],mobile=form.cleaned_data['mobile']) 
```

你有以下属性：

*   用户名
*   密码
*   名
*   姓
*   电子邮件
*   地址
*   移动的

如果您的问题是需要 last_login 和 date_joined，则应在`create()`方法中添加：

```
import datetime
#last_login=datetime.datetime.now(), date_joined=datetime.date.now() 
```

变成这样：

```
employer =Employer.objects.create(last_login=datetime.datetime.now(),date_joined=datetime.datetime.now(),username=form.cleaned_data["username"],password= form.cleaned_data['password'],first_name=form.cleaned_data['first_name'],last_name=form.cleaned_data['last_name'],email=form.cleaned_data['email'],address=form.cleaned_data['address'],mobile=form.cleaned_data['mobile']) 
```

这样就可以解决你的问题。

* * *

## 更新

由于您正在使用`.is_valid()`，因此您需要像下面那样进行操作。代替：

```
if request.method == 'POST':
    form = SignUpForm(request.POST)
    print form
    print"then"
    print form.errors
    if form.is_valid():
        print 'hello' 
```

你需要：

```
if request.method == 'POST':
    data = request.POST.copy()
    data['date_joined'] = datetime.date.today()
    data['last_login'] = datetime.datetime.now()

    form = SignUpForm(data)
    print form
    print"then"
    print form.errors
    if form.is_valid():
        print 'hello' 
```

# java - 如何在 Eclipse 中调试一个项目，这将导致另一个程序的插件？

> ID：10252097
> 
> 赞同：1
> 
> 时间：2012-04-20T19:06:25.677
> 
> 标签：java, eclipse, debugging

明确地说，在有人误解我之前：我不是在谈论 Eclipse 的插件。

我正在开发一个小项目，它只是另一个程序的插件，它也是用 Java 编写的（并且只能作为 .jar 文件使用）。我将我的项目导出为 .jar 文件（而不是可运行的 .jar 文件！）。这个其他程序加载这个 .jar 文件。问题是，主项目不是开源的，开发人员不会在不久的将来改变它：/

到目前为止，我制作了消息框 (JOptionPane) 并编写了日志文件来调试我的项目。但是现在，我想使用 Eclipse 的调试器。主程序的开发人员不知道如何为他们的项目调试插件。所以我希望这里有人可以帮助我。

由于我可以通过 Eclipse 启动主程序（运行方式 -> Java 应用程序 -> 主程序），通过将其作为外部 .jar 添加到 Java 构建路径，我的第一个想法是更改主程序保存的位置插件 .jar 文件（可以通过程序中的配置来完成），到 eclipse 将创建它的“版本”程序的位置（项目路径中的 bin 文件夹）。但后来我注意到它只创建 .class 文件而不是 .jar 文件本身，这使一个想法的火花提早结束......

那么如何在这样的插件项目中使用调试器呢？

或者更好：我必须查找哪些关键字才能自己找到它，因为当我搜索它时，我得到了很多关于 eclipse 插件的信息:(

# python - 用于 Python 的轻量级 Mongodb ODM/ORM

> ID：10252100
> 
> 赞同：17
> 
> 时间：2012-04-20T19:06:47.113
> 
> 标签：python, mongodb, backbone.js, flask, pymongo

我正在寻找从两个世界中汲取精华的 MondoDB Python ODM/ORM：*ODM/ORM 和超快速直接字典读取。*

换言之，包装应符合以下要求：

1.  允许定义和执行模式。
2.  允许验证字段。
3.  允许直接从 mongodb 读取对象（无 ODM/ORM 开销）。
    *   pymongo 直接返回的集合/对象可以使用 ODM/ORM 层访问（没有额外的查询）。
    *   我会想象 pymongo 驱动程序向提供对 ORM 汁液访问的对象添加了某种惰性字段（pymongo 允许此类扩展）。
    *   想象一下用例：
        *   为了快速阅读，我们直接转到驱动程序，
        *   对于数据输入，我们使用完整的 ODM/ORM 功能
4.  地质场支持
5.  GridFS 对普通文件和图像的支持
6.  DBRef 支持
7.  不强制执行任何隐藏的、特定于框架的字段
8.  将与 Flask 一起使用 :)
9.  有表单框架。
    *   表格涵盖子列表/子目录
    *   基于主干的表单会很棒
10.  基于 python 定义创建主干模型、集合、验证器

我知道我要求很多，但拥有这样的东西不是很棒吗:)

事实上，问题可以改写为：“现有的哪些 Python Mongodb ODM/ORM（MongoKit、MongoEngine）可以通过这种方式轻松扩展。”

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-21T19:57:12.830

首先，我也很想拥有它。

根据我的研究

Ming 是一个非常有前途的 mongo ODM 驱动程序：http: [//merciless.sourceforge.net/](http://merciless.sourceforge.net/)

MongoEngine 太大而无法适应您的需求/用例。MongoKit 也是如此。

micromongo 有一些希望：[http ://packages.python.org/micromongo](http://packages.python.org/micromongo)

可能是一个很好的起点。

顺便说一句：嗯...我不知道您在写什么，但是涵盖了表单和验证器，您可以轻松地构建管理界面并最终拥有下一代 Django。祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T19:16:39.830

好吧，如果您采用 ORM 的理论，那么您需要的不是 ORM，因为 MongoDB 不是关系数据库，所以不需要映射到关系实体。

我认为您必须检查[这篇文章](https://stackoverflow.com/questions/2740837/which-python-api-should-be-used-with-mongo-db-and-django)的答案以检查所提出的建议是否是您所需要的，我个人直接使用 MongoDB + Python，因为 Mongo 和 Python 的“性质”。

环顾四周，我发现这个库可以帮助你[mongoEngine](http://mongoengine.org/)。就像 Django ORM。你应该检查一下。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-29T09:14:16.847

在提出这个问题很久之后，[umongo就诞生了。](http://umongo.readthedocs.io/en/latest/)虽然相对年轻，但它正在逐渐成熟。与 micromongo 一样，它的目标是简单（“u”代表 µ/micro），因此它不提供问题中要求的众多功能，但它旨在成为一个健全的基础。

它在内部使用 Marshmallow 进行模型模式/验证，因此您可以愉快地与其他使用 Marshmallow 的库一起使用它。我在一个 Flask 应用程序中使用它，该应用程序提供一个使用 Marshmallow 解析输入/输出的 REST API。这限制了 DB 和 API 模式之间的重复量。该应用程序使用 Marshmallow 环境 (webargs/apispec) 中的其他库。

由于您可以直接访问集合，因此可以使用普通的 pymongo 查询。

此外，它不仅与 pymongo 兼容，还与异步驱动程序兼容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-13T09:00:21.020

看看**pymongoext** [https://github.com/musyoka-morris/pymongoext](https://github.com/musyoka-morris/pymongoext)，它受到猫鼬的高度启发。

主要特点是：

*   无需学习自定义查询语言或 API（如果您知道如何使用 pymongo，那么您已经知道如何使用 pymongoext）
*   类似对象的结果而不是类似字典的结果。这些对象扩展了 dict，因此您可以使用任何一种语法（即 foo.bar 或 foo['bar']）。
*   自定义数据操纵器，用于在保存之前和检索之后转换文档。（灵感来自猫鼬虚拟）
*   模式验证（使用 MongoDB JSON 模式验证）
*   嵌套和复杂的模式声明
*   必填字段验证
*   默认值
*   自定义验证器
*   验证运算符（OneOf、AllOf、AnyOf、Not）
*   索引管理（Pymongoext透明智能地处理MongoDB索引的维护）

示例用法：

```
from datetime import datetime
from pymongo import MongoClient, IndexModel
from pymongoext import *

class User(Model):
    @classmethod
    def db(cls):
        return MongoClient()['my_database_name']

    __schema__ = DictField(dict(
        email=StringField(required=True),
        name=StringField(required=True),
        yob=IntField(minimum=1900, maximum=2019)
    ))

    __indexes__ = [IndexModel('email', unique=True), 'name']

    class AgeManipulator(Manipulator):
        def transform_outgoing(self, doc, model):
            doc['age'] = datetime.now().year - doc['yob']
            return doc

# Create a user
>>> User.insert_one({'email': 'jane@gmail.com', 'name': 'Jane Doe', 'yob': 1990})

# Fetch one user
>>> user = User.find_one()

# Print the users age
>>> print(user.age) 
```

# java - 如何实现从二值图像中提取多个特征的方法

> ID：10252107
> 
> 赞同：0
> 
> 时间：2012-04-20T19:07:13.927
> 
> 标签：java, computer-vision, feature-detection, feature-extraction

我正在用java实现一个简单的计算机视觉系统。它从图像中提取形状。一般呈圆形或椭圆形。我让它工作到可以创建仅包含我要分析的特征的二进制图像的程度。通过计算图像中白色像素的数量，我可以很容易地找到单个特征的面积。但是，如果有多个特征，它将找到所有特征组合的区域。

我想知道是否有人会知道如何实现一种方法来提取/检测多个特征，然后我可以很容易地找到每个特征的区域等。

我找到了有关如何使用 openCV 执行此操作的信息，但是我找不到有关如何为自己实际实现方法的信息，甚至找不到如何实现它的理论。它不需要非常先进，即使是一个简单的例子会好的。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T19:13:03.033

我假设您的所有“功能”都已正确连接（4 或 8 连接）。如果是这种情况，您正在寻找的算法将属于[连接组件标签](http://en.wikipedia.org/wiki/Blob_extraction)的范畴。您可以在那里实现伪代码中描述的两遍算法作为一个坚实的开始。

# emacs - EDE 使用 ?= 生成生成文件集变量

> ID：10252109
> 
> 赞同：1
> 
> 时间：2012-04-20T19:07:32.457
> 
> 标签：emacs, cedet

有没有办法通过 EDE 自定义缓冲区设置 Make makefile 中将使用分配的变量`?=`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T02:15:01.587

EDE 中没有明确支持该功能。但是，您可以使用自己的手写 make 规则创建自己的支持 makefile，调用任何您想要的名称，然后使用包含文件槽将其包含到生成的 Makefile 中。

# c# - 以编程方式确定 *.ts 视频文件是否使用 aes 128 加密

> ID：10252114
> 
> 赞同：2
> 
> 时间：2012-04-20T19:07:45.413
> 
> 标签：c#, testing, encryption, powershell, aes

我想编写一个简单的自动化测试来确定 .ts 视频文件是否已使用 AES 128 加密进行加密。我将可以访问加密和未加密的文件。我也可以访问密钥。我几乎可以访问所有内容，因为我正在与进行加密的开发人员合作:)

我宁愿做一个更高级的测试，而不仅仅是检查文件大小是否不同。

对我可以编写的一些简单测试代码有什么想法吗？我会用 c# 或 powershell 编写代码。

我对这些东西完全没有经验，所以请随意对待我像个孩子一样。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:26:03.797

这背后的真正原因是什么？所以你不加密文件两次，或解密两次？如果我们知道需求，也许会有更好的解决方案。

但是，根据我目前看到的情况，您似乎必须尝试解密文件，如果失败，则假设它没有加密……但这可能非常耗时。我不确定是否有任何其他方法，除了打开文件进行读取，读取一行并查看是否有任何明文，假设您知道要与之比较的明文。

如果您正在尝试测试加密/解密是否正常工作，那么您可以获取具有已知明文的输入文件，使用正确的密钥对其进行加密，然后将其解密两次 - 一次使用正确的密钥，第二次使用无效的密钥. 比较结果 3 种方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:01:53.133

如果 TS 容器是完全加密的，那么查看文件是否是有效的 MPEG-TS 文件可能会更有效，而不是试图确定它是否已加密。如果它无效，则假定它已加密。您可以读取文件的前几个字节来验证格式。格式（或“幻数”）记录在这里：

[http://en.wikipedia.org/wiki/MPEG_transport_stream#Packet](http://en.wikipedia.org/wiki/MPEG_transport_stream#Packet)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T13:44:11.490

我最终制作了 ac# 命令行。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication2
{
    using System.IO;
    using System.Security.Cryptography;

    class Program
    {
        static void Main(string[] args)
        {

            if (args.Length == 0)
            {
                Console.WriteLine("<key> <iv> <encryptedfile> <outputdecryptedfile>");
                Environment.Exit(-1);
            }

            //Console.ReadLine();
            byte[] encryptionKey = StringToByteArray(args[0]);
            byte[] encryptionIV = StringToByteArray(args[1]);

            try
            {
                using (FileStream outputFileStream = new FileStream(args[3], FileMode.CreateNew))
                {
                    using (FileStream inputFileStream = new FileStream(args[2], FileMode.Open))
                    {
                        using (var aes = new AesManaged { Key = encryptionKey, IV = encryptionIV, Mode = CipherMode.CBC })
                        using (var encryptor = aes.CreateDecryptor())
                       using (var cryptoStream = new CryptoStream(inputFileStream, encryptor, CryptoStreamMode.Read))
                        {
                            cryptoStream.CopyTo(outputFileStream);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.ToString());
            }            
        }

        public static byte[] StringToByteArray(string hex)
        {
            return Enumerable.Range(0, hex.Length)
                             .Where(x => x % 2 == 0)
                             .Select(x => Convert.ToByte(hex.Substring(x, 2), 16))
                             .ToArray();
        }

    }
} 
```

# php - 在 Wordpress 中显示带有缩略图的所有帖子类别的页面

> ID：10252115
> 
> 赞同：0
> 
> 时间：2012-04-20T19:07:45.710
> 
> 标签：php, html, css, wordpress

我需要 wordpress 中的一个页面，该页面会自动显示自定义帖子中的所有类别（帖子分类是'portfoliosets'）和缩略图。我将如何用缩略图显示这些？我可以将图像源放在类别描述中并让它从中提取吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:21:13.503

[Wordpress 有一个 codex 条目可以做你想做的事。](http://codex.wordpress.org/Function_Reference/get_the_category#Show_Category_Images)

除非最近发生了某些变化，否则自定义帖子类型将填充到与其他所有类别相同的类别结构中。因此，您只需使用该 codex 示例将某些图像与某些类别相关联，然后将其调用到页面、侧边栏或任何地方。我以前在类别旁边看到过使用 favicon 样式图像完成此操作。

# multithreading - Android 是否有稳定的原生线程 API？

> ID：10252116
> 
> 赞同：2
> 
> 时间：2012-04-20T19:07:47.697
> 
> 标签：multithreading, android-ndk

我将制作一个安卓游戏引擎，主要使用原生 C++。我想使用线程，但我不想在 Java 中实现它，因为 JNI 很慢。我可以使用任何稳定的 Android 原生线程 API 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T12:26:31.883

我今天对这个主题（Android NDK中的线程支持）做了一些研究，似乎选项如下：

1.  C++11 在 Android 上具有原生线程支持

2.  Posix 线程（又名 pthread）。

3.  Boost 在 Android 上可用，并且包括线程支持。

4.  Poco 在 Android 上可用，并且包括线程支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:10:38.773

尝试`pthreads`使用`libpthread`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T05:56:55.897

你也可以试试[Boost for Android](https://stackoverflow.com/questions/5119201/how-link-with-static-boost-libraries-for-android)的线程（Boost.Thread） 。

> 我不想用 Java 实现它，因为 JNI 很慢

根据[这里](https://stackoverflow.com/questions/4372899/android-nativeactivity)的第一篇文章，本地化并不总是会让您的代码运行得更快（您可能仍在后台从 C++ 调用 Java 代码）。

# java - Json-rpc service on java for jquery terminal emulator

> ID：10252122
> 
> 赞同：1
> 
> 时间：2012-04-20T19:08:25.910
> 
> 标签：java, jquery, spring-mvc, json-rpc, jquery-terminal

I want to write web service that provides web-terminal for remote processing custom commands. I found this jquery plugin [http://terminal.jcubic.pl/](http://terminal.jcubic.pl/). It needs JSON-RPC service. As server side i want to use java web app built on spring-mvc framework. I am new in Java EE and Spring and don't know what it is better to use for this task. Can you advice me something?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T11:43:59.450

Java [http://json-rpc.org/wiki/implementations#Java](http://json-rpc.org/wiki/implementations#Java)中有 JSON-RPC 库，您可以使用其中之一。

**更新**：我写了博客文章如何创建 JSON-RPC servlet [“准备在 java 中使用 json-rpc servlet”](https://jcubic.wordpress.com/2013/12/10/ready-to-use-json-rpc-servlet-in-java/)

# c# - 类型别名或完整命名空间

> ID：10252125
> 
> 赞同：1
> 
> 时间：2012-04-20T19:08:38.103
> 
> 标签：c#

使用类型别名而不是完整命名空间会影响性能吗？例如，只导入`Form`类 `using Form = System.Windows.Forms.Form;` 或导入所有类型 `using System.Windows.Forms;`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:09:56.970

不，这绝对不会影响您的应用程序的性能。这在理论上可能会影响编译时间。但这几乎可以肯定是微不足道的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:10:14.467

没有两者具有完全相同的性能，这只是个人喜好 - 它被编译成相同的确切代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:10:17.337

绝对没有区别 - 它在运行之前由编译器解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:10:34.270

不。在运行时没有任何东西（生成的二进制文件是相同的），编译时的影响实际上可以忽略不计。

# telerik - Telerik RadListBox, transfer item through code

> ID：10252129
> 
> 赞同：0
> 
> 时间：2012-04-20T19:09:11.463
> 
> 标签：telerik, radlistbox

Ok I just want to know if what I am thinking of is even possible. I have tried researching but was not able to find anything. I have two RadLsitBox that I can transfer data between. I want to know if I could add an Undo button that could undo the last transfer I make.

FYI Client wants an undo button. I do not think this is possible to pass items only through code without pressing the buttons but if someone has a way I would like to hear.

```
 <telerik:RadListBox ID="rlbStations" runat="server" AllowTransfer="True" TransferToID="rlbAllowedStations"
                            Height="200px" Skin="Web20" SelectionMode="Multiple" Sort="Ascending" DataKeyField="station_id"
                            AutoPostBackOnTransfer="true" Width="250px" OnTransferred="rlbStations_Transferred">
                            <ButtonSettings ShowDelete="False" ShowReorder="False" />
                        </telerik:RadListBox>

                        <telerik:RadListBox ID="rlbAllowedStations" runat="server" Height="200px" Width="250px"
                            Skin="Web20">
                        </telerik:RadListBox> 
```

EDIT: Add javascript

```
 var UndoList = new Array();
    function onClientTransferring(sender, e) {
        var items = e.get_items();
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            if (item.get_text() != "Select" || item.get_value() != "") {
                UndoList.push(item);
                UndoList.push(e.get_sourceListBox());
                UndoList.push(e.get_destinationListBox());
                sender.transferItem(item, e.get_sourceListBox(),e.get_destinationListBox());
            }
        }

    }

    function undoChanges() {
        if (UndoList[UndoList.length - 1]._clientStateFieldID == "rlbStations_ClientState") {
        var listbox = $find('rlbStations');
        }
    else if (UndoList[UndoList.length - 1]._clientStateFieldID == "rlbAllowedStations_ClientState") {
        var listbox = $find('rlbAllowedStations');
        }
        listbox.transferItem(UndoList[UndoList.length - 3], UndoList[UndoList.length - 2], UndoList[UndoList.length - 1]);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T01:46:48.873

答案是：是的！您可以在不使用内置传输按钮的情况下传输项目。下面是一个以 JavaScript 为例的代码示例：

```
function onClientTransferring(sender, e) {debugger
   //cancel the event
   e.set_cancel(true);
   //manually transfer the appropriate items
   var items = e.get_items();
   for (var i = 0; i < items.length; i++) {
       var item = items[i];
       if (item.get_text() != "Select" || item.get_value() != "") {
           sender.transferItem(item, e.get_sourceListBox(), e.get_destinationListBox());
       }
   }
} 
```

和`RadListBox`：

```
<telerik:RadListBox ID="RadListBox1"
   runat="server"
   Skin="Vista"
   AllowTransfer="true"   
   TransferToID="RadListBox2"
   DataKeyField="ID"  
   OnClientTransferring="onClientTransferring"
   DataTextField="Name"
   DataValueField="ID"       
   DataSourceID="SqlDataSource1" >    
</telerik:RadListBox>
<telerik:RadListBox ID="RadListBox2" runat="server"
   Skin="Vista"
   AllowTransfer="true"> 
```

[http://www.telerik.com/help/aspnet-ajax/listbox-how-to-transfer-specific-items-with-transferall-button.html](http://www.telerik.com/help/aspnet-ajax/listbox-how-to-transfer-specific-items-with-transferall-button.html)

# ruby - Scoping a Transform in Cucumber

> ID：10252131
> 
> 赞同：5
> 
> 时间：2012-04-20T19:09:13.317
> 
> 标签：ruby, cucumber

I'm working with a very large set of already existing cucumber features, and adding additional tests. For those new tests I'm also trying to use transforms to simplify repetitive tasks.

How can I add a transform without breaking already existing tests? I've already added context to the capture group, but since the context is from the same business domain as the pre-existing tests it can easily end up matching.

Is there a way to only apply a transform to certain steps?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T12:51:11.290

您可以使用标签和 Before 过滤器在 World 中设置实例变量。然后，您的 Transform 可以使用它，以便它可以执行特定于标签的转换。例如，如果您只想在存在 @hook 标记时转换整数：

```
Transform /(\d+)/ do |num|
  if @hook
    num.to_i
  else
    num
  end
end

Before('@hook') do
  @hook = true
end 
```

为每个场景创建一个新世界，并调用 Before 过滤器。所以@hook 将为每个场景重置。

# php - Nested relationships in Kohana 3 ORM

> ID：10252132
> 
> 赞同：1
> 
> 时间：2012-04-20T19:09:15.747
> 
> 标签：php, orm, kohana, kohana-3, relationships

Let's say I have three ORM models in Kohana.

```
class Model_Category extends ORM
{
    protected $_has_many = array(
        'groups'      => array(
            'model'       => 'group',
            'foreign_key' => 'category_id'
        )
    );
}

class Model_Group extends ORM
{
    protected $_has_many = array(
        'users'      => array(
            'model'       => 'user',
            'foreign_key' => 'group_id'
        )
    );
}

class Model_User extends ORM
{

} 
```

I would get all the groups in a category by calling `ORM::factory('category')->find($id)->groups`. I would find all the users in a group by calling `ORM::factory('group')->find($id)->users`. How would I find all the users in a category?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T08:52:44.327

我会通过 callin 找到一个组中的所有用户

```
 $groups = ORM::factory('category', array('id', $id))->groups->find_all(); 
```

我如何找到一个类别中的所有用户？

```
 ORM::factory('group', array('id', $id))->users->find_all(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T19:31:02.507

查找某个类别中的所有组

```
$groups = ORM::factory('category', $id)->groups->find_all(); 
```

遍历组并获取她的用户

```
foreach ($groups as $group) 
{
  $users = $group->users->find_all()
} 
```

或者建立一个连接，像这样

```
 $users = DB::select('users.*')->from('categories')
     ->join('groups', 'LEFT')
     ->on('categories.id', '=', 'groups.category_id')
     ->join('users', 'LEFT')
     ->on('groups.id', '=', 'users.group_id')
     ->where('categories.id', '=', $id)
     ->execute(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-22T04:39:45.850

`ORM::factory('category', $id)->users->find_all()`在添加了一个 has many *through*关系后，您将能够使用：

```
class Model_Category extends ORM
{
    protected $_has_many = array(
        'users' => array('through' => 'groups'),
        // ...
    );
} 
```

# jquery - jQuery 显示以当前输入值为条件的额外字段

> ID：10252136
> 
> 赞同：0
> 
> 时间：2012-04-20T19:09:36.277
> 
> 标签：jquery

很抱歉问了这么一个基本的问题。说，我有两个输入。第一个始终可见，而第二个仅在第一个的值小于 0 时显示。我尝试使用 .change 来实现此活动，但它不起作用。那么有人可以给我一些建议吗？提前致谢。

HTML 代码：

```
<table>
<tr><th><label for="id_first">First input:</label></th><td><input type="text" name="First input" id="id_first" /></td></tr>
<tr><th><label for="id_second">Second input:</label></th><td><input type="text" name="First input" id="id_second" />
</td>
</tr>
</table> 
```

jQuery代码

```
<script type="text/javascript" src=" ../stylesheets/jQuery-1.7.2.js"></script> 

<script>
$(document).ready(function() {
    $('#id_second').closest('tr').hide();
    $('#id_first').change(function() {    
    if ($(this).val() <0){
        $('#id_second').show()}    
    else{
        }
    });​​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T19:30:53.167

您的 jquery 代码应如下所示。你有一个语法错误。您没有关闭更改功能，您必须显示“tr”，而不仅仅是输入元素

```
$(document).ready(function() {
    $('#id_second').closest('tr').hide();
    $('#id_first').change(function() {    
        if ($(this).val() <0){
            $('#id_second').closest("tr").show()
        }    
        else{
        }
    });
});​​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:40:14.407

请在检查`if ($(this).val() <0)`条件时使用长度属性

```
$('#id_second').closest('tr').hide();
$('#id_first').keyup(function() {    

if ($(this).val().length < 1){
    $('#id_second').closest("tr").show()}    
else{
        }
        });
​ 
```

（@dg3 编码）

[http://jsfiddle.net/chepe263/jPybT/3/](http://jsfiddle.net/chepe263/jPybT/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:45:38.783

```
$(document).ready(function() {
     $('#id_second').parents("tr").hide();

     $("#id_first").keyup( function() {
        if((parseInt($(this).val(), 10)<0)){
            $('#id_second').parents("tr").show();}
        else {
            $('#id_second').parents("tr").hide();}
     });
}); 
```

[JsFiddle 演示](http://jsfiddle.net/NnQxh/1/)

`.val()`越来越`string`。您必须将其转换为`integer`使用`parseInt(string,radix)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:50:24.683

对不起我的英语不好。我认为这个解决方案必须正常工作。

```
<table>
        <tr>
            <th>
                <label for="id_first">First input:</label>
            </th>
            <td>
                <input type="text" name="First input" id="id_first" />
            </td>
        </tr>
        <tr>
            <th>
                <label for="id_second" style='display:none'>Second input:</label>
            </th>
            <td>
                <input type="text"  name="First input" id="id_second" style='display:none'/>
            </td>
        </tr>
    </table>

<script>
        // Subscribe on keyup event in first input
        $('#id_first').on('keyup', function(){
            // here "this" refers to input in which we have press the key

            // Getting first input value
            var inputValue = this.value;

            // Casting input value to number
            // -12a became -12
            // a12 or any value starting from a character became 0 
            inputValue = parseFloat(inputValue) || 0;

            // Now we selecting input and a label which we want to show/hide
            var $second = $('#id_second, label[for="id_second"]');

            // Check if first one's value is less than 0 
            // and shows the second row, if it is
            if(inputValue < 0)
                $second.show();
            // Otherwise hides the second row
            else
                $second.hide();

        })

    </script> 
```

# php - how to solve HTTP/1.1 302 Found error when trying to get contents of a form in php?

> ID：10252145
> 
> 赞同：4
> 
> 时间：2012-04-20T19:10:03.693
> 
> 标签：php, forms, apache, http-status-code-302, http-1.1

I'm having a bug in my aplication, when I try to submit a form (POST Method) with a lot of information, an HTTP/1.1 302 Found error occur to the file that receive the info and make a redirrection to my index

The html code and php are both simple, but the info is big

The code of the form

```
 <form name="resena" action="consultas/resena.php" method="post" enctype="multipart/form-data">
<fieldset>
    <legend><?php echo $titulo; ?> una reseña</legend>
    <br /><br /><label for="titulo">Título</label><input type="text" name="titulo" id="titulo" size="45" maxlength="100" value="<?php echo $con["titulo"]; ?>" placeholder="hasta 70-100 caracteres o menos" titulo="hasta 70-100 caracteres o menos" onkeyup="texto(titulo)" required />
    <br /><br /><label for="fecha">Fecha</label><input type="text" name="fecha" id="fecha" size="12" maxlength="10" value="<?php echo $con["fecha"]; ?>" placeholder="Fecha" required="required" readonly="readonly" /><input name="f_b" type="button" id="f_b" value="...">
    <br /><br /><label for="resumen">Resumen</label><textarea name="resumen" id="resumen" cols="60" rows="4" wrap="hard" onkeyup="texto_tarea(resumen);"><?php echo $con["resumen"]; ?></textarea>
    <br /><br /><label for="eventos">Evento relacionado</label><select name="eventos" title="eventos"><option value=""></option><?php $s_ev=mysql_query("SELECT * FROM eventos"); while($v_ev=mysql_fetch_array($s_ev)){?><option value="<?php echo $v_ev["id_prod"];?>" <?php if($evento==$v_ev["id_ev"]){?>selected="selected"<?php } ?>><?php echo $v_ev["titulo"]?></option><?php } ?></select>
    <br /><br /><input type="submit" name="Aceptar" value="Aceptar" class="bot" style="float:left;" />&nbsp;&nbsp;<input type="reset" name="Vaciar Formulario" value="Vaciar Formulario" class="bot" />
</fieldset>
</form>
<?php 
    include("ckeditor.php");
    $CKEditor = new CKEditor();
    $CKEditor->basePath = '/edicion/';
    $CKEditor->replaceAll();
?>
<script>Calendar.setup({inputField:"fecha", ifFormat:"%Y/%m/%d",button:"f_b"});</script> 
```

The receptor is has only the query to the database

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T19:20:01.000

302 is not an error but a redirect to a temporary location. You could resend the request to the new location received in the response header.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T07:03:37.287

You were right guys it was a **server misconfiguration**, the **modSecurity** firewall was blocking my on requests an making automatics redirections (302).

The server's administrator help with it and Now **everything is running good**

**Thanks a lot to all who try to help me here**

# typo3 - 全新 TYPO3 安装的 PHP 运行时通知

> ID：10252146
> 
> 赞同：2
> 
> 时间：2012-04-20T19:10:06.753
> 
> 标签：typo3

我的服务器：PHP 5.4.0-8+fastCgi auf nginx 服务器，debian 挤压

我刚刚安装了新的 TYPO3 dummy+source 版本。当我在后端添加一个新站点时，我收到以下消息：

> PHP 运行时注意事项： tx_rtehtmlarea_base::drawRTE() 的声明应该与 t3lib_rteapi::drawRTE(&$pObj, $table, $field, $row, $PA, $specConf, $thisConfig, $RTEtypeVal, $RTErelPath, $ 兼容/var/www/meinprojekt/typo3/sysext/rtehtmlarea/class.tx_rtehtmlarea_base.php 第 36 行中的 thePidValue）

在错误消息 TYPO3 下方提示了一个错误： http: [//forge.typo3.org/issues/31353](http://forge.typo3.org/issues/31353) 我安装了错误修复，但没有任何效果。错误仍然存​​在。顺便说一句，安装工具没问题，它没有错误或警告。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:58:17.620

这是因为您的 php.ini 将[error_reporting](http://www.php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)设置为包含 E_STRICT 警告。E_STRICT 有利于开发，因为它会警告您各种可以解决的小错误，但您可以在生产服务器上将其关闭而无需担心。

# javascript - 为什么我的正则表达式在 RegexPal 中有效，但在我运行 Javascript 时无效？

> ID：10252150
> 
> 赞同：0
> 
> 时间：2012-04-20T19:10:17.180
> 
> 标签：javascript, html, regex

我在 Firefox 中运行一些似乎不遵循正则表达式规则的 JavaScript 代码。我正在尝试拆分一个坐标字符串，其中包含一些时髦的空格，如下所示：

```
-117.2967917,35.5189858 -117.2966678,35.5189526

-117.296678,35.5187657 -117.2968027,35.5187999

-117.2967917,35.5189858 
```

我知道正则表达式`\s`应该匹配所有间距，所以我曾经`\s+`在[RegexPal](http://regexpal.com/)中分割我的字符串，效果很好，如下所示：

![](../Images/34293853a25d4cc57b2e1f0c2178d4e6.png)

但是由于某种原因，当我使用这个正则表达式运行我的 JavaScript 代码时，我得到了一个包含整个字符串的单元素数组。这是我的代码：

```
var coordArray = polygonString.split("\s+"); 
```

我尝试了几种不同的正则表达式，但我的 JavaScript 中的 split 函数似乎并没有表现得像它应该的那样。它不会在 RegexPal 中产生相同的结果。为什么是这样？我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T19:12:13.053

采用：

```
var coordArray = polygonString.split(/\s+/); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:13:42.733

看到[这里](https://stackoverflow.com/questions/812144/javascript-wont-split-using-regex)，你需要用斜杠包围正则表达式，试试`polygonString.split(/\s+/);`

# c# - 杀死从嵌套线程启动的多个进程... C#

> ID：10252155
> 
> 赞同：1
> 
> 时间：2012-04-20T19:10:35.940
> 
> 标签：c#, multithreading, process, nested, kill

我是编程新手。我有一个启动线程的表单应用程序。从那里启动了 4 个新线程。这些线程中的每一个都执行一系列命令行进程，如下所示：

```
ProcessStartInfo startInfo = new ProcessStartInfo();
        startInfo.WorkingDirectory ="C:\\BLA\\bin_windows";
        startInfo.UseShellExecute = false;
        startInfo.RedirectStandardOutput = true;
        startInfo.CreateNoWindow = true;

            startInfo.FileName = "SomeProcess"
            Process p = Process.Start(startInfo);
        p.WaitForExit(); 
```

当表单应用程序关闭时，它会中止第一个线程（不是 4 个单独的线程）。现在我的问题是当我关闭表单时如何强制进程“p”退出？我尝试了以下方法：

```
 foreach (Process p in System.Diagnostics.Process.GetProcessesByName("SomeProcess"))
    {
        try
        {
            p.Kill();
            p.WaitForExit(); // possibly with a timeout
        }
        catch
        { continue; }
    } 
```

但是，这种方法对我来说似乎有点残酷，并且并不总是很好......有没有一种方法可以让我只识别我自己启动的进程然后终止它们？任何建议都非常感谢。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:25:25.403

您几乎无法控制已运行的进程。杀死他们是一种方式。如果进程是一个窗口应用程序（即有一个窗口），您可以尝试向它发送一条`WM_CLOSE`消息，这相当于单击窗口上的关闭按钮。同样，应用程序必须有一个可见或隐藏的窗口，因此它不能在每个应用程序上运行。大多数应用程序都有窗口，即使不可见。

```
const uint WM_CLOSE = 0x10;

[DllImport("user32.dll", CharSet = CharSet.Auto)]
public static extern int SendMessage(IntPtr hWnd, uint uMsg, int wParam, int lParam);

Process p = Process.GetProcessesByName("notepad").FirstOrDefault();
if(p != null)
{
    IntPtr hWnd = p.MainWindowHandle;
    SendMessage(hWnd, WM_CLOSE, 0, 0);
} 
```

要仅杀死/关闭您生成的进程，只需保留它们的`Process`对象，或者至少`p.MainWindowHandle`如果您想使用我给您的方法。为此，在你的类中有一个类型为`ConcurrentBag<Process>`（或`ConcurrentBag<IntPtr>`）的公共属性。它已经是线程安全的。

**编辑**

正如有人指出的那样，您可以这样做来关闭进程的主窗口：

```
p.CloseMainWindow() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:45:34.617

如果您的程序不应该一次运行两次，您可以在单例上使用某种进程管理器：

```
internal sealed class ProcessManager
{
    private readonly IList<Process> processes;

    #region Singleton

    private static readonly object locker = new object();
    private static volatile ProcessManager instance;

    private ProcessManager()
    {
        processes = new List<Process>();
    }

    public static ProcessManager Instance
    {
        get
        {
            if (instance == null)
            {
                lock (locker)
                {
                    if (instance == null)
                    {
                        instance = new ProcessManager();
                    }
                }
            }

            return instance;
        }
    }

    #endregion

    public void AddProcess(Process process)
    {
        lock(processes)
        {
            processes.Add(process);
        }
    }

    public void TerminateAll()
    {
        lock(processes)
        {
            foreach (Process p in processes)
            {
                try
                {
                    p.Kill();
                    p.WaitForExit(); // possibly with a timeout
                }
                catch
                {
                     continue;
                }
            }
        }
    }
} 
```

用法：

```
ProcessStartInfo startInfo = new ProcessStartInfo();
    startInfo.WorkingDirectory ="C:\\BLA\\bin_windows";
    startInfo.UseShellExecute = false;
    startInfo.RedirectStandardOutput = true;
    startInfo.CreateNoWindow = true;

        startInfo.FileName = "SomeProcess"
        Process p = Process.Start(startInfo);
        ProcessManager.Instance.AddProcess(p);
    p.WaitForExit(); 
```

如果你不希望你的 prog 中有静态的东西（例如，你可以有一些它的实例），你可以使用这个类，但没有单例并将它的单个实例提供给每个线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:50:56.660

如果要关闭进程，则无需 P/Invoke 并发送 WM_CLOSE 消息，只需在 Process 实例上调用[CloseMainWindow()](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.closemainwindow.aspx)方法（它将为您发送 WM_CLOSE）。[然后，您可以使用Close()](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.close.aspx)方法跟进它以释放您的本地视图。

跟踪您已启动的流程也相当容易。

```
public static ConcurrentBag<Process> processes = new ConcurrentBag<Process>(); 
```

在创建过程时存储它们。

```
Process process = ... //Create your process
processes.Add(process); 
```

然后循环并关闭它们。

```
foreach (var process in processes)
{
    if (!process.HasExited)
    {
        process.CloseMainWindow();
        process.Close();
    }
} 
```

# android - 如何将 SyncAdapter 用于不需要身份验证的应用程序

> ID：10252157
> 
> 赞同：0
> 
> 时间：2012-04-20T19:10:39.837
> 
> 标签：android, android-syncadapter

我需要一种方法来更新我的应用程序上的数据。我阅读了 SyncAdapter 并看到它需要一个 AbstractAccountAuthenticator，但我的应用程序不需要用户填写任何用户/密码信息。我该如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:14:45.047

同步适配器不需要 AbstractAccountAuthenticator。SampleSyncAdapter 使用一个，因为它使用身份验证，但身份验证不是必需的。该示例之所以这样做，是因为它将联系人与联系人提供程序同步。

同步适配器与帐户类型相关联。您可以在同步适配器的 XML 文件中指定它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T07:32:10.633

如果您的问题是本机通讯录中的联系人同步，并且您没有身份验证器并且没有使用该帐户类型注册的用户，则不会显示您创建的联系人。

我所做的是创建一个存根验证器。

试试这个：

[存根验证器示例](https://stackoverflow.com/questions/5146272/sync-adapter-without-account)

考虑到 SyncAdapter 的真正问题是，如果没有 Internet 连接，它就不会处于活动状态。原因是同步适配器被认为用于将本地数据与后端服务器同步，因此如果您没有 Internet 连接，则无法同步，并且框架会禁用 SyncAdapter。我所做的是创建自己的组件来同步联系人。

# javascript - 如何使用 Meteor 监控服务器对集合的更改？

> ID：10252161
> 
> 赞同：1
> 
> 时间：2012-04-20T19:11:21.137
> 
> 标签：javascript, mongodb, meteor

每次将新文档添加到给定集合时，我都想发送一封电子邮件。从服务器端订阅集合是使用 Meteor 执行此操作的正确方法吗？

发布/订阅提供了一种[将观察者附加到订阅](http://docs.meteor.com/#meteor_publish)的方法，但这似乎只监视来自客户端的连接，而不是集合本身（当客户端连接到它时，“add”被调用整个集合内容）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:34:54.390

正确的方法是使用 Meteor.methods() 添加一个服务器方法。相关文档在这里：[http](http://docs.meteor.com/#meteor_methods) ://docs.meteor.com/#meteor_methods 。

要发送电子邮件，您需要向另一台服务器发出请求，因为流星还没有内置的电子邮件发送功能。发出 http 请求的文档在这里：[http://docs.meteor.com/#meteor_http_post](http://docs.meteor.com/#meteor_http_post)。

小例子：

```
Meteor.methods(
  create_document: function (options) {
    //insert the document
    //send a post request to another server to send the email
  }
) 
```

然后在客户端上，您会调用：

```
Meteor.call("create_document", <your options>); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T17:44:54.453

我不这么认为。但是有一个很好的方法使用`YourCollection.deny()`：

在服务器上：

```
Meteor.startup(function(){
  YourCollection.deny({
    insert: function (userId, item) {
      // Send your Email here, preferential 
      // in a asynchronous way to not slow down the insert
      return false;
    }
  });
}); 
```

如果客户端将一个项目插入到 YourCollection 中，服务器会通过首先运行所有拒绝函数来检查他是否被允许，直到其中一个返回 true，否则所有允许规则，除非其中一个返回 true。

> 如果至少有一个允许回调允许写入，并且没有拒绝回调拒绝写入，则允许写入继续。——流星医生。

请注意，您不能将 YourCollection.allow() 用于您想要的，因为它不一定会运行（如果没有拒绝，则一个允许就足够了）。

但请注意：如果您使用默认使用的不安全包，则除非您设置自己的规则，否则一切都将被允许。当您刚刚执行此操作时，您可能希望通过添加现在允许插入

```
YourCollection.allow({
  insert: function (userId, item) {return true;},
  update: function (userId, item) {return true;},
  remove: function (userId, item) {return true;}
}); 
```

在拒绝功能旁边。
-最好的，扬

# c# - string split into array not working

> ID：10252162
> 
> 赞同：1
> 
> 时间：2012-04-20T19:11:22.510
> 
> 标签：c#

I am trying to split a string from a text file into an array so that I can store them in a class but it is not working; it doesn't split it, it returns the same format in the textfile.txt

```
using (StreamReader reader = new StreamReader("textfile.txt"))
{
  string line;
  while ((line = reader.ReadLine()) != null)
  {
    char[] delimiters = new char[] { '\t' };
    string[] parts = line.Split(delimiters, StringSplitOptions.RemoveEmptyEntries);
    for (int i = 0; i < parts.Length; i++)
    {
      MessageBox.Show(parts[i]);
    }

  }
} 
```

the text file contains:

```
George\t15\tStudent\tAddress\tB:\temp\profilepic.png 
```

I want it to look like this (after the split):

```
George
15
Student
Address
profilepic.png 
```

Any ideas or help appreciated.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:14:38.897

“\t”是一个特殊字符，意思是“制表符”。如果您想实际查找`\t`需要使用的字符串`"\\t"`或`@"\t"`. 您也不需要将其设为 char 数组；字符串有重载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:41:25.930

使用您提供的示例行，我认为您可以获得的最接近的可能是使用以下正则表达式，也许如果您使用它，您可以让它不给您路径，或者，在您的循环中您可以检查路径并跳过它，这应该告诉你它是否是路径`[a-zA-Z]:\\\w*?\\`

```
string[] results = Regex.Split(line, @"(?<!B:)\\t|(?<=B:\\\w*?\\)"); 
```

它产生这个列表：

*   乔治
*   15
*   学生
*   地址
*   乙：\温度\
*   个人资料图片.png

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:17:36.873

您应该`"\\t"`用作拆分**字符串**。你应该得到：
George
15
学生
地址
B：
emp\profilepic.png

不是 **profilepic.png**

编辑：在我的回答`"\\t"`中显示`"\t"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:24:14.263

您在这里遇到的问题是[Escape Sequences](http://msdn.microsoft.com/en-us/library/h21280bw.aspx)。以 ' ' 开头的字符组合`\`被视为转义序列，它们的行为与常规字符串不同。从链接中的表格可以看出，“ `\t`”代表一个水平选项卡。因此，当在 C# 中使用 ' `\t`' 作为分隔符时，它会查找水平制表符，但是您的纯文本中包含实际的字符序列 ' `\t`'，这就是您要查找的内容。

`\t`那么问题就变成了，如果当我将它用作分隔符时它会搜索水平制表符，我该如何找到它？答案也显示在链接中；' `\\`' 是 ' ' 的表示`\`（如果你考虑一下，这是必要的，否则你怎么能找到 ' `\(anything)`'。所以你的分隔符必须是 ' `\\t`'。

（应该注意，你也可以用字符串来做到这一点，而不是将所有东西都变成字符数组，原理仍然成立）

# asp.net - How can I install Website Administration Tool (WSAT) to webServer

> ID：10252164
> 
> 赞同：0
> 
> 时间：2012-04-20T19:11:37.687
> 
> 标签：asp.net, asp.net-membership

I designed my website using VS2010 and added membershipAPIs to authenticate users. Now I want to install the management pages of membership to my webServer so I can change users and roles in the remote Server. I searched the net but didn't get useful way. I guess I don't need to design my own management pages, right ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:25:43.067

您不能在远程服务器上使用网站管理工具 (WSAT)，但这里有一些为您提供类似功能的项目的链接：

*   [http://www.4guysfromrolla.com/articles/052307-1.aspx](http://www.4guysfromrolla.com/articles/052307-1.aspx)
*   [http://peterkellner.net/2006/01/09/microsoft-aspnet-20-memberrole-management-with-iis/](http://peterkellner.net/2006/01/09/%20microsoft-aspnet-20-memberrole-management-with-iis/)
*   [http://mywsat.codeplex.com/](http://mywsat.codeplex.com/)

参考：[http ://forums.asp.net/post/3017713.aspx](http://forums.asp.net/post/3017713.aspx)

# sql - groupby/合并到最新记录？

> ID：10252170
> 
> 赞同：1
> 
> 时间：2012-04-20T19:12:08.790
> 
> 标签：sql, sql-server, tsql

我有两张桌子：

表 1：Food_I_Have_In_Fridge：

```
Food  | Category
---------------
Apple | Fruit
Beef  | Meat
Tomato| Veggie
Pork  | Meat
Bacon | Meat
Orange| Fruit
Carrot| Veggie 
```

表 2：Food_I_ate：

```
Date | Food
------------
Mon  | Apple
Mon  | Beef
Tues | Pork
Thurs| Orange
Sat  | Tomato 
```

我想生成按食物类别分类的我最后吃的东西的列表。输出如下所示：

```
Categ| Food
-----------
Meat | Pork
Fruit| Orange
Veggi| Tomato 
```

我无法对行进行分组和合并，有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:01:04.697

假设您确实在日期列*中*使用工作日名称，这里有一个解决方案，可以将工作日转换为工作日索引并按类别查找最新食物：

```
;with FW as (
    select w.ix, f.category, a.food, a.date
    from
        [Food_I_ate] a
    inner join
        [Food_I_Have_In_Fridge] f on a.Food = f.Food
    inner join
    (
        select 0 as ix, 'Sun' as weekdayname union
        select 1, 'Mon' union
        select 2, 'Tues' union
        select 3, 'Wed' union
        select 4, 'Thurs' union
        select 5, 'Fri' union
        select 6, 'Sat'
     ) w on w.weekdayname = a.[Date]
)
select
    FW2.category,
    FW2.Food,
    FW2.Date
from
    (select FW.category, max(fw.ix) as maxix
     from FW group by FW.category) FW
inner join
    FW FW2 on FW2.ix = FW.maxix and FW2.category = FW.category 
```

样本输出：

```
CATEGORY    FOOD    DATE
Veggie      Tomato  Sat
Meat        Pork    Tues
Fruit       Orange  Thurs 
```

演示：[http ://www.sqlfiddle.com/#!3/4b92f/21](http://www.sqlfiddle.com/#!3/4b92f/21)

# xsd - xsd 选择覆盖

> ID：10252173
> 
> 赞同：2
> 
> 时间：2012-04-20T19:12:23.990
> 
> 标签：xsd, polymorphism, abstract, choice

我需要定义一组 XSD。每个 XSD 都会有一个 header 元素，并且该 header 是相同的，除了中间的一些元素。

所以，我会：

xml1：

```
<req1>
    <head>
        <common1/>
        <common2/>
        <choice1/>
        <choice2/>
        <common3/>
    </head>
    <data1>...</data1>
</req1> 
```

xml2：

```
<req2>
    <head>
        <common1/>
        <common2/>
        <choice2/>
        <choice3/>
        <common3/>
    </head>
    <data2>...</data2>
</req2> 
```

其中choice1，choice2，choice3在一个`<choice>`集合中，比如

```
<choice>
    <choice2/>
    <choice3/>
</choice> 
```

并且可以在不同的请求类型之间有不同的选择和元素数量。

我真的希望能够在单个 XSD 中为标头定义它，然后将其包含在 req1.xsd 和 req2.xsd 中。我不知道如何`<choice>`动态交换它。如果我没有这个`<common3/>`部分，我可以使用一个基础元素，但我的理解是，当我向基础添加任何东西时，它只会在最后添加。有什么办法可以在中间更换，或者在使用底座时在中间添加？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T23:12:08.707

一种方法是使用替换组。您为样板定义了一个基本 XSD。

基础.xsd

```
<?xml version="1.0" encoding="utf-8"?>
<!--W3C Schema generated by QTAssistant/XML Schema Refactoring Module (http://www.paschidev.com)-->
<xsd:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element name="head">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="common1" type="xsd:anyType"/>
                <xsd:element name="common2" type="xsd:anyType"/>
                <xsd:element ref="headerPlaceholder"/>
                <xsd:element name="common3" type="xsd:anyType"/>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>
    <xsd:element name="headerPlaceholder" type="headerPlaceholder" abstract="true"/>
    <xsd:complexType name="headerPlaceholder" abstract="true"/>
    <xsd:complexType name="request" abstract="true">
        <xsd:sequence>
            <xsd:element ref="head"/>
        </xsd:sequence>
    </xsd:complexType>
</xsd:schema> 
```

然后你可以独立构建你的 req1 和 req 。

请求1.xsd

```
<?xml version="1.0" encoding="utf-8"?>
<!--W3C Schema generated by QTAssistant/XML Schema Refactoring Module (http://www.paschidev.com)-->
<xsd:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:include schemaLocation="SubstitutionGroupHeader.xsd"/>

    <xsd:element name="req1" type="req1"/>
    <xsd:complexType name="req1">
        <xsd:complexContent>
            <xsd:extension base="request">
                <xsd:sequence>
                    <xsd:element name="data1"/>
                </xsd:sequence>         
            </xsd:extension>
        </xsd:complexContent>
    </xsd:complexType>

    <xsd:element name="choice1" substitutionGroup="headerPlaceholder">
        <xsd:complexType>
            <xsd:complexContent>
                <xsd:extension base="headerPlaceholder"/>
            </xsd:complexContent>
        </xsd:complexType>
    </xsd:element>

    <xsd:element name="choice2" substitutionGroup="headerPlaceholder">
        <xsd:complexType>
            <xsd:complexContent>
                <xsd:extension base="headerPlaceholder"/>
            </xsd:complexContent>
        </xsd:complexType>
    </xsd:element>  
</xsd:schema> 
```

结构如下所示：

![要求 1](../Images/4458849b2344e0b13c02f08be3fba278.png)

请求2.xsd

```
<?xml version="1.0" encoding="utf-8"?>
<!--W3C Schema generated by QTAssistant/XML Schema Refactoring Module (http://www.paschidev.com)-->
<xsd:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:include schemaLocation="SubstitutionGroupHeader.xsd"/>

    <xsd:element name="req2" type="req2"/>
    <xsd:complexType name="req2">
        <xsd:complexContent>
            <xsd:extension base="request">
                <xsd:sequence>
                    <xsd:element name="data2"/>
                </xsd:sequence>         
            </xsd:extension>
        </xsd:complexContent>
    </xsd:complexType>

    <xsd:element name="choice3" substitutionGroup="headerPlaceholder">
        <xsd:complexType>
            <xsd:complexContent>
                <xsd:extension base="headerPlaceholder"/>
            </xsd:complexContent>
        </xsd:complexType>
    </xsd:element>

    <xsd:element name="choice4" substitutionGroup="headerPlaceholder">
        <xsd:complexType>
            <xsd:complexContent>
                <xsd:extension base="headerPlaceholder"/>
            </xsd:complexContent>
        </xsd:complexType>
    </xsd:element>  
</xsd:schema> 
```

req2 的结构：

![要求 2](../Images/9acf9d5b402959591d01d57cd21a40c8.png)

我将choice1/2 和choice3/4 放在req1 和req2 中，只是为了内容之间没有重叠。所以文件结构看起来像这样：

![XSD 文件关系](../Images/9047f2c2479a51ef5fd82c4f7203eebc.png)

XSD组件之间的整体关系：

![QTAssistant XSD 组件关系图](../Images/dff32fe0149c9fefd62cc42f89916dd7.png)

如果您想从 req1 和 req2 中引用相同的choice2，则必须在其自己的文件中重构choice2，等等。

关于选择与替代组可以讨论很多，但这是另一回事......

# excel - 打开excel文件并导出数据

> ID：10252175
> 
> 赞同：-1
> 
> 时间：2012-04-20T19:12:52.270
> 
> 标签：excel

我在电子表格的 Excel 文件中有三个工作表 1 和 2 有一些表达式要计算。有什么更好的方法来处理这个 excel 文件并将一些数据导出到电子表格 3 中，而工作表 1 和 2 将使用电子表格作为数据源 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:01:47.330

如果您想将数据从一个电子表格移动到另一个电子表格，您可以编写 VB 或录制宏。

# c - 下面的代码有什么问题

> ID：10252177
> 
> 赞同：2
> 
> 时间：2012-04-20T19:12:59.557
> 
> 标签：c

该代码假设将一个由 n 个元素组成的一维向量旋转到 i 位置。例如，当 n=8 和 i = 3 时，向量 abcdefgh 旋转为 defghabc。

以下在 string_reverse 函数处崩溃。无法找出那里出了什么问题。

```
#include <stdio.h>
#include <string.h>
#include < conio.h>

void string_reverse(char* str, int left, int right )
{
    char *p1 = str + left;
    char *p2 = str + right;

    while (p1 < p2) 
    {
        char temp = *p1;
        *p1 = *p2;
        *p2 = temp;
        p1++;
        p2--;
    }
}

void rotate( char* str, int k )
{
    int n = strlen( str );
    string_reverse( str, 0, k - 1 );
    string_reverse( str, k, n - 1 );
    string_reverse( str, 0, n -1 );
}

int main(int argc, char* argv[])
{
    char* string = "abcdefghijk";

    rotate( string, 3 );    
    printf("%s",string );   
    getch();
    return 0;
}

it crashes at 

*p1 = *p2; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:23:30.413

改变

```
char* string = "abcdefghijk"; 
```

至

```
char string[] = "abcdefghijk" 
```

前者指向只读字符串文字，而后者是从该文字初始化的数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T19:21:39.040

如果要使用字符串进行操作，请使用真正的字符数组而不是字符指针。

```
 char string[] = "abcdefghijk"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:17:35.110

作为变量初始化器分配的内存，像这样......

```
char* string = "abcdefghijk"; 
```

...是不可变的。也就是说，您无法更改它，并且尝试写入它会导致段错误。您只能修改通过`malloc()`和朋友分配的内存。您可以使用这样的静态字符串轻松完成此操作：

```
char *string = strdup("abcdefghijk"); 
```

该`strdup()`函数`malloc()`在内部调用，然后将源字符串复制到目标中。您已经`#include`-ing`string.h`了，因此`strdup()`函数原型已经可用，无需任何额外代码。

# c# - 定义一个针对 Restful 服务运行的报告

> ID：10252186
> 
> 赞同：0
> 
> 时间：2012-04-20T19:13:46.153
> 
> 标签：c#, .net, reporting

我正在尝试设计一个允许用户定义报告并将定义存储在数据库中的系统。定义可以指定要包含的字段和排序顺序 - 没有聚合函数。

报告可以从网站运行，也可以通过预定任务运行程序运行，该运行程序通过电子邮件向用户发送 PDF、RTF 或 CSV 格式的数据。

数据源是 WCF 服务 - 而不是 SQL。

我查看了可以在 RDL 中定义报告的 SSRS，但我不确定如何将其插入对象数据源。

我研究过的大多数报告工具都涉及使用他们的设计器和显示插件，这在此处是不可能的。

有没有人遇到任何至少会给我报告中的数据的东西 - 没有必要将其打包为 PDF/RTF/CSV 等，因为这可以是一个单独的过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:18:52.320

SSIS 不做 RDL。您正在考虑 SSRS（SQL Server 报告服务）。您可能想要研究构建模型并让您的用户使用[Report Builder](http://technet.microsoft.com/en-us/library/dd220460%28v=sql.100%29.aspx)。需要注意的一点是，从 Reporting Services 中的 XML 数据源查询 Web 服务需要很好地理解如何读取 WSDL 文件。

以下参考对于在 Reporting Services 中构建 XML 查询非常有用：

1.  [Reporting Services：使用 XML 和 Web 服务数据源](http://msdn.microsoft.com/en-US/library/aa964129%28v=SQL.90%29.aspx)
2.  [用于指定 XML 报告数据 (SSRS) 的 XML 查询语法](http://msdn.microsoft.com/en-us/library/ms345251%28v=SQL.105%29.aspx)
3.  [用于指定 XML 报告数据 (SSRS) 的元素路径语法](http://msdn.microsoft.com/en-us/library/ms365158.aspx)

另请参阅[主页 » 文章讨论 » 作者的文章讨论 » 讨论 Michael Davis 发布的内容 »](http://www.sqlservercentral.com/Forums/Topic859325-2580-9.aspx) SqlServerCetnral.com 上的报告服务器诊断报告第 9 页。我在页面的中间写了一篇文章，其中提供了一个非常详细的示例，用于查询某些 Reporting Services Web 服务以获取有关报告的信息。

# c# - 需要 Restful Web 服务，但需要重定向到 SharePoint

> ID：10252188
> 
> 赞同：0
> 
> 时间：2012-04-20T19:13:50.697
> 
> 标签：c#, sharepoint, rest, httphandler

我面临以下情况，我不知道如何处理。欢迎任何建议或想法。

要求：

1.  提供一个使用参数处理 GET 的宁静 Web 服务。
2.  将用户重定向到 SharePoint 2007 登录页面，这些参数仍然可用。

是）我有的：

1.  一个提供所需端点的宁静 Web 服务（用 C# 编写并托管在 IIS 7.5 上）
2.  SharePoint 网站已设置

我不知道如何正确处理这个问题，因为对宁静端点的要求不是我的，我无法改变那部分。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:24:41.857

我不知道我能提供多少帮助，但既然没有人答应，我会给你一个开始。

我的应用程序有一个 Rest Web 服务，下面是一个返回一个名为 SharepointRecommendation 的对象的方法（一个 C# 类，您可以让您的方法返回任何内容或 void）

```
 [WebGet(UriTemplate = "SharepointRecommendations?clientid={clientID}&userid={userID}&messageid={messageID}&maxsharepointlinks={countSharepointLinks}")]
        public SharepointRecommendation GetSharepointRecommendations(int clientID, int userID, int messageID, int countSharepointLinks)
        {
           .... 
```

根据我阅读的内容，该方法的 uri 不应包含动词 Get，但该方法应包含。

现在关于 Response.Redirect 我从来没有尝试过使用 Web 方法，但是如果它在你的方法中工作 Response.Redirect([address]?username=[UserName]&passsword=[Password]);

我认为 Web 方法可能必须是 void （不返回任何内容），以便请求通过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T13:09:50.157

我知道这不是一个明确的问题，但我确实在这里找到了答案：

[http://social.msdn.microsoft.com/Forums/en/wcf/thread/d6b02afd-47c9-4646-96ec-90d7f6d3a285](http://social.msdn.microsoft.com/Forums/en/wcf/thread/d6b02afd-47c9-4646-96ec-90d7f6d3a285)

我遇到的主要问题是从 Web 服务重定向到另一个位置。上述链接中问题的第一个答案完美无缺。

# code-formatting - 如果（右值 == 左值）

> ID：10252195
> 
> 赞同：6
> 
> 时间：2012-04-20T19:14:11.973
> 
> 标签：code-formatting

这只是出于好奇，我问...

当使用“IF”时，我在任何地方看到的 99% 的代码都将采用“If (RValue == LValue) ...”格式。例子：

```
If (variableABC == "Hello World") ... 
```

还有其他一些我看到相反的例子：

```
If ("Hello World" == variableABC) 
```

任何人都知道这是如何开始以及为什么完成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:16:32.750

这样做是因为 C 和 C++ 中的这个错误：

```
if (variableABC = "Hello World") ...
                ^
                (Watch here) 
```

这样我们就有了编译错误：

```
if ("Hello World" = variableABC)
                  ^
                  (Watch here) 
```

例如，C# 和 Java 语言不需要这个技巧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:16:37.790

后者是为了防止意外赋值，如果您错误地使用赋值运算符`=`而不是相等运算符`==`'

某些语言不允许在 if 条件中进行赋值，在这种情况下，两者都可以。

在接受 if 条件下赋值的语言中，我总是更喜欢后一种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:19:26.647

这样做是因为开发人员经常写 = 而不是 == 的错误。在 C++ 中，整数可以被视为布尔值，并且在编译时没有错误。

# c - Valgrind 报 SQLite 错误，为什么？

> ID：10252201
> 
> 赞同：2
> 
> 时间：2012-04-20T19:14:50.553
> 
> 标签：c, sqlite

Valgrind 报告 SQLite 错误：

```
==11614== 跳转到下一行所述的无效地址
==11614== 在 0x0: ???
==11614== 通过 0x6E8CF: sqlite3MallocSize (sqlite3.c:19034)
==11614== 由 0x6E472: mallocWithAlarm (sqlite3.c:18870)
==11614== 由 0x6E520: sqlite3Malloc (sqlite3.c:18895)
==11614== 由 0x6ED56: sqlite3MallocZero (sqlite3.c:19159)
==11614== 0x6DA46：pthreadMutexAlloc (sqlite3.c:18039)
==11614== 0x6D779: sqlite3MutexAlloc (sqlite3.c:17353)
==11614== by 0xFA4B7: sqlite3_initialize (sqlite3.c:112588)
==11614== by 0xFD895: openDatabase (sqlite3.c:114531)
==11614== 通过 0xFDF13: sqlite3_open (sqlite3.c:114780)
==11614== 0x579C1：SqlLiteConnection_Connect(char*) (SqlLite.cpp:14)
==11614== 地址 0x0 没有被堆栈、malloc 或（最近）释放

```

我将一个有效值传递给`sqlite3_open`. 任何人对为什么会发生这种情况有任何想法？

PS 我正在使用 SQLite Amalgamation 版本 3.7.11。我正在运行 Mac OSX 10.7.3。SQLite 是用`gcc -c -g -m32 sqlite3.c`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T16:11:22.470

我在 valgrind 3.7.0 中遇到了完全相同的问题。升级到 3.8.1 后，问题消失了。

# c# - 如何序列化接口类型成员

> ID：10252207
> 
> 赞同：9
> 
> 时间：2012-04-20T19:15:31.927
> 
> 标签：c#, .net, xml-serialization

我有一个具有定义为接口的属性的类。我的类的用户可以将任何实现该接口的类实现分配给该属性。我希望能够从磁盘上的文本文件加载此类状态。用户应该能够手动修改xml文件，以控制应用程序的运行。

如果我尝试序列化我的类，它会告诉我无法序列化接口。我知道序列化程序对属性类的结构一无所知，只知道它实现了一个接口。

我原以为它会在成员上调用 GetType，并反映到实际类的结构中。有没有办法做到这一点？还有其他方法可以实现我的要求吗？

**编辑**：澄清我的意图：假设我有这门课：

```
class Car
{
IEngine engine
}
class ElectricEngine : IEngine 
{
int batteryPrecentageLeft;
}
class InternalCombustionEngine : IEngine 
{
int gasLitersLeft;
} 
```

并且班级用户有一个班级

```
Car myCar = new Car();
myCar.Engine = new ElectricEngine() {batteryPrecentageLeft= 70}; 
```

当我序列化类 myCar 时，我希望 xml 类似于：

```
<Car>
<Engine>
<ElectricEngine>
<batteryPrecentageLeft>70</batteryPrecentageLeft>
</ElectricEngine>
<Engine>
</Car> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:24:45.010

您可以将该属性标记为不包含。

但是还有一个更深层次的问题：序列化只能捕获简单的“状态”，而不是行为。您的课程不是可序列化的。您希望该属性在反序列化后具有什么“价值”？`null`是唯一的选择。

正确的解决方法是考虑实际应该保存的内容并为该部分使用 DTO。

* * *

以下模型可以序列化：

```
public class BaseEngine { }

[XmlInclude(typeof(InternalCombustionEngine))]
[XmlInclude(typeof(ElectricEngine))]
public class Car
{      
    public BaseEngine Engine { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T19:23:58.980

也许您可以使用基类而不是接口并将其序列化。

**更新**

我意识到使用基类对你来说并不是一个真正的选择。

最好的解决方案可能是像 Henk Holterman 所说的那样使用 DTO 来解决问题。

但是，如果您真的想要解决您的问题，我认为您必须创建自己的自定义序列化程序，但我不建议您这样做，因为您最终会遇到很多错误需要解决。

这是自定义序列化程序的示例，请记住，此示例需要一些工作才能在实际应用程序中完全使用。

至少必须添加两件事才能使其不仅仅是一个示例：

1.  异常处理
2.  将 xml 元素值转换或转换为正确的类型`anyThingProperty.SetValue(obj, propertyElement.Value, null);`

```
[TestClass]
public class SerializableInterfaceTest
{
    [TestMethod]
    public void TestMethod1()
    {
        string serialize = AnyThingSerializer.Serialize(
            new SerializableClass {Name = "test", Description = "test1", 
                AnyThing = new Animal {Name = "test", Color = "test1"}});
        Console.WriteLine(serialize);
        object obj = AnyThingSerializer.Deserialize(serialize);
    }
}

public sealed class SerializableClass
{
    public string Name { get; set; }
    public string Description { get; set; }

    [AnyThingSerializer]
    public object AnyThing { get; set; }
}

public static class AnyThingSerializer
{
    public static string Serialize(object obj)
    {
        Type type = obj.GetType();
        var stringBuilder = new StringBuilder();
        var serializer = new XmlSerializer(type);
        serializer.Serialize(new StringWriter(stringBuilder), obj);
        XDocument doc = XDocument.Load(new StringReader(stringBuilder.ToString()));
        foreach (XElement xElement in SerializeAnyThing(obj))
        {
            doc.Descendants().First().Add(xElement);
        }
        return doc.ToString();
    }

    public static object Deserialize(string xml)
    {
        var serializer = new XmlSerializer(typeof (T));
        object obj = serializer.Deserialize(new StringReader(xml));
        XDocument doc = XDocument.Load(new StringReader(xml));
        DeserializeAnyThing(obj, doc.Descendants().OfType().First());
        return obj;
    }

    private static void DeserializeAnyThing(object obj, XElement element)
    {
        IEnumerable anyThingProperties = obj.GetType()
            .GetProperties().Where(p => p.GetCustomAttributes(true)
                .FirstOrDefault(a => a.GetType() == 
                    typeof (AnyThingSerializerAttribute)) != null);
        foreach (PropertyInfo anyThingProperty in anyThingProperties)
        {
            XElement propertyElement = element.Descendants().FirstOrDefault(e => 
                e.Name == anyThingProperty.Name && e.Attribute("type") != null);
            if (propertyElement == null) continue;
            Type type = Type.GetType(propertyElement.Attribute("type").Value);
            if (IsSimpleType(type))
            {
                anyThingProperty.SetValue(obj, propertyElement.Value, null);
            }
            else
            {
                object childObject = Activator.CreateInstance(type);
                DeserializeAnyThing(childObject, propertyElement);
                anyThingProperty.SetValue(obj, childObject, null);
            }
        }
    }

    private static List SerializeAnyThing(object obj)
    {
        var doc = new List();
        IEnumerable anyThingProperties = 
            obj.GetType().GetProperties().Where(p => 
                p.GetCustomAttributes(true).FirstOrDefault(a => 
                    a.GetType() == typeof (AnyThingSerializerAttribute)) != null);
        foreach (PropertyInfo anyThingProperty in anyThingProperties)
        {
            doc.Add(CreateXml(anyThingProperty.Name, 
                anyThingProperty.GetValue(obj, null)));
        }
        return doc;
    }

    private static XElement CreateXml(string name, object obj)
    {
        var xElement = new XElement(name);
        Type type = obj.GetType();
        xElement.Add(new XAttribute("type", type.AssemblyQualifiedName));
        foreach (PropertyInfo propertyInfo in type.GetProperties())
        {
            object value = propertyInfo.GetValue(obj, null);
            if (IsSimpleType(propertyInfo.PropertyType))
            {
                xElement.Add(new XElement(propertyInfo.Name, value.ToString()));
            }
            else
            {
                xElement.Add(CreateXml(propertyInfo.Name, value));
            }
        }
        return xElement;
    }

    private static bool IsSimpleType(Type type)
    {
        return type.IsPrimitive || type == typeof (string);
    }
}

public class AnyThingSerializerAttribute : XmlIgnoreAttribute
{
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T16:08:40.133

基于@Jens 解决方案，我创建了一个序列化程序来满足我的需要。谢谢珍。这是代码：

```
public class RuntimeXmlSerializerAttribute : XmlIgnoreAttribute { }

public class RuntimeXmlSerializer
{
    private Type m_type;
    private XmlSerializer m_regularXmlSerializer;

    private const string k_FullClassNameAttributeName = "FullAssemblyQualifiedTypeName";

    public RuntimeXmlSerializer(Type i_subjectType)
    {
        this.m_type = i_subjectType;
        this.m_regularXmlSerializer = new XmlSerializer(this.m_type);
    }

    public void Serialize(object i_objectToSerialize, Stream i_streamToSerializeTo)
    {
        StringWriter sw = new StringWriter();
        this.m_regularXmlSerializer.Serialize(sw, i_objectToSerialize);
        XDocument objectXml = XDocument.Parse(sw.ToString());
        sw.Dispose();
        SerializeExtra(i_objectToSerialize,objectXml);
        string res = objectXml.ToString();
        byte[] bytesToWrite = Encoding.UTF8.GetBytes(res);
        i_streamToSerializeTo.Write(bytesToWrite, 0, bytesToWrite.Length);
    }

    public object Deserialize(Stream i_streamToSerializeFrom)
    {
        string xmlContents = new StreamReader(i_streamToSerializeFrom).ReadToEnd();
        StringReader sr;
        sr = new StringReader(xmlContents);
        object res = this.m_regularXmlSerializer.Deserialize(sr);
        sr.Dispose();
        sr = new StringReader(xmlContents);
        XDocument doc = XDocument.Load(sr);
        sr.Dispose();
        deserializeExtra(res, doc);
        return res;
    }

    private void deserializeExtra(object i_desirializedObject, XDocument i_xmlToDeserializeFrom)
    {
        IEnumerable propertiesToDeserialize = i_desirializedObject.GetType()
            .GetProperties().Where(p => p.GetCustomAttributes(true)
                .FirstOrDefault(a => a.GetType() ==
                    typeof(RuntimeXmlSerializerAttribute)) != null);
        foreach (PropertyInfo prop in propertiesToDeserialize)
        {
            XElement propertyXml = i_xmlToDeserializeFrom.Descendants().FirstOrDefault(e =>
                e.Name == prop.Name);
            if (propertyXml == null) continue;
            XElement propertyValueXml = propertyXml.Descendants().FirstOrDefault();
            Type type = Type.GetType(propertyValueXml.Attribute(k_FullClassNameAttributeName).Value.ToString());
            XmlSerializer srl = new XmlSerializer(type);
            object deserializedObject = srl.Deserialize(propertyValueXml.CreateReader());
            prop.SetValue(i_desirializedObject, deserializedObject, null);
        }
    }

    private void SerializeExtra(object objectToSerialize, XDocument xmlToSerializeTo)
    {
        IEnumerable propertiesToSerialize =
            objectToSerialize.GetType().GetProperties().Where(p =>
                p.GetCustomAttributes(true).FirstOrDefault(a =>
                    a.GetType() == typeof(RuntimeXmlSerializerAttribute)) != null);
        foreach (PropertyInfo prop in propertiesToSerialize)
        {
            XElement serializedProperty = new XElement(prop.Name);
            serializedProperty.AddFirst(serializeObjectAtRuntime(prop.GetValue(objectToSerialize, null)));
            xmlToSerializeTo.Descendants().First().Add(serializedProperty); //TODO
        }
    }

    private XElement serializeObjectAtRuntime(object i_objectToSerialize)
    {
        Type t = i_objectToSerialize.GetType();
        XmlSerializer srl = new XmlSerializer(t);
        StringWriter sw = new StringWriter();
        srl.Serialize(sw, i_objectToSerialize);
        XElement res = XElement.Parse(sw.ToString());
        sw.Dispose();
        XAttribute fullClassNameAttribute = new XAttribute(k_FullClassNameAttributeName, t.AssemblyQualifiedName);
        res.Add(fullClassNameAttribute);

        return res;
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-03T10:43:13.487

您可以使用[ExtendedXmlSerializer](https://github.com/wojtpl2/ExtendedXmlSerializer)。如果您有课程：

```
public interface IEngine
{
    string Name {get;set;}
}

public class Car
{
    public IEngine Engine {get;set;}
}

public class ElectricEngine : IEngine 
{
    public string Name {get;set;}
    public int batteryPrecentageLeft {get;set;}
}

public class InternalCombustionEngine : IEngine 
{
    public string Name {get;set;}
    public int gasLitersLeft  {get;set;}
} 
```

并创建此类的实例：

```
Car myCar = new Car();
myCar.Engine = new ElectricEngine() {batteryPrecentageLeft= 70, Name = "turbo diesel"}; 
```

您可以使用 ExtendedXmlSerializer 序列化此对象：

```
ExtendedXmlSerializer serializer = new ExtendedXmlSerializer();
var xml = serializer.Serialize(myCar); 
```

输出 xml 将如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Car type="Program+Car">
    <Engine type="Program+ElectricEngine">
        <Name>turbo diesel</Name>
        <batteryPrecentageLeft>70</batteryPrecentageLeft>
    </Engine>
</Car> 
```

您可以从[nuget](https://www.nuget.org/packages/ExtendedXmlSerializer/)安装 ExtendedXmlSerializer或运行以下命令：

```
Install-Package ExtendedXmlSerializer 
```

这是[在线示例](https://dotnetfiddle.net/uWg8eu)

# jquery - 单击单独的 DIV 时需要 DIV 消失

> ID：10252208
> 
> 赞同：0
> 
> 时间：2012-04-20T19:15:41.913
> 
> 标签：jquery, html, slider, hide

我正在构建一个网站，其主页的顶部有一个 DIV（固定）。单击底部的导航链接时，幻灯片会激活从底部向上滑动的 jquery。（暂时原谅凌乱的内容）。我想要发生的是每当幻灯片被激活并出现时，顶部标题 DIV 就会消失。（然后在幻灯片下降时重新出现）。这可能吗？

代码很多，我直接[在这里链接](http://www.gp3designs.com/griffin)

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:19:00.143

```
$(document).ready(function(){
    $('#div1').click(function(){
        $('#div2').hide();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:20:08.867

在下面的 jquery 函数中，添加 $("#mast_head").hide()

```
$('#menu li a').click(function(e) {
   e.preventDefault();
   $("#mast_head").hide()
   animateSlider(this.hash);
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:17:26.257

```
<div id="div1"></div>
<div id="div2" onclick="$('#div1').hide()"></div> 
```

或者，而不是 onclick，只是做..

```
$('#div2').on('click', function(){($'#div1').hide();}); 
```

# algorithm - 矩阵中和最大的平方

> ID：10252209
> 
> 赞同：4
> 
> 时间：2012-04-20T19:15:48.303
> 
> 标签：algorithm

我认为我遇到了非常典型的问题。我知道这里有类似的主题，但知道我是初学者，不区分这个问题的不同版本。有时文本和算法的细微差别可能完全不同..所以问题是：

```
For a given 2<=a,b<=1000 and 1<=c<=Min(a,b) find in matrix a x b square c x c 
with the largest sum of elements. The elements in matrix are from -1000 to 1000. 
```

我可以编写一个算法来运行整个矩阵，并在每个点 (x,y) 上计算平方 (x,y)、(x+c,y)、(x,y+c)、(x+) 的总和c,y+c)。然后我选择了最大的金额。有了这些限制，我认为它可能会很快，但是有更快的算法吗？我不擅长计算算法复杂度，但它似乎是 O(a*b*c*c)。如果我在最坏的情况下没有错，它可能不会停止..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T19:34:24.427

我相信解决这个问题的正确方法是首先进行积分变换：对于原始矩阵 M 的每个元素 (i,j)，计算积分变换矩阵`I(i,j) = sum[0..i, 0..j](M)`。通过在行和列方向上运行总和，您可以在 O(a*b) 时间内完成此操作。

完成积分变换后，您可以在恒定时间内计算*任何子块的总和：*

```
sum[i0..i1, j0..j1](M) = I(i1,j1) - I(i0 - 1, j1) - I(i1, j0 - 1) + I(i0 - 1, j0 - 1) 
```

因此您可以在恒定时间内计算和比较每个 cxc 平方和，总共为 O(a*b)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:31:44.040

您的解决方案将起作用，并且您对时间复杂度的看法是正确的，实际上它是 a*b*c*c。加快一点速度的一种方法是，当您滑动 c*c 窗口时，您不会重新计算所有内容，而只需减去移出窗口的部分，并将移入的部分添加到窗户。由于您可以在方向 x 和方向 y 上执行此操作，因此您可能希望记住一列（或一行）中所有 c*c 平方的总和以供将来查找。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:49:01.437

我认为使用此处提到的滑动方法可以降低您的复杂性。因此，假设在您的情况下， a,b,c 在每个优化问题中都是恒定的（意味着 c 不是优化变量）。

1）从左上角开始，O(c*c)

2) 去掉最左边一列，添加最右边一列后向右滑动O(c)

3) 重复 (2) 次 (ac) 次，所以 O(c*(ac))

4) (1)-(3) 成本约为 O(c*c + c*(ac))

5）您还需要向下滑动并为其他（bc）行执行此操作，每行花费O（c）向下滑动并且O（c * a）完成一行，总共是O（c * c + c*(ac) *(bc) + c* (ac) + c*(bc) )

6) 假设a,b>>c，它可以简化为O(b*c*a)

让我知道是否有任何问题！

# javascript - XMLHttpRequest 未正确加载页面

> ID：10252210
> 
> 赞同：2
> 
> 时间：2012-04-20T19:15:49.147
> 
> 标签：javascript, xmlhttprequest

我偶然发现了 XMLHttpRequest 的一个奇怪行为。也许我只是不太了解它的可能性或 Javascript 页面的加载方式，所以有人可以确认我的问题吗？

当我将纯 Javascript 放入通过 XMLHttpRequest 对象读入的文件中时，就好像它被完全忽略了。例如。我有文件 ajax_include.html，其中包含以下几行

```
<script type="text/javascript" language="javascript">
    alert('some alert');
</script> 
```

我还尝试使用外部 javascript 文件。

当我直接浏览文件时，警报按预期弹出，但是当我使用简单的 XMLHttpRequest 将 div 的内容替换为该页面的内容时，警报没有弹出。

有人可以确认这种奇怪的行为吗？或者使用 XMLHttpRequest 对象是否正常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T19:17:25.997

这与 XMLHttpRequest 无关。`<script>`添加到页面的元素`innerHTML`不会被执行。

有关解决方法，请参阅[使用 .innerHTML 插入的执行元素](https://stackoverflow.com/questions/2592092/executing-script-elements-inserted-with-innerhtml)。

# javascript - 我决定不支持IE7；我现在可以使用哪些 JS/CSS/HTML 功能？

> ID：10252212
> 
> 赞同：2
> 
> 时间：2012-04-20T19:16:12.893
> 
> 标签：javascript, html, css, internet-explorer-8, internet-explorer-7

{想法来自[我决定不迎合 IE6 - 我可以使用哪些美味的 CSS 款待？](https://stackoverflow.com/questions/4450853/ive-decided-not-to-cater-for-ie6-what-tasty-css-treats-can-i-use)但我想要一个 IE7 版本}

好的，首先，这不是关于我是否应该为 IE7 提供服务的讨论。我敢肯定 SO 上有数百个线程，您可以在其中讨论优点、缺点、市场份额、javascript shivs 以及它附带的所有其他内容。

> 假设我已经将两个手指放在 IE7 上，而忽略了它的存在 -
> 
> 我现在可以在制作页面的方式上做些什么不同的事情？
> 
> 伪选择器？
> 
> 父/子选择器？
> 
> 硬件加速土豆计数？
> 
> 其他整洁的东西？

**放弃 IE7 会带来哪些新的自由？**

*我知道你们中的一些人会很想告诉我为什么我应该支持 ie7 或关于 js 修复，这意味着我可以使用某些东西等等 - 请不要浪费你/我/我们的时间！*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T20:49:08.757

Internet Explorer 8 被微软吹捧为[完全](https://blogs.msdn.com/b/ie/archive/2009/03/19/internet-explorer-8-final-available-now.aspx)兼容 CSS2.1。但是，已经发现了一些错误，因此它实际上并不*完全*兼容，但这当然并不意味着它没有从版本 7 开始变得更好。

无论如何，以下是 IE7 中没有的一些引入到 IE8 的众所周知的功能（*此列表绝不是详尽的*）：

## JavaScript

*   [Selectors API level 1](http://www.w3.org/TR/selectors-api) ( `querySelectorAll()`)的基本实现
*   [跨域资源共享](http://www.w3.org/TR/cors)（跨域ajax）的基本实现
*   原生 JSON 解析能力
*   DOM 改进（修复 CSS 属性选择器的可能原因 - 见下文）

### HTML5 中的 JS API

*   [跨文档消息传递](http://dev.w3.org/html5/postmsg/#web-messaging)
*   [网络存储](http://dev.w3.org/html5/webstorage)
*   [历史遍历](http://www.w3.org/TR/html5/history.html#history-traversal)

## CSS

### CSS2.1

*   IE8 已经赶上了所有（大多数？）添加到 CSS1 属性的 CSS2.1 增强功能，您可以[在 MSDN中找到一个列表](http://msdn.microsoft.com/en-us/library/cc304082.aspx)
*   修复了盒子模型关于[折叠边距](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)、[浮动](http://www.w3.org/TR/CSS21/visuren.html#floats)和[堆叠的问题](http://www.w3.org/TR/CSS21/visuren.html#z-index)
*   [`inherit`关键词](http://www.w3.org/TR/CSS21/cascade.html#value-def-inherit)
*   [`outline`财产](http://www.w3.org/TR/CSS21/ui.html#dynamic-outlines)
*   [`white-space`财产](http://www.w3.org/TR/CSS21/text.html#white-space-prop)`pre-wrap`和_`pre-line`
*   完全支持`display: inline-block`任何元素
*   [`display: table`](http://www.w3.org/TR/CSS21/tables.html)
*   [生成的内容和自动编号](http://www.w3.org/TR/CSS21/generate.html)：`:before`和`:after`伪元素，以及`quotes`，`content`，`attr()`函数和 CSS 计数器
*   [打印和分页媒体](http://www.w3.org/TR/CSS21/page.html)：该`@page`规则现在适用于页面伪类、印刷`orphans`和`widows`分页符，并且在一定程度上支持分页符
*   [`:active`和`:focus`伪类](http://www.w3.org/TR/selectors/#the-user-action-pseudo-classes-hover-act)
*   [`:lang()`伪类](http://www.w3.org/TR/selectors/#lang-pseudo)
*   在 IE7中影响同级组合器 CSS2.1`+`和 CSS3 的晦涩语法问题`~`已在 IE8 中得到纠正（该`* + html`hack 也不再有效）
*   仅影响相邻兄弟组合器的 DOM 更新的晦涩错误`+`已在 IE8 中得到纠正
*   IE7 中影响 CSS2.1 和 CSS3 属性选择器的 HTML 属性和 DOM 属性问题已在 IE8 中得到纠正
*   一些与特异性相关的晦涩错误已得到纠正；[一个例子是我在这个答案](https://stackoverflow.com/a/9367665/106224)的 IE6/7 中确定的各种[动态伪类](http://www.w3.org/TR/selectors/#dynamic-pseudos)

### CSS3

*   [`box-sizing`](http://www.w3.org/TR/css3-ui/#box-sizing)CSS3 中的[属性](http://www.w3.org/TR/css3-ui/#box-sizing)`content-box`for and `border-box`(`padding-box`最初[是 Mozilla 的提议](https://developer.mozilla.org/en/CSS/box-sizing)，因此它在 IE 中不存在；直到最近它才被添加到 CSS3 UI 规范中，并且在 2012 年 1 月的 Last Call Working Draft 中仍有被删除的风险)
*   一些 CSS3 特性已经存在于 IE 中，并且早在它们被重新整合到各自的规范中之前就由 Microsoft 提出，包括`@font-face`, `overflow-x`/ `overflow-y`, `text-align-last`, `word-wrap`(now `overflow-wrap`) 和 ruby​​ text

## HTML

*   [`<abbr>`](http://www.w3.org/TR/html401/struct/text.html#edef-ABBR)和[`<q>`](http://www.w3.org/TR/html401/struct/text.html#edef-Q)
*   [`<object>`后备](http://www.w3.org/TR/html401/struct/objects.html#edef-OBJECT)

## 各种各样的

*   [对数据 URI](https://en.wikipedia.org/wiki/Data_URI_scheme)的有限支持
*   [可访问性的WAI-ARIA](http://www.w3.org/TR/wai-aria)合规性

当然，还有一些来源：

*   [IE8的发布公告](https://blogs.msdn.com/b/ie/archive/2009/03/19/internet-explorer-8-final-available-now.aspx)
*   [CSS 兼容性和 Internet Explorer](http://msdn.microsoft.com/en-us/library/cc351024.aspx)
*   [Internet Explorer 8 中的 CSS 改进](http://msdn.microsoft.com/en-us/library/cc304082.aspx)
*   [QuirksMode CSS 兼容性表](http://quirksmode.org/css/contents.html)
*   [caniuse.com上IE7和IE8的功能支持比较](http://caniuse.com/#compare=y&b1=ie+7&b2=ie+8)

# java - 如何避免在 LinearLayout 上重叠按钮？

> ID：10252220
> 
> 赞同：0
> 
> 时间：2012-04-20T19:17:11.400
> 
> 标签：java, android, android-linearlayout

我知道如何使用预定义的 XML 创建自定义对话框。

我想动态创建一个带有 LinearLayout 和按钮的对话框。

我尝试了下面的代码，但似乎我的按钮重叠了。我该如何防止这种情况？

```
public void createMenu(MenuItem item){

    Dialog menuDiag = new Dialog(Home.this);
    menuDiag.setTitle("Browse");    
    LinearLayout linearLayout = new LinearLayout(menuDiag.getContext());
    LinearLayout.LayoutParams  params;

    Button button;

    categoryList = parse.getPlayList(); 

    for(int i=0;i<categoryList.size();i++){     
        params = new LinearLayout.LayoutParams(
                LinearLayout.LayoutParams.WRAP_CONTENT,
                LinearLayout.LayoutParams.WRAP_CONTENT);

        button =  new Button(menuDiag.getContext());
        button.setText(categoryList.get(i).getTitle());
        button.setBackgroundResource(iconCheck(categoryList.get(i).getTitle()));
        button.setLayoutParams(params);

        menuDiag.addContentView(button, params);

    }

    params = new LinearLayout.LayoutParams(
            LinearLayout.LayoutParams.WRAP_CONTENT,
            LinearLayout.LayoutParams.WRAP_CONTENT);

    menuDiag.addContentView(linearLayout, params);
    menuDiag.show();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:48:01.017

尝试将您的方向设置`LinearLayout`为垂直，这样它将自动放置在第一个下方`View`

如果您正在使用，请`LinearLayout`使用

`yourLayout.setOrientation(LinearLayout.VERTICAL);`

设置方向

# android - 使用 TableLayout 将视图放置在屏幕/布局的底部

> ID：10252229
> 
> 赞同：0
> 
> 时间：2012-04-20T19:17:49.680
> 
> 标签：android, android-layout, android-xml, gravity, android-layout-weight

我试图在屏幕底部放置一个带有两个按钮的 TableRow，在布局中的其他视图元素下，但如果我放在那里，TableRow 就会从屏幕上消失。II 放在顶部或中间，没问题。

我尝试了很多 layout_gravity、gravity 和 weight 组合，但我无法得到它。

[![布局截图](../Images/17e38c9db05997abd12bf83b881f0d7a.png)](https://i.stack.imgur.com/gnUsO.png)

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<TextView  
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:textAppearance="?android:attr/textAppearanceMedium" 
    android:gravity="center_horizontal" 
    android:text="@string/traza" 
    android:layout_margin="10sp"/>

    <TableRow
        android:id="@+id/tableRow8"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_margin="3sp"
        android:gravity="center"
        android:weightSum="2" >

        <Button
            android:id="@+id/reiniciar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:layout_margin="5sp"
            android:background="@drawable/bordebutton"
            android:text="@string/reiniciar" />

        <Button
            android:id="@+id/comprobar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:layout_margin="5sp"
            android:background="@drawable/bordebutton"
            android:text="@string/comprobar" />

    </TableRow>

<android.gesture.GestureOverlayView
    android:id="@+id/gestures"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:fadeEnabled="true"
    android:fadeOffset="3000"
    android:gestureStrokeType="multiple"
    android:eventsInterceptionEnabled="true"
    android:orientation="vertical"/>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:26:19.620

您需要使用**RelativeLayout**来实现这一点。

你去：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_margin="10sp"
        android:gravity="center_horizontal"
        android:text="@string/traza"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TableRow
        android:id="@+id/tableRow8"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_margin="3sp"
        android:gravity="center"
        android:weightSum="2"
        android:layout_alignParentBottom="true" >

        <Button
            android:id="@+id/reiniciar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_margin="5sp"
            android:layout_weight="1"
            android:background="@drawable/bordebutton"
            android:text="@string/reiniciar" />

        <Button
            android:id="@+id/comprobar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_margin="5sp"
            android:layout_weight="1"
            android:background="@drawable/bordebutton"
            android:text="@string/comprobar" />
    </TableRow>

    <android.gesture.GestureOverlayView
        android:id="@+id/gestures"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:eventsInterceptionEnabled="true"
        android:fadeEnabled="true"
        android:fadeOffset="3000"
        android:gestureStrokeType="multiple"
        android:orientation="vertical" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:24:31.580

**编辑：**`TableLayout`如果您想使用包含的功能， 您的根元素应该是`View`. 您目前将其作为`LinearLayout`.

我没有看到任何提及如何在[文档](http://developer.android.com/reference/android/widget/TableLayout.html)`TableRow`中垂直放置非视图。

根据我的经验，a`TableLayout`总是将东西放在最后一行的正下方。

是否尝试过使用`RelativeLayout`, 或`LinearLayout`完成您需要的工作？它比 a 灵活得多`TableLayout`。

您也可以关闭`TableLayout`并在其下方放置一个`LinearLayout`。

# delphi - 检查是否在 ListBox 中选择了一个项目

> ID：10252230
> 
> 赞同：8
> 
> 时间：2012-04-20T19:17:58.360
> 
> 标签：delphi, listbox

我想检查当用户单击标签时是否在 ListBox 中选择了一个项目，
如果我像这样执行我得到了这个错误`list index out of bounds`

```
procedure TfrMain.Label15Click(Sender: TObject);
var
 saveDialog : TSaveDialog;
 FileContents: TStringStream;
 saveLine,Selected : String;
begin
 saveDialog := TSaveDialog.Create(self);
 saveDialog.Title := 'Save your text or word file';
 saveDialog.InitialDir := GetCurrentDir;
 saveDialog.Filter := 'text file|*.txt';
 saveDialog.DefaultExt := 'txt';
 saveDialog.FilterIndex := 1;

 Selected := ListBox1.Items.Strings[ListBox1.ItemIndex]; 

 if Selected <> '' then
 begin
  if saveDialog.Execute then
  begin
   FileContents := TStringStream.Create('', TEncoding.UTF8);
   FileContents.LoadFromFile(ListBox1.Items.Strings[ListBox1.ItemIndex]);
   FileContents.SaveToFile(saveDialog.Filename);
   ShowMessage('File : '+saveDialog.FileName)
  end
 else ShowMessage('Save file was not succesful');
  saveDialog.Free;
 end;
end; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T19:22:45.217

这段代码

```
if Selected then 
```

不会编译，因为`Selected`它是一个字符串。我猜你在发布之前正在尝试。

同样，您的错误消息和问题标题表明 `ListBox1.ItemIndex` 等于-1。因此列表索引越界错误。

在从列表框中读取之前，您需要添加一个`ListBox1.ItemIndex`不是 -1 的检查。`ItemIndex=-1`是您检测到未选择任何项目的方式。因此，您的代码应如下所示：

```
.....
saveDialog.DefaultExt := 'txt';  
saveDialog.FilterIndex := 1; 
if ListBox1.ItemIndex <> -1 then
begin
..... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:20:21.070

如果在列表框中未选择任何内容，则会发生这种情况。

尝试使用：

```
procedure TfrMain.Label15Click(Sender: TObject);
var
 saveDialog : TSaveDialog;
 FileContents: TStringStream;
 saveLine,Selected : String;
begin
 saveDialog := TSaveDialog.Create(self);
 saveDialog.Title := 'Save your text or word file';
 saveDialog.InitialDir := GetCurrentDir;
 saveDialog.Filter := 'text file|*.txt';
 saveDialog.DefaultExt := 'txt';
 saveDialog.FilterIndex := 1;

 if ListBox1.ItemIndex >= 0 then
 begin
  Selected := ListBox1.Items.Strings[ListBox1.ItemIndex]
  if saveDialog.Execute then
  begin
   FileContents := TStringStream.Create('', TEncoding.UTF8);
   FileContents.LoadFromFile(Selected);
   FileContents.SaveToFile(saveDialog.Filename);
   ShowMessage('File : '+saveDialog.FileName)
  end
 else ShowMessage('Save file was not succesful');
  saveDialog.Free;
 end;
end; 
```

# android - 在android中读取你自己的应用程序文件？

> ID：10252233
> 
> 赞同：0
> 
> 时间：2012-04-20T19:18:08.277
> 
> 标签：android, android-ndk

我想从代码中读取我自己的 android 应用程序文件。我的意思是假设我的文件名为 abc.apk，它已安装在手机上。现在通过同一个应用程序 (abc.apk)，我想逐字节读取 abc.apk 文件。是否可以通过代码。

编辑：我正在编辑问题以供进一步使用。如何通过本机代码获取我的 android 应用程序的当前文件名。

谢谢，切坦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:41:01.433

有可能的。这是执行此操作的示例项目：http: [//dl.dropbox.com/u/1923577/android_native_read_apk.7z](http://dl.dropbox.com/u/1923577/android_native_read_apk.7z)

它包括所有源代码（java nad C++）。如果您从 bin 文件夹安装 apk 文件并在设备上运行，它将打印到 android 日志“D/TEST (18107): First 4 bytes = 50 4b 03 04”。这正是 apk 文件的前 4 个字节（使用 hexeditor 检查）。我在非根设备上运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:35:33.617

我认为这在库存设备上是不可能的。data/app/ 目录没有root不能直接访问。

# actionscript-3 - 有什么方法可以拦截 AS3 中的类型化函数调用？

> ID：10252235
> 
> 赞同：3
> 
> 时间：2012-04-20T19:18:17.333
> 
> 标签：actionscript-3, proxy, decorator

我知道使用动态添加到动态代理类的函数很容易，但我也希望能够拦截对类型函数的调用，就像 Python 中的装饰器一样。下面的例子。我希望能够通过'typedFunc'的'callProperty'就像它已经通过'dynFunc'一样，

![例子](../Images/4697b10245b2f83c34a808ed56395d97.png)

```
package
{
    import flash.display.Sprite;
    [SWF(width = '400', height = '400')]
    public class Test extends Sprite
    {
        public function Test()
        {
            var t:TypeTest = new TypeTest();
            t.dynFunc = function dynFunc(s:String, i:int):Boolean { return true; };

            t.typedFunc("a", 1);
            t.dynFunc("b", 2);
        }
    }
}
import flash.utils.Proxy;
import flash.utils.flash_proxy;

internal dynamic class TypeTest extends Proxy
{
    private var customs:Object = new Object();
    override flash_proxy function callProperty(name:*, ...parameters):* {
        var retval:* = (this[name] as Function).apply(null, parameters);
        trace("called", name, "with", parameters);
        return retval;
    }
    public function typedFunc(s:String, i:int):Boolean {
        return false;
    }
    override flash_proxy function getProperty(name:*):* { return customs[name]; }
    override flash_proxy function setProperty(name:*, value:*):void { customs[name] = value; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:22:41.907

这在 ActionScript 中并不容易做到，因为编译器不允许您在运行时使用“常规”ActionScript 语言结构更改密封类的方法 - 因此您将无法更改原始类的行为。时期。

幸运的是，有[as3commons:bytecode](http://www.as3commons.org/as3-commons-bytecode/emit.html)库。您可以使用它在运行时生成动态代理类：它生成该类的字节数组表示并将其加载到 AVM 中，因此您可以像使用任何其他类一样使用它。甚至可以将原始类用作蓝图并将其替换为修改后的版本，但我不得不承认我没有尝试过。

# google-maps - 将 Google Maps API v3 链接粘贴到电子邮件中

> ID：10252236
> 
> 赞同：2
> 
> 时间：2012-04-20T19:18:20.483
> 
> 标签：google-maps, google-maps-api-3

您好我有以下使用 Google Maps API 版本 3 的网页。是否可以创建一个按钮或右键单击地图并将链接发送给类似于 Google Maps“链接”按钮的人，该按钮允许您“粘贴链接在电子邮件或即时消息中”的放大级别和您正在查看的范围？我已经搜索过这个但找不到任何东西。谢谢！

[https://netfiles.uiuc.edu/alouchio/shared/ztest.shtml](https://netfiles.uiuc.edu/alouchio/shared/ztest.shtml)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:06:09.040

没有什么开箱即用的东西可以让你做到这一点，但你自己实现它应该不难。首先，您需要为可用于导航到特定位置的页面定义一些查询字符串参数。要设置正确的位置和缩放级别，您需要三个参数：纬度、经度和缩放，因此您的网址可能类似于：

```
https://netfiles.uiuc.edu/alouchio/shared/ztest.shtml?lat=40.300842&lng=-86.864734&z=6 
```

然后，当您初始化地图时，您将需要检查这些参数是否存在，如果存在，请适当定位地图：

要读取查询字符串，我们需要一个函数来处理该部分，这是一个简单的函数：

```
// A function to get the qs params, borrowed from http://jquery-howto.blogspot.com/2009/09/get-url-parameters-values-with-jquery.html
function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
} 
```

然后您可以检查是否存在正确的查询字符串参数，应该在初始化地图后调用...

```
var params = getUrlVars();   

if (params["lat"] &&  params["lng"] && params["z"])    
{        
    map.setCenter(new GLatLng(parseFloat(params["lat"]), 
        parseFloat(params["lng"]), parseInt(params["z"]));
} 
```

最后，要生成链接，可以创建一个按钮来生成链接信息：

```
function showLink()
{   
    var ctr = map.getCenter();
    alert("https://netfiles.uiuc.edu/alouchio/shared/ztest.shtml?lat=" 
+ ctr.lat().toString() + "&lng=" + ctr.lng().toString() + "&z=" + map.getZoom().toString());
} 
```

而不是 map.setCenter 我使用：

```
var myOptions1 = {
  zoom: parseInt(params["z"]),
  center: new google.maps.LatLng(parseFloat(params["lat"]), parseFloat(params["lng"])), 
```

# vbscript - 有没有办法让 MessageBox 在设定的时间间隔后自动关闭？

> ID：10252237
> 
> 赞同：3
> 
> 时间：2012-04-20T19:18:23.050
> 
> 标签：vbscript

我有一个 VBScript 来提醒带有 MessageBox 的事件，但我希望它在 5 秒左右后自动关闭。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-21T00:54:06.660

使用 WshShell 对象的 Popup 方法。它有一个超时参数。

```
intTimeout = 10      'Number of seconds to wait
strMessage = "This is my message box!"
strTitle = "Hello, world!"

Set WshShell = CreateObject("WScript.Shell")
intResult = WshShell.Popup(strMessage, intTimeout, strTitle) 
```

~~有关更多信息，请查看我的文章[Mastering the MessageBox](http://www.aspfree.com/c/a/VB.NET/Mastering-the-Message-Box/) on ASP Free。~~（[存档](https://web.archive.org/web/20161003120820/http://www.aspfree.com/c/a/VB.NET/Mastering-the-Message-Box/)）

# python - @csrf_exempt 在 Django 1.4 中停止工作

> ID：10252238
> 
> 赞同：16
> 
> 时间：2012-04-20T19:18:24.407
> 
> 标签：python, django, csrf, django-csrf

我有以下代码，在 Django 1.2.5 中运行良好：

```
from django.views.decorators.csrf import csrf_exempt

class ApiView(object):
    def __call__(self, request, *args, **kwargs):
        method = request.method.upper()
        return getattr(self, method)(request, *args, **kwargs)

@csrf_exempt
class MyView(ApiView):

    def POST(self):
       # (...)
       return HttpResponse(json.dumps(True), mimetype="text/javascript") 
```

但是当我升级到 Django 1.4 时，我开始收到 403 禁止，并显示“CSRF 验证失败”消息。

为什么 @csrf_exempt 装饰器不起作用？

网址定义为：

```
from django.conf.urls.defaults import *
from django.views.decorators.csrf import csrf_exempt

import views

urlpatterns = patterns('',
   url(r'^myview/(?P<parameter_name>[A-Za-z0-9-_]+)/$',
       views.MyView(),
       name="myproject-myapp-myview",
       ),
) 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-20T19:39:29.030

根据[django 文档](https://docs.djangoproject.com/en/dev/topics/class-based-views/#decorating-the-class)：

> 要装饰基于类的视图的每个实例，您需要装饰类定义本身。为此，您将装饰器应用于类的 dispatch() 方法。

因此，您需要执行以下操作：

```
class MyView(ApiView):

    def POST(self):
       # (...)
       return HttpResponse(json.dumps(True), mimetype="text/javascript")

    @csrf_exempt
    def dispatch(self, *args, **kwargs):
        return super(MyView, self).dispatch(*args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-04-13T18:33:12.807

只需`csrf_exempt`在`urls.py`. IE：：

## 网址.py

```
..other imports...
from django.views.decorators.csrf import csrf_exempt   
from myapp.views import MyView

urlpatterns = patterns('',
   url(r'^myview/(?P<parameter_name>[A-Za-z0-9-_]+)/$',
       csrf_exempt(MyView.as_view()), # use csrf_exempt here
       name="myproject-myapp-myview",
       ),
) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T20:12:00.507

csrf_exempt 必须装饰一个函数。在您的网址中，您可以装饰该功能，[可以在此处找到文档](https://docs.djangoproject.com/en/dev/topics/class-based-views/intro/#decorating-in-urlconf)。

```
(r'^vote/', permission_required('polls.can_vote')(VoteView.as_view())), 
```

# entity-framework - EF4.3 模型映射到 2 个数据库表

> ID：10252240
> 
> 赞同：1
> 
> 时间：2012-04-20T19:18:30.367
> 
> 标签：entity-framework

我正在尝试映射一个模型，该模型具有来自两个不同数据库表的项目。我有两个表（aspnet_Users && aspnet_Membership）。我想制作一个包含两者字段的模型。我的问题是设置它。

似乎我需要在我的 DbContext 中添加我的“OnModelCreating”覆盖，但无法弄清楚需要去哪里。

这是我的模型：

```
 [Table("aspnet_Users")]
 public class ApplicationUser : Base, IApplicationUser
 {
        [Key]
        public Guid UserId { get; set; }
        public string UserName { get; set; }
        public DateTime LastActivityDate { get; set; }

        public ApplicationUser_Details UserDetails { get; set;}
 }

 [Table("aspnet_Membership")]
 public class ApplicationUser_Details : Base
 {
    [Key]
    public Guid UserId { get; set; }
    public string Email { get; set; }
 } 
```

我正在尝试遵循 Scott Gu 网站上的指南（http://weblogs.asp.net/scottgu/archive/2010/07/23/entity-framework-4-code-first-custom-database-schema-mapping .aspx - 第 3 节），但如果 EF4.3，我无法让它工作。

我正在尝试做的事情似乎很简单，但出于某种原因，很难找到关于如何实施的好的文档。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:42:33.317

首先，您可能不应该直接访问 asp.net 表。如果可以，请使用内置提供程序。

其次，我发现从长远来看，保持实体与表结构完全相同会简单得多。如果您需要在应用程序中以不同方式表示数据，请创建一个特定于应用程序的模型。您可以使用[AutoMapper](http://automapper.org)帮助从实体映射到模型。

> **什么是 AutoMapper？**
> 
> AutoMapper 是一个简单的小库，旨在解决一个看似复杂的问题——摆脱将一个对象映射到另一个对象的代码。这种类型的代码写起来相当枯燥乏味，那么为什么不发明一个工具来为我们做呢？
> 
> **我该如何开始？**
> 
> 查看[入门指南](https://github.com/AutoMapper/AutoMapper/wiki/Getting-started)。完成后，[wiki](https://github.com/AutoMapper/AutoMapper/wiki/Getting-started) 会详细介绍细节。最后，查看[dnrTV 剧集](http://www.dnrtv.com/default.aspx?showNum=155)以获得完整的演练。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:55:09.660

您不需要在 EF 4.3 中自己进行任何外部实体映射。只需确保连接实体的两侧都有相互对应的引用。方程。类别实体具有食品实体集合的属性，每个食品实体都具有单个类别的属性。也不需要指定表名。在您基于 Category - Food 示例设置关系后，不要忘记，您还需要处理来自添加和删除等操作的双方的关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T22:33:20.490

如果您想映射到现有的成员资格表（如果我很好地理解您想要什么），您可以做这样的事情......
（注意：我有点无视“基础”类，因为我看不到目的为此，您可以拥有一个基类，但它会使事情变得有点复杂，所以这不是“涵盖”。也不确定“包含两者的字段”是什么意思，这会将 2 个表映射到 2 个类，正如您所布置的)

```
[Table("aspnet_Users")]
public class ApplicationUser // : Base, IApplicationUser
{
    //[Key]
    //[DatabaseGenerated(System.ComponentModel.DataAnnotations.DatabaseGeneratedOption.Computed)]
    public Guid UserId { get; set; }
    public string UserName { get; set; }
    public DateTime LastActivityDate { get; set; }
    public ApplicationUser_Details UserDetails { get; set; }
}

[Table("aspnet_Membership")]
public class ApplicationUser_Details // : Base
{
    //[Key]
    public Guid UserId { get; set; }
    public string Email { get; set; }
    public ApplicationUser User { get; set; }
} 
```

...在你的`OnModelCreating()`...

```
modelBuilder.Entity<ApplicationUser>()
    .HasKey(x => new { x.UserId });

//modelBuilder.Entity<ApplicationUser>()
//    .Property(x => x.UserId)
//    .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Computed);

modelBuilder.Entity<ApplicationUser_Details>()
    .HasKey(x => new { x.UserId });

modelBuilder.Entity<ApplicationUser_Details>()
    .HasRequired(i => i.User)
    .WithRequiredDependent(i => i.UserDetails); 
```

...这应该创建正确的关系（1 对 1），FK 也是 PK（关于细节）。

不过，如果您只想在 MVC 或类似中使用会员表 - 这可能更容易......
[http://codefirstmembership.codeplex.com/](http://codefirstmembership.codeplex.com/)

希望这可以帮助，

# javascript - 如何控制 amplify.request 缓存：持久选项

> ID：10252243
> 
> 赞同：0
> 
> 时间：2012-04-20T19:18:37.560
> 
> 标签：javascript, jquery, amplifyjs

使用[amplify.request](http://amplifyjs.com/api/request/)时，我想使用[amplify.store](http://amplifyjs.com/api/store/)来保存每次调用的结果。我知道我可以用这段代码做到这一点：

```
amplify.request.define( "ajaxExample2", "ajax", {
  url: "/myApiUrl",
  dataType: "json",
  type: "GET",
  cache: "persist"
}); 
```

但是，我希望能够将此结果添加到使用 amplify.store 存储的另一个变量中，但前提是数据来自服务器而不是来自缓存。

例如，我将对 进行初始调用`amplify.request("ajaxExample2"...`，然后通过 将结果保存到另一个变量`amplify.store`。然后，下次我调用 时`amplify.request("ajaxExample2"...`，如果数据来自服务器，我想覆盖我的局部变量 - 如果不是，我想不理会它。

所以，我想要一种方法来知道请求是否进行了服务器调用，如果是，则调用一个函数。有没有办法通过放大来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T06:25:05.717

@swatkins 在调用服务之前，您可以检查存储是否有数据，如果数据在存储（缓存）中可用，则无需调用服务，否则调用服务。

例如：

```
 var cachedData = amplify.store("anyKey");
    if (typeof cachedData === 'undefined' || cachedData.length == 0) {

        amplify.request.define("ajaxExample2", "ajax", {
            url: "/myApiUrl",
            dataType: "json",
            type: "GET",
            cache: "persist"
        });

amplify.request("ajaxExample2", 
                 function( data ) {     
                   cachedData = data.d;
                   amplify.store("anyKey", data)
                });
 } 
```

# java - Android：异步填充后从数据库加载列表视图

> ID：10252245
> 
> 赞同：0
> 
> 时间：2012-04-20T19:18:41.710
> 
> 标签：java, android, listview, asynchronous

我试图在从 Web 加载信息时显示进度对话框，该信息填充了创建 Listview 的 sqlite 数据库。我创建了一个异步类，它在下载信息时显示进度对话框，但之后列表视图为空。这可能是因为列表视图在异步之前已经加载。那么如何重新加载列表视图或以正确的方式执行此操作？这是我到目前为止所拥有的（因为它太长而无法显示，所以省略了后台处理）：

```
private class DownloadInfo extends AsyncTask <Void, Void, Void>{
    //////////////////Open Dialog before execution ///////////
private ProgressDialog dialog;
    protected void onPreExecute(){
        dialog = new ProgressDialog(CandidatesList.this);
        dialog.setMessage("Loading Candidates from Webserver");
        dialog.setIndeterminate(true);
        dialog.setCancelable(false);
        dialog.show();
    }
    ///////////////Background Processing//////////////////
    @Override
    protected Void doInBackground(Void... dbArray) {
    ////Load information from webserver and put it in sqlite///
        return null;

    }

    ///////After the processing is done //////////////
    protected void onPostExecute(Void unused) {
        dialog.dismiss();
    }

} 
```

而on create如下：

```
DownloadInfo task = new DownloadInfo();
    task.execute();
Cursor c = db.getAllCandidates();
    candidates = new String[c.getCount()];
    if (c.moveToFirst()) {
        int i = 0;
        do {
            candidates[i] = c.getString(1);// insert Name into candidate
                                            // Array
            i++;
        } while (c.moveToNext());
    }
    setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item,
            candidates)); 
```

请帮忙，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:27:53.407

如果要将游标信息从数据库自动加载到 ListView 中，请为 ListView使用[SimpleCursorAdapter 。](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html)（您可能需要在异步完成后调用 notifyDataSetChanged()。）

# ruby-on-rails-3 - Rails 3：循环参数以进行基于动态的 MySQL 查询

> ID：10252246
> 
> 赞同：0
> 
> 时间：2012-04-20T19:18:42.117
> 
> 标签：ruby-on-rails-3, activerecord, optional-parameters

我开发了一个小的 API，它返回一些小的 JSON 对象（主要是小资源，没什么特别的），但是我需要扩展一个 API 端点以返回比当前更多的东西。

例如 - 目前，我的路线中有以下内容：

```
resources :school_types do
        resources :schools
      end 
```

因此，如果用户访问`/api/v1/school_types/1/schools.json`整个学校列表，则会根据`school_type_id`

好吧，我现在想更进一步并执行以下操作： `/api/v1/school_types/1/schools.json?param_1=foo&param_2=bar`

因此，当我构造`ActiveRecord`调用时，它会根据传入的参数动态生成 SQL 查询。

这是我到目前为止所拥有的：

```
conditions = ""
      params.except(:controller, :format, :action).each_with_index do |value, index|
        conditions << "#{params[index]} = #{value} AND "
      end 
```

这是条件变量输出：`" = [\"state_id\", \"1\"] AND = [\"district_id\", \"1\"] AND = [\"school_type_id\", \"1\"] AND "`

显然我做错了什么，大声笑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:23:14.757

我强烈建议使用[MetaSearch 之](http://erniemiller.org/projects/metasearch/)类的工具，而不是自己动手。您当前的实现很容易受到 SQL 注入攻击。

# python - 如何从 psycopg2 游标中获取列名列表？

> ID：10252247
> 
> 赞同：193
> 
> 时间：2012-04-20T19:18:43.133
> 
> 标签：python, psycopg2

我想要一种直接从所选列名生成列标签的通用方法，并记得看到 python 的 psycopg2 模块支持此功能。

* * *

## 回答 #1

> 赞同：298
> 
> 时间：2012-04-20T19:20:10.930

来自 Mark Lutz 的“Python 编程”：

```
curs.execute("Select * FROM people LIMIT 0")
colnames = [desc[0] for desc in curs.description] 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2017-09-01T12:20:32.077

您可以做的另一件事是创建一个游标，您可以使用该游标通过名称引用您的列（这是首先导致我进入此页面的需要）：

```
import psycopg2
from psycopg2.extras import RealDictCursor

ps_conn = psycopg2.connect(...)
ps_cursor = psql_conn.cursor(cursor_factory=RealDictCursor)

ps_cursor.execute('select 1 as col_a, 2 as col_b')
my_record = ps_cursor.fetchone()
print (my_record['col_a'],my_record['col_b'])

>> 1, 2 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2014-03-04T12:48:29.713

要**在单独的查询中获取列名**，可以查询 information_schema.columns 表。

```
#!/usr/bin/env python3

import psycopg2

if __name__ == '__main__':
  DSN = 'host=YOUR_DATABASE_HOST port=YOUR_DATABASE_PORT dbname=YOUR_DATABASE_NAME user=YOUR_DATABASE_USER'

  column_names = []

  with psycopg2.connect(DSN) as connection:
      with connection.cursor() as cursor:
          cursor.execute("select column_name from information_schema.columns where table_schema = 'YOUR_SCHEMA_NAME' and table_name='YOUR_TABLE_NAME'")
          column_names = [row[0] for row in cursor]

  print("Column names: {}\n".format(column_names)) 
```

要**在与数据行相同的查询中获取列名**，可以使用游标的描述字段：

```
#!/usr/bin/env python3

import psycopg2

if __name__ == '__main__':
  DSN = 'host=YOUR_DATABASE_HOST port=YOUR_DATABASE_PORT dbname=YOUR_DATABASE_NAME user=YOUR_DATABASE_USER'

  column_names = []
  data_rows = []

  with psycopg2.connect(DSN) as connection:
    with connection.cursor() as cursor:
      cursor.execute("select field1, field2, fieldn from table1")
      column_names = [desc[0] for desc in cursor.description]
      for row in cursor:
        data_rows.append(row)

  print("Column names: {}\n".format(column_names)) 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2017-08-02T08:20:39.903

如果您想从 db 查询中获得一个命名元组 obj，您可以使用以下代码段：

```
from collections import namedtuple

def create_record(obj, fields):
    ''' given obj from db returns named tuple with fields mapped to values '''
    Record = namedtuple("Record", fields)
    mappings = dict(zip(fields, obj))
    return Record(**mappings)

cur.execute("Select * FROM people")
colnames = [desc[0] for desc in cur.description]
rows = cur.fetchall()
cur.close()
result = []
for row in rows:
    result.append(create_record(row, colnames)) 
```

这使您可以像访问类属性一样访问记录值，即

> record.id、record.other_table_column_name 等。

甚至更短

```
from psycopg2.extras import NamedTupleCursor
with cursor(cursor_factory=NamedTupleCursor) as cur:
   cur.execute("Select * ...")
   return cur.fetchall() 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2020-09-15T06:55:47.977

如果您正在寻找*已关联列标题*的 pandas 数据框，请尝试以下操作：

```
import psycopg2, pandas

con=psycopg2.connect(
    dbname=DBNAME, 
    host=HOST, 
    port=PORT, 
    user=USER, 
    password=PASSWORD
)

sql = """
select * from x
"""

d = pandas.read_sql_query(sql,con)

con.close()

print(type(d))

print(pandas.DataFrame.head(d)) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-05-29T08:04:58.133

执行 SQL 查询后，编写以下用 2.7 编写的 python 脚本

```
total_fields = len(cursor.description)    
fields_names = [i[0] for i in cursor.description   
    Print fields_names 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-08T08:52:27.223

我注意到您必须在查询之后使用（即在）[`cursor.fetchone()`](https://dev.mysql.com/doc/connector-python/en/connector-python-api-mysqlcursor-fetchone.html)中获取列列表[`cursor.description`](https://dev.mysql.com/doc/connector-python/en/connector-python-api-mysqlcursor-description.html)`[desc[0] for desc in curs.description]`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-11-20T19:09:59.247

```
 # You can use this function
 def getColumns(cursorDescription):
     columnList = []
     for tupla in cursorDescription:
         columnList.append(tupla[0])
     return columnList 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-12T23:07:15.123

我也曾经面临过类似的问题。我用一个简单的技巧来解决这个问题。假设您在列表中有列名，例如

```
col_name = ['a', 'b', 'c'] 
```

然后你可以做以下

```
for row in cursor.fetchone():
    print zip(col_name, row) 
```

* * *

## 回答 #10

> 赞同：-7
> 
> 时间：2016-06-28T08:52:36.943

```
#!/usr/bin/python
import psycopg2
#note that we have to import the Psycopg2 extras library!
import psycopg2.extras
import sys

def main():
    conn_string = "host='localhost' dbname='my_database' user='postgres' password='secret'"
    # print the connection string we will use to connect
    print "Connecting to database\n ->%s" % (conn_string)

    # get a connection, if a connect cannot be made an exception will be raised here
    conn = psycopg2.connect(conn_string)

    # conn.cursor will return a cursor object, you can use this query to perform queries
    # note that in this example we pass a cursor_factory argument that will
    # dictionary cursor so COLUMNS will be returned as a dictionary so we
    # can access columns by their name instead of index.
    cursor = conn.cursor(cursor_factory=psycopg2.extras.DictCursor)

    # tell postgres to use more work memory
    work_mem = 2048

    # by passing a tuple as the 2nd argument to the execution function our
    # %s string variable will get replaced with the order of variables in
    # the list. In this case there is only 1 variable.
    # Note that in python you specify a tuple with one item in it by placing
    # a comma after the first variable and surrounding it in parentheses.
    cursor.execute('SET work_mem TO %s', (work_mem,))

    # Then we get the work memory we just set -> we know we only want the
    # first ROW so we call fetchone.
    # then we use bracket access to get the FIRST value.
    # Note that even though we've returned the columns by name we can still
    # access columns by numeric index as well - which is really nice.
    cursor.execute('SHOW work_mem')

    # Call fetchone - which will fetch the first row returned from the
    # database.
    memory = cursor.fetchone()

    # access the column by numeric index:
    # even though we enabled columns by name I'm showing you this to
    # show that you can still access columns by index and iterate over them.
    print "Value: ", memory[0]

    # print the entire row 
    print "Row: ", memory

if __name__ == "__main__":
    main() 
```

# sqlcipher - Sqlcipher，Windows：加密成功但产生奇怪的结果

> ID：10252250
> 
> 赞同：1
> 
> 时间：2012-04-20T19:18:50.267
> 
> 标签：sqlcipher

我`sqlcipher_export()`完全按照[此处](http://sqlcipher.net/sqlcipher-api/#sqlcipher_export)指定的方式使用来加密现有的 Sqlite 数据库。一切顺利 - 没有错误，生成的数据库已创建并具有合理的大小。但是，我无法打开加密的数据库，即使我使用`PRAGMA key`. 未加密的数据库可以毫无问题地打开。

而且，加密的数据库看起来很奇怪；标头似乎已加密，但数据未加密。请参阅[http://i.stack.imgur.com/HaBpS.png](http://i.stack.imgur.com/HaBpS.png)，这是一张显示加密（左）和未加密（右）数据库之间的二进制比较的图像。

在调试器中，我可以看到，在加密期间，程序通过了`sqlcipher_page_cipher()`，但大多数时候（除了 2 次调用之外，每次都执行）以下子句被执行，并且函数提前返回：

```
 /* just copy raw data from in to out when key size is 0
   * i.e. during a rekey of a plaintext database */ 
  if(c_ctx->key_sz == 0) {
    memcpy(out, in, size);
    return SQLITE_OK;
  } 
```

加密期间发出的 SQL：

```
ATTACH DATABASE 'encrypted.db' AS encrypted KEY '12345'; 
SELECT sqlcipher_export('encrypted'); 
DETACH DATABASE encrypted; 
```

打开时发出的SQL：

```
// open database
PRAGMA key = '12345'; 
// try to read database - "file is encrypted or not a database" 
```

加解密过程中产生的CODEC_TRACE日志在[这里](http://yp.lviv.ua/tmp/sqlcipher_log.zip)。

（如果我编译 Sqlcipher 的方式很重要：我在 Linux 机器上创建了一个 Sqlcipher 合并，将生成的 C 文件复制到 Windows 机器，在 Visual C++ Express 中编译它，并链接到预编译的 OpenSSL DLL。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T09:42:00.153

`HMAC_Init_ex()`根本原因：在`sqlcipher_page_hmac()`属于的损坏内存中调用 OpenSSL `c_ctx->key_sz`，将其设置为零。`c_ctx->key_sz`与传递给的参数相邻`HMAC_Init_ex()`。（详细信息可以在原始帖子的评论之一中找到。）这导致`sqlcipher_page_cipher()`将纯文本页面写入加密文件，而不是加密页面。这没有任何意义，并使生成的数据库无法使用。

将 OpenSSL 从 0.9.8k 升级到 1.0.0i 解决了这个问题。

# lucene - 使用 RavenDb/Lucene 进行分面搜索的层次分类法？

> ID：10252254
> 
> 赞同：6
> 
> 时间：2012-04-20T19:19:14.840
> 
> 标签：lucene, ravendb, faceted-search

我正在考虑使用 RavenDb 来实现“高级多面搜索”场景。
在支持全文搜索和所有其他基本功能的同时，我必须处理复杂的分层分类法和跨树的不同分支的共享方面。

是否有任何资源记录如何使用 RavenDb API 执行此操作？

关于该主题的极其复杂的论文：[超越基本分面搜索](http://nadav.harel.org.il/papers/p33-ben-yitzhak.pdf)
Solr 的方式：[HierarchicalFaceting](http://wiki.apache.org/solr/HierarchicalFaceting)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T13:32:59.280

最后..

```
using System.Collections.Generic;
using System.Linq;
using NUnit.Framework;
using Raven.Abstractions.Data;
using Raven.Client;
using Raven.Client.Document;
using Raven.Client.Indexes;
using Raven.Client.Linq;

namespace Prototype.Search.Tests
{
    [TestFixture]
    public class HierarchicalFaceting
    {
        //
        // Document definition
        //
        public class Doc
        {
            public Doc()
            {
                Categories = new List<string>();
            }

            public int Id { get; set; }
            public List<string> Categories { get; set; }
        }

        //
        // Data sample
        //
        public IEnumerable<Doc>  GetDocs()
        {
            yield return new Doc { Id = 1, Categories = new List<string> { "0/NonFic", "1/NonFic/Law"} };
            yield return new Doc { Id = 2, Categories = new List<string> { "0/NonFic", "1/NonFic/Sci" } };
            yield return new Doc { Id = 3, Categories = new List<string> { "0/NonFic", "1/NonFic/Hist", "1/NonFic/Sci", "2/NonFic/Sci/Phys" } };
        }

        //
        // The index
        //
        public class DocByCategory : AbstractIndexCreationTask<Doc, DocByCategory.ReduceResult>
        {
            public class ReduceResult
            {
                public string Category { get; set; }
            }

            public DocByCategory()
            {
                Map = docs =>
                      from d in docs
                      from c in d.Categories
                      select new
                                 {
                                     Category = c
                                 };
            }
        }

        //
        // FacetSetup
        //
        public FacetSetup GetDocFacetSetup()
        {
            return new FacetSetup
                       {
                           Id = "facets/Doc",
                           Facets = new List<Facet>
                                        {
                                            new Facet
                                                {
                                                    Name = "Category"
                                                }
                                        }
                       };
        }

        [SetUp]
        public void SetupDb()
        {
            IDocumentStore store = new DocumentStore()
            {
                Url = "http://localhost:8080"
            };
            store.Initialize();
            IndexCreation.CreateIndexes(typeof(HierarchicalFaceting).Assembly, store);

            var session = store.OpenSession();
            session.Store(GetDocFacetSetup());
            session.SaveChanges();

            store.Dispose();
        }

        [Test]
        [Ignore]
        public void DeleteAll()
        {
            IDocumentStore store = new DocumentStore()
            {
                Url = "http://localhost:8080"
            };
            store.Initialize();

            store.DatabaseCommands.DeleteIndex("Raven/DocByCategory");
            store.DatabaseCommands.DeleteByIndex("Raven/DocumentsByEntityName", new IndexQuery());

            store.Dispose();
        }

        [Test]
        [Ignore]
        public void StoreDocs()
        {
            IDocumentStore store = new DocumentStore()
            {
                Url = "http://localhost:8080"
            };
            store.Initialize();

            var session = store.OpenSession();

            foreach (var doc in GetDocs())
            {
                session.Store(doc);
            }

            session.SaveChanges();
            session.Dispose();
            store.Dispose();
        }

        [Test]
        public void QueryDocsByCategory()
        {
            IDocumentStore store = new DocumentStore()
            {
                Url = "http://localhost:8080"
            };
            store.Initialize();

            var session = store.OpenSession();

            var q = session.Query<DocByCategory.ReduceResult, DocByCategory>()
                .Where(d => d.Category == "1/NonFic/Sci")
                .As<Doc>();

            var results = q.ToList();
            var facetResults = q.ToFacets("facets/Doc").ToList();

            session.Dispose();
            store.Dispose();
        }

        [Test]
        public void GetFacets()
        {
            IDocumentStore store = new DocumentStore()
            {
                Url = "http://localhost:8080"
            };
            store.Initialize();

            var session = store.OpenSession();

            var q = session.Query<DocByCategory.ReduceResult, DocByCategory>()
                .Where(d => d.Category.StartsWith("1/NonFic"))
                .As<Doc>();

            var results = q.ToList();
            var facetResults = q.ToFacets("facets/Doc").ToList();

            session.Dispose();
            store.Dispose();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:13:02.193

为了速度，我将使用纯 Lucene 处理其中的树搜索部分。2种方法是父子链接方法和路径枚举/'Dewey Decimal'方法。

父子是我们在算法课中学习实现链表的方式。它很容易更新，但查询需要访问每个节点（例如，您不能直接从父节点到其曾孙节点）。鉴于您无论如何都需要访问节点的所有祖先以获取所有属性（因为想法是共享属性），因此必须访问所有祖先可能是一个有争议的问题。

[如何将树数据存储在 Lucene/Solr/Elasticsearch 索引或 NoSQL 数据库中？](https://stackoverflow.com/questions/9970193/how-to-store-tree-data-in-a-lucene-solr-elasticsearch-index-or-a-nosql-db/10209230#10209230)涵盖路径枚举/'Dewey Decimal' 方法。

任何一种方法都可以处理任意复杂的层次结构，只要它是真正的层次结构（即有向无环图（DAG））。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:52:10.927

我已经修好了。

我创建索引如下：

```
public class ProductByCategory : AbstractIndexCreationTask<Product, ProductByCategory.ReduceResult>
{
    public class ReduceResult
    {
        public string Category { get; set; }
        public string Title { get; set; }
    }

    public ProductByCategory()
    {
        Map = products =>
              from p in products
              from c in p.Categories
              select new
              {
                  Category = c,
                  Title = p.Title
              };
        Stores.Add(x => x.Title, FieldStorage.Yes);
        Indexes.Add(x => x.Title, FieldIndexing.Analyzed);
    }
} 
```

我像这样查询它：

```
var q = session.Query<ProductByCategory.ReduceResult, ProductByCategory>().Search(x => x.Title, "Sony")
.Where(r => r.Category.StartsWith("1/beeld en geluid")).As<Product>();

var facetResults = q.ToFacets("facets/ProductCategory"); 
```

# javascript - Ext JS 4 的文件上传和内部服务器错误

> ID：10252260
> 
> 赞同：0
> 
> 时间：2012-04-20T19:19:46.123
> 
> 标签：javascript, file-upload, extjs, error-handling, extjs4

在这里，我们再次使用 Ext JS。

假设我有一个向应用程序的 Web 服务器提交图像的文件上传 (Ext.form.field.File) 字段。

每当我在提交表单时收到内部服务器错误（状态代码 = 500）（即：发布的文件大于 Web 服务器的最大请求长度）时，Ext 就会抛出一个异常，显示在浏览器的控制台上。

如果我像这样覆盖 Ext.Error.handle，我可以及时发现错误：

```
<!-- language: js -->
Ext.Error.handle = function (err) {

    switch (err.sourceClass) {
        case "Ext.JSON":
            {
                var arr = err.msg.split('\n');
                var msg = arr[0];
                arr.shift();
                var serverMsg = arr.join('\n');

                LogManager.error(msg);
                return true;
            }
        default:
            {
                if (err.msg) {
                    LogManager.error(err.msg);
                    return true;
                }
            }
            return false;
    }
} 
```

问题是无论我是否发现错误，Ext 创建的模态进度条仍然显示，这意味着我的应用程序被永久锁定。

问题是：如何让 Ext 触发表单的失败回调并以愉快的方式关闭进度条？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T10:38:50.673

我认为最干净的方法是让您使用表单提交失败回调来处理内部服务器（500）错误。

有关更多信息，请参阅文档[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.Basic-method-submit](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.Basic-method-submit)。

你可以设置一个waitMsg 属性，你会看到Ext 会自动取消正在显示的消息。像这样...

```
myFormPanel.getForm().submit({
    clientValidation: true,
    waitMsg: 'Uploading image...',
    url: 'updateConsignment.php',
    params: {
        newStatus: 'delivered'
    },
    success: function(form, action) {
       Ext.Msg.alert('Success', action.result.msg);
    },
    failure: function(form, action) {
        switch (action.failureType) {
            case Ext.form.action.Action.CLIENT_INVALID:
                Ext.Msg.alert('Failure', 'Form fields may not be submitted with invalid values');
                break;
            case Ext.form.action.Action.CONNECT_FAILURE:
                Ext.Msg.alert('Failure', 'Ajax communication failed');
                break;
            case Ext.form.action.Action.SERVER_INVALID: //For your 500
               Ext.Msg.alert('Failure', action.result.msg);
       }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T21:25:03.297

我刚刚找到了一个解决此问题的肮脏解决方案，即使用 Ext.Error.handle 处理错误，使用 Ext.Msg 显示错误消息 abd return false。这很棘手。

通过处理错误，我可以检查错误事件并检索一些错误信息。显示错误消息是比较棘手的部分，因为上传的进度条使用 Ext.Msg 后面的相同基础结构，并且 Ext.Msg 有一个错误，它不允许程序员像队列一样调用它，显示一条消息，然后显示下一条消息用户单击确定。它总是删除前一个并显示新的。**如果用户必须决定两条路径并且问题消息框将简单地消失，那么这种行为可能会导致可怕的错误！** 最后，我们返回 false 并在控制台中打印错误。如果我们此时返回 true，调用函数将继续执行并导致问题，因为预期的信息很可能不存在。

这个解决方案很棘手，很脏，而且一点也不愉快。它现在对我有用，但我知道我很快就会后悔：P

# oracle10g - Oracle 时间戳到 sysdate 转换错误

> ID：10252271
> 
> 赞同：1
> 
> 时间：2012-04-20T19:20:08.340
> 
> 标签：oracle10g

它给出了这样的错误：日期格式图片在转换整个输入字符串之前结束

```
declare
  v_t timestamp; 
begin
  v_t := to_timestamp(systimestamp,'DD/MM/YY')+interval '12-3' year to month;
  DBMS_OUTPUT.PUT_LINE(v_t);
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:28:43.903

`SYSTIMESTAMP`已经是时间戳，所以您不想调用`to_timestamp`. 如果要在当前时间戳上增加 12 年 3 个月

```
SQL> ed
Wrote file afiedt.buf

  1  declare
  2    v_t timestamp;
  3  begin
  4    v_t := systimestamp +interval '12-3' year to month;
  5    DBMS_OUTPUT.PUT_LINE(v_t);
  6* end;
SQL> /
20-JUL-24 03.27.28.966000 PM

PL/SQL procedure successfully completed. 
```

# javascript - 如何禁用标题工具提示！（是：如何在 Javascript 中获取事件目标后面的元素？）

> ID：10252274
> 
> 赞同：-1
> 
> 时间：2012-04-20T19:20:11.857
> 
> 标签：javascript, tooltip, jquery-events, event-bubbling

我有一个元素位于另一个元素的顶部，如何忽略顶部元素的点击捕获并将其传递给它下面的元素？

```
$('a[title]').each(function (index) {
    $(this).after('&lt;div class="overlay" style="position:absolute;background:url(../Images/space.gif);width:100px;height:100px;top:0;left:0;z-index:300"></div>')
}) 
```

原因是这段代码阻止了标题工具提示的弹出。hover 伪类仍然在它后面的链接上工作，因为它附加到包含它们的元素上，如下所示：

```
li:hover a { ... } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:43:25.600

看起来你所有的链接都有一个元素，上面有相同的`id` *叠加层*。

删除`id`并添加一个`class`到你的透明块`div`。

然后添加一个`click`事件`class`来做你想要的`parent`元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:24:00.923

请发布我们可以使用的示例标记。通常您只需将事件处理程序附加到您想要的元素，我不明白您遇到了什么问题。

**编辑** 如果我理解正确，这是某种工具提示，您希望用户传递点击事件。首先，您不能在循环中使用 id="overlay"，因为 id 必须是唯一的。一种简单的方法是使用 .bind 为 pre-1.7 jquery 创建一个事件处理程序，或者为 1.7 创建一个事件处理程序

```
$('a[title]').each(function (index, el) {
      var $tooltip = $( '<div id="overlay-' + index  + '" />' ) 
                         //let JQuery create the CSS instead of using a style tag
                         .css({ position   : "absolute"
                              , background : "url(../Images/space.gif)"
                              , width   : 100
                              , height  : 100
                              , top     : 0
                              , left    : 0
                              , zIndex  : 300
                             })
                         //attach click handler to div
                         .on( 'click', function( e ){
                               $( el ).trigger( 'click' );
                            });
      $(this).after( $tooltip );
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-18T21:46:29.763

--------*解决方案*----------

```
 $('a[title]').each(function (index, el) {
    var $tooltip = $('<div class="overlay-' + index + '" />')
                         .css({
                            position: "absolute"
                            , background: "url('../Images/space.gif')"
                            , width: $(el).width()
                            , height: $(el).height()
                            , top: 0
                            , left: 0
                            , zIndex: 300
                            , border: "1px solid red"
                         })
                         .on('click', function (event) {
                             $(el).click();
                         });
    $(this).after($tooltip);
}) 
```

# postgresql - postgreSQL 主/外键不符合

> ID：10252275
> 
> 赞同：-1
> 
> 时间：2012-04-20T19:20:17.917
> 
> 标签：postgresql, foreign-keys, primary-key

嗨，我目前有两个表和通常的成员表。

成员表

```
member_id SERIAL, 
first_name varchar(20)
last_name varchar(20). 
```

我有第二张桌子

规划师

```
day as varchar
time as varchar
activity varchar
member bigint 
```

我将 member_id 定义为主键，不为空且唯一

我还设置了 member 是 member_id 的外键

所以这应该允许它，以便只有成员中的 ID 号并输入规划器，是吗？

目前我有四个成员，member_id 从 1 到 4 。好吧，当我在下面尝试时，它仍然不允许我将数据插入到计划表中。

```
INSERT INTO planner VALUES ('monday','09:00','Rowing',2); 
```

对我来说应该可以，但我收到了这个错误：

```
 DETAIL Key (member)=(2) is not present in the table "members". 
```

所以我目前很难过，任何帮助都会非常有帮助，谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T12:20:18.640

它不起作用，因为继承不适用于外键。使用当前版本的 PostgreSQL

我必须为它创建一个规则才能工作

```
create rule fake_ref
as on insert to planner
where new.member not in (select member_id from members)
do instead nothing; 
```

# java - Swing 的 GroupLayout 和 setContentPane - 丢失组件？

> ID：10252279
> 
> 赞同：2
> 
> 时间：2012-04-20T19:20:27.737
> 
> 标签：java, swing, grouplayout, contentpane

经过实验，在我看来，Swing 的 GroupLayout 往往会丢失打算在我的 GUI 中重复使用的组件。

但我在文档中没有看到任何明确说明此一次性使用规则的内容。这让我怀疑我是否犯了一个错误，或者我是否是一个糟糕的读者。

例如，我用 JButton("Foo") 的 GroupLayout 制作了一个 JPanel。然后我用同一个 JButton 的 GroupLayout 制作另一个 JPanel，重命名为“Bar”。

如果我使用 JFrame.setContentPane 从第二个 JPanel 切换回第一个 JPanel，我会丢失第一个 JPanel 中的 JButton。

任何人都可以解释为什么它会丢失组件，而且，任何人都可以提供一种方法来克服丢失组件的趋势吗？

这是一个完整的 SSCCE 演示该问题：

```
import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class GroupLayoutTest {

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            deployGroupLayoutTest();
        }
    });
}

static JPanel firstPanel;
static JButton jbtnActionLog;
static JFrame systemFrame;

public static void deployGroupLayoutTest() {
    systemFrame = new JFrame("Group Layout Test");
    systemFrame.setSize(300, 300);

    firstPanel = new JPanel();

    JMenuBar jmbSystem = new JMenuBar();

    JMenu jmuAction = new JMenu("Action");

    JMenuItem jmiActionLog = new JMenuItem("Login");
    jmuAction.add(jmiActionLog);

    jmbSystem.add(jmuAction);

    jbtnActionLog = new JButton("Login");
    jbtnActionLog.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            setContentPaneToSecondPanel();
        }
    });

    systemFrame.setJMenuBar(jmbSystem);

    GroupLayout gl = new GroupLayout(firstPanel);
    firstPanel.setLayout(gl);
    gl.setAutoCreateContainerGaps(true);
    gl.setAutoCreateGaps(true);

    GroupLayout.ParallelGroup hGroup = gl.createParallelGroup(GroupLayout.Alignment.CENTER);
    hGroup
            .addComponent(jbtnActionLog);

    gl.setHorizontalGroup(hGroup);

    GroupLayout.SequentialGroup vGroup = gl.createSequentialGroup();
    vGroup
            .addComponent(jbtnActionLog);
    gl.setVerticalGroup(vGroup);

    systemFrame.getContentPane().add(firstPanel);
    systemFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    systemFrame.setLocationByPlatform(true);
    systemFrame.setVisible(true);

}

public static void setContentPaneToSecondPanel() {
    jbtnActionLog.setText("Logout");
    ActionListener[] listenerList = jbtnActionLog.getActionListeners();
    jbtnActionLog.removeActionListener(listenerList[0]);
    jbtnActionLog.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            systemFrame.setContentPane(firstPanel);
            systemFrame.revalidate();
        }
    });

    JPanel secondPanel = new JPanel();

    GroupLayout gl = new GroupLayout(secondPanel);
    secondPanel.setLayout(gl);
    gl.setAutoCreateContainerGaps(true);
    gl.setAutoCreateGaps(true);

    GroupLayout.ParallelGroup hGroup = gl.createParallelGroup(GroupLayout.Alignment.CENTER);
    hGroup
            .addComponent(jbtnActionLog);

    gl.setHorizontalGroup(hGroup);

    GroupLayout.SequentialGroup vGroup = gl.createSequentialGroup();
    vGroup
            .addComponent(jbtnActionLog);
    gl.setVerticalGroup(vGroup);

    systemFrame.setContentPane(secondPanel);
    systemFrame.revalidate();
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:26:04.650

我没有浏览您的所有代码，但根本不可能将单个 Swing 组件添加到多个父级。每个组件只能出现在 Swing 层次结构中的一个位置。所以代码

```
JPanel firstPanel = ...;
JPanel secondPanel = ...;
JButton button = ...;
firstPanel.add( button );
secondPanel.add( button ); 
```

将导致`button`仅包含在其中一个面板中，而不包含在两个面板中。这与`GroupLayout`.

一个相关的[SO 问题](https://stackoverflow.com/questions/4620601/cant-a-swing-component-be-added-to-multiple-containers)包含到[Swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/toplevel.html)的链接，解释了这一点：

> 每个 GUI 组件只能包含一次。如果一个组件已经在一个容器中，并且您尝试将其添加到另一个容器中，该组件将从第一个容器中删除，然后添加到第二个容器中

# ios - 在 iOS 上捕获蜂窝网络数据包？

> ID：10252281
> 
> 赞同：0
> 
> 时间：2012-04-20T19:20:31.583
> 
> 标签：ios, 3g, 4g

我发现一篇文章讨论了在 iOS 上捕获通过 Wifi 传输的网络数据包：http: [//www.cardinalpeak.com/blog/? p=519](http://www.cardinalpeak.com/blog/?p=519)

**如何为蜂窝（即 3G、4G）网络数据包实现相同的功能？**[鉴于此](https://stackoverflow.com/questions/9936819/apple-policy-for-http-live-streaming-apps)限制，我试图弄清楚 Skype 用于在 iOS 上实现实时聊天的网络协议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-28T06:53:54.903

您不需要越狱设备设备即可在其上运行捕获。您可以通过您的 mac 设备嗅探流量。
这就是你想要的，我相信。从 iOS5 开始，Apple 增加了对 RVI 接口的支持。因此，如果您运行的是 OSX 设备，您可以通过 VRI 网络将您的 iOS 连接到 OSX，享受 3G/2G 的世界。

关于 Skype：
Skype 使用它的协议进行聊天，尽管数据包是在 TCP 中传输的。捕获这些数据包可以提供尽可能多的信息。
通话时以 UDP 数据包的形式发送音频（昨天刚刚进行了测试）。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:08:09.903

我对您的问题没有很好的答案，但您可以尝试：

1.  使用 Skype 呼叫 Mac 或 PC 并使用数据包嗅探器从另一端观察连接
2.  获取一个 AT&T 3G Microcell 并在其以太网连接上放置一个数据包嗅探器
3.  越狱设备并在其上放置数据包嗅探器

如果 Skype 使用安全连接，我认为这些解决方案中的任何一个都不会很好地工作。#1 也不会看到与 Skype 服务器的设置对话。如果您有备用设备，＃3 似乎是您最好的选择。

# vim - Vim 内嵌导航

> ID：10252286
> 
> 赞同：1
> 
> 时间：2012-04-20T19:21:03.520
> 
> 标签：vim

如何在不离开当前行的情况下跳过一个单词（'w'）？

光标应停在行尾。我相信类似的解决方案也可以应用于其他步长。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T20:01:33.230

奇怪`:call search('\<\|\(\k\@!\S\)\+', 'W', line('.'))`的请求，但应该可以解决问题。为了模拟`w`移动，我们必须搜索关键字`\<`的开头，或非关键字 non-whitespace 的开头`\(\k\@!\S\)\+`。我们关闭换行（`'W'`），并将搜索功能的范围限制在当前行。

这在该行的最后一个单词处停止。如果您还想在行尾停止，请添加`\|$`到正则表达式。

或者，您可以组装一个搜索命令，例如`/\%42l\(\<\|\(\k\@!\S\)\+\)`，但输入当前行号（本例中为 42）并处理“wrapscan”设置更难。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-21T07:01:31.423

理解你的意思已经不是那么容易了，但你也忘了说你希望它在*插入*模式下工作。

您希望能够在*插入*模式下逐字移动吗？好吧，你可能已经知道了，但**你不应该那样做。**这就是*普通*模式的用途。

默认情况下，在 ubuntu 上的 GVim 中可以进行这种导航。

很容易模拟：

```
inoremap <C-Right> <C-o>w
inoremap <C-Left> <C-o>b 
```

但这不是一个好主意。

我没有得到“光标应该停在行尾”部分。

# .net - 指定拾取目录的 Web 界面

> ID：10252291
> 
> 赞同：0
> 
> 时间：2012-04-20T19:21:30.367
> 
> 标签：.net, testing, smtp, acceptance-testing, user-acceptance-testing

我有一个应用程序的 QA 环境，许多用户将不时在该应用程序上进行测试。许多功能都涉及发送电子邮件，我不希望系统向客户发送电子邮件。

通常，在 web.config 中使用指定的PickupDirectory 功能来更改应用程序发送电子邮件的方式，这对我作为开发人员来说很好。但是一个充满以 guid 命名的文件的文件夹对于将要进行测试的人来说并不真正适用。

有没有人见过一个电子邮件文件夹的 Web 前端，可以让多个测试人员验证系统发送的内容？不需要任何权限或任何类似的要求，只需让他们按发送时间、发件人和收件人地址查看所有消息，然后在屏幕上显示消息或在 Outlook 中打开它。

我假设 .NET 应用程序的最简单实现只是从指定的PickupDirectory 中读取，但实现 SMTP 服务器连接然后存储消息的功能更全的解决方案也可以。有人见过这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-28T09:10:37.237

这个答案对您的问题可能有点晚，但我遇到了同样的问题，并为拾取文件夹编写了一个简单的网络查看器。

[https://github.com/albinsunnanbo/PickupMailViewer/](https://github.com/albinsunnanbo/PickupMailViewer/)

# jruby - JRuby 性能

> ID：10252293
> 
> 赞同：21
> 
> 时间：2012-04-20T19:21:35.600
> 
> 标签：jruby, jrubyonrails

我有一个 Rails 3.2.2 应用程序，我希望使用 JRuby 1.6.7（1.9.2 模式）运行它。

我有一个在 MRI ruby​​ 1.9.3 中运行的示例应用程序，典型的请求在 ~40 毫秒内返回：在 36 毫秒内完成 200 OK（查看：27.5 毫秒 | ActiveRecord：8.2 毫秒）

在 JRuby 下，使用相同的请求会慢 3 到 20 倍，具体取决于页面。对于与上述相同的操作，大约需要 180 毫秒：在 180 毫秒内完成 200 次 OK（查看次数：153.0 毫秒 | ActiveRecord：24.0 毫秒）

这是正常的性能差异吗？我读过 JRuby 在速度上与 MRI 大致相等。结果保存在我的 Mac 和 Windows 服务器上（不幸的是它需要运行）。用在 Tomcat 下运行的 Warbler 打包它同样慢。

以上时间来自为测试 JRuby 创建的基本 Rails 应用程序。在更复杂的应用程序上，时代相距更远。在该应用程序上，某些页面上运行了更多 ruby​​ 代码。似乎页面越依赖红宝石，我观察到的性能差异就越大。我没有调整 JRuby，因为我不知道从哪里开始。

所以我的问题是：这正常吗？我可以做些什么来调整 JRuby？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-23T16:09:24.783

```
Is this a normal performance difference?
I have read that JRuby is roughly equal on speed with MRI. 
```

不，这不正常。一旦 JVM 预热，JRuby 下的 Rails 请求通常比 MRI 下的请求性能要好得多，无论是在原始执行速度还是垃圾收集方面。

听起来您的应用配置错误。首先要检查的是 Rails 本身的配置 - 请确保 Rails 不在开发模式下，并且`config.threadsafe!`在您的生产环境中启用。当您的应用程序运行时，线程安全模式将导致只有一个共享的 Rails 副本加载到内存中。

还要检查您的数据库配置是否利用了连接池，例如`pool: 20`在`database.yml`.

最后，检查您的 JVM 和 JRuby 设置——两者都是高度可调的。您需要确保在启动时有足够的内存分配给JVM，然后有足够的内存让您的应用程序正常流畅运行；否则 JVM 将不断被迫过早且频繁地进行垃圾收集，这将显着降低性能。

例如，一些配置适中的 VPS 的设置可能类似于：

`-Xmx500m -Xss1024k -Djruby.memory.max=500m -Djruby.stack.max=1024k`

...但不要盲目复制这些设置！您将不得不试验并找出对您的服务器上可用的内存资源有什么好处。

也就是说，虽然 JRuby 可能会比 MRI 下多个 Rails 进程的总和消耗更少的内存，但您肯定需要预先为单个 JVM 进程分配更多的内存。对 JRuby 大方一点，JRuby 会奖励你的好意 :-)

您可以在此处阅读有关调整 JRuby 和 JVM 的更多信息：[https ://github.com/jruby/jruby/wiki/PerformanceTuning](https://github.com/jruby/jruby/wiki/PerformanceTuning)

**更新**

`config.threadsafe!`在**Rails 4.0**及以上版本不需要设置；默认情况下它是线程安全的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T13:48:04.470

我看到了同样的行为，但请记住 JRuby 需要更长的时间来预热。实际上，我对 JRuby 最终会赶上来有点乐观。

通过设置一些选项，可以更快地“热身”。通过设置以下环境变量，可以教导 Ruby -> Java 字节码编译器在第一次调用时 JIT 编译每个方法：

`export JRUBY_OPTS="-J-Djruby.jit.threshold=1 -J-Djruby.jit.max=16384"`

对我来说，在刷新 Rails 页面几次后，它仍然比 MRI Ruby 慢 2-3 倍，但至少比以前快 3 倍。

还要记住，java 运行时是以类似的方式将 java 字节码编译为机器码的 JIT，但是在使用服务器运行时时，直到一个方法被调用 10.000x 时，这个 JIT 才会启动。这也可以[配置](http://ruby.11.n6.nabble.com/Question-about-monitoring-Java-JIT-from-java-bytecode-to-x86-code-td4564918.html)。

`export JRUBY_OPTS="-J-Djruby.jit.threshold=10 -J-Djruby.jit.max=16384 -J-XX:CompileThreshold=10" -J-XX:ReservedCodeCacheSize=128M"`

通过这些选项，JRuby on Rails 提供了与 MRI 大致相同或更好的性能。

请注意，这些选项仅用于不耐烦的基准测试！实际上，如此激进地运行 JIT 编译几乎总是一个坏主意。您正在将宝贵的时间和内存浪费在可能只运行几次的代码的 JIT 编译上。但是，它显示了最终的 JRuby 性能如何可能比基于初始运行的预期更好。

让我知道这是否适合您。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T11:23:22.217

使用 JAVA 7 升级到 jruby 1.6.8 或 jruby 1.7.x！

很棒的表现。

我们遇到了同样的问题，而且现在速度非常快（只需切换版本）。

# javascript - 如何在 jQuery 中加载页面 html 和内容（例如图像）？

> ID：10252301
> 
> 赞同：3
> 
> 时间：2012-04-20T19:22:20.487
> 
> 标签：javascript, jquery, html

在 jQuery 中，我知道我可以使用 $.ajax 函数从给定的 URL 加载页面的 html。但是，我有兴趣在显示之前加载该页面上的 html 和所有*资源*。我该怎么做呢？

示例：假设我在名为 about.html 的文件中有以下 html

```
<h1>About BigImage</h1>
<img src="/images/reallybigimage.jpg" /> 
```

请注意，我在此页面中有一张图片。使用 jQuery 的 ajax 函数，我会在 HTML 完成加载后立即获得“成功”，但不是图像。

不过，这是最重要的：我不知道页面中有多少/哪些图像，而且不仅仅是我想要加载的图像——它是页面的所有资源——css 和所有。有什么办法可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:31:45.350

在成功回调中，将 html 转换为文档片段，然后选择要预加载的部分并预加载它们。我不会包含执行实际预加载的代码，因为这应该是它自己的问题，并且已经存在可以做到这一点的插件。

```
$.ajax(options).done(function(html){
    var $html = $(html),
        imgArr = $.map($html.find("img"),function(img) {
           return this.src;
        }),
        cssArr = $.map($html.find("link"),function(link) {
           return this.href;
        });
    // loop through and preload images and css.
    ...
    // once all are done loading, append to page.
    $("#content").html($html);
}); 
```

您不需要预加载脚本，但是您可能希望在附加内容后分离它们并将它们附加到正文中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:31:32.840

如果相对路径不是问题，那么在您的`success`函数中，您可以尝试查找所有链接并像这样加载它们：

```
//....
success:function(data){
    $("*",data).each(function(){
        if($(this).attr("src")){
            $.ajax({url:$(this).attr("src"),dataType:"text"});
        }
        if($(this).attr("href")){
            $.ajax({url:$(this).attr("href"),dataType:"text"});
        }
    });
}
//.... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:38:58.370

这取决于您下载的内容（或您对格式的确定程度）。这也取决于您要下载什么。

例如，您可以使用 RegExp 之类的`/<img[^>]*src(["'])([^"']+)\1[^>]*>/g`。然后你可以简单地使用像`function (a, q, src){var i = new Image(src)}`.

您还可以将下载的文档片段附加到 DOM 文档片段并使用 DOM 处理它。这可能会消耗更多资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:25:05.507

你在找这个吗？

```
 $("body").load("page.html") 
```

（编辑：）或者你想将页面内容存储到一个变量中？这可以通过 $.ajax 实现：

```
 $.ajax({
      url: "page.html",
      dataType: 'html',
      success: function(data) {
var pagecontents = data;

}
    }); 
```

# python - 在 cygwin 上编译 PyPy

> ID：10252304
> 
> 赞同：2
> 
> 时间：2012-04-20T19:22:37.000
> 
> 标签：python, gcc, cygwin, pypy

我正在尝试在cygwin上编译PyPy，当python尝试打开刚刚用gcc编译的文件“externmod”时编译停止。cygwin 上 gcc 的问题在于，它会自动将“.exe”附加到您正在编译的任何内容中，因此即使 gcc 被称为`gcc -shared -Wl,--enable-auto-image-base -pthread -o /tmp/usession-release-1.8/shared_cache/externmod`，输出文件最终也会被`externmod.exe`忽略。所以 python 试图打开`/tmp/usession-release-1.8/shared_cache/externmod`并且找不到它 - 因此编译停止。除了重新编译 gcc，任何人都知道如何解决这个问题？我不想那样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T22:53:01.640

在进行了很多更改之后，我设法编译了它。

1.  PyPy 没有为 Cygwin 提供配置。如上所述，我复制了 Linux 配置并根据需要进行了修改。特别是我删除了 -pthread 标志，--export-dynamic C 链接器标志应该是--export-all-symbols。这也是指定文件扩展名（.exe、.dll）的地方。
2.  Cygwin 没有在 tm 结构中实现 tm_gmtoff 和 tm_zone 字段，它们是 POSIX 标准的 GNU 扩展。PyPy 使用这些字段来确定时区。我实施了解决方法。使用这些 tm 字段包含了几个必须更改的文件。
3.  在 Cygwin 下，系统调用 waitpid() 期望插槽 2 的参数类型与 PyPy 使用的不同。我实现了一个重新映射参数的包装器。
4.  在 Cygwin 下，curses C 头文件在 ncurses 下。

[您可以在http://www.tux.org/~mayer/cygwin/pypy](http://www.tux.org/~mayer/cygwin/pypy)找到 cygwin 的补丁和说明

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T16:59:42.127

要回答您的问题，解决问题的最简单方法是修改pypy/translator/platform 中的**init** .py ，使其指向实际平台，而不是现在得到的“无”。在 linux.py 中，您会注意到有一行 `so_ext = 'so' '，这可能是解决扩展问题的原因。

请注意，尽管假装 cygwin 是 linux 的小技巧可以在这个确切的实例中工作，但稍后会有一些道路颠簸会让你受益（不幸的是，我记得没有足够的细节来避免）。

编辑：我的 init.py 的相关部分目前看起来像

```
if sys.platform == 'cygwin':
    from pypy.translator.platform.linux import Linux, Linux64
    import platform
    if platform.architecture()[0] == '32bit':
        host_factory = Linux
    else:
        host_factory = Linux64
elif sys.platform.startswith('linux'): 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:59:46.790

Windows 需要“.exe”扩展名才能知道它是可执行的。您需要修改构建以查找 Windows 并使用 .exe 扩展名。

# python - nginx uwsgi 和 cgi python 脚本

> ID：10252306
> 
> 赞同：5
> 
> 时间：2012-04-20T19:22:47.597
> 
> 标签：python, nginx, cgi, uwsgi

我遇到了问题。我有一个 python 脚本。您可以将其称为 CGI 脚本。它在 Apache2 下工作正常，但在我关闭系统之前只剩下一个它永远运行。新系统使用 nginx。在搜索解决方案时，我已经按照许多人的建议配置了 uwsgi，并为该脚本配置了虚拟主机以运行。我在[uwsgi wiki](http://projects.unbit.it/uwsgi/wiki/Quickstart)上使用了第一个示例来确认我已经正确配置了 nginx 并且它可以与 uwsgi 通信。像魅力一样工作。

现在我的并发症：

我的脚本是前段时间编写的，不是为 WSGI 设计的，我也不想/不能重写它。

所以我为 uwsgi 安装了 cgi 模块并尝试使用它。我得到的只是 502 错误。uwsgi 没有执行任何操作。

这是我用于此应用的配置：

```
[uwsgi]
plugins = cgi
socket = 127.0.0.1:9010
cgi = /=/usr/share/test/
cgi-allowed-ext = .py
cgi-helper = .py=python 
```

这是我在 index.py （测试脚本）中的代码：

```
#!/usr/bin/python
print "Content-type: text/html\n\n"
print "<html><body><h1>It works!</h1></body></html>" 
```

我尝试使用以下命令测试 uwsgi：

```
/usr/sbin/uwsgi --http :9011 --ini /etc/uwsgi/test.ini --master 
```

这是我得到的输出：

```
[uWSGI] getting INI configuration from /etc/uwsgi/test.ini
*** Starting uWSGI 1.1.2 (64bit) on [Fri Apr 20 15:26:33 2012] ***
compiled with version: 4.4.6 20110731 (Red Hat 4.4.6-3) on 19 April 2012 15:09:37
current working directory: /home/user
detected binary path: /usr/sbin/uwsgi
your memory page size is 4096 bytes
detected max file descriptor number: 1024
lock engine: pthread mutexes
uWSGI http bound on :9011 fd 3
uwsgi socket 0 bound to TCP address 127.0.0.1:9010 fd 6
your server socket listen backlog is limited to 100 connections
*** Operational MODE: single process ***
initialized CGI mountpoint: / = /usr/share/test/
*** no app loaded. going in full dynamic mode ***
*** uWSGI is running in multiple interpreter mode ***
spawned uWSGI master process (pid: 6727)
spawned uWSGI worker 1 (pid: 6728, cores: 1)
spawned uWSGI http 1 (pid: 6729)
-- unavailable modifier requested: 0 --
-- unavailable modifier requested: 0 --
-- unavailable modifier requested: 0 --
-- unavailable modifier requested: 0 -- 
```

问题出在哪里？请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T14:02:24.183

行。我没有读足够好的[uwsgi WIKI](http://projects.unbit.it/uwsgi/wiki/CGI)。我所要做的就是添加`--http-modifier1 9`到命令行开关或`uwsgi_modifier1 9;`nginx 配置。

```
location / {
     include /etc/nginx/uwsgi_params;
     uwsgi_modifier1 9;
     uwsgi_pass 127.0.0.1:9010;
}

/usr/sbin/uwsgi --http :9011 --http-modifier1 9 --ini /etc/uwsgi/test.ini --master 
```

# php - php mysql 将结果显示为下拉列表

> ID：10252307
> 
> 赞同：1
> 
> 时间：2012-04-20T19:22:47.627
> 
> 标签：php, mysql, html

我正在努力尝试从数据库中获取结果以显示为下拉列表。

基本上我正在获取外键、它的唯一代码和它的名称/标题。我需要将其显示为下拉列表，以便正确输入到新表中

```
 $sql = "SELECT quali_code, title FROM `qualifications`  ";
    $result = mysql_query($sql, $this->connection);
    $result_array = array();
    while($r=mysql_fetch_array($result))
    {
    $result_array[$r['quali_code']][] = $r;
    }
    return $result_array; 
```

有了这个，我需要在 HTMl/PHP 中创建一个下拉列表来选择标题，但显然是存储值。有点`<list name=array[title] value=array[code] >`

目前我已经被困在一个适合我的数组中返回我的 SQl 结果，并且不知道如何使用正确的数组结果填充下拉列表。

上面的示例代码说明了我如何获取 sql 结果以及我的数组的外观：

```
Array ( [AAT] => Array ( [0] => Array ( [0] => AAT [quali_code] => AAT [1] => AAT qualification [title] => AAT qualification ) ) [A_lev] => Array ( [0] => Array ( [0] => A_lev [quali_code] => A_lev [1] => A levels [title] => A levels ) ) [HNC] => Array ( [0] => Array ( [0] => HNC [quali_code] => HNC [1] => Fdsc/HNC [title] => Fdsc/HNC ) ) [Lan_ISLT] => Array ( [0] => Array ( [0] => Lan_ISLT [quali_code] => Lan_ISLT [1] => EISLT Qualification [title] => EISLT Qualification ) ) [Lan_qua] => Array ( [0] => Array ( [0] => Lan_qua [quali_code] => Lan_qua [1] => Language qualification [title] => Language qualification ) ) [Nat_Dip] => Array ( [0] => Array ( [0] => Nat_Dip [quali_code] => Nat_Dip [1] => National Diploma [title] => National Diploma ) ) ) 
```

请记住，我对 PHP 完全陌生。任何帮助，将不胜感激。但是这个数组对我来说看起来没用，并且不确定如何填充列表。我获取结果/数组的文件不是我将数组填充到列表中的位置。

非常感谢您对此事的任何提示

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:26:12.850

假设您要做的就是将这些行回显到下拉列表中：

```
$sql = "SELECT quali_code, title FROM `qualifications` ORDER BY title ";
$result = mysql_query($sql, $this->connection);
while($r=mysql_fetch_array($result))
{
$quali_code = $r['quali_code'];
$result_array[$quali_code][] = $r['title'];
}

echo "<select name='x'>";
foreach($result_array as $q_code => $value)
{
    foreach($value as $title) {
    echo "<option value='" . $q_code . "'>" . $title . "</option>";
    }
}
echo "</select>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:34:59.080

自从我使用 PHP 以来已经有一段时间了，但是，我记得这是我从 MySQL 查询中打印列的方式。在 while 循环中使用 $r["columnName"]。可能存在语义错误，但这应该给你一个很好的主意。

```
 echo "<select>";
 while($r = mysql_fetch_array($result))
 {
    echo "<option value=\".$r['quali_code'].\">.$r['title'].</option>";
 }
 echo "</select>"; 
```

我使用[http://www.tizag.com/phpT/](http://www.tizag.com/phpT/)自学 PHP。他们有很多很棒的教程。这是关于 Tizag 的 MySQL/PHP 教程的链接：[http](http://www.tizag.com/mysqlTutorial/) ://www.tizag.com/mysqlTutorial/ 。

快乐编码。

# php - 基于 AJAX/PHP 的大文件上传，带有进度条

> ID：10252309
> 
> 赞同：3
> 
> 时间：2012-04-20T19:23:03.750
> 
> 标签：php, ajax, file, upload, progress

我一直在尝试创建一个非 Flash 上传面板，该面板还显示一个进度条。在我们的服务器上，我们有 PHP 5.3（目前无法升级到 5.4，因此无法使用新的上传进度功能 => [http://php.net/manual/en/session.upload-progress.php](http://php.net/manual/en/session.upload-progress.php)）。我们不能使用基于闪存的解决方案、扩展或类似的。

因此，我尝试将 XMLHttpRequest 与 AJAX 结合使用。这里的问题是我只取得了部分成功。

我已经设法在服务器上上传并保存了一个大约 380 MB 的文件，但是，当尝试使用 4 GB 等更大的文件时，它不会保存在服务器上（如果我在某个时间点与 Firebug 进行检查，它会说“POST中止”）。

另一个奇怪的事情是，对于同一个文件，xhr.upload.loaded 以 xhr.upload.total 的相同维度开始，并从那里开始计数。

有谁知道如何解决这个问题或有替代解决方案？

客户端代码为：

```
<script type="application/javascript" src="jquery.js"></script>

<script type="application/javascript">

function uploadToServer()
{
    fileField = document.getElementById("uploadedFile");
    var fileToUpload = fileField.files[0]; 

    var xhr = new XMLHttpRequest();
    var uploadStatus = xhr.upload;

    uploadStatus.addEventListener("progress", function (ev) {
            if (ev.lengthComputable) {
                $("#uploadPercentage").html((ev.loaded / ev.total) * 100 + "%");
            }
        }, false);

    uploadStatus.addEventListener("error", function (ev) {$("#error").html(ev)}, false);
    uploadStatus.addEventListener("load", function (ev) {$("#error").html("APPOSTO!")}, false);

    xhr.open(
            "POST",
            "serverUpload.php",
            true
            );
        xhr.setRequestHeader("Cache-Control", "no-cache");
        xhr.setRequestHeader("Content-Type", "multipart/form-data");
        xhr.setRequestHeader("X-File-Name", fileToUpload.fileName);
        xhr.setRequestHeader("X-File-Size", fileToUpload.fileSize);
        xhr.setRequestHeader("X-File-Type", fileToUpload.type);
        //xhr.setRequestHeader("Content-Type", "application/octet-stream");
        xhr.send(fileToUpload);
}

$(function(){

    $("#uploadButton").click(uploadToServer);

});

</script> 
```

HTML部分：

```
<form action="" name="uploadForm" method="post" enctype="multipart/form-data">

  <input id="uploadedFile" name="fileField" type="file" multiple />

<input id="uploadButton" type="button" value="Upload!">

</form>

<div id="uploadPercentage"></div>
<div id="error"></div> 
```

服务器端代码：

```
<?php

$path = "./";
$filename = $_SERVER['HTTP_X_FILE_NAME'];
$filesize = $_SERVER['CONTENT_LENGTH'];

$file = "log.txt";
$fo= fopen($file, "w");
fwrite($fo, $path . PHP_EOL);
fwrite($fo, $filename . PHP_EOL);
fwrite($fo, $filesize . PHP_EOL);
fwrite($fo, $path . $filename . PHP_EOL);

file_put_contents($path . $filename, 
file_get_contents('php://input')
);

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-08T14:16:19.600

其他人已经指出，在任何正确配置的生产 PHP 服务器上都会遇到一些限制。内存、帖子和文件的最大值开始。此外，httpd 服务通常也会限制这些。

上传这么大的答案是将文件切成块，将每个块发送到不同的 put 或 post（取决于浏览器）。

已经存在一个能够上传块文件的库，所以我将使用它作为示例。为了支持分块上传，上传处理程序使用 Content-Range 标头，该标头由插件为每个块传输。

UploadHandler 类中的 handle_file_upload 函数是一个很好的例子，说明了如何使用 PHP 在服务器端处理分块文件上传。-- [https://github.com/blueimp/jQuery-File-Upload/blob/master/server/php/UploadHandler.php](https://github.com/blueimp/jQuery-File-Upload/blob/master/server/php/UploadHandler.php)

```
function handle_file_upload($uploaded_file, $name, $size, $type, $error,
        $index = null, $content_range = null) 
```

该函数接受`$content_range = null`在 HTTP 标头中传递给服务器的参数，并从`$_SERVER['HTTP_CONTENT_RANGE'];`

稍后我们需要确定是否要将文件上传附加到已经存在的文件中，因此我们设置了一个变量。如果 HTTP 请求报告的文件大小大于服务器上的实际文件大小，则`$content_range`变量不为 NULL 并且文件存在，我们需要将此上传附加到现有文件。

```
$append_file = $content_range && is_file($file_path) &&
            $file->size > $this->get_file_size($file_path); 
```

伟大的！怎么办？

所以现在我们需要知道我们是如何接收数据的。旧版本的 Firefox 不能使用 multipart/formdata (POST) 进行分块文件上传。客户端和服务器端都需要以不同方式处理这些请求。

```
 if ($uploaded_file && is_uploaded_file($uploaded_file)) {
            // multipart/formdata uploads (POST method uploads)
            if ($append_file) {
            // append to the existing file
                file_put_contents(
                    $file_path,
                    fopen($uploaded_file, 'r'),
                    FILE_APPEND
                );
            } else {
            // this is a new chunked upload OR a completed single part upload,
            // so move the file from the temp directory to the uploads directory.
                move_uploaded_file($uploaded_file, $file_path);
            }
        } 
```

**根据文档：**只有支持 XHR 文件上传和 Blob API 的浏览器才支持分块文件上传，其中包括 Google Chrome 和 Mozilla Firefox 4+ -- [https://github.com/blueimp/jQuery-File-Upload /wiki/分块文件上传](https://github.com/blueimp/jQuery-File-Upload/wiki/Chunked-file-uploads)

要在 Mozilla Firefox 4-6（Firefox 7 之前支持 XHR 上传的 Firefox 版本）中进行分块上传，还必须将 multipart 选项设置为 false。这是在服务器端处理这些情况的代码。

```
 else {
            // Non-multipart uploads (PUT method support)
            file_put_contents(
                $file_path,
                fopen('php://input', 'r'),
                $append_file ? FILE_APPEND : 0
            );
        } 
```

最后我们可以验证下载是否完成，或者丢弃取消的上传。

```
 $file_size = $this->get_file_size($file_path, $append_file);
        if ($file_size === $file->size) {
            $file->url = $this->get_download_url($file->name);
            if ($this->is_valid_image_file($file_path)) {
                $this->handle_image_file($file_path, $file);
            }
        } else {
            $file->size = $file_size;
            if (!$content_range && $this->options['discard_aborted_uploads']) {
                unlink($file_path);
                $file->error = $this->get_error_message('abort');
            }
        } 
```

在客户端，您将需要跟踪块。每张贴完后，我们发送下一部分，直到没有更多的块。示例库是一个 jQuery 插件，非常简单。像您这样使用裸 XHR 对象将需要更多代码。它可能看起来像这样：

```
var chunksize = 1000000 // 1MB
var chunks = math.ceil(chunksize / fileToUpload.fileSize);

function uploadChunk(fileToUpload, chunk = 0) {
     var xhr = new XMLHttpRequest();
     var uploadStatus = xhr.upload;

     uploadStatus.addEventListener("progress", function (ev) {
            if (ev.lengthComputable) {
                $("#uploadPercentage").html((ev.loaded / ev.total) * 100 + "%");
            }
        }, false);

     uploadStatus.addEventListener("error", function (ev) {$("#error").html(ev)}, false);
     uploadStatus.addEventListener("load", function (ev) {$("#error").html("APPOSTO!")}, false);

     var start = chunksize*chunk;
     var end = start+(chunksize-1)
     if (end >= fileToUpload.fileSize) {
            end = fileToUpload.fileSize-1;
     }

     xhr.open(
            "POST",
            "serverUpload.php",
            true
     );
     xhr.setRequestHeader("Cache-Control", "no-cache");
     xhr.setRequestHeader("Content-Type", "multipart/form-data");
     xhr.setRequestHeader("X-File-Name", fileToUpload.fileName);
     xhr.setRequestHeader("X-File-Size", fileToUpload.fileSize);
     xhr.setRequestHeader("X-File-Type", fileToUpload.type);
     xhr.setRequestHeader("Content-Range", start+"-"+end+"/"+fileToUpload.fileSize);
     xhr.send(fileToUpload);
}

for(c = 0; c < chunks; c++) {
     uploadChunk(fileToUpload, c);
} 
```

遍历块，依次上传每个块范围。请注意， Content-Range 标头值的格式为*start-end/size*。范围从 0 开始，因此*"end"*只能是比*"size"*小 1 的最大值。您可以使用范围*"start-"*来指示范围从*"start"*延伸到文件末尾。

**编辑：**

只是认为这可以在服务器上实现一个进度条，否则单个文件上传是不可能的。由于您知道每个块的大小以及每个请求的状态，因此您可以在每次循环运行时相应地更新状态栏。

另外值得注意的是某些浏览器的限制。Chrome 和 Firefox 应该能够处理 4GB 的文件，但 IE 低于 9 的版本有一个错误，无法处理大于 2GB 的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T03:35:30.503

PHP 无法更改与 Web 服务器相关的限制。例如，它们是 IIS 中 30MB 的默认最大发布请求大小......还有一个您可能会遇到的最大超时。与大小无关，但您的发布请求需要多长时间......即文件提交需要多长时间。这两种设置都可以受 IIS 或 Apache 的约束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T10:26:55.863

您可以将您的代码与本教程进行比较。本教程能够上传任何大小的文件。它与您的代码非常相似。 [http://www.youtube.com/watch?v=pTfVK73CUk8](http://www.youtube.com/watch?v=pTfVK73CUk8)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-19T13:09:53.293

我正在写 xhr.upload.loaded 的奇怪行为，它以大量开头......

我有类似的问题，我找不到原因。可能有帮助的唯一线索是，根据 ISP，问题有时会消失！例如，当我在家测试时，它工作正常，我没有看到这种奇怪的行为，但在工作互联网上，问题仍然存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T20:58:40.997

file_get_contents() 获取文件的内容，并使用内部指针将其放入 RAM 中的 BUFFER 中。如果您没有足够的内存，或者有 32 位版本的 apache/php，则在尝试分配过多内存时可能会崩溃。

您可能想尝试这样的事情：

```
$upload = fopen("php://input", "r");
while (!feof($upload)) {
    file_put_contents($path . $filename, fread($upload, 4096), FILE_APPEND);
}
fclose($upload); 
```

干杯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-23T10:26:19.277

我尝试使用 ajax 上传 4GB 的视频文件。这是成功的。这是我的代码。

HTML ::

```
<form enctype="multipart/form-data" method="post">
<input type="file" id="video_file" name="video_file" accept=".mp4, .avi, .mkv">
<input type="submit" class="btn btn-success" id="video-upload-btn" name="video_upload_btn" value="Upload">
<div class="video-bar">
    <span class="video-bar-fill" id="video-bar-fill-id"><span class="video-bar-fill-text" id="video-bar-fill-text-id"></span></span>
</div>
</form> 
```

CSS ::

```
.video-bar{
    width: 100%;
    background: #eee;
    padding: 3px;
    margin-bottom: 10px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
    border-radius: 3px;
    box-sizing: border-box;
}

.video-bar-fill{
    height: 20px;
    display: block;
    background: cornflowerblue;
    width: 0;
    border-radius: 3px;
    transition: width 0.8s ease;
}
.video-bar-fill-text{
    color: #fff;
    padding: 3px;
} 
```

阿贾克斯 ::

```
<script type="text/javascript">
    var app = app || {};

    (function(video_op){
        "use strict";

        var video_ajax, video_getFormData, video_setProgress;

        video_ajax = function(data){

            var xmlhttp = new XMLHttpRequest(), uploaded;

            xmlhttp.addEventListener('readystatechange', function(){
                if(this.readyState==4){
                    if(this.status==200){
                        uploaded = JSON.parse(this.response);
                        console.log(uploaded);

                        if(typeof video_op.options.finished==='function'){
                            video_op.options.finished(uploaded);
                        }
                    } else {
                        if(typeof video_op.options.error === 'function'){
                            video_op.options.error();
                        }
                    }
                }
            });

            xmlhttp.upload.addEventListener("progress", function(event){
                var percent;
                if(event.lengthComputable===true){
                    percent = Math.round((event.loaded / event.total) * 100);
                    video_setProgress(percent);
                }

            });

            if(video_op.options.videoProgressBar!==undefined){
                video_op.options.videoProgressBar.style.width=0;
            }
            if(video_op.options.videoProgressText!==undefined){
                video_op.options.videoProgressText.innerText=0;
            }

            xmlhttp.open("post", video_op.options.videoProcessor);
            xmlhttp.send(data);

        };

        video_getFormData = function(source1){
            var data = new FormData(), i;

            for(i=0;i<source1.length; i++){
                data.append('video_file', source1[i]);
            }

            data.append("ajax", true);

            return data;

        };

        video_setProgress = function(value){
            if(video_op.options.videoProgressBar!==undefined){
                video_op.options.videoProgressBar.style.width = value? value+"%":0;
            }
            if(video_op.options.videoProgressText!==undefined){
                video_op.options.videoProgressText.innerText=value?value+"%":0;
            }
        };

        video_op.videouploader = function(options){
            video_op.options = options;

            if(video_op.options.videoFiles !== undefined){
                var videoFormDataValue = video_getFormData(video_op.options.videoFiles.files);

                video_ajax(videoFormDataValue);
            }
        }

    }(app));

    document.getElementById("video-upload-btn").addEventListener("click", function(e){
        e.preventDefault();

        document.getElementById("video-upload-btn").setAttribute("disabled", "true");

        var videof = document.getElementById('video_file'),
            videopb = document.getElementById('video-bar-fill-id'),
            videopt = document.getElementById('video-bar-fill-text-id');

        app.videouploader({
            videoFiles: videof,
            videoProgressBar: videopb,
            videoProgressText: videopt,
            videoProcessor: "upload.php",

            finished: function(data){
                console.log(data);

            },

            error: function(){
                console.log("error");
            }
        });
    });
</script> 
```

服务器端 ：：

```
<?php
    if(!empty($_FILES["video_file"]))
    {
        if(!empty($_FILES["video_file"]["error"]))
        {
            if(move_uploaded_file($_FILES["video_file"]["tmp_name"], __DIR__."/".$_FILES["video_file"]["name"] ))
            {
                echo "success";
            }
            else
            {
                echo "failed";
            }
        }
        else
        {
            echo "error";
        }

    }
?> 
```

还要更改下面列出的 php ini 值。

1.  post_max_size
2.  上传最大文件大小

如果您使用的是 linux/ubuntu - 请按照以下步骤操作

```
Open php ini file - 
sudo nano /etc/php5/apache2/php.ini

Update these values-
post_max_size = 6000M
upload_max_filesize = 6000M

restart apache
sudo /etc/init.d/apache2 restart 
```

# java - 在java，android中使用循环计数器访问变量

> ID：10252312
> 
> 赞同：0
> 
> 时间：2012-04-20T19:23:19.287
> 
> 标签：java, android, loops, counter

如何在循环中使用计数器访问声明的变量，如下所示：

声明的变量：

```
Button square0, square1, square2, square3, square4, square5, square6,
        square7, square8, temp; 
```

使用这样的循环访问它们：

```
for (int i = 0; i < 9; i++) {
    (Button) ("square"+i).setBackgroundResource(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:23:59.540

你不能不求助于一些非常可疑的魔法（我什至认为你不能用 Java 中的反射来做到这一点）。

请改用[数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:27:26.760

这很容易...

```
Button[] btnArray = new Button[10]; 
 //assign all squares to the array 
btnArray[0] = square1;
for(Button btn : btnArray){
btn.setBackGroundResource();
} 
```

甚至更好地使用 List 之类的

```
List<Button> myBtnList = new ArrayList<Button>();
myBtnList.add(square1); 
```

添加直到添加所有按钮，然后使用 for each 循环，如上图所示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:31:02.340

正如其他人所提到的，这在任何编程语言中都是不好的做法。如果您想访问事物列表（在您的情况下`Buttons`），您应该使用[List](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)或[Array](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)。

`ArrayList`这是一个使用of的示例`Buttons`：

```
List<Button> buttonList = new ArrayList<Button>();

Button button1 = new Button();
Button button3 = new Button();
Button button2 = new Button();

buttonList.add(button1);
buttonList.add(button2);
buttonList.add(button3);

// How to get a button out
for(int i = 0; i < buttonList.size(); i++)
    myButton = buttonList.get(i);
    // Do something with myButton here.
} 
```

# c# - 让入侵者射击

> ID：10252314
> 
> 赞同：0
> 
> 时间：2012-04-20T19:23:25.073
> 
> 标签：c#, xna

我添加了一个专门用于导弹的类。代码如下所示：

```
 class Missile
    {
        Vector2 Position;

        public Missile(int XInitialPos, int YInitialPos)
        {
            Position = new Vector2(XInitialPos, YInitialPos);
        }

        public void Move()
        {
            Position.Y = Position.Y - 8;
        }
        public void MoveMissile()
        {
            Position.Y = Position.Y + 8;
        }

        public Vector2 GetPosition()
        {
            return Position;
        } 
```

}

我知道如何调用 move 方法使发射器射击，但是，我不知道如何随机调用某些东西来使入侵者射击。任何帮助，将不胜感激。谢谢你。

```
code which invokes launcher to shoot in the update method:
 if (MissileFired != null && MissileFired.GetPosition().Y < 20) MissileFired = null;

            if (Keyboard.GetState().IsKeyDown(Keys.Space) && MissileFired == null)
            {
                MissileFired = new Missile(LauncherXPos, 650);
             } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:31:15.580

您可以向入侵者添加一个名为`ShouldShootMissile`. 它可能应该将您的游戏时间表示为参数（可能是一个`double`或一个 XNA`GameTime`对象）。此函数将返回一个`bool`.

然后它可以使用这些信息来根据各种因素决定入侵者是否有资格发射导弹。这些因素可能是一个常数因素，表示它可以发射的最大速率（每 500 毫秒一次），然后是一个可变性（250 毫秒）。您可以使用标准随机数生成器来计算可变性并根据这些条件返回真或假。

也许是这样的：

```
 Random rand = new Random();
    double lastMissileFired = 0d;

    private bool ShouldFireMissile(double time)
    {
        double fixedDelay = 500d;
        double firingProbability = 0.1d

        if (time - lastMissileFired < fixedDelay)
            return false;

        if (rand.NextDouble() > firingProbability)
            return false;

        lastMissileFired = time;
        return true;
    } 
```

警告，上面的代码可能有很多问题，几乎可以肯定不会完全适合您的程序，但希望这能让您更清楚地了解我的意思。我决定将 250ms 可变延迟更改为它会触发的概率。

您将在每次更新入侵者时运行上面的代码

```
if (invader.ShouldFireMissile())
    invader.FireMissile(); 
```

# file - 让 foreach 不拆分文件

> ID：10252318
> 
> 赞同：1
> 
> 时间：2012-04-20T19:23:34.087
> 
> 标签：file, unix, foreach, shift

我的程序旨在将第一个参数作为扩展名，然后将其余参数作为要搜索的文件，如果找到，则由扩展名修改。如果未找到，则打印错误。

一切都很好，直到：./chExt.sh 'com' 'king cobra.dat'

其中 $file 将这两个词分成 'king' 和 'cobra.dat' 然后分别运行它们。我需要将它作为一个整体读入 $file 中的“king cobra.dat”。

我听说过一些关于使用“shift”让它整体阅读的信息，但我不确定如何实现它。

```
#!/bin/csh                                                                   \

set ext="$1"
shift

echo the remaining are $*
foreach file ($*)
echo $file
if (-r "$file") then
set newName=`echo "$file" | sed 's/\.[A-Za-z0-9]*$/'".$ext"'/g'`
echo $newName
if ( "$file" == "$newName" ) then
:
else
mv "$file" "$newName"
endif
end
else
echo "$file": No such file
end
endif 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T02:32:58.717

Csh 有一些独特的变量修饰符，参见[grymoire csh var :q (quote) modifier](http://www.grymoire.com//Unix/Csh.html#toc-uh-92)

对于你的情况，你可以做

```
foreach file ($*:q)
echo $file:q
if (-r $file:q) then
set newName=`echo $file:q | sed 's/\.[A-Za-z0-9]*$/'".$ext"'/g'`
echo $newName:q
 ..... 
```

不幸的是，我没有 csh 来测试它，您可能会发现需要放回一些 dbl 引用的变量，或者至少是可行的。

我希望这有帮助。

# flash - 重新定位 Flex 按钮的问题

> ID：10252319
> 
> 赞同：0
> 
> 时间：2012-04-20T19:23:36.590
> 
> 标签：flash, apache-flex, builder

我已经彻底清除了我能找到的所有资源，以确定我遇到的问题的解决方案。基本上，我无法重新指定任何按钮的 x 或 y 位置（通过源代码或设计）。如果你们中的任何人可以建议我如何解决这个问题，我将不胜感激。谢谢你。:)

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application 
    xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:local="*" 
    frameRate="999" 
    creationComplete="init();"
    >
    <mx:Style source="Whistle.css"/>
    <!--local:whistle id="myWhistle"/-->
        <mx:Label text="=" width="13" fontWeight="bold" fontSize="15"/>
        <mx:Text text="{tempo_slider.value}" width="30"/>

    <mx:Button id="stop" icon="@Embed(source='../assets/media-playback-stop.png')"
        click="{if (playPause.selected) {player.stop();playPause.selected=false;}}"/>
    <mx:Button id="playPause" width="40"

               click="{if (playPause.selected) player.play(); else player.pause();}"
               downIcon="@Embed(source='../assets/media-playback-pause.png')" labelPlacement="top"
               overIcon="@Embed(source='../assets/media-playback-start.png')"
               selectedDownIcon="@Embed(source='../assets/media-playback-start.png')"
               selectedOverIcon="@Embed(source='../assets/media-playback-pause.png')"
               selectedUpIcon="@Embed(source='../assets/media-playback-pause.png')" toggle="true"
               upIcon="@Embed(source='../assets/media-playback-start.png')"/>
    <mx:Button id="loop" toggle="true"

        icon="@Embed(source='../assets/view-refresh.png')"
        change="{player.loop=loop.selected;}"/>

    <!--<mx:Label text="midiFileURL={midiFileURL}" />-->

    <mx:Script>
        <![CDATA[
            //[Bindable]
            private var midiFileURL:String;
            import mx.core.FlexGlobals;
            import com.knet.Player;
            private var player:Player;
            private function init():void {
                midiFileURL=FlexGlobals.topLevelApplication.parameters.midiFileURL;
                //midiFileURL="http://www.reveeveille.net/audio/gavotte_yves_menez_0.mid";
                //midiFileURL="../assets/gavotte_yves_menez_0.mid";
                //midiFileURL="../assets/bwv806b.mid";
                //midiFileURL="../assets/gavotte_de_audiern.mid";
                //midiFileURL="../assets/an_alarch.mid";
                //midiFileURL="../assets/Another_Jig_Will_Do.mid";
                midiFileURL="../assets/bro_goz.mid";
                //midiFileURL="../assets/derobee_de_guingamp.mid";
                //midiFileURL="../assets/Evit_Farsal_waltz.mid";
                //midiFileURL="../assets/mtsofmourne.mid";
                //midiFileURL="../assets/andro_traditionnel_09.mid";
                player=new Player(/*myWhistle,*/tempo_slider,  midiFileURL);
            }
        ]]>
    </mx:Script>
    </mx:Application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:12:51.577

要么在应用程序标签中使用 layout="absolute"，要么将按钮放在画布容器中，然后使用 x,y 属性定位它们。

当您不使用绝对值或使用 HBox VBox 之类的控件时，设置 x,y 值不会执行任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T12:50:02.813

如果您没有为应用程序指定布局，则默认为“垂直”。所以在“垂直”布局中，您不能将组件放置在所需位置；要实现这一点，您需要将应用程序布局指定为绝对，这样它就可以工作。

# html - 如何在 div 中居中块级链接

> ID：10252321
> 
> 赞同：1
> 
> 时间：2012-04-20T19:23:47.027
> 
> 标签：html, css, centering

这看起来非常简单，但由于某种原因，我正在为此苦苦挣扎。我有一些控制 jQuery 内容滑块的链接。链接需要在滑块底部居中。链接的文本是通过我正在使用的 jQuery 插件设置的，所以我只是`text-indent: -9999px`用来隐藏它并显示背景图像。每个链接都设置为块和 10 像素宽和高。但是我不能让它们在 div 中居中。这是我想要做的一个小图表。

| • • • |

3 个项目符号代表我想要居中的链接。无论我有 2 个链接还是 10 个链接，我都希望它们居中。如果我有一定数量的链接，这可能会容易得多，因为我可以创建一个具有固定宽度的父级并`margin:0 auto;`在其上使用。

到目前为止，这是我的代码...

HTML..

```
<div id="pager">
  <a href="#slide1">1</a>
  <a href="#slide2">2</a>
  <a href="#slide3">3</a>
</div> 
```

CSS..

```
#pager {float:left; width:100%; display: block; text-align: center;}

#pager a {display:block; width:10px; height:10px; float:left; background-image: url(img/pager-off.gif); text-indent: -9999px; background-color: red; background-repeat: no-repeat;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:35:35.040

我要这个？

[http://jsfiddle.net/oswaldoacauan/phXvv/](http://jsfiddle.net/oswaldoacauan/phXvv/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:33:55.727

看看这个 jsfiddle

[http://jsfiddle.net/h2r6c/](http://jsfiddle.net/h2r6c/)

我为链接添加了边距，以便查看它们的开始和结束位置。除此之外，去掉`float:left`链接中的 CSS 就可以了，只要它们不是块级的。他们需要`display:inline-block`像你想要的那样并排。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:34:05.537

如果居中是指每个都居中在容器的中间，因此彼此堆叠在一起，请不要漂浮。关键是margin:auto

```
#pager a {
    display:block; 
    width:10px; height:10px; 
    margin:auto
    background-image: url(img/pager-off.gif); 
    background-color: red; 
    background-repeat: no-repeat;
} 
```

但是，如果您的意思是每个链接都是并排的，并且它们在容器中间作为一个集合居中，则在链接上使用 display:inline-block，在链接上使用 text-align:center容器：

```
#pager a {
    display:inline-block; 
    width:10px; height:10px; 
    background-image: url(img/pager-off.gif); 
    background-color: red; 
    background-repeat: no-repeat;
}
#pager{
    text-align:center; 
```

# c++ - C ++中一元运算符重载的困难？

> ID：10252322
> 
> 赞同：2
> 
> 时间：2012-04-20T19:23:47.190
> 
> 标签：c++, operator-overloading

我只是在阅读有关使用减号（-），增量（++）等的一元运算符重载的信息。我想写一个相同的代码只是为了练习。但是当我尝试运行它时，它给了我减号和增量运算符的错误。我认为问题是我在 main 中调用运算符的方式。谁能请这样做的正确方法是什么？

```
#include<iostream>

using namespace std;

class c{
   int x;
   int y;
   public:
      c(int a,int b){
             x=a;
             y=b;   
      }

      void operator -(){
             x=x+1;
             y=y+1;
      }

      void display(){
             cout<<x<<" "<<y<<"\n";
      }

};

int main()
{
     c obj(2,3);
     obj.display();
         obj- ;    //I think the error is on this line
     obj.display();
     return 0;
} 
```

如果我用 -obj 替换 obj- 代码可以正常工作。为什么会这样？同样是 ++ 运算符重载的问题（使用 ++obj 工作正常，但 obj++ 不起作用），为什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T19:26:45.787

一元减号运算`-`符只是前缀运算符。

要重载运算符的后缀版本`++`，您需要一个虚拟**int**参数。例如

```
struct foo
{
    void operator - ()
    {
        std::cout << "hello" << std::endl;
    }

    void operator ++ (int)
    {
        std::cout << "world" << std::endl;
    }
};

int main()
{
    foo bar;
    -bar;
    bar++;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:26:17.087

首先，您不能发明新的运算符，只能重新定义现有的运算符，因此您的一元后减法无法完成。后减运算符（当然）是两个减号，而不仅仅是一个。

其次，当你定义一个递增或递减运算符时，你给函数一个（未使用的）int 参数来区分前置形式和后置形式；如果函数有参数，那么它是一个后增量或后减量操作，但没有它，它是预增量/预减量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:25:48.863

一元 - 运算符是否定运算符。当你说`-5`or时会发生这种情况`-var`。你不说`5-`或`var-`。如果你在之后`var - 3`，重载二元运算符。

后自增运算符有一个虚拟 int 参数以将其与前自增运算符区分开来。

# sql - 根据行 ID SQL 合并表中的第二列

> ID：10252323
> 
> 赞同：0
> 
> 时间：2012-04-20T19:23:49.373
> 
> 标签：sql, sql-server-2008

我正在寻找一个数据库脚本，它将通过一个表并给我一个逗号分隔的输出。

我需要在一次性脚本中完成这一切。我正在考虑从仅包含 ID 的临时表开始，然后获取所有项目，但我不确定如何“foreach”数据库。

```
What I have                    What I'm looking for

 ID | Items                       ID | Items
 1  |  A                          1  | A,B,C,D
 1  |  B                          2  | A,B,C
 1  |  C                          3  | B,C
 1  |  D
 2  |  A
 2  |  B
 2  |  C
 3  |  B 
 3  |  C 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:28:52.370

可能是我的想象，但这似乎运行得更快，查询计划更容易阅读。但是，查询计划中的 xmlreader 似乎总是高估实际查询成本。

```
declare @table table (
id int
,val varchar(2)
)
insert @table
Values (1 ,'a'),
(1,'b'),
(1,'c'),
(1,'d'),
(2,'a'),
(2,'b'),
(2,'c'),
(3,'a'),
(3,'b')
select id, stuff((
select (','+val) from @table q1
    where q1.id = q2.id
    for xml path('')),1,1,'') val
    from @table q2
    group by q2.id 
```

这几乎做同样的事情，除了它通过制作没有元素规范的不正确的 xml 文档来排除 xml 的数据读取器。至于内置函数的东西，请参见[http://msdn.microsoft.com/en-us/library/ms188043.aspx](http://msdn.microsoft.com/en-us/library/ms188043.aspx) 他正在使用东西来操作字符串。如果你添加逗号，你要么得到一个结尾有一个额外逗号的字符串，要么在开头有一个逗号。此示例将字符串中从位置 1 开始的前 2 个字符替换为空白字符串''

```
select STUFF(',,test,test1,test2,test3',1,2,'') 
```

数据：

```
test,test1,test2,test3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:28:07.343

```
declare @t table(id int, items varchar(8));
insert into @t values(1,'A')
, (1,'B')
, (1,'C')
, (1,'D')
, (2,'A')
, (2,'B')
, (2,'C')
, (3,'B')
, (3,'C')

select distinct id
, (STUFF((SELECT ',' + items FROM @t t2 WHERE  t1.id = t2.id ORDER BY items
FOR XML PATH(''), TYPE, ROOT).value('root[1]','nvarchar(max)'),1,1,'')) as items
from @t t1 
```

结果：

```
id          items
----------- ------------------------
1           A,B,C,D
2           A,B,C
3           B,C 
```

# actionscript-3 - 如何阻止代码在另一个框架中工作

> ID：10252324
> 
> 赞同：0
> 
> 时间：2012-04-20T19:23:49.400
> 
> 标签：actionscript-3, flash

我有碰撞代码，可以检测我是否撞到了许多墙壁，但是当我移动到另一个框架时，即使我的墙壁被移除，它就像碰撞仍然存在。

我想如果我在进入下一帧时以某种方式停止代码，它可能会有所帮助。

我也是这方面的新手。

这是我的代码。

```
function myHitTest(obj:DisplayObject, arr:Array):Boolean {

    for (var i:int = 0; i < arr.length; ++i) {
    //for (var item:DisplayObject in arr) {
        var item:DisplayObject = arr[i]
        if (obj.hitTestObject(item)) {
            return true;
        }
    }

    return false;
}

var everywall:Array = [w1,w2,w3,w4,w5,w6,w7,w8,w9,w10,w11,w12,w13,w14,w15,w16]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:08:12.930

你可以作弊，而且只是 st `everywall = [];`。这将不再检查与 16 面墙中的任何一个的碰撞。

但这并没有解决主要问题。在这种情况下，重要的是仍有*东西*`myHitTest`在召唤。无论调用什么循环都需要退出，或者任何回调调用它都需要重构。如果您需要的不仅仅是这些提示，请提供更多代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T22:01:13.967

我确定也不是最好的方法但应该起作用的另一个选项是在检查您所在的帧之前添加一个 if 语句。类似于以下内容：

```
function myHitTest(obj:DisplayObject, arr:Array):Boolean {  

    // Check to see if the frame is the one I want the code to run on (1)
    if(currentFrame == 1) {

        for (var i:int = 0; i < arr.length; ++i) {  
        //for (var item:DisplayObject in arr) {  
            var item:DisplayObject = arr[i]  
            if (obj.hitTestObject(item)) {  
                return true;  
            }  
        }  
    }
    return false;  
} 
```

`currentFrame`是一个关键字，如果您正在寻找根的 currentFrame，您可以使用它。如果你想要一个特定的`MovieClip`，你可以使用`MovieClip.currentFrame`. 将 ==1 更改为 == 您希望在其上运行的任何帧。

# ios - UIWebview 没有打开几个 URL

> ID：10252330
> 
> 赞同：0
> 
> 时间：2012-04-20T19:24:17.613
> 
> 标签：ios, webview

我一直在 iOS 中使用 UIWebView。它显示了几页，但由于某种原因，它不会为其他人加载任何内容。它们在浏览器中打开得很好，但在 UIWebView 中却没有。在研究时，我遇到了 [error code]!=999，但我无法修复它。

有什么具体原因吗？谁能帮我解决这个问题？

尼廷

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:57:13.187

dean 可能是对的...... URL 编码问题并不总是很明显，但它确实让我在 iOS 开发的早期阶段感到非常悲痛。

# c# - 如何在 .NET 3.5+ 中为用户获取“平面”域名

> ID：10252331
> 
> 赞同：3
> 
> 时间：2012-04-20T19:24:22.990
> 
> 标签：c#, .net, active-directory, dns, directoryservices

当我们在工作中登录到我们的 Windows 机器时，我们使用“CORP\username”。

给定用户的 SID 和他们登录的域控制器，我如何派生该字符串？我正在使用 .NET 3.5 中添加的 DirectoryServices API，如下所示：

```
PrincipalContext domaincontroller = new PrincipalContext(ContextType.Domain, "192.168.30.115");
UserPrincipal user = UserPrincipal.FindByIdentity(domaincontroller, IdentityType.Sid, "S-1-5-21-293182769-1777760488-2957165303-1798"); 
```

我已经挖掘了域控制器对象和用户对象，并看到了很多这样的东西：

```
user.Name:              john smith
user.DisplayName:       john smith
user.UserPrincipalName: john.smith@corp.mycompany.com
user.SamAccountName:    john.smith 
```

**如果我深入挖掘 UserPrinciple 对象的私有内容，我会发现两个标记为“domainFlatName”和“FlatDomainName”的字段正是我想要的（下面的屏幕截图）。这些是什么意思，以及如何通过公共界面访问它们？**

![对象检查器截图](../Images/e1b81b6476c24aa6426429b6bd27bbbb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T14:58:46.913

所以这里有几个问题。Brian Desmond 已经告诉过您“domainFlatName/FlatDomainName”成员对应于域的 NETBIOS 名称（并且 NETBIOS 名称不必与 DNS 名称匹配）。

那你怎么得到它？Brian 为您提供了它在 Active Directory 中的存储位置。您也可以使用带有标志的[`DsGetDcName`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms675983%28v=vs.85%29.aspx)函数来获取它。`DS_RETURN_FLAT_NAME`.NET 中可能有这个函数的包装器，但我不知道它是什么。

但您真正的问题是如何获取“CORP\username”字符串。正如您所发现的，这很容易从`System.Security.Principal.WindowsIdentity.GetCurrent().Name`. 您也可以获取`SecurityIdentifer`对象，并调用该类型的`Translate`方法`NTAccount`并从 Value 方法中获取它。这很可能是包装[`LookupAccountName`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379159%28v=vs.85%29.aspx)or[`DsCrackNames`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms675970%28v=vs.85%29.aspx)函数。最后，可以使用构造的属性 msDS-PrincipalName 从 Active Directory 中检索此字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T18:02:18.293

不幸的是，获得这个值并非易事。您想要的属性`nETBIOSName`是存储在`crossRef`配置 NC 中表示域的对象上。

假设您知道域的 DN（例如 fabrikam.com 是 DC=fabrikam,DC=com），您可以搜索配置命名上下文`(&(objectClass=crossRef)(nCName=DC=fabrikam,DC=com))`并从中获取`nETBIOSName`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T06:55:28.983

我再次尝试使用自己的网络。我能达到的最接近的是使用 UserPrincipal.Current 的 SamAccountName 属性

然后使用 DirectorySearcher 的 SearchRoot.Name 属性，它给了我类似“DC = CORP”的结果

```
 string sFilter = String.Format("(&(objectClass=user)(objectCategory=person)(sAMAccountName={0}))", u.SamAccountName);
                DirectoryEntry de = new DirectoryEntry(adPath);
                DirectorySearcher ds = new DirectorySearcher(de, sFilter, new string[] { "distinguishedName" });
string dcName = ds.SearchRoot.Name; 
```

从 DC=CORP 中提取 CORP 并将其与 u.SamAccountName 结合是我能找到的最佳方法

知道是否仍然存在获取 flatdomainname 的直接方法将会很有趣

# python - 如何将 Django 中的权限添加到模型并使用 shell 进行测试

> ID：10252332
> 
> 赞同：10
> 
> 时间：2012-04-20T19:24:27.927
> 
> 标签：python, django, django-models, django-forms, django-admin

我在我的模型中添加了 Meta 类并同步了数据库，然后在 shell 中创建了一个对象，它返回 false 所以我真的不明白错误在哪里，或者缺少什么，是否有某种配置可能在其他一些文件中..

```
class Employer(User): # Employer inherits from User
    employer_verified = models.BooleanField(default=False)

    class Meta:
        permissions = (
            ("is_member", "Friendly permission description"),
        )

emp = Employer.objects.create(blablabla)
emp.save()
emp.has_perm('myappname.is_member') 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-20T19:47:31.570

在您给出的示例中，我希望`emp.has_perm('myappname.is_member')`确实是`False`. 除非您明确授予新`Employer`对象`is_member`权限，否则它不会拥有它。

要以编程方式授予它您需要获取实际权限对象并将其添加到`Employer`'s 的权限`user_permissions`：

```
from django.contrib.auth.models import Permission
from django.contrib.contenttypes.models import ContentType

content_type = ContentType.objects.get_for_model(Employer)
permission = Permission.objects.get(content_type=content_type, codename='is_member')

emp = Employer.objects.create(blablabla)
emp.save()
emp.user_permissions.add(permission) 
```

要在 shell 中测试它，您可能需要删除为每个用户创建的权限缓存 - 否则`has_perm`可能无法反映实际权限：

```
delattr(emp, '_perm_cache') 
```

**回答您的问题：**

如果您希望每个`Employer`人都获得`is_member`许可，有几个选项：

1.  覆盖检查是否没有的`save`方法（这意味着它是一个新对象，并在保存后创建我上面显示的权限。不是很漂亮，但它会工作。`Employer``self.pk`

2.  编写您自己的[身份验证后端](https://docs.djangoproject.com/en/dev/topics/auth/#writing-an-authentication-backend)。如果权限码是`'is_member'`并且`User`有`Employer`实例，返回`True`

3.  不要使用权限。权限系统旨在让您能够动态授予和撤销权限。如果您只关心 a 是否`User`是`Employer`- 然后测试它。不要通过使用权限使其复杂化。

# debugging - 手动更改堆栈指针时 GDB 丢失

> ID：10252333
> 
> 赞同：4
> 
> 时间：2012-04-20T19:24:30.163
> 
> 标签：debugging, gdb, stack, cpu-registers

我正在开发一个应用程序，在某些时候，它必须使用不同的堆栈，它将由我开发的库管理。所以，我调用了这个库的初始化函数，并将堆栈指针（$sp）设置为我想要的内存地址。

当通过 GDB 运行此代码时，在我的另一个堆栈的初始化完成并执行返回到调用者函数后，GDB 给我这个警告：

```
warning: GDB can't find the start of the function at 0x12.

    GDB is unable to find the start of the function at 0x12
and thus can't determine the size of that function's stack frame.
This means that GDB may be unable to access that stack frame, or
the frames below it.
    This problem is most likely caused by an invalid program counter or
stack pointer.
    However, if you think GDB should simply search farther back
from 0x12 for code which looks like the beginning of a
function, you can increase the range of the search using the `set
heuristic-fence-post' command. 
```

此外，在打印 $sp 时，会显示旧值。

由于这部分代码在没有 GDB 的情况下正确执行，并且在 0x12 处没有函数，因此发生这种情况是因为 GDB 使用堆栈指针来寻址来跟踪函数的帧。

有没有办法避免这种行为并能够调试这个应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-08T10:18:43.777

> 这是因为 GDB 使用堆栈指针来寻址来跟踪函数的帧。

是的，显然[它确实](https://cygwin.com/ml/gdb-patches/2011-10/msg00716.html)：

> gdb_reader_funcs 中的get_frame_id 是返回当前帧对应的gdb_frame_id。[...] 一种方法是让 CODE_ADDRESS 指向函数的第一条指令，而 STACK_ADDRESS 在进入函数时指向堆栈指针的值。

我想解决这个问题的一种方法是将你的代码分成两个不同的函数（如果你只是在它们之间跳转的话）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-08T07:41:20.237

我认为您需要的是 GDB/Python 的**[frame unwinding](https://sourceware.org/gdb/current/onlinedocs/gdb/Unwinding-Frames-in-Python.html)**。我自己从未使用过它，但帧展开是重建进程调用堆栈的（内部）过程。

正如您所提到的，您更改`$SP`了值，因此 GDB 无法识别标准调用约定。自定义框架展开器应该让您教 GDB 使用什么堆栈布局。

这是他们在文档中提供的示例：

```
 from gdb.unwinders import Unwinder

 class FrameId(object):
     def __init__(self, sp, pc):
         self.sp = sp
         self.pc = pc

 class MyUnwinder(Unwinder):
     def __init__(....):
         super(MyUnwinder, self).__init___(<expects unwinder name argument>)

     def __call__(pending_frame):
         if not <we recognize frame>:
             return None
         # Create UnwindInfo.  Usually the frame is identified by the stack
         # pointer and the program counter.
         sp = pending_frame.read_register(<SP number>)
         pc = pending_frame.read_register(<PC number>)
         unwind_info = pending_frame.create_unwind_info(FrameId(sp, pc))

         # Find the values of the registers in the caller's frame and
         # save them in the result:
         unwind_info.add_saved_register(<register>, <value>)
         ....

         # Return the result:
         return unwind_info 
```

根据文档，您可以使用 访问 CPU 寄存器`PendingFrame.read_register (reg_name or reg_id)`，但显然，读取局部变量可能是个问题！

一旦你的 unwinder 构建得很好，它应该透明地集成到 GDB 中，并且所有常用的 CLI 机制都应该可用。

# c++ - Visual Studio 2010 中的 FFTW

> ID：10252336
> 
> 赞同：2
> 
> 时间：2012-04-20T19:24:36.387
> 
> 标签：c++, visual-c++, linker

我一直在尝试将我的项目与 fftw 链接，到目前为止，我已经对其进行了编译，并完成了“通过 1”的链接，但没有完成。正如 FFTW 网站所说，我生成了所有 .lib 文件，并将它们复制到 C:\Program Files\Microsoft Visual Studio 10.0\VC\lib\amd64 （因为我正在为 x64 编译，并且这个目录包含在我的库目录），我的项目中的 .h 文件和我的项目可执行文件目录中的 .dll 文件。

我复制了教程程序，我得到的确切错误是：

```
1>fftw_test.obj : error LNK2019: unresolved external symbol __imp__fftw_free referenced in function "int __cdecl fftw(void)" (?fftwt@@YAHXZ)
1>fftw_test.obj : error LNK2019: unresolved external symbol __imp__fftw_destroy_plan referenced in function "int __cdecl fftw(void)" (?fftwt@@YAHXZ)
1>fftw_test.obj : error LNK2019: unresolved external symbol __imp__fftw_execute referenced in function "int __cdecl fftw(void)" (?fftwt@@YAHXZ)
1>fftw_test.obj : error LNK2019: unresolved external symbol __imp__fftw_plan_dft_1d referenced in function "int__cdecl fftw(void)" (?fftwt@@YAHXZ)
1>fftw_test.obj : error LNK2019: unresolved external symbol __imp__fftw_malloc referenced in function "int__cdecl fftw(void)" (?fftwt@@YAHXZ) 
```

我试过了：

```
Project -> Properties -> Linker -> Input -> Additional dependencies 
```

包含 libfftw3-3.lib

而dumpbin /exports libfftw3-3.lib 生成_fftw_free _fftw_destroy_plan 等无法解析的函数。

是因为它正在寻找 __imp_fftw_functionname 并且它只找到 _fftw_functionname 函数吗？

无论如何，也许这也会有所帮助：在第 1 阶段，它多次显示 Searching C:...\VC\lib\amd64\libfftw3-3.lib: 但它从未显示“找到”、“引用”或“已加载” “就像它对其他图书馆所做的那样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:28:40.957

如果您熟悉 CMake，则可以使用以下方法：

我为 fftw-3.3.2 创建了这个 CMake 文件，我使用 Visual Studio 2010 x64 对其进行了测试：

```
cmake_minimum_required ( VERSION 2.8)
PROJECT ( fftw-3.3.2 )

set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG    ../../Debug)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEASE  ../../Release)

# Standard:          /DWIN32 /D_WINDOWS /W3 /Zm1000 /EHsc /GR
IF (WIN32)
        SET(CMAKE_CXX_FLAGS "/DWIN32 /D_WINDOWS /W4 /Zi /EHsc /GR- /MP /openmp /bigobj") 
        ADD_DEFINITIONS(-D_OPENMP -DFFTW_DLL -DLIBFFTWF33_EXPORTS) # Visual Studio 2005 and up supports OpenMP
ENDIF (WIN32)

file(GLOB           fftw_api_SOURCE                 api/*.c             api/*.h)
file(GLOB           fftw_dft_SOURCE                 dft/*.c             dft/*.h)
file(GLOB           fftw_dft_scalar_SOURCE          dft/scalar/*.c      dft/scalar/*.h)
file(GLOB           fftw_dft_scalar_codelets_SOURCE dft/scalar/codelets/*.c     dft/scalar/codelets/*.h)
file(GLOB           fftw_dft_simd_SOURCE            dft/simd/*.c        dft/simd/*.h)

file(GLOB           fftw_dft_simd_sse2_SOURCE       dft/simd/sse2/*.c   dft/simd/sse2/*.h)
file(GLOB           fftw_kernel_SOURCE              kernel/*.c          kernel/*.h)
file(GLOB           fftw_rdft_SOURCE                rdft/*.c            rdft/*.h)
file(GLOB           fftw_rdft_scalar_SOURCE         rdft/scalar/*.c     rdft/scalar/*.h)

file(GLOB           fftw_rdft_scalar_r2cb_SOURCE    rdft/scalar/r2cb/*.c 
                                                    rdft/scalar/r2cb/*.h)
file(GLOB           fftw_rdft_scalar_r2cf_SOURCE    rdft/scalar/r2cf/*.c 
                                                    rdft/scalar/r2cf/*.h)
file(GLOB           fftw_rdft_scalar_r2r_SOURCE     rdft/scalar/r2r/*.c 
                                                    rdft/scalar/r2r/*.h)

file(GLOB           fftw_rdft_simd_SOURCE           rdft/simd/*.c       rdft/simd/*.h)
file(GLOB           fftw_rdft_simd_sse2_SOURCE      rdft/simd/sse2/*.c  rdft/simd/sse2/*.h)

file(GLOB           fftw_reodft_SOURCE              reodft/*.c          reodft/*.h)
file(GLOB           fftw_simd_support_SOURCE        simd-support/*.c    simd-support/*.h)
#file(GLOB          fftw_threads_SOURCE             threads/*.c         threads/*.h)

set(${fftw_threads_SOURCE}
    threads/api.c 
    threads/conf.c 
    threads/ct.c 
    threads/dft-vrank-qeq1.c
    threads/f77api.c
    threads/hc2hc.c
    threads/openmp.c
    threads/rdft-vrank-geq1.c
    threads/vrank-geq1-rdft2.c)

source_group(fftw\\api                      FILES ${fftw_api_SOURCE})
source_group(fftw\\dft                      FILES ${fftw_dft_SOURCE})

source_group(fftw\\dft\\scalar              FILES ${fftw_dft_scalar_SOURCE})
source_group(fftw\\dft\\scalar\\codelets    FILES ${fftw_dft_scalar_codelets_SOURCE})
source_group(fftw\\dft\\simd                FILES ${fftw_dft_simd_SOURCE})
source_group(fftw\\dft\\simd\\sse2          FILES ${fftw_dft_simd_sse2_SOURCE})

source_group(fftw\\kernel                   FILES ${fftw_kernel_SOURCE})
source_group(fftw\\rdft                     FILES ${fftw_rdft_SOURCE})
source_group(fftw\\rdft\\scalar             FILES ${fftw_rdft_scalar_SOURCE})

source_group(fftw\\rdft\\scalar\\r2cb       FILES ${fftw_rdft_scalar_r2cb_SOURCE})
source_group(fftw\\rdft\\scalar\\r2cf       FILES ${fftw_rdft_scalar_r2cf_SOURCE})
source_group(fftw\\rdft\\scalar\\r2r        FILES ${fftw_rdft_scalar_r2r_SOURCE})

source_group(fftw\\rdft\\simd               FILES ${fftw_rdft_simd_SOURCE})
source_group(fftw\\rdft\\simd\\sse2         FILES ${fftw_rdft_simd_sse2_SOURCE})

source_group(fftw\\reodft                   FILES ${fftw_reodft_SOURCE})
source_group(fftw\\simd_support             FILES ${fftw_simd_support_SOURCE})
source_group(fftw\\threads                  FILES ${fftw_threads_SOURCE})

include_directories(
    kernel
    api
    dft
    dft/scalar
    dft/scalar/codelets # rellay needed?
    dft/simd
    dft/simd/sse2
    rdft
    rdft/scalar
    rdft/simd
    reodft
    ${CMAKE_CURRENT_SOURCE_DIR} # thats where the config.h is located
    simd-support
)

# Create a target for the library
ADD_LIBRARY(fftw-3.3.2 SHARED 
    ${fftw_api_SOURCE}
    ${fftw_dft_SOURCE}
    ${fftw_dft_scalar_SOURCE}
    ${fftw_dft_scalar_codelets_SOURCE}
    ${fftw_dft_simd_SOURCE}
    ${fftw_dft_simd_sse2_SOURCE}
    ${fftw_kernel_SOURCE}
    ${fftw_rdft_SOURCE}
    ${fftw_rdft_scalar_SOURCE}

    ${fftw_rdft_scalar_r2cb_SOURCE}
    ${fftw_rdft_scalar_r2cf_SOURCE}
    ${fftw_rdft_scalar_r2r_SOURCE}

    ${fftw_rdft_simd_SOURCE}
    ${fftw_rdft_simd_sse2_SOURCE}
    ${fftw_reodft_SOURCE}
    ${fftw_simd_support_SOURCE}
    ${fftw_threads_SOURCE}
) 
```

您还需要[这个](https://bitbucket.org/snippets/Vertexwahn/M76gr)config.h 文件。

这将解决 Windows 的所有构建问题 - 它会立即添加对（可能有小的更改）的支持

*   视觉工作室 6
*   视觉工作室 7
*   视觉工作室 7 .Net 2003
*   视觉工作室 8 2005
*   视觉工作室 8 2005
*   视觉工作室 8 2005 Win64
*   视觉工作室 9 2008
*   视觉工作室 9 2008 IA64
*   视觉工作室 9 2008 Win64
*   视觉工作室 10
*   视觉工作室 10 Win64
*   视觉工作室 10 IA64
*   视觉工作室 11
*   视觉工作室 11 Win64
*   视觉工作室 11 ARM

# drupal - 仅在检测到 Flash 时才加载模块

> ID：10252338
> 
> 赞同：1
> 
> 时间：2012-04-20T19:24:39.410
> 
> 标签：drupal, flash

我正在运行一个使用 Magic Touch 作为主要图像查看器的 Drupal 站点，不幸的是，Magic Touch 是内置在 Flash 中的。我需要一个适用于移动设备的非 Flash 后备图像查看器。这里的任何建议都会有所帮助，但我想我可能已经找到了最简单的角度。Magic Touch 将覆盖任何其他已启用的图像查看器，所以我想我可以启用我的后备图像查看器，如果没有检测到 Flash 或者如果检测到用户代理是移动设备，我只需要一种方法来禁用 Magic Touch 模块设备。

我已经用 browscap 编写了一个条件语句来检测用户是否正在使用移动设备。现在我只需要一个函数来有条件地禁用或启用一个模块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T03:12:56.710

您可以调用[module_disable()](http://api.drupal.org/api/drupal/includes!module.inc/function/module_disable/7)或[module_enable()](http://api.drupal.org/api/drupal/includes!module.inc/function/module_enable/7)函数来完成这些任务。

# c - 如何在 ncurses & C 中替换字符串菜单项

> ID：10252340
> 
> 赞同：3
> 
> 时间：2012-04-20T19:25:02.387
> 
> 标签：c, string, menu, ncurses

我试图弄清楚如何`item_name`从 ncurses 菜单中替换一个。从[**手册页**](http://www.mkssoftware.com/docs/man3/menu.3.asp)中，我找不到任何`set_item_name`或类似的东西。如果有解决方法，有什么想法吗？

例如，更换`"Choice 1"`w/ `"String 1"`on`KEY_ENTER`

```
#include <curses.h> 
#include <menu.h>

char *choices[] = {
    "Choice 1", "Choice 2", "Choice 3", "Choice 4", "Exit",
};

int main() {
    ITEM **my_items, *cur_item;
    int c, i;
    MENU *my_menu;

    initscr();
    cbreak();
    noecho();
    keypad(stdscr, TRUE);

    my_items = (ITEM **) calloc(6, sizeof(ITEM * ));
    for (i = 0; i < 5; ++i)
        my_items[i] = new_item(choices[i], choices[i]);
    my_items[5] = (ITEM*) NULL;

    my_menu = new_menu((ITEM **) my_items);
    post_menu(my_menu);
    refresh();

    while ((c = getch()) != KEY_F(1)) {
        switch (c) {
        case KEY_ENTER:
            // e.g. replace "Choice 1" w/ "String 1"
            break;
        case KEY_DOWN:
            menu_driver(my_menu, REQ_DOWN_ITEM);
            break;
        case KEY_UP:
            menu_driver(my_menu, REQ_UP_ITEM);
            break;
        }
    }
    free_item(my_items[0]);
    free_item(my_items[1]);
    free_menu(my_menu);
    endwin();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T04:01:15.107

是的，`set_item_name()`您可以编写一个解决方法`set_item_name();`

首先，查看 include `file menu.h`，您可以在其中找到结构的结构定义`ITEM`。看那里你会发现你可以写一个函数，比如：

```
void set_item_name (ITEM *itm, const char* name)
{   int len = strlen(name);
    char* n;    
    if (itm->name.str!=NULL) free((void*)(itm->name).str);
    n=strdup(name);
    itm->name.length=len;
    itm->name.str=n;
} 
```

关于论点：

*   itm 是指向要更改的菜单项的指针

*   name 是您要用作菜单名称的字符串。

我使用此例程在下拉菜单中创建了一个“复选框”项，它似乎可以工作（在 a`linux debian 6.0`和上测试`libncurses5 (5.7)`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:08:28.483

看起来[`set_menu_items()`](http://www.mkssoftware.com/docs/man3/menu_items.3.asp)再次调用是预期的方法。

# xml - 使用 xsl 对 xml 数据进行分组

> ID：10252345
> 
> 赞同：1
> 
> 时间：2012-04-20T19:25:38.017
> 
> 标签：xml, xslt

这是我想使用 xsl 转换为以下结果的 xml。请提供任何帮助。这类似于 Windows 目录结构。这里的目录深度是动态的。

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
<qc name="accounting" level="1">
    <qc name="fund" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
</qc>
<qc name="asset_allocation" level="1">
    <qc name="fund" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
</qc>
<qc name="asset_allocation" level="1">
    <qc name="fund" level="2">
        <qc name="v1_1" level="3"/>
    </qc>
</qc>
<qc name="credit_quality" level="1">
    <qc name="account" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
</qc>
<qc name="credit_quality" level="1">
    <qc name="fund" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
</qc>
<qc name="credit_quality" level="1">
    <qc name="v1_0" level="2"/>
</qc>
<qc name="credit_quality" level="1">
    <qc name="v2_0" level="2"/>
</qc>
<qc name="portfolio" level="1">
    <qc name="credit_quality" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
</qc>
</root> 
```

在上面的 xml 中，我有每个级别的名称。我想在同一级别对相同的名称进行分组。

结果：

```
<root>
<qc name="accounting" level="1">
    <qc name="fund" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
</qc>
<qc name="asset_allocation" level="1">
    <qc name="fund" level="2">
        <qc name="v1_0" level="3"/>
        <qc name="v1_1" level="3"/>
    </qc>
</qc>
<qc name="credit_quality" level="1">
    <qc name="account" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
    <qc name="fund" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
    <qc name="v1_0" level="2"/>
    <qc name="v2_0" level="2"/>
</qc>
<qc name="portfolio" level="1">
    <qc name="credit_quality" level="2">
        <qc name="v1_0" level="3"/>
    </qc>
</qc>
 </root> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T22:59:47.983

如果您可以使用 XSLT 2.0，请执行并使用 xsl:for-each-group 指令。

如果您坚持使用 XSLT 1.0，请阅读有关 Muenchian 分组的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T08:08:40.663

使用 XSLT 1.0 和 EXSLT 函数的快速破解可能如下所示。这可能不是最优雅的解决方案，但它应该可以工作。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:func="http://exslt.org/functions"
  xmlns:my="my-namespace"
  extension-element-prefixes="func"
  exclude-result-prefixes="my">

  <xsl:key name="qc-by-path" match="qc" use="my:path(.)"/>

  <xsl:template match="root">
    <root>
      <xsl:apply-templates/>
    </root>
  </xsl:template>

  <xsl:template match="qc">
    <xsl:variable name="peers" select="key('qc-by-path', my:path(.))"/>
    <xsl:if test="generate-id(.)=generate-id($peers[1])">
      <qc name="{@name}" level="{@level}">
        <xsl:apply-templates select="$peers/qc"/>
      </qc>
    </xsl:if>
  </xsl:template>

  <func:function name="my:path">
    <xsl:param name="qc"/>
    <xsl:choose>
      <xsl:when test="$qc/parent::qc">
        <func:result select="concat(my:path($qc/parent::qc),'/',$qc/@name)"/>
      </xsl:when>
      <xsl:otherwise>
        <func:result select="$qc/@name"/>
      </xsl:otherwise>
    </xsl:choose>  
  </func:function>
</xsl:stylesheet> 
```

# javascript - FB Graph API：作为页面发布到不同的页面

> ID：10252346
> 
> 赞同：0
> 
> 时间：2012-04-20T19:25:39.830
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk

我正在使用 Facebook 的 Javascript SDK，并且我需要一种方法来让用户发布到特定页面，以模拟他们拥有的一个页面。以用户身份发布完美，但我似乎可以做到这一点：

```
var data = {
    access_token: access,
    message: "Hello"
};

FB.api("/" + page_id + "/feed", "post", data, function(response) {
    console.log(response);
}); 
```

**page_id**是我要发布到的特定页面的数字 ID，**access**是使用 manage_pages 授权从“me/accounts”api 检索到的 access_token。

我从响应变量收到的输出是以下对象：

```
error: Object
    code: 200
    message: "(#200) Posts where the actor is a page cannot also include a target_id"
    type: "OAuthException" 
```

我在任何地方都找不到这个问题的答案。这是不可能的吗？不可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:47:05.140

快速谷歌搜索表明这是不可能的：

[https://stackoverflow.com/questions/9706873/post-on-wall-fan-page-to-a-fan-page-that-likes](https://stackoverflow.com/questions/9706873/post-on-wall-fan-page-to-a-fan-page-that-likes)

[如何使用应用程序名称发布](https://stackoverflow.com/questions/6634151/how-to-post-with-application-name)

另外，请查看旧的 REST API 文档：[https ://developers.facebook.com/docs/reference/rest/stream.publish/](https://developers.facebook.com/docs/reference/rest/stream.publish/)

> target_id
> 
> 注意：如果将 Page ID 指定为 uid，则不能指定 target_id。页面不能在其他用户的墙上书写。
> 
> 注意：您不能发布到应用程序配置文件页面的 Wall。

# javascript - 计算数组中的空值

> ID：10252347
> 
> 赞同：0
> 
> 时间：2012-04-20T19:25:40.713
> 
> 标签：javascript, arrays, acrobat

我在 Acrobat 9 中使用 JavaScript 为我的美国历史学生创建一个测试。我不想计算他们没有回答他们的答案。这是我到目前为止所拥有的：

```
var arrTest = "cell.1", "cell.2", "cell.3" , "cell.4"); //Will have more than four
count = 0, i = arrTest.length;  while (i--) {
    if (typeof arrTest[i] === "undefined")
    count++;
} 
```

BTW，有什么好的学习资料吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:55:58.383

我不知道 Acrobat 如何允许人们访问答案，但您的 JavaScript 有点错误：

```
var arrTest = [ "cell.1", "cell.2", "cell.3" , "cell.4"],
    count = 0,
    i = arrTest.length;

while (i--) {
    //Assume PDFdoc is a var referencing your Acrobat document - not sure how it works there.
    if (typeof PDFdoc.getField(arrTest[i]).value === "undefined") {
        count++;
    }
} 
```

# jquery - JQuery，在日历中使用 Sortable

> ID：10252351
> 
> 赞同：1
> 
> 时间：2012-04-20T19:25:49.047
> 
> 标签：jquery, calendar, draggable, jquery-ui-sortable

我正在构建一个事件日历并使用 jQuery 中的可排序功能。我的目标是允许用户将事件拖到日历上的任何一天。

一天可以有多个事件，我的一天DIV是这样的。

```
<div>
  <ul id="day1" class="day">
    <li class="eventDetail" id="1_1">Event 1</li>
    <li class="eventDetail" id="1_2">Event 2</li>
    <li class="eventDetail" id="1_3">Event 3</li>
  </ul>
</div> 
```

这是我的可排序功能

```
$(".eventDetail").sortable({
    connectWith: ".eventDetail",
    update: (function(event, ui){
        alert($(this).text());
    })
}).disableSelection(); 
```

我正在使用更新参数来提醒当前文本值。但是，我收到了给定 LI 组的所有文本值。例如，对于上面的那个，我的警报看起来像“事件 1、事件 2、事件 3” - 为什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:43:06.200

试试这个：

```
...
update: (function(event, ui){
    alert($(ui.item).text());
    alert($(ui.placeholder).text());
}
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:44:45.990

您可以在回调中使用 ui 项目来获取有关拖动项目的信息。（您还需要在`<ul>`标签上调用 .sortable）。

看这个演示：http: [//jsfiddle.net/WY6ru/](http://jsfiddle.net/WY6ru/)

# titanium - Titanium 无法创建有效的 IPA

> ID：10252352
> 
> 赞同：0
> 
> 时间：2012-04-20T19:25:56.053
> 
> 标签：titanium, titanium-mobile

我使用 Appcelerators Titanium 创建了一个应用程序，当我遇到一些问题时，我正准备将它部署到我的 iPad 上进行测试。当我尝试安装通过 Titanium 和 Xcode 生成的 IPA 时，我收到此错误：

```
Can't install application
The Info.plist for application at /Users/User/Music/iTunes/iTunes Media/Mobile Applications/myapp.ipa specifies a CFBundleExecutable of myapp, which does not exist 
```

我花了几个小时弄乱证书，但 Xcode 说证书很好，目标 iPad 在配置文件中。配置文件也安装在 iPad 上。这让我发疯，我似乎无法弄清楚。

# wcf - 将响应正文从 IDispatchMessageInspector 传递到 Application_EndRequest

> ID：10252359
> 
> 赞同：0
> 
> 时间：2012-04-20T19:26:16.363
> 
> 标签：wcf, rest, global-asax, idispatchmessageinspector

我想记录通过我的 WCF REST 服务传输的请求参数和响应正文。我可以在 IDispatchMessageInspector 中访问完整的响应。在 Application_EndRequest 的操作过程中，我可以访问存储在 Context.Items 中的请求标头和其他项目。

在调试过程中，我看到操作通过 IDispatchMessageInspector 进行，然后通过 Application_EndRequest。我的想法是将响应存储在 IDispatchMessageInspector 中的某处，然后在 Application_EndRequest 中，我将检索响应并将其与其他请求参数一起记录。

所以我的问题是：**我应该在哪里存储响应以便在 Application_EndRequest 中可以访问它？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T10:11:52.080

我目前正在尝试做类似的事情。我正在记录一个传入请求，将其存储在数据库中，然后想将日志 ID 传递给我的端点以供以后使用。在您的*AfterReceiveRequest*调用中，只需将您需要的任何内容添加到当前操作上下文的 IncomingMessageProperties 属性中：

**编辑：修复了下面的代码**

```
public object AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)
    {
        MessageBuffer buffer = request.CreateBufferedCopy(Int32.MaxValue);
        request = buffer.CreateMessage();
        int LogRequestID = Logging.LogIncomingRequest(buffer.CreateMessage());

        OperationContext.Current.IncomingMessageProperties.Add("LogRequestID", LogRequestID);

        return null;
    } 
```

然后我可以使用以下代码在我的端点中读取 LogRequestID：

```
OperationContext.Current.IncomingMessageProperties["LogRequestID"] 
```

如果需要，您还可以传递更复杂的。希望有帮助。

# asp.net - ASP.NET 中用于 \*、\|、\^、\~ 的正则表达式验证器

> ID：10252364
> 
> 赞同：3
> 
> 时间：2012-04-20T19:26:19.753
> 
> 标签：asp.net, regex, validation, negative-lookahead

我想确保用户没有输入任何这些字符串：`\*`or`\|`或 `\^`or `\~`。

我将在 ASP.Net 页面中为此使用什么正则表达式，并且 ASP.Net 正则表达式验证器是否会使用客户端正则表达式在服务器端自动验证，或者我需要编写服务器端验证代码？

`***`允许

`^|*~`允许

`\**`不允许

`\^\|*\~`不允许

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:29:04.243

正则表达式的转义是您已经输入的内容：（`\`，，`\*`等`\|`）。至于使用这个。如果您希望在客户端完成此操作，我会使用 javascript/jquery

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:38:26.330

正则表达式通常用于定义主题应匹配的模式。您要求的是定义一个主题不应该匹配的模式。反向匹配不是正则表达式的内置功能，但是可以通过使用[负环视](http://www.regular-expressions.info/lookaround.html)来模仿这种行为。

以下表达式使用*负前瞻* `(?!...)`来匹配您需要的内容：

```
^((?!(\\\*)|(\\\|)|(\\\^)|(\\\~)).)*$ 
```

[这个 SO answer](https://stackoverflow.com/a/406408/459517)很好地解释了负前瞻如何实现逆正则表达式匹配行为。

我想这也回答了您关于如何转义反斜杠字符的问题。你只是像我上面所做的那样双重逃避。

**关于 Asp.Net WebForms 中的客户端+服务器端验证**

`RegularExpressionValidator`只要您`EnableClientScript`设置为 ，该控件就会为您执行服务器端和客户端验证`true`。这将导致在`ControlToValidate`失去焦点（客户端）或回发页面（服务器端）时显示错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:38:24.910

正则表达式验证器正在客户端验证内容。您可以使用可以在客户端和服务器端进行验证的自定义验证器。

自定义验证器示例：

```
//html:
<asp:TextBox ID="textPreferredDate" runat="server"></asp:TextBox>
<asp:CustomValidator ID="CustomValidator1" runat="server" ControlToValidate="textPreferredDate" Display="Dynamic" ErrorMessage="Format: m/d/yyyy" OnServerValidate="CustomValidator1_ServerValidate" ClientValidationFunction="validateDate">Invalid format (m/d/yyyy)</asp:CustomValidator><br />

//client side:
<script language="javascript">
function validateDate(oSrc, args)
{
   var iDay, iMonth, iYear;
   var arrValues;
   arrValues = args.Value.split("/");
   iMonth = arrValues[0];
   iDay = arrValues[1];
   iYear = arrValues[2];

   var testDate = new Date(iYear, iMonth - 1, iDay);
   if ((testDate.getDate() != iDay) ||
      (testDate.getMonth() != iMonth - 1) ||
      (testDate.getFullYear() != iYear))
   {
       args.IsValid = false;
       return;
   }

   return true;
} </script>

//server side:
protected void CustomValidator1_ServerValidate(object source, ServerValidateEventArgs args)
{
   try
   {
      DateTime.ParseExact(args.Value, "d", null);
      args.IsValid = true;
   }
   catch
   {
      args.IsValid = false;
   }
} 
```

顺便说一句，如果您同时实现客户端和服务器验证，请注意。有关更多信息，请阅读此问题：[表单验证客户端和服务器端](https://stackoverflow.com/questions/6898485/form-validation-client-side-and-server-side)

# android - 如何在我的图库视图右侧添加“添加图像”按钮？

> ID：10252365
> 
> 赞同：0
> 
> 时间：2012-04-20T19:26:25.980
> 
> 标签：android, layout, views, gallery

我使用 Gallery 小部件来显示一组图片，但想在最后添加一个带有 OnClickListener 的图像，这将允许我将更多图像添加到我的列表中。

如何在图库视图的右侧添加内容？

将 Gallery 和 button 放在 Horizo​​ntalScrollView 中会起作用吗？还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:30:59.480

我看到这样做的一种方式：

在您的适配器中，您应该覆盖方法 getCount() 并将其设置为返回您希望显示的图像数量 + 1。

在您的 getView/bindView/newView（取决于您使用的适配器）中，您应该检查您正在膨胀的位置是否为 == getCount() - 1。如果是这样，您应该膨胀一个包含“添加新图像”的视图“ 按钮。然后您只需要将 onClick 侦听器附加到该按钮并处理新图像的插入

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:31:34.287

> 将 Gallery 和 button 放在 Horizo​​ntalScrollView 中会起作用吗？还是有更好的方法来做到这一点？

*   可能不是。视图无法区分哪些触摸事件应该发送到画廊和哪些触摸事件发送到 Horizo​​ntalScrollView。

您需要将您的画廊宽度设置为小于 FILL_PARENT，然后您可以将 ImageButton 放在它的右侧`android:layout_toRightOf="@id/galleryId"`

这样两者都将出现在屏幕上，“添加”按钮将始终显示，并且图库将能够滚动以显示其中包含的所有图像。

# ios - RestKit - 我想映射到 NSManagedObjects 但自己处理持久性

> ID：10252368
> 
> 赞同：1
> 
> 时间：2012-04-20T19:27:03.387
> 
> 标签：ios, json, core-data, persistence, restkit

我正在使用 RestKit 与 iOS 应用程序中的 API 交互。我想使用 RKObjectManager 并映射到我的 CoreData NSManagedObjects。但是，API 响应（作为 JSON 数组）与我的 CoreData 模型不完全匹配，最大的问题是并非所有由 API 返回的对象都有主键（我无法控制 API）。

有没有一种方法可以使用 RestKit 映射到托管对象但自己处理将对象持久化到 CoreData？

# iphone - 有什么方法可以在 UITableView 中显示 Google/Yahoo/Bing 搜索结果？

> ID：10252374
> 
> 赞同：0
> 
> 时间：2012-04-20T19:27:17.757
> 
> 标签：iphone, objective-c, ios, xcode, uitableview

我正在尝试创建一个需要使用 Google/Yahoo/Bing 或任何其他知名搜索引擎搜索网络的应用程序。我确实需要这些搜索结果的外观，所以我的第一个想法是将它们放在 UITableView 中。我怎样才能做到这一点？我需要获取特定的 API 吗？有没有提供这些 API 的搜索引擎？

我已经对此进行了广泛的研究，但没有找到类似的东西。

我会很感激这方面的帮助！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:33:28.123

您可以使用 Google 自定义搜索 API。 [在这里查看](https://developers.google.com/custom-search/v1/overview)

API 是 RESTful 的，响应可以是 JSON 或 Atom 格式。您应该能够使用 JSON 并转换为 NSDictionary/NSArray，然后在表格视图中显示。

# asp.net - 在 ASP.NET 中使用 AJAX 工具包验证文本框

> ID：10252377
> 
> 赞同：1
> 
> 时间：2012-04-20T19:27:33.470
> 
> 标签：asp.net, ajax, ajaxcontroltoolkit

关于以下问题，我不确定在哪里或搜索什么：

我的页面上有一个 TextBox 控件和一个 Label 控件。我已经准备好数据库查询，我想在 TextBox textchanged 事件上运行它，以便在标签中显示“有效”或“无效”文本。

如何在不回发每个 textchanged 事件的整个页面的情况下实现这一点？我已经安装了 AJAX 控制工具包并让示例工作，但我似乎没有找到符合要求的扩展器。有小费吗？非常感谢，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:33:04.367

首先，远离 AjaxControlToolkit。这适用于不知道自己在做什么的懒惰的 Web 开发人员。

其次，查看 jQuery Ajax。了解如何正确使用它以完成您需要做的事情。

基本上，您需要做的是通过 jQuery Ajax 发布到您的页面/Web 服务，以便运行数据库查询。然后，您可以将数据返回到页面并更新 UI。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# svn - 从存储库中删除一些文件/目录？TortoiseSVN

> ID：10252378
> 
> 赞同：0
> 
> 时间：2012-04-20T19:27:47.227
> 
> 标签：svn, tortoisesvn

基本上我已经创建了一个存储库并进行了第一次提交。但我意识到我不想包含一些文件（例如 .jpg）

所以我从tortoiseSVN的全球偏好中忽略了.jpg。但是我仍然在以前的提交中看到这些文件，是否有任何命令可以从以前的提交中删除这些被忽略的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:03:01.363

这不是一个错误，它是一个功能。Subversion 的策略是历史上没有（用户）命令从存储库中删除文件。这在某些时候可能不合适（例如，如果您不小心提交了密码信息），但它确保您能够引用您的回购的过去状态，而不会被其他人意外更改。

如果你想摆脱这些文件，你应该看看 Subversion 红皮书的管理部分，尤其是[“过滤存储库历史”](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.reposadmin.maint.filtering)部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:34:35.110

处理以前的提交通常不是一个好主意。您的目标是从存储库中删除文件吗？为此，您可以在回购浏览器中导航到它们并将它们吹走（将触发另一个提交以执行删除）。如果有空间问题，我会删除回购并重新启动（根据您的第一句话，我推断它是相当新的）。

# java - Java 6 文件输入输出流（同一个文件）

> ID：10252388
> 
> 赞同：2
> 
> 时间：2012-04-20T19:28:34.227
> 
> 标签：java, file, io, stream, java-6

我搜索并查看了多个这样的问题，但我的问题与我发现的任何问题都不同。我看过Java Docs。

如何打开与此 c 文件等效的文件：

```
stream1 = fopen (out_file, "r+b"); 
```

一旦我从文件中完成了部分读取，无论文件中有多少字节，第一次写入都会使下一次读取返回 EOF。

本质上，我想要一个不这样做的文件 I/O 流。我要做的全部目的是替换当前文件中现有文件中的字节。在执行读取->写入之前，我不想复制或制作副本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T19:30:55.067

您可以使用[RandomAccessFile](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:47:01.037

正如 Perception 提到的，您可以使用 RandomAccessFile。此外，在某些情况下，[FileChannel](http://docs.oracle.com/javase/6/docs/api/java/nio/channels/FileChannel.html)可能会更好地工作。我已经使用这些来处理二进制文件数据并取得了巨大的成功。

编辑：您可以使用 RandomAccessFile 对象从 RandomAccessFile 对象中获取 FileChannel `getChannel`。

# jsp - 从数据库中检索数据并使用带有包含数据值的单选按钮的单选按钮显示它

> ID：10252392
> 
> 赞同：0
> 
> 时间：2012-04-20T19:28:57.693
> 
> 标签：jsp

我正在建立一个基于网络的火车票预订系统。我想使用while循环从数据库中检索所有需要的数据，但显示其中一个数据，即带有单选按钮的train_no，以便我可以将它传递给下一个jsp。但是在执行此操作时，我得到了一个 sql 异常“找不到数据”。请帮我。以下是代码的一部分...

```
 <%@page import="java.sql.*"%>
          <%@page import="javax.servlet.*"%>
          <%@page import="java.io.*"%>
        <%String s3=String.valueOf(request.getAttribute("s2"));
        String d3=String.valueOf(request.getAttribute("d2"));
        String dj3=String.valueOf(request.getAttribute("dj2"));

        %>

<%  Connection con;
             PreparedStatement ps,ps1;
             ResultSet rs;
 try{
String driverName="sun.jdbc.odbc.JdbcOdbcDriver";
String url="jdbc:odbc:rail";
        String username="root";
        String password="root";
        Class.forName(driverName);
        con=DriverManager.getConnection(url,username,password);
         ps=con.prepareStatement("Select * from train_for where source=? and destination=? and doj=?");
         ps.setString(1,s3);
         ps.setString(2,d3);
         ps.setString(3,dj3);
         rs=ps.executeQuery();
         while(rs.next())
             { %>
             <tr><td><input type="radio" value="<%=rs.getString("train_no")%>" name="rad1"><%=rs.getString("train_no")%></td></tr>
             <tr><td><%=rs.getString(4)%></td></tr>
             <tr><td><%=rs.getString(5)%></td></tr>
             <br><br>
          <%}
         }
 catch(Exception e)
      {
      out.println(e);
      }
             %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T17:20:37.350

这工作得很好.. :)

```
while(rs.next())
         {
         String no= rs.getString(1);
         String dt= rs.getString(4);
         String st= rs.getString(5);
         %>

         <input type="radio" name="rad1" value="<%=no%>"/><%=no%>
         <%=dt%>
         <%=st%>
         <br>

      <%} 
```

# qt - 在 QML 设计模式下使用 Qt Creator，如何使用 qrc 路径引用图像？

> ID：10252393
> 
> 赞同：1
> 
> 时间：2012-04-20T19:28:58.663
> 
> 标签：qt, resources, qt-creator, qml

因此，我们有一个运行 Qt 的嵌入式 Linux 系统，我们使用资源文件将所有图标（.png 格式）编译到可执行文件中。问题是我希望能够使用 Qt Creator QML Designer 在我们布置屏幕时直观地看到我们的屏幕，但它只允许我选择相对文件系统路径（即不是资源的路径）。如果我进入编辑模式并将 qrc:/image.png 它在运行时工作，但图像不会显示在 QML 设计模式中。有没有人这样做过或知道是否有可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T00:48:30.957

至少有一个解决方法：

将所有内容放入资源文件（qml 文件和图标）中，当您在 Qt Quick Designer 中编辑文件时，所有路径都是相对的，因此图标可见。

那里描述了一切：[使用 Qt 资源系统管理资源文件](http://qt-project.org/doc/qt-4.8/qtbinding.html#managing-resource-files-with-the-qt-resource-system)

为了避免部署 qml 文件，您必须从 .pro 中删除/注释以下行：

```
DEPLOYMENTFOLDERS = folder_01 
```

并将其替换为：

```
OTHER_FILES = <list of qml files> 
```

# java - 在java中默认是静态内部类的成员

> ID：10252395
> 
> 赞同：1
> 
> 时间：2012-04-20T19:29:07.287
> 
> 标签：java

```
public static class ViewHolder {

        public int a,b;
            public void method();

    } 
```

当我将类声明为静态时，方法和变量 a 和 b 默认是静态的，还是必须单独声明它们为静态的？我知道这是一个愚蠢的问题，但我现在有点困惑:(

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:30:48.847

不，默认情况下它们不是静态的，它们是普通的实例成员。

静态内部类，不像普通的内部类，*可以*有静态成员，但是，如果你显式声明它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:31:26.807

不，当您声明一个内部静态类时，您指定*声明本身是 static*，因此您不需要父类的对象实例来访问它。

不涉及内部成员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:39:50.700

静态嵌套类的成员不是静态的。`static`用 class 指定关键字，表示嵌套类可以用类似于静态数据成员的包含外部类来实例化。

```
BaseClass.StaticNestedClass nestedClass = new BaseClass.StaticNestedClass();
nestedClass.nonStaticMethod();//correct
BaseClass.StaticNestedClass.nonStaticMethod()//Error 
```

这对作为普通类的静态嵌套类的数据成员没有影响。

请注意，如果`static`关键字与 a 相关联，`class`则该类**必须是嵌套类**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:32:37.420

公共静态类的工作方式与任何其他类一样。唯一真正的区别是它是通过包含类访问的：

```
OuterClass.InnerClass foo = new OuterClass.InnerClass(); 
```

# winforms - 在我第二次调用 form.Show System.Windows.Forms.Form 时没有出现

> ID：10252397
> 
> 赞同：1
> 
> 时间：2012-04-20T19:29:12.807
> 
> 标签：winforms, compact-framework

我使用 show()、showdialog()、bringtofront() 和 activate() 的组合来解决这个问题。

我在运行 Windows Mobile 5 的符号 MC50 PocketPC 上运行 CF 3.5（我认为它是 5...）

这必须更简单。有人可以请给我一些建议吗？

如果我第二次使用 form.Show() 没有任何反应。如果我第二次使用 form.ShowDialog() 我收到此错误：“值不在预期范围内”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:46:23.420

如果调用 form.Close()，则表单实例和实例本身内的所有资源都将被处理掉。如果您只想在视觉上关闭表单但保留它，您应该使用 form.Hide()。这个问题也让我很沮丧。以下是 Microsoft 文档中关于此的说明：

> 注意：在显示为无模式窗口的 F​​orm 上调用 Close 方法时，您不能调用 Show 方法使该窗体可见，因为该窗体的资源已被释放。若要隐藏窗体然后使其可见，请使用 Control.Hide 方法。

# c# - ListView 不显示任何内容

> ID：10252401
> 
> 赞同：0
> 
> 时间：2012-04-20T19:29:34.643
> 
> 标签：c#, winforms

我是 Windows 窗体的新手，我不知道我做错了什么。我在前面有一个 ListView，我通过从名为 listView1 的工具栏拖动它来创建它，并将 View 属性修改为设置为“List”。然后我尝试使用以下方法绑定它：

```
private void BindData()
{
    DataTable dt = new DataTable();
    dt = GetLatestInformation();
    Binding b = new Binding("NAME", dt, "NAME");
    listView1.DataBindings.Add(b);
} 
```

方法 GetLatestInformation 有效，表返回 200 行数据。每次都会到达 BindData 方法。任何人都知道我错过了什么？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:45:22.093

我不确定您尝试做的事情是否可行，但是可能适合的快速解决方法是循环遍历并将数据手动添加到列表视图中...

```
 foreach (DataRow dr in dt.Rows)
        {
            listView1.Items.Add(dr["NAME"].ToString());
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:41:35.153

难道是你需要将`View`ListView 的属性设置为`Details`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:45:22.437

会不会是`GetLatestInformation()`在返回一个`null`值？

# matplotlib - matplotlib：改变线条颜色以捕获数据中的自然时间参数化

> ID：10252412
> 
> 赞同：15
> 
> 时间：2012-04-20T19:30:37.473
> 
> 标签：matplotlib

我试图改变从两个数组（例如`ax.plot(x,y)`）中的数据绘制的线的颜色。颜色应该随着指数的变化而`x`变化`y`。我本质上是在尝试捕获数组中数据的自然“时间”参数化`x`和`y`.

在一个完美的世界里，我想要这样的东西：

```
fig = pyplot.figure()
ax  = fig.add_subplot(111)
x   = myXdata 
y   = myYdata

# length of x and y is 100
ax.plot(x,y,color=[i/100,0,0]) # where i is the index into x (and y) 
```

产生一条颜色从黑色到深红色再到鲜红色的线条。

我已经看到了非常适合绘制由某个“时间”数组显式参数化的函数的[示例](http://www.scipy.org/Cookbook/Matplotlib/MulticoloredLine)，但我无法让它与原始数据一起使用......

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-20T20:32:53.870

第二个示例是您想要的示例...我已经对其进行了编辑以适合您的示例，但更重要的是阅读我的评论以了解发生了什么：

```
import numpy as np
from matplotlib import pyplot as plt
from matplotlib.collections import LineCollection

x   = myXdata 
y   = myYdata
t = np.linspace(0,1,x.shape[0]) # your "time" variable

# set up a list of (x,y) points
points = np.array([x,y]).transpose().reshape(-1,1,2)
print points.shape  # Out: (len(x),1,2)

# set up a list of segments
segs = np.concatenate([points[:-1],points[1:]],axis=1)
print segs.shape  # Out: ( len(x)-1, 2, 2 )
                  # see what we've done here -- we've mapped our (x,y)
                  # points to an array of segment start/end coordinates.
                  # segs[i,0,:] == segs[i-1,1,:]

# make the collection of segments
lc = LineCollection(segs, cmap=plt.get_cmap('jet'))
lc.set_array(t) # color the segments by our parameter

# plot the collection
plt.gca().add_collection(lc) # add the collection to the plot
plt.xlim(x.min(), x.max()) # line collections don't auto-scale the plot
plt.ylim(y.min(), y.max()) 
```

# mysql - 带有innodb紧凑存储的mysql中的“不小”表添加列很慢

> ID：10252413
> 
> 赞同：0
> 
> 时间：2012-04-20T19:30:47.550
> 
> 标签：mysql, innodb

有人可以解释为什么向包含大量数据的 innodb 紧凑表添加列会很慢吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:45:21.620

使用`ALTER TABLE`向表中添加列需要重建整个表，这对于大表来说很慢。

如果您想在运行时继续使用该表`ALTER`，您应该考虑使用 pt-online-schema-change 工具：

[http://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html](http://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T12:46:36.293

从紧凑表的 mysql 文档中，它指出每条记录的标题都有一个位，指示该字段是否为空。如果添加列，则必须更改该标题的大小，这至少会更改该表中所有行的大小。

摘录：使用 COMPACT 行格式的 InnoDB 表中的行具有以下特征：

每个索引记录都包含一个五字节的标头，其前面可能是一个可变长度的标头。标头用于将连续记录链接在一起，也用于行级锁定。

记录头的可变长度部分包含一个位向量，用于指示 NULL 列。如果索引中可以为NULL的列数为N，则位向量占用CEILING(N/8)个字节。（例如，如果有 9 到 15 列可以为 NULL，则位向量使用两个字节。）

# php - 如何在没有表单的情况下将变量从一个 php 页面传递到另一个页面？

> ID：10252418
> 
> 赞同：18
> 
> 时间：2012-04-20T19:31:00.910
> 
> 标签：php, variables

我想知道如何在没有任何形式的 PHP 中将变量从一个页面传递到另一个页面。

我想要实现的是：

1.  用户点击链接
2.  传递了一个包含字符串的变量。
3.  可以在其他页面上访问该变量，以便我可以使用该变量运行 mysql 查询。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-20T19:33:51.137

在 url 中使用 get 方法。如果您想将名为“电话”的变量传递为 0001112222：

```
<a href='whatever.php?phone=0001112222'>click</a> 
```

然后在下一页（whatever.php）上，您可以通过以下方式访问此变量：

```
$_GET['phone'] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-20T19:33:08.450

如果您有数据希望数据保存时间超过一页，则需要[会话。](http://php.net/manual/en/features.sessions.php)

`$_GET`只有一页。

`<a href='page.php?var=data'>Data link</a>`

在`page.php`

```
<?php
echo $_GET['var'];
?> 
```

将输出：数据

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:34:58.233

您可以通过 GET 传递。因此，如果您想将值`foobar`从`PageA.php`to传递`PageB.php`，请将其称为`PageB.php?value=foobar`。

在 PageB.php 中，您可以这样访问它：

```
$value = $_GET['value']; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T13:14:25.500

检查以确保设置了变量。然后在使用前清洁它：

```
isset($_GET['var'])?$var=mysql_escape_string($_GET['var']):$var='SomeDefaualtValue'; 
```

否则，为它分配一个默认值（`$var=''`很好）以避免您提到的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-09T16:36:37.507

您可以使用 Ajax 调用或 $_GET["String"]; 方法

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-14T22:40:14.683

如果您尝试直接从另一个 PHP 文件访问该变量，您可以使用`include()`或包含该文件`include_once()`，让您可以访问该变量。请注意，这将包括第二个文件中的**整个第一个**文件。

# objective-c - 我可以在 iOS 上的 C/Objective-C 中创建内存映射文件 * 吗？

> ID：10252422
> 
> 赞同：7
> 
> 时间：2012-04-20T19:31:14.180
> 
> 标签：objective-c, ios, c

我有一个库，它消耗 a`FILE *`并将数据输出到另一个`FILE *`.

我想在内存中处理这个库的输入和这个库的输出，而不需要从磁盘上的文件读取/写入文件。

我们在 iOS 中这样做 - 因此将库作为单独的应用程序运行并使用`stdin`/`stdout`不是（据我所知）一个可行的选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:28:22.813

因为 ObjC 是 C 的超集，所以您所要做的就是`#import/#include <stdio.h>`访问`funopen()`它本身包含函数`readfn`、`writefn`、`seekfn`和`closefn`。[fwopen 有一个示例，显示如何在另一个SO question](https://stackoverflow.com/a/1043871/945847)中写入两个流。

~~Mac OSX 和 iOS 不包含`fmemopen`，`open_memstream`因为它们显然是不可移植的[linux 功能](https://web.archive.org/web/20160927172523/http://lists.apple.com/archives/unix-porting/2008/Feb/msg00059.html)~~

从 macos 10.13、ios 11.0、tvos 11.0 和 watchos 4.0 开始，`fmemopen`stdio`open_memstream`中提供了一些其他有用的 POSIX.1-2008 标准函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-30T00:33:38.847

看看[https://github.com/shyuep/pyhull/tree/master/src/fmemopen](https://github.com/shyuep/pyhull/tree/master/src/fmemopen)，我自己在 Mac OSX 10.8.2 上测试过，它工作正常。

作者表示它也应该适用于 iOS。

# ios - 用巨大的画布绘画应用程序

> ID：10252426
> 
> 赞同：2
> 
> 时间：2012-04-20T19:31:32.477
> 
> 标签：ios, cocos2d-iphone

我正在开发另一个使用比屏幕大很多倍的画布的绘图应用程序。我需要一些关于如何做到这一点的建议/指导。

基本上我想要的是在这个大画布上滚动，只在可见区域绘制。我在想两种方法：

1.  有 64x64（或其他）“图块”可供绘制，然后在滚动时加载新图块。
2.  记录所有用户笔画（点）并滚动计算指定区域中的哪些笔画，并仅使用屏幕大小的画布绘制它们。

如果这很重要，我正在使用 cocos2d 作为原型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-15T15:20:46.417

忘记 2000x200 的限制，我有一个开源项目，它绘制 18000 x 18000 NASA 图像。

我建议你把这个任务分成两部分。首先，滚动。正如 CodaFi 所建议的，当您滚动时，您将提供 CATiledLayers。每一个都将是您创建的 CGImageRef - 您真正巨大的画布的子图像。然后，您可以轻松支持放大和缩小。

第二部分是与用户交互以绘制或以其他方式影响画布。当用户停止滚动时，然后创建一个不透明的 UIView 子类，将其作为子视图添加到主视图，覆盖托管 CATiledLayers 的视图。在您需要显示此视图的那一刻，您使用适当的信息填充它，以便它可以正确绘制较大画布的那部分（例如在某个颜色的这一点上画一个圆圈等）。

您将使用此覆盖视图的 drawRect: 方法进行绘图。因此，当用户采取更改视图的操作时，您可以根据需要执行“setDisplayInRect:”来强制 iOS 调用您的 drawRect:。

当用户决定滚动时，您需要使用用户所做的任何更改来更新您的大画布模型，然后移除不透明的覆盖，并让 CATiledLayers 绘制大图像的适当部分。这种过渡可能是避免视觉故障的过程中最棘手的部分。

假设您有大量用于画布的对象定义。当您需要为图块创建 CGImageRef 时，您可以扫描它以寻找对象框架和图块框架之间的重叠，然后才绘制该图块所需的那些项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T11:31:24.260

许多移动设备不支持超过 2048x2048 的纹理。所以我会推荐：

*   用 2048x2048 的大瓷砖制作您的大表面
*   仅将当前可见图块的可见部分绘制到屏幕上
*   您将需要每帧最多绘制 4 个图块，以防用户滚动到四个图块的一角，但如果只有一个可见图块，请确保不要绘制任何额外内容。

这可能是最有效的方式。64x64 瓦片真的太小了，而且效率很低，因为“绘制瓦片”调用会产生很大的重复开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T19:06:10.993

Apples [ScrollViewSuite](http://developer.apple.com/library/ios/#samplecode/ScrollViewSuite/Introduction/Intro.html)中有一个平铺示例与绘图部分没有任何关系，但它可能会给您一些关于如何管理事物平铺部分的想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T06:00:01.593

您可以使用 CATiledLayer。见 WWDC2010 会议 104

但是对于 cocos2d，它可能不起作用。

# prolog - 以交互方式使用 SWI-Prolog - 输出已取消

> ID：10252431
> 
> 赞同：0
> 
> 时间：2012-04-20T19:31:40.557
> 
> 标签：prolog, interactive-mode

我以交互方式使用 SWI-Prolog。当我运行我的查询时，我得到一个输出前缀，其余的被删除（使用 string 标记`...|...`）。这是正常的还是我应该回去修复我的程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:45:43.470

显示的项目数由序言标志控制。您可以通过发出删除它

```
remove_max_depth:-
    current_prolog_flag(toplevel_print_options,Options), 
    select(max_depth(_), Options, NOptions)->
    set_prolog_flag(toplevel_print_options, NOptions); true. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T20:14:20.243

没什么可担心的。它只是视觉上的缩写......只需按“w”（写入）即可显示列表的完整内部表示。

# python - Python 和 ClearCase 集合视图

> ID：10252436
> 
> 赞同：3
> 
> 时间：2012-04-20T19:32:16.720
> 
> 标签：python, clearcase

我想从 python 脚本设置为 clearcase 视图，然后在该视图中执行命令。我尝试使用此处列出的各种方法：

[子进程](http://docs.python.org/library/subprocess.html)

但我没有任何成功。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T19:47:21.157

我不建议设置视图，因为[`setview`](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_setview.htm)它本身会产生一个新进程。
我真的更喜欢`/view/viewTag/aVob/...`在[启动视图](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_startview.htm)后使用( `cleartool startview viewTag`)

在我看来，“生成过程”问题让所有事情都变得过于复杂，并解释了为什么你有这样的技术说明：

*   “[从 shell 脚本设置到视图中不会处理脚本中的剩余命令](http://www-01.ibm.com/support/docview.wss?uid=swg21119859)”。

> 执行后出现的任何命令`cleartool setview cmview`都不会被处理，因为 shell 是用 生成的`exec()`，它将当前程序替换为新程序。
> 
> 这意味着当前进程的文本和代码段，在这种情况下是包含所有命令的脚本，被正在执行的程序所取代，这是由 running 调用的 shell `cleartool setview cmview`。
> 因此，任何命令都不会在`setview`.

*   “[如何通过发出 setview -exe 或 -login 来处理生成的 shell 并影响子 shell 进程](http://www-01.ibm.com/support/docview.wss?uid=swg21503973)”

> 该`-exec`变量将启动一个子shell 进程并在指定的动态视图中调用指定的命令。一旦命令完成，控制权就会返回给父 shell。**不会在父 shell 进程中设置**
> **视图`-exec`**。
> 生成的`-exec`子shell会继承父shell进程的环境变量；但是，在子 shell 中创建的环境变量不会传递回父 shell。

所以如果你*真的*想使用`setview`，你可以（我自己没有直接测试过）：

*   有一个 python 脚本调用`setview`
*   但是该`setview`调用的参数将是另一个python脚本（当配置了所述设置视图的内容`-exec`时，执行您想要执行的操作。`/vobs`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-30T12:04:07.980

旧线程，但我只需要解决这个问题，所以也许有帮助。

在你的 python 脚本中

```
process = subprocess.Popen('usr/atria/bin/cleartool setview viewName')
(out, err) = process.communicate('python script2Name') 
```

.communicate 可以传递新命令，就好像你将它传递给一个新的外壳（终端）一样。

另一种方法是

```
process = subprocess.Popen('usr/atria/bin/cleartool setview -exec "whatever command you want inside view" viewName')
(out, err) = process.communicate() 
```

# android - 为什么我的相机应用程序崩溃了？

> ID：10252438
> 
> 赞同：0
> 
> 时间：2012-04-20T19:32:25.100
> 
> 标签：android, camera, release

API 15\. 当我在拍照后停止相机并转到主屏幕并重新打开我的应用程序并尝试拍摄另一张照片时，我的应用程序崩溃并出现此错误：

```
04-20 12:04:38.437: E/AndroidRuntime(5150): FATAL EXCEPTION: Timer-2
04-20 12:04:38.437: E/AndroidRuntime(5150): java.lang.RuntimeException: Method called after release()
04-20 12:04:38.437: E/AndroidRuntime(5150):     at android.hardware.Camera.native_takePicture(Native Method)
04-20 12:04:38.437: E/AndroidRuntime(5150):     at android.hardware.Camera.takePicture(Camera.java:947)
04-20 12:04:38.437: E/AndroidRuntime(5150):     at android.hardware.Camera.takePicture(Camera.java:892)
04-20 12:04:38.437: E/AndroidRuntime(5150):     at com.prism.app.PrismActivity$5.run(PrismActivity.java:167)
04-20 12:04:38.437: E/AndroidRuntime(5150):     at java.util.Timer$TimerImpl.run(Timer.java:284)

public void surfaceCreated(SurfaceHolder holder) {
    // The Surface has been created, now tell the camera where to draw the preview.
    if (mCamera == null) {
        try {
            mCamera = Camera.open();
            mCamera.setPreviewDisplay(holder);
            mCamera.setDisplayOrientation(90);
            mCamera.startPreview();
        } catch (IOException e) {
            // error setting preview of camera
        }
    } else {
    }
}

public void surfaceDestroyed(SurfaceHolder holder) {
    // empty. Take care of releasing the Camera preview in your activity.
    if (mCamera != null) {
        mCamera.setPreviewCallback(null);
        mCamera.stopPreview();
        mCamera.release(); //need to take care of case when app is not closed completely still need to release
        mCamera = null;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:40:45.023

从堆栈跟踪来看，您似乎还有一些`TimerTask`仍计划执行的使用相机的操作。它在您关闭相机后触发，因此出现错误。您需要`cancel()`,`Timer`并准备好在`TimerTask`您取消之前最后一个可能正在进行中。所以任务在对它进行操作之前需要检查相机是否关闭。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-20T19:38:21.573

`mCamera`本质上，您是在调用对象的发布方法并且操作系统已在其本机代码中发布它之后尝试使用您的对象。

该对象仍然存在（因此您的`mCamera == null`评估结果为`false`），但如果不创建新对象或调用再次获取本机资源的方法，则无法再使用该对象。

# sencha-touch-2 - 更改 NestedList 中的详细信息容器？

> ID：10252440
> 
> 赞同：2
> 
> 时间：2012-04-20T19:32:44.260
> 
> 标签：sencha-touch-2

在我拥有的一个小程序中，我试图为我的嵌套列表的每个叶节点创建自定义容器。

以下是我正在尝试测试的几个任意示例容器：

```
Ext.define('DetailContainer1', {
    extend: 'Ext.Container',
    xtype: 'detail-container1',
    layout: {
        type: 'vbox'
    },
    height: 300,
    style: 'background-color: #a9a9a9;',
    //    flex: 1,
    items: [{
        html: 'Detail Container1'
    }]
});

Ext.define('DetailContainer2', {
    extend: 'Ext.Container',
    xtype: 'detail-container2',
    layout: {
        type: 'vbox'
    },
    height: 300,
    style: 'background-color: #c9c9c9;',
    //    flex: 1,

    items: [{
        html: 'Detail Container2',
        flex: 1
    }, {
        xtype: 'button',
        text: 'Hit me!',
        flex: 1
    }]
}); 
```

* * *

当用户单击叶节点时，如何切换新容器？

这个动作应该发生在`onLeafItemTap()`. 顺便说一句，初始容器（#2）目前没有显示。这是布局问题吗？

以下是屏幕应该是什么样子的一些想法：

![在此处输入图像描述](../Images/76f95efe88c449b1548aee3b7428e88b.png)

![在此处输入图像描述](../Images/5ca6b0911ec9a14ac28de657a500da41.png)

* * *

> 完整来源：

```
Ext.Loader.setConfig({
    enabled: true
});

Ext.define('DetailContainer1', {
    extend: 'Ext.Container',
    xtype: 'detail-container1',
    layout: {
        type: 'vbox'
    },
    height: 300,
    style: 'background-color: #a9a9a9;',
    //    flex: 1,
    items: [{
        html: 'Detail Container1'
    }]
});

Ext.define('DetailContainer2', {
    extend: 'Ext.Container',
    xtype: 'detail-container2',
    layout: {
        type: 'vbox'
    },
    height: 300,
    style: 'background-color: #c9c9c9;',
    //    flex: 1,

    items: [{
        html: 'Detail Container2',
        flex: 1
    }, {
        xtype: 'button',
        text: 'Hit me!',
        flex: 1
    }]
});

Ext.define('ListItem', {
    extend: 'Ext.data.Model',
    config: {
        fields: ['text']
    }
});

Ext.define('Sencha.view.MainView', {
    extend: 'Ext.Container',
    xtype: 'mainview',
    layout: {
        type: 'hbox'
    },
    initialize: function() {
        this.treeStore = Ext.create('Ext.data.TreeStore', {
            model: 'ListItem',
            defaultRootProperty: 'items',
            root: {
                items: [{
                    text: 'Containers',
                    items: [{
                        text: 'Detail #1',
                        leaf: true
                    }, {
                        text: 'Detail #2',
                        leaf: true
                    }]
                }]
            }
        });
        this.detailContainer = Ext.create("DetailContainer2", {});

        this.nestedList = Ext.create('Ext.NestedList', {

            docked: 'left',
            width: 300,
            flex: 1,
            store: this.treeStore,

            detailCard: true,
            detailContainer: this.detailContainer,

            listeners: {
                scope: this,
                leafitemtap: this.onLeafItemTap
            }
        });

        this.setItems([this.detailContainer, this.nestedList]);
    },

    onLeafItemTap: function(nestedList, list, index, node, record, e) {
        var detailCard = nestedList.getDetailCard();
        // nestedList.setDetailContainer(Ext.create("DetailContainer1", {}))
        // detailCard.setHtml(record.get('text') + "...");
    }
});

Ext.application({

    launch: function() {
        var container = Ext.create("Ext.Container", {
            layout: {
                type: 'hbox'
            },
            items: [{
                xtype: 'mainview'
            }]
        });
        Ext.Viewport.add(container);

    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T04:03:14.510

最后，我找到了解决您问题的正确方法。

一些解释：

*   如果你想在你的右侧显示“自定义的detailContainer”，`hbox`很明显你应该禁用你的`detailCard`配置，`Ext.NestedList`因为它被设计为内联显示（即代替你的`Ext.NestedList`）。
*   使用时`Ext.define`，所有内容都应包含在中`config`（除了`extend`, `xtype`, `alias`, `id`, 所以在这种情况下，`layout`必须放入`config`）。
*   `flex`也应该定义在`config`。
*   在`leafitemtap`事件中，只需更新您的`detailContainer`配置并再次删除/添加它，因为它不会动态更新。

请查看下面修改后的代码片段，它对我来说非常有效。

```
Ext.Loader.setConfig({ enabled: true });

Ext.define('DetailContainer1', {
    extend: 'Ext.Container',
    xtype: 'detail-container1',
    config: {
        flex: 1,
        layout: {
            type: 'vbox'
        },
        style: 'background-color: #a9a9a9;',
        items: [
            {html: 'Detail Container1'}
        ]
    }
});

Ext.define('DetailContainer2', {
    extend: 'Ext.Container',
    xtype: 'detail-container2',
    config: {
        flex: 1,
        layout: {
            type: 'vbox'
        },
        style: 'background-color: #c9c9c9;',

        items: [
            {html: 'Detail Container2', flex: 1},
            {xtype: 'button', text: 'Hit me!', flex: 1}
        ]
    }
});

Ext.define('ListItem', {
    extend: 'Ext.data.Model',
    config: {
        fields: ['text']
    }
});

Ext.define('Sencha.view.MainView', {
    extend: 'Ext.Container',
    xtype: 'mainview',
    id: 'mainview',
    config: {
        layout: {
            type: 'hbox'
        },
    },
    initialize: function() {
        this.treeStore = Ext.create('Ext.data.TreeStore', {
            model: 'ListItem',
            defaultRootProperty: 'items',
            root: {
                items: [
                    {
                        text: 'Containers',
                        items: [
                            { text: 'Detail #1', leaf: true },
                            { text: 'Detail #2', leaf: true }
                        ]
                    }

                ]
            }
        });
        this.detailContainer = Ext.create("DetailContainer2");

        this.nestedList = Ext.create('Ext.NestedList', {
            flex: 1,
            store: this.treeStore,
            listeners: {
                scope: this,
                leafitemtap: this.onLeafItemTap
            }
        });

        this.setItems([this.nestedList, this.detailContainer]);
    },

    onLeafItemTap: function(nestedList, list, index, node, record, e) {
        mainview = Ext.getCmp('mainview');
        if (index==0) {
            mainview.detailContainer = Ext.create("DetailContainer1");
        } else {
            mainview.detailContainer = Ext.create("DetailContainer2");
        }
        mainview.removeAt(1);
        mainview.add(mainview.detailContainer);

    }
});

Ext.application({
    launch: function() {
        Ext.Viewport.add(
            Ext.create("Ext.Container", {
                layout: {
                    type: 'card'
                },
                items: [
                    {  xtype : 'mainview'}
                ]
            }));
    }
}); 
```

# javascript - 在执行特定操作后返回 JSP 页面。

> ID：10252442
> 
> 赞同：0
> 
> 时间：2012-04-20T19:32:57.127
> 
> 标签：javascript, jsp, redirect, window.location

我有一个 JSP 页面。假设 page1.jsp。我有一些用 Script 标签编写的 java 脚本代码，在其中我调用特定函数，在其中我只是简单地执行 window.location 到某个特定动作的 URL(http://localhost:8080/ATT/jsp/page2.jsp)正在执行。现在，一旦在 page2.jsp 上完成一个操作，我想在没有任何用户单击事件或任何其他事件的情况下返回 page1.jsp。我应该做 window.location(http://localhost:8080/ATT/jsp/page1.jsp) 还是我可以遵循的任何其他方法。请给我一个答案。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:37:48.980

您可以使用`.sendRedirect()`

```
response.sendRedirect(redirectURL); 
```

## 例子：

```
response.sendRedirect("http://localhost:8080/ATT/jsp/page1.jsp"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:38:40.903

你唯一的选择是`history.back()`

# python - 如何检查一个句子是否正确（Python中的简单语法检查）？

> ID：10252448
> 
> 赞同：58
> 
> 时间：2012-04-20T19:33:13.960
> 
> 标签：python, nlp, grammar

如何检查一个句子在 Python 中是否有效？

例子：

```
I love Stackoverflow - Correct
I Stackoverflow love - Incorrect 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-08-05T15:22:37.197

有各种提供自动校对和语法检查的 Web 服务。有些有一个 Python 库来简化查询。

据我所知，这些工具中的大多数（当然是 After the Deadline 和 LanguageTool）都是基于规则的。将检查的文本与描述常见错误的大量规则进行比较。如果规则匹配，软件将其称为错误。如果规则不匹配，软件什么也不做（它无法检测到它没有规则的错误）。

### [截止日期后](http://www.afterthedeadline.com/development.slp)

```
import ATD
ATD.setDefaultKey("your API key")
errors = ATD.checkDocument("Looking too the water. Fixing your writing typoss.")
for error in errors:
 print "%s error for: %s **%s**" % (error.type, error.precontext, error.string)
 print "some suggestions: %s" % (", ".join(error.suggestions),) 
```

预期输出：

```
grammar error for: Looking **too the**
some suggestions: to the
spelling error for: writing **typoss**
some suggestions: typos 
```

可以在您自己的机器上运行服务器应用程序，建议使用 4 GB RAM。

### [语言工具](https://www.languagetool.org/development/)

[https://pypi.python.org/pypi/language-check](https://pypi.python.org/pypi/language-check)

```
>>> import language_check
>>> tool = language_check.LanguageTool('en-US')
>>> text = 'A sentence with a error in the Hitchhiker’s Guide tot he Galaxy'
>>> matches = tool.check(text)

>>> matches[0].fromy, matches[0].fromx
(0, 16)
>>> matches[0].ruleId, matches[0].replacements
('EN_A_VS_AN', ['an'])
>>> matches[1].fromy, matches[1].fromx
(0, 50)
>>> matches[1].ruleId, matches[1].replacements
('TOT_HE', ['to the'])

>>> print(matches[1])
Line 1, column 51, Rule ID: TOT_HE[1]
Message: Did you mean 'to the'?
Suggestion: to the
...

>>> language_check.correct(text, matches)
'A sentence with an error in the Hitchhiker’s Guide to the Galaxy' 
```

也可以私下运行服务器端。

### [姜](http://www.gingersoftware.com/grammarcheck)

此外，[这](https://github.com/zoncoen/python-ginger)是一个用于 Ginger 的 hacky（屏幕抓取）库，可以说是目前最精美的免费语法检查选项之一。

### 微软Word

应该可以编写 Microsoft Word 脚本并使用其语法检查功能。

### 更多的

Open Office 网站上有一个[语法检查器的精选列表](https://www.openoffice.org/lingucomponent/grammar.html)。帕特里克在评论中指出。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-04-20T19:34:56.393

查看[NLTK](http://www.nltk.org)。它们支持可用于解析句子的语法。您可以定义语法，或使用提供的语法以及上下文无关的解析器。如果句子解析，则它具有有效的语法；如果不是，那么它不会。这些语法可能没有最广泛的覆盖范围（例如，它可能不知道如何处理像 StackOverflow 这样的单词），但是这种方法将允许您具体说明语法中的有效或无效。 [NLTK 书的第 8 章](http://www.nltk.org/book/ch08.html)涵盖了解析，应该解释你需要知道的内容。

[另一种方法是为覆盖范围广泛的解析器（如斯坦福解析器](http://nlp.stanford.edu/software/lex-parser.shtml)或[C&C](http://svn.ask.it.usyd.edu.au/trac/candc) ）编写一个 python 接口。这些是统计解析器，即使他们以前没有看过所有的单词或所有的语法结构，也能理解句子。缺点是有时解析器仍然会返回一个语法错误的句子的解析，因为它会使用统计数据来做出最好的猜测。

所以，这真的取决于你的目标是什么。如果您想非常精确地控制被认为是语法的内容，请使用带有 NLTK 的上下文无关解析器。如果您想要稳健性和广泛的覆盖范围，请使用统计解析器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-05-07T19:46:08.073

其他一些答案提到了最大的开源语法检查器[LanguageTool 。](http://languagetool.org)直到现在，它还没有可靠的、最新的 Python 端口。

我推荐[language_tool_python](https://github.com/jxmorris12/language_tool_python)，一个支持 Python 3 和最新版本的 Java 和 LanguageTool 的语法检查器。它是唯一最新的、免费的 Python 语法检查器。（完全披露，我制作了这个库）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-10-12T08:44:53.350

我建议使用[language-tool-python](https://pypi.org/project/language-tool-python/)。例如：

```
import language_tool_python
tool = language_tool_python.LanguageTool('en-US')

text = "Your the best but their are allso  good !"
matches = tool.check(text)
len(matches) 
```

我们得到：

```
4 
```

我们可以看看它发现的 4 个问题：

**第 1 期：**

`matches[0]`

我们得到：

```
Match({'ruleId': 'YOUR_YOU_RE', 'message': 'Did you mean "You\'re"?', 'replacements': ["You're"], 'context': 'Your the best but their are allso  good !', 'offset': 0, 'errorLength': 4, 'category': 'TYPOS', 'ruleIssueType': 'misspelling'}) 
```

**第二期：**

`matches[1]`

我们得到：

```
Match({'ruleId': 'THEIR_IS', 'message': 'Did you mean "there"?', 'replacements': ['there'], 'context': 'Your the best but their are allso  good !', 'offset': 18, 'errorLength': 5, 'category': 'CONFUSED_WORDS', 'ruleIssueType': 'misspelling'}) 
```

**第三期：** `matches[2]` 我们得到：

```
Match({'ruleId': 'MORFOLOGIK_RULE_EN_US', 'message': 'Possible spelling mistake found.', 'replacements': ['also', 'all so'], 'context': 'Your the best but their are allso  good !', 'offset': 28, 'errorLength': 5, 'category': 'TYPOS', 'ruleIssueType': 'misspelling'}) 
```

**第四期：**

`matches[3]`

我们得到：

```
Match({'ruleId': 'WHITESPACE_RULE', 'message': 'Possible typo: you repeated a whitespace', 'replacements': [' '], 'context': 'Your the best but their are allso  good!', 'offset': 33, 'errorLength': 2, 'category': 'TYPOGRAPHY', 'ruleIssueType': 'whitespace'}) 
```

如果您正在寻找更详细的示例，可以查看[Predictive Hacks的相关帖子](https://predictivehacks.com/languagetool-grammar-and-spell-checker-in-python/)

# java - AES 密钥是随机的吗？

> ID：10252449
> 
> 赞同：6
> 
> 时间：2012-04-20T19:33:16.943
> 
> 标签：java, aes

此代码可能会生成 AES 密钥

```
KeyGenerator kgen = KeyGenerator.getInstance("AES");
kgen.init(128); 
```

但

如果我有一种“非常可靠”的生成随机数的方法，我可以这样使用它吗

```
SecureRandom rnd = new SecureRandom();
byte[] key = new byte[16];
rnd.nextBytes(key); 
```

这种方法得到的key可靠吗？

或者它只能由一些特殊的算法生成

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-20T19:57:41.603

AES 密钥*可以*是任何 128 位。无论创建它的方法是什么，它实际上都*应该是不可猜测的。*

例如：

```
SecureRandom sr = new SecureRandom()

key = new byte[16];
iv = new byte[16];

sr.nextBytes(key);
sr.nextBytes(iv);

Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(key,"AES"), new IvParameterSpec(IV)); 
```

`SecretKeySpec`顺便说一句，它只是一个 byte[] 周围的薄包装器——它不会以任何方式转换密钥。没有“特殊算法”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T14:56:18.967

添加到其他答案......我认为基本随机函数不安全的原因有两个：

1.  轻微的统计偏差对于非安全相关的情况是可以接受的，但对于安全应用来说，分布范围会变得不可接受。
2.  它们由系统 DATETIME 播种。即使知道您何时生成密钥（精度差 +/- 6 个月）也会显着减少蛮力搜索空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:51:44.253

[您可以使用SecureRandom](http://docs.oracle.com/javase/6/docs/api/java/security/SecureRandom.html)添加随机算法：

```
 KeyGenerator keyGen = KeyGenerator.getInstance("AES");
    SecureRandom random = new SecureRandom(); // cryptograph. secure random 
    keyGen.init(random); 
    SecretKey secretKey = keyGen.generateKey(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T19:58:32.920

听起来您正在尝试根据密码生成 AES 密钥。

If this is the case, you can use javax.crypto.SecretKeyFactory's `generateSecret` method, passing in a javax.crypto.spec.PBEKeySpec as the parameter. The PBEKeySpec allows to to specify the password as an argument to its constructor.

# jquery - jquery / knockout.js 并返回过滤后的新对象数组

> ID：10252455
> 
> 赞同：0
> 
> 时间：2012-04-20T19:33:38.847
> 
> 标签：jquery, arrays, knockout.js

有没有办法使用 knockout.js 或 jquery 返回过滤后的新对象列表。我想返回具有 IsSelected 的项目列表并从中创建一个新对象，否则我不想返回它。

```
return ko.utils.arrayForEach(result.items, function (item) {
    if (item.IsSelected)
        return {};
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T19:45:34.527

您可以使用 JQuery 的`filter()`功能：

```
return $(result.items).filter(function() {
  return this.IsSelected;
}); 
```

见[http://api.jquery.com/filter/](http://api.jquery.com/filter/)

更好的是，您可以使用`grep()`（参见[http://api.jquery.com/jQuery.grep/](http://api.jquery.com/jQuery.grep/)）：

```
var arr = $.grep(result.items, function(item) {
  return item.IsSelected;
});
return arr.length > 0 ? arr : false; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T20:47:33.663

你的两个答案都有帮助。我在下面做了这个。

```
result.selected = ko.computed(function () {
        return ko.utils.arrayMap(getSelectedItems(result.items()), function (item) {
            return { Id: item.Id };
        });
    }, result);

    function getSelectedItems(items) {
        return ko.utils.arrayFilter(items, function (item) {
            return item.IsSelected();
        });
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:50:26.623

jQuery.grep 将迭代一个数组并根据您的条件返回一个数组。然后你需要迭代这个数组并 clone() 对象以获得你想要的结果。

[http://api.jquery.com/jQuery.grep/](http://api.jquery.com/jQuery.grep/)

```
var arr = [{foo:1, bar: 2}, {foo: 2 , bar: 3}, {foo: 10, bar: 2}];
var x = jQuery.grep(arr, function (item, i) {
    return item.foo < 5;
});
//x = [{foo:1, bar:2}, {foo: 2, bar: 3}]

var y = [];
// here is the create a new object part
// clone your objects (you could use jQuery.clone() if they are elements).
x.each(function (item) {
   y.push(jQuery.extend({}, $(this)));
}); 
```

# c - 用于测量通过 LAN 在两个系统之间发送不同数量的数据所花费的时间的程序

> ID：10252470
> 
> 赞同：0
> 
> 时间：2012-04-20T19:34:50.460
> 
> 标签：c, sockets, network-programming

我想测量通过 LAN 在两个系统之间发送不同数量的数据所花费的时间。

我想用 C 编写代码。

任何人都知道如何去做吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:55:31.687

制作一个简单的回显客户端服务器并测量从发送到回复所花费的时间

您需要的功能`bind` `socket` `listen` `accept` `read` `write`。所有文档都可以在手册页 (2) 中找到。

```
int sock = socket(AF_INET, SOCK_STREAM, 0);
char buf[1024];
struct sockadd_in host;
/* ... set up params ... */
int connfd = connect(sock, &host)

time_t now = time(NULL);
time_t then = 0;
time_t delta_t = 0;
write(connfd, "hi", strlen("hi"));
read(connfd, buf,1024); 
then = time(NULL);

delta_t = then - now; 
```

这是它应该看起来的样子（粗略的伪/C代码）

# php - Apache 不会请求我的 SSL 客户端证书

> ID：10252476
> 
> 赞同：17
> 
> 时间：2012-04-20T19:35:17.627
> 
> 标签：php, linux, apache, ssl, openssl

首先，请注意我是配置 SSL 的新手。过去，我一直很幸运有一个 IT 部门提前为我设置。因此，请做好准备，我可能需要对您的一些答案进行澄清。=)

**我想要做什么**

我正在为员工建立一个公司内部网站。例如，将有一个浏览器起始页，显示为每个员工定制的内容。因此，我需要能够在不需要任何用户名/密码或其他提示的情况下识别所述员工（尽管一次性设置是可以的；我只是不希望他们每次都被提示）。当然，SSL 似乎是最好的方法。

我将有一个 MySQL 数据库设置来将“用户”帐户与 SSL_CLIENT_M_SERIAL 和 SSL_CLIENT_I_DN 相关联，我假设每个客户端证书都是唯一的（？）。我从这篇文章中得到了这个想法：http: [//cweiske.de/tagebuch/ssl-client-certificates.htm](http://cweiske.de/tagebuch/ssl-client-certificates.htm)

用户第一次访问内部网站时，他们将没有证书（我不想为客户端手动生成它们！），在这种情况下 $_SERVER["SSL_CLIENT_VERIFY"] == "NONE"。如果发生这种情况，它将转到用户帐户设置页面，其中包括 PHP 生成 SSL 客户端证书并将其发送到浏览器以供用户安装的步骤。很好很简单。然后用户安装证书，建立关联，并在重新启动浏览器后（为了好的措施），用户返回内部网站。

此时，Apache 应该请求客户端证书，然后浏览器发送该证书。然后 PHP 脚本解析必要的 $_SERVER 变量，与 MySQL 数据库进行比较，所有人都度过了美好的时光。再一次，又好又简单。

**到目前为止的工作**

我安装了服务器端证书。是的，它们是自签名的（原因很明显）。Apache 安装了 mod_ssl，一切似乎都运行良好。我创建了一个 PHP 脚本，它只转储 $_SERVER 数组，并且所有 SSL_SERVER_* 键值都与我为它创建的证书匹配。

**问题**

我无法让客户端证书工作！在同一个 PHP 脚本中，无论我做什么，都缺少 SSL_CLIENT_VERIFY == "NONE" 和其他 SSL_CLIENT_* 键。如果我在 ssl.conf 中将 SSLVerifyClient 设置为可选，就会发生这种情况。根据我读过的每个教程，他们都说网络服务器应该向浏览器请求客户端证书。问题是，我不能让它这样做！它直接进入 PHP 脚本并假设我根本没有客户端证书。这发生在 Firefox、Chrome 和 IE 中。

所以我尝试将 SSLVerifyClient 设置为 required 并重新启动网络服务器。有了这个选项，我什至无法建立 SSL 连接。Firefox 只是说连接已被重置（其他浏览器也会显示他们自己的错误版本）。奇怪的是日志没有显示这些连接尝试的任何活动！即 access_log、error_log、ssl_access_log、ssl_error_log 和 ssl_request_log 都没有显示*任何*内容；就好像这种尝试从未发生过。这令人沮丧，因为这意味着我什至没有错误消息可供使用。只是一个网络服务器被动地告诉我下地狱。

我尝试使用 PHP 的 OpenSSL 扩展手动生成/安装我自己的客户端证书。证书安装得很好，虽然我找不到任何关于如何将该证书与服务器相关联的信息（假设我什至需要？）。此外，这似乎并不重要，因为如果设置了 optional，Apache 甚至不会请求客户端证书。如果设置了require，它只会在没有解释的情况下爆炸。无论如何，我都需要将其设置为可选，以使该模式正常工作。

**环境**

操作系统：CentOS 5.7 64 位（虚拟机）

阿帕奇：2.2.3

PHP: 5.3.10

我猜您可能需要更多信息来帮助我，所以请询问！我会为你提供你需要的任何东西。

总而言之，在上述条件下，我需要知道如何让 Apache 请求 SSL 客户端证书。此外，如果必须执行任何特殊的签名/等操作以使客户端证书与服务器证书“兼容”（同样，无需通过 shell 手动为每个客户端证书执行此操作！），我需要知道这一点出色地。

到目前为止，我 100% 坚持这一点。在 Google 上什至找不到任何有帮助的东西。非常感谢您对此提供的任何帮助！谢谢！=)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T01:34:30.513

首先，您需要配置 Apache Httpd 以请求客户端证书。为此，您至少需要在要使用`SSLVerifyClient optional`此方法进行身份验证的位置/目录上使用。

其次，客户端发送的证书也需要被 Apache Httpd 信任。（您原则上可以使用`SSLVerifyClient optional_no_ca`，让任何客户端证书通过 Apache Httpd SSL/TLS 堆栈，然后才在 PHP 中验证证书，但这是一项相当多的工作，您需要更加小心，因为这不是必须是简单的代码；更重要的是，在这种情况下这将毫无用处，因为您处于控制 CA 的场景中。）

据我了解，`SSL_CLIENT_VERIFY`（我自己并没有使用太多的变量）似乎只对`SSLVerifyClient optional_no_ca`. 它可能适用于`SSLVerifyClient optional`，但我对此表示怀疑。`SSLVerifyClient require`将拒绝使用不受信任的客户端证书（由`SSLCACertificateFile`/中的 CA 之一`SSLCACertificatePath`）或没有证书的连接。据我所知，`SSLVerifyClient optional`将让客户端在没有证书或受信任证书的情况下通过，但如果证书不受信任，也会拒绝连接。

在这里，通过拒绝连接，我的意思是突然关闭 SSL/TLS 连接并发出警报。没有机会产生 HTTP(S) 错误页面。所有你会得到标准浏览器错误，类似于`ssl_error_unknown_certificate_...`. （您应该从可用性的角度考虑这一点。）

从那时起，您需要建立自己的 CA，可能是基于 Web 的，具有浏览器内密钥生成功能，并且位于同一网站内。您不希望`SSLVerifyClient require`这样做，因为您需要让还没有证书的用户进入（使用`optional`）。话虽如此，这些指令不必适用于整个主机，但可以特定于某些位置/目录。

如果您不熟悉这一切，那么集成您自己的基于 Web 的 CA（或更一般地说，创建您自己的 CA）并不一定容易。存在现成的工具（例如[OpenCA ），或者您可以使用各种](http://www.openca.org/projects/openca/)[JavaScript/ActiveX](https://github.com/harbulot/keygenapp/blob/master/samplewebapp/src/main/webapp/crosskeygen.js)构建自己的工具，并且您需要服务器端代码来处理 SPKAC 或 PKCS#10 请求（并颁发实际证书） . （为了使这样的 CA 有用，您希望申请新证书的用户在申请时提供一些身份证明，也许是密码。）

设置好后，您应该配置`SSLCACertificateFile`（或`...Path`）指向您的内部 CA 的 CA 证书（无论它是否是基于 Web 的 CA，是否在同一站点上）。（当然，保持 CA 的私钥是私有的，可能在基于 Web 的 CA 应用程序中配置，但 Apache Httpd 本身不需要知道它。）浏览器只会建议由这些 CA 或中间机构颁发的证书（除非您还配置`SSLCADNRequestFile`了 ，它将用于发送接受的 CA 列表）。

请注意，这两个步骤（设置您的 CA 和设置您的网站以使用客户端证书）实际上是独立的。两者都可以是同一站点的一部分这一事实可能很方便，但不是必需的。您可以在不首先在站点上部署整个 CA 的情况下尝试 Apache Httpd 设置（我建议您这样做，即使它只是为了看看您要进入的内容）。有许多工具可以创建您自己的小型 CA，只需少量证书即可管理：例如[OpenSSL 的 CA.pl](http://www.openssl.org/docs/apps/CA.pl.html)或[TinyCA](http://tinyca.sm-zone.net/)。您也可以使用这些[测试证书](http://code.google.com/p/jsslutils/source/browse/#svn/trunk/certificates/src/main/resources/org/jsslutils/certificates/local)（如果您想使用 CRL `localhost`，则`testclient`,`testclient_r`将被撤销，一开始可能不需要）：所有密码都是`testtest`.

正如您已经预料到的（使用您的 MySQL 数据库），您需要管理您颁发的证书并将它们映射到用户。`SSL_CLIENT_M_SERIAL`并且`SSL_CLIENT_I_DN`不是正确使用的变量。`SSL_CLIENT_I_DN`是颁发者 DN（即 CA 的主题 DN）。您要查找的是`SSL_CLIENT_S_DN`：客户端证书主题 DN。`SSL_CLIENT_M_SERIAL`是证书序列号：不要使用它，因为它对每个证书都是唯一的：一个用户可以拥有多个具有相同主题 DN 的证书（例如，如果一个过期或被撤销）。

* * *

尽管如此，我不确定客户证书是否是实现您目标的最佳方式（让您公司的员工无需密码即可登录）。

*   首先，用户无论如何都应该使用密码保护自己的证书。我猜你真正想要的是某种形式的单点登录 (SSO)。

*   其次，根据用户的计算机知识程度，证书实际上可能很难管理。

    严格来说，“证书”一词根本不包括私钥，但有时暗示私钥的使用可能会让某些人感到困惑。一方面，您有时会听到“将您的证书导入浏览器”和“使用您的证书登录”；另一方面，您也可以听到“将您的证书发送给我”。前者意味着私钥的使用和可用性（“证书”可能只是`.p12`在这些表达中的意思）。后者绝对不应该涉及私钥。

    浏览器用户界面对于管理证书或注销来说往往很差或令人困惑。同样，如果证书未被识别，SSL/TLS 连接将不会建立，因此 Web 服务器没有机会显示任何类型的 HTML 错误页面。

也许您还可以考虑其他形式的 SSO（例如 CAS、基于 SAML 的东西或 Kerberos/SPNEGO。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T08:45:05.397

我有一个类似的问题：

*   CentOS 6.3
*   阿帕奇 2.2.15

经过一些尝试，我认识到我的问题。

如果我设置`SSLVerifyClient optional`or`SSLVerifyClient optional_no_ca`并且我还指定`SSLCACertificateFile`or `SSLCACertificatePath`，则 Apache 仅当它从配置中指定的 CA 参考文件/路径中的 CA 释放时才会获取客户端证书。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-20T21:18:07.563

如果尚未完成 ，您可以查看[apache 文档。](http://httpd.apache.org/docs/2.0/ssl/ssl_faq.html)

一般原则是您创建自签名证书并在尝试使用它之前对其进行检查。

然后看起来客户端通过http连接到您的Intranet站点。从那里，有许多不同的方法可以使用您的 ssl 证书切换到 https。最简单的方法是使用 apache rewrite 模块。但是在您的情况下，当您进行 php/mysql 检查时，您可能会将客户端从 http 重定向到 https，这不是简单的方法。

在这两种情况下（通过 mod_rewrite 的 apache 自动重定向，或通过级联测试（php/javascript/html）进行重定向），您需要以正确的方式设置 2 个虚拟主机（一个用于 http，一个用于 https），但这假设一些假设。

例如（debian - apache 2.2），这是一个自动重定向，由 Apache 完成（例如上述第一种情况）：

cat /etc/apache2/sites-available/test

```
# VHOST test

<VirtualHost *:80>

    DocumentRoot /home/www/test
    ServerName www.test.dev

    # ######################
    # Redirect commons
    # ######################
    RewriteEngine on
    # Case of vhosts
    RewriteOptions Inherit

    # ######################
    # Redirect (empty index)
    # ######################

    # Condition 1 to redirect : request matching with the server
    RewriteCond %{HTTP_HOST}   ^www\.test\.dev [NC]

    # Condition 2 to redirect : non empty HOST
    RewriteCond %{HTTP_HOST}   !^$

    # Automatic Empty requests Redirect
    RewriteRule ^(.*)/$ /index.php

    # ######################
    # Redirect to SSL
    # ######################
    RewriteCond %{HTTP_HOST}   ^www\.test\.dev [NC]
    RewriteCond %{HTTP_HOST}   !^$
    RewriteCond %{SERVER_PORT} ^80$
    RewriteCond %{REQUEST_URI} /

    # Redirection
    RewriteRule ^/(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [L,R]

</VirtualHost> 
```

SSL 的第二个虚拟主机：cat /etc/apache2/sites-available/test-ssl

```
# VHOST for ssl 
```

```
DocumentRoot "/home/www/test"
ServerName www.test.dev

    # SSL
    SSLEngine on
    SSLCACertificateFile /etc/apache2/ssl/cur_cert/ca.pem
    SSLCertificateFile /etc/apache2/ssl/cur_cert/serveur.pem
    SSLCertificateKeyFile /etc/apache2/ssl/cur_cert/serveur.key

    <Directory "/home/www/test">
        Options FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        Allow from 127.0.0.1 192.168.0.0/16
    </Directory>

    <Directory "/home/www/test/cgi-bin">
        Options FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        Allow from 127.0.0.1 192.168.0.0/16
        Options +ExecCGI
        AddHandler cgi-script .cgi
    </Directory>

</VirtualHost> 
```

您的情况可能与此略有不同，例如，您不会在第一个虚拟主机中拥有重定向部分，而只有一个简单的虚拟主机和第二个用于 https (ssl) 的虚拟主机。完成 mysql 检查后，重定向将由 php/javascript 完成。

这是一个来自 php 类的示例摘要，用于将切换从 http 级联到 https，使用 php，然后是 javascript，然后是 html：

```
public function Redirect($url){

    if (TRUE !== Validator::isValidURL($url))
        die ("FATAL ERR: url not valid");

    // PHP ABSOLUTE URL REDIRECT (HTTP1.1)
    if (!headers_sent()) {

        header("Status: 200");
        header("Cache-Control: no-cache, must-revalidate"); // required for HTTP/1.1
        header("Expires: Sat, 26 Jul 1997 05:00:00 GMT"); // past Date
        header("Pragma: no-cache");
        header('Location: '.$url); // note: 302 code return by default with "Location"
        flush();
        exit();

        // if headers are already sent... do javascript redirect... if javascript is disabled, do html redirect.
    } else {

        // Js redirect
        echo '<script type="text/javascript">';
        //echo "<!--";
        echo 'document.location="'. $url .'";';
        //echo "//-->";
        echo '</script>';

        // HTML redirect if js disabled
        echo '<noscript>';
        echo '<meta http-equiv="refresh" content="0;url="'.$url.'" />';
        echo '</noscript>';

        exit();
    }

    return FALSE;

} /* end of method (redirect) */ 
```

希望它可以帮助您更好地了解如何继续并根据您的具体情况调整这种方法。

# sql - 如何将存储过程的所有 DDL 和脚本放入 SQL Server 2008 的 TFS？

> ID：10252484
> 
> 赞同：0
> 
> 时间：2012-04-20T19:36:08.217
> 
> 标签：sql, sql-server-2008

SQL Server 2008 提供了一个解决方案探索。我有一个现有的数据库，其中包含许多存储过程、触发器、函数、视图。

所以我希望所有这些脚本和 DDL 都可以像 .NET 代码一样通过 Visual Studio 连接到 TFS 进行维护。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:39:27.327

如果您使用的是 Visual Studio 2010，您可以创建一个数据库项目，将 DDL 从您的数据库导入到项目中，然后像任何其他项目一样提交到源代码管理。

# sql - 需要concat这两个结果

> ID：10252486
> 
> 赞同：1
> 
> 时间：2012-04-20T19:36:22.693
> 
> 标签：sql, oracle

我需要连接以下 SQL 语句返回的字符串。

```
 select substr(IB_TGTLOCATION,INSTR(IB_TGTLOCATION,'/',1,3)+1) from PSIBSVCSETUP; 
```

和

```
 select substr(connurl,1,INSTR(connurl,'/',1,3)) from PSGATEWAY where LOCAL_FLAG='Y'; 
```

并使用上述两个 select 语句的连接结果而不是 UPDATEDSTRING 文本更新此表。

```
Update PSIBSVCSETUP SET IB_TGTLOCATION=('UPDATEDSTRING') where SEQNO=1; 
```

谢谢，斯里拉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:46:15.637

如果两个查询都返回一行

```
Update PSIBSVCSETUP SET IB_TGTLOCATION=(
 (select substr(IB_TGTLOCATION,INSTR(IB_TGTLOCATION,'/',1,3)+1) from PSIBSVCSETUP) || 
 (select substr(connurl,1,INSTR(connurl,'/',1,3)) from PSGATEWAY where LOCAL_FLAG='Y')
) where SEQNO=1; 
```

否则你必须加入表格。

# ruby-on-rails - Ruby on Rails，Running Guard，因“Killed”而立即死亡

> ID：10252488
> 
> 赞同：5
> 
> 时间：2012-04-20T19:36:26.177
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, spork, guard

我已经根据 Ryan Bates 的 RailsCast（在 Linux Mint 12 下）安装了 guard 和 spork，并且一旦启动，guard 进程就会显示“Killed”。运行“bundle exec guard --verbose”给出：

bundle exec guard --verbose DEBUG (12:17:27): 命令执行: which notify-send

Guard 使用 NotifySend 发送通知。

Guard 现在正在观看 'path_to_project'

DEBUG (12:17:27): Hook :start_begin 为 Guard::Spork 执行

调试 (12:17:27)：命令执行：ps aux | awk '/spork/&&!/awk/{print $2;}'

调试 (12:17:27)：杀死 PID：8884 的 Spork 服务器

被杀

我已经尝试调整保护 gem 文档的“高级 Linux 系统配置”（max_queued_events 和 max_user_instances、max_users_watches）中的值。在比所有人的默认值高得多的情况下，没有任何乐趣。

有任何想法吗？如果是这样，请提前感谢。到目前为止，Google-fu 没有透露任何对这个特定问题有用的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T04:29:39.707

我时不时地看到这种情况发生。您需要做的是找到正在运行的 spork 进程并将其杀死。例如：

```
ps aux | grep spork 
```

注意任何活动 spork 进程的 pid（第一列）。如果它恰好是 123，则键入：

```
kill 123 
```

然后重新开始警戒。

# python - python线程中的无限循环

> ID：10252491
> 
> 赞同：2
> 
> 时间：2012-04-20T19:36:58.907
> 
> 标签：python, multithreading, while-loop

即使服务器不接受我在客户端编写了以下功能的连接，我也在尝试从客户端到服务器端不断地通过时间

```
def run(self):

    print "running client"  
    start = datetime.now().second
    while True:
        try:
            host ='localhost'
            port = 5010
            time = abs(datetime.now().second-start)
            time = str(time)
            print time
            client = socket.socket()
            client.connect((host,port))
            client.send(time)

        except socket.error:
            pass 
```

现在我在另一个类中，它的名字是 loginGui，我想在线程的帮助下执行上面的全局函数运行，以便客户端在我的其余客户端代码执行时不断地将时间抛出到服务器端。所以我在类 loginGui 中编写了以下代码

```
class loginGui:
    def run_client(self):
            thread.start_new_thread(run,()) 
```

当我调用上述函数 run_client() 时，线程运行但由于某些原因它退出循环并停止浪费时间，所以我尝试了另一种方法..

```
class FuncThread(threading.Thread):

    def __init__(self, target, *args):
        self._target = target
        self._args = args
        threading.Thread.__init__(self)

    def run(self):
        self._target(*self._args) 
```

我写了上面的类，然后在 run_client() 函数中我做了以下更改..

```
def run_client(self):

    t1 = FuncThread(run,())
    t1.start()
    t1.join() 
```

现在，当我调用 run_client() 时，它会创建一个线程并调用全局函数 run() 但现在的问题是它在 while 循环中被击中并不断浪费时间。

结论：我基本上想要的是创建一个线程来调用我的函数运行并不断投入时间而不会陷入while循环..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:45:40.817

在您的第一个示例中，您的 while 循环以极快的未经检查的速度触发，一遍又一遍地创建未关闭的连接。您需要尝试在那里设置某种类型的限制，无论是睡眠还是类似的东西。尝试重用相同的客户端，而不是丢弃它们。您可能会遇到其他类型的异常，例如最终耗尽资源。如果您上次创建失败，您只需要尝试创建一个新客户端。不仅仅是每次您想发送另一位数据时。

在您的第二个示例中，您所做的几乎与以前相同，只是将代码移动到实际的线程类中，然后您调用`join()`which 将在主线程中阻塞，直到您的线程完成。

简而言之，我认为问题不在于您在哪里构建此线程类，而在于您如何以一种浪费的方式使用套接字连接。

这个例子有点难看，但我认为它会给你一个起点：

```
import time

def run(self):

    print "running client"  
    start = datetime.now().second
    host ='localhost'
    port = 5010

    client = None

    while True:

        if client is None:
            client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            try:
                client.connect((host,port))
            except socket.error:
                print "Connection failed. Retrying."
                client = None
                time.sleep(.25)
                continue

        time = str(abs(datetime.now().second-start))
        print time
        try:
            client.sendall(time)
        except:
            print "Send error."
            client.close()
            client = None

        time.sleep(.25) 
```

# mysql - 为什么我在 mysql 查询中更改参数时出现连接错误

> ID：10252495
> 
> 赞同：0
> 
> 时间：2012-04-20T19:37:13.320
> 
> 标签：mysql

我喜欢加入 3 个表来获取数据：table1 中的必填字段和 table2 中的 record_count 以及 table3 中的 sum(amount)

我正在使用以下查询：

```
select a.cde,a.name,count(b.TransID) as t_cnt, 
       sum(c.Amt) as c_sumofamt 
from table1 a 
inner join table2 b 
    on a.cde=b.cde 
inner join table3 c 
    on a.cde=c.cde 
where a.Bcde='TVM' GROUP BY a.cde; 
```

注意：如果 (where `a.Bcde='TVM'`) 但不能与任何其他 branch_code " `Bcde`"一起工作，它可以正常工作

TVM 的记录很少（只有 40 条记录）

但是如果我给（`where a.Bcde='CBE'`）它不起作用 - 需要很长时间并给出conn。呃。

供您参考，它有更多记录：

```
6000+ records in table1
50000+ records in table2
100000+ records in table3 
```

如何处理这种情况？期待您的宝贵答复。

问候，森萨。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T08:33:09.580

首先，我要感谢大家在这篇文章中花费了宝贵的时间。

我在另一个论坛的人的帮助下得到了解决方案。

解决方案是：

```
select a.cde,a.name,count(b.TransID) as t_cnt, 
       sum(c.Amt) as c_sumofamt 
from table1 a 
inner join table2 b 
    on a.cde=b.cde 
inner join table3 c 
    on 
```

> b.cde=c.cde

```
where a.Bcde='TVM' GROUP BY a.cde; 
```

**注意**第二个内部连接。他们建议我从第二张桌子加入到第三张桌子 - 现在它工作正常。

但是我不知道如果我使用： a.cbe=c.cde 而不是 b.cde=c.cde 有什么区别？

如果有人知道，请与我分享。

期待您在这方面的宝贵答复。

# css - 如何编辑谷歌浏览器内部 CSS 或 JS 文件（源代码）？

> ID：10252498
> 
> 赞同：1
> 
> 时间：2012-04-20T19:37:46.067
> 
> 标签：css, google-chrome

众所周知，Chrome 中的所有菜单和设置都是由 CSS 文件和 javascripts 管理的。是否可以编辑此 CSS 文件或/和 JS 来管理菜单/设置等？

例如 chrome://settings/options_bundle.js 或 chrome://resources/css/button.css 是否可以以某种方式更改这些文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T09:46:47.603

有两种方法可以做到这一点。第一种方法很简单，但速度很慢：

1.  下载源（它将是 Chromium，而不是 Chrome）（[http://git.chromium.org/gitweb/?p=chromium/src.git](http://git.chromium.org/gitweb/?p=chromium/src.git)）
2.  编辑一些文件（例如[http://git.chromium.org/gitweb/?p=chromium/src.git;a=blob;f=chrome/browser/resources/options/browser_options.js;h=548a6068d4007f25427caf70b04c26575dafbc3d;hb =头](http://git.chromium.org/gitweb/?p=chromium/src.git;a=blob;f=chrome/browser/resources/options/browser_options.js;h=548a6068d4007f25427caf70b04c26575dafbc3d;hb=HEAD)）
3.  编译`packed_resources`和`packed_extra_resources`定位，将新创建的`resources.pak`和`chrome.pak`文件放在适当的位置。

另一种方法是某种作弊：

1.  `resources.pak`在安装目录中找到文件。Chrome 使用的所有资源都放置在此文件中。它就像一个没有压缩的存档。
2.  编辑此文件。但是您更改的长度必须与原始文本的长度完全相同。例如：

    ```
    Before:
    {
    color: red;
    }
    (length: 15)

    After:
    {color: green;}
    (length: 15) 
    ```

您可以通过更深入地了解 pak 文件格式来克服此限制（很好地描述了[https://code.google.com/p/grit-i18n/source/browse/trunk/grit/format/data_pack.py?r=79](https://code.google.com/p/grit-i18n/source/browse/trunk/grit/format/data_pack.py?r=79) )

![这是一个结果](../Images/e00b6dbb8649cde05bc76d8a0cef9dec.png)

# python - Heroku (Python) Facebook 应用程序“不正确的填充”错误

> ID：10252503
> 
> 赞同：0
> 
> 时间：2012-04-20T19:38:04.440
> 
> 标签：python, facebook, heroku

我正在关注 Heroku-Facebook 应用程序教程，但在尝试在 Facebook 中查看我的应用程序时出现错误。与默认应用主页相反，屏幕上会出现以下错误和回溯。

```
TypeError
TypeError: Incorrect padding

Traceback (most recent call last)

File "/app/lib/python2.7/site-packages/flask/app.py", line 1306, in __call__
return self.wsgi_app(environ, start_response)

File "/app/lib/python2.7/site-packages/flask/app.py", line 1294, in wsgi_app
response = self.make_response(self.handle_exception(e))

File "/app/lib/python2.7/site-packages/flask/app.py", line 1292, in wsgi_app
response = self.full_dispatch_request()

File "/app/lib/python2.7/site-packages/flask/app.py", line 1062, in full_dispatch_request
rv = self.handle_user_exception(e)

File "/app/lib/python2.7/site-packages/flask/app.py", line 1060, in full_dispatch_request
rv = self.dispatch_request()

File "/app/lib/python2.7/site-packages/flask/app.py", line 1047, in dispatch_request
return self.view_functions[rule.endpoint](**req.view_args)

File "/app/exampleap 
```

修复此错误需要采取哪些具体步骤？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T03:14:15.893

在您的应用程序中，更改此行：

```
data = json.loads(urlsafe_b64decode(str(encoded_data[1]))) 
```

进入这一行：

```
data = json.loads(urlsafe_b64decode(str(encoded_data[1]) + (64-len(encoded_data[1])%64)*"=")) 
```

这个对我有用

# tridion - Content Porter 2009 SP1 报告“无法获取子项列表”

> ID：10252504
> 
> 赞同：4
> 
> 时间：2012-04-20T19:38:15.913
> 
> 标签：tridion

我可以连接到内容管理器并且我正在使用管理用户，但是当它开始向我显示内容管理器的内容时​​，我收到一个弹出对话框，上面写着“无法获取子项列表”。

我定义了 4 个出版物，默认项目、根结构组和根中的页面，所以我应该有一个可供选择的项目层次结构。

Content Porter 客户端日志中没有报告任何内容，我在服务器 Tridion 事件日志中只看到了这个条目，但我认为这只是因为我继续导出时只选择了服务器 - 显然没有任何子项，有没有什么可出口的。

> 找不到文件“C:\Program Files (x86)\Tridion\Content Porter\temp\export_9a1e48db0f124f19b5e519f179faf8c8.zip”。
> 
> 组件：内容搬运工错误代码：0 用户：TRIDION\adminuser
> 
> 在 System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) 在 System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs , String msgPath, Boolean bFromProxy, Boolean useLongPath) at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access) at Tridion.ContentManager.ImportExport.downloadfile.Page_Load(Object sender, EventArgs e)
> 
> 内部异常：

我在 Windows Server 2008 64 位上运行 Tridion 2011 SP1，如果有任何相关性的话。

谢谢，戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:04:01.903

您最近是否安装了修补程序 CP_3.1.0.75326？

仔细检查您是否遵循了修补程序自述文件中的步骤 7 和 8：

7 - 将此修补程序中的 Tridion.ContentManager.ImportExport.CommonFacade.dll 复制到“Tridion\Content Porter\bin”和“Tridion\Content Porter\ImportExportService\bin”文件夹（替换原始文件） 8 - 复制 cp.application、cp .exe.manifest 和 Tridion.ContentManager.ImportExport.CommonFacade.dll.deploy 文件从此修补程序到“Tridion\Content Porter\ImportExportService\Client”文件夹（替换原始文件）

还要确保从正在使用的客户端系统卸载/重新安装了 CP 客户端（自述文件中的第 11 步）。

# c# - 富文本框到字符串

> ID：10252506
> 
> 赞同：2
> 
> 时间：2012-04-20T19:38:22.963
> 
> 标签：c#, wpf, xaml, richtextbox, document

我有一个绑定到菜单项的richtextbox，以允许粗体、斜体和下划线以及剪切复制和粘贴。但是，您如何获取richtextbox 内容并将其从代码中转换为字符串，该字符串**将带有粗体、斜体等？**

```
 </DockPanel>
            <DockPanel Height="259" VerticalAlignment="Bottom">
            <Menu DockPanel.Dock="Top">
                <MenuItem Header="Edit">
                    <MenuItem Command="Cut" Header="_Cut" />
                    <MenuItem Command="Copy" Header="C_opy" />
                    <MenuItem Command="Paste" Header="_Paste" />
                </MenuItem>
            </Menu>
            <ToolBarTray DockPanel.Dock="Top">
                <ToolBar>
                    <Button Command="Cut" Content="Cut" />
                    <Button Command="Copy" Content="Copy" />
                    <Button Command="Paste" Content="Paste" />
                            <ToggleButton MinWidth="40"
                    Command="EditingCommands.ToggleBold"
                    CommandTarget="{Binding ElementName=XAMLRichBox}"
                    TextBlock.FontWeight="Bold">B</ToggleButton>
                            <ToggleButton MinWidth="40"
                    Command="EditingCommands.ToggleItalic"
                    CommandTarget="{Binding ElementName=XAMLRichBox}"
                    TextBlock.FontStyle="Italic">I</ToggleButton>
                            <ToggleButton MinWidth="40"
                    Command="EditingCommands.ToggleUnderline"
                    CommandTarget="{Binding ElementName=XAMLRichBox}">
                                <TextBlock TextDecorations="Underline">U</TextBlock>
                            </ToggleButton>
                        </ToolBar>
            </ToolBarTray>
                <RichTextBox HorizontalAlignment="Left" Margin="0,0,0,0" Name="richTextBox1"  Height="211" VerticalAlignment="Top" Width="398" /> 
```

在后面的代码中，我试图这样做（不确定如何做），但文本块只是作为**普通文本**出现，它不包含粗体等。

```
 private void button1_Click(object sender, RoutedEventArgs e)
    {
        string myText = new TextRange(richTextBox1.Document.ContentStart, richTextBox1.Document.ContentEnd).Text;
        textBlock1.Text = myText; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:01:22.103

您的问题的简单答案是：**您不能**。字符串不包含格式信息。您需要以`RichTextBox`支持文本格式的格式（如 RTF）存储 的内容。

# php - 找到完全匹配的正确 sql 命令是什么？

> ID：10252513
> 
> 赞同：-4
> 
> 时间：2012-04-20T19:38:44.073
> 
> 标签：php, sql, exact-match

下面的代码显然会搜索与查询变量相似的结果，但是搜索确切结果而不是“喜欢”的 SQL 命令是什么？

```
$query = "SELECT languages.language FROM languages WHERE language LIKE '%".$name."%'"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T19:40:02.147

您是否尝试过`=`运算符并删除`%`通配符？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:40:15.477

编辑：虽然我回答了你的问题，但值得指出的是，正如其他人所说，你的代码容易受到 SQL 注入攻击:)

对于完全匹配：

```
$query = "SELECT languages.language FROM languages WHERE language ='".$name."'"; 
```

对于非匹配：

```
$query = "SELECT languages.language FROM languages WHERE language <> '".$name."'"; 
```

# c# - 删除换行符不起作用

> ID：10252524
> 
> 赞同：1
> 
> 时间：2012-04-20T19:39:47.013
> 
> 标签：c#

所以我有这个方法：

```
public static string ToProperText(this HtmlHelper helper, string text)
{
    System.Diagnostics.Debug.WriteLine(text);
    System.Diagnostics.Debug.WriteLine(text.Replace("\r\n", ""));

    string lineSeparator = ((char)0x2028).ToString();
    string paragraphSeparator = ((char)0x2029).ToString();

    System.Diagnostics.Debug.WriteLine(text.Replace("\r\n", string.Empty).Replace("\n", string.Empty).Replace("\r", string.Empty).Replace(lineSeparator, string.Empty).Replace(paragraphSeparator, string.Empty));
    System.Diagnostics.Debug.WriteLine(text.Replace("a", ""));
    return null;
} 
```

当使用数据库中的一些数据调用时，输出如下：

```
<p>\r\n Vanaf nu worden de websiteberichten ook <u>automatisch</u> in de Nieuwssectie op het <strong>forum</strong> geplaatst.</p>\r\n
<p>\r\n Vanaf nu worden de websiteberichten ook <u>automatisch</u> in de Nieuwssectie op het <strong>forum</strong> geplaatst.</p>\r\n
<p>\r\n Vanaf nu worden de websiteberichten ook <u>automatisch</u> in de Nieuwssectie op het <strong>forum</strong> geplaatst.</p>\r\n
<p>\r\n Vnf nu worden de websiteberichten ook <u>utomtisch</u> in de Nieuwssectie op het <strong>forum</strong> gepltst.</p>\r\n 
```

无论我做什么， \r\n 都不会从字符串中删除，尽管其他替换确实有效。知道这里发生了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:43:32.247

在这里猜测..您是否尝试过：

```
text.Replace("\\r\\n", "")? 
```

"\r\n" 将替换真正的换行符，而不是实际的文本 '\r\n'：

[有哪些字符转义序列可用？](http://blogs.msdn.com/b/csharpfaq/archive/2004/03/12/what-character-escape-sequences-are-available.aspx)

或者，杜卢卡的选择也应该起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:43:35.640

该字符串可能已经被转义了。尝试

```
text.Replace("\\r\\n") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:43:16.373

尝试

```
System.Diagnostics.Debug.WriteLine(text.Replace(@"\r\n", "")); 
```

查找添加的 @ 符号。

# linker - Tool for discovering library dependencies based on missing symbols

> ID：10252528
> 
> 赞同：0
> 
> 时间：2012-04-20T19:40:01.957
> 
> 标签：linker, shared-libraries, symbols

I'm working on a 20 year old project with some ... interesting problems, among them: there's some shared objects with circular dependencies.

I'm attempting to map out the relationships between all the libraries, but it would be rather helpful if there's an existing tool capable of searching a list of libraries to see what can satisfy the missing dependencies.

For reference, they got around the problem by doing something like the following:

```
# True list of dependencies:
A: B
B: A
C: A

# Dependencies used in practice:
A:
B: A
C: A B 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T07:59:48.017

I haven't tested the following code, since I've just attempted to re-write this from memory, but the one I wrote to solve this earlier (it looks roughly like this one) works fine:

```
#!/usr/bin/env perl

using IPC::Open3;

my $queryFile = $ARGV[0];
shift;

my %missingSymbols = getSymbols( "nm -Aau", $queryFile );

my %symtbl;

foreach $lib ( @ARGV ) {
  my %temp = getSymbols( "nm -Aa --defined-only", $lib );

  foreach $key ( keys( %temp ) ) {
    $symtbl{$key} =   (defined($symtbl{$key}) ? "${symtbl{$key}} " : "")
                    . $temp{$key};
  }
}

my %dependencies;
foreach $symbol ( keys( %missingSymbols  ) ) {
  if( defined( $symtbl{$symbol} ) ) {
    foreach $lib ( split( / +/, $symtbl{$symbol} ) ) {
      if( !defined( $dependencies{$lib} ) ) {
        $dependencies{$lib} = 1;
      }
    }
  }
}

if( scalar( keys( %dependencies ) ) > 0 ) {
  print( "$queryFile depends on one or more of the following libs:\n\n" );

  print join( "\n", sort( keys( %dependencies ) ) ) . "\n\n";
} else {
  print( "Unable to resolve dependencies for $queryFile.\n\n" );
}

# Done.

sub getSymbols {
  my $cmd   = shift;
  my $fname = shift;

  checkFileType( $fname );

  open3( IN, OUT, ERR, "$cmd $fname" );

  my %symhash;
  close( IN );
  # If you leave ERR open and nm prints to STDERR, reads from
  # OUT can block.  You could make reads from both handles be
  # non-blocking so you could examine STDERR if needed, but I
  # don't need to.
  close( ERR );

  while( <OUT> ) {
    chomp;
    if( m/^(?:[^:]*:)+[a-zA-Z0-9]*\s*[a-zA-Z] ([^\s]+)$/ ) {
      my $temp = defined( $symhash{$1} ) ? "${symhash{$1}} " : "";
      $symhash{$1} = $temp . $fname;
    }
  }
  close( OUT );

  return %symhash;
}

sub checkFileType {
  my $fname = shift;

  die "$fname does not exist\n" if( ! -e $fname );
  die "Not an ELF or archive file\n" if( `file $fname` !~ m/ELF| ar archive/ );
} 
```

# c# - 返回 SqlDataReader

> ID：10252531
> 
> 赞同：12
> 
> 时间：2012-04-20T19:40:09.117
> 
> 标签：c#, ado.net

我有这个代码：

```
public static SqlDataReader GetGeneralInformation ( int RecID )
{
    using ( var conn = new SqlConnection( GetConnectionString() ) )
    using ( var cmd = conn.CreateCommand() )
    {
        conn.Open();
        cmd.CommandText =
        @"SELECT cs.Status, cs.Completed
          FROM NC_Steps s
          INNER JOIN NC_ClientSteps cs
              ON cs.RecID = s.RecID
          WHERE cs.ClientID = 162
          AND s.RecID = @value";
        cmd.Parameters.AddWithValue( "@value", RecID );
        using ( var reader = cmd.ExecuteReader() )
        {
            if ( reader.Read() )
            {
                return reader;
            }
            return null;
        }
    }
} 
```

我如何参考这个？

我试过这个，但它不起作用。

```
SqlDataReader reader = GeneralFunctions.GetGeneralInformation(); 
```

另外，我将如何从读者那里阅读？

```
Reader.GetString( reader.GetOrdinal( "Status" ) ) 
```

**编辑**：

我现在收到以下错误：

> 异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。

这是更新的代码：

```
public static IEnumerable<IDataRecord> GetGeneralInformation ( int ClientID )
{
    using ( var conn = new SqlConnection( GetConnectionString() ) )
    using ( var cmd = conn.CreateCommand() )
    {
        conn.Open();
        cmd.CommandText =
        @"SELECT i.GoLiveDate, i.FirstBonusRun, i.TechFName, i.TechLName, i.TechEmail, i.TechPhone, i.WebISPFName, i.WebISPLName, 
          i.WebISPEmail, i.WebISPPhone, i.FullFillFName, i.FullFillLName, i.FullFillEmail, i.FullFillPhone, d.FName,
          d.LName, d.HomePhone, d.Email
          FROM NC_Information i
          INNER JOIN Distributor d
            ON d.DistID = i.ClientID
          WHERE clientID = @value";
        cmd.Parameters.AddWithValue( "@value", ClientID );
        using ( var reader = cmd.ExecuteReader() )
        {
            while ( reader.Read() )
            {
                yield return reader;
            }
            yield return null;
        }
    }
}

protected void Page_Load(object sender, EventArgs e)
{
    IEnumerable<IDataRecord> reader = GeneralFunctions.GetGeneralInformation( (int)Session[ "DistID" ] );

    //string result = GeneralFunctions.GetGeneralInformation( Globals.GeneralInformation ).First()[ "Status" ].ToString();
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-20T19:45:54.093

问题是离开函数（通过 return 语句）会把你踢出`using`块，所以你正在使用的`SqlDataReader`和`SqlConnections`你正在使用的被处理掉了。要解决此问题，请尝试更改函数签名，如下所示：

```
public static IEnumerable<IDataRecord> GetGeneralInformation ( int RecID ) 
```

然后像这样更新函数的中间：

```
using ( var reader = cmd.ExecuteReader() )
{
    while ( reader.Read() )
    {
        yield return reader;
    }
} 
```

对于最后的“我如何从中阅读？” 部分，它可能看起来像这样：

```
int RecID = 12345;
string result = GetGeneralInformation(RecID).First()["Status"].ToString(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-22T00:19:18.830

将您的连接字符串添加到 app.config 或 web.config 中的 AppSettings 部分。

```
 public string GetSqlConnection()
    {
        return  System.Configuration.ConfigurationManager.AppSettings["SqlConnectionString"];
    } 
```

//返回SqlDataReader结果的函数

```
 public SqlDataReader executeReader(string sql, SqlParameter[] parameters=null)
    {
        SqlConnection conn = new SqlConnection();
        conn.ConnectionString = GetSqlConnection();
        conn.Open();
        SqlCommand cmd = new SqlCommand();
        cmd.Connection = conn;
        cmd.CommandText = sql;
        if (parameters != null)
        {
            cmd.CommandType = CommandType.StoredProcedure;
            foreach (SqlParameter p in parameters)
            {
                cmd.Parameters.Add(p);
            }
        }
        else
        {
            cmd.CommandType = CommandType.Text;
        }
        SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);
        return reader;
    } 
```

要使用该功能：

```
 string query = @"SELECT cs.Status, cs.Completed
      FROM NC_Steps s
      INNER JOIN NC_ClientSteps cs
          ON cs.RecID = s.RecID
      WHERE cs.ClientID = 162
      AND s.RecID = @value";
       //you can add more parameters by adding commas
       var parameters = new SqlParameter[] {
            new SqlParameter("@value", RecID )
           };

        SqlDataReader dr = executeReader(query, parameters);
        while (dr.Read())
        {
            //fill your controls with data 
        }
        dr.Close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-09T11:23:58.317

我相信[这个 StackOverflow 答案](https://stackoverflow.com/a/32264644/543814)值得一提。一个非常简单且易于使用的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-11T19:16:32.050

**问题是您正在方法中**创建数据库连接。

如果您要在许多方法之间**共享**数据库资源，请移出`SqlConnection`此范围。

通过这种方式，您可以从此函数返回 Reader 并且它将持续存在。

另外，不要`.Read()`在这个函数中，只返回对象。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-20T19:47:58.537

根据定义，`using`语句应该在调用对象后处理它。

因此，在您退回数据阅读器后，它会被丢弃。

# android - Android 应用程序，打开与移动设备的连接

> ID：10252536
> 
> 赞同：1
> 
> 时间：2012-04-20T19:40:34.657
> 
> 标签：android, sockets, websocket

在服务器和android应用程序之间创建双向持续通信的最佳方法是什么？

当我说持续通信时，我的意思是客户端向服务器请求数据或服务器不断向客户端推送数据。

据我所见，我不能使用 websockets，因为它们是服务器/浏览器设置的设计者。是对的吗？如果是这样，有什么替代方案？

在 Android 中是否有免费的框架可以使用它？

我想做的是一个像聊天但适用于多人的应用程序。所以他们都将在他们的设备上进入一个“房间或频道”，然后以服务器处理的方式相互交互。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:47:48.190

据我所知，一种可能的方法是使用客户端可以连接到服务器的 web 服务，如果 web 服务是 RESTFul 有很多库可以访问它，其中之一是 apache HTTPClient ，用于服务器推送我知道的唯一方法是将数据推送给客户的 C2DM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:51:54.650

对于持续打开的数据连接，您可以使用[Sockets](http://developer.android.com/reference/java/net/Socket.html)。但是您还应该考虑这样一个事实，即始终打开的连接也会很快耗尽您的电池电量。有关更多详细信息，请阅读[此](http://android-er.blogspot.se/2011/01/simple-communication-using.html)内容和[此内容](http://thinkandroid.wordpress.com/2010/03/27/incorporating-socket-programming-into-your-applications/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T10:19:45.547

你可能想看看 AutobahnAndroid：

[https://github.com/tavendo/AutobahnAndroid](https://github.com/tavendo/AutobahnAndroid)

它提供了原生的 Android/Java WebSocket 客户端框架（加上 WAMP = PubSub/RPC over WebSocket .. [http://wamp.ws](http://wamp.ws)）。

这与服务器浏览器客户端的 WebSocket 服务器完全可互操作。

AutobahnXX 库（其中 XX = Python、JS、Android）是开源的（Apache 2.0）。我们（Tavendo）正在提供基于高速公路的商业虚拟设备：http: [//autobahn.ws](http://autobahn.ws)

免责声明：我是 Autobahn 的作者，为 Tavendo 工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-26T09:22:23.003

但是在 iOS 和 Android 设备上保持连接在后台运行确实会消耗电池电量，对于遇到此问题的人，我建议在应用程序不在前台时使用推送通知。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-13T17:05:17.330

> 据我所见，我不能使用 websockets，因为它们是服务器/浏览器设置的设计者。是对的吗？如果是这样，有什么替代方案？

Websocket 是一个 IETF/W3C 协议，因此它并不局限于特定的客户端平台。您可以使用 Android websocket 在 Android 和服务器端之间进行双向通信。对于 Android websocket 客户端，我推荐使用[AndroidAsync](https://github.com/koush/AndroidAsync)。它具有在 Android 和服务器之间建立通信链接和交换数据所需的所有 websocket API。

# c++ - 搜索链表，不同的数据类型

> ID：10252538
> 
> 赞同：3
> 
> 时间：2012-04-20T19:40:51.617
> 
> 标签：c++, search, linked-list

我的任务是制作一个程序，按标题、类型、年份、评级、男主角等搜索 400 多部电影（使用链接列表链接在一起）。

但是有一个问题，我们只允许一个搜索函数通过链表进行搜索。此外，在该搜索功能中，我们只允许使用一个 while 循环——我假设在我的情况下将类似于......

```
 while (moviePtr != NULL) 
```

显然，如果是演员搜索或类型搜索，它们将有许多不同的实例。对于演员、流派、评级、年份、子流派和配角，它应该输出找到的每一个实例。（例如，如果 Kevin Bacon 在 x-men 和 notebook 中，它应该输出两者而不仅仅是其中一个（输出文件而不是屏幕））。

我发现自己完全被我们给予的这些限制所困扰。我的搜索功能将如何处理不同的数据类型？（年份和等级必须声明为整数）。它怎么会知道我到底在寻找什么？如果我正在搜索演员，我不希望它也搜索标题。

任何关于如何开始和开始的建议都非常感谢。

编辑：大家好，我想更新你们我所做的事情。我有 3 种不同的搜索功能。一个用于数值（年份和评级），1 用于类型和演员，最后一个用于标题。

这是所有三个的代码。首先是标题搜索。

```
void TitleSearched(MovieNode*head,
                string titleSearched,
                ofstream& outFile)
{
MovieNode* moviePtr;
bool found;

moviePtr = head;
found = false;

while (moviePtr !=NULL & !found)
{
    if (moviePtr-> title == titleSearched)
    {
        found = true;
    }
    else
    {
        moviePtr = moviePtr -> next;
    }

}
if (found)
{
    cout << endl << titleSearched << " has been found!\n";
    TitleOutput (moviePtr,outFile);
}
else
{
    cout << endl << titleSearched << " was not found.\n";
}
} 
```

现在是年份/评级搜索。

```
int NumSearched(MovieNode* head, int numSearched)
{

int instances;
MovieNode* moviePtr;

ofstream outFile;

    moviePtr = head;
    instances = 0;
    while (moviePtr !=NULL)
    {
        if (moviePtr-> year == numSearched)
        {

            instances = instances +1;
            NumOutList(moviePtr,outFile,"year",numSearched,instances);
            moviePtr = moviePtr -> next;
        }
        else if (moviePtr->rating == numSearched)
        {

            instances = instances +1;
            NumOutList(moviePtr,outFile,"rating",numSearched,instances);
            moviePtr = moviePtr -> next;
        }
        else
        {
            moviePtr = moviePtr ->next;
        }

    }
return instances;
} 
```

最后是流派/演员搜索。

```
int ItemSearch (MovieNode* head,string itemSearched, ofstream& outFile)
{
int instances;
MovieNode* moviePtr;

moviePtr = head;
instances = 0;

    while (moviePtr !=NULL)
    {
        if (moviePtr-> genre == itemSearched || moviePtr ->subGenre == itemSearched)
        {

            instances = instances +1;
            OutList(moviePtr,outFile,"Genre",itemSearched,instances);
            moviePtr = moviePtr -> next;
        }
        else if (moviePtr->leadActor == itemSearched || moviePtr->supportActor == itemSearched)
        {

            instances = instances +1;
            OutList(moviePtr,outFile,"Actor",itemSearched,instances);
            moviePtr = moviePtr -> next;
        }
        else
        {
            moviePtr = moviePtr ->next;
        }

    }

    return instances;
} 
```

我想提醒你们我的任务是什么。1\. 将这三个搜索函数合并为一个 2\. 在搜索中只有一个 while 循环 3\. 在任何给定函数中只有一个 return （但是，id 假设这将是一个组合时的 void 函数）

我相信我的主要问题是我的整数和字符串。我不允许将等级或年份声明为字符串。只是将这三者结合起来的代码格式让我很头疼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:36:13.240

除了传递函子来检查匹配的选项外，还有其他选项。一个这样的选项是采用一组可选条件来检查（您可以使用`boost::optional`手工方法，或使用指针。例如：

```
void print_matching( node* list, int * year, std::string * actor... ) {
   // iterate over the list:
   while (...) {
      if (  ( !year  || ptr->year == *year )
         && ( !actor || ptr->actor == *actor ) 
         && ...
         )
      {
          // Film matches, print it
      }
   }
} 
```

为了简化函数签名，您可以创建一个`search_pattern`封装您要测试的字段的类型（使用不同方法的示例：布尔值来确定可选性）：

```
struct pattern {
   bool check_actor;
   std::string actor;
   bool check_year;
   int year;
};

void print_matching( node* list, pattern const & p ) {
   // iterate over the list:
   while (...) {
      if (  ( !p.check_year  || ptr->year == p.year )
         && ( !p.check_actor || ptr->actor == p.actor ) 
         && ...
         )
      {
          // Film matches, print it
      }
   }
} 
```

在最后一种情况下，您实际上可以将测试移动到`pattern`对象中，并具有一个功能：

bool 模式::matches(电影成本& m) const { return (!check_year || m.year == year) &&(!check_actor || m.actor == actor); } void print_matching( node* list, pattern const & p ) { // 遍历列表：while (...) { if ( p.matches( list->data ) ) { // 电影匹配，打印 } } }

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:55:16.270

您可以以接受谓词作为参数的方式编写搜索函数。谓词是某种“functionoid”（意思是任何能够像函数一样被“调用”的东西——它可以是函数、lambda 或函数对象……）

在 C++ 标准库中，谓词用于许多标准算法，因此您通常会看到如下代码（使用标准容器）：

```
#include <iostream>
#include <string>
#include <vector>
#include <algorithm>
#include <cctype>

bool begins_with_s(std::string s)
{
    return  s.length() > 0                  && 
            std::toupper( s.at(0) ) == 'S';
}

bool contains_a_number(std::string s)
{
    return std::find_if(s.begin(), s.end(), std::isdigit) != s.end(); 
}

int main()
{
    std::string movies_array[] =  
    { 
        "King Kong", 
        "Singin in the Rain", 
        "Die Hard 2", 
        "Superman", 
        "Star Wars", 
        "Jaws 3"
    };
    std::vector<std::string> movies( std::begin(movies_array), 
                                     std::end(movies_array) );

    // Use predicate - count if the movie name begins with "S"
    std::cout << "Movies beginning with S: " 
        << std::count_if(movies.begin(), movies.end(), begins_with_s) 
        << std::endl;

    // Use predicate - count if the movie name contains a number
    std::cout << "Movies containing a number: " 
        << std::count_if(movies.begin(), movies.end(), contains_a_number) 
        << std::endl;
} 
```

以这种方式实现 C++ 标准算法的方式是接受一个表示谓词的模板参数，沿着

```
template< typename PredicateType >
void my_function(PredicateType predicate)
{
    Movie my_movie;
    predicate(my_movie);
} 
```

这是函数式编程思想中的一种技术——将函数传递给函数（将函数视为“一等公民”）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T19:57:28.210

您可以让搜索函数将“匹配”函数作为其参数之一，并在每部电影上调用此匹配函数以查看电影是否匹配。然后，您可以使用不同的匹配函数调用您的搜索函数。

像这样的东西：

```
template <typename MatchFunction>
void search_movies(movie* moviePtr, MatchFunction match)
{
    while (moviePtr != NULL)
    {
        if (match(*moviePtr))
        {
            // output movie
        }
        moviePtr = moviePtr->next;
    }
} 
```

然后，您可以像这样声明匹配函数：

```
bool matches_actor(movie& m, const std::string& actor)
{
    return m.actor == actor;
} 
```

并使用如下特定查询调用它：

```
search_movies(moviePtr, std::bind(matches_actor, _1, "Morgan Freeman")); 
```

(`std::bind`是来自 的 C++11 函数`<functional>`；您可以等效地使用`boost::bind`or `std::bind2nd`)

或者，如果你更喜欢 C 风格的做事方式，你可以这样做：

```
void search_movies(movie* moviePtr, bool (*match)(movie*, void*), void* match_arg)
{
    while (moviePtr != NULL)
    {
        if (match(moviePtr, match_arg))
        {
            // output movie
        }
        moviePtr = moviePtr->next;
    }
}
...
bool matches_actor(movie* m, void* actor)
{
    return m.actor == *((std::string*)actor);
}
...
std::string actor = "Morgan Freeman";
search_movies(moviePtr, &matches_actor, (void*)(&actor)); 
```

# php - 通过下拉菜单将 MySQL 内容动态加载到表中

> ID：10252539
> 
> 赞同：1
> 
> 时间：2012-04-20T19:40:53.150
> 
> 标签：php, jquery

我有以下问题：我想动态加载 MySQL 表格内容，而不使用下拉菜单刷新表格。我在此页面的帮助下使用纯文本：http: [//www.designing4u.de/2008/05/jquery-drop-down-loading-content-according-to-option/](http://www.designing4u.de/2008/05/jquery-drop-down-loading-content-according-to-option/) 但我不知道如何从 MySQL 表中获取内容并将其打印到表而不是纯文本。

例如，如果我有一个名为“Animal”的 MySQL 表，其中包含 3 个字段：Cat、Dog、Horse 和包含特定动物信息的第二个字段：

**动物**->

猫、狗、马 ->

是猫，是狗，是马

所以我创建了一个下拉列表：Cat、Dog、Horse，当按下其中一个时，它将特定动物的信息打印到 HTML 表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:55:36.057

首先我假设你已经连接到你的数据库

在浏览器中存储数据以在调用时显示

```
<?php
// Write out our query.
                 //colum         table          
$query = "SELECT username FROM rc_accounts WHERE isdm = '0'";
// Execute it, or return the error message if there's a problem.
$result = mysql_query($query) or die(mysql_error());
?> 
```

在下拉菜单中显示存储的数据

```
<?php
              $dropdown = "<select name='users'>";
while($row = mysql_fetch_assoc($result)) {
  $dropdown .= "\r\n<option value='{$row['username']}'>{$row['username']}</option>";
}
$dropdown .= "\r\n</select>";
echo $dropdown; ?> 
```

如果你从浏览器写什么，那么你需要这个，这不在我的网站上，它使用复选框来确认

```
<?php
if(isset($_POST['sure'])) {
mysql_query("UPDATE rc_accounts SET isdm = '1' WHERE username = '".$_POST['users']."'");
echo '<font color="#FFFF00"><b>GM Add Successfull.</font>';
} else {
echo '<font color="#FFFF00"><b>If you want to make this account a GM, then click the box!</font>';
}
?> 
```

# javascript - 破译一些神秘的遗留 JavaScript

> ID：10252541
> 
> 赞同：2
> 
> 时间：2012-04-20T19:41:05.537
> 
> 标签：javascript

快速提问（我认为）。鉴于这段代码：

```
SomeObject._gaCallbackStack.each( function(callback)
{
    if ($type(callback) == 'function') callback();
}); 
```

这里到底发生了什么？

代码是否为存储在回调堆栈中的每个函数调用名为“callback()”的函数？还是通过在变量名末尾附加“()”来调用回调堆栈中的每个函数？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T19:43:30.270

它似乎是一个遍历堆栈上每个元素的循环，其中可能包含函数。如果循环遇到一个函数，它会不带参数地执行它。

# ajax - Symfony Sonata AJAX 图像多上传

> ID：10252552
> 
> 赞同：1
> 
> 时间：2012-04-20T19:42:07.650
> 
> 标签：ajax, symfony, symfony-sonata

我正在尝试创建一个投资组合网站，并且一直在寻找一种处理图像的好方法。我已经集成了 SonataAdmin Bundle 并为“项目”和“图像”设置了管理类。我的目标是进入一个项目并向其中添加图像，然后选择其中一个图像作为项目缩略图。

理想情况下，我想集成一个 AJAX 多上传器。我不确定最好的方法，我正在寻找任何建议/想法。

我看过 Sonata Media Bundle，虽然它看起来比我实际需要的更强大，而且定制它的学习曲线似乎有点陡峭。我已经设置了一个图像实体（用于上传文档的 symfony2 食谱）我想我可以在图像和项目上创建多对一而不是使用 MediaBundle，尽管我仍然不知道如何集成 AJAX 脚本这。

提前感谢您的任何建议！肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T18:04:16.063

建议你看一下[https://github.com/punkave/symfony2-file-uploader-bundle](https://github.com/punkave/symfony2-file-uploader-bundle) 这个bundle基于优秀的blueimp jQuery-File-Upload包，提供多文件上传。

**编辑 28/04/14：**现在还有[OneUploaderBundle](https://github.com/1up-lab/OneupUploaderBundle)，它支持各种上传器，并且似乎正在更积极地开发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:04:30.697

结帐[https://github.com/ruian/RuianUploadifyBundle](https://github.com/ruian/RuianUploadifyBundle)它支持多重上传，但仅支持 Flash 插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T20:16:25.240

[这个捆绑包](https://github.com/dustin10/VichUploaderBundle)也值得一试。没有真正提到 AJAX，但在基本上传功能方面似乎非常强大。完成后，您可以自己进行ajaxify。我打算在几天内尝试这个捆绑包，我可能会稍后更新这个答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-23T18:11:02.047

所以我最终使用了 Valumns Ajax 多上传器：http: [//valums.com/ajax-upload/](http://valums.com/ajax-upload/)

我尝试自定义 Sonata 管理页面，但事实证明这有点困难，相反，我只是创建了一个专门用于上传批量图像的路由/控制器/视图。它似乎工作得很好！

# jquery-plugins - 如何在 JQuery 文件上传插件中以编程方式从队列中取消文件？

> ID：10252554
> 
> 赞同：1
> 
> 时间：2012-04-20T19:42:11.310
> 
> 标签：jquery-plugins, file-upload, queue

当用户将文件添加到队列中时，我必须验证所以我在回调中编写了一个函数：

```
$(document).ready( function() {
$('#fileupload').bind('fileuploadadd', function (e, data) {
    $.each(data.files, function (index, file) {
        check = ValidaDoc(file.name);
        if (check!="OK"){
            var erro="";
            if (check=="Alerta1"){
                alert("Alerta1");
            }
            else {
                errotemp="";
                if(check=="Erro1"){erro=erro + file.name + " com extensão não esperada.";}
                else if(check=="Erro2"){erro=erro + file.name + " não cadastrado ou com nome fora do padrão.";}
                $($('#fileupload .files .cancel button')[index]).click();
        }
    }
});
}); 
```

回调有效，ValidaDoc 函数有效，文件被取消但不是正确的。我认为索引的使用是不对的。有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T13:26:12.287

问题是我对索引的误解。我将调用 click 的行替换为下面的行，一切正常。

```
$($('#fileupload .files .cancel button')[data.context[index].rowIndex]).click(); 
```

我也必须改变事件。当调用 fileuploadadd 时，文件还没有在表中。所以改为fileuploadded。

```
$('#fileupload').bind('fileuploadadded', function (e, data) { 
```

# erlang - Rebar deps 配置中元素的含义

> ID：10252555
> 
> 赞同：6
> 
> 时间：2012-04-20T19:42:14.517
> 
> 标签：erlang, rebar

我们正在使用 rebar 为我们的项目拉取依赖项，其中许多来自 github。我们的配置看起来像：

```
{deps, [
        {cowboy, "", {git, "git://github.com/extend/cowboy.git", {branch, "master"}}}
       ]}. 
```

我已经足够了解了，并且通过反复试验，我学到了一些东西（例如，如何指定标签和变更集而不是分支），但是我的 google-fu 无法找到任何关于什么的综合文档选项可用或它们做什么。

我特别想知道第二个值的用途是（通常是空字符串，但我偶尔会在其中看到版本号和通配符），但是有关源代码控制选项的更多信息，或者只是一般的文档会有所帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T21:15:26.873

您可以在此处找到 rebar 的完整文档：

[https://github.com/rebar/rebar/wiki](https://github.com/rebar/rebar/wiki)

显示大部分可用选项的详细 rebar.config 示例可在以下位置获得：

[https://github.com/rebar/rebar/blob/master/rebar.config.sample](https://github.com/rebar/rebar/blob/master/rebar.config.sample)

从*deps*部分阅读：

```
%% What dependencies we have, dependencies can be of 3 forms, an application
%% name as an atom, eg. mochiweb, a name and a version (from the .app file), or
%% an application name, a version and the SCM details on how to fetch it (SCM
%% type, location and revision). Rebar currently supports git, hg, bzr and svn.
{deps, [application_name,
        {application_name, "1.0.*"},
        {application_name, "1.0.*",
         {git, "git://github.com/basho/rebar.git", {branch, "master"}}},
        {application_name, "1.0.*",
         {git, "git://github.com/basho/rebar.git", {branch, "master"}},
         [{alt_url, "https://github.com/basho/rebar.git"}]}]}. 
```

如您所见，您指出的特定参数与 Erlang 应用程序的版本（旨在作为 OTP 应用程序）有关。版本在[Erlang 应用程序文件](http://www.erlang.org/doc/man/app.html)中标明。

# encryption - 如何防止 SWF 在我们以外的网站上运行？

> ID：10252556
> 
> 赞同：1
> 
> 时间：2012-04-20T19:42:21.303
> 
> 标签：encryption, flash, cracking, swf-decompiler

我们发现一个中国网站已经想出了如何解密我们的 SWF，反编译它们，然后绕过我们输入的任何代码，以试图阻止 SWF 在我们以外的任何网站上运行。

随着中国程序员获得代码访问权，我们需要找出另一种方法来阻止他们在他们的网站上运行 SWF —— 至少在我们网站的有限排他期内（通常是一两周）。

我已经提议，但到目前为止，我们的开发组拒绝将 SWF 设为简单的客户端，从而将所有游戏逻辑放在我们的服务器上。

[根据这篇文章——http: //www.veryinteractivepeople.com/?](http://www.veryinteractivepeople.com/?p=525) p= 525——我还建议在加密的 SWF 中加密 SWF，但根据评论，我认为这对我们没有帮助.

有没有人有任何其他建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:50:48.973

您必须找到逻辑的一些关键部分（不仅仅是验证码）并将其设为 WebService。

它应该

*   不容易猜到/替换
*   使用小带宽
*   对反应时间要求不高

# merge - 从暂存中移动记录时，有哪些合并选项？

> ID：10252558
> 
> 赞同：1
> 
> 时间：2012-04-20T19:42:27.057
> 
> 标签：merge, sql-server-2008-r2, etl

我的ETL当前场景如下：

*   对于每对相同的表 dbo.T 和 staging.T
    *   从暂存中删除。T
    *   从远程 Web 服务中提取并加载到 staging.T
    *   对于 staging.T 中的每一行
    *   dbo.T有PK吗？
        *   是的，更新
        *   不，插入

我的主要疑问是围绕列列表的维护。

MERGE 语句似乎是最好的选择，但它似乎没有更新整行的能力。因此，我发现需要维护长列表：

```
Target.Column1 = Source.Column1, 
Target.Column1 = Source.Column1,
..., 
Target.ColumnN = Source.ColumnN 
```

我找到了这个[代码生成模板](http://devjourney.com/blog/using-t4-to-generate-sql-merge-scripts/)来帮助合并，但我非常想知道是否有标准方法来解决我刚才描述的问题，或者更重要的是，我是否遗漏了大局的某些部分——即我的方法是错误的.

换句话说，如果一个专业的 ETL 开发人员正在这样做（假设他们会这样做），他们会怎么做呢？

我想我想要达到的目标是一种可靠的方式来更改我的表的架构，并且不会有一个容易出错的更新所有列复制列表的过程。

更具体地说，这里是我实现的前 4 个表的 SSIS 任务和架构的屏幕截图。

![在此处输入图像描述](../Images/27c8e0d463b83526f61c45ae6485b713.png)

# ruby-on-rails - 为什么rails强迫我使用bundle exec？

> ID：10252562
> 
> 赞同：1
> 
> 时间：2012-04-20T19:43:02.063
> 
> 标签：ruby-on-rails

我想使用“rake routes”运行我的 rake 命令

但是rails会产生以下错误

```
** Invoke routes (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
uninitialized constant ActiveAdmin
/Users/aaalsubaie/Sites/Posnegs/config/initializers/active_admin.rb:1
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/engine.rb:588
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/engine.rb:587:in `each'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/engine.rb:587
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `instance_exec'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `run'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:55:in `run_initializers'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `each'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `run_initializers'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/application.rb:136:in `initialize!'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `send'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `method_missing'
/Users/aaalsubaie/Sites/Posnegs/config/environment.rb:5
/Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `gem_original_require'
/Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `require'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/application.rb:103:in `require_environment!'
/Library/Ruby/Gems/1.8/gems/railties-3.2.3/lib/rails/application.rb:292:in `initialize_tasks'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `invoke_prerequisites'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `invoke_with_call_chain'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/bin/rake:33
/usr/bin/rake:23:in `load'
/usr/bin/rake:23
Tasks: TOP => routes => environment 
```

奇怪的是当我运行“bundle exec rake routes”
时它工作正常！我在开发/生产环境中遇到这个错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:46:26.247

对特定版本的 gem 的依赖会造成先有鸡还是先有蛋的情况，即在应用程序发现它需要不同版本之前，可能会加载错误版本的 gem。 `bundle exec`有助于右脚下车。见[http://yehudakatz.com/2011/05/30/gem-versioning-and-bundler-doing-it-right/](http://yehudakatz.com/2011/05/30/gem-versioning-and-bundler-doing-it-right/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:01:19.800

如果你使用 rvm，你可以使用`bundle install --binstubs`然后你就不必再做 bundle exec 了。有关详细信息，请参阅[此帖子](http://robots.thoughtbot.com/post/15346721484/use-bundlers-binstubs)。

不要忘记将 bin 目录添加到您的 gitignore 文件中。

# asp.net - 解析和翻译经典的 ASP 和 ASP.NET 网站

> ID：10252566
> 
> 赞同：-1
> 
> 时间：2012-04-20T19:43:09.383
> 
> 标签：asp.net, asp-classic, translation

我有一个站点，其中包含一堆（非常丑陋的）经典 asp 页面，以及一些 ASP.NET Web 表单页面。我需要能够设置它，以便用户可以翻转开关并将整个网站翻译成法语。

不幸的是，请求客户不希望我们使用像谷歌翻译这样简单的东西，他们希望控制字典以防止语法错误等。这意味着我必须克服两个问题。

首先，我需要解析网站上所有对客户可见的硬编码文本，并将其放入电子表格中，以便他们可以根据自己的喜好进行翻译并将其发回。我试图使用 Html Agility Pack 来使用经典代码执行此操作，但在处理存在服务器标签的情况时遇到了麻烦（其中有大量的）。

其次，我需要一个解决方案，该解决方案将使用该词典来翻译经典文本和 ASP.NET 文本。

我认为字典将采用 XML 格式，并且可以在客户端进行翻译，因此它不必处理服务器标签问题，并且可以在经典和 .NET 中工作，但我完全愿意建议。如果有人有任何想法或知道任何可以帮助我解决其中一个或两个问题的解决方案，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T12:19:08.223

我会使用 .NET 资源文件来存储翻译。它们与 .NET 完美结合，因为它是一种 XML 格式，您也可以在 Classic ASP 中对其进行解析。

我会在 ASP Classic 中创建一个函数来读取资源文件并使用 XPath 来获得正确的翻译。

由于翻译在服务器端很容易获得，我会在那里处理翻译。

# c# - C# 无重载方法 'ToString' 需要 1 个参数 - 简单

> ID：10252570
> 
> 赞同：1
> 
> 时间：2012-04-20T19:43:34.787
> 
> 标签：c#

我对 C# 还很陌生，遇到了一个我不知道如何修复的错误。正如标题所述，我得到 No 重载方法 'ToString' 需要 1 个参数错误。我在这里查看了其他问题，但它们比我想要做的更复杂。我有一个简单的等式，我试图在消息框中显示它，它看起来如下：

```
Y = C + I + E + G;

MessageBox.Show(ToString(Y)); 
```

公式中的所有变量都是整数，存储为 int，并取自文本框。我一直在 YouTube 上从 thenewboston 的教程中学习 C#，但我还没有在那里看到这个问题，然后又有 200 多个关于 C# 的视频，我还没有走到那一步。任何有关错误调试的建议将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-20T19:44:32.553

正确的语法是：

```
MessageBox.Show(Y.ToString()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T19:44:39.270

你有没有尝试过

```
MessageBox.Show(Y.ToString()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T19:45:23.387

ToString 不是运算符。它是对象类的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-20T19:50:11.847

提供一点解释：在 C# 中，一切都有一个`ToString()`方法，您可以调用该方法来给出`Object`. 由于您正在调用`ToString(Y)`，因此它抱怨您为 ToString 方法使用了错误数量的参数。通常，正如其他人指出的那样，将对象表示为 a 的`String`方法是调用`Y.ToString()`.

值得注意的是，您可以`ToString()`在您创建的任何类中覆盖该方法，以便对该类`ToString()`方法的调用将返回一个更有用的`String`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-20T19:50:29.127

上面的帖子几乎涵盖了您的问题的解决方案。关于您遇到的错误：当您在`ToString(Y)`不引用变量的情况下调用时，编译器将查看当前上下文，在您的情况下，该上下文是一个默认继承的类，`Object`请参阅此[链接](http://msdn.microsoft.com/en-us/library/9kkx3h3c%28v=vs.80%29.aspx)了解详细信息。因此，当您执行`ToString`此操作时，编译器将查看`Object.ToString()`（如果未覆盖）不带参数的，这就是您得到的原因：

> 没有重载方法“ToString”需要 1 个参数错误

# sql-server - 将 Nullable 列添加到现有表的影响

> ID：10252573
> 
> 赞同：1
> 
> 时间：2012-04-20T19:44:11.580
> 
> 标签：sql-server, ddl

我将向现有表添加一个可为空的列。有哪些可能的影响以及如何避免？

我打算注意 SELECT *。我还应该注意什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:19:09.293

如果您正在执行以下操作，还取决于列的位置：

```
INSERT INTO <table> SELECT * 
```

那么您可能会将数据插入到错误的列中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:19:28.623

作为查询的一部分返回的可能已经具有相同列名的连接可能会成为一个问题。

例如，假设我们有一个表“Client”，其中有一列“ZipCode”，以及一个名为“Contractor”的表，您将“ZipCode”添加到该表中。具体来说，如果已编写查询以“按 ZipCode 排序”连接两个表，则 ZipCode 不明确。您的查询现在将失败。“按 Client.ZipCode 订购”可以避免这个问题。

# entity-framework - 实体框架 4 和空类

> ID：10252574
> 
> 赞同：0
> 
> 时间：2012-04-20T19:44:12.680
> 
> 标签：entity-framework, c#-4.0

我有一个数据输入表单，它涉及要插入的几个表。我将每个文本框的文本属性绑定到相关的类属性。由于某些字段不是强制性的，我最终可能会得到其中一个没有数据的类。EF 会检测到这个而不插入它，还是我必须在提交更改之前手动检查这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:49:18.787

如果您创建了实体的实例并将其添加到实体集中，则将在 submitchanges() 上创建实体。您有责任将相应的约束添加到实体的属性并检查空输入。

# php - PHP表单传递变量

> ID：10252578
> 
> 赞同：-1
> 
> 时间：2012-04-20T19:44:41.030
> 
> 标签：php, mysql

我正在尝试使用由查询填充的下拉列表从表单传递变量。它目前转到**result.php**

```
<form action="result.php" method="post">

<SELECT NAME=Model class="normal"> 
<OPTION VALUE=0>Phone
<?=$model_o?> 
</SELECT> 

<SELECT NAME=Mins  class="small"> 
<OPTION VALUE=0>Mins
<?=$minutes_o?> 
</SELECT> 

<SELECT NAME=Texts class="small"> 
<OPTION VALUE=0>Texts
<?=$texts_o?> 
</SELECT> 

<SELECT NAME=Freegifts class="big"> 
<OPTION VALUE=0>Choose Free Gifts 
<?=$freegifts_o?> 
</SELECT> 

<SELECT NAME=Network class="normal"> 
<OPTION VALUE=0>Network 
<?=$network_name_o?> 
</SELECT> 

<SELECT NAME=Merchant class="normal"> 
<OPTION VALUE=0>Contract/Prepay 
<?=$merchant_category_o?> 
</SELECT> 
<br>
<button type="submit" value="search phones" class="red"><span>Sumbit</span></button>

</form> 
```

但是，我想要它做的是将每个下拉列表中的任何变量传递到 URL，只有在选择了一个选项时。

例如，如果选择了模型，它将在选择提交时将变量传递给 URL，例如**result.php?model=iphone**，如果同时选择了模型和 mins，则 URL 将类似于**result.php?model=iphone&mins =500**

我希望这是有道理的，因为我很难解释我实际想要激活的内容。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:57:20.673

您可以使用 JavaScript 在提交时删除任何具有零值的变量，因此它们不会到达 result.php（包括 URL），因为它们不会在`$GET`数组中。

您可以对 result.php 进行工程设计，以便如果没有找到零值，它会正常运行，但如果找到，则会构建一个仅包含其他非零变量的新 URL，并且 result.php 然后可以重定向回自身。

老实说，我不会做以上任何事情。由于每个下拉菜单都有一个以零值开头的选项，因此您可以简单地忽略在 result.php 中接收到的所有零值，但这不会从 URL 中删除具有零值的变量。想想你为什么要这样做。在接收端进行这种处理要合理得多。

* * *

我假设您打算使用 GET 而不是 POST

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:56:12.213

对于您的默认选择（不计入的选择），将 value 属性设置为“”。我相信这将指示浏览器不要发送该数据。

```
<select name="select1">
    <option value="">Default Selection</option>
    <option value="X">First option</option>
</select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:59:42.520

由于您使用的是 GET，因此您不能让它*只*发送具有与之关联的数据的表单字段。使用 GET 将发送有关表单的所有内容，包括所有字段，即使它们没有任何数据。你能用 Javascript 解析它还是用 POST 代替？

**澄清** 我说您正在使用 GET 尽管您的表单标签指示 POST 由于您的跟进（result.php?model....）。

# android - 可以将内容加载到一项活动的不同选项卡中吗？安卓标签

> ID：10252581
> 
> 赞同：0
> 
> 时间：2012-04-20T19:44:55.183
> 
> 标签：android, android-activity, tabs, maps, host

是否可以将内容加载到一项活动的不同选项卡中？

我见过很多例子，其他用户只是在单独的文件中加载活动。我已经尝试过这种方法，但对我不起作用......

我正在尝试制作一个位置跟踪应用程序。我设法让地图显示在一个选项卡中，但我尝试在另一个选项卡中加载其他内容，但无法正常工作。我的应用程序崩溃了。

```
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    initMapView();
    initMyLocation();

    TabHost.TabSpec spec;

    TabHost th = (TabHost)findViewById(R.id.tabhost);
    th.setup();
    spec = th.newTabSpec("tag1");
    spec.setContent(R.id.mapTab);
    spec.setIndicator("Map");
    th.addTab(spec);

    spec = th.newTabSpec("tag2");
    spec.setContent(R.id.logTab);
    spec.setIndicator("Log");
    th.addTab(spec);

    spec = th.newTabSpec("tag3");
    spec.setContent(R.id.detailsTab);
    spec.setIndicator("Details");
    th.addTab(spec);

}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}

//Zoom In/Out Controls
private void initMapView() {
    map = (MapView) findViewById(R.id.mvMain);
    controller = map.getController();
    map.setSatellite(true);
    //map.setStreetView(true);
    map.setBuiltInZoomControls(true);
}

//Creates an Overlay that marks current position
private void initMyLocation() {
    final MyLocationOverlay overlay = new MyLocationOverlay(this, map);
    overlay.enableMyLocation();
    overlay.enableCompass();
    overlay.runOnFirstFix(new Runnable() {
        public void run() {
            controller.setZoom(17);
            controller.animateTo(overlay.getMyLocation());
            map.getOverlays().add(overlay);
        }

    });

}
//Experiment
public class detailsTab extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.id.detailsTab);

        LocationManager locationManager;
        String context = Context.LOCATION_SERVICE;
        locationManager = (LocationManager)getSystemService(context);

        String provider = LocationManager.GPS_PROVIDER;
        Location location = locationManager.getLastKnownLocation(provider);
        updateWithNewLocation(location);
    }

    private void updateWithNewLocation(Location location) {
        String latLongString;
        TextView myLocationText;
        myLocationText = (TextView)findViewById(R.id.detailsText);
        if(location != null){
            double lat = location.getLatitude();
            double lng = location.getLongitude();
            latLongString = "Lat:" + lat + "\nLong" + lng;
        }
        else {
            latLongString = "No Location Found";
        }
        myLocationText.setText("Your current position is: \n" + latLongString);
    }
}

public class NewOverlay extends Overlay {
    @Override
    public void draw(Canvas canvas, MapView mapView, boolean shadow) {
        Projection projection = mapView.getProjection();

        Double lat = lati *1E6;
        Double lng = longi *1E6;

        GeoPoint geoPoint = new GeoPoint(lat.intValue(), lng.intValue());

        if (shadow == false) {
            Point myPoint = new Point();
            projection.toPixels(geoPoint, myPoint);

            //Creating and setting up the paint brush
            Paint paint = new Paint();
            paint.setARGB(250, 255, 0, 0);
            paint.setAntiAlias(true);
            paint.setFakeBoldText(true);

            //Create circle
            int rad = 25;
            RectF oval = new RectF(myPoint.x-rad, myPoint.y-rad, myPoint.x+rad, myPoint.y+rad);

            canvas.drawOval(oval, paint);
            canvas.drawText("Red Circle", myPoint.x+rad, myPoint.y, paint);

        }

    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T07:09:42.800

是的，您可以执行多个 TabView，而无需使用 TabActivities。请参阅[此](https://github.com/ldo/android-custom-tabs/blob/master/src/CustomTabActivity.java)示例代码。

# c# - 现有 Access DB 上的 C# 附件字段更新

> ID：10252583
> 
> 赞同：0
> 
> 时间：2012-04-20T19:45:12.793
> 
> 标签：c#, attachment-field

我有一个最近添加了附件字段的 Access 表。该表是计算机列表和有关每台计算机的信息。它的用户、安装的软件等等。附件字段将包含从每台计算机接收到的简单文本配置文件。

我使用了一些在这里找到的代码：[Programmatically manage Microsoft Access Attachment-typed field with .NET](https://stackoverflow.com/questions/779211/programmatically-managing-microsoft-access-attachment-typed-field-with-net)

我的问题是我似乎无法更新正确的字段。这意味着计算机名称 Bob 的配置文件被放置在正确的字段中，但如果这有意义，则错误的计算机。下面是一个 SQL 语句示例。

```
Select * From MyTable WHERE ComputerName Like 'Bob' 
```

根据要求，下面的整个代码段。

```
public void InsertFile(String Path, String CmpName)
{   
    DBEngine dbe = new DBEngine();
    Database db = dbe.OpenDatabase("MyAccessDB.accdb", false, false, "");
    Recordset rs = db.OpenRecordset(
        "SELECT * FROM MyTable WHERE ComputerName LIKE '" + CmpName + "\'",
        RecordsetTypeEnum.dbOpenDynaset, 0, LockTypeEnum.dbOptimistic);
    rs.MoveFirst();
    rs.Edit();
    Recordset2 rs2 = (Recordset2)rs.Fields["My_File"].Value;
    rs2.AddNew();
    Field2 f2 = (Field2)rs2.Fields["FileData"];
    f2.LoadFromFile(Path);

    rs2._30_Update();
    rs2.Close();
    rs._30_Update();
    rs.Close();          
} 
```

我希望在使用`OpenRecodeset()`上述语句时只给我该行，然后是该行的唯一附件字段。然而，这种情况并非如此。我已经搜索找到如何迭代记录集以找到正确的行但没有运气。我是新来的，所以我希望我能涵盖我需要的一切。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:50:25.377

我不确定我是否理解您的问题，但如果您想要的只是附件字段，您的 SQL 查询应该是：

```
"SELECT attachment FROM MyTable WHERE UCASE(ComputerName) = 'BOB'" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:52:20.530

请注意，只有当字段是主键字段或者您在其上定义了唯一索引时，where 子句`WHERE ComputerName Like 'Bob'`才会可靠地工作。`ComputerName`

在任何情况下，您都应该定义一个主键，这样可以确保可以以可靠的方式识别要更新的表记录。

* * *

**更新**

`LIKE`如果`ComputerName`是主键，不要使用比较，`=`而是使用。

```
SELECT attachment FROM MyTable WHERE ComputerName = 'Bob' 
```

# java - 使用 Java 正则表达式进行字符串操作

> ID：10252595
> 
> 赞同：0
> 
> 时间：2012-04-20T19:45:46.260
> 
> 标签：java, regex

我有一个这种格式的字符串：

```
mydb://<user>:<password>@<host>:27017 
```

我想使用 Java 正则表达式从字符串中提取`<user>`和`<password>`字符串。这样做的最好方法是什么？

编辑：

我希望能够在字符串的替换方法中使用这个正则表达式，这样我就只剩下相关的用户和密码字符串了

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T20:52:17.013

你可以使用这个正则表达式（模式）

```
Pattern p = Pattern.compile("^mydb://([^:]+):([^@]+)@[^:]+:\\d+$"); 
```

然后捕获组 #1 和 #2 将分别拥有您的用户名和密码。

**代码：**

```
String str = "mydb://foo:bar@localhost:27017"; 
Pattern p = Pattern.compile("^mydb://([^:]+):([^@]+)@[^:]+:\\d+$");
Matcher matcher = p.matcher(str);
if (matcher.find())
    System.out.println("User: " + matcher.group(1) + ", Password: "
                        + matcher.group(2)); 
```

**输出：**

```
User: foo, Password: bar 
```

**编辑：**根据您的评论：如果您想使用 String 方法，那么：

```
String regex = "^mydb://([^:]+):([^@]+)@[^:]+:\\d+$";
String user = str.replaceAll(regex, "$1");
String pass = str.replaceAll(regex, "$2") 
```

# javascript - 使用 History.JS 脚本离开页面时历史 API 中断

> ID：10252601
> 
> 赞同：0
> 
> 时间：2012-04-20T19:46:28.590
> 
> 标签：javascript, jquery, ajax, history.js

每当我返回使用 History API 的页面时，我都会遇到同样的 History.Js 中断问题。

重现步骤：

1.  访问[http://ajax-pagination-html5.heroku.com/](http://ajax-pagination-html5.heroku.com/)
2.  搜索“tron”
3.  点击任何结果
4.  点击返回（只返回ajax！）

# postgresql - 父子表外键

> ID：10252603
> 
> 赞同：2
> 
> 时间：2012-04-20T19:46:50.807
> 
> 标签：postgresql, inheritance, foreign-keys, primary-key

我目前有一个父表：

```
CREATE TABLE members (
    member_id SERIAL NOT NULL, UNIQUE, PRIMARY KEY
    first_name varchar(20)
    last_name varchar(20)
    address address (composite type)
    contact_numbers varchar(11)[3]
    date_joined date
    type varchar(5)
); 
```

和两个相关的表：

```
CREATE TABLE basic_member (
    activities varchar[3]) // can only have 3 max activites
    INHERITS (members)
);

CREATE TABLE full_member ( 
    activities varchar[]) // can 0 to many activities
    INHERITS (members)
); 
```

我还有另一张桌子：

```
CREATE TABLE planner (
        day varchar(9) FOREIGN KEY REFERENCES days(day)
        time varchar(5) FOREIGN KEY REFERENCES times(time)
        activity varchar(20) FOREIGN KEY REFERENCES activities(activity)
        member bigint FOREIGN KEY REFERENCES members(member_id)
);
ALTER TABLE planner ADD CONSTRAINT pk_planner PRIMARKY KEY (day,time,activity,member); 
```

我目前正在尝试添加

```
INSERT INTO planner VALUES ('monday','09:00','Weights',2); 
```

我在 full_members 中添加了一个集合

```
INSERT INTO full_members 
VALUES (Default, 'Hayley', 'Sargent', (12,'Forest Road','Mansfield','Nottinghamshire','NG219DX'),'{01623485764,07789485763,01645586754}',20120418,'Full'); 
```

我在 Planner 中的插入目前无法正常工作——你能解释一下原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T11:24:57.653

我设法回答了我自己的问题，这是因为目前 posgreSQL 不能很好地处理继承和外键，所以我没有创建规则

```
CREATE RULE member_ref
AS ON INSERT TO planner
WHERE new.member NOT IN (SELECT member_id FROM members)
DO INSTEAD NOTHING; 
```

这与外键基本相同

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T08:14:31.930

不确定这是否会是更好的解决方案，但它就在这里......

原理很简单：

*   创建新表让我们调用它`table_with_pkeys`，它将复制继承表的主键列`child1`，`child2`...`child3`
*   在继承的表上创建触发器，插入后，将新的 PK 插入到`table_with_pkeys`新创建的 PK 中，更新后如果更改更新它，删除后从 table_with_pkeys 中删除相同的 PK。
*   然后在每个应该使用 FK 引用 child1、child2 或通过父表的 PK 的任何表中，将 FK 指向不是父表的 PK，而是指向 table_with_pkeys，它具有所有子 PK 的副本，因此您将拥有易于管理的方式来拥有外键可以级联更新，限制更新等等。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T07:05:21.210

如果上述物化视图方法对您不起作用，请创建约束触发器以检查参照完整性。不幸的是，声明性引用完整性目前不适用于继承。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T20:22:58.513

您在地址中的 12 之前缺少一个公开报价：

```
INSERT INTO full_members 
VALUES (Default, 'Hayley', 'Sargent', (12 Forest Road', 'Mansfield', 'Nottinghamshire', 'NG219DX'),
        '{01623485764,07789485763,01645586754}',20120418,'Full'); 
```

应该：

```
INSERT INTO full_members 
VALUES (Default, 'Hayley', 'Sargent', ('12 Forest Road', 'Mansfield', 'Nottinghamshire', 'NG219DX'),
        '{01623485764,07789485763,01645586754}',20120418,'Full'); 
```

# sql - 为什么我得到 2 个不同列的相同总值

> ID：10252607
> 
> 赞同：1
> 
> 时间：2012-04-20T19:47:01.937
> 
> 标签：sql

我需要有人更正下面的陈述。先感谢您。

```
SELECT CATEGORY
--WHAT PERIOD?
,'P3' AS PERIOD
,'2013' AS FISCALYEAR        
,COUNT(CASE SecurityLayer WHEN 'dblayer' THEN SecurityLayer ELSE '' END) DB_SEC_COUNT         
,COUNT(CASE SecurityLayer WHEN 'Applayer' THEN SecurityLayer ELSE '' END) APP_SEC_COUNT  
FROM [db_eCAM].[dbo].[tbl_SecChecks]  
GROUP BY CATEGORY 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T19:50:38.613

你是否试图返回这些东西匹配的次数？然后使用

```
SELECT CATEGORY
--WHAT PERIOD?
,'P3' AS PERIOD
,'2013' AS FISCALYEAR  
,SUM(CASE SecurityLayer WHEN 'dblayer' then 1 else 0 end) AS DB_SEC_COUNT
,SUM(CASE SecurityLayer WHEN 'Applayer' then 1 else 0 end) AS APP_SEC_COUNT
FROM [db_eCAM].[dbo].[tbl_SecChecks]  
GROUP BY CATEGORY 
```

试试看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:51:09.507

不要计算列，而是尝试对其求和（否则，无论其值如何，每一行仍将被计算在内）：

```
SELECT CATEGORY
--WHAT PERIOD?
,'P3' AS PERIOD
,'2013' AS FISCALYEAR        
,SUM(CASE SecurityLayer WHEN 'dblayer' THEN 1 ELSE 0 END) DB_SEC_COUNT         
,SUM(CASE SecurityLayer WHEN 'Applayer' THEN 1 ELSE 0 END) APP_SEC_COUNT  
FROM [db_eCAM].[dbo].[tbl_SecChecks]  
GROUP BY CATEGORY 
```

# sql - Oracle：PL/SQL 函数可能不返回任何内容？

> ID：10252619
> 
> 赞同：9
> 
> 时间：2012-04-20T19:48:03.117
> 
> 标签：sql, oracle

正如标题所说，是否可以从 PL/SQL 函数中不返回任何内容？

我的功能如下，当我省略返回时出现错误：

```
create or replace
FUNCTION DeleteAttributes
(code IN varchar2)
CURSOR c_attributes = SELECT ...

BEGIN
    FOR attribute_record IN c_attributes
    LOOP
        ...
    END LOOP;
END; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-20T20:26:13.280

Oracle PL/SQL 函数*必须*有返回值。如果您将子程序声明为过程，那么当它缺少返回时它不会给您错误（过程*不能*有返回）。

```
create or replace
PROCEDURE DeleteAttributes
(code IN varchar2)
CURSOR c_attributes = SELECT ...

BEGIN
    FOR attribute_record IN c_attributes
    LOOP
        ...
    END LOOP;
END; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T20:30:11.277

根据定义，函数返回一个值，因此您必须有一个 RETURN 语句。查看Oracle 文档中[函数的语法定义。](http://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_5009.htm)RETURN 不是一个选项。

我什至不确定你为什么要这样做。

# multithreading - 使用 WCF 使用 MSMQ

> ID：10252620
> 
> 赞同：1
> 
> 时间：2012-04-20T19:48:10.073
> 
> 标签：multithreading, wcf, msmq

MSMQ 和 WCF 的新功能。我希望能够以高速率处理传入的 MSMQ 消息。我想让它成为多线程（和事务性的）。这样做的最佳方法是什么？非常欢迎任何示例、代码片段、理论。另外，WCF 如何知道 MSMQ 中是否有消息？或者我是否必须创建一个轮询 MSMQ 的 Windows 服务，然后对于找到的消息，在新线程上启动它并调用 WCF 服务并将消息传递给它？什么是最好的方法？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T13:48:45.090

这里的答案是使用 WCF 并创建服务已知类型的数据合同。这些已知类型是它期望从正在读取的队列中的对象。

要使其成为多线程和事务性，不仅队列需要是事务性的，还需要装饰服务属性：

```
[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.PerSession, ReleaseServiceInstanceOnTransactionComplete = false)] 
```

InstanceContextMode 默认为 perSession。

您还需要在配置文件上设置绑定

示例：http: [//msdn.microsoft.com/en-us/library/ms751493.aspx](http://msdn.microsoft.com/en-us/library/ms751493.aspx)

# c++ - 使用一维数组的矩阵乘法

> ID：10252621
> 
> 赞同：8
> 
> 时间：2012-04-20T19:48:12.997
> 
> 标签：c++, math, matrix, matrix-multiplication

我正在尝试将存储在 1d 数组中的两个矩阵相乘。

我正在使用此功能，但我的程序崩溃了，我认为是由于越界错误。但是，我没有（简单的）调试能力，所以我必须确定我的代码是否正确，对我来说似乎是......

```
void SampleUtils::multiplyMatrices(float* matA, int rA, int cA, float* matB,
        int rB, int cB, float* matC, int rC, int cC) {
    for (int i = 0; i <= rA; i++) {
        for (int j = 0; j <= cB; j++) {
            float sum = 0.0;
            for (int k = 0; k <= rB; k++)
                sum = sum + matA[i * cA + k] * matB[k * cB + j];
            matC[i * cC + j] = sum;
        }

    } 
```

那么，谁能找出我做错了什么？

谢谢...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T19:50:41.030

机会是你的意思`<`而不是`<=`你的`for`循环。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-20T19:50:53.903

尝试在您`i < rA`的`j < cB``k < rB``for`

# java - 如何停止 Jawr 处理 CSS 文件的某些部分？

> ID：10252625
> 
> 赞同：5
> 
> 时间：2012-04-20T19:48:31.163
> 
> 标签：java, css, jawr

我目前正在使用[Jawr](http://jawr.java.net/)压缩和捆绑我的 css、javascript 和图像文件。

[Jawr](http://jawr.java.net/)目前正在转换我的 css 文件中的所有 url() 链接，无论它们是否是图像。例如：

```
@font-face {
    font-family: 'NothingYouCouldSay';
    src: url('../fonts/NothingYouCouldSay.eot') format('eot');
    src: local("☺"), url('../fonts/NothingYouCouldSay.woff') format('woff'), url("../fonts/NothingYouCouldSay.otf") format("opentype"), url('../fonts/NothingYouCouldSay.ttf') format('truetype'), url('../fonts/NothingYouCouldSay.svg') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

Jawr 正在转换所有 url() 值，但是当网络服务器运行时找不到资源，因为我已将图像 servlet 配置为仅侦听 *.png 和 *.jpg。

```
@font-face {
    font-family: 'NothingYouCouldSay';
    src: url('../../../cb1130234589/resources/fonts/NothingYouCouldSay.eot') format('eot');
    src: local("☺"), url('../../../cb1130234589/resources/fonts/NothingYouCouldSay.woff') format('woff'), url("../../../cb1130234589/resources/fonts/NothingYouCouldSay.otf") format("opentype"), url('../../../cb1130234589/resources/fonts/NothingYouCouldSay.ttf') format('truetype'), url('../../../cb1130234589/resources/fonts/NothingYouCouldSay.svg') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

如果我将 *.woff 添加到图像 servlet 映射中，则 servlet 会抱怨文件的 mime 类型不被理解。

有什么方法可以让 Jawr 不处理这些特定的特定 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:09:41.637

因此，在尝试了一些不同的想法之后，我最终编写了自己的自定义后处理器来处理这个问题。我尽可能多地重用现有的 Jawr 代码，这意味着如果 Jawr 更改它的底层代码，它可能会非常脆弱。

无论如何，这是我写的：

```
package com.bullethq.jawr.postprocessor;

import net.jawr.web.resource.FileNameUtils;
import net.jawr.web.resource.bundle.factory.util.PathNormalizer;
import net.jawr.web.resource.bundle.postprocess.BundleProcessingStatus;
import net.jawr.web.resource.bundle.postprocess.impl.CSSURLPathRewriterPostProcessor;
import net.jawr.web.resource.bundle.postprocess.impl.PostProcessorCssImageUrlRewriter;

import java.io.IOException;

public class CustomCssUrlPathRewriterPostProcessor extends CSSURLPathRewriterPostProcessor {

    public static final String CUSTOM_URL_PATH_REWRITER = "customcsspathrewriter";

    public CustomCssUrlPathRewriterPostProcessor() {
        super(CUSTOM_URL_PATH_REWRITER);
    }

    // ========================================================================
    // ========================================================================
    // ========================================================================
    @Override
    protected PostProcessorCssImageUrlRewriter createImageUrlRewriter(BundleProcessingStatus status) {
        return new CustomPostProcessorCssImageUrlRewriter(status);
    }

    // ========================================================================
    // ========================================================================
    // ========================================================================
    public class CustomPostProcessorCssImageUrlRewriter extends PostProcessorCssImageUrlRewriter {

        public CustomPostProcessorCssImageUrlRewriter(BundleProcessingStatus status) {
            super(status);
        }

        // ========================================================================
        // ========================================================================
        // ========================================================================
        @Override
        protected String getUrlPath(String match, String originalPath, String newCssPath) throws IOException {
            String url = match.substring(match.indexOf('(') + 1, match.lastIndexOf(')')).trim();

            // Remove any quotes if necessary.
            String quoteStr = "";
            if (url.startsWith("'") || url.startsWith("\"")) {
                quoteStr = String.valueOf(url.charAt(0));
                url = url.substring(1, url.length() - 1);
            }

            // We now check if the url ends in a known image file extension
            // If not, the url is ignored.
            if (FileNameUtils.hasImageExtension(url)) {
                return super.getUrlPath(match, originalPath, newCssPath);
            } else {
                // We need to rewrite the path, as any relative URLs will
                // not resolve correctly if Jawr has changed the CSS path.
                url = PathNormalizer.concatWebPath(originalPath, url);
                url = PathNormalizer.getRelativeWebPath(PathNormalizer.getParentPath(newCssPath), url);
                return "url(" + quoteStr + url + quoteStr + ")";
            }
        }
    }
} 
```

然后，您需要在 jawr.properties 中配置 Jawr 以使用此自定义后处理器：

```
jawr.custom.postprocessors.customcsspathrewriter.class=com.bullethq.jawr.postprocessor.CustomCssUrlPathRewriterPostProcessor
jawr.css.bundle.factory.filepostprocessors=customcsspathrewriter 
```

# android - 任务杀手杀死了我的小部件计时器

> ID：10252628
> 
> 赞同：0
> 
> 时间：2012-04-20T19:48:37.387
> 
> 标签：android, timer, widget

晚上好，我有一些关于如何使我的小部件（使用计时器更新）不受 Advanced Task Killer 等应用程序保护的问题。因为每次我在 Task Killer 上单击“全部杀死”时，我的小部件上的计时器都会停止，因此它无法正常工作。有什么建议么？谢谢..

# javascript - 将类应用于前 5 行和后 5 行

> ID：10252638
> 
> 赞同：1
> 
> 时间：2012-04-20T19:49:23.517
> 
> 标签：javascript, jquery, html-table

我已经建立了一个简单的例子来说明我希望完成的事情。 [http://jsfiddle.net/helpinspireme/ejHFf/](http://jsfiddle.net/helpinspireme/ejHFf/) 我想做的是

*   计算表的数量`<tr>`
*   如果表少于 6，则全部上课`red`
*   如果多于 5 但少于 11，则前 5 人上课`red`，其余人上课`black`
*   如果超过 10 个，将类添加`red`到前 5 个，然后将最后 5 个添加`black`到。前 5 行和后 5 行之间的行没有分类。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:53:27.857

你已经做了什么？你几乎描述了整个算法。只需用于`slice`获取索引之间的元素并`length`获取项目数。要添加类，请使用`addClass`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:53:44.557

你要

```
 if (x < 6) {
        $(tooltips_id).addClass('red');
    } else if (x > tooltips_amount-5) {
        $(tooltips_id).addClass('black');
    } else {
        // else
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:01:54.593

这并不完全是您问题的答案，因为您可能出于支持旧浏览器等原因需要此功能（尤其值得注意的是，IE 仅支持我的版本 9 的解决方案）。尽管出于同样的原因不使用此解决方案可能很好，但我认为重要的是要注意，根据最新的标准，即使不使用任何 Javascript 也可以做到这一点。你只有 CSS：

```
tr
{
    border: 1px solid #000;
}

tr:nth-child(-n+5)
{
    border: 1px solid red;
}

tr:nth-last-child(-n+5)
{
    border: 1px solid red;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T20:02:56.383

尝试这样的事情：

```
$("tr:lt(5)").css({ backgroundColor : "blue" });
$("tr:gt(5)").css({ backgroundColor : "red" }); 
```

这是一个[jsFiddle](http://jsfiddle.net/qJ3tP/220/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T20:07:48.027

这个 [http://jsfiddle.net/9fmNG/的小提琴](http://jsfiddle.net/9fmNG/)

```
var rows = $('table tr');

rows.map(function( index, row){
    var allRows  = rows.size();

    if(index+1 <= 5)
        $(row).addClass('red');
    else if((index+1) >= (allRows-5)){
        $(row).addClass('black');    
    }               
})​ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T20:26:18.207

```
var tooltip = function() {
    var tooltips_tr = $('#primary_table tr');
    var tooltips_amount = $(tooltips_tr).length;

    tooltips_tr.each(function(i){
        i+=1;
        if(tooltips_amount < 6) $(this).addClass('red');
        if(tooltips_amount > 5 && tooltips_amount < 11)
        {
            if(i<=5) $(this).addClass('red');    
            else $(this).addClass('black');
        }
        if(tooltips_amount > 10)
        {
            if(i<=5) $(this).addClass('red');    
            else if(i>tooltips_amount-5) $(this).addClass('black');
        }
    });
} 
```

[**例子。**](http://jsfiddle.net/heera/ejHFf/10/)

# r - PCA FactoMineR 绘图数据

> ID：10252639
> 
> 赞同：6
> 
> 时间：2012-04-20T19:49:32.300
> 
> 标签：r, plot, ggplot2, pca

我正在运行一个 R 脚本，使用[`FactorMineR`](http://factominer.free.fr/).

我想输出生成的 PCA 图的坐标，但找不到正确的坐标。我找到了`results1$ind$coord`，`results1$var$coord`但看起来都不像默认情节。

我找到了 [http://www.statistik.tuwien.ac.at/public/filz/students/seminar/ws1011/hoffmann_ausarbeitung.pdf](http://www.statistik.tuwien.ac.at/public/filz/students/seminar/ws1011/hoffmann_ausarbeitung.pdf) 和 [http://factominer.free.fr/classical-methods/principal-components-analysis。 html](http://factominer.free.fr/classical-methods/principal-components-analysis.html) 但都没有描述 PCA 创建的变量的内容

```
library(FactoMineR)
data1 <- read.table(file=args[1], sep='\t', header=T, row.names=1)
result1 <- PCA(data1,ncp = 4, graph=TRUE) # graphs generated automatically
plot(result1) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T21:27:42.177

我发现它是对象`$ind$coord[,1]`中`$ind$coord[,2]`的前两个 pca 坐标`PCA`。这是一个工作示例，其中包括您可能希望对`PCA`输出执行的其他一些操作...

```
# Plotting the output of FactoMineR's PCA using ggplot2
#
# load libraries
library(FactoMineR)
library(ggplot2)
library(scales)
library(grid)
library(plyr)
library(gridExtra)
#
# start with a clean slate
rm(list=ls(all=TRUE)) 
#
# load example data
data(decathlon)
#
# compute PCA
res.pca <- PCA(decathlon, quanti.sup = 11:12, quali.sup=13, graph = FALSE)
#
# extract some parts for plotting
PC1 <- res.pca$ind$coord[,1]
PC2 <- res.pca$ind$coord[,2]
labs <- rownames(res.pca$ind$coord)
PCs <- data.frame(cbind(PC1,PC2))
rownames(PCs) <- labs
#
# Just showing the individual samples...
ggplot(PCs, aes(PC1,PC2, label=rownames(PCs))) + 
  geom_text() 
```

![在此处输入图像描述](../Images/82c227d6ee9b993536c752d1feab024f.png)

```
# Now get supplementary categorical variables
cPC1 <- res.pca$quali.sup$coor[,1]
cPC2 <- res.pca$quali.sup$coor[,2]
clabs <- rownames(res.pca$quali.sup$coor)
cPCs <- data.frame(cbind(cPC1,cPC2))
rownames(cPCs) <- clabs
colnames(cPCs) <- colnames(PCs)
#
# Put samples and categorical variables (ie. grouping
# of samples) all together
p <- ggplot() + theme(aspect.ratio=1) + theme_bw(base_size = 20) 
# no data so there's nothing to plot...
# add on data 
p <- p + geom_text(data=PCs, aes(x=PC1,y=PC2,label=rownames(PCs)), size=4) 
p <- p + geom_text(data=cPCs, aes(x=cPC1,y=cPC2,label=rownames(cPCs)),size=10)
p # show plot with both layers 
```

![在此处输入图像描述](../Images/e0919dfa5412c82a00ba60a9668ce46e.png)

```
# Now extract the variables
#
vPC1 <- res.pca$var$coord[,1]
vPC2 <- res.pca$var$coord[,2]
vlabs <- rownames(res.pca$var$coord)
vPCs <- data.frame(cbind(vPC1,vPC2))
rownames(vPCs) <- vlabs
colnames(vPCs) <- colnames(PCs)
#
# and plot them
#
pv <- ggplot() + theme(aspect.ratio=1) + theme_bw(base_size = 20) 
# no data so there's nothing to plot
# put a faint circle there, as is customary
angle <- seq(-pi, pi, length = 50) 
df <- data.frame(x = sin(angle), y = cos(angle)) 
pv <- pv + geom_path(aes(x, y), data = df, colour="grey70") 
#
# add on arrows and variable labels
pv <- pv + geom_text(data=vPCs, aes(x=vPC1,y=vPC2,label=rownames(vPCs)), size=4) + xlab("PC1") + ylab("PC2")
pv <- pv + geom_segment(data=vPCs, aes(x = 0, y = 0, xend = vPC1*0.9, yend = vPC2*0.9), arrow = arrow(length = unit(1/2, 'picas')), color = "grey30")
pv # show plot 
```

![在此处输入图像描述](../Images/8840fbf738943b5554612705c26dcd32.png)

```
# Now put them side by side in a single image
#
grid.arrange(p,pv,nrow=1)
# 
# Now they can be saved or exported... 
```

![在此处输入图像描述](../Images/697dfd5ff6df71eeee63cc0e36bb13b5.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T05:30:19.007

在本的答案中添加一些额外的东西。您会在 Ben 的回复中的第一个图表中注意到标签有些重叠。maptools 包中的`pointLabel()`函数尝试查找不重叠的标签位置。它并不完美，但您可以根据需要调整数据框中的位置`new`（见下文）以进行微调。（此外，当您加载 maptools 时，您会收到有关`gpclibPermit()`. 的注释。如果您担心受限许可证，可以忽略它）。下面脚本的第一部分是 Ben 的脚本。

```
# load libraries
library(FactoMineR)
library(ggplot2)
library(scales)
library(grid)
library(plyr)
library(gridExtra)
#
# start with a clean slate
# rm(list=ls(all=TRUE)) 
#
# load example data
data(decathlon)
#
# compute PCA
res.pca <- PCA(decathlon, quanti.sup = 11:12, quali.sup=13, graph = FALSE)
#
# extract some parts for plotting
PC1 <- res.pca$ind$coord[,1]
PC2 <- res.pca$ind$coord[,2]
labs <- rownames(res.pca$ind$coord)
PCs <- data.frame(cbind(PC1,PC2))
rownames(PCs) <- labs 
#

# Now, the code to produce Ben's first chart but with less overlap of the labels.

library(maptools)

PCs$label=rownames(PCs)

# Base plot first for pointLabels() to get locations
plot(PCs$PC1, PCs$PC2, pch = 20, col = "red")
new = pointLabel(PCs$PC1, PCs$PC2, PCs$label, cex = .7)
new = as.data.frame(new)
new$label = PCs$label

# Then plot using ggplot2
(p = ggplot(data = PCs) + 
   geom_hline(yintercept = 0, linetype = 3, colour = "grey20") +
   geom_vline(xintercept = 0, linetype = 3, colour = "grey20") +
   geom_point(aes(PC1, PC2), shape = 20, col = "red") +
   theme_bw())

(p = p +  geom_text(data = new, aes(x, y, label = label), size = 3)) 
```

结果是：

![在此处输入图像描述](../Images/c2e442635949c550ab035b84f736dbb7.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-09T21:34:39.860

另一种方法是使用 CoreR 中的 biplot 函数或 psych 包中的 biplot.psych。这会将组件和数据放在同一个图形上。

对于 decathlon 数据集，使用 psych 包中的 principal 和 biplot：

```
 library(FactoMineR) #needed to get the example data
 library(psych)  #needed for principal 
 data(decathlon)  #the data set
 pc2 <- principal(decathlon[1:10],2) #just the first 10 columns
 biplot(pc2,labels = rownames(decathlon),cex=.5, main="Biplot of Decathlon results") 
 #this is a call to biplot.psych which in turn calls biplot.
 #adjust the cex parameter to change the type size of the labels. 
```

这看起来像：

！[双标图 http://personality-project.org/r/images/olympic.biplot.pdf](http://personality-project.org/r/images/olympic.biplot.pdf)

账单

# java - 这个 SQL 语法有什么问题？

> ID：10252642
> 
> 赞同：0
> 
> 时间：2012-04-20T19:50:03.250
> 
> 标签：java, mysql, database, tomcat, jdbc

我正在尝试使用 java servlet 构建注册系统。并将数据插入到 mySQL 数据库中。但我得到一个语法错误。我刚刚读完 Wiley mySQL 和 Java 开发人员指南。

而且我对 servlet 编程有点陌生，所以如果有简单的方法可以做我所做的事情，请告诉我。

```
 package com.app.base;

 import java.io.IOException;
 import java.io.PrintWriter;
 import java.sql.Connection;
 import java.sql.DriverManager;
 import java.sql.ResultSet;
 import java.sql.Statement;

 import javax.servlet.RequestDispatcher;
 import javax.servlet.ServletException;
 import javax.servlet.http.HttpServlet;
 import javax.servlet.http.HttpServletRequest;
 import javax.servlet.http.HttpServletResponse;

 import com.app.pojo.*;

 public class RegisterServlet extends HttpServlet{

MySqlDB mysql;

@Override
public void init() throws ServletException {
    // TODO Auto-generated method stub
    mysql = new MySqlDB();

}

@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException {

    PrintWriter out = null;
    //Connection connection = null;
    //Statement statement;
    //ResultSet rs;

    resp.setContentType("text/html");
    out = resp.getWriter();

    try{
        mysql.createConnection();
    }catch(Error e){
        out.write("Couldn't connect to mysql");
    }
    String fname = req.getParameter("fname");
    String lname = req.getParameter("lname");
    String email = req.getParameter("email");
    String password = req.getParameter("password");
    String city = req.getParameter("city");
    String country = req.getParameter("country");

    if(fname == null){
        String destination = "signup.jsp?error=Complete All Fields";
        RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
        rd.forward(req, resp);
    }else if(lname == null){
        String destination = "signup.jsp?error=Complete All Fields";
        RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
        rd.forward(req, resp);
    }else if(email == null){
        String destination = "signup.jsp?error=Complete All Fields";
        RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
        rd.forward(req, resp);
    }else if(password == null){
        String destination = "signup.jsp?error=Complete All Fields";
        RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
        rd.forward(req, resp);
    }else if(city == null){
        String destination = "signup.jsp?error=Complete All Fields";
        RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
        rd.forward(req, resp);
    }else if(country == null){
        String destination = "signup.jsp?error=Complete All Fields";
        RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
        rd.forward(req, resp);
    }else{

        String sql = "INSERT INTO main.users(first_name, last_name, email, password, city, country, registered_time) VALUES("
                + fname +", "+ lname + ", "+ email +", " + password +", " + city +"," + country + ",Now());";
        int answer = mysql.insertSQL(sql);
        if(answer == 1){
            resp.sendRedirect( "index.jsp?registered=true");
            //String destination = "index.jsp?registered=true";
            //RequestDispatcher rd = getServletContext().getRequestDispatcher(destination);
            //rd.forward(req, resp);
        }
    }

}

 } 
```

这是要连接的 MySql 类。

```
package com.app.pojo;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class MySqlDB{

private static String username = "root", password = "root";

public Connection createConnection(){
    Connection connection = null;
    try{
        //Load the JDBC driver
        Class.forName("com.mysql.jdbc.Driver");

        connection = DriverManager.getConnection("jdbc:mysql://localhost:3306,/main", username, password);
        //Create a connection to the database

    }catch(SQLException ex){
        System.out.println(ex);
    }catch(ClassNotFoundException e){
        System.out.println(e);
    }

    return connection;
}

public void runSqlStatement(String sql){
    try{
        Statement statement = createConnection().createStatement();
        //statement executeQuery(Query)
        boolean rs = statement.execute(sql);
    }catch(SQLException ex){
        System.out.println(ex);
    }
}

public ResultSet executeSQL(String sql){

    Statement statement = null;
    ResultSet rs = null;

    try{
        statement = createConnection().createStatement();
        rs = statement.executeQuery(sql);

        /*while(rs.next()){
            System.out.println(rs.getString(1));
        }*/

  //            rs.close();
  //            statement.close();
    }catch (SQLException e) {
        System.out.println(e);
    }

    return rs;
}

public int insertSQL(String sql){

    int rs;

    try{
        Statement statement = createConnection().createStatement();
        rs = statement.executeUpdate(sql);
        return rs;

    }catch(SQLException ex){
        System.out.println(ex);
        return 0;
    }

}
} 
```

这是tomcat控制台

```
INFO: Reloading Context with name [/Map] has started
Apr 21, 2012 12:59:14 AM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/Map] registered the JDBC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.
Apr 21, 2012 12:59:17 AM org.apache.catalina.core.StandardContext reload
INFO: Reloading Context with name [/Map] is completed

com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '********,Colombo,Sri Lanka,Now())' at line 1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:53:25.753

您需要转义/引用您的`VALUES`部分中的字符串。您的 JDBC 驱动程序将为您执行此操作，例如[使用`PreparedStatement`](https://stackoverflow.com/questions/1291584/is-jdbc-secure).

请注意，如果您将代码保持原样，或者只是添加引号，您将面临[SQL 注入攻击的真正危险。](http://en.wikipedia.org/wiki/SQL_injection)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T13:20:27.910

试试这个...

```
Connection con = mysql.createConnection();
String sql = "INSERT INTO main.users(first_name, last_name, email, password, city,
country, registered_time) VALUES(?, ?, ?, ?, ?, ?, ?);";
PreparedStatement insertStatement = con.prepareStatement(sql);
insertStatement.setString(1, first_name);
insertStatement.setString(2, last_name);
insertStatement.setString(3, email);
insertStatement.setString(4, password);
insertStatement.setString(5, city);
insertStatement.setString(6, country);
insertStatement.setString(7, new Date());
insertStatement.execute(); 
```

问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:53:31.000

尝试在变量周围加上单引号。

前任：

`VALUES('" + myString + "', '" + myOtherString + "')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:55:14.997

```
 String sql = "INSERT INTO main.users(first_name, last_name, email, password, city, country, registered_time) VALUES('"
                + fname +"', '"+ lname + "', '"+ email +"', '" + password +"',' " + city +"','" + country + "',Now())"; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-20T19:53:38.507

```
Colombo,Sri Lanka,Now())' at line 1 
```

看起来你的字符串周围缺少单引号。

# javascript - 单击图像时背景图像发生变化

> ID：10252661
> 
> 赞同：0
> 
> 时间：2012-04-20T19:51:32.193
> 
> 标签：javascript, html

因此，我试图根据单击的图标更改下一页的背景，但我不确定我的代码有什么问题！这只是一个测试页面（请原谅奇怪的代码，但我在实际网站本身中需要它！）

```
<!DOCTYPE HTML>
<html>
<head>
<style type="text/css">

 body   {

background: url('<?php echo $_GET['image']; ?>';

}

</style>

<script>
    function showWeather(Weather) {
     //alert(Weather);
        myform.weather.value=Weather;
    //  alert(Weather);

    // ._Weather
        myform.submit();

}
</script>

<link href="teststyle.css" rel="stylesheet" type="text/css">
</head>
<body background="images/gradientsky.jpg"> 
<div id="weather">

<ul id="nav-reflection">
<form method="post" action="cloudy_name.php" id="myform">
    <li class="button-color-1"><a href="cloudy_name.php?image=images/cloudysky.png" onclick="showWeather('cloudy');" title="My fancy link"><img src="images/cloudybubble.png" width="211" height="180" align="left"></a></li> 

    <input type="hidden" name="weather" value="whatever">
</form>
</ul>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:58:10.017

您在这里有几个问题，我会尝试解决它们：

```
<form method="post" action="cloudy_name.php" id="myform">
        <li class="button-color-1"><a href="javascript:showWeather('cloudysky')" onclick="changeBgImage(images/cloudysky)" title="My fancy link"><img src="images/cloudybubble.png" width="211" height="180" align="left"></a></li>
</form> 
```

1.  您缺少“ul”包装器。列表项不能单独存在。
2.  你说的是 showWeather('cloudy')。'cloudysky' 不是完整的文件名，所以可能是 cloudysky.jpg？
3.  用户正在单击一个链接并被发送到另一个页面，因此一旦用户返回，您在此处使用 javascript 所做的任何更改都不会保留。
4.  document.getElementById(test) 需要引用一个字符串，比如 document.getElementById("test")

试一试并报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:07:41.893

您的 changeBgImage 函数没有通过字符串 'image'

尝试这个：

```
 <script type="text/javascript">
        function changeBgImage (image) { // added Image
            var element = document.getElementById('test');
            element.style.backgroundImage = "url('"+image+"')"; // added single qoutes around image
            // Took out window.location - see comments below for explanation
            return false;// Added to stop Link execution
        }
    </script>
</head>
<body>
<div id="test">
    <form method="post" action="cloudy_name.php" id="myform">
        <li class="button-color-1"><a href="#" onclick="showWeather('cloudy'); changeBgImage('images/cloudysky.png');" title="My fancy link"><img src="images/cloudybubble.png" width="211" height="180" align="left"></a></li>
    </form>
</div> 
```

我将所有 javascript 函数添加到 onclick 中，两者`showWeather`和`changeBgImage`

请参阅下面的评论。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-20T20:03:33.233

IDEA：在链接上创建一个指向 php 文件的链接。类似 chg_bg.php?image=cloudy

在 php 文件上，创建一些代码来设置背景

```
<style>
    background: url('<php echo $_GET['image']; ?>';
</style> 
```

# ruby - 为什么 Nokogiri 的 to_xhtml 从 `name` 创建新的 `id` 属性？

> ID：10252663
> 
> 赞同：3
> 
> 时间：2012-04-20T19:51:51.277
> 
> 标签：ruby, xhtml, nokogiri, libxml2

考虑以下代码：

```
require 'nokogiri' # v1.5.2
doc = Nokogiri.XML('<body><a name="foo">ick</a></body>')

puts doc.to_html
#=> <body><a name="foo">ick</a></body>

puts doc.to_xml
#=> <?xml version="1.0"?>
#=> <body>
#=>   <a name="foo">ick</a>
#=> </body>

 puts doc.to_xhtml
 #=> <body>
 #=>   <a name="foo" id="foo">ick</a>
 #=> </body> 
```

`id`请注意已创建的新属性。

1.  谁对此负责，Nokogiri 还是 libxml2？
2.  为什么会出现这种情况？（这是强制执行标准吗？）
    *我能找到的最接近的是[这个规范](http://www.w3.org/TR/xhtml1/#C_8)，描述了如何**将**an`id`和`name`attribute 设置为相同的值。*
3.  有什么办法可以避免这种情况，因为希望`to_xhtml`在可能有的输入上使用该方法`<a name="foo">`？

*出现此问题是因为我有一些输入，我正在解析一个元素上的属性和一个带有碰巧发生冲突`id`的属性的单独元素。`name`*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:20:04.890

显然[这是 libxml2 的一个特性](https://github.com/tenderlove/nokogiri/issues/562)。在[http://www.w3.org/TR/xhtml1/#h-4.10](http://www.w3.org/TR/xhtml1/#h-4.10)我们发现：

> 在 XML 中，片段标识符是 type ，每个元素`ID`只能有一个 type 属性。`ID`因此，在 XHTML 1.0 中，该`id`属性被定义为 type `ID`。为了确保 XHTML 1.0 文档是结构良好的 XML 文档，XHTML 1.0 文档在为上面列出的元素**定义片段标识符时****必须使用该属性。`id`**
> [...]
> 请注意，在 XHTML 1.0 中，`name`这些元素的属性已被正式弃用，并将在 XHTML 的后续版本中删除。

我想出的最好的“解决方法”是：

```
# Destroy all <a name="..."> elements, replacing with children
# if another element with a conflicting id already exists in the document
doc.xpath('//a[@name][not(@id)][not(@href)]').each do |a|
  a.replace(a.children) if doc.at_css("##{a['name']}")
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:23:04.797

也许您可以`id`为这些元素添加一些其他值，以防止 libxml 添加自己的值。

```
doc.xpath('//a[@name and not(@id)]').each do |n|
  n['id'] = n['name'] + 'some_suffix'
end 
```

（显然，您需要确定如何`id`为您的文档创建一个独特的价值）。

# php - 即使我将其设置为删除，cookie 也会不断返回

> ID：10252666
> 
> 赞同：0
> 
> 时间：2012-04-20T19:52:14.400
> 
> 标签：php

好的，我使用此代码设置 cookie

```
setcookie("search", "active", time()+3600); 
```

我用它来删除cookies

```
setcookie("search", "active", time()-3600); 
```

我用它来检查和检索cookies

```
<?
  if (isset($_COOKIE["search"]))
  {
      if ($_COOKIE["search"] === "active")
      {
          echo "cookies active"."<br/>";
          echo $_COOKIE["search"];
      }
      else
      {
          echo "cookies is not active";
      }
  }
  else
  {
      echo "no cookies";
  }
?> 
```

但是即使我在刷新页面时使用上面指定的方法将其删除，设置的 cookie 也会一次又一次地返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:56:47.733

在 PHP 中删除 cookie 不会影响 $_COOKIE 超级全局变量，因为此数组在脚本运行之前填充。但是，当您加载下一页时，它应该不再出现在 $_COOKIE 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:21:52.937

不知道为什么你会收到这个错误，但以前见过这个

示例：调用

```
setcookie ( "user", "Alex Porter", time () + 3600 );
setcookie ( "search", "active", time () + 3600 );

var_dump($_COOKIE);

setcookie ( "search", "", time () - 3600 ); 
```

仅输出

```
array(1) {
    ["user"]=>
    string(11) "Alex Porter"
} 
```

预期结果

```
array(2) {
    ["user"]=>
    string(11) "Alex Porter"
    ["search"]=>
    string(6) "active"
} 
```

结论

我想你会坚持只吃一个 cookie 或一次删除所有 cookie

尝试

注意* 确保`setcookie`始终位于页面顶部并且之前没有输出

```
setcookie ( "search", "active", time () + 3600 );  
//setcookie ( "search", "", time () - 3600 );  // uncomment when you want to remove cookie
if (isset ( $_COOKIE ["search"] )) {
    if ($_COOKIE ["search"] === "active") {
        echo "cookies active" . "<br/>";
        echo $_COOKIE ["search"];
    } else {
        echo "cookies is not active";
    }
} else {
    echo "no cookies";
} 
```

# android - Android AlarmManager 触发

> ID：10252668
> 
> 赞同：0
> 
> 时间：2012-04-20T19:52:21.910
> 
> 标签：android, alarmmanager

我有一个闹钟，我可以安排它在某个时间响起。问题是，当我把它放到未来时，它会在我设置它的那一刻起作用。它可以正常工作。但问题是，如果我在过去安排它，它会立即关闭。

例如，如果现在是下午 3:30，我将它安排在下午 3:35，它会在下午 3:35 触发。但是如果现在是下午 3:30，而我将它安排在下午 3:25，它会立即触发，因为它已经过去了。

我想要它做的是，如果它过去了，就忽略它，直到间隔时间过去。

这是代码：

```
 Intent intent = new Intent(context, AlarmReceiver.class);

     PendingIntent sender = PendingIntent.getBroadcast(context,     ApplicationClass.AlertNotifyID, intent, PendingIntent.FLAG_UPDATE_CURRENT);
     AlarmManager am = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
     long milliSeconds24Hours = 86400000; //86400000 which is 24 hours in milliseconds
     am.setRepeating(AlarmManager.RTC_WAKEUP,  GetNotificationTime(context), milliSeconds24Hours, sender); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T15:14:16.447

您需要获取它以检查预定时间是否过去，如果是，请将闹钟设置为第二天开始。

# eclipse - 检查项目是否使用 Java 7 中引入的代码

> ID：10252670
> 
> 赞同：3
> 
> 时间：2012-04-20T19:52:47.737
> 
> 标签：eclipse, maven, java

在我的开发机器上，我安装了 JDK 1.7，但我们正在打包用于 Java 1.5 和 1.6 的软件。很容易设置`-source`和`-target`选项，以便强制**语法**为特定版本，并且**输出类**可由特定 VM 解释。但是还有其他版本主义让我很苦恼，比如 2-argument 构造函数`AssertionError(String, Throwable)`和其他各种微妙的变化。

我知道的一个解决方案是安装每个不同的 JDK（1.5、1.6、1.7），以便 Eclipse 可以完全匹配我的执行环境。有没有其他方法可以检测这些问题？如果它是 Eclipse 或 Maven 工具，则可以加分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:11:26.177

Codehaus[动物嗅探器 maven 插件](http://mojo.codehaus.org/animal-sniffer-maven-plugin/)怎么样？我还没有理由尝试它，但认为它看起来很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:56:15.710

[这个工具](http://code.google.com/p/versioncheck/)有帮助吗？它是命令行，我见过有人用它来检测正在使用的 java7。

# ember.js - ember.js 状态管理器用于选项卡

> ID：10252673
> 
> 赞同：2
> 
> 时间：2012-04-20T19:53:04.043
> 
> 标签：ember.js

我有 3 个标签导航，每个标签的内容明显不同。我正在考虑在 Emberjs 中使用 StateManager 来管理我的选项卡视图。

[http://docs.emberjs.com/#doc=Ember.StateManager&src=false](http://docs.emberjs.com/#doc=Ember.StateManager&src=false)

这是一个好主意吗？还是那里有更好的路由器？我看过

1.  新芽核心路由
2.  ember-routemanager

那些比国家经理好吗？不使用 statemanager 的原因是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T13:47:43.117

您可以使用以下内容，请参阅[http://jsfiddle.net/pangratz666/e3wM7/](http://jsfiddle.net/pangratz666/e3wM7/)：

**车把**：

```
<script type="text/x-handlebars" >
    <ul>
        <li {{action "showFirst" target="App.stateManager"}} >First tab</li>
        <li {{action "showSecond" target="App.stateManager"}} >Second tab</li>
    </ul>
    <div class="tab-content" ></div>
</script>

<script type="text/x-handlebars" data-template-name="first" >
    first
</script>
<script type="text/x-handlebars" data-template-name="second" >
    second
</script>​ 
```

**JavaScript**：

```
App.stateManager = Ember.StateManager.create({
    rootElement: '.tab-content',
    initialState: 'firstTab',

    showFirst: function(manager) {
        manager.goToState('firstTab');
    },
    showSecond: function(manager) {
        manager.goToState('secondTab');
    },

    firstTab: Ember.ViewState.create({
        view: Ember.View.extend({ templateName: 'first' })
    }),
    secondTab: Ember.ViewState.create({
        view: Ember.View.extend({ templateName: 'second' })
    })
});​ 
```

* * *

还可以查看博[文 Anatomy of an Ember.js App Part I Redux: Routing and Outlets](http://codebrief.com/2012/07/anatomy-of-an-ember-dot-js-app-part-i-redux-routing-and-outlets/)。

# c# - 在 C# 中动态创建 Json

> ID：10252675
> 
> 赞同：41
> 
> 时间：2012-04-20T19:53:24.940
> 
> 标签：c#, asp.net, json, c#-4.0, json.net

我需要通过循环遍历列来动态创建一个 Json 对象。所以声明一个空的 json 对象然后动态地向它添加元素。

例如：

```
List<String> columns = new List<String>{"FirstName","LastName"};

var jsonObj = new {};

for(Int32 i=0;i<columns.Count();i++)
    jsonObj[col[i]]="Json" + i; 
```

最终的 json 对象应该是这样的：

```
jsonObj={FirstName="Json0", LastName="Json1"}; 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-04-20T20:21:22.820

```
[TestFixture]
public class DynamicJson
{
    [Test]
    public void Test()
    {
        dynamic flexible = new ExpandoObject();
        flexible.Int = 3;
        flexible.String = "hi";

        var dictionary = (IDictionary<string, object>)flexible;
        dictionary.Add("Bool", false);

        var serialized = JsonConvert.SerializeObject(dictionary); // {"Int":3,"String":"hi","Bool":false}
    }
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-05-07T19:04:37.430

我找到了一个与 DPeden 非常相似的解决方案，虽然不需要使用 IDictionary，但您可以直接从 an 传递`ExpandoObject`到 JSON 转换：

```
dynamic foo = new ExpandoObject();
foo.Bar = "something";
foo.Test = true;
string json = Newtonsoft.Json.JsonConvert.SerializeObject(foo); 
```

输出变为：

```
{ "FirstName":"John", "LastName":"Doe", "Active":true } 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-04-20T19:55:44.843

你应该使用`JavaScriptSerializer`. 这可以为您将实际类型序列化为 JSON :)

参考：http: [//msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)

**编辑：像这样的东西？**

```
var columns = new Dictionary<string, string>
            {
                { "FirstName", "Mathew"},
                { "Surname", "Thompson"},
                { "Gender", "Male"},
                { "SerializeMe", "GoOnThen"}
            };

var jsSerializer = new JavaScriptSerializer();

var serialized = jsSerializer.Serialize(columns); 
```

输出：

```
{"FirstName":"Mathew","Surname":"Thompson","Gender":"Male","SerializeMe":"GoOnThen"} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-01-16T15:48:42.023

使用`dynamic`和`JObject`

```
dynamic product = new JObject();
product.ProductName = "Elbow Grease";
product.Enabled = true;
product.StockCount = 9000;

Console.WriteLine(product.ToString());
// {
//   "ProductName": "Elbow Grease",
//   "Enabled": true,
//   "StockCount": 9000
// } 
```

或者怎么样：

```
JObject obj = JObject.FromObject(new
{
    ProductName = "Elbow Grease",
    Enabled = true,
    StockCount = 9000
});

Console.WriteLine(obj.ToString());
// {
//   "ProductName": "Elbow Grease",
//   "Enabled": true,
//   "StockCount": 9000
// } 
```

[https://www.newtonsoft.com/json/help/html/CreateJsonDynamic.htm](https://www.newtonsoft.com/json/help/html/CreateJsonDynamic.htm)

# javascript - 将对象转换为字符串 Javascript 时出错

> ID：10252687
> 
> 赞同：0
> 
> 时间：2012-04-20T19:53:53.123
> 
> 标签：javascript, string

我正在尝试在 JavaScript 中将对象转换为字符串以进行一些字符串操作。这是我的代码：

```
 var userName=String(userInfo.email);//regular email like user@email.com
   var atIndex=userName.indexof("@"); 
```

我收到以下错误：

```
TypeError: Object feraeww23d4@wo3ewwito.co2mb has no method 'indexof' 
```

我做错了什么？

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T19:55:24.230

`indexOf`

资本`O`很重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T19:55:48.257

“O”应该是大写字母。你确定你没看错？

# tcl - Eggdrop TCL 正常运行时间脚本

> ID：10252691
> 
> 赞同：1
> 
> 时间：2012-04-20T19:54:02.337
> 
> 标签：tcl, eggdrop

我在互联网上找到了这个脚本。它有点旧，开发人员页面早已不复存在。该代码有效，但我正在尝试对其进行一些清理。例如：如果周数 = 0，则不显示它。我从控制台收到有关额外令牌的错误。我试图用谷歌搜索这个错误，但没有任何可靠的东西出现。寻找一些见解。

评论部分是我“清理它”的尝试。这是我收到的错误。

**Tcl 错误 [正常运行时间]：表达式“$::time(week) = 0”中的语法错误：表达式末尾的额外标记**

评论该部分后，它工作正常。只是想清理一下，所以它不会返回“我已经在线 0 周 0 天 0 小时 1 分钟”。

```
bind pub "-|-" !uptime uptime
proc uptime { nick host handle channel text } {

putquick "PRIVMSG $channel :I have been online for [eggtime]."

}

proc eggtime {} {
  set ::time(uptime) [expr [clock seconds]-$::uptime]
  set ::time(week) [expr $::time(uptime)/604800]
  set ::time(uptime) [expr $::time(uptime)-$::time(week)*604800]
  set ::time(days) [expr $::time(uptime)/86400]
  set ::time(uptime) [expr $::time(uptime)-$::time(days)*86400]
  set ::time(hour) [expr $::time(uptime)/3600]
  set ::time(uptime) [expr $::time(uptime)-$::time(hour)*3600]
  set ::time(mins) [expr $::time(uptime)/60]
  set ::time(uptime) [expr $::time(uptime)-$::time(mins)*60]
  set ::time(secs) $::time(uptime)

#if {$::time(week) = 0} {
#  set ::time(return) "$::time(days) day\(s\), $::time(hour) hour\(s\), $::time(mins) minute\(s\) and $::time(secs) second\(s\)"
#} else if {$::time(days) = 0} {
#  set ::time(return) "$::time(hour) hour\(s\), $::time(mins) minute\(s\) and $::time(secs) second\(s\)"
#} { 
#  set ::time(return) "$::time(week) week\(s\), $::time(days) day\(s\), $::time(hour) hour\(s\), $::time(mins) minute\(s\) and $::time(secs) second\(s\)"
#}

  set ::time(return) "$::time(week) week\(s\), $::time(days) day\(s\), $::time(hour) hour\(s\), $::time(mins) minute\(s\) and $::time(secs) second\(s\)"

  return $::time(return)
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:05:11.690

相等运算符是 ==。您在评论块的最后部分缺少一个`else`。您还应该使用`elseif`而不是`else if`. 这不是 C。

但是，这是我之前写的一个，它需要一个经过的时间间隔并返回一个英文字符串。它大致是您的目标。

```
# paste::delta --
#
#       Returns the time difference between the given and current time
#       as an english string.
#
proc ::paste::delta {time} {
    set r $time
    catch {
        set delta [expr {[clock seconds] - $time}]
        if {$delta < 60} {
            set r "$delta secs ago"
        } elseif {$delta < 3600} {
            set r "[expr {$delta / 60}] mins ago"
        } elseif {$delta < 86400} {
            set r "[expr {$delta / 3600}] hours ago"
        } else {
            set r "[expr {$delta / 86400}] days ago"
        }
    }
    return $r
} 
```

所以你会得到像 [paste::delta 7260] 给出“2 小时前”或 310 给出“5 分钟前”的东西。

另一件事 - 对于`expr`语句，总是用花括号括住表达式的主体。否则解析器必须再次解析主体，并且可能会产生显着的性能成本。

# java - 静态分析 Java 中的 Option 是否永远不为空

> ID：10252692
> 
> 赞同：0
> 
> 时间：2012-04-20T19:54:04.200
> 
> 标签：java, option, static-analysis

每隔一段时间，我们就会看到一个错误，即功能性 Java 选项字段未初始化，因此得到一个 null 值。

如果开发人员忘记初始化选项字段，我们想使用静态代码分析工具来警告我们。

有什么好方法可以做到这一点？我们是否可能需要为其中一种工具编写一个插件才能使其正常工作？或者你认为有人可能已经实现了这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:56:56.413

已经有很多工具可用（免费/付费）。例如 PMD 是免费的插件（至少对于 eclipse）。您可以配置适用于您的项目的规则。您可以编写新规则并添加它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:59:35.043

[FindBugs](http://www.ibm.com/developerworks/java/library/j-findbug1/)是一个出色的工具，可以检查可能`NullPointerException`的 s 我们通常会在我们的 maven 项目 pom 文件中添加一个“任务”，以便每次编译代码时都会运行 findbugs。

# aggregate-functions - 蒙德里安：帮助为度量选择正确的聚合器？

> ID：10252695
> 
> 赞同：0
> 
> 时间：2012-04-20T19:54:16.697
> 
> 标签：aggregate-functions, mdx, olap, pentaho, mondrian

我计算出的一些衡量标准与销售额或收入等数据的汇总方式不同。在销售额中，如果您想计算该季度的销售额，您可以将该季度下降的每个月的销售额中的所有条目相加。通常，您只需在模式中将 Sales Measure 的聚合器声明为 sum 即可。

考虑我们有一个就业条目表。如果某员工在该月受雇，则该员工的表中有一个条目。我们想知道月份、季度或年份的人数。在这种情况下，像人数这样的措施没有意义以同样的方式总结。该季度的人数与该季度该月最后一天的人数相同。将第一季度的人数加起来不是 1 月、2 月和 3 月的总和。这只是 3 月 31 日的人数？但是，我从给定的聚合器中看不到任何允许您指定的选择。

当您使用最低的时间划分（如月份）时，一切都适用于 Head Count，但是当您开始查看季度或年度的人数时，总结并没有多大意义。

那么，考虑到用于计算人头数的事实中可能包含许多其他维度，那么如何处理人头数之类的事情呢？您需要汇总某些维度的人数，但您无法汇总所有已过时的条目？我希望以某种方式将此逻辑封装到架构中，这样用户就不必在每次想要使用人数定义报告时添加额外的过滤器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:14:58.160

没有人试图回答这个问题，因为它问得不好。所以我问了另一个我认为更好的问题。

[如何使用 MDX 执行不同的求和？](https://stackoverflow.com/questions/13057676/how-to-perform-a-distinct-sum-using-mdx)

# ruby-on-rails - 网站开发：渲染对服务器端与客户端的看法？

> ID：10252696
> 
> 赞同：1
> 
> 时间：2012-04-20T19:54:17.440
> 
> 标签：ruby-on-rails, model-view-controller, mustache, handlebars.js

我需要向你们那里的人/女孩询问关于网站开发的概念，我没有找到大量的文档。也许我使用了错误的词汇？它基本上是在客户端和服务器端呈现视图（在 MVC 类型的站点中）。

这是我到目前为止所知道的。通常在模型、控制器、视图类型的网站中，视图是 HTML/CSS/Javascript 设计被编程的内容。现在的想法是服务器处理所有 HTML/CSS/Javascript，发送到客户端浏览器的是完成的视图。我相信这适用于 C#、MS.net、Java、PHP 以及 Rails。

现在，客户端的工作方式是，服务器停止尝试为 HTML/CSS/Javascript 呈现视图，而只为原始 XML 数据呈现视图。此外，一个类似 Javascript 的程序（handlebars.js 和 mustache.js，例如）被下载一次，缓存，并且 XML 数据通过 javascript 程序提供，进而动态创建 HTML/CSS/Javascript 视图。这背后的想法是，服务器只需要 XML 数据、初始 JS 程序和媒体。不需要每次都刷新页面，只需要 XML 或 JSON 数据。

现在，我可以看到希望做广告、博客、经销商等的小型企业的优势。1\. 最大限度地减少来自公司服务器的原始数据量，以及 2\. 将媒体和预编译代码发送到云服务像amazon.com这样的网站。

但是，如果所有信息都需要从公司的服务器提供呢？在我看来，Rails 3+ 已经解决了一些关于选择客户端的争论

我如何才能找到有关此的更多信息，以便在选择客户端还是服务器时做出更明智的决定？

欢迎所有评论！谢谢(^_^)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:09:04.563

服务器只涉及 PHP、Java、ASP.NET（C# 和 VB.NET）等。JavaScript 是客户端代码。MVC 模型更多地用于服务器端代码，用于说明如何分解它。它试图使逻辑远离设计。[Magento](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-1-introduction-to-magento)就是一个很好的例子。

此外，客户端代码[容易受到黑客攻击](http://blog.sabretoothglobal.com/client-side-hacking-demystified/)

[http://php-html.net/tutorials/model-view-controller-in-php/](http://php-html.net/tutorials/model-view-controller-in-php/)

# php - php代码返回错误日志问题

> ID：10252698
> 
> 赞同：1
> 
> 时间：2012-04-20T19:54:36.113
> 
> 标签：php

我的 php 文件中有这行返回错误：

```
echo "<script type=\"text/javascript\">window.locaiton = \"http://www.mywebsite.com/formsubmit.html"\"</script"; 
```

错误日志说

```
[20-Apr-2012 13:53:17] PHP Warning:  Unexpected character in input:  '\' (ASCII=92) state=1 in /home6/mywebsite/public_html/func2.php on line 455
[20-Apr-2012 13:53:17] PHP Parse error:  syntax error, unexpected T_CONSTANT_ENCAPSED_STRING, expecting ',' or ';' in /home6/mywebsite/public_html/func2.php on line 455 
```

我不知道如何解决它。感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:58:30.407

a) 您输入错误的位置

b）你有一个“太多了。

c) 你忘记关闭 /script 标签

尝试

```
echo "<script type=\"text/javascript\">window.location = \"http://www.mywebsite.com/formsubmit.html\";</script>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:57:11.997

```
window.locaiton 
```

应该

```
window.location 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:57:22.873

您的引号、位置和脚本结束标记有问题。

```
formsubmit.html"\"</script";
               ^          ^ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:58:21.470

你错过了一个反斜杠

```
echo "<script type=\"text/javascript\">window.locaiton = \"http://www.mywebsite.com/formsubmit.html\"\"</script>"; 
```

# c# - ASP.NET MVC 在发布方法期间更新数据库对象的正确方法是什么

> ID：10252701
> 
> 赞同：1
> 
> 时间：2012-04-20T19:55:13.777
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我已经使用 .net MVC 一两年了，这个问题在我的书中一直没有答案。让我演示一个非常简单的例子

人视图模型

```
public class PersonViewModel
{
    public Person person { get; set; } //person is a db generated object
    public SelectList jobtypes { get; set; } // drop down list for this view 
} 
```

个人控制器

```
public ActionResult Edit( int id )
{
    PersonViewModel model = new PersonViewModel();
    model.person = db.GetPerson(id); //get a person from the db
    model.jobtypes = GetThemJobTypes();
    return View(model);
} 
```

现在的问题是我应该做以下哪一项？

```
[HttpPost]
public ActionResult Edit ( PersonViewModel model )
{
     Person person = db.GetPerson(model.person.personid);

     person.firstname = model.person.firstname;
     person.lastname = model.person.lastname;
     person.jobtypeid = model.person.jobtypeid;
     person.save();

     person.favoritetoy.name = model.person.favoritetoy.name;
     person.favoritetoy.save();
} 
```

或者

```
[HttpPost]
public ActionResult Edit (int id, FormCollection formValues)
{
     Person person = db.GetPerson(id);
     UpdateModel(person, "person"); 
     person.save()

     UpdateModel(person.favoritetoy, "favoritetoy");
     person.favoritetoy.save()
} 
```

似乎带有 updatemodel 的 formcollection 方法是网络各处的首选方法。我有点矛盾的是，我们已经有了一个包含我们想要的字段的 ViewModel，为什么还要再次使用 formcollection？许多人还指出在帖子中严格使用视图模型，但我还没有看到使用该方法更新数据库模型的好例子。

更新数据库对象的预期方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:03:41.453

真的没有*预定*的方法。与 Ruby on Rails 不同，ASP.Net MVC 框架不会将您绑定到控制器和模型交互的任何特定模式中。就我个人而言，我使用更接近第一个的东西，因为如果你犯了错误而不是运行时错误，它更有可能导致编译器错误。我建议将此代码移动到您的控制器方法以外的位置，但是因为它会迅速失控。

# html - 来自 wget 的 grep html 文件

> ID：10252704
> 
> 赞同：0
> 
> 时间：2012-04-20T19:55:16.987
> 
> 标签：html, grep, wget

我使用 wget 下载与 Academic.google.com 中给定查询匹配的论文数量，并获得一个显示页面所有内容的文件。

我想检索文件“大约 8,890 的结果 1 - 10”以下部分中的最后一个数字。

我试过了：

```
 cat /dir/file | tr -d "," | grep -o -E -- 'about ([^"]+) \w+' 
```

但它输出：

```
 about <b>8890</b>.   (<b>0.12</b> sec)&nbsp;</font></td></tr></table></form>    <div class 
```

而我只想要8890（没有逗号，由 tr -d ","

关于如何改进它的任何建议？先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:59:45.760

Grep 拉出正确的行 - 之后使用 sed 砍掉你不想要的东西。

```
 cat /dir/file | tr -d "," | grep -o -E -- 'about ([^"]+) \w+' |sed -e 's/.*about <b>//' -e 's/<.b>.*//' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:04:09.653

尝试类似：`sed -n 's#.*about <b>\([0-9]*\)</b>.*#\1#p'`而不是`grep`.

`-n`表示默认不打印输入行，`s`标志`p`表示如果替换则打印。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:53:57.680

如果您的文件中存在 html 标记 (`<b>`和`</b>`)，您还必须修改正则表达式来处理它们。要获取您感兴趣的片段，请使用后向断言。这是应该起作用的东西： `cat /dir/file | tr -d "," | grep -oP -- '(?<=about <b>)[^/<> ]+'`

# javascript - 谷歌融合表查询数据操作

> ID：10252706
> 
> 赞同：0
> 
> 时间：2012-04-20T19:55:29.393
> 
> 标签：javascript, google-maps-api-3, google-fusion-tables

我一直在从谷歌融合表中查询位置，并使用以下代码将这些点映射到谷歌地图图层：

```
 function mapPoints() {
            searchStr = 'ST_INTERSECTS(Location, RECTANGLE(' + 'LATLNG' + map.getBounds().getSouthWest() + ',' + 'LATLNG' + map.getBounds().getNorthEast() + '))';
            layer.setOptions({
                query: {
                    select: 'Location',
                    from: tableid,
                    where: searchStr
                }
            });
        } 
```

除了映射位置之外，我还想将从查询返回的数据存储在某种表中以供进一步操作/参考。谁能告诉我如何做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:24:57.830

如果您希望在服务器端执行此操作，那么您绝对可以使用 SQL API 执行此操作，它支持与地图图层相同的查询语法。

[https://developers.google.com/fusiontables/docs/developers_guide#WritingApps](https://developers.google.com/fusiontables/docs/developers_guide#WritingApps)

然而，目前没有任何公开的方式来访问 FusionTables 层中的各个位置，因此这会阻止您在客户端上保存位置数据的本地副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T03:45:05.083

但是有一个用于查询 Fusion Tables 的“未记录的”JSONP 选项。[我在这个答案](https://stackoverflow.com/a/9778985/1211981)中给出了一些示例代码。它是相同的 API 并返回实际的 FT 功能以及位置。

# google-maps - 传递字段数据以用作多边形样式设置 + Google Fusion Table Maps

> ID：10252707
> 
> 赞同：0
> 
> 时间：2012-04-20T19:55:31.660
> 
> 标签：google-maps, google-fusion-tables

帮助！

基本上我想要做的是使用 API 中配置地图样式 UI 中的“使用列中指定的颜色”选项，这是 google 5 类别限制的“有希望的”解决方法。

我有一个定义不同类别的颜色字段，我想将单个多边形设置为该字段中设置的颜色。我有一个监听器，这个概念非常适合单击的多边形，但是它只会更改单击的多边形，它对其他多边形的工作方式不同。我对 javascript/sql 和 fusion 表还很陌生，所以我可以想象我做错了很多事情，但幸运的是，大部分工作大部分都在工作。以下是我正在尝试做的总体思路：

```
google.maps.event.addListener(layer, "click", function(e) { 
var county = e.row["name"].value;
suppressInfoWindows:true
    layer.setOptions({
    query: {
    select: 'geometry',
          from: '3609287'
        },
        styles: [{
          polygonOptions : {
            fillColor: row["PerChngColor"].value
          },
          where: "name = " + county,
          polygonOptions : {<br/>
            strokeColor: "#FF9900",
            strokeWeight: 5,<br/>
            fillColor: String(e.row["PerChngColor"].value)
          }
      }]
  });
  }); 
```

第一个 fillColor:row["PerChngColor"].value 确实是我想要的工作。“应该”设置多边形的颜色。第二个效果很好。任何有关如何解决此问题的建议将不胜感激。

谢谢，

基思·W

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:53:10.133

您发布的代码中有很多语法错误，不确定是否是问题所在。但 ...

```
suppressInfoWindows: true. 
```

这应该会引发 JS 语法错误。应该

```
polygonOption: {<br/>`  
 ...
strokeWeight: 5,<br/> 
```

最后，你拥有的那条线。

```
fillColor: row["PerChngColor"].value 
```

应该是：

```
fillColor: e.row["PerChngColor"].value 
```

# php - 将 php 函数放入 XML 请求中

> ID：10252709
> 
> 赞同：0
> 
> 时间：2012-04-20T19:55:34.493
> 
> 标签：php, function, simplexml

我正在尝试将 while 循环的结果添加到 xml 请求中。但它没有正确显示。下面我首先创建一个函数，然后我尝试使该函数在 xml 请求 curl 标记内工作。很难解释，也更容易看到：

```
 //Getting room groups
    function roomGroups(){
    $i = 2;
            while(isset($_GET['ad'.$i]))
            {
                $adult = $_GET['ad'.$i];
                $child = $_GET['ch'.$i];
                $childAge = $_GET['ch'.$i];
                echo "<RoomGroup><Room><numberOfAdults>".$adult."</numberOfAdults><numberOfChildren>".$child."<childAges>".$childAge."</childAges></Room></RoomGroup>"; 
                $i++; 
                }}                  
    //Room availablility Request
    $ch1 = curl_init(); 
    $fp1 = fopen('room_request.xml','w'); 
    curl_setopt($ch1, CURLOPT_URL, "http://api.ean.com/ean-services/rs/hotel/v3/avail?cid=379849&minorRev=13&apiKey=4sr8d8bsn75tpcuja6ypx5g3&locale=en_US&currencyCode=USD&customerIpAddress=67.20.125.193&customerUserAgent=Mozilla/5.0+(Windows+NT+6.1)+AppleWebKit/535.11+(KHTML,+like+Gecko)+Chrome/17.0.963.79+Safari/535.11&customerSessionId=0ABAA856-8502-E913-6982-E2210F904B72&xml=<HotelRoomAvailabilityRequest><hotelId>".$hid."</hotelId><arrivalDate>".$arrivalDate."</arrivalDate><departureDate>".$departingDate."</departureDate><RoomGroup><Room><numberOfAdults>".$adults."</numberOfAdults><numberOfChildren>".$children."</numberOfChildren><childAges>".$ages."</childAges></Room></RoomGroup>".roomGroups()."<includeDetails>true</includeDetails></HotelRoomAvailabilityRequest>");  
    curl_setopt($ch1, CURLOPT_RETURNTRANSFER, 1); 
    curl_setopt($ch1, CURLOPT_HTTPHEADER, array('Accept: application/xml'));
    curl_setopt($ch1, CURLOPT_HEADER, 0); 
    curl_setopt($ch1, CURLOPT_FILE, $fp1); 
    $val1 = curl_exec($ch1); 
    curl_close($ch1);//Close curl session 
    fclose($fp1); //Close file overwrite 
    $avail = simplexml_load_file('room_request.xml');

//The url that is passing the data looks like this: /hotel_request.php?hid=370111&d=05/02/2012&a=04/30/2012&r=3&ad2=2&ch2=22=16,17,&ad3=3&ch3=33=7,13,16,& 
```

我什么也得不到。对此的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:59:35.873

`roomGroups()`没有`return`什么，它只是`echo`在屏幕上。

尝试这样的事情：

```
function roomGroups(){
    $i = 2;
    $ret = '';
    while(isset($_GET['ad'.$i])){
        $adult = $_GET['ad'.$i];
        $child = $_GET['ch'.$i];
        $childAge = $_GET['ch'.$i];
        $ret .= "<RoomGroup><Room><numberOfAdults>".$adult."</numberOfAdults><numberOfChildren>".$child."<childAges>".$childAge."</childAges></Room></RoomGroup>"; 
        $i++; 
    }
    return $ret;
} 
```

# c# - 如何将准确的差异列添加到 DataTable？

> ID：10252714
> 
> 赞同：0
> 
> 时间：2012-04-20T19:55:49.907
> 
> 标签：c#, ado.net

我需要比较来自具有相同架构的两个数据表的数字数据。例如两个包含数据的表，例如

> PK专栏 | 数列 | 小数列

合并后会变成这样

> PK专栏 | 数列 1 | 数列 2 | numCol 差异 | 小数列 1 | 小数列 2 | DecimalCol 差异

最初，我只是将 diff 列创建为表达式 col1-col2 但我最终会得到不寻常的值

```
col1    col2    diff        c1      c2      diff
12.8    14.6    -1.80000019 33.2    29.8    3.40000153 
```

但我想要的是：

```
col1    col2    diff        c1      c2      diff
12.8    14.6    -1.8        33.2    29.8    3.4 
```

所以我目前的解决方案是手动遍历行并使用此方法设置值：

```
private static void SetDifference(DataRow dataRow, DataColumn numericColumn)
{
    dynamic value1 = dataRow[numericColumn.Ordinal - 2];
    dynamic value2 = dataRow[numericColumn.Ordinal - 1];

    if (IsDbNullOrNullOrEmpty(value1) || IsDbNullOrNullOrEmpty(value2)) return;

    //now find out the most decimals used and round to this value
    string valueAsString = value1.ToString(CultureInfo.InvariantCulture);

    int numOfDecimals = valueAsString.SkipWhile(c => c != '.').Skip(1).Count();

    valueAsString = value2.ToString(CultureInfo.InvariantCulture);

    numOfDecimals = System.Math.Max(numOfDecimals, valueAsString.SkipWhile(c => c != '.').Skip(1).Count());

    double result = Convert.ToDouble(value1 - value2);

    dataRow[numericColumn] = System.Math.Round(result, numOfDecimals);
} 
```

但它感觉笨重，不利于性能。欢迎提出改进建议。

**编辑：**将列名从“int”更改为“num”以避免混淆

**编辑：**另外，我并不总是想四舍五入到小数点后一位。我可能有像 numA: 28 numB: 75.7999954 这样的数据，所以我想要一个差异：-47.7999954

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:03:33.583

如果您有存储整数的列，则为它们使用整数类型！可能您使用了单精度浮点类型。十进制类型也是如此。为它们使用十进制列类型，这个舍入问题将消失！

如果您使用真正的十进制类型（不是浮点数、单数、实数或双精度数），您将不会遇到舍入问题。我不知道您使用的是哪个数据库，但对于 SQL-Server，正确的列类型应该是`decimal`.

* * *

**更新**

由于您无法更改列类型，因此将其四舍五入到要求的精度，如下所示

```
result = Math.Round((c1-c2) * 10)/10; // One decimal
result = Math.Round((c1-c2) * 100)/100; // Two decimals
result = Math.Round((c1-c2) * 1000)/1000; // Three decimals 
```

```
数学圆（3.141592654 * 10000）/10000 ===> 3.1416

```

--

**更新**

试试这个，它在大多数情况下应该表现良好

```
decimal result = (decimal)col1 - (decimal)col2; 
```

测试

```
12.8f - 14.6f ===> -1.80000019

（十进制）12.8f - （十进制）14.6f ===> -1.8

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T13:34:24.347

根据 Olivier 的评论，我将代码更新为如下所示：

```
if(numericColumn.DataType == typeof(int))
{
    dataRow[numericColumn] = System.Math.Abs(value1 - value2);
}
else
{
    dataRow[numericColumn] = Convert.ToDecimal(value1) - Convert.ToDecimal(value2);
} 
```

看起来更干净，它完成了工作。谢谢您的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:01:24.280

您应该在 sql 查询中使用

```
ROUND(table1.IntCol 1 - table2.IntCol 2, 1) 
```

# filter - XQuery - 仅检索部分信息

> ID：10252715
> 
> 赞同：2
> 
> 时间：2012-04-20T19:55:54.183
> 
> 标签：filter, limit, xquery

我使用 XQuery 进行统计。我有一份这样的文件：

```
<tr>
  <td>Element 1</td>
  <td>100</td>
</tr>
<tr>
  <td>Element 2</td>
  <td>80</td>
</tr>
<tr>
  <td>Element 3</td>
  <td>40</td>
</tr>
<tr>
  <td>Element 4</td>
  <td>12</td>
</tr>
<tr>
  <td>Element 5</td>
  <td>8</td>
</tr> 
```

并且只想检索该文档的一部分：我只想获得**元素数量总和的 80%**（实际上是帕累托分布）。

在这种情况下，我总共有 240 个元素。我希望在我的输出中包含第一个元素，以便元素总数为 192 (240*80/100)。

在此示例中，理想的输出将只有前三个元素，如下所示：

```
<tr>
  <td>Element 1</td>
  <td>100</td>
</tr>
<tr>
  <td>Element 2</td>
  <td>80</td>
</tr>
<tr>
  <td>Element 3</td>
  <td>40</td>
</tr> 
```

我希望我很清楚：s。我找了很久，没有成功，我不知道怎么办...

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T04:42:10.333

**使用**：

```
 for $total in sum(/*/*/td[2]),
        $pareto in $total*80 div 100,
        $i in 1 to count(/*/*)
      return
        if(sum(/*/*[position() le $i]/td[2]) ge $pareto
         and
           sum(/*/*[position() lt $i]/td[2]) lt $pareto
           )
           then /*/*[position() le $i]
           else () 
```

**当这个 XPath 表达式（是的，这是一个 XQuery 表达式，也是一个 XPath 2.0 表达式）根据提供的 XML（包装到单个 tope 元素中以成为格式良好的 XML 文档）进行评估时：**

```
<table>
    <tr>
        <td>Element 1</td>
        <td>100</td>
    </tr>
    <tr>
        <td>Element 2</td>
        <td>80</td>
    </tr>
    <tr>
        <td>Element 3</td>
        <td>40</td>
    </tr>
    <tr>
        <td>Element 4</td>
        <td>12</td>
    </tr>
    <tr>
        <td>Element 5</td>
        <td>8</td>
    </tr>
</table> 
```

**产生了想要的正确结果**：

```
<tr>
    <td>Element 1</td>
    <td>100</td>
  </tr>
<tr>
    <td>Element 2</td>
    <td>80</td>
  </tr>
<tr>
    <td>Element 3</td>
    <td>40</td>
</tr> 
```

# asp.net-mvc - DataBinding：“System.Web.Mvc.SelectListItem”不包含名为“CategoryTypeID”的属性

> ID：10252716
> 
> 赞同：14
> 
> 时间：2012-04-20T19:55:55.113
> 
> 标签：asp.net-mvc, razor, html.dropdownlistfor

我正在使用 MVC。我想传递我从视图中输入的类别数据并传递给我的 Post/Createcontroller，但它不允许我传递我从下拉列表中选择的 categoryTypeID。

这是错误：

DataBinding：“System.Web.Mvc.SelectListItem”不包含名为“CategoryTypeID”的属性。

这是我的代码：

```
My CreateController:
//
        // POST: /Category/Create

        [HttpPost]
        public ActionResult Create(Category category)
        {
            if (ModelState.IsValid)
            {
                db.Categories.Add(category);
                db.SaveChanges();
                return RedirectToAction("Index");
            }

            ViewBag.CategoryTypes = new SelectList(db.CategoryTypes, "CategoryTypeID", "Name", category.CategoryTypeID);

            return View(category);
        }
My Create View
@model Haykal.Models.Category

<div class="editor-label">
            @Html.LabelFor(model => model.CategoryTypeID, "CategoryType")
        </div>
        <div class="editor-field">
            @Html.DropDownListFor(model => model.CategoryTypeID,
            new SelectList(ViewBag.CategoryTypes as System.Collections.IEnumerable, "CategoryTypeID", "Name"),
          "--select Category Type --", new { id = "categoryType" })
            @Html.ValidationMessageFor(model => model.CategoryTypeID)
        </div> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-10-24T15:19:20.460

我遇到了这个错误。我正在绑定视图模型的对象：

```
editPanelViewModel.Panel = new SelectList(panels, "PanelId", "PanelName"); 
```

在视图中，我创建了这样的 ListBox：

```
@Html.ListBoxFor(m => m.Panel, new SelectList(Model.Panel, "PanelId", "PanelName")) 
```

其实应该是这样的：

```
@Html.ListBoxFor(m => m.Panel, new SelectList(Model.Panel, "Value", "Text")) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-29T08:42:27.747

您`SelectList`在控制器和视图中定义了两次。

保持视野干净。在您的情况下，以下内容就足够了： `@Html.DropDownListFor(model => model.CategoryTypeID, (SelectList)ViewBag.CategoryTypes)`

我不得不承认，DropDownListFor 一开始就很混乱:)

# python - PIL 无法创建 PhotoImage 对象

> ID：10252719
> 
> 赞同：0
> 
> 时间：2012-04-20T19:56:03.887
> 
> 标签：python

我在 Fedora 13 上运行了 Python 2.6。我安装了 PIL 1.1.7，并在 Python 提示符中收到安装成功的消息。我可以导入`PIL.PhotoImage`，但是当我尝试运行以下命令时，出现错误。

```
mgobj = PhotoImage(file=imgpath) 
```

堆栈跟踪：

```
Traceback (most recent call last):
File "viewer-tk.py", line 25, in <module>
    imgobj = PhotoImage(file=imgpath)        # now JPEGs work!
File "/home/Toshiba/vinpython/venv/lib/python2.6/site-packages/PIL/ImageTk.py", line 116, in __init__
    self.paste(image)
File "/home/Toshiba/vinpython/venv/lib/python2.6/site-packages/PIL/ImageTk.py", line 181, in paste
    import _imagingtk
ImportError: No module named _imagingtk 
```

在模块`ImageTk.py`中，我看到`_imagingtk`正在导入，但我不确定它是如何获取该模块的。非常感谢您的帮助！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:12:02.740

您需要按照此[trac中的说明安装](https://trac.macports.org/ticket/28265)[Tkinter](http://wiki.python.org/moin/TkInter) python 模块。但是因为它[是 python 发行版的一个组成部分](ftp://ftp.ntua.gr/mirror/python/topics/tkinter/download.html)。由于您使用的是 Fedora，请查看[此页面](http://tkinter.unpythonic.net/wiki/How_to_install_Tkinter)，当 Tkinter 没有出现时，您可以在其中安装它，即使是 Fedora 3，我认为它可能会有所帮助。

# ruby-on-rails - 如何在指定控制器时使用设计路由 sign_up

> ID：10252722
> 
> 赞同：0
> 
> 时间：2012-04-20T19:56:30.650
> 
> 标签：ruby-on-rails, devise

我正在尝试重新路由设计的 sign_up，但也将我自己的视图用于 sign_up 页面。我的 routes.rb 文件中有以下内容：

```
 devise_scope :user do
    get "/signup" => "devise/registrations#new", :as => :new_user_registration
  end
  devise_for :users, :controllers => { :registrations => "registrations"} 
```

但是 sign_up 页面正在使用控制器“设计/注册”并显示 sign_up 的设计视图。如何让它使用“注册”控制器并显示我的视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:35:40.340

为什么不简单地生成设计视图并对其进行自定义？

```
rails generate devise:views 
```

上面的命令将生成设计视图并复制到您的视图文件夹中。

# android - 在eclipse中，多项目的“ctrl+shift+g”快捷方式？

> ID：10252725
> 
> 赞同：0
> 
> 时间：2012-04-20T19:56:49.103
> 
> 标签：android, eclipse, ide

我在eclipse中有多个android项目，当我阅读源代码时，我想知道一个类的所有参考，但Ctrl + Shift + G只是同一个项目中的搜索结果。即使我单击右侧菜单--参考--工作空间。

# php - 订购包含儿童的类别名称的最佳方式

> ID：10252728
> 
> 赞同：1
> 
> 时间：2012-04-20T19:57:05.060
> 
> 标签：php, mysql, sorting

假设我在表中有以下结构：

```
+-------------+----------------+-----------+
| category_id | name           | parent_id |
+-------------+----------------+-----------+
|           1 | foo            |         0 |
|           2 | bar            |         0 |
|           3 | baz            |         1 |
|           4 | test           |         2 |
|           5 | test1          |         3 |
|           6 | test2          |         5 |
+-------------+----------------+-----------+ 
```

有没有人有任何指针来实现以下输出：

```
foo
bar
foo > baz
bar > test
baz > test1
baz > test 1 > test2 
```

如果有帮助，我愿意更改我的架构，但不确定这是否是存储数据的最佳方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:02:00.190

您可以尝试按父级排序，然后按名称排序：

`SELECT * FROM category ORDER BY parent_id, name`

这将根据其级别（父级）返回按名称排序的所有类别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:04:26.043

[嵌套集模型](http://en.wikipedia.org/wiki/Nested_set_model)的实现比简单的父子关系要复杂一些，但它有助于解决此类问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:06:57.560

也许你想看看[嵌套集](http://en.wikipedia.org/wiki/Nested_set_model)

# asp.net-mvc - 如何调试 Visual Studio 2010 错误？

> ID：10252736
> 
> 赞同：0
> 
> 时间：2012-04-20T19:57:35.447
> 
> 标签：asp.net-mvc, visual-studio-2010, asp.net-mvc-3

我正在使用 VS2010，当我创建一个新的 MVC 3 项目时出现错误。我得到的错误是“方法或操作未实现”。现在，当我在安全模式下启动 VS2010 时，我可以创建一个新项目而不会出现此错误。

那么，我怎样才能找出导致问题的原因？我试图卸载扩展管理器中的所有扩展，但这没有帮助。

在安全模式下还有什么没有加载？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T23:57:55.147

当您在安全模式下启动 VS 时，您将停用所有 3rd 方模块。我倾向于**猜测**您的一个插件导致了这个问题。

# c# - C# 二次方程求解器有问题

> ID：10252740
> 
> 赞同：2
> 
> 时间：2012-04-20T19:58:02.583
> 
> 标签：c#, rounding

我刚刚编写了我的第一个 C# 程序。

这是一个解决二次方程的简单代码。

它可以完美地与某些功能（例如 -6x2-6x+12）配合使用，而与其他功能（4x2-20x+25）配合使用时，它会表现出我怀疑的舍入误差。

我对 C# 完全陌生，我看不到任何问题；有人可以帮我调试这段代码吗？

```
namespace ConsoleApplication {
    class Program {
        static int ObtainInput(string prompt, bool canBeZero) {
            double a = ObtainInput("A? ", false);
            double b = ObtainInput("B? ", true);
            double c = ObtainInput("C? ", true);
            double d, x1, x2;

            while (true) {
                Console.Write(prompt);
                string input = Console.ReadLine();
                int result;
                bool success = int.TryParse(input, out result);
                if (success && (canBeZero || result != 0))
                    return result;
                Console.WriteLine("Invalid input!");
            }

            // Calculating a discriminant
            d = b * b - 4 * a * c;

            if (d == 0) {
                x1 = -b / (2 * a);
                Console.WriteLine("The only solution is x={0}.", x1);
                Console.ReadLine();
            }

            // If d < 0, no real solutions exist
            else if (d < 0) { 
                Console.WriteLine("There are no real solutions");
                Console.ReadLine();
            }

            // If d > 0, there are two real solutions 
            else {
                x1 = (-b - Math.Sqrt(d)) / (2 * a);
                x2 = (-b + Math.Sqrt(d)) / (2 * a);
                Console.WriteLine("x1={0} and x2={1}.", x1, x2);
                Console.ReadLine();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-20T20:26:22.223

> 我刚刚编写了我的第一个 C# 程序。

惊人的。现在是不要养成坏习惯的好时机：

```
entA: Console.Write("a?");   
try { a = Convert.ToInt32(Console.ReadLine()); }
catch 
{ /*If a=0, the equation isn't quadratic*/
  Console.WriteLine("Invalid input"); 
  goto entA;             
} 
```

问题比比皆是。首先，使用`int.TryParse`，而不是在可能失败的东西周围放置 try-catch。

其次，注释与代码的动作不匹配。代码判断结果是否为整数；评论说它检查为零。

第三，当你试图表示的是一个循环时，不要使用 goto。

第四，看看所有重复的代码！您将相同的代码重复了三遍，但有细微的变化。

让自己成为一个辅助方法：

```
 static int ObtainInput(string prompt, bool canBeZero)
 {
     while(true) // loop forever!
     {
         Console.Write(prompt);
         string input = Console.ReadLine();
         int result;
         bool success = int.TryParse(input, out result);
         if (success && (canBeZero || result != 0))
             return result;
         Console.WriteLine("Invalid input!");
     }
 } 
```

现在你的主线是：

```
int a = ObtainInput("A? ", false);
int b = ObtainInput("B? ", true);
int c = ObtainInput("C? ", true); 
```

你的错误虽然在这里：

```
x1 = x2 = -b / (2 * a); 
```

您在*整数*中进行算术运算，*然后*转换为双精度数。也就是说，您进行除法，四舍五入到最接近的整数，然后转换为双精度。从一开始就用双打（或者，不太可能，用小数）。它应该是：

```
double a = ObtainInput("A? ", false);
double b = ObtainInput("B? ", true);
double c = ObtainInput("C? ", true); 
```

也就是说，a、b 和 c 不应该是整数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T20:01:35.633

分配给 x1 和 x2 时，您正在进行整数除法；（您只需将 2 更改为 2.0 即可将其更改为双除法并获得双倍结果）

将 a、b、c 和 d 值更改为双倍也可能有意义，这也将解决问题，并允许人们为系数输入非整数值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T20:02:38.873

整数a，b，c；诠释d;

首先，尝试使用 double 而不是 int，因为 1/3 = 0 使用整数。

# zend-framework - Zend Layout Double Div

> ID：10252743
> 
> 赞同：0
> 
> 时间：2012-04-20T19:58:19.817
> 
> 标签：zend-framework, zend-layout

嗨，我想将两个 div 放在 zend 视图中。在我想让两个 div 处于不同的位置之后。我的问题是我想拥有正常的内容和我想添加另一个显示侧边菜单的 div 例如我的视图是：

```
<div id="view-menuscritte"> 
List menu   
</div>
<div id="view-content">
<?php
    echo $this->errorMessage;
    echo $this->form;
?>
</div> 
```

当我在我的布局中使用

```
<div id="menu"> 
    <img id="menusopra" src=<?php echo $this->baseUrl().'/img/menusopra.jpg'; ?> >
    <div id="menuscrittegenerale">
        <?php echo $this->layout()->menuscritte; ?>
    </div>  
    <img id="menusotto" src=<?php echo $this->baseUrl().'/img/menusotto.jpg'; ?> 
</div>  

<div id="contentgenerale">
<?php echo $this->layout()->content; ?>
</div> 
```

问题是两个 div（->content 和 ->menuscritte）在同一个 div 中。view-menuscritte 不在 menuscrittegenerale 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T04:40:58.973

在 layout.phtml 的文件夹中，创建 menu.phtml 将视图中的以下内容剪切并粘贴到 menu.phtml

```
<div id="view-menuscritte"> 
List menu   
</div> 
```

现在在你的 layout.phtml 中替换

```
 <?php echo $this->layout()->menuscritte; ?> 
```

和

```
<?php echo $this->partial('menu.phtml);?> 
```

# javascript - $.ajax and $.getJSON for json and jsonp fail to properly get response from 3rd party server

> ID：10252748
> 
> 赞同：2
> 
> 时间：2012-04-20T19:58:37.300
> 
> 标签：javascript, jquery, json, jsonp

As the title says I'm attempting to retrieve a json from an api given by the site. I've tried a variety of things now and have gotten varied results. I want to be able to retrieve and parse the json to get the information that I want out of it. Here's what I've tried:

1) $.ajax() Code chunk (runs when a button is clicked):

```
 $.ajax({
            type: 'GET',
            url: url,
            dataType: 'json',
            success: function(data) {
                alert('Success!');
            }
        }); 
```

This produces a "Origin null is not allowed by Access-Control-Allow-Origin." error and does not get a response from the server (for Chrome or FF, I don't care about IE since this is a small project for my use). [Looking around](https://stackoverflow.com/questions/6396623/jquery-getjson-access-control-allow-origin-issue) I thought the problem might be that I need it to be a jsonp dataType since I am trying to connect to an outside website. This lead me to try #2

2) $.ajax with jsonp dataType

```
$.ajax({
        type: 'GET',
        url: url,
        dataType: 'jsonp',
        success: function(data) {
            alert('Success!');
        }
    }); 
```

I also appended "&callback=?" to the end of "url" that I give to the function. Using Chrom's Dev Tool I can see a response from the server this time but the alert never displays. I used JSONLINT to confirm that the response was a proper json (it is) and I've tried setting the json to a variable so I can play with it (along the lines of initializing a variable earlier in the script tag [var response;] and trying to assign the json to it[response = data;]). This produced undefined when I tried to alert(response); later on (I don't believe the response=json; bit ever got called for some reason).

I've also tried using $.getJSON but looking at the api for it it apparently just runs $.ajax anyway (I luckily got the same responses/errors when trying json vs jsonp for $.getJSON as I did when trying $.ajax). When I try as a jsonp Chrome (FF doesn't produce this error) shows a "Unexpected Syntax Error: Unexpected token :". [This](https://stackoverflow.com/questions/3143698/uncaught-syntaxerror-unexpected-token) makes me think that the site I'm trying to talk to doesn't have jsonp working and I can't access the third party site as just a json request. The link talks about how setting the server to return as application/json rather than text/html, like I get from my response, fixed the problem for them (but again, I'm trying to access a third party site and thus I can't access the server).

I've tried this in Chrome and FF and looked at Dev Tools/Firebug for each and seen the same thing (though FF doesn't produce the origin error, but that's apparently a bug with Chrome anyway).

Also: I've taken the json response returned and run $.parseJSON on it and been able to grab various pieces but how can I access the json once I get $.ajax/$.getJSON working?

Any thoughts/solutions would be greatly appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:07:34.673

试试 JSONP 插件。它是我推荐的为数不多的插件之一，只是因为它很轻并且可以做它应该做的事情。它还允许您检查成功以外的响应。非常适合 JSONP，并解决了我在使用子域时遇到的一个问题，并且没有得到正确的错误响应（随后只是停止了代码）。

[在这里得到它](http://code.google.com/p/jquery-jsonp/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:01:56.157

我也曾经遇到过`Unexpected Syntax Error: Unexpected token :`错误。

该网站似乎不支持跨域加载。您要使用什么 API？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:02:09.147

响应很可能是有效的 JSON，但不是有效的 JSONP。第三方服务器必须支持 JSONP 才能获得 JSONP 响应。如果您无法控制第 3 方服务器，则唯一真正的选择是使用服务器端代理或 YQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T20:02:37.493

不要将 JQuery AJAX 用于 JSONP。

使用`<script type='text/javascript' src=' URL_GOES_HERE&callback=BLAH '></script>`which 将使用 javascript 方法调用围绕 json 对象，然后您可以使用来自 3rd 方源的数据。

[http://en.wikipedia.org/wiki/JSONP](http://en.wikipedia.org/wiki/JSONP)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-30T04:02:45.400

你试过这种方式吗？

```
$.getJSON( url + "?callback=?", function(data) {
    console.info(JSON.stringify(data, null, 2));
}); 
```

这基本上就是我如何管理我的 JSONP 回调到[http://freegeoip.net/json/](http://freegeoip.net/json/)

# javascript - KnockoutJS 从可观察数组中删除项目。item是ul中的listitem，由foreach生成

> ID：10252749
> 
> 赞同：13
> 
> 时间：2012-04-20T19:58:51.553
> 
> 标签：javascript, knockout.js

使用 KnockoutJS，如何从可观察数组中删除项目？我希望能够单击列表项，然后从数组（以及列表）中删除该项目。

下面的代码示例报告：“this.expertise 未定义”。

我是否需要定义某种专业知识对象，然后从那里调用它？

```
<ul data-bind="foreach: expertise">
    <li data-bind="text: Key, click: $parent.removeExpertise"></li>
</ul>

<script type="text/javascript">
    $(function () {
        function AppViewModel() {

            this.removeExpertise = function (expertise) {
                this.expertise.remove(expertise);

            };

            this.expertise = ko.observable([
                { Key: 'Charles', Value: 'Charlesforth' },
                { Key: 'Denise', Value: 'Dentiste' }
            ]);
        }

        // Activates knockout.js
        jQuery(document).ready(function () {
            ko.applyBindings(new AppViewModel());
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-20T20:25:53.343

当您从子级调用方法时，`this`将设置为子级而不是`$parent`.

有很多方法可以确保`removeExpertise`调用`this`. 一个简单的方法是使用`.bind`.

它看起来像：

```
this.removeExpertise = function (expertise) {
    this.expertise.remove(expertise);
}.bind(this); 
```

Also, you will want `expertise` to be an `observableArray` rather than an `observable`, as an `observableArray` exposes array manipulation methods including a `remove` function.

# java - 在 JUnit、AppEngine 中设置相对文件路径的根目录

> ID：10252753
> 
> 赞同：0
> 
> 时间：2012-04-20T19:59:12.747
> 
> 标签：java, google-app-engine, junit

我有一些引用文件名的代码。在服务器上，这个引用是相对于我的`war`目录的。但是，当我运行测试时，似乎没有设置相对根目录 - 只有从本地 HD 的根目录开始的绝对路径才能真正找到文件。

我正在 AppEngine 的上下文中进行测试`LocalServiceTestHelper`，它在其`getAppDir`方法中返回我的 war 目录，但代码仍然无法理解相对路径。

如何在 JUnit 测试中设置相对文件名的根？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T13:54:01.430

有多种选择。在任何情况下，我都会将文件访问（或至少文件路径解析）封装在一个单独的类中。这样，您可以：

*   在您的测试中模拟该类以提供正确的文件（路径）
*   将环境变量传递给您的测试类以解析正确的文件（路径）
*   如果找不到文件，则提供后备实现（就像您的测试中的情况一样）
*   ETC...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:31:13.430

对于我的单元测试，我创建了一个名为[SupportFilePathResolver](http://pastebin.com/kvyjbstY)的实用程序类（参见代码）。它通过在类路径中查找文件。如果您关心的文件在类路径中，这会很好地工作。如果不在类路径中，那么这对您没有帮助。

# objective-c - 调用 objc_msgSend 后如何继续

> ID：10252754
> 
> 赞同：1
> 
> 时间：2012-04-20T19:59:21.333
> 
> 标签：objective-c, metaprogramming, objective-c-runtime

我正在使用 Objective-C 进行元编程，并尝试自动化一些应用程序功能。因此，我没有更改应用程序的源代码文件和视图控制器，而是从另一个文件中获取 UI 导航堆栈，并且我正在使用[Objective-C 运行时参考](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)来查找可点击的 UI 元素和操作。例如对于一个按钮，我找到了目标和操作并调用 objc_msgSend 以编程方式触发事件。

step = (NSObject *)objc_msgSend(element.target, NSSelectorFromString(element.action));

但是，我需要在操作完成时收到通知，或者换句话说，我需要等到操作完成，然后继续我的自动化。我正在考虑使用 NSNotificationCenter

//引发事件 [[NSNotificationCenter defaultCenter] postNotificationName:FIRE_EVENT_NOTIFICATION object:self];

但看起来不像工作。

我什至在考虑使用[类别](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)或所以我不确定是否有任何等待 objc_msgSend 以及我应该在哪里继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T05:51:54.383

目前尚不完全清楚您要做什么以及您遇到的确切问题，但我会尝试回答您的问题。

如果我理解正确，您正在尝试触发与 UI 元素相关的操作，大概是按下按钮之类的操作。你有一个对元素的引用，`element`并且你想`action`在元素上调用关联`target`。以下假设操作是`IBAction`.

最简单的方法可能是：

```
[element.target performSelector:element.action]; 
```

**注意：** `element.action`几乎可以肯定返回 a `SEL`(a selector) 而不是 an`NSString`所以没有必要通过`NSSelectorFromString()`.

通常，一个`IBAction`事件会接收点击元素作为参数，所以我认为你可能想要这样做：

```
[element.target performSelector:element.action withObject:element]; 
```

`IBAction`' 没有返回值，因此当方法返回时没有任何内容可存储。

`performSelector:`并且`performSelector:withObject:`只有在被调用的方法运行完成后才会返回。您不需要组织某种动作完成通知。

**但是**，如果您正在调用的操作是在另一个线程上启动代码，那么被调用的操作可能会在按下按钮的结果完成之前返回。如果不了解正在运行的代码，这将很难监控。

如果由于某种原因，您*必须*使用，`objc_msgSend`那么您将使用以下内容：

```
objc_msgSend(element.target, element.action, element); 
```

Like `performSelector:`,`objc_msgSend`只会在被调用的方法运行完成时返回。

希望我已经理解了您的问题并且我的回答是有道理的，但是我完全有可能在吠叫错误的树。

# android - android格式edittext每4个字符后显示空格

> ID：10252757
> 
> 赞同：19
> 
> 时间：2012-04-20T19:59:32.353
> 
> 标签：android, android-edittext

Android - 我想从用户那里得到一个数字输入到 EditText - 它需要用空格分隔 - 每 4 个字符。示例：123456781234 -> 1234 5678 1234

这仅用于视觉目的。但是我需要没有空格的字符串以供进一步使用。

我能做到这一点的最简单方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-05-01T16:17:15.677

这是信用卡的编辑文本吗？
首先创建计数变量

```
int count = 0; 
```

然后把它放在你的 oncreate(activity) / onviewcreated(fragment)

```
ccEditText.addTextChangedListener(new TextWatcher() {
    @Override
    public void beforeTextChanged(CharSequence s, int start,
                                  int count, int after) { /*Empty*/}

    @Override
    public void onTextChanged(CharSequence s, int start, int before,
                              int count) { /*Empty*/ }

    @Override
    public void afterTextChanged(Editable s) {

        int inputlength = ccEditText.getText().toString().length();

        if (count <= inputlength && inputlength == 4 ||
                inputlength == 9 || inputlength == 14)){

            ccEditText.setText(ccEditText.getText().toString() + " ");

            int pos = ccEditText.getText().length();
            ccEditText.setSelection(pos);

        } else if (count >= inputlength && (inputlength == 4 ||
                inputlength == 9 || inputlength == 14)) {
            ccEditText.setText(ccEditText.getText().toString()
                    .substring(0, ccEditText.getText()
                            .toString().length() - 1));

            int pos = ccEditText.getText().length();
            ccEditText.setSelection(pos);
        }
        count = ccEditText.getText().toString().length();
    }
}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-20T20:09:10.367

正如@waqas 指出的那样，如果您的目标是在用户键入数字时实现这一点，则需要使用 TextWatcher。这是实现空间的一种潜在方法：

```
StringBuilder s;
s = new StringBuilder(yourTxtView.getText().toString());

for(int i = 4; i < s.length(); i += 5){
    s.insert(i, " ");
}
yourTxtView.setText(s.toString()); 
```

每当您需要获取不带空格的字符串时，请执行以下操作：

```
String str = yourTxtView.getText().toString().replace(" ", ""); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2021-03-29T14:31:57.457

有一种更简单的方法可以实现这一点：

```
editText.doAfterTextChanged { text ->
    val formattedText = text.toString().replace(" ", "").chunked(4).joinToString(" ")
    if (formattedText != text.toString()) {
        editText.setText(formattedText)
    }
} 
```

当您想获得没有空格的文本时，只需执行以下操作：

```
editText.text.toString().replace(" ","") 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-20T20:01:23.483

您需要使用[TextWatcher](http://developer.android.com/reference/android/text/TextWatcher.html)来实现视觉目的空间。

并使用任何*按空间逻辑简单拆分的字符串*将其加入或循环遍历每个字符的整个字符串并`(char) 32`从字符串中消除

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-09-13T16:33:59.603

我创建了一个封装给定行为的类。

```
/**
 * Custom [TextWatcher] class that appends a given [separator] for every [interval].
 */
abstract class SeparatorTextWatcher(
    private val separator: Char,
    private val interval: Int
) : TextWatcher {

    private var dirty = false
    private var isDelete = false

    override fun afterTextChanged(editable: Editable?) {
        if (dirty) return

        dirty = true
        val text = editable.toString().handleSeparator()
        onAfterTextChanged(text)
        dirty = false
    }

    override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) {
        // Empty
    }

    override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) {
        isDelete = before != 0
    }

    private fun String.handleSeparator(): String {
        val stringBuilder = StringBuilder(this)

        if (length > 0 && length.rem(interval + 1) == 0) {
            if (isDelete) {
                stringBuilder.deleteCharAt(length - 1)
            } else {
                stringBuilder.insert(length - 1, separator)
            }
        }

        return stringBuilder.toString()
    }

    /**
     * Subclasses must implement this method to get the formatted text.
     */
    abstract fun onAfterTextChanged(text: String)
} 
```

这是有关如何使用它的片段：

```
editText.addTextChangedListener(object : SeparatorTextWatcher(' ', 4) {
            override fun onAfterTextChanged(text: String) {
                editText.run {
                    setText(text)
                    setSelection(text.length)
                }
            }
        }) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-07-13T15:17:32.150

我在这里搜索了很多是 kotlin 中用于卡的完整代码

```
 yourEditText.addTextChangedListener(object : TextWatcher {
        private val TOTAL_SYMBOLS = 19 // size of pattern 0000-0000-0000-0000
        private val TOTAL_DIGITS = 16 // max numbers of digits in pattern: 0000 x 4
        private val DIVIDER_MODULO =
            5 // means divider position is every 5th symbol beginning with 1
        private val DIVIDER_POSITION =
            DIVIDER_MODULO - 1 // means divider position is every 4th symbol beginning with 0
        private val DIVIDER = ' '
        override fun beforeTextChanged(
            s: CharSequence,
            start: Int,
            count: Int,
            after: Int
        ) { // noop
        }

        override fun onTextChanged(
            s: CharSequence,
            start: Int,
            before: Int,
            count: Int
        ) { // noop
        }

        override fun afterTextChanged(s: Editable) {
            if (!isInputCorrect(s, TOTAL_SYMBOLS, DIVIDER_MODULO, DIVIDER)) {

                var repl = buildCorrectString(
                        getDigitArray(s, TOTAL_DIGITS),
                DIVIDER_POSITION,
                DIVIDER
                )

                yourEditText.clearFocus();
                yourEditText.setText(repl);
               yourEditText.requestFocus();
                yourEditText.setSelection(repl!!.length);

            }
        }

        private fun isInputCorrect(
            s: Editable,
            totalSymbols: Int,
            dividerModulo: Int,
            divider: Char
        ): Boolean {
            var isCorrect =
                s.length <= totalSymbols // check size of entered string
            for (i in 0 until s.length) { // check that every element is right
                isCorrect = if (i > 0 && (i + 1) % dividerModulo == 0) {
                    isCorrect and (divider == s[i])
                } else {
                    isCorrect and Character.isDigit(s[i])
                }
            }
            return isCorrect
        }

        private fun buildCorrectString(
            digits: CharArray,
            dividerPosition: Int,
            divider: Char
        ): String? {
            val formatted = StringBuilder()
            for (i in digits.indices) {
                if (digits[i] != '\u0000') {
                    formatted.append(digits[i])
                    if (i > 0 && i < digits.size - 1 && (i + 1) % dividerPosition == 0) {
                        formatted.append(divider)
                    }
                }
            }
            return formatted.toString()
        }

        private fun getDigitArray(s: Editable, size: Int): CharArray {
          val digits = CharArray(size)
            var index = 0
            var i = 0
            while (i < s.length && index < size) {
                val current = s[i]
                if (Character.isDigit(current)) {
                    digits[index] = current
                    index++
                }
                i++
            }
            return digits
        }
    })
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-07-13T09:21:14.963

文本格式为 000 000 0000

[android edittext textwatcher 格式电话号码，如 xxx-xxx-xx-xx](https://stackoverflow.com/questions/40036794/android-edittext-textwatcher-format-phone-number-like-xxx-xxx-xx-xx)

```
public class PhoneNumberTextWatcher implements TextWatcher {

private static final String TAG = PhoneNumberTextWatcher.class
        .getSimpleName();
private EditText edTxt;
private boolean isDelete;

public PhoneNumberTextWatcher(EditText edTxtPhone) {
    this.edTxt = edTxtPhone;
    edTxt.setOnKeyListener(new View.OnKeyListener() {

        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            if (keyCode == KeyEvent.KEYCODE_DEL) {
                isDelete = true;
            }
            return false;
        }
    });
}

public void onTextChanged(CharSequence s, int start, int before, int count) {
}

public void beforeTextChanged(CharSequence s, int start, int count,
                              int after) {
}

public void afterTextChanged(Editable s) {

    if (isDelete) {
        isDelete = false;
        return;
    }
    String val = s.toString();
    String a = "";
    String b = "";
    String c = "";
    if (val != null && val.length() > 0) {
        val = val.replace(" ", "");
        if (val.length() >= 3) {
            a = val.substring(0, 3);
        } else if (val.length() < 3) {
            a = val.substring(0, val.length());
        }
        if (val.length() >= 6) {
            b = val.substring(3, 6);
            c = val.substring(6, val.length());
        } else if (val.length() > 3 && val.length() < 6) {
            b = val.substring(3, val.length());
        }
        StringBuffer stringBuffer = new StringBuffer();
        if (a != null && a.length() > 0) {
            stringBuffer.append(a);
            if (a.length() == 3) {
                stringBuffer.append(" ");
            }
        }
        if (b != null && b.length() > 0) {
            stringBuffer.append(b);
            if (b.length() == 3) {
                stringBuffer.append(" ");
            }
        }
        if (c != null && c.length() > 0) {
            stringBuffer.append(c);
        }
        edTxt.removeTextChangedListener(this);
        edTxt.setText(stringBuffer.toString());
        edTxt.setSelection(edTxt.getText().toString().length());
        edTxt.addTextChangedListener(this);
    } else {
        edTxt.removeTextChangedListener(this);
        edTxt.setText("");
        edTxt.addTextChangedListener(this);
    }

}
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-22T23:36:46.523

遵循 DRY 原则的@Ario 答案的更清洁版本：

```
private int prevCount = 0;
private boolean isAtSpaceDelimiter(int currCount) {
    return currCount == 4 || currCount == 9 || currCount == 14;
}

private boolean shouldIncrementOrDecrement(int currCount, boolean shouldIncrement) {
    if (shouldIncrement) {
        return prevCount <= currCount && isAtSpaceDelimiter(currCount);
    } else {
        return prevCount > currCount && isAtSpaceDelimiter(currCount);
    }
}

private void appendOrStrip(String field, boolean shouldAppend) {
    StringBuilder sb = new StringBuilder(field);
    if (shouldAppend) {
        sb.append(" ");
    } else {
        sb.setLength(sb.length() - 1);
    }
    cardNumber.setText(sb.toString());
    cardNumber.setSelection(sb.length());
}

ccEditText.addTextChangedListener(new TextWatcher() { 
    @Override 
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {

    } 

    @Override 
    public void onTextChanged(CharSequence s, int start, int before, int count) {

    } 

    @Override 
    public void afterTextChanged(Editable s) {
        String field = editable.toString();
        int currCount = field.length();

        if (shouldIncrementOrDecrement(currCount, true)){
            appendOrStrip(field, true);
        } else if (shouldIncrementOrDecrement(currCount, false)) {
            appendOrStrip(field, false);
        }
        prevCount = cardNumber.getText().toString().length(); 
    } 
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-25T13:53:45.510

这是一个小帮助功能。对于您的示例，您可以使用

`addPadding(" ", "123456781234", 4);`

```
/**
 * @brief Insert arbitrary string at regular interval into another string 
 * 
 * @param t String to insert every 'num' characters
 * @param s String to format
 * @param num Group size
 * @return
 */
private String addPadding(String t, String s, int num) {
    StringBuilder retVal;

    if (null == s || 0 >= num) {
        throw new IllegalArgumentException("Don't be silly");
    }

    if (s.length() <= num) {
        //String to small, do nothing
        return s;
    }

    retVal = new StringBuilder(s);

    for(int i = retVal.length(); i > 0; i -= num){
        retVal.insert(i, t);
    }
    return retVal.toString();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-22T16:19:07.837

如果有人仍在寻找答案，请检查[格式编辑文本](https://github.com/gowthamraj07/Android-Widgets/blob/master/libraries/formatedittext/README.md)库

```
public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final FormatEditText editText1 = findViewById(R.id.edit_text_1);
        editText1.setFormat("---- ---- ---- ----");
    }
} 
```

参考 [https://stackoverflow.com/a/59742478/1679946](https://stackoverflow.com/a/59742478/1679946)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-14T07:14:22.943

如果您使用数据绑定添加

```
android:afterTextChanged="@{handler::afterTextChanged}" 
```

在 EditText 和 afterTextChanged 函数中如下：

```
fun afterTextChanged(s: Editable) {
    if (s.length > 0 && s.length % 5 === 0) {
        val c: Char = s.get(s.length - 1)
        if (space === c) {
            s.delete(s.length - 1, s.length)
        }
    }
    // Insert char where needed.
    if (s.length > 0 && s.length % 5 === 0) {
        val c: Char = s.get(s.length - 1)
        // Only if its a digit where there should be a space we insert a space
        if (Character.isDigit(c) && TextUtils.split(
                s.toString(),
                space.toString()
            ).size <= 3
        ) {
            s.insert(s.length - 1, space.toString())
        }
    }
} 
```

像这样添加空间

```
 private val space: Char = ' ' 
```

如果您使用 inputType="numberDigit" 这将禁用 '-' 和 ' ' 字符，所以我建议使用 inputType="phone"

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-09T05:12:44.807

在打字时更改实时文本有些困难。我们应该处理以下问题。

一个。光标位置 b. 我们应该允许用户删除输入的文本。

以下代码处理这两个问题。

1.  将 TextWatcher 添加到 EditText，并从“afterTextchanged()”获取文本并编写您的逻辑

    字符串 str=""; int strOldlen=0;

    ```
     @Override
                public void afterTextChanged(Editable s) {

       str = edtAadharNumber.getText().toString();
                    int strLen = str.length();

                    if(strOldlen<strLen) {

                        if (strLen > 0) {
                            if (strLen == 4 || strLen == 9) {

                                str=str+" ";

                                edtAadharNumber.setText(str);
                                edtAadharNumber.setSelection(edtAadharNumber.getText().length());

                            }else{

                                if(strLen==5){
                                    if(!str.contains(" ")){
                                     String tempStr=str.substring(0,strLen-1);
                                        tempStr +=" "+str.substring(strLen-1,strLen);
                                        edtAadharNumber.setText(tempStr);
                                        edtAadharNumber.setSelection(edtAadharNumber.getText().length());
                                    }
                                }
                                if(strLen==10){
                                    if(str.lastIndexOf(" ")!=9){
                                        String tempStr=str.substring(0,strLen-1);
                                        tempStr +=" "+str.substring(strLen-1,strLen);
                                        edtAadharNumber.setText(tempStr);
                                        edtAadharNumber.setSelection(edtAadharNumber.getText().length());
                                    }
                                }
                                strOldlen = strLen;
                            }
                        }else{
                            return;
                        }

                    }else{
                        strOldlen = strLen;

                        Log.i("MainActivity ","keyDel is Pressed ::: strLen : "+strLen+"\n old Str Len : "+strOldlen);
                    }

                }
    } 
    ```

2.  在这里，我尝试为每四个字符添加空间。添加第一个空格后，文本的长度为 5。所以下一个空格是在 9 个字符之后。

    如果 (strLen== 4||strLen==9)

    3.  这里的另一个问题是光标位置，一旦你修改了edittext的文本，光标就会移动到第一位。所以我们需要手动设置光标。

    edtAadharNumber.setSelection(edtAadharNumber.getText().length());

    4.  我的文本长度只有 12 个字符。所以我在做手动计算，如果你的文本是动态的，那么你编写动态逻辑。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2019-02-18T12:09:58.587

简单的答案

```
 YourEditText.addTextChangedListener(new TextWatcher() {
        @Override
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {

        }

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {

            int len=s.toString().length();

            if (before == 0 && (len == 4 || len == 9 || len == 14 ))
                YourEditText.append(" ");
        }

        @Override
        public void afterTextChanged(Editable s) {

        }
    }); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2017-10-31T15:49:24.590

假设您知道字符串的最终长度，您可以这样实现`TextWatcher`：

```
override fun setUp(view: View?) {

    editText.addTextChangedListener(object : TextWatcher{
        override fun beforeTextChanged(p0: CharSequence?, p1: Int, p2: Int, p3: Int) {
        }

        override fun onTextChanged(p0: CharSequence, p1: Int, p2: Int, p3: Int) {
            if(p2 == 0 && (p0.length == 4 || p0.length == 9 || p0.length == 14))
                editText.append(" ")
        }

        override fun afterTextChanged(p0: Editable?) {
        }
    }) 
```

您只需在每个 4 位数字块中添加一个空格。`p2 == 0`是为了保证用户不会删除，否则他/她会得到库存。

代码在 Kotlin 中，您可以在 Java 中以完全相同的方式进行操作。

# linux - 无法通过 squid3 访问 https 站点

> ID：10252763
> 
> 赞同：0
> 
> 时间：2012-04-20T19:59:50.830
> 
> 标签：linux, caching, https, proxy, squid

我正在尝试通过 Ubuntu 服务器上的 squid 代理 3.1.14 访问 https 站点，但我不知道为什么我不能。这是我的 squid -v 输出：

```
Squid Cache: Version 3.1.14
configure options:  '--build=i686-linux-gnu' '--prefix=/usr' '--includedir=${prefix}/include'      '--mandir=${prefix}/share/man' '--infodir=${prefix}/share/info' '--sysconfdir=/etc' '--localstatedir=/var' '--libexecdir=${prefix}/lib/squid3' '--srcdir=.' '--disable-maintainer-mode' '--disable-dependency-tracking' '--disable-silent-rules' '--datadir=/usr/share/squid3' '--sysconfdir=/etc/squid3' '--mandir=/usr/share/man' '--with-cppunit-basedir=/usr' '--enable-inline' '--enable-ssl' '--enable-async-io=8' '--enable-storeio=ufs,aufs,diskd' '--enable-removal-policies=lru,heap' '--enable-delay-pools' '--enable-cache-digests' '--enable-underscores' '--enable-icap-client' '--enable-follow-x-forwarded-for' '--enable-auth=basic,digest,ntlm,negotiate' '--enable-basic-auth-helpers=LDAP,MSNT,NCSA,PAM,SASL,SMB,YP,DB,POP3,getpwnam,squid_radius_auth,multi-domain-NTLM' '--enable-ntlm-auth-helpers=smb_lm,' '--enable-digest-auth-helpers=ldap,password' '--enable-negotiate-auth-helpers=squid_kerb_auth' '--enable-external-acl-helpers=ip_user,ldap_group,session,unix_group,wbinfo_group' '--enable-arp-acl' '--enable-esi' '--enable-zph-qos' '--disable-translation' '--with-logdir=/var/log/squid3' '--with-pidfile=/var/run/squid3.pid' '--with-filedescriptors=65536' '--with-large-files' '--with-default-user=proxy' '--enable-linux-netfilter' 'build_alias=i686-linux-gnu' 'CFLAGS=-g -O2 -g -O2 -Wall' 'LDFLAGS=-Wl,-Bsymbolic-functions' 'CPPFLAGS=' 'CXXFLAGS=-g -O2 -g -O2 -Wall' --with-squid=/etc/squid3/squid3-3.1.14 
```

这是我的 squid.conf：

```
 http_port 3124

 cache_mem 256 MB

 maximum_object_size_in_memory 10 MB
 maximum_object_size  100 MB
 minimum_object_size 0 KB
 cache_swap_low 90
 cache_swap_high 95

 cache_dir diskd /cache/squid1 5000 16 256
 cache_dir diskd /cache/squid2 5000 16 256
 cache_dir diskd /cache/squid3 5000 16 256
 cache_dir diskd /cache/squid4 5000 16 256
 cache_dir diskd /cache/squid5 5000 16 256
 cache_dir diskd /cache/squid6 5000 16 256
 cache_dir diskd /cache/squid7 5000 16 256

 access_log /var/log/squid3/access.log squid

 cache_peer x.x.x.x parent 3124 0 no-query login=PASS default no-digest
 memory_replacement_policy lru
 cache_replacement_policy lru
 cache_store_log /var/log/squid3/store.log
 emulate_httpd_log on
 cache_log /var/log/squid3/cache.log
 debug_options ALL,2
 coredump_dir /var/spool/squid3
 minimum_expiry_time 120 seconds
 cache_mgr nutel.rn@dprf.gov.br
 cache_effective_user squid
 cache_effective_group squid
 cachemgr_passwd 1234567890 all

 refresh_pattern -i ([^.]+.|)jre-6u31-linux-i586\.bin 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i exe$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i com$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i br$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i [0-9]+$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i AutoDL?BundleId=59620$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i htm$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i php$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i html$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i asp$ 1440 50% 9999 override-expire ignore-no-cache ignore-no-store ignore-private
 refresh_pattern -i zip$ 0 50% 999999 ignore-reload override-lastmod override-expire reload-into-ims
 refresh_pattern -i \.(mp3|mp4|m4a|ogg|mov|avi|wmv)$ 10080 90% 999999 ignore-no-cache override-expire ignore-private
 refresh_pattern -i flv$ 0 50% 999999 ignore-reload override-lastmod override-expire reload-into-ims
 refresh_pattern -i swf$ 0 50% 999999 ignore-reload override-lastmod override-expire reload-into-ims
 refresh_pattern -i cab$ 0 50% 999999 ignore-reload override-lastmod override-expire reload-into-ims
 refresh_pattern -i rar$ 0 50% 999999 ignore-reload override-lastmod override-expire reload-into-ims
 refresh_pattern ^http:// 30 40% 20160
 refresh_pattern ^ftp:// 30 50% 20160
 refresh_pattern ^gopher:// 30 40% 20160
 refresh_pattern . 1440 100% 1440 ignore-reload override-lastmod override-expire reload-into-ims

 acl manager proto cache_object
 acl localhost src 127.0.0.1/32

 acl SSL_ports port 443 563
 acl cacic_ports port 20 21 22 3306  # cacic
 acl Safe_ports port 80 23       # http
 acl Safe_ports port 21          # ftp
 acl Safe_ports port 443 563     # https, snews
 acl Safe_ports port 70          # gopher
 acl Safe_ports port 210         # wais
 acl Safe_ports port 1025-65535  # unregistered ports
 acl Safe_ports port 280         # http-mgmt
 acl Safe_ports port 488         # gss-http
 acl Safe_ports port 591         # filemaker
 acl Safe_ports port 777         # multiling http

 acl purge method PURGE
 acl CONNECT method CONNECT

 http_access allow manager localhost
 http_access deny manager
 http_access allow purge localhost
 http_access deny purge
 http_access deny !Safe_ports
 http_access deny CONNECT !SSL_ports

 #Cache videos youtube
 acl youtube dstdomain .youtube.com
 cache allow youtube

 # Aqui você irá definir o IP da sua rede interna
 acl redelocal src x.x.x.x/24
 cache allow redelocal
 http_access allow redelocal
 http_access allow localhost
 http_access deny all 
```

我尝试访问 gmail、facebook、....，任何使用 https 的网站都无法打开，但任何其他不使用 https 的网站都可以完美打开。

我究竟做错了什么？

谢谢您的帮助！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-13T06:57:52.003

每个在 Ubuntu 上玩过 Squid 的人都可能遇到过这个问题；。

Ubuntu Squid 软件包已在没有 SSL 选项的情况下编译。因此，无法在 Ubuntu 服务器上使用 Squid 代理 HTTPS 连接。

[参考这个](http://www.mydlp.com/now-squid3-ssl-packages-in-mydlp-repository/)

# jsf - 添加 PrimeFaces 通知栏使我的代码停止工作

> ID：10252764
> 
> 赞同：0
> 
> 时间：2012-04-20T19:59:59.100
> 
> 标签：jsf, datatable, primefaces, ejb

我对 PrimeFaces 的 NotificationBar 有一个奇怪的问题。

我的代码正在运行，但是添加 NotificationBar 会使其以一种奇怪的方式运行！

我在 DataTable 中显示来自会话 Bean 的数据。一切都很好，但是，一旦我添加了这个 NotificationBar，数据表就会变成空并且没有内容被获取：/

这是一些代码：

```
<!-- NOTIFICATION BAR headerMain.xhtml -->
    <h:form>
        <pou:poll autoStart="#{loginBean.logged}" global="false" interval="5" oncomplete="notificationBar.toggle()" update=":notificationBar"/>
    </h:form>

    <pou:notificationBar effect="slide" id="notificationBar" rendered="#{messagesBean.checkDaNotificare()}" widgetVar="notificationBar">                            
        <h:outputLink value="./faces/messaggi.xhtml">                                        
            <h:outputText value="Hai 1 messaggio da leggere" rendered="#{messagesBean.daNotificare==1}"/>
            <h:outputText value="Hai #{messagesBean.daNotificare} messaggi da leggere" rendered="#{messagesBean.daNotificare > 1}"/>
        </h:outputLink> 
    </pou:notificationBar> 
```

_

```
<!-- DATATABLE IN messaggi.xhtml -->
<pou:dataTable editable="false" id="conversationList" resizableColumns="false" rowKey="#{conversazione}" selection="#{messagesBean.destinatario}" selectionMode="single" value="#{messagesBean.listaConversazioni}" var="conversazione" widgetVar="conversationList" paginator="true" paginatorPosition="bottom" rows="20">
                        <pou:ajax event="rowSelect" oncomplete="conversationDialog.show()" update=":conversationDialog, :menuPanel"/>
                        <pou:column>
                            <f:facet name="header">
                                <div style="padding-left: 45%">
                                    <h:outputText value="Conversazioni"/>                                                                                                                            
                                    <h:form>
                                        <pou:commandButton value="+" onclick="newMessageDialog.show()" style="margin-left: 67%"/>
                                    </h:form>
                                </div>
                            </f:facet>
                            <h:outputText value="#{conversazione.username}"/>
                        </pou:column>
                    </pou:dataTable> 
```

_

```
//Method used by NotificationBar to see if it has to be rendered
public boolean checkDaNotificare() {
    System.err.println(daNotificare);
    daNotificare = 0; //Riazzero, quelli precedenti li avrò già notificati
    for (Messaggio m : getMessaggiDaLeggere()) {
        System.err.println("Controllo " + m);
        if (!messaggiNotificati.contains(m)) { //Conto i messaggi da notificare, che sono quelli da leggere meno quelli già notificati
            System.err.println("___Non l'avevo ancora notificato!");
            daNotificare++;
            messaggiNotificati.add(m);
        }
    }
    return (daNotificare > 0);
} 
```

_

```
//Method used by the datatable to fetch data
public List<Utente> getListaConversazioni() {
    listaConversazioni = messageManager.getUtentiConversazioni(utente);
    return listaConversazioni;
}

/**
 * PostConstruct method to initialize things
 */
@PostConstruct
public void init() {
    listaConversazioni = messageManager.getUtentiConversazioni(utente);
    messaggiNotificati = new LinkedList<>();
} 
```

我用意大利语留下了代码，因为它很简单，因为它没有做任何“特别”的事情。

我究竟做错了什么？我几乎尝试了一切，但没有成功:(

提前致谢！

编辑：我尝试将通知栏的代码移动到另一个页面，一切正常......事情变得很奇怪；/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-31T20:11:33.930

StepTNT...我相信您需要在数据表中指定filteredValue。通常你在 filtersValue 中设置一个新的 ArrayList() 实例，但最近我遇到了这个问题，它对我使用 filtersValue 没有任何实例。

# javascript - 使用 Javascript 克隆表；但是一些值在克隆后不再起作用

> ID：10252765
> 
> 赞同：0
> 
> 时间：2012-04-20T20:00:00.980
> 
> 标签：javascript, php, jquery, html-table, clone

我有一个名为模板的表和另一个名为附件的克隆表。我在获取调用输入字段`episodes_airdate`以显示通过在模板表中使用 Javascript 提供的相同信息时遇到问题。

这是模板表的 html：

```
<table id="template" style="display: none;" cellpadding="0px 20px" cellspacing="0px 20px">
    <tbody><tr class="line">
        <td width="100%">

        <p>
        <label>Season:</label>
              <select name="episode_season[]" select="" id="episode_season[]" class="season regular-text" style="width:50px; float:left; margin-right:10px;"><option value="">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option></select>        </p>

        <label>Episode:</label>
        <p>
              <select name="episode_number[]" select="" id="episode_number[]" class="number regular-text" style="width:50px; float:left;"><option value="">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option></select>        </p>

        <label>Title:</label>
        <p>
          <input type="text" name="episode_title[]" id="episode_title[]" value="" class="title regular-text" style="width:400px;">
        </p>    

        <label>Airdate</label>
        <p>
                  <script>
        function datepopulate(){
    var day = document.getElementById('airdate_day').value;
    var month = document.getElementById('airdate_month').value;
    var year = document.getElementById('airdate_year').value;
   var completedate = day+'-'+month+'-'+year;
   document.getElementById('episode_airdate[]').value = completedate;
      alert(document.getElementById('episode_airdate[]').value);
   return true;
}

        </script>
    <select id="airdate_year" onchange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;"><option value="">2012</option><option value="1910">1910</option><option value="1911">1911</option><option value="2000">2000</option><option value="2001">2001</option><option value="2002">2002</option><option value="2003">2003</option><option value="2004">2004</option><option value="2005">2005</option><option value="2006">2006</option><option value="2007">2007</option><option value="2008">2008</option><option value="2009">2009</option><option value="2010">2010</option><option value="2011">2011</option><option value="2012">2012</option></select><select id="airdate_month" onchange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;"><option value="">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select><select name="airdate_day" id="airdate_day" onchange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;"><option value="">10</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option></select> 
        <input type="hidden" name="episode_airdate[]" id="episode_airdate[]" class="airdate regular-text" value="--">

        </p>

         <p>
        <label>Plot:</label>
          <textarea name="episode_plot[]" id="episode_plot[]" class="plot regular-text" value="" cols="100%" rows="10" tabindex="4"></textarea>
        </p>
        </td>

        <td width="10%" class="commands">
            <a rel="delete" class="button">-</a> <a rel="add" class="button">+</a>
        </td>
    </tr>
</tbody></table> 
```

这是附件表的 html

```
<table id="attachments" style="border-spacing: 0px 30px;">

<tbody><tr class="line">
        <td width="100%">

        <p>
        <label>Season:</label>
              <select name="episode_season[]" select="" id="episode_season[]" class="season regular-text" style="width:50px; float:left; margin-right:10px;"><option value="">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option></select>        </p>

        <label>Episode:</label>
        <p>
              <select name="episode_number[]" select="" id="episode_number[]" class="number regular-text" style="width:50px; float:left;"><option value="">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option></select>        </p>

        <label>Title:</label>
        <p>
          <input type="text" name="episode_title[]" id="episode_title[]" value="" class="title regular-text" style="width:400px;">
        </p>    

        <label>Airdate</label>
        <p>

    <select id="airdate_year" onchange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;"><option value="">2012</option><option value="2000">2000</option><option value="2001">2001</option><option value="2002">2002</option><option value="2003">2003</option><option value="2004">2004</option><option value="2005">2005</option><option value="2006">2006</option><option value="2007">2007</option><option value="2008">2008</option><option value="2009">2009</option><option value="2010">2010</option><option value="2011">2011</option><option value="2012">2012</option></select><select id="airdate_month" onchange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;"><option value="">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select><select name="airdate_day" id="airdate_day" onchange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;"><option value="">10</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option></select> 
        <input type="hidden" name="episode_airdate[]" id="episode_airdate[]" class="airdate regular-text" value="">

        </p>

         <p>
        <label>Plot:</label>
          <textarea name="episode_plot[]" id="episode_plot[]" class="plot regular-text" value="" cols="100%" rows="10" tabindex="4"></textarea>
        </p>
        </td>

        <td width="10%" class="commands">
             <a rel="add" class="button">+</a>
        </td>
    </tr></tbody></table> 
```

这是一个带有 JavaScript 的模板表，将 3 个选择选项加在一起，称为 airdate_year 、 airdate_month 和 airdate_day 以生成 1 个名为 episode_airdate 的值，女巫是隐藏输入。

```
<table id="template" style="display: none;" cellpadding="0px 20px" cellspacing="0px 20px">
    <tr class="line">
        <td width="100%">

        <p>
        <label><?php _e('Season:'); ?></label>
              <?php

                for($i=1; $i<=50; $i++)
                    $season_nums[]=$i;

                echo '<select name="episode_season[]" select id="episode_season[]" class="season regular-text" style="width:50px; float:left; margin-right:10px;">';
                    echo '<option value="">' . __("0" ) . '</option>';
                    foreach($season_nums as $season_num){
                        $selected = '';
                        echo '<option value="' . $season_num . '" ' . $selected . '>' . $season_num . '</option>';
                    }
                echo '</select>';
                ?>
        </p>

        <label><?php _e('Episode:'); ?></label>
        <p>
              <?php

                for($i=1; $i<=50; $i++)
                    $episode_nums[]=$i;

                echo '<select name="episode_number[]" select id="episode_number[]" class="number regular-text" style="width:50px; float:left;">';
                    echo '<option value="">' . __("0" ) . '</option>';
                    foreach($episode_nums as $episode_num){
                        $selected = '';
                        echo '<option value="' . $episode_num . '" ' . $selected . '>' . $episode_num . '</option>';
                    }
                echo '</select>';
                ?>
        </p>

        <label><?php _e('Title:'); ?></label>
        <p>
          <input type="text" name="episode_title[]" id="episode_title[]" value="" class="title regular-text" style="width:400px;" />
        </p>    

        <label><?php _e('Airdate'); ?></label>
        <p>
                  <script>
        function datepopulate(){
    var day = document.getElementById('airdate_day').value;
    var month = document.getElementById('airdate_month').value;
    var year = document.getElementById('airdate_year').value;
   var completedate = day+'-'+month+'-'+year;
   document.getElementById('episode_airdate[]').value = completedate;
      alert(document.getElementById('episode_airdate[]').value);
   return true;
}

        </script>
    <?php

                for($i=1910; $i<=2012; $i++)
                    $years[]=$i;

                echo '<select id="airdate_year" onChange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;">';
                    echo '<option value="">' . __("2012" ) . '</option>';
                    foreach($years as $year){
                        $selected = '';
                        echo '<option value="' . $year . '" ' . $selected . '>' . $year . '</option>';
                    }
                echo '</select>';

                for($i=1; $i<=12; $i++)
                    $months[]=$i;

                echo '<select id="airdate_month" onChange="javascript:datepopulate();" style="width:50px; float:left; margin-right:10px;">';
                    echo '<option value="">' . __("0" ) . '</option>';
                    foreach($months as $month){
                        $selected = '';
                        echo '<option value="' . $month . '" ' . $selected . '>' . $month . '</option>';
                    }
                echo '</select>';

                for($i=1; $i<=31; $i++)
                    $days[]=$i;

                echo '<select name="airdate_day" id="airdate_day" onChange="javascript:datepopulate();"  style="width:50px; float:left; margin-right:10px;">';
                    echo '<option value="">' . __("10" ) . '</option>';
                    foreach($days as $day){
                        $selected = '';
                        echo '<option value="' . $day . '" ' . $selected . '>' . $day . '</option>';
                    }
                echo '</select>';
                ?> 
        <input type="hidden" name="episode_airdate[]" id="episode_airdate[]"  class="airdate regular-text" value="">

        </p>

         <p>
        <label><?php _e('Plot:'); ?></label>
          <textarea name="episode_plot[]" id="episode_plot[]" class="plot regular-text"value="" cols="100%" rows="10" tabindex="4" ><?php echo $_POST['episode_season'] ?></textarea>
        </p>
        </td>

        <td width="10%" class="commands">
            <a rel="delete" class="button">-</a> <a rel="add" class="button">+</a>
        </td>
    </tr>
</table> 
```

我创建了“附件”表来保存“模板”的克隆值

```
<table id="attachments" style="border-spacing: 0px 30px;">

</table> 
```

然后这是我用来进行克隆并在“附件”表中显示结果的脚本。我认为问题可能出在脚本上，因为如果我使用模板表，它就可以正常工作；但是，在使用此脚本进行克隆后，隐藏的输入字段“episode_airdate”返回空白。所以我不确定我需要在函数“datepopulate”和下面的这个之间修改什么。

```
<script>
(function($)
{
    lines = 0;

    function items_init()
    {
        <?php $episodes = get_post_meta($post->ID, 'episodes', true) ?> 

        <?php if ( empty($episodes) ) : ?>                
        items_add();
        <?php else: ?>

        <?php 
        // Get serialized data
        $episodes = unserialize($episodes);

    // Compare episode numbers  
          function compare_number($a, $b) {
    if ($a['season'] == $b['season']) {
        return $b['number'] - $a['number'];    }

    return strnatcmp($b['season'], $a['season']);
  }

  // Sort by episode number 
  usort($episodes, 'compare_number');

        // Show episodes
        foreach ($episodes as $episode) :
         ?>
        items_add({
            title: '<?php echo base64_decode($episode['title']) ?>', 
            airdate:   '<?php echo $episode['airdate'] ?>',
            season:   '<?php echo $episode['season'] ?>',
            number:   '<?php echo $episode['number'] ?>',
            plot:   '<?php echo base64_decode($episode['plot']) ?>',

        });
        <?php endforeach ?>
        <?php endif ?>

        // Delete the "-" button in first row
        $('#attachments tr:first-child .commands a[rel="delete"]').remove();
    }

    function items_add()
    {
        obj = $('#template tr').clone().appendTo('#attachments');
        lines++;

        if (arguments.length > 0) {
            options = arguments[0];
                var day = document.getElementById('airdate_day').value;
    var month = document.getElementById('airdate_month').value;
    var year = document.getElementById('airdate_year').value;

            $('.title', obj).val( options.title );
            $('.airdate',   obj).val( options.airdate );
            $('.season',   obj).val( options.season );
            $('.number',   obj).val( options.number );
            $('.plot',   obj).val( options.plot );
        }
    }

    $('#attachments').delegate('.commands a', 'click', function()
    {
        var action = $(this).attr('rel');
        var confirm_delete = true;

        // Add action
        if ('add' == action) {
            items_add();
        }

        // Delete action
        if ('delete' == action) {
            // La TR en la tabla
            var oTr = $(this).parent().parent();
            var episode_name = $('.title', oTr).val();
            var episode_airdate = $('.airdate', oTr).val();
            var episode_season = $('.season', oTr).val();
            var episode_number  = $('.number', oTr).val();
            var episode_plot  = $('.plot', oTr).val();

            if (episode_name != '' || episode_number != '' || episode_plot != '') {
                if ( !confirm('Are you sure you want to delete ' + episode_name + '?') ) {
                    confirm_delete = false;
                }
            }

            if (confirm_delete) {
                oTr.next().remove(); oTr.remove();
                lines--;
            }
        }
    });

    $(document).ready(function()
    {
        items_init();
    });

})(jQuery);

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:29:59.870

你需要做..

```
newObj = $('#something tr').clone(true, true);
// For cloning events and data, as well as deep copying 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:43:06.390

`datepopulate()`? 如果是，您只相信它不起作用。由于您在执行 document.getElementById 时获得了多个具有相同 id 的项目，因此它返回找到的第一个项目（id 应该是唯一的，顺便说一句），它们是模板中的项目。

尝试：

```
function datepopulate(){
    var parent = $(this).parent();
    var day = document.getElementById('airdate_day').value;
    var month = document.getElementById('airdate_month').value;
    var year = document.getElementById('airdate_year').value;
    var completedate = day+'-'+month+'-'+year;
    $('episode_airdate[]', parent)[0].value = completedate;
    alert($('episode_airdate[]', parent)[0].value);
    return true;
} 
```

# python - Python/numpy：获取值列表的数组位置

> ID：10252766
> 
> 赞同：3
> 
> 时间：2012-04-20T20:00:14.070
> 
> 标签：python, numpy, scipy

假设我有一个值数组，`nameArr = ['josh','is','a','person']`并且我想要一个类似`arrayLocation(nameArr,['a','is'])`return的函数`[2 1]`。

该功能是否已经存在，如果不存在，我如何有效地实现它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:10:00.867

使用 numpy.where

```
In [17]: nameArr = np.array(['josh','is','a','person'])

In [18]: [np.where(nameArr==i) for i in ['a','is']]
Out[18]: [(array([2]),), (array([1]),)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T20:02:32.840

列表有一个[`index`](http://docs.python.org/tutorial/datastructures.html)可以使用的方法。

```
>>> nameArr = ['josh','is','a','person']
>>> # Using map
>>> map(nameArr.index, ['a', 'is'])
[2, 1]
>>> # Using list comprehensions
>>> [nameArr.index(x) for x in ['a', 'is']]
[2, 1] 
```

顺便说一句，如果元素不在列表中，则`index`引发。`ValueError`因此，如果您想将不在列表中的元素提供给 index 方法，您可能需要适当地处理错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-21T14:00:22.047

如果数组很大，并且多次定位，您可以创建一个字典，首先将值映射到它的索引：

```
d = dict(zip(nameArr, range(len(nameArr))))
items = ['a','is']
print [d.get(x, None) for x in items] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-29T19:14:57.160

就像是：

```
>>> f_idxs = np.ravel([np.where(master_data==i)[0] for i in search_list]) 
```

# tomcat - 将 OSGi 嵌入 servlet 容器或 OSGi 中的 servlet 容器？

> ID：10252768
> 
> 赞同：7
> 
> 时间：2012-04-20T20:00:23.373
> 
> 标签：tomcat, servlets, osgi, equinox

我需要在 servlet 中重用最初为 Eclipse RCP 应用程序开发的代码（即装箱为 Eclipse 插件/OSGi 包）。

在阅读了很多博客文章、文章、wiki 等之后，我最终知道了这一点：

1.  OSGi 框架（在我的例子中是 Equinox）可以嵌入到 servlet 容器中（在我的例子中是 Tomcat 7）
2.  或者 Tomcat 可以嵌入到 OSGi 框架中。

[Equinox](http://www.eclipse.org/equinox/server/http_quickstart.php)建议使用第二个选项，因为它更容易。但是对于生产，他们推荐 1。我不确定为什么。在哪种情况下真正更好的是什么，为什么？

我是一个经验丰富的 Tomcat 用户，将 Tomcat 嵌入 Equinox 会改变对它的大量管理吗？或者换句话说，嵌入在 Equinox 中的 Tomcat 会有什么不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T16:15:44.120

我们一直在将使用 Jetty 的相当复杂的 Web 应用程序从非 OSGi 迁移到 Equinox 上的 OSGi。我已经了解了一些肯定会以某种方式推动您做出决定的事情： - 如果您选择使用 OSGi 作为框架来运行您的应用程序，例如选项 #2，那么您的应用程序使用的所有内容都必须是 OSGi 捆绑包。商业图书馆的任何外部或第三方。如果您使用大量开源软件，很容易找到捆绑软件。或者，如果您找不到捆绑包，您可以随时使用 BNDTools 自己捆绑它们。尽管如此，这种方法可能会耗费大量时间来找出所有正确的依赖关系，并且可能的类加载器问题需要围绕 OSGi 进行破解 - 将 OSGi 嵌入到 Tomcat 中的方法，从表面上看，这似乎是更安全、更容易的方法。虽然我'

顺便说一句，WAB 的一个有趣的好处是您可以轻松地在 WebApp 之间共享代码，因为它们被部署为包，您可以简单地在它们之间导出/导入包。对于今天的非 OSGi 部署来说，这是不可能的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-23T05:20:48.590

首先，除了清单之外，代码是否有任何 OSGi/Equinox 依赖项？如果不是，它应该在普通的 Tomcat 中工作得很好。

我的理解是，将 Tomcat 嵌入 Equinox 将大大改变对它的管理。您的文件夹布局（包括 server.xml 和 catalina.sh）将消失。相反，您可能会通过配置管理员来管理 Equinox 应用程序。

其次，OSGi 有两种 servlet 编程和部署模型。第一个是 HttpService，您可以在其中以编程方式注册您的 servlet 和资源（您也可以通过扩展点执行此操作）。在这种情况下，您的应用程序只是捆绑包的集合。但是，您不能使用过滤器。第二个是 Web 应用程序包 (WAB)，它是一个 OSGified WAR。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-23T07:36:48.853

Apache Sling 的[maven-launchpad-plugin](http://sling.apache.org/site/maven-launchpad-plugin.html)可以生成嵌入 OSGi 框架的 war 文件（Apache Felix 作为标准，不确定是否支持其他框架）和您定义的一组捆绑包。可用于在 Tomcat 中运行 OSGi 应用程序。

# arrays - 用于查找数组中最小值的分治算法

> ID：10252769
> 
> 赞同：2
> 
> 时间：2012-04-20T20:00:25.550
> 
> 标签：arrays, algorithm, divide-and-conquer

某个有序类型的元素数组 a[1..n]（即 x < y 总是被定义），我想使用“分而治之”算法找到数组中的最小值。

任务的真正含义是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T20:03:33.273

分而治之是一种算法技术，它通过将问题分解成更小的部分来解决问题，在每个部分中解决问题，然后将结果组合在一起形成一个整体的答案。当问题变得足够简单时，可以直接解决。

在这种情况下，想想如果将数组分成两半会发生什么。如果你知道每一半的最小值，你能算出整体的最小值吗？当数组中只剩下一个元素时，数组中的最小值是多少？如果你回答了这个问题，你可以直接为这个问题想出一个递归的分治算法。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:04:56.303

分治策略通过以下方式解决问题：

1.  将其分解为子问题，这些子问题本身就是同一类型问题的较小实例

2.  递归解决这些子问题

3.  适当地结合他们的答案

一个很好的例子是合并排序！

[http://en.wikipedia.org/wiki/Merge_sort](http://en.wikipedia.org/wiki/Merge_sort)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T08:11:51.267

[http://ankzcode.blogspot.in/2012/11/find-minimum-without-linear-search.html](http://ankzcode.blogspot.in/2012/11/find-minimum-without-linear-search.html)

链接处的代码实现相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T05:10:04.280

你可以使用以下算法。

```
getSmallest(int a[])
{
  int n=a.length;
  if(n==1)
    return a[0];
  else
   {
        x=remove first element from a;
        create another array b with a size smaller by 1 than array a
        if(x<getSmallest(b))
            return x;
        else
           return the smallest returned by the recursive call 
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T20:04:20.863

1.  如果数组的内容是随机的，这意味着您必须搜索每个元素，直到找到您要查找的元素。数组越长，搜索时间越长。这称为“[线性搜索](http://en.wikipedia.org/wiki/Linear_search)”。

2.  如果数组的内容已经按某种顺序排列，您可以利用此顺序来优化搜索（并减少搜索时间）。例如，电话簿中的姓名按字母顺序排序。您可以打开中间的电话簿：如果您要查找的名字“低于”中间的名字，则在电话簿的左侧继续搜索。如果它更高，则搜索右半部分。这称为“[二分查找](http://en.wikipedia.org/wiki/Binary_search)”或“分而治之”。

3.  可以量化给定搜索算法的效率或低效率。这称为“[渐近](http://en.wikipedia.org/wiki/O_notation)”或“[大 O 表示法](http://en.wikipedia.org/wiki/O_notation)”：

```

    类搜索算法
    ---------
    数据结构数组
    最坏情况性能 O(log n)
    最佳案例性能 O(1)
    平均案例性能 O(log n)
    最坏情况空间复杂度 O(1)
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T20:05:04.360

一般来说，“分而治之”意味着将一个问题分成更小（通常更简单）的问题，分别解决每个问题，然后以某种方式组合解决方案。

在您的具体示例中，您应该以某种方式将数组分成较小的数组（例如，将其分成两半），在每个较小的数组中找到最小值，然后选择这些子问题的最小解作为整体问题。每个子问题都可以使用相同的分而治之的方法来解决，限制情况是一个足够小的数组（例如，1 或 2），您可以直接解决问题。

# jquery - BBQ 历史插件 - 获取以前的哈希

> ID：10252773
> 
> 赞同：1
> 
> 时间：2012-04-20T20:00:57.557
> 
> 标签：jquery, hash, history

我在这段代码中使用烧烤历史插件：

```
$(window).bind( 'hashchange', function(e) {

    var url = $.param.fragment();           
    var new_page = url.replace('.php', '');

    if (new_page == 'product') {
        var new_page_num = 1;
    } else if (new_page == 'installations') {
        var new_page_num = 2;
    } else if (new_page == 'blog') {
        var new_page_num = 3;
    } else if (new_page == 'contact') {
        var new_page_num = 4;
    }

    if (new_page_num == cur_page_num) {
        return false;
    } else if (new_page_num > cur_page_num) {
        nextPage();
    } else if (new_page_num < cur_page_num) {
        previousPage();
    }

    // Remove class 'current'
    $('a.current').removeClass( 'current' );

    // Add .current class to "current" nav link(s), only if url isn't empty.
    url && $( 'a[href="#' + url + '"]' ).addClass( 'current' );

});

$(window).trigger( 'hashchange' ); 
```

在 'hashchange' 事件上，我想执行此操作：

比较当前 url (cur_page_num) 和下一个 url (new_page_num) 并执行 nextPage() 或 previousPage() 函数。

我可以获得下一个 url (var new_page)。

有谁知道我怎样才能得到我来自的哈希？

（localhost/#hash1 到 localhost/#hash2: hash1 < hash2 所以执行 nextPage();，我怎样才能得到 hash1？）

谢谢！！

# android - 在首选项中获取视图

> ID：10252776
> 
> 赞同：3
> 
> 时间：2012-04-20T20:01:07.040
> 
> 标签：android, android-preferences

单击按钮时，我们会在 onClickListener 方法中获得一个视图。像：

```
Button btn = (Button) this.findViewById(R.id.btn);
            btn.setOnClickListener(new OnClickListener() {
                @Override
            public void onClick(View v) {
                    quickAction.show(v);
            }}); 
```

如果我想将首选项屏幕的视图传递给某个方法，我们如何对首选项执行相同的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:08:08.150

如果您指的是在 PreferenceFragment/PreferenceActivity 中查找首选项，您可以这样做

```
Preference myPreference = findPreference("preference_key");
myPreference.setOnPreferenceClickListener(new OnPreferenceClickListener() {

    @Override
    public boolean onPreferenceClick(Preference preference)
    {

        return false;
    }
}); 
```

您将无法获得传统意义上的思考方式，但您将获得一个 Preference 对象。但是，您可以调用`getView (View convertView, ViewGroup parent)`首选项。

# c - 让 lex 读取 UTF-8 不起作用

> ID：10252777
> 
> 赞同：3
> 
> 时间：2012-04-20T20:01:10.630
> 
> 标签：c, xml, parsing, utf-8, lex

我编写了一个解析 ASCII 文件的 xml 解析器，但我现在需要能够读取 UTF-8 编码的文件。**我在lex**中有以下正则表达式，但它们与 UTF-8 不匹配。我不确定我做错了什么：

```
utf_8       [\x00-\xff]*
bom         [\xEF\xBB\xBF] 
```

然后：

```
bom             { fprintf( stderr, "OMG I SAW A BOM"); return BOM;}
utf_8           { fprintf( stderr, "OMG I SAW A UTF CHAR", yytext[0] ); return UTF_8;} 
```

我还有以下语法规则：

```
program 
: UTF8 '<' '?'ID attribute_list '?''>' 
root ... 
```

哪里`UTF8`是：

UTF8

```
: BOM           {printf("i saw a bom\n");}
| UTF_8         {printf("i saw a utf\n");}
|               {printf("i didn't see anything.'\n");} 
; 
```

它总是出现`i didn't see anything`，我的解析器适用于 ASCII 文件，即当我将 XML UTF-8 文件复制粘贴到一个空文档中时。

任何帮助，将不胜感激。

编辑：

这是一个修剪过的 .l 文件供参考：

```
%{
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "y.tab.h"
int lines = 1;
%}

utf_8       [\x0000-\xffff]*
bom         [\xEF\xBB\xBF]
whitespace  [ \t]
ev          (.|{bom})
ev1         (.|{utf_8})
%%
{whitespace}    { fprintf( stderr, "%s", yytext );}
\n              { fprintf( stderr, "%s%d ", yytext, lines++ );}
.               { fprintf( stderr, "{TOKEN:%c}", yytext[0] ); return yytext[0];}
bom             { fprintf( stderr, "OMG I SAW A BOM"); return BOM;}
utf_8           { fprintf( stderr, "OMG I SAW A UTF CHAR", yytext[0] ); return UTF_8;}
%%

void error( char *message )
{
    fprintf( stderr, "Error: %s\n", message );
    exit(1);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T20:46:00.483

好的，这是你的问题：

```
utf_8       [\x0000-\xffff]*
bom         [\xEF\xBB\xBF] 
```

这里有两个问题。首先，Flex 实际上并不理解 Unicode。它适用于*字节*。因此，您需要一个匹配任何有效 UTF-8*字节序列*的正则表达式宏。[http://keithdevens.com/weblog/archive/2004/Jun/29/UTF-8.regex](http://keithdevens.com/weblog/archive/2004/Jun/29/UTF-8.regex)有一个正则表达式可以做到这一点，转换为 Flex 语法并不难（见下文）。其次，您的 BOM 宏中的方括号使其与值为 EF、BB 或 BF 的任何*单个字节*匹配，而不是您想要的*三字节序列EB BB BF。*

（顺便说一句，UTF-8 文件*不*应该有字节顺序标记，尽管很多都这样做。）

这是一个完整的 Flex 输入文件，它或多或少地完成了您似乎一直在尝试做的事情：

```
%{
#include <stdio.h>
%}

bom     \xEF\xBB\xBF
white   [ \t]

u2a     [\xC2-\xDF][\x80-\xBF]
u2b     \xE0[\xA0-\xBF][\x80-\xBF]
u3a     [\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}
u3b     \xED[\x80-\x9F][\x80-\xBF]
u4a     \xF0[\x90-\xBF][\x80-\xBF]{2}
u4b     [\xF1-\xF3][\x80-\xBF]{3}
u4c     \xF4[\x80-\x8F][\x80-\xBF]{2}

utf_8   {u2a}|{u2b}|{u3a}|{u3b}|{u4a}|{u4b}|{u4c}

%%

{white}     { putchar(' ');  }
\n          { putchar('\n'); }
{bom}       { putchar('B');  }
{utf_8}     { putchar('u');  }
[\x21-\x7e] { putchar('.');  }
.           { putchar('^');  } 
```

# javascript - 序列化 GoogleMapsLatLng 并存储在 cookie 中

> ID：10252778
> 
> 赞同：0
> 
> 时间：2012-04-20T20:01:14.437
> 
> 标签：javascript, google-maps-api-3

我正在尝试将 Google 地图的中心点存储到 cookie 中，并在下次加载页面时将地图恢复到最后一个位置。

当然，我可以将纬度和经度作为字符串或序列化数组或其他东西保存到 cookie 中，但我很好奇我是否可以将 Google Maps LatLng 对象 JSON 序列化到 cookie，然后稍后再恢复它。

我正在使用 JQuery 和这个库：[http ://code.google.com/p/cookies/](http://code.google.com/p/cookies/)

我使用地图中的 LatLng 设置 cookie：

```
$.cookies.set( 'map_center', map.getCenter()); 
```

然后我尝试阅读它，期望序列化/反序列化将恢复我的对象......

```
var centerpointFromCookie = $.cookies.get('map_center);
map.setCenter(centerpointFromCookie); 
```

但似乎没有保留对象类型。在脚本控制台中，这是 LatLng 对象在序列化并存储在 cookie 中之前的样子：

```
map.getCenter()
O
$a: 151.21950000000004
Za: -33.8688
__proto__: O
constructor: function O(a, b, c) {a-=0;b-=0;c||(a=Bd(a,-90,90),b=Cd(b,-180,180));this.Za=a;this.$a=b;}
equals: function (a) {return!a?k:Dd(this.lat(),a.lat())&&Dd(this.lng(),a.lng());}
lat: function () {return this[a];}
lng: function () {return this[a];}
toString: function () {return"("+this.lat()+", "+this.lng()+")";}
toUrlValue: function (a) {a=Hd(a)?a:6;return ae(this.lat(),a)+","+ae(this.lng(),a);}
__proto__: Object 
```

这就是它之后的样子：

```
centerpointFromCookie
Object
$a: 151.21950000000004
Za: -33.8688
__proto__: Object
__defineGetter__: function __defineGetter__() {
__defineSetter__: function __defineSetter__() {
__lookupGetter__: function __lookupGetter__() {
__lookupSetter__: function __lookupSetter__() {
constructor: function Object() {
hasOwnProperty: function hasOwnProperty() {
isPrototypeOf: function isPrototypeOf() {
propertyIsEnumerable: function propertyIsEnumerable() {
toLocaleString: function toLocaleString() {
toString: function toString() {
valueOf: function valueOf() { 
```

反序列化时是否需要将对象转换为 GoogleMapsLatLng 类型？我知道我可以只存储这些值，但我想了解如何正确地将这样的小对象序列化为 cookie。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:22:11.073

只需序列化纬度/经度。

序列化对象的原型或函数属性不能很好地工作，因为它们必须为此进行字符串化，并且当您尝试将字符串转回函数时，您将丢失对原始范围内可见的变量的所有引用，但现在看不到了。*而且*你也不能轻易猜到以后如何手动恢复正确的原型，因为原型随时可能发生变化。*而且*您会将您的对象绑定到特定版本的 LatLng 原型，当 API 更新时，这将不会很有趣。

更不用说序列化这么多数据会比普通的 lat/lng 占用更多的 cookie 空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:24:46.403

`getCenter()`已经为您提供了价值。因此，您可以将其转换为 JSON 字符串，并在您想再次使用它时对其进行解析；

```
var center = JSON.stringify(map.getCenter());
$.cookies.set( 'map_center', center); 
```

当您想从 cookie 中读取数据时；

```
var centerpointFromCookie = $.cookies.get('map_center);
map.setCenter(JSON.parse(centerpointFromCookie)); 
```

# assembly - Tilera 和 SSE 中“缺少”算术指令。操作是如何完成的？

> ID：10252780
> 
> 赞同：3
> 
> 时间：2012-04-20T20:01:20.573
> 
> 标签：assembly, multicore, sse, instruction-set

我浏览了[Tilera 指令集](http://www.tilera.com/scm/docs/UG401-ISA.pdf)，发现它只有加、减、乘、除和移位。没有提到根，权力，日志等。

我还注意到 SSE（所有口味）没有后面提到的说明。

Tilera 和 SSE 都是为基于数学的处理而设计的，例如视频编码，所以这让我很好奇。

在这种情况下（Tilera 和 SSE [不包括常规标量操作]）如何执行这些操作之一？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:21:19.387

为了保持硬件简单，它们通常只实现最常用的最基本和最简单的指令。

最先进的功能不太常用，并且在处理器上占用了大量的硅和芯片空间。三角函数、日志、幂等很难实现且成本高昂。

无论如何，几乎所有特殊功能都分解为基本操作（加/减/乘/除），因此只要您提供这些，您就可以实现任何东西。

如果没有太多的数据相关分支，通常可以对特殊函数进行矢量化。因为您可以简单地采用标量实现并将所有内容替换为 SIMD 版本。

# jquery - jQuery 结合两个函数用于更改

> ID：10252784
> 
> 赞同：2
> 
> 时间：2012-04-20T20:01:28.970
> 
> 标签：jquery

我有 2 个我编写的函数（大部分是修改的），我需要将它们组合成一个函数。第一个函数在用户选择部门时调用，它执行回调以查找日期并将它们添加到数组中。第二个函数在 jQuery 日期选择器中阻止天数。我已经让被封锁的日子正常工作，我只是不知道如何结合这两个功能。我尝试了很多不同的方法，但似乎没有任何效果。

```
// load calendar buttons
$(document).ready(function(){
$("#Return_Date").datepicker( { beforeShowDay: nonWorkingDates, showOn: "both",    numberOfMonths: 2, minDate: 0, maxDate: "364D", gotoCurrent: true, buttonImageOnly: true }   );
$("#Depart_Date").datepicker( { beforeShowDay: nonWorkingDates, showOn: "both", numberOfMonths: 2, minDate: 0, maxDate: "364D", gotoCurrent: true, buttonImageOnly: true    }   );
});

// load blocked days - this loads properly into the date pickers above
function nonWorkingDates(date){
// create an array for closedDates
var closedDates = [[3,22,2012], [3,25,2012], [4,15,2012], [4,24,2012], [4,25,2012]];

//loop through the list of closed Dates
for (i = 0; i < closedDates.length; i++) {      
    // if the date is found set it as disabled. January is 0, February 1, etc so a -1 is needed on the month value
    if (date.getMonth() == closedDates[i][0] - 1 && date.getDate() == closedDates[i][1] &&  date.getFullYear() == closedDates[i][2]) {
        return [false];
    }
}
return [true];
};

//load in closed dates i need the BlockedTravelDays array to pull into the date pickers. the array here loads fine
$(document).ready(function NoTravelDays() {
$("#TripApprovalDepartment").change(function() {
    var value = $.trim($("#TripApprovalDepartment").val());
    if (value.length > 0) {
        $.getJSON("../approval.cfc?method=getBlockedDays&returnFormat=json", {DeptID:value}, function(res,code) {
            // create an Array
            var BlockedTravelDays = [];
            for (var i = 0; i < res.DATA.length; i++) { 
                // store the travel days in the array
                BlockedTravelDays.push(res.DATA[i][2]);
            }; // end for loop
        }); // end JSON
    } // end if
});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:08:07.393

一个简单的解决方案就是从第三个函数调用这两个函数。这没有某些人可能需要的灵活性，但似乎您不需要同样的灵活性。所以，我们会得到这样的东西：

```
$(document).ready(function()
{
    function1();
    function2();
} 
```

看到您已经在使用匿名函数，该函数可以只调用另一个函数，从而为您提供：

```
$(document).ready(function(){
    $("#Return_Date").datepicker( { beforeShowDay: nonWorkingDates, showOn: "both",    numberOfMonths: 2, minDate: 0, maxDate: "364D", gotoCurrent: true, buttonImageOnly: true }   );
    $("#Depart_Date").datepicker( { beforeShowDay: nonWorkingDates, showOn: "both", numberOfMonths: 2, minDate: 0, maxDate: "364D", gotoCurrent: true, buttonImageOnly: true    }   );

    NoTravelDays();
}); 
```

# excel - Excel公式，在其下方的每一行添加标题

> ID：10252788
> 
> 赞同：1
> 
> 时间：2012-04-20T20:01:42.440
> 
> 标签：excel, vba

**所以我得到了这样的东西（全部在A列，单独的行）：**

标题01

atext atext atext atext atext

btext btext btext btext btext

ctext ctext ctext ctext ctext

标题02

atext atext atext atext atext

btext btext btext btext btext

ctext ctext ctext ctext ctext

标题03

atext atext atext atext atext

btext btext btext btext btext

ctext ctext ctext ctext ctext

**我需要解决方案来改变它：**

标题01

Title01 - atext atext atext atext atext

Title01 - btext btext btext btext btext

Title01 - ctext ctext ctext ctext ctext

标题02

Title02 - atext atext atext atext atext

Title02 - btext btext btext btext btext

Title02 - ctext ctext ctext ctext ctext

标题03

Title03 - atext atext atext atext atext

Title03 - btext btext btext btext btext

Title03 - ctext ctext ctext ctext ctext

**基本上 - 为每一列添加前缀（标题）直到下一个标题的一行......有没有什么想法我怎么能完成这个总共有大约 3000 行并且它们在每个标题下的数量不同......

谢谢！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T21:34:53.607

```
Sub Tester()    
    Dim c as Range, ttl as string

    for each c in selection.cells
       if lcase(c.value) like "*titletext*.txt" then
          ttl = c.value
       else
          if len(c.value)>0 and len(ttl)>0 then 
              c.value = ttl & " - " & c.value
          end if
       end if
    next c
End sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T21:47:21.737

*   在单元格`B1`中输入公式`=A1`
*   在单元格`B2`中输入公式`=IF(MID(A2, 1,5)="Title", A2, B1)`
*   将该公式填充到数据的最后一行。
*   在单元格`C1`中输入公式`=IF(MID(A1, 1,5)="Title", A1, B1 & " - " & A1)`
*   填写下来。

现在您在 C 列中得到了您想要的内容。您可以复制，然后粘贴特殊 > 值以摆脱公式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:14:14.430

您不能在一个单元格中创建一个条目，将其自身“推”到其他单元格中。其他单元格必须是引用您的标题的公式。所以你会有类似的东西

```
 A
1   Title01
2   =A1&"atext atext atext atext atext"
3   =A1&"btext btext btext btext btext" 
```

等等。

# css - 在 SpringSource Tool Suite 中，我在哪里可以编辑主题？

> ID：10252795
> 
> 赞同：1
> 
> 时间：2012-04-20T20:02:03.157
> 
> 标签：css, grails, themes, springsource, themeroller

我被要求为一个团队设计一个站点（他们说只有几个小时），但他们正在使用 Grails 和 SpringSource 工具套件。我也不熟悉。

当我查看“正确”源时，主题源文件不存在，但它们得到了服务。如果我在 IDE 中搜索文件，我会在 .path_to_grails_plugin 目录（不在源代码管理中）中找到一些东西。如果我在那里编辑，它会接收我的更改，但这对团队没有帮助......我想指出一个新主题，而不是弄乱原来的主题。Target 目录有*一些*文件，但不是全部，但这不是*生成*的内容所在的位置吗？那么*真正*的来源在哪里？这对我来说就像是黑暗艺术。我显然缺少一些有关其工作原理的基本知识。

我想添加一个自定义主题（theme-roller-generated），所以我在我的 web-app 文件夹中为它创建了一个子文件夹。然后，在我的 config.groovy 文件中，我输入：

> ```
> grails.resources.modules = {
>     core {
>         dependsOn 'jquery-ui'
>     }
>     // Define reference to custom jQuery UI theme
>     overrides {
>         'jquery-theme' {
>              resource id: 'theme', url: '/css/theme-redo/jquery-ui-1.8.19.custom.css'
>         }
>     }
> } 
> ```

那没有任何作用。它仍然服务于旧的 css。帮我找到光！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:40:42.497

CSS 存储在 web-app\css 中，JavaScript 存储在 web-app\js 目录中。 **但是**，我强烈建议在通过反复试验来移动内容之前先阅读一些教程。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T10:08:06.307

我一直遇到同样的问题。我的解决方法是创建另一个资源模块并在其中包含主题。这是一个不完美的解决方案，因为仍然包含原始不需要的主题 css - 但它有效。

ApplicationResources.groovy 包含：

```
modules = {
    application {
        resource url:'js/application.js'
        resource url:'/css/smoothness/jquery-ui-1.8.20.custom.css'
    }
} 
```

my.gsp 包含：

```
<r:require modules="jquery, jquery-ui, application" /> 
```

订购*可能*很重要..

# jquery - 单击单选按钮列表后无法关闭 jquery 对话框？

> ID：10252797
> 
> 赞同：0
> 
> 时间：2012-04-20T20:02:27.807
> 
> 标签：jquery, asp.net

我正在使用 jquery ui 对话框，并且我已经对其进行了设置，以便它具有一个文本框和一个按钮。您基本上在文本框中输入一些内容并单击按钮，它会从数据库中提取一些值并加载单选按钮列表。HTML 标记如下所示：

```
 <div id="dialog" title="Select Address">
        <asp:UpdatePanel ID="upNewUpdatePanel" UpdateMode="Conditional" ChildrenAsTriggers="true" runat="server">
        <ContentTemplate>
            <div id="search" style="width:100%; text-align:center;">
                <asp:TextBox ID="txtFindSearch" runat="server"></asp:TextBox> 
                <asp:Button ID="btnFindSearch" runat="server" Text="Search" 
                    onclick="btnFindSearch_Click" />
                <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
            </div>
            <div id="searchresults" style="width:100%;">
                <asp:RadioButtonList ID="rbSearchResults" runat="server" AutoPostBack="True" 
                    CellSpacing="10" RepeatColumns="4" RepeatDirection="Horizontal" 
                    ToolTip="Select an address." 
                    onselectedindexchanged="rbSearchResults_SelectedIndexChanged">
                </asp:RadioButtonList>
            </div>
        </ContentTemplate>
        </asp:UpdatePanel>
        </div> 
```

在后面的代码中，我可以像这样获得选定的值：

```
 protected void rbSearchResults_SelectedIndexChanged(object sender, EventArgs e)
        {
            Label1.Text = rbSearchResults.SelectedValue.ToString();
        } 
```

我的问题是从单选按钮列表中进行选择后，我不知道如何关闭 jquery 对话框。我试图在 jquery 中做这样的事情：

```
 $('#MainContent_rbSearchResults input').click(function () {
       $('#dialog').hide();
   }); 
```

即使我在那里发出警报，它也不会显示警报。如果我查看页面源代码，我看到了 div 容器，但没有看到单选按钮列表，可能是因为它包含在更新面板中吗？

获得值后如何关闭 jquery ui 对话框（单击单选按钮列表）？

# 编辑

我试过这个：

```
 protected void rbSearchResults_SelectedIndexChanged(object sender, EventArgs e)
        {
            Label1.Text = rbSearchResults.SelectedValue.ToString();
            this.txtShipToName.Text = Label1.Text;
            ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "closedialog", "$(function(){$('#dialog').dialog('close');});", true);
        } 
```

这会关闭对话框，但是我的文本框 txtShipToName 永远不会获得值。即使我单步调试，我也会看到分配给它的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:21:29.347

对于您的第二个问题（编辑部分）--- txtShipName 可能不在正在更新的更新面板中。您可以将 txtShipName 放在 UpdatePanel 中并将其（UpdatePanel）UpdateMode 设置为 UpdateAlways。现在您的对话框工作了——这也应该导致您的文本框更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:14:23.120

`txtShipToName`不在 UpdatePanel 内，这就是为什么它没有保持其值。

要解决此问题，您可以将`txtShipToName`UpdateMode`UpdatePanel`设置为 Conditional，然后将其添加到您的代码中：

```
Label1.Text = rbSearchResults.SelectedValue.ToString();
this.txtShipToName.Text = Label1.Text;
this.theNewUpdatePanel.Update(); //Add this line 
```

**编辑**

正如 ek_ny 在他的回答中所说，对于新的 UpdatePanel，最好将 UpdateMode 设置为 always，然后您就不需要调用`Update()`它了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:09:23.433

尝试使用此代码

```
$("#MainContent_rbSearchResult").on("click", "input", function(){
    $('#dialog').hide();
}); 
```

当您进行 ajax 调用时，您丢失了单击处理程序，因为 html 已被删除并在更新面板中重新生成。使用`[on](http://api.jquery.com/on/)`方法可以解决此问题，因为在 ajax 回发后创建新控件时会重新附加处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T20:14:56.670

也许这个例子会有用 [http://jsfiddle.net/prJu7/](http://jsfiddle.net/prJu7/)

尝试使用

```
$('#dialog').dialog('close') 
```

反而

```
 $('#dialog').hide(); 
```

# google-chrome - onclick window.location.href 在 Chrome 或 Safari 中不起作用

> ID：10252809
> 
> 赞同：7
> 
> 时间：2012-04-20T20:03:31.457
> 
> 标签：google-chrome, onclick

我们有一个下载部分，我们正在尝试跟踪用户何时下载某些内容。下载链接如下：

```
<a href="DOWNLOADURL" onclick="window.location.href='http://analytics.performable.com/v1/event?_n=EVENTID&_a=PORTALID&email=USEREMAIL'">TITLE OF DOWNLOAD</a> 
```

它在 IE 和 FF 中运行良好，但在 Chrome（或任何 webkit 浏览器）或 Safari 中运行良好。我可以没有 Safari，但它会很好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-20T20:11:01.323

试试这个：

```
<a href="DOWNLOADURL" onclick="javascript:window.location.href='http://analytics.performable.com/v1/event _n=EVENTID&_a=PORTALID&email=USEREMAIL'; return false;">TITLE OF DOWNLOAD</a> 
```

# perl - 使用 Perl DBI 获取所有记录

> ID：10252816
> 
> 赞同：5
> 
> 时间：2012-04-20T20:03:57.023
> 
> 标签：perl, dbi

我有一个使用[DBI](https://en.wikipedia.org/wiki/Perl_DBI)连接的 Perl 脚本。我使用子例程打开并读取 SQL 脚本文件。我只打印一条记录，我应该再打印两条（总共三条记录）。如何获取所有记录？

结果：

```
Alert:OUTBOUND_DATA:0 
```

脚本：

```
my $dbh_oracle = DBI->connect(
          $CFG{oracle_dbi_connect},
          $CFG{db_user},
          $CFG{db_cred},
          {AutoCommit => 0,
           RaiseError => 0,
           PrintError => 0}) or die ("Cannot connect to the database: ".$DBI::errstr."\n");

my ($val1, $val2) = get_data();
print "Alert:$val1:$val2\n";

send_email("Alert:$val1:$val2");

sub get_data
{
  undef $/;
  open (my $QFH, "< /sql/summary.sql") or die "error can't open this file $!";
  my $sth= $dbh_oracle->prepare(<$QFH>) or
      die ("Cannot connect to the database: ".$DBI::errstr."\n");
  $sth->execute;
  close $QFH;
  my $row = $sth->fetchrow_hashref;
  $sth->finish;
  return @$row{'MYTABLE','FLAG'};
}

sub send_email {
    my $message = shift;
    open (MAIL, "|/usr/sbin/sendmail -t") or die "Can't open sendmail: $!";
    print MAIL "To: me\@test.com\n";
    print MAIL "From: Data\n";
    print MAIL "\n";
    print MAIL $message;
    close MAIL;
}
exit; 
```

运行查询的结果：（超过 1 个记录）

```
MYTABLE                  FLAG
----------------------- ----------
OUTBOUND_DATA         0
MSGS_BY_DIM                  0
INBOUND_DATA         0

3 rows selected. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T20:16:18.217

您可以通过多种不同的方式从语句句柄中检索数据。最常见的非常简单，它们的使用如下所示：

```
my @row_array = $sth->fetchrow_array;
my $array_ref = $sth->fetchrow_arrayref;
my $hash_ref  = $sth->fetchrow_hashref; 
```

第一个 fetchrow_array 将依次将每一行作为数组返回。使用从上述选择返回的数据的示例可能是：

```
while (my @row_array = $sth->fetchrow_array) {
    print $row_array[0], " is ", $row_array[1], " years old, and has a " , 
          $row_array[2], "\n";
} 
```

第二个示例类似，但返回的是数组引用而不是数组：

```
while (my $array_ref = $sth->fetchrow_arrayref) {
    print $array_ref->[0], " is ", $array_ref->[1], 
          " years old, and has a " , $array_ref->[2], "\n";
} 
```

第三个示例 fetchrow_hashref 通常是最易读的：

```
while (my $hash_ref = $sth->fetchrow_hashref) {
    print $hash_ref->{name}, " is ", $hash_ref->{age}, 
          " years old, and has a " , $hash_ref->{pet}, "\n";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T20:06:08.310

这一行应该是一个循环：

```
my $row = $sth->fetchrow_hashref; 
```

它应该是：

```
my @rows;
while ( my $row = $sth->fetchrow_hashref ) {
    push @rows, $row;
}
return @rows; 
```

如果您希望 DBI 为您执行循环，请查看[selectall_arrayref](http://search.cpan.org/~timb/DBI-1.618/DBI.pm#selectall_arrayref)或[selectall_hashref](http://search.cpan.org/~timb/DBI-1.618/DBI.pm#selectall_hashref)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T21:34:17.993

它还取决于您如何构建整个脚本。您的`get_data()`调用只允许返回一对值。我至少看到了几个选项：要么返回一个包含所有数据的哈希（引用）并让其`main`组装，要么使用前面提到的循环结构并在子例程中构造消息体，只返回一个标量字符串。

要将所有数据作为哈希引用返回，`get_data`子例程可能如下所示（注意我使用`fetchall_hashref`的是`fetchrow_hashref`：

```
sub get_data
{
  undef $/;
  open (my $QFH, "< /sql/summary.sql") or die "error can't open this file $!";
  my $sth= $dbh_oracle->prepare(<$QFH>) or
      die ("Cannot connect to the database: ".$DBI::errstr."\n");
  $sth->execute;
  close $QFH;
  my $hash_ref = $sth->fetchall_hashref('MYTABLE');
  $sth->finish;
  return $hash_ref;
} 
```

你调用它`main`并使用输出如下：

```
my $hash_ref = get_data();
my $message = "";
foreach my $table (sort keys %$hash_ref) {
    $message .= join(":", "Alert", $table, $$hash_ref{$table}{'FLAG'}) . "\n";
} 
```

这将导致`$message`包含：

```
Alert:INBOUND_DATA:0
Alert:MSGS_BY_DIM:0
Alert:OUTBOUND_DATA:0 
```

你可能想礼貌地：

```
$dbh_oracle->disconnect; 
```

在你退出之前。

这有一些问题，例如，您将 SQL 隐藏在外部脚本中，但我已采用硬编码键（MYTABLE，我假设它在您的查询中是唯一的）和值（FLAG）在脚本，稍后当您想对此进行扩展时会受到限制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-20T22:44:05.257

这些`fetchrow_`方法实际上一次只获取一行。

如果您想要某些列的所有行，则可以低效地推动数据结构，或者使用针对您的情况的调用。

在我看来，您想使用[`selectcol_arrayref`](http://search.cpan.org/perldoc/DBI#selectcol_arrayref)如下：

```
my $ary_ref = $dbh->selectcol_arrayref(
    "select id, name from table",
    { Columns=>[1,2] }
); 
```

列索引指的是结果集中列的位置，而不是原始表。

您使用返回结果的方式也需要更改以处理所有返回的行。

此外，您还有：

```
sub get_data
{
  undef $/; 
```

因为你 slurp 包含 SQL 的文件。但是，`$/`是一个全局变量。您应该`[local](http://perldoc.perl.org/functions/local.html) $/`在尽可能小的范围内使用。所以：

```
my $sql = do { local $/; <$fh> }; 
```

# java - 将日期与 jodatime 进行比较

> ID：10252818
> 
> 赞同：0
> 
> 时间：2012-04-20T20:04:07.043
> 
> 标签：java, datetime, jodatime

我尝试将某个日期与 jodaTime 进行比较，我使用周和年来比较日期

```
DateMidnight endDate01 = new DateMidnight().withYear(2012).withWeekyear(37);
DateMidnight endDate02 = new DateMidnight().withYear(2012).withWeekyear(38);

endDate01.isBefore(endDate02); //return false 
```

我不明白为什么 endDate01 看起来比 endDate02 更大。

也许是一个错误？

```
DateMidnight endDate01 = new DateMidnight();

endDate01.withYearOfEra(o1.getEndYearPeriod());
endDate01.withWeekOfWeekyear(o1.getEndWeekPeriod());

System.out.println(o1.getEndWeekPeriod() + " " + o1.getEndYearPeriod());
System.out.println(endDate01.getWeekOfWeekyear() + " " + endDate01.getYearOfEra()); 
```

我明白了

37 2012

16 2012

应该得到相同的结果，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T11:16:00.670

这两个代码都可以正常工作

```
DateTime dt = new DateTime(); 
dt = dt.withWeekOfWeekyear(29); 
dt = dt.withWeekyear(2011);

DateMidnight dt2 = new DateMidnight().withWeekOfWeekyear(29).withYear(2011); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T11:28:31.303

```
DateTime firstDate = new DateTime();
firstDate.withWeekyear(2012) /* represents the 2012 with number of weeks in it (I thing the algorith is the difference between first week in 1970) */
firstDate.withWeekOfWeekyear(29) /* now you have the 29th week of 2012 */
firstDate.withDayOfWeek(1) /* now you have 29th week of 2012 and Monday */ 
```

现在你设置日期！以这种方式设置第二个并比较它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:10:15.690

`withWeekyear`不一样`withWeekOfWeekyear`。我不是 100% 确定用什么`withWeekyear`代替，我认为如果你的意思是 2012 年的第 37 周，你应该`withWeekOfWeekyear`改用。

# design-patterns - 状态机示例

> ID：10252821
> 
> 赞同：0
> 
> 时间：2012-04-20T20:04:22.127
> 
> 标签：design-patterns, state, state-machine

有人可以说一个在软件（编译器和解析器除外）中使用状态机的好例子吗？有一些非常重要的例子，状态机的使用应该简化软件:-)

我想编写 .NET 应用程序。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:07:50.170

您可以将您看到的每个 UI 视为一个大型状态机。UI 中的每个事件（例如按钮单击、菜单选择等）都会驱动转换到另一个状态，这可能意味着一个新页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T16:15:31.703

显示典型导航路径的网站设计（类似于@duffymo 的答案）。这是一个不完整的示例（灵感来自“应用 UML 和模式”（Craig Larman））：

![在此处输入图像描述](../Images/4f6a7be975e5dc578655c07fb1ba9fa8.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:17:41.900

您的操作系统内核调度程序/调度程序是一个状态机。线程具有状态 - 运行、就绪、睡眠、事件等待、暂停、终止。这些事件是来自 IO 设备驱动程序的硬件中断和来自运行线程的软件中断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-14T21:29:18.493

有关状态机的一些示例（以 Umple 表示），请参见：

运河锁软件： [http ://cruise.eecs.uottawa.ca/umpleonline/?example=CanalLockStateMachine&diagramtype=state](http://cruise.eecs.uottawa.ca/umpleonline/?example=CanalLockStateMachine&diagramtype=state)

电信呼叫处理： [http ://cruise.eecs.uottawa.ca/umpleonline/?example=Phone&diagramtype=state](http://cruise.eecs.uottawa.ca/umpleonline/?example=Phone&diagramtype=state)

车库门软件： [http ://cruise.eecs.uottawa.ca/umpleonline/?example=GarageDoor&diagramtype=state](http://cruise.eecs.uottawa.ca/umpleonline/?example=GarageDoor&diagramtype=state)

在航空公司预订系统中预订： [http ://cruise.eecs.uottawa.ca/umpleonline/?example=Booking&diagramtype=state](http://cruise.eecs.uottawa.ca/umpleonline/?example=Booking&diagramtype=state)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T20:14:23.143

另一种情况是订购。新订单（处于新状态）可以取消或修改，但不能退款。但是，一旦您将其完成状态，就无法取消，但可能会退款。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-17T10:22:29.073

opengl 库是一个状态机。它保持一个状态，该状态根据对库函数的调用而变化。你可以在这里看到它：[http ://www.cs.tufts.edu/research/graphics/resources/OpenGL/OpenGL.htm](http://www.cs.tufts.edu/research/graphics/resources/OpenGL/OpenGL.htm)

可以使用状态机的另一个范围是视频游戏。想象一个相对聪明的敌人。这个敌人将有几种状态：攻击、隐藏、死亡、奔跑等。这可以由状态和事件控制。当我写一个视频游戏作为我的学位项目时，我使用了两个状态机：一个用于游戏流程（演示屏幕、游戏、选项等），另一个用于游戏本身（提问、掷骰子、移动玩家等） )

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-20T20:17:14.793

随机数生成器也可以以某种方式被视为状态机。您有一组输入，例如左移、加常数、乘以常数等。状态是实际的当前随机值。由于此类随机数的计数是有限的，因此可以将其视为某种有限状态机。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-11T15:40:31.563

您可以在 .net 中使用面向方面的编程作为实现示例查看我的通用状态机。

它可以用在需要一些工作流逻辑的软件中，比如审批工作流。

[https://github.com/rcarubbi/carubbi.statemachine](https://github.com/rcarubbi/carubbi.statemachine)

只需像这样创建您的实体：

```
 [InitialState("State1")]
    public class Entity : IStatedEntity
    {

        [Transition(From = "State1", To = "State2")]
        [Transition(From = "State3", To = "State1")]
        public void Method1()
        {
            Trace.WriteLine("Method1");
        }

        [Transition(From = "State2", To = "State1")]
        public string Method2()
        {
            Trace.WriteLine("Method2");
            return string.Empty;
        }

        [Transition(From = "State2", To = "State3")]
        [Transition(From = "State3", To = "State4")]
        public int Method3(int p1, int p2)
        {
            Trace.WriteLine("Method3");
            return p1 + p2;
        }

        public StateMachine StateMachine { get; set; }
   } 
```

并以这种方式使用它：

```
 [TestMethod]
        public void TestMethod1()
        {
            StateMachine.Configure();
            var ent = new Entity
            {
                StateMachine =
                {
                    IgnoreInvalidOperations = true
                }
            };

            ent.StateMachine.TransitionStarted += StateMachine_TransitionStarted;
            ent.StateMachine.TransitionEnded += StateMachine_TransitionEnded;

            Trace.WriteLine(ent.StateMachine.CurrentState);
            ent.Method1();
            Trace.WriteLine(ent.StateMachine.CurrentState);
            ent.Method2();
            Trace.WriteLine(ent.StateMachine.CurrentState);
            ent.Method1();
            Trace.WriteLine(ent.StateMachine.CurrentState);
            var result = ent.Method3(2, 4);
            Trace.WriteLine(ent.StateMachine.CurrentState);
            var result2 = ent.Method3(4, 4);
            Trace.WriteLine(ent.StateMachine.CurrentState);
            var result3 = ent.Method3(4, 4);
            Trace.WriteLine(ent.StateMachine.CurrentState);
        }

        private void StateMachine_TransitionEnded(object sender, TransitionEventArgs e)
        {

        }

        private void StateMachine_TransitionStarted(object sender, TransitionStartedEventArgs e)
        {

        }
   } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-29T22:05:03.590

这是一个基本 FSM 的玩具控制台应用程序示例。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

//  DESC: QAD-FSM (Quick And Dirty Finite State Machine)
//  
//  Notes: In its simplest form a state machine is
//       • A set of states
//       • A set of events
//       • A set of transitions that define 
//           the next state given the current state and event.
//       • A method of tracking current state
// 
//  Example:
// 
//       I want to create a different kind of door lock that
//           has the following states:
//          
//               1\. LBS - Locked_Both_Sides
//               2\. UBS - Unlocked_Both_Sides
//               3\. LFO - Locked_From_Outside
// 
//           and has the following events:
//          
//               1\. OKT - Outside Key Turn
//               2\. IKT - Inside Key Turn
//              
//       Transistions will be as follows:
//      
//       CurrState  Event   NextState   Desc
//       ========================================================
//       LBS            OKT     UBS         When both sides locked, outside key turn unlocks both sides
//       LBS            IKT     LFO         When both sides locked, inside key turn unlocks inside
//       UBS            OKT     LFO         When both sides unlocked, outside key turn locks outside
//       UBS            IKT     LBS         When both sides unlocked, inside key turn locks both sides
//       LFO            OKT     UBS         When only outside locked, outside key turn unlocks outside
//       LFO            IKT     LBS         When only outside locked, inside key turn locks both sides.

namespace FSM
{
    // The FSM states
    enum State
    {
        LBS,
        UBS,
        LFO
    }

    // The FSM events
    enum Event
    {
        IKT,
        OKT
    }

    class Transition
    {
        public State currState { get; set; }
        public Event evnt { get; set; }
        public State nextState { get; set; }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var fsm = new FSM();

            System.Console.WriteLine("Current State: " + fsm.StateDesc[fsm.CurrentState]);

            string input = "";
            while (input != "x")
            {
                System.Console.Write("Enter key turn [IKT, OKT] or x to exit: ");
                input = System.Console.ReadLine();
                if (input == "x") break;
                Event evnt;
                if (!Enum.TryParse(input, out evnt))
                {
                    System.Console.WriteLine("Invalid input: " + input + ", enter one of [IKT,OKT,x]");
                    continue;
                }
                fsm.ChangeState(evnt);
                System.Console.WriteLine("New State: " + fsm.StateDesc[fsm.CurrentState]);
            }

            System.Console.WriteLine("");
            System.Console.WriteLine("History");
            System.Console.WriteLine("===============================================");
            System.Console.WriteLine("CurrState(Event) => NextState");
            System.Console.WriteLine("===============================================");
            fsm.hist
                .Select(h => h.currState.ToString() + "(" + h.evnt.ToString() + ") => " + h.nextState.ToString())
                .ToList()
                .ForEach(h => System.Console.WriteLine(h));
        }
    }

    class FSM
    {
        public Dictionary<State, String> StateDesc = new Dictionary<State, String>()
                                                { 
                                                    {State.LBS, "Both Sides Locked"},
                                                    {State.LFO, "Locked From Outside"},
                                                    {State.UBS, "Both Sides Unlocked"}
                                                };

        public List<Transition> hist = new List<Transition>();

        // Create FSM transitions.
        List<Transition> trans = new List<Transition>
            {
                new Transition() { currState = State.LBS, evnt = Event.OKT, nextState = State.UBS }, 
                new Transition() { currState = State.LBS, evnt = Event.IKT, nextState = State.LFO }, 
                new Transition() { currState = State.UBS, evnt = Event.OKT, nextState = State.LFO }, 
                new Transition() { currState = State.UBS, evnt = Event.IKT, nextState = State.LBS }, 
                new Transition() { currState = State.LFO, evnt = Event.OKT, nextState = State.UBS }, 
                new Transition() { currState = State.LFO, evnt = Event.IKT, nextState = State.LBS }, 
            };

        public State CurrentState { get { var lt = hist.FirstOrDefault(); return lt == null ? State.UBS : lt.nextState; } }

        public State? ChangeState(Event evnt)
        {
            var t = trans.Find(r => r.currState == CurrentState && r.evnt == evnt);
            if (t == null) return null; // If you don't create transitions that cover all combinations this could happen.
            hist.Insert(0, t);
            return t.nextState;
        }
    }
} 
```

# solrj - 将 doc 文件夹中的所有文档索引到 solr FileListEntityProcessor

> ID：10252822
> 
> 赞同：1
> 
> 时间：2012-04-20T20:04:24.677
> 
> 标签：solrj, apache-tika

[http://wiki.apache.org/solr/ExtractingRequestHandler](http://wiki.apache.org/solr/ExtractingRequestHandler)没有提供太多信息，如何在具有自己的上下文并希望将 solr 用作嵌入 solr 的服务器功能的 web 应用程序中配置此处理程序。您能否提供一些有关如何将文档上传到 solr 并从这些文档中搜索某些内容的信息？我在 solrConf.xml 中配置了 DIH

```
<requestHandler name="/dataimport" 
   class="org.apache.solr.handler.dataimport.DataImportHandler">
    <lst name="defaults">
        <str name="config">tika-data-config.xml</str>
    </lst>
  </requestHandler> 
```

和 tika-data-config.xml 看起来像

```
<dataConfig>
    <dataSource type="BinFileDataSource" name="bin" />
    <document>
      <entity name="sd"
        processor="FileListEntityProcessor"
        newerThan="'NOW-30DAYS'"
        filenName=".*\.(DOC)|(PDF)|(pdf)|(doc)|(docx)|(ppt)"
        baseDir="G:/workspace/FacetedSearch/src/solr/docs"
        recursive="true"
        rootEntity="false"
          >
            <field column="fileAbsolutePath" name="path" />
            <field column="fileSize" name="size" />
            <field column="fileLastModified" name="lastmodified" />
            <field column="fileAbsolutePath" name="text" />  
            <!-- <field column="fileName" name="text" /> -->
            <field column="baseDir" name="text" />

        <!-- <entity name="tika-test" processor="TikaEntityProcessor" 
          url="${sd.fileAbsolutePath}" format="text" dataSource="bin">
         -->
         <entity name="tika-test" 
                 dataSource="bin"  
                 processor="TikaEntityProcessor" 
                 url="G:/workspace/FacetedSearch/src/solr/docs" 
                 format="text" >
          <field column="Author" name="author" meta="true"/>
          <field column="Content-Type" name="title" meta="true"/>
          <field column="title" name="title" meta="true"/>
          <field column="text" name="text"/>

        </entity>

    </entity>
  </document>

</dataConfig> 
```

目录 G:/workspace/FacetedSearch/src/solr/docs 包含许多 pdf 和 html 文件，其中一些是 tutorial.pdf......index.pdf

在此配置之后，当我将 solrQuery 对象构建为

```
 CoreContainer.Initializer initializer = new CoreContainer.Initializer();
    CoreContainer coreContainer = initializer.initialize();
    EmbeddedSolrServer solrServer = new EmbeddedSolrServer(coreContainer, "");  
    SolrQuery solrQuery = new SolrQuery();
    solrQuery.addField("literal.id");   
    solrQuery.setQuery("index.pdf");
    QueryResponse queryResponse = null ;
    try{
    queryResponse = (QueryResponse) solrServer.query(solrQuery);
    }catch(Exception e){
    System.out.println("exception occured while processing the solrQuery "+ 
    e.getMessage() +"stack trace " + e + solrQuery.toString()); 
    }
    out.println(queryResponse); 
```

我没有得到任何结果（这里 queryResponse 为空）。我有 solr 3.5 分发的 schema.xml 并添加了一些字段作为

```
<field name="path" type="text_general" indexed="true" stored="true" />   
<field name="lastmodified" type="date" indexed="true" stored="true" /> 
```

我有一个问题，比如“G:/workspace/FacetedSearch/src/solr/docs”中的文档是否会在 solr 启动时被 solr 索引？如果这些被索引，我怎样才能得到结果？

任何人都可以让我知道我在哪里做错了吗？

如果需要我提供更多信息以获取我的答案，请告诉我。

# objective-c - 如何在 MapView 上设置样式叠加

> ID：10252828
> 
> 赞同：0
> 
> 时间：2012-04-20T20:04:49.110
> 
> 标签：objective-c, ios5, mapkit, overlays

图片：（[http://photos.appleinsider.com/iOS5maps002.091111.jpg](http://photos.appleinsider.com/iOS5maps002.091111.jpg)）

所以任何人都可以让我知道..如何将类似的样式应用于我们的叠加层（我的意思是叠加层中的线条）..

提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:13:15.517

你必须[继承 MKOverlayPathView](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKOverlayPathView_class/Reference/Reference.html#//apple_ref/occ/cl/MKOverlayPathView)并定义你自己的绘图行为。

> “如果您子类化，您应该重写 createPath 方法并使用该方法为覆盖构建适当的路径。您可以根据需要使该路径无效，并使用您的子类获得的任何新数据强制重新创建路径。”

# c++ - 指向数组 c++ 的指针

> ID：10252837
> 
> 赞同：23
> 
> 时间：2012-04-20T20:05:17.250
> 
> 标签：c++, arrays, pointers

下面的代码在做什么？

```
int g[] = {9,8};
int (*j) = g; 
```

据我了解，它创建了一个指向 2 个整数数组的指针。但是为什么这会起作用：

```
int x = j[0]; 
```

这不起作用：

```
int x = (*j)[0]; 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-20T20:12:08.900

在您的示例中，括号是多余的。指针不关心是否涉及数组——它只知道它指向一个**int**

```
 int g[] = {9,8};
  int (*j) = g; 
```

也可以改写为

```
 int g[] = {9,8};
  int *j = g; 
```

也可以改写为

```
 int g[] = {9,8};
  int *j = &g[0]; 
```

指向数组的指针看起来像

```
 int g[] = {9,8};
  int (*j)[2] = &g;

  //Dereference 'j' and access array element zero
  int n = (*j)[0]; 
```

在此链接中可以很好地阅读指针声明（以及如何理解它们）：http: [//www.codeproject.com/Articles/7042/How-to-interpret-complex-CC-declarations](http://www.codeproject.com/Articles/7042/How-to-interpret-complex-C-C-declarations)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-04-20T20:41:56.050

```
int g[] = {9,8}; 
```

这声明了一个 int[2] 类型的对象，并将其元素初始化为 {9,8}

```
int (*j) = g; 
```

这声明了一个 int * 类型的对象，并*使用指向 g 的第一个元素的指针对其进行*初始化。

第二个声明用 g 以外的东西初始化 j 的事实很奇怪。C 和 C++ 只是对数组有这些奇怪的规则，这就是其中之一。在这里，表达式`g`从引用对象 g 的左值隐式转换为指向 g`int*`的第一个元素的类型的右值。

这种转换发生在几个地方。事实上，当你这样做时，它就会发生`g[0]`。数组索引运算符实际上不适用于数组，仅适用于指针。因此该语句`int x = j[0];`有效，因为`g[0]`恰好执行了与`j`初始化时相同的隐式转换。

指向数组的指针是这样声明的

```
int (*k)[2]; 
```

你是完全正确的关于如何使用它

```
int x = (*k)[0]; 
```

（注意[“声明遵循使用”](https://stackoverflow.com/a/9637342/365496)，即*声明*类型变量的语法模仿*使用*该类型变量的语法。）

但是，通常不使用指向数组的指针。围绕数组的特殊规则的全部目的是让您可以像使用数组一样使用指向数组元素的指针。所以惯用的 C 通常不关心数组和指针不是一回事，而且规则阻止你直接对数组做很多有用的事情。（例如，您不能复制数组，例如`int g[2] = {1,2}; int h[2]; h = g;`：）

* * *

例子：

```
void foo(int c[10]); // looks like we're taking an array by value.
// Wrong, the parameter type is 'adjusted' to be int*

int bar[3] = {1,2};
foo(bar); // compile error due to wrong types (int[3] vs. int[10])?
// No, compiles fine but you'll probably get undefined behavior at runtime

// if you want type checking, you can pass arrays by reference (or just use std::array):
void foo2(int (&c)[10]); // paramater type isn't 'adjusted'
foo2(bar); // compiler error, cannot convert int[3] to int (&)[10]

int baz()[10]; // returning an array by value?
// No, return types are prohibited from being an array.

int g[2] = {1,2};
int h[2] = g; // initializing the array? No, initializing an array requires {} syntax
h = g; // copying an array? No, assigning to arrays is prohibited 
```

* * *

因为数组与 C 和 C++ 中的其他类型非常不一致，所以您应该避免使用它们。C++`std::array`的一致性要高得多，当您需要静态大小的数组时应该使用它。如果您需要动态大小的数组，您的第一个选择是 std::vector。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-20T20:07:39.283

`j[0];`取消引用指向 的指针`int`，因此其类型为`int`.

`(*j)[0]`没有类型。`*j`取消引用指向 an 的指针`int`，因此它返回 an `int`，并`(*j)[0]`尝试取消引用 an `int`。这就像在尝试`int x = 8; x[0];`。

# gwt - eclipse中的Maven子模块：一个模块中的资源在另一个模块中找不到

> ID：10252845
> 
> 赞同：4
> 
> 时间：2012-04-20T20:06:08.537
> 
> 标签：gwt, maven

我有以下 Maven 项目结构：

```
Example
-Persistence
-GWTApp 
```

持久性在 中具有 persistence.xml `src/main/resources/META-INF`，它在单一测试中运行良好。

我需要在 GWTApp 项目中使用它。因此，我将其添加为依赖项。像这样：

```
<dependency>
    <groupId>com.example</groupId>
    <artifactId>Persistence</artifactId>
    <version>0.0.1</version>
</dependency> 
```

有了这个，我可以在我的 webapp 中查看和使用持久性类，但是，当我在 eclipse 中运行 webproject 时，我得到了这个错误：

> javax.persistence.PersistenceException：没有名为 exemplo 的 EntityManager 的持久性提供程序

我认为这是因为 eclipse 在引用 webapp 项目中的持久性项目的项目之间完成了这个“链接”，而不是使用 jar 文件。也许我错了，这只是一个猜测。

有人知道我该如何解决这个问题？提前致谢。

编辑

我做了更多的测试，现在我认为问题出在 GWT 开发模式和 JPA 或其他问题上。我试图手动将persistence.xml复制到`weapp/META-INF`和复制到`target/project-webapp-0.0.1-SNAPSHOT/META-INF`并且错误仍然存​​在。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:55:54.890

我假设您使用的是 M2E。如果是，请打开 Persistence 项目的“配置构建路径”对话框（右键单击构建路径，然后选择“构建路径”子菜单）。

如果您查看“资源”文件夹，我怀疑您会看到“排除：**”；这可以防止 Eclipse 将文件复制到本地输出目录，也可以防止它们对依赖项目可用。选择该行并单击“删除”

我不知道为什么 M2E 会这样做，而且我知道有禁用它的偏好，但我只是手动执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T01:55:53.793

您是否正确启动了应用程序？[https://developers.google.com/eclipse/docs/faq#gwt_with_maven](https://developers.google.com/eclipse/docs/faq#gwt_with_maven)

特别注意，您必须“mvn war:exploded”复制您的依赖项 target/myapp-0.0.1-SNAPSHOT/WEB-INF/lib

# mysql - WHM MySQL 5.5 升级中缺少 InnoDB？

> ID：10252846
> 
> 赞同：0
> 
> 时间：2012-04-20T20:06:17.933
> 
> 标签：mysql, whm

我正在运行 WHM 11.32.2 并通过 WHM 的官方生产就绪升级将 MySQL 升级到 5.5。

但是，由于某种原因，我无法创建任何 InnoDB 表？它们一直被创建为 MyISAM。此外，在 phpMyAdmin 下，InnoDB 甚至没有从下拉菜单中显示为选项。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T05:40:27.887

1.  打开 etc/my.cnf
2.  搜索“skip-innodb”。注释掉。
3.  重启mysql服务。

# ruby-on-rails - 如何在 Rails 应用程序中显示困难模型视图？

> ID：10252847
> 
> 赞同：0
> 
> 时间：2012-04-20T20:06:19.187
> 
> 标签：ruby-on-rails, model-view-controller, view

我有这样的数据库架构：

```
Tables:
COUNTRY_DESIGNATIONS
DES_TEXTS
MANUFACTURERS
MODELS 
```

以及这样的关系：

```
COUNTRY_DESIGNATIONS has_many MODELS
DES_TEXTS has_many COUNTRY_DESIGNATIONS
MANUFACTURERS has_many MODELS 
```

在 Rails 模型中，所有关系和其他“事物”都被写入。

当我选择制造商时，我会得到它的所有型号。但是现在我想在这些模型中从 COUNTRY_DESIGNATIONS 中选择数据（确保所有表关系 id 必须相等），然后当从 COUNTRY_DESIGNATIONS 中选择数据时，我想从 DES_TEXTS 中获取数据并显示它。

我怎样才能做到这一点？控制器、视图有什么变化？（我使用的是标准脚手架）

现在我有这样的观点来查看制造商的模型：

```
 - @manufacturer.models.each do |model|
    %tr
      %p
        mod_id
        %td= model.MOD_ID
      %p
        MOD_PCON_START
        %td= model.MOD_PCON_START
      %p
        MOD_PCON_END
        %td= model.MOD_PCON_END
      = link_to 'Show model', model 
```

我想添加这样的东西：

```
 - @manufacturer.models.each do |model|
    %tr
      %p
        ...
        %td= model.country_des.des_text.FIELD  - something like this)
      = link_to 'Show model', model 
```

模型文件：

```
class CountryDesignation < ActiveRecord::Base
    set_table_name "COUNTRY_DESIGNATIONS"
    set_primary_key :CDS_ID
    belongs_to :des_text
    belongs_to :language
    has_many :models
end

class DesText < ActiveRecord::Base
    set_table_name "DES_TEXTS"
    set_primary_key :TEX_ID
    has_many :country_designation
    has_many :designation
end

class Model < ActiveRecord::Base
    set_table_name "MODELS"
    set_primary_key :MOD_ID
    belongs_to :manufacturer
    belongs_to :country_designation
    has_many :types
end

dump:
# This file is auto-generated from the current state of the database. Instead
# of editing this file, please use the migrations feature of Active Record to
# incrementally modify your database, and then regenerate this schema definition.
#
# Note that this schema.rb definition is the authoritative source for your
# database schema. If you need to create the application database on another
# system, you should be using db:schema:load, not running all the migrations
# from scratch. The latter is a flawed and unsustainable approach (the more migrations
# you'll amass, the slower it'll run and the greater likelihood for issues).
#
# It's strongly recommended to check this file into your version control system.

ActiveRecord::Schema.define(:version => 20120418164608) do

  create_table "COUNTRY_DESIGNATIONS", :primary_key => "CDS_ID", :force => true do |t|
    t.binary   "CDS_CTM"
    t.integer  "CDS_LNG_ID"
    t.integer  "CDS_TEX_ID"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "DESIGNATIONS", :primary_key => "DES_ID", :force => true do |t|
    t.integer  "DES_LNG_ID"
    t.integer  "DES_TEX_ID"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "DES_TEXTS", :primary_key => "TEX_ID", :force => true do |t|
    t.text     "TEX_TEXT"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "LANGUAGES", :primary_key => "LNG_ID", :force => true do |t|
    t.integer  "LNG_DES_ID"
    t.string   "LNG_ISO2"
    t.string   "LNG_CODEPAGE"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "MANUFACTURERS", :primary_key => "MFA_ID", :force => true do |t|
    t.integer  "MFA_PC_MFC"
    t.integer  "MFA_CV_MFC"
    t.integer  "MFA_AXL_MFC"
    t.integer  "MFA_ENG_MFC"
    t.integer  "MFA_ENG_TYP"
    t.string   "MFA_MFC_CODE"
    t.string   "MFA_BRAND"
    t.integer  "MFA_MF_NR"
    t.binary   "MFA_PC_CTM"
    t.binary   "MFA_CV_CTM"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "MODELS", :primary_key => "MOD_ID", :force => true do |t|
    t.integer  "MOD_MFA_ID"
    t.integer  "MOD_CDS_ID"
    t.integer  "MOD_PCON_START"
    t.integer  "MOD_PCON_END"
    t.integer  "MOD_PC"
    t.integer  "MOD_CV"
    t.integer  "MOD_AXL"
    t.binary   "MOD_PC_CTM"
    t.binary   "MOD_CV_CTM"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "TYPES", :primary_key => "TYP_ID", :force => true do |t|
    t.integer  "TYP_CDS_ID"
    t.integer  "TYP_MMT_CDS_ID"
    t.integer  "TYP_MOD_ID"
    t.binary   "TYP_CTM"
    t.binary   "TYP_LA_CTM"
    t.integer  "TYP_SORT"
    t.integer  "TYP_PCON_START"
    t.integer  "TYP_PCON_END"
    t.integer  "TYP_KW_FROM"
    t.integer  "TYP_KW_UPTO"
    t.integer  "TYP_HP_FROM"
    t.integer  "TYP_HP_UPTO"
    t.integer  "TYP_CCM"
    t.integer  "TYP_CYLINDERS"
    t.integer  "TYP_DOORS"
    t.integer  "TYP_TANK"
    t.integer  "TYP_KV_VOLTAGE_DES_ID"
    t.integer  "TYP_KV_ABS_DES_ID"
    t.integer  "TYP_KV_ASR_DES_ID"
    t.integer  "TYP_KV_ENGINE_DES_ID"
    t.integer  "TYP_KV_BRAKE_TYPE_DES_ID"
    t.integer  "TYP_KV_BRAKE_SYST_DES_ID"
    t.integer  "TYP_KV_FUEL_DES_ID"
    t.integer  "TYP_KV_CATALYST_DES_ID"
    t.integer  "TYP_KV_BODY_DES_ID"
    t.integer  "TYP_KV_STEERING_DES_ID"
    t.integer  "TYP_KV_STEERING_SIDE_DES_ID"
    t.float    "TYP_MAX_WEIGHT"
    t.integer  "TYP_KV_MODEL_DES_ID"
    t.integer  "TYP_KV_AXLE_DES_ID"
    t.integer  "TYP_CCM_TAX"
    t.float    "TYP_LITRES"
    t.integer  "TYP_KV_DRIVE_DES_ID"
    t.integer  "TYP_KV_TRANS_DES_ID"
    t.integer  "TYP_KV_FUEL_SUPPLY_DES_ID"
    t.integer  "TYP_VALVES"
    t.integer  "TYP_RT_EXISTS"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "carts", :force => true do |t|
    t.integer  "customer_id"
    t.integer  "item_id"
    t.integer  "amount"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "credit_cards", :force => true do |t|
    t.integer  "customer_id"
    t.string   "number"
    t.string   "nameOfCard"
    t.date     "expiryDate"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "currencies", :force => true do |t|
    t.float    "currencyvalue"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "customer_sessions", :force => true do |t|
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "customers", :force => true do |t|
    t.string   "username"
    t.string   "crypted_password"
    t.string   "password_salt"
    t.string   "persistence_token"
    t.string   "email"
    t.string   "skype"
    t.integer  "ICQ"
    t.string   "firstname"
    t.string   "lastname"
    t.string   "country"
    t.string   "state"
    t.string   "city"
    t.string   "street"
    t.string   "building"
    t.integer  "room"
    t.string   "addressNote"
    t.string   "dateOfReg"
    t.integer  "custGroup_id"
    t.float    "totalBuy"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "order_statuses", :force => true do |t|
    t.string   "statusname"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "orders", :force => true do |t|
    t.integer  "basket_id"
    t.integer  "customer_id"
    t.integer  "shipping_id"
    t.integer  "paymentmethod_id"
    t.integer  "orderstatus_id"
    t.datetime "dateoforder"
    t.float    "totalcost"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "payment_methods", :force => true do |t|
    t.string   "methodname"
    t.boolean  "allowed"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "sellers", :force => true do |t|
    t.string   "username"
    t.string   "crypted_password"
    t.string   "password_salt"
    t.string   "persistence_token"
    t.string   "email"
    t.string   "skype"
    t.integer  "ICQ"
    t.string   "firstname"
    t.string   "lastname"
    t.string   "dateOfReg"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "shippings", :force => true do |t|
    t.string   "shippingname"
    t.float    "shippingcost"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "telephone_operators", :force => true do |t|
    t.string   "name"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "telephones", :force => true do |t|
    t.integer  "customer_id"
    t.integer  "operator"
    t.integer  "number"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "virtual_pay_systems", :force => true do |t|
    t.string   "name"
    t.boolean  "active"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "virtual_pays", :force => true do |t|
    t.integer  "customer_id"
    t.string   "number"
    t.integer  "virtualpaysystem_id"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T10:02:40.380

您编写的代码应该大部分都可以工作，但是其中有一个细微的错误：

*   [`belongs_to`关联](http://guides.rubyonrails.org/association_basics.html#the-belongs_to-association)使用单数（如`belongs_to :manufacturer`），但对于[关联`has_many`](http://guides.rubyonrails.org/association_basics.html#the-has_many-association)，您必须使用复数：

    ```
    class DesText < ActiveRecord::Base
        set_table_name "DES_TEXTS"
        set_primary_key :TEX_ID
        has_many :country_designations
        has_many :designations
    end 
    ```

*   请确保在您的表格中设置了相关键。以下是适合您的规则：
    *   每个`has_many`关联（参见[Rails Guides](http://guides.rubyonrails.org/association_basics.html#the-has_many-association)）都需要 many 部分具有对 one 部分的引用。在您的示例中：`Model`需要引用`CountryDesignation`. Rails 认为您的模型表包含一列`country_designation_id`（它不会找到）。
    *   `DES_TEXTS`和类似`COUNTRY_DESIGNATIONS`。

更正后，您应该能够使用以下代码（仅更改后的代码可以对某些对象进行深度访问）：

```
- @manufacturer.models.each do |model|
  %tr
    %p
      ...
      %td= model.country_designation.des_text.FIELD
    = link_to 'Show model', model 
```

这将在每个制造商型号的循环内显示`des_text`其`country_designation`. *但要小心：*这只是一个示例，并且只有在每个模型都有一个国家名称并且每个国家名称都有一个 des_text 的情况下才会起作用。

不幸的是，您使用现有的数据库方案，它使很多事情变得更加困难。我在这里给你以下建议：

*   迁移到名称为 rails 嫌疑人的干净状态。
*   每次迁移后使用 Rails 控制台测试您的模型是否符合规则。您可以从那里开始`rails c`并在那里输入您认为应该有效的命令。
*   您的应用程序是一个庞大而复杂的时刻，所以我认为没有机会在这里进一步调试它......（对不起，但这是我第四次添加到我的答案中，它看起来更像是Rails 教程现在）

# c - 如何检查我的包装函数系统调用 - read() 是否正确？

> ID：10252848
> 
> 赞同：3
> 
> 时间：2012-04-20T20:06:44.623
> 
> 标签：c, linux, system-calls

> **可能重复：**
> [包装函数的内联汇编器由于某种原因不起作用](https://stackoverflow.com/questions/10260178/inline-assembler-for-wrapper-function-doesnt-work-for-some-reason)

我被要求为`read , write , close , open & fork`.

我已经为`read , write , close , open`.

我的问题是：

1.  如何`fork`使用我为其编写的 4 个包装函数编写包装函数`read , write , close & open`？

2.  如何检查我编写的包装器是否正确？这是`read`-的包装函数的代码`my_read`：

```
ssize_t my_read(int fd, void *buf, size_t count)   
{    
      ssize_t res;

      __asm__ volatile(
        "int $0x80"        /* make the request to the OS */
        : "=a" (res),       /* return result in eax ("a") */
          "+b" (fd),     /* pass arg1 in ebx ("b") */
          "+c" (buf),     /* pass arg2 in ecx ("c") */
          "+d" (count)      /* pass arg3 in edx ("d") */
        : "a"  (5)          /* passing the system call for read to %eax , with call number 5  */
        : "memory", "cc"); 

      /* The operating system will return a negative value on error;
       * wrappers return -1 on error and set the errno global variable */

      if (-125 <= res && res < 0)
      {
        errno = -res;
        res   = -1;
      }

      return res;
} 
```

**备注**：我不允许直接使用`open ,close ,read , write & fork`命令。

如果需要，我可以附上其他 3 个包装器的其余代码。以上是`read`.

问候

罗恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T11:45:16.257

fork 应该是系统调用 2，所以

```
 __asm__ volatile ("int $0x80" : "=a" (res) : "0" (2)); 
```

应该管用。请记住，fork 返回两次，`res`分别是子进程的 pid（在父进程中）和 0（在子进程中）。

# node.js - 在 express/node 配置中更新 ServerRequest 的原型

> ID：10252850
> 
> 赞同：0
> 
> 时间：2012-04-20T20:06:46.267
> 
> 标签：node.js, express

我想在 expressjs 中增加请求对象的原型，但是不清楚这个请求是在哪里定义的？我认为它是 http.ServerRequest，但我也找不到该定义。

执行以下操作的正确方法是什么...

```
http.ServerRequest.prototype.redirect = function(path) { } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T23:57:50.033

Express 本身将其实用程序方法添加到[2.* 中](https://github.com/visionmedia/express/blob/e3e7d0def6b26333965b5a55b43d9f34d25b2bb2/lib/request.js#L11)`http.IncomingMessage.prototype`使用此模式：

```
var http = require('http'),
    req = http.IncomingMessage.prototype;

req.foo = function(bar) {
  // Do cool stuff
}; 
```

[而3.* 中的](https://github.com/visionmedia/express/blob/master/lib/request.js#L20)这种模式：

```
var http = require('http');

var req = exports = module.exports = {
  __proto__: http.IncomingMessage.prototype
}; 
```

正如 Vadim Baryshev 在他的回答中警告的那样，谨慎使用猴子补丁是明智的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:32:37.033

查看[Connect 框架](https://github.com/senchalabs/connect)和他的[中间件库](https://github.com/senchalabs/connect/blob/master/lib/middleware)。每个中间件在创建后都会扩展请求和响应对象。更改核心对象的原型并不是最好的方法，因为这会导致其他模块出现不可预测的行为。

# ruby-on-rails - HAML - 如何创建表单验证并显示错误消息？

> ID：10252851
> 
> 赞同：2
> 
> 时间：2012-04-20T20:06:52.837
> 
> 标签：ruby-on-rails, haml

我能够在 HAML 中呈现表单，但我不确定如何验证它。

这是我到目前为止所拥有的：

```
 #disclosure-form-container
    = form_for([:mobile,@disclosure], :html => {:id => "disclosure-form", :remote => true}) do |f|
      %p
        =f.label :display_as, (t :select_disclosure_type)
        =f.select :display_as, options_from_collection_for_select(Disclosure.basics, :display_as, :name, f.object.display_as)
      %p
        =f.label :notes, (t :notes)
        =f.text_area :notes, :class => "#{validation_rules(:free_disclosure_notes)}", :rows => 5 , :id => "disclosure_notes_entry"
        = buttonset({:submit_label => (t "buttons.influencers.disclosures.create"),:submit_css_class => "call-to-action",:cancel_url => "#",:direction => :left_to_right}) 
```

这会呈现一个包含两个字段和一个单击提交按钮的表单。但是如果人们只是输入提交而没有做太多事情呢？我在哪里放置验证码以及如何验证此表单？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:21:45.950

用户输入应保存在模型中然后存储在数据库中的数据。所以很自然地在模型级别实现验证。Rails 允许您轻松地为模型创建验证。[在这里](http://guides.rubyonrails.org/active_record_validations_callbacks.html#validations-overview)你可以阅读它。简而言之：在您的模型中添加几行可以防止它与不一致的数据一起保存。

但是**除了**模型级验证之外，您还可以使用客户端验证：即，数据将在发送到服务器之前进行检查。这样用户就不必提交表单来发现他忘记填写一些必填字段。但这当然不能作为任何保证，因为它很容易绕过。[这里](http://railscasts.com/episodes/263-client-side-validations)有更多关于客户端验证的信息。

因此，如您所见，Haml 无法帮助您进行验证。这是一个很棒的工具，但不是为了这个目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T23:22:32.197

在您的`Disclosure`模型中，您需要：

```
class Disclosure < ActiveRecord::Base
  validates_presence_of :display_as, :notes
  ...
end 
```

然后，您可以在表单顶部包含错误消息，例如：

```
- if @disclosure.errors.any?
  %ul.errors
    - @disclosure.errors.full_messages.each do |msg|
      %li= msg 
```

或者，如果您使用[简单表单](https://github.com/plataformatec/simple_form)，您将获得内联的自动验证消息，您的表单将如下所示：

```
= simple_form_for @disclosure do |f|
  = f.input :display_as
  = f.input :notes
  = f.submit 
```

你完成了。

请注意，正如 Jdoe 所指出的，HAML 与检测验证无关，它只显示服务器告诉它的内容。服务器决定是否存在验证错误。

如果你想尝试想出类似这个客户端的东西，你可以给你的表单一个 id 并做这样的事情（在 CoffeeScript 中）：

```
jQuery ->
  $('form#disclosures').submit (event) ->
    unless $('input#display_as').val().length > 0 && $('input#notes').val().length > 0
      event.preventDefault()
      $(this).append('<div class="error">You must select 'display' and enter notes.</div>') 
```

# asp.net - 根据用户输入填充数据表

> ID：10252855
> 
> 赞同：2
> 
> 时间：2012-04-20T20:06:59.910
> 
> 标签：asp.net, vb.net

我有一个保存我页面记录的 SQL 数据库。在我的页面上，我有一个详细信息视图，我想用我的数据库中的记录填充。我可以很好地填充记录，我需要能够根据用户从下拉框中的选择来填充记录吗？

澄清一下，在我的主页上，我有一个包含年份的下拉列表（即 2011、2010、2009），以及一个包含帐户代码（即六位数字）的下拉列表。根据用户为年份选择的内容（例如 2010 年）和他们为帐户代码选择的内容（例如 123456），我想仅使用 2010 年的那些记录填充详细信息视图（位于单独的页面上）和使用帐户代码 123456??

还远远没有找到让它工作的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:16:43.317

根据来自表单控件的输入填充 DetailsView 实际上非常简单。您基本上是在使用控件来提供参数值以插入到 select 语句的 WHERE 子句中。

本质上，您定义 SqlDataSource 以获取 Control 参数。

这里还有文档：http: [//msdn.microsoft.com/en-us/library/z72eefad.aspx](http://msdn.microsoft.com/en-us/library/z72eefad.aspx)

还有一篇带有截图的文章：[http ://www.asp.net/web-forms/tutorials/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with -the-sqldatasource-vb](http://www.asp.net/web-forms/tutorials/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-vb)

如果详细信息视图位于不同的页面上，您可以使用 QueryString 参数执行相同的操作，但这会使您容易被篡改。（人们更改查询字符串中的值以获取他们不应该看到的记录。）如果篡改不是您的具体情况的问题 - 数据本质上不敏感，那么它应该不是问题，但是它'的东西要注意。

# listview - 使用自定义投影对数据绑定的 ASP.NET ListView 进行排序

> ID：10252858
> 
> 赞同：0
> 
> 时间：2012-04-20T20:07:25.957
> 
> 标签：listview, sorting, linq-to-objects

所以这是场景 - 我首先从表`transactions`和`v_patients`. 我将该查询执行到`List(Of transaction)`. 我操纵（`Concat()`、`GroupBy()`等）该列表，直到达到最终投影并`DataBind()`到达 GroupMatchListView。我在标记中有一些带有`Sort`命令的链接按钮。现在我需要在`GroupMatchListView_Sorting`对列表进行排序的事件处理程序中编写一些内容。我想我需要使用 IComparer，或者`GroupMatchListView.Items.OrderBy`以某种方式对 ListView 进行排序，但我很困惑。我不想运行另一个 SQL 查询并重做我的列表操作。谢谢你的帮助！

最终投影：

```
Dim goliath = From f In wholeResults _
                          Group f By f.v_patient Into Group _
                          Order By v_patient.last_name, v_patient.first_name, v_patient.date_of_birth _
                          Select New With {.PatientID = v_patient.patient_id, .LastName = v_patient.last_name, .FirstName = v_patient.first_name, _
                             .DOB = v_patient.date_of_birth, .Ins = v_patient.insname, .MatchCount = Group.Count(), .Matches = Group}

            GroupMatchListView.DataSource = goliath
            GroupMatchListView.DataBind() 
```

我有一些具有排序命令的按钮：

```
<th id="Th4" runat="server" style="width: 100px" width="100px">
                                        <asp:LinkButton ID="SortLastNameButton" runat="server" CommandName="Sort" CommandArgument="LastName" ForeColor="White">Last Name</asp:LinkButton>
                                    </th>
                                    <th id="Th5" runat="server" style="width: 100px" width="100px">
                                        <asp:LinkButton ID="SortFirstNameButton" runat="server" CommandName="Sort" CommandArgument="FirstName" ForeColor="White">First Name</asp:LinkButton>
                                    </th>
                                    <th id="Th6" runat="server" style="width: 85px" align="center" width="85px">
                                        <asp:LinkButton ID="SortDOBButton" runat="server" CommandName="Sort" CommandArgument="DOB" ForeColor="White" ToolTip="Date of Birth">DOB</asp:LinkButton>
                                    </th>
                                    <th id="Th7" runat="server" style="width: 185px" width="185px">
                                        <asp:LinkButton ID="SortInsuranceButton" runat="server" CommandName="Sort" CommandArgument="Ins" ForeColor="White">Insurance</asp:LinkButton>
                                    </th> 
```

我放置排序逻辑的地方：

```
 Protected Sub GroupMatchListView_Sorting(sender As Object, e As System.Web.UI.WebControls.ListViewSortEventArgs) Handles GroupMatchListView.Sorting
        ''
        ''Something goes here that sorts the ListView
        ''Maybe something that uses
        ''IComparer
        ''or
        ''GroupMatchListView.Items.OrderBy()
    End Sub 
```

再次感谢。

编辑：我认为我在正确的轨道上。我采用 GroupMatchListView.Items，使用 OrderBy，并将结果分配给 List(Of ListViewDatItems)。然后我清除 GroupMatchListView.Items，并从我的 ListViewDataItems 列表中添加回项目。但是，当我返回该页面时，什么都没有改变。如果我只使用 DataBind() 我会得到一个空的 ListView。如果我将 ListViewDataItems 列表分配为 DataSource，然后是 DataBind，则会出现错误。有人知道我怎么能把它包起来吗？

这是我的工作：

```
 Protected Sub GroupMatchListView_Sorting(sender As Object, e As System.Web.UI.WebControls.ListViewSortEventArgs) Handles GroupMatchListView.Sorting

            Dim caesar As List(Of ListViewDataItem) = (GroupMatchListView.Items.OrderBy(Function(i) CType(i.FindControl("FirstName"), Label).Text)).ToList()

            GroupMatchListView.Items.Clear()

            For Each i As ListViewDataItem In caesar
                GroupMatchListView.Items.Add(i)
            Next

            ''I don't know what comes next.  The following does not work:
            ''GroupMatchListView.DataSource = GroupMatchListView.Items
            ''GroupMatchListView.DataBind()
        End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T05:06:39.257

好吧，我不能用 GroupMatchesListView.Items 做到这一点。相反，我将之前查询的结果放入 Session 变量中。然后到了排序的时候，我把它拿出来，排序，然后发回给 Session。

这是代码：

*   首先我把它扔进 Session

    ```
     goliath = (From f In wholeResults _
                      Group f By f.v_patient Into Group _
                      Order By v_patient.last_name, v_patient.first_name, v_patient.date_of_birth _
                      Select New With {.PatientID = v_patient.patient_id, .LastName = v_patient.last_name, .FirstName = v_patient.first_name, _
                         .DOB = v_patient.date_of_birth, .Ins = v_patient.insname, .MatchCount = Group.Count(), .Matches = Group}).ToList()

    Session("ListOfMatches") = goliath
    GroupMatchListView.DataSource = goliath 
    ```

*   然后我施展了我的魔法

    Protected Sub GroupMatchListView_Sorting(sender As Object, e As System.Web.UI.WebControls.ListViewSortEventArgs) 处理 GroupMatchListView.Sorting

    ```
     Dim interimMatches As IEnumerable(Of Object) = CType(Session("ListOfMatches"), IEnumerable(Of Object))

            Select Case e.SortExpression
                Case "LastName"
                    If CurrentSortExpression = "LastName" Then
                        interimMatches = interimMatches.Reverse()
                    Else
                        interimMatches = interimMatches.OrderBy(Function(i) CType(i.LastName, String)).ToList()
                        CurrentSortExpression = "LastName"
                    End If
                Case "FirstName"
                    If CurrentSortExpression = "FirstName" Then
                        interimMatches = interimMatches.Reverse()
                    Else
                        interimMatches = interimMatches.OrderBy(Function(i) CType(i.FirstName, String)).ToList()
                        CurrentSortExpression = "FirstName"
                    End If
                Case "DOB"
                    If CurrentSortExpression = "DOB" Then
                        interimMatches = interimMatches.Reverse()
                    Else
                        interimMatches = interimMatches.OrderBy(Function(i) CType(i.DOB, Date)).ToList()
                        CurrentSortExpression = "DOB"
                    End If
                Case "Ins"
                    If CurrentSortExpression = "Ins" Then
                        interimMatches = interimMatches.Reverse()
                    Else
                        interimMatches = interimMatches.OrderBy(Function(i) CType(i.Ins, String)).ToList()
                        CurrentSortExpression = "Ins"
                    End If
            End Select
            Session("ListOfMatches") = interimMatches
            ViewState("CurrentSortExpression") = CurrentSortExpression
            GroupMatchListView.DataSource = interimMatches
            GroupMatchListView.DataBind()

        End Sub 
    ```

希望这可以帮助某人。

# f# - .NET micro 上的 F#

> ID：10252859
> 
> 赞同：4
> 
> 时间：2012-04-20T20:07:29.837
> 
> 标签：f#, .net-micro-framework

F# 是否与 .NET Micro 一起运行？

我想到了 Microsoft Research Cambridge 的 .NET gadgeteer，或者 Netduino，Arduino 板的 .NET micro 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:38:17.317

我相信官方的答案只是 C#。

# c# - ValidateUserName 未定义

> ID：10252864
> 
> 赞同：1
> 
> 时间：2012-04-20T20:07:46.007
> 
> 标签：c#, asp.net, web-services, jquery

我有一个 jquery ajax 调用 asp.net 网络服务问题。我想验证 asp.net 网页中的文本框。验证器是：

```
<asp:CustomValidator ID="CustomValidatorUser" runat="server" ControlToValidate="TextUserName"
                                ErrorMessage="Minimum of 6 (six) alphanumeric characters." 
                 ClientValidationFunction="ValidateUserName" Display="Dynamic"
                                ValidateEmptyText="True" ></asp:CustomValidator> 
```

jquery 代码是（更新的第 2 次）：

```
<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
<script src="../jquery-1.7.2.min.js" type="text/javascript"></script>
<script>
$.ajax({
    type: "POST",
    url: "UserNameWebService.asmx/ValidateUserName",
    data: "{'strUsername': " + $("#TextUserName").val() + "}",
    contentType: "application/json; charset=utf-8",
    dataType: "json"
});
</script>
<div>
    General user information</div>
<p>
</p>
<table cellpadding="2"> 
```

网络服务代码为：

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
 [System.Web.Script.Services.ScriptService]
public class UserNameWebService : System.Web.Services.WebService
{

    [WebMethod]
     public bool ValidateUserName(string strUsername)
    {
        string UserNameCreated = strUsername;
        string AD_Server = System.Configuration.ConfigurationManager.AppSettings["AD_Server"];
        DirectoryEntry entry = new DirectoryEntry(AD_Server);
        entry.AuthenticationType = AuthenticationTypes.Secure;

        DirectorySearcher deSearch = new DirectorySearcher(entry);
        deSearch.Filter = "(&(objectClass=user)(samaccountname=" + UserNameCreated + "))";

        SearchResultCollection results = deSearch.FindAll();
        Match match = Regex.Match(UserNameCreated, @"^[a-zA-Z0-9]{6,}$", RegexOptions.IgnoreCase);
        if (results.Count > 0)
            return false;
        else if (match.Success)
            return true;
        else
            return false;
    }    } 
```

但我得到一个错误：

```
ValidateUserName is undefined. 
```

请帮我纠正错误。

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T00:28:16.703

您需要将 ajax 函数封装在函数调用中`ValidateUserName`，以便匹配`ClientValidationFunction`.

```
function ValidateUserName(){
  $.ajax({
    type: "POST",
    url: "UserNameWebService.asmx/ValidateUserName",
    data: "{'strUsername': " + $("#TextUserName").val() + "}",
    contentType: "application/json; charset=utf-8",
    dataType: "json"
  });
} 
```

即使那样，这也没有返回值。我认为您需要使用`success`该函数的选项`$.ajax`来设置一个布尔值以返回该函数。

所以你会做这样的事情：

```
function ValidateUserName(){
   var isValid;
   $.ajax({
    type: "POST",
    url: "UserNameWebService.asmx/ValidateUserName",
    data: "{'strUsername': '" + $("#TextUserName").val() + "'}",
    contentType: "application/json; charset=utf-8",
    dataType: "json"
    , async: false
    , success: function(data){
       isValid = data;
    }
  });
  return isValid;
} 
```

请注意，我也设置`async`为 false。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T00:55:54.480

您的代码实际上存在几个问题。

1)`$("#TextUserName")`在这种情况下不起作用，因为 asp.net 将`TextBox`使用不同的 ID 呈现服务器端控件。您需要这样做：

```
data: "{'strUsername': " + $("#<%=TextUserName.ClientID%>").val() + "}", 
```

2）数据属性中的 json 格式不正确，您需要`'`在值周围加上单引号，如下所示：

```
 |                                              | 
                       V                                              V
data: "{'strUsername': '" + $("#<%=TextUserName.ClientID%>").val() + "'}", 
```

3）您需要将您的 Jquery ajax 调用放在一个函数中，在您的情况下，该函数称为`ValidateUserName`. 它有两个参数`source`和`args`。此函数的职责是将 的值设置`args.IsValid`为`true`或`false`。因此，您需要提供一个在 ajax 调用成功时调用的函数，该函数可以执行此逻辑。像这样：

```
function ValidateUserName(source, args) {
    $.ajax({
        type: "POST",
        url: "UserNameWebService.asmx/ValidateUserName",
        data: "{'strUsername': '" + args.Value + "'}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        async: false,
        success: function (result) {
            args.IsValid = result.d;
        }
    });
} 
```

4) 正如您在上面的代码中所看到的，您实际上不需要使用 jquery 从文本框中获取值，因为您可以像这样访问它`args.Value`。

5）你需要添加`async: false`，否则到设置的时间`IsValid`，设置消息可见性的代码已经执行，所以什么都不会发生。

# ios - iOS： ARC 不允许使用 CFTypeRef

> ID：10252878
> 
> 赞同：8
> 
> 时间：2012-04-20T20:08:43.447
> 
> 标签：ios, automatic-ref-counting, keychain

我想从我的钥匙串中取出用户名/密码。为此，我遵循了本指南：

[简单的 iPhone 钥匙串访问](http://useyourloaf.com/blog/2010/3/29/simple-iphone-keychain-access.html)

但是ARC不允许这部分：

```
NSData *result = nil;    
OSStatus status = SecItemCopyMatching(
                  (CFDictionaryRef)searchDictionary,                                            
                  (CFTypeRef *)&result); 
```

我能做些什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-20T20:19:15.157

ARC 只管理 Objective-C 类型。如果您转换为 Core Foundation 类型，您必须使用`__bridge`,`__bridge_retained`或告诉 ARC 谁拥有该变量`__bridge_transfer`。

这是Apple关于 ARC 下的免费桥接[的官方文档，或查看](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)[此博客文章](http://www.mikeash.com/pyblog/friday-qa-2011-09-30-automatic-reference-counting.html)（向下滚动到免费桥接）以获得很好的概述。

例如：

```
NSData *inData = nil;
CFTypeRef inTypeRef = (__bridge CFTypeRef)inData;
OSStatus status = SecItemCopyMatching(
                   (__bridge CFDictionaryRef)searchDictionary, 
                   &inTypeRef); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-02T10:03:42.677

```
CFTypeRef inData = NULL;
OSStatus status = SecItemCopyMatching(
                   (__bridge CFDictionaryRef)searchDictionary, 
                   & inData);
NSData *data = (__bridge NSData *)inData; 
```

# scala - Play 2.0 中的自定义资产编译

> ID：10252879
> 
> 赞同：2
> 
> 时间：2012-04-20T20:08:51.820
> 
> 标签：scala, playframework-2.0

开箱即用 Play 2.0 支持 LESS 和 CoffeeScript 资产编译，例如，

[http://www.playframework.org/documentation/2.0/AssetsCoffeeScript](http://www.playframework.org/documentation/2.0/AssetsCoffeeScript)

我想知道是否有一种简单、干净的方式来提供自定义资产编译器而无需定义自己的控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T17:49:24.047

要回答这个问题。可以通过将新编译器添加到`Build.scala`项目中的文件来添加您自己的编译器。例如

```
resourceGenerators in Compile <+= MyNewResourceCompilerCompiler 
```

来源：[https ://groups.google.com/forum/?fromgroups#!topic/play-framework/rnz9mrejtj8](https://groups.google.com/forum/?fromgroups#!topic/play-framework/rnz9mrejtj8)

# javascript - 设置值从数据库中检索标签后

> ID：10252883
> 
> 赞同：0
> 
> 时间：2012-04-20T20:09:09.340
> 
> 标签：javascript, jsp, session, redirect, dynamicobject

我有 JSP 页面。在 HTML 标签下的那个页面中，我有`<input>`标签。现在，在使用 JDBC 连接从数据库中检索这些输入标记后，将设置这些输入标记的值。假设我有一个页面`page1.jsp`，其中有一个 javascript 代码，其中包含一个函数，在该函数中我重定向到使用数据库连接检索值的页面。现在，当我执行查询时，我得到了结果集变量中的所有值。我希望将这些值再次发送回，`page1.jsp`以便我可以使用它们将它们设置为我的标签的值。我想知道我该怎么做。我应该将结果集变量中的每个值存储到会话变量中并稍后使用它们，还是应该将 rs 变量返回到第 1 页并在`<input>`标签中设置值，例如`<%=rs.getInt("String")%>`. 一个人建议我使用动态对象。我听说过它们，但从未使用过它们。这样做的更好方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:04:53.730

第一个解决方案很简单，正如您所说，您可以将值存储在会话中并在 page1.jsp 中检索它们。但我认为你应该去 Javascript Asyncronuos 调用在 xml 中生成你的响应，检索它并填充到你的页面中而不刷新你的页面。（内容更新）。IE

```
xmlhttp.open("GET","demo_get.asp",true);
xmlhttp.send(); 
```

更多信息[掌握 Ajax](http://www.ibm.com/developerworks/web/library/wa-ajaxintro2/)

# android - 在 Android 中缩放布局样式的最佳方法？

> ID：10252885
> 
> 赞同：1
> 
> 时间：2012-04-20T20:09:12.147
> 
> 标签：android, string, layout, styles, scale

在使用应支持多种屏幕尺寸的应用程序时，我遇到了两难境地。通过样式缩放文本大小、宽度和高度等属性的最佳方法是什么？理想情况下，我会喜欢这样的设置：

```
layout.xml:
  <YourView style="@style/Footer"/>

styles.xml:
  <style name="Footer"> 
    <item name="android:layout_height">@string/FooterHeight</item>
    <item name="android:layout_width">fill_parent</item>
    <item name="android:background">@drawable/background_footer</item>
    <item name="android:layout_gravity">bottom</item>
  </style>

values/layout_vals.xml:
  <string name="FooterHeight">50dp</string>

values-sw600dp/layout_vals.xml:
  <string name="FooterHeight">80dp</string> 
```

然后，为了更改视图的高度，只需创建一个具有目标最小宽度的新文件夹并编辑 *layout_vals.xml* 的值，并留下所有关于宽度、重力、背景等，留下更干净的设置和更容易的编辑。

但是，我尝试过并发现这个确切的设置不起作用。现在，我只是将整个 styles.xml 复制到不同的“layout-swXXdp”文件夹中并换出值。是否有人对另一种与此相当或更好甚至比这更好的项目设置方法有*建议*？感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:17:52.647

[使用@dimen](http://developer.android.com/guide/topics/resources/more-resources.html#Dimension)资源而不是字符串- 我认为它正是您正在寻找的（除了它会进入 res/values-sw600dp）

# java - Java Paint 组件刷新率？

> ID：10252889
> 
> 赞同：2
> 
> 时间：2012-04-20T20:09:23.767
> 
> 标签：java, swing, animation, buffer

我正在用 Java 开发一个小游戏，并且我正在重写玩家运动系统，使其不是基于网格的。它是一个 2D 横向卷轴，我想要实现的是基本的玩家移动，因此当用户按住并按住右键时，玩家向右移动，左键也是如此。我遇到的问题是另一个类中的 Paint 组件在屏幕上绘制了播放器的图像，位置 X 和 Y 存储在设置类中。然后当用户按下右时，一个 KeyListener 类得到，并添加到 X 值（左相同，但每次减 1）。这会在屏幕上创建一个缓慢移动的角色，我想要做的是让他移动得更快，而不是每次添加超过 1px，因为它看起来像是在跳过像素（我已经尝试过）。

我想知道是否有更好的方法来解决这个问题，因为我使用的代码是最低限度的，我的结果将是一个平稳移动的 Player。

**KeyListener 片段：**

```
public void keyPressed(KeyEvent arg0) {
    int key = arg0.getKeyCode();

    if(key == 39) { // Right Key
        Settings.player_pos_x++;
    }else if(key == 37) { // Left Key
        Settings.player_pos_x--;
    }

    main.Game.redo();
} 
```

**在屏幕上绘制用户：**

```
g.drawImage(player_image, Settings.player_pos_x, Settings.player_pos_y, this); 
```

任何帮助表示赞赏，如果您需要更多信息或代码，请随时询问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:24:09.407

让我们再试一次 ：）

# 双缓冲

引用：http: [//msdn.microsoft.com/en-us/library/b367a457.aspx](http://msdn.microsoft.com/en-us/library/b367a457.aspx)

> 闪烁是编程图形时的常见问题。需要多个复杂绘制操作的图形操作可能会导致渲染图像出现闪烁或具有其他不可接受的外观。
> 
> 启用双缓冲时，所有绘制操作首先呈现到内存缓冲区而不是屏幕上的绘图表面。在所有绘制操作完成后，内存缓冲区被直接复制到与其关联的绘图表面。由于在屏幕上只进行了一次图形操作，因此消除了与复杂绘画操作相关的图像闪烁。

引用：[http ://docs.oracle.com/javase/tutorial/extra/fullscreen/doublebuf.html](http://docs.oracle.com/javase/tutorial/extra/fullscreen/doublebuf.html)

> 假设您必须在屏幕上逐个像素或逐行绘制整幅图片。如果您要将这样的东西直接绘制到屏幕上（例如，使用 Graphics.drawLine），您可能会非常失望地注意到这需要一些时间。您甚至可能会注意到您的图片是如何绘制的可见伪影。大多数程序员不是看着以这种方式和速度绘制的东西，而是使用一种称为双缓冲的技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:22:48.153

也许您可以编写应用程序以向右迭代多次重绘，每个接收到的键盘输入只有 1 或 2 个像素。这样，您就可以人为地设置您希望它移动的速度。否则，您将受限于用户如何设置键盘迭代速度。

此外，java 的 jPanel 并不完全是寻找视频游戏效率的地方。只是说；你可能想看看像openGL这样的东西。

充其量，您可以优化它以在 jpanel 绘图逻辑之外有一个过渡缓冲区，具有与 jPanel 相同的绘图功能，这样您就可以写入缓冲区，然后在 writeImage 调用期间复制整个缓冲区......我不'不知道你是否已经这样做了，但我认为它可以避免闪烁或其他东西......很久以前读过它，它被称为双缓冲。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T21:19:37.777

虽然双缓冲可能会帮助您首先解决如何计算每次移动的距离。

距离变化 (dx) 可以定义为速度 (v) 乘以时间变化 (dt)，dx = v * dt。据我所知，您省略了 dt （时间变化）。您应该计算与上次移动角色的时间差，并将其乘以您的速度。这样，如果您的距离处理代码在 10 秒内执行 10 次或 100 次，角色将始终移动相同的距离。

代码将如下所示：

```
int currentTime = System.nanoTime();
int deltaTime = currentTime - previousTime;

Settings.player_pos_x += velX * deltaTime;

previousTime = currentTime; 
```

使用此代码，您可能需要显着增加 velX。通常我会有一个常数，我会乘以速度，所以它们是较小的数字。

此外，如果您想要更好的运动和物理效果，请查看 JBox2D，尽管它现在可能对您来说太过分了。他们的文档也可能有助于理解基础物理学。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T20:39:14.503

为了回答您关于速度的问题，我见过的大多数游戏都为每个平面（x 和 y 平面）中的速度存储了一个全局 int，然后将速度应用于当前位置，而不是像您所做的那样简单地增加它多于。

```
public int velX = 2;
public int velY = 2;

public void keyPressed(KeyEvent arg0) { 
    int key = arg0.getKeyCode(); 

    if(key == 39) { // Right Key 
        Settings.player_pos_x += velX; 
    }else if(key == 37) { // Left Key 
        Settings.player_pos_x -= velX; 
    } 

    main.Game.redo(); 
} 
```

设置完成后，尝试添加可能会增加速度的操作（即长时间按住键，或其他）；

另外，尝试实现跳跃操作，让玩家的 Y 位置上升，并尝试添加重力场以使其返回。

# asp.net-mvc-3 - MVC3 - Razor，Ajax.BeginForm - 客户端 - OnBegin

> ID：10252891
> 
> 赞同：2
> 
> 时间：2012-04-20T20:09:39.937
> 
> 标签：asp.net-mvc-3, razor, ajax.beginform

当我单击提交按钮时，我直接进入我的操作。以下 2 没有发生：

1.  此时未调用我的客户端 beginForm 方法。我想要的。
2.  Request.IsAjaxRequest 是假的，即使我的模型有表单输入

试图找到这个问题的答案。相同的代码在 MVC2 中工作，所以我必须在这里遗漏一些东西。

引用了以下 2 个 MS js 文件：

```
<!-- MS AJAX -->
<script type="text/javascript" src="/Scripts/MicrosoftAjax.js"></script>
<script type="text/javascript" src="/Scripts/MicrosoftMvcAjax.js"></script> 
```

表格代码：

```
@{
        using (Ajax.BeginForm(ActionNames.Index, ControllerNames.CustomerSearch, new {Area = ""}, new AjaxOptions
                                                                                                      {
                                                                                                          HttpMethod = "Post",
                                                                                                          OnBegin = "CustomerSearch.beginForm",
                                                                                                          OnSuccess = "CustomerSearch.successForm"
                                                                                                      }, new {id = "CustomerSearchForm"}))
        {

... form items ...
}
} 
```

页面上显示的形式：

```
<form action="/CustomerSearch" data-ajax="true" data-ajax-begin="CustomerSearch.beginForm" data-ajax-method="Post" data-ajax-success="CustomerSearch.successForm" id="CustomerSearchForm" method="post">

... Other Form Items ...
<input type="image" src="/App_Themes/Main/Images/ResponseAction/Buttons/btn_submit.gif" alt="Submit" id="SubmitButton" />
</form> 
```

这是我的 CustomerSearch.js，在页面加载警报（2）上显示得很好：

```
var CustomerSearch = {
    enums: {
        buttonId: "SubmitButton",
        searchResultsContainerId: "CustomerSearchResults"
    },
    beginForm: function () {
        alert(1);
        var $button = $("#" + CustomerSearch.enums.buttonId);
        jMessage("Processing request...", $button, true, false);
        return true;
    },
    successForm: function (context) {
        var $button = $("#" + CustomerSearch.enums.buttonId);
        var $searchResults = $("#" + CustomerSearch.enums.searchResultsContainerId);
        var data = context.get_data();

        jMessageHide();
        $searchResults.html(data).fadeIn(500);
    }
};

alert(2); 
```

我在 web.config 中启用的不显眼的 javascript 设置为 true：

```
<add key="ClientValidationEnabled" value="true"/>
<add key="UnobtrusiveJavaScriptEnabled" value="true"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:22:33.420

[使用 MVC3](http://www.asp.net/whitepapers/mvc3-release-notes#0.1__Toc274034221)不显眼的 Ajax 助手：

*   Ajax.ActionLink
*   Ajax.RouteLink
*   Ajax.BeginForm
*   Ajax.BeginRouteForm

正在使用该`jquery.unobtrusive.ajax.js`文件。

因此，您需要包含该 js 文件而不是 MicrosoftAjax 文件（MicrosoftAjax 文件在 MVC3 中已弃用，并且未随 MVC4 beta 提供）：

```
<script type="text/javascript" src="/Scripts/jquery.unobtrusive-ajax.min.js"></script> 
```

# jquery - Jquery如何在单选时触发按钮

> ID：10252894
> 
> 赞同：1
> 
> 时间：2012-04-20T20:09:46.590
> 
> 标签：jquery, html, checkbox

验证后，我需要在不同的隐藏按钮上触发自定义提交。代码工作正常，但它只做默认。我做错了什么？

这是分离形式：

```
<label for="a1"><input id="a1" type="radio" name="method" value="PayPal" validate="required:true" checked>PayPal</label>
<label for="a2"><input id="a2" type="radio" name="method" value="SEB">SEB</label> 
```

...

```
<input class="checkout" type="button" value="checkout">
<input class="paypal" type="button" value="paypal"> 
```

Nad这里是脚本...

```
$(document).ready(function() {

    $("#checkout").validate({
        success: "valid",
        submitHandler: function(form) {
            var v = "$('input[name=method]:checked', '#checkout').val()";
            switch(v){
                case "PayPal": $('.paypal').trigger('click');
                default: ^$('.checkout').trigger('click');
                break;
            }         
        }
    });
}); 
```

我需要任何新的想法来完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:13:39.360

试试这个，你的案子没有破产：

此外，您的`var v`声明周围有额外的引号

```
$(document).ready(function() {

    $("#checkout").validate({
        success: "valid",
        submitHandler: function(form) {
            var v = $('input[name=method]:checked', '#checkout').val();
            switch(v){
                case "PayPal": $('.paypal').trigger('click');
                break;
                default: $('.checkout').trigger('click');
                break;
            }         
        }
    });
}); 
```

# search - 从“牙科”等查询中获取“牙科”、“牙医”等词的正确方法（反之亦然）

> ID：10252897
> 
> 赞同：1
> 
> 时间：2012-04-20T20:09:51.650
> 
> 标签：search, text, nlp, stemming

我对词干有些熟悉，但是我被指定用于项目的词干库在我想查找相关词的情况下效果不佳，例如如果我对其中任何一个进行查询：

“牙科”、“牙医”、“牙科”

我应该为其他人找一场比赛。我一直在研究这个，我正在学习我什至不知道存在的词性，比如 pertainyms 和 troponyms 所以我想知道是否没有一个图书馆可以在所有这些之间进行映射可以返回我正在寻找的那种匹配的不同词性？

我一直在寻找这个，并没有找到很多我能理解的东西。我可能不知道正确的术语等，如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:11:50.633

看看[WordNet](http://wordnet.princeton.edu/)。WordNet 是一个有组织的单词和概念本体，带有用于单词之间各种类型关系的链接。我不确定它是否会有你想要的关系，但这可能是一个好的开始。各种编程语言中有许多接口（我使用过的 Java 和 Python；可能还有更多）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T03:23:42.323

IR 中常见的一种方法是对索引和查询本身中的所有单词进行词干处理。意思是，包含单词“dentistry”的文档将被提取并作为“dentist”存储在索引中。关键字“dental”也被称为“dentist”，从而在索引中匹配它。

# linux - 服务器权限问题，我无法再在 wordpress 中上传文件

> ID：10252902
> 
> 赞同：0
> 
> 时间：2012-04-20T20:10:16.763
> 
> 标签：linux, wordpress, permissions, ssh

因此，我将我的 wordpress 目录的 chown 所有者更改为 nobody（没有人运行 apache）...现在我可以在仪表板中自动更新并编辑文件，但我无法通过 FTP 上传其他任何内容。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T02:51:28.760

将自己分配到文件所属的组。

例如，如果您的 Web 文件归该组所有`nobody`并分配给该组`webgroup`，而您的 ftp 用户是该组，`finaldestiny`那么您将运行该命令`usermod -a -G webgroup finaldestiny`

您还需要确保该文件夹和文件可由组写入，而不仅仅是所有者。您可以`chmod -R g+w webroot`为组的 webroot 中的所有文件和文件夹添加写权限。

# c# - 从嵌入资源引用嵌入资源

> ID：10252903
> 
> 赞同：1
> 
> 时间：2012-04-20T20:10:20.117
> 
> 标签：c#, winforms, resx

我正在使用 WinForms 浏览器控件来显示我作为资源嵌入的 html 文件中的一些内容，效果很好。

我现在想在我的应用程序中嵌入一些脚本和样式表，但如果可能的话，我不知道如何从 html 页面引用其他嵌入文件。

我当前的解决方案是在显示之前加载资源并将它们添加到浏览器控件的文档中，但是如果我想使用 JQuery 之类的东西，这可能会有点混乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:19:32.503

如果脚本和样式表与 HTML 文件位于同一目录树中，则可以使用相对路径（例如`<script src="../scripts/myFoo.js" />`）。还是我错过了什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-22T16:54:57.997

嵌入文件，然后在渲染之前将每个文件提取到临时文件夹：

```
string ret = ResourceUtility.GetTempFileFromEmbeddedResource(Assembly.GetExecutingAssembly(),
    "outlook.addin.a.html", "a.html");

var bsjs = ResourceUtility.GetTempFileFromEmbeddedResource(Assembly.GetExecutingAssembly(),
    "outlook.addin.bootstrap.js.bootstrap.min.js", "bootstrap.min.js");

public static string GetTempFileFromEmbeddedResource(Assembly assembly, string resourceName, string fileName)
{
    string output;
    using (Stream s = ResourceUtility.GetEmbeddedResourceStream(assembly, resourceName))
    {
        StreamReader sr = new StreamReader(s);
        output = sr.ReadToEnd();
    }

    return CreateLocalTempFile(output, fileName);
} 
```

# ruby-on-rails - 如何在 Rails 中与项目管理员一起实施项目

> ID：10252904
> 
> 赞同：1
> 
> 时间：2012-04-20T20:10:28.620
> 
> 标签：ruby-on-rails

我正在寻找的是一种适当的方式来建立一个系统，用户可以在其中创建项目并因此成为该项目的管理员。然后，用户可以将其他管理员添加到项目中。最后，其他非管理员用户可以加入该项目。

我希望能够验证用户是否是项目的管理员，以检查他是否具有编辑/更新权限。有什么想法吗？

我想我可能会有一个 users_projects 表和一个 projects_admins 表，但我不知道这如何转化为 Rails 关系......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:31:28.217

好的，我会试一试，但这里没有太多代码。

我在这里看到 3 个模型：

*   用户
*   项目
*   项目管理员

前 2 个是简单的模型，具有一些属性。第三个是两者之间的关系，将是一个：m 关系。所以最好在这里使用 has-many-through 关系。

```
class ProjectAdmin < ActiveRecord::Base
  belongs_to :project
  belongs_to :user
end

class User < ActiveRecord::Base
  has_many :project_admins
  has_many :projects, :through => :project_admins
end

class Project < ActiveRecord::Base
  has_many :project_admins
  has_many :admins, :through => :project_admins
end 
```

当然，您必须通过迁移另外创建 3 个表，然后为项目用户添加类似的关系，然后命名`ProjectUser`为模型。至少看一下[关于关系的rails指南，“has-many :through”部分](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)。

要将创建者添加到项目中，这应该是两者之间的一对一关系，因此具有以下内容就足够了：

```
class Project
  has_one :creator, :class_name => "User"
end 
```

（当然还有`creator_id`在迁移中）

# objective-c - 为什么使用 lldb 时有效对象显示为 Nil？（苹果 LLVM 编译器 3.1、Xcode 4.3.1）

> ID：10252909
> 
> 赞同：7
> 
> 时间：2012-04-20T20:11:00.090
> 
> 标签：objective-c, xcode, nslog, lldb

我正在尝试通过一些时髦的 UIView 行为进行调试，并且一直遇到 LLDB 绝对无用和误导的情况。让我告诉你我的意思：

```
NSLog(@"myView: %@", myView);

2012-04-20 15:24:57.070 myProj[35789:f803] myView: <MyView: 0x7cc7500; frame = (0 119; 768 885); layer = <CALayer: 0x7cc8030>> 
```

但是当我在那一刻设置断点并尝试使用调试器时，它返回 nil：

```
(lldb) po myView
(MyView *) $552 = 0x00000000 <nil> 
```

我会尝试转移到 GCC 4.2 看看它是否有帮助，但是在 LLVM GCC 4.2 下编译不是一个选项，因为这是一个 ARC 项目。

当然，如果我已经知道要查询的正确地址，LLDB 就可以工作。但是对于某些对象，符号名称和地址之间的链接似乎被破坏了，尽管它适用于大多数其他对象。

```
(lldb) po self
(MyViewController *const) $51 = 0x07e92200 <MyViewController: 0x7e92200>
(lldb) po myView
(MyView *) $25 = 0x00000000 <nil>
2012-04-20 15:44:17.250 myProject[37551:f803] myView: <MyView: 0x7e8e240; frame = (0 119; 768 885); layer = <CALayer: 0x7ea2330>>
(lldb) po 0x7e8e240
(int) $50 = 132702784 <MyView: 0x7e8e240; frame = (0 119; 768 885); layer = <CALayer: 0x7ea2330>> 
```

我怎样才能解决这个问题？我什至尝试过 self->myView，但也没有用。

更新：（它变得更糟！）

我应该补充一点，在这个例子中 myView 是一个类变量，而不是一个属性（lldb 将它与 nil 相关联）。如果我将 myView 设为类属性并 @synthesize 它，lldb 将获得不正确但可预测的值，并且它将 myView 符号与 @synthesize 之前最近合成的属性相关联。所以就我而言，代码如下所示：

```
@synthesize myDate=myDate_;
@synthesize myView; 
```

因此，当从 LLDB 评估 myView 的属性时，它会显示存储在 myDate_ 中的日期：

```
(lldb) po myView
(MyView *) $24 = 0x07ca0900 2008-01-08 05:00:00 +0000 
```

在最后一种情况下，如果我将 myView 设为方法变量，LLDB 将是正确的：

```
(lldb) po myView
(UIView *) $7 = 0x07d81080 <MyView: 0x7d81080; frame = (0 119; 768 885); layer = <CALayer: 0x7d81b70>> 
```

这听起来像是 LLDB 本身的一个非常明显的错误。

更新 2：

进一步研究：看起来所有的类属性都是错误的！列表中的第一个属性显示 LLDB 中的 nil 值，所有其他属性显示在它之前合成的值。

这可能是一个奇怪的配置错误吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T04:06:17.643

确保您的 Build Configuration 设置为 Debug 而不是 AdHoc、Release 或其他去除调试符号或不允许在权利文件中进行调试的东西。

这让我很生气，因为在为我的设备创建临时构建后，我忘记将配置切换回调试。奇怪的是，大多数应用程序都能正常工作，但某些堆栈帧会默默地、莫名其妙地失败，所有变量（包括`self`）要么为零，要么被破坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:20:54.780

```
frame variable -o myView 
```

在“检查堆栈帧状态”标题下[有更多信息。](http://lldb.llvm.org/tutorial.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T12:23:00.387

解决方案似乎是：尝试使用调试器时避免在模拟器中进行测试。一旦我开始在设备上进行测试，所有的疯狂都消失了，它开始按预期工作。如果我回到模拟器，我会再次看到相同的错误。属性和方法变量似乎在模拟器中都有问题。

# php - 如何设置“mac”的读取文件权限类似于PC的右键单击

> ID：10252911
> 
> 赞同：0
> 
> 时间：2012-04-20T20:11:12.283
> 
> 标签：php, mysql, permissions

我在 Mac 上本地工作并尝试为自己设置权限。我找到了右键单击文件夹并选择“属性”的教程，但这是针对 PC 的，包括教程。它非常简单，你可以从这个链接中看到（如果是 PC） [http://www.html.net/tutorials/php/lesson16.php](http://www.html.net/tutorials/php/lesson16.php)

**但是mac呢？**我已经搜索过，但我发现的是复杂的许可。**为什么不能像右键单击 PC 而不是 mac 一样简单**。我会很感激一个更简单的方法。

我有一个名为 TEXT 的文件夹，我只想允许只读权限。

我已经编写了一个 php，但我在 MAMP 上看不到任何东西作为本地主机？我正在使用mac。

```
 <html>
 <head>
 </head>
 <body>

 <?php
 $file=fopen("text/readonly.txt","r"); or exit("Unable to open file!"); 
 //Output a line of the file until the end is reached
 while(!feof($file)) // end of file
   {
   echo fgets($file). "<br />";
   }
 fclose($file);
 ?>

 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:12:38.967

你正在寻找[`chmod`](http://en.wikipedia.org/wiki/Chmod).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:46:41.383

在 Finder 中选择对象并点击`CMD+I`。将弹出一个窗口，在底部显示文件权限。看这里：

![文件信息](../Images/da4e88eeb30c6940a62de2b16a64f706.png)

当然，它看起来不像在 PC 上。反正是Mac :) 如果你点击窗口右下角的锁，你可以解锁上面的表格，输入管理员密码后根据需要修改权限。使用`+`可以添加其他用户，使用`Lesen & Schreiben`（读取和写入）旁边的小箭头可以更改该用户的关联访问权限（例如，更改为`Lesen`（只读）。

# c++ - C++ free all memory used by struct

> ID：10252915
> 
> 赞同：8
> 
> 时间：2012-04-20T20:11:24.377
> 
> 标签：c++, class, memory, dynamic, struct

Quick question; I've googled around and found some answers already, but I'm a bit paranoid so I want to be sure.

Consider this situation:

```
struct CoordLocation
{
    float X;
    float Y;
    float Z;
};

int main()
{
    CoordLocation *coord = new CoordLocation();
    delete coord;
    return 0;
} 
```

Will calling delete also clear the memory used by the fields X, Y, Z? Some answers I found mentioned that I'd just delete the POINTER, not the actually referenced object this way. What if...

```
struct CoordLocation
{
    float *X;
    float *Y;
    float *Z;
};

int main()
{
    CoordLocation *coord = new CoordLocation();
    delete coord;
    return 0;
} 
```

And what if I manually free the memory for each object inside the struct's constructor/destructor?

```
struct CoordLocation
{
    CoordLocation()
    {
         *X = new float;
         *Y = new float;
         *Z = new float;
    }
    ~CoordLocation()
    {
         delete X; delete Y; delete Z;
    }
    float *X;
    float *Y;
    float *Z;
};

int main()
{
    CoordLocation *coord = new CoordLocation();
    delete coord;
    return 0;
} 
```

I noticed that for a simple situation such as:

```
 float *a = new float;
   *a = 5.0f;
   printf("%f", *a);
   delete a;
   printf("%f", &a); 
```

printf would print 5.0, so the variable pointed to by a is not exactly destroyed.

So my question is: How can I reliably free (as in no memory leaks) ALL the memory used by the struct in this case?

```
struct CoordLocation
{
    float X;
    float Y;
    float Z;
};

int main()
{
    CoordLocation *coord = new CoordLocation();
    delete coord;
    return 0;
} 
```

Thanks!

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-20T20:13:47.390

You only need to `delete` memory you allocate with `new`.

> printf would print 5.0, so the variable pointed to by a is not exactly destroyed.

You're actually running into undefined behavior. Although the value is still there, the memory was released and can be reused.

So the following:

```
struct CoordLocation
{
    float X;
    float Y;
    float Z;
}; 
```

can't create a memory leak if you omit the destructor.

Your next snippet:

```
struct CoordLocation
{
    float *X;
    float *Y;
    float *Z;
};

int main()
{
    CoordLocation *coord = new CoordLocation();
    delete coord;
    return 0;
} 
```

can potentially create a memory leak, but not as it is. The following will:

```
int main()
{
    CoordLocation *coord = new CoordLocation();
    coord->X = new float();
    delete coord;
    return 0;
} 
```

Your third example

```
struct CoordLocation
{
    CoordLocation()
    {
         *X = new float;
         *Y = new float;
         *Z = new float;
    }
    ~CoordLocation()
    {
         delete X; delete Y; delete Z;
    }
    float *X;
    float *Y;
    float *Z;
};

int main()
{
    CoordLocation *coord = new CoordLocation();
    delete coord;
    return 0;
} 
```

won't create a memory leak because you free all the memory that you allocate. If you were to omit the destructor or forget to call `delete coord;`, they you'd have a memory leak.

A good rule of thumb: call a `delete` for every `new` and a `delete[]` for every `new[]` and you're safe.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:13:30.437

In this example:

```
struct CoordLocation
{
    float X;
    float Y;
    float Z;
};

int main()
{
    CoordLocation *coord = new CoordLocation();
    delete coord;
    return 0;
} 
```

The memory **is freed**. There are no leaks in that code. On the example you gave, where your struct contained pointers, as long as you free them in the destructor(as you did in your example), there will be no leaks.

In this snippet:

```
float *a = new float;
*a = 5.0f;
printf("%f", *a);
delete a;
printf("%f", &a); 
```

The value of `a` stays the same after the delete, since `delete`(ing) a pointer will only mark a memory address as "freed", it will not modify its contents. Accessing freed pointers is undefined behaviour.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:20:38.607

The pointer itself is allocated with automatic storage duration, there is nothing to free there. The struct is those three fields, which are freed when you call `delete`. You only call `delete` on something that was returned by `new`.

When you allocate something you allocate enough memory to hold it, which means enough memory to hold all of its fields (and some housekeeping memory that is implementation specific, but you don't worry about that). When you delete it you free the same amount of memory that you allocated.

One thing to note however is a case like this (in C++ you wouldn't create a type like this, but the example is relevant):

```
struct Foo {
    char *str;
};

Foo *f = new Foo();
f->str = new char[10];

delete f; 
```

In this case you have a leak. You delete `f`, which consists of enough memory to hold a single `char*`, but what that `char*` points to has been dynamically allocated as well. So, you need to free it too:

```
delete f->str;
delete f; 
```

Again, in C++ you would probably not design a type this way, instead favoring types like `std::string` and principles such as RAII, but the example is relevant.

# javascript - jQuery：触发器不会在使用 .load() 加载的元素上触发

> ID：10252918
> 
> 赞同：2
> 
> 时间：2012-04-20T20:11:45.863
> 
> 标签：javascript, events, triggers, jquery

我有 index.php 并使用 jQuery .load() 从 load.php 加载内容。

当我在 index.php 中的元素上触发事件时，该事件就会触发。在相同的元素上，当使用 .load() 加载到 index.php 时，事件不会触发！？

为什么？我做错了吗？

如果我使用例如 FireBug 预览页面，则元素的#id 与它应有的完全一样，但即使是这样的函数也不起作用：

```
$('#clickme').click(function() {
    alert('hello');
}); 
```

如果元素放置在 index.php 中并且没有使用 .load() 加载，则相同的功能可以工作。有任何想法吗？？

非常感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:15:09.573

Using`click`将在元素被调用时创建一个事件监听器。如果该元素当时不存在，`click`则不会创建侦听器。您需要使用事件委托`on`（或`delegate`在旧版本的 jquery 中）。

查看[on 文档](http://api.jquery.com/on/)并阅读有关委派的信息。你需要这样的东西：

```
$("<selector of static ancestor>").on("click", "#clickme" , function(){}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T20:18:45.467

`click`事件绑定器不会绑定到执行后创建的任何元素。您可以在该方法之后立即添加一个`click`侦听器`.load()`，或者您可以使用类似`live`或`delegate`绑定到 DOM 中的元素模式。

# coldfusion - 如何从coldfusion创建受保护的excel文档

> ID：10252921
> 
> 赞同：0
> 
> 时间：2012-04-20T20:11:51.067
> 
> 标签：coldfusion, cffile

我正在从coldfusion创建一个excel文件。也就是说，使用 html 输出并将其转换为 .xls 格式。这个想法是动态创建一个 excel 文件，将其附加到电子邮件中并将其发送给用户。然后，用户将填写所需的单元格并通过电子邮件将文件发回。

我能够创建文件、应用 css、应用公式等等。问题是我们想让这个文件受到保护。也就是说，我们不希望用户能够更改公式字段。一旦我在保护模式下创建了文件，我就可以使用“mso-protection:locked visible”轻松地将所有公式单元格设置为“锁定”，并将所有其他单元格设为解锁。

所以我的问题是：如何创建一个默认受保护的动态 excel 文件。它可能受密码保护，也可能不受密码保护，但所有锁定的单元格都应该是只读的。

注意：我也尝试使用创建文件来实现此功能，但我也找不到答案。

帮助表示赞赏。谢谢。

# java - 无法在 FOPTransformer 中包含 Arial 字体

> ID：10252926
> 
> 赞同：1
> 
> 时间：2012-04-20T20:12:05.207
> 
> 标签：java, alfresco, truetype, apache-fop

我正在开发一个具有某些表单的应用程序，然后使用 FOP 创建 pdf 文件。生成的 PDF 文件使用 Time New Roman 字体，但我希望它们使用 Arial 字体。我在 projectName->fonts->arial.ttf 中添加了 arial.ttf，如此处[所述](https://web.archive.org/web/20150525132108/http://www.publicstaticfinal.de/2011/01/26/fop-embedding-fonts-from-classpath/)。

这个 ttf 和代码必须进入 alfresco amp 文件，但现在我还没有将它添加为 arial.ttf 的 jar 文件，因为我不知道如何只用 .ttf 文件制作一个 jar 文件，这就是我为实现这一目标所做的但是pdf仍然是新罗马的时代：fopconfig：

```
<fop version="0.94">
 <base>./</base>
 <font-base>./</font-base>
 <renderer mime="application/postscript">
 <fonts>
        <font kerning="yes" embed-url="/fonts/arial.ttf" encoding-mode="auto">
            <font-triplet name="Arial" style="normal" weight="normal" />
        </font>
    </fonts>
   </renderer>
</fop> 
```

创建类文件如下：

```
import java.io.InputStream;
import javax.xml.transform.Source;
import javax.xml.transform.TransformerException;
import javax.xml.transform.URIResolver;
import javax.xml.transform.stream.StreamSource;

public class ClasspathUriResolver implements URIResolver
{

  public Source resolve(String href, String base) throws TransformerException
  {
    Source source = null;
    InputStream inputStream = ClassLoader.getSystemResourceAsStream(href);
    if (inputStream != null)
    {
      source = new StreamSource(inputStream);
    }
    return source;
  }
} 
```

这是我的 FOPTransformer 代码的一部分：

```
 FopFactory fopFactory = FopFactory.newInstance();
     FOURIResolver uriResolver = (FOURIResolver)fopFactory.getURIResolver();
     uriResolver.setCustomURIResolver(new ClasspathUriResolver());
     FOUserAgent foUserAgent = fopFactory.newFOUserAgent(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T14:49:18.587

我认为您需要在创建 FopFactory 时加载字体配置，请参阅[http://xmlgraphics.apache.org/fop/1.0/embedding.html#config-external](http://xmlgraphics.apache.org/fop/1.0/embedding.html#config-external)

但是，如果您在 XSL-FO 文件中将“sans-serf”指定为字体系列，FOP 将默认使用 Arial 字体。

# linux - 如何在 centos 6.2 上安装最新的 gcc 4.7.0？

> ID：10252930
> 
> 赞同：5
> 
> 时间：2012-04-20T20:12:28.967
> 
> 标签：linux, gcc, centos

```
[root@localhost dyliu]# yum list gcc
Loaded plugins: fastestmirror, refresh-packagekit, security
Loading mirror speeds from cached hostfile
 * base: centos.mirrors.tds.net
 * extras: centos.mirrors.tds.net
 * rpmforge: apt.sw.be
 * updates: mirror.ubiquityservers.com
Installed Packages
gcc.i686                    4.4.6-3.el6                    @anaconda-CentOS-201112130233.i386/6.2 
```

默认情况下，如果我运行`yum install gcc`，yum 工具将为我安装 gcc 4.4.6。

Question> 如何在centos 6.2上安装最新的gcc [4.7.0 ？](http://gcc.gnu.org/)

谢谢

# jquery - JQuery 选择器上的部分匹配

> ID：10252932
> 
> 赞同：0
> 
> 时间：2012-04-20T20:12:42.303
> 
> 标签：jquery

要获取`<td>`以“ELEC ...”开头的所有元素文本，我正在做 -

```
$('td.id').each(function(){
    if ($(this).text().indexOf('ELEC') == 0) {}
}); 
```

有没有更简单的方法来做到这一点，比如`$('td.id:contains("ELEC*")')`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T20:18:00.430

要仅获取以 ELEC 开头的元素，请使用该`.filter`方法。

```
$("td.id").filter(function(){
    return /^ELEC/.test($(this).text());
}); 
```

或者稍微高效一点

```
var $collection = $("td.id");
$collection.filter(function(i){
    return /^ELEC/.test($collection.eq(i).text());
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T20:14:52.647

看起来你就是这样做的（我删除了通配符星号，因为它不需要。）：

```
$('td.id:contains("ELEC")') 
```

[http://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:34:58.180

似乎如果我们结合几个不同提案中最好的，我们会得到更快的结果，因为这里并不真正需要正则表达式：

```
$("td.id").filter(function() {
    return ($(this).text().substr(0, 4) == "Elec");
}).whateverMethodYouWant(); 
```

或者更快一点，使用更少的 jQuery：

```
$("td.id").filter(function() {
    return ((this.textContent || this.innerText).substr(0, 4) == "Elec");
}).whateverMethodYouWant(); 
```

# wcf - WCF 在反序列化期间使用服务器上的代理对象

> ID：10252935
> 
> 赞同：1
> 
> 时间：2012-04-20T20:12:56.470
> 
> 标签：wcf, c#-4.0, dynamic-proxy

我正在尝试跟踪 WCF 中 PUT 请求的更改属性（我们正在执行 REST 而不是 SOAP）。我有一个想法，我正在尝试审查，但我无法通过这一点。

在请求传入的某个时刻，主体（JSON、XML 等）被反序列化为一个对象，该对象稍后将传递给我们的 WCF 服务方法。

即在某些时候，WCF 必须做类似这样的事情

```
User u = new User();
u.FirstName = ...
u.LastName = ...
u.Email = ... 
```

我想更改第一行，以便从代理生成器（如`Castle.DynamicProxy`）中检索 User 对象：

```
User u = _proxyGenerator.NewObject<User>();
u.FirstName = ...
u.LastName = ...
u.Email = ... 
```

有谁知道这是否可能？也许我必须制作自己的反序列化器？

# php - Zend 框架：如何从视图中调用动作？

> ID：10252949
> 
> 赞同：0
> 
> 时间：2012-04-20T20:14:17.513
> 
> 标签：php, zend-framework

当我尝试从视图脚本调用操作时，我遇到了 Action View Helper 的问题。该视图位于 /views/scripts/home 中，它属于 HomeController，我想从 BookController 访问一个操作。

在我看来，我有以下代码：

```
foreach ($this->books as $book) {

    if (!empty($book['asin'])) {     
        $bookObj = $this->action('get-book-by-asin', 'book', null, 
                                 array('asin' => $book['asin'])); 
```

在 getBookByAsinAction() 我想返回一个 $data 变量。如何将其作为对 Action View Helper 调用的响应发回？

我现在可以通过控制器中的 $books 变量进行*foreach*操作，而不是在我的视图中进行操作，但我只是好奇。或者，也许在将来，当特定操作可以生成更有用的可重用内容或“小部件化”内容时，我将使用 Action View Helper。

如果我从数据库查询中得到很多行，那么只做一个 foreach 而不是两个会更好吗？一个 foreach 将在 View 中，以正确呈现结果，我应该考虑在 Controller 中执行另一个 foreach 以检查一本书是否有 ASIN，然后调用例如 Web 服务。这是最佳解决方案吗？

还是按照描述的方式使用 Action View Helper 更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:55:03.360

您可以创建一个新的操作助手，然后在您的视图中使用操作助手代理调用它：

假设您创建了一个名为 getBookByAsin 的操作助手：

在代码视图中：

```
$gbba= Zend_Controller_Action_HelperBroker::getStaticHelper('getBookByAsin');

$var = $gbba->direct("asin"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T07:02:23.653

我的解决方案是用以下行结束 getBookByAsinAction()：`$this->_response->setBody(json_encode($data));`并在我的视图中`$book = (array) json_decode($bookObj);`

我没有为此操作创建 get-book-by-asin.phtml 视图，所以我添加了`$this->_helper->viewRenderer->setNoRender();`

# wolfram-mathematica - 在 Mathematica 中读取数据文件时如何转到 EndOfFile？

> ID：10252953
> 
> 赞同：4
> 
> 时间：2012-04-20T20:14:38.627
> 
> 标签：wolfram-mathematica

我有一个正在读入 Mathematica 的数据文件。现在，问题是在文件末尾提到了数据文件中的重要信息。我需要先使用 Mathematica 阅读最后一行。不同数据文件的行数不同，否则我会使用 Skip 命令到达最后一行。您能否让我知道是否有命令/例程可以做到这一点？谢谢。dbm368

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T16:20:09.190

如果你知道最后一行的长度，你可以这样做：

```
str = StringToStream["abcdefg \n123456"]
eof = SetStreamPosition[str, Infinity]
SetStreamPosition[str, eof - 6]
Read[str, String]
(*
->
InputStream[String, 43]
15
9
123456
*) 
```

# jsp - 如何将 jsp 文件中的属性发送到 liferay 中的操作方法？

> ID：10252957
> 
> 赞同：0
> 
> 时间：2012-04-20T20:14:52.820
> 
> 标签：jsp, liferay

我的 jsp 文件包含以下代码：

```
<portlet:actionURL var="patientProfileURL" name="editPatientProfile">
<portlet:param name="jspPage" value="/patientProfile.jsp" />
</portlet:actionURL> 
<p><a href="<%= patientProfileURL%>">Edit Profile</a></p> 
```

当用户单击“编辑配置文件”时，我想向 editPatientProfile() 发送一个参数。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:51:50.720

我不完全确定我理解你的问题，因为你已经在传递一个参数。在您正在构建的 URL 中。同样，您需要添加`<portlet:param name="" value="" />`.

就是这样！

请参阅下面的示例：

```
<portlet:actionURL var="patientProfileURL" name="editPatientProfile">
    <portlet:param name="jspPage" value="/patientProfile.jsp" />
    <portlet:param name="myParam" value="myValue" />
</portlet:actionURL> 
<p><a href="<%= patientProfileURL%>">Edit Profile</a></p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-24T10:41:17.837

你可以这样做：

```
String url="/patientProfile.jsp?urParameter"+urParameterValue;

<portlet:actionURL var="patientProfileURL" name="editPatientProfile">
<portlet:param name="jspPage" value="/patientProfile.jsp" />
<portlet:param name="myParam" value="<%=url%>" />

<p><a href="<%= patientProfileURL%>">Edit Profile</a></p> 
```

# iphone - 向 Xcode 4.3 添加声音

> ID：10252959
> 
> 赞同：2
> 
> 时间：2012-04-20T20:15:02.740
> 
> 标签：iphone, ios, audio, avaudioplayer

我看过很多教程，但它们都太混乱或过时了。如何向 Xcode 4.3 添加声音？如果那里有一个很好的教程，你可以给我看。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:23:25.727

这是一个**非常**模糊的问题。我也相当确定（通过查看 iPhone 标签）您不想向 Xcode 添加声音，而是想在 iPhone 应用程序中播放声音。

如果您确实想为您的 Xcode 项目添加声音，那么您可以将音频文件拖到您的项目中或通过菜单将其导入。

如果你想播放音频，那么你应该使用[AVAudioPlayer](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)。[这里](http://mobileorchard.com/easy-audio-playback-with-avaudioplayer/)的本教程几乎可以解释得既简单又好，所以我没有必要重新措辞。只要看看，你应该很好。

本教程甚至提供了示例代码。

# objective-c - Objective-C/Xcode - 作为用户类型的密码检查

> ID：10252961
> 
> 赞同：1
> 
> 时间：2012-04-20T20:15:05.580
> 
> 标签：objective-c, events, textbox, keystroke

当用户在键入时匹配两个文本字段时，我很乐意做一些事情来在视觉上奖励用户。这是 jQuery 风格的，我不确定在 Objective-C/Xcode 中是否可行。这里的关键是“按他们的类型”。当密码/确认密码（主要是因为安全字段格式••••••）或电子邮件/确认电子邮件表单字段匹配时，一些基于 Web 的用户帐户设置表单会显示一个绿色复选框，如果密码丢失，则会变成红色“X”他们的比赛。

有什么类似于 Objective-C/Xcode 中的 onKeystroke 事件吗？

我愿意研究和学习这个。我只是不知道如何正确引用此类功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:28:25.900

您可以只观察文本字段的值，然后在回调中执行您的逻辑：

```
[self.textField1 addTarget:self action:@selector(textChanged:) forControlEvents:UIControlEventValueChanged];
[self.textField2 addTarget:self action:@selector(textChanged:) forControlEvents:UIControlEventValueChanged];

- (void)textChanged:(UITextField *)sender
{
    if ([self.textField1.text isEqualToString:self.textField2.text])
    {
        // passwords match
    }
    else
    {
        // passwords don't match
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:22:22.290

你想要的一切都在这里[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/EventOverview/HandlingKeyEvents/HandlingKeyEvents.html#//apple_ref/doc/uid/10000060i-CH7-SW1](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/EventOverview/HandlingKeyEvents/HandlingKeyEvents.html#//apple_ref/doc/uid/10000060i-CH7-SW1)

您正在寻找的是在您的文本视图中实现以下内容并缓冲击键并将它们与您的文本字段进行比较。

```
- (void)keyUp:(NSEvent *)theEvent 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-09T17:32:46.663

在每个字符后检查可能会消耗过多的网络服务器带宽，请在用户停止输入 1.4 秒后尝试“计时器”检查。

```
@property IBOutlet NSSecureTextField *txtPassword;
@property NSThread *syncPasswordTimer;

- (void)awakeFromNib
{
    [super awakeFromNib];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(passwordType) name:NSControlTextDidChangeNotification object:txtPassword];
}

    - (void)passwordType
    {
        [syncPasswordTimer cancel];
        syncPasswordTimer = [[NSThread alloc] initWithTarget:self selector:@selector(passwordTimer) object:nil];
        [syncPasswordTimer start];
    }

    - (void)passwordTimer
    {
        [NSThread sleepForTimeInterval:1.4f];

        if([[NSThread currentThread] isCancelled])
        {
            [NSThread exit];
        }else{
            NSLog(@"'%@'",txtPassword.stringValue);
            //DO THE CHECKING
        }
    } 
```

# linux - 在 tarring 时消除目录层次结构

> ID：10252965
> 
> 赞同：0
> 
> 时间：2012-04-20T20:15:31.100
> 
> 标签：linux, tar

```
$ tar -zcvf archive/test.tar.gz files 
```

会给我如下：

```
files/
files/1
files/2
files/3 
```

--

```
$ tar -zcvf archive/test.tar.gz -C files . 
```

会给我如下：

```
./
./1
./2
./3 
```

我无法找出正确的 tar 命令输出如下。

```
1
2
3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:22:16.960

您使用该`--transform`选项，该选项采用 sed 表达式。

```
--transform="s/^\.\///" 
```

应该有预期的效果。

**编辑**糟糕，看起来这会在 tar 存档中留下一个前导的 './' 条目，这可能是不可取的。使用@paulsm 的答案可能更简单，但它可能会错过隐藏文件（以 . 开头的文件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:17:58.230

就个人而言，我只是：

```
cd files
tar -zcvf /full-path/archive/test.tar.gz * 
```

# php - $_GET 和 $_POST 可以在同一个页面上使用吗？

> ID：10252968
> 
> 赞同：0
> 
> 时间：2012-04-20T20:15:45.520
> 
> 标签：php, post, get

我正在使用这两行代码：

```
$event  = $_GET['event'];
$email1 = $_POST['e_email']; 
```

在我的脚本中，但我总是收到一条错误消息：

```
Undefined index: event in C:\xampp\htdocs\mysql\trial_rsvp.php on line 15 
```

问题出在哪里？

如果需要，请索取完整代码！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:19:43.910

该错误是为访问未在数组中定义的索引而生成的通知。

例如，如果`$_GET['event']`没有设置，当你尝试访问它的值时，它会生成一个通知。

您可以通过更改`error_reporting`配置来忽略通知，`php.ini`甚至更好，使用类似`empty`or的函数`isset`来确保定义了索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:28:29.437

尝试

```
$event = isset ( $_GET ['event'] ) ? $_GET ['event'] : null;
$email = isset ( $_POST ['e_email'] ) ? $_POST ['e_email'] : null; 
```

这将帮助您设置默认值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:17:54.080

如果您的 URI 中没有`?event=something`或类似的，您会收到通知，因为 $_GET 数组中不会定义该索引。使固定：

```
if (!empty($_GET['event'])) {
    $event =$_GET['event'];
} 
```

# c# - 将 XML 直接写入磁盘并附加元素

> ID：10252974
> 
> 赞同：3
> 
> 时间：2012-04-20T20:16:41.027
> 
> 标签：c#, xml, c#-4.0, file-io, xmlwriter

我正在尝试编写一个 XML 文件，但它太大而无法存储在内存中，因此我想直接将其写入磁盘。我曾尝试使用 XmlWriter，但没有使我能够附加到文件末尾的功能，因此我愿意求助于使用常规文件编写器编写 XML 原始文件。

有谁知道任何使我能够直接写入磁盘并且使我能够覆盖文件内的位置的文件写入类？

原因是我需要能够覆盖根元素的关闭，以便我可以附加另一位信息，而且还能够在需要时读取 XML 文件。例如，如果我有以下 XML：

```
<elements>
  <element>
  </element>
</elements> 
```

如果我想读这个，我可以，但如果我想写它，我必须先删除`</elements>`标签，附加另一个元素，然后再次附加结束标签。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:47:44.440

您**可以**使用 XmlTextWriter。

只需打开文件进行写入，返回到结束元素的开头，然后使用 XmlTextWriter 附加您想要的任何新元素。要关闭文件，只需为 end 元素编写原始文本以使文档完整，然后您就完成了。

这是一个快速而肮脏的例子。

像这样从 XML 开始：

```
<?xml version="1.0" encoding="utf-8"?>
<DocumentElement>
    <FirstElem/>
</DocumentElement> 
```

您可以打开它并附加这样的元素：

```
using (FileStream f = new FileStream(@"D:\a.xml", FileMode.OpenOrCreate, FileAccess.Write))
{
    f.Seek(-("</DocumentElement>\n".Length), SeekOrigin.End);
    using (XmlTextWriter x = new XmlTextWriter(f, Encoding.UTF8))
    {
        x.WriteStartElement("Another");
        x.WriteAttributeString("attr", "value");
        x.WriteEndElement();

        // Close the file with a new terminating end-element
        x.WriteRaw("\r\n</DocumentElement>\r\n");
    }
} 
```

结果是：

```
<?xml version="1.0" encoding="utf-8"?>
<DocumentElement>
    <FirstElem/>
<Another attr="value" />
</DocumentElement> 
```

您可能无法获得完美的缩进等，但它是有效的 XML。如果将 xml 作为原始文本写入文件，这正是您要做的 - 但您也可以利用 XML 编写器为您进行格式化。

我也同意一些评论 - 为您的 xml 使用最小化大小的模式将非常有益。关闭缩进。尽可能使用最短的元素和属性名称。如果您正在处理叶子元素，将数据存储为属性而不是 cdata 将节省空间（`<element>data</element>`比它更昂贵，`<element val="data"/>`并且可以进一步压缩到`<e v="data"/>`- 几乎是原始大小的一半）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:22:41.363

我假设（正如@payo 的评论所建议的那样）您可以使用文件流、[XmlTextReader](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.aspx)（将流定位在适当的元素处）和[XmlWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)的组合来编写新元素，然后重新编写结束元素。

# swing - 根据其他面板中的选择重置或重新加载卡片布局中的 JPanel 内容

> ID：10252976
> 
> 赞同：1
> 
> 时间：2012-04-20T20:17:00.357
> 
> 标签：swing, jpanel, wizard, cardlayout

我正在使用卡片布局来创建一系列面板。

我创建了一个 JFrame 类。并对该框架类的实例，获取contentPane并设置CardLayout。将所有面板添加到此 contentPane。

```
public class JFrameClass1234 extends javax.swing.JFrame {
public static JFrameClass1234 jFrameInstance1234;
public static JPanelFirstScreen jPanelFirstScreen;
public static JPanelSecondScreen jPanelSecondScreen;
public static JPanelThirdScreen jPanelThirdScreen;
public static JPanelFourthScreen jPanelFourthScreen;
public static JPanelFifthScreen jPanelFifthScreen;

public static void main(String args[]) {

java.awt.EventQueue.invokeLater(new Runnable() {

        public void run() {

           jFrameInstance1234 = new JFrameClass1234();

           jPanelFirstScreen = new JPanelFirstScreen();
           jPanelSecondScreen = new JPanelSecondScreen();
           jPanelThirdScreen = new JPanelThirdScreen();
           jPanelFourthScreen = new JPanelFourthScreen();
           jPanelFifthScreen = new JPanelFifthScreen();

           final Container pane = jFrameInstance1234.getContentPane();
           pane.add(jPanelFirstScreen,card1);
           pane.add(jPanelSecondScreen,card2);
           pane.add(jPanelThirdScreen,card3);
           pane.add(jPanelFourthScreen,card4);
           pane.add(jPanelFifthScreen,card5);
           CardLayout cl = (CardLayout)(pane.getLayout());
           cl.show(pane, card1);
           jFrameInstance1234.setVisible(true);
           }
      });
  } 

}//end of class 
```

现在，我可以通过在每个面板的“下一步”或“后退”按钮操作侦听器中调用以下方法来在面板之间移动：

```
//For going back to previous panel
private void gotoPreviousPanel() {
final Container pane = JFrameClass1234.jFrameInstance1234.getContentPane();
CardLayout cl = (CardLayout) (pane.getLayout());
cl.show(pane, JFrameClass1234.card1);
JFrameClass1234.JFrameinstance1234.setVisible(true);
}

//For going to next panel
private void gotoNextPanel() {
    final Container pane = JFrameClass1234.jFrameInstance1234
            .getContentPane();
    CardLayout cl = (CardLayout) (pane.getLayout());
    cl.show(pane, JFrameClass1234.card3);
    JFrameClass1234.jFrameInstance1234.setVisible(true);
} 
```

但是当我在面板之间移动时，值会保留（不会重置或重新加载）。当我在面板之间来回移动时，我想重置或重新加载面板。或者说第二个面板中的“文本框”在显示时应始终重新加载，具体取决于在第一个面板中选择的“组合框”选项。有人可以帮我实现这个吗？？？

对于这种情况，我必须遵循的理想设计（逻辑）是什么？有没有针对我的具体情况的文件？我使用卡片布局的方式是否正确？否则推荐我正确的设计。

谢谢，钱德拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:05:33.153

您可以声明一个具有属性的**Singleton**类（来自您拥有的不同 UI 面板）。此外，使用方法 updateUIFields()声明一个**接口，并让所有面板实现此接口。**在一个面板（当前显示的面板）中更新字段时更新单例对象。在切换到卡片中的不同面板之前，根据您存储在单例对象中的选择/值重新加载或重置。在接口方法中实现这个逻辑。如果需要，重置 Singleton 对象中的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-02T16:53:27.033

您可以尝试将祖先Listener() 添加到正在刷新的 JPanel 组件中。

# php - javascript 文件返回一个我不确定的错误日志

> ID：10252980
> 
> 赞同：0
> 
> 时间：2012-04-20T20:17:20.690
> 
> 标签：php, javascript, jquery

我的一个 javascript 文件在以下行返回错误日志

```
if(strinput.indexOf('<?')>-1||strinput.indexOf('!xml')>-1||strinput.indexOf('xml')>-1) 
```

错误是

```
[20-Apr-2012 14:06:32] PHP Parse error:  syntax error, unexpected '!'
in /home6/mywebsite/public_html/phpspellcheck/include.js on line 295 
```

但如果我删除 ! 错误更改为

```
[20-Apr-2012 14:15:40] PHP Parse error:  syntax error, unexpected T_STRING in 
/home6/mywebsite/public_html/phpspellcheck/include.js on line 295 
```

任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:19:45.107

这是因为服务器将文件解释为 PHP（这是无效的 PHP 语法），而不是按原样将它们发送给客户端以被解释为 JavaScript。

# google-maps-api-3 - 动画后标记消失

> ID：10252982
> 
> 赞同：2
> 
> 时间：2012-04-20T20:17:22.390
> 
> 标签：google-maps-api-3, markerclusterer

我使用带有标记聚类器 v3 的谷歌地图 v3 来显示 1000 个标记。我还有一个侧面板，列出了每个标记的标题。当用户将鼠标悬停在面板中的标题上时，我会为相应的标记设置动画，并在鼠标悬停时停止动画。

当标记不在集群中时，这可以正常工作。当标记在集群中时，我遇到了问题。

如果标记在群集中，我首先将标记的地图对象从 null（之前由 markerClusterer 设置，以便在将标记放入群集后隐藏标记）更改为我的地图对象，然后为标记设置动画。同样，这有效。我遇到问题是在mouseout上。

在 mouseout 上，我将标记动画设置为 null，然后将标记的地图对象设置为 null。这符合您的预期（隐藏标记），但我无法让标记在任何后续悬停事件中再次显示。标记仍然存在于适当的集群对象中，我可以调用 setMap() 来设置标记的地图属性，但标记仍然不会出现在地图上。以下是相关代码：

```
 if (event.type === 'mouseover' || event.type === 'mouseenter' ) {       
            if (!marker.getMap()) { //marker is in a cluster
                inCluster = true;
                marker.setMap(map)
            } else {
                inCluster = false
            };
            marker.setAnimation(google.maps.Animation.BOUNCE);
        } else {
            marker.setAnimation(null);
            if (inCluster == true) { //hide the clusterized marker
                marker.setMap(null)
            }
        }; 
```

如果我注释掉两个 setAnimation() 调用，那么代码将起作用，并且可以显示标记，然后按预期隐藏（只是没有动画）。此外，当我使用控制台时，我可以将标记从集群中显示出来，然后我可以对其进行动画处理，然后我可以对其进行取消动画处理，然后我可以一遍又一遍地再次隐藏它。但是，如果我在取消标记动画之前调用 setMap(null)，那么我遇到了我的错误。

因此，只有在调用 setMap(null) 之前动画没有停止时，才会出现问题。我尝试设置一个计时器，让动画在调用 setMap 之前停止几百毫秒，这有时会起作用，但有时它会触发其他甚至更糟糕的行为。

任何解决此问题的帮助将不胜感激（并热切接受）！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T05:11:15.490

I've been experiencing thr same issue. It's a new bug in the API. I plan on using my enterprise account to create a case once I have a simple reproducable example.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:34:10.023

这是一个丑陋的黑客，但它可能适用于你的情况：

```
marker.setAnimation(null);

if (inCluster == true) { //hide the clusterized marker
  while(marker.getAnimation()) ; // loop blindly until setAnimation sets to null
  marker.setMap(null)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-08T22:01:54.100

当我在有很多标记的地图上执行 fitBounds() 然后尝试为其中一个标记设置动画时，我遇到了同样的问题 - 标记就消失了。我尝试了一切-设置超时，将其放入“空闲”侦听器中-但没有任何效果。即使超时，只要我调用 setAnimation()，标记就会消失。

这是一个非常讨厌的，hacky 修复，但在玩了很长时间后，我发现如果你手动移动地图，标记会重新出现。因此，如果您使用以下方法进行模拟：

```
map.panBy(1, 1) 
```

...在你反弹之后，标记会重新出现（至少对我来说）。无论如何，如果它立即跟随 fitBounds() ，则 1 像素的移动并不是很明显。

所以我的代码是这样的：

```
map.fitBounds(new_bounds);

google.maps.event.addListenerOnce(map, 'idle', function(){
    the_marker.setAnimation(google.maps.Animation.BOUNCE);
    map.panBy(1, 1)
}); 
```

也许它会帮助某人！

# outlook - Outlook iCalendar 任务导入/导出

> ID：10252983
> 
> 赞同：1
> 
> 时间：2012-04-20T20:17:35.217
> 
> 标签：outlook, task, icalendar, msg

我正在尝试将 Outlook 2010 的任务项写入 iCalendar 文件，以便导入 Outlook。

我查看了 Outlook 的 MS-OXCICAL 和 MS-OXCMSG（日历和消息）的规范，似乎它们提到了导入/导出任务的能力。问题是，唯一提到的是在简介中，实际上没有解释语法或如何将任务项存储在 ICS 或 MSG 文件中。

在进行更多研究后，VTODO 过去曾用于任务项目，据我所知似乎不再受支持。

任何有关此主题的指导或帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T16:39:50.537

规范描述了*您的*代码需要如何处理 iCal/vTodo 数据以确保 Outlook/Exchange 满意。

您可以自己编写代码，也可以使用[Redemption](http://www.dimastr.com/redemption/)和[RDOMail](http://www.dimastr.com/redemption/RDOMail.htm)对象 - 它的 SaveAs 方法允许以 iCal 和 vTodo 格式（以及其他格式）导出 Outlook 项目，而 Import 方法允许将 iCal 和 vTodo 文件导入 Outlook。

# android - 运行方式 > Android 应用程序运行以前的应用程序，而不是当前的应用程序

> ID：10252984
> 
> 赞同：0
> 
> 时间：2012-04-20T20:17:37.823
> 
> 标签：android, eclipse

我创建了一个新项目。当我右键单击项目文件夹并选择 run-as... 时，模拟器会运行我正在处理的上一个项目。知道为什么会发生这种情况吗？

# symfony - Symfony2 ACL 检查总是返回 FALSE

> ID：10252987
> 
> 赞同：0
> 
> 时间：2012-04-20T20:17:48.213
> 
> 标签：symfony, acl, role

## 解决方案

好吧，这就是我使用有点旧的 Symfony2 版本（2.0-RC6）时得到的结果。似乎有一个错误`__construct`（`RoleSecurityIdentity`在 10 年 12 月报告）。

而不是`instance of Role`应该是`instance of RoleInstance`.

我可能应该关闭这个问题......

* * *

我对整个`ACL`概念很陌生，`Symfony2`但我了解它背后的基础知识。昨晚我试图让下一个场景工作：

我有 2 个用户角色 ( `ROLE_GROUP1`, `ROLE_GROUP2`)，我想为其中一个组设置**对象级别** `ACL`。如果用户`ROLE_GROUP1`已登录，则应将此角色放入`ACE`，否则应放入`ROLE_GROUP2`。

到目前为止，我编写了这段代码（实际上与官方文档几乎相同）：

```
$role = $this->getRole(); // returns ROLE_GROUP1 role object

$acl_provider = $this->get('security.acl.provider');

$objIdentity = ObjectIdentity::fromDomainObject($object); // my object

$acl = $acl_provider->createAcl($objIdentity);

$securityIdentity = new RoleSecurityIdentity($role->getRole()); // Role based identity

$acl->insertObjectAce($securityIdentity, MaskBuilder::MASK_OWNER);
$acl_provider->updateAcl($acl); 
```

据我了解，这应该将所有权限授予具有`ROLE_GROUP1`角色的用户。我错了吗？

为了检查权限，我使用了这段代码（同样，来自官方文档）：

```
$context = $this->get('security.context');

if ( false === $context->isGranted("EDIT", $object) ){
    throw new AccessDeniedException();
} 
```

...但它**总是**失败（即引发异常）。

我查看了 ACL 表，就我所见，一切似乎都很正常。

我对 RoleSecurityIdentity 做错了吗？有没有办法实现这种情况？

任何帮助将非常感激！

# 编辑

我刚刚深入研究了 Symfony 的代码，发现权限授予`equals`在`RoleSecurityIdentity`.

```
if (!$sid instanceof RoleSecurityIdentity) {
    return false;
}

/** I ADDED THIS IF CHECK TO SEE WHAT DOES IT COMPARE WITH **/
if ( $this->role->getName() == "ROLE_GROUP1" ){
    die("<pre>" . print_r($sid->getRole(),1) . "</pre><pre>" . print_r($this->role,1) . "</pre><pre>" . print_r($this->role === $sid->getRole(),1) . "</pre>");
}

return $this->role === $sid->getRole(); 
```

原来`$sid->getRole()`是`string`“ **ROLE_GROUP1** ”，**而是 ROLE_GROUP1**角色`$this->role`的`Role`对象。

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:13:04.833

只是将此问题标记为已解决。

* * *

## 解决方案：

好吧，这就是我使用有点旧的 Symfony2 版本（2.0-RC6）时得到的结果。RoleSecurityIdentity 的 __construct 似乎存在错误（在 10 年 12 月报告）。

而不是 Role 的实例，它应该是 RoleInstance 的实例。

我可能应该关闭这个问题......**

# java - 从多个线程中读取一个 java.util.arrayqueue

> ID：10252991
> 
> 赞同：0
> 
> 时间：2012-04-20T20:17:56.280
> 
> 标签：java

问题，一个进程程序的多个线程可以从一个静态 java.util.arrayqueue 顺序读取？如果一个进程程序的三个线程正在运行并且三个数据对象到达数组队列，每个线程将处理一个数据对象或只有一个线程将处理所有三个数据对象

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:25:16.570

您正在描述生产者-消费者模式。

几点

*   如果您生成三个线程并且它们每个循环，读取同一个队列，那么它们都会尝试使用队列中的项目。无法保证每个线程将消耗多少项目。这完全取决于 JVM（或操作系统级别）中线程的调度程序。一般来说，如果将大量相似的项目添加到队列中，每个线程将消耗大致相同数量的项目。

*   ArrayQueue 不是这个用例的好选择，因为它不是线程安全的。更好的选择是 ConcurrentLinkedQueue 或 ConcurrentBlockingQueue

要直接回答您的问题，是的，您可以让多个线程从同一个队列中读取，但请考虑以上内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:22:30.117

通常，您希望使用同步线程来使每个线程读取 1 个输入。

要回答您的问题，无法确定这种情况下的行为。您应该强制同步线程以确保每个线程始终处于忙碌状态，而不仅仅是一个线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:28:52.297

你真的很想在这种情况下使用同步或切换到更合适的数据结构。

来自 arrayqueue 的文档：它们不是线程安全的；在没有外部同步的情况下，不支持多线程并发访问

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T20:28:59.790

假设 arrayqueue push/pop 是线程安全的，并且使用的任何信号都不会限制运行线程的数量：

取决于可用的内核数量以及线程处理数据的速度。如果有 3 个空闲内核并且排队的任务需要一些时间，则三个线程很可能同时运行这三个任务。如果任务非常短并且系统上有一些负载使得在数据提交时只有一个线程空闲，那么一个线程可能会在另一个线程可用之前竞争并执行所有三个项目。如果核心比任务少，那么显然只有 [no. of cores] 任务可以同时运行。

混合搭配这些可能性。

# regex - 为什么这个正则表达式前瞻不起作用？

> ID：10252997
> 
> 赞同：4
> 
> 时间：2012-04-20T20:18:31.930
> 
> 标签：regex, iis, url-rewriting, negative-lookahead, regex-lookarounds

我正在设计一个正则表达式以在某些 IIS Url Rewrites 中使用。目的是捕获以下网址：

1.  不只是根目录中的一个文件（通过包含句点来标识），并且
2.  不包含查询字符串，并且
3.  不属于一组特定的子目录，特别是“Account”和“Public”

我当前的正则表达式看起来像：

```
^(?!(Account)|(Public))([^./]+)(/[^?]*)?$ 
```

将[RegexPal](http://www.regexpal.com)与以下测试集一起使用：

```
file.aspx
Account/otherfile.aspx
Public/otherfile.aspx
otherfolder1/otherfile.aspx?stuff=otherstuff
otherfolder2/otherfolder/otherfile.aspx
otherfolder3/
otherfolder4 
```

我的正则表达式正确地忽略了前两种情况，但它仍然匹配第三种情况。这里的前瞻有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T22:29:03.760

我忍不住试图想出一些可以在 RegExPal 中工作的东西（没有成功 -**编辑：刚刚验证，这在 RegExpal 中确实有效**）但我想我会把它作为另一种方式来做你需要的，这可能更容易理解：

```
^(?!Account|Public|[a-zA-Z_0-9]+\.)[a-zA-Z_0-9/.]+$ 
```

解释：

```
^                   # start
(?!                 # open a negative lookahead
Account|Public|     # ignore both Account and Public
[a-zA-Z_0-9]+\.     # ignore files in root (i.e., letters/numbers, followed by period)
)                   # close negative lookahead
[a-zA-Z_0-9/.]+     # now match anything with letters/numbers, periods and slashes, but no '?' (ignores URLs with query string)
$                   # end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:40:07.647

正如[sln](https://stackoverflow.com/a/10255155/259014)所报告的那样，RegexPal 中这些测试的问题在于，运行多行测试可以使多行组合在一起以创建单个匹配，否则它们不应该匹配。

正则表达式适用于它旨在实现的目的。其实是矫枉过正。对于 IIS 重写和重定向，如果您使用[IIS URL 重写模块](http://learn.iis.net/page.aspx/460/using-the-url-rewrite-module/)，您可以选择指定它接受或不接受匹配的条件。其中一些选项包括：

*   项目不是物理文件
*   项目不是物理目录
*   项目确实（或不）匹配辅助模式

这些将比负前瞻更完全地达到预期的效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T00:36:45.193

RegexPal 很困惑，但真正的问题是正则表达式设计不正确。

不确定您要做什么，但是在使用多行模式和`^$`
正则表达式中的锚点时，除非您专门以这种方式设计，否则必须注意不要
溢出锚点。这适用于贪婪/非贪婪量词。
当将负面的前瞻条件加入混合时，情况会变得更糟。

在这种情况下，它导致 RegexPal 在`^`
没有重新评估 ^ 的情况下发疯并且显然在之前回溯。不过，这可能不是 JavaScript 问题。

在您的消费类中添加 not newline 可以解决所有问题。它必须
添加到两个类中。

```
^(?!Account|Public)[^./\n]+(?:/[^?\n]*)?$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T21:59:47.747

也许你想使用`^(?!Account|Public)([^\.\/]+\/[^\?]*)$`正则表达式。

看看这里：http: [//ideone.com/q3lAv](http://ideone.com/q3lAv)

那么正确的 RegExpal 模式将是`^(?!Account|Public)([^\.\/]+\/[^\?\n]*)$`

* * *

**[更新]**

文件名不必`.`在其名称中包含点，另一方面，文件夹/目录名称可能`.`在其名称中包含点，但如果你想在第 7 行也有一个正匹配，那么你应该使用模式`^(?!Account|Public)([^\.\/]+(?:\/[^\?]*|[^\.\?]*))$`和它也应该作为 RegExPal 模式工作。

看看这里：http: [//ideone.com/VcmEP](http://ideone.com/VcmEP)

# vb.net - VB6代码升级

> ID：10252998
> 
> 赞同：1
> 
> 时间：2012-04-20T20:18:32.630
> 
> 标签：vb.net, vb6, vb6-migration

> **可能重复：**
> [从 VB6 迁移到 .NET 的最佳策略](https://stackoverflow.com/questions/683918/best-strategy-for-moving-from-vb6-to-net)
> [Visual Basic 6.0 的转换工具比较](https://stackoverflow.com/questions/718780/conversion-tool-comparisons-for-visual-basic-6-0)

是否有任何人可以推荐将商业 VB6 应用程序转换为 VB.NET 应用程序的好工具。我发现了一些免费的和一些商业的，但找不到任何尝试并失败或尝试并成功的开发人员的评论和意见。

涉及的复杂性是什么？我知道 .NET 使用托管代码和多线程单元等，而 VB6 是基于 COM 的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:24:13.880

不要这样做。不要转换。做一个重写。对不起，即使代码可以转换，也不意味着它应该被转换。

请以更干净的代码的名义，花费资源时间来正确编写它。将此视为清理代码的机会，并利用 .Net 带来的一切......

我真的不在乎我是否在这个问题上得到负面评价。如果我说服一家公司重写而不是转换，那是值得的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T06:01:02.633

这是我对重复问题（作为 CW）的回答的副本，因为我想回复目前在此处获得最高票数的“始终重写”答案。

我的建议是不要低估转换的努力——在开始重写时要非常谨慎。乐观地开始，在修复旧架构中一些众所周知的缺陷时取得良好的早期进展，然后陷入您多年来认为理所当然的功能，这是一个常见的陷阱。在这一点上，你的管理层开始变得紧张，一切都会变得非常不舒服。

...这是微软的一篇博客文章，[有点同意我](http://blogs.msdn.com/goto100/archive/2008/11/03/rewrite-vs-migrate-vs-reuse-vs-replace.aspx)的看法：

> 我在 .NET 早期工作过的许多公司首先考虑重写，部分原因是在迁移到 .NET 的同时，他们强烈希望改进底层架构和代码结构。不幸的是，其中许多项目遇到了困难，有几个项目从未完成。他们试图解决的问题太大了......
> 
> 因此，我很快成为大多数公司的正确方法迁移或重用的粉丝。不过有趣的是，与以前相比，重写是一个风险较小的选择。许多仍然拥有重要 VB6 项目的公司现在也拥有在其他项目中获得的强大 .NET 技能、改进的软件开发实践（包括自动化测试——恕我直言，这是重写所必需的），甚至花时间重构其 VB6 代码库的元素。过去 6 年。也就是说，对于大多数公司，我仍然会将 Rewrite 置于 Migrate 或 Reuse 之下。

引用来自一个优秀的微软[网页](http://msdn.microsoft.com/en-gb/dd408373.aspx#migrate)

> 对 .NET 进行完全重写要比转换成本高得多，而且很难做好[比转换]……我们只在少数情况下推荐这种方法。

著名的 VB 专家 Dan Appleman 也[说过](http://www.danappleman.com/?p=35 "说")：

> 在大多数情况下，将 [VB6 移植到 VB.NET] 是愚蠢的，完全是浪费金钱。

乔尔不久前[说](http://www.joelonsoftware.com/articles/fog0000000069.html)：

> 任何软件公司都可能犯的最严重的战略错误[是]决定从头开始重写代码。

其他一些关于迁移的有用链接，包括指向 Microsoft 的另一本免费书籍的链接。 [一](http://msdn.microsoft.com/en-us/vbrun/ms788239.aspx)。 [二](http://blogs.msdn.com/ericnel/archive/2008/04/25/visual-basic-6-migration-to-net.aspx)。 [三](http://msdn.microsoft.com/en-us/vbrun/ms788236.aspx)。
Microsoft[页面](http://msdn.microsoft.com/en-gb/dd408373.aspx)，包括截屏视频以及他们对“如何迁移”的回答

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:31:22.580

几乎任何免费工具都可以很好地转换代码。无论您使用什么工具，您得到的结果都不是很好，因为 VB.NET 代码与 VB6 代码完全不同，尽管语法相似。即使您使用翻译工具，您也应该彻底清理代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T20:40:54.143

Visual Studio 在菜单中有一个集成的转换工具`File > Open > Convert...`。

如果您的 VB6 项目结构良好且注释良好，并且您是两种语言（VB6 和 VB.NET）的专家，您可以尝试一下，否则转换可能会成为一场噩梦。在任何情况下，您都必须在转换后手动修复许多事情。

* * *

谷歌搜索[Visual Basic 6.0 用户的语言更改](http://www.google.com/search?q=Language%20Changes%20for%20Visual%20Basic%206.0%20Users)将为您提供有用的链接，涵盖两种语言之间的差异。