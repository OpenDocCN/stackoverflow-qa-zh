# StackOverflow 问答 000699000-000699999

# wpf - WPF - 在 xaml 中使用 RibbonControlsLibrary 的 MergedDictionary

> ID：699001
> 
> 赞同：0
> 
> 时间：2009-03-30T21:02:12.437
> 
> 标签：wpf, xaml, ribboncontrolslibrary

在后面的代码中，这有效：

```
 this.Resources.MergedDictionaries.Add(Microsoft.Windows.Controls.Ribbon.PopularApplicationSkins.Office2007Black); 
```

我如何在 xaml 中执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T07:34:29.357

尝试以下操作：-

```
<Window x:Class="WPFRibbon.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:r="clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary"
    Title="Window1" Height="300" Width="400">

<Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/RibbonControlsLibrary;component/Themes/Office2007Black.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
</Window.Resources> 
```

# asp.net - 无法在 64 位操作系统上使用 Microsoft 图表控件

> ID：699002
> 
> 赞同：1
> 
> 时间：2009-03-30T21:02:17.553
> 
> 标签：asp.net, 64-bit, charts, 32-bit, mschart

我在我们的 64 位机器上运行图表控件时遇到问题。我收到以下错误...

> 无法加载文件或程序集“AspnetChart”或其依赖项之一。试图加载格式不正确的程序。

我运行它的机器是 Windows Server 2003 Enterprise x64 Edition SP2 Intel(R) Xeon(R) CPU E5405 @ 2.00 GHz w/4.00 GB RAM

图表控件在我们的 32 位 Windows XP Professional SP3 和 Windows Server 2003 Standard Edition SP2 机器上运行良好，但在部署到 64 位机器上时就不行了。

我试图将平台目标更改为 x86，但这似乎没有帮助。我还尝试签署 dll 并将其放入 GAC，但这并没有帮助。

有什么想法、建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T00:18:00.373

在我看来，你有一个 32 位的 DLL。在 IIS 7 中，可以同时[运行 32 位和 64 位进程](http://www.codedigest.com/Articles/IIS/21_IIS7_-_Running_32-bit_and_64-bit_ASPNET_versions_at_the_same_time_on_different_worker_processes.aspx)。但在 IIS 6 中，您只能选择其中一种。要在 IIS 6（64 位窗口）上运行 32 位应用程序，请查看这篇[Microsoft 文章](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/13f991a5-45eb-496c-8618-2179c3753bb0.mspx?mfr=true)。

# language-agnostic - 只输出的函数应该返回任何东西吗？

> ID：699006
> 
> 赞同：2
> 
> 时间：2009-03-30T21:04:07.470
> 
> 标签：language-agnostic, return-value

我正在将一系列 PHP 函数重写为容器类。其中许多函数会进行一些处理，但最终只是将内容回显到 STDOUT。

我的问题是：我应该在这些函数中有一个返回值吗？就这一点而言，是否有“最佳实践”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T21:09:08.270

处理会失败吗？如果是这样，来电者应该知道吗？如果其中任何一个都不是，那么我看不到回报的价值。但是，如果处理可能失败，并且可能会对调用者产生影响，那么我建议返回状态或错误代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T21:10:21.667

在主要通过异常报告错误的系统中，如果没有自然返回值，则不要返回返回值。

在使用返回值来指示错误的系统中，让所有函数都返回错误代码很有用。这样，用户可以简单地假设每个函数都返回一个错误代码并开发一种模式来检查它们是否随处可见。即使该函数现在永远不会失败，也返回一个成功代码。这样，如果未来的更改可能出现错误，用户将已经在检查错误，而不是隐式地默默地忽略它们（并且非常困惑为什么系统行为异常）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T21:06:03.050

如果没有要返回的值，则不要返回值。如果您有一些需要传达给调用者的价值，则将其返回，但在这种情况下听起来并不像这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T21:10:09.030

我会经常“返回：真；” 在这些情况下，因为它提供了一种检查功能是否有效的方法。虽然不确定最佳实践。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T21:14:47.460

请注意，在 C/C++ 中，输出函数（包括[printf()](http://www.cplusplus.com/reference/clibrary/cstdio/printf.html)）返回写入的字节数，如果失败则返回 -1。可能值得进一步调查，看看为什么会这样。我承认

1.  我不确定写入标准输出实际上会失败（除非你主动关闭你的标准输出流）
2.  我从来*没有*见过有人收集这个值，更不用说用它做任何事情了。

请注意，这与写入文件流不同——我没有计算 shell 中的流重定向。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T21:18:56.997

为了做“正确”的事情，如果方法的目的只是打印数据，那么它不应该返回任何东西。

在实践中，我经常发现让此类函数返回它们刚刚打印的文本通常很有用（有时您还想通过电子邮件发送错误消息或将其提供给其他函数）。

最后，选择权在你。我会说这取决于你对这些事情有多少“纯粹主义者”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T21:06:34.000

你应该：

```
return; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T21:07:47.430

在我看来，SRP（单一责任原则）也适用于方法/功能，而不仅仅是对象。一种方法应该做一件事，如果它输出数据，则不应进行任何数据处理-如果不进行处理，则不应返回数据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-30T21:19:08.183

没有必要返回任何东西，或者确实有一个返回语句。它实际上是一个 void 函数，并且可以理解，它们没有返回值。投入“回报”；为了迂腐，仅仅*有一个回报声明是噪音。*

# jquery - jQuery Datepicker 在点击时关闭，IE6

> ID：699013
> 
> 赞同：1
> 
> 时间：2009-03-30T21:05:43.800
> 
> 标签：jquery, internet-explorer-6

我正在使用带有 jQ​​uery UI 1.7.1 的 jQuery 1.3.2。我正在使用附加到文本输入字段的 DatePicker。它可以在所有浏览器中正常打开和呈现，并且在 IE7、Firefox、Chrome 和 Safari 中完美运行。但是，在 IE6 中，当我单击它的任意位置时，它会关闭而不执行任何操作。此外，任何悬停效果都不起作用（例如，当悬停在上/下个月按钮上时），所以看起来上面有东西阻止它注册悬停/单击事件。有谁知道可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T17:15:24.423

您确定文本输入的附件是正确的吗？

如果是这样，另一种可能性是与不同的 javascript 库发生冲突。您是否在页面上使用了除 jQuery 之外的任何东西（例如 mootools、script.aculo.us 等）？尝试仅使用日期选择器创建一个最小示例。

我在 IE6 中使用 jQuery 和 jQuery UI 的 DatePicker 没有任何问题。

# c# - 在 C# 中优雅地处理 XML 文件中的验证错误

> ID：699020
> 
> 赞同：3
> 
> 时间：2009-03-30T21:07:16.497
> 
> 标签：c#, .net, xml

描述有点长，请多多包涵。我想处理和验证一个巨大的 XML 文件并记录触发验证错误的节点并继续处理下一个节点。XML 文件的简化版本如下所示。

我想要执行的是遇到任何验证错误处理节点“A”或其子节点（XMLException 和 XmlSchemaValidationException）我想停止处理当前节点记录节点“A”的错误和 XML 并继续下一个节点“A”。

```
<Root>
  <A id="A1">
     <B Name="B1">
        <C>
          <D Name="ID" >
            <E>Test Text 1</E>
          </D>
        <D Name="text" >
          <E>Test Text 1</E>
        </D>        
      </C>
    </B>
  </A>
  <A id="A2">
    <B Name="B2">
      <C>
        <D Name="id" >
          <E>Test Text 3</E>
        </D>
        <D Name="tab1_id"  >
          <E>Test Text 3</E>
        </D>
        <D Name="text" >
          <E>Test Text 3</E>
        </D>
      </C>
    </B>
</Root> 
```

我目前能够通过使用带有 XMLReader 的 ValidationEventHandler 从 XmlSchemaValidationException 中恢复，这会引发我在 XML 处理代码中处理的异常。但是，在某些情况下，会触发 XMLException，这会导致进程终止。

以下代码片段说明了我正在使用的当前结构；它很混乱，也欢迎代码改进建议。

```
 // Setting up the XMLReader
    XmlReaderSettings settings = new XmlReaderSettings();
    settings.ConformanceLevel = ConformanceLevel.Auto;
    settings.IgnoreWhitespace = true;
    settings.CloseInput = true;
    settings.IgnoreComments = true;
    settings.ValidationType = ValidationType.Schema;
    settings.Schemas.Add(null, "schema.xsd");
    settings.ValidationEventHandler += new ValidationEventHandler(ValidationCallBack);
    XmlReader reader = XmlReader.Create("Sample.xml", settings);   
    // Processing XML
    while (reader.Read())
    if (reader.NodeType == XmlNodeType.Element)
       if (reader.Name.Equals("A"))
         processA(reader.ReadSubtree());            
    reader.Close(); 
   // Process Node A
   private static void processA(XmlReader A){
    try{
       // Perform some book-keeping 
       // Process Node B by calling processB(A.ReadSubTree())               
    }   
    catch (InvalidOperationException ex){

    }
    catch (XmlException xmlEx){

    } 
    catch (ImportException impEx){

    }
    finally{ if (A != null) A.Close(); }            
  }
  // All the lower level process node functions propagate the exception to caller.
  private static void processB(XmlReader B){
   try{
     // Book-keeping and call processC
   }
   catch (Exception ex){
    throw ex;
    }
   finally{ if (B != null) B.Close();}    
  } 
  // Validation event handler
  private static void ValidationCallBack(object sender, ValidationEventArgs e){
    String msg =  "Validation Error: " + e.Message +" at line " + e.Exception.LineNumber+
        " position number "+e.Exception.LinePosition;
    throw new ImportException(msg);
  } 
```

当遇到 XMLSchemaValidationException 时，finally 块将调用 close() 并且原始 XMLReader 被定位在子树的 EndElement 上，因此 processA 中的 finally 块将导致处理下一个节点 A。

但是，当遇到调用 close 方法的 XMlException 时，不会将原始读取器定位在子树的 EndElement 节点上，并且会抛出 InvalidOperationException。

我尝试使用诸如 skip、ReadToXYZ() 方法之类的方法，但是当在任何触发异常的节点上调用这些方法时，这些方法总是会导致 InvalidOperationException 的 XMLExcpetion。

以下是 MSDN 关于 ReadSubTree 方法的摘录。

> 当新的 XmlReader 被关闭时，原来的 XmlReader 将被定位在子树的 EndElement 节点上。因此，如果您在 book 元素的开始标记上调用 ReadSubtree 方法，则在读取子树并关闭新的 XmlReader 后，原始 XmlReader 将定位在 book 元素的结束标记上。

注意：我不能为此使用 .Net 3.5，但是欢迎 .Net 3.5 建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T21:29:30.107

看到这个问题：
[XML Parser Validation Report](https://stackoverflow.com/questions/32505/xml-parser-validation-report)

您需要区分*格式良好的*xml（它遵循成为真实 xml 所需的规则）和*有效*xml（遵循特定 xml 模式给出的附加规则）。从规范：

> 然而，一旦检测到致命错误，处理器就不能继续正常处理（即，它不能继续以正常方式将字符数据和有关文档逻辑结构的信息传递给应用程序）。

无论好坏，Visual Studio 中包含的 xml 工具都需要非常严格地遵循该规范，因此如果出现格式正确的错误，将不会继续处理。我提供的链接可能会给你一些选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T22:14:49.377

除了异常吃和有问题的使用 XmlReader.Close() 之外，我几乎像你一样做了这个：

```
XmlReaderSettings settings = new XmlReaderSettings();
settings.ConformanceLevel = ConformanceLevel.Auto;
settings.IgnoreWhitespace = true;
settings.CloseInput = true;
settings.IgnoreComments = true;
settings.ValidationType = ValidationType.Schema;
settings.Schemas.Add(null, "schema.xsd");
settings.ValidationEventHandler += ValidationCallBack;
using (XmlReader reader = XmlReader.Create("Sample.xml", settings))
{
    while (reader.Read())
    {
        if (reader.NodeType == XmlNodeType.Element &&
            reader.Name.Equals("A"))
        {
            using (
                XmlReader subtree = reader.ReadSubtree())
            {
                try {
                    processA(subtree);
                }
                catch (ImportException ex) { // log it at least }
                catch (XmlException ex) {// log this too }
                // I would not catch InvalidOperationException - too general
            }
        }
    }
}

private static void processA(XmlReader A)
{
    using (XmlReader subtree = A.ReadSubtree())
    {
        processB(subtree);
    }
}

// All the lower level process node functions propagate the exception to caller.  
private static void processB(XmlReader B)
{
} 
```

您不想吃异常，除了来自 processA 的异常。让 processA 的调用者决定忽略哪些异常 - processA 不应该意识到这一点。与*using*块相同 - 将它们放在外面，而不是里面。

# c# - 如何确定通过实例化 COM coclass 启动的进程的 PID？

> ID：699023
> 
> 赞同：2
> 
> 时间：2009-03-30T21:07:49.193
> 
> 标签：c#, .net, com, interop

有没有办法确定通过实例化 COM coclass 启动的进程的 PID？

例如：

```
MyApp.ApplicationClass anApp = new MyApp.ApplicationClass(); 
```

将启动进程*myapp*。执行此代码时，可能已经有很多*myapp进程在运行。*

我当前获取最新 PID 的解决方案感觉有点尴尬：我在创建新实例之前记住正在运行的进程列表，并在创建新实例时获取运行*myapp* PID 的增量。

有没有标准/更好的方法来实现这一点？

**编辑**：PID 稍后用于识别/监视创建的进程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T21:20:38.570

看起来您还控制`MyApp`?

如果是这样，我建议最好的方法是向 MyApp 添加一个名为 的方法`GetPid()`，然后调用`anApp.GetPid()`...

# javascript - 多维数组和 jQuery 的 getJSON

> ID：699024
> 
> 赞同：2
> 
> 时间：2009-03-30T21:07:49.443
> 
> 标签：javascript, jquery, json

我向我的应用程序中的控制器提交了一个 getJSON 请求，该控制器正在返回带有 2 个“应用程序”的有效 JSON。我知道这一点，就好像我将警报语句移动到 jQuery 的每个函数中一样，它会给我预期的结果。

我试图将这些数据存储在一个多维数组中，以便稍后与 extJS 的菜单控件一起使用。

代码：

```
Ext.onReady(function() {
    var applicationList = [];
    jQuery.getJSON('index.php/applications', function(data) {
        jQuery.each(data.applications, function (i, app) {
            applicationList[i] = [];
            applicationList[i]['text'] = app['title'];
            applicationList[i]['id'] = app['slug'];
        });
    });
    alert(applicationList[0]['text']);

    var applicationMenu = Ext.menu.Menu({
        items: applicationList
    });
}); 
```

JSON响应：

```
{"applications":[{"slug":"test","title":"Test"},{"slug":"hardware","title":"Hardware"}]} 
```

预期结果：

> 测试

实际结果（来自 Firebug）：

> applicationList[0] 未定义

如果我用`alert()`下面的代码替换上面的代码，我会得到一个带有“删除”文本的警报窗口：

```
for (p in applicationList) {
    alert(p);
} 
```

现在，我的想法是 JSON 请求没有及时完成，`alert()`所以我将使用命名回调函数来确保请求已经完成：

```
var data;
jQuery.getJSON('index.php/applications', get_applications(data));

function get_applications(data) {
    jQuery.each(data.applications, function (i, app) {
        applicationList[i] = [];
        applicationList[i]['text'] = app['title'];
        applicationList[i]['id'] = app['slug'];
    });
}; 
```

但现在 Firebug 告诉我`data is undefined`......

我觉得我快到了，但在过去的一个小时里我几乎到了那里，我觉得我现在只是在污染源头，试图让它发挥作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T21:12:38.980

这应该这样做：

```
Ext.onReady(function() {
    var applicationList = [];
    var applicationMenu;

    jQuery.getJSON('index.php/applications', function(data) {
        jQuery.each(data.applications, function (i, app) {
                applicationList[i] = [];
                applicationList[i]['text'] = app['title'];
                applicationList[i]['id'] = app['slug'];
        });

        applicationMenu = Ext.menu.Menu({
            items: applicationList
        });
    });
}); 
```

你的想法是对的；它不工作的原因是因为 AJAX 是一个异步过程，并且当您启动 getJSON 函数时，javascript 会继续运行。您的解决方案不起作用，因为将其设为命名回调并不会改变在您已经尝试初始化菜单之前不会触发它的事实。我所做的所有解决方案就是将菜单初始化代码移动到回调内部，因为那时并且只有这样您才能访问填写的应用程序列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T21:15:23.090

你是对的，你应该只在 getJSON 回调完成后使用你的“applicationList”变量。

您应该在 jQuery.each() 之后在 getJSON 回调中调用 Ext.menu.Menu()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:17:14.797

Paolo Bergantino 的解决方案应该可以工作，但您也可以按照自己的方式进行操作，使用命名的回调函数——您只是在代码中犯了一些小错误：

1.  数据不应被声明为变量——“函数 get_applications(data)”中的数据仅代表 .getJSON 返回的任何内容
2.  .getJSON 中的回调函数应该只是函数的名称，没有（数据）

这是更正后的代码：

```
jQuery.getJSON('index.php/applications', get_applications);

function get_applications(data) {
        jQuery.each(data.applications, function (i, app) {
                applicationList[i] = [];
                applicationList[i]['text'] = app['title'];
                applicationList[i]['id'] = app['slug'];
        });
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-26T06:46:28.653

```
$.getJSON("getq2.php", {
  yr: year,
  typ: type
}, function(data) {
  var items1 = new Array();
  var j = 0;
  for (var i in data) {
    var items = new Array();

    items.push(data[i][0], Number(data[i][1]));
    items1[j++] = items;
  }
  console.log(items1);
  var plot1 = jQuery.jqplot('chartContainer', [items1], {
    seriesDefaults: {

      // Make this a pie chart.
      renderer: jQuery.jqplot.PieRenderer,
      rendererOptions: {
        startAngle: 180,
        sliceMargin: 2,
        dataLabelThreshold: 2,

        // Put data labels on the pie slices.
        // By default, labels show the percentage of the slice.
        showDataLabels: true,

      }
    },
    grid: {
      borderWidth: 0,
      shadow: false,
      background: '#d8d6cb'
    },
    legend: {
      placement: 'outside',
      show: true,
      location: 'e',
      background: 'transparent',
      marginRight: '30px'
    }
  });
}); 
```

# asp.net-mvc - asp.net MVC 处理输入控件之间的依赖关系？

> ID：699026
> 
> 赞同：2
> 
> 时间：2009-03-30T21:08:00.660
> 
> 标签：asp.net-mvc, postback, data-entry

我有一个应用程序，它有两个相关的下拉列表，如果用户在列表框 A 中选择一个值，它会更新列表框 B 中的可用输入集。例如汽车的品牌/型号。当用户选择制造商时，模型列表将相应更新。

在 winforms 中，这只会在 autopost back 事件中处理。我应该在 asp.net MVC 中采用什么技术/方法？是通过 AJAX 完成的吗？只是想加快 MVC 的速度，并寻求构建策略来处理我在工作中被要求处理的常见任务。

我要感谢所有为回答这篇文章做出贡献的人。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T21:31:25.703

我会通过ajax来做到这一点。如果您有这些控件：

`<select id="makes" />` 和`<select id="models" />`

那么你可以用jquery做到这一点：

```
$().ready(function() {
   $("select#makes").change(function() {
        var make = this.value;          
        $.getJSON('models/list?make=' + make, function(data) {
              //load 2nd dropdown with result
        })
   });
}); 
```

然后，您只需要在 ModelsController 上执行一个名为 List() 的操作，它会返回一个 JSON 数据结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T21:50:55.283

您正在使用 ASP.NET MVC 有点无关紧要。对于网页上的这种类型的 UI 机制，您基本上有三个选项。

1.  如果列表中的数据相对较小且不经常更改，则最简单的方法是在初始请求中以 javascript 数组或页面标记中的隐藏元素之类的方式预加载页面上的所有可能数据。当 Box A 的值发生变化时，javascript 只是将 Box B 的内容替换为适当的数据。这一切都是在没有任何请求返回服务器的情况下发生的，这使得它非常快。但是，当您的数据大小影响初始页面加载的响应时间时，这种方法就会失效。

2.  如果列表中的数据很大或经常更改（在用户在页面上做出决定的时间范围内），则传统方法是在框 A 的值时使用新的查询参数重新加载页面变化。后端代码根据新参数调整输出。根据页面中其余渲染代码的复杂程度，这可能会很昂贵。

3.  这是选项 2 的变体，基本上是 Ben Scheirman 给出的关于 ajax 的答案。当 Box A 更改时，您仍在按需加载 Box B 的内容。不同之处在于您只是重新加载已更改的页面部分，而不是整个页面。

就个人而言，如果您的数据足够小以使用选项 1，那么由于其性能，这可能就是我会采用的方法。否则选择选项 3，特别是如果您已经实现了其他与 ajax 相关的东西。如今，选项 2 似乎被许多人视为传统机制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T21:33:55.357

从功能上讲，将这两个下拉列表放在它们自己的部分视图中，然后在 ListA 中的值被选中时返回。如果这对于布局目的不可行，那么上面 Ben 的方法看起来不错。

# javascript - 是否有 jQuery 选择器/方法来查找特定的父元素 n 级？

> ID：699027
> 
> 赞同：59
> 
> 时间：2009-03-30T21:08:07.787
> 
> 标签：javascript, jquery, dom, jquery-selectors

考虑以下 HTML。如果我有对 <button> 元素的 JSON 引用，如何在这两种情况下获取对外部 <tr> 元素的引用

```
<table id="my-table">
    <tr>
        <td>
            <button>Foo</button>
        </td>
        <td>
            <div>
                <button>Bar</button>
            </div>
        </td>
    </tr>
</table>

<script type="text/js">
    $('#table button').click(function(){
        //$(this).parent().parent() will work for the first row
        //$(this).parent().parent().parent() will work for the second row
        //is there a selector or some magic json one liner that will climb
        //the DOM tree until it hits a TR, or do I have to code this myself
        //each time?            
        //$(this).????
    });
</script> 
```

我知道我可以对每种情况进行特殊处理，但我更感兴趣的是“无论你有多深，爬树直到找到元素 X”风格的解决方案。像这样的东西，但更像 jQuery/less-verbose

```
var climb = function(node, str_rule){
    if($(node).is(str_rule)){
        return node;
    }
    else if($(node).is('body')){
        return false;
    }
    else{
        return climb(node.parentNode, str_rule);
    }
}; 
```

我知道 parent(expr) 方法，但从我所看到的情况来看，它允许您向上过滤父母并且在找到 expr 之前不要爬树（我希望代码示例证明我错了）

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-03-30T21:10:11.620

[父母](https://api.jquery.com/parents/)功能做你想做的事：

```
$(this).parents("tr:first"); 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-30T21:15:55.977

此外，如果您使用的是 jQuery 1.3+，您可以使用[最接近](https://api.jquery.com/closest/)的方法

```
$(this).closest("tr"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-31T12:53:50.553

不是 jQuery，但这个选项效果更好

node.contains( otherNode )

> Node.contains() 方法返回一个布尔值，指示节点是否是给定节点的后代

[https://developer.mozilla.org/en/docs/Web/API/Node/contains](https://developer.mozilla.org/en/docs/Web/API/Node/contains)

# iphone - 确定摇动速度

> ID：699035
> 
> 赞同：2
> 
> 时间：2009-03-30T21:10:10.950
> 
> 标签：iphone, cocoa-touch

是否可以确定某人摇晃 iPhone 的速度？这将是他们开始移动到他们现在回到原点的终点的时间。基本上这是我想测量速度的一次滑动。此讨论对初始速度的评论：[http](http://discussions.apple.com/message.jspa?messageID=8297689#8297689) ://discussions.apple.com/message.jspa?messageID=8297689#8297689 。似乎 iPhone 缺少距离的重要组成部分，无法很好地衡量速度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T21:15:53.183

当然，听起来您需要做的就是对加速度进行两次数值积分以获得行驶距离。例如，看 [计算一个加速体在一定时间后的位置](https://stackoverflow.com/questions/153507/calculate-the-position-of-an-accelerating-body-after-a-certain-time)

请注意，您必须从测量的加速度中减去重力才能获得运动加速度，这是您应该积分的。至于如何做到这一点，请回复：GoatRider 的评论：我可能会尝试存储最后测量的加速度，其大小等于重力（我认为这是 1 以 iPhone 为单位？）。然后，对于您进行的每个幅度大于 1 的加速度测量，减去最后已知的重力加速度 - 这将需要是矢量减法 - 并将其用作动力学加速度。当然，这假设用户在整个滑动过程中将手机保持在相同的方向，我认为这几乎是正确的。

不幸的是，一般来说，没有可以用来区分重力加速度和动能加速度的技术——也就是说，一个坚定的用户总能找到一种方法来欺骗你可能想出的任何算法。（花絮：这就是所谓的*等价原理*，它是爱因斯坦广义相对论的基础）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T21:20:43.997

您必须自己进行计算。您收到的每个加速度事件都会告诉您记录在加速度计上的相对 G 力以及记录事件的时间。您必须对多个事件进行采样并进行插值。以下是有关加速事件本身的更多信息：

[UIAcceleration 类参考](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIAcceleration_Class/Reference/UIAcceleration.html)

# c# - php和c#中的hmac_sha256不同

> ID：699041
> 
> 赞同：8
> 
> 时间：2009-03-30T21:11:04.707
> 
> 标签：c#, php, hashcode

这是我的 PHP 代码：

```
hash_hmac( "sha256", utf8_encode( $filename ), utf8_encode( $password ) ); 
```

这是我的 C# 代码：

```
var hmacsha256 = new HMACSHA256( Encoding.UTF8.GetBytes( password ) );
hmacsha256.ComputeHash( Encoding.UTF8.GetBytes( filename ) ); 
```

不幸的是，两个结果都不同。谁能给我一个提示？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-30T23:07:18.423

我的 C# 不是最好的，但我让它工作了，你需要做的就是将你的字节数组结果转换为十六进制。

**PHP**

```
$hash = hash_hmac( "sha256", utf8_encode("Filename"), utf8_encode("Password"));
echo $hash;
// 5fe2ae06ff9828b33fe304545289a3f590bfd948ca9ab731c980379992ef41f1 
```

**C＃**

```
string password = "Password";
string filename = "Filename";

var hmacsha256 = new HMACSHA256(Encoding.UTF8.GetBytes(password));
hmacsha256.ComputeHash(Encoding.UTF8.GetBytes(filename));

foreach(byte test in hmacsha256.Hash)
{
    Console.Write(test.ToString("X2"));
}
// 5FE2AE06FF9828B33FE304545289A3F590BFD948CA9AB731C980379992EF41F1 
```

# image - 右浮动和容器 div

> ID：699047
> 
> 赞同：0
> 
> 时间：2009-03-30T21:12:41.507
> 
> 标签：image, html, alignment, containers, nested

我在一个容器 div 中有 3 个 div。第一个向左浮动，第二个向右浮动，最后一个位于中间。这会在一个容器 div 中创建 3 个大约均匀的 div。

在这些 div 中的每一个中，我都放置了不同高度的图像。然后有一个单独的 div 位于容器 div 下方，它将是全宽（称为描述 div）。

我希望容器 div 拉伸到最大图像 div 的高度，以便描述 div 很好地位于图像下方。目前，当左侧浮动和中间 div 包含最大的图像但不适用于右侧浮动 div 时，此方法有效。我不明白为什么或我缺少任何帮助将不胜感激。

注意：我试图在不使用任何绝对值的情况下执行此操作，仅使用百分比。所以我不想向容器 div 声明绝对高度！clear's 也不起作用，因为这被简化了，实际上还有很多其他的 div 容器围绕着所有这些等等，除非你可以只清除上面嵌套 div 中的浮动。

这是代码：

```
<html>
<head>
    <style>
        #b_pics {
            border: 2px solid grey;
            width: 100%;
        }
        #b_pic1 {
            border: 0px solid grey;
            float:left;
            width:33%;
        }
        #b_pic2 {
            border: 0px solid grey;
            margin: 0px auto;
            width: 33%
        }
        #b_pic3 {
            border: 0px solid grey;
            float:right;
            width:33%;
        }
        #b_website {
            border: 1px solid grey;
            width:100%;
        }
    </style>
</head>
<body>
    <div id='b_pics'>
        <div id='b_pic1'>
            Image 1 here    
        </div>
        <div id='b_pic3'>
            Image 3 here            
        </div>
        <div id='b_pic2'>
            Image 2 here                    
        </div>
    </div>
    <div id='b_website'>
        Line of text goes here
    </div>
</body> 
```

在此先感谢您的帮助，尽量保留我头上的头发！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T21:22:05.710

包含元素不会拉伸以适应浮动 div。在您的示例中，包含的 div 没有实际内容，因此高度为 0 像素。尝试更改边框或背景颜色来说明这一点。

您可以通过赋予其样式来强制元素位于任何浮动 div 之下：

```
clear: both; 
```

您还可以清除左侧或右侧浮动 div。

您可以在具有该样式的三个图片 div 之后添加一个空 div，以使 b_pics 容器拉伸以容纳浮动元素，或者您可以只使 b_website div 两者都清除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-30T11:48:10.450

SpoonMeiser 的解释是正确的。这是一些适合您的代码。本质上，我在容器 div 的末尾添加了一个带有“clear:both”的空 div。这会强制容器占用它包含的浮动 div 的空间。

这比将 #b_website div 设置为“clear:both”（SpoonMeiser 的替代建议）要好，因为这会使 #b_website div 显示在正确的位置，但不会强制 #b_pics 边框围绕浮动 div。

```
<div id='b_pics'>
    <div id='b_pic1'>
        Image 1 here</div>
    <div id='b_pic3'>
        Image 3 here
    </div>
    <div id='b_pic2'>
        Image 2 here
    </div>
    <div style="clear:both;"></div>
</div>
<div id='b_website'>
    Line of text goes here
</div> 
```

我希望这有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-05T07:08:26.880

我完全同意 SpoonMeiser 的回答。我遇到了同样的问题（仅使用 IE）并添加了一个明确的说明：两者（在我的情况下为 div）是唯一似乎有效的解决方案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-30T21:20:19.913

试一试。[_](http://www.manisheriar.com/holygrail/rightcol.htm) 没有什么是硬编码的，它应该做你想做的事。

# c++ - Bison 似乎无法正确识别 C 字符串文字

> ID：699054
> 
> 赞同：1
> 
> 时间：2009-03-30T21:14:00.193
> 
> 标签：c++, parsing, bison, flex-lexer, lexical-analysis

我的问题是我试图运行一个我使用 flex-bison 扫描仪解析器编码的问题。我的程序应该做的是接受用户输入（在我的例子中，查询我正在设计的数据库系统）、lex 和解析，然后执行相应的操作。实际发生的是我的解析器代码没有正确解释我提供给它的字符串文字。

这是我的代码：

```
130 insertexpr :  "INSERT" expr '(' expr ')'
131 
132                  {
133                         $$ = new QLInsert( $2, $4 );
134                          }
135                         ; 
```

我的输入，按照“查询：”提示：

> 查询：插入 abc(5)；
> 输入：1.0-5：语法错误，意外字符串，预期文件结尾或行尾或 INSERT 或 ';'

现在，如果我从第 130 行的 parser.yy 代码中删除“INSERT”字符串文字，程序运行得很好。事实上，在存储输入数据（即“abc”和整数 5）后，它会正确返回给我。

起初，我认为这是字符编码的问题。Bison 代码需要使用相同的编码进行编译和运行，这应该不是问题，因为我正在从同一个终端编译和运行。

我的系统详情：

Ubuntu 8.10 (Linux 2.6.24-16-generic)
flex 2.5.34
bison 2.3
gcc 4.2.4

如果您需要更多信息或代码，请告诉我！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T21:19:38.993

这是一个典型的错误，如果您使用 flex 将您的输入 lex 转换为标记，则不能将解析器中的文字字符串称为文字字符串，而应为它们使用标记。

有关详细信息，请参阅[此类似问题](https://stackoverflow.com/questions/517113/lisp-grammar-in-yacc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T22:05:49.133

谢谢，谢谢，谢谢！

澄清一下，这是我根据 jpalecek 的评论实现我的解决方案的方式。首先，我在野牛代码 (parser.yy) 中声明了一个 INSERT 令牌：

```
71 %token INSERT 
```

接下来，我在弹性代码 (scanner.ll) 中定义了该标记：

```
79 "INSERT INTO" { return token::INSERT; } 
```

最后，我在语法规则中使用了标记 INSERT：

```
132 insertexpr :  INSERT expr '(' expr ')'
133 
134                  {
135                         $$ = new QLInsert( $2, $4 );
136                          }
137                         ; 
```

瞧！我的过度头痛终于结束了！

谢谢，jpalecek :)。

# javascript - 使用 jQuery 在“Enter”上提交表单？

> ID：699065
> 
> 赞同：445
> 
> 时间：2009-03-30T21:16:19.080
> 
> 标签：javascript, jquery, html, webkit, forms

我有一个沼泽标准登录表单——一个电子邮件文本字段、一个密码字段和一个使用 HTML/jQuery 的 AIR 项目上的提交按钮。当我在表单上按 Enter 时，整个表单的内容都消失了，但没有提交表单。有谁知道这是 Webkit 问题（Adobe AIR 使用 Webkit for HTML），还是我搞砸了？

我试过：

```
$('.input').keypress(function (e) {
  if (e.which == 13) {
    $('form#login').submit();
  }
}); 
```

但这既没有停止清算行为，也没有提交表单。没有与表单相关的操作 - 这可能是问题吗？我可以在操作中添加一个 javascript 函数吗？

* * *

## 回答 #1

> 赞同：426
> 
> 时间：2012-09-20T18:15:50.143

```
$('.input').keypress(function (e) {
  if (e.which == 13) {
    $('form#login').submit();
    return false;    //<---- Add this line
  }
}); 
```

查看这个 stackoverflow 答案： [event.preventDefault() vs. return false](https://stackoverflow.com/questions/1357118/event-preventdefault-vs-return-false)

本质上，“return false”与调用`e.preventDefault`and相同`e.stopPropagation()`。

* * *

## 回答 #2

> 赞同：174
> 
> 时间：2009-03-30T21:20:35.263

除了像 Jason Cohen 提到的那样返回 false 之外。您可能还必须防止默认

```
e.preventDefault(); 
```

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2009-03-30T21:30:58.297

不知道是否有帮助，但您可以尝试模拟提交按钮单击，而不是直接提交表单。我在生产中有以下代码，它工作正常：

```
 $('.input').keypress(function(e) {
        if(e.which == 13) {
            jQuery(this).blur();
            jQuery('#submit').focus().click();
        }
    }); 
```

注意：**jQuery('#submit').focus()**使按钮在按下回车时动画。

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2009-03-30T21:17:51.570

返回`false`以防止击键继续。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2009-03-30T21:24:20.790

您是否有任何理由必须挂钩并测试回车键？

你不能简单地添加一个

```
<input type="submit" /> 
```

到您的表单并在输入时自然提交？如果需要，您甚至可以挂钩表单的`onsubmit`操作并从那里调用验证函数...

您甚至可以将`onsubmit`用作测试来查看您的表单是否正在提交，但如果您调用`form.submit()`.

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2013-03-03T05:45:28.653

这是作为 JQuery 插件执行此操作的一种方法（以防您想重用该功能）：

```
$.fn.onEnterKey =
    function( closure ) {
        $(this).keypress(
            function( event ) {
                var code = event.keyCode ? event.keyCode : event.which;

                if (code == 13) {
                    closure();
                    return false;
                }
            } );
    } 
```

现在，如果你想`<input>`用这种类型的功能装饰一个元素，它就像这样简单：

```
$('#your-input-id').onEnterKey(
    function() {
        // Do stuff here
    } ); 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2011-04-13T18:39:41.513

您也可以简单地添加`onsubmit="return false"`到页面中的表单代码以防止默认行为。

然后在 javascript 文件中使用 jQuery将表单的事件挂钩（`.bind`或）到任何函数。`.live``submit`

这是一个帮助示例代码：

**HTML**

```
<form id="search_form" onsubmit="return false">
   <input type="text" id="search_field"/>
   <input type="button" id="search_btn" value="SEARCH"/>
</form> 
```

**Javascript + jQuery**

```
$(document).ready(function() {

    $('#search_form').live("submit", function() {
        any_function()
    });
}); 
```

自 2011 年 4 月 13 日起，这适用于 Firefox 4.0 和 jQuery 1.4.3

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-07-13T13:53:33.747

这是我的代码：

```
 $("#txtMessage").on( "keypress", function(event) {
    if (event.which == 13 && !event.shiftKey) {
        event.preventDefault();
        $("#frSendMessage").submit();
    }
    }); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-30T21:44:51.820

同样为了保持可访问性，您应该使用它来确定您的键码：

```
c = e.which ? e.which : e.keyCode;

if (c == 13) ... 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-08-03T16:23:46.043

我现在用

```
$("form").submit(function(event){
...
} 
```

起初我向提交按钮添加了一个事件处理程序，这对我产生了错误。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-07-25T05:32:28.913

只是为了便于实施而添加。您可以简单地制作一个表单，然后隐藏提交按钮：

例如：

```
<form action="submit.php" method="post">
Name : <input type="text" name="test">
<input type="submit" style="display: none;">
</form> 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-08-24T10:32:33.500

我今天发现按下 Enter 键时不会触发 keypress 事件，因此您可能想要切换到 keydown() 或 keyup() 。

我的测试脚本：

```
 $('.module input').keydown(function (e) {
            var keyCode = e.which;
            console.log("keydown ("+keyCode+")")
            if (keyCode == 13) {
                console.log("enter");
                return false;
            }
        });
        $('.module input').keyup(function (e) {
            var keyCode = e.which;
            console.log("keyup ("+keyCode+")")
            if (keyCode == 13) {
                console.log("enter");
                return false;
            }
        });
        $('.module input').keypress(function (e) {
            var keyCode = e.which;
            console.log("keypress ("+keyCode+")");
            if (keyCode == 13) {
                console.log("Enter");
                return false;
            }
        }); 
```

在键盘上键入“A Enter B”时控制台中的输出：

```
keydown (65)
keypress (97)
keyup (65)

keydown (13)
enter
keyup (13)
enter

keydown (66)
keypress (98)
keyup (66) 
```

您在第二个序列中看到“keypress”缺失，但 keydown 和 keyup 注册代码“13”被按下/释放。根据[函数 keypress() 的 jQuery 文档](https://api.jquery.com/keypress/)：

```
Note: as the keypress event isn't covered by any official specification, the actual behavior encountered when using it may differ across browsers, browser versions, and platforms. 
```

在 Server 2012 R2 上的 IE11 和 FF61 上测试

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-03-23T21:19:24.987

因为它可能会迟到，但您可以在 html 中添加以下行：-

```
<input onkeyup="submitForm(event)" oninput="addTextName(this)" type="text" id="name-val"> 
```

并将其添加到 js 文件中

```
function submitForm(e) {
var keyCode = e.keyCode ? e.keyCode : e.which;
if (keyCode == 13){
    toggleNextScreen();
} 
```

}

keycode 13 表示输入

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-09-29T13:56:20.500

在 HTML 代码中：

```
<form action="POST" onsubmit="ajax_submit();return false;">
    <b>First Name:</b> <input type="text" name="firstname" id="firstname">
    <br>
    <b>Last Name:</b> <input type="text" name="lastname" id="lastname">
    <br>
    <input type="submit" name="send" onclick="ajax_submit();">
</form> 
```

在 Js 代码中：

```
function ajax_submit()
{
    $.ajax({
        url: "submit.php",
        type: "POST",
        data: {
            firstname: $("#firstname").val(),
            lastname: $("#lastname").val()
        },
        dataType: "JSON",
        success: function (jsonStr) {
            // another codes when result is success
        }
    });
} 
```

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2012-09-12T13:30:04.523

试试这个：

```
var form = document.formname;

if($(form).length > 0)
{
    $(form).keypress(function (e){
        code = e.keyCode ? e.keyCode : e.which;
        if(code.toString() == 13) 
        {
             formsubmit();
        }
    })
} 
```

# java - 有没有办法搜索和访问当前正在运行的线程？

> ID：699072
> 
> 赞同：1
> 
> 时间：2009-03-30T21:17:24.333
> 
> 标签：java, multithreading

使用 Java 6：

我有一个使用线程在后台运行任务的方法。此任务访问文件，因此该方法不应运行多个线程。

我试图弄清楚是否有一种方法可以在我的方法开始时搜索活动线程。我想知道是否有一个活动线程已经在运行我的任务，以便我可以正确处理这种情况。

如果没有前一个线程的实际实例，这可能吗？我想避免全局保存 Thr​​ead 的实例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T21:22:35.600

你可能想要一些更健壮的东西，比如使用[ReentrantLock](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html)来防止对这些资源的并发访问。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T21:26:56.510

仅供参考：您可以使用`java.lang.Thread.enumerate(Thread[])`. 但这*不是*解决问题的方法——正如布赖恩所说，使用锁。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T22:03:54.503

使用 [ReentrantLock.tryLock]( [http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html#tryLock()](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html#tryLock())。如果返回 false，宾果！其他一些线程当前持有锁。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T21:45:23.940

即使您可以访问这些线程，您会如何处理这些知识？您如何判断该线程当前正在做什么？

如果你有一个可以从多个地方访问的服务，但你想保证这个服务只使用一个线程，你可以像这样设置一个工作队列：

```
public class FileService
{
    private final Queue workQueue = new ArrayBlockingQueue(100/*capacity*/);

    public FileService()
    {
        new Thread()
        {
            public void run()
            {
                while(true)
                {
                    Object request = workQueue.take(); // blocks until available
                    doSomeWork(request);
                }
            }
        }.start();
    }

    public boolean addTask(Object param)
    {
        return workQueue.offer(param); // return true on success
    }
} 
```

在这里，ArrayBlockingQueue 负责处理所有线程安全问题。addTask() 可以从任何其他线程安全地调用；它只会向工作队列添加一个“工作”。另外，如果有工作要做，内部线程会不断地从 workQueue 中读取并执行一些操作，否则它会安静地等待。

# floating-point - 哪些语言向开发人员公开了 IEEE 754 陷阱？

> ID：699078
> 
> 赞同：9
> 
> 时间：2009-03-30T21:19:04.393
> 
> 标签：floating-point, ieee-754, floating-point-exceptions

为了教育目的，我想玩这些陷阱。

数值演算中默认行为的一个常见问题是我们“错过”出现在错误运算中的 Nan（或 +-inf）。默认行为是通过计算进行传播，但是一些操作（如比较）会破坏链并松开 Nan，并且其余的处理继续进行而不承认算法前面步骤中的奇异性。

有时我们有办法对这种事件做出反应：延长函数（“在我的情况下为 0/0 = 12”），或者在时域模拟中放弃步骤并尝试其他设置（如预测器、步骤大小或其他）。

所以这是我的问题：您知道将 IEEE754 陷阱暴露给开发人员的语言吗？我不想为此与 ASM 搞混。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T01:04:44.053

据我所知，在 C 和 C++ 中处理浮点异常有两种选择：

首先，如果您禁用/屏蔽浮点异常（大多数环境默认这样做），您可以通过调用[fetestexcept](http://linux.die.net/man/3/fetestexcept)查看是否发生了任何浮点异常。fetestexcept 在 Visual C++ 中不可用，但您可以很容易地窃取 MinGW 运行时的实现。（它在公共领域。）一旦标记了异常，在调用 feclearexcept 之前它不会被清除，因此您可以在一系列计算结束时调用 fetestexcept 以查看其中是否有任何引发异常。这不会为您提供您要求的陷阱，但它确实可以让您测试是否发生了诸如 NaN 或 +/-inf 之类的问题并根据需要做出反应。

其次，您可以通过在 Linux中调用[feenableexcept](http://linux.die.net/man/3/feenableexcept)或在 Windows中调用[_controlfp](http://msdn.microsoft.com/en-us/library/e9b52ceh(VS.80).aspx)来启用/取消屏蔽浮点异常。操作系统如何处理处理器生成的浮点异常取决于您的操作系统。

*   在 Linux 中，操作系统会发送一个 SIGFPE 信号，因此您可以安装一个信号处理程序来捕获它并设置一个标志来告诉您的例程做出适当的反应。
*   在 Windows 中，操作系统调用结构化异常处理以将处理器异常转换为可以使用 C 中的`__try`/`__catch`块或C++ 中的`try`/块捕获的语言异常。`catch`
*   **更新：**对于 Mac OS X，如[本答案](https://stackoverflow.com/questions/247053/enabling-floating-point-interrupts-on-mac-os-x-intel/340683#340683)中所述，您应该能够使用`_MM_SET_EXCEPTION_MASK`from启用/取消屏蔽异常`xmmintrin.h`，并且只要您使用默认编译器选项（即，不要禁用 SSE），您应该能够使用 SIGFPE 捕获异常。

（如果你好奇的话，我在这篇博文中写了更多关于 C 和 C++ 中的这个和其他浮点问题的[文章。）](http://codingcastles.blogspot.com/2009/01/floating-point-reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T01:08:37.397

我不确定标准是什么，但我可以告诉你我从经验中看到的，因为它可能有用。我用 C++ 编写过代码，而 NaN 有时是我最糟糕的噩梦。它们默默地出现并通过计算一直传播到最后，直到我只有无用的输出。我经常不得不创建额外的代码来专门检测导致 NaN 的情况。我正在使用 Visual C++ 2008，所以我希望它会以这种方式遵循 IEEE 标准。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:27:14.403

C 和可能从它派生的大多数语言，如 C++ 或 python（尽管可能是间接访问）。期望低级语言有这样的支持可能是合理的。

请参阅[http://www.math.utah.edu/~beebe/software/ieee/#c-notes](http://www.math.utah.edu/~beebe/software/ieee/#c-notes)，其中有大量关于使用 IEEE 754 号码的脚本和说明。特别是[of1.c](http://www.math.utah.edu/~beebe/software/ieee/ofl.chttp://www.math.utah.edu/~beebe/software/ieee/ofl.c)处理浮点异常。最后，来自源[http://grouper.ieee.org/groups/754/reading.html](http://grouper.ieee.org/groups/754/reading.html)，其中包含一堆有用的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-16T18:43:28.777

Maple 的编程语言有一个符合 IEEE-754 的数字模型，如果需要，您可以设置自己的陷阱处理程序。以下是一些链接：

*   [IEEE-754 和 Maple 的数字之间的差异](http://www.maplesoft.com/support/help/Maple/view.aspx?path=IEEEdiffs)（它们非常小 - 它主要只是函数的名称）
*   [Maple 中数值计算的一般信息](http://www.maplesoft.com/support/help/Maple/view.aspx?path=numerics)
*   [有关如何获取和设置数字事件处理程序的信息](http://www.maplesoft.com/support/help/Maple/view.aspx?path=NumericEventHandler)（陷阱处理程序的 Maple 术语）

Maple 的一个不常见的属性是默认浮点数是十进制（不是二进制）并且具有任意精度。如果要处理 64 位二进制浮点数，请将它们包装在`HFloat`. 例如，`0.2`精确地表示十进制数，而`HFloat(0.2)`表示通过将 0.2 分配给 C 中的双精度数得到的相同数字。这通过运行可以明显看出，例如，

```
a := HFloat(0.2);
b := 0.2;
evalf[20](a - b); 
```

`a`这将计算和使用 20 位十进制数字算术之间的差异`b`，结果为`0.11E-16`.

# google-analytics - 充斥着营销跟踪像素（与多个供应商的活动）！

> ID：699080
> 
> 赞同：1
> 
> 时间：2009-03-30T21:19:13.423
> 
> 标签：google-analytics

我们有一些第三方向我们发送流量，并要求我们在确认页面上放置一个跟踪像素，以便他们可以跟踪销售情况。

我们目前正在使用谷歌分析为我们自己的用途。

谷歌将通过 cookie[记住最初的推荐。](http://www.google.com/support/googleanalytics/bin/answer.py?hl=en&answer=55540)这可能是好事也可能是坏事。如果有人通过 B 公司的链接购买，但他们最初是通过 A 公司找到我们的网站 - 那么 A 公司仍然会获得“推荐”。这似乎不公平，但这似乎是谷歌分析的工作方式：

> 例如，如果这是用户第一次访问您的网站，则跟踪代码会将活动跟踪信息添加到 cookie 中。如果用户之前发现并访问过您的网站，则跟踪代码会增加 cookie 中的会话计数器。无论经过了多少次会话或经过了多少时间，Google Analytics（分析）都会“记住”最初的推荐。这为 Analytics 提供了真正的多会话跟踪功能。

目前，我们的“收据页面”上只有一个跟踪像素来自一家我们甚至没有与之有业务往来的公司。有第二家公司要求我添加一个让我觉得“等一下——我们会突然被这些东西淹没！”。此外，这意味着有人可以查看源代码并查看与我们有业务往来的所有人。

这不是奥普拉——你不可能都有跟踪像素。对 ？

我们应该如何以最诚实的方式为双方管理来自多个流量来源的销售 - 特别是如果他们已经设置了他们坚持使用的系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-02T15:15:15.240

以下是我在我们公司解决问题的方法：我们为合作伙伴提供了一个 URL，该 URL 在查询字符串中包含一个参数。此参数触发 cookie。在“目标”/确认页面（通常插入跟踪像素的位置）上，我们插入一些逻辑来查看 cookie 值是否与我们认可的合作伙伴之一相关（链接 if-else 或 switch 语句）。如果找到匹配项，则显示跟踪像素。

即使您前一段时间问过这个问题，我希望这仍然可以帮助您或其他有同样问题的人！

# programming-languages - 新项目语言重新分区

> ID：699082
> 
> 赞同：0
> 
> 时间：2009-03-30T21:19:25.267
> 
> 标签：programming-languages

几个月前，我看到了一项研究的饼图，显示了新项目在选择语言方面的趋势。

研究表明，选择的主要语言是 Java，然后是 C++，然后是 C，等等。如果有人知道在哪里可以找到那项研究，我想找到它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T21:22:53.713

[http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

# .net - NVelocity 项目死了吗？有替代品吗？

> ID：699094
> 
> 赞同：27
> 
> 时间：2009-03-30T21:22:23.137
> 
> 标签：.net, templates, template-engine, nvelocity

我正在寻找 .NET/C# 的模板引擎来在我的应用程序中生成电子邮件通知。我过去读过关于[NVelocity](http://nvelocity.sourceforge.net/)的文章，并认为它符合我的需求，但似乎这个项目已经死了。

您是否仍会建议为此目的使用 NVelocity，或者您能提出任何替代方案吗？

注意：我发现了一些其他模板引擎，但这些主要是 ASP.NET MVC（Brail、NHaml 等）的“视图引擎”。但我认为这些不是我想要的。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-30T21:29:59.513

Castle Project 对该项目进行了分叉并一直在维护它，最近于 2010 年 12 月 10 日发布了 1.1.1 版。更多详细信息可以在[Castle Projects NVelocity 网站上](https://github.com/castleproject/NVelocity)找到。他们还对其进行了许多改进，详细信息可以[在他们的 NVelocity 改进](https://github.com/castleproject/NVelocity/blob/master/Changes.txt)页面上找到。该项目看起来现在已经死了，在 MonoRail 3 中，它已被基于 Razor 的 Castle Blade 所取代。

如果您正在寻找替代方案，那么我建议您使用ASP.Net MVC3 或[Spark View Engine的](http://sparkviewengine.com/)[Razor 视图](http://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx)引擎。

开源项目[RazorEngine](http://razorengine.codeplex.com/)允许您在 ASP.Net MVC 或网页之外使用 Razor View 引擎，以便您可以使用它来生成模板化电子邮件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T10:07:35.677

您可以独立使用 brail 或 naml 来生成 html 电子邮件。

naml 的核心（不确定 brail??）没有引用 MVC 或 ASP。

我使用 NHAML 生成 XPS 文档，以便从 win forms 应用程序打印和报告。

如果它必须是文本也许[http://www.stringtemplate.org/](http://www.stringtemplate.org/)

这里有一个类似的问题[How to use Brail as a stand-alone general purpose template engine (like NVelocity)?](https://stackoverflow.com/questions/619923/how-to-use-brail-as-a-stand-alone-general-purpose-templating-engine-like-nveloci)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T17:40:37.017

我没有理由不使用 NVelocity（Castle 项目分支）。它很稳定，您的特定需求（电子邮件模板）可能不像其他使用 NVelocity 的项目那样复杂，因此您不应该期待任何问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-16T06:51:30.413

codeplex上有项目。

[http://www.codeplex.com/NVelocity](http://www.codeplex.com/NVelocity)

项目描述：NVelocity 是非常流行的开源 java 模板引擎框架，velocity 1.6 的一个端口。NVelocity 是一个用 C# 编写的纯 .Net 库，目前针对 Framework 版本 3.5。

签入的初始源代码似乎直接来自 svn.castleproject.org。

创建 CodePlex 项目的人（用户名：TerryLiang）也在 8 月份从 nLucene 创建了一个。对于那个项目，从那时起他已经进行了大约 50 次签到，所以也许他正计划在那个项目上做一些认真的工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-04-29T00:14:13.030

NVelocity 没有任何问题，只是很难找到该项目的最新版本。谷歌通常会首先找到旧的 sourceforge 链接，其次是 codeplex 链接。正如 Pervez Choudhury 所说，获得它的地方是城堡。我们在工作中使用 Castle 版本的 NVelocity，它很棒。

自从第一次提出这个问题以来，多年来出现了另一种选择，那就是微软的 T4。大多数人认为 T4 是一个预编译生成器，因为它最初是这样发布的，但实际上您现在可以使用它来生成生成器类并在运行时进行动态生成。[它被称为预处理的 T4 模板，您可以在此处](http://www.olegsych.com/2009/09/t4-preprocessed-text-templates/)阅读有关它的更多信息。优点是它已经内置在 Visual Studio 中，因此您无需执行任何特殊操作即可开始使用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-07T13:05:31.443

由于 NVelocity 似乎（再次）死了，我建议[DotLiquid](http://www.dotliquidmarkup.org/)。目前不能说太多，因为我仍在评估它，但它确实看起来很有希望（并且构建为我所关心的 MonoTouch/MonoDroid 库）。

**更新**[2012 年 6 月 11 日]

将“安全”类/集合作为模型的限制可能是令人头疼的主要来源。在评估此引擎时，您可能希望从这一点开始。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-03T21:20:45.947

我同意西蒙的观点；[http://www.stringtemplate.org/](http://www.stringtemplate.org/)非常好，设计得很好，并且正在积极维护中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-28T17:31:00.267

我不能为[DotLiquid 投票](http://dotliquidmarkup.org/)给 Sorin ，所以只想添加我的评论 - 这似乎是一个正在积极开发的伟大平台。

并且使用它们在主干版本中具有的功能（不在已发布的 dll 中），如果您以这种方式注册它们，您可以使用 pocos 而无需从任何基类继承：

```
foreach (var type in {Assembly}.GetTypes())
    Template.RegisterSafeType(type, type.GetProperties().Select(p => p.Name).ToArray()); 
```

这解决了索林提到的头痛问题。

StringTemplate 也是个好东西，但是太严格和限制，模板太纯 View 用起来不实用……

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-08T15:34:11.863

通过使用 IKVM 将其转换为程序集，您可以在 .Net 中使用 Velocity 的原始（并且经常更新）Java 版本。我已经以这种方式成功地使用速度在 .Net 下生成代码。你也可以看看 StringTemplate。StringTemplate 有 java 和 C# 版本。[您可以在此处](http://btstout.blogspot.com/2007/02/using-velocity-in-net-via-ikvm.html)找到有关在 .Net 中使用 Velocity 的快速迷你教程。不过，我建议仔细研究一下[StringTemplate](http://www.stringtemplate.org/)，因为我认为它是一个更干净的模板引擎（我是最近的转换者）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-31T13:32:31.727

我建议使用 XSLT 进行模板化。是的，学习该技术需要更多时间，但是您拥有比其他任何东西都更灵活的模板解决方案。

# lucene - 在 Lucene 中阅读文档

> ID：699095
> 
> 赞同：0
> 
> 时间：2009-03-30T21:22:25.977
> 
> 标签：lucene, lucene.net

我在 Lucene 中的索引文档已经分配了多个城市......即。doc.Add(new Field("city", city1.Trim(), Field.Store.YES, Field.Index.TOKENIZED)); doc.Add(new Field("city", city2.Trim(), Field.Store.YES, Field.Index.TOKENIZED)); ETC

如何在执行 Lucene 搜索查询后遍历它们并读取值？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T03:56:04.720

为具有多个值的存储字段调用[Document.getValues](http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/document/Document.html)。

# apache-flex - 如何配置 Air 应用程序以引用外部配置文件？

> ID：699106
> 
> 赞同：6
> 
> 时间：2009-03-30T21:26:25.670
> 
> 标签：apache-flex, configuration, air

我想引用一个外部配置（例如，*.ini）文件，它允许我为我的 Air 应用程序的每个部署设置配置变量。不幸的是，我无法找到有关解决此问题的最佳方法的任何信息。

话虽如此，有人对如何实现这一目标有任何建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-01-21T18:00:32.513

下面是小 xml 想法的实现：

```
var file:File = File.applicationDirectory.resolvePath( "config.xml" );
var stream:FileStream = new FileStream();

stream.open( file, FileMode.READ );
config = new XML( stream.readUTFBytes( stream.bytesAvailable ));
stream.close(); 
```

只需将 config.xml 文件放在您的 src 目录中，它会在安装发布包时出现在安装目录中。我在我的主应用程序上配置了一个公共变量，所以我可以在我的项目中的任何地方做 Application.application.config.someOption 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T22:03:50.930

我不知道是否有一种以空气为中心的方式来实现这一点。我在 api 文档中没有找到任何好的课程。如果您有很多配置选项，则可能会考虑寻找可以帮助您的现有库。但是，如果您只需要存储一些简单的设置，我只需创建一个小的 xml 文件并使用 E4X 解析它。

可能会将其卡在[应用程序描述符](http://help.adobe.com/en_US/AIR/1.5/devappsflex/WS5b3ccc516d4fbf351e63e3d118676a5e5e-7fff.html)中，但如果您希望有人手动更改某些设置，这并不是一个好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-20T22:46:47.443

最简单最简单的方法是使用[ticlib](http://code.google.com/p/ticlib/) SimpleConfiguration，查看[这篇博](http://hemocoid.blogspot.com/2011/05/creating-keep-login-in-adobe-flexair.html)文。因为它基于共享对象，所以它可以在 FLEX 或 AIR 应用程序中使用。

# ruby-on-rails - Rails 如何使用 send_data 导出数据，然后将数据重定向到新页面？

> ID：699113
> 
> 赞同：16
> 
> 时间：2009-03-30T21:28:53.760
> 
> 标签：ruby-on-rails

我有一个允许用户下载生成的 CSV 文件的 rails 应用程序。下载文件后，我想将用户重定向到新的 URL 或操作。在 send_data 之后进行重定向是否有技巧？

我想做这样的事情（这是行不通的）：

```
send_data(output,:type => content_type,:filename => "myfile.csv")
redirect_to :controller => 'my_controller', :action => 'download_done' 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-30T23:05:28.800

`send_data`是一个渲染，所以你不能在控制器方法中做任何事情。

解决它的方法都涉及到 Javascript。这是我一起破解但从未真正喜欢过的一种方式：

*   用户点击提交
*   弹出小窗口并连接控制器下载文件
*   主窗口重定向到下一页

最终，我将文件生成变成了后台工作。然后用户转到工作页面（不需要后续重定向）来获取文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-07-30T06:22:51.900

就我而言，我在第 1 页有一个下载链接，在成功下载后，我只想将它们重定向到第 1 页（具有下载链接的同一页面）。如果你有和我一样的情况，请做下面的。

只需`target="_blank"`在您的下载按钮/链接中添加。这仅适用于`send_data`渲染方法。如果使用`send_file`，则必须在 js 中处理。

它重定向到单独的页面并弹出下载文件保存选项。保存后，它会关闭新选项卡并将它们带到您单击下载按钮的页面。

# text - SIFR 3 Beta：有人能够正确对齐文本吗？

> ID：699124
> 
> 赞同：0
> 
> 时间：2009-03-30T21:32:34.873
> 
> 标签：text, sifr

除了文本对齐标签外，SIFR 3 Beta 对我来说效果很好。只是我还是它可能是一个错误？

我会尽快发布一些细节。同时，让我知道您是否成功对齐右对齐或居中对齐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T18:34:38.007

如果您使用`fitExactly` `text-align`将无法正常工作。除此之外应该没问题。

我假设您使用的是 r436？

# c# - C#变量描述函数

> ID：699127
> 
> 赞同：0
> 
> 时间：2009-03-30T21:33:38.383
> 
> 标签：c#, .net

C#/.net 中是否有一个内置函数可以接受一个变量并描述/输出它的内容？在 PHP 中有实现这一点的[`print_r()`](http://php.net/print_r)和[`var_dump()`](http://php.net/var_dump)函数（我意识到 C# 和 PHP 之间的内在差异，只是提供一个输出示例）

由于这是用于日志记录脚本，因此它需要尽可能轻量级和非侵入性 - 我正在考虑编写一个函数来执行此操作，但如果可用，我更愿意使用内置函数。

变量的示例是自定义对象的数组/列表，转储出传递给事件处理程序的 eventargs 等。我想尽可能地采取这一点，同时避免反射费用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T21:39:03.050

我不确定 C# 中是否有任何内置的转储功能，但您可以简单地使用反射并使用**MethodInfo、PropertyInfo、FieldInfo**等遍历变量的类型。

**编辑**：是的，我知道它并不完全是轻量级的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T21:40:16.680

有关获取对象的字符串表示的不同方法的摘要，请参阅我对这个问题的回答：
[String casts](https://stackoverflow.com/questions/697216/string-casts/697248#697248)

由于您希望它既通用又轻巧，因此您最好的选择可能是`Convert.ToString()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:39:08.493

我不知道 PHP，但我想在你的类中覆盖/实现 ToString() 是最接近的匹配。

例如，对于 Person 类，您可以像这样实现 ToString()：

```
public override string ToString()
{
  return string.Format("{0} {1}", this.FirstName, this.LastName);
} 
```

这将为任何 Person 实例输出“firstname lastname”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T21:50:03.133

对此没有内置方法，但这里有一个使用反射获取字段和属性的示例：

```
public static string DisplayObjectInfo(Object o)
{
   StringBuilder sb = new StringBuilder();

   // Include the type of the object
   System.Type type = o.GetType();
   sb.Append("Type: " + type.Name);

   // Include information for each Field
   sb.Append("\r\n\r\nFields:");
   System.Reflection.FieldInfo[] fi = type.GetFields();
   if (fi.Length > 0)
    {
      foreach (FieldInfo f in fi)
      {
         sb.Append("\r\n " + f.ToString() + " = " +
                   f.GetValue(o));
      }
   }
   else
      sb.Append("\r\n None");

   // Include information for each Property
   sb.Append("\r\n\r\nProperties:");
   System.Reflection.PropertyInfo[] pi = type.GetProperties();
   if (pi.Length > 0)
   {
      foreach (PropertyInfo p in pi)
      {
         sb.Append("\r\n " + p.ToString() + " = " +
                   p.GetValue(o, null));
      }
   }
   else
      sb.Append("\r\n None");

   return sb.ToString();
} 
```

来源： http: [//www.developer.com/net/csharp/article.php/3713886](http://www.developer.com/net/csharp/article.php/3713886)

# asp.net - Asp 绑定问题

> ID：699129
> 
> 赞同：0
> 
> 时间：2009-03-30T21:34:29.550
> 
> 标签：asp.net, binding, menuitem

下面是我正在尝试更新的一些示例代码。客户端希望将菜单项文本设置为 AppSetting 值。我已经能够设置 appsettings 和实现它的功能。但是我的 Bind 代码出现错误，想知道是否有人看到我错过的东西。

是否像为 MenuItem 设置 ID 标签一样简单？当我尝试使用 ID 时，Visual Studio 在智能感知中无法重新识别它。

错误 -> 具有到字段 OUEntity 的双向数据绑定的 MenuItem 控件必须具有 ID。

* * *

```
<asp:MenuItem PopOutImageUrl="" Text="Administration" Selectable="false">
 <asp:MenuItem NavigateUrl="" Text="" ></asp:MenuItem>
 <asp:MenuItem NavigateUrl="" Text="" ></asp:MenuItem>
 <asp:MenuItem NavigateUrl="" Text=""></asp:MenuItem>                                                       
 <asp:MenuItem NavigateUrl="" Text='<%# Bind("OUEntity") %>'></asp:MenuItem>
 <asp:MenuItem NavigateUrl="" Text="" ></asp:MenuItem>
 <asp:MenuItem NavigateUrl="" Text="" ></asp:MenuItem>                                              
 <asp:MenuItem NavigateUrl="" Text=""  ></asp:MenuItem>
 <asp:MenuItem NavigateUrl="" Text="" ></asp:MenuItem>
 <asp:MenuItem NavigateUrl="" Text="" ></asp:MenuItem>
 <asp:MenuItem NavigateUrl="" Text="" ></asp:MenuItem>
</asp:MenuItem> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T21:41:49.627

您将需要用以下内容替换您拥有的东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T21:43:38.063

尝试使用 Eval（单向绑定）而不是 Bind（双向绑定）。我还假设您在进行绑定时会引用 ConfigurationManager.AppSettings。

也就是说，我必须根据 url 对后面的代码进行操作。但我不记得它是 asp.net 菜单还是第三方菜单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T13:18:58.047

嗯......现在没有任何内容传递给文本的菜单项。文本应该出现的地方有一个空白点。所以我认为评估不起作用。我想知道我是否可能需要在后面的代码中做一些事情以确保它被填充。

你怎么看？

# silverlight - 向 Silverlight 应用程序添加帮助系统的好方法是什么？

> ID：699130
> 
> 赞同：2
> 
> 时间：2009-03-30T21:35:02.340
> 
> 标签：silverlight

将帮助系统集成到 Silverlight 应用程序中的好方法是什么？原始手册是用 MS Word 编写的，因此我需要一些方法将其转换为您建议的任何格式。此外，如果您的答案是 HTML，您能否详细解释集成过程（大多数浏览器有效地阻止了 HTML 弹出窗口）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T22:45:12.000

我编写了一些代码来将 Word 文档转换为 XAML 以帮助完成此过程： [Word 2007 XAML Generator](http://www.codeplex.com/Word2007ToXaml)

迈克尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-15T00:03:42.307

我们有几个您可能会感兴趣的解决方案。我们正在开发基于 XAML 的 SL 帮助引擎以及自动更新您的 SL 项目的 MSWord 插件，添加转换后的基于 XAML 的帮助主题和搜索数据库。有关详细信息，请参阅[www.BackSpinSoftware.com](http://www.BackSpinSoftware.com)。

# .net - .net评论系统

> ID：699131
> 
> 赞同：1
> 
> 时间：2009-03-30T21:35:15.010
> 
> 标签：.net, system, comments

我的网站上有一个博客（在 blogengine 中创建），但我需要将评论系统集成到远离博客的网站。

例如，我有不同的模块来管理新闻和事件，我希望访问者留下他们对模块的评论（对于不同的新闻和事件）。是否有任何系统（.net 2.0）可以做到这一点，或者我需要创建自己的系统来管理用户评论？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T05:58:30.743

您可以使用许多评论管理模块。有些是开源的，有些是封闭的。有些是插入式的，有些需要大量配置（但通常更好的集成）。

[就个人而言，我更喜欢这个包](http://www.asp.net/community/control-gallery/837/ItemPermalink.ashx)中的 PageComments 用户控件的 drop-in 解决方案。

一个很好的起点是查看[asp.net](http://www.asp.net)上的控制库以获取评论系统：[控制库：“评论”](http://www.asp.net/community/control-gallery/search.aspx?search=1&text=comment&SortByField=ItemDownloads%20desc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T21:44:18.823

有很多 CMS-/portal-type 应用程序，它们提供了所需的功能（例如[DotNetNuke](http://www.dotnetnuke.com/)）。但我不确定这是否是你要找的。

# php - CakePHP 是否支持乐观锁定？

> ID：699138
> 
> 赞同：1
> 
> 时间：2009-03-30T21:37:58.450
> 
> 标签：php, cakephp, optimistic-locking

我刚开始使用 CakePHP，我找不到任何支持实现乐观锁定方案。我能找到的最接近的是对这个[CakePHP 博客文章](http://debuggable.com/posts/how-to-do-group-by-conditions-in-model-find()-calls:483fdc1c-8454-4593-a55e-37244834cda3)的评论，说它在 2008 年 6 月不受支持。

有谁知道这是否发生了变化，或者是否有人发布了关于如何自己实现它的扩展或教程？

有关乐观锁定的描述，请参阅[此答案](https://stackoverflow.com/questions/129329/optimistic-vs-pessimistic-locking/129397#129397)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T08:33:05.343

不在核心中，并且在快速谷歌之后，似乎任何人都在分享一种[行为](http://book.cakephp.org/view/595/Creating-Behaviors)，如果他们做了一个行为。这将是我建议的策略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-21T19:30:14.740

[在第 10 章的“实用 CakePHP 项目](http://www.apress.com/book/view/9781430215783)”一书中，给出了一些代码，用于制作您自己的“魔法场”。其中之一是乐观锁定领域。我还没有尝试过，但实际上它看起来很不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-28T20:56:32.170

Tadashi Nakamura在 GitHub 上发布了一个[OptimisticLock 行为。](https://github.com/tad80/OptimisticLock)它不是很完美，因为它在写入更改的记录之前会查询上次修改的日期。这使您可以静默地覆盖另一个用户的更改或陷入僵局。当我尝试编写这样的行为时，我想在更新的 where 子句中包含最后修改日期，如果受影响的行为零，则失败。当时，不支持[向更新查询添加额外条件](https://stackoverflow.com/q/1479961/4794)。我最近没有使用 PHP，所以我不知道这是否改变了。

# wpf - DataGridTemplateColumn 与 ComboBox 的问题

> ID：699140
> 
> 赞同：2
> 
> 时间：2009-03-30T21:38:33.627
> 
> 标签：wpf, wpftoolkit

我有一个带有 ComboBox 的 DataGrid 模板列。当我选择一个值并按 Enter 时，绑定的数据不会更新（我看到空单元格）。

XAML：

```
<Window x:Class="WpfGrid2.Window2"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:sys="clr-namespace:System;assembly=mscorlib"
  xmlns:dg="clr-namespace:Microsoft.Windows.Controls;assembly=WpfToolkit"
  >

    <Window.Resources>
        <x:Array x:Key="people" Type="sys:Object" />

        <x:Array x:Key="knownLastNames" Type="sys:String">
            <sys:String>Smith</sys:String>
            <sys:String>Johnson</sys:String>
            <sys:String>Williams</sys:String>
        </x:Array>
    </Window.Resources>

    <StackPanel>
        <dg:DataGrid x:Name="_grid" ItemsSource="{DynamicResource people}" CanUserAddRows="True" AutoGenerateColumns="False">
            <dg:DataGrid.Columns>

                <dg:DataGridTemplateColumn Header="LastName" MinWidth="100">
                    <dg:DataGridTemplateColumn.CellEditingTemplate>
                        <DataTemplate>
                            <ComboBox ItemsSource="{DynamicResource knownLastNames}" SelectedItem="{Binding LastName}"></ComboBox>
                        </DataTemplate>
                    </dg:DataGridTemplateColumn.CellEditingTemplate>
                    <dg:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LastName}" />
                        </DataTemplate>
                    </dg:DataGridTemplateColumn.CellTemplate>
                </dg:DataGridTemplateColumn>

            </dg:DataGrid.Columns>
        </dg:DataGrid>

        <Button>test</Button>
    </StackPanel>
</Window> 
```

代码隐藏：

```
namespace WpfGrid2
{
    public partial class Window2 : Window
    {
        public Window2()
        {
            InitializeComponent();

            List<Person> people = new List<Person>();
            this.Resources["people"] = people;
        }
    }
} 
```

如果我将 ComboBox 更改为 TextBox，它可以正常工作

```
<TextBox Text="{Binding LastName}" /> 
```

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T22:09:40.870

我不知道这是否是解决您的问题的可行解决方案，但是如果您将 Combo-Box 的 ItemsSource 绑定更改为 StaticResource，则该绑定有效。

```
...

<ComboBox ItemsSource="{StaticResource knownLastNames}" ... />

... 
```

我很确定发生的事情是，当 ComboBox 被卸载时（当 EditTemplate 由于提交新记录而被卸载时），DynamicResource 尝试再次查找资源并失败（因为 ComboBox 不再在视觉树，它不会在可视化树中找到它上面定义的资源）。这会将 ItemsSource 设置为 null，并将 SelectedItem 设置为 null，从而将 LastName 设置为 null。

使用 StaticResource，在显示 ComboBox 之前只搜索一次集合，因此它不会重置为 null。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T22:57:56.213

另一种选择（遵循“Abe Heidebrecht”答案的逻辑）是将“knownLastNames”移动到 Application.Resources。见第 3 点。

[动态资源查找行为](http://msdn.microsoft.com/en-us/library/ms750613.aspx)

1.  查找过程在设置属性的元素定义的资源字典中检查请求的键。

2.  查找过程然后向上遍历逻辑树，到达父元素及其资源字典。这一直持续到到达根元素。

3.  接下来，检查应用程序资源。应用程序资源是由 WPF 应用程序的 Application 对象定义的资源字典中的那些资源。

4.  为当前活动的主题检查主题资源字典。如果主题在运行时发生变化，则重新评估该值。

5.  检查系统资源。

# flash - Flash 10 中的 Actionscript 声音播放准确性

> ID：699146
> 
> 赞同：1
> 
> 时间：2009-03-30T21:40:28.677
> 
> 标签：flash, actionscript-3, audio

我们有一个 AS3 播放器，它需要 Flash 10（以克服 9 和播放偏移的旧问题）来处理音频剪辑。但是，当我选择要播放的起点和终点时，很多时候播放的内容与在 Audacity 中播放的剪辑不匹配。以下是我的测试 mp3 的一些细节（来自 ffmpeg 的结果）。

```
libavutil     49.10\. 0 / 49.10\. 0
libavcodec    52\. 0\. 0 / 52\. 0\. 0
libavformat   52.22\. 1 / 52.22\. 1
libavdevice   52\. 1\. 0 / 52\. 1\. 0
libswscale     0\. 6\. 1 /  0\. 6\. 1
libpostproc   51\. 2\. 0 / 51\. 2\. 0
built on Sep 24 2008 15:49:57, gcc: 4.2.4 (TDM-1 for MinGW)
Input #0, mp3, from 'reagan_challenger.mp3':
Duration: 00:00:14.62, start: 0.000000, bitrate: 127 kb/s
Stream #0.0: Audio: mp3, 44100 Hz, stereo, s16, 128 kb/s 
```

原文网址：[http ://ericmalone.net/test_media/reagan_challenge.mp3](http://ericmalone.net/test_media/reagan_challenger.mp3)

剪辑网址：[http ://ericmalone.net/test_media/reagan_clipped.wav](http://ericmalone.net/test_media/reagan_clipped.wav)

Clip 是使用 ffmpeg 在后端创建的，以从 4017ms - 7400ms 获取剪辑：

```
ffmpeg -i reagan_challenger.mp3 -ss 4.017 -t 3.383 reagan_clipped.wav 
```

我还使用 Audacity 将文件剪辑到稍微不太准确的位置 4.017676 秒 - 7.401333 秒[http://ericmalone.net/test_media/reagan_challenger_from_audacity.wav](http://ericmalone.net/test_media/reagan_challenger_from_audacity.wav)

[这是通过http://ericmalone.net/test_media/SoundExample.swf](http://ericmalone.net/test_media/SoundExample.swf)下面显示的代码播放的剪辑部分

请注意，*挑战者*一词在 Flash 播放中完成，但在基于 Audacity 和 ffmpeg 的剪辑中被截断。

我们在 Flash 中停止音频播放的方法是相当标准的。我已将声音位提取到测试类。这是相关代码

```
package {
    import flash.display.Sprite;
    import flash.events.*;
    import flash.media.Sound;
    import flash.media.SoundChannel;
    import flash.net.URLRequest;
    import flash.text.TextField;
    import flash.utils.Timer;

    public class SoundExample extends Sprite {
        private var url:String = "http://www.ericmalone.net/test_media/reagan_challenger.mp3";
        private var soundFactory:Sound;
        private var song:SoundChannel;

        private var clipStart:int = 4017;
        private var clipEnd:int = 7400;

        private var timer:Timer;
        private var timerInterval:uint = 20;

        private var textField:TextField;

        public function SoundExample() {
            var request:URLRequest = new URLRequest(url);
            soundFactory = new Sound();
            soundFactory.addEventListener(Event.COMPLETE, completeHandler);
            soundFactory.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
            soundFactory.load(request);

            textField = new TextField();
            textField.wordWrap = true;
            textField.width = 500;
            addChild(textField);
        }

        private function completeHandler(event:Event):void {
            output("file completely loaded and playing");
            timer = new Timer(timerInterval);
            timer.addEventListener(TimerEvent.TIMER, onTimer);
            song = soundFactory.play(clipStart);
            timer.start();
        }

        private function ioErrorHandler(event:Event):void {
            output("ioErrorHandler: " + event);
        }

        private function onTimer(event:TimerEvent):void
        {
            //stop playback if position is greater than clip end 
            //or if there's less duration left than difference of the timer and current position
            if((song.position >= clipEnd || clipEnd - song.position < timerInterval))
            {
                timer.stop();
                song.stop();
                output("Ending playback at " + song.position + " to be as close to " + clipEnd + " as possible");

            }
        }

        private function output(str):void
        {
            textField.text = str;
            trace(str); 
        }
    }
} 
```

所以问题是，有没有更好的方法来从 Flash 中获得更准确的回放？它是否取决于编解码器/采样率/等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T01:34:40.567

不直接涉及正确的 mp3 编码，但可以帮助...

您必须知道 Timer 类具有一定的精度余量。

您示例中的测试对我来说听起来不错（中间没有点击），我接近预期结果的 0.2%，这是完全可以接受的 IMO。

关于代码，鉴于您的示例中的以下条件，我想了解一个细节：

`clipEnd - song.position < timerInterval`

想象以下场景：

*   定时器以 20ms 的间隔运行，从 0 到 7400
*   倒数第二个滴答落在 7381 上，提前 1 毫秒
*   声音停止在 99.74%

如果条件没有取消，我猜它会停在 7401 (100.01%)

也许你应该尝试类似（小心，盲目编码）：

```
if(song.position >= clipEnd || (clipEnd - song.position < (song.position + timerInterval) - clipEnd))
{
    // Stop Timer
} 
```

延迟将取决于您执行的代码、计算机等，但我建议使用不同的间隔值进行游戏，以保持接近最佳“均匀度”。

此外，请确保您没有其他方法可以延迟计时器事件的执行。为此，您可能应该隔离此 Timer 部分以对其进行基准测试（同时删除声音）。

# c# - MbUnit：测试自定义有序集合

> ID：699147
> 
> 赞同：1
> 
> 时间：2009-03-30T21:40:28.990
> 
> 标签：c#, unit-testing, sorting, collections, mbunit

我有一个自定义的数据收集类型。此数据按三个属性按顺序排序，例如以下示例：

```
class Data
{
  public int PropertyA() { get; set; }
  public int PropertyB() { get; set; }
  public int PropertyC() { get; set; }
} 
```

集合必须保持 A、B、C 的顺序，例如：

```
[A, B, C]
[1, 2, 5]
[1, 3, 3]
[1, 3, 4]
[1, 4, 1]
[2, 1, 2]
[3, 3, 1]
[3, 4, 2] 
```

我想编写一些测试，以确保通过通常的可疑添加和删除操作在集合中维护此顺序。我正在使用 Gallio 和 MbUnit 3，我认为必须有一种简单的方法来使用它们的属性来做到这一点，我只是现在不明白。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T07:11:17.690

Yann Trevin 一直致力于 MbUnit v3 的“CollectionContract”。我不认为它现在可以处理有序集合，但我相信他有兴趣添加该功能，因为有适当的比较委托来描述排序不变量。

您将在 MbUnit v3.0.6 中的 MbUnit.Samples 项目的“SampleCollectionTest”夹具中找到一个示例。

我建议您将您的想法发布到 mbunitdev 邮件列表，他会在那里看到它：[http ://groups.google.com/group/mbunitdev](http://groups.google.com/group/mbunitdev)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:27:50.170

[MbUnit v3](http://www.gallio.org/)有一个新的有用的[**Assert.Sorted**](http://www.gallio.org/api/html/Overload_MbUnit_Framework_Assert_Sorted.htm)方法。您只需要传递枚举实例即可进行评估。如果枚举对象实现了 IEquatable，那么一切都是自动的。

```
[Test]
public void MySimpleTest
{
   var array = new int[] { 1, 5, 9, 12, 26 };
   Assert.Sorted(array);
} 
```

否则，您仍然可以指定自定义比较标准（例如，使用新的方便的[结构相等比较器](http://www.gallio.org/api/html/T_MbUnit_Framework_StructuralEqualityComparer_1.htm)）。

```
[Test]
public void MyComplexTest
{
   var array = new Foo[] { new Foo(123), new Foo(456), new Foo(789) };
   Assert.Sorted(array, new StructuralEqualityComparer<Foo>
   {
      { x => x.Value }
   });
} 
```

有关更多详细信息，请查看 Gallio/MbUnit [API 文档参考](http://www.gallio.org/api/index.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T23:02:59.073

在 MbUnit v2 中，您可以使用[CollectionOrderFixture](http://code.google.com/p/mb-unit/source/browse/trunk/v2/src/mbunit/MbUnit.Demo/CollectionOrderFixtureAttributeTest.cs) .. 虽然找不到它 MbUnit v3

# language-agnostic - 寻找猴子修补有什么问题的具体示例？

> ID：699152
> 
> 赞同：1
> 
> 时间：2009-03-30T21:42:03.510
> 
> 标签：language-agnostic, monkeypatching

我听说过很多关于猴子补丁如何如此酷或者猴子补丁是地球上最糟糕的事情的声音。我的想法是，如果您编写一些代码然后其他人更改其功能以执行其他操作，这并不好。但我正在寻找一个具体的例子来说明这可能会真正伤害到你。我的意思是，我一直在编写代码，然后我的同事对其进行更改。那么，monkey patching 与此有何不同？**可能发生的最坏情况是**什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T21:59:34.093

编程已经从需要了解全局状态以了解本地行为的编码实践缓慢但稳定地移动。一些例子：

*   Gotos 使推理控制流变得更加困难，因为您可能需要查看远处的代码才能了解如何到达特定行。
*   全局变量也不受欢迎，因为程序的任何部分都可以更改影响任何其他部分的状态。
*   支持函数式编程是因为这意味着您无需担心函数之外的任何状态即可了解其行为方式。

猴子补丁意味着如果不查看程序中的每一行代码，就无法知道一行代码做了什么。快速完成某事可能很有用，但它会使大型程序无法理解。由于这么多大程序都是从小程序开始的，猴子补丁可能是你想摆脱的习惯。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T21:46:13.733

猴子修补从对象的其余部分和对象的文档中隐藏对对象的更改。使用该对象非常容易，检查它的文档以确保它符合您的期望，然后发现它并不能以这种方式工作。

如果您从事的项目会出现开发人员流失，这尤其糟糕，您需要更多地担心如何让新开发人员跟上您的代码库的速度。新开发人员不会意识到补丁的细微差别，因此您将很难从中获得好的代码。

至于可能发生的最坏情况，如果您的应用程序出现错误，可能发生的最坏情况是什么？有人会因为一件设备功能不正确而死吗？您是否可以通过向他们发送错误的账单或向他们的账户收取过多费用来破坏他们的信用评级？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T21:47:02.280

这取决于环境，即您是否与其他人共享代码。不过，考虑一下可以在 Smalltalk 中完成的事情：改变`+`运算符的含义。如果我引入一个`+`函数，比如说，从另一个参数中*减去*一个参数，事情就会以华丽和意想不到的方式发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T21:51:26.747

嗯，这真的取决于你的意思......

> 如果你写了一些代码然后其他人改变了它的功能来做其他事情，那就不好了

有什么要求？现在和以前都一样。如果需求已经改变并且生成的代码集必须改变，这称为维护或增强。我很少能在现实世界中遇到“猴子补丁”有效的一段代码，尽管它也严重依赖于谁编写了代码，多久以前等。太多的变量无法给出真正有效的答案. 简而言之，如果您需要做的就是在客户想要的时候为他们提供他们想要的东西，那么这可能是一个很好的“哦，最好这样做”。这完全取决于您的观众。

# html - Rails 的 collection_select 辅助方法和末尾的“创建项目”选项

> ID：699165
> 
> 赞同：12
> 
> 时间：2009-03-30T21:46:54.980
> 
> 标签：html, ruby-on-rails

是否可以在使用辅助方法创建`<option>`的末尾添加一个？`<select>``collection_select`

现在我有

```
f.collection_select(:category_id , @categories, :id, :name, {:prompt => 'Please select a category'}) 
```

这会产生

```
<select id="product_category_id" name="product[category_id]">
  <option value="">Please select a category</option>
  <option value="7">category one</option>
  <option value="8">category 2</option>
</select> 
```

我想要的是

```
<select id="product_category_id" name="product[category_id]">
  <option value="">Please select a category</option>
  <option value="7">category one</option>
  <option value="8">category 2</option>
  <option value="new">..or create a new one</option>
</select> 
```

这可能吗，还是我应该循环遍历集合并手动生成选项？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T02:38:22.470

您可能应该`select`改用。

像这样：

```
f.select(:category_id, @categories.collect {|p| [ p.name, p.id ] } + [ [ 'Or create a new one', 'new' ] ], {:include_blank => 'Please select a category'}) 
```

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-03T12:43:26.677

同意简短答案否和长答案“狡猾”，但这是我刚刚所做的，我认为这比这两个解决方案中的任何一个都简单并且对我有用：

将下一行包裹在 erb 标签内，即`<%=`和`%>`：

```
f.collection_select :advertisement_group_id, AdvertisementGroup.find(:all, :order => "name DESC") << AdvertisementGroup.new(:name => "New Group"), :id, :name, :include_blank => true 
```

只需创建一个新对象`.new`并传入您想要显示的任何文本`:include_blank => true`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T23:20:24.523

简短的回答：没有。

长答案：当然，但你必须狡猾。

*   像这样创建一个类：

    ```
    class New_option_placeholder
      def id 
        "new"
      end

      def name
        "...or create a new one"
      end
    end 
    ```

*   而不是通过`@categories`，通过`@categories+New_option_placeholder.new`

如果（如评论所示）您正在寻找更简洁的东西`require "ostruct"`，然后通过`@categories + [OpenStruct.new(:id => 'new',:name => '...or create a new one')]`以完成基本相同的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-22T04:55:40.623

我无法发表评论，否则我会将其添加到上面的答案中。

要获得选项-> 值“新”，“或创建一个新”.. 而不是

```
f.select(:category_id, @categories.collect {|p| [ p.name, p.id ] } + ['Or create a new one','new'], {:include_blank => 'Please select a category'}) 
```

做

```
f.select(:category_id, @categories.collect {|p| [ p.name, p.id ] } + [['Or create a new one','new']], {:include_blank => 'Please select a category'}) 
```

注意选项周围的额外 []。这使得数组作为一个选项，值对

# asp.net - ASP.Net 验证摘要导致页面跳转到顶部

> ID：699171
> 
> 赞同：53
> 
> 时间：2009-03-30T21:48:08.847
> 
> 标签：asp.net, validation

我有一个简单的表单，其中包含一些必填字段验证器和一个验证摘要控件。当我提交表单时，*客户端*验证会导致表单跳转到页面顶部。如果我删除验证摘要，页面不会移动。

这是一个简单的例子：

```
<asp:TextBox ID="test" runat="server"></asp:TextBox>
<asp:RequiredFieldValidator ID="testrequired" runat="server" ControlToValidate="test">*</asp:RequiredFieldValidator>
<asp:ValidationSummary ID="summary" runat="server" />
<asp:Button ID="submit" runat="server" Text="submit" /> 
```

我已经尝试`SetFocusOnError="true"`在必填字段验证器中进行设置并`MaintainScrollPositionOnPostback="true"`为咯咯笑——即使这不是回发——但没有任何运气。这个问题有已知的解决方案吗？

**编辑：**

我在WebResource.axd生成的js中发现了问题。`ValidationSummaryOnSubmit()`似乎归结为函数中的一行。

```
line 534: window.scrollTo(0,0); 
```

关于如何删除或绕过它的任何想法？

**编辑2：**

暂时快速解决：

*   `EnableClientScript="false"`为所有验证控件设置（禁用客户端验证）
*   `MaintainScrollPositionOnPostback="true"`在 Page 指令中设置

仍然希望有一个客户端解决方案......

**编辑3：**

似乎更好的解决方法是只覆盖该`window.scrollTo()`函数，以便在验证脚本调用时它什么都不做：

```
<script type="text/javascript">
    window.scrollTo = function() { }
</script> 
```

在页面上的任何位置添加上述内容会使客户端验证保持不变，但会在`window.scrollTo()`整个页面中禁用该方法

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-28T17:08:06.627

两种可能的解决方法：

禁用客户端验证并在回发时跳转到正确的位置：

```
* set EnableClientScript="false" for all validation controls (disabling client validation)
* set MaintainScrollPositionOnPostback="true" in Page directive 
```

在javascript中禁用scrollTo函数：

```
<script type="text/javascript">
    window.scrollTo = function() { }
</script> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-02-10T20:21:19.843

这是一个[已知错误](http://connect.microsoft.com/VisualStudio/feedback/details/299399/validationsummary-control-causes-the-page-to-scroll-to-the-top)，如 Microsoft Connect 中所述。[相关问题](http://connect.microsoft.com/VisualStudio/feedback/details/299399/validationsummary-control-causes-the-page-to-scroll-to-the-top)具有最佳解决方案的基础：

```
var ValidationSummaryOnSubmitOrig = ValidationSummaryOnSubmit;
var ValidationSummaryOnSubmit = function() {
    var scrollToOrig = window.scrollTo;
    window.scrollTo = function() { };
    var retVal = ValidationSummaryOnSubmitOrig();
    window.scrollTo = scrollToOrig;
    return retVal;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-04-28T10:13:22.153

代替

```
<script type="text/javascript">
    window.scrollTo = function() { return true; }
</script> 
```

这将不加选择地覆盖所有回发的 ScrollTo 函数，我将该函数放在按钮的 OnClientClick 事件中。如下。

```
onClientClick="window.scrollTo = function(x,y) { return true; };" 
```

不确定这是否是最好的解决方案，但它似乎已经为我完成了这项工作。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-04-08T09:43:32.740

正如[cleek 的回答](/a/4962195)所述，这是一个[已知的错误](https://connect.microsoft.com/VisualStudio/feedback/details/299399/validationsummary-control-causes-the-page-to-scroll-to-the-top)，有解决方法。

这是[bdukes one](/questions/699171/asp-net-validation-summary-causes-page-to-jump-to-top/29511161#comment10967798_4962195)，在我看来是目前最好的。

```
(function () {
  var originalValidationSummaryOnSubmit = window.ValidationSummaryOnSubmit;
  window.ValidationSummaryOnSubmit = function (validationGroup) {
    var originalScrollTo = window.scrollTo;
    window.scrollTo = function() { };
    originalValidationSummaryOnSubmit(validationGroup);
    window.scrollTo = originalScrollTo;
  }
}()); 
```

（他没有直接在 SO 上发布它，现在[连接问题](https://connect.microsoft.com/VisualStudio/feedback/details/299399/validationsummary-control-causes-the-page-to-scroll-to-the-top)似乎需要注册才能看到，这使得他的解决方法更难访问。）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-12T19:51:26.927

我用这个：（需要 jquery 和 jquery.scrollTo）

首先，您在验证摘要上方放置一个具有特定类的锚点，如下所示：

```
<a class="custom_valsum_anchor" />
<asp:ValidationSummary ID="valSum" runat="server" EnableClientScript="true" /> 
```

然后包括这段 javascript：

```
$(document).ready(
        function () {
            var $valSum = $(".custom_valsum_anchor");
            if ($valSum.size() > 0) {
                var backup_ValidationSummaryOnSubmit = ValidationSummaryOnSubmit;
                ValidationSummaryOnSubmit = function (validationGroup) {
                    var backup_ScrollTo = window.scrollTo;
                    window.scrollTo = function () { };
                    backup_ValidationSummaryOnSubmit(validationGroup);
                    window.scrollTo = backup_ScrollTo;
                    setTimeout(function () { $("body").scrollTo($valSum); }, 1);
                };
            }
        }

); 
```

基本上，它会在必要时`ValidationSummaryOnSubmit`用临时禁用`window.scrollTo`并滚动到锚点的版本替换该功能。它不应该很难修改，因此它不使用 jquery。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T19:55:52.103

该页面将跳转到您的验证摘要所在的任何位置。如果您希望它保持在底部附近，请将验证摘要向下移动到提交按钮附近。

编辑，您也可以尝试关闭验证摘要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-09T22:24:52.613

我遇到了一个问题，使用`MaintainScrollPositionOnPostback=true`可以工作但会破坏客户端验证滚动位置。因此，我添加了一个脚本，以便在回发时查看验证摘要控件。

```
 private void FocusControlOnPageLoad(Control ctrl)
    {

        this.Page.ClientScript.RegisterClientScriptBlock(
          typeof(System.Web.UI.Page), "ctrlFocus",
        @"<script> 
              function ScrollView()
              {
                 var el = document.getElementById('" + ctrl.ClientID + @"')
                 if (el != null)
                 {        
                    el.scrollIntoView();
                    el.focus();
                 }
              }
              window.onload = ScrollView;
        </script>");
    } 
```

和：

```
protected void Page_PreRender(object sender, EventArgs e)
{
   if (Page.IsValid == false)
        {
          FocusControlOnPageLoad(TheValidationSummary);
        }
} 
```

看来我还必须将 scrollTo 函数清空：

```
window.scrollTo = function() {
            return true;
        } 
```

[从这里](http://www.codeproject.com/KB/aspnet/ViewControl.aspx)得到代码（大部分）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-02T02:02:36.333

也许您可以从所需的 fieldvalidator 继承并覆盖自定义控件中的客户端验证？

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-03-30T21:56:32.757

查看为您的 html 设置目标架构。

试试[http://msdn.microsoft.com/en-us/library/6379d90d(VS.71).aspx](http://msdn.microsoft.com/en-us/library/6379d90d(VS.71).aspx)

在 VS 2005 之前，您可以逐页设置架构。

只是一个想法。

# vb.net - ClickOnce 部署错误

> ID：699173
> 
> 赞同：2
> 
> 时间：2009-03-30T21:48:50.343
> 
> 标签：vb.net, winforms, deployment, clickonce, publish

我正在尝试部署 ClickOnce 应用程序。当服务器刚刚安装了.Net 2.0（没有SP）时，它以前工作过。最近服务器上安装了 3.5SP1，现在 ClickOnce 失败并出现以下错误：

**值不在****System.Deployment**内的预期范围内。

以下是 MSDN 论坛上发布的信息（那里的答案对我来说通常是命中或错过）与调用堆栈：

它在 VS 2005 w/SP1 中，我尝试更改发布到的路径、更改安装 URL、更改程序集名称、手动控制版本、运行 mage -cc、手动删除 %userprofile%\AppData\Local 中的所有应用程序数据\Apps 甚至完全更改部署服务器，但仍然出现相同的错误：

错误详细信息 在此操作期间检测到以下错误。* [3/30/2009 5:35:37 PM] System.ArgumentException - 值不在预期范围内。- 来源：System.Deployment - 堆栈跟踪：在 System.Deployment.Application.ComponentStore.LockApplicationPath(DefinitionAppId definitionAppId) 在 System.Deployment 的 System.Deployment.Internal.Isolation.IStore.LockApplicationPath(UInt32 Flags, IDefinitionAppId ApId, IntPtr& Cookie) System.Deployment.Application.FileDownloader.PatchFiles(SubscriptionState subState) 在 System.Deployment.Application.FileDownloader.Download(SubscriptionState subState) 在 System.Deployment.Application.Application.SubscriptionStore.LockApplicationPath(DefinitionAppId definitionAppId)。

任何帮助都将不胜感激..

参考论坛在[这里](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/9e4b714e-bad4-4c62-a7ad-3c80e32d95eb/?prof=required)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T14:19:22.270

我有一个类似的问题。

对我来说，解决方案是如果发布路径中有 & 符号，ClickOnce 就会出错。当我发布到我们研发部门的文件夹中时，即“\serverName\r&d\”，这让我很伤心，并且给了我与您相同的无法交流的“价值不在预期范围内”看到。

我不知道这是否能解决你的问题，但我觉得有必要提出建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T21:24:50.563

最后，我解决问题的唯一方法是创建一个全新的项目并从每个表单复制代码，然后发布。

Jonez：不幸的是，移动我的用户个人资料会很麻烦，而且在我看来，这对于解决发布问题来说是一种过大的杀伤力。

Gregory：安装将因该错误而失败。我尝试发布到新位置（不同的物理服务器），但问题仍然存在，我确认在任一路径中都没有使用 & 符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T16:44:08.447

如果您正在寻找一个快速而肮脏的解决方案，它在 95% 的时间内都可以解决 System.Deployment 问题，请删除并创建一个新的用户配置文件。请务必在执行此操作之前备份任何有价值的数据，例如桌面、收藏夹、“我的文档”、“我的图片”、Outlook 文件等。

我还看到人们删除整个本地设置目录来解决问题。请注意，此目录有时包含 Outlook .pst 文件。

请注意，您可能会通过执行这些修复来影响其他应用程序，并且这些影响有时是不可见的。这些解决方案显然并不理想，但这些都是微软提供给我的解决方案。

祝你好运。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-25T14:41:52.973

我刚刚遇到了这个错误，并且能够通过简单地卸载然后在用户计算机上重新安装应用程序来解决它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-25T18:39:21.210

您是否更改了应用程序本身的目标平台？更重要的是，您的开发机器上是否安装了 .NET 3.5 SP-1？

当您的引用不匹配时会发生此错误。因此，您的部署需要一个版本，但正在安装它的机器具有不同的版本。如果您有循环引用，也会发生这种情况。

# sql - 对 DB2 for z/OS 的存储过程调用中不支持字符串文字

> ID：699174
> 
> 赞同：0
> 
> 时间：2009-03-30T21:49:23.757
> 
> 标签：sql, stored-procedures, db2, mainframe, zos

在连接到在 z/OS 上运行的 DB2 数据库实例时，从 Rational Application Developer Data Perspective 调用简单的 SP 时，出现以下错误。从 SQuirreL 调用时也是如此。直接 SQL 查询运行没有问题。从我的 JAVA 代码调用时，该查询也可以正常工作。

```
 `'Error: [ibm][db2][jcc][10243][10940] String literals not supported in 
    stored procedure calls to DB2 for z/OS'` 
```

`存储过程是

```
 `CREATE PROCEDURE testEM( IN id CHAR(12) )
    P1: BEGIN 
      .....
    END P1` 
```

`在本地 DB2 实例上工作正常，有人知道这是否可能吗？`

 `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T05:13:04.587

好的，对此进行了更多调查，但我在当地找错了司机。升级到本地连接设置的 DB2 v9.5 驱动程序解决了这个问题，现在可以使用字符串文字调用 SProcs。以防万一将来有人遇到同样的问题。

# python - Python：Python 列表是否对 len() 进行计数，还是对每次调用都进行计数？

> ID：699177
> 
> 赞同：92
> 
> 时间：2009-03-30T21:50:45.673
> 
> 标签：python

如果我一直在一个很长的列表上调用 len() ，我是在浪费时间，还是在后台保留一个 int 计数？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-03-30T21:54:32.373

别担心：当然它会节省计数，因此`len()`在列表上是一个非常便宜的操作。顺便说一句，字符串、字典和集合也是如此！

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-03-30T22:17:54.203

另一种了解它是如何完成的方法是~~[在 Google 代码搜索上查找](http://www.google.com/codesearch/p?hl=en#ggVSD6_h0Ho/Python-2.5/Objects/listobject.c&q=package:python-2.5%20listobject.c%20lang:c&l=370)~~ 如果您不想自己下载源代码，请[查看 GitHub 上的源代码。](https://github.com/python/cpython/blob/2.5/Objects/listobject.c#L379)

```
static Py_ssize_t list_length(PyListObject *a)
{
    return a->ob_size;
} 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-30T22:23:13.020

[`len`是一个 O(1) 操作](http://books.google.com/books?id=JnR9hQA3SncC&pg=PA478&dq=Python+len+big+O&ei=JUbRSYPqGofqkwTy9_ihAQ)。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-30T21:54:41.593

编写您的程序，使其**经过优化以提高清晰度和易于维护**。您的程序是否更清晰`len(foo)`？然后这样做。

您是否担心花费的时间？使用[`timeit`标准库中的模块](https://docs.python.org/3/library/timeit)来*衡量*所花费的时间，并查看它在您的代码中是否重要。

与大多数人一样，您很可能会错误地猜测程序的哪些部分最慢。避免猜测的诱惑，而是通过测量来找出答案。

请记住，用 Donald Knuth 的话来说，**过早的优化是万恶之源。**只关注你*测量*过的代码速度，以了解改变它的工作方式所带来的好处是否值得付出代价。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-30T22:09:01.120

问题已得到解答（`len`为 O(1)），但您可以通过以下方式自行检查：

```
$ python -m timeit -s "l = range(10)" "len(l)"
10000000 loops, best of 3: 0.119 usec per loop
$ python -m timeit -s "l = range(1000000)" "len(l)"
10000000 loops, best of 3: 0.131 usec per loop 
```

是的，不是真的慢。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-30T22:03:11.073

Python“列表”实际上是一个可调整大小的数组，而不是链表，因此它将大小存储在某个地方。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-11-30T05:29:20.857

我参加聚会已经很晚了，但我刚刚做了一个测试，得到了一些有趣的结果：

```
import timeit, statistics

test_arr = list(range(1000000))

# Just call len() every time
def test1(arr):
    for i in range(len(arr)):
        j = arr[len(arr)-1]

# Store the result of len()
def test2(arr):
    l = len(arr)
    for i in range(len(arr)):
        j = arr[l-1]

print("Running test 1...")
t1 = timeit.repeat(lambda: test1(test_arr), number=int(2e2), repeat=4)
print("Test 1 results:")
print(t1)

print("Running test 2...")
t2 = timeit.repeat(lambda: test2(test_arr), number=int(2e2), repeat=4)
print("Test 2 results:")
print(t2)

m1 = statistics.mean(t1)
m2 = statistics.mean(t2)
avg = round(100 * abs(m2-m1)/m1, 2)
sign = "quicker" if m1-m2 > 0 else "slower"
print(f"On average, test 2 was {avg} {sign} than test 1") 
```

结果：

```
Running test 1...
Test 1 results:
[15.189714099979028, 15.160469999769703, 15.17295220005326, 15.072236399864778]
Running test 2...
Test 2 results:
[8.17264029989019, 8.191439799964428, 8.171442999970168, 8.208112000022084]
On average, test 2 was 45.96 quicker than test 1 
```

这是一个非常粗略的测试，我相信有人可以改进它（或指出错误），但似乎`len`只调用一次并将其保存到变量中确实要快得多，而不是重复调用它（这我相信这是海报所要求的）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T21:53:30.720

它必须将长度存储在某处，因此您不必每次都计算项目数。

# c# - C# Linq 在每次读取后看到审核注销

> ID：699179
> 
> 赞同：1
> 
> 时间：2009-03-30T21:51:15.640
> 
> 标签：c#, sql-server, linq

这不是[SQL 连接池和审核登录/注销](https://stackoverflow.com/questions/279401/sql-connection-pooling-and-audit-login-logout)。

我有一个 C# .NET 3.5 应用程序，可以更新本地数据库上 SQL 2008 上的大约 30K 记录。

逻辑是它首先检查记录是否存在 SingleOrDefault(p => p.stock=stock && p.number=number) 并添加记录或更新。

我只关注使用 SingleOrDefault 的读取。

我使用 SQLMetal.exe 创建了数据上下文文件。

在 SQL Profiler 中看到的每次读取后：
审核注销（1300 次读取）
RPC：已完成 sp_reset_connection
审核登录
RPC：已完成 sp_executesql 'select etc...'

我使用 2005 和不同的数据库在另一台机器上创建了一个新项目，但得到了不同的结果。
审核登录
RPC：已完成 sp_execute sql ...
RPC：已完成 sp_execute sql ...
RPC：已完成 sp_execute sql ...
...

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-14T17:50:04.780

将所有内容包装在 TransactionState 对象中为我解决了这个问题。例如：

```
using (TransactionScope ts = new TransactionScope())
{
   // do db stuff here

   ts.Complete();
} 
```

请注意，即使我只进行数据库读取，我也这样做了。

另请注意，您必须在项目中添加对 System.Transactions 的引用，如果它还没有的话。

# .net - .NET 通用注释标识符

> ID：699180
> 
> 赞同：0
> 
> 时间：2009-03-30T21:51:17.437
> 
> 标签：.net, comments

为所有 .net 语言提供通用注释标识符最令人望而却步的方面是什么？

例如，在每种语言中，符号“??” 将识别评论。（我不是说它*应该*是“？？”......只是一个例子。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T21:57:51.070

在 C# 中，'??' 运算符表示空合并。将其重新用于注释将导致大量代码无法运行。

我知道您说这只是一个示例，但这是您面临的问题 - 找到一个未在任何 .NET 语言中使用的单个令牌。我不认为这是一个实际的目标。

.NET 的目标之一是允许多种语言以运行时环境为目标，同时允许这些语言保持自己的区别。你的想法直接违背了这个目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T21:59:02.207

与统一 .NET 语言实现循环构造或类构造函数的方式相比，我并没有真正看到拥有“通用注释标识符”的意义。在某些时候，您将统一每种语言的独特性，而我们都将通过编写 IL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T22:08:41.387

如果通用注释指示器是 // ... 我会很高兴但那是因为我习惯了 c/c++/java/c#。:-) 反正他们是大多数，对吧？;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T22:46:53.353

您可能想要查看的是 Xml 注释。每种语言都保留自己的注释标识符，但用于注释的架构在所有语言中都是相同的，并且该语言的编译器知道如何将它们剥离到与智能感知一起使用的 xml 文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T21:55:37.020

向后兼容性可能是更改评论令牌的最大问题。

# c# - XmlNode.SelectNodes 的基础知识？

> ID：699184
> 
> 赞同：3
> 
> 时间：2009-03-30T21:51:56.543
> 
> 标签：c#, xml, xpath, selectnodes

我不确定为什么这不起作用。

我有一个已知格式的 XmlNode。这是：

```
<[setting-name]>
    <dictionary>
       <[block-of-xml-to-process]/>
       <[block-of-xml-to-process]/>
       <[block-of-xml-to-process]/>
    </dictionary>
</[setting-name]> 
```

我在一个名为**pattern**的变量中引用了该节点。我想要一个可迭代的节点集合，每个节点都由上面的 [block-of-xml-to-process] 表示。此时块的名称和结构尚不清楚。[设置名称] 是已知的。

这似乎很简单。我能想到六个应该指向块的 XPATH 表达式。我试过了：

```
XmlNodeList kvpsList = pattern.SelectNodes(String.Format(@"/{0}/dictionary/*", _CollectionName));
XmlNodeList kvpsList = pattern.SelectNodes(String.Format(@"{0}/dictionary/*", _CollectionName));
XmlNodeList kvpsList = pattern.SelectNodes(@"//dictionary/*");
XmlNodeList kvpsList = pattern.SelectNodes(@"//dictionary"); 
```

但是，我显然缺乏对 XPATH 或 .SelectNodes 的一些特殊技巧的一些基本了解，因为它们都不能始终如一地工作。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T05:27:51.003

您是否尝试过从 XPath 字符串中删除“@”？

```
XmlNodeList kvpsList = pattern.SelectNodes("//dictionary"); 
```

这应该有效-每天都对我有用:-)

马克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T00:36:24.073

你有没有尝试过：

```
XmlNodeList kvpsList = pattern.SelectNodes(@"//dictionary:child"); 
```

或者

```
XmlNodeList kvpsList = pattern.SelectNodes(@"/[setting-name]/dictionary:child"); 
```

几乎得到“字典”的孩子如果这不起作用，那么对字典的实际调用是否有效？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:57:13.630

变量有什么用`pattern`？
它是对整个 XML 的 DOM 的引用吗？

看看这会导致什么结果 `pattern.SelectNodes("//dictionary/").ChildNodes.Count`

编辑：这是格式良好的 xml 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T21:59:34.857

命名空间会导致问题吗？此外，请尝试查看“pattern.OuterXml”以确保您查看的是正确的元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T20:59:21.300

我只是在搜索这个，发现只要输入：

```
XmlNodeList kvpsList = pattern.SelectNodes("dictionary"); 
```

然后 kvpsList 将包含所有 [block-of-xml-to-process]-s，尽管我不明白为什么。=')

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-29T21:21:51.013

我遇到了同样的问题，这似乎是一个已知但意外的行为。请参阅[Xml-SelectNodes with default-namespace via XmlNamespaceManager not working as expected](https://stackoverflow.com/questions/4271689/xml-selectnodes-with-default-namespace-via-xmlnamespacemanager-not-working-as-ex)

例如，我通过使用 XmlDocument 的 NameTable 实例化 XmlNamespaceManager 来使其工作，然后添加具有任意名称的命名空间，例如与主文档元素的 NamespaceURI 关联的“a”。请注意，在我的例子中，XmlDocument 的 NamespaceURI 是空白的，但它的 DocumentElement 的 NameSpaceURI 实际上有一个值。这可能就是为什么如果不指定命名空间就无法工作的原因。

```
XmlDocument doc = new XmlDocument();
doc.Load( file.FullName );
XmlNode docElement = doc.DocumentElement as XmlNode;
XmlNamespaceManager nsman = new XmlNamespaceManager( doc.NameTable );
nsman.AddNamespace( "a", docElement.NamespaceURI );
docElement.SelectNodes( "a:wavetrack", nsman ); //docElement.SelectNodes("wavetrack") wasn't working 
```

# javascript - 好的非侵入式反垃圾邮件混淆器？

> ID：699185
> 
> 赞同：10
> 
> 时间：2009-03-30T21:52:33.877
> 
> 标签：javascript, obfuscation, spam-prevention, email-spam

我正在尝试使用 JavaScript 电子邮件混淆器来减少网站上列出的电子邮件中出现垃圾邮件的机会。现在我有一个基于 JavaScript 的混淆器，它使用 HTML 编码和 JavaScript 的组合将混淆的电子邮件透明地转换为普通电子邮件。

我要做的是：

将链接中 href 的“mailto:”部分格式化为 HTML 编码，如：

```
&#109;&#97;&#105;&#108;&#116;&#111;&#58; 
```

我还对电子邮件进行了编码，将`@`符号替换为`(a)`，以便电子邮件内容如下：

```
stackoverflow(a)example.com 
```

然后，我使用一些 JavaScript 来破译电子邮件中具有此`(a)`标志的所有 mailto 链接，并将它们转换为`@`页面加载。

这工作得很好。对于使用启用了 JavaScript 的浏览器的人来说，他们会看到一切正常。对于没有启用 JavaScript 的人，我认识的每个邮件客户端都会认为电子邮件地址无效，但是用户应该能够推断出更正符号所需的内容。

我想知道是否有更好的（侵入性较小（或充其量不是侵入性很强）但更能抵抗垃圾邮件发送者）的方式来混淆网页上的电子邮件。

与任何类型的混淆一样，如果人或计算机可以轻松地对其进行去混淆，那么垃圾邮件发送者也可以轻松地做到这一点。正因为如此，我并不期待一个万无一失的混淆，但是我很想知道还有什么其他建议。搜索 Google 并没有发现任何我认为比当前解决方案更好的解决方案。我想知道是否还有其他好的选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T16:57:55.743

我过去使用[HiveLogic Enkoder](http://hivelogic.com/enkoder)取得了相当大的成功。如果有什么你可能想看看 Dan 的编码是如何工作的，因为它可能会给你一些想法来制作一个更强大的混淆器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-08T12:14:52.037

如果你真的想保护电子邮件地址，除了为非 JavaScript 用户生成图像之外别无他法。
我曾经使用过这样的东西：

```
<script type="text/javascript">
//<![CDATA[
     scrambler('c.arb@oof||mo');
//]]>
</script>
<noscript>
    <img src="scrambler.php?t=c.arb@oof||mo" alt="Emailadresse" />
</noscript> 
```

`scramble`是一个非常简单的 JavaScript 函数，我想你很容易就能弄清楚它的作用。（这将导致`<a href="mailto:foo@bar.com">foo@bar.com</a>`：）`scrambler.php`是相同的，除了在 php 和 gd 后端生成图像。

**找出与某些编码技巧或用其他东西代替的东西无关的东西。**

**编辑：**这是我的算法：

```
function scrambler (text) {
  parts = text.split("||");
  var reverse = function (s) {
    var ret ='';
    for (var i=s.length-1;i>=0;i--)
      ret+=s.charAt(i);
    return ret;
  }
  text = reverse(parts[0])+reverse(parts[1]);
  document.write(text);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T22:06:02.097

为计算机混淆电子邮件的一种方法是将电子邮件写为图像而不是文本。这样，人类仍然很容易阅读电子邮件地址，而对于计算机来说却很难。

正如[Steve Gilham](https://stackoverflow.com/users/118959/steve-gilham)所说，使用 OCR 获取电子邮件并不难。纯文本浏览器不支持它们。因此，斯科特的解决方案可能是最好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-08T12:06:03.040

我已经使用这个生成器[http://www.wbwip.com/wbw/emailencoder.html](http://www.wbwip.com/wbw/emailencoder.html)服务有一段时间了，效果很好。我通常使用编码地址的一部分和不使用的部分。

例如 ...

用户@po.com ==`&#117;&#115;&#101;&#114;&#064;&#112;&#111;&#046;&#099;&#111;&#109;`

我可能会换成...

用户@po.com ==`u&#115;&#101;&#114;&#064;&#112;&#111;&#046;&#099;&#111;m`

# iphone - 如何使用objective-c库“混合/合并”两个图像？

> ID：699193
> 
> 赞同：3
> 
> 时间：2009-03-30T21:54:55.710
> 
> 标签：iphone, objective-c

我想知道是否有一些图像处理库可以让我拍摄两张图像并将它们混合在一起。或者将部分图像混合在马赛克中，使其看起来不像马赛克，而是一个完整的图像。

我查看了谷歌代码并搜索了这样的库，但找不到任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:06:10.410

Quartz 图形引擎直接支持 Alpha 混合，因此您不需要任何额外的库。您只需绘制一张图像，然后在其上绘制 alpha 小于 1.0 的第二张图像。阅读 UIImage 和 Core Graphics 文档了解详细信息。

# asp.net - ASP.NET - 将自定义 CompositeControl 呈现为字符串？

> ID：699198
> 
> 赞同：0
> 
> 时间：2009-03-30T21:57:15.750
> 
> 标签：asp.net, controls

我正在尝试将复合控件呈现为字符串并将其写入页面，如下所示：

```
Dim sb As New StringBuilder
Dim sw As New StringWriter(sb)
Dim hw As New HtmlTextWriter(sw)
Dim CustomCompositeControl as New MyCustomCompositeControl
CustomCompositeControl.RenderControl(hw)
HttpContext.Current.Response.Write(sb.ToString) 
```

不幸的是，它只是呈现一个空的跨度标签。

甚至可以像 DataGrid 那样将 CompositeControls 呈现为字符串吗？

如果不深入我的 CompositeControl 的文字内部，在可以通过 RenderControl 呈现之前，我应该在 CompositeControl 内部确认什么吗？

注意：我没有覆盖 CompositeControl 中的 RenderControl。我需要这样做吗？

**更新** 好的。我有点想通了。我必须确保在 RenderControl 方法运行之前调用了 CompositeControl 的 EnsureChildControls 方法。我只是不太确定在内部调用它的最佳位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:18:02.567

如果您有权简单地调用 Render() 方法，只需执行此操作，它就会为您提供所需的结果。否则，是的，您将不得不重写 RenderControl()... 取决于您何时调用它，您可能只需调用内部 RenderControl() 的 Render() 方法即可。

此外，您应该注意复合控件的顶级 html 标记将始终是一个跨度，除非您将其指定为其他内容，例如 div：

```
/// <summary>
/// Render as div instead of the default span.
/// </summary>
/// <value></value>
/// <returns>HtmlTextWriterTag.Div</returns>
protected override HtmlTextWriterTag TagKey
{
   get
   {
      return HtmlTextWriterTag.Div;
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T22:01:37.877

是的，这是可以做到的，但是在不了解内部控制及其对 asp.net 生命周期中各种事件的依赖关系的情况下是否有可能？我不认为这是可能的。

例如，DataGrid 可能取决于在表单内，我的猜测是它会出错，表明没有表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-13T20:41:03.713

看看这个[MSDN 页面讨论 CompositeControls](http://msdn.microsoft.com/en-us/library/aa479016.aspx)，特别是标题为“复合控件的渲染引擎”的部分

> 请求处理代码（在 Page 类中）在向页面和每个子控件触发 PreRender 事件之前立即调用 EnsureChildControls。

在正常的 ASP.NET 请求期间，您在 CompositeControl 中重写的 CreateChildControls() 方法不会被调用，直到它到达请求生命周期的后期阶段，就在 PreRender 之前。如果您尝试在正常的 ASP.NET 页面生命周期之外呈现 CompositeControl，则永远不会添加子控件，因为从未调用过子控件创建方法。确保手动渲染控件时调用 EnsureChildControls() 的最佳方法是覆盖 RenderControl()，如下所示：

```
public override void RenderControl(HtmlTextWriter writer)
{
    // We must explicitly call EnsureChildControls() in cases where we are rendering 
    // a CompositeControl outside of the normal ASP.NET page lifecycle
    EnsureChildControls();
    base.RenderControl(writer);
} 
```

CompositeControl 类本身并没有以类似的方式覆盖 RenderControl() 方法，这对我来说似乎很奇怪。如果你使用 Reflector 检查 CompositeControl 的实现细节，你会发现类中所有重写的方法都是为了调用 EnsureChildControls(); 如果控件处于设计模式，即使 Render() 也会调用 EnsureChildControls() 方法。从反射器：

```
protected internal override void Render(HtmlTextWriter writer)
{
    if (base.DesignMode)
    {
        this.EnsureChildControls();
    }
    base.Render(writer);
} 
```

# javascript - 检测用户访问哪些社交网络的方法？

> ID：699206
> 
> 赞同：0
> 
> 时间：2009-03-30T22:00:48.240
> 
> 标签：javascript, tracking

是否有推荐的方法来确定我的用户属于哪些社交网络？我知道如何构建一个系统来做到这一点，但我想获得其他人的意见和建议，以了解他们如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:10:02.647

这个 JavaScript 工具可以满足您的需要：[http ://www.azarask.in/blog/post/socialhistoryjs/](http://www.azarask.in/blog/post/socialhistoryjs/)

# c# - 为什么要在 C# 中实现 ICloneable？

> ID：699210
> 
> 赞同：112
> 
> 时间：2009-03-30T22:01:58.097
> 
> 标签：c#, .net, cloneable, icloneable

你能解释一下为什么我应该继承`ICloneable`并实现这个`Clone()`方法吗？

如果我想做一个深拷贝，我不能只实现我的方法吗？比方说`MyClone()`？

我为什么要继承 from `ICloneable`？有什么优势？只是让代码“更具可读性”吗？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-03-30T22:05:31.253

你不应该。Microsoft 建议不要实施`ICloneable`，因为接口没有明确指示您的`Clone`方法是执行“深”还是“浅”克隆。

请参阅[Brad Abrams](http://blogs.msdn.com/brada/archive/2003/04/09/49935.aspx)早在 2003 年发表的这篇博文（！）了解更多信息。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2010-11-15T16:49:49.850

`ICloneable`接口*本身*并不是很有用，也就是说，在不知道其他任何东西的情况下知道一个对象是可克隆的确实有用的情况并不多。这是与 eg`IEnumerable`或`IDisposable`;非常不同的情况。`IEnumerable`在许多情况下，除了如何枚举之外，在不知道其他任何事情的情况下接受它是有用的。

另一方面，`ICloneable`当作为通用约束与其他约束一起应用时，它可能很有用。例如，一个基类可能有用地支持许多派生类，其中一些可以有用地克隆，而另一些则不能。如果基类型本身暴露了一个公共克隆接口，那么任何不能被克隆的派生类型都会违反里氏替换原则。避免这个问题的方法是让基类型支持使用受保护的方法进行克隆，并允许派生类型实现它们认为合适的公共克隆接口。

一旦完成，一个想要接受一个`WonderfulBase`类型的对象并需要能够克隆它的方法可以被编码为接受一个支持克隆的 WonderfulBase 对象（使用具有基本类型和`ICloneable`约束的泛型类型参数） . 尽管`ICloneable`接口本身不会指示深克隆或浅克隆，但其文档`WonderfulBase`将指示`WonderfulBase`可克隆应是深克隆还是浅克隆。本质上，`ICloneable`接口不会完成任何通过定义无法完成的事情`ICloneableWonderfulBase`，除了它可以避免必须为每个不同的可克隆基类定义不同的名称。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-30T22:06:55.510

`ICloneable`是 BCL 中一直存在争议的工件之一。恕我直言，没有真正的理由来实施它。话虽如此，如果我要创建一个克隆方法，那么我会实现`ICloneable`，并提供我自己的强类型版本的`Clone`.

问题`ICloneable`是它从来没有指出`Clone`是浅拷贝还是深拷贝，这是非常不同的事情。没有`ICloneable<T>`迹象表明微软对 ICloneable 的想法

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-30T22:07:45.400

马特是正确的，不要使用它。创建您自己的`Copy()`方法（或类似名称），并在您的公共 API 中*明确*说明您的方法是创建对象的深层副本还是浅层副本。

# asp.net - 如何在编辑时停止 Gridview 对我的文本进行编码

> ID：699214
> 
> 赞同：0
> 
> 时间：2009-03-30T22:03:38.483
> 
> 标签：asp.net, html, html-encode

我之前尝试过问这个问题，但是我没有收到正确的回答。我在我设计的站点的管理区域中使用 GridView。我使用 DetailsView 将数据插入数据库，并使用 Gridview 编辑和删除数据。

我的查询是：当我在 DetailsView 中添加数据时，我输入如下数据：“PR Murphy & Associates” 注意“&”。

发生的事情是，当它在网格视图中显示数据时，它显示为“PR Murphy & Associates”，但是当我单击编辑按钮时，它显示“PR Murphy & Associates”。注意编码的 & 符号。

我的问题是我根本不希望代码对 & 符号进行 htmlencode。我对 ASP.NET 还很陌生，不知道如何实现这个目标。

IE 是将数据插入数据库时​​对字符串进行编码的DetailsView。我可以使用什么代码来阻止这种情况的发生以及我需要针对什么事件。

在我之前的回复中，有人建议我在 gridview 中设置 HTMLEncode="False"。我已经尝试过使用绑定字段，但没有任何区别。我还需要将此字段作为 GridView 中的 TemplateField，以便我可以对条目执行一些错误处理。

我希望这是有道理的，有人可以指导我正确的方向。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T22:55:54.487

我想你可以用你的模板调用一个方法，用 & 再次替换 &。由于您想要一个 TemplateField，这将是五分钟的修复，可能不是最好的方法，但会在紧要关头工作。

粘贴一些代码，以便我们可以编辑/帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T23:39:13.103

如果您发现无法更改控件的行为以返回未编码的值，那么您可能会很高兴知道[`HtmlDecode`](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.htmldecode.aspx).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T23:50:12.033

该值*应该*被编码。如果您的值是`AT&T`，那么您的最终 HTML 应该类似于：

```
<input type="text" value="AT&amp;T" /> 
```

如果这不是您所看到的，请发布代码和输出的 HTML。

# javascript - 这种javascript是什么？并帮助处理 AJAX 请求

> ID：699215
> 
> 赞同：0
> 
> 时间：2009-03-30T22:03:45.003
> 
> 标签：javascript, jquery, ajax

我最近问了这个问题：

[动态查询数据库以检查值](https://stackoverflow.com/questions/694849/dynamically-query-a-database-to-check-for-value/694860#694860)

我得到了一个很棒且内容丰富的答案。但是，每当我在 Google 上搜索以了解有关“Ajax 请求”的更多信息时，这些代码看起来都与提供的代码完全不同。我也使用了另一个使用它的教程，它是简写吗？或者是 jQuery 还是什么？

那种可怕的混乱，正在破坏我的能力，所以解决以下问题：

将字段的值发送到 PHP 脚本。我尝试使用以下内容：

```
$value = $GET["inputname"]; 
```

但这似乎不起作用。能否请你帮忙？我非常擅长 PHP，但我对 javascript 很陌生。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:06:30.720

```
$.get(url,{},verifyDb); 
```

是[jQuery ajax Get 方法](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)。你可以像这样传递一个参数：

```
$.get(url,{inputname: "value goes here"},verifyDb); 
```

$ 是 jQuery 对象的简写。我会熟悉[jQuery 文档](http://docs.jquery.com/Main_Page)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T22:10:29.900

也许我是个白痴但是

```
$value = $GET["inputname"]; 
```

应该：

```
$value = $_GET["inputname"]; 
```

还，

> 但是，每当我在 Google 上搜索以了解有关“Ajax 请求”的更多信息时，这些代码看起来都与提供的代码完全不同。

你需要在“ [jquery ajax requests](http://docs.jquery.com/Ajax) ”上搜索

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T23:13:01.297

问题可能是默认情况下 Ajax 请求通常是 POST 请求，而不是 GET。所以，在你的 PHP 脚本中，寻找`$_GET['blah']`是行不通的。`$_POST['blah']`如果您找到所需的变量，请尝试告诉我们。

# python - 以编程方式在 Python 中提交表单？

> ID：699238
> 
> 赞同：3
> 
> 时间：2009-03-30T22:09:44.847
> 
> 标签：python, google-app-engine, forms, post

刚开始玩 Google App Engine 和 Python（作为一个借口；））。如何正确提交这样的表格

```
<form action="https://www.moneybookers.com/app/payment.pl" method="post" target="_blank">
<input type="hidden" name="pay_to_email" value="ENTER_YOUR_USER_EMAIL@MERCHANT.COM">
<input type="hidden" name="status_url"
<!-- etc. -->
<input type="submit" value="Pay!">
</form> 
```

w/o 向用户公开数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T22:14:42.060

听起来您正在寻找[urllib](http://docs.python.org/library/urllib.html)。

这是从库的文档中发布的示例：

```
>>> import urllib
>>> params = urllib.urlencode({'spam': 1, 'eggs': 2, 'bacon': 0})
>>> f = urllib.urlopen("http://www.musi-cal.com/cgi-bin/query", params)
>>> print f.read() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T22:14:19.127

通过隐藏表单的敏感位并通过 JavaScript 提交。

确保你有一种引用表单元素的好方法......

```
<form ... id="moneybookersForm">...</form> 
```

...并在页面加载时，执行类似

```
document.getElementById("moneybookersForm").submit(); 
```

至少我不知道其他方法。对于 JavaScript 残障人士，付费！按钮应保持可见。

# sql - 什么查询将适用于这种子类型/超类型关系？

> ID：699239
> 
> 赞同：1
> 
> 时间：2009-03-30T22:09:51.040
> 
> 标签：sql, mysql

这是情况。我有 3 个表，一个超类型和两个子类型，子类型之间有关系：

```
|----------------|    |-------------------| |-------------------|
|      Post      |    |     Top_Level     | |      Comment      |   
|----------------|    |-------------------| |-------------------|   
| PK | ID        |    | PK, FK | Post_ID  | | PK, FK | Post_ID  |   
|    | DATE      |    |        | Title    | |     FK | TopLv_ID |   
|    | Text      |    |-------------------| |-------------------|   
|----------------| 
```

每个帖子，无论是评论还是 top_lev，都是唯一的，但实体共享一些属性。因此，comment 和 top_lev 是帖子的子类型。那是一部分。此外，评论与 top_lev 帖子相关联。此 ER 图说明了这一点：http: [//img11.imageshack.us/img11/9327/sampleer.png](http://img11.imageshack.us/img11/9327/sampleer.png)

我正在寻找的是按该顶级帖子上的活动排序的顶级帖子列表，可以是顶级帖子的创建，也可以是对该帖子的评论。

例如，假设我们有以下数据：

```
|------------------------|    |------------------|    |--------------------|
|      Post              |    |     Top_Level    |    |       Comment      |
|------------------------|    |------------------|    |--------------------|
| ID |    DATE    | Text |    | Post_ID  | Title |    | Post_ID  |TopLv_ID |
|----|------------|------|    |----------|-------|    |----------|---------|
|  1 | 13/03/2008 | shy  |    |     1    |  XYZ  |    |     2    |    1    |
|  2 | 14/03/2008 | mrj  |    |     3    |  ABC  |    |     4    |    1    |
|  3 | 15/03/2008 | quw  |    |     7    |  NMO  |    |     5    |    3    |
|  4 | 16/03/2008 | ksi  |    |------------------|    |     6    |    1    |
|  5 | 17/03/2008 | kso  |                            |--------------------|
|  6 | 18/03/2008 | aoo  |                            
|  7 | 19/03/2008 | all  |                            
|------------------------|     

|--------------------------------|
|            RESULT              |
|--------------------------------|
| ID |    DATE    | Title | Text |
|----|------------|-------|------|
|  7 | 19/03/2008 |  123  | all  |
|  1 | 13/03/2008 |  ABC  | shy  |
|  3 | 15/03/2008 |  XYZ  | quw  |
|--------------------------------| 
```

这可以用一个 select 语句来完成吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T23:45:14.040

您可能无意中完全混淆了您的问题，使其非常难以理解和回答（至少对于我们这些大脑较小的人来说）。您能否用合理的表和字段名称以及更完整的索引描述来重述它?

* * *

编辑：

您是否可能描述了一种产品被销售的情况，并且有时相同的产品可以作为组件递归地包含在其他产品中？如果是这样，还有更传统的成功方法来模拟这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T02:13:18.507

我尝试了这个查询，它给出了你描述的输出：

```
SELECT pt.id, pt.`date`, t.title, pt.`text`
FROM Top_Level t INNER JOIN Post pt ON (t.post_id = pt.id)
 LEFT OUTER JOIN (Comment c INNER JOIN Post pc ON (c.post_id = pc.id))
   ON (c.toplv_id = t.post_id)
GROUP BY pt.id
ORDER BY MAX(GREATEST(pt.`date`, pc.`date`)) ASC; 
```

输出：

```
+----+------------+-------+------+
| id | date       | title | text |
+----+------------+-------+------+
|  7 | 2008-03-19 | NMO   | all  | 
|  1 | 2008-03-13 | XYZ   | shy  | 
|  3 | 2008-03-15 | ABC   | quw  | 
+----+------------+-------+------+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T22:42:29.980

这绝对应该是可能的，只要“最后一次出现的日期”在 Sub1 和 Sub2 的列中表示。请注意，我列出的代码主要是伪代码......您必须根据您对 dbms 的风格填写空白。

要将您的结果集限制为仅 SUPER 和 SUB1 中的列（没有重复）：

```
SELECT DISTINCT sub1.*, super.* 
```

（显然，您应该尽量避免 SELECT *... 选择您实际需要的列）

You FROM 子句看起来像：

```
FROM super INNER JOIN sub1 ON super_id
    LEFT JOIN sub2 ON super_id AND sub1_id 
```

并且 ORDER BY 将使用 COALESCE 函数（如果您的 dbms 支持它）来确定要排序的列（COALESCE 选择参数列表中的第一个非空值）：

```
ORDER BY COALESCE(sub2.dateColumn, sub1.dateColumn) 
```

或者，如果你没有可用的 COALESCE 但你有可用的 ISNULL 函数，你可以链接 ISNULL：

```
ORDER BY ISNULL(firstDateColumn, ISNULL(secondDateColumn, thirdDateColumn)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T00:09:36.697

您没有建议或暗示可以重新设计架构，所以也许我问这个问题并不是对您和我的时间的最佳利用，但是：您的表**必须**以这种方式设计吗？此应用程序是否已投入生产使用？

引发我这个想法的是你的陈述：

> 所有事件都在某个日期发生，但编辑必须与原始创建事件相关联

我怀疑这是让 sub2 包含对 sub1 的 FK 的理由。但这对我来说就像是非规范化（在关系方面）或违反[DRY](http://en.wikipedia.org/wiki/Don't_repeat_yourself)原则（在敏捷方面）。无论哪种情况，它都可能使您的生活变得比需要的更复杂。

我的建议（值得您为此付出的代价）是将 FK 删除到 sub1。取而代之的是，您可以 1) 在页面的创建事件中包含一个 SELECT，作为查询的一部分，或者 2) 将创建日期移到页表中。（您采用哪些选项取决于架构中存在多少额外的复杂性；我通常更喜欢 #1 而不是 #2。）

我认为这将简化您的更新和查询。你的旅费可能会改变。

# tfs - 如何确定 SP1 是否已应用于我们的 TFS 2008 安装

> ID：699244
> 
> 赞同：3
> 
> 时间：2009-03-30T22:12:23.843
> 
> 标签：tfs

如果不需要，我不想为 Team Foundation server 2008 下载和安装 SP1。但是我不确定如何确定我们的服务器当前运行的是什么版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:57:49.740

如果您的客户端计算机上安装了 Visual Studio Team Explorer 2008 SP1，则查看源代码管理资源管理器以查看您是否在 Last Check-in Date 列中填充了任何内容。如果有数据则服务器为 SP1，如果没有则为 pre TFS2008 SP1。（请参阅我讨论此功能的[博客文章）](http://www.woodwardweb.com/teamprise/000436.html)

或者，如果您可以登录机器，请查看 ProgramFiles\Microsoft Visual Studio 2008 Team Foundation Server\Web Services\Services\bin\Microsoft.TeamFoundation.dll。SP1 的版本为 9.0.30428.1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T22:34:24.117

[这个工具](http://devmatter.blogspot.com/2008/10/tfsinfo-updated-for-tfs-2008-sp1.html)看起来可以完成这项工作。

# ruby-on-rails - 是否可以让数据库事务跨越 Rails 中的多个请求？

> ID：699246
> 
> 赞同：9
> 
> 时间：2009-03-30T22:13:35.667
> 
> 标签：ruby-on-rails, ruby, transactions

我有一个跨越多个页面的表单。现在设置的方式并不理想，因为它在提交时保存（到数据库）每个页面。因此，如果用户没有在所有页面上完成表单，那么数据库中就会保存一个不完整的用户注册。

如果用户没有完全填写表格，我想“回滚”保存。

那么有没有办法建立一个交易，当用户填写第一个表单时开始并在用户完成最后一页时结束？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T22:28:07.270

您正在寻找的是[acts_as_state_machine gem](http://github.com/rubyist/aasm/tree/master)。如果您不熟悉状态机，请查看[此处](http://en.wikipedia.org/wiki/Finite_state_machine)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T22:46:25.180

要回答具体问题，我认为没有任何方法可以在数据库意义上设置可以满足您需求的事务。想一想，你就会明白为什么：不能保证你的多页操作的各个部分都将由同一个进程处理。或者很可能甚至是同一台服务器。如果请求跨越数据库连接，就像在这种情况下一样，来自一个连接的未提交部分将对其他连接不可见。

除了已经提到的想法，我会考虑使用一个或多个“暂存”表来保存已经输入的不完整数据。然后当用户完成时，单个事务可以将数据应用到永久表并删除暂存数据。一旦您确信会话已终止或保留到用户返回时，后台进程可以根据年龄标准清除不完整的数据，如果这样可以更好地满足您的要求。

如果我希望定期进行不完整的交易，我会倾向于这种方法，因为这样我就不必在我的主要模型中处理不完整的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T22:20:47.973

我不知道你原来问题的答案，但无论如何......

为什么不将所有数据保存在会话变量中，而不是保存在每个页面上？然后最后你可以有一个页面将会话中的数据保存到数据库中？这样，您就不会在数据库中部分保存任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T22:25:00.130

我认为保存每一页是有价值的，因为如果这是一个长时间运行的过程并且用户在中间被打断，他们可能希望保存中间的、未提交的结果，然后从他们离开的地方继续。

如果您认为这也是一个好主意，那么您的设计将存储一个标志以指示特定部分是否是尚未完成的长期运行事务的一部分。当最后一块完成并按下保存按钮时设置标志。给出一个超时值，表示中间部分是否在一段时间后被“最终保存”批准，它们将被删除。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T22:36:26.483

打开一个跨越多个请求的数据库事务是一个坏主意。考虑用户在提交事务之前关闭浏览器的情况。您留下了一个既不回滚也不提交的孤立事务。

只需在数据库中放置一个类似 REG_COMPLETE 的标志，它只会在注册过程的最后一页上设置。然后你可以用不完整的记录过滤/擦洗/任何你喜欢的东西……也许给他们发一封电子邮件，提示他们完成？

# c++ - std::map 设计：为什么 map 接受比较器作为模板参数

> ID：699250
> 
> 赞同：0
> 
> 时间：2009-03-30T22:14:37.677
> 
> 标签：c++, stl, boost, map

STL 中的地图类型有下一个类型：

```
std::map< Key, Data, Compare, Alloc > 
```

作为我们可以传递`Compare`谓词的模板参数之一，为什么 map 接受这个谓词作为模板参数而不是构造函数中的对象？

它可以具有更灵活的接口，例如`boost::function< bool, const T&, const T& >`在构造函数中。
当然，我理解在设计 STL 时不存在 boost，但设计师可以在 boost::function 上创建类似的东西。

我相信它有一些深刻的原因。

**已编辑**
抱歉，您提出了虚拟问题，地图具有相同的可能性:)
在您回答后我的问题没有意义。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T22:23:42.787

模板参数是谓词的*类型*，而不是值。该值*可以*作为参数提供给构造函数。您可以指定与类型匹配的任何值。如给定的那样，默认类型是`std::less<Key>`，它几乎只有一个值，但您应该能够为`Compare`参数指定自己的类型，包括`boost::function`，然后使用各种值来控制地图对象的行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T22:20:51.013

地图确实有这样的构造函数。从 C++ 标准的第 23.3.1 节：

```
explicit map(const Compare& comp = Compare(),
const Allocator& = Allocator()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T22:20:02.170

因为`boost::function`是多态的，所以不能内联。STL 的设计旨在最大限度地发挥编译器进​​行代码内联的潜力，这在扩展模板上很容易；如果您需要它是多态的，您也可以轻松地决定使用它`boost::function`来提供比较。`std::map`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T22:24:20.523

使用比较对象会产生运行时成本——需要存储对象，并且必须通过指针进行比较。通过使用类，比较可以简化为单个表达式，例如在使用 int 键时。标准库的目标是不低于一个优秀的 C++ 程序员自己生成的效率。

# perl - 在 Perl 中如何知道文件是制表符还是空格？

> ID：699253
> 
> 赞同：2
> 
> 时间：2009-03-30T22:14:52.900
> 
> 标签：perl, csv

我正在从 HTML 页面将文件上传到 Perl 程序。上传文件后，我想确定文件是空格还是制表符分隔，所有值都是整数。如果不是这种情况，那么我想输出一些消息。

我正在考虑读取文件的每个字符并检查它是否是整数。如果失败，那么我将显示输出消息。有一个更好的方法吗？

我检查了几个示例，可以逐行读取整个文件，但是如何读取该行中的每个字符？我应该分割`space`还是`tab`文件可以分割？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T22:19:48.957

*在*空格和制表符上拆分很容易：

```
my @fields = split /[ \t]/, $line; 
```

但如果它必须只有一个或另一个，而你不知道提前哪个，那就有点棘手了。如果您知道输入中应该有多少列，您可以尝试计算每行上的空格数和制表符数，并查看分隔符的数量是否正确。例如，如果应该有 5 列并且您在每行上看到 4 个选项卡，那么用户使用选项卡作为分隔符是一个不错的选择。如果两者都不匹配，则返回错误。

检查整数值很简单：

```
for my $val ( @fields ) {
    die "'$val' is not an integer!" if $val !~ /^-?\d+$/;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T22:17:22.210

听起来它是否由空格或制表符分隔并不重要。您将不得不在某些时候读取文件的所有字符以验证它们并解析它们。为什么要做这两个步骤。使用文件中的整数，直到遇到不是空格或有效整数的内容，然后抱怨（并可能回滚）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T23:04:19.990

> 我正在从 html 页面将文件上传到 perl 程序。上传文件后，我想确定文件是否是（空格或制表符分隔）并且所有值都是整数。如果不是这种情况，那么我想输出一些消息。

这种情况意味着你的数据应该只包含数字、空格和制表符（基本上它应该是数字和空格，或者只有数字和制表符）。

为此，只需将数据加载到变量中，并检查它是否匹配：

```
$data =~ /\A[0-9 \t]+\z/; 
```

如果匹配 - 这将意味着您将拥有一组由空格或制表符分隔的整数（使用哪个字符来分隔整数并不真正相关）。

如果您的下一步是提取这些整数（这听起来合乎逻辑），您可以通过以下方式轻松完成：

```
@integers = split /[ \t]+/, $data; 
```

或者

```
@integers = $data =~ /(\d+)/g; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T00:27:30.617

你的问题不是很清楚。听起来您希望数据采用以下格式：

```
123 456 789
234 567 890 
```

换句话说，每一行包含一组或多组数字，以空格分隔。假设您按照您在原始问题中所说的那样一次处理一行文件，我会使用这个正则表达式：

```
/^\d+(\s+\d+)*$/ 
```

如果可能有负数，请改用：

```
/^-?\d+(\s+-?\d+)*$/ 
```

你的正则表达式不会匹配一个空行，这个也不会。这可能是应该的；我希望在这种情况下禁止空行（包括只包含空格的行）。但是，文件末尾可能有一个或多个空行。这意味着，一旦您找到与上面的正则表达式不匹配的行，您应该验证剩余的每一行的长度是否为零。

但我在这里做了很多假设。如果这不是您想要做的，您需要向我们提供更详细的要求。此外，所有这些都是对数据格式的粗略验证。如果您只是存储数据，那很好，但如果您还想提取信息，您可能应该将验证作为该过程的一部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T02:41:30.967

为了补充答案，我将写一个清晰而简单的答案。这个版本：

1.  只使用最基本的 Perl 函数和结构，所以任何对 Perl 有一点了解的人都应该很快掌握它。不要冒犯或任何事情，作为新手也没有什么可耻的——我只是想写一些无论你的技能水平如何都能理解的东西。
2.  接受制表符或空格作为分隔符，允许它们自由混合。注释掉的代码将详细说明一种在整个文档中强制执行非此即彼的简单方法。
3.  当遇到错误值时会打印出很好的错误消息。应该显示非法值和它出现的行。
4.  允许您随意处理数据。我不打算将它存储在数组或任何东西中，只需将 a`...`放在一个点上，然后您将在其中添加一些代码来对您想要执行的给定行上的数据进行任何处理。

所以这里是：

```
use strict;
use warnings;

open(my $data, "<", $filename);
# define $filename before this, or get it from the user

my $whitespace = "\t ";

chomp(my @data = <$data>);

# check first line for whitespace to enforce...
#if($data[0] =~ /\t/ and $data[0] !~ / /) {
#  $whitespace = "\t";
#} elsif($data[0] =~ / / and $data[0] !~ /\t/) {
#  $whitespace = " ";
#} else {
#  warn "Warning: mixed whitespace on line 1 - ignoring whitespace.\n";
#}

foreach my $n (0 .. $#data) {
  my @fields = split(/[$whitespace]+/, $data[$n]);
  foreach my $f (@fields) {
    if($f !~ /-?\d/) { # \D will call "-12" invalid
      if($f =~ /\s/) {
        warn "Warning: invalid whitespace use at line $n - ignoring.\n";
      } else {
        warn "Warning: invalid value '$f' at line $n - ignoring.\n";
      }
    } else {
      ... # do something with $f, or...
    }
  }
  ... # do something with @fields if you want to process the whole list
} 
```

有更好，更快，更紧凑，甚至更易读（取决于你问谁）的方法，但是这个使用最基本的结构，任何 Perl 程序员都应该能够阅读，无论技能水平如何（好吧，如果你刚开始将 Perl 作为第一语言，你可能对它一无所知，但是你不应该尝试做这样的事情）。

编辑：修复了我的正则表达式以匹配整数。它以前很懒惰，并且允许“12-4”，这显然不是整数（尽管它的计算结果为 1 - 但这要复杂得多（嗯，不是真的，但这不是 OP 想要的（或者是吗？它将是一个有趣的功能（在此处插入 LISP 笑话））））。谢谢 wisnij - 我很高兴我重新阅读了你的帖子，因为你写的正则表达式比我写的更好。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-31T01:57:35.033

我假设您的格式和期望的结果有几件事情。

*   连续的分隔符折叠。
*   数字可能不会环绕行，即新行是有效的分隔符。
*   一个文件中的制表符和空格是可以的。任何一个分隔符都是可以接受的。
*   文件足够小，一次处理整个文件不会成为问题。

此外，我的代码接受任何空格作为分隔符。

```
use strict;
use warnings;

# Slurp whole file into a scalar.
my $file_contents;
{   local $/;
    $/ = undef;
    $file_contents = <DATA>;
}

# Extract and validate numbers
my @ints = grep validate_integer($_), 
                split( /\s+/, $file_contents ); 
print "@ints\n";

sub validate_integer {
    my $value = shift;

    # is it an integer?
    # add additional validation here.
    if( $value =~ /^-?\d+$/ ) {
        return 1;
    }

    # die here if you want a fatal exception.
    warn "Illegal value '$value'\n";
    return;
}

__DATA__
1 -2 3 4
5 8.8
-6
    10a b c10 -99-
    8   9 98- 9-8
10 -11  12  13 
```

这导致：

```
Illegal value '8.8'
Illegal value '10a'
Illegal value 'b'
Illegal value 'c10'
Illegal value '-99-'
Illegal value '98-'
Illegal value '9-8'
1 -2 3 4 5 -6 8 9 10 -11 12 13 
```

**更新：**

*   固定处理负数。
*   将验证替换`map`为`grep`.
*   从 re切换到`split`而不是非空白捕获。

如果要逐行处理文件，可以将 包装`grep`在读取文件的循环中。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-30T22:17:09.883

您可以只使用正则表达式。这就是 Perl 的著名之处；-)。

简单的例子：

```
perl -ne 'if ($_=~/^(\d+\s+)+$/){print "yep\n";}' 
```

将只接受仅包含数字和空格的行。那应该让你继续前进。

# java - JAX-WS 使用 WS-Security 和 WS-Addressing 的 Web 服务

> ID：699254
> 
> 赞同：10
> 
> 时间：2009-03-30T22:15:52.167
> 
> 标签：java, web-services, jax-ws, ws-security, java-metro-framework

我正在尝试使用 JAX-WS (Metro) 开发一个独立的 Java Web 服务客户端，该客户端使用 WS-Security 和用户名令牌身份验证（密码摘要、随机数和时间戳）和时间戳验证以及基于 SSL 的 WS-Addressing。

我必须使用的 WSDL 没有定义任何安全策略信息。当 WSDL 不包含此信息时，我无法准确地弄清楚如何添加此标头信息（正确的方法）。我发现使用 Metro 的大多数示例都围绕着使用 Netbeans 从 WSDL 自动生成，这对我毫无帮助。我研究了 WSIT、XWSS 等，但没有太多清晰或方向。JBoss WS Metro 看起来也不太幸运。

任何人都有这样做的经验或对如何完成这项任务有建议？即使将我指向正确的方向也会有所帮助。除了必须基于 Java 之外，我不限于特定技术。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-06T15:36:41.753

我确实最终解决了这个问题，但我朝另一个方向去做。我的解决方案是使用 CXF 2.1 及其 JAX-WS 实现，将 CXF 的强大功能与我已经拥有的现有 Spring 基础架构相结合。起初我持怀疑态度，因为 CXF 需要大量的 jar，但最终它提供了最好和最简单的解决方案。

[改编自CXF 网站](http://cwiki.apache.org/CXF20DOC/jax-ws-configuration.html)的示例进行客户端配置，我在 spring 中使用自定义 CXF JAXWS 命名空间，并使用 Out Interceptor 进行用户名令牌身份验证（密码摘要、随机数和时间戳）和时间戳验证。完成这项工作的唯一其他步骤是创建我自己的密码回调处理程序，该处理程序为每个出站 SOAP 请求执行。

对于 SSL 配置，我再次通过管道转向[CXF 及其对 SSL 的支持](http://cwiki.apache.org/CXF20DOC/client-http-transport-including-ssl-support.html)，尽管我永远无法使用特定的 http:conduit 名称使 SSL 工作，但我不得不使用不推荐用于生产环境的通用名称。

下面是我的配置文件的示例。

**弹簧配置文件**

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:jaxws="http://cxf.apache.org/jaxws"
    xmlns:sec="http://cxf.apache.org/configuration/security"
    xmlns:http="http://cxf.apache.org/transports/http/configuration"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:cxf="http://cxf.apache.org/core"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
    http://cxf.apache.org/configuration/security http://cxf.apache.org/schemas/configuration/security.xsd
    http://cxf.apache.org/transports/http/configuration http://cxf.apache.org/schemas/configuration/http-conf.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
    http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd
    http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd">

    <context:property-placeholder location="meta/my.properties" />
    <context:component-scan base-package="com.foo" />

    <import resource="remoting.xml" />
    <jaxws:client id="myWebService" address="${my.endpointAddress}"
                  serviceClass="com.foo.my.ServicePortType">

<!-- Testing only, adds logging of entire message in and out -->
<jaxws:outInterceptors>
    <ref bean="TimestampUsernameToken_Request" />
    <ref bean="logOutbound" />
</jaxws:outInterceptors>
<jaxws:inInterceptors>
        <ref bean="logInbound" />
    </jaxws:inInterceptors>
    <jaxws:inFaultInterceptors>
        <ref bean="logOutbound" />
    </jaxws:inFaultInterceptors>

<!-- Production settings -->
<!--
    <jaxws:outInterceptors> <ref bean="TimestampUsernameToken_Request" />
    </jaxws:outInterceptors>
    -->
</jaxws:client >

<!--
    CXF Interceptors for Inbound and Outbound messages
    Used for logging and adding Username token / Timestamp Security Header to SOAP message
-->
<bean id="logInbound" class="org.apache.cxf.interceptor.LoggingInInterceptor" />
<bean id="logOutbound" class="org.apache.cxf.interceptor.LoggingOutInterceptor" />

<bean id="TimestampUsernameToken_Request" class="org.apache.cxf.ws.security.wss4j.WSS4JOutInterceptor">
    <constructor-arg>
        <map>
            <entry key="action" value="UsernameToken Timestamp" />
            <entry key="user" value="${my.group}.${my.userId}" />
            <entry key="passwordType" value="PasswordDigest" />
            <entry key="passwordCallbackClass" value="com.foo.my.ClientPasswordHandler" />
        </map>
    </constructor-arg>
</bean>

<!--
    http:conduit namespace is used to configure SSL using keystores, etc
    *.http-conduit works but CXF says its only supposed to be for temporary use (not production),
    well until the correct way works, we're going to use it.
-->
<http:conduit name="*.http-conduit">
    <http:tlsClientParameters   
                  secureSocketProtocol="SSL">
                  <!--
          <sec:trustManagers>
        <sec:keyStore type="JKS"
                         password="${my.truststore.password}"
                         file="${my.truststore.file}" />
                  </sec:trustManagers>
                  -->
                  <sec:keyManagers keyPassword="${my.keystore.password}">
                    <sec:keyStore type="JKS"
                         password="${my.keystore.password}"
                         file="${my.keystore.file}" />
                  </sec:keyManagers>

                  <!-- Cipher suites filters specify the cipher suite to allow/disallow in SSL communcation  -->
                  <sec:cipherSuitesFilter>
                    <sec:include>.*_WITH_3DES_.*</sec:include>
                    <sec:include>.*_EXPORT_.*</sec:include>
                    <sec:include>.*_EXPORT1024_.*</sec:include
                    <sec:include>.*_WITH_DES_.*</sec:include
                    <sec:exclude>.*_WITH_NULL_.*</sec:exclude
                    <sec:exclude>.*_DH_anon_.*</sec:exclude>
                  </sec:cipherSuitesFilter>
    </http:tlsClientParameters>
</http:conduit>
</beans> 
```

* * *

**Java 客户端密码处理程序**：

```
import java.io.IOException;

import javax.security.auth.callback.Callback;
import javax.security.auth.callback.CallbackHandler;
import javax.security.auth.callback.UnsupportedCallbackException;

import org.apache.log4j.Logger;
import org.apache.ws.security.WSPasswordCallback;

/**
 * <p>
 * Provides a callback handler for use processing outbound/inbound SOAP messages.
 * ClientPasswordHandler sets the password used in the WS-Security UsernameToken 
 * SOAP header.
 * 
 * </p>
 * 
 * Created: Apr 1, 2009
 * @author Jared Knipp
 * 
 */
public final class ClientPasswordHandler implements CallbackHandler {
    protected static Logger log = Logger.getLogger(ClientPasswordHandler.class);

    private static final PropertyManager PROPS = PropertyManager.getInstance();
    private static String PASSWORD = PROPS.getPassword();
    private static boolean IS_PASSWORD_CLEAR = PROPS.getIsClearPassword();

    /**
     * Client password handler call back.  This method is used to provide
     * additional outbound (or could be inbound also) message processing.
     * 
     * Here the method sets the password used in the UsernameToken SOAP security header
     * element in the SOAP header of the outbound message.  For our purposes the clear 
     * text password is SHA1 hashed first before it is hashed again along with the nonce and 
     * current timestamp in the security header.
     */
    public void handle(Callback[] callbacks) throws IOException, UnsupportedCallbackException {
        if(log.isDebugEnabled()) { log.debug("Setting password for UsernameToken"); }
        WSPasswordCallback pc = (WSPasswordCallback) callbacks[0];

        // Check to see if the password is already Hashed via SHA1, if not then hash it first
        if(IS_PASSWORD_CLEAR) {
            synchronized(this) {
                PASSWORD = PasswordDigestUtil.doPasswordDigest(PASSWORD);
                IS_PASSWORD_CLEAR = false;
                PROPS.setIsClearPassword(IS_PASSWORD_CLEAR);
                PROPS.setPassword(PASSWORD);
                PROPS.saveProperties();
            }
        }

        pc.setPassword(PASSWORD);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T22:21:01.980

如果信息不在 WSDL 中，您确定它在 WSDL 描述的服务中吗？WSDL 旨在提供描述服务所需的所有信息，包括使用服务所需的安全策略。

WSDL 来自什么平台？WSDL 是否有可能不是完整的描述？例如，它可能是一个*包含*在另一个提供安全信息的WSDL*中的 WSDL。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-29T07:16:11.897

这里有一篇文章解释了如何使用 WS-Security 在 CXF 中配置客户端和服务器：[JAX-WS Web Services with Spring and CXF](http://blog.jeshurun.ca/technology/jax-ws-web-services-with-spring-and-cxf)

# php - Jquery X，Y位置通过ajax发送

> ID：699257
> 
> 赞同：0
> 
> 时间：2009-03-30T22:17:10.010
> 
> 标签：php, jquery

我需要一个示例，该示例使用 jquery 将 a `<div>`（左上角像素）的当前 x,y 位置发送到使用 ajax 的 php 文件，然后可以处理该位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:28:55.160

假设最近版本的 JQuery，您可以使用以下给定的 div 的 ID 是“divName”：

```
$("#divName").offset(); 
```

供参考：[http ://docs.jquery.com/CSS/offset](http://docs.jquery.com/CSS/offset)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-14T08:01:23.747

```
变量 cX = 0; var cY = 0;
//跟随鼠标..（平台无关，基于文档尺寸，而不是窗口）
$().mousemove(函数(e){
 cX = e.pageX;
     cY = e.pageY;
});

```

然后，只需根据需要使用 cX 和 cY 变量。它会自动考虑滚动偏移量。非常简单/方便，DHTML 从未如此出色！

如果您只需要在某个元素上使用它，您可以使用简单的 css 样式选择器来抓取它，例如：

```
$("#myid").mousemove...
$(".myclass").mousemove...
$("table tr").mousemove...
$(".interestingdivclass .subclass 输入：复选框").mousemove...

```

以下问题具有 ajax 组件：

[使用 AJAX 来回发送信息](https://stackoverflow.com/questions/1008291/sending-information-back-and-forth-with-ajax)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T22:24:34.937

对于 x,y 坐标，您可以使用尺寸插件（位置函数）：[http ://docs.jquery.com/Plugins/dimensions](http://docs.jquery.com/Plugins/dimensions)

# flash - Adobe Flash 信任哪些根证书？

> ID：699264
> 
> 赞同：1
> 
> 时间：2009-03-30T22:18:49.193
> 
> 标签：flash, https, ssh, adobe

我正在使用 URLLoader 通过 HTTPS 进行 Web 请求，我需要知道 Flash 信任哪些签名权限。

我已确定我无法对密钥进行自签名，但无法从 Adob​​e 找到任何关于谁是受信任的签名机构的文档。Flash 是否使用浏览器的受信任权限？如果您使用的是 AIR，它使用什么列表？是否因平台而异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T22:27:31.810

我确实相信，在浏览器中运行时，Flash 是发出所有请求并最终决定这些事情的浏览器。但是当它在空中运行时我不知道。

[这是](http://help.adobe.com/en_US/AIR/1.5/devappsflex/WS5b3ccc516d4fbf351e63e3d118666ade46-7ff0.html)您可以用来签署空中文件的授权列表，我说这是一个安全的赌注，它们可以用来保护在空中运行的 https 连接。

# reporting-services - 使用 SSRS 的多个查询报告

> ID：699267
> 
> 赞同：0
> 
> 时间：2009-03-30T22:20:02.530
> 
> 标签：reporting-services, reportingservices-2005

我希望我的报告显示来自两个选择语句的结果。基本上，一个 select 语句是活动用户，另一个是非活动用户。

如何构建报告的数据选项卡（我使用的是 SSRS-2005）？

谢谢

坦率

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T22:27:26.740

有两种方法可以解决这个问题：

1.  在“数据”选项卡中有两个查询 - 一个用于活动用户，一个用于非活动用户。然后在您的报告上简单地删除两个表并将其中一个指向“活动用户”数据集，另一个指向“非活动用户”数据集。

2.  有一个查询返回所有用户，无论是否活跃，以及他们的“活跃”状态列。现在在您的报表上放置两个表并将它们都指向这个单一的数据集。然后，在每个表的属性中，设置过滤器，使一个表只显示活动用户，另一个表显示非活动用户。

我不赞成其中一种方法胜过另一种方法，但我可能倾向于第二种方法，因为它只是到数据库的一次往返。但是，在报告呈现期间过滤的开销可能并不值得 - 您必须尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-05T14:44:34.503

您可以尝试以下方法：

这个想法很大程度上取决于您在查询中区分活跃用户和非活跃用户的方式。

但是对于这种情况和其他情况：

```
 Select 
    case when (active=1) then [USERNAME] else NULL end ACTIVEUSERS,
    case when (active=0) then [USERNAME] else NULL end NONACTIVEUSERS
    FROM myTable 
```

然后，您可以在 SSRS 表单中以您希望的方式使用这两列。

# python - 将数字转换为二进制字符串

> ID：699285
> 
> 赞同：4
> 
> 时间：2009-03-30T22:26:23.777
> 
> 标签：python, binary, hex

这是将 Python 数字转换为十六进制字符串的最佳方法吗？

```
number = 123456789
hex(number)[2:-1].decode('hex') 
```

有时它不起作用并在您执行 1234567890 时抱怨奇怪长度的字符串。

澄清：

我要从 int 到 hex。

另外，我需要它被逃脱。

IE: 1234567890 -> '\x49\x96\x02\xd2' 不是 '499602D2'

此外，它需要能够接受任何 Python 整数。IE。比 Int 更大的东西。

**编辑：**

这是迄今为止我从 Paolo 和 Devin 的帖子中拼凑起来的最佳解决方案。

```
def hexify(num):
    num = "%x" % num

    if len(num) % 2:
        num = '0'+num

    return num.decode('hex') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T22:28:52.447

您可以使用[字符串格式](http://docs.python.org/library/stdtypes.html#string-formatting)：

```
>>> number = 123456789
>>> hex = "%X" % number
>>> hex
'75BCD15' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T22:47:49.170

我不确定你到底想要什么，但你看过这个[`struct`](http://docs.python.org/library/struct.html)模块吗？

给定

```
>>> hex(123456789)
'0x75bcd15' 
```

你可以做：

```
>>> struct.pack('i', 123456789)
'\x15\xcd[\x07' 
```

请注意`'\x5b' == '['`.

此外，您可以反转字节顺序：

```
>>> struct.pack('>i', 123456789)
'\x07[\xcd\x15' 
```

编辑：我不确定您所说的“大于长”是什么意思，因为 python 中的 AFAIK 长是无界的（内存除外）。但是，您可以通过除法和连接来处理更大的整数。例如给定：

```
>>> n = 123456789012345678901234567890 
```

目标是：

```
>>> hex(n)
'0x18ee90ff6c373e0ee4e3f0ad2L' 
```

所以：

```
>>> s = ''
>>> while n >= 2**32:
...  n, r = divmod(n, 2**32)
...  s = struct.pack('>l', r) + s
... 
>>> s = struct.pack('>l', n) + s 
```

看到与上面`s`的结果相匹配`hex(n)`：

```
>>> s
'\x00\x00\x00\x01\x8e\xe9\x0f\xf6\xc3s\xe0\xeeN?\n\xd2' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-03T02:05:45.927

```
'{0:b}'.format( number ) 
```

参考[http://docs.python.org/library/string.html](http://docs.python.org/library/string.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T22:31:03.563

> 有时它不起作用并在您执行 1234567890 时抱怨奇怪长度的字符串。

因为没有意义。您如何在需要 2 位或 4 位数字的空间中放置“AAB”？每个字节是两个十六进制字符。当您有奇数个十六进制字符时，所需的结果是不明确的。您希望它相当于 0AAB 还是 AAB0？如果您知道您希望它等同于哪一个，只需在解码之前将该字符添加到正确的位置即可。

即`(('0' + foo) if len(foo) % 2 else foo).decode('hex')`其中 foo 是由返回的形式的字符串`%x.`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T22:33:40.080

正如 Paolo 提到的，字符串格式化是要走的路。请注意，您可以在小写和大写字母之间进行选择：

```
>>> hex = lambda n: '%X' % n
>>> hex(42)
'2A'
>>> hex = lambda n: '%x' % n
>>> hex(42)
'2a'
>>> def escaped(n):
...     s = hex(n)
...     if len(s) & 1:
...          s = '0' + s
...     return ''.join(chr(int(s[i:i + 2], 16)) for i in range(0, len(s), 2))
...
>>> escaped(123)
'{'
>>> escaped(1234)
'\x04\xd2'
>>> escaped(12348767655764764654764445473245874398787989879879873)
'!\x01^\xa4\xdf\xdd(l\x9c\x00\\\xfa*\xf3\xb4\xc4\x94\x98\xa9\x03x\xc1' 
```

请注意，如果十六进制数字为奇数，则*转义会添加前导零。*此解决方案适用于任何长度的字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T22:47:32.993

如果您知道输出字符串应该有多长，那么字符串格式将起作用。例如，要获取四个字符的字符串，您需要格式化长度为 8：

```
>>> "{0:08x}".format(123456789).decode("hex")
'\x07[\xcd\x15'
>>> "{0:08x}".format(1234567890).decode("hex")
'I\x96\x02\xd2' 
```

如果您的号码没有“填满”字符串，这将在前面添加零。例如，对于六个字符的字符串：

```
>>> "{0:012x}".format(123456789).decode("hex")
'\x00\x00\x07[\xcd\x15'
>>> "{0:012x}".format(1234567890).decode("hex")
'\x00\x00I\x96\x02\xd2' 
```

**编辑：**

要“检测”目标字符串的长度，您可以使用以下`math.log`函数：

```
>>> def int2str(n):
        l = int(math.ceil(math.log(n, 256) / 2) * 4)
        return ("{0:0{1}x}").format(n, l).decode("hex")

>>> int2str(123456789)
'\x07[\xcd\x15'
>>> int2str(1234567890)
'I\x96\x02\xd2' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-29T10:23:44.447

对于任意数字，最可靠的方法之一是像这样使用“数组”模块：

```
from array import array
binArr = array('B')

while(data):
    d = data & 0xFF
    binArr.append(d)
    data >>= 8

hexStr = binArr.tostring() 
```

# actionscript-3 - Flex 3 XML 馈送 TileList 将所选项目传递给另一个组件

> ID：699299
> 
> 赞同：0
> 
> 时间：2009-03-30T22:31:14.187
> 
> 标签：actionscript-3, flex3

我在创建完成时有一个由 xml 填充的 TileList，我希望将所选项目中的图像传递给图像组件的源。

这是主要应用程序：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="horizontal" backgroundColor="#FFFFFF">
<mx:ArrayCollection id="theImages"></mx:ArrayCollection>
<mx:Model id="items" source="items.xml" />
<mx:Script>
    <![CDATA[
        import ItemListObject;
        public function initList():void
         {
          for each ( var node:Object in items.image ) {
           var temp:ItemListObject = new ItemListObject();
           temp.strThumbnail = node.strThumbnail;
           temp.title = node.title;
           theImages.addItem(temp);
          }
 }
    ]]>
</mx:Script>
<mx:XML source="adjectives.xml" id="adjectivesXML"/>
    <mx:Canvas x="20" y="20">
        <mx:Image 
            id="item"
            source="????" 
            autoLoad="true" 
            width="500" 
            height="500" 
            scaleContent="true"/>
    </mx:Canvas>
    <mx:TileList id="imageTileList"
        itemRenderer="CustomItemRenderer"
        dataProvider="{theImages}"
        width="400"
        height="400"
        columnCount="2"
        creationComplete="initList();"/>
    </mx:Application> 
```

我为 Image 组件的来源尝试了不同的方法，但没有任何效果，所以我只输入了 4 个问号。这是 CustomItemRenderer：

```
 <?xml version="1.0" encoding="utf-8"?>
    <mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
    horizontalAlign="center"
    verticalAlign="middle"
    verticalGap="0"
    width="150"
    height="150"
    paddingRight="5"
    paddingLeft="5"
    paddingTop="5"
    paddingBottom="5">

    <mx:Image id="img" height="100" width="100" source="{data.strThumbnail}" />
    <mx:Label height="20" width="75" text="{data.title}" textAlign="center" color="0x000000" fontWeight="normal" />
</mx:VBox> 
```

这是items.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<items>
 <image id="1">
    <title>Image 1</title>
    <strThumbnail>1.jpg</strThumbnail>
 </image>
 <image id="2">
    <title>Image 2</title>
    <strThumbnail>2.jpg</strThumbnail>
 </image>
 <image id="3">
    <title>Image 3</title>
    <strThumbnail>3.jpg</strThumbnail>
 </image>
 <image id="4">
    <title>Image 4</title>
    <strThumbnail>4.jpg</strThumbnail>
 </image>    
</items> 
```

这是 ItemsListObject.as

```
package
{
 [Bindable]
 public class ItemListObject extends Object
 {
  public function ItemListObject() {
   super();
  }

  public var title:String = new String();
  public var strThumbnail:String = new String();
 }
} 
```

这是一个非常粗略的例子，但是一旦我克服了这个困难，我将能够做更多我想做的事情。谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T00:28:18.540

最快的方法是：

```
<mx:Image id="img" source="{imageTileList.selectedItem.strThumbnail}" /> 
```

数据对象是在项目渲染器中使用，而不是在它之外。一个数据对象代表您传递给渲染器的 xml 中的一张图像。

请务必在[此处](http://www.adobe.com/devnet/flex/quickstart/using_item_renderers/)查看项目渲染器的文档。

# coding-style - 如果你打破了长代码行，你如何缩进下一行的内容？

> ID：699300
> 
> 赞同：38
> 
> 时间：2009-03-30T22:32:39.957
> 
> 标签：coding-style, indentation, line-breaks

有时你必须在你的源代码中写很长的行，这更好地打破。你如何缩进受此影响的东西。

你可以同样缩进：

```
very long
statement;
other statement; 
```

如示例中所示，这使得与以下代码区分开来变得更加困难。另一方面，您可以将其缩进一级：

```
very long
   statement;
other statement; 
```

这使得它更容易，但它可能会发生，长行是嵌套块的开始，您想要缩进，如下所示：

```
if ((long test 1) &&
   (long test 2) &&
   (long test 3)) {
   code executed if true;
} 
```

在这种情况下，又很难阅读。我能想到的第三种可能性是根本不换行，现代编辑器可以处理它并创建软换行符。但是对于另一个编辑器，您必须横向滚动并且您不能影响位置，编辑器会打破您的长线。

你更喜欢哪种可能性？你有其他想法来解决这个问题吗？你能用充分的理由支持你的偏好吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-30T22:45:30.020

我喜欢自己的大括号，因为我可以更容易地将条件和内部块视为一个项目（如果你知道我的意思）：

```
if ((long test 1)
    && (long test 2)
    && (long test 3)) 
{
    code executed if true;
} 
```

我喜欢用条件开始附加条件行，因为我发现“加入”条件非常重要，并且在前一行的末尾往往会被忽略。

我还尝试缩进以使括号的效果显而易见（尽管尝试避免长条件通常是一件好事）。

我尝试构建东西，以便我可以轻松地“扫描”“东西”:)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-03-30T22:51:56.773

你应该**尽量避免写超过 80 个字符的行，**而不是打断它们：

*   尝试通过转换条件和封装代码来最小化缩进。

> Linus Torvalds：如果你需要超过 3 级的缩进，无论如何你都搞砸了，
> 应该修复你的程序。

除了条件是您封装的其他内容准备好在其他地方使用之外，这还具有使您的代码更具可读性的副作用。

```
bool encapsulatedLongCondition() // Add some parameters
{
  if (!condition1)
    return false;

  if (!condition2)
    return false;

  // ... (Other conditions)

  return true;
}    

if (encapsulatedLongCondition())
{
  // ... (Call some methods, try not to introduce deeper if/loop levels!)
} 
```

通过布尔代数简化条件并尝试反转条件和返回值会很有帮助。:-)

另见：[你能简化这个算法吗？](https://stackoverflow.com/questions/380885/can-you-simplify-this-algorithm/381034#381034) 另请参阅 2：Refactor for C# 能够帮助您解决此问题。;-)

*   使用类型定义并尽量避免长名称

一个简单的例子，想象一下在另一个容器中使用没有 typedef 的 Days 和更长的名称需要多长时间。

```
struct Day
{
  // Some data
};
struct Event
{
  // Some data
};
typedef list<Event> Events;
typedef map<Day, Event> Days;
// Some other container that would else be long... 
```

*   ...（您应该尝试分析为什么您的线路很长并找到解决方案）

希望您了解总体思路，这样您就不需要提出肮脏的换行符。;-)

我会看到出现长行的唯一地方是在您的函数原型中，或者在调用它们时，您应该尝试在最后一个可能的逗号之后中断并继续下一行。而不是在每一个之后都这样做并浪费多行使滚动膨胀并且您的函数过于突出......如果您碰巧经常看到这些长行，您可以将返回类型放在函数名称之前的行上。

```
void longFunctionName(ParameterType1 parameter1, ParameterType2 parameter2,
                      ParameterType3 parameter3, ParameterType4 parameter4) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-11-17T15:12:01.040

一般来说，我会：

```
if (condition) {
     something;
} 
```

用于块分隔符。但是，如果遇到长线我要分手的情况，我用这个：

```
if (
    (long test 1) &&
    (long test 2) &&
    (long test 3)
) {
    code executed if true;
} 
```

与 rbobby 的回答的主要区别：

1.  每行末尾的运算符而不是后续行的开头，以非常清楚地在视觉上指示该行不完整
2.  在条件元素之前的第一行换行 - 这有助于保持代码“形状”一致。
3.  右括号不缩进。

这具有使参数/条件列表看起来有点像代码块的视觉效果（但使用括号而不是花括号。我发现对称性令人愉悦。它还避免了一行裸露的开口花括号（我认为这看起来很糟糕） .

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-30T22:36:02.337

我有两个简单的规则：

1.  语句块：一个缩进；
2.  续行：两个缩进或括号对齐，无论进一步缩进。

因此，在 if 情况下：

```
if ((long test 1) &&
        (long test 2) &&
        (long test 3)) {
    code executed if true;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-30T22:59:22.217

我对这里已经写的内容略有不同：

```
if ((long test 1) &&
    (long test 2) &&
    (long test 3)) 
{
    code executed if true;
} 
```

我喜欢将布尔运算符放在行尾。

长方法名，或者有很多参数的方法是这样的：

```
reallyLongMethodName (paramA,
                      paramB,
                      paramC); 
```

位与上面的参数名称对齐；不是括号...

此外，为了减少缩进，我已经开始在我的代码中使用多个返回点，以及在我的循环中继续和中断。例如

```
for(int i = 0; i < MAX; i++)
{
    if(!isPrime(i)) // predefined prime finding func
        continue;

    //now we have only prime values of i
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-31T00:17:09.660

总是缩进，但 if 语句是特殊的；我喜欢排列测试，我把额外的`&&`运算符放在左边：

```
if (  (long test 1)
   && (long test 2)
   && (long test 3)) 
{
    code executed if true;
} 
```

也可以将其拉到`&&`左侧以对齐`if`，但我发现这种替代方法更难阅读。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-30T22:36:03.943

我支持**“不要与 IDE 对抗”。**

但是，我的 IDE（Eclipse、Visual Studio）想要断行是它们的断行方式。

这可能意味着语言之间的不一致，这没关系。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T22:55:50.587

我想说的是，只要符合以下标准，您使用哪种方法并不重要：

*   这是明智的
*   您在整个代码中应用相同的约定。

如果您在团队开发中，*请*尝试通过某种神秘的投票机制就你们之间的约定达成一致，如果您无法达成一致并且没有人可以发号施令。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-30T23:23:43.780

以特定方式格式化代码的唯一原因是使其可读。这本质上是主观的 - 以一种看起来不错的方式进行操作，并且您觉得对于第一次查看代码的人来说更具可读性。我要打破传统观点，说，不要担心任何共同的标准 - 有两个原因

1）在这种情况下很难，因为虚线有很多不同的可能性

2）它不买你什么。时期。再一次，代码格式化只是为了让你的代码可读，有一种格式化代码细节的标准方法并不会给你带来可读性。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-30T22:34:41.777

使用 astyle 或您正在使用的任何自动压头。它似乎做得足够好，通常还有更重要的事情需要考虑。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-30T22:35:44.287

我将括号中的表达式保持在开头的级别：

```
if ((long test 1) &&
    (long test 2) &&
    (long test 3)) {
  code executed if true;
} 
```

这使得每个表达式处于哪个级别变得很明显。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-30T22:43:40.850

在我看来，78 或 80 个字符的行宽很有用，因为它可以更容易地在同一个屏幕上打开多个文件。

理由，[Linus Torvalds 的一句话](https://computing.llnl.gov/linux/slurm/coding_style.pdf)怎么样？:)

> 答案是，如果你需要超过 3 级的缩进，无论如何你都搞砸了，应该修复你的程序。

我通常遵循[Google C++ 编码风格](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)（我猜你也可以适应 Java）和[这种 C++ 编码风格](http://www.possibility.com/Cpp/CppCodingStandard.html)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-30T22:43:47.637

我几乎从不在同一行缩进。但是，我在非常罕见的情况下重新初始化了一堆像这样的变量

```
a 
= b
= c
= d
= e
= f
= 0; 
```

不过，这样做的一个关键是将赋值运算符保留为下一行的第一个字符。这将给maint。当他们看到它时，程序员一个 WTF 时刻，迫使他们看，而不仅仅是掩饰它。

包装一个很长的声明，我会在我认为有意义的地方做......不一定在第一个缩进。所以 ：

```
reallyLongMethodName (paramA,paramB,paramC); 
```

不会像这样被格式化

```
reallyLongMethodName (paramA,
    paramB,
    paramC); 
```

但最终会更像

```
reallyLongMethodName (paramA,
                    paramB,
                    paramC); 
```

所有参数都与左括号对齐。

对于if's and whiles，我会做类似的事情

```
if((long test 1) 
&& (long test 2) 
&& (long test 3))
{
    code executed if true;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-03-09T06:14:12.323

对于 Java，Oracle 提供了这些约定。[Java 代码约定 - Oracle。](http://www.oracle.com/technetwork/java/codeconventions-150003.pdf)

*   逗号后中断
*   在操作员之前休息
*   更喜欢高级别的中断而不是低级的中断
*   将新行与上一行同一级别的表达式开头对齐
*   如果上述规则导致代码混乱或代码被挤压到右边距，只需缩进 8 个空格

例如，

```
longName1 = longName2 * (longName3 + longName4 - longName5)
            + 4 * longname6; // PREFER
longName1 = longName2 * (longName3 + longName4
                        - longName5) + 4 * longname6; // AVOID 
```

其他 ：

```
//DON’T USE THIS INDENTATION
if ((condition1 && condition2)
    || (condition3 && condition4)
    ||!(condition5 && condition6)) { //BAD WRAPS
    doSomethingAboutIt(); //MAKE THIS LINE EASY TO MISS
}
//USE THIS INDENTATION INSTEAD
if ((condition1 && condition2)
        || (condition3 && condition4)
        ||!(condition5 && condition6)) {
    doSomethingAboutIt();
}
//OR USE THIS
if ((condition1 && condition2) || (condition3 && condition4)
        ||!(condition5 && condition6)) {
    doSomethingAboutIt();
} 
```

该文档中给出了更多示例。

# c++ - int x = 'fooo' 是编译器扩展吗？

> ID：699301
> 
> 赞同：4
> 
> 时间：2009-03-30T22:33:16.350
> 
> 标签：c++, c, gcc

我已经看到并使用了如下 C++ 代码：

```
int myFourcc = 'ABCD'; 
```

它适用于最新版本的 GCC，但不确定最近的版本。这个功能在标准中吗？这叫什么？

我在网上搜索它时遇到了麻烦......

编辑：

我也为未来的观察者找到了这个信息：

来自[gcc 文档](http://gcc.gnu.org/onlinedocs/cpp/Implementation_002ddefined-behavior.html#Implementation_002ddefined-behavior "gcc 文档")

> 编译器一次为一个字符赋值一个多字符字符常量，将前一个值左移每个目标字符的位数，然后在截断到目标宽度的新字符的位模式中进行或运算特点。最终的位模式被赋予 int 类型，因此是有符号的，无论单个字符是否有符号（与 GCC 3.1 和更早版本略有不同）。如果常量中的字符多于目标 int 中的字符数，编译器会发出警告，并且忽略多余的前导字符。
> 
> 例如，具有 8 位字符的目标的“ab”将被解释为`(int) ((unsigned char) 'a' * 256 + (unsigned char) 'b')', and '\234a' as` (int) ((unsigned char) '\234' * 256 + (unsigned char) 'a')'。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T22:47:20.373

请参阅 C99 标准的第 6.4.4.4 节第 10 段：

> 整数字符常量的类型为`int`。包含映射到单字节执行字符的单个字符的整数字符常量的值是被解释为整数的映射字符表示的数值。包含多个字符（例如 `'ab'`）或包含不映射到单字节执行字符的字符或转义序列的整数字符常量的值是实现定义的。如果整数字符常量包含单个字符或转义序列，则其值是当类型`char`为单个字符或转义序列的值的对象转换为 type时产生的值`int`。

回想一下，*实现定义*意味着实现（在本例中为 C 编译器）可以做任何它想做的事情，但**必须记录在案**。

大多数编译器会将其转换为与对应于各个字符的八位字节的串联相对应的整数常量，但字节序可以是小端或大端，具体取决于目标体系结构的字节序。

因此，可移植代码不应使用多字符常量，而应使用纯整数常量。而不是`'abcd'`, 可以是任何一种字节序，使用 0x61626364 或 0x64636261，它们具有已知的字节序（分别为大和小）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T22:38:40.927

“请注意，根据 C 标准，字符常量的长度没有限制，但是包含多个字符的字符常量的值是实现定义的。最新版本的 GCC 提供了对多字节字符常量的支持，在这种情况下，会生成警告*多字符字符常量*或*警告：字符常量对于其类型而言太长*，而不是错误。”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T22:38:29.273

C++ 标准草案说：

> 字符文字是用单引号括起来的一个或多个字符，如 'x'

和

> 包含多个 c-char 的普通字符文字是多字符文字。多字符文字具有 int 类型和**实现定义的 value**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T22:39:21.343

是的，它是标准的，但由实现定义。

在实际经验中，它表示通过连接字节“A”、“B”、“C”和“D”得到的 32 位整数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T23:07:54.567

如果有人感兴趣，给出的具体示例是数据存储格式的 ID。
能够获得人类可读的常量值（例如“XVID”而不仅仅是 1234）是非常有用的。当您组成任意整数键时，值得考虑一下。

# html - Internet Explorer 6 不显示我的导航

> ID：699304
> 
> 赞同：1
> 
> 时间：2009-03-30T22:33:53.293
> 
> 标签：html, css, internet-explorer-6

我正在做噩梦，整天都在尝试这个，并且没有成功搜索谷歌。我有一个向左浮动的小导航，我想让它适用于 RTL 语言。它在 FireFox 中运行良好，但 IE6 根本不显示它。

有人能告诉我为什么吗？

HTML 是默认标记.. 没什么花哨的

```
<div id="topnav">
<ul>
<li><a href="#"><?php print NAV_HOME; ?></a></li>
<?php wp_list_pages('sort_column=menu_order&depth=1&title_li='); ?>
</ul>
</div> 
```

```
 #topnav ul {
    float: left;
    margin: 0 0 0 30px;
}

#topnav li {
    float: right;
    padding: 0;margin:0;
    margin-left: 10px;
    padding-left: 10px;
    background: url(img/topnav_br.png) no-repeat left center;
} 
```

关键是它将向左浮动，但 LI 项目将从右到左开始，因为它的 RTL 语言.. 但上面的代码在 IE6 中没有显示任何内容，但在 FF 中有效。

有人请告诉我我在这里做错了什么。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:52:59.347

您可能已经被[“hasLayout”错误](http://msdn.microsoft.com/en-us/library/bb250481.aspx)所困扰。试试这个：

```
#topnav ul {
    float: left;
    margin: 0 0 0 30px;
    zoom:1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T17:06:24.320

你没有提供足够的信息。如果您没有指定宽度，IE 将默认为可用空间的 100%（在其父级内）。

以下代码（带有背景颜色）清楚地显示（在 IE6 中），列表项在 ul 内一直浮动到右侧（实际上距离显示窗口 30px，左侧有双倍边距）。我们不知道您的容器是什么（如果有）或您正在使用什么文档类型（如果有）。我们不知道还有什么正在浮动。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
<head>
<title>Float right li test</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
body { margin: 0;
    padding: 0;
}
#topnav ul {
    float: left;
    margin: 0 0 0 30px;
background-color: yellow;
}

#topnav li {
    float: right;
    padding: 0;margin:0;
    margin-left: 10px;
    padding-left: 10px;
background-color: pink;

}
</style>
</head>
<body>
<div id="topnav">
<ul>
<li><a href="#">Selection 1</a></li>
<li><a href="#">Selection 2</a></li>
</ul>
</div>
<p>This is where the page content will go.</p>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T04:16:15.013

我在这里可以看到会在 IE6 中导致布局问题的一件事是左边距并浮动在 topnav ul 上。这将使 IE6 的利润翻倍。将“display:inline”添加到 topnav ul

# 顶部导航 ul {

```
float: left;
margin: 0 0 0 30px;
display: inline; 
```

}

# sql-server - 将表值函数连接到 MSSQL 查询

> ID：699318
> 
> 赞同：27
> 
> 时间：2009-03-30T22:37:57.353
> 
> 标签：sql-server

我有一个表值函数，它接受一个人的 ID 号并返回几行和几列。在另一个查询中，我正在创建一个 SELECT 来检索有关许多人的大量信息。如何将主查询中的 id 号传递给函数以对列求和并将其加入主查询？我希望我没有表值函数，因为它很容易工作，但是，这个函数在其他地方使用，我想重用它。也许这甚至不可能使用表值函数，我需要创建一个标量函数。

我的主要查询如下所示：

```
select id_num, name, balance 
from listOfPeople 
```

表值函数如下所示：

```
calculatePersonalDiscount(id_number) 
```

我想做类似的事情：

```
select id_num, name, balance 
from listOfPeople
left join 
(
  SELECT id_num, SUM(discount)
  FROM calculatePersonalDiscount(listOfPeople.id_num)
) x ON x.id_num = listOfPeople.id_num 
```

但是您不能将 listOfPeople.id_num 传递给函数，因为它实际上不是同一个范围。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-30T22:48:34.287

在 SQL Server 2005 中，您可以使用[CROSS APPLY 语法](http://msdn.microsoft.com/en-us/library/ms175156.aspx)：

```
select id_num, name, balance, SUM(x.discount)
from listOfPeople
    cross apply dbo.calculatePersonalDiscount(listOfPeople.id_num) x 
```

同样，对于 LEFT OUTER 连接，也有一个 OUTER APPLY 语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-23T00:50:29.387

我非常需要这个，你给了我一个开始，在这里我可以加入另一个视图。（另一个表也可以工作），我在 WHERE 子句中包含了另一个函数。

```
SELECT CL_ID, CL_LastName, x.USE_Inits 
FROM [dbo].[tblClient]
JOIN dbo.vw_InsuranceAppAndProviders ON dbo.vw_InsuranceAppAndProviders.IAS_CL_ID = tblClient.CL_ID
CROSS APPLY dbo.ufx_HELPER_Client_CaseWorker(tblClient.CL_ID) x
WHERE dbo.vw_InsuranceAppAndProviders.IAS_CL_ID = tblClient.CL_ID
AND dbo.ufx_Client_IsActive_By_CLID(tblClient.CL_ID) = 1
AND  (dbo.vw_InsuranceAppAndProviders.IAS_InsuranceType = 'Medicare') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-26T11:04:17.000

我找不到任何证明，但似乎您已经可以正常加入功能，就像您使用表格或视图一样。我在 SQL Server 2017 上试过，不知道还有哪些其他版本支持：

```
CREATE FUNCTION dbo.test_join_func
(
    @param INT
)
RETURNS TABLE
AS
    RETURN (
               SELECT * FROM sys.tables);
GO

CREATE TABLE dbo.test_join_tbl
(
    a INT
);
GO

INSERT INTO dbo.test_join_tbl (a) VALUES (1);
GO

SELECT *
  FROM dbo.test_join_tbl       AS tjt
-- using any join condition just to test it is working
  JOIN dbo.test_join_func(123) AS tjf ON tjf.object_id > 0;

DROP TABLE IF EXISTS dbo.test_join_tbl;
DROP FUNCTION IF EXISTS dbo.test_join_func; 
```

# java - 在 Java 中将 char 表示为一个字节

> ID：699319
> 
> 赞同：24
> 
> 时间：2009-03-30T22:37:58.477
> 
> 标签：java, arrays, char, byte

我必须将 char 转换为字节或字节数组。在其他语言中，我知道 char 只是一个字节。但是，查看 Java Character 类，它的最小值是 \u0000，最大值是 \uFFFF。这使得 char 看起来像 2 个字节长。

我可以将其存储为一个字节还是需要将其存储为两个字节？

在有人问之前，我会说我正在尝试这样做，因为我正在一个接口下工作，该接口期望我的结果是一个字节数组。所以我必须将我的 char 转换为一个。

请让我知道并帮助我理解这一点。

谢谢，jbu

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-30T22:41:37.050

要将字符转换为字节，您需要指定[字符编码](http://en.wikipedia.org/wiki/Character_encoding)。一些字符编码每个字符使用一个字节，而另一些则使用两个或更多字节。事实上，对于许多语言来说，用一个字节编码的字符太多了。

在 Java 中，将字符转换为字节的最简单方法是使用`String`类的[`getBytes(Charset)`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#getBytes-java.nio.charset.Charset-)方法。（[`StandardCharsets`](https://docs.oracle.com/javase/8/docs/api/java/nio/charset/StandardCharsets.html)该类定义了一些常见的编码。）但是，如果字符无法在指定的编码下映射，则此方法将默默地用 � 替换字符。如果您需要更多控制，您可以配置 a[`CharsetEncoder`](https://docs.oracle.com/javase/8/docs/api/java/nio/charset/CharsetEncoder.html)以处理这种错误情况或使用不同的替换字符。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T22:50:41.770

char 在 Java 中确实是 16 位的（也是唯一的无符号类型！！）。

如果您确定字符的编码是 ASCII，那么您可以将它们丢弃在一个字节上（因为 ASCII 仅使用字符的低 7 位）。

如果您不需要修改字符或理解它们在字符串中的含义，您可以将字符存储在两个字节上，例如：

```
char[] c = ...;
byte[] b = new byte[c.length*2];
for(int i=0; i<c.length; i++) {
    b[2*i] = (byte) (c[i]&0xFF00)>>8; 
    b[2*i+1] = (byte) (c[i]&0x00FF); 
} 
```

（如果速度很重要，建议用右移替换 2*）。

但是请注意，一些实际（显示的）字符（或更准确地说，Unicode 代码点）写在两个连续的字符上。因此，在两个字符之间进行剪切并不能确保您在实际字符之间进行剪切。

如果您需要以字符串感知的方式解码/编码或以其他方式操作您的 char 数组，您应该尝试使用 java.io 工具对您的 char 数组或 String 进行解码和编码，以确保正确的字符操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T22:46:22.497

为了扩展其他人的说法，如果您有一个需要作为字节数组的字符，那么您首先创建一个包含该字符的字符串，然后从字符串中获取字节数组：

```
private byte[] charToBytes(final char x) {
  String temp = new String(new char[] {x});
  try {
    return temp.getBytes("ISO-8859-1");
  } catch (UnsupportedEncodingException e) {
    // Log a complaint
    return null;
  }
} 
```

当然，使用适当的字符集。这将是开始使用字符串而不是一次获取一个字符，转换为字符串，然后转换为字节数组，效率更高。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T22:44:36.963

java中的char是一个无符号的16位值。如果您拥有的内容适合 7 位，那么只需转换为一个字节（例如 ASCII 适合）。

您也可以签出[java.nio.charset](http://java.sun.com/javase/6/docs/api/java/nio/charset/package-summary.html) API。

# python - 在 Python 调用中抑制对可执行文件的输出

> ID：699325
> 
> 赞同：45
> 
> 时间：2009-03-30T22:39:14.513
> 
> 标签：python, redirect

我有一个名为的二进制文件`A`，在调用时会生成输出。如果我从 Bash shell 调用它，大部分输出都会被`A > /dev/null`. 所有的输出都被抑制`A &> /dev/null`

我有一个名为的 python 脚本`B`需要调用`A`. 我希望能够生成输出`B`，同时抑制所有输出`A`。

从内部`B`，我尝试过`os.system('A')`, `os.system('A > /dev/null')`, 和`os.system('A &> /dev/null')`,`os.execvp('...')`等，但没有一个会抑制 A 的所有输出。

我可以运行`B &> /dev/null`，但这也抑制了所有`B`的输出，我不希望这样。

有人有建议吗？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-03-30T22:53:27.007

```
import os
import subprocess

command = ["executable", "argument_1", "argument_2"]

with open(os.devnull, "w") as fnull:
    result = subprocess.call(command, stdout = fnull, stderr = fnull) 
```

如果命令没有任何参数，您可以将其作为简单字符串提供。

如果您的命令依赖于通配符、管道或环境变量等 shell 功能，您需要将整个命令作为字符串提供，并指定`shell = True`. 但是，应该避免这种情况，因为如果不仔细验证字符串的内容，这会带来安全隐患。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-03-30T22:49:56.687

如果你有 Python 2.4，你可以使用[subprocess 模块](http://docs.python.org/library/subprocess.html)：

```
>>> import subprocess
>>> s = subprocess.Popen(['cowsay', 'hello'], \
      stderr=subprocess.STDOUT, stdout=subprocess.PIPE).communicate()[0]
>>> print s
 _______ 
< hello >
 ------- 
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     || 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-09-29T08:37:55.863

在 Python 3.3 及更高版本中，`subprocess`支持[重定向到`/dev/null`](http://docs.python.org/3.3/library/subprocess.html#subprocess.DEVNULL). 要使用它，当调用`.Popen`和朋友时，指定`stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL,`为关键字参数。

因此，为 Python 3.3+ 重写的 DNS 的答案变为

```
import subprocess
command = ["executable", "argument_1", "argument_2"]
result = subprocess.call(command,
                         stdout=subprocess.DEVNULL,
                         stderr=subprocess.DEVNULL) 
```

从文档中：

> subprocess.DEVNULL¶
> 
> 可用作 Popen 的 stdin、stdout 或 stderr 参数的特殊值，指示将使用特殊文件 os.devnull。
> 
> 3.3 版中的新功能。

对于 Python 3.0 到 3.2，您必须使用 手动打开空设备`open(os.devnull)`，如 DNS 所写。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-04-28T09:15:37.517

如果您的搜索引擎将您引向这个老问题（像我一样），请注意使用 PIPE 可能会导致**死锁**。事实上，由于管道是缓冲的，即使没有人读取它，您也可以在管道中写入一定数量的字节。但是缓冲区的大小是有限的。因此，如果您的程序 A 的输出大于缓冲区，则 A 将在写入时被阻塞，而调用程序 B 等待 A 的终止。**但在这种特殊情况下，不是......请参阅下面的评论。**

尽管如此，我还是推荐使用 Devin Jeanpierre 和 DNS 的解决方案。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-30T22:44:20.130

正如 os.system() 文档提到的那样，使用 subprocess[模块](http://docs.python.org/library/subprocess.html)，并且，如果您愿意，可以在打开子进程时设置 stdout=open(os.devnull, 'w') （对于 stderr 可能相同）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-23T04:20:45.213

我知道游戏已经晚了，但为什么不简单地将输出从 os.system 中重定向到 /dev/null 呢？例如：

```
tgt_file = "./bogus.txt"
os.sytem("d2u '%s' &> /dev/null" % tgt_file) 
```

当您不想处理 subprocess.STDOUT 时，这似乎适用于那些场合。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-27T10:30:45.853

我用：

```
call(command, stderr=subprocess.PIPE, stdout=subprocess.PIPE) 
```

其中 command 是命令 + 参数的字符串

为此，您必须导入子流程

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-18T14:06:45.343

如果您只需要捕获 STDOUT，不将其分配给变量吗？例如：

```
megabyte=''
# Create a 1 MiB string of NULL characters.
for i in range(1048576):
    megabyte += '\0'
fh=open('zero.bin','w')
# Write an 8 GiB file.
for i in range(8192):
    print(i)
    # Suppress output of 'write()' by assigning to a variable.
    discard=fh.write(megabyte)
fh.close() 
```

我正在创建一个大型的零填充文件以使硬盘驱动器上的可用空间为零，并发现每次调用 handle.write(string) 都会吐出写入的字节数。将其分配给变量会抑制该输出。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-22T13:26:36.497

如果您不想等待命令完成，例如启动备份任务，另一种选择是通过 bash 传递它，这样做可以让重定向正常运行。

例如，使用 aplay 启动一个声音文件：

```
import os

def PlaySound(filename):
    command = 'bash -c "aplay %s &> /dev/null &"' % (filename)
    os.system(command) 
```

这样我就可以生成一个新进程，而不是等待它完成并阻止它打印到终端。唯一的问题是它会加载一个 bash 实例以及您正在运行的进程，这会产生轻微的开销。

# sql - SQL 查询问题（可能的联接/子查询？）

> ID：699329
> 
> 赞同：1
> 
> 时间：2009-03-30T22:40:28.597
> 
> 标签：sql, oracle, join, subquery, ora-00937

我有两张表（**Management**和**Employee**）。

管理表跟踪过去几年管理 X 公司的不同管理团队。每个管理团队都有一个ID（即：managementnr），每个团队都有一个CEO（即ceoname）。

员工表跟踪为 X 公司工作的员工（基本上只是他们的姓名和哪个管理团队雇用了他们）

这是SQL代码：

```
 CREATE TABLE EMPLOYEE(
    EMPLOYEENAME   VARCHAR2(15) NOT NULL,
    HIRETEAM NUMBER(2), 
    PRIMARY KEY (EMPLOYEENAME)
    );

CREATE TABLE MANAGEMENT(
    MANAGEMENTNR NUMBER(2) NOT NULL,
    CEONAME VARCHAR2(20) NOT NULL,
    PRIMARY KEY (MANAGEMENTNR,CEONAME)
    ); 
```

我正在尝试形成一个 SQL 查询来获取雇用最多员工的 managementNR。我试过使用：

```
SELECT HIRETEAM,max(count(HIRETEAM)) 
 from EMPLOYEE 
group by HIRETEAM 
```

但我不断得到：

```
 ORA-00937: not a single-group group function 
```

（我正在使用甲骨文）

经过几个小时的 Google-fu，我终于明白了这个错误的含义，但是我仍然想不出任何其他方式来形成这个查询。我试过使用子查询/连接，但仍然没有。一般来说，我对 SQL 很陌生。如果有人可以提供帮助，我将不胜感激！

感谢您的宝贵时间 =]
--Evan Lestrange

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T23:03:24.000

我想你正在寻找这个：

```
WITH counts_hireteam as (
   SELECT HIRETEAM
        , count(*) count_hireteam
     from EMPLOYEE 
   group by HIRETEAM
   order by count(*) desc
) 
select HIRETEAM  
  from counts_hireteam
 where rownum = 1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T23:04:04.733

这样做的“正确”方法实际上是这样的：

```
SELECT m.ceoname, COUNT(1), ROW_NUMBER() OVER (ORDER BY COUNT(1) DESC)
FROM management m
JOIN employee e ON m.managementnr = e.hireteam
GROUP BY m.ceoname 
```

您正在进入 Top-N 查询的模糊区域，我将引导您到[Top-N 上 Ask Tom 的这一优秀专栏](http://www.oracle.com/technology/oramag/oracle/07-jan/o17asktom.html)。其他答案在简单的情况下有效，但是当您开始想要做一些事情时，例如返回前 3 名管理团队（按人数计算）并始终如一地这样做，您就会遇到问题。

一致性是一个关键点。正如汤姆所说：

> 查询中的 GROUP BY 子句是否保证输出数据将按 GROUP BY 列排序，即使没有 ORDER BY 子句？
> 
> 除非并且直到查询中有 ORDER BY 语句，否则不能假定返回的行是按任何顺序排列的。如果没有 ORDER BY，数据可能会以数据库感觉返回的任何顺序返回。这一直是真的，而且永远都是真的。
> 
> 事实上，在 Oracle 数据库 10g 第 2 版中，您会看到 GROUP BY 以随机顺序返回数据的频率比以前要高得多：

使用此示例数据：

```
INSERT INTO employee VALUES ('Bob',1);
INSERT INTO employee VALUES ('Sue',1);
INSERT INTO employee VALUES ('John',1);
INSERT INTO employee VALUES ('James',2);
INSERT INTO employee VALUES ('Mary',2);
INSERT INTO employee VALUES ('Ron', 2);
INSERT INTO employee VALUES ('Jane',3);
INSERT INTO employee VALUES ('Luke',4);
INSERT INTO employee VALUES ('Rob',4);
INSERT INTO employee VALUES ('Tim', 5);

INSERT INTO management VALUES (1, 'Kate');
INSERT INTO management VALUES (2, 'Larry');
INSERT INTO management VALUES (3, 'Jake');
INSERT INTO management VALUES (4, 'Sarah');
INSERT INTO management VALUES (5, 'Tom'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T22:46:23.807

从此查询中获取第一行：

```
select hireteam,count(*) from EMPLOYEE group by hireteam order by count(*) desc 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T23:22:19.043

如果您想将结果限制为单个记录，即使在雇佣人数最多的情况下：

```
select * from (
    select hireteam, count(hireteam) count
    from employee
    group by hireteam
    order by count(hireteam) desc, hireteam asc )
where rownum = 1 
```

要检索所有雇佣人数最多的雇佣团队值（包括关系）：

```
select * from (
    select hireteam,
           count(hireteam) count,
           rank() over (order by count(hireteam) desc) rank
    from   employee
    group by hireteam)
where rank = 1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T22:46:31.063

这样，您就可以让所有团队拥有雇佣员工的数量。

```
select
    Management.ManagementNr,
    Management.CeoName,
    count(Employee.EmployeeName)   
from 
    Employee 
inner join 
    Management on Employee.HireTeam = Management.ManagementNr   
group by 
    Management.ManagementNr   
order by 
    count(Employee.EmployeeName) desc 
```

添加一个额外的有子句并放弃加入（因为我刚刚认识到 CEO 的名字不是必需的），你会得到你想要的结果，如下所示。

```
select Employee.HireTeam   
from Employee   
group by Employee.HireTeam   
having count(EmployeeName) = select max(GroupSize)
   from select count(EmployeeName) as GroupSize
      from Employee group by Employee.HireTeam 
```

如果多个管理层雇用了相同数量的员工，这实际上可能会返回多行。而且它很丑……但是我不知道在单个查询中做这件事的更好方法。

# visual-studio-2008 - 如何清除 Visual Studio 2008 中的“最近的项目”列表？

> ID：699333
> 
> 赞同：4
> 
> 时间：2009-03-30T22:42:32.663
> 
> 标签：visual-studio-2008

> **这个问题在这里已经有了答案：**
> [How do you clear your MRU list in Visual Studio?](https://stackoverflow.com/questions/82661/how-do-you-clear-your-mru-list-in-visual-studio) - *7 个答案*

如何从 Visual Studio 2008 的“最近项目”列表中删除所有项目？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-30T22:46:18.880

打开注册表，去掉`HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0\ProjectMRUList`你不想要的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-23T22:53:14.833

除了 Jon Skeet 的回答，我发现您还需要将这些项目重命名为 File1、File2 等。

我删除了前 3 个注册表项，直到我将 File4 重命名为 File 1、File5 重命名为 File2 等，VS2008 才显示任何最近的项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-02T14:45:27.767

比使用注册表删除单个项目更简单且更安全的解决方案是重命名 .sln 文件。在 VS 2008 中，单击项目。系统将提示您无法再找到它，是否要将其从列表中删除。

# windows - 如何摆脱环境变量中的中间空格

> ID：699334
> 
> 赞同：0
> 
> 时间：2009-03-30T22:42:37.077
> 
> 标签：windows, batch-file, cmd

如何摆脱环境变量中的中间空格？

假设我有以下`for`循环片段，可以获取某个磁盘的可用磁盘空间大小。

```
for /f "tokens=3" %%i in ('dir ^| find "Dir(s)"') do set size=%%i 
```

会产生这样的结果

```
C:\>set size=129,028,096 
```

我想摆脱分隔符如下。

```
for /f "delims=," %%i in ('echo %size%') do set size=%%i 
```

结果是这样的

```
set size=129 028 096 
```

如何使用本机工具在没有中间空格或分隔符的情况下获得它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T22:46:13.870

您可以使用

```
set size=%size: =% 
```

之后，它将用任何内容替换所有空格。

但是你也可以用逗号来做到这一点:)

但请记住，（a）分隔符发生了变化，对我来说它是一个点，而不是逗号。这可能取决于您的操作系统语言或区域设置。并且 (b) 之后您不能真正使用该值进行数学运算，因为`cmd`仅限于有符号的 32 位数学运算（使用`set /a`）。

顺便说一句，您的第二个`for`语句将无法正常工作，因为它只会设置`size`为最后一个数字组。这可以被规避，但我宁愿建议直接在逗号/点上使用替换：

```
set size=%size:,=%
set size=%size:.=% 
```

# sql - 合并 Select 语句并动态排序？

> ID：699341
> 
> 赞同：1
> 
> 时间：2009-03-30T22:44:07.620
> 
> 标签：sql, sql-server, sql-server-2005

1.  我有一个 select 语句，它将返回 5 个值，如 val1、val3、val5、val2、val4
2.  我有另一个 select 语句，它将返回一组记录，其中一个列具有上述集合中的值（val1 到 val5）

是否可以使用第一个 select 语句的结果对第二个 select 语句进行排序？

我的意思是按 val1、val3、val5、val2、val4 的顺序。

这意味着如果第一个语句颠倒顺序，我必须颠倒顺序。

请让我知道这是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T04:08:47.607

你还没有发布你的实际查询，所以我可能假设它们比它们更简单，但如果你的第一个语句是：

```
select val from valuetable order by someothercolumn 
```

那么你的第二个查询可能是

```
select table2.name, table2.phonenumber, table2.creationdate, table2.val
from table2
left join valuetable on table2.val = valuetable.val
order by valuetable.someothercolumn 
```

换句话说，您可以将第一个语句的顺序复制到第二个语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T23:01:27.080

我不确定我是否理解你的问题，但我会试一试。

*   用行号增加第一个查询（IIRC，MsSQL server 2005 有一个 ROW_NUMBER() 函数）
*   加入 val#，并按关联的行号排序
*   从结果中去除行号

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T00:36:40.003

大概，第一个语句有一些排序（如果没有，“val”的顺序将是任意的，你不会关心它们。

因此，采用第二个语句（返回数据），并在 vals 上离开第一个语句（返回有序的“val”），并按照第一个语句的 order by 进行排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T23:57:24.820

我不确定我是否完全理解这个问题，但试试这个。我假设你的桌子看起来像这样？

```
Table1:
myfield1
val1
val2
val2

Table2:
myField2  myDataField
val1      test1
val2      test2
val3      test3 
```

那么你的 sql 语句看起来像这样

```
SELECT myDataField 
FROM Table2 INNER JOIN Table1 ON Table2.myField2=Table1.myField1 
ORDER BY Table1.myField1 
```

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T21:48:02.553

```
简单的回答：是的...但是您必须使用二级排序
列和嵌套的内部选择。

表一
  值列
  +------+
  | val1 |
  +------+
  | val3 |
  +------+
  | val5 |
  +------+
  | val2 |
  +------+
  | val4 |
  +------+

选择集一
   排名 ValColumn
  +--------+----------+
  | 1 | val1 |
  +--------+----------+
  | 2 | val3 |
  +--------+----------+
  | 3 | val5 |
  +--------+----------+
  | 4 | val2 |
  +--------+----------+
  | 5 | val4 |
  +--------+----------+

表二
    ValColumn Col

  +------------+------+
  | 值 | .... |
  +------------+------+

最终选择
    rank ValColumn Col

  +--------+------------+------+
  | 1 | val1 | .... |
  +--------+------------+------+
  | 1 | .... | .... |
  +--------+------------+------+
  | 1 | val1 | .... |
  +--------+------------+------+
  | 2 | val3 | .... |
  +--------+------------+------+
  | 2 | .... | .... |
  +--------+------------+------+
  | 2 | val3 | .... |
  +--------+------------+------+
  | 3 | val5 | .... |
  +--------+------------+------+
  | 3 | .... | .... |
  +--------+------------+------+
  | 3 | val5 | .... |
  +--------+------------+------+
  | 4 | val2 | .... |
  +--------+------------+------+
  | 4 | .... | .... |
  +--------+------------+------+
  | 4 | val2 | .... |
  +--------+------------+------+
  | 5 | val4 | .... |
  +--------+------------+------+
  | 5 | .... | .... |
  +--------+------------+------+
  | 5 | val4 | .... |
  +--------+------------+------+

这是选择语句：

选择
    SelectSetOne.rank,
    TableTwo.ValColumn,
    表二。*
  从
      （选择
         排名=计数（*），
         值列
       FROM TableOne) 作为 SelectSetOne，
    内部联接
      表二
    ON SelectSetOne.ValColumn = TableTwo.ValColumn
  订购方式
    SelectSetOne.rank;

```

# emacs - 如何获得基本的 App<->Emacs 集成？

> ID：699346
> 
> 赞同：11
> 
> 时间：2009-03-30T22:45:12.970
> 
> 标签：emacs, elisp

有很多应用程序将 Emacs 与外部进程集成在一起。GDB 是我想到的。我可以从 emacs 控制 GDB，然后在屏幕上获得反馈。

我想用我的应用程序朝这个方向做点什么。

这就是我想要的：

*   在我和emacs之间建立连接。我可能会启动一个新的 emacs 进程并将其添加到我的 GUI 中
*   告诉 emacs 显示一个文件。（使用 emacsclient 很容易）
*   告诉emacs滚动到特定行号的中心并hilite或只是将光标移动到那里。
    *   可能真正的问题是如何从我的外部应用程序发送任意 elisp 代码以供 emacs 执行。
    *   我不会说 elisp，但这将是一个很好的学习借口
*   在 emacs 缓冲区中提供一些可点击区域，这些区域在触发时会向我的应用程序发送一条消息。
    *   即使没有可点击性，发送消息的键绑定也是一个开始。（但我知道可点击的东西是可能的，所以我问）

我知道这一切都是可能的（在 emacs 中什么是不可能的？），但我只是不知道从哪里开始搜索。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T00:24:19.220

您可能想看看[Distel](http://code.google.com/p/distel/)（Emacs 与 Erlang 消息系统的集成）和[SLIME](http://common-lisp.net/project/slime/)（Emacs 和 Common Lisp 之间的接口）。这是两种 Emacs 模式，它们通过与另一个系统进行异步对话来实现令人印象深刻的集成。特别是，有[一篇](http://fresh.homeunix.net/~luke/distel/distel-euc.pdf)关于 Distel 是如何实现的论文，以及关于它是如何工作的其他一些很好的[信息](http://fresh.homeunix.net/~luke/distel/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T03:14:22.963

这有点取决于你想如何设置。绝对值得一读的过程手册部分。阅读 'comint 包的代码是一个很好的起点。

您列出了一组非常有限的要公开的功能，可以通过直接连接来解决。通过查看 'net-utils (Mx find-library net-utils RET) 中提供的内容，您可以找到有用的实用功能。

如果您尝试连接的应用程序具有解释性语言，我会连接到该语言，而不是在应用程序端编写自定义解析器。

## 从应用程序启动 Emacs

由于您是从应用程序启动 Emacs（而不是其他方式（这可能使这项工作更容易）），这就是我可能会做的事情：

*   编写小的 perl 脚本来打开一个套接字并读/写它
*   在解释器中设置 '(read (eval (print))) 循环（或编写自定义循环）并将其连接到套接字/端口
*   使用指定套接字的函数调用（--eval 或--execute）启动 Emacs
*   将 perl 脚本作为子进程和端口启动（查看*lower-lisp*或*lower-tcl*是如何做到的）

那时，来自 Emacs 的任何内容都可以发送到 perl 子进程（'comint-send-string），然后传递到您的[REPL](http://en.wikipedia.org/wiki/Read-eval-print_loop)并在那里产生所需的效果。同样，您可以通过仅发送字符串将命令发送回 emacs，并让您在 'comint-output-filter-functions.

然后，您将编写两个小库，一个使用您的 APP 解释语言，一个使用 Emacs，以执行任何有意义的功能。emacs 库可能应该打包为主要（或次要）模式，具体取决于文件的样子。如果它们仅与应用程序一起使用，则为主要模式，如果它们是（例如）C++ 文件，则考虑到您可能想要利用 c++ 模式，次要模式会更好。

我会在 perl 中编写小 perl 脚本，而不是 elisp，只是 b/c 我知道如何与 'comint. 如果可以用一大块 elisp 替换小的 perl 脚本，并且仍然可以使用 comint 获得好处，那将是一个额外的好处。

我为 Tcl/Tk 设置了几乎相同的设置，只有连接内容由 Tk 的发送命令处理。它真的很好用。

## 从 Emacs 启动应用程序

现在，如果您可以从 Emacs 启动应用程序，上述仍然适用，只有您可以摆脱小 perl 脚本，只需通过 'comint 界面进行交互。不需要插座。

*   您仍然需要 'repl 循环（如果应用程序不能将标准输入/标准输出绑定到解释器
*   图书馆将保持不变

这会容易得多，但只有当用户流使您能够朝着那个方向前进时才有效。（我有一种预感，你写这篇文章不仅仅是为了你的使用。）

话虽如此，以这种方式开发/测试（从 Emacs 启动）可能更容易。您可以稍后添加套接字通信作为增强功能。哪个更励志...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-31T04:37:45.943

**可点击区域**

小部件库可以让您将缓冲区的一部分制作成按钮（还有单选框、复选框、列表），当您单击它们时将执行 elisp。例如：

```
 (require 'widget)

(defun simple-widget-example ()
   (interactive)
  (switch-to-buffer "*Simple widget example*")

  (let ((inhibit-read-only t))
    (erase-buffer))

  (let ((all (overlay-lists)))
    ;; Delete all the overlays.
    (mapcar 'delete-overlay (car all))
    (mapcar 'delete-overlay (cdr all)))

  (widget-insert "Sample button\n")
  (widget-create 'push-button
         :notify (lambda (&rest ignore) 
               (message "Poop! Ha Ha!"))
         "Press Me")

  (use-local-map widget-keymap)

  (widget-setup)) 
```

请参阅[Emacs 小部件库](http://www.dina.dk/~abraham/custom/widget.html#SEC6)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-31T00:08:13.457

您需要一个与 Emacs 对话的*异步进程*。查看 Emacs 手册中[有关进程的部分](http://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Processes)。一个好的起点可能是使用`start-process`or`start-process-shell-command`函数。

例如，您可以查看`man`随 emacs 分发的命令的源代码或`vc-do-command`. （要查看源代码，请输入 Ch f 然后输入函数名称，然后单击帮助窗口中的函数名称。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T22:55:23.520

通常，您应该在[emacs 手册](http://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Invocation.html#Emacs-Invocation)中四处查看。

对于您的第三个项目符号，请查看 emacs 的命令行选项。特别是 --eval 和 -f。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T03:59:02.183

我不确定它有多大帮助，但你可能想看看[SLIME](http://common-lisp.net/project/slime/)的实现，它虽然面向 lisp，但有一些非常好的特性。例如，您可以将其设置为轻松附加到正在运行的进程。不完全是您想要的，但它拥有所有部件并且非常光滑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T23:30:43.170

要让 emacs 执行 lisp 代码，只需创建一个交互式函数，然后您可以使用 Mx 函数名调用它。以下是重新打开文件的基本功能。

```
 (defun na-reopen-file ()
  "Reopen file in buffer."
  (interactive)
  (let ((p (point)))
    (progn
      (find-alternate-file buffer-file-name)
      (goto-char p) ) ) ) 
```

为了与您的应用程序交互，您可以运行异步进程并使用缓冲区与其通信。检查手册中的启动过程功能。

要创建可点击链接，您可以使用以下功能

```
 (make-button beg end 'action 'nmap-clear-buffer 'follow-link t)
  ;;for color
  (put-text-property beg end 'face nmap-active-button ) 
```

# javascript - 如何使用 Javascript 在鼠标指针旁边显示信息消息？

> ID：699361
> 
> 赞同：0
> 
> 时间：2009-03-30T22:48:22.757
> 
> 标签：javascript

当鼠标指针悬停在链接或按钮上时，如何使用 Javascript 在鼠标指针旁边显示信息消息？该信息将始终位于鼠标指针旁边，直到鼠标移出链接/按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T23:20:17.673

是的，这是可能的。看[`onmousemove`](https://developer.mozilla.org/en/DOM/element#Event_Handlers)事件处理函数。它被传递一个[`event`](https://developer.mozilla.org/en/DOM/event)对象，该对象包含名为`clientX`and的属性`clientY`，它们是鼠标坐标。

当然，IE 做这种事情的方式*稍有*不同，对你来说会很痛苦。Javascript 库掩盖了这些差异，并且会更容易，但在纯 JS 中做到这一点并不难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T23:15:25.673

使用 jQuery，您将使用以下方法：

*   [http://docs.jquery.com/Events/mouseenter#fn](http://docs.jquery.com/Events/mouseenter#fn)
*   [http://docs.jquery.com/Events/mouseleave#fn](http://docs.jquery.com/Events/mouseleave#fn)
*   [http://docs.jquery.com/Events/mousemove#fn](http://docs.jquery.com/Events/mousemove#fn)
*   [http://docs.jquery.com/UI/API/1.7/Dialog#option-position](http://docs.jquery.com/UI/API/1.7/Dialog#option-position)

应该比较清楚如何将它们缝合在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T23:51:59.877

Jin，[Overlib](http://www.bosrup.com/web/overlib/)正是您正在寻找的东西，如果您从另一个网站获得这个想法，很可能该网站正在使用它。将鼠标悬停在启用的元素上时，提示/信息始终存在 - 这是 overLib 的默认行为。它也很容易定制为主页上的众多示例之一：

[http://www.bosrup.com/web/overlib/](http://www.bosrup.com/web/overlib/)

# sql - 在单个 SQL 查询中查询相似但不相交的数据集

> ID：699368
> 
> 赞同：0
> 
> 时间：2009-03-30T22:50:42.067
> 
> 标签：sql, mysql, sql-server

在 SQL（特别是 MySQL，但问题足够笼统）中，当我在不相交的时间范围内有多个表时，查询时间序列数据的最有效方法是什么？例如，如果我的表如下：

```
router1_20090330( unixtime integer unsigned, 
                  iface1_in integer unsigned,
                  iface1_out integer unsigned )
router1_20090331( unixtime integer unsigned, 
                  iface1_in integer unsigned,
                  iface1_out integer unsigned ) 
```

依此类推，在 interface1 上使用（比如说）1 分钟的进出流量样本，每天提供 86400 条记录。

我希望查询代表类似

```
SELECT CAST(unixtime/3600 as unsigned) AS hour, 
       sum(iface1_in), sum(iface1_out) 
  from router1_20090330 *then* router1_20090331
  group by hour order by hour; 
```

即我希望两个表都被查询和聚合，但是一个接一个而不是被加入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T22:54:07.237

你想联合两个（或更多）表：

```
SELECT CAST(unixtime/3600 as unsigned) AS hour,
    SUM(iface1_in), SUM(iface1_out)
FROM (
    SELECT * FROM router1_20090330
    UNION ALL
    SELECT * FROM router1_20090331
) x
GROUP BY hour
ORDER BY hour 
```

请注意，UNION 之后的“ALL”告诉查询保留重复的行（如果两个表中出现相同的值 - 在您的场景中不太可能）。我通常使用 UNION ALL 因为我认为它避免了测试重复行数据的开销。

# ruby - 在 ruby 中使用正确的异常子类

> ID：699372
> 
> 赞同：5
> 
> 时间：2009-03-30T22:52:55.290
> 
> 标签：ruby, exception

我可以访问 ruby​​ 的异常层次结构（在镐和蜂鸟中都提到过），但我不确定要使用哪个异常，因为我没有找到关于每个术语含义的任何信息。

使用正确的异常类重要吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-31T14:48:41.780

创建自己的异常时很重要。一个重要的警告是，从 Exception 而不是 StandardError （常见错误）继承的异常将不会被救援（没有任何参数）捕获。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T22:56:43.613

“这取决于”。

Ruby 的主要问题之一是缺乏良好的规范。不过，以前情况更糟。

这主要是风格问题：如果您的错误可以使用内置异常类之一很好地描述，请使用它。如果您认为子类有意义，请使用它。

否则，您可以考虑遵循[C++ 编码标准中的这条线索](http://www.possibility.com/Cpp/CppCodingStandard.html#coeeal)：

> 创建非常复杂的异常层次结构是浪费时间。没有人会停止关心，所有的努力都白费了。相反，为每个库或命名空间创建一个异常，并在该异常中包含一个异常原因以指示异常的类型。
> 
> 例如，对于您的操作系统封装库，创建一个名为 OsencapException 的异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T22:56:32.067

不。

或者更确切地说，如果它对你无关紧要，通常对其他人也无关紧要。如果你正在编写一个库，你应该使用你的库的用户会理解的东西，但仅此而已。

# c# - 如何将具有相同架构的多个表映射到一个类

> ID：699376
> 
> 赞同：0
> 
> 时间：2009-03-30T22:54:32.057
> 
> 标签：c#, database, linq-to-sql, entity-framework

实体框架或 linq to sql 类中是否有一种方法可以将一个类映射到具有相同架构的许多不同表。例如，如果我有一个包含数千个不同股票表的数据库。所有表都有相同的列。有没有一种方法可以让我拥有一个可用于将数据映射到对象的基类型类。我显然不想只用表名来制作数千个不同的类。表格也发生了变化，即添加了新表格，并且某些表格的名称不时更改。所以理想情况下，我只有一个类，当我请求它时，我可以传入一个符号，它将它映射到正确的表。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T22:59:06.743

这似乎是一个愚蠢的数据库设计，它会给你带来更多的问题，而不仅仅是这个。如果所有数据都相同，那么它们应该在一个表中。是否对单个表的物理存储进行分区是一个低级别的实现问题，而不是应该出现在模式中的东西。

我什至不知道你会如何告诉 EF 你已经添加了一个新表，并且要像对待所有其他表一样对待它。它只是没有太多意义。

# security - IE8安全警告

> ID：699379
> 
> 赞同：8
> 
> 时间：2009-03-30T22:55:14.893
> 
> 标签：security, internet-explorer-8, https

在我正在处理的 https 站点上，我不断收到“您只想查看安全传送的网页内容吗？此网页包含不会使用安全 HTTPS 连接传送的内容，这可能会危及整个网页。”

我确保该站点具有相对链接。表单动作也是相对的。所有图像 src 也是相对的。

这个弹出窗口只发生在 IE8 中，IE7 不做任何事情。在 Firefox 中也可以正常工作。

任何想法可能会发生什么？如果我单击是，然后查看源代码，它与单击否时看到的完全相同。

这是一些新的 IE8 错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T22:58:28.037

尝试使用[Fiddler](http://www.fiddler2.com/fiddler2/)来查看会话中正在下载的确切内容。这将非常有用，因为它可以捕获由脚本、分析等触发的下载。

* * *

我在您的页面上使用了 fiddler，发现 WebResource.axd 没有加载 https。这可能是因为像 ASP.NET AJAX 这样的 AJAX 库。

[这个页面](http://blogs.msdn.com/praveeny/archive/2007/03/27/webresource-axd-going-over-http-when-you-are-browsing-on-https.aspx)准确地描述了你的问题，如果它没有明确地为你解决，它至少应该给你[一些方向](http://www.google.com/search?hl=en&q=WebResource.axd+https&btnG=Google+Search)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T22:58:21.487

它与常规 http 连接上的 https 站点上的内容有关。它可能是您不需要使用该页面的脚本，因此它不会干扰任何内容。

不是错误，但对于 IE7，您可能已经告诉它记住您的设置（是显示信息），因此您不再得到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-21T22:17:40.603

我遇到了同样的问题。我的罪魁祸首原来是以下行，特别是**src="javascript:void(0)"**属性。

```
document.write('<script type="text/javascript" id="contentLoadTag" defer="defer" src="javascript:void(0)"><\/script>'); 
```

此行用于 OnDocumentReady javascript 函数，如此链接： [http ://www.javascriptkit.com/dhtmltutors/domready.shtml](http://www.javascriptkit.com/dhtmltutors/domready.shtml)

希望对某人有所帮助！

# gdata-api - 没有验证码的 gdata 客户端身份验证

> ID：699384
> 
> 赞同：3
> 
> 时间：2009-03-30T22:56:40.570
> 
> 标签：gdata-api

在使用 gdata api 时，有什么方法可以避免 ClientLogin 有时需要验证码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-23T13:49:24.653

你可以试试这个。希望这是一次性的。 [http://www.gmailhelp.com/recent-articles/unlocking-googles-gmail-captcha/](http://www.gmailhelp.com/recent-articles/unlocking-googles-gmail-captcha/)

# python - 判断 Python 程序是否可以从标准输入读取任何内容的最佳方法是什么？

> ID：699390
> 
> 赞同：37
> 
> 时间：2009-03-30T22:58:26.167
> 
> 标签：python

如果像这样执行，我希望程序做一件事：

```
cat something | my_program.py 
```

如果像这样运行，做另一件事

```
my_program.py 
```

但是如果我从标准输入读取，那么它将等待用户输入，所以我想在尝试从标准输入读取之前看看是否有任何要读取的内容。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-30T23:16:13.270

如果您想检测是否有人将数据输入到您的程序中，或者以交互方式运行它，您可以使用 isatty 来查看 stdin 是否是终端：

```
$ python -c 'import sys; print sys.stdin.isatty()'
True
$ echo | python -c 'import sys; print sys.stdin.isatty()'
False 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-31T02:12:08.587

您想要选择模块（`man select`在 unix 上）它将允许您测试标准输入上是否有任何可读的内容。请注意，选择不适用于带有文件对象的 Window。但是从您的管道问题中，我假设您使用的是基于 unix 的操作系统:)

[http://docs.python.org/library/select.html](http://docs.python.org/library/select.html)

```
root::2832 jobs:0 [~] # cat stdin_test.py
#!/usr/bin/env python
import sys
import select

r, w, x = select.select([sys.stdin], [], [], 0)
if r:
    print "READABLES:", r
else:
    print "no pipe"

root::2832 jobs:0 [~] # ./stdin_test.py
no pipe

root::2832 jobs:0 [~] # echo "foo" | ./stdin_test.py
READABLES: [<open file '<stdin>', mode 'r' at 0xb7d79020>] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T23:22:20.477

坏消息。从 Unix 命令行的角度来看，这两个程序调用*是*相同的。

Unix 无法轻易区分它们。您所要求的并不是很明智，您需要考虑另一种使用程序的方式。

在它不在管道中的情况下，如果它不读取标准输入，它应该读取什么？

它应该启动一个GUI吗？如果是这样，您可能需要一个“-i”（--interactive）选项来指示您想要一个 GUI，而不是读取标准输入。

有时，您可以将管道与控制台区分开来，因为控制台设备是“/dev/tty”，但这不是可移植的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-30T23:13:45.957

我不知道我脑海中的 Python 命令，但是您应该能够使用 poll 或 select 来查找准备在标准输入上读取的数据。

这可能是 Unix OS 特定的，并且在 Windows Python 上有所不同。

# php - CodeIgniter - 你好世界

> ID：699396
> 
> 赞同：4
> 
> 时间：2009-03-30T23:01:15.833
> 
> 标签：php, codeigniter

我是 PHP 和 CodeIgniter 的新手，目前正在学习两者的教程。我正在尝试构建博客教程，但收到了一些错误。帮助将不胜感激。提前致谢！

**控制器**：

```
<?php

class Blog extends Controller{
   function index()
   {
   $data['title'] = "My Blog Title";
   $data['heading'] = "My Blog Heading";
   $data['todo'] = array('clean house','eat lunch','call mom');

   $this->load->view('blog_view');
   }
}
?> 
```

**查看**：

```
<html>
<head>
<title><?=$title?></title>
</head>
<body>
<h1><?=$heading?></h1>

<ol>

<?php foreach($todo as $item): ?>

<li><?=$item?></li>

<?php endforeach; ?>
</ol>

</body>
</html> 
```

**错误**：

```
Message: Undefined variable: heading
Filename: views/blog_view.php
Line Number: 6

Message: Undefined variable: todo
Filename: views/blog_view.php
Line Number: 10

Message: Invalid argument supplied for foreach()
Filename: views/blog_view.php
Line Number: 10 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T23:25:06.960

您需要将 $data 变量传递给视图：

$this->load->view('blog_view', $data);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-06T12:24:33.777

如果您再次收到该消息（在索引方法以外的方法中定义时发生）。最好的想法（我解决它的方式）是在视图文件中的该变量之前放置“@”。和woala...

# regex - + 和 * 在正则表达式中是什么意思？

> ID：699400
> 
> 赞同：1
> 
> 时间：2009-03-30T23:01:56.487
> 
> 标签：regex

我在这里得到了我的问题的答案：[我如何知道文件在 Perl 中是制表符还是空格？](https://stackoverflow.com/questions/699253/how-to-find-out-if-file-is-tab-or-space-delimited-in-perl/699256#699256)

但如果有人可以分解正则表达式并解释发生了什么以及为什么它不能在文件的最后一行工作，那真的会对我有所帮助。

```
~/^(\d+\s+)+?$/ 
```

我认为上面的后面有'+'所以如果我添加'*'它会起作用，因为*意味着零或更多......但这不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T23:11:48.990

```
Regex: /^(\d+\s+)+?$/
Parts:  1  2  3  456 
```

1.  从行首匹配
2.  查找一个或多个号码
3.  后跟一个或多个空格（或制表符）
4.  **查找2**和**3**中的一项或多项
***   但在那场比赛中不要贪心（即能停就停，不能再坚持）*   匹配行尾。**

 **它应该匹配一整行空格或制表符分隔数字的字符串。我不确定为什么它会在最后一行失败..也许最后没有空格字符？由于每个数字后面必须至少有一个空格，所以可能就是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T23:09:42.207

事实上，原来的正则表达式不接受空行，这可能就是为什么它不能在文件的最后一行工作的原因（示例文件的链接会很好）。它应该如下所示：

```
perl -ne 'if ($_=~/^(\d+\s+)*$/){print "yep\n";}' 
```

另一种方法可能是检查所有字符是否为空格或数字。

接受空行时：

```
perl -ne 'if ($_=~/^[\s\d]*$/){print "yep\n";}' 
```

不接受空行时：

```
perl -ne 'if ($_=~/^[\s\d]+$/){print "yep\n";}' 
```

# grep - 虽然 grep 多个文件，我如何在第一次匹配后停止？

> ID：699401
> 
> 赞同：11
> 
> 时间：2009-03-30T23:02:55.733
> 
> 标签：grep

我有一个文本文件中的模式列表，为此我使用 bzgrep 匹配多个文件：

```
for pattern in $(cat ~/patterns.txt); do echo $pattern; bzgrep -i $pattern *.bz2; done 
```

如何使 bzgrep (grep) 在当前模式的第一次匹配之后停止（我需要它完全停止，而不是在当前正在被 grep 的文件上停止）并继续下一个模式。我已经阅读了“-m 1”参数，但我认为它只在当前文件上停止。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T23:07:55.753

将 grep 的输出通过管道传输到`head -n 1`; 这将拉（并传递）第一行并忽略其余部分（即终止源管道）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T23:09:03.037

```
for pattern in $(< ~/patterns.txt); do
  echo "$pattern"
  for i in *.bz2; do
    bzgrep -i "$pattern" "$i" && break
  done
done 
```

您可能希望在 grep 中添加 -H 以显示文件名：行，而不仅仅是行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T23:08:06.750

您可能希望使用`-q`( `--quiet`aka `--silent`) 开关。然后检查命令是否成功完成。这不输出任何内容，并在找到匹配项后立即停止搜索，只返回成功或失败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T00:13:00.900

这是一个例子：

```
for i in  ~/bin/*; do grep -m 1 lua $i /dev/null && break; done 
```

同样适用于`bzgrep`; 在第一次成功匹配后，您退出循环。

`/dev/null`如果您有某种无法识别该`-H`选项的恐龙 grep，包括会为您提供文件名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T03:47:50.847

如果您在[http://betterthangrep.com/](http://betterthangrep.com/)上使用 ack，您可以出于这个原因使用 -1 标志。

# c# - 对象引用未设置为对象的实例

> ID：699409
> 
> 赞同：0
> 
> 时间：2009-03-30T23:04:29.257
> 
> 标签：c#

我的机器今天在玩我吗？

当我运行`TestConnectionString()`此对象的方法时，我在连接字符串设置中遇到错误。

```
public class CustomerDAL
{
   string connectionString = ConfigurationManager.ConnectionStrings["myConnection"].Name;

    public CustomerDAL()
    {

    }

    public string TestConnection()
    {
        System.Data.SqlClient.SqlConnection conn =  new System.Data.SqlClient.SqlConnection(connectionString);
        conn.Open();

        if (conn.State == System.Data.ConnectionState.Open)
        {
            return "Open";
        }
        else
        {
            return "Close";
        }
     }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T23:07:40.730

如果`ConnectionStrings["myConnection"]`返回 null，则在构造函数中取消引用以获取`Name`属性将失败。那绝对不是错误所在吗？

为什么不在该行放置一个断点并`ConfigurationManager.ConnectionStrings`查看它*认为*它有什么 - 并*非常*仔细地检查拼写错误。

之后，在方法的第一行下一个断点，并检查它的值`connectionString`是什么。传递`null`给`SqlConnection`构造函数实际上并不会引发异常，但是`InvalidOperationException`当您尝试打开它时会得到一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-05T21:39:53.387

我有三个建议

1.  您需要为配置管理器添加 .dll 引用
2.  重新检查您的连接字符串是否正确
3.  检查您是否有多个配置文件 ex. web.config 和 app.config；因此 ConfigurationManager 在解决方案中引用了错误的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-03T13:51:43.877

今天早上我在完美运行的代码上遇到了同样的问题。问题是数据库服务器本身，它拒绝来自我们的 IP 地址的连接（网络提供商更改了我们的 IP 地址）。

不知何故，SqlConnection 对象给出了“对象引用未设置为对象的实例”，而不是中继来自 db 服务器的原始响应。

# c# - 使 UserControl 自行删除

> ID：699410
> 
> 赞同：2
> 
> 时间：2009-03-30T23:05:10.923
> 
> 标签：c#, user-controls

有没有人看到这有什么问题：

```
this.Controls.Remove(this); 
```

`this`是一个扩展用户控制的类。当我单步执行这部分代码时，看起来一切都很好，但是表单没有任何反应。我希望控制消失。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T23:27:56.250

如前所述，您正在从自身中删除控件……这不太可能是您想要的。我假设你想从它的*父级*中删除控件- 所以你可能想要`this.Parent.Controls.Remove(this);`.

幸运的是，由于您没有提到平台，因此[WebForms](http://msdn.microsoft.com/en-us/library/system.web.ui.control.parent.aspx)或[WinForms](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.parent.aspx)的代码是相同的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T23:10:31.160

没有任何反应，因为它在“this”的控件集合中找不到“this”

如果您的范围在控件本身内，您会想要做

```
this.Container.Controls.Remove(this); 
```

但这一切都取决于什么类型的控件以及在什么类型的容器中。但以上应该在大多数情况下工作。

**编辑：**

如果您知道您的控件属于表单，您可以执行以下操作，或者将 Form 替换为已知的容器类型（即面板）

```
((Form)this.Container).Controls.Remove(this); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T23:24:08.710

其他回答指出您没有使用正确的集合是正确的。

但是，我要指出，从页面中删除自身的控件不是我认为来自任何 asp.net 控件的“预期行为”。覆盖该`Render`方法（或将`Visible`属性设置为`false`）将具有相同的结果，并且混淆将来维护该代码的人的机会要少得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T23:08:20.463

this.Controls 是用户控件中存在的控件的集合。该集合中不存在“this”，因为“this”是父集合。

我认为您想找到表单对象，然后执行 myForm.Controls.Remove(this)。

# java - 在 Java 中隐藏“本地”类型参数

> ID：699414
> 
> 赞同：9
> 
> 时间：2009-03-30T23:07:01.667
> 
> 标签：java, generics, adts

假设我正在使用带有泛型类型参数的接口

```
interface Foo<T> {
  T getOne();
  void useOne(T t);
} 
```

目的是该类型`T`是抽象的：它对 的实现实施类型约束`Foo`，但客户端代码并不关心究竟是什么`T`。

这在泛型方法的上下文中没有问题：

```
public <T> void doStuff(Foo<T> foo) {
  T t = foo.getOne();
  /* do stuff */
  foo.useOne(t);
} 
```

但是假设我想分解工作`doStuff`，在一个类中保存一些状态`Bar`。在这种情况下，我似乎需要添加 to 的类型`Foo`参数`Bar`。

```
public class Bar<T> {
  private Foo<T> foo;
  private T t;

  /* ... */

  public void startStuff() {
    t = foo.getOne();
  }

  public void finishStuff() {
    foo.useOne(t);
  }
} 
```

这有点奇怪，因为类型参数`T`没有出现在的公共接口中`Bar`（即它不包含在任何方法参数或返回类型中）。有没有办法“量化`T`”？即，我是否可以将参数`T`隐藏在 的界面中`Bar`，如下所示？

```
public class Bar {
  <T> { // foo and t have to use the same T
    private Foo<T> foo;
    private T t;
  } // T is out of scope
  ... 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T23:43:46.557

为了有用，在某些时候您将设置该`foo`字段。那时你应该知道（或能够捕捉到）`T`。我建议在构造函数中这样做，然后`Bar`有一个通用参数是有意义的。您甚至可以使用接口，这样客户端代码就不必查看类型。但是，我假设您不会接受我的建议，并且真的想要一个`setFoo`. 因此，只需为可切换实现添加一点：

```
/* pp */ class final BarImpl<T> {
    private final Foo<T> foo;
    private T t;

    BarImpl(Foo<T> foo) {
        this.foo = foo;
    }

    public void startStuff() {
        t = foo.getOne();
    }

    public void finishStuff() {
        foo.useOne(t);
    }
}

public final class Bar {
    private BarImpl<?> impl;

    /* ... */

    // Need to capture this wildcard, because constructors suck (pre-JDK7?).
    public void setFoo(Foo<?> foo) {
        setFooImpl(foo);
    }
    private <T> void setFooImpl(Foo<T> foo) {
        impl = new BarImpl<T>(foo);
    }

    public void startStuff() {
        impl.startStuff();
    }

    public void finishStuff() {
        impl.finishStuff();
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T23:19:24.993

您的问题类似于[“捕获助手”解决的问题，](http://www.ibm.com/developerworks/java/library/j-jtp04298.html#3.0)但我不确定它是否可以应用于使用两种单独方法的第二个示例。您的第一个`doStuff`方法肯定可以更好地写为，因为它与类型参数`public void doStuff(Foo<?> foo)`无关。`Foo`然后，“捕获助手”模式将很有用。

* * *

更新：经过一番修改，扩展了 Goetz 的捕获助手的想法，我想出了这个。里面，看起来有点乱；从外面看，你不会怀疑任何事情。

```
public class Bar {
  private final Helper<?> helper;
  public Bar(Foo<?> foo) {
    this.helper = Helper.create(foo);
  }
  public void startStuff() {
    helper.startStuff();
  }
  public void finishStuff() {
    helper.finishStuff();
  }
  private static class Helper<T> {
    private final Foo<T> foo;
    private T t;
    private Helper(Foo<T> foo) {
      this.foo = foo;
    }
    static <T> Helper<T> create(Foo<T> foo) {
      return new Helper<T>(foo);
    }
    void startStuff() {
      t = foo.getOne();
    }
    void finishStuff() {
      foo.useOne(t);
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T23:15:36.390

为什么不采用三层结构：

```
abstract class Foo

abstract class FooImplBase<T> extends Foo

class Bar extends FooImplBase<String> 
```

客户只知道`Foo`，它不包含任何通用方法。引入您需要的任何通用方法`FooImplBase<T>`，然后从它派生具体类。

因此，在您的示例中`startStuff()`，并且`endStuff()`将`Foo`在`FooImplBase<T>`. 这听起来像是在您的实际情况下可行吗？我同意这有点麻烦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T23:16:55.670

您正在定义 Bar 类。有两件事是真的...

1) Bar 中不涉及参数类型。也就是说， foo 和 t 成员只有一个类型，比如 U，它对于定义是固定的。如果你传递了一个你希望分配给 foo 的 Foo，它必须是一个 Foo<U>。如果这一切都是真的，那么是的，它不是公共接口的一部分 - 一切都有特定的类型。然后，我不确定您所说的“量化”是什么意思，因为没有自由类型变量。如果您的意思是普遍量化，您如何协调 Bar 没有参数类型的事实，因此必须为它的每个成员指定一个具体类型？

2) Bar 中涉及参数类型。它可能在公共接口中并不明显，但也许您传入了一个 Foo<T>，因此您希望使用多个单一类型实例化一个 Bar 类。然后，如前所述，这是在公共接口中，您需要使用泛型在 T 中使 Bar 参数化。这为您提供了某种形式的通用量化定义，“对于所有类型 T，此定义都是正确的”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T23:55:46.170

必须在某个地方决定，你想在 Bar 类中为“T”使用什么类型。因此，要么您必须在 Bar 的定义中选择它（在类定义中将 Foo 替换为 Foo），要么将其留给 Bar 类的客户端：在这种情况下， Bar 必须是通用的。

如果你想要一个不依赖于 T 的 Bar 接口*并且*能够为 T 选择不同的类型，你应该使用非泛型接口或抽象基类，如下所示：

```
interface Bar {
  void startStuff();
  // ...
}

class BarImplement<T> {
  private Foo<T> foo;
  // ...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T04:11:56.927

如果你真的想惹人生气，你可以把 Bar 类放在 Foo 接口中，然后吸那个 T。有关接口内部类的更多信息，请参阅[本文。](http://www.onjava.com/pub/a/onjava/excerpt/HardcoreJava_chap06/index2.html)也许这是有意义的一种情况？

```
interface Foo<T> {
  T getOne();
  void useOne(T t);

  public class Bar<T> {
    private Foo<T> foo;
    private T t;
    public void startStuff() {
      t = foo.getOne();
    }
    public void finishStuff() {
      foo.useOne(t);
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-30T23:18:58.193

在这种情况下，参数 T 就 Bar 而言变得无用，因为它将在编译时被擦除为 Object。因此，您也可以“省去麻烦”，并尽早进行擦除：

```
public class Bar {

    private Foo<Object> foo;
    private Object t;

  ... 
} 
```

# winapi - 使用 Shell_NotifyIcon 的气球工具提示适用于 Vista，但不适用于 XP

> ID：699416
> 
> 赞同：2
> 
> 时间：2009-03-30T23:07:20.683
> 
> 标签：winapi, windows-xp

我有一些代码会弹出一个气球提示。它适用于 Vista，但不适用于 Windows XP。这是到目前为止的代码。它适用于Vista，但不适用于XP。我不明白为什么。此版本不加载图标，因此它将显示为空白。

```
memset(&m_notifyData, 0, sizeof(NOTIFYICONDATA));
m_notifyData.cbSize = sizeof(NOTIFYICONDATA);
m_notifyData.uFlags = NIF_INFO | NIF_MESSAGE;
m_notifyData.hWnd = (HWND) m_preference_window->GetHWND();
m_notifyData.uID = 99;
m_notifyData.uTimeout = timeout;
m_notifyData.dwInfoFlags = NIIF_NOSOUND | NIIF_INFO;

wxStrncpy(m_notifyData.szInfo, message.c_str(), WXSIZEOF(m_notifyData.szInfo));
wxStrncpy(m_notifyData.szInfoTitle, title.c_str(),WXSIZEOF(m_notifyData.szInfoTitle));

Shell_NotifyIcon(NIM_ADD, &m_notifyData);

wxLogMessage("Balloon timeout is %i", timeout);
m_timer_balloon->Start(timeout, true); 
```

当时间运行时，这将被执行：

```
Shell_NotifyIcon(NIM_DELETE, &m_notifyData); 
```

任何想法为什么XP不显示该消息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T23:12:57.940

```
m_notifyData.cbSize = sizeof(NOTIFYICONDATA); 
```

应该

```
m_notifyData.cbSize = NOTIFYICONDATA_V2_SIZE 
```

Vista 在 XP 提供的基础上增加了几个成员。大小用于指示您传递的结构的版本。XP 拒绝它，因为大小无法识别。

# c# - LINQ：从 IQueryable<> 中的单个列中选择数据

> ID：699418
> 
> 赞同：1
> 
> 时间：2009-03-30T23:07:45.833
> 
> 标签：c#, linq-to-sql

我有一个需要从中提取数据的表，并希望丢弃数据来自的两列之一。在我的数据库中，我有“ObjectID (PK)”和“ObjectName”。

我希望使用这些数据来填充 ASP.NET MVC 项目中的 SelectList，因此在我的代码中有一个 IQueryable 对象，如下所示：

```
public IQueryable<objectRef> FindSomeObject()
{
    return from myObj in db.TableName
        orderby myObj.colName
        select myObj;
} 
```

如果我尝试更改最后一行以仅提取一列数据，例如：

```
select new { myObject.colName }; 
```

我收到一条警告，提示我正在尝试将匿名类型隐式转换为当前类型。

令人烦恼的是，此查询用于`ViewData[""]`设置 a `SelectList`，它可以很好地显示下拉列表，但会将 PK 值写入新表而不是文本。

我假设我对此知之甚少，以至于我什至无法向 Google 提出正确的问题，因为数小时的 RTFM 没有发现任何有用的信息。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T23:12:04.073

您需要更改方法的返回类型 - 如果您只想选择一列，只需声明您将返回该列的某些内容。例如：

```
public IQueryable<string> FindSomeObject()
{
    return from myObj in db.TableName
        orderby myObj.colName
        select myObj.colName;
} 
```

这基本上说它是一个返回字符串序列的查询 - 我假设这就是你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T23:12:30.640

使用 colName 的类型，例如：

```
public IQueryable<string> FindSomeObject()
{
    return from myObj in db.TableName
        orderby myObj.colName
        select myObj.colName;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T23:13:02.653

你试过了吗：

```
public IQueryable<objectRef> FindSomeObject()  
{
    return from myObj in db.TableName
        orderby myObj.colName
        select myObj.colName;
} 
```

顺便说一句，你有一个名为 objectRef 的类，以小写字母开头吗？开头应该有一个大写字母（并且必须是任何类型`colName`）。

# lucene - Lucene 分析器和点

> ID：699430
> 
> 赞同：0
> 
> 时间：2009-03-30T23:11:04.747
> 
> 标签：lucene, lucene.net

我是 Lucene 的新手。

有什么办法可以让 Lucene 分析器不忽略字符串中的点？例如，如果我的搜索条件是：“ABCD”，Lucene 应该只给我搜索结果中包含“ABCD”而不是“ABCD”的那些文档......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T06:38:37.760

这完全取决于您使用的分析仪。他们用点名[`StandardAnalyzer`](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_2/api/core/org/apache/lucene/analysis/standard/StandardAnalyzer.html)做[了一些复杂的事情](https://stackoverflow.com/questions/660298/multifieldqueryparser-is-removing-dots-from-the-acronym/661316#661316)，试图“做你的意思”。也许这[`WhitespaceAnalyzer`](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_2/api/all/org/apache/lucene/analysis/WhitespaceAnalyzer.html)将更符合您的需求。

```
public static void main(String[] args) throws Exception {
    RAMDirectory dir = new RAMDirectory();
    IndexWriter iw = new IndexWriter(dir, new WhitespaceAnalyzer(), IndexWriter.MaxFieldLength.LIMITED);
    Document doc = new Document();
    doc.add(new Field("text", "A.B.C.D DEF", Field.Store.YES, Field.Index.ANALYZED));
    iw.addDocument(doc);
    iw.close();

    IndexSearcher searcher = new IndexSearcher(dir);
    QueryParser queryParser = new QueryParser("text", new WhitespaceAnalyzer());

    // prints 0 
    System.out.println(searcher.search(queryParser.parse("ABCD"), 1).totalHits);

    // prints 1
    System.out.println(searcher.search(queryParser.parse("A.B.C.D"), 1).totalHits);
} 
```

# tfs - 工作项是否可以（或需要）在 TFS 中对构建进行排队？

> ID：699434
> 
> 赞同：3
> 
> 时间：2009-03-30T23:12:08.677
> 
> 标签：tfs, automation, build-process, tfs-workitem

在我们公司，有很多团队不断通过 TFS 向我们提交构建请求工作项。我知道可以通过签入或按计划触发构建，但这不是我们需要的。我们希望团队经理能够在 TFS 中创建一个构建请求工作项，当保存该工作项时，它将对某个构建定义进行排队。这可能吗？

我还想知道以这种方式解决问题是否可取。我是构建团队的新手，我们正在考虑自动化构建的方法。这是个好主意吗？如果不是，为什么？您可以在多大程度上实现构建过程的自动化？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T23:47:19.963

第一个问题的答案是否定的，不是开箱即用的。我认为基于构建工作项类型触发构建不是一个好主意。工作项不能按类型锁定，因此您不能将这些工作项的创建只隔离给团队经理。

您可以将开始构建权限分配给个人/组，这是向团队经理授予构建权限的推荐方式。

对于第二个问题，您可以根据需要使用团队构建 API 进行自动化。MS 使 TFS 和 Team Build 变得非常可扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T23:34:04.443

通常的做法是在开发人员提交代码时执行“快速”构建，并且每天至少执行一次“完整”构建（通常在工作时间之外）。

TFS 还具有随时手动启动构建的能力（具有必要的权限）。如果您正在执行完整的“发布”构建，您通常必须检查构建队列并偶尔删除任何排队的开发人员签入构建。

这些网站可能很有趣：

[TFS 2008：Team Build 2008 的基本指南](http://blogs.msdn.com/buckh/archive/2007/08/14/tfs-2008-a-basic-guide-to-team-build-2008.aspx)

[Team Foundation 构建食谱](http://www.tfsbuild.com/default.aspx?AspxAutoDetectCookieSupport=1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T23:40:57.577

如果您已授予他们添加工作项的权限，为什么不授予他们将构建排队的权限呢？

# ruby - （Ruby）如何检查一个范围是否包含另一个范围的子集？

> ID：699448
> 
> 赞同：16
> 
> 时间：2009-03-30T23:18:20.033
> 
> 标签：ruby, range

如果我有两个重叠的范围：

```
x = 1..10
y = 5..15 
```

当我说：

```
puts x.include? y 
```

输出是：

```
false 
```

因为这两个范围只是部分重叠。

但是，如果我希望在两个范围之间存在部分重叠时它是“真实的”，我该怎么写呢？换句话说，我需要一种方法来知道一个范围何时包含另一个范围的子集。我认为有一种用 Ruby 编写的优雅方法，但我能想到的唯一解决方案是冗长的。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-03-30T23:30:41.970

有效的方法是比较限制

```
(x.first <= y.last) and (y.first <= x.last) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-11-12T02:17:03.877

在大范围内使用它时要小心，但这是一种优雅的方法：

```
(x.to_a & y.to_a).empty? 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-05-24T11:43:32.953

如果您使用的是 Ruby 2.6，则可以使用[`Range#cover?`](https://ruby-doc.org/core-2.6.0.preview2/Range.html#method-i-cover-3F)另一个`Range`.

```
(1..5).cover?(2..3)     #=> true
(1..5).cover?(0..6)     #=> false
(1..5).cover?(1...6)    #=> true 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-29T17:15:48.587

您也可以将范围转换为[sets](http://www.ruby-doc.org/stdlib/libdoc/set/rdoc/index.html)，因为您基本上是在这里进行 set 交集。如果您要处理两个以上的范围，可能会更容易。

```
x = (1..10).to_set
y = (5..15).to_set
!(x & y).empty? #returns true (true == overlap, false == no overlap) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-21T11:55:49.900

此方法可用于以有效的方式测试多个范围之间的重叠：

```
def range_overlap?(ranges)
  sorted_ranges = ranges.sort
  sorted_ranges.each_cons(2).each do |r1, r2|
    return true if r2.first <= r1.last
  end
  return false
end

def test(r)
  puts r.inspect, range_overlap?(r)
  puts '================'
  r = r.reverse
  puts r.inspect, range_overlap?(r)
  puts '================'
end

test [[1,9], [10, 33]]
test [[1,10], [5, 8]]
test [[1,10], [10, 33]] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T01:07:28.617

如果一个范围包括第二个范围的开头或结尾，则它们重叠。

```
(x === y.first) or (x === y.last) 
```

与此相同：

```
x.include?(y.first) or x.include?(y.last) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T16:07:37.330

> 但是，如果我希望在两个范围之间存在部分重叠时它是“真实的”，我该怎么写呢？

您可以将范围转换为数组，并使用`&`运算符（*连词）*。这将返回一个新数组，其中包含两个数组中出现的所有元素。如果结果数组不为空，则意味着存在一些重叠元素：

```
def overlap?(range_1, range_2)
  !(range_1.to_a & range_2.to_a).empty?
end 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-26T20:44:52.883

如果您正在检查重叠，那么我会做

```
(x.include? y.first) or (x.include? y.last) 
```

因为一个范围必须至少包括另一个范围的一端。这对我来说比公认的结合答案更直观，尽管不如 MarkusQ 的极限比较有效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-25T21:14:04.777

Rails 有[Range#overlaps？](http://apidock.com/rails/Range/overlaps%3F)

```
def overlaps?(other)
  cover?(other.first) || other.cover?(first)
end 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-01-30T04:37:00.597

一些有用的可枚举方法：

```
# x is a 'subset' of y
x.all?{|n| y.include? n}
# x and y overlap
x.any?{|n| y.include? n}
# x and y do not overlap
x.none?{|n| y.include? n}
# x and y overlap one time
x.one?{|n| y.include? n} 
```

# python - Python/Django：从 values_list() 创建一个更简单的列表

> ID：699462
> 
> 赞同：35
> 
> 时间：2009-03-30T23:24:00.927
> 
> 标签：python, django

考虑：

```
>>>jr.operators.values_list('id')
[(1,), (2,), (3,)] 
```

如何进一步简化为：

```
['1', '2', '3'] 
```

目的：

```
class ActivityForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(ActivityForm, self).__init__(*args, **kwargs)
        if self.initial['job_record']:
            jr = JobRecord.objects.get(pk=self.initial['job_record'])

            # Operators
            self.fields['operators'].queryset = jr.operators

            # select all operators by default
            self.initial['operators'] = jr.operators.values_list('id') # refined as above. 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-03-30T23:27:40.527

使用`flat=True`django 查询集的构造：[https ://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.values_list](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.values_list)

从文档中的示例：

```
>>> Entry.objects.values_list('id', flat=True).order_by('id')
[1, 2, 3, ...] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-01T09:11:52.423

你需要做..来得到这个输出 ['1', '2', '3']

`map(str, Entry.objects.values_list('id', flat=True).order_by('id'))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T23:26:22.683

您可以使用列表推导：

```
    >>> mylist = [(1,), (2,), (3,)]
    >>> [str(x[0]) for x in mylist]
    ['1', '2', '3']

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T23:27:07.830

像这样的东西？

```
x = [(1,), (2,), (3,)]
y = [str(i[0]) for i in x]
['1', '2', '3'] 
```

# python - 从 Python 字符串中删除不在允许列表中的 HTML 标记

> ID：699468
> 
> 赞同：76
> 
> 时间：2009-03-30T23:25:29.423
> 
> 标签：python, html

我有一个包含文本和 HTML 的字符串。我想删除或禁用某些 HTML 标记，例如`<script>`，同时允许其他标记，以便我可以安全地将其呈现在网页上。我有一个允许的标签列表，如何处理字符串以删除任何其他标签？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2010-04-23T23:43:24.330

使用[`lxml.html.clean`](http://lxml.de/lxmlhtml.html#cleaning-up-html)！这很容易！

```
from lxml.html.clean import clean_html
print clean_html(html) 
```

假设以下html：

```
html = '''\
<html>
 <head>
   <script type="text/javascript" src="evil-site"></script>
   <link rel="alternate" type="text/rss" src="evil-rss">
   <style>
     body {background-image: url(javascript:do_evil)};
     div {color: expression(evil)};
   </style>
 </head>
 <body onload="evil_function()">
    <!-- I am interpreted for EVIL! -->
   <a href="javascript:evil_function()">a link</a>
   <a href="#" onclick="evil_function()">another link</a>
   <p onclick="evil_function()">a paragraph</p>
   <div style="display: none">secret EVIL!</div>
   <object> of EVIL! </object>
   <iframe src="evil-site"></iframe>
   <form action="evil-site">
     Password: <input type="password" name="password">
   </form>
   <blink>annoying EVIL!</blink>
   <a href="evil-site">spam spam SPAM!</a>
   <image src="evil!">
 </body>
</html>''' 
```

结果...

```
<html>
  <body>
    <div>
      <style>/* deleted */</style>
      <a href="">a link</a>
      <a href="#">another link</a>
      <p>a paragraph</p>
      <div>secret EVIL!</div>
      of EVIL!
      Password:
      annoying EVIL!
      <a href="evil-site">spam spam SPAM!</a>
      <img src="evil!">
    </div>
  </body>
</html> 
```

您可以自定义要清理的元素等等。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-30T23:35:40.740

[这是一个使用BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)的简单解决方案：

```
from bs4 import BeautifulSoup

VALID_TAGS = ['strong', 'em', 'p', 'ul', 'li', 'br']

def sanitize_html(value):

    soup = BeautifulSoup(value)

    for tag in soup.findAll(True):
        if tag.name not in VALID_TAGS:
            tag.hidden = True

    return soup.renderContents() 
```

如果您还想删除无效标签的内容，请替换`tag.extract()`为`tag.hidden`.

您也可以考虑使用[lxml](http://codespeak.net/lxml/)和[Tidy](http://utidylib.berlios.de/)。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-05-01T19:05:45.130

上述通过 Beautiful Soup 的解决方案将不起作用。你也许可以用 Beautiful Soup 破解一些东西，因为 Beautiful Soup 提供了对解析树的访问。过一段时间，我想我会尝试妥善解决问题，但这是一个为期一周左右的项目，而且我很快就没有一周的空闲时间。

具体来说，Beautiful Soup 不仅会为上面代码没有捕获的一些解析错误抛出异常；而且，还有很多非常真实的 XSS 漏洞没有被捕获，例如：

```
<<script>script> alert("Haha, I hacked your page."); </</script>script> 
```

您可以做的最好的事情可能是将`<`元素剥离为`&lt;`，以禁止*所有*HTML，然后使用像 Markdown 这样的受限子集来正确呈现格式。特别是，您还可以返回并使用正则表达式重新引入 HTML 的常见位。大致流程如下：

```
_lt_     = re.compile('<')
_tc_ = '~(lt)~'   # or whatever, so long as markdown doesn't mangle it.     
_ok_ = re.compile(_tc_ + '(/?(?:u|b|i|em|strong|sup|sub|p|br|q|blockquote|code))>', re.I)
_sqrt_ = re.compile(_tc_ + 'sqrt>', re.I)     #just to give an example of extending
_endsqrt_ = re.compile(_tc_ + '/sqrt>', re.I) #html syntax with your own elements.
_tcre_ = re.compile(_tc_)

def sanitize(text):
    text = _lt_.sub(_tc_, text)
    text = markdown(text)
    text = _ok_.sub(r'<\1>', text)
    text = _sqrt_.sub(r'&radic;<span style="text-decoration:overline;">', text)
    text = _endsqrt_.sub(r'</span>', text)
    return _tcre_.sub('&lt;', text) 
```

我还没有测试过那个代码，所以可能有错误。但是你看到了一般的想法：在你把好的东西列入白名单之前，你必须把所有的 HTML 列入黑名单。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-05-01T19:26:54.253

这是我在自己的项目中使用的。可接受的元素/属性来自[feedparser](http://pythonhosted.org/feedparser/html-sanitization.html)，BeautifulSoup 完成了这项工作。

```
from BeautifulSoup import BeautifulSoup

acceptable_elements = ['a', 'abbr', 'acronym', 'address', 'area', 'b', 'big',
      'blockquote', 'br', 'button', 'caption', 'center', 'cite', 'code', 'col',
      'colgroup', 'dd', 'del', 'dfn', 'dir', 'div', 'dl', 'dt', 'em',
      'font', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 
      'ins', 'kbd', 'label', 'legend', 'li', 'map', 'menu', 'ol', 
      'p', 'pre', 'q', 's', 'samp', 'small', 'span', 'strike',
      'strong', 'sub', 'sup', 'table', 'tbody', 'td', 'tfoot', 'th',
      'thead', 'tr', 'tt', 'u', 'ul', 'var']

acceptable_attributes = ['abbr', 'accept', 'accept-charset', 'accesskey',
  'action', 'align', 'alt', 'axis', 'border', 'cellpadding', 'cellspacing',
  'char', 'charoff', 'charset', 'checked', 'cite', 'clear', 'cols',
  'colspan', 'color', 'compact', 'coords', 'datetime', 'dir', 
  'enctype', 'for', 'headers', 'height', 'href', 'hreflang', 'hspace',
  'id', 'ismap', 'label', 'lang', 'longdesc', 'maxlength', 'method',
  'multiple', 'name', 'nohref', 'noshade', 'nowrap', 'prompt', 
  'rel', 'rev', 'rows', 'rowspan', 'rules', 'scope', 'shape', 'size',
  'span', 'src', 'start', 'summary', 'tabindex', 'target', 'title', 'type',
  'usemap', 'valign', 'value', 'vspace', 'width']

def clean_html( fragment ):
    while True:
        soup = BeautifulSoup( fragment )
        removed = False        
        for tag in soup.findAll(True): # find all tags
            if tag.name not in acceptable_elements:
                tag.extract() # remove the bad ones
                removed = True
            else: # it might have bad attributes
                # a better way to get all attributes?
                for attr in tag._getAttrMap().keys():
                    if attr not in acceptable_attributes:
                        del tag[attr]

        # turn it back to html
        fragment = unicode(soup)

        if removed:
            # we removed tags and tricky can could exploit that!
            # we need to reparse the html until it stops changing
            continue # next round

        return fragment 
```

一些小测试以确保其行为正确：

```
tests = [   #text should work
            ('<p>this is text</p>but this too', '<p>this is text</p>but this too'),
            # make sure we cant exploit removal of tags
            ('<<script></script>script> alert("Haha, I hacked your page."); <<script></script>/script>', ''),
            # try the same trick with attributes, gives an Exception
            ('<div on<script></script>load="alert("Haha, I hacked your page.");">1</div>',  Exception),
             # no tags should be skipped
            ('<script>bad</script><script>bad</script><script>bad</script>', ''),
            # leave valid tags but remove bad attributes
            ('<a href="good" onload="bad" onclick="bad" alt="good">1</div>', '<a href="good" alt="good">1</a>'),
]

for text, out in tests:
    try:
        res = clean_html(text)
        assert res == out, "%s => %s != %s" % (text, res, out)
    except out, e:
        assert isinstance(e, out), "Wrong exception %r" % e 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2013-10-26T09:41:36.760

[使用更多有用的选项时，漂白剂](https://github.com/jsocol/bleach)会做得更好。它建立在 html5lib 之上，可用于生产。检查该[`bleach.clean`](http://bleach.readthedocs.org/en/latest/clean.html)函数的文档。它的默认配置会转义不安全的标签，如`<script>`同时允许有用的标签，如`<a>`.

```
import bleach
bleach.clean("<script>evil</script> <a href='http://example.com'>example</a>")
# '&lt;script&gt;evil&lt;/script&gt; <a href="http://example.com">example</a>' 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-03-09T12:56:43.053

[我用 BeautifulSoup](https://stackoverflow.com/questions/699468/python-html-sanitizer-scrubber-filter/699483#699483)修改了[Bryan](https://stackoverflow.com/users/73049/bryan)的解决方案，以解决[Chris Drost 提出的问题](https://stackoverflow.com/questions/699468/python-html-sanitizer-scrubber-filter/812785#812785)。有点粗糙，但可以完成工作：

```
from BeautifulSoup import BeautifulSoup, Comment

VALID_TAGS = {'strong': [],
              'em': [],
              'p': [],
              'ol': [],
              'ul': [],
              'li': [],
              'br': [],
              'a': ['href', 'title']
              }

def sanitize_html(value, valid_tags=VALID_TAGS):
    soup = BeautifulSoup(value)
    comments = soup.findAll(text=lambda text:isinstance(text, Comment))
    [comment.extract() for comment in comments]
    # Some markup can be crafted to slip through BeautifulSoup's parser, so
    # we run this repeatedly until it generates the same output twice.
    newoutput = soup.renderContents()
    while 1:
        oldoutput = newoutput
        soup = BeautifulSoup(newoutput)
        for tag in soup.findAll(True):
            if tag.name not in valid_tags:
                tag.hidden = True
            else:
                tag.attrs = [(attr, value) for attr, value in tag.attrs if attr in valid_tags[tag.name]]
        newoutput = soup.renderContents()
        if oldoutput == newoutput:
            break
    return newoutput 
```

**编辑：**更新以支持有效属性。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-02-18T00:37:24.297

我使用[FilterHTML](https://github.com/dcollien/FilterHTML)。它很简单，可以让您定义一个控制良好的白名单，清理 URL，甚至将属性值与正则表达式匹配，或者为每个属性提供自定义过滤功能。如果小心使用，它可能是一个安全的解决方案。这是自述文件中的一个简化示例：

> ```
> import FilterHTML
> 
> # only allow:
> #   <a> tags with valid href URLs
> #   <img> tags with valid src URLs and measurements
> whitelist = {
>   'a': {
>     'href': 'url',
>     'target': [
>       '_blank',
>       '_self'
>     ],
>     'class': [
>       'button'
>     ]
>   },
>   'img': {
>     'src': 'url',
>     'width': 'measurement',
>     'height': 'measurement'
>   },
> }
> 
> filtered_html = FilterHTML.filter_html(unfiltered_html, whitelist) 
> ```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-03-20T23:21:02.423

您可以使用[html5lib](http://code.google.com/p/html5lib/)，它使用白名单进行清理。

一个例子：

```
import html5lib
from html5lib import sanitizer, treebuilders, treewalkers, serializer

def clean_html(buf):
    """Cleans HTML of dangerous tags and content."""
    buf = buf.strip()
    if not buf:
        return buf

    p = html5lib.HTMLParser(tree=treebuilders.getTreeBuilder("dom"),
            tokenizer=sanitizer.HTMLSanitizer)
    dom_tree = p.parseFragment(buf)

    walker = treewalkers.getTreeWalker("dom")
    stream = walker(dom_tree)

    s = serializer.htmlserializer.HTMLSerializer(
            omit_optional_tags=False,
            quote_attr_values=True)
    return s.render(stream) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-08T12:38:25.503

我更喜欢这个`lxml.html.clean`解决方案，就像[nosklo](https://stackoverflow.com/users/17160/nosklo) [指出的那样](https://stackoverflow.com/questions/699468/python-html-sanitizer-scrubber-filter/2702587#2702587)。这里还要删除一些空标签：

```
from lxml import etree
from lxml.html import clean, fromstring, tostring

remove_attrs = ['class']
remove_tags = ['table', 'tr', 'td']
nonempty_tags = ['a', 'p', 'span', 'div']

cleaner = clean.Cleaner(remove_tags=remove_tags)

def squeaky_clean(html):
    clean_html = cleaner.clean_html(html)
    # now remove the useless empty tags
    root = fromstring(clean_html)
    context = etree.iterwalk(root) # just the end tag event
    for action, elem in context:
        clean_text = elem.text and elem.text.strip(' \t\r\n')
        if elem.tag in nonempty_tags and \
        not (len(elem) or clean_text): # no children nor text
            elem.getparent().remove(elem)
            continue
        elem.text = clean_text # if you want
        # and if you also wanna remove some attrs:
        for badattr in remove_attrs:
            if elem.attrib.has_key(badattr):
                del elem.attrib[badattr]
    return tostring(root) 
```

# apache - 在此服务器上未找到请求的 URL /

> ID：699473
> 
> 赞同：1
> 
> 时间：2009-03-30T23:27:50.247
> 
> 标签：apache, apache2, webserver

我在同一台服务器上有 2 个 Apache 实例，一个在端口 80 上，一个在另一个端口上。第一个工作正常。当我转到 mydomain.com:otherport 时，我收到标题中命名的错误消息。该目录确实存在，并且与运行 Web 服务器的用户和组相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T22:29:03.700

终于想通了。当我添加 DirectoryIndex 指令时，我将它添加到我刚刚创建的主 httpd.conf 虚拟主机中，而第二个服务器仍在第二个实例上运行。现在觉得自己很傻！

对于其他正在阅读的人，如果您收到此错误并且无法弄清楚原因，则需要添加 DirectoryIndex 指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T23:44:47.677

您可能需要为第二个实例设置 http.conf。您为什么首先将其作为两个实例进行？

两个想法：

*   逐渐更改非工作配置，直到它与工作配置匹配（当然首先进行备份），然后查看修复它的更改
*   查看error_log；如有必要，请提高日志记录级别，直到您看到有用的信息。

# .net - Mono 2.4、AutoHosting 和 MVC

> ID：699487
> 
> 赞同：3
> 
> 时间：2009-03-30T23:40:12.477
> 
> 标签：.net, asp.net, apache, mono, mod-mono

可以修改 mod_mono 的 AutoHosting 以支持 ASP.NET 吗？ATM 它实际上不起作用：[Link](http://www.vector6.com.mx/)。/ 有效，但运行时完全忽略 Global.asax 并且不遵循路由约定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T21:43:59.550

Mono 中 AutoHosting 的目的是通过减少配置服务器所需的工作量，使某人尽可能容易地快速获取托管在 Mono 上的 ASP.NET 站点；但是，它通过托管已配置为 ASP.NET 文件类型的文件类型来实现。您可以在 mod_mono.conf 文件中找到它配置为托管的文件扩展名。

由于 MVC 路由避免使用文件扩展名，因此它可能不是 MVC 托管的好解决方案。也就是说，如果您绝对必须使用 AutoHosting，您可以将以下内容添加到您的 mod_mono.conf 文件中，以将服务器的所有内容设置为 x-asp-net 内容：ForceType application/x-asp-net

这样做有更广泛的影响，所以我不能说我会推荐它。

如果您有能力更改 Apache 服务器的配置，您可能会通过为您的应用程序配置 mod_mono 获得更好的结果。

# asp.net - 超过 4GB 的文件上传

> ID：699488
> 
> 赞同：9
> 
> 时间：2009-03-30T23:40:54.987
> 
> 标签：asp.net, web-applications, file-upload

我希望创建一个允许上传最大 4GB 文件的 ASP.NET Web 应用程序。我怎样才能做到这一点？我更喜欢“下载”管理器之类的东西，我可以在其中恢复、暂停等...

那可能吗？如果是这样，我应该从哪里开始？我认为 asp.net 的上传限制为 4mb 之类的？我不太确定..

请指教。

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T23:53:37.390

您可能需要使用第三方组件来执行此操作。

您是正确的，默认情况下，标准文件上传控件不允许超过 4MB 的内容。您可以使用配置部分的`maxRequestLength`属性更改该值。您还需要更改属性。请参阅[此处](http://msdn.microsoft.com/en-us/library/e1f13641(VS.80).aspx)了解更多信息。`httpRuntime``web.config``executionTimeout`

但高达4GB？我怀疑你会在标准文件上传控制方面取得很大成功。如果连接断开，则一切都结束了，他们将不得不重新开始。您可能想要一些可以维持连接并提供进度条等的东西。

查看[FileUp](http://support.softartisans.com/docs/fileupeev4/doc/dotnet/aspdotnet_largeuploads.asp)或[EasyAlgo](http://www.easyalgo.com/eaupload.aspx)等产品。谷歌搜索应该找到你很多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T23:47:31.447

您始终可以自己实现文件上传，如果 .NET 实用程序在其中编码了一些限制（尽管它确实不应该），那真的不是那么困难。

至于您可以恢复的某种“上传”管理器等，这根本不可能，因为它需要与客户端合作，而现代浏览器的上传功能根本不是那么“智能”。

您可能能够创建一个小型 Java Applet，您可以将其嵌入到您的页面中以处理对话的客户端，但您需要对 Applet 进行签名，并且您还需要自定义服务器逻辑来处理后端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T23:50:05.043

除了服务器的限制之外，浏览器还限制可以在 POST 中发送的文件的大小（稍微过时：[http](http://www.motobit.com/help/scptutl/pa98.htm) ://www.motobit.com/help/scptutl/pa98.htm ）。这就是为什么许多实施基于 Flash 或 Java 的解决方案，可以使用直接管道执行“带外”上传到服务器，可以这么说。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T00:11:13.870

.NET 2.0 中的限制为 2 GB。

如果是 3.5，那么在你的 web.config 中考虑这个，如果你有的话。它设置最大文件大小和超时：

```
<httpRuntime maxRequestLength="4194304" executionTimeout="2400"/> 
```

当然，如果您不刻薄，将文件上传到网站可能会很危险，因此像其他海报一样，考虑使用现有的经过测试的，至少要了解所有注意事项。祝你好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T21:31:32.530

您可以使用覆盖内置请求检查的第三方解决方案使用 ASP.NET 处理高达 4GB 的文件。这将适用于所有版本的 IIS，但 IIS 7 集成模式除外，后者有 2GB 的硬限制。

大多数上传者没有暂停/恢复的能力，所以你可能不走运。谷歌看看你能找到什么。您可能必须使用 Java 或 ActiveX 才能获得此功能。

*开始插头*

我是[SlickUpload](http://krystalware.com/Products/SlickUpload/)的作者，它是最早的 ASP.NET 上传者之一——它支持最多 4 GB 的上传。我们不支持 Flash、Silverlight 或 Java，但目前确实拥有最好的仅 AJAX 体验，并且丰富的小程序接口将在未来版本中出现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T23:46:22.137

文件上传限制通常由服务器配置文件控制。对不起，我是一个 PHP 人，所以我不确定在 asp.net 中，但对于我们的服务器，我们有一个 php.ini 文件，其中包含设置允许的总大小的 upload_max_filesize。

对于上传管理器，您可能需要使用 java net beans 构建的东西，一个可以购买的基于 java 的插件或[swfuploader](http://swfupload.org/)。

我们已经在许多网站上成功使用了[swfuploader 。](http://swfupload.org/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T23:56:52.983

在 filemail.com，尽管该站点基于 asp.net，但他们使用了 Flex 客户端。所以总的来说，我认为“每个人”都使用 active-x 类型的客户端来完成这项任务。

# ruby-on-rails - 在 Rails 中使用 Google Gears

> ID：699492
> 
> 赞同：1
> 
> 时间：2009-03-30T23:44:50.783
> 
> 标签：ruby-on-rails, integration, google-gears

我的任务是探索离线访问我的 web 应用程序的可能性。人们使用带有导轨的谷歌齿轮的经验是什么？我知道[gearsonrails](http://gearsonrails.googlecode.com)项目，但它有一些非常奇怪的构造，并且似乎没有处于重要的积极开发中。

还有其他选择吗？有没有人成功地将齿轮添加到他们现有的 rails 应用程序中？这是不是超级痛？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-02T21:36:44.413

Google Gears[已死](http://www.pcpro.co.uk/news/353821/google-gears-grinds-to-a-halt)，开发已停止。您最好尝试使用 HTML5 解决您的问题，它实现了使离线访问成为可能的 API（可以使用类似 SQL 的语言和键值存储进行查询的客户端数据库。）在这一点上，没有主要浏览器完全实现（开发）标准。因此，您必须在针对事实上已过时的插件进行开发或针对新兴标准之间做出决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-31T02:23:55.797

我自己正在研究这个 - 通常的想法是，根据您想要离线使用的内容，您需要在客户端进行设置（注意，这是未经测试的，因此未经验证 - 我只是从我的理解出发我已阅读 - 尽管我计划在接下来的几周内进行一些实验......）

在大多数情况下，我建议使用 Rails 设置标准的 restful 资源，然后在您的客户端库中执行以下操作：

1.  加载页面后，确定 Gears 是否已加载，以及您的数据库在客户端上是否可用。
2.  如有必要，创建数据库。
3.  使用工作进程，初始化对 RESTful 控制器的调用以获取您需要的数据 - 并在数据返回时将其写入本地数据库（使用工作进程将允许“多线程”体验并确保您不要锁定客户端。
4.  定期轮询远程服务器检查数据的变化——如果需要，拉下一个新的集合并重新加载本地数据缓存。
5.  当客户端离线时切换到使用本地客户端数据库。

显然，这是一个只读示例，并且依赖于使用 AJAX 客户端调用在页面等中填充数据的现有架构。

*你的方法可能会有所不同，但我建议只是玩一下 - 记住你*不必使用 Rails 插件等来做到这一点 - 你可以自己滚动客户端脚本 - 你永远不知道，一旦你完成了你可能能够将您的工作重构为一个很棒的小宝石或类似的东西......

# c# - 在 .NET 中检查回发

> ID：699496
> 
> 赞同：0
> 
> 时间：2009-03-30T23:47:25.270
> 
> 标签：c#, asp.net, ado.net

这次我带着一个与 .NET 相关的问题来找你。我面临的挑战是找出回发所涉及的四个步骤。

确切的挑战是：

“每次回发时都会执行四种方法。描述并识别每个方法。”

据我所知（这对 .NET 类来说是一个挑战），回发是在您提交 Web 表单后跟后退按钮时发生的事情。

我们得到的唯一线索是：

“第一次请求页面时，是回发吗？不是。”

那是我的全部了。任何人有任何想法或资源？

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T23:49:09.227

查看[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T00:00:52.273

这些是我在某些时候对源进行反射的笔记：

1.  加载滚动位置
2.  执行预初始化
    *   火灾预初始化事件
    *   初始化主题
    *   应用母版页
3.  初始化递归
    *   递归：
        *   为控件生成命名容器 ID
        *   设置 control.page 属性
        *   初始化控件
    *   设置 Page.Form 属性
    *   涂抹皮肤
    *   火灾初始化事件
4.  初始化完成
    *   触发 InitComplete 事件
5.  （如果回发）LoadAllState
    *   加载已注册控件的控件状态
    *   加载视图状态
6.  （如果回发） ProcessPostData
    *   为实现 IPostBackDataHandler 的控件加载 PostData
7.  预加载
    *   火灾预加载事件
8.  加载递归
    *   火灾荷载事件
    *   递归：
        *   负载控制
9.  （如果回发） ProcessPostData
    *   为实现 IPostBackDataHandler 的控件加载剩余的 PostData
10.  （如果回发）RaiseChangedEvents
    *   为实现 IPostBackDataHandler 的控件引发更改事件
11.  （如果回发） RaisePostBackEvent
    *   为实现 IPostBackEventHandler 的控件引发回发事件
    *   证实
12.  加载完成
    *   火灾加载完成事件
13.  预渲染
14.  保存状态
15.  使成为

这使得 LoadAllState、ProcessPostData、RaiseChangedEvents 和 RaisePostBackEvent 成为仅在 PostBack 上完成的那些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T23:50:56.603

此外，以下文章[文章](http://www.eggheadcafe.com/articles/20051227.asp)可能具有一定的价值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T23:51:36.803

您对后退按钮部分的看法是错误的 - 来自[维基百科](http://en.wikipedia.org/wiki/Postback)：

> 回发是交互式网页采取的一种动作，当整个页面及其内容被发送到服务器以处理某些信息，然后服务器将同一页面回发给浏览器。
> 
> 这样做是为了验证登录密码、处理在线订单或其他客户端计算机无法自行完成的任务。这不应与浏览器上的按钮执行的刷新或返回操作相混淆。

我通常将此视为链接，其内容类似于`do_postback`后面跟着一串（看似）随机数。

# sql-server - 在 SQL Server 数据库中计算字符串的哈希值 - 值得努力吗？

> ID：699499
> 
> 赞同：2
> 
> 时间：2009-03-30T23:48:27.683
> 
> 标签：sql-server, database, performance, hash

假设我的 SQL Server 2005 数据库中有一个百万行表 [mytable]，其中包含以下列：

*   ID
*   某个领域
*   另一个领域
*   网址

该系统中一个非常常见的查询是：

select * from [mytable] where url = ' [http://www.somesite.com/some/really/long/url](http://www.somesite.com/some/really/long/url) '

**这会给我更好的表现：**

a) 向 Url 列添加索引。

或者

b) 添加一个额外的“url_hash”列，其中包含与 url 对应的数字哈希，然后计算该哈希以在我的 where 子句中使用，例如：

select * from [mytable] where url_hash = some-computed-hash and url = ' [http://www.somesite.com/some/really/long/url](http://www.somesite.com/some/really/long/url) '

(b) 是否值得额外的复杂性？我需要计算插入和选择的哈希值。

**2009 年 3 月 30 日更新**

ID是主键

另外，上面的查询不应该有“*”。相反，选择列表应该是表中的所有字段。

“*”只是简写 - 很抱歉造成混淆。

**2009 年 3 月 31 日更新**

另外，忘了提一下， url_hash 字段上会有一个索引。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T00:15:11.940

简单来说，一个字符串越长，两个字符串越相似，比较需要的时间就越长（考虑一个1000个字符长的字符串，唯一的区别是最后一个字符，你可以看到在例程之前需要多长时间发现差异）。

但是，让我们将比较长字符串的成本与在磁盘上定位它们的成本进行对比。

索引存储在 B+Trees 中，它们是具有可变数量节点的平衡树，并且每个节点都链接到另一个节点 (a -> b -> c)。这为我们提供了两种功能：通过遍历树快速查找，然后快速按树顺序访问其他节点（一旦找到'a'，就很容易找到'b'，然后是'c'，等等）。

索引在磁盘页中布局，通常可以塞入索引页的节点越多，索引 B+树的整体高度就越低。树的高度越低，您找到特定行的速度就越快，因为您通常会遍历树的高度（因为它是平衡的）以到达任何一个叶节点。

高度越低，您必须进行的磁盘撞击就越少。如果你有一棵 4 高的树，那么要到达任何随机节点都需要将 4 个索引页加载到 RAM 中，这就是 4 个磁盘命中。因此，一棵 4 高的树的效率是 8 棵高的树的“两倍”（对于“两倍”的各种值）。

此外，您可以在索引页面中放入的越多，如果您开始沿节点进行迭代，您需要的点击次数就越少。如果您的节点拥有 10 个键值，则加载 100 行将花费您 10 次索引页面命中，而如果每个节点仅拥有 5 个，您将获得两倍的索引磁盘命中。

请注意，就需要向树中添加新层的记录数量而言，您会得到几何级数。（即 5 个关键节点和 10 个关键节点之间的差异不是记录的两倍。）

所以，这就是拥有小键的价值——在你的索引树中有很多扇出。

请注意，使用哈希，您仍然必须执行“其中 hash = 和 url ='...'”。

但这实际上归结为您的数据访问模式。数据库有多忙，你做了什么样的查询，你需要多少内存来缓存索引页等等。

定位您的初始行的索引可能甚至不在您的查询时间的雷达上。

关键点是记录的数量并不重要，但索引树的扇出很重要。例如，如果你有一个 1K 的索引节点和一个 4 字节的索引（long int），每个索引可以得到 250 个节点（这里非常简单），一个 3 层树可以得到，什么，16M 行都在一个3 深树 - 3 个磁盘命中内的 16M 行中的任何一个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T23:50:37.040

如果您只选择您需要的列（与“*”相反），并在“Url”和所选列上创建一个覆盖非聚集索引，您将获得非常有效的查找。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T00:04:44.853

即使您计算 URL 的哈希码，除非您为哈希码列添加索引，否则您不会获得很好的性能，因此最好只在 URL 列上添加索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T00:42:26.137

这是否描述了您在实际应用程序中使用真实表时遇到的实际问题，或者您是否正在寻找您不知道是否需要的优化？

如果不是＃1，那么我建议您索引 url，然后处理应用程序的其余部分，直到您遇到问题（这不太可能）。

# http - 带有“Transfer-Encoding: chunked”的 HTTP 响应中的块大小对位于 HTTP 之上的协议是否重要？

> ID：699506
> 
> 赞同：2
> 
> 时间：2009-03-30T23:51:18.193
> 
> 标签：http, rpc, chunked-encoding

HTTP 内部携带的东西是否关心块大小？也许某种 RPC 协议？

**编辑：**这是[维基百科](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)示例响应

```
Date: Mon, 30 Mar 2009 22:22:21 GMT

HTTP/1.1 200 OK
Content-Type: text/plain
Transfer-Encoding: chunked

23
This is the data in the first chunk

1A
and this is the second one

0 
```

响应可能很容易被分成不同于 23 和 1A 大小的块。是否存在块边界可能很重要的情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T00:13:51.163

据我所知没有。如果不是一个彻底的错误，那将违背 HTTP 的精神。

# php - 为什么使用 !== FALSE 来检查 php 中的 stripos？

> ID：699507
> 
> 赞同：18
> 
> 时间：2009-03-30T23:51:22.543
> 
> 标签：php, comparison, operators, conditional

这是我正在查看的代码。

```
foreach ($header as $idx => $field) {
    if (stripos($field, 'foo') !== false) {
        $cols['foo'] = $idx;
    } else if (stripos($field, 'bar') !== false) {
        $cols['bar'] = $idx;
    } else if (stripos($field, 'brr') !== false) {
        $cols['brr'] = $idx;
    } else if (stripos($field, 'ffo') !== false) {
        $cols['ffo'] = $idx;
    }
} 
```

对不起，也不知道如何漂亮地格式化代码，任何提示都将不胜感激。

我正在查看一些比我聪明得多的人编写的代码，所以我不倾向于相信我的第一印象只是将所有内容更改为`if(stripos($foo))`，但为什么要这样做呢？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-03-30T23:56:46.230

答案是在 PHP 中，一个“假”值可以由少数几个值来满足，例如空数组、空字符串、NULL、整数 0 等。完整列表请参见 empty() 函数页面：

[http://php.net/empty](http://php.net/empty)

所以这*总是*会产生不正确的结果：

```
if(strpos("abc", "a")) { 
  echo "Yes";
} else {
  echo "No";
} 
```

由于“a”出现在第一个位置（索引 0），因此 PHP 认为“if (0)”为假。

当 strpos 没有在你的大海捞针中找到针时，它将返回布尔值 FALSE，这是你想用三等号运算符检查类型和值的内容。请参阅有关比较运算符的文档

[http://www.php.net/manual/en/language.operators.comparison.php](http://www.php.net/manual/en/language.operators.comparison.php)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T23:57:47.927

[stripos](http://us2.php.net/stripos)返回一个字符串在另一个字符串中的位置，如果找不到该字符串，则返回 false，因此建议使用恒等[比较运算符](http://us2.php.net/manual/en/language.operators.comparison.php)（===，!==），因为 PHP 将 0 视为“假”值，考虑这个例子：

```
// Find the position of the 'a' character in the 'abc' string:
stripos('abc', 'a') !== false; // true, position is 0
stripos('abc', 'a') != false; // false, 0 is "falsy" 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-31T00:05:04.807

在 PHP 中，!== 表示不同类型的 AND 值。

如果 stripos() 返回 false 以外的任何值（并且完全是“false”，而不是零），这意味着它找到了一些东西，即使位置为 0 并且返回了 int(0)。**0 和 false 在与==**进行标准比较时相等，但在使用身份**===**运算符时不相等，因此知道 stripos() 是否确实找到某些东西的唯一方法是使用比较**false**的值和类型!== （不相同，即 strpos() 的返回值的类型和值相同。）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-30T23:54:37.763

因为如果字符串在位置 0 匹配，则 0 的计算结果为 false，因此您确保添加额外的 '=' 以便考虑该类型。

[`strpos()`](http://php.net/strpos/)**未找到**匹配项时返回 false 。

查看[比较运算符](http://us2.php.net/manual/en/language.operators.comparison.php)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-31T07:24:37.090

不知道这样的东西是否更容易维护。取决于你是否在这些条件下做其他事情。但是您可以在配置文件 db 中设置键，作为参数传递给您的函数，或类似的。

```
$keys = array(
    'foo',
    'bar',
    'brr',
    'ffo',
);
foreach ($header as $idx => $field) {
    foreach ($keys as $key) {
        if (stripos($field, $key) !== false) {
            $cols[$key] = $idx;
            break;
        }
    }
} 
```

# python - 直接引用时，是否可以在 Python 中创建代表另一种类型的类？

> ID：699510
> 
> 赞同：2
> 
> 时间：2009-03-30T23:52:10.093
> 
> 标签：python, class, object

因此，如果我有这样的课程：

```
CustomVal 
```

我希望能够表示一个文字值，就像在构造函数中设置它一样：

```
val = CustomVal ( 5 )

val.SomeDefaultIntMethod 
```

基本上我希望 CustomVal 代表构造函数中指定的任何内容。

我不是在谈论知道如何处理 CustomVal 的自定义方法，而是让它成为我需要的另一个值。

这可能吗？

Btw 5 只是一个示例，实际上它是我想轻松实例化的自定义 COM 类型。

因此，通过引用 CustomVal，我将可以访问与 int 相关的功能（对于 5），或者我想要表示的对象的功能（对于 COM）。

因此，如果 COM 对象是 RasterizedImage，那么我将可以直接访问它的方法：

```
CustomVal.Raster () ... 
```

编辑：这就是我的意思：我不想作为属性访问，而是对象本身：

```
CustomVal 
```

代替：

```
CustomVal.SomeAttribute 
```

我想要这样做的原因是，COM 对象过于复杂而无法初始化，通过这种方式，它看起来就像应用程序提供的原始内部实现。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T23:59:48.563

在 Python 中包装对象的常用方法是`__getattr__`在您的类中覆盖：

```
class CustomVal(object):
    def __init__(self, value):
        self.value = value

    def __getattr__(self, attr):
        return getattr(self.value, attr) 
```

那么你可以做

```
>>> obj = CustomVal(wrapped_obj)
>>> obj.SomeAttributeOfWrappedObj 
```

您还可以分别覆盖`__setattr__`和`__delattr__`启用设置和删除属性（请参阅[Python 库文档](http://docs.python.org/reference/datamodel.html#object.__getattr__)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T00:03:25.090

您可能只是想多了......您可以将任何您想要的内容放入您的`val`中，然后调用您想要的对象的任何方法：

```
>>> val = ThingaMoBob(123, {p:3.14}, flag=False)
>>> val.SomeCrazyMathod() 
```

我错过了什么吗？

# python - python装饰器和方法

> ID：699526
> 
> 赞同：8
> 
> 时间：2009-03-30T23:59:12.620
> 
> 标签：python, metaprogramming, decorator

新来的。我也是（非常）python 的新手，并试图理解以下行为。有人可以向我解释为什么这个例子中的两种方法有不同的输出吗？

```
def map_children(method):
    def wrapper(self,*args,**kwargs):
        res = method(self,*args,**kwargs)
        for child in self._children:
            method(child,*args,**kwargs)            
        return res
    return wrapper

class Node(object):

    def __init__(self,name,parent=None):
        self._namestring = name
        if parent:
            self._parent = parent

        self._children = []

    @map_children
    def decorated(self):
        if hasattr(self,'_parent'):
            print '%s (child of %s)'%(self._namestring,self._parent._namestring)
        else:
            print '%s'% self._namestring

    def undecorated(self):
        if hasattr(self,'_parent'):
            print '%s (child of %s)'%(self._namestring,self._parent._namestring)
        else:
            print '%s'% self._namestring

        for child in self._children:
            child.undecorated()

def runme():
    parent = Node('parent')

    child1 = Node('child1',parent)
    child2 = Node('child2',parent)
    grandchild = Node('grandchild',child1)
    child1._children.append(grandchild)
    parent._children.append(child1)
    parent._children.append(child2)

    print '**********result from decorator**********'
    parent.decorated()

    print '**********result by hand**********'
    parent.undecorated() 
```

这是我系统上的输出：

```
在[]:testcase.runme()
**********装饰师的结果**********
父母
child1（父母的孩子）
child2（父母的孩子）
**********手工结果**********
父母
child1（父母的孩子）
孙子（child1 的孩子）
child2（父母的孩子）

```

那么为什么装饰调用永远不会下降到孙节点呢？我显然错过了一些关于语法的东西......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T00:15:02.113

在装饰器中，您循环遍历节点的子节点并调用*原始*的、非递归`method`的

```
method(child, *args, **kwargs) 
```

所以你只会深入一层。尝试将该行替换为

```
map_children(method)(child, *args, **kwargs) 
```

您将获得与手动递归版本相同的输出。

# iphone - 使用 iPhone API 拍照并将其传输到服务器

> ID：699529
> 
> 赞同：8
> 
> 时间：2009-03-31T00:00:51.273
> 
> 标签：iphone, objective-c, cocoa-touch, uiimage, data-transfer

我写了一个可可应用程序来在 iPhone 上拍照。我需要将拍摄的图像传输到 iPhone 以外的某个地方，即另一台服务器。有谁知道我怎么能做到这一点？

谢谢，乔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T04:23:38.490

首先获取一个服务器并弄清楚你想要使用什么样的手机<--->服务器API。它有多种工作方式。一个简单而常见的方案是 REST API，其中照片通过 HTTP POST 上传。

基本方案类似于：

1.  拍照片
2.  转换为 JPG（有一个功能）
3.  使用 NSURL* 类构造 HTTP POST
4.  将 JPG 数据设置为 POST 正文（或多部分表单帖子的一部分）

不需要转换为 base64。

如果您从未组装过任何类型的服务器 API，那么可以使用任意数量的示例。大多数照片共享网站都有公共 API，它们可能是有用的参考。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T00:25:02.480

到目前为止，最简单的方法是使用 HTTP `POST`。查看文档中的“URL 加载系统”，然后检查相关的类，尤其是`NSURLRequest`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T06:13:06.870

正如其他人所说，使用 HTTP POST。[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/ "ASIHTTP")使您的 POST 变得简单。它还将您的上传移动到后台线程并为您的委托进度更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T00:19:55.377

您始终可以将图像数据转换为 base 64 字符串并将其发布到目标服务器上的 php（或其他）脚本。

# c# - 将多个文件添加到目录时，FileSystemWatcher 出现文件访问错误

> ID：699538
> 
> 赞同：42
> 
> 时间：2009-03-31T00:09:16.013
> 
> 标签：c#, exception-handling, filesystemwatcher, file-access

当将多个文件放入监视目录时，我遇到了 FileSystemWatcher 的问题。我想将文件放在目录中后立即对其进行解析。通常，第一个文件解析得很好，但是将第二个文件添加到目录会导致访问问题。有时，第一个文件甚至不解析。只有一个应用程序正在运行并监视此目录。最终，这个过程将在多台机器上运行，它们将监视一个共享目录，但只有一台服务器可以解析每个文件，因为数据被导入数据库并且没有主键。

这是 FileSystemWatcher 代码：

```
public void Run() {
  FileSystemWatcher watcher = new FileSystemWatcher("C:\\temp");
  watcher.NotifyFilter = NotifyFilters.FileName;
  watcher.Filter = "*.txt";

  watcher.Created += new FileSystemEventHandler(OnChanged);

  watcher.EnableRaisingEvents = true;
  System.Threading.Thread.Sleep(System.Threading.Timeout.Infinite);
} 
```

然后解析文件的方法：

```
private void OnChanged(object source, FileSystemEventArgs e) {
  string line = null;

  try {
    using (FileStream fs = new FileStream(e.FullPath, FileMode.Open, FileAccess.Read, FileShare.None)) {
      using (StreamReader sr = new StreamReader(fs)) {
        while (sr.EndOfStream == false) {
          line = sr.ReadLine();
          //parse the line and insert into the database
        }
      }
    }
  }
  catch (IOException ioe) {
    Console.WriteLine("OnChanged: Caught Exception reading file [{0}]", ioe.ToString());
  } 
```

移动第二个文件时，它正在捕获

> System.IO.IOException：该进程无法访问文件“C:\Temp\TestFile.txt”，因为它正被另一个进程使用。

如果它在多台机器上运行，我希望看到这个错误，但它现在只在一台服务器上运行。不应该有其他进程使用此文件 - 我创建了它们并将它们复制到应用程序运行时的目录中。

这是设置 FileSystemWatcher 的正确方法吗？我怎样才能看到这个文件上的锁是什么？为什么它不解析这两个文件 - 我必须关闭 FileStream 吗？我想保留 FileShare.None 选项，因为我只想要一个服务器来解析文件 - 获取文件的服务器首先解析它。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-31T00:32:51.243

这种方法的一个典型问题是在触发事件时文件仍在被复制。显然，您会得到一个异常，因为文件在复制过程中被锁定。大文件尤其容易出现异常。

作为一种解决方法，您可以先复制文件，然后重命名它并监听重命名事件。

或者另一种选择是有一个while循环检查文件是否可以用写访问权限打开。如果可以，您将知道复制已完成。C# 代码可能如下所示（在生产系统中，您可能希望有最大重试次数或超时而不是`while(true)`）：

```
/// <summary>
/// Waits until a file can be opened with write permission
/// </summary>
public static void WaitReady(string fileName)
{
    while (true)
    {
        try
        {
            using (Stream stream = System.IO.File.Open(fileName, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite))
            {
                if (stream != null)
                {
                    System.Diagnostics.Trace.WriteLine(string.Format("Output file {0} ready.", fileName));
                    break;
                }
            }
        }
        catch (FileNotFoundException ex)
        {
            System.Diagnostics.Trace.WriteLine(string.Format("Output file {0} not yet ready ({1})", fileName, ex.Message));
        }
        catch (IOException ex)
        {
            System.Diagnostics.Trace.WriteLine(string.Format("Output file {0} not yet ready ({1})", fileName, ex.Message));
        }
        catch (UnauthorizedAccessException ex)
        {
            System.Diagnostics.Trace.WriteLine(string.Format("Output file {0} not yet ready ({1})", fileName, ex.Message));
        }
        Thread.Sleep(500);
    }
} 
```

另一种方法是在复制完成后在文件夹中放置一个小的触发器文件。您的 FileSystemWatcher 只会监听触发文件。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-09-21T21:33:24.440

我会在上面留下评论，但我还没有足够的积分。

这个问题的评价最高的答案有一段代码，如下所示：

```
using (Stream stream = System.IO.File.Open(fileName, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite))
{
    if (stream != null)
    {
        System.Diagnostics.Trace.WriteLine(string.Format("Output file {0} ready.", fileName));
        break;
    }
} 
```

使用`FileShare.ReadWrite`设置的问题是它请求访问文件基本上是说“我想读/写这个文件，但其他人也可以读/写它”。这种方法在我们的情况下失败了。接收远程传输的进程没有锁定文件，但它正在积极地写入文件。我们的下游代码（SharpZipLib）因“正在使用的文件”异常而失败，因为它试图用一个`FileShare.Read`（“我想要读取文件，并且只让其他进程也读取”）打开文件。因为打开文件的进程已经在写入，所以这个请求失败了。

但是，上面响应中的代码过于宽松。通过使用`FileShare.ReadWrite`，它成功地获得了对文件的访问权（因为它要求一个可以遵守的共享限制），但是下游调用继续失败。

调用中的共享设置`File.Open`应该是`FileShare.Read`or`FileShare.None`和**NOT** `FileShare.ReadWrite`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T13:01:01.127

当您在 OnChanged 方法中打开文件时，您正在指定`FileShare.None`，根据[文档](http://msdn.microsoft.com/en-us/library/system.io.fileshare.aspx)，这将导致在您打开文件时任何其他尝试打开文件失败。由于您（和您的观察者）所做的只是阅读，因此请尝试使用`FileShare.Read`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-11T11:07:53.893

简单的解决方案是在收到通知后处理 filesystemwatcher。在复制文件之前，让当前线程等待，直到它收到 filesystemwatcher 处置事件。然后您可以继续复制更改的文件而不会出现访问问题。我有同样的要求，我完全按照我提到的那样做了。有效。

示例代码：

```
public void TestWatcher()
{
    using (var fileWatcher = new FileSystemWatcher())
    {

        string path = @"C:\sv";
        string file = "pos.csv";

        fileWatcher.Path = path;
        fileWatcher.NotifyFilter = NotifyFilters.CreationTime | NotifyFilters.LastWrite;
        fileWatcher.Filter = file;

        System.EventHandler onDisposed = (sender,args) =>
        {
           eve.Set();
        };

        FileSystemEventHandler onFile = (sender, fileChange) =>
        {
           fileWatcher.EnableRaisingEvents = false;
           Thread t = new Thread(new ParameterizedThreadStart(CopyFile));
           t.Start(fileChange.FullPath);
           if (fileWatcher != null)
           {
               fileWatcher.Dispose();
           }
           proceed = false;
        };

        fileWatcher.Changed += onFile;
        fileWatcher.Created += onFile;
        fileWatcher.Disposed+= onDisposed;
        fileWatcher.EnableRaisingEvents = true;

        while (proceed)
        {
            if (!proceed)
            {
                break;
            }
        }
    }
}

public void CopyFile(object sourcePath)
{
    eve.WaitOne();
    var destinationFilePath = @"C:\sv\Co";
    if (!string.IsNullOrEmpty(destinationFilePath))
    {
        if (!Directory.Exists(destinationFilePath))
        {
            Directory.CreateDirectory(destinationFilePath);
        }
        destinationFilePath = Path.Combine(destinationFilePath, "pos.csv");
    }           

    File.Copy((string)sourcePath, destinationFilePath);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-01T15:17:20.743

FileSystemWatcher 触发 watcher.Created 事件**两次**，每次创建文件时，文件复制开始时 1ce 和文件复制完成时第二次。您所要做的就是忽略第一个事件并第二次处理事件。

事件处理程序的一个简单示例：

```
private bool _fileCreated = false;
private void FileSystemWatcher_FileCreated(object sender, FileSystemEventArgs e)
{
    if (_fileCreated)
    {
        ReadFromFile();//just an example method call to access the new file
    }

    _fileCreated = !_fileCreated;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-14T17:18:59.040

我觉得你想要的一个很好的例子是 log4net 中的 ConfigureAndWatchHandler。他们使用计时器来触发文件处理程序事件。我觉得这最终成为 0xA3 帖子中 while 循环的更清洁实现。对于那些不想使用 dotPeek 检查文件的人，我将尝试在此处根据 OP 代码为您提供代码片段：

```
private System.Threading.Timer _timer;    

public void Run() {
  //setup filewatcher
  _timer = new System.Threading.Timer(new TimerCallback(OnFileChange), (object) null, -1, -1);
}

private void OnFileChange(object state)
{
    try 
    {
    //handle files
    }
    catch (Exception ex) 
    {
        //log exception
        _timer.Change(500, -1);
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-08T09:19:34.250

我有类似的问题。只是因为 FileSystemWatcher。我刚刚使用了
Thread.Sleep();

现在它工作正常。当文件进入目录时，它会调用 onCreated 两次。所以当文件被复制时一次。第二次复制完成时。为此，我使用了 Thread.Sleep(); 所以它会在我调用 ReadFile(); 之前等待。

```
private static void OnCreated(object source, FileSystemEventArgs e)
    {
        try
        {
            Thread.Sleep(5000);
            var data = new FileData();
            data.ReadFile(e.FullPath);                
        }
        catch (Exception ex)
        {
            WriteLogforError(ex.Message, String.Empty, filepath);
        }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T12:46:00.273

我在 DFS 中遇到了同样的问题。我的解决方案是通过在每个文件中添加两个空行来实现的。然后我的代码等待文件中的两个空行。然后我确定从文件中读取整个数据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-04T08:45:27.660

```
public static BitmapSource LoadImageNoLock(string path)
{
    while (true)
    {
        try
        {
            var memStream = new MemoryStream(File.ReadAllBytes(path));
            var img = new BitmapImage();
            img.BeginInit();
            img.StreamSource = memStream;
            img.EndInit();
            return img;
            break;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
    }
} 
```

# .net - 企业服务中的事务和池功能是否有现代替代品？

> ID：699542
> 
> 赞同：5
> 
> 时间：2009-03-31T00:10:00.893
> 
> 标签：.net, wcf, com+

我正在使用 EnterpriseServices AKA Com+ 的 ServicedComponent

*   分布式事务
*   使用属性的简单事务编程
*   对象池

我发现 com+ 中缺少的东西

*   缺少 dll 版本控制
*   每次更改组件时都必须进行 gac 和 reg 的痛苦
*   必须附加调试器

我知道 WCF 解决了一些与 COM+ 相同的问题。但它能解决所有问题吗？有人能指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T04:08:22.863

我对 COM+ 的来龙去脉不是很熟悉，但构建 WCF 是为了替代它和 .NET 平台中的企业服务。您在此处提到的所有用例都已融入框架（池、事务、版本控制），并且对于编写代码来说几乎是微不足道的，只要您花时间了解它想要如何做事。当您正确配置事物时，您可以使用它做的事情几乎没有限制。

WCF 还支持微软为近期和长期未来所做的许多工作（Azure 服务）。我认为这是您学习时间的一项值得投资，尤其是考虑到您的 COM+ 背景。

我强烈推荐 Juval Lowy 的书作为一个很好的起点。在这个主题上，他可能是你会发现的最权威的声音。

[http://oreilly.com/catalog/9780596521301/?CMP=AFC-ak_book&ATT=Programming+WCF+Services%2c+Second+Edition%2c](http://oreilly.com/catalog/9780596521301/?CMP=AFC-ak_book&ATT=Programming+WCF+Services%2c+Second+Edition%2c)

我还建议您查看他的公司 IDesign 的网站。他们不仅提供出色的培训，而且他们有一个非常有用的 WCF 扩展库，称为 ServiceModelEx，它提供了许多实用程序扩展/帮助类，使您的 WCF 生活更轻松。

[http://www.idesign.net/idesign/DesktopDefault.aspx](http://www.idesign.net/idesign/DesktopDefault.aspx)

如果您正在寻找更具教程风格的书，Michele Leroux Bustamante 的书也相当不错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T19:32:28.087

如果您想在组件上进行基于属性的事务，WCF 可以为您完成。除了隐喻不再是 COM+ 中的组件；它现在是 WCF 中的服务。一个微妙但重要的转变。WCF 依赖于与 COM+ 相同的事务基础结构 (DTC)。

如果您只想在 .NET 中使用 COM+，它是 EnterpriseServices - 相同的模型，仍然需要使用 DLL 部署和版本控制。仍然可以获得池化等。还可以获得暂停/恢复和一些其他新的 ES 功能。

如果您只想要一个事务性编程模型，您可以使用 System.Transactions 命名空间。

至于对象池 - 看两次。可能值得重新检查您对对象池的使用。多年前，行业做出的假设或我们对实例化对象的成本的理解导致我们使用对象池的比喻。这些假设和理解在今天可能无效。换句话说，对象池可能对您的应用程序实际上有用，也可能没有。它仍然在 ES 中，但值得考虑是否需要它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T00:17:50.127

您应该看看[Enterprise Services](http://msdn.microsoft.com/en-us/library/ms973847.aspx)。

# asp.net-mvc - 在 Web 应用程序中将数据显示为流程图

> ID：699545
> 
> 赞同：3
> 
> 时间：2009-03-31T00:11:22.310
> 
> 标签：asp.net-mvc

我在 ASP.NET MVC 中构建了一个具有工作流组件的应用程序。

我正在寻找将底层工作流数据显示为流程图的东西/想法。

我不是在寻找流程图工具，而是在寻找将数据显示为流程图的东西。

有没有人有这方面的经验可以提供他们的智慧？

干杯，拜伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T00:34:47.090

您可能会发现[Graphviz](http://www.graphviz.org/)很有用。您可以生成图表的文本描述，它会为您提供很好的布局。

# python - 在 python os.system 中浏览不同的驱动器号

> ID：699550
> 
> 赞同：1
> 
> 时间：2009-03-31T00:15:04.873
> 
> 标签：python, windows, cmd

我在一台 Windows 机器上遇到了一些代码问题，但不是所有的 Windows 机器。我有以下代码：

```
path = "F:/dir/"
os.system(path[0:2] + " && cd " + path + " && git init") 
```

在我的一个 Windows 系统上，它运行良好，但在 Windows 2003 服务器上，它给出“找不到目录”错误，但如果我从命令提示符处运行相同的命令，它就会起作用。

如果我的问题含糊不清，我很抱歉，但我完全被难住了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T00:52:25.223

[os.path](http://docs.python.org/library/os.path.html)包含许多有用的路径操作函数。可能只是干净地处理路径就可以解决您的问题。

```
>>> import os
>>>
>>>
>>> path = "F:/dir/"
>>>
>>> clean_path = os.path.normpath(path)
>>> clean_path
'F:\\dir'
>>> drive, directory = os.path.splitdrive(clean_path)
>>> drive
'F:'
>>> directory
'\\dir' 
```

此外，您可能想研究使用[subprocess](http://docs.python.org/library/subprocess.html)模块，它可以让您更好地控制流程。

[用子流程模块替换旧功能](http://docs.python.org/library/subprocess.html#subprocess-replacements)

# asp.net - 在 asp:FormView 中插入 asp:ListView

> ID：699560
> 
> 赞同：0
> 
> 时间：2009-03-31T00:18:20.483
> 
> 标签：asp.net, listview, asp.net-3.5

我有一个使用 FormView 的 SelectedValue 的 asp:listview。

我对listview进行了很好的编辑，并且insert会插入一条记录，但它不会插入父FormView的SelectedValue ...

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T00:30:18.863

我添加了这个

```
 protected void ProposalAddressListView_ItemInserting(object sender, ListViewInsertEventArgs e)
    {
        e.Values[" My FormView Selected Value "] = MyFormView.DataKey.Value;
    } 
```

**更新：** 刚刚发现了类似的问题，[ListView with LINQ Datasource insert template](https://stackoverflow.com/questions/212257/listview-with-linq-datasource-insert-template)

# python - Python：测试 unicode，并转换为 time()

> ID：699570
> 
> 赞同：2
> 
> 时间：2009-03-31T00:25:42.180
> 
> 标签：python, django

有时 self.start 是 unicode：

例如。

```
>>>self.start
u'07:30:00' 
```

这让 datetime.combine 抱怨

```
start = datetime.combine(self.job_record.date, self.start) 
```

一个如何：

1.  测试unicode？
2.  从 u'07:30:00' 转换为 datetime.time？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T00:36:40.953

检查 unicode：

```
>>> import types
>>> type(u'07:30:00') is types.UnicodeType
True
>>> type('regular string') is types.UnicodeType
False 
```

将字符串转换为时间：

```
>>> import time
>>> time.strptime(u'07:30:00', '%H:%M:%S')
(1900, 1, 1, 7, 30, 0, 0, 1, -1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T00:50:34.073

`datetime.combine`抱怨是因为它希望第二个参数是一个`datetime.time`实例，而不是一个字符串（或 unicode 字符串）。

有几种方法可以将您的字符串转换为`datetime.time`实例。一种方法是使用`datetime.strptime`：

```
t = datetime.strptime(self.start, "%H:%M:%S").time()
start = datetime.combine(self.job_record.date, t) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T00:36:46.320

假设 '07:30:00' 中不会有扩展字符集字符，则使用`str(self.start)`.

如果时间中的数字可能是特定于字符集的，请使用`encode()`, 和适当的`error`参数说明符来转换为字符串。

在这种情况下，首先尝试`str()`并使用它`except`来处理无法转换的情况（请求宽恕而不是许可）可能更加pythonic。另一方面，如果您尝试转换的大多数值都失败了，请在应用函数之前先转换它们。

顺便说一句：该`combine`函数需要一个 datetime.date 对象和一个 datetime.time 对象。如果你真的想避免不可预知的行为，那么满足 API 和传递`date`和`time`对象的要求，而不是试图短路文档指定的合约：在调用之前转换参数，**而**`combine`不是要求`combine`你猜测。

# c# - 从 xml 在数据库中插入记录

> ID：699572
> 
> 赞同：1
> 
> 时间：2009-03-31T00:27:57.357
> 
> 标签：c#, xml, database, ado.net

我正在编写一个 .net windows 服务，我需要使用它来解析一个 xml（大约有 5000 个节点）。我需要解析这些节点并将数据（即 5000 行）插入到 sql 数据库中。我应该使用批量插入来插入所有这些记录，还是应该一个一个地插入它们？有人可以帮助我设计/算法以获得最佳性能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T00:36:03.747

从[使用 C# asp.net 将 XML 数据导入 SQL Server 表](http://www.akamarketing.com/blog/135-importing-xml-into-sql-server-table-aspnet.html)：

```
DataSet reportData = new DataSet();
reportData.ReadXml(Server.MapPath(”report.xml”));

SqlConnection connection = new SqlConnection(”CONNECTION STRING”);
SqlBulkCopy sbc = new SqlBulkCopy(connection);
sbc.DestinationTableName = “report_table”;

//if your DB col names don’t match your XML element names 100%
//then relate the source XML elements (1st param) with the destination DB cols
sbc.ColumnMappings.Add(”campaign”, “campaign_id”);
sbc.ColumnMappings.Add(”cost”, “cost_USD”);

connection.Open();

//table 4 is the main table in this dataset
sbc.WriteToServer(reportData.Tables[4]);
connection.Close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T12:43:46.307

由于您已经在使用 SQL Server，我建议您查看 SSIS（集成服务）。它有一个内置的 XML 源，可以直接注入 SQL Server。它速度很快，并且可以使您免于维护此代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T00:29:41.813

为获得最佳性能，请使用[仅向前 XML 阅读器](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.aspx)、[事务](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqltransaction.aspx)和[批量插入器。](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

当然，这个解决方案稍微有点棘手，而且它很可能存在一个更简单的实现，需要更少的代码并且性能很好（EG. [OPENXML](http://msdn.microsoft.com/en-us/library/aa276847(SQL.80).aspx)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T00:50:09.183

您可以使用 XSLT 转换将 XML 转换为带有插入语句的 SQL 文件。

我在一天左右的时间里做了一次作为概念证明。这是我所做的：

```
<xsl:strip-space elements="*"/>

<xsl:template match="auditlog">
<xsl:if test="sequence/struct/wstring[@value='edr']/../union/string/@value">
INSERT INTO AUDITLOGS (FILENAME, EVENTTIME, EDR) VALUES(
  '<xsl:value-of select="@filename"/>',
  '<xsl:value-of select="sequence/struct/union/any/sequence/struct/struct[@name='m_eventTime']/@datetime"/>',
  '<xsl:value-of select="sequence/struct/wstring[@value='edr']/../union/string/@value"/>'
);
<xsl:apply-templates select="sequence"/>
</xsl:if>
</xsl:template>

<xsl:template match="struct[@id='ModifiedBalance']">
INSERT INTO MODIFIEDBALANCE (SOURCEKIND, SOURCEID, TYPEID, NAMEID, ORIGINAL, CURRENT, LOGID)
SELECT
  '<xsl:value-of select="struct/enum/@value"/>',
  <xsl:value-of select="struct/longlong/@value"/>,
  <xsl:value-of select="struct/ushort[@id='BalanceTypeId']/@value"/>,
  <xsl:value-of select="struct/ushort[@id='BalanceNameId']/@value"/>,
  <xsl:value-of select="struct[@name='m_original']/@amount"/>,
  <xsl:value-of select="struct[@name='m_current']/@amount"/>,
  LOGID
FROM AUDITLOGS
  WHERE FILENAME = '<xsl:value-of select="../../../../../@filename"/>';
</xsl:template>

</xsl:stylesheet> 
```

# validation - 验证 Bash 脚本的参数

> ID：699576
> 
> 赞同：107
> 
> 时间：2009-03-31T00:29:45.293
> 
> 标签：validation, bash, shell

我想出了一个基本的方法来帮助自动化删除一些不需要的文件夹的过程。

```
#!/bin/bash
rm -rf ~/myfolder1/$1/anotherfolder
rm -rf ~/myfolder2/$1/yetanotherfolder
rm -rf ~/myfolder3/$1/thisisafolder 
```

这是这样引起的：

```
./myscript.sh <{id-number}> 
```

问题是，如果你忘记输入`id-number` *（就像我刚才所做的那样）*，那么它可能会删除很多你真的不想删除的东西。

**有没有办法可以向命令行参数添加任何形式的验证？**在我的情况下，最好检查一下 a) 有一个参数，b) 它是数字的，c) 该文件夹是否存在；在继续执行脚本之前。

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2009-03-31T00:43:45.837

```
#!/bin/sh
die () {
    echo >&2 "$@"
    exit 1
}

[ "$#" -eq 1 ] || die "1 argument required, $# provided"
echo $1 | grep -E -q '^[0-9]+$' || die "Numeric argument required, $1 provided"

while read dir 
do
    [ -d "$dir" ] || die "Directory $dir does not exist"
    rm -rf "$dir"
done <<EOF
~/myfolder1/$1/anotherfolder 
~/myfolder2/$1/yetanotherfolder 
~/myfolder3/$1/thisisafolder
EOF 
```

**编辑**：我错过了关于检查目录是否存在的部分，所以我添加了它，完成了脚本。此外，解决了评论中提出的问题；修复了正则表达式，从 切换`==`到`eq`.

据我所知，这应该是一个可移植的、符合 POSIX 的脚本；它不使用任何 bashisms，这实际上很重要，因为`/bin/sh`在 Ubuntu 上实际上是`dash`这些天，而不是`bash`.

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-31T06:19:28.103

的`sh`解决方案`Brian Campbell`虽然高贵且执行良好，但有一些问题，所以我想我会提供自己的`bash`解决方案。

一个的问题`sh`：

*   波浪号 in`~/foo`不会扩展到您在 heredocs 中的主目录。并且无论是在声明中阅读`read`或在声明中引用时`rm`。这意味着你会得到`No such file or directory`错误。
*   分叉`grep`等基本操作是愚蠢的。尤其是当您使用蹩脚的外壳来避免 bash 的“沉重”重量时。
*   我还注意到一些引用问题，例如围绕他的`echo`.
*   虽然很少见，但该解决方案无法处理包含换行符的文件名。（几乎没有解决方案`sh`可以应对它们 - 这就是为什么我几乎总是更喜欢`bash`，如果使用得当，它更防弹且更难利用）。

虽然，是的，使用`/bin/sh`你的 hashbang 意味着你必须`bash`不惜一切代价避免 isms，你可以使用所有`bash`你喜欢的 isms，即使在 Ubuntu 或诸如此类的东西上，当你诚实并放在`#!/bin/bash`顶部时也是如此。

因此，这是一个`bash`更小、更清洁、更透明、可能“更快”且更防弹的解决方案。

```
[[ -d $1 && $1 != *[^0-9]* ]] || { echo "Invalid input." >&2; exit 1; }
rm -rf ~/foo/"$1"/bar ... 
```

1.  `$1`注意声明中的引号`rm`！
2.  如果为空，`-d`检查也会失败`$1`，所以这是两个检查合二为一。
3.  我避免使用正则表达式是有原因的。如果必须`=~`在 bash 中使用，则应将正则表达式放入变量中。无论如何，像我这样的 glob 总是更受欢迎，并且在更多 bash 版本中得到支持。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-31T00:45:46.627

不像上述答案那样防弹，但仍然有效：

```
#!/bin/bash
if [ "$1" = "" ]
then
  echo "Usage: $0 <id number to be cleaned up>"
  exit
fi

# rm commands go here 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-03-31T01:01:28.337

我会使用 bash 的`[[`：

```
if [[ ! ("$#" == 1 && $1 =~ ^[0-9]+$ && -d $1) ]]; then 
    echo 'Please pass a number that corresponds to a directory'
    exit 1
fi 
```

我发现[此常见问题解答](http://mywiki.wooledge.org/BashFAQ/031)是一个很好的信息来源。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-12-07T11:52:12.397

使用`set -u`which 将导致任何未设置的参数引用立即使脚本失败。

请参阅文章：[编写健壮的 Bash Shell 脚本 - David Pashley.com](https://www.davidpashley.com/articles/writing-robust-shell-scripts/)。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-03-31T00:54:25.997

test ( `man test`) 的手册页提供了所有可用的运算符，您可以在 bash 中将其用作布尔运算符。在脚本（或函数）的开头使用这些标志进行输入验证，就像在任何其他编程语言中一样。例如：

```
if [ -z $1 ] ; then
  echo "First parameter needed!" && exit 1;
fi

if [ -z $2 ] ; then
  echo "Second parameter needed!" && exit 2;
fi 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-03-31T00:36:36.990

使用“-z”测试空字符串，使用“-d”检查目录。

```
if [[ -z "$@" ]]; then
    echo >&2 "You must supply an argument!"
    exit 1
elif [[ ! -d "$@" ]]; then
    echo >&2 "$@ is not a valid directory!"
    exit 1
fi 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2020-01-26T19:20:11.313

# 一个班轮 Bash 参数验证，有和没有目录验证

以下是一些对我有用的方法。您可以在全局脚本命名空间中使用它们（如果在全局命名空间中，则不能引用函数内置变量）

**快速而肮脏的一个衬垫**

```
: ${1?' You forgot to supply a directory name'} 
```

输出：

```
./my_script: line 279: 1: You forgot to supply a directory name 
```

**Fancier - 提供函数名称和用法**

```
${1? ERROR Function: ${FUNCNAME[0]}() Usage: " ${FUNCNAME[0]} directory_name"} 
```

输出：

```
./my_script: line 288: 1:  ERROR Function: deleteFolders() Usage:  deleteFolders directory_name 
```

**添加复杂的验证逻辑而不会弄乱您当前的功能**

在接收参数的函数或脚本中添加以下行。

```
: ${1?'forgot to supply a directory name'} && validate $1 || die 'Please supply a valid directory' 
```

然后，您可以创建一个验证函数来执行类似的操作

```
validate() {

    #validate input and  & return 1 if failed, 0 if succeed
    if [[ ! -d "$1" ]]; then
        return 1
    fi
} 
```

以及一个在失败时中止脚本的 die 函数

```
die() { echo "$*" 1>&2 ; exit 1; } 
```

对于其他参数，只需添加一个额外的行，复制格式。

```
: ${1?' You forgot to supply the first argument'}
: ${2?' You forgot to supply the second argument'} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2010-03-26T15:00:34.297

您可以通过执行以下操作来紧凑地验证点 a 和 b：

```
#!/bin/sh
MYVAL=$(echo ${1} | awk '/^[0-9]+$/')
MYVAL=${MYVAL:?"Usage - testparms <number>"}
echo ${MYVAL} 
```

这给了我们...

```
$ ./testparams.sh 
Usage - testparms <number>

$ ./testparams.sh 1234
1234

$ ./testparams.sh abcd
Usage - testparms <number> 
```

这种方法应该在 sh 中可以正常工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-22T15:45:09.253

旧帖子，但我想我无论如何都可以做出贡献。

可以说脚本不是必需的，并且可以从命令行执行对通配符的一些容忍度。

1.  野生的任何地方匹配。让我们删除任何出现的子“文件夹”

    > ```
    > $ rm -rf ~/*/folder/* 
    > ```

2.  壳牌迭代。让我们用一行删除特定的 pre 和 post 文件夹

    > ```
    > $ rm -rf ~/foo{1,2,3}/folder/{ab,cd,ef} 
    > ```

3.  Shell iterated + var（经过 BASH 测试）。

    > ```
    > $ var=bar rm -rf ~/foo{1,2,3}/${var}/{ab,cd,ef} 
    > ```

# javascript - Javascript/css/php/mysql 在网站的 div 中收集用户电子邮件地址

> ID：699577
> 
> 赞同：2
> 
> 时间：2009-03-31T00:29:47.490
> 
> 标签：javascript, css, ajax, webforms, lamp

假设您想要在您的网站上显示“给我们您的电子邮件地址，我们将向您发送新闻”或类似内容的框。收集这些电子邮件地址的简单/优雅的方法是什么（假设是标准的 LAMP 堆栈）？特别是，我想建议

1.  处理 UI 的 Javascript（如果电子邮件地址无效，请抱怨，当他们回车时表示感谢等）。
2.  CSS 让它看起来不错。
3.  PHP 实际收集电子邮件地址并存储它们（平面文件或数据库都可以）。

或者，如果有一种花哨的 Rails 或 AJAX 方式可以做到这一点，我也对此非常开放。

（我目前所知道的就是如何使用老式的 CGI 方法，使用带有提交按钮的纯 html Web 表单和获取表单内容、提取电子邮件地址并吐出 html 的服务器端脚本（可能重定向回原始页面）。）

如果我天真地认为我可以为此从现成的东西中获取一些东西，并且应该从 AJAX 教程之类的东西开始，也请告诉我。我看过推荐的[这个 JQuery/AJAX 教程](http://www.developertutorials.com/tutorials/ajax/getting-started-with-ajax-in-jquery-8-05-11/page1.html)。这是启动和运行简单注册表单的最快方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T01:04:41.307

我刚刚在我的一个网站上实现了这样的东西，这很奇怪。不过，我没有存储电子邮件地址，而是通过电子邮件将它们发送给自己。我将注释掉，以便您可以编写平面文件或数据库存储位。

这是我的实现，使用[jQuery](http://jquery.com/)。偷走 ：）

**在 HTML 中：**

```
<script type="text/javascript">
    $(document).ready(function(){
    $('#btnSubmit').click(function(){
    $('#btnSubmit').disabled = true;
    var val = $('#emailAddress')[0].value;
    $('#emailResponse').html('<img src="ajax-loader.gif" border="0" />').css('backgroundColor', 'ffffd0');
    $.getJSON('notify.php',{email: val}, function(data){
        if (!data.result) {
            $('#emailResponse').html(data.message).css('backgroundColor','ff9999').effect('highlight', {color: '#ffff99'}, 1000);
        } else {
            $('#emailResponse').html(data.message).css('backgroundColor','99ff99').effect('highlight', {color: '#ffff99'}, 1000);
        }
        });
            $('#btnSubmit').disabled = false;
            return false;
    });
$('#emailAddress').keyup(function(e) {
    if(e.keyCode == 13) {
        $('#btnSubmit').click();
    }
    return false;
});
});

</script>

</head>
<body>
    <div style="margin:0 auto;background:#ffffd0;width:500px;padding:10px;text-align:center; font-family:Verdana,Arial,sans-serif; border:1px solid black;">
    If you would like to be notified when we launch, please leave your email address here.<br /><br />
    <input type="text" id="emailAddress" size="40" style="border:1px solid gray;padding:5px;"/>
    <input type="button" id="btnSubmit" value="Submit" style="padding:5px;" />
    <div style="padding:10px;margin:10px;" id="emailResponse"></div>
</div>
</body> 
```

**在 notify.php 文件中：**

```
<?php
$q = html_entity_decode($_GET["email"]);

$response = array();

if (!filter_var($q, FILTER_VALIDATE_EMAIL))
{
    $response['result'] = 0;
    $response['message'] = 'Invalid email given - try again';
}
else
{
    // write to file or database

    $response['result'] = 1;
    $response['message'] = "Thanks, your details have been added, we'll notify you when we launch!";
    }
}

echo json_encode($response);
?> 
```

**编辑：**我知道它不漂亮 - 内联样式、`<br/>`标签等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T01:05:42.087

这是一个将验证 99% 的电子邮件的正则表达式

```
/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i 
```

它看起来有点神秘，但它确实有效！正如[Damovisa](https://stackoverflow.com/users/77546/damovisa)`filter_var($email, FILTER_VALIDATE_EMAIL)`在评论中所说，使用PHP的功能更容易。

请注意，如果您在将电子邮件发送到 PHP 之前对其进行验证（以进行超快速验证），则需要使用正则表达式，因为 JavaScript 中没有内置函数可以为您执行此操作。

如果您确实使用 AJAX，您应该让它使用[JSON](http://json.org/)返回成功或错误报告。

[jQuery](http://jquery.com)库可以在使用 AJAX 时为您提供很多帮助，但了解它的工作原理仍然很重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T00:32:28.873

如果唯一的功能是让用户输入电子邮件地址，我认为没有理由打扰 AJAX。页面刷新不会破坏用户的工作流程。坚持使用普通的旧 CGI 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T00:34:12.347

我不认为你会找到类似“包括这个，一切都会神奇地工作”之类的东西，但你可以使用标准的 LAMP + jQuery 实现立即准备好它：

*   UI：使用正则表达式，您可以轻松验证电子邮件。谷歌，你会发现大量的脚本。
*   AJAX：jQuery AJAX 方法很棒，所以我推荐它。
*   使用 PHP 很容易获取您的 AJAX 参数并插入到数据库中。

# c# - C# AssemblyFileVersion 在程序中的使用

> ID：699580
> 
> 赞同：33
> 
> 时间：2009-03-31T00:30:30.970
> 
> 标签：c#, assemblyinfo

我正在开发一个程序，我正在尝试显示程序集*FILE*版本

```
 public static string Version
    {
        get
        {
            Assembly asm = Assembly.GetExecutingAssembly();
            FileVersionInfo fvi = FileVersionInfo.GetVersionInfo(asm.Location);
            return String.Format("{0}.{1}", fvi.FileMajorPart, fvi.FileMinorPart);
        }
    } 
```

目前，这只返回“AssemblyVersion”中的前两个版本号，而不是“AssemblyFileVersion”。我真的很想只引用 AssemblyFileVersion 而不是存储一个名为“Version”的内部变量，我必须同时更新这个和程序集版本......

```
[assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyFileVersion("3.5.0")] 
```

那是我来自 AssemblyInfo.cs 的 AssemblyFileVersion。我只想引用“3.5.x”部分，而不是“1.0.*”：/

谢谢，扎克

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-31T00:44:04.227

使用 ProductMajorPart/ProductMinorPart 而不是 FileMajorPart/FileMinorPart ：

```
 public static string Version
    {
        get
        {
            Assembly asm = Assembly.GetExecutingAssembly();
            FileVersionInfo fvi = FileVersionInfo.GetVersionInfo(asm.Location);
            return String.Format("{0}.{1}", fvi.ProductMajorPart, fvi.ProductMinorPart);
        }
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-07T10:46:41.990

```
using System.Reflection;
using System.IO;

FileVersionInfo fv = System.Diagnostics.FileVersionInfo.GetVersionInfo(Assembly.GetExecutingAssembly().Location);

Console.WriteLine("AssemblyVersion : {0}", Assembly.GetExecutingAssembly().GetName().Version.ToString());

Console.WriteLine ("AssemblyFileVersion : {0}" , fv.FileVersion.ToString ()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-23T04:55:20.153

```
 var fileVersion = GetCustomAttributeValue<AssemblyFileVersionAttribute>(assembly, "Version");

    private static string GetCustomAttributeValue<T>(Assembly assembly, string propertyName)
        where T : Attribute
    {
        if (assembly == null || string.IsNullOrEmpty(propertyName)) return string.Empty;

        object[] attributes = assembly.GetCustomAttributes(typeof(T), false);            
        if (attributes.Length == 0) return string.Empty;

        var attribute = attributes[0] as T;
        if (attribute == null) return string.Empty;

        var propertyInfo = attribute.GetType().GetProperty(propertyName);
        if (propertyInfo == null) return string.Empty;

        var value = propertyInfo.GetValue(attribute, null);
        return value.ToString();
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T00:45:28.030

要获取当前正在执行的程序集的版本，您可以使用：

```
using System.Reflection;
Version version = Assembly.GetExecutingAssembly().GetName().Version; 
```

Assembly 类还可以加载文件并访问进程中加载​​的所有程序集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T00:37:17.957

我想你将不得不使用 FileVersionInfo 类。

`System.Diagnostics.FileVersionInfo.GetVersionInfo(FullpathToAssembly)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-25T22:14:17.507

```
 protected void Application_Start(object sender, EventArgs e)
 {
     _log.InfoFormat("*************{0} **** Version: {1}************  ", Assembly.GetExecutingAssembly().GetName().Name, Assembly.GetExecutingAssembly().GetName().Version);
  } 
```

输出

> INFO Global - *************CustomerFile **** 版本：1.0.17.2510************

# apache-flex - 应该使用哪个版本的 flexmojos？

> ID：699585
> 
> 赞同：4
> 
> 时间：2009-03-31T00:32:44.503
> 
> 标签：apache-flex, maven-2, air, flexmojos

最近我将我的 Adob​​e AIR 项目重组为一个 maven 项目，这样我就可以连接到我的持续集成服务器。我发现让它工作的大部分信息都来自各种博客，这似乎是就 flex 东西而言的唯一途径。

但是，当我决定从哪个超级 pom 继承时，我发现有很多不同的人在使用不同的 flexmojos 超级 pom。

以下是我发现的一些（其中的每一个都被野外的一些例子使用）

*   [org.sonatype.flexmojos](http://repository.sonatype.org/content/groups/public/org/sonatype/flexmojos/flexmojos-air-super-pom/) *（这是我用的那个）*
*   [info.flex-mojos](http://repository.sonatype.org/content/groups/public/info/flex-mojos/air-super-pom/)
*   [信息.rvin.mojo](http://repository.sonatype.org/content/groups/public/info/rvin/mojo/air-super-pom/)

**各种超级 pom 有什么区别，哪个是事实上的标准？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T04:30:34.917

Velo 将 flexmojos 代码库移至 Sonatype，我们目前正在更新该站点。在站点准备就绪之前，您可以在 Sonatype Forge Wiki 上阅读有关 Flexmojos 的最新信息：[https ://docs.sonatype.org/display/FLEXMOJOS/Home](https://docs.sonatype.org/display/FLEXMOJOS/Home)

[在http://flexmojos.sonatype.org](http://flexmojos.sonatype.org)上有一个 flexmojos 站点

Maven: The Definitive Guide 中的 Flexmojos 章节仍在开发中，但如果您阅读它，您会注意到 Flexmojos 的先前版本与较新的 3.0 版本之间存在很大差异。也就是说，您可以依赖于 repository.sonatype.org 上托管的存储库来获取所有必需的 Flex 开源工件。

超级 POM 之间有什么区别？快速回答是即将发布的 3.1 版本（本周）将不再使用超级 POM 来添加所有插件信息。使用类型化的 Super POM 与大多数组织使用 Maven 的方式不兼容。通常在一个项目中有一个公司的 POM 或一个顶级的 POM。随着 Flexmojos 3.1 版本的发布，您将看到更多来自 flexmojos 原型的独立 POM，它们允许将 Flexmojos 项目集成到更大、更复杂的多模块 Maven 项目中。

# c# - 装配参考问题。

> ID：699589
> 
> 赞同：0
> 
> 时间：2009-03-31T00:34:05.873
> 
> 标签：c#, projects-and-solutions

尝试构建 winforms 解决方案时出现此错误：

*找到的程序集清单目标与程序集引用不匹配。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T00:36:56.833

也许你会发现这篇文章很有用：http: [//blogs.msdn.com/junfeng/archive/2004/03/25/95826.aspx](http://blogs.msdn.com/junfeng/archive/2004/03/25/95826.aspx)。

通常，这表明在执行/构建期间找到的程序集不是已添加到您的项目中的程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T03:23:04.643

检查您是否使用了正确版本/构建的程序集。

我发现了两个不同的参考 - 希望它有所帮助！（[一](http://www.dotnetnuke.com/Community/Forums/tabid/795/forumid/108/threadid/279257/scope/posts/Default.aspx)|[二](http://www.dotnetmonster.com/Uwe/Forum.aspx/dotnet-sdk/1183/app-use-newer-versions-of-a-DLL)）

# asp.net-mvc - MVC 视图 | *YOU* 如何处理 IsAuthenticated 场景？

> ID：699593
> 
> 赞同：4
> 
> 时间：2009-03-31T00:35:53.513
> 
> 标签：asp.net-mvc, views

通常，在允许会员资格的网站中，您希望为您的用户提供一些仅在他们登录时才可见的数据。

对于我的网站，如果登录用户是数据所有者，我想提供一些工具让他们管理数据。

我的问题是这个。您是否将这项职责分为两种不同的观点？为“普通”用户加载的一个视图，为“所有者”用户加载的另一个视图。普通用户看到的视图只是显示数据。所有者会看到数据和一些管理数据的工具。

或者，您是否在单个视图中执行检查并在其中隐藏/显示块（类似于您在常规 ASP.NET 中所做的）？

这可能是出于偏好，但是在两个视图和单个视图之间划分职责是否有任何技术原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T05:03:23.980

我也会选择单一视图选项。将在您的视图数据上提供特定属性以指示要做什么。

```
<% if (Model.IsOwner) { %>
    //Html for owner
<% } %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T04:26:24.910

我个人会选择单一视图选项。这样您就不必重复将出现在两个视图中的代码。

从技术上讲（或关于 MVC 模式）我想不出任何理由来拆分它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T10:28:42.157

我倾向于将视图拆分为多个视图，因为理想情况下您希望避免视图中的条件逻辑（阅读：理想情况下）。

如果您发现这会导致您的视图之间出现一些重复，那么您很可能可以将重复的内容移动到共享部分中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T07:41:57.427

我通常会在部分渲染额外的内容，在渲染之前在部分检查角色中使用条件逻辑：

```
<%-- Master Page --%>
<% Html.RenderPartial("DataOwnerStuff"); %>

<%-- Partial --%>
<% if(Roles.IsUserInRole("DataOwner")) { %>
    <h1>Hi Data Owner!</h1>
<% } %> 
```

# c# - 退出 C# 中的方法

> ID：699602
> 
> 赞同：2
> 
> 时间：2009-03-31T00:38:52.663
> 
> 标签：c#, methods

在 C++ 中，如果我想退出一个方法而不返回我能做的任何事情；

```
// A completely useless method
static public double function(int a){
  if(a==1){
     cout << "Error !";
     exit(1);
  }
  else
     return (double)a;       
} 
```

我怎样才能在 C# 中做同样的事情？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-31T00:52:59.293

在 .NET 中处理错误情况的常用方法是抛出异常：

```
public static double function(int a) {
   if (a == 1) {
      throw new ArgumentException("The value 1 is not accepted.");
   }
   return (double)a;       
} 
```

异常将被调用该方法的代码或某处捕获。由调用代码在适当的级别处理它。

以这种方式清理输入的方法很常见，这样任何错误的值都会被尽早发现，而不是在代码中导致更难追踪的错误。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-31T00:43:14.650

“退出”函数不仅退出方法 - 它终止程序。

[http://msdn.microsoft.com/en-us/library/k9dcesdd.aspx](http://msdn.microsoft.com/en-us/library/k9dcesdd.aspx)

在 C# 控制台应用程序中，您可以调用 System.Environment.Exit()。

但我建议任何这样做的代码都可以用更好的结构编写。例如，您的方法可能会抛出异常，并让调用者决定如何处理它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-31T00:44:22.307

您可以使用 return 语句退出方法而不返回任何内容。但是如果返回类型是除了 void 之外的任何东西，你将不得不返回一些东西。

如果由于错误而想退出方法，则应查看异常。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-31T00:41:08.167

[http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T00:43:49.987

尝试 return 退出方法而不退出整个程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T00:45:31.137

这肯定是一件奇怪的事情，但是是的 - 你可以调用 Environment.Exit。我*强烈*建议改为抛出异常。这使您有机会进行清理，您的调用者可以决定如何处理错误。如果没有人这样做，您仍然会降低该过程 - 但会更优雅一些。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T00:48:21.003

考虑到您想要做的事情的上下文，这应该是等价的：

```
public static double SomeFunction(int a)
{
    if(a==1)
    {
        throw new Exception("Error!");
    }
    else
    {
        return (double)a;
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T00:51:44.943

你没有。通过遵循您的方法，您必须在每次调用您的函数后进行测试，以检查是否确实返回了双精度数。

在您的示例中，您会执行类似...

```
public static double myFunc( int a ) {

   if( a==1 ){
       throw new InvalidArgumentException( "a must be greater than one." );
   }

   return (double)a;

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T01:23:52.680

考虑到所有先前答案的另一个选项，如果您正在使用 Windows 窗体，则调用

```
Application.Exit(); 
```

# c++ - 改变音量win32 c++

> ID：699603
> 
> 赞同：11
> 
> 时间：2009-03-31T00:38:55.643
> 
> 标签：c++, winapi, audio, volume

我将如何改变 c++ win32 中的音量？另外我将如何静音/取消静音？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-31T00:42:27.757

使用[`waveOutSetVolume`](http://msdn.microsoft.com/en-us/library/ms713762(VS.85).aspx)API。

这是一个例子：

```
 DWORD dwVolume;

  if (waveOutGetVolume(NULL, &dwVolume) == MMSYSERR_NOERROR)
    waveOutSetVolume(NULL, 0); // mute volume

  // later point in code, to unmute volume...
  waveOutSetVolume(NULL, dwVolume); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-04T07:17:30.267

waveOutSetVolume 和mixerSetControlDetails 仅在Windows Vista 及更高版本上更改应用程序的音量。

如果要更改 Vista 及更高版本的主音量，请搜索[IAudioEndpointVolume](http://msdn.microsoft.com/en-us/library/aa964574.aspx)接口。

[这是](http://blogs.msdn.com/larryosterman/archive/2007/03/06/how-do-i-change-the-master-volume-in-windows-vista.aspx)我几年前写的一篇博客文章。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T00:40:25.283

两种选择：

1.  SO上有[这个问题的答案（从C ++更改主卷，其中还包括SetMute等）](https://stackoverflow.com/questions/294292/changing-master-volume-level/294525#294525)

2.  您是否考虑过显示音量控件并让用户？如果是这样，我可以为此发布一些代码。（你基本上只是掏出音量控制小程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-19T17:33:59.337

如果您只想改变音量，那么您可以使用虚拟键码来改变音量，如下所示：

```
void changeVolume()
{
  INPUT ip={0};
  ip.type = INPUT_KEYBOARD;
  ip.ki.wVk = VK_VOLUME_UP;   //or VOLUME_DOWN or MUTE
  SendInput(1, &ip, sizeof(INPUT));
  ip.ki.dwFlags = KEYEVENTF_KEYUP;
  SendInput(1, &ip, sizeof(INPUT));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-20T17:46:38.870

切换静音的最简单方法是

```
const int APPCOMMAND_VOLUME_MUTE = 0x80000;
SendMessage(this.Handle, WM_APPCOMMAND, IntPtr.Zero, (IntPtr)APPCOMMAND_VOLUME_MUTE); 
```

以类似的方式，您可以触发 +Volume 和 -Volume 键行为。看看[http://www.blackwasp.co.uk/BasicVolumeControl.aspx](http://www.blackwasp.co.uk/BasicVolumeControl.aspx)和[http://msdn.microsoft.com/en-us/library/windows/desktop/ms646247%28v=vs.85%29。 aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646247%28v=vs.85%29.aspx)

麦克风音量控制等也有一些价值，但我没有尝试过。

如果您需要对系统主音量进行更多控制，则必须检查 Windows 版本并执行 2 个版本的代码：
类似于前面提到的为 Win XP[更改主音量级别](https://stackoverflow.com/questions/294292/changing-master-volume-level/294525#294525)。对于 Vista 及更高版本，
类似于[https://stackoverflow.com/a/3437069/1365066 。](https://stackoverflow.com/a/3437069/1365066)

# visual-studio-2008 - Visual Studio 一直关闭

> ID：699605
> 
> 赞同：16
> 
> 时间：2009-03-31T00:40:56.623
> 
> 标签：visual-studio-2008, crash

我的 Visual Studio 大约每天关闭一次。也不优雅，它只是从屏幕上消失，进程列表，一切。没有思考，没有警告，只是噗它消失了。

这种情况最常发生在 coderush 尝试做某事时，最近（最近几天）每当我尝试打开视图时都会发生这种情况。截至几个小时前，每次我在 MVC 项目中打开 Globals.asx.cs 时都会发生这种情况。

所以这不完全是一个编程问题，但这已经发生了一段时间，现在随着 ASP.NET MVC 的出现，它发生得越来越频繁。

我的事件日志中出现以下错误：.NET Runtime version 2.0.50727.3082 - Fatal Execution Engine Error (7A035FC0) (80131506)

我也有以下VS2008插件

*   Coderush/重构专业版！来自 DevExpress
*   ASP MVC
*   测试驱动的.NET
*   T4 工具箱
*   ASP.NET MVC
*   MbUnit/加里奥
*   源大纲
*   AnkhSVN（最近安装）
*   Oracle 开发人员工具

有没有人遇到过这个问题，或者甚至可以指导我到哪里寻求解决方案？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-31T00:59:25.627

这里有两种可能：

1.  [与 MVC 和插件相关的 Crash 修补程序](http://blogs.msdn.com/webdevtools/archive/2009/03/03/hotfix-available-for-asp-net-mvc-crashes-with-azure-power-commands-resharper.aspx)
2.  重新安装 SP1（我有一位一直崩溃的同事重新应用 SP 并解决了他的问题；在他的情况下，他在安装 SP1 后安装了 VS 数据库版）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T00:47:21.303

您可能需要慢慢剥离扩展。我怀疑的是：

1.  源大纲
2.  AnkhSVN
3.  Oracle 开发人员工具

没有其他原因，它听起来像是一个非托管扩展，会像那样践踏这个过程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T00:47:48.087

好吧，除了 VS 的标准故障排除技巧之外，我什么都没有：

*   检查您是否安装了 SP1（以及任何进一步的更新）
*   删除（重命名）解决方案中的所有临时文件，例如 .suo、.ncb、...
*   一个一个地禁用所有加载项，直到错误消失。由于您最近才安装了 AnkhSVN，这可能是一个很好的初步猜测......

[Sysinternals Suite](http://technet.microsoft.com/en-us/sysinternals/0e18b180-9b7a-4c49-8120-c47c5a693683.aspx)中的工具也有助于分析，我主要推荐您使用[DbgView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)和[ProcMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)。

您应该查看另一个类似的线程：[Fatal Execution Engine Error (79FFEE24) (80131506)](https://stackoverflow.com/questions/334706/fatal-execution-engine-error-79ffee24-80131506)

他们还提到了微软发布的一个修补程序：[https ://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0)

正如 Chris 发布的那样，此修补程序被[提及](http://blogs.msdn.com/webdevtools/archive/2009/03/03/hotfix-available-for-asp-net-mvc-crashes-with-azure-power-commands-resharper.aspx)用于解决 ASP.NET MVC 和 Resharper 的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T00:55:52.217

一个可能可行的疯狂想法：

打开 2 个 Visual Studio 实例。在一个实例上，您处理您的代码。另一方面，您可以打开一些随机解决方案，将其设置为调试，然后使用附加到进程将第一个 Visual Studio 实例附加到该解决方案。

希望当第一个实例发生*可能*导致其崩溃的异常时，第二个实例将提供有关问题所在的线索。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-22T12:05:09.650

在我的情况下，我不得不卸载 VMware 6.5，因为它导致了这个问题。奇怪的。

[http://communities.vmware.com/thread/170431](http://communities.vmware.com/thread/170431)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-03T09:59:31.627

我通过卸载 WSCF.blue 插件解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T02:25:55.403

我不得不删除 silverlight 调试程序集，但我不再遇到问题了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T19:46:19.480

对我来说，问题是 Gallio 3.0.6.763。卸载后，我可以再次在 VS2008 中加载项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-07T10:21:06.887

我有 ASP.Net MVC 和 Gallio 3.0.6.763。我删除了 Gallio，现在 Visual Studio 可以按预期工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-20T00:37:57.720

我遇到过同样的问题。删除 Gallio 也是我的解决方案。这似乎是 Gallio 和 ASP.NET MVC 项目之间的某种冲突。我只会在尝试打开 MVC 项目（特别是视图）时遇到问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-03T00:02:40.237

Ankh 加载项导致我的 Visual Studio 在编译期间静默崩溃。没有错误消息，整个 IDE 就从屏幕上消失了。

通过检查我的每个加载项并启用/禁用并重新尝试编译，我发现是 Ankh 导致了问题。完全禁用 Ankh 是一种有效的解决方法，您仍然可以使用 TortoiseSVN 手动更新和提交。

我还没有弄清楚问题的原因，但我相信它与缓存中的文件锁定有关。在重新启动 IDE 之前重新启动 ISS 并清除缓存（我使用的是 VS2003）往往会在大约 50% 的时间里解决问题。如果您绝对必须是 Ankh，则以下批处理脚本可能有用：

```
iisreset.exe
del /f /s /q "C:\Documents and Settings\(user)\VSWebCache\*"
rmdir /s /q "C:\Documents and Settings\(user)\VSWebCache"
del /f /s /q "C:\WINDOWS\Microsoft.NET\Framework\(version)\Temporary ASP.NET Files\*"
rmdir /s /q "C:\WINDOWS\Microsoft.NET\Framework\(version)\Temporary ASP.NET Files" 
```

只需将“（版本）”替换为您的框架版本，将“（用户）”替换为您的用户文件夹即可。
该脚本显然适用于 Windows XP，因此如果您使用 Vista 或更高版本，则需要对其进行修改。

# .net - 使用 Web 部署项目添加到内置的 ExcludeFromBuild ItemGroup

> ID：699610
> 
> 赞同：10
> 
> 时间：2009-03-31T00:42:57.490
> 
> 标签：.net, msbuild, web-deployment-project

我在我的解决方案中添加了一个 Web 部署项目，以创建我的 Web 应用程序的干净部署。这主要按预期工作......即构建源然后将要部署的文件复制到 /Release 文件夹（并排除源文件和我的 .svn 文件夹等内容）。

但现在我想明确排除一些其他文件（为了简单起见，我们只说一个名为 somefile.txt 的文件）。因此，我在 wdproj 文件中添加了一个项目组，如下所示：

```
<ItemGroup>
    <ExcludeFromBuild Include="somefile.txt" />
</ItemGroup> 
```

这确实会按要求排除特定文件，但现在不再排除默认排除的文件。具体来说，现在我所有的 svn 文件都在 Release 文件夹中，并且在同一级别还有一个 Source 文件夹，其中包含所有源。

基本上，似乎定义 ExcludeFromBuild 项目组是覆盖一些内置默认值，而不是添加到它们。

不完全是一个表演停止者，但并不理想......那么，有谁知道如何简单地将文件添加到默认的 ExcludeFromBuild 组？还是使用默认值 Vs. 手工排除一切。在默认构建后删除您不删除的文件？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-02T22:14:02.000

好吧，对于任何前来寻找的人，我想我应该回答我自己的问题......我没有找到我正在寻找的确切解决方案，所以我只是将我需要的所有内容手动添加到 ExcludeFromBuild ItemGroup 中（以模仿默认的选项似乎可以，然后也排除了我的特定文件）。我的 ExcludeFromBuild 列表最终看起来像这样：

```
<ItemGroup>
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\somefile.txt" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\obj\**\*.*" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\.svn\**\*.*" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\.svn\**\*" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.csproj" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.scc" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.user" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.vspscc" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.log" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.svclog" />
</ItemGroup> 
```

基本上排除了所有日志文件、用户/项目文件、svn 文件、源安全文件等以及我想首先忽略的自定义文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T22:05:33.830

我不确定这是否有帮助，但该命令具有 Exclude 属性，您可以覆盖复制文件的目标并用于包含/排除您需要的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-19T02:28:54.763

是的，我知道这已经过时了，但你试过吗？

```
<ItemGroup>
    <ExcludeFromBuild Include="somefile.txt;$(ExcludeFromBuild)" />
</ItemGroup> 
```

# jquery - 不能从同一个 AJAX TinyMCE 文本区域发布两次

> ID：699615
> 
> 赞同：5
> 
> 时间：2009-03-31T00:43:50.750
> 
> 标签：jquery, ajax, tinymce

我有一个可通过简单的 AJAX/jQuery 编辑按钮编辑的元素列表，效果很好。但是当我第二次尝试编辑同一个字段时，它不想打球。

1.  **编辑**- AJAX 返回一个 tinyMCE 文本区域，其中包含来自 MySQL 的内容
2.  **SAVE** - AJAX 将 tinyMCE 内容发布到 MySQL 并显示发布的内容
3.  **编辑（再次）** - 像往常一样返回相同的 tinyMCE 文本区域和内容
4.  **SAVE（再次）** - 第二次尝试保存，返回错误：*g.win.document 为 null*

*代码片段*

```
var content = tinyMCE.get('content').getContent(); //get tinyMCE content
$("#edititem").load("editItem.php", {content: content}); //jQuery post 
```

* * *

*解决方案*- 这就是我的工作方式：

**编辑**- 编辑时，将 tinyMCE 控件添加到 textarea

```
tinyMCE.execCommand("mceAddControl",true,'content'); 
```

**保存**- 保存时，下次删除控件

```
tinyMCE.execCommand('mceRemoveControl',false,'content'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-20T13:36:29.733

只是想我会添加一个与上述解决方案结合使用的解决方案：

```
setTimeout(function() {tinyMCE.execCommand("mceAddControl", true, "content");}, 5); 
```

无论出于何种原因，我不确定这是否是 DOM 操作的时间问题或其他原因，但微小的延迟会让生活变得更好。但是，它`setTimeout()`不能与使用 jQuery`.each()`方法结合使用，例如：

```
$("textarea").each(function(index) {
    tinyMCE.execCommand("mceAddControl", false, $(this).attr("id"));
}); 
```

那一定是一个完全不同的时间问题。

Anyhoo，我想我会分享这些发现，因为我相信其他人，甚至可能我再次会发现这篇文章很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-20T19:41:59.170

```
$(tinyMCE.editors).each(function(){
                            tinyMCE.remove(this);
                        }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T01:22:02.407

我对 FCKeditor 更熟悉，但我认为它是相似的。TinyMCE 有 mceAddControl 命令来添加/创建编辑器实例。您在重新加载内容后是否这样做？

```
tinyMCE.execCommand('mceAddControl' ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-26T10:15:11.057

对于 tinymce 3.2.x，使用以下命令在 IE8 或任何其他浏览器中删除 tinyMCE 实例。由于 tinymce.execCommand 函数使输入字段在 IE8 中不可编辑。

```
tinyMCE.remove(editor); //editor is instance of tinymce editor and not editor id 
```

这将修复“权限被拒绝”错误，而不会禁用同一页面中的其他输入字段。

# visual-studio - 如何增加工具提示在 Visual Studio 中保持可见的时间

> ID：699622
> 
> 赞同：12
> 
> 时间：2009-03-31T00:46:38.137
> 
> 标签：visual-studio, tooltip

默认情况下，Visual Studio 工具提示保持可见 10 秒，然后消失。我发现这段时间太短了，无法阅读一些较长的工具提示。有没有办法增加它们保持可见的时间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T17:28:29.453

我的理解是工具提示首选项是在系统显示级别控制的（即，作为 Windows 设置的一部分）。据我所知，仍然没有办法延长提示显示的时间。

我推荐[Shay Erlichmen](https://stackoverflow.com/a/700245/366904)使用打印屏幕捕捉提示的技巧。粘贴到绘画程序中，您可以阅读整个内容。然后关闭绘图程序而不保存。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T06:21:27.163

每当我遇到这样的问题时，我只需按下打印屏幕并阅读我[最喜欢的绘图程序](http://paint.net/)中的文本。

我从来不明白为什么工具提示超时不是基于内容的长度。

# sql-server - Microsoft Sync Framework with Sync Services for ADO.NET - 它是如何扩展的？

> ID：699625
> 
> 赞同：0
> 
> 时间：2009-03-31T00:48:10.990
> 
> 标签：sql-server

我们即将开始一个需要偶尔连接的应用程序的重大项目。

MS Sync Framework 似乎为 ADO.NET 的 Sync Services 提供了一个很好的解决方案。

有没有人在生产应用程序中使用过这个，最好有成千上万的用户，你能评论它的扩展性吗？还有其他陷阱或陷阱吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-06T22:55:16.407

试图在相当大的应用程序中使用，现在要让它工作有很多麻烦。尤其是像行过滤这样非常简单的事情。

我看到其他评论人们说它不是那么快。但我还是想试试。

# asp.net - 通过 jQuery ajax 绑定 GridView

> ID：699630
> 
> 赞同：1
> 
> 时间：2009-03-31T00:50:16.210
> 
> 标签：asp.net, jquery, ajax, gridview

我是 jQuery 新手，尝试使用 jQuery 填充 GridView 或 Telerik RadGrid。不知道如何去做，也找不到任何例子。任何帮助表示赞赏。谢谢。

本质上，我正在尝试显示带有文本框和按钮的模式窗口。用户输入搜索条件，按下按钮，同一模式窗口中的 gridview 将填充结果。

用户在网格中选择记录后按下另一个按钮，选定的用户被插入到数据库表中，模式窗口关闭，父页面上的网格被刷新，显示新添加的用户。

```
<input type="button" id="btnAddNewUserj" value="Add New User" />

$(document).ready(function() {
$("#btnAddNewUserj")
    .click(function() { ShowNewUserDialog(); return false });

$("#btnSearch")
    .click(function() { FindUsers(); return false });
});

function ShowNewUserDialog() {
    $("#newuserDialog").dialog({ modal: true, bgiframe: true }).dialog("open");
}

function FindUsers() {
  // HOW TO DO THIS?
  // Show selectable list of users from the database in grid.
}

<div id="newuserDialog" title="Add New User" style="display:none;">
<div>
<input id="txtSearchFor" type="text" />&nbsp;&nbsp;
<input id="btnSearch" type="button" value="Search" class="Button" /></div>
<p> DISPLAY RESULTS HERE </p>
<div style="margin:10px 6px;">
<input type="button" id="btnjAdd" value="Add" class="Button" />&nbsp;&nbsp;
<input type="button" id="btnjCancel" value="Cancel" class="Button" />   
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T01:57:59.697

这里有几个想法。您不能使用 jQuery 填充 GridView 或 Telerik Grid。jQuery 是一种客户端技术，而这两个网格是服务器端。

您可以使用 jQuery 访问 Web 服务并使用结果构建 HTML 表（这基本上是 GridView 所做的）。

然而，我猜想，仅使用本机 GridView 数据绑定会为您提供更好的服务。如果要防止完全回发，可以在网格周围使用 .Net UpdatePanel。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-02T08:01:01.827

我认为telerik不是答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T16:11:03.237

使用 Telerik radgrid 的客户端绑定，请参阅此示例：[http ://demos.telerik.com/aspnet-ajax/grid/examples/clientbinding/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/clientbinding/defaultcs.aspx)

请注意，该示例显示了如何绑定到 WCF Web 服务和 ADO.NET 数据服务。周围还有其他样品。

绑定的其他变体：http: [//demos.telerik.com/aspnet-ajax/grid/examples/client/declarativedatabinding/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/client/declarativedatabinding/defaultcs.aspx)

更多关于客户端绑定：[http ://demos.telerik.com/aspnet-ajax/grid/examples/client/databinding/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/client/databinding/defaultcs.aspx)

# asp.net - 在 asp:ListView 中使用 EmptyDataTemplate 插入记录

> ID：699634
> 
> 赞同：0
> 
> 时间：2009-03-31T00:51:22.370
> 
> 标签：asp.net, listview, asp.net-3.5, linqdatasource

我的 asp:ListView 中有一个 EmptyDataTemplate，我想用它来插入新记录。

我在 InsertItemTemplate 中插入工作...我想我可以将 InsertItemTemplate 复制到 EmptyDataTemplate 中，单击插入时会出现错误

```
Insert can only be called on an insert item. Ensure only the InsertTemplate has a button with CommandName=Insert. 
```

如何使用 EmptyDataTemplate 插入一行？我是否需要使用按钮的 OnClick 来访问 EmptyDataTemplate 中的值并自己进行插入？

我正在使用 LinqDataSource

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-01T10:16:32.693

您现在可能已经想通了，但是如果您将 InsertItemPosition 设置为 None 以外的任何值，则 EmptyData 模板将不会被呈现，即它将始终显示插入模板

你可以在这里阅读更多 [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.emptydatatemplate.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.emptydatatemplate.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-12T14:14:16.293

如果想在空数据模板中插入数据，就没有办法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-28T21:23:43.590

可以通过手工插入从 EmptyDataTemplate 进行插入。我正在使用列表视图来显示基于唯一过滤项的静态行数。我基本上列出了一个对象的所有静态属性。在过滤一个没有任何关联属性的新对象的情况下，我使用列表视图的 EmptyDataTemplate 来显示一个 HTMLTable，其中包含用于捕获数据的 asp.net 控件。我在使用 ListView_ItemCommand 评估的表中有一个命令按钮。如果 CommandName 与 EmptyDataItem 中的“Insert”按钮匹配，我使用 ListView.Controls(0).FindControl 方法来定位我的表。然后我遍历我的表并插入每行中找到的数据。我包括了如何在 htmltable 中找到控件。

```
Protected Sub ListView_ItemCommand(sender As Object, e As System.Web.UI.WebControls.ListViewCommandEventArgs) Handles ListView.ItemCommand

  Select Case e.CommandName
    Case "Submit"
      Dim edt As HtmlTable = ListView.Controls(0).FindControl("myhtmltable")
      Dim ddl As DropDownList = CType(edt.FindControl("mydropdownlist"), DropDownList)
      'Perform Insert
     Case "Some other commandname"
  End Select
End Sub 
```

您仍然需要进行错误检查和 databind() 并刷新您的列表视图。

这是最好的方法吗。也许不是……但这是可能的。

~伊恩

# c# - WCF 错误 - 找不到引用合同“UserService.UserService”的默认端点元素

> ID：699644
> 
> 赞同：98
> 
> 时间：2009-03-31T00:54:42.860
> 
> 标签：c#, .net, wcf

任何想法如何解决这一问题？

```
UserService.UserServiceClient userServiceClient = new UserServiceClient();
            userServiceClient.GetUsersCompleted += new EventHandler<GetUsersCompletedEventArgs>(userServiceClient_GetUsersCompleted);
            userServiceClient.GetUsersAsync(searchString); 
```

.

```
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="BasicHttpBinding_UserService" 
                     maxBufferSize="2147483647" 
                     maxReceivedMessageSize="2147483647">
                <security mode="None" />
            </binding>
        </basicHttpBinding>
    </bindings>
    <client>
        <endpoint address="http://localhost:52185/UserService.svc" 
                  binding="basicHttpBinding" 
                  bindingConfiguration="BasicHttpBinding_UserService" 
                  contract="UserService.UserService"
                  name="BasicHttpBinding_UserService" />
    </client>
    <behaviors>
        <serviceBehaviors>
            <behavior name="Shell.Silverlight.Web.Service3Behavior">
                <serviceMetadata httpGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
    <services>
        <service behaviorConfiguration="Shell.Silverlight.Web.Service3Behavior" 
                 name="Shell.Silverlight.Web.Service3">
            <endpoint address="" 
                      binding="basicHttpBinding" 
                      contract="Shell.Silverlight.Web.Service3" />
            <endpoint address="mex" 
                      binding="mexHttpBinding" 
                      contract="IMetadataExchange" />
        </service>
    </services>
</system.serviceModel> 
```

在 ServiceModel 客户端配置部分中找不到引用合同“UserService.UserService”的默认端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素。

**解决！**

我没有提到这是一个 Silverlight 应用程序。我在一个 DLL 中有 wcf 引用，它有自己的“ServiceReferences.ClientConfig”文件。我将 DLL 的 ServiceReferences.ClientConfig 的内容移动到了主 silverlight 项目，它工作了。

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2009-10-22T09:33:19.973

我遇到了同样的问题。我的应用程序也是一个 Silverlight 应用程序，并且该服务是从一个类库中调用的，该类库中使用了一个自定义 UserControl。

解决方案很简单。将端点定义从类库的配置文件（例如ServiceReferences.ClientConfig）复制到silverlight 应用程序的配置文件。我知道你会期望它不必这样做就可以工作，但显然雷德蒙德的某个人那天放假了。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-04-18T11:33:55.007

您还可以在类库中以编程方式设置这些值，这将避免配置文件在库中不必要的移动。简单 BasciHttpBinding 的示例代码是 -

```
BasicHttpBinding basicHttpbinding = new BasicHttpBinding(BasicHttpSecurityMode.None);
basicHttpbinding.Name = "BasicHttpBinding_YourName";
basicHttpbinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.None;
basicHttpbinding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.UserName;

EndpointAddress endpointAddress = new EndpointAddress("http://<Your machine>/Service1/Service1.svc");
Service1Client proxyClient = new Service1Client(basicHttpbinding,endpointAddress); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-08-06T08:49:40.943

以防万一有人在使用 WPF（而不是 WCF 或 Silverlight）时遇到同样的问题：

连接到 Web 服务时出现此错误。当我的代码在“主要”WPF 应用程序解决方案中时，没问题，它运行良好。但是当我将代码移到更明智的 DAL 层解决方案时，它会抛出异常。

> 在 ServiceModel 客户端配置部分中找不到引用合同“MyWebService.MyServiceSoap”的默认端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素。

正如该线程中的“Sprite”所述，您需要手动复制标签。

对于 WPF 应用程序，这意味着将标记从我的 DAL 解决方案中的*app.config*复制到主 WPF 应用程序解决方案中的*app.config 。*

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-07-01T17:58:41.990

我遇到了同样的问题，无论出于何种原因，我第一次添加服务时 Visual Studio 都没有更新 Web 配置。我发现更新服务参考也解决了这个问题。

脚步：

1.  导航到服务参考文件夹
2.  展开
3.  右键单击并选择更新服务参考
4.  观察 web Config 被更新

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-09T12:42:30.623

将 WCF 服务的 web.config 更改为 "endpoint address="" binding="basicHttpBinding"..." (之前的 binding="wsHttpBinding") 构建应用程序后，在 "ServiceReferences.ClientConfig" ""configuration> 中有值. 然后它会正常工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-29T06:39:44.750

将 svcutil.exe 生成的 output.config 重命名为 app.config。它对我有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-31T01:08:29.397

您是否有“UserService”类实现的接口。

您的端点应该为合约属性指定一个接口：

```
contract="UserService.IUserService" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-31T05:14:28.540

不确定这是否是一个问题。端点和绑定都具有相同的名称

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-31T05:17:32.353

不确定这是否真的有问题，但我看到您的绑定配置 () 具有相同的名称。

我通常尝试将我的端点称为“UserServiceBasicHttp”或类似的东西（“Binding”在这里真的没有任何事情要做），我尝试用“..Configuration”来调用我的绑定配置，例如“UserServiceDefaultBinding”，以避免任何潜在的名称冲突。

马克

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-12T11:47:50.817

当您通过其他应用程序使用您的服务时会出现此问题。如果应用程序有配置文件，只需将您的服务配置信息添加到此文件中。在我的情况下，没有任何配置文件，所以我使用了这种技术并且效果很好。只需将 url 地址存储在应用程序中，读取它并使用 BasicHttpBinding() 方法将其作为参数发送到服务应用程序。这是我如何做的简单演示它：

```
Configuration config = new Configuration(dataRowSet[0]["ServiceUrl"].ToString());

var remoteAddress = new System.ServiceModel.EndpointAddress(config.Url);

SimpleService.PayPointSoapClient client = 
    new SimpleService.PayPointSoapClient(new System.ServiceModel.BasicHttpBinding(), 
    remoteAddress);
SimpleService.AccountcredResponse response = client.AccountCred(request); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-26T14:34:26.120

必须在调用 App.config 文件中添加服务才能使其正常工作。确保你不过如此。这似乎对我有用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-05-10T05:58:54.783

对于那些使用**AX 2012 AIF**服务并尝试在 AX (x++) 中调用**C#**或 VB 项目并遭受**“找不到默认端点”** ...或**“未找到合同”**等错误的人...返回到您的 Visual Studio (C#) 项目并在定义服务客户端之前添加这些行，然后部署项目并重新启动 AX 客户端并重试：注意，该示例适用于**NetTcp 适配器**，您可以根据需要轻松使用任何其他适配器.

```
 Uri Address = new Uri("net.tcp://your-server:Port>/DynamicsAx/Services/your-port-name");
 NetTcpBinding Binding = new NetTcpBinding();
 EndpointAddress EndPointAddr = new EndpointAddress(Address);
 SalesOrderServiceClient Client = new SalesOrderServiceClient(Binding, EndPointAddr); 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2012-08-29T20:54:50.113

如果您使用 PRISM 框架使用 WPF 应用程序，那么配置应该存在于您的启动项目中（即在您的引导程序所在的项目中。）

简而言之，只需将其从类库中删除并放入启动项目中即可。

# entity-framework - 实体框架：重新查找最近添加到上下文中的对象

> ID：699648
> 
> 赞同：50
> 
> 时间：2009-03-31T00:58:01.090
> 
> 标签：entity-framework

我正在使用实体框架，但在“重新查找”我刚刚创建的对象时遇到问题......基本上它是这样的：

```
string theId = "someId";

private void Test()
{
  using(MyEntities entities = new MyEntities())
  {
    EntityObject o = new EntityObject();
    o.Id = theId;
    entities.AddToEntityObject(o);
    CallSomeOtherMethod(entities);
  }
}

void CallSomeOtherMethod(MyEntities ents)
{
  EntityObject search = ents.EntityObject.FirstOrDefault(o => o.Id == theId);
  if(search == null) 
  {
    Console.WriteLine("wha happened???");
  }
} 
```

（不保证代码可以正常工作——这都是我的想法）

为什么查询没有“找到”刚刚创建的 EntityObject？

如果我在 AddToEntityObject 之后调用 SaveChanges() 它可以工作（这并不让我感到惊讶）但是为什么它不能正确地从缓存中提取？

我仍然对这些东西很陌生，所以我希望有一些我只是忽略的非常简单的事情......

谢谢

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-06-27T12:42:20.817

新添加的对象在本地 DataSource 中，因为它还没有保存在数据库中，

所以你可能会说：

```
EntityObject search = ents.EntityObject.FirstOrDefault(o => o.Id == theId) ??
                      ents.EntityObject.Local.FirstOrDefault(o => o.Id == theId); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-31T01:28:33.433

这是因为 ents.EntityObject.WhatEver 总是查询数据源。这是一个设计决定。他们这样做，因为否则他们将不得不对数据源、本地缓存执行查询，然后合并结果。正如其中一位开发人员在博客中指出的那样（不记得确切的位置），他们无法始终如一地处理这个问题。

正如您可以想象的那样，您必须正确处理很多角落和边缘情况。您可以在数据库中找到您在本地创建的、由其他人创建的 id。这将迫使您准备好处理（几乎）每个查询的冲突。也许他们可以制定查询本地缓存的方法和查询数据源的方法，但这也不明智。

您可以查看[针对实体框架的透明延迟加载](http://code.msdn.microsoft.com/EFLazyLoading)。这取代了正常的代码生成器，并且您获得在访问时自动填充其相关实体集合和实体引用的实体。这避免了所有

```
if (!Entity.ReleatedEntities.IsLoaded)
{
   Entity.RelatedEntities.Load();
} 
```

代码片段。您可以查询这些集合，因为它们总是被隐式加载。但是这个解决方案也不是完美的。有一些问题。例如，如果您创建一个新实体并访问相关实体的集合，您将收到异常，因为代码无法从数据库中检索相关实体。还有一个关于数据绑定的问题，可能还有一些我不知道的问题。

好消息是您获得了源代码并且能够自己解决问题，如果我有时间我会检查第一个问题。但我很确定它不会那么容易修复，因为如果刚刚创建的实体不是预期的行为，我预计某些情况只是没有命中数据库。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-11-30T09:52:10.917

我也有同样的情况。我写了这个扩展方法，至少对我来说解决了这个问题（我没有问题，即我的上下文中的冲突......）

```
 public static IEnumerable<T> WhereInclAdded<T>(this ObjectSet<T> set, Expression<Func<T, bool>> predicate)  where T : class
    {
        var dbResult = set.Where(predicate);

        var offlineResult = set.Context.ObjectStateManager.GetObjectStateEntries(EntityState.Added).Select(entry => entry.Entity).OfType<T>().Where(predicate.Compile());

        return offlineResult.Union(dbResult);
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-07-12T15:09:38.377

下面的扩展方法是 DbSet<>

```
public static T TryAttach<T>(this DbSet<T> dbSet, T entity, Expression<Func<T, bool>> predicate) where T : class
{
     T found = dbSet.Local.SingleOrDefault(predicate.Compile());
     if (found == null) dbSet.Attach(entity);
     return found ?? entity;
} 
```

如何使用：

```
contextInstance.MyEntity.TryAttach(entityInstance, e => e.ID == entityInstance.ID); 
```

顺便说一句：我喜欢仿制药！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-03T17:01:42.893

我最近一直在为同样的问题而苦苦挣扎。在提出问题两年后，我发布了这个答案，希望这段代码可以帮助人们寻找答案。

我基本上实现了一个名为“Find”的扩展方法（如 Alex James 所建议的），它的操作方式与“Where”相同，但“Find”还检查 ObjectContext 以查看是否有任何满足给定的添加实体谓词。这允许您找到一个实体，即使它尚未保存到数据库中。

Find 返回一个 IQueryable(of T)，以便您可以像使用任何其他 LINQ 运算符一样使用它。

```
<Extension()>
Public Function Find(Of T As Class)(ByVal OSet As ObjectSet(Of T), _
       ByVal predicate As Expression(Of Func(Of T, Boolean))) _
       As System.Linq.IQueryable(Of T)

    'Check the object context for Added objects first.
    Dim AddedContextObjects = OSet.Context.ObjectStateManager _
                        .GetObjectStateEntries(EntityState.Added) _
                        .Select(Function(entity) entity.Entity).OfType(Of T)()

    Dim Cpredicate = predicate.Compile
    Dim MatchingObjects As New List(Of T)

    For Each TObj As T In AddedContextObjects
        If Cpredicate.Invoke(TObj) Then
            MatchingObjects.Add(TObj)
        End If
    Next

    'Now include a query to retrieve objects from the DB.
    Dim DBObjects = OSet.Where(predicate)

    If MatchingObjects.Count > 0 Then
        'We found some added objects in the context.
        'We want to return these objects as well as any Objects in DB
        'that satisfy the predicate.
        Return MatchingObjects.Union(DBObjects).AsQueryable
    Else
        'We didn't find any added objects in the context,
        'so we just return the DB query.
        Return DBObjects
    End If

End Function 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T06:55:20.587

你有很多选择。您可以`ObjectContext`使用另一个部分类扩展 ，以创建自己的机制来检索最近添加的信息。

或者您可以将扩展方法放在`ObjectContext`通过`ObjectContext.ObjectStateManager`查找“已添加”`ObjectStateEntries`进行查找的对象上，然后使用 LINQ to Objects 查找您要查找的内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-18T01:41:16.463

**实体框架 6**

根据[EF Docs](https://docs.microsoft.com/en-us/ef/ef6/querying/) Dbset 始终查询数据库。

> 请注意，DbSet 和 IDbSet 始终会针对数据库创建查询，并且始终会涉及到数据库的往返行程，即使返回的实体已经存在于上下文中也是如此。在以下情况下对数据库执行查询：
> 
> 它由 foreach (C#) 或 For Each (Visual Basic) 语句枚举。它由集合操作枚举，例如 ToArray、ToDictionary 或 ToList。LINQ 运算符（如 First 或 Any）在查询的最外层部分指定。调用以下方法：DbSet、DbEntityEntry.Reload 和 Database.ExecuteSqlCommand 上的 Load 扩展方法。当从数据库返回结果时，上下文中不存在的对象将附加到上下文中。如果对象已经在上下文中，则返回现有对象（条目中对象属性的当前值和原始值不会被数据库值覆盖）。
> 
> 执行查询时，已添加到上下文但尚未保存到数据库的实体不会作为结果集的一部分返回。要获取上下文中的数据，请参阅[本地数据](https://docs.microsoft.com/en-us/ef/ef6/querying/local-data)
> 
> 如果查询没有从数据库返回任何行，则结果将是一个空集合，而不是 null。

**下面是一个包含本地数据的简单片段：**

```
await dbContext.Entity
      .Where(e => e.Title.Contains("Text"))
      .LoadAsync();

var locaEntities = dbContext.Entity.Local;

dbContext.Entity.Add(new Entity {});

// call save post atomic operation is finished.
await dbContext.SaveChangesAsync(); 
```

# python - 命令行python程序的浏览器界面

> ID：699649
> 
> 赞同：0
> 
> 时间：2009-03-31T00:58:18.047
> 
> 标签：python, firefox, sqlite, webkit

我有一个我用 Python 编写的命令行工具，它连接到 SQLite 数据库（每个用户一个 DB）。该程序向用户呈现大量数据，这在终端中可能很麻烦。

一种选择是提供 wxPython 接口，但另一种想法是利用 Firefox 或 Webkit 来提供接口。

有人做过这样的事情吗？或者其他任何非常简单的方法来添加图形界面来操作 python 程序中的大量数据？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T01:08:15.527

django[自动管理界面](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#ref-contrib-admin)（您可以使用旧版 DB 和 sqlite）或[databrowse](http://docs.djangoproject.com/en/dev/ref/contrib/databrowse/#ref-contrib-databrowse)应用程序值得考虑作为简单、（几乎）无编码的 Web 界面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T01:58:29.557

您还可以查看 Qt 的模型/视图框架。获取 SQL 结果集并将其映射到表视图等中是微不足道的......

[http://doc.trolltech.com/4.5/sql-tablemodel.html](http://doc.trolltech.com/4.5/sql-tablemodel.html)

这也适用于 PyQt4。

# api - RSS 源或 API 来访问 REIT 信息？

> ID：699652
> 
> 赞同：1
> 
> 时间：2009-03-31T01:00:13.813
> 
> 标签：api, finance

我有一个 Web 应用程序，需要显示有关 REITs 和股票代码的最新信息，如 AX.UN、BEI.UN、CAR.UN 等。

例如，我需要自动使用 [http://ca.finance.yahoo.com/q?s=AX-UN.TO等页面上的信息](http://ca.finance.yahoo.com/q?s=AX-UN.TO)

是否有我可以用来导入此类数据的 rss 提要或 api？我不想每天都将这些信息复制并粘贴到我的网站中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T01:09:30.657

在您链接到的网站上，有一个小链接，上面写着“下载数据”。如果您有一个包含要跟踪的符号的数据库，那么动态构建该下载 URL、查询它、解析 CSV 并将该数据加载到您的数据库中以显示在您的网站上将非常容易。

**预计**到达时间：这是链接：

[http://ca.finance.yahoo.com/d/quotes.csv?s=AX-UN.TO&f=sl1d1t1c1ohgv&e=.csv](http://ca.finance.yahoo.com/d/quotes.csv?s=AX-UN.TO&f=sl1d1t1c1ohgv&e=.csv)

只需让您的程序用您想要的任何符号替换“AX-UN.TO”，它就应该获取该符号的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-18T23:19:17.780

看看[http://www.mergent.com/servius](http://www.mergent.com/servius) - 特别是历史证券数据 API。不确定它是否有房地产投资信托基金数据——如果没有，可以通过他们的特殊安排获得。

# css - 为什么我的文字在 IE7 中被截断？

> ID：699653
> 
> 赞同：8
> 
> 时间：2009-03-31T01:00:20.117
> 
> 标签：css, internet-explorer-7

我网页上的文本在 Firefox 和 Safari 中看起来不错，但在 IE7 中某些部分被截断。*看起来*（但没有）它已被放置在一个较小的元素中，带有`overflow: hidden;`.

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-31T01:01:37.430

您需要指定行高以匹配字体大小...

### CSS

```
h1 {
   font-size: 2em;
   line-height: 2em; /* or 100% */
} 
```

另请参阅[IE7 正在剪切我的文本。如何调整它的态度？](https://stackoverflow.com/questions/634824/ie7-is-clipping-my-text-how-do-i-adjust-its-attitude)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-08T01:27:09.617

我在 IE9 上遇到了同样的问题，并且花了很多时间摆弄“height”、“line-height”和“padding”的属性。这是我想出的：

(a) “高度”不影响文本框内发生的事情；

(b) "line-height" 确实会影响文本的显示，并会导致它在文本框中更高或更低，但数字很重要。最后，第一个答案似乎是正确的，即将“line-height”设置为与您的字体大小相同的数字；

(c) "填充"也影响文本的显示，因为它会在文本框的边框和文本本身之间产生空间；

(d) "vertical-align" 为文本框内的文本提供参考点。

因此，作为示例，我通过使用以下与“input=text " 我的 CSS 样式表的区域：

```
 line-height: 14px; padding: 6px 2px 6px 2px; vertical-align: middle; 
```

14px 是我的模板中使用的字体大小（在 CSS 样式表中的其他地方有说明），6px 分别是顶部和底部填充，2px 分别是左右填充。垂直对齐属性在文本中放置一条假想的中间线。显然，您可以更改任何这些数字以满足您的要求。

顺便说一句，对于新手来说，使用 firefox“firebug”插件在 CSS 样式表中查找需要更改的代码。只需突出显示有问题的文本框，它就会在右侧给出 CSS 样式表的名称，其位置和代码出现的行号。您甚至可以使用“firebug”进行实时测试运行，它会向您显示更改的效果，但在您关闭浏览器时不会保存：）

希望这可以帮助。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-31T05:59:25.420

尝试更改文本所在元素的溢出属性。

```
Overflow: auto; 
```

或者

```
Overflow: Visible; 
```

# asp.net - .Net 更改元素 ID

> ID：699677
> 
> 赞同：3
> 
> 时间：2009-03-31T01:14:07.337
> 
> 标签：asp.net

.Net 通过向它们附加 ct100_ 来更改我页面上的元素 ID。尽管我很感谢微软试图帮助我避免在我的网站上复制 id，但我认为我可以自己管理它。谁能告诉我如何防止这种情况？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T01:18:07.407

这就是 aspnet 的工作原理。出于这个原因，控件提供了 clientid 方法供您在后面的代码中使用。

如果要从 js 中引用对象，可以注入 clientid 或使用类或其他属性。

* * *

**编辑：**请注意，这仅适用于 ASP.NET 控件。如果您使用 HTML 控件，则会保留给定的 ID。`runat=server`您也可以通过向它们添加属性来在您的代码中访问它们。显然，这些控件通过视图状态等破坏了 webforms 模型，但它们确实为您提供了您想要的功能。

当然，我已经有一段时间没有担心它了，所以我可能是错的......（如果我是，请发表评论或编辑！）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T01:17:21.963

您无法在当前版本的 ASP.NET 中阻止这一点 -[下一版本将允许您这样做](http://www.asp.net/learn/whitepapers/aspnet40/#_Toc223325481)。也许[ASP.NET MVC](http://www.hanselman.com/blog/ASPNETMVCPreview2ScreencastTutorials.aspx)对您来说是一个不错的选择？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T01:19:51.413

任何具有 INamingContainer 接口的控件都将获得附加的控件层次结构，以允许多个控件位于页面上而不会发生冲突。如果您想知道元素的 id 将在客户端上是什么，您应该使用控件的 ClientID 属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T01:18:22.553

不要在服务器端使用任何东西。

这是 ASP.NET 系统的固有方面，没有附加前缀的情况下无法使用 .NET Server 控件。

要访问客户端名称，您可以使用 myControl.ClientID 属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T01:20:03.953

您将需要：
覆盖常规控件的行为以将 Control.UniqueID 属性与 Control.ID 属性分离
覆盖命名容器控件以允许我们控制如何完成 ID 生成以及如何查找控件

参考资料：
[http ://nunogomes.net/post/2008/06/02/ASPNET-Controls-Improving-automatic-ID-generation-Architectural-Changes-(-Part-3).aspx](http://nunogomes.net/post/2008/06/02/ASPNET-Controls-Improving-automatic-ID-generation-Architectural-Changes-(-Part-3).aspx)

[http://weblogs.asp.net/nunogomes/archive/2008/06/04/asp-net-controls-improving-automatic-id-generation-architectural-changes-part-3.aspx](http://weblogs.asp.net/nunogomes/archive/2008/06/04/asp-net-controls-improving-automatic-id-generation-architectural-changes-part-3.aspx)

[http://forums.asp.net/t/1394822.aspx](http://forums.asp.net/t/1394822.aspx)

# datetime - 经典 ASP 的相对日期/时间

> ID：699686
> 
> 赞同：1
> 
> 时间：2009-03-31T01:19:22.990
> 
> 标签：datetime, asp-classic, vbscript

对于VBScript中的经典ASP函数，是否有人从现在到自然/人类的相对日期/时间？这就像推特。

例子：

*   不到 1 分钟前
*   大约 5 分钟前
*   大约一小时前
*   大约 3 小时前
*   昨天
*   周三
*   等等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T09:33:59.517

这是我使用的那个。可以肯定的是，我只是从 Jeff 用于该站点的示例中摘录了它。

是的，是的，我做到了：[如何计算 C# 中的相对时间？](https://stackoverflow.com/questions/11/how-can-i-calculate-relative-time-in-c "如何计算 C# 中的相对时间？")

```
Function RelativeTime(dt)
    Dim t_SECOND : t_SECOND = 1
    Dim t_MINUTE : t_MINUTE = 60 * t_SECOND
    Dim t_HOUR : t_HOUR = 60 * t_MINUTE
    Dim t_DAY : t_DAY = 24 * t_HOUR
    Dim t_MONTH : t_MONTH = 30 * t_DAY

    Dim delta : delta = DateDiff("s", dt, Now)

    Dim strTime : strTime = ""
    If (delta < 1 * t_MINUTE) Then
        If delta = 0 Then
            strTime = "just now"
        ElseIf delta = 1 Then
            strTime = "one second ago"
        Else
            strTime = delta & " seconds ago"
        End If
    ElseIf (delta < 2 * t_MINUTE) Then
      strTime = "a minute ago"
    ElseIf (delta < 50 * t_MINUTE) Then
      strTime = Max(Round(delta / t_MINUTE), 2) & " minutes ago"
    ElseIf (delta < 90 * t_MINUTE) Then
      strTime = "an hour ago"
    ElseIf (delta < 24 * t_HOUR) Then
      strTime = Round(delta / t_HOUR) & " hours ago"
    ElseIf (delta < 48 * t_HOUR) Then
      strTime = "yesterday"
    ElseIf (delta < 30 * t_DAY) Then
     strTime = Round(delta / t_DAY) & " days ago"
    ElseIf (delta < 12 * t_MONTH) Then
        Dim months
        months = Round(delta / t_MONTH)
        If months <= 1 Then
            strTime = "one month ago"
        Else
            strTime = months & " months ago"
        End If
    Else
        Dim years : years = Round((delta / t_DAY) / 365)
        If years <= 1 Then
            strTime = "one year ago"
        Else
            strTime = years & " years ago"
        End If
    End If
    RelativeTime = strTime
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T03:51:17.607

取自[ajaxed](http://www.ajaxed.org)

```
'here comes some global helpers...
public function sayDate(dat, mode, relativNotation)
    if not isDate(dat) then
        sayDate = "unknown"
        exit function
    end if
    if relativNotation then
        diff = dateDiff("s", dat, now())
        if diff <= 10 and diff >= 0 then
            sayDate = "Just now" : exit function
        elseif diff < 60 and diff >= 0 then
            sayDate = diff & " seconds ago" : exit function
        elseif diff = 60 and diff >= 0 then
            sayDate = diff & " minute ago" : exit function
        elseif diff <= 1800 and diff >= 0 then
            sayDate = int(diff / 60) & " minutes ago" : exit function
        elseif diff < 86400 and diff >= 0 then
            sayDate = plural(int(diff / 60 / 60), "hour", empty) & " ago"
        else
            if datevalue(dat) = date() then
                sayDate = "Today"
            elseif dateValue(dat) = dateAdd("d", 1, date()) then
                sayDate = "Tomorrow"
            elseif dateValue(dat) = dateAdd("d", -1, date()) then
                sayDate = "Yesterday"
            end if
        end if
    end if
    if relativNotation and lCase(mode) = "datetime" and isEmpty(sayDate) then
        diff = dateDiff("d", dat, now())
        sayDate = plural(diff, "day", empty) & " ago"
        exit function
    end if

    if isEmpty(sayDate) then
        sayDate = day(dat) & ". " & monthname(month(dat), true)
        if year(dat) <> year(now()) then sayDate = sayDate & " " & year(dat)
    end if

    if lCase(mode) <> "datetime" then exit function
    if uBound(split(dat, " ")) <= 0 then exit function
    'sayDate = sayDate & ", " & str.padLeft(hour(dat), 2, "0") & ":" & str.padLeft(minute(dat), 2, "0")
end function

public function plural(val, singularform, pluralform)
    plural = singularform
    if val <> 1 then plural = pluralform
    if isEmpty(plural) then plural = singularform & "s"
    plural = val & " " & plural
end function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-28T10:28:05.843

我这样编写自己的函数，可以在[http://asp.web.id/asp-classic-relative-date-function.html找到](http://asp.web.id/asp-classic-relative-date-function.html "asp相对日期")

它用于将 asp 日期转换为 unixtimestamp 格式并计算时间间隔。它是可定制的，您还可以使用此功能为即将到来的日期创建相对日期。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-31T05:24:13.900

```
 DateAdd("n", -1, Now)
DateAdd("n", -5, Now)
DateAdd("h", -1, Now)
DateAdd("h", -3, Now)
DateAdd("d", -1, Date)
DateAdd("d", -1, Date) 

```

不确定你所说的星期三部分是什么意思。
你能详细说明吗？

# asp.net - 经典 ASP：将 PDF 文件的内容发布到 .NET 页面

> ID：699687
> 
> 赞同：0
> 
> 时间：2009-03-31T01:19:30.447
> 
> 标签：asp.net, asp-classic, form-post

所以问题是一半的应用程序是用经典的 asp 编写的，一半是用 asp.net 编写的。有一个由经典的 asp 代码生成的 PDF 文件（在内存中），我需要与 .NET 一半共享。我想将 PDF 保存到 FS 或 DB，我很确定你们中的大多数人不会推荐，因为它需要经历一个非常缓慢的保存到 IO 的过程，然后我需要手动清理之后——不必要地造成更多的瓶颈和故障点。

我想通过使用 Server.Transfer 或 Microsoft.XMLHTTP 对象来模仿从经典 asp 页面到 .NET 的帖子，但两者都不完全适合这种情况，因为我确实希望客户端上的 URL 指向 .NET aspx页。那么有没有一种简单的方法来制作从经典 ASP 到嵌入 PDF 文件的 .NET 页面的 POST？

提前感谢您的任何意见或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T03:00:44.130

有点骇人听闻，但是...

使用您使用 PDF 文件中的数据填充的字段在经典 ASP 中创建一个表单。表单的操作将是 ASP.NET 页面。就像是：

```
<body onload="pdfsenderform.submit()">
    <form name="pdfsenderform" action="pdf.aspx" method="post">
       <input type="hidden" name="pdffiledata" value="<%...output your PDF data here...%>" />
   </form>
</body> 
```

在将二进制 PDF 数据写入表单字段（Base64 或其他内容）之前，您可能需要对其进行编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T02:01:13.810

考虑到 ASP.NET 和 ASP 交互的困难，你最好的选择可能是 FS 或 DB。那是我的“阻力最小的道路”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T03:37:14.947

只需将其写入磁盘，将文件名存储在 cookie 或查询字符串中，然后 Response.Redirect 用户。它可能“足够快”并且比编写一个可通过 TCP 访问的最小公分母状态服务器要容易得多——这是我能想到的唯一的内存方式。

# ocaml - SML 和 OCaml 有什么区别？

> ID：699689
> 
> 赞同：103
> 
> 时间：2009-03-31T01:19:53.283
> 
> 标签：ocaml, sml, ml

是什么让这两种 ML 方言区分开来？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-03-31T02:00:24.217

有很多差异，有些是技术上的，有些是社会政治上的。我试图把更重要的区别放在首位。

*   SML 是一种具有定义和标准的语言。它是稳定的（实际上已被冻结，因此无法进化）。Objective Caml 是由 INRIA 的一个小组控制的实现。它继续发展。（IMO 进化管理得很好。）

*   SML 有很多实现；Caml只有一个。

*   Objective Caml 有许多额外的特性，其中最突出的可能是对象和多态变体。

*   这两种语言具有截然不同的记录类型模型。简而言之，在Caml中，记录字段的名称必须是唯一的，而在SML中，同一范围内的两种不同的记录类型可能具有相同的字段名称。这个怪癖会使从 SML 移植到 Caml 有点棘手。

*   有很多语法差异。

*   库和标准函数有很大的不同。Caml 库非常必要，而 SML 标准基础库功能更强大。例如，函数组合是 SML 中的顶级原语；它不是 Caml 库的一部分。Caml 字符串库不提供折叠功能（至少从 3.08 版开始不提供）。许多 Caml`List`函数的实现对于很长的列表是不安全的；他们炸毁了堆栈。

*   类型系统略有不同：在 Caml 中，如果类型与 的类型一致，`e : ty`则接受`ty` *表达式*`e`上的类型注释。在 SML 中，`e : ty`仅当类型`ty`是 的类型的实例*时才*`e`被接受。这种区别使 Caml 中的注释在实践中的用处大大降低，因为不可能使用类型注释来坚持表达式是多态的。

*   与 SML 相比，Caml 在接口（称为*模块类型*或*签名*）和（具体）实现（称为*模块*或*结构*）之间具有更加理智和合理的关系。在 SML 中，几乎任何事情都会发生，您必须依靠程序员来建立良好的约定。在 Caml 中，良好的约定由编译器建立和执行。

*   在 SML 中，算术运算符被重载以适用于浮点和整数数据。在 Caml 中，运算符没有重载；浮点运算符用一个额外的点表示。

*   在 SML 中，程序员可以控制中缀运算符的优先级和关联性。在 Caml 中，这些是由操作员姓名的第一个字符决定的。此限制限制了能够定义自己的中缀表示法的好处。

如需更详细的分析以及编辑评论，您还可以查看[Adam Chlipala 的比较页面](http://adam.chlipala.net/mlcomp/)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-03-31T01:35:33.417

OCaml 添加了面向对象的特性并且有一些小的语法差异。

# asp.net-mvc - 如何一起使用 Expression Web 2 和 Visual Studio asp.net mvc？

> ID：699692
> 
> 赞同：2
> 
> 时间：2009-03-31T01:21:18.787
> 
> 标签：asp.net-mvc

只是想知道将它合并到 asp.net mvc 项目中以便可以使用表达式 web 完成设计的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T23:46:18.223

微软已经公开表示他们计划在未来将 ASP.NET MVC 整合到 Expression Web 中。

# svn - 如何将代码分支到另一个 SVN 存储库？

> ID：699697
> 
> 赞同：4
> 
> 时间：2009-03-31T01:24:24.380
> 
> 标签：svn, version-control, repository, branch

我们有两个存储库，一个用于当前代码，一个用于项目管理。

现在我们需要将代码分支到项目管理存储库。

SVN 给我一个错误，我在文档中发现 SVN 无法完成这项工作（不同的存储库），

所以我导出代码并签入到项目存储库。

问题：

*   如何将代码分支到另一个存储库？
*   就我而言，如何将更改从项目存储库移回当前存储库？（我还没有测试它，但我认为差异或补丁可能会起作用）

PS：我知道有一种主干/分支方式，但我们使用两个存储库。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T01:53:43.843

如果我说得对，您想将已经在版本控制下的内容从存储库添加到另一个存储库？如果是这样，您可能应该看看[svnsync](http://svnbook.red-bean.com/en/1.4/svn.ref.svnsync.html)，它可以帮助您合并不同的存储库。

否则，保留两个存储库并添加[外部](http://svnbook.red-bean.com/en/1.4/svn.advanced.externals.html)定义（链接）以使它们共存可能会更简单。这样你就不必费心去破坏任何东西了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T01:57:55.143

TortoiseSVN 提供了“在此处复制和添加这些文件”功能，但从 SVN 1.5.5 开始，不支持此功能。我还没有用 1.6.0 测试过

将您的文件从 repo A 右拖动（不是普通的左拖动）到 repo B 中的目录并释放鼠标。将出现一个菜单，询问您要做什么。我认为有 4 个选项可供选择（除了正常的操作系统选项）。选择最合适的一种。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T21:30:09.660

官方的 svn-book 引用了一个脚本，您可以使用它来简化此过程，称为`svn_load_dirs.pl`. 看看[在线手册](http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html#svn.advanced.vendorbr.svn_load_dirs)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T01:38:22.117

如果，责任，你的意思是存储库（thanx，Blair），你发现你不能分支到另一个存储库。但是如果你的代码和你的项目是相关的，那么将它们放在同一个存储库中是有意义的。你会想了解更多关于 svn 并更好地使用它。例如，“trunk”只是一个目录名称，因此您可以为项目使用一个，而为代码使用一个单独的名称。尽管使用这些特定的词，我们大多数人都希望“代码”在“项目”中。

无论如何，如果您离开存储库，您将丢失所有历史记录，并且您将失去所有分支或合并的机会。因此，您需要重新考虑您的组织。或者使用其他版本控制系统来满足您的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-04T11:01:49.200

@andrew-edgecombe 已经（间接）提到的“供应商分支”似乎是可能的。这个概念似乎在以后的 SVN 版本中得到了一些更新，因为[1.8 版文档](https://svnbook.red-bean.com/en/1.8/svn.advanced.vendorbr.html)已经使用纯 SVN 命令提到了这个过程 - 使用以下命令制作远程存储库的副本（一个分支）：

`svn copy http://remote_v1 local`

并稍后通过 2-URL 合并合并新更新：

`svn merge http://remote_v1 http://remote_v2 local`

我会说相同的 2-URL 合并也可以用于将本地更改合并回原始存储库。有关更多详细信息，请参阅链接文档中的“来自外部存储库的供应商分支”一章。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-31T01:39:34.593

您应该将所有代码放在一个存储库中。

它可能看起来像这样：

```
name/trunk/src
name/branches/dev/src 
```

或者，用你用的话说：

```
name/current-code/src
name/project/src 
```

然后，您可以轻松地`svn merge`来回。

# java - 软件专利涵盖的操作系统项目的一个分支会发生什么情况？

> ID：699707
> 
> 赞同：1
> 
> 时间：2009-03-31T01:30:19.763
> 
> 标签：java, gpl, jvm-hotspot

我正在查看[Lars Bak 的专利](http://www.google.com/patents?id=MtAYAAAAEBAJ&dq=Lars+Bak)，当我意识到其中很多都涵盖了 Sun JVM、HotSpot 等组件时。现在 Sun 的部分堆栈是在 FLOSS 许可下发布的，这对分叉或使用这个开源软件的分支？他们没有侵犯 Sun 的专利吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T01:34:18.087

不，因为 Sun 也授予专利许可。我不知道细节，但我可以告诉你（作为一个拥有 Sun 专利并经历过开源流程的人），要通过法律障碍并不容易。但这是可以完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-26T02:55:16.007

Lars Bak 告诉（至少）V8 Javascript VM 可以在没有专利要求的情况下使用（他在 2009 年苏黎世联邦理工学院的一次谈话后的个人交流）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-30T12:26:10.647

正如您在 Oracle 针对 Android 中的 Dalvik-VM 提起的诉讼中看到的那样，这些专利可用于对抗作为开源发布的替代 Java 实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T01:54:39.987

从技术上讲，您将侵犯他们的专利，但 Martin 先生对其余部分的看法是正确的。Sun 将/应该向使用开源软件的人授予相应专利的许可。

在这些情况下，Sun 基本上选择不执行其专利权。

# html - 可变顺序正则表达式语法

> ID：699708
> 
> 赞同：6
> 
> 时间：2009-03-31T01:32:19.510
> 
> 标签：html, regex, html-parsing

有没有办法表明两个或多个正则表达式可以以任何顺序出现？例如，XML 属性可以按任何顺序编写。假设我有以下 XML：

```
<a href="home.php" class="link" title="Home">Home</a>
<a href="home.php" title="Home" class="link">Home</a> 
```

我将如何编写一个检查类和标题并适用于这两种情况的匹配项？我主要是在寻找允许我以任何顺序检查的语法，而不仅仅是匹配类和标题，因为我可以做到这一点。除了包含两个组合并用“|”连接它们之外，还有什么办法吗？

**编辑**：我的偏好是在单个正则表达式中执行它，因为我正在以编程方式构建它并对其进行单元测试。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T01:40:41.220

不，我相信使用单个 RE 的最佳方法正是您所描述的。不幸的是，当你的 XML 可以有 5 个不同的属性时，它会变得非常混乱，给你*大量*不同的 RE 来检查。

另一方面，我根本不会用 RE 来做这件事，因为它们不是编程语言。使用 XML 处理库的老式方法有什么问题？

如果您*需要*使用 RE，这个答案可能不会有太大帮助，但我相信使用正确的工具来完成这项工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T13:44:25.287

你考虑过xpath吗？（属性顺序无关紧要）

```
//a[@class and @title] 
```

将选择两个`<a>`节点作为有效匹配。唯一需要注意的是输入必须是 xhtml（格式良好的 xml）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-31T06:22:36.880

您可以为每个属性创建一个前瞻，并将它们插入到整个标签的正则表达式中。例如，标签的正则表达式可以是

```
<a\b[^<>]*> 
```

如果您在 XML 上使用它，您可能需要更详细的内容。就其本身而言，此基本正则表达式将匹配具有零个或多个属性的标签。然后为要匹配的每个属性添加一个外观：

```
(?=[^<>]*\s+class="link")
(?=[^<>]*\s+title="Home") 
```

允许它`[^<>]*`向前扫描属性，但不会让它超出右尖括号。在前瞻中匹配前导空格有两个目的：它比在基本正则表达式中匹配它更灵活，并且它确保我们匹配整个属性名称。结合它们，我们得到：

```
<a\b(?=[^<>]*\s+class="link")(?=[^<>]*\s+title="Home")[^<>]+>[^<>]+</a> 
```

当然，为了清楚起见，我做了一些简化的假设。我不允许在等号周围使用空格，不允许在属性值周围使用单引号或不使用引号，或者在属性值中使用尖括号（我听说这是合法的，但我从未见过这样做）。堵住这些漏洞（如果需要的话）会使正则表达式变得更丑陋，但不需要更改基本结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T01:48:04.947

您可以使用命名组将属性从标签中提取出来。运行正则表达式，然后循环执行您需要的任何测试的组。

像这样的东西（未经测试，使用 .net 正则表达式语法， \w 表示单词字符， \s 表示空格）：

```
<a ((?<key>\w+)\s?=\s?['"](?<value>\w+)['"])+ /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T01:35:49.267

最简单的方法是编写一个提取`<a .... >`部分的正则表达式，然后再编写两个正则表达式来提取类和标题。尽管您可以使用单个正则表达式来完成它，但它会非常复杂，并且可能更容易出错。

使用单个正则表达式，您将需要类似

```
<a[^>]*((class="([^"]*)")|(title="([^"]*)"))?((title="([^"]*)")|(class="([^"]*)"))?[^>]*> 
```

这只是第一手猜测，没有检查它是否有效。分而治之要容易得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T01:38:33.847

第一个临时解决方案可能是执行以下操作。

```
((class|title)="[^"]*?" *)+ 
```

这远非完美，因为它允许每个属性多次出现。我可以想象这可以通过断言来解决。但是，如果您只想提取属性，这可能已经足够了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T02:35:39.903

如果你想匹配一组元素的排列，你可以使用反向引用和零宽度负前向匹配的组合。

假设您要匹配以下六行中的任何一行：

```
123-abc-456-def-789-ghi-0AB
123-abc-456-ghi-789-def-0AB
123-def-456-abc-789-ghi-0AB
123-def-456-ghi-789-abc-0AB
123-ghi-456-abc-789-def-0AB
123-ghi-456-def-789-abc-0AB 
```

您可以使用以下正则表达式执行此操作：

```
/123-(abc|def|ghi)-456-(?!\1)(abc|def|ghi)-789-(?!\1|\2)(abc|def|ghi)-0AB/ 
```

后向引用 ( `\1`, `\2`) 让您引用之前的匹配项，零宽度前向匹配 ( `(?!...)`) 让您否定位置匹配，表示如果包含在该位置匹配，则不匹配。将两者结合可确保您的匹配是给定元素的合法排列，每种可能性仅出现一次。

因此，例如，在 ruby​​ 中：

```
input = <<LINES
123-abc-456-abc-789-abc-0AB
123-abc-456-abc-789-def-0AB
123-abc-456-abc-789-ghi-0AB
123-abc-456-def-789-abc-0AB
123-abc-456-def-789-def-0AB
123-abc-456-def-789-ghi-0AB
123-abc-456-ghi-789-abc-0AB
123-abc-456-ghi-789-def-0AB
123-abc-456-ghi-789-ghi-0AB
123-def-456-abc-789-abc-0AB
123-def-456-abc-789-def-0AB
123-def-456-abc-789-ghi-0AB
123-def-456-def-789-abc-0AB
123-def-456-def-789-def-0AB
123-def-456-def-789-ghi-0AB
123-def-456-ghi-789-abc-0AB
123-def-456-ghi-789-def-0AB
123-def-456-ghi-789-ghi-0AB
123-ghi-456-abc-789-abc-0AB
123-ghi-456-abc-789-def-0AB
123-ghi-456-abc-789-ghi-0AB
123-ghi-456-def-789-abc-0AB
123-ghi-456-def-789-def-0AB
123-ghi-456-def-789-ghi-0AB
123-ghi-456-ghi-789-abc-0AB
123-ghi-456-ghi-789-def-0AB
123-ghi-456-ghi-789-ghi-0AB
LINES

# outputs only the permutations
puts input.grep(/123-(abc|def|ghi)-456-(?!\1)(abc|def|ghi)-789-(?!\1|\2)(abc|def|ghi)-0AB/) 
```

对于五个元素的排列，它将是：

```
/1-(abc|def|ghi|jkl|mno)-
 2-(?!\1)(abc|def|ghi|jkl|mno)-
 3-(?!\1|\2)(abc|def|ghi|jkl|mno)-
 4-(?!\1|\2|\3)(abc|def|ghi|jkl|mno)-
 5-(?!\1|\2|\3|\4)(abc|def|ghi|jkl|mno)-6/x 
```

对于您的示例，正​​则表达式将是

```
/<a href="home.php" (class="link"|title="Home") (?!\1)(class="link"|title="Home")>Home<\/a>/ 
```

# fluent-nhibernate - 这个 Fluent NHibernate 配置有什么问题？

> ID：699709
> 
> 赞同：2
> 
> 时间：2009-03-31T01:33:40.053
> 
> 标签：fluent-nhibernate

以下设置有什么问题？AutoPersistanceModel 上的 Where 过滤器似乎不起作用，表名称约定似乎也不起作用。我最终得到的错误是“命名空间'urn：nhibernate-mapping-2.2'中的元素'class'在命名空间'urn：nhibernate-mapping-2.2'中具有无效的子元素'property'。预期可能的元素列表：命名空间‘urn:nhibernate-mapping-2.2’中的‘meta，jcs-cache，cache，id，composite-id’。” 这是我的代码：

```
 public ISessionFactory BuildSessionFactory()
    {
        return Fluently.Configure()
            .Database(
                OracleConfiguration.Oracle9.ConnectionString(
                c => c.FromConnectionStringWithKey("ConnectionString")))
            .Mappings(m =>
                          {
                              m.AutoMappings.Add(GetAutoPersistanceModel);
                              m.FluentMappings.AddFromAssembly(Assembly.GetExecutingAssembly());
                          })
            .BuildSessionFactory();
    }

    public AutoPersistenceModel GetAutoPersistanceModel()
    {
        return AutoPersistenceModel.MapEntitiesFromAssemblyOf<User>()
            .Where(type => type.IsClass && !type.IsAbstract && type.Namespace == "Some.Namespace")
            .ConventionDiscovery.Add<IConvention>(
                Table.Is(x => "tbl" + x.EntityType.Name.Pluralize())
            );
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T09:10:58.800

例外是说 NHibernate 首先遇到了一个`<property />`元素，这是无效的。NHibernate hbm 文件中的第一个元素应该（几乎）始终是一个 Id，因此似乎`AutoPersistenceModel`没有找到您的标识符。

您的 ID 在您的实体中是如何命名的？`AutoPersistenceModel`期望它们按字面意思称为**Id**，如果它们有任何不同，则不会找到它们。

您可以使用`FindIdentity`配置选项来覆盖`AutoPersistenceModel`查找 ID 的方式，如果您无法修改实体，这将很有用。

```
// if your Id is EntityId
.WithSetup(s =>
  s.FindIdentity = property => property.DeclaredType.Name + "Id"
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T01:14:25.177

詹姆斯正确地引导你，但他的片段是错误的。

```
.WithSetup(s=> s.FindIdentity = p => p.Name == "ID")); 
```

是你所追求的！将“ID”替换为您的实际财产。

# asp.net - 为什么这个错误经常发生“asp.net, sql server”？

> ID：699716
> 
> 赞同：2
> 
> 时间：2009-03-31T01:37:22.523
> 
> 标签：asp.net, sql-server, networking

我的站点上多次出现此错误：
*“在建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。找不到服务器或无法访问服务器。验证实例名称是否正确且SQL Server 配置为允许远程连接。（提供程序：TCP 提供程序，错误：0 - 由于系统缺少足够的缓冲区空间或队列已满，无法对套接字执行操作。）“*

我的站点文件位于服务器和数据库在另一台服务器上，但在同一网络上。
任何人都知道可能导致此问题的原因以及如何解决？
注意：
- 当我重新启动网站服务器时，问题解决并且一切正常。
- 确定我的 sql 服务器允许来自该网站服务器的远程连接

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T01:50:11.760

当应用程序无法访问数据库时，这是一个非常普遍的错误。也许您在使用它们后将连接保持打开状态？用户或服务器的并发连接数量可能存在限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T01:55:15.070

这是某种网络错误，或者您指定的实例名称不正确。我最近看到了这两种情况。在一种情况下，我将连接字符串从一个系统移动到另一个安装了不同实例名称的系统。在另一种情况下，我有一台在虚拟机中运行的服务器——在机器从暂停状态恢复大约十分钟后，机器将失去其 DHCP 租约（因此失去其连接性）。

它几乎可以是任何东西，你必须去找出来，也许通过使用像[Microsoft Network Monitor 3.2](http://www.microsoft.com/downloads/details.aspx?FamilyID=f4db40af-1e08-4a21-a26b-ec2f4dc4190d&DisplayLang=en)这样的网络监视器程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T13:25:30.233

# iphone - 界面生成器添加了一个标签栏按钮，但未显示

> ID：699729
> 
> 赞同：0
> 
> 时间：2009-03-31T01:44:56.703
> 
> 标签：iphone, cocoa-touch

我在界面生成器中替换了一个标签栏按钮。它是“最近”按钮，我将其更改为“联系人”按钮。现在标签栏按钮没有显示，但我可以单击该位置，并且操作确实有效。不过，相邻未更改的标签栏没有问题。

我找不到任何地方来设置标签栏按钮的可见性。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T02:06:07.073

当您将其更改为“联系人”按钮时，请确保从苹果提供的标签栏按钮的下拉列表中选择“联系人”选项 - 如果您输入“联系人”作为已选为最近的栏按钮的标题 - 这将导致问题，并可能导致您遇到的问题。

# objective-c - 如何为 Cocoa 应用程序计时？

> ID：699730
> 
> 赞同：3
> 
> 时间：2009-03-31T01:45:43.767
> 
> 标签：objective-c, cocoa, cocoa-touch, time

什么是对 Cocoa 应用程序计时的简单方法？（或者，任何衡量性能的好方法就足够了）。

（我有两个不同的框架，想比较它们在一些固定输入数据上的表现）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-31T02:28:55.583

Instruments 会为您保留时钟，尽管您可能会发现框架的差异在您启动应用程序处理数据的速度范围内。

您可以使用 Shark 和 CHUD 框架来做得更好。该框架允许您以编程方式启动和停止分析；你将从工作开始到工作结束，然后有一个漂亮的 Shark 文档来展示它。Shark 手册有更多细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-05T08:38:55.203

```
NSDate *startDate = [NSDate date];
// ...
NSDate *stopDate = [NSDate date];

NSLog(@"-- time: %f", [stopDate timeIntervalSinceDate:startDate]); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-31T02:03:43.333

您可以使用 NSTimer 类计算可可应用程序的时间。程序运行时启动计时器，并在所有程序逻辑完成后结束。

# asp.net - 为什么 PreSendRequestHeaders 和 PreSendRequestContent 运行不一致？

> ID：699737
> 
> 赞同：3
> 
> 时间：2009-03-31T01:48:37.427
> 
> 标签：asp.net, events, httpmodule, pipeline, httpapplication

在使用 HTTP 模块时，是否有人注意到管道中的最后两个事件——PreSendRequestHeaders 和 PreSendRequestContent——并不总是运行？

我已经验证绑定到 EndRequest 的代码会运行，但不会在绑定到 PreSendRequestHeaders 或 PreSendRequestContent 时运行。

有什么原因吗？我认为这可能是一个缓存问题（使用 304 Not Modified，您实际上并没有发送内容......），但我已经清除了缓存并确定服务器正在返回 200 OK，这表明它发送了内容.

这是一个问题，因为响应的 StatusCode 默认为 200，我的理解是，在这两种最终方法之前，它不会更新为 404 或 206 之类的东西。如果我在 EndRequest 期间检查 StatusCode，它将始终显示为 200。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-05T18:50:30.363

这不是与 IIS 7 集成管道有关吗？

有待验证，但我认为这些事件仅在 IIS 7 在集成管道中运行时才会触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-14T13:55:49.513

也许它与 HttpResponse.BufferOutput 有关。如果关闭了缓冲，那么在这些事件触发时，似乎所有的标头和一些内容都已经发送了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T22:19:38.563

我在**PreSendRequestHeaders**事件上注入了一个 cookie 标头，但还没有遇到它没有触发的问题...

# sql - 为解决 SQL Server 性能问题而运行的第一个 SQL 命令是什么？

> ID：699741
> 
> 赞同：6
> 
> 时间：2009-03-31T01:51:39.977
> 
> 标签：sql, sql-server

当 SQL Server (2000/2005/2008) 运行缓慢时，您运行以查看问题所在的第一个命令是什么？

这个问题的目的是，在编译所有答案后，其他用户可以通过运行您选择的命令来隔离问题可能所在的位置。还有其他`troubleshooting`关于 SQL Server 性能的帖子，但它们仅对特定情况有用。

如果您推出并运行自己的自定义 SQL 脚本，
那么您会让其他人知道什么

*   脚本的**目的**是
*   它返回（返回值）
*   找出问题出在哪里

如果您可以提供脚本的来源，请发布。

就我而言，

```
sp_lock 
```

我跑去弄清楚是否有任何锁（目的）来返回 SQL 服务器锁信息。由于结果集显示对象 ID（因此人类不那么可读），我通常会浏览结果以查看是否有异常多的锁。

随时更新标签

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T08:02:28.840

当一张图片值一千字时，为什么要运行单个查询！

我更喜欢运行免费提供的[Performance Dashboard Reports](http://www.microsoft.com/downloads/details.aspx?FamilyId=1d3a4a0d-7e0c-4730-8204-e419218c1efc&displaylang=en)。

它们可在几秒钟内提供服务器性能的完整快照概览。然后，您只需单击仪表板上的相应区域即可选择要调查的特定区域（锁定、当前运行的查询、等待请求等）。

[http://www.microsoft.com/downloads/details.aspx?FamilyId=1d3a4a0d-7e0c-4730-8204-e419218c1efc&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=1d3a4a0d-7e0c-4730-8204-e419218c1efc&displaylang=en)

一个小小的警告，我相信这些仅在 SQL 2005 及更高版本中可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T01:59:46.357

```
sp_who 
```

[http://msdn.microsoft.com/en-us/library/aa260384(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa260384(SQL.80).aspx)

我想查看“谁”、哪些机器/用户正在运行哪些查询、时间长度等。我还可以轻松扫描块。

如果有东西阻塞了一堆其他事务，我可以在必要时使用 spid 发出 kill 命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T03:41:36.097

[sp_who_3](http://vyaskn.tripod.com/sp_who3.htm) - 提供了很多其他地方可用的信息，但在一个很好的输出中。还有几个参数允许自定义输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T22:27:54.687

Ian Stirk 有一个很棒的脚本，我喜欢使用本文中的详细说明：http: [//msdn2.microsoft.com/en-ca/magazine/cc135978.aspx](http://msdn2.microsoft.com/en-ca/magazine/cc135978.aspx)

特别是，我喜欢缺少的索引之一：

```
SELECT 
    DatabaseName = DB_NAME(database_id)
    ,[Number Indexes Missing] = count(*) 
FROM sys.dm_db_missing_index_details
GROUP BY DB_NAME(database_id)
ORDER BY 2 DESC; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T22:37:47.720

[DBCC OPENTRAN](http://msdn.microsoft.com/en-us/library/ms182792.aspx)查看最早的活动事务是什么

> 显示有关指定数据库中最旧的活动事务以及最旧的分布式和非分布式复制事务（如果有）的信息。仅当存在活动事务或数据库包含复制信息时才会显示结果。如果没有活动事务，则会显示一条信息性消息。

其次是[sp_who2](http://www.devx.com/tips/Tip/14208)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T04:12:46.863

一个自定义查询，它将您在 sp_who 中所期望的内容与 DBCC INPUTBUFFER(spid) 相结合，以获取每个 spid 上由阻塞/阻塞图排序的最后一个查询文本。

流程数据可通过 master..sysprocesses 获得。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T04:14:14.287

sp_who3 返回标准和 sp_who2 输出，直到您指定特定的 spid，然后给出 6 个关于该 spid 的不同记录集，包括锁、块、它当前正在执行的操作、它正在运行的 T/SQL 以及当前正在运行的 T/SQL 中的语句.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T02:10:09.700

我使用这样的查询：
[ms sql server 2005 中的打开/活动连接数](http://igurr.com/blogs/programming/archive/2009/03/22/total-number-of-open-active-connections-in-ms-sql-server-2005.aspx)

# asp.net - ASP.Net 会话值不变

> ID：699742
> 
> 赞同：1
> 
> 时间：2009-03-31T01:53:32.080
> 
> 标签：asp.net, session

我有 2 页。

.#1 页面： session("X") 从用户输入（文本框）接收值，重定向到#2 页面。

.#2 页面：向用户显示 session("X") 的值，如果用户想要更改该值，则重定向回 #1 页面进行编辑。

.#1 page: session("X") 加载到原始文本框中供用户更改。文本框中的值再次放入会话（“X”）中。重定向到#2 页面。

.#2 page: session("X") 保持不变。怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T02:09:44.333

关于会话变量和重定向，有一个很好的帖子：

看看[这个帖子](http://weblogs.asp.net/bleroy/archive/2004/08/03/Don_2700_t-redirect-after-setting-a-Session-variable-_2800_or-do-it-right_2900_.aspx)。

> “设置会话变量后不要重定向（或做对）”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T02:01:41.157

人们忘记在他们的页面加载中进行“IsPostBack”检查是很常见的。如果您忘记了，您很可能在调用 Button 处理程序之前将Textbox 设置*回PageLoad 中的原始会话值。*也就是说，您可能会在将用户刚刚输入的值*存储*到会话中之前将其覆盖。当我得到这样的奇怪行为时，十分之九是因为我忘记检查 IsPostBack！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T03:29:58.777

看起来你没有包装你的*.#1 页面： session("X") 加载到原始文本框中供用户更改。*在 !IsPostBack 因此，在单击按钮更改值后，页面正在“重新加载”并且原始值被放回文本框中。（所以它变成了自己）

尝试调试按钮单击。

# input - 如何从 Xbox 360 控制器获取输入？

> ID：699745
> 
> 赞同：14
> 
> 时间：2009-03-31T01:55:05.290
> 
> 标签：input, xna, directx, xbox360

我正在编写一个需要从 Xbox 360 控制器获取输入的程序。然后输入将被无线发送到我正在建造的 RC 直升机。

到目前为止，我了解到这可以使用 DirectX 中的 XInput 库或 XNA 中的输入框架来完成。

我想知道是否还有其他可用的选项。我的程序的范围相当小，而且必须安装像 DirectX 或 XNA 这样的大型游戏库似乎有些过分。此外，我希望该程序是跨平台的，而不是特定于 Microsoft 的。

有没有一种简单的轻量级方法可以用 Python 之类的东西来获取控制器输入？

**编辑以回答一些评论：**

直升机总共有 6 个螺旋桨，排列成 3 个同轴对。基本上，它将与[此](http://www.draganfly.com/uav-helicopter/draganflyer-x6/features)非常相似，只是它的成本约为 1,000 美元，而不是 15,000 美元。它将使用 Arduino 进行板载处理，使用 Zigbee 进行无线控制。

选择360控制器是因为它设计得很好。它非常符合人体工程学，并具有所需的所有控制输入。对于那些熟悉直升机控制的人来说，左操纵杆将控制集体，右操纵杆控制俯仰和滚动，模拟触发器将控制偏航。模拟触发器是 360 控制器的一大特色。PS和大多数其他人都没有。

我有一个该项目的网页，但它仍然很稀疏。我确实计划记录整个设计，所以最终它会很有趣。
[http://tricopter.googlecode.com](http://tricopter.googlecode.com)
顺便说一句，为 googlecode 项目提供博客功能会扼杀谷歌吗？

如果可能的话，我希望 360 控制器输入程序能够在 Linux 和 Windows 中运行。不过最终，我想将控制器直接连接到嵌入式微控制器板（如 Arduino），这样我就不必通过计算机，但目前它不是一个高优先级。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-03-13T21:32:06.683

这并不是那么困难。正如前面的人提到的，您可以使用 SDL 库来读取 xbox 控制器的状态，然后您可以用它做任何您想做的事情。

有一个 SDL 教程：[http](http://sdl.beuc.net/sdl.wiki/Handling_Joysticks) ://sdl.beuc.net/sdl.wiki/Handling_Joysticks非常有用。

请注意，Xbox 控制器具有以下功能：

*   两个操纵杆：
    *   左操纵杆是轴 0 和 1；
    *   左触发器是轴 2；
    *   右操纵杆是轴 3 和 4；
    *   右触发器是轴 5
*   一顶帽子（方向键）
*   11 个 SDL 按钮
    *   其中两个是操纵杆中心压力机
*   两个触发器（作为轴，见上文）

即将推出的 SDL v1.3 也将支持力反馈（又名触觉）。

我想，由于这个帖子已经有好几年了，你已经做了一些事情，所以这篇文章主要是为了通知未来的访问者。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-31T02:16:35.800

[PyGame](http://www.pygame.org/news.html)可以读取操纵杆，这就是 X360 控制器在 PC 上的显示方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T02:36:21.820

好吧，如果你真的不想添加对 DirectX 的依赖，你可以在平台 SDK 中使用旧的 Windows Joystick API -- Windows Multimedia -> Joystick Reference。

标准的免费跨平台游戏库是 Simple DirectMedia Layer，最初是为了将 Windows 游戏移植到 Unix (Linux) 系统而编写的。它是一个非常基本的轻量级 API，倾向于支持每个系统上功能的最小子集，并且它具有大多数主要语言的绑定。它具有非常基本的操纵杆和游戏手柄支持（例如，没有力反馈），但它可能足以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T13:48:43.157

也许 Mono.Xna 库添加了 GamePad 支持，这将提供您正在寻找的跨平台功能：
[http ://code.google.com/p/monoxna/](http://code.google.com/p/monoxna/)

至于对库过于沉重的担忧，当然，对于这个选项，它可能是真的……但是，它可能会为将来做一些漂亮的可视化提供机会。

*免责声明：我不熟悉mono xna项目的状态，所以它可能还没有添加这个功能。但是，这是一个选择:-)*

# asp.net - asp.net someusercontrol_ascx 在多个地方定义错误

> ID：699768
> 
> 赞同：0
> 
> 时间：2009-03-31T02:09:15.333
> 
> 标签：asp.net, compiler-construction

我在使用 asp.net 时遇到了这个间歇性问题。我的网站是动态编译的。有时当我修改用户控件时，我的网站抱怨它在多个地方定义。似乎旧控件没有从 asp.net 临时文件中删除，更新后的控件编译到同一目录，因此它在多个位置定义。这对我来说很有意义，除了我无法控制 Temporary ASP.net Files 文件夹中的内容。

我读过循环引用会导致这种情况。我已经确定我没有循环引用。即使是我见过的最简单的网站也会发生这种情况。

我注意到在使用母版页时，这个错误似乎更频繁地出现。

我读过一个修补程序试图解决这个问题，但在应用修补程序后我得到了这个错误。

如果我得到导致问题的文件并对其进行编辑，那么错误就会消失。即使我只是在文件中放一个空格，它也会解决错误。

我有时也可以通过访问可能不使用用户控件并点击刷新的站点的其他页面来解决错误。这并不总是有效。

如果我将站点设置为调试，则永远不会发生错误。如果我将其设置为逐页显示，则错误不会发生太多，但仍然会发生。

下面是错误的样子。

编译错误描述：在编译服务此请求所需的资源期间发生错误。请查看以下特定错误详细信息并适当修改您的源代码。

编译器错误消息：CS1595：“_ASP.Header_ascx”在多个位置定义；使用来自 'C:\WINNT\Microsoft.NET\Framework\v1.0.3705\Temporary ASP.NET Files\root\afwew23d\asdfasd423\asdf23.dll' 的定义

编辑：我使用的是 .net 2.0 (3.5)，即使上面的错误是 1.0。我从另一个来源得到了这个错误，因为我不能每次都重现这个问题。但是错误的类型是相同的。

编辑 2：感谢 gisresearch 的研究。您提供的链接中有一个声明：

> 即使您有 debug=false 的一个警告是，如果您进入并更改其中一个 aspx 页面中的某些内容，则必须重新编译该页面，但这不会导致 appdomain 重新加载，因此整个应用程序不是批处理再次编译。这样做的效果是，页面现在将被单独重新编译并获得自己的 dll，因此不要过于频繁地更改实时服务器上的 aspx 页面。
> 
> machine.config 中有一个设置决定在应用程序域重新启动之前允许重新编译多少次，默认设置为 15，因此在 15 次重新编译后应用程序域将重新启动，就像您触摸 web.config 或摸了bin目录。

这似乎是说，当 debug=false 并且该站点已经被访问和编译时，如果您更改页面，它只会编译该页面。这听起来可能会导致问题。我曾认为更改页面或用户控件会导致整个应用程序重新编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T02:18:03.550

您的 Web 应用程序的不同文件夹中是否有两个具有相同文件名的用户控件？这有时会导致这个问题。

> 如果我将站点设置为调试，则永远不会发生错误。

当 debug=true 时，asp.net 编译器不会批量编译，当 debug=false 时会批量编译，可能会导致此问题。

阅读这篇[文章](http://blogs.msdn.com/tess/archive/2006/04/13/575364.aspx)。

有一个关于同一问题的对话。

> # 回复：ASP.NET 内存：如果您的应用程序正在生产中……那为什么
> 
> 是 debug=true 2006 年 4 月 24 日星期一下午 2:39 作者 Robbie Coleman 我们确实收到了一个用户控件的错误，它报告由于 Temp ASP.NET 文件夹中有多个版本，它无法加载 FileName_ascx 类。
> 
> 我们发现我们在同一个 Web 应用程序的不同文件夹中有两个具有相同文件名的用户控件。在我们设置 debug="false" 之前，它们也有不同的命名空间并且永远不会通过这个异常。我们甚至在 IISreset 上清除了 Temp ASP.NET 目录。
> 
> 我们可以修复错误的唯一方法是重命名两者之一的 ascx 文件。
> 
> 它是否正确...？有没有更好的方法来解决这个问题？
> 
> 顺便说一句... [KissUpText] Tess，您的帖子对我们的开发团队非常有帮助，我们非常感谢您提供的所有信息。[/亲吻文本]
> 
> # 回复：ASP.NET 内存：如果您的应用程序正在生产中……那为什么
> 
> 是 debug=true 2006 年 4 月 25 日星期二上午 1:56 作者 Tess Hi Robbie，
> 
> 谢谢你的好评论：）
> 
> 我假设您收到“CS1595：'UserControls.WebUserControl2' 在多个地方定义；使用来自 'c:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\Temporary ASP.NET Files\usercontrols\293a1a4b\ dbb2d387\cisxatg3.dll'" 或类似的。
> 
> 如果您使用的是 src 而不是 CodeBehind 并且您的 cs 或 vb 文件在完全相同的命名空间中包含完全相同的类的定义，则基本上会出现问题。如果您尝试使用在同一命名空间中定义两次的另一个类来编译 dll，则该错误实际上与您将得到的错误相同。
> 
> 我之所以说它发生在您使用 src 时，是因为如果您使用 CodeBehind，您会在编译时遇到错误。
> 
> 如果用户控件确实相同，我将避免创建副本，而是使用另一个文件夹中的一个。如果它们不同，我会尽可能给出不同的名称，如果没有，请确保源类位于不同的命名空间中，例如 ProjectName.FolderName.MyUserControl
> 
> 您现在而不是以前看到它的原因是因为您现在正在将所有内容批量编译到一个 dll 中。
> 
> 希望这可以帮助。

# hyperlink - 如何编写 javadoc 链接？

> ID：699771
> 
> 赞同：44
> 
> 时间：2009-03-31T02:11:26.700
> 
> 标签：hyperlink, javadoc

如何将链接写入 javadocs？

目前，我有类似的东西：

```
{@link java.lang.Math#sqrt(double) Math.sqrt} 
```

生成`Math.sqrt`应该链接到`java.lang.Math.sqrt(double)`API 的文本，但是，它所做的只是生成文本，没有链接。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-31T04:36:14.810

Eddie 提供了很多我的答案，但他的确切代码对我不起作用（或者至少在使用 Java 1.6 附带的 javadoc 版本时）

如果我做：

```
    javadoc -linkoffline http://java.sun.com/javase/6/docs/api/  
                         http://java.sun.com/javase/6/docs/api/package-list 
            -public FileName.java
```

然后javadoc抱怨：

```
    javadoc：警告 - 获取 URL 时出错：http: 
     //java.sun.com/javase/6/docs/api/package-list/package-list
```

另一方面，如果我这样做：

```
    javadoc -linkoffline http://java.sun.com/javase/6/docs/api/  
                         http://java.sun.com/javase/6/docs/api/  
            -public FileName.java
```

然后它起作用了，我的链接按照我想要的方式填充。

此外，我的链接没有格式错误。文本`{@link java.lang.Math#sqrt(double) Math.sqrt}`生成链接文本`Math.sqrt`而不是默认的`Math.sqrt(double)`.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-31T03:53:18.127

要获得指向代码外部内容的链接，您需要使用该`-linkoffline`选项

其中`-linkoffline`选项的格式如下（人工包装）：

```
-linkoffline http://java.sun.com/javase/6/docs/api/
             http://java.sun.com/javase/6/docs/api/ 
```

这告诉 JavaDoc 工具在哪里可以找到指向 JavaDoc 的链接以及使用该链接的包。从第二个 URL 开始，它会附加“package-list”来加载实际的 URL：

[http://java.sun.com/javase/6/docs/api/package-list](http://java.sun.com/javase/6/docs/api/package-list)

您可以通过在浏览器中加载它来验证它确实包含该 JavaDoc URL 中记录的包列表。这告诉 JavaDoc 工具对`@link`其中一个包中任何内容的任何引用都应链接到提供的 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-07T05:50:07.967

我相信对于你想要做的事情，你可以这样做：

```
@see java.lang.Math#sqrt(double) 
```

它不会为您提供替代文本，但会为您提供链接。

您还可以编写更通用的链接，例如使用标准 html：

```
<a href="http://www.google.com">Google</a> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-31T02:46:25.417

[此文档](http://www.oracle.com/technetwork/java/javase/documentation/index-137868.html)可能会有所帮助，请记住，对于 @link，您需要使用链接到的文档的 URL。

# unit-testing - 编写更好的单元测试的技巧

> ID：699777
> 
> 赞同：5
> 
> 时间：2009-03-31T02:13:49.160
> 
> 标签：unit-testing, testing

你们使用哪些技巧、工具或策略（除了具有单元测试标准）来编写更好的单元测试？更好的意思是“在尽可能少的测试中覆盖尽可能多的代码”。我说的是您使用过的东西，并且看到您的单元测试得到了突飞猛进的改进。

例如，前几天我在试用[Pex](http://research.microsoft.com/en-us/projects/Pex/)，我认为它真的非常好。我错过了一些测试，Pex 轻松地告诉我在哪里。不幸的是，它有一个相当严格的许可证。

那么你们正在使用/做的其他一些很棒的东西是什么？

编辑：很多好的答案。我将把我目前没有练习但肯定会尝试的答案标记为正确，希望能带来最大的收获。谢谢大家。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T02:26:17.400

1.  每个方法编写许多测试。
2.  尽可能测试最小的东西。然后测试下一个最小的东西。
3.  测试所有合理的输入和输出范围。IOW：如果您的方法返回布尔值，请确保测试 false 和 true 返回。对于整数？-1,0,1,n,n+1（通过数学归纳证明）。不要忘记检查所有异常（假设是 Java）。4a。先写一个抽象接口。4b。其次编写测试。4c。最后写你的实现。
4.  使用依赖注入。（对于 Java：Guice - 据说更好，Spring - 可能已经足够好了）
5.  使用像 mockito 这样的好工具包来模拟你的“单位”协作者（再次假设 Java）。
6.  谷歌很多。
7.  继续猛烈抨击它。（我花了 2 年时间——除了谷歌之外没有太多帮助——开始“得到它”。）
8.  阅读一本关于该主题的好书。
9.  冲洗，重复...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T02:20:35.463

*在编写代码之前*编写测试（即：测试驱动开发）。如果由于某种原因您以前无法编写测试，请在编写代码时编写它们。确保所有测试最初都失败。然后，顺着列表往下看，按顺序修复每个损坏的。这种方法将导致更好的代码和更好的测试。

如果您有时间，那么您甚至可以考虑编写测试，将其忘掉一周，然后再编写实际代码。这样你就离问题更远了，现在可以更清楚地看到问题。如果任务来自外部或内部来源，我们的大脑会以不同的方式处理任务，而这种中断使其成为外部来源。

在那之后，不要太担心它。单元测试为你提供了一个健全的检查和稳定的基础——仅此而已。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T02:32:36.057

阅读[《单元测试的艺术》之](http://www.artofunittesting.com/)类的书肯定会有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T03:39:13.260

在我当前的项目中，我们使用一个小生成工具为各种实体和访问器生成骨架单元测试，它为每个需要测试的模块化工作单元提供了相当*一致*的方法，并为开发人员测试他们的来自的实现（即默认情况下添加其余实体和其他依赖项时添加单元测试类）。

（模板化）测试的结构遵循相当可预测的语法，并且模板允许实现模块/对象特定的构建/拆卸（我们还为所有测试使用基类来封装一些逻辑）。

我们还在静态函数中创建实体实例（并分配测试数据值），以便可以以编程方式创建对象并在不同的测试场景和跨测试类中使用，这被证明非常有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T02:55:30.450

就政策而言，请阅读[Kent Beck](https://stackoverflow.com/questions/153234/how-deep-are-your-unit-tests/153565#153565)对 SO 的回答，尤其是：

> 尽可能少地测试以达到给定的信心水平

为代码的棘手部分编写实用的单元测试，不要忘记你正在测试的程序比单元测试更重要的事实。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T03:31:49.473

我有一个 ruby​​ 脚本，它为不是用 TDD 构建的“棕色”代码生成测试存根。它编写我的构建脚本，设置包含/使用并编写设置/拆卸以实例化存根中的测试类。当我破解在黑暗时代编写的代码时，有助于从一个一致的起点开始，而无需所有的打字乏味。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T04:28:38.353

我发现非常有用的一种做法是让您的测试套件与被测试的代码*同构。*这意味着测试的排列顺序与它们正在测试的代码行的顺序相同。这使得获取一段代码和该代码的测试套件变得非常容易，并排查看它们并逐步检查每一行代码以验证是否存在适当的测试。我还发现，仅仅像这样强制执行同构的行为就迫使我仔细考虑正在测试的代码，例如确保代码中所有可能的分支都经过测试，或者所有循环条件都经过测试。

例如，给定这样的代码：

```
void MyClass::UpdateCacheInfo(
    CacheInfo *info)
{
    if (mCacheInfo == info) {
        return;
    }
    info->incrRefCount();
    mCacheInfo->decrRefCount();
    mCacheInfo = info
} 
```

此功能的测试套件将按顺序进行以下测试：

```
test UpdateCacheInfo_identical_info
test UpdateCacheInfo_increment_new_info_ref_count
test UpdateCacheInfo_decrement_old_info_ref_count
test UpdateCacheInfo_update_mCacheInfo 
```

# java - 使用 SVN 将一些模板文本包含到源文件中的好解决方案？

> ID：699778
> 
> 赞同：3
> 
> 时间：2009-03-31T02:14:05.230
> 
> 标签：java, svn, templates

我在 SVN 存储库中有一个 Java 项目，有一堆 .java 文件，每个文件的顶部都有一个许可协议花框（我的客户已经获得了源代码以及运行产品的许可） .

有没有一种好方法可以在一个地方修改/维护许可证文本，而不必在更改时手动更新所有源文件？

查看一些类似（但不相同）的问题，SVN 似乎没有开箱即用的功能——还有哪些其他方法最适合？

编辑：理想情况下，该解决方案的行为类似于 SVN 关键字（Id、Author 等），而不是构建时解决方案。客户也可以访问 SVN 存储库，因此如果文件的 SVN 版本中存在许可证文本，那将是理想的选择。我知道 SVN 有提交触发器——实现它的简单方法是什么？

编辑 2：查看 SVN 钩子，看起来我想做的事情是不可能的。我猜想在文本更改时可以运行的构建过程是可以的 - 因为它不会经常更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T02:39:54.980

修改需要包含许可证文本的源文件以包含一些令牌，然后将许可证文本移动到保留在 subversion 中的单个文件中。最后，作为构建过程的一部分，添加一个步骤，将许可证文本替换为令牌。在我的工作中，我使用 sed 和 make 的组合来做一些事情。然后，您可以在将源分发给您的客户之前执行这一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T04:35:11.910

ANT 可以很容易地进行替换。查看`<copy>`目标。

# c++ - C++ 二进制常量/字面量

> ID：699781
> 
> 赞同：13
> 
> 时间：2009-03-31T02:16:56.143
> 
> 标签：c++, templates, binary, constants

我正在使用一个众所周知的模板来允许二进制常量

```
template< unsigned long long N >
struct binary
{
  enum { value = (N % 10) + 2 * binary< N / 10 > :: value } ;
};

template<>
struct binary< 0 >
{
  enum { value = 0 } ;
}; 
```

所以你可以做类似 binary<101011011>::value 的事情。不幸的是，这对于 unsigned long long 有 20 位数字的限制。

有没有人有更好的解决方案？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-31T02:31:17.963

如果您的二进制值有前导零，这是否有效？前导零使常量八进制而不是十进制。

这导致了一种从这个解决方案中挤出更多数字的方法——总是以零开始你的二进制常量！然后将模板中的 10 替换为 8。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T02:23:28.297

我一直使用的方法，虽然不如你的优雅：

1/ 只使用十六进制。过了一会儿，你就会知道哪些十六进制数字代表哪些位模式。

2/ 使用常量和 OR 或 ADD 它们。例如（可能需要位模式上的限定符使它们无符号或长）：

```
#define b0  0x00000001
#define b1  0x00000002
: : :
#define b31 0x80000000

unsigned long x = b2 | b7 
```

3/ 如果性能不重要并且可读性很重要，您可以在运行时使用诸如“x = fromBin("101011011");”之类的函数来完成。

4/ 作为一个偷偷摸摸的解决方案，您可以编写一个预处理器，通过您的 *.cppme 文件并通过将所有“0b101011011”类型的字符串替换为等效的“0x15b”字符串来创建 *.cpp 文件）。我不会轻易做到这一点，因为您可能不得不担心各种棘手的语法组合。但这将允许您根据需要编写字符串，而不必担心编译器的变幻莫测，并且您可以通过仔细编码来限制语法技巧。

当然，之后的下一步是修补 GCC 以识别“0b”常量，但这可能有点过分了 :-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-31T02:22:07.690

C++0x 有[用户定义的文字](https://stackoverflow.com/questions/237804/user-defined-literals-in-c0x-a-much-needed-addition-or-making-c-even-more-bl)，可以用来实现你所说的。

否则，我不知道如何改进这个模板。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-31T13:41:37.137

您可以添加更多非类型模板参数来“模拟”附加位：

```
// Utility metafunction used by top_bit<N>.
template <unsigned long long N1, unsigned long long N2>
struct compare {
    enum { value = N1 > N2 ? N1 >> 1 : compare<N1 << 1, N2>::value };
};

// This is hit when N1 grows beyond the size representable
// in an unsigned long long.  It's value is never actually used.
template<unsigned long long N2>
struct compare<0, N2> {
    enum { value = 42 };
};

// Determine the highest 1-bit in an integer.  Returns 0 for N == 0.
template <unsigned long long N>
struct top_bit {
    enum { value = compare<1, N>::value };
};

template <unsigned long long N1, unsigned long long N2 = 0>
struct binary {
    enum {
        value =
            (top_bit<binary<N2>::value>::value << 1) * binary<N1>::value +
            binary<N2>::value
    };
};

template <unsigned long long N1>
struct binary<N1, 0> {
    enum { value = (N1 % 10) + 2 * binary<N1 / 10>::value };
};

template <>
struct binary<0> {
    enum { value = 0 } ;
}; 
```

您可以像以前一样使用它，例如：

```
binary<1001101>::value 
```

但您也可以使用以下等价形式：

```
binary<100,1101>::value
binary<1001,101>::value
binary<100110,1>::value 
```

基本上，额外的参数为您提供了另外 20 位可供使用。如有必要，您可以添加更多参数。

因为第二个数字的位置值用于计算第一个数字需要向左移动多远，所以第二个数字必须以 1 开头。（无论如何这是必需的，因为以 0 开头会导致number 被解释为八进制数。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-27T02:51:27.753

```
template<unsigned int p,unsigned int i> struct BinaryDigit 
{
  enum  { value = p*2+i };
  typedef BinaryDigit<value,0> O;
  typedef BinaryDigit<value,1> I;
};
struct Bin
{
  typedef BinaryDigit<0,0> O;
  typedef BinaryDigit<0,1> I;
}; 
```

允许：

Bin::O::I::I::O::O::值

更详细，但没有限制（当然，直到你达到 unsigned int 的大小）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-11-04T14:51:52.287

从技术上讲，它不是 C 也不是 C++，它是 GCC 特定的扩展，但 GCC 允许[二进制常量](http://gcc.gnu.org/onlinedocs/gcc/Binary-constants.html)[，](http://gcc.gnu.org/onlinedocs/gcc/Binary-constants.html)如下所示：

```
 The following statements are identical:

 i =       42;
 i =     0x2a;
 i =      052;
 i = 0b101010; 
```

希望有帮助。一些英特尔编译器，我相信还有其他编译器，实现了一些 GNU 扩展。也许你很幸运。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-04T15:08:12.680

一个简单的#define 效果很好：

```
#define HEX__(n) 0x##n##LU

#define B8__(x) ((x&0x0000000FLU)?1:0)\
               +((x&0x000000F0LU)?2:0)\
              +((x&0x00000F00LU)?4:0)\
               +((x&0x0000F000LU)?8:0)\
               +((x&0x000F0000LU)?16:0)\
               +((x&0x00F00000LU)?32:0)\
               +((x&0x0F000000LU)?64:0)\
               +((x&0xF0000000LU)?128:0)

#define B8(d) ((unsigned char)B8__(HEX__(d)))
#define B16(dmsb,dlsb) (((unsigned short)B8(dmsb)<<8) + B8(dlsb))
#define B32(dmsb,db2,db3,dlsb) (((unsigned long)B8(dmsb)<<24) + ((unsigned long)B8(db2)<<16) + ((unsigned long)B8(db3)<<8) + B8(dlsb))

B8(011100111)
B16(10011011,10011011)
B32(10011011,10011011,10011011,10011011) 
```

不是我的发明，很久以前在论坛上看到的。

# asp.net - 在控制器 .NET MVC 中创建 URL

> ID：699782
> 
> 赞同：136
> 
> 时间：2009-03-31T02:17:51.663
> 
> 标签：asp.net, asp.net-mvc

我需要能够在控制器上的 Action 中构造一个链接以发送电子邮件。这样做的最佳做法是什么？如果我的路线发生变化，我不想自己构建它。

我是否应该查看每封电子邮件并呈现并发送它？这可能是一个很好的方法。

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2009-03-31T07:09:38.420

如果您只想获取某个操作的路径，请使用`UrlHelper`：

```
UrlHelper u = new UrlHelper(this.ControllerContext.RequestContext);
string url = u.Action("About", "Home", null); 
```

如果要创建超链接：

```
string link = HtmlHelper.GenerateLink(this.ControllerContext.RequestContext, System.Web.Routing.RouteTable.Routes, "My link", "Root", "About", "Home", null, null); 
```

Intellisense 将为您提供每个参数的含义。

* * *

**评论更新**：控制器已经有一个`UrlHelper`：

```
string url = this.Url.Action("About", "Home", null); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-01-29T16:20:23.913

如果您需要完整的 url（例如通过电子邮件发送），请考虑使用以下内置方法之一：

这样，您就可以创建用于构建 url 的路由：

```
Url.RouteUrl("OpinionByCompany", new RouteValueDictionary(new{cid=newop.CompanyID,oid=newop.ID}), HttpContext.Request.Url.Scheme, HttpContext.Request.Url.Authority) 
```

这里的 url 是在路由引擎确定正确的之后构建的：

```
Url.Action("Detail","Opinion",new RouteValueDictionary(new{cid=newop.CompanyID,oid=newop.ID}),HttpContext.Request.Url.Scheme, HttpContext.Request.Url.Authority) 
```

在这两种方法中，最后两个参数指定协议和主机名。

问候。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-01-05T10:18:14.543

我遇到了同样的问题，Gidon 的回答似乎有一个小缺陷：它生成了一个相对 URL，不能通过邮件发送。

我的解决方案如下所示：

```
string link = HttpContext.Request.Url.Scheme + "://" + HttpContext.Request.Url.Authority + Url.Action("ResetPassword", "Account", new { key = randomString }); 
```

这样，一个完整的 URL 就生成了，即使应用程序在托管服务器上的深度有好几级，并且使用了 80 以外的端口，它也能正常工作。

编辑：我发现[这](https://stackoverflow.com/questions/1288046/how-can-i-get-my-webapps-base-url-in-asp-net-mvc)也很有用。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-02-03T23:57:43.260

为操作创建绝对 URL 的另一种方法：

```
var relativeUrl = Url.Action("MyAction");  //..or one of the other .Action() overloads
var currentUrl = Request.Url;

var absoluteUrl = new System.Uri(currentUrl, relativeUrl); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-10-20T08:37:30.747

我知道这是一个老问题，但以防万一您尝试在 ASP.NET Core 中做同样的事情，以下是如何在操作中创建 UrlHelper：

```
var urlHelper = new UrlHelper(this.ControllerContext); 
```

或者，`Controller.Url`如果您继承自`Controller`.

# linux - 编辑非常大的 sql 转储/文本文件（在 linux 上）

> ID：699785
> 
> 赞同：16
> 
> 时间：2009-03-31T02:19:49.800
> 
> 标签：linux, mysqldump, large-files

我必须导入一个大型 mysql 转储（最多 10G）。然而，已经使用带有索引定义的数据库结构预定义了 sql 转储。我想通过删除索引和表定义来加速数据库插入。

这意味着我必须**删除/编辑****10G**文本文件的前几行。**在 linux**上执行此操作的最有效方法是什么？

需要将整个文件加载到 RAM 中的程序对我来说太过分了。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-31T02:24:07.280

*与其删除*前几行，不如尝试将它们编辑为空白。

该`hexedit`程序可以做到这一点——它以块的形式读取文件，因此打开一个 10GB 的文件与打开一个 100KB 的文件没有什么不同。

```
$ hexedit largefile.sql.dump
tab (switch to ASCII side)
space (repeat as needed until your header is gone)
F2 (save)/Ctrl-X (save and exit)/Ctrl-C (exit without saving) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-02T22:32:04.987

[joe](http://joe-editor.sourceforge.net/ "乔自己的编辑")是一个可以很好地处理大文件的编辑器。我只是用它来编辑一个~5G SQL 转储文件。打开文件大约需要一分钟，保存文件需要几分钟，很少使用交换（在具有 4G RAM 的系统上）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-18T10:45:01.983

```
sed 's/OLD_TEXT/NEW_TEXT/g' < oldfile > newfile 
```

或者

```
cat file | sed 's/OLD_TEXT/NEW_TEXT/g' > newfile 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-31T02:25:57.260

Perl 可以逐行读取文件：

perl -pi.bak -e 's/^create index/--create index/'

# orm - ORM 慢吗？有关系吗？

> ID：699792
> 
> 赞同：24
> 
> 时间：2009-03-31T02:22:59.513
> 
> 标签：orm

与存储过程相比，我真的很喜欢 ORM，但我担心的一件事是 ORM 可能会很慢，因为有一层又一层的抽象。使用 ORM 会减慢我的应用程序吗？*还是有关系？*

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-31T02:28:41.700

是的，这很重要。它正在使用更多的 CPU 周期，因此会降低您的应用程序的速度。不过听我说...

但是，考虑一下：什么更贵？服务器硬件或其他程序员？通常，服务器硬件比雇用另一个程序员团队便宜。因此，虽然 ORM 可能会花费您的 CPU 周期，但您需要更少的程序员来管理您的 SQL 查询，这通常会导致较低的净成本。

要确定这对您是否值得，请计算或确定您使用 ORM 节省了多少小时。然后，算出你在服务器上花了多少钱来支持 ORM。将您节省的小时数乘以小时费率，然后与服务器成本进行比较。

当然，ORM 是否真的能节省你的时间完全是另一场争论......

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-31T16:17:27.183

> ORM 慢吗？

不是天生的。一些重量级的 ORM 可以给事情增加普遍的阻力，但我们并不是在谈论数量级的减速。

使 ORM 变慢的原因是幼稚的**使用**。如果您使用 ORM 是因为*它看起来很简单*，并且您不知道底层关系数据模型是如何工作的，那么您可以轻松编写对 OO 程序员来说似乎合理但会破坏性能的代码。

ORM 是一个方便的工具，但您需要较低层次的理解（通常来自编写 SQL 查询）才能使用它。

> 有关系吗？

如果您最终一次对数千个实体中的每一个执行循环查询，而不是单个快速连接，那么它当然可以。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-07-17T22:24:36.580

ORM 速度较慢，并且确实增加了应用程序的开销（除非您特别知道如何解决这些问题，这并不常见）。数据库是最关键的元素，应该围绕它设计 Web 应用程序。

许多使用 Active Record 或 ORM 的 OOP 框架，一般开发人员 - 将数据库视为不重要的事后想法，并倾向于将其视为他们并不真正需要学习的东西。但是性能和可扩展性通常会受到影响，因为数据库的负担很重！

许多大型 Web 应用程序都失败了，浪费了数百万、数月甚至数年的时间，因为他们没有认识到数据库的重要性。数百个并发用户和具有数百万条记录的表需要数据库调优和优化。但我相信这个问题在少数用户和更少数据的情况下很明显。

为什么开发人员如此害怕学习正确的 SQL 和调优措施，因为它是性能的关键？

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-31T03:13:39.610

在一个反对使用 SqlCe 的 Windows Mobile 5 项目中，我从使用手动编码的对象转变为使用 ORM 模板对生成的 (CodeSmith) 对象进行编码。在这个过程中，我所有的数据访问都使用 CSLA 作为基础层。

直接转换将我在本地测试中的性能提高了 32%，几乎所有这些都归功于更好的访问方法。

在那次更改之后，我们调整了模板（在看到 Steve Lasker 在 PDC 上的一些 SqlCe 性能资料之后），在不到 20 分钟的时间里，我们的整个数据层得到了极大的改进，我们的平均“慢”调用从 460 毫秒变为约 20 毫秒。ORM 最酷的部分是我们只需要实现（和单元测试）这些更改一次，并且所有数据访问代码都已更改。这是一个惊人的节省时间，我们可能节省了 40 小时或更长时间。

综上所述，我们确实浪费了一些时间，因为我们去掉了一堆不再需要的“等待”和“进度”对话框。

我使用了一些 ORM 工具，我可以推荐其中的两个：

*   [.NET 层](http://nettiers.com/default.aspx?AspxAutoDetectCookieSupport=1)
*   [CSLA 代码生成模板](http://sourceforge.net/projects/cslagen)

他们俩的表现都非常好，任何性能损失都没有引起注意。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-31T02:33:38.537

我一直觉得没关系。您应该使用任何能让您最有效率、最能响应变化以及最容易调试和维护的东西。

大多数应用程序从不需要足够的负载来使 ORM 和 SP 之间的差异变得明显。并且有一些优化可以使 ORM 更快。

最后，一个编写良好的应用程序的数据访问将与其他所有内容分开，以便将来从 ORM 切换到任何可能的应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-31T02:31:47.497

> *ORM 慢吗？*

是（与存储过程相比）

> *有关系吗？*

不（除了你关心的是速度）

我认为问题在于许多人认为 ORM 是数据库的对象“技巧”，可以减少代码或简化 SQL 的使用，而实际上是......以及对象 - 到关系（ DB ） - 映射。

ORM 用于将对象持久保存到关系数据库管理器系统中，而不是（只是）替代或简化 SQL（尽管它在这方面也做得很好）

如果你没有一个好的对象模型，或者你是用来做报告的，或者即使你只是想获取一些信息，ORM 也不值得。

另一方面，如果您有一个通过对象建模的复杂系统，每个对象都有不同的规则并且它们动态交互，并且您关心的是将该信息保存到数据库中，而不是替换一些现有的 SQL 脚本，那么选择 ORM。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-02-26T23:05:15.337

是的，ORM 会影响性能，这是否重要最终取决于您项目的具体情况。

程序员通常喜欢 ORM，因为他们喜欢像 Visual Studio 这样漂亮的前端 cding 环境，而不喜欢编写没有智能感知的原始 SQL 等。

除了性能损失之外，ORM 还有其他限制——它们通常不会 100% 完成您需要的工作，增加了额外抽象层的复杂性，每次进行更改时都必须维护和重新建立该抽象层，还有要处理的缓存问题。

只是一个想法——如果数据库供应商能让 SQL 编程环境像 Visual Studio 一样好，并在 db 代码和前端代码之间提供更自然的链接，我们就不需要 ORM ......我猜是最终可能会朝那个方向发展。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-31T02:31:32.723

显而易见的答案：这取决于

ORM 很好地将程序员与 SQL 隔离开来。这实际上替代了程序员可能给出的灾难性错误查询的平庸、计算机生成的查询。

即使在最好的情况下，ORM 也会做一些额外的工作，加载不需要的字段，显式检查约束等等。

当这些成为瓶颈时，大多数 ORM 让您避开它们并注入原始 SQL。

如果您的应用程序很适合对象，但不太容易适合关系，那么这仍然是一个胜利。相反，如果您的应用程序非常适合关系模型，那么 ORM 代表了可能的性能瓶颈之上的编码瓶颈。

我发现对大多数 ORM 来说特别令人反感的一件事是它们对主键的处理。大多数 ORM 都需要 pk 来处理它们接触到的所有东西，即使它们没有可想象的用途。示例：作者应该有 pk，博客文章应该有 pk，但作者和文章之间的链接（连接表）没有。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-31T02:32:30.177

是的，ORM 会减慢你的应用程序。多少取决于抽象的程度、对象模型映射到数据库的程度以及其他因素。问题应该是，您是否愿意花费更多的开发时间并使用直接的数据访问或用更少的开发时间换取更慢的运行时性能。

总体而言，好的 ORM 几乎没有开销，而且总的来说，被认为是值得权衡的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-31T02:38:46.747

我发现“太慢”和“不太慢”之间的区别取决于您是否启用了 ORM 的第二级（SessionFactory）缓存。关闭它后，它在开发负载下处理得很好，但在轻微的生产负载下会破坏您的系统。打开二级缓存后，服务器处理了预期的负载并很好地扩展了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-07-22T11:12:05.097

ORM 可以慢一个数量级，不仅仅是因为它自己浪费了大量的 CPU 周期，而且还使用了更多的内存，然后必须是 GC-d。

更糟糕的是，这不是 ORM 的标准（与 SQL 不同），而且我和大型 ORM-s 使用 SQL 效率低下，所以在一天结束时，您仍然必须深入研究 SQL 来修复每个问题和每次ORM 搞得一团糟，你必须调试它。意思是你什么都没得到。

对于真正的生产级应用来说，这是非常不成熟的技术。非常有问题的事情是处理索引、外键、调整表以适应对象层次结构和非常长的事务，这意味着更多的死锁和重复——如果 ORM 知道如何处理这些。

它实际上使服务器的可扩展性降低，从而使成本成倍增加，但这些成本在一开始并没有被提及 - 有点不方便的事实:-) 当某些事物使用的事务比最佳值大 10-100 倍时，根本不可能扩展 SQL 端。再次谈论严肃的系统，而不是家庭/玩具/学术的东西。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-31T02:37:11.570

由于抽象层的原因，ORM 总是会增加一些开销，但除非它是设计不佳的 ORM，否则应该是最小的。如果操作正确，实际查询数据库的时间将比 ORM 基础架构的额外开销多很多倍，例如在不需要时不加载完整的对象图。一个好的 ORM (nHibernate) 还会为您提供针对数据库运行的查询的许多选项，因此您也可以根据需要进行优化。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-31T02:49:39.653

使用 ORM 通常比较慢。但是，您获得的生产力提升将使您的应用程序启动并运行得更快。您节省的时间可以在以后用于查找导致最大减速的应用程序部分 - 然后您可以花时间优化您在开发工作中获得最佳回报的区域。仅仅因为您决定使用 ORM 并不意味着您不能在可以真正从中受益的代码部分中使用其他技术。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-31T02:53:54.323

ORM 可能会更慢，但这会被它们缓存数据的能力所抵消，因此无论替代方案有多快，您都不会比从内存中读取快得多。

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2009-03-31T02:38:07.650

我从来没有真正理解为什么人们认为这更慢或更慢......我说的是一台真正的机器。我的结果好坏参半......我已经看到存储过程的执行时间比 ORM 慢得多，反之亦然。但在这两种情况下，性能都是由于硬件差异造成的。

# rest - 这种想法在 ESB 与 REST 风格的接口上是否准确？

> ID：699795
> 
> 赞同：0
> 
> 时间：2009-03-31T02:25:15.093
> 
> 标签：rest, soap, esb

为了将各种遗留应用程序联系在一起，一些基于大型机的应用程序，我尝试比较使用像 MQSeries 这样的 ESB、WS-* 方法或更多 RESTful 的方法。

将接口编写到 REST 而不是 MQ 甚至 WS-* 的想法是否有很多实质内容，这可能具有使我们更接近应用程序的 Web 支持部分（供人类使用浏览器使用）的次要好处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T02:30:17.063

在 REST 成为时尚之前，应用程序已经支持 Web 多年，并且在未来几年也将如此。我看不出两人有多大关系。

顺便说一句，我认为 MQSeries 与 ESB 无关——它只是一个消息队列系统，在很大程度上等同于 MSMQ。

# css - IE7 不应该缩进文本

> ID：699801
> 
> 赞同：3
> 
> 时间：2009-03-31T02:28:44.537
> 
> 标签：css, internet-explorer-7

*移动链接，因为它不再指向该站点，并且已找到解决方案*

我有一些列表元素有一个神秘的左边距/边距。

在 Firefox 中，它按预期显示。但是在 IE7 中，有一个文本缩进或强制内部文本在大约 4 个空格内的东西。请参阅上面的示例链接。

我已设置`padding`为 0，设置为`margin`0（尽管它不应该是这样，因为边界显然围绕包含间隙的元素），`text-indent`设置为 0，和`text-align: left`.

有谁知道可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-31T03:07:16.223

在您的 style.css 文件中，您将 LIST-STYLE-POSITION 设置为 inside。这导致您在 IE 中出现问题。

```
#content-body UL {
    LIST-STYLE-POSITION: inside; LIST-STYLE-TYPE: disc
} 
```

您可以删除该元素，也可以将样式添加到 .events UL

```
.events UL {
    ...
    LIST-STYLE-POSITION: outside! important;
} 
```

# mysql - 正则表达式在 MySQL 查询中的每个表之前插入一个字符串

> ID：699812
> 
> 赞同：0
> 
> 时间：2009-03-31T02:32:57.180
> 
> 标签：mysql, regex

我需要进行 MySQL 查询并在每个表名之前插入一个字符串。解决方案不需要是一行，但显然这是一个正则表达式问题。它将在 PHP 中实现，因此具有编程逻辑也很好。

基本原理和背景：我正在修改我的代码库以允许使用表前缀（例如：'nx_users' 而不是 'users'），我希望有一个函数可以为我自动化，所以我不需要找到每个查询并手动修改它。

例子：

```
SELECT * FROM users, teams WHERE users.team_id = teams.team_id ORDER BY users.last_name 
```

使用前缀“nx_”，它应该更改为

```
SELECT * FROM nx_users, nx_ teams WHERE nx_ users.team_id = nx_ teams.team_id ORDER BY nx_ users.last_name 
```

显然它应该处理其他情况，例如表别名、连接和其他常见的 MySQL 命令。

有人做过吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T02:37:29.807

我们在这里谈论的代码库有多大？像这样的正则表达式会严重影响灾难，我认为您最好`mysql_query`在代码中查找每一个或任何内容并自己进行更改。实施正则表达式和修复它无疑会错过的所有边缘情况所花费的时间不应该超过一个小时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T02:59:18.117

使用正则表达式重写代码将是有问题的。

如果您需要动态更改此字符串，则需要将您的 sql 逻辑分离到一个位置，并在每个 sql 查询中适当放置一个 $table_prefix 变量。然后可以通过调用代码设置该变量。

```
$query = "SELECT foo from " . $table_prefix . "bar WHERE 1"; 
```

如果您将其封装在一个类中，那就更好了。

*此示例未考虑任何转义或安全问题。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T02:50:15.767

首先，单靠正则表达式不能胜任这项任务。考虑以下事项：

```
select sender from email where subject like "from users group by email" 
```

要真正做到这一点，您需要能够解析 SQL，生成可以修改的解析树，然后从修改后的解析树中发出修改后的 SQL。这样，它是可行的，但不可取（出于 Paolo 给出的原因）。

更好的方法是通过您的源代码查找表名、用于发送 SQL 的函数、来自的单词或类似脚本的内容，以便在这些点将您放入编辑器。

# asp.net - 为什么 Response.Redirect("") 在一个测试环境中返回一个错误而不是另一个？

> ID：699814
> 
> 赞同：0
> 
> 时间：2009-03-31T02:34:20.593
> 
> 标签：asp.net, iis, response.redirect

我们正在尝试找出如何修复在第 3 方 IV&V 测试中发现的错误，我们无法在内部测试环境中重新创建该错误。

我们已确定该错误是由于在尝试重定向到它之前无意中将 URL 值设置为空字符串 ("") 引起的。因此，我们正在尝试执行 Response.Redirect("")。

在外部测试环境中，这行代码导致如下错误：

```
Internet Explorer cannot display the webpage 
```

在内部测试环境中，当前页面只是简单地重新加载。

服务器实际上是相同的——内部测试服务器与外部服务器具有相同的物理硬件，甚至运行外部服务器的虚拟映像的副本。因此，所有 Windows 和 IIS 设置*都应该*相同。

是否存在可能导致这种差异的物理网络、负载平衡或其他环境问题？

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T03:38:55.087

我会使用 Fiddler 查看来自服务器的 HTTP 响应并确保它们完全相同。完成后，您就知道这是客户端或环境问题。下一个...

两个浏览器地址栏中的 URL 是什么？更好的是...在 IE 中右键单击页面并查看属性。你在这里*真正*看到了什么？在我的本地系统测试 Response.Redirect("") 我得到这样的东西：“res://ieframe.dll/dnserror.htm# [http://localhost/test.aspx](http://localhost/test.aspx) ” DNSERROR！嗯……有趣！

另外，请考虑在以下情况下会发生什么： [http://somelanname](http://somelanname)

...在“somelanname”是本地 Intranet 上的资源名称的环境中...然后当您尝试访问该 URL 时会发生什么，而该 URL 不存在。我想你在这里看到了同样的事情。

# algorithm - 无冲突自动生成文件名

> ID：699815
> 
> 赞同：2
> 
> 时间：2009-03-31T02:34:30.640
> 
> 标签：algorithm, language-agnostic, unique

我正在编写一个“文件共享主机”，我想在上传到唯一名称时重命名所有文件，并以某种方式跟踪数据库中的名称。由于我不想要两个或多个具有相同名称的文件（这肯定是不可能的），我正在寻找一种基于密钥或其他东西为我生成随机名称的算法。

此外，我不想生成名称并搜索数据库以查看文件是否已存在。我想确保 100% 或 99% 的应用程序之前从未创建过生成的文件名。

知道如何编写这样的应用程序吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T02:56:06.487

您可以根据文件内容本身生成哈希。这样做有两个很好的理由：

1.  允许您永远不会存储相同的文件两次 - 例如，如果您有两个内容相同的音乐文件副本，您可以检查您是否已经存储了该文件，然后只存储一次。

2.  您将元数据（文件名只是元数据）与 blob 分开。因此，您将拥有一个由文件内容的哈希索引的存储系统，然后您将文件元数据与该哈希查找代码相关联。

根据散列的大小，找到计算相同散列但内容不同的两个文件的风险很低，您可以通过将文件分块散列来有效缓解这种情况（这可能会导致一些有趣的存储优化方案：P）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T02:37:32.723

[GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)是一种方式。基本上可以保证您不会得到任何重复（如果您有适当的随机生成器）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T02:40:21.250

您还可以附加自纪元以来的时间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-31T02:57:24.767

最好的解决方案已经提到过。我只是想补充一些想法。

最简单的解决方案是在每个新文件上都有一个计数器和增量。只要只有一个线程创建新文件，这就会很好地工作。如果多个线程、进程甚至系统添加新文件，事情就会变得有点复杂。您必须通过锁定或任何类似的同步方法来协调新 ID 的创建。您还可以为每个进程分配 id 范围以减少同步工作，或通过唯一的进程 id 扩展文件 id。

更好的解决方案可能是在这种情况下使用 GUID，而不必关心进程之间的同步。

最后，您可以为每个标识符添加一些随机数据，以使它们更难猜测是否这是必需的。

同样常见的是将文件存储在目录结构中，其中文件的位置取决于其名称。文件 abcdef1234.xyz 可能存储为 /ab/cd/ef/1234.xyz。这避免了包含大量文件的目录。我真的不知道为什么会这样做 - 可能是文件系统限制，性能问题 - 但它很常见。如果文件直接存储在数据库中，我不知道类似的事情是否常见。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T02:38:44.217

最好的方法是简单地使用计数器。第一个文件是 1，下一个是 2，另一个是 3，依此类推...

但是，似乎你想要随机。要快速做到这一点，您可以确保您的随机数*大于**最后*创建的文件。您可以缓存最后一个文件，然后用其姓氏偏移您的随机数。

```
file = last_file + random(1 through 10) 
```

# php - PHP：检查XML节点是否存在属性

> ID：699821
> 
> 赞同：7
> 
> 时间：2009-03-31T02:37:59.680
> 
> 标签：php, xml, xpath

我似乎无法弄清楚这一点。我有以下 XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<targets>
  <showcases>
    <building name="Big Blue" />
    <building name="Shiny Red" />
    <building name="Mellow Yellow" />
  </showcases>
</targets> 
```

我需要能够测试是否``<building>``存在具有给定名称的节点。我似乎在 Google 上找到的所有内容都告诉我执行以下操作：

```
$xdoc->getElementsByTagName('building')->item(0)->getAttributeNode('name') 
```

...但是如果我理解正确，那不是只测试第一个`<building>`节点吗？ `item(0)`? 我需要为此使用 XQuery 吗？

我会很感激一些帮助！谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-31T13:56:42.170

我建议以下（使用 ext/simplexml 和 XPath 的 PHP）：

```
$name = 'Shiny Red';
$xml = simplexml_load_string('<?xml version="1.0" encoding="UTF-8"?>
<targets>
  <showcases>
    <building name="Big Blue" />
    <building name="Shiny Red" />
    <building name="Mellow Yellow" />
  </showcases>
</targets>');
$nodes = $xml->xpath(sprintf('/targets/showcases/building[@name="%s"]', $name);
if (!empty($nodes)) {
    printf('At least one building named "%s" found', $name);
} else {
    printf('No building named "%s" found', $name);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T03:08:26.237

好的，看起来 XPath 是我想要的。这是我想出的，可以满足我的要求：

```
<?php

$xmlDocument = new DOMDocument();

$nameToFind = "Shiny Red";

if ($xmlDocument->load('file.xml')) {
        if (checkIfBuildingExists($xmlDocument, $nameToFind)) {
        echo "Found a red building!";
    }
}

function checkIfBuildingExists($xdoc, $name) {
    $result = false;
    $xpath = new DOMXPath($xdoc);
    $nodeList = $xpath->query('/targets/showcases/building', $xdoc);
    foreach ($nodeList as $node) {
        if ($node->getAttribute('name') == $name) {
            $result = true;
        }
    }
    return $result;
}

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T13:49:29.783

**这个 XPath 表达式**：

       **`/*/*/building[@name = 'Shiny Red']`**

选择`building`其`name`属性值为“Shiny Red”的元素，该元素是顶部元素的子元素的子元素。

**可能在 PHP 中有一种评估 XPath 表达式的方法，然后只需评估上面的 XPath 表达式并使用结果**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T16:05:12.297

> 如果我理解正确，那不是只测试第一个节点吗？

是的。因此，如果您想使用类似的 DOM 方法，则必须循环执行。例如。：

```
$buildings= $xdoc->getElementsByTagName('building');
foreach ($buildings as $building)
    if ($building->getAttribute('name')==$name)
        return true;
return false; 
```

使用 XPath，您可以消除循环，正如 Dimitre 和 sgehrig 所发布的那样，但是您必须小心允许将哪些字符注入 XPath 表达式（例如，$name= '"]' 会破坏表达式） .

# jquery - 公司不想使用 ASP.NET ajax...我该怎么办？

> ID：699836
> 
> 赞同：3
> 
> 时间：2009-03-31T02:49:02.447
> 
> 标签：jquery, asp.net, ajax, yahoo-boss-api

开发人员和管理人员告诉我，他们不想使用 asp.net ajax，因为它又大又麻烦。

我有点同意，但我不想自己做所有的 javascript 繁重的工作。最后我还想介绍一下jQuery。我猜现在这也将是一个问题。

是否有一篇很好的文章概述了使用 ajax.net 与您自己的自定义库的优缺点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-31T02:52:29.473

如果

> 他们想放弃使用 asp.net ajax，因为它又大又麻烦

那么 JQuery 就是这个问题的确切答案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-31T02:59:39.800

你需要说服你的经理一些事情。这是你学会完善的一种艺术形式:-)

向他们展示在 ASP、纯 JS 和 jQuery 中执行简单功能的等效代码位，并选择一个确保纯 JS 版本大而可怕的示例。

告诉他们你完全同意他们对 ASP 的担忧（给他们加油，这总是很有效），但你对交付的质量和及时性有担忧（这会吓到任何经理的生活日光）。

您精心挑选的示例应该让他们相信他们应该从 ASP 迁移到 jQuery，而不是从 ASP 迁移到直接的 JS。或者，最坏的情况是，他们会在 ASP 中停留更长时间。

这两个听起来你都可以接受，因为它们不涉及繁重的工作。

我喜欢从“是的，首相”节目中汲取灵感，汉弗莱爵士曾经评论过（意译）：

> 给他们三个选项，其中两个可以证明最终在第三次世界大战中达到高潮，然后让他们考虑一下。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T13:56:44.910

*   JQuery 是轻量级的 (19KB)
*   跨浏览器兼容
*   有一个很棒的 UI 库
*   丰富的插件
*   和一个好的文档
*   对ajax的良好支持

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T02:54:56.097

我不知道一篇文章，但是您可以轻松地实现 AJAX，而无需使用任何类型的库（如果您的意思是真正的 AJAX，而不是像字段验证、DOM 抽象等混入 AJAX 的所有辅助内容） .

这个页面教会了我所有我需要知道的关于真正的 AJAX 的知识。 [http://www.hunlock.com/blogs/AJAX_for_n00bs](http://www.hunlock.com/blogs/AJAX_for_n00bs)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T03:51:46.023

微软刚刚在 VS2008 中添加了 jquery 智能感知。那应该回答你的问题。然而，谷歌在这里托管了几个。 [http://code.google.com/apis/ajaxlibs/](http://code.google.com/apis/ajaxlibs/) 只需在您的网页中添加一行代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T13:46:12.610

即使您使用 jQuery（我强烈推荐），除非您创建的页面只为您的每个 ajax 请求返回数据，否则您仍然需要（想要）一个服务器端的框架。

我认为asp.net ajax 的主要抱怨是它包含在客户端的所有脚本（脚本助手）。更新面板也被滥用，因为它们很容易使用。

我发现使用 jQuery，您仍然可以使用 asp.net ajax WebMethod()，但只使用 jQuery 来调用它们。

对我来说，这感觉就像两全其美。您可以使用 WebMethods 并且不会使用每个功能的一页来搞乱您的项目，但是您可以跳过在客户端包含任何 Microsoft javascript 库。

有关直接从 jQuery 调用 WebMethod 的更多信息[这里](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T14:12:03.827

看看 ASP.NET MVC。它解决了您的管理层在三个方面的担忧：

1.  它放弃了对 web 表单的使用，这可以说是 ASP.NET 体积庞大的最大原因。如果没有 Web 表单，您将“更接近于金属”进行编码，因此您可以严格控制代码和用户交互，同时仍然拥有用于状态管理的框架。
2.  它使用定义明确、易于遵循的文件夹结构来实施模型-视图-控制器 (MVC) 模型。与应该将业务逻辑与用户交互分离的 Web 表单不同，MVC 模型 **强烈鼓励**开发人员进行必要的分离。正是这种分离，不仅仅是其他任何东西，都能让你的代码变得不那么繁琐。
3.  它与 jQuery 很好地集成在一起。在视图方面，除了一些帮助类可以有效地将数据放入视图之外，您正在使用纯 HTML/CSS/JavaScript。ASP.NET MVC 官方支持 jQuery，是集成 JavaScript 的首选方式。

# java - 同步（oswego）与锁定（JDK5）

> ID：699838
> 
> 赞同：0
> 
> 时间：2009-03-31T02:49:50.743
> 
> 标签：java, multithreading, concurrency

可以肯定的是，专家能否证实

java.util.concurrent.locks.Lock

和 Doug Lea 的原创[Sync](http://gee.cs.oswego.edu/dl/classes/EDU/oswego/cs/dl/util/concurrent/Sync.html)

基本上是相同的东西，但名称不同。

*   获取与锁定
*   释放与解锁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T20:17:42.143

实现 Lock 的 ReentrantLock 包装了一个名为 Sync 的类。都是由Doug Lea写的。我建议您尝试使用 Java 中的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T03:50:45.027

值得一提的是，[java.util.concurrent.locks.Lock](http://www.docjar.com/html/api/java/util/concurrent/locks/Lock.java.html)的源代码将 Doug Lea 列为其作者。该包中的许多其他文件也是如此。

```
 /*
    * This file is available under and governed by the GNU General Public
    * License version 2 only, as published by the Free Software Foundation.
    * However, the following notice accompanied the original version of this
    * file:
    *
    * Written by Doug Lea with assistance from members of JCP JSR-166
    * Expert Group and released to the public domain, as explained at
    * http://creativecommons.org/licenses/publicdomain
    */ 
```

# java - 我可以在 Windows Mobile 6 设备上运行 java 程序吗？

> ID：699841
> 
> 赞同：0
> 
> 时间：2009-03-31T02:52:39.957
> 
> 标签：java, tcp

我需要在 Windows Mobile 6 设备中运行 java 程序。这可能吗？我需要用它做一些 tcp/ip 编程，这样我就可以与其他计算机通信。这是一个简单的计算机类项目，没什么花哨的。只是发送消息和小文件。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T02:58:39.223

我相信您可以在 Windows Mobile 上运行 J2ME 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-10T15:41:02.013

你可以在 windows mobile 上尝试这个可能的 JVM。 [http://www2s.biglobe.ne.jp/~dat/java/project/jvm/index_en.html](https://blogs.oracle.com/javamesdk/entry/jvm_for_windows_mobile) 或 [https://blogs.oracle.com/javamesdk/entry/jvm_for_windows_mobile](https://blogs.oracle.com/javamesdk/entry/jvm_for_windows_mobile)

# networking - 时移PCAP文件的工具？

> ID：699842
> 
> 赞同：1
> 
> 时间：2009-03-31T02:52:54.387
> 
> 标签：networking

有谁知道将PCAP文件作为输入并输出具有修改时间戳的相同文件的工具？

例如，假设我有一个时间范围为 2009 年 3 月 1 日下午 1:00 到下午 2:00 的 PCAP 文件，我想更改时间，以便该文件包含 2009 年 3 月 31 日下午 1:00 到下午 2:00 的时间范围。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T03:02:23.910

[查看editcap](http://www.wireshark.org/docs/man-pages/editcap.html)的 -t 选项。

# .net - Umbraco 好还是不好？

> ID：699847
> 
> 赞同：22
> 
> 时间：2009-03-31T02:55:28.420
> 
> 标签：.net, asp.net, content-management-system, umbraco

我更倾向于 CMS，因为我希望我的客户能够尽可能自给自足。无论如何，我刚刚开始评估并将用我的结论更新这一点。但是，由于我首先要评估 Umbraco，所以我想达成共识。

我对 C# 或 Vb.Net 没有偏好。所以我对任何一个都持开放态度。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-31T07:44:00.427

Umbraco CMS 是一个非常灵活的 CMS。该产品的核心代码是用 C# 编写的，但实际上您永远不必阅读 Umbraco 的源代码，因为它很容易扩展。

您可以使用 Umbraco V4 中的 .NET 母版页以及用 VB 或 C# 编写的 .NET 用户控件，无论您喜欢什么。

我建议你看看，让我知道你的想法。

这里有一些链接可以帮助您入门。

*   [http://umbraco.tv/documentation/videos/getting-started/what-is-umbraco](http://umbraco.tv/documentation/videos/getting-started/what-is-umbraco)
*   [http://umbraco.tv/documentation/videos/getting-started/installing-umbraco](http://umbraco.tv/documentation/videos/getting-started/installing-umbraco)
*   [http://www.nibble.be/?p=56](http://www.nibble.be/?p=56)
*   [http://www.nibble.be/?p=61](http://www.nibble.be/?p=61)
*   [http://our.umbraco.org](http://our.umbraco.org)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-31T15:06:38.787

我和我的公司在过去一个月左右的时间里对 Umbraco 进行了评估，看看它是否符合我们的需求。

我们正在寻找我们开发的基本内部 CMS 的开源替代品。

CMS 在 .NET 中并且易于最终用户和开发人员使用，这一点很重要。它还需要可定制和可扩展。

Umbraco 勾选了所有这些框，并且围绕它有一个活跃且乐于助人的社区。

但是，文档不是非常完整或最新的，这可能会使入门相当困难。特别是对于更复杂的实现。

另一个薄弱的领域是工作流和页面锁定，但这是在商业版本中进行的，实际上只是更大规模实施的一个问题。

掌握简单网站[Creative Website Starter](http://www.creativewebspecialist.co.uk/2009/03/06/creative-website-starter-(cws2)-for-umbraco-is-released.aspx)工具包非常出色，它为您提供了 Umbraco 工作原理以及如何实现基于 CMS 的简单网站的良好基础。

在开始实施 Umbraco 之前要做的最重要的事情是规划您的文档类型和内容类型。这是因为一旦实施，就很难在您已经创建和填充的页面上更改文档类型。无论如何，CMS 项目总是在规划阶段生死攸关，因此这与任何其他 CMS 没有什么不同。

多年来，我使用了许多不同的 CMS 平台：Immedacy、MCMS、Sitecore、Obtree、Reef、Reddot 等，我发现 Umbraco 稳定、快速且可扩展。

它有它的怪癖，并且在某些地方缺乏修饰，但总体而言，它对于中小型网站来说是一个出色的 CMS，并且经过一些调整，也适用于大型网站。

我们[The Cogworks](http://www.thecogworks.co.uk)已在 Umbraco 上落户，现在正在将我们的客户在我们的旧平台上迁移到 Umbraco 以及全新的实施。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-09-02T09:48:47.163

到目前为止，我已经使用 umbraco（第 4 版）构建了 3 个专业网站，对此我感到非常满意。关于它的最好的事情是可扩展性......而且它是免费的！任何优秀的开发人员都会很快学会它，一旦你知道它是如何工作的，那么天空就是极限。我之前使用过 XSLT，所以切换到 umbraco 对我来说更容易。

起初我担心它在大型网站中的 XML 使用，但我已经看到拥有 10K+ 页面和用户控件的大型网站在 umbraco 2 上运行，所以现在所有的恐惧都消失了。

有时缺少文档可能是个问题，但您通常可以在任何出现的情况下搜索答案。

底线：一个大耶！

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-09-02T10:03:42.097

答案是......可能是的，但这取决于。

我们仔细研究了一下，发现虽然它非常好，但如果您对想要对其进行详细控制的用户有简单或非常具体的要求，您最好自己动手。

虽然它很稳固并且得到很好的支持，但我们认为学习曲线仍然足够陡峭，以至于我们会做出合理的投资，但最终会得到比我们想要的更多的妥协。

集团中的一家姊妹公司进行了类似的练习，得出了相同的结论。两家公司都在旅游行业，我们正在构建的网站需要非常特定的结构，使用特定的数据源等等，让 Umbraco 以我们想要的方式工作与使用 .NET MVC 和从头开始一样多的工作保持完全控制。

简而言之，如果您想要一个 CMS，请先看看您的需求，然后再得出结论，您自己构建东西并不好。

（注意：我并不是说自己动手总是最好的方法，但它可以提供真正的好处，值得付出努力）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-05-03T17:50:51.723

在使用多种语言的许多 CMS 应用程序（Drupal、Joomla、Wordpress、Sitefinity、DotNetNuke 等）之后，这一切都归结为您需要做什么以及哪些功能对您最重要。每个 CMS 都有自己的优缺点列表。

开箱即用的 CMS 具有更灵活和简化的后端。但是，从 ASP.NET 方面来看，我的经验是 Umbraco 是最容易扩展和最灵活的。如果您要自己进行开发，那么限制很少，社区非常有帮助！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-22T06:20:43.577

从第 2 版开始就一直在使用 Umbraco 进行开发，而且它只会越来越强大。母版页、出色的模板引擎（一旦你习惯了 XSLT）和易于使用的 UI 是它真正的强项......

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-08-12T18:24:26.967

在几个项目中使用 Sitecore 和 Sitefinity 之后，我刚刚开始熟悉 Umbraco。我非常喜欢它，并且我喜欢前端开发人员可以完成多少基本工作，从而腾出 .NET 开发人员的时间来完成艰巨的工作。

Umbraco.tv 在让我快速上手方面发挥了巨大作用。

到目前为止，我喜欢 Umbraco 为网站建设者提供的可扩展性、简单性和控制性。

# .net - 在 DataGridView 中显示相关数据

> ID：699851
> 
> 赞同：2
> 
> 时间：2009-03-31T02:56:41.117
> 
> 标签：.net, datagridview, controls

如果有人最近使用过 Access，您可能还记得当它显示具有关系的表的数据时，每行旁边都会出现一个可扩展的小节点。单击它会在行下方显示与该行相关的其他表中的所有数据。

我基本上想在.Net中做到这一点。这是我可以使用我已经在使用的 DataGridView 做的事情，还是我需要构建/购买一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T03:03:38.107

.NET 2.0+ 中的 DataGridView 不显示 Access 等子记录。但是，.NET 1.x DataGrid 控件可以。你可以在你的项目中使用它。

您可能还希望查看： [自定义 DataGridView 以支持展开/折叠（ala TreeGridView）](http://blogs.msdn.com/markrideout/archive/2006/01/08/510700.aspx)

编辑：我要补充一件事。当我为正在编写的 .NET 2.0 应用程序调查此问题时，我打算使用 .NET 1.1 DataGrid 来实现此功能。我还研究了替代方案（例如我上面链接的组件），但最终决定不使事情复杂化，并使用两个以主从关系链接的 DataGridView。

[如何：使用两个 Windows 窗体 DataGridView 控件创建主/从窗体](http://msdn.microsoft.com/en-us/library/c12c1kx4(VS.80).aspx)

# c# - 如何找到实现给定接口的所有类？

> ID：699852
> 
> 赞同：72
> 
> 时间：2009-03-31T02:56:46.717
> 
> 标签：c#, reflection

在给定的命名空间下，我有一组实现接口的类。让我们称之为`ISomething`。我有另一个类（我们称之为`CClass`），它知道`ISomething`但不知道实现该接口的类。

我希望它`CClass`查找 的所有实现`ISomething`，实例化它的实例并执行该方法。

有人知道如何使用 C# 3.5 做到这一点吗？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-03-31T03:06:11.813

一个工作代码示例：

```
var instances = from t in Assembly.GetExecutingAssembly().GetTypes()
                where t.GetInterfaces().Contains(typeof(ISomething))
                         && t.GetConstructor(Type.EmptyTypes) != null
                select Activator.CreateInstance(t) as ISomething;

foreach (var instance in instances)
{
    instance.Foo(); // where Foo is a method of ISomething
} 
```

**编辑**添加了对无参数构造函数的检查，以便对 CreateInstance 的调用成功。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-31T03:11:39.427

您可以使用以下方法获取已加载程序集的列表：

```
Assembly assembly = System.Reflection.AppDomain.CurrentDomain.GetAssemblies() 
```

从那里，您可以获得程序集中的类型列表（假设公共类型）：

```
Type[] types = assembly.GetExportedTypes(); 
```

然后您可以通过在对象上找到该接口来询问每种类型是否支持该接口：

```
Type interfaceType = type.GetInterface("ISomething"); 
```

不确定是否有更有效的方法通过反射来做到这一点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-31T03:04:50.350

使用 Linq 的示例：

```
var types =
  myAssembly.GetTypes()
            .Where(m => m.IsClass && m.GetInterface("IMyInterface") != null); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-01-24T10:03:50.643

```
foreach (Type t in Assembly.GetCallingAssembly().GetTypes())
{
    if (t.GetInterface("ITheInterface") != null)
    {
        ITheInterface executor = Activator.CreateInstance(t) as ITheInterface;
        executor.PerformSomething();
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T03:05:49.847

您可以使用以下内容并根据您的需要进行定制。

```
var _interfaceType = typeof(ISomething);
var currentAssembly = System.Reflection.Assembly.GetExecutingAssembly();
var types = GetType().GetNestedTypes();

foreach (var type in types)
{
    if (_interfaceType.IsAssignableFrom(type) && type.IsPublic && !type.IsInterface)
    {
        ISomething something = (ISomething)currentAssembly.CreateInstance(type.FullName, false);
        something.TheMethod();
    }
} 
```

此代码可以使用一些性能增强功能，但这是一个开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-22T14:39:19.850

也许我们应该走这条路

```
foreach ( var instance in Assembly.GetExecutingAssembly().GetTypes().Where(a => a.GetConstructor(Type.EmptyTypes) != null).Select(Activator.CreateInstance).OfType<ISomething>() ) 
   instance.Execute(); 
```

# database - 在 Windows 安全模式下运行 SQL Server 2005

> ID：699862
> 
> 赞同：1
> 
> 时间：2009-03-31T03:03:20.557
> 
> 标签：database, sql-server-2005, windows-vista, restore, safe-mode

我的电脑最近崩溃了，我只能在安全模式下运行它。我需要备份一个 SQL Server 2005 数据库并将其转移到一台可以工作的计算机上。

无论如何在 Windows Vista 安全模式下运行 SQL server 2005 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T04:15:36.327

我很确定 SQL 不会启动。

但是，您可以获取 MDF、NDF（如果有）和 LDF 文件并将它们复制到另一台计算机，将它们附加到该计算机上的 SQL 实例，您将启动并运行。

# sql - 需要使用 JOIN 优化 SQL 查询的技巧

> ID：699865
> 
> 赞同：2
> 
> 时间：2009-03-31T03:03:43.190
> 
> 标签：sql, optimization, join, sybase

在查看过去几天时，我正在编写的查询运行良好，一旦我经过一个多星期，它就会爬行（约 20 分钟）。我将 3 张桌子连接在一起。我想知道我应该寻找什么东西来让它运行得更快。我真的不知道该帖子还需要哪些其他信息。

编辑：更多信息：db 是 Sybase 10。查询：

```
SELECT a.id, a.date, a.time, a.signal, a.noise,
b.signal_strength, b.base_id, b.firmware,
a.site, b.active, a.table_key_id
FROM adminuser.station AS a
JOIN adminuser.base AS b
ON a.id = b.base_id
WHERE a.site = 1234 AND a.date >= '2009-03-20' 
```

我还取出了 3rd JOIN，它仍然运行得非常慢。我应该尝试另一种 JOIN 方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T03:16:14.707

*通过在 SQL Server Management Studio 中运行查询并设置包括实际执行计划*选项（在*查询*菜单中） ，您可以获得大量信息（假设您在此处使用 MSSQL ）。

这将向您显示 SQLServer 为执行查询而执行的步骤图 - 每个步骤的相对成本。

下一步是稍微修改查询（尝试以不同的方式进行），然后同时运行新版本和旧版本。您将获得两个执行计划，其相对成本不仅针对每个步骤，而且针对查询的两个版本！因此，您可以客观地判断您是否正在取得进展。

我在调试/优化查询时一直这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T13:20:05.877

我不太了解 Sybase 10，但尝试运行该查询 10 天，然后在一段时间内的每一天分别运行 10 次并比较时间。如果第一种情况下的时间要长得多，那么您可能已经达到了数据库缓存限制。

解决方案不是简单地在循环中运行较短时间的查询（在程序中，而不是 SQL）。如果表 A 按日期分区，则效果特别好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T03:45:37.943

确保您在外键上有索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T03:05:27.353

这听起来更像是您有内存泄漏或没有在您的客户端代码中关闭数据库连接，而不是查询有任何问题。

[编辑]
没关系：您的意思是查询日期范围而不是服务器处于活动状态的持续时间。我会留下这个来帮助其他人避免同样的困惑。

此外，如果您可以发布 sql 查询，即使您需要先对其进行一些混淆，也会有所帮助，并且最好检查您的日期列上是否有索引以及较长范围返回的记录数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T03:11:44.530

如果您的数据库支持，您可能需要考虑使用 PARTITION 作为日期范围。我听说这有很大帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T03:59:07.193

抓住这本书“Professional SQL Server 2005 Performance Tuning”，它非常棒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T12:40:47.280

你没有提到你的数据库。如果不是 SQL Server，如何获取数据的细节可能会有所不同，但建议基本相同。

看看索引，当然，但首先要做的是遵循 Blorgbeard 的建议并使用 Management Studio 扫描执行计划（同样，如果您正在运行 SQL Server）。

我猜你会看到，对于小的日期范围，优化器会选择一个合理的查询计划，但是当日期范围很大时，它会选择完全不同的东西，可能涉及表扫描或索引扫描，并且可能导致非常大的临时记录集的连接。执行计划分析器将揭示所有这些。

扫描意味着优化器认为对整个表或整个索引进行打磨比寻找特定值更便宜。

您最终想要做的是获取索引和查询的语法设置，以便您在查询的查询计划中保留索引搜索，无论日期范围如何，或者，如果失败，您需要的扫描也会被过滤因为您可以设法最小化临时记录集的大小，从而避免过多的读取和 I/O。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T21:52:07.923

```
SELECT

 a.id, a.date, a.time, a.signal, a.noise,a.site, b.active, a.table_key_id,
 b.signal_strength, b.base_id, b.firmware

FROM 

( SELECT * FROM adminuser.station 
      WHERE site = 1234 AND date >= '2009-03-20') AS a
JOIN 

    adminuser.base AS b
ON

    a.id = b.base_id 
```

有点重写查询，以便首先过滤所需的行然后执行连接，而不是执行连接然后过滤结果。

而不是从子查询中提取 * 您可以只选择您想要的列，这可能没什么帮助。

可能这对加速事情没有什么帮助。

虽然这在 MySql 中有效，但我不确定 sysbase 语法。

# python - Python int 到二进制字符串？

> ID：699866
> 
> 赞同：695
> 
> 时间：2009-03-31T03:04:37.603
> 
> 标签：python, binary, string.format

是否有任何罐装 Python 方法可以将整数（或长整数）转换为 Python 中的二进制字符串？

谷歌上有无数的 dec2bin() 函数......但我希望我可以使用内置函数/库。

* * *

## 回答 #1

> 赞同：969
> 
> 时间：2009-03-31T03:17:18.057

Python 的字符串格式方法可以采用格式规范。

```
>>> "{0:b}".format(37)
'100101' 
```

[Python 2 的格式规范文档](https://docs.python.org/2/library/string.html#formatspec)

[Python 3 的格式规范文档](https://docs.python.org/3/library/string.html#formatspec)

* * *

## 回答 #2

> 赞同：592
> 
> 时间：2009-03-31T03:17:30.007

如果您正在寻找[`bin()`](http://docs.python.org/library/functions.html#bin)的等价物`hex()`，它是在 python 2.6 中添加的。

例子：

```
>>> bin(10)
'0b1010' 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-03-31T03:25:52.590

Python 实际上*确实*为此内置了一些东西，可以执行诸如 之类的操作`'{0:b}'.format(42)`，这将为您提供`42`或的位模式（在字符串中） `101010`。

* * *

对于更一般的哲学，没有任何语言或库会为其用户群提供他们想要的*一切*。如果您在一个不能提供您真正需要的环境中工作，您应该在开发时收集代码片段，以确保您永远不必重复编写相同的东西。比如伪代码：

```
define intToBinString, receiving intVal:
    if intVal is equal to zero:
        return "0"
    set strVal to ""
    while intVal is greater than zero:
        if intVal is odd:
            prefix "1" to strVal
        else:
            prefix "0" to strVal
        divide intVal by two, rounding down
    return strVal 
```

它将根据十进制值构造您的二进制字符串。请记住，这是一种通用的伪代码，尽管它可能不是*最*有效的方法，但对于您似乎提出的迭代，它不会有太大的不同。它实际上只是作为如何完成的指南。

总体思路是使用以下代码（按优先顺序）：

*   语言或内置库。
*   具有合适许可证的第三方库。
*   你自己的收藏。
*   你需要写一些新的东西（并保存在你自己的收藏中以备后用）。

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2014-02-12T15:33:28.967

如果你想要一个没有 0b 前缀的文本表示，你可以使用这个：

```
get_bin = lambda x: format(x, 'b')

print(get_bin(3))
>>> '11'

print(get_bin(-3))
>>> '-11' 
```

当你想要一个 n 位表示时：

```
get_bin = lambda x, n: format(x, 'b').zfill(n)
>>> get_bin(12, 32)
'00000000000000000000000000001100'
>>> get_bin(-12, 32)
'-00000000000000000000000000001100' 
```

或者，如果您更喜欢使用功能：

```
def get_bin(x, n=0):
    """
    Get the binary representation of x.

    Parameters
    ----------
    x : int
    n : int
        Minimum number of digits. If x needs less digits in binary, the rest
        is filled with zeros.

    Returns
    -------
    str
    """
    return format(x, 'b').zfill(n) 
```

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2013-12-17T19:39:08.187

作为参考：

```
def toBinary(n):
    return ''.join(str(1 & int(n) >> i) for i in range(64)[::-1]) 
```

该函数可以转换一个大至 的正整数`18446744073709551615`，表示为字符串`'1111111111111111111111111111111111111111111111111111111111111111'`。

可以修改它以提供更大的整数，尽管它可能不如`"{0:b}".format()`or方便`bin()`。

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2018-11-13T07:04:23.923

这适用于 python 3，它保留前导零！

```
print(format(0, '08b')) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/DootV.png)](https://i.stack.imgur.com/DootV.png)

* * *

## 回答 #7

> 赞同：30
> 
> 时间：2020-08-19T10:37:25.400

我很惊讶没有提到使用 Python 3.6 及更高版本支持的格式化字符串来完成此任务的好方法。TLDR：

```
>>> number = 1
>>> f'0b{number:08b}'
'0b00000001' 
```

# 更长的故事

这是 Python 3.6 中可用的格式化字符串的功能：

```
>>> x, y, z = 1, 2, 3
>>> f'{x} {y} {2*z}'
'1 2 6' 
```

您也可以请求二进制文件：

```
>>> f'{z:b}'
'11' 
```

指定宽度：

```
>>> f'{z:8b}'
'      11' 
```

请求零填充：

```
f'{z:08b}'
'00000011' 
```

并添加通用前缀来表示二进制数：

```
>>> f'0b{z:08b}'
'0b00000011' 
```

您也可以让 Python 为您添加前缀，但我不喜欢上面的版本，因为您必须考虑前缀的宽度：

```
>>> f'{z:#010b}'
'0b00000011' 
```

[有关Formatted string literals](https://docs.python.org/3/reference/lexical_analysis.html#f-strings)和[Format Specification Mini-Language](https://docs.python.org/3/library/string.html#format-specification-mini-language)的官方文档中提供了更多信息。

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2016-01-19T21:29:47.980

一种简单的方法是使用字符串格式，请参阅此[页面](https://docs.python.org/3/library/string.html#formatspec)。

```
>> "{0:b}".format(10)
'1010' 
```

如果你想有一个固定长度的二进制字符串，你可以使用这个：

```
>> "{0:{fill}8b}".format(10, fill='0')
'00001010' 
```

如果需要二进制补码，则可以使用以下行：

```
'{0:{fill}{width}b}'.format((x + 2**n) % 2**n, fill='0', width=n) 
```

其中 n 是二进制字符串的宽度。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2015-06-15T02:12:19.757

带**lambda**的单线：

```
>>> binary = lambda n: '' if n==0 else binary(n/2) + str(n%2) 
```

测试：

```
>>> binary(5)
'101' 
```

**编辑**：

但是之后 ：（

```
t1 = time()
for i in range(1000000):
     binary(i)
t2 = time()
print(t2 - t1)
# 6.57236599922 
```

相比

```
t1 = time()
for i in range(1000000):
    '{0:b}'.format(i)
t2 = time()
print(t2 - t1)
# 0.68017411232 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2019-06-07T20:41:01.510

由于前面的答案大多使用 format()，这里是一个 f-string 实现。

```
integer = 7
bit_count = 5
print(f'{integer:0{bit_count}b}') 
```

输出：

> 00111

为方便起见，这里是格式化字符串文字的 python 文档链接：[https](https://docs.python.org/3/reference/lexical_analysis.html#f-strings) ://docs.python.org/3/reference/lexical_analysis.html#f-strings 。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2015-05-02T02:27:09.470

替代方案摘要：

```
n=42
assert  "-101010" == format(-n, 'b')
assert  "-101010" == "{0:b}".format(-n)
assert  "-101010" == (lambda x: x >= 0 and str(bin(x))[2:] or "-" + str(bin(x))[3:])(-n)
assert "0b101010" == bin(n)
assert   "101010" == bin(n)[2:]   # But this won't work for negative numbers. 
```

贡献者包括[John Fouhy](//stackoverflow.com/a/699892/673991)、[Tung Nguyen](//stackoverflow.com/a/699891/673991)、[mVChr](//stackoverflow.com/questions/699866#comment-29223504)、[Martin Thoma](https://stackoverflow.com/a/21732313/673991)。和马丁·彼得斯。

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2018-12-07T15:17:31.797

```
>>> format(123, 'b')
'1111011' 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2018-06-21T22:19:56.383

你可以这样做：

```
bin(10)[2:] 
```

或者 ：

```
f = str(bin(10))
c = []
c.append("".join(map(int, f[2:])))
print c 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2018-12-18T19:32:04.047

对于我们这些需要将有符号整数（范围 -2**(digits-1) 到 2**(digits-1)-1）转换为 2 的补码二进制字符串的人来说，这有效：

```
def int2bin(integer, digits):
    if integer >= 0:
        return bin(integer)[2:].zfill(digits)
    else:
        return bin(2**digits + integer)[2:] 
```

这会产生：

```
>>> int2bin(10, 8)
'00001010'
>>> int2bin(-10, 8)
'11110110'
>>> int2bin(-128, 8)
'10000000'
>>> int2bin(127, 8)
'01111111' 
```

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2015-08-27T03:39:36.373

使用 numpy pack/unpackbits，他们是你最好的朋友。

```
Examples
--------
>>> a = np.array([[2], [7], [23]], dtype=np.uint8)
>>> a
array([[ 2],
       [ 7],
       [23]], dtype=uint8)
>>> b = np.unpackbits(a, axis=1)
>>> b
array([[0, 0, 0, 0, 0, 0, 1, 0],
       [0, 0, 0, 0, 0, 1, 1, 1],
       [0, 0, 0, 1, 0, 1, 1, 1]], dtype=uint8) 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2020-06-26T02:49:12.653

接受的答案没有解决负数，我将对此进行介绍。除了上面的答案，您还可以只使用[bin](https://docs.python.org/3/library/functions.html#bin)和[hex](https://docs.python.org/3/library/functions.html#hex)函数。在相反的方向，使用二进制表示法：

```
>>> bin(37)
'0b100101'
>>> 0b100101
37 
```

但是对于负数，事情会变得有点复杂。该问题未指定您要如何处理负数。

Python 只是添加了一个负号，所以 -37 的结果是这样的：

```
>>> bin(-37)
'-0b100101' 
```

在计算机/硬件二进制数据中，不存在负号。我们只有 1 和 0。因此，如果您正在读取或生成要由其他软件/硬件处理的二进制数据流，您首先需要知道所使用的符号。

一种表示法是[符号幅度表示法](https://en.wikipedia.org/wiki/Signed_number_representations#Signed_magnitude_representation)，其中第一位表示负号，其余的是实际值。在这种情况下， -37 将是`0b1100101`37 将是`0b0100101`。这看起来像 python 产生的，但只是在前面添加一个 0 或 1 来表示正数/负数。

更常见[的是二进制补码表示法](https://en.wikipedia.org/wiki/Signed_number_representations#Two%27s_complement)，它看起来更复杂，结果与 python 的字符串格式有很大不同。您可以阅读链接中的详细信息，但使用 8 位有符号整数 -37 将是`0b11011011`37 将是`0b00100101`。

Python 没有简单的方法来生成这些二进制表示。您可以使用[numpy](https://numpy.org/doc/stable/user/basics.types.html)将二进制补码值转换为 python 整数：

```
>>> import numpy as np
>>> np.int8(0b11011011)
-37
>>> np.uint8(0b11011011)
219
>>> np.uint8(0b00100101)
37
>>> np.int8(0b00100101)
37 
```

但我不知道用内置函数做相反的简单方法。[bitstring 包](https://bitstring.readthedocs.io/en/latest/)可以提供帮助。

```
>>> from bitstring import BitArray
>>> arr = BitArray(int=-37, length=8)
>>> arr.uint
219
>>> arr.int
-37
>>> arr.bin
'11011011'
>>> BitArray(bin='11011011').int
-37
>>> BitArray(bin='11011011').uint
219 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2020-10-27T13:47:52.940

Python 3.6 添加了一种新的字符串格式化方法，称为格式化字符串文字或“f-strings”。例子：

```
name = 'Bob'
number = 42
f"Hello, {name}, your number is {number:>08b}" 
```

输出将是“你好，鲍勃，你的号码是 00001010！”

可以在此处找到有关此问题的讨论 -[这里](https://stackoverflow.com/questions/52850229/how-to-print-binary-numbers-using-f-string-instead-of-format)

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2009-03-31T03:08:37.390

除非我误解了二进制字符串的含义，否则我认为您要查找的模块是[struct](http://www.python.org/doc/2.5.2/lib/module-struct.html)

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2014-10-04T02:07:16.307

```
def binary(decimal) :
    otherBase = ""
    while decimal != 0 :
        otherBase  =  str(decimal % 2) + otherBase
        decimal    //=  2
    return otherBase

print binary(10) 
```

输出：

> 1010

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2014-10-18T22:45:32.850

通过使用按位运算符，使用另一种算法的另一种解决方案。

```
def int2bin(val):
    res=''
    while val>0:
        res += str(val&1)
        val=val>>1     # val=val/2 
    return res[::-1]   # reverse the string 
```

更快的版本，无需反转字符串。

```
def int2bin(val):
   res=''
   while val>0:
       res = chr((val&1) + 0x30) + res
       val=val>>1    
   return res 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2014-03-15T13:18:44.543

这是我刚刚实现的代码。这不是一种**方法**，但您可以将其用作**即用型功能**！

```
def inttobinary(number):
  if number == 0:
    return str(0)
  result =""
  while (number != 0):
      remainder = number%2
      number = number/2
      result += str(remainder)
  return result[::-1] # to invert the string 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2014-11-29T12:45:04.597

```
n=input()
print(bin(n).replace("0b", "")) 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2019-04-30T09:28:05.640

## [`numpy.binary_repr(num, width=None)`](https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.binary_repr.html#numpy-binary-repr)

来自上述文档链接的示例：

> ```
> >>> np.binary_repr(3)
> '11'
> >>> np.binary_repr(-3)
> '-11'
> >>> np.binary_repr(3, width=4)
> '0011' 
> ```
> 
> 当输入数为负数且指定宽度时，返回二进制补码：
> 
> ```
> >>> np.binary_repr(-3, width=3)
> '101'
> >>> np.binary_repr(-3, width=5)
> '11101' 
> ```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2014-04-26T12:42:23.053

有点类似的解决方案

```
def to_bin(dec):
    flag = True
    bin_str = ''
    while flag:
        remainder = dec % 2
        quotient = dec / 2
        if quotient == 0:
            flag = False
        bin_str += str(remainder)
        dec = quotient
    bin_str = bin_str[::-1] # reverse the string
    return bin_str 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2014-07-18T14:35:09.267

这是使用 divmod() 函数的简单解决方案，它返回提醒和不带分数的除法结果。

```
def dectobin(number):
    bin = ''
    while (number >= 1):
        number, rem = divmod(number, 2)
        bin = bin + str(rem)
    return bin 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2015-10-23T12:53:23.637

这是另一种使用常规数学的方法，没有循环，只有递归。（平凡的案例 0 什么也不返回）。

```
def toBin(num):
  if num == 0:
    return ""
  return toBin(num//2) + str(num%2)

print ([(toBin(i)) for i in range(10)])

['', '1', '10', '11', '100', '101', '110', '111', '1000', '1001'] 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2017-08-29T08:11:23.470

具有 DEC、BIN、HEX 的所有必要功能的计算器：（使用 Python 3.5 制作和测试）

您可以更改输入的测试编号并获取转换后的编号。

```
# CONVERTER: DEC / BIN / HEX

def dec2bin(d):
    # dec -> bin
    b = bin(d)
    return b

def dec2hex(d):
    # dec -> hex
    h = hex(d)
    return h

def bin2dec(b):
    # bin -> dec
    bin_numb="{0:b}".format(b)
    d = eval(bin_numb)
    return d,bin_numb

def bin2hex(b):
    # bin -> hex
    h = hex(b)
    return h

def hex2dec(h):
    # hex -> dec
    d = int(h)
    return d

def hex2bin(h):
    # hex -> bin
    b = bin(h)
    return b

## TESTING NUMBERS
numb_dec = 99
numb_bin = 0b0111 
numb_hex = 0xFF

## CALCULATIONS
res_dec2bin = dec2bin(numb_dec)
res_dec2hex = dec2hex(numb_dec)

res_bin2dec,bin_numb = bin2dec(numb_bin)
res_bin2hex = bin2hex(numb_bin)

res_hex2dec = hex2dec(numb_hex)
res_hex2bin = hex2bin(numb_hex)

## PRINTING
print('------- DECIMAL to BIN / HEX -------\n')
print('decimal:',numb_dec,'\nbin:    ',res_dec2bin,'\nhex:    ',res_dec2hex,'\n')

print('------- BINARY to DEC / HEX -------\n')
print('binary: ',bin_numb,'\ndec:    ',numb_bin,'\nhex:    ',res_bin2hex,'\n')

print('----- HEXADECIMAL to BIN / HEX -----\n')
print('hexadec:',hex(numb_hex),'\nbin:    ',res_hex2bin,'\ndec:    ',res_hex2dec,'\n') 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2018-04-03T16:16:03.857

> ***计算二进制数：***

```
print("Binary is {0:>08b}".format(16)) 
```

> ***要计算数字的十六进制小数***：

```
print("Hexa Decimal is {0:>0x}".format(15)) 
```

> **计算所有二进制数直到 16::**

```
for i in range(17):
   print("{0:>2}: binary is {0:>08b}".format(i)) 
```

> **计算 Hexa 十进制数直到 17**

```
 for i in range(17):
    print("{0:>2}: Hexa Decimal is {0:>0x}".format(i))
##as 2 digit is enogh for hexa decimal representation of a number 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2017-04-27T08:53:35.213

```
try:
    while True:
        p = ""
        a = input()
        while a != 0:
            l = a % 2
            b = a - l
            a = b / 2
            p = str(l) + p
        print(p)
except:
    print ("write 1 number") 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2018-05-29T20:22:52.960

我找到了一种使用矩阵运算将十进制转换为二进制的方法。

```
import numpy as np
E_mat = np.tile(E,[1,M])
M_order = pow(2,(M-1-np.array(range(M)))).T
bindata = np.remainder(np.floor(E_mat /M_order).astype(np.int),2) 
```

`E`是输入十进制数据，`M`是二进制指令。`bindata`是输出二进制数据，格式为1×M二进制矩阵。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2019-05-01T06:32:37.673

我觉得[Martijn Pieter 的评论](https://stackoverflow.com/questions/699866/python-int-to-binary-string#comment56144399_21732313)值得强调作为答案：

```
binary_string = format(value, '0{}b'.format(width)) 
```

对我来说是既清晰又多才多艺。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2016-12-16T14:58:40.070

如果你愿意放弃“纯”Python，但获得大量火力，[这里有 Sage](http://doc.sagemath.org/html/en/reference/rings_standard/sage/rings/integer.html#sage.rings.integer.Integer.binary) -[示例](http://sagecell.sagemath.org/?z=eJxLVLBVMDTl5UrUS8rMSyyq1NAEACiZBME=&lang=sage)：

```
sage: a = 15
sage: a.binary()
'1111' 
```

您会注意到它以字符串形式返回，因此要将其用作数字，您需要执行类似的操作

```
sage: eval('0b'+b)
15 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2017-03-10T16:14:00.437

这是一个简单的二进制到十进制转换器，它不断循环

```
t = 1
while t > 0:
    binaryNumber = input("Enter a binary No.")
    convertedNumber = int(binaryNumber, 2)

    print(convertedNumber)

print("") 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2019-04-18T06:20:12.560

这是我的答案，效果很好..！

```
def binary(value) :
    binary_value = ''
    while value !=1  :
        binary_value += str(value%2)
        value = value//2
    return '1'+binary_value[::-1] 
```

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2014-04-26T05:41:26.533

与Yusuf Yazici的回答类似

```
def intToBin(n):
    if(n < 0):
        print "Sorry, invalid input."
    elif(n == 0):
        print n
    else:
        result = ""
        while(n != 0):
            result += str(n%2)
            n /= 2
        print result[::-1] 
```

我对其进行了调整，以便唯一被变异的变量是结果（当然还有 n）。

如果您需要在其他地方使用此功能（即让另一个模块使用结果），请考虑以下调整：

```
def intToBin(n):
    if(n < 0):
        return -1
    elif(n == 0):
        return str(n)
    else:
        result = ""
        while(n != 0):
            result += str(n%2)
            n //= 2            #added integer division
        return result[::-1] 
```

所以 -1 将是您的标记*值*，表明转换失败。（这是假设您只转换正数，无论它们是整数还是长整数）。

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2020-03-15T18:10:10.253

`divmod`这是一个用于构建二进制列表的（已调试）程序：

**程序**

```
while True:
    indecimal_str = input('Enter positive(decimal) integer: ')
    if indecimal_str == '':
        raise SystemExit
    indecimal_save = int(indecimal_str)
    if indecimal_save < 1:
        print('Rejecting input, try again')
        print()
        continue
    indecimal = int(indecimal_str)
    exbin = []
    print(indecimal, '<->', exbin)
    while True:
        if indecimal == 0:
            print('Conversion:', indecimal_save, '=', "".join(exbin))
            print()
            break
        indecimal, r = divmod(indecimal, 2)
        if r == 0:
            exbin.insert(0, '0')
        else:
            exbin.insert(0, '1')
        print(indecimal, '<->', exbin) 
```

**输出**

```
Enter positive(decimal) integer: 8
8 <-> []
4 <-> ['0']
2 <-> ['0', '0']
1 <-> ['0', '0', '0']
0 <-> ['1', '0', '0', '0']
Conversion: 8 = 1000

Enter positive(decimal) integer: 63
63 <-> []
31 <-> ['1']
15 <-> ['1', '1']
7 <-> ['1', '1', '1']
3 <-> ['1', '1', '1', '1']
1 <-> ['1', '1', '1', '1', '1']
0 <-> ['1', '1', '1', '1', '1', '1']
Conversion: 63 = 111111

Enter positive(decimal) integer: 409
409 <-> []
204 <-> ['1']
102 <-> ['0', '1']
51 <-> ['0', '0', '1']
25 <-> ['1', '0', '0', '1']
12 <-> ['1', '1', '0', '0', '1']
6 <-> ['0', '1', '1', '0', '0', '1']
3 <-> ['0', '0', '1', '1', '0', '0', '1']
1 <-> ['1', '0', '0', '1', '1', '0', '0', '1']
0 <-> ['1', '1', '0', '0', '1', '1', '0', '0', '1']
Conversion: 409 = 110011001 
```

# php - 输入邮件（）函数的 $message 时 PHP _EOL 不起作用

> ID：699872
> 
> 赞同：0
> 
> 时间：2009-03-31T03:06:37.410
> 
> 标签：php, html, email, html-email

我在构建电子邮件的消息正文时使用了 PHP _EOL，但换行符没有通过，整个消息正文在生成的电子邮件中以一长行结束。无论多部分或仅 html 消息，都会发生这种情况。仅作为文本发送它工作正常，但我当然想发送多部分消息....有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T03:36:58.790

嗯。如果您的 HTML 电子邮件中没有换行符，可能是因为 \n 和 \r\n 都不是 HTML 中的换行符；<br /> 标签是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T03:18:15.027

我以前从未使用过 PHP_EOL，但我想知道它是否设置为您的服务器类型，而不是收件人的类型。我看不出常数对所有收件人都是正确的，这是没有意义的。

通常只需要'\n'...在某些情况下，您可能需要'\r\n'，具体取决于所涉及的协议。你用什么来发送电子邮件？你用什么来查看邮件？

# pdf - 将带有图章和添加文本的 Acrobat PDF 保存为基础文档

> ID：699874
> 
> 赞同：0
> 
> 时间：2009-03-31T03:07:08.690
> 
> 标签：pdf

我在 Acrobat 中的 PDF 文档中添加了几个图章和文本框。我想保存 PDF，但将新图章和文本框添加到基础文档中。我不希望它们被单击并选择图章或文本框。怎么可能呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T03:21:34.770

如果您拥有 PDF 的编辑权限，您应该可以保存它。但是，如果您不这样做，那么您只能使用 Acrobat 中的注释工具执行的操作（假设您正在使用它来编辑 PDF）。

# java - 有没有一种简单的方法可以在 Java 中将两列输出到控制台？

> ID：699878
> 
> 赞同：39
> 
> 时间：2009-03-31T03:08:43.100
> 
> 标签：java

正如标题所说，有没有一种简单的方法可以在 Java 中将两列输出到控制台？

我知道`\t`，但是在使用 printf 时，我还没有找到一种基于特定列的空间方法。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-03-31T03:21:16.877

使用宽度和精度说明符，设置为相同的值。这将填充太短的字符串，并截断太长的字符串。'-' 标志将左对齐列中的值。

```
System.out.printf("%-30.30s  %-30.30s%n", v1, v2); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-05-19T04:37:32.367

我没有使用 Formatter 类就做到了：

```
 System.out.printf("%-10s %-10s %-10s\n", "osne", "two", "thredsfe");
System.out.printf("%-10s %-10s %-10s\n", "one", "tdsfwo", "thsdfree");
System.out.printf("%-10s %-10s %-10s\n", "onsdfe", "twdfo", "three");
System.out.printf("%-10s %-10s %-10s\n", "odsfne", "twsdfo", "thdfree");
System.out.printf("%-10s %-10s %-10s\n", "osdne", "twdfo", "three");
System.out.printf("%-10s %-10s %-10s\n", "odsfne", "tdfwo", "three"); 
```

输出是

```
osne       two        thredsfe  
one        tdsfwo     thsdfree  
onsdfe     twdfo      three     
odsfne     twsdfo     thdfree   
osdne      twdfo      three     
odsfne     tdfwo      three 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-10-31T11:58:13.153

迟到的答案，但如果你不想硬编码宽度，那么像这样工作的东西怎么样：

```
public static void main(String[] args) {
    new Columns()
        .addLine("One", "Two", "Three", "Four")
        .addLine("1", "2", "3", "4")
        .print()
    ;
} 
```

并显示：

```
One Two Three Four 
1   2   3     4 
```

好吧，只需要：

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;  

public class Columns {

    List<List<String>> lines = new ArrayList<>();
    List<Integer> maxLengths = new ArrayList<>();
    int numColumns = -1;

    public Columns addLine(String... line) {

        if (numColumns == -1){
            numColumns = line.length;
            for(int column = 0; column < numColumns; column++) {
                maxLengths.add(0);
            }
        }

        if (numColumns != line.length) {
            throw new IllegalArgumentException();
        }

        for(int column = 0; column < numColumns; column++) {
            int length = Math
                .max( 
                    maxLengths.get(column), 
                    line[column].length() 
                )
            ;
            maxLengths.set( column, length );
        }

        lines.add( Arrays.asList(line) );

        return this;
    }

    public void print(){
        System.out.println( toString() );
    }

    public String toString(){
        String result = "";
        for(List<String> line : lines) {
            for(int i = 0; i < numColumns; i++) {
                result += pad( line.get(i), maxLengths.get(i) + 1 );                
            }
            result += System.lineSeparator();
        }
        return result;
    }

    private String pad(String word, int newLength){
        while (word.length() < newLength) {
            word += " ";            
        }       
        return word;
    }
} 
```

由于在所有行都完成之前它不会打印，因此它可以了解列的宽度。无需硬编码宽度。

# c# - 存储 T4 配置设置的最佳方式

> ID：699880
> 
> 赞同：6
> 
> 时间：2009-03-31T03:10:10.320
> 
> 标签：c#, visual-studio, t4

我需要使用 Visual Studio T4（模板）创建一些文件。将一些配置设置导入多个 .tt 文件并在模板代码部分中访问它的最佳方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T10:59:14.803

存储配置的最简单方法是将其作为代码放置在共享的 .tt 文件中，您可以从多个模板中包含该文件（即，如果您需要连接字符串，请将其设置为类功能块中的常量）。但是，如果这不是一个选项并且您需要访问 .config 文件中的设置，我同意 John 的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T13:09:50.863

我会以与任何普通代码相同的方式执行此操作。使用 AppSettings 或自定义配置部分。如果你经常这样做，你应该创建一个[自定义指令处理器](http://msdn.microsoft.com/en-us/library/bb126315.aspx)。这可能会发出一个属性，授予您访问自定义配置的权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T03:53:11.310

我对 T4 了解不多，但似乎在听[Scott Hanselman 对 Kathleen Dollard 的采访时](http://www.hanselman.com/blog/HanselminutesPodcast152CodeGenerationAndT4WithKathleenDollard.aspx)，她说原生 Visual Studio T4 支持不允许多个文件。我似乎记得她提到了一个与 T4 一起工作的外部线束，但我知道他们提到了[Clarius Visual T4](http://www.visualt4.com/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T05:11:04.197

好吧，看看[Oleg Sych 的博客](http://www.olegsych.com/)——他是 T4 Toolbox 的作者，他展示了如何输出到多个文件。不确定 T4Toolbox 是否还包括对配置的支持——值得一看！

他的博客很棒——里面有很多 T4 的东西。

马克

# .net - WPF 列表框空数据模板

> ID：699881
> 
> 赞同：54
> 
> 时间：2009-03-31T03:11:12.283
> 
> 标签：.net, wpf, listbox, datatemplate

我想知道人们如何处理没有项目的 ListBox 控件？例如，我想绑定一个搜索结果列表，但如果没有找到结果，我想显示“未找到结果”。

我目前解决此问题的方法是，如果结果集计数 = 0，我将隐藏列表框并显示带有“未找到结果”消息的标签。理想情况下，我想要 ASP .NET datagrid EmptyTemplate 解决方案。

干杯

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-03-31T03:16:40.460

我在这段代码上取得了一些成功：

```
<Style TargetType="ListBox" x:Key="ListStyle" BasedOn="{StaticResource {x:Type ListBox}}">
    <Style.Triggers>
        <DataTrigger 
            Binding="{Binding RelativeSource={x:Static RelativeSource.Self}, Path=Items.Count}" 
            Value="0"
            >
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <TextBlock>No items to display</TextBlock>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </DataTrigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-02-22T11:49:26.877

基于@Matt Hamilton 接受的答案，作为参考，我创建了一个不需要绑定的变体，因为它使用 的`HasItems`属性`ListBox`来触发空模板：

```
<ListBox.Style>
    <Style x:Key="EmptyListStyle"
           TargetType="ListBox"
           BasedOn="{StaticResource {x:Type ListBox}}">
        <Style.Triggers>
            <!-- Use ListBox.HasItems instead of Binding -->
            <Trigger Property="HasItems" Value="False">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <TextBlock>No items to display</TextBlock>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>
</ListBox.Style> 
```

这允许全局使用样式，而不必知道列表绑定到的属性名称。`CollectionViewSource`我发现它在绑定到XAML 中定义的对象时很有用。

我不知道这种方法的任何缺点，如果您发现任何缺点，欢迎发表评论。

# sql-server - SQL Server Compact - 架构管理

> ID：699884
> 
> 赞同：5
> 
> 时间：2009-03-31T03:12:24.230
> 
> 标签：sql-server, sql-server-ce

我一直在寻找一个好的解决方案来实现在[SQL Server Compact](http://en.wikipedia.org/wiki/SQL_Server_Compact) 3.5 数据库上管理模式的想法。

[我知道在SQL Server Express](http://en.wikipedia.org/wiki/SQL_Server_Express) 、SQL Server Standard、SQL Server Enterprise上管理架构的几种方法，但精简版不支持使用相同方法所需的必要工具。

有什么建议/提示吗？

* * *

我应该将其扩展为适用于 100 多个具有包装软件的客户。随着系统的变化，我需要将更新脚本与新的二进制文件一起发布到客户端。我一直在寻找一种体面的方法来发布它，而不必只给客户一个脚本文件并说“在 SSMSE 中运行它”。大多数客户都没有能力做这样的野兽。

我的一个朋友披露了一个关于如何处理我的任务中的 SQL Server 部分的部分脚本，但从未在 Compact Edition 上工作过。看来我要靠自己了。

我认为我已经决定要做的，并且需要一个“极客周”来完成，是编写某种工具，类似于[WiX](http://en.wikipedia.org/wiki/WiX)和[NAnt](http://en.wikipedia.org/wiki/NAnt)的工作原理，这样我就可以编写一个过分热心的 XML 文档处理工作。

如果我认为值得，我会在 CodePlex 和/或[The Code Project](http://en.wikipedia.org/wiki/The_Code_Project)上发布它，因为我已经使用了这两个网站来更好地理解我过去所做的工作的概念，我认为它回馈一点可能是值得的。

* * *

2010 年 5 月 3 日编辑：

如果有人愿意“命名”该项目，我会将我为 MS SQL 编写的肮脏/讨厌的版本上传到 CodePlex，以便我们可以开始破解 SQL Compact 的版本。虽然，我认为在我计划的初始应用程序的下一个修订版中，我将放弃 SQL Compact，而只使用 XML 文件进行存储，因为该软件正在从可安装包转换为 Silverlight 应用程序。Silverlight 只是提供了更好的访问策略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-28T02:56:58.057

我目前正在研究[Migrator.Net](http://code.google.com/p/migratordotnet/)。这允许您直接在 C# 中将更改写入数据库，称为迁移。
这些迁移可以包含从简单的表添加/删除、列修改到复杂的数据更新代码的所有内容。

当您的应用程序启动时，它可以验证数据库当前所在的版本，并应用使其更新所需的任何迁移。这一切都是自动处理的。运行此更新的代码很简单：

```
Assembly asm = Assembly.Load("LocalModels.migration");
Migrator m = new Migrator("SqlServerCe", "Data Source=LocalModels.sdf", asm, false);
m.MigrateToLastVersion(); 
```

我在 Compact 支持方面遇到了一些小问题（它假定默认架构是 dbo）。但我认为修复它们不会太难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T03:51:07.087

一些随机的想法（虽然不确定我能完全回答）

1.  [Microsoft Sync Framework](http://www.microsoft.com/downloads/details.aspx?FamilyId=C88BA2D1-CEF3-4149-B301-9B056E7FB1E6&displaylang=en)是一种选择。一旦您在第一次部署之后（这似乎工作正常），我还没有机会完全了解它可以做什么。[这里](http://msdn.microsoft.com/en-us/sync/default.aspx)有一个 MSDN 站点

2.  您可以在移动设备上执行脚本，但不能通过 SQL Management Studio 之类的工具，因此理论上您可以管理/维护 T-SQL 脚本，但缺点是 T-SQL 会很复杂（对于 CE 支持的语句）和我不知道“自动化”执行的方法 - 但同步框架可能有一些答案..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T22:44:49.020

如果您的一个关键标准要在一个小管道上有效地工作，那么您唯一真正的选择是存储一个 DB Schema 版本（可能以某种方式与签入您的 CMS 的脚本相关联），并且当需要更新时，更改脚本通过网络发送并按顺序应用。您可能希望在您的数据库中保留日志以及正在应用的这些脚本，以便您可以优雅地处理断开连接、重新启动和其他可能令人讨厌的问题。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-06-07T15:44:27.030

SQL Server Management Studio 对您有用吗？
[http://technet.microsoft.com/en-us/library/ms172933.aspx](http://technet.microsoft.com/en-us/library/ms172933.aspx)

# ruby-on-rails - 如何使用 ruby 使用 wcf 服务？

> ID：699888
> 
> 赞同：8
> 
> 时间：2009-03-31T03:15:40.120
> 
> 标签：ruby-on-rails, ruby, wcf

我有一个 Rails 应用程序必须使用 asp.net 提供的 wcf 服务，是否有任何用于 wcf 的 ruby​​ 客户端？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-31T03:32:29.143

您可以控制 Web 服务吗？你能改变一下web.config吗？（您表示 Asp.Net，所以我猜这意味着 WCF 服务托管在 IIS 中。）

WCF 服务可以作为常规的旧 Web 服务[公开。](http://msdn.microsoft.com/en-us/library/ms733051.aspx)这是 WCF 的承诺之一：可以通过许多绑定公开相同的服务，而只需更改配置即可。

```
<endpoint address="" binding="basicHttpBinding" contract="IServiceContract"> 
```

然后你可以像这样从 Ruby 调用它：

```
require 'soap/wsdlDriver'   
soap = SOAP::WSDLDriverFactory.new("http://host/SomeService.svc?wsdl").create_rpc_driver
soap.ServiceMethod(:param1=> Value, :param2 => AnotherValue) 
```

# php - PHP表单自动转义发布的数据？

> ID：699903
> 
> 赞同：1
> 
> 时间：2009-03-31T03:28:00.793
> 
> 标签：php, forms

我有一个 HTML 表单发布到 PHP 页面。

我可以使用 PHP 上的 $_POST 变量读取数据。

但是，所有数据似乎都被转义了。

所以，例如

逗号 (,) = %2C 冒号 (:) = %3a 斜杠 (/) = %2

所以像[http://example.com](http://example.com)这样的简单 URL会被发布为 http%3A%2F%2Fexample.com

关于发生了什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T04:29:57.913

其实你想要urldecode。%xx 是 URL 编码，而不是 html 编码。真正的问题是你为什么要得到这些代码。PHP 通常会在将请求解析为 $_GET 和 $_REQUEST 变量时为您解码 URL。POST 表单不应进行 urlencoded。你能告诉我们一些生成表单的代码吗？可能出于某种原因，您的表单正在被编码。

请参阅此页面上的警告：http: [//us2.php.net/manual/en/function.urldecode.php](http://us2.php.net/manual/en/function.urldecode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T15:52:43.280

这不应该发生，尽管您可以通过手动 urldecode()ing 来修复它，但您可能会在其他地方隐藏一个基本错误，以后可能会来咬您。

尽管当您使用默认内容类型“application/x-www-form-encoded”发布表单时，其中的值是 URL 编码的 (%xx)，但 PHP 在 $ _POST[] 数组。

如果之后您仍然收到不需要的 %xx 序列，则必须有另一层不应该存在的手动 URL 编码。你需要找到它在哪里。如果它是一个隐藏字段，也许生成它的页面不小心使用 urlencode() 而不是 htmlspecialchars() 对其进行了编码，还是什么？将一些示例代码放到网上可能会帮助我们找出答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T04:18:09.360

这是一个简单的 PHP 循环来解码所有 POST 变量

```
foreach($_POST as $key=>$value) {
    $_POST[$key] = urldecode($value);
} 
```

然后，您可以正常访问它们，但要正确解码。但是，我会使用不同的数组来存储它们，因为我不喜欢污染超级全局变量（我相信它们应该总是像 PHP 那样在其中包含准确的数据）。

# haskell - 制作小型haskell可执行文件？

> ID：699908
> 
> 赞同：40
> 
> 时间：2009-03-31T03:32:31.670
> 
> 标签：haskell, linker, ghc, static-linking

有什么好方法可以制作小型的 haskell 可执行文件吗？使用 ghc6，一个简单的 hello world 程序似乎达到了大约 370kB（剥离前为 523kB）。C 中的 Hello world 大约为 4kB（剥离前为 9kB）。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2010-06-23T02:17:44.627

使用 GHC 的开发分支（有人确切知道这是在哪个版本中添加的吗？）：

```
$ ghc -o hello hello.hs
$ strip -p --strip-unneeded --remove-section=.comment -o hello-small hello
$ du hello hello-small
700 hello
476 hello-small 
```

为动态链接的 RTS 添加 -dynamic 标志：

```
$ ghc -dynamic -o hello hello.hs
$ strip -p --strip-unneeded --remove-section=.comment -o hello-small hello
$ du hello hello-small
24  hello
16  hello-small 
```

另见：[http ://hackage.haskell.org/trac/ghc/wiki/SharedLibraries/PlatformSupport](http://hackage.haskell.org/trac/ghc/wiki/SharedLibraries/PlatformSupport)

为了与 C 进行比较：

```
$ gcc hello.c -o hello
$ strip -p --strip-unneeded --remove-section=.comment -o hello-small hello
$ du hello hello-small
12  hello
8   hello-small 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-31T08:36:19.990

GHC 静态链接所有内容（运行时本身使用的库除外，它们是动态链接的）。

在旧时代，一旦你使用了其中的某些东西，GHC 就会将整个（haskell）库链接起来。前段时间，GHC 开始链接“per obj file”，大大减少了二进制文件的大小。从尺寸来看，您一定已经在使用较新的 GHC 了。

从好的方面来说，你已经在这 500K 中拥有了很多东西，比如多线程内核、垃圾收集器等。

至少将垃圾收集器添加到您的 C 代码中，然后再次比较它们:)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-01T06:25:28.173

您看到的大小是 Haskell 运行时 (libHSrts.a)，它静态链接到每个 Haskell 可执行文件。如果它是一个共享对象，例如 C 的 librt.o，那么您的二进制文件将只有几 k（库源中拆分的 .o 文件的大小）。

如果没有在您的平台上实现 libHSrts.a 的动态链接，您可以通过 strip 使您的可执行文件更小。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-06T19:22:48.960

如果你的二进制文件的大小真的很重要，你可以使用工具**gzexe**，它使用 gzip 压缩打包一个（最好是已经剥离的）可执行文件。在我的 64 位 Linux 机器上，原始的*hello world*程序占用 552 KB，剥离后占用 393 KB，剥离和 gzip 后占用 125 KB。gzipping 的阴暗面在于性能——必须首先解压缩可执行文件。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-31T03:42:05.033

你应该数一数你的祝福（370Kb？Luuuxury）：

```
bash$ sbcl
这是 SBCL 1.0.24，ANSI Common Lisp 的实现。

* (sb-ext:save-lisp-and-die "my.core")
[撤消绑定堆栈和其他封闭状态...完成]
[将当前 Lisp 图像保存到 ./my.core：
...
完毕]
bash$ du -sh my.core
 25M my.core
重击$

```

说真的，虽然您可能会稍微摆脱一下 haskell 二进制文件，但与 C 相比，这确实不是一个公平的比较。那里还有更多事情要做。

上次我玩 ghc（这可能已经过时）时，它静态链接了所有内容，这将是一个因素。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-01T04:42:50.073

```
strip -p --strip-unneeded --remove-section=.comment -o your_executable_small your_executable 
```

也尝试查看 ldd -dr your_executable

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-29T15:49:44.263

事情正在发生变化——密切关注[这项](http://blog.well-typed.com/2009/04/hello-world-now-only-11k-using-ghc-with-shared-libs/)正在进行的工作。

# asp.net - SQLDataSource 控制参数中的应用程序变量

> ID：699911
> 
> 赞同：0
> 
> 时间：2009-03-31T03:34:30.777
> 
> 标签：asp.net, .net, sqldatasource, css

也许这是我的懒惰，但以同样的方式我可以从我的 web.config 引用连接字符串`<%$ ConnectionStrings:con %>`，我想在我的选择参数之一中做类似的引用应用程序变量。就像是：

```
<asp:Parameter Name="AppVal" Type="Int32" DefaultValue="<% Application['MyVal'] %>" /> 
```

这是我的愚蠢吗？我应该闭嘴并在代码隐藏中设置参数值吗？我已经在谷歌上搜索了几个小时，试图描述在 ASP.Net 中利用尖括号百分号样式标签的不同方法，并且只找到了内联代码和代码渲染块 (<%=)，以及数据绑定(<%#)。这 <%$ 是什么意思，还有其他我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T04:24:13.420

我现在看到`<%$`引用了一个 ExpressionBuilder。使用一些方便的代码，我能够创建自己的 ApplicationExpressionBuilder 并将所需的值填充到我的控件中。

Google Custom Session Expression Builder 可以找到类似方法的代码来利用会话变量，并在适合您的情况下轻松切换到应用程序变量。

# io - 改善 I/O 的廉价方法

> ID：699915
> 
> 赞同：0
> 
> 时间：2009-03-31T03:38:53.403
> 
> 标签：io

我从[http://www.joelonsoftware.com/items/2009/03/27.html看到](http://www.joelonsoftware.com/items/2009/03/27.html)[http://www.youtube.com/watch?v=96dWOEa4Djs](http://www.youtube.com/watch?v=96dWOEa4Djs)并对改进感到惊讶。

我有一个很好的工作站（Sun Ultra M4、2 AMD Opteron、8GB RAM、NVidia FX 1500）并且感觉和城里任何其他计算机一样快（渲染时除外）。

我把它归咎于 Windows（我不能使用 linux，因为运行 3d max）但现在我想知道是否可以改进 I/O。

我运行 VM（每次 1-3 个）、3D Max、Photoshop 和 Python ......加上一些视频编码和类似的东西。

我没有足够的钱购买 SSD 和 2 个 SATA 驱动程序。我可以做什么？是否可以在 Windows 上安装 RAM 驱动器？我该如何使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T03:42:58.480

您是否考虑过使用 RAID 阵列？您可以从 RAID-0 配置中获得一些不错的 I/O 改进。

虽然我必须问 - 你确定你的瓶颈是磁盘 I/O 而不是内存或 CPU？根据我的经验，磁盘 I/O 一直是机器上的最后一个瓶颈（尤其是在大型机器中），而且内存、页面文件的使用不当和 CPU 吞吐量通常是紧张点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T03:43:51.847

如果您想要更多的磁盘 I/O 带宽，请选择 UltraSCSI。但是不要通过查看程序加载速度来衡量您的磁盘速度。更好的磁盘子系统和/或配置（例如 RAID）仅在传输大数据块时有用，例如视频/音频编辑，而不是加载操作系统文件或应用程序可执行文件。

您是否扫描过您的计算机中的间谍软件？;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T03:48:04.597

听起来你可能受 CPU 限制。您列出的所有程序都高度依赖于内存和 CPU，而不是磁盘速度。因为看起来你有足够的内存，我猜它主要是 CPU 减慢了你的速度。

如果您确实希望在不花太多钱的情况下提高磁盘性能，您可以尝试将磁盘置于 Raid 0 设置上。这将使您的计算机将它们视为一个大数据存储量，并通过同时从两个磁盘读取来加快速度。请记住，这也会增加丢失数据的可能性，因为轨道卷可能会损坏或其中一个磁盘可能发生故障（导致两个磁盘上的数据都丢失）。

或者，您可以尝试购买速度更快的磁盘驱动器。Newegg 出售 Western Digital Raptor 驱动器（目前最快的 SATA 非 SSD 磁盘）价格在 100 美元到 150 美元之间（折扣后）[http://www.newegg.com/Product/ProductList.aspx?Submit=ENE&N=40000014&Description=raptor&name=内部%20Hard%20Drives](http://www.newegg.com/Product/ProductList.aspx?Submit=ENE&N=40000014&Description=raptor&name=Internal%20Hard%20Drives)。这些可以使您的磁盘 IO 提高 20-30% 以上，具体取决于您当前驱动器的性能。

# c# - 如何用逗号格式化数字？

> ID：699921
> 
> 赞同：41
> 
> 时间：2009-03-31T03:42:25.843
> 
> 标签：c#, numbers, tostring

```
int a = 10000000;
a.ToString(); 
```

如何进行输出？

> 10,000,000

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-03-31T03:47:59.997

尝试`N0`没有小数部分：

```
string formatted = a.ToString("N0"); // 10,000,000 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-11-27T15:39:14.137

你也可以做 String.Format：

```
int x = 100000;
string y = string.Empty;
y = string.Format("{0:#,##0.##}", x); 
//Will output: 100,000 
```

如果您有小数，则相同的代码将输出 2 个小数位：

```
double x = 100000.2333;
string y = string.Empty;
y = string.Format("{0:#,##0.##}", x); 
//Will output: 100,000.23 
```

要使用逗号而不是小数，请使用：

```
double x = 100000.2333;
string y = string.Empty;
y = string.Format(System.Globalization.CultureInfo.GetCultureInfo("de-DE"), "{0:#,##0.##}", x); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-31T03:47:10.980

`a.ToString("N0")`

另请参阅：[MSDN 中的标准数字格式字符串](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-08T20:19:55.433

一个更简单的 String.Format 选项：

```
int a = 10000000;
String.Format("{0:n0}", a); //10,000,000 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-31T03:47:25.537

a.tostring("00,000,000")

# iphone - Cocoa Touch 表数据源问题

> ID：699925
> 
> 赞同：0
> 
> 时间：2009-03-31T03:44:30.440
> 
> 标签：iphone, cocoa-touch, datasource, nsmutablearray, retain

我在显示来自数据源的结果时遇到了一些问题。此代码将在控制台中显示不同（且正确）的结果，但会在模拟器中导致各种随机废话。

（“结果”是该类的 NSMutableArray 属性。）

```
-(void) handleSearchForKeywords: (NSString *) keywords {
    [results removeAllObjects];
    int r = rand() % 10;
    for( int i = 0; i < r; i++ ) {
        [results addObject:[NSString stringWithFormat:@"test %i: %@", i, keywords]];
    }
    [self reloadTheTable];
}

-(void) reloadTheTable {
    NSLog( @"current array contents: %@", results );
    [tableView reloadData];
}
```

我猜这可能与数组的内存保留或数组中的字符串有关？恐怕我还没有掌握这个窍门。

[编辑以回应 Marc Bessey——我认为这里的一切都是你的基本数据源方法]

```
-(NSInteger) tableView: (UITableView *) tableView numberOfRowsInSection: (NSInteger) section {
    return [results count];
}

-(UITableViewCell *) tableView: (UITableView *) tableView cellForRowAtIndexPath: (NSIndexPath *) indexPath {
    static NSString *SearchViewControllerCell = @"SearchViewControllerCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier: SearchViewControllerCell];
    if( cell == nil ) {
        cell = [[[UITableViewCell alloc] initWithFrame: CGRectZero reuseIdentifier: SearchViewControllerCell] autorelease];
        NSUInteger row = [indexPath row];
        [cell setText:[results objectAtIndex:row]];
    }
    return cell;
}
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T06:23:03.210

我不认为问题出在您发布的代码中。它更有可能在为您的表视图实现数据源的代码中。

# c# - 在 2008 的服务上下文中接收 ICMP 数据包

> ID：699931
> 
> 赞同：0
> 
> 时间：2009-03-31T03:48:47.857
> 
> 标签：c#, windows, sockets, icmp

当我们从 udp 端口​​发送数据包时，如果网络返回无法访问的 ICMP 主机，我们会收到异常。该异常没有告诉我们任何有用的信息（例如 ICMP 数据包的内容）。

没问题，我们将只监听 ICMP，这将为我们提供所需的信息，同时忽略 UDP 端口上的异常。因此，打开一个原始套接字，侦听 ICMP 数据包并从那里开始。

在开发（Win XP）中工作正常，但在服务器 2008 上的生产中，似乎运行 exe 的安全上下文必须具有管理员权限才能打开原始套接字。这对于服务是没有用的。如果我理解微软在说什么，那么我们可以做我们想做的唯一方法就是在具有管理员权限的帐户下运行我们的服务。感觉有点像花生的大锤，更不用说在管理员帐户下运行面向网络的服务带来的潜在安全漏洞。

我真的希望我在这里错了，但我似乎找不到任何与上述内容相矛盾的东西。

有人有任何意见/提示或同情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T12:48:15.133

与其监听对失败的 UDP 发送的 ICMP 响应，不如发送一个全新的 ICMP 回显请求？

当您收到异常时，您可以 PInvoke`IcmpSendEcho()`函数（来自 Win32 IP Helper API）以自己生成新的 ICMP 回显请求。关键是**该函数返回一个带有回显回复的缓冲区**，包括状态代码，例如`IP_DEST_HOST_UNREACHABLE`。

我认为您不需要任何特权来执行此操作，因此它应该比使用原始套接字侦听 ICMP 回复更容易。

您将需要三个函数：`IcmpCreateFile()`和`IcmpSendEcho()`- `IcmpCloseHandle()`PInvoke.net 具有必要的互操作详细信息：

[http://www.pinvoke.net/default.aspx/icmp/IcmpCreateFile.html](http://www.pinvoke.net/default.aspx/icmp/IcmpCreateFile.html) [http://www.pinvoke.net/default.aspx/icmp/IcmpSendEcho.html](http://www.pinvoke.net/default.aspx/icmp/IcmpSendEcho.html) [http://www.pinvoke.net/default。 aspx/icmp/IcmpCloseHandle.html](http://www.pinvoke.net/default.aspx/icmp/IcmpCloseHandle.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T04:00:18.250

我自己也遇到了完全相同的问题[Listen for ICMP packet in C#](https://stackoverflow.com/questions/626541/listen-for-icmp-packets-in-c)。实际上，您的问题似乎是 Windows 权限，因此该帖子无济于事。

我计划进一步研究的一个领域是检查 UdpListener 生成的 SocketException 中是否还有信息。由于 Windows 使用 ICMP 数据包来生成异常，它不会在某个地方记录该数据包中的信息，这似乎是不合理的。

像您一样，我无法从.Net级别的异常信息中获取ICMP信息，但我想看看是否可以通过Win32 API（例如GetLastError或其他一些）获得更多信息专门为 WinSock32 调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T05:07:46.950

从 MSDN[网站](http://msdn.microsoft.com/en-us/library/ms740548.aspx)：

> 要使用 SOCK_RAW 类型的套接字需要管理权限。运行使用原始套接字的 Winsock 应用程序的用户必须是本地计算机上管理员组的成员，否则原始套接字调用将失败并返回错误代码 WSAEACCES。在 Windows Vista 和更高版本上，对原始套接字的访问是在创建套接字时强制执行的。在早期版本的 Windows 中，对原始套接字的访问是在其他套接字操作期间强制执行的。

为了在我的项目中解决这个问题，我创建了一个 Windows 服务，作为我们 UI 应用程序的网络代理。Windows 服务在本地管理员帐户下运行，以绕过限制。应用程序使用 WCF 连接到服务，告诉它要打开什么样的套接字以及要应用什么过滤器。[然后使用协议缓冲区](http://code.google.com/p/protobuf-net/)通过回调将数据发送回进行编码（至少这是计划 - 回调部分仍在进行中）。

# jquery - 当用户单击刷新时处理 ajax 错误

> ID：699941
> 
> 赞同：40
> 
> 时间：2009-03-31T03:56:19.680
> 
> 标签：jquery, ajax, error-handling

如果这是我应该能够查找的内容，我深表歉意。我想要的所有条款都超载了..

这是我的问题：当我打开一个页面时，它会触发一系列的 ajax 调用。如果我然后按 Shift+Refresh，所有这些 ajax 调用都被视为错误，并在整个页面本身重新加载之前显示它们的错误消息对话框。

所以错误是由客户端触发的 - 无论如何我可以找出是否是这种情况，所以我可以忽略它？例如在 xmlhttprequest 或 ajax 函数中（我正在使用 jquery btw）

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-08-11T10:15:00.767

有几种建议的方法来检测这一点：

*   一些人建议使用`beforeunload`处理程序来设置布尔标志，以便错误处理程序可以知道页面正在被卸载（参见下面的相关/重复帖子列表）。这很好，除了[iOS 上的移动 Safari 不支持`beforeunload`event](https://stackoverflow.com/questions/3239834/window-onbeforeunload-not-working-on-the-ipad)。

*   [Sachindra 提出](https://stackoverflow.com/a/15623663/345716)了一种方法，它不是立即触发错误函数，而是在`setTimeout(..., 1000)`. 这样，当错误处理程序被调用时，页面很有可能实际上已经消失了。“好机会”就是这样。我敢打赌，如果我有一个包含许多`<input>`s 的大页面，卸载可能需要超过 1 秒，然后错误处理程序可能无论如何都会触发。

因此，我建议结合[可靠地检测`beforeunload`支持](https://stackoverflow.com/a/18137334/345716)和如果`beforeunload`不支持（*咳嗽*iPad/iPhone*咳嗽*）恢复到 Sachindra 的延迟技巧。

[在这个jsfiddle](http://jsfiddle.net/pmorch/SyUun/)`beforeunload`中查看带有检测的完整解决方案和所有内容。

看起来[jQuery 2.x 的情况比 1.x 好一点](https://stackoverflow.com/questions/18138362/ajax-seems-to-not-call-the-error-callback-in-jquery-2-x-e-g-due-to-page-relo)，但 2.x 也似乎有点不稳定，所以我仍然认为这个建议是谨慎的。

PS：还有一些建议涉及测试`XHR`/`jqXHR`对象中的某些字段。（[这里](http://ilikestuffblog.com/2009/11/30/how-to-distinguish-a-user-aborted-ajax-call-from-an-error/)和[这里](https://stackoverflow.com/a/1269278/345716)）。在长时间运行的 AJAX 调用期间，我没有遇到可以区分用户导航和重新启动网络服务器的组合，因此我发现这种方法对我没有用处。

这实际上也是对这些相关/重复的 Stack Overflow 问题的回答：

*   [jQuery AJAX 在窗口卸载时触发错误回调？](https://stackoverflow.com/questions/1370322/jquery-ajax-fires-error-callback-on-window-unload)
*   [$.ajax 在请求因浏览器重新加载而失败时调用成功处理程序](https://stackoverflow.com/questions/4553124/jquery-ajax-calls-success-handler-when-request-fails-because-of-browser-reload)
*   [如何最好地处理由用户单击链接引起的 jquery ajax 调用期间的错误](https://stackoverflow.com/questions/4850605/how-best-to-handle-errors-during-jquery-ajax-calls-caused-by-user-clicking-on-li)
*   [检测到 jQuery.ajax 调用失败，因为页面正在重新加载？](https://stackoverflow.com/questions/9397318/detecting-that-a-jquery-ajax-call-failed-because-the-page-is-reloading)

以及 Stack Overflow 之外的这些帖子：

*   [由于页面重新加载，处理 AJAX 错误的正确方法是什么？](http://forum.jquery.com/topic/what-s-the-proper-way-to-deal-with-ajax-error-because-of-page-reload)
*   [如何区分用户中止的 AJAX 调用和错误 | 我喜欢东西。](http://ilikestuffblog.com/2009/11/30/how-to-distinguish-a-user-aborted-ajax-call-from-an-error/)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-08-12T23:28:20.350

[这是对上一个答案的编辑，其中有一些我已经解决的悬而未决的问题]

当用户通过刷新、单击链接或更改浏览器中的 URL 离开页面时，jQuery 会引发错误事件。您可以通过为 ajax 调用实现错误处理程序并检查 xmlHttpRequest 对象来检测这些类型的错误：

```
$.ajax({
    /* ajax options omitted */
    error: function (xmlHttpRequest, textStatus, errorThrown) {
         if(xmlHttpRequest.readyState == 0 || xmlHttpRequest.status == 0) 
              return;  // it's not really an error
         else
              // Do normal error handling
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-19T23:17:14.210

```
var isPageBeingRefreshed = false;

window.onbeforeunload = function() {
    isPageBeingRefreshed = true;
};

$.ajax({
    error: function (xhr, type, errorThrown) {
        if (!xhr.getAllResponseHeaders()) {
            xhr.abort();
            if (isPageBeingRefreshed) {
                return; // not an error
            }
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-25T20:00:35.063

上述技术不适用于定期刷新页面（例如每半秒）。我发现刷新页面引起的错误可以通过将错误处理过程延迟一小段时间来避免。

例子：

```
$.ajax(...)
.success(...)
.error(function(jqXHR) {
setTimeout(function() {
  // error showing process
}, 1000);
}); 
```

在此之上

> window.onbeforeunload = function() {//停止 ajax 调用}

event 可用于不太频繁地刷新 ajax 调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-07-31T16:25:05.040

`nisanth074`和`Peter V. Mørch`答案的组合版本，对我有用。

**例子：**

```
var isPageBeingRefreshed = false;

$(window).on('beforeunload', function(){

    isPageBeingRefreshed = true;
});

$.ajax({

    // Standart AJAX settings

}).error(function(){

    if (!isPageBeingRefreshed) {

        // Displaying error message
    }
}); 
```

# php - 对 $_SESSION 的每次访问都会立即涉及到文件系统的 i/o 吗？

> ID：699952
> 
> 赞同：6
> 
> 时间：2009-03-31T04:08:09.400
> 
> 标签：php, session

每次我访问 $_SESSION 中的数据时，它会立即更新磁盘上的会话文件，还是只在进程停止时更新一次？还是每 n 个字节的数据更改（刷新）？

这个问题不一定是关于特定的文件会话处理程序，而是每个处理程序。（除了将普通变量存储在内存中之外，会话中的每次触摸是否都会立即调用任何类型的 I/O）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T07:31:09.820

正如马特所写，它默认在脚本执行结束时写入。你可以在这里阅读[session_write_close()](http://php.net/manual/en/function.session-write-close.php)

> 会话数据通常在脚本终止后存储，无需调用 session_write_close()，但由于会话数据被锁定以防止并发写入，任何时候只有一个脚本可以对会话进行操作。将框架集与会话一起使用时，由于这种锁定，您将体验到一个一个加载的框架。您可以通过在会话变量的所有更改完成后立即结束会话来减少加载所有帧所需的时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T06:31:46.280

它在我的设置中写入它并结束该过程。我做了一个新的_session_write_method：

```
public function _session_write_method($id, $sess_data) {
    var_dump(file_put_contents('/var/www/public_html/testing.txt', serialize($sess_data)));
    return(true);
} 
```

进而：

```
$_SESSION['foo'] = 'bar';
while(true) 
```

我执行了脚本，等待了几秒钟，然后在进程 ID 上运行“sudo kill”。它没有将序列化数据写入文件。我在没有无限循环的情况下再次运行它，我在页面的最底部得到：int(22)，testing.txt 被成功写入并包含：s:14:"foo|s:3:"bar";" ;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T04:47:23.190

取决于处理程序。您可以编写自己的处理程序，以确保它只发生在您想要绝对确定行为的情况下。有 6 个回调用于管理会话变量。称为“写入”的方法不必执行任何真正的 I/O，并且写入会话文件可以等到调用“关闭”。正如我所说，这是一个实现细节，取决于处理程序。

# ruby - 使 rails 从数据库字符串中进行变量替换

> ID：699957
> 
> 赞同：0
> 
> 时间：2009-03-31T04:11:37.257
> 
> 标签：ruby, string

我在数据库中有一个包含局部变量引用的字符串，我希望 Ruby 解析和替换它。例如，db中的字符串是`"Hello #{classname.name}"`，它存储在classname.description中

我的代码如下：

```
<%=h @classname.description %> 
```

把它打印出数据库的确切值：

```
Hello #{name} 
```

而不是（假设`classname.name`是 Bob）：

```
Hello Bob 
```

如何让 Ruby 解析数据库中的字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T04:16:47.960

您可以使用它`eval()`来执行此操作。例如：

```
>> a = {:name => 'bob'}
=> {:name=>"bob"}
>> eval('"Hello #{a[:name]}"')
=> "Hello bob" 
```

但是，您正在做的事情可能非常危险，而且几乎没有必要。我不能确定这是否是为您的项目做事的正确方法，但通常将要在数据库中执行的代码存储是不好的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T18:06:34.410

为什么不使用像[Liquid](http://www.liquidmarkup.org/)这样的安全模板引擎来解决 eval 问题？

```
template_string = "Hello {{name}}" #actually get from database
template = Liquid::Template.parse(template_string)  #compile template

name = 'Bob'
text = template.render( 'name' => name ) 
```

# java - 为什么此 java 链接检查器代码无法编译？

> ID：699961
> 
> 赞同：1
> 
> 时间：2009-03-31T04:12:48.017
> 
> 标签：java, hyperlink, broken-links

我已经阅读了SO 中发布的[链接检查器问题。](https://stackoverflow.com/questions/65515/how-to-find-broken-links-on-a-website)如果还有更多此类问题而我错过了，我深表歉意。

我们需要以一种非常简单且可编写脚本的方式在[网站](http://blog.readytocloud.com)中找到损坏的链接，以便我们可以记录损坏的链接。我发现了[一篇博客文章](http://unserializableone.blogspot.com/2008/12/link-checker-with-java-better-version.html)，其中包含一些用 java 编写的代码，可以完全满足我的需要，而且我的基本知识让我可以编译它，但每次都会出错。我想也许这里有人可以指导我为什么代码无法编译。

这是代码：

```
import java.net.HttpURLConnection;
import java.net.URL;
class links
{

private static boolean isLive(String link) {
    HttpURLConnection urlConnection = null;
    try {
      URL url = new URL(link);
      urlConnection = (HttpURLConnection) url.openConnection();
      urlConnection.setRequestMethod("HEAD");
      urlConnection.connect();
      String redirectLink = urlConnection.getHeaderField("Location");
      if (redirectLink != null && !url.equals(redirectLink)) {
        return isLive(redirectLink);
      } else {
        return urlConnection.getResponseCode() == HttpURLConnection.HTTP_OK;
      }
    } catch (Exception e) {
      return false;
    } finally {
      if (urlConnection != null) {
        urlConnection.disconnect();
      }
    }
  }

  public static void main(String[] args) {
    System.out.println(isLive("http://www.fakelink.net"));
  }
} 
```

感谢所有的回复。我把编译的代码放在这里，以供将来参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T04:25:37.253

您需要导入正确的包。在这种情况下，您应该在文件顶部有以下内容：

```
import java.net.HttpURLConnection;
import java.net.URL; 
```

我还在以下代码中收到编译器警告：

```
 && !url.equals(redirectLink) 
```

它试图将 url（它是一个 URL）等同于 redirectLink（它是一个字符串）。在 Java 中，它会在发生这种情况时自动比较字符串值，并且 toString 实际上给出了你想要的。为了在作者代码中更准确，我会将上面的代码更改为：

```
 && !url.toExternalForm().equals(redirectLink) 
```

注意：在 netbeans 中，您只需右键单击并选择选项 Fix Imports（或按 Ctrl + Shift + I），它将尝试找到您当前正在使用的正确包并自动插入导入语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T04:18:51.480

代码似乎正确。可能是您没有导入所需的包。如果您可以发布您收到的编译器错误，这将有所帮助。

# outlook - Outlook 2003 插件

> ID：699963
> 
> 赞同：2
> 
> 时间：2009-03-31T04:15:21.693
> 
> 标签：outlook, vsto, outlook-addin, outlook-object-model

我想为 Outlook 2003 创建一个自定义插件/插件，以支持与任务管理系统的集成功能。

我找不到很多好的开发资源。

有人可以解释一下 Outlook 2003 架构和插件的开发。

也欢迎良好的链接/资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T05:05:30.713

这是一个关于 Outlook 体系结构的教程，从 MSDN 开始构建 Outlook 2003 插件：http: [//msdn.microsoft.com/en-us/library/aa289167.aspx](http://msdn.microsoft.com/en-us/library/aa289167.aspx)

这里还有一个巨大的资源列表：http: [//www.microeye.com/resources/res_tech_vsnet.htm](http://www.microeye.com/resources/res_tech_vsnet.htm)

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T20:19:13.197

你想要的都可以做到。

最重要的是，您需要使用 Visual Studio 2005*或*Visual Studio 2008 以及 Visual Studio Tools for Office (VSTO) 以及 Outlook 2003（当然）来为 Outlook 构建“插件”。

插件编写起来非常复杂，主要是因为 Outlook 有一些没有很好记录的怪癖。例如，即使对于同一个对象，Outlook.MailItem.GetHashCode() 方法也并不总是相同的，尽管您可能期望从对象的“HashCode”这样看似绝对的东西中得到什么。知道这一点以及 VSTO+Outlook API 的许多其他怪癖都是为了让专业人士获得报酬。有很多怪癖。如果您正在学习，那么您需要从 Gdeglin 提供的资源开始。

另请查看 MSDN VSTO 论坛： [http](http://social.msdn.microsoft.com/Forums/en-US/vsto/threads) ://social.msdn.microsoft.com/Forums/en-US/vsto/threads <- 非常活跃！

和 Outlook 代码：[http ://www.outlookcode.com/](http://www.outlookcode.com/)

这里还有一个[谷歌](http://www.google.com/search?hl=en&safe=off&client=firefox-a&rls=com.ubuntu%3Aen-US%3Aunofficial&hs=3X0&q=site%3Amsdn.com+%27visual+studio+tools+for+office%27+forum+-blog&btnG=Search)搜索 MSDN 上的各种 VSTO 'tips'。

# c - 在 C 中显示数字的二进制表示？

> ID：699968
> 
> 赞同：8
> 
> 时间：2009-03-31T04:18:04.370
> 
> 标签：c, binary, printf, representation

> **可能重复：**
> [是否有 printf 转换器以二进制格式打印？](https://stackoverflow.com/questions/111928/is-there-a-printf-converter-to-print-in-binary-format)

还在学习 C，我想知道：

给定一个数字，是否可以执行以下操作？

```
char a = 5;
printf("binary representation of a = %b",a);
> 101 
```

还是我必须编写自己的方法来转换为二进制？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-31T04:21:10.790

没有直接的方法（即使用`printf`或其他标准库函数）来打印它。您将不得不编写自己的函数。

```
/* This code has an obvious bug and another non-obvious one :) */
void printbits(unsigned char v) {
   for (; v; v >>= 1) putchar('0' + (v & 1));
} 
```

如果您使用的是终端，则可以使用控制代码以自然顺序打印出字节：

```
void printbits(unsigned char v) {
    printf("%*s", (int)ceil(log2(v)) + 1, ""); 
    for (; v; v >>= 1) printf("\x1b[2D%c",'0' + (v & 1));
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-31T06:01:37.087

基于[dirkgently 的回答](https://stackoverflow.com/questions/699968/display-the-binary-representation-of-a-number-in-c/699978#699978)，但修复了他的两个错误，并始终打印固定数量的数字：

```
void printbits(unsigned char v) {
  int i; // for C89 compatability
  for(i = 7; i >= 0; i--) putchar('0' + ((v >> i) & 1));
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-31T04:44:14.883

是的（自己写），类似于下面的完整函数。

```
#include <stdio.h> /* only needed for the printf() in main(). */
#include <string.h>

/* Create a string of binary digits based on the input value.
   Input:
       val:  value to convert.
       buff: buffer to write to must be >= sz+1 chars.
       sz:   size of buffer.
   Returns address of string or NULL if not enough space provided.
*/
static char *binrep (unsigned int val, char *buff, int sz) {
    char *pbuff = buff;

    /* Must be able to store one character at least. */
    if (sz < 1) return NULL;

    /* Special case for zero to ensure some output. */
    if (val == 0) {
        *pbuff++ = '0';
        *pbuff = '\0';
        return buff;
    }

    /* Work from the end of the buffer back. */
    pbuff += sz;
    *pbuff-- = '\0';

    /* For each bit (going backwards) store character. */
    while (val != 0) {
        if (sz-- == 0) return NULL;
        *pbuff-- = ((val & 1) == 1) ? '1' : '0';

        /* Get next bit. */
        val >>= 1;
    }
    return pbuff+1;
} 
```

将此 main 添加到它的末尾以查看它的运行情况：

```
#define SZ 32
int main(int argc, char *argv[]) {
    int i;
    int n;
    char buff[SZ+1];

    /* Process all arguments, outputting their binary. */
    for (i = 1; i < argc; i++) {
        n = atoi (argv[i]);
        printf("[%3d] %9d -> %s (from '%s')\n", i, n,
            binrep(n,buff,SZ), argv[i]);
    }

    return 0;
} 
```

运行它`"progname 0 7 12 52 123"`以获得：

```
[  1]         0 -> 0 (from '0')
[  2]         7 -> 111 (from '7')
[  3]        12 -> 1100 (from '12')
[  4]        52 -> 110100 (from '52')
[  5]       123 -> 1111011 (from '123') 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-09-10T17:11:37.293

```
#include<iostream>
#include<conio.h>
#include<stdlib.h>
using namespace std;
void displayBinary(int n)
{
       char bistr[1000];
       itoa(n,bistr,2);       //2 means binary u can convert n upto base 36
       printf("%s",bistr);

}

int main()
{
    int n;
    cin>>n;
    displayBinary(n);
    getch();
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-31T04:52:16.503

使用查找表，例如：

```
char *table[16] = {"0000", "0001", .... "1111"}; 
```

然后像这样打印每个半字节

```
printf("%s%s", table[a / 0x10], table[a % 0x10]); 
```

当然，您可以只使用一张桌子，但它会稍微快一些并且太大。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-31T04:43:55.977

在 C 语言中没有直接的格式说明符。尽管我编写了这个快速的 Python 代码片段来帮助您逐步了解自己的流程。

```
#!/usr/bin/python

dec = input("Enter a decimal number to convert: ")
base = 2
solution = ""

while dec >= base:
    solution = str(dec%base) + solution
    dec = dec/base
if dec > 0:
    solution = str(dec) + solution

print solution 
```

**解释：**

**dec = input("输入要转换的十进制数：")** - 提示用户输入数字（例如，在 C 中通过 scanf 有多种方法可以做到这一点）

**base = 2** - 指定我们的基数为 2（二进制）

**solution = ""** - 创建一个空字符串，我们将在其中连接我们的解决方案

**while dec >= base:** - 当我们的数字大于输入的基数时

**解决方案 = str(dec%base) + 解决方案**- 获取数字的模数，并将其添加到字符串的开头（我们必须使用除法和余数方法从右到左添加数字）。str() 函数将运算结果转换为字符串。在没有类型转换的情况下，您不能在 python 中将整数与字符串连接起来。

**dec = dec/base** - 将十进制数除以基数以准备下一个模数

**如果 dec > 0：** **solution = str(dec) + solution** - 如果有任何剩余，请将其添加到开头（如果有的话，这将是 1）

**打印解决方案** - 打印最终数字

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-01T07:24:34.320

此代码应能处理您最多 64 位的需求。

```
 char* pBinFill(long int x,char *so, char fillChar); // version with fill
char* pBin(long int x, char *so);                    // version without fill
#define width 64

char* pBin(long int x,char *so)
{
 char s[width+1];
 int    i=width;
 s[i--]=0x00;   // terminate string
 do
 { // fill in array from right to left
  s[i--]=(x & 1) ? '1':'0';  // determine bit
  x>>=1;  // shift right 1 bit
 } while( x > 0);
 i++;   // point to last valid character
 sprintf(so,"%s",s+i); // stick it in the temp string string
 return so;
} 
```

```
 char* pBinFill(long int x,char *so, char fillChar)
{ // fill in array from right to left
 char s[width+1];
 int    i=width;
 s[i--]=0x00;   // terminate string
 do
 {
  s[i--]=(x & 1) ? '1':'0';
  x>>=1;  // shift right 1 bit
 } while( x > 0);
 while(i>=0) s[i--]=fillChar;    // fill with fillChar 
 sprintf(so,"%s",s);
 return so;
} 
```

```
 void test()
{
 char so[width+1]; // working buffer for pBin
 long int   val=1;
 do
 {
   printf("%ld =\t\t%#lx =\t\t0b%s\n",val,val,pBinFill(val,so,0));
   val*=11; // generate test data
 } while (val < 100000000);
}

Output:
00000001 = 0x000001 =   0b00000000000000000000000000000001
00000011 = 0x00000b =   0b00000000000000000000000000001011
00000121 = 0x000079 =   0b00000000000000000000000001111001
00001331 = 0x000533 =   0b00000000000000000000010100110011
00014641 = 0x003931 =   0b00000000000000000011100100110001
00161051 = 0x02751b =   0b00000000000000100111010100011011
01771561 = 0x1b0829 =   0b00000000000110110000100000101001
19487171 = 0x12959c3 =  0b00000001001010010101100111000011 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-31T04:20:34.940

您必须编写自己的转换。格式说明符仅支持十进制、十六进制和八进制数。

# programming-languages - 扩展编程语言是如何工作的？

> ID：699971
> 
> 赞同：-2
> 
> 时间：2009-03-31T04:18:30.873
> 
> 标签：programming-languages, extending

我没有编程经验，但有兴趣学习一门语言。

因此，阅读本节“ [http://wiki.freaks-unidos.net/weblogs/azul/principles-of-software#extend-your-language-to-match-your-domain](http://wiki.freaks-unidos.net/weblogs/azul/principles-of-software#extend-your-language-to-match-your-domain) ”让我对编写单个应用程序感到好奇2 种或更多语言。

它实际上是如何完成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T04:57:21.653

一些想法：

*   您链接到的页面非常清楚地解释了它是如何完成的
*   如果您有兴趣学习一门语言，这可能不是开始的地方
*   用两种或多种语言编写单个应用程序与链接文档的关系不大。

尽管如此，面对这一切，我将尝试通过类比举例说明其工作原理。

假设您需要与一群人一起完成一些技术任务——按难度对国际象棋谜题进行排名或测试棉花糖是否受到污染等。进一步假设您团队中的一个人只会说日语，另一个只会说葡萄牙语，第三个只会说世界语。

拥有流利地说所有这些语言的能力，你最好的选择是编造一种专门用于手头任务的人工语言；这称为领域特定语言或 DSL。它应该包含您需要谈论的所有术语，包括骑士和白嘴鸦或硅酸盐纳米粒子或任何用于该任务的术语，仅此而已。把这个教给你的每个团队成员，然后你可以同时给他们所有的指示。他们可以互相谈论他们正在做的事情，寻求帮助（只要它与您的语言所涵盖的内容相关），就好像他们都说同一种语言一样。

这大致就是他所说的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T05:01:42.457

我想你可能会在走路之前尝试跑步。那里的概念可能需要一点编程经验才能开始。

这篇文章的主旨（坦率地说，表达得很糟糕）是，当你编程时，你经常会遇到受益于声明性语法的任务，即你应该能够表达你想做的事情的意图，并将实现细节留给一个图书馆。一个很好的例子是查询数据库，它更具可读性（通常）能够以声明方式描述您想要做的事情并让一些中间件找出最好的方法，SQL 和 Linq 是声明性机制的 2 个示例查询数据。

这是一个非常有趣的话题，但老实说，如果您没有编程经验，那么它可能更像是 201 主题而不是 101 主题，请先了解您的基础知识。

# .net - 是什么导致 Windows 防火墙阻止应用程序？

> ID：699983
> 
> 赞同：15
> 
> 时间：2009-03-31T04:25:05.413
> 
> 标签：.net, winforms, windows-firewall

我有一个在用户桌面上本地运行的 Windows 窗体应用程序。它访问 Internet 的唯一方法是执行 System.Diagnostics.Process.Start(url) 来启动用户的默认浏览器并将其指向各种 URL（检查更新、联系我们等）。如果用户没有通过单击菜单项或按钮明确请求，这一切都不会发生。

在我的机器上，我偶尔会在启动程序时收到 Windows 防火墙警告消息，说 Windows 防火墙“阻止了程序的某些功能”以保护机器。在 Visual Studio 中运行我的程序时，我偶尔也会收到此警告（警告对话框显示 vshost 已被网络阻止）。它不会一直发生。

我没有从我的任何客户那里听说他们的 PC 上发生过这种情况，但这并不意味着没有。对于不太懂技术的用户来说，这是一个有点可怕的警告，所以我想弄清楚如果可能的话如何消除它。

我的程序可能会做什么来触发此警告？

编辑：我的程序在启动时唯一有点不寻常的事情是它使用 Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase 类来强制执行单实例应用程序。我知道这在幕后做了一些线程魔术来检测新实例并重定向它们。是否有可能出于某种原因在网络上收听？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T04:42:43.797

仅当您的程序正在侦听端口时才会触发 Windows 防火墙 - 有效地充当服务器。System.Diagnostics.Process.Start 不会触发 Windows 防火墙。

相反，WindowsFormsApplicationBase 可能会导致防火墙警告，因为 WindowsFormsApplicationBase 使用远程处理来感知自身的其他实例。使用反射器，我在 WindowsFormsApplicationBase.Run() 中找到了这段代码：

```
TcpChannel channel = this.RegisterChannel(secureChannel);
RemoteCommunicator communicator = new RemoteCommunicator(this, this.m_MessageRecievedSemaphore);
string uRI = applicationInstanceID + ".rem";
new SecurityPermission(SecurityPermissionFlag.RemotingConfiguration).Assert();
RemotingServices.Marshal(communicator, uRI);
CodeAccessPermission.RevertAssert();
string uRL = channel.GetUrlsForUri(uRI)[0];
this.WriteUrlToMemoryMappedFile(uRL);
this.m_FirstInstanceSemaphore.Set();
this.DoApplicationModel(); 
```

只要您将 WindowsFormsApplicationBase 用于其 SingleInstance 功能，我不知道有任何解决方法。

# c - C函数过度使用参数？

> ID：699985
> 
> 赞同：3
> 
> 时间：2009-03-31T04:25:40.357
> 
> 标签：c

我有遗留的 C 代码库在工作，我发现了很多下面风格的函数实现。

```
char *DoStuff(char *inPtr, char *outPtr, char *error, long *amount)
{
    *error = 0;
    *amount = 0;

    // Read bytes from inPtr and decode them as a long storing in amount
    // before returning as a formatted string in outPtr.

    return (outPtr);
} 
```

使用 DoStuff：

```
myOutPtr = DoStuff(myInPtr, myOutPtr, myError, &myAmount); 
```

我发现这很迟钝，当我需要实现类似的功能时，我最终会这样做：

```
long NewDoStuff(char *inPtr, char *error)
{
    long amount = 0;
    *error = 0;

    // Read bytes from inPtr and decode them as a long storing in amount.

    return amount;
} 
```

使用 NewDoStuff：

```
myAmount = NewDoStuff(myInPtr, myError);
myOutPtr += sprintf (myOutPtr, "%d", myAmount); 
```

我不禁想知道我在上面的例子中是否缺少一些东西，是否有充分的理由使用这种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T04:30:59.503

它是 C 标准库风格。返回值用于帮助链接函数调用。

此外，`DoStuff`IMO 更清洁。你真的应该使用`snprintf`. 缓冲区管理内部结构的更改不会影响您的代码。但是，这不再适用于`NewDoStuff`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T04:37:43.650

一个优点是，如果您的代码中有很多对这些函数的调用，那么必须一遍又一遍地重复`sprintf`调用很快就会变得乏味。

此外，返回 out 指针使您可以执行以下操作：

```
DoOtherStuff(DoStuff(myInPtr, myOutPtr, myError, &myAmount), &myOther); 
```

使用您的新方法，等效代码要冗长得多：

```
myAmount = DoNewStuff(myInPtr, myError);
myOutPtr += sprintf("%d", myAmount);
myOther  = DoOtherStuff(myInPtr, myError);
myOutPtr += sprintf("%d", myOther); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T04:34:36.233

您提供的代码有点不清楚（例如，为什么要将 myOutPtr 与 sprintf.

但是，总的来说，您似乎本质上所描述的是将一个执行两件事的函数分解为一个执行一件事的函数和一个执行其他操作的代码（连接）。

将职责分成两个功能是一个好主意。但是，您可能希望为这种连接和格式设置一个单独的函数，这真的不清楚。

此外，每次将函数调用拆分为多个调用时，都会创建代码复制。代码复制从来都不是一个好主意，所以你需要一个函数来做到这一点，你最终会得到（这是 C）看起来像你原来的 DoStuff 的东西。

所以我不确定你能做些什么。非 OOP 语言的限制之一是您必须发送大量参数（除非您使用结构）。您可能无法避免巨大的界面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T04:37:03.700

如果您在每次调用 NewDoStuff 之后都必须执行 sprintf 调用，那么您就是在重复自己（因此违反了 DRY 原则）。当您意识到需要以不同的方式对其进行格式化时，您将需要在每个位置进行更改，而不仅仅是一个位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T05:02:21.860

根据经验，如果我的一个函数的接口超过 110 列，我会强烈地考虑使用结构（如果我正在采用最好的方法）。我（永远）不想做的是采用一个做 5 件事的函数并将其分解为 5 个函数，除非函数中的某些功能不仅有用，而且需要它自己。

我更喜欢第一个函数，但我也很习惯标准的 C 风格。

# css - 带图像和文本的 DIV

> ID：699990
> 
> 赞同：0
> 
> 时间：2009-03-31T04:29:34.653
> 
> 标签：css, layout, html

我想创建一个高度为 6px 的标题并在 div 主体内的 DIV，我想将图像和文本彼此对齐。DIV 主体的高度应该是固定的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T04:38:58.360

这是一个非常简单的示例，说明如何执行您想要的操作（使用内联样式）：

```
<div>
  <div style="height:6px;width:500px;background-color:#3399CC;"></div>
  <div style="clear:both"/>
  <div style="float:left"><img src="http://www.google.com/intl/en_ALL/images/logo.gif"/></div>
  <div style="float:left">Your Text Here</div>
</div>
<div style="clear:both"/> 
```

您可以在此处测试此代码并尝试对其进行实时编辑：http: [//htmledit.squarefree.com/。](http://htmledit.squarefree.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T08:08:30.883

尝试使用以下代码创建一个 html 页面：

```
<html>
<head>
<style type="text/css">
body {
text-align: center;
}
#container {
    margin-right: auto;
    margin-left: auto;
    width: 200px;
    height: 200px;
    background: #acf;
}
#header {
    background: #f98;
    padding-bottom: 1px;
}
#container img {
    background: #000;
    float: left;
    padding: 10px;
    margin: 10px;
}
</style>
</head>
<body>
    <div id="container">
        <div id="header">
            <h1>Heading</h1>
        </div>
        <img src="image.jpg" alt="" height="25" width="25" />
        <p>Text text text</p>
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T18:28:11.510

以乔恩为基础。一个 6px 的标题实在是太小了！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
 <title>Div layout</title>
<style type="text/css">
/*<![CDATA[*/
#container {
  margin:0 auto;
  width:400px;
  height:300px;
  overflow:scroll;
  background:#acf;
  padding:0;
}
#container h1 {
  background:#f98;
  padding:0 0 1px 0;
  height:6px;
  font-size:2px;
  text-align:center;
  font-weight:normal;
  border:3px #FFA500 outset;
}
#container img {
  background:#000;
  float:left;
  padding:10px;
  margin:10px;
}
/*]]>*/
</style>
</head>

<body>
 <div id="container">
  <h1>Heading</h1><img src="image.jpg" alt="" height="25" width="25" />

  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
  eleifend. Vestibulum ante ipsum primis in faucibus orci luctus et
  ultrices posuere cubilia Curae; Nulla sit amet tellus vel augue
  hendrerit pellentesque. Aenean cursus, quam nec volutpat interdum, nibh
  sapien elementum mi, id accumsan neque risus a est. Praesent libero
  metus, tincidunt at, vulputate eu, vehicula at, arcu? Donec orci metus,
  ornare non, viverra vel, vehicula ac, dui. Aliquam erat volutpat. Fusce
  malesuada urna quis augue. Mauris in purus. Maecenas at est. Nunc
  vestibulum feugiat justo. Etiam nec urna. Nulla facilisi. Ut enim.
  Nullam sit amet mauris eu quam eleifend vestibulum! Cras lectus turpis,
  cursus nec, fermentum egestas, fermentum non, tortor.</p>
 </div>
</body>
</html> 
```

# zend-framework - 使用 WAMP 服务器安装 Zend 框架

> ID：699995
> 
> 赞同：16
> 
> 时间：2009-03-31T04:31:42.107
> 
> 标签：zend-framework, wamp

我正在尝试在 WAMP 服务器上安装 Zend 框架，但它无法正常工作。

我下载了 Zend 框架并在 中创建了文件夹`C:\wamp\library\Zend`，然后在`php.inc`我有这样的东西：

```
; Windows: "\path1;\path2"
;include_path = ".;c:\php\includes:C:\wamp\library" 
```

现在，当我尝试运行示例`blogger.php`时，它给了我以下错误：

```
Warning: require_once(Zend/Loader.php) [function.require-once]: failed to open stream: No such file or directory in C:\wamp\www\PHPSample\Blogger.php on line 37

Fatal error: require_once() [function.require]: Failed opening required 'Zend/Loader.php' (include_path='.;C:\php5\pear') in C:\wamp\www\PHPSample\Blogger.php on line 37 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T19:39:07.240

在 Windows 上，您的 php.ini 应该有这样的部分：

```
;;;;;;;;;;;;;;;;;;;;;;;;;
; Paths and Directories ;
;;;;;;;;;;;;;;;;;;;;;;;;;

; UNIX: "/path1:/path2"  
; Windows: "\path1;\path2" 
```

关键是 a) 删除行首的分号，b) 在路径中添加您需要的内容。**注意：**在 Windows 上，路径必须用分号分隔，而在 UNIX 上，它们用完整的冒号分隔；此外，Dot 表示“当前目录”，因此仅在需要时才包含它。

确保它看起来像这样：

```
;;;;;;;;;;;;;;;;;;;;;;;;;
; Paths and Directories ;
;;;;;;;;;;;;;;;;;;;;;;;;;

include_path = ".;c:\php\includes;c:\wamp\library" 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-01T06:36:24.390

Zend 安装：- 下载 Zend 框架

*   去 Wamp/bin/php/ 创建一个文件夹 即：- Zend_Framework

*   复制下载的 Zend Framework 的所有文件和文件夹。

*   转到 php.ini 并找到 include_path 在这里您可以找到：- include_path=" `c:\php\includes`" 并从您的目录中替换 "" 之间的文本 `C:\wamp\bin\php\zend_framework\library` 并保存文件。

*   现在转到计算机属性和高级系统设置和高级和环境变量，然后从系统变量中选择路径，然后单击编辑并添加；并粘贴您的目录路径 hare C:\wamp\bin\php\zend_framework\bin

*   打开命令提示符并转到 wamp 内的 www 目录，然后键入 zf create project Zendy

*   现在转到 httpd.conf 文件并在那里键入`<virtualHost></virtualHost>`标签。

`<virtualHost 127.0.0.1> DocumentRoot "C:\www\Zendy\public" ServerName Zendy <Directory "C:\www\Zendy\public"> AllowOverride AuthConfig FileInfo Indexes Limit Options order Deny,Allow Allow from all </Directory> </virtualHost>`

*   保存并退出并转到 windows -> System32 -> drivers-> etc-> hosts 并在此处添加您的项目 `127.0.0.1`localhost Zendy

*   保存并退出并重新启动 Apache

*   还通过删除设置重写模块；从`php.ini`文件

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-27T11:40:12.397

我制作了这个演员表，解释了如何使用 Wamp 完整功能设置许多 ZF 应用程序，请检查一下，如果您有任何问题，请告诉我，以便我提供帮助：

[Zend 框架和 WAMP 服务器入门](http://www.zendcasts.com/getting-started-with-zend-and-wamp-server/2009/06/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T07:29:20.930

如果：

您解压缩了包含 Zend 框架的存档中的 library 文件夹的内容

C:\wamp\library 文件夹。否则您需要这样做（将库文件夹的内容放在您在 php.ini 中指定的路径中的存档中

# java - Java Web 应用程序：如何实现缓存技术？

> ID：699996
> 
> 赞同：26
> 
> 时间：2009-03-31T04:32:05.740
> 
> 标签：java, servlets, caching, jakarta-ee

我正在开发一个 Java Web 应用程序，它通过从 Web 服务加载的大型 XML 配置文件来建立它的行为。由于在访问应用程序的特定部分之前实际上并不需要这些文件，因此它们是延迟加载的。当需要这些文件之一时，会向 Web 服务发送查询以检索相应的文件。由于某些配置文件可能会被使用得更多，比其他配置文件更频繁，我想设置某种缓存（可能有 1 小时的过期时间）以避免一遍又一遍地请求同一个文件。

Web 服务返回的文件对于所有会话中的所有用户都是相同的。我不使用 JSP、JSF 或任何其他花哨的框架，只使用普通的 servlet。

我的问题是，在 Java Web 应用程序中实现这种全局静态缓存的最佳实践是什么？单例类是否合适，还是会因为 J2EE 容器而出现奇怪的行为？我应该通过 JNDI 在某个地方公开一些东西吗？我应该怎么做才能使我的缓存不会在集群环境中被搞砸（可以，但不是必须的，每个集群服务器都有一个缓存）？

鉴于上述信息，将负责缓存的对象作为 ServletContext 属性放置是正确的实现吗？

注意：我不想在启动时加载所有这些并完成它，因为那样会

1）。每当我的应用程序启动时，都会重载 Web 服务
2)。这些文件可能会在我的应用程序运行时发生变化，所以无论如何我都必须重新查询它们
3)。我仍然需要一个全局可访问的缓存，所以我的问题仍然存在

更新：使用缓存代理（例如 squid）可能是一个好主意，但是对 web 服务的每个请求都会在 post Data 中发送相当大的 XML 查询，每次可能不同。只有 Web 应用程序真正知道对 Web 服务的两个不同调用实际上是等效的。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-31T07:22:57.857

这是使用 EhCache 进行缓存的示例。此代码在多个项目中用于实现临时缓存。

**1）将您的缓存放在全局上下文中。（不要忘记在 WEB.XML 中添加监听器）。**

```
import net.sf.ehcache.Cache;
import net.sf.ehcache.CacheManager;

public class InitializationListener implements ServletContextListener {    
    @Override
    public void contextInitialized(ServletContextEvent sce) {
        ServletContext ctx = sce.getServletContext();
        CacheManager singletonManager = CacheManager.create();
        Cache memoryOnlyCache = new Cache("dbCache", 100, false, true, 86400,86400);
        singletonManager.addCache(memoryOnlyCache);
        cache = singletonManager.getCache("dbCache");       
        ctx.setAttribute("dbCache", cache );           
    }
} 
```

**2) 在需要时检索缓存实例。即来自一个servlet：**

`cache = (Cache) this.getContext().getAttribute("dbCache");`

**3) 在执行昂贵操作之前查询缓存。**

```
 Element e = getCache().get(key);
        if (e != null) {
            result = e.getObjectValue(); // get object from cache
        } else {
            // Write code to create the object you need to cache, then store it in the cache.
            Element resultCacheElement = new Element(key, result);
            cache.put(resultCacheElement);

        } 
```

**4）也不要忘记在适当的时候使缓存对象无效。**

[您可以在此处](http://ehcache.sourceforge.net/samples.html)找到更多示例

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-31T06:46:03.530

您的问题包含几个单独的问题。让我们慢慢开始吧。ServletContext 是您可以将句柄存储到缓存的好地方。但是您通过每个服务器实例的缓存来付费。应该没问题。如果您想在更广泛的范围内注册缓存，请考虑将其注册到 JNDI。

缓存的问题。基本上，您正在通过 web 服务检索 xml。如果你通过 HTTP 访问这个 web 服务，你可以在你身边安装简单的 HTTP 代理服务器来处理 xml 的缓存。下一步将在某种本地对象缓存中缓存已解析的 xml。每个服务器都可以存在此缓存，没有任何问题。在第二种情况下，EHCache 将完成完美的工作。在这种情况下，处理链将是这样的`Client - http request -> servlet -> look into local cache - if not cached -> look into http proxy (xml files) -> do proxy job (http to webservice)`。

优点：

*   每个服务器实例的本地缓存，仅包含来自请求的 xml 的对象
*   一个 http 代理在与我们的 webapp 相同的硬件上运行。
*   无需为 xml 文件添加新的 http 代理即可扩展 webapp。

缺点：

*   下一级基础设施
*   +1 故障点（http 代理）
*   更复杂的部署

更新：不要忘记始终将 HTTP HEAD 请求发送到代理以确保缓存是最新的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-31T04:44:34.213

**选项 #1：使用开源缓存库，例如 EHCache**

当有许多不错的开源替代方案可供您加入并开始使用时，不要实现自己的缓存。实现自己的缓存比大多数人意识到的要复杂得多，如果你不知道你在做什么线程，你很容易开始重新发明轮子并解决一些非常困难的问题。

我推荐 EHCache 它是在 Apache 许可下的。您需要查看[EHCace 代码示例](http://ehcache.org/documentation/code-samples)。

**选项 #2：使用 Squid**

一个更简单的解决方案是使用 Squid... 将 Squid 置于请求缓存数据的进程和发出请求的系统之间：[http ://www.squid-cache.org/](http://www.squid-cache.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T06:24:37.217

在自己环顾四周之后，似乎实现我需要的最简单方法（在问题中描述的要求和可接受的限制范围内）是将我的缓存对象添加到 Servlet 上下文中，并查找它（或传递它）在需要的地方。

我只需从 ServletContextListener 实例化我的配置加载器，并在 contextInitialized() 方法中，我只需使用 ServletContext.setAttribute() 将其存储到 ServletContext 中。然后很容易使用 request.getSession().getServletContext().getAttribute() 从 servlet 本身进行查找。

我想这是不引入 spring 或任何其他依赖注入框架的正确方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-13T13:41:35.733

Bref，你可以使用这个现成的 spring ehcache 配置

1- **ehcache.xml**：显示 Ehcache 的全局配置。

```
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="./ehcache.xsd" updateCheck="false" monitoring="autodetect" dynamicConfig="true" name="myCacheManager">

    <!-- 
    see ehcache-core-*.jar/ehcache-fallback.xml for description of elements
    Attention: most of those settings will be overwritten by hybris
     -->
    <diskStore path="java.io.tmpdir"/>

</ehcache> 
```

2- **ehcache-spring.xml**：创建 EhCacheManagerFactoryBean 和 EhCacheFactoryBean。

```
 <bean id="myCacheManager"  class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean"
        scope="singleton">
        <property name="configLocation" value="ehcache.xml" />
        <property name="shared" value="true" />

    </bean>

 <bean id="myCache" class="org.springframework.cache.ehcache.EhCacheFactoryBean" scope="singleton">
        <property name="cacheManager" ref="myCacheManager" />
        <property name="cacheName" value="myCache" />
        <property name="maxElementsInMemory" value="1000" />
        <property name="maxElementsOnDisk" value="1000" />
        <property name="eternal" value="false" />
        <property name="diskPersistent" value="true" />
        <property name="timeToIdle" value="600" />
        <property name="timeToLive" value="1200" />
        <property name="memoryStoreEvictionPolicy" value="LRU" />
        <property name="statisticsEnabled" value="true" />
        <property name="sampledStatisticsEnabled" value="true" />
    </bean> 
```

3- 在您的业务类中注入“myCache”bean，请参阅以下示例以开始获取对象并将其放入缓存中。

```
@Resource("myCache")
private net.sf.ehcache.Cache myCache; 

@Resource("myService")
private Service myService; 

public byte[] getFromCache(final String code) 
{ 
// init Cache 
final StringBuilder builder = new StringBuilder(); 
 // key to identify a entry in cache map
final String key = code;
// get form the cache 
final Element element = myCache.get(key); 
if (element != null && element.getValue() != null) 
{ 
       return (byte[]) element.getValue(); 
} 

final byte[] somethingToBeCached = myService.getBy(code); 
// store in the cache
myCache.put(new Element(key, somethingToBeCached)); 

return somethingTobeCached; 

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-21T14:25:41.823

将缓存的对象实例放入 ServletContext 中没有任何问题。不要忘记此对象的 setAttributes 方法的其他 2 个选项（请求范围、会话范围）。任何在 webcontainers 和 j2ee 服务器中本机支持的东西都很好（我的意思是它独立于供应商，并且没有像 Spring 这样的重型 j2ee 库）。我最大的要求是服务器在 5-10 秒内启动并运行。

我真的不喜欢所有的缓存解决方案，因为它很容易在本地机器上运行，而很难让它在生产机器上运行。EHCACHE、Infinispan 等。除非您需要集群范围的复制/分发，与 Java 生态系统紧密集成，否则您可以使用 REDIS（NOSQL 数据库）或 nodejs ......任何带有 HTTP 接口的东西都可以。尤其

缓存真的很容易，这里是纯 Java 解决方案（无框架）：

```
import java.util.*;

/*
  ExpirableObject.

  Abstract superclass for objects which will expire. 
  One interesting design choice is the decision to use
  the expected duration of the object, rather than the 
  absolute time at which it will expire. Doing things this 
  way is slightly easier on the client code this way 
  (often, the client code can simply pass in a predefined 
  constant, as is done here with DEFAULT_LIFETIME). 
*/

public abstract class ExpirableObject {
  public static final long FIFTEEN_MINUTES = 15 * 60 * 1000;
  public static final long DEFAULT_LIFETIME = FIFTEEN_MINUTES;

  protected abstract void expire();

  public ExpirableObject() {
    this(DEFAULT_LIFETIME);
  }

  public ExpirableObject(long timeToLive) {
    Expirer expirer = new Expirer(timeToLive);
    new Thread(expirer).start();
  }

  private class Expirer implements Runnable {  
    private long _timeToSleep;
    public Expirer (long timeToSleep){
      _timeToSleep = timeToSleep;
    }

    public void run() {
      long obituaryTime = System.currentTimeMillis() + _timeToSleep; 
      long timeLeft = _timeToSleep;
      while (timeLeft > 0) {
        try {
          timeLeft = obituaryTime - System.currentTimeMillis();  
          if (timeLeft > 0) {
            Thread.sleep(timeLeft);
          } 
        }
        catch (InterruptedException ignored){}      
      }
      expire();
    }
  }
} 
```

请参阅此[链接](http://www.onjava.com/pub/a/onjava/2002/01/09/dataexp1.html?page=2)以获得进一步的改进。**``