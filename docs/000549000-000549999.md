# StackOverflow 问答 000549000-000549999

# nunit - 使用 NUnit 在派生类中设置？

> ID：549002
> 
> 赞同：7
> 
> 时间：2009-02-14T11:55:46.933
> 
> 标签：nunit

如果我有以下代码：

```
[TestFixture]
public class MyBaseTest
{
    protected ISessionManager _sessionManager;

    [SetUp]
    public void SetUp() { /* some code that initializes _sessionManager */ }
}

[TestFixture]
public class MyDerivedTest : MyBaseTest
{
    IBlogRepository _repository;

    [SetUp]
    public void SetUp() { /* some code that initializes _repository */ }

    [Test]
    public void BlogRepository_TestGoesHere() { /* some tests */ }
} 
```

...NUnit 不调用基本的 SetUp 例程。这是意料之中的，我本身没有问题。我可以让派生的 SetUp 首先调用基本的 SetUp，如下所示：

```
[TestFixture]
public class MyDerivedTest : MyBaseTest
{
    IBlogRepository _repository;

    [SetUp]
    public new void SetUp()
    {
        base.SetUp();
        /* some code that initializes _repository */
    } 
```

这很丑陋。如果它是一个构造函数，我就不必了。

我可以使用“模板方法”模式，并具有以下内容：

```
public void MyBaseTest
{
    abstract void SetUp();

    [SetUp]
    public void BaseSetUp()
    {
        /* base initialization */
        SetUp(); // virtual call
    }
} 
```

我也不是特别喜欢这个。

当他们的测试类需要 SetUp 并且它们派生自另一个也需要 SetUp 的类时，您会怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-14T11:58:35.740

您必须直接调用该方法。

```
 [SetUp]
   public void DerivedSetUp()
   {
      base.BaseSetUp();
      // Do something else
   } 
```

编辑：我还没有尝试过，但也许部分方法也可以。不过，我更愿意执行上述操作。

Edit2：我刚刚尝试使用部分方法。它没有用。即使是这样，我认为调用基类仍然会更容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T18:02:55.693

你有明确的基类。鉴于 NUnit 使用 [Setup] 属性来标记测试设置，我认为这对 NUnit 来说是“正确的事情”，因为它遵循通常的语言规则。

当然，NUnit 可以搜索基类，并自动调用它们的 Setup 函数，但我认为这对大多数人来说是相当令人惊讶的。

然而，至少有一个单元测试框架使用构造函数进行设置：[xUnit.Net](http://www.codeplex.com/xunit)。在这里，基类设置*被*自动调用，因为这就是 C# 中的构造函数的行为方式。

（但请注意，xUnit.Net 建议再次使用测试设置。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-20T07:55:07.800

看起来您希望设置在任何测试开始之前运行一次，而不是在每个测试运行之前运行一次。注释 [SetUp] 使该方法在您的夹具中的每个测试运行之前运行一次。[SetUp] 不被继承。

您要使用的注释是 [TestFixtureSetUp] ，它只运行一次，在夹具中的任何测试运行之前。这是以您期望的方式继承的。:)

请参阅[TextFixtureSetUp 文档](http://nunit.org/index.php?p=fixtureSetup&r=2.5.10)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T18:28:51.210

我在 Tampa 的 TDD FireStarter 中学到的一种方法是在基类中使用 setup 方法，然后在基类中使用一个名为 observe 的虚拟方法。然后在 setup 方法结束时在基类中调用此方法。

然后，您要做的是在派生自基类的新类中覆盖观察方法。这种情况下的技巧是您要执行基类的 Setup 方法，而子类没有 Setup 方法。这样做的原因是你在观察方法中的代码只是子测试类需要的那些额外的东西。

这种方法对我来说效果很好，但一个问题是测试运行者会想要执行基类测试，所以我要做的就是将测试从基类移动到一个从基类派生的新类中如果我有的话。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-14T18:25:13.610

以下适用于 MbUnit。它也可以在 NUnit 中工作。

```
[TestFixture]
public abstract class Base {
    [SetUp]
    public virtual void SetUp() {
        //Some stuff.
    }
}

public class Derived : Base {
    public override void SetUp() {
        base.SetUp();
        //Some more stuff.
    }
    [Test]
    public virtual void Object_WhenInACertainState_WhenAMethodIsCalled_Throws() {
        //Create and set state on the object.
        //Call the method.
        //Assert the method threw.
    }
} 
```

# iphone - UITabBarController 和旋转

> ID：549004
> 
> 赞同：4
> 
> 时间：2009-02-14T11:57:05.323
> 
> 标签：iphone, uitabbarcontroller, rotation

我对 UITabBarController 有一个真正的问题。我追求的结果如下： 1）在纵向模式下，一个简单的基于标签栏的应用程序（带有导航栏）没什么太花哨的。2）在横向模式下，我想使用我自己的 UIViewController 完全忽略 UITabBar。

我最后尝试的方法（我尝试了许多变体）我不明白为什么不“工作”如下：

*   我有一个自定义 UIViewController（称为此 AA），它假设管理“一切”。*   此控制器在应用程序启动时添加到窗口，并在其 loadView 中创建两个控制器：一个 UITabBarController（调用此 TBC）和一个 UILandscapeController（调用此 LSC）。然后我将 tabbarcontroller 视图添加为 AA 视图的子视图。*   现在在 AA 类中，我覆盖了 didRotate blah 或 willRotate blah 并且基本上想要在两个视图之间切换，我的意思是：（伪代码）：从纵向到横向：

```
[TBC.view removeFromSuperView];
[AA.view addSubview:LSC.view];

```

当返回纵向时，将其反转。

```
[LSC.view removeFromSuperView];
[AA.view addSubview:TBC.view];

```

我遇到的问题数量（嗯，它简单地旋转错误地创建了一个真正混乱的界面）是完全无法解释的。似乎 tabbarcontroller 视图根本不“喜欢”处于标准视图层次结构中，而是希望直接附加到屏幕上。我想知道实现我的目标的最佳方法是什么以及为什么标签栏不喜欢成为视图的子视图，

任何提示大多赞赏。

-t

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-28T09:17:47.843

以防万一您仍然需要答案，或者其他人偶然发现了这个问题，我已经做了同样的事情并让它发挥作用，但是您必须跳过一些障碍。为了旋转 UITabBarController 的视图，你必须做四件事：

1.  在切换到视图之前移除状态栏
2.  将视图旋转到新框架
3.  将状态栏添加回视图
4.  切换到视图。

我有一个 RootRotationController ，它看起来像这样：

```
@implementation RootRotationController

#define degreesToRadian(x) (M_PI * (x) / 180.0)

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    if ((UIInterfaceOrientationPortrait == interfaceOrientation) || (UIInterfaceOrientationPortraitUpsideDown == interfaceOrientation)) {
        [[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO];
    }
    // Return YES for supported orientations
    return YES;
}

- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation duration:(NSTimeInterval)duration {
    [super willAnimateRotationToInterfaceOrientation:interfaceOrientation duration:duration];
    if (UIInterfaceOrientationLandscapeLeft == interfaceOrientation) {
        self.view = self.landscape.view;
        self.view.transform = CGAffineTransformIdentity;
        self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(-90));
        self.view.bounds = CGRectMake(0, 0, 480, 300);
    } else if (UIInterfaceOrientationLandscapeRight == interfaceOrientation) {
        self.view = self.landscape.view;
        self.view.transform = CGAffineTransformIdentity;
        self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(90));
        self.view.bounds = CGRectMake(0, 0, 480, 300);
    } else if (UIInterfaceOrientationPortrait == interfaceOrientation) {
        mainInterface.view.transform = CGAffineTransformIdentity;
        mainInterface.view.transform = CGAffineTransformMakeRotation(degreesToRadian(0));
        mainInterface.view.bounds = CGRectMake(0, 0, 300, 480);
        [[UIApplication sharedApplication] setStatusBarHidden:NO animated:NO];
        self.view = mainInterface.view;
    } else if (UIInterfaceOrientationPortraitUpsideDown == interfaceOrientation) {
        mainInterface.view.transform = CGAffineTransformIdentity;
        mainInterface.view.transform = CGAffineTransformMakeRotation(degreesToRadian(180));
        mainInterface.view.bounds = CGRectMake(0, 0, 300,480);
        [[UIApplication sharedApplication] setStatusBarHidden:NO animated:NO];
        self.view = mainInterface.view;
    }
} 
```

此外，您应该知道 shouldAutorotateToInterfaceOrientation 是在将根控制器的视图添加到窗口后立即调用的，因此您必须在应用程序委托中重新启用状态栏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T11:47:24.623

我认为您的问题来自拼写错误。将 removeFromSuperView 更改为 removeFromSuperview。尽管如此，它仍然有问题。标签栏无法正确旋转。它向上移动直到消失。

如何不删除标签栏，并使其透明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T13:17:28.437

查看文档中的`UIViewController`实例方法`rotatingFooterView`。

或者，您可以自己管理 TabBar，而不是通过`UITabBarController`.

# mysql - 在 MySQL 中保存 KML 的最佳方法是什么？

> ID：549005
> 
> 赞同：1
> 
> 时间：2009-02-14T11:58:32.230
> 
> 标签：mysql, maps, kml, area, region

我有一些我想在 KML 中捕获的特定区域（区域）的地图。在这些区域内，我需要确定地址。

如何尽可能高效地保存这些地图及其值以便以后查询它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T16:40:45.000

也许你可以使用 MySQL 空间扩展。

查看[GIS 和空间扩展](http://dev.mysql.com/tech-resources/articles/4.1/gis-with-mysql.html)以及[MySQL 上的 GIS](http://mysqlgis.com/)

# php - 如何在 CakePHP 中处理图像管理（上传、删除等）？

> ID：549007
> 
> 赞同：2
> 
> 时间：2009-02-14T12:01:38.540
> 
> 标签：php, mysql, cakephp, image, storage

我正在建立一个网站，用户可以上传图像然后“使用”它们。我想要的是关于如何管理临时上传的一些想法和想法。

例如，用户上传了一张图片，但决定不对它做任何事情，然后就离开了网站。然后我要么将文件上传到服务器，要么将其加载到服务器内存，但我怎么知道什么时候可以删除图像？首先，我想只是有一个临时的上传文件夹，它会定期清空，但感觉一定有更好的东西？

顺便说一句，我正在使用 cakePHP 和 MySQL。虽然图像存储在服务器上，但只有位置存储在 dbb。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T12:43:33.480

将有关文件的信息保存到 MySQL，并保存上次查看图像的时间 - 可以通过一些脚本完成..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T12:37:08.860

您可以尝试以某种方式定义“会话”并为用户提供一些有关它的信息。例如，在 SO 中，当您开始回答但尝试离开站点时会弹出一个窗口（您的回答将会丢失）。如果用户继续，您可以执行相同操作并删除上传的图像。当然，您仍然可以使用超时或其他一些规则（最大图像文件夹大小等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T23:43:05.533

检查文件的最后访问/修改时间以查看它是否已被使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:20:30.500

我不确定您的应用中的“临时上传”是什么意思。该文件可以上传或不上传，并且归用户所有。如果用户此时不想做任何事情，您别无选择，只能将文件留在原处。

您*可以*做的是在您的图像管理页面上的某处放置关于未使用图像的警告，但自己删除它们似乎是一种不好的做法（至少从用户的角度来看）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T16:35:20.730

作为用户，当我将图像上传到服务器（假设我以后想使用它）并离开站点时，如果我是注册用户，我不希望它被删除。

我希望它在我的帐户中一直存在，直到我回来。我建议考虑这些方面并实施一种解决方案以尽可能保存用户的图像。

# asp.net - 使用 ASP.NET 表单身份验证的用户模拟

> ID：549016
> 
> 赞同：6
> 
> 时间：2009-02-14T12:04:55.333
> 
> 标签：asp.net, forms-authentication

**场景：**在电子商务系统中，帮助台用户应该能够“模拟”或“登录”特定客户（来自基于 Web 的管理站点），以便他可以直接支持客户 - 例如。当客户打电话时。

附加说明：无需跟踪原始身份验证上下文。我们只需要提供一个“登录为”按钮，该按钮将以客户身份登录，而帮助台用户无需知道密码。

任何想法如何使用常规 ASP.NET 表单身份验证来实现此场景？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T12:17:10.423

也许我不完全理解这个场景。但是为什么不让支持以用户身份登录呢？

```
FormsAuthentication.SetAuthCookie("yourCustomersUserName"); 
```

然后由电子商务系统决定是否有更新的“购物车”或任何支持可以提供帮助的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-17T21:44:31.827

我能够让这个工作，假设你已经有一个用户已经登录，你可以用下面的代码模拟另一个用户。

```
FormsAuthentication.SignOut();

FormsAuthentication.SetAuthCookie("username", true ); 
```

# c# - 可视化编辑 C# imagemap 控件？

> ID：549020
> 
> 赞同：0
> 
> 时间：2009-02-14T12:08:10.413
> 
> 标签：c#, asp.net, visual-studio-2008, imagemap

我刚刚在 Visual Studio 2008 中发现了 imagemap 控件。我熟悉 HTML 中的 imagemap 概念，我只是习惯于使用允许您以可视方式选择区域的编辑器，例如在图像本身上绘制热点，以及软件生成 HTML 本身。但我不能在 Visual Studio 中做到这一点，而且我有大约 20 个不同的圆形热点要创建。我也不知道如何轻松检测坐标（X 和 Y）。有小费吗？建议？想法？

在编辑中添加 - 另外，有没有办法向图像地图中的每个热点添加代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T16:44:22.870

不，AFAIK 没有对热点的设计师支持 - 我使用一张纸。

关于代码，您必须为每个热点设置 HotSpotMode="PostBack" PostBackValue="HS1" 并在 ImageMap1_Click 中使用 switch 语句来响应不同的 Postback 值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-16T10:15:01.070

您可以使用 jQuery 捕获图像地图上的鼠标点击，然后将鼠标位置的`x, y`坐标传递给文本框。最后，您可以将捕获的区域添加到图像地图中。

# vb.net - 在使用 Linq sum 时，会将值四舍五入。如何避免这种情况？

> ID：549023
> 
> 赞同：0
> 
> 时间：2009-02-14T12:13:43.503
> 
> 标签：vb.net, linq

数据 ：

```
Empcode    Amount
30034      27.25
30034      124 
```

链接码

```
 Dim ComputedData = From p In AllOrders _
                       Order By p.Field(Of String)("EmpCode") _
                     Group By Key = p.Field(Of String)("EmpCode") Into Group _
                     Select EmpCode = Key, _
                            Consumption = Group.Sum(Function(p) p("Amount")) 
```

输出

```
Empcode    Amount
30034       151 
```

问题是我必须收到 151**.25** 但输出只有 151。

如何避免这种四舍五入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T12:34:50.817

从您的代码段很难看出，问题可能出在“金额”列的类型或您显示结果的方式上。考虑这个没有问题的等效代码：

```
Module Module1

  Sub Main()
    Dim allOrders As New List(Of Order)
    allOrders.Add(New Order("30034", 27.25D))
    allOrders.Add(New Order("30034", 124))
    Dim ComputedData = From p In allOrders _
                         Order By p.EmpCode _
                         Group By Key = p.EmpCode Into Group _
                         Select EmpCode = Key, _
                            Consumption = Group.Sum(Function(p) p.Amount)
    Console.WriteLine("{0:N2}", ComputedData(0).Consumption)
    Console.ReadLine()
  End Sub

  Public Class Order
    Public EmpCode As String
    Public Amount As Decimal
    Public Sub New(ByVal emp As String, ByVal amt As Decimal)
      EmpCode = emp
      Amount = amt
    End Sub
  End Class
End Module 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T12:28:27.010

似乎`Sum`将值视为导致舍入的整数。您可以尝试将值类型转换为浮点数，也可以向 sum 函数提供类型参数以使用浮点数。注意 - 我不是 VB 开发人员，所以事情可能与我预期的有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T12:30:40.263

我不确定（我不知道你的代码段的语言），但尝试类似

```
Group.Sum(Function(p) p.Field(Of Decimal)("Amount")) 
```

或者

```
Group.Sum(Function(p) p.Field(Of Double)("Amount")) 
```

形成您的结果似乎 Sum 是用 Integer 调用的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T12:33:10.243

使用Cdbl，问题解决了

```
Dim ComputedData = From p In AllOrders _
                   Order By p.Field(Of String)("EmpCode") _
                 Group By Key = p.Field(Of String)("EmpCode") Into Group _
                 Select EmpCode = Key, _
                        Consumption = Group.Sum(Function(p) CDec(p("Amount"))) 
```

编辑： Cdbl 给出了一些 1.05 作为 1.1 作为 1.150000000006 的输出，所以改用 CDec

# c++ - 如何将图像作为资源包含在 C++ 可执行文件中？

> ID：549031
> 
> 赞同：5
> 
> 时间：2009-02-14T12:20:09.260
> 
> 标签：c++, windows, resources

是否可以将图像（jpegs）作为资源包含在 win32 c++ 可执行文件中？如果有怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T16:18:55.800

如果只是 Windows，则使用自定义资源。如果您想要跨平台的东西，那么请按照我为最近的项目所做的操作 - 创建一个应用程序，将 JPEG 编码为`char*`头文件中的缓冲区，然后将这些头文件包含在您的主项目中。您还需要存储缓冲区的大小，因为它肯定包含 NUL。

例如，我有一个应用程序，您可以通过它传递大量要编码的文件，并且对于每个文件，您都会获得一个看起来像这样的头文件：

```
#ifndef RESOURCE_SOMEFILE_JPG_HPP
#define RESOURCE_SOMEFILE_JPG_HPP

namespace resource {

const char* SOMEFILE_JPG[] =
{
  ...raw jpeg data...
};

const int SOMEFILE_JPG_LEN = 1234;

} // resource

#endif // RESOURCE_SOMEFILE_JPG_HPP 
```

该应用程序必须以`\x`格式转义特殊的不可打印字符，但这非常简单。该应用程序使用该`boost::program_options`库，因此可以将要编码的文件列表存储在配置文件中。每个文件都有自己的标题，类似于上面。

但是，请注意 - 这仅适用于小文件，因为某些编译器对静态字符缓冲区的最大大小有限制。我确信还有其他方法可以做到这一点，但这个方案对我有用（一个以这种方式存储 HTML、CSS、JavaScript 和图像文件的 C++ Web 应用程序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T13:00:29.070

这是有关资源文件的 MSDN 文档。

[http://msdn.microsoft.com/en-us/library/aa380599(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa380599(VS.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T12:32:04.490

也许[这](http://www.codeproject.com/KB/graphics/load_jpeg__gif_resource.aspx)就是你要找的东西？

# internet-explorer - 如何解决IE中TInyMCE的问题？

> ID：549041
> 
> 赞同：0
> 
> 时间：2009-02-14T12:27:41.847
> 
> 标签：internet-explorer, tinymce

我得到了这段代码来改变 textareas 以使用 TinyMCE 作为编辑器。它在 Firefox 中运行良好，但 IE 显示带有代码的简单文本区域。有人可以帮我做什么吗？

```
 print("<script language=\"javascript\" type=\"text/javascript\" src=\"jscripts/tiny_mce/tiny_mce.js\"></script>");

  echo('<script type="text/javascript">tinyMCE.init({   theme : "advanced", mode : "textareas",
   plugins : "safari,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",

        theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",
        theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
        theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
        theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak",
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_statusbar_location : "bottom",
        theme_advanced_resizing : "true",
   });</script>');
  echo("</head>\n"); 
```

这就是 IE 所说的（代码）：

```
<script language="javascript" type="text/javascript" src="jscripts/tiny_mce/tiny_mce.js"></script><script type="text/javascript">tinyMCE.init({ theme : "advanced", mode : "textareas",
   plugins : "safari,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",

        theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",
        theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
        theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
        theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak",
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_statusbar_location : "bottom",
        theme_advanced_resizing : "true",
   });</script> 
```

IE 中的错误表示它在第 17 行和第 4 个字符上需要标识符、字符串或整数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T13:25:23.020

您的 JSON 中有一个额外的逗号 - 大括号前不允许有逗号。

改变

```
theme_advanced_resizing : "true", 
```

到

```
theme_advanced_resizing : "true" 
```

它应该可以工作

# css - 关于溢出的问题：隐藏

> ID：549059
> 
> 赞同：0
> 
> 时间：2009-02-14T12:38:00.683
> 
> 标签：css

我有两个带浮动的 div：对：

```
<div id="container" style="width:760px">
  <div id="d1" style="float:right;"></div>
  <div id="d2" style="float:right;"></div>
</div> 
```

如果两个 div 的内容都太宽而无法放入它们的容器中，我想隐藏 d2 中的任何溢出（这一切都应该是一行，不能在第二行换行）。正如您可能已经猜到的，内容的宽度不是固定的，并且您知道溢出：如果未指定宽度，隐藏将不起作用。

在此先感谢您的任何建议 ...

编辑：在阅读了 tharkun 的评论后，我想我可能应该更多地澄清我想要实现的目标，所以我创建了这个草稿：

[http://www.waleedeissa.com/temp/css-problem.gif](http://www.waleedeissa.com/temp/css-problem.gif)

正如您在上图中看到的，我有一个会员菜单（会员菜单中的链接有时会略有不同 - 通知会员某些事件），也如您在图片中看到的那样，显示会员名称在菜单旁边，由于成员名称是由成员选择的，因此它的宽度因一个成员而异，我担心对于某些成员来说它可能会变得太宽，这会导致成员名称显示在菜单下方而不是它的左边，所以，如果成员名称太长，我想隐藏它的一部分（使用溢出：隐藏），以便它适合停留在同一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T13:23:53.133

您可以尝试以下方法：

```
#d2 {
    height: 1em;
    overflow: hidden;
} 
```

但是您已经指定这可能行不通。

无论如何，我不会尝试这样做，因为在浮动元素时需要指定**宽度。**

另一种解决方案是使用 javascript 动态计算和设置宽度。

**编辑：**另一个解决方案是将**text-align:right**设置为您的容器并将**display:inline**设置为 d1 和 d2。这样你就可以尝试在不违反 css 标准的情况下设计 d2 样式。

**第三种解决方案：**您也可以尝试将 MemberName absolute 定位在 d1 或 d2 内（左侧）。这样你就可以给 d1/d2 一个固定的宽度（=适合浮点数），并且 MemberName 将自动在左侧的屏幕之外用完。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T13:27:58.630

尝试这个：

```
<html>
<head>
  <title>Layout</title>
  <style type="text/css">
    .container { border: 1px solid black; overflow: hidden; white-space: nowrap; text-align: right; }
    .container div { display: inline; }
    .d1 { background: yellow; }
    .d2 { background: #DDD; }
  </style>
</head>
<body>
<table>
<div class="container" style="width:300px">
  <div class="d1">this is the content of the first div</div>
  <div class="d2">this is the content of the second div</div>
</div>
<div class="container" style="width:300px">
  <div class="d1">first div</div>
  <div class="d2">second div</div>
</div>
</body>
</html> 
```

# sql - 我什么时候应该关注交易规模？

> ID：549060
> 
> 赞同：1
> 
> 时间：2009-02-14T12:38:20.107
> 
> 标签：sql

我有一个需要合并用户记录的功能。用户选择保留用户和丢弃用户。

我们与数据库中的用户记录有 59 个关系，因此对于我需要做的每一个：

`UPDATE (Table) set UserNo=(userToKeep) WHERE UserNo=(userToDiscard)`

然后删除 userToDiscard 及其用户偏好 (118)。

我应该担心交易规模吗？这是 MS-SQL 2005。

有什么我可以做的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T13:57:09.417

您是否测试过该过程实际需要多长时间？用户多久合并一次？

如果您在此表中的每个表中都有用户 ID 索引（我认为无论如何这都是自然而然的事情），那么即使有 59 个表，执行这些更新和删除也不应该花费太长时间。如果您实际上每周只合并用户几次，那么像这样的小问题应该不是问题。在最坏的情况下，有人必须多等几秒钟才能每周做一两次。

另一种选择是将这些用户合并请求保存在一个表中，并在每晚的过程中执行实际工作（或者在您的应用程序的“下班时间”时）。尽管合并不会立即生效，但您需要向应用程序的用户说明清楚。您还需要考虑很多可能的意外情况：如果同一用户被设置为当晚与两个不同的用户合并，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T12:44:07.207

这取决于您的用户表有多大，以及您有哪些索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T19:26:19.607

合并用户听起来不像是经常使用的功能。鉴于此，您有 98% 的可能性不应该担心事务大小（剩余 2% 保留用于可能的死锁）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T19:36:54.153

通常事务应该是最小的大小，它们需要最小化争用和可能的死锁情况。（尽管将它们设置得太小也会导致开销）如果某些行先更改而其他行稍后更改，针对这些表的查询会给出不正确的结果吗？根据您的应用程序，这可能会导致业务问题。

知道每个表中将更新多少行吗？如果每个用户在一个表中可能有数百万行，那么您可能需要比每个表中只有几行更小心。

# web-services - 世界时钟网络服务？

> ID：549079
> 
> 赞同：6
> 
> 时间：2009-02-14T12:52:29.480
> 
> 标签：web-services

您使用的最可靠的世界时钟 Web 服务是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-14T13:04:56.343

不幸的是，由于从机器到服务器来回传输消息/数据包的延迟问题，您可能永远无法获得真正准确的原子钟*Web服务。*

大多数可通过 Internet 访问的原子钟都使用称为[网络时间协议](http://en.wikipedia.org/wiki/Network_Time_Protocol)的特定协议，该协议包括一个抖动缓冲区，该缓冲区专门考虑并根据传输延迟进行调整。与通过 HTTP 使用 Web 服务相比，这提供了更准确的原子钟时间表示。

我认为如果您必须使用*网络*服务，最准确的服务将是托管在物理和地理上离您最近的服务器上，并且从您自己的机器到服务器的网络跳数最少，因为这将减少数据包的延迟。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T13:15:29.877

了解延迟。考虑到这一点，我去[NIST](http://nist.time.gov/timezone.cgi?Eastern/d/-5/java)的网站查看美国时间，其余时间访问[世界时间服务器](http://www.worldtimeserver.com/)。不知道是否是“最好的”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T12:53:40.817

我认为由于延迟，没有可靠的原子钟网络服务这样的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-14T15:32:56.507

[这是一篇博客文章，得出了相同的结论](http://weblogs.asp.net/jgalloway/archive/2004/04/08/110029.aspx)。

纯粹主义者很快就指出了准确性问题。但我敢打赌，即使您的应用程序与原子钟软件本身位于同一台服务器上，您也无法获得完全准确的时间。

我认为需要一个时钟网络服务。我可以想到一些场景，几秒钟的时间并不重要。

除了准确性之外，提供日期和时间的另一个具有挑战性的领域是考虑到大多数国家/地区的夏令时细节。即使是最新的操作系统也很难做到这一点。但这绝对会让时钟 Web 服务变得有价值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-08T18:21:53.340

由于提供时间的网络服务很少，[http](http://www.timeapi.org/utc/now) ://www.timeapi.org/utc/now 是我所知道的唯一可靠的网络服务（除了[http://www.earthtools.org/timezone/0/ 0](http://www.earthtools.org/timezone/0/0)，这似乎不可靠）。因此它是我能推荐的最准确的一个，特别是如果你只是用它来确定本地时间和 UTC 时间之间的差异，它可以四舍五入到最接近的 15 分钟。如果您想要特定时区的时间，请替换为时区`utc`的三个字母缩写，即东部标准时间的[http://www.timeapi.org/est/now](http://www.timeapi.org/est/now)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-24T03:41:46.730

只要延迟是可预测的，NTP 网络服务就可以了。NTP 是一种有线协议，非常轻量级，可以删除任何可能导致延迟额外变化（也称为抖动）的移动部分。SOAP 堆栈会引入更多的可变性。

# c# - .NET Entity framework 项目布局（架构）

> ID：549086
> 
> 赞同：12
> 
> 时间：2009-02-14T12:56:14.727
> 
> 标签：c#, asp.net, entity-framework, architecture, web-architecture

我正在尝试确定如何最好地构建 .NET 实体框架项目以实现良好的分层方法。到目前为止，我已经在一个玩家拥有和操作行星的基于浏览的游戏中进行了尝试。这就是我得到它的方式：

**网站**

这包含所有的前端。

**C# 项目 - MLS.Game.Data**

这包含带有我所有数据映射的 EDMX 文件。这里不多。

**C# 项目 - MLS.Game.Business**

这包含我称之为“经理”的各种类，例如 PlanetManager.cs。行星管理器具有各种用于与行星交互的静态方法，例如*getPlanet(int planetID)*，它将从 MLS.Game.Data 返回生成的代码对象。

从网站上，我会做这样的事情：

`var planet = PlanetManager.getPlanet(1);`

它从 MLS.Game.Data（从 EDMX 生成）返回一个*Planet对象。*它有效，但它在一定程度上困扰着我，因为这意味着我的前端必须引用 MLS.Game.Data。我一直觉得 GUI 应该只需要引用业务项目。

此外，我发现我的 Manager 课程往往会变得非常繁重。我最终会得到几十个静态方法。

所以......我的问题是 - 其他人如何布置他们的 ASP EF 项目？

**编辑**

不过，再过一些之后，还有一些让我烦恼的东西。例如，假设我有我的 Planet 对象，它也是由向导生成的代码。如果有一天我的星球需要有一个专门的属性，比如说“人口”，它是基于星球对象的其他属性的某种计算。我想创建一个继承自 Planet 的新类然后返回它吗？（嗯，我想知道这些类是否被 EF 密封？）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T13:29:52.337

您可以尝试以下方法来改进：

*   使用 EF 获取数据层中的 DTO，然后使用这些 DTO 在业务层中填充更丰富的业务对象。您的 UI 将只需要引用业务层。
*   一旦您创建了丰富的业务对象，您就可以开始从管理器类中内化一些逻辑，从而有效地清理业务层。

我个人更喜欢更丰富的模型而不是管理器模型，因为正如您所说，您最终会得到大量静态方法，最终不可避免地会在其他静态方法中链接在一起。我觉得这太混乱了，更重要的是，在任何给定时间点都难以理解和保证对象的一致性。

如果您将逻辑封装在类本身中，则无论外部调用者的性质如何，您都可以更加确定对象的状态。

顺便说一句，一个很好的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T13:33:36.900

恕我直言，您当前的布局很好。在您调用它时，您的 UI 引用“数据”层是完全正常的。我认为您的担忧可能是由于术语而引起的。您描述的“数据”通常被称为“业务对象”（BOL）层。然后，一个常见的布局将是有一个业务逻辑层 (BLL)，它是您的“经理”层和一个数据访问层 (DAL)。在您的场景中，LINQ to Entites（假设您将使用它）是您的 DAL。一个正常的参考模式将是： -

UI 引用 BLL 和 BOL。BLL 引用 BOL 和 DAL (LINQ to Entites)。

请查看[本系列文章](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476)以获取更多详细信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T16:17:06.587

至于您的第二个问题（在编辑之后），如果您需要或想要向您的 EF 对象添加功能，您可以使用部分类。右键单击 EDMX 文件并选择查看代码。

或者，如果这还不够，您可以放弃设计器并编写自己的启用 EF 的类。

这里有两个选项的（简要）讨论 - [http://msdn.microsoft.com/en-us/library/bb738612.aspx](http://msdn.microsoft.com/en-us/library/bb738612.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T17:18:15.503

至于“编辑”部分中的第二个问题：

如果我没记错的话，EF 生成的类不是密封的，它们是*PARTIAL*类，因此您可以轻松扩展这些类，而无需接触生成的文件本身。

生成的类将是：

```
public partial class Planet : global::System.Data.Objects.DataClasses.EntityObject
{
 ...
} 
```

因此您可以轻松地创建自己的“PlanetAddons.cs”（或任何您想调用的名称）来扩展此类：

```
public partial class Planet 
{
 property int Population {get; set;} 
 ...
} 
```

很整洁，嗯？无需派生和创建人工对象层次结构......

马克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T13:10:28.203

我不是专家，但这对我来说听起来不错。这类似于我的解决方案中的内容，只是我只是将 EF 项目与业务项目合并。我的解决方案不是那么大，我的对象不需要太多的智能，所以对我来说很好。对于我的每个静态助手类，我也有很多不同的方法。

如果您不想让表示层知道数据访问层，那么您必须创建一些中间类，这可能需要大量工作。那么您当前的设置有什么问题？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T14:16:18.933

你的布局看起来不错。我会添加一个实用程序/公共层

Web UI
业务层
数据对象
实用程序层

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T16:01:54.270

我会将 DTO 添加到您的业务层，它们是数据层中实体的“哑对象”表示（即只有属性）。然后您的“经理”类可以返回它们，例如：

```
class PlanetManager
{
    public static PlanetDTO GetPlanet(int id) { // ... }
} 
```

而你的 UI 只能通过 POCO 处理 BLL 层；管理器（我称之为“映射器”类）处理对象和数据层之间的所有转换。此外，如果您需要扩展类，您可以在 DTO 对象上拥有一个“虚拟”属性，并让 Manager 将其转换回其组件。

# python - 使用 Python 隐藏文件夹/文件

> ID：549109
> 
> 赞同：12
> 
> 时间：2009-02-14T13:18:57.620
> 
> 标签：python

有没有办法用 Python 隐藏文件夹/文件？

我正在做一个巨大的项目（漏洞扫描器）。该项目创建了很多文件和文件夹。因此问题是，有没有办法制作隐藏文件和文件夹的脚本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-24T14:03:39.900

如果您不想麻烦使用 pywin32，您可以在标准库中使用 ctypes 调用 SetFileAttributes。

```
ctypes.windll.kernel32.SetFileAttributesW(path, 2) 
```

`path`必须是 unicode 字符串类型，因为这是 SetFileAttributes 的 unicode 版本。常量 2 来自[该页面](http://msdn.microsoft.com/en-us/library/aa365535%28v=vs.85%29.aspx)(FILE_ATTRIBUTE_HIDDEN)。我想没有办法从 ctypes 中获得好的常量名称，所以你必须自己查找它们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T01:28:15.980

如果这适用于 Windows：

[http://code.activestate.com/recipes/303343/](http://code.activestate.com/recipes/303343/)

总结：import win32api,win32con,os win32api.SetFileAttributes(filename,win32con.FILE_ATTRIBUTE_HIDDEN)

如果对于 Unix：

文件名 = "." + 文件名

对于文件名中的文件地址，使用 r 作为前缀，因为地址包含反斜杠...例如 r"c:...\file"

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-14T13:29:28.580

```
import tempfile 
```

请参阅[文档](http://docs.python.org/library/tempfile.html)。

这里的“隐藏文件”是指[“文件只能由创建用户ID读写”。](http://docs.python.org/2/library/tempfile.html#tempfile.mkstemp)即，意思是“对其他用户隐藏文件”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T13:26:08.167

如果您可以将数据放在 DBM 样式文件中，那么您将只有一个数据文件。

[http://docs.python.org/library/anydbm.html](http://docs.python.org/library/anydbm.html)

您可以使用数据库中的键代替文件名，并且可以通过对数据库进行索引来找到文件的内容。

这要求您的个人文件足够小，以便在您每次需要访问其中的一部分时轻松完全加载。如果它们很大，那么考虑拆分它们并使用 DBM 密钥来访问它的块。例如，如果“example.txt”包含许多行，并且您希望能够单独访问每一行，则可以将其存储为`db["example.txt/l1"]`...<code>db["example.txt/l42"]。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T13:31:37.827

.$filename 是您正在寻找的那种东西吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-12T04:03:43.143

有可能（至少使用 linux 和 ext fs）打开/创建文件并仅保留可用于来自活动进程的读/写操作的文件处理程序，但没有其他进程可以看到目录或任何地方列出的该文件。

它取决于操作系统和文件系统，它很简单，例如：

```
fh = open("data", "w+")
os.system("unlink data")
fh.write(sth)
... 
```

非常不稳定的文件和有点棘手的解决方案，但工作正常。

# ruby-on-rails - 使用 Ruby on Rails 进行高性能 RSS/Atom 解析

> ID：549127
> 
> 赞同：7
> 
> 时间：2009-02-14T13:36:52.930
> 
> 标签：ruby-on-rails, ruby

我需要解析数以千计的提要，而性能是一项基本要求。你有什么建议吗？

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-14T14:29:00.213

我没有尝试过，但我最近读到了[Feedzirra](http://github.com/pauldix/feedzirra/)（它声称是为性能而构建的）：-

> Feedzirra 是一个供稿库，旨在尽快获取和更新许多供稿。这包括通过 taf2-curb gem 使用 libcurl-multi 以获得更快的 http 获取，以及通过 nokogiri 和 sax-machine 使用 libxml 以获得更快的解析。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T15:20:05.147

您可以使用 RFeedParser，它是（著名的）Python Universal FeedParser 的 Ruby 端口。它基于 Hpricot，而且非常快速且易于使用。

[http://rfeedparser.rubyforge.org/](http://rfeedparser.rubyforge.org/)

一个例子：

```
require 'rubygems'
require 'rfeedparser'
require 'open-uri'

feed = FeedParser::parse(open('http://feeds.feedburner.com/engadget'))

feed.entries.each do |entry|
  puts entry.title
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T06:37:12.603

当你只有一把锤子时，一切看起来都像钉子。为此考虑使用 Ruby 以外的解决方案。尽管我喜欢 Ruby 和 Rails，并且不会因为 Web 开发或特定领域的语言而放弃它们，但我更喜欢用 Java、Python 甚至 C++ 执行您描述的那种类型的大量数据提升。

鉴于此解析数据的目的地可能是数据库，它可以充当解决方案的 Rails 部分和其他语言部分之间的公共点。然后，您将使用最好的工具来解决您的每个问题，结果可能更容易处理并真正满足您的要求。

如果速度真的很重要，为什么要在上面加上额外的限制并说：“哦，只要我能使用 Ruby，它才是最重要的。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T13:51:26.077

不确定性能，但在[Parsing Atom & RSS in Ruby/Rails 中回答了类似的问题？](https://stackoverflow.com/questions/214590/parsing-atom-rss-in-ruby-rails)

您还可以查看 Hpricot，它解析 XML，但假定它的格式正确且不进行任何验证。

[http://wiki.github.com/why/hpricot](http://wiki.github.com/why/hpricot) [http://wiki.github.com/why/hpricot/hpricot-xml](http://wiki.github.com/why/hpricot/hpricot-xml)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-09T21:29:11.250

最初我使用 nokogiri 进行一些基本的 xml 解析，但它很慢而且不稳定（有时）我切换到[feedzirra](http://github.com/pauldix/feedzirra/)并且不仅有很大的性能提升，而且没有错误并且它像馅饼一样简单。下图示例

```
# fetching a single feed
feed = Feedzirra::Feed.fetch_and_parse("http://feeds.feedburner.com/PaulDixExplainsNothing")

# feed and entries accessors
feed.title          # => "Paul Dix Explains Nothing"
feed.url            # => "http://www.pauldix.net"
feed.feed_url       # => "http://feeds.feedburner.com/PaulDixExplainsNothing"
feed.etag           # => "GunxqnEP4NeYhrqq9TyVKTuDnh0"
feed.last_modified  # => Sat Jan 31 17:58:16 -0500 2009 # it's a Time object

entry = feed.entries.first
entry.title      # => "Ruby Http Client Library Performance"
entry.url        # => "http://www.pauldix.net/2009/01/ruby-http-client-library-performance.html"
entry.author     # => "Paul Dix"
entry.summary    # => "..."
entry.content    # => "..."
entry.published  # => Thu Jan 29 17:00:19 UTC 2009 # it's a Time object
entry.categories # => ["...", "..."] 
```

如果你想对提要做更多的事情，例如解析它们，以下就足够了

```
source = Feedzirra::Feed.fetch_and_parse(http://www.feed-url-you-want-to-play-with.com)
  puts "Parsing Downloaded XML....\n\n\n"

  source.entries.each do |entry|

    begin
      puts "#{entry.summary} \n\n"
      cleanURL = (entry.url).gsub("+","%2B")  #my own sanitization process, ignore
      scrapArticleWithURL(cleanURL)
  rescue
    puts "(****)there has been an error fetching (#{entry.title}) \n\n"
  end 
```

# c# - .NET 中快速紧凑的对象序列化

> ID：549128
> 
> 赞同：59
> 
> 时间：2009-02-14T13:40:23.593
> 
> 标签：c#, .net, serialization

我想使用对象序列化在[Mono](http://en.wikipedia.org/wiki/Mono_%28software%29)服务器和 Silverlight 客户端之间通过网络进行通信。序列化的空间效率和速度非常重要，因为服务器将托管多个实时游戏。

我应该使用什么技术？BinaryFormatter 为该应用程序中不需要的序列化类（版本、文化、类名、属性名等）增加了很多开销。

我能做些什么来提高空间效率？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-02-14T14:03:18.123

您可以使用[协议缓冲区](https://github.com/google/protobuf)。我正在将我所有的序列化代码从 BinaryFormatter 压缩到 Protocol Buffers 并获得非常好的结果。它在时间和空间上都更有效。

[Jon Skeet](https://github.com/jskeet/protobuf-csharp-port)和[Marc Gravell](https://github.com/mgravell/protobuf-net)有两个 .NET 实现。

**更新**：官方 .NET 实现可以在[这里](https://github.com/google/protobuf/tree/master/csharp)找到。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2010-08-18T04:16:48.503

我有一些基于 Northwind 数据集[的领先 .NET 序列化程序的基准测试。](http://www.servicestack.net/benchmarks/NorthwindDatabaseRowsSerialization.100000-times.2010-08-17.html)

![Northwind .NET 序列化基准测试](https://i.stack.imgur.com/zlOnT.png)

@marcgravell 二进制 protobuf-net 是基准测试中最快的实现，比 BCL 中可用的 Microsoft 最快的序列化程序（XML DataContractSerializer）快约**7 倍。**

我还维护了一些开源的高性能 .NET 文本序列化器：

*   [JSV TypeSerializer](http://www.servicestack.net/mythz_blog/?p=176)一种紧凑、干净、类似 JSON+CSV 的格式，比 DataContractSerializer 快 3.1 倍
*   以及快 2.6 倍的[JsonSerializer](http://www.servicestack.net/mythz_blog/?p=344)。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-02-14T15:36:48.740

作为作者，我会邀请您尝试[protobuf-net](http://code.google.com/p/protobuf-net/)；它附带了[Mono](http://en.wikipedia.org/wiki/Mono_%28software%29) 2.0 和[Silverlight](http://en.wikipedia.org/wiki/Microsoft_Silverlight) 2.0 的二进制文件，并且[快速高效](http://code.google.com/p/protobuf-net/wiki/Performance)。如果您有任何问题，请给我发电子邮件（请参阅我的 Stack Overflow 个人资料）；支持是免费的。

Jon 的版本（请参阅之前接受的答案）也非常好，但 IMO protobuf-net 版本对于 C# 来说更惯用 - 如果您将 C# 与 Java 交谈，Jon 的版本将是理想的，因此您可以在两端拥有类似的 API。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-06-13T10:24:45.340

我有一个类似的问题，虽然我只是使用.NET。我想尽可能快速轻松地通过 Internet 发送数据。我没有找到任何足够优化的东西，所以我制作了自己的序列化器，命名为[NetSerializer](http://www.taika.org/~tomba/netserializer/index.html)。

NetSerializer 有其局限性，但它们并没有影响我的用例。而且我已经有一段时间没有做基准测试了，但它比我发现的任何其他东西都要快得多。

我还没有在 Mono 或 Silverlight 上尝试过。我敢打赌它适用于 Mono，但我不确定 Silverlight 上 DynamicMethods 的支持程度如何。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-14T14:45:10.550

您可以尝试使用 JSON。它的带宽效率不如协议缓冲区，但使用 Wireshark 等工具监视消息会容易得多，这在调试问题时很有帮助。.NET 3.5 带有一个 JSON 序列化程序。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-14T13:48:25.757

您可以通过**DeflateStream**或**GZipStream**传递数据以在传输之前对其进行压缩。这些类位于**System.IO.Compression**命名空间中。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-08-10T16:41:42.427

我有一个非常相似的问题 - 保存到文件。但是以下内容也可以通过网络使用，因为它实际上是为远程处理而设计的。

解决方案是使用 Simon Hewitt 的库 - 请参阅*[.NET 中的优化序列化 - 第 2 部分](https://www.codeproject.com/Articles/16017/Optimizing-Serialization-in-NET-part)*。

[文章的第 1 部分](https://www.codeproject.com/kb/dotnet/fastserializer.aspx)指出（粗体是我的重点）：“...如果您曾经使用 .NET 远程处理大量数据，您会发现可伸缩性存在问题。对于少量数据，它工作得很好，但是更大的数量会占用大量的 CPU 和内存， **生成大量数据进行传输**，并且可能会因内存不足异常而失败。实际执行序列化所花费的时间还有一个大问题 - 大大量数据可能使其无法在应用程序中使用......”

对于我的特定应用程序，我得到了类似的结果，保存速度提高了 40 倍，加载速度提高了 20 倍（从几分钟到几秒）。序列化数据的大小也大大减少。具体记不太清了，至少有2-3次。

这很容易上手。但是有一个问题：仅对最高级别的数据结构使用 .NET 序列化（开始序列化/反序列化），然后直接为最高级别数据结构中的字段调用序列化/反序列化函数。否则将不会有任何加速...例如，如果 `Generic.List`库不支持特定的数据结构（例如），则将使用 .NET 序列化，这是一个禁忌。而是在客户端代码（或类似代码）中序列化列表。有关示例，请参见“'这是我们自己的编码”附近的示例。在与下面列出的相同功能中。

供参考：[我的应用程序中的代码](http://pmortensen.eu/1/MSQuant/MSQsrcWWW,1.5,2008-12-19/MSQdocDefs.vb.html)- 请参阅“注意：这是我们使用内置 .NET 的唯一地方......”附近。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-03-22T06:13:00.810

您可以尝试 BOIS，它专注于打包数据大小并提供迄今为止最好的打包。（我还没有看到更好的优化。）

[https://github.com/salarcode/Bois](https://github.com/salarcode/Bois)

# python - 在 Python 中删除字符

> ID：549130
> 
> 赞同：2
> 
> 时间：2009-02-14T13:46:31.270
> 
> 标签：python

有人知道如何删除特定字符后面的所有字符吗？

像这样：

```
http://google.com/translate_t 
```

进入

```
http://google.com 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T13:54:24.340

如果您要询问的是抽象字符串而不是 url，则可以使用：

```
>>> astring ="http://google.com/translate_t"
>>> astring.rpartition('/')[0]
http://google.com 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-14T14:32:38.880

对于 url，使用[urlparse](http://docs.python.org/library/urlparse.html)：

```
>>> import urlparse
>>> parts = urlparse.urlsplit('http://google.com/path/to/resource?query=spam#anchor')
>>> parts
('http', 'google.com', '/path/to/resource', 'query=spam', 'anchor')
>>> urlparse.urlunsplit((parts[0], parts[1], '', '', ''))
'http://google.com' 
```

对于任意字符串，使用[re](http://docs.python.org/library/re.html)：

```
>>> import re
>>> re.split(r'\b/\b', 'http://google.com/path/to/resource', 1)
['http://google.com', 'path/to/resource'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T13:50:19.590

```
str="http://google.com/translate_t"
shortened=str[0:str.rfind("/")] 
```

应该这样做。str[a:b] 在 python 中返回一个子字符串。rfind 用于查找字符序列的索引，从字符串的末尾开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-14T13:54:11.873

如果您知道字符的位置，那么您可以使用切片语法来创建一个新字符串：

```
In [2]: s1 = "abc123"
In [3]: s2 = s1[:3]
In [4]: print s2
abc 
```

要查找位置，您可以使用字符串的`find()`or`index()`方法。和方法`split()`也`partition()`可能有用。这些方法记录在[Python 文档中的序列](http://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-buffer-xrange)。

删除字符串的一部分是不可能的，因为字符串是不可变的。

如果您想处理 URL，那么您绝对应该使用[urlparse 库](http://docs.python.org/library/urlparse.html)。它允许您将 URL 拆分为多个部分。如果您只想删除文件路径的一部分，那么您仍然必须自己执行此操作。

# mfc - 如何使用 CListCtrl 和 CHeaderCtrl 添加数据过滤

> ID：549141
> 
> 赞同：2
> 
> 时间：2009-02-14T13:55:21.123
> 
> 标签：mfc, filtering, clistctrl

*背景*：
操作数据集合的应用程序通常使用包含标题的网格呈现。这些相同的应用程序通常包含一个过滤器，以允许用户缩小数据集（Excel 是一个很好的例子。还有很多其他例子）。在我的 MFC 应用程序中，我尝试使用 CListCtrl 和 CHeaderCtrl 组合来做同样的事情。这种组合已经使我的应用程序能够提供多列排序，包括使用各个标题项的图像功能来表示升序/降序排序顺序。

我已经使用我最好的 Google-fu 来查找 CHeaderCtrl 被扩展/自定义以包含自定义绘图以添加过滤器按钮并在单击时显示关联的下拉菜单以供用户输入过滤器条件的任何示例。

*问题*：

1.  有没有我错过的例子？
2.  如果互联网上没有可用的示例，在自定义 CListCtrl 和 CHeaderCtrl 时我应该考虑什么方法来实现我的目标？

*附加评论：*
其中一个答案引用了内置的 FilterBar 功能。是的，我已经看到了，但这不是我要找的。我正在寻找专门模拟 Excel 和其他启用过滤器的应用程序的非静态、非视觉侵入过滤功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T17:19:39.417

我的 Google-fu 确认您的，没有添加非侵入式过滤器界面的示例`CListCtrl`，有或没有`CHeaderCtrl`.

**简单方法**
在您的`HDN_ITEMCLICK`处理程序中，检查`((NMHEADER)lParam).iButton`. 对于`iButton == 1`，那是鼠标右键。这是您展示一点`CWnd`衍生过滤器 UI 的机会。这种方法的问题是没有视觉指示右键单击会弹出过滤器菜单。

**更复杂**
创建三个列标题图像 - 过滤器图标、向上箭头 + 过滤器图标、向下箭头 + 过滤器图标。当未按列排序时，仅显示过滤器图像，否则使用适当的箭头 + 过滤器图像。`CListCtrl`处理在级别上的单击，`NM_RCLICK`以便您获得坐标信息（[示例](http://www.codeproject.com/KB/combobox/wm_rclick.aspx)）。做一些几何图形以确定单击是否在您的过滤器图标上，如果是，则显示一个`CWnd`派生的过滤器 UI。您可以更漂亮并在标题工具提示中显示当前过滤器，使用彩色过滤器创建更多图像以显示过滤器何时处于活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T14:05:00.320

这是[你](http://translate.google.co.in/translate?hl=en&sl=zh-CN&u=http://blog.csdn.net/yjqpro/archive/2008/10/24/3135880.aspx&ei=6c6WSdKjJIG86gP5uez4CA&sa=X&oi=translate&resnum=3&ct=result&prev=/search%3Fq%3DCHeaderCtrl%2Bwith%2Bfiltering%2Bfeature%26hl%3Den%26sa%3DN)要找的吗？

由于它是其他语言，我已经给出了[谷歌搜索](http://www.google.co.in/search?hl=en&q=CHeaderCtrl%20with%20filtering%20feature&um=1&ie=UTF-8&sa=N&tab=gw)的地址。参考第二个结果。

# java - 常用的可重用注解还是公用注解？

> ID：549144
> 
> 赞同：2
> 
> 时间：2009-02-14T14:00:08.770
> 
> 标签：java, annotations

是否有任何常用的注释可用？类似于commons-lang？

如果没有，您是否看到任何有效使用注释（不是内置注释）作为任何开源应用程序开发的一部分。

我记得 Mifos 将它用于交易。

莫汉

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T15:19:01.857

我认为[Hibernate Validator](http://www.hibernate.org/hib_docs/validator/reference/en/html_single/index.html#d0e46)对于任何类型的验证都有非常好的和可重用的注释。它基于 JSR 303 的参考实现：Bean Validation。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-14T16:21:35.030

只有我在测试项目之外多次使用过的非标准注释是[WicketStuff 注释](http://wicketstuff.org/confluence/display/STUFFWIKI/wicketstuff-annotation)，它们在它们自己的上下文中非常有用。

另一个有趣的注解集也是[JSR-305](http://jcp.org/en/jsr/detail?id=305)的基础，它是[FindBugs 的注解](http://findbugs.sourceforge.net/manual/annotations.html)，它也可能在未来证明是有用的——我们将看看它是如何进行的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T04:19:12.490

查看我的 Bean 注释

[http://code.google.com/p/javadude/wiki/Annotations](http://code.google.com/p/javadude/wiki/Annotations)

像

```
@Bean(
    cloneable=true,
    defineSimpleEqualsAndHashCode=true,
    properties={
        @Property(name="name", bound=true),
        @Property(name="age", type=int.class, bound=true),
        @Property(name="friend", type=Person.class, kind=PropertyKind.LIST)
    },
    observers={
        @Observer(type=FeverListener.class)
    }
)
public class Person extends PersonGen { } 
```

注释处理器生成 PersonGen 超类。

请注意，我目前正在对它们进行重大更改，并且 API 正在更改（我仍将保留当前版本，但 3.xx 版本流将会中断）

我试图在接下来的几周内完成新版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T18:01:03.653

在核心 jre 中确实需要一组通用注释，它们在多个框架中以类似的方式使用。

例如@Transactional @Nullable

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-11T05:24:42.190

[JAXB](http://jaxb.dev.java.net)定义了在一定程度上被重用的注解（javax.xml.bind.annotation）——尽管它们被命名以表明它们只与 XML 序列化有关，但大多数元数据与要序列化的注解属性有关，因此它们可以被使用也用于序列化为其他数据格式（例如 JSON）。[Jackson JSON 处理器](http://jackson.codehaus.org/)支持它们，以及它自己的“本机”注释，因为没有真正标准化的非数据格式特定注释 (AFAIK)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-08T18:51:46.453

我喜欢椭圆形[http://oval.sourceforge.net/](http://oval.sourceforge.net/)和 JAXB

# html - 在 Safari 中使用 location.hash 滚动页面

> ID：549148
> 
> 赞同：4
> 
> 时间：2009-02-14T14:01:12.700
> 
> 标签：html, ajax, safari, dhtml

我有一个论坛页面，在当前选定的消息下方显示消息的树形视图。当您单击树中的消息时，新的消息正文将使用 AJAX 加载到页面顶部附近的**div**中，然后运行以下代码：

```
window.location.hash = "page_top"; 
```

当然，“page_top”是页面顶部附近的锚元素，因此新加载的消息正文会滚动到视图中。

这适用于除 Safari 之外的所有浏览器。在 Safari（在 PC 和 iPhone 上测试）上，它仅在您第一次设置**location.hash**时有效。如果再次设置，页面不会滚动。

最终结果是新加载的消息正文不会滚动到 Safari 中的视图中，并且每次从树中选择新消息时都必须滚动回页面顶部。

为什么 Safari 不喜欢这个，我可以做些什么来解决它？

**编辑：**

我猜这与您可以通过谷歌搜索有关 location.hash 和 Safari 的错误有关。Safari 似乎曾经有一个错误，如果您将哈希设置为相同的值两次，它会导致它重新加载页面。我猜当他们修复了这个错误时，他们修复得有点太彻底了，当你再次将 hash 设置为相同的值时，他们停止了它做任何事情。

[http://www.howtocreate.co.uk/safari/locationHashBug.html](http://www.howtocreate.co.uk/safari/locationHashBug.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T14:04:55.997

您可以先重置它：

```
window.location.hash = "";
window.location.hash = "page_top"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-26T18:44:53.160

我需要补充：

```
<div><a name="page_top"></a></div>
<div><a name="page_topnot"></a></div> 
```

使用“a name”而不是“a href”。效果很好！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T17:55:13.357

回答我自己的问题。秋葵在正确的轨道上，但并不完全在那里。

Safari 不喜欢将 location.hash 设置为空白值。相反，您需要将其设置为真正的锚值。

因此，在页面顶部，我现在拥有：

```
<div><a href="page_top"></a></div>
<div><a href="page_topnot"></a></div> 
```

我发现我需要锚点周围的 div，否则 Safari 会滚动到页面的不可预测部分而不是锚点。

然后滚动到我必须做的页面顶部：

```
window.location.hash = "page_topnot";
window.location.hash = "page_top"; 
```

有了这个，Safari 每次都会滚动到页面顶部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-31T04:19:31.733

我遇到了和你一样的问题，这个解决方案有效——我唯一注意到的是，在 IE 中，我可以听到两次点击声——所以我做了你的变体，只放了一个锚点，它也能正常工作（即调用两次，第一次，一个不存在的主播，第二次真正的主播）

最重要的是，我的锚：

```
(tag a)name="top" id="top"(end of tag a) 
```

在 javascript 中，这两个调用：

```
window.location.hash ="topnot";

window.location.hash ="top"; 
```

谢谢你的帮助！

# oop - SOLID 和用户界面？

> ID：549152
> 
> 赞同：5
> 
> 时间：2009-02-14T14:04:50.943
> 
> 标签：oop, solid-principles

我尝试遵循[SOLID](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)原则。但每次谈到用户界面时，我发现客户需要的笨拙的混合、聚合数据和单一职责的良好原则之间存在固有的摩擦。

现在*可以*将典型用户界面的各种点点滴滴划分为单一职责的类，但随后您会遇到各种有趣的构造问题，因为所谓的“分离”的 gui 块实际上经常变成是相同共享状态的不同视图，或者至少是重叠状态的部分视图。

我经常将相当笨重的控制器类混在一起用于我的视图，这些控制器类不是很像 SOLID，但这是相当不一致的编码实践，这让我有点困扰。似乎拆分它的复杂性是不值得的。

那么你如何处理呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T14:43:42.957

您是否研究过[演示模式](http://martinfowler.com/eaaDev/)（Martin Fowler 的未完成著作）？我倾向于将 Presentation Model 用于复杂视图，将 Autonomous View 用于琐碎视图。演示模型为您提供了灵活的设置，您可以轻松地测试这些类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T15:08:49.573

我觉得你说得很对。如果这是良好的用户体验对您的应用程序的要求，那么数据视图可能需要是“杂乱无章的混合聚合数据屏幕”。对于 UI，UI 的可用性比试图坚持编码设计原则更重要。代码的设计原则不应决定用户界面的外观或工作方式。然后你就会得到对代码有意义的僵化形式和视图。做对用户有意义的事情。

话虽如此，上面提到的 MVC/MVP 模式仍然可以提供帮助。将视图与演示者分开。这样，您仍然可以隔离您的视图并保留视图的 SRP。您的演示者是必须违反 SRP 并且有多种更改理由的人。

# unit-testing - 在对复合材料进行交互测试时，如何避免重复的单元测试？

> ID：549158
> 
> 赞同：1
> 
> 时间：2009-02-14T14:06:45.493
> 
> 标签：unit-testing, refactoring

想象一个过滤器系统（可能是音频过滤器，或文本流过滤器）。

`Filter`基类有一个方法`do_filter()`，它接受一些输入，修改它（也许），然后将其作为输出返回。

存在几个使用 TDD 构建的子类，每个子类都有一组单独测试它们的测试。

随之而来的是一个不相关类型的复合类，`Widget`它有两个不同`Filter`类型的成员（`a`和`b`），它们处理完全不同的输入——也就是说，某些将被过滤器修改的输入被过滤器`a`未经修改地传递`b`，反之亦然. 它的`process_data()`方法调用每个过滤器成员的`do_filter()`.

`Widget`在开发复合类时，会出现一些测试来检查' 过滤器不是都处理相同数据的假设。

问题是，这些测试看起来与单个过滤器的测试相同。尽管可能有其他测试，这些测试输入应该由两个过滤器修改，但许多测试几乎可以从每个过滤器的测试中*复制和粘贴*，只需要进行小的修改就可以让它们进行测试`Widget`（例如调用`process_data()`） ，但输入数据和断言检查是相同的。

这种重复闻起来很糟糕。但是想要测试组件的交互似乎是正确的。什么样的选择可以避免这种重复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T14:19:48.037

在一个测试套件/类中有一个方法

```
public void TestForFooBehaviour(IFilter filter) 
{
    /* whatever you would normally have in a test method */
} 
```

然后从简单过滤器的原始测试和复合过滤器中调用此方法。这也适用于抽象基类。显然 FooBehaviour 应该是对您正在测试的过滤器方面的有意义的描述。对您要测试的每个行为执行此操作。

如果您的语言支持鸭子类型或泛型，如果有帮助，请随意使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T14:13:19.160

我经常将测试逻辑提取到单独的类中，因此我会将过滤器测试提取到一个单独的类中，该类本身本质上不是单元测试。特别是如果您的测试类与您的生产代码在物理上是分开的，这确实是解决此问题的一种不错的方法（即，没有人会认为它是生产代码，因为它在测试空间中）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T14:18:29.413

我在这里询问了关于抽象基类和单元测试的类似问题，它有一些有趣的点，您可能会觉得有用。

[如何对抽象类进行单元测试：用存根扩展？](https://stackoverflow.com/questions/243274/best-practice-unit-testing-abstract-classes)

# html - 我可以直接在 html 页面中进行 XSLT 转换吗？

> ID：549162
> 
> 赞同：1
> 
> 时间：2009-02-14T14:11:00.070
> 
> 标签：html, xml, xhtml, xslt, doctype

我知道命名空间用于描述，如 doctype，但有没有办法或技巧使用 xsd 将内部命名空间 html 与 xsl 转换？

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"  xmlns:sample="sample-uri">
    <head >
        <title>Enter the title of your XHTML document here</title>
    </head>
    <body >
        <p sample:node="retrieve-transformation">Enter the body text of your XHTML document here</p>

</html> 
```

换句话说，我想知道我是否可以在不使用 javascript 的情况下将 xsl 转换为 xhtml 页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T09:19:38.307

在 XHTML（即`application/xhtml+xml`——不是！）中，您可以使用[处理指令](http://simon.html5.org/specs/xml-stylesheet5)`text/html`触发一个没有 JavaScript 的 XSLT 程序。[`xml-stylesheet`](http://simon.html5.org/specs/xml-stylesheet5)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T09:46:47.553

现代浏览器开箱即用地支持 XSLT。

看看[eu.wowarmory.com](http://eu.wowarmy.com) - 他们广泛使用它。如果服务器检测到不支持 XSLT 的用户代理，它会在服务器端呈现，并在那里呈现非常冗长的 HTML 并发送到浏览器。

如果您计划提供类似于网站的 XML Web 服务，这将是一个很好的抽象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T15:00:24.487

不，如果不使用某种脚本技术，您就无法执行 XSL 转换。我建议您在服务器端进行以节省客户端的麻烦；如果由于某种原因转换在客户端上没有成功或运行缓慢，可以避免各种问题。

# c# - Mono有多成熟？

> ID：549166
> 
> 赞同：4
> 
> 时间：2009-02-14T14:16:56.657
> 
> 标签：c#, .net, mono, maturity

mono项目atm有多成熟？我浏览了他们的网站，但没有发现任何迹象表明功能完整的单声道对 .NET 3.5 / SP1 有何影响？

**Mono[准备好迎接黄金时段了吗？](https://stackoverflow.com/questions/18450/is-mono-ready-for-prime-time)**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T14:19:05.450

看到这个问题，由 Mono 开发人员 miguel de icaza 发表评论：
[Mono 准备好迎接黄金时段了吗？](https://stackoverflow.com/questions/18450/is-mono-ready-for-prime-time/93952#93952)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T14:21:58.330

Mono 介于 .NET 2.0 和 .NET 3.5 之间
查看 mono[常见问题](http://www.mono-project.com/FAQ:_General)

# flowchart - 具有可扩展属性的工艺流程的最佳应用

> ID：549169
> 
> 赞同：1
> 
> 时间：2009-02-14T14:18:51.440
> 
> 标签：flowchart

我正在寻找最好的软件应用程序来执行以下操作

我有一组相互关联的用例。我想展示这种关系的概述。如果用户希望每个用例的属性（例如业务规则、数据元素等）应该是可扩展的。这可能是一张大地图，这就是属性应该是可扩展/可折叠的原因。

最后，所有这些都需要可打印。

对执行此操作的理想应用程序有任何想法吗？

非常感谢提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-08T10:34:38.767

我相信你不再需要这个问题的答案了，但是 google 仍然在这里指导人们，所以我会提供一个答案。

我相信免费版的[xmind](https://www.xmind.net/)会做你想做的事，结合使用以下功能：

*   主要块的浮动主题（使用 shift+drag 或菜单->修改->对齐浮动主题以避免自动对齐）
*   关系线
*   子主题的可扩展/可折叠树
*   能够“深入”到块中并显示完整的子图

该工具主要用于思维导图并且做得最好，但我相信格式对于大多数流程图来说足够灵活

我尝试过其他工具——freemind、opengeode、treeform、gliffy 和 lucidchart——但我不相信它们中的任何一个都足够灵活来满足您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T14:22:05.787

在我的脑海中，Microsoft Visio 可能会为你做这一切

# windows-vista - .NET 3.5 SP1 安装失败

> ID：549177
> 
> 赞同：0
> 
> 时间：2009-02-14T14:27:38.503
> 
> 标签：windows-vista, installation, .net-3.5

在过去的几天里，当我尝试在我的 x64 Vista Ultimate 上安装 .NET 3.5 SP1 时，我一直面临着一个只能被描述为奇怪的问题。问题首先是在尝试安装 Visual Studio SP1 时开始的，我之前在同一台机器上安装它没有任何问题，给我一个乱码，然后是一个蓝屏，说 IRQL_LESS_OR_NOT_EQUAL。我认为乱码的屏幕表明图形驱动程序存在问题，我在设备管理器中将其禁用并再次尝试设置。然后，我开始收到以下错误：

```
[02/14/09,16:17:27] Microsoft .NET Framework 2.0SP1 (x64) (CBS): [2] Error: Installation failed for component Microsoft .NET Framework 2.0SP1 (x64) (CBS). MSI returned error code 2 [02/14/09,16:17:57] WapUI: [2] DepCheck indicates Microsoft .NET Framework 2.0SP1 (x64) (CBS) is not installed. 
```

我在网上四处寻找解决方案，并尝试完全卸载 .NET（使用专门为此设计的工具）并从 Visual Studio DVD 重新安装，从 temp 目录中删除安装程序下载，但似乎没有任何帮助。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T14:44:48.693

你踏入了一大堆 doodoo，安装中止而没有回滚是不好的。尝试使用系统还原来恢复您的注册表。在你做任何事情之前，先让你的机器稳定。

# css - Internet Explorer 上非常奇怪的 CSS 问题。我不知道出了什么问题！

> ID：549178
> 
> 赞同：2
> 
> 时间：2009-02-14T14:28:11.607
> 
> 标签：css, internet-explorer, firefox, font-size

我刚刚测试了我在 Internet Explorer 中设置的网站。当然在 Firefox 中运行良好。我有一组样式表，其中大部分都有背景图片，用户可以随意选择不同的样式表。除了颜色和背景之外，样式表的呈现完全相同，当然基于文本的版本呈现不同。无论如何，我还有一个字体大小更改器，因此用户可以选择最适合他们的字体大小。当我加载大字体时，我有 4 种设置，从小、标准、大和 Xlarge 和 xlarge 字体大小 bg 图片到达我的 div 的末尾，这很好。然而，当我使用小字体和标准字体大小时，bg 图片仅占应有大小的 5%。也许下面的图片可以帮助您理解我的问题。

干杯 CHL

Ps fontsize css 仅包含类和 id 的字体大小而不是背景样式。

问题： [http ://www.webquark.co.uk/project/problem.bmp](http://www.webquark.co.uk/project/problem.bmp)

处理更大的字体大小： [http ://www.webquark.co.uk/project/working.bmp](http://www.webquark.co.uk/project/working.bmp)

Firefox 工作时的样子： [http ://www.webquark.co.uk/project/firefox.bmp](http://www.webquark.co.uk/project/firefox.bmp)

这是我设置bg的css：

```
.content{
background-image: url(springBG.jpg);/**Change for season**/
background-attachment:fixed;
background-position:top center;
background-repeat:no-repeat; 
font-family: Calibri, Ariel, sans-serif;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T14:49:18.373

在您的 CSS 声明中，您使用“Ariel”字体名称。这个应该是不存在的。宋体，就是这样。爱丽儿是某种清洁剂。

实际上，正确的非衬线序列声明应该是：

```
font-family: Calibri, Tahoma, Arial, Helvetica, Sans-Serif; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T14:34:27.923

“Internet Explorer 上的 CSS 问题。我不知道出了什么问题！”

在我的办公室几乎每天都能听到这种声音。

我唯一的建议是尝试设置背景元素的高度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T14:38:47.320

说到 CSS 问题，您帖子中的标签框下的内容会溢出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T14:41:49.293

尝试在白色 div 与背景重叠后清除浮动（其中包含所有单词）。最简单的方法是添加：

```
<div class="spacer"></div> 
```

在白色 div 的结束标记之后。如果这不起作用，请尝试将其添加到白色 div 的结束标记之前的行。间隔的 CSS：

```
.spacer
{
    clear: both;
    height: 0;
    line-height: 0;
    font-size: 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T14:42:13.770

您可以发布生成的 HTML 吗？

我猜 IE 在您的容器中看不到任何具有“内容”类的内容。这可能是因为内部内容没有“hasLayout”（一个神奇的IE东西）

正如 TM 建议的那样，尝试将高度设置为“1%”，这应该触发 hasLayout，或者设置“缩放：1；” 这也可以解决问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-14T18:19:26.527

您可以继续使用速记 css 作为背景，如下所示：

```
background: url(yourimage.jpg) no-repeat top center; 
```

此外，ie6 不支持 background-attachment:fixed 以外的 body。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-14T18:55:18.560

如果不查看其余代码或实时站点，很难确定，但这看起来像是一个经典的包含浮动问题。处理这个问题的最简单方法是添加`overflow: auto`到包含你的浮点数的框中（我猜这是`.content`，这里）。这应该将壁纸拉伸到适当的高度。

如果做不到这一点，请尝试将[Logan 建议](https://stackoverflow.com/questions/549178/very-strange-css-problem-on-internet-explorer-i-have-no-idea-what-is-wrong/549188#549188)`.content`的“clearfix”间隔添加到div的末尾。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-14T19:03:19.900

嗨，我发现了设置 div 高度所需的问题。对于那些提到这一点的人，我已经向您的代表添加了一点，并感谢您的建议：D

CHL

CSS：

```
 height:100%; 
```

# macos - 从命令行更改 Terminal.app 的背景

> ID：549186
> 
> 赞同：6
> 
> 时间：2009-02-14T14:38:35.573
> 
> 标签：macos, terminal

是否可以从外壳更改 Terminal.app 的背景颜色？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-14T14:57:28.290

osascript -e "告诉应用程序 \"Terminal\" 将窗口 1 的背景颜色设置为 {0,45000,0,0}"

[（不能拿信用）](https://stackoverflow.com/questions/157959/how-do-i-make-the-apple-terminal-window-auto-change-colour-scheme-when-i-ssh-to-a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T14:50:01.677

我不知道具体细节，但我想你想编写一个 AppleScript 程序，你可以从你的 shell 脚本中调用它。AppleScript 将“告诉”终端更改其背景颜色。

# mysql - 能否像使用 SQL Server 一样在 mySQL 中使用批量 SQL？

> ID：549196
> 
> 赞同：1
> 
> 时间：2009-02-14T14:50:30.053
> 
> 标签：mysql, sql-server

使用 SQL Server，我可以发送

```
SELECT * FROM FOO
SELECT * FROM BAR 
```

到服务器并取回两者的结果，一趟。

我也可以用 mySQL 做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T15:26:22.230

我只能谈论 PHP 的 mysqli 扩展，但我想大多数 mysql 库也是如此。在 PHP 中，您可以发送多个查询，例如

```
SELECT * FROM foo; SELECT * FROM bar; 
```

with`mysqli_multi_query()`并使用 遍历结果集`mysqli_next_result()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T15:18:43.467

只要查询具有相同数量的列，您就可以对两个查询执行[UNION](http://dev.mysql.com/doc/refman/5.0/en/union.html)，例如

```
SELECT * FROM foo 
UNION
SELECT * FROM bar 
```

# c# - 部署到 GAC 的 Web 部件不工作

> ID：549198
> 
> 赞同：2
> 
> 时间：2009-02-14T14:50:55.623
> 
> 标签：c#, web-parts, sharepoint-2007, gac

因此，我继承了一个 VS 项目，其中包含一堆 Web 部件。该项目有一个带有密码的密钥文件，没有人知道密码是什么。所以，我创建了一个新的密钥文件，它显然改变了 PublicKeyToken ......

我认为将新程序集部署到 GAC 并将旧的 PublicKeyToken 替换为 web.config 中 SafeControl 引用上的新程序集就可以了。但是，当我访问该站点时，没有任何 Web 控件起作用。他们都说“Web 部件错误...”

这是旧 web.config 安全控制参考的示例...

这是新的...

我通过右键单击并从“c:\windows\assembly” gac 查看程序集的属性获得了新令牌...

我究竟做错了什么..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T10:46:46.040

更改程序集的强名称意味着它会因系统而变化，在本例中为 SharePoint。因此，前面的 webpart 是带有未知密码的 snk 的程序集的一部分。您必须重新配置包含**旧**webpart 的每个页面并放置**新**webpart。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T15:02:06.330

没有显示安全控制引用，但作为第一次健全性检查：您确实记得重新启动 IIS（部署到 GAC 时需要）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T15:53:36.627

听起来您做出了正确的更改，所以也许是别的。
您是否检查过事件日志和共享点日志是否有错误？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T17:10:44.207

下载并使用 VSeWSS 1.3 扩展。它会自动为您完成所有这些工作，包括部署:-)

[https://connect.microsoft.com/Downloads/Downloads.aspx?SiteID=428&wa=wsignin1.0](https://connect.microsoft.com/Downloads/Downloads.aspx?SiteID=428&wa=wsignin1.0)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T17:21:36.693

有几件事你应该检查......

除非您有令人信服的理由，否则不应将 webpart 部署到 GAC，而应将它们放在 webapp 的 bin 文件夹中。这是 stsadm 将为您放置它们的地方。如果部署到 GAC，则应确保 bin 文件夹中没有 webpart 的程序集，sharepoint 会混淆使用哪个版本 - GAC 或 bin。

你应该确保它在你的 webapp 配置文件中注册为安全控制当你将任何东西部署到 GAC 时，你应该确保执行 IISReset。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T19:18:16.943

WSS中常见的问题是模板信息被复制并嵌入到数据库中的数据中。其中一个示例是 onet.xml 文件中的定义，该文件被复制到每个 Web 实例中。另一种是当用户将 web 部件添加到页面时。要更改强名称通常意味着您必须重新创建已使用 Web 部件的每个站点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-07T22:42:15.953

你的 webpart 继承了什么类？

如果您使用 SharePoint.WebPartPages 类，内容可能会中断

```
public class yourWebPartClass : Microsoft.SharePoint.WebPartPages.WebPartPage 
```

而是使用 System.Web.UI 中的 WebControls 类

```
public class yourWebPartClass : System.Web.UI.WebControls.WebParts.WebPart 
```

/干杯:)

# c# - 将数据集写入 SQL 表

> ID：549200
> 
> 赞同：5
> 
> 时间：2009-02-14T14:51:55.200
> 
> 标签：c#, xml, dataset

我已经将一个复杂的 XML 文件转换为一个包含 7 个表和大约 70 个列的数据集，我已经在 SQL Server 中创建了表，以使用 XML 模式匹配数据集中的表。如何轻松地将我的数据集写入 SQL 表？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-14T15:20:40.123

根据 DataSet 中有多少行，最好的办法可能是使用 SqlCommandBuilder，如下所示：

```
var connection = new SqlConnection("my connection string");
connection.Open();

// repeat for each table in data set
var adapterForTable1 = new SqlDataAdapter("select * from table1", connection);
var builderForTable1 = new SqlCommandBuilder(adapterForTable1);
adapterForTable1.Update(myDataSet, "Table1"); 
```

如果您在DataSet 中的表之间定义了复杂的关系，恐怕您无法使用SqlCommandBuilder。相反，您需要为 DataSet 中的每个表定义一个数据适配器。然后，按依赖顺序更新DataSet 中的表（即先处理没有依赖关系的表，然后是依赖表）。

这是父/子插入的示例（请注意，您会为更新做类似的事情）。Table1 是父级，具有 ParentId（标识列）和 NVARCHAR 字段 ParentValue。Table2 是孩子，有自己的标识列（ChildId）、外键字段（ParentId）和自己的值（ChildValue）。

```
var myDataSet = new DataSet();

// ** details of populating the dataset omitted **

// create a foreign key relationship between Table1 and Table2.
// add a constraint to Table2's ParentId column, indicating it must
// existing in Table1.
var fk = new ForeignKeyConstraint("fk", myDataSet.Tables["Table1"].Columns["ParentId"], myDataSet.Tables["Table2"].Columns["ParentId"])
{
    DeleteRule = Rule.Cascade,
    UpdateRule = Rule.Cascade
};
myDataSet.Tables["Table2"].Constraints.Add(fk);
myDataSet.EnforceConstraints = true;

var connection = new SqlConnection("my connection string");
var adapterForTable1 = new SqlDataAdapter();
adapterForTable1.InsertCommand =
    new SqlCommand("INSERT INTO MasterTable (ParentValue) VALUES (@ParentValue); SELECT SCOPE_IDENTITY() AS ParentId", connection);
adapterForTable1.InsertCommand.Parameters.Add("@ParentValue", SqlDbType.NVarChar).SourceColumn = "ParentValue";
var adapterForTable2 = new SqlDataAdapter();
adapterForTable2.InsertCommand =
    new SqlCommand("INSERT INTO ChildTable (ParentId, ChildValue) VALUES (@ParentId, @ChildValue); SELECT SCOPE_IDENTITY() AS ChildId", connection);
adapterForTable2.InsertCommand.Parameters.Add("@ParentId", SqlDbType.Int).SourceColumn = "ParentId";
adapterForTable2.InsertCommand.Parameters.Add("@ChildValue", SqlDbType.NVarChar).SourceColumn = "ChildValue";

connection.Open();
adapterForTable1.Update(myDataSet, "Table1"); // insert rows in parent first
adapterForTable2.Update(myDataSet, "Table2"); // child second 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T04:55:03.380

如果 DataTables 和 SQL Tables 对齐，那么一个快速的方法是[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T15:06:47.783

您可能想查看 DataAdapters 和 TypedDatasets。

这些都可以通过 VS 设计器获得，只需创建一个数据集，然后从服务器资源管理器视图中删除 SQL 表。:)（或类似的东西，已经有一段时间了）

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-14T15:00:35.803

如果您使用的是 .NET 3/3.5，则可以查看 LINQ。

# c++ - 公共提升::信号对象

> ID：549206
> 
> 赞同：4
> 
> 时间：2009-02-14T15:00:39.623
> 
> 标签：c++, boost-signals, public-fields

我把我`boost::signal`的公开，因为我很懒。

```
class Button {
public:
    signal<void()> clicked;
};

int main() {
    Button btn;
    btn.clicked.connect(handleClick);
} 
```

...而不是用`Button::OnClicked(boost::function<void()>)`.

这会回来咬我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T15:04:00.257

这取决于。

当我想在每次一个对象连接到另一个对象的信号时添加一些特殊的逻辑时，它曾经咬过我。这是最有可能咬你的情况。

此外，当其他对象连接到任何给定对象时，很难准确跟踪。

为了安全起见，我会说隐藏函数后面的连接。

我通常使用宏来定义 vanilla 函数。

```
#define SIGNAL(slot,name) connection name(function<slot> func) { return _##name##.connect(func);} 
```

然后在类定义中：

```
SIGNAL(void(),clicked) 
```

这假设您遵循命名信号“_clicked”的约定，但您可以替换任何约定。它通常使您的所有类的界面更干净。当您想添加特殊的连接逻辑时，您可以在不更改使用该信号的所有其他对象的情况下。

**编辑**

一个例子是信号对象实际上被移动到另一个类中的委托实现，但对象通过原始类连接仍然有意义。这破坏了所有试图连接到它的地方。如果他们一直在使用函数访问器进行连接，那么就像更改函数以在委托中查找信号一样简单。但它破坏了原始类的所有用户。

或者，当我想记录每次连接到特定信号的东西时。这只是出于调试目的，但如果您怀疑信号连接中的循环等异常情况正在发生，它会非常有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-12T06:42:59.290

我偶然发现了一个*不*这样做的充分理由。

我们正在考虑使用在外部接口上公开 boost::signals 的第三方库。这个库依赖于带有一组编译器定义的 boost 版本，这些编译器定义与我们在项目中使用的标准 Visual Studio 编译器定义二进制不兼容。每当我们尝试调用第三方库的 signal.connect 时，事情就死了。

我们的解决方案是：

1.  使用它们提供的 boost 版本重新编译我们所有的源库和依赖库。
2.  包装升压信号并隐藏实现

至少要考虑一些事情！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T13:35:34.647

`boost::signal`好吧，这个问题真的与或无关`function`- 这完全是关于封装。

班级的客户是否`Button`需要完全访问`clicked`？如果他们应该能够做的就是订阅它，那么只允许使用该`OnClicked`方法。暴露更多可能*会*咬你恕我直言。

与往常一样，您要平衡成本与收益。在这种情况下，成本非常低。如果您在我的团队中，我强烈建议您添加该`OnClicked`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-19T21:10:42.170

我也将它们设置为公开，并使用大写字母作为其对象名称。这种方法从来没有对我适得其反。

# asp.net - 在 asp.net 内容页面中需要帮助

> ID：549218
> 
> 赞同：0
> 
> 时间：2009-02-14T15:14:20.840
> 
> 标签：asp.net, master-pages

有人请帮助我如何将内容页面放在页面的中心。我正在尝试使用 css 类，但内容没有 css 属性。在我的应用程序中，当我点击登录详细信息时，该页面应该在居中但在菜单项下打开。这是我的代码：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T15:45:29.470

正如其他海报所说，您需要使用 CSS 将 div 定位在屏幕中央。

这是一些可以帮助您解决此问题的快速代码。

```
div#centered {
    background-color: #eee; 
    border: 1px solid #ddd; 
    position: absolute; 
    left: 50%; 
    top: 50%;  
    width: 400px;  
    height: 300px; 
    margin-left: -200px;  
    margin-top: -150px;
} 
```

它的用法：

```
<div id="centered"><!-- your login stuff --></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T15:59:54.147

左右边距上的 auto 值可以使 div 水平居中。不幸的是，这在垂直方向上不起作用，因此您可能需要手动设置或动态检测屏幕分辨率。

```
<div id="loginBox">
..login form here
</div>

<style>
#loginBox {
  width:400px;
  height:300px;
  margin:400px auto 0px auto;
}
<style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T15:28:27.530

将您的内容占位符放在 a 中`<div>`，然后将 div 居中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T15:33:08.937

内容占位符是一个虚拟容器，它不会影响页面的可视化。将其视为 LiteralControl。所以你应该设计你的内容占位符的周围元素。

# c# - 如何声明“控制实现接口 ISomething”类型的变量/参数？

> ID：549220
> 
> 赞同：1
> 
> 时间：2009-02-14T15:16:24.157
> 
> 标签：c#, vb.net, winforms, controls, interface

我希望以这样的方式声明一个变量，因为它只能分配从 Control 派生的值并且还实现 ISomething 接口。

我打算将 ISomething 接口添加到控件的衍生物中。

我想从 TextBox 和 DatePicker 派生 SpecialTextBox 和 SpecialDatePicker 并在每个上实现 ISomething 接口。

我希望能够将这些控件中的每一个分配给一个变量，该变量的类型是“还实现 ISomething 的控件”，以便从那里可以调用它们的 ISomething 方法，或者可以将它们添加到表单上的控件集合中。

**所以....我如何声明一个类型为“Control which also implements ISomething”的变量**？

理想情况下，答案是在 VB.Net 中，但我也会对 C# 方法感兴趣。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-14T15:24:57.553

一种方法是使用泛型 - 即泛型方法：

```
void Foo<T>(T control) where T : Control, ISomething
{
    // use "control"
    // (you have access to all the Control and ISomething members)
} 
```

**现在，您只能**`Control`使用其他实现的变量来调用 Foo `ISomething`- 但是，您不需要指定泛型：

```
Foo(someName); 
```

是你所需要的全部。如果你给它的东西不是 a`Control`和`ISomething`，编译器会告诉你。

* * *

更新：我不“做”VB，但反射器告诉我上面的翻译为：

```
Private Sub Foo(Of T As { Control, ISomething })(ByVal control As T)

End Sub 
```

# tags - 为什么标签通常都是小写的？

> ID：549229
> 
> 赞同：15
> 
> 时间：2009-02-14T15:24:15.760
> 
> 标签：tags, case-sensitive

在我所见的任何地方，我都看到每当网站实施标签系统时，它们都会将标签名称转换为小写。即使在 StackOverflow 中。

我在想为什么会这样。除了防止重复之外，我想不出使用小写的理由。我相信这会损害标签的实用性。人们习惯于阅读“IBM”而不是“ibm”和“C#”而不是“c#”。用户需要更多时间来理解标签的含义，我想知道我是否应该在我的标签系统中允许大写字母，或者这是一个约定，我完全错了。

我想听听你的意见。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-14T15:29:10.350

正如您已经注意到的那样，它可以防止重复。人们的大小写不一致。只要看看这里的标签，就会发现人们无法确定它是“objective-c”、“objc”还是“objectivec”。加上“Objective-C”、“Objective-c”等等，你会遇到一团糟。

请注意，我并不是说处理大写字母是不可能的，只是很困难。例如，您如何知道正确的大小写？只接受输入的第一个正确吗？靠版主清理？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-14T15:32:44.820

应始终将不同的情况视为标签的等效情况。

标准化存储标签的另一个原因。单一规范化版本包含接受的情况，并且标签使用多对多链接表链接。与标签表的比较不区分大小写，因此永远不会有重复。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-14T16:24:27.537

向工程师询问某事以某种方式存在的原因，他们会不遗余力地弄清楚。;)

在这种情况下，我倾向于通过懒惰（程序员不愿意考虑你提出的观点）和模仿（一旦你看到它在站点 S 上以某种方式完成，你倾向于用类似的假设为站点 S' 重新实现它）。

以不区分大小写（用于排序、查询等目的）但以最初预期的大小写*显示标签的方式**存储*标签似乎是可行的。

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-14T15:57:16.243

（我不建议在此答案中针对任何特定站点或系统 - 每个特定系统可能有自己的考虑因素）

我想原因是为了防止重复并简化排序或识别（如果您不需要考虑多个选项，它会更容易）。并且可能是为了保持一定的一致性，因为许多 Web 用户界面都是针对那些有时可能会费心正确地大写而不是大写的人）。

但是，无论如何，这些都是一个问题，因为通常有不止一种方式来指代某物。如果您的标签曾经在某种脚本、配置或代码（例如邮件过滤器、设置文件、命令行）中用作符号，那么最好有一些简单的约定来指定它们，并且如果所有符号都具有相似的意义，允许或区分不同的情况变化、划分等可能是有问题的。作为 Unix 用户，我尽量保持文件名简单、简短、小写且没有特殊字符，尤其是当它们是（例如）邮箱名称或源文件时——因为它们可能必须输入，并在在许多情况下，否则会不方便。

另一方面，当使用复杂的图形或基于 Web 的界面时，允许在列表中轻松选择、完成键入的条目、建议最接近的匹配等，允许某种映射是有意义的。给每个标签一个简短的简单的小写标识名称，但也允许给它一个“长”或“人”的名称，这将显示在有意义的地方。标签可以通过它们的短名称唯一标识和指定，但通过它们的长名称更方便地阅读。

这类似于用户名在许多系统中的工作方式。我不会选择混合大小写的用户名，而是让用户名不区分大小写（所以我只会使用在我所在的系统上有意义的大小写，在 Unix 中是小写，但在其他一些旧系统中是大写）。然后，大多数系统都存储了一些关于用户的其他信息，比如他们的长名或全名，这样更容易阅读，因此有很多用户界面（例如 Windows XP、Mac OS，我猜还有一些更新的 Unix 桌面界面，比如 GNOME 和KDE) 显示在桌面登录选择器、消息等上。

对于网络上社区系统的标签，我想解决重复问题的方法是对标签进行一定程度的审核，即使只是通过社区本身，以及重命名和合并标签的能力（与大多数情况下的用户名不同） ) 或编辑它们的长名称，以防某些内容被错误标记。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-04T09:44:15.417

我希望看到标签代表它们的分类。在这方面，标签应该遵循与它们所描述的事物完全相同的形式。

但是，从技术的角度来看，我发现问题可能出现在哪里；我不认为这是不全面调查解决方案的理由。

我从事数字出版工作，我可以看到遵循正确用法的好处。另一方面，你很难看到杂志、书籍或报纸中使用全小写字母（除非是风格选择）。

[http://en.wikipedia.org/wiki/List_of_case-sensitive_English_words](http://en.wikipedia.org/wiki/List_of_case-sensitive_English_words)

也就是说，英语词典的美妙之处在于它具有适应、修改和发展的能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T15:28:16.593

这对我来说听起来是一个有效的观点。我相信他们可以想出一些简单的解析来大写每个单词（用破折号分隔），但是你怎么知道它应该是 IBM，而不是 Ibm？我认为有人必须手动更改标签查找表才能完成此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-14T16:05:27.020

我同意原则上这可以以更复杂的方式完成。例如，您可以实现一个相似性度量，可以将所有这些识别为可能的同义词：

*   `IBM`
*   `ibm`
*   `I B M`
*   `I. B. M.`
*   `I.B.M.`

然而，在增加运行时间（更不用说开发工作）和增加实用程序之间存在权衡。

我的一般经验也是，随着启发式算法变得越来越复杂，它们的失败模式变得更加神秘和离奇。至少，当人们有问题时，人们很容易理解并将字母转换为标准大小写的技术。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-18T11:33:37.837

键入时，您必须打开大写锁定以使所有内容都大写。人们很懒惰。

# asp.net - 是否可以在 IIS6/7 上更改 ASP.Net 中请求的主机名？

> ID：549235
> 
> 赞同：2
> 
> 时间：2009-02-14T15:27:23.193
> 
> 标签：asp.net, iis, url, rewrite

是否可以在 ASP.Net 中更改请求的主机名？我们需要它来将所有对 abc.xyz.com 的请求重写为 abc.xyz.com/sites/abc（我们正在运行 Sharepoint）。
我知道这可以通过 ISAPI 实现。我们正在运行 IIS7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T16:08:06.810

我会说您需要使用像[ISA Server](http://www.microsoft.com/forefront/edgesecurity/isaserver/en/us/default.aspx)或[Squid](http://www.squid-cache.org/)这样的东西，它是您的共享点安装的面向用户的网关。

您正在尝试做的事情在 ISA Server 中绝对是可能的。（我在安装时这样做。）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T18:59:03.147

是的，您可以在 IIS 7中使用[URL 重写模块。](http://learn.iis.net/page.aspx/460/using-url-rewrite-module/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T15:37:01.457

是的，我相信有可能做到这一点。请参阅以下[链接](http://prodactor.blogspot.com/2007/11/sharepoint-moss-url-rewriting.html)。您可以使用[http://urlrewriter.net/](http://urlrewriter.net/)来执行该任务。不过，您需要[学习 URLRewrite](http://urlrewriter.net/index.php/support)才能完成这项工作。

为了在 IIS 7 中使用它，您需要 URLRewrite 模块，该模块可以在[此处](http://www.iis.net/extensions/URLRewrite)找到。

# language-agnostic - 在 Facebook 上获得无限会话

> ID：549245
> 
> 赞同：0
> 
> 时间：2009-02-14T15:32:31.513
> 
> 标签：language-agnostic, facebook

请帮助我在 facebook 上获得无限会话。在测试我的应用程序时，我收到一个会话已注销或会话密钥无效。

此无限会话是否适用于登录的任何人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T15:49:59.333

我相信无限会话不再使用。

相反，您可以包含一般的 include.php，如果用户因停滞不前而被注销，则需要用户登录。“新设计平台更改”维基页面说

```
*  We will still grant infinite sessions to your Web applications for users on the old profile.
* Users who added your application on the old profile who then switch to the new profile, will continue to have an infinite session.
* We'll grant temporary sessions to Web applications for new users on the new profile. 
```

您应该阅读本节的其余部分。告诉您获取新密钥以及有多少新功能（如 setFBML）不需要会话密钥。

[这是页面](http://wiki.developers.facebook.com/index.php/New_Design_Platform_Changes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T13:16:33.150

I think what you're looking for might be the "Offline Access" extended permission...

see: the [Facebook developers wiki on **Extended Permissions**](http://wiki.developers.facebook.com/index.php/Extended_permissions)

# c++ - 使用 SWIG 跨 C++ 和 Ruby 的多态性

> ID：549249
> 
> 赞同：2
> 
> 时间：2009-02-14T15:36:40.223
> 
> 标签：c++, ruby, inheritance, polymorphism, swig

我使用 SWIG 将 Ruby 脚本包装在 C++ 库周围。在 Ruby 中，我可以从 C++ 类继承，但不能以多态方式将结果指针传递给 C++ 函数。

这是一个具体的例子。SWIG 接口文件定义了具有虚函数 sound() 的基类 Animal：

```
[animals.i]
%module(directors="1") animals
%{
#include "animals.h"
%}

// Apply the 'director' feature to a virtual function,
// so that we can override it in Ruby.
%feature("director") Animal::sound;
class Animal {
public:
    Animal();
    virtual ~Animal();
    virtual void sound();
};

class Dog : public Animal {
public:
    Dog();
    virtual ~Dog();
    virtual void sound();
};

// This function takes an Animal* and calls its virtual function sound().
void kick(Animal*, int); 
```

请注意，我将 SWIG 导向器用于跨语言多态性，但这似乎不起作用。Ruby 脚本如下所示：

```
[tst.rb]
require 'animals'
include Animals

dog= Dog.new   # Instantiate C++ class
kick(dog, 3)   # Kick the dog 3 times => It barks 3 times.
               # So far so good.

class Cat < Animal   # Inherit from a C++ class
   def initialize
      puts "Creating new cat"
   end

   def sound
      puts "Meow"
   end
end

cat= Cat.new   # Instantiate Ruby class

kick(cat, 9)   # This does not fly. 
```

脚本中的最后一行产生了这个错误：

```
Expected argument 0 of type Animal *, but got Cat #<Cat:0xb7d621c8> 
```

所以不知何故 SWIG 不允许我将 Ruby 对象视为指向动物的指针。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T15:41:09.650

我从 swig-user 邮件列表中的 Tobias Grimm 那里得到了我的问题的解决方案。问题的第一部分是 SWIG 的误导性错误消息。该消息似乎表明我将错误类型的指针传递给我的 C++ 函数，但事实并非如此。如果在 Ruby 中检查异常的类，它是 ObjectPreviousDeleted，这意味着我的 Cat 类的底层 C 结构指针为 NULL。所以真正的问题是指针是NULL，而不是它的类型错误。

指针为 NULL，因为我只是忘记在 Cat 的 initialize() 方法中调用“super”。这样，在创建 Cat 时，不会分配底层 C 结构，因为永远不会调用 Animal 构造函数。忘记调用“super”是一个非常常见的 Ruby 初学者错误，尤其是对于像我这样来自 C++ 的人，他们习惯于自动构造函数链接。

所以我所要做的就是添加对“超级”的调用：

```
class Cat < Animal   # Inherit from a C++ class
   def initialize
      puts "Creating new cat"
      super()
   end
   def sound
      puts "Meow"
   end
end 
```

这现在工作正常。谢谢，托拜厄斯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T20:03:12.870

我相信您需要定义一个返回指向您的实例的指针的[辅助函数。](http://www.swig.org/Doc1.3/Ruby.html#Ruby_nn16)我只使用了带有 fopen 的指针，所以我不知道这是否真的有效，或者我是否还缺少其他东西。祝你好运！

# sqlite - 如何将 sqlite3 数据库转换为静态站点的 RSS 提要？

> ID：549254
> 
> 赞同：0
> 
> 时间：2009-02-14T15:37:19.740
> 
> 标签：sqlite, rss, feed

我需要从包含博客文章的 sqlite3 数据库创建一个 RSS 提要。将使用该提要的站点位于 Google App Engine 上，但目前是一个静态站点。要创建 RSS 提要，使用 Python 中的服务器端脚本还是使用 Windows 软件工具（例如 FeedForAll）来生成新闻提要更容易，比如每周一次？或者有没有一种简单的方法在文本编辑器中格式化提要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T16:22:30.427

当然，您可以使用文本编辑器手动创建您的提要，但您的维护工作量会猛增。（哦，有一篇新博文，让我们编辑提要，粘贴到博文中，删除一篇旧博文......）

使用桌面工具生成提要只会使手动过程自动化（如果您的服务器负载非常高，这是一个有效的想法）。

最后，您有一个数据库，您希望从该数据库中将文本文件提供给云。这是像 ASP.NET / PHP 等服务器端脚本要做的事情，并且有相当长的历史。

# coldfusion - cffile 上传位置

> ID：549259
> 
> 赞同：1
> 
> 时间：2009-02-14T15:41:08.450
> 
> 标签：coldfusion, cffile, enctype

在 CF7 中，谁能告诉我在移动到我提供的目标位置之前是否有办法自动将文件上传到 /tmp/ 文件夹？我正在尝试在共享服务器位置使用 cffile。我无权访问 tmp 目录，希望能找到解决方法。

```
 <cffile action="upload" destination="#expandpath('./')#/myFiles" fileField="myFile"> 
```

我在 Linux 环境中工作，就像我说的那样，在我的 webroot 之外无法访问。最奇怪的是，我似乎没有做到这一点。从我那里我得到一个 500 page or directory not found 错误。即使 post.cfm 没有任何代码，只有文本，所以问题似乎来自 enctype 试图在我到达之前将文件“放置”在服务器上。

我完全不知所措，希望有人能提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T19:50:17.773

我的理解是，文件上传的位置实际上是网络服务器的功能，而不是 CF 本身。CF 复制/移动/等。临时目录中的文件一旦在服务器上。您必须让服务器管理员允许您的进程访问该目录。

# programming-languages - 10 种以下的编程语言和语言功能有哪些？

> ID：549274
> 
> 赞同：11
> 
> 时间：2009-02-14T15:51:53.480
> 
> 标签：programming-languages, survey

周围似乎有许多“新”语言，但实际上似乎大多数流行的、非实验性的语言已经十几岁了，真正的主流语言比大多数初级程序员都要老。现在，当我意识到本月（1994 年 2 月）甚至“时髦”的 Ruby 语言也是 15 岁时，我才想起这个显而易见的事实。虽然像 Haskell 这样的东西在每个人的“学习”列表中都比这更古老。

想想它是唯一真正新的语言，常用的，我能想到的 10 岁以下是 C#。但即使是 C# 也没有任何新特性，尽管它继承了其前辈的一些最佳特性。

所以我想知道现在有哪些新语言及其相应的新功能/想法不到 10 种？从现在起 10 年后有什么可能成为大事吗？有什么新的语言功能值得期待吗？还是我们已经完成了？？？

* * *

显然，没有什么不是混合或改进的真正新事物。也许 LOLCODE 是因为它的设计是荒谬的，但即使是 Brainf*ck 和 WhiteSpace 之类的东西，基本上也是古老的基于堆栈的汇编语言。

我们是否已经进入了编程语言的百科全书时代？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-14T16:58:57.373

**没有**，我见过。

当然，总是有“新”语言出现。但我使用了恐吓引号，因为通常提供的所有示例都是：

*   将几十年来在计算科学和数学中的想法重新包装（转换成另一种语言），或
*   比这更古老的语言/技术，但直到最近才被“主流”世界“发现”。

具体例子：

*   [Lambda 演算](http://en.wikipedia.org/wiki/Lambda_calculus)可以追溯到 1930 年代的数学和逻辑，
*   [函数式编程](http://en.wikipedia.org/wiki/Functional_programming)可以追溯到1950 年代后期的[LISP ，](http://en.wikipedia.org/wiki/Lisp_programming_language)
*   [John Backus在他](http://en.wikipedia.org/wiki/John_Backus)[1977 年的图灵奖演讲](http://www.stanford.edu/class/cs242/readings/backus.pdf)中讨论了 FP （pdf） ，
*   [John Hughes 的论文*Why Functional Programming Matters*](http://www.cse.chalmers.se/~rjmh/Papers/whyfp.html)写于 1984 年，
*   [理解](http://en.wikipedia.org/wiki/List_comprehension)可以追溯到1870 年代的[集合论和 1960 年代的](http://en.wikipedia.org/wiki/Set_theory)[SETL](http://en.wikipedia.org/wiki/SETL)，
*   [解析器组合](http://en.wikipedia.org/wiki/Parser_combinators)器由[Phil Wadler](http://homepages.inf.ed.ac.uk/wadler/)在 1980 年代中期推广，并在 1920 年代回到[组合](http://plato.stanford.edu/entries/logic-combinatory/) [逻辑，](http://en.wikipedia.org/wiki/Combinatory_logic)
*   等等。

推广、普及、应用和完善这些（以及许多其他）重要思想的工作是值得的。但这并不能使这些用途真正具有创新性。

当然，如果有人能提供一个十年前不存在的真正原创编程概念的例子，我会很高兴。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-14T16:29:58.113

[维基百科](http://en.wikipedia.org/wiki/Timeline_of_programming_languages)有一个关于编程语言的第一次出现的很好的时间表 - 它表明有几种语言像[2000 年以上](http://en.wikipedia.org/wiki/Timeline_of_programming_languages#2000s)那样出现，尽管我相信这些不是广泛使用的语言（还没有？）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-14T15:57:10.393

D 编程语言不到 10 年的历史。它的独特功能包括传递 const（从 const 对象可访问的所有内容也是 const）、编译时函数评估以及将函数注释为纯函数并让编译器静态检查函数外部可见副作用的能力。还包括一个模板系统，它让 C++ 模板、Java/C# 泛型等感到羞耻：

1.  对无限数量的参数“正常工作”的可变参数模板。
2.  字符串、浮点数和函数别名可以是模板参数。
3.  该`static if`语句类似于 C++0x 中存在的纸上的语句，实际上已实现并有效。
4.  字符串和模板混合，允许将任意参数化样板代码注入源代码中的任何位置，并生成任意编译时代码。在极端情况下，Don Clugston 使用它来构建一个矩阵数学库，该库实际上在编译时解析作为字符串文字给出的代码，并在编译器的代码生成阶段之前为这些操作生成最佳的内联汇编代码。
5.  结构可以表示为元组，允许对其字段进行迭代。这允许使用结构进行一些有趣的通用编程。
6.  非常强大的编译时反射/内省。我曾经写过一个函数模板，只要不涉及运行时多态类对象（编译时反射根本**无法**处理），它就可以深度复制任何结构。这是仅使用编译时反射完成的。没有使用运行时类型信息。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-14T16:23:25.290

语言不断发展。您不一定需要一种新语言来获得新的语言功能。例如，Haskell 并不是一门新语言，但它确实有很多“新”特性，包括 STM。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-15T01:21:25.140

我认为这个问题的措辞表明没有创新，但事实上，这里的讨论所揭示的只是创新需要几十年才能成为主流。

如果您在 20 年前问过这个问题，当时 OO 是 C++ 和 Smalltalk 之类的“大新事物”之一，人们可以回答说这只是 Simula (1967) 的重新包装。但在 1970 年，我认为没有人会认为对象是“一项重大创新”，而在 Simula 语言中它们只是“一种有趣的句法精巧”。随着时间的推移，OO 不断发展，人们认识到 OO 对于建模/结构化系统是多么自然，设计模式也被发现了，......现在许多语言只是将 OO 视为“理所当然”。但是很难找到人们会说“OO 是一项伟大的新创新”的任何时刻，因为当它是新事物时，没有人欣赏它对软件工程领域的影响范围，而当它的影响力很明显时，

20 年后，也许所有新的/流行的语言都将具有今天 Haskell 中的“类型类”之类的功能（这是一个杀手级功能），但是按照这个问题的标准，它已经“太老了”，不能成为创新，尽管它可能是“下一件大事”。

所以，是的，我敢打赌，太阳底下会有新事物，可能有数百种，但它们都以微小的实验性语言出现，直到几十年后，当当今最好的想法得到提炼/证明并使其成为现实时，我们才会欣赏这种新颖性进入主流的方式。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-14T16:09:38.367

[OMeta 成立](http://tinlizzie.org/ometa/)不到 2 年，是一种用于创建其他语言的语言。在我看来，它比微软即将推出的 MGrammar 等语言更具表现力。

它最酷的想法是您可以以面向对象的方式创建语言（例如，您可以创建 Ruby 和 C# 语法的混搭语言）。

语法看起来几乎与 BNF 相同，因此非常易读，这也很好。

[我在这里](http://www.moserware.com/2008/07/building-object-oriented-parasitic.html)写了更多关于它的内容。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-14T17:12:53.770

我不认为最近的创新一直在发明新功能。它一直在使旧想法在主流环境中可用（和实用）。Lambda 表达式就是一个很好的例子 - 像山一样古老，但绝大多数开发人员在 C# 3 和 VB9 之前不会遇到它们。

类似地，两个特征以前可能独立存在，但从未在同一种语言中存在。我不想开始声称哪些组合是新的，但值得考虑。

顺便说一句，.NET 泛型的本质是“新”的吗？我不知道足够多的计算历史可以说，但它与 Java 泛型（具有类型擦除）或 C++ 模板（据我所知，专业化实际上是编译时业务，需要模板的来源）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-14T18:14:55.443

用于编写智能代理程序的 AgentSpeak(L) 语言。它基于 Prolog（非常古老），但有一些非常具体的功能，而且是全新的。

您可以检查一个名为[Jason](http://jason.sf.net)的完整解释器。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-14T15:57:48.130

F# 怎么样 :)。独立开发人员也正在开发大量新语言。像 scala、jruby、groovy、boo 等。

要让一种语言流行起来，真的需要大公司的大力支持，所以我们会暂时停留在我们所得到的东西上。尽管 Sun 和 MS 正在大力投资以使他们的平台（JVM、CLR）对这些语言更加开放。目前默认值为 Java 和 C#，但只有时间可以证明。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-14T15:59:05.257

[Scala 编程语言](http://www.scala-lang.org/)不到 10年（我相信它最初是在 2001 年发布的），可以说是第一个：

*   *真实世界的可扩展语言*（例如，从脚本和隐式到参与者和模块）。我说*的是真实世界*，因为有些人会声称其他人，从 Lisp 开始，首先在这里，但我相信 Scala 的 Java 兼容性、面向对象的特性、类型系统等使它与众不同
*   *函数式编程和面向对象编程的现实世界融合*（例如，具有高阶函数，还有状态和静态类型）。我再次说*真实世界*，因为虽然例如[Oz](http://www.mozart-oz.org/)更老，但我相信 Scala 的兼容性和实用主义会有所作为

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-14T16:02:57.557

非常期待[嘘](http://en.wikipedia.org/wiki/Boo_(programming_language))。

Boo 是一种面向对象的静态类型编程语言，自 2003 年以来一直在积极开发中，它旨在利用公共语言基础架构对 Unicode、国际化和 Web 应用程序的支持，同时使用受 Python 启发的语法[1](http://en.wikipedia.org/wiki/Boo_(programming_language))并特别关注语言和编译器可扩展性。一些值得注意的特性包括类型推断、生成器、多方法、可选的鸭子类型、宏、真正的闭包、柯里化和一等函数。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-14T17:40:08.133

许多“新”语言以一种或另一种就地良好的虚拟机为目标，即 JVM 或 CLR。它允许专注于语法和“哲学”的设计，而不是实现（利用现有的优化 VM、GC、库等）。

有趣的是，有些语言同时针对这两个平台，例如[Fan Programming Language](http://www.fandev.org/ "粉丝编程语言")。

其他语言只是将自己翻译成另一种语言（通常是 C），因此依靠一些可移植或本地优化的编译器来做好工作。

我发现[Haxe](http://www.haxe.org/ "斧头")很有趣，因为它针对多种语言/VM：JavaScript、Flash、NekoVM 甚至 PHP。

正如其他人所说，今天很难找到真正的新概念。部分是因为已经探索了很多，部分是因为如果新语言不使用熟悉的语法，许多程序员会变得懒惰和困惑（我在 Lua 邮件列表中看到很多人抱怨，要求使用 { 和 }而不是 do/end -- 另请参阅对 JavaFX 不是 Java 的投诉......），更不用说一个新概念了！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-14T17:43:01.777

好的，我们从 Eiffel 开始就知道代码合同 - 所以已经有 20 多年了，而且代码分析也有很多年了，但是我从未见过像 c# 4.0 和 Pex 中这样完整的代码合同、代码分析和单元测试组合。也许我对几年前确实提供这种功能水平的其他语言和产品是错误的和无知的——但我肯定会将这种程度的对“无错误”软件的帮助称为一种功能。那么，它是新的吗？

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-10-30T06:00:46.983

Powershell作为一种语言是10以下，当然不是语言功能。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-26T17:32:20.407

[E 语言](http://erights.org)使轻量级的 Promise 流水线变得易于使用。对于即将到来的多核革命来说，这应该是一个关键的想法，因为它可以编写易于并行化的代码，在通信子进程之间具有低成本的依赖关系，并回避管理锁和避免死锁的所有标准问题. E 中的主要思想已被[移植到各种其他语言中](http://wiki.erights.org/wiki/Object-capability_languages)。E 是一长串（尽管有些晦涩）的对象能力语言的一部分，它对软件的健壮性和安全性做出了一些非常重要的贡献。E现在才10岁左右。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-26T17:39:28.720

[蓝色编程语言](http://www.lechak.info/blue/)显示出巨大的潜力。想想“Python 但更易于使用和扩展”。

不，我并不是说 Blue 比 Python 更好，我只是说它正在酝酿中，易于使用并且（已经，仅仅过了几年）非常稳定。它在我身上生长了大约一年:)

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2009-02-14T15:57:28.113

我会说 C# 的最新添加，如 LINQ、扩展方法、lambda 表达式和其余的都是相对较新的。如果他们现在不大，他们会的。

ASP.NET MVC 虽然它不是一个语言特性，但它会很大（我几乎可以肯定），虽然我知道很多人永远不会接受它。

# php - 我应该将 AJAX 逻辑添加到我的 PHP 类/脚本吗？

> ID：549280
> 
> 赞同：2
> 
> 时间：2009-02-14T15:54:47.060
> 
> 标签：php, ajax, jquery, html

我刚开始制作一个 PHP/AJAX 网站，我想知道应该在哪里添加**“仅包含内容”**的功能。

我是否应该在我的页眉和页脚脚本中包含检查**“ContentOnly”**获取参数的 if 语句？然后将该参数附加到我的 AJAX 调用中的查询字符串？

或者我应该在 AJAX 端使用过滤器来仅获取主要内容 Div。就像在 jquery 中一样：

```
$(this).load("/myPhpPage.php #mainContentDiv") 
```

第一种方法会更快吧？但是第二种方法将 AJAX 功能保留在演示端，并且超出了我的 PHP。

还是有第三种方法？我想保持我的 PHP 脚本完好无损，这样如果 oyu 直接访问它们，页眉和页脚就在那里。提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-14T16:05:02.183

请不要为了使用 AJAX 而使用 AJAX。

也就是说，大多数 AJAX 库都会传递一个`X-Requested-With`HTTP 标头，表明它是一个 AJAX 请求。您可以使用该页眉来决定是否包含您的页眉/页脚等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T16:24:08.317

根据您用于处理页面请求的范例，我通常建议您将此类处理放在控制器脚本中。处理特定于所发出请求类型的视图呈现逻辑完全适合放置在控制器层中。

正如 ceejayoz 所建议的，您可以使用 X-Requested-With 标头（确保它被您的 javascript 库的 ajax 函数传递！）在控制器脚本中验证请求的来源是什么，然后适当地渲染视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T14:45:09.000

除了所说的，您的应用程序不应该知道呈现的视图。如果您从 javascript 进行调用 - javascript 应该知道进行调用的上下文。

这意味着返回处理程序应该知道他们在回调期间正在处理什么。对于这些类型的事务，我发现的最佳方法是将对象打包到 JSON 中，描述被调用的内容和调用者。然后，当返回事物时，您可以将其中一些属性附加到返回的对象中。例如，如果对所有内容都使用相同的回调处理程序，您可以简单地将上下文的引用传递回此返回的对象中。

尽管如此，除非它有真正的目的，否则不要使用 AJAX。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-26T13:47:30.430

X-Requested-With 标头的一个地方对我来说非常方便：

非常低级的身份验证类型方法，将重定向到登录页面......当请求通过 AJAX 来时，重定向是一个坏主意——我想返回一个带有错误响应的 XML 有效负载，所以我为此抛出一个异常反而。是的，我可以让身份验证总是抛出，但是我必须在每个页面中实现处理并在那里进行重定向。使用 X-Requested-With，我可以两全其美。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-17T14:54:37.153

`X-Requested-With HTTP`表明它是一个 Ajax 请求是相当多余的。Ajax 调用不应该像浏览器那样请求 HTML！

在大多数情况下，AJAX 调用不应返回 html 或纯文本。确保在向页面发出请求时指定正确的 mime 类型，并在使用的 mime 类型上切换页面。这样，当浏览器请求 HTML 时，它会在 AJAX 调用请求 XML 或 JSON 时获取 HTML，或者如果您必须使用纯文本，它将获取该格式的数据。

**编辑：**在这种情况下，AHAH 确实是一个更好的术语（技术性）。我将内容视为 OP 中的数据，这就是为什么我如此大力推动 mime 类型。

然而，我仍然认为通过 ajax 获取**所有**内容是一个糟糕的设计，你失去的比得到的多。如果需要，最好转到新页面并在内容中公开一些 AJAX 功能。

如果该功能 AHAH 是一个不需要在历史记录中推送的小错误框（例如内容），那么即使是我的正统思想也可以这样生活:)

即使您有一个需要大量计算的标头（即树视图），也有其他缓存选项可以使 javascript-abled 作为 -disabled 受益，因为假设只有 javascript-abled。

顺便说一句，感谢您的评论，我真的不想像被承认的那样脱身，但可以看到我打出的音符就是这样。

# database - 标签系统中标签的 ID

> ID：549292
> 
> 赞同：4
> 
> 时间：2009-02-14T16:02:43.547
> 
> 标签：database, database-design, tags, primary-key

我正在实现一个类似于 StackOverflow 标签系统的标签系统。我在考虑在存储标签并与问题相关时，这种关系将直接与标签名称相关，或者最好创建一个字段 tagID 以将问题与标签“链接”？看起来直接链接到标签名称更容易，但看起来不太好，主要是为什么在使用统计数据和/或标签分类（恕我直言）时很难管理这一点。另一个问题是当一个管理员决定“修复”标签名称时。如果标签名称中没有标签ID，那么我将更改表的键...

你有什么想法？

感谢所有回复。我将删除此帖子，因为还有其他具有相同主题的帖子。我想知道为什么搜索和建议没有为我显示结果...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-14T16:19:45.457

看看这些相关的早期 SO 问题：

*   [将标签存储在数据库中的最有效方法是什么](https://stackoverflow.com/questions/334183/what-is-the-most-efficient-way-to-store-tags-in-a-database)

*   [用于标记的数据库设计](https://stackoverflow.com/questions/48475/database-design-for-tagging)

*   [如何设计数据库模式以支持使用类别进行标记](https://stackoverflow.com/questions/373126/how-to-design-a-database-schema-to-support-tagging-with-categories)

*   [是否有理想的标记模式？](https://stackoverflow.com/questions/172648/is-there-an-agreed-ideal-schema-for-tagging)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T16:11:23.790

你问题中的最后一句话似乎回答了它。假设标签存储在标签表中，我将始终有一个 ID 列（int 或 GUID）和标签名称的 varchar/string 列。将一些其他实体与一个或多个标签相关联的多对多（联结表）将有两列包含 ID 的“其他实体”和标签的 ID。然后无需触摸按键即可轻松编辑标签（例如纠正拼写错误）。使用包含与联结表连接的查询时，您应该获得更好的性能，这也意味着您可以更好地规范化数据。

记住，“[钥匙，整个钥匙，只有钥匙，所以请帮帮我](http://www.sqlmag.com/Article/ArticleID/38896/sql_server_38896.html)”！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T16:08:48.760

如果您预见到很多标签，并且正在使用关系数据库，那么使用数据库本身支持的 ID（例如 RID）可能只会给您带来更好的性能。

如果这不是问题：使用简单的短标签名称。您可以为标签提供长名称，这些名称也将显示在用户界面中有意义的地方（例如，在创建新标签时向用户询问）。您更有可能必须编辑长名称，没有任何东西直接引用，所以这不是问题。

另外，如果您使用的是关系数据库，通过简单的查询更改标签名称及其所有引用可能不是很困难，这可能只是一个稍微昂贵的操作，但可能不会完成足够频繁，以至于您需要对其进行优化。并且考虑到您可能也有想要合并的重复标签，所以无论如何您可能希望能够做到这一点。

# ruby - 搜索网站内容

> ID：549302
> 
> 赞同：4
> 
> 时间：2009-02-14T16:11:22.043
> 
> 标签：ruby

你如何用 ruby​​ 搜索网站源代码，很难解释，但这是用 python 做的代码

```
import urllib2, re
word = "How to ask"
source = urllib2.urlopen("http://stackoverflow.com").read()
if re.search(word,source):
     print "Found it "+word 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T16:42:17.057

这是一种方法：

```
require 'open-uri'
word = "How to ask"
open('http://stackoverflow.com') do |f|
  puts "Found it #{word}" if f.read =~ /#{word}/
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T16:48:53.560

如果您只想搜索 jcrossley3 给您答案。如果您想做一些更复杂的事情，您应该查看一个 HTML 解析器，它可以让您将网站视为 DOM 树。看看为什么伟大的[hpricot 宝石](http://wiki.github.com/why/hpricot)可以做到这一点。

```
 require 'hpricot'
 require 'open-uri'
 doc = open("http://qwantz.com/") { |f| Hpricot(f) }
 doc.search("//p[@class='posted']")
 (doc/"p/a/img").each do |img|
   puts img.attributes['class']
 end 
```

# php - 如何处理域层和数据库层之间的通信？

> ID：549305
> 
> 赞同：0
> 
> 时间：2009-02-14T16:12:02.790
> 
> 标签：php, oop, dns, database-abstraction

我对为业务逻辑（域）和数据库访问逻辑使用单独的层相当陌生，但是在解决问题的过程中，我遇到了一个问题，我仍然觉得我还没有找到一个很好的解决方案。

**澄清**我现有的解决方案使用数据映射器直接处理数据库交互。然而，当我进一步调查这个问题时，许多人建议域层不应该直接与数据映射器进行通信，也不应该包含实际执行数据库交互的数据映射器。这就是为什么我将存储库对象放置在域和必要的数据映射器之间，但这感觉不太自然或正确。所以真正的问题是自然存在什么层来处理域和数据映射器之间的通信？任何有关如何构建它的示例都将不胜感激。

例如：

*   如何在另一个域对象的上下文中正确处理检索域对象的集合？
*   如何根据对另一个对象执行的操作强制插入单个域对象或对象集合。我目前面临的情况是，当一个人附加到一个活动时，我需要插入所有需要为该活动执行的人的事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-30T22:31:22.950

There is a distinction between a domain model and the implementation of it. Just because your model shows a relationship `Person ---> Campaign ---> Event` does not mean that you have to implement it in this way. IOW, your model shows your analysis and design in an object-oriented way, yet you implement that model in OOP which is limited in how well it can replicate that model in code.

Consider the following.

A `Person` is not defined by its ownership of a `Campaign`, so campaign can be left out of its knowledge responsibities. On the other hand, a `Campaign` is defined by the `Event`s that occur as part of its execution, so it is fair to have a collection of events within a campaign. The point that I am making is that each class should have just enough behaviour and knowledge to make it whole.

As for communication between the domain and the persistence layers, consider them as two very distinct systems that are not concerned with the other. All each of them knows is what its responsiblities are and what announcements it makes. For example, the persistence layer knows how to persist data passed to it and to announce that data have been saved. However, the persistence layer does not necessarily need to understand the domain objects. Similarly, the domain layer understands `Person`, `Campaign`, and `Event` but knows nothing about persistence.

The implication of the above is that the domain layer needs to be a whole by itself and should not be dependent on the persistence layer for its data. However, it still needs to be supplied with data to perform its responsibilities. That data can come from either the user interface or the database and is passed to it via a third-party that knows about both domain and persistence layers.

So, in code (pseudo-C#)...

```
namespace DomainLayer
{
    interface IDomainListener 
    {
        void PersonCreated(Person person);
    }

    class Person
    {
        private string name;

        public Person(string name)
        {
            this.name = name;
        }

        public string Name
        {
            get { return name; }
        }
    }

    class Domain 
    {
        private IDomainListener listener;

        public Domain(IDomainListener listener) {
            this.listener = listener;
        }

        public void CreatePerson(string name) {
            Person person = new Person(name);
            listener.PersonCreated(person);
        }
    }
}

namespace PersistenceLayer
{
    interface IPersistenceListener
    {
        void PersonDataSaved(int id, object data);
    }

    class Persistence
    {
        private IPersistenceListener listener;

        public Persistence(IPersistenceListener listener) 
        {
            this.listener = listener;
        }

        public void SaveData(object data)
        {
            int id = ...; // save data and return identifier
            listener.DataSaved(id, data);
        }
    }
}

namespace MyApplication
{
    class MyController : IDomainListener, IPersistenceListener
    {
        public void CreatePersonButton_Clicked()
        {
            Domain domain = new Domain(this);
            domain.CreatePerson(NameTextbox.Text);
        }

        public void PersonCreated(Person person)
        {
            Persistence persistence = new Persistence(this);
            persistence.SavePersonData(person.Name);
        }

        public void DataSaved(int id, object data)
        {
            // display data on UI
        }
    }   
} 
```

As you can see, the namespaces represent the different tiers. The `XYZListener` interfaces define the announcements that are made by the `XYZ` tier. Any other tiers that are interested in these announcements and will respond to them need to implement these interfaces, as does our `MyApplication` tier.

When the "create button" is clicked, the controller creates the `Domain` facade object for the domain layer and registers itself as a listener. It then calls the `CreatePerson` method which instantiates a `Person` then announces that this has been done, passing the new instance. The controller responds to this announcement in the `PersonCreated` implementation where it spawns a facade of the persistence layer and registers itself as the listener again. It then calls the `SaveData` method whichannounces `DataSaved` when completed. The implementation of that method then displays the data on the UI.

As you can see, the domain layer and the persistence layer are each aware of only tmemselves and are not concerned with the responsibilities of the other. It is the application logic, manifested here as the controller, that wires the two together.

Back to your specific problem, you could have a method `FindPerson` on the persistence, which would announce `PersonFound(int id)`. The response by the controller would be to call the persistence layer to retrieve data about campaign and events, then call the domain layer with that data to build the `Person`.

Sorry for the long answer...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T16:26:28.467

Gabriel，这被称为“[阻抗匹配问题](http://visualwikipedia.com/en/Object-relational_impedance_mismatch)”。周围有很多解决方案，从重量级的 J2EE 实体 bean 到 Ruby ActiveRecord，再到简单地编写手动连接。

### 更新

好吧，如果没有更多信息，很难确切地了解如何攻击它，但这是基本方法。

Any of these sorts of architectural issues are driven by non-functional requirements like performance; in addition, there is a correctness issue here, in that you want to make sure updates are done in the correct order. So, you're going to need to think about the *workload*, which is to say the pattern of usage in real-world application. With that in mind, you basically have a couple of issues: first, the base data types in your application may not map correctly to the data base (eg, what's a VARCHAR property represented as in your code?), and second your domain model may not map cleanly to your database model.

What you would like is to have the database and the dmain model work out so that one instance of a domain object is exactly a row of a table in your database model; in large-scale applications you can rarely do this because of either performance constraints or constraints imposed by a pre-existing database model.

Now, if you completely control your database model, it simplifies things somewhat, because then you can make your database model more closely resemble the domain. This might mean the database model is somewhat denormalized, but if so, you can (depending on your database) handle that with views, or just not have a completely normalized database. Normalization is a useful theoretical construct, but that doesn't mean you can't relax it in a real system.

If you *don't* completely control your database model, then you need a layer of objects that make the mapping. You've got a bunch of options to choose from in implementing that: you can build views or denormalized tables in the database, you can build intermediate objects, or you can do some of both, or even have several steps of both (ie, an intermediate object that accesses a denormalizaed table.)

At that point, though, you run into issues with "don't repeat yourself" and "do the simplest thing that will possibly work." Think about what is most likely to change? Your domain model? If you've got a strong domain model, that's less likely --- the business changes relatively rarely. The exact representation of data in the database? A little more common. Or, most commonly, the exact patterns of use (like discovering a need to handle concurrent updates.) So, when you think about that, what do you need to do to make it as easy as possible to deal with the most common changes.

I realize this isn't giving you very precise instructions, but I don't think we can offer precise instructions without knowing a whole lot about your applicaiton. But then I also kind of get the impression you're wondering about what the "right" way of handling this would be, while you are already working with something that more or less does the job. So, I'd end up by asking "what are you unhappy with now?" and "How would you like to solve that?"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T16:24:24.570

许多系统采用独立的数据层来处理与数据库之间的持久性。这种层的组织有几种模型。一些使用一种类似工厂的实现，另一些使用一对一的映射，每个域类都有一个数据层类。

数据层的模型通常取决于风格和偏好。重要的是将持久层与域层分开。我相信有一些工具可以帮助您生成这一层，但是我的 PHP 知识很薄，所以我无法专门为 PHP 命名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T17:39:21.350

I would look at the data abstraction layers used by PHPCake and Symfony.

# php - 重定向循环

> ID：549307
> 
> 赞同：0
> 
> 时间：2009-02-14T16:14:19.137
> 
> 标签：php, login

我正在创建一个类似于客户端内部网络的用户登录系统。当我尝试访问主页时，我在 FF 中得到一个重定向循环。

我正在检查用户是否使用以下方式登录：

```
if(($_SERVER['PHP_SELF'] != '/webmaster/index.php') && ($_SESSION['loggedin'] != '1234')){
  header("Location: ".$domain."index.php?l=no");
  exit();
} 
```

下面是我的 process-login.php -> 这是处理客户端登录的文件：

```
<?php
ob_start();
session_start();
ini_set('display_errors', 1);
error_reporting(E_ALL | E_NOTICE);
include ("config.inc.php");
include ("jsonEncode.php");

// username and password sent from form
$username = '';
$password = '';
$username = mysql_real_escape_string($_GET['username']);
$password = mysql_real_escape_string($_GET['password']);

$sql    = "SELECT * FROM clients WHERE username='$username' AND password='$password' LIMIT 1";
//echo $sql;
$result = mysql_query($sql);

$data   = mysql_fetch_array($result);
$count  = mysql_num_rows($result);

if($count==1){
    $_SESSION['username']  = $username;
    $_SESSION['password']  = $password;
    $_SESSION['client_id'] = $data['c_id'];
    $_SESSION['loggedin']  = "1234";

    /*
    echo $_SESSION['client_id'];
    echo $_SESSION['password'];
    echo $_SESSION['username'];
    */
    echo $_SESSION['loggedin'];
    // valid
    $var = array('valid' => 1, 'username' => $username, 'password' => $password);
    print php_json_encode($var);

}else{
    // invalid
    $var = array('valid' => 0, 'username' => $username, 'password' => $password);
    print php_json_encode($var);
}
?> 
```

index.php 主页面有两种形式，一种用于客户，一种用于网站管理员，如果您是客户，您将被重定向到：`clients/`，如果您是网站管理员，您将被重定向到：`webmaster/`。

我检查了我的登录脚本，它正在返回正确的信息并登录，但它一直在循环。

表单通过 ajax 提交，然后返回值为 1 有效或 0 无效的 JSON，以查看用户是否可以继续。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-14T16:56:33.357

如果表单是通过 AJAX 提交的，您确定会话 cookie 已相应设置吗？我知道 Firefox 会将 cookie 信息与异步请求一起发送，但您确信它会以相反的方式工作吗？

```
if (($_SERVER['PHP_SELF'] != '/webmaster/index.php') && 
    ($_SESSION['loggedin'] != '1234')) { // I don't like this!
    header("Location: ".$domain."index.php?l=no");
    exit();
} 
```

$_SESSION['loggedin'] 值在大多数情况下是 != '1234' 并且最初是这种情况，您应该检查该值是否也未定义并采取相应措施。如果用户请求 index.php 如果这是一个新会话，那么您现在有什么保证 $_SESSION['loggedin'] 不是 != '1234' ？否则，如果 AJAX 响应没有相应地设置会话 cookie，假设您使用会话 cookie 来跟踪用户会话，您将有一个重定向循环？

# .net - 将图表添加到 WordprocessingML

> ID：549313
> 
> 赞同：8
> 
> 时间：2009-02-14T16:20:39.853
> 
> 标签：.net, ms-office, openxml, drawingml

我想使用 Open Xml SDK 2生成一个包含*图表的 Open XML 文档。我找到了一个*[SpreadsheetML 示例](http://msdn.microsoft.com/en-us/library/cc820055(office.14).aspx)，但我不知道如何在 .docx 中添加图表...

Open Xml SDK 2 的文档/示例是否有很好的来源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:38:57.007

本文从 XML 的角度介绍了如何在 WordProcessingML 中添加图片：http: [//openxmldeveloper.org/articles/462.aspx](http://openxmldeveloper.org/articles/462.aspx)

使用 Open XML API 的相同内容的实际代码：http: [//msdn.microsoft.com/en-us/library/bb497430 (office.14).aspx](http://msdn.microsoft.com/en-us/library/bb497430(office.14).aspx)

如果您已成功将图表添加到 SpreadsheetML，则可以调整图片示例以对 WordProcessingML 执行相同操作。您仍将拥有他们在示例中拥有的 a:graphic 元素。包含在其中的 a:graphicData 将有一个图表 URI ( [http://schemas.openxmlformats.org/drawingml/2006/chart](http://schemas.openxmlformats.org/drawingml/2006/chart) ) 而不是图片 URI。a:graphicData 中的数据将与 SpreadsheetML 中的数据相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T19:58:52.357

我没有给你一个例子，但看看cfchunks：

[https://blogs.msdn.com/johnrdurant/archive/2005/07/15/cfChunk.aspx](https://blogs.msdn.com/johnrdurant/archive/2005/07/15/cfChunk.aspx)

[http://blogs.msdn.com/brian_jones/archive/2005/07/20/441167.aspx](http://blogs.msdn.com/brian_jones/archive/2005/07/20/441167.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-13T00:54:15.183

不幸的是，网络上缺乏工作示例。与往常一样，使用 OpenXmlSDK 时最简单的方法是创建带有图表的 Word 文档并在文档浏览器工具中打开它。

当我过去插入图表时，它们已作为“ChartPart”插入到文档中，该文档与数据源和格式有几个子部分关系，然后在文档主体本身中插入了一个“c:chartReference”引用图表部分按 id。我相信chartReference 位于graphicData 之下。

# css - CSS 的安全子集？

> ID：549314
> 
> 赞同：1
> 
> 时间：2009-02-14T16:21:02.987
> 
> 标签：css

将所有浏览器恢复到 IE6 是相当具有挑战性的。每个浏览器都支持规范的不同功能。是否有关于可跨浏览器（IE6、IE7、FF1、FF2、Safari、Opera）使用的安全 CSS 子集的指南？这样我就不必在每次小的修改后在 6 个不同的浏览器中测试我的样式表——并适应它们令人讨厌的怪癖。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T16:24:33.650

这是一个有价值的参考。 [http://www.quirksmode.org/css/contents.html](http://www.quirksmode.org/css/contents.html)

此外，对于 IE 并选择其他浏览器 - 条件注释。 [http://msdn.microsoft.com/en-us/library/ms537512.aspx](http://msdn.microsoft.com/en-us/library/ms537512.aspx)

我以这种方式使用它们。我覆盖了任何 IE 细节。

```
<link rel="stylesheet" type="text/css" href="theme.css" />
<!--[if IE 6]>
<link rel="stylesheet" type="text/css" href="theme-ie6.css" />
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T16:28:44.857

根据我的经验，虽然所有浏览器都可能支持某些 CSS 属性，但它们的行为并不总是相同。即使是一些最基本的属性，比如margin/padding/float，也会导致IE和其他东西看起来不同。

通常整个网站模板是最复杂的。我做事的方式是，一旦我编写好模板，以及实际内容要使用的简单类，在所有浏览器中测试几个示例页面。通常，一旦您只是在处理内容，您就不会在系统中投入任何大的扳手（尽管我总是会在这里和那里进行偏执的检查）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T16:29:11.690

Daniel 和 jleedev 的两个链接都是宝贵的资源。在许多情况下，您最好的选择是使用[重置样式表](http://meyerweb.com/eric/tools/css/reset/)（只是一个示例），这将最大限度地减少浏览器之间的呈现差异。

Dean Edward 的[IE7](http://dean.edwards.name/IE7/)是一个 JavaScript 包含，它将向 IE6/7 添加许多标准 CSS 功能（例如`<abbr>`并支持伪选择器）。

我建议为 Firefox/Opera/W3 规范开发，然后为 IE6/7 使用条件注释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T19:26:18.363

我找到了一本名为**Pro CSS and HTML Design Patterns**的书，其中包含预先测试的可重用 CSS 片段。这与我实际需要的非常接近。

# xml - Ajax：定义与实现？（XML vs JSON vs 其他）

> ID：549316
> 
> 赞同：4
> 
> 时间：2009-02-14T16:21:55.747
> 
> 标签：xml, ajax, json, definition

AJAX 实际上是指异步 Javascript 和 XML。这个术语的产生是因为（据我所知）开始这个过程的第一批人通过 XML 将数据从服务器传输到客户端。最近（自从我实际开始使用它以来），JSON 已经出现并且似乎是 XML 的真正替代品。从我的（可能是微薄的）测试和经验来看，JSON 更小、更容易、更适合传输数据。

所以我的问题是：您使用哪个与服务器/客户端通信（可能是为什么）？或者，您听说过哪些“最佳实践”（以及为什么）？

谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T16:35:54.263

我们通常更喜欢 xml，因为它比 JSON 有一些优势，例如：

*   xml 可以被验证，而 json 没有验证器
*   json 中没有命名空间
*   与 json 不同，xml 是可扩展的
*   Json 通常被认为是不安全的

另一方面json本身也有它的优势：

*   json更简单
*   在客户端处理更容易
*   当出现问题时，调试会变得轻而易举

最后，这取决于您要开发的内容，对于面向数据的东西，我更喜欢 json。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-04T19:27:59.607

哪个更好用取决于应用程序/要求。在浏览器端 JSON 是更好的选择，而在服务器端的文件 XML 是更好的选择。为正确的工作使用正确的工具。JSON 更倾向于数据，而 XML 更倾向于文档。浏览器 Javascript 代码原生支持 JSON。

有关这篇文章的更多和详细信息，请参阅一个链接，该链接对每个示例都有更好的比较。[http://codebucket.co.in/which-one-is-better-xml-or-json/](http://codebucket.co.in/which-one-is-better-xml-or-json/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-14T16:42:13.373

JSON 与 XML 似乎是一个持续的争论——我宁愿选择 JSON，因为它更适合支持 mashup 和 AJAX 小部件的 Web 服务，因为它本质上是序列化的 Javascript 对象（因此易于与 Javascript 一起使用）。

您可以在[JSON 或 XML，选择哪种格式？](http://www.scriptol.com/ajax/json-xml.php)和[AJAX 响应：XML、HTML 还是 JSON？](http://www.quirksmode.org/blog/archives/2005/12/the_ajax_respon.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-14T16:26:59.260

我更喜欢尽可能使用 JSON：

1.  它已经以 Javascript 对象的形式出现，因此您只需在其上调用 eval() 即可获取其所有数据。
2.  JSON 是 Javascript，因此对于已经了解 JS 但不了解 XML 复杂性的人来说，理解起来会更快。
3.  在浏览器中，您不必经历解析 XML 对象的痛苦。（您也不必在服务器上构建一个，尽管无论如何您都必须创建 JSON。）
4.  这是一种更紧凑的数据传输方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T16:28:38.600

这些天，我尽可能倾向于使用 JSON。与客户端编码结合起来，它肯定感觉更轻，更“自然”。

安全最佳实践：永远不要在不对收到的字符串进行检查的情况下盲目地评估 JSON，因为您可能正在执行有人“放置”到 JSON 字符串中的任意代码。

Douglas Crockford在使用 JSON 时编写了一套很好[的安全原则。](http://yuiblog.com/blog/2007/04/10/json-and-browser-security/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-14T16:36:21.343

当我看到 AJAX 这个词时，我总是微笑。我微笑是因为我早在 XMLHTTP 出现之前就开始使用相同的技术，更不用说 AJAX。

我们在 IE 中的 Intranet 应用程序上做了与 AJAX 相同的事情，但使用 VBScript 和 Java 小程序而不是 XMLHTTP。我们使用了类似于 JSON 的东西，但使用的是 VBScript 语法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-18T00:12:24.073

从理论上讲，由于验证和其他原因，XML 会很快很好。在实践中，您无法在客户端验证 DTD 或架构是否合理（或在大多数情况下）。试试看你就知道了。

XML 还受到其冗长和客户端消耗的影响。除非您打算使用 XSLT 或其他东西并直接使用接收到的数据包，否则您必须像制作的 DOM 一样将数据切碎。

最后，XML 在完成之前无法合理查看（至少在客户端），因此您无法进行部分检查。虽然公平地说，JSON 在那里也会遇到挑战，这取决于它的结构。

鉴于消费环境（主要是 JavaScript）JSON 具有明显的优势。[在 Ajax: The Complete Reference ( http://ajaxref.com](http://ajaxref.com) )的第 4 章中对这种选择以及 YAML、CSV、base64 编码数据、HTML 片段等其他内容进行了大量讨论，其中仅针对数据类型。示例证明不易于处理，特别是在鲜为人知的情况下。如果我必须选择一个 JSON 就可以了，但坦率地说，对于 Ajax 小 HTML 片段的某些用途（因为它是 slap and go）是这样做的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-14T16:26:39.357

您也可以只生成 html 并将该输出直接用于您的应用程序。XML 非常冗长，由于安全性，JSON 在处理它时需要额外注意。

没有真正的“最佳实践”，就个人而言，如果我要在 JSON 和 XML 之间进行选择，我会使用 JSON。尽管如果您使用 XML，您将有一些有趣的查询可能性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-14T18:36:47.403

我认为关于 JSON 与 XML 的争论表明 JSON 可以是*最佳*实践。我认为客户端-服务器传输速度不会很快成为一个问题，如果有的*话*。所以我认为 JSON 将在*单独*较小的问题上获胜（我相信 JSON 在发送到哪个服务器方面也具有灵活性，但这自然会涉及到前面提到的安全问题）

也许我们应该开始称它为“AJAWX”（没有 Xml 的异步 JAvascript）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-15T13:51:51.017

我的选择是 JSON。

因为：

*   它要快得多。您只需要从响应中评估 JSON 代码，而不是解析 XML。
*   它需要更少的代码。eval() 小于 XML 解析器代码。
*   客户端和服务器之间的流量（要传输的数据量）更少，因此处理速度更快
*   它更具可读性

# python - 在windows python控制台中，如何使Tab =四个空格？

> ID：549340
> 
> 赞同：0
> 
> 时间：2009-02-14T16:38:44.677
> 
> 标签：python, windows

您好，我希望当我在 python 控制台中时，选项卡会给我四个空格。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T16:54:08.323

1.  下载并安装[AutoHotkey](http://www.autohotkey.com)
2.  编写这个脚本：

    ```
    SetTitleMatchMode 2
    #IfWinActive python
    tab::
    Send, {SPACE}
    Send, {SPACE}
    Send, {SPACE}
    Send, {SPACE} 
    ```

将其另存为 tab-to-space.ahk，然后双击该文件。

注意：您可能需要大写“Python”以匹配您的窗口。或者你可以有“yhton”，它也会匹配 Jython。

# java - 记录导致 JUnit 错误的数据的推荐方法是什么？

> ID：549341
> 
> 赞同：2
> 
> 时间：2009-02-14T16:39:26.470
> 
> 标签：java, unit-testing, logging, junit

我对 JUnit 比较陌生，今天我正在编写一些我的第一个测试。对于某些特定方法，我想传递随机值（所有这些值都在正确的范围内）。如果该方法因任何原因失败，我想知道是哪个值导致它失败。那么推荐的方法是什么？

（或者在 JUnit 测试中使用随机值是不是很糟糕？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T17:06:08.027

如果您真的想使用随机值，那么只需将使用中的值放在断言方法的文本部分中。然后，如果断言被破坏，则输入值将出现，您可以调查它出现问题的原因。

这是[模糊测试，是一种强大的技术，但在您](http://en.wikipedia.org/wiki/Fuzz_testing)*没有*可用的源代码或测试具有复杂内部状态和多个交互的系统时最有用。

对您来说更有用的测试类型可能是[白盒测试](http://en.wikipedia.org/wiki/White_box_testing)，其中故意选择测试输入以涵盖您可能获得的各种输入类别。[JTest](http://www.parasoft.com/jsp/products/article.jsp?articleId=839)似乎是 java 中的自动化工具。MS Research为 c#提供[PEX ）。](http://research.microsoft.com/en-us/projects/Pex/)

如果手动完成，只需使用覆盖工具并验证您是否覆盖了相关路径通常就足够了，尽管自动化工具提供的边界情况通常很有指导意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T16:45:58.780

您可以尝试使用：[http](http://www.openfuture.de/Log4Unit/) ://www.openfuture.de/Log4Unit/进行日志记录，**但**我建议不要使用随机值进行单元测试，因为它们应该重复。如果您想测试很多值，只需使用 for 循环和对索引值进行一些修改，这很容易重复。

如果您考虑一下，确实没有任何情况比使用“硬编码”值更有益于使用随机值。如果您想在一个值范围内获得良好的分布，您可以使用函数或使用具有固定种子的随机值（以获得相同的数字）。

如果测试失败，您希望能够修复它并再次运行测试。这就是单元测试中随机数的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T17:05:42.163

只需在断言的“诊断消息”参数中报告实际值和预期值。这是 JUnit 测试的常见做法，“辅助”断言方法默认情况下倾向于这样做，例如 assertEquals 会说“预期 6 并得到 7”。

随机值是可以的，只要你能确保随机范围构成被测代码的*等价类。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T00:15:23.753

您是否尝试过使用 JUnit 4.4+ 中的“assertThat”方法和 Hamcrest 匹配器？查看自述文件 [1] 并搜索“assertThat”。

我已经非常喜欢代码更具语义化的外观，并且失败消息也提供了更多信息。

[1] [http://junit.sourceforge.net/README.html](http://junit.sourceforge.net/README.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T09:15:23.217

我会提出[参数化测试用例](http://www.junit.org/junit/javadoc/4.3/org/junit/runners/Parameterized.html)。所以你可以使用随机值（在 Data 方法中），如果任何方法失败，它会在你的跑步者中“记录”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T16:52:05.003

如果您的单元测试因任何原因失败，您将在测试运行程序中看到一个红色交通灯。测试运行程序还将向您显示哪个测试方法失败，并且测试运行程序的日志会报告更多详细信息（例如转储的堆栈跟踪）。调查那个错误，纠正它，你的测试应该永远不会再次失败，除非你破坏了代码。

因此，我认为没有必要记录异常。**您应该立即**修复任何错误（红灯）。

如果您不能保证这些值的生成没有错误，那么使用随机值可能会非常危险。检查边界条件可能更有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T22:55:06.220

您可以通过向随机数生成器提供常量种子来获得可重复的随机值。在 Java 中创建一个带有固定值的 java.util.Random，并将其作为构造函数参数传递给类（依赖注入）。像这样：

```
new ClassUnderTest(new Random(123L)); 
```

根据您正在测试的内容，您还可以将随机值的生成与它们的使用分开。如果您有 X 类，它采用 1 到 10 范围内的随机值，那么您可以通过将边缘值 1 和 10 以及中间值（例如 4）传递给它来测试它。然后您需要对这些的生产者进行另一个测试随机值。例如，给它一个带有固定种子的 java.util.Random 并生成 100 个值，并检查它们是否都在允许的范围内。

# .net - 使用 .net 库自动执行任务的最佳技术是什么？

> ID：549344
> 
> 赞同：6
> 
> 时间：2009-02-14T16:41:53.517
> 
> 标签：.net, powershell, scripting, automation, ironpython

想象一下，您需要开发和安排一个应用程序/脚本来执行以下操作：-

*   引用一个或多个 .net 程序集
*   查询API，获取一些对象
*   为每个对象调用 API 中的另一个方法

你会用什么？

在过去，我创建了执行上述操作的小型控制台应用程序，但它似乎有点笨拙和矫枉过正。

我想像 PowerShell 或 IronPython 这样的东西可能更合适。

有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-14T16:44:36.957

绝对是 PowerShell，这正是它的设计目的。

这里有一些有用的资源可以帮助您入门：

*   [PowerShell 备忘单](http://blogs.msdn.com/powershell/attachment/1525634.ashx)

*   [创建一组 PowerShell 自定义对象](http://get-powershell.com/2008/03/04/creating-an-array-of-powershell-custom-objects/)

*   [如何开始使用 PowerShell](https://stackoverflow.com/questions/33559/how-to-get-started-with-powershell)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T17:30:19.467

PowerShell 的优点之一是它们在后台做了很多工作以使事物轻松组合在一起，进行隐式类型转换等以使一个程序的输出可用作另一个程序的输入。而且由于一切都传递对象，因此您不必编写文本处理代码来将事物拼凑在一起。

但是，当我编写大量原始代码而不是严重依赖库并将组件粘合在一起时，我确实更喜欢 Python。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T16:49:22.157

应用程序驱动程序的问题是它们经常中断。应用程序不断地改变它们的外表面，这对驱动程序造成了严重破坏。因此，您需要不断更新部分驱动程序。我发现非编译的动态语言非常适合这种情况，因为您可以快速进行更新并启动任务。

Powershell 是一项很棒的技术。它非常灵活且非常容易上手。它是编译代码和动态代码的混合体。因此，驱动程序中算法较多的部分可以是任何编译语言，而更脆弱和经常更新的部分可以是脚本。它们无缝集成。

我是一个狂热的 Powershell 用户，并且对 IronPython 没有太多经验（因此我选择了这个）。IronPython 也可以具有这些功能，因此，如果您对该语言更熟悉，那么您应该去那里。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T10:37:31.480

铁蟒。

我尝试同时使用 Powershell 和 IronPython 来完成上述任务，并得出结论 IronPython 最适合（对我来说）。

公平地说，Powershell 或任何基于 DLR 的语言（如 IronPython 或 IronRuby）都适合该任务，并且比处理琐碎的控制台应用程序开销更少。

如果您所做的只是使用一个 .net 库并编写一些脚本，那么 IronPython 将超越 Powershell。如果您想利用某种 shell 类型的功能或使用现有的 CMDLETS，那么 Powershell 是更好的选择。

IronPython 作为 python 的实现，带来了 python 脚本的所有优点，例如易于学习、易于阅读和快速开发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T19:16:54.407

出于对 PowerShell 的失望，我确实研究了 IronPython。我认为这是 powershell 的一个很好的替代品，特别是如果你是一名程序员。即使你是一名 IT 人员，我认为 Windows 命令 shell + IronPython 是一个很好的组合，可以满足你在 .NET 时代的需求（就像 COM 时代的命令 shell + vbscript 一样）。

# c - 如何在 GCC x86 内联汇编中使用地址常量

> ID：549347
> 
> 赞同：9
> 
> 时间：2009-02-14T16:43:38.580
> 
> 标签：c, gcc, assembly, inline-assembly

GCC 工具链默认使用 AT&T 汇编器语法，但可以通过`.intel_syntax`指令获得对 Intel 语法的支持。

此外，AT&T 和 Intel 语法在 a`prefix`和 a`noprefix`版本中都可用，它们的不同之处在于它们是否需要在寄存器名称前加上`%`sigil。

根据存在的指令，地址常量的格式会发生变化。

让我们考虑以下 C 代码

```
*(int *)0xdeadbeef = 0x1234; 
```

使用`objdump -d`，我们发现它被编译成下面的汇编指令

```
movl $0x1234,0xdeadbeef 
```

由于不涉及任何寄存器，因此这是 and 的正确语法`.att_syntax prefix`，`.att_syntax noprefix`即。嵌入在 C 代码中，它们看起来像这样

```
__asm__(".att_syntax prefix");
__asm__("movl $0x1234,0xdeadbeef");

__asm__(".att_syntax noprefix");
__asm__("movl $0x1234,0xdeadbeef"); 
```

您可以选择用括号括住地址常量，即。

```
__asm__("movl $0x1234,(0xdeadbeef)"); 
```

也会起作用。

将印记添加到普通地址常量时，代码将无法复制

```
__asm__("movl $0x1234,$0xdeadbeef"); // won't compile 
```

当用括号括起来这个表达式时，编译器将发出错误代码而不发出警告，即

```
__asm__("movl $0x1234,($0xdeadbeef)"); // doesn't warn, but doesn't work! 
```

这将错误地发出指令

```
movl $0x1234,0x0 
```

在 Intel 模式下，地址常量必须以段寄存器以及操作数大小和`PTR`标志为前缀（如果可能存在歧义）。在我的机器上（一台装有 Windows XP 和当前 MinGW 和 Cygwin GCC 版本的英特尔双核笔记本电脑），`ds`默认使用该寄存器。

常量周围的方括号是可选的。如果段寄存器被省略，但括号存在，地址常数也能被正确识别。不过，省略寄存器会在我的系统上发出警告。

在`prefix`模式下，段寄存器必须以 为前缀`%`，但仅使用括号仍然有效。这些是生成正确指令的不同方法：

```
__asm__(".intel_syntax noprefix");
__asm__("mov DWORD PTR ds:0xdeadbeef,0x1234");
__asm__("mov DWORD PTR ds:[0xdeadbeef],0x1234");
__asm__("mov DWORD PTR [0xdeadbeef],0x1234"); // works, but warns!

__asm__(".intel_syntax prefix");
__asm__("mov DWORD PTR %ds:0xdeadbeef,0x1234");
__asm__("mov DWORD PTR %ds:[0xdeadbeef],0x1234");
__asm__("mov DWORD PTR [0xdeadbeef],0x1234"); // works, but warns! 
```

省略段寄存器和括号将无法编译

```
__asm__("mov DWORD PTR 0xdeadbeef,0x1234"); // won't compile 
```

我会将此问题标记为*社区 wiki*，因此如果您有任何有用的内容要添加，请随时添加。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T17:42:58.673

/指令仅控制寄存器是否需要前缀`noprefix`（*）（至少看起来是这样，这是文档提到的唯一区别）。值文字在 AT&T 语法中总是需要前缀，而在 Intel 语法中从不需要。所以以下工作：`prefix``%``$`

```
__asm__(".intel_syntax prefix");
__asm__("MOV [DWORD PTR 0xDEADBEEF], 0x1234"); 
```

如果您真的倾向于在使用 GCC 编译并使用 GAS 汇编的 C 代码中使用 Intel 语法内联汇编，请不要忘记在其后添加以下内容，以便汇编器可以了解由生成的其余（AT&T 语法）汇编海合会：

```
__asm__(".att_syntax prefix"); 
```

我看到前缀/无前缀区别的原因是，对于 AT&T 语法，`%`英特尔架构上的寄存器并不真正需要前缀，因为寄存器是命名的。但是为了统一起见，它可能存在，因为其他一些架构（即 SPARC）已经注册了编号，在这种情况下，单独指定一个低数字对于是否指的是内存地址或寄存器是模棱两可的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T18:09:55.987

这是我自己的结果：

```
*(int *)0xdeadbeaf = 0x1234; // reference implementation

// AT&T: addresses without sigil; parentheses are optional

__asm__(".att_syntax prefix");
__asm__("movl $0x1234,0xdeadbeaf");     // works
__asm__("movl $0x1234,(0xdeadbeaf)");   // works
__asm__("movl $0x1234,($0xdeadbeaf)");  // doesn't work, doesn't warn!
//__asm__("movl $0x1234,$0xdeadbeaf");  // doesn't compile
//__asm__("movl 0x1234,0xdeadbeaf");    // doesn't compile
//__asm__("movl 0x1234,(0xdeadbeaf)");  // doesn't compile

__asm__(".att_syntax noprefix");
// same as above: no registers used!

// Intel: addresses with square brackets or segment register prefix
// brackets without prefix will warn

__asm__(".intel_syntax noprefix");
__asm__("mov DWORD PTR ds:0xdeadbeaf,0x1234");      // works
__asm__("mov DWORD PTR ds:[0xdeadbeaf],0x1234");    // works
__asm__("mov DWORD PTR [0xdeadbeaf],0x1234");       // works, but warns!
//__asm__("mov DWORD PTR 0xdeadbeaf,0x1234");       // doesn't compile

// `prefix` will add % to register names

__asm__(".intel_syntax prefix");
__asm__("mov DWORD PTR %ds:0xdeadbeaf,0x1234");     // works
__asm__("mov DWORD PTR %ds:[0xdeadbeaf],0x1234");   // works
__asm__("mov DWORD PTR [0xdeadbeaf],0x1234");       // works, but warns!
//__asm__("mov DWORD PTR 0xdeadbeaf,0x1234");       // doesn't compile

__asm__(".att_syntax prefix"); 
```

# .net - 在 Visual Studio for Compact Framework 2.0 中绘制线条

> ID：549354
> 
> 赞同：1
> 
> 时间：2009-02-14T16:46:18.013
> 
> 标签：.net, visual-studio, windows-mobile, compact-framework

我正在寻找一个工具包，允许我在设计时在 Visual Studio 2008 for .NET Compact Framework 2.0 中绘制线条和框。

我查看了 VisualBasic PowerPacks，但它似乎仅适用于桌面 .NET。

有谁知道任何这样的工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-14T17:05:21.447

你在使用 WinForms 吗？许多控件实现了返回此类型的 Site 属性[http://msdn.microsoft.com/en-us/library/system.componentmodel.isite.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.isite.aspx)有一个 DesignMode 属性，您可以使用它来检查它是否在设计模式与否。

在 void OnRender(...) 方法中，您可以检查此属性是否已设置，然后您可以根据设计时间进行绘制。

```
protected override void OnRender(...)
{
    if (this.Site != null && 
        this.Site.DesignMode) 
    {
        // Draw something...
    }
} 
```

查看有关 Site 和 DesignMode 属性的潜在问题的帖子[http://decav.com/blogs/andre/archive/2007/04/18/1078.aspx](http://decav.com/blogs/andre/archive/2007/04/18/1078.aspx)

# vb6 - 预期类型不匹配错误

> ID：549357
> 
> 赞同：2
> 
> 时间：2009-02-14T16:50:08.223
> 
> 标签：vb6

我期待在编译时出现 ByRef 参数类型不匹配，但我没有得到它。它编译时没有错误，并且在运行时失败并出现错误 13，“类型不匹配”。

这是一个相当简单的重现。

```
dim c as Car
Set c = New Car

Sail c 
```

...

```
Public Sub Sail(ByRef b As Boat)
    ...
End Sub 
```

Car 不**继承**自 Boat

是否存在强制 VB 进入严格编译模式的设置（或插件）？

**编辑：**看起来没有编译器选项。有谁知道在编译期间分析这些铸造问题来源的插件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T16:53:59.960

是否可以在 VB6 中设置 Option Strict True？

编辑：显然在 VB6 中是不可能的（似乎已经在 VB 7.0 中引入）

# cocoa-touch - 如何使用自己的 UIViewController 制作可重用的 XIB？

> ID：549360
> 
> 赞同：1
> 
> 时间：2009-02-14T16:53:46.233
> 
> 标签：cocoa-touch, webkit

我正在尝试创建一个可重复使用的“选择器”。它基本上就像电话的键盘。由于我将在我的 iPhone 应用程序中大量使用它，我一直对试图让它出现感到沮丧。

它在自己的 XIB 文件中，并且有自己的 UIViewController 子类作为 FileOwner。但是，当我用以下方法实例化它时：

```
MonthPickerViewController *mpvc
    = [[MonthPickerViewController alloc] initWithNibName:@"MonthPicker"
                                                  bundle:nil]; 
```

屏幕上什么也没有发生。然而，它确实触发了`-viewWillAppear`方法等。

那么，我在代码或 InterfaceBuilder 中做错了什么会阻止我的视图出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T17:31:09.917

Are you pushing the view controller?

```
[[self navigationController] pushViewController:mpvc animated:YES]; 
```

Or are you adding the view controller's view as a subView of your current view?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T11:39:49.587

首先，确保您已经在 Interface Builder 中连接了所有内容。一个简单的问题是忘记将 View 对象连接到 UIViewController 子类的视图出口。

然后，正如亚当所说，您需要实际显示视图。假设您在另一个视图控制器的代码中执行此操作，如果您只是希望新视图出现在当前视图之上，则需要类似以下内容：

```
[self.view addSubview:mpvc.view]; 
```

如果您使用导航控制器来堆叠视图：-

```
[[self navigationController] pushViewController:mpvc animated:YES]; 
```

# delphi - 如何/如果仅使用表单和数据模块重构 Delphi 程序

> ID：549369
> 
> 赞同：20
> 
> 时间：2009-02-14T17:04:57.827
> 
> 标签：delphi, unit-testing, oop, refactoring, datamodel

经过多年将 Delphi 程序编码为表单和数据模块中不可测试的代码，包括全局变量，唯一的类是表单本身，包含表单 UI 本身所需的所有代码。

我如何将代码转换为一组执行实际工作的类？我是否需要停止使用数据源/数据集并在课堂上做所有事情？我需要 ORM 吗？

表单中的代码重用通常是**零**需求，那么将逻辑转换为类是否有意义？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-14T19:32:25.977

如果我遇到一个责任太多的表单（或其他类），我通常遵循以下模式：

1.  为逻辑定义一个新类。
2.  在表单中创建新类的成员变量。
3.  在 onCreate 中创建类并在表单的 onDestroy 中释放它。
4.  将单个逻辑（例如变量）移动到新类。
5.  将所有方法移动或创建到新类。
6.  编译和测试。
7.  继续，直到所有逻辑都放入新类中。
8.  尝试将逻辑类与表单类解耦。（如果您愿意，您甚至可以使用接口）。

存在单个类不够用的情况，因此创建更多类是没有问题的。而且这些类可以有其他类来。

通过这些步骤，您可以解决大部分问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-14T17:11:57.920

首先，我强烈推荐阅读Martin Fowler 所著的[Refactoring一书。](https://rads.stackoverflow.com/amzn/click/com/0201485672)

这将使您真正了解如何最好地明智地引入对现有（非 OO）代码的更改以提高可维护性。

在您清楚地了解 ORM 会给您的应用程序带来什么好处（如果有的话）之前，我不会看 ORM。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-15T07:50:48.843

我在一个应用程序中遇到了这样的问题，我开始执行以下操作：

1.  为代码中的大多数通用逻辑定义主类。
2.  在每个表单中，将处理事件内部业务逻辑的代码作为该表单中的函数/过程移动。
3.  然后将这些函数/过程作为**静态方法**移动到这些类中。
4.  最后，只在表单中编写所需的代码，如验证 UI 和对类的调用。
5.  对于全局变量，尽量省略，只需将值作为参数传递给方法。

我使用了静态方法，因为您可以更轻松地从事件中删除代码并调用它们，而无需为每个操作创建/释放对象。最初的设计并不是为了将表单与业务逻辑代码分开。

最终的应用程序不是完整的 OO，但它至少更容易测试方法，而无需像以前那样与表单和事件进行交互。

有时您会觉得，如果您从头开始重新设计应用程序，这将比进行更改以使其成为真正的 OO 设计更容易。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-14T20:44:47.783

我强烈推荐的另一本书——在我个人看来甚至比 Fowler 的“通用”重构书更适合——是[Michael Feathers 的“Working Effectively with Legacy Code”](https://rads.stackoverflow.com/amzn/click/com/0131177052)。它真正展示了您在进行此类工作时会遇到的主要障碍。哦，还有：重构遗留代码对你来说可能非常困难。我希望你能处理挫折......我喜欢这句话（不记得我从哪里得到它）：“上帝能够在 6 天内创造世界，只是因为没有任何遗留代码”。祝你好运。;)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-21T03:06:34.763

面对现有的 Delphi 项目时，导入[Modelmaker是我的第一个动作。](http://www.modelmakertools.com/modelmaker/index.html)Modelmaker 将帮助您**重构**代码，因为：

*   它**以图形方式**表示所有类、方法、变量等。
*   它与 Delphi IDE 紧密**集成**（主菜单、弹出菜单、单独的 Modelmaker 资源管理器、工具栏、键盘快捷键）。这种集成允许您在不离开 IDE 的情况下快速执行必要的操作
*   它有一个专用的**“重构”模块**，允许您快速创建、移动和重命名类和变量，而不必担心更改底层代码。Modelmaker 将 **自动更改****所有**单元中的名称和引用。

Modelmaker 的基本功能简单易学。Modelmaker 就像任何其他优秀的生产力工具一样 - 你投入的越多，你得到的就越多。Modelmaker 不是免费的，但可以通过提高生产力轻松收回成本。我还没有找到更好的工具来重构遗留的 Delphi 代码。他们提供免费试用和一些不错的教程电影。试试 Modelmaker，祝你好运……

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-14T18:31:36.153

在了解您需要重构代码之后，如果您想要 OPF/ORM，我建议您使用[Jazz SDK](http://jazz-sdk.googlecode.com)

# ruby-on-rails - 是否可以让 ActiveRecord 为使用 :joins 选项加载的行创建对象？

> ID：549374
> 
> 赞同：5
> 
> 时间：2009-02-14T17:06:41.567
> 
> 标签：ruby-on-rails, ruby, activerecord, join

我需要做这样的事情

```
class User < ActiveRecord::Base
  has_many :abuse_reports
end

class AbuseReport < ActiveRecord::Base
  belongs_to :abuser, :class_name => 'User', :foreign_key => 'abuser_id'
  belongs_to :game
end

class Game < ActiveRecord::Base
  has_many :abuse_reports
end

@top_abusers = User.page(params[:page], 
  :joins => [
    'JOIN abuse_reports ON users.id = abuse_reports.abuser_id', 
    'JOIN games ON games.id = abuse_reports.game_id'
  ], 
  :group => 'users.id',
  :select => 'users.*, count(distinct games.id) AS game_count, count(abuse_reports.id) as abuse_report_count',
  :order => 'game_count DESC, abuse_report_count DESC'
) 
```

这可行，但不会为 AbuseReports 或 Games 创建对象 - 它只是返回一堆行。当我从我的视图中引用这些对象时，它会再次加载它们。有没有办法来解决这个问题？或者以某种方式在不使用 :joins 的情况下获得这种行为？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-14T22:46:40.097

首先，您应该真正使用 :include 而不是 :joins

```
User.find(:all, :include => { :abuse_reports => [ :game ] }, :order => ) 
```

或者，在你的情况下，尝试

```
User.page(params[:page], :include => { :abuse_reports => [ :game ] }) 
```

这将为您执行连接*并*一次性检索记录。

现在，这可能会为您多次检索给定的游戏记录（如果同一个游戏通过多个报告与用户相关联。）如果您的游戏记录很大，您可以减少应用程序和 RDBMS 之间交换的数据量，因为如下：

```
class User < ActiveRecord::Base
  has_many :abuse_reports
  has_many :abused_games, :through => :abuse_reports
end
...

User.find(:all, :include => [ :abuse_reports, :abused_games ]) 
```

最后，您还想检索计数并进行相应的排序。查看[http://railscasts.com/episodes/23](http://railscasts.com/episodes/23)以了解如何将计数器缓存添加到实际的活动记录中（计数器缓存简化了 SQL 并使 RDBMS 的工作更轻松，您的查询运行得更快）。设置计数器缓存后，您最终可以更改上述内容以执行以下操作：

```
User.find(:all, :include => [ :abuse_reports, :abused_games ], :order => 'users.abused_games_count DESC, users.abuse_reports_count DESC') 
```

这最终将在一个简单的 SQL 语句中检索*您**的*ActiveRecords 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T18:08:17.910

The problem you are having is that you use ActiveRecord in way its not "supposed" to be used. By that I mean that you are writing your own sql, which makes AR give up all of its control to you.

If you want AR to handle everything you should try to use it with less of your own SQL in there. It looks like you want to know which user has the highest amount of AbuseReports. Try something like this:

```
some_user.abuse_reports.count 
```

to get the count of abuse_reports

# c# - 将一些文本从一个类发送到另一个类（有一些限制）的最佳方法是什么？

> ID：549382
> 
> 赞同：0
> 
> 时间：2009-02-14T17:12:06.203
> 
> 标签：c#, .net, logging

我正在尝试在我的应用程序中实现日志查看器。这个想法很简单，一个显示从其他类发送的一些消息的列表框，但我不知道最好的方法是什么。

我最初的想法是创建一个包含**List**或**Queue的 Logger 类（** **singletone** ） ，然后我将添加一个**方法 AddMessage(string s)**或类似的东西。当这个方法被调用时，它会将消息添加到列表或队列中，并且**会触发一个 NewMessage 事件**。这个事件是因为我认为每隔一段时间检查一次列表不是一个好主意。消息序列可能是 3 个连续的，然后是 40 分钟没有任何消息，然后是更多......

 ******因此，在我的表单类（或我想接收消息的任何地方）中，我将收听此事件以清空列表或队列**（这是因为即使列表框（最终接收器）没有被发送，我也应该能够发送消息创建）**。列表的想法是在没有人收听事件时保存消息。

另外，我限制了 300 条消息……所以每次我要添加新消息时，最旧的消息都会被删除……像这样：

```
while(listbox.Items.Count > 300)
{
    listbox.Items.RemoveAt(0);
} 
```

你认为这是最好的方法吗？

谢谢你的时间。最好的祝福。

**编辑 1：我不想使用另一个框架。**

**编辑 2：停止建议框架或其他应用程序。我想了解背后的逻辑，以及我提出的建议是对还是错！**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T17:13:54.703

有什么理由不使用现有技术？

*   [Log4Net](http://logging.apache.org/log4net/index.html)或其他一些框架写入日志文件
*   用于查看和过滤日志文件的文本编辑器（和文本过滤器、grep 等）

编辑：我仍然很想使用 Log4Net 并为*某些* 类别/级别设置一个侦听器，这些类别/级别会转储到滚动文本框。这样，您还可以将*（*可能更详细）记录到文件中。

编辑：如果您想学习，那么我建议您查看 Log4Net 的设计和实现。根据您的特定情况，找出它的优势和劣势。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T17:36:39.297

一些需要考虑的问题是：

*   您的应用程序是多线程的吗？写入消息的线程与读取消息并填充列表框的 UI 线程是否相同？

*   每秒创建多少条消息？

*   您希望每秒更新多少次列表框？

*   随着时间的推移，消息的最大数量是多少？您是否将它们全部显示在列表框中，还是丢弃旧的？

*   您是否也希望将消息记录到文件中（例如，出于技术支持目的）？

*   列表框（UI 元素）是唯一存储消息的地方吗？列表框是否始终显示，或者用户可以隐藏/销毁它？

*   最终用户有多复杂？您能否要求他们使用其他（更好的）工具来查看您的日志文件，或者您是否需要在您自己的 UI 中实现一个（相对简单的）查看器？

很抱歉用问题来回答您的问题，但这些问题需要先回答，然后您才能说“这是最好的方法吗？”。

* * *

> 它不是一个多线程应用程序，是一个我不想超载的小应用程序。

如果应用程序不是多线程的，那么“可能工作的最简单的事情”就是不要打扰列表或队列；相反，让您的其他类直接将消息附加到 UI 列表框元素（可能通过委托），例如：

```
class MyClass
{
  Action<string> log;
  MyClass(Action<string> log)
  {
    this.log = log;
  }
  void Something()
  {
    //log a message
    log("Hello world!");
  }
}
class MyForm
{
  ListBox listBox = new ListBox();
  MyClass myClass;
  MyForm()
  {
    //create a delegate which logs strings
    //by writing them to the ListBox
    Action<string> log = delegate(string s) {
      listBox.Items.Add(s);
    };
    //pass this logger to classes which need to use it
    myClass = new MyClass(log);
    //test it
    myClass.Something();
  }
} 
```

* * *

这是使用非匿名委托的类似代码，具有您的评论之一中要求的一些额外功能：

```
class MyForm
{
  ListBox listBox = new ListBox();
  MyClass myClass;
  MyForm()
  {
    //pass the Log action to classes which need to use it
    myClass = new MyClass(Log);
    //test it
    myClass.Something();
  }

  ///logs strings by writing them to the ListBox
  void Log(string s)
  {
    if (listBox.Items.Count == 300)
      listBox.Items.RemoveAt(0);
    listBox.Items.Add(s);
  }
} 
```

* * *

> 我想我回答错了（6）。即使尚未创建列表框，我也应该能够发送消息......这就是我建议使用列表或队列的原因

在这种情况下，您确实需要除 ListBox 之外的存储空间。你的建议会奏效。另一种建议是：

*   创建 ListBox 时，从 List 填充它（使用 ListBox.Items.AddRange 方法）
*   在 Log 函数中，如果 ListBox 不存在则将消息写入 List，否则如果 ListBox 存在则将消息写入 ListBox。

这样做*可能*比定义、监听和触发事件（非常简单）简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T17:22:45.740

我想我和@Jon Skeet 在一起。使用现有的日志工具，并将其与应用程序中的某种日志阅读器相结合。如果您使用 log4net，您可以登录到数据库并让您的日志视图定期轮询数据库以获取新消息。如果您登录到一个文件，您可以使用 FileSystemWatcher 来检测日志文件中的更改并重新加载您的视图。这将减少工作量，并且您可以相信通过依赖现有的、备受推崇的解决方案并对其进行扩展，该解决方案会更加健壮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T17:28:27.460

我将创建一个在程序的 main() 中定义的类。该类将包含一个允许日志可伸缩性的链表。然后，每当一个函数需要记录一些东西时，它就可以调用该类的一个运算符来记录一些东西。如果要使用线程，则需要小心互斥锁。

**编辑：**

这个想法是您声明一个包含全局所有日志的类。因此，您创建了一个包含所有日志并能够显示它们的类。您将定义该类类型的变量并定义其他类以便能够使用该全局类变量进行记录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T18:02:00.437

> “因为我想学习。我只是想知道我所建议的逻辑是否正确。”

您最初概述的策略应该有效。我建议你继续你的设计，而不是继续这场辩论。您可能会在此过程中做出改变，但这将是一次学习体验，最终，您将拥有适合您的目的的东西。

# python - Python 3.0 smtplib

> ID：549391
> 
> 赞同：3
> 
> 时间：2009-02-14T17:20:58.087
> 
> 标签：python, python-3.x

我有一段非常简单的代码，我在以前的 Python 版本（2.5 版和更早版本）中使用它没有问题。现在使用 3.0，下面的代码在登录行给出错误“参数 1 必须是字符串或缓冲区，而不是 str”。

```
import smtplib

   smtpserver = 'mail.somedomain.com'
   AUTHREQUIRED = 1                     # if you need to use SMTP AUTH set to 1
   smtpuser = 'admin@somedomain.com'    # for SMTP AUTH, set SMTP username here
   smtppass = 'somepassword'            # for SMTP AUTH, set SMTP password here
   msg = "Some message to send"

   RECIPIENTS = ['admin@somedomain.com']
   SENDER = 'someone@someotherdomain.net'

   session = smtplib.SMTP(smtpserver)

   if AUTHREQUIRED:
      session.login(smtpuser, smtppass)

   smtpresult = session.sendmail(SENDER, RECIPIENTS, msg) 
```

谷歌显示该错误存在一些问题并不清楚，但我仍然无法弄清楚我需要什么来尝试使其工作。建议包括将用户名定义为 b"username"，但这似乎也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T19:29:28.637

**更新**：刚刚从错误跟踪器中注意到还有一个建议的修复：

编辑 smtplib.py 并将现有`encode_plain()`定义替换为：

```
def encode_plain(user, password):
    s = "\0%s\0%s" % (user, password)
    return encode_base64(s.encode('ascii'), eol='') 
```

在我的安装上进行了测试，它工作正常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T18:21:05.697

```
Traceback (most recent call last):
  File "smtptest.py", line 18, in <module>
    session.login(smtpuser, smtppass)
  File "c:\Python30\lib\smtplib.py", line 580, in login
    AUTH_PLAIN + " " + encode_plain(user, password))
  File "c:\Python30\lib\smtplib.py", line 545, in encode_plain
    return encode_base64("\0%s\0%s" % (user, password))
  File "c:\Python30\lib\email\base64mime.py", line 96, in body_encode
    enc = b2a_base64(s[i:i + max_unencoded]).decode("ascii")
TypeError: b2a_base64() argument 1 must be bytes or buffer, not str 
```

你的代码是正确的。这是**smtplib**或**base64mime.py**中的错误。您可以在此处跟踪问题：http: [//bugs.python.org/issue5259](http://bugs.python.org/issue5259)

希望开发者能尽快发布补丁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T08:58:02.983

作为 Jay 答案的一种变体，您可以在运行时对其进行“猴子补丁”，而不是编辑 smtplib.py。

把它放在你的代码中的某个地方：

```
 def encode_plain(user, password):
    s = "\0%s\0%s" % (user, password)
    return encode_base64(s.encode('ascii'), eol='')

import smtplib
encode_plain.func_globals = vars(smtplib)
smtplib.encode_plain = encode_plain 
```

如果您想将代码部署到其他系统而不更改它们的 python 库，这有点难看但很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-30T07:52:24.337

此问题已在 Python3.1 中解决。[在http://www.python.org/download/releases/3.1/](http://www.python.org/download/releases/3.1/)获取更新

# .net - LinqToSql 声明和实例化 DataContext 最佳实践？

> ID：549393
> 
> 赞同：15
> 
> 时间：2009-02-14T17:23:13.447
> 
> 标签：.net, vb.net, linq-to-sql, datacontext

在设置我的 DataContext 以便在我的扩展 LinqToSql 类中轻松访问方面的最佳实践是什么？

例如，我的 dbml 中有一个“用户”实体，我想向该类添加方法，如下所示：

```
Partial Public Class User

    Public Function GetUser(ByVal UserID as Integer) as User
         'Do Work
    End Function

End Class 
```

为了访问我的 DataContext 我必须在方法中声明它，如下所示：

```
Partial Public Class User

    Public Function GetUser(ByVal UserID as Integer) as User
         Dim dc as New MyDataContext()
         Return (From u in dc.Users Where u.ID = UserID).Single()
    End Function

End Class 
```

我不想对每种方法都这样做。通常（如果我没有扩展 LinqToSql dbml 类）我可以这样做：

```
Partial Public Class User
    Private dc as MyDataContext

    Public Sub New()
         dc = new MyDataContext()
    End Sub

    Public Function GetUser(ByVal UserID as Integer) as User
         Return (From u in dc.Users Where u.ID = UserID).Single()
    End Function

    Public Function GetAllUsers() as IEnumerable(Of User)
         Return From u in dc.Users
    End Function

    'etc...

End Class 
```

这将允许我访问每个方法的数据上下文，而不必每次都重新声明它。但是你当然不能这样做，因为 dbml 已经有一个构造函数。如果有任何变化，将代码添加到 dbml 中总是会被覆盖。

有人对如何在这里为自己节省一些多余的代码有什么好主意吗？

蒂亚！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-14T17:27:40.580

首先，确保您在完成后处理您的 DataContext！他可能是一个沉重的小混蛋（**编辑**实例化不重，但如果您继续使用它而不处置它，则很重）；您不希望旧的 DataContexts 在内存中徘徊。

其次，**DataContext 旨在表示单个逻辑事务**。例如，您应该在每次要开始新事务时创建一个新事务，并在*该*事务完成时将其删除。因此，出于您的目的，这*可能*是该`GetUser`方法的范围。如果您有一系列需要作为一个组进行的 DB 调用，则在摆脱它之前，它们都应该使用相同的 DC。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-14T17:44:42.570

正如[Rex M 所说](https://stackoverflow.com/questions/549393/linqtosql-declare-and-instantiate-datacontext-best-practice/549398#549398)，数据上下文旨在为每个逻辑事务实例化、使用和处置。像这样的模式有时被称为“工作单元”。

最常见的方法（据我所知）是在 using 块中实例化您的数据上下文。我有一段时间没有使用 VB，但它应该看起来像这样：

```
Using dc As New MyDataContext()
   user = (From u in dc.Users Where u.ID = UserID).Single()
End Using 
```

这不仅增强了事务/工作单元的*外观*（通过代码的物理形状），而且确保在块结束时在数据上下文中调用 Dispose()。

请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx)：

> 通常，DataContext 实例旨在持续一个“工作单元”，但是您的应用程序定义了该术语。DataContext 是轻量级的，创建起来并不昂贵。典型的 LINQ to SQL 应用程序在方法范围内创建 DataContext 实例，或者将其作为表示一组相关数据库操作的逻辑集的短期类的成员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T17:29:42.463

我认为也许真正的问题`User`可能不是实例成员调用的正确位置`GetUser`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T17:49:42.370

我认为有几种不同的方法可以解决这个问题，这将是很好的做法。首先，您可以使用存储库模式，在其中查询存储库以获取对象，然后将其发送到数据库，检索对象-可能将其与数据上下文分离或根据存储库的实现保留数据上下文-并将其退还给您。您的对象的工厂方法将位于存储库上，而不是实体本身。您可能会使用反射和泛型来最小化您必须实现的方法数量并保持代码干燥。

另一种方式，以及 LINQtoSQL 旨在本地使用的方式恕我直言，是为您打算执行的每组数据库操作创建数据上下文。在这种情况下，数据上下文的创建也发生在实体之外，通常在使用实体的类中，而不是在数据层中。您还可以向数据上下文添加方法——使您的实际数据上下文抽象并从中继承——再次使用反射来执行一些常见的检索功能，这样您就不必重复它们了。您可能必须使用像 ActiveRecords 这样的数据库模式，其中 id 列始终具有相同的名称才能使其工作。

另一方面，您可以考虑使用[nHibernate](http://www.hibernate.org/343.html)或 Castle 的[ActiveRecord](http://www.castleproject.org/ActiveRecord/)，而不是在您自己的解决方案中复制上述任何一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T18:28:35.427

如果您不理会 User 类并允许 IDE 处理它的创建，这可能会更容易。

通常我更喜欢让一个单独的类来处理数据检索。假设您将其称为 UserDataProvider 并且所有获取 User 实例的调用最终都会通过此类。

UserDataProvider 的构造函数可以实例化数据上下文对象的全局实例以供重用。它看起来像这样（在 C# 和未经测试的代码中，请耐心等待）：

```
public class UserDataProvider 
{
    private UserDataContext _data = null;

    public UserDataProvider()
    {
        _data = new UserDataContext();
    }

    public User GetUser(int userID)
    {
        return _data.Users.FirstOrDefault(u => u.UserID == userID);
    }
} 
```

或者，您可以将初始化放在一个属性中并访问该属性以使用数据上下文。

```
public class UserDataProvider 
{
    private UserDataContext _dataContext;

    private UserDataContext DataContext 
    {
        get
        {
            if (_data == null)
                _data = new UserDataContext();

            return _data;
        }
    }

    public User GetUser(int userID)
    {
        return DataContext.Users.FirstOrDefault(u => u.UserID == userID);
    }
} 
```

# cocoa - observeValueForKeyPath:ofObject:change:context: 不适用于数组

> ID：549397
> 
> 赞同：0
> 
> 时间：2009-02-14T17:27:07.230
> 
> 标签：cocoa, cocoa-bindings, key-value-observing, nsarraycontroller

我有一个对象，它为一个名为`contents`. 在那些访问器中，当我修改底层数组时，我调用`willChange:valuesAtIndexes:forKey:`了`didChange:valuesAtIndexes:forKey:`。

我还有一个自定义视图对象，它`contents`通过`NSArrayController`. 在我见过`observeValueForKeyPath:ofObject:change:context:`的变化字典中唯一的值是. 当我向数组添加对象时，我希望看到.`NSKeyValueChangeKindKey``NSKeyValueChangeSetting``NSKeyValueChangeInsertion`

正如您想象的那样，每次插入单个项目时重新创建它观察到的对象的视图的内部表示 - 特别是当我批量加载数百个项目时 - 会带来相当大的性能问题。每次添加或删除单个项目时，Cocoa 似乎都认为我正在设置一个全新的数组，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T00:30:26.247

（所有读者请注意：我也讨厌为此使用答案，但是这个讨论太长了，无法发表评论。当然，缺点是它最终没有按时间顺序排序。如果你不喜欢它，我建议你向 Stack Overflow 管理员抱怨评论受到长度限制且仅限纯文本。）

> 我不明白你在视图中实现数组访问器是什么意思。

为您作为绑定公开的可变数组属性实现访问器，包括索引访问器。

> 绑定建立在 KVO 之上。

还有KVC。

> 所有绑定都是使用实现的`observeValueForKeyPath:`

覆盖这是一种方式，当然。另一种方法是在具有可绑定属性（视图）的对象中实现访问器。

> 我的自定义视图提供了应用程序绑定到数组的绑定——或者在本例中为数组控制器。访问器方法适用于 KVC，而不是 KVO。

Cocoa Bindings 将为您调用视图的访问器（可能使用 KVC）。您不需要实现 KVO 观察方法（当然，除非您直接使用 KVO）。

我知道这一点，因为我就是这样做的。[请参阅CPU 使用情况](http://boredzo.org/cpuusage/hg/)中的 PRHGradientView 。

奇怪的是，文档没有提到这一点。我将提交一个关于它的文档错误——要么我正在做一些脆弱的事情，要么他们忘记在文档中提到这个非常好的特性。

> 绝对重要的是，我在每次阵列更新时都会收到一组消息。如果没关系，我不会将其作为问题发布。

有相当多的人从事所谓的“过早优化”。如果不问，我无法知道谁是其中之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T23:39:08.303

由于此问题范围之外的原因，我手动调用了 KVO 方法。我已禁用此属性的自动观察。我知道我在那里做什么。

我不明白你在视图中实现数组访问器是什么意思。绑定建立在 KVO 之上。所有绑定都是使用`observeValueForKeyPath:`我的自定义视图实现的，我的自定义视图提供了一个应用程序绑定到数组的绑定——或者在本例中，是一个数组控制器。访问器方法适用于 KVC，而不是 KVO。

绝对重要的是，我在每次阵列更新时都会收到一组消息。如果没关系，我不会将其作为问题发布。我称之为

```
[[modelObject mutableArrayValueForKey:@"contents"] addObjectsFromArray:hundredsOfObjects]; 
```

在每次插入时，我的视图都会观察到一个全新的数组。由于我可能会添加数百个对象，`O(N^2)`因此应该是`O(N)`. 这是完全不可接受的，抛开性能问题不谈。但是，既然你提到了它，视图确实必须做大量的工作才能观察一个全新的数组，这会显着减慢程序的速度。

我不能放弃使用数组控制器，因为我需要过滤和排序，并且因为`NSTableView`绑定到同一个控制器。我依靠它来保持排序和选择的同步。

我用一个完整的黑客解决了我的问题。我编写了一个单独的方法，手动调用 KVO 方法，以便只发送一条 KVO 消息。这是一个 hack，我不喜欢它，它仍然让我的视图重新读取整个数组——虽然现在只有一次——但它现在可以工作，直到我找到更好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T18:07:07.680

> I have an object that implements the indexed accessor methods for a key called contents. In those accessors, I call willChange:valuesAtIndexes:forKey: and didChange:valuesAtIndexes:forKey: when I modify the underlying array.

Don't do that. KVO posts the notifications for you when you receive a message to one of those accessors.

> I also have a custom view object that is bound to contents via an NSArrayController. In observeValueForKeyPath:ofObject:change:context: the only value in the change dictionary for the NSKeyValueChangeKindKey I ever see is NSKeyValueChangeSetting. When I'm adding objects to the array, I expect to see NSKeyValueChangeInsertion.

For one thing, why are you using KVO directly? Use `bind:toObject:withKeyPath:options:` to bind the view's property to the array controller's `arrangedObjects` (I assume) property, and implement array accessors (including indexed accessors, if you like) in the view.

For another, remember that `arrangedObjects` is a derived property. The array controller will filter and sort its content array; the result is `arrangedObjects`. You could argue that permuting the indexes from the original insertion into a new insertion would be a more accurate translation of the first change into the second, but setting the entire `arrangedObjects` array was probably simpler to implement (something like `[self _setArrangedObjects:[[newArray filteredArrayUsingPredicate:self.filterPredicate] sortedArrayUsingDescriptors:self.sortDescriptors]]`).

Does it really matter? Have you profiled and found that your app is slow with wholesale array replacement?

If so, you may need to bind the view directly to the array's `content` property or to the original array on the underlying object, and suffer the loss of free filtering and sorting.

# c# - C# 创建数组数组

> ID：549399
> 
> 赞同：55
> 
> 时间：2009-02-14T17:28:09.410
> 
> 标签：c#, arrays

我正在尝试创建一个将使用重复数据的数组数组，如下所示：

```
int[] list1 = new int[4] { 1, 2, 3, 4 };
int[] list2 = new int[4] { 5, 6, 7, 8 };
int[] list3 = new int[4] { 1, 3, 2, 1 };
int[] list4 = new int[4] { 5, 4, 3, 2 };

int[,] lists = new int[4, 4] {  list1 ,  list2 ,  list3 ,  list4  }; 
```

我无法让它工作，所以我想知道我是否正在接近这个错误。

我正在尝试做的是创建某种方法来创建一长串值，以便我可以按特定顺序重复处理它们。就像是，

```
int[,] lists = new int[90,4] { list1, list1, list3, list1, list2, (and so on)};

for (int i = 0; i < 90; ++i) {
   doStuff(lists[i]);
} 
```

`doStuff()`并按顺序传递数组。我是完全错误的，还是我错过了创建数组数组的东西？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-14T17:37:19.340

你需要做的是：

```
int[] list1 = new int[4] { 1, 2, 3, 4};
int[] list2 = new int[4] { 5, 6, 7, 8};
int[] list3 = new int[4] { 1, 3, 2, 1 };
int[] list4 = new int[4] { 5, 4, 3, 2 };

int[][] lists = new int[][] {  list1 ,  list2 ,  list3 ,  list4  }; 
```

另一种选择是创建一个`List<int[]>`类型：

```
List<int[]> data=new List<int[]>(){list1,list2,list3,list4}; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-14T17:37:37.640

问题是您试图将列表中的元素定义为多个列表（而不是定义的多个整数）。您应该像这样定义列表。

```
int[,] list = new int[4,4] {
 {1,2,3,4},
 {5,6,7,8},
 {1,3,2,1},
 {5,4,3,2}}; 
```

你也可以做

```
int[] list1 = new int[4] { 1, 2, 3, 4};
int[] list2 = new int[4] { 5, 6, 7, 8};
int[] list3 = new int[4] { 1, 3, 2, 1 };
int[] list4 = new int[4] { 5, 4, 3, 2 };

int[,] lists = new int[4,4] {
 {list1[0],list1[1],list1[2],list1[3]},
 {list2[0],list2[1],list2[2],list2[3]},
 etc...}; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-14T17:39:06.233

我认为您可能正在寻找[Jagged Arrays](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/arrays/jagged-arrays)，它与 C# 中的多维数组（如您在示例中使用的那样）不同。将声明中的数组转换为锯齿状数组应该可以正常工作。但是，您仍然需要使用两个循环来遍历 2D 锯齿状数组中的所有项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-14T14:49:20.373

这会垂直循环，但可能对您有用。

```
int rtn = 0;    
foreach(int[] L in lists){
    for(int i = 0; i<L.Length;i++){
          rtn = L[i];
      //Do something with rtn
    }
} 
```

# ajax - 如何优雅地处理来自 Ajax 请求的响应中的 JSON 对象？

> ID：549407
> 
> 赞同：5
> 
> 时间：2009-02-14T17:31:05.380
> 
> 标签：ajax, json, prototypejs, scriptaculous

我对使用 JSON 处理我的 Ajax 请求和响应周期真的很陌生。我之前只使用了作为 POST 数据传递的普通旧参数，并且我在响应中呈现了直接的 HTML，然后将其放入 DOM 中。当我查看了各种示例并阅读了各种教程时，从 JSON 对象与 HTML 混合构建一个字符串似乎是一种相当普遍的做法，该 HTML 已被硬编码到字符串中，然后将字符串作为 innerHTML 分配给某个元素.

一个常见的示例如下所示：

```
var jo = eval(req.responseText);

var strTxt = '<span>' + jo.f_name + ' ' + jo.l_name + '</span><br/>' + 'Your Age Is: ' + jo.age + '<br/>'; 

$('myDiv').innerHTML = strTxt; 
```

是否有更优雅（或更正确）的方式来处理 JSON 响应，这样我就不会在 javascript 中对 HTML 进行硬编码？或者这几乎是人们的做法？

PS 链接到教程或其他来源表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T17:40:54.857

您可以使用 javascript 在 DOM 中创建元素，而不仅仅是将它们放入 DIV 的 innerHtml 中，如下所示（未经测试）：

```
var mySpan = document.createElement("span");
var spanContent = document.createTextNode(jo.f_name + ' ' + jo.l_name);
mySpan.appendChild(spanContent);
var myBr = document.createElement("br");
mySpan.appendChild(myBr);
var otherSpanContent = document.createTextNode('Your Age Is: ' + jo.age);
mySpan.appendChild(otherSpanContent);
mySpan.appendChild(myBr);

$('myDiv').appendChild(mySpan); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T17:50:08.390

我避免在 JavaScript 字符串中编写大量 HTML。我更喜欢将结构与数据操作分离。更好的选择是将该代码放在页面中，根据 ID 加载值，并在必要时显示/隐藏它：

```
<div id="codeBlock" style="visible=false;">
    <span id="val1"></span>
    <br/>
    <span id="val2"></span>
    <br/>
</div>
............
<script>
    var jo = eval(req.responseText);
    $('val1').innerHTML = jo.f_name + ' ' + jo.l_name;
    $('val2').innerHTML = 'Your Age Is: ' + jo.age;
    $('codeBlock').show();
</script> 
```

这可能不是你想要做的，但你明白了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T17:53:19.850

您可以查看[PURE](http://beebole.com/pure/)之类的模板引擎- 一开始可能有点难以入门，但它支持许多主要的 javascript 框架（以及不错的 DOMAssistant）并将 html 从数据中分离出来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T17:58:13.240

从 JSON 创建的对象是标准的 Javascript 对象，因此您可以轻松地使用 jQuery 选择器来创建或访问 DOM 元素并从 JSON 对象插入内容。

例如。

```
// Create a new span element and set its text
var personSpan=$("<span>").text(jo.f_name + ' ' + jo.l_name);

// Append the span to the existing myDiv element
$("myDiv").append(personSpan);

// Create a new div element (better then br) and set its text
var personDiv=$("<div>").text("Your Age Is: " + jo.age);

// Append the new div to the existing myDiv element
$("myDiv").append(personDiv); 
```

# c# - 我如何知道我网站的在线用户

> ID：549411
> 
> 赞同：5
> 
> 时间：2009-02-14T17:34:23.920
> 
> 标签：c#, asp.net, session

我将 Session["UserID"] 的值设置为登录用户的 ID，这样我就可以知道用户是谁。但我想知道所有用户登录我的页面，并显示他们的列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T17:48:17.927

通常，您会问“如何知道过去 x 分钟内谁活跃”。

在每个页面条目上记录他们的最后活动时间，然后查询该列表以查看过去几分钟内谁活动。您可以扩展它并记录他们访问的最后一页，以了解有多少人在线，以及有多少人在特定页面上。

您可以通过在数据库中的用户表中添加几个字段来做到这一点。一个用于 lastActivityTime，一个用于 lastVisitedLocation。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T19:36:46.513

登录用户遇到的主要问题是，如果有人关闭浏览器或杀死浏览器或断电，则无法保证数字准确无误，这是您知道他们未登录的唯一方法在，是他们的会话到期时，所以，默认情况下这是 20 分钟......我真的不喜欢将这些信息保存到数据库中，虽然它是有效的，但同样的问题仍然存在，你可以准确地展示是 asp.net 认为活跃的会话数，不一定是仍在使用您的网站的用户数 乔纳森的回答是最好的折衷方案，因为它是一个时间点的衡量标准，而不是一个有保证的数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T17:55:06.333

您可以使用数据库会话，然后使用它来跟踪登录用户，一旦您开始使用数据库会话跟踪变得容易，

没有在线用户将只是表中记录的计数

由于您将在会话表中记录每个登录用户的记录，因此您也可以获取登录用户的名称。

# javascript - Howto: PHP/Javascript communication

> ID：549427
> 
> 赞同：2
> 
> 时间：2009-02-14T17:42:24.947
> 
> 标签：javascript, php, ajax

As I'm developing my [WebIDE](https://stackoverflow.com/questions/521723/reflective-web-application), I keep coming up with questions that I cannot answer myself. This is because the project is supposed to help others create what they would "normally" create, but faster (i.e. as automated as possible). In this light, my question is how to you implement a PHP backend?

Here is what I do. I like to create "functions" that the client JavaScript can call. Usually, I send (via POST and JSON) a variable called "action" which holds the name of the "function" I am calling (as well as any arguments I wish to send it). The PHP code, then, looks something like this:

```
if(issset($_POST['action'])) {
    //function foo(arg1,arg2)
    if($_POST['action'] == 'foo') {
        $arg1 = $_POST['arg1'];
        $arg2 = $_POST['arg2'];
        //do stuff
    }
} 
```

I can still reference other real functions I create in PHP, but I find that this is a nice way to organize everything and easy to implement in both JavaScript and PHP.

What do you do?

**Edit 1:** Ok, based on the first two answers to this question, I do not think I am explaining myself well.

I am asking how do you create a PHP back end. The idea is that you have your AJAX client written in JavaScript (or maybe something else, it *doesn't matter*), and then it will call your backend PHP with POST or GET data. Based on this data, your backend will do what it needs to do (maybe it will simply update the database, and maybe even return information, again: it *doesn't matter*).

The question now is: how do you tell it what to do? What do you send via POST/GET and how do you interpret it in your backend?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-03-15T15:03:01.680

我在一个大的 GET 数组中将所有数据发送到后端。

actionpage.php?action=post¶meters[parameter1]=value1¶meters[parameter2]=value2

如果你 print_r($_GET)，在 PHP 端你会看到：

```
array(
    "action" => "create",
    "parameters" => array("parameter1"=>"value1","parameter2"=>"value2")
) 
```

这样做是允许您循环访问您的参数。你可以在纸上说

```
 if($_GET['action'] == 'create'){
      foreach($_GET['parameters'] as $key=>$value){ //something 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T23:18:06.683

> 现在的问题是：你如何告诉它该做什么？你通过 POST/GET 发送什么，你如何在后端解释它？

选择您自己的约定。例如，在您的 JSON 数据中使用“动作”值来告知动作，然后添加更多参数。如果您想查看其他网站的行为，您可以在 Firefox 中使用 Firebug 扩展来监视各种网站的 Ajax 消息。

例如，Json POST 数据可以是：

```
{
    action: "create",
    fields: {
       firstname: "John",
       lastname: "Doe",
       age: 32
    }
} 
```

您可以用新创建的记录的 ID 回复它。

要删除记录：

```
{
    action: "delete",
    keys: {
        id: 4654564
    }
} 
```

等等

在 php ajax 处理程序中，您可以拥有像开关一样简单的东西：

```
$jsonData = Services_Json::decode($_POST['json']);
switch ($jsonData->action)
{
    case "save":
        if (validate_json_data($jsonData->fields))
        {
            UsersPeer::create($jsonData->fields);
        }
        break;
    case "delete":
        /* etc */
}

// return a json reply with 
$jsonReply = new stdClass;
$jsonReply->status = "ok";
$jsonReply->statusMessage = "Record succesfully created";
echo Services_Json::encode($jsonReply);
exit; 
```

Javascript，比如说原型 Ajax.Request 响应函数，如果“status”不是“ok”等，将在一个专门创建的 DIV 中输出错误消息……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-22T23:28:12.530

您需要组织功能吗？它被称为“类”。

```
/// todo: add error processing
$name=$_GET['action'];
$args=json_decode($_GET['args']); /// or just subarray, doesn't matter

/// 'Action' is constant here but in reality you will need more then one class for this
/// because you will want modules in your framework
if(method_exists('Action',$name))
    call_user_func_array(array('Action',$name),$args);
else { /* incorrect parameters processing */ }

/// Ajax-available functions are here
class Action
{
    public static function action1()
    {
        echo 'action1';
    }
    public static function action2()
    {
        echo 'action2';
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-27T12:59:01.257

我使用一个处理我的路由的首页控制器。如果您设置 mod-rewrite 您可以拥有非常干净的端点，其中您的 url 的第一段引用控制器（类），然后后续段将引用内部的方法，然后是传递给方法的参数。

[http://domain.com/class/method/param1/param2](http://domain.com/class/method/param1/param2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T05:30:03.377

这个网站会回答你所有的 ajax 问题。我发现它真的很有帮助。 [http://ajaxpatterns.org/XMLHttpRequest_Call](http://ajaxpatterns.org/XMLHttpRequest_Call)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-14T18:09:34.350

I do something very similar. What you need is a JSON object to pass back to the javascript. When you are done with your PHP, you can call [json_encode](http://ca2.php.net/json_encode) to pass an object back to the front end. From there you can do more with it in Javascript or format it however you want.

There is more information on a similar question here: [Best way to transfer an array between PHP and Javascript](https://stackoverflow.com/questions/393479/best-way-to-transfer-an-array-between-php-and-javascript/393497#393497)

Edit: After reading your edit, I think what you are doing is fine. When you send the AJAX request from Javascript include a variable like "action", or whatever youd like. From there you can check what the action is via a case and switch statement.

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-02-14T18:23:49.743

I usually write the php functions as normal functions.

```
fn1(arg1, arg2){
 //do stuff here
}
fn2(arg3){
 //do stuff here
} 
```

I pass the name of the function in a variable called action. Then do this:

```
foreach($_POST as $key => $value) 
$$key = $value; 
```

To assign create variables of the same name as the arguments.

Then use a switch-case to call the appropriate function like so:

```
switch($action){
 case 'fn1':fn1(arg1,arg2);
 break;
 case 'fn2':fn2(arg3);
 break;
} 
```

Is this what you are looking for?

Edit: You could use the [PHP SOAP and XML-RPC extension](http://www.onlamp.com/pub/a/php/2007/07/26/php-web-services.html) to develop a webservice, where if you specify the function name in the SOAP request, that function will be automatically executed (you don't have to write the switch-case or if). I've used it in Java, but am not sure how exactly it works in PHP.

# computer-science - 非微积分编程呢？

> ID：549434
> 
> 赞同：1
> 
> 时间：2009-02-14T17:47:24.137
> 
> 标签：computer-science

我最近询问[了过去 10 年的新语言和语言特性](https://stackoverflow.com/questions/549274/what-programming-languages-and-language-features-are-under-10)，但显然没有。

但是我注意到一个问题是我们的大部分注意力都集中在各种类型的微积分上。但是考虑一下，理论上我可以将神经网络和遗传编程视为非基于微积分的编程模型，尽管缺乏独立的实现，但它们是近年来诞生的有趣想法（比 lambda 1930 还少）。

同样开箱即用的还有查询语言、正则表达式和基于图形/树的设计，虽然部分是数学的，但不是微积分，这让我思考现在编程中哪些其他非微积分设计很重要，以及其他什么领域可能为我们提供新的编程范式？

**注意：**这个问题不是关于“新”，而是关于不是来自微积分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T18:04:19.293

神经网络已有 50 多年的历史，例如 [Perceptron](http://en.wikipedia.org/wiki/Perceptron)。

[遗传编程](http://en.wikipedia.org/wiki/Genetic_programming)已有 40 多年的历史。

现在原始问题已被编辑，因此年龄不再相关......

顺便说一句，面向对象编程起源于 40 多年前的模拟（Simula 67）。

大多数其他编程语言要么自下而上派生自机器可以做的事情（命令式语言从 1954 年的 FORTRAN 开始），要么来自一些数学计算概念（例如 1957 年的 lambda 演算启发了 Lisp 和后来的其他函数式语言。Prolog 是另一个例子源自数理逻辑）。您看到的编程语言与微积分的关系大多是偶然的，因为数值计算是早期计算机的主要用途，今天仍然很重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T18:09:17.907

并行编程实践可能会出现新的编程范式。目前，有很多方法可以处理在多个处理器上运行的程序，有些好，有些不好。我希望随着对该主题的更多研究，一些核心方法将成为新语言整合的常见方法，因此它们可以以“简单”的方式使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T18:10:16.143

我认为这些领域的任何重大转变都可能来自于我们对问题的思考方式的转变，而不是我们用来解决问题的语言。

我们现在拥有的工具非常擅长解决当前框架下的计算问题。对问题的新观点肯定会推动新语言的创造，但这只是副产品而不是推动力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T17:53:42.000

我认为随着我们越来越接近与人交互的人工智能，词汇编程将越来越重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T18:07:04.607

微积分不是数学，它只是数学的一部分——作为一个整体，所有的编程语言都是基于数学的，程序可以转化为代数结构（或者，更理论上，转化为 lambda 演算或图灵机结构）。我想说的是，所有关于编程的计算机科学方面的工作（如标记）都必然基于数学，尽管可能不是微积分，所以这样的问题是不公平的。不是像 Knuth 的 Literate Programming 这样的东西，它专注于编程的非数学方面——文档等，而且它并不是真正的新东西。

编辑：原始问题已更新。谢谢，我想。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-20T15:18:46.993

根据定义，非微积分编程对我来说听起来是物理事物组合成一个整体实体，它应该通过非人类创造的物理或/和设备执行的计算而形成另一个整体。我们可以认为，这绝对是计算的未来，因为它会起源于人类理解范围之外的东西。应该使用一些有效的东西，但我们不明白如何。但是，在另一种思维方式中，这不是未来。这就是宇宙的形成方式，包括我们作为一个整体。因此，考虑到我们的大脑，这不是很实用。显然，我们可以尝试使用一些我们尚未发现的东西，如量子计算、量子纠缠或其他物理现象。差不多就是这样，我们有什么选择。目前还不是很实用

# java - Android 的换行小部件布局

> ID：549451
> 
> 赞同：100
> 
> 时间：2009-02-14T17:56:13.057
> 
> 标签：java, android, user-interface, layout

我正在尝试创建一个向用户呈现一些数据的活动。数据可以分为“单词”，每个单词都是一个小部件，“单词”序列将形成数据（“句子”？），即包含单词的 ViewGroup 小部件。由于“句子”中所有“单词”所需的空间将超过显示器上可用的水平空间，我想将这些“句子”像普通文本一样包装。

以下代码：

```
public class WrapTest extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        LinearLayout l = new LinearLayout(this);
        LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(
                LinearLayout.LayoutParams.FILL_PARENT,
                LinearLayout.LayoutParams.WRAP_CONTENT);
        LinearLayout.LayoutParams mlp = new LinearLayout.LayoutParams(
                new ViewGroup.MarginLayoutParams(
                        LinearLayout.LayoutParams.WRAP_CONTENT,
                        LinearLayout.LayoutParams.WRAP_CONTENT));
        mlp.setMargins(0, 0, 2, 0);

        for (int i = 0; i < 10; i++) {
            TextView t = new TextView(this);
            t.setText("Hello");
            t.setBackgroundColor(Color.RED);
            t.setSingleLine(true);
            l.addView(t, mlp);
        }

        setContentView(l, lp);
    }
} 
```

产生类似于左图的东西，但我希望布局呈现与右图相同的小部件。

![非包装](https://fnord.se/android/01-have.png)

![包装](https://fnord.se/android/01-want.png)

是否有这样的布局或布局和参数的组合，还是我必须为此实现自己的 ViewGroup？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-02-18T12:59:38.433

我做了我自己想要的布局，但目前它非常有限。当然欢迎提出意见和改进建议。

活动：

```
package se.fnord.xmms2.predicate;

import se.fnord.android.layout.PredicateLayout;
import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;
import android.widget.TextView;

public class Predicate extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        PredicateLayout l = new PredicateLayout(this);
        for (int i = 0; i < 10; i++) {
            TextView t = new TextView(this);
            t.setText("Hello");
            t.setBackgroundColor(Color.RED);
            t.setSingleLine(true);
            l.addView(t, new PredicateLayout.LayoutParams(2, 0));
        }

        setContentView(l);
    }
} 
```

或者在 XML 布局中：

```
<se.fnord.android.layout.PredicateLayout
    android:id="@+id/predicate_layout"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
/> 
```

和布局：

```
package se.fnord.android.layout;

import android.content.Context;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewGroup;

/**
 * ViewGroup that arranges child views in a similar way to text, with them laid
 * out one line at a time and "wrapping" to the next line as needed.
 * 
 * Code licensed under CC-by-SA
 *  
 * @author Henrik Gustafsson
 * @see http://stackoverflow.com/questions/549451/line-breaking-widget-layout-for-android
 * @license http://creativecommons.org/licenses/by-sa/2.5/
 *
 */
public class PredicateLayout extends ViewGroup {

    private int line_height;

    public PredicateLayout(Context context) {
        super(context);
    }

    public PredicateLayout(Context context, AttributeSet attrs){
        super(context, attrs);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        assert(MeasureSpec.getMode(widthMeasureSpec) != MeasureSpec.UNSPECIFIED);

        final int width = MeasureSpec.getSize(widthMeasureSpec);

        // The next line is WRONG!!! Doesn't take into account requested MeasureSpec mode!
        int height = MeasureSpec.getSize(heightMeasureSpec) - getPaddingTop() - getPaddingBottom();
        final int count = getChildCount();
        int line_height = 0;

        int xpos = getPaddingLeft();
        int ypos = getPaddingTop();

        for (int i = 0; i < count; i++) {
            final View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                final LayoutParams lp = (LayoutParams) child.getLayoutParams();
                child.measure(
                        MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST),
                        MeasureSpec.makeMeasureSpec(height, MeasureSpec.UNSPECIFIED));

                final int childw = child.getMeasuredWidth();
                line_height = Math.max(line_height, child.getMeasuredHeight() + lp.height);

                if (xpos + childw > width) {
                    xpos = getPaddingLeft();
                    ypos += line_height;
                }

                xpos += childw + lp.width;
            }
        }
        this.line_height = line_height;

        if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.UNSPECIFIED){
            height = ypos + line_height;

        } else if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST){
            if (ypos + line_height < height){
                height = ypos + line_height;
            }
        }
        setMeasuredDimension(width, height);
    }

    @Override
    protected LayoutParams generateDefaultLayoutParams() {
        return new LayoutParams(1, 1); // default of 1px spacing
    }

    @Override
    protected boolean checkLayoutParams(LayoutParams p) {
        return (p instanceof LayoutParams);
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        final int count = getChildCount();
        final int width = r - l;
        int xpos = getPaddingLeft();
        int ypos = getPaddingTop();

        for (int i = 0; i < count; i++) {
            final View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                final int childw = child.getMeasuredWidth();
                final int childh = child.getMeasuredHeight();
                final LayoutParams lp = (LayoutParams) child.getLayoutParams();
                if (xpos + childw > width) {
                    xpos = getPaddingLeft();
                    ypos += line_height;
                }
                child.layout(xpos, ypos, xpos + childw, ypos + childh);
                xpos += childw + lp.width;
            }
        }
    }
} 
```

结果：

![包装的小部件](https://i.stack.imgur.com/3IR9l.png)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2016-05-23T10:58:54.043

自 2016 年 5 月以来，Google 推出了名为 FlexboxLayout 的新布局，它可以根据您的需要进行高度配置。

FlexboxLayout 目前位于[https://github.com/google/flexbox-layout](https://github.com/google/flexbox-layout)的 Google GitHub 存储库中。

您可以通过将依赖项添加到`build.gradle`文件中来在项目中使用它：

```
dependencies {
    compile 'com.google.android:flexbox:0.3.2'
} 
```

更多关于 FlexboxLayout 使用和所有属性的信息，您可以在存储库自述文件或 Mark Allison 文章中找到：

[https://blog.stylingandroid.com/flexboxlayout-part-1/](https://blog.stylingandroid.com/flexboxlayout-part-1/)

[https://blog.stylingandroid.com/flexboxlayout-part2/](https://blog.stylingandroid.com/flexboxlayout-part2/)

[https://blog.stylingandroid.com/flexboxlayout-part-3/](https://blog.stylingandroid.com/flexboxlayout-part-3/)

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2011-02-08T19:58:53.173

我实现了与此非常相似的东西，但使用我认为更标准的方法来处理间距和填充。请让我知道你们的想法，并随意重复使用而不注明出处：

```
package com.asolutions.widget;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Iterator;
import java.util.List;

import android.content.Context;
import android.content.res.TypedArray;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewGroup;

import com.asolutions.widget.R;

public class RowLayout extends ViewGroup {
    public static final int DEFAULT_HORIZONTAL_SPACING = 5;
    public static final int DEFAULT_VERTICAL_SPACING = 5;
    private final int horizontalSpacing;
    private final int verticalSpacing;
    private List<RowMeasurement> currentRows = Collections.emptyList();

    public RowLayout(Context context, AttributeSet attrs) {
        super(context, attrs);
        TypedArray styledAttributes = context.obtainStyledAttributes(attrs, R.styleable.RowLayout);
        horizontalSpacing = styledAttributes.getDimensionPixelSize(R.styleable.RowLayout_android_horizontalSpacing,
                DEFAULT_HORIZONTAL_SPACING);
        verticalSpacing = styledAttributes.getDimensionPixelSize(R.styleable.RowLayout_android_verticalSpacing,
                DEFAULT_VERTICAL_SPACING);
        styledAttributes.recycle();
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        final int widthMode = MeasureSpec.getMode(widthMeasureSpec);
        final int heightMode = MeasureSpec.getMode(heightMeasureSpec);
        final int maxInternalWidth = MeasureSpec.getSize(widthMeasureSpec) - getHorizontalPadding();
        final int maxInternalHeight = MeasureSpec.getSize(heightMeasureSpec) - getVerticalPadding();
        List<RowMeasurement> rows = new ArrayList<RowMeasurement>();
        RowMeasurement currentRow = new RowMeasurement(maxInternalWidth, widthMode);
        rows.add(currentRow);
        for (View child : getLayoutChildren()) {
            LayoutParams childLayoutParams = child.getLayoutParams();
            int childWidthSpec = createChildMeasureSpec(childLayoutParams.width, maxInternalWidth, widthMode);
            int childHeightSpec = createChildMeasureSpec(childLayoutParams.height, maxInternalHeight, heightMode);
            child.measure(childWidthSpec, childHeightSpec);
            int childWidth = child.getMeasuredWidth();
            int childHeight = child.getMeasuredHeight();
            if (currentRow.wouldExceedMax(childWidth)) {
                currentRow = new RowMeasurement(maxInternalWidth, widthMode);
                rows.add(currentRow);
            }
            currentRow.addChildDimensions(childWidth, childHeight);
        }

        int longestRowWidth = 0;
        int totalRowHeight = 0;
        for (int index = 0; index < rows.size(); index++) {
            RowMeasurement row = rows.get(index);
            totalRowHeight += row.getHeight();
            if (index < rows.size() - 1) {
                totalRowHeight += verticalSpacing;
            }
            longestRowWidth = Math.max(longestRowWidth, row.getWidth());
        }
        setMeasuredDimension(widthMode == MeasureSpec.EXACTLY ? MeasureSpec.getSize(widthMeasureSpec) : longestRowWidth
                + getHorizontalPadding(), heightMode == MeasureSpec.EXACTLY ? MeasureSpec.getSize(heightMeasureSpec)
                : totalRowHeight + getVerticalPadding());
        currentRows = Collections.unmodifiableList(rows);
    }

    private int createChildMeasureSpec(int childLayoutParam, int max, int parentMode) {
        int spec;
        if (childLayoutParam == LayoutParams.FILL_PARENT) {
            spec = MeasureSpec.makeMeasureSpec(max, MeasureSpec.EXACTLY);
        } else if (childLayoutParam == LayoutParams.WRAP_CONTENT) {
            spec = MeasureSpec.makeMeasureSpec(max, parentMode == MeasureSpec.UNSPECIFIED ? MeasureSpec.UNSPECIFIED
                    : MeasureSpec.AT_MOST);
        } else {
            spec = MeasureSpec.makeMeasureSpec(childLayoutParam, MeasureSpec.EXACTLY);
        }
        return spec;
    }

    @Override
    protected void onLayout(boolean changed, int leftPosition, int topPosition, int rightPosition, int bottomPosition) {
        final int widthOffset = getMeasuredWidth() - getPaddingRight();
        int x = getPaddingLeft();
        int y = getPaddingTop();

        Iterator<RowMeasurement> rowIterator = currentRows.iterator();
        RowMeasurement currentRow = rowIterator.next();
        for (View child : getLayoutChildren()) {
            final int childWidth = child.getMeasuredWidth();
            final int childHeight = child.getMeasuredHeight();
            if (x + childWidth > widthOffset) {
                x = getPaddingLeft();
                y += currentRow.height + verticalSpacing;
                if (rowIterator.hasNext()) {
                    currentRow = rowIterator.next();
                }
            }
            child.layout(x, y, x + childWidth, y + childHeight);
            x += childWidth + horizontalSpacing;
        }
    }

    private List<View> getLayoutChildren() {
        List<View> children = new ArrayList<View>();
        for (int index = 0; index < getChildCount(); index++) {
            View child = getChildAt(index);
            if (child.getVisibility() != View.GONE) {
                children.add(child);
            }
        }
        return children;
    }

    protected int getVerticalPadding() {
        return getPaddingTop() + getPaddingBottom();
    }

    protected int getHorizontalPadding() {
        return getPaddingLeft() + getPaddingRight();
    }

    private final class RowMeasurement {
        private final int maxWidth;
        private final int widthMode;
        private int width;
        private int height;

        public RowMeasurement(int maxWidth, int widthMode) {
            this.maxWidth = maxWidth;
            this.widthMode = widthMode;
        }

        public int getHeight() {
            return height;
        }

        public int getWidth() {
            return width;
        }

        public boolean wouldExceedMax(int childWidth) {
            return widthMode == MeasureSpec.UNSPECIFIED ? false : getNewWidth(childWidth) > maxWidth;
        }

        public void addChildDimensions(int childWidth, int childHeight) {
            width = getNewWidth(childWidth);
            height = Math.max(height, childHeight);
        }

        private int getNewWidth(int childWidth) {
            return width == 0 ? childWidth : width + horizontalSpacing + childWidth;
        }
    }
} 
```

这还需要 /res/values/attrs.xml 下的条目，如果它不存在，您可以创建它。

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <declare-styleable name="RowLayout">
        <attr name="android:verticalSpacing" />
        <attr name="android:horizontalSpacing" />
    </declare-styleable>
</resources> 
```

xml 布局中的用法如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<com.asolutions.widget.RowLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:padding="10dp"
    android:horizontalSpacing="10dp"
    android:verticalSpacing="20dp">
    <FrameLayout android:layout_width="30px" android:layout_height="40px" android:background="#F00"/>
    <FrameLayout android:layout_width="60px" android:layout_height="40px" android:background="#F00"/>
    <FrameLayout android:layout_width="70px" android:layout_height="20px" android:background="#F00"/>
    <FrameLayout android:layout_width="20px" android:layout_height="60px" android:background="#F00"/>
    <FrameLayout android:layout_width="10px" android:layout_height="40px" android:background="#F00"/>
    <FrameLayout android:layout_width="40px" android:layout_height="40px" android:background="#F00"/>
    <FrameLayout android:layout_width="40px" android:layout_height="40px" android:background="#F00"/>
    <FrameLayout android:layout_width="40px" android:layout_height="40px" android:background="#F00"/>
</com.asolutions.widget.RowLayout> 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-04-16T09:22:58.460

ApmeM的[android-](https://github.com/ApmeM/android-flowlayout) flowlayout 项目也支持换行符。

![在此处输入图像描述](https://i.stack.imgur.com/NWAAk.jpg)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-06-26T06:38:28.983

这是我简化的纯代码版本：

```
 package com.superliminal.android.util;

    import android.content.Context;
    import android.util.AttributeSet;
    import android.view.View;
    import android.view.ViewGroup;

    /**
     * A view container with layout behavior like that of the Swing FlowLayout.
     * Originally from http://nishantvnair.wordpress.com/2010/09/28/flowlayout-in-android/ itself derived from
     * http://stackoverflow.com/questions/549451/line-breaking-widget-layout-for-android
     *
     * @author Melinda Green
     */
    public class FlowLayout extends ViewGroup {
        private final static int PAD_H = 2, PAD_V = 2; // Space between child views.
        private int mHeight;

        public FlowLayout(Context context) {
            super(context);
        }

        public FlowLayout(Context context, AttributeSet attrs) {
            super(context, attrs);
        }

        @Override
        protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
            assert (MeasureSpec.getMode(widthMeasureSpec) != MeasureSpec.UNSPECIFIED);
            final int width = MeasureSpec.getSize(widthMeasureSpec) - getPaddingLeft() - getPaddingRight();
            int height = MeasureSpec.getSize(heightMeasureSpec) - getPaddingTop() - getPaddingBottom();
            final int count = getChildCount();
            int xpos = getPaddingLeft();
            int ypos = getPaddingTop();
            int childHeightMeasureSpec;
            if(MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST)
                childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(height, MeasureSpec.AT_MOST);
            else
                childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED);
            mHeight = 0;
            for(int i = 0; i < count; i++) {
                final View child = getChildAt(i);
                if(child.getVisibility() != GONE) {
                    child.measure(MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST), childHeightMeasureSpec);
                    final int childw = child.getMeasuredWidth();
                    mHeight = Math.max(mHeight, child.getMeasuredHeight() + PAD_V);
                    if(xpos + childw > width) {
                        xpos = getPaddingLeft();
                        ypos += mHeight;
                    }
                    xpos += childw + PAD_H;
                }
            }
            if(MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.UNSPECIFIED) {
                height = ypos + mHeight;
            } else if(MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
                if(ypos + mHeight < height) {
                    height = ypos + mHeight;
                }
            }
            height += 5; // Fudge to avoid clipping bottom of last row.
            setMeasuredDimension(width, height);
        } // end onMeasure()

        @Override
        protected void onLayout(boolean changed, int l, int t, int r, int b) {
            final int width = r - l;
            int xpos = getPaddingLeft();
            int ypos = getPaddingTop();
            for(int i = 0; i < getChildCount(); i++) {
                final View child = getChildAt(i);
                if(child.getVisibility() != GONE) {
                    final int childw = child.getMeasuredWidth();
                    final int childh = child.getMeasuredHeight();
                    if(xpos + childw > width) {
                        xpos = getPaddingLeft();
                        ypos += mHeight;
                    }
                    child.layout(xpos, ypos, xpos + childw, ypos + childh);
                    xpos += childw + PAD_H;
                }
            }
        } // end onLayout()

    } 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-02-27T23:11:21.917

第一个答案有问题：

```
child.measure(
    MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST),
    MeasureSpec.makeMeasureSpec(height, MeasureSpec.AT_MOST)); 
```

例如，在 ListView 中，列表项的 heightMeasureSpec 为 0（未指定），因此在这里，大小为 0 (AT_MOST) 的 MeasureSpec 被传递给所有子项。这意味着整个 PredicateLayout 是不可见的（高度为 0）。

作为一个快速修复，我改变了孩子的身高 MeasureSpec 像这样：

```
int childHeightMeasureSpec;
if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
    childHeightMeasureSpec =
        MeasureSpec.makeMeasureSpec(height, MeasureSpec.AT_MOST);
}
else {
    childHeightMeasureSpec = 
        MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED);            
} 
```

进而

```
child.measure(MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST), 
    childHeightMeasureSpec); 
```

这似乎对我有用，虽然不处理精确模式，这会更棘手。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-02-19T22:12:36.953

我根据之前发布的此处稍作修改的版本：

*   它适用于 Eclipse 布局编辑器
*   它水平居中所有项目

    ```
    import android.content.Context;
    import android.util.AttributeSet;
    import android.view.View;
    import android.view.ViewGroup;

    public class FlowLayout extends ViewGroup {

    private int line_height;

    public static class LayoutParams extends ViewGroup.LayoutParams {

        public final int horizontal_spacing;
        public final int vertical_spacing;

        /**
         * @param horizontal_spacing Pixels between items, horizontally
         * @param vertical_spacing Pixels between items, vertically
         */
        public LayoutParams(int horizontal_spacing, int vertical_spacing, ViewGroup.LayoutParams viewGroupLayout) {
            super(viewGroupLayout);
            this.horizontal_spacing = horizontal_spacing;
            this.vertical_spacing = vertical_spacing;
        }

        /**
         * @param horizontal_spacing Pixels between items, horizontally
         * @param vertical_spacing Pixels between items, vertically
         */
        public LayoutParams(int horizontal_spacing, int vertical_spacing) {
            super(0, 0);
            this.horizontal_spacing = horizontal_spacing;
            this.vertical_spacing = vertical_spacing;
        }
    }

    public FlowLayout(Context context) {
        super(context);
    }

    public FlowLayout(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        assert (MeasureSpec.getMode(widthMeasureSpec) != MeasureSpec.UNSPECIFIED);

        final int width = MeasureSpec.getSize(widthMeasureSpec) - getPaddingLeft() - getPaddingRight();
        int height = MeasureSpec.getSize(heightMeasureSpec) - getPaddingTop() - getPaddingBottom();
        final int count = getChildCount();
        int line_height = 0;

        int xpos = getPaddingLeft();
        int ypos = getPaddingTop();

        int childHeightMeasureSpec;
        if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
            childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(height, MeasureSpec.AT_MOST);
        } else {
            childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED);
        }

        for (int i = 0; i < count; i++) {
            final View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                final LayoutParams lp = (LayoutParams) child.getLayoutParams();
                child.measure(MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST), childHeightMeasureSpec);
                final int childw = child.getMeasuredWidth();
                line_height = Math.max(line_height, child.getMeasuredHeight() + lp.vertical_spacing);

                if (xpos + childw > width) {
                    xpos = getPaddingLeft();
                    ypos += line_height;
                }

                xpos += childw + lp.horizontal_spacing;
            }
        }
        this.line_height = line_height;

        if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.UNSPECIFIED) {
            height = ypos + line_height;

        } else if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
            if (ypos + line_height < height) {
                height = ypos + line_height;
            }
        }
        setMeasuredDimension(width, height);
    }

    @Override
    protected ViewGroup.LayoutParams generateDefaultLayoutParams() {
        return new LayoutParams(1, 1); // default of 1px spacing
    }

    @Override
    protected android.view.ViewGroup.LayoutParams generateLayoutParams(
            android.view.ViewGroup.LayoutParams p) {
        return new LayoutParams(1, 1, p);
    }

    @Override
    protected boolean checkLayoutParams(ViewGroup.LayoutParams p) {
        if (p instanceof LayoutParams) {
            return true;
        }
        return false;
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        final int count = getChildCount();
        final int width = r - l;
        int xpos = getPaddingLeft();
        int ypos = getPaddingTop();

        int lastHorizontalSpacing = 0;
        int rowStartIdx = 0;

        for (int i = 0; i < count; i++) {
            final View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                final int childw = child.getMeasuredWidth();
                final int childh = child.getMeasuredHeight();
                final LayoutParams lp = (LayoutParams) child.getLayoutParams();
                if (xpos + childw > width) {
                    final int freeSpace = width - xpos + lastHorizontalSpacing;
                    xpos = getPaddingLeft() + freeSpace / 2;

                    for (int j = rowStartIdx; j < i; ++j) {
                        final View drawChild = getChildAt(j);
                        drawChild.layout(xpos, ypos, xpos + drawChild.getMeasuredWidth(), ypos + drawChild.getMeasuredHeight());
                        xpos += drawChild.getMeasuredWidth() + ((LayoutParams)drawChild.getLayoutParams()).horizontal_spacing;
                    }

                    lastHorizontalSpacing = 0;
                    xpos = getPaddingLeft();
                    ypos += line_height;
                    rowStartIdx = i;
                } 

                child.layout(xpos, ypos, xpos + childw, ypos + childh);
                xpos += childw + lp.horizontal_spacing;
                lastHorizontalSpacing = lp.horizontal_spacing;
            }
        }

        if (rowStartIdx < count) {
            final int freeSpace = width - xpos + lastHorizontalSpacing;
            xpos = getPaddingLeft() + freeSpace / 2;

            for (int j = rowStartIdx; j < count; ++j) {
                final View drawChild = getChildAt(j);
                drawChild.layout(xpos, ypos, xpos + drawChild.getMeasuredWidth(), ypos + drawChild.getMeasuredHeight());
                xpos += drawChild.getMeasuredWidth() + ((LayoutParams)drawChild.getLayoutParams()).horizontal_spacing;
            }
        }
    }
    } 
    ```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-08-30T09:09:02.990

我已更新此示例以修复错误，现在，每行可以有不同的高度！

```
import android.content.Context;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewGroup;

/**
 * ViewGroup that arranges child views in a similar way to text, with them laid
 * out one line at a time and "wrapping" to the next line as needed.
 * 
 * Code licensed under CC-by-SA
 *  
 * @author Henrik Gustafsson
 * @see http://stackoverflow.com/questions/549451/line-breaking-widget-layout-for-android
 * @license http://creativecommons.org/licenses/by-sa/2.5/
 *
 * Updated by Aurélien Guillard
 * Each line can have a different height
 * 
 */
public class FlowLayout extends ViewGroup {

    public static class LayoutParams extends ViewGroup.LayoutParams {

        public final int horizontal_spacing;
        public final int vertical_spacing;

        /**
         * @param horizontal_spacing Pixels between items, horizontally
         * @param vertical_spacing Pixels between items, vertically
         */
        public LayoutParams(int horizontal_spacing, int vertical_spacing) {
            super(0, 0);
            this.horizontal_spacing = horizontal_spacing;
            this.vertical_spacing = vertical_spacing;
        }
    }

    public FlowLayout(Context context) {
        super(context);
    }

    public FlowLayout(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        assert (MeasureSpec.getMode(widthMeasureSpec) != MeasureSpec.UNSPECIFIED);

        final int width = MeasureSpec.getSize(widthMeasureSpec) - getPaddingLeft() - getPaddingRight();

        int height = MeasureSpec.getSize(heightMeasureSpec) - getPaddingTop() - getPaddingBottom();
        final int count = getChildCount();
        int line_height = 0;

        int xpos = getPaddingLeft();
        int ypos = getPaddingTop();

        int childHeightMeasureSpec;

        if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
            childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(height, MeasureSpec.AT_MOST);

        } else if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.EXACTLY) {
            childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(height, MeasureSpec.EXACTLY);

        } else {
            childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED);
        }

        for (int i = 0; i < count; i++) {
            final View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                final LayoutParams lp = (LayoutParams) child.getLayoutParams();
                child.measure(MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST), childHeightMeasureSpec);
                final int childw = child.getMeasuredWidth();

                if (xpos + childw > width) {
                    xpos = getPaddingLeft();
                    ypos += line_height;
                }

                xpos += childw + lp.horizontal_spacing;
                line_height = child.getMeasuredHeight() + lp.vertical_spacing;
            }
        }

        if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.UNSPECIFIED) {
            height = ypos + line_height;

        } else if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
            if (ypos + line_height < height) {
                height = ypos + line_height;
            }
        }
        setMeasuredDimension(width, height);
    }

    @Override
    protected ViewGroup.LayoutParams generateDefaultLayoutParams() {
        return new LayoutParams(1, 1); // default of 1px spacing
    }

    @Override
    protected boolean checkLayoutParams(ViewGroup.LayoutParams p) {
        if (p instanceof LayoutParams) {
            return true;
        }
        return false;
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        final int count = getChildCount();
        final int width = r - l;
        int xpos = getPaddingLeft();
        int ypos = getPaddingTop();
        int lineHeight = 0;

        for (int i = 0; i < count; i++) {
            final View child = getChildAt(i);
            if (child.getVisibility() != GONE) {
                final int childw = child.getMeasuredWidth();
                final int childh = child.getMeasuredHeight();
                final LayoutParams lp = (LayoutParams) child.getLayoutParams();

                if (xpos + childw > width) {
                    xpos = getPaddingLeft();
                    ypos += lineHeight;
                }

                lineHeight = child.getMeasuredHeight() + lp.vertical_spacing;

                child.layout(xpos, ypos, xpos + childw, ypos + childh);
                xpos += childw + lp.horizontal_spacing;
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-10-10T23:48:05.413

这里的一些不同答案会在 Exclipse 布局编辑器中给我一个**ClassCastException 。**就我而言，我想使用 ViewGroup.MarginLayoutParams 而不是自己制作。无论哪种方式，请确保在 generateLayoutParams 中返回自定义布局类所需的 LayoutParams 实例。这就是我的样子，只需将 MarginLayoutParams 替换为您的 ViewGroup 需要的那个：

```
@Override
public LayoutParams generateLayoutParams(AttributeSet attrs) {
    return new MarginLayoutParams(getContext(), attrs);
}

@Override
protected boolean checkLayoutParams(ViewGroup.LayoutParams p) {
    return p instanceof MarginLayoutParams;
} 
```

**看起来这个方法被调用来为 ViewGroup 中的每个孩子分配一个 LayoutParams 对象。**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-07-06T14:12:59.680

```
 LinearLayout row = new LinearLayout(this);

    //get the size of the screen
    Display display = getWindowManager().getDefaultDisplay();
    this.screenWidth = display.getWidth();  // deprecated

    for(int i=0; i<this.users.length; i++) {

        row.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT));

        this.tag_button = new Button(this);
        this.tag_button.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, 70));
        //get the size of the button text
        Paint mPaint = new Paint();
        mPaint.setAntiAlias(true);
        mPaint.setTextSize(tag_button.getTextSize());
        mPaint.setTypeface(Typeface.create(Typeface.SERIF, Typeface.NORMAL));
        float size = mPaint.measureText(tag_button.getText().toString(), 0, tag_button.getText().toString().length());
        size = size+28;
        this.totalTextWidth += size;

        if(totalTextWidth < screenWidth) {
            row.addView(tag_button);
        } else {
            this.tags.addView(row);
            row = new LinearLayout(this);
            row.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT));
            row.addView(tag_button);
            this.totalTextWidth = size;
        }
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-06-04T14:27:45.497

我改编了上面的一些 ode 并实现了一个流布局，它将所有子视图（水平和垂直）居中。它符合我的需要。

```
public class CenteredFlowLayout extends ViewGroup {

  private int lineHeight;

  private int centricHeightPadding;

  private final int halfGap;

  public static final List<View> LINE_CHILDREN = new ArrayList<View>();

  public static class LayoutParams extends ViewGroup.LayoutParams {

    public final int horizontalSpacing;

    public final int verticalSpacing;

    public LayoutParams(int horizontalSpacing, int verticalSpacing) {
      super(0, 0);
      this.horizontalSpacing = horizontalSpacing;
      this.verticalSpacing = verticalSpacing;
    }
  }

  public CenteredFlowLayout(Context context) {
    super(context);
    halfGap = getResources().getDimensionPixelSize(R.dimen.half_gap);
  }

  @Override
  protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    final int width = MeasureSpec.getSize(widthMeasureSpec) - getPaddingLeft() - getPaddingRight();
    int height = MeasureSpec.getSize(heightMeasureSpec) - getPaddingTop() - getPaddingBottom();
    final int maxHeight = MeasureSpec.getSize(heightMeasureSpec) - getPaddingTop() - getPaddingBottom();
    final int count = getChildCount();
    int lineHeight = 0;

    int xAxis = getPaddingLeft();
    int yAxis = getPaddingTop();

    int childHeightMeasureSpec;
    if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
      childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(height, MeasureSpec.AT_MOST);
    } else {
      childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED);
    }

    for (int i = 0; i < count; i++) {
      final View child = getChildAt(i);
      if (child.getVisibility() != GONE) {
        final CentricFlowLayout.LayoutParams lp = (LayoutParams) child.getLayoutParams();
        child.measure(MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST), childHeightMeasureSpec);
        final int childMeasuredWidth = child.getMeasuredWidth();
        lineHeight = Math.max(lineHeight, child.getMeasuredHeight() + lp.verticalSpacing);

        if (xAxis + childMeasuredWidth > width) {
          xAxis = getPaddingLeft();
          yAxis += lineHeight;
        } else if (i + 1 == count) {
          yAxis += lineHeight;
        }

        xAxis += childMeasuredWidth + lp.horizontalSpacing;
      }
    }
    this.lineHeight = lineHeight;

    if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.UNSPECIFIED) {
      height = yAxis + lineHeight;
    } else if (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.AT_MOST) {
      if (yAxis + lineHeight < height) {
        height = yAxis + lineHeight;
      }
    }
    if (maxHeight == 0) {
      maxHeight = height + getPaddingTop();
    }
    centricHeightPadding = (maxHeight - height) / 2;
    setMeasuredDimension(width, disableCenterVertical ? height + getPaddingTop() : maxHeight);
  }

  @Override
  protected CentricFlowLayout.LayoutParams generateDefaultLayoutParams() {
    return new CentricFlowLayout.LayoutParams(halfGap, halfGap);
  }

  @Override
  protected boolean checkLayoutParams(ViewGroup.LayoutParams p) {
    if (p instanceof LayoutParams) {
      return true;
    }
    return false;
  }

  @Override
  protected void onLayout(boolean changed, int l, int t, int r, int b) {
    final int count = getChildCount();
    final int width = r - l;
    int yAxis = centricHeightPadding + getPaddingTop() + getPaddingBottom();
    View child;
    int measuredWidth;
    int lineWidth = getPaddingLeft() + getPaddingRight();
    CentricFlowLayout.LayoutParams lp;
    int offset;
    LINE_CHILDREN.clear();
    for (int i = 0; i < count; i++) {
      child = getChildAt(i);
      lp = (LayoutParams) child.getLayoutParams();
      if (GONE != child.getVisibility()) {
        measuredWidth = child.getMeasuredWidth();
        if (lineWidth + measuredWidth + lp.horizontalSpacing > width) {
          offset = (width - lineWidth) / 2;
          layoutHorizontalCentricLine(LINE_CHILDREN, offset, yAxis);
          lineWidth = getPaddingLeft() + getPaddingRight() + measuredWidth + lp.horizontalSpacing;
          yAxis += lineHeight;
          LINE_CHILDREN.clear();
          LINE_CHILDREN.add(child);
        } else {
          lineWidth += measuredWidth + lp.horizontalSpacing;
          LINE_CHILDREN.add(child);
        }
      }
    }
    offset = (width - lineWidth) / 2;
    layoutHorizontalCentricLine(LINE_CHILDREN, offset, yAxis);
  }

  private void layoutHorizontalCentricLine(final List<View> children, final int offset, final int yAxis) {
    int xAxis = getPaddingLeft() + getPaddingRight() + offset;
    for (View child : children) {
      final int measuredWidth = child.getMeasuredWidth();
      final int measuredHeight = child.getMeasuredHeight();
      final CentricFlowLayout.LayoutParams lp = (LayoutParams) child.getLayoutParams();
      child.layout(xAxis, yAxis, xAxis + measuredWidth, yAxis + measuredHeight);
      xAxis += measuredWidth + lp.horizontalSpacing;
    }
  }    
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-11-16T10:55:13.810

尝试 ：

```
 dependencies {
       implementation'com.google.android:flexbox:0.3.2'
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-17T21:33:30.483

尝试将两个**lp**的 LayoutParams 设置为`WRAP_CONTENT`.

将**mlp**设置为`WRAP_CONTENT`，`WRAP_CONTENT`可确保您的 TextView(s) **t**足够宽和足够高以容纳“Hello”或您放入其中的任何字符串。我想**我**可能不知道你的**t**有多宽。`setSingleLine(true)`可能也有贡献。

# ruby - 如何在多维数组中返回字符串的坐标/索引？[红宝石]

> ID：549458
> 
> 赞同：2
> 
> 时间：2009-02-14T18:01:45.117
> 
> 标签：ruby, arrays, string, multidimensional-array, indexing

我有一个多维数组：

```
foo = [["a","b","c"], ["d", "e", "f"], ["g", "h", "i"]] 
```

现在我需要计算“f”的“坐标”，它应该是（1,2）。在不知道哪个“行”“f”在的情况下，我怎么能做到这一点？我一直在尝试使用 index 方法，但这仅在我告诉它在哪里查找时才有效，即

```
foo[1].index("f")  #=>2 
```

我尝试了类似的东西

```
foo[0..2][0..2].index("f") 
```

但这只是返回零。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T18:20:54.900

循环遍历数组的索引并在找到所需内容时返回当前路径。这是一个示例方法：

```
def find2d(array, elem)
  array.each_with_index do |row, row_idx|
    row.each_with_index do |col, col_idx|
      return [row_idx, col_idx] if col == elem
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T18:19:33.360

```
foo.each_with_index do |item, index|
  if item.index('f')
    // the array number that 'f' is in
    puts "Array number: #{index}"
    // the index in that array of the letter 'f'
    puts item.index('f')
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T18:06:22.983

您可能需要遍历数组以找到字母，然后打印出位置。

这更像是一个通用的代码片段，而不是真正的 ruby​​。但是这个概念是存在的。不过不知道有没有更好的办法。

```
for(int i = 0; i < 3; i++ ) {
 for(int x = 0; i < 3; x++ ) {
  if( foo[i][x] == 'f' ) {
   print x, i;
  }
 }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T19:57:55.323

另一种方式，仅供娱乐：

```
y = nil
x = (0...foo.size).find {|xi| y = foo[xi].index("f")} 
```

“y=nil”部分只是在循环之前定义了“y”，所以你可以在之后阅读它......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T18:07:12.467

您可以使用

```
foo.flatten 
```

得到一个展平的数组，然后使用索引

# ios - 如何管理构建 iPhone 应用程序的 Lite vs Paid 版本？

> ID：549462
> 
> 赞同：65
> 
> 时间：2009-02-14T18:03:25.347
> 
> 标签：ios, release

我开始考虑构建我的 iPhone 应用程序的精简版。我在网上找到了一些关于这个过程的东西，即：

[http://developer.apple.com/tools/XCode/XCodeprojects.html](http://developer.apple.com/tools/XCode/XCodeprojects.html)

[http://www.pacificspirit.com/blog/2009/01/27/building_for_multiple_iphone_targets_in_xcode](http://www.pacificspirit.com/blog/2009/01/27/building_for_multiple_iphone_targets_in_xcode)

我特别感兴趣的是简化管理哪些文件包含在我的应用程序的不同版本中的过程，因为我不断修改和增强我的付费版本。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-02-14T18:59:59.173

原始答案来自应用购买前几天。现在正确的答案是发布一个二进制文件并通过[应用程序升级](https://support.apple.com/en-us/HT202023)提供您的付费版本。它的代码略多一些，但它是单次发货，您的转换率可能会更好。

但是，如果您仍然想要应用程序的版本：

Xcode 对多个目标有很好的支持。

从项目菜单中选择“新目标...”。添加另一个 iPhone 可执行文件（Cocoa Touch 应用程序），然后您可以按资源指定目标中包含哪些项目。这可以包括仅将某些代码编译到您的付费版本中。

您可以通过右键单击“组和文件”列表标题（顶部 lhs）并启用目标成员资格来获得有关当前目标中包含和不包含的内容的快速视觉反馈。

您在构建不同目标之间切换的方式与在为模拟器或 iPhone 构建之间切换的方式相同。

要在构建时指定特定类的行为，您可以做两件事 - 包括为各自目标构建的类的两个版本，或者您可以为预处理器设置构建时间标志。在“组和文件”列表中选择目标，然后在该目标上“获取信息”。转到构建选项卡并搜索“预处理”。您应该会看到一个名为“预处理器宏”的项目添加`LITE`到您的轻量级目标中，并以同样的方式添加`PAID`到您的付费目标中。

在您的源文件中，您可以在编译时确定您正在编译使用哪个版本`#ifdef LITE`等。

更进一步，您可以基于 #ifdef LITE 设置全局标志或 AppDelegate 成员变量，并在运行时更改 Lite 和付费应用程序的行为。不过，我不确定我是否看到了其中的价值。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-14T21:30:27.003

作为开发人员，您希望编写尽可能少的代码（更少的错误，更少的时间）。随着构建版本的不同，您将不得不投入更多的工作和单独的测试。

除非您正在制作昂贵的黑客工具，否则您可能会考虑使差异尽可能简单 - 只需隐藏一些偏好或设置。这样，大多数检查和测试将在两个构建中执行相同的工作，很少有代码会有所不同。关键是不要给自己作为开发人员的负担。

有不同构建的原因是为了确保免费版不会被黑客入侵到“付费”版中。试图绕过这种简单限制的人主要是那些会越狱手机的人的子集。无论您做什么，您都不会在任何情况下得到他们的钱，除非他们非常惊叹，他们购买它只是为了表示感谢。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-18T00:09:26.710

“Flower Garden”的创建者在此处详细介绍了创建 lite 版本的不同方法的优缺点：

[http://gamesfromwithin.com/from-full-to-lite-in-under-an-hour](http://gamesfromwithin.com/from-full-to-lite-in-under-an-hour)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-13T22:28:15.860

在 iPhone 3.0 中，您可以改为使用应用内购买，并允许它解锁全部功能，而无需制作多个应用。我也认为这将避免人们免费获得这个，但我对此不太确定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T19:38:44.883

我使用了一个 git 分支。我分支了我的主应用程序并进行了一些调整以禁用一堆内容。现在我主要在 master 分支工作，并在发生重大发展时切换到 lite 并合并到最新版本。效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-03T09:56:29.387

更好的方法是只有一个项目，而不是多个目标——每个版本的应用程序都有一个。那么什么是目标：[多个目标](http://www.raywenderlich.com/68613/create-paid-lite-version-iphone-app)

# wpf - How do I embed one WPF form into another?

> ID：549464
> 
> 赞同：4
> 
> 时间：2009-02-14T18:03:39.030
> 
> 标签：wpf, embedding

I would like to have master WPF form with tab control where each tab contains one independent WPF form. Those forms do not depend on each other, so I thought it will be easier to develop each of them separately and then just embed them into master form.

Number of forms is known, so there is no need for dynamic plugin system.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-14T18:18:38.820

When you use a [Frame](http://msdn.microsoft.com/en-us/library/system.windows.controls.frame.aspx) or [NavigationWindow](http://msdn.microsoft.com/en-us/library/system.windows.navigation.navigationwindow.aspx) you can have it load different xaml [Pages](http://msdn.microsoft.com/en-us/library/system.windows.controls.page.aspx) and even html. You can also make it act like a browser with forward and backward navigation. See [http://msdn.microsoft.com/en-us/library/ms750478.aspx](http://msdn.microsoft.com/en-us/library/ms750478.aspx)

You could put a Frame on each tab and have it load a certain Page.

```
<Window x:Class="PluginApplication.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <DockPanel>
        <Frame Name="frame" NavigationUIVisibility="Visible" Source="SomePage.xaml" />
    </DockPanel>
</Window>

<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    WindowTitle="Page Title"
    WindowWidth="500"
    WindowHeight="200">
  Hello world
</Page> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T10:24:30.923

使子窗体派生自 UserControl，在主窗体中添加一个选项卡控件，其中每个选项卡内都有这些用户控件之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-19T20:27:29.953

我更喜欢用 userControl 首先创建用户控件 [![在此处输入图像描述](https://i.stack.imgur.com/pk6Lq.png)](https://i.stack.imgur.com/pk6Lq.png)

之后，在另一个地方包含这个 userControle 的引用 [![在此处输入图像描述](https://i.stack.imgur.com/J9ztE.png)](https://i.stack.imgur.com/J9ztE.png)

在 frmHome 的任何地方...

```
 <DockPanel>
      <Entity:ucContactList/>
 </DockPanel> 
```

# delphi - 当 AnsiString 转换为 PAnsiString 时会发生什么？

> ID：549469
> 
> 赞同：5
> 
> 时间：2009-02-14T18:07:06.633
> 
> 标签：delphi, string, casting

我有方法（Delphi 2009）：

```
procedure TAnsiStringType.SetData(const Value: TBuffer; IsNull: boolean = False);
begin
  if not IsNull then
    FValue:= PAnsiString(Value)^;
  inherited;
end; 
```

这是基类上的一个抽象方法，其中“Value:Pointer”需要对应数据的指针，如：

```
String = PString
AnsiString = PAnsiString
Integer = PInteger
Boolean = PBoolean 
```

所以我尝试像这样传递值：

```
var
  S: AnsiString;
begin
  S:= 'New AnsiString Buffer';
  SetBuffer(PAnsiString(S));
end; 
```

但是从 AnsiString 到 PAnsiString 的转换不起作用，我知道为什么，但我想知道转换的结果是什么。所以我写了一个简单的测试：

```
var
  Buffer: AnsiString;
  P1: Pointer;
  P2: Pointer;
  P3: Pointer;
  P4: Pointer;
begin
  P1:= PAnsiString(Buffer);
  P2:= Addr(Buffer);
  P3:= @Buffer;
  P4:= Pointer(Buffer);
  P5:= PChar(Buffer[1]);

  WriteLn('P1: ' + IntToStr(Integer(P1)));
  WriteLn('P2: ' + IntToStr(Integer(P2)));
  WriteLn('P3: ' + IntToStr(Integer(P3)));
  WriteLn('P4: ' + IntToStr(Integer(P4)));
  WriteLn('P5: ' + IntToStr(Integer(P5)));
end; 
```

结果是：

```
P1: 5006500
P2: 1242488
P3: 1242488
P4: 5006500
P5: 67 
```

在哪里：

```
- P2 and P3, is the address of Buffer: AnsiString 
- P5 is the Char Ord value of Buffer[1] char, in this case "67 = C"
- How about P1 and P4? 
```

**P1和P4是什么意思？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-14T20:10:06.137

An`AnsiString`被实现为指针。一个`AnsiString`变量只包含一个地址。地址是字符串中第一个字符的地址，或者`nil`如果字符串为空。

A`PAnsiString`是指向`AnsiString` *变量*的指针。它是一个指向字符串第一个字符的指针。当您说 时`PAnsiString(Buffer)`，您是在告诉编译器将指针`Buffer`视为指向 an 的指针，`AnsiString`而不是指向字符数据的指针。地址 5006500 是字符串的第一个字符的位置，`C`.

您在内存中有一条表示字符串的记录：

```
                +-----------+
                | $ffffffff | -1 引用计数（4 个字节）
                +-----------+
缓冲区：| $00000001 | 长度（4 字节）
+---------+ +----------+
| 5006500 | --> | 'C' | 第一个字符（1 个字节）
+---------+ +----------+
                | #0 | 空终止符（1 字节）
                +-----------+

```

`Buffer`保存字节的地址`C`。您将其类型转换为具有 type`PAnsiString`而不是`AnsiString`. 你告诉编译器你有这个布局：

```
                                  +-----------+
                                  | ... |
                                  +-----------+
缓冲区：| ... |
+---------+ +------------+ +------------+
| 5006500 | --> | $00000043 | --> | 垃圾| 第一个字符
+---------+ +------------+ +------------+
                                  | ... |
                                  +-----------+

```

当我在推理指针时，我会像这样绘制图表。如果你没有在你的桌子上放一些纸，你就是在伤害自己。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-14T19:10:30.023

不错的谜题，但我有解决方案：

*   P2 和 P3 是指向缓冲区的指针的地址
*   P1 和 P4 是缓冲区的地址
*   P5 是缓冲区中的第一个元素

我在代码中添加了注释：

```
var
  Buffer: AnsiString;
  P1: Pointer;
  P2: Pointer;
  P3: Pointer;
  P4: Pointer;
  P5: Pointer;
begin
  P1:= PAnsiString(Buffer); 
  (* A cast from AnsiString to PAnsiString has no real meaning 
     because both are a pointer to a block of characters ()
  P2:= Addr(Buffer);
  P3:= @Buffer;
  (* Both Addr and @ give the address of a variable. The variable Buffer is 
     a pointer so we get the address of the pointer, not the value of the 
     pointer. *)
  P4:= Pointer(Buffer);
  (* See the remark on P1\. Due to the cast both give the same result. *)
  P5:= PChar(Buffer[1]);
  (* This looks like a pointer to the first element. But the cast changes 
     it into the character. *)
  WriteLn('P1: ' + IntToStr(Integer(P1)));
  WriteLn('P2: ' + IntToStr(Integer(P2)));
  WriteLn('P3: ' + IntToStr(Integer(P3)));
  WriteLn('P4: ' + IntToStr(Integer(P4)));
  WriteLn('P5: ' + IntToStr(Integer(P5)));
end; 
```

# javascript - 谷歌翻译中断按钮，使javascript函数调用

> ID：549482
> 
> 赞同：2
> 
> 时间：2009-02-14T18:17:08.980
> 
> 标签：javascript, html, button

我的网站可以正常工作，但是当我通过 Google 翻译它时，启动 javascript 函数的按钮不起作用。

但是，通过链接进行的其他一些 Javascript 调用也有效。怎么了？

[示例翻译](http://translate.google.com/translate?prev=_t&hl=en&ie=UTF-8&u=http%3A%2F%2Fwww.videodownloadr.com%2F&sl=en&tl=pl&history_state0=&swap=1)

感谢您的任何帮助。

## 更新

妹子网站更惨，整个左边都变白了？？等待它完全加载。

[示例站点 2](http://translate.google.com/translate?prev=_t&hl=en&ie=UTF-8&u=http%3A%2F%2Fwww.getaudiofromvideo.com%2F&sl=es&tl=en&history_state0=)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T18:32:55.260

我认为这是因为当您使用 Google 翻译时，您实际上是从 Google 的域而不是您自己的域获取页面。然后，您的页面尝试向您的域发出 AJAX 请求，该域现在是跨域的，因此出于安全考虑而被阻止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T18:30:38.607

可能是我会想到的任何数量的事情。

可能是 Google 更改了页面上的 DOM，从而破坏了您的脚本与其交互的方式。页面上是否有任何 JavaScript 错误？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-10T09:36:40.763

# user-interface - Favorite graphical subsystem to program in

> ID：549485
> 
> 赞同：2
> 
> 时间：2009-02-14T18:18:44.517
> 
> 标签：user-interface, graphics

Ok, this is an interesting question to ask because everyone has a say in it.

What is your favorite library to program in for GUI's and the language that you program it in. Give a short reason why. (ex. Gtk, Qt, Windows, etc..) Just an FYI, this includes any scripting language that you program a GUI in Python, Perl etc...

Frankly I've always done Gtk in C, but I'm starting to warm up to Qt in C++ with the new KDE. I've never been a big fan of Windows programming.

ChrisW. stated that I did not give a reason for Gtk/Qt so here goes. I started with Gtk because when I started programming GUI's I was working in Linux and there was more Gtk information available. Started utilizing Qt when I started working more in KDE but really the move to Qt was based on trying to move to C++ and learn more languages. I've never been a fan of basic Windows programming, but I do enjoy a little DirectX now and then :P

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T18:36:22.023

Recently I had the opportunity to work with both wxWindows and QT, while some time ago I wrote some small programs using FLTK and Gtk. My conclusion is that widget libraries tend to be very similar; each one has its strenghts and its quirks.

Instead of advocating a specific library, then, I would like to advocate the use of high level languages in GUI programming: the development cycle is way faster and GUI programs are rarely CPU bound, so the performance hit is rarely a problem.

If a GUI program has to perform some intense computations, just develop a core library in C or C++, but keep the interface in Python or whatever other interpreted language.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T19:00:37.597

People like to bash Swing for being old, slow and ugly, but it's just not true. Swing is *mature*, is faster than ever on Java SE 6/10, looks decent enough, and is tolerable to program. Above all, I've found Java + Swing to be the most trouble-free cross-platform combination. It also works remarkably seamlessly with Jython (Python on JVM).

SWT could also be an option, but so far I've been happy with Swing.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T18:25:43.547

I realise you're focusing on application GUIs but if you want a quick, powerful and fun way to visualize anything on your computer, you can't go past [Processing](http://www.processing.org)

From the site:

> Processing is an open source programming language and environment for people who want to program images, animation, and interactions. It is used by students, artists, designers, researchers, and hobbyists for learning, prototyping, and production. It is created to teach fundamentals of computer programming within a visual context and to serve as a software sketchbook and professional production tool. Processing is an alternative to proprietary software tools in the same domain.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T17:46:34.027

特别是 WPF，以及其所有转世的 XAML（WPF、Silverlight、Moonlight）。

.Net 3.5/Mono 之上的 C#：$0 Visual Studio Express/MonoDevelop：$0 能够告诉设计师“让我的程序更漂亮”并继续编码功能：无价之宝。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T18:28:22.200

I liked writing to video memory under DOS: for an animated game (i.e. an *Asteroids* clone), that was as fast (performant) as I knew how to do it (certainly faster that using the BIOS API).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T18:29:28.700

这确实是一个有点主观的问题，因此没有最佳或正确答案。以下是基于我的（有限的）经验：

我个人喜欢**[wxWidgets](http://www.wxwidgets.org/)**和**[PLT Scheme](http://www.plt-scheme.org/)**来编写简单但灵活的 GUI。还有更高级的工具包，但我通常不需要它们的功能。wxWidgets 是灵活的，Scheme 接口遵循 Scheme 的传统，结构相对简单，功能强大。我喜欢 wxWidgets 是可移植的这一事实，但尽量不实际绘制它自己的小部件，但可以使用它所使用环境的本机或通用工具包。它是用 C++ 编写的，但我从未使用过它的 C++ 接口。

这并不是说在我看来，Scheme 通常是编写应用程序的最佳语言。事实上，有很多类型的应用程序我不会用 Scheme 编写，即使我喜欢这种语言。但是关于 GUI 编程部分，这是我最喜欢的，因为它直截了当，而且像 Scheme 这样的函数式语言与声明式 GUI 编程相得益彰。

当然，使用事件循环（例如使用 Win32API 或 Xt/Intrinsics）时，您不会拥有与让程序参与窗口构建和输入反应的每个阶段时相同的控制级别。但这并不总是方便且通常是不必要的，而且似乎变得越来越普遍。

* * *

*注意：* wxWindows**工具**包已重命名为**wxWidgets**，但我安装的 PLT Scheme 的较新版本仍然随旧 wxWindows 一起提供。我不确定是否有更新的 wxWidgets 包可用，或者它是否将包含在 PLT Scheme 的未来版本中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T17:34:40.420

Qt4 对我来说毫无疑问。现在它拥有 LGPL 许可证，它适用于以前不可能的各种应用程序。此外，它以显着改善语言使用体验的方式改变了 C++。（比如 foreach 和 forever 循环、整数的原子操作和内存管理）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T22:00:38.860

Gtk 是我使用过的主要窗口绘图图形子系统（因此是我最喜欢的 XD）。

然而，就通用图形子系统而言，OpenGL（通常与 GLUT 结合使用）对我来说是一个简单而高效的过程。遗憾的是，我几乎没有 DirectX 经验可以与之相比：S

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T22:11:14.777

对于编写标准 Windows 组件的增强版本，我喜欢 Borland 的 VCL，并且对 .NET 非常满意。

# javascript - Adding event handler to an iframe using JQuery

> ID：549488
> 
> 赞同：9
> 
> 时间：2009-02-14T18:19:55.900
> 
> 标签：javascript, jquery, events, iframe, keydown

I want to assign a keydown event handler to an iframe. Something similar to the pure JS:

```
document.getElementById('iframe_id').contentWindow.addEventListener('keydown',funcName, true); 
```

I tried:

```
$(document.getElementById('iframe_id').contentWindow).keydown( function() {
   // my func
}); 
```

But it does not work.. Please help!

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-15T03:22:28.967

`contentWindow`是`iframe`的`window`对象。你想要`iframe`'s`document`代替：

```
$(document.getElementById('iframe_id').contentWindow.document).keydown(function() {
    // my func
}); 
```

请注意，我不确定 jQuery 如何对来自其他窗口/框架的元素做出反应。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-04-08T19:19:16.773

只是要记住一点：据我所知，如果 iframe 内容是跨域的，这将永远不会起作用。您最终会遇到权限错误： Permission denied for [http://...](http://...) to get property HTMLDocument.nodeType from [http://...](http://...)。浏览器将父子 dom 权限限制在同一个域中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T19:40:53.757

$ 函数取代了对 document.getElementById 的需要

```
$('iframe_id').contentDocument.keydown(function() {
   // logic
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-14T03:30:58.180

这对我有用：

```
$('#iframe_id').contents().keydown(function() {
    // my func
}); 
```

# c# - .NET 在 winform 中打开 PDF，无需外部依赖

> ID：549504
> 
> 赞同：14
> 
> 时间：2009-02-14T18:29:08.657
> 
> 标签：c#, .net

是否有一个免费的库可以让我打开一个 pdf 并在一个 winform 项目上显示它。我知道我可以在 adobe reader 或其他东西中打开它，但它对我来说总是那么臃肿，我会依赖它的安装。是否有一个不错的轻量级替代方案，我可以在我的项目中包含一个 dll 或类似的避免外部依赖项。

我不需要太多功能只是查看，更改页面缩放..

我看过一些图书馆，但它们似乎是关于创建 PDF 而不是查看。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-15T10:41:31.193

我不确定您所说的“依赖项”是什么，因为除非您将整个 PDF 渲染源捆绑在项目中，否则您将始终不得不依赖一些外部代码来渲染 PDF。

有一些商业渲染器和*很少*的免费渲染器。

如果您想避免无法捆绑的依赖项，那么也许您可以查看 SumatraPDF 的源[代码](http://blog.kowalczyk.info/software/sumatrapdf/)[，这是一个使用](http://code.google.com/p/sumatrapdf/)[MuPDF](http://www.mupdf.com/)的 Windows 的 OpenSource PDF 查看器。 还有[Poppler](http://freedesktop.org/wiki/Software/poppler)，一个使用[Xpdf](http://www.foolabs.com/xpdf/home.html)作为渲染引擎的渲染引擎。所有这些都很棒，但它们需要相当多的承诺才能使它们工作并与 .Net 交互。

大多数其他开源库仅用于创建和管理 PDF 页面，我不知道任何实际渲染的库；这是一个很难正确解决的问题。

您可能仍想考虑使用[GhostScript](http://pages.cs.wisc.edu/~ghost/)作为解释器，因为渲染页面是一个相当简单的过程。
缺点是您需要重新打包它以将其与您的应用程序一起安装，或者使其成为先决条件（或至少是安装过程的一部分）。
这不是什么大挑战，而且肯定比将其他渲染引擎融入 .Net 更容易。

看看我今天回答的[这个 SO 问题。](https://stackoverflow.com/questions/541891/pdf-previewing-and-viewing/550475#550475)
它包含更多信息和指向我几个月前在另一个论坛上发布的一些[工作 .Net 代码的链接。](http://community.devexpress.com/forums/p/55582/188207.aspx#188207)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-17T06:27:54.517

首先你需要参考 Adob​​e Reader ActiveX 控件

**Adobe Acrobat 浏览器控件类型库 1.0**

*%programfiles&\Common Files\Adobe\Acrobat\ActiveX\AcroPDF.dll*

然后，您只需将它从工具箱中拖到您的 Windows 窗体中。

并使用一些这样的代码来初始化 ActiveX 控件。

```
private void InitializeAdobe(string filePath)
{
    try
    {
        this.axAcroPDF1.LoadFile(filePath);
        this.axAcroPDF1.src = filePath;
        this.axAcroPDF1.setShowToolbar(false);
        this.axAcroPDF1.setView("FitH");
        this.axAcroPDF1.setLayoutMode("SinglePage");
        this.axAcroPDF1.Show();
    }
    catch (Exception ex)
    {
        throw;
    }
} 
```

确保当您的表单关闭时您处置 ActiveX 控件

```
this.axAcroPDF1.Dispose();
this.axAcroPDF1 = null; 
```

否则 Acrobat 可能会被遗弃。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-15T18:42:44.860

我会考虑将[Foxit Reader](http://www.foxitsoftware.com/pdf/rd_intro.php "福昕阅读器")作为 Adob​​e Reader 的轻量级替代品。它由一个 .exe 文件组成，您可以将其与您的应用程序捆绑在一起，因此不需要任何安装。根据他们的 EULA，这是允许的，只要您的应用程序未安装在移动设备上。您所要做的就是将阅读器作为一个新进程启动，指向相应的 pdf。显然，这种方法的缺点是它不会集成到您的应用程序界面中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-14T20:30:01.517

[使用 acrobat reader 安装的 ActiveX 控件应该可以工作，要么通过设计器将其放入，要么使用类似的](http://www.codeproject.com/KB/dotnet/AxForms.aspx)东西。

这将需要在客户端上安装阅读器的相关版本，但由于您表明您可以启动它，所以这应该不是问题。读者

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-17T09:09:33.830

看看这个。它需要相当多的库（包括 GhostScript），所以它的重量不是很轻。但所有依赖项都包括 PDF 的原生阅读。它在 VB 中——但如果您需要 C#，可以翻译：

[http://www.codeproject.com/Articles/37458/PDF-Viewer-Control-Without-Acrobat-Reader-Installe](http://www.codeproject.com/Articles/37458/PDF-Viewer-Control-Without-Acrobat-Reader-Installe)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T23:01:00.593

有一个免费的[PDF 库](http://www.codeplex.com/pdflib)。它主要是编辑内容，但它可能会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T09:42:55.220

这是一个猜测。

浏览器使用插件在其中呈现 PDF 的方式。我不确定它是否需要安装应用程序。

您可以使用 Foxit 阅读器或 Sumatra PDF。
而且，您可以在您的 winform 上托管浏览器控件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-05T17:24:10.577

在表单上放置一个 webBrowser 控件。strPdfFile = "C:\SomeFile.pdf" webBrowser.Url = new Uri(strPdfFile);

这对我们有用，直到在 Win7-64 位系统上尝试。现在需要做一些调试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-12-05T12:38:32.500

您可以使用 Nuget 的 Spire.PDFViewer。看[这里](https://www.nuget.org/packages/Spire.PDFViewer/)

# php - PHP 框架应该生成 JavaScript 吗？

> ID：549506
> 
> 赞同：3
> 
> 时间：2009-02-14T18:29:50.980
> 
> 标签：php, javascript, frameworks

我注意到一个 PHP 框架；[Zend](http://framework.zend.com/manual/en/zendx.jquery.view.html)、[Cake](http://book.cakephp.org/view/349/Methods)和[Symfony](http://www.symfony-project.org/tutorial/1_2/symfony-ajax)；似乎要么生成 JavaScript，要么允许将其作为字符串嵌入到 PHP 本身中。这是一个好主意吗？从使用过这些框架/库的人那里，您使用 Ajax 和 JavaScript 助手的经验如何？是否易于维护？它是否缩短了开发时间？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-14T18:37:55.937

不，这是个坏主意，

生成的 javascript 通常意味着如果没有它，该站点甚至无法运行（就像许多 asp.net 站点一样）。如果你想做更复杂的事情或想增强可访问性，除了将 HTML 与 CSS 和 Javascript 明确区分开来，别无他法。

分离 Javascript 还可以使您的代码更易于维护，因为您不需要让客户端前端开发人员弄乱您的 PHP 代码，反之亦然。

使用 Javascript 的最佳方法是首先让 php 生成您的 html，然后在该页面的底部包含您的 javascript 文件并使用诸如 onDomReady 之类的功能。这也不会仅仅因为您的框架将其用作其生成的 Javascript 的基础，就强迫您使用特定的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T18:38:41.487

这是一个相当主观的问题，但就个人而言，我不希望后端框架为我做这件事。出于多种原因，最好在业务逻辑、表示和客户端 UI 行为之间保持清晰的分离：

*   更可维护的应用程序。
*   更容易测试单个组件。
*   更轻松的协作。不同的技能组合可以在不同的领域工作。
*   应该有助于确保您的应用程序不依赖于最终用户环境中的 JavaScript。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T00:49:32.813

就个人而言，我喜欢手动编写我的 Javascript，不显眼，这样我只需向 document.domReady 添加一个额外的事件，例如正确的参数。然后那个小触发功能让球滚动。

当天最佳实践：

> 尽可能多地保持前端代码和后端代码的解开

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-10T15:44:58.390

我会说这取决于，就像任何事情一样。拥有“智能”服务器端小部件肯定有一些价值。例如，“知道”如何通过 AJAX 更新自身的小部件，或者可以处理客户端和服务器端验证的表单。后者是一个例子，在客户端中重写无聊的验证代码将是昂贵、耗时且容易出错的。它不需要火箭科学的javascript，所以只要你的框架可以不显眼地处理它，我实际上会*建议*这条路线。此外，还将处理 GUI 内容的框架代码（la ext 或类似的东西）也不是一个坏主意。

但是，比这更复杂的，请使用 Javascript 本身。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T18:35:19.983

我个人喜欢编写自己的 Javascript，所以我真的不希望它为我编写，但我不认为拥有为你做这件事的框架特别“危险”或“有害”，只要它是正确完成。我对它们的最大问题是，只要您想要一个功能的标准行为，它们中的大多数就可以工作，但是一旦您想要一些不同的东西来更好地满足您的项目需求，就需要做很多工作来定制它，您会最好自己做。至少那是我对 CakePHP 的 javascript 自动化的经验。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-14T19:01:03.383

我在 CakePHP 中使用 Javascript 和 Ajax 助手的经验非常积极。

他们允许服务器端开发人员制作原型并构建功能，否则这些功能需要具有真正客户端经验的人才能完成，而无需担心他们*“编写”*的 javascript 代码的质量，让真正的前端工程师自由自在专注于高级客户端功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-10T05:00:49.440

PHP 生成 Javascript 不是一个好主意。我建议导出的唯一 javascript 是简单的 JSON 分配，如下所示：

```
<script type="text/javascript"><!--
  var MyNamespace.info = <?php echo json_encode($info_array) ?>
// --></script> 
```

这是清理 PHP 信息并让客户端上的 javascript 可以访问它的最简单方法。但是，其他任何内容都应该写在实际的 JAVASCRIPT 文件中，这些文件在文档的开头用标签引用。我想说的是服务器端文件中 Javascript 的唯一其他外观，是放置在“onclick”和其他此类属性中的东西。

这样做的理由是 Javascript 应该由了解 Javascript 的前端人员编写和维护，并且该站点应该能够（至少部分地）在没有 javascript 的情况下工作。没有理由生成意大利面条 Javascript 内联。

查看我的 PHP 框架，PHP On Pie ( [http://phponpie.com](http://phponpie.com) )，了解如何正确实现此功能的示例。它将 JS 和 PHP 分开，除了如上所示导出 JSON 时。然而，它还提供了通过 AJAX 在客户端和服务器之间轻松互操作的约定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-14T18:50:44.470

我相信你应该把语言分开。尽管它们可以相互补充。这样，您可以选择所述语言的实现并创建适合您的完美组合。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-01-14T15:14:06.550

我认为生成的 javascript 肯定有一席之地。(1)

生成 javascript 的第一大原因是易于维护。任何依赖项都是从框架（PHP、ruby、scala、python）本身显式编码和配置的。例如，如果您移动资产或更改上传目录，只需更新配置并观察 Just Work。

需要客户端输入验证来减轻服务器的负载吗？(2) 让框架为您直接从您的数据模型中生成正确的验证代码。通过生成的 javascript 填充，您的框架可以从缓存中提供预渲染的静态 HTML 表单。如果您的表单包含大量选择和选项，这可能是一个巨大的胜利。

1) 假设客户已经决定网站可以（或多或少地）依赖于 javascript，并包含所有需要注意的事项。优雅的降级可能是也可能不是可能的或可取的。

2）您也需要服务器端验证，但您知道，对吧？

# c - 指针数组问题

> ID：549507
> 
> 赞同：3
> 
> 时间：2009-02-14T18:30:35.547
> 
> 标签：c, arrays, pointers, initialization

我试过这个指针数组的例子。我收到错误“函数 main 中的非法初始化”

```
int main()
{
    int a[]={1,2,3,4,5};
    int b[]={1,2,3,4,5};
    int c[]={1,2,3,4,5};
    int *p[3]={a,b,c};
    int i;
    clrscr();
    for(i=0;i<3;i++)
        printf("%d - %u\n",*p[i],p[i]);
    getch();
} 
```

如果我在数组声明中使用 static int 而不是 int ，它可以正常工作。谁能告诉我这里的静态效果。非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T18:53:27.490

In gcc you see warnings about this if you use the *-pedantic* flag.

But this is apparently something that has changed in the standard, in C90 it say:

> *All the expressions in an initializer for an object that has static storage duration or in an initializer list for an object that has aggregate or union type shall be constant expressions*

and it was not allowed as the p array is an aggregate type, but in C99 we have:

> *All the expressions in an initializer for an object that has static storage duration shall be constant expressions or string literals.*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-14T18:52:17.803

This compiles fine with gcc and gcc -ansi. gcc -ansi -pedantic however gives the following warning:

```
blackjack.c: In function ‘main’:
blackjack.c:8: warning: initializer element is not computable at load time
blackjack.c:8: warning: initializer element is not computable at load time
blackjack.c:8: warning: initializer element is not computable at load time 
```

Whereas line 8 is:

```
int *p[3]={a,b,c}; 
```

As I see it the problem is that at the time a, b, and c would be stored in p, they don't exist yet. That's because they will be put on the stack and the position on the stack depends on things outside the scope of a function. To clarify this, 'load time' means the time the program is loaded into memory, not the time it is already in execution. (Don't ask me why/how it works anyway)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T19:15:48.293

try: printf("%d - %u\n",*(p[i]),p[i]);

although I have a feeling you're trying to do something more like:

```
int a[]={1,2,3,4,5};
int b[]={1,2,3,4,5};
int c[]={1,2,3,4,5};
int *p[3]={a,b,c};
int i;
clrscr();
for(i=0;i<sizeof(p)/sizeof(int*);i++) {
    for (int j =0; j < sizeof(a)/sizeof(int); j++) {
        printf("%d - %u\n",(p[i])[j],p[i]);
    }
}
getch(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-25T02:40:28.543

规则非常简单。对于静态对象，初始化列表应该是常量。对于将在堆栈上分配空间的元素不存在这样的限制。这看起来也很合乎逻辑，因为静态对象需要写入数据部分，并且编译器必须能够事先解析它们的值。一旦调用了有问题的函数（main），就会在堆栈上分配内存。所以没有问题。我不知道为什么turbo-c上的行为相反。在 gcc 上会发生这种情况:(在使用**gcc -Wall prog.c编译时**

```
 int *p[]={a,b,c} //works fine
        static int *p[]={a,b,c} //oops blunder 
```

# wordpress - 将子域用于外部托管博客的 SEO 后果？

> ID：549511
> 
> 赞同：4
> 
> 时间：2009-02-14T18:31:53.237
> 
> 标签：wordpress, seo, subdomain, blogs, blogger

使用子域在 Wordpress 或 Blogger 上托管博客是否有任何 SEO 劣势？我不想为我的网站创建博客模块而烦恼——我宁愿设置一个 CNAME 条目并将子域指向一个免费的 Wordpress 或 Blogger 帐户。谷歌会通过声称我有“重复内容”来惩罚我这样做 - 即每个博客条目的介绍文本将在我的主站点上，并且完整的详细信息将在 Wordpress/Blogger 上可见？将博客功能合并到我的主站点中会更好吗？使用免费博客主机的这种子域/外部托管方法是否还有其他潜在的缺点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-14T18:58:10.257

自托管博客有很多优势。

1.  您可以使用自己的自托管博客为所欲为。在 Wordpress 上，您可能会被禁止并丢失所有内容。
2.  您可以托管广告或做其他在 Wordpress 上不可能的商业活动。（免费的wordpress博客除了自己的广告外不允许任何广告）。
3.  通过使用您自己的顶级域名在搜索引擎中获得更好的排名机会。
4.  您可以随意修改您的功能。
5.  它看起来更专业，给你吹牛的权利。
6.  在 Wordpress 上，如果您的博客真的很受欢迎，您可能会遇到带宽限制——您将无能为力。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-16T21:11:51.560

Willem Obst 的回答提出了一些很好的观点，但**有两个不正确的严重指控**。我知道这些是不正确的，因为我是 WordPress.com 团队的一员。

Num 1\. 如果存在 ToS 问题，我们会与客户一起解决问题。在极少数情况下，如果博客被暂停，客户仍会在导出内容方面得到帮助。

数字键 6.我们没有带宽限制，也从来没有。

许多公司将免费的 WordPress.com 用于他们的博客。以下是一些示例 [http://wordpress.org/showcase/flavor/wordpresscom/](http://wordpress.org/showcase/flavor/wordpresscom/)

WordPress.com 也是一个博客社区，可让您访问大量受众和社区功能，如全局标签页面。

这是建立博客的好方法，并且没有锁定。这是一些朋友的博客示例，该博客从 WordPress.com 开始，后来为了获得 Willem 所描述的额外灵活性而自行托管： [http://blog.bootuplabs.com/](http://blog.bootuplabs.com/)

最后回到原来的问题。这是一个混合包。

使用子域的反对者将关注谷歌和其他搜索引擎，通常将子域视为具有自己权限的自己的域。

专业子域用户将专注于它是在谷歌和搜索引擎中获得结果的另一个机会。与[“启动实验室”示例](http://www.google.com/search?q=bootup+labs)的情况一样。（不过，谷歌的 Matt Cutts 一年多前曾承诺这种[情况正在改变](http://www.mattcutts.com/blog/subdomains-and-subdirectories/)。）

与 SEO 无关，许多团队出于网络安全原因一起使用子域或单独的域。您可能会注意到[http://blog.flickr.net/](http://blog.flickr.net/)主要位于 flickr.net 而不是 flickr.com 上——我理解——出于这个原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-27T19:08:03.433

一言以蔽之，其实是个好主意。自托管的博客往往有很多集成到它们中，例如 autoping

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-16T21:49:12.657

回答这个问题....不。

你问的问题也有点模棱两可。您是想托管自己的博客（即在您自己的服务器上的子域下运行它），还是想添加一个链接到您的博客的 CNAME 条目。

两者都有好处：

**运行你自己的**- 优点：

*   你可以控制它的方方面面
*   您可以根据自己的编码能力更改设计/布局
*   如果您有一个快速的服务器，您的博客将非常好地提供给观众
*   您可以在自己的博客上做广告 - Google Adwords/Adsense 等...
*   您可以设置流量的高级分析，并查看访问您博客的每个人的每一个小细节
*   您可以将博客的 SEO 调整到第 n 级

**运行自己的**- 缺点：

*   托管博客（尤其是流行的博客）需要非常强大的网络服务器
*   您必须维护博客和博客的安全性，例如。用户和权限
*   专用服务器托管可能很昂贵
*   托管博客使用大量带宽

**使用第三方博客**- 优点：

*   一般免费
*   不会对您的服务器/带宽造成压力
*   安全和权限管理受限制，但由主机管理
*   通常托管的博客具有非常用户友好的 GUI

**使用第三方博客**- 缺点：

*   有时包括有利于主机而不是您的公司/博客的广告
*   自定义/编辑博客设计的能力非常有限
*   对安全性和用户管理的控制有限
*   其他主机可以选择停止提供博客托管服务

关于 SEO 和博客：

如果您使用 CNAME 重定向到另一个主机，您的博客不会受到 GOogle/Yahoo/其他搜索引擎的影响或惩罚。

如果内容没有完全复制，您将不会因重复内容而受到搜索引擎的惩罚，例如，如果您的主域使用子域上托管的博客内容的标题和摘要。

如果您遵守主要的 SEO 原则，那么您的博客就没有理由在子域上受到影响：

*   使用相关的寻址方法，例如。yourblog.yourdomain.com/title-of-blog-article.html
*   使用符合 W3C/正确的 XHTML/HTML/CSS 代码
*   为博客和文章使用适当且相关的元数据（关键字、描述、标题）。
*   相对链接而不是绝对链接

希望这有帮助。如果您有任何其他问题，请随时提出

# vba - 在 Word 中从 VBA 运行 Access QueryDefs

> ID：549514
> 
> 赞同：0
> 
> 时间：2009-02-14T18:33:30.907
> 
> 标签：vba, stored-procedures, ado, ms-word

我在 Access 中创建参数化查询，并希望从 Word 的 VBA 模块中的 ADO 代码中调用它们。但是，我不确定调用参数化查询的语法。似乎无法在网上找到好的代码参考。

如果我有接受 Firstname 和 Lastname 作为参数的 qryGetRecordByFirstLast，如何从 VBA 模块在 ADO 中执行此代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T21:01:10.117

这里有一些注意事项

```
'Set up a command object '
Set cmd = CreateObject ("ADODB.Command")
cmd.CommandType = 4 'adCmdStoredProc '
cmd.CommandText = "qryGetRecordByFirstLast"

'adVarWChar = 202'
'adParamInput=1'
set par=cmd.CreateParameter ("Firstname",202,1,1,strFirstname)
cmd.Parameters.Append par

set par=cmd.CreateParameter ("Lastname",202,1,1,strLastname)
cmd.Parameters.Append par

dbfile="C:\Docs\LTD.mdb")
Set objConn=CreateObject("ADODB.Connection")

cmd.ActiveConnection = objConn

Set rs = CreateObject ("ADODB.Recordset")
rs.Open cmd, , 0, 1 'adOpenForwardOnly, adLockReadOnly'

blnFound = False

If Not rs.EOF Then
    astrRecord = rs.GetRows()
    intRecFirst  = LBound(astrRecord , 2)
    intRecLast   = UBound(astrRecord , 2)

    blnFound = True
End If 
```

# .net - 使用功能区作为选项卡控件

> ID：549518
> 
> 赞同：6
> 
> 时间：2009-02-14T18:35:12.480
> 
> 标签：.net, wpf, user-interface, ribbon

我想创建具有如下外观和行为的功能区界面的应用程序：

*   应用程序有一个带丝带的主要形式
*   功能区有多个选项卡
*   当用户在功能区上切换选项卡时，功能区下方的面板会更改并显示与功能区面板相关的内容。这样，功能区选项卡的作用就好像它是整个窗口的选项卡。

例如，功能区有两个选项卡：人员和任务。当前功能区面板为“人员”时，功能区下方显示人员数据网格。功能区包含用于操作人员数据的命令。当用户切换到功能区上的“任务”选项卡时，应用程序应在功能区下方显示带有任务的表单。

问题是在这种情况下可以使用功能区吗？

我阅读了“OFFICE FLUENT™ 用户界面设计指南”，其中描述了您可以使用 Ribbon 做什么和不能做什么，但我找不到任何相关信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T09:05:11.607

TLDR：我认为它适合您的应用程序概念，但必须明确区分人员和任务功能才能使其正常工作！

尽管 Scott 认为它可能与 Microsoft 打算使用 Ribbon 的目的有所不同，但它认为 Ribbon 也适合这种用途。因为如果您想拥有像 Michael 建议的常规选项卡，您将需要按钮来在窗口或任务之间切换。通过使用功能区，您可以将控制功能/按钮直接链接到任务选项卡，从而更容易了解哪些按钮与哪些任务相关联。用于整个应用程序的按钮可以集成到 Office 按钮（左上角的大 Office 徽标）中，这实际上正是微软所做的。

我们目前也在实现一个类似功能区的工具栏，所以我可能并不完全客观。然而，我倾向于认为 Ribbon 的工作非常简单，并且使用户能够轻松地发现按钮。附带说明：这也可以通过使用大徽标和下拉库来实现，大多数可用的功能区包都实现了这些东西很容易，所以不需要自己编写代码（除非你很容易）！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-08T18:56:02.113

我[在 Codeplex 上找到了 Southridge Hands-on-Lab](http://wpf.codeplex.com/wikipage?title=Southridge%20Lab&referringTitle=Home)。在实验室 3 中，有一个功能区控制示例，其使用方式与我的意图类似。

Southridge 实验室是由 Microsoft 完成的，所以我想我可以像这个例子一样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T18:57:05.547

您的建议与 Microsoft 的指导方针相反。您可能违反了他们的指导方针。

功能区应该与以文档为中心的应用程序一起使用，其中有一个文档并且您在功能区中有用于操作它的命令。功能区上的选项卡仅用于导航功能区......而不是用于导航您的应用程序。

（话虽如此......我知道一些应用程序以你描述的方式使用功能区......而且它似乎工作得很好！）

在实现我们的应用程序以使用功能区时，我遇到了类似的头痛。对于下一个版本，我们将回到上下文相关工具栏 :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T18:24:47.983

如果每个选项卡的命令很少（少于 20 个），那么也许您应该使用带有按钮的传统选项卡控件，这些按钮位于选项卡表的顶部或其他位置。这还可以让您选择在选项卡控件之外拥有适用于整个应用程序的按钮（例如，退出、首选项），这将有助于使用户清楚地了解它们的范围（这是您无法使用功能区执行的操作）。

如果您的用户的工作包括比较“选项卡”之间的信息，那么根本不要使用选项卡，而是使用单独的主窗口（例如，一个用于人员，一个用于任务）。然后，每个人都可以拥有自己独特的传统菜单栏和工具栏，用户可以将窗口并排放在屏幕上以完成工作，而不是使用选项卡控件来回切换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T21:02:41.363

使用 OnTabChange 事件将适当的面板带到前视图：

```
procedure TForm1.Ribbon1TabChange(Sender: TObject; const NewIndex,
  OldIndex: Integer; var AllowChange: Boolean);
begin
  case NewIndex of
    0: Panel0.BringToFront;

    1: Panel1.BringToFront;

    2: Panel2.BringToFront;

    3: Panel3.BringToFront;

  end;
end; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T20:04:30.890

仅供参考，我已经使用了 devexpress 的 xtrabar 套件，并使用 tag 属性实现了这个选项卡控制行为。我为每个功能区页面创建一个面板控件，然后执行以下操作：

## 初始化面板

```
RibPage1.tag = Panel1
RibPage2.tag = Panel2

' Set Display Properties
'Panel1 displays initially

With Panel1
   .Dock = Fill
   .Show()
End With

With Panel2
   .Dock = Fill
   .Hide()
End With

Ribbon.SelectedPage = RibPage1 
```

## 所选页面上的功能区更改

```
P as Panel = ctype(sender.tag, Panel)
p.hide() 
```

## 所选页面上的功能区已更改

```
P as Panel = ctype(sender.tag, Panel)
p.Show() 
```

我是编程新手，所以可能有一些更好的方法可以做到这一点，但这似乎对我有用。可能还取决于功能区供应商。

希望这可以帮助。

乔什

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-23T18:22:40.080

新版本的 wpf 功能区颂歌与以前的版本没有相同的限制。

# http - Any resource/codes on how fiddler works?

> ID：549520
> 
> 赞同：12
> 
> 时间：2009-02-14T18:35:46.643
> 
> 标签：http, redirect, request, fiddler

I need to track http/url requests & redirects from a windows forms application using C#. It should handle both IE & firefox. Not sure if Fiddler is open-source but if i'm not mistaken, it's written using .NET. Sample codes or online articles on how to listen to http/url requests & redirects will be appreciated.

Thanks!

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-14T18:52:52.123

Fiddler works as standard HTTP [proxy](http://en.wikipedia.org/wiki/Proxy_server). There is no magic here. See HTTP protocol for details. In both IE/Firefox, you need to set Fiddler (or your custom program) as proxy, and then browser will use it for all outgoing requests. Proxy is responsible for forwarding request to correct server, and returning response. Proxies are typically used for 1) caching, 2) controlling access (and avoiding firewalls), 3) debugging.

See also [Open Source Proxy Library for .Net](https://stackoverflow.com/questions/311181/open-source-proxy-library-for-net) for [.NET proxy library](http://www.mentalis.org/soft/projects/proxy/) (just quick googling... I have no experience with it).

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-12-04T23:19:15.683

您可能会对新的 FiddlerCore 库感兴趣：http: [//fiddler.wikidot.com/fiddlercore](http://fiddler.wikidot.com/fiddlercore)

# asp.net - ASP.NET WebForms Data Binding Solutions

> ID：549524
> 
> 赞同：2
> 
> 时间：2009-02-14T18:37:02.943
> 
> 标签：asp.net, data-binding, webforms

I am looking for some easy to use data binding to forms controls. Something that will handle formatting, validation and error handling, something that will handle filling controls from business object/DTOs and vice versa with minimal code. I did use google and have found these two links:

*   [Implementing two-way Data Binding for ASP.NET](http://www.developerfusion.com/article/4659/implementing-twoway-data-binding-for-aspnet/)
*   [Using Reflection to Bind Business Objects to ASP.NET Form Controls](http://msdn.microsoft.com/en-us/library/aa478957.aspx)

I am curios if there is something newer and more complete.
Are you using FormView or manualy fill controls and variables or something else?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T22:04:42.480

我一直使用标准的 asp.net DetailsView/FormsView 控件以及 SqlDataSource 或 ObjectDataSource 控件来完成您想要做的事情。这将允许您进行双向数据绑定，并使用模板字段进行少量编码，您可以添加验证和格式化。

查看[http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/formview.aspx](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/formview.aspx)了解更多信息。

# c# - LINQ 连接和 ADO.NET 数据服务

> ID：549532
> 
> 赞同：1
> 
> 时间：2009-02-14T18:42:00.670
> 
> 标签：c#, .net, linq, join, wcf-data-services

我有一个 Windows 服务，它通过 ADO.NET 数据服务公开三个数据源。这些数据源是加载到 XDocument 中然后通过 .AsQueryable() 公开的只读 XML 文件；源包含具有整数 ID 的字段，可以将其视为数据源之间的“外键”。

我的客户使用此数据服务，并且可以使用 LINQ 分别查询三个数据源。有使用数据的数据绑定控件。

在客户端，我想在这三个数据源之间进行 SQL 样式的连接。我最初使用 LINQ 连接来执行此操作，但发现 ADO.NET 数据服务不支持此操作。

我的第二种方法是将数据作为单独的表获取，然后执行连接客户端——尽管这不是最佳的。但是，由于 LINQ 会延迟获取数据并在枚举数据时构造查询，这最终会导致与第一种方法相同的问题。

所以，我现在认为最好的方法是在服务器端加入我的所有数据，并使用提供 IQueryable 接口的新对象公开它。

这真的是最好的方法吗？似乎....不整洁。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T19:12:54.307

您可以使用第二种方法并使用 ToList() 强制提前加载，然后使用 LINQ to Objects 对 2 个列表进行连接。

几乎不是最优的，并且您将失去可组合性，但它应该可以解决延迟加载问题。

# winapi - 如何检测在另一个工作站上运行的相同 Win32 应用程序的另一个实例？

> ID：549534
> 
> 赞同：4
> 
> 时间：2009-02-14T18:43:29.340
> 
> 标签：winapi, copy-protection

我有一个小型应用程序，个人使用免费，但企业使用需要付费许可证。

在公司环境中，我的应用程序很可能会在多个工作站上运行。如果是免费软件版本，我想显示一条不显眼的信息。（并继续）

它不必是防弹的，如果不可能（即防火墙），那么应用程序应该继续。而且我不想让用户设置某种中央服务来跟踪实例。我不想惹恼我的用户（尤其不是付费用户 *g*）

有没有办法实现这种功能？

我记得旧版本的 Dreamweaver 有这种功能。您不能在同一个网络中多次运行它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T18:46:22.607

一种方法：侦听特定端口上的 UDP 广播。让每个实例在此端口上向本地网络发送广播 UDP 数据包。如果应用程序接收到这样的数据包，并识别出它的结构，它就知道其他实例正在运行。

如果使用两个有效的许可证，您可以包含许可证详细信息以避免出现消息。

广播通常不会被路由，所以这只适用于本地网络。（并且用户也可以通过防火墙完全禁用它......但如果您使用一些标准端口，如 53（DNS），它不会被阻止）。

另一种方法是使用自定义服务器，它会了解世界各地所有正在运行的实例；-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T18:46:11.470

有两种主要方法可以实现这一目标：

首先，您可以在每个工作站上设置一个小型服务器应用程序，与网络上的其他工作站通信（我个人会使用 Bonjour 进行发现，但还有其他选项）。这里的缺点是您将编写比选项#2 更多的代码来完成这项工作。

第二个（可能更简单）是使用 WMI 枚举其他工作站上的进程（同样，可能使用类似 Bonjour 的系统进行发现），并找到您的进程在其他机器上运行。这样做的缺点是您的枚举代码将需要所有机器上的权限才能进行搜索。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-14T18:54:26.940

当应用程序启动时，它会在特定端口上发送一个 UDP 广播。这将仅限于本地子网，并且可能无法通过防火墙。这是“还有其他人在跑步，还是我可以开始？” 询问。

如果没有响应，应用程序将正常启动，侦听此 UDP 广播。如果它看到一个，它会响应一个“我已经在运行；你无法启动”数据包。

刚刚启动的应用程序收到此响应数据包，然后拒绝启动或（如果您不想那么严格）向用户显示警告。

您希望在初始请求中包含产品 ID 和许可证密钥（或哈希），以便您可以在同一网络上拥有多个许可证。响应可能需要其中的机器名称，以便第二个用户可以找到第一个用户并询问他们是否真的需要使用该应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T19:15:49.573

邪恶
的公司解决方案：每次启动时让应用程序回家。如果唤醒了多个许可证申请，请告诉它不要这样做。如果没有互联网连接，请不要开始。

# python - 简单独特的非优先队列系统

> ID：549536
> 
> 赞同：1
> 
> 时间：2009-02-14T18:44:53.627
> 
> 标签：python, queue

我正在用python开发一个简单的网络爬虫，我不想做一个简单的队列类，但我不太确定最好的开始方式。我想要只包含要处理的唯一项目的东西，以便爬虫在每次脚本运行时只爬取每个页面一次（只是为了避免无限循环）。任何人都可以给我或指向我可以运行的简单队列示例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T18:48:41.027

我只是使用一套，它不会保持秩序，但它会帮助你保持独特性：

```
>>> q = set([9, 8, 7, 7, 8, 5, 4, 1])
>>> q.pop()
1
>>> q.pop()
4
>>> q.pop()
5
>>> q.add(3)
>>> q.add(3)
>>> q.add(3)
>>> q.add(3)
>>> q
set([3, 7, 8, 9] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T18:57:16.717

一个非常简单的示例是将每个项目的 URL 填充到一个字典中，但作为键，而不是作为值。如果它的 url 不在该字典的键中，则仅处理下一个项目：

```
visited = {}
# grab next url from somewhere
if url not in visited.keys():
  # process url
  visited[url] = 1 # or whatever, the value is unimportant
# repeat with next url 
```

当然，您可以提高效率，但这很简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T19:10:31.583

如果我理解正确，您只想访问每个页面一次。我认为做到这一点的最好方法是保持一个页面队列仍然要访问，以及一组访问过的页面。另一个发布的解决方案的问题是，一旦你从队列中弹出一个页面，你就不再有你是否去过那里的记录。

我会使用集合和列表的组合：

```
visited = set()
to_visit = []

def queue_page(url):
    if url not in visited:
        to_visit.append(url)

def visit(url):
    visited.add(url)
    ... # some processing

    # Add all found links to the queue
    for link in links:
        queue_page(link)

def page_iterator(start_url):
    visit(start_url)
    try:
        yield to_visit.pop(0)
    except IndexError:
        raise StopIteration

for page in page_iterator(start):
    visit(page) 
```

当然，这有点人为的例子，你可能最好以某种方式封装它，但它说明了这个概念。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T18:54:19.140

如果您需要订单（或者甚至是 heapq，如 zacherates 以前在建议使用集合之前建议的那样），为什么不使用列表并且还使用集合来检查重复项？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T21:17:40.890

我将扩展列表类以将唯一测试代码添加到您正在使用的列表的任何方法中。这可以从简单地将 a 添加`.append_unique(item)`到类，或覆盖所有`append`, `insert`, `extend`, `__setitem__`,`__setslice__`等，到在非唯一项目的情况下抛出异常（或保持沉默，如果您愿意）。

例如，如果您只是想确保 append 方法保持唯一性：

```
class UniqueList(list):
    def append(self, item):
        if item not in self:
            list.append(self, item) 
```

# visual-studio - 在 Visual Studio 中剪切/粘贴的最有效方法是什么？

> ID：549544
> 
> 赞同：6
> 
> 时间：2009-02-14T18:49:56.297
> 
> 标签：visual-studio, keyboard-shortcuts

我发现我在编程时会剪切和粘贴很多东西。例如，方法、变量和类名是我经常剪切/粘贴的东西。我确实在输入部分单词后使用“ctrl+space”来自动完成它们，或者在找到重复项时弹出智能感知。

但只是为了直接复制/粘贴，你们有什么好的快捷方式/技巧/提示可以使用吗？

我在编程时已经使用了这些快捷方式，但我想知道我是否遗漏了什么？

*   ctrl+x（没有选择）
*   ctrl+v（没有选择）
*   ctrl+l（没有选择）
*   ctrl+shift+箭头键

如果我可以更快地复制/粘贴，我想我可以更快地编写代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-14T18:58:02.220

在 Visual Studio 中有多重粘贴。
按 Ctrl+Shift+V 可以粘贴您剪切/复制的最后 10 个内容中的任何一个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-14T19:22:52.490

安装和学习[ViEmu](http://www.viemu.com/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T19:24:10.927

我有更多的硬件解决方案。在我的[MS 4000 键盘](https://rads.stackoverflow.com/amzn/click/com/B000A6PPOK)上，空格键正下方的后退和前进按钮分别绑定到复制和粘贴。这实际上使复制和粘贴比我第一次做它时想象的要容易得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T19:37:27.993

我使用[ClipX](http://www.bluemars.org/clipx/)，它为您提供系统范围的多粘贴。您可以在剪贴板中粘贴任何最后 [configurable number] 的内容。您还可以保存“最喜欢”的项目，这些项目将永远保留在列表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T20:07:44.507

Shift + Page Up/Down 选择光标下方/上方的所有内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T20:31:44.700

如果您不使用 ctrl+shift+arrow 来选择整个单词/行，那么这会很有帮助。

# multithreading - Progress bar and multiple threads, decoupling GUI and logic - which design pattern would be the best?

> ID：549545
> 
> 赞同：5
> 
> 时间：2009-02-14T18:50:27.153
> 
> 标签：multithreading, model-view-controller, progress-bar, observer-pattern, decoupling

I'm looking for a design pattern that would fit my application design.

My application processes large amounts of data and produces some graphs. Data processing (fetching from files, CPU intensive calculations) and graph operations (drawing, updating) are done in seperate threads.

Graph can be scrolled - in this case new data portions need to be processed. Because there can be several series on a graph, multiple threads can be spawned (two threads per serie, one for dataset update and one for graph update).

I don't want to create multiple progress bars. Instead, I'd like to have single progress bar that inform about global progress. At the moment I can think of MVC and Observer/Observable, but it's a little bit blurry :) Maybe somebody could point me in a right direction, thanks.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T21:09:28.943

我曾经花了一周的大部分时间试图在一个非常复杂的算法上制作一个平滑、不卡顿的进度条。

该算法有 6 个不同的步骤。每个步骤都具有严重依赖于 A) 正在处理的基础数据的时序特征，不仅是数据的“数量”，还包括数据的“类型”和 B) 随着 CPU 数量的增加，步骤 2 的扩展性非常好， 2 个步骤在 2 个线程中运行，2 个步骤实际上是单线程的。

与核心数量相比，数据混合对每个步骤的执行时间的影响要大得多。

最终破解它的解决方案非常简单。我制作了 6 个函数来分析数据集并尝试预测每个分析步骤的实际运行时间。每个函数中的启发式都分析了正在分析的数据集和 CPU 的数量。根据我自己的 4 核机器的运行时数据，每个函数基本上都返回了*我机器上*预期需要的毫秒数。

f1(..) + f2(..) + f3(..) + f4(..) + f5(..) + f6(..) = 总运行时间，以毫秒为单位

现在有了这些信息，您可以有效地知道每个步骤应该占用的总执行时间的百分比。现在，如果您说 step1 应该占用 40% 的执行时间，那么您基本上需要找出如何从该算法中发出 40 个 1% 的事件。假设 for 循环正在处理 100,000 个项目，您可能会这样做：

```
for (int i = 0; i < numItems; i++){
     if (i % (numItems / percentageOfTotalForThisStep) == 0) emitProgressEvent();
     .. do the actual processing ..
} 
```

这个算法给了我们一个丝般光滑的进度条，表现完美。您的实现技术可以在进度条中提供不同形式的缩放和功能，但考虑问题的基本方式是相同的。

是的，启发式参考编号是在我的机器上计算出来的，这并不重要——唯一真正的问题是，如果你想在另一台机器上运行时更改编号。但是您仍然知道比率（这是这里唯一真正重要的事情），因此您可以看到本地硬件的运行方式与我所拥有的不同。

现在普通的 SO 读者可能想知道为什么有人会花一周的时间制作一个平滑的进度条。该功能是销售主管要求的，我相信他在销售会议上使用它来获得合同。有钱能使鬼推磨 ;）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T21:28:12.313

在这样的线程或异步进程/任务的情况下，我发现在主线程中有一个抽象类型或对象来表示（并且理想地封装）每个进程是很有帮助的。因此，对于每个工作线程，大概在主线程中都会有一个对象（我们称之为它`Operation`）来管理该工作线程，并且显然会有某种类似列表的数据结构来保存这些操作。

在适用的情况下，每个操作都为其工作人员提供启动/停止方法，并且在某些情况下 - 例如您的 - 表示该特定操作任务的进度和预期总时间或工作的数字属性。这些单位不一定需要基于时间，如果您知道您将执行 6,230 次计算，您可以将这些属性视为计算计数。此外，每个任务都需要有某种方式以任何适当的机制（回调、闭包、事件分派或您的编程语言/线程框架提供的任何机制）更新其当前进度的所属操作。

因此，当您的实际工作在单独的线程中执行时，“主”线程中的相应操作对象会不断更新/通知其工作人员的进度。进度条可以相应地更新自身，将操作的“预期”时间总和映射到其总时间，并将操作的“进度”总时间映射到其当前进度，以任何对您的进度条框架有意义的方式。

显然，在实际实现这一点时需要做很多其他的考虑/工作，但我希望这能给你它的要点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T19:04:28.663

Multiple progress bars aren't such a bad idea, mind you. Or maybe a complex progress bar that shows several threads running (like download manager programs sometimes have). As long as the UI is intuitive, your users will appreciate the extra data.

When I try to answer such design questions I first try to look at similar or analogous problems in other application, and how they're solved. So I would suggest you do some research by considering other applications that display complex progress (like the download manager example) and try to adapt an existing solution to your application.

Sorry I can't offer more specific design, this is just general advice. :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T19:09:25.250

Stick with Observer/Observable for this kind of thing. Some object observes the various series processing threads and reports status by updating the summary bar.

# build-process - Hudson 如何删除我的构建创建的工件？

> ID：549575
> 
> 赞同：0
> 
> 时间：2009-02-14T19:03:08.870
> 
> 标签：build-process, automation, build-automation, hudson

我们组织的自定义构建工具会写出大量中间数据，如果 Hudson 能够检测到哪些文件是作为构建的一部分创建的并将这些文件存档，我会很高兴。我不确定它是否已经这样做了，但是如果确实如此，则没有用户可见的解释，当然删除构建并不会删除其输出。

详细来说，这就是我想要的。假设我从一个裸工作区开始。在构建 1 之后，我有这个：

```
ws/
  src/...
  obj/
    1/...
  log/
    1/...
  pkg/
    pkg-1.tgz 
```

现在，我运行构建 2：

```
ws/
  src/...
  obj/
    1/...
    2/...
  log/
    1/..
    2/..
  pkg/
    pkg-1.tgz
    pkg-2.tgz 
```

源代码被检出到`ws/src`每个构建中；有一个自定义结帐过程，所以我不能使用 svn RCS 方法：/。

当我删除构建时，我想删除来自该构建的所有内容。我可以这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-16T17:37:00.137

Hudson 的方法是在构建开始时清理所有临时文件，然后使用 Hudson 的 artifacts 存档工具保存每个构建的输出 - 为“Archive the Artifacts”帖子指定 pkg/**/*.tgz构建步骤，然后 tgz 文件将全部复制到作业特定的存储区域。

工作区只是一个工作区 - 它不适合长期存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T21:59:45.210

如果我站在你的立场上，我会做的是以不同的方式解决问题。我会编写一个任务或脚本，专门删除您不想保留的所有内容，并在每个作业结束时运行该任务或脚本。

Hudson 假设您正在自己清理临时文件。如果这没有发生，我认为 Hudson 没有任何设施可以帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T19:24:48.163

如果不了解您的“自定义签出过程”就很难回答，但通常项目的所有构建工件都是在 src 之外的单个目录下创建的，例如“构建”或“目标”。

这样，项目的“干净”目标可以简单地删除该目录，并且您可以指示 Hudson 为每个构建包含此目标。

看起来您的构建工件包含在与“src”相关的多个目录中：“obj”、“log”和“pkg”。你能引入一个“干净”的目标来明确删除这些目录中的每一个吗？

# web - Planning your WEB UI and Navigation

> ID：549579
> 
> 赞同：1
> 
> 时间：2009-02-14T19:03:51.693
> 
> 标签：web, user-interface, navigation

I know many on SO do not like subjective questions and I tend to be that way as well but am really curious about what others do when planning their websites' UI and navigation.

I have been searching the web for useful flow charting/diagramming tools and did find a few but started thinking maybe other people have a better approach for this.

The question is, when starting a new project, what steps and/or tools do you use to help plan out the web UI and navigation? How do you decide what to include on which page? I know it is an iterative task that you will continue to improve on over the life of the project but how do you get started. I tend to suffer major mental blocks when starting out and am a little unsure how to easily get past the blocks and back to developing.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T19:09:09.620

I browse, browse, browse the internet and make notes of UI that I like and what I like about it. Basically I'll do nothing more than sketch in a notepad, BASIC outlines of the UI. I have yet to find any computer tool (haven't tried a wacom tablet) that is as quick or as versatile as a sketchbook and a pencil.

Once I've sketched something out, I may go from there to html or perhaps even photoshop if I want to play around with coloring.

I've discovered that after reading SO and some other things on the internet, someone once said, "user input is sacred". That being said, I've learned to dislike modal popups and other such *disruptive* design. I really strive to make sure that my flow makes sense. For instance, if you're entering a new database object, does it make sense to drop the user back into the new database object entry screen, or back to the main menu? Sometimes only user testing will flesh that out.

Other than that, I'm not sure I answered your question.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T19:36:40.380

如果您只想规划您的设计，您可能想使用[http://www.balsamiq.com/](http://www.balsamiq.com/)。他们有非常好的基于 Flash 的应用程序来创建 UI 模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-03T17:11:57.353

我从用例场景开始：用户最可能想在这个页面上做什么？一旦我列出了场景，然后我会列出要放在页面上的基本信息块。然后我想更多关于每个块将包含什么。只有在那之后，我才开始在线框编辑器中排列块。

# version-control - Is there a fundamental difference between backups and version control?

> ID：549600
> 
> 赞同：27
> 
> 时间：2009-02-14T19:15:54.020
> 
> 标签：version-control, backup

How does version control differ from plain backups?

Let's forget about the feature decoration, and concentrate on the soul of version control. Is there a clear line that backups must cross before they can be called a VCS? Or are they, at heart, the same thing with different target markets?

If there is a fundamental difference, what is the absolute minimum requirement for something to reach the status of version control?

*When you answer, please don't just list features (such as delta compression, distributed/central repositories, and concurrent access solutions) that most version control systems have or should have, unless they actually are necessary for a VCS by definition.*

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-14T19:22:40.057

The fundamental idea of version control is to manage *multiple revisions* of the same unit of information. The idea of backup is to copy the *latest version* of information to safe place - older versions can be overwritten.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-14T19:19:44.807

The capability to perform branching and merging separates version control systems from plain backups. "Multiple concurrent universes".

See also Eric Sink's excellent [version/source control](http://www.ericsink.com/scm/scm_intro.html) guide.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-14T20:22:50.973

I see several fundamental differences between backups and version control:

1.  Backups only store the latest version, or, even if they store multiple versions, they don't store *every* version. A VCS *does* store every version,
2.  That backup version is often out of date, because backups don't record every change, while VCSs do,
3.  VCSs allow to pursue multiple alternative versions of the same change at the same time (i.e. branching).

However, the single most important difference between backups and VCS is that, in a VCS, changes have *meaning*. In a backup, a new version is made, because some *computer* somewhere decided that it was `x` hours since the last backup; the change itself is completely *meaningless*. In a VCS, a new version is made, because some *human* decided that this version has its own *meaning*, its own identity, different from all the other versions. So, in a backup, all versions are equal (more precisely: they are equally meaningless), whereas in a VCS all versions are special (they have their own unique meanings). In a VCS, changes have an actual *history*, where one event led to another, in a backup there's just a string of unrelated events.

Closely related to this, is the notion of *change metadata*. In a VCS, every change has an *author*, a *timestamp* and, most importantly, a *commit message*. This commit message records *why* the change was made, in other words, it records the "meaning" I wrote about in the previous paragraph.

The *commit history* and especially the *commit messages* are the most important data in a VCS repository, not the actual code itself! This metadata is completely absent in a backup.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-14T19:36:23.283

Version control represents the whole history of changes; backups try to make sure you don't lose it.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-14T19:21:21.527

Here's a few

*   A backup system keeps backups for a given range of time back. Version control typically always keep all the versions ever made.
*   Version control typically concentrates on versioning of text files.
*   In A version control system you typically can get immediate access to any version of any file. A backup system may take some time before having access to what you want to find.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-14T19:21:40.527

There's certainly a grey area between them, however I would define as follows:

**Version control is triggered by a 'write' action, where as backup is generally triggered by a time interval.**

Backup software can be configured to run every second, and not store data if no changes have occurred, but that's not enough for it to be considered version control in my eyes, since it is possible for a file to change twice in a second.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-14T19:25:09.240

**Version control is collaborative, backup is just a snapshot.**

Example: With version control two people can edit the same file concurrently, and the system is smart enough to merge the changes together. With backup, which version of the file would "win?" Backup never "merges" two different backups into one "true" backup.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-14T19:23:26.263

In my opinion, here are some minimum features of a VCS which may not be in a basic backup:

1.  A VCS should store more than one versions (where as a backup might store only the latest last-known-good)

2.  Because of 1., each version should be identified somehow (date, tag, version ID)

3.  A VCS can typically support more than one concurrent user

4.  A VCS for source code will normally have support for branching, merging, adding comments, and viewing deltas

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-07-14T16:55:58.227

The basic difference that stands out to me is that version control allows multiple users to easily work on the same code. Backups do not.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-14T19:20:05.227

I would consider backups a very basic version control system. I would not recommend it for lots of things, but if I have a small script on my home computer, I use dated backups instead of a full featured VCS. This is OK because I am the only one to change the file, so I do not need to worry about conflicts or who made a change.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-14T19:20:11.450

Version control keeps a history of changed, and most version control systems only store the difference between two versions, not everything. Backups store everything, and they have no history unless you do it manually. Backups are inefficient usually. However version control systems are not very efficient with binaries.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-14T19:20:19.377

Version control is basically an automated backup system that allows multiple users to contribute. There are absolutely more features involved with software like CVS, but yeah, it's a backup system under the hood. That doesn't mean you should manually backup instead of use version control, though, they're just in the same niche of computing.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-14T19:24:46.837

Perhaps they are fundamentally the same, until you add the word "good".

*   "good" VCS is very fast.
*   "good" VCS allows multiple sources of changes (multiple users).
*   "good" VCS allows merging.
*   "good" VCS has metadata, like user-provided descriptions

*   "good" backups are distributed geographically

*   "good" backups work automatically.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-14T19:24:54.590

I think you can form arguments for either lumping backups together with VCS, or for treating them as entirely separate. But I think you can't avoid talking about individual features of a VCS, as it's the features that differntiate a VCS from a backup solution:

*   Keeping track of who made what change.
*   Attaching a note to each change to explain the reasons behind the change.
*   (Mostly) concurrent access by several users, possibly from very different locations.

In my eyes, these features are defining. If you ignore them, a VCS is essentially the same as an incremental backup solution.

If you look at a distributed VCS, you might find a stronger notion of keeping track of branches than in a non-distributed VCS. That is, there may not be a single head/trunk branch, but several at any given time. That's something no backup solution I've come across considers.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-14T19:21:58.730

The bare minimum requirement for a backup system to have in order for it to be used for version control is incremental backup and restore for discrete backup items. Additional features (Collaboration, Branching, Diff Comparison) may make it a better VCS system, but insofar as you can control versions as long as you can have reliable access to retrieve and rollback to incrementally different versions of an item you have backed up, you can use it as a "VCS". So, I suppose the fundamental difference between a backup and version control system is what you are using the system to do. Particularly given that you could, if you desired, use your VCS as your backup system.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-14T19:41:12.867

They are totally unrelated things. Think of version control as a kind of "time machine", which you can use to go back and forth in time with your code.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-14T20:23:57.333

At it's basic level there is no difference between version control and backups. A version control system is an incremental backup of every change that is made. A basic, non distributed VCS, like CVS used by one developer will simply create a backup of every change that is made to a text file.

Where version control moves beyond basic backups is in the additional tools that are provided to compare versions, merge changes made by multiple developers, tag versions for release or testing and conduct other operations that make managing these separate versions possible.

# sql - How to do a multiple keyword search?

> ID：549601
> 
> 赞同：2
> 
> 时间：2009-02-14T19:16:39.133
> 
> 标签：sql, loops, while-loop

I have 2 tables to search. Searching photos for keywords, title and description. The keywords have been split off into a separate table. My advanced search will allow searching on all 3 but the basic will just be the keyword table.

Basic table setup:

**PHOTO Table**

*   *PhotoID*
*   *Name*
*   *Title*
*   *Description*

**WORD2PHOTO Table**

*   *WordID*
*   *PhotoID*
*   *Word*

Been trying views and stored procs, and not getting any good results. I get my pics from the views, but in multiple records. I would do filtering and that stuff on the app side, but I'm using subsonic and would like to use the built in paging; that's a whole other issue.

First, How do I search on multiple keywords? Second, how do I add in searching on the title and description?

I have a function (f_Split) that will return a temp table of my current words to search,

```
DECLARE @Words TABLE (Word varchar(20))

INSERT INTO @Words (Word)
SELECT Keyword FROM dbo.f_Split('cars|auto|red|fast','|') 
```

Now how do I use the table it generates to get the photo records? Been struggling for days now? Thanks for any help.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T19:26:19.077

假设您有表格 Photo 和表格 Word，并且使用附加表格 WordToPhoto 建立了多对多关系：

```
DECLARE @Photo TABLE
(ID INT, Name VARCHAR(20), Title VARCHAR(50), Description VARCHAR(200))
INSERT INTO @Photo 
SELECT 1, 'mountain.jpg', 'Mountain trip', 'Mountain trip'
UNION
SELECT 2, 'beach.jpg', 'On the beach', 'On the beach'
UNION
SELECT 3, 'garden.jpg', 'Garden', 'Garden'

DECLARE @Word TABLE(ID INT, Value VARCHAR(20))
INSERT INTO @Word
SELECT 1, 'dog'
UNION
SELECT 2, 'flowers'
UNION
SELECT 3, 'sea'
UNION
SELECT 4, 'moon'
UNION
SELECT 5, 'mountain'
UNION
SELECT 6, 'seashell'
UNION
SELECT 7, 'shell'
UNION
SELECT 8, 'concert'

DECLARE @WordToPhoto TABLE(ID INT, PhotoID INT, WordID INT)
INSERT INTO @WordToPhoto
SELECT 1, 1, 2
UNION
SELECT 2, 1, 4
UNION
SELECT 3, 2, 1
UNION
SELECT 4, 2, 3
UNION
SELECT 5, 2, 6
UNION
SELECT 6, 3, 1
UNION
SELECT 7, 3, 2 
```

并且您对“doggy”和“flower”关键字进行搜索查询：

```
DECLARE @Words TABLE (Word VARCHAR(20))
INSERT INTO @Words
SELECT 'doggy' UNION
SELECT 'flower' 
```

如果您使用多个关键字进行搜索，那么您可能需要一些评级系统。我的建议是总结每张照片的分数。点将使用此算法计算：

```
如果照片关键字与搜索关键字相同，则 1
（狗=狗）
否则，如果照片关键字是带有后缀的搜索关键字，则为 0.75
（狗喜欢小狗）
否则，如果搜索关键字是带有后缀的照片关键字，则为 0.75
（小狗喜欢狗）
否则，如果照片关键字是带有前缀的搜索关键字，则为 0.5
（狗喜欢斗牛犬）
否则，如果搜索关键字是带有前缀的照片关键字，则为 0.5
（热狗喜欢狗）
否则，如果照片关键字是带有前缀和后缀的搜索关键字，则为 0.25
（狗喜欢史努比狗）
否则，如果搜索关键字是带有前缀和后缀的照片关键字，则为 0.25
（过分的喜欢狗）

```

点系数可能是其他的，这只是一个例子。

执行：

```
SELECT R.Rating, P.* FROM @Photo P
INNER JOIN
(
    SELECT PhotoID, SUM(W.Point) AS Rating 
    FROM @WordToPhoto WTP 
    INNER JOIN (
        SELECT W.ID, 
        CASE 
            WHEN (LOWER(WS.Word) = LOWER(W.Value)) THEN 1 
            WHEN (LOWER(WS.Word) LIKE LOWER(W.Value)+'%') 
            OR (LOWER(W.Value) LIKE LOWER(WS.Word)+'%') THEN 0.75 
            WHEN (LOWER(WS.Word) LIKE '%'+LOWER(W.Value)) 
            OR (LOWER(W.Value) LIKE '%'+LOWER(WS.Word))  THEN 0.5
            ELSE 0.25
            END AS Point
        FROM @Word W
        INNER JOIN @Words WS ON LOWER(WS.Word) LIKE '%'+LOWER(W.Value)+'%' 
                OR LOWER(W.Value) LIKE '%'+LOWER(WS.Word)+'%'
    ) AS W ON W.ID = WTP.WordID
    GROUP BY PhotoID
) AS R ON P.ID = R.PhotoID

ORDER BY R.Rating DESC 
```

结果：

```
评级 ID 名称 标题 描述
1.50 3 garden.jpg 花园花园
0.75 1 mountain.jpg 山地之旅 山地之旅
0.75 2 beach.jpg 在沙滩上 在沙滩上

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T19:37:40.457

对于 Postgres 或 MySQL，您可以查看 Sphinx 进行全文搜索，网址为

[http://www.sphinxsearch.com/](http://www.sphinxsearch.com/)

各种 Web 框架都有很好的适配器/插件。例如 ThinkingSphinx 在 Ruby on Rails 中表现出色

[http://github.com/freelancing-god/thinking-sphinx](http://github.com/freelancing-god/thinking-sphinx)

Sphinx 支持对您选择的字段进行全文搜索、增量索引，并且可以很好地扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T20:43:33.637

您需要决定如何连接多个关键字。如果有人在搜索中键入“keyword1 keyword2”，他们是在寻找与同一张照片相关联的两个关键字（AND 操作）还是在寻找与同一张照片相关联的任一关键字（或两者）（OR手术）。两者都提供怎么样？那么“这个关键字而不是那个其他关键字”呢？等等......

我不清楚 WordID 列提供了什么——除了磁盘空间的消耗。如果您有一个以“WordID，Word”作为列的表，并且交叉引用表具有“PhotoID，WordID”列，那么这是一种明智的设计。另一个明智的设计是“PhotoID, Word”。拥有一张带有“WordID、PhotoID、Word”的表格并不是特别明智；它会起作用，但 WordID 列实际上未被使用。您需要对 PhotoID、Word 组合使用唯一约束，以确保您在该表中没有重复。

给定您的 @Words （临时）表，您可以这样做以获得 AND 选项：

```
SELECT P.PhotoID, P.Name, P.Title, P.Description
    FROM Photo P, Word2Photo W
    WHERE P.PhotoID = W.PhotoID
    GROUP BY P.PhotoID, P.Name, P.Title, P.Description
    HAVING COUNT(*) = (SELECT COUNT(*) FROM @Words L, Word2Photo M
                           WHERE M.Word = L.Word
                             AND M.PhotoID = P.PhotoID
                      ) 
```

它确保 Word2Photo 表中的条目数与给定照片的 @Words 表中的条目数相同。它是一个相关的子查询；它不是有效的，但它是有效的。有用的是，该结构可以重复用于 OR 选项：

```
SELECT P.PhotoID, P.Name, P.Title, P.Description
    FROM Photo P, Word2Photo W
    WHERE P.PhotoID = W.PhotoID
    GROUP BY P.PhotoID, P.Name, P.Title, P.Description
    HAVING 1 <= (SELECT COUNT(*) FROM @Words L, Word2Photo M
                    WHERE M.Word = L.Word
                      AND M.PhotoID = P.PhotoID
                ) 
```

这会查找单词列表中至少包含一个单词的照片。

可能还有其他方法可以做到这一点，但对称性很吸引人。显然，如果您进入更复杂的标准（混合 AND 和 OR，或添加 NOT），则结构会发生变化。

### 警告

未经测试的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T19:57:14.470

几年前我在我的网站上做过这个。我所做的就是将 SQL 对应用程序不擅长的所有东西都剔除掉。从记忆中，它是这样的：

```
table photos (
    photoid        number unique indexed,
    name           varchar2,
    title          varchar2,
    description    varchar2,
    keywords       varchar2,
    ... etc
);

table photosearch (
    wordid      number indexed,  -- ID of word, more or less
    photoid     number,          -- ref photos.photoid
    context     number,          -- 9=title, 7=name, 5=desc, ..
    ... etc 
) 
```

当插入/更新照片时，基本算法是：

```
photoid = INSERT INTO PHOTOS VALUES (...)

foreach field in (name title description keywords) 
    int weight = getweight(field)
    foreach word in ( value(field) ) 
        # Discard useless words, e.g. "and, or, but, yes, ..."
        stem = word-stem-algorithm(word)
        key  = hash-to-number(stem)
        INSERT INTO PHOTOSEARCH VALUES 
            (key, photoid, weight) 
```

通用搜索类似于：

```
keys [] = hash(stem(word)) foreach word in query

SELECT photoid, sum(context) FROM photosearch
 WHERE wordid IN keys[]
 GROUP BY photoid
 ORDER BY 2 DESC 
```

使用 context==unique_weight 的技巧让我可以轻松地进行“字段包含单词”搜索（留给读者练习；），并允许我通过改变字段的权重来“调整”结果顺序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T19:28:14.113

你的意思并不完全清楚，但听起来你只是想要：

```
SELECT /* some columns */
FROM @Words #w
INNER JOIN WORD2PHOTO wp ON wp.Word = #w.Word
INNER JOIN PHOTO p NO p.PhotoID = wp.PhotoID 
```

重新标题和描述；好吧，您可以做一些涉及`LIKE`.标题/描述） - 然后变成：

```
SELECT /* some columns */
FROM @Words #w
INNER JOIN WORD2PHOTO wp
   ON wp.Word = #w.Word
   AND wp.Source IN ('K','T','D') -- keywords/title/description
INNER JOIN PHOTO p NO p.PhotoID = wp.PhotoID 
```

并且只包括 K/T/D 的不同组合以适应...

您只需要一个触发器，以便在您插入/更新标题/描述时，它会删除所有现有的 T/D 条目并替换为新条目。

# php - 结合 servlet 和“普通”网络服务器

> ID：549605
> 
> 赞同：1
> 
> 时间：2009-02-14T19:17:49.990
> 
> 标签：php, web-services, apache, tomcat, gwt

我即将将 Web 应用程序从 PHP 迁移到 JAVA (GWT)，但我想逐块迭代地进行。目前我使用 apache 来提供 HTML 和 PHP 文件，但在转换期间我还需要 Jetty 或 Tomcat 来处理 servlet。我猜也是从端口80？我怎么能做这样的混合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T19:26:58.500

首先从 Apache-only 切换到 Tomcat-only。

Tomcat 可以提供静态文件，并且可以通过单独的管道运行 PHP。这样，一切都在一个端口上，并在同一个应用程序空间中提供服务。

然后您可以将零件、页面等零碎地转换为Java。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T19:36:38.083

另一种选择是使用 mod_proxy，您使用 mod_proxy 发送发往您的 servlet 容器的请求。在这种情况下，apache 主机充当 servlet 容器的反向代理，同时提供静态内容和 PHP。

（这基本上与 Jason Cohen 的建议相反）。

选择最适合您的。

# c# - 以_开头的变量名是什么意思？

> ID：549606
> 
> 赞同：57
> 
> 时间：2009-02-14T19:19:21.810
> 
> 标签：c#, asp.net, syntax, variables, naming-conventions

在使用 C# 编写我的第一个 asp.net MVC 应用程序时，我看到有一些变量的名称以下划线字符 (_) 开头。

这是什么意思？这有什么具体含义吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-02-14T19:22:00.480

没有语言定义的含义 - 它只是一些人用来区分实例变量和局部变量的约定。其他变体包括 m_foo（和 s_foo 或 g_foo 或静态变量）或 mFoo；或者，有些人喜欢给局部变量（和参数）加上前缀而不是实例变量。

我个人不使用这样的前缀，但这是一种风格选择。只要从事同一个项目的每个人都保持一致，这通常不是什么大问题。不过，我已经看到了一些*非常*不一致的代码......

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-14T19:21:36.500

通常，这意味着私有成员字段。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-08-11T18:31:49.290

变量名前的下划线`_val`只不过是一种约定。在 C# 中，它在为公共属性定义私有成员变量时使用。

我将补充[@Steven Robbins](https://stackoverflow.com/users/26507/steven-robbins)所说的：

```
private string _val;
public string Values
{
    get { return _val;}
    set {_val = value;}
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-14T19:21:59.840

很多人将它们用于属性私有变量（实际存储公共属性值的变量）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-23T22:03:26.050

使用 ' ' 启动实例属性还有另一个优点*，它首先出现在 Intellisense 上。
创建值/模型/POCO 类时，我不使用“* ”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-23T15:37:44.187

我知道这有点老了，但是如果有人在这里结束，我会在这里添加答案，如果您在.NET 上谈论 MVC，那么在局部视图上也有一个命名约定，它们的名称也以下划线开头.

这是您和您的团队可以决定遵循或不遵循的命名约定，只要你们所有人都知道这个决定。我也将它们用于非公共领域，如私有或受保护只是为了识别它们。

如果您想进一步阅读[，这里有一个简短的介绍。](https://blogs.msdn.microsoft.com/omars/2004/02/05/c-coding-standards-for-private-member-variables/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-02-05T02:09:14.220

对属性私有变量使用下划线非常有用，可以避免意外调用变量而不是类本身的属性的情况。（使用简单的小写智能输入即可轻松完成）

如果您在属性 get{} 中进行某种形式的计算或聚合，那么您最不想做的就是在您打算完整调用该属性时错过这个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-14T23:06:39.817

我已经看到它用作参数的变量名，这些参数没有被用作将它们“隐藏”在函数其余部分之外的一种方式。

我不能说这是一件好事还是坏事，但它有效地表明该参数不会在函数中使用。

# asp.net - ASP.NET RegularExpressionValidator，验证不匹配？

> ID：549628
> 
> 赞同：2
> 
> 时间：2009-02-14T19:24:33.687
> 
> 标签：asp.net, regex

有没有办法使用 RegularExpressionValidator 仅在 ValidationExpression 不匹配时进行验证？特别是使用 PO BOX 正则表达式来验证**不是**PO BOX 的地址。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T19:52:12.527

只需使用 NegativeRegularExpressionValidator :)

```
[ToolboxData("<{0}:NegativeRegularExpressionValidator runat=\"server\" ErrorMessage=\"NegativeRegularExpressionValidator\"></{0}:NegativeRegularExpressionValidator>")]
public class NegativeRegularExpressionValidator : RegularExpressionValidator
{
    protected override bool EvaluateIsValid()
    {
        return base.EvaluateIsValid() == false;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T20:56:25.620

[您可以使用负](http://www.regular-expressions.info/lookaround.html)前瞻有效地反转您的正则表达式。

例如，考虑以下仅匹配数字字符串的正则表达式：

```
^\d+$ 
```

这个表达式可以倒置如下：

```
^(?!\d+$).*$ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T19:28:47.840

创建一个验证不是 PO BOX 的正则表达式或使用自定义验证器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T20:16:14.700

Mike Chaliy 的解决方案非常好，但它没有在客户端验证。

我认为您应该使用[自定义验证器控件](http://aspnet.4guysfromrolla.com/articles/073102-1.aspx)并编写一个验证不是 POBox 的 javascript 函数。从正则表达式验证器复制模式并使用[此站点](http://www.regular-expressions.info/javascriptexample.html)编写您自己的客户端验证。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-14T22:03:27.417

客户端脚本的另一种解决方案：

```
<asp:TextBox runat="server" ID="MYiD" />

<asp:CustomValidator runat="server" ControlToValidate="MyId" ErrorMessage="Wrong"
    ClientValidationFunction="ClientValidate" />

<asp:Button runat="server" OnClick="OnClick" />

<script language="javascript"> 
function ClientValidate(source, arguments)
{
    var value = arguments.Value;
    var res = value.match('abc');       
    arguments.IsValid = (res == null || res === undefined);
}
</script> 
```

# php - 使用 PHP 生成 PDF 格式的考勤列表

> ID：549635
> 
> 赞同：2
> 
> 时间：2009-02-14T19:26:07.817
> 
> 标签：php, pdf

我想使用 PHP 从学生的 PDF 数据库中创建出勤列表。我希望将列 student.name、student_id、student_rollno 和用于签名的列作为 pdf 表制作。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-14T19:39:04.137

好吧，这是一个有点笼统的问题，但我至少会使用 PDF 部分并提供以下 PHP 类：[http ://www.tcpdf.org](http://www.tcpdf.org)

此类无需在您的服务器上启用 pdf 扩展即可工作，这是一个巨大的好处。但除此之外，它还支持简单的 HTML，包括“table”标签。如果您了解 HTML，则可以根据该知识生成简单的 PDF。

从数据库中检索数据后，实际上只需组装一个 HTML 字符串即可：

```
$html = '<table>';
foreach ($results as $student) {
     $html .= '<tr><td>'.$student->name.'</td></tr>';
}
$html .= '</table>';

$tcpdf->writeHtml($html); 
```

...ETC。

可以在此处找到 writeHtml 方法的完整示例： [http ://www.tecnick.com/pagefiles/tcpdf/example_006.phps](http://www.tecnick.com/pagefiles/tcpdf/example_006.phps)

如何检索数据在很大程度上取决于您的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T19:38:25.137

我推荐TCPDF。 [http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=tcpdf](http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=tcpdf)

它是一个将 html 转换为 pdf 的库，因此您可以在 php 中运行 db 查询并以 html 输出结果。您可以使用 tcpdf 函数引用生成 html 的 php 文件。

请参阅此处的示例： [http ://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=tcpdf_examples](http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=tcpdf_examples)

///////////////////

您还可以使用 DOMPDF： [http](http://www.digitaljunkies.ca/dompdf/) ://www.digitaljunkies.ca/dompdf/ 它比 tcpdf 更新一些，并且更易于使用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-16T09:56:31.463

上次我用 PHP 构建 PDF 输出模块时，我使用了 LaTeX。漂亮的输出和易于重新定义的样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T23:36:39.573

去 FPDF，[http](http://www.fpdf.org/) ://www.fpdf.org/ - 那里最好的东西......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T19:37:30.300

您可以使用 php 的[pdflib](http://in.php.net/pdf)扩展来执行此操作。

请查看[本教程](http://www.sitepoint.com/article/generate-pdfs-php/)以获取更多详细信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T19:41:27.407

您可以在 PHP 中使用 PDF 库

您将需要使用这些功能

```
string PDF_fit_table  ( resource $pdfdoc  , int $table  , float $llx  , float $lly  , float $urx  , float $ury  , string $optlist  )

int PDF_add_table_cell  ( resource $pdfdoc  , int $table  , int $column  , int $row  , string $text  , string $optlist  ) 
```

你也可以试试[FPDF](http://www.fpdf.org/)，看看这个[教程](http://www.fpdf.org/en/tutorial/index.php)。基本上，您需要以表格的形式输出您的数据库结果。

其他替代品： [TCPDF](http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=tcpdf)，[EZPDF](http://www.ros.co.nz/pdf/)

# javascript - 如何在 Firefox 中动态更改快捷键？

> ID：549650
> 
> 赞同：1
> 
> 时间：2009-02-14T19:33:12.637
> 
> 标签：javascript, firefox, xul

我有一个可以通过快捷键激活的 Firefox 扩展。我希望用户能够动态更改组合键。

我的 XUL 看起来像这样

```
<keyset id="ksMain">
    <key id="keyDoMyThing" modifiers="control,shift" key="e" command="cmdDoMyThing"/>
</keyset> 
```

cmdDoMyThing 是对命令集中元素的引用。当我按 ctrl+shift+e 时，命令会触发。

我尝试使用 JavaScript 修改现有元素和创建新元素，但是虽然我可以让旧组合键*停止*工作，但我无法让新组合键发生。这是我正在使用的代码示例

```
keyelem = document.createElement('key');
keyelem.setAttribute('id', 'keyDoMyThing');
keyelem.setAttribute('command', 'cmdDoMyThing');
keyelem.setAttribute('key', key);
keyelem.setAttribute('modifiers', modstr);
keyset.appendChild(keyelem); 
```

我可以使用调试器来验证 modstr 是否设置为正确的字符串，并且 key 是否设置为我要使用的密钥。

我怎样才能以我想要的方式实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T15:09:43.100

结果我还需要删除密钥集并创建一个全新的密钥集。

```
ksparent = keyset.parentNode
ksparent.removeChild(keyset);

keyset = document.createElement('keyset');
keyset.id = 'my-keyset';

keyelem = document.createElement('key');
keyelem.setAttribute('id', 'keyDoMyThing');
keyelem.setAttribute('command', 'cmdDoMyThing');
keyelem.setAttribute('key', key);
keyelem.setAttribute('modifiers', modstr);

keyset.appendChild(keyelem);
ksparent.appendChild(keyset); 
```

完成此操作后，新的组合键将生效。

# c# - 需要关于线程代码的反馈

> ID：549652
> 
> 赞同：0
> 
> 时间：2009-02-14T19:35:52.410
> 
> 标签：c#, multithreading

这是有人想在生产应用程序中使用的一些代码（不是我，老实说） - 我想要一些独立的反馈。

```
 public class JobProcessor<TJob> : IJobProcessor<TJob> where TJob : class
 {
  private readonly IJobQueue<TJob> theJobQueue =
   new NullQueue<TJob>();

  private Thread processorThread;

  private bool shutdownRequested;

  private readonly IJobObserver<TJob> theObserver = new NullObserver<TJob>();

  public AutoResetEvent threadStartedEvent = new AutoResetEvent(false);

  private int processorThreadId = 0;

  private volatile TJob currentJob = null;

  public JobProcessor(IJobQueue<TJob> jobQueue, IJobObserver<TJob> observer)
  {
   if (observer != null)
   {
    theObserver = observer;
   }
   shutdownRequested = false;
   theJobQueue = jobQueue;
   CreateAndRunThread();
  }

  private void CreateAndRunThread()
  {
   processorThread = new Thread(Run)
                      {
                       Name = "Tpk Processor Thread", IsBackground = true
                      };
   processorThread.SetApartmentState(ApartmentState.STA);
   processorThread.Priority = ThreadPriority.BelowNormal;
   processorThread.Start();
  }

  public void Shutdown()
  {
   threadStartedEvent.WaitOne();

   shutdownRequested = true;

   theJobQueue.Interrupt(processorThreadId);
  }

  public TJob CurrentJob()
  {
   return currentJob;
  }

  private void Run()
  {
   processorThreadId = Thread.CurrentThread.ManagedThreadId;

   threadStartedEvent.Set();

   while (!BufferClearedAndShutDown())
   {
    try
    {
     ProcessNextMessage();
    }
    catch (ThreadAbortException)
    {
     CreateAndRunThread();
     break;
    }
    catch (Exception e)
    {  }
   }
  }

  private void ProcessNextMessage()
  {
   currentJob = theJobQueue.RetrieveJob();
   if (currentJob != null)
   {
    theObserver.ProcessMessage(this, currentJob);
   }
   currentJob = null;
  }

  private bool BufferClearedAndShutDown()
  {
   return theJobQueue.IsEmpty && shutdownRequested;
  }
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T19:46:51.200

您是否线程试图捕获 ThreadAbortException 然后重新创建自己？我不确定这是否可能，但无论如何这不是使用操作系统的好方法。

如果在 currentJob = theJobQueue.RetrieveJob(); 之后发生异常，您将失去工作。但在 Observer.ProcessMessage(this, currentJob);

除非您的 jobQueue 是线程安全的，否则您应该在访问它时添加锁定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T20:24:10.890

这只是一个生产者/消费者队列吗？有很多预先发布的示例 - 几天前我自己在这里发布了一个（但我现在找不到它）......这样说 - 我发布的版本*要*简单得多 - 即“显然没有错误”而不是“没有明显的错误”。我看看能不能找到。。。

（编辑：[找到它](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)）

重点是; 使用该版本，工作线程只是：

```
T item;
while(queue.TryDequeue(out item)) {
    // process item
}
// queue has been closed and drained 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T20:17:44.183

在不了解 IJobQueue、IJobObserver 或 IJobProcessor 的语义的情况下很难为您提供有用的反馈，但这里有一些突出的细节：

1.  processorThread 似乎并不真正需要它；可以/应该只是 CreateAndRunThread 中的本地人
2.  shutdownRequested应该标记为volatile，设置shutdownReqeusted为true后调用Thread.MemoryBarrier()，或者使用Thread.VolatileWrite设置shutdownRequested字段
3.  为什么在要求它关闭之前等待线程启动？
4.  不知道为什么需要threadStartedEvent，它是干什么用的？尤其是公开有点吓人
5.  不知道 IJobQueue.Interrupt 是如何实现的，很难说是否存在问题
6.  谁使用 CurrentJob，为什么？感觉有风险
7.  虽然捕获您自己的 ThreadAbortException 会捕获大多数情况，但它不会捕获所有情况。您可以使用一个单独的监视器线程，它调用 Thread.Join，并在仔细检查 BufferClearedAndShutdown() 后调用 CreateAndRunThread()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T00:01:31.447

代码中缺少很多上下文，但我只是想将我的 2 便士加到上面，我同意。

在 Randy 的第 2 项中，我将只使用锁定语句而不是内存屏障，这是 MSDN 推荐的方法，除非您在您的盒子上使用多个 Itanium CPU（内存排序较弱）

[http://msdn.microsoft.com/en-us/library/system.threading.thread.memorybarrier.aspx](http://msdn.microsoft.com/en-us/library/system.threading.thread.memorybarrier.aspx)

我完全同意第 6 项。将 ref 暴露给作业队列中的项目的公共方法？那不是很好吗？，尤其是当您讨论线程安全时，如果您需要此类暴露给外界的一些信息，请将其设为不可变并改为公开它。更好的封装。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T18:31:20.317

Now that some people have already answered I feel it is safe to add my own comments without biasing anyone :-)

1.  Why would you want to wait for the thread to start before shutting it down?
2.  Recording the thread ID and using it as a way to identify which thread can shut it down?
3.  currentJob is marked volatile but not shutdownRequested (and it's not set within a lock)
4.  Why mix a queue + a worker in one? Why not have a queue separate, and then one or more threads working with it.
5.  I can't think why he'd be expecting a ThreadAbortException so as to ditch the current worker thread and create a new one.
6.  Despite the comment at the top of the code about how the class could simply be extended to utilise multiple worker threads I don't think that this design makes moving to multiple worker threads very easy at all (unlike an approach where the queue / workers are separate).

I'm no multi-thread guru or anything so I wanted to post it just to make sure it wasn't just me that thought this code looked a bit dodgy.

# math - 矩阵市场到 CRS 转换（稀疏矩阵）

> ID：549655
> 
> 赞同：3
> 
> 时间：2009-02-14T19:35:57.917
> 
> 标签：math, linear-algebra, sparse-matrix

在处理稀疏矩阵时，如何将[Matrix Market 格式](http://math.nist.gov/MatrixMarket/formats.html#mtx)转换为 CRS（压缩行存储）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T19:41:52.770

你看过[BeBOP 稀疏矩阵转换器](http://bebop.cs.berkeley.edu/smc/)的源代码吗？它是从您引用的页面链接的。

# c - Win32：将最小化和隐藏的窗口返回到顶部

> ID：549659
> 
> 赞同：3
> 
> 时间：2009-02-14T19:37:12.627
> 
> 标签：c, windows, winapi, system-tray

通过在 wndproc 中执行此操作，我无法在将窗口“最小化”到托盘后恢复窗口：

```
case WM_SIZE:
  if (wparam==SIZE_MINIMIZED) {
    ShowWindow(hwnd,SW_HIDE);
  }
  break; 
```

托盘消息处理程序如下所示：

```
case TRAY_ICON_MESSAGE:
  switch(lparam) {
  case WM_LBUTTONDOWN:
    ShowWindow(hwnd, SW_RESTORE);
    BringWindowToTop(hwnd);
    SetFocus(hwnd);
    break;
  // ... 
```

该窗口确实会重新出现，但始终隐藏在其他窗口下方并且不会出现在顶部。SetFocus() 和 BringWindowToTop() 似乎都没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T19:51:04.823

你能看看函数是否返回任何错误吗？

你也可以看看[SetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms633539(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T20:00:40.213

```
if (::IsIconic(hwnd))  
    ShowWindow(hwnd, SW_RESTORE);  

::SetForegroundWindow(hwnd);  
::BringWindowToTop(hwnd); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-15T06:55:18.380

永远不要使用 SetForeground。

请参阅 Msdn 备注。

# asp.net - 使用麦克风是 Asp.Net 应用程序

> ID：549665
> 
> 赞同：0
> 
> 时间：2009-02-14T19:38:50.533
> 
> 标签：asp.net, silverlight, client-side, microphone

由于 SilverLight 本身不支持使用麦克风，因此我可以使用一种解决方法来获取用户在麦克风中所说的内容的实时流。

我需要访问服务器类 (c#) 将使用的音频流（来自用户客户端麦克风）。

我希望使用 Flash 或 Java 小程序，但似乎很难以我的 Asp.Net 应用程序可以使用的方式输出音频流......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-14T19:52:01.047

这需要在客户端（例如 Flash 或 Java）上安装可以从客户端操作系统访问声音驱动程序/API 的软件。

对于 Flash，这需要使用[Flash Media Server](http://www.adobe.com/products/flashmediaserver/)。研究从 Flash 播放器向 FMS 发送音频流。

# iphone - 是否可以在 Cocoa Touch 中观察对象的只读属性？

> ID：549672
> 
> 赞同：19
> 
> 时间：2009-02-14T19:46:39.000
> 
> 标签：iphone, cocoa-touch, properties, key-value-observing

我试图观察 UINavigationController 的（只读）visibileViewController 属性，但没有成功。我能够成功地观察到我自己定义的用于在另一个类上进行测试的读写属性。

是否可以观察只读属性？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-14T21:08:41.377

是的，可以观察只读属性。但是，如果声明该属性的对象以不**[符合](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueObserving/Concepts/KVOCompliance.html#//apple_ref/doc/uid/20002178)****Key-Value Observing**`willChangeValueForKey:`的方式更改该属性的值（例如，在没有 seding和通知的情况下直接更改支持该属性的实例变量的值`didChangeValueForKey:`），那么观察者将不会KVO 系统会自动通知。如果您可以验证此属性的值正在更改并且没有通知您的观察者，我会（1）在此处或其他地方发布一些代码，以便其他人可以帮助您找到您的错误，以及（2）如果没有错误您的代码，在 Apple 的[雷达](http://bugreport.apple.com)上提交错误。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-11T21:24:00.927

是的。在您自己的类中实现它的一种简单方法是在 .h 文件中将该属性声明为只读，并在 .m 文件的私有接口中将其重新声明为可写。这样您就可以合成并自动处理更改通知。

在 .h 文件中：

```
@interface MyClass : NSObject
@property (nonatomic, readonly) BOOL foo;
@end 
```

在 .m 文件中

```
@interface MyClass ()
@property (nonatomic, readwrite) BOOL foo;
@end

@implementation MyClass

@synthesize foo;

- (void)bar {
    // Observers will see the change
    self.foo = YES;
}

@end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T07:24:43.717

您当然可以观察只读属性，但请注意，为了使 KVO 工作，您需要符合 KVC - 这意味着对属性使用 setter/getter（因为您是只读的，所以您不会免费获得 setter via `@synthesize`) 或属性的`-setValue:forKey:`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-10T15:00:42.417

一个稍微不同的答案：

```
@interface MyClass : NSObject
@property (nonatomic, readonly) BOOL foo;
@end 
```

在 .m 文件中

```
@interface MyClass ()
@property (nonatomic, readwrite) BOOL foo;
@end

@implementation MyClass

+ (NSSet *)keyPathsForValuesAffectingFoo {
    return [[NSSet alloc] initWithObjects:NSStringFromSelector(@selector(foo)), nil];
}

@end 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-14T21:00:25.860

[使用NSKeyValueObserving](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSKeyValueObserving_Protocol/)这绝对是可能的。属性实际上具有 getter/setter 实现，它们只是由编译器通过 Objective-C 类实现中的 @synthesize 关键字为您完成的。由于键值观察协议基​​于 Objective-C 中的标准 getter/setter 约定，因此观察属性可以正常工作。文档（上面链接）甚至按名称提到了类属性：

> **“NSKeyValueObserving (KVO) 非正式协议定义了一种机制，允许在其他对象的指定属性**发生更改时通知对象。”

# python - 如何跳过循环中的迭代？

> ID：549674
> 
> 赞同：209
> 
> 时间：2009-02-14T19:48:04.270
> 
> 标签：python

我有一个循环，但有可能在循环内引发异常。这当然会一起停止我的程序。为了防止我捕获异常并处理它们。但是即使发生异常，其余的迭代也会运行。在我的子句中是否有一个关键字可以`except:`跳过当前迭代的其余部分？

* * *

## 回答 #1

> 赞同：463
> 
> 时间：2009-02-14T19:50:46.353

您正在寻找[`continue`](https://docs.python.org/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops).

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-02-14T19:52:29.423

```
for i in iterator:
    try:
        # Do something.
        pass
    except:
        # Continue to next iteration.
        continue 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2018-04-04T08:31:52.390

**继续示例：**

```
number = 0

for number in range(10):
   number = number + 1

   if number == 5:
      continue    # continue here

   print('Number is ' + str(number))

print('Out of loop') 
```

**输出：**

```
Number is 1
Number is 2
Number is 3
Number is 4
Number is 6 # Note: 5 is skipped!!
Number is 7
Number is 8
Number is 9
Number is 10
Out of loop 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-02-14T19:50:18.023

像这样的东西？

```
for i in xrange( someBigNumber ):
    try:
        doSomethingThatMightFail()
    except SomeException, e:
        continue
    doSomethingWhenNothingFailed() 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-02-14T19:51:02.373

我想你正在寻找[继续](http://www.network-theory.co.uk/docs/pytut/breakandcontinueStatements.html)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-02-16T19:31:13.447

对于这个特定的用例 using`try..except..else`是最干净的解决方案，`else`如果没有引发异常，则将执行该子句。

注意：`else`子句必须跟在所有`except`子句之后

```
for i in iterator:
    try:
        # Do something.
    except:
        # Handle exception
    else:
        # Continue doing something 
```

# django - Django unittest assertRaise 用于自定义错误

> ID：549677
> 
> 赞同：5
> 
> 时间：2009-02-14T19:50:07.930
> 
> 标签：django, unit-testing

我已经定义了一个自定义错误，但是如果我测试是否引发了自定义错误，它就会失败。

我的模型.py：

```
class CustomError(Exception):
    """
    This exception is my custom error
    """

class Company(models.Model):
    name = models.CharField(max_length=200)

    def test_error(self):
    raise CustomError('hello') 
```

在我的tests.py中：

```
import unittest
from myapp.models import Company,Customer,Employee,Location,Product,ProductCategory,AllreadyPayedError,CustomError

class CompanyTestCase(unittest.TestCase):
    def setUp(self):
        self.company = Company.objects.create(name="lizto")

    def test2(self):
        self.assertRaises(CustomError, self.company.test_error) 
```

测试失败，输出如下：

```
======================================================================
ERROR: test2 (myapp.api.tests.CompanyTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/......./tests.py", line 27, in test2
    self.assertRaises(CustomError, self.company.test_error)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/
python2.5/unittest.py", line 320, in failUnlessRaises
    callableObj(*args, **kwargs)
  File "    /Users/....../models.py", line 17, in test_error
    raise CustomError('hello')
CustomError: hello

----------------------------------------------------------------------
Ran 18 tests in 1.122s 
```

任何人都知道我应该做些什么来测试是否`CustomError`被提升

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T22:08:53.230

您可以捕获错误并断言它发生了。

例如：（未经测试）

```
def test2(self)
    error_occured = False
    try:
        self.company.test_error()
    except CustomError:
        error_occured = True

    self.assertTrue(error_ocurred) 
```

似乎远非理想，但会解除对您的阻止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T15:49:39.097

感谢安迪的回答，但问题是我使用了错误/不同类型的导入：在我的 INSTALLED_APPS 设置中，我有 myproj.myapp

我改变后：

```
from myapp.models import Company,CustomError 
```

到：

```
from myproj.myapp.models import Company,CustomError 
```

它按预期工作

# html - 为什么我应该使用“li”而不是“div”？

> ID：549689
> 
> 赞同：122
> 
> 时间：2009-02-14T19:53:50.590
> 
> 标签：html, html-lists

我不确定为什么在列出项目时我需要使用 ul-li 而不是简单地使用 div。我可以使两者看起来完全相同，那么创建无序列表与排列 div 的功能优势在哪里？

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2009-02-14T19:55:34.843

为了语义正确。HTML 具有表达事物列表的能力，它可以帮助 Google 机器人、屏幕阅读器和各种不只关心网站呈现的用户更好地理解您的内容。

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2009-02-14T20:41:23.080

> 我不确定为什么在列出项目时我需要使用 ul-li 而不是简单地使用 div。我可以让两者**看起来**完全一样

你的问题中有一个关键词：“看”。您是否也可以让盲人使用盲文阅读器*输入相同的内容？*你能用文本到语音合成器让盲人*听起来一样吗？*您*仍然*可以使用自定义客户端 CSS 用户样式表让视障人士看起来相同吗？

“看”这个词是一个非常危险的词——当你在 HTML 中使用它时，所有的警报都应该在你的脑海中响起。HTML 是一种用于描述超媒体文档的语义结构的语言。语义结构没有“外观”，它*是*一个抽象概念。

即使您不关心所有这些语义上的骗局，也不关心盲人，请考虑一下：Google、Yahoo、MSN 和 Co. 没有眼睛，他们不会“看”您渲染的 CSS .

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-14T19:55:14.440

通过使用语义正确的标记，您可以在文本中嵌入额外的信息。通过使用 ul/li，您正在向消费应用程序传达信息是一个列表，而不仅仅是“某物”（谁知道是什么），它是任意元素内的一些文本。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-06-10T15:12:38.037

直接回答您的问题：功能优势是**div**本身意义不大，而**ul lis**明确表示“这是一个无序/无序的项目列表”。

术语“语义”是指您使用现有结构的固有含义来创建明确含义的方式。HTML 由标签组成，这些标签本身就意味着某些事情。并且有既定的规则/指南/方法来使用它们，以便您发布的 HTML 文档传达您想要的意思。

如果您在文档中列出某些内容，则添加有序列表 (UL) 或无序列表 (OL)。另一方面，页面划分 (DIV) 元素用于创建特定且单独的内容。

**div**元素“划分” 。当你查看一个页面时，有一些特定的部分，比如内容主体、页脚、页眉、导航、菜单、表单等。你可以使用**div**标签来创建这些分区。通常，页面部分与视觉布局相对应，因此使用显式页面划分 (DIV) 来切割 CSS 中的布局是很自然的选择。这样**div**标签就变成了结构化的。

如果您误用或过度使用**div**标签，它可能会产生意想不到的含义和代码膨胀。

混淆问题：谷歌使用**h3**和**div**来“划分”他们列出的搜索结果。**ul > li > h3 + div**

因此，当您关闭所有样式（Firefox 中带有 WebDeveloper 工具栏的 Shift+Cmd/Crtl+S）时，**div**应该会消失，并自然堆叠。您的裸 HTML 仍然应该呈现一个具有清晰层次结构的漂亮页面：从上到下，最重要的内容在前，列表中包含项目符号和编号。最好在顶部附近添加一个链接（对于非视觉用户），让您可以跳至：主要内容、重要表单或主要标题（如目录）。

最后，请记住您正在构建文档。没有所有的视觉效果，它仍然应该是一份有说服力的文件。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-03-04T22:38:54.593

有很多关于使用`<li>`或使用的讨论，`<div>`但没有一条评论给出了这些标签内部内容的可靠示例。我的感觉是，`<ul>`并不是`<li>`那么重要，因为我不能告诉你我上次在网站、报纸或杂志上阅读“清单”是什么时候——在线或印刷。

`<div>`用途广泛得多。如果您要列出蛋糕的成分，是的，那是一个清单。如果您要列出远足旅行要打包的东西，是的，那是一个清单。

但是，例如，用户表单会列出一些随机的东西，这些东西不是真正的列表，也不是一系列段落，也不是所有“标题”。有些东西是日期，有些是复选框，有些是文本。分吧，如果你问我。如果它被标记为盲人会被误导，`<ul>`并且`<li>`当它只是一个大杂烩，而不是真正的列表时，他们听到“这是...的列表”。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-14T19:58:43.650

您应该为要放入的内容使用适当的标签。这不仅意味着 ul/li 更适合列表。这也意味着您必须考虑列表的内容并查看它是无序/有序列表还是定义列表。

另一个论点是当你禁用 css 时。浏览器将呈现其默认样式，如果使用其他浏览设备，则更易于查看。它还增强了可访问性。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-14T20:06:00.763

如果您改用 div，lynx 将无法以可读的方式呈现页面。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-14T20:08:39.633

我个人喜欢 li 的语义。查看源代码时，您会立即看到如果它们被 li 包裹，则您有一个列表。div 集合不提供语义含义，通常列表的唯一语义由 CSS 类（如“listItem”）引入。这显然表明应该首先使用 li 的事实。

如果你的表示逻辑中有一个循环，我总是喜欢 li 而不是 div。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-14T20:38:38.610

<li> 表示列表中的一个项目，它让解析器（浏览器、搜索引擎、蜘蛛）知道您正在列出项目。您可以使用 DIV 而不是 LI，但那些解析器永远不会知道这些项目正在被列出，并且 DIV 并没有真正描述任何东西，除了它是一个块。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-04-09T17:02:38.830

这取决于项目。我最近做了一个使用列表设计菜单的项目。他们想要添加一堆效果，比如滑动/淡入淡出，还想要让它在多个关卡中可折叠。

在这种情况下，DIV 更合适。我能够为子 div 创建容器并应用 jQuery 来实现所需的效果。

即使您的项目还没有这些要求，考虑将来如何更改它可能是谨慎的......

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-14T21:01:27.900

使用`<li>`（在适当的情况下）减少了`<div>`您在网页中经常看到的标签汤，这对开发人员有很大帮助。

这并不是`<div>`坏事，但每当标签被过度使用（`<div>`通常是这样）时，它会稀释标签的语义含义到完全无用的程度。我最近从我们聘请的一名承包商那里了解到这一点，该承包商帮助我们处理 Web 应用程序的 CSS/UI，它对 HTML 代码的可读性/可维护性的影响对我来说非常明显。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-14T21:07:09.837

如果您所关心的只是以最小的努力使列表看起来以某种方式显示，那么这已经是不费吹灰之力了：`<li>`比输入的字符少一个，`<div>` *并且*它的结束标记在 HTML 中是可选的。

这是除其他人所说的语义之外的内容。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-14T22:43:01.480

用于在原始浏览器或移动设备上正确呈现

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-02-01T17:45:25.563

我想在这里加两分钱已经回答了您的问题。我正在做一个项目，我正在做后端逻辑，我的数据被聚合到我的设计师制作的页面模板中。他使用 ul 和 li 标签来表示页面上的各种列表，其中一些是小部件。数据来自一个 cms，用户可以通过 html 标签输入富文本。当用户开始在他们的内容中创建列表时，列表不再看起来像项目符号列表，而是搞砸了整个页面。

经验教训：如果您的内容本身可以包含 html，请不要使用带有通用 css 选择器的列表标签。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-14T20:04:16.650

关于 ul li 的另一件事是；您可以使用 ul 作为容器来帮助您设置 Style 类

```
<ul class="myHebe">
  <li><a href="#">.net</a></li>
  <li><a href="#">.net</a></li>
</ul> 
```

当我使用 ul 时，我喜欢这种模式

```
.myHebe{} // container
.myHebe li {} // items
.myHebe li a {} // subitems 
```

当然，这取决于我们想如何使用它以及我们如何喜欢它。这是我喜欢的方式

希望有帮助 谢谢

# javascript - JS文件未执行

> ID：549693
> 
> 赞同：1
> 
> 时间：2009-02-14T19:56:21.660
> 
> 标签：javascript

```
<script type="test/javascript" src="/js/something.js"></script> 
```

那里没有什么不合适的，对吧？那么是怎么回事，在 Firefox、Chrome、Steel、Android 浏览器和 IE 6 中，页面加载并且没有在 schedulegrid.js 中执行任何内容？即使它只是一个 alert() 调用：什么都没有。Firebug 显示脚本的正确内容，所以我知道它正在加载它。什么可能导致所有浏览器都包含一个 js 脚本，但它们都不执行，但与实际内容无关？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-14T19:59:17.923

它应该是“文本/javascript”而不是“测试/javascript”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T20:01:06.470

我可以很容易地看到这是一个放错位置或未闭合的开放式支架。也许如果您在文件顶部创建一个新函数，如下所示并对其进行测试：

```
function onload() {
    alert("testing");
} 
```

# mono - 在 Windows 上内置于 Mono 的可执行文件

> ID：549701
> 
> 赞同：3
> 
> 时间：2009-02-14T20:01:57.340
> 
> 标签：mono, compatibility

我知道 Windows 中构建的二进制文件不需要为带有 Mono 的 linux 机器重新编译。它是否可以反过来工作？在 linux 机器上使用 Mono 构建的二进制文件是否可以在仅使用 .NET Framework 的 Windows 上运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T20:12:08.987

是 - 文件格式可在 Mono 和 .NET 之间移植。当然，这是排除实现中的错误，这不是不可能的。

该文件格式甚至*记录*在[ECMA-335](http://www.ecma-international.org/publications/standards/Ecma-335.htm)分区 2 第 25 节中。

显然，您需要您的应用程序引用的任何程序集。我相信即使 P/Invoke*也*可以移植，如果你有相同的本机库名称来公开相同的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T20:10:00.643

不要忘记 .NET 二进制文件（exe 或 dll）包含与平台无关的 IL 代码。

因此，在 Linux 上使用 Mono 构建的二进制文件可以在 Windows 上运行，只要它包含标准的可移植可执行 (PE) 头信息。二进制文件中的所有其他代码都是独立于平台的 IL。

如果想以实际的方式看到这一点，请尝试在 Linux 机器上安装[MonoDevelop ，然后构建一个简单的测试项目。](http://monodevelop.com/Main_Page)

构建项目后，找到 Debug 目录。它包含可以直接复制到windows并运行的exe文件。

# linux - 小项目最喜欢的服务器操作系统和源代码控制系统

> ID：549702
> 
> 赞同：2
> 
> 时间：2009-02-14T20:03:35.997
> 
> 标签：linux, version-control, operating-system

我正在与另一个开发人员一起开始一个小项目，需要设置一个专用系统来容纳我们的版本控制和项目可能具有的任何其他短期需求。对服务器的要求是：

*   免费/开源操作系统。
*   必须提供源代码控制。
*   必须一直运行。

就是这样。所以我知道周围有大约一千个基于 Linux 的服务器发行版可以实现这一点，但要从任何为小型项目管理自己的服务器的人那里寻找成功案例。您认为哪个最简单、最灵活、最强大等？

附带问题：最喜欢的源代码控制系统，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T20:37:00.580

听起来这是一个类似初创公司的场景，而不是在现有组织内。有什么理由不使用托管解决方案吗？如果您不需要，您应该专注于您的核心能力，而不是管理额外的服务器。[XP-dev.com](http://xp-dev.com/)提供免费和私人的 1.5GB 颠覆托管。[Github](http://github.com/)为私有存储库提供合理的 12 美元/月计划。

假设您以 25 美元/小时的价格低估值您的时间。如果您每月花费超过 1/2 小时来管理您的服务器或遇到阻碍您工作效率的不稳定问题，那么购买 github 帐户会更有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T20:06:17.767

具有颠覆性的 Ubuntu 服务器。Ubuntu 是 *nix 更稳定的版本之一，并且能够更好地执行 apt-get 并保持应用程序处于最新状态。Subversion 最适合做钩子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T20:23:22.343

Debian + 吉特

非常稳定，并且对两者都有很多支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T20:09:21.363

Ubuntu + Mercurial。

我将 Mercurial+ssh 用于私有存储库，将 bitbucket 用于公共存储库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T00:09:40.477

我有一个使用[GIT](http://git-scm.com/)进行版本控制的专用 Ubuntu 服务器。[使用gitosis](http://swik.net/gitosis)
管理私有存储库。这很棒。

> 管理 git 存储库，通过 SSH 提供对它们的访问，具有严格的访问控制并且不需要 shell 帐户。
> 
> gitosis 旨在使托管 git repos 更容易和更安全。它在一个用户帐户下管理多个存储库，使用 SSH 密钥来识别用户。最终用户不需要服务器上的 shell 帐户，他们将与一个不允许他们运行任意命令的共享帐户交谈。

它坚固、快速且可靠。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T20:13:33.770

我的单人项目服务器（只有我自己）正在运行 OpenSuSE 10.x。它托管了许多颠覆源存储库。

操作系统和存储库偏好很大程度上取决于个人偏好。我使用 OpenSuSE 和 Subversion，它们为我工作。我使用过许多 Linux 发行版，可以追溯到 Slackware 版本零点八，信不信由你，我喜欢其中的很多。我使用过许多存储库，包括 CVS、visual sourcesafe、clearcase 和 subversion。CVS 是坚如磐石并且smokin'fast。Subversion 很好，但不如 CVS 可靠或快，但对我的目的来说已经足够了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-14T20:15:18.387

好吧，我个人为此目的使用 Fedora。原因是它是 Red Hat 的一个分支，所以如果我切换到 Red Hat 上的开发（一种常见的服务器选择），使用 Fedora 的经验应该会对我有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-14T20:38:24.570

我认为您会发现[Cent OS](http://www.centos.org/)非常适合您的目的。它需要 RHEL（专注于稳定性）并删除品牌以使其免费，再次使用 OSS。

我不认为您真的要求提供版本控制建议，但我也会讨论这个问题。

*   [Git](http://git-scm.com/)现在非常流行，特别是因为它是 Linus 的宝贝。我认为这对您的需求来说太过分了。
*   试试[Subversion](http://subversion.tigris.org/)，因为它是另一个流行的开源选择。有许多与 Subversion 集成的开源[持续集成](http://cruisecontrol.sourceforge.net/)和[缺陷跟踪](http://trac.edgewall.org/)系统。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-14T20:46:57.170

Debian + 子版本

# linq-to-sql - 持久对象和 linq-to-sql 有什么区别？

> ID：549717
> 
> 赞同：2
> 
> 时间：2009-02-14T20:14:32.380
> 
> 标签：linq-to-sql, persistence

我的经理作为工作一直在谈论持久性对象。我更熟悉 linq-to-sql。它们之间有什么区别以及持久对象的示例是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T21:13:24.533

据我所知，您的老板将持久对象称为 POCO 样式类（从您的实体中抽象出数据库功能）。在最严格的定义中，我会说 LINQ to SQL 对象是持久对象，但它们不是 POCO 类。您不能参加这些课程并与他们一起切换到不同的后端平台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T20:15:38.243

我经常使用 DevExpress XPO 持久对象。对我来说最大的不同是我不必拥有现有的数据库，甚至不需要知道目标数据库平台是什么，而我正在创建我的类。

DevExpress 在他们的网站上有很多细节。寻找 XPO（[eXpress 持久对象](http://www.devexpress.com/Products/NET/ORM/)）。

# resharper - 奇怪的 ReSharper 问题与不起作用的操作列表

> ID：549728
> 
> 赞同：5
> 
> 时间：2009-02-14T20:22:02.940
> 
> 标签：resharper, actionlist

所以前几天我们在工作中停电了，从那时起，[ReSharper](http://en.wikipedia.org/wiki/ReSharper)和 Visual Studio 就不能正常运行了。当我尝试单击其中一个灯泡操作列表时，会出现此问题，它们只是消失了。我还注意到，当我编译并出现错误时，错误列表就像它试图打开一样，但它没有。我已卸载并重新安装 ReSharper 并在 Visual Studio 上运行修复。我怎样才能解决这个问题？

你可以在这里看到我的意思的一个例子： [http ://rapidshare.com/files/197237456/resharper.avi](http://rapidshare.com/files/197237456/resharper.avi)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-23T13:11:13.550

我遇到了同样的问题，包括安装了 Visual Studio 数据库版本，并通过重置 Visual Studio 设置解决了这个问题。

从 Visual Studio 命令提示符（例如，菜单*Start* -> *Programs* -> *Microsoft Visual Studio 2008* -> *Visual Studio Tools* -> *Microsoft Visual Studio 2008 Command Prompt*）执行：

```
devenv /resetsettings 
```

注意：您可能需要以管理员身份运行命令提示符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T14:01:37.210

我安装了 Visual Studio 数据库版，显然它会导致 ReSharper 出现问题。我卸载了它，问题就消失了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T00:11:31.050

您可以通过快捷键访问上下文操作菜单吗？在我的安装（IntelliJ/R#2 键绑定）上，快捷方式是`ALT+ENTER`.

如果您确实尝试再次重新安装，您可能希望通过移动设置文件 ( `My Documents\Visual Studio 2008\Settings\CurrentSettings.vssettings`) 并查看它是否是配置文件来恢复到默认出厂设置。

此外，您还没有说明您使用的是哪个版本的 R#。我看到您正在使用自动属性，因此必须是 VS2008。您是否使用4.5的[每晚构建？](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.5+Nightly+Builds)

如果没有这一切，最好的办法是使用[JetBrains 的问题跟踪器 Jira](http://www.jetbrains.net/jira/browse/RSRP)提交错误报告。

祝你好运。我讨厌没有 ReSharper！

# sql - sql join 查询到 linq 语法

> ID：549734
> 
> 赞同：1
> 
> 时间：2009-02-14T20:25:24.943
> 
> 标签：sql, linq-to-sql

我如何将其更改为 linq to sql？

```
select * from ratesSchedule as rs
    inner join userdetails as ud on rs.sid = ud.sid
    and rs.tabletype = 'd' 
```

我走了这么远

```
var results = from rs in db.ratesSchedule
              join ud in db.userdetails on rs.sid equals ud.sid 
```

但我不知道如何添加“and rs.tabletype='d'”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T00:36:06.717

如果您想在没有 where 子句的情况下执行此操作，请尝试以下操作：

```
var results = from rs in db.ratesSchedule
              join ud in db.userdetails on 
                  new { rs.sid, rs.tabletype } equals 
                  new { ud.sid, tabletype = "d" } 
```

在这种情况下，我个人会坚持使用 SQL，因为 LINQ 更不容易阅读。;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T20:59:46.610

您应该可以将其放在语句的 WHERE 部分中，因为除了与表上的常量字段进行比较之外，您没有加入其他条件：

```
var results = from rs in db.ratesSchedule
              join ud in db.userdetails on rs.sid equals ud.sid
              where rs.tabletype = 'd' 
```

# bash - 如何将 STDERR 重定向到 STDOUT，但忽略原始的 STDOUT？

> ID：549737
> 
> 赞同：65
> 
> 时间：2009-02-14T20:27:26.810
> 
> 标签：bash, redirect, stdout

我有一个程序，`STDERR`我想检查和运行其输出`grep`等。

所以我可以将它重定向到`STDOUT`并使用 grep，但问题是，我*不*想要原始`STDOUT`内容。

所以这个不行

```
cmd 2>&1 | grep pattern 
```

因为它将混合原始的 STDOUT 和 STDERR。

这个不起作用，因为 grep 不读取 STDERR 输出：

```
cmd 1>/dev/null | grep pattern 
```

但是，这个也行不通：

```
cmd 1>/dev/null 2>&1 | grep pattern 
```

因为输出将完全为空，因为所有内容都被写入`/dev/null`.

但是必须有一个简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-02-14T20:45:47.703

## 什么不起作用：

您引用最后一个命令的原因：

```
cmd 1>/dev/null 2>&1 | grep pattern 
```

不起作用，源于对重定向工作顺序的混淆。您希望在每个输出上将最后引用的重定向应用于它之前的重定向，以便输出原始标准输出文件描述符 (1) 将转到 /dev/null，而输出到标准错误文件描述符 (2) 将转到原始标准输出。

但是，这不是 shell 重定向的工作方式。每个重定向都会导致文件描述符被“重新映射”，方法是关闭“源”并按顺序将“目标”复制到其中（参见 和 的页面`man`）。这意味着在您的命令中，标准输出首先被替换为，然后标准错误被替换为标准输出，这已经是。`dup(2)``close(2)``/dev/null``/dev/null`

## 什么有效：

因此，要获得预期的效果，您只需要反转重定向即可。然后您将有标准错误转到标准输出，原始标准输出转到`/dev/null`：

```
cmd 2>&1 >/dev/null | grep pattern 
```

（注意`1`之前`>`是不必要的 - 对于输出重定向标准输出是默认的）

* * *

*附录*：查理提到重定向`&-`到关闭文件描述符。如果使用支持该扩展的交互式外壳（`bash`以及其他一些实现，但不是全部，它[不是标准](http://www.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html)的），您也可以这样做：

```
cmd 2>&1 >&- | grep pattern 
```

这可能会更好 - 它可以节省一些时间，因为当命令尝试写入标准输出时，调用`write`可能会立即失败，而无需等待上下文切换到内核和驱动程序处理`/dev/null`（取决于系统调用实现 - 有些可能在`libc`函数中捕获 this ，有些可能还会对`/dev/null`) 进行特殊处理。如果有很多值得的输出，并且输入速度会更快。

这将主要起作用，因为大多数程序不关心它们是否无法写入标准输出（谁真正检查返回值`printf`？）并且不会介意标准输出已关闭。但是如果失败，一些程序可以通过失败代码退出`write`- 通常是阻塞处理器，程序使用一些仔细的库进行 I/O 或记录到标准输出。因此，如果它不起作用，请记住这是一个可能的原因并尝试`/dev/null`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-14T20:31:32.620

先关闭 STDOUT：

```
1>&-, >&- 
```

见[这里](http://tldp.org/LDP/abs/html/io-redirection.html)。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-02-14T20:33:36.483

我会尝试一些简单的事情，例如：

```
cmd 2> tmp_file && cat tmp_file | grep pattern && rm -f tmp_file 
```

# python - Python 扩展了一个空列表错误？

> ID：549741
> 
> 赞同：29
> 
> 时间：2009-02-14T20:28:55.373
> 
> 标签：python, list, extend

为什么python 2.5.2会有以下行为

```
>>>[2].extend([]) == [2]
False

>>> [2].extend([]) == None
True

$ python --version
Python 2.5.2 
```

我假设我在这里不理解某些东西，但直觉上我认为 [2].extend([]) 应该产生 [2]

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-14T20:33:03.617

Extend 是 list 的一种方法，它修改它但不返回`self`（`None`而是返回）。如果您需要修改后的值作为表达式值，请使用`+`，如`[2]+[]`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-14T20:35:32.113

确切地。

```
>>> x = [2]
>>> x.extend([]) # Nothing is printed because the return value is None
>>> x == [2]
True
>>> x
[2] 
```

他们故意这样做是为了让您记住扩展函数实际上是在原地修改列表。与 sort() 相同。它总是返回无。

# c# - 如何在 C# 中找到应用程序在哪个屏幕上运行

> ID：549751
> 
> 赞同：5
> 
> 时间：2009-02-14T20:34:07.637
> 
> 标签：c#, winforms, screen

如何确定我的应用程序在哪个屏幕上运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T20:53:03.957

这应该让你开始。在 Form 上获取一个 Button 和一个列表框，并将其放在 Button_Click 中：

```
listBox1.Items.Clear();
foreach (var screen in Screen.AllScreens)
{
    listBox1.Items.Add(screen);
}
listBox1.SelectedItem = Screen.FromControl(this); 
```

答案在最后一行，记住 Form 也是 Control。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T20:52:57.093

System.Windows.Forms.Screen 类提供此功能。

例如：

屏幕 s = Screen.FromPoint(p);

其中 p 是应用程序上某处的点（在屏幕坐标中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T20:51:56.270

嗯，我不认为有一个内置的方法可以得到这个，但它不应该太难确定。使用[Screen](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen(VS.80).aspx)类查找所有屏幕，遍历该列表并将其边界与表单的位置进行比较。

这是一些未经测试的代码

```
Screen [] screens = Screen.AllScreens;

for(index = 0; index < screens.Length; index++) {
     if (screens[index].Contains(this.Bounds))
        return screens[index];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T20:54:45.747

看看这些链接：

*   [多显示器的 MFC 程序](http://www.ucancode.net/Visual_C_Codes/MFC-Example-Multiple-monitor-support-GetSystemMetrics-EnumDisplayMonitors-GetMonitorInfo%20.htm)
*   [多显示器的原始 MSDN 文章](http://www.microsoft.com/msj/0697/monitor/monitor.aspx)

这些在 WinAPI 中。可能有 .NET 多个监视器库/api 调用，但如果没有，您可以编写自己的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-23T14:41:03.670

好吧，很多年过去了，它是公认答案的派生词，但这对我有用。此方法是 Form 类的成员。该`screen`变量包含调用该方法时窗体左上角所在屏幕的属性。

```
private void ClsFormFoo_Load(object sender, EventArgs e)
{
    Screen screen = Screen.FromControl(this);
} 
```

# c# - Explanation on how this code using web namespace

> ID：549755
> 
> 赞同：0
> 
> 时间：2009-02-14T20:35:38.337
> 
> 标签：c#, asp.net

HttpContext context = ((HttpApplication)sender).Context;

In the above example, why do we cast sender to a HTTPApplication and not HTTPContext?

Also, what is the purpose of the brackets? I know they are for casting, but if you get rid of HTTPApplication and the surrounding brackets, that leaves:

```
(sender).Context; 
```

Why not sender.Context? Or generically, why the use of brackets anyway? I vaguely remember it is a way of casting but can't remember specifics.

Secondly:

```
 string url = context.Request["url"];
 int cacheDuration = Convert.ToInt32(context.Request["cache"] ?? "0");
 string contentType = context.Request["type"]; 
```

EDIT: I realised that you can write:

```
collection["key"] = "value"; 
```

This is for a key-based collection and you store value where there is a key called "key". So am I right in thinking you get the url where the key is "url"?

I know this is using HTTPContext, but in the indexer, what is "url" meant to mean? It is just a string saying url, not even a real url. Likewise for "cache" and "type". If one writes "type", as in the last line of code, does that get back the type (HTTP/HTTPS) used?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T20:39:08.343

It needs to cast `sender` to `HttpApplication` because (presumably) that's the actual type - it then *gets* an `HttpContext` via the `HttpApplication.Context` property.

Given that, you *do* need the cast, therefore the bracketing is reasonable.

For the second part: `"url"`, `"cache"` and `"type"` are just the names of request parameters (which are [documented](http://msdn.microsoft.com/en-us/library/system.web.httprequest.item.aspx) to come from the cookies, form submission, server variables or URL query parameters). So the original URL might be:

> [http://server.com/Foo.aspx?url=someurl&cache=10&type=text/plain](http://server.com/Foo.aspx?url=someurl&cache=10&type=text/plain)

... or the values could come from cookies etc. I would hope that given that information, it would be clear where they'd *really* come from in this case :)

# jquery - 使用 jQuery 获取框架源（源已更改后）

> ID：549759
> 
> 赞同：12
> 
> 时间：2009-02-14T20:38:28.487
> 
> 标签：jquery, frames

这个 jQuery 将返回一个框架的源 URL：

```
$('#frame-name').attr('src') 
```

但是如果单击框架内的链接，仍会返回原始源。

是否可以检测到新的源 URL？或者获取框架中加载的新文档的来源？如果其中任何一个是肯定的，如果源框架包含来自不同域的 URL，是否存在安全限制？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T03:37:28.527

```
parent.frames[1].location.href; 
```

不是 jQuery，而是我正在寻找的东西。但是，如果源位于不同的域中，则会引发安全错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T03:21:52.213

作为浏览器扩展，安全错误会消失。

例如，Greasemonkey 是一个 Firefox 扩展，您可以在其中进行探索，如果您喜欢您创建的脚本，我相信它可以打包到自己的扩展中。

[或者，您可以将脚本作为小书签](http://ajaxian.com/archives/hacking-digg-with-firebug-and-jquery)注入页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T20:54:21.147

AFAIK 没有使用 jQuery 的好方法。您需要在 html 元素上使用 location.href，因此如果您使用 jQuery 获取元素，则可以执行此操作。

```
$("#iframe-name").get(0).location.href 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T21:32:19.013

链接是否来自不同的域？如果作为安全预防措施，浏览器可能会限制访问有关用户在其他窗口或框架中打开的内容的任何信息。

# actionscript-3 - Papervision 渲染到位图

> ID：549766
> 
> 赞同：0
> 
> 时间：2009-02-14T20:41:41.987
> 
> 标签：actionscript-3, bitmap, rendering, papervision3d

有谁知道使用 Papervision 渲染器将 3D 场景渲染到位图的方法？我想对我的场景进行定格，当我在背景中更改场景时可以显示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T20:44:43.137

查看`BitmapViewport3D`课程。

# css - 哪个更好，CSS 透明度或 PNG 透明度？

> ID：549768
> 
> 赞同：8
> 
> 时间：2009-02-14T20:42:09.443
> 
> 标签：css, png, transparency

我应该使用 PNG 透明度还是 CSS 透明度？

我的第一直觉是使用 CSS。但是我在某处听说 IE 中的过滤器很慢，并且使用 PNG 会得到更好的结果（忽略 IE6）。

但是根据个人经验，我知道FF3中的PNG透明度很慢。

这个有确定的答案吗？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-14T20:50:01.423

它们是针对两个不同问题的两种不同解决方案。CSS 透明度（我假设您指的是 opacity 属性）将使整个元素（其边框、背景和内容）透明，而 alpha PNG 透明度仅在您使用图像的情况下有用，例如元素背景.

我想不出在很多情况下你可以使用任何一种来达到同样的效果。

CSS3中当然有[RGBA 颜色](http://www.css3.info/preview/rgba/)，但是浏览器支持目前太低，无法在面向公众的网站/应用程序中成为可行的选择。

PS 我不能说我自己遇到了任何 FF3 alpha PNG 性能问题。

* * *

**后续评论：**

好的。在这种情况下，我会选择 CSS opacity 属性。

尽管过滤器性能在 IE6 中可能不是最佳的，但这意味着您不必浪费带宽和对图像的额外 HTTP 请求。另外，如果你想让图像在 IE6 中也能工作，你必须使用 AlphaImageLoader，我敢肯定它会比 alpha 过滤器慢（如果不慢的话）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-23T22:56:26.493

我刚刚在 Mac 上的 Firefox 3.0.11 中做了一个快速的非科学测试。

我的测试是覆盖一个 div 并反复上下滚动。

一个用过的css：

```
background: #000; opacity:0.8; 
```

另一个使用相同的 10 像素 24 位 PNG。

我用活动监视器测量了以下结果（所以猜测，不准确）

火狐 3.0.11

CSS 不透明度：大约 60% 的 cpu 使用率。

PNG：大约 20% 的 CPU 使用率。

Safari 4.0：

CSS 不透明度：大约 80%（峰值为 120%！）

PNG：大约 76%（完全没有峰值）

所以就性能而言，似乎 PNG 是赢家。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-21T23:11:14.210

使用 png 24 位时，IE 中存在 MEMORY LEAKS（包括 8 个）！请注意。

[http://robertnyman.com/2009/05/26/serious-memory-leak-issue-with-24-bit-png-images-with-alpha-transparency-in-internet-explorer/](http://robertnyman.com/2009/05/26/serious-memory-leak-issue-with-24-bit-png-images-with-alpha-transparency-in-internet-explorer/)

我使用带有一些 jquery 的 pngs 来滑动一些文本，脚本非常慢！我删除了背景png，脚本很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T21:30:16.193

PNG透明度可以做CSS不能做的事情——PNG alpha通道透明度可以对图像的不同部分具有不同程度的部分透明度，而CSS不透明度不能做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-02T11:12:57.827

尽管 CSS 可能是“正确”的方式，但我认为 PNG 更安全、更容易且实现更好。

# ruby-on-rails - 我得到“缺少这些必需的宝石”，但已安装宝石

> ID：549770
> 
> 赞同：7
> 
> 时间：2009-02-14T20:42:30.973
> 
> 标签：ruby-on-rails, ruby, rubygems

因为我使用 Mac Ports（在 Leopard 上）更新了 ruby​​，所以我遇到了几个问题，我还不得不重新安装 gems。现在，当我运行 Mongrel 时，我不断收到错误“缺少这些必需的 gem”，然后是我在 environment.rb 中需要的 gem 列表，但是当我看到运行时，gems 似乎已正确安装`gem list`。我认为 rails 正在寻找以前的安装，但我不知道如何配置它以使用新的 ruby​​/gem 路径。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-08T09:30:26.450

你应该使用：

```
 config.gem 'rspec', :lib => 'spec'
  config.gem 'rspec-rails', :lib => 'spec/rails' 
```

因为 rspec 库没有按应有的方式命名...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T01:56:12.577

在终端试试这个，看看路径是否相似：

```
which ruby
which gem 
```

就在前一周，我遇到了类似的问题，不得不重命名原始的 gem 二进制文件，这样它才能找到 MacPorts 安装的那个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-14T22:52:33.047

这个 railswiki-entry 提供了很多关于处理多个 gem 存储库的见解。也许你在那里找到了解决你问题的线索。希望能帮助到你

[http://wiki.rubyonrails.org/rails/pages/HowToUseMultipleGemRepositories](http://wiki.rubyonrails.org/rails/pages/HowToUseMultipleGemRepositories)

更新：以上链接已损坏，但文本已保存在这里：http: [//tek-zappeln.blogspot.com/2009/02/howtousemultiplegemrepositories-rescued.html](http://tek-zappeln.blogspot.com/2009/02/howtousemultiplegemrepositories-rescued.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T22:52:17.777

您确定 gem 命令实际上是 MacPorts 安装的命令，而不是 OSX 中包含的默认命令吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T11:05:47.160

您可以强制它使用特定版本的 ruby​​：

```
/path/to/ruby -S <command> 
```

您可以强制您的 rails 应用程序开始使用您想要的任何版本的 ruby​​，您也可以使用它来运行您的 gem list 命令并确保在运行 rails 之前您拥有正确的 gem。

# c# - 用于电子表格操作的 MS-Access/Excel 替代方案

> ID：549787
> 
> 赞同：6
> 
> 时间：2009-02-14T20:52:36.313
> 
> 标签：c#, .net, excel, ms-access, spreadsheet

我有一个 MS-Access 应用程序，它在两个大型电子表格（20,000 多行）中格式化数据，将这些数据导入表格，运行一些查询比较数据并将结果输出为 excel 文件。

问题是随着应用程序（和 VBA 代码）的增长，使用 Access 变得越来越痛苦，我想知道是否有更好的方法？

与 MS-Access 相比，.NET(C#) 解决方案的优点/缺点是什么，最好的库等是什么？

干杯，

布兰丹

为到目前为止的响应干杯，我忘了提到虽然这个应用程序需要独立，我需要能够打包应用程序并将其发送给最终用户以安装在他们的计算机上。这只安装了（值得注意的）MS-Office 和 .Net Framework，所以我不确定 MySQL 等在没有地方托管的情况下有多可行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T09:04:29.633

迁移到 .Net 将使您拥有更好的工具来处理数据。

尽管您现在使用 Access 解决方案到底在做什么，但您必须小心：如果您正在做很多特殊情况处理来处理与 Excel 之间的数据，那么您可能仍然需要做您选择的任何语言或框架的那些。

如果您投入大量代码将 Excel 数据提取到 Access 中，那么您仍然可以保留该部分的 Access 并使用 .Net 帮助您进行比较和创建生成的 Excel 报告。

在不了解您的项目的情况下真正提出建议有点困难。

如果您只想使用自动化来提取数据并创建您的 Excel 文件，那么 .Net 可能不会为您提供很多，因为您仍然需要执行您已经在 Access 中完成的完全相同的事情。

相反，您可以考虑使用使用不同范例的商业 Excel 组件以更好的方式打开/创建 Excel 电子表格。
有一些组件供应商拥有这些。

一种解决方案是使用报告工具直接从 Excel 中提取数据并生成一份您可以简单地保存回 Excel 的报告。

我的建议是：

*   如果您的 Access 解决方案稳定且工作正常，那么您可以考虑保留它。
    迁移到新系统将花费您时间和金钱，您必须检查结果是否值得投资。
*   如果您觉得 Access 的功能过于受限，那么请花一些时间尝试各种允许您操作 Excel 的解决方案和组件，例如使用 LINQ Excel 提供程序（[1](http://solidcoding.blogspot.com/2008/01/linq-to-excel-provider-20.html)或[2](http://blogs.msdn.com/ericwhite/archive/2008/11/14/using-linq-to-query-excel-tables.aspx)）可能会提供很好的抽象，或者尝试各种[商业组件](http://www.componentsource.com/features/spreadsheet/index.html)，直到找到符合您需求的组件。

如果您采用 .Net 路线，您可能最终甚至不需要数据库来处理数据。
但是，如果您这样做，您始终可以使用 Jet（或其新版本 ACE）作为创建 MSAccess 数据库的后端。
它已经安装在大多数机器上，并且得到 MS 工具的良好支持。
其他不错的选择是 SQL Server Compact 和 SQLite，因为这些都不需要复杂的设置，只需一个 DLL 即可随您的项目一起提供。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-14T23:34:05.490

我想说，对于您正在使用的 20,000 行的数据量，SQL Server 数据库除了迁移到存储过程来进行数据操作之外并不会真正为您带来太多好处。在这方面，它可以说比 VBA 更好，因此您可能会得到一个更易于维护的代码库。但是，按照数据库标准，您描述的数据量很小。除非您拥有比这多一两个数量级的数据，否则我不会期望性能成为问题。

如果您想做[数据处理](http://www.manning.com/cross/)工作，最好使用[Perl](http://www.cpan.org)或[Python](http://www.python.org)之类的脚本语言。这些语言比 C# 或 VB.Net 更适合数据操作任务。可以在[www.activestate.com](http://www.activestate.com/)找到 Perl 和 Python 的良好、免费的 Windows 发行版。

Excel 可以通过[python-com](http://python.net/crew/mhammond/win32/Downloads.html)接口使用与 VBA 相同的 API 使用 Python 编写脚本，但可以获得更好的语言，并提供大量可用的库。同样，这也可以通过[Win32::OLE](http://www.perlmonks.org/?node=Win32%3A%3AOLE)使用 Perl 来完成。还有一些实用程序库，例如[pyexcelerator](http://sourceforge.net/projects/pyexcelerator)、[xlrd](http://www.lexicon.net/sjmachin/xlrd.htm)和[xlwt](https://secure.simplistix.co.uk/svn/xlwt/trunk/README.html)，用于 Python 和[Spreadsheet::WriteExcel/Spreadsheet::ParseExcel](http://www.ibm.com/developerworks/linux/library/l-pexcel/)用于 Perl。还有一些模块可用于构建可安装的 Windows 应用程序，例如[Py2EXE](http://www.py2exe.org/)或[Perl Dev Kit](http://activestate.com/perl_dev_kit/?gclid=CMDIzd-a3ZgCFUIw3godIVWBeA)

[这篇 Stackoverflow 帖子](https://stackoverflow.com/questions/441758/driving-excel-from-python-in-windows)更深入地讨论了在 Python 中使用 Excel，包括使用 MakePy 生成包装器。

如果您正在使用 .Net，您也可以尝试[IronPython——](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)它是 Python 的本地 .Net 实现，可以在安装了合适的 .Net 运行时的任何地方运行。您还可以获得一个名为[IronPythonStudio](http://www.codeplex.com/IronPythonStudio/Release/ProjectReleases.aspx)的免费 Visual Studio 插件）。

另一种选择是[R](http://www.r-project.org)。R 主要是一个统计包，但核心语言具有强大的数据处理能力和各种接口库（以及其他如图形、各种统计计算和[Excel 接口](http://www.stats.bris.ac.uk/R/web/packages/RExcelInstaller/index.html)。它实际上是一个非常强大的通用数据处理和报告工具.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T17:58:43.857

在[SpreadsheetGear](http://www.spreadsheetgear.com/)，我们的专长是与 Excel 兼容的高性能电子表格组件。我们一直听到（请参阅[此页面](http://www.spreadsheetgear.com/products/spreadsheetgear.net.aspx)上的一些客户报价），SpreadsheetGear for .NET 比其他选项更快且更易于使用。

有C# 和 VB.NET 源代码的[实时 ASP.NET 示例](http://www.spreadsheetgear.com/support/samples/)，如果您想亲自尝试，可以[免费试用。](https://www.spreadsheetgear.com/downloads/register.aspx)

免责声明：我拥有 SpreadsheetGear LLC

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T20:54:10.180

Apache POI 库可能对您有用。它是基于java的，可以处理excel文件。

另一种选择可能是使用直接 ODBC 驱动程序来处理 XLS 文件。不过可能有很多记录..

[http://poi.apache.org/](http://poi.apache.org/)

> POI 项目由 API 组成，用于操作基于 Microsoft 的 OLE 2 复合文档格式和 Office OpenXML 格式的各种文件格式，使用纯 Java。简而言之，您可以使用 Java 读写 MS Excel 文件。此外，您可以使用 Java 读写 MS Word 和 MS PowerPoint 文件。POI 是您的 Java Excel 解决方案（适用于 Excel 97-2007）。但是，我们有一个完整的 API 用于移植其他 OLE 2 复合文档格式并欢迎其他人参与。
> 
> 基于 OLE 2 复合文档格式的文件包括大多数 Microsoft Office 文件，例如 XLS 和 DOC 以及基于 MFC 序列化 API 的文件格式。
> 
> 基于 Office OpenXML 格式的文件包括新的 (2007+) 基于 xml 的文件格式，包括 Microsoft Office 文件，例如 XLSX、DOCX 和 PPTX。

**编辑：查看[Monarch Pro](http://www.datawatch.com/_products/monarch_pro.php)之类的工具，它在数据挖掘等方面非常出色。**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T18:20:59.000

[SpreadsheetGear](http://www.spreadsheetgear.com)完全震撼！您可以两全其美，电子表格中的所有逻辑都可供您从代码中执行。您可以真正缩短开发时间，因为您可以让业务部门帮助制定业务流程的逻辑。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T22:48:23.977

我会考虑一个使用 SQL Server Compact 开始的系统。如果你愿意，你可以不安装就使用它（虽然我建议你这样做，假设必要的 dll 在 GAC 中要容易得多）。如果随后您发现需要更多功能（例如存储过程或 TEXT/BLOB 列，诸如此类），那么迁移到 SQL Server 将是微不足道的。

如果您的数据库每次都重新生成，那么尝试不同的事情就像指向不同的文件一样简单。

如果您在 VBA 中有相当多的代码，我建议您首先将其移至 VB.Net（使此，首先也是最容易出错的转换更容易），然后如果您愿意，则将其迁移到 c#。

至于生成/更改 excel 表，您有三个选项。

一种是使用[VSTO](http://msdn.microsoft.com/en-us/vsto/default.aspx)，尽管[Wikipedia](http://en.wikipedia.org/wiki/Visual_Studio_Tools_for_Office)是一个更好的描述。这将最接近您的旧 VBA 开发，尽管它具有完全不同的复杂性。

另一种是使用其中一个 excel 输出库，还有[一些](http://swik.net/excel)商业的。我个人不能推荐任何人，尽管[其他人在这里有](https://stackoverflow.com/questions/444522/c-asp-net-import-and-export-excel-what-is-the-best-library)。

最后就是转储 csv 并在打开时让 excel 处理它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T14:09:47.760

在我看来，Access 并没有帮助你作为中介。20K 行对我来说听起来并不多。您说您从 Excel 转到 Access，然后再返回 Excel。您是否需要保留 Access 数据？

[如果没有，我建议使用 .Net 和FlexCel](http://www.tmssoftware.com/site/flexcelnet.asp)等第三方 Excel 库，并直接从 Excel 转到内存中的 Excel。使用安装程序或[ClickOnce](http://msdn.microsoft.com/en-us/library/wh45kb66.aspx)可以轻松打包 .Net 应用程序。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-02-14T21:05:36.783

我想知道你是否已经超越了 Access。这就是更强大的数据库（如 SQL Server）的诞生目的。20,000 行对于 SQL Server 来说并不是一个很大的数字，但我敢打赌，对于 Access，它已经到达那里。Access 在运行时占用了多少磁盘空间？数据增长的速度有多快？

您对 C# 与 VB 的了解程度如何？如果您不太了解 C#，这可能是一个学习的好机会。这是一个你已经很清楚的问题。

# sql-server - 打印表的结构/模式

> ID：549799
> 
> 赞同：23
> 
> 时间：2009-02-14T21:04:23.667
> 
> 标签：sql-server, database-design

我在数据库 RentalEase 中有大约 20 个表，我想（物理地）打印出来，这样我可以更轻松地查看它们。我不太关心它们中有什么数据，只关心它们的结构。我怎样才能做到这一点？

它是一个 SQL Express 服务器，我正在使用 Microsoft SQL Server Management Studio Express 来管理它。我记得当我使用 MySQL 和 PHP 时，我可以使用 DESCRIBE 将其打印出来，但我不记得我是如何做到的。SQL Server 似乎没有 DESCRIBE

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-14T21:12:26.360

尝试：

```
sp_help <table_name> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-15T16:56:42.103

您始终可以检查 INFORMATION_SCHEMA 视图以查找有关表及其列的所有有趣信息。

它本身并不称为“描述” - 但此查询将向您显示大量信息：

```
select * from Information_schema.Columns
where table_name = '(your table here)' 
```

马克

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-14T21:16:25.993

在管理工作室中，

1.  单击数据库旁边的“+”，展开其下方的对象，然后单击“表”
2.  通过从菜单中选择“查看”->“对象资源管理器详细信息”打开表详细信息视图
3.  现在选择所有表（在对象详细信息的右侧）
4.  右键单击任何选定的表（在右侧）
5.  “脚本表为”->“创建到”
6.  “文件”或“剪贴板”

这将生成一个包含所有选定文件模式定义的脚本文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-14T21:14:09.320

您可以使用数据库模式图设计工具。只需将所有表放在那里，您将获得包括所有键的数据库图表

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-14T21:55:02.443

这是我编写的一个脚本，它简单地以如下格式列出每个表及其列：

表格列

table1 column1,column2...columnX

脚本是：

```
declare @max_tables int
declare @max_columns int
declare @sql nvarchar(400)
declare @x int
declare @y int
declare @table varchar(50)
declare @columns varchar(800)

create table #c ([Table] varchar(50),[Columns] varchar(800))

select ROW_NUMBER() OVER(ORDER BY name) AS Row, name 
into #table_list
from sys.objects 
where type_desc = 'USER_TABLE' 
order by name

set @max_tables = (select count(*) from sys.objects where type_desc = 'USER_TABLE')
set @y = 0

while @y < @max_tables
    begin
        set @y = @y + 1
        set @table = (select name from #table_list where row = @y)

        create table #t (c int)

        set @sql = 'select count(*) as c from Information_schema.Columns where table_name = ''' + @table + ''''
        insert into #t exec sp_executesql @sql

        set @max_columns = (select top 1 c from #t)

        DROP TABLE #t

        set @x = 0
        set @columns = ''

        while @x < @max_columns 
            begin
                set @x = @x + 1
                set @columns = @columns + (select column_name from Information_schema.Columns where table_name = @table and ordinal_position = @x)
                if @x < @max_columns set @columns = @columns + ', '
            end

        insert into #c select @table,@columns

    end

select * from #c

DROP TABLE #c
DROP TABLE #table_List 
```

# java - 比较 LinkedList.contains() 中的对象

> ID：549808
> 
> 赞同：10
> 
> 时间：2009-02-14T21:09:00.287
> 
> 标签：java, linked-list, contains, equality

我希望能够让 LinkedList.contains() 为自定义比较器返回 true。

假设我有 1 个 LinkedList 和 2 个对象

```
LinkedList<MyObject> myList = new LinkedList<MyObject>();

MyObject a = new MyObject("HELLO");
MyObject b = new MyObject("HELLO"); 
```

从技术上讲，两个对象在比较方面是相同的（MyObject 实现 Comparable）

(a == b) == 真

但是，当我执行以下操作时，myList 不会为 myList.contains(b) 返回 true

```
myList.add(a)
myList.contains(b) // == false 
```

我认为它是因为 contains 将检查对象引用并看到 a 和 b 是 2 个不同的对象。有什么办法可以做到，所以我不必扩展 LinkedList 来比较这些对象？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-14T21:16:06.273

LinkedList 使用 equals 方法，而不是 Comparable.compareTo。您应该[覆盖 MyObject 中的 equals（和 hashCode）](http://www.ibm.com/developerworks/java/library/j-jtp05273.html)来解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T21:16:57.567

该`contains()`方法用于`equals()`确定对象是否在列表中。我怀疑您的类`MyObject`没有覆盖该`equals()`方法，这`myList.contains(b)`就是返回的原因`false`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-14T21:18:22.900

您需要覆盖 MyObject 类中的 .equals(Oject) 和 .hashCode() 方法（List 不需要 hashCode ......但是当您覆盖 equals 时，合同说您必须覆盖 hashCode）。

本质上， contains 的作用是：

```
for(列表中的每一项)
{
    if(theCurrentItem.equals(theItemYouAreLookingFor))
    {
        返回（真）；
    }
}

返回（假）；

```

[在这里](http://java.sun.com/javase/6/docs/api/java/lang/Object.html)查看 Object (for equals and hashCode) 的文档

[《 Effective Java](http://java.sun.com/docs/books/effective/)》也是一本非常值得阅读的书

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-14T21:16:24.840

```
( a == b ) == true 
```

你的意思是`a.equals(b)`然后`b.equals(a)`返回`true`？这与检查引用相等性不同，也**不同于**`a.compareTo(b) == 0`检查.

[`LinkedList.contains()`](http://java.sun.com/javase/6/docs/api/java/util/LinkedList.html#contains(java.lang.Object))使用`equals()`，因此您必须确保该方法已[正确实施](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#equals(java.lang.Object))。`equals()`也应该与 一致`compareTo()`，尽管这不是绝对必要的。如果您使用的是基于散列的数据结构（例如[`HashSet`](http://java.sun.com/javase/6/docs/api/java/util/HashSet.html)），则必须确保`hashCode()`正确[实施](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#hashCode())。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-14T21:17:01.407

contains 方法的文档如下：

> 如果此集合包含指定元素，则返回 true。更正式地说，当且仅当此集合包含至少一个元素 e 满足 (o==null ? e==null : o.equals(e)) 时才返回 true。

因此，您需要重写 MyObject 的 equals(Object o) 方法。

所以对于你的例子：

```
public class MyObject {
  String myVal;

  public boolean equals(Object o ) {
    return ((MyObject)o).myVal.equals(myVal);
  }
} 
```

您不需要使用 Comparable 接口实现任何东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T07:26:30.817

您是否考虑过使用新的 HashSet(Comparator)，而不是使用 LinkedList 搜索每个元素。这将有效地比较元素以找到匹配项。

# bash - Bash 中的 Control-r reverse-i-search：如何“重置”Cygwin 中的搜索？

> ID：549810
> 
> 赞同：61
> 
> 时间：2009-02-14T21:12:13.070
> 
> 标签：bash, cygwin, readline

您如何告诉`Ctrl`+ `R`reverse-i-search “重置自身”并每次从历史底部开始搜索？

**背景：**在 Bash 中使用 reverse-i-search 时，一旦完成对历史的搜索，我总是卡住并且找不到更多匹配项。有时我会再次点击`Esc`并重新调用`Ctrl`+ `R`，期望它从我的历史底部开始新的搜索。然而，“指针”似乎仍然在我历史上它离开的前一个地方。

问题是，我通常不希望这种行为。如果我点击`Esc`，然后重新调用`Ctrl`+ `R`，我希望它表明它应该再次从底部重新启动并重新开始工作。

我在 Windows 上使用 Cygwin，因为到目前为止提到的解决方案都不起作用。

* * *

[此问题被标记为[可能重复的问题](https://stackoverflow.com/questions/791765)。这个问题不是重复的，原因如下：]

*   [另一个问题不涉及 Cygwin。]
*   [替代问题不涉及如何将搜索**重置**为其初始状态（相反，它仅涉及在搜索中向后和向前移动）。]

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-14T21:46:12.270

我的 Bash 按您的预期工作。也许打`Ctrl`+`C`而不是`Esc`可以提供帮助。

此外，您可以使用`Ctrl`+向前搜索`S`。

`Ctrl`+`S`如果它没有向您的终端发送“停止”，即如果“stty -a”为您提供“-ixon”，则它可以工作。你可以通过“stty -ixon”来改变它。

感谢@Phil 的提醒。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-14T21:47:51.923

我从未尝试在点击时将其设为默认值`Esc`，但 Bash`readline`用于输入，默认情况下它接受 Emacs 样式的键绑定，因此您可以使用`M->`（通常通过组合 Meta/`Alt`和`>`或在键后跟随`Esc`键`>`）进入底部。

如果`M->`由于您的终端不允许您输入而不起作用，请尝试`^G`（`Ctrl`并`G`同时）。那是 Emacs 中的“取消”笔划，通常`readline`也可以使用。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-07-15T06:53:18.703

我得到了这个问题的确认答案。

要重置`Ctrl`+ `R`，通常的 Emacs 键`Ctrl`+`G`可以做到。如果您想将`Ctrl`+反转`R`一步，而不是再次从底部向上移动，您可以使用**+**。 **`Ctrl``S`**

诀窍是`Ctrl`+`S`也用于暂停终端。因此，您需要将其分配给另一个键。例如，以下将暂停设置为`Ctrl`+ （并使用+`W`保持“恢复” ）。`Ctrl``Q`

 **```
$ stty STOP ^w 
```** 

或者，您也可以通过以下方式完全禁用 XON/XOFF（恢复/暂停）流控制字符

```
$ stty -ixon -ixoff 
```

这也将释放`Ctrl`+ `S`。要重新启用暂停/恢复，您可以执行

```
$ stty ixon ixoff 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-14T21:47:07.480

```
M-> ... moves to end of history
M-< ... moves to start of history 
```

您的左键`Alt`很可能是您的元键。

用于`man readline`更多的 readline 指令。

# html - 如何设置一种样式来覆盖 CSS 中的另一种冲突样式？

> ID：549828
> 
> 赞同：26
> 
> 时间：2009-02-14T21:18:35.457
> 
> 标签：html, css, fonts, lamp

当用户单击它们时，我正在显示在数据库中标记为已读的链接。我想根据数据库信息而不是用户的浏览器历史记录来设置单击和未单击链接的样式。到目前为止，当我使用：

```
 10 a:visited {
 11   color: #444;
 12 }
 13
 14 a:link {
 15   font-weight: bold;
 16   color:black;
 17 }
 18
 19 .read {
 20   color: #444!important;
 21 }
 22
 23 .unread {
 24   font-weight: bold!important;
 25   color:black!important;
 26 } 
```

和

```
<tr class="even">
  <td><a class="read" href="example.com">blah</a></td>
</tr>
<tr class="odd">
  <td><a class="unread" href="example.org">foo</a></td>
</tr> 
```

并且已经访问了一个链接，但不是来自这个页面（它在数据库中仍然被标记为未读），我得到了奇怪的结果。例如，只有颜色会起作用，但重量不会，等等。

当它们发生冲突时，是否可以让一种风格覆盖另一种风格？

谢谢！

编辑：更新代码以澄清

## 解决方案

```
 10 a:link,
 11 a:visited {
 12   font-weight: bold;
 13   color: black;
 14 }
 15
 16 a.read {
 17   color: #444;
 18   font-weight: lighter !important; /* omission or even "normal" didn't work here. */
 19 }
 20
 21 a.unread {
 22   font-weight: bold !important;
 23   color: black !important;
 24 } 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-14T21:20:36.420

您可以使用 !important 指令。例如。

```
.myClass
{
   color:red !important;
   background-color:white !important;
} 
```

当您需要覆盖也应用的任何其他样式时，请在每个样式之后放置 !important，如上所示。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-14T21:28:00.927

首先，如果您不希望浏览器自己的历史记录干扰您的样式，则使用 :visited 伪类来匹配未访问链接的样式，然后根据您的数据库记录手动应用类。

关于冲突的样式，这完全取决于选择器的[特殊性](http://css-tricks.com/specifics-on-css-specificity/)，如果两个具有相同属性的冲突（具有相同的特殊性）最后一个“获胜”。

**做这个：**

```
a:link, 
a:visited {
    font-weight: bold;
    color: black;
}

a.read {
    color: #444;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T21:21:36.760

尝试：

```
a.unread, a:visited.unread {style 1}

a.read, a:visited.read {style 2} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T21:35:35.540

一，检查您的 HTML 以确保`class="read"`并被`class="unread"`添加到您的链接中。

二，尝试添加`a`您的`.read`和`.unread`CSS 规则：

```
a.read { /* ... */ }
a.unread { /* ... */ } 
```

如果这不起作用，请尝试在`!important`. 我认为这不是必需的，但[我见过的大多数例子都](http://www.w3.org/TR/CSS2/cascade.html#important-rules)包括它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T21:30:02.187

您可以定义 CSS 选择器的特殊性。

`a { /* style 1 */ }`

将被覆盖

`div a { /* style 2 */ }`

`div`的父元素在哪里`a`

更多细节可以在[Selectutorial](http://css.maxdesign.com.au/selectutorial/advanced_conflict.htm)上找到。

# community-server - 如何修改社区服务器的审核警报设置？

> ID：549835
> 
> 赞同：0
> 
> 时间：2009-02-14T21:24:41.370
> 
> 标签：community-server

如何在社区服务器中为新线程、新帖子、新用户等设置管理员警报？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T11:53:40.147

您的问题可能会在[社区服务器论坛](http://dev.communityserver.com/)获得更多回复。

# objective-c - 关闭主窗口时，Cocoa 应用程序似乎崩溃

> ID：549837
> 
> 赞同：0
> 
> 时间：2009-02-14T21:24:53.507
> 
> 标签：objective-c, cocoa, macos

我的应用程序在终止时似乎出现了一些奇怪的行为。当我使用左上角的标准红色小按钮关闭主窗口时，应用程序崩溃。我没有对应用程序进行任何明显会导致此问题的更改。我正在努力调试问题，因为应用程序崩溃并且我的调试技能有限。有谁知道可能发生这种情况的任何明显原因或我可以采用的调试策略？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T21:31:31.497

如果它与 EXC_BAD_ACCESS 一起崩溃（这听起来很可能，尽管可能不是这种情况 - 您没有指定），这可能与您在某处的 dealloc 方法之一有关。应用程序 dealloc 在退出之前一切正常，因此请确保您没有发布已自动发布的内容，例如。

如果您习惯使用 GDB，我会尝试在某些 dealloc 方法中设置断点，然后查看您发布的内容可能处于什么状态。

如果不先进行一些探索以找出真正导致问题的原因，那么调试此类崩溃可能会很棘手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T20:15:16.697

IB 3 中的一个新选项是 NSWindows 在关闭时释放的设置。确保您已检查和/或正确保留窗口/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T07:12:44.090

我还要说它一定是某种内存泄漏。你提到你的调试技能是有限的，但实际上使用新的 Instruments 应用程序调试它们非常容易。这是一篇关于它的非常好的[文章](http://www.cimgf.com/2008/04/02/cocoa-tutorial-fixing-memory-leaks-with-instruments/)。

# c++ - 防止 C++ 中的虚拟方法实现

> ID：549849
> 
> 赞同：4
> 
> 时间：2009-02-14T21:32:00.260
> 
> 标签：c++, inheritance, encapsulation

我在 C++ 中有以下类层次结构：

```
class Base {
    virtual void apply() = 0;
};

class Derived : public Base {
    virtual void apply() {
        // implementation here that uses derived_specialty
    }

    virtual void derived_specialty() = 0;
};

class Implementation : public Derived {   
    virtual void derived_specialty() {
        // implementation
    }
}; 
```

我想保证实现级别的类不提供它们自己的应用实现，并且它们只实现派生专业。有没有办法保证继承自 Derived 的类不会实现 apply，从而使用 Derived::apply 实现？我的理解是，在 C++ 中，基类中的虚拟方法在继承层次结构中一直是虚拟的，但是如果 C++ 中有任何技巧可以完成，我很想听听它们。

我总是对 C++ 允许的事情感到惊讶，所以我认为值得一问。:)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-14T21:48:11.003

您可以使 Implementation 成为委托类，而不是 Derived 的专业化

```
class Derived : public Base
{
    Derived()

    void apply() 
    {
        //whatever, delegate to impl class instance
        impl->apply_specialization();
    }

    Impl* impl;
};

class Impl : public WhateverImplInterface
{
      void apply_specialization(){}
}; 
```

然后实现无权访问 apply 函数并与层次结构分离。Derived 类然后由 Impl 类的实例参数化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-14T21:41:56.353

你可以通过组合来做到这一点：

```
class Base {
    virtual void apply();
};

class Derived : public Base {

    class IImplementation {
        virtual void derived_specialty() = 0;
    };

    IImplementation& m_implementation;

    Derived(IImplementation& implementation)
        : m_implementation(implementation)
    {}

    virtual void apply() {
        // implementation here that uses m_implementation.derived_specialty
    }

};

class Implementation : Derived::IImplementation {   
    virtual void derived_specialty() {
        // implementation
    }
}; 
```

其他类仍然可以继承 Derived 并覆盖 apply 方法，但您的 Implementation 类不再是这些类之一。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-14T21:46:27.840

在您的文档中明确限制。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-14T23:43:53.517

“我想保证实现级别的类不提供自己的应用实现。”

你不能。

到目前为止，我看到的所有示例都没有阻止任何派生类定义它们自己的 apply 函数。它们都提供了对 apply 和 derived_specialty 之间的关系进行建模的方法，建议用户*不要*覆盖 apply。不过，您可以在一行文档中实现相同的目的。

您正在寻找的是 C++ 中不存在的 Java final 语句，对吗？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-14T21:49:53.307

您可以使 Base::apply 非虚拟并在 Base 中使用模板方法模式。

本文解释了这种做法的优点：
[http ://www.gotw.ca/publications/mill18.htm](http://www.gotw.ca/publications/mill18.htm)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-15T00:01:28.217

您可以在析构函数中放置一个断言，以确保*apply*未被覆盖：

```
class Base {
    virtual void apply() = 0;
};

class Derived : public Base {
    virtual void apply() {
        // implementation here that uses derived_specialty
    }
    virtual ~Derived() {
        assert(this->apply == Derived::apply);
    }
    virtual void derived_specialty() = 0;
};

class Implementation : public Derived {   
    virtual void derived_specialty() {
        // implementation
    }
}; 
```

这里的想法是 this->apply 将从虚拟表中获取方法地址，而 Derived::apply 在编译时解析它。如果它们相等，则 apply 在 Implementation 类中不会再次被覆盖。这种方法还有一个优点是它不会在发布版本中施加性能损失，其中 assert() 宏被（应该）从生成的代码中剥离。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-15T00:32:20.173

尝试使用模板方法模式

[维基百科](http://en.wikipedia.org/wiki/Template_method_pattern)有一个 C++ 示例。

它不会改变封装，但它改进了设计，所以你不需要。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T19:02:27.413

总是有访问修饰符：

```
 class base {
      protected: virtual void real_apply() = 0;
 };
 class derived : public base {
      void real_apply();
 public:
      apply() { real_apply(); }
 };
 class other : public derived {
      void func() {
          apply();      // this is ok
          real_apply(); // this is a compile time error
      }
 }; 
```

# vb.net - VB.Net Winforms 用户控制变量

> ID：549861
> 
> 赞同：0
> 
> 时间：2009-02-14T21:46:14.393
> 
> 标签：vb.net, winforms, user-controls

我在 VB.Net WinForms 应用程序中使用 VS 2005。我有一个自定义用户控件，它需要一个变量才能正确呈现其数据。 **我的问题是，要求调用 sub 填充变量的最佳方法是什么？** 我想到了几个选择：

*   有一个 WriteOnly 属性并在加载用户控件时检查它是否为“Nothing”，如果是这种情况则抛出异常。我不喜欢这样，因为错误会在运行时出现，我想要求在设计时填充变量（比如将参数传递给子/函数）。

*   有一个全局变量来保存我希望用户控件使用的变量。我也可以通过这种技术使用异常，但是，就像我上面提到的选项一样，错误会在运行时抛出。

**对于在设计时填充用户控件所需的变量，您有什么建议？**

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T22:18:17.357

我已经用自定义控件在这条路上走过了几次，我得出了一个事实

> 如果未设置必要的属性，自定义控件必须呈现而不会崩溃。

有太多的情况下你会陷入这种情况。主要示例是 WinForm 设计器。一旦您将控件拖到主机上，WinForms 就会创建它的一个实例并在 VS 进程中呈现它。默认情况下，它不会将任何变量传递给构造函数，因此初始渲染将在没有设置任何属性的情况下发生。

如果在未设置属性时让控件呈现在一些较小的状态，您将节省大量时间。这就是标准控件的工作量。通常我让控件呈现一条消息，以显示“缺少属性 X”的效果，或者什么也不显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T22:02:08.317

将变量作为参数添加到控件的所有公共构造函数中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-12T16:26:53.840

我会重载构造函数，默认构造函数会将变量设置为预定的默认值。

# php - 我必须登录两次

> ID：549865
> 
> 赞同：0
> 
> 时间：2009-02-14T21:48:04.420
> 
> 标签：php

出于某种原因，我的网站必须登录两次才能正常工作。如果有人知道我为什么欣赏它。

这是我的授权代码：

```
<?php
session_start();
require_once($_SERVER['DOCUMENT_ROOT'].'/config.php');
require_once(SITE_ROOT.'includes/exceptions.php');
require_once(SITE_ROOT.'data/model.php');

/*
 * The purpose of this class is to manage
 * access to the application, making sure the
 * users are logged in before they can access
 * certain features
 */

class Auth extends Model
{
    function isUserLoggedIn()
    {
        /*
         *  Check for the user_id in $_SESSION
         * and see if it's the database. Return
         * true or false
         *
         */

        if(isset($_SESSION['user']))
        {
            return true;
        }
        else
        {
            return false;
        }

    }

    static function redirectToLogin()
    {
        header("location: http://". DOMAIN .APP_DIR . "index.php?action=login");
    }

    static function redirectToMain()
    {
        header("location: http://". DOMAIN . APP_DIR . "index.php?action=main");
    }

    static function login($user)
    {
        /*
         * Authenticate the user passing to the function
         * a instance of the User object
         */

        try
        {
            $db = parent::getConnection();
            $pass = $user->getPassword();
            $query = "select username, password from users where username = '".$user->getUsername()."' and password = '".$user->getPassword()."'";
            $results = $db->query($query);             

            if(empty($results)) {
                throw new Exception('There was a problem logging you in', EX_LOGIN_ERROR);
            }            

            $row = $results->fetch_assoc();           

            $user = $row['username'];
            $_SESSION['user'] = $user;

        }
        catch(Exception $e){
            throw $e;
        }
    }

    static function logout()
    {
        $old_user = $_SESSION['user'];
        unset($_SESSION['user']);
        session_destroy();
    }

}
?> 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T22:10:47.000

我会听@strager 作为您的代码，从我有限的 PHP 经验来看，似乎没有显示任何会导致错误的内容。虽然我忍不住提供了一些与您的问题无关的简单重构，但这只会让*我*感觉更好：

```
<?php
    session_start();
    require_once($_SERVER['DOCUMENT_ROOT'].'/config.php');
    require_once(SITE_ROOT.'includes/exceptions.php');
    require_once(SITE_ROOT.'data/model.php');

    /*
     * The purpose of this class is to manage
     * access to the application, making sure the
     * users are logged in before they can access
     * certain features
     */

    class Auth extends Model
    {
        function isUserLoggedIn()
        {
            /*
             *  Check for the user_id in $_SESSION
             * and see if it's the database. Return
             * true or false
             *
             */

            return isset($_SESSION['user']);
        }

        static function redirectToLogin()
        {
            header("location: http://". DOMAIN .APP_DIR . "index.php?action=login");
        }

        static function redirectToMain()
        {
            header("location: http://". DOMAIN . APP_DIR . "index.php?action=main");
        }

        static function login($user)
        {
            /*
             * Authenticate the user passing to the function
             * a instance of the User object
             */

            $db = parent::getConnection();
            $pass = $user->getPassword(); // replaced getPassword in the query with this variable, else there is no need to set it here.
            $query = "select username, password from users where username = '".$user->getUsername()."' and password = '".$pass."'";
            $results = $db->query($query);             

            if(empty($results)) {
                throw new Exception('There was a problem logging you in', EX_LOGIN_ERROR);
            }            

            $row = $results->fetch_assoc();           
            $_SESSION['user'] = $row['username'];

            // Why bother surrounding with try...catch just to throw the same exception
        }

        static function logout()
        {
            // what is $old_user used for? I can't see it set as a global variable anywhere
            $old_user = $_SESSION['user'];
            unset($_SESSION['user']);
            session_destroy();
        }

    }
    ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T22:34:03.107

只是没有足够的代码让我们查明错误。该问题可能与您的网站设计有关，其中有关您的登录状态的信息是在处理登录之前发送的。如果不是，那么鉴于此信息，我不知道出了什么问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T22:48:08.410

似乎您的问题已经得到解答，但如果网络服务器自动重定向您，也可能会出现问题，例如：

> yourdomain.com

到

> **www** .yourdomain.com

或相反。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-11T19:03:52.713

它不是由重定向引起的。`Session_start()`在设置或接收会话变量之前应始终使用。即它需要在类方法中。

# .net - 如何关闭或替换 Asp.net MVC 中的默认 ModelState 错误消息？

> ID：549874
> 
> 赞同：9
> 
> 时间：2009-02-14T22:06:36.950
> 
> 标签：.net, asp.net-mvc, model

我有一个控制器操作，它有一个可以为空的 DateTime 作为来自我表单上的文本框的参数之一。我注意到，如果用户在该文本框中输入“blah”，那么我将为 DateTime 参数返回一个 Null 值，并自动添加一个模型错误。在这种情况下，添加的 ModelState 错误是“值 'blah' 无效”。

我的问题是我的网站支持多种语言，所以我需要本地化这个错误。通常我只是自己验证并添加 ModelState 错误，但在这种情况下，我似乎无法摆脱它。如果我为同一个文本框添加另一个 ModelState 错误，它不会出现。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T14:51:35.907

我必须强烈反对您迄今为止收到的所有答案。他们都没有真正回答您提出的问题，即如何本地化 MVC 错误消息。如果您没有真正本地化您的应用程序，您可能会花费大量精力来解决这个问题的单个实例，并且在其他 50 个 MVC 错误消息案例中仍然存在相同的问题。它们在 MvcResources.resx 中定义，该文件位于 MVC 源代码的 Resources 文件夹中（或者只是使用 Reflector 浏览程序集）。特别是，您正在寻找`Common_ValueNotValidForProperty` resource. You would localize these messages by providing a localized satellite assembly, in the same way that you localize any .NET application. The specifics of internationalization/localization in .NET applications are outside of the scope of this answer, but there are many books on the subject. Doing this in MVC is no different than doing it in any other application, except that, in most cases, localizations of the framework are already available. MVC is still in beta, so it is, as far as I know, English-only, at the moment. Presumably, that will change after release.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T23:01:12.590

我会从您传递给 TryUpdateModel/Update 模型的白名单中删除该特定文本框，并“手动”对其进行验证，而不是让框架对其进行验证。或者，您可以尝试遍历 ModelState Error 集合，找到您要删除的那个，然后将其删除——比如说，一旦您确定要删除哪个，就使用 RemoveItem。

**编辑**：如果您使用默认的 ModelBinder，您可以实现自己的。我假设由于您正在生成自己的模型错误，因此您使用的是 TryUpdateModel/UpdateModel。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T23:13:01.673

我可以调用**ModelState.Clear();** 在动作开始时。但是，我不确定我是否喜欢在每个动作中都这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T01:19:14.583

您可以使 DateTime 参数可以为空。然后，如果没有提供任何错误，则不会将错误添加到 ModelState。

```
public ActionResult Method(Datetime? date)
{} 
```

而不是

```
public ActionResult Method(Datetime date)
{} 
```

# html - 在保持 XHTML 1.0 Strict 的同时嵌入 YouTube 视频？

> ID：549875
> 
> 赞同：6
> 
> 时间：2009-02-14T22:07:29.380
> 
> 标签：html, youtube, xhtml-1.0-strict

有没有办法在仍然符合标准（XHTML 1.0 Strict）的同时嵌入 YouTube 视频？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-14T22:12:31.787

闪光沙爹：

[http://www.alistapart.com/articles/flashsatay](http://www.alistapart.com/articles/flashsatay)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-21T19:17:10.207

有一个[Tools4Noobs 网页](http://www.tools4noobs.com/online_tools/youtube_xhtml/)会自动为您从 YouTube 为您提供的嵌入代码转换为有效的 XHTML。您可以选择出现哪些额外按钮并调整边框的外观。它还添加了一个小广告链接，但很容易删除。

以下是 YouTube 生成的示例：

```
<object width="425" height="349">
    <param name="movie" value="http://www.youtube.com/v/AWCHdhyEdCc&hl=en&fs=1&rel=0&color1=0x5d1719&color2=0xcd311b&border=1"></param>
    <param name="allowFullScreen" value="true"></param>
    <param name="allowscriptaccess" value="always"></param>
    <embed src="http://www.youtube.com/v/AWCHdhyEdCc&hl=en&fs=1&rel=0&color1=0x5d1719&color2=0xcd311b&border=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="349"></embed>
</object> 
```

在这里它是由 Tools4Noobs 转换的：

```
<object type="application/x-shockwave-flash" style="width:425px; height:349px;" data="http://www.youtube.com/v/AWCHdhyEdCc?rel=0&amp;fs=1">
    <param name="movie" value="http://www.youtube.com/v/AWCHdhyEdCc?rel=0&amp;fs=1" />
    <param name="allowFullScreen" value="true" />
</object>
<div style="font-size: 0.8em"><a href="http://www.tools4noobs.com/online_tools/youtube_xhtml/">Get your own valid XHTML YouTube embed code</a></div> 
```

只需删除`<div>`最后的广告链接即可摆脱广告链接，您就完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T22:34:55.023

+1 安迪休谟

正要发这个。仅供参考，这在 Firefox 中有效，具体取决于您的支持需求：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>Testing</title></head>
<body>
<div>
<object type="application/x-shockwave-flash" data="http://www.youtube.com/v/2pNTrYd-4FQ&amp;hl=en&amp;fs=1" width="425" height="344">
<param name="movie" value="http://www.youtube.com/v/2pNTrYd-4FQ&amp;hl=en&amp;fs=1" />
</object>
</div>

</body>
</html> 
```

确保转义所有＆符号，我不知道这是否只是因为我试图验证一个只有对象的页面，但它抱怨它需要被一个 div、段落或其他东西包围......

我假设该对象不能在标记中排在第一位。

# asp.net - 性能与代码质量

> ID：549887
> 
> 赞同：12
> 
> 时间：2009-02-14T22:27:06.743
> 
> 标签：asp.net, asp.net-mvc, performance

你认为为了代码质量和可维护性而牺牲一些性能值得吗？我记得 Jeff Atwood 的一篇文章说硬件很便宜，而开发人员则不然。我想我想把它改成“硬件便宜，时间不便宜”。

我注意到我最近一直在从事的一个 MVC 项目，有时我只是试图从我的应用程序中挤出一点额外的性能而失去了 DAYS，我开始认为这不值得。我刚刚发现自己在设计 ASP.NET MVC 应用程序时遇到了麻烦。我非常喜欢 IQueryable，因为它允许我附加到查询中，这样我就可以获得一些流畅的代码来使用它。但是能够做这样的事情似乎增加了控制器/BLL 的责任。

所以你怎么看？在 Web 应用程序的情况下，您是否可以用一些性能来换取可维护/更清洁的代码？您是否认为过早地尝试优化所有可能的东西？因为正如我们所见，您无法预测所有需求。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-14T22:35:39.483

1.  让它起作用
2.  如果性能有问题，请分析并确定问题
3.  解决问题。
4.  如有必要，重复步骤 1-4
5.  ？？？
6.  利润

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-14T22:43:41.790

托尼·霍尔爵士（Sir Tony Hoare）有句名言：“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。”

引文的第一部分几乎被遗忘了（它不会那么容易说出口），因此许多没有经验的工程师在软件项目的设计阶段没有考虑性能。这几乎总是一个致命的错误，因为后来由于基本的设计缺陷，设计糟糕的应用程序很难优化。同时，在性能瓶颈未知的情况下，试图通过使用巧妙的技巧来节省 CPU 周期是没有意义的。

至于您的问题，我认为设计得当、旨在满足其特定性能要求的应用程序不需要以不可维护或“不干净”的方式进行编码。只有当这些性能瓶颈被发现时（例如，您发现您的应用程序将 90% 的时间花费在 10% 的代码中），您可能需要考虑在少量代码中*谨慎*使用优化技巧，以便它保持可维护性和容易明白。

许多 Web 应用程序的伟大之处在于，使用各种缓存技术可以显着提高性能。当您控制服务器环境时（并且，就像您说的，硬件很便宜），您可以确保将 Web 应用程序的那些常用部分缓存出来。如果您使用抽象层，这并不会真正导致无法维护的代码。Facebook 是一个很好的 Web 应用程序示例，该应用程序以利用缓存 (memcached) 为优势而著称。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-14T22:32:40.833

我真的不相信这是非此即彼的。如果您编写干净、简单的代码，并且只按应有的次数执行所有处理，那么您将拥有一些性能最好的代码。真的就是这么简单。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-14T22:33:32.203

显而易见的答案是**视情况而定。** 如果您的应用程序足够慢以至于严重影响可用性，并且您有测量结果证明您的优化确实有帮助，那么牺牲可维护性可能是一个合理的权衡。另一方面，如果您没有测量或应用程序的速度不足以影响可用性，请始终追求可读性、可维护性和灵活性。这归结为过早的优化是万恶之源。

注意：如果您知道性能对您的应用程序很重要，那么设计时算法和架构优化不一定是坏事，但就您的问题而言，您显然是在谈论**微**优化，上述适用。

此外，在您的特定情况下，如果您无法判断您的应用程序是否足够慢而损害可用性，那么现在还为时过早。如果可以，那就不是。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-14T23:13:29.627

所有好的答案。速度和干净代码之间的选择是错误的二分法。

我没见过你工作，但我看过别人，而且总是同样的故事：

**“它不够快。我认为问题出在 XXX 代码中。我想我会调整一下，看看是否有帮助。”**

*   你不**知道**问题出在哪里。
    你**猜**。

*   永远不要根据**猜测**做任何事情。
    （当然**你**永远不会那样做，对吗？但大多数人都会这样做。）

您可以分析代码。

我最喜欢的方法是在它变慢的时候让它停下几次，然后问它到底在做什么。

这通常是一个无法猜到的惊喜。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-14T23:29:13.130

在谈论性能之前，您应该真正了解大 O 表示法，您可以在任何有关算法的书籍或维基百科上查找它。

大 O 表示法说明了一个函数需要多少时间。例如。一个从 0 到 100 的列表，你有 O(N)。无论您对 O 表示法计数多高，都保持不变。此函数具有线性运行时间，无法以任何方式改进。

现在，如果您有一个从 0 到 100 的列表，并且对于该列表中的每个项目，您执行另一个从 0 到 100 的列表，您会得到 O(N^2)，这是工作量的两倍，并且运行时间比 O(N ）。

在编写必须具有良好性能的应用程序时，我们谈论的是使用 O 表示法编写良好的运行时。如果它们使用相同的算法，窗口是使用 <0.1 秒还是 >1 秒并不重要。

这意味着，你所做的几秒钟的剃须可能没有不同的 O 表示法，所以你并没有以任何方式真正优化你的代码 - 所以对你来说，在 asp.net 中编写 MVC，我建议你专注于编写干净而是可读的代码:)

当您了解 O 表示法时，您将能够以在 O 表示法中使用最少运行时间的方式知道要选择哪些算法（如何对列表进行排序、填充、检索数据），并且这些知识可能会使您的代码更多比编写紧密循环的代码节省几秒钟还要快。

马卡克^^

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-14T22:36:27.703

质量（意味着易于阅读）和性能都不是最重要的 - 正确性才是！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-14T22:43:49.667

在一定程度上同意这一点。开发人员的时间成本很高，而分析和优化代码是一种非常昂贵的方法，可能不会获得太多的性能提升。话虽如此，这取决于应用程序的类型和您工作的环境。

如果您正在开发一个 Web 应用程序，那么您可以通过修复一些简单的问题（主要是在客户端）来进行大量改进。与实际分析代码相比，通过连接 CSS/JS 文件、构建图像 sprite 等来减少 HTTP 请求等事情会给您带来巨大的收益，并且可以很好地利用开发人员的时间。

我不知道我是否同意“硬件比开发人员便宜”的报价。当然，硬件可以帮助您扩展您的应用程序并为其提供更多性能，但您最不想做的就是依赖强大的硬件。如果您的软件与硬件的耦合过于紧密，那么您在迁移到新数据中心、升级服务器等方面就会失去很多灵活性……从长远来看，没有这种灵活性可能会付出非常高昂的代价。假设您决定有效扩展应用程序的方法是迁移到 Amazon 的 EC2 基础设施。如果您的应用程序在每台服务器上**需要**32GB 的 RAM，那么您会发现像这样的移动可能需要重新编写。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-14T22:36:09.187

我绝对重视我自己的时间，而***不是服务器端的***应用程序性能。如果我注意到我的网站在数据库请求等方面表现不佳，升级服务器硬件是一种替代解决方案，可以（至少在短期内）解决我的问题而无需查看代码。

但是，如果该应用程序的***网络***效率极低，我会花费相当多的时间来尝试改进这部分。发送大量数据会影响我的用户，无论我对自己的服务器和上行链路做什么 - 如果他们不喜欢性能，他们就不会回来。

但正如其他几个人所说，这不是非此即彼的问题——这在很大程度上取决于情况、性能问题的严重程度、应用程序的位置等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-14T23:17:19.727

质量的标准定义是“符合客户期望（要求）”。如果您已经完成了良好的需求收集，那么您已经同意某些性能标准。如果您的申请符合此标准，那么您就是在浪费您或客户的时间和金钱来试图做得更好。

编写松散耦合、内聚且易于阅读的代码只会降低与错误和需求更改相关的风险和成本。如果您准备接受“泥球”编码的风险，那就继续吧。我，我喜欢赚钱。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-15T01:12:52.010

*好的设计*通常会牺牲一些性能来改进整个程序。例如，*分层*编写代码是有成本的，但无论如何我们都会这样做，因为从长远来看，它可以更容易地更改代码。我们远程使用应用服务器，不是因为它是最有效的方式，而是因为它可以扩展。

我记得在[Code Complete 2](http://cc2e.com/)中，McConnell 确实给出了一个示例，其中使代码难以阅读是必要的优化。该特定示例是加密算法。该程序被制成一种方法，以消除调用函数的开销。所以，这确实是有时间和地点的，但我相信很少见。

至于解决性能问题，在大多数情况下，我发现性能问题要么与数据库/IO 相关，要么与（内存泄漏）有关。正如其他人所建议的那样，分析是要走的路，尽管追踪许多错误仍然很棘手。

至于硬件问题，硬件有所放松，但并未消除对优化代码的需求。更快的硬件实际上只允许我们使用不太理想的语言并做非常好的 GUI 东西。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-09T16:09:20.330

这是性能与可支持性之间的经典权衡之一。在编写 COBOL 结构化代码时（在 1980 年代初期），我第一次遇到了这种权衡。很明显，通过将所有内容分离到可重用的模块中，创建了额外的分支和堆栈指针管理，而在早期的计算机上，这会降低性能。答案是将函数组合在一起（并复制某些函数），以减少用于调用模块的代码交换和堆栈指针操作。这导致了可支持性问题。

继续前进，最近，我不得不对数据库进行反规范化以创建可以缓存的大型对象。这里的问题是在 CRM 系统导航期间读取角色和职责的访问权限。长话短说，标准化版本处理和加载每个屏幕的时间太长了，所以 30 年过去了，我仍然参与这个经典的权衡。

# c++ - 哪个维基解析器？

> ID：549894
> 
> 赞同：6
> 
> 时间：2009-02-14T22:29:31.933
> 
> 标签：c++, c, wiki, mediawiki, parsing

有谁知道可以将 Wiki 格式的文本作为输入并生成实体树的解析器，就像 XML 解析器生成实体树一样？为了澄清，我正在寻找一些可以接受如下文字的东西：

```
 -Intro-
 Textual stuff in ''italics''
 --Subhead--
 Yet more text 
```

并生成一棵以 Intro 为根的树，其中包含三个子节点，其中一个 (Subhead) 本身有一个子节点。我正在寻找可以理解[http://meta.wikimedia.org/wiki/Help:Wikitext](http://meta.wikimedia.org/wiki/Help:Wikitext)中描述的“简单”wiki 格式的东西。

我知道 Wiki 文本有几个词法分析器，但没有树解析器。我正在寻找开源并用 C 或 C++ 编写的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T08:28:52.620

我会做的是

1.  为该 wiki 语言编写 BNF 语法。因为它很简单，所以 BNF 也很简单。
2.  使用[Spirit Framework](http://www.boost.org/doc/libs/release/libs/spirit/index.html)为其创建解析器。它真的很简单（对于那些简单的事情），BNF 语法如此自然地翻译成 C++。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T08:45:59.117

我编写了一个解析器，它在 Java 内部创建了这样一棵树： [Java Wikipedia API](http://matheclipse.org/en/Java_Wikipedia_API)

也许您可以为您的 C 或 C++ 实现获得一些想法？

[HTMLConverter 类](http://code.google.com/p/gwtwiki/source/browse/trunk/info.bliki.wiki/bliki-core/src/main/java/info/bliki/wiki/filter/HTMLConverter.java)采用内部节点树将其转换为 HTML 标记。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T03:44:33.813

您不能直接从 wiki 格式的页面执行此操作，因为 wiki 格式没有完整的信息。相反，wiki 格式的文本基本上由一堆正则表达式规则翻译，并插入到 HTML 或 XHTML 的预定义页面框架中。

做你想做的最简单的方法是为一些轻量级文本格式（如纺织品或克里奥尔语）找到合适的格式化程序，将其传递给生成 XHTML，然后使用任何常规解析器解析 XHTML。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-22T03:13:45.020

您可能想看看[Mylyn WikiText](http://wiki.eclipse.org/Mylyn/FAQ#WikiText)，它是一个使用 Builder 设计模式将 wiki 标记转换为各种 XML 格式的解析器。它附带了用于 HTML、Eclipse 帮助、DITA 和 DocBook 的构建器。您可以使用自己的构建器来自定义输出。

解析器可以处理 Textile、MediaWiki、TracWiki、TWiki 和 Confluence 标记。它是可扩展的，因此您可以根据需要添加新语言。

库是Java

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T04:59:20.840

你可能会从这个 Perl 模块中得到一些想法：

[http://search.cpan.org/dist/HTML-WikiConverter-MediaWiki/](http://search.cpan.org/dist/HTML-WikiConverter-MediaWiki/)

我知道您正在寻找 C/C++，但是，嘿，您可能会得到一些好处。

# asp.net - ASP.NET Web 服务中 XML 文档中的非法字符

> ID：549896
> 
> 赞同：5
> 
> 时间：2009-02-14T22:31:38.700
> 
> 标签：asp.net, xml, web-services, serialization

我要问并回答我自己的问题，我希望没人介意，但我认为这对其他人可能有用。

如果您设置的 ASP.NET Web 服务返回的对象包含对 XML 无效的字符，则在将对象序列化为 SOAP xml 并且客户端尝试反序列化该 xml 后，将引发异常。

你如何解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-14T22:34:58.910

为了解决这个问题，我使用属于 .NET 的 wsdl.exe 应用程序为我的 web 服务生成了类文件。这很简单，只需在命令提示符下键入`wsdl.exe <path to webservice>`

生成之后我重载了方法

```
protected XmlReader GetReaderForMessage(SoapClientMessage message, int bufferSize) 
```

像这样

```
protected override XmlReader GetReaderForMessage(SoapClientMessage message, int bufferSize)
{
    XmlReaderSettings settings = new XmlReaderSettings();
    settings.CheckCharacters = false;
    return XmlTextReader.Create(message.Stream, settings);
} 
```

这告诉 XmlTextReader 忽略它正在读取的 XML 文件的有效性。当我要立即反序列化它时，我没有理由关心 xml 是否有效。

希望这可以帮助有同样问题的人！

# ruby - 检查多维数组中子数组大小是否相等的最优雅方法？

> ID：549907
> 
> 赞同：2
> 
> 时间：2009-02-14T22:36:03.243
> 
> 标签：ruby, arrays, multidimensional-array, comparison

（你能告诉我今天正在学习 Ruby 吗？:)）

我想确定我正在使用的多维数组是否是“矩形”——即，行的大小相同。这就是我正在做的，它有效，但感觉很笨重。

```
if @myArray[0].size != @myArray[0..@myArray.size].size
  raise "This array is not a rectangle."
end 
```

基本上，我正在检查第一个数组的大小是否等于所有其他数组的大小。不知何故，这似乎还不够“红宝石”，你知道吗？有人有更优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-14T22:56:14.537

尝试：

```
raise 'This array is not a rectangle' \
  if myArray[1..-1].any? { |row| row.size != myArray[0].size } 
```

请参阅[http://www.ruby-doc.org/core/classes/Array.html](http://www.ruby-doc.org/core/classes/Array.html)（[] 运算符）和[http://www.ruby-doc.org/core/classes/Enumerable.html（any](http://www.ruby-doc.org/core/classes/Enumerable.html) ?方法）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T22:58:19.773

这不会引发错误：

```
@my_array = [[1,2,3,4],[1,2,3,4]]
for row in @my_array
  if row.size != @my_array.first.size
    raise "This array is not a rectangle"
  end
end 
```

这将引发错误：

```
@my_array = [[1,2,3,4],[1,2,3]]
for row in @my_array
  if row.size != @my_array.first.size
    raise "This array is not a rectangle"
  end
end 
```

此代码遍历数组内的所有子数组，并检查它们的行大小是否与第一个的大小不同，如果是这种情况，则会引发错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T23:33:28.800

我可能会做其他人发布的事情，或者

```
if 1 == @myArray.map { |row| row.size }.uniq.size
     # ...
end 
```

您应该注意，您的示例代码并没有按照您的想法执行

```
# this creates an array that holds a slice
# of elements from @myArray ( a to b inclusive )
@myArray[ a .. b ]
# this just gets the size of the slice
# (equal to b-a+1)
@myArray[a .. b].size 
```

因此，您的 if 语句实际上将行大小与列大小进行了比较（加 1，因为它是 0 到 @myArray.size 包括在内）。它没有将每一行的大小与第一行进行比较。为此，您需要使用 each、map 或其他方法显式迭代。

# c# - 我需要 C# winforms 的拖放控件

> ID：549911
> 
> 赞同：1
> 
> 时间：2009-02-14T22:37:55.860
> 
> 标签：c#, winforms, drag-and-drop

我正在寻找可以包含其他控件、处理布局并允许拖放重新排列布局顺序的 C# 控件。

类似于 iphone/ipod 允许您重新排列应用程序的方式。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T22:55:33.617

我认为您可以使用 FlowLayoutPanel 和 MouseUp、MouseDown、MouseMove 事件轻松实现您自己的控件，您可以在其中大致更改 Location 属性并且 FlowLayoutPanel 应该处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T23:00:05.260

使用像[DockPanelSuite](http://sourceforge.net/projects/dockpanelsuite)这样的东西作为基础可能是一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T23:42:10.167

只需创建自己的。您可以通过调用控件的 DoDragDrop() 方法来启动 DragDrop 操作（通常在 OnMouseDown 中）。您可以覆盖将接受拖动对象的控件的 OnDragOver 和 OnDragDrop 方法。调整大小已经内置，您只需要设置属性（给定，这可能有点痛苦。）

# git - 是否可以在 Git 中为分支起别名？

> ID：549920
> 
> 赞同：73
> 
> 时间：2009-02-14T22:45:04.767
> 
> 标签：git, version-control, build-automation

我正在研究大规模使用 Git。`master`我希望通过调用分支来增加采用率并使事情变得更容易`trunk`。

这可以而且会给 SVN 用户一些舒适的感觉。我知道我可以创建一个名为 的分支`trunk`，但这似乎偏离了 Git 规范，可能会导致一些用户感到困惑。

我知道我也可以根据自己的喜好创建和删除标签，但是当我签出这些标签时，它告诉我这是一个非本地分支，这对我来说很好，但可能不是我想做的。

我是一个完全的 Git 新手，但在发布和构建系统方面经验丰富的专业人士。

**我想要做的是能够呼叫主干线。** 我已经看到了别名命令的能力——这是否也适用于版本化对象的名称？

我知道`git-svn`存在和其他工具，但分层存储库系统的开销让我害怕。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-02-14T23:07:12.997

您可以按照 Greg 的建议重命名主分支主干，或者您也可以创建一个主干作为对主分支的符号引用，以便 git 和 svn 用户都拥有他们习惯的“主”分支。

```
git symbolic-ref refs/heads/trunk refs/heads/master 
```

请注意，主干不是一等公民。如果您结帐`trunk`并执行，`git status`您实际上会在`master`，但是您可以`trunk`在所有使用分支名称的地方（日志、合并等）使用该命令。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-14T22:47:20.220

Git 中的“master”这个名字并没有什么特别之处，它只是按照惯例（默认情况下）这样称呼它。如果你喜欢，你当然可以称它为“主干”：

```
git branch -m master trunk 
```

这与 Subversion 非常相似，其中“trunk”这个名称也只是按照惯例来命名。您可以在 Subversion 中将主分支称为“master”。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-05-08T04:28:32.887

这是查尔斯贝利回答中显示的技术的安全包装。

```
$ git branch-alias <alias> <long-and-unwieldy-branch-name> # create alias
$ git branch-alias <alias> # create alias for current branch
$ git branch # view branches and branch aliases
$ git log <alias>
$ git checkout <alias>
$ git push origin <alias> # pushes the branch, not the alias/reference
$ git branch-alias -d <alias> # delete an alias safely
$ git branch-alias -h # help / usage details 
```

请注意，git 版本 2.7.0 - 2.8.2（含）中的一个错误导致“git 分支”显示“别名 -> 别名”而不是“别名 -> 分支”作为分支别名。如果您受到该错误的影响，我建议升级到 2.8.3 或更高版本。

```
#!/bin/sh
# git branch-alias
# Author: Phil S.
# Version 1.13.1
version=1.13.1

# Creates branch aliases, so that you can refer to a long branch name
# by a convenient short alias.  This is particularly useful for branch
# names beginning with bug-tracker ID numbers (or similar), where the
# benefits of tab-completion are greatly reduced.

# This is mostly a "do what I mean" wrapper around "git symbolic-ref",
# with numerous safety measures included in order to eliminate the
# (otherwise considerable) risk of trashing a branch if you get your
# arguments wrong.

# Installation:
# Place this script somewhere in your PATH and name it "git-branch-alias"
# and you will be able to invoke it with "git branch-alias" as per the
# following examples.  If you have obtained the script from the git
# mailing list, please see the "Mailing list archives" note below.

# Examples:
# git branch-alias <alias> <long-and-unwieldy-branch-name> # create alias
# git branch-alias <alias> # create alias for current branch
# git branch # view branches and branch aliases
# git log <alias>
# git checkout <alias>
# git push origin <alias> # pushes the branch, not the alias/reference
# git branch-alias -d <alias> # delete an alias safely
# git branch-alias -h # help / usage details

# Caveats:
# Although everything else I've tried works seamlessly, I note that
# git merge <alias> will cause the alias name to be mentioned in the
# commit message, rather than the name of the real branch.  It would
# be nicer if the branch name appeared.

# Compatibility:
# Originally developed with git version 1.7.12.4
# Also tested with git versions 1.9.0, 2.5.4, 2.6.6, 2.8.3
#
# Related git changes between versions 1.7.12.4 and 2.8.3:
# git v1.8.0.1
#  * A symbolic ref refs/heads/SYM was not correctly removed with "git
#    branch -d SYM"; the command removed the ref pointed by SYM
#    instead.
#
# git v1.8.1
#  * "git symbolic-ref" learned the "-d $symref" option to delete the
#    named symbolic ref, which is more intuitive way to spell it than
#    "update-ref -d --no-deref $symref".
#
# git v2.6.5
#  * "git symbolic-ref" forgot to report a failure with its exit status.
#
#  I believe this is commit 3e4068ed90fd3c6f24303560113aae6dbb758699:
#  > symbolic-ref: propagate error code from create_symref()
#  > If create_symref() fails, git-symbolic-ref will still exit with
#  > code 0, and our caller has no idea that the command did nothing.
#  > This appears to have been broken since the beginning of time
#
#  As this affects symref creation only, the sole adverse effect here
#  would be an unintended message to the user if symref creation had
#  actually failed (but not even a misleading one, on account of our
#  reading the reference after its creation, and thus displaying an
#  error if it turned out to be invalid).
#
# git v2.8.3
#  * A change back in version 2.7 to "git branch" broke display of a
#    symbolic ref in a non-standard place in the refs/ hierarchy (we
#    expect symbolic refs to appear in refs/remotes/*/HEAD to point at
#    the primary branch the remote has, and as .git/HEAD to point at the
#    branch we locally checked out).
#
#  This caused "git branch" to display "ref -> ref" instead of "ref -> branch"
#  for branch aliases.  The functionality still works otherwise, but is not
#  nearly so convenient to work with when you cannot trivially see what each
#  alias points to.  This bug affected git versions 2.7.0 - 2.8.2 (inclusive).

# Change log:
# v1.13.1
# Change incorrect uses of git show-ref, introduced by v1.10 (including
# effective regression of v1.08), to use git symbolic-ref instead.
#
# v1.12:
# Fix the option handling for '--', and added it to the help text.
#
# v1.11:
# Minor tidy-ups.  Re-posted to git mailing list:
# https://www.mail-archive.com/git%40vger.kernel.org/msg161274.html
#
# v1.10:
# No longer dependent on refs existing as individual files, as they
# may be packed in .git/packed-refs.
#
# v1.09:
# POSIX-compatible option handling and output.
# Documented an issue with "git branch" in git versions 2.7.0 - 2.8.2.
#
# v1.08:
# Remove test git show-ref --verify --heads --quiet "refs/heads/${symref}"
# for asserting that the specified reference was valid before deleting a
# reference, as we need to permit the deletion of references to branches
# which have /already/ been deleted, and this test prevented that.
# n.b. We already had another validation test to fall back on, using
# git symbolic-ref "refs/heads/${symref}"
#
# v1.07:
# Minor tweaks.  Posted as feature-request to git mailing list:
# https://www.mail-archive.com/git%40vger.kernel.org/msg49171.html

# Mailing list archives:
# If you are reading this via the git mailing list archives at gmane.org
# then this code will probably be broken by an email obfuscation filter
# which automatically converts the symbol '@' to the string ' <at> '.
# Specifically the shell positional parameter expansion "$@" is changed
# to "$ <at> "), so don't try to use the version from gmane.  The copy
# of this message at http://www.mail-archive.com/git%40vger.kernel.org/
# should have the correct code.

command=$(basename $0)
if [ "${command##git-}" != "${command}" ]; then
    command="git ${command##git-}"
fi

# Print argument (and newline) to stdout or stderr.
stdout () {
    printf %s\\n "$1"
}
stderr () {
    printf %s\\n "$1" >&2
}

# Returns the supplied parameters suitably quoted for later evaluation.
quote () {
    for param; do
        printf %s "${param}Z" | sed "s/'/'\\\\''/g;1s/^/'/;\$s/Z\$/' /"
    done
}

# Process option parameters.
parameters=
while [ $# -gt 0 ]; do
    case "$1" in
        ( -- ) {
            shift
            parameters="${parameters}$(quote "$@")"
            break
        };;
        ( -v | --version ) version_help=1; shift;;
        ( -h | --help    ) help=1; shift;;
        ( -d | --delete  ) delete=1; shift;;
        ( -* ) {
            stdout "Invalid option: $1"
            stdout
            shorthelp=1
            shift
        };;
        ( * ) { # non-option parameter
            parameters="${parameters}$(quote "$1")"
            shift
        };;
    esac
done

# Process non-option parameters.
eval "set -- ${parameters}"
symref=$1
branch=$2

# If too few or too many parameters were supplied, display shorthelp.
if [ -z "${symref}" ] || [ -n "$3" ]; then
    shorthelp=1
fi

# If displaying the version, exit immediately.
if [ -n "${version_help}" ]; then
    stdout "${command} version ${version}"
    exit 0
fi

# Don't let short help override long help.
if [ -n "${help}" ]; then
    shorthelp=
fi

# Include the usage summary in both short and long help.
if [ -n "${help}" ] || [ -n "${shorthelp}" ]; then
    cat <<EOF
Usage:
${command} [--] <alias> [<branch>]
${command} (-d | --delete) [--] <alias>
${command} (-v | --version)

EOF
fi

# n.b. Calling "git branch-alias --help" causes git to look for
# a man page for "git-branch-alias", so we shouldn't advertise
# the long option (although we support it if the script is called
# by its real name, rather than via git).
if [ -n "${shorthelp}" ]; then
    cat <<EOF
For help, use: ${command} -h

EOF
    exit 0
fi

# Detailed help.
if [ -n "${help}" ]; then
    cat <<EOF
Creates a symbolic reference <alias> referring to <branch>.
<branch> defaults to the current checked-out branch.

This symbolic reference acts as an alias for <branch>, and can be
used in its place.  More specifically, it WILL be dereferenced to
its target in nearly all situations, so for any given command you
should treat every usage of <alias> as if it were actually <branch>.

If either <alias> or <branch> begins with a hyphen, you can use the
'--' option to prevent subsequent arguments being treated as options.

To safely delete a branch alias, always use:
${command} -d <alias>

WARNING: These symbolic references appear in your branch list as:
 <alias> -> <branch>
and so you might be tempted to try to delete them like a branch:
 git branch -d <alias>

However this can cause problems.  In git versions prior to 1.8.0.1
<alias> will be dereferenced and you will instead delete the
branch it refers to (git will allow this even if you currently
have that branch checked out), and the symbolic reference will
still remain (referencing a branch which is no longer available).

In later versions of git the <alias> will be deleted rather than
the branch; however git will still not check to see whether you
currently have <alias> checked out, and will not prevent you
from deleting it in that situation.  This will leave your HEAD ref
in an invalid state.  Using ${command} -d <alias> resolves
this situation by first switching HEAD to <alias>'s target branch
if HEAD was currently set to <alias>.

EOF
    exit 0
fi

# Confirm the CWD is within a git repository.
#cwd=$(git rev-parse --show-toplevel)
git=$(git rev-parse --git-dir)
if [ $? -ne 0 ]; then
    exit 1
fi

# Use the current branch by default.
if [ -z "${branch}" ]; then
    branch=$(git symbolic-ref -q HEAD)
    if [ $? -ne 0 ]; then
        stderr "Could not establish current HEAD."
        exit 1
    fi
fi

# We expect plain branch names, but also accept the fully-qualified
# (refs/heads/NAME) paths needed by git symbolic-ref; so strip that
# refs/heads/ prefix if it is specified.
branch=${branch##refs/heads/}
symref=${symref##refs/heads/}

# Deleting a symref.
if [ -n "${delete}" ]; then
    # Verify that it IS a symbolic reference.
    if ! git symbolic-ref "refs/heads/${symref}" >/dev/null; then
        stderr "Error validating refs/heads/${symref} as symbolic reference."
        exit 1
    fi

    # If we currently have <symref> checked out, deleting it is bad
    # (as HEAD would no longer be a valid reference).  I believe we do
    # need to inspect the file here, as attempting to read the HEAD
    # reference via git dereferences it to its target branch, and thus
    # we are unable to distinguish between the branch and the symref.
    if grep "^ref: refs/heads/${symref}\$" "${git}/HEAD" >/dev/null 2>&1; then
        stdout "Cannot delete the currently checked out symbolic reference."
        branch=$(git symbolic-ref -q HEAD)
        if [ $? -ne 0 ]; then
            stderr "Could not establish current HEAD."
            exit 1
        fi
        stdout "Switching HEAD to target branch ${branch}"
        # By using git symbolic-ref HEAD to find the target ref
        # and setting HEAD to that target, nothing really changes,
        # but we can now delete the reference safely.
        if ! git symbolic-ref HEAD "${branch}"; then
            stderr "Error updating HEAD from ${symref} to ${branch}"
            stderr "Aborting."
            exit 1
        fi
    fi

    # Delete the reference.
    # git 1.8.1+ provides: git symbolic-ref --delete <symref>
    # but older versions do not include that option, so we use
    # the backwards-compatible command.
    stdout "Deleting symbolic reference refs/heads/${symref}"
    git update-ref -d --no-deref "refs/heads/${symref}"
    exit $?
fi

# Creating a new symbolic reference.

# Error checking.  git symbolic-ref doesn't really do any, and will
# happily mess up your branches; particularly if you get the arguments
# the wrong way around (treating it like ln -s is a really bad idea).
if ! git show-ref --verify --heads --quiet "refs/heads/${branch}"; then
    stderr "Target branch refs/heads/${branch} does not exist."
    exit 1
fi
if target=$(git symbolic-ref -q "refs/heads/${symref}"); then
    stderr "Symbolic reference refs/heads/${symref} already exists:"
    stderr "  ${symref} -> ${target##refs/heads/}"
    stderr "To delete it, use: ${command} -d ${symref}"
    exit 1
elif git show-ref --verify --heads --quiet "refs/heads/${symref}"; then
    stderr "Reference refs/heads/${symref} already exists"
    stderr "(and is not a symbolic reference!)"
    exit 1
fi

# The parameters are good.
# Generate the reference and display the confirmed result.
if git symbolic-ref "refs/heads/${symref}" "refs/heads/${branch}"; then
    target=$(git symbolic-ref "refs/heads/${symref}")
    stdout "  ${symref} -> ${target##refs/heads/}"
else
    stderr "Failed to create branch alias."
    exit 1
fi
# EOF 
```

上游功能请求： [https ://www.mail-archive.com/git@vger.kernel.org/msg161274.html](https://www.mail-archive.com/git@vger.kernel.org/msg161274.html)

# java - 休眠：从列表中删除项目不会持续存在

> ID：549961
> 
> 赞同：18
> 
> 时间：2009-02-14T23:13:44.090
> 
> 标签：java, hibernate

从列表中删除项目时遇到问题。该列表在超类中定义，但 Hibernate 注释应用于子类中的属性访问器。超类中有两种方法可以操作列表。“添加”方法工作正常，但“删除”不会持续更改。我已经检查了我的 Cascade 设置，我似乎有正确的事情。我在做一些不可能的事情。如果没有，我是不是做错了什么？

这是我的课程：

```
@Entity 
abstract class Temporal<T> { 
    @Id 
    @GeneratedValue 
    private Long id; 

    @Version 
    private Integer version = null; 

    @Transient 
    protected List<T> content = new ArrayList<T>(); 

    public void remove(T value) { 
        // business logic ... 
        content.remove(value); 
    } 

    public void add(T value) { 
        // business logic ... 
        content.add(value); 
    } 
} 

@Entity 
@AccessType("property") 
class TemporalAsset extends Temporal<Asset> { 
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "temporal") 
    public List<Asset> getContent() { 
        return super.content; 
    } 

    protected void setContent(List<Asset> list) { 
        super.content = list; 
    } 
} 
```

我使用 TemporalAsset 类的一个实例，如下所示（请注意，我只使用“刷新”方法来演示该行为。即使我刷新或关闭会话并打开一个新会话，该列表也不会正确保留）：

```
temporalAsset.add(value1); 
temporalAsset.getContent().size() == 1; // true 
session.update(temporalAsset); 

session.refresh(temporalAsset); 

temporalAsset.getContent().size() == 1; // true 

temporalAsset.remove(value1); 
temporalAsset.getContent().size() == 0; // true 
session.update(temporalAsset); 

session.refresh(temporalAsset); 

temporalAsset.getContent().size() == 0; // false, its 1 
```

谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-15T07:01:28.053

您必须将级联显式指定为 CascadeType.DELETE_ORPHAN。

尝试将代码更改为

```
@OneToMany    
@Cascade(cascade = {CascadeType.ALL, CascadeType.DELETE_ORPHAN}, mappedBy = "temporal") 
```

部分来自休眠[文档](http://www.hibernate.org/hib_docs/entitymanager/reference/en/html/objectstate.html)：

> 如果子对象的生命周期受限于父对象的生命周期，则通过指定 CascadeType.ALL 和 org.hibernate.annotations.CascadeType.DELETE_ORPHAN 使父对象成为完整的生命周期对象（有关孤儿的语义，请参阅 Hibernate 参考指南删除）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T23:23:44.220

尝试删除对 Session.refresh() 的调用。从文档：

> 从底层数据库重新读取给定实例的状态。不建议使用它来实现跨越许多业务任务的长时间运行的会话。但是，这种方法在某些特殊情况下很有用。例如
> 
> *   数据库触发器在插入或更新时更改对象状态
> *   在同一会话中执行直接 SQL（例如大规模更新）后
> *   插入 Blob 或 Clob 后

[http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Session.html#refresh(java.lang.Object)](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Session.html#refresh(java.lang.Object))

如果您在 refresh() 之前调用 flush()，那也可能会解决问题，因为 flush() 保证将针对 DB 执行任何挂起的 SQL。在实践中，我几乎从未见过有人使用 refresh() 并且从您的代码中看起来并不需要它。

文档中的这一章值得一读：

[http://www.hibernate.org/hib_docs/v3/reference/en/html/objectstate.html](http://www.hibernate.org/hib_docs/v3/reference/en/html/objectstate.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-17T03:06:38.033

这是目前推荐的方式。

```
@OneToMany(mappedBy = "temporal", orphanRemoval = true, cascade = CascadeType.ALL) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T19:19:13.117

您已在超类中将“内容”字段标记为瞬态。我至少会怀疑这会导致问题。使用子类中的映射，您现在基本上对同一属性有两个相互矛盾的映射。

# objective-c - Objective C 中的实例变量/方法参数命名

> ID：549962
> 
> 赞同：15
> 
> 时间：2009-02-14T23:14:22.527
> 
> 标签：objective-c, naming-conventions, coding-style, prefix

对于实例变量和方法参数的命名，这里的人们遵循什么约定 - 特别是当方法参数用于设置 ivars（实例变量）时？

在 C++ 中，我经常使用`m_`ivars 的前缀。在 C# 中，我遵循纯粹通过使用`this.`for ivars 来消除歧义的约定。从那以后，我也采用了 C++ 中的等价物（`this->`）。

在 Objective C 中，我尝试了一些东西，但没有一个看起来真的令人满意。

除非有人提出非常好的建议，否则我将不得不妥协（但请不要让我使用`the`args 的前缀！），所以我很想听听大多数人的意见 - 特别是来自那些已经使用 ObjC 一段时间的人。

在发布此内容之前，我做了一些尽职调查，并在其中找到了一些很好的资源：

*   [本风格指南](http://cocoadevcentral.com/articles/000083.php)（简要提及我的主题）
*   [这个线程](http://www.cocoabuilder.com/archive/message/cocoa/2008/4/3/203139)（那里有很多前 C++ 编码员）

他们给了我一些想法，但我仍然很想听听其他人在做什么。

[编辑] 澄清一下：这就是你如何区分 ivars 和我正在寻找的方法 args 的方式——无论是通过前缀还是其他一些技术。

[编辑 2] 感谢所有回复和讨论点。我没有结束这个，但我只想说，正如我在对已接受答案的评论中指出的那样，我已经采用了在 init args 前加上前缀的约定`the`（以及在 setter args 前加上`new`，无论如何我都在这样做）。这似乎是力量的最佳平衡——即使我自己并不热衷于美学。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-15T05:19:50.107

正如您所指出的，Cocoa 风格是使用方法参数名称，例如`theValue`参数名称是否会与实例变量冲突。然而，这在 Objective-C 2.0 风格的代码中应该不会出现很多次。假设是您不应该（通常）直接访问实例变量。这主要是因为这样做绕过了 Cocoa 中的 Key-Value Observing 机制。相反，期望是您将通过 getter/setter 方法访问和改变属性。在 Objective-C 2.0 中，很容易声明这些属性并自动`@synthesize`生成 getter/setter，因此没有太多理由不使用它们。事实上，在 64 位系统上，运行时会自动为您创建实例变量，无需声明它们并减少使用它们的冲动。

您应该直接访问实例变量的唯一一次是在`-init`和`-dealloc`方法中：

```
@interface MyObject : NSObject 
{
  id ivar;
}

@property (retain,readwrite) id ivar; //or whatever retain/copy/assign and read/readwrite makes sense
@end

@implementation MyObject
@synthesize ivar;

- (id)initWithIvar:(id)theIvar {
  if(self = [super init]) {
    ivar = theIvar;
  }

  return self;
}

- (void)dealloc {
  [ivar release];
} 
```

在这些情况下应该直接使用 ivar 的原因是因为 getter/setter 可能具有依赖于完全初始化的实例的副作用，从而使它们在对象的状态完全初始化`-init`的`-dealloc`地方很危险。在所有其他情况下，您应该使用`self.ivar`（或`[self ivar]`和`[self setIvar:newValue]`）。

似乎其他方法不`-initWithXX`应该有命名冲突。如果他们这样做了，不应该将它们重构为没有该参数或让 Class 没有实例变量吗？

这仅留下`-initWithXX`您经常会在参数和 ivars 之间发现冲突的方法。对于这种情况，如果您真的无法忍受 Cocoa 风格，您可以使用您提到的任何方法。以`_`作品为前缀并且相对常见（我相信`@synthesize`'d setter 和 getter 在这种情况下会自动做正确的事情，但您可能必须明确地将 the 设置`_ivar`为支持）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T07:05:03.297

[在这里](http://google-styleguide.googlecode.com/svn/trunk/objcguide.xml)完成所有已知的 Objective-C 样式指南是 google 版本。他们所做的是在成员 varname 之后添加下划线。例如`BOOL isActive_;`.
所以做出选择并坚持下去。我也更喜欢我的应用程序的“_”前缀。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T23:37:00.290

以下是[Apple 的做法](http://developer.apple.com/documentation/Cocoa/Conceptual/CodingGuidelines/Articles/NamingIvarsAndTypes.html#//apple_ref/doc/uid/20001284-BAJGIIJE)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T06:19:44.113

Apple 制作的示例代码通常使用“_”前缀。我想我也看到了一些使用`mFoo`or `m_foo`。有些人根本不关心前缀，只使用普通名称，但是稍后会变得混乱。通常在定义方法参数时，命名约定是使用“a”、“an”、“the”或“new”前缀。例如：

```
@interface Foo : NSObject {
    id _bar;
}
@property (nonatomic, retain) id bar;

- (id) initWithBar:(id)aBar;

@end

@implementation Foo
@synthesize bar = _bar;

- (id) initWithBar:(id)aBar {
    self = [super init];
    if(self != nil) {
        _bar = aBar;
    }
    return self;
}

@end 
```

我发现这个约定很好用。我以前不关心前缀，但这有时会让事情变得混乱。使用前缀清楚地表明它是一个实例变量。Apple 在其 (iPhone) 示例代码中使用了该`@synthesize bar = _bar`约定。

无论如何，通常不会使用实例变量，因此如果您发现“_”前缀令人讨厌，那也没关系，因为无论如何您都会使用`[self bar]`（或者`self.bar`如果您喜欢那种东西）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-09T15:02:42.900

Obj-C 并没有像许多其他语言那样严格地定义“风格”，这可能是一件好事，也可能是一件坏事，但这意味着你大部分时间都需要靠自己找到一种好的编码风格。

您还可以通过 self. 因此，如果您有一个实例变量 test，您可以通过 self->test 访问它，这是合法的并且将始终有效。不过，在大多数 Obj-C 程序员眼中，它并不漂亮。它泄露了“秘密”，即对象实际上只是结构（更准确地说，对象引用是指向结构的指针），而实例变量实际上是结构成员。并不是说这真的是秘密，但 Obj-C 程序员似乎更喜欢在他们的代码中“隐藏”这个事实。

在名称中使用下划线“_”是一个非常糟糕的主意。这里有人指出，Apple 为他们的代码保留了下划线，但实际上 GCC 已经为符号名称保留了下划线。更准确地说，ANSI-C 标准已经规定以两个下划线或一个下划线和一个大写字母开头的变量保留供编译器内部使用。所以使用一个下划线在理论上是有效的，但是不小心以大写字母开头的名字就失效了。

到目前为止，我尝试使用前缀 my, myName 代替 name，并使用前缀 self, selfName 代替 name；起初看起来都有些奇怪，但在一大段代码中看起来并不算太糟糕。至少立即引起了人们的注意，因为它是“不同的”。我也只是尝试了一个“i”，用 iName 代替 name（或用 iname 代替 name），但我对那个解决方案不是很满意。

不过，我从来没有浪费时间考虑方法参数。因为这并不重要。这些变量与任何其他变量一样，除非它们被声明为常量。它们甚至可以在方法中重新用于其他目的，因为它不会影响调用者。例如

```
- (NSImage *)loadImage:(int)imageNumber
{
  NSImage * res;

  // Some code that assigns a value to res
  // ...  

  // Re-use imageNumber for a different purpose
  for (imageNumber = 0; ...; ...) {
     // Some code
  }

  return res;
} 
```

我认为该代码没有问题。只要名称仍然有意义，为什么我必须为此声明第二个堆栈变量（如果我没有在 for 循环中按数字迭代图像，那么名称当然没有意义，在这种情况下我会使用一个不同的变量 - 编译器实际上可能只为两者保留一个 int 堆栈）。

# installation - 我是否希望能够在我的虚拟机中使用仅主机网络？

> ID：549963
> 
> 赞同：0
> 
> 时间：2009-02-14T23:14:39.767
> 
> 标签：installation, vmware-server

在安装 vmware 服务器时，有人问我

> 您希望能够在虚拟机中使用仅主机网络吗？[是的]

他们是什么意思？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T23:29:57.700

[仅主机网络创建一个完全包含在主机计算机中的网络。](http://www.vmware.com/support/ws5/doc/ws_net_configurations_hostonly.html)

对不起，所以。先忘了谷歌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T23:36:45.237

实际上，我发现 NAT 网络在实践中非常有用。如果你有一个需要更新的虚拟机，或者从网上获取偶尔的包。这太方便了，我再也不会创建仅主机的虚拟机了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T23:37:38.760

仅主机网络是一种限制 VM 与外界通信的网络能力的方法。这意味着虚拟机只能与主机通信。

我很少发现需要它，因为我几乎总是希望客人能够访问整个互联网，而不仅仅是主机。

但是，要问的问题是：您是否要**允许**仅主机联网？您仍然不会被迫将它用于所有虚拟机，所以我会说是的。您仍然可以将 VM 配置为完全访问。

# c# - 如何解决“找不到类型或命名空间”编译错误？

> ID：549965
> 
> 赞同：3
> 
> 时间：2009-02-14T23:16:08.390
> 
> 标签：c#, asp.net, web

我担心我支付的虚拟主机配置不正确。在我的本地计算机上正确编译和运行的 ASP.NET 网站一旦部署就无法工作。

我正在处理的问题是编译错误：CS0246，“找不到类型或命名空间（您是否缺少“使用”指令或程序集引用？）

我的网站包含以下文件和文件夹：

```
websitedemo/Default.aspx
websitedemo/Default.aspx.cs
websitedemo/App_Code/HelloClass.cs 
```

如果我尝试使用我的 App Code 文件夹中包含的任何代码，则会发生编译错误。如果它有助于解决错误，我已将整个 /websitedemo/ 文件夹包含在此存档中：http: [//kivin.ca/websitedemo/source.zip](http://kivin.ca/websitedemo/source.zip)

我已将文件夹置于调试模式。编译错误屏幕可以在[http://kivin.ca/websitedemo/查看](http://kivin.ca/websitedemo/)

最好的祝福。

- 更新：

如果它有助于解决此错误，我会遇到当我尝试部署 ASP.NET WebApplication 而不是网站时发生的行为。

如果我的 aspx 文件包含这样的 @Page 直接：

`<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="myproj._Default" Debug="true" %>`

我得到的编译错误是：'解析器错误消息：无法加载类型'myproj._Default'。'

webapps 正在通过 ftp 部署，使用 Build -> Publish -> [X] Replace matching files, [X] 仅运行此应用程序所需的文件。[X] 包含 App_Data 文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T04:42:51.953

我要感谢大家的支持。这是最值得赞赏的。我一直在联系我的网络托管公司的专家，他们告诉我这不是代码或服务器配置错误，而只是我的控制面板中错过了一步。将我的网站工作目录设置为虚拟目录解决了这个问题。

感谢堆栈溢出社区和 Softsys Hosting 出色的支持人员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T23:25:25.590

如果您在本地构建站点并将生成的 dll（将包含 HelloClass）上传到 bin 目录，我敢打赌它会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T23:26:26.290

尝试将 HelloClass.cs 放在命名空间中，并将 Using 放在默认文件的顶部

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T23:34:43.400

[http://msdn.microsoft.com/en-us/library/54dwfbb7.aspx](http://msdn.microsoft.com/en-us/library/54dwfbb7.aspx)

我认为这可能会对您有所帮助...如果您有子文件夹

另外，app_code 是在 framework 2.0 中引入的，你能检查一下 live box 上的 web 应用程序是否设置为使用 framework 2.0 吗？否则这些类不会在那里编译

# php - Web 应用程序上的小部件

> ID：549974
> 
> 赞同：2
> 
> 时间：2009-02-14T23:24:32.487
> 
> 标签：php, zend-framework, widget

我正在编写一个 web 应用程序，它将具有像 iGoogle 一样的小部件（但具有不同的信息；））。由于会有不同的列，我很想听听您关于如何在代码中调用模块的想法。我想在数据库中定义启用了哪些小部件以及它们在哪一列中以及它们应该以什么顺序出现。我正在使用 PHP 和 Zend 框架。添加小部件有什么好的做法吗？

我正在考虑这样做：您保存小部件名称，并且其中会有一个包含小部件的文件夹，并且使用 require_once 我将包含该文件并执行一个默认命令，例如：

```
echo ExampleWidgetClass::run(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-24T19:06:54.703

根据您要为用户实现的目标，您可能还需要考虑外部小部件规范，例如 W3C 小部件 (Apache Wookie) 或 OpenSocial Gadgets (Apache Shindig)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T07:41:01.720

您的方法听起来很合理：坚持为每个小部件提供定义良好的接口，然后为每个注册的小部件调用该方法（或那些方法）。需要记住的一些事项：

*   抽象：小部件是否知道它们在页面上的位置，或者它们的窗口有多大？
*   安全性：小部件是由第三方编写的吗？你相信他们吗？他们的输出是否需要转义或消毒？
*   后端：某些小部件可能需要进行后端调用才能获取数据。考虑他们如何在页面呈现之前请求批量进行后端调用。同时分派多个后端请求（例如 sql 查询）可以产生比顺序查询更好的页面性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T00:46:24.023

您希望我们提供什么样的确认？如果它是您的系统、您的小部件，那么就以您认为最好的方式运行它们？

你所描述的听起来很像一个可靠的设置。就去做吧，我会说而不是问 StackOverflow？:-P

# c++ - Dev C++ 和 Visual C++ 的区别

> ID：549979
> 
> 赞同：4
> 
> 时间：2009-02-14T23:27:59.250
> 
> 标签：c++

Dev C++ 和 Visual C++ 有什么区别？

*   Dev C++ 使用 gcc，Visual C++ 使用自己的编译器。
*   还有其他人吗？

如我错了请纠正我。

我试图用 Dev C++ 编译一个用 Visual C++ 编写的程序，但没有成功。

有谁知道为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T00:29:26.777

您需要向我们展示代码，如果不了解您正在做什么的更多细节，我们无法提供任何真正具体的建议。您谈到了 MS Visual C++ 和 Dev C++ 之间的差异之一（以及它的表亲也在幕后使用 GCC）。我的建议见最后两段。

但是，标准 C++ 程序应该可以在其中编译和运行，如果您遇到问题，可能是因为您使用了一些 Microsoft 提供的 Dev C++ 中没有的东西。我不知道这是什么，因为我从未使用过 Dev C++，但我首先想到的是 MFC 或 Win32 API 调用。

Dev C++ 应该能够链接到 Microsoft 库，但您可能需要对其进行配置。Visual C++ 几乎肯定会使其成为一个易于配置的选项（或默认选项），但您可能必须更加努力地在非 MS 产品中实现它。

如果您真的想轻松地开发程序，并且您不太关心言论自由而不是啤酒中的自由软件，那么请获取 Visual C++ Express 的副本。它基本上是用于零成本学习目的的 Microsoft IDE，您会发现它比其他产品更精致 - 这是我的观点，其他人会反对，他们可能是对的，这就是为什么它是一种观点 :-)。

我现在倾向于使用 VS2010 Professional 软件包，仅仅是因为 MS 竭尽全力将其打造为一款精美的产品，而且我不介意为此付出代价，因为反过来，我的工作获得了丰厚的报酬 :-)

如果您更关心语音自由，那么 Dev C++、Code::Blocks、Eclipse CDT 等可能都是极好的环境。如果您是初学者，您可能需要帮助设置它们以进行良好的调试或访问 Microsoft 库，但在我看来这是非常值得的。Eclipse 是我最喜欢的，因为我曾经在工作中使用过很多 Java，而且我对它很熟悉，但似乎每个人都对 Code::Blocks for C++ 工作赞不绝口。玩过了，很容易习惯。

并重申我对您问题的“它不起作用”部分的建议，您应该向我们展示您遇到的代码或错误 - 一旦我们看到它们，这对我们来说可能是显而易见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T00:42:43.720

我可以支持[Code::Blocks](http://www.codeblocks.org/)推荐。它就像 VC++ 6.0 的开源版本，这可能是 VC++ IDE 的最高点。

关于您的问题 - 您需要发布一些代码和/或您收到的错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T00:45:53.603

Visual C++ 为在该环境中创建的应用程序使用一个通用头文件，称为 stdafx.h（代表标准应用程序框架扩展）。这可能是它无法编译的主要原因之一。Visual C++ 也是一个更完整的 Windows 开发 IDE。调试器可以很好地工作，并且很好地集成在 IDE 中。

另一方面，Dev 非常适合开始。它已经很长时间没有更新了，但是对于初学者来说这很棒 - 那里有更少的功能可以压倒他们。尽管一旦开发人员继续前进，这些功能基本上是提高生产力的必要条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-03T18:14:46.187

Visual C++ 来自微软。除了 Windows 库 [MFC、COM、Win32] 之外，它还支持纯 C++。如果您想开发适用于 Windows 的应用程序并希望更快地完成，请使用 Visual Studio。

应用程序也可以使用 Dev C++ 开发，但配置库等工作量很大。

您的应用程序没有使用 Dev C++ 编译的原因是因为库可能没有使用 Dev C++ 正确配置。

# css - 以 Div 为中心

> ID：549982
> 
> 赞同：0
> 
> 时间：2009-02-14T23:28:54.943
> 
> 标签：css, list, xhtml, center

在我正在编码的设计中，有一个水平列表用作网站的导航。它跨越页面的整个宽度。你可以在这里看到它：http: [//aquate.us/film/](http://aquate.us/film/)

现在，`<ul>`包含在`div#navigation`拒绝以 div 为中心。它似乎向左侧偏移。

我已经搜索了网络，但我尝试的任何方法都无效。有什么建议么？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T23:33:58.503

您的表单，具有“搜索”的 id 太高了。

# c++ - 不需要仅使用虚拟/内联函数导出类吗？

> ID：549983
> 
> 赞同：5
> 
> 时间：2009-02-14T23:29:10.353
> 
> 标签：c++, winapi, dll

在 Win32 上的 C++ 中：

假设我有一个带有声明类的头文件的 DLL。DLL 导出一些获取指向该类实例的指针/引用的方法，例如工厂函数。

如果只在其实例上调用虚拟或内联函数，我是否认为没有必要使用 __declspec 将该类标记为导出？

相反，如果希望调用非虚拟成员函数，是否有必要导出类声明？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-15T01:45:25.440

> 如果只在其实例上调用虚拟或内联函数，我是否认为没有必要使用 __declspec 将该类标记为导出？

是的，这是正确的，这就是COM所做的，DLL只公开了4个方法，其中一个返回到类工厂，它的所有成员都是纯虚函数。

> 相反，如果希望调用静态定义的成员函数，是否有必要导出类声明？

不，只是导出静态成员函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T23:42:02.197

仅当函数/类的所有定义都包含在头文件中时，才没有必要。它不依赖于虚拟性。

因此，如果您不导出所有类，则客户端代码可以使用它，只要它在 cpp 文件中没有任何公共或受保护的函数定义。

您还可以通过在函数声明中使用 __declspec 而不是在类名声明中声明要导出的特定成员函数而不是整个类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T00:16:03.330

> 我是否正确地相信...

是的，我想是的，但是：

*   你应该测试一下（我现在不能）

*   您可能要小心使用内联方法：因为如果您稍后更改它们，那么您应该重新构建依赖（已构建）此类的所有其他组件（即 DLL 不再完全绝缘或自包含...内联方法在单个 DLL 中是可以的，但如果在 DLL 的导出接口中使用，则有利于一种“DLL 地狱”）。

> 相反，如果希望调用静态定义的成员函数，是否有必要导出类声明？

如果不是整个类，则至少需要导出那些单独的静态方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-11T07:07:10.093

C++ 名称修改是编写交叉编译器模块成功的负担，只需将要公开的类声明为只包含虚函数的接口即可。考虑到 COM，具有虚函数的类的布局可能是“标准化的”。

# ruby-on-rails - 模型重构：出了什么问题？

> ID：549985
> 
> 赞同：0
> 
> 时间：2009-02-14T23:29:36.547
> 
> 标签：ruby-on-rails, refactoring, models

我目前正在尝试干掉这个初始的详细代码：

```
def planting_dates_not_nil?
    !plant_out_week_min.blank? || !plant_out_week_max.blank? || !sow_out_week_min.blank? || !sow_out_week_max.blank?
  end

  def needs_planting?(week)
    if !plant_out_week_min.blank? && !plant_out_week_max.blank?
      (plant_out_week_min..plant_out_week_max).include? (week) 
    end
  end

  def needs_sowing?(week)
    if !sow_out_week_min.blank? && !sow_out_week_max.blank?
      (sow_out_week_min..sow_out_week_max).include? (week)
    end 
  end

  def needs_harvesting?(week)
    if !harvest_week_min.blank? && !harvest_week_max.blank?
      (harvest_week_min..harvest_week_max).include? (week) 
    end
  end 
```

这是我的初步尝试：

```
 def tasks_for_week(week,*task_names)
    task_names.each do |task_name|
      to_do_this_week = []
        unless read_attribute(task_name).nil?
          if (read_attribute("#{task_name}_week_min")..read_attribute("#{task_name}_week_max")).include? (week)
            to_do_this_week << task_name
          end
        end
      end
  end 
```

但是，当我在控制台中运行此代码时，如下所示：

```
p.tasks_for_week(Date.today.cweek, :plant_out, :sow_out]) 
```

我得到了一个意想不到的结果......即使不需要种植植物，我仍然会返回一个包含两个任务名称的数组（ [:plant_out, :sow_out]

谁能让我知道我将如何清理它并让 tasksforweek 方法返回预期结果？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T23:51:54.293

您的方法正在返回`task_names.each`. `each`总是返回它开始的内容。所以你需要实际返回你的结果。

此外，您正在`to_do_this_week`循环的每次迭代中重新创建数组，这会将其清除干净。

```
def tasks_for_week(week, *task_names)
  to_do_this_week = []
  task_names.each do |task_name|
    if some_condition
      to_do_this_week << task_name 
    end
  end
  to_do_this_week
end 
```

或这个：

```
def tasks_for_week(week, *task_names)
  returning [] do |to_do_this_week|
    task_names.each do |task_name|
      if some_condition
        to_do_this_week << task_name 
      end
    end
  end
end 
```

但我认为这可能是你最好的：

```
def tasks_for_week(week, *task_names)
  task_names.find_all do |task_name|
    some_condition
  end
end 
```

最后一个使用`find_all`它迭代一个数组并将返回一个新数组，其中填充了该块为其返回真值的任何对象。

最后，您的条件逻辑也有点疯狂。您可以`[]`以动态方式将访问器用于活动记录字段。使用肯定的情况而不是 的双重否定通常更清楚`unless something.nil?`。如果这是创建范围的常见用途，那么最好将其移植到一个方法中：

```
def week_range_for_task(task)
  self["#{task_name}_week_min"]..self["#{task_name}_week_max"]
end

...

self[task_name] && week_range_for_task(task_name).include?(week) 
```

制作整个方法：

```
def tasks_for_week(week, *task_names)
  task_names.find_all do |task_name|
    self[task_name] && week_range_for_task(task_name).include?(week)
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T01:53:54.080

上面要注意的一件事是，它`self[task_name]`似乎从数据库中获取原始数据，而忽略了您可能编写的任何自定义 getter 方法。

如果您想使用自定义 getter，或者如果您有任何想要作为属性处理的方法，您可以使用`self.send(task_name)`代替`self[task_name]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T15:05:31.683

这是稍微修改过的代码，其中有一个新的条件方法。

```
 def whole_range_exists?(method_name)
        self["#{method_name}_week_min"] && self["#{method_name}_week_max"]
      end

      def week_range_for_task(task_name)
        self["#{task_name}_week_min"]..self["#{task_name}_week_max"]
      end

      def tasks_for_week(week, *task_names)
        task_names.find_all do |task_name|
          whole_range_exists?(task_name) && week_range_for_task(task_name).include?(week)
        end
      end 
```

# url - 过滤输入 URL 的最佳方法是什么？

> ID：549987
> 
> 赞同：3
> 
> 时间：2009-02-14T23:30:54.610
> 
> 标签：url, input, filter, parsing, xss

我有一个接受来自 PHP 用户的 URL 的表单。

我应该允许或禁止哪些字符？目前我使用

$input= preg_replace("/[^a-zA-Z0-9-\?:#.()\,/\&\'\\"]/", "", $string);

$input=substr($input,0,255);

因此，它被修剪为 255 个字符，并且只能包含字母、数字和 ? - _ : # ( ) , & '" /

我应该剥离的任何我不是的东西，或者我剥离的任何可能需要在有效 URL 中的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T00:40:38.000

[定义 URL 规范的RFC 1738](http://www.ietf.org/rfc/rfc1738.txt)规定只有字符

```
abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+.- 
```

可以在 URL 方案中使用，并且只有字符

```
abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$-_.+!*'(),;/?:@=& 
```

可以在 URL 的特定于方案的部分中未编码地使用。( `;/?:@=&`，如果使用未编码，则必须用于其“保留目的”，但如果您只是检查无效字符，则无需担心)。因此，如果您想要完整的通用性，我会根据这个正则表达式检查 URL：

```
"/([a-zA-Z+.-]+:\/\/)?([a-zA-Z0-9\$\-_\.\+\!\*'\(\),\;\/\?\:\@\=\&]+)/" 
```

（可能其中一些转义是不必要的）。如果您只是在寻找 HTTP URL，（其中一些）其他答案应该没问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T23:48:56.953

对于 %20 之类的内容，您需要允许 = 符号和 %。@ 符号也是合法的

您可以使用这样的正则表达式验证 url

```
/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/ 
```

另外我认为网址中也不允许使用括号和引号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T00:56:10.503

我建议您根据规范解析 URI（对非法字符有点宽容），然后严格按照规范重建它......这听起来很多，但我已经开始使用我编写和使用的类对于我自己的项目。

[我把它放在pastebin上，因为它相当大。](http://pastebin.com/f2b07e589)

例子：

```
$uri = new N_Uri('http://example.com/path/segments/with spaces?key=value');
回声$uri；
```

打印出来：[http ://example.com/path/segments/with%20spaces?key=value](http://example.com/path/segments/with%20spaces?key=value)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T23:57:17.947

这是我在我制作的 TinyUrl 克隆网站上使用的正则表达式：

```
([a-zA-Z]+://)?([a-z0-9A-Z-]+\.[a-z0-9A-Z\.-]+[a-z0-9A-Z/_?=;%&,+\.\-]+) 
```*******