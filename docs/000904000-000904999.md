# StackOverflow 问答 000904000-000904999

# ruby-on-rails - 为什么使用 HTTP PUT 和 DELETE 方法而不是 POST？

> ID：904001
> 
> 赞同：38
> 
> 时间：2009-05-24T15:30:06.200
> 
> 标签：ruby-on-rails, http, delete-method

```
 new_story GET     /story/new(.:format)  {:action=>"new", :controller=>"stories"}
edit_story GET     /story/edit(.:format) {:action=>"edit", :controller=>"stories"}
     story GET     /story(.:format)      {:action=>"show", :controller=>"stories"}
           PUT     /story(.:format)      {:action=>"update", :controller=>"stories"}
           DELETE  /story(.:format)      {:action=>"destroy", :controller=>"stories"}
           POST    /story(.:format)      {:action=>"create", :controller=>"stories"} 
```

在 Web 开发中，我使用过其他技术，我只使用过`GET`and`POST`方法，但`RESTful`在 Rails 中使用路由时，默认情况下`PUT`and`DELETE`方法用于`update`and`destroy`操作。`PUT`使用and有什么好处或需要`DELETE`？我认为这些方法只是另一种方法`POST`——但为什么不坚持下去`POST`呢？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-24T15:38:57.660

优点主要是语义上的，并且还可以在一定程度上简化 URL。不同的 HTTP 方法映射到不同的操作：

```
POST   => create a new object
DELETE => delete an object
PUT    => modify an object
GET    => view an object 
```

然后，理论上，您可以使用*相同*的URL，但使用不同的方法与之交互；用于访问资源的方法定义了实际的操作类型。

但实际上，大多数浏览器只支持 HTTP GET 和 POST。Rails 在 HTML 表单中使用了一些“诡计”来表现得好像发送了 PUT 或 DELETE 请求，尽管 Rails 仍然对这些方法使用 GET 或 POST。（这解释了为什么您可能没有在其他平台上使用 DELETE 或 PUT。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-25T21:38:00.073

这是[HTTP 1.1 规范的“方法”部分](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)；它定义了很多方法，它们都有不同的好处和权衡。`POST`是最灵活的，但权衡很多：它不可缓存（因此互联网的其余部分无法帮助您扩展），它不安全或幂等，因此客户端不能只是重新发送它会出错，并且不再清楚您要完成什么（因为它非常灵活）。我敢肯定还有其他人，但这应该足够了。鉴于所有这些，如果 HTTP 规范定义了一个方法，它完全按照您的请求执行，那么就没有理由发送 a`POST`代替。

原因`POST`如此普遍，至少从历史上看，Web 浏览器仅支持`GET`和`POST`. 由于`GET`被定义为安全和幂等的（即使许多应用程序不遵守这一点），修改数据的唯一*安全*方法是发送一个`POST`. 随着 AJAX 和非浏览器客户端的兴起，这不再是事实。

顺便说一句，@mipadi 给出的映射是标准映射，但它不是唯一有效的映射。例如，Amazon S3 用于`PUT`创建资源。使用的唯一原因`POST`是如果客户端没有足够的知识来创建资源，例如，您使用关系数据库支持您的资源并使用人工代理键​​。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-11-10T17:52:36.760

我只是想在接受的答案中添加一些内容，因为他的定义`http verbs`不正确。它们都有一个“应该”遵循的规范，您可以`http verbs`根据规范创建/更新/删除多个。

我将重点介绍[W3 的 RFC 2616中的一些重要部分](https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)

我要开始，`PUT`因为在我看来，它周围最混乱。

*   `PUT is used for both create/update PUT updates by completely replacing the resource on the server with the resource sent in the request`

例如

你打电话给我的 api

```
PUT        /api/person
{
     Name: John,
     email: jdoe@hra.com
} 
```

我的服务器有这个资源存在于服务器上

```
{
     Name: Jane,
     email: jdoe@hra.com
} 
```

现在我现有的资源完全被您发送的资源所取代，这就是我在服务器上拥有的资源。

```
{
     Name: John,
     email: jdoe@hra.com
} 
```

因此，如果您`PUT`仅在正文中发送电子邮件

```
PUT        /api/person
{
     email: jdoe@hra.com
} 
```

我的服务器将完全替换实体

```
{
     Name: Jane,
     email: jdoe@hra.com
} 
```

和

```
{
     email: jdoe@hra.com
} 
```

名称将消失。部分更新是用于`PATCH`但我`POST`无论如何都使用它。

*   `One of the main reasons why we create/update with put is because it is idempotent.`

这只是一个花哨的术语，它的基本定义是多个相同的请求对于单个请求是相同的。

例子

假设我`PUT`有一个文件，`api/file`如果源服务器找不到该文件，它将创建一个。如果它确实找到了一个文件，它将用我发送的文件完全替换旧文件。**这确保了一个文件被创建和更新。**如果不存在文件并且您调用`PUT`了 5 次，则第一次创建文件，然后其他 4 次将文件替换为您发送的文件。如果您调用`POST`5 次来创建它将创建 5 个文件。

*   `You PUT to that exact URI. If you don't you have to send a 301 (Moved Permanently) to the user and allow then make a choice whether or not to redirect the request. Most times the server you PUT to usually hosts the resource and takes care of updating it`

这些是何时使用 PUT 的要点

就`POST`目前而言

*   `You can also create/update and then some...`

正如我上面提到的，有一些关键的区别。

*   帖子比较一般。以什么方式？其他一些示例包括通往其他协议的网关，它可以接收响应并将其发送到位于中间的某个数据处理程序，或者它可以扩展某种功能。
*   Post 没有“到确切的 URI 或通知”的限制，例如`POST`可以将资源附加到现有集合并决定它的存储位置。

现在我`Delete`为什么不`POST`呢？

当您发送响应时，除非您删除资源或将其移动到无法访问的位置，否则`DELETE`服务器**不应****成功****响应**。

为什么这很重要？如果您调用`DELETE`但资源在被删除之前必须经过“批准”怎么办？如果删除可以被拒绝，则您无法发送成功的错误代码，并且如果您确实遵循了基本规范，那么调用者会感到困惑。只是一个例子，我相信你可以想到很多其他的。

我只是强调了一些关于何时使用通用的要点`Http verbs`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-24T15:40:20.187

这有点像问为什么要“删除”一个文件，而您可以将其内容设置为零字节，而文件系统会将其视为删除。HTTP 一直支持 GET/POST 以外的动词，但 SOAP 的演变方式有点扭曲了这些动词的原始含义。REST 是一种更简单、回归基础的方法，它按预期使用动词，而不是在有效负载中发明一些新的动词概念。

# php - 如何允许下载暂停/恢复？

> ID：904019
> 
> 赞同：7
> 
> 时间：2009-05-24T15:42:10.403
> 
> 标签：php, http, download

通常，当我想允许用户在不透露确切位置的情况下下载文件时，我只是使用这样的东西让他们下载文件：

```
header("Pragma: public");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Content-Type: application/octet-stream");
header("Content-Disposition: attachment; filename=\"" . $filename) . "\";");
header("Content-Transfer-Encoding: binary");
header("Content-Length: " . filesize($filename));
readfile("$filename"); 
```

但是，如果他们使用现代浏览器或其他下载客户端，并且他们暂停下载并尝试恢复它，则脚本（假设他们仍然经过身份验证或其他）将从头重新发送标头和文件内容，从而破坏下载，基本上要求从头开始重新下载文件。

如何使我的脚本能够补偿暂停（并因此恢复）下载？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T16:33:41.070

使用 php 的内置 fopen 打开文件，然后 fseek 到正确的位置（基于请求头中的范围），然后使用 fpassthru 而不是使用 readfile 返回部分文件。

[您可以在fread](http://ee.php.net/manual/en/function.fread.php#84115)的注释下找到一些 php 中的示例代码

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T15:54:05.067

您需要阅读 Range、If-Range 等请求标头，然后寻找文件中的正确位置。通常，网络服务器会在普通文件上为您执行此操作。这有点复杂，但这里有一些可以帮助你入门的东西：

[http://forums.asp.net/t/1218116.aspx](http://forums.asp.net/t/1218116.aspx)

[http://www.notes411.com/dominosource/tips.nsf/0/480C4E3BE825F69D802571BC007D5AC9!opendocument](http://www.notes411.com/dominosource/tips.nsf/0/480C4E3BE825F69D802571BC007D5AC9!opendocument)

对于第二个链接，代码在第 12 部分

# c# - 如何在 C# 中使用 Guid？

> ID：904021
> 
> 赞同：89
> 
> 时间：2009-05-24T15:43:29.203
> 
> 标签：c#, guid

此代码：

```
Something = new Guid() 
```

正在返回：

> 00000000-0000-0000-0000-000000000000

一直都是，我不知道为什么？所以为什么？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2009-05-24T15:46:33.477

你应该使用[`Guid.NewGuid()`](http://msdn.microsoft.com/en-us/library/system.guid.newguid.aspx)

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-05-24T15:51:25.723

只是快速解释一下为什么需要调用 NewGuid 而不是使用默认构造函数......在 .NET 中，所有结构（值类型，如 int、decimal、Guid、DateTime 等）都必须有一个默认的无参数构造函数来初始化所有字段设置为默认值。在 Guid 的情况下，构成 Guid 的字节全为零。他们没有为 Guid 制作一个特例或使其成为一个类，而是使用 NewGuid 方法生成一个新的“随机”Guid。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-24T16:01:12.320

在里面`System.Guid.`

在代码中动态创建 GUID：

```
Guid messageId = System.Guid.NewGuid(); 
```

要查看它的价值：

```
string x = messageId.ToString(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-26T13:57:07.767

`something = new Guid()`等于`something = Guid.Empty`。

`Guid.NewGuid();`改为使用

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-03T07:13:03.007

```
 Guid g1 = Guid.NewGuid();

 string s1;
 s1 = g1.ToString();
 Console.WriteLine("{0}",s1);
 Console.ReadKey(); 
```

# ubuntu - Ubuntu Hardy 上的 Cron 作业执行但未按预期删除文件

> ID：904022
> 
> 赞同：1
> 
> 时间：2009-05-24T15:43:30.263
> 
> 标签：ubuntu, cron, rm

我这里有点咸菜，想知道是否有人可以给我一些指示：

我有一个每天为特定用户执行的 cron 作业，并且应该扫描特定目录中的文件。从技术上讲，这是两个工作。我打开了 cron.log 来验证它们是否真的在执行，它们是：

```
May 24 11:03:01 AppNameGoesHere /USR/SBIN/CRON[11257]: (mongrel_AppNameGoesHere) 
  CMD (rm -rf /var/www/apps/AppNameGoesHere/current/public/
  {popular,index,purchasing,purchasing-alternate,support,about-us,guarantee,screenshots}.htm{,l})
May 24 11:04:01 AppNameGoesHere /USR/SBIN/CRON[11260]: (mongrel_AppNameGoesHere)
  CMD (rm -rf /var/www/apps/AppNameGoesHere/current/public/
  {stats,popular,bcf,articles,expenses}) 
```

我已经删除了实际的用户名并对其进行了格式化，以便在 StackOverflow 上不那么难看。

现在，我的问题是：尽管我可以看到这些删除正在执行并且显然在日志中成功，但如果我转到指定的目录，文件仍然存在。我最初怀疑权限 hijinx 正在进行，但我已经验证我可以通过 su-ing 到 mongrel_AppNameGoesHere 用户并发出单独的 rm 命令或通过将 cron 作业复制/粘贴到命令行来手动删除文件。尽管该 cron 作业成功执行了好几天，但我没有手动执行的任何操作都会保持未启动状态。

关于可能发生的事情有什么建议吗？我以前直接在 /etc/crontab 文件中使用 Dapper Drake 和这些 cron 作业，当我升级到 Hardy 时，我将它们移动到用户特定的 crontabs（通过`sudo crontab -e - u mongrel_AppNameGoesHere`），这就是它们似乎停止工作的地方。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T16:48:15.547

问题是 {} 是由 shell 提供的 shell 扩展的一部分*，*因此为了使其工作，您需要更改执行 cron 条目的 shell。

默认情况下使用 /bin/sh，所以只需输入：

SHELL=/bin/bash

作为 crontab 中的第一行，所以事情应该重新开始工作。

# java - 如何通过 Java 写入 XML 并通过 HTML 显示？

> ID：904024
> 
> 赞同：0
> 
> 时间：2009-05-24T15:45:02.900
> 
> 标签：java, html, xml

我们如何使用 Java 将记录插入到 XML 文件中？

我们如何使用 HTML 显示这个 XML 文件中的一条记录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T16:38:12.190

要从 xml 显示 html 记录，它称为[XSLT](http://www.w3.org/TR/xslt)，它是一种 XML 样式表语言，它是一种将 xml 文件转换为显示为 html 的方法，您可以使用[Dreamweaver](http://en.wikipedia.org/wiki/Adobe_Dreamweaver)之类的工具来帮助您编辑和进行转换。

与java相反；DOM 解析器将 XML 文件加载到内存中并对其进行对象模型。这是一个关于如何做到这一点的[快速示例。](http://www.java-tips.org/java-se-tips/javax.xml.parsers/how-to-read-xml-file-in-java.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T15:51:44.427

XML 到 HTML：使用 XSLT [http://www.rgagnon.com/javadetails/java-0407.html](http://www.rgagnon.com/javadetails/java-0407.html) 在 XML 树中插入另一个节点：* 使用 DOM API 和 node.appendChild(newnode)：[http://www。 javazoom.net/services/newsletter/xmlgeneration.html](http://www.javazoom.net/services/newsletter/xmlgeneration.html) * 如果你的树太大，使用 SAX API

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-24T23:36:00.927

```
String xml = <learn to read file and get it as String>
xml = xml.trim().replaceAll("<","&lt;").replaceAll(">","&gt;");
os.println("<pre id=\"content\">" + xml + "</pre>"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T18:01:12.573

此代码片段可能会为您使用 XSLT 和 Java (JSTL) 澄清一些事情，只是补充了 Pierre 和 TStamper 为您提供的良好链接

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/xml" prefix="x" %>

<c:set var="xslDoc">
    <?xml version="1.0"?>
    <xsl:stylesheet version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
        <xsl:template match="/">
          <html>
          <body>
            <h2>My CD Collection</h2>
            <table border="1">
              <tr bgcolor="#9acd32">
                <th>Title</th>
                <th>Artist</th>
              </tr>
              <xsl:for-each select="catalog/cd">
                <tr>
                  <td><xsl:value-of select="title"/></td>
                  <td><xsl:value-of select="artist"/></td>
                </tr>
              </xsl:for-each>
            </table>
          </body>
          </html>
        </xsl:template>
    </xsl:stylesheet>
</c:set>

<c:set var="xmlDoc">
    <?xml version="1.0"?>
    <catalog>
        <cd>
            <title>Stop</title>
            <artist>Sam Brown</artist>
            <country>UK</country>
            <company>A and M</company>
            <price>8.90</price>
            <year>1988</year>
        </cd>
        <cd>
            <title>Red</title>
            <artist>The Communards</artist>
            <country>UK</country>
            <company>London</company>
            <price>7.80</price>
            <year>1987</year>
        </cd>
    </catalog>
</c:set>

<x:transform xml="${xmlDoc}" xslt="${xslDoc}" /> 
```

此外，有许多技术可以在 servlet 或业务类中实现这一点，我喜欢[Apache Xalan](http://xml.apache.org/xalan-j/)

# sql - 加入动态支点

> ID：904028
> 
> 赞同：0
> 
> 时间：2009-05-24T15:48:01.183
> 
> 标签：sql, sql-server, sql-server-2008

紧随其后的是一个新问题，其中包含文本形式的问题，而不是像这样的图像：

[加入动态枢轴（版本 2）](https://stackoverflow.com/questions/904209/join-with-dynamic-pivot-version-2)

（这个问题是一个**图像**。右键单击“我有一些有价值的表”。:)

* * *

[替代文字 http://img36.imageshack.us/img36/4853/77517349.gif](http://img36.imageshack.us/img36/4853/77517349.gif)

如果添加了新的位置记录，查询应该会自动工作。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T16:25:32.380

```
SELECT
  c.CategoryId AS CID,
  c.CategoryName,
  ISNULL(t.CategoryOrder, 0) AS [Top],
  ISNULL(l.CategoryOrder, 0) AS [Left],
  ISNULL(r.CategoryOrder, 0) AS [Right]
FROM
  Category c
  LEFT JOIN CategoryPosition t ON t.CategoryId = c.CategoryId 
                                  AND t.PositionId = 1
  LEFT JOIN CategoryPosition l ON l.CategoryId = c.CategoryId 
                                  AND l.PositionId = 2
  LEFT JOIN CategoryPosition r ON r.CategoryId = c.CategoryId 
                                  AND r.PositionId = 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T16:14:16.843

凌乱，但它的工作原理

```
select  c.categoryid,c.categoryname
,COALESCE((select top 1 categoryorder from categoryposition where categoryid=c.categoryid and positionid=1),0) as [top]
,COALESCE((select top 1 categoryorder from categoryposition where categoryid=c.categoryid and positionid=2),0) as [left]
,COALESCE((select top 1 categoryorder from categoryposition where categoryid=c.categoryid and positionid=3),0) as [right]   
 from categoryposition cp,category c
where cp.categoryid=c.categoryid
group by c.categoryid,c.categoryname
order by 1 
```

要记住两件事。如果您可以确保每个类别位置最多有一个位置，那么您可以删除前 1 个位置，但子查询必须返回 1 行，否则它什么也不会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T23:46:13.147

由于您希望交叉表查询基于 Position 表的内容是动态的，因此我建议您在运行时动态生成 SQL。

```
-- Start with Query frame
DECLARE @Query NVARCHAR(4000)
SET @Query = '
Select
        Category.CategoryID,
        Category.CategoryName
        <DYNAMICQUERY>
    From CategoryPosition
    Inner Join Category ON Category.CategoryID = CategoryPosition.CategoryID
    Group By Category.CategoryID, Category.CategoryName';

SELECT @Query;

-- Build the dynamic part of query
DECLARE @DynamicQuery VARCHAR(1024)
DECLARE @PositionCol VARCHAR(256)
DECLARE dynamic_sql CURSOR FOR
SELECT ',MAX(CASE WHEN CategoryPosition.PositionID = '+CAST(PositionID AS varchar(10)) +' THEN CategoryPosition.CategoryOrder ELSE 0 END) AS ['+PositionName+']' 
From Position

OPEN dynamic_sql

FETCH NEXT FROM dynamic_sql
INTO @PositionCol

SELECT @DynamicQuery = @PositionCol;

WHILE @@FETCH_STATUS = 0
BEGIN
    FETCH NEXT FROM dynamic_sql
    INTO @PositionCol

    SELECT @DynamicQuery = @DynamicQuery+@PositionCol;
END

CLOSE dynamic_sql
DEALLOCATE dynamic_sql

SELECT @Query = REPLACE(@Query, '<DYNAMICQUERY>', @DynamicQuery)

-- Execute the Query
EXECUTE sp_executesql @Query 
```

# python - python中的链式调用父初始化器

> ID：904036
> 
> 赞同：293
> 
> 时间：2009-05-24T15:54:09.747
> 
> 标签：python, oop, inheritance, constructor

考虑一下-基类A，从A继承的B类，从B继承的C类。在初始化程序中调用父类初始化程序的通用方法是什么？如果这听起来仍然太模糊，这里有一些代码。

```
class A(object):
    def __init__(self):
        print "Initialiser A was called"

class B(A):
    def __init__(self):
        super(B,self).__init__()
        print "Initialiser B was called"

class C(B):
    def __init__(self):
        super(C,self).__init__()
        print "Initialiser C was called"

c = C() 
```

这就是我现在的做法。但它似乎仍然有点太不通用 - 你仍然必须手动传递正确的类型。

现在，我尝试将`self.__class__`它用作 super() 的第一个参数，但是，显然它不起作用——如果你把它放在 C 的初始化程序中——很公平，B 的初始化程序会被调用。如果你在 B 中做同样的事情，“self”仍然指向 C 的一个实例，所以你最终会再次调用 B 的初始化程序（这以无限递归结束）。

现在不需要考虑钻石继承，我只是对解决这个特定问题感兴趣。

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-05-24T16:13:32.977

Python 3 包含一个改进的 super() ，它允许像这样使用：

```
super().__init__(args) 
```

* * *

## 回答 #2

> 赞同：170
> 
> 时间：2009-05-24T16:12:27.780

您这样做的方式确实是推荐的方式（对于 Python 2.x）。

是否将类显式传递给`super`的问题是样式问题而不是功能问题。传递类以`super`符合 Python 的“显式胜于隐式”的哲学。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-07-01T06:49:56.660

你可以简单地写：

```
class A(object):

    def __init__(self):
        print "Initialiser A was called"

class B(A):

    def __init__(self):
        A.__init__(self)
        # A.__init__(self,<parameters>) if you want to call with parameters
        print "Initialiser B was called"

class C(B):

    def __init__(self):
        # A.__init__(self) # if you want to call most super class...
        B.__init__(self)
        print "Initialiser C was called" 
```

# python - 使用 Python 读取 UTF8 CSV 文件

> ID：904041
> 
> 赞同：100
> 
> 时间：2009-05-24T15:56:31.527
> 
> 标签：python, utf-8, csv, character-encoding

我正在尝试使用 Python（仅法语和/或西班牙语字符）读取带有重音字符的 CSV 文件。基于 csvreader ( [http://docs.python.org/library/csv.html](http://docs.python.org/library/csv.html) ) 的 Python 2.5 文档，我想出了以下代码来读取 CSV 文件，因为 csvreader 仅支持 ASCII。

```
def unicode_csv_reader(unicode_csv_data, dialect=csv.excel, **kwargs):
    # csv.py doesn't do Unicode; encode temporarily as UTF-8:
    csv_reader = csv.reader(utf_8_encoder(unicode_csv_data),
                            dialect=dialect, **kwargs)
    for row in csv_reader:
        # decode UTF-8 back to Unicode, cell by cell:
        yield [unicode(cell, 'utf-8') for cell in row]

def utf_8_encoder(unicode_csv_data):
    for line in unicode_csv_data:
        yield line.encode('utf-8')

filename = 'output.csv'
reader = unicode_csv_reader(open(filename))
try:
    products = []
    for field1, field2, field3 in reader:
        ... 
```

以下是我尝试阅读的 CSV 文件的摘录：

```
0665000FS10120684,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Bleu
0665000FS10120689,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Gris
0665000FS10120687,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Vert
... 
```

即使我尝试编码/解码为 UTF-8，我仍然收到以下异常：

```
Traceback (most recent call last):
  File ".\Test.py", line 53, in <module>
    for field1, field2, field3 in reader:
  File ".\Test.py", line 40, in unicode_csv_reader
    for row in csv_reader:
  File ".\Test.py", line 46, in utf_8_encoder
    yield line.encode('utf-8', 'ignore')
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 68: ordinal not in range(128) 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-05-24T16:14:49.560

该`.encode`方法应用于 Unicode 字符串以生成字节字符串；但是你用字节串来调用它......错误的方式'round！查看`codecs`标准库中的模块，`codecs.open`特别是阅读 UTF-8 编码文本文件的更好的通用解决方案。但是，`csv`特别是对于模块，您需要传入 utf-8 数据，这就是您已经得到的，因此您的代码可以更简单：

```
import csv

def unicode_csv_reader(utf8_data, dialect=csv.excel, **kwargs):
    csv_reader = csv.reader(utf8_data, dialect=dialect, **kwargs)
    for row in csv_reader:
        yield [unicode(cell, 'utf-8') for cell in row]

filename = 'da.csv'
reader = unicode_csv_reader(open(filename))
for field1, field2, field3 in reader:
  print field1, field2, field3 
```

PS：如果事实证明您的输入数据不在 utf-8 中，而是在 ISO-8859-1 中，那么您确实需要“转码”（如果您热衷于在`csv`模块级别使用 utf-8） , 的形式`line.decode('whateverweirdcodec').encode('utf-8')`——但也许你可以`yield`在我上面的代码行中使用现有编码的名称，而不是`'utf-8'`,`csv`实际上使用 ISO-8859-* 编码的字节串就可以了。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2013-02-09T09:37:14.843

### 蟒蛇2.X

有一个[unicode-csv](https://github.com/jdunck/python-unicodecsv)库可以解决您的问题，另外还有一个好处是不需要编写任何新的 csv 相关代码。

这是他们自述文件中的一个示例：

```
>>> import unicodecsv
>>> from cStringIO import StringIO
>>> f = StringIO()
>>> w = unicodecsv.writer(f, encoding='utf-8')
>>> w.writerow((u'é', u'ñ'))
>>> f.seek(0)
>>> r = unicodecsv.reader(f, encoding='utf-8')
>>> row = r.next()
>>> print row[0], row[1]
é ñ 
```

### Python 3.X

在 python 3 中，内置`csv`模块开箱即用地支持这一点。看这个例子：

```
import csv
with open('some.csv', newline='', encoding='utf-8') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row) 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2018-08-15T21:55:22.290

如果您想读取编码为 utf-8 的 CSV 文件，我建议您使用这样的简约方法：

```
with open(file_name, encoding="utf8") as csv_file: 
```

使用该语句，您可以稍后使用 CSV 阅读器来使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-17T02:31:28.057

另请查看这篇文章中的答案： [https ://stackoverflow.com/a/9347871/1338557](https://stackoverflow.com/a/9347871/1338557)

它建议使用名为 ucsv.py 的库。为解决 Python 2.7 的编码问题（utf-8）而编写的 CSV 的简短替换。还提供对 csv.DictReader 的支持

**编辑**：添加我使用的示例代码：

```
import ucsv as csv

#Read CSV file containing the right tags to produce
fileObj = open('awol_title_strings.csv', 'rb')
dictReader = csv.DictReader(fileObj, fieldnames = ['titles', 'tags'], delimiter = ',', quotechar = '"')
#Build a dictionary from the CSV file-> {<string>:<tags to produce>}
titleStringsDict = dict()
for row in dictReader:
    titleStringsDict.update({unicode(row['titles']):unicode(row['tags'])}) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-04T17:53:37.970

事实证明，按照 Alex Martelli 的建议使用`codecs.open`对我很有用。

```
import codecs

delimiter = ';'
reader = codecs.open("your_filename.csv", 'r', encoding='utf-8')
for line in reader:
    row = line.split(delimiter)
    # do something with your row ... 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-24T18:29:41.077

python 2.6 的帮助页面链接是相同的，据我所知，自 2.5 以来 csv 模块没有任何变化（除了错误修复）。这是无需任何编码/解码即可工作的代码（文件 da.csv 包含与变量*data*相同的数据）。我假设您的文件应该被正确读取而无需任何转换。

**测试.py：**

```
## -*- coding: utf-8 -*-
#
# NOTE: this first line is important for the version b) read from a string(unicode) variable
#

import csv

data = \
"""0665000FS10120684,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Bleu
0665000FS10120689,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Gris
0665000FS10120687,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Vert"""

# a) read from a file
print 'reading from a file:'
for (f1, f2, f3) in csv.reader(open('da.csv'), dialect=csv.excel):
    print (f1, f2, f3)

# b) read from a string(unicode) variable
print 'reading from a list of strings:'
reader = csv.reader(data.split('\n'), dialect=csv.excel)
for (f1, f2, f3) in reader:
    print (f1, f2, f3) 
```

**da.csv：**

```
0665000FS10120684,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Bleu
0665000FS10120689,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Gris
0665000FS10120687,SD1200IS,Appareil photo numérique PowerShot de 10 Mpx de Canon avec trépied (SD1200IS) - Vert 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-10-15T15:58:50.163

值得注意的是，如果没有什么对你有用，你可能已经忘记了逃离你的道路。
例如，这段代码：

```
f = open("C:\Some\Path\To\file.csv") 
```

会导致错误：

> SyntaxError: (unicode error) 'unicodeescape' codec can't decode bytes in position 2-3: truncated \UXXXXXXXX escape

要修复，只需执行以下操作：

```
f = open("C:\\Some\\Path\\To\\file.csv") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T16:54:37.270

查看[`Latin-1`unicode 表](http://www.unicode.org/charts/PDF/U0080.pdf)，我看到字符代码`00E9`“ *LATIN SMALL LETTER E WITH ACUTE* ”。这是您的示例数据中的重音字符。一个简单的测试`Python`表明`UTF-8`该字符的编码不同于 unicode（几乎`UTF-16`）编码。

```
>>> u'\u00e9'
u'\xe9'
>>> u'\u00e9'.encode('utf-8')
'\xc3\xa9'
>>> 
```

我建议您在调用 special 之前尝试`encode("UTF-8")`使用 unicode 数据`unicode_csv_reader()`。简单地从文件中读取数据可能会隐藏编码，因此请检查实际字符值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-07-03T10:31:17.937

在另一台服务器上遇到了同样的问题，但意识到语言环境很混乱。

```
export LC_ALL="en_US.UTF-8" 
```

解决了问题

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-17T19:34:13.097

我建议您在要打开文件时使用以下代码。

```
open('/content/sasan.csv' , 'r', encoding='utf-8', errors='ignore' ) 
```

# python - python-mysql：如何获取插值查询字符串？

> ID：904042
> 
> 赞同：2
> 
> 时间：2009-05-24T15:56:38.717
> 
> 标签：python, mysql

在诊断 SQL 查询问题时，使用 MySQLdb 的安全插值，在参数插入到查询字符串后能够看到查询字符串有时会很有用。

有没有办法从 MySQL 异常对象或连接对象本身获取该信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T16:12:27.763

使用 mysql 自己的能力来记录查询并监视它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:31:40.017

也许您可以使用[slow_query_log](http://dev.mysql.com/doc/refman/5.1/en/slow-query-log.html)？

如果您无法打开 mysql 记录所有查询的内部功能，您需要在执行它们之前写下所有查询......您可以将它们存储在自己的日志文件中，或者存储在表中（或其他系统中） ）。如果是这样的话，如果我是你，我会为具有日志记录功能的连接创建一个包装器。

# computer-science - 好的函数指针类比？

> ID：904043
> 
> 赞同：5
> 
> 时间：2009-05-24T15:58:14.660
> 
> 标签：computer-science

到目前为止，我想出的最好的一个是卡片目录，其中包含有关如何烹饪不同类型食物的说明。它不包含有关如何烹饪食物的信息，也不包含有关烹饪食物本身的说明，但它可以为您指明位于其他地方的相关说明。这是一个很好的类比，因为它展示了烹饪不同类型食物（墨西哥、素食、印度等）的灵活性，但卡片目录的概念正在迅速被计算机搜索所取代。有人问我可怕的“什么是卡片目录？” 使用谷歌作为查找烹饪说明的示例是可以的，但去物理位置、查找说明和“执行它们”之间并没有那么明显的区别。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-24T16:13:33.320

我认为尝试通过非技术类比来教授一个非常技术性的概念并不是一个好主意——大概你所教的人不需要一个模糊的“管理总结”理解，他们最终需要具体应用这个概念，那为什么要这样绕道呢？

为什么不用一个简单的编程例子来解释呢？也许最好的一个是通用的排序算法（大概学生已经学会了排序）。

“函数指针基本上是一种将一段代码传递给不需要事先知道它的其他代码调用的方法。例如，像快速排序或合并排序这样的排序算法实际上只需要知道关于它正在排序的东西：如何比较它们。但是如果你将比较构建到排序算法中，它将只能比较一个东西，比如整数。通过将比较逻辑作为函数指针传递给排序算法，被调用每当算法需要比较元素时，该算法现在可以用来对任何东西进行排序，而无需更改其代码 - 如果你想用它来比较苹果和橙子，你只需要编写一个水果比较函数并通过指向排序算法的指针，以及要排序的水果。”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T16:02:10.900

这个类比似乎过于复杂。

函数指针就像可以为您完成工作的人的电话号码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T16:43:37.517

我建议告诉你的学生什么是什么*而**不是*什么。后来，他们会问自己“解决这个问题的正确工具是什么？” 而不是“我的问题叫什么？”

 *想象一下，您编写了一个程序，该程序采用位图并将其转换为图像文件。位图有多种格式（黑白、真彩色、带 Alpha 通道的真彩色等）。并且有各种图像文件格式（JPEG、PNG、GIF）。如果你试图在没有函数指针的情况下编写它，你最终会得到 N*M 算法：N 表示输入位图的数量，M 表示支持的输出格式的数量。在这个基本示例中，这将是 9 (3*3)。明天，你的老板过来，也想支持 TIFF。这意味着 12 (3*4) 个算法。规格的微小变化会导致大量工作。死路。

但是你可以定义三个函数指针：`getWidth(bitmap)`, `getHeight(bitmap)`,`getPixel(bitmap, x, y)`

现在您只需要实现这三个 FP 的 N 个算法。每种算法都适用于每种位图，并且知道如何读取它。输出算法不再关心输入图像的样子，它们只需要三个 FP 来访问现在抽象的图像数据。所以你最终得到了 6 (3+3) 个算法，而当你的老板使用 TIFF 时，你只需要添加一个算法：7 而不是 12。

从计算机的角度来看，FP 就是蹦床。它不是在 FP 的地址（普通函数调用）处开始执行代码，而是读取存储在那里的地址并开始执行该地址保存在 FP 中指向的代码。

您需要编写的有趣代码只是为了让编译器开心。在汇编程序中，这看起来很简单。普通函数调用：

```
 lea.l someFunction,a0  # Load address of someFunction
    jsr.l a0               # Jump to subroutine 
```

函数指针：

```
 lea.l  functionPointer,a0  # Load address of functionPointer
    move.l (a0),a0             # Load what is stored at functionPointer into a0
    jsr.l  a0                  # Jump to subroutine 
```

如您所见，只有一个指令差异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T16:08:10.650

扩展卡片的想法：想象你玩一个游戏，你必须做卡片上写的事情。所有的牌都是在比赛前写好的，你知道完整的名单，但不知道你会选择哪张牌。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T16:42:50.403

函数指针就像一张信用卡。:)

要进行付款，您无需携带资金自己进行交易，您只需刷卡，它就会为您完成交易。

交易可以由不同的银行以不同的方式完成，但信用卡的外观和工作方式仍然相同。你不必知道它背后的所有细节，你只需要知道如何使用这张卡。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-11T08:53:08.840

该剪辑描述了 CDS（信用默认掉期）。这正是指针如何影响您的系统。

[http://www.youtube.com/watch?v=KPNdYtrlgaU#t=120s](http://www.youtube.com/watch?v=KPNdYtrlgaU#t=120s)

“在这里，我们知道我们拥有一种特定金融工具的工具，该工具具有明显的危险性，它会产生长链风险，容易受到该链中个别交易者或市场参与者失败的影响，而这些工具在影响下允许产生恶性螺旋。CDS 价格与绑定价格、市场价格相互作用，你可以有一个向下的螺旋。

我的耳朵告诉我的是：“不要创建会导致系统崩溃的长链的依赖项。”

因此，如果他们知道 CDS 是什么。然后就很容易了。:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T16:03:39.870

我会说函数指针就像“实现的地址”到特定的“声明的规范”（除非您的处理无效）。说明编译器检查指针类型以检查您是否使用具有正确实现的规范，并且该实现只是期望特定调用约定的指令块。

**不是类比**，但可能更简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T16:03:47.843

.NET 称它们为[delegates](http://en.wikipedia.org/wiki/Delegate_(.NET))，也许这有助于类比。

您可以只说函数指针是您将工作委派给的某人（工人、公司）的地址。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-24T16:18:29.793

我一直认为函数指针提供了将函数作为参数传递的机制（以及其他用途）。因此，如果您问“我如何将这个函数传递给另一个函数”，答案将是使用它的引用（指针）。不知道这是否有帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-24T17:04:51.360

我认为“指针”可以称为“标识符”（这是合理的，因为实例的“内存地址”就是它的“身份”）。因此，“指向函数的指针”只是“存储某个函数标识的变量”（假设您知道“函数”是什么）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-24T17:14:54.560

无论如何，卡片目录的东西似乎有点奇怪。根据您的主题，IMO 函数指针的一个更好的类比是它们是食谱索引中的一个条目。“Cajun......39”，所以你去第39页，有烹饪Cajun的说明。

# svn - TortoiseSVN - 不适用于安装程序以外的 Vista 64 用户

> ID：904045
> 
> 赞同：0
> 
> 时间：2009-05-24T15:58:37.080
> 
> 标签：svn, tortoisesvn

TortoiseSVN 对于安装它的用户帐户在 Vista 64 位上运行良好。当我以其他用户身份登录时，TortoiseSVN 不存在。我尝试以管理员身份运行文件资源管理器。TortoiseSVN 似乎只为安装它的用户附加到资源管理器。

我如何让 TortoiseSVN 为安装程序以外的用户工作？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T19:31:09.200

我的问题措辞很糟糕。它适用于其他帐户 - 上下文菜单显示和工作，但图标覆盖没有显示。我意识到我只为管理员帐户设置了 dot net hack 变量。一旦我将设置移动到其他所有人，图标就会为非管理员用户返回。我知道我真的不需要 vs 2008 的 hack - 我最终会关闭它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T16:03:31.760

安装过程中没有步骤询问是否为所有用户安装吗？

# url - 绝对网址、相对网址和...？

> ID：904046
> 
> 赞同：35
> 
> 时间：2009-05-24T15:58:46.143
> 
> 标签：url, terminology, relative-url

我正在写一些文档，但我有一点词汇问题：

1.  `http://www.example.com/en/public/img/logo.gif`被称为“绝对”网址，对吧？
2.  `../../public/img/logo.gif`被称为“相对”网址，对吧？
3.  那你怎么称呼它：`/en/public/img/logo.gif`？

尽管没有协议和域部分，它是否也被视为“绝对 url”？

或者它被认为是一个相对 url，但相对于域的根目录？

我用谷歌搜索了一下，有些人将其归类为绝对的，而其他人则归类为相对的。

我应该怎么称呼它？“半绝对网址”？还是“半亲戚”？还有一句话吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-24T16:07:03.600

以下是 URL 组件：

```
http://www.example.com/en/public/img/logo.gif
\__/   \_____________/\_____________________/
 #1     #2             #3 
```

1.  方案/协议
2.  主持人
3.  小路

如果*URL*以方案和方案特定部分（后文）开头，则该 URL称为*绝对 URL*。其他任何东西都是*相对 URL*。`//``http:`

 *如果*URL 路径*以 .开头，则称为*绝对 URL 路径*`/`。任何其他*URL 路径*都称为*相对 URL 路径*。

因此：

*   `http://www.example.com/en/public/img/logo.gif`是一个*绝对网址*，
*   `../../public/img/logo.gif`是具有相对*URL**路径*的相对 URL ，并且
*   `/en/public/img/logo.gif`是具有*绝对 URL 路径的**相对 URL*。

 ** * *

*注意：当前的**URI**定义（[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)）与旧的**URL**定义（[RFC 1738](https://www.rfc-editor.org/rfc/rfc1738)和[RFC 1808](https://www.rfc-editor.org/rfc/rfc1808)）不同。*

带有 URI 术语的三个示例：

*   `http://www.example.com/en/public/img/logo.gif`是一个*URI*，
*   `../../public/img/logo.gif`是仅具有*相对路径的**相对引用*，并且
**   `/en/public/img/logo.gif`是一个只有*绝对路径的**相对引用*。*

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-13T20:54:15.603

我已经看到它称为*根相对 URL*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-26T10:26:13.737

来自微软关于 [绝对和相对 URL的文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms676525%28v=vs.85%29.aspx)

> URL 指定存储在本地或联网计算机上的目标的位置。目标可以是文件、目录、HTML 页面、图像、程序等。
> 
> *绝对 URL*包含定位资源所需的所有信息。
> 
> *相对 URL*使用绝对 URL 作为起点定位资源。实际上，目标的“完整 URL”是通过连接绝对 URL 和相对 URL 来指定的。
> 
> *绝对 URL*使用以下格式：*scheme://server/path/resource*
> 
> 相对 URL 通常仅包含*path*和可选的*resource*，但不包含*scheme*或*server*。下表定义了完整 URL 格式的各个部分。
> 
> *   ***scheme*** - 指定如何*访问资源*。
>     
>     
> *   ***server*** - 指定*资源*所在计算机的名称。
>     
>     
> *   ***path*** - 指定通向目标的目录序列。如果*省略resource*，则目标是*path*中的最后一个目录。
>     
>     
> *   ***资源***- 如果包含，*资源*是目标，通常是文件的名称。它可能是一个*简单的文件*，包含单个二进制字节流，也可能是一个*结构化文档*，包含一个或多个存储和二进制字节流。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T16:04:56.190

它有时被称为虚拟 url，例如在 SSI 中：

```
<!--#include virtual = "/lib/functions.js" --> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T16:08:38.733

请记住可以省略多少个 URL 段，使它们成为相对的（注意：它的所有部分，差不多）。这些都是有效的 URL：

*   `http://example.com/bar?baz`
*   `?qoo=qalue`
*   `/bar2`
*   `dat/sly`
*   `//auth.example.com`（大多数人对这个感到惊讶！会使用http或https，取决于当前资源）
*   `#anchor`

# java - 如何在通常的 java 代码中运行 OSGi 框架？

> ID：904050
> 
> 赞同：8
> 
> 时间：2009-05-24T16:00:46.020
> 
> 标签：java, osgi

谁能给我一个如何使用osgi框架类的例子？我不知道如何使用这些类...

BR,

马库斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T14:59:05.273

这取决于您使用的 OSGi 实现。我使用 Eclipse Equinox 并从常规 java 类中启动框架。Eclipse jar（称为 org.eclipse.osgi_longversion.jar）有一个名为 org.eclipse.core.runtime.adaptor.EclipseStarter 的类。这将启动您的 OSGi 框架。

```
Properties props = new Properties();
// add some properties to config the framework
EclipseStarter.setInitialProperties(props);
BundleContext context = EclipseStarter.startup(new String[]{},null); 
```

您需要一些属性来配置框架。[您可以在此处](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/runtime-options.html)查看所有记录的属性。一旦你调用启动，你收到的 BundleContext 就是系统包上下文，所以你可以从这里安装/启动/停止包。

如果设置了所有属性，则不必将任何参数传递给 startup()。

[您可以从Equinox 网站](http://download.eclipse.org/equinox/drops/R-3.4.2-200902111700/index.php)下载所有 Equinox 和其他捆绑包。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-10T22:13:30.407

在 OSGi 4.1 中，这是标准化的。看看[http://njbartlett.name/2011/03/07/embedding-osgi.html](http://njbartlett.name/2011/03/07/embedding-osgi.html)，它解释了如何嵌入任何 OSGi 容器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T22:16:34.077

该规范没有定义如何实例化、配置和启动 OSGi 框架。因此，从您常用的 Java 代码运行 OSGi 框架总是特定于给定的框架实现（Equinox、Felix、Knopplerfish，...）。

[将Apache Felix](http://felix.apache.org/)（一个开源 OSGi 框架）嵌入到您的应用程序中相当容易。

有关详细信息，请参阅[http://felix.apache.org/site/launching-and-embedding-apache-felix.html](http://felix.apache.org/site/launching-and-embedding-apache-felix.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T16:17:49.863

See the project [equinox-headless-service](http://code.google.com/p/equinox-headless-service/). It has code to launch equinox.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T16:05:55.363

请参阅[http://www.theserverside.com/tt/articles/article.tss?l=OSGiforBeginners](http://www.theserverside.com/tt/articles/article.tss?l=OSGiforBeginners)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-11T15:57:32.930

我最近创建了一个关于如何在 Java 中嵌入 Equinox OSGi 运行时的简单概念验证。详情请关注我在 Github 中的项目[https://github.com/sarxos/equinox-launcher](https://github.com/sarxos/equinox-launcher)

# .htaccess - 使用 mod rewrite 使用用户名变量更改 URL

> ID：904075
> 
> 赞同：1
> 
> 时间：2009-05-24T16:11:52.243
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

如何更改以下客户端 URL

```
domain.com/profile/jung
domain.com/jung (preferable) 
```

到服务器端的 URL

```
domain.com/profile.php?user_id=100 
```

使用 php 变量中的用户名？

我知道我需要使用 RewriteCond 和 RewriteRule 编辑我的 htaccess 文件，但我仍然不清楚......

Twitter 如何管理他们的用户页面 URL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T16:15:04.737

试试这个规则：

```
RewriteRule ^profile/([^/]+)$ profile.php?user_name=$1 
```

这将重写 to 的`/profile/`*`foobar`*请求`/profile.php?user_name=`*`foobar`*。请注意，您只能重写用户名。如有必要，您的脚本将不得不查找用户 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T16:17:28.077

签出[RewriteMap](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritemap)函数。

# c# - 通过 COM 互操作从 C++ 向 C# 抛出异常详细信息时丢失？

> ID：904076
> 
> 赞同：2
> 
> 时间：2009-05-24T16:12:15.097
> 
> 标签：c#, .net, com, interop, exception

我正在使用 c# 代码中的 cpp COM 对象。我的 c# 代码如下所示：

```
try
{
   var res = myComServer.GetSomething();
}
catch (Exception e) { } 
```

但是，该异常从不包含我在 cpp 中设置的任何详细信息，尤其是我的错误消息。

在我的 cpp 方面，我遵循了我在网上找到的几个示例：

```
...
ICreateErrorInfo *pcerrinfo;    
IErrorInfo *perrinfo;    
HRESULT hr;    
hr = CreateErrorInfo(&pcerrinfo);    
pcerrinfo->SetDescription(L"C++ Exception");    
hr = pcerrinfo->QueryInterface(IID_IErrorInfo, (LPVOID FAR*) &perrinfo);  
if (SUCCEEDED(hr))    
{  
  SetErrorInfo(0, perrinfo);  
  perrinfo->Release();    
}  

pcerrinfo->Release();    
return E_FAIL;  // E_FAIL or other appropriate failure code  
... 
```

我错过了什么吗？是否还有其他可能影响这一点的东西，例如编组、互操作创建或 com 服务器本身的属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T16:27:00.120

您的 COM 类是否支持[ISupportErrorInfo](http://msdn.microsoft.com/en-us/library/ms221083.aspx)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T04:37:49.963

假设您的类确实实现了，您是否在将库从 Visual Studio 导入 C# 项目*后*`ISupportErrorInfo`添加了支持？

 *当您导入库时，Visual Studio 会生成只需要与 COM 库对话一次的垃圾。为此，它基于导入时 DLL 的 TypeLib 中可用的信息，构建一个名为“ *originalDllName.Interop.dll ”的特殊翻译 DLL。*

您可以根据需要随时更改实施，而不会遇到麻烦；但是如果您以任何方式更改了库（添加了新类，更改了接口定义，更改了类实现的 iterfaces...），您将不得不从您的引用中删除 COM DLL，然后重新导入它，用于刷新 Interop DLL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-24T04:07:16.940

我面临着完全相同的问题。我已经在我的 COM 模块中实现`ISupportErrorInfo`了该`InterfaceSupportsErrorInfo`方法。不过，在 C# 异常中，我没有得到我在`perrorinfo`C++ 端设置的错误描述。就我而言，`COM_INTERFACE_ENTRY(ISupportErrorInfo)`头文件中缺少 的条目。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-24T16:20:25.800

不是捕获异常类型，而是像这样捕获[COMException](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comexception.aspx)类型...

```
try
{
  // COM call
} 
catch( COMException cEx )
{
  // Check HRESULT here
} 
```

# wix - 如何检测 Windows server 2003 上是否安装了媒体服务？

> ID：904100
> 
> 赞同：0
> 
> 时间：2009-05-24T16:23:07.593
> 
> 标签：wix, windows-server-2003

我一直在努力寻找这方面的一些信息。到目前为止，我一直在使用版本密钥存在来做到这一点，有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T17:07:22.760

安装在盒子上的东西会在几个地方注明，但都没有报告所有内容，因此您必须查看每个位置以找到媒体服务安装信息的位置。

WMI 类：

Win32_ApplicationService

Win32_QuickFixEngineering

Win32_SoftwareFeature

还有MsPIDinfo： [http ://www.mombu.com/microsoft/scripting-jscript/t-microsoft-programs-ids-277777.html](http://www.mombu.com/microsoft/scripting-jscript/t-microsoft-programs-ids-277777.html)

而且，有趣的是，在以下子项的注册表中卸载信息：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall

# sql - 如何将 SQL 数据表转换为指针表？

> ID：904119
> 
> 赞同：1
> 
> 时间：2009-05-24T16:32:53.927
> 
> 标签：sql, sqlite, rdbms

假设我有一个元组（id、姓氏、名字、职业）的 SQL 表，其中所有值都是字符串（好的，显然*id*是一个键）。

我想将它转换为带有元组（id、lastid、firstid、occupid）的表，其中我只保留指向包含实际值的其他表的指针。如果示例域名和职业不是最适合此操作，我深表歉意。

显然，要创建将保存数据的其他表，我需要获取所有唯一的姓氏，并将它们插入到具有自动生成键的新表中。名字和职业也是如此。

完成之后，是否有一个单一的转换可以生成包含指针（呃，外键）的新表？

如果重要，实现使用 SQLite。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T17:02:04.483

假设您的姓/名和职业表是 Lnt、Fnt 和 Occ，每个表只有两列、一个 id 字段和一个值：

```
REPLACE INTO TheTable (last, first, occup)
SELECT Lnt.id, Fnt.id, Occ.id
FROM TheTable
JOIN Lnt ON (last=Lnt.value)
JOIN Fnt ON (first=Fnt.value)
JOIN Occ ON (occup=Occ.value) 
```

# objective-c - Cocoa：对代码中的#define 感到困惑？

> ID：904125
> 
> 赞同：1
> 
> 时间：2009-05-24T16:34:02.567
> 
> 标签：objective-c, arrays, cocoa-touch, c-preprocessor

我正在浏览一些我从互联网上下载的代码（[在这里得到](http://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview/)）

我对这行代码感到困惑......它到底在做什么？

```
#define N_RANDOM_WORDS (sizeof(randomWords)/sizeof(NSString *)) 
```

这是“randomWords”的数组：

```
static NSString *randomWords[] = {
@"Hello",
@"World",
@"Some",
@"Random",
@"Words",
@"Blarg",
@"Poop",
@"Something",
@"Zoom zoom",
@"Beeeep",
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T16:41:27.723

`sizeof(randomWords)`给出数组占用的字节数. 数组的每个元素都是一个`NSString`指针。`sizeof(NSString*)`给出每个指针的大小。因此，将总大小除以每个元素的大小就可以得出元素的数量。

`N_RANDOM_WORDS`是一个正在定义的宏。无论在哪里使用，`sizeof(randomWords)/sizeof(NSString*)`预处理器都会将表达式插入到它的位置。这通常是在 C 或 Objective C 中定义常量的方式。

有关 C（和 Objective C）中宏的更多信息，[这里有一个很好的教程](http://www.cprogramming.com/tutorial/cpreprocessor.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T16:42:16.677

一个`NSString*`需要`sizeof(NSString*)`字节。的大小`randomWords`为`N * sizeof(NSString)`。所以求解`N`，你得到`N = sizeof(randomWords)/sizeof(NSString *)`。

# c# - 如何使用 XmlReader 类？

> ID：904129
> 
> 赞同：13
> 
> 时间：2009-05-24T16:35:49.697
> 
> 标签：c#, xml, xmlreader

我想使用 XmlReader 保存和加载我的 xml 数据。但我不知道如何使用这个类。你能给我一个示例代码吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-24T16:57:30.777

MSDN 有一个简单的示例可以帮助您从[这里](http://msdn.microsoft.com/en-us/library/cc189056(VS.95).aspx)开始。

如果您对阅读和编写 XML 文档感兴趣，而不仅仅是专门使用 XmlReader 类，这里有[一篇很好的文章，涵盖了您的一些选项](http://www.c-sharpcorner.com/UploadFile/mahesh/ReadWriteXMLTutMellli2111282005041517AM/ReadWriteXMLTutMellli21.aspx)。

但如果你只是想开始玩，试试这个：

```
 XmlReaderSettings settings = new XmlReaderSettings();
 settings.IgnoreWhitespace = true;
 settings.IgnoreComments = true;
 XmlReader reader = XmlReader.Create("file.xml", settings); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-25T05:06:33.203

我个人已经从 XMLReader 切换到 System.XML.Linq.XDocument 来管理我的 XML 数据文件。通过这种方式，我可以轻松地将数据从 xml 提取到对象中，并像我程序中的任何其他对象一样管理它们。当我完成对它们的操作后，我可以随时将更改保存回 xml 文件。

```
 //Load my xml document
        XDocument myData = XDocument.Load(PhysicalApplicationPath + "/Data.xml");

        //Create my new object
        HelpItem newitem = new HelpItem();
        newitem.Answer = answer;
        newitem.Question = question;
        newitem.Category = category;

        //Find the Parent Node and then add the new item to it.
        XElement helpItems = myData.Descendants("HelpItems").First();
        helpItems.Add(newitem.XmlHelpItem());

        //then save it back out to the file system
        myData.Save(PhysicalApplicationPath + "/Data.xml"); 
```

如果我想在一个易于管理的数据集中使用这些数据，我可以将它绑定到我的对象列表。

```
 List<HelpItem> helpitems = (from helpitem in myData.Descendants("HelpItem")
                  select new HelpItem
                  {
                       Category = helpitem.Element("Category").Value,
                       Question = helpitem.Element("Question").Value,
                       Answer = helpitem.Element("Answer").Value,
                  }).ToList<HelpItem>(); 
```

现在它可以通过我的对象类的任何固有功能进行传递和操作。

为方便起见，我的类具有将自身创建为 xml 节点的功能。

```
public XElement XmlHelpItem()
    {
        XElement helpitem = new XElement("HelpItem");
        XElement category = new XElement("Category", Category);
        XElement question = new XElement("Question", Question);
        XElement answer = new XElement("Answer", Answer);
        helpitem.Add(category);
        helpitem.Add(question);
        helpitem.Add(answer);
        return helpitem;
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-24T16:38:06.400

您应该使用该`Create`方法而不是 using `new`，因为`XmlReader`它是`abstract class`使用[工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。

```
var xmlReader = XmlReader.Create("xmlfile.xml"); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-24T16:51:21.313

从优秀的[C# 3.0 in a Nutshell](http://oreilly.com/catalog/9780596527570/)中，考虑查看第 11 章中的[示例代码](http://www.albahari.com/nutshell/ch11.aspx)。

# c# - Linq to Sql 中的组是否已经按 Count() 降序排序？

> ID：904130
> 
> 赞同：0
> 
> 时间：2009-05-24T16:36:38.133
> 
> 标签：c#, linq-to-sql, sorting, grouping

看起来是这样，但我找不到有关该主题的任何明确文档。

我要问的是这个查询的结果是否：

```
from x
in Db.Items
join y in Db.Sales on x.Id equals y.ItemId
group x by x.Id into g
orderby g.Count() descending
select g.First() 
```

始终与以下查询相同：

```
from x
in Db.Items
join y in Db.Sales on x.Id equals y.ItemId
group x by x.Id into g
select g.First() 
```

请注意，第二个查询让 Linq 决定组的顺序，第一个查询将其设置为已售出的数量，从最多到最少。

我的临时测试似乎表明 Linq 以这种方式自动对组进行排序，而[文档](http://msdn.microsoft.com/en-us/library/bb534501.aspx)似乎表明情况正好相反——项目按照它们在选择中出现的顺序返回。我想如果它以这种方式排序，添加额外的排序是没有意义的并且会浪费循环，最好不要这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T16:41:15.070

您可能会看到这一点，因为从 sqlserver 返回的查询结果在您的测试中始终处于相同的顺序。然而，这是一个谬误：根据定义，SQL 中的集合没有顺序，除非它用 ORDER BY 明确指定。因此，如果您的查询没有 order by 语句，您的集合可能看起来像是已排序的，但事实并非如此，可能是在边缘情况下，顺序不同（例如，当服务器必须加载由于内存限制或其他原因，表的顺序不同）。所以经验法则：如果你想要一个订单，你必须指定一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T16:41:22.573

LINQ 分组不保证这样的事情。虽然它可能适用于该特定情况，但它可能不适用于另一种情况。***避免依赖这种副作用***。

顺便说一句，如果由于聚集索引或其他原因，SQL Server 真的有意对输出进行排序，添加`ORDER BY`子句不会有任何伤害，因为查询优化器应该足够聪明，知道结果已经排序，所以你不会丢失任何事物。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T16:42:25.133

如果规格不能保证订购，您应该认为它是偶然的，并且可能会随软件的任何新版本而变化。

不要把它拿出来，除非

a）您已经测量了它并且它产生了显着差异

b) 在您的软件环境发生微小变化后，您愿意监控、测试和更改（无处不在）。

# java - 删除 Java 的“临时 Internet 文件”

> ID：904144
> 
> 赞同：3
> 
> 时间：2009-05-24T16:41:12.870
> 
> 标签：java, caching, java-web-start, temporary-files

在 Windows 的 Java 控制面板中，有“临时 Internet 文件”的设置，其中缓存了所有小程序和 webstart 内容。对于我们应用程序的某些用户，此缓存无法正常工作，他们需要通过控制面板删除所有文件，然后我们的 webstart 应用程序才能正确更新自身。

忽略这样做的其他影响，无论如何我们可以在进行更新时以编程方式删除临时文件缓存，最好是通过 Java 并且不诉诸任何批处理文件或 Windows 黑客技术？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T17:44:54.130

对于网络启动应用程序（例如您正在谈论的）：

```
javaws -uninstall 
```

`-unintall`您还可以通过在命令行上提供 JNLP 的 URL 来卸载特定的 Web Start 应用程序。

当我遇到这个问题时，根本原因是 Web 服务器错误地为 Web Start 的 JAR 文件应用了不正确的到期日期。当我用我的 Apache HTTPD 配置纠正这个问题时，我停止让 Web Start 应用程序不总是更新。值得一试。

# ruby-on-rails - 为什么要按原样定义这些默认参数？

> ID：904150
> 
> 赞同：2
> 
> 时间：2009-05-24T16:42:22.463
> 
> 标签：ruby-on-rails, ruby

我目前正在学习 Ruby 和 RoR，我偶然发现了这个声明：

```
link_to_remote(name, options = {}, html_options = nil) 
```

我发现这种模式用于其他几个 Rails 函数。

为什么默认值是这样定义的？为什么不是这两个之一？

```
... options = {}, html_options = {}) 
... options = nil, html_options = nil) 
```

这是我在自己的职能中也应该遵循的某种约定吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T16:58:38.043

该方法定义如下：

```
link_to_function(name, remote_function(options), html_options || options.delete(:html)) 
```

这允许您将 指定`html_options`为散列的一部分，`options`而不是作为单独的参数。另一方面，`options`哈希总是传递给`remote_function`，所以我们需要它。

使用单例 nil 也比构造一个在每次调用该方法时都不会使用的数组更有效率。我不会说这个原因是如此令人信服，如果它使生成的代码更清晰，我不会使用 {}，但在没有任何其他考虑的情况下，这似乎是合乎逻辑的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T16:44:41.573

不是这方面的专家，但`options`可能是因为调用代码使用该`merge`方法将您传入的任何内容与假定的默认值结合起来；将其设置为`nil`只会删除所有选项。我不确定`html_options`，但可能与此类似。

`html_options`可能会调用一个块并定义一些东西来检查它是否被赋予了一个哈希值。就像我说的我不是专家，但这可能就是原因。我刚刚检查了一个 Ubuntu 虚拟机，根据 irb 的说法，一个空的哈希值计算为，`true`所以这可能就是原因。调用代码可能使用带有某行的块：

```
if html_options
    # do stuff
end 
```

所以它是`nil`默认的，因为代码会执行并且可能会给你一个空哈希的 nil 错误

# algorithm - 对数组和大 O 表示法求和

> ID：904156
> 
> 赞同：5
> 
> 时间：2009-05-24T16:44:08.470
> 
> 标签：algorithm, sum, big-o

如何找到计算数组中和值的算法？

是这样的吗？

```
Algorithm Array Sum
Input: nonnegative integer N, and array A[1],A[2],...,A[N]
Output: sum of the N integers in array A
Algorith Body:
j:=1
sum:=0
while j<N
      sum := sum + a[J]
      j:=j+1
  end while
end Algorithm Array Sum 
```

以及如何使用 O-Notation 将其与算法的运行时间联系起来

这是过去一年的考试，我需要为考试做修改。

问题给定一个包含
n 个整数值的数组 A[] 1.给出
一个计算数组中所有值之和的算法 2.找到
算法运行时间的最简单和最佳的 O 表示法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-24T16:53:11.703

问题是找到**所有值的总和，**因此遍历数组中的每个元素并将每个元素添加到临时总和值。

```
temp_sum = 0
for i in 1 ...array.length
    temp_sum = temp_sum + array[i] 
```

由于您需要遍历数组中的所有元素，因此该**程序线性依赖于元素的数量**。如果您有 10 个元素，则迭代 10 个元素，如果您有 100 万个元素，您别无选择，只能遍历所有百万个元素并添加每个元素。因此**时间复杂度是 Θ(n)**。

如果您要查找所有元素的总和并且您对数据一无所知，那么您需要至少查看所有元素一次。因此 n 是下限。您也不必多次查看该元素。n 也是上界。因此复杂度为 Θ(n)。

但是，如果您对元素有所了解..假设您得到 n 个自然数的序列，您可以使用 n(n+1)/2 在恒定时间内完成。如果您获得的数据是随机的，那么您别无选择，只能执行上述线性时间算法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T16:46:22.523

由于**n**是数组的大小，您所要做的就是从开始迭代到结束 Big O 表示法是 O[n]

```
integer N= Size_array;
array a[N]
j=1 
sum=0
while j<=N 
 sum += a[j]  
 j++
end while 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T16:48:03.517

我认为您的意思是“当 j <= N”时，您需要指定这一点。

我认为运行时间应该是 O(n)，因为你只有一个循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T16:57:38.467

要计算此算法的 O，您需要计算每行代码执行的次数。稍后您将只计算基本操作，但从计算所有操作开始。

那么 j := 1 行会运行多少次？sum := 0 会运行多少次？while 循环的条件将执行多少次？while 循环中的语句？

总结这些。你会注意到你得到的值类似于 1 + 1 + n + n + n = 2 + 3n。因此，您可以得出结论，它是 n 上的线性函数。

# ruby-on-rails - Rails 控制台重启后，父模型找不到关联的子模型对象（然后可以）

> ID：904166
> 
> 赞同：1
> 
> 时间：2009-05-24T16:53:15.883
> 
> 标签：ruby-on-rails, model, find, parent-child

我一直试图弄清楚为什么我的（父） BlogPosts 表上的计数器缓存不会从（子） Comments 表中更新。起初我认为我[之前](https://stackoverflow.com/questions/903294/counter-cache-doesnt-update-but-i-can-save-to-the-parent-and-the-child)的问题中提供的答案可能是解决方案，但昨晚我睡觉后发生了一些事情，因为当我今天早上醒来并重新启动我的 Rails 控制台时，我的 BlogPosts（实际上只有一个帖子 - id#1）无法找到他们关联的子评论。我检查了 Comments 表，我创建的五个评论都在那里，附加到 post_id = 1。[前面问题中我的 Rails 控制台的输出](https://stackoverflow.com/questions/903294/counter-cache-doesnt-update-but-i-can-save-to-the-parent-and-the-child)表示帖子可以找到昨晚的评论。也许这解释了为什么计数器缓存没有更新，但我仍然不确定为什么父级无法找到它的子级。有什么提示吗？

```
Loading development environment (Rails 2.3.2)

>> p = Post.find(1)
p = Post.find(1)

=> #<Post id: 1, title: "test", content: "test", author_id: 1, status: "ok", created_at: "2009-05-21 19:27:14", updated_at: "2009-05-24 07:21:24", comments_count: 0>

>> p.comments.size
p.comments.size

=> 0

>> p.comments
p.comments

=> [] 
```

更新：这很奇怪——我再次重新启动了 Rails 控制台，但**这次我在调用“p.comments.size”之前调用了 p.comments——**它找到了评论！这里发生了什么？

```
Loading development environment (Rails 2.3.2)

>> p = Post.find 1
p = Post.find 1

=> #<Post id: 1, title: "test", content: "test", author_id: 1, status: "ok", created_at: "2009-05-21 19:27:14", updated_at: "2009-05-24 07:21:24", comments_count: 0>

>> p.comments
p.comments

=> [#<Comment id: 5, post_id: 1, author_id: 1, content: "Fifth Comment", status: "ok", created_at: "2009-05-24 07:08:56", updated_at: "2009-05-24 07:08:56">, #<Comment id: 4, post_id: 1, author_id: 1, content: "Fourth Comment", status: "ok", created_at: "2009-05-24 07:05:32", updated_at: "2009-05-24 07:05:32">, #<Comment id: 3, post_id: 1, author_id: 1, content: "Third Comment", status: "ok", created_at: "2009-05-24 06:34:59", updated_at: "2009-05-24 06:34:59">, #<Comment id: 2, post_id: 1, author_id: 1, content: "Second Comment", status: "ok", created_at: "2009-05-24 05:20:43", updated_at: "2009-05-24 05:20:43">, #<Comment id: 1, post_id: 1, author_id: 1, content: "First Comment", status: "ok", created_at: "2009-05-21 19:27:14", updated_at: "2009-05-21 19:27:14">]

>> p.comments.size
p.comments.size

=> 5 
```

更新 2：按照 srboisvert 的建议，我创建了一个新评论并将其添加到帖子中。这有效，comments_counter 更新为 1：

```
Loading development environment (Rails 2.3.2)

>> p = Post.find 1
p = Post.find 1

=> #<Post id: 1, title: "test", content: "test", author_id: 1, status: "ok", created_at: "2009-05-21 19:27:14", updated_at: "2009-05-24 07:21:24", comments_count: 0>

>> com = Comment.new(:post_id => 1, :author_id => 1, :content => 'Sixth Comment', :status => 'ok')
com = Comment.new(:post_id => 1, :author_id => 1, :content => 'Sixth Comment', :status => 'ok')

=> #<Comment id: nil, post_id: 1, author_id: 1, content: "Sixth Comment", status: "ok", created_at: nil, updated_at: nil>

>> p.comments << com
p.comments << com

=> [#<Comment id: 6, post_id: 1, author_id: 1, content: "Sixth Comment", status: "ok", created_at: "2009-05-24 17:59:45", updated_at: "2009-05-24 17:59:45">, #<Comment id: 5, post_id: 1, author_id: 1, content: "Fifth Comment", status: "ok", created_at: "2009-05-24 07:08:56", updated_at: "2009-05-24 07:08:56">, #<Comment id: 4, post_id: 1, author_id: 1, content: "Fourth Comment", status: "ok", created_at: "2009-05-24 07:05:32", updated_at: "2009-05-24 07:05:32">, #<Comment id: 3, post_id: 1, author_id: 1, content: "Third Comment", status: "ok", created_at: "2009-05-24 06:34:59", updated_at: "2009-05-24 06:34:59">, #<Comment id: 2, post_id: 1, author_id: 1, content: "Second Comment", status: "ok", created_at: "2009-05-24 05:20:43", updated_at: "2009-05-24 05:20:43">, #<Comment id: 1, post_id: 1, author_id: 1, content: "First Comment", status: "ok", created_at: "2009-05-21 19:27:14", updated_at: "2009-05-21 19:27:14">] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T17:53:50.200

您可以在控制台中创建评论，将其添加到帖子中，然后分 3 个单独的步骤显示吗？

您正在做很多非默认的 fk 名称规范（尽管您的名称似乎与 rails 所期望的没有什么不同，所以您可能只想使用约定）所以我的猜测是您的 has_many belongs_to 不知何故搞砸了.

# c# - Visual Studio Snippets - 如何指定 foreach 循环的集合

> ID：904168
> 
> 赞同：0
> 
> 时间：2009-05-24T16:53:37.317
> 
> 标签：c#, visual-studio, resharper, foreach, code-snippets

使用 Visual Studio 快捷方式/片段时，是否可以提前/自动指定集合，而不是事后填写绿色框？

在这种情况下，我试图用尽可能少的击键次数想出类似以下的内容：

```
foreach (ListItem item in ListBox1.Items)
{
    //
} 
```

例如，快捷方式“CTRL+K, CTRL+X foreach”会猜测我要迭代的集合，但通常会出错。我经常得到以下结果：

```
foreach (object var in collection_to_loop)
{
        //
} 
```

如果我键入集合标识符和/或使用“Surround with”，它不会更好地工作，因为它将突出显示的项目放在循环块中：

```
foreach (ListItem item in ListBox1.Items)
{
    ListBox1.Items 
} 
```

有没有办法做到这一点？我正在使用 Visual Studio 2005，但很高兴得知这可以在 2008 年或使用插件完成。

* * *

编辑：好吧，看来，我不仅没有清楚地解释我想要什么，我还看到了 Resharper 功能，并认为它是内置的 VS 功能。事实证明，这是一个 Resharper “Live Templates”，它大胆尝试猜测要放入循环中的集合类型，并在大约 1/4 的时间里把它弄对。

我所追求的是对 Resharper 是如何做出这种猜测的，以及我可以做些什么（例如突出显示我想要的集合的标识符）来给它一个提示。如果我发现任何东西，我会查看 Jetbrains 网站并在此处更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T17:02:05.373

我真的不知道该怎么说，但你认为你可能要求太多的自动化吗？我的意思是代码片段很好，因为它们减少了重复输入。但现在你想让它真正猜出你要输入的内容。它也应该猜测循环的主体吗？

您可能想查看[Developer Express](http://www.devexpress.com)的 CodeRush，它具有更强大的代码生成功能，但我不确定它是否可以按照您的建议进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T19:38:27.193

使用普通智能感知键入“ListBox1.Items”，然后按 Alt-Enter 并选择“使用 foreach 枚举集合”（不是精确文本）。

However, speaking exactly about ListBox.Items (from Windows.Forms), it is of type ObjectCollection, which is not strongly typed. So it is almost impossible to guess correct type for elements. For WPF, Items property also returns non-strongly typed collection, ItemCollection. If you have strongly typed or generic collection, ReSharper can infer enumeration item type correctly.

# python - 错误的python解释器被调用

> ID：904170
> 
> 赞同：11
> 
> 时间：2009-05-24T16:55:25.567
> 
> 标签：python, python-3.x

我更新了我的 python 解释器，但我认为旧的解释器仍然被调用。当我检查我得到的版本时：

```
$ python -V
Python 3.0.1 
```

但我相信老口译员仍在被召唤。当我运行命令时：

```
python myProg.py 
```

脚本运行正常。但是当我用命令调用它时

```
./myProg.py 
```

我收到错误消息：

```
AttributeError: 'str' object has no attribute 'format' 
```

这显然是由于调用了旧的解释器。我怎样才能解决这个问题？我运行 Mac OS X 10.5。是否与第一行有关：

```
#!/usr/bin/python 
```

我刚开始使用 python，对解释语言不是很熟悉，所以我不太确定发生了什么。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-24T16:59:38.120

根据脚本的第一行`#!/usr/bin/python`，您正在调用 Python 解释器`/usr/bin/python`（很可能是 Mac OS X 附带的解释器）。您必须将该路径更改为安装 Python 3 解释器的路径（可能是`/usr/local/bin/python`或`/opt/local/bin/python`）；*或者*您可以将该行更改为 read `#!/usr/bin/env python`，这将调用变量中`python`列出的第一个`PATH`（这似乎是您安装的较新版本）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-24T17:00:54.923

首先，推荐的shebang线路是：

```
#!/usr/bin/env python 
```

这将确保`./foo.py`当您调用 python 时调用的解释器与从命令行调用 python 时调用的解释器相同。

根据您的描述，我怀疑如果您这样做：

```
which python 
```

它不会给你`/usr/bin/python`。它会给你一些别的东西，这就是 python 3 解释器所在的地方。您可以将您的 shebang 行修改为上述内容，或者将 python 解释器的路径替换为`which`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T16:59:26.077

试试`which python`。我会告诉你在你的环境中使用了哪个 python 解释器。如果它`/usr/bin/python`不像剧本中那样，那么你的怀疑就得到了证实。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-24T17:01:38.663

您很可能怀疑 shebang 线路正在调用旧版本。您可能需要检查两件事：

1) /usr/bin/python 的解释器是什么版本：

```
/usr/bin/python -V 
```

2）您安装的 python 3 解释器在哪里：

```
which python 
```

如果您从命令行获得了正确的命令行，则将您的 shebang 行替换为：

```
#!/usr/bin/env python 
```

**附录：**您也可以用指向 python 3 的符号链接替换旧版本的 python，但要注意任何主要的 OS X 更新（即：10.5.6 到 10.5.7）都可能会破坏这一点：

```
sudo mv /usr/bin/python /usr/bin/python25
sudo ln -s /path/to/python/3/python /usr/bin/python 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T16:59:07.200

运行 'which python' - 如果这给出的答案与 /usr/bin/python 不同，请更改 #!/usr/bin/python 以使用该路径。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-02T07:20:35.633

提供 Perl 脚本来回答 Python 问题可能有点奇怪，但它对 Python 的工作方式与对 Perl 的工作方式一样。这是一个名为“ `fixin`”的脚本，意思是“修复解释器”。它将 shebang 行更改为您当前 PATH 的正确字符串。

```
#!/Users/jleffler/perl/v5.10.0/bin/perl
#
#   @(#)$Id: fixin.pl,v 1.3 2003/03/11 21:20:08 jleffler Exp $
#
#   FIXIN: from Programming Perl
#   Usage: fixin [-s] [file ...]

# Configuration
$does_hashbang = 1;     # Kernel recognises #!
$verbose = 1;           # Verbose by default

# Construct list of directories to search.
@absdirs = reverse grep(m!^/!, split(/:/, $ENV{'PATH'}, 999));

# Process command line arguments
if ($ARGV[0] eq '-s')
{
    shift;
    $verbose = 0;
}
die "Usage: $0 [-s] [file ...]\n" unless @ARGV || !-t;

@ARGV = '-' unless @ARGV;

# Process each file.
FILE: foreach $filename (@ARGV)
{
    open(IN, $filename) || ((warn "Can't process $filename: $!\n"), next);
    $_ = <IN>;
    next FILE unless /^#!/;     # Not a hash/bang file

    chop($cmd = $_);
    $cmd =~ s/^#! *//;
    ($cmd, $arg) = split(' ', $cmd, 2);
    $cmd =~ s!^.*/!!;

    # Now look (in reverse) for interpreter in absolute path
    $found = '';
    foreach $dir (@absdirs)
    {
        if (-x "$dir/$cmd")
        {
            warn "Ignoring $found\n" if $verbose && $found;
            $found = "$dir/$cmd";
        }
    }

    # Figure out how to invoke interpreter on this machine
    if ($found)
    {
        warn "Changing $filename to $found\n" if $verbose;
        if ($does_hashbang)
        {
            $_ = "#!$found";
            $_ .= ' ' . $arg if $arg ne '';
            $_ .= "\n";
        }
        else
        {
            $_ = <<EOF;
:
eval 'exec $found $arg -S \$0 \${1+"\$@"}'
    if \$running_under_some_shell;
EOF
        }
    }
    else
    {
        warn "Can't find $cmd in PATH, $filename unchanged\n" if $verbose;
        next FILE;
    }

    # Make new file if necessary
    if ($filename eq '-') { select(STDOUT); }
    else
    {
        rename($filename, "$filename.bak") ||
            ((warn "Can't modify $filename"), next FILE);
        open(OUT, ">$filename") ||
            die "Can't create new $filename: $!\n";
        ($def, $ino, $mode) = stat IN;
        $mode = 0755 unless $dev;
        chmod $mode, $filename;
        select(OUT);
    }

    # Print the new #! line (or the equivalent) and copy the rest of the file.
    print;
    while (<IN>)
    {
        print;
    }
    close IN;
    close OUT;
} 
```

该代码源自原始 Camel Book（“Programming Perl”，第一版）中的同名脚本。从那时起，这个副本已经被黑客入侵了一些 - 并且应该被黑客攻击更多。但我经常使用它——事实上，我只是将它从一台 Mac 复制到另一台，因为我没有在第二台安装 Perl 5.10.0，所以我运行：

```
$ perl fixin fixin
Changing fixin to /usr/bin/perl
$ 
```

从而从私有安装 Perl 更改为标准安装。

读者练习 - 用 Python 重写脚本。

# c# - 从linq中的类返回可枚举值？

> ID：904175
> 
> 赞同：2
> 
> 时间：2009-05-24T16:57:18.903
> 
> 标签：c#, .net, asp.net, linq

我需要来自下级的 Enumarable 值但给出错误

```
 public static  Enumerable  LoadDataByName(string name)
        {
            List<StuffDepartman> Stuff = (List<StuffDepartman>)HttpContext.Current.Session["Stuffs"];
            var stuffs = from s in Stuff select s;

             stuffs = from s in Stuff where s.Name = name select s.Name;

            return stuffs.AsEnumerable();
        } 
```

但是给我错误：**System.Linq.Enumerable'：静态类型不能用作返回类型**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T17:00:00.647

在 .NET 3.5 中，存在一个静态`Enumerable`in `System.Linq`，其中包含用于操作 s 的扩展方法`IEnumerable`- 这不是您想要（或显然*可以*）返回的。将其更改为`IEnumerable`，这是非泛型可枚举类（以及我认为您想要的），一切都应该正常工作。

更好的是，使用 的通用版本`IEnumerable`，例如：

```
public static IEnumerable<StuffDepartman> LoadDataByName(string name)
{
    var stuffs = (List<StuffDepartman>)HttpContext.Current.Session["Stuffs"];

    return (from s in stuffs where s.Name == name select s.Name);
} 
```

另外，请注意，您不需要`AsEnumerable`在返回之前调用 to，因为`List<T>`implements`IEnumerable<T>`和前者可以隐式转换为后者。`=`需要更改为`==`，因为您想在这里使用相等而不是赋值运算符。其他更改正在整理中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T16:59:33.020

`System.Linq.Enumerable`是一个静态类，上面定义了一堆扩展方法。你也许打算回来`IEnumerable<string>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T16:59:50.913

Enumerable 是一个静态类，您要做的是返回一个 IEnumerable：

```
 public static  IEnumerable<string>  LoadDataByName(string name)
    {
      //do stuff
    } 
```

我假设您示例中的 s.Name 是一个字符串，这就是该方法应返回 IEnumerable<string> 的原因。如果是另一种类型，则将其更改为该类型....

编辑：好的，我想这不是一个字符串。将其更改为：

```
 public static  IEnumerable<StuffDepartman>  LoadDataByName(string name)
    {
      //do stuff
    } 
```

# iphone - 如何获取iphone的屏幕亮度

> ID：904180
> 
> 赞同：2
> 
> 时间：2009-05-24T16:58:21.977
> 
> 标签：iphone

我做了一些搜索，发现如果要调整亮度，我需要使用私有框架，苹果会拒绝它。

如果我只想获取亮度值（只是让该值显示，而不是调整它），有没有苹果接受的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T20:38:18.453

使用公共框架的未记录 API 不一定是坏事。我认识很多人，包括我自己，他们到处使用未记录的方法，例如检查连接性或向 UIAlertViews 添加文本字段。

另一方面，链接到私有框架要糟糕得多，因为它们往往非常不稳定，可能会从 3.0 中删除或重命名。

我不确定您的案例的具体情况，但是私有框架或公共框架的未记录 API 之间的区别很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:30:04.083

没有办法回答“苹果会允许吗？”这个问题。您必须选择您的风险承受能力并提交。就个人而言，我远离无证的东西。但是在我确实用边缘的东西（通常是实际上不是私有的未记录的东西）来增强我的程序的情况下，我试图让我的程序对变化有弹性。

执行此操作的一种主要方法是检查您将要链接到的事物或您要调用的函数是否存在。对于方法，您可以`-respondsToSelector:`在调用它之前使用它。对于函数，可以测试函数是否存在：

```
extern void SomeFunction() __attribute__((weak_import));

if (SomeFunction != NULL) {
   SomeFunction();
} 
```

（您需要在 iPhone 上进行测试；我在 Mac 上使用它，并且`weak_import`应该是便携的，因为 iPhone 使用 GCC4。请参阅[确保向后兼容性](http://developer.apple.com/technotes/tn2002/tn2064.html)。到目前为止，我一直能够找到一些技巧来避免实际需要这个在 iPhone 上。）

所有这一切的关键是确保您的程序在没有未记录功能的情况下*运行。*这样一来，即使苹果拒绝它，将其拉出来也是微不足道的。

也就是说，对我来说，这是我花了很多时间尝试以有记录的方式做的事情的最后手段，对于那些可以显着改善用户体验并且不违反 Apple 基本意图的事情。比如，在后台运行，即使你可以让它工作，也明显违反了苹果的规则精神；其他的东西是私有的，只是因为它们没有被公开，比如 UI 元素的内部视图。

以在您的应用程序之外持续存在的方式更改屏幕亮度似乎违反了基本游戏规则（留在您的沙盒中）。获取当前屏幕亮度听起来不像那样（尽管我不确定你会用它做什么。）

# flash - 动作脚本原型和动态函数创建

> ID：904192
> 
> 赞同：1
> 
> 时间：2009-05-24T17:02:04.983
> 
> 标签：flash, actionscript-3, flex3

有谁知道在沙箱之间工作时 AS3/Flash 运行时如何处理尝试修改原型。特别是我在沙箱 A 中创建对象 O，然后将其传递给沙箱 B。如果沙箱 B 中的代码尝试修改原型，会有什么影响？（同一个类的 A 中的对象看到了吗？）。沙箱 B 是否可以覆盖在沙箱 A 中创建的对象的公共字段和方法（如果该对象作为参数传入）？是否可以创建一个不可修改的类（即相当于 java 中的 say final），它可以充当仅在加载的 swf 和主 swf 之间传递的现成代理？我知道事件类可以使用 clone() 来做这件事，然后在 2 个 swf 之间传递事件。在 AS3 中使用 final 类是创建根本无法修改的只读代理的正确方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T16:38:34.503

you can always use the flash.utils.Proxy class, if you want a read only proxy to some object ...

ActionScript3 is not prototype based as 1 and 2 were (you would need to compile to ecma object mode, which comes at huge speed decrease) ...

it now has 2 inheritance mechanisms ... one is class based, and the other is prototype based and works only for **dynamic** properties of **dynamic** classes ... no *sealed* (i.e. not **dynamic**) class and no *sealed* property or *sealed* method of a **dynamic** class can be modified at runtime ... by modifying a property, i mean modifying its type, or adding a setter at runtime, or overwriting it ... if the property is writable, you can of course assign something to it ...

**final** only means, it cannot be subclassed ...

as far as i know, as soon as you pass an object O from sandbox A to B, code in B can access O very much the same way as code in A does ...

i don't know, if that answers you question ... maybe you could explain, what exactly you're up to ... :)

greetz

back2dos

# javascript - jQuery：如果 $('#id') 不匹配任何内容会返回什么？

> ID：904194
> 
> 赞同：24
> 
> 时间：2009-05-24T17:02:24.390
> 
> 标签：javascript, jquery, css, jquery-selectors

如果 $('#id') 不匹配任何内容会返回什么？我认为它会是 null 或 false 或类似的东西，所以我尝试像这样检查：

```
var item = $('#item');
if (!item){
    ...
} 
```

但这没有用。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-24T17:07:35.133

您可以使用以下方法找到匹配的元素数量：

```
$('selector').length 
```

要检查是否没有匹配的元素，请使用：

```
var item = $('#item');
if (item.length == 0) {
  // ...
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-24T18:01:52.527

While `$('selector').length` is great for finding out how many objects your selector matches, its actually completely unnecesary. The thing about jQuery is that all selector based functions use length internally, so you could just do `$(selector).hide()` (or whatever) and it takes no action for an empty set.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-24T17:04:02.593

一个不包含 DOM 节点的 jQuery 对象。

你应该可以使用

```
var item = $('#item');
if (!item[0]){
    ...
} 
```

为您的存在检查。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T17:41:28.020

长度属性的别名是 size() 方法。所以你基本上也可以查询：

$("选择器").size()

查看匹配的元素数量。

# html - 链接css下划线

> ID：904199
> 
> 赞同：4
> 
> 时间：2009-05-24T17:04:59.970
> 
> 标签：html, css, hyperlink, underline

我的 css 文件中的页脚具有以下样式：

```
#footer { 
    text-align: center;
    font-size: .7em;
    color:#000000;
} 
```

这是页脚部分的 html：

```
<div id="footer">
   <br> //google ad
   <br>
   <br>
   <A HREF="http://www.site1.com">Blog</A>&nbsp;&nbsp;&nbsp;<A     
   HREF="http://site1/rss.xml">RSS</A>&nbsp;&nbsp;&nbsp;<A 
   HREF="http://www.mexautos.com">Autos Usados</A>&nbsp;&nbsp;&nbsp;<A 
   HREF="http://www.site2">Videos Chistosos</A>&nbsp;&nbsp;&nbsp;<A 
   HREF="http:/s.blogspot.com">Fotos de Chavas</A><br>
   Derechos Reservados &copy; 2008-<?=date('Y')?> address<br>
</div> 
```

但由于某种原因，一些链接显示有下划线。

有什么想法可以使链接不带下划线吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-24T17:07:08.517

你可以试试

```
#footer a { text-decoration: none } 
```

这意味着带有 id 页脚的元素中的所有 <a> 标签都没有下划线。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-24T17:07:35.630

尝试：

```
#footer a{ 
   text-decoration: none;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-24T17:07:45.770

应用以下样式：

```
a, a:link, a:visited, a:hover
{
    text-decoration: none;
} 
```

我特意为您提供了一个`<a>`标签可能具有的所有状态的完整介绍，但您也很可能能够摆脱以下情况：

```
a
{
    text-decoration: none;
} 
```

最后，如果您只想将此应用于页脚：

```
#footer a, #footer a:link, #footer a:visited, #footer a:hover
{
    text-decoration: none;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-24T17:10:08.310

不是对您的问题的直接回答，但我强烈建议您在 Firefox 中安装 Firebug，因为它可以让您查看应用了哪些类以及它的顺序 - 从本质上帮助您调试 CSS。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T17:08:44.430

将以下行添加到您的样式表中：

```
a {text-decoration:none;} 
```

# scripting - 无线 HTA 中的 DAO 与 ADO

> ID：904203
> 
> 赞同：2
> 
> 时间：2009-05-24T17:06:53.650
> 
> 标签：scripting, ado, wireless, dao, hta

我编写了一个在无线网络上运行的小型（8-10 台笔记本电脑）销售点系统，作为一个 HTA，它可以读取/写入位于网络共享上的 Access MDB。
我需要使用 ADO - GetString 并且用户名册不适用于 DAO。
我还需要使用 DAO——不能用 ADO 压缩 MDB。

我知道：
1）如果数据库后端不是Access MDB，我应该使用ADO。
2) 如果后端是 MDB，但我想在某个时候升级到 SQL Server，我应该使用 ADO。
3) 在 Access 应用程序或任何其他 VBA/VB 应用程序中，我应该使用 DAO，因为 ADO 必须经过 Jet OLE DB Provider 的转换层，而 DAO 更直接。
4) VBScript/JScript 允许我使用DAO 或ADO。

分两部分的问题如下：
1）在这个软件环境（HTA/脚本）中，使用ADO比使用DAO更好吗？
2) ADO 是否提供任何好处，因为 HTA 通过无线网络进行读/写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T17:29:02.530

1.  如果您需要 DAO 的唯一原因是压缩数据库，那么您可以为此使用 DAO，并为其他一切使用 ADO。您不仅限于使用 ADO 或 DAO。

2.  使用 ADO 的最大好处是在时机成熟时更容易迁移到 SQL Server Express。您应该尽早这样做，因为 SQL Server Express 提供了 MSAccess 数据库的所有优点而没有缺点。SQL Server Express 是免费的，它可以轻松处理您提出的系统大小。

Access 数据库在多用户环境中很容易损坏，尤其是在涉及无线网络时。如果您担心失去在 MSAccess 中工作的好处，您仍然可以使用链接表附加到 SQL Server，并以这种方式使用您的 SQL Server Express 数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-26T20:51:53.433

您还可以使用 JRO 压缩您的 MDB 文件。这将包含在任何最新版本的 MDAC 中，默认情况下安装在 XP 和更高版本的系统上。无需安装 Access。

要回答您的具体问题：

1) 我会选择 ADO 只是因为它更流行，并且相同的 API 可以用于其他类型的脚本，如 LDAP/ActiveDirectory 访问、读取文件系统文件夹、读取 MAPI 邮件以及使用其他类型的半-结构化文本文件，如固定宽度文本和 CSV。它并不是特别适合 HTA 编程环境，但可能更适合您学习更广泛适用的 API。我也认为它是一个更容易使用的 API，但我是从它开始的，后来才在一些较旧的 DAO 项目上工作。

2) ADO 提供的一个可能的好处是断开连接的记录集，这可能具有优势或至少在您的无线网络设置中提出了一些架构替代方案。您打开一个记录集，然后断开它，因此您仍然可以使用内存中的数据，但不必保持数据库连接处于打开状态。然后稍后您可以重新连接并更新数据库。此外，您可以通过将表作为本地 XML 或 ADTG 文件进行管理，以完全断开连接的方式工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-27T04:08:04.957

您可能会强迫 DAO 使用 VBScript，但这是一个奇怪的配对。一般来说，ADO 是最有意义的。

* * *

ADO 的另一个优点是它支持 RDS over DCOM 或 HTTP。这可用于克服通过文件共享使用的 Jet MDB 的许多限制，例如不可靠的网络和客户端可能导致的损坏。它还减少了网络上的流量，提高了性能。此外，它还提供了一个中间层，业务对象可以在其中“生存”，所有这些都可以在适用的情况下使用 COM+ 进行调解。

当然，您不再可以选择使用简单的 P2P 网络和文件共享来托管数据库。RDS 需要一个服务器来托管进程并运行 Jet 引擎，Jet 引擎不再需要在每个客户端系统上运行。这意味着您可以使用在服务器上运行的 Jet 存储过程，从而卸载更多的客户端处理和网络流量。虽然不像 T-SQL 或其他替代方案那样复杂，但这种 ADO/Jet 4.0 OLE DB Provider 专有技术提供了使用 DAO 无法获得的切实好处。

RDS 可以屏蔽使用断开连接的记录集的大部分过程，从而简化客户端代码。它在引擎盖下使用 ADTG，这是为此目的开发和优化的。

但是，与简单的文件共享相比，使用 RDS 需要更多的基础架构和专业知识。您不妨研究一下 SQL Server 的低端版本。

* * *

一般来说，我建议使用[jetcomp.exe](http://support.microsoft.com/kb/273956)实用程序通过 DAO 或 JRO 进行压缩和修复。它提供了许多优点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T20:52:37.177

如果您可以负担得起将 HTA 应用程序与 Access 一起使用，而不是使用性能更高的平台，我会说您应该使用最简单的 api。在您的情况下，瓶颈永远不会是数据库访问的抽象。不过，DAO 真的很老了。

# sql - 加入动态枢轴（版本 2）

> ID：904209
> 
> 赞同：1
> 
> 时间：2009-05-24T17:08:40.577
> 
> 标签：sql, sql-server, sql-server-2008, join

我有一些数据表：

**类别**

```
CategoryID     CategoryName

1              Home
2              Contact
3              About 
```

**位置**

```
PositionID     PositionName

1              Main menu
2              Left menu
3              Right menu 
```

...（可以稍后添加新行）

**类别位置**

```
CPID   CID    PID    COrder

1      1      1      1 
2      1      2      2
3      1      3      3
4      2      1      4
5      2      3      5 
```

如何制作这样的表格：

```
CID    CName     MainMenu   LeftMenu   RightMenu

1      Home      1          2          3
2      Contact   4          0          5
3      About     0          0          0 
```

如果稍后添加新的 Category 或 Position 行，则查询应自动反映更改，例如：

```
CID    CName     MainMenu   LeftMenu   RightMenu   BottomMenu

1      Home      1          2          3           0
2      Contact   4          0          5           0
3      About     0          0          0           0
4      News      0          0          0           0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T19:06:58.983

以下动态查询似乎有效：

```
declare @columnlist nvarchar(4000)
select @columnlist = IsNull(@columnlist + ', ', '') + '[' + PositionName + ']'
from #Position

declare @query nvarchar(4000)
select @query = '
    select *
    from (
        select CategoryId, CategoryName, PositionName, 
                IsNull(COrder,0) as COrder
        from #Position p
        cross join #Category c
        left join #CategoryPosition cp 
                on cp.pid = p.PositionId 
                and cp.cid = c.CategoryId
    ) pv
    PIVOT (max(COrder) FOR PositionName in (' + @columnlist + ')) as Y
    ORDER BY CategoryId, CategoryName
'

exec sp_executesql @query 
```

一些澄清：

*   @columnlist 包含动态字段列表，由 Positions 表构建
*   交叉连接创建所有类别和所有职位的列表
*   left join 寻找对应的 COrder
*   max() 选择每个类别+位置的最高 COrder，如果有多个
*   PIVOT() 将各种 PositionNames 转换为单独的列

PS我的表名以#开头，因为我将它们创建为临时表。删除 # 以引用永久表。

PS2。如果有人想尝试一下，这里有一个脚本可以在这个问题中创建表格：

```
set nocount on 

if object_id('tempdb..#Category') is not null drop table #Category
create table #Category (
    CategoryId int identity,
    CategoryName varchar(50)
)

insert into #Category (CategoryName) values ('Home')
insert into #Category (CategoryName) values ('Contact')
insert into #Category (CategoryName) values ('About')
--insert into #Category (CategoryName) values ('News')

if object_id('tempdb..#Position') is not null drop table #Position
create table #Position (
    PositionID int identity,
    PositionName varchar(50)
)

insert into #Position (PositionName) values ('Main menu')
insert into #Position (PositionName) values ('Left menu')
insert into #Position (PositionName) values ('Right menu')
--insert into #Position (PositionName) values ('Bottom menu')

if object_id('tempdb..#CategoryPosition') is not null 
    drop table #CategoryPosition
create table #CategoryPosition (
    CPID int identity,
    CID int,
    PID int,
    COrder int
)

insert into #CategoryPosition (CID, PID, COrder) values (1,1,1)
insert into #CategoryPosition (CID, PID, COrder) values (1,2,2)
insert into #CategoryPosition (CID, PID, COrder) values (1,3,3)
insert into #CategoryPosition (CID, PID, COrder) values (2,1,4)
insert into #CategoryPosition (CID, PID, COrder) values (2,3,5) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T17:21:41.823

由于 PIVOT 需要列的静态列表，我认为基于动态 sql 的方法实际上是您可以做的所有事情： [http ://www.simple-talk.com/community/blogs/andras/archive/2007/09/ 14/37265.aspx](http://www.simple-talk.com/community/blogs/andras/archive/2007/09/14/37265.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T20:02:44.783

正如几位发帖人所提到的，使用 PIVOT 命令的动态 SQL 是可行的方法。不久前，我编写了一个名为[**pivot_query.sql**](http://www.dot-dash-dot.com/files/pivot_query.sql)的存储过程，这对于此目的非常方便。它是这样工作的：

```
-- Define a query of the raw data and put it in a variable (no pre-grouping required)
declare @myQuery varchar(MAX);

set @myQuery = '
select
   cp.cid,
   c.CategoryName,
   p.PositionName,
   cp.COrder
from
   CategoryPosition cp

   JOIN Category c
      on (c.CategoryId = cp.cid)

   JOIN Position p
      on (p.PositionId = cp.pid)';

-- Call the proc, passing the query, row fields, pivot column and summary function
exec dbo.pivot_query @myQuery, 'CategoryName', 'PositionName', 'max(COrder) COrder' 
```

pivot_query 调用的完整语法是：

```
pivot_query '<query>', '<field list for each row>', '<pivot column>', '<aggregate expression list>', '[<results table>]', '[<show query>]' 
```

[它在源代码](http://www.dot-dash-dot.com/files/pivot_query.sql)顶部的注释中有更多解释。

此 proc 的几个优点是您可以指定多个汇总函数，例如 max(COrder)、min(COrder) 等，并且可以选择将输出存储在表中，以防您想将汇总数据与其他信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T17:26:12.597

我想您需要使用 PIVOT 进行选择。默认情况下，数据透视仅选择列的静态列表。网上有一些处理动态列枢轴的解决方案，例如[这里](http://www.sqlprof.com/blogs/sqldev/archive/2008/04/12/pivots-with-dynamic-columns-in-sql-server-2005-2008.aspx)和[这里](http://sqlblogcasts.com/blogs/madhivanan/archive/2008/08/27/dynamic-pivot-in-sql-server-2005.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T02:01:27.337

我的建议是将您的数据作为简单的连接返回，并让前端对其进行整理。SQL 在某些方面非常出色，但这个特殊问题似乎是前端应该做的事情。当然，如果不了解您的全部情况，我无法知道这一点，但这是我的预感。

# django - 带有点 (.) 的 Django url 模板标记和变量值

> ID：904214
> 
> 赞同：1
> 
> 时间：2009-05-24T17:12:46.793
> 
> 标签：django, url, templates, tags

为什么 {% url myVar %} where myVar = 'jack.johnson' 不起作用？

视图很好，urls.py 是： url(r'^(?P[A-Za-z0-9-._]+)/$', overview, name='user_profile'),

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T17:29:06.337

因为 URL 名称是“user_profile”，而不是“jack.johnson”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T17:40:08.443

确认您至少使用 Django 1.0（命名的 url 模式在此之前不存在），重新阅读有关[Naming URL Patterns](http://docs.djangoproject.com/en/dev/topics/http/urls/#naming-url-patterns)的 Django 文档，然后尝试

```
{% url user_profile myVar %} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T19:18:29.240

伙计们，对不起。我发现了我的错误，我给出的例子具有误导性。感谢您及时的回复。

# svn - 无法基于 SVN 更新我的本地 Git 存储库

> ID：904217
> 
> 赞同：2
> 
> 时间：2009-05-24T17:14:23.830
> 
> 标签：svn, git

我知道哪个命令以我当前的版本号为我更新文件的[线程，而不是最新的文件。](https://stackoverflow.com/questions/842915/unable-to-git-pull-to-update-my-git-local-repo)

我在 Google 代码项目的主干上运行失败

```
git svn update 
```

我得到

```
fatal: Not a git repository (or any of the parent directories): .git
Already at toplevel, but .git not found
 at /opt/local/libexec/git-core/git-svn line 235 
```

我已经一个月没有更新仓库了。发布了一个新版本。我上次能够通过上述命令更新 repo。

**如何通过 Git 更新基于 Svn 的存储库？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T17:37:11.943

在本地，您是否在一个由 Git 创建的 SVN 存储库的签出文件夹中？还是SVN做的结账？

如果我了解您要做什么，请使用 Git 获取 SVN 存储库中的最新更新...而不是此命令

```
 git svn update 
```

[根据这些文档](http://git-scm.com/docs/git-svn)不存在。您应该通过使用类似于以下命令的拉取源来初始化 SVN 存储库的本地 Git 版本：

```
 git svn clone http://code.google.com/blah -T trunk -b branches -t tags 
```

...然后要在主干文件夹中获取最新更新，您应该：

```
 cd trunk
  git svn rebase 
```

该文档链接上的示例非常有帮助。

# command-line - 删除 .git 时的奇怪行为

> ID：904221
> 
> 赞同：0
> 
> 时间：2009-05-24T17:15:47.383
> 
> 标签：command-line, command-line-interface

我试图删除我的 Git 文件：

```
rm -R .git | yes 
```

我的 CPU 变得响亮，并且没有文件被删除。我无法理解发生了什么。如何删除我的 .git 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T17:20:28.297

尝试

```
yes | rm -r .git 
```

您将 rm 的输出传递给 yes （流向左-> 右），但由于 yes 不读取标准输入，因此 rm 只是挂在那里。

另外，无论如何，您实际上并不需要是。由于您真正想以自动方式用“是”回答的唯一问题是是否删除只读文件，您可以使用 -f 参数（“强制”）：

```
rm -rf .git 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T17:21:22.667

.git 下可能有**很多**文件。尝试使用

```
$ rm -Rvf .git 
```

这样它会告诉你哪些文件正在被删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T18:11:56.957

看起来您正在尝试`rm`通过将 的输出管道化来处理在每次删除之前要求确认`yes`，这会在 rm 中产生无限数量的“y”字符，但您做错了。

```
rm -Rf .git      # the -f option is "force", i.e. don't ask for confirmation. 
```

如果要将一个命令的输出通过管道传输到另一个命令，则源必须排在第一位，在管道之前：

```
yes | head 
```

# c# - ASP.NET：在导航按钮回发时避免使用 RequiredFieldValidator

> ID：904222
> 
> 赞同：6
> 
> 时间：2009-05-24T17:16:49.083
> 
> 标签：c#, asp.net, requiredfieldvalidator

我有一个带有两个RequiredFieldValidator 的ASPX 页面和一个用于转到另一个页面的按钮。这个按钮必须做一个回发才能知道去哪里。这个按钮可以随时点击。

问题是RequiredFieldValidators 没有被禁用并显示他们要求一个值的消息。

当用户单击此特殊按钮时，有什么方法可以避免验证？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T17:19:03.993

在特殊按钮上将 CausesValidation 设置为 false，或者将 RequiredFieldValidators 放在 ValidationGroup 中，其中包含任何应该导致验证的内容。（应该导致验证的按钮和验证器都应该在同一个验证组中）第一个选项应该工作并且是最快的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T17:19:15.680

原因验证 =“假”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T17:19:36.240

您可以`ValidationGroup`在控件中添加一个。

在提交按钮上，您还添加了一个`Validationgroup`

# objective-c - 如何在 NSValueTransformer 中进行字符串操作？

> ID：904224
> 
> 赞同：0
> 
> 时间：2009-05-24T17:18:36.490
> 
> 标签：objective-c, cocoa, string

我有一个表列，我绑定到`NSArrayController`. 我想要做的是只显示数组控制器中实际值的子字符串。到目前为止，我一直在尝试这样做的方法是创建一个`NSValueTransformer`子类，然后在`transformedValue`方法中进行字符串操作。但是，我不知道如何将传入的值转换为字符串（它的类型为`NSConcreteValue`），也许有一种更简单的方法可以在没有值转换器的情况下做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T18:06:50.287

听起来您正在进行演示端格式化，在这种情况下，您应该改用格式化程序。

再说一次，如果这是一个包含多个值的字符串（例如，“从 42 到 100”之类的东西），你应该用它创建一个模型对象，并将它们存储在数组控制器中。然后，您可以将表列绑定到模型对象的特定属性，而不必担心将字符串分开然后重新组装（加载并稍后保存模型时除外）。

编辑：没关系；我没有看到对象值是 NSValues，而不是 NSStrings。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T20:47:28.310

您可以使用该方法获得任何对象的字符串表示形式`-description`，但对于 NSValue 的实例，它不太可能打印任何特别有意义的内容。换句话说，由你的值转换器来解释传入的对象并生成一个字符串。如果它是一个 NSValue 实例，那么问题是该实例包含什么类型的数据。一旦知道这一点，就可以编写代码将其表示为字符串（类似于`NSStringFromRect()`）。

# c# - 类名很常见怎么办？

> ID：904233
> 
> 赞同：3
> 
> 时间：2009-05-24T17:21:50.107
> 
> 标签：c#, .net, naming-conventions, class-design

我刚刚在我的 .net 项目中添加了另一个 3rd-party 组件，其中包含一个名为的类`Client`，它让我想到了常见的类名。

您是否将您的公共课程命名为像 一样常见`Client`的名称，或者您是否尝试使名称更具体？

过去我会说这很好，`Client`因为它总是可以通过它的命名`Company.Product.Client`空间（`WebClient``TcpClient``SmtpClient`

我认为 like 的名字`MessagePub.Client`看起来很整洁，`MessagePub.MessagePubClient`但更不用说，但是有很多`Client`s 浮动也感觉很混乱。

我使用的所有这些第 3 方组件实际上都是开源的，因此是否建议重构并将它们的类名更改为更具描述性的名称，以使我的代码更具可读性，或者通过它们的命名空间访问是一个更好的主意？或者它只是无关紧要？:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T17:37:32.503

我认为一个更具描述性的名字几乎总是更好。它不仅是一个技术问题，而且肯定也是一个语义问题：一方面，它迫使你思考你正在处理什么样的类，并帮助你设定界限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T18:07:00.833

当您必须处理使用相似/相同名称的第三方库时，不要忘记[**命名空间别名量词：**](http://msdn.microsoft.com/en-us/library/c3ay4x3d.aspx)

```
using Excel = Microsoft.Office.Interop.Excel;
using Word = Microsoft.Office.Interop.Word; 
```

像这样，您可以轻松区分不同的类：

```
Excel.Application excelApp = new Excel.Application();
Word.Application wordApp = new Word.Application(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T17:29:47.537

如果您的标识符被命名空间消除歧义，那么我无法想象您应该添加更多噪音。就像你说的，感觉很乱。

如果您有可能拥有不止一种，`MessagePub.Client`例如，只需要消息摘要的，或者是其他接口的消息适配器，那么您当然需要澄清这一点。也许`MessagePub.DefaultClient`对于常见的情况，`MessagePub.DigestClient`对于摘要消费者，或者`MessagePub.LogAdaptorClient`对于消息适配器

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T17:45:17.030

更具描述性的名称是一个更好的主意......因为您将使用以下语句资助某人：

```
using Company.Product;
using SomeOtherThing.Product; 
```

...如果`Client`同时出现在两个命名空间中，那么您就会有一些不可读的代码。

常见的对象名称，如`Client`, `Product`, `User`, `Person`,`Message`等...我几乎总是会在前缀上加上一些反映其更大目的的标识符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T17:34:36.657

好吧，类越具体，它应该有一个更具体的名称 - 考虑到它 DoesNotGetUnnecessaryLongAndUnhandy。

当然，命名空间是区分命名和增加代码解释力的好方法。但是，我不会为了使用不同的命名而重构任何东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T18:05:49.633

> 您是否将您的公共类命名为与 Client 一样常见的名称，或者您是否尝试使名称更具体？

我尝试做两件事：

1.  *我*的任何两个类都没有相同的名称（但我不在乎我的任何类名称是否与第 3 方的名称冲突：这就是名称空间的用途）。

2.  我的类几乎从不与任何 Microsoft System 类同名（例如，我不会创建一个名为`Dictionary`or的类`Form`）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-02T12:55:03.380

客户是一个糟糕的名字，它到底是什么客户？我会说诸如 MailClient、MicrowaveClient、TelephoneClient 等的复合。

# .net - 如何在 F# 中创建与 .NET 兼容的事件？

> ID：904235
> 
> 赞同：9
> 
> 时间：2009-05-24T17:23:47.577
> 
> 标签：.net, events, f#

我正在尝试从 F# 类型发布事件，但我希望它被视为来自 C# 或 VB 的事件。似乎正确的方法曾经是 IEvent.create_HandlerEvent，但这个函数在最新版本的 F# 中不存在。那么现在正确的做法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-24T17:33:19.217

事件不是我的强项，但这个例子似乎适用于 F# 1.9.6.16：

```
namespace EventExample
open System
type MyEventArgs(msg:string) =
    inherit EventArgs()
    member this.Message = msg

type MyEventDelegate = delegate of obj * MyEventArgs -> unit

type Foo() = 
    let ev = new Event<MyEventDelegate, MyEventArgs>()

    member this.Ping(msg) =
        ev.Trigger(this, new MyEventArgs(msg))

    [<CLIEvent>]
    member this.GotPinged = ev.Publish 
```

也可以看看

[http://cs.hubfs.net/forums/thread/10555.aspx](http://cs.hubfs.net/forums/thread/10555.aspx)

# mysql - 移动过期物品？

> ID：904237
> 
> 赞同：1
> 
> 时间：2009-05-24T17:24:45.237
> 
> 标签：mysql, ruby-on-rails, model, archiving

我有一个具有到期日期的模型帖子。我想知道在这种情况下管理可伸缩性的最佳方法是什么。2个选项：

1.  每当我想从表中选择时，我需要包括 where expiry_date > NOW。如果表 Post 长得像个怪物，那我就麻烦了。想象一下 3 年或更长时间。索引也将是巨大的。

2.  有一个触发器、cron 作业或一个插件（如果存在）可以绕过表并将过期项目移动到新表 Post_Archive。这样，我在主表中只保留当前的帖子，这意味着在 3 年内我不会像选项 1 那样糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T17:42:25.913

如果您需要连续归档数据（您的 #2），那么 MaatKit 是一个不错的选择。

[http://www.maatkit.org/](http://www.maatkit.org/)

它可以“蚕食”成块的数据，而不是运行消耗大量资源的大量查询（并避免污染您的密钥缓存）。

所以是的，你会从 cron 运行 Maatkit 作业。

同时，如果你想同时做#1，你可以实现一个方便地包装“WHERE expiry_dat > NOW”条件的视图，这样你就不必将它全部包含在你的代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T17:45:40.040

一个 cron 工作对我来说听起来不错，可以通过将一个简单的脚本直接提供给`mysql`命令来完成，例如，大致：

```
CREATE TEMPORARY TABLE Moving
SELECT * FROM Post WHERE expiry > NOW();

INSERT INTO Post_Archive
SELECT * FROM Moving;

DELETE FROM Post
WHERE id IN (SELECT id FROM Moving);

DROP TEMPORARY TABLE Moving; 
```

# roadmap - 你有没有被一些新的和不成熟的技术烫伤手？

> ID：904238
> 
> 赞同：51
> 
> 时间：2009-05-24T17:24:50.307
> 
> 标签：roadmap

我经常听到人们说，在新技术变得稳定、经过尝试和测试之前，你不应该急于采用新技术。甚至有一个笑话说需要 3 个版本才能做到正确。这可能是现实生活经验的声音，但至少有时这种姿势是自满、抗拒改变和学习新技能所必需的努力的结果。

然而，在我看来，跟上创新的步伐对于软件行业的成功至关重要。虽然大公司有专门的研发部门，但在小公司中，开发团队必须跟上。甚至在它正式推出之前就开始使用新技术——这将为您提供一些先机，并帮助您跟上其余的步伐。

这是我尽可能遵循的策略：

*   积极采用新技术
*   使用早期测试版进行试验，使用原型和 RC 进行开发
*   当您早期采用的技术正式发布时，解决产品的任何最后一分钟更改
*   不要依赖一些活动为 0 的晦涩的开源项目
*   一定要学习，但要对官方产品路线图持保留态度。

到目前为止，我从来没有为太热心跳上一些新技术而付出代价，但我仍然收获了好处。我想知道这是否只是一个巧合，或者作为早期采用者毕竟不是那么危险？

不仅仅是邀请就早期采用这个主题进行讨论，因为这样的问题肯定是有争议的和主观的，我想听听现实生活中的经验，即采用早期的新技术被证明是一个严重的错误，而且必须付出惨重的代价有薪酬的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-07-23T15:07:10.680

我可以编写一个相当不错的 Java Applet。所有的技术最终都会被淘汰出局，但是这一项有非常急剧的上升和下降。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-01-07T06:26:53.030

我目前正在被 Microsoft Office Word 2007 的 CustomXML 支持所困扰。

CustomXML 允许文档具有可以对业务数据等进行建模的自定义元素。例如，您可以使用自定义元素定义 XSD，将其与 docx 文件相关联，然后将占位符生成为 CustomXML 标记并使用导航/修改文档C#（或其他 .NET 语言）和[OpenXML SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&displaylang=en)。OpenXML 的好处在于它无需在服务器机器上安装 Office 以实现自动化目的，并且是购买 3rd 方库的替代方案。

简而言之，有一场关于 Word 2007 能够使用自定义 XML 打开文档的诉讼。从[这篇文章](http://news.softpedia.com/news/New-Office-2007-Copies-Coming-after-Custom-XML-Appeal-Was-Denied-to-Microsoft-130553.shtml)：

> 8月11日，公司收到Office Word销售禁令...
> 
> “此禁令仅适用于在 2010 年 1 月 11 日或之后在美国销售的 Microsoft Word 2007 和 Microsoft Office 2007 的副本。在此日期之前销售的这些产品的副本不受影响。”

Microsoft 的回应是从 Word 的未来版本中删除对 CustomXML 的支持，并且正在发布一个将完全删除此功能的补丁。这是[官方更新的链接](http://support.microsoft.com/default.aspx?kbid=974631)。根据[此 Microsoft OEM 合作伙伴中心网站](http://oem.microsoft.com/script/contentpage.aspx?pageid=563214)：

> 美国需要以下补丁。该补丁适用于所有 Office 2007 语言。
> 
> 安装此补丁后，Word 将不再读取 DOCX、DOCM 或 XML 文件中包含的自定义 XML 元素。这些文件将继续打开，但所有自定义 XML 元素都将被删除。处理自定义 XML 标记的能力通常与 Word 文档的基于服务器的自动化处理结合使用。大多数 Word 最终用户通常不使用自定义 XML。

我想象一小部分最终用户和开发人员使用它，所以我认为最后一句话是准确的。问题是目前没有关于如何推进使用该技术的项目的消息（没有双关语）。CustomXML 是我目前正在从事的一个大型项目的基石。这个决定的影响不是积极的，它有效地阻止了任何前向兼容性，因为没有等效的替代方法来维护 CustomXML 提供的结构。

我和我的一些同事对这个话题有丰富的知识......我想我们没有像我们计划的那样写博客文章是件好事 :) 我们已经完成了一些令人印象深刻的壮举，并且VSTO，但这个消息令人失望。

如果有人对此主题感兴趣，这里有一些文章可以查看：

ZDNet 文章：

*   [微软在超过 2 亿美元的自定义 XML 专利侵权案中败诉](http://blogs.zdnet.com/microsoft/?p=4835)
*   [Microsoft 从 Office 2007 中删除自定义 XML 功能](http://blogs.zdnet.com/Bott/?p=1600)

BNet 文章：

*   [微软行动迅速，已经为 Word 提供了自定义 XML 补丁](http://industry.bnet.com/technology/10004493/microsoft-moves-fast-already-has-custom-xml-patch-for-word/)
*   [微软可能会从订单不卖字中获得优势或痛苦](http://industry.bnet.com/technology/10004489/microsoft-might-get-advantage-or-pain-from-order-to-not-sell-word/)

软百科文章：

*   [微软不再销售 Office Word 2010、2007 或 2003](http://news.softpedia.com/news/Microsoft-Can-No-Longer-Sell-Office-Word-2010-2007-or-2003-118986.shtml)
*   [微软道奇 Office Word 销售禁令——至少暂时如此](http://news.softpedia.com/news/Microsoft-Dodges-Office-Word-Sales-Injunction-120953.shtml)
*   [自定义 XML 申诉被 Microsoft 拒绝后新的 Office 2007 副本即将推出 - 从 2010 年开始](http://news.softpedia.com/news/New-Office-2007-Copies-Coming-after-Custom-XML-Appeal-Was-Denied-to-Microsoft-130553.shtml)

**编辑：**添加了官方更新的链接。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-24T17:53:25.770

几年前，我们大量使用了名为 Notification Services 的新 SQL Server 2005 功能。令我们沮丧的是，它在 SQL Server 2008 中已停止使用。这是一个严重的问题，导致软件架构师质疑所有新的 Microsoft 技术。

这里有一些[细节](http://social.msdn.microsoft.com/forums/en-US/sqlnotificationservices/thread/03cb63a9-7fe7-408d-b194-7ff3d14e682a/)，还有[更多](http://blog.desktopalert.net/blogs/da_blog/archive/2008/02/16/25.aspx)，[更多](http://social.msdn.microsoft.com/forums/en-US/sqlnotificationservices/thread/6feee1e8-3b79-4b8c-8e28-ac1f1f26ee44/)

[微软的实体框架](https://stackoverflow.com/questions/276433/do-you-think-its-advantageous-to-switch-to-entity-framework)也存在问题。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-01-04T16:24:55.933

其他人还记得 OpenDoc，Apple 关于如何编写所有新的 Mac 应用程序的想法吗？没想到。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-01-05T10:51:36.750

斯卡拉。

它在纸上看起来很棒，所以我用它写了一个项目，同时确保我的 Scala 版本保持最新。版本号 (2.7.x) 及其多年的开发让我觉得这样做相对安全。

好吧，我犯了一个错误。问题？严重缺乏文档和代码示例，以及不断变化的类库（在我的工作中两次，以前工作的代码开始收到“弃用”警告..​​....我说的是几个月的时间和类似的版本数）。

我不能说我失去了很多（这是一个私人项目），但我不会在不久的将来接触 Scala。不过，我仍然认为它是一种非常好的、有前途的语言。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-24T17:29:58.990

是的，我有！使用 JSF 1.0！在发布之前，Sun 似乎没有很好地审查它。

我们一直在努力让事情顺利进行，但不久之后我们才发现我们的错误是由 JSF 错误引起的，我们不得不使用变通方法。直到 JSF 1.1 和 myfaces-tomahawk 实现的使用，该项目才开始有一些速度。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-05-24T17:37:34.500

当我还在的时候`10`，我父亲试图在一个全新的机器上为我演奏一首新年歌[`Elektronika BK-0010-01`](http://en.wikipedia.org/wiki/Elektronika_BK)。

不用说合成器无法从磁带中加载，直到邻居带着吉他来之前没有歌曲。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-07-23T15:05:15.940

QBASIC 从未真正起飞。我也花了几年时间学习它。

好吧，公平地说，这是我的第一语言，也是一种学习的好方法。后来它被 Visual Basic 取代，然后是 VB.NET。所以这并没有完全浪费我的时间。;)

大多数情况下，即使一种语言没有完全“起飞”，它仍然是一种很好的学习体验，可以应用于其他事物。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-01-04T15:49:31.777

德尔福.NET。当我听到这个时仍然有抽搐！

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2010-01-08T18:45:52.073

最糟糕的是，当您使用新产品完成一个项目并获得了 80% 的收益并遇到了一个惊人的错误时。

早在 80 年代中期，我的老板建议我尝试一种名为 KnowledgeMan 的新 dBase 替代方案。很久以后，我才意识到一些我认为是我的关键错误实际上是他们的。整个事情必须从头开始重做；它让我失去了工作。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-01-08T18:54:36.843

是的。我是一名 Lisp 程序员：在我看来，*一切都是*新的和不成熟的。:-)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2010-01-07T15:15:10.277

### AzMan（微软授权管理器）

我们开始在公共网站/网络应用程序上使用它，被单点登录的梦想和能够“利用现有基础设施”或营销现在所说的任何东西所吸引。系统管理员无需开发任何工具或编写任何代码即可管理的 ASP.NET 嵌入式解决方案。这是双赢的，对吧？

由于我们的决定，我们学到了几件事，但我们都不想学习：

*   对于服务于公共网站的身份验证机制，Active Directory 本身并不是一个很好的选择。并不是说它没有能力——它非常有能力，但这就像聘请一个博士来编写一个“Hello World”应用程序。它的资格过高，在这种情况下它*的功能**远远*超出您的需要，它比普通的旧 SQL 表更难使用，并且需要*更多的*维护。

*   阿兹曼很慢。非常非常慢。角色提供者必须维护一个*缓存*，它应该告诉你我们正在谈论什么样的性能。我从来没有完全理解它为什么这么慢，但我想它与 COM 的大黄蜂巢和它所依赖的网络协议有关。

*   当您几乎无法控制缓存时，缓存（见上文）可能是一件非常危险的事情。当我们手动添加新用户（即通过管理应用程序而不是站点本身）时，这些用户最终会看到“未授权”屏幕，直到缓存过期并注销。有时这甚至会发生在网上自行注册的用户身上；我们从来没有找到原因。

*   这些工具太可怕了。如果您不相信我，请[简要查看 AzMan 控制台](http://www.windowsecurity.com/articles/Authorization_Manager_Role_Based_Administration_Windows_Server_2003_Part1.html)，或者如果您真的想头疼，请阅读一些[文档。](http://support.microsoft.com/kb/324470)为什么事情要这么复杂？

*   这是片状的。很多时候，提供者会停止工作，吐出神秘的 COM 错误（每次都不一样！），我们不得不重新启动 IIS 甚至整个 Web 服务器以使其再次合作。我们还设置了域信任 - 因为显然我们不希望内部公司域上有 50,000 个公共用户帐户 - 唯一的问题是，管理员必须登录*辅助域上的*管理帐户来管理角色，因为控制台会失败如果您尝试从主域使用它（甚至作为在辅助域上具有域管理员权限的企业管理员），则以神秘的方式使用它。

*   支持几乎不存在。如果您使用基本的 SQL Server 角色提供程序（我们不使用，但仅作为示例），则有 1000 万个教程，您可以通过 Google 搜索任何错误消息或在任何论坛上提问。每当 AzMan 出现问题或者我们想做一些新的事情时，我们都在不断地努力寻找好的信息。

*   代码集成很尴尬。你必须经过一堆凌乱的 COM 层，然后界面就糟透了。如果我没记错的话，没有办法只做一个简单的授权检查——你必须下载整个应用程序/角色注册表。不过这是很久以前的事了，所以我的记忆在这方面可能是模糊的。

最终我们不能再忍受了，决定拆掉整个系统，建立一个基于几个 SQL Server 表的自制系统，这可能是我们从一开始就应该做的事情。迁移是痛苦的（参见上面的两点），但我们完成了它，并且从未回头。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2010-01-08T16:50:23.507

不幸的是，它是双向的。当我们第一次开始在 Windows 上开发一个基于 Web 的大型应用程序时，.NET 已经发布了测试版——不久之后 .NET 1.0 的最终版本就发布了。

但是因为它是新的，我们不知道会发生什么，它会有多受欢迎，以及 MS 是否会在六个月后放弃它。所以我们坚持使用久经考验的 VB6。

我们仍然必须保持 VB6 的传统，而且它已经限制了一段时间。尽管它没有在任何地方列出，但我们越来越怀疑在给定版本的 Windows 中将取消对 VB 运行时的支持。

也就是说，走 .NET 路线可能有其自身的痛苦：1.0、1.1 和 2.0 相继推出，每个版本都与之前的版本（有些）不兼容。因此，必须迁移 .NET 平台会带来不同的风险。少还是多？无法回答没有经历过的人:-)

最后，如果你这样做，你会被诅咒，如果你不这样做，你会被诅咒。如果有人能读懂内脏来确定某项技术是否会在任何时候取得成功，那么他们不应该在软件领域工作，而应该转而从事对冲基金管理，赚取大量现金并提前退休： -)

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2010-01-04T16:14:04.677

当然好

我目前正感受到成为 Fortran 2003 早期采用者的痛苦 :-)

标记

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2010-01-06T17:53:24.517

Mozilla XULRunner。

在 AIR 出现之前，它是 Adob​​e AIR。我们使用它编写了我们的人力资源管理系统。当时 XULrunner “即将”作为 FireFox 的下级引擎发布，所以我们预计我们所要做的就是确保我们的用户安装了 FireFox。

项目进行了 2 年，就在部署之前，一个新的 XULrunner 出现了，它完全破坏了我们所有的代码，而且还看不到 Firefox 部署。我们最终使用专用的桌面安装程序在旧版本上进行了部署，并且一直使用它，但没有安全或性能更新的好处，因为我们必须重新编写太多代码才能兼容。尽管如此，这对我们的客户来说是一个非常成功的项目。

我们现在正在重新编写应用程序以在 Ext 上运行，这对我们来说是新的热门事物，但似乎有更多的社区支持，如果我们真的遇到某些问题，它会提供商业支持。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2010-01-07T10:34:51.207

**爪哇**

我非常渴望在 1996 年开始研究它，并将它用于多个项目。但是对于 Web 开发，我一直更喜欢 Perl，而现在是 PHP。GUI 开发我最终主要使用 .NET。对于少数无法通过脚本处理的命令行程序，我更喜欢使用 Perl、Python 甚至 PHP。

我编写的 Java 程序很少被长期使用，而我的一些 pre-java 应用程序仍在使用中。

我认为其主要原因是用 Java 开发某些东西总是比使用另一种编程语言花费更长的时间：因此生成的应用程序包含更少的功能并且更容易替换。

由于开发速度通常对我的客户来说是一个问题，Java 往往最终成为第二选择。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2010-01-04T16:16:38.950

作为 MonoTouch 的早期采用者，我每天都非常接近火焰。我永远不知道这个框架接下来会发生什么。但值得称赞的是，Novell 团队大约 24/7 都在用灭火器待命 :)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2010-01-08T02:31:44.180

## 由于缺乏市场占有率：

*   谷歌的围棋
    *   糟糕的工具链，缺乏与流行的编译器和 C 的集成。
*   蟒蛇3000
    *   缺少必备功能：迭代器、清理内部结构和更整洁的界面对我们的铁杆用户来说很不错，但大多数人想要性能，而这还没有交付。
*   C++0x
*   C99
    *   已经 12 年了，还没有主流编译器完全实现这一点。为了安全起见，流行的项目和利基架构仍保留在 C89 上。

## 对于劣质：

*   视窗
    *   '纳夫说。
*   强制
*   C++

## 对于落后于上游：

*   Windows 上的 PyGTK
*   MSVC C 支持

*请注意，我列出这些技术绝不意味着它们不好，我是所有这些技术的忠实粉丝（除了质量差的技术）。我对被这些技术烧毁的第一手观点是（通常我试图将它们作为现有技术的替代品，或者只是在已经进行了大量投资后遇到障碍。*

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2010-01-08T21:01:56.963

Mac OS X 上的 64 位 Carbon API：我个人并没有对此感到厌烦，但我有一个朋友在一家大型软件公司工作，花了一年时间将他们几乎所有的代码都转换为使用 64 位 Carbon API 才发现在 WWDC 上，这些 API 将不再可用。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2010-02-01T17:29:40.417

有人注意到这里的趋势吗？这里的大部分技术都是由微软创建、取消或修改的...

我也被微软烧毁了对实体框架的更改。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-05-24T17:38:09.477

> 然而，在我看来，跟上创新的步伐对于软件行业的成功至关重要。

这并不能回答您的具体问题，但是您可能会感兴趣一本书，名为[Crossing the Chasm](http://en.wikipedia.org/wiki/Crossing_the_Chasm)。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-07-23T15:04:58.267

对我来说，Delphi 的 IntraWeb 就是这样。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-07-23T15:07:59.807

我曾经被迫使用[witango](http://www.witango.com)，但我已经克服了。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2010-01-08T07:34:48.253

不是编程，但仍然是一个更新的技术错误——我的第一个 mini-ATX 构建几乎失去了一个乳头，这个故事的寓意是永远不要靠在一个箱子上，同时试图在它被卡住时强行关闭它......

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-05-24T17:48:56.290

我可以数出很多。当我想到 WLPI（一个旧的 BEA 工作流程产品）时，仍然会感到痛苦。从来没有解决过，*供应*商放弃了它。叹息...

无论如何，我想说跟上最新的（知道那里有什么，考虑一下）是非常值得的，但只有在以下情况下才能生活在最前沿：

1.  您准备好被割伤和流血（金钱/时间/资源）
2.  它提供了重要的战略优势/竞争力。

AJAX 就是一个很好的例子。现在已经足够成熟，每个新网站都应该这样做，除非他们有令人信服的理由不这样做，但是当它第一次成为可能时，与传统替代方案相比，建立在它之上的网站会非常昂贵。

一些网站需要最新的外观和感觉才能保持竞争力，甚至到了网站本身的功能是次要的并且它们需要成为 AJAX 早期适配器的地步。其他人没有。知道你是谁，并采取相应的行动。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-07-23T15:09:35.450

黑鸟。

为 MSN 创建交互式内容的绝佳开发环境。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2010-01-07T12:45:50.683

真正的基本

在 1980 年代中期，我们一直在寻找一个可以在各种 DOS 实现上工作的开发平台，而不是像 C 那样“小题大做”的语言。

我们发现了 True Basic，它被宣传为由 BASIC 的原始创建者于 1964 年创建。这是一种“编译”为 p 代码的语言。它不仅可以在 DOS 机器上运行，还可以在 GEM (Atari-ST) 和 Amiga 机器上运行。

它有很多附加组件，就像我们过去在我们使用的 VAX/VMS 机器上使用的开发环境一样。诸如 Forms 包、“ISAM”附加组件（在 PC 上可调用数据库的时代之前）等。

不幸的是，多平台能力从来没有足够卖过语言。哎呀，根据维基百科，有一个 Mac OS 版本（虽然不是 OS X 或 Snow Leopard）。我什至在写这篇笔记时发现了“当前”的 TrueBasic 页面。

最终 Visual Basic 1.0 出来了，所有的 BASIC 程序员，像我一样，都检查了它，因为上面有微软的名字。现在，当然，在 10 个版本之后，我们已经转向 .Net 平台，而 TrueBasic 位于 V5.5。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2010-01-08T03:18:03.120

Windows 开放服务架构 (WOSA)： [http ://en.wikipedia.org/wiki/Windows_Open_Services_Architecture](http://en.wikipedia.org/wiki/Windows_Open_Services_Architecture)

ODBC、MAPI、TAPI 等的基础。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2010-01-09T05:42:07.063

Windows Azure 的 .NET 服务......他们取消了它。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2010-01-10T06:25:25.123

[VBA](http://en.wikipedia.org/wiki/Visual_Basic_for_Applications) - 我们花了很多时间将它集成到我们的产品中。我们仍然在每个新版本上花费大量时间，以确保我们不会破坏任何东西。VB6 和 VBA 也是基于 COM 的，如果您想以标准用户身份运行并且没有对注册表的写入权限，这将是一个问题。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-01-04T22:35:48.023

这比您的问题更能解决您的讨论。我认为您假设采用新技术的成本效益是给定的。对于一个非常大的公司来说，改变技术可能会花费数亿美元。如果没有成本效益，那么可以节省数亿美元。大多数公司使用技术来制造其他东西，不能仅仅因为新技术的存在而消费新技术。当成本效益存在时，这样做是有意义的。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2010-01-07T12:14:26.383

我对模型驱动开发非常感兴趣，所以我曾经用过一次学术作品，Leonardi 软件，它可以免费下载。

在使用该软件一段时间后，我注意到缺少文档，并且绝对没有支持（没有免费的）。

我必须在 Leonardi 上完成我的应用程序，提供非常便宜的工作！

所以，除非您确定您将拥有**足够的高质量文档和支持——您可以负担得起**，否则不要使用新技术！

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2010-01-07T18:38:13.827

## TurboGears[网络](http://turbogears.org/)框架

我有一个网络应用程序要编写并跳到这个（从朋友那里听说过）。我并不真正了解替代方案，不了解 MVC，也不了解各种“标准”组件的替代方案（例如 SQLAlchemy 而不是 SQLObject）。虽然项目的文档和一般状态比我动手时要好得多，但我最终得到了一个巨大的应用程序，它依靠“技巧”来绕过一些神奇的功能，并且其中包含许多未记录的功能以满足最后期限。它变成了维护的噩梦，我真的希望我能花时间构建一些更简单的东西，并计划在需求发生变化时进行重写。

这是 1.x 系列，现在已被基于 Pylons 的 2.x 系列弃用。可以想象，核心团队自己决定进行研究，但我被一个必须维护的遗留应用程序困住了。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2010-01-08T18:16:22.660

网络推送、J2EE CMP

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2010-01-08T18:30:37.640

巴蒂斯。

我们最终实现了 Hibernate 已经完成的很多事情。本质上，我们使用 iBatis 开发了我们自己的非标准内部 JPA 提供程序。该技术已经被挑选出来，所以我们无能为力。

为了减轻打击，我们重构了代码以避免重复工作。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2010-01-08T19:02:56.187

MongoDB。我将它用作新产品的核心，然后发现它不会与每次写入磁盘同步。因此，例如，如果服务器断电，它就有可能损坏数据。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2010-01-09T20:09:30.720

更糟糕的是，当您让您的公司采用*您自己*开发的新的/不成熟的软件时。起初，当我是唯一的开发人员时，[我漂亮的 HTML GUI 框架](http://jot.sourceforge.net/)可以很好地构建我们的 RIA。但是，一旦我们获得了更多的开发人员，我发现如果不使用经过验证的平台以及强大的社区支持，开发人员的工作效率会降低多少。由于这个原因，以及我最终意识到 HTML 4 对 RIA 的不合适的事实，我们转换为 Adob​​e Flex 3。我对这一举动非常满意。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2010-01-10T11:06:14.683

我被烧了：

*   gcc 在克服困难之前，然后是 MSVC++
*   专有的 sun c++ 编译器
*   微软开发者网络

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2010-02-01T17:50:38.957

C++，但采用者不是我：早在 80 年代末/1990 年代初，当 C++ 开发人员很少而且相差甚远时，我得到了一份项目前端的工作。负责项目的经理请来了她的一个伙伴作为合同程序员做后端。当时，我对 C++ 或 OOP 一无所知。尽管我们使用的 UI 包不能做 C++，但他坚持使用它。后来，当程序员和经理都早已不在的时候，发现了一些bug；我很容易地在我的代码中修复了这些问题，但我无能为力，只能对其他人的 C++ 代码中的错误耸耸肩。当时的管理层没有培训我，而是向我展示了大门。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2014-12-13T14:54:40.147

作为一名 Java Web 开发人员，早在 2010 年就加入 Adob​​e Flex 的行列，现在看来是一件愚蠢的事情。（我希望 Flash 早点死！）这段经历教会我在接触新技术时要更加谨慎和深思熟虑，但有时对新事物做出真正评价的唯一方法是双脚跳入并真正尝试一下。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2014-12-13T16:25:11.927

**[开发](http://www.windev.com/)者**

虽然我很幸运没有用这个烫伤我的手，但这款产品在法国（它的原产国）相当受欢迎，我认为它应该在这里得到答案，这样其他人就不会烫伤他们的手（和他们的钱包）与这场灾难。

*   它有自己的语言“W-Language”，默认是法语，但也有英文和中文版本……我不知道，拥有多个版本的编程语言看起来不太好想法，反正对我来说。

*   大约每年，他们都会发布一个新版本的 IDE，其中包含对 IDE 和语言的错误修复，当然这是付费升级，但他们总是将错误修复作为新功能宣传，以便他们可以将“919 新功能”放在他们的广告。

*   文档很差——我没有购买他们的软件，所以我可能没有任何随附的手册——但我尝试在网上搜索（出于好奇）并没有找到太多代码示例，更不用说教程了。我想英文文档会更难找到。

*   他们的广告和营销很奇怪而且性别歧视……[你自己看看](http://blog.clement.delafargue.name/posts/2014-05-01-youve-convinced-me-boss-ill-work-with-windev-and-pc-soft.html)（不完全是NSFW，但如果有人看着你的屏幕可能仍然很尴尬，点击风险自负）。

*   是否有论坛帖子谈论他们的产品（特别是他们是否应该购买），突然有一些“具有 20 年经验的程序员”到达并发布了一条长消息，该产品如何改变了他们的生活，让他们变得更加富有成效等...有趣的是，这些“程序员”在论坛上都没有任何历史...您可能已经猜到了，该公司的广告/营销团队向论坛发送垃圾邮件。

*   至于他们自己的论坛，他们审查所有负面评论/意见。

*   他们还有一个名为 Webdev 的姊妹产品，它允许您使用相同的 W 语言创建网站和 web 应用程序；这是使用它创建的站点的[示例](http://exemples.webdev.info/WD160AWP/WD160Awp.exe/CONNECT/REWALI)。看页面的源代码会让你眼花缭乱；当然，以上所有内容也适用于该产品。

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2010-01-07T11:56:26.327

是的，来自团队“测试库”的其他一些程序员。“**它将完全满足您的需求！** ”。然后我开始使用它似乎实际的库正在崩溃而不是我的代码。这种情况几乎在一个月左右发生一次。

在我们的团队中，我们是 TDD 的首发，所以也许这很正常，但无论如何它都会烧掉很多 :)

# emacs - 如何编译emacs 22.3

> ID：904239
> 
> 赞同：1
> 
> 时间：2009-05-24T17:25:06.593
> 
> 标签：emacs, compilation

我最近做了一个只有核心程序的 Slax 安装。我使用了 live CD 的副本并运行了一个脚本来使 hda1 可启动，然后运行另一个脚本来使用 lilo 来启动它……它们都在 CD 中……所以它就像我的 HD 上的大 live cd 而不是真正成熟的操作系统。无论如何，我想从编译我自己的 Emacs 开始......有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T18:05:55.187

过程不应该太复杂。首先，您需要从[http://ftp.gnu.org/pub/gnu/emacs/](http://ftp.gnu.org/pub/gnu/emacs/)下载源代码， 然后使用

```
tar xzf emacs-22.3.tar.gz 
```

并 cd 进入新创建的目录 (emacs-22.3) 在那里，你运行：

```
./configure 
```

接着

```
make && make install 
```

阅读安装文件以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T18:03:42.103

要编译 emacs 22.3，首先下载[http://ftp.gnu.org/pub/gnu/emacs/emacs-22.3.tar.gz](http://ftp.gnu.org/pub/gnu/emacs/emacs-22.3.tar.gz)。将文件解压到一个目录，然后按照 INSTALL 文件中的说明进行安装。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T00:59:14.527

如果您询问如何在只读文件系统上编译它：

1.  如果你有很多内存，你可以挂载一个 ram 磁盘。
2.  如果你有硬盘，你可以挂载额外的空间。
3.  您可以查看类似`fuse`的内容以获取更多想法。

# c# - 需要 C# 中 SQLite 的基本帮助 - 从查询中返回字符串或整数

> ID：904240
> 
> 赞同：0
> 
> 时间：2009-05-24T17:25:20.477
> 
> 标签：c#, sqlite

我正在使用带有 SqlLite 的 Microsoft Visual C# 2008 Express Edition。我成功地能够打开我的数据库并使用 C# 代码向我的表中添加条目。

在检索数据时，我遇到了一些问题，并且一直在互联网上搜索和搜索有关如何执行这些基本操作的基本教程信息......

这是我的代码...（在我打开了与此处称为“conn”的数据库的连接之后）：

```
SQLiteCommand cmd = new SQLiteCommand(conn);
cmd.CommandText = "select myField1,myField2 from myTable where myField3 = '" + tempstring + "';";
cmd.CommandType = CommandType.Text;
SQLiteDataReader reader = cmd.ExecuteReader();

while (reader.Read())
{
  string tmp = reader.GetString(0);
  System.Console.WriteLine(" my output = " + tmp);
} 
```

当我执行此操作时......我没有收到任何错误，因为我在最后一行没有得到任何输出，看起来 while 循环根本没有执行。

我是这个东西的初学者......我错过了什么，是否有一个很好的网络资源可以让我学习这些基本的东西？我对自己的 SQL 很满意……只是没有像这样集成到 C# 中……

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T17:34:54.333

首先，从行中删除有害的尾随分号`while (reader.Read());`......！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T17:37:04.453

这对我来说是正确的。该属性是否`reader.HasRows`为您的查询返回 true？

需要注意的几个附带问题是：

1.  请务必通过使用 { } 块包装您的对象来处理您的 SQL 资源。
2.  考虑使用参数化查询，而不是直接在 SELECT 语句中注入查询参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T17:56:19.337

回答有关如何编写参数化查询的问题：

```
cmd.CommandText = "select myField1,myField2 from myTable where myField3 = @tempString;";
SQLiteParameter param = new SQLiteParameter("@tempString");
cmd.Parameters.Add(param);

// you can modify that value without touching the sql statement (which means you could cache the above command)
param.Value = tempstring;
SQLiteDataReader reader = cmd.ExecuteReader();
[...] 
```

SQLite 中的参数可以有多种形式，您可以在[此处](http://www.sqlite.org/lang_expr.html#varparam)找到。

有关参数化查询的更多信息，请参见[此处](http://sqlite.phxsoftware.com/forums/t/83.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T17:45:14.207

好的，亚历克斯。

除此之外，由于您是从 sqlite 开始的（您可能想从标签中删除第二个 L），请记住 sqlite 并不能真正保证数据库级别的数据类型安全。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T17:58:50.830

不是要转移您对 Sqlite 问题的注意力，但是如果您对嵌入在 C# 中的 Sqlite 查询有问题，您可以尝试[NHibernate](https://www.hibernate.org/343.html)与[Fluent NHibernate](http://fluentnhibernate.org/)结合使用。这些技术为包括 Sqlite 在内的数据库提供了出色的数据访问机制。

NHibernate 对 Sqlite 的请求非常快，您不必担心某些 Sqlite 特性。如果您使用 NHibernate 正确构建数据访问层，您应该能够非常快速地升级到更强大的数据库。

# java - Web 应用程序启动时首先加载哪个类？

> ID：904249
> 
> 赞同：2
> 
> 时间：2009-05-24T17:30:26.727
> 
> 标签：java, servlets, classloader

我有一个 Web 应用程序和两个类文件，

第一类是**MyClass.class**，它位于 abc.jar 文件 (WEB-INF/lib/abc.jar) 中，第二类是**YourClass.class**，它位于类文件夹 (WEB-INF/classes/YourClass.class) 中。

我的问题是应用程序启动时首先加载哪个类？为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-24T17:41:00.440

根据我的经验，您无法预测 JVM 加载类的顺序。

一旦我制作了一个测试运行程序（有点像 Maven 的 Surefire）并使用相同的 JVM 和操作系统，它在不同的机器上运行时会以不同的顺序加载类。吸取的教训：

> 您不应该将应用程序构建为依赖于类加载顺序

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T17:48:48.833

对于“需要”的某些定义，根据需要加载类。加载类的确切时间取决于 JRE 实现、javac 实现、线程到底在做什么、服务器代码，当然还有应用程序代码。在这方面做假设是个坏主意。如果您想查看特定运行会发生什么，您可以使用[`-verbose:class`](http://java.sun.com/javase/6/docs/technotes/tools/windows/java.html#options)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T17:36:53.673

Sun 的[类加载器文档](http://docs.sun.com/app/docs/doc/819-3659/6n5s6m57s?a=view)总是说 WEB-INF/classes 或 WEB-INF/lib，但没有说首先检查哪个。

来自[IBM 文档](http://www.ibm.com/developerworks/java/library/j-dyn0429/)：

> “加载类的规则在JVM规范中有详细的说明。基本原则是**类只在需要的时候加载**（或者至少看起来是这样加载的——JVM在实际加载中具有一定的灵活性，但是必须保持一个固定的类初始化序列）。每个被加载的类可能还有它依赖的其他类，因此加载过程是递归的。”

所以我认为答案是：这取决于你的应用程序首先需要哪些类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T17:42:24.353

正如 duffymo 指出的那样，这可能会有所不同。您可以确定此特定应用程序的顺序的一种方法是在类构造函数和 Web Web 应用程序页面加载方法中插入 Response.Write 文本。“A 类中的实例化对象”、“打开的网页 MyPage”等。

一旦你弄清楚了序列，注释掉那些代码，以便你以后可以重用它们来验证你没有做出影响序列的更改（例如提前或稍后实例化对象）。

# workflow-foundation - 顺序工作流程问题

> ID：904254
> 
> 赞同：0
> 
> 时间：2009-05-24T17:33:28.657
> 
> 标签：workflow-foundation

我的工作流程托管在 Windows 窗体应用程序中。在某些时候，我需要等待经理批准。经理不应使用 Windows 蠕虫应用程序来批准/拒绝任务。我正在考虑使用 WebService，但后来我将被迫在 asp Web 服务中托管我的工作流程。

我如何等待来自不同机器的经理批准？

亲切的问候 PK

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T17:39:01.347

经理将不得不使用一些 UI 来批准/拒绝项目。Web 服务不会有 UI。您可以编写一个单独的 Windows 窗体应用程序供经理使用，并向他们发送有关待处理项目的电子邮件通知。

或者，如果该选项可用，则创建一个 Intranet 网站供经理使用，而无需安装任何应用程序。

# architecture - 开放和封闭的分层架构是什么意思？

> ID：904257
> 
> 赞同：7
> 
> 时间：2009-05-24T17:35:10.777
> 
> 标签：architecture, modeling

我知道这听起来可能是一个非常微不足道的问题，但我在互联网上找不到任何资源。

您能否告诉我什么是开放式和封闭式分层架构以及为什么开放式分层架构显然更难维护？使用封闭/开放分层架构有什么缺点吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-24T17:42:47.987

封闭的分层架构意味着任何给定的层（或层）只能使用下一个直接层的服务，而在开放层架构中，给定的层可以使用它下面的任何层（或层）。封闭层架构通过减少依赖关系来促进层之间的独立性。

[http://books.google.com/books?id=z5XX4gYuMs0C&pg=PT160&lpg=PT160&dq=%22closed+layer+architecture%22&source=bl&ots=-iCw2be77_&sig=zQvScA2oIud_rNJNMziZXNMSnJo&hl=en&ei=u4UZSt7MKoX2tAOW-8jaCA&res=xulta&=book PPT160,M1](http://books.google.com/books?id=z5XX4gYuMs0C&pg=PT160&lpg=PT160&dq=%22closed+layer+architecture%22&source=bl&ots=-iCw2be77_&sig=zQvScA2oIud_rNJNMziZXNMSnJo&hl=en&ei=u4UZSt7MKoX2tAOW-8jaCA&sa=X&oi=book_result&ct=result&resnum=5#PPT160,M1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T17:40:03.310

这是 Bob Martin 对开放式和封闭式架构的最早定义之一：

[http://www.objectmentor.com/resources/articles/ocp.pdf](http://www.objectmentor.com/resources/articles/ocp.pdf)

根据定义，开放式架构正在发生变化。它们很难维护，因为在设计 API 时很难预见未来并预测所有可能的需求。但是，如果 API 保持不变，并且您已经设计了通过添加而不是重写来修改的有效机制（例如，声明性配置、数据驱动的应用程序），那么开放式架构会非常有效。

对于那些众所周知且相对静态的问题，封闭式架构没有任何问题。打开并不总是必要的。选择与变化的性质和速度有关。

# embedded - 你认为你需要一些关于微控制器编程的简单教程吗？

> ID：904267
> 
> 赞同：9
> 
> 时间：2009-05-24T17:39:35.730
> 
> 标签：embedded, microcontroller

这不是 100% 与编程相关的。但我认为这有点用处，因为它针对的是 SO 社区中的少数群体。

微控制器编程是编程中有趣的领域之一。我在这里看到了一些主题，请求资源用于开始/学习/讨论 PIC。

[示例主题](https://stackoverflow.com/questions/78744/how-to-start-programming-microcontroller)

由于我在该领域拥有丰富的知识和经验，因此我正在考虑发布一些资源，以帮助新手从基础知识中学习它们。它将不仅仅是一份理论出版物，而且将基于示例项目。我希望从一个新的博客+论坛开始，这样用户就可以动态地相互交互。我之所以做出这个决定，是因为我发现新手可以开始学习和协作工作的站点数量很少。

对此你们怎么看？你有没有遇到过这样的困难？你认为你可以使用它吗？您希望在网站上看到哪些内容？

如果您不打算将其作为 NPR 关闭，我将不胜感激。我只是想为其他微控制器爱好者做一些服务:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T17:47:20.490

网上已经有一些这样的教程（例如[来自 SparkFun 的这个](http://www.sparkfun.com/commerce/tutorials.php)），另一个可能是有价值的补充，但前提是它在某些方面更好或不同。

你会提供什么是真正的改进？

一些建议：

*   不要以为我有窗户
*   对各种 MCU 和/或支持电子设备之间的差异进行一些侧面讨论。讨论一些取舍
*   你需要一个非常通用的教程来吸引人们，但真正的附加值可能是在开始之后的一个专门的焦点
*   建立一些有用和/或极酷的东西
*   组件集成单元（即我可以购买 Polar 式心率接收器、MCU 和 USB 接口。如何让它们相互通信，以便构建运动数据记录器？）

你所做的每一件事，我都很期待（只是在业余时间学习嵌入式的东西......）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T17:44:31.197

[www.mikrocontroller.net](http://www.mikrocontroller.net/)上有很好的教程，但它们是德文的。

如果您可以为讲英语的社区创建类似的东西，那就太好了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T21:35:21.530

是的！帮助嵌入式软件（微控制器编程）的资源越多越好。

刚开始可能会让人望而生畏，尤其是如果您过去只为 PC 或类似软件编写过软件。还有更多的限制（例如在 RAM 和代码空间上），以及您需要知道的大量不适用于非嵌入式软件的事情。

正如其他人在这里提到的那样，有许多网站涵盖了这方面的不同方面；其他一些是[OnARM](http://www.onarm.com/)，用于 ARM 处理器，相关的[STM32 Circle](http://www.stm32circle.com/hom/index.php)和 Jack Ganssle 在他的[网站](http://www.ganssle.com/)和[Embedded.com](http://www.embedded.com/columns/archive/?content_type=bp)上的文章。

尽管嵌入式系统是一个巨大的市场（想想你家或车里有多少这样的设备），但我的印象是，网络上和 Stack Overflow 上对这个主题的报道要少得多。非嵌入式。

所以，我期待看到你的劳动成果！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T18:04:23.910

也许对于不同的 ARM7 和 CortexM3 ......？在这里大家都以为信息量很大，但是却传遍了整个网络，从来没有任何红线……

[但是，如果您使用 AVR，那么在http://www.avrfreaks.net](http://www.avrfreaks.net/index.php?name=PNphpBB2&file=viewforum&f=11)上有很多东西，我猜 PIC 也有很多东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T21:37:26.713

在针对初学者时，值得考虑的另一件事是直接提供指向有用资源的指针，例如合适的模拟器/仿真器，甚至是地址/网页，您可以在其中轻松订购入门套件甚至是一些芯片的免费样品。

例如，大多数半导体制造商都提供其产品的免费样品，例如参见[microchip.com](http://www.microchip.com/samples/Default.aspx?testCookies=true)或[atmel.com](http://www.atmel.com/forms/Samples.asp)。

理想情况下，入门课程一开始应基于使用这样的硬件模拟器或仿真器，这样一旦初学者有兴趣将他的工作转移到真实芯片上，项目和所有相关经验就可以直接映射到真实设备上，提供指向免费可用资源的指针或非常实惠的入门工具包可能非常有用。

这将确保初学者可以尽可能轻松和便宜地开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T15:20:24.093

我自己写了很多这样的例子，但它们分散且没有组织，可能很少阅读（有一次 avrfreaks 的人借了一些东西）。StackOverflow 可能会抑制这种情况，但理论上可以使用 SO。问一个关于 arm whatsit 的引导代码的问题，然后用示例代码和文本来回答您自己的问题，说明它是如何工作的以及为什么工作。SO标签会很好，因为您可以在“boot”“arm”“embedded”上进行搜索，然后在“boot”“avr”“embedded”等上进行搜索，并获得适用于不同平台的类似示例程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T21:28:01.617

就个人而言，我更倾向于为特定微控制器版本（在典型用途中）创建完整程序的示例存档，而不是制作另一个“通用”教程。例如，一个启用串行端口的微控制器 x/y，一个配置一些数字输出（设置 TRIS 和朋友），如何设置常用频率/振荡器选项等。

当我开始使用 PIC（很短的 PIC16，然后是 PIC18，然后是 24F，现在是 dspic）时，主要问题之一是所有示例要么只是片段，要么描述了非常普遍的原理。

如果要让示例实际工作需要比教程所教的更多的技能，那么教程是不好的。

我通常无法为我的控制器找到一个完整的程序，甚至找不到更广泛的组（仅在引脚数量和内存/闪存方面有所不同）。

最初的程序总是有问题，但有时后来我又遇到了同样的问题（初始化某个外围设备）（例如编码器）如果是第一次运行新的微控制器线，那是特别令人沮丧的，你可能不会100% 确定您的硬件。

不幸的是，这需要来自论坛、用户组等的一些协调，因为没有人拥有所有设备和所有变体来连接它们（例如不同的振荡器选项）。

# php - FastCGI 与 PHP 配合得好吗？

> ID：904268
> 
> 赞同：1
> 
> 时间：2009-05-24T17:39:44.043
> 
> 标签：php, fastcgi

FastCGI 与 PHP 配合得好吗？似乎一些运行 Ruby on Rails 的人在使用 FastCGI 时遇到问题，但是使用 PHP 可以吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T17:42:00.967

[PHP 可以与 FastCGI 一起使用吗？](http://www.fastcgi.com/docs/faq.html#PHP)[FastCGI 官方常见问题解答]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T18:07:45.747

[我在Cherokee](http://www.cherokee-project.org) for PHP中使用 FastCGI（通过 php-cgi），它非常棒。没有问题。

我肯定会建议同时安装 xcache。性能提升将使您的袜子在下周爆发。

我刚刚看到您在其中一条评论中询问了 Apache。我不知道你为什么选择 FastCGI 而不是 mod_php。性能差异几乎是看不见的，但我敢肯定 mod_php 会稍微快一些（而且设置起来更简单）。

好吧，我真的认为是这样。然后我读到这个：[http ://www.gnegg.ch/2006/08/mod_php-lighttpd-fastcgi-whats-fastest/](http://www.gnegg.ch/2006/08/mod_php-lighttpd-fastcgi-whats-fastest/)

而且看起来 Apache+FastCGI 比 Apache+mod_php 更快。奇怪的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T17:44:12.710

Lighttpd 默认为 PHP 使用 FastCGI，因为唯一的其他选择是使用 CGI，它可以完美地工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T17:44:50.433

我们使用 PHP 和使用 fastcgi 的 lighttpd 运行我们的内部 Intranet 应用程序，它可以正常工作。

在这里找到一个好的教程（Linux）：[http ://www.cyberciti.biz/tips/lighttpd-php-fastcgi-configuration.html](http://www.cyberciti.biz/tips/lighttpd-php-fastcgi-configuration.html)

# ruby-on-rails - 用户之间的消息

> ID：904272
> 
> 赞同：1
> 
> 时间：2009-05-24T17:41:08.520
> 
> 标签：ruby-on-rails, ruby

我在消息表中有正文：文本内容：文本 sender_id:integer receiver_id:integer

我在用户模型中有这个：

```
 has_many :sent_messages, :class_name => "Message", :foreign_key => "sender_id"
   has_many :received_messages, :class_name => "Message", :foreign_key => "receiver_id" 
```

我在消息模型中有这个：

```
 belongs_to :sender, :class_name=>"User", :foreign_key=>"sender_id"
   belongs_to :receiver, :class_name=>"User", :foreign_key=>"receiver_id" 
```

在您查看其他用户的个人资料时登录后（我的意思是用户视图中的此链接）。

我这样称呼新消息：

```
 <%= link_to "Send a Message",{:controller=>"messages",:action=>"new"}%> 
```

我在messages_controller中有这些代码：

```
 def new
  @message = current_user.sent_messages.build
   end

def create
@message = current_user.sent_messages.build(params[:message])
  if @message.save
  flash[:notice] = "Successfully created message."
  redirect_to root_url
else
  render :action => 'new'
 end
 end
#..... 
```

我也在views\messages\new.html.erb中有这些代码

```
 <% form_for @message do |f| %>
 <%= f.error_messages %>
  <p>
 <%= f.label :body %><br />
 <%= f.text_field :body %>
  </p>
  <p>
 <%= f.label :content %><br />
 <%= f.text_area :content %>
  </p>
 <p><%= f.submit "Submit" %></p>
  <% end %> 
```

单击链接后，我填写正文和文本，然后提交。一切都已保存，但 receiver_id 值为空。我尝试了很多事情，但我无法保存receiver_id

例如：我这样设置链接：

```
 <%= link_to "Send a Message",{:controller=>"messages",:action=>"new",
   :receiver_id=>@user.id}%> 
```

它发送我想要的用户 ID，我可以使用参数获取这个值，但问题是我找不到在保存其他值的同时将此值保存到数据库的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-06T01:26:22.637

尝试

```
class MessagesController
   def new
     @message = current_user.sent_messages.build :receiver_id => params[:receiver_id]
   end    
end 
```

我个人喜欢像这样在 url 中使用嵌套路由

域/用户/123/消息/新

那么你可以做

```
link_to "Send a message", new_user_message( @user ) 
```

所以你的控制器会说

```
class MessagesController
   def new
     @message = current_user.sent_messages.build :receiver_id => params[:user_id]
   end    
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T21:16:37.380

大声笑，我发现我像之前提到的那样调用了新消息

```
 <%= link_to "Send a Message",{:controller=>"messages",:action=>"new",
 :receiver_id=>@user}%> 
```

那么新方法将类似于消息模型中的方法

```
 def new
 @message =current_user.sent_messages.build(:receiver_id=>params[:receiver_id])
  end 
```

在views/messages/new.html.erb中最简单的事情（实际上这对我来说是个大问题:)）在form_for中添加这一行

```
 <%= f.hidden_field :receiver_id  %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T17:59:04.653

传入`receiver_id`参数只是让`new`方法访问它。您需要访问和存储方法`params[:receiver_id]`中的某个位置`new`。

# jquery - 如何从选择器中排除第二列

> ID：904273
> 
> 赞同：0
> 
> 时间：2009-05-24T17:41:13.747
> 
> 标签：jquery, selector, filter

我的问题是如何更改选择器，以便将第二列排除在悬停事件之外

我确实尝试了其他一些变体，例如 nth-child，但还没有运气。语法可能有问题吗？

```
$('.row_class td:not(:eq(1))').hover( 
```

谢谢，理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T17:52:04.757

尝试这个：

```
$('tr.row_class td:not(:nth-child(2))').hover(function() {
    $(this).css('color','red');
}, function() {
    $(this).css('color','black');
}); 
```

[它对我有用](http://jsbin.com/ujiwu)。

顺便说一句，类选择器很慢。如果你知道`.row_class`只会应用于`<tr>`元素，你应该让选择器`tr.row_class`像我的例子一样。只是一个免费的小费。:)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-24T17:42:24.837

$('.row_class td:first-child').hover(

# c - C 中是否有用于读/写系统调用的标准输入/输出宏？

> ID：904283
> 
> 赞同：3
> 
> 时间：2009-05-24T17:43:08.843
> 
> 标签：c, macros, system-calls, file-descriptor

我所有的搜索都没有返回任何结果，我发现没有任何宏可用作标准输入和输出的读/写系统调用的文件描述符而不是 0（stdout）和 1（stdin），这很奇怪。

我想念他们还是他们真的不存在？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-24T17:46:07.717

它们存在于 POSIX 机器上的 unistd.h 中。STDOUT_FILENO、STDIN_FILENO 和 STDERR_FILENO。见：[http ://www.opengroup.org/onlinepubs/009695399/basedefs/unistd.h.html](http://www.opengroup.org/onlinepubs/009695399/basedefs/unistd.h.html)

# java - 是否有用 Java 实现的验证 HTML 解析器？

> ID：904293
> 
> 赞同：4
> 
> 时间：2009-05-24T17:45:49.493
> 
> 标签：java, html, xhtml

我需要用 Java 解析 HTML 4。理想情况下，我想要一个与 SAX 兼容的实现。

我知道 Java 中有许多 HTML 解析器，但是，它们似乎都在执行“整理”。换句话说，他们将纠正格式错误的 HTML。*我不想要这个*。

我的要求是：

1.  没有整理。
2.  如果输入文档无效，HTML 解析应该会失败。
3.  文档应该可以根据 HTML DTD 进行验证。
4.  解析器可以产生 SAX2 事件。

**是否有满足这些要求的库？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T18:16:54.437

[您可以在HTML Parsers](http://www.java-sources.org/open-source/html-parsers)中找到 HTML 解析器的集合。我不记得确切，但我认为 TagSoup 解析文件而不应用更正......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-18T12:44:53.420

我认为[Jericho HTML Parser](http://jericho.htmlparser.net/docs/index.html)至少可以满足您的一项核心要求（“如果输入文档无效，HTML 解析应该失败。”）因为它至少会*告诉*您是否存在不匹配的标签或其他有害的 HTML 缺陷，并且您可以根据此信息选择失败。

尝试在此 Jericho 格式化演示中输入无效的 html，并注意页面底部的“解析器日志”：

[http://jerichohtmlparser.appspot.com/samples/FormatSource.jsp](http://jerichohtmlparser.appspot.com/samples/FormatSource.jsp)

所以是的，这*是*在整理标签，但它至少**告诉**你 - 你可以通过在源上设置 net.htmlparser.jericho.Logger （例如[WriterLogger](http://jerichohtml.sourceforge.net/docs/javadoc/index.html?net/htmlparser/jericho/WriterLogger.html)或更具体的你自己创建的东西）来获取这些信息，然后根据注销的错误继续进行。这是一个小例子：

```
 Source source=new Source("<a>I forgot to close my link!");
    source.setLogger(myListeningLogger);

    source.getSourceFormatter().writeTo(new NullWriter());
    // myListeningLogger has now had all the HTML flaws written to it 
```

在上面的示例中，您的记录器的 info() 方法使用字符串调用：' `StartTag at (r1,c1,p0) missing required end tag`'，这是相对可解析的，并且您始终可以决定拒绝任何记录比调试更糟糕的消息的 HTML - 事实上，Jericho 记录了几乎所有错误作为“信息”级别，有几个处于“警告”级别（您可能会想创建一个小叉，调整严重性以对应您关心的内容）。

Jericho 在 Maven Central 上可用，这始终是一个好兆头：

[http://mvnrepository.com/artifact/net.htmlparser.jericho/jericho-html](http://mvnrepository.com/artifact/net.htmlparser.jericho/jericho-html)

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T08:34:36.093

您不妨查看[http://lobobrowser.org/cobra.jsp](http://lobobrowser.org/cobra.jsp)。他们实现了纯 Java Web 浏览器 (Lobo)。他们将解析器组件（Cobra）单独拉出以供使用。老实说，我不确定它是否会满足您对“不整理”要求的要求，但它可能值得一看。我在探索纯 Java Web 浏览器时遇到了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T10:12:10.360

您可以尝试继承 javax.swing.text.html.parser.Parser 并实现 handleXXX() 方法。它似乎没有尝试修复 XML。[在API](http://java.sun.com/javase/6/docs/api/javax/swing/text/html/parser/Parser.html)中查看更多信息

# c# - 动态构建 lambda 表达式

> ID：904296
> 
> 赞同：4
> 
> 时间：2009-05-24T17:46:48.883
> 
> 标签：c#, lambda

因此，我开始构建一个小型测试应用程序来测试 lambda 表达式。我在这里和其他地方找到了几个例子，但我就是不明白。

谁能解释我如何使用文本框或任何其他变量来构建表达式？

我的测试清单

```
List<People> lPeople = new List<People> 
{
    new People { Name= "Jean", LastName = "Borrow", Age= 21 } ,
    new People { Name= "Dean", LastName = "Torrow", Age= 20 }
}; 
```

工作 lambda 表达式

```
IEnumerable<People> result = lPeople.Where(p => p.Age < 21);
dgv_1.DataSource = result.ToList();
dgv_1.Update(); 
```

如何动态构建表达式？

类似的东西`lPeople.Where(p => p.LastName == Textbox.Text);`（当然不起作用）

谢谢！

编辑：在下面的解决方案中添加了一些代码

```
Int32 iAge;
Boolean bSuc = Int32.TryParse(tb_filter_age.Text, out iAge);
if (!bSuc)
{
    iAge = 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T18:01:45.537

“这当然行不通”

当你尝试它时会发生什么？从表面上看，这就是我一直在做的事情。

要基于指定运算符的 ComboBox 切换操作：

```
int age = int.Parse(textBoxAge.Text);

IEnumerable<People> result;
if (comboBoxOperator.Text == "=")
    result = lPeople.Where(p => p.Age == age);
else if (comboBoxOperator.Text == "<")
    result = lPeople.Where(p => p.Age < age);
else
    result = lPeople.Where(p => p.Age > age);

dgv_1.DataSource = result.ToList();
dgv_1.Update(); 
```

`int`如果用户输入了无法转换的内容，则将年龄字符串转换为 an 的代码将抛出。查找`TryParse`以避免异常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T18:10:02.840

[在http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)尝试谓词生成器

我用它来进行高级搜索，用户可以继续添加可选的搜索条件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T18:05:06.780

您可以使用 Linq 动态查询库来完成此操作。有关更多信息，请参阅 Scott Guthrie 的以下博客文章：

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T18:12:30.480

您的示例 lambda 表达式将起作用。你需要它有多动态？如果你有一个静态 UI 的“过滤器”应用到一个集合，你可以创建类似于下面的代码：

```
IEnumerable<People> result = lPeople;
if (txtLastName.Text.Trim().Length != 0) 
    result = result.Where(p => p.LastName == txtLastName.Text); 
if (chkSeniors.Checked) 
    result = result.Where(p => p.Age >= 65);
dgv_1.DataSource = result.ToList();
dgv_1.Update(); 
```

如果您希望数据源的使用者应用真正的动态表达式（让他们能够选择要过滤的其他字段和要使用的表达式），那么使用谓词构建器工具或 LINQ 表达式对象来实现这是一个更复杂的功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T18:14:51.833

你的处理方式应该没有问题。我创建了一个简单的 Windows 窗体应用程序，其中包含 a `TextBox`、 a`Button`和 a `DataGridView`（分别具有名称`textBox1`、`button1`和`dgv_1`。）

这是我用于`Form1.cs`按预期工作的文件的代码：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        List<People> lPeople = new List<People> 
        {
            new People { Name= "Jean", LastName = "Borrow", Age= 21 } ,
            new People { Name= "Dean", LastName = "Torrow", Age= 20 }
        };

        IEnumerable<People> result = lPeople.Where(p => p.Name == textBox1.Text);

        dgv_1.DataSource = result.ToList();
        dgv_1.Update();
    }
}    

public class People
{
    public string Name { get; set; }
    public string LastName { get; set; }
    public int Age { get; set; }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-08T17:08:46.363

在动态用户选择的情况下，我认为比使用 if 块更优雅的解决方案是声明一个变量

```
Func<People, bool> expFilter; 
```

根据用户选择设置其值

```
switch(comboBoxOperator.Text)
{
   case "=":
   expFilter = p => p.Age == age;
   break;

   case ">":
   expFilter = p => p.Age > age;
   break;

   case "<":
   expFilter = p => p.Age < age;
   break;
} 
```

然后将其传递给 Where 子句：

```
result = lPeople.Where(expFilter); 
```

# php - 在 php 中检索 window.location.hash url

> ID：904303
> 
> 赞同：0
> 
> 时间：2009-05-24T17:52:46.660
> 
> 标签：php, javascript, jquery

我在这里使用 jquery 选项卡式界面[http://www.imashdigital.com/#2](http://www.imashdigital.com/#2)并希望在 php 中返回选项卡编号。

理想情况下，我想运行一个 javascript 函数（在计时器上），使用当前选项卡不断更新全局**php 变量。**

基于这个 php 值，从 1 到 4，然后我将加载不同的侧边栏。

由于我是新手，我将不胜感激任何帮助和一些代码示例。

亲切的问候

乔纳森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T18:39:11.437

哈希之后的 URI 部分永远不会发送到服务器。PHP 无法访问它。请改用查询字符串参数 ( `$_GET`)。或使用客户端脚本 (javascript)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T18:10:48.270

我建议您不要运行计时器，而是将 $.post 附加到事件“选项卡激活”。这将实时应用任何选项卡更改，并且不会触发不必要的请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T20:06:16.967

我在最近的几个项目中使用了选项卡式面板，我使用的解决方案如下：

**HTML**

```
<ul class="tabs">
  <li><a href="#en_en">English</a></li>
  <li><a href="#fr_fr">Français</a></li>
</ul>
<div class="panel" id="en_en"><!-- Content --></div>
<div class="panel" id="fr_fr"><!-- Content --></div> 
```

**jQuery**

```
// the currently selected tab, or a default tab (don't forget to prepend the #)
var tab = location.hash || '#en_en';

// register a click handler on all the tabs
$('ul.tabs a').click(function(event){
    event.preventDefault(); // prevents the browser from scrolling to the anchor

    // hide all panels, then use the link's href attribute to find 
    // the matching panel, and make it visible
    // you can, of course, use whatever animation you like
    $('div.panel').hide().filter(  $(this).attr('href')  ).show();

).filter('[href*='+tab+']').click();
// above: in case of refreshing/bookmarking: find the tab link that contains
// the current location.hash, and fire its click handler 
```

它运行良好，因为服务器端代码不需要知道选择了哪个选项卡，但它还支持刷新或为特定选项卡添加书签，而无需用户再次选择选项卡。

# entity-framework - 将一对多表关系映射到单个实体框架对象

> ID：904306
> 
> 赞同：1
> 
> 时间：2009-05-24T17:53:46.363
> 
> 标签：entity-framework, one-to-many

我在数据库中有以下表格（当然只是一个演示）：

## 职位

职位编号

## 限制

LimitId 位置Id

我想将它们加入一个实体（总是有位置，并不总是有限制）：

## 位置

PositionId 限制Id

我看过有关一对一映射和“每个类型继承的表”的文章，并尝试在这里实现相同的方法，但没有成功。这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T18:00:53.387

我认为您想要的是一个普通的内部联接，其中允许您的外键（限制表中的 PositionID）为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T16:57:07.633

是和否......在我的场景中，第二个选项是适用的，因为我在两个表中没有相同的主键。所以，我必须创建一个可更新的视图......可更新视图的问题是我不能修改不同表中的字段并期望数据库来处理它，除非我使用“代替”触发器，我真的不这样做根本不想进入……所以，我想我没有什么开箱即用的东西……该死。（除非你有别的想法……）

无论如何，我真的很感谢你的帮助，非常感谢。尼尔。

# emacs - emacs 在运行时重新编译文件

> ID：904308
> 
> 赞同：1
> 
> 时间：2009-05-24T17:55:49.900
> 
> 标签：emacs

如何从 emacs 中重新编译 emacs-lisp 脚本而不会出现问题？我试过了

```
批量重新编译目录
```

，但这会导致重新编译的文件出现奇怪的故障，直到我重新启动 emacs。有没有办法做到这一点，以免造成错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T18:22:17.110

GNU Emacs 参考手册的[这一页涉及重新加载文件和/或库。](http://www.gnu.org/software/emacs/elisp/html_node/Repeated-Loading.html#Repeated-Loading)

`M-x load-library`除非有另一种 emacs 机制强制它重新加载新的字节编译函数，否则您肯定必须明确地重新加载新文件 。

# ruby-on-rails - Ruby / Ruby on Rails 中是否有等效的 print_r 或 var_dump？

> ID：904314
> 
> 赞同：123
> 
> 时间：2009-05-24T17:59:22.623
> 
> 标签：ruby-on-rails, ruby

我正在寻找一种转储对象结构的方法，类似于 PHP 函数`print_r`并且`var_dump`出于调试原因。

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-05-24T18:06:31.693

任何对象的`.inspect`方法都应该正确格式化以进行显示，只需执行..

```
<%= theobject.inspect %> 
```

该`.methods`方法也可能有用：

```
<%= theobject.methods.inspect %> 
```

`<pre>`根据数据，将其放入标签中可能会有所帮助

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-05-24T18:01:44.990

在视图中：

```
include DebugHelper

...your code...

debug(object) 
```

在控制器、模型和其他代码中：

```
puts YAML::dump(object) 
```

[来源](http://source.mihelac.org/2006/3/31/ruby-rails-alternative-to-php-print_r-and-var_dump)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-25T13:57:57.190

在视图中，您可以使用`<%= debug(yourobject) %>`它将生成数据的 YAML 视图。如果您想在日志中添加某些内容，则应使用`logger.debug yourobject.inspect`.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-26T23:04:35.047

您还可以在 Rails 控制台下使用**YAML::dump**简写（**y ）：**

```
>> y User.first
--- !ruby/object:User 
attributes: 
  created_at: 2009-05-24 20:16:11.099441
  updated_at: 2009-05-26 22:46:29.501245
  current_login_ip: 127.0.0.1
  id: "1"
  current_login_at: 2009-05-24 20:20:46.627254
  login_count: "1"
  last_login_ip: 
  last_login_at: 
  login: admin
attributes_cache: {}

=> nil
>> 
```

如果您只想预览一些字符串内容，请尝试使用**raise**（例如在模型、控制器或其他无法访问的地方）。您可以免费获得回溯：）

```
>> raise Rails.root
RuntimeError: /home/marcin/work/github/project1
    from (irb):17
>> 
```

我也非常鼓励您尝试**ruby​​-debug**：

*   [http://railscasts.com/episodes/54-debugging-with-ruby-debug](http://railscasts.com/episodes/54-debugging-with-ruby-debug)
*   [http://www.sitepoint.com/article/debug-rails-app-ruby-debug/](http://www.sitepoint.com/article/debug-rails-app-ruby-debug/)
*   [http://www.datanoise.com/articles/2006/7/12/tutorial-on-ruby-debug](http://www.datanoise.com/articles/2006/7/12/tutorial-on-ruby-debug)

这非常有帮助！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-12-22T06:59:11.917

您可以使用`puts some_variable.inspect`. 或更短的版本：`p some_variable`. 对于更漂亮的输出，您可以使用[awesome_print gem](https://github.com/michaeldv/awesome_print)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-25T12:50:45.127

如果您只想将相关数据显示到标准输出（如果您从命令行运行，则为终端输出），您可以使用`p some_object`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-10-20T05:11:18.633

以前的答案很好，但是如果您不想使用控制台（终端），在 Rails 中，您可以使用调试的 Helper [ActionView::Helpers::DebugHelper在视图中打印结果](http://api.rubyonrails.org/classes/ActionView/Helpers/DebugHelper.html)

```
#app/view/controllers/post_controller.rb
def index
 @posts = Post.all
end

#app/view/posts/index.html.erb
<%= debug(@posts) %>

#start your server
rails -s 
```

结果（在浏览器中）

```
- !ruby/object:Post
  raw_attributes:
    id: 2
    title: My Second Post
    body: Welcome!  This is another example post
    published_at: '2015-10-19 23:00:43.469520'
    created_at: '2015-10-20 00:00:43.470739'
    updated_at: '2015-10-20 00:00:43.470739'
  attributes: !ruby/object:ActiveRecord::AttributeSet
    attributes: !ruby/object:ActiveRecord::LazyAttributeHash
      types: &5
        id: &2 !ruby/object:ActiveRecord::Type::Integer
          precision: 
          scale: 
          limit: 
          range: !ruby/range
            begin: -2147483648
            end: 2147483648
            excl: true
        title: &3 !ruby/object:ActiveRecord::Type::String
          precision: 
          scale: 
          limit: 
        body: &4 !ruby/object:ActiveRecord::Type::Text
          precision: 
          scale: 
          limit: 
        published_at: !ruby/object:ActiveRecord::AttributeMethods::TimeZoneConversion::TimeZoneConverter
          subtype: &1 !ruby/object:ActiveRecord::Type::DateTime
            precision: 
            scale: 
            limit: 
        created_at: !ruby/object:ActiveRecord::AttributeMethods::TimeZoneConversion::TimeZoneConverter
          subtype: *1
        updated_at: !ruby/object:ActiveRecord::AttributeMethods::TimeZoneConversion::TimeZoneConverter
          subtype: *1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-07T16:08:52.000

我用这个:)

```
require 'yaml'

module AppHelpers
  module Debug
    module VarDump

      class << self

        def dump(dump_object, file_path)
          File.open file_path, "a+" do |log_file|
            current_date = Time.new.to_s + "\n" + YAML::dump(dump_object) + "\n"
            log_file.puts current_date
            log_file.close
          end
        end

      end

    end
  end
end 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-11T14:40:44.483

最近我正在使用**awesome_print**的`ap`方法，它可以在控制台和视图中使用。

如果您需要在视觉上扫描`String`或 `Numeric`对象，特定类型的彩色输出确实会有所不同（尽管我不得不稍微调整我的样式表以获得优美的外观）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-11-28T01:34:54.877

最近我成为了[PRY](http://pryrepl.org/)的粉丝，我发现它非常适合做检查变量、调试运行代码和检查外部代码之类的事情。作为这个特定问题的答案，这可能有点矫枉过正。

# asp.net-mvc - ASP.NET MVC：授权后登录页面的自定义参数

> ID：904322
> 
> 赞同：0
> 
> 时间：2009-05-24T18:04:21.837
> 
> 标签：asp.net-mvc, authorization, custom-action-filter

我想在授权失败后将访问者重定向到带有添加参数的登录页面（基于他们正在执行的操作）。

这是我想做的一个例子：

[ASP.NET MVC - CustomeAuthorize 过滤器操作使用外部网站登录用户](https://stackoverflow.com/questions/835672/asp-net-mvc-customeauthorize-filter-action-using-an-external-website-for-loggin)

但是，由于这是一个自定义过滤器，我不知道如何或是否可以像通常的授权过滤器一样指定角色。我想要类似的东西：

```
[CustomAuthorization(Roles="Admins")] 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T18:20:54.773

您可以从 AuthorizeAttribute 类继承并覆盖 OnAuthorize 方法，如下所示：

```
public override void OnAuthorization(AuthorizationContext filterContext)
{
    base.OnAuthorization(filterContext);
    if (!HttpContext.Current.User.IsAuthenticated)
    {
        filterContext.Result = new RedirectResult("target");

    }
} 
```

然后你可以像 AuthorizeAttribute 一样使用这个自定义过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T18:20:27.800

您是否尝试过下载 ASP.Net MVC 源代码并查看 AuthorizeAttribute 的代码（在 AutorizeAttribute.cs 中）？

从现有的 AuthorizeAttribute 派生您的 CustomAutorization 可能是有意义的 - 检查它，看看您是否可以添加所需的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-29T21:09:28.057

在您的自定义 Authorization 类中仅使用 Request.Form 怎么样。毕竟这只是一个 POST 调用？不要让它变得比实际更难。

# javascript - Javascript 事件同步

> ID：904329
> 
> 赞同：0
> 
> 时间：2009-05-24T18:06:53.860
> 
> 标签：javascript, synchronization, events

有没有可能在javascript中同步事件的方法？

我的情况如下：我有一个包含许多字段的输入表单，每个字段都注册了一个 onchange 事件。还有一个按钮可以打开一个弹出窗口，以便在那里做一些其他/特殊的事情。

我的要求是，在我可以打开弹出窗口之前完成 onchange 事件。

任何想法如何在不使用 setTimeout 的情况下实现这一目标？

*编辑：*要求的进一步解释：

为了澄清我的情况，我尝试详细说明我在做什么。

我得到了一个包含一些输入项的表单（订单输入矩阵表单，例如文章、序列号、计数）。每次用户更改其中一个字段中的数据时，onchange 事件都会触发 ajax 调用，以验证用户输入并读取其他数据（例如，预设/格式化其他字段之一）。这些 ajax 调用很繁重且耗费时间，因此我必须避免重复验证。还有一个按钮可以打开一个弹出窗口，为用户提供另一个表单来逐行更改他之前输入的数据，因此在打开此弹出窗口之前完成所有验证是绝对必要的。目前，我尝试使用 setTimeout 同步 onchange 事件和弹出窗口打开（在完成所有验证之前不会打开弹出窗口），这会导致我的客户站点出现问题，因为这些弹出窗口被弹出窗口阻止程序捕获。

由于我的矩阵形式，我无法在打开弹出窗口之前验证所有输入项，我只需要验证那些已更改且尚未验证的输入项（最多应为 1 个）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T18:16:26.183

听起来您正在进行表单验证，当表单完全完成时会自动弹出。为此，您需要在 javascript 中编写一个验证函数来检查表单上的每个字段。您可以从每个 OnChange 事件中触发此函数，并在整个表单成功验证时让该函数打开弹出窗口。

当您有一点空闲时间时，可以考虑查看 jQuery。

[http://jquery.com/](http://jquery.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T19:45:01.323

您可以为 onchange 事件设置一个小回调，以确保在弹出窗口之前进行所有验证。

```
function onChange(callback)
{
    // Do validation

    // Call the callback
    callback();
}

function showPopup()
{
    // Show the popup
} 
```

然后在你的 onchange 电话上打电话

```
onChange(showPopup); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T22:15:06.980

为每组验证设置标志​​（变量）。

*   在 0 处启动标志。
*   当组的验证完成时，将该标志设置为 1。
*   当用户弹出按钮时，如果所有标志都为 1，则弹出窗口。

Jon 提到的回调将解决“如果还没有全部验证，你会怎么做？”的问题。

* * *

编辑：澄清后添加：

**您是否考虑过在验证所有内容后**通过 DOM 方法（简单）（或 innerHTML，如果您愿意）添加弹出按钮？这样，在它的时间之前没有显示任何选项。:D

另外，您是否测试弹出窗口是否被阻止？如果是，您可以分支到向用户发出他们的阻止程序正在阻止编辑器的通知；或自动将您的编辑器加载到 iframe 中；或通过 DOM 方法（附加 documentFragment 等）将编辑器加载到主页。

一些拦截器为用户提供了阻止点击链接生成的弹出窗口的选项（这在传统上是禁止拦截器使用的）。我认为您将从某种备份方法中受益，或者无论如何至少有一个警告系统。

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-19T02:15:24.833

对于某些步骤需要 AJAX 验证的向导，我们需要类似的东西。如果有任何未决的验证，则不允许用户通过单击完成来关闭向导。为此，我们只需要一个用于等待验证的计数器，以及一个用于指示用户是否希望关闭向导的标志。基本算法是：

*   如果启动了新的 AJAX 验证，则增加“待定”计数。
*   当 AJAX 验证返回时，减少“待处理”计数。
*   如果在递减时，未决计数达到零，请检查“完成”标志；如果已设置，请完成向导。
*   当用户点击完成时，检查“待处理”计数；如果为零，则完成向导；它非零，设置“完成”标志。

这样，可以只使用两个变量（“待处理”、“完成”）来处理同步。

我强烈建议不要对每个不同的 AJAX 操作使用多个标志；当使用多个状态变量跟踪状态时，状态机通常会失控。除非绝对必要，否则尽量避免。

我也不建议使用`setTimeout`to 任意等待，直到满足所需的条件。使用上面的计数器方法，您的代码将在条件发生变化时立即采取行动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T18:49:21.717

让输入字段假设您仅表示文本输入，而不是任何复选框或组合框（我猜您正在尝试进行某种自动完成）。我的建议是使用 onkeyup 和 onkeydown。

```
var keypressed = false;

function onkeydown( )
{
   keypressed = true;
}

function onkeyup( )
{
  keypressed = false;
  setTimeout( function()
              { 
                 if (!keypressed) 
                    show_popup();
                 else 
                    setTimeout( this.calee,1000)
               }, 1000 );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T18:16:36.527

如果您设置了一个全局变量并使用 setTimeout 来检查它是否设置正确。根据情况的复杂程度，您可以使用一个布尔值、两个布尔值、一个递增的数字，甚至是一个对象。就我个人而言，我会使用一个对象，因为我知道哪个对象还没有被解雇。就像是
`var isDone = {username: 0, password: 0, password2: 0};`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T20:28:25.923

我认为我没有完全理解你的问题，但这里有一些关于解决你*可能*遇到的问题的想法:)

首先，我会在发送 ajax 调用时停用弹出式打开按钮。然后，当请求的数据到达并完成所有验证时，再次激活它。你可以用一个计数器来做到这一点：为每个发送的请求增加它，一旦数据到达并完成验证就减少它。当数据到达并且计数器为零时激活弹出打开按钮。这可以防止用户在仍有待处理的验证请求时单击弹出式打开按钮。

您可以对输入字段本身使用相同的技术：通过将等待验证的输入字段设置为只读来锁定它们，在一切完成后解锁它们。

为了防止在 ajax 调用尚未返回时用户更改表单值时出现问题，您有几个选项：

*   使用计时器发送请求：每次触发 onchange 事件时，在发送请求之前等待 x 秒。如果在发送 ajax 请求之前发生了另一个 onchange 事件，则重置该计时器。这样，具有特定时间范围的几个 onchange 事件仅触发 1 个 ajax 请求。这有助于减少负载。

*   您可以计算并存储每个位置的校验和，因此如果触发了 onchange 事件，请再次计算校验和并进行比较。这样你就知道哪些部分真的被改变了，避免了不必要的验证请求。

另外，永远不要按时下注（如果我正确理解了 settimeout 的内容）。x 秒在正常情况下可能就足够了，但在最坏的情况下......

# java - 使用 Restlet 客户端发送二进制数据

> ID：904333
> 
> 赞同：7
> 
> 时间：2009-05-24T18:07:59.630
> 
> 标签：java, http, rest, restlet, put

我正在尝试使用 Restlet 发送一个字节 []（使用 PUT），但我找不到任何有关如何操作的信息。我的代码如下所示：

```
Request request = new Request(Method.PUT, url);
request.setEntity( WHAT DO I PUT HERE?, MediaType.APPLICATION_OCTET_STREAM); 
```

我曾期望找到类似 ByteArrayRepresentation 的东西，就像有一个 JsonRepresentation 和一个 StringRepresentation 一样，但我什么也找不到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T18:55:21.937

我相信您想使用[InputRepresentation](http://www.restlet.org/documentation/1.1/api/org/restlet/resource/InputRepresentation.html)，如下所示：

```
Representation representation = new InputRepresentation(new ByteArrayInputStream(bytes), MediaType.APPLICATION_OCTET_STREAM);
request.setEntity(representation); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T18:13:18.140

我不熟悉restlet，但一种方法是对数据进行base64编码。然后你可以像处理普通字符串一样处理它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T18:57:31.327

您可以尝试`WritableRepresentation`专门为大型表示设计的子类化

# php - 为什么 livehttpheaders 会显示我的登录名和密码，我该如何防止？

> ID：904344
> 
> 赞同：1
> 
> 时间：2009-05-24T18:14:02.117
> 
> 标签：php, security, http-headers

我正在查看[Firefox 的 livehttpheaders 插件](https://addons.mozilla.org/en-US/firefox/addon/3829)并决定测试我的登录页面。我注意到其中显示的参数包含我的登录名和密码。例如：

```
username=sarmenhb&password=thepassword&submit=Login 
```

用简单的英语。

我在其他网站上看不到这个。

我做错了什么？我认为这是一个安全漏洞。登录页面，它所做的只是验证并登录用户。所有字段都经过`mysql_real_escape_string`（如果相关）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T18:18:40.610

信息必须以某种方式从客户端到达服务器。如果您担心安全性，请使用 SSL。

即使您在 Javascript 中执行 MD5 哈希，这**也无济于事**，因为将哈希提交到登录页面是微不足道的，并且哈希有效地成为密码。所有东西都是纯文本，直到它们或传输被加密。**发布变量，使用 SSL**。

从我下面的评论中添加。您可能看不到其他站点的标头，因为它们可能使用 AJAX、POST 方法或其他客户端机制进行身份验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T18:38:01.873

您看到的是您的网站而不是其他网站，因为 livehttpheaders 显示 GET 请求的 URL，但不显示 POST 请求的内容。

通过 GET 请求发送登录信息比发送 POST 是一个额外的安全漏洞，因为 GET 请求的 URL 通常记录在不同的位置，而几乎没有人记录 POST 内容。每个有权查看网络服务器日志的人都有权知道 CEO 的密码吗？

但是，正如其他人指出的那样，除非您使用 https: 登录，否则无论您使用 GET 还是 POST，数据都会以纯文本形式通过网络传输。这几乎总是不好的。

尽管如此，作为一种中间措施，我会更改您的应用程序以将用户名和密码内容作为 POST 而不是 GET 发送，这样您就不会最终将用户名和密码存储在您的网络服务器日志中 - 通过网络使用 https 是没有用的如果您正在做一些事情，然后将用户名和密码写入服务器上保护不足的日志文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T18:27:59.893

这让我想起了大城市中的某栋建筑（我相信其他地方也有其他建筑），那里有一个基于 Web 的建筑礼宾界面。居民可以登录网站（通过http）并指定（除其他外）谁可以在他们不在的情况下进入他们的公寓进行维修等。我确信整个事情是由某人的“大师”侄子编程的。

我敢肯定，容我们说，[足够好](https://stackoverflow.com/questions/903572/consequences-of-doing-good-enough-software)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-05T08:37:16.193

HTTP 实时标头也显示 POST 请求。Post 以与 GET 相同的方式发送数据，但唯一的区别是变量在 GET 中通过 url 本身传递，但在 POST 中它们附加到 HTTP 标头。

为了获得更好的安全性，请在 JS 中使用加密（仅密码或令牌+密码）。但这仍然可以使用彩虹表来破解，比如 MD5 或任何其他散列技术。

SSL 是实现高安全性的唯一途径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T18:25:01.163

如您所见，当您使用 http 并提交表单时，表单内容会“以明文方式”通过网络发送。当该表单提交包含凭据时，是的，您遇到了安全问题。

您的选择包括：

*   使用 https，以便对有线通信进行加密
*   使用[OpenID](http://openid.net/)登录，将 https 凭证的管理推送到用户的 OpenID 提供者
*   在发布表单之前在客户端使用 Javascript 加密凭据

如果他们不是很小心，后一种方法往往会给人们带来麻烦，因为加密凭证的机制对于任何关心检查 javascript 的人来说都是完全可见的。

# c# - 如何将代码添加到 ac# 形式的退出按钮？

> ID：904345
> 
> 赞同：7
> 
> 时间：2009-05-24T18:14:15.207
> 
> 标签：c#, button, exit

我正在使用 Microsoft Visual C# 2008 Express。

在我的主表单中，右上角有用于关闭表单的 X 按钮。如何向此按钮添加代码？在我的菜单中，我有一个“退出”项，它有清理和关闭我的数据库的代码。如果用户选择将其作为退出方式，我如何向此按钮添加相同的代码？

谢谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-24T18:18:19.053

使用 FormClosing 事件应该可以捕获任何关闭表单的方式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-24T18:22:17.470

在窗体的设计视图中，在属性窗口中，选择事件按钮并向下滚动到“FormClosed”和“FormClosing”事件。

FormClosed 在窗体关闭后调用。

FormClosing 在表单关闭之前调用，还允许您取消关闭，保持表单打开：

```
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    e.Cancel = true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T19:01:52.457

如果您想问用户“您确定要关闭此表单吗？”，然后使用`FormClosing`, 您可以在其中设置`Cancel = True`并且表单将保持打开状态。

如果您只想在表单确定关闭时关闭某些资源，那么您可以使用`FormClosed`event.

如果您可以控制整个代码，那么这并不重要。`FormClosing`但是您不希望发生的事情是在事件的其他处理程序将保持表单打开时使用清理资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T18:16:23.297

使用您的 winform 的 Closed-Event。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T18:26:39.570

FormClosing/FormClosed 让您可以观察该表单的事件，该事件可能与应用程序退出一致。但是，您可以连接另一个名为 Application.ApplicationExit 的事件。

在您的 Main 方法中：

```
Application.ApplicationExit += Application_ApplicationExit;

...

private static void Application_ApplicationExit(object sender, EventArgs e) {

  // do stuff when the application is truly exiting, regardless of the reason

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T18:46:35.713

此代码将捕获用户单击“X”或在表单上使用 Alt-F4 以允许您执行某些操作。我必须使用它，因为我需要该操作来调用我的关闭事件，并且由于赛车事件而在使用 FormClosing 事件时它不会调用它。

```
/// <summary>
/// This code captures the 'Alt-F4' and the click to the 'X' on the ControlBox
/// and forces it to call MyClose() instead of Application.Exit() as it would have.
/// This fixes issues where the threads will stay alive after the application exits.
/// </summary>
public const int SC_CLOSE = 0xF060;
public const int WM_SYSCOMMAND = 0x0112;
protected override void WndProc(ref System.Windows.Forms.Message m)
{
    if (m.Msg == WM_SYSCOMMAND && (int)m.WParam == SC_CLOSE)
        MyClose();

    base.WndProc(ref m);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-02T16:42:31.103

双击 form'design 中的退出按钮，然后调用 Dispose() 方法

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-04T05:02:12.143

表单操作方法 //

```
 protected override void OnFormClosing(FormClosingEventArgs e)

          {
          base.OnFormClosing(e);

          if (e.CloseReason == CloseReason.WindowsShutDown) return;

               switch (MessageBox.Show(this, "Are you sure you want to exit?", "Exit", MessageBoxButtons.YesNo))
                     {
                       case DialogResult.No:
                           e.Cancel = true;
                           break;
                     default:
                          break;
                     }
         } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-01T07:31:48.753

```
 You can use form closing events choose or set closing event in  properties window      
 You can add dialog conditions based on what task you want to perform before closing form

private void Form1_FormClosing(object sender,FormClosingEventArgs e)
{
Application.Exit();
//you can also use Application.ExitThread();
} 
```

# java - 以编程方式或通过命令行分析 SSL 证书

> ID：904346
> 
> 赞同：3
> 
> 时间：2009-05-24T18:14:23.613
> 
> 标签：java, c++, c, objective-c, ssl

我想分析给定 url 的证书并获取它的一些详细信息。你知道有什么方法可以做到这一点吗？命令行工具可以类似于`downloadSSLCert https://my.funny.url/ > certFile`然后对其进行分析以获取证书的指纹。它可以是命令行实用程序、C/C++/Objective-C 或 Java 代码，将在 osx >= 10.5 上使用

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T18:21:37.253

您可以从命令行建立 SSL 连接：

```
echo '' | openssl s_client -connect www.google.com:443 
```

输出将包含 base64 编码的 X.509 证书。

要查看更多详细信息，

```
... | openssl x509 -fingerprint -text 
```

如果您*只*想要指纹，请省略“ `-text`”标志并添加“ `-out /dev/null`”。

# git - 无法理解 Git 分支、合并和变基

> ID：904353
> 
> 赞同：9
> 
> 时间：2009-05-24T18:17:33.500
> 
> 标签：git, branch, rebase

我知道[线程](https://stackoverflow.com/questions/96615/git-is-it-pull-or-rebase-when-working-on-branches-with-other-people)说 rebase 是针对 teamMates 的小更改，而 merge 是针对大更改。

我将三个队友的三个 Git 保存在以下目录结构中，我们都有相同的初始代码：

```
project 
      | - I
      | - myTeamMate1
      | - myTeamMate2 
```

分支不在同一个 Git 中。这意味着我不能使用变基和合并。我使用 vimdiff 来同步 teamMates 之间的更改。但是，这很耗时。

我没有成功尝试创建以下目录结构，其中所有分支都在一个 Git 下：

```
project
      | - I - myTeamMate1 - myTeamMate2 
```

但是，我为我和我的队友运行克隆命令：

```
git clone <url> 
```

我在为队友运行第二个克隆后收到错误消息

```
fatal: destination path 'dotFiles' already exists and is not an empty directory. 
```

**我应该与 3 人团队一起使用哪种目录结构，**以便我可以使用`rebase`和`merge`命令？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-25T04:09:43.073

只是一些其他想法来完成塞缪尔的回答。

*   与 SVN 不同，分支和目录在 Git 中是完全不相关的：拥有 3 个分支（每个团队成员一个）并不意味着 3 个目录。这不是您在问题中的意思（因为您的目录实际上是 3 个 Git 存储库的 3 个根目录），但我更愿意明确提及它以防万一；）

*   Git 是 DVCS，这 3 个存储库可以在任何地方（而不是在同一台计算机上的 3 个目录中）。如果它们可以通过 UNC 路径 ( `\\desktop\path\to\repo`) 访问，则可以将它们指定为远程。

*   Git **clone 确实允许**您获取对远程分支的引用，但不会创建跟踪本地分支以允许您获取同事的工作。ruby 模块“[远程分支](http://grb.rubyforge.org/)”可以提供帮助。

*   小心[rebase](https://stackoverflow.com/questions/804115/git-rebase-vs-git-merge)，因为它会重写你的分支的 SHA-1（因为你在另一个分支上重放你的提交）：如果你的队友基于你的分支进行合并，他们每次都必须合并你的*所有*提交，即使是那些已经合并了！
    在这种情况下最好有 2 个分支：

    *   您用于开发和变基的**工作分支（以集成同行的工作，尽管即使该操作也可以在其自己的分支中完成）**
    *   一个**发布公共分支**，你只合并你的稳定工作，然后可以被其他远程存储库用作合并的源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T18:25:34.017

*它们与您所说的不在同一个 git*中这一事实不会以任何方式限制您。Git 是分布式的，这意味着您可以在这些存储库之间获取、合并、变基等。

查看`git remote --help`如何在您的团队中**命名**您的队友存储库，以便您可以轻松地**导入**他们的更改、基于它们进行**变基**或执行**合并**。无需更改目录结构，您的目录结构完全可用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-25T19:30:12.407

**代码示例**

跟踪远程分支

```
git remote add -t master Hnr git://github.com/userName/files.git 
```

这不会下载您的分支。它只是编辑文件 .git/config 并添加几行告诉 Git 如何以及如何远程获取数据。

要获取您的队友的分支，请运行

```
git fetch Hnr 
```

要查看您确实拥有您的队友的分支，请运行

```
git branch -a 
```

或仅查看您朋友的分支机构

```
git branch -r 
```

上面两个命令最初引起了我的困惑，因为我不知道它们。这让我尝试了其他不必要的命令来为我创建分支。

**第二种方式来拥有你朋友的分支**

但是请注意，您可以使用 git-clone 将您朋友的代码保存到单独的目录中，如下所示

```
git clone UrlAtGithub 
```

然后，您显然可以使用上面的 Git-remote 在您的 Git 存储库中创建一个分支：

```
git remote add master Hnr PATH/ToYourFriendRepo.git 
```

**结论：**您可以使用两种方式为您创建 teamMate 的分支，通过 git-clone 或不使用它。两种方式都需要使用`git remote add`. 后者的优势似乎是您需要少运行一个命令。前者然后再次将您的队友的整个回购提供给您的硬盘。

请参阅 Git 手册，了解如何更新远程分支。*（NB 远程分支可以在您的计算机上。它不必在远程计算机上。您的分支也可以是远程分支，但这会限制您的工作流程。）*

* * *

接下来，您可能希望将您朋友的特定文件合并到您的分支。在这种情况下，只需知道您朋友提交的 5 个首字母即可合并文件。

**[我不确定您如何执行以下操作：]**例如，您需要运行

```
git merge 76a32 
```

您可能会得到以下输出

```
CONFLICT (add/add): Merge conflict in shells/externalPrograms
Auto-merging shells/smallApps/extract
CONFLICT (add/add): Merge conflict in shells/smallApps/extract
Auto-merging shells/smallApps/extract~
CONFLICT (add/add): Merge conflict in shells/smallApps/extract~
Automatic merge failed; fix conflicts and then commit the result. 
```

在这种情况下，您的文件与您朋友的文件有很大不同，Git 无法决定采用哪个文件。您显然需要运行以下内容

```
git rebase 
```

你得到

```
shells/smallApps/extract: needs merge
shells/smallApps/extract~: needs merge
cannot rebase: you have unstaged changes 
```

**练习 1：**但是，我现在陷入困境，因为我的 tig 没有在我的 Git 树上显示我朋友的提交。 **您如何将朋友的提交 76a32 提交到您的 Git 树**中的哪个分支在您的 Git 中？

* * *

您现在可能已经解决了问题。问题在于我忽略了解决 Git 给我通知的冲突。谷歌在[官方 Git 网站上](http://book.git-scm.com/3_basic_branching_and_merging.html)再次拯救了这一天：

> 如果有冲突——例如，如果同一个文件在远程分支和本地分支中以两种不同的方式被修改——那么你会被警告——

接下来的问题是清理有问题的部分并再次合并。您会在有问题的文件中看到类似于以下内容的内容——玩得开心！（我终于遇到了真正的问题；）

[替代文字 http://dl.getdropbox.com/u/175564/exampleGitProblemSolving.png](http://dl.getdropbox.com/u/175564/exampleGitProblemSolving.png)

* * *

**在 Mac 的 FileMerge 中区分和合并点文件的问题**

我需要更新我的 Git，因为只有最新的 Git 有 difftool -command。您可以在[线程](https://stackoverflow.com/questions/920535/unable-to-change-where-git-is-loaded-in-mac/920573#920573)中找到解决方案。

Difftool 允许您从终端启动 FileMerge 中的 dotFiles。您无法在 GUI 中访问它们。它像

```
git difftool master:README dev:README 
```

* * *

**添加新的远程帐户后，您在 Github 中的帐户出现问题**

您的 Github 帐户可能已在 .git/config 中消失。在这种情况下，您需要运行以下代码

```
git remote add -f YourUserName UrlIn@form.git 
```

然后你可能会注意到你不能正常 git-push

```
git push origin master 
```

您可能会收到以下错误消息

```
fatal: 'origin' does not appear to be a git repository
fatal: The remote end hung up unexpectedly 
```

您也可以尝试以下命令来解决问题

```
git push Masi master 
```

以及 Masi、master 和 origin 的所有 3 个低于 2 的排列。但是，没有一个命令不起作用。

**[练习 2](https://stackoverflow.com/questions/922210/unable-to-git-push-master-to-github/922461#922461)：**当您的远程列表中有一个队友时，您如何提交到您的 github 帐户？

Origin 是您实际外部 git-repo 的简称，例如在 Github。您的变量来源的内容可能已被另一个远程仓库替换。在这种情况下，我建议您通过

```
git remote add github git@github.com:myLogin/myProject.git 
```

请注意，您可以使用 origin2 代替 github。Origin 只是命名 repo 的约定。

然后你可以简单地运行

```
git push github master 
```

您的 ssh 密钥中可能有密码。如果你有，你可能会得到一个权限被拒绝的警告。如果你这样做了，请查看[线程](https://stackoverflow.com/questions/922210/unable-to-git-push-master-to-github/922461#922461)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-25T14:36:05.630

说实话，我开始努力输入一个漂亮、长、详细的回复......但我已经解释得比我在[http://excess.org/article/2008/07/ogre-git-教程/](http://excess.org/article/2008/07/ogre-git-tutorial/)。他涵盖了不同分支、远程和合并的使用。它也是在截屏中完成的，所以花一个小时，喝杯咖啡，享受讲座。

具体到您的问题：您不应该使用目录设置。Git 处理目录分支的方式与 SVN 处理分支文件夹的方式不同。git 中的分支是完全不同的东西。虽然您可能不会设置中央存储库（我推荐它），但您应该设置一个**主**分支，每个人都提交他们最终的、干净的工作。

我的一个示例存储库在[Wikimedia Commons](http://commons.wikimedia.org/wiki/File:Git_branches_example.png)上有一张截图。在我的示例中，“调酒师”仅以 tar 块的形式提交他的代码，因此我必须自己导入它来管理它。“master”（此处仅显示为 remotes/elf/master）是一个公共 svn 存储库，我导入并从中进行基本更改。“**独裁**”是我自己的代码基线，“**私人**”是我保存一个配置文件的地方，其中包含我想要管理但从不发布的密码。检查 private 上的**时间戳**，您会注意到它们与下面的分支不对齐。这是因为我将该*分支重新设置为“独裁”而不是合并*。

您会注意到两个远程引用：*elf 和 bard*。这是我的两台托管软件的远程机器。我可以随意推拉我的树枝到那里。在您的情况下，您将拥有其他开发人员的远程存储库，并且他们会修改自己的分支。观看本教程将使您更好地了解它是如何工作的。祝你好运 ：）

# asp.net - 为什么 head-tag 中的 runat 属性会改变 ASP.NET 中处理元标记的方式？

> ID：904361
> 
> 赞同：1
> 
> 时间：2009-05-24T18:20:50.843
> 
> 标签：asp.net, webforms

示例 1：

```
<head>
  <meta http-equiv="description" content="<%= Foo %>"/>
</head> 
```

渲染

```
<meta http-equiv="description" content="Bar"/> 
```

示例 2：

```
<head runat="server">
  <meta http-equiv="description" content="<%= Foo %>"/>
</head> 
```

渲染：

```
<meta http-equiv="description" content="&lt;%= Foo %>"/> 
```

请注意差异，`<`已经成为`&lt;`但`>`保持不变。

关于这个主题有[一些](https://stackoverflow.com/questions/417510/edit-html-meta-tag-w-asp-net) [问题](https://stackoverflow.com/questions/873880/trouble-print-meta-tags-with-asp-net-mvc)，答案是解决方法，但似乎没有人知道为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T18:39:23.917

服务器控件中不能有脚本标记 (<% = %>)，这就是为什么它会变成纯文本而不是被执行的原因。

您可以从后面的代码中添加元标记，如下所示：

```
HtmlMeta meta = new HtmlMeta();
meta.HttpEquiv = "description";
meta.Content = Foo;
Page.Header.Controls.Add(meta); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T18:40:09.610

当您添加 runat=server 时，Head 标记将成为服务器控件。我猜根据您的结果，服务器控件的内容没有被解析为使用 <% ... %> 语法进行内联替换。

您也可以通过将 runat=server 添加到 Meta 标记并以编程方式访问其属性来使 Meta 标记成为服务器控件。

# android - 从滚动视图打开子视图

> ID：904376
> 
> 赞同：2
> 
> 时间：2009-05-24T18:27:18.240
> 
> 标签：android, android-scrollview

我有一个`ScrollView`有孩子观点的父母。当用户按下后退按钮时，我希望子视图处理事件。我尝试了几件事，但似乎都没有工作。按下后退按钮会终止活动。

```
public class GameScrollView extends ScrollView{

     public GameScrollView(Context context) {
          super(context);
     }
     @Override
     public boolean onInterceptTouchEvent (MotionEvent ev){
          return false;

     }
     @Override
     public boolean onKeyDown (int keyCode, KeyEvent event){
          return false;

     }
} 
```

在子视图中，我有以下代码

```
public class GameView extends View implements OnTouchListener, onKeyListener{

     public boolean onKey(View v, int keyCode, KeyEvent event){
          if(keyCode == KeyEvent.KEYCODE_BACK){
                    //do stuff
          }
          invalidate();
          return true;        
     }
} 
```

在`ScrollView`我也尝试过覆盖`dispatchKeyEvent`返回false的方法，但这也不起作用。我在这里做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T03:19:25.883

```
@Override 
public boolean onKeyDown(int i, KeyEvent event) {

      if (i == KeyEvent.KEYCODE_BACK) {
          return true;
        else {
          super.onKeyDown(i, event);
          return true;
        }
      }
      return false;
    } 
```

另外，我认为您必须拦截活动中的按键，而不是视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T01:51:02.980

我想到了。这不起作用的原因是子视图没有焦点。

`requestFocus()`在子视图的构造函数中设置属性解决了这个问题。

# mime - MIME 类型的 URN

> ID：904379
> 
> 赞同：4
> 
> 时间：2009-05-24T18:28:34.323
> 
> 标签：mime, mime-types, urn

MIME 类型的官方 URN 是否存在？

Mozilla Firefox 和其他应用程序使用“ `urn:mimetype:text/plain`”或“ `urn:mimetype:handler:text/plain`”等符号。这种方法有两个问题：

1.  `mimetype`根据 IANA 的官方注册表 ( [http://www.iana.org/assignments/urn-namespaces/](http://www.iana.org/assignments/urn-namespaces/) ) ，不存在“ ”命名空间。因此，只有“ `urn:x-mimetype`”才是有效的命名空间（根据 RFC 3406 第 4.1 节）。

2.  根据 RFC 2141 第 2.2 节，斜杠“ `/`”不能在 URN 中使用。但它可以编码为“ `%2F`”。

考虑到所有这些，有没有另一种方法可以将 MIME 类型“ `text/plain`”表示为 URN 而不是“ `urn:x-mimetype:text%2Fplain`”？

[更新：考虑一下，URI 也可以。但我也找不到 MIME 类型的 URI。]

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-09T06:42:53.637

仅供参考，我将 RFC 2141 的存在读`/`作 SHOULD NOT，而不是 MUST NOT。

对于这种方法，我将只使用分配的 URI，例如 < [http://www.iana.org/assignments/media-types/application/zip](http://www.iana.org/assignments/media-types/application/zip) >。唯一需要注意的是，并非所有这些都取消引用。如果你能忍受它，你应该没问题。

# macos - 哪些文件应该只在根目录？

> ID：904380
> 
> 赞同：0
> 
> 时间：2009-05-24T18:28:57.303
> 
> 标签：macos, unix, root

我的 Mac 将 Vim 的临时文件、扫描仪的日志文件和 mach_kernel 文件保存到我的根目录。我没有设置这个程序。

我目前正在删除根目录下的文件，因为其中许多似乎只是交换文件。我的想法是只有文件夹和系统的符号链接应该在根目录下。

**哪些文件应该只在根目录？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T18:35:04.983

[文件系统层次标准](http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard)可能有用。

它[在有关根文件系统的部分中](http://www.pathname.com/fhs/pub/fhs-2.3.html#THEROOTFILESYSTEM)指出：

> 根文件系统的内容必须足以引导、恢复、恢复和/或修复系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T18:37:38.240

你可以在那里拥有任何你想要的东西，但你应该担心的是遵循[FHS 标准。](http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard)（如思南所说）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T18:33:24.690

如运行时显示的文件

```
ls / 
```

?

如果是这样，我同意，只有文件夹和符号链接。我不喜欢文件在那里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T05:42:45.900

Mac OS X 并没有完全遵循[FHS 标准](http://en.wikipedia.org/wiki/Filesystem%5FHierarchy%5FStandard)——特别是，它将其内核（2 个版本，我不确定为什么）和内核符号文件保留在 / 而不是 /boot 中，所以这是正常的（对于 OS X）。

与标准布局还有一些其他区别：OS X 将用户主目录保留在 /Users 而不是 /home，安装点在 /Volumes（或在某些情况下是 /Network）而不是 /mnt，并保留 etc、tmp 和 var在 /private 而不是 / 下（在 / 下带有符号链接，因此可以通过通常的路径引用它们）。它还保留了一些（不可见的）文件系统支持文件/目录——比如 Spotlight、[FSEvents](http://arstechnica.com/apple/reviews/2007/10/mac-os-x-10-5.ars/7)和[热文件](http://developer.apple.com/technotes/tn/tn1150.html#HotFile)数据库等。

我能想到 vim 将临时文件存储在 / 中的唯一原因是如果你在 / 中编辑文件——我认为不是这样吗？

至于扫描仪……它到底是什么，它是如何启动的？它可能只是在其当前工作目录设置为 / 的情况下启动，并在那里记录，因为它不知道更好。如果你能弄清楚如何控制它，我建议让它登录到 /var/log（unix 传统位置）、/Library/Logs（Apple 喜欢将其日志文件放入其中）或 /Users /yourname/Library/Logs （如果它是用户特定的，而不是系统范围的东西）。

# usability - 为什么某些网站上的页面标题是可点击的 URL？

> ID：904381
> 
> 赞同：22
> 
> 时间：2009-05-24T18:29:03.183
> 
> 标签：usability, standards

为什么在 Stack Overflow、Techcrunch、Smashing Magazine 等网站上，页面标题（即页面顶部的文本）可点击的 URL 会重定向到用户所在的同一页面？

一些例子：

![在此处输入图像描述](https://i.stack.imgur.com/rgMCc.png)

我相信这不会影响搜索引擎优化，因为搜索引擎会忽略内部链接。

是否出于可用性目的？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-24T18:31:37.767

它允许您右键单击它并选择*复制链接位置*（或等效），以便您可以轻松地将其粘贴到例如电子邮件中。这比从位置栏复制它需要更少的时间，并且有些人在没有可见位置栏的情况下运行浏览器以节省以前的屏幕空间。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-24T22:20:21.183

最重要的是，它提供了指向页面**默认状态**的链接。

例如，对于这个堆栈溢出页面，用户可以通过以下任何非默认链接到达这里：

*   [为什么某些网站（包括 Stack Overflow）上的页面标题是可点击的 URL？](https://stackoverflow.com/questions/904381/)
*   [https://stackoverflow.com/questions/904381​​#foobar](https://stackoverflow.com/questions/904381#foobar)
*   [https://stackoverflow.com/questions/904381​​?sort=date](https://stackoverflow.com/questions/904381?sort=date)

虽然默认链接实际上是：

*   [为什么某些网站（包括 Stack Overflow）上的页面标题是可点击的 URL？](https://stackoverflow.com/questions/904381/why-are-page-titles-on-some-websites-including-stack-overflow-clickable-urls)

如果用户无法进入默认状态，他们最终会为传播给新用户的非默认链接添加书签或通过电子邮件发送，问题只会成倍增加。

单击帖子的标题链接将恢复默认状态并删除所有查询参数（？sort = date），命名锚（#foobar）并修复故事slug（/why-are-page-titles / ... ）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-24T18:31:48.610

我用它来刷新页面（是的，我也可以按 F5）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-24T18:45:47.913

是的，Jakob Nielsen 说过链接到自己是一个[网页设计错误](http://www.useit.com/alertbox/20031222.html)（nr 10）。并且我同意。

更多阅读信息[在这里。（编号 10）](http://www.useit.com/alertbox/20031110.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-24T18:33:11.977

URL 重定向到页面的开头，以防您通过特定答案到达页面（所有答案也是可点击的 URL）。这样，您将获得问题的 URL，而不是答案。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-24T19:06:52.197

不确定这是否是他们这样做的原因，但我发现虹吸标签很有用：

如果我简要地看一些东西并想“我想在一分钟内彻底阅读这篇文章，但继续我之前所做的事情”，我可以这样做：

我可以右键单击该链接，单击“在新选项卡中打开”，然后单击“返回”并继续。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-28T00:03:16.193

它被称为[永久链接](http://en.wikipedia.org/wiki/Permalink)......这个名字暗示了它是什么，一个永久链接。

这与 SO 上的每个答案都有一个您可以复制的链接的原因相同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T19:08:34.923

我认为它继承了 CMS 的行为，其中每个问题都是一个节点，它有 0<= 已回答的问题。现在想想你去搜索apache问题。结果一个接一个地显示出来。就 CMS 而言，这称为预告片。你会得到一个包含很多问题的完整页面，其中问题的标题链接到整篇文章（问题 + 答案）

它不是必须的，但您会在大多数使用 CMS 的网站上找到它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-24T19:17:01.270

只要它不伤害任何人，为什么人们会反对它？

我更喜欢让这些链接可用，因为点击刷新会重新加载页面的所有元素，而不是仅仅跟随使用缓存元素的直接链接（到同一页面）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-24T20:13:18.520

对我来说很有意义，我觉得它很有用！我打开了很多标签，所以我只需右键单击链接并返回。

对我来说，这很有意义，从 SEO 的角度来看，这也很好！它强制它阅读页面，因为它是链接的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-02-02T04:07:56.947

不会将用户带到任何地方的 UX 明智的可点击标题似乎无法使用，尽管这将我们带入了[可供性理论](https://en.wikipedia.org/wiki/Affordance)的领域，以及可供性是否能被用户感知。

例如，可点击的页面标题可能提供：

*   一种从浏览器窗口将页面添加到桌面的简单方法。
*   带有附加选项的上下文菜单，允许用户共享博客文章或文章。
*   一种更新地址栏的方法，使其指向页面的规范 URL。

但是，对于您提到的网站，页面标题似乎更有可能使用绝对 URL 转换为超链接，因此分析工具可以获取入站链接点击 - 那些发送引用信息的 -当人们复制工作并没有时导致 [DCMA 删除通知](https://writing.kemitchell.com/2018/09/02/Killjoy-DMCA.html)t 更新 URL。

当人们被激励以合同方式生产工作时，您会感到惊讶。

# java - Spring + Hibernate 动态映射

> ID：904390
> 
> 赞同：3
> 
> 时间：2009-05-24T18:33:16.640
> 
> 标签：java, hibernate, spring, mapping

抱歉，如果这是转发，我找不到搜索词来找到类似的问题。

我工作的应用程序支持可以在运行时加载或卸载的插件。有几个 API 钩子允许这些插件注册比那些开箱即用的更丰富的对象。当一个插件被激活并注册一个新的域对象时，我需要提醒休眠新对象（以及当插件被停用时删除该对象）。我们所有的对象都用 JPA / Hibernate 注释标记。

*系统类*

```
@Entity
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="type", discriminatorType=DiscriminatorType.STRING)
@DiscriminatorValue("CORE")
public class User {
    protected @Id @GeneratedValue int id;
    protected String userName;

    ...
} 
```

*插件类（在 JAR 类加载器中找到）*

```
@Entity
@DiscriminatorValue("LDAP_USER")
public class LdapUser extends User {
    protected boolean active;

    ...
} 
```

*插件入口点 API 挂钩*

```
public void activate() {
    UserManager.getInstance().registerType(LdapUser.class);
}

public void deactivate() {
    UserManager.getInstance().unregisterType(LdapUser.class);
} 
```

我知道 hybernate 支持通过一些 API 配置映射，但我也知道当有活动会话时这会产生一些严重的影响。

所以我的问题是：当 Spring 管理我的会话时，我如何重新配置​​和扩充当前的映射配置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T18:53:36.730

如果您不需要保留先前的会话数据，您可以使用新配置和新的类列表销毁/重新创建 SessionFactory。更改会话工厂中间应用程序的配置对我来说似乎不太可能，但也许有更好的 Hibernate-Fu 的人可以证明我错了。

# sql-server - Sql Server：uniqueidentifier 加整数复合 PK ...使用什么类型的索引？

> ID：904405
> 
> 赞同：2
> 
> 时间：2009-05-24T18:41:55.567
> 
> 标签：sql-server, database, indexing, primary-key, uniqueidentifier

我的 SQL Server 2005 数据库中有一个联结表，它由两列组成：

*   object_id（唯一标识符）

*   property_id (整数)

这些值共同构成一个复合主键。

**为 SELECT 性能创建此 PK 索引的最佳方法是什么？**

如果列是两个整数，我将只使用复合聚集索引（默认）。但是，当涉及到 uniqueidentifiers 时，我听说过关于聚集索引的坏事。

有人有这种情况的经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T18:51:58.793

是的，GUID 对聚集索引非常不利，因为 GUID 在设计上是非常随机的，因此会导致大量碎片，从而导致性能问题。

请参阅 Kim Tripp 的博客 - 最值得注意的是“[集群索引辩论仍在继续](http://sqlskills.com/BLOGS/KIMBERLY/post/The-Clustered-Index-Debate-Continues.aspx)”和“ [GUID 作为主键和/或集群键](http://www.sqlskills.com/BLOGS/KIMBERLY/post/GUIDs-as-PRIMARY-KEYs-andor-the-clustering-key.aspx)”——了解许多有价值的背景信息。

如果您确实需要在这两列上建立索引，我建议您使用非聚集索引 - 它可以是主索引 - 最好不要使用聚集索引。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T08:30:44.497

我将创建一个标识列，然后将其设为您的主键和聚集索引。然后，您可以根据需要在 objectid propertyid 上创建非聚集索引。

您可以创建唯一约束以确保密钥的唯一性。

这样做的原因是行将按顺序插入，因此您的减少页面拆分。此外，为您的 PK 使用整数意味着您的聚集索引值较小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T08:30:53.153

一种替代方法是使用所谓的代理键（顺便说一下，它也可以指定为主键）。

例如，添加一个标识列，该列可用于唯一标识表中的每一行，即主键。

了解 GUID 用于在 SQL Server 中全局标识一条记录（可以说这不是一种关系上正确的做法，但这不是我们关心的问题）。

标识列，现在也是主键，可以/将应用聚集索引。然后可以将单独的非聚集索引应用于原始发布者描述的复合键。

This practice avoids the issue of frequent page splits occurring within the clustered index (inserts into a random GUID primary key) as well as producing a smaller and more efficient clustered index, whilst also preserving the relationships defined within the database.

Surrogate Key Definition: [http://en.wikipedia.org/wiki/Surrogate_key](http://en.wikipedia.org/wiki/Surrogate_key)

# iphone - Interface Builder中的模型（MVC）？

> ID：904407
> 
> 赞同：1
> 
> 时间：2009-05-24T18:43:22.817
> 
> 标签：iphone, model-view-controller, interface-builder

在斯坦福 iPhone 课程 CS193P 作业 2（免费在线课程）中，步骤说明通过 Cocoa Touch Plugin -> Controllers -> Object 将模型添加到 NIB 中。这仅用于初始化目的吗？为什么我不能`awakeFromNib`在控制器类本身的方法中实例化和初始化我的模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T21:15:33.323

你不应该真的在 IB 中创建模型对象。NIB 真的应该专门用于控制器和视图。然后编写代码来创建和链接模型和控制器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T20:40:46.220

您可以通过编程方式创建模型，但我发现让 IB 为我处理它很方便。

IB 帮助您创建单例，将其链接到其他事物等等。

# seam - 在 Seam 中使用单实例多租户 Web 应用程序的经验？

> ID：904409
> 
> 赞同：2
> 
> 时间：2009-05-24T18:45:06.543
> 
> 标签：seam, saas, multi-tenant

在单实例多租户设置中使用 Seam 有什么经验吗？Seam 适合这种设置吗？你是怎么意识到的？所涉及的费用是多少？

我们的情况：Seam 2.1 SaaS web 应用程序（POJO，没有 EJB）。可用的开发预算迫使我们采用简单的每个租户一个实例的设计。该应用程序尚未投入生产，但已接近完成。

我希望我们的客户可能会重新考虑单实例多租户设置，如果它降低了预计的托管成本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T09:33:23.967

我们使用 Seam 开发了一个多租户 SaaS 应用程序。我不认为 Seam 对这类事情有任何优点或缺点。

唯一可能有用的功能是休眠过滤器（例如，在每个表上都有一个公司 ID 并为其设置一个休眠过滤器）。意味着每个查询都会自动附加此 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-02T19:28:45.073

我有一个名为 User 的类，它的成员包含所有用户数据。因此，例如，从用户到任务是一对多的关系。然后我对所有用户任务的查询很简单`select task from Task task, User user where user.id = #{user.id} and task member of user.taskList`：我也可以像另一个人提到的那样使用过滤器。但是，由于 #{user} 对象是在登录时创建的，因此可以通过 Seams 解析 EL 字符串来使用它。很方便。因此，虽然 Seam 中没有任何东西支持多租户，但它很容易做到。

# c++ - Visual C++ LNK2005、LNK2019 中的链接器错误 - 不知道为什么

> ID：904416
> 
> 赞同：0
> 
> 时间：2009-05-24T18:47:09.817
> 
> 标签：c++, visual-c++, linker, lnk2019, lnk2005

我正在尝试从 nVidia 9.5 SDK 构建代码，但出现以下链接器错误：

```
>1>NV_D3DCommonDX9U.lib(NV_StringFuncs.obj) : error LNK2005: "class std::basic_istream<char,struct std::char_traits<char> > & __cdecl std::getline<char,struct std::char_traits<char>,class std::allocator<char> >(class std::basic_istream<char,struct std::char_traits<char> > &,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &)" (??$getline@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@YAAAV?$basic_istream@DU?$char_traits@D@std@@@0@AAV10@AAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@@Z) already defined in msvcprtd.lib(MSVCP90D.dll)
1>FogTombScene.obj : error LNK2019: unresolved external symbol "public: struct IDirect3DTexture9 * * __thiscall TextureFactory::CreateTextureFromFile(struct IDirect3DDevice9 *,wchar_t const *,bool)" (?CreateTextureFromFile@TextureFactory@@QAEPAPAUIDirect3DTexture9@@PAUIDirect3DDevice9@@PB_W_N@Z) referenced in function "public: virtual long __thiscall FogTombScene::RestoreDeviceObjects(void)" (?RestoreDeviceObjects@FogTombScene@@UAEJXZ)
1>FogTombScene.obj : error LNK2019: unresolved external symbol "public: long __thiscall LoadXFile::LoadFile(wchar_t const *,bool)" (?LoadFile@LoadXFile@@QAEJPB_W_N@Z) referenced in function "public: virtual long __thiscall FogTombScene::RestoreDeviceObjects(void)" (?RestoreDeviceObjects@FogTombScene@@UAEJXZ)
1>FogTombScene.obj : error LNK2019: unresolved external symbol "public: long __thiscall LoadXFile::Initialize(struct IDirect3DDevice9 *,class std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > (__cdecl*)(class std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > const &,bool),class TextureFactory * *)" (?Initialize@LoadXFile@@QAEJPAUIDirect3DDevice9@@P6A?AV?$basic_string@_WU?$char_traits@_W@std@@V?$allocator@_W@2@@std@@ABV34@_N@ZPAPAVTextureFactory@@@Z) referenced in function "public: virtual long __thiscall FogTombScene::RestoreDeviceObjects(void)" (?RestoreDeviceObjects@FogTombScene@@UAEJXZ)
1>NV_D3DCommonDX9U.lib(NV_StringFuncs.obj) : error LNK2019: unresolved external symbol "__declspec(dllimport) public: void __thiscall std::locale::facet::_Register(void)" (__imp_?_Register@facet@locale@std@@QAEXXZ) referenced in function "class std::ctype<char> const & __cdecl std::use_facet<class std::ctype<char> >(class std::locale const &)" (??$use_facet@V?$ctype@D@std@@@std@@YAABV?$ctype@D@0@ABVlocale@0@@Z)
1>NV_D3DCommonDX9U.lib(NV_StringFuncs.obj) : error LNK2019: unresolved external symbol "__declspec(dllimport) public: static unsigned int __cdecl std::ctype<char>::_Getcat(class std::locale::facet const * *)" (__imp_?_Getcat@?$ctype@D@std@@SAIPAPBVfacet@locale@2@@Z) referenced in function "class std::ctype<char> const & __cdecl std::use_facet<class std::ctype<char> >(class std::locale const &)" (??$use_facet@V?$ctype@D@std@@@std@@YAABV?$ctype@D@0@ABVlocale@0@@Z)
1>NV_D3DCommonDX9U.lib(NV_StringFuncs.obj) : error LNK2019: unresolved external symbol "__declspec(dllimport) public: static unsigned int __cdecl std::ctype<unsigned short>::_Getcat(class std::locale::facet const * *)" (__imp_?_Getcat@?$ctype@G@std@@SAIPAPBVfacet@locale@2@@Z) referenced in function "class std::ctype<unsigned short> const & __cdecl std::use_facet<class std::ctype<unsigned short> >(class std::locale const &)" (??$use_facet@V?$ctype@G@std@@@std@@YAABV?$ctype@G@0@ABVlocale@0@@Z) 
```

我不知道为什么我会遇到这些恐惧，因为我 99% 确定我已经正确设置了我的目录。

例如，它找不到的函数之一是 TextureFactory::CreateTextureFromFile 但我已经将声明和定义该函数的目录添加到 Visual C++ 设置中的 include/source 目录中。

文件顶部如下所示：

```
#include "nvafx.h"
//#include "NV_D3DCommon\NV_D3DCommonDX9.h"  // include library sub-headers
                                             // and add .lib to linker inputs
//#include "NV_D3DMesh\NV_D3DMesh.h"

//#include "shared\NV_Common.h"
//#include "shared\NV_Error.h"

#include "FogTombScene.h"
#include "ThicknessRenderProperties.h"
#include "ThicknessRenderProperties8BPC.h"
#include "../camera.h"

// When the following two lines are added I get more LNK2005 (understandable) 
// but I also still get the same LNK2019 errors as above
#include "texturefactory.h"
#include "texturefactory.cpp" 
```

更重要的是，如果我在出现这些错误的文件顶部说#include“TextureFactory.h”和#include“texturefactory.cpp”，那么就没有歧义的余地，函数已定义并基本上复制+粘贴到生成链接器错误的同一源文件中，但我仍然收到链接器错误。

我忽略了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T19:16:40.927

您已经在 include/source 文件夹中添加了文件，但是库呢？对我来说，这更像是一个库问题（缺少 .lib）。

也许您还需要在 Linker - Input 中列出您的依赖项。

LNK2005 通常意味着附加库未正确链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T19:16:59.803

您可能忘记链接到 SDK 库文件之一。您可以在 Linker->Input->Additional Dependencies 下的项目属性中进行设置，或使用[#pragma 注释](http://msdn.microsoft.com/en-us/library/7f0aews7(VS.80).aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-09T14:16:02.463

发生这种情况是因为：

1 .lib 的源代码丢失，如 tomzx 或 Daniel，或 2 它是在另一个版本的 Visual C 中编译的 .lib 尝试在记事本中创建文件，如 .c（不是 .cpp），然后添加到您的项目文件.c（项目...添加到项目...文件）

对不起，我是墨西哥人，我不会说英语。萨卢多斯。

# ruby-on-rails - 为 Rails 模型定义外键关系

> ID：904421
> 
> 赞同：59
> 
> 时间：2009-05-24T18:50:45.053
> 
> 标签：ruby-on-rails, foreign-keys

我在 Post 类中有一个带有 post_id 的 :foreign_key 的 Comment 类。

```
class Comment < ActiveRecord::Base
  belongs_to :post, :class_name => "Post", :foreign_key => "post_id", :counter_cache => true
  belongs_to :author, :class_name => "User", :foreign_key => "author_id"
end 
```

**但是我的 CreateComments 迁移没有定义数据库级外键：**

```
class CreateComments < ActiveRecord::Migration
  def self.up
    create_table :comments do |t|
      t.column "post_id",       :integer,   :default => 0, :null => false
      t.column "author",        :string,    :default => "",   :limit => 25, :null => false
      t.column "author_email",  :string,    :default => "",   :limit => 50, :null => false
      t.column "content",       :text,      :null => false
      t.column "status",        :string,    :default => "",   :limit => 25, :null => false
      t.timestamps
    end
  end

  def self.down
    drop_table :comments
  end
end 
```

相反 post_id 是一个简单的整数列。

**因此，似乎这种外键关系只存在于 Rails 的脑海中，而不存在于数据库级别。**

它是否正确？

**此外，相应的 Post 模型是否也需要使用 :foreign_key 属性声明其与 Comments 的互惠外键关系，还是可以省略？**

```
class Post < ActiveRecord::Base
  set_table_name("blog_posts")
  belongs_to :author, :class_name => "User", :foreign_key => 'author_id'
  has_many :comments, :class_name => "Comment",
    :foreign_key => 'post_id', :order => "created_at desc", :dependent => :destroy
  has_many :categorizations
  has_many :categories, :through => :categorizations
  named_scope :recent, :order => "created_at desc", :limit => 5

end 
```

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-24T19:07:32.490

Rails 的默认行为是，用于保存模型外键的列是添加了后缀的关联名称`_id`。该`:foreign_key`选项允许您直接设置外键的名称。`Post`您和模型类之间的关联`Comment`应该如下所示：

```
class Post < ActiveRecord::Base
  has_many :comments
end

class Comment < ActiveRecord::Base
  belongs_to :post
end 
```

`:class_name => "Post"`—请注意，您的`Comment`模型中不需要。Rails 已经有了这些信息。您应该只在需要覆盖 Rails 的约定时指定`:class_name`和。`:foreign_key`

Rails 为您维护外键关系是正确的。如果需要，可以通过添加外键约束在数据库层强制执行它们。

*   我认为您会从阅读[A Guide to ActiveRecord Associations](http://guides.rubyonrails.org/association_basics.html)中受益。

# c++ - 在 write() 写入的字节数少于请求的字节数后，如何让线程继续？

> ID：904422
> 
> 赞同：1
> 
> 时间：2009-05-24T18:51:24.160
> 
> 标签：c++, c, multithreading, named-pipes

我正在使用以下代码通过命名管道将数据从一个应用程序写入另一个应用程序。永远不要退出写入发生的线程。但是，如果 r_write() 返回的值少于应有的值，则线程/程序会因某种原因停止。一旦 write 返回的返回值少于应有的值，如何使线程继续？

```
ssize_t r_write(int fd, char *buf, size_t size) 
{
   char *bufp;
   size_t bytestowrite;
   ssize_t byteswritten;
   size_t totalbytes;

   for (bufp = buf, bytestowrite = size, totalbytes = 0;
        bytestowrite > 0;
        bufp += byteswritten, bytestowrite -= byteswritten) {
      byteswritten = write(fd, bufp, bytestowrite);
      if ((byteswritten) == -1 && (errno != EINTR))
         return -1;
      if (byteswritten == -1)
         byteswritten = 0;
      totalbytes += byteswritten;
   }
   return totalbytes;
}

void* sendData(void *thread_arg)
{
    int fd, ret_val, count, numread;
    string word;
    char bufpipe[5];

    ret_val = mkfifo(pipe, 0777); //make the sprout pipe

    if (( ret_val == -1) && (errno != EEXIST)) 
    {
        perror("Error creating named pipe");
        exit(1);
    }   
    while(1)
    {
        if(!sproutFeed.empty())
        {       
            string s;
            s.clear();
            s = sproutFeed.front();

            int sizeOfData = s.length();
            snprintf(bufpipe, 5, "%04d", sizeOfData);

            char stringToSend[strlen(bufpipe) + sizeOfData +1];
            bzero(stringToSend, sizeof(stringToSend));                  
            strncpy(stringToSend,bufpipe, strlen(bufpipe));         
            strncat(stringToSend,s.c_str(),strlen(s.c_str()));
            strncat(stringToSend, "\0", strlen("\0"));                  
            int fullSize = strlen(stringToSend);
            cout << "sending string" << stringToSend << endl;
            fd = open(pipe,O_WRONLY);
            int numWrite = r_write(fd, stringToSend, strlen(stringToSend) );
            if(numWrite != fullSize)
            {
                bzero(bufpipe, strlen(bufpipe));
                bzero(stringToSend, strlen(stringToSend));
                cout << "NOT FULL SIZE WRITE " << endl; //program ends here??
            }
            else
            {
                    sproutFeed.pop();
                    bzero(bufpipe, strlen(bufpipe));
                    bzero(stringToSend, strlen(stringToSend));
            }                   
        }
        else
        {
            sleep(1);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T20:00:14.647

如果`write()`返回写入字节数的正（非零、非负）值，则表示成功，但没有空间容纳所有数据。再试一次，从缓冲区写入剩余的数据（并根据需要重复）。不要忘记，FIFO 的容量是有限的——如果有必要，写入器会被阻止。

如果`write()`返回负值，则写入失败。您可能无法恢复，但请检查`errno`原因。

我认为唯一`write()`可以返回零的情况是，如果您打开文件描述符`O_NONBLOCK`并且尝试写入会阻塞。您可能需要仔细检查手册页`write()`以检查任何其他可能性。

然后，您的线程会做什么取决于它为什么会经历短写，以及您想对此做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T19:35:21.797

写入 FIFO 失败。调查价值`errno`以找出原因。查看`errno.h`您的系统以破译 errno 的值。如果程序在尝试写入控制台时结束，则原因可能是相关的。

此外，您的循环似乎没有关闭 FIFO ( `close(fd)`) 的文件描述符。

最后，您提到了多线程。您系统上的标准库流`cout`可能不是（也可能不是）线程安全的。在这种情况下，从多个线程同时写入控制台会导致不可预知的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T19:59:27.503

您需要使文件描述符非阻塞。你可以这样做：

```
fcntl(fd, F_SETFL, fcntl(fd, F_GETFL) | O_NONBLOCK); 
```

* * *

# 解释

这就是`fcntl`工作原理（不是完整的描述 - 看看`man fcntl`那个）。首先，包括：

```
#include <unistd.h>
#include <fcntl.h> 
```

## 读取文件描述符的标志

用于`F_GETFL`获取文件描述符的标志。来自`man fcntl`：

```
       F_GETFL
              读取文件描述符的标志。

返回值
       对于成功的调用，返回值取决于操作：

       F_GETFL 标志值。

```

这就是它的使用方式：

```
int fd_flags = fcntl(fd, F_GETFL); 
```

## 写入文件描述符的标志

用于`F_SETFL`设置`O_NONBLOCK`标志。再次引用`man fcntl`：

```
       F_SETFL
              将描述符标志的文件状态标志部分设置为
              由 arg 指定的值。剩余位（访问模式、文件 cre?
              arg 中的标志）被忽略。在 Linux 上，这个命令可以
              仅更改 O_APPEND、O_NONBLOCK、O_ASYNC 和 O_DIRECT
              标志。

```

这就是它的使用方式：

```
fcntl(fd, F_SETFL, fd_flags | O_NONBLOCK); 
```

# web - 使现有网站适合移动设备

> ID：904435
> 
> 赞同：4
> 
> 时间：2009-05-24T18:58:44.320
> 
> 标签：web, mobile

因此，我计划使现有网站对移动设备友好。好的部分是它完全基于文本，带有一些图像，可能会从网站的移动版本中省略。

不好的部分是它是一个非常复杂的网站，有大量页面（每个页面都可能根据数据和访问网站的用户而有所不同）其中很多也是遗留代码（如旧的 html，它没有证实）

所以我想知道制作移动友好网站的最佳策略应该是什么？创建并行版本是不可能的，因为那将是一项*艰巨*的任务

一个单独的 CSS 是显而易见的。但是，为移动设备设计以确保网站可用且看起来不错的最佳实践/指南呢？

作为参考，后端在 PHP + MySql 中，前端在 htmls + CSS 和一些 JS 中（JS 是可降解的）

编辑：为了更清楚，我想在设计方面提出建议。为移动设备设计的良好实践是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T12:26:52.777

为移动设备设计的一些快速提示：

*   只能垂直滚动，不能水平滚动。
*   使链接足够大，以便用手指轻松按下（如果它是触摸屏设备）。
*   保持页面较小（最好小于 20KB）- 包括任何图像或 css 文件
*   接受某些设备会以不同方式呈现某些元素
*   确保你的 XHTML 是有效的
*   选择即使在明亮的日光下也能工作的配色方案
*   仅包含相关内容 - 充分利用有限的屏幕空间
*   尽量避免复杂的导航
*   不要在 CSS 中使用绝对大小
*   使用最少的 CSS 和 Javascript - 使用时彻底测试
*   利用电话的一部分功能（点击通话等）
*   动员起来，不要只是最小化
*   尽可能避免用户输入（从下拉列表中选择比输入文本更可取 - 如果可能）
*   测试，测试，测试！（首先是模拟器，然后借用你的朋友和同事的手机来进行各种测试）
*   为短时间的用户交互而设计 - 使人们可以快速轻松地完成任务。
*   保持一致 - 遵循设计指南和事实上的标准
*   对链接使用 accesskeys

希望这些帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T19:14:53.117

**iPhone特定答案：**

对于 iPhone，我会选择不优化。iPhone 版 Safari 非常有能力按原样显示网页。检查[这个答案](https://stackoverflow.com/questions/821142/how-to-convert-website-for-iphone-ipod/821174#821174)，以及有关 iPhone 优化的更多[问题](https://stackoverflow.com/questions/821142/how-to-convert-website-for-iphone-ipod)。

**一般回答：**

我同意 mr-euro 的技术优化。设计明智，您必须**考虑小分辨率**（如 320x240）。我会留下下拉菜单或任何花哨的javascripting。**大多数移动设备都不太擅长处理脚本，而且往往会变得迟钝**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T19:07:12.740

如果您设法将站点转换为经过 W3 验证的 XHTML 1.1，那么它将在手机浏览器中正确呈现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T19:19:02.453

您可以尝试设置另一台服务器，将来自移动浏览器的请求代理到真实服务器，并将它们提供给诸如 之类的程序`tidy`，该程序可以从非常丑陋的 HTML 构建有效的 (X)HTML。这可以让您以一定的处理成本完全不改变使用现有服务。

你可以在这里找到一个[小的 ruby​​ 示例](http://snippets.dzone.com/posts/show/6349)（它使用本地代理）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T07:37:08.537

我认为你必须在这里更具体。普通手机的移动浏览器真的很原始。如果你瞄准他们，你必须确保没有什么“硬”。该页面基本上应该只是带有全角图像的短文本。

如果你的目标是 iPhone/任何触摸，你只需要杀死 flash/java、悬停和其他你很可能根本没有的不可触摸的东西。Mobile Safari 就像他的老大哥，你真的不需要任何特定的东西。

对于黑莓和其他东西，我不确定，但请查看[wsj 移动网站](http://m.wsj.com/device/index.php)作为示例。

# ruby-on-rails - 使用 Apache 和 capistrano 进行 Rails 页面缓存

> ID：904438
> 
> 赞同：0
> 
> 时间：2009-05-24T19:00:03.380
> 
> 标签：ruby-on-rails, apache, mod-rewrite, nginx

以下文章解释了使用 Nginx 在 Rails 中缓存页面。

[http://blog.hasmanythrough.com/2008/1/30/segregated-page-cache-storage](http://blog.hasmanythrough.com/2008/1/30/segregated-page-cache-storage)

我喜欢用我的应用程序但在 Apache 上实现这个解决方案。所以，主要的街区/路线是

```
  if (-f $request_filename) {
    休息;
  }
    if (-f /cache$request_filename) {
    重写 (.*) /cache$1 中断；
    休息;
  }

  if (-f /cache$request_filename.html) {
    重写 (.*) /cache$1.html 中断；
    休息;
  }

```

上述 Nginx 相关代码的 Apache 等价物可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-07T08:18:27.967

这就是我正在使用的：

```
RewriteEngine On
RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
RewriteRule ^/$ /cache/index.html [QSA]
RewriteRule ^([^.]+)$ /cache$1.html [QSA] 
```

第二行在进行重定向之前检查缓存文件是否存在，否则它将让请求通过 Rails。

# c# - 我可以拦截通过 HTTP 上传到 IIS7 的文件并根据验证条件拒绝上传吗？

> ID：904439
> 
> 赞同：2
> 
> 时间：2009-05-24T19:00:12.490
> 
> 标签：c#, .net, validation, post, file-upload

我有一个表格，您可以将文件发布到我的服务器上。

有没有办法在不使用自定义 HTTP 处理程序的情况下拦截帖子的开头并在文件上传和带宽用完之前阻止它。

例如，我可以检查一个 IP 地址，如果它在我的系统中被阻止，我可以在浪费 10MB 的上传之前停止请求。

谢谢！

编辑：

我正在使用 ASP.NET MVC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:23:37.573

这确实是 HttpModule 的工作，而不是 HttpHandler。只需根据 BeginRequest 事件中的黑名单检查远程 IP 和空路由或你有什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:19:40.657

据我所知，这对于股票 .NET 代码是不可能的，除非您花时间重新创建文件处理和解析 ASP.NET 所做的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-24T19:08:45.250

在 ASP.Net 2.0 中，添加了一个新的[FileUpload 控件](http://www.c-sharpcorner.com/UploadFile/mahesh/FileUpload10092005172118PM/FileUpload.aspx?ArticleID=79850d6d-0e91-4d7b-9e27-a64a09b0ee6b)，可用于限制文件类型和大小等。

# javascript - String.stipTags() 是否足以缓解 XSS 攻击？

> ID：904442
> 
> 赞同：2
> 
> 时间：2009-05-24T19:03:06.463
> 
> 标签：javascript, xss

我正在创建这个 UTF-8 编码的 HTML 页面，用户可以在其中提供输入。我想做这个 XSS 证明。我遇到了一个名为 Prototype 的免费 Javascript 框架，它提供了一些有用的功能。一个特定的函数 stripTags 实质上是从输入字符串中剥离所有标签。以下输入处理会阻止 XSS 吗？

1.  对输入执行彻底的 UTF-8 解码（考虑所有可能的 UTF-8 表示）
2.  将 HTML 字符实体转换为字符
3.  在解码、转换后的字符串上运行 stripTags 以删除所有可能的标签

Javascript 中对 antiXSS 尝试的常见评论之一是用户可以绕过系统。这怎么可能？就我而言，使用该系统的用户是值得信赖的。但是，之前可能使用过同一台机器的其他用户可能是恶意的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T20:15:50.630

你只需要改变：

*   `&`至`&amp;`
*   `<`至`&lt;`
*   `"`to `&quot;`（如果您在属性中使用单引号，也`'`to `&#39;`）

如果您已经转义了特殊的 HTML 字符，那么其中就没有标签，并且条形标签不会做任何事情。

如果您使用条形标签*而不是*转义，那么外部输入将能够转义 HTML 属性，例如：

```
<input value="$foo"> 
```

如果`$foo`是：

```
" src="404" onerror="evil() 
```

如果您想在 JavaScript（内部`<script>`）中插入不受信任的内容，则适用其他规则：

*   未在 中解释的 HTML 实体`<script>`，因此不要在此处使用它们进行转义。
*   使用 JavaScript 字符串转义规则（`\`→ `\\`，`"`→ `\"`）*并*替换所有出现的`</`with `<\/`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-08T09:07:32.560

如果 javascript 框架在提供输入的机器上运行，那么这是不安全的（您将信任来自潜在恶意客户端的内容。

如果您在显示数据之前在客户端计算机上运行它，这将取决于您的代码中还有哪些其他漏洞。

一个好的经验法则是，安全约束通常应用在服务器端，用户不能简单地绕过它们。据我记得，PHP 有一个带标签功能，并且在 Apaches StringEscapeUtils for java 中也有类似的功能。我确信.net中有类似的东西

# iphone - 如何编写与 iPhone 同步的桌面应用程序？

> ID：904443
> 
> 赞同：6
> 
> 时间：2009-05-24T19:04:05.180
> 
> 标签：iphone, language-agnostic, synchronization

例如，我将如何编写像[senuti](http://www.fadingred.com/senuti/)这样的程序？有没有我可以使用的库？如果我可以在 Python 或 .Net 中做到这一点，那将是理想的，但我也对其他事情持开放态度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T20:32:31.850

您可以做三件事：

1.  将一些代码添加到充当某种服务器（http、SMB 等）的 iPhone 应用程序中。然后您的 mac/windows 完整客户端应用程序可以通过 wifi 连接到此服务器。这是安全可靠的，但不幸的是，该应用程序必须在同步时在 iPhone 上运行。

2.  同步到“云”。EG：让您的 iPhone 应用程序将一些数据保存到 Internet 上的 Web 服务器（您可以使用亚马逊 EC2、Windows Azure，甚至只是在廉价托管帐户上运行的 PHP 脚本），然后让您的 Windows/Mac 客户端也连接到此 Web 服务器以检索数据。这个是最人性化的，但是需要你为web服务器的托管付费，不适合大数据量

3.  违反 EULA 并尝试对 iTunes 与 iPhone 通信的方式进行逆向工程。这就是 senuti 的工作方式，但我不建议这样做，因为他们必须不断追赶苹果，改变他们下面的格式，如果苹果愿意起诉他们，他们可能会面临某种法律诉讼.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T21:49:52.740

我相信 3.0 版会解决这个问题，因为它允许您将应用程序编程到 USB 接口。查看外部附件框架中的一些文档。

它仍然需要打开应用程序，因此本质上意味着两个同步（如果您有多个应用程序则更多）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T20:22:36.583

没有合法/官方的方式来做到这一点。创建与 iPhone 同步的程序会违反您在使用 iPhone 和 iTunes 时同意的 EULA。

它不仅是非法的，而且也不可能可靠地做到这一点。苹果可以随时在没有任何通知的情况下破坏这种方法，这几乎是一场猫捉老鼠的游戏。

我只知道一个应用程序是这样的，它是同步铃声的 iToner 应用程序。

# jquery - 可重用的 JQuery 模态对话框？

> ID：904447
> 
> 赞同：0
> 
> 时间：2009-05-24T19:04:55.257
> 
> 标签：jquery, jquery-ui

在过去的 6 个月里，我一直在使用 jquery。

我有一个表单，我想替换 20 个不同的 javascript alert(""); 带有 jQ​​uery 模态对话框的语句。

我不想为每条不同的消息创建一个单独的对话框 div 部分。

有没有办法使用基本 jquery-ui 创建一个可重用的模式对话框，我可以在其中传递消息标题和消息文本？

让我知道您是否有任何想法？

德里克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-09-20T15:34:36.783

是的，您可以创建可重用的对话框，并且可以动态传递消息。

1.  创建对话框类

    ```
    function OkDialog() {

       this.showMessage = function(message) {

        var $dialog = $('<div></div>')

          .html(message)

          .dialog({

             modal: true,

             closeOnEscape: true,

             buttons: {

                Ok: function() {

                   $(this).dialog("close");

              }

            }

       });

          $dialog.dialog("open");

       }

    } 
    ```

2.  在一个公共文件（jsp）中创建一个全局对象。

    ```
    OK_DIALOG = new OkDialog(); 
    ```

3.  使用所需消息调用此函数。

    ```
    OK_DIALOG.showMessage("You don't have more than a single penny."); 
    ```

任务完成！！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T19:21:39.653

您可以找到很多用于对话框的 jQuery 插件。

我过去使用过[facebox插件](https://github.com/defunkt/facebox "脸书插件")。

基本用法可以很简单：

```
jQuery.facebox('something cool') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T19:44:38.407

我强烈推荐[Impromptu](http://trentrichardson.com/Impromptu/index.php)。它有很好的文档，有很好的例子，基本上是 javascript Alert 和 Input 的替代品，但是它非常可扩展，并且有大量的选项和额外的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T19:38:01.087

我会推荐 jQuery 的 Growl 插件。 [http://plugins.jquery.com/project/Growl](http://plugins.jquery.com/project/Growl)

使用 Growl 的好处是它具有一些非常好的内置功能，特别是具有自动删除功能的可选功能。

它是非模态的。

我的意思是，它不需要用户在返回与站点交互之前与之交互，从而维护网站的工作流程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-03T16:12:32.077

我过去经常使用 Facebox，但我正在逐步淘汰它，转而使用 jQuery 的 UI 集合中的对话框：

[http://docs.jquery.com/UI/Dialog](http://docs.jquery.com/UI/Dialog)

你提到了核心jquery-ui，这不是诀窍吗？

# c# - 如何在 XNA 中减慢或停止按键

> ID：904454
> 
> 赞同：22
> 
> 时间：2009-05-24T19:07:54.487
> 
> 标签：c#, xna

我已经开始使用 XNA Framework 编写游戏并且遇到了一些我不知道如何正确解决的简单问题。

我正在使用 Texture2D 显示菜单，并使用键盘（或游戏手柄）更改所选的菜单项。我的问题是当前用于在菜单项之间切换的功能太快了。我可能会单击向下按钮，它会下降 5 或 6 个菜单项（由于 Update() 被多次调用，从而更新所选项目）。

```
ex.
(> indicate selected)
> MenuItem1
MenuItem2
MenuItem3
MenuItem4
MenuItem5

I press the down key for just a second), then I have this state:

MenuItem1
MenuItem2
MenuItem3
> MenuItem4
MenuItem5

What I want is (until I press the key again)
MenuItem1
> MenuItem2
MenuItem3
MenuItem4
MenuItem5 
```

我正在寻找的是一种让玩家多次单击向上/向下键以便从一个菜单项转到另一个菜单项的方法，或者在进入下一个菜单项之前有某种最短等待时间。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-04T00:51:09.413

实现这一点的最佳方法是从刚刚传递的更新语句中缓存键盘/游戏手柄状态。

```
KeyboardState oldState;
...

var newState = Keyboard.GetState();

if (newState.IsKeyDown(Keys.Down) && !oldState.IsKeyDown(Keys.Down))
{
    // the player just pressed down
}
else if (newState.IsKeyDown(Keys.Down) && oldState.IsKeyDown(Keys.Down))
{
    // the player is holding the key down
}
else if (!newState.IsKeyDown(Keys.Down) && oldState.IsKeyDown(Keys.Down))
{
    // the player was holding the key down, but has just let it go
}

oldState = newState; 
```

在您的情况下，您可能只想在上面的第一种情况下，当刚刚按下键时“向下”移动。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-04T07:00:25.383

我已经建立了一个（大）类，它对任何和所有 XNA 输入相关的任务都有很大帮助，它使你所要求的变得容易。

```
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Input;

namespace YourNamespaceHere
{
    /// <summary>
    /// an enum of all available mouse buttons.
    /// </summary>
    public enum MouseButtons
    {
        LeftButton,
        MiddleButton,
        RightButton,
        ExtraButton1,
        ExtraButton2
    }

    public class InputHelper
    {
        private GamePadState _lastGamepadState;
        private GamePadState _currentGamepadState;
#if (!XBOX)
        private KeyboardState _lastKeyboardState;
        private KeyboardState _currentKeyboardState;
        private MouseState _lastMouseState;
        private MouseState _currentMouseState;
#endif
        private PlayerIndex _index = PlayerIndex.One;
        private bool refreshData = false;

        /// <summary>
        /// Fetches the latest input states.
        /// </summary>
        public void Update()
        {
            if (!refreshData)
                refreshData = true;
            if (_lastGamepadState == null && _currentGamepadState == null)
            {
                _lastGamepadState = _currentGamepadState = GamePad.GetState(_index);
            }
            else
            {
                _lastGamepadState = _currentGamepadState;
                _currentGamepadState = GamePad.GetState(_index);
            }
#if (!XBOX)
            if (_lastKeyboardState == null && _currentKeyboardState == null)
            {
                _lastKeyboardState = _currentKeyboardState = Keyboard.GetState();
            }
            else
            {
                _lastKeyboardState = _currentKeyboardState;
                _currentKeyboardState = Keyboard.GetState();
            }
            if (_lastMouseState == null && _currentMouseState == null)
            {
                _lastMouseState = _currentMouseState = Mouse.GetState();
            }
            else
            {
                _lastMouseState = _currentMouseState;
                _currentMouseState = Mouse.GetState();
            }
#endif
        }

        /// <summary>
        /// The previous state of the gamepad. 
        /// Exposed only for convenience.
        /// </summary>
        public GamePadState LastGamepadState
        {
            get { return _lastGamepadState; }
        }
        /// <summary>
        /// the current state of the gamepad.
        /// Exposed only for convenience.
        /// </summary>
        public GamePadState CurrentGamepadState
        {
            get { return _currentGamepadState; }
        }
        /// <summary>
        /// the index that is used to poll the gamepad. 
        /// </summary>
        public PlayerIndex Index
        {
            get { return _index; }
            set { 
                _index = value;
                if (refreshData)
                {
                    Update();
                    Update();
                }
            }
        }
#if (!XBOX)
        /// <summary>
        /// The previous keyboard state.
        /// Exposed only for convenience.
        /// </summary>
        public KeyboardState LastKeyboardState
        {
            get { return _lastKeyboardState; }
        }
        /// <summary>
        /// The current state of the keyboard.
        /// Exposed only for convenience.
        /// </summary>
        public KeyboardState CurrentKeyboardState
        {
            get { return _currentKeyboardState; }
        }
        /// <summary>
        /// The previous mouse state.
        /// Exposed only for convenience.
        /// </summary>
        public MouseState LastMouseState
        {
            get { return _lastMouseState; }
        }
        /// <summary>
        /// The current state of the mouse.
        /// Exposed only for convenience.
        /// </summary>
        public MouseState CurrentMouseState
        {
            get { return _currentMouseState; }
        }
#endif
        /// <summary>
        /// The current position of the left stick. 
        /// Y is automatically reversed for you.
        /// </summary>
        public Vector2 LeftStickPosition
        {
            get 
            { 
                return new Vector2(
                    _currentGamepadState.ThumbSticks.Left.X, 
                    -CurrentGamepadState.ThumbSticks.Left.Y); 
            }
        }
        /// <summary>
        /// The current position of the right stick.
        /// Y is automatically reversed for you.
        /// </summary>
        public Vector2 RightStickPosition
        {
            get 
            { 
                return new Vector2(
                    _currentGamepadState.ThumbSticks.Right.X, 
                    -_currentGamepadState.ThumbSticks.Right.Y); 
            }
        }
        /// <summary>
        /// The current velocity of the left stick.
        /// Y is automatically reversed for you.
        /// expressed as: 
        /// current stick position - last stick position.
        /// </summary>
        public Vector2 LeftStickVelocity
        {
            get 
            {
                Vector2 temp =
                    _currentGamepadState.ThumbSticks.Left - 
                    _lastGamepadState.ThumbSticks.Left;
                return new Vector2(temp.X, -temp.Y); 
            }
        }
        /// <summary>
        /// The current velocity of the right stick.
        /// Y is automatically reversed for you.
        /// expressed as: 
        /// current stick position - last stick position.
        /// </summary>
        public Vector2 RightStickVelocity
        {
            get
            {
                Vector2 temp =
                    _currentGamepadState.ThumbSticks.Right -
                    _lastGamepadState.ThumbSticks.Right;
                return new Vector2(temp.X, -temp.Y);
            }
        }
        /// <summary>
        /// the current position of the left trigger.
        /// </summary>
        public float LeftTriggerPosition
        {
            get { return _currentGamepadState.Triggers.Left; }
        }
        /// <summary>
        /// the current position of the right trigger.
        /// </summary>
        public float RightTriggerPosition
        {
            get { return _currentGamepadState.Triggers.Right; }
        }
        /// <summary>
        /// the velocity of the left trigger.
        /// expressed as: 
        /// current trigger position - last trigger position.
        /// </summary>
        public float LeftTriggerVelocity
        {
            get 
            { 
                return 
                    _currentGamepadState.Triggers.Left - 
                    _lastGamepadState.Triggers.Left; 
            }
        }
        /// <summary>
        /// the velocity of the right trigger.
        /// expressed as: 
        /// current trigger position - last trigger position.
        /// </summary>
        public float RightTriggerVelocity
        {
            get 
            { 
                return _currentGamepadState.Triggers.Right - 
                    _lastGamepadState.Triggers.Right; 
            }
        }
#if (!XBOX)
        /// <summary>
        /// the current mouse position.
        /// </summary>
        public Vector2 MousePosition
        {
            get { return new Vector2(_currentMouseState.X, _currentMouseState.Y); }
        }
        /// <summary>
        /// the current mouse velocity.
        /// Expressed as: 
        /// current mouse position - last mouse position.
        /// </summary>
        public Vector2 MouseVelocity
        {
            get
            {
                return (
                    new Vector2(_currentMouseState.X, _currentMouseState.Y) - 
                    new Vector2(_lastMouseState.X, _lastMouseState.Y)
                    );
            }
        }
        /// <summary>
        /// the current mouse scroll wheel position.
        /// See the Mouse's ScrollWheel property for details.
        /// </summary>
        public float MouseScrollWheelPosition
        {
            get 
            {
                return _currentMouseState.ScrollWheelValue;
            }
        }
        /// <summary>
        /// the mouse scroll wheel velocity.
        /// Expressed as:
        /// current scroll wheel position - 
        /// the last scroll wheel position.
        /// </summary>
        public float MouseScrollWheelVelocity
        {
            get 
            {
                return (_currentMouseState.ScrollWheelValue - _lastMouseState.ScrollWheelValue);
            }
        }
#endif
        /// <summary>
        /// Used for debug purposes.
        /// Indicates if the user wants to exit immediately.
        /// </summary>
        public bool ExitRequested
        {
#if (!XBOX)
            get
            {
                return (
                    (IsCurPress(Buttons.Start) && 
                    IsCurPress(Buttons.Back)) ||
                    IsCurPress(Keys.Escape));
            }
#else
            get { return (IsCurPress(Buttons.Start) && IsCurPress(Buttons.Back)); }
#endif
        }
        /// <summary>
        /// Checks if the requested button is a new press.
        /// </summary>
        /// <param name="button">
        /// The button to check.
        /// </param>
        /// <returns>
        /// a bool indicating whether the selected button is being 
        /// pressed in the current state but not the last state.
        /// </returns>
        public bool IsNewPress(Buttons button)
        {
            return (
                _lastGamepadState.IsButtonUp(button) && 
                _currentGamepadState.IsButtonDown(button));
        }
        /// <summary>
        /// Checks if the requested button is a current press.
        /// </summary>
        /// <param name="button">
        /// the button to check.
        /// </param>
        /// <returns>
        /// a bool indicating whether the selected button is being 
        /// pressed in the current state and in the last state.
        /// </returns>
        public bool IsCurPress(Buttons button)
        {
            return (
                _lastGamepadState.IsButtonDown(button) && 
                _currentGamepadState.IsButtonDown(button));
        }
        /// <summary>
        /// Checks if the requested button is an old press.
        /// </summary>
        /// <param name="button">
        /// the button to check.
        /// </param>
        /// <returns>
        /// a bool indicating whether the selected button is not being
        /// pressed in the current state and is being pressed in the last state.
        /// </returns>
        public bool IsOldPress(Buttons button)
        {
            return (
                _lastGamepadState.IsButtonDown(button) && 
                _currentGamepadState.IsButtonUp(button));
        }
#if (!XBOX)
        /// <summary>
        /// Checks if the requested key is a new press.
        /// </summary>
        /// <param name="key">
        /// the key to check.
        /// </param>
        /// <returns>
        /// a bool that indicates whether the selected key is being 
        /// pressed in the current state and not in the last state.
        /// </returns>
        public bool IsNewPress(Keys key)
        {
            return (
                _lastKeyboardState.IsKeyUp(key) && 
                _currentKeyboardState.IsKeyDown(key));
        }
        /// <summary>
        /// Checks if the requested key is a current press.
        /// </summary>
        /// <param name="key">
        /// the key to check.
        /// </param>
        /// <returns>
        /// a bool that indicates whether the selected key is being 
        /// pressed in the current state and in the last state.
        /// </returns>
        public bool IsCurPress(Keys key)
        {
            return (
                _lastKeyboardState.IsKeyDown(key) &&
                _currentKeyboardState.IsKeyDown(key));
        }
        /// <summary>
        /// Checks if the requested button is an old press.
        /// </summary>
        /// <param name="key">
        /// the key to check.
        /// </param>
        /// <returns>
        /// a bool indicating whether the selectde button is not being
        /// pressed in the current state and being pressed in the last state.
        /// </returns>
        public bool IsOldPress(Keys key)
        {
            return (
                _lastKeyboardState.IsKeyDown(key) && 
                _currentKeyboardState.IsKeyUp(key));
        }
        /// <summary>
        /// Checks if the requested mosue button is a new press.
        /// </summary>
        /// <param name="button">
        /// teh mouse button to check.
        /// </param>
        /// <returns>
        /// a bool indicating whether the selected mouse button is being
        /// pressed in the current state but not in the last state.
        /// </returns>
        public bool IsNewPress(MouseButtons button)
        {
            switch (button)
            {
                case MouseButtons.LeftButton:
                    return (
                        _lastMouseState.LeftButton == ButtonState.Released &&
                        _currentMouseState.LeftButton == ButtonState.Pressed);
                case MouseButtons.MiddleButton:
                    return (
                        _lastMouseState.MiddleButton == ButtonState.Released &&
                        _currentMouseState.MiddleButton == ButtonState.Pressed);
                case MouseButtons.RightButton:
                    return (
                        _lastMouseState.RightButton == ButtonState.Released &&
                        _currentMouseState.RightButton == ButtonState.Pressed);
                case MouseButtons.ExtraButton1:
                    return (
                        _lastMouseState.XButton1 == ButtonState.Released &&
                        _currentMouseState.XButton1 == ButtonState.Pressed);
                case MouseButtons.ExtraButton2:
                    return (
                        _lastMouseState.XButton2 == ButtonState.Released &&
                        _currentMouseState.XButton2 == ButtonState.Pressed);
                default:
                    return false;
            }
        }
        /// <summary>
        /// Checks if the requested mosue button is a current press.
        /// </summary>
        /// <param name="button">
        /// the mouse button to be checked.
        /// </param>
        /// <returns>
        /// a bool indicating whether the selected mouse button is being 
        /// pressed in the current state and in the last state.
        /// </returns>
        public bool IsCurPress(MouseButtons button)
        {
            switch (button)
            {
                case MouseButtons.LeftButton:
                    return (
                        _lastMouseState.LeftButton == ButtonState.Pressed &&
                        _currentMouseState.LeftButton == ButtonState.Pressed);
                case MouseButtons.MiddleButton:
                    return (
                        _lastMouseState.MiddleButton == ButtonState.Pressed &&
                        _currentMouseState.MiddleButton == ButtonState.Pressed);
                case MouseButtons.RightButton:
                    return (
                        _lastMouseState.RightButton == ButtonState.Pressed &&
                        _currentMouseState.RightButton == ButtonState.Pressed);
                case MouseButtons.ExtraButton1:
                    return (
                        _lastMouseState.XButton1 == ButtonState.Pressed &&
                        _currentMouseState.XButton1 == ButtonState.Pressed);
                case MouseButtons.ExtraButton2:
                    return (
                        _lastMouseState.XButton2 == ButtonState.Pressed &&
                        _currentMouseState.XButton2 == ButtonState.Pressed);
                default:
                    return false;
            }
        }
        /// <summary>
        /// Checks if the requested mosue button is an old press.
        /// </summary>
        /// <param name="button">
        /// the mouse button to check.
        /// </param>
        /// <returns>
        /// a bool indicating whether the selected mouse button is not being 
        /// pressed in the current state and is being pressed in the old state.
        /// </returns>
        public bool IsOldPress(MouseButtons button)
        {
            switch (button)
            {
                case MouseButtons.LeftButton:
                    return (
                        _lastMouseState.LeftButton == ButtonState.Pressed &&
                        _currentMouseState.LeftButton == ButtonState.Released);
                case MouseButtons.MiddleButton:
                    return (
                        _lastMouseState.MiddleButton == ButtonState.Pressed &&
                        _currentMouseState.MiddleButton == ButtonState.Released);
                case MouseButtons.RightButton:
                    return (
                        _lastMouseState.RightButton == ButtonState.Pressed &&
                        _currentMouseState.RightButton == ButtonState.Released);
                case MouseButtons.ExtraButton1:
                    return (
                        _lastMouseState.XButton1 == ButtonState.Pressed &&
                        _currentMouseState.XButton1 == ButtonState.Released);
                case MouseButtons.ExtraButton2:
                    return (
                        _lastMouseState.XButton2 == ButtonState.Pressed &&
                        _currentMouseState.XButton2 == ButtonState.Released);
                default:
                    return false;
            }
        }
#endif
    }
} 
```

只需将它复制到一个单独的类文件中并将其移动到您的命名空间，然后声明一个（inputHelper 变量），在初始化部分初始化它，并在更新逻辑之前在更新循环中调用 inputHelper.Update()。然后，每当您需要与输入相关的内容时，只需使用 InputHelper！例如，在您的情况下，您将使用 InputHelper.IsNewPress([type of input button/key here]) 来检查是否要向下或向上移动菜单项。对于此示例： inputHelper.IsNewPress(Keys.Down)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-26T12:02:31.293

处理这种事情的一个好方法是为您感兴趣的每个键存储一个计数器，如果键关闭，则每帧递增，如果键启动，则重置为 0。

这样做的好处是您可以测试键的绝对状态（如果计数器非零，则键按下）并且还可以轻松检查它是否刚刚被按下此帧以获取菜单等（计数器是1）。加号键重复变得容易（计数器％重复延迟为零）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-04T01:06:03.673

如果您的应用程序是用于 Windows 机器的，我使用我在这里找到的这个事件驱动类取得了巨大的成功：[gamedev.net 论坛帖子](http://www.gamedev.net/community/forums/topic.asp?topic_id=457783&whichpage=1&#3042751)

它处理典型的按键和重复开始之前的短暂停顿，就像 Windows 应用程序中的正常文本输入一样。还包括鼠标移动/滚轮事件。

您可以订阅事件，例如，使用以下代码：

```
InputSystem.KeyDown += new KeyEventHandler(KeyDownFunction);
InputSystem.KeyUp += new KeyEventHandler(KeyUpFunction); 
```

然后在方法本身：

```
void KeyDownFunction(object sender, KeyEventArgs e)
{
   if(e.KeyCode == Keys.F)
      facepalm();
}

void KeyUpFunction(object sender, KeyEventArgs e)
{
   if(e.KeyCode == Keys.F)
      release();
} 
```

……等等。这真是一堂很棒的课。我发现它的灵活性比 XNA 的默认键盘处理有了很大的提高。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-12T12:15:17.773

我认为以前的答案有点过于复杂，所以我在这里给出这个......

将下面的 KeyPress 类复制到一个新文件中，声明 KeyPress 变量，在 Initialize() 方法中初始化它们。从那里你可以做`if ([yourkey].IsPressed()) ...`

**注意：**此答案仅适用于键盘输入，但应该可以轻松移植到游戏手柄或任何其他输入。我认为将不同类型输入的代码分开会更好。

```
public class KeyPress
{
    public KeyPress(Keys Key)
    {
        key = Key;
        isHeld = false;
    }

    public bool IsPressed { get { return isPressed(); } }

    public static void Update() { state = Keyboard.GetState(); }

    private Keys key;
    private bool isHeld;
    private static KeyboardState state;
    private bool isPressed()
    {
        if (state.IsKeyDown(key))
        {
            if (isHeld) return false;
            else
            {
                isHeld = true;
                return true;
            }
        }
        else
        {
            if (isHeld) isHeld = false;
            return false;
        }
    }
} 
```

**用法：**

```
// Declare variable
KeyPress escape;

// Initialize()
escape = new KeyPress(Keys.Escape)

// Update()
KeyPress.Update();
if (escape.IsPressed())
    ... 
```

我可能错了，但我认为我的答案在资源上比接受的答案更容易，而且更具可读性！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T19:47:17.467

您可以存储从最后一次按下的键（左，右...）开始的整数值时间，如果这个时间大于某个限制，您可以轮询按下的新键。但是，这只能针对菜单进行，因为在游戏中您会立即需要该信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T12:02:15.207

好的，我已经想通了。首先，我添加了一个

```
private Keys keyPressed = Keys.None; 
```

在我的 Update() 方法中，我执行以下操作：

```
 KeyboardState keyboardState = Keyboard.GetState();

if (keyboardState.IsKeyUp(keyPressed))
{
    keyPressed = Keys.None;
}

if (keyboardState.IsKeyDown(keyPressed))
{
    return;
}

// Some additionnal stuff is done according to direction
if (keyboardState.IsKeyDown(Keys.Up))
{
    keyPressed = Keys.Up;
}
else if (keyboardState.IsKeyDown(Keys.Down))
{
    keyPressed = Keys.Down;
} 
```

它似乎工作正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-25T12:08:32.917

您还可以做的是让自己成为一个结合了 KyeUp 和 KeyDown 的函数，它会告诉您何时按下了一次键，仅在更新的 1 个循环中，因此它仅在您每次再次按下该键时才起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T08:46:42.047

我保存了上次更新运行的 GamePadState 和 KeyboardState。在下一次更新运行时，我检查上次运行时未按下但现在按下的按钮。然后我保存当前状态。

我将所有这些都包含在一个静态类中，我可以使用它来查询特定按钮和/或获取自上次更新以来按下的按钮列表。这使得同时使用多个键变得非常容易（你在游戏中肯定想要的东西），并且可以很容易地扩展到和弦。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-19T20:06:34.370

拉涅利，那看起来像什么？我很难兼顾这些更新周期......

嗯...

```
public static bool CheckKeyPress(Keys key)
{
    return keyboardState.IsKeyUp(key) && lastKeyboardState.IsKeyDown(key);
} 
```

SetStates() 是私有的，它在 Update() 中调用

```
private static void SetStates()
{
    lastKeyboardState = keyboardState;

    keyboardState = Keyboard.GetState();
} 
```

这里是更新...

```
public sealed override void Update(GameTime gameTime)
{
    // Called to set the states of the input devices
    SetStates();
    base.Update(gameTime);
} 
```

我试过添加额外的检查..

```
if (Xin.CheckKeyPress(Keys.Enter) ||
    Xin.CheckButtonPress(Buttons.A))
{
    if (Xin.LastKeyboardState != Xin.KeyboardState ||
        Xin.LastGamePadState(PlayerIndex.One) != Xin.GamePadState(PlayerIndex.One))
    { 
```

似乎没有任何明显的影响 - 我似乎无法减慢菜单确认速度，

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-22T07:00:44.437

那么你可以做的是这样的（也会跟踪每个键）

```
int[] keyVals;
TimeSpan pressWait = new TimeSpan(0, 0, 1);
Dictionary<Keys, bool> keyDowns = new Dictionary<Keys, bool>();
Dictionary<Keys, DateTime> keyTimes = new Dictionary<Keys, DateTime>();

public ConstructorNameHere
{
    keyVals = Enum.GetValues(typeof(Keys)) as int[];
    foreach (int k in keyVals)
    {
        keyDowns.Add((Keys)k, false);
        keyTimes.Add((Keys)k, new DateTime()+ new TimeSpan(1,0,0));
    }
}

protected override void Update(GameTime gameTime)
{
    foreach (int i in keyVals)
    {
        Keys key = (Keys)i;
        switch (key)
        {
            case Keys.Enter:
                keyTimes[key] = (Keyboard.GetState().IsKeyUp(key)) ? ((keyDowns[key]) ? DateTime.Now + pressWait : keyTimes[key]) : keyTimes[key];
                keyDowns[key] = (keyTimes[key] > DateTime.Now) ? false : Keyboard.GetState().IsKeyDown(key);

                if (keyTimes[key] < DateTime.Now)
                {
                    // Code for what happens when Keys.Enter is pressed goes here.
                }
                break;
    }
} 
```

通过这样做，您可以检查每个键。`DateTimes`您也可以通过创建单独和单独的`bool`值来为每个键执行此操作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-13T15:07:09.310

我知道这很旧，但是如何：添加线程安全字典：

```
private ConcurrentDictionary<Keys, DateTime> _keyBounceDict = new ConcurrentDictionary<Keys, DateTime>(); 
```

然后用这个方法来跟踪按下的按键，判断是否有按键弹跳：

```
 ///////////////////////////////////////////////////////////////////////////////////////////
    /// IsNotKeyBounce - determines if a key is bouncing and therefore not valid within
    ///    a certain "delay" period
    ///////////////////////////////////////////////////////////////////////////////////////////
    private bool IsNotKeyBounce(Keys thekey, double delay)
    {
        bool OKtoPress = true;
        if (_keyBounceDict.ContainsKey(thekey))
        {
            TimeSpan ts = DateTime.Now - _keyBounceDict[thekey];
            if (ts.TotalMilliseconds < _tsKeyBounceTiming)
            {
                OKtoPress = false;
            }
            else
            {
                DateTime dummy;
                _keyBounceDict.TryRemove(thekey, out dummy);
            }
        }
        else
        {
            _keyBounceDict.AddOrUpdate(thekey, DateTime.Now, (key, oldValue) => oldValue);
        }
        return OKtoPress;
    } 
```

这是我在 Update 方法中添加的内容：

```
 if (Keyboard.GetState().IsKeyDown(Keys.W))
        {
            if (IsNotKeyBounce(Keys.W, 50.0)) _targetNew.Distance *= 1.1f;
        } 
```

我使用 50 毫秒，但您可以使用对您的应用有意义的任何内容，或者将其绑定到 GameTime 或其他任何内容......

# ruby-on-rails - 在 Ruby on Rails 中，错误消息中的 kENSURE 和 kEND 是什么？

> ID：904455
> 
> 赞同：4
> 
> 时间：2009-05-24T19:08:02.117
> 
> 标签：ruby-on-rails, ruby

在 Ruby on Rails 中，有时我会在页面上收到如下错误：

> 编译错误
> /Users/jian/ror/shov2/app/views/stories/index.html.erb:13: 语法错误，意外的**kENSURE**，期待 ')'
> /Users/jian/ror/shov2/app/views/stories/ index.html.erb:15：语法错误，意外**kEND**，期待 ')'

kEND，我猜它是 End... 所以这意味着文件结束但意外，应该有一个'）'。

KENSURE 怎么样？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-24T19:40:28.273

kEND 常量指的是标记“end”，就像您结束每个代码块一样。ensure 块相当于其他语言中的 finally 块。

```
begin
  1/0
rescue ZeroDivisionError
  puts "OH SHI-"
ensure # <- THIS THING
  1/1
  puts "Whew, we're safe"
end 
```

这就是 KENSURE 所指的。

听起来您忘记将结束括号放在方法调用或方法参数列表的末尾。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-28T21:41:05.623

我遇到过同样的问题。我有`<%= end %>`而不是`<% end %>`. 谢谢约翰！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-02T20:53:46.160

还要确保你有一个`do`after 任何期望块的子句。

做类似的事情

```
<%= form_tag "action" %>
  ...
<% end %> 
```

会导致同样的错误

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T19:15:12.413

检查`<%` `%>`ERB 模板中的分隔符（例如等）是否匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T19:37:35.317

异常处理中的关键字`ensure`。

# iphone - 在 OpenGL 中为曲面上的纹理设置动画

> ID：904460
> 
> 赞同：2
> 
> 时间：2009-05-24T19:15:04.333
> 
> 标签：iphone, opengl-es

我正在使用 iPhone OpenGLES 实现，我希望在一个简单的表面（两个三角形组成一个矩形）上无休止地滚动纹理。这应该很简单，但这不是我以前做过的事情，而且我一定遗漏了一些东西。我可以很好地旋转纹理，但翻译根本不起作用。我有一个小的实现问题还是我做的事情根本上是错误的？

```
// 移动纹理
 glMatrixMode(GL_TEXTURE);
 glPushMatrix();
 glLoadIdentity();

    // 增加偏移量 - 出于演示目的不重置
 wallOffset += 1.0;

    // 移动纹理 - 这不起作用
 glTranslatef(wallOffset,wallOffset,0.0);

    // 旋转纹理 - 这确实有效
 //glRotatef(wallOffset, 1.0, 0.0, 0.0);

 glMatrixMode(GL_MODELVIEW);

 glBindTexture(GL_TEXTURE_2D, WallTexture.name);
 glTexCoordPointer(2, GL_FLOAT, 0, 坐标);

 // 简单的绘图代码
 glNormalPointer(GL_FLOAT, 0, 法线);
 glVertexPointer(3, GL_FLOAT, 0, 顶点);
 glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

    // 推回矩阵
 glMatrixMode(GL_TEXTURE);
 glPopMatrix();
 glMatrixMode(GL_MODELVIEW);

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T19:43:23.043

您将纹理偏移量增加`1.0f`; 但是纹理坐标被考虑在范围内`[0, 1]`，所以你实际上并没有改变纹理坐标（假设你已经启用了某种包装）。

尝试更改该增量（尝试`.01f`，或者可能取决于帧速率）并查看它是否有效。如果不是，那么它可能与您启用的纹理参数有关。

# c# - PHP 命令 mysql_insert_id() 的等效 C#/SQLite 命令？

> ID：904463
> 
> 赞同：2
> 
> 时间：2009-05-24T19:15:55.000
> 
> 标签：c#, mysql, sqlite

我习惯于在 PHP 中使用命令“mysql_insert_id()”来返回插入到我的数据库中的最后一行的 id。

C# 中的 SQLite 中是否有等效命令？

谢谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T19:21:41.870

选择 last_insert_rowid()

也看看这篇文章。它详细解释了如何调整 DataAdapter 以检索最后一个插入行 ID。

[http://sqlite.phxsoftware.com/forums/p/134/465.aspx#465](http://sqlite.phxsoftware.com/forums/p/134/465.aspx#465)

# database - 如何更改 DataGridView 中所有突出显示的行 - VB.NEt

> ID：904471
> 
> 赞同：0
> 
> 时间：2009-05-24T19:19:25.087
> 
> 标签：database, vb.net, visual-studio, datagridview

初学者的问题。我正在尝试在 Visual Studio (VB.net) 中编写一小段代码，它将更改数据库中所有高亮行的特定字段的值。所以，我正在运行我的表单，它显示了数据表中的一些数据。然后我突出显示一些行（按住 Ctrl 并单击）。接下来，我单击一个按钮，该按钮将触发所有突出显示的行的值更改（仅）。说，我想为所有这些更改“名称”列的值。

希望这是有道理的。谢谢！达摩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T19:32:44.203

DataGridView.SelectedRows 属性包含用户选择的所有行的集合。您可以浏览此集合，并对每一行做您想做的事情。

有关更多信息和示例代码，请参阅[本文](http://www.automatedqa.com/community/Home/Articles/tabid/38/articleType/ArticleView/articleId/517/Default.aspx)。

# c++ - 具有 typedef 返回值的模板化成员函数

> ID：904472
> 
> 赞同：10
> 
> 时间：2009-05-24T19:19:27.617
> 
> 标签：c++, templates

为什么下面的代码会给我一个错误（g++ 4.1.2）？

```
template<class A>
class Foo {
public:
  typedef std::vector<A> AVec;
  AVec* foo();
};

template<class A>
Foo<A>::AVec* Foo<A>::foo() { // error on this line
  return NULL;
} 
```

错误是：

```
error: expected constructor, destructor, or type conversion before '*' token 
```

`Foo<A>::foo()`否则我应该如何定义函数（使用正确的返回类型）？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-24T19:25:23.860

这是一个称为“[两阶段查找](http://gcc.gnu.org/onlinedocs/gcc/Name-lookup.html)”的问题。基本上，由于`A`是`foo()`的定义中的模板参数，编译器在第一次解析模板时无法知道是否`Foo<A>::AVec`是类型甚至是否存在（例如，可能存在`Foo<Bar>`不完全包含 typedef）。它只会在模板**实例化**过程中知道它是什么，这会在稍后发生 - 对于这个阶段来说已经太晚了。

正确的方法是使用`typename`关键字来表明这是一个类型：

```
template<class A>
class Foo {
public:
  typedef std::vector<A> AVec;
  AVec* foo();
};

template<class A>
typename Foo<A>::AVec* Foo<A>::foo() {
  return NULL;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-24T19:25:41.940

常见`typename`问题：

```
template<class A>
typename Foo<A>::AVec* Foo<A>::foo() { // error on this line
  return NULL;
} 
```

请记住：作为一般规则，所有依赖于模板参数的限定名称都需要`typename`在它们之前。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-24T19:24:29.367

我真的不知道，但尝试将 typedef 放在课堂之外。

# ruby-on-rails - 为什么此评论会在 Ruby on Rails 上产生编译错误？

> ID：904474
> 
> 赞同：2
> 
> 时间：2009-05-24T19:20:44.570
> 
> 标签：ruby-on-rails, ruby, erb

<pre> 中有一行显示

```
<%= h @stories.inspect %> 
```

并且输出太长，所以我将其更改为

```
<%= #h @stories.inspect %>

<% @stories.each do |s| %>
  <%= h s.inspect %>
<% end %> 
```

（注释掉第一行）。现在代码将无法编译......说

编译错误
/Users/winterheat/ror/shov2/app/views/stories/index.html.erb:13: 语法错误，意外的 kENSURE，期待 ')'
/Users/winterheat/ror/shov2/app/views/stories/ index.html.erb:15：语法错误，意外的 kEND，期待 ')'

如果我完全删除该注释行，则代码将起作用。我想在某本书中，据说您可以像这样注释掉ERB中的一些代码？

**更新：** 如果我把它改成

```
<% #h @stories.inspect %> 
```

那么它会编译得很好......所以结果标签 <%= %> 的显示似乎不喜欢评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T19:35:12.263

将 <%= 视为“将此表达式的值添加到输出流”的意思。没有表情？语法错误。

考虑

```
output << @stories.inspect 
```

对比

```
output << 
```

跟踪 <%= 在 erb 源中如何真正处理可能会很有启发性。当我开始使用 Rails 时，我发现付出努力是值得的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T21:20:42.130

`<%= %>`在 Ruby/Rails 中注释标签的正确方法是`<%#= %>`……将注释符号放在等号之前。然后一切都会像魅力一样工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T19:26:42.623

<%= 后面应该跟一个 Ruby 表达式并用结果替换。

没有表达式会导致错误

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T21:15:52.153

采用

```
<% #h @stories.inspect %> 
```

代替

```
<%= #h @stories.inspect %> 
```

因为

```
<%= (I expect something that I can convert to string) %> 
```

# c# - 如何修复 IE WebBrowser 控件中的内存泄漏？

> ID：904478
> 
> 赞同：31
> 
> 时间：2009-05-24T19:22:55.987
> 
> 标签：c#, winforms, memory-leaks, webbrowser-control

我正在尝试在 C# Winform 应用程序中嵌入 WebBrowser 控件。这听起来很容易。但是我发现每次调用 Navigate 方法时，WebBrowser 控件都会占用大量内存。内存永远不会被释放。内存使用量越来越大……</p>

网上很多人都有同样的问题，但我还没有找到令人满意的答案。这是迄今为止我发现的关于这个问题的最佳讨论：

[IE WebBrowser 控件中的内存泄漏](http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/88c21427-e765-46e8-833d-6021ef79e0c8)

有人建议升级到 IE8 来解决这个问题。

但是，无论用户是否安装了最新的 IE 版本，我都需要一个可行的解决方案。我无法控制用户环境。

有人知道如何释放 WebBrowser 控件占用的内存吗？有解决方法吗？WebBrowser 控件是否有替代品？

**更新：** 我刚刚做了一些测试。在工作中，我正在运行 Windows XP 和 IE6。记忆没有在那里增长。调用导航方法时内存会增加，但会在一段时间后释放。在家里，我正在运行 Vista 并升级到 IE8。在这里我也看不到问题了。看起来这个问题是特定于 IE7 的。所以问题应该改写为“安装 IE7 时如何修复 IE WebBrowser Control 中的内存泄漏”。任何人都可以确认这个问题是特定于 IE7 的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-06-06T21:10:30.563

我的应用程序在导航时也不断消耗内存，不再释放。我在这里为我找到了解决方案：http: [//social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/88c21427-e765-46e8-833d-6021ef79e0c8](http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/88c21427-e765-46e8-833d-6021ef79e0c8)

为了完整起见，请发布值得注意的摘录：

```
-- in class definition

    [DllImport("KERNEL32.DLL", EntryPoint = "SetProcessWorkingSetSize", SetLastError = true, CallingConvention = CallingConvention.StdCall)]
    internal static extern bool SetProcessWorkingSetSize(IntPtr pProcess, int dwMinimumWorkingSetSize, int dwMaximumWorkingSetSize);

    [DllImport("KERNEL32.DLL", EntryPoint = "GetCurrentProcess", SetLastError = true, CallingConvention = CallingConvention.StdCall)]
    internal static extern IntPtr GetCurrentProcess(); 
```

-- 当你想减少内存时调用的代码

```
 IntPtr pHandle = GetCurrentProcess();
        SetProcessWorkingSetSize(pHandle, -1, -1); 
```

所有荣誉： [http ://social.msdn.microsoft.com/profile/mike_t2e/?type=forum&referrer=http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/88c21427-e765 -46e8-833d-6021ef79e0c8](http://social.msdn.microsoft.com/profile/mike_t2e/?type=forum&referrer=http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/88c21427-e765-46e8-833d-6021ef79e0c8) 用于发布解决方案。

和 [http://ict-engineer.blogspot.com/2010/10/net-webbrowser-control-memory-leak.html](http://ict-engineer.blogspot.com/2010/10/net-webbrowser-control-memory-leak.html) 用于 SEO 正确，所以我可以找到它；）

问候

编辑：如果这可以帮助您快速解决问题 - 好。但是你应该覆盖你的应用程序设计，如果有的话，你使用的模式，如果你构建的时间更长的话，重构它......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-06-12T17:41:29.237

基本思想是，

**“杀死我自己，然后重生。”**

Windows 将解决所有内存问题。

但是如果你先关闭你的应用程序，你就不能开始一个新的。

所以，**开始一个新的，并关闭旧的。**

首先打开一个新的，然后关闭一个旧的。

* * *

```
public void SOLVE_ALL_MY_MEMORY_PROBLEM()
{
  System.Diagnostics.Process.Start("MyProgram.exe");
  Application.Exit();
} 
```

* * *

[https://www.youtube.com/watch?v=aTBlKRzNf74](https://www.youtube.com/watch?v=aTBlKRzNf74)

**如果有参数，**

```
public void SOLVE_ALL_MY_MEMORY_PROBLEM()
{
  System.Diagnostics.Process.Start("MyProgram.exe", "PARA_para_dance");
  Application.Exit();
} 
```

转到 Program.cs

```
 static void Main(string[] args)
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        if(args.Count() > 0)
            Application.Run(new Form1(args[0]));
        else
            Application.Run(new Form1());
    } 
```

并且，转到 Form1.cs 并制作另一个 Form1()

```
 public Form1()
    {
        InitializeComponent();
    }

    public Form1(string dance_name)
    {
        InitializeComponent();

        ...
    } 
```

或者你可以使用临时文件！！！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-25T01:41:48.390

我刚刚创建了一个带有 Web 浏览器控件的简单应用程序来尝试复制您的结果。我发现是的，每次导航到一个页面时，所使用的内存都会显着增加。但是，这不是内存泄漏，因为如果您继续导航，您会看到不久之后，内存显着下降，表明垃圾收集器做了它的事情。为了证明这一点，我在每次调用 Navigate 后强制垃圾收集器进行收集，并且每次调用 Navigate 后使用的总内存保持在几乎相同的数量。

因此，虽然每次您“导航”时它都会占用内存，但它不是内存泄漏，您的内存将被释放。如果它收集得太快，只需调用 GC.Collect();

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-03-09T06:11:17.633

根据[MSDN](https://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396#Remarks)， System.Windows.Forms.WebBrowser 控件是 ActiveX WebBrowser 控件的托管包装，并使用安装在用户计算机上的任何版本的控件。

您可以在 WebBrowser 类的元数据中找到**Dispose(bool)**方法（在 Visual Stuio 中按 F12）来释放非托管资源。（不是 Dispose()）

[这里](https://referencesource.microsoft.com/#System.Windows.Forms/winforms/Managed/System/WinForms/WebBrowser.cs,3013ded900e5031e)的代码

```
protected override void Dispose(bool disposing) {
    if (disposing) {
        if (htmlShimManager != null)
        {
            htmlShimManager.Dispose();
        }
        DetachSink();
        ActiveXSite.Dispose();
    }
    base.Dispose(disposing);
} 
```

但是如果您尝试调用 WebBrowser.Dispose(bool)，则会显示编译器错误[CS1540](https://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k(CS1540);k(TargetFrameworkMoniker-%22.NETFRAMEWORK%2CVERSION%3DV4.0%22);k(DevLang-CSHARP)&rd=true)。

WebBrowser 类支持 Dispose(bool) 方法，但我们不能使用它。
我认为 WebBrowser 类的设计方式错误。

我有个主意叫 WebBrowser.Dispose(true)。
**非常简单！**但这不是一个好方法。

此处的示例代码（需要 3 个按钮和 1 个文本框）

```
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace Test_20170308_01
{
    public partial class Form1 : Form
    {
        [DllImportAttribute("kernel32.dll", EntryPoint = "SetProcessWorkingSetSize", ExactSpelling = true, CharSet = CharSet.Ansi, SetLastError = true)]
        private static extern int SetProcessWorkingSetSize(IntPtr process, int minimumWorkingSetSize, int maximumWorkingSetSize);
        public static void FlushMemory()
        {
            GC.Collect();
            GC.WaitForPendingFinalizers();
            if (Environment.OSVersion.Platform == PlatformID.Win32NT)
            {
                SetProcessWorkingSetSize(System.Diagnostics.Process.GetCurrentProcess().Handle, -1, -1);
            }
        }

        public Form1()
        {
            InitializeComponent();
        }

        private void addWeb()
        {
            WebBrowserD webBrowser1 = new WebBrowserD();
            webBrowser1.Size = new Size(1070, 585);
            this.Controls.Add(webBrowser1);
            webBrowser1.Navigate("about:blank");
        }

        private void RemoveWeb()
        {
            foreach (Control ctrl in this.Controls)
            {
                if (ctrl is  WebBrowserD)
                {
                    WebBrowserD web = (WebBrowserD)ctrl;
                    this.Controls.Remove(ctrl);
                    web.Navigate("about:blank");
                    web.Dispose(true);
                    FlushMemory();
                }
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            addWeb();
        }

        private void button2_Click(object sender, EventArgs e)
        {
            RemoveWeb();
        }

        private void button3_Click(object sender, EventArgs e)
        {
            foreach (Control ctrl in this.Controls)
            {
                if (ctrl is WebBrowserD)
                {
                    WebBrowserD axweb = (WebBrowserD)ctrl;
                    axweb.Navigate(textBox1.Text);
                    FlushMemory();
                }
            }
        }
    }

    public class WebBrowserD : WebBrowser
    {
        internal void Dispose(bool disposing)
        {
            // call WebBrower.Dispose(bool)
            base.Dispose(disposing);
        }
    }
} 
```

此代码可以防止内存泄漏。

**总之，** 你只需要一堂课。

```
 public class WebBrowserD : WebBrowser
    {
        internal void Dispose(bool disposing)
        {
            base.Dispose(disposing);
        }
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-24T19:53:20.370

有一个[替代控件](http://www.iol.ie/~locka/mozilla/mozilla.htm)使用 Gecko（Firefox 使用的引擎）而不是 Trident，并且可以很好地与 MSHTML 界面配合使用。

您的页面将在 Gecko 中呈现，您将完全控制浏览器的设置、插件、安全性和任何其他可自定义的功能。

缺点是您需要将 Gecko 与您的应用程序一起发布，我上次使用的是 Firefox 2 的等效版本，它大约为 8MB。

我很久以前发布了一个应用程序，它比较了 IE 和 Firefox 的渲染，两者都在你编辑 CSS 时更新。我没有遇到您在使用 Web 浏览器控件时遇到的内存问题，但我发现 Gecko 控件非常易于使用。它没有与 .net WebBrowser 控件相同的托管包装类，但它很容易解决这个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-03-22T00:14:58.117

似乎 Navigate() 方法将所有访问过的页面保存在内存中，因为您可以使用 GoBack() 方法，实际上没有“内存泄漏”。我的程序反复访问同一个 URL。“内存泄漏”问题可以通过使用 Refresh() 方法代替 Navigate() 方法，然后使用 GC.Collect() 来消除。代码如下：

```
 try
        {
            if (webBrowser.Url.Equals("about:blank")) //first visit
            {
                webBrowser.Navigate(new Uri("http://url"));
            }
            else
            {
                webBrowser.Refresh(WebBrowserRefreshOption.Completely);
            }
        }
        catch (System.UriFormatException)
        {
            return;
        }
        System.GC.Collect(); // may be omitted, Windows can do this automatically 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-09T05:42:31.580

我想这个问题已经很久没有答案了。这么多线程都有相同的问题，但没有决定性的答案。

我找到了解决此问题的方法，并希望与仍然面临此问题的所有人分享。

step1：创建一个新表单，比如 form2，并在其上添加一个 Web 浏览器控件。step2：在您拥有 webbrowser 控件的 form1 中，将其删除。step3：现在，转到 Form2 并将此 webbrowser 控件的访问修饰符设为 public，以便可以在 Form1 中访问它。 step4：在 form1 中创建一个面板并创建 form2 的对象并将其添加到面板中。Form2 frm = new Form2 (); frm.TopLevel = 假；frm.Show(); panel1.Controls.Add(frm); step5：定期调用以下代码 frm.Controls.Remove(frm.webBrowser1); frm.Dispose();

而已。现在，当您运行它时，您可以看到 webbrowser 控件已加载，它将定期处理，并且不再挂起应用程序。

您可以添加以下代码以提高效率。

```
 IntPtr pHandle = GetCurrentProcess();
    SetProcessWorkingSetSize(pHandle, -1, -1);

    GC.Collect();
    GC.WaitForPendingFinalizers();
    GC.Collect(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-02-21T14:14:09.990

我浏览了整个互联网，但无法找到这个问题的答案。我使用以下方法修复了它：

```
Protected Sub disposeBrowers()
    If debug Then debugTrace()
    If Me.InvokeRequired Then
        Me.Invoke(New simple(AddressOf disposeBrowers))
    Else
        Dim webCliffNavigate As String = webCliff.Url.AbsoluteUri

        'Dim webdollarNavigate As String = webDollar.Url.AbsoluteUri
        Me.splContainerMain.SuspendLayout()
        Me.splCliffDwellers.Panel2.Controls.Remove(webCliff)
        Me.splDollars.Panel2.Controls.Remove(webDollar)
        RemoveHandler webCliff.DocumentCompleted, AddressOf webCliff_DocumentCompleted
        RemoveHandler webDollar.DocumentCompleted, AddressOf webDollar_DocumentCompleted
        RemoveHandler webCliff.GotFocus, AddressOf setDisposeEvent
        RemoveHandler webCliff.LostFocus, AddressOf setDisposeEvent
        RemoveHandler webDollar.GotFocus, AddressOf setDisposeEvent
        RemoveHandler webDollar.LostFocus, AddressOf setDisposeEvent
        webCliff.Stop()
        webDollar.Stop()

        Dim tmpWeb As SHDocVw.WebBrowser = webCliff.ActiveXInstance
        System.Runtime.InteropServices.Marshal.ReleaseComObject(tmpWeb)
        webCliff.Dispose()

        tmpWeb = webDollar.ActiveXInstance
        System.Runtime.InteropServices.Marshal.ReleaseComObject(tmpWeb)
        webDollar.Dispose()

        webCliff = Nothing
        webDollar = Nothing
        GC.AddMemoryPressure(50000)
        GC.Collect()
        GC.WaitForPendingFinalizers()
        GC.Collect()
        GC.WaitForFullGCComplete()
        GC.Collect()
        GC.RemoveMemoryPressure(50000)
        webCliff = New WebBrowser()
        webDollar = New WebBrowser()
        webCliff.CausesValidation = False
        webCliff.Dock = DockStyle.Fill
        webDollar.CausesValidation = webCliff.CausesValidation
        webDollar.Dock = webCliff.Dock
        webDollar.ScriptErrorsSuppressed = True
        webDollar.Visible = True
        webCliff.Visible = True
        Me.splCliffDwellers.Panel2.Controls.Add(webCliff)
        Me.splDollars.Panel2.Controls.Add(webDollar)
        Me.splContainerMain.ResumeLayout()

        'vb.net for some reason automatically recreates these and the below is not needed
        'AddHandler webCliff.DocumentCompleted, AddressOf webCliff_DocumentCompleted
        'AddHandler webDollar.DocumentCompleted, AddressOf webDollar_DocumentCompleted
        'AddHandler webCliff.GotFocus, AddressOf setDisposeEvent
        'AddHandler webCliff.LostFocus, AddressOf setDisposeEvent
        'AddHandler webDollar.GotFocus, AddressOf setDisposeEvent
        'AddHandler webDollar.LostFocus, AddressOf setDisposeEvent

        webCliff.Navigate(webCliffNavigate)
        'webDollar.Navigate(webdollarNavigate)
        disposeOfBrowsers = Now.AddMinutes(20)
    End If
End Sub 
```

我知道这不是最漂亮或完美的解决方案，但对我来说效果很好。——莱拉

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-14T15:55:11.327

我在为我公司使用的不同 Intranet 页面编写一个小型“幻灯片”应用程序时遇到了这个问题。我找到的最简单的解决方案是在一段固定的时间后重新启动应用程序，在我的情况下是一个小时。这个解决方案对我们很有效，因为用户与浏览器的交互并不多。

```
Public Class MyApplication

    Private _AppTimer As Timers.Timer

    Public Sub New()
        _AppTimer = New Timers.Timer()
        _AppTimer.Interval = 1 * 60 * 60 * 1000 '1 Hour * 60 Min * 60 Sec * 1000 Milli

        AddHandler _AppTimer.Elapsed, AddressOf AppTimer_Elapsed

        _AppTimer.Start()
    End Sub

    Private Sub AppTimer_Elapsed(s As Object, e As Timers.ElapsedEventArgs)
        Application.Restart()
    End Sub

End Class 
```

这当然假设您有一个数据持久性机制。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-03T15:58:57.683

WebBrowser 控件中存在已知的内存泄漏。请参阅以下 Microsoft 知识库文章 - [KB893629](http://support.microsoft.com/kb/893629)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-07-25T15:20:46.620

2017 年快结束了，WebBrowser 中仍然存在这个烦人的错误。

我在这里尝试了所有解决方案，但没有一个对我有用。内存泄漏仍然存在......最奇怪的是，当我打电话时：

```
GC.Collect();
GC.WaitForPendingFinalizers();
GC.Collect();

IntPtr pHandle = GetCurrentProcess();
SetProcessWorkingSetSize(pHandle, -1, -1); 
```

它确实减少了很多内存！但是当下一个 Navigate 指令被调用时，所有泄漏的内存都会回到范围内......就像（如果内存为 450mb.. 这个指令减少到大约 20mb 并且在再次调用 .Navigate(string) 之后它会跳转到 460mb并且内存泄漏继续......

我什至尝试过 Dispose()，在下一页之前导航到 about:blank，将 webbrowser 对象设置为 null 并创建一个新对象。所有这些尝试都属于内存泄漏......这真的很令人沮丧......还有其他解决方案吗？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-06-18T21:21:40.457

我在表单上使用简单的 webbrowser 控件时遇到了这个问题。它导航到一个网页并停留在那里。根据任务管理器在 10 分钟内它从 120mb 吃掉了 2gb 的内存。

我的项目的一个简单解决方案是转到 Visual Studio 中的 webbrowser 控件属性并将“AllowNavigation”更改为 false。现在当我运行我的程序时，它保持在 120mb。我希望这可以帮助别人！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-24T19:32:37.683

我在应用程序中使用 Web 控件，但由于我的应用程序仅导航到一页，我没有注意到您提到的问题。还有另一个 web 控件实际上是一个包装器，我不知道它是否有同样的问题。你可以在[这里](http://www.codeproject.com/KB/miscctrl/csEXWB.aspx)找到它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-23T14:48:39.173

作为替代方案，我遇到了同样的问题，而不是导航到新页面，我只是使用 system.oi.streamreader/writer 对象重写了相同的 html 页面并调用刷新。显然，这在浏览器内容在线提供的情况下不起作用，但它对我有用。

此外，我目前正在使用 8 个以上的浏览器控件同时处于活动状态，以通过我的 .net 应用程序中的 javascript 提供报告。当用户使一个浏览器处于活动状态时，其他浏览器指向的 html 将被清除并刷新浏览器。使用这两种方法运行的 8 个浏览器，我可以轻松地将我的应用程序保持在 Firefox 的内存使用情况下，只需打开 3 个选项卡。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-06-17T19:30:09.113

我有同样的类似问题。我通过网络浏览器发送了超过 5000 个导航请求来抓取动态页面。在大约 50 个请求之后，我会用完内存，因为导航请求内存使用量在每次请求后都没有释放。我在导航后使用了 webBrowser.Dispose()，它解决了这个问题。它与IE7左右无关。我正在使用 IE 11 并且遇到了同样的问题。这是因为我没有处理导航对象。希望这可以帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-05-15T04:13:06.773

这意味着我的应用程序不再使用 500MB 内存，它永远保持在 60MB。诀窍是在处理它之后和调用 GC 之前将 webbrowser 设置为 null。

我的程序反复进入同一个站点，3个不同的页面，每次使用一次，没有抓取大量页面或任何东西。

```
string eventBuffer;

void GetContracts_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
        {
            var web = sender as WebBrowser;
            if (web.Url == e.Url)
            {
                TaskMaster.Get_Contracts(ref web);
                if(Memory.Contracts.Count==0)
                {
                    eventBuffer="UpdateContractFailed";
                    web.Disposed += new EventHandler(web_Disposed);
                    web.Dispose();
                    return;
                }
                eventBuffer="UpdateContractList";
                web.Disposed += new EventHandler(web_Disposed);
                web.Dispose();
            }
        }

private void web_Disposed(object sender, EventArgs e)
        {
            WebBrowser web = (WebBrowser)sender;
            FireEvent(eventBuffer);
            **web = null;**
            GC.Collect();
            thread.Abort();
        } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-04-27T21:48:24.347

只需使用“using”关键字声明 WebBrowser 控件。当调用 Navigate() 方法时，它将停止泄漏内存。我刚刚对其进行了测试，它对我来说效果很好。

```
using (var webBrowser = new System.Windows.Forms.WebBrowser())
{
    webBrowser.Navigate(url);
} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2012-06-22T11:10:25.077

页面加载后粘贴以下代码

```
System.Diagnostics.Process loProcess = System.Diagnostics.Process.GetCurrentProcess();
try
{
     loProcess.MaxWorkingSet = (IntPtr)((int)loProcess.MaxWorkingSet - 1);
     loProcess.MinWorkingSet = (IntPtr)((int)loProcess.MinWorkingSet - 1);
}
catch (System.Exception)
{
     loProcess.MaxWorkingSet = (IntPtr)((int)1413120);
     loProcess.MinWorkingSet = (IntPtr)((int)204800);
} 
```

# java - Linux 上 Java/C++ 应用程序共享内存 IPC 的良好替代品

> ID：904492
> 
> 赞同：10
> 
> 时间：2009-05-24T19:33:31.423
> 
> 标签：java, c++, linux, ipc, shared-memory

我目前在 Java 和 C++ 应用程序之间为 IPC 使用共享内存，但正在寻找更方便的替代方案。

有人可以建议具有相同性能和速度的更好方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T19:54:30.947

这取决于您计划如何让您的应用程序交互。在 POSIX 环境中，您拥有管道、共享内存、套接字、信号量和消息队列。请参阅此问题：[比较 unix linux IPC](https://stackoverflow.com/questions/404604/comparing-unix-linux-ipc)以获取更多信息。

您的流程（即客户端/服务器、生产者-消费者等）的交互模型是什么？

根据个人经验，我建议您最好的选择是管道（因为它们只是用于读取和写入字节的文件）或套接字（因为两种语言都支持它们）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T19:59:57.970

正如 mikelong 所说，这在很大程度上取决于您在做什么。AFAIK，没有一个 IPC 方法具有本机 Java 绑定，因此您可能必须使用 JNI 并自己进行绑定，因此所有不同的方法大致同样困难。如果你正在做消息传递，我强烈建议使用消息队列。它们非常易于使用（一旦您拥有绑定），并且具有良好的性能。如果您需要“共享”某些资源，那么您可能希望坚持使用共享内存。

听起来您有某种客户端/服务器的东西，我会说使用消息队列、unix 域套接字或命名管道。它们都涉及在内核中复制数据，因此它们不如共享内存快，但它们仍然非常快。如果您有类似消息的数据（单个小数据包），请使用消息队列。这可能是最干净的解决方案。如果您有更多的数据流，请使用管道或套接字。套接字的优点是您可以在以后轻松地使其成为网络透明（如 X11），但它们比管道更难使用。性能可能非常相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T20:35:49.650

在用不同语言编写的应用程序之间进行通信的最简单方法是 IMHO [CORBA](http://www.corba.org/)。那里有非常好的开源[CORBA ORB](http://www.omg.org/technology/corba/corbadownloads.htm)。我们对 C++使用[TAO ，对 Java 使用](http://www.cs.wustl.edu/~schmidt/TAO.html)[JacORB](http://www.jacorb.org/)。还有像[OCI](http://www.theaceorb.com/)和[Remedy](http://www.theaceorb.nl/)这样的公司提供技术支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T08:25:48.110

虽然可能不是最有效的，Java 只支持开箱即用的套接字（我记得最好的）。它们非常灵活，只是可能不如其他选项快。正如 Zifre 提到的，它为您提供了网络透明性以及语言/绑定透明性的机会；因为现在几乎每种语言都支持开箱即用的套接字库。

虽然我将效率抛到了窗外，但如果您希望将其提升到一个新的水平，您可能可以将其包装在某种 Web 服务中。在消费者上使用嵌入式 Web 服务器，让生产者向其提交数据。

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2012-04-09T22:48:40.950

> 我目前在 Java 和 C++ 应用程序之间为 IPC 使用共享内存，但正在寻找更方便的替代方案。
> 
> 有人可以建议更好的方法，但性能速度相同吗？

对于简单的共享内存，您甚至不需要特殊的库：

```
class Main {
    private static class CustomThread extends Thread {
        public int x = 0;
        public void run() {
            x = 5;
        }
    }

    public static void main(String[] args) {

        CustomThread t = new CustomThread();
        t.start();

        System.out.println(t.x);
        System.out.println(t.x);
    }
} 
```

局部变量 x 可以在线程外部和内部访问，允许您使用它来将信息传入和传出线程。

# javascript - 为什么 Eclipse 代码不支持某些项目？

> ID：904498
> 
> 赞同：1
> 
> 时间：2009-05-24T19:37:43.740
> 
> 标签：javascript, eclipse

```
a="hello";
b=a.sub();
document.write(b); 
```

当我编写此 JavaScript 代码时，我的 Eclipse 不会提供代码帮助。

这是`sub()`一部分。当我进入

```
b=a.s 
```

我按 ctrl+space，它什么也没带来。这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T19:47:08.183

Eclipse 没有足够的信息来为 JavaScript 提供代码完成，因为 JavaScript 是一种解释型、动态类型的语言。`a`在您键入该点后，它无法知道哪些方法对您的变量有效。

# ruby-on-rails - Ruby on rails 模型和不同命名空间内的控制器

> ID：904502
> 
> 赞同：2
> 
> 时间：2009-05-24T19:41:53.780
> 
> 标签：ruby-on-rails, ruby, model, namespaces, form-for

好的。疯了吧。

我是 RoR 的新手，我真的很想参与其中，因为到目前为止我所看到的一切都使它对我所做的工作类型更具吸引力。

但是，我似乎无法用 RoR完成一件*非常简单的事情。*

我想要这些控制器：

```
/admin/blog/entries (index/show/edit/delete)
/admin/blog/categories (index/show/edit/delete)
/admin/blog/comments (index/show/edit/delete)
... and so on 
```

这些模型：

```
Blog::Entry    (table: blog_entries)
Blog::Category (table: blog_categories)
Blog::Comments (table: blog_comments)
... and so on 
```

现在，我已经经历了相当多的痛苦才能完成这项工作。我的第一次尝试是生成脚手架（我使用的是 2.2.2）。我生成了脚手架，但必须移动模型，然后修复对控制器中模型的引用（请参阅[在控制器中找不到命名空间内的 Ruby on Rails 模型](https://stackoverflow.com/questions/903258/ruby-on-rails-model-inside-namespace-cant-be-found-in-controller)）。

这已经是一个很大的痛苦，但是，嘿，我让它工作了。现在虽然 form_for 不起作用，我不知道如何使用 url 帮助程序（我不知道这些被称为什么......它们是自动生成的方法，将 URLs 返回到与模型关联的控制器）。我不知道他们叫什么名字。我的模型是博客::条目。我试图弄乱 route.rb 的地图资源方法，但没有运气。当我尝试将 form_for 与我的模型一起使用时，出现此错误

```
undefined method `blog_entries_path' for #<ActionView::Base:0xb6848080> 
```

现在。这真的很令人沮丧。我不会为了使用这个框架而完全破坏我的代码组织，如果我不知道如何完成这个简单的任务（我已经研究了至少 5 个小时），那么我根本无法继续。

关于如何实现这一点有什么想法吗？

谢谢

**编辑**

这是我的路线：

```
 admin_blog_entries GET    /admin_blog_entries                  {:controller=>"admin_blog_entries", :action=>"index"}
   formatted_admin_blog_entries GET    /admin_blog_entries.:format          {:controller=>"admin_blog_entries", :action=>"index"}
                                POST   /admin_blog_entries                  {:controller=>"admin_blog_entries", :action=>"create"}
                                POST   /admin_blog_entries.:format          {:controller=>"admin_blog_entries", :action=>"create"}
           new_admin_blog_entry GET    /admin_blog_entries/new              {:controller=>"admin_blog_entries", :action=>"new"}
 formatted_new_admin_blog_entry GET    /admin_blog_entries/new.:format      {:controller=>"admin_blog_entries", :action=>"new"}
          edit_admin_blog_entry GET    /admin_blog_entries/:id/edit         {:controller=>"admin_blog_entries", :action=>"edit"}
formatted_edit_admin_blog_entry GET    /admin_blog_entries/:id/edit.:format {:controller=>"admin_blog_entries", :action=>"edit"}
               admin_blog_entry GET    /admin_blog_entries/:id              {:controller=>"admin_blog_entries", :action=>"show"}
     formatted_admin_blog_entry GET    /admin_blog_entries/:id.:format      {:controller=>"admin_blog_entries", :action=>"show"}
                                PUT    /admin_blog_entries/:id              {:controller=>"admin_blog_entries", :action=>"update"}
                                PUT    /admin_blog_entries/:id.:format      {:controller=>"admin_blog_entries", :action=>"update"}
                                DELETE /admin_blog_entries/:id              {:controller=>"admin_blog_entries", :action=>"destroy"}
                                DELETE /admin_blog_entries/:id.:format      {:controller=>"admin_blog_entries", :action=>"destroy"}
                           home        /                                    {:action=>"index", :controller=>"index"}
                                       /:controller/:action/:id
                                       /:controller/:action/:id.:format 
```

那看起来不太对劲。这是我的 routes.rb （已删除评论）：

```
ActionController::Routing::Routes.draw do |map|

  map.resources :admin_blog_entries

  map.home '', :controller => 'index'

  map.connect ':controller/:action/:id'
  map.connect ':controller/:action/:id.:format'
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T23:43:07.333

您是否尝试过查看“rake routes”给您的路线列表？如果您的 routes.rb 是正确的，它应该向您显示博客条目路由的正确名称。

另外，也许这会有所帮助： http: [//www.coreywoodcox.com/2008/08/18/rails-namespaces-subdomains/](http://www.coreywoodcox.com/2008/08/18/rails-namespaces-subdomains/)。

编辑：

好吧，那么调用路由的正确方法是 admin_blog_entries_path 而不是 blog_entries_path。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-29T19:12:52.783

好的，这是我相当老套的做法，我不喜欢但确实有效。

就我而言，我有模型 Blog::Article、Blog::Comment，它们嵌套在路由中。如果使用这种方法的一个警告是在 Blog::CommentsController 中加载文章时你可以期望 params[:article_id] 或 params[:blog_article_id]。绝不是好的，但就像我说的那样。它确实有效：/

```
blog.resources :articles do |article|
  article.resources :comments
end

blog.resources :blog_articles, :controller => 'articles' do |blog_article|
  blog_article.resources :blog_comments, :controller => 'comments'
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T21:33:15.823

您的 routes.rb 应该如下所示：

```
map.namespace :admin do |admin|
  admin.namespace :blog do |blog|
    blog.resources :entries
    blog.resources :categories
    ...
  end
end 
```

但我不确定如何在你的 url 中处理这个 '/blog/' 部分（我还没有在我的模型中使用任何命名空间）。但是通过这些路线，您将能够使用：

```
admin_blog_categories_path               => '/admin/blog/categiries'
admin_blog_category_path(@some_category) => '/admin/blog/categories/1' 
```

等等。

# java - 使用 SAX 的状态模式

> ID：904503
> 
> 赞同：2
> 
> 时间：2009-05-24T19:42:21.017
> 
> 标签：java, xml, sax, state-pattern

我必须用 java SAX 解析器解析一些 xml。趁着忙，看到这里可以使用状态模式。

定义了清晰的状态和状态转换，类似于 xml 文档的结构。

要实现状态模式，我必须定义一个接口（或抽象类）。最明显的接口方法是：

```
public void startElement(String elementName);
public void endElement(String elementName); 
```

但是我遇到的问题是如何返回信息。我需要一个结构中的 xml 文档中多个级别的信息。

这是 xml 文档的一部分

```
<chessboard>
     <white>
         <king>
              <position>
                  <x>e</x>
          <y>1</y>
              </position>
         </king>
         <pawns>
             <pawn id="1">
                  <position>
                      <x>e</x>
              <y>2</y>
                  </position>
             </pawn>
             <pawn id="1">
                  <position>
                      <x>f</x>
              <y>2</y>
                  </position>
             </pawn>
         </pawns>
    </white>
</chessboard> 
```

我的假设是否正确，即状态模式适合这里？如果是这样，在这里实施它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:14:27.033

您的接口可以由其实例“内部累积”特定所需信息的类实现，并添加其他方法以使该信息可访问。

但是，很难拥有通用的“获取信息”方法，因为类型可能会有所不同；并且，整个方法可能不适合 SAX 类方法的主要优点，即随着解析的进行逐步执行操作的能力，而不是在解析过程中积累信息并且只在以后采取行动（这个优势在当您正在解析非常大的文档）。因此，我不会将其视为在 Java 中使用 SAX 的“规范”方式，而只是偶尔会派上用场的一种变体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T06:59:33.150

我认为状态模式正好适合这里。必须保留一些状态，才能知道您在文档中的位置。

要收集信息，您可以将一个对象传递给状态类的每个方法，以便它们可以将信息放入其中。

除非有其他我没有想到的问题，否则我认为这是最好的解决方案。

# ruby-on-rails - Rails 投票网站

> ID：904510
> 
> 赞同：-1
> 
> 时间：2009-05-24T19:44:53.227
> 
> 标签：ruby-on-rails, ruby

我开始用 Rails 建立一个网站，我希望人们能够用“是”或“否”或“对”或“错”的选项对某些事情进行投票。我还希望有一个按百分比计算的运行计数（可能在下面）。有人可以告诉我如何添加此功能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T19:51:00.343

请记住以强制执行的方式构建它：“一个 IP 地址一票”。除此之外，它是简单明了的数学。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:20:22.990

我刚刚完成了类似的事情。

如果你想看看其他人是如何解决这个问题的，只需[搜索 github](http://github.com/search?type=Repositories&language=rb&q=vote&repo=&langOverride=&x=29&y=24&start_value=1)。有 30 个 ruby​​ 存储库。

我发现[acts_as_voteable](http://github.com/inspiresynergy/acts_as_voteable/tree/master)最有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T21:53:28.560

您还应该查看 API 中的“计数器”，这样每个投票都有一个值，并且计数保留在已投票的对象上（因此不必每次都运行计数）。

# objective-c - 如何在 Cocoa 中将 performSelector:withObject:afterDelay: 与原始类型一起使用？

> ID：904515
> 
> 赞同：97
> 
> 时间：2009-05-24T19:46:18.420
> 
> 标签：objective-c, cocoa

该`NSObject`方法`performSelector:withObject:afterDelay:`允许我在一段时间后使用对象参数调用对象上的方法。它不能用于带有非对象参数的方法（例如整数、浮点数、结构、非对象指针等）。

使用具有非对象参数的方法实现相同目标的*最简单*方法是什么？我知道对于常规`performSelector:withObject:`，解决方案是使用`NSInvocation`（顺便说一句，这真的很复杂）。但我不知道如何处理“延迟”部分。

谢谢，

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-11-14T17:58:50.093

这是我过去常说的使用 NSInvocation 无法更改的内容：

```
SEL theSelector = NSSelectorFromString(@"setOrientation:animated:");
NSInvocation *anInvocation = [NSInvocation
            invocationWithMethodSignature:
            [MPMoviePlayerController instanceMethodSignatureForSelector:theSelector]];

[anInvocation setSelector:theSelector];
[anInvocation setTarget:theMovie];
UIInterfaceOrientation val = UIInterfaceOrientationPortrait;
BOOL anim = NO;
[anInvocation setArgument:&val atIndex:2];
[anInvocation setArgument:&anim atIndex:3];

[anInvocation performSelector:@selector(invoke) withObject:nil afterDelay:1]; 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-24T19:54:11.180

只需将 float、boolean、int 或类似的值包装在 NSNumber 中。

对于结构，我不知道一个方便的解决方案，但您可以创建一个单独的 ObjC 类来拥有这样的结构。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-10-21T15:26:55.143

不要使用这个答案。我只为历史目的而留下它。请参阅下面的评论。

如果它是 BOOL 参数，则有一个简单的技巧。

将 nil 表示为 NO，将 self 表示为 YES。nil 被转换为 NO 的 BOOL 值。self 被强制转换为 YES 的 BOOL 值。

如果它不是 BOOL 参数，则此方法会失效。

假设 self 是一个 UIView。

```
//nil will be cast to NO when the selector is performed
[self performSelector:@selector(setHidden:) withObject:nil afterDelay:5.0];

//self will be cast to YES when the selector is performed
[self performSelector:@selector(setHidden:) withObject:self afterDelay:10.0]; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-24T20:01:20.777

也许[NSValue](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsvalue_Class/Reference/Reference.html)，只需确保您的指针在延迟后仍然有效（即没有在堆栈上分配对象）。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-03-19T16:37:18.090

我知道这是一个老问题，但如果你正在构建 iOS SDK 4+，那么你可以使用块来做这件事，并且让它更具可读性：

```
double delayInSeconds = 2.0;
int primitiveValue = 500;
dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * NSEC_PER_SEC));
dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
    [self doSomethingWithPrimitive:primitiveValue];     
}); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-08-21T10:35:33.980

PerformSelector:WithObject 总是接受一个对象，所以为了传递像 int/double/float 等参数......你可以使用这样的东西。

```
//NSNumber is an object..

    [self performSelector:@selector(setUserAlphaNumber:) withObject: [NSNumber numberWithFloat: 1.0f]
    afterDelay:1.5];

    -(void) setUserAlphaNumber: (NSNumber*) number{

     [txtUsername setAlpha: [number floatValue] ];
    } 
```

同样，您可以使用 [NSNumber numberWithInt:] 等....在接收方法中，您可以将数字转换为 [number int] 或 [number double] 格式。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-07-12T08:52:56.823

块是要走的路。你可以有复杂的参数，类型安全，它比这里的大多数旧答案更简单、更安全。例如，您可以只写：

```
[MONBlock performBlock:^{[obj setFrame:SOMETHING];} afterDelay:2]; 
```

块允许您捕获任意参数列表、引用对象和变量。

支持实现（基本）：

```
@interface MONBlock : NSObject

+ (void)performBlock:(void(^)())pBlock afterDelay:(NSTimeInterval)pDelay;

@end

@implementation MONBlock

+ (void)imp_performBlock:(void(^)())pBlock
{
 pBlock();
}

+ (void)performBlock:(void(^)())pBlock afterDelay:(NSTimeInterval)pDelay
{
  [self performSelector:@selector(imp_performBlock:)
             withObject:[pBlock copy]
             afterDelay:pDelay];
}

@end 
```

例子：

```
int main(int argc, const char * argv[])
{
 @autoreleasepool {
  __block bool didPrint = false;
  int pi = 3; // close enough =p

  [MONBlock performBlock:^{NSLog(@"Hello, World! pi is %i", pi); didPrint = true;} afterDelay:2];

  while (!didPrint) {
   [NSRunLoop.currentRunLoop runUntilDate:[NSDate dateWithTimeInterval:0.1 sinceDate:NSDate.date]];
  }

  NSLog(@"(Bye, World!)");
 }
 return 0;
} 
```

另请参阅迈克尔的答案 (+1) 以获取另一个示例。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-03-17T01:22:50.197

我总是建议您使用 NSMutableArray 作为传递的对象。这是因为您可以传递多个对象，例如按下的按钮和其他值。NSNumber、NSInteger 和 NSString 只是具有某种价值的容器。确保当您从引用的数组中获取对象时引用正确的容器类型。您需要传递 NS 容器。在那里您可以测试该值。请记住，容器在比较值时使用 isEqual。

```
#define DELAY_TIME 5

-(void)changePlayerGameOnes:(UIButton*)sender{
    NSNumber *nextPlayer = [NSNumber numberWithInt:[gdata.currentPlayer intValue]+1 ];
    NSMutableArray *array = [[NSMutableArray alloc]initWithObjects:sender, nil];
    [array addObject:nextPlayer];
    [self performSelector:@selector(next:) withObject:array afterDelay:DELAY_TIME];
}
-(void)next:(NSMutableArray*)nextPlayer{
    if(gdata != nil){ //if game choose next player
       [self nextPlayer:[nextPlayer objectAtIndex:1] button:[nextPlayer objectAtIndex:0]];
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-02-22T19:03:54.520

我也想这样做，但使用接收 BOOL 参数的方法。用 NSNumber 包装布尔值，无法通过值。我不知道为什么。

所以我最终做了一个简单的hack。我将所需的参数放在另一个虚拟函数中，并使用 performSelector 调用该函数，其中 withObject = nil;

```
[self performSelector:@selector(dummyCaller:) withObject:nil afterDelay:5.0];

-(void)dummyCaller {

[self myFunction:YES];

} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-04-23T23:17:04.653

我发现最快（但有点脏）的方法是直接调用 objc_msgSend。但是，直接调用它是危险的，因为您需要阅读文档并确保您使用正确的变体作为返回值的类型，并且因为 objc_msgSend 被定义为 vararg 以方便编译器，但实际上是作为快速组装胶水实现的. 下面是一些用于调用委托方法 -[delegate integerDidChange:] 的代码，该方法采用单个整数参数。

```
#import <objc/message.h>

SEL theSelector = @selector(integerDidChange:);
if ([self.delegate respondsToSelector:theSelector])
{
    typedef void (*IntegerDidChangeFuncPtrType)(id, SEL, NSInteger);
    IntegerDidChangeFuncPtrType MyFunction = (IntegerDidChangeFuncPtrType)objc_msgSend;
    MyFunction(self.delegate, theSelector, theIntegerThatChanged);
} 
```

这首先保存了选择器，因为我们将多次引用它，并且很容易创建错字。然后它会验证委托是否确实响应了选择器——它可能是一个可选协议。然后它创建一个函数指针类型来指定选择器的实际签名。请记住，所有 Objective-C 消息都有两个隐藏的第一个参数，即消息的对象和发送的选择器。然后我们创建一个适当类型的函数指针并将其设置为指向底层的 objc_msgSend 函数。请记住，如果返回值是浮点数或结构，则需要使用 objc_msgSend 的不同变体。最后，使用 Objective-C 在表单下使用的相同机制发送消息。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-01-11T23:21:46.053

您可以只使用 NSTimer 来调用选择器：

```
[NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(yourMethod:) userInfo:nil repeats:NO] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-25T16:08:56.170

使用 NSNumber 或其他 NSValue 调用 performSelector 将不起作用。它不会使用 NSValue/NSNumber 的值，而是将**指针**有效地转换为 int、float 或其他任何值并使用它。

但解决方案简单明了。创建 NSInvocation 并调用

`[invocation performSelector:@selector(invoke) withObject:nil afterDelay:delay]`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-07-27T15:13:51.020

也许......好吧，很可能，我错过了一些东西，但为什么不创建一个对象类型，比如 NSNumber，作为非对象类型变量的容器，比如 CGFloat？

```
CGFloat myFloat = 2.0; 
NSNumber *myNumber = [NSNumber numberWithFloat:myFloat];

[self performSelector:@selector(MyCalculatorMethod:) withObject:myNumber afterDelay:5.0]; 
```

# c# - 如何在 Excel 中显示长数字？

> ID：904519
> 
> 赞同：12
> 
> 时间：2009-05-24T19:48:42.440
> 
> 标签：c#, excel

我必须构建一个 C# 程序来制作 CSV 文件并放入长数字（在我的程序中作为字符串）。问题是，当我在 Excel 中打开此 CSV 文件时，数字显示如下：

1234E+ 或 1234560000000（数字结尾为0）

我如何保留数字的格式？如果我将文件作为文本文件打开，则数字格式正确。

提前致谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-24T20:58:35.950

正如其他人所提到的，您可以强制数据为字符串。最好的方法是="1234567890123"。= 使单元格成为公式，引号使括起来的值成为 Excel 字符串文字。这将显示所有数字，甚至超出 Excel 的数字精度限制，但单元格（通常）将无法直接用于数字计算。

如果您需要数据保持数字，最好的方法可能是创建一个原生 Excel 文件（.xls 或 .xlsx）。[可以在此相关 Stack Overflow 问题](https://stackoverflow.com/questions/151005/create-excel-xls-and-xlsx-file-from-c)的解决方案中找到各种方法。

如果您不介意使用千位分隔符，还可以使用另一种技巧，即让您的 C# 程序插入千位分隔符并将值括在引号中：“1,234,567,890,123”。不要包含前导 = （因为这将迫使它成为一个字符串）。请注意，在这种情况下，引号用于保护 CSV 中的逗号，而不是用于指定 Excel 字符串文字。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-24T19:53:25.317

将这些长数字格式化为字符串，方法是在前面放置一个 '（撇号）或从中创建一个公式：="1234567890123"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T19:54:05.360

你不能。Excel 以十五位精度存储数字。如果您不介意无法在 Excel 中对数字执行计算，您可以将它们存储为文本，所有数字都会显示出来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T19:59:23.073

当我生成要导入 Excel 的数据时，如果我想控制数据的显示方式，我不会生成 CSV 文件。相反，我写出一个 Excel 文件，其中适当设置了单元格的属性。我不知道是否有一个库可以在 C# 中为您执行此操作，而无需在生成文件的机器上安装 Excel，但这是值得研究的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T09:35:50.983

    我的两分钱：
    我认为重要的是要意识到“数据”和“格式”之间的区别。在此示例中，您尝试将两者都存储在纯数据文件中。正如您从其他答案中可以看出的那样，这将改变数据的性质。（换句话说，导致它被转换为字符串。CSV 文件是仅数据文件。您可以在这里和那里做一些技巧来将格式与数据合并，但在我看来，这实质上是通过合并破坏了数据它具有非数据值：即：“格式化”。
    如果您确实需要能够存储格式信息，我建议，如果您有时间开发它，请切换到能够将格式信息与数据分开存储的文件类型。听起来这个问题很适合 XML 电子表格解决方案。通过这种方式，您不仅可以指定您的数据，还可以指定它的类型和您选择使用的任何格式。

# php - 输出 Firefox JSON 数据

> ID：904522
> 
> 赞同：1
> 
> 时间：2009-05-24T19:53:14.647
> 
> 标签：php, json, firefox, bookmarks

是否可以使用 PHP 输出特定的 JSON 数据（从 Firefox 书签中导出）。

这是我到目前为止的代码，它将重新编码数据，因为 Firefox 没有以正确的 UTF-8 方式导出它。我还从文件末尾删除了结尾的 , 。

```
<?php
// Read the file blah blah
$hFile = "../uploads/james.json";
$hFile = file_get_contents($hFile);
$hFile = utf8_encode($hFile);
// Remove the trailing comma because Firefox is lazy!!!!
$hFile = substr($hFile, 0, strlen($hFile)-3) . "]}";

$hDec = json_decode(fixEncoding($hFile));

foreach($hDec['uri'] as $hURI) {
    // Output here
}

// Fixes the encoding to UTF-8
function fixEncoding($in_str) {
    $cur_encoding = mb_detect_encoding($in_str);
    if($cur_encoding == "UTF-8" && mb_check_encoding($in_str,"UTF-8")){
        return $in_str;
    }else{
        return utf8_encode($in_str);
    }
}
?> 
```

使用 var_dump，除了整个数据之外，我无法获得任何输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T20:36:26.400

虽然 json_decode() 能够解码

```
<?php
$c = '{"title":""}';
$bookmarks = json_decode($c);
var_dump($bookmarks);
```

它失败了

```
$c = '{"title":""**,**}';
```

最后的“空”元素会关闭解析器。这正是我的bookmarks.json 的样子

```
{"title":"", ... "children":[]}**,**]}
```

编辑：[json.org](http://www.json.org/)链接到[php json 库的比较](http://gggeek.altervista.org/sw/article_20061113.html)。根据他们的比较图，例如[zend json](http://framework.zend.com/manual/en/zend.json.html)应该能够解析firefox的bookmark.json。虽然没有测试过。

编辑2：为什么不简单地测试一下......？是的，zend json 能够解析未修改的 bookmarks.json

```
require 'Zend/Json.php';`$encodedValue = file_get_contents('Bookmarks 2009-05-24.json');
$phpNative = Zend_Json::decode($encodedValue);
var_dump($phpNative);`
```

印刷

```
数组（7）{
  [“标题”]=>
  字符串（0）“”
  [“身份证”]=>
...
      [“孩子”]=>
      数组（0）{
      }
    }
  }
}
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T20:58:25.543

正如 VolkerK 所说，您必须在`]` *and* `}`之前去掉逗号：

```
// ... row 7
// Remove the trailing comma because Firefox is lazy
$hFile = preg_replace('/,\s*([\]}])/m', '$1', $hFile);

// ... or using str_replace
$hFile = str_replace(',]', ']', str_replace(',}', '}', $hFile)); 
```

但是，您尝试访问书签的 URI 的方式（我认为这是您正在尝试做的）将不起作用。

重新检查文件的格式/架构。

# java - Java 小程序与 Rails 应用程序的通信

> ID：904528
> 
> 赞同：2
> 
> 时间：2009-05-24T19:54:45.627
> 
> 标签：java, ruby-on-rails, applet, jruby

我正在创建一个 Rails 应用程序，在它上面应该有一个 Java Applet。

我的问题是小程序必须与 Rails 部分紧密集成。我必须能够获得所有用户的列表、更新图像等... Internet 上提供的关于如何将小程序与 Rails 一起使用的信息非常少。所以请给我一些提示。最好的方法是什么？

1.  向小程序发送参数？
2.  使用小程序中的 Rails REST 接口？
3.  以某种方式使用 JRuby？
4.  其他....？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T02:36:06.970

你能提供更多细节吗？与此同时，这是我对你的问题的看法：

> 1.  向小程序发送参数？

您的 rails 应用程序将能够为小程序提供服务，但一旦提供服务，我认为您将能够向它发送消息（但是您将能够响应来自它的消息，这可能是您的要求）。

> 2.  使用小程序中的 Rails REST 接口？

你自己已经回答了那个问题。REST 是一种接口设计，因此可以从任何可以发出 HTTP 请求的地方访问。诀窍是正确构造 URL，以便 rails 知道您想要做什么。[在http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)有关于配置 rails 路线（REST 和非 REST）的很好的信息

> 3.  以某种方式使用 JRuby？

您可以为此使用 jruby，但您不需要这样做。您的服务器（rails）和客户端（浏览器/小程序）通过 http 相互通信，因此不需要使用相同的语言或在相同的 VM 上运行。

希望有帮助....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T09:10:58.110

我认为您可能没有找到任何关于 Applet 和 Rails 的具体内容的原因是它们在不同级别上运行，并且并不真正相互依赖。看起来 Rob 试图澄清一些事情，所以我将再采取一步，以确保我们都在同一页面上。

Rails 的工作是通过 Web 服务器生成 HTML/XML/Javascript/图像并将其提供给用户的 Web 浏览器以进行渲染。该 HTML 的一部分将是一个 APPLET（或可能是 OBJECT）标签，它指示浏览器加载小程序。通常，这会指示浏览器调用 Java 插件并让它处理加载小程序。然而，一旦加载并运行，即使小程序显示在浏览器中的当前网页上（或者甚至可能在另一个窗口中），它实际上并不十分了解它所在的网页。在大多数情况下，小程序不关心浏览器或它们“属于”的页面。因此，如果一个小程序需要更多信息，或者需要请求数据，它通常只会向它来自的服务器发送一个 HTTP 请求。然后它会解析数据并自行更新。

我假设您可能需要单击或输入小程序中的某些内容，并且该数据用于更新 Rails 为浏览器提供的网页。使用小程序，您几乎有两种选择：

1.  使用 Web 服务器应用程序共享状态信息
2.  [如http://java.sun.com/products/plugin/1.3/docs/jsobject.html](http://java.sun.com/products/plugin/1.3/docs/jsobject.html)所示，使用 JSObject 使用 Java 到 Javascript 通信

老实说，选项 2 有很多警告，除非您完全控制所有潜在用户系统上的浏览器和 Java 版本，否则我永远不会使用它。即使那样，我也会担心会破坏它的更新。

基本上，选项 1 让 Applet 和 Javascript/HTML 定期轮询 Web 服务器 (Rails)，以查看是否有任何更新或请求需要响应以进行数据交换。如果用户更新了小程序，它会通过 URL 请求/发布向 Web 服务器发送消息，并且网页的下一个查询（可能通过类似 AJAX 的调用）将看到新数据，并且网页将更新它。

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T18:40:56.733

两个非常棒的答案。我非常感谢他们，谢谢！

阅读您的帖子让我意识到最好的选择是使用 HTTP 请求到 Rails REST 接口。但是，我看到这种方法有一些缺点。但我没有看到任何更好的解决方案。小程序应具备的一项功能是能够浏览和搜索所有产品，这可能很多。为每次搜索发送一个 HTTP 请求会很昂贵。也许我可以通过在小程序启动时加载所有产品来解决这个问题。然后浏览和搜索会很快。或者也许做一些不错的缓存。因此，一旦找到它们，我就不会再取它们了。

关于在网上找不到很多关于此的信息。我明白你的观点。但是......我仍然认为应该有更多。我的意思是，在我的情况下，我真的很想要一个特定于 Rails 的库来帮助我发送请求以更正 url。糟糕的是，Java 并不是那么动态。自动做一些事情有点困难，比如在 Ruby 和 Rails 中。也许我会为此写一个小库。我的意思是，无论如何我都必须写它。那么为什么不做一个图书馆呢？有些人可能会使用它。

# objective-c - 如何在查找器中添加右键菜单

> ID：904530
> 
> 赞同：6
> 
> 时间：2009-05-24T19:56:46.057
> 
> 标签：objective-c, cocoa, macos, finder

如何在 os x finder 中的每个文件的右键菜单中添加自定义视图？

例如，如果它是图像类型，我想显示图像并执行一些自定义操作等。

这可能用c或objective-c吗？如果是的话怎么办？（不使用任何可用工具）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T20:28:55.197

您需要基于 CFPlugin编写一个[菜单管理器插件。](http://developer.apple.com/documentation/Carbon/reference/Menu_Manager/Reference/reference.html "菜单管理器参考")不幸的是，这涉及到一些真正过时的碳材料。几年前在[mactech有一个教程](http://www.mactech.com/articles/mactech/Vol.18/18.08/MenuPlugins/index.html)

请注意，这些东西可能已被 Snow Leopard 淘汰，尽管他们想出的任何东西都可能比 Menu Manager/CFPlugin cruft 更容易处理。

# version-control - 代码格式和源代码控制差异

> ID：904531
> 
> 赞同：8
> 
> 时间：2009-05-24T19:57:02.063
> 
> 标签：version-control

哪些源代码控制产品具有“差异”功能，在计算签入版本之间的差异时会忽略空格、大括号等？我似乎记得 Clearcase 的 diff 做到了这一点，但 Visual SourceSafe（或至少我使用的版本）没有。

我问的原因可能很典型。团队中四个完全合理的开发人员有四种完全不同的代码格式化方式。在检查出其他人最后更改的代码后，每个人都会立即运行某种程序或编辑器宏以按照他们喜欢的方式格式化。他们进行实际的代码更改。他们签入他们的更改。他们去度假。两天后，这个已经运行了两年的程序崩溃了。分配给该 bug 的开发人员在版本之间进行 diff 并发现 204 个差异，其中只有 3 个具有任何意义，因为 diff 算法是蹩脚的。

是的，你可以有编码标准。大多数人都觉得它们很可怕。一个每个人都可以吃蛋糕的解决方案似乎更可取。

=========

**编辑：**感谢大家的一些很好的建议。

我从中得到的是：

(1) 最好使用带有插件类型差异的源代码控制系统。

(2) 找到具有合适选项的差异。

(3) 使用良好的源格式化程序并确定签入标准。

听起来像是个计划。再次感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T20:08:53.320

Git 确实有以下选项：

*   `--ignore-space-at-eol`

    在 EOL 时忽略空格的变化。

*   `-b, --ignore-space-change`

    忽略空格数量的变化。这将忽略行尾的空格，并认为一个或多个空格字符的所有其他序列是等效的。

*   `-w, --ignore-all-space`

    比较行时忽略空格。即使一行有空白而另一行没有空白，这也会忽略差异。

我不确定是否可以使用 Git 的 diff 忽略大括号更改。

如果是 C/C++ 代码，您可以定义[Astyle规则，然后使用](http://astyle.sourceforge.net/ "艺术风格")[Astyle](http://astyle.sourceforge.net/ "艺术风格")将源代码的大括号样式转换为您想要的样式。然后A`git diff`将产生正常的输出。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T20:34:28.180

选择一个（可怕的）编码标准，把它写在一些官方的编码标准文档中，然后继续你的生活，搞乱空白不是生产性工作。

记住你是一名专业的开发人员，完成项目是你的工作，因为个人风格偏好而改变代码中的任何内容都会损害项目——它不仅会使差异化变得更加困难，还会引入难以发现的问题如果您的源格式化程序或编译器有错误（当两个同事开始争吵时，您的花哨的差异工具不会拯救您）。

如果有人不同意使用选定的风格，只需提醒他（或她）他是作为一种职业而不是作为一种爱好来编程，请参阅[http://www.ericsink.com/entries/No_Great_Hackers.html](http://www.ericsink.com/entries/No_Great_Hackers.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T20:04:28.007

也许您应该选择一种格式并在签入之前运行一些缩进工具，以便每个人都可以签出，根据自己的喜好重新格式化，进行更改，重新格式化回官方标准，然后签入？

几个额外的步骤，但他们在工作时已经使用了缩进工具。也许它可以是一个触发的签到脚本？

编辑：这也许也可以解决大括号问题。

（我自己没有尝试过这个解决方案，因此是“也许”和“也许”，但我一直在遇到同样问题的项目，尝试通过数百个不相关的变化来经历差异是一件痛苦的事仅限于空格，但包括格式本身。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T20:26:19.710

正如[git-merge 是否有可能忽略行尾差异中解释的那样？](https://stackoverflow.com/questions/861995/is-it-possible-for-git-merge-to-ignore-line-ending-differences)，将正确的差异工具与您最喜欢的 VCS 相关联更多的是问题，而不是依赖正确的 VCS 选项（即使 Git 确实有一些关于空格的选项，就像[Alan 的回答](https://stackoverflow.com/questions/904531/code-formatting-and-source-control-diffs/904554#904554)中提到的那样，它总是不会尽可能完整）。

[DiffMerge](http://sourcegear.com/diffmerge/)在那些“忽略”选项上更完整，因为它不仅可以忽略空格，还可以忽略基于给定文件中使用的编程语言的其他“变体”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T20:05:50.720

Subversion 显然支持这一点，无论是在最新版本中本机，还是通过使用像 Gnu Diff 这样的替代差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T20:17:25.237

Beyond Compare 可以做到这一点（以及更多），您可以将它集成到 Subversion 或 Sourcesafe 中作为外部差异工具。

# javascript - 图片库循环 JS

> ID：904540
> 
> 赞同：0
> 
> 时间：2009-05-24T20:00:30.620
> 
> 标签：javascript, dom

```
 var thumbs = document.getElementsByTagName("img");
    for (var i=0; i<thumbs.length; i++)
    {
        Core.addEventListener(thumbs[i], "click",  function() {alert(i);});
    } 
```

在上面的代码中，alert 总是显示 18。这是图像缩略图的数量。我希望它显示我点击了哪个缩略图。为什么不显示？我还需要将单击的缩略图的值转发给另一个函数，以便我也可以显示后续的完整图像。有人可以帮忙吗？

另外，如果有更好的方法可以做到这一点，请建议。提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T20:15:35.490

这是因为内部匿名函数关闭了变量 i，因此它会始终显示迭代的最后一个值。你接下来做：

```
Core.addEventListener(thumbs[i], "click",  (function( j) 
                                           { 
                                               return function() 
                                                      {
                                                         alert(j);
                                                      };
                                            })(i)); 
```

解释：

在您的代码中，迭代变量 i 是您为事件处理程序生成的内部匿名函数的一种全局变量，但您必须注意，尽管您似乎创建了不同的匿名函数，但所有这些变量都在查看 i 在更全局范围内和对于所有人来说，我仍然是一样的。所以最后一个值将被警告，为了避免它，我为你创建了另一个包装函数，以便将 i 的值包含在另一个范围内，因此对于不同的元素会看到不同的警告。评论中的解释也是正确的，我建议你去谷歌搜索 Javascript 关闭并阅读一些关于它的文章，一旦你知道它可能会成为非常强大的设备。

# java - 将无效字符串传递给 Java 枚举 .valueOf 调用会产生什么结果？

> ID：904546
> 
> 赞同：38
> 
> 时间：2009-05-24T20:04:30.830
> 
> 标签：java, enums

将空`String`（或其他无法识别的值，或 a `null`）传递给 Java 枚举`.valueOf`调用时会产生什么结果？

例如：

```
public enum Status
{
   STARTED,
   PROGRESS,
   MESSAGE,
   DONE;
} 
```

进而

```
String empty = "";

switch(Status.valueOf(empty))
{
   case STARTED:
   case PROGRESS:
   case MESSAGE:
   case DONE:
   {
      System.out.println("is valid status");
      break;
   }
   default:
   {
      System.out.println("is not valid");
   }
} 
```

* * *

基本上，我想知道我是否在枚举中使用 switch 语句，会调用默认情况还是会得到某种异常？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-05-24T20:15:42.680

`IllegalArgumentException`如果名称不是枚举的名称（它不会是空字符串），您应该得到一个。这是在所有枚举`valueOf`方法的 API 文档中生成的。你应该得到一个`NullPointerException`for `null`。给你的`String`变量一个虚拟值可能不是一个好主意（也不让最后一个`case`/`default`落空）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-24T20:12:55.667

我刚试过你的代码。它抛出一个`IllegalArgumentException`. 就像文档说的那样。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-25T08:06:23.017

方法：**valueOf**

```
Returns the enum constant of the specified enum type with the specified name. The name must match exactly an identifier used to declare an enum constant in this type. (Extraneous whitespace characters are not permitted.)

Parameters:
    enumType - the Class object of the enum type from which to return a constant
    name - the name of the constant to return 
Returns:
    the enum constant of the specified enum type with the specified name 
Throws:
    IllegalArgumentException - if the specified enum type has no constant with the specified name, or **the specified class object does not represent an enum type** 
    NullPointerException - if **enumType or name is null** 
```

所以它会标记这些异常，

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T07:26:57.433

Status.valueOf 的行为与[Enum.valueOf相同](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Enum.html#valueOf(java.lang.Class,%20java.lang.String))

# iphone - 我的 UIImageView 子类没有收到任何触摸事件的原因是什么？

> ID：904550
> 
> 赞同：2
> 
> 时间：2009-05-24T20:06:10.533
> 
> 标签：iphone, cocoa-touch, uikit

我已确保我的自定义 UIImageView 和 UIImageView 本身的所有超级视图都具有 userInteractionEnabled = YES;

同样在笔尖中，所有视图和子视图都有 userInteractionEnabled = YES;

但是由于某种原因，当我单击 UIImageView 时，这些永远不会被调用：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
NSLog(@"check!");
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
NSLog(@"other check");
} 
```

我有一个 UIView 作为一些子视图的分组。这会是个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T21:21:47.150

这只是一个猜测——视图层次结构中的某处是否有 UIScrollView？UIScrollViews 不像普通视图那样传递触摸事件，您必须对其进行子类化并实现自定义的 touchesBegan 方法。[你可以在这里](http://www.iphonedevsdk.com/forum/iphone-sdk-development/6686-uiscrollview-wont-respond-touch-event-scrolls-pans-but-tochesshouldbegin-ne.html)找到相关信息——这是一个让我在第一次遇到它时挠头并在谷歌上搜索了几个小时的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T22:02:29.377

过了一会儿，我发现了以下问题：

我有一个 UIView，我曾经将一些 UIImageViews 组合在一起，这样我就可以通过仅移动那个 UIView 来一次移动所有这些 UIView。我将 UIView 设置为 0.01 x 0.01 大，而它没有 clipsToBounds。当我单击在其父视图 UIView 边界之外绘制的子视图时，在这些子视图上没有接收到触摸事件。我不知道是否有任何触摸事件。

因此，如果您有同样的问题，请确保您的触摸发生在适合超级视图的区域上。在我的例子中，我只是让 UIView 分组更大，使触摸感应区域更大。在那之后，它奏效了。我现在稍微记得 Apple 曾在某处的文档中提到过，子视图可能会在其父视图之外绘制，但触摸事件只有在它们发生在父视图的矩形中时才会被识别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T20:09:55.890

看起来你有一个错字：正确的选择器名称是“touchesBegan”。您是以编程方式还是通过笔尖添加此视图？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T20:13:30.703

`touchesBegun`应该是`touchesBegan`，但我认为这只是一个错字？

尽管如此，**通常触摸不通过表示 CPU 压力过**大。尝试使用 Instruments 测试您的应用程序的性能。

# python - 使用 Python 下载文件的问题

> ID：904555
> 
> 赞同：3
> 
> 时间：2009-05-24T20:08:58.047
> 
> 标签：python, user-interface, file, download

我尝试通过单击网页上的链接来自动下载文件。单击链接后，我会看到带有“打开”、“保存”和“取消”按钮的“文件下载”窗口对话框。我想点击保存按钮。

我通过以下方式使用 Watsup 库：

```
from watsup.winGuiAuto import *

optDialog = findTopWindow(wantedText="File Download")

SaveButton = findControl(optDialog,wantedClass="Button", wantedText="Save")

clickButton(SaveButton) 
```

由于某种原因，它不起作用。有趣的是，完全相同的代码可以完美地单击“取消”按钮，但是它拒绝使用“保存”或“打开”。

有人知道我应该怎么做吗？

非常感谢，萨沙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T20:59:28.797

萨沙，

出于安全原因，您引用的文件对话框（[安全警告文件下载对话框](http://images.google.com/images?hl=en&q=save%20security%20warning)）很可能不会以这种方式响应 Windows 消息。该对话框专门设计用于仅响应用户用鼠标物理单击“确定”按钮。我想您会发现“运行”按钮也不会以这种方式工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:56:23.180

萨沙，

[此链接](http://bytes.com/groups/python/23100-windows-dialog-box-removal)上的代码应该可以工作。它使用 ctypes 而不是 watsup.winGuiAuto，并且依赖于 win32 调用。这是代码：

```
from ctypes import *
user32 = windll.user32

EnumWindowsProc = WINFUNCTYPE(c_int, c_int, c_int)

def GetHandles(title, parent=None):
'Returns handles to windows with matching titles'
hwnds = []
def EnumCB(hwnd, lparam, match=title.lower(), hwnds=hwnds):
title = c_buffer(' ' * 256)
user32.GetWindowTextA(hwnd, title, 255)
if title.value.lower() == match:
hwnds.append(hwnd)

if parent is not None:
user32.EnumChildWindows(parent, EnumWindowsProc(EnumCB), 0)
else:
user32.EnumWindows(EnumWindowsProc(EnumCB), 0)
return hwnds 
```

这是一个调用它以单击标题为“下载属性”的任何窗口上的“确定”按钮的示例（很可能有 0 或 1 个这样的窗口）：

```
for handle in GetHandles('Downloads properties'):
for childHandle in GetHandles('ok', handle):
user32.SendMessageA(childHandle, 0x00F5, 0, 0) # 0x00F5 = BM_CLICK 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T21:08:55.397

尝试这个：

```
from watsup.winGuiAuto import *
optDialog = findTopWindow(wantedText="File Download")
SaveButton = findControl(optDialog, wantedClass="Button", wantedText="Submit")
clickButton(SaveButton) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T10:05:08.377

保存按钮可能并不总是启用。虽然它可能看起来确实如此，但程序可能会看到您丢失的初始状态。检查它的状态并等待它启用。

[编辑] 但罗伯特可能是对的，出于安全原因，对话框会忽略你。在这种情况下，我建议使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)来解析 HTML，提取 URL 并使用[urllib2 模块](http://docs.python.org/library/urllib2.html)在 Python 中下载文件。

# c# - listview 打开目录

> ID：904559
> 
> 赞同：4
> 
> 时间：2009-05-24T20:12:42.500
> 
> 标签：c#

我对 C# 很陌生。我的老板让我使用 listview 作为文件浏览器编写一些代码。我试过了，它似乎有效。此代码用于打开驱动器中的文件并将其显示在 listView 上。这很简单。我还做了一个附加功能，可以清除 listView 中显示的项目。我想添加其他功能，我还可以在其中打开目录而不仅仅是文件。顺便说一下，这是我的代码示例：

```
 private void btnOpen_Click(object sender, EventArgs e)
    {
        string strSelectedPath;

        folderBrowserDialog1.ShowDialog();
        strSelectedPath = folderBrowserDialog1.SelectedPath;

        label1.Text = strSelectedPath;

        DirectoryInfo di = new DirectoryInfo(strSelectedPath);
        FileInfo[] files = di.GetFiles();

        foreach (FileInfo file in files)
        {
            listView1.Items.Add(file.Name);
        }
    }

    private void btnClear_Click(object sender, EventArgs e)
    {

        listView1.Items.Clear();
        label1.Text="";
    } 
```

你能告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T20:16:44.147

如果我正确理解了您的问题（您不仅要列出所选目录中的文件，还要列出子目录），您将需要查看 DirectoryInfo 类的[GetDirectories](http://msdn.microsoft.com/en-us/library/s7xk2b58.aspx)方法。

你可以做这样的事情，也许：

```
DirectoryInfo di = new DirectoryInfo(strSelectedPath);
// first list sub-directories
DirectoryInfo[] dirs = di.GetDirectories();
foreach (DirectoryInfo dir in dirs)
{
    listView1.Items.Add(dir.Name);
}
// then list the files
FileInfo[] files = di.GetFiles();
foreach (FileInfo file in files)
{
    listView1.Items.Add(file.Name);
} 
```

更新：我建议您将上面的代码移动到一个单独的方法中，该方法采用路径的字符串参数（类似于`ListDirectoryContents(string path)`）。在此方法中，您可以先从列表视图中清除项目，设置标签文本，然后按上述方式添加新内容。

可以从您的方法调用此`btnOpen_Click`方法，传入`folderBrowserDialog1.SelectedPath`路径参数。

我通常尽量让我的事件处理程序尽可能小，最好不执行任何实际工作，而只是调用一些其他方法来完成工作。这为从其他地方触发相同的功能开辟了更多空间。

例如，假设您的应用程序可以将路径作为命令行参数，那么`ListDirectoryContents`与在表单中复制相同行为相比，仅使用命令行调用路径将是更简洁的代码。

该方法的完整代码示例：

```
private void btnOpen_Click(object sender, EventArgs e)
{
    string path = BrowseForFolder();
    if (path != string.Empty)
    {
        ListDirectoryContent(path);
    }
}

private string BrowseForFolder()
{
    FolderBrowserDialog fbd = new FolderBrowserDialog();
    if (fbd.ShowDialog() == DialogResult.OK)
    {
        return fbd.SelectedPath;
    }
    return string.Empty;
}

private void ListDirectoryContent(string path)
{
    label1.Text = path;
    listView1.Items.Clear();
    DirectoryInfo di = new DirectoryInfo(path);
    // first list sub-directories
    DirectoryInfo[] dirs = di.GetDirectories();
    foreach (DirectoryInfo dir in dirs)
    {
        listView1.Items.Add(dir.Name);
    }
    // then list the files
    FileInfo[] files = di.GetFiles();
    foreach (FileInfo file in files)
    {
        listView1.Items.Add(file.Name);
    }

} 
```

这段代码的好处是，当您需要浏览文件夹时，您可以重用 BrowseForFolder 方法，因为它只是返回选定的路径，并且与该路径的用途无关。同样，ListDirectoryContent 方法完全不知道路径参数来自何处；它可能来自文件夹浏览器，也可能来自命令行或其他任何地方。

如果您专注于让您的方法只执行它们的“核心任务”，依靠输入参数获取它们需要的任何附加信息，您将获得更易于重用和维护的代码。

对于事件处理程序（例如 btnOpen_Click），我喜欢将它们视为触发器；他们触发了事情的发生，但他们自己并没有真正做很多事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T20:19:31.143

DirectoryInfo 类包含一个 GetDirectories 方法和一个 GetFiles 方法。请参阅下面的原始代码示例，修改为添加目录：

```
private void btnOpen_Click(object sender, EventArgs e)
{
    string strSelectedPath;
    folderBrowserDialog1.ShowDialog();
    strSelectedPath = folderBrowserDialog1.SelectedPath;
    label1.Text = strSelectedPath;
    DirectoryInfo di = new DirectoryInfo(strSelectedPath);
    FileInfo[] files = di.GetFiles();
    DirectoryInfo[] directories = di.GetDirectories();

    foreach (DirectoryInfo directory in directories)
    {
        listView1.Items.Add("Directory " + directory.Name);
    }
    foreach (FileInfo file in files)
    {
        listView1.Items.Add(file.Name);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T20:19:49.023

我相信这就是你想要的？

```
 DirectoryInfo[] directories = di.GetDirectories();
    foreach (DirectoryInfo directory in directories)
    {
        listView1.Items.Add(directory.Name);
    } 
```

# c++ - Shmem vs tmpfs vs mmap

> ID：904581
> 
> 赞同：15
> 
> 时间：2009-05-24T20:30:47.080
> 
> 标签：c++, linux, mmap

有人知道以下三个在速度方面的比较：

*   共享内存

*   tmpfs (/dev/shm)

*   映射 (/dev/shm)

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-24T22:25:19.160

`tmpfs` [在这里](http://lwn.net/2001/1206/a/tmpfs.php3)阅读。以下内容是从那篇文章中复制而来，特别解释了共享内存之间的关系`tmpfs`。

```
1) There is always a kernel internal mount which you will not see at
   all. This is used for shared anonymous mappings and SYSV shared
   memory. 

   This mount does not depend on CONFIG_TMPFS. If CONFIG_TMPFS is not
   set the user visible part of tmpfs is not build, but the internal
   mechanisms are always present.

2) glibc 2.2 and above expects tmpfs to be mounted at /dev/shm for
   POSIX shared memory (shm_open, shm_unlink). Adding the following
   line to /etc/fstab should take care of this:

    tmpfs   /dev/shm    tmpfs   defaults    0 0

   Remember to create the directory that you intend to mount tmpfs on
   if necessary (/dev/shm is automagically created if you use devfs).

   This mount is _not_ needed for SYSV shared memory. The internal
   mount is used for that. (In the 2.3 kernel versions it was
   necessary to mount the predecessor of tmpfs (shm fs) to use SYSV
   shared memory) 
```

因此，当您实际使用 POSIX 共享内存（我之前也使用过）时，`glibc`将在 处创建一个文件`/dev/shm`，用于在应用程序之间共享数据。它返回的文件描述符将引用该文件，您可以传递给`mmap`它以告诉它将该文件映射到内存中，就像它可以对任何“真实”文件一样。因此，您列出的技术是互补的。他们没有竞争。`Tmpfs`只是提供内存文件作为`glibc`.

例如，我的盒子上正在运行一个进程，当前注册了这样一个共享内存对象：

```
# pwd
/dev/shm
# ls -lh
insgesamt 76K
-r-------- 1 js js 65M 24\. Mai 16:37 pulse-shm-1802989683
# 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T21:30:20.533

“这取决于。” 一般来说，它们都在内存中，并且依赖于系统实现，因此对于大多数用途而言，性能可以忽略不计并且特定于平台。如果您真的关心性能，您应该分析并确定您的要求。用另一种方法替换这些方法中的任何一种都非常简单。

也就是说，共享内存是最不密集的，因为不涉及文件操作（但同样，非常依赖于实现）。如果您需要多次打开和关闭（映射/取消映射）*，*那么这可能会产生很大的开销。

干杯!
肖恩

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T21:43:13.957

“共享内存”是指 System V 共享内存，对吗？

我认为当你使用它时 Linux mmap 是一个隐藏的 tmpfs，所以它实际上与 mmaping 一个 tmpfs 相同。

在 tmpfs 上执行文件 I/O 会受到惩罚……主要是（在某些特殊情况下它可能有意义，例如在 32 位进程中 >4G）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-24T21:15:20.813

tmpfs 是最慢的。共享内存和 mmap 的速度是一样的。

# java - Java foreach 效率

> ID：904582
> 
> 赞同：22
> 
> 时间：2009-05-24T20:30:56.597
> 
> 标签：java, performance, loops, foreach, premature-optimization

我有这样的事情：

```
Map<String, String> myMap = ...;

for(String key : myMap.keySet()) {
   System.out.println(key);
   System.out.println(myMap.get(key)); 
} 
```

所以在**foreach 循环**`myMap.keySet()`中被调用一次？我认为是，但想听听你的意见。

 **我想知道以这种方式使用 foreach ( `myMap.keySet()`) 是否会对性能产生影响，或者它相当于：

```
Set<String> keySet = myMap.keySet();
for (String key : keySet) {
   ...
} 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-05-24T20:34:17.107

如果您想绝对确定，则双向编译并反编译并进行比较。我使用以下来源做到了这一点：

```
public void test() {
  Map<String, String> myMap = new HashMap<String, String>();

  for (String key : myMap.keySet()) {
    System.out.println(key);
    System.out.println(myMap.get(key));
  }

  Set<String> keySet = myMap.keySet();
  for (String key : keySet) {
    System.out.println(key);
    System.out.println(myMap.get(key));
  }
} 
```

[当我用Jad](http://www.varaneckas.com/jad)反编译类文件时，我得到：

```
public void test()
{
    Map myMap = new HashMap();
    String key;
    for(Iterator iterator = myMap.keySet().iterator(); iterator.hasNext(); System.out.println((String)myMap.get(key)))
    {
        key = (String)iterator.next();
        System.out.println(key);
    }

    Set keySet = myMap.keySet();
    String key;
    for(Iterator iterator1 = keySet.iterator(); iterator1.hasNext(); System.out.println((String)myMap.get(key)))
    {
        key = (String)iterator1.next();
        System.out.println(key);
    }
} 
```

所以这就是你的答案。它以任一 for 循环形式调用一次。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-24T20:57:19.757

它只被调用一次。事实上，它使用了一个迭代器来解决这个问题。

此外，在你的情况下，我认为你应该使用

```
for (Map.Entry<String, String> entry : myMap.entrySet())
{
    System.out.println(entry.getKey());
    System.out.println(entry.getValue());
} 
```

避免每次都在地图中搜索。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-24T20:38:25.303

`keySet()`只调用一次。“增强的 for 循环”基于`Iterable`接口，它用于获取一个`Iterator`，然后用于循环。甚至不可能以任何其他方式迭代 a `Set`，因为没有索引或任何可以获取单个元素的东西。

然而，你真正应该做的是完全放弃这种微优化的担忧——如果你遇到真正的性能问题，大约 99% 的机会是你自己从未想过的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-01-14T03:39:00.727

答案在 Java 语言规范中，不需要反编译 :) 这是我们可以阅读[的关于增强的 for 语句的](http://java.sun.com/docs/books/jls/third_edition/html/statements.html#14.14.2)内容：

> 增强的 for 语句具有以下形式：
> 
> ```
> EnhancedForStatement:
>         for ( VariableModifiersopt Type Identifier: Expression) Statement 
> ```
> 
> 表达式必须具有类型 `Iterable`，否则它必须是数组类型（第 10.1 节），否则会发生编译时错误。
> 
> 在增强`for`语句（第 14.14 节）的 FormalParameter 部分中声明的局部变量的范围是包含的语句
> 
> 增强语句的含义`for` 通过翻译成基本`for`语句来给出。
> 
> 如果 的 类型*`Expression`*是 的子类型`Iterable`，则令*`I`*为表达式 *Expression 的类型。*`iterator()`. 增强`for`语句等价于`for`以下形式的基本语句：
> 
> ```
> for (I #i = Expression.iterator(); #i.hasNext(); ) {
> 
>         VariableModifiersopt Type Identifier = #i.next();
>    Statement
> } 
> ```
> 
> where*`#i`*是一个编译器生成的标识符，它与增强 for 语句发生时范围内（第 6.3 节）内的任何其他标识符（编译器生成的或其他标识符）不同。
> 
> 否则，表达式必须具有数组类型，*`T[]`*。让*`L1 ... Lm`* 是紧接在增强`for`语句之前的（可能为空的）标签序列。那么增强的for语句的含义由以下基本`for` 语句给出：
> 
> ```
> T[] a = Expression;
> L1: L2: ... Lm:
> for (int i = 0; i < a.length; i++) {
>         VariableModifiersopt Type Identifier = a[i];
>         Statement
> } 
> ```
> 
> 其中*a*和*i*是编译器生成的标识符，与增强 for 语句发生时范围内的任何其他标识符（编译器生成或其他）不同。

在您的情况下，`myMap.keySet()`返回一个子类型，`Iterable`因此您的增强`for`语句等效于以下基本`for`语句：

```
for (Iterator<String> iterator = myMap.keySet().iterator(); iterator.hasNext();) {
   String key = iterator.next();

   System.out.println(key);
   System.out.println(myMap.get(key)); 
} 
```

因此`myMap.keySet()`只被调用一次。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-24T20:33:05.783

是的，无论哪种方式都只调用一次

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-24T20:35:03.453

我相信它的编译器经过优化，每个循环条目只运行一次。

# c# - C# 扩展方法不适用于增量和减量方案，是设计使然吗？

> ID：904587
> 
> 赞同：3
> 
> 时间：2009-05-24T20:33:47.997
> 
> 标签：c#, extension-methods

我正在尝试一个简单的扩展方法示例，但无法增加或减少 int。这是代码

```
static class ExtensionMethodsExp
{
    public static void Print(this object o)
    {
        Console.WriteLine("This is print: {0}", o.ToString());
    }

    public static int Double(this int i)
    {
        return i * 2;
    }
    public static int Decrement(this int i)
    {
         return i--;
    }

    public static int Increment(this int i)
    {
        return i++;

    }
} 
```

}

程序代码是

```
class Program
{
    static void Main(string[] args)
    {

       int myNumber = 10;
       myNumber.Print();

       myNumber = myNumber.Double();
       myNumber.Print();

       myNumber = myNumber.Decrement(); 
       myNumber.Print();

       myNumber = myNumber.Increment();
       myNumber.Print();

       myNumber.Increment().Double().Print();
       Console.ReadKey();
    }
} 
```

我得到以下输出

这是印刷品：10

这是印刷品：20

这是印刷品：20

这是印刷品：20

这是印刷品：40

知道为什么 Decrement 或 Increment 不应该在这里工作。有什么我想念的吗？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T20:36:46.740

试试这个：

```
public static int Decrement(this int i)
{
     return --i;
}

public static int Increment(this int i)
{
    return ++i;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T20:43:11.003

您的代码不起作用的原因是您使用增量和减量运算符的方式。

当你写：

```
return i++; 
```

在增量发生之前返回 i 的值。

试试这个：

```
return ++i; 
```

或者更好的是，这个：

```
return i + 1; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T20:43:52.420

这不是参考问题，因为您将返回值分配回该值。

这里的问题是使用*后*`i++`会增加。在这种情况下，它被返回，然后递增。由于变量是值类型，因此只有 Increment() 中的局部变量才被递增。

 *如果您使用`++i`，则本地成员会递增*然后*返回，这正是您所期望的。

话虽如此，将您的方法命名为 Increment 或 Decrement 会令人困惑，因为它不会自动将值分配回原始值。~~你有没有试过通过`ref this i`？我不知道在这种情况下是否可以使用 ref，但它可能会使方法命名更准确。~~ [Eric Lippert](https://stackoverflow.com/users/88656/eric-lippert)挫败了这个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T20:44:59.300

这是因为 i++ 直到函数被完全评估*后*才会增加数字。不幸的是，在您的示例中，您返回了原始值，而增加的值在堆栈中丢失了！

++i在函数计算*之前递增 i。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T20:46:57.453

`++i`方法：

*   增加 i 的值
*   返回增加的值

`i++`方法：

*   记住 i 的当前值
*   增加 i 的值
*   记住 i 的前一个值（即在你增加它之前）

一种称为“前增量”运算符，另一种称为“后增量”运算符。

# windows - 首次开发简单的 Windows 应用程序需要什么 IDE？

> ID：904592
> 
> 赞同：7
> 
> 时间：2009-05-24T20:35:17.133
> 
> 标签：windows, ide

我从未做过任何 Windows 编码，我想试一试。创建一个简单的应用程序，例如一个显示普通“Hello World”消息的窗口。

我需要从什么 IDE（开源？）开始，原生 Windows 应用程序使用什么语言？

这不是专业用途，仅供业余爱好者使用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-24T20:37:51.590

我推荐使用 Visual Studio Express，您可以使用 c#、Visual Basic (VB.NET) 或 c++，它免费且简单。如果您打算这样做，它还可以让您更轻松地迈向更大的 Visual Studio。

查看[Microsoft Visual Studio Express](http://www.microsoft.com/Express/)

编辑：添加了 VB.NET

反正我在编辑，添加一些东西怎么样？如果您更喜欢开源，您还可以查看[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)（c# 和 boo）和/或[monodevelop](http://monodevelop.com/)（c#，但更适合 linux/multiplatform，仅适用于 windows 恕我直言，但您的里程可能会有所不同）

编辑：6年后。

与此同时，微软为我们提供了[Visual Studio Community Edition](https://www.visualstudio.com/en-us/products/visual-studio-community-vs.aspx)，它本质上是一个完整的 Visual Studio 专业版，但免费（[有一些限制](https://softwareengineering.stackexchange.com/questions/262916/understanding-visual-studio-community-edition-license)）。我确实相信这是现在开发大多数非商业项目的绝对最佳方式，并且可能是一些你可以获得的商业、面向 Windows 的项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T20:42:28.540

记事本 + .NET 框架 + cmd

类型：

```
using System.Windows.Forms;
public class HelloWorld
{
     public static void Main()
     {
        MessageBox.Show("Hello, World!");
      }
} 
```

另存为 %WINDIR%\Microsoft.NET\Framework\vX.X.XXXXX\hello.cs

打开命令行

> cd %WINDIR%\Microsoft.NET\Framework\vX.X.XXXXX %homedrive%

编译：

> csc /目标：winexe hello.cs

跑：

> 你好

如果您正在寻找开源 IDE，我推荐带有插件的 Eclipse 或[MonoDevelop](http://monodevelop.com/)（[维基百科](http://en.wikipedia.org/wiki/MonoDevelop)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T20:39:27.017

那里有很多 IDE，如果你想为 windows 开发，我推荐 .net 和免费的“express”系列 Microsoft 工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T21:24:32.590

如果您是 gui 编程的新手，[Shoes](http://shoooes.net/)是一种有趣的方式来学习一些概念并在此过程中学习一些 ruby​​。然而，它主要是一个学习工具，所以当你准备好开发一个功能性的 Windows 应用程序时，你最终需要学习 Visual Studio（或类似的东西）。

* * *

编辑：我看到你从你的一个评论中在 linux 中做了一些编程，所以这对你来说可能有点太初级了。对于任何刚接触编程并想尝试 Windows 程序的人来说，Shoes 都值得一看。Visual Studio 的免费版本绝对是您想要查看的内容，或者您​​也可以继续在 Windows 上使用 Eclipse，因为您已经熟悉它了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T21:34:51.303

尝试[AutoIt](http://www.autoitscript.com/AutoIt/)或[AutoHotkey](http://www.autohotkey.com/)。我个人推荐 AutoHotkey。

有关大量示例（并且有用！）脚本，请访问此页面： http: [//www.donationcoder.com/Software/Skrommel/](http://www.donationcoder.com/Software/Skrommel/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T20:48:13.457

您可以查看 VBScript，使用记事本编辑代码。它的编程非常简单，并且有很多示例。

Hello World 将通过将以下内容放入名为 HelloWorld.vbs 的文件中并从资源管理器窗口中双击它来完成。

```
MsgBox("Hello World") 
```

然后将显示一个带有 hello world 的消息框。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T20:58:16.603

有 wxDev-Cpp IDE（谷歌）。它非常适合小型应用程序。它基于 wxWidgets，因此您还可以免费获得可移植性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T21:14:25.387

如果您正在寻找开源和跨平台兼容性，我会考虑 Eclipse。但是，如果您只是想要“免费”，我也会看看 IntelliJ IDE，它专为 JAVA 开发而设计，也是跨平台但不是开源的。他们提供一些免费的许可版本。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-24T20:41:39.290

您不必使用 IDE 来创建 Hello World gui 应用程序。

Qt、wxWidgets、GTK+ 等库允许您编写此类程序，并且它们的教程通常有一些示例“hello word”程序。

### 更新

我相信大多数 GUI 库（尝试）保持平台原生的外观和感觉；或者至少这是文档所说的。

# regex - Linux/HPUX 中的正则表达式

> ID：904604
> 
> 赞同：0
> 
> 时间：2009-05-24T20:40:34.550
> 
> 标签：regex, sed

Linux 和 HPUX 上的正则表达式有区别吗？

我在 sed 中使用它们。

我正在尝试以下仅适用于 Linux 的方法：

> sed -e "s/^\s *ant\s* $/#ant/g" Makefile

现在我看到，如果我删除“^”，那么它也可以在 HP 上运行。据我了解，这应该得到双方的支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T20:52:41.653

你在哪里使用它们？在 sed? 使用某种脚本语言（比如 perl）？别的地方？问题不清楚。您必须发布您的实际正则表达式，或者更好的示例脚本/输入/输出。无论如何，`\s`我想，代表“空白”，这取决于语言环境，也许还有其他因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-29T21:13:09.193

简短的回答是“是的，可能有区别”。

长答案：

这取决于您在每台机器上使用的 sed 版本，而不是机器运行的操作系统。

根据我的经验，我发现安装在 HP-UX 之类的工具包（即 sed、grep、awk 等）上的工具包通常不如大多数流行的 Linux 发行版上的版本。

我的猜测是，在 HP-UX 上，您使用的是 HP 构建的 sed 版本，而您在 Linux 上使用的是 GNU sed。您要么需要了解 HP 版本能做什么或不能做什么，并在 Linux 上找到与您的版本的共同点，或者看看您是否可以将 GNU 版本安装在您的 HP 机器上的某个位置。

至于您提供的特定正则表达式，以及任何正则表达式问题，如果您还提供一些示例文本以匹配并说明您期望正则表达式完成的内容，这将有所帮助。

# apache - 为什么运行“apachectl -k start”不起作用，但“sudo apachectl -k start”起作用？

> ID：904606
> 
> 赞同：0
> 
> 时间：2009-05-24T20:40:50.337
> 
> 标签：apache, aptana, sudo

我正在使用默认安装的 Apache 在我的 OS X 上工作。出于某种原因，当我在没有“sudo”的情况下运行“apachectl”命令时，我得到“没有可用的监听套接字/无法打开日志”。我猜这是一个许可的事情，所以有人可以帮助我吗？我正在使用 Apache 2.2。

另外，附带问题，基本上是 linux 执行的“exe”的 Apache 脚本文件在哪里？我正在尝试将我的服务器与 Aptana Studio 集成，它需要 Apache 安装的路径。我知道在 Windows 中，这将是“C:\path\to\httpd.exe”，但我不知道它在 linux 中是如何工作的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T20:43:29.753

您的服务器是否在侦听端口 80？（通常）只有 root 被允许打开低于 1024 的端口。因此需要[`sudo`](http://linux.die.net/man/8/sudo).

如您[所见](http://www.google.nl/search?q=root+port+below+1024)，很多人想知道如何解决这个问题。一种可能的解决方案是在路由器上执行端口转发。（我在这里假设您在路由器后面......）。然后端口 80 上的传入连接可以转发到例如端口 8080。因此，只有在本地需要连接到端口 8080。（可能有更优雅的解决方案......其他人会发布它们。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T21:07:40.830

我认为通常（在 OS X 和 Linux 上 - 我不确定你指的是哪一个）httpd 二进制文件位于：/usr/sbin/httpd

如果您需要能够重新启动 Apache，并且您不能以 root 身份执行此操作（无论出于何种原因..），那么您可能不得不接受一个非“知名”端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-17T04:15:41.247

试试这个

（使用 php）$a = shell_exec('sudo -u root -S /etc/init.d/apache2 restart < /home/$user/passfile');

密码应存储在密码文件中

# apache - 如何重写其中包含 GET 变量的 URL？

> ID：904614
> 
> 赞同：0
> 
> 时间：2009-05-24T20:44:56.787
> 
> 标签：apache, .htaccess, mod-rewrite

我有一个使用 GET 变量来确定要显示的内容的站点。

```
@session_start();
@extract($_GET);
@extract($_POST);
.
.
.
if (!$menu) { include("home.php"); }
if ($menu=='buy') { include("buy.php"); }
if ($menu=='invalidbuy') { include("invalidbuy.php"); }
if ($menu=='buydone') { include("buydone.php"); }
.
.
. 
```

我想我必须使用 .htaccess 文件将我的 URL 从“/index.php?menu=faq”重命名为“/faq”。我怎样才能做到这一点？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T20:50:01.207

您可以使用以下[规则](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)将任何路径请求重写为`/`*`foobar`*内部路径`/index.php?menu=`*`foobar`*：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^[^/]+$ index.php?menu=$1 [L] 
```

附加[`RewriteCond`指令](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)确保仅`!-f`重写不存在的文件 ( )。

# php - Drupal 主题的好指南在哪里？

> ID：904616
> 
> 赞同：2
> 
> 时间：2009-05-24T20:45:11.577
> 
> 标签：php, drupal

我是 Drupal 的新手，坦率地说，在阅读了 Drupal 文档之后，他们的主题指南并不是那么有帮助。也许我只是误解了，但似乎您始终可以访问某些变量以及您可以定义不同的函数来覆盖或实现行为。

长话短说，我希望能够追踪 Drual 主题代码以了解它的工作原理。看起来应该不是那么困难，但我很难找到一个好的参考。有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T15:57:14.730

There are a few different resources you can use that might help out:

*   You can use the irc channel on freenode: #drupal-themes
*   A module that I hear a lot of themers like is the Devel module - [http://drupal.org/project/devel](http://drupal.org/project/devel). This is what will allow you to trace through the code and see what variables, function calls, etc. are being used.
*   You might also want to check out the [Druapl 6 Themes](https://rads.stackoverflow.com/amzn/click/com/1847195660) book

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T21:19:22.943

[http://www.nerdliness.com/article/2007/09/10/drupal-theming](http://www.nerdliness.com/article/2007/09/10/drupal-theming)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-10T01:00:18.987

I'd recommend [Front End Drupal: Designing, Theming, Scripting](https://rads.stackoverflow.com/amzn/click/com/0137136692) over the Drupal 6 Themes book. I put together a [Drupal 6 Theming Cheat Sheet](http://www.minezone.org/blog/2009/02/04/drupal-6-theming-cheat-sheet/) that includes links to the resources I've found most helpful.

Honestly, though there are good links and books to learn from, the way I've learned quickest was to start creating a theme. Create your [theme.info](http://drupal.org/node/171205) file, then begin converting an index.html to [page.tpl.php](http://api.drupal.org/api/drupal/modules--system--page.tpl.php/6) or [page-front.tpl.php](http://www.devdaily.com/blog/post/php/how-customize-content-front-page-drupal) using the snippets in the cheat sheet or the nerliness.com link mentioned in Robert Harvey's answer. Those two files constitute a bare-bones theme.

From there, you can override additional template files as needed. You can use the [Theme developer](https://drupal.org/project/devel_themer) to find just what [templates to override](http://drupal.org/node/190815), to customize a particular part of the site. Remember to [clear the theme cache](http://drupal.org/node/337176), as you add new template files.

Also, make sure your theme has the base template of any file you want to override. See the "*Note: There is a bug which prevents derivative template files from being detected*..." section of the [Core templates and suggestions](http://drupal.org/node/190815) page, for more details.

# ruby-on-rails - 在 Rails 上，除了 <%= %> 标签之外，还有什么方法可以输出内容吗？

> ID：904618
> 
> 赞同：1
> 
> 时间：2009-05-24T20:47:06.377
> 
> 标签：ruby-on-rails, erb

似乎在 Rails 或 erb 上，输出任何东西的唯一方法是通过 <%= %>

<% puts "hello" %> 不会工作，不像 PHP。

还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T21:16:17.037

concat 会做：

```
<% concat ("wah ha ha!") %> 
```

参考：
[http ://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#M001710](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#M001710)

从源代码，

```
<% output_buffer << "hmm" %> 
```

也可以工作并且已经过测试......但我认为这是更低的水平，应该避免。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T21:06:33.280

常规的响应对象确实存在于幕后，您*可以*调用 response.write(str)。但是，RoR 的很大一部分优点在于，这些具体细节已为您抽象出来，而您不必这样做。

# linux - “apachectl”代表什么？为什么不只是“apache”？

> ID：904621
> 
> 赞同：15
> 
> 时间：2009-05-24T20:49:23.877
> 
> 标签：linux, apache

这应该很容易，只是好奇。我知道“httpd”是HTTP守护进程，只是好奇“httpd”和“apachectl”之间的关系。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-24T20:52:50.920

它是 apache control(ler?) 的缩写。它告诉 apache 要做什么，但它不是服务本身。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-24T20:53:15.243

`httpd`是实用的守护进程。这是真正完成工作的部分。`apachectl`是如何控制这个守护进程，并对其进行操作。它只是一个控制界面，而不是真正的程序本身。

从手册页：

> apache2ctl 是 Apache 超文本传输​​协议 (HTTP) 服务器的前端。它旨在帮助管理员控制 Apache apache2 守护程序的功能。

（我的机器上有 apache2 但它是一样的）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-24T20:54:10.920

[apachectl](http://httpd.apache.org/docs/1.3/programs/apachectl.html) - Apache HTTP 服务器**控制**接口

看起来这只是一个旧的命名约定。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T20:53:31.950

该程序`apachectl`有助于控制 Apache HTTPD 守护程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T20:55:48.140

服务器二进制文件本身`httpd`在上游发行版中被调用，但`apache2`在其他发行版中，例如 debian 包中。

`apachectl`或`apache2ctl`（ctl 代表**c** on **t** ro **l**）是一个允许启动/停止/等的 shell 脚本。一堆`httpd`或`apache2`过程。

# c# - 控制自定义控件的呈现

> ID：904623
> 
> 赞同：2
> 
> 时间：2009-05-24T20:51:51.813
> 
> 标签：c#, winforms

我希望详细视图中的所有标签都是粗体的。我创建了一个简单的自定义标签控件，强制字体为粗体。这对我来说有一种代码气味的感觉。我不关心开发人员能够自定义自定义控件（baseDetailLabel）。我只想为详细标签强制执行应用程序范围的标准（它们必须是粗体的）。在控件初始化时强制字体样式是否合适，或者我应该在另一种方法中执行此操作？我确实希望设计师能看到这种风格。

```
public class BaseDetailLabel : System.Windows.Forms.Label
{
    public BaseDetailLabel()
    {
        System.Drawing.Font f = new Font(this.Font,FontStyle.Bold);
        this.Font = f;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T21:19:21.710

从描述中，我认为您也有不想加粗的标签。在这种情况下，一个单独的 Control 类似乎是最好的方法。

简单的构造方法不会阻止覆盖，只是设置一个初始值。我认为这就是你想要的。要强制加粗，您必须重写 OnPaint 方法。

关于气味：它不是花哨的，但它与领土有关。你正在执行一个没有好的（更好的）攻击方式的风格规则。除非你想建立一个完整的 Style 系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T21:44:29.303

这应该没问题。但是，我可能会提醒您，您可能需要在某处放置字体。字体是需要处理的图形对象 - 我不确定标签的破坏是否会自动为您完成。

# hibernate - 使用一个实体（及其主键）作为另一个实体的 ID

> ID：904634
> 
> 赞同：5
> 
> 时间：2009-05-24T20:55:32.460
> 
> 标签：hibernate, jpa, annotations, entity

所以，我不知道如何问这个问题，因为似乎很容易找到这个问题的答案。

我有 3 张桌子；ContentHeader、ContentType1 和 ContentType2。ContentHeader 有一个主要的自动增量键。ContentType1 和 ContentType2 都维护 ContentHeader 主键的外键。这些外键也是它们各自表的主键。

```
CREATE TABLE contentHeader (contentID INT AUTO_INCREMENT PRIMARY KEY, ...) ENGINE=InnoDB;

CREATE TABLE contentType1 (contentID INT PRIMARY KEY, FOREIGN KEY (contentID) REFERENCES contentHeader (contentID), ...) ENGINE=InnoDB;

CREATE TABLE contentType2 (contentID INT PRIMARY KEY, FOREIGN KEY (contentID) REFERENCES contentHeader (contentID), ...) ENGINE=InnoDB; 
```

我创建了四个类：

```
@Entity
public class ContentHeader {

  @Id
  @GeneratedValue
  protected int contentID;

  ...
}

@Entity
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
public abstract class Content {

  @Id
  @OneToOne
  protected ContentHeader contentHeader;

  ...
}

@Entity
public class ContentType1 extends Content {
  ...
}

@Entity
public class ContentType2 extends Content {
  ...
} 
```

这会在尝试生成架构时抛出一个空指针。我很确定我只是缺少一些简单的东西。我注意到 PrimaryKeyJoinColumn，但我不确定它是否是我需要的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-25T10:16:58.867

您可以创建一个只有 ContentHeader 的复合 id 类：

```
@Embeddable
public class ContentKey implements java.io.Serializable {

    @ManyToOne(cascade = {}, fetch = FetchType.LAZY)
    @JoinColumn(name = "ID", updatable = true)
    private ContentHeader header;
    // ...
}

@Entity
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
public abstract class Content {

    @Id
    public ContentKey  getContentKeyId()
    // ...
} 
```

这应该够了吧。

# c++ - 字符数组中的线性搜索——C++ (Visual Studio 2005)

> ID：904641
> 
> 赞同：1
> 
> 时间：2009-05-24T20:58:30.957
> 
> 标签：c++, arrays, search, visual-c++-2005

我对 C++ 编程非常陌生，你会明白为什么。

我想制作一个由几个单词组成的字符数组，我想使用线性搜索函数进行搜索。这个数组必须是二维数组吗？例如：

```
char Colors[3][6] = {"red", "green", "blue"}; 
```

我试过这样：

```
char Colors[] = {"red", "green", "blue"}; 
```

这给了我一个“太多的初始化程序”错误。

我假设第一种方法是正确的，因为它说明了数组中元素的数量和元素的最大长度，对吗？

现在我将如何实现一个线性搜索函数来在该数组中查找一个单词？我可以执行以下操作：

（假设已经声明了linearSearch函数）

```
char searchKey;  
char element;

char Colors[3][6] = {"red", "green", "blue"};

printf("Enter the color to look for: \n");

scanf("%s", searchKey);

element = linearSearch(Colors, searchKey, ??); //?? is where I don't know what to enter

if (element != -1)  
{  
    printf("Found the word.\n");  
}  
else  
{  
    printf("Didn't find the word.\n");  
} 
```

这可能吗？如果是这样，该声明将寻找什么 linearSearch 函数？我希望我提供了足够的信息以使其有点可用。

编辑：感谢大家的帮助，让程序按预期工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-24T21:04:28.840

我建议学习 C++ 标准库，这对你很有帮助。例如，

```
#include <vector>
#include <string>
#include <algorithm>
#include <iostream>

using namespace std;

vector<string> words;
words.push_back("red");
words.push_back("blue");
words.push_back("green");

if (find(words.begin(), words.end(), "green") != words.end())
    cout << "found green!"
else
    cout << "didn't find it"; 
```

为什么要`linearSearch`自己实施？c++ 已经`std::find`为您提供了它！此外，如果您使用 a`set`而不是 a `vector`，您现在可以使用`std::binary_search`which is O(log n) 而不是 O(n)，因为集合是排序的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T21:22:48.007

要声明一个字符串数组，请使用此语法

```
 char *Colors[] = {"red", "green", "blue"}; 
```

这是一个指向字符的指针数组（“Hi”计算为指向“H”的 const char*）。编译器将计算出存储数组需要多少元素（因此是 []），在这种情况下，它的大小始终为 3。

总的来说，我同意 rlbond 的回答——你应该使用 STL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T21:05:43.190

您可以使您的 linearSearch 函数返回数组中搜索词的索引。这是一个示例程序：

```
#include <stdio.h>
#include <string.h>

int linearSearch (const char **Array, const char *searchKey, int arraySize) {
    for (int i = 0; i < arraySize; ++i) {
        if (strcmp(Array[i], searchKey) == 0)
            return i;
    }

    // We didn't find the searchKey in the Array
    return -1;
}

int main () {
    char *colors[] = { "red", "green", "blue" };

    int index = linearSearch (colors, "green", 3);

    if (index < 0) { // search string was not found
        printf("Search string not found!\n");
    }
    else {
        printf("String %s found at index %d\n", colors[index], index);
    }

    return 0;
} 
```

我们使用 strcmp() 函数来比较字符串。如果字符串匹配则返回零，如果不匹配则返回非零。要使用它，您需要包含`string.h`标题。

但是，正如其他人所建议的那样，您应该尽可能使用 STL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T21:26:49.153

不，您不需要二维数组。

这是一种声明字符串数组的方法：

```
char* Colors[3] = {"red", "green", "blue"}; 
```

或者

```
char* Colors[] = {"red", "green", "blue"}; // the compiler will figure out the size

int colors = sizeof(Colors)/sizeof(Colors[0]); 
```

在尝试过 C++ 之后，您应该立即学习使用 STL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T21:03:40.743

[本文](http://www.learning-computer-programming.blogspot.com/2007/06/string-searching-function-in-c.html)包含字符串搜索功能。它还应该让您深入了解如何正确构建字符数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T21:15:16.743

如果您不想使用字符串，而使用 char 数组，则可以使用[strcmp](http://www.cplusplus.com/reference/clibrary/cstring/strcmp/)来比较 2 个单词。[strcmp](http://www.cplusplus.com/reference/clibrary/cstring/strcmp/)要记住的是它返回找到单词的位置的索引，所以如果你只想在开头找到单词，你可以这样做：

```
for(int i=0;i<SizeOfColorArray;i++)
{
    if(strcmp (MySearchTerm,colors[i]) == 0)
    {
        // it was  a match
        return i;
    }
} 
```

根据您正在做什么以及您的数组将获得多大，您应该考虑考虑使用字符串的[散列](http://en.wikipedia.org/wiki/Hash_function)来提高性能。

# python - 如何在python中解析格式错误的HTML

> ID：904644
> 
> 赞同：15
> 
> 时间：2009-05-24T20:59:27.150
> 
> 标签：python, html, lxml

我需要浏览已解析 HTML 文档的 DOM 树。

在使用 lxml 解析字符串之前，我正在使用 uTidyLib

a = tidy.parseString(html_code, options) dom = etree.fromstring(str(a))

有时我得到一个错误，似乎 tidylib 无法修复格式错误的 html。

如何在不出错的情况下解析每个 HTML 文件（仅解析无法修复的文件的某些部分）？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-24T21:06:13.437

[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)可以很好地处理无效/损坏的 HTML

```
>>> from BeautifulSoup import BeautifulSoup
>>> soup = BeautifulSoup("<htm@)($*><body><table <tr><td>hi</tr></td></body><html")
>>> print soup.prettify()
<htm>
 <body>
  <table>
   <tr>
    <td>
     hi
    </td>
   </tr>
  </table>
 </body>
</htm> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-24T22:52:08.717

既然你已经在使用 lxml，你有没有尝试过[lxml 的](http://lxml.de/) [ElementSoup](http://lxml.de/elementsoup.html)模块？

如果 ElementSoup 无法修复 HTML，那么您可能需要首先应用您自己的过滤器，这些过滤器基于您自己对数据损坏方式的观察。

# nhibernate - 他们在 nHibernate 中的持久性是什么意思？

> ID：904646
> 
> 赞同：2
> 
> 时间：2009-05-24T21:00:55.740
> 
> 标签：nhibernate, orm, persistence

在处理 nHibernate 时，术语持久性是什么意思？

究竟什么是坚持？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T21:04:40.600

这意味着一个实体与数据库相关联，并且更改将被写入或“持久化”到数据库中。

这与只存在于内存中的瞬态对象相反。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T21:58:47.730

*持久性*一词通常意味着数据以持久的方式存储，在程序终止或计算机关闭后仍然可用。当使用数据库进行持久化时，通过将数据写入数据库并提交来使数据持久化。

*Persistent*也是 Nhibernate 中的一个术语，指的是[实例状态](http://nhforge.org/doc/nh/en/index.html#architecture-states)之一。这意味着对象由NH与数据库同步。NH 负责将持久对象上的所有更改存储到数据库中。这些更改还需要在它们真正持久（持久）之前提交。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T22:29:04.580

大多数 ORM（NHibernate 就是其中之一）将 SQL 模式/数据库公开为对象。当您修改这些对象时，您需要将这些更改“持久化”回数据库，这通常称为数据持久性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T21:14:23.030

持久性是长期保存某些东西，因此崩溃或断电不会影响它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T22:18:04.820

持久性是存储现有数据的状态，以便以后可以检索和重用。没有它，您将无法在软件的使用之间重构您的对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T08:14:45.780

在数据操作的上下文中，持久化是将数据保存或更新回数据库。

就对象而言，持久状态意味着 iobject 与 DB 同步。

我们通常使用 ISEssion >> SaveOrUpdate(object) 方法来保存值。

# vb.net - 如何强制 VB.net，即 ENTER 创建一个新行，而不是关闭对话框？

> ID：904648
> 
> 赞同：1
> 
> 时间：2009-05-24T21:03:26.330
> 
> 标签：vb.net, user-interface

我用 RichTextBox 构建了一个对话框，我希望有以下行为：

我在 RichTextBox 中获得了焦点（光标）。当按下 ENTER 键时，在创建的富编辑控件中应该有一个新行。ENTER 不应该关闭对话框 [就像现在这样 :-( ]。

任何想法 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T21:09:20.640

如果分配了表单的[AcceptButton](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.acceptbutton.aspx)属性，引用了表单上的一个按钮，这将拦截 enter 按键。确保表单没有分配任何 AcceptButton，并且文本框应该接收到 Enter 按键并按预期运行。

更新：如果您希望具有 AcceptButton 的行为并让 RichTextBox 在聚焦时接收回车键按下，您可以通过两种不同的方式实现此目的。一种是设置表单的KeyPreview属性为true，在表单的KeyPress事件处理函数中加入如下代码：

```
private void Form_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == (char)Keys.Enter && this.ActiveControl != theRichTextBox)
    {
        this.DialogResult = DialogResult.OK;
    }
} 
```

另一种方法是分配 AcceptButton 属性，指出一个按钮（该按钮又将其 DialogResult 属性设置为`OK`）。然后，您可以为 RichTextBox 控件的 Enter 和 Leave 事件添加事件处理程序，这将暂时取消分配表单的 AcceptButton 属性：

```
private void RichTextBox_Enter(object sender, EventArgs e)
{
    this.AcceptButton = null;
}

private void RichTextBox_Leave(object sender, EventArgs e)
{
    this.AcceptButton = btnAccept;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T21:10:30.183

你的意思是 RichTextBox 对吧？您需要将 AcceptsReturn 属性设置为 true。

# visual-studio - Visual Studio 中解决方案文件的最佳位置是什么？

> ID：904659
> 
> 赞同：17
> 
> 时间：2009-05-24T21:07:46.693
> 
> 标签：visual-studio, visual-studio-2008, standards

我更喜欢解决方案文件与 Visual Studio 中的项目文件位于同一文件夹中。我知道这是通过取消选中“为解决方案创建目录”复选框来完成的。但是，VS 2008 默认选中该框。

我对其他人对解决方案文件是否应位于同一目录中的意见感兴趣。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-24T21:10:57.047

当一个解决方案包含多个项目时，我喜欢父目录中的解决方案文件和其子目录中的项目文件。

当一个解决方案包含许多项目（我当前的解决方案有 36 个项目/程序集）时，我将拥有：

*   祖父母：解决方案
*   子目录：“[解决方案文件夹](http://msdn.microsoft.com/en-us/library/haytww03(VS.80).aspx)”是项目的逻辑集合
*   孙子：项目本身

* * *

*如果*解决方案只有一个项目，我也同意将解决方案及其项目放在同一个文件夹中。如果您以这种方式开始并希望稍后将另一个项目添加到解决方案中，则很容易更改（例如，在父目录中创建新解决方案或移动现有解决方案，然后向其中添加/重新添加现有项目）。

只是不要将多个项目放在同一个文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T21:31:39.907

我更喜欢这样的东西：

```
MyProject
  src
    Domain
    Application
    Infrastructure
    UI
  solutions
    MyProject
    Infrastructure
    Domain 
```

解决方案文件夹包含解决方案文件夹。所有项目都从 src 文件夹中引用。

# ruby-on-rails - 在 Rails 上，form_for 中的 f.submit 是否比 submit_tag 更新？

> ID：904661
> 
> 赞同：1
> 
> 时间：2009-05-24T21:08:12.840
> 
> 标签：ruby-on-rails

一些书籍甚至是 rails api 使用

```
form_for ...
  ...
  submit_tag ...
end 
```

我发现 Rails 2.3.2 Scaffold 使用

```
f.submit "Create" 
```

相反......这不在rails api doc中。这是一个新增功能，是否应该替换 submit_tag？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T11:48:15.453

我相信这会`f.submit`调用`submit_tag`引擎盖下的方法。

它在“f”形式的上下文中。

# php - 使用 mysql_fetch_assoc 中的变量从多行的列中输出数据。？

> ID：904669
> 
> 赞同：0
> 
> 时间：2009-05-24T21:12:21.583
> 
> 标签：php, mysql

如果我有这样的查询

```
$query = mysql_query("
SELECT * FROM tbl_school
INNER JOIN tbl_livingexp ON (tbl_school.schoolname=tbl_livingexp.schoolname)
INNER JOIN tbl_tuition ON (tbl_school.schoolname=tbl_tuition.schoolname)
INNER JOIN tbl_apprequirments ON 
(tbl_school.schoolname=tbl_apprequirments.schoolname) 
where tbl_school.schoolname = '$schoolname'"); 
```

其中 3 个表包含名为 language 的列。
当我开始编写这段代码时。

```
while($row = mysql_fetch_assoc($query)) {
//output. 
```

如果我要这样输入，如何仅从表 tbl_school 输出列语言？

```
$row['language'];  ? 
```

我试过 $row['tbl_school.language']; 但这给了我一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T21:16:20.937

您必须明确命名它们：

```
SELECT a.foo first_col, b.foo second_col, c.foo third_col
FROM a, b, c
WHERE [conditions] 
```

如果您使用

```
$row = mysql_fetch_assoc($query); 
```

您现在可以使用 $row["first_col"]、$row["second_col"] 和 $row["third_col"] 访问列。这是由于 mysql 客户端库的工作方式。表名根本不会添加到列名之前。这意味着每个列名都必须是唯一的才能出现在结果中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T21:16:59.267

`SELECT *`在生产代码中，不惜一切代价尽量避免。您需要在查询中明确列出您的列名：

```
SELECT 
  le.schoolname, 
  le.language AS livingexp_language, 
  t.language AS tuition_language,
  ...
FROM tbl_school
INNER JOIN tbl_livingexp AS le ON (tbl_school.schoolname=tbl_livingexp.schoolname)
INNER JOIN tbl_tuition AS t ON (tbl_school.schoolname=tbl_tuition.schoolname)
... 
```

利用：

```
$row["livingexp_language"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T21:24:41.137

（为了完整起见）您也可以通过使用 mysql_fetch_row 而不是 mysql_fetch_assoc 来实现相同的目的，它将结果放在一个数字数组中，您可以这样引用：

```
$row = mysql_fetch_row($query);
$id = $row[0];
$language = $row[1]; // for instance 
```

在这种情况下，避免 SELECT * 更为重要，因为它很容易出错并且难以调试。

# c# - 更改范式以使用 WorkFlow

> ID：904676
> 
> 赞同：0
> 
> 时间：2009-05-24T21:15:23.857
> 
> 标签：c#, .net, workflow-foundation

想知道在新开发中使用 WorkFlow 的优点/缺点吗？似乎有点改变范式，想知道是否值得努力合并。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T21:32:08.923

在深入了解 WF 之前，请务必分析您要实施的工作流程。如果它们相当简单和/或短暂，我会三思而后行。

我的经验是，当工作流可能存在很长时间（数小时/数天/数周）时，它确实会得到回报，尤其是与持久性服务结合使用时。在我使用它的项目中，我们意识到在我们拥有的两个主要工作流程中，其中一个可能在不使用 WF 的情况下也能正常工作。

另一个（将信息打包到通过 SMPT 发送的邮件中，然后期望邮箱中的几个预定义响应之一，如果没有响应到达，则以特定间隔重新发送消息）我发现这是一个很好的案例WF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-14T14:03:07.697

不要为桌面应用程序上的工作流而烦恼。由于多线程设计（非常适合服务器，尤其是 Web 服务器），状态转换之间的延迟非常高。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T21:18:22.837

如果它看起来不适合您的项目，您可能不需要它。

# apache-flex - Flex：反转 LinearAxis 值

> ID：904681
> 
> 赞同：0
> 
> 时间：2009-05-24T21:16:21.700
> 
> 标签：apache-flex, charts, inversion

我有一个折线图，每隔几秒更新一次，类似于你在 Windows 的任务管理器中看到的。该图表从右到左，最近的数据在右边，向左。我将如何反转 X 轴的值，使最小值在右侧，最大值在左侧？这是一个线性轴。

我尝试将其设为 CategoryAxis 并手动输入数字，但这并不能正常工作（标签未与刻度对齐）。

或者，有没有办法让 CategoryAxis 中的标签与刻度线对齐？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-03T08:17:52.357

所以我已经研究过了，我也看不到翻转轴的直接方法。但是，我确实有一个可以很好地工作并且相对优雅的解决方案，它可以省略一个属性来为您执行此操作。

所以考虑这个正常的从左到右的折线图（应该只是能够将其复制并粘贴到项目中进行测试）。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script>
        <![CDATA[          
        import mx.collections.ArrayCollection;

        [Bindable]
        private var timeValue:ArrayCollection = new ArrayCollection( [
            { Time: 0, Value: 18 },
            { Time: 1, Value: 20 },
            { Time: 2, Value: 30 },
            { Time: 3, Value: 35 }, 
            { Time: 4, Value: 35 }, 
            { Time: 5, Value: 32 }, 
            { Time: 6, Value: 40 }, 
            { Time: 7, Value: 62 }, 
            { Time: 8, Value: 80 },
            { Time: 9, Value: 75 },
            { Time: 10, Value: 76 } ]);
        ]]>
    </mx:Script>

    <!-- Define custom colors for use as fills. -->
    <mx:SolidColor id="sc1" color="yellow" alpha=".8"/>

    <!-- Define custom Strokes for the columns. -->
    <mx:Stroke id="s1" color="yellow" weight="2"/>

    <mx:Panel title="ColumnChart and BarChart Controls Example" 
        height="100%" width="100%" layout="horizontal">
        <mx:LineChart id="column" 
            height="100%" 
            width="100%" 
            paddingLeft="5" 
            paddingRight="5" 
            showDataTips="true" 
            dataProvider="{timeValue}" >

            <mx:horizontalAxis>
                <mx:LinearAxis maximum="10" minimum="0"/>
            </mx:horizontalAxis>

            <mx:verticalAxis>
                <mx:LinearAxis maximum="100" minimum="0" />         
            </mx:verticalAxis>

            <mx:series>
                <mx:LineSeries 
                    xField="Time" 
                    yField="Value" 
                    displayName="TimeValue"
                    fill="{sc1}"
                    stroke="{s1}"
                />
            </mx:series>
        </mx:LineChart>

    </mx:Panel>
</mx:Application> 
```

要将其更改为从右到左的图表，我对时间值进行了一些反转以使它们为负，然后将它们沿使用负最小值和零作为最大值的轴绘制。然后我还在标签上运行一个函数，使它们再次变为正值以适应原始数据源。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script>
        <![CDATA[
            import mx.charts.chartClasses.IAxisRenderer;          
            import mx.collections.ArrayCollection;

            [Bindable]
            private var timeValue:ArrayCollection = new ArrayCollection( [
                { Time: 0, Value: 18 },
                { Time: 1, Value: 20 },
                { Time: 2, Value: 30 },
                { Time: 3, Value: 35 }, 
                { Time: 4, Value: 35 }, 
                { Time: 5, Value: 32 }, 
                { Time: 6, Value: 40 }, 
                { Time: 7, Value: 62 }, 
                { Time: 8, Value: 80 },
                { Time: 9, Value: 75 },
                { Time: 10, Value: 76 } ]);

            private function verticalAxisParseFunction(value : Number) : Number
            {
                return value * -1;
            }

            private function horizontalAxisRenderedLabelFunction(axisRenderer:IAxisRenderer, label:String):String
            {
                var labelAsNumber : Number = Number(label);

                if (isNaN(labelAsNumber))
                {
                    return label;
                }

                return (labelAsNumber * -1).toString();
            }

        ]]>
    </mx:Script>

    <!-- Define custom colors for use as fills. -->
    <mx:SolidColor id="sc1" color="yellow" alpha=".8"/>

    <!-- Define custom Strokes for the columns. -->
    <mx:Stroke id="s1" color="yellow" weight="2"/>

    <mx:Panel title="ColumnChart and BarChart Controls Example" 
        height="100%" width="100%" layout="horizontal">
        <mx:LineChart id="column" 
            height="100%" 
            width="100%" 
            paddingLeft="5" 
            paddingRight="5" 
            showDataTips="true" 
            dataProvider="{timeValue}" >

            <mx:horizontalAxis>
                <mx:LinearAxis id="horizontalAxis" maximum="0" minimum="-10" parseFunction="{verticalAxisParseFunction}"/>
            </mx:horizontalAxis>

            <mx:verticalAxis>
                <mx:LinearAxis id="verticalAxis" maximum="100" minimum="0" />           
            </mx:verticalAxis>

            <mx:horizontalAxisRenderers>
                <mx:AxisRenderer
                    axis="{horizontalAxis}"
                    labelFunction="{horizontalAxisRenderedLabelFunction}" />
            </mx:horizontalAxisRenderers>

            <mx:verticalAxisRenderers>
                <mx:AxisRenderer
                    axis="{verticalAxis}"
                    placement="right" />
            </mx:verticalAxisRenderers>

            <mx:series>
                <mx:LineSeries 
                    xField="Time" 
                    yField="Value" 
                    displayName="TimeValue"
                    fill="{sc1}"
                    stroke="{s1}"
                />
            </mx:series>
        </mx:LineChart>

    </mx:Panel>
</mx:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T09:51:48.857

您是否尝试过反转数据提供者的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-02T17:52:46.177

您如何在图表中填充数据？如果按降序对进入图表的数据进行排序，则可以将其显示为左侧最高，右侧最低。

# c# - 尝试将参数传递给 t4 模板时出错

> ID：904689
> 
> 赞同：4
> 
> 时间：2009-05-24T21:21:36.247
> 
> 标签：c#, visual-studio, properties, t4

我正在尝试（但失败）编写一个简单的模板文件：

```
<#@ template language="C#" hostspecific="True" debug="True" #>
<#@ output extension="cs" #>
<#@ include file="T4Toolbox.tt" #>
<#@ property name="ClassName" processor="PropertyProcessor" type="System.String" #>

public class <#= ClassName #>
{
} 
```

当我在 Visual Studio 中单击模板时，属性窗口中有“类名”属性。这就是我想要的！当我在其中输入文本并构建时，出现以下错误：

```
 Error  1   Running transformation: System.ArgumentNullException: Value cannot be null.
Parameter name: objectToConvert
   at Microsoft.VisualStudio.TextTemplating.ToStringHelper.ToStringWithCulture(Object objectToConvert)
   at Microsoft.VisualStudio.TextTemplating32ED7F6BD49D2C3984C2CB7194792D4B.GeneratedTextTransformation.TransformText() in c:\Users\neilt.PAV12\Documents\Visual Studio 2008\Projects\ConsoleApplication2\ConsoleApplication2\ClassMaker.tt:line 6  C:\Users\neilt.PAV12\Documents\Visual Studio 2008\Projects\ConsoleApplication2\ConsoleApplication2\ClassMaker.tt    1   1 
```

希望您能看到我想要做的事情：我希望我的模板输出一个 .cs 文件，该文件具有一个以我在 Visual Studio 的属性窗口中设置的字符串命名的类。可悲的是，我在很早的一步就失败了！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T08:37:22.790

您应该`Initialize()`首先调用 mehod，如下所示：

```
ClassTemplate t = new ClassTemplate();
t.Session = new Dictionary<string, object>();
t.Session["ClassName"] = "Person";

t.Initialize();//This is important.

string output = t.TransformText();
Console.WriteLine(output); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T21:53:21.597

[上次我尝试](http://www.olegsych.com/2008/04/t4-property-directive/)时，这种情况不起作用，因为属性指令没有标准处理器，并且 Visual Studio 不支持它。您可能正在使用 Clarius T4 编辑器为此指令提供的有限支持；我记得遇到过类似的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-13T14:18:22.210

我在将项目升级到 VS2017 时遇到了同样的问题，我通过在 2017 IDE 中创建模板来修复它。

# sql-server - 删除 where 记录字段 < getdate()

> ID：904690
> 
> 赞同：0
> 
> 时间：2009-05-24T21:21:44.530
> 
> 标签：sql-server, hibernate, date, sql-delete

当特定字段小于**sql 服务器上**的日期而不使用表或字段名称时，我无法弄清楚如何删除一组记录。

由于我使用的是 MSSQL，因此查询看起来像这样：

```
DELETE FROM tickets WHERE expires < getdate() 
```

我将如何让 Hibernate 做到这一点？我正在研究 HQL，但我没有看到指定`getdate()`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T21:28:19.180

我相信您可以使用 query.substitutions 配置。看看这篇文章和答案中的链接：

[在 HQL 或标准中获取 DATEPART？](https://stackoverflow.com/questions/435645/getting-datepart-in-hql-or-criteria/435720)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T21:33:39.497

您可能应该定义一个命名的 SQL 查询：

```
<sql-query name="DeleteExpiredTickets">
 DELETE FROM tickets WHERE expires < getdate()
</sql-query> 
```

然后调用：

```
session.getNamedQuery("DeleteExpiredTickets").executeUpdate(); 
```

# javascript - 如何使用鼠标位置使窗口滚动？

> ID：904697
> 
> 赞同：2
> 
> 时间：2009-05-24T21:27:15.813
> 
> 标签：javascript, function, scroll, mouse

如果我想在窗口接近边缘之一时使用鼠标滚动窗口，我该如何处理？

到目前为止，我的工作正常，它会在移动时检查位置，以查看它是否足够靠近边缘以进行滚动。

但是，它只会在鼠标移动时检查位置，因此如果您靠近边缘，它将滚动一次，并且**不会**再次检查您是否仍然足够靠近以再次滚动。

我怎样才能做到这一点？循环不起作用，因为它只是通过不断检查而不中断检查来冻结浏览器。我也试过这样做......

```
function startScrolling() {
    //If we're close to an edge start scrolling in that direction
    //Else stopScrolling = true;

    if(!stopScrolling) {
        setTimeout(startScrolling(), "1000");
    }
} 
```

此函数从鼠标移动事件设置的全局变量中获取鼠标的位置，因此从技术上讲，它每次执行时都应该有新的鼠标位置。但在再次调用 startScrolling() 之前它似乎甚至没有等待......有什么想法吗？

谢谢，马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T21:40:27.923

您发布的代码的问题是您正在执行`startScrolling`而不是将其传递给`setTimeout`- 即您正在调用`startScrolling()`并将其结果作为`setTimeout`. 由于它的返回值是`null`1 秒后没有被调用，这就是它似乎忽略它的原因。

你想这样做：

```
setTimeout(startScrolling, "1000"); 
```

或者：

```
setTimeout(function (){ startScrolling(); }, "1000"); 
```

前者更可取，因为它更短且更易于理解，但在许多情况下，如果您需要将其他参数传递给`startScrolling`.

# linux - 将无堆栈线程添加到 BSD 内核？

> ID：904700
> 
> 赞同：1
> 
> 时间：2009-05-24T21:28:26.577
> 
> 标签：linux, multithreading, operating-system, kernel, freebsd

[IronPort](http://www.ironport.com/)开发了一种无堆栈线程模型，该模型允许 IronPort 设备支持超过 10,000 个同时连接，而传统操作系统支持 100 个连接。

如果一个人想做同样的事情，但要使其开源，他们应该从哪里开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T21:45:25.260

已经有一些实现可用。只需进行一些挖掘，您就可以找到它们。在 BSD 许可下可以使用最流行的实现之一：[Protothreads](http://www.sics.se/~adam/pt/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T18:12:44.893

你需要的是协程 [http://www.nightmare.com/~rushing/copython/index.html](http://www.nightmare.com/~rushing/copython/index.html)

# c# - C# 中的多功能 ASP.NET CMS

> ID：904701
> 
> 赞同：11
> 
> 时间：2009-05-24T21:28:35.297
> 
> 标签：c#, asp.net, content-management-system

我们正在 ASP.NET 上创建一个公共网站，我们正在寻找一个真正**多功能的 CMS**，它会给我们足够的**自由**，让我们不仅可以创建标准内容页面（所有 CMS 都提供的功能），还可以创建带有**自定义 ASP的页面.NET 编程**。

想象一下以下情况：我们的网站将包含几个用 C# 编写的自定义 ASP.NET 页面，允许访问者查看和搜索一些金融产品（该网站实际上将专门用于俄罗斯的结构化金融产品）。这些**页面**将使用**纯 ASP.NET / C#**进行编程。

同时，我们将有很多**内容页面**（带有简单的文本、图像等，但无需任何编程），我们希望能够使用大多数 CMS 中的 Web 界面将这些页面添加到站点中系统。

**问题**是像 DotNetNuke这样的**大多数 CMS 系统****很难**将**自定义 ASP.NET 页面**添加到站点。在 DDN 中，必须创建特殊的 DNN 模块，这需要大量的额外工作。

**我的问题**：是否有任何轻量级、多功能的 CMS 系统可以让用户管理简单的内容页面并同时创建自定义 ASP.NET 页面？也许我们需要的**不是一个经典的 CMS**，而是一套可以帮助我们管理简单内容页面的组件？

谢谢你。

* * *

谢谢您的回答。

我想知道使用 CMS 是否是解决我们问题的唯一方法？也许有允许以**类似 CMS 的方式管理页面的****ASP.NET 控件**？所以我们理想地想要一些非常轻量级的东西。

 *** * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T21:38:35.993

Umbraco - [http://umbraco.org](http://umbraco.org)

完全用 C# 编写，免费，占用空间小，使用母版页，非常灵活。

自定义 .NET 可以通过宏（.NET 用户控件）或完整的 ASPX 页面添加，前提是您在 web.config 中指定该文件存在并且 Umbraco 不会尝试在内容数据库中找到它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-24T23:21:44.833

[N2](http://n2cms.com/)是一个免费的开源 ASP.NET CMS，也支持 MVC。它固执己见，使用 .Net 类作为编程模型，并且非常开放和可扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T13:02:54.977

根据您的描述，我会说您需要一个开发平台和一个 CMS。看看[Sitefinity](http://www.sitefinity.com)，我想说你正在寻找的正是它的主要优势。它使定制开发变得轻而易举。

**免责声明：**我在[Telerik](http://www.telerik.com)开发 Sitefinity 的团队。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T11:02:02.240

也可以看看[凯霍加](http://www.cuyahoga-project.org/)。这是[功能列表](http://www.cuyahoga-project.org/home/features.aspx)。它有一个所见即所得的内容管理器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T23:06:27.890

您可能想要评估的两个用 .NET 编写的开源 CMS 系统是：

1) [DotNetNuke](http://www.dotnetnuke.com/)

和

2)来自 Microsoft 的[Oxite](http://www.codeplex.com/oxite)（强调博客）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-04T08:05:03.013

当您不太关心工作流程和其他高级 CMS 的东西，但喜欢有一个内联 HTML 编辑器并且非常关心编程您的应用程序时......看看 SmallCMS。它是免费的、开源的、轻量级的，是一个很好的起点。

[smallcms.codeplex.com](http://smallcms.codeplex.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T05:12:35.957

你可以试试[Kentico CMS](http://kentico.com)。它不是免费的，但非常强大。您可以将自定义代码添加到您的页面/模板中，如下所示：

devnet.kentico.com/docs/devguide/adding_custom_code_to_the_aspx_page_template.htm

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-27T07:47:32.297

Webnodes CMS 允许您做您想做的事。您可以完全控制一切。它更像是一个 CMS 框架，而不是一个开箱即用的 CMS。模板是常规的 aspx 页面，没有任何限制。[在www.webnodes.com](http://www.webnodes.com)上查看更多信息

# linux - 将 I/O 驱动的调度整合到 OS 内核中

> ID：904707
> 
> 赞同：0
> 
> 时间：2009-05-24T21:32:07.300
> 
> 标签：linux, operating-system, filesystems, kernel, freebsd

[IronPort](http://www.ironport.com/)开发了一个高性能文件系统和一个 I/O 驱动的调度程序，该调度程序针对消息传递的异步特性进行了优化（因此称为“Async”OS）。

如果你想做同样的事情，但要开源，究竟需要改变什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T20:33:07.287

这可能主要是营销 - FreeBSD 已经很好地处理了“消息传递的异步性质”。他们很可能出于特定目的将网络堆栈中的某些处理短路，文件系统也是如此。

# nhibernate - nhibernate和类设计

> ID：904714
> 
> 赞同：1
> 
> 时间：2009-05-24T21:37:28.430
> 
> 标签：nhibernate

假设我有一个 Employee 类和一个 Sales 类。

现在假设我想创建一个包含报告的页面，显示给定员工的所有销售信息。

当我返回集合时，我是否必须为返回的集合定义一个新类？

因为我不想返回 Employee & Sales 类的所有列/属性。

我基本上需要每个类/实体的子集（基本上将 1:1 映射到我的表 Employee 和 Sales）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T21:48:41.807

NHibernate 可以做到这一点，使用“选择新”语法，它将指定的字段列表加载到您的自定义查询结果对象中。它调用与您查询的字段匹配的构造函数。例如

```
SELECT NEW EmployeeSalesSummary(e.Id, e.Name, SUM(s.SaleValue) TotalSales)
FROM Employee e
JOIN etc etc 
```

更完整的语法示例在[这里](http://averyblog.com/net/refactoring-using-object-constructors-in-hql-with-nhibernate/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T13:05:48.877

我不确定这是否会回答您的问题，但如果您只想返回某些属性，则可以使用 Projection。或者，也许您想使用 Ayende 在“ [NHibernate Query-Only Properties](http://ayende.com/Blog/archive/2009/06/10/nhibernate-ndash-query-only-properties.aspx) ”中描述的仅查询属性——尽管这通常用于关联。或者，还有返回记录子集的[NHibernate 过滤器。](http://ayende.com/Blog/archive/2009/05/04/nhibernate-filters.aspx)或者也许是这些的组合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T21:44:43.890

我取决于您必须将结果传递到哪里。是不是在同一个进程中，比如说在服务器中，你不需要任何特殊的类，因为你可以利用延迟加载。您将 NHibernate 配置为仅在您访问它们时加载引用的实体。

如果你通过网络发送结果，情况就不同了，因为你需要序列化数据并且需要所有属性都是完整的。这其实不是 NHibernate 的问题，是你的服务器接口的问题。然后，您需要一个特殊的 DTO（数据传输对象），其中仅包含客户端所需的数据。

**编辑：**

我认为您需要的是延迟加载。有两种不同类型的延迟加载。延迟加载集合和延迟加载对单个实体的引用。

例子：

```
class Employee
{
  // make everything virtual to allow NH to build a proxy
  public virtual string name { get; set; }

  // will be lazy loaded
  public virtual IList<Customers> Customers { get; private set; }
  public virtual Employee Boss { get; set; }  
} 
```

映射

```
<!-- lazy=true is actually default -->
<class name="Employee" lazy="true">
  <property name="Name"/>
  <property name="Boss"/>

  <!-- lazy=true is actually default -->
  <bag name="Customers" type="Employee" lazy="true">
    <key column="Employee_FK"/>
    <one-to-many class="Employee" />
  </bag>
</class> 
```

示例代码

```
using (ISession session = CreateSession())
using (ITransaction trx  session.CreateTransaction())
{
  // get a instance of an employee
  // the boss and the customers are not loaded until now
  Employee emp = session.Get<Employee>(empid);

  // emp.Boss is a proxy. This is a subclass of employee
  // generated by NH that implements the lazy loading

  // this loads the boss' data
  if (emp.Boss.Name == "gogogurt")
  {
    // this is your employee
  }

  // this loads the Customers
  if (emp.Customers.Count == 0)
  {
    HumanResources.Fire(emp);
  }

  trx.Commit();
}

// outside the session you cannot access the lazy 
// loaded properties. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T21:47:36.693

我不完全理解您的问题，但设计应该像*Employee*和*Sale*类一样简单。*Sale*可能有一个属性employee 并且在NHibernate 中有一个多对一的映射定义。当您选择员工时，只需进行 HQL 查询或标准以返回具有*员工*等于您选择的员工的对象*销售。*

 *如果让员工获取他的所有销售额是很常见的，那么您可能会将员工与销售额的集合反向关联，并使其变得懒惰以避免性能问题。

在这两种情况下，您都不需要任何特殊课程

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T08:18:46.473

如果我正确理解了您的问题，这就是您想要的。

您只需要员工中的一些字段和销售中的一些选定字段。

最简单的做法是仅映射 hbm 映射文件中需要的那些字段。

例如：如果您只需要员工的 ID 和姓名，则只需将它们映射到 hbm 文件中。

抱歉，如果我理解错误的问题。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-24T21:48:43.413

点头——阅读延迟加载（[链接文本](http://en.wikipedia.org/Lazy_loading)）——本质上，在服务器端，加载实体的整个成员集是免费的。如果您要传递到服务器外部的东西，那么这些天的“最佳实践”实际上不是 DTO，而是使用具有您感兴趣的字段子集的映射超类。

然后，让你的域实体成为这个超类的子类，并带有额外的持久字段。要传回页面，只需将大小写传递给父级 - 在序列化时，您将得到您所追求的。

# php - 按键将数组排序为多维数组

> ID：904718
> 
> 赞同：0
> 
> 时间：2009-05-24T21:41:28.547
> 
> 标签：php, arrays, multidimensional-array

我有一个数据库表，它给了我以下结果：

```
array(8) {
    ["link_id"]=>
    string(2) "20"
    ["link_url"]=>
    string(56) "http://url.of/website"
    ["link_name"]=>
    string(34) "Website title"
    ["link_target"]=>
    string(0) ""
    ["link_description"]=>
    string(0) ""
    ["link_updated"]=>
    string(19) "2009-05-24 16:51:04"
    ["taxonomy_id"]=>
    string(2) "36"
    ["term_id"]=>
    string(2) "34"
    ["category_name"]=>
    string(15) "Link category"
} 
```

我想根据*category_name*键将这些数组中的许多排序到一个多维数组中，然后按*link_updated*键排序。

所以我最终希望它看起来像这样：

```
array(2) {
    ["First category"]=>
    array(2) {
        ["link_name"]=>
        string(11) "Newest link"
        ["link_updated"]=>
        string(19) "2009-05-24 16:51:24"
    }
    ["Second category"]=>
    array(2) {
        ["link_name"]=>
        string(10) "Older link"
        ["link_updated"]=>
        string(19) "2009-05-20 05:32:56"
    }
} 
```

我不知道该怎么做，但我想我必须制作自己的排序方法（usort（））？

编辑：我想在每个类别中显示 5 个链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T21:45:38.460

使用[usort()](http://us2.php.net/manual/en/function.usort.php)您可以按照您想要的任何方式对数组进行排序：

```
function sort_crazy_way($a, $b){
  // do your business.
}

usort($array, 'sort_crazy_way'); 
```

排序后，您可以在另一个 for 循环中创建最后一个数组。

来自 PHP 手册：

> 如果认为第一个参数分别小于、等于或大于第二个参数，则比较函数必须返回小于、等于或大于零的整数。

所以，你的比较函数应该是这样的：

```
function sort_crazy_way($a, $b){
  $sorted_by_category = strcmp($a['category_name'], $b['category_name']);
  if($sorted_by_category){
    return $sorted_by_category;
  }

  // If we're here, category_name is the same. Compare link_updated.

  $time_diff = strtotime($a['link_updated']) - strtotime($b['link_updated']);
  return $time_diff;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T21:44:42.063

[array_multisort](http://us2.php.net/array_multisort)应该在这里解决问题 - 它非常强大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T23:49:08.803

我自己解决了这个问题，使用以下代码：

```
foreach ($bookmarks as $b)
{
    $category[$b["category_name"]][] = array(
        "link_id" => $b["link_id"],
        "link_url" => $b["link_url"],
        "link_name" => $b["link_name"],
        "link_target" => $b["link_target"],
        "link_description" => $b["link_description"],
        "link_updated" => $b["link_updated"],
        "taxonomy_id" => $b["taxonomy_id"],
        "term_id" => $b["term_id"],
        "category_name" => $b["category_name"]
    );
} 
```

这将创建一个类别名称的数组，并将所有子数组放在正确的父数组中（基于类别）。在 SQL 查询中进行链接更新后的排序。

# java - Joone vs. Encog - 生产应用

> ID：904729
> 
> 赞同：1
> 
> 时间：2009-05-24T21:45:46.557
> 
> 标签：java, neural-network

有没有人在生产应用程序中同时使用 Joone 和 Encog？您是否需要在产品应用程序中使用其中一个或另一个产品不足的地方做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T18:32:26.730

JOONE 似乎几乎已经死了，它自 2007 年 1 月以来一直处于“候选版本 1”（有很多错误）。Encog 刚刚发布了 2.0-beta2，并且是一个积极支持的产品。我会选择Encog。 [http://www.encog.org](http://www.encog.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-02T09:44:07.717

两个都看了。Joone 处于休眠状态，但在输入管理和规范化方面有一些不错的设计功能。Encog是活跃的并且有希望。它的各种抽象级别非常适合覆盖您自己的目的，尽管您可能会发现自己在开始之前花费了大量时间来弄清楚抽象类的各个层。此外，由于这种分层，我不确定性能是否会非常出色，尽管可以通过为您的特定应用程序重写适当的类来克服这一点。

# .net - DataGridView 中的超链接 - 如何拥有文本和链接？

> ID：904730
> 
> 赞同：1
> 
> 时间：2009-05-24T21:46:03.357
> 
> 标签：.net, winforms, datagridview

是否有可能有一个 Windows 窗体 DataGridView，其中一列将显示标准文本，其中一些单词作为可点击链接？这就是我想做的事情：每当我在文本中得到某个正则表达式模式时，我想让它匹配一个超链接。

关于如何实现这一点的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T18:45:40.907

好吧，要做你想做的事，我认为你需要一个从 IDataGridViewEditingControl 接口派生的自定义控件，然后你可以将它插入到你的 DataGridView 中。 [本文](http://www.codeproject.com/KB/grid/RtfInDataGridView.aspx)展示了如何使用 RichTextBox 执行此操作。

不幸的是，除非您愿意商业化，否则我认为不存在即插即用的解决方案。 [Infragistics](http://www.infragistics.com/dotnet/netadvantage/winforms.aspx#Overview)有一个[WinGrid](http://www.infragistics.com/dotnet/netadvantage/winforms/wingrid.aspx#Overview)控件，他们声称您可以使用该控件插入支持超链接的[WinFormattedTextEditor](http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/WinFormattedTextEditor_About_WinFormattedTextEditor.html)。

# iphone - iPhone内存消耗

> ID：904736
> 
> 赞同：2
> 
> 时间：2009-05-24T21:51:08.417
> 
> 标签：iphone, memory

我开发了一个 iphone 应用程序，它打开一个选项卡式视图，第一个选项卡是一个 uinavigationcontroller。在该控制器中是一个包含 uitableview 的 uiviewcontroller。表格视图中列出了 2 个项目。当我选择一个或另一个项目时，它会显示另一个带有动态生成的 uiviews 的 uiviewcontroller。

当我按下导航控件顶部的“返回”按钮时，返回上一个 uiviewcontroller（包含 tableview），然后我再次选择 uitableview 中的 2 个项目中的 1 个，它占用了将近 2M 的内存根据仪器。每次都会发生这种情况，直到达到大约 24M，然后我的应用程序崩溃。

我没有记录任何泄漏。

当按下“返回”按钮以释放分配给 uiviewcontroller 的内存时，我需要做些什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T23:03:47.990

我不确定您在 iPhone 开发方面的进展情况，或者您对内存管理了解多少，但这可能是一个引用计数问题。记住：如果你调用 alloc 或 retain，你需要调用 release，并且永远不要在你没有分配或保留的东西上调用 release。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T23:01:08.557

导航控制器保留所有推送到其堆栈上的视图控制器，因此如果您确保此类视图控制器是自动释放的，或者您对它们没有任何要求（例如，alloc、push、release），它们将在弹出时自动释放。

如果你这样做并且你仍然失去记忆，也许你从他们的视图控制器中过度保留了你的自定义视图？

没有看到代码就很难说，但可能有用的一件事是在所有 UIViewControllers 上实现 -didReceiveMemoryWarning 并记录它们的详细信息——然后，如果你看到来自你认为应该被释放的视图控制器的内存警告，你有进一步调查的起点。

另外，您是否尝试过 Clang 静态分析器？泄漏工具很有用，但会产生大量误报。CSA 也不是灵丹妙药，但它可以捕捉到 Leaks 遗漏的一些东西。

# vbscript - 我可以在 vbscript WSH 脚本中获取环境变量吗？

> ID：904739
> 
> 赞同：21
> 
> 时间：2009-05-24T21:52:39.740
> 
> 标签：vbscript, environment-variables, wsh

是否可以在 Windows 脚本主机 (WSH) VBS 脚本中读取系统环境变量？

（我正在使用 Windows Scripting Host 编写一个 VBScript 来执行 Cruise Control 的任务，并且想要获取项目构建 URL。）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-24T21:57:03.617

这是一个示例（取自[此处](http://windowsitpro.com/article/articleid/84803/jsi-tip-9956-how-do-i-use-an-environment-variable-in-vbscript.html)）：

```
Set oShell = CreateObject( "WScript.Shell" )
user=oShell.ExpandEnvironmentStrings("%UserName%")
comp=oShell.ExpandEnvironmentStrings("%ComputerName%")
WScript.Echo user & " " & comp 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-24T21:55:59.827

从[这里](http://itknowledgeexchange.techtarget.com/vbscript-systems-administrator/using-environment-variables-inside-a-vbscript-script/)...

```
Set WshShell = WScript.CreateObject("WScript.Shell")

Set WshProccessEnv = WshShell.Environment("Process")
Set WshSysEnv = WshShell.Environment("System")

Wscript.Echo WshSysEnv("NUMBER_OF_PROCESSORS")
Wscript.Echo WshProccessEnv("Path") 
```

[此外，有关 TechNet](http://www.microsoft.com/technet/scriptcenter/guide/sas_wsh_kmmj.mspx?mfr=true)的更多详细信息。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-12-20T18:03:43.377

现有的答案都很有帮助，但让我尝试一个**务实的总结**：

通常，您需要**当前*进程的*环境变量定义**：

```
CreateObject("WScript.Shell").ExpandEnvironmentStrings("%TEMP%") 
```

这相当于（注意`%`变量名周围没有）：

```
CreateObject("WScript.Shell").Environment("Process").Item("TEMP") 
```

^(**警告**：不要省略`("Process)`部分：如果这样做，您将获得*系统*范围的变量定义；见下文。)

**`.ExpandEnvironmentStrings`在概念上更简单、更灵活**：它可以使用*嵌入式*（-enclosed）环境变量引用扩展*任意*字符串；例如：*`%`*

 *```
CreateObject("WScript.Shell").ExpandEnvironmentStrings("My name is %USERNAME%") 
```

* * *

在极少数情况下，您可能必须从***特定范围***（当前进程除外）**访问环境变量定义。**

 *```
 sScope = "System" ' May be: "Process", "User", "Volatile", "System"
  CreateObject("WScript.Shell").Environment(sScope).Item("TEMP") 
```

注意：如上所述，省略范围参数默认为`System`范围。

**警告**：以这种方式访问​​值不会*扩展*它：环境变量值可以*嵌套*：它们可以引用*其他*环境变量。
在上面的示例中，返回值为`%SystemRoot%\TEMP`，其中包含对 的*未扩展*引用`%SystemRoot%`。
要扩展结果，请将其传递给`.ExpandEnvironmentStrings()`，如上所示。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-20T22:37:22.240

```
Set WshShell = CreateObject("WScript.Shell")    
Set WshEnv = WshShell.Environment
WScript.Echo "WINDIR=" & WshEnv.Item("WINDIR")  & vbCrLf & vbCrLf   
Set WshShell = CreateObject("WScript.Shell")
WScript.Echo "Environment System:"              & vbCrLf & _ 
         "..............................................."

For Each IEnv In WshShell.Environment("System")
    WScript.Echo IEnv
Next

WScript.Echo vbCrLf & "Environment User:"       & vbCrLf & _   
        "..............................................."

For Each IEnv In WshShell.Environment("User") 
    WScript.Echo IEnv
Next

WScript.Echo vbCrLf & "Environment Volatile:"   & vbCrLf & _ 
       "..............................................."

For Each IEnv In WshShell.Environment("Volatile")
    WScript.Echo IEnv
Next

WScript.Echo vbCrLf & "Environment Process:"    & vbCrLf & _ 
       "..............................................."

For Each IEnv In WshShell.Environment("Process")
    WScript.Echo IEnv
Next 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-03-09T14:12:56.800

这对我有用：

```
Dim objNetwork
Set objNetwork = CreateObject("WScript.Network")
MsgBox objNetwork.UserName 
```

或从外壳：

```
Set wshShell = WScript.CreateObject( "WScript.Shell" )
strUserName = wshShell.ExpandEnvironmentStrings( "%USERNAME%" ) 
```

或来自环境变量（它应该可以工作，但是当我测试它是错误的！）：

```
Set WshShell = CreateObject("WScript.Shell")
Set WshEnv = WshShell.Environment
MsgBox "USERNAME=" & WshEnv.Item("USERNAME") 
```

# javascript - 参考 JScript 中的网站根目录

> ID：904744
> 
> 赞同：1
> 
> 时间：2009-05-24T21:56:46.737
> 
> 标签：javascript, asp.net-2.0

在asp中引用一个网站的根目录我使用了一个ASP控件（普通的超链接不起作用！）并使用潮~

但是我试图用 Jscript 实现同样的效果，但它不起作用。

我已经建立了一个文件夹结构来更好地组织我网站上的文件。我在文件夹结构的根目录中放置了一个 Jscript 文件，并像这样引用它

“/superslight.js” 这是在母版页中

用户导航到一个页面，该页面是一个文件夹，链接断开，因为它不是查看站点的根目录，而是查看当前文件夹的根目录

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T22:13:28.420

<script src="<%=ResolveClientUrl("~/superslight.js")%>"></script>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T22:16:02.033

使用两个点来指代父文件夹：
假设您具有以下文件夹结构

root---->pages---->myFile.aspx
root---->scripts---->myScript.js

您在 myFile.aspx 中引用 myScript.js，如下所示：

```
<script type="text/javascript" src="../scripts/myScript.js" /> 
```

# windows - 基于操作系统的C++条件编译

> ID：904745
> 
> 赞同：8
> 
> 时间：2009-05-24T21:56:49.653
> 
> 标签：windows, visual-studio, linux, cross-platform, conditional-compilation

我想用 C++ 编写一个包含系统调用的跨平台函数。我可以检查哪些条件编译标志来确定代码正在为哪个操作系统编译？我主要对使用 Visual Studio 和 GCC 的 Windows 和 Linux 感兴趣。

我认为它应该看起来像这样：

```
void SomeClass::SomeFunction()
{
    // Other code

#ifdef LINUX
    LinuxSystemCall();
#endif

#ifdef WINDOWS
    WindowsSystemCall();
#endif

    // Other code
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-24T22:09:27.897

我的 gcc (4.3.3) 定义了以下与 Linux 相关的预定义宏：

```
$ gcc -dM -E - < /dev/null | grep -i linux
#define __linux 1
#define __linux__ 1
#define __gnu_linux__ 1
#define linux 1 
```

在 VC++（和许多其他 Win32 编译器）下，还有几个用于识别平台的预定义宏，最著名的是 _WIN32。更多详情： http: [//msdn.microsoft.com/en-us/library/b0084kay (VS.80).aspx](http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-24T22:10:08.690

没有标准的方法可以做到这一点。可以关闭每个平台定义的某些宏。例如，_WIN32 将在 Windows 上定义，几乎可以肯定不会在 Linux 上定义。但是我不知道任何相应的 Linux 宏。

因为您使用单独的编译器，所以您有单独的构建环境。为什么不自己添加宏？Visual Studio 和 GCC 都支持从命令行定义宏，所以只需定义它们。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-25T00:07:28.050

我总是尝试通过这种方式将平台细节排除在主代码之外

平台.h：

```
#if BUILD_PLATFORM == WINDOWS_BUILD
#include "windows_platform.h"
#elif BUILD_PLATFORM == LINUX_BUILD
#include "linux_platform.h"
#else
#error UNSUPPORTED PLATFORM
#endif 
```

someclass.c：

```
void SomeClass::SomeFunction()
{
   system_related_type t;
   // Other code
   platform_SystemCall(&t);
   // Other code
} 
```

现在`windows_platform.h`，如果从一个平台到另一个平台的参数集差异太大，那么`linux_platform.h`您将 typedef`system_related_type`输入到本机类型，或者作为本机调用，或者创建一个小型包装函数。`#define platform_SystemCall`

如果特定任务的系统 API 在平台之间存在很大差异，您可能需要创建自己的版本 API 来区分差异。但在大多数情况下，Windows 和 Linux 上的各种 API 之间存在相当直接的映射。

我不是依赖某些特定的编译器#define 来选择平台，而是`#define BUILD_PLATFORM xxx`在项目文件或makefile 中，因为无论如何这些平台必须是唯一的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-30T16:46:41.077

这是我使用的。它在 Visual Studio 2008 和 MinGW 下工作：

```
#ifdef __GNUC__
  #define LINUX
#else
  #define WINDOWS
#endif

#ifdef WINDOWS
  #include "stdafx.h"
#else
  #include <stdlib.h>
  #include <string.h>
  #include <stdio.h>
  #include <ctype.h>
  #include <assert.h>
  #include <malloc.h>
#endif 
```

# python - 如何删除python中特定字符之后的所有字符？

> ID：904746
> 
> 赞同：196
> 
> 时间：2009-05-24T21:56:49.827
> 
> 标签：python, replace

我有一个字符串。如何删除某个字符后的所有文本？（*在这种情况下`...`*）
之后的文本会**`...`**改变，所以我这就是为什么我想删除某个字符之后的所有字符。

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2009-05-24T22:01:34.107

最多在分隔符上拆分一次，并取第一块：

```
sep = '...'
stripped = text.split(sep, 1)[0] 
```

你没有说如果分隔符不存在会发生什么。在这种情况下，这和[Alex 的解决方案](https://stackoverflow.com/a/904753/4518341)都将返回整个字符串。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2009-05-24T22:02:26.443

假设您的分隔符是“...”，但它可以是任何字符串。

```
text = 'some string... this part will be removed.'
head, sep, tail = text.partition('...')

>>> print head
some string 
```

如果没有找到分隔符，`head`将包含所有原始字符串。

[分区](https://docs.python.org/3/library/stdtypes.html#str.partition)函数是在 Python 2.5 中添加的。

> `S.partition(sep)`->`(head, sep, tail)`
> 
> 在*S*中搜索分隔符*sep*，并返回它之前的部分、分隔符本身和它之后的部分。如果未找到分隔符，则返回*S*和两个空字符串。

 *** * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-09-14T22:18:10.350

如果您想在字符串中最后一次出现分隔符之后删除所有内容，我发现这很好用：

`<separator>.join(string_to_split.split(<separator>)[:-1])`

例如，如果 `string_to_split`是这样的路径，`root/location/child/too_far.exe`并且您只想要文件夹路径，则可以拆分`"/".join(string_to_split.split("/")[:-1])`，您将得到 `root/location/child`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-24T22:00:24.013

没有正则表达式（我认为这是你想要的）：

```
def remafterellipsis(text):
  where_ellipsis = text.find('...')
  if where_ellipsis == -1:
    return text
  return text[:where_ellipsis + 3] 
```

或者，使用正则表达式：

```
import re

def remwithre(text, there=re.compile(re.escape('...')+'.*')):
  return there.sub('', text) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-02-26T14:12:53.810

```
import re
test = "This is a test...we should not be able to see this"
res = re.sub(r'\.\.\..*',"",test)
print(res) 
```

输出：“这是一个测试”

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-03-19T23:42:24.877

从一个文件：

```
import re
sep = '...'

with open("requirements.txt") as file_in:
    lines = []
    for line in file_in:
        res = line.split(sep, 1)[0]
        print(res) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-06-18T02:42:52.450

find 方法将返回字符串中的字符位置。然后，如果您想从角色中删除所有内容，请执行以下操作：

```
mystring = "123⋯567"
mystring[ 0 : mystring.index("⋯")]

>> '123' 
```

如果要保留字符，则在字符位置上加 1。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-03T10:54:10.130

> 这是在 python 3.7 中对我有用在我的情况下，我需要在字符串变量费用中的点之后删除

费用 = 45.05
split_string = fee.split(".", 1)

子串 = split_string[0]

打印（子字符串）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-25T22:18:40.720

*在字符串中最后一次*出现字符后删除所有字符的另一种方法（假设您要删除最后一个'/'之后的所有字符）。

```
path = 'I/only/want/the/containing/directory/not/the/file.txt'

while path[-1] != '/':
    path = path[:-1] 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-05-20T10:42:08.033

使用 re 的另一种简单方法是

```
import re, clr

text = 'some string... this part will be removed.'

text= re.search(r'(\A.*)\.\.\..+',url,re.DOTALL|re.IGNORECASE).group(1)

// text = some string 
```

# asp.net - 如何使用 readXML 读取 xml 属性？dataset.readxml 如何转换成表格？

> ID：904748
> 
> 赞同：2
> 
> 时间：2009-05-24T21:57:38.403
> 
> 标签：asp.net, dataset, readxml

我只想知道从 readXML 生成的表是什么样子的，比如 xml 文件是否如下所示：

```
<item attr="some attribute">
<descirption>anything</description>
</item> 
```

我可以通过 Tables 集合直接引用表，如下所示：

```
ds.ReadXml(xml);
... ds.Tables[i] 
```

然后我可以使用 rows 集合访问行和列：

```
ds.Tables[3].Rows[i].ItemArray(j); 
```

但是如何访问任何 xml 节点的“属性”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T22:10:49.750

它在行中。我稍微修复了你的 xml :)

```
var xml = "<item attr=\"some attribute\"><description>anything</description></item>";
var ds = new DataSet();

ds.ReadXml( new StringReader( xml ), XmlReadMode.Auto );

var ia = ds.Tables[0].Rows[0].ItemArray;
var att = ia[1]; // att == "some attribute" 
```

如果您没有架构，则可能必须检查该列以确定它是什么。

每条评论：您会看到我让它推断架构 (XmlReadMode.Auto)。它将根节点下的元素作为 Rows，然后按顺序添加属性，然后添加元素中的值。因此，例如以下 XML ...

```
var xml = "<items>
             <item attr1='attr1' attr2='attr2'>
                 <description>desc1</description>
             </item>
             <item attr1='attr3' attr2='attr4'>
                 <description>desc2</description></item>
           </items>"; 
```

我将得到两行（每个项目一个），其中包含 attr1、attr2 和描述的列。您可以使用模式更改它解释 XML 的方式。

# flash - Flash 白板：Actionscript 3

> ID：904752
> 
> 赞同：-1
> 
> 时间：2009-05-24T22:00:12.767
> 
> 标签：flash, actionscript-3, media, whiteboard

我正在寻找有关如何使用 flash 媒体服务器 3.5 创建白板应用程序的 flash Actionscript 3 教程。请问有人有什么想法我可以开始寻找这些信息吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-25T06:46:28.230

搜索文章：

1.  使用白板组件
2.  使用 Macromedia Flash Communication Server MX 创建白板应用程序

我的第一个答案，所以我没有链接

# actionscript-3 - 在 as3 中添加自定义事件监听器

> ID：904754
> 
> 赞同：5
> 
> 时间：2009-05-24T22:00:40.830
> 
> 标签：actionscript-3, events, flex3

我已经阅读了很多论坛帖子和教程，但我仍然无法将我的大脑包裹在事件和事件监听器上。我有一个非常简单的例子，但我无法让它工作。

我在转发器中有一个自定义对象的arrayCollection，当单击其中一个对象时，我想要一个不同的组件来显示与该对象关联的数据。

这是我所拥有的，但侦听器从不响应（调度程序似乎正在工作，因为新事件已创建并且我可以看到带有正确输出的跟踪。）我怀疑这是因为当我调用 addEvent Listener 时，我是在错误的对象上这样做。我的理解是，将显示对象数据的对象是应该具有事件监听器的对象，并且监听所有这种性质的事件，但也许我误解了。

我的自定义事件：

```
public class SelectObjectEvent extends Event
    {
        public function SelectObjectEvent(customEventString:String, myObject:customObject)
        {
              super(customEventString, true, false);
              trace(customEventString+" "+myObject);
        }
    }
} 
```

我的自定义对象具有以下单击时调用的函数：

```
public function selectObject(myObject:customObject):void
        {
            dispatchEvent(new SelectObjectEvent("OBJECT_SELECTED", customObject));              
        } 
```

而我要显示所选对象的组件具有以下构造函数：

```
public function SelectedObjectDisplayClass()
        {
            addEventListener("OBJECT_SELECTED", this.showObject)
        }

        public function showObject(event:Event):void
            {  
            trace("Show object: "+event); 
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T04:27:33.837

您的最后两个代码块在哪里还不是很清楚，但看起来您需要调用`addEventListener`extends 的对象`EventDispatcher`。

也就是说，如果您的第二个块属于一个名为 的自定义对象`Clickable`，该对象在单击时扩展`EventDispatcher`并调用`dispatchEvent()`，那么您的组件应该调用`myClickable.addEventListener(...)`其中 myClickable 是 Clickable 的实例。那有意义吗？

但是假设您的第三个代码块与第二个代码块不在同一个类中，那么您看起来并没有这样做。您正在向拥有第三块代码的类添加一个侦听器，我收集到的不是 extends `EventDispatcher`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T03:29:15.400

快速浏览一下您的代码并注意您的 dispatchEvent 第二个参数是类而不是对象的实例。这不应该是 myObject 吗？

```
public function selectObject(myObject:customObject):void
        {
                dispatchEvent(new SelectObjectEvent("OBJECT_SELECTED", **customObject**));                          
        } 
```

# sql-server-2005 - SSIS：有没有办法将包部署到多个 SQL Server 2005 实例

> ID：904755
> 
> 赞同：0
> 
> 时间：2009-05-24T22:01:10.957
> 
> 标签：sql-server-2005, deployment, ssis

是否有人对将 SSIS 包部署到集成服务数据库有任何建议或技术。

基本上我维护了一些需要部署到多个环境（开发、测试和生产）的 SSIS 包，还需要更改各个数据库连接。

我想自动化将它们部署到这些环境的过程，因此它可以包含在服务器管理员可以完成的完整应用程序部署中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T11:20:10.060

我想出了一种使用单个 SQL Server 配置表为不同环境配置包的方法（假设所有环境都可以连接到配置服务器）。

[http://www.sqlservercentral.com/articles/SSIS/66426/](http://www.sqlservercentral.com/articles/SSIS/66426/)

# security - 加密 cookie 信息以进行身份 验证的漏洞（堆栈溢出播客）

> ID：904760
> 
> 赞同：3
> 
> 时间：2009-05-24T22:03:46.473
> 
> 标签：security, cookies

我正在听 stackoverflow 播客（我想是第 52 集）。Jeff 正在谈论他们是如何想出某种类型的授权机制的，他们在发送给客户端的 cookie 中加密凭据。显然，杰夫认识的某个人能够在其中找到一个漏洞，并且能够使用任何他想要登录的 id 登录。

他没有在播客中详细介绍很多细节，但它引发了我的兴趣。我是那些认为如果你加密你的 cookie 信息那么他们不可能是任何漏洞的人之一。有没有人听过那一集和/或知道你会用这个解决方案打开什么可能的漏洞？

谢谢 Ncage

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-13T12:41:51.173

在我的实现中，我使用随机字符串（16 个字节），后跟重要信息。然后使用循环块链接使用 AES 对整个内容进行加密。

这避免了将信息存储在会话状态中或从数据库中获取信息的需要。无论如何，这不是一个超高安全性的网站，但我认为添加随机字符串和 CBC 会大大提高安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T12:47:56.107

也许你可以查看这篇[博](http://www.matasano.com/log/1749/typing-the-letters-a-e-s-into-your-code-youre-doing-it-wrong/)文，它解释了很多你没有想到的事情，以及为什么加密不是身份验证。实际上，您不应该使用自己的解决方案，而应尝试使用经过验证的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-11T10:24:19.773

如果您将加密信息传递给客户端，那么他们总是有机会解密它（可能是由于所使用的加密算法的弱点，或者缺少盐导致分析攻击或各种其他可能的问题） .

因此，您**不应该发送您可以避免发送的客户信息**。

理想情况下，您只需向他们发送一个随机 ID，用于在会话表中查找，并**保留所有数据 server-side**。然后，用户可以成为不同用户的“唯一”方式是猜测（非常长且随机的）会话 ID。

# iphone - 如何从 iPhone SDK 中提取 UIBarButtonItem 图标？

> ID：904769
> 
> 赞同：9
> 
> 时间：2009-05-24T22:13:41.570
> 
> 标签：iphone

我想从 iPhone SDK 中提取默认的 UIBarButtonItem 图标。我想它们可能作为仅 alpha 通道的 PNG 存储在 iPhoneSimulator 平台中，但我还没有找到它。

我正在寻找的是 UIBarButtonSystemItemReply。（对于那些怀疑甚至有有效用例的人，我希望在用户可以逐行发布回复的表格行标题上使用它）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-03-07T18:08:18.043

要复制所有 iPhone（或 MacOS）系统图标，请转到目录：

```
cd /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/ 
```

=> 可能有不止一个 iPhoneSimulator 版本（iPhoneSimulator4.3.sdk），只需选择您喜欢的一个。然后执行以下命令：

```
find . -iname "*.png*" -print0 | xargs -I{} -0 cp -v {} /tmp/iPhoneIcons/ 
```

`/tmp/iPhoneIcons/`=> 是目标目录

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-02T23:08:35.760

Other.artwork 文件位于 /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator3.0.sdk/System/Library/Frameworks/UIKit.framework/ （您需要 SDK）。

使用“iPhoneShop-1.3.jar”程序——目前[在此处](http://www.modmyi.com/forums/skinning-themes-discussion/665281-iphoneshop-3-0-import-export-artwork-files-3-0-a.html)可用，将所有图像提取到一个目录中。

```
java -jar iPhoneShop-1.3.jar ARTWORK Other.artwork EXPORT Other 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T22:48:36.740

我不知道该怎么做，但是几个月前我对同样的事情感到好奇。您可以通过循环遍历其 UIView 中的所有元素并转储 NSImages 来初始化此 UIBarButtonItem 并从中提取图像。我不确定该怎么做，但我记得 Erica Sadun 写过一篇关于使用全屏相机图像的文章。我不允许添加指向它的链接，所以只需谷歌搜索“erica sadun 全屏相机”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-05T12:07:19.600

这是一个旧线程，但我在 Google 中找到了它。我使用下面的代码成功地从使用系统项初始化的 UIBarButtonItems 中提取了图像。所有的提取程序都没有在 iOS 6 上运行，或者对我来说太复杂了。因为我只需要 5-6 张图片，所以我只是手动获取它们。

```
- (void)viewDidAppear:(BOOL)animated {

UIView *v1 = self.navigationController.navigationBar;
for (int i = 0; i < v1.subviews.count; i++)
{
    UIView *v2 = [v1.subviews objectAtIndex:i];
    NSLog(@"%i %@", i, [v2 class]);
    if (i == 2)
    {
        for (int j = 0; j < v2.subviews.count; j++)
        {
            UIView *v3 = [v2.subviews objectAtIndex:j];
            NSLog(@"  %i %@", j, [v3 class]);

            if (j == 1)
            {
                // In my test, this view was UIImageView containing button image
                UIImageView *iv = [[UIImageView alloc] initWithImage:((UIImageView *)v3).image];
                [self.view addSubview:iv];
            }
        }
    }
} 
```

}

# javascript - 如何找出所有地址何时都已进行地理编码

> ID：904771
> 
> 赞同：1
> 
> 时间：2009-05-24T22:13:59.493
> 
> 标签：javascript, google-maps

在 Google Maps API 中，`google.maps.ClientGeocoder.getLatLng(address, callback)`不能保证多次调用以任何顺序完成。给定地址数组，确定所有地址已被地理编码的优雅方法是什么？

我应该根据数组的长度倒计时并仅在倒计时达到零时在回调中执行代码，还是在 Google Maps API 中有更好的方法来执行此操作？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T02:14:34.407

如果您没有对每个 lat lng 响应进行特殊情况处理（即，当它们都回来时才做某事），我认为您的倒计时解决方案没有不利之处。

# javascript - Rails 中的富文本用户输入

> ID：904775
> 
> 赞同：2
> 
> 时间：2009-05-24T22:16:01.020
> 
> 标签：javascript, ruby-on-rails, sanitization

在 Rails 中处理富文本用户输入的首选方法是什么？Markdown 看起来很有用，但我还没有找到一个看起来很容易设置的编辑器，我也不知道如何处理 html 的清理。（`sanitize`助手似乎仍然允许像`</div>`，这会破坏我的布局）我想保证清理后的代码是有效的 XHTML Strict。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T22:18:24.807

从[这个](https://stackoverflow.com/questions/197708/what-are-the-best-options-for-rich-text-editing-in-rails)线程看来，雅虎 UI 库中[的编辑器是一个很好的解决方案。](http://developer.yahoo.com/yui/editor/)始终先尝试搜索功能！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T19:26:08.313

我选择了 TinyMCE。它允许我将返回的 HTML 代码清理为标签和属性。有关详细信息，请参阅 valid_elements 选项的文档。

但请注意：如果有人直接发布垃圾信息（使用 oa 浏览器，例如使用 curl），这些清理功能将无济于事。我在 TidyFFI 的帮助下使用 Tidy 来防止此类麻烦。

（抱歉，没有链接，因为我不允许发布这种恶意软件 ;-)

# html - CSS定位图片和文字

> ID：904779
> 
> 赞同：0
> 
> 时间：2009-05-24T22:17:24.917
> 
> 标签：html, css

我正在尝试在两个图像之间获取一些文本。图像定位正确，但出现了一些奇怪的设计问题。

[当前页面](http://www.phnx.org/dia/index.html)（网页）

[设计方案](http://www.phnx.org/dia/example.jpg)(jpg)

我想弄清楚的是：

1.  背景必须在右图像的右边缘之前停止（女孩）
2.  背景必须延伸右图的高度
3.  右图像左边缘下方的垂直条。
4.  竖线前的文字换行
5.  中心底部文本左侧的条形图

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T22:45:43.517

正如艾登建议的那样，我建议不要将图像拆分。这很混乱，而且不完全是现代的解决方法。尝试这样的事情：

```
.top-pic {
    float: right;
    margin-top: -200px;
} 
```

将 margin-top 分配更改为您希望图像以像素为单位的高度。剩下的唯一问题是缩放顶部文本 div 的宽度以适应图像。做到这一点的一种方法是将`padding-right: 250px;`左右设置为`.top-text h1`and `.top-text h2`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T22:22:59.210

这有点不对

```
 .top-pic {
    position: absolute;
    top: -5.7em;
    right: -1.5em;
    z-index: 1;
} 
```

将此图像剪切为 2 张图像（一张在选项卡旁边的标题中，一张在内容中）。由于您的 z-index，东西漂浮在下面。

在你的 CSS 中。你想要的是一个非常基本的固定 3 列布局，中间有文本。我会在这里指出你：

[http://layouts.ironmyers.com/](http://layouts.ironmyers.com/)

[http://www.csszengarden.com/](http://www.csszengarden.com/)

这就是 CSS 布局的完成方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T22:28:06.813

如果您将顶部图片移动到徽标上方并更改样式，您可以获得与您想要的类似的效果。

```
<div class="top-pic">
  <img src="index2_files/girlbird.png">
</div>
<div class="logo">
  <img src="index2_files/logo-center.png">
</div> 
```

CSS 更改

```
.top-pic {
    float: right;
    position: relative;
    top: -50px;
    right: -25px;
} 
```

# c# - 除法返回 0 而不是浮点数

> ID：904780
> 
> 赞同：0
> 
> 时间：2009-05-24T22:17:55.553
> 
> 标签：c#

当我发现我的代码不起作用时，我感到非常惊讶，因此我创建了一个控制台应用程序来查看问题所在，当我看到下面的代码返回 0 时，我更加惊讶

```
 static void Main(string[] args)
    {
        float test = 140 / 1058;
        Console.WriteLine(test);
        Console.ReadLine();
    } 
```

我试图以 % 的形式获取结果并将其放入我的应用程序的进度条（意思是 (140 / 1058) * 100) 栏中，第二个值（1058）实际上是我的应用程序中的 ulong 类型，但这不是似乎是问题所在。

问题是——问题出在哪里？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T22:20:29.950

您正在使用整数算术，然后将结果转换为浮点数。改用浮点运算：

```
float test = 140f / 1058f; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T22:20:52.303

问题是您正在划分整数而不是浮点数。只有结果是浮点数。将代码更改为以下

```
float test = 140f / 1058f; 
```

**编辑**

John 提到有一个 ulong 类型的变量。如果是这种情况，那么只需使用演员操作

```
ulong value = GetTheValue();
float test = 140f / ((float)value); 
```

请注意，由于您要从 ulong 变为 float，因此此处可能会丢失精度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T22:21:22.007

这将按您期望的方式工作...

```
float test = (float)140 / (float)1058; 
```

顺便说一句，您的代码对我来说很好（在控制台上打印 0.1323251）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T22:21:34.283

正在执行的除法是整数除法。代替

```
float test = 140 / 1058; 
```

和

```
float test = 140f / 1058; 
```

强制浮点除法。

一般来说，如果你有

```
int x;
int y; 
```

并且想要执行浮点除法，那么您必须将`x`或者`y`转换为浮点数，如

```
float f = ((float) x) / y; 
```

# vb.net - 如何处理 LINQ 子查询中的 Null？

> ID：904783
> 
> 赞同：5
> 
> 时间：2009-05-24T22:19:49.733
> 
> 标签：vb.net, linq, linq-to-sql, null

我有一个子查询，它返回子表中的最新值。在某些情况下，子查询什么也不返回。下面的查询在运行时失败，因为推断的 MemberPrice 类型是十进制且不可为空。

简化查询：

```
Dim q = From s In dc.STOCKs _
        Select s.ID, MemberPrice = _
          (From mp In dc.STOCKPRICEs Where mp.NUMBER = s.NUMBER _
          Order By dc.date Descending _
          Select mp.PRICE).FirstOrDefault 
```

在 SQL 中，子查询将包含 Top (1) 并在为空时返回 Null。如何在 LINQ 中处理这个问题？如果找不到（或更优雅的解决方案），有没有办法使 MemberPrice 可以为空或将值默认为零？

非常感谢，斯图尔特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-25T19:19:05.673

斯图尔特，

我将数据库中的 Price 字段更改为不允许空值，我得到了与您相同的错误：

```
"Operator '??' cannot be applied to operands of type 'decimal' and 'int'". 
```

正如您所指出的，当 Price 设置为不允许数据库中的空值时，空值合并运算符不再起作用，因为它期望看到一个可为空的类型小数：

```
decimal? 
```

如果我删除空合并运算符并运行不包含价格的测试用例，我会得到：

```
"The null value cannot be assigned to a member with type System.Decimal which is a non-nullable value type.." 
```

这是有效的代码。我将子查询结果转换为十进制？在应用空合并运算符之前。

```
public class Class1
{

    DataClasses1DataContext dc = new DataClasses1DataContext();

    public decimal test(int stockID)
    {

        var q = from s in dc.Stocks
                where s.StockID == stockID
                select new
                {
                    StockID = s.StockID,
                    memberPrice = ((decimal?)(from mp in dc.StockPrices
                                   where mp.StockID == s.StockID
                                   select mp.Price).FirstOrDefault()) ?? 0
                };

        return q.FirstOrDefault().memberPrice;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T22:44:53.830

斯图尔特，试试这个：

```
Dim q = From s In dc.STOCKs _
    Select s.ID, MemberPrice = _
      if((From mp In dc.STOCKPRICEs Where mp.NUMBER = s.NUMBER _
      Order By dc.date Descending _
      Select mp.PRICE).FirstOrDefault),0) 
```

空值合并运算符会将 MemberPrice 的空值强制为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T22:59:58.933

DefaultIfEmpty 扩展方法是否符合您的要求？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T01:52:10.490

斯图尔特，

这就是我让它在我的机器上工作的方式。我很抱歉它在 c# 中；很久没用VB了。

请注意在“select”语句中使用“new”运算符，以及在 FirstOrDefault() 之后使用 null 合并运算符。

```
public class Class1
{

    DataClasses1DataContext dc = new DataClasses1DataContext();

    public decimal MemberPrice(int stockID)
    {

        var q = from s in dc.Stocks
                where s.StockID == stockID
                select new
                {
                    StockID = s.StockID,
                    memberPrice = (from mp in dc.StockPrices
                                   where mp.StockID == s.StockID
                                   select mp.Price).FirstOrDefault() ?? 0
                };

        return q.FirstOrDefault().memberPrice;
    }
} 
```

# c# - 使用 C#/WPF 屏蔽窗口/画布的所有元素

> ID：904785
> 
> 赞同：0
> 
> 时间：2009-05-24T22:20:23.583
> 
> 标签：c#, wpf, canvas, window, mask

如何创建一个遮罩来覆盖 Windows/Canvas 的所有元素（其中包含子画布/元素）？

提前致谢

编辑：我想在创建掩码**后添加更多控件/元素/任何内容。**那样行吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T15:07:56.160

我不确定您是否必须“屏蔽”控件。为什么不使用可见性属性？

例如，如果您有一个 stackPanel 并且想要屏蔽它及其内容，只需将

```
<StackPanel Visibility="Hidden">
...
</StackPanel> 
```

通过这种方式，您可以控制每个小部件的可见性。如果您想“添加”或使其他人可见，只需将属性设置为“可见”。

# windows-7 - *默认情况下，如何始终在 Windows 中显示程序托盘图标？

> ID：904790
> 
> 赞同：10
> 
> 时间：2009-05-24T22:22:51.723
> 
> 标签：windows-7, icons, tray

如果程序在 Windows 7 中首次执行，它会自动隐藏图标。是否有任何清单设置或选项强制 Windows 7 默认始终显示图标？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-24T22:29:49.697

不久前，在 .NET Rocks 播客中，来自微软的 Kate Gregory 说这是不可能的。

她说：“如果用户想要它（托盘图标），他/她会把它放在那里”。这样做的原因是为了防止托盘区域混乱。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-02-23T15:38:17.183

如果您真的想显示您的托盘图标，您可以弹出一个带有最少文本的气球，然后通过以下代码示例再次隐藏气球和它的阴影：

```
trayIcon.ShowBalloonTip(30000, "", ".", ToolTipIcon.None)

Dim balloonHandle As IntPtr = GetBalloonHwnd(balloonText) ' mainly: FindWindow("tooltips_class32", Nothing)

If (balloonHandle <> IntPtr.Zero) Then
  Dim sysShadowClassHwnd As IntPtr = FindWindow("SysShadow", Nothing)

  ' will hide balloon and leaving a small shadow artifact - just for this balloon
  PostMessage(balloonHandle, WM_SETREDRAW, IntPtr.Zero, IntPtr.Zero)
  SetWindowPos(balloonHandle, IntPtr.Zero, 0, 0, 0, 0, SWP_HIDEWINDOW)

  If (sysShadowClassHwnd <> IntPtr.Zero) Then
    ' this will remove the small shadow artifact
    PostMessage(sysShadowClassHwnd, WM_CLOSE, IntPtr.Zero, IntPtr.Zero)
  End If
End If 
```

如果您重复此操作（例如每 30 秒），您的托盘图标将停留在那里，因为 Explorer.exe 认为，有一个打开的气球向用户显示。一些小问题 - 例如没有直接右键单击图标 - 仍然存在。

我真的曾经为我们的公司软件显示托盘图标，用户不打算手动执行此操作以及每次更新。所以也许这会对某人有所帮助...... :)

否则，我完全同意：这应该只在用户手中，而不是由应用程序控制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-18T10:19:48.070

这当然不是“不可能的”。Explorer 本身使用了一个未记录的 COM 接口`ITrayNotify`，用于检索托盘图标并更改其可见性。完整的 C++ 源代码：http: [//thread0.me/tag/windows/](http://thread0.me/tag/windows/)

当然，使用非官方 API**是有风险**的，并且 Windows 8 对该 API 进行了重大更改，这意味着您必须对 XP 使用 2 个不同的定义 - Win7 和 Win8 - Win10。但是，嘿，即使是[Chrome 也使用这个技巧](https://chromium.googlesource.com/chromium/src/+/a4993e2d04893594d4e5b3f4fa5ed1c51d13f824/chrome/browser/ui/views/status_icons/status_tray_state_changer_win.cc)。只要确保正确处理故障。

# c# - 如何解决 sqlite 和 c# 中的“'”问题？

> ID：904796
> 
> 赞同：6
> 
> 时间：2009-05-24T22:28:38.730
> 
> 标签：c#, string, sqlite

我正在使用 Sqlite 在 Microsoft Visual C# 2008 Express 中工作。

我了解我的文本中的撇号 (') 在查询中存在问题。我的问题是我认为我可以用\'替换它。它似乎不起作用......这是我的代码的一个简化示例：

```
string myString = "I can't believe it!";
cmd.CommandText = "Insert into myTable (myid,mytext) values (1,'" + myString.Replace("'","\\'") + "');"; 
```

我得到的错误是： SQLite 错误：靠近“t”：语法错误

我尝试了其他几个替代品......就像另一个斜线一样。我将我的字符串和我的字符串的替换版本写到控制台，以确保它输出正确。

我在这里犯了什么愚蠢的错误？

谢谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-24T22:51:56.703

Robert 提出的解决方案将起作用（即替换`'`为`''`）。

或者，您可以使用以下参数：

```
DbCommand   cmd = new DbCommand();
DbParameter param = cmd.CreateParameter();
// ...
// more code
// ...
cmd.CommandText = "Insert table (field) values (@param)";
param.ParameterName = "param"
param.DbType = DbType.String;
param.Value  = @"This is a sample value with a single quote like this: '";
cmd.Parameters.Add(param);
cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-29T14:24:12.340

使用参数可以防止 sql 注入，并使问题 qo 消失。

它也快得多，因为 sqlite 在使用参数时可以重用语句的执行计划。当你不使用参数时它不能。在此示例中，使用参数可使批量插入操作快大约 3 倍。

```
private void TestInsertPerformance() {
  const int limit = 100000;
  using (SQLiteConnection conn = new SQLiteConnection(@"Data Source=c:\testperf.db")) {
    conn.Open();
    using (SQLiteCommand comm = new SQLiteCommand()) {
      comm.Connection = conn;
      comm.CommandText = " create table test (n integer) ";
      comm.ExecuteNonQuery();
      Stopwatch s = new Stopwatch();
      s.Start();
      using (SQLiteTransaction tran = conn.BeginTransaction()) {
        for (int i = 0; i < limit; i++) {
          comm.CommandText = "insert into test values (" + i.ToString() + ")";
          comm.ExecuteNonQuery();
        }
        tran.Commit();
      }
      s.Stop();
      MessageBox.Show("time without parm " + s.ElapsedMilliseconds.ToString());

      SQLiteParameter parm = comm.CreateParameter();
      comm.CommandText = "insert into test values (?)";
      comm.Parameters.Add(parm);
      s.Reset();
      s.Start();
      using (SQLiteTransaction tran = conn.BeginTransaction()) {
        for (int i = 0; i < limit; i++) {
          parm.Value = i;
          comm.ExecuteNonQuery();
        }
        tran.Commit();
      }
      s.Stop();
      MessageBox.Show("time with parm " + s.ElapsedMilliseconds.ToString());

    }
    conn.Close();
  }
} 
```

当谈到使用参数化 sql 语句的重要性时，Sqlite 的行为类似于 Oracle。

# c# - ASP.NET Response.End 问题

> ID：904802
> 
> 赞同：0
> 
> 时间：2009-05-24T22:34:47.830
> 
> 标签：c#, asp.net

我有一个用户从那里下载文件的页面。当用户单击下载链接并完成下载文件时，我正在为我的文件下载计数器事件插入一条新记录。（文件ID，日期，blalbla ..）

但是我的脚本有问题......下载开始并完成后，它添加了一条新记录，但在此之后，它再次触发事件并创建新记录。所以 1 次下载和 2 次新下载记录。这是我的脚本；

```
 if (Page.Request.QueryString["FileID"] != null)
        {
            OleDbCommand command = new OleDbCommand("select * from Dosyalar where DosyaID=" + Page.Request.QueryString["FileID"].ToString(), veri.baglan());

            string dosyaAdi = "";
            int DosyaID = 0;
            OleDbDataReader dr = command.ExecuteReader();
            while (dr.Read())
            {

                dosyaAdi = Server.MapPath("formlar") + "\\" + dr["URL"].ToString();
                DosyaID = Convert.ToInt32(dr["FileID"]);

            }
            dr.Close();

            FileInfo dosya = new FileInfo(dosyaAdi);
            Response.Clear();
            Response.AddHeader("Content-Disposition", "attachment; filename=" + dosya.Name);
            Response.AddHeader("Content-Length", dosya.Length.ToString());
            Response.ContentType = "application/octet-stream";
            Response.WriteFile(dosyaAdi);
           // INSERT A NEW RECORD 
            OleDbCommand ekle = new OleDbCommand("Insert into Indirilenler (FileID,Tarih) values (@p1,@p2)", veri.baglan());
            ekle.Parameters.AddWithValue("p1", FileID);
            ekle.Parameters.AddWithValue("p2", DateTime.Now.ToShortDateString());
            ekle.ExecuteNonQuery();
            Response.Flush();
            Response.End(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T23:17:00.257

问题是浏览器实际上是在发出两个请求来获取文件。这是典型的行为。

您可以打开此页面上的 OutputCaching。这应该意味着浏览器的第二个请求不会到达您的服务器，因此只记录一个条目，但您还需要确保您的 web.config 文件中没有设置调试标志。

另一个选项是检测请求类型。我认为浏览器发送的第一个请求通常是 HEAD 请求，而不是 GET 或 POST。您可以适当地检测和处理这些，但我认为第一个选项可能更可靠。

此外，您真的应该将其编码为 ASPX 处理程序而不是页面。这意味着您可以避免`response.Clear()`URI 的内容类型，因此您不会混淆浏览器。

# html - 带有浮动内容的全尺寸列？

> ID：904807
> 
> 赞同：0
> 
> 时间：2009-05-24T22:39:00.193
> 
> 标签：html, css

我的网站在这里：

[绿色 McP](http://www.greenmcp.com/index.php?/projects/)

我正在尝试将我的旧 WP 支持的站点放入 Expression Engine（只是为了咯咯笑），并且我坚持我的项目布局：我想要一个我的项目网格，每个 div 都有一个设置的高度/宽度。如果我不将它们向左浮动，它们只会垂直堆叠。如果我确实将它们向左浮动，它们会按我的意愿排列，但背景中的#column 会失去它的高度，从而失去 BG。可以使用 min-height: 700px 使其更大，但正如我所说的那样，这在 IE 中不起作用。将事物放入网格的另一种方法是什么（最好没有表格）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T22:42:09.360

你只需要清除浮动。

您可以添加`overflow: hidden;`到`#column`容器中。

有关“clearfix”的更多信息和详细信息，请查看：[http ://www.webtoolkit.info/css-clearfix.html](http://www.webtoolkit.info/css-clearfix.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T22:43:11.697

您必须执行以下操作之一：

*   使#column 也向左浮动；或者
*   设置`overflow: auto`为#column

# jquery - 查找 float 中选择的总和

> ID：904817
> 
> 赞同：2
> 
> 时间：2009-05-24T22:51:34.240
> 
> 标签：jquery, user-interface, graph, flot

如果我将函数绑定到 flot 的“plotselected”事件，有没有办法获取所选区域的起点和终点的主要系列索引？

我看到使用“plothover”可以使用“item”变量，但不清楚这是否适用于选择。另外，我不想每次调用函数时都遍历整个系列。我的目标是得到类似的东西：

```
 $("#placeholder").bind("plotselected", function (itemx1, itemx2) {
          var x1 = itemx1.plot.pos //The index for this plot point in series";
          var x2 = itemx2.plot.pos //The index for this plot point in series";
          var sum = 0;
          for (var i = x1; i < x2; i++) {
               sum += d[i][0];
               }
          $("#total_selected").text(sum);
          }); 
```

如果我能做到这一点，我还可以（使用我的数据）输出如下内容：

```
 "You earned X points over Y days, Z hours, F minutes. Good Job!" 
```

看起来这应该很简单，但是 flot 真的让我陷入了循环。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T19:20:03.740

来自[flot api 文档](http://flot.googlecode.com/svn/trunk/API.txt)：“plotselected”事件函数采用两个参数“事件”和“范围”。范围对象包含选择的 x 和 y 坐标。

```
$('#placeholder').bind('plotselected', function (event, ranges) {
  var x1 = ranges.xaxis.from;
  var x2 = ranges.xaxis.to;
  var y1 = ranges.yaxis.from;
  var y2 = ranges.yaxis.to;       
  var sum = 0;

  /* The values returned by the coordinates are floats. 
     You may need to tweak this to get the correct results.*/
  for (var i = x1; i < x2; i++) {
       sum += d[i][0];
  }
  $("#total_selected").text(sum);
}); 
```

# java - 我可以从本机 C++ 中检测 Java 版本吗

> ID：904824
> 
> 赞同：4
> 
> 时间：2009-05-24T22:58:35.083
> 
> 标签：java, c++, version

我正在用本机 C++/MFC 编写一个复杂的安装程序/安装程序。我非常希望能够检测到已安装的 Java 版本（如果有）。

这是可能的，那么，如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:01:21.723

派生一个执行以下命令的进程：`java -version`. 收集输出并解析它。它看起来像下面这样：

```
java version "1.5.0_16"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_16-b06-284)
Java HotSpot(TM) Client VM (build 1.5.0_16-133, mixed mode, sharing) 
```

这被写入标准错误。您需要收集 stderr 输出并对其进行解析。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T07:35:29.473

我建议使用注册表。您正在对窗口进行编程，所以以 Windows 方式进行。注册焦虑是不合理的。

版本的注册表项：

```
HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Runtime Environment\CurrentVersion 
```

可以在[此处](http://www.developer.com/net/cplus/article.php/3449721#enumerateValues)找到如何从注册表中获取值的信息。

可以在[此处](http://mindprod.com/jgloss/registry.html)找到有关其他 java 相关注册表项的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T23:03:43.527

您可以尝试`java -version`在子进程中运行（使用管道读取该进程的输出）并解析结果（如果有）；或者，您可能会弄乱 Windows 的注册表（感觉更复杂，但可能不那么笨拙）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T23:19:47.410

还要记住，一台机器上同时安装多个 JRE 是完全可能的。如果您的安装程序检测到多个 JRE，它应该为用户提供一个选择，而不是假设其中一个（例如最新的一个）应该是您的应用程序使用的那个。

# .net - 将非 CLR 代码链接到 .NET 应用程序

> ID：904827
> 
> 赞同：0
> 
> 时间：2009-05-24T23:00:55.093
> 
> 标签：.net, windows, visual-c++, clr, unmanaged

我是 Visual C++、.NET 和 Windows 编程世界（来自 Objective-C/Cocoa）的新手，我正在尝试使用我编译为 .lib 的 CFLite（Open CoreFoundation Lite）库文件。它是用纯非托管 C 语言编写的，我想在我的托管 CLR .NET 应用程序中使用它。当我尝试链接它并使用函数 CFSTR（__CFStringMakeConstantString 的快捷方式）时，它严重失败。有什么建议吗？附上错误。

```
Proj.obj : error LNK2031: unable to generate p/invoke for "extern "C" struct __CFString const * __clrcall __CFStringMakeConstantString(char const *)" (?__CFStringMakeConstantString@@$$J0YMPBU__CFString@@PBD@Z); calling convention missing in metadata
Proj.obj : warning LNK4248: unresolved typeref token (01000016) for '__CFString'; image may not run
Proj.obj : error LNK2028: unresolved token (0A00000B) "extern "C" struct __CFString const * __clrcall __CFStringMakeConstantString(char const *)" (?__CFStringMakeConstantString@@$$J0YMPBU__CFString@@PBD@Z) referenced in function "int __clrcall main(cli::array<class System::String ^ >^)" (?main@@$$HYMHP$01AP$AAVString@System@@@Z)
Proj.obj : error LNK2019: unresolved external symbol "extern "C" struct __CFString const * __clrcall __CFStringMakeConstantString(char const *)" (?__CFStringMakeConstantString@@$$J0YMPBU__CFString@@PBD@Z) referenced in function "int __clrcall main(cli::array<class System::String ^ >^)" (?main@@$$HYMHP$01AP$AAVString@System@@@Z) 
```

更新：我最终只使用了带有 Win32 调用的本机应用程序，因为无论如何我的用户界面都将是最小的（它是一个后台应用程序）。我玩了一下 p/invoke，对于像我这样的新手来说，这似乎很复杂：p 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T23:06:08.780

[http://www.codeproject.com/KB/mcpp/timeserver.aspx](http://www.codeproject.com/KB/mcpp/timeserver.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T23:46:19.107

与 C 库中的函数签名相比，您在托管 C++ 应用程序中使用的函数签名看起来不匹配。

.Net 用于在托管世界和非托管世界之间进行通信的技术是 PInvoke。有关如何使用 PInvoke 的示例的最佳资源是[pinvoke.net](http://pinvoke.net/)。您的 C 函数签名看起来非常简单，因此使用正确编组的参数在 C++ 中创建匹配的函数签名应该很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T23:14:08.390

我知道使用非托管托管代码的方法是构建一个 DLL 或使用 COM。

# ruby-on-rails - 在 Rails 中将模型加载到 cron 文件中

> ID：904830
> 
> 赞同：1
> 
> 时间：2009-05-24T23:01:27.480
> 
> 标签：ruby-on-rails, model, cron

我的应用程序目录中有一个名为 cron 的目录。在 cron 目录中，我放置了我的 cron 文件。如何访问我的 cron 文件中的模型？

放置我的 cron 文件的最佳位置是哪个？

编辑：我正在尝试执行 cron 文件，就像 ruby​​ cron.rb 一样

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T00:17:13.333

我假设您想要做的是将脚本（已保存在`cron`文件夹中）作为 cronjob 运行，但您希望它在运行之前加载 Rails 环境，包括访问您的 ActiveRecord 模型。

如果是这种情况，您要使用的是`script/runner`Rails 应用程序中的脚本，并为其提供您要运行的脚本的名称，例如

```
script/runner cron/my_cron_script.rb 
```

如果要将其添加为 cronjob，请将其添加到您的 crontab，如下所示。使用命令编辑您的 crontab 并在`crontab -e`其中放置如下内容：

```
* * * * * /path/to/my/app/script/runner /path/to/my/app/cron/my_cron_script.rb 
```

# coldfusion - 冷泉五分钟

> ID：904831
> 
> 赞同：0
> 
> 时间：2009-05-24T23:03:12.717
> 
> 标签：coldfusion, frameworks, coldspring

我将在 5 分钟内重读 ColdSpring。它说“UserService 需要 UserGateway，而 UserGateway 需要 ConfigBean”。不，不是的！UserService 不需要任何东西。它不调用 UserGateway。

它所做的只是设置一个碰巧调用 userGateway 的变量，但它不调用 User Gateway 组件。

帮助我理解这个看似简单的场景！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T13:10:02.793

您必须记住，此入门应用程序有意不解释所有内容，以防止混淆。完全配置后，示例应用程序将初始化所有三个组件。UserService CFC 负责设置和获取 User Gateway 组件，User Gateway 组件负责设置和获取 Config Bean 组件，而 Config Bean 组件旨在设置和获取应用程序设置（在这种情况下，只是数据源信息）。

如果您不了解这一切是如何运作的，我现在不会为此烦恼太多。ColdSpring 的参考指南将为您带来一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:38:48.367

“UserService 需要 UserGateway”这一行意味着其中一个函数包含需要 UserGateway 的变量或调用，而不一定是 UserService 对它有任何内在需求。这是 ColdSpring 所做工作的核心……管理依赖项。如果未将 UserService 配置为使用 UserGateway 注入，则当创建“恰好”调用或需要 UserGateway 的变量时，除非您手动实例化它，否则它将无法找到所需的 UserGateway。

例如，在“Factory Beans”中的 ColdSpring 快速入门指南中的“更高级”下查看。

5分钟的例子只是一个例子，你没有看到那些需要UserGateway的函数中的任何调用，但是当你确实需要它时，你会很高兴它为你注入，这样你就不需要不必自己做。

# sql-server - 运行通过 SQL Server 2005 操作数据和发送电子邮件的夜间进程的最佳方式

> ID：904843
> 
> 赞同：1
> 
> 时间：2009-05-24T23:13:43.227
> 
> 标签：sql-server, clr, scheduled-tasks, sqlclr

我有一个针对 SQL Server 2005 运行的 asp 应用程序，我想运行以下进程：

*   查询数据，
*   操作数据，以及
*   发送包含特定数据和分析的电子邮件

在 SQL Server 2005 中执行此操作的最简单方法是什么？我可以在 SSIS 包中执行此操作吗？我应该使用 CLR 程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T03:14:37.813

您可以使用 SSIS 包或仅使用 TSQL 更好地执行此操作。

如果您需要进一步的帮助/想法，您能否提供更多详细信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T06:56:44.747

也许，您可以使用 SQL Server 2005（标准或更高版本）中的作业并简单地执行查询存储过程来满足此范围。您需要查询哪些数据和基于哪些参数？

你需要做什么样的操作？要发送结果，您可以使用 SQL Server Mail。

因此，您将完全独立于您的 ASP 应用程序来执行此任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T08:15:27.863

正如其他人所说，您可以通过 SQL Server 集成服务或 SQL Server 作业和存储过程的组合来实现这一点。

就个人而言，我建议您查看 SSIS 路线，因为可用的现有组件任务将提供您所需的大部分功能，开箱即用，从而加快您的开发过程。

如果您想巧妙地处理您的报告并提供看起来非常专业的结果，您可以定义一个 SQL Server Reporting Services 报告并从 SSIS 中调用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:07:06.390

根据它们的复杂程度，只需使用 T-SQL 存储过程，包括使用 xp_send_dbmail 发送电子邮件，然后使用 SQL 代理作业安排它。

# glassfish - 在 Ubuntu 上手动安装 Glassfish

> ID：904847
> 
> 赞同：0
> 
> 时间：2009-05-24T23:16:15.437
> 
> 标签：glassfish, environment-variables, ubuntu-9.04

我刚刚使用[本](http://computingwithjasper.blogspot.com/2008/01/installing-glassfish-2-on-ubuntu-710.html)教程在我的**Ubuntu**服务器（无 GUI）上安装了 Glassfish。一切顺利。但是现在当我尝试使用 ASADMIN 工具时，它告诉我：

> 当前未安装程序“asadmin”。您可以通过键入以下命令进行安装：apt-get install glassfishv2 -bash: asadmin: command not found

所以，为了运行 asadmin 工具总是需要输入：

> /opt/glassfish/bin/asadmin 启动域 domain1

或转到该文件夹​​并从那里运行它。

所以，问题是，我需要编辑什么文件才能将此路径设置到环境中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:23:58.200

您可以将以下内容添加到您的 ~/.bashrc 文件中，以将 /opt/glassfish/bin 中的所有二进制文件添加到您的 $PATH

```
export PATH=$PATH:/opt/glassfish/bin 
```

~ 扩展为 /home/your-user - 只是为了清楚起见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T06:54:58.130

只需键入 CLI：

> 导出 PATH=/opt/glassfish/bin/:$PATH

# python - 日期时间模块的问题-Python

> ID：904852
> 
> 赞同：0
> 
> 时间：2009-05-24T23:20:22.013
> 
> 标签：python

这是怎么回事：

```
import datetime
now = datetime.datetime.now()
month = '%d' % now.month

print month 
```

但这不是吗？

```
import datetime
now = datetime.datetime.now()
month = '%m' % now.month

print month 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:22:45.003

%m 不是 % 运算符支持的格式字符。这是此运算符支持的[格式字符列表](http://docs.python.org/library/stdtypes.html#string-formatting-operations)

当您使用[strftime](http://docs.python.org/library/time.html#time.strftime)函数构建日期字符串时，%m 有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T23:28:18.860

`'%d'`是插入“有符号整数十进制”的格式字符，`'%m'`没有这样的含义。[此处](http://docs.python.org/library/stdtypes.html#string-formatting)列出了可能的格式字符。

# emacs - 多个 hideshow 正则表达式

> ID：904853
> 
> 赞同：1
> 
> 时间：2009-05-24T23:21:18.703
> 
> 标签：emacs

在 emacs 中，有没有办法让 hideshow-mode 识别多个正则表达式进行隐藏？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T00:14:51.870

取自[EmacsWiki](http://www.emacswiki.org/cgi-bin/wiki/HideShow)。如果我正确理解您的问题，您可能会运气不好，但是“没有简单的方法”可能意味着有一个复杂的方法可以找到。

祝你好运

> 没有简单的方法可以为一种语言指定多个正则表达式对，例如，
> 
> ```
> * Open: {, close: }
> * Open: #ifdef, close: #else or #elif or … etc. 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-25T03:48:47.283

我假设您的意思是在相同的模式下。这可以做到，但需要一些 elisp 和一些小的正则表达式。您将需要拥有或创建一种方法来检测您所处的子模式。

让我们以 mhtml-mode(HTML/CSS/JS) 为例：

```
;;; .emacs

;; When called this automatically detects the submode at the current location.
;; It will then either forward to end of tag(HTML) or end of code block(JS/CSS).
;; This will be passed to hs-minor-mode to properly navigate and fold the code.
(defun mhtml-forward (arg)
  (interactive "P")
  (pcase (get-text-property (point) `mhtml-submode)
    (`nil (sgml-skip-tag-forward 1))
    (submode (forward-sexp))))

;; Adds the tag and curly-brace detection to hs-minor-mode for mhtml.
(add-to-list 'hs-special-modes-alist
             '(mhtml-mode
               "{\\|<[^/>]*?"
               "}\\|</[^/>]*[^/]>"
               "<!--"
               mhtml-forward
               nil)) 
```

该函数`mhtml-forward`检测应该使用哪种类型的转发语句。

然后将 Hideshow 设置为识别开头表达式`{`and `<tag>`，以及结尾表达式`}`and `</tag>`。它将始终与正确的匹配，因为自定义转发功能可让您获得该特定实例的正确结束表达式。

# c# - 加载外部字体并在 C# 中使用

> ID：904857
> 
> 赞同：2
> 
> 时间：2009-05-24T23:22:49.510
> 
> 标签：c#, wpf, fonts, load

我想从外部服务器加载字体，一旦加载（我想这是必要的）使用它来创建一些文本字段。

我正在努力：

```
font_uri = new Uri("http://localhost/assets/fonts/wingding.ttf");
bf_helvetica = new FontFamily(font_uri, "bf_helvetica");

TextBlock test_tb = new TextBlock();
test_tb.Text = "This is a test";
test_tb.FontSize = 16;
test_tb.Foreground = Brushes.Red;
test_tb.FontFamily = bf_helvetica;
stage.Children.Add(test_tb); 
```

但它使用默认字体创建文本块。有任何想法吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T23:39:55.950

如果您可以将其加载到 Stream 中，请尝试使用[PrivateFontCollection](http://msdn.microsoft.com/en-us/library/system.drawing.text.privatefontcollection.aspx)。[我对另一个问题的回答中的](https://stackoverflow.com/questions/727053/how-do-i-embed-a-font-with-my-c-application-using-visual-studio-2005/727127#727127)示例代码。

**编辑**：参见[System.Net.WebRequest.GetRequestStream](http://msdn.microsoft.com/en-us/library/system.net.webrequest.getrequeststream.aspx)，将 URI 加载到 Stream 中，然后将该 Stream 加载到 PFC 中，如链接代码中所述。

另外，我会将文件保存在本地，然后先在那里查找，这样您就不必每次运行程序时都下载它。

**再次编辑**：抱歉，不是 WebRequest.GetRequestStream，您需要 WebResponse.GetResponseStream()。这是一些示例代码，可以完全满足您的需求。

```
using System;
using System.Drawing;
using System.Drawing.Text;
using System.IO;
using System.Net;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace RemoteFontTest
{
    public partial class Form1 : Form
    {
        readonly PrivateFontCollection pfc = new PrivateFontCollection();

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            WebRequest request = WebRequest.Create(@"http://somedomain.com/foo/blah/somefont.ttf");
            request.Credentials = CredentialCache.DefaultCredentials;

            WebResponse response = request.GetResponse();

            using (Stream fontStream = response.GetResponseStream())
            {
                if (null == fontStream)
                {
                    return;
                }

                int fontStreamLength = (int)fontStream.Length;

                IntPtr data = Marshal.AllocCoTaskMem(fontStreamLength);

                byte[] fontData = new byte[fontStreamLength];
                fontStream.Read(fontData, 0, fontStreamLength);

                Marshal.Copy(fontData, 0, data, fontStreamLength);

                pfc.AddMemoryFont(data, fontStreamLength);

                Marshal.FreeCoTaskMem(data);
            }
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            using (SolidBrush brush = new SolidBrush(Color.Black))
            {
                using (Font font = new Font(pfc.Families[0], 32, FontStyle.Regular, GraphicsUnit.Point))
                {
                    e.Graphics.DrawString(font.Name, font, brush, 10, 10, StringFormat.GenericTypographic);
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T04:23:49.017

您传递给 FontFamily 构造函数的姓氏实际上是字体文件公开的姓氏吗？在您的示例中，如果您加载了 Wingding.ttf，字体系列名称将是 Wingdings，而不是 bf_helvetica。如果字体文件是 bf_helvetica.ttf，则家族名称可能不是字体名称，例如 Helvetica 或 Helvetica Bold。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-28T20:00:09.470

我发布了一个真正类型字体的解决方案，但它可以与其他类型一起使用。

[C# 如何在 Visual Studio 中向项目添加 TTF](http://hongouru.blogspot.com/2010/10/c-how-to-add-fonts-ttf-true-type-fonts.html)

[http://hongouru.blogspot.com/2010/10/c-how-to-add-fonts-ttf-true-type-fonts.html](http://hongouru.blogspot.com/2010/10/c-how-to-add-fonts-ttf-true-type-fonts.html)

我希望它有所帮助。

# javascript - Javascript 和 Actionscript 3 [设置变量问题]

> ID：904862
> 
> 赞同：0
> 
> 时间：2009-05-24T23:28:58.610
> 
> 标签：javascript, actionscript-3, google-maps

好的，所以我正在尝试通过 javascript 方法调用来设置变量。但是，这是行不通的。我用谷歌搜索并结束了 ip 返回并尝试 swLiveConnect，但这已经过时了，事实证明我的方式现在就是这样做的方式。所以这是我的javascript函数和actionscript。我不知道发生了什么，我在更熟练的动作脚本者面前鞠躬。

**动作脚本**

```
//==========================================================
function decide_proposal(e:Event):void {
//==========================================================
    var address1:String = form1.project_address.text + ", " + form1.project_city.text + ", " + form1.project_state.text + ", " + form1.project_zip.text;
    var distance:Number = ExternalInterface.call("showLocation(" + address1 + ")");

    var commit:String = e.currentTarget.name;
    if (form1.stories.value >= 2.5 || form1.wood_no.selected || form1.framed_sqft.value >= 5000 || form1.roof_slope.value < 3 || form1.civil.selected || form1.cmt.selected || form1.commercial.selected || form1.c.selected || distance >= 180 || form1.bore_holes1.value >= 4) {
      send_proposal(e);
    } else if (commit == "quote") {
      perform_calculations(distance);
    } else {
      send_proposal(e);
    }
} 
```

**Javascript**

```
var geocoder;
var location1;

function initialize() {
    geocoder = new GClientGeocoder();
}
function showLocation(address) {
    var locations = 0;
    geocoder.getLocations(address, function (response) {
        if (!response || response.Status.code != 200)
        {
            alert("There was an error");
        }
        else
        {
            location1 = {lat: response.Placemark[0].Point.coordinates[1], lon: response.Placemark[0].Point.coordinates[0]};
        }
    });
    var glatlng1 = new GLatLng(location1.lat, location1.lon);
    var brenham = new GLatLng(30.152289,-96.384881);
    var college_station = new GLatLng(30.610584,-96.306002);
    var miledistance1 = glatlng1.distanceFrom(brenham);
    var miledistance2 = glatlng1.distanceFrom(college_station);

    if (miledistance1 <= miledistance2) {
        locations = (miledistance1 * .000621371192);
    } else {
        locations = (miledistance2 * .000621371192);
    }
    return locations;
}
window.onload=function() {initialize();} 
```

我相当肯定这与退货有关，但不确定。此时我已经尝试跟踪传递给函数的地址，它是正确的。我已经追踪了通话前后的距离设置。之前，NaN；之后，0。从 Firebug 我得到正确的数字。我只是不知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T23:34:37.507

确保 HTML 对象/嵌入代码中有 allowScriptAccess="always" 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T23:40:54.983

我不太确定，但是……试一试：

```
function showLocation(address) {
    var locations = geocoder.getLocations(address, function (response) {
        if (!response || response.Status.code != 200)
        {
                alert("There was an error");
        }
        else
        {
                location1 = {lat: response.Placemark[0].Point.coordinates[1], lon: response.Placemark[0].Point.coordinates[0]};
                var glatlng1 = new GLatLng(location1.lat, location1.lon);
                var brenham = new GLatLng(30.152289,-96.384881);
                var college_station = new GLatLng(30.610584,-96.306002);
                var miledistance1 = glatlng1.distanceFrom(brenham);
                var miledistance2 = glatlng1.distanceFrom(college_station);

                if (miledistance1 <= miledistance2) {
                        return (miledistance1 * .000621371192);
                } else {
                        return (miledistance2 * .000621371192);
                }
        }
    });
    return locations;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T01:55:05.600

问题似乎`geocoder.getLocations`是没有返回您传递给它的函数的返回值。您可以尝试使用闭包：

```
function showLocation(address) {
    var retval
    geocoder.getLocations(address, function (response) {
                                       ... // don't use another 'var retval' here
                                       reval = ...
                                   }
    return retval
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T15:21:00.987

好的，问题很简单。我错误地将参数传递给函数。这是你如何做到的：

```
 var distance:Number = ExternalInterface.call("showLocation", address1); 
```

Annnnd Bob 是你的叔叔。

# c++ - 如何保证 read() 实际上通过命名管道发送 write() 发送的 100% 数据

> ID：904866
> 
> 赞同：0
> 
> 时间：2009-05-24T23:34:37.787
> 
> 标签：c++, unix, named-pipes

我有以下两个程序，一个充当读者，另一个充当作家。作者似乎只正确发送了大约 3/4 的数据以供读者阅读。有没有办法保证所有数据都被发送？我想我已经设置好它可以可靠地读取和写入，但它似乎仍然错过了 1/4 的数据。

这里是作者的来源

```
#define pipe "/tmp/testPipe"

using namespace std;

queue<string> sproutFeed;

ssize_t r_write(int fd, char *buf, size_t size) {
   char *bufp;
   size_t bytestowrite;
   ssize_t byteswritten;
   size_t totalbytes;

   for (bufp = buf, bytestowrite = size, totalbytes = 0;
        bytestowrite > 0;
        bufp += byteswritten, bytestowrite -= byteswritten) {
      byteswritten = write(fd, bufp, bytestowrite);
            if(errno == EPIPE)
            {
            signal(SIGPIPE,SIG_IGN);
            }
      if ((byteswritten) == -1 && (errno != EINTR))
         return -1;
      if (byteswritten == -1)
         byteswritten = 0;
      totalbytes += byteswritten;
   }
   return totalbytes;
}

void* sendData(void *thread_arg)
{

int fd, ret_val, count, numread;
string word;
char bufpipe[5];

ret_val = mkfifo(pipe, 0777); //make the sprout pipe

if (( ret_val == -1) && (errno != EEXIST)) 
{
    perror("Error creating named pipe");
    exit(1);
}   
while(1)
{
    if(!sproutFeed.empty())
    {
        string s;
        s.clear();
        s = sproutFeed.front();
        int sizeOfData = s.length();
        snprintf(bufpipe, 5, "%04d\0", sizeOfData); 
        char stringToSend[strlen(bufpipe) + sizeOfData +1];
        bzero(stringToSend, sizeof(stringToSend));                  
        strncpy(stringToSend,bufpipe, strlen(bufpipe));         
        strncat(stringToSend,s.c_str(),strlen(s.c_str()));
        strncat(stringToSend, "\0", strlen("\0"));                  
        int fullSize = strlen(stringToSend);            
        signal(SIGPIPE,SIG_IGN);

        fd = open(pipe,O_WRONLY);
        int numWrite = r_write(fd, stringToSend, strlen(stringToSend) );
        cout << errno << endl;
        if(errno == EPIPE)
        {
        signal(SIGPIPE,SIG_IGN);
        }

        if(numWrite != fullSize )
        {               
            signal(SIGPIPE,SIG_IGN);
            bzero(bufpipe, strlen(bufpipe));
            bzero(stringToSend, strlen(stringToSend));
            close(fd);
        }
        else
        {
            signal(SIGPIPE,SIG_IGN);
            sproutFeed.pop();
            close(fd);
            bzero(bufpipe, strlen(bufpipe));
            bzero(stringToSend, strlen(stringToSend));
        }                   
    }
    else
    {
        if(usleep(.0002) == -1)
        {
            perror("sleeping error\n");
        }
    }
} 
```

}

```
int main(int argc, char *argv[])
{
    signal(SIGPIPE,SIG_IGN);
    int x;
    for(x = 0; x < 100; x++)
    {
        sproutFeed.push("All ships in the sea sink except for that blue one over there, that one never sinks. Most likley because it\'s blue and thats the mightiest colour of ship. Interesting huh?");
    }
    int rc, i , status;
    pthread_t threads[1];       
    printf("Starting Threads...\n");
    pthread_create(&threads[0], NULL, sendData, NULL);
    rc = pthread_join(threads[0], (void **) &status);

} 
```

这是读者的来源

```
#define pipe "/tmp/testPipe"

char dataString[50000];
using namespace std;
char *getSproutItem();

void* readItem(void *thread_arg)
{
    while(1)
    {
        x++;
        char *s = getSproutItem();
        if(s != NULL)
        {
            cout << "READ IN: " << s << endl;
        }
    }
}

ssize_t r_read(int fd, char *buf, size_t size) {
   ssize_t retval;
   while (retval = read(fd, buf, size), retval == -1 && errno == EINTR) ;
   return retval;
}

char * getSproutItem()
{
    cout << "Getting item" << endl;
    char stringSize[4];
    bzero(stringSize, sizeof(stringSize));
    int fd = open(pipe,O_RDONLY);
    cout << "Reading" << endl;

    int numread = r_read(fd,stringSize, sizeof(stringSize));

    if(errno == EPIPE)
    {
        signal(SIGPIPE,SIG_IGN);

    }
    cout << "Read Complete" << endl;

    if(numread > 1)
    {

        stringSize[numread] = '\0'; 
        int length = atoi(stringSize);
        char recievedString[length];
        bzero(recievedString, sizeof(recievedString));
        int numread1 = r_read(fd, recievedString, sizeof(recievedString));
        if(errno == EPIPE)
        {

signal(SIGPIPE,SIG_IGN);
    }       
    if(numread1 > 1)
    {
        recievedString[numread1] = '\0';
        cout << "DATA RECIEVED: " << recievedString << endl;
        bzero(dataString, sizeof(dataString));
        strncpy(dataString, recievedString, strlen(recievedString));
        strncat(dataString, "\0", strlen("\0"));
        close(fd);  
        return dataString;
    }
    else
    {
        return NULL;
    }

}
else
{
    return NULL;
}

close(fd); 
```

}

```
int main(int argc, char *argv[])
{
        int rc, i , status;
        pthread_t threads[1];       
        printf("Starting Threads...\n");
        pthread_create(&threads[0], NULL, readItem, NULL);
        rc = pthread_join(threads[0], (void **) &status); 

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T04:35:54.347

您肯定以错误的方式使用信号。这里完全不需要线程——至少在提供的代码中是这样。字符串计算很奇怪。拿到[这本书](http://www.kohala.com/start/apue.html)，在你读完之前不要触摸键盘：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T23:48:18.853

很难说这里发生了什么。也许您的系统调用之一返回了错误？您确定您已成功发送所有数据吗？

~~您在这里似乎也有一些无效代码：~~

 ~~```
 int length = atoi(stringSize);
    char recievedString[length]; 
```~~ 

~~这是一个语法错误，因为您不能使用非常量表达式在堆栈上创建数组的大小。也许您在真实版本中使用了不同的代码？~~

您需要循环读取数据吗？有时一个函数会返回一部分可用数据，并要求您重复调用它，直到所有数据都消失。

如果系统调用被中断，Unix 中的一些系统调用也可以返回 EAGAIN - 从事物的外观来看，您并没有处理这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T23:49:22.907

用于通过命名管道发送数据的一般方法是在标头上附加有效负载的长度。然后你读(fd, header_len); 读取（rd，data_len）；请注意，后者 read() 需要在循环中完成，直到读取 data_len 或 eof。另请注意，如果您有多个写入器到命名管道，那么写入是原子的（只要合理的大小）IE 多个写入器不会在内核缓冲区中处理部分消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T00:04:53.123

您可能会被阅读器主线程中的 POSIX 线程信号处理语义所困扰。POSIX 标准允许 POSIX 线程接收信号，而不一定是您期望的线程。在不需要的地方阻止信号。 `signal(SIG_PIPE,SIG_IGN)`是你的朋友。向阅读器主添加一个。

POSIX 线程处理语义，将 POS 放入 POSIX。（但它确实更容易实现 POSIX 线程。）

用 ls 检查 /tmp 中的管道？不是空的吗？

# iphone - iPhone：搜索需要多长时间？

> ID：904869
> 
> 赞同：0
> 
> 时间：2009-05-24T23:37:32.710
> 
> 标签：iphone, search, local, uisearchbar

这是一个非常直接的问题：在本地搜索 200-300 个字符串的数组需要多长时间？远程呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T02:43:49.030

如果您正在搜索字母字符串，并且搜索时间过长，您可以尝试将字符串列表转换为 DAWG（有向无环词图，易于 google）。我这样做了一个很长的列表（大约 170,000 字），并获得了 18,000 的改进率。

乔丹纳

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T00:11:00.867

搜索？凭什么？

如果您只是在运行：

```
[myStringArray containsObject:searchString]; 
```

然后可以在几微秒内搜索 200-300 个字符串。

如果您正在搜索：

```
BOOL found = NO
for (NSString *string in myStringArray)
{
    if ([string rangeOfString:searchString].location != NSNotFound)
    {
        found = YES;
         break;
    }
} 
```

然后它几乎完全取决于每个字符串的长度，但对于少于几十个字符的字符串，它与之前的搜索速度大致相同。

远程搜索完全不同——但是对于这样的操作来说是一种巨大的时间浪费。它完全基于网络延迟。按平均 250 毫秒 ping 计算，远程操作的平均时间约为半秒或更长，因为生成网络数据包、通过网络发送、等待远程服务器接收、等待远程服务器需要很长时间服务器处理，等待响应并解析响应。

如果这个问题是一种迂回的提问方式：我是否应该只获取所有 30 个字符串并在本地搜索 - 那么：是的，在本地搜索。通常：本地搜索会更快，直到下载所有结果所需的时间成为负担（超过 3G，我通常认为快速透明下载的最大值约为 50kB）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T12:44:54.813

微秒。它非常快。当我发现这一点时，我也很惊讶：p

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T03:06:36.923

这是关于本地字符串搜索的。

我已经实现了 Trie 数据结构来索引字符串以实现*快速*自动完成。 [http://en.wikipedia.org/wiki/Trie](http://en.wikipedia.org/wiki/Trie)

# entity-framework - 手动 DAL & BLL 与 ORM

> ID：904870
> 
> 赞同：5
> 
> 时间：2009-05-24T23:37:55.190
> 
> 标签：entity-framework, orm, devexpress, data-access-layer, bll

哪种方法更好：**1)**使用**第三方 ORM**系统或**2)** **手动编写 DAL 和 BLL 代码**以使用数据库？

**1)**在我们的一个项目中，我们决定使用 DevExpress XPO ORM 系统，但我们遇到了很多小问题，浪费了我们很多时间。amd 仍然时不时会遇到来自这个 ORM 的问题和异常，我们对这个“黑匣子”还没有完全的了解和控制。

**2)**在另一个项目中，我们决定从头开始编写 DAL 和 BLL。虽然这意味着要多次编写无聊的代码，但这种方法被证明更加通用和灵活：我们可以完全控制数据在数据库中的保存方式，如何从中获取数据等。所有的错误都可以以直接和简单的方式进行修复。

**哪种方法**通常**更好**？也许问题只是我们使用的 ORM（DevExpress XPO），也许其他 ORM 更好（例如 NHibernate）？

是否值得使用**ADO 整体框架**？

我发现 DotNetNuke CMS 使用自己的 DAL 和 BLL 代码。其他项目呢？

我想了解**您的个人经历**：您在项目中使用哪种方法，哪种方法更可取？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-25T01:45:18.727

我个人的经验是，ORM 通常完全是在浪费时间。

首先，考虑这背后的历史。早在 60 年代和 70 年代初，我们就有这些 DBMS 使用分层和网络模型。这些使用起来有点麻烦，因为在查询它们时，您必须处理所有检索机制：跟踪各处记录之间的链接，并处理链接不是您想要的链接的情况（例如，为您的特定查询指向错误的方向）。所以 Codd 想到了关系 DBMS 的想法：指定事物之间的关系，在查询中只说你想要的，然后让 DBMS 处理找出检索它的机制。一旦我们有几个很好的实现，数据库人员就喜出望外，每个人都转向它，整个世界都很开心。

直到 OO 人进入商业​​世界。

OO 人员发现了这种阻抗不匹配：业务编程中使用的 DBMS 是关系型的，但 OO 人员在内部存储了带有链接（引用）的东西，并通过找出他们必须遵循的链接的细节并遵循它们来找到东西。是的：这本质上是分层或网络 DBMS 模型。因此，他们投入了很多（通常是巧妙的）努力，将分层/网络模型分层回到关系数据库，顺便丢掉了 RDBMS 给我们的许多优势。

我的建议是学习关系模型，在合适的情况下围绕它设计系统（经常如此），并使用 RDBMS 的强大功能。您将避免阻抗不匹配，您通常会发现查询易于编写，并且您将避免性能问题（例如您的 ORM 层需要数百个查询来完成它应该做的事情）。

在处理查询结果时需要完成一定数量的“映射”，但如果您以正确的方式考虑它，这很容易：结果关系的标题映射到一个类，并且关系中的每个元组都是一个对象。根据您需要的进一步逻辑，为此定义一个实际的类可能值得，也可能不值得；只需处理从结果生成的哈希列表就很容易了。只需浏览并处理列表，做你需要做的事情，你就完成了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-25T00:57:57.730

也许两者都适合。您可以使用像 SubSonic 这样的产品。这样，你可以设计你的数据库，生成你的 DAL 代码（删除所有无聊的东西），使用部分类来用你自己的代码扩展它，如果你愿意，可以使用存储过程，并且通常可以完成更多的事情。

我就是做这个的。我发现这是自动化和控制之间的正确平衡。

我还要指出，通过尝试不同的方法并查看最适合*您*的方法，我认为您走在正确的道路上。我认为这最终是您答案的来源。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-25T00:19:15.420

最近我决定在一个新项目上使用 Linq to SQL，我真的很喜欢它。它是轻量级的、高性能的、直观的，并且在微软（和其他人）的博客中有很多关于它的大师。

Linq to SQL 通过从数据库创建 c# 对象的数据层来工作。DevExpress XPO 的工作方向相反，为您的 C# 业务对象创建表。实体框架应该以任何一种方式工作。我是一名数据库专家，因此为我设计数据库的框架的想法没有多大意义，尽管我可以看到它的吸引力。

我的 Linq to SQL 项目是一个中型项目（数百，可能有数千名用户）。对于较小的项目，有时我只使用 SQLCommand 和 SQLConnection 对象，直接与数据库对话，效果很好。我还使用 SQLDataSource 对象作为[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)的容器，但这些看起来很笨重。

您的项目越大，DAL 就越有意义。如果它是一个 Web 应用程序，我总是使用某种 DAL，因为它们具有针对 SQL 注入攻击、更好地处理空值等的内置保护。

我争论过是否在我的项目中使用实体框架，因为微软表示这将是他们未来数据访问的首选解决方案。但是我觉得 EF 不成熟，如果你在 StackOverflow 上搜索 Entity Framework，你会发现有几个人在为小而迟钝的问题苦苦挣扎。我怀疑第 2 版会好很多。

我对 nHibernate 一无所知，但有些人喜欢它并且不会使用其他任何东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-25T01:15:15.540

您可以尝试使用 NHibernate。由于它是开源的，因此它并不完全是一个黑匣子。它非常通用，并且有许多扩展点供您插入自己的附加或替换功能。

### 评论1：

NHibernate 是一个*真正*的ORM，因为它允许您在任意域模型（类）和任意数据模型（表、视图、函数和过程）之间创建映射。你告诉它你希望你的类如何映射到表，例如，这个类是映射到两个连接表还是两个类映射到同一个表，这个类属性是否映射到多对多关系等。 NHibernate 期望您的数据模型大部分被规范化，但它不需要您的数据模型与您的域模型精确对应，也不会生成您的数据模型。

### 评论 2：

NHibernate 的方法是允许您编写任何您喜欢的类，然后告诉 NHibernate 如何将这些类映射到表。没有要继承的特殊基类，没有所有一对多属性都必须具有的特殊列表类，等等。NHibernate 可以在没有它们的情况下发挥它的魔力。事实上，您的业务对象类根本不应该对 NHibernate 有任何依赖。您的业​​务对象类本身绝对没有持久性或数据库代码。

您很可能会发现您可以对 NHibernate 使用的数据访问策略进行非常精细的控制，以至于 NHibernate 也可能是您复杂案例的绝佳选择。但是，在任何给定的上下文中，您可以随意使用 NHibernate 或不使用它（支持更定制的 DAL 代码），因为 NHibernate 在您不需要它时会尽量不妨碍您。因此，您可以在一个 BLL 类（或方法）中使用自定义 DAL 或 DevExpress XPO，并且可以在另一个中使用 NHibernate。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T15:05:24.603

我最近参加了一个足够大的有趣项目。我没有从一开始就加入它，我们必须支持已经实现的架构。对所有对象的数据访问是通过存储过程实现的，并在 .NET 上自动生成返回 DataTable 对象的包装方法。这种系统的开发过程非常缓慢且效率低下。我们必须为每个查询在 PL/SQL 上编写庞大的存储过程，这可以用简单的 LINQ 查询来表达。如果我们使用 ORM，我们的项目实施速度会快几倍。而且我没有看到这种架构的任何优势。

我承认，这只是一个不太成功的项目，但我得出以下结论：在拒绝使用 ORM 之前，请三思，你真的需要这样的灵活性和对数据库的控制吗？我认为在大多数情况下，浪费时间和金钱是不值得的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T15:23:53.787

正如其他人所解释的那样，ORM 存在一个根本性的困难，这使得大多数时候没有现有的解决方案能够很好地做正确的事情。这篇博文：[计算机科学的越南](http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx)与我的一些感受相呼应。

执行摘要类似于对象模型和关系模型之间不兼容的假设和优化。尽管早期的回报很好，但随着项目的进展，ORM 的抽象不足，而且围绕它工作的额外开销往往会抵消成功。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-10T19:43:26.763

我已经[在 Delphi 中使用 Bold](http://en.wikipedia.org/wiki/Bold_for_Delphi)四年了。它很棒，但它不再出售，并且缺少数据绑定等一些功能。[继任者ECO](http://en.wikipedia.org/wiki/ECO_%28Domain_Driven_Design%29)拥有这一切。不，我不是在销售 ECO 许可证或其他东西，但我只是觉得遗憾的是，很少有人意识到 MDD（模型驱动开发）可以做什么。能够在更短的时间和更少的错误中解决更复杂的问题。这很难衡量，但我听说过 5-10 更有效的开发。当我每天使用它时，我知道这是真的。

也许一些以数据和 SQL 为中心的传统开发人员会说：

1.  “但是性能呢？”
2.  “我可能会失去对运行什么 SQL 的控制！”

好...

1.  如果您想尽可能快地加载表的 10000 个实例，使用存储过程可能会更好，但大多数应用程序不这样做。Bold 和 ECO 都使用简单的 SQL 查询来加载数据。性能高度依赖于加载一定数量数据的数据库查询次数。开发人员可以通过说这些数据属于彼此来提供帮助。尽可能高效地加载它们。

2.  当然可以记录实际执行的查询以捕获任何性能问题。如果你真的想使用你的超优化 SQL 查询，只要它不更新数据库就没有问题。

有许多 ORM 系统可供选择，特别是如果您使用 dot.net。但老实说，做一个好的 ORM 框架是非常非常困难的。它应该集中在模型周围。如果模型发生变化，更改数据库和模型依赖的代码应该是一件容易的事。这使它易于维护。进行小而多的更改的成本非常低。许多开发人员错误地以数据库为中心并围绕它进行调整。在我看来，这不是最好的工作方式。

更多应该尝试ECO。只要模型不超过12个班级，就可以无限次免费使用。你可以用 12 节课做很多事情！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-19T17:07:13.217

我建议您使用 Code Smith Tool 来创建 Nettiers，这对于开发人员来说是一个不错的选择。

# directx - XNA/DirectX：你应该总是使用索引吗？

> ID：904872
> 
> 赞同：1
> 
> 时间：2009-05-24T23:40:38.617
> 
> 标签：directx, xna, vertex-buffer

我正在为植被实现广告牌，其中广告牌当然是由两个三角形组成的单个四边形。顶点数据存储在顶点缓冲区中，但我应该为索引烦恼吗？我知道，当您使用索引时，就发送到显卡的顶点而言，地形之类的节省可能会很大，但是在广告牌上使用索引意味着我每个四边形将有 4 个顶点而不是 6 个，因为每个四边形完全与其他人分开。

是否有可能使用索引实际上会降低性能，因为存在额外的间接级别？还是根本没有任何意义？

我问这个是因为使用索引会使事情稍微复杂化，我很想知道我是否没有做额外的工作，只会让事情变慢（无论是在理论上还是在实践中实际上很明显）。

这是使用 XNA，但应该适用于 DirectX。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T23:30:21.047

使用索引不仅可以通过向卡发送更少的数据来节省带宽，还可以减少顶点着色器必须做的工作量。如果有索引用作键，则可以缓存顶点着色器的结果。

如果您渲染大量这种广告牌植被并且不更改索引缓冲区，我认为您应该会看到一点点收益。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T06:23:25.380

当涉及到非常原始的宝石时，使用索引可能没有任何意义，在这种情况下我什至不会关心性能，即使是适度的硬件也会每秒渲染数百万个三角形。

现在，从技术上讲，您不知道硬件将如何在内部处理数据，无论如何它可能会将它们转换为索引，因为这是最流行的几何表示形式。

# hibernate - JasperReports JRBeanCollectionDataSource 仍然一头雾水

> ID：904876
> 
> 赞同：3
> 
> 时间：2009-05-24T23:41:30.300
> 
> 标签：hibernate, jasper-reports, hql, javabeans, ireport

所以我现在有了我的工作和填写报告。我的程序的用户现在可以将程序中的对象传递给报告对象并使用 JRBeanCollectionDataSource 填充它，这确实有效。但是我无法获得我想要的报告中的所有数据。我对此感到非常困惑，我用名称和类声明的字段如何映射到我的集合中 bean 的属性。

我有一个名为 Item 的休眠持久对象

项目有一个列表属性

属性是一个包含名称、类型和值（所有更持久的对象）的表。

我不仅需要在报告中显示 bean 的属性，还需要在其他 bean 的 List 集合中显示 bean 的属性。我正在使用 iReport 来构建报告，我可以执行 JavaBeanDataSource 以及 HQL，但是由于报告运行时，它将有一个要填充的 bean 集合，但我只需要获取集合的某些元素，具体取决于标准，需要在我的报告中显示字段，例如：

properties.value 其中properties.name = 'foo'

其中 properties 是我的数据源中 bean 的集合属性，基本上有一个查询，将 Bean 中的数据作为我的字段进行查询，甚至能够创建一个子报告，列出集合中的属性是 bean 的属性。

非常感谢任何帮助和指导，非常感谢！

约书亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T07:27:11.100

我终于至少找到了答案的线索，尽管我还没有让它工作。

[http://knol.google.com/k/nasir-qureshi/jasper-reports-working-with-beans-and/3az55pmbwf6s/3](http://knol.google.com/k/nasir-qureshi/jasper-reports-working-with-beans-and/3az55pmbwf6s/3)

这基本上正是我正在做的事情，除了我想将子报表嵌入到报表中，并且我想制作基于标准显示列表的一些元素的报表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-12T02:47:06.923

我猜这没有解决。否则，请在此处更新解决方案。

我在使用 iRerport 3.7.0 时遇到了类似的问题，我在以下位置记录了一个错误

> > [http://jasperforge.org/plugins/mantis/view.php?id=4480](http://jasperforge.org/plugins/mantis/view.php?id=4480)

我还关注了 Nasir Qureshi 的博客

> > [http://knol.google.com/k/jasper-reports-working-with-beans-and-sub-report#](http://knol.google.com/k/jasper-reports-working-with-beans-and-sub-report#)

我也在博客上问过这个问题。到那时，如果有人知道答案，请告诉我。

# tomcat6 - Tomcat 6 热部署问题

> ID：904877
> 
> 赞同：7
> 
> 时间：2009-05-24T23:41:41.690
> 
> 标签：tomcat6

我在 Vista 64 位上使用 Java 6 64 位和 STANDALONE Tomcat 6.0.18。我正在开发一个带有 struts 1.3.10 和磁贴的 Web 应用程序。现在，当我对我的 java 或 jsp 文件进行更改时，当我重新加载页面时它们是不可见的。我必须在 Tomcat 管理器中手动重新加载 Web 应用程序才能看到更改。我的网络应用程序配置如下：

```
$CATALINA_BASE/conf/Catalina/localhost/dashboard.xml

<Context docBase="D:/mydata/projects/PatchworkSystems/development/Dashboard/webapp"
         path="/dashboard"
        reloadable="true" antiJARLocking="true" antiResourceLocking="true" debug="1" /> 
```

任何帮助是极大的赞赏。

谢谢夸迪尔

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-24T23:55:50.460

啊，这个老栗子。

去年夏天我在一个项目上遇到了这个障碍。

这是因为在您的上下文中设置了 antiResourceLocking="true" 的副作用。如果您在此处阅读有关 Tomcat 的文档：

[http://tomcat.apache.org/tomcat-5.5-doc/config/context.html](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)

> “请注意，将此设置为 true 会产生一些副作用，包括在正在运行的服务器中禁用 JSP 重新加载：请参阅 Bugzilla 37668。”

这是在这里：

[https://issues.apache.org/bugzilla/show_bug.cgi?id=37668](https://issues.apache.org/bugzilla/show_bug.cgi?id=37668)

据我所知，没有解决方法，如果您删除该属性，它将允许您再次自动加载您的 JSP。我们设置了一个部署时间替代来将该属性重新投入生产。嘘，嘶嘶！无论如何，如果您删除 antiResourceLocking 属性，它将解决您遇到的问题。

提供解决方法 Apache !!!

# php - mysql没有从php表单更新

> ID：904879
> 
> 赞同：0
> 
> 时间：2009-05-24T23:42:15.773
> 
> 标签：php, sql, mysql, html

我有一个非常简单的 PHP 表单，它显示了一个复选框，如果它被选中，它将存储在数据库中。这适用于初始插入，但不适用于更新。我已经测试了 $saleid 等于 $pk 并且它没有进入 if 分支进行更新的案例......为什么？

```
<?php
error_reporting(E_ALL);

if (isset($_GET["cmd"]))
  $cmd = $_GET["cmd"]; 
    else
if (isset($_POST["cmd"]))
  $cmd = $_POST["cmd"]; 
        else die("Invalid URL");

if (isset($_GET["pk"])) { $pk = $_GET["pk"]; }

$checkfield = "";

$checkboxes = (isset($_POST['checkboxes'])? $_POST['checkboxes'] : array());

if (in_array('field', $checkboxes)) $checkfield = 'checked';

$con = mysqli_connect("localhost","user","", "db");
if (!$con) { echo "Can't connect to MySQL Server. Errorcode: %s\n". mysqli_connect_error(); exit; }

$con->set_charset("utf8");

$getformdata = $con->query("select saleid, field from STATUS where saleid = '$pk'");
$saleid = "";
while ($row = mysqli_fetch_assoc($getformdata)) {
    $saleid = $row['saleid'];
    $checkfield = $row['field'];
}

if($cmd=="submitinfo") {
    if ($saleid == null) {
       $statusQuery = "INSERT INTO STATUS VALUES (?, ?)";
        if ($statusInfo = $con->prepare($statusQuery)) {
                $statusInfo->bind_param("sssssssssssss", $pk, $checkfield);
                $statusInfo->execute();
                $statusInfo->close();
        } else {
                print_r($con->error);
        }
    } else if ($saleid == $pk) {
        $blah = "what";
        $statusQuery = "UPDATE STATUS SET field = ? WHERE saleid = ?";
        if ($statusInfo = $con->prepare($statusQuery)) {
                $statusInfo->bind_param("ss", $checkfield, $pk);
                $statusInfo->execute();
                $statusInfo->close();
        } else {
                print_r($con->error);
     }  
    }
}
if($cmd=="EditStatusData") {
    echo "<form name=\"statusForm\" action=\"test.php?pk=".$pk."\" method=\"post\" enctype=\"multipart/form-data\">
                <h1>Editing information for Auction No: ".$pk."</h1>
                        <input type=\"checkbox\" name=\"checkboxes[]\" value=\"field\" ".$checkfield." />
                        <label for=\"field\">Test</label>
                        <br />
                        <input type=\"hidden\" name=\"cmd\" value=\"submitinfo\" />
                        <input name=\"Submit\" type=\"submit\" value=\"submit\" />
        </form>";
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T00:08:25.240

不确定是否可以混合使用 GET 和 POST 类型的请求

也许改变这个，以便 pk 作为隐藏字段传回？

```
 echo "<form name=\"statusForm\" action=\"test.php?pk=".$pk."\" method=\"post\" enctype=\"multipart/form-data\"> 
```

例如，有点像这样

```
echo "<form name=\"statusForm\" action=\"test.php\" method=\"post\" enctype=\"multipart/form-data\">
<input type=\"hidden\" name=\"pk\" value=\"".$pk."\"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T00:42:03.160

这是您的 HTML 应如下所示：

```
 <form id="aform" action="thisform.php" method="post">
       <input type="checkbox" name="agree" value="yes" />
       <input type="hidden" name="secret" value="shhh" />
       <input type="submit" value="do it" />
    </form> 
```

如果您这样做，则使用上述内容：

```
 print_r($_POST); 
```

你会得到一个数组，要么有 [agree] => 'yes' 要么什么都没有，这取决于他们是否选中了这个框，所以除非你有很多框，否则不需要放置数组括号。

至于 SQL 部分，我建议将列设置为单个整数类型，其中可以有 0 或 1。0 表示未选中，1 表示选中。对于插入，您可以执行以下操作：

```
 $check_value = ($_POST['agree'] == 'yes') ? 1 : 0;
   $secret_stuff = $_POST['secret'];
   mysqli_query("Insert INTO sales_table (secret_column, agree_column)
                 VALUES ('$secret_stuff', '$check_value')"); 
```

这将使您的复选框进入表格。为了得到它，你应该去：

```
 $results = mysqli_query("SELECT * from sales_table where secret_column = $secret_stuff")

  while($row = mysqli_fetch_assoc($results)) {
    $checked = ($row['agree_column'] == 1) ? "checked=\"checked\"" : "";
    $secret_stuff = $row['secret_column];
   }

   ?>
   <form action=blah method=post id=blah>
   <input type="checkbox" name="agree" value="yes" <?php echo $checked;?> />
   </form> 
```

对不起，最后失去了动力。但这涵盖了前端和后端。使用 1/0 开关，如果它是 1，只需将一些变量（如 $checked）设置为“checked='checked'”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T01:29:37.540

您没有设置 $pk 变量 unless `isset($_GET["pk"])`，但您稍后仍在查询中使用它。这不是一个好主意，因为根据其他情况，这可能会导致错误。你希望你的逻辑看起来像这样：

```
if pk is not set in form
    insert new record
    deal with error if insert failed
else
    update existing record
    check update count and deal with error if 0 records were updated
        (perhaps by doing an insert of the missing record)
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T01:37:35.747

顺便说一句，看起来 mysql [REPLACE](http://dev.mysql.com/doc/refman/5.0/en/replace.html)函数会为您派上用场。

此外，当未选中复选框时，该值可能是一件棘手的事情。我编写了一个函数，如果设置了发布的值，则将值设置为 1，如果没有设置，则设置为零......

```
function checkbox_value($name) {
    return (isset($_POST[$name]) ? 1 : 0);
} 
```

您可以通过该查询运行已发布的复选框值，并始终得到 1 或 0。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T08:12:32.630

好吧，我创建了一个表并运行了您的代码，它对我来说很好用

它“看起来”不像更新工作的原因是因为您正在从数据库中读取 $saleid 和 $checkfield 然后构建一个更新语句，将相同的两个值放回数据库

这可能不是您想要做的

此处的这一行将 $checkfield 设置为“已检查”，

```
 if (in_array('field', $checkboxes)) $checkfield = 'checked'; 
```

然后你从数据库中设置 $checkfield （覆盖值 'checked' ）

```
while ($row = mysqli_fetch_assoc($getformdata)) {
   $saleid = $row['saleid'];
   $checkfield = $row['field']; 
```

然后将 checkfield 的原始值写回数据库

```
$statusInfo->bind_param("ss", $checkfield, $pk); 
```

# dtd - 以上 html dtd

> ID：904882
> 
> 赞同：2
> 
> 时间：2009-05-24T23:43:23.947
> 
> 标签：dtd, standards

我知道我应该将所有 html 元素放在 body 标记中，但我需要在 html dtd 上方放置两个隐藏的输入。我想它不会使我的 html 文件成为标准，但它有那么糟糕吗？我有以下代码。

```
<input type='hidden' id='current_controller'>
<input type='hidden' id='current_module'>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

什么是风险？到目前为止，我没有任何问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T23:47:12.410

IIRC 的风险是，`doctype`如果 IE6 不是第一行，IE6 就会遇到麻烦。这也不是标准做法，*可能*会导致其他浏览器出现怪癖（但我相信大多数人应该宽容）。

似乎您正在使用 XHTML ...因此这些输入元素应该是自关闭的，因为它们没有结束标记。

```
<input type='hidden' id='current_controller' />
<input type='hidden' id='current_module' />
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

他们有什么理由必须在那里吗？为什么不能将它们放置在`body`元素内部的某个地方？如果它们没有`value`属性，我看不到任何实际用途，除非您正在检查它们的存在，或者`value`通过 JavaScript 添加属性（这意味着您也可以通过 JavaScript 自己添加这些元素）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T01:08:30.813

如果您实际上将其作为 XHTML 提供服务并因此使其通过 XML 解析器运行，则它不会呈现，因为标记无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T00:04:09.990

风险在于，由于您的文档无效，它可能无法在某些浏览器或同一浏览器的不同版本（甚至是当前可能适用的未来版本的浏览器）中正​​确呈现。

我不确定您需要这样做的情况。你想用这种方法解决什么问题，也许还有另一个问题试图摆脱？:)

# c# - 如何在用户控件 (c#) 中公开图像的可见属性？

> ID：904883
> 
> 赞同：1
> 
> 时间：2009-05-24T23:44:00.437
> 
> 标签：c#, user-controls

问题：

一个控件，显示每个用户在可能的四个测验中通过了哪些测验。

我的解决方案：

创建列出测验名称的用户控件，并在每个测验名称的末尾有一个复选标记，我希望在他们通过测验时使其可见。

实际的用户控件在我的母版页内。

通过阅读其他帖子，我了解到我需要在后面的控制代码中公开 image.visible 属性。我已经尝试了几种方法，但运气不佳。

那么如何在我的用户控件中公开图像的 .visible 属性呢？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T23:47:12.053

尝试这样的事情：

```
public Boolean ImageIsVisible
{
    set { this.yourImage.Visible = value; }
    get { return this.yourImage.Visible; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T23:50:59.360

我能想到的三种方法...

在 USER 控件中，只需将图像设置为公共而不是默认 - 私有，但这会公开所有元素。

另一个是在用户控制级别创建一个传递给 ex 的属性：

```
public Boolean ImgVisible
{
  get { return this.YourImageControl.Visible; }
  set { this.YourImageControl.Visible = value; }
} 
```

或者，只需在您的用户控件中创建一个函数......

```
public void ImgVisible( Boolean ShowIt )
{
  this.YourImageControl.Visible = ShowIt;
} 
```

抱歉，错过了关于母版页的部分... 作为一个 web 控件，只要控件在表单的 IDE（可视化设计器）中可见，您就可以通过显式在 CONTROL 的代码隐藏部分类定义中直接引用它名字参考...

```
public Boolean ImgVisible
{
   get { return ImgControl.Visible; }
   set { ImgControl.Visible = value; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T14:27:38.737

我在内容页面上访问此内容时遇到问题。这是正确的吗？

1.  我去了控制代码隐藏并添加了以下属性：

    `public Boolean ImgVisible { get { return this.imgModule1Passed.Visible; } set { this. imgModule1Passed.Visible = value; } }`

2.  在后面的内容页面代码上，我使用以下内容：

`UserControl control = (usercontrol)this.Page.Master.FindControl("QuizzesPassed1");`

我不应该能够通过以下方式找到房产吗：

Control.ImgVisible

?

我似乎根本找不到控制。

# regex - 正则表达式

> ID：904887
> 
> 赞同：0
> 
> 时间：2009-05-24T23:46:56.810
> 
> 标签：regex, yacc, lex

我正在使用 Lex 和 Yacc 开发一个从 MathML 到 Latex 的简单翻译器。在包含正则表达式规则的 lex 文件中，我为算术运算符 [-+*=/] 定义了一个。我想扩展以便它可以识别加减（+-）和不可见时间（'&InvisibleTimes'），但我不熟悉正则表达式，我需要一些帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T00:02:39.430

像这样的东西会起作用吗？

```
(?:[-+*=/]|\+-|&InvisibleTimes) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T00:19:52.750

尝试这个：

```
([-+*=/]|\+-|&InvisibleTimes) 
```

请注意，您需要对 in 进行转义`+`，`+-`因为它是字符类之外的运算符。您可以使用反斜杠（就像我在这里所做的那样）或使用双引号来执行此操作。（双引号语法很不寻常——大多数其他正则表达式实现只使用反斜杠进行转义，所以我倾向于使用反斜杠，因为它使正则表达式更加“常规”。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T01:00:31.310

我对 MathML 不是很熟悉，所以我遇到了与您相反的问题。正如其他人所说，您可以在一个正则表达式中完成所有操作，如下所示：

```
[-+*=/]|\+-|&InvisibleTimes

```

但是，如果您想要与其中的每一个相关联的不同操作，您需要这样做：

```
[-+*=/] {/* 此处的操作 1 */}
\+- {/* 此处为操作 2 */}
&InvisibleTimes {/* 此处为动作 3 */}

```

# javascript - 保存子窗口会保存父窗口（Javascript）

> ID：904893
> 
> 赞同：1
> 
> 时间：2009-05-24T23:49:48.507
> 
> 标签：javascript, internet-explorer, file, save, window.open

我有一些 Javascript 代码可以创建网页的“保存友好”版本。

`child = window.open("","child");
child.document.write(htmlPage);`

“htmlPage”是页面的基本 html，其中包含所有 javascript 引用、一组不同的标题图像引用等。

一切都完美地显示在弹出窗口中，没有运行 javascript。当我点击“文件->另存为”时，保存的文件是父窗口，连同它的所有javascript，并且没有子窗口的痕迹。有谁知道如何解决这个问题？我只想保存子窗口。

谢谢，-Kraryal

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T19:42:28.357

我有类似的情况（但不愿意完全放弃）。我正在使用 Javascript 构建网页的保存友好版本，我希望用户将其下载为文本文件（在我的情况下为逗号分隔值）。我认为`data:`URI 可以在这里提供帮助。

```
//construct the csvOutput in Javascript first
var popup = window.open("data:application/octet-stream," + encodeURIComponent(csvOutput), "child");
//no need to document.write() anything in the child window 
```

在 Firefox 中，这甚至不会弹出窗口，只是询问用户是否要保存文件，并将其保存为 .part 文件。不完全理想，但至少它可以保存文件而不会弹出不必要的窗口。

或者，我们可以使用 text/plain MIME 类型：

```
//construct the csvOutput in Javascript first
var popup = window.open("data:text/plain;charset=utf-8," + encodeURIComponent(csvOutput), "child"); 
```

在 Firefox 中，这确实会弹出一个新窗口，但默认情况下它会保存为 ASCII 文本，没有父窗口的任何杂物或任何换行。这可能是我将使用的。

看起来这在 IE 中不起作用。IE 8 是唯一支持`data:`URI 的版本，并且它对可以使用的位置有[一系列限制。](http://msdn.microsoft.com/en-us/library/cc848897%28VS.85%29.aspx)对于 IE，您可能会查看[execCommand](http://msdn.microsoft.com/en-us/library/ms536419(VS.85).aspx)。

感谢这个[tek-tip 线程](http://www.tek-tips.com/viewthread.cfm?qid=1517391&page=1)和[关于数据 URI 方案的 Wikipedia 文章](http://en.wikipedia.org/wiki/Data_URI_scheme)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T01:46:45.803

当您保存页面时，它将保存原始 URL 内容（例如，就像您下载新副本一样）

如果您想要一个“清理过的”版本，您需要在服务器上生成该版本，并以该 URL 作为第一个参数打开弹出窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T02:20:04.147

对于仅 Windows/IE 版本，请参见此处： http: [//p2p.wrox.com/javascript-how/3193-how-do-you-save-html-page-your-local-hd.html](http://p2p.wrox.com/javascript-how/3193-how-do-you-save-html-page-your-local-hd.html)

我知道，很糟糕，但以防万一它像一个仅限 IE 的 Intranet....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T02:45:12.973

唉，看来我没有足够的声誉来为我的问题添加评论，所以我会在这里添加。

此 javascript 为 Internet Explorer 和 Safari 部署。托管应用程序并不总是可以访问本地文件系统。

用户可以标记他们正在使用的页面，然后将其保存以供以后打印或通过电子邮件发送。我们告诉他们将其保存为单个文件存档，以便它实际上可以是邮件。保存对话框可以做到这一点，用户可以将文件放在他们有权访问的地方，这就是我们使用它的原因。

似乎简单的方法是将新的 html 从 javascript 写入本地目录，但我们不能总是这样做。还有其他想法吗？感谢你目前的帮助。

# python - 如何在 Python 中使用 datetime 和 getpage 来做到这一点？

> ID：904894
> 
> 赞同：0
> 
> 时间：2009-05-24T23:50:55.820
> 
> 标签：python

目前遇到一些问题-

```
now = datetime.datetime.now()
month = now.strftime("%B")

site = wikipedia.getSite('en', 'wikiquote')
page = wikipedia.Page(site, u"Wikiquote:Quote_of_the_day:abc") 
```

我需要让 abc 在它尝试获取页面之前更改为月份的名称，但是我尝试的所有操作都会给出某种错误。

我怎么能做到？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T23:59:31.263

页面 URL 格式实际上是[`Wikiquote:Quote_of_the_day/Month`](http://en.wikiquote.org/wiki/Wikiquote:Quote_of_the_day/May). 尝试这个：

```
page = wikipedia.Page(site, u"Wikiquote:Quote_of_the_day/%s" % month) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T23:57:32.750

这行得通吗？

```
page = wikipedia.Page(site, u"Wikiquote:Quote_of_the_day:" + month) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T23:58:29.533

你试过这个：

```
page = wikipedia.Page(site, u"Wikiquote:Quote_of_the_day:%s" % month ) 
```

# linux - 一个足够好的用于 Groovy/Grails 代码完成的 Linux IDE？

> ID：904904
> 
> 赞同：4
> 
> 时间：2009-05-24T23:59:50.467
> 
> 标签：linux, ide, grails, groovy

Linux 下的 Groovy/Grails 代码补全有没有好的开发 IDE？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-25T11:39:16.267

最好的一个是 IntelliJ IDEA（恕我直言）。然后是 Eclipse 和 Netbeans。但无论如何，由于 groovy 的动态特性，代码完成并不是这些 IDE 的强项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T00:02:20.070

带有 Groovy 插件的 Eclipse？

[http://groovy.codehaus.org/Eclipse+Plugin](http://groovy.codehaus.org/Eclipse+Plugin)

SpringSource Tool Suite (STS) 提供 Grails 集成：

[http://grails.org/STS+Integration](http://grails.org/STS+Integration)

虽然我读过支持 Groovy/Grails 的最佳 IDE 是 IntelliJ。看：

[http://www.jetbrains.com/idea/features/groovy_grails.html](http://www.jetbrains.com/idea/features/groovy_grails.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-25T06:41:00.797

我目前在 Ubuntu 上使用*Netbeans 6.7 Beta*进行 Grails 开发。此设置通常非常有用。我唯一的问题是代码完成非常慢。

还有其他人有这个问题吗？是因为 Grails 的动态特性吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-26T12:05:58.623

SpringSource 工具套件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T00:13:21.967

还要检查[netbeans groovy/grails 插件](http://www.grails.org/NetBeans+Integration)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T19:13:11.067

我是一个顽固的 Eclipse 用户，但不得不说，试试 IDEA 以获得 Groovy/Grails 支持。它比当前的 Eclipse 插件要好得多。

# asp.net - Wiki like on http://wiki.asp.net（带有分层目录）

> ID：904906
> 
> 赞同：0
> 
> 时间：2009-05-25T00:01:02.553
> 
> 标签：asp.net, wiki

我正在寻找一个在**ASP.NET**上编写的**Wiki**（最好是**开源和免费**的），类似于[http://wiki.asp.net/](http://wiki.asp.net/)上的一个。

 ****我喜欢[http://wiki.asp.net/](http://wiki.asp.net/)上的主要功能是**分层目录**- 大多数 Wiki 中完全不存在这种内容 - 它只是通过超链接连接的页面集合，没有你可以看到的地方Wiki 的“站点地图”。我需要的是一个更有条理的 Wiki，它的页面像文件系统一样组织起来。

有人知道这样的维基吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T00:14:26.333

试试ScrewTurn wiki，它非常好并且开源
[http://www.screwturn.eu/MainPage.ashx](http://www.screwturn.eu/MainPage.ashx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T05:18:41.220

查看 Deki 维基：

developer.mindtouch.com/Deki

您可以在左侧看到自动生成的目录。还有一个完整页面目录的链接。

开源且功能非常丰富，我在一些项目中使用过它。也有付费版本，但我从未尝试过。

# silverlight-3.0 - 如何隐藏 Silverlight 3 DataForm 控件的标题

> ID：904909
> 
> 赞同：1
> 
> 时间：2009-05-25T00:02:46.810
> 
> 标签：silverlight-3.0, dataform

我在我的 SL3 应用程序中使用 DataForm 控件，默认情况下它有一个带有一些图标的标题（编辑、删除、导航等），我可以防止大多数图标出现在标题上，但**想要得到齐头并进**。谷歌运气不佳...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-25T13:50:18.497

在 xaml 中设置数据表单上的属性，如下所示：

```
CommandButtonsVisibility="None" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T14:34:52.093

我对 SL3 中的新弹出控件的标题有类似的问题。

[在 Silverlight 3 中修改新弹出控件 (ChildWindow) 的外观/行为](https://stackoverflow.com/questions/684360/modifying-look-behavior-of-the-new-popup-control-childwindow-in-silverlight-3)

相同的解决方案？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-30T14:23:23.573

不太确定 Silverlight 3，但在 Silverlight 4 中是这样的：

```
HeaderVisibility="Collapsed" 
```

# c# - 如何将浮点数向上舍入到 C# 中最近的 int？

> ID：904910
> 
> 赞同：71
> 
> 时间：2009-05-25T00:04:09.443
> 
> 标签：c#, .net, rounding

在 C# 中，如何将浮点数向上舍入到最近的 int？

我看到 Math.Ceiling 和 Math.Round，但它们返回一个小数。我是否使用其中之一然后转换为 Int？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-05-25T00:13:59.813

如果要四舍五入到**最接近的**int：

```
int rounded = (int)Math.Round(precise, 0); 
```

您还可以使用：

```
int rounded = Convert.ToInt32(precise); 
```

它将用于`Math.Round(x, 0);`为您舍入和投射。它看起来更整洁，但 IMO 不太清晰。

* * *

如果你想**四舍五入**：

```
int roundedUp = (int)Math.Ceiling(precise); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-25T00:10:40.397

在我的头顶上：

```
float fl = 0.678;
int rounded_f = (int)(fl+0.5f); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-25T00:07:41.620

(int)Math.Round(myNumber, 0)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T00:22:29.720

最简单的方法是添加`0.5f`它，然后将其转换为 int。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T00:21:55.383

> 我是否使用其中之一然后转换为 Int？

是的。这样做没有问题。小数和双精度可以精确表示整数，所以不会有表示错误。（例如，您不会遇到 Round 返回 4.999... 而不是 5 的情况。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T07:01:11.260

如果您确定它在 int 的范围内（Int32.MinValue 到 Int32.MaxValue），您可以转换为 int。

# javascript - 您如何测试模态 jquery 对话框是否失去焦点？

> ID：904913
> 
> 赞同：1
> 
> 时间：2009-05-25T00:04:53.763
> 
> 标签：javascript, jquery, dialog

当您在对话框外部单击时，我想关闭对话框，但我不确定您如何在 jquery/plain javascript 中进行测试。

有些人建议使用 blur 事件，但这似乎不受 jquery 对话框的支持。

* * *

**编辑**我也有这个问题，但无法处理当前提供的任何答案，因为我无法使我的对话框成为模态。

我需要这个，以便我可以仅在对话框位于最顶部时注册键处理程序，并在另一个对话框置于顶部时立即取消注册它们。

有没有人有一个解决方案 - 理想情况下，每次其他对话框到达顶部时都会引发一个事件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-05-13T02:08:26.880

# 纯 jQueryUI 没有模态对话框。

## 例子：

[http://jsfiddle.net/marcosfromero/x4GXy/](http://jsfiddle.net/marcosfromero/x4GXy/)

## 代码：

```
// Bind the click event to window
$(window).click(function(event) {
    if (($(event.target).closest('.ui-dialog')).length>0) {
        // if clicked on a dialog, do nothing
        return false;
    } else {
        // if clicked outside the dialog, close it
        // jQuery-UI dialog adds ui-dialog-content class to the dialog element.
        // with the following selector, we are sure that any visible dialog is closed.
        $('.ui-dialog-content:visible').dialog('close');

    }
}) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T03:22:08.360

你能把你的对话框变成模态的吗？如果是这样，那么您可以（可能）通过模态叠加层上的事件来实现您所追求的......

完全hacky，未经测试的想法，但它可能只是工作......

模态对话框创建称为 click.dialog-overlay 等的事件......当鼠标在对话框外单击时，在模态覆盖层上会触发这些事件。挂钩这些事件并关闭对话框**可能**只是做你想做的事情......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T15:06:08.207

blur 事件并不是您想要的。模糊事件发生在单个元素上。您正在寻找的是当用户单击“外部”特定元素组时 - 某个父节点下方的所有内容。**没有事件，因此您必须使用您有权访问的事件来模拟它.

```
$('.dialogSelector').dialog({
  open: function(e) { // on the open event
    // find the dialog element
    var dialogEl = $(this).parents('.ui-dialog')[0];        
    $(document).click(function (e) { // when anywhere in the doc is clicked
        var clickedOutside = true; // start searching assuming we clicked outside
        $(e.target).parents().andSelf().each(function () { // search parents and self
            // if the original dialog selector is the click's target or a parent of the target
            // we have not clicked outside the box
            if (this == dialogEl) {
                clickedOutside = false; // found
                return false; // stop searching
            }
        });
        if (clickedOutside) {
            $('a.ui-dialog-titlebar-close').click(); // close the dialog
            // unbind this listener, we're done with it
            $(document).unbind('click',arguments.callee); 
        }
    });     
  }
}); 
```

**更准确地说，您正在寻找一个事件，当用户在特定可见元素组之外单击时。对于用户来说，绝对定位的 div 可能看起来在一组元素的“外部”，而实际上它是其中一个元素的子元素。这不太适用，但它应该适用于您的目的。

希望有帮助。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-13T19:06:19.503

类似于@marcosfromero（但性能更高）的解决方案是用于`$.contains`测试一个元素是否存在于另一个元素中。`$.contains`如果存在，则利用本地`document.documentElement.compareDocumentPosition`方法，这意味着您不必`event.target`转换为 jQuery 对象，不需要查询 DOM `.ui-dialog`，并且底层逻辑甚至不需要遍历 DOM（在现代浏览器中） ）。

```
$(document).click(function(event) {
    if( !$.contains( dialog.dialog('widget')[0], event.target ) ){
        $(':ui-dialog').dialog('close');    
    }
}); 
```

如果目标元素不存在由小部件创建的对话框标记（通过调用对话框的`widget`方法获得），则关闭对话框。

演示：http: [//jsfiddle.net/ehynds/auKAu/](http://jsfiddle.net/ehynds/auKAu/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-11T11:27:46.063

看看[jquery tools overlay](http://flowplayer.org/tools/overlay/index.html)这可能会帮助你做模态窗口。它在过去帮助了我。

要检查点击是否在模态窗口之外，您可以执行以下操作：

```
echo '<div class="mybody">Body of the webpage';
echo '<div class="myoverlay">Body of overlay</div></div>'; 
```

jQuery：

```
$(function() {
    $('body').click(function(e) {
        var inOverlay = false;
        $(e.target).parents().each(function(idx,parent) {
            if ('mybody' == parent.className) {
                inOverlay=true;
            }
        });
        if (!inOverlay) {
            alert('outside');
        }
    });
}); 
```

然后您可以在模态窗口中添加键盘检查：

```
$(".myoverlay").keydown(function(e) {
   // your specific keyboard handler
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T00:12:59.770

我认为这可能会做到：

```
$("element").blur(function(){
  /* Callback goes here */
  $("element").hide();
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T00:13:25.027

使用 .blur() 函数......它很棒：D

[http://docs.jquery.com/Events/blur](http://docs.jquery.com/Events/blur)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-12T22:59:26.833

使用 CSS {position:fixed;height:100%;width:100%;background:transparent;z-index:100} 创建一个透明叠加层并使用`$('.overlay').click(function() {$('ui-dialog').remove();}`. 当然，您需要在创建`<div class="overlay"></div>`对话框的同时创建。并且对话框将需要更高的 z-index！

# django - Django 管理员 url.py

> ID：904916
> 
> 赞同：0
> 
> 时间：2009-05-25T00:07:32.667
> 
> 标签：django, url, admin

我按照 Django 教程进行操作，我已经完成了第 4 部分。但是当我回去查看我的管理页面时，它神秘地不再起作用了。所以我搞砸了一点，想出了这个。

```
from django.conf.urls.defaults import *
from django.contrib import admin

admin.autodiscover()

urlpatterns = patterns('',
    (r'^admin/(.*)', admin.site.root),
    #(r'^polls/', include('mysite.polls.urls')),
) 
```

现在我可以进入我的管理页面，但是如果我取消注释掉我的视图的 url（我在 mysite 子文件夹中有另一个 urls.py 管理员不起作用。它会返回以下错误。

```
Request Method:     GET
Request URL:    http://192.168.0.5:9000/admin/
Exception Type:     TemplateSyntaxError
Exception Value:    

Caught an exception while rendering: Tried vote in module mysite.polls.views. Error was: 'module' object has no attribute 'vote'

Original Traceback (most recent call last):
  File "/usr/local/lib/python2.5/site-packages/django/template/debug.py", line 71, in render_node
    result = node.render(context)
  File "/usr/local/lib/python2.5/site-packages/django/template/defaulttags.py", line 373, in render
    url = reverse(self.view_name, args=args, kwargs=kwargs)
  File "/usr/local/lib/python2.5/site-packages/django/core/urlresolvers.py", line 254, in reverse
    *args, **kwargs)))
  File "/usr/local/lib/python2.5/site-packages/django/core/urlresolvers.py", line 227, in reverse
    possibilities = self.reverse_dict.getlist(lookup_view)
  File "/usr/local/lib/python2.5/site-packages/django/core/urlresolvers.py", line 161, in _get_reverse_dict
    for name in pattern.reverse_dict:
  File "/usr/local/lib/python2.5/site-packages/django/core/urlresolvers.py", line 169, in _get_reverse_dict
    self._reverse_dict.appendlist(pattern.callback, (bits, p_pattern))
  File "/usr/local/lib/python2.5/site-packages/django/core/urlresolvers.py", line 136, in _get_callback
    raise ViewDoesNotExist, "Tried %s in module %s. Error was: %s" % (func_name, mod_name, str(e))
ViewDoesNotExist: Tried vote in module mysite.polls.views. Error was: 'module' object has no attribute 'vote'

Exception Location:     /usr/local/lib/python2.5/site-packages/django/template/debug.py in render_node, line 81
Python Executable:  /usr/bin/python
Python Version:     2.5.1
Python Path:    ['/local/Programming/django/mysite', '/usr/lib/python2.5/site-packages/docutils-0.5-py2.5.egg', '/usr/lib/python2.5/site-packages/Pygments-1.0-py2.5.egg', '/usr/lib/python2.5/site-packages/pytz-2008i-py2.5.egg', '/usr/lib/python2.5/site-packages/Genshi-0.6dev_r999-py2.5-linux-i686.egg', '/usr/lib/python2.5/site-packages/Trac-0.11.3-py2.5.egg', '/usr/local/lib/python2.5/site-packages/setuptools-0.6c8-py2.5.egg', '/usr/local/lib/python2.5/site-packages/numpy-1.3.0-py2.5-linux-i686.egg', '/usr/lib/python25.zip', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/usr/lib/python2.5/site-packages/gtk-2.0', '/usr/local/lib/python2.5/site-packages']
Server time:    Sun, 24 May 2009 19:59:08 -0500 
```

Allso 我的观点在管理 url 被注释掉的情况下工作得很好。没有错误。

我正在运行 Django 1.0.2 final。

感谢人们想要提供的任何帮助。

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T05:13:49.263

检查 mysite.polls.urls。看来您在该 urls.py 文件中有一行引用了 mysite.polls.views 中不存在的名为 vote 的视图函数。

# iphone - 就 iPhone OS 中的核心动画而言，什么是“未对齐的图像”？

> ID：904918
> 
> 赞同：14
> 
> 时间：2009-05-25T00:07:42.183
> 
> 标签：iphone, cocoa-touch, uikit, core-animation, instruments

Instruments 表示存在由核心动画制作的“未对齐的图像”。这意味着什么？

更新：我在 Instruments.app > Core Animation 中看到了这一点。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-29T00:00:41.440

我想了解更多关于您在哪里看到的信息，但我怀疑它指的是不是像素对齐的图像。Quartz 允许您在分数像素处绘制（回想一下，CGPoint 采用 CGFloats，而不是 NSIntegers），但它更昂贵并且容易产生一些模糊。您不能真正在分数像素上绘制，因此 Quartz 必须进行抗锯齿才能将其拉下来。这需要时间，而且肯定会损害 Core Animation 的性能。

Quartz 不会警告您正在绘制分数像素，而且它对文本特别不友好。因此，在您进行程序化布局时，您需要考虑这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T21:12:18.550

未对齐的视图会在绘制之前强制渲染器进行抗锯齿处理。

在这种情况下，“未对齐”意味着请求的显示点不直接映射到屏幕像素（例如，它可能在两个像素之间），因此必须绘制到两个相邻像素并消除锯齿以产生错觉它是在他们“之间”绘制的。

这几乎总是在计算视图的框架时发生（而不是在 Interface Builder 中指定），因为 CGRect 的 X 坐标、Y 坐标、宽度和高度是 CGFloats，因此允许使用小数值。

例如，一个以 (200.5, 35.5) 为中心的 100.8 x 50.1 像素的框是一个有效的框架，操作系统将尝试以它可以管理的最佳方式渲染它。仅单个像素所需的额外插值和抗锯齿开销就足以严重损害旧硬件的性能。

# guid - GUID 可以有多短？

> ID：904920
> 
> 赞同：19
> 
> 时间：2009-05-25T00:08:26.190
> 
> 标签：guid

我知道标准的 GUID。它们可以做得更短吗？它背后的理论是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-25T00:30:30.373

Greg Dean 的回答是正确的，但为了了解 GUID 是如何生成的以及为什么不应该缩短它，我强烈建议您阅读下面的文章。

[**旧新事物：GUID 是全局唯一的，但 GUID 的子字符串不是**](https://devblogs.microsoft.com/oldnewthing/20080627-00/?p=21823)：

> 客户需要生成一个 8 字节的唯一值，他们最初的想法是生成一个 GUID 并丢弃后半部分，保留前 8 个字节。他们想知道这是否是个好主意。
> 
> 不，这不是一个好主意。
> 
> GUID 生成算法依赖于这样一个事实，即它有全部 16 个字节用于建立唯一性，如果丢弃其中的一半，就会失去唯一性。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-25T01:28:03.347

根据您的应用程序，它实际上取决于您的“G”（全局）在您的应用程序中的大小。

“GUID”，全局唯一 ID。典型的现代“通用”GUID 是为任何应用程序设计的，它们的“G”、“全局”就是字面意思。全球的。全世界。跨越应用程序，国家，地理，一切。16 字节是很多信息。

现在，如果在您的应用程序中，您的“G”不是那么大，如果您没有期望或意图使“G”在世界意义上是全球性的，而不是在应用程序空间意义上简单地“全球性”，那么您可以很容易地将大小减小到您的应用程序范围内。

贵公司有四个部门，永远不会有更多？2 位——0、1、2、3 对这个任务来说是一个足够大的“GUID”。显然，这是一个人为的应用程序。

过去，当我们在千年虫问题中苦苦挣扎时，我们已经了解了“限制比特”的后果。因此，“位很便宜”是一个足够充分的理由来不限制您的 GUID 大小，并在“现在位太多”方面犯错。但是，说实话，许多应用程序只是受到限制，许多应用程序很可能会生成大量数据，或者带宽限制在不需要 16 字节 GUID 的地方，并且使用一个会影响性能和资源。

因此，了解 GUID 的概念，以及它如何应用于您的应用程序。然后你可以把它做成任何必要的大小。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-11-14T07:31:39.937

查看 Jeff Atwood 撰写的这篇文章：
[编码恐怖：装备我们的 ASCII 盔甲](http://www.codinghorror.com/blog/2005/10/equipping-our-ascii-armor.html)

在那里，他展示了如何将 GUID 缩短为 20 个可打印字符，同时保持 GUID 的“唯一性”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-25T00:31:41.790

“据称全球唯一”ID 越短，当它们中的许多或多或少随机生成时，发生碰撞的可能性就越大——而且，由于“生日悖论”，这种可能性可能比你想象的要高“……见[http://betterexplained.com/articles/understanding-the-birthday-paradox/](http://betterexplained.com/articles/understanding-the-birthday-paradox/)。作为一个（非常近似但有用的）经验法则，如果（在 N 个可能的 UID 中）您分配了`sqrt(N)`左右，则机会是不可忽略的。因此，即使对于数十亿个 ID，128 位 ID 也可以避免意外碰撞；但是，如果您将其缩短到 32 位，那么即使只有几万个 ID，您也会面临很大的冲突风险。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-25T00:11:05.047

它们正好是 16 个字节。

从技术上讲，缩短它们的效果会因用于生成它们的算法而异。考虑到您使用的 API（可能）并不能保证特定的版本或实现，缩短它们是一个坏主意。即使这样做了，这也是个坏主意。如果您需要少于 16 个字节的熵，您应该不会使用 GUID。

更多信息： [http ://en.wikipedia.org/wiki/Globally_Unique_Identifier](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T00:41:35.563

简而言之，GUID 保证是唯一的，因为它们的行为类似于坐标。

传统上*，一半是特定于机器的（通过使用 MAC 地址），一半来自时间。

因为 MAC 在机器之间是唯一的，并且每台机器一次只能执行一条指令（传统上记住！），所以 GUID 肯定是唯一的。

然而，这意味着，如果您放弃 GUID 的任何部分，您将失去唯一性的保证。Martelli 先生很好地解释了为什么这比你想象的更严重。

*[我说的是传统，但我从未读过一篇表明重大变化的文章。我不认为现在使用实际的 MAC（我猜是出于安全原因），但我认为它们仍然是 MAC 派生的，或者至少是特定于机器的。]

# python - Python strftime - 没有前导0的日期？

> ID：904928
> 
> 赞同：356
> 
> 时间：2009-05-25T00:11:49.477
> 
> 标签：python, padding, strftime

使用 Python`strftime`时，如果日期的第一个 0 在第 10 个之前，有没有办法删除它，即。也是`01`吗`1`？找不到`%`东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：702
> 
> 时间：2010-01-15T16:38:41.417

实际上我有同样的问题，我意识到，如果你在`%`和字母之间添加一个连字符，你可以删除前导零。

例如`%Y/%-m/%-d`.

这仅适用于 Unix（Linux、OS X），不适用于 Windows（包括 Cygwin）。在 Windows 上，您将使用`#`，例如`%Y/%#m/%#d`.

* * *

## 回答 #2

> 赞同：208
> 
> 时间：2013-04-19T04:48:02.993

[`format`](https://docs.python.org/2/library/functions.html#format)自 python2.6 以来，随着该方法的出现，我们可以做这种事情：

```
>>> import datetime
>>> '{dt.year}/{dt.month}/{dt.day}'.format(dt = datetime.datetime.now())
'2013/4/19' 
```

尽管可能超出了原始问题的范围，但对于更有趣的格式，您可以执行以下操作：

```
>>> '{dt:%A} {dt:%B} {dt.day}, {dt.year}'.format(dt=datetime.datetime.now())
'Wednesday December 3, 2014' 
```

从 python3.6 开始，这可以表示为[内联格式化字符串](https://www.python.org/dev/peps/pep-0498/)：

```
Python 3.6.0a2 (v3.6.0a2:378893423552, Jun 13 2016, 14:44:21) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import datetime
>>> dt = datetime.datetime.now()
>>> f'{dt:%A} {dt:%B} {dt.day}, {dt.year}'
'Monday August 29, 2016' 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-05-25T00:22:43.277

[根据http://docs.python.org/library/time.html](http://docs.python.org/library/time.html) ，某些平台可能支持字母之间的宽度和精度规范`%`（例如“d”表示月份）——但它绝对是不可移植的解决方案（例如在我的 Mac 上不起作用；-）。也许您可以在 之后使用字符串替换（或 RE，对于非常讨厌的格式）来解决这个问题？例如：`strftime`

```
>>> y
(2009, 5, 7, 17, 17, 17, 3, 127, 1)
>>> time.strftime('%Y %m %d', y)
'2009 05 07'
>>> time.strftime('%Y %m %d', y).replace(' 0', ' ')
'2009 5 7' 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-05-25T18:13:36.383

[这](http://www.gnu.org/software/libc/manual/html_node/Formatting-Calendar-Time.html#index-strftime-2660)`strftime()`是GNU C 库中支持的修饰符的文档。（就像人们之前说的，它可能不是便携式的。）您可能感兴趣的是：

*   `%e`而不是`%d`将用空格替换月份中的前导零

它适用于我的 Python（在 Linux 上）。我不知道它是否适用于你的。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2011-05-05T15:46:24.267

```
>>> import datetime
>>> d = datetime.datetime.now()
>>> d.strftime('X%d/X%m/%Y').replace('X0','X').replace('X','')
'5/5/2011' 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2015-07-31T14:12:53.607

在 Windows 上，添加一个 '#'，如 '%#m/%#d/%Y %#I:%M:%S %p'

供参考：[https ://msdn.microsoft.com/en-us/library/fe06s4ak.aspx](https://msdn.microsoft.com/en-us/library/fe06s4ak.aspx)

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2014-11-25T11:08:03.003

参加聚会很晚，但`%-d`对我有用。

`datetime.now().strftime('%B %-d, %Y')`产生类似**“2014 年 11 月 5 日”的内容**

干杯:)

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-09-15T16:31:23.653

我发现 Django 模板日期格式化过滤器既快速又简单。它去除了前导零。如果您不介意导入 Django 模块，请查看。

[http://docs.djangoproject.com/en/dev/ref/templates/builtins/#date](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#date)

```
from django.template.defaultfilters import date as django_date_filter
print django_date_filter(mydate, 'P, D M j, Y') 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2011-10-08T18:15:59.780

看看`-`下面：

```
>>> from datetime import datetime
>>> datetime.now().strftime('%d-%b-%Y')
>>> '08-Oct-2011'
>>> datetime.now().strftime('%-d-%b-%Y')
>>> '8-Oct-2011'
>>> today = datetime.date.today()
>>> today.strftime('%d-%b-%Y')
>>> print(today) 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2017-07-21T16:51:40.200

像这样简单地使用`replace`：

`(datetime.date.now()).strftime("%Y/%m/%d").replace("/0", "/")`

它将输出：

```
'2017/7/21' 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2010-07-19T23:33:10.453

因为`%d`您可以使用 then 转换为整数，`int()`它会自动删除前导 0 并变为整数。然后，您可以使用`str()`.

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-04-18T00:52:54.043

例如，即使在同一操作系统的不同版本之间，使用“%-d”也是不可移植的。更好的解决方案是单独提取日期组件，并在特定于日期的格式化运算符和每个组件的日期属性访问之间进行选择。

```
e = datetime.date(2014, 1, 6)
"{date:%A} {date.day} {date:%B}{date.year}".format(date=e) 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-25T00:23:21.323

因为 Python 实际上只是`strftime(3)`在您的平台上调用 C 语言函数，所以可能有一些格式字符可以用来控制前导零；试试看`man strftime`。但是，当然，结果不会是可移植的，因为 Python 手册会提醒您。:-)

我会尝试使用新样式的`datetime`对象来代替，它具有`t.year`和`t.month`and之类的属性`t.day`，并通过运算符的正常、高性能格式设置这些对象`%`，它支持对前导零的控制。有关详细信息，请参阅[http://docs.python.org/library/datetime.html](http://docs.python.org/library/datetime.html)。更好的是，`"".format()`如果你的 Python 有它并且更现代，请使用该运算符；它也有很多数字格式选项。请参阅：[http](http://docs.python.org/library/string.html#string-formatting) ://docs.python.org/library/string.html#string-formatting 。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-11-17T18:19:31.760

基于 Alex 的方法，这将适用于字符串开头和后空格的情况：

```
re.sub('^0|(?<= )0', '', "01 January 2000 08:00am") 
```

我比 .format 或 %-d 更喜欢它，因为它是跨平台的，并且允许我继续使用 strftime （获得诸如“十一月”和“星期一”之类的东西）。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-07-29T15:29:35.107

老问题，但 %l（小写 L）在 strftime 中为我工作：但这可能不适用于所有人，因为它没有在我找到的 Python 文档中列出

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-02-01T22:53:34.493

```
import datetime
now = datetime.datetime.now()
print now.strftime("%b %_d") 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2022-01-02T17:04:30.893

如果我们只想获取不带前导零的日期，我们可以

```
d = date.today()
day = int(d.strftime("%d")) 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-12-03T05:36:03.467

Python 3.6+：

```
from datetime import date
today = date.today()
text = "Today it is " + today.strftime(f"%A %B {today.day}, %Y") 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-12-07T04:53:52.110

我迟到了，但是一个简单的列表切片就可以了

```
today_date = date.today().strftime('%d %b %Y')
if today_date[0] == '0':
    today_date = today_date[1:] 
```

# c# - 是否可以通过 .NET 将内容上传到 SkyDrive？

> ID：904929
> 
> 赞同：1
> 
> 时间：2009-05-25T00:11:53.233
> 
> 标签：c#, .net, upload, onedrive

我发现了这个问题：

[Microsoft SkyDrive 是否有 API？](https://stackoverflow.com/questions/307696/does-microsoft-skydrive-have-an-api)

但是没有 API 并不意味着没有办法将文件上传到 SkyDrive！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T00:18:41.910

破解一个 HTTP 记录器并学习“API”。

HttpFox 有效。我在 OSX 上使用 HTTPScoop。

# asp.net - SetVaryByCustom 是否适用于用户控件？

> ID：904935
> 
> 赞同：1
> 
> 时间：2009-05-25T00:13:28.053
> 
> 标签：asp.net

在我看来，这

```
Response.Cache.SetVaryByCustom("mykey"); 
```

不能在 ASCX 用户控件中工作。它从页面工作。只有在 outputcache 指令中指定了 VaryByCustom 时，ASCX 才起作用。

我正在使用 ASP.NET 3.5。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T03:39:58.643

您可以考虑将其表示为 ascx 顶部的指令：

```
<%@ OutputCache Duration="1800" VaryByParam="None" VaryByCustom="mykey" %> 
```

响应是 Page 的属性，而不是控件的属性，因此它可能在控件级别没有影响。

# sharepoint - SharePoint 表单身份验证网站

> ID：904936
> 
> 赞同：2
> 
> 时间：2009-05-25T00:13:29.893
> 
> 标签：sharepoint, moss, forms-authentication, anonymous-access

对于部分匿名且部分在表单身份验证登录之后的 SharePoint 网站，您如何管理它的安全性？

我有一个使用*CMS*门户（使用 Windows 身份验证）设置的站点，但由于 FBA 将被公众使用，它已扩展为将 FBA 作为身份验证提供程序**并**启用了匿名访问。CMS 门户上未启用匿名，因为它不会重新激活，只有内容编辑器才能登录该站点。

但是我不知道如何管理从 CMS 门户可以匿名访问的内容和不可以匿名访问的内容，是否有可能，或者是否需要一个 FBA 管理员帐户来管理网站的该部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T02:49:41.933

我认为您要问的是“如何管理 SharePoint / WSS 网站的匿名访问？”。

这篇[文章](http://technet.microsoft.com/en-us/library/cc263363.aspx)应该让你开始。

> 常见问题 - 如何启用匿名访问？
> 
> 从 Central Admin 为 Web 应用程序启用匿名访问。
> 
> Central Admin 主页 > 应用程序管理 > 身份验证提供程序
> 
> > 选择 Membership Provider (authentication.aspx) 并从下一页启用匿名访问。
> 
> 您无需在 IIS 管理器上执行任何操作......从中央管理页面启用它也将在 IIS 上启用它。
> 
> 为您希望匿名访问的网站显式打开它。
> 
> 浏览到该站点，单击站点设置 > 高级权限 > 设置 > 匿名访问 (setanon.aspx) 并打开该站点的匿名访问。

来自 Mark Harrisons 博客[http://old.markharrison.co.uk/blog/2006/06/moss-2007-enable-anonymous_12.htm](http://old.markharrison.co.uk/blog/2006/06/moss-2007-enable-anonymous_12.htm)

根据您的后续评论，我相信您在询问是否可以在登录到仅支持 Windows 身份验证的默认区域时管理匿名访问。出于某种原因，当使用已关闭匿名访问的 Web 应用程序访问网站集时，MSFT 决定禁用 (_layouts/setanon.aspx) 上的页面控件。

由于匿名访问只是 Web 的另一种设置，因此您没有理由不能构建自己的网页来管理这些设置。本文[可以](http://stsadm.blogspot.com/2008/03/set-anonymous-access.html)帮助您入门。诚然，本文讨论了构建 STSADM 扩展，它不会帮助您通过 Web 浏览器管理您的网站，但它确实包含您需要在自定义页面中拥有的代码。

您不需要特殊的 FBA 帐户来管理匿名访问。您可以使用在您的网站集中具有适当权限的任何帐户对其进行管理。

# iphone - 我可以在 iPhone 应用程序中从我的计算机加载文件吗？

> ID：904940
> 
> 赞同：1
> 
> 时间：2009-05-25T00:15:28.843
> 
> 标签：iphone, file

作为我的 iPhone 应用程序开发阶段的一部分，从我的本地机器（即不是从应用程序包）加载文件非常有用。那可能吗？

这样做的目的是让我可以构建我们游戏的一个版本，然后将它交给我们的一位设计师，他们可以在他们的机器上本地编辑设置文件并让游戏重新加载它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T00:22:23.837

我相信 iPhone 应用程序只能从它自己的包中访问文件。我不认为你可以将单独的文件上传到一个包中。

但是，您可以通过网络访问数据，因此也许您可以构建一个用于开发的模块，您可以在其中通过网络下载数据文件，然后您的应用程序将使用该新数据进行自我初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T00:23:07.813

最简单的方法可能是使用 xCode 将他们设置为开发人员。
拥有他们操作的文件，然后在每次更改某些内容时构建并运行。

如果您尝试创建一个单独的应用程序，您将遇到沙箱问题。你必须在你的手机上创建一个 web/ftp 服务器来实现这一点，我也猜这将是很多工作。（那里有很多文件共享应用程序）

另一种选择是使用模拟器。您可以使用它进行更直接的访问。

这是为移动设备开发的问题之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T02:12:41.977

我通常使用的方法是小型 Web 服务器。您可以使用[cocoahttpserver](http://code.google.com/p/cocoahttpserver/)在程序内部的手机上非常轻松地运行 Web 服务器。或者，您可以在桌面上运行 Web 服务器并使用`NSURLConnection`. 通过无线使用 Bonjour，您甚至可以让设备相互发现（尽管这比输入 IP 地址要复杂一些）。如果可能的话，在桌面上运行 Web 服务器通常是最简单的，因为 IP 地址的变化较少，如果你想在没有 Bonjour 的代码中完成它，找出你手机的 IP 地址实际上有点棘手。

# asp.net - 导致“会话状态已创建会话 ID，但无法保存它，因为响应已被应用程序刷新”的原因。

> ID：904952
> 
> 赞同：80
> 
> 时间：2009-05-25T00:22:36.707
> 
> 标签：asp.net, session-state

我间歇性地遇到这个故障。

我发现这个链接很好地总结了我在谷歌上找到的内容： [http ://www.wacdesigns.com/2009/02/03/session-state-has-created-a-session-id-but-无法保存它，因为响应已被应用程序刷新/](http://www.wacdesigns.com/2009/02/03/session-state-has-created-a-session-id-but-cannot-save-it-because-the-response-was-already-flushed-by-the-application/)

基本上它说您可以尝试设置 Web 配置设置 DisplayWhenNewSession，或者尝试通过获取 Session_OnStart 中的 Session.SessionID 来激活会话状态。

但是有没有人：

a) 对此有解释

甚至更好，b）有一个久经考验的修复

我意识到在执行任何会影响 http 响应标头的操作后，我无法刷新响应。*如果我这样做，每次*都会导致错误，但这是间歇性的。SessionID 肯定应该由 ASP.NET 在页面响应开始时自动创建，在 ASPX 页面或 Page_Load（我的所有刷新被调用的地方）中的任何内容之前。

**更新：** 经过反思，我意识到这是在将文件流式传输到浏览器时发生的。大多数浏览器实际上是搜索引擎机器人。我可以通过开始下载然后关闭浏览器来重新创建此错误，因此大概浏览器在取消下载操作之前没有等待下载完成。我也在其他正常页面上看到过这种情况，但 99% 的时间是下载页面。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-12-27T17:56:17.540

我有！

在 global.asax 文件中，您可以这样做：

```
void Session_Start(object sender, EventArgs e) 
{
    // Code that runs when a new session is started
    string sessionId = Session.SessionID;
} 
```

太简单。有用！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2010-03-16T12:02:11.237

此错误似乎出现在以下情况：

*   应用程序启动

*   即使您在 Session_Start / End 事件中做某事，您也正在使用 Global.asax

*   您的应用程序过早地强制刷新响应

*   您没有在刷新之前使用 Session

当会话状态尝试在 release 上保存 sessionID 时，它会引发它：

```
System.Web.SessionState.SessionIDManager.SaveSessionID(HttpContext context, String id, Boolean& redirected, Boolean& cookieAdded)
System.Web.SessionState.SessionStateModule.CreateSessionId()
System.Web.SessionState.SessionStateModule.DelayedGetSessionId()
System.Web.SessionState.SessionStateModule.ReleaseStateGetSessionID()
System.Web.SessionState.SessionStateModule.OnReleaseState(Object source, EventArgs eventArgs)
System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

我相信 Global.asax 的存在会导致会话 ID 在释放时由 SessionStateModule 保存（迟到？）即使在调用 SessionID 时没有使用会话而不是 HttpSessionState 也是如此。

这就是为什么*string sessionId = Session.SessionID;* 技巧避免问题。

我猜它只出现在应用程序启动时，因为初始化行为。

**解决方案/技巧**：

*   如前所述，避免在 Page_Load 中刷新

*   停用页面上的会话状态 (EnableSessionState)

*   在刷新之前使用 SessionID 技巧

*   如果您不关心刷新后可能发生的错误，请使用 Response.End() 代替 .Flush()

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-25T01:16:05.977

我相信这里的问题可能正是你正在做一些事情来导致页面输出`Page_Load`，根据[ASP.NET 页面生命周期概述](http://msdn.microsoft.com/en-us/library/ms178472.aspx)，这在渲染阶段之前很久。

确保在`PreRender`舞台结束之前，您永远不会做任何可能触发页面输出的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-15T15:30:35.743

我自己刚刚遇到这个问题，我想我会分享我的发现。

web.config 设置 DisplayWhenNewSession 无关紧要，因为它仅适用于 Codeplex 上的一个特定自定义控件（对不起，我丢失了链接）。

另一个建议似乎可以通过尽早初始化 SessionId 来工作。我使用 Reflector 深入研究了代码，并不太明白这如何防止这里出现错误，但它确实对我们有用！

像大多数似乎遇到这个错误的人一样，我们没有在应用程序的任何地方显式调用 Response.Flush()。为了记录，我们也使用 MVC。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-22T10:12:52.383

我知道这已经很老了，但我发现了另一个可能适用于其他人的错误原因。如果您使用的是 MVC（我使用的是带有 .Net 4.0 的 MVC 4）并且您使用 web.config 元素将页面设置为不缓冲

```
<pages buffer="false"> 
```

然后，如果您在代码中尝试将数据推送到会话对象中，如果页面在您的子视图或执行会话状态访问的操作之前开始呈现，则可能会出现此错误。

在这种情况下，您可以通过将上面的缓冲区设置更改为 true 来修复错误。或者，将您的会话访问代码移动到主视图而不是子操作/子视图中。

# iphone - 我必须在 Instruments 应用程序和 ObjectAlloc 中查看哪些指标，以查看我的应用程序中是否存在内存泄漏？

> ID：904953
> 
> 赞同：2
> 
> 时间：2009-05-25T00:22:39.797
> 
> 标签：iphone, cocoa-touch, memory-management, uikit, instruments

我想“#Net”列是最有趣的，虽然我不太明白那是什么意思。当前分配的对象总数？它一直在变化，即使我什么都不做。

是否有任何好的“经验法则”来查看是否存在内存泄漏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T01:03:08.217

您可能会发现本教程很有帮助：[http](http://www.mobileorchard.com/find-iphone-memory-leaks-a-leaks-tool-tutorial/) ://www.mobileorchard.com/find-iphone-memory-leaks-a-leaks-tool-tutorial/ 。

此外，还有一个静态分析器可以直接分析您的源代码： http: [//clang.llvm.org/StaticAnalysisUsage.html](http://clang.llvm.org/StaticAnalysisUsage.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T01:07:03.450

一般来说，如果你的应用程序的内存占用在你完成所有基本操作一两次后继续增长，那么你可能有内存泄漏。总内存占用在“Net Bytes”列中。“总体”列包括程序整个运行中的每个分配，而“净”列减去释放。

但是，根据我的经验，“Leaks”工具在捕获内存泄漏方面比 ObjectAlloc 好得多。只需在 Xcode 中选择“Run > Start With Performance Tool > Leaks”并运行您的程序一段时间。如果 Leaks 开始显示泄漏的块，那么您就有了泄漏。它会告诉您每个分配、保留、释放和释放任何泄漏块的堆栈跟踪，您可以双击堆栈跟踪以跳转到代码中的那个位置。只需确保通过单击窗口底部的小半阴影方形按钮打开“扩展详细信息视图”，就在“泄漏块”标签的左侧。要获取分配列表，请单击块旁边出现的小“圆圈中的三角形”披露三角形'

# silverlight - Silverlight 隔离存储：什么标识“应用程序”？

> ID：904965
> 
> 赞同：1
> 
> 时间：2009-05-25T00:30:35.210
> 
> 标签：silverlight, isolatedstorage

Silverlight 的 IsolatedStorageFile.GetUserStoreForApplication 的文档只是说隔离存储特定于“应用程序”，并且每个不同的应用程序都有自己的存储空间，独立于所有其他“应用程序”（但整个域有一个配额）。

这很好，但我还没有找到任何解释“应用程序”应该是什么意思的东西（在 Silverlight 文档或常规 .NET Framework 文档中）。Silverlight 使用哪些信息来确定“这是应用程序 A”和“这是应用程序 B”？它只是脱离 .xap 文件的 URI，还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T00:38:48.733

将其视为 URL。如果 URL 不同，则应用程序的隔离存储将不同。您可以随心所欲地更改文件中的元数据等。只是不是它的文件名/位置。如果我没记错的话，你甚至可以在同一个 URL 上放置一个不同的 XAP，它会占用前一个的隔离存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T12:42:39.260

是的，您必须选择隔离存储类型：

--> 一个和xap url有关，理论上是这样的，但是我在使用的时候发现了一个令人讨厌的惊喜。

--> 另一个对您的网站来说是通用的（来自您网站的网址）。

从理论上讲，您不会遇到任何问题，但是如果您的应用程序有问题（在我的情况下，当我进行新部署时，iso 被清除了:-()，请查看以下帖子：

[http://www.tipsdotnet.com/TechBlog.aspx?PageIndex=0&BLID=13](http://www.tipsdotnet.com/TechBlog.aspx?PageIndex=0&BLID=13)

[http://silverlight.net/forums/p/86003/200941.aspx#200941](http://silverlight.net/forums/p/86003/200941.aspx#200941)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T04:07:19.500

根据有关 IsolatedStorageFile 类的 MSDN 文章，“隔离存储的范围仅限于特定程序集”。您的应用程序是一个程序集（您的 XAP 文件）。程序集具有唯一标识它的程序集清单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-11T11:16:26.110

我们可以使用独立存储作为虚拟文件系统，将数据存储在 Silverlight 应用程序中我们机器上的隐藏文件夹中。Silverlight 应用程序为每个应用程序分配了 1 MB 的存储空间，但我们可以增加存储空间。这是获取隔离存储中数据的功能

```
 Private Function LoadData(ByVal fileName As String) As String
        Dim data As String = String.Empty
        Dim isfstream As New IsolatedStorageFileStream(fileName, FileMode.Open, IsolateStorageFileObj)
        Dim sr As New StreamReader(isfstream)
        data = sr.ReadLine()
        Return data
  End Function 
```

# c++ - C++中的引用速度

> ID：904966
> 
> 赞同：1
> 
> 时间：2009-05-25T00:31:04.430
> 
> 标签：c++, optimization, reference, map, timing

我一直在从事一个项目，并试图找到执行时间大幅下降的原因，并将其缩小到我设法从逻辑中优化的单一方法。问题是我的解决方案涉及使用引用，这使得代码的另一部分运行得非常缓慢......我想回答的问题是为什么当地图是引用而不是引用时，内部循环需要更长的时间来评估局部变量？

这是优化之前的旧方法：

```
// old method: create an empty map, populate it
// and then assign it back to the path object later
map<int,float> screenline_usage; 

for (int i=0; i<numCandidates; ++i)
{
  // timing starts here. 
  map<int, float>& my_screenline_usage =
    path->get_combined_screenline_usage(legnr, stop_id);
  map<int, float>::iterator it = my_screenline_usage.begin(); 
  for (; it != my_screenline_usage.end(); ++it) 
    screenline_usage[it->first] += usage * it->second; 
  // timing ends here, this block evaluated 4 million times for overall execution time of ~12 seconds
}

// This function call is evaluated 400k times for an overall execution time of ~126 seconds
path->set_zone_screenline_usage(access_mode, zone_id, screenline_usage); 

// TOTAL EXECUTION TIME: 138 seconds. 
```

优化后的新方式：

```
// new method: get a reference to internal path mapping and populate it
map<int, float>& screenline_usage =
  path->get_zone_screenline_usage(access_mode, zone_id);
screenline_usage.clear();

for (int i=0; i<numCandidates; ++i)
{
  // timing starts here
  map<int, float>& my_screenline_usage =
    path->get_combined_screenline_usage(legnr, stop_id);
  map<int, float>::iterator it = my_screenline_usage.begin(); 
  for (; it != my_screenline_usage.end(); ++it) 
    screenline_usage[it->first] += usage * it->second; 
  // timing ends here, this block evaluated 4 million times for overall execution time of ~76 seconds
}

// New method... no need to assign back to path object (0 seconds execution :)
// TOTAL EXECUTION TIME: 76 seconds (62 second time saving) ... but should be able to do it in just 12 seconds if the use of reference didn't add so much time :( 
```

以下是从该代码调用的相关子例程：

```
// This is the really slow routine, due to the copy assignment used. 
void set_zone_screenline_usage(int access_mode, int zone_id,
  map<int,float>& screenline_usage)
{
  m_container[access_mode][zone_id] = screenline_usage; 
}

map<int,float>& get_zone_screenline_usage(int access_mode, int zone_id)
{
  return m_container[access_mode][zone_id]; 
} 
```

注意：时间信息是针对单次运行的，其中上述代码被评估了大约 400k 次。计时是使用我为访问 RDTSC 时间戳计数器而构建的一些类完成的（是的，我知道 TSC 表示时间戳计数器），numCandidates 的平均值为 10，放入 screenline_usage 映射的平均元素数为 25。

* * *

更新：首先感谢所有参与其中的人。我认为最终这与 c++ 引用完全无关，更多的是与缓存一致性有关。我已将上面的优化代码替换为 vector& 和实现为成员变量映射的哈希函数

```
// newest method: get a reference to internal path mapping (as vector) and populate it 
// map<int,int> m_linkNum_to_SlNum declared in header and populated in constructor. 
vector<float>& screenline_usage = path->get_zone_screenline_usage(access_mode, zone_id);

for (int i=0; i<numCandidates; ++i)
{
  // timing starts here
  map<int, float>& my_screenline_usage =
    path->get_combined_screenline_usage(legnr, stop_id);
  map<int, float>::iterator it = my_screenline_usage.begin(); 
  for (; it != my_screenline_usage.end(); ++it) 
    screenline_usage[m_linkNum_to_SlNum[it->first]] += usage * it->second; 
  // timing ends here, this block evaluated 4 million times for overall execution time of ~9 seconds
}

// Newest method... again no need to assign back to path object (0 seconds execution :)
// TOTAL EXECUTION TIME: just 9 seconds (129 second time saving) ... this is even better than using a locally constructed map which took 12 seconds in the inner loop :) 
```

在我看来，鉴于向量不是本地的，而是一个连续的内存块，并且散列函数 (m_linkNum_to_SlNum) 是本地成员变量，这种方法导致代码/数据能够放入缓存中无需去主存储器获取数据，从而显着提高速度。非常感谢根据这些发现得出的其他结论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T00:39:26.283

也许您的 C++ 编译器能够为本地地图内联一些代码，但当地图是参考时则不行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T00:48:29.823

你的问题不清楚。你的意思是问，为什么通过引用传递映射比通过值传递更快？如果是这样，答案很简单：按值返回地图意味着将其全部复制，而复制大地图是一项非常昂贵的操作。

另一方面，如果您的问题是：为什么获取对现有地图的引用并填充它比制作新地图更快，那么一个假设是它与

```
 screenline_usage[it->first] += usage * it->second; 
```

由于 key [it->first] 已经存在于 path->get_zone_screenline_usage 内的 map 中，所以这只是一个简单的更新操作，不需要分配内存。但是，如果 screenline_usage 是一个空映射，那么每次访问一个新的 [it->first] 意味着它首先必须从堆中分配一个新的映射节点，这很昂贵。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T01:51:27.870

如果我正确理解您的问题，您暗示插入到本地堆栈分配的 map<> 比插入到您通过引用检索的现有堆分配的 map<> 快得多。

有几种可能会影响性能。不过，我怀疑它与 C++ 参考性能有什么关系。

第一种可能性是，通过更改`screenline_usage`为引用，您“本质上”是在检索指向现有对象的指针。对象的实际实例可能不是`map<int,float>`，它可以是从 map 继承的任何东西。例如，它可以是一个为其定义了自定义比较器函数的地图。或具有线程同步逻辑的子类。由于您不知道从对 的调用中获得了什么类型`m_container[access_mode][zone_id]`，因此您很可能会得到一个在插入时表现不佳的子类。（顺便说一句，您可以在调试器中看到返回的类型。）然而，通过创建一个空`map<int,float>`，您可以保证该类型是实际的 map<>，而不是子类。

假设您正在获取一个实际的 map<> 实例。

第二种可能性是，在您使用的特定 STL 风格中，该`map::clear()`函数不能有效地清除用于维护关联索引的内部数据结构。我记得， stl::map<> 使用一些复杂的内部散列和桶结构来提供高效的插入和检索功能。但是，尚不清楚调用 clear() 时会发生什么。因此，`screenline_usage.clear()`与从空地图开始相比，插入地图的效率可能会更低。

最后，让我们假设我错了，这两种可能性都不是。有一种简单的方法可以确定差异是否是使用参考变量的结果。您可以尝试在堆上分配新映射并将其分配给代码中的引用，如下所示：

```
map<int, float>& screenline_usage = new map<int,float>(); 
```

这将帮助您确定插入现有地图和新地图是否存在一些差异，或者是否确实是 screenline_usage 是影响性能的参考。顺便说一句，不要忘记释放这个堆分配的映射，否则最终会导致内存泄漏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T02:05:30.463

引用通常在幕后实现为指针。一个例外是，如果为它们分配了一个临时值，那么值的生命周期将延长到引用的生命周期；本质上，引用就是对象。所以，这取决于：

get_combined_screenline_usage

按引用或按值返回。如果是通过引用，引用方式*可能*会更快。如果是按值，那么旧方式和新方式本质上是做同样的事情，假设编译器做了返回值优化。

在这两种情况下，编译器所做的其他优化（例如内联）可能会掩盖这两种选择的影响；实际上，在不知道您的慢速部分是哪条确切线的情况下，这有点像猜谜游戏。

我建议尝试获取更细粒度的信息，并将其缩小到确切需要这么长时间的行，这会使优化变得容易得多。

（注：

```
map<int, float>::iterator it = my_screenline_usage.begin(); 
for (; it != my_screenline_usage.end(); ++it) 
```

如果写成可能会更有效

```
for (map<int, float>::const_iterator it(my_screenline_usage.begin()), end(my_screenline_usage.begin()); it != end; ++it) 
```

)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T00:47:48.497

> 我试图弄清楚的问题是为什么当地图是参考时，内部循环需要更长的时间来评估？

我猜想花费很长时间的是对`get_zone_screenline_usage`: 的调用，并且花费很长时间的原因是特定元素尚不存在，`m_container`因此必须在返回之前创建和插入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-16T00:48:12.127

根据我的更新，我认为这很可能是缓存一致性问题，而不是 C++ 参考问题。

# asp.net - 我应该在哪里存储关于我的 ASP.NET 应用程序的版本信息？

> ID：904968
> 
> 赞同：0
> 
> 时间：2009-05-25T00:32:41.743
> 
> 标签：asp.net

网络配置？网站属性？我正在寻找建议/最佳实践以及您推荐它们的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T00:34:50.850

对项目进行版本控制的最佳方法是在此文件中设置`AssemblyVersion`和`AssemblyFileVersion`属性：

> 装配信息.cs

设置这些最简单的方法是使用项目本身的属性表（右键单击项目文件并选择“属性”）。在第一个选项卡（“应用程序”）上，单击“程序集信息...”按钮并在结果对话框中设置版本。这些更改将保存到我上面提到的文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T01:13:04.453

存储应用程序版本信息的最简单方法是通过 AssemblyInfo.cs 文件。您可以使用诸如 UpdateVersion 实用程序和预构建事件之类的工具自动进行此更新（有关更多详细信息，请参阅[此 StackOverflow 问题](https://stackoverflow.com/questions/826777/how-to-have-an-auto-incrementing-version-number-visual-studio/)）。

在相关的说明中，我有一个您可能会发现有用的博客条目，其中详细介绍了如何构建一个[ASP.NET About 页面](http://www.munsplace.com/blog/2009/02/09/aspnet-about-page/)，该页面可以将 AssemblyInfo 文件中的信息以及其他程序集的详细信息提取到您的 Web 应用程序中bin 文件夹。

# php - mod-rewrite URL 更改

> ID：904970
> 
> 赞同：0
> 
> 时间：2009-05-25T00:33:19.697
> 
> 标签：php, .htaccess, mod-rewrite

当我更改设置时，我在玩画廊时遇到了问题。但是，我注意到错误有一个模式：

URL 如下所示：
main.php/d/number/name.jpg

**“数字”是动态的（即“9496-2”）
“名称”是动态的（即“all+clad+7pc+b”）**

其他一切都是静态的。

不幸的是，当我进行设置更改时，“数字”部分从“9496-2”变为“9495-2”。

如何从变量“数字”中减去值“1”？

杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T00:39:49.793

这应该这样做。

```
RewriteEngine On
RewriteBase /
RewriteRule ^photos/ebay/main.php/d/([0-9]*)6-([0-9]*)/(.*).jpg /photos/ebay/main.php/d/$1\5-$2/$3.jpg [QSA,L] 
```

我知道你说你已经知道了，但这是一个没有额外脚本的解决方案。（我实际上测试了这个以确保 \5 有效）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T00:44:06.867

你没有说你的网址的哪一部分是固定的，哪一部分是不同的，所以我只是猜测：

```
RewriteEngine on
RewriteBase /
RewriteRule ^/photos/ebay/main.php/d/9496-2/(.*)$ /photos/ebay/main.php/d/9495-2/$1 [QSA,L] 
```

`R=301`如果您想将重定向发送回客户端，您可能还想添加到标志。（按原样，这应该只是做一个“内部重定向”）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T20:28:53.443

这是有效的解决方案。它涉及使用 .htaccess 文件和 PHP 脚本。

**.htaccess 文件**：
创建具有以下内容的“.htaccess”文件：

```
RewriteEngine On
RewriteBase /

# Redirect to PHP Script
RewriteRule ^main.php/d/([0-9]*)-([0-9])/(.*)$ scriptName.php?v1=$1&v2=$2&v3=$3 [R=301,QSA,L] 
```

**PHP 脚本：**
创建“scriptName.php”，然后添加您的逻辑。就我而言，我需要从 v1 中减去“1”。

*注意：确保 .htaccess 和 PHP 脚本在同一路径中。*

# java - 意图问题，返回值（Android）

> ID：904972
> 
> 赞同：10
> 
> 时间：2009-05-25T00:38:45.817
> 
> 标签：java, android

我有一个使用意图打开另一个类的应用程序：

```
私人无效createRepository（）{
        Intent j = new Intent(this, Repository.class);
        startActivityForResult(j, ACTIVITY_CREATE);
    }

```

在 Repository.class 我们有**onActivityResult**方法：

```
public void onActivityResult(int reqCode, int resultCode, Intent data) {
      super.onActivityResult(reqCode, resultCode, data);

      开关（reqCode）{
        案例（PICK_CONTACT）：
          if (resultCode == Activity.RESULT_OK) {
            Uri contactData = data.getData();
            c = managedQuery(contactData, null, null, null, null);
            如果（c.moveToFirst（））{
              //字符串名称 = c.getString(c.getColumnIndexOrThrow(People.NAME));
              num = c.getString(c.getColumnIndexOrThrow(People.NUMBER));

            }    

          }    
        休息;
      }
      结束（）;
    }

```

我不知道如何将**num**的值返回给第一个类（创建 Repository.class）。感谢您的帮助。迈克尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T03:40:34.340

我想你把方向弄混了。

在 Repository 类中，您必须`setResult()`在调用完成之前。对于其他数据，您可以`putExtra()`数据。

例如，在`onCreate()`函数中设置您的结果。

在您的调用类（启动存储库的类）中，您`onActivityResult(int requestCode, int resultCode, Intent data)`使用`data.getBundleExtra()`.

Intent 和 Activity 的 Android 参考有很好的描述，示例还包含 ReceiveResult 和 SendResult 示例。

# perl - 如何在 Perl 中找到打印语句的源位置？

> ID：904975
> 
> 赞同：9
> 
> 时间：2009-05-25T00:39:44.317
> 
> 标签：perl

如何在 Perl 中找到打印语句的源位置？

```
#!/usr/bin/perl

foo();
bar();

sub foo {
  print "foo\n";
}

sub bar {
  print "bar\n";
} 
```

输出为：

```
>perl test.pl 
foo
bar 
```

我想以某种方式找到能够看到（或类似的东西）

```
>perl test.pl 
main::foo> foo
main::bar> bar 
```

这样做的原因是我试图追踪一些胭脂输出，但无法在大型代码库中找到它的位置。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-25T12:53:56.150

尝试这个：

```
#!/usr/bin/env perl

use strict;
use warnings;
use Tie::STDOUT print => sub {
  my ( $pkg, $file, $line ) = caller(2);
  print "$pkg, $file, $line :: ", @_;
};

print "Hello, World\n"; 
```

这使：

```
$ perl tp.pl
main, tp.pl, 10 :: Hello, World 
```

更新：我刚刚发布了[Devel::Ditto](http://search.cpan.org/dist/Devel-Ditto/)：

```
$ perl -MDevel::Ditto myprog.pl
[main, t/myprog.pl, 9] This is regular text
[main, t/myprog.pl, 10] This is a warning
[MyPrinter, t/lib/MyPrinter.pm, 7] Hello, World
[MyPrinter, t/lib/MyPrinter.pm, 8] Whappen? 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-25T07:08:11.760

使用 Debug::Trace ( [https://metacpan.org/pod/Debug::Trace](https://metacpan.org/pod/Debug::Trace) )

```
#!/usr/bin/perl

foo();
bar();

sub foo {
  print "foo\n";
}

sub bar {
  print "bar\n";
} 
```

该程序保存为 test.pl 并调用为：

```
perl -MDebug::Trace=foo,bar test.pl 
```

打印出来：

```
TRACE:  main::foo() called at test.pl line 3 package main
foo
TRACE:  main::foo() returned
TRACE:  main::bar() called at test.pl line 4 package main
bar
TRACE:  main::bar() returned 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-25T06:14:43.117

我知道源过滤器可能对某些事情有用：

```
C:\Temp> cat DebugFilter.pm
package DebugFilter;

use strict;
use warnings;

use Filter::Simple;

FILTER_ONLY
    code_no_comments => sub {
        s/print/main::mydebugfn();print/g
    };

1;
__END__

C:\Temp> cat DebugPrint.pm
package DebugPrint;

use strict;
use warnings;

use base qw( Exporter );

our @EXPORT = qw( mydebugfn );

sub mydebugfn {
    my ( $pkg, $fn, $line, $sub ) = caller(2);
    warn "print called from: ${sub}(${fn}:${line})\n";
}

1;
__END__

C:\Temp> cat t.pl
#!/usr/bin/perl

use strict;
use warnings;

use DebugFilter;

sub test {
    print STDOUT "print in test\n";
    return;
}

test(); 
```

这是输出：

```
C:\Temp> perl -MDebugPrint t.pl
print called from: main::test(t.pl:13)
print in test 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-25T02:44:18.090

这篇文章解释了如何挂钩到 perl 打印功能： [如何挂钩到 Perl 的打印？](https://stackoverflow.com/questions/387702/how-can-i-hook-into-perls-print)

如果您不想用其他东西替换源代码中的所有打印语句，您可能需要它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-25T07:24:48.467

我将保留源过滤器替代方案以供参考，因为它旨在跟踪单个函数的调用。

但是，解决方案似乎是使用[Devel::Trace](http://search.cpan.org/~mjd/Devel-Trace-0.10/)。这可能会生成大量输出，您可以将其重定向到文件，然后 grep 查找有问题的输出。

```
C:\Temp> perl -d:Trace t.pl
>> t.pl:10: T::test();
>> T.pm:5:     print "in T::test\n";
in T::test
>> c:/opt/perl/lib/Config.pm:63: sub DESTROY { } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-25T01:10:20.853

Copas：我无法直接回复您的评论（还不够“酷”），但基本问题是任何体面的项目都不是一个 .pl 文件。这是一堆模块都被拉在一起。

你的代码：

a) 不解决一个 .pl 文件之外的任何内容 b) 不处理 print(...) 有括号或不同间距的情况。c) 不能处理 print 的第一个参数是函数调用或变量而不是双引号字符串的情况。d) 考虑： $object->log("我要打印 " . foo($var) . " 到控制台"); - 您的正则表达式会导致语法错误，使： $object->log("Am about print "Line 1084: . $foo($var) . " to the console");

也就是说，它对于简单的脚本是可行的。这不是一个坏主意（最坏的情况，您的 newsource.pl 无法编译） - 但除非它全部在一个文件中，否则它不会解决这个特定问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-25T00:47:00.077

您可以尝试使用调试器（perl -d）单步执行您的代码。

我将建议覆盖打印并使用：

```
($package, $filename, $line) = caller; 
```

...打印出额外的信息，但事实证明 print 是无法覆盖的内置函数之一。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-25T02:08:07.197

您可以尝试使用[Hook::LexWrap](http://search.cpan.org/perldoc?Hook::LexWrap)来深入了解代码库中的调用内容。它在内部做了一些非常邪恶的事情，因此不适用于所有代码库。

# iphone - 如何在调试器中查看属性值

> ID：904995
> 
> 赞同：0
> 
> 时间：2009-05-25T00:55:34.957
> 
> 标签：iphone, xcode, uiviewcontroller, debugging

我有一个 UIViewController 并希望查看诸如 myview.view.hidden 之类的属性。在另一个声明 UIViewController 实例的类中，我可以通过代码分配和读取属性，但想知道各个点的值。在调试器控制台中，我不能执行“po myview.view.hidden”或“p myview.view.hidden”。还有另一种方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T02:06:21.757

```
po [[myview view] hidden] 
```

# mvvm - 我怎样才能避免这个无限循环？

> ID：904999
> 
> 赞同：2
> 
> 时间：2009-05-25T00:58:19.163
> 
> 标签：mvvm, wrapper, infinite-loop, stack-overflow

感觉必须有一些半简单的解决方案，但我就是想不通。

编辑：前面的示例更清楚地显示了无限循环，但这提供了更多上下文。查看预编辑以快速了解问题。

以下 2 个类代表模型视图视图模型 ( [MVVM](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx) ) 模式的视图模型。

```
/// <summary>
/// A UI-friendly wrapper for a Recipe
/// </summary>
public class RecipeViewModel : ViewModelBase
{
    /// <summary>
    /// Gets the wrapped Recipe
    /// </summary>
    public Recipe RecipeModel { get; private set; }

    private ObservableCollection<CategoryViewModel> categories = new ObservableCollection<CategoryViewModel>();

    /// <summary>
    /// Creates a new UI-friendly wrapper for a Recipe
    /// </summary>
    /// <param name="recipe">The Recipe to be wrapped</param>
    public RecipeViewModel(Recipe recipe)
    {
        this.RecipeModel = recipe;
        ((INotifyCollectionChanged)RecipeModel.Categories).CollectionChanged += BaseRecipeCategoriesCollectionChanged;

        foreach (var cat in RecipeModel.Categories)
        {
            var catVM = new CategoryViewModel(cat); //Causes infinite loop
            categories.AddIfNewAndNotNull(catVM);
        }
    }

    void BaseRecipeCategoriesCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        switch (e.Action)
        {
            case NotifyCollectionChangedAction.Add:
                categories.Add(new CategoryViewModel(e.NewItems[0] as Category));
                break;
            case NotifyCollectionChangedAction.Remove:
                categories.Remove(new CategoryViewModel(e.OldItems[0] as Category));
                break;
            default:
                throw new NotImplementedException();
        }
    }

    //Some Properties and other non-related things

    public ReadOnlyObservableCollection<CategoryViewModel> Categories 
    {
        get { return new ReadOnlyObservableCollection<CategoryViewModel>(categories); }
    }

    public void AddCategory(CategoryViewModel category)
    {
        RecipeModel.AddCategory(category.CategoryModel);
    }

    public void RemoveCategory(CategoryViewModel category)
    {
        RecipeModel.RemoveCategory(category.CategoryModel);
    }

    public override bool Equals(object obj)
    {
        var comparedRecipe = obj as RecipeViewModel;
        if (comparedRecipe == null)
        { return false; }
        return RecipeModel == comparedRecipe.RecipeModel;
    }

    public override int GetHashCode()
    {
        return RecipeModel.GetHashCode();
    }
} 
```

.

```
/// <summary>
/// A UI-friendly wrapper for a Category
/// </summary>
public class CategoryViewModel : ViewModelBase
{
    /// <summary>
    /// Gets the wrapped Category
    /// </summary>
    public Category CategoryModel { get; private set; }

    private CategoryViewModel parent;
    private ObservableCollection<RecipeViewModel> recipes = new ObservableCollection<RecipeViewModel>();

    /// <summary>
    /// Creates a new UI-friendly wrapper for a Category
    /// </summary>
    /// <param name="category"></param>
    public CategoryViewModel(Category category)
    {
        this.CategoryModel = category;
        (category.DirectRecipes as INotifyCollectionChanged).CollectionChanged += baseCategoryDirectRecipesCollectionChanged;

        foreach (var item in category.DirectRecipes)
        {
            var recipeVM = new RecipeViewModel(item); //Causes infinite loop
            recipes.AddIfNewAndNotNull(recipeVM);
        }
    }

    /// <summary>
    /// Adds a recipe to this category
    /// </summary>
    /// <param name="recipe"></param>
    public void AddRecipe(RecipeViewModel recipe)
    {
        CategoryModel.AddRecipe(recipe.RecipeModel);
    }

    /// <summary>
    /// Removes a recipe from this category
    /// </summary>
    /// <param name="recipe"></param>
    public void RemoveRecipe(RecipeViewModel recipe)
    {
        CategoryModel.RemoveRecipe(recipe.RecipeModel);
    }

    /// <summary>
    /// A read-only collection of this category's recipes
    /// </summary>
    public ReadOnlyObservableCollection<RecipeViewModel> Recipes
    {
        get { return new ReadOnlyObservableCollection<RecipeViewModel>(recipes); }
    }

    private void baseCategoryDirectRecipesCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        switch (e.Action)
        {
            case NotifyCollectionChangedAction.Add:
                var recipeVM = new RecipeViewModel((Recipe)e.NewItems[0], this);
                recipes.AddIfNewAndNotNull(recipeVM);
                break;
            case NotifyCollectionChangedAction.Remove:
                recipes.Remove(new RecipeViewModel((Recipe)e.OldItems[0]));
                break;
            default:
                throw new NotImplementedException();
        }
    }

    /// <summary>
    /// Compares whether this object wraps the same Category as the parameter
    /// </summary>
    /// <param name="obj">The object to compare equality with</param>
    /// <returns>True if they wrap the same Category</returns>
    public override bool Equals(object obj)
    {
        var comparedCat = obj as CategoryViewModel;
        if(comparedCat == null)
        {return false;}
        return CategoryModel == comparedCat.CategoryModel;
    }

    /// <summary>
    /// Gets the hashcode of the wrapped Categry
    /// </summary>
    /// <returns>The hashcode</returns>
    public override int GetHashCode()
    {
        return CategoryModel.GetHashCode();
    }
} 
```

除非要求，否则我不会费心展示模型（配方和类别），但它们基本上会处理业务逻辑（例如，将配方添加到类别也会添加链接的另一端，即如果类别包含食谱，那么食谱也包含在该类别中）并且基本上决定了事情的进展。ViewModel 为 WPF 数据绑定提供了一个很好的接口。这就是包装类的原因

由于无限循环在构造函数中并且它正在尝试创建新对象，因此我不能只设置一个布尔标志来防止这种情况发生，因为这两个对象都没有完成构造。

我在想的是（作为单例或传递给构造函数或两者兼而有之）a `Dictionary<Recipe, RecipeViewModel>`，`Dictionary<Category, CategoryViewModel>`它将延迟加载视图模型，但如果一个已经存在，则不会创建一个新的，但我还没有解决试图看看它是否会工作，因为它已经很晚了，我有点厌倦了在过去的 6 个小时左右处理这个问题。

不能保证这里的代码会编译，因为我取出了一堆与手头的问题无关的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T08:38:29.970

回到你原来的问题（和代码）。如果您想要的是自动同步的多对多关系，请继续阅读。寻找处理这些情况的复杂代码的最佳位置是任何 ORM 框架的源代码，这对于这个工具领域来说是非常常见的问题。我会查看 nHibernate 的源代码（[https://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/](https://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/)），看看它如何实现处理 1-N 和 MN 关系的集合。

您可以尝试的简单方法是创建自己的小集合类来处理它。下面我删除了您原来的包装类并添加了一个 BiList 集合，该集合使用对象（集合的所有者）和要与之保持同步的属性另一侧的名称进行初始化（仅适用于 MN，但 1- N 很容易添加）。当然，你会想要完善代码：

```
using System.Collections.Generic;

public interface IBiList
{
    // Need this interface only to have a 'generic' way to set the other side
    void Add(object value, bool addOtherSide);
}

public class BiList<T> : List<T>, IBiList
{
    private object owner;
    private string otherSideFieldName;

    public BiList(object owner, string otherSideFieldName) {
        this.owner = owner;
        this.otherSideFieldName = otherSideFieldName;
    }

    public new void Add(T value) {
        // add and set the other side as well
        this.Add(value, true);
    }

    void IBiList.Add(object value, bool addOtherSide) {
        this.Add((T)value, addOtherSide);
    }

    public void Add(T value, bool addOtherSide) {
        // note: may check if already in the list/collection
        if (this.Contains(value))
            return;
        // actuall add the object to the list/collection
        base.Add(value);
        // set the other side
        if (addOtherSide && value != null) {
            System.Reflection.FieldInfo x = value.GetType().GetField(this.otherSideFieldName);
            IBiList otherSide = (IBiList) x.GetValue(value);
            // do not set the other side
            otherSide.Add(this.owner, false);
        }
    }
}

class Foo
{
    public BiList<Bar> MyBars;
    public Foo() {
        MyBars = new BiList<Bar>(this, "MyFoos");
    }
}

class Bar
{
    public BiList<Foo> MyFoos;
    public Bar() {
        MyFoos = new BiList<Foo>(this, "MyBars");
    }
}

public class App
{
    public static void Main()
    {
        System.Console.WriteLine("setting...");

        Foo testFoo = new Foo();
        Bar testBar = new Bar();
        Bar testBar2 = new Bar();
        testFoo.MyBars.Add(testBar);
        testFoo.MyBars.Add(testBar2);
        //testBar.MyFoos.Add(testFoo); // do not set this side, we expect it to be set automatically, but doing so will do no harm
        System.Console.WriteLine("getting foos from Bar...");
        foreach (object x in testBar.MyFoos)
        {
            System.Console.WriteLine("  foo:" + x);
        }
        System.Console.WriteLine("getting baars from Foo...");
        foreach (object x in testFoo.MyBars)
        {
            System.Console.WriteLine("  bar:" + x);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T21:27:10.003

首先，*DI*不会解决您的问题，但始终与*DI*相关的要解决您的问题的一件事是使用*容器*（或具有查找功能的上下文）

**解决方案：**

您的代码在这些地方失败：

```
var catVM = new CategoryViewModel(cat); //Causes infinite loop
...
var recipeVM = new RecipeViewModel(item); //Causes infinite loop 
```

问题是由于您为对象创建了包装器 (xxxViewModel)，即使它已经存在。您无需再次为同一对象创建包装器，而是需要检查此模型的包装器是否已存在并使用它。所以你需要一个容器来跟踪所有创建的对象。您的选择是：

**选项 1：**使用简单的 a-la 工厂模式来创建您的对象，但也要跟踪它们：

```
class CategoryViewModelFactory
{
    // TODO: choose your own GOOD implementation - the way here is for code brevity only
    // Or add the logic to some other existing container
    private static IDictionary<Category, CategoryViewModel>  items = new Dictionary<Category, CategoryViewModel>();
    public static CategoryViewModel GetOrCreate(Category cat)
    {
        if (!items.ContainsKey(cat))
            items[cat] = new CategoryViewModel(cat);
        return items[cat];
    }
} 
```

然后你在配方方面做同样的事情，*有问题*的代码是固定的：

```
 // OLD: Causes infinite loop
  //var catVM = new CategoryViewModel(cat);
  // NEW: Works 
  var catVM = CategoryViewModelFactory.GetOrCreate(cat); 
```

**当心：可能的内存泄漏？**

您应该注意的一件事（这也是您不应该使用*虚拟 a-la 工厂*实现的原因）是这些*创建者*对象将保留对模型对象及其视图包装器的引用这一事实。因此 GC 将无法从内存中清除它们。

**option-1a：**很可能您的应用程序中已经有一个控制器（或上下文），视图可以访问它。在这种情况下，我不会创建那些*a-la factory*，而是将 GetOrCreate 方法移至此上下文。在这种情况下，当上下文消失（表单关闭）时，这些字典也将被取消引用，泄漏问题也消失了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T01:05:10.867

选项：

1.  实施成员资格测试，例如在添加之前检查 bar-is-member-of-foo
2.  将多对多关系移至其自己的类

我认为后者是首选 - 它更具相关性

当然，以 foo-bar 为例，我们真的不知道目标是什么，因此您的里程可能会有所不同

编辑：给定原始问题中的代码，#1 将不起作用，因为无限递归发生在任何东西被添加到任何列表之前。

这种方法/问题有几个问题，可能是因为它已经被抽象到近乎愚蠢的地步——有利于说明编码问题，但不利于解释最初的意图/目标：

1.  包装类实际上并没有包装任何东西或添加任何有用的行为；这使得很难看出为什么需要它们
2.  *使用给定的结构，您根本*无法初始化构造函数中的列表，因为每个包装器列表都会立即创建另一个包装器列表的新实例
3.  即使你将初始化与构造分开，你仍然有一个具有隐藏成员资格的循环依赖（即包装器相互引用但从包含检查中隐藏 foo/bar 元素；这并不重要，因为代码永远不会添加任何东西无论如何，任何名单！）
4.  直接的关系方法会起作用，但需要搜索机制并假设包装器将根据需要而不是提前创建，例如具有搜索功能的数组或一对字典（例如 Dictionary>、Dictionary>）将适用于映射但可能不适合您的对象模型

# 结论

我认为*所描述*的结构不会起作用。不使用 DI，不使用工厂，根本不使用 - 因为包装器在隐藏子列表时相互引用。

这种结构暗示了未说明的不正确假设，但没有上下文我们无法找出它们可能是什么。

请用真实世界的对象和期望的目标/意图在原始上下文中重述问题。

或者至少说明您认为您的示例代码*应该*产生什么结构。;-)

# 附录

感谢您的澄清，这使情况更容易理解。

我没有使用 WPF 数据绑定 - 但我浏览了[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/dd458800.aspx)- 所以以下内容可能有帮助和/或正确：

*   我认为视图模型类中的类别和食谱集合是多余的
    *   您已经在基础类别对象中拥有 M:M 信息，那么为什么要在视图模型中复制它
    *   看起来您的集合更改处理程序也会导致无限递归
    *   集合更改的处理程序似乎不会更新包装配方/类别的底层 M:M 信息
*   我认为视图模型的目的是公开底层模型数据，而不是单独包装它的每个组件。
    *   这似乎是多余的并且违反了封装
    *   它也是你无限递归问题的根源
    *   天真地，我希望 ObservableCollection 属性仅返回底层模型的集合......

您拥有的结构是多对多关系的“倒排索引”表示，这对于优化查找和依赖管理非常常见。它简化为一对一对多的关系。查看 MSDN 文章中的 GamesViewModel 示例 - 请注意，Games 属性只是

```
ObservableCollection<Game> 
```

并不是

```
ObservableCollection<GameWrapper> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T01:06:16.637

我建议您摆脱相互依赖，例如通过依赖倒置原则，[http](http://en.wikipedia.org/wiki/Dependency_inversion_principle) ://en.wikipedia.org/wiki/Dependency_inversion_principle - 至少具有 Foo 和 Bar 两侧之一（或它们的包装器）依赖于对方实现的抽象接口，而不是让两个具体类直接相互依赖，这很容易产生循环依赖和相互递归的噩梦，就像你正在观察的那样。此外，还有一些替代方法可以实现值得考虑的多对多关系（并且通过引入合适的接口可能更容易受到依赖反转的影响）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T02:11:16.643

我要说的是[工厂模式](http://www.dofactory.com/Patterns/PatternAbstract.aspx)。这样，您可以依次构建每个，然后将它们相互添加，然后将它们全部归还，以防止工厂窥探。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T04:02:41.217

这让我想起了当对象包含其他对象时，序列化防止无限循环的方式。它将每个对象的哈希码映射到其字节数组，因此当一个对象包含对另一个对象的引用时：a) 不会将同一个对象序列化两次，并且 b) 不会将自身序列化为无限循环。

你基本上有同样的问题。解决方案可能就像使用某种地图而不是列表集合一样简单。如果您得到的是多对多，那么您只需创建一个列表映射。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-25T04:27:52.277

伙计，我的回答不像那些 DI 的那么酷。但...

简单来说，我认为您必须在开始关联它们之前创建包装器。遍历整个 Foos 列表，创建 FooWrappers。然后遍历 Bars 并创建 BarWrappers。然后读取源 Foos，将适当的 BarWrapper 引用添加到关联的 FooWrapper 中的 MyBarWrapper，反之亦然。

如果你坚持为 Foo 实例创建一个包装器并立即创建与它的每个 Bar 实例的关系，那么你必须通过标记你正在处理的 Foo 来“打破”循环，即 Foo_1，并让每个 BarWrapper 实例知道不要在它的 MyFooWrappers 集合中创建另一个 FooWrapper_1 实例。毕竟，事实上，您已经在调用堆栈的上层（或下层）创建了 FooWrapper_1。

底线：作为代码健全的问题，包装器构造函数不应该创建更多的包装器。最多 - 它应该只知道/发现每个 Foo 和 Bar 在其他地方存在一个唯一的包装器，并且只有在其他地方找不到它时才可能创建包装器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-25T03:56:36.740

所以，Foo 和 Bar 是模型。Foo 是 Bars 的列表，Bar 是 Foos 的列表。如果我没看错，你有两个对象，它们只是彼此的容器。A 是所有 B 的集合，B 是所有 As 的集合？这不是循环的本质吗？根据其定义，它是无限递归。现实世界的案例是否包含更多行为？也许这就是人们难以解释解决方案的原因。

我唯一的想法是，如果这真的是故意的，那么使用静态类或使用静态变量来记录类已经创建了一次且仅一次。********************