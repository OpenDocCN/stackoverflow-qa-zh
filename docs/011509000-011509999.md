# StackOverflow 问答 11509000-11509999

# c# - 为什么我不能直接将自定义事件 args 类传递给订阅我的事件的方法？

> ID：11509001
> 
> 赞同：2
> 
> 时间：2012-07-16T16:59:34.140
> 
> 标签：c#, .net, events

为什么我不能直接将自定义事件参数传递给订阅我的事件的方法，即使我的自定义事件 args 类直接继承自`EventArgs`？

例如，考虑以下两个类。一个是我要使用的类，另一个继承自`EventArgs`，并包含一些与事件相关的附加信息：

```
using System;

namespace ConsoleApplication11
{
    class MyClass
    {
        public event EventHandler MyEvent;

        public void MyMethod(int myNumber)
        {
            Console.WriteLine(myNumber);

            if(myNumber == 7)
            {
                MyEvent.Invoke(null, new MyCustomEvent() { Foo = "Bar" });
            }
        }
    }

    class MyCustomEvent : EventArgs
    {
        public string Foo { get; set; }
    }
} 
```

因此，如果将数字 7 传递给`MyMethod`，我想调用`MyEvent`将`MyCustomEvent`类的新实例传递给订阅我的事件的任何方法。

我从我的主程序中订阅了这个，如下所示：

```
using System;

namespace ConsoleApplication11
{
    class Program
    {
        static void Main(string[] args)
        {
            MyClass myClass = new MyClass();
            myClass.MyEvent += new EventHandler(myClass_MyEvent);

            for (int i = 0; i < 9; i++)
            {
                myClass.MyMethod(i);
            }
        }

        static void myClass_MyEvent(object sender, EventArgs e)
        {
            //Do Stuff
        }
    }
} 
```

即使我在`MyCustomEvent`调用事件时传入了一个对象，如果我将订阅我的事件的方法中的第二个参数更改为一个`MyCustomEvent`对象，我会得到一个编译错误。我需要将`EventArgs`对象显式转换为 a `MyCustomEvent`，然后才能访问类中的任何其他字段/方法等。

当使用具有许多不同事件的对象时，每个事件都有一个唯一相关的自定义`EventArgs`类，跟踪每个订阅每个事件的方法中的 EventArgs 需要强制转换可能会有点混乱。

如果我可以将我的自定义 EventArgs 类直接传递到订阅我的事件的方法中，那会容易得多。

这是一种可能吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:05:03.153

不要将您的事件声明为 type `EventHandler`，而是创建一个专门使用您的自定义事件 args 类的新委托：

```
public delegate void MyEventHandler(object sender, MyEventArgs args);
public event MyEventHandler MyEvent; 
```

现在您可以直接传递参数而无需强制转换。

另一种选择是使用泛型`EventHandler<T>`：

```
public event EventHandler<MyEventArgs> MyEvent; 
```

我更喜欢前者，因为你可以给委托类型一个更具描述性的名称，尽管后者更快一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:03:51.470

使用以下通用版本声明您的事件`EventHandler`：

```
public event EventHandler<MyCustomEvent> MyEvent; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:04:40.267

而不是使用默认事件处理程序，只需定义适合您要实现的签名的自己的事件处理程序......

```
public delegate void MyEventHandler(object sender, MyCustomEventArgs e)
public event MyEventHandler MyEvent; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T17:06:25.697

如果我理解你的问题是错误的，请原谅我。`EventArgs`没有看到任何自定义类，我有点困惑。

你不能像这样制作方法签名

```
static void myClass_MyEvent(object sender, CustomEventArgs e) 
```

对于期望一个事件

```
static void myClass_MyEvent(object sender, EventArgs e) 
```

那是反向多态性，而多态性不能反向工作。

假设您的事件访问 a `e.OnlyInCustomEventArgs`，但传递给基础对象`EventArgs`. 然后合同就被打破了。

现在你能做的是

```
static void myClass_MyEvent(object sender, EventArgs e)
{
    CustomEventArgs cea = (CustomEventArgs)e;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-28T14:18:59.297

这是正确实现的自定义 arg 事件处理程序的完整代码。

```
class MyClass
{
    public event EventHandler<MyCustomEventArgs> MyEvent;

    public void MyMethod(int myNumber)
    {
        Console.WriteLine(myNumber);

        if (myNumber == 7)
        {
            MyEvent.Invoke(null, new MyCustomEventArgs() { Foo = "Bar" });
        }
    }
}

class MyCustomEventArgs : EventArgs
{
    public string Foo { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        MyClass myClass = new MyClass();
        myClass.MyEvent += new EventHandler<MyCustomEventArgs>(myClass_MyEvent);

        for (int i = 0; i < 9; i++)
        {
            myClass.MyMethod(i);
        }
    }

    //This is the method signature that you need to use to handle the event
    static void myClass_MyEvent(object sender, MyCustomEventArgs e)
    {
        Console.WriteLine(e.Foo); // prints "Bar"
        //Do Stuff
    }

    //If you need to handle more than one type of custom event args
    static void myClass_MyEvent<T>(object sender, T e) where T : EventArgs
    {
        //Do Stuff
    }
} 
```

# sql-server - 将描述列拆分为 3 列，T-SQL / SQL Server 2008

> ID：11509002
> 
> 赞同：1
> 
> 时间：2012-07-16T16:59:34.830
> 
> 标签：sql-server, string, sql-server-2008, tsql

我需要将一`nvarchar(100)`列分成三`nvarchar(28)`列，没有已知的分隔符，也没有中断中间词。我在想我需要找到第 28 个字符附近的空格，测量该空格之前单词的长度和位置，并确定分隔符应该在该单词之前还是之后的天气。然后，再次为第 3 列。从：

```
科尔
-------------------------------------------------- ----------------------------------
Royal Mission 开放式厨房，带 4 拱门，普通玻璃（标准玻璃搁板）

```

到：

```
Col1 Col2 Col3
------------------------------------ ------------- - -------------------------
Royal Mission Open Hutch 4 拱门，普通玻璃（带玻璃搁板 Standa

```

有任何想法吗？谢谢 nab

我正在使用 SQL 2008

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:50:15.300

使用 CROSS APPLYs，你可以尝试这样的事情：

```
WITH data (col) AS (
  SELECT CAST('Royal Mission Open Hutch with 4-Arch Doors, Plain Glass (with Glass Shelves Standard)' AS nvarchar(100))
)
SELECT
  col1, col2, col3
FROM data
CROSS APPLY (
  SELECT
    NULLIF(30 - CHARINDEX(' ', REVERSE(LEFT(col, 29))), 0)
) AS x1 (first_space_pos)
CROSS APPLY (
  SELECT
    LEFT(col, ISNULL(first_space_pos, 28)),
    LTRIM(NULLIF(SUBSTRING(col, ISNULL(first_space_pos, 29), 999), ''))
) AS x2 (col1, col23)
CROSS APPLY (
  SELECT
    NULLIF(30 - CHARINDEX(' ', REVERSE(LEFT(col23, 29))), 0)
) AS x3 (second_space_pos)
CROSS APPLY (
  SELECT
    LEFT(col23, ISNULL(second_space_pos, 28)),
    LTRIM(NULLIF(SUBSTRING(col23, ISNULL(second_space_pos, 29), 28), ''))
) AS x4 (col2, col3)
; 
```

第一个 CROSS APPLY 搜索大列前 29 个字符中的最后一个空格，第二个使用找到的位置生成第一个较小的列，`col1`并将字符串的其余部分返回为`col23`.

接下来的两个 CROSS APPLY 确实对 执行相同的操作`col23`，从而产生`col2`和`col3`。唯一的区别是，最后一个 CROSS APPLY 最多放入`col3`28 个字符，而不是所有剩余的字符。

`28`像,`29`和等硬编码值`30`可以参数化，但我会把这部分工作留给你。

[您可以在 SQL Fiddle](http://sqlfiddle.com/#!3/d41d8/2683)尝试此查询。

# shell - sudo 作为另一个用户，密码来自标准输入

> ID：11509010
> 
> 赞同：0
> 
> 时间：2012-07-16T17:00:01.663
> 
> 标签：shell, passwords, aix, sudo

我正在尝试使用`sudo`检查来查看用户的密码是否设置为标准密码。

我已阅读您可以使用该`-S`选项接收来自`stdin`

> -S -S (stdin) 选项使 sudo 从标准输入而不是终端设备读取密码。

但是当我跑步时`echo 'password' | sudo -S -u user command`

它返回：

```
Password:
Sorry, try again.
Password:
sudo: 1 incorrect password attempt 
```

有人可以告诉我这个脚本有什么问题吗？

**注意：**我尝试了其他方法来检查密码，但我很难找到解决方案，因为我没有：root 访问权限、ac 编译器或安装程序（如期望）的可用性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:40:24.250

您的密码是否以换行符结尾？尝试：

```
printf password 
```

或者

```
echo -n password 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T11:55:28.237

sudo 不需要指定用户的密码，而是调用“sudo”的用户的密码：

[http://en.wikipedia.org/wiki/Sudo](http://en.wikipedia.org/wiki/Sudo)

# c# - C# ASP.NET - 分层数组

> ID：11509022
> 
> 赞同：0
> 
> 时间：2012-07-16T17:00:36.117
> 
> 标签：c#, asp.net, arrays, hierarchical

我正在尝试在 foreach 循环中将数据存储在如下数组中：

> 名字，姓氏，出生日期

因此，一旦循环完成，我应该得到`{John,Smith,05/05/1980},{Mary,Smith,05/04/1980} etc...`这将使我能够访问存储在系统中的每个人的不同信息。

最好的方法是什么？我一直在阅读使用此处显示的分层数组[http://msdn.microsoft.com/en-us/library/ms486189(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/ms486189(v=office.12).aspx)但我不确定这是否是最好的方法。

我对 c# 编程很陌生，所以任何建议都将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:03:48.450

最好的方法是创建一个类来存储信息。

```
public class Person
{
    public string FirstName {get; set;}
    public string LastName {get; set;}
    public DateTime DateOfBirth {get; set;}
} 
```

然后创建一个 Person 对象列表。

```
List<Person> people = new List<Person>()
people.Add(new Person() { FirstName = "John", LastName = "Smith", DateOfBirth = new DateTime(1980, 5, 5) }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:04:12.343

也许使用这样的结构：

保存个人信息的类：

```
public class Person
{
 public string FirstName {get;set;}
 public string LastName {get;set;}
 public DateTime DateOfBirth {get;set;}
} 
```

人员名单：

```
List<Person> people = new List<Person>; 
```

# c# - 多层在 MVVM 模式中是如何工作的？

> ID：11509025
> 
> 赞同：0
> 
> 时间：2012-07-16T17:00:45.343
> 
> 标签：c#, wpf, mvvm

我正试图了解 MVVM。对于简单的列表-> 数据视图，这没问题。但我很难理解多层是如何工作的。我有点工作，但对于哪些位有效，哪些位无效，它非常受欢迎。例如，有些数据更新，有些则没有。任何应该影响上层列表的更深层次的东西有时会更新列表，有时不会。一定有一个模式，但我还没有发现它。有人知道任何教程不仅仅是列表->数据类型的视图吗？

例子：

```
List of widgets
+- Widget name
+- Widget description
+- List of Widget parts
   +- Part ID
   +- Colour 
```

在该示例中，我可以使用三列方法 - 左侧的小部件列表，中间的小部件信息（包括部件列表），然后是右侧的部件详细信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:31:15.783

您应该有多个 ViewModel，每个级别一个。然后你可以提供事件让上层更新变化。

例如，您可以有一个

```
public class WidgetListViewModel 
{
    public ObservableCollection<WidgetViewModel> Widgets {get; set; } 
}

public class WidgetViewModel
{
    public string WidgetName { get; set; }
    public string WidgetDescription { get; set; }
    public ObservableCollection<WidgetPartViewModel> Parts { get; set; }
}

public class WidgetPartViewModel
{
    public int PartId { get; set; }
    public System.Windows.Media.Color Color { get; set; }
} 
```

有事件（包括一个简单的模式）在此处描述[.Net 中的事件](http://msdn.microsoft.com/en-us/library/w369ty8x.aspx)

此外，我推荐观看这个关于 MVVM 的优秀视频教程： [Jason Dollinger on MVVM](http://blog.lab49.com/archives/2650)

该视频还涵盖了 Unity 的一些问题！（这对你来说可能很有价值）

他开发的源代码也可用： [Jason Dollinger 的 Lab49 Sourcecode](http://blog.lab49.com/archives/2689)

# android - 相对布局不起作用

> ID：11509027
> 
> 赞同：0
> 
> 时间：2012-07-16T17:00:56.043
> 
> 标签：android, android-relativelayout

我的`RelativeLayout`.

我将 6 个并排放置`Views`，它可以工作。

我遇到的问题是`EditTexts`. 当我将它们的宽度设置为`wrap_content`它们时，它们太小了。

当我将它们设置为它们时，`match_parent`它们会占据整个宽度（它们覆盖另一个）而不是调整到它们旁边`Views`的边缘。`Views`

所以我的问题是如何在不给它们静态宽度的情况下使它们适合？

这是我的代码：

```
<RelativeLayout
    android:id="@+id/relativelayout1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/tv1"
        android:layout_width="50dp"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:text="text 1" />

    <EditText
        android:id="@+id/et1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/tv1"
        android:singleLine="true" />

    <TextView
        android:id="@+id/tv2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/et1"
        android:text="text 2" />

    <EditText
        android:id="@+id/et2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/tv2"
        android:singleLine="true" />

    <TextView
        android:id="@+id/tv3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/et2"
        android:text="text 3" />

    <Spinner
        android:id="@+id/spinner1"
        android:layout_width="50dp"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_toRightOf="@+id/tv3" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:11:42.387

试试下面的代码。

如果您希望盒子的大小略有不同，则需要应用静态大小或稍微调整权重以获得所需的正确空间。

*但是，我建议实际上稍微改变一下布局。将它们全部放在同一条线上似乎有些混乱。除非这是横向模式。那么可能就没事了。*

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/relativelayout1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/tv1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="text 1" />

    <EditText
        android:id="@+id/et1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:singleLine="true" />

    <TextView
        android:id="@+id/tv2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="text 2" />

    <EditText
        android:id="@+id/et2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:singleLine="true" />

    <TextView
        android:id="@+id/tv3"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="text 3" />

    <Spinner
        android:id="@+id/spinner1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:layout_toRightOf="@+id/tv3" />

</LinearLayout> 
```

* * *

生成的布局图片：

![在此处输入图像描述](../Images/3172aafa397643252c53aec42d613046.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:22:47.070

使用相对布局，您需要令人满意的包装内容或静态尺寸。如果我理解得很好，您希望编辑文本填充屏幕宽度的剩余部分。您必须使用 LinearLayout 和`android:layout_weight`属性 -[您可以在此处找到示例](http://developer.android.com/guide/topics/ui/layout/linear.html)：

```
<LinearLayout
        android:id="@+id/ll"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation:"horizontal">
        <TextView
        android:layout_width="50dp"
        android:layout_height="wrap_content"
        android:text="text 1" />

        <EditText
        android:id="@+id/et1"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:singleLine="true"/>

        <EditText
        android:id="@+id/et2"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:singleLine="true" />

        <TextView
        android:id="@+id/tv3"
        android:layout_width="0dp"
        android:layout_weight="1"
        android:layout_height="wrap_content"
        android:text="text 3" />

        <Spinner
        android:id="@+id/spinner1"
        android:layout_width="50dp"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true" />

</LinearLayout> 
```

# svn - 有关 SVN 文件夹和良好存储库名称的问题

> ID：11509032
> 
> 赞同：1
> 
> 时间：2012-07-16T17:01:09.783
> 
> 标签：svn, repository-design, svn-repository

假设我想在本地机器上使用 SVN，我有点困惑应该如何配置 SVN 相关设置。它们如下：

1.  文件夹——主干、分支和标签——是默认创建的还是我们需要自己引入（比如在 UNIX 上使用 mkdir 命令）？
2.  `svn`将我们的存储库命名为或者可以是任何一个是一个好习惯吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:02:36.620

1）不，`trunk,branches,tags`目录不是自动的，甚至不是必需的。该特定目录层次结构只是一种常见做法，您必须自己通过`svn mkdir`. 如果你在一个带有 Bash shell 的 Unix 系统上，你可以一次性完成：

```
 svn mkdir file:///your/svn/repo/projectname/{trunk,tags,branches} 
```

2）您的存储库名称是完全任意的。随意命名。

# php - 缩短链接但仍然解决

> ID：11509033
> 
> 赞同：0
> 
> 时间：2012-07-16T17:01:12.277
> 
> 标签：php, apache, rewrite

我希望能够获取网址。

```
 www.domain.com/dash/photo/site%20-%20desc%20location 
```

并将其变成（并且仍然解决）。

```
 www.domain.com/dash/photo/site 
```

不确定这是否可以通过重写之类的方法实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:04:39.360

您正在寻找[mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)。 [这](http://www.addedbytes.com/for-beginners/url-rewriting-for-beginners/)是一个很好的重写 url 指南。

在你的 .htaccess 中试试这个：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !%20-desc%20location

RewriteRule ^/site$ /site%20-desc%20location [L] 
```

这是一个非常具体的重写规则，如果您有其他文件需要更改，则需要编写更复杂的正则表达式。

# c# - C#中的像素着色

> ID：11509034
> 
> 赞同：0
> 
> 时间：2012-07-16T17:01:15.423
> 
> 标签：c#, pixel-shader

我希望我的第一篇文章不会犯第一个错误。

我正在为几个图形效果和过滤器（例如 Sobel 或 Gauß mask）编写一个库。由于速度低，在 CPU 上执行此操作，我使用 Shazzam 工具编写了一些着色器。

我的具体问题是，我无法在 C# 中使用这个着色器。在互联网上，我只找到了如何将像素着色器作为 XAML 中的效果直接应用于元素的建议，这对我的应用程序不可用，因为这使得无法在一个图像上应用多个着色器，这是必需的，例如Canny 边缘检测器。

为了说明这个问题，一个小伪代码应该显示，我对该方法的期望。

```
PixelShader somePixelShader  = new PixelShader(pixelshader.ps);
somePixelShader.Input = Bitmap;
somePixelShader.Height = 200;
somePixelShader.Width = 800;

somePixelShader.Execute();
Bitmap = somePixelShader.Result; 
```

如您所见，一切都应该在 C# 中完成。

也许你可以帮我解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:39:36.720

[您可以使用RenderTargetBitmap](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.rendertargetbitmap.aspx)将当前效果输出复制为位图，然后将此输出的图像作为下一个效果的新输入提交，冲洗，重复。

**更新**：经过小型（且不确定）测试后，这将不起作用：[无法将像素着色器渲染到 RenderTargetBitmap！请帮忙！](https://stackoverflow.com/questions/3847097/cant-render-pixel-shader-to-rendertargetbitmap-please-help)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:41:23.743

查看[这些白皮书](https://skydrive.live.com/?cid=123ec1ed6c72a14a&id=123EC1ED6C72A14A!169)，了解有关如何在 WPF 或 SL 中编译和使用像素着色器的分步说明和示例。

您可能还想在[此处](http://wpffx.codeplex.com/)查看 WPF 像素着色器效果库。

# c# - 在c#中显示下载进度

> ID：11509041
> 
> 赞同：2
> 
> 时间：2012-07-16T17:01:36.857
> 
> 标签：c#, .net

我创建了这个程序，它向 twitter 发送一个 html 请求并将推文下载到数据库中。该程序在控制台中，使用 c# 编码。我不确定显示用户信息的下载进度。

示例：我正在为用户 alice 下载用户名、位置等并将其写入数据库

问题：我怎样才能向用户显示完成 10% 的进度，类似这样。

我的网络请求代码（小例子）如下：

```
WebClient wc = new WebClient();
string url = "https://api.twitter.com/1/users/lookup.json?screen_name=" +username; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T17:05:33.340

碰巧我写了一个自定义的 WebClient 子类，可以显示更新进度。它每 1MB 引发一个事件（因为这是我的需要，请参阅 参考资料`NotifyMegabyteIncrement`），但可以轻松修改。

```
public class MyWebClient : WebClient, IDisposable
{
    public int Timeout { get; set; }
    public int TimeUntilFirstByte { get; set; }
    public int TimeBetweenProgressChanges { get; set; }

    public long PreviousBytesReceived { get; private set; }
    public long BytesNotNotified { get; private set; }

    public string Error { get; private set; }
    public bool HasError { get { return Error != null; } }

    private bool firstByteReceived = false;
    private bool success = true;
    private bool cancelDueToError = false;

    private EventWaitHandle asyncWait = new ManualResetEvent(false);
    private Timer abortTimer = null;

    const long ONE_MB = 1024 * 1024;

    public delegate void PerMbHandler(long totalMb);

    public event PerMbHandler NotifyMegabyteIncrement;

    public MyWebClient(int timeout = 60000, int timeUntilFirstByte = 30000, int timeBetweenProgressChanges = 15000)
    {
        this.Timeout = timeout;
        this.TimeUntilFirstByte = timeUntilFirstByte;
        this.TimeBetweenProgressChanges = timeBetweenProgressChanges;

        this.DownloadFileCompleted += new System.ComponentModel.AsyncCompletedEventHandler(MyWebClient_DownloadFileCompleted);
        this.DownloadProgressChanged += new DownloadProgressChangedEventHandler(MyWebClient_DownloadProgressChanged);

        abortTimer = new Timer(AbortDownload, null, TimeUntilFirstByte, System.Threading.Timeout.Infinite);
    }

    protected void OnNotifyMegabyteIncrement(long totalMb)
    {
        if (NotifyMegabyteIncrement != null) NotifyMegabyteIncrement(totalMb);
    }

    void AbortDownload(object state)
    {
        cancelDueToError = true;
        this.CancelAsync();
        success = false;
        Error = firstByteReceived ? "Download aborted due to >" + TimeBetweenProgressChanges + "ms between progress change updates." : "No data was received in " + TimeUntilFirstByte + "ms";
        asyncWait.Set();
    }

    void MyWebClient_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)
    {
        if (cancelDueToError) return;

        long additionalBytesReceived = e.BytesReceived - PreviousBytesReceived;
        PreviousBytesReceived = e.BytesReceived;
        BytesNotNotified += additionalBytesReceived;

        if (BytesNotNotified > ONE_MB)
        {
            OnNotifyMegabyteIncrement(e.BytesReceived);
            BytesNotNotified = 0;
        }
        firstByteReceived = true;
        abortTimer.Change(TimeBetweenProgressChanges, System.Threading.Timeout.Infinite);
    }

    public bool DownloadFileWithEvents(string url, string outputPath)
    {
        asyncWait.Reset();
        Uri uri = new Uri(url);
        this.DownloadFileAsync(uri, outputPath);
        asyncWait.WaitOne();

        return success;
    }

    void MyWebClient_DownloadFileCompleted(object sender, System.ComponentModel.AsyncCompletedEventArgs e)
    {
        if (cancelDueToError) return;
        asyncWait.Set();
    }

    protected override WebRequest GetWebRequest(Uri address)
    {            
        var result = base.GetWebRequest(address);
        result.Timeout = this.Timeout;
        return result;
    }

    void IDisposable.Dispose()
    {
        if (asyncWait != null) asyncWait.Dispose();
        if (abortTimer != null) abortTimer.Dispose();

        base.Dispose();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T17:21:39.770

```
private WebClient mWebClient = new WebClient();
//...
mWebClient.DownloadProgressChanged += (sender, e) =>  progressPercentageChanged(e.ProgressPercentage); //your method to display the percentage
mWebClient.DownloadFileCompleted += (sender, e) => yourMethodToProcessTheFile();
mWebClient.DownloadFileAsync(uri, fileNameOnDisk);
//you need to keep the instance of webclient, so it does not get garbage collected 
```

# xml - 不能包含 xml 架构

> ID：11509044
> 
> 赞同：0
> 
> 时间：2012-07-16T17:01:59.007
> 
> 标签：xml, xsd

我有以下xml：

```
<xs:schema attributeFormDefault="unqualified" 
           elementFormDefault="qualified"
           xmlns="http://www.testuri.org" 
           targetNamespace="http://www.testuri.org" 
           xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:element name="Price">
    <xs:complexType>
    <xs:sequence>
        <xs:element name="Value" type="xs:double" />
        <xs:element name="Currency" type="cs:string" />
    </xs:sequence>
  </xs:complexType>
 </xs:element>
</xs:schema> 
```

我想在另一个 xml 文件中使用它作为包含；我声明

```
<xs:include schemaLocation="Price.xsd"/> 
```

但我看到一个错误“在您的文档中从此位置引用的架构包含错误”。当我查看上面的架构时，我没有看到任何错误。为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:03:33.673

有一个`</xs:simpleType>`没有相应的开始标签的结束。

编辑：删除后，我进一步阅读并发现`<xs:element name="Currency" type="cs:string" />`可能应该阅读`<xs:element name="Currency" type="xs:string" />`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T05:26:27.507

相反元素应该有类型，如果我仍然需要元素，我应该使用

```
<xs:element name="Price" type="Price"/> 
```

在同一个文件中。

# xcode - 在 Xcode 中，如何让一个按钮将图像更改为一个 UIImageView 中的不同图像？

> ID：11509047
> 
> 赞同：1
> 
> 时间：2012-07-16T17:02:00.847
> 
> 标签：xcode, button, uiimageview

我查看了谷歌和堆栈流，虽然我发现了类似的响应，但在我开始寻找解决这个问题的方法之前，我仍然没有更聪明。

我有一个按钮，每次按下我都希望它显示下一张图像。

我相信我必须设置我项目中所有图像的数组来执行此操作，然后可能类似于按钮的计数器，以便它知道要在 UIImageView 中显示哪个图像。

所以项目是这样的：

1 个视图控制器，带有 1 个 UIImageView、1 个按钮和 5 个图像。

UIImageView 占据整个屏幕，图像 1 显示在 UIImageView 中，按下按钮，显示图像 2，再次按下按钮显示图像 3，依此类推，直到你到达图像 5，一次在图像 5，如果你再次按下按钮，它将回到起点（图 1）。

我很新，我想要一些示例代码来帮助，不是复制和粘贴，而是研究它是如何工作的，以及我如何在我的应用程序中实现类似的。

我希望这是有道理的。我还没有使用术语，所以白痴证明建议会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:33:36.563

好的，我在这里为您准备了一些示例

在 .h 中定义

```
UIButton *b;
UIImageView *i;
NSArray *a;
int count; 
```

并将这些写在 .m

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    b = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    b.frame = CGRectMake(0, 0, 100 ,100);
    [b addTarget:self action:@selector(changeImage) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:b];

    i = [[UIImageView alloc]initWithFrame:CGRectMake(0, 100, 100, 100)];
    [self.view addSubview:i];

    a = [NSArray array];
    //init array with images what you have

    count = 0;
    [i setImage:[a objectAtIndex:count]];
}

-(void) changeImage{
    count = ++count%5;
    [i setImage:[a objectAtIndex:count]];
} 
```

不要遵循我的命名约定，这是一个例子。你应该好好写出来。一旦您放入图像，这应该可以工作。如果您有任何问题，请告诉我，但请在询问任何内容之前先进行谷歌搜索。

# r - R：绘制 ARC/INFO 生成文件

> ID：11509049
> 
> 赞同：1
> 
> 时间：2012-07-16T17:02:15.700
> 
> 标签：r, io, ggplot2, polygon

我有一个 ARC/INFO 生成文件，其内容如下所示：

```
3594 -124.049541 44.429077
 -123.381222 44.530192
 -123.479913 44.625517
 -123.578917 44.720704
 -123.678234 44.815755
 -123.777866 44.910669
 -123.946044 44.885032
 -124.114074 44.858987
 -124.281949 44.832529
 -124.449663 44.805654
 -124.516511 44.684660
 -124.583091 44.563597
 -124.649404 44.442465
 -124.715451 44.321261
 -124.615376 44.227772
 -124.515601 44.134147
 -124.416125 44.040385
 -124.316948 43.946486
 -124.151513 43.973082
 -123.985926 43.999247
 -123.820193 44.024987
 -123.654322 44.050307
 -123.586447 44.170362
 -123.518307 44.290360
 -123.449899 44.410303
 -123.381222 44.530192
END
3595 -123.103772 45.009223
 -122.427717 45.101578
 -122.525757 45.198252
 -122.624122 45.294789
 -122.722814 45.391191
 -122.821833 45.487459
 -122.992014 45.464007
 -123.162072 45.440175
 -123.332002 45.415959
 -123.501798 45.391355
 -123.571234 45.271264
 -123.640389 45.151121
 -123.709266 45.030923
 -123.777866 44.910669
 -123.678234 44.815755
 -123.578917 44.720704
 -123.479913 44.625517
 -123.381222 44.530192
 -123.213811 44.554460
 -123.046278 44.578334
 -122.878629 44.601816
 -122.710869 44.624913
 -122.640504 44.744148
 -122.569859 44.863337
 -122.498931 44.982480
 -122.427717 45.101578
END
3676 -122.989567 44.147495
 -122.323040 44.238368
 -122.419523 44.335217
 -122.516322 44.431923
 -122.613437 44.528488
 -122.710869 44.624913
 -122.878629 44.601816
 -123.046278 44.578334
 -123.213811 44.554460
 -123.381222 44.530192
 -123.449899 44.410303
 -123.518307 44.290360
 -123.586447 44.170362
 -123.654322 44.050307
 -123.556277 43.955264
 -123.458534 43.860080
 -123.361093 43.764751
 -123.263953 43.669279
 -123.098838 43.693189
 -122.933613 43.716694
 -122.768285 43.739802
 -122.602857 43.762515
 -122.533309 43.881546
 -122.463492 44.000532
 -122.393403 44.119472
 -122.323040 44.238368
END
END 
```

我的策略是读取文件，生成经纬度点列表，并在每次遇到 END 时开始一个新的唯一组 ID。然后我将使用`ggplot" and`geom_polygon" 进行绘图。

唉，我不确定如何有效地完成文件的读取。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:59:13.050

读取 CRAN 上的空间任务视图，然后使用 rgdal 包中的 readOGR 读入 sp 类对象。您需要安装带有 ARCGEN 格式支持的 GDAL/OGR，尽管它被列为“默认编译” [http://www.gdal.org/ogr/ogr_formats.html](http://www.gdal.org/ogr/ogr_formats.html)我的系统上没有。

否则，将文件作为连接打开，读取每一行，构建一个多边形，然后是多边形和空间多边形。

这是一个相当次优但有效的功能：

```
readUng <- function(f){
  require(sp)
  stream = file(f,"r")
  first = readLines(stream,1)
  bits = strsplit(first," ")[[1]]
  polys = list();ids=NULL
  while(TRUE){
    id=bits[1] # label pt = bits[2],bits[3]
    ids=c(ids,id)
    coords=NULL
    while(TRUE){
      xy=readLines(stream,1)
      if(xy=="END"){
        break
      }
      coords=rbind(coords,strsplit(xy," ")[[1]])      
    }

    polys[[length(polys)+1]] = Polygons(list(Polygon(matrix(as.numeric(coords[,2:3]),ncol=2))),ID=id)
    lines = readLines(stream,1)
    if(lines == "END"){
      break
    }
    bits = strsplit(lines," ")[[1]]
  }
  return(SpatialPolygons(polys))
} 
```

现在它是一个合适的空间数据对象，你也可以给它一个坐标系（在我看来像 lat-long，所以 epsg:4326，但只有你知道）。现在您可以修改所有这些以生成 ggplot 想要的任何内容，但如果它的空间数据，那么您应该将其保留为空间数据类，并且 ggplot 应该能够处理此类。

# javascript - javascript计时器不起作用

> ID：11509050
> 
> 赞同：-2
> 
> 时间：2012-07-16T17:02:16.340
> 
> 标签：javascript, jquery, timer

我花了几个小时试图了解为什么我的 javascript 计时器不适用于[http://www.filmas-online.lv/o-winnie-the-pooh-2011-dvdrip](http://www.filmas-online.lv/o-winnie-the-pooh-2011-dvdrip)这部电影以及为什么它适用于这部电影[http://www.filmas-online.lv/o-vinnijs-puks-winnie-the-pooh-2011-dvdrip](http://www.filmas-online.lv/o-vinnijs-puks-winnie-the-pooh-2011-dvdrip)。

它们在代码中似乎相同，还是我遗漏了什么？

PS 计时器在黑色背景的右上角，起初它显示 Ielāde（表示加载），然后从 5 开始倒计时到零。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:26:23.397

您是否检查了浏览器的错误日志？Opera 揭示了错误：

```
Syntax error at line 203 while loading: in string literal: invalid line terminator.
ip&rek=1'>Turpināt uz 
--------------------^ 
```

更改以下行：

```
$('.aizvert_rek').html("<div class=white><a href='o-winnie-the-pooh-2011-dvdrip&rek=1'>Turpināt uz 
Winnie the Pooh 
 (2011) DVDRip</a></div>"); 
```

至：

```
$('.aizvert_rek').html("<div class=white><a href='o-winnie-the-pooh-2011-dvdrip&rek=1'>Turpināt uz Winnie the Pooh (2011) DVDRip</a></div>"); 
```

或者：

```
$('.aizvert_rek').html("<div class=white><a href='o-winnie-the-pooh-2011-dvdrip&rek=1'>Turpināt uz /
Winnie the Pooh /
 (2011) DVDRip</a></div>"); 
```

那应该可以解决您的问题。

# objective-c - 按钮不能前进到另一个视图，如果

> ID：11509051
> 
> 赞同：1
> 
> 时间：2012-07-16T17:02:22.647
> 
> 标签：objective-c, xcode

我希望当用户在文本字段中输入一个数字时，这个数字将用于大量操作，但这个数字不能为 0，我创建了一条错误消息，如果用户点击“下一步”按钮，将显示该消息文本字段上的 0，但此消息没有时间出现，因为此按钮将用户带到另一个视图，我如何告诉按钮保持在该视图中，直到数字正常？我的按钮实现：

```
- (IBAction)calc:(id)sender {  

    int mynumber;
    mynumber = [textfieldnumber.text intValue];

    if (mynumber==0) {

        NSString *errorstr = [[NSString alloc] initWithFormat:@"Please, set the number of people..."];
        labelerror.text = errorstr;

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:20:20.437

从情节提要中删除 Segue。然后创建一个从文件所有者或所选视图底部的黄色小框到新的 modalViewController 的新文件。设置它的标识符并记住它。然后改变这个：

```
- (IBAction)calc:(id)sender {  

int mynumber;
mynumber = [textfieldnumber.text intValue];

if (mynumber==0) {

    NSString *errorstr = [[NSString alloc] initWithFormat:@"Please, set the number of people..."];
    labelerror.text = errorstr;

}

} 
```

对此：

```
- (IBAction)calc:(id)sender {  

int mynumber;
mynumber = [textfieldnumber.text intValue];

if (mynumber==0) {

    NSString *errorstr = [[NSString alloc] initWithFormat:@"Please, set the number of people..."];
    labelerror.text = errorstr;

}else{
    [self performSegueWithIdentifier:identifies sender:self];

}

} 
```

或者

```
- (IBAction)calc:(id)sender {  

int mynumber;
mynumber = [textfieldnumber.text intValue];

if (mynumber==0) {

    NSString *errorstr = [[NSString alloc] initWithFormat:@"Please, set the number of people..."];
    labelerror.text = errorstr;

}else{
    [self presentModalViewController:viewController animated:YES];
}

} 
```

# sql-server-2008 - SQL Server 存储过程合并命令给出无效的对象名称消息

> ID：11509052
> 
> 赞同：1
> 
> 时间：2012-07-16T17:02:24.077
> 
> 标签：sql-server-2008, stored-procedures, merge

我正在编写一个存储过程，它合并来自两个数据库的具有相同架构的两个表。我搜索了答案并认为这可能是权限问题，但我无法解决问题。

这是错误消息：

> 消息 208，级别 16，状态 1，过程 spMergeDefects，第 66 行
> 无效的对象名称

这是存储过程代码：

```
DECLARE @MergeOutput TABLE
(
ActionType  nvarchar(10),
del_guidDefectID    uniqueidentifier,
del_idintDefectID   int,
del_fkintStructureID    int,
del_fkintDefectTypeID   int,
del_tinSeverityCode tinyint,
del_intCreatedBy    int,
del_dtmDateInspected    datetime,
del_bitRepaired bit,
del_dtmRepaired datetime,
del_intRepairedBy   int,
del_tintDefectStatus    tinyint,
del_strRepairWorkOrder  varchar(20),
del_bitTempRepaired bit,
del_dtmTempRepaired datetime,
del_intModifiedBy   int,
del_dtmModified datetime,   
del_bitCircuitSpecific  bit,
del_strCircuit  varchar(20),
del_strUser1    varchar(50),
del_strUser2    varchar(50),
del_intNADefectLodID    int,
del_fkstrInspectionCycleID  varchar(10),
del_strNote varchar(255),
del_SpanDirection   varchar(10),
del_Distance    int,
del_Deleted bit,
ins_guidDefectID    uniqueidentifier,
ins_idintDefectID   int,
ins_fkintStructureID    int,
ins_fkintDefectTypeID   int,
ins_tinSeverityCode tinyint,
ins_intCreatedBy    int,
ins_dtmDateInspected    datetime,
ins_bitRepaired bit,
ins_dtmRepaired datetime,
ins_intRepairedBy   int,
ins_tintDefectStatus    tinyint,
ins_strRepairWorkOrder  varchar(20),
ins_bitTempRepaired bit,
ins_dtmTempRepaired datetime,
ins_intModifiedBy   int,
ins_dtmModified datetime,   
ins_bitCircuitSpecific  bit,
ins_strCircuit  varchar(20),
ins_strUser1    varchar(50),
ins_strUser2    varchar(50),
ins_intNADefectLodID    int,
ins_fkstrInspectionCycleID  varchar(10),
ins_strNote varchar(255),
ins_SpanDirection   varchar(10),
ins_Distance    int,
ins_Deleted bit 
```

);

```
MERGE [tblMM-Defects] AS tgt
USING dbo.NGFIElecMobile.[tblMM-Defects] AS src
ON tgt.guidDefectID = src.guidDefectID
WHEN MATCHED THEN
    UPDATE SET 
    tgt.fkintStructureID = src.fkintStructureID,
    tgt.fkintDefectTypeID = src.fkintDefectTypeID,
    tgt.tinSeverityCode = src.tinSeverityCode,
    tgt.intCreatedBy = src.intCreatedBy,
    tgt.dtmDateInspected = src.dtmDateInspected,
    tgt.bitRepaired = src.bitRepaired,
    tgt.dtmRepaired = src.dtmRepaired,
    tgt.intRepairedBy = src.intRepairedBy,
    tgt.tintDefectStatus = src.tintDefectStatus,
    tgt.strRepairWorkOrder = src.strRepairWorkOrder,
    tgt.bitTempRepaired = src.bitTempRepaired,
    tgt.intModifiedBy = src.intModifiedBy,
    tgt.dtmModified = src.dtmModified,
    tgt.bitCircuitSpecific = src.bitCircuitSpecific,
    tgt.strCircuit = src.strCircuit,
    tgt.strUser1 = src.strUser1,
    tgt.strUser2 = src.strUser2,
    tgt.fkstrInspectionCycleID = src.fkstrInspectionCycleID,
    tgt.strNote = src.strNote,
    tgt.SpanDirection = src.SpanDirection,
    tgt.Distance = src.Distance

WHEN NOT MATCHED BY TARGET THEN
    INSERT 
    (fkintStructureID,
    fkintDefectTypeID,
    tinSeverityCode,
    intCreatedBy,
    dtmDateInspected,
    bitRepaired,
    dtmRepaired,
    intRepairedBy,
    tintDefectStatus,
    strRepairWorkOrder,
    bitTempRepaired,
    intModifiedBy,
    dtmModified,
    bitCircuitSpecific,
    strCircuit,
    strUser1,
    strUser2,
    fkstrInspectionCycleID,
    strNote,
    SpanDirection,
    Distance)

    VALUES
    (src.fkintStructureID,
    src.fkintDefectTypeID,
    src.tinSeverityCode,
    src.intCreatedBy,
    src.dtmDateInspected,
    src.bitRepaired,
    src.dtmRepaired,
    src.intRepairedBy,
    src.tintDefectStatus,
    src.strRepairWorkOrder,
    src.bitTempRepaired,
    src.intModifiedBy,
    src.dtmModified,
    src.bitCircuitSpecific,
    src.strCircuit,
    src.strUser1,
    src.strUser2,
    src.fkstrInspectionCycleID,
    src.strNote,
    src.SpanDirection,
    src.Distance
    )

    WHEN NOT MATCHED BY SOURCE 
        AND tgt.CheckedOutForInsp = 1 AND CheckOutID = @CheckOutID THEN
    DELETE

    OUTPUT
    $action,
    DELETED.guidDefectID,       
    DELETED.idDefectID, 
    DELETED.fkStructureID,
    DELETED.fkDefectTypeID,     
    DELETED.tinSeverityCode,        
    DELETED.CreatedBy,
    DELETED.dtmDateInspected,
    DELETED.bitRepaired,
    DELETED.dtmRepaired,    
    DELETED.RepairedBy, 
    DELETED.tDefectStatus,
    DELETED.strRepairWorkOrder,
    DELETED.bitTempRepaired,    
    DELETED.dtmTempRepaired,    
    DELETED.ModifiedBy,
    DELETED.dtmModified,        
    DELETED.bitCircuitSpecific,
    DELETED.strCircuit,
    DELETED.strUser1,
    DELETED.strUser2,
    DELETED.NADefectLodID,
    DELETED.fkstrInspectionCycleID,
    DELETED.strNote,    
    DELETED.SpanDirection,
    DELETED.Distance,
    DELETED.[Deleted],
    INSERTED.guidDefectID,      
    INSERTED.idDefectID,    
    INSERTED.fkStructureID,
    INSERTED.fkDefectTypeID,        
    INSERTED.tinSeverityCode,       
    INSERTED.CreatedBy,
    INSERTED.dtmDateInspected,
    INSERTED.bitRepaired,
    INSERTED.dtmRepaired,   
    INSERTED.RepairedBy,    
    INSERTED.tDefectStatus,
    INSERTED.strRepairWorkOrder,
    INSERTED.bitTempRepaired,   
    INSERTED.dtmTempRepaired,   
    INSERTED.ModifiedBy,
    INSERTED.dtmModified,       
    INSERTED.bitCircuitSpecific,
    INSERTED.strCircuit,
    INSERTED.strUser1,
    INSERTED.strUser2,
    INSERTED.NADefectLodID,
    INSERTED.fkstrInspectionCycleID,
    INSERTED.strNote,   
    INSERTED.SpanDirection,
    INSERTED.Distance,
    INSERTED.[Deleted]
    INTO @MergeOutput
    ; 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:15:25.003

我猜你的`USING dbo.NGFIElecMobile.[tblMM-Defects] AS src`台词应该是`USING NGFIElecMobile.dbo.[tblMM-Defects] AS src`

之后可能还有其他问题。

以下是 T-SQL 中正确多部分命名的一些指南： [Transact-SQL 语法约定](http://msdn.microsoft.com/en-us/library/ms177563.aspx)

# .net - 将 http 标头添加到服务引用服务方法

> ID：11509053
> 
> 赞同：5
> 
> 时间：2012-07-16T17:02:24.680
> 
> 标签：.net, http-headers, service-reference

我从 WSDL 生成了一个服务引用。我已经成功地针对服务参考对客户端进行了编码。我一直在使用 serviceRef.serviceMethod(params...) 模式来调用基于服务的方法。现在我需要将 http 标头添加到我发送的消息中。我找不到在哪里将它们设置为服务的所有消息的默认值，也找不到在调用某些方法时可以在哪里设置它们。有些文章建议我可以使用 IClientMessageInspector，但实现似乎很复杂。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:25:59.130

从很多地方借来的，但主要是：

[http://msmvps.com/blogs/paulomorgado/archive/2007/04/27/wcf-building-an-http-user-agent-message-inspector.aspx](http://msmvps.com/blogs/paulomorgado/archive/2007/04/27/wcf-building-an-http-user-agent-message-inspector.aspx)

我简化了，但我认为我有一个可以添加自定义 httpheaders 的实现。

```
 public class HttpHeaderMessageInspector : IClientMessageInspector
    {
        private readonly Dictionary<string, string> _httpHeaders;

        public HttpHeaderMessageInspector(Dictionary<string, string> httpHeaders)
        {
            this._httpHeaders = httpHeaders;
        }

        public void AfterReceiveReply(ref Message reply, object correlationState) { }

        public object BeforeSendRequest(ref Message request, IClientChannel channel)
        {
            HttpRequestMessageProperty httpRequestMessage;
            object httpRequestMessageObject;

            if (request.Properties.TryGetValue(HttpRequestMessageProperty.Name, out httpRequestMessageObject))
            {
                httpRequestMessage = httpRequestMessageObject as HttpRequestMessageProperty;

                foreach (var httpHeader in _httpHeaders)
                {
                    httpRequestMessage.Headers[httpHeader.Key] = httpHeader.Value;
                }
            }
            else
            {
                httpRequestMessage = new HttpRequestMessageProperty();

                foreach (var httpHeader in _httpHeaders)
                {
                    httpRequestMessage.Headers.Add(httpHeader.Key, httpHeader.Value);
                }
                request.Properties.Add(HttpRequestMessageProperty.Name, httpRequestMessage);
            }
            return null;
        }
    }

internal class HttpHeadersEndpointBehavior : IEndpointBehavior
    {
        private readonly Dictionary<string,string> _httpHeaders;

        public HttpHeadersEndpointBehavior(Dictionary<string, string> httpHeaders)
        {
            this._httpHeaders = httpHeaders;
        }
        public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters) { }

        public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
        {
            var inspector = new HttpHeaderMessageInspector(this._httpHeaders);

            clientRuntime.MessageInspectors.Add(inspector);
        }

        public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher) { }
        public void Validate(ServiceEndpoint endpoint) { }
    } 
```

然后在更新我的服务参考后：

```
 var httpHeaders = new Dictionary<string, string>();
    httpHeaders.Add("header1", "value1");
    httpHeaders.Add("header2", "value2");

    _serviceRef.Endpoint.Behaviors.Add(new HttpHeadersEndpointBehavior(httpHeaders)); 
```

没有其他东西需要改变。如果您想到更简单的方法，请告诉我。

# android - 使用PhoneGap的实用性是什么？

> ID：11509059
> 
> 赞同：9
> 
> 时间：2012-07-16T17:02:40.407
> 
> 标签：android, ios, html, cordova

我目前正在使用 PhoneGap 进行一些研究，而不是为所有平台编写不同的代码。在我看来，马上，一个缺点是，事实上，你不是在本地编写你的应用程序。我问自己，这是什么意思？

1.  会不会影响性能？
2.  PhoneGap 是否为所有本机功能提供包装器？文档是否足以通过？
3.  您想要或需要什么样的 UI（即 JQuery），它们是否有适当的文档？这些框架是否可以跨不同平台无缝工作？
4.  由于 Adob​​e 现在处于混合状态，PhoneGap 最终会过时吗？从长远来看，它真的不重要吗？

我想听听那些尝试过 PhoneGap 的人的任何反馈/建议/建议。另外，如果有PhoneGap不提供的功能列表，有人可以提供链接吗？

**编辑：我应该指出，我意识到使用 PhoneGap 的一大动机是让一个人不需要学习多种编程语言。我已经知道 Objective-C 和 Java，我只是在探索 PhoneGap 的潜在用途——所以我从一个稍微不同的角度来讨论这个问题。我在下面的评论之一中提到了这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:41:07.243

**简短而客观的回答：**视情况而定。

具体来说，PhoneGap/Cordova 是否适合您的项目取决于您的需求。有很多基于 PhoneGap 的项目，所以它显然对*一些开发者*有用；只有您可以说您是否可能属于该组。

**更多细节：**

> 会不会影响性能？

是的。这是否重要取决于您的应用程序。

> PhoneGap 是否为所有本机功能提供包装器？文档是否足以通过？

第一个问题没有，但它是可扩展的，因此如果需要，您可以随时添加自己的本机代码。只有您可以说文档是否足够，但如果您需要/想要，您可以随时查看代码。

> 您想要或需要什么样的 UI（即 JQuery），它们是否有适当的文档？这些框架是否可以跨不同平台无缝工作？

这似乎取决于你在做什么以及你已经知道什么。PhoneGap 在这里并没有太大的不同。

> 由于 Adob​​e 现在处于混合状态，PhoneGap 最终会过时吗？从长远来看，它真的不重要吗？

[Cordova](http://incubator.apache.org/cordova/) （以前称为“PhoneGap”的开源软件）能否生存和发展取决于许多因素：

*   人们在使用它吗？

*   使用它的人是否为它做出了贡献？

*   Adobe 将决定如何使用 PhoneGap（专有版本）？他们会杀了它吗？增强它？添加如此引人注目的功能以至于大多数人选择它而不是 Cordova？

如果 Cordova 对您的应用程序有意义，请务必使用它。如果可以的话，为它做出贡献，它将对你和世界其他地方变得更加有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:20:37.660

对于简单的应用程序，PG 不会对性能造成影响。

PG 有很多但不是全部的原生函数。你总是可以写一个插件，但真的谁愿意呢？

PG 最终可能会消失，但可能要等到您的应用程序消失之后。

# c# - 为什么这个控件不将结果保存回数据库？

> ID：11509060
> 
> 赞同：1
> 
> 时间：2012-07-16T17:02:43.947
> 
> 标签：c#, winforms, visual-studio-2010, sql-server-ce

这是*子*窗体：

![在此处输入图像描述](../Images/8142998e141b962fa044c981f3d028b5.png)

这是它背后的代码：

```
public partial class uxFormDatabase : Form 
{ 

BindingSource rawtableBindingSource = null; 

public uxFormDatabase(BindingSource myPassedSource)  
{ 
    InitializeComponent(); 
    rawtableBindingSource = myPassedSource; 

    uxDGVtable.AutoSize = true; 
    dataToDGV(); 
} 

public void dataToDGV() 
{ 
    uxrawdataBindingNavigator.BindingSource = this.rawtableBindingSource; 
    uxDGVtable.DataSource = this.rawtableBindingSource; 
} 

private void saveToolStripButton_Click(object sender, EventArgs e) 
{ 
    Validate(); 
    rawtableBindingSource.EndEdit(); 
} 

} 
```

我的印象是，当`uxFormDatabase`被激活时`public uxFormDatabase(BindingSource myPassedSource)`，会触发从父表单传递 BindingSource 的方法；

如果是这种情况，那么为什么当我按下 BindingNavigator 上的保存按钮“saveToolStripButton_Click”时，更改没有保存回数据库？这两行不会将更改保存回数据库`Validate();rawtableBindingSource.EndEdit();`吗？

**更新**

上面的表单是从这个*父*表单加载的：

```
namespace WindFormAppRevisionHelper
{

    public partial class uxRevisionHelperForm : Form
    {

        public SqlCeConnection conn = null;
        public SqlCeDataAdapter da = null;
        public DataSet ds = null;
        BindingSource definitionsBindingSource = new BindingSource();

    public uxRevisionHelperForm()
    {
        InitializeComponent();
        uxDescriptionTextBox.AutoSize = true;
        refreshBindingSource();
        assignControlsToSource();
    }

    public void refreshBindingSource()
    {            
        conn = new SqlCeConnection(ConfigurationManager.ConnectionStrings["WindFormAppRevisionHelper.Properties.Settings.DefinitionsDBConnectionString"].ConnectionString);
        da = new SqlCeDataAdapter(new SqlCeCommand("Select * From tb_RevisionDefinitions",conn));
        ds = new DataSet("Study Helper");
        ds.Tables.Add("DefinitionsTable");
        da.Fill(ds.Tables["DefinitionsTable"]);

        // Assign the BindingSource.
        definitionsBindingSource.DataSource = ds.Tables["DefinitionsTable"];
        uxBindingNavigator.BindingSource = this.definitionsBindingSource;

    }
    void assignControlsToSource() 
    {
        uxDescriptionTextBox.DataBindings.Add(new Binding("Text", definitionsBindingSource, "Description", true));
        uxWordPhraseTextBox.DataBindings.Add(new Binding("Text", definitionsBindingSource, "WordPhrase", true));
        uxReferenceTextBox.DataBindings.Add(new Binding("Text", definitionsBindingSource, "Reference", true));
    }

    private void uxUpdateDataButton_Click(object sender, EventArgs e)   
    {
        uxRevisionHelperGroupBox.Enabled = false;
        uxBindingNavigator.Hide();
        uxFormDatabase myNewDisplay = new uxFormDatabase(definitionsBindingSource);//<<<<this loads the _child_ form
        myNewDisplay.FormClosed += delegate { activateGroupBorder(); };
        myNewDisplay.Show();    
    }

    public void activateGroupBorder() 
    {
        uxRevisionHelperGroupBox.Enabled = true;
        uxBindingNavigator.Show();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:32:02.043

如果您查看[此示例](http://msdn.microsoft.com/en-us/library/fbk67b6z.aspx)，您可以看到，用于准备绑定源的 SqlDataAdapter 对象负责数据库更新。

我认为你可以传递给你的构造函数`uxFormDatabase`，`SqlCeDataAdapter da`将它保存在你的全局实例变量中`uxFormDatabase`，然后在`Validate`and之后`EndEdit`调用`da.Update((DataTable)rawtableBindingSource.DataSource);`

使用的代码：

```
 private void saveToolStripButton_Click(object sender, EventArgs e)
    {
        Validate();
        rawtableBindingSource.EndEdit();
        SqlCeCommandBuilder cmdBuilder = new SqlCeCommandBuilder(rawtableDA);
        rawtableDA.Update((DataTable)rawtableBindingSource.DataSource);
        cmdBuilder = null;
    } 
```

# .net - .NET 4.0 NGEN x64 程序集上的符号解析不起作用

> ID：11509067
> 
> 赞同：1
> 
> 时间：2012-07-16T17:03:13.317
> 
> 标签：.net, debugging, ngen, xperf

我在 x64 NGEN .NET 4.0 程序集上的符号解析不起作用。

细节：

我有一个 .NET 4.0 命令行程序集，我正在使用带有 x64 配置的 Visual Studio 进行编译。编译后，我在上面运行 NGEN（64 位版本）。

XPERF 分析无法解析我的符号的调用堆栈（使用 -stackwalk 配置文件）失败。我现在正在从这里尝试 Perfmonitor：http: [//bcl.codeplex.com/releases/view/42784](http://bcl.codeplex.com/releases/view/42784)

我已经完成了这些步骤，并且希望调用堆栈能够解决：

*   启动 NGEN 的 x64 应用程序
*   性能监控收集
*   性能监视器合并
*   性能监控分析

...不幸的是，堆栈跟踪在 PerfMonitor 中也不起作用。

我还尝试将应用程序作为 32 位运行——同样的问题。我的符号使用 symchk /v 检查得很好

我不知道如何调试这个损坏的堆栈跟踪功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:09:24.270

不确定我是否理解正确，但您需要生成可分析的 NGEN“程序集”。

爱荷华州：`ngen install ass.dll /profile`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T14:39:25.037

您需要来自 Windows 8 SDK 的 xperf 版本。此版本支持 .net。使用新的 Performance Recorder UI 开始跟踪，此工具会为生成的 .net 组件生成 PDB，以便 xperfview 和 WPA 可以解码调用堆栈。

# c# - 转换为 12 小时格式

> ID：11509068
> 
> 赞同：2
> 
> 时间：2012-07-16T17:03:14.010
> 
> 标签：c#, vb.net

我在 UI 上有以下字段：日期选择器、小时下拉列表、分钟下拉列表和上午/下午下拉列表。

在我的控制器中，我试图将这些字段联系在一起并创建一个这样的 DateTime 值（5/18/2012 2:45 PM）：

```
model.Scheduled = new DateTime(model.Scheduled.Value.Year, model.Scheduled.Value.Month, model.Scheduled.Value.Day, model.ScheduledHour + (model.ScheduledAMPM == "AM" ? 0 : 12), model.ScheduledMinute, 0); 
```

这在大多数情况下都有效，但当我在小时下拉列表中选择 12 时无效。我应该如何重构上面的代码行以使其在所有情况下都有效？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:08:12.730

通过取 Hour 模 12 将 12 AM 和 12 PM 转换为 0 和 12：

```
(model.ScheduledHour % 12) + (model.ScheduledAMPM == "AM" ? 0 : 12) 
```

我还建议编写单元测试来验证所有边缘情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:23:20.907

您可以利用方法`DateTime. TryParse(string input, out DateTime output)`方法让 C# 为您进行翻译。

[http://msdn.microsoft.com/en-cus/library/ch92fbc1.aspx](http://msdn.microsoft.com/en-cus/library/ch92fbc1.aspx)

# c++ - CMakeLists.txt 更改后，CMake 忘记了 pthreads

> ID：11509070
> 
> 赞同：0
> 
> 时间：2012-07-16T17:03:20.843
> 
> 标签：c++, boost, pthreads, cmake

我对 CMake 和 Boost 有一个奇怪的问题。

我设置了一个静态库项目，以便库的每个部分最终成为一个单独的静态库。它们以一种智能的方式相互依赖，一切都在第一次编译和完美运行。

下面是最终的链接命令：

```
/usr/bin/c++   -O3 -DNDEBUG    CMakeFiles/apollo.dir/main.cpp.o  -o apollo -rdynamic ../../libapollo/io/libio.a ../../libapollo/theoretical/libtheoretical.a -lboost_system-mt -lboost_filesystem-mt -lboost_thread-mt -lpthread -lz -lboost_filesystem-mt ../../libapollo/core/libcore.a ../../libapollo/src/liblibapollo.a -lboost_system-mt -lboost_thread-mt 
```

但是，如果我更改库中的 CMakeLists.txt 文件之一（例如添加新的 .cpp，甚至只是重新保存 CMakeLists.txt），再次运行 make 时，依赖于库的最终可执行文件将失败在最后的链接中。

以下是失败的链接命令：

```
/usr/bin/c++   -O3 -DNDEBUG    CMakeFiles/apollo.dir/main.cpp.o  -o apollo -rdynamic ../../libapollo/io/libio.a ../../libapollo/theoretical/libtheoretical.a -lboost_system-mt -lboost_filesystem-mt -lboost_thread-mt -lz -lboost_filesystem-mt ../../libapollo/core/libcore.a ../../libapollo/src/liblibapollo.a -lboost_system-mt -lboost_thread-mt 
```

在我看来，那些链接命令似乎完全一样，没有 -lpthread。

有谁知道如何确保每次都包含 pthread ？

我对链接的 cmake 构建目录和失败的 cmake 构建目录进行了比较。可执行构建目录的link.txt存在差异（如上所述）。主 Makefile.cmake 文件也有所不同。工作构建目录有以下几行：

*   “/usr/share/cmake-2.8/Modules/CMakeCCompiler.cmake.in”
*   "/usr/share/cmake-2.8/Modules/CMakeCCompilerABI-
*   “/usr/share/cmake-2.8/Modules/CMakeCCompiler.cmake.in”
*   "/usr/share/cmake-2.8/Modules/CMakeCCompilerABI.c".c"
*   “/usr/share/cmake-2.8/Modules/CMakeCXXCompiler.cmake.in”
*   “/usr/share/cmake-2.8/Modules/CMakeCXXCompilerABI.cpp”
*   “/usr/share/cmake-2.8/Modules/CMakeDetermineCCompiler.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeDetermineCXXCompiler.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeDetermineCompilerABI.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeDetermineCompilerId.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeDetermineSystem.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeFindBinUtils.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeParseImplicitLinkInfo.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeSystem.cmake.in”
*   “/usr/share/cmake-2.8/Modules/CMakeTestCCompiler.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeTestCXXCompiler.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeTestCompilerCommon.cmake”
*   “/usr/share/cmake-2.8/Modules/CMakeUnixFindMake.cmake”

但是，我不确定这些是否会有所作为。我想这些结果被缓存了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:07:14.030

在网络搜索失败后，我终于放弃了，只是手动将线程添加到 CMake 要求中。这很好用，现在我每次修改 CMakeLists.txt 时都不必重建库

```
find_package(Threads REQUIRED)
if (Threads_FOUND)
target_link_libraries (libapollo ${CMAKE_THREAD_LIBS_INIT})
endif (Threads_FOUND) 
```

# objective-c - 在 for 循环中为 NSMutable 数组赋值

> ID：11509072
> 
> 赞同：0
> 
> 时间：2012-07-16T17:03:25.243
> 
> 标签：objective-c, nsmutablearray

我正在尝试为一个名为“word”的新类编写一个方法，它是 NSString 的子类。我想要一个接受包含单个字符的 NSString 并返回该字符串的每个实例的单词中的位置的方法。到目前为止我有这个：

```
@implementation Word
    -(NSMutableArray *)placeOfLetter: (NSString *)letterAsked;{
        NSUInteger *len=(NSUInteger *)[self length];
        int y=0;
        char letter=(char)letterAsked; 

        for (NSUInteger *x=0; x<len; x++) {
                if ([self characterAtIndex:*x]==letter){
                     [matchingLetters insertObject:x atIndex:y];
                     y++;
                }
        }
    }     
@end 
```

但是，xcode 告诉我，我不能将 x 作为 insertObject 的参数，因为“不允许从 NSUInteger 到 id 的隐式转换。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:14:43.270

您遇到的问题主要源于您将`NSUInteger`其视为指针；你还有一些其他的铸造问题。尝试以下操作：

*   不要为`letterAsked`参数取一个完整的字符串，然后`char`从中取出一个，只需将一个`char`(or `unichar`) 作为你的参数开始。您完全避免了`letter = (char)letterAsked`转换。
*   不要做`len`指针。您可能根本不需要申报`len`。考虑像这样编写`for`循环：

    ```
    for(NSUInteger x = 0; x < [self length]; x++) { // ... 
    ```

    这也有助于您`-characterAtIndex:`通话；您不再需要取消引用`x`来获取角色。

*   就像 Hot Licks 在评论中所说的那样，如果你想要在 NSArray 中的位置，请使用 NSNumber；您需要将数字作为类实例才能进入 NSArray 实例。您可以像这样创建一个 NSNumber `x`：

    ```
    NSNumber * foundPosition = [NSNumber numberWithUnsignedInteger:x]; 
    ```

*   考虑只使用 NSMutableArray 的方法，而不是每次`-addObject:`都跟​​踪和递增它。`y`你会得到同样的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:15:24.207

[`NSUInteger`是`typedef`或`unsigned int`，`unsigned long`具体取决于您的平台。](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html) 它不是对象类型。因此，当您声明 时`NSUInteger *x=0`，您将声明`x`为指向无符号整数的指针，并将其初始化为 null。

`insertObject:atIndex:`需要一个，而`NSUInteger`不是一个`NSUInteger*`，作为它的`index`参数。

只需`*`从`for`声明和`characterAtIndex:`消息中取出。

您的方法中也确实存在其他问题，例如转换`letterAsked`为 a`char`而不是使用`characterAtIndex:`并声明`len`为指针将字符从中取出。

# php - 无法进入 PHP 交互模式

> ID：11509073
> 
> 赞同：2
> 
> 时间：2012-07-16T17:03:32.740
> 
> 标签：php, debian

我正在运行 Debian Squeeze 并试图进入 PHP 交互模式。（我已经安装了 php5-cli 以及通常的 php 安装包）通常我会通过`php -a` 在这个系统上运行来做到这一点，我得到以下信息，没有通常的 php 提示：

> **启用交互模式**

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T13:26:41.587

不幸的是，这是一个 Debian 特有的错误：[#576218](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=576218)。

总结错误报告中的评论：似乎没有简单的解决方法。但是，Ubuntu 和可能的其他发行版不受此错误的影响，因为它们构建 PHP 是针对`libreadline`. Debian 不使用`libreadline`，但`libedit`由于许可问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-28T20:40:51.503

另一个答案是缺少解决方案。

1.  如果您想要一些没有持久环境的简短命令，请执行

    ```
     while read -er line; do php -r "$line"; done 
    ```

2.  获取不同的 php，（通过编译或其他方式）链接到 readline 而不是 libedit（这在 debian 中没有完成，因为参与 php 打包的人不希望 readline 的 gpl 应用于 php），或者更新版本的 php修复了这个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-05T16:22:21.963

您可以自己编译 readline 模块。使用 Debian Wheezy 和 PHP 5.4，我可以通过这样做来解决这个问题（以 root 身份运行命令）：

```
# apt-get install php5-dev libedit-dev libreadline-dev

# mkdir php && cd php
# apt-get source php5-cli
# cd php5-5.4.4/ext/readline
# phpize
# ln -s ../../sapi/
# ./configure
# make
# cp modules/readline.so /usr/lib/php5/<number like 20100525>/
# chmod -x /usr/lib/php5/20100525/readline.so
# echo 'extension=readline.so' > /etc/php5/mods-available/readline.ini
# cd /etc/php5/cli/conf.d
# ln -s ../mods-available/readline.ini 20-readline.ini 
```

现在 PHP 控制台应该可以正常工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-05T19:22:41.863

我已经为 Ubuntu 12.04 Precise Pangolin（基于 Debian Wheezy）解决了这个问题，所以：

```
sudo apt-get install php5-readline 
```

# javascript - attr() 怎么给我一个奇怪的结果？

> ID：11509075
> 
> 赞同：2
> 
> 时间：2012-07-16T17:03:36.453
> 
> 标签：javascript, jquery

所以我有：

```
<span selected="Y" onclick="change();">Click here to test~</span>

<script src="jquery-1.7.2.js"></script>

<script>
function change()
{
  $('span[selected=Y]').attr("selected","N");
}
</script> 
```

当我单击跨度并使用萤火虫检查跨度的属性时，属性“selected”更改为“selected”而不是“N”。

所以结果是**selected="selected"** !!??

怎么没变`selected="N"`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:06:16.973

`selected`不是`span`的有效属性，您可以使用`data`.

```
<span data-selected="Y">Click here to test~</span> 
```

***jQuery***

```
$('span[data-selected=Y]').on('click', function() {
  $(this).data('selected', 'N');
}); 
```

阅读更多关于 jQuery **[.data()](http://api.jquery.com/data)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:58:54.143

原因是对于它有效的`<option>`元素（例如元素），`selected`它是一个布尔属性，而布尔属性的唯一有效值是属性本身的名称。jQuery 的`attr()`方法正在尝试并未能聪明地“纠正”您的`selected`属性值。

显然 jQuery 不能正确处理无效属性，这在某种程度上是可以理解的。您的选择是使用`getAttribute()`元素本身的方法（适用于所有主要浏览器），或者更好地使用前缀为 的属性`data-`，根据 HTML5 规范有效，浏览器和 jQuery 都支持。

# django - 从 ManytoMany 字段中加载 MultipleChoiceField 值

> ID：11509077
> 
> 赞同：1
> 
> 时间：2012-07-16T17:03:46.770
> 
> 标签：django, django-forms

我想在保存后将具有多对多关系的字段作为初始数据加载到 MultipleChoiceField 中。

**我的课程**

```
class Course(models.Model):
    name = models.CharField(max_length=30)
    description = models.TextField(max_length=30)
    owner = models.ForeignKey(User)

class UserProfile(models.Model):
    user = models.OneToOneField(User, unique=True)
    status = models.CharField(max_length=10, choices=STATUS_CHOICES, default='student')
    courses_list = models.ManyToManyField(Course, blank=True) 
```

**我的表格**

```
class AddSubscibeForm(forms.ModelForm):
    userprofile_set = forms.ModelMultipleChoiceField(initial = User.objects)
    class Meta:
        model = Course 
```

**我的观点**

```
def addstudents(request, Course_id):
    editedcourse = Course.objects.get(id=Course_id)  # (The ID is in URL)
    form = AddSubscibeForm(instance=editedcourse)
    return render(request, 'addstudents.html', locals()) 
```

实际上，我有一个包含用户的多项选择列表，但我没有在他们的“courses_list”字段中拥有该课程的用户列表。

我可以通过以下方式访问用户的 course_list：

```
> editedcourse = Course.objects.get(id=Course_id)
> subscribed = editedcourse.userprofile_set.all()
> subscribed.user.username 
```

如果你有一个想法.. :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:44:19.357

确认您的要求。您希望能够查看包含课程的表单并选择哪些用户在他们的课程中拥有该课程？

您将无法正确使用 ModelForm 中不存在于其模型中的字段。

您可以做的是更改模型并让 ManyToManyField 指向双向，然后使用以下命令：

```
class AddSubscibeForm(forms.ModelForm):
    class Meta:
        model = Course
        fields = ('userProfiles') 
```

假设您有一个 ManyToManyField in `Courses`called ，这将起作用`userProfiles`。

要让 ManyToManyField 双向工作，请查看[这张票](https://code.djangoproject.com/ticket/897)。

我还没有尝试过，但我认为它应该可以工作。

```
class Test1(models.Model):
    tests2 = models.ManyToManyField('Test2', blank=True)

class Test2(models.Model):
    tests1 = models.ManyToManyField(Test1, through=Test1.tests2.through, blank=True) 
```

或这个：

```
class User(models.Model):
    groups = models.ManyToManyField('Group', through='UserGroups')

class Group(models.Model):
    users = models.ManyToManyField('User', through='UserGroups')

class UserGroups(models.Model):
    user = models.ForeignKey(User)
    group = models.ForeignKey(Group)

    class Meta:
        db_table = 'app_user_groups'
        auto_created = User 
```

以上两个都应该工作。在这两种情况下，您都不必更改数据库中的任何内容。

# jquery - 无法让事件监听器工作

> ID：11509082
> 
> 赞同：-1
> 
> 时间：2012-07-16T17:04:06.973
> 
> 标签：jquery, event-listener, webkit-transition

我有一个事件监听器，我正在尝试开始工作，但似乎无法让它运行。我有一个 onclick 设置，可以切换 div 的类以提示 webkit 转换。当该转换结束时，我希望 jquery 将外部页面加载到 div 中，但它不会加载它。这是我设置的js

```
<script type="text/javascript">
function fullscreen_slider_load() {
var fullscreen = document.getElementById("fullscreen");

function fullscreen_done1() {
    console.log("done called");
    fullscreen.removeEventListener("webkitTransitionEnd", fullscreen_done1);
    fullscreen.addEventListener("webkitTransitionEnd", fullscreen_done2);
    $(function fullscreen_load() {
    $('#fullscreen')
       .html('<img src="http://www.klossal.com/loader.gif"/>')
       .load('http://www.klossal.com/portfolio/space_fullscreen.html');
});

function fullscreen_done2() {
    fullscreen.removeEventListener("webkitTransitionEnd", fullscreen_done2);

};
</script> 
```

我不确定为什么它没有加载，但我能得到的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:08:01.653

您的这部分代码对我来说毫无意义，并且看起来与您所说的想要发生的不一致。此外，您发布的代码似乎没有适当的支撑：

```
$(function fullscreen_load() {
$('#fullscreen')
   .html('<img src="http://www.klossal.com/loader.gif"/>')
   .load('http://www.klossal.com/portfolio/space_fullscreen.html');
}); 
```

如果我理解这一点，它将设置一个`document.ready()`事件处理程序来将新内容加载到`#fullscreen`. 我不认为这就是你想要的。

我也看不到您添加触发的事件侦听器的任何地方，`fullscreen_done1()`并且我看不到事件侦听器的任何原因，`fullscreen_done2()`因为它没有在这里使用。

如果您只是希望全屏对象在第一个 CSS 转换完成时加载一些新内容，并且您已经注册了将在`fullscreen_done1()`其他地方调用的事件侦听器，您可以使用它（固定缩进和支撑）：

```
<script type="text/javascript">
function fullscreen_slider_load() {
    var fullscreen = document.getElementById("fullscreen");

    function fullscreen_done1() {
        console.log("done called");
        fullscreen.removeEventListener("webkitTransitionEnd", fullscreen_done1);
        fullscreen.addEventListener("webkitTransitionEnd", fullscreen_done2);
        $(fullscreen)
           .html('<img src="http://www.klossal.com/loader.gif"/>')
           .load('http://www.klossal.com/portfolio/space_fullscreen.html');
    }

    function fullscreen_done2() {
        fullscreen.removeEventListener("webkitTransitionEnd", fullscreen_done2);
    }
}
</script> 
```

如果您尝试做的事情比这提供的更多，那么请说明您在第一次转换完成后还尝试做什么。

PS 当你不缩进函数声明下的代码时，很容易误解你的代码的意图。

您的代码也无法在 Firefox 或 Opera（支持 CSS3 转换的非 webkit 浏览器）中运行。

# java - 为接受命令行输入的 Java 独立执行 JUnit 测试用例

> ID：11509084
> 
> 赞同：2
> 
> 时间：2012-07-16T17:04:15.773
> 
> 标签：java, junit, command-line-arguments

我编写了一个接受输入命令行参数的 Java 独立应用程序。如何使用 JUnit 测试用例对其进行测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:12:04.940

只需`main()`从 JUnit 调用您的方法。但是，由于`main()`不返回任何内容，因此您无法轻松编写任何断言（您必须依赖副作用）。

因此，为了测试的简单性和可维护性，将`main()`带有参数解析的方法与实际逻辑分开。`main()`用mocked逻辑单独测试，分别测试参数解析和测试业务逻辑。您的业​​务逻辑将具有定义明确的强类型接口，使其更易于测试和理解。

此步骤还将减少耦合并增加可读性。

# groovy - SOAP UI - 在初始化阶段执行的步骤（仅一次并重复使用）

> ID：11509086
> 
> 赞同：0
> 
> 时间：2012-07-16T17:04:23.973
> 
> 标签：groovy, soapui

我有以下情况：

步骤 1）通过 groovy 从文件中加载 base64 格式的文件内容。（非常大的文件）

步骤2）将此base64分配给参数

步骤 3) 使用此参数执行请求

如果我执行负载测试，即使 2GB 也不够，因为 20 个线程很容易消耗它。

那么有没有办法在不同的线程之间重用加载的文件，以便在每次执行测试用例时不加载大文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:43:13.053

尝试为长字符串添加一个属性（我认为任何级别都可以工作.. TestCase、TestPlan、Project）。

在计划或项目级别使用 groovy 脚本读取字符串，并将 base64 值放入该属性中。

从负载测试中，重用属性中的数据，而不是从文件中读取。

那应该允许线程共享它。

让我知道它是否不起作用。我仍在将soapui 下载到我的新桌面3.4/117MB。

# ruby-on-rails - 使用蜻蜓在rails中保存大文件时应用程序超时

> ID：11509087
> 
> 赞同：2
> 
> 时间：2012-07-16T17:04:24.087
> 
> 标签：ruby-on-rails, amazon-s3, dragonfly-gem

我在保存大文件时遇到问题，使用带有蜻蜓扩展名“image_accessor”的模型。

我们正在尝试使用雾和 excon 将文件保存到 Amazon S3 服务器。在此保存中，我们收到错误：

```
A Excon::Errors::Timeout occurred in batch_uploads#upload_file:

 write timeout reached
 excon (0.14.2) lib/excon/socket.rb:124:in `rescue in write' 
```

我怀疑该错误与此有关：[https](https://github.com/markevans/dragonfly/issues/207) ://github.com/markevans/dragonfly/issues/207但我不能完全确定。

有没有人对如何推进这个有任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:21:14.897

这似乎是一个 Excon 超时。您可以尝试增加[Excon lib 的默认 write_timeout](https://github.com/geemus/excon/blob/master/lib/excon.rb#L24)设置。

```
Excon.defaults[:write_timeout] = 500 
```

# gnuplot - 如何在 Gnuplot 中缩放轴

> ID：11509088
> 
> 赞同：1
> 
> 时间：2012-07-16T17:04:25.603
> 
> 标签：gnuplot, axes

> **可能重复：**
> [如何在 Gnuplot 中缩放轴](https://stackoverflow.com/questions/4204839/how-to-scale-the-axis-in-gnuplot)

我有大量的 x 和 y 轴（1000、2000 等）但我希望在不更改或重新缩放数据的情况下重新编写或重新缩放它们，例如 1000 在轴上为 1 等。我m 不是在寻找 1x10^3。只是让 1000 为 1。有什么办法可以做到吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T17:41:09.700

最简单的方法是重新调整输入数据：

```
plot 'datafile' using ($1/1000.):2  #assume x-data is in first column 
```

现在就 gnuplot 而言，你给了它 1，而不是 1000。

# uitextfield - UITextField 使用 textField.inputView 在 xcode 4.3.2 中显示 UIPickerView

> ID：11509089
> 
> 赞同：0
> 
> 时间：2012-07-16T17:04:37.770
> 
> 标签：uitextfield, uipickerview, xcode4.3, inputview

我希望 UITextField 在触摸时显示 UIPickerView。我发现很多关于使用 UITextField.inputView 的相同主题的问题。但是，当我尝试时，没有任何改变。

我有一个非常简单的代码：

```
setupViewController.h

#import <UIKit/UIKit.h>

extern NSString *setupRightChannel;

@interface setupViewController : UIViewController
{
    UITextField* rightChannelField; 
    UIPickerView *channelPicker;
}

@property (retain, nonatomic) IBOutlet UITextField* rightChannelField;
@property (retain, readwrite) IBOutlet UIPickerView *channelPicker; 
```

* * *

```
setupViewController.m

#import "setupViewController.h"

@Interface setupViewController()

@end

@implementation setupViewController

@synthesize rightChannelField;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization

    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.navigationItem.title = @"Setup";
    // Do any additional setup after loading the view from its nib.
    rightChannelField.inputView = channelPicker;
}

-(IBAction)okClicked:(id)sender
{
    setupRightChannel = rightChannelField.text;
} 
```

我觉得我可能在这里遗漏了一些基本的东西，但老实说，我想不出它是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T03:33:38.313

```
datePicker = [[UIDatePicker alloc]initWithFrame:CGRectMake(0, 250, 325, 300)];
datePicker.datePickerMode =UIDatePickerModeDate;

NSDateFormatter *dateFormatter =[[NSDateFormatter alloc]init];
[dateFormatter setFormatterBehavior:NSDateFormatterBehavior10_4];
[dateFormatter setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@"en_US"]];
[dateFormatter setDateFormat:@"dd MMM yyyy"];

[datePicker addTarget:self action:@selector(dueDateChanged) forControlEvents:UIControlEventValueChanged];

UIToolbar *pickerToolBar =[[UIToolbar alloc]initWithFrame:CGRectMake(0,0, 320,44)];
pickerToolBar.barStyle =UIBarStyleBlackOpaque;
UIBarButtonItem *barButton =[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
UIBarButtonItem *doneButton =[[UIBarButtonItem alloc] initWithTitle:@"Done"
                                                              style:UIBarButtonItemStyleDone target:self
                                                             action:@selector(closeDueDatePicker:)];
[pickerToolBar setItems:[NSArray arrayWithObjects:barButton, doneButton,nil]];
[self.datePicker addSubview:pickerToolBar];
dueDateTextField.inputView =datePicker; // "This is what changes textfields default responder from keyboard to what ever view you assign it (DatePicker view in this case)." 
```

谢谢

# full-text-search - JCR - Jackrabbit - 节点内包含的文件的搜索内容文本的 Xpath 表达式

> ID：11509093
> 
> 赞同：0
> 
> 时间：2012-07-16T17:04:45.500
> 
> 标签：full-text-search, jackrabbit, jcr

我在 java 中使用 JackRabbit JCR 时很头疼。这是关于制作一个 xpath 表达式来搜索我的存储库中的实体。

让我们简要介绍一下存储什么样的数据，我们有 3 个名为“Entry”的节点类，它扩展了另一个名为“BaseEntry”的节点类，并扩展了另一个名为“BaseNode”的节点类。Entry 类代表我们 JCR 系统中的一个 Node，并具有一组属性（映射为相应类中的属性），并且还继承了映射在其超类中的属性。“BaseEntry”类聚合了许多（零个或多个）附件。这表示与条目关联的原始文件（.doc、.xls、.pdf、.txt、.etc :D）。

这些是类定义和感兴趣的属性的一部分......

“入门”课

```
@Node(jcrType = "entry",  extend = BaseEntry.class)
public class Entry extends BaseEntry {

  ... // nothing really important here
} 
```

“BaseEntry”类

```
@Node(jcrType = "baseEntry", extend = BaseNode.class, isAbstract = true)
public abstract class BaseEntry extends BaseNode {

  @Collection (jcrType = "attachment",
      collectionConverter = NTCollectionConverterImpl.class)
  protected List<Attachment> attachments = new ArrayList<Attachment>();

  ...

} 
```

“基节点”类

```
@Node(jcrType = "baseNode", isAbstract = true)
public abstract class BaseNode {

  @Field(jcrName = "name", id = true)
  protected String name;

  @Field(jcrName = "creationDate")
  protected Date creationDate;

  ...
} 
```

“附件”类

```
@Node(jcrType = "attachment", discriminator = true)
public class Attachment extends BaseNode implements Comparable<Attachment> {

  /** The attachment's content resource. It cannot be null. */
  @Bean(jcrType = "skl:resource", autoUpdate = false)
  private Resource content;
  ...
} 
```

“资源”类@Node(jcrType = "skl:resource", discriminator = true)

```
public class Resource extends BaseNode {

  /** Resource's MIME type. It cannot be null or empty. */
  @Field(jcrName="jcr:mimeType", jcrDefaultValue = "")
  private String mimeType;

  /** Resource's size (bytes). */
  @Field(jcrName="skl:size")
  private long size;

  /** Resource's content data as stream. It cannot be null. */
  @Field(jcrName="jcr:data")
  private InputStream data;

  ...
} 
```

custom_nodes.xml 对这些节点具有以下定义：

```
<!-- Base node type definition -->
  <nodeType name="docs:baseNode"
            isMixin="false"
            hasOrderableChildNodes="false" >
    <supertypes>
      <supertype>nt:hierarchyNode</supertype>
    </supertypes>
    <propertyDefinition name="docs:name"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="docs:searchPath"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="docs:creationDate"
                        requiredType="Date"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="docs:lastModified"
                        requiredType="Date"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <childNodeDefinition name="*"
                         defaultPrimaryType="docs:baseNode"
                         autoCreated="false"
                         mandatory="false"
                         onParentVersion="COPY"
                         protected="false"
                         sameNameSiblings="false">
      <requiredPrimaryTypes>
        <requiredPrimaryType>docs:baseNode</requiredPrimaryType>
      </requiredPrimaryTypes>
    </childNodeDefinition>
  </nodeType>

  <!-- Resource node type definition -->
  <nodeType name="skl:resource"
            isMixin="false"
            hasOrderableChildNodes="false" >
    <supertypes>
      <supertype>docs:baseNode</supertype>
      <supertype>nt:resource</supertype>
    </supertypes>
    <propertyDefinition name="skl:size"
                        requiredType="Long"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:externalUri"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
  </nodeType>

  <!-- Attachment node type definition -->
  <nodeType name="skl:attachment"
            isMixin="false"
            hasOrderableChildNodes="false" >
    <supertypes>
      <supertype>docs:baseNode</supertype>
    </supertypes>
    <propertyDefinition name="skl:requestId"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:contentExternalUri"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:multiPagePreviewUrl"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
  </nodeType>

  <!-- Base Entry node type definition -->
  <nodeType name="skl:baseEntry"
            isMixin="false"
            hasOrderableChildNodes="false" >
    <supertypes>
      <supertype>docs:baseNode</supertype>
    </supertypes>
    <propertyDefinition name="skl:title"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:description"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:author"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:creator"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:creatorUnique"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:creatorMail"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:office"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:tags"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="true" />
  </nodeType>

  <!-- SKL Entry node type definition -->
  <nodeType name="skl:entry"
            isMixin="false"
            hasOrderableChildNodes="false" >
    <supertypes>
      <supertype>docs:baseNode</supertype>
      <supertype>skl:baseEntry</supertype>
    </supertypes>
    <propertyDefinition name="skl:languageName"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:rating"
                        requiredType="Long"
                        autoCreated="false"
                        mandatory="true"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    <propertyDefinition name="skl:urls"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="true" />
    <propertyDefinition name="skl:visitors"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="true" />
    <propertyDefinition name="skl:datePublished"
                        requiredType="String"
                        autoCreated="false"
                        mandatory="false"
                        onParentVersion="COPY"
                        protected="false"
                        multiple="false" />
    </nodeType> 
```

所以我期待 make 和 xpath 语句来搜索那些在附件中包含某种文本的条目。所以基本上，这个想法是搜索具有包含特定文本或关键字的文件的条目。

到目前为止，我尝试使用这样的东西......

```
String xPathQuery = "<BASE PATH>//element(*, skl:entry) [jcr:contains(*//content,'*<keyword>*')]";
String xPathQuery = "<BASE PATH>//element(*, skl:entry) [jcr:contains(*//@jcr:data,'*<keyword>*')]"; 
```

但是这些东西，并不像你猜的那样好用……

我希望，一个慈善灵魂可以帮助我完成这个任务.. 不太好：S。感谢您提前向大家介绍如何看到这个！

问候！！

胜利者

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T21:08:13.347

[Jackrabbit 常见问题解答](http://jackrabbit.apache.org/frequently-asked-questions.html#FrequentlyAskedQuestions-Whydoesn%27t%7B%7B//%5Cjcr%3acontains%28@jcr%3adata,%27foo%27%29%7D%7Dreturnmatchesforbinarycontent?)解释了您的问题：

> 为什么 //*[jcr:contains(@jcr:data, 'foo')] 不返回二进制内容的匹配项？
> 
> 从二进制内容中提取的文本仅在 @jcr:data 属性的父节点上编制索引。在 nt:resource 节点上使用 jcr:contains()。

所以在你的情况下，我会使用类似的东西：

```
String xPathQuery = "<BASE PATH>//element(*, skl:resource)[jcr:contains(.,'*<keyword>*')]"; 
```

或者

```
String xPathQuery = "<BASE PATH>//element(*, skl:entry)//element(*, skl:resource)[jcr:contains(.,'*<keyword>*')]"; 
```

我也强烈反对在您的 contains 语句开头使用 * 通配符。由于 Lucene 是倒排索引，因此效率极低。

# java - 从 iOS 到 Android：一些初学者的问题

> ID：11509096
> 
> 赞同：0
> 
> 时间：2012-07-16T17:04:52.700
> 
> 标签：java, android, ios, cocoa-touch

好的，我花了很多时间使用 iOS SDK，现在我正在使用 Eclipse 将我的应用程序移植到 Android。我想知道一些我似乎无法在网上找到的基本信息：

1.  相当于`UIImageView`什么？我已经尝试过`ImageView`，但即使在 XML 中，也几乎不可能只调整它的大小！
2.  什么是等效的`presentModalViewController`，如何在我的项目中实现新的 java 和 xml 文件？

感谢您的帮助，开始使用 Android 似乎比使用 iOS 更难！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:17:39.753

@Samir 对“从头开始”的暗示回应是正确的，但要回答您的具体问题：

UIImageView：[图像视图](http://developer.android.com/reference/android/widget/ImageView.html)

我使用的最接近 presentModalViewController 的是[AlertBuilder](http://developer.android.com/reference/android/app/AlertDialog.Builder.html)

在我个人看来，Android 更难设置，更容易编码。我从 iOS 开始，现在两者都做。最难的部分是习惯不同的工作流程。将 XML 视为等效于 Interface Builder 步骤，然后将 Activity 视为控制器代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:51:04.427

1) 是的，UIImageView: ImageView 是一样的，你可以使用 ImageView.setWidth(XX), ImageView.setHeight(XX) 来调整它的大小

2) 对于 presentModalViewController，您必须编写自定义动画才能实现。

# mobile - 允许在网站上使用移动功能？

> ID：11509101
> 
> 赞同：1
> 
> 时间：2012-07-16T17:05:18.043
> 
> 标签：mobile, native, responsive-design

是否可以在网站上允许使用本机功能？例如：

我的网站是响应式的，当它被移动浏览器（基于媒体查询）加载时，我可以使用搜索框并允许用户使用按钮拉起原生搜索。

我可以处理媒体查询、检测等。但是，我不确定是否可以在站点内使用设备搜索功能。

# perl - 有条件地连接到数据库

> ID：11509102
> 
> 赞同：3
> 
> 时间：2012-07-16T17:05:22.903
> 
> 标签：perl, if-statement, dbi

我在使用 DBI 模块连接到我的数据库时遇到了一些麻烦。我有一个属性文件，其中指定我是否要通过简单的`database=oracle`或`database=postgres`. 我的属性文件是使用 Config::Tiny 模块设置的，我的变量设置如下：

```
my $database = $config->{myDB}->{database};
                       ... 
```

我不明白的是，即使这适用于我的所有变量，如果我尝试这样的事情来连接到属性文件中指定的任何数据库......

```
if($database eq "oracle"){
    my $dbh = DBI->connect("dbi:Oracle:host=abc123-server;sid=XE;port=1521","User","Pass");
}
elsif($database eq "postgres"){
    my $dbh = DBI->connect("dbi:Pg:dbname=pepperoni;host=789xyz-server;port=5444;","Foo","Bar");
}else{
    print "Could not connect to a database";
} 
```

...我最终遇到了这些错误：

```
Global symbol "$dbh" requires explicit package name at supportvuloop.pl line 70.
Global symbol "$dbh" requires explicit package name at reportloop.pl line 80.
Global symbol "$dbh" requires explicit package name at reportloop.pl line 81.
Global symbol "$dbh" requires explicit package name at reportloop.pl line 82.
Global symbol "$dbh" requires explicit package name at reportloop.pl line 88. 
```

当它们不是 if 条件的一部分时，我可以很好地连接到任何一个数据库，任何想法为什么它现在会导致错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:09:41.373

您的 $dbh 变量未在正确的范围内声明。相反，您应该在“if”语句之前声明它：

```
my $dbh;

if ($x) {
    $dbh=xxx1;
} elsif ($y) {
    $dbh=xxx2;
} else { # error
}
... 
```

它们是您的代码是结构化的，`$dbh`变量被声明为`my`“if”块内（并且独立地，在“else”块内），因此您的其余代码没有看到这些变量

进一步阅读：

*   [`perldoc my`](http://perldoc.perl.org/functions/my.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T17:34:59.197

DVK 已经回答了你的问题，但我想给个小费。我将编写如下代码，因为它将配置与数据库连接分开：

```
my %connect_info = (
   "oracle" => {
      dsn      => "dbi:Oracle:host=abc123-server;sid=XE;port=1521",
      user     => "User",
      password => "Pass",
   },
   "postgres" => {
      dsn      => "dbi:Pg:dbname=pepperoni;host=789xyz-server;port=5444;",
      user     => "Foo",
      password => "Bar",
   },
);

my $connect_info = $connect_info{$database}
   or die("Unknown database $database\n");

my $dbh = DBI->connect(
   $connect_info{dsn},
   $connect_info{user},
   $connect_info{password},
); 
```

# android - 带有可更改按钮的应用程序

> ID：11509103
> 
> 赞同：0
> 
> 时间：2012-07-16T17:05:29.503
> 
> 标签：android, button, android-activity

我正在开发一个应用程序，它将有一个带有按钮的滚动视图（所有不同的公司图标）。所有按钮都将调用相同的活动，（用户不会知道这一点）。问题如下：

我需要能够添加按钮和删除按钮，而用户不必一直更新应用程序。我怎样才能做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:43:24.077

Button.setVisibility(int 可见性)

[http://developer.android.com/reference/android/view/View.html#setVisibility%28int%29](http://developer.android.com/reference/android/view/View.html#setVisibility%28int%29)

# html - HTML 基础知识：目前什么是好的视口大小？

> ID：11509105
> 
> 赞同：5
> 
> 时间：2012-07-16T17:05:33.277
> 
> 标签：html, css

对此有很多不同的看法，但是在设计网页时，您应该满足的最佳窗口大小或视口大小是多少？现在这是假设你想迎合广大公众（这意味着你应该创建一个游戏网站，那里的人不会有 800x600 的屏幕......）

此外，最好将包含主的 div 保留为自动大小（以便它随着屏幕大小而拉伸，假设您没有任何不想拉伸的固定元素）还是固定宽度？我设计了一些网站，但我仍然不确定 2012 年的最佳实践是什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:19:59.767

在响应式网页设计上查找更多信息。它的基本轮廓是：您应该使用媒体查询设置您的 css 并调整您的样式以适应各种尺寸。`%`您还应该使用 more和 less来设计更流畅的布局`px`。

我认为这些是响应式设计中非常常见的媒体查询：

```
/* Landscape phones and down */
@media (max-width: 480px) { ... }

/* Landscape phone to portrait tablet */
@media (max-width: 767px) { ... }

/* Portrait tablet to landscape and desktop */
@media (min-width: 768px) and (max-width: 979px) { ... }

/* Large desktop */
@media (min-width: 1200px) { ... } 
```

将此添加到您的 html 的顶部：

`<meta name="viewport" content="width=device-width" />`

如果您想拥有单独的样式表，以便您的用户不必下载一个怪物样式表，请这样做：

```
`<link rel="stylesheet" type="text/css" media="only screen and (max-width: 480px), only screen and (max-device-width: 480px)" href="/assets/css/small-device.css" />` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:51:57.500

*就像 imakeitpretty 说*的那样......但不要担心当前流行的设备尺寸......只需调整大小直到它看起来很难看......然后制作断点......所以它看起来很棒。

```
/* break point 01 ----------- */
@media only screen 
and (min-width : *size-it-gets-ugly*px) {
/* Styles */
}

/* break point 02 ----------- */
@media only screen 
and (min-width : *size-it-gets-ugly*px) {
/* Styles */
}

/* break point 03 ----------- */
@media only screen 
and (min-width : *size-it-gets-ugly*px) {
/* Styles */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:16:29.840

我会说 940 像素宽度 + 响应式使用媒体查询最小宽度：780 像素和 480 像素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T17:22:26.120

**最佳尺寸是查看您网站的显示器的尺寸。**
正如[j08691](https://stackoverflow.com/questions/11509105/html-basics-what-is-currently-a-good-viewport-size#comment15207655_11509105)指出的那样，响应式是 2012 年的最佳实践。响应式设计虽然听起来像一个空洞的流行语，但确实很有用。您的内容始终与查看者浏览器的大小相同。

使用带有流体网格的媒体查询会产生最佳外观和最有用的结果。如果您不热衷于编写自己的代码，请查看现有的，例如[响应式网格系统](http://responsive.gs/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T17:44:19.357

960px 一直是一个坚实的标准宽度。

推理放在另一个 SO question [here](https://stackoverflow.com/questions/7415758/why-width-960px)中。

了解您的用户确实很重要，但您所说的关于游戏玩家的内容是完全正确的。

我不熟悉响应式，但这看起来也很有希望

# javascript - 插入前客户端是/否确认消息

> ID：11509106
> 
> 赞同：0
> 
> 时间：2012-07-16T17:05:34.197
> 
> 标签：javascript, asp.net, sql, webforms

我有一个向数据库添加表单的应用程序（ASP.NET 2.0）

按钮发出`SqlDataSource_3_Inserting`& `SqlDataSource_3_Inserted`。

我必须找到一种方法来查看数据库中的字段 X 是否超过平均水平。调用此方法`IsCorrectAmmounts()`并返回一个布尔值。

如果 bool 为真，那么用户必须确认金额是否正常。如果是（eq 是），则将数据插入数据库中，并且必须通知管理员（STMP 电子邮件）用户添加了超过平均值的值（方法已经制定，`NotifyAdmin()`）

说了这么多：

如何在`IsCorrectAmmounts`执行后制作确认框以及如何使“是”响应提交（eq 插入）表单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:10:46.103

“执行 IsCorrectAmmounts 后”添加以下代码：

```
if (confirm('hey user, is this amount ok?')) {
    yourForm.submit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:37:05.180

我为你创建了一个[Fiddle](http://jsfiddle.net/zw4Gp/3/)来展示你想要的东西！

的HTML...

```
<form id='confirmationForm' action='/your/url' method='post'>
    <input id='confirmation' name="confirmation" type="hidden" value="" />
</form>​ 
```

JavaScript 代码...

```
function IsCorrectAmmounts() {
    return true;
}

if (IsCorrectAmmounts()) {
   var result = confirm('Is the amount correct')
     , form = document.getElementById('confirmationForm')
     , input = document.getElementById('confirmation');

    if (result) {
        input.value = result;
        form.submit();
    }
}​ 
```

这是使用 jQuery 的相同代码的 AJAX 版本的[Fiddle 。](http://jsfiddle.net/zw4Gp/5/)

```
function IsCorrectAmmounts() {
    return true;
}

if (IsCorrectAmmounts()) {
   var result = confirm('Is the amount correct');

   if (result) {
       $.post('/your/url', { "result": result }, function () {           
           alert('submitted');
       });
    }
}​ 
```

# jquery - UI datepicker 硬编码日期值在页面加载时为空白

> ID：11509111
> 
> 赞同：0
> 
> 时间：2012-07-16T17:05:54.377
> 
> 标签：jquery, jquery-ui

使用 UI 日期选择器。

当我的表单加载时，未显示低于“2012-07-08”的初始值。我可以选择一个日期，但内联日期没有显示。

使用最新的 jquery 库和 ui 稳定版本。

```
 $(document).ready(function() {
   $(".datepicker").datepicker();
   $(".datepicker").datepicker("option", "dateFormat", "yy-mm-dd"); 
});

<input type="text" name="mydate" id="dp1" class="datepicker" style="width:80px" value="2012-07-08" maxlength="10" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:19:12.237

您可以`datepicker()`在一次调用中调用并添加选项。这对我有用：

```
$(document).ready(function() {   
   $(".datepicker").datepicker({dateFormat:'yy-mm-dd'});
}); 
```

小提琴：http: [//jsfiddle.net/tDaeH/9/](http://jsfiddle.net/tDaeH/9/)

# css - 如何选择性地抑制某些 li 的 list-style-image

> ID：11509113
> 
> 赞同：0
> 
> 时间：2012-07-16T17:06:08.613
> 
> 标签：css, html-lists

在我的`ul`中，我希望默认列出项目符号，但我希望能够有选择地提供个人`li`'a 类，使他们不使用`ul`'s list-style-image。现在，我给定的 CSS`ul`如下所示：

```
.monthly-menu td ul {
    margin: 0 15px 15px 20px;
    list-style-image: url('../images/menus/menu-bullet.png');
} 
```

有没有我可以添加到`li`'s 的样式，这样他们就不会从 's 继承项目符号图像`ul`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:14:36.987

您可以将特定的类/id添加到相应的类/id 中`li`，然后添加`list-style-image: none`到 CSS 中。例子：

**HTML**

```
<ul>
    <li class="noImage">Text here.</li>
    <li>Text here.</li>
</ul> 
```

**CSS**

```
ul {
    list-style-image: url('../images/menus/menu-bullet.png');
}

.noImage {
    list-style-image: none;
} 
```

​ JS 小提琴：http: [//jsfiddle.net/YrEM4/1/](http://jsfiddle.net/YrEM4/1/)

# jquery - $(this) 似乎无法正常工作

> ID：11509118
> 
> 赞同：1
> 
> 时间：2012-07-16T17:06:29.707
> 
> 标签：jquery, this, children

我想点击一个 div 让他的孩子出现。问题是我有一长串这些div。每个 div 都有一个孩子。下面，我要点击div“礼节”来显示或隐藏他的子div“detail”。

```
<div class="etiquette">
  <span class="date">13-07</span>
  <span class="titre">LOREM IPSUM 1</span>
     <div class="detail"><p>lorem ipsum 1</p></div>
</div>
<div class="etiquette">
  <span class="date">14-07</span>
  <span class="titre">LOREM IPSUM 2</span>
     <div class="detail"><p>lorem ipsum 2</p></div>
</div>
<div class="etiquette">
  <span class="date">14-07</span>
  <span class="titre">LOREM IPSUM 3</span>
     <div class="detail"><p>lorem ipsum 3</p></div>
</div> 
```

我想使用的脚本是：

```
$(document).ready(function() {
    $(".etiquette").children(".detail").css("display", "none");
    $(this).toggle(function() {
        alert("clicked");
        $(this).children("div.detail").css("display", "block");
    }, function() {
        alert("clicked again");
        $(this).children("div.detail").css("display", "none");
    });
}); 
```

以下效果很好：

```
$(this).toggle(function() {
    alert("clicked");
}); 
```

以下工作也很好。但它显示或隐藏所有 div “详细信息”，而不仅仅是点击的 div 的孩子：

```
$(this).toggle(function() {
    alert("clicked");
    $(".etiquette").children("div.detail").css("display", "block");
}, function() {
    alert("clicked again");
    $(".etiquette").children("div.detail").css("display", "none");
});
}); 
```

我究竟做错了什么 ？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:11:28.733

我猜你的 $(this) 指向文件本身。

试试这个，

```
$(document).ready(function() {
  $(".etiquette").children(".detail").css("display", "none");
  $(".etiquette").click(function(){
    $(this).children("div.detail").toggle();
  });
}); 
```

我没有测试代码。希望它会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:13:37.957

```
$(".etiquette").children(".detail").css("display", "none");
$('.etiquette').click(function() {
    $(this).find('.detail').toggle();
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/x8hDy/)**

关于你的代码有什么问题，有太多的内容需要讨论，但是如果你看一下这个例子，你就会明白它做了什么。第一行隐藏了该类的所有元素，这些元素是该类`detail`元素的子元素`etiquette`（您拥有该类，我保持不变）。下一个代码块将 click 事件绑定到具有类的元素，`etiquette`并切换具有类的子元素的显示`detail`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:14:24.410

改变这个：

```
$(this).toggle(function() { 
```

到：

```
$('.etiquette').toggle(function() { 
```

this`this`指的是`document`对象而不是`.etiquette`元素。

[*注意：从 jQuery 1.7 开始，使用切换鼠标事件已被弃用。*](http://api.jquery.com/category/events/mouse-events/)

[http://jsfiddle.net/f9BcB/](http://jsfiddle.net/f9BcB/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T17:16:53.207

您是否尝试过使用 .each 函数将切换函数绑定到每个 div？

前任：

```
$('.etiquette').each(function(){
  $(this).click(function(){
    //Enter toggle function here
  });
}); 
```

# java - 是否可以在 Java 中实现/覆盖 + 和 ++？

> ID：11509119
> 
> 赞同：3
> 
> 时间：2012-07-16T17:06:30.890
> 
> 标签：java

> **可能重复：**
> [java中的运算符重载和覆盖](https://stackoverflow.com/questions/3598707/operator-overloading-and-overriding-in-java)

我想知道是否可以实现和覆盖 + 和 ++ 运算符。

例子：

```
public class MyClass{
 private myIncrement =0; //with its getter and setter
}

.... (another class code)
MyClass myClass = new MyClass();
myClass++;
myClass.getIncrement(); //this will return 1. 
```

而且，如果我想创建一个整数类，它只给我三的倍数，当我在 MultipleOfThree 实例上使用 i++ 时，它会将三与当前实例相加，而不是总和 1。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T17:08:12.403

你不能这样做：Java 不支持运算符重载。使用其他实例方法处理您的示例，这通常更清楚。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T17:08:34.147

不。运算符重载在 java 中是不可能的。[这是一个关于为什么](http://bugs.sun.com/view_bug.do?bug_id=4905919)的有趣讨论。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-16T17:08:19.700

不，Java 没有运算符重载。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-16T17:08:24.493

不，这在 Java 中是不可能的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-16T17:09:56.910

你不能这样做。这在java中是不可能的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-16T17:09:44.727

在java中不可能。应该是，但不是

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-16T17:10:31.200

运算符重载在 Java 中是不可能的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-16T17:20:44.670

Java 有**一个且只有一个重载运算符** `+`，**不能自定义重载**。

大多数人可以看到它在将数字类型转换为字符串中的用途。

```
int x = 5;

String s = x + "" ; 
```

# asp.net - 64位机器上的系统内存不足异常？

> ID：11509120
> 
> 赞同：2
> 
> 时间：2012-07-16T17:06:31.543
> 
> 标签：asp.net, memory, 64-bit, out-of-memory

我有一个带有其他 6 个类库项目的 asp.net 应用程序。在我的一个主要类库项目中，我缓存了一些静态数据库表。Webdev.webserver40.exe 达到约 1.5 GB，并引发“系统内存不足异常”。我知道在 32 位机器上我最多只能有 2 GB 的进程大小，但我的开发机器是 64 位，64 位不应该有限制。好的，我看到你说你的 Asp.net 应用程序无论如何都会运行 32 位，即使我有 64 位机器。因此我得到了例外。但是我能做些什么来解决这个问题呢？

*   我打开配置管理器并尝试将所有类库更改为 x64，但我无法更改我的主网站项目。这就是为什么 32 位网站上无法识别 64 个参考文献的原因。

请不要告诉我我应该做本地数据库或其他一些选项，而不是缓存到内存中:) 好的，这些也是其他选项，但是我想知道内存中是否有任何其他选项。我需要甚至有超过 2gb 的缓存。

PS，调试选项卡下的“启用 VS 托管进程”选项是什么。它会影响我的问题吗？我尝试检查和取消检查，但没有任何改变。确实看起来检查它的效果更好，但我仍然遇到异常。

编辑 1：当我发现那个帖子时，它告诉我如果在 64 位操作系统上运行 32 位应用程序，我应该有 2800 mb max。进程大小，但为什么它不允许我这样做并在 1500mb 左右抛出异常。

[http://blogs.msdn.com/b/tom/archive/2008/04/10/chat-question-memory-limits-for-32-bit-and-64-bit-processes.aspx](http://blogs.msdn.com/b/tom/archive/2008/04/10/chat-question-memory-limits-for-32-bit-and-64-bit-processes.aspx)

编辑 2：我尝试在我做缓存的类库的 app.config 中添加该代码，并按照[msdn](http://msdn.microsoft.com/en-us/library/hh285054%28VS.110%29.aspx)上的建议添加到 web.config 中，它只说框架 4.5，但我使用 4.0。4.0 上是否有类似的 hack？因为我不确定是否应该安装并开始使用 4.5，虽然它不是最后一个版本。

```
<runtime>
  <gcAllowVeryLargeObjects enabled="true" />
</runtime> 
```

谢谢你的帮助。问候。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-03-05T13:33:58.533

您可以将 IIS Express 设置为在 Visual Studio 中运行 64 位：

转到 Visual Studio - 工具 - 选项菜单

选择： - 项目和解决方案，然后选择 Web 项目

勾选复选框：“为网站和项目使用 64 位版本的 IIS Express”

无需注册表编辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:49:44.157

我可能弄错了，但我确实相信`Webdev.webserver40.exe`（又名 Cassini）是一个 32 位本机 C++ 应用程序。

在您的 asp.net Web 项目属性页面中，选中“使用 IIS Express”复选框，看看是否可以解决您的问题

编辑：检查这些东西以及 -

1.  检查您是否确实有足够的 RAM 来保存您的数据
2.  确保您的交换文件驱动器上有足够的可用硬盘空间
3.  确定您的交换文件是动态的还是固定大小的

# c# - 为什么模拟方法会吞下异常？

> ID：11509121
> 
> 赞同：0
> 
> 时间：2012-07-16T17:06:37.363
> 
> 标签：c#, unit-testing, mocking, nmock2

**当前实施：**

```
void IFileManager.DeleteFile(
  string argFilename )
{
    throw new ArgumentException( "Specified filename was not found" );
} 
```

**单元测试**

```
Expect.Once.On( m_MockFileManager ).Method( "DeleteFile" );
....
.... 
```

单元测试通过，全部为绿色。我预计测试会失败，因为应该抛出异常。当我在不使用模拟框架的情况下运行此测试时，会引发异常并且测试失败。

为什么 mocking 框架会吞下异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:12:39.717

您可能需要提供比那一行更多的代码，但我的猜测是您正在模拟调用的对象，`DeleteFile`它实际上并没有调用该`DeleteFile`方法。只要代码调用该方法，那么您的代码就会通过。同样，更全面地了解您的代码将提供更好的答案。

# php - 提取部分 HTML 文档 - 需要包含 xHTML 标记

> ID：11509123
> 
> 赞同：1
> 
> 时间：2012-07-16T17:06:46.240
> 
> 标签：php, regex, xpath, domdocument, domxpath

我有一种情况需要提取 xHTML 页面的一部分，包括标记。

在这种情况下，正则表达式不是正确的路线，因为我不能保证子 div 的确切数量。

```
<div id="myDiv">
    <div><p>This is some content</p></div>
    <div><p>This additional content</p></div>
</div> 
```

因此，在上面的代码片段中，我需要提取`<div><p>This is some content</p></div>`包含标记的 .

我已经对使用 xPath 进行了一些研究，这似乎是完成这项工作的方法，但我不确定如何让它不仅返回节点的值，而且返回所有相关的标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:12:35.673

你是对的，这可以通过[DOMDocument](http://php.net/domdocument)和[XPath](http://php.net/domxpath)来实现，如下所示：

```
$doc = new DOMDocument();
$doc->loadHTML( $html); // Load the HTML snippet

$xpath = new DOMXPath( $doc);
$node = $xpath->query( '//div[@id="myDiv"]/div')->item(0); // Get the <div>

$saved_node = $doc->saveHTML( $node); // Export that node 
```

在[输出](http://viper-7.com/3imjef)中，您可以看到所需的字符串，包括标记：

```
string(62) "<div><p>This is some content</p></div>" 
```

请注意，我必须运行输出，`htmlentities()`这样您就可以在`<div>`不查看页面源代码的情况下看到。

# java - 使用java1.1淡化图像

> ID：11509125
> 
> 赞同：5
> 
> 时间：2012-07-16T17:06:52.200
> 
> 标签：java, awt

我需要使用机顶盒的低级 AWT 类来淡化图像。它没有任何高级类。有谁知道我该怎么做（Java 1.1）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:25:28.447

看看这个：[Fade an image (in Applet)](http://www.rgagnon.com/javadetails/java-0249.html)

现场示例[在这里](http://www.rgagnon.com/examples/java-0249.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:35:48.613

当然，您可以在一段时间内增加/减少图像透明度吗？

# c# - ASP.NET 使用 Moles 框架模拟 Membership.GetUser

> ID：11509126
> 
> 赞同：0
> 
> 时间：2012-07-16T17:06:54.957
> 
> 标签：c#, asp.net-mvc, unit-testing, moles

这是一个返回带有用户信息的视图模型的方法：

```
 public ActionResult EditUserInfo(string userName)
    {
        try
        {
            var user = Membership.GetUser(userName);
            var model = new UserEditorViewModel
                            {
                                UserName = userName,
                                EmailAddress = user.Email
                            };
            return View(model);
        }
        catch
        {
            return View("Error");
        }
    } 
```

如何使用 Moles 框架对其进行单元测试？有一种方法`MMembership.CreateUserStringString()`，但我不知道如何实现它来伪造用户身份。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:20:56.187

好的，所以我找到了解决方案。我必须添加痣组件`System.Web.ApplicationServices`才能模拟`MembershipUser`。最终的测试方法如下所示：

```
 [TestMethod, HostType("Moles")]
    public void EditUserInfoTest()
    {  
        var testUserName = "TestUser";
        var controller = new UserEditorController();
        using (MolesContext.Create())
        {
            var user = new MMembershipUser
            {
                UserNameGet = () => "TestUser",
                EmailGet = () => "test@test.test"
            };        
            MMembership.GetUserString = (userName) =>
            {
                Assert.AreEqual(testUserName, userName);
                return user;
            };
            var result = (ViewResult)controller.Edit(testUserName);                
            Assert.AreNotEqual("Error", result.ViewName);
        }
    } 
```

# javascript - jQuery延迟/暂停动画

> ID：11509129
> 
> 赞同：0
> 
> 时间：2012-07-16T17:07:07.950
> 
> 标签：javascript, jquery

我有以下代码来滚动表格的滚动条

```
$('.myTable').animate({
    scrollTop: myPositon
}, 45000, function() {

}); 
```

现在我有以下事件监听滚动条位置

```
$('.myTable').bind('scroll', function() {
   //if the scroll bar reaches certain position
   //pause the scrolling for 5 seconds

 }); 
```

我有代码来检查滚动条是否到达某个位置，问题是如何在绑定功能中暂停滚动/或动画 5 秒，然后自动恢复动画？

我知道有延迟和clearQueue。但打电话：

`$('.myTable').delay(5000) or $('.myTable').clearQueue`似乎有任何影响

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:33:18.747

可能在html下面解决你的问题

```
<html>
    <head>
        <style>
            div {
                position: absolute;
                background-color: #abc;
                left: 0px;
                top:30px;
                width: 60px;
                height: 60px;
                margin: 5px;
            }
        </style>
        <script src="http://code.jquery.com/jquery-latest.js"></script>
    </head>

    <body>
        <button id="go">Go</button>
        <button id="stop">STOP!</button>
        <button id="back">Back</button>
        <div class="block"></div>
        <script>
            /* Start animation */
            $("#go").click(function () {
                $(".block").animate({
                    left: '+=100px'
                }, 2000);
            });

            /* Stop animation when button is clicked */
            $("#stop").click(function () {
                $(".block").stop();
                setTimeout(function () {
                    $(".block").animate({
                        left: '+=100px'
                    }, 2000)
                }, 1000);
            });

            /* Start animation in the opposite direction */
            $("#back").click(function () {
                $(".block").animate({
                    left: '-=100px'
                }, 2000);
            });
        </script>
    </body>
</html> 
```

# mysql - 无法在 Ruby on Rails 3 中将 csv 导入 MySQL 数据库

> ID：11509135
> 
> 赞同：5
> 
> 时间：2012-07-16T17:07:43.213
> 
> 标签：mysql, ruby, ruby-on-rails-3

我正在通过 Ruby on Rails 3 将 CSV 文件中的数据导入 MySQL db。客户模型已经创建。此外，下面的脚本将正确生成 puts row[2] 和 puts row[3]。当我为customers.warranty_part_no 和warranty_part_desc 的数据库字段添加分配时，它会产生以下错误。

```
csv = CSV.read(file, col_sep: ",", headers: false)

c = Customer.new  
csv.each do |row|
        c.warranty_part_no = row[2],
        c.warranty_part_desc = row[3]
end 
```

这是我得到的错误。

```
uninitialized constant Customer (NameError) 
```

经过一些测试，我认为这个问题是因为我从命令行运行这个脚本，所以 customer.rb 模型没有使用较大的 rails 应用程序执行，因此永远不会创建 Customer 类。如何从命令行运行此脚本并利用 ActiveRecord 或 activerecord-import？如果这不可能，我该如何为其创建路线或从应用程序的视图中调用它？

我在 Ruby 1.9.2 和 Rails 3.2.2 上。提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T01:53:59.723

这里有两种方法可以解决这个问题

```
 #myscripy.rb
 # add following in your script
 require 'rubygems'
 require 'active_record'
 require YOUR_DB_ADAPTER_GEM #'mysql2', 'pg'
 require PATH_TO_YOUR_MODEL

 csv = CSV.read(file, col_sep: ",", headers: false)

 c = Customer.new  
 csv.each do |row|
    c.warranty_part_no = row[2],
    c.warranty_part_desc = row[3]
 end
 c.save 
```

否则你可以简单地编写 rake 任务（最好在同一个 RailsApp 中）

```
require 'csv'
 namespace :import do
 task :csv_file => :environment do
  csv = CSV.read(file, col_sep: ",", headers: false)

   c = Customer.new  
   csv.each do |row|
    c.warranty_part_no = row[2],
    c.warranty_part_desc = row[3]
   end
   c.save
  end
end 
```

当您在 RailsApp 中时，可以从命令行调用`rake import:csv_file`

如果您对此有任何疑问，请评论我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T01:35:24.310

正如您所发现的，问题在于您的 Rails 环境没有加载。您可以在独立脚本中通过包含您的客户模型、active_record 并使用您的 database.yml 建立连接来执行此操作。

但是，有一种更简单的方法。像这样创建一个 rake 任务：

```
namespace :data do
  desc "Import data from CSV"
  task :import => :environment do
    #Your script here
  end
end 
```

告诉 rake 加载 Rails ，`=> :environment`以便您的数据库连接和所有模型都在那里供您使用。

使用 调用它，如果需要生产环境，请`rake data:import`添加。`RAILS_ENV=production`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T17:29:32.430

我相信您正在寻找的是 rails runner [Rails Command Line Docs](http://guides.rubyonrails.org/command_line.html#rails-runner "导轨亚军")，它将在您的 rails 应用程序环境中执行您的 ruby​​ 脚本。

如果您只想在交互式命令 shell 中访问您的 rails 对象，您也可以使用 rails 控制台。通过**Rails 控制台**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T15:04:52.647

您也可以只要求您的 config/environment.rb 来访问您的模型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T03:57:58.020

**解决您的问题**

您的问题似乎是您的 Rails 环境未在脚本启动时加载。

要正确初始化 Rails 环境，您需要：

*   创建一个 Rake 任务并使其依赖于“环境”参见：
    *   [http://railscasts.com/episodes/66-custom-rake-tasks](http://railscasts.com/episodes/66-custom-rake-tasks)
*   通过 Rails 运行器启动您的脚本。看：
    *   [rails 3中的脚本/运行器](https://stackoverflow.com/questions/6241425/script-runner-in-rails-3)
    *   [http://railscasts.com/episodes/164-cron-in-ruby-revised](http://railscasts.com/episodes/164-cron-in-ruby-revised)
    *   [http://railscasts.com/episodes/164-cron-in-ruby](http://railscasts.com/episodes/164-cron-in-ruby)
*   或者您可以“手动”将所需文件添加到脚本中，但我不建议这样做，因为一旦升级 Rails 版本，它可能会中断

**更容易导入 CSV 的旁注**

我一直觉得将 CSV 文件作为 Arrays of Arrays 处理是非常笨拙的。

所以我写了一个小方法“process_csv”，它将CSV文件中的每一行作为哈希返回——更适合创建ActiveRecord或Mongoid记录。

您可以使用以下代码，并将其放在 下`./config/initializers/process_csv.rb`，并传递一个块来`process_csv`为 CSV 文件中的每一行创建一条消费者记录。

您可以使用 :key_mapping 选项将 CSV 列重命名为 ActiveRecord 模型的正确属性名称，还可以从结果哈希中删除 CSV 键。

**此处有详细注释的源代码：**

[http://www.unixgods.org/~tilo/Ruby/process_csv_as_hashes.html](http://www.unixgods.org/~tilo/Ruby/process_csv_as_hashes.html)

例如：

```
require 'process_csv'

File.process_csv( file ) do | hash |
   Consumer.create( hash )
end 
```

请享用！

# mysql - C运行查询显示命令不同步？

> ID：11509139
> 
> 赞同：1
> 
> 时间：2012-07-16T17:07:51.373
> 
> 标签：mysql, sql, c

我们正在运行一个 C 程序，其中每一秒都有一个函数回调。以下是列出的代码片段：

```
char timeBuf[10],secondBuf1[100],queryBuf1[500],queryBuf2[500];
char buff[20] = {0};
struct timeval tv;
gettimeofday (&tv, NULL);
tv.tv_sec -= 5;
strftime(buff, 20, "%Y-%m-%d %H:%M:%S", localtime(&tv.tv_sec));
printf("\nTime is %s", buff);

sprintf(secondBuf1,"INSERT INTO  secondsLog2 (secondLogID , timeStampID ) VALUES (NULL,'%s')",buff);
//printf("Query 1 before executing %s\n",queryBuf1);
if (mysql_query(localConn, secondBuf1)) 
{
    printf("Error in insert of seconds log %s\n",mysql_error(localConn));
    exit(1);
}

sprintf(queryBuf1,"SELECT ipDest, portDest, SUM(packetLen), COUNT(ipDest) FROM source1 WHERE timeStamp = '%s' GROUP BY portDest",buff);
printf("\nQuery buf %s",queryBuf1);
if(mysql_query(remoteConn, queryBuf1))
{
    printf("Error in first query of select %s\n",mysql_error(remoteConn));
    exit(1);
}
localRes1 = mysql_use_result(remoteConn);
while((localRow1 = mysql_fetch_row(localRes1)) !=NULL)
            {
              sprintf(queryBuf1,"INSERT INTO  export1 (iBTID ,timeStampID ,ipDest ,portDest,totalBits, packetCount) VALUES (NULL,'%s','%s','%s',%s,%s)",buff, localRow1[0],localRow1[1],localRow1[2],localRow1[3],localRow1[4]);
              printf("Query 1 before executing %s\n",queryBuf1);
              if (mysql_query(localConn, queryBuf1)) 
              {
                printf("Error in first query of insert %s\n",mysql_error(localConn));
                 exit(1);
              }

            }
                        mysql_free_result(localRes1); 
```

在我运行这个脚本的那一刻，第二个`SELECT`会给我这个错误：*命令不同步；您现在无法运行此命令*：

```
Time is 2012-07-17 00:59:14
Query buf SELECT ipDest, portDest, SUM(packetLen), COUNT(ipDest) FROM source1 WHERE timeStamp = '2012-07-17 00:59:14' GROUP BY portDest
Time is 2012-07-17 00:59:15
Query buf SELECT ipDest, portDest, SUM(packetLen), COUNT(ipDest) FROM source1 WHERE timeStamp = '2012-07-17 00:59:15' GROUP BY portDestError in first query of select Commands out of sync; you can't run this command now 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:24:43.013

您需要清除任何将返回结果的查询的结果集。如果您不使用结果，则只需调用：

```
MYSQL_RES *results;
results = mysql_store_result(localConn);
mysql_free_result(results); 
```

要使用您的结果，只需在返回结果的查询之后调用`mysql_store_result`(或`mysql_use_result`)，并确保`mysql_free_result`在稍后的某个时间使用它们。这应该可以清除任何`CR_COMMANDS_OUT_OF_SYNC`错误问题。

从[mysql_store_result](http://dev.mysql.com/doc/refman/5.6/en/mysql-store-result.html)的文档（强调添加）：

> 在调用 mysql_query() 或 mysql_real_query() 之后，**必须**为每个成功生成结果集的语句（SELECT、SHOW、DESCRIBE、EXPLAIN、CHECK TABLE 等）调用 mysql_store_result() 或 mysql_use_result()。完成结果集后，还必须调用 mysql_free_result()。

# touch - 人机界面设备的触摸屏采样率

> ID：11509140
> 
> 赞同：0
> 
> 时间：2012-07-16T17:07:57.077
> 
> 标签：touch, sample-rate

对于人机界面设备可接受的触摸采样率，什么是好的经验法则？

例如，众所周知，60Hz 的视觉屏幕刷新率处于人类感知的上限。触摸采样率是否有类似的数字，以便交互对“典型”人类而言是“即时的”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T13:09:25.297

我正在寻找这个问题的答案。当我偶然发现有人在 github 更改期间给出了答案时：

[https://github.com/pershoot/gtab-2632/issues/1](https://github.com/pershoot/gtab-2632/issues/1)

“触摸屏采样率为 25Hz，这使得滚动、使用解锁屏幕、下拉抽屉等在有效帧速率降低到 25fps 时显得生涩。这种变化将采样率提高到 100Hz，感觉很棒。我没有”还没有时间测试其他采样率，但大概 15 毫秒的睡眠也应该是好的（对于 60-75Hz 的标记）。

我自己的经验支持这个结论。

# python - Python multiprocessing.Pool 在 Windows 上很奇怪

> ID：11509145
> 
> 赞同：0
> 
> 时间：2012-07-16T17:08:07.473
> 
> 标签：python, windows, multiprocessing, pool

我有一个在这里定义的超级简单的python脚本

```
import multiprocessing
from multiprocessing import Pool

print "CPUs: " + str(multiprocessing.cpu_count())
convertPool = Pool(multiprocessing.cpu_count()) 
```

在 Linux 上，这似乎与我预期的一样，程序刚刚启动，然后打印出内核数，然后退出。但是，在 Windows 上，该程序将继续调用新的 python 命令并打印出“CPUs: 4”（我有 4 个内核）并且永远不会停止运行并最终会杀死该框。有人可以解释一下这里发生了什么吗？

谢谢

编辑：我现在有以下程序，但仍然无法按预期运行

```
import sys
import os
import subprocess
from subprocess import Popen, PIPE
from threading import Thread
import multiprocessing
from multiprocessing import Pool, freeze_support

try:
    from Queue import Queue, Empty
except ImportError:
    from queue import Queue, Empty  # python 3.x

ON_POSIX = "posix" in sys.builtin_module_names

def myPrint(line, logWriter):
    if logWriter is None:
        # This will print without a newline, cause the process
        # has its own newlines
        sys.stdout.write(line)
    else:
        logWriter.write(line.strip())
        logWriter.write("\n")
        logWriter.flush()

# This is gotten from http://stackoverflow.com/questions/375427/non-blocking-read-on-a-subprocess-pipe-in-python
def executeCommand(cmd, logWriter):
   myPrint(cmd + "\n", logWriter)
    p = Popen(cmd, stdout=PIPE, bufsize=4096, close_fds=ON_POSIX, shell=True)
    q = Queue()
    t = Thread(target=enqueue_output, args=(p.stdout, q))
    t.daemon = True # thread dies with the program
    t.start()

    # read line without blocking
    while t.isAlive() or not q.empty():
        try:
            line = q.get_nowait() # or q.get(timeout=.1)
        except Empty:
            pass # Do nothing
        else: # If there is a line, then print it 
            if logWriter is not None:
                myPrint(line, logWriter)
        # Sleep to prevent python from using too much cpu
        time.sleep(0.05)

if __name__ == "__main__":
    freeze_support()
    convertPool = Pool(multiprocessing.cpu_count())
    # Now let's smooth and threshold all the masks
    for foo in bar:
        threshSmoothCmd = "ConvertImage.exe -i " + foo + " -o " + foo
        myPrint(threshSmoothCmd + "\n", None)
        convertPool.apply_async(executeCommand,(threshSmoothCmd, None,))

    convertPool.close()
    convertPool.join()
print "Finished processing" 
```

ConvertImage.exe 是我自己编写的可执行文件 foo 和 bar 只是占位符。在 Linux 上，这将启动 multiprocessing.cpu_count() 数量的 ConvertImage.exe 进程，然后在所有 ConvertImage.exe 进程完成后打印 Finished processing。在 Windows 上，这会立即启动 len(bar) ConvertImage.exe 进程，然后立即打印 Finished processing 并退出。如何让 Windows 版本表现得像 Linux 版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:07:28.653

我弄清楚了，它工作正常，我的示例程序发布错误，因为我忘记了一些导入并导致了所描述的行为。在我得到正确的所有导入之后，这个示例在 Windows 和 Linux 上运行良好。

# java - 导入 javax.naming.context 还是 org.apache.catalina.Context？

> ID：11509146
> 
> 赞同：0
> 
> 时间：2012-07-16T17:08:10.077
> 
> 标签：java, tomcat, servlets, netbeans, database-connection

我正在尝试在`Tomcat7`容器中实现数据池。我的理解是我必须使用以下代码来检索数据连接

```
 Context initContext;
        DataSource datasource = null;
        try {
            initContext = new InitialContext();
            Context envContext = (Context) initContext.lookup("java:/comp/env");
            datasource = (DataSource) envContext.lookup("jdbc/bolsms");
        } catch (NamingException ex) {
            Logger.getLogger(ReceiveC2DMRegistration.class.getName()).log(Level.SEVERE, null, ex);
        } 
```

**我的问题**

因为`Context`我必须导入`javax.naming.context`or`org.apache.catalina.Context`并且`DataSource`我必须导入`javax.sql.DataSource`or`org.apache.tomcat.jdbc.pool.DataSource`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T12:30:01.000

声明针对 Tomcat 特定的类/接口将使您的 webapp 与 Tomcat 紧密耦合，从而使其无法在其他服务器上运行。你不想拥有那个。

始终尽可能针对标准 Java SE/EE 类/接口进行声明。这样，您的 web 应用程序将可移植到所有服务器品牌（Tomcat、Glassfish、JBoss AS、Jetty 等）。

# mysql - MySQL 统计问题公式

> ID：11509151
> 
> 赞同：1
> 
> 时间：2012-07-16T17:08:19.793
> 
> 标签：mysql, statistics

我正在尝试查看问题统计信息的组成。

我正在计算问题的 QPS 图和总和的 QPS 图：

*   `Com_select`
*   `Com_update`
*   `Com_delete`
*   `Com_replace_select`
*   `Com_set_option`
*   `Com_begin`
*   `Com_commit`

基本上所有非零 Com_* 统计信息。但我仍然有高达 200 QPS 的图表差异。

有谁知道没有考虑到什么？

我正在使用 4.1.22 版本的 MySQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T02:02:33.530

我对此做了一些测试。我才知道我们又错过了一个重要的计数。

那就是**Qcache_hits**

将其包含在列表中，您将在两个地方看到几乎相似的计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:05:19.160

“退出”也被考虑在内。我找不到它的文档，但已经测试过它可以工作：

首先，我发出两个连续的检查`Questions`来测试测试本身：

```
root@mysql-5.1.51> show global status like 'questions';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| Questions     | 21113 |
+---------------+-------+

root@mysql-5.1.51> show global status like 'questions';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| Questions     | 21114 |
+---------------+-------+ 
```

因此，像这样的每次调用都会使 +1 on `Questions`-- 我们将在未来的测试中减少它。

现在，我退出了一个活动会话，然后再次测试：

```
root@mysql-5.1.51> show global status like 'questions';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| Questions     | 21116 |
+---------------+-------+ 
```

我确保启用常规日志以测试 Quit 操作没有发出任何有趣的查询——它不是。

我不确定是否还有其他需要考虑的操作。

顺便说一句，从**5.0.72**和**5.1.31 开始**，规则发生了变化。[阅读本文](http://code.openark.org/blog/mysql/questions-or-queries)了解更多信息。

# ruby-on-rails - 使用 :method => :delete 链接块

> ID：11509157
> 
> 赞同：-2
> 
> 时间：2012-07-16T17:08:50.453
> 
> 标签：ruby-on-rails, ruby-on-rails-3

如您所知，您可以将块传递给 link_to，例如：

```
<%= link_to new_post_path do %>
html stuff here
<% end %> 
```

现在我的问题是您是否能够使用 :method => :delete 将块传递给 link_to 方法，例如

```
<%= link_to @post, :method => :delete, do %>
html stuff here
<% end %> 
```

好吧，我不知道这是否可能......有人对此有更多了解或有正确的语法吗？

已经感谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:16:17.817

是的，它们是一样的。路径生成控制器：action

删除后你只有一个额外的逗号

```
<%= link_to @post, :method => :delete do %>
   <!-- html stuff here -->
   <div style="height:200px;background-color: red;">
      My Div
   </div>
<% end %> 
```

# ios - 来自 URL 的 YouTube 视频 ID - Swift 或 Objective-C

> ID：11509164
> 
> 赞同：23
> 
> 时间：2012-07-16T17:09:41.417
> 
> 标签：ios, swift, objective-c

我有一个 Youtube url 作为 an `NSString`or Swift `String`，但我需要提取显示在 url 中的视频 ID。我找到了许多关于[如何在 php 或其他基于 Web 的编程语言中执行此操作的](https://stackoverflow.com/questions/3452546/how-do-i-get-the-youtube-video-id-from-a-url)教程，但在 Apple 平台的 Objective-C 或 Swift 中没有找到...

我正在寻找一种要求 NSString url 作为参数并将视频 ID 作为另一个 NSString 返回的方法...

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2015-01-06T10:06:01.550

这是 RegExp 它涵盖了这些情况 ![](../Images/00dba7f01b4f837136238cac4c71e9d9.png)

目标 C

```
- (NSString *)extractYoutubeIdFromLink:(NSString *)link {
    NSString *regexString = @"((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)";
    NSRegularExpression *regExp = [NSRegularExpression regularExpressionWithPattern:regexString
                                                                            options:NSRegularExpressionCaseInsensitive
                                                                              error:nil];

    NSArray *array = [regExp matchesInString:link options:0 range:NSMakeRange(0,link.length)];
    if (array.count > 0) {
        NSTextCheckingResult *result = array.firstObject;
        return [link substringWithRange:result.range];
    }
    return nil;
} 
```

迅速

```
func extractYoutubeIdFromLink(link: String) -> String? {
    let pattern = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)"
    guard let regExp = try? NSRegularExpression(pattern: pattern, options: .CaseInsensitive) else {
        return nil
    }
    let nsLink = link as NSString
    let options = NSMatchingOptions(rawValue: 0)
    let range = NSRange(location: 0,length: nsLink.length)
    let matches = regExp.matchesInString(link as String, options:options, range:range)
    if let firstMatch = matches.first {
        return nsLink.substringWithRange(firstMatch.range)
    }
    return nil
} 
```

斯威夫特 3

```
func extractYoutubeIdFromLink(link: String) -> String? {
    let pattern = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)"
    guard let regExp = try? NSRegularExpression(pattern: pattern, options: .caseInsensitive) else {
        return nil
    }
    let nsLink = link as NSString
    let options = NSRegularExpression.MatchingOptions(rawValue: 0)
    let range = NSRange(location: 0, length: nsLink.length)
    let matches = regExp.matches(in: link as String, options:options, range:range)
    if let firstMatch = matches.first {
        return nsLink.substring(with: firstMatch.range)
    }
    return nil
} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-01-02T20:56:29.183

在花了很长时间试图找到正则表达式的正确语法之后，我遇到了这个对我有帮助的东西。

```
NSString *regexString = @"(?<=v(=|/))([-a-zA-Z0-9_]+)|(?<=youtu.be/)([-a-zA-Z0-9_]+)"; 
```

取自[这里](http://RegExr.com?2tsac)。这适用于以下 URL 格式：

> ```
>  - www.youtube.com/v/VIDEOID  
>  - www.youtube.com?v=VIDEOID
>  - http://www.youtube.com/watch?v=KFPtWedl7wg&feature=youtu.be
>  - http://www.youtube.com/watch?v=MkTD2Y4LXcM 
>  - youtu.be/KFPtWedl7wg_U923
>  - http://www.youtube.com/watch?feature=player_detailpage&v=biVLGTAMC_U#t=31s 
> ```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-07-16T18:14:08.157

所以一个 YouTube URL 看起来像这样：

```
http://www.youtube.com/watch?v=oHg5SJYRHA0 
```

您感兴趣的视频 ID 是末尾部分 ( `oHg5SJYRHA0`).... 虽然不一定在末尾，因为 YouTube URL 可以在查询字符串中包含其他参数。

您最好的选择可能是使用正则表达式和 Foundation 的[`NSRegularExpression`](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)类。我认为这种方法已在您找到的其他语言教程中使用 - 请注意，正则表达式的内容在任何包含它们的语言或工具包中都几乎相同，因此在这些教程中找到的任何正则表达式都应该工作为你。（我建议您不要使用`v=`11 个字符的方法，因为这很容易导致正则表达式更健壮的各种失败模式。）

要查找视频 ID，您可能需要像`v=([^&]+)`. 将`v=`我们带到查询 URL 的正确部分（如果我们得到类似的东西`watch?fmt=22&v=oHg5SJYRHA0`）。括号构成一个*捕获组*，因此我们可以仅提取视频 ID 而不是我们用来查找它的其他匹配字符，并且在括号内我们查找一个或多个不是 & 字符的序列 - 这确保我们会在该`v=whatever`字段中获取所有内容，如果您获得类似`watch?v=oHg5SJYRHA0&rel=0`.

无论您使用此正则表达式还是其他正则表达式，您都可能会使用捕获组。（如果没有，[`rangeOfFirstMatchInString:options:range:`](https://developer.apple.com/library/mac/documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html#//apple_ref/occ/instm/NSRegularExpression/rangeOfFirstMatchInString:options:range:)这几乎就是您所需要的，如 Dima 的回答所示。）您可以使用或类似方法获取捕获组（作为[`NSTextCheckingResult`](https://developer.apple.com/library/mac/documentation/AppKit/Reference/NSTextCheckingResult_Class/Reference/Reference.html#//apple_ref/occ/cl/NSTextCheckingResult)对象）的内容：[`firstMatchInString:options:range:`](https://developer.apple.com/library/mac/documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html#//apple_ref/occ/instm/NSRegularExpression/firstMatchInString:options:range:)

```
NSError *error = NULL;
NSRegularExpression *regex = 
[NSRegularExpression regularExpressionWithPattern:@"?.*v=([^&]+)"
                                          options:NSRegularExpressionCaseInsensitive
                                            error:&error];
NSTextCheckingResult *match = [regex firstMatchInString:youtubeURL
                                                options:0
                                                  range:NSMakeRange(0, [youtubeURL length])];
if (match) {
    NSRange videoIDRange = [match rangeAtIndex:1];
    NSString *substringForFirstMatch = [youtubeURL substringWithRange:videoIDRange];
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-07-16T17:51:14.863

您可能看到的教程只是关于如何使用正则表达式的说明，这也是您在这种情况下要使用的内容。

您需要使用的 Cocoa 类是[NSRegularExpression](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)。

您的实际正则表达式字符串将取决于您期望 url 采用的格式，因为它看起来像 youtube 有几个。一般功能将如下所示：

```
+ (NSString *)extractYoutubeID:(NSString *)youtubeURL
{
  NSError *error = NULL;  
  NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"your regex string goes here" options:NSRegularExpressionCaseInsensitive error:&error];
  NSRange rangeOfFirstMatch = [regex rangeOfFirstMatchInString:youtubeURL options:0 range:NSMakeRange(0, [youtubeURL length])];
  if(!NSEqualRanges(rangeOfFirstMatch, NSMakeRange(NSNotFound, 0)))
  {
    NSString *substringForFirstMatch = [youtubeURL substringWithRange:rangeOfFirstMatch];

    return substringForFirstMatch;
  }
  return nil;
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-07-22T22:12:03.947

你甚至不需要正则表达式。无论视频 ID 的长度及其在 URL 中的位置如何，以下操作均有效：

```
NSString *vID = nil;
NSString *url = @"http://www.youtube.com/watch?v=cAcqdjLCN7s";

NSString *query = [url componentsSeparatedByString:@"?"][1];
NSArray *pairs = [query componentsSeparatedByString:@"&"];
for (NSString *pair in pairs) {
    NSArray *kv = [pair componentsSeparatedByString:@"="];
    if ([kv[0] isEqualToString:@"v"]) {
        vID = kv[1];
        break;
    }
}

NSLog(@"%@", vID); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-01-14T11:27:44.293

基于这个答案：[PHP Regex to get youtube video ID?](https://stackoverflow.com/a/17030234/1393275)

我为 c/objc/c++ 字符串改编了一个正则表达式，这里的重要部分是正则表达式不会从 facebook 或其他服务获取视频。iOS 正则表达式基于：[ICU](http://userguide.icu-project.org/strings/regexp)

```
NSString *regexString = @"^(?:http(?:s)?://)?(?:www\\.)?(?:m\\.)?(?:youtu\\.be/|youtube\\.com/(?:(?:watch)?\\?(?:.*&)?v(?:i)?=|(?:embed|v|vi|user)/))([^\?&\"'>]+)";

NSError *error;
NSRegularExpression *regex =
[NSRegularExpression regularExpressionWithPattern:regexString
                                          options:NSRegularExpressionCaseInsensitive
                                            error:&error];
NSTextCheckingResult *match = [regex firstMatchInString:message
                                                options:0
                                                  range:NSMakeRange(0, [message length])];

if (match && match.numberOfRanges == 2) {
    NSRange videoIDRange = [match rangeAtIndex:1];
    NSString *videoID = [message substringWithRange:videoIDRange];

    return videoID;
} 
```

火柴：

```
- youtube.com/v/vidid
- youtube.com/vi/vidid
- youtube.com/?v=vidid
- youtube.com/?vi=vidid
- youtube.com/watch?v=vidid
- youtube.com/watch?vi=vidid
- youtu.be/vidid
- youtube.com/embed/vidid
- http://youtube.com/v/vidid
- http://www.youtube.com/v/vidid
- https://www.youtube.com/v/vidid
- youtube.com/watch?v=vidid&wtv=wtv
- http://www.youtube.com/watch?dev=inprogress&v=vidid&feature=related
- https://m.youtube.com/watch?v=vidid 
```

不匹配：

```
- www.facebook.com?wtv=youtube.com/v/vidid
- https://www.facebook.com/video.php?v=10155279523025107 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-10-04T07:33:08.743

```
- (NSString*)getYoutubeVideoID:(NSString*)url {
    NSError *error = NULL;
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"(?<=watch\\?v=|/videos/|embed\\/)[^#\\&\\?]*"
                                              options:NSRegularExpressionCaseInsensitive
                                                error:&error];

    NSTextCheckingResult *match = [regex firstMatchInString:url
                                                    options:0
                                                      range:NSMakeRange(0, [url length])];
    NSString *substringForFirstMatch;
    if (match) {
        NSRange videoIDRange = [match rangeAtIndex:0];
        substringForFirstMatch = [url substringWithRange:videoIDRange];
    }
    return substringForFirstMatch;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-02-28T06:45:24.383

我使用投票最高的答案来编写更好、更严格的正则表达式。

```
NSString *regex = @"(?:youtube.com.+v[=/]|youtu.be/)([-a-zA-Z0-9_]+)"; 
```

然后你就可以拿到身份证了

```
NSTextCheckingResult *match = [regex firstMatchInString:url
                                                options:0
                                                  range:NSMakeRange(0, [url length])];
NSRange videoIDRange = [match rangeAtIndex:1];
NSString *youTubeID = [url substringWithRange:videoIDRange]; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-07-22T22:05:56.320

这是我从 StackOveFlow 引用的解决方案。（[新 URL 格式的 Youtube ID 解析](https://stackoverflow.com/questions/7693218/youtube-i-d-parsing-for-new-url-formats)）

我做了一些修改。

///这是.h

```
#import <Foundation/Foundation.h>
@interface YoutubeParser : NSObject

+(BOOL) isValidateYoutubeURL:(NSString * )youtubeURL;

+(NSArray *) parseHTML:(NSString *)html ;

@end

///This is the .m 
#import "YoutubeParser.h"

@interface YoutubeParser () {
}

@end

@implementation YoutubeParser

#define YOUTUBE_PATTERN @"(https?://)?(www\\.)?(youtu\\.be/|youtube\\.com)?(/|/embed/|/v/|/watch\\?v=|/watch\\?.+&v=)([\\w_-]{11})(&.+)?"

+(NSRegularExpression *)regex {

    static NSRegularExpression * regex = nil;

    regex =     [NSRegularExpression regularExpressionWithPattern:YOUTUBE_PATTERN
                                                               options:NSRegularExpressionCaseInsensitive
                                                                 error:nil];
    return regex;
}

+(BOOL) isValidateYoutubeURL:(NSString * )youtubeURL {
    NSInteger cnt = [[YoutubeParser regex] numberOfMatchesInString:youtubeURL options:0 range:NSMakeRange(0, [youtubeURL length])  ];

    return cnt > 0 ? YES : NO;
}

typedef void (^matching_block_t)  (NSTextCheckingResult *result, NSMatchingFlags flags, BOOL *stop);

+(NSArray *) parseHTML:(NSString *)html {
    NSMutableArray * youtubeURLArray = [[NSMutableArray alloc] init];

    matching_block_t parseTask = ^(NSTextCheckingResult *result, NSMatchingFlags flags, BOOL *stop) {
        NSRange matchRange = [result range];
        NSRange youtubeKey = [result rangeAtIndex:5]; //the youtube key
        NSString * strKey = [html substringWithRange:youtubeKey] ;
        NSLog(@"youtubeKey=%@ , with url=%@ " ,strKey , [html substringWithRange:matchRange]);

        [youtubeURLArray addObject:strKey];
    };

    [[YoutubeParser regex] enumerateMatchesInString:html   options:0   range:NSMakeRange(0, [html length])   usingBlock:parseTask ];

    return youtubeURLArray;
}

@end 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-04-11T04:08:59.960

这里有很多很好的答案，但我认为从字符串中解析多个**video_ID可能对某些人有益。**这可能是一个网页或一组不同的 URL。

页面内容示例

```
NSString *content = @"http://www.youtube.com/user/Scobleizer#p/u/1/1p3vcRhsYGo,http://youtu.be/NLqAF9hrVbY,http://www.youtube.com/watch?v=NLqAF9hrVbY,http://facebook.com,http://www.youtube.com/watch?v=cAcqdjLCN7s"; 
```

方法

```
-(NSArray *)extractVideos:(NSString *)content {
    NSString *extractRegex = @"(?<=v(=|/))([-a-zA-Z0-9_]+)|(?<=youtu.be/)([-a-zA-Z0-9_]+)"
    NSMutableArray *extractedContent = [[NSMutableArray alloc] init];
    if ([content hasPrefix:@"http://"] || [content hasPrefix:@"https://"]) {
        NSURL *extractURL = [NSURL URLWithString:content];
        if ([extractURL.host rangeOfString:@"youtu"].location != NSNotFound) {
            NSRegularExpression *extractRegex = [NSRegularExpression regularExpressionWithPattern:extractRegex options:NSRegularExpressionCaseInsensitive error:nil];
            NSArray *extractResults = [extractRegex matchesInString:content options:0 range:NSMakeRange(0, content.length)];
            for (NSTextCheckingResult *match in extractResults) {
                [extractedContent addObject:[content substringWithRange:match.range]];

            }

        }

    }

    return extractedContent;

} 
```

输出

```
( 
    NLqAF9hrVbY,
    QLqAF9eeVbY,
    cAcqdjLCN7s
) 
```

归功于 @Alex 的正则表达式

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-11-11T11:35:23.547

合并您的一些答案，我会说这是最好的答案：

```
+ (NSString *)extractYoutubeID:(NSString *)youtubeURL
{
    NSError *error = NULL;
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"(?<=v(=|/))([-a-zA-Z0-9_]+)|(?<=youtu.be/)([-a-zA-Z0-9_]+)"
                                                                           options:NSRegularExpressionCaseInsensitive
                                                                             error:&error];
    NSRange rangeOfFirstMatch = [regex rangeOfFirstMatchInString:youtubeURL options:NSMatchingReportProgress range:NSMakeRange(0, [youtubeURL length])];
    if(rangeOfFirstMatch.location != NSNotFound) {
        NSString *substringForFirstMatch = [youtubeURL substringWithRange:rangeOfFirstMatch];

        return substringForFirstMatch;
    }

    return nil;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-25T10:10:57.233

**@Alex 答案的**Swift 2版本****

 **```
func getYoutubeVideoId(youtubeLink:String) -> String?{
    var youtubeId:String? = nil
    let pattern: String = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)"
    do {
        let regex = try NSRegularExpression(pattern: pattern, options: .CaseInsensitive)
        if let regexMatch = regex.firstMatchInString(youtubeLink, options: NSMatchingOptions(rawValue: 0), range: NSRange(location: 0, length: youtubeLink.characters.count)) {
            youtubeId = (youtubeLink as NSString).substringWithRange(regexMatch.range)
        }
    }
    catch let error as NSError{
        print("Error while extracting youtube id \(error.debugDescription)")
    }

    return youtubeId
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-04-04T12:14:46.817

**更新斯威夫特 4：**

```
static func extractYoutubeVideoId(from url: String) -> String? {
    let pattern = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)"
    guard let range = url.range(of: pattern, options: .regularExpression) else { return nil }
    return String(url[range])
} 
```

*旧答案：*
@Alex 的 Swift 3 答案更快捷，不使用 NSString：
我们可以强制尝试正则表达式，因为我们知道它是有效的。

```
static func extractYoutubeVideoId(from url: String) -> String? {
    let pattern = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)"
    let regex = try! NSRegularExpression(pattern: pattern, options: [.caseInsensitive])
    let range = NSRange(location: 0, length: url.utf16.count)
    guard let firstMatch = regex.firstMatch(in: url, options: .init(rawValue: 0), range: range) else { return nil }
    let start = String.UTF16Index(firstMatch.range.location)
    let end = String.UTF16Index(firstMatch.range.location + firstMatch.range.length)
    return String(url.utf16[start..<end])
} 
```

或者，如果你仍然想要 NSString：

```
static func extractYoutubeVideoId(from url: String) -> String? {
    let pattern = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)"
    let regex = try! NSRegularExpression(pattern: pattern, options: [.caseInsensitive])
    let range = NSRange(location: 0, length: (url as NSString).length)
    guard let firstMatch = regex.firstMatch(in: url, options: .init(rawValue: 0), range: range) else { return nil }
    return (url as NSString).substring(with: firstMatch.range)
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-01-14T18:59:27.730

这是使用@jt_ik 正则表达式的快速版本：

```
func extractYoutubeID(youtubeURL: String) -> String {
    var error: NSError?
    let pattern: String = "(?<=v(=|/))([-a-zA-Z0-9_]+)|(?<=youtu.be/)([-a-zA-Z0-9_]+)"
    let regex = NSRegularExpression(pattern: pattern, options: .CaseInsensitive, error: &error)!

    if error == nil {
        if let regexMatch = regex.firstMatchInString(youtubeURL, options: nil, range: NSRange(location: 0, length: youtubeURL.utf16Count)) {
            return (youtubeURL as NSString).substringWithRange(regexMatch.range)
        }
        // Handle no match here
        return ""
    } else {
        // Handle error here
        println(error?.userInfo)
        return ""
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-08T16:29:31.533

**@Alex 答案的**Swift 3版本****

 **```
func extractYoutubeIdFromLink(link: String) -> String? {
    let pattern = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/))([\\w-]++)"
    guard let regExp = try? NSRegularExpression(pattern: pattern, options: .caseInsensitive) else {
        return nil
    }
    let nsLink = link as NSString
    let options = NSRegularExpression.MatchingOptions(rawValue: 0)
    let range = NSRange(location: 0,length: nsLink.length)
    let matches = regExp.matches(in: link as String, options:options, range:range)
    if let firstMatch = matches.first {
        debugPrint(firstMatch)
        return nsLink.substring(with: firstMatch.range)
    }
    return nil
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-07-31T05:27:08.127

**斯威夫特 5**

这是我正在使用的最新工作版本。我还添加了对 YouTube 短视频的支持。前任：`https://youtube.com/shorts/2xL2WlQM7Nc`

```
extension String{
  func extractYoutubeId() -> String? {
    let pattern = "((?<=(v|V)/)|(?<=be/)|(?<=(\\?|\\&)v=)|(?<=embed/)|(?<=shorts/))([\\w-]++)"
    if let matchRange = self.range(of: pattern, options: .regularExpression) {
        return String(self[matchRange])
    } else {
        return .none
    }
  }
} 
```

例子：

```
let ytShortVideoLink = "https://youtube.com/shorts/2xL2WlQM7Nc"
print("Video ID:",ytShortVideoLink. extractYoutubeId())
//Output: 
Video ID: 2xL2WlQM7Nc 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2012-07-16T18:02:38.630

我自己想通了...

```
NSArray *videoURLSplit = [videoURL componentsSeparatedByString:@"v="];
NSString *videoID = [[videoURLSplit objectAtIndex:1] substringToIndex:11];
NSLog(@"%@",videoID); 
```

非常简单...所有视频 url 都包含 v=VIDEO_ID 我只是将 url 分成一个数组，然后取 v= 之后的前 11 位数字，因为 url 中可能有更多 http GET 信息...

感谢您的帮助！****

# c++ - 如何设置仅对不同类派生的类可见的方法？

> ID：11509167
> 
> 赞同：0
> 
> 时间：2012-07-16T17:09:50.637
> 
> 标签：c++

我正在为我的 OpenGL 游戏创建小 GUI。我有两个基类`Widget`和`Container`. `Widget`类有类似`setPosition(x,y)`, `setSize(w,h)`,... 的方法 这些方法应该只对从 . 派生的类可见`Container`。

**编辑：**我可以用朋友和包装器方法来做，但我想不用包装器来做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:56:58.953

如果评论中的建议不清楚，您可以考虑使用该方法的子集创建一个接口，并在`Widget`. 然后使用一个受保护的（单个操作）`Container`来获取从它派生的类的私有接口：

```
struct Drawable {    // choose a better name
  virtual void setPosition( int x, int y );
  virtual void setSize( int w, int h );
  virtual ~Drawable() {}
};
class Widget : private Drawable {
   friend class Container;
};
class Container {
protected:
    Drawable& getDrawable( Widget& w ) { return w; };
};
class MyContainer : public Container {
   void changeSize( Widget & w ) {
      getDrawable(w).setSize(10,20);
   }
}; 
```

转发选项的主要区别在于，它可以更好地扩展功能数量并且更易于维护（无需更新 N 转发器，只需访问正确接口的访问器）。

从高级设计的角度来看， a`Widget`不是`Drawable`一般的，它只是`Drawable`来自`Widget`or的上下文`Container`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:21:37.087

我害怕写这个答案，因为它看起来太明显了，但你不能让`setPosition(x,y)`和`setSize(w,h)`成员`Container`吗？

或者，如果存在某种未知的复杂性，您可以将 a`WidgetContainer`作为基类并将这些方法放入该类中吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:28:55.693

在我看来，这是“我能做些什么让另一个程序员在做错事时感到肮脏”的情况之一：语言没有很好地处理它，所以你不想过分限制您的代码，因为这往往会使事情变得混乱。在我看来，Friend-container-delegate 设置只会让那些试图在日常“这是如何工作”的情况下弄清楚你的代码的人感到困惑。你想让在“我需要破解这个”的情况下更难滥用你的代码。

我要做的可能是简单的文档以及调用（公共）函数`_setPosition`和`_setSize`. 下划线将（希望）让其他程序员去，“wha???” 并阅读您的文档 - 这将准确解释为什么非`Container`s 调用这些函数是一个非常糟糕的主意。

这有点难看，但这就是*重点*。`rect._setPosition`如果不了解发生了什么，我肯定会感到肮脏。这是一种心理解决方案，但在缺乏访问保护设施的其他语言（如 Javascript）中大量使用，因此并没有那么不寻常，以至于丑得可怕。或者至少，不会比试图在语言特性中指定您的要求更丑陋:)

# c++ - OpenCV GPU 库使用

> ID：11509171
> 
> 赞同：1
> 
> 时间：2012-07-16T17:10:00.263
> 
> 标签：c++, opencv, cuda

OpenCV GPU 库可以在非 Nvidia GPU 中使用吗？我问这个是因为常见问题页面是指 CUDA。可以在Videocore GPU核心中使用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:11:23.693

> OpenCV GPU 模块是一组利用 GPU 计算能力的类和函数。它使用 NVIDIA* CUDA* Runtime API 实现，仅支持 NVIDIA GPU。

来自：[http ://docs.opencv.org/modules/gpu/doc/introduction.html](http://docs.opencv.org/modules/gpu/doc/introduction.html)

# html - Internet Explorer 8 的 CSS 问题

> ID：11509180
> 
> 赞同：1
> 
> 时间：2012-07-16T17:10:34.287
> 
> 标签：html, css, internet-explorer-8

我只有**Internet Explorer 8**有问题。

我不知道为什么要添加我做的网站的链接（我是新手）：

[网站](http://www.premiosfundacionaffinity.org) 如果您在 IE8 中单击“Candidaturas”，您会看到文本已损坏，样式不起作用，在 IE9、Firefox、Chrome、Safari 中……运行良好……我不知道为什么。

```
div#candidaturas div#content div#columna h8 {
   margin : 0;
   padding : 0;
   text-align : left;
   font-family : Arial;
   font-size : 11px;
   font-variant : normal;
   color : #555;
}

div#candidaturas div#content div#columna h7 {
   text-align : left;
   font-family : Arial;
   font-size : 14px;
   font-weight : bold;
   font-variant : normal;
   color : #ff6b00;
} 
```

有谁能够帮助我？

谢谢你们！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:23:05.287

没有`h7`和之类的标题`h8`。只有`h1`- `h6`。IE8 和 IE7 不理解未知元素，也不给它们设置样式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T17:22:36.083

您不能有多个具有相同 id 的 div。

您应该使用 class *.columna*而不是 id *#columna*。

这将解决您的问题以及其他潜在的未来问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:26:52.557

IE8 is likely not recognizing `h7` and `h8` tags because they are not a standard. Only up to `h6` is standard. Also you have multiple Divs with the same ID. Divs have to have unique identifiers. Classes can have multiple instances.

# c# - 解决方案 VS2010 中不同项目中的程序集列表

> ID：11509187
> 
> 赞同：0
> 
> 时间：2012-07-16T17:10:53.320
> 
> 标签：c#, visual-studio-2010, assemblies

我的解决方案（VS2010）有很多项目。

在运行时，如何获取给定项目中所有程序集的列表？

我可以通过以下代码行获取调用代码项目中所有程序集的列表。

```
Assembly assembly in AppDomain.CurrentDomain.GetAssemblies() 
```

如何获取与调用代码项目不同的项目中的程序集列表？

请帮忙。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:15:39.723

解决方案可能包含您当前正在执行的项目未引用的项目。我不知道是否有可靠的方法来检索这些。

但是，如果您的调用程序集确实包含对其他项目的引用，您可以遍历[myAssembly.GetReferencedAssemblies()](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getreferencedassemblies)数组。请注意，这还将包括引用的框架程序集。

# javascript - jQuery.tabs() 触发了两个 docready() 事件；

> ID：11509192
> 
> 赞同：0
> 
> 时间：2012-07-16T17:11:23.103
> 
> 标签：javascript, jquery

**问题：**当文档准备好时，jQuery 将触发下面的选项卡功能。然后在选项卡完成后，它会再次触发文档就绪功能。什么是只触发一次文档就绪功能的好方法？谢谢！

```
$(document).ready(function() {
  $("#index-tabs").tabs({
      cache: true
  }, {
      idPrefix: 'ui-tabs-index'
  });
}); 
```

我的标签：

```
<ul id="index-tablist">
    <li id="index-config-tab" class="frstTab"><a href="ajax/config.html" >Config</a></li>
    <li id="index-system-tab"><a href="ajax/system.html" >System</a></li>
    <li id="index-wizard-tab"><a href="ajax/wizard.html" >Wizard</a></li>
</ul> 
```

**更新：**我尝试使用 load 参数来指定要加载的函数。但是由于某种原因，当执行 tabs() 时，它会重新加载索引并执行两次 tabs 函数。

```
$("#index-tabs").tabs({
        load:initScripts,
        cache: true
    }, {
        idPrefix: 'ui-tabs-index'
});
function initScripts(){
    alert('run this code once'); // This alerts twice for some reason.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:25:46.083

您应该知道 ready 事件不能多次触发。正在发生的事情是您在 ready 中的语句被执行了两次（仔细看，它们不是一回事）。

在 Chrome 的检查器或 Firebug 脚本面板中，在准备好的条目上放置一个断点，并跟踪页面加载的流程。您将很容易看到导致语句执行两次的原因。（5分钟练习）。

你可以放心，ready 不会触发多次。

# java - 将输入流转换为 JSONArrary 时出现空异常

> ID：11509195
> 
> 赞同：3
> 
> 时间：2012-07-16T17:11:36.003
> 
> 标签：java, android, json, wcf, arrays

我有一个 Android 应用程序尝试使用返回对象列表的 WCF 服务。流读取正确，但在尝试将字符串转换为 JSONArray 时抛出空 JSONException。我检查了 JSON 验证器上的 JSON 响应，这接缝没问题。

我的 WCF 服务合同：

```
 [ServiceContract]
   public interface IAndroidWebService
    {
        [OperationContract]
        [WebGet(UriTemplate = "AndroidGetTenants",
            BodyStyle = WebMessageBodyStyle.WrappedRequest,
            ResponseFormat = WebMessageFormat.Json,
            RequestFormat = WebMessageFormat.Json)]
        List<TenantEntity> AndroidGetTenants();
    } 
```

调用它时生成的 JSON 响应：

```
[{"MaxVotesPerSecond":0,"Name":"Duurzaam OV","PartitionKey":"a63569b9-e794-4674-832b-46e85de0dc0a","RowKey":"02f1654c-9746-4da5-a146-bff7fe611468"},
    {"MaxVotesPerSecond":0,"Name":"Overheid","PartitionKey":"e38f3d93-5b4d-41e9-8513-3fd350a019af","RowKey":"11ec2c3e-e65f-45cf-9c89-4aa40a2c21c7"}] 
```

我的应用程序中使用的 java 代码：

```
HttpGet request = new HttpGet("http://XX.XX/WebService.svc/Android/AndroidGetTenants");        
request.setHeader("Accept", "application/json");        
request.setHeader("Content-type", "application/json");  

DefaultHttpClient httpClient = new DefaultHttpClient();        
HttpResponse response = httpClient.execute(request);       
HttpEntity responseEntity = response.getEntity();         

byte[] buffer = new byte[(int)responseEntity.getContentLength()];        
InputStream stream = responseEntity.getContent();  
stream.read(buffer);
stream.close();  
String tekst = new String(buffer,"UTF-8");                          
JSONArray tenants = new JSONArray(tekst); 
```

java 代码抛出一个空的 JSONException（catch 中的参数 e 不存在）。该服务似乎返回了一个对象数组。当我改变时：

```
JSONArray tenants = new JSONArray(tekst); 
```

和

```
JSONObject tenants = new JSONObject(tekst); 
```

代码抛出一个`JSONException: Value [{"RowKey":"02f1654c-9746-4da5 ...... esPerSecond":0}] of type org.json.JSONArray cannot be converted to JSONObject`

这表明使用 JSONArray，但这又会引发上面提到的空异常。

希望有人可以提供帮助。

* * *

额外信息：此代码也抛出相同的异常：

```
String tekst = "[\"1\",\"2\"]";                         
JSONArray tenants = new JSONArray(tekst); 
```

这是一个简单的 JSON 数组，我真的不明白为什么这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:54:34.357

我首先建议您更改框架中解析器的所有流监控代码，因此响应块将变为：

```
HttpResponse response = httpClient.execute(request);           
String tekst = EntityUtils.toString( response.getEntity() ); 
```

这可能有助于保证您从服务器获取所有正确的数据并正确格式化。这可能是你的读者拉低角色的方式。

# c# - 将 Json 数组解析为对象

> ID：11509197
> 
> 赞同：0
> 
> 时间：2012-07-16T17:11:46.317
> 
> 标签：c#, json, parsing, deserialization

我目前正在使用 Json 反序列化代码。这是我的问题：

在 Json 文件中，我遇到了一个如下所示的数组：

```
"location":[47.618832,-122.21599] 
```

我可以很容易地解析成一个双数组：

```
[DataMember(Name = "location")]
public double[] Location { get; set; } 
```

但我想在这种情况下生成一个对象，让我们调用它在其他命名空间中定义`location`的 `Coordinate`类型。它有这样的构造函数：

`public Coordinate(double lat, double long)`

那么有没有办法在这种情况下直接生成一个坐标对象？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:20:26.353

不是直接的，而是更清洁的方式。

```
public class MyClass
{
       [DataMember(Name = "location")]
       public double[] Location { get; set; }

       public Coordinate Coordinate
       {
            get
            {
                  if(Location.Lenght > 2)
                  {
                        return new Coordinate() { Lat = Location[0], Lang = Location[1] };
                  }

                  return null;
            }
       }

}

public class Coordinate
{
      public double Lat { get; set;}
      public double Lang { get; set;}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:30:32.553

您可以将解析的数据标记为私有并以您想要的方式公开它。

```
public class MyClass
{
   public struct Coordinate
   {
       public double Lat;
       public doubel Lon;
   }

   [DataMember(Name = "location")]
   private double[] _Location { get; set; }

   public Coordinate Location
   {
       get
       {
           return new Coordinate { Lat = _Location[0], Lon = _Location[1]};
       }
       set
       {
           double[0] = value.Lat;
           double[1] = value.Lon;
   }

} 
```

我只是把它放在一起，可能会使 Coordinate 类型不可变，并确保我覆盖了 Equals 和 == 运算符的比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:23:54.563

您可以实现[IDataContractSurrogate](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.idatacontractsurrogate.aspx)接口，该接口

> 提供在 XML 模式文档 (XSD) 的序列化、反序列化以及导出和导入期间由 DataContractSerializer 将一种类型替换为另一种类型所需的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T17:24:19.623

我没有直接与 JSon 合作，但你可以有一个 Location 属性获取/设置的 Coordinate 属性：

```
// Not affected by JSon deserialization
[ScriptIgnore]
public Coordinate Coordinate {get; set;}

// Serialized/Deserialized by JSon
public double[] Location { 
    get 
        {
            return new double[] {Coordinate.Latitude,Coordinate.Longitude};
        } 
    set
        {
            Coordinate = new Coordinate(value[0],value[1]);
        }
} 
```

当然，您应该添加适当的边界检查等。

# css - Dreamweaver CS6 格式源代码 CSS 后面加空格：

> ID：11509200
> 
> 赞同：0
> 
> 时间：2012-07-16T17:12:16.143
> 
> 标签：css, format, dreamweaver

在 Dreamweaver CS6 中应用源格式时，它会在 CSS 文件中的冒号后添加一个空格。有什么方法可以更改“CSS 源格式选项”对话框中没有的其他格式行为吗？有没有可能有帮助的扩展程序？

例子：

```
.someSelector { color:#abc123; } 
```

变成

```
.someSelector { color: #abc123; } 
```

注意后面的空格`color:`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:44:34.043

在 Dreamweaver 5.5 中，您**无法**进行所需的更改。[来自 Adob​​e 在线帮助的格式化 CSS 代码](http://help.adobe.com/en_US/dreamweaver/cs/using/WS6A10E93F-6587-4e1b-956C-03CBD7F678BBa.html "格式化 CSS 代码")（因为 Funkyscript 说他已经看过了。）

我能找到的最接近的文件是**C:\Program Files(x86)\Adobe\Adobe Dreamweaver CS5.5\configuration\TagLibraries\CSS\properties.xml**中的一个文件。这列出了 CSS 的有效选项，但同样没有关于空白。

您可能必须使用正则表达式来获得所需的内容。更新：刚刚发现这个正则表达式问题，这与你想要的相反：[Efficient RegEx to Force Single Space After CSS Attribute Value](https://stackoverflow.com/questions/7788319/efficient-regex-to-force-single-space-after-css-attribute-value?rq=1)

也就是说，我认为冒号后面的空格可以提高可读性。也许您的差异工具可以排除空白更改？

# haskell - 如何在 GHCi 中抑制“失败，模块已加载：”？

> ID：11509201
> 
> 赞同：3
> 
> 时间：2012-07-16T17:12:25.293
> 
> 标签：haskell, ghci

在重构大型项目时，我喜欢让类型检查器通过引入所需的更改来为我完成工作，然后跟踪产生的类型错误。

但是，由于相关类型错误在输出*之前*`Failed, modules loaded:`显示在 GHCi 中，因此具有足够模块的项目可能会导致相关错误滚动到即使是大尺寸终端的顶部。

是否有一个标志或选项可以使 GHCi 抑制此输出，或者至少重新排序以使错误最后出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:24:59.077

您可以尝试使用 GHC 编译文件，而不是在 GHCi 中加载它们。这样，它不会尝试加载文件，而只会编译它们，因此只显示编译错误和警告。

所以，而不是这个：

```
$ ghci -Wall -Werror
GHCi, version 7.4.2: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer-gmp ... linking ... done.
Loading package base ... linking ... done.
Prelude> :l foo.hs 
```

...只需这样做：

```
$ ghc -Wall -Werror foo.hs 
```

顺便说一句，如果您在 UNIX/Linux 中使用终端，您可以更轻松地更改字体大小、水平调整终端大小（在 Windows 上默认运行终端时无法做到这一点）、增加回滚，否则会增加您可以看到的行数:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-18T08:52:12.413

我非常绝望，以至于我在代码中四处寻找：

```
modulesLoadedMsg :: SuccessFlag -> [GHC.ModSummary] -> InputT GHCi ()
modulesLoadedMsg ok mods = do
  dflags <- getDynFlags
  unqual <- GHC.getPrintUnqual
  let mod_name mod = do
        is_interpreted <- GHC.isModuleInterpreted mod
        return $ if is_interpreted
                  then ppr (GHC.ms_mod mod)
                  else ppr (GHC.ms_mod mod)
                       <> text " ("
                       <> text (normalise $ msObjFilePath mod)
                       <> text ")" -- fix #9887
  mod_names <- mapM mod_name mods
  let mod_commas
        | null mods = text "none."
        | otherwise = hsep (punctuate comma mod_names) <> text "."
      status = case ok of
                   Failed    -> text "Failed"
                   Succeeded -> text "Ok"

      msg = status <> text ", modules loaded:" <+> mod_commas

  when (verbosity dflags > 0) $
     liftIO $ putStrLn $ showSDocForUser dflags unqual msg 
```

看起来 0 的详细程度将其关闭。您可以设置：

```
$ ghci -v0 
```

或与阴谋集团：

```
$ cabal repl --ghc-options="-v0" 
```

或堆栈：

```
$ stack repl --ghci-options="-v0" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-02T05:45:19.843

解决方法是一个好主意，`sed`除了`sed`它还接收 Ctrl+c 时，会破坏管道。这是解决该问题的变体：

```
cabal new-repl cabal-install | (trap '' SIGINT; sed -e '/Failed, modules loaded.*/d') 
```

（替换`cabal new-repl`为您最喜欢的 GHCi 命令。）

# zend-framework2 - 致命错误：在 ZF2 框架应用程序中找不到类“区域设置”

> ID：11509204
> 
> 赞同：16
> 
> 时间：2012-07-16T17:12:36.067
> 
> 标签：zend-framework2, beta

我刚刚按照给定的说明安装了[`ZF2`beta5 应用程序：](https://github.com/zendframework/ZendSkeletonApplication)

```
$ git clone git://github.com/zendframework/ZendSkeletonApplication.git ./
Cloning into '.'...
remote: Counting objects: 1494, done.
remote: Compressing objects: 100% (660/660), done.
remote: Total 1494 (delta 681), reused 1373 (delta 581)
Receiving objects: 100% (1494/1494), 397.42 KiB | 357 KiB/s, done.
Resolving deltas: 100% (681/681), done.

$ php composer.phar install
Installing dependencies
  - Installing zendframework/zendframework (dev-master)
    Cloning d6b0afe61149c6d0669743aab5c73285c42cd0db

zendframework/zendframework suggests installing doctrine/common (Doctrine\Common >=2.1 for annotation features)
Writing lock file
Generating autoload files 
```

当我访问应用程序时，我收到以下错误：

> 致命错误：在第 220 行的 ./vendor/zendframework/zendframework/library/Zend/I18n/Translator/Translator.php 中找不到类 'Locale'

我没有尝试`Doctrine`按照建议安装（因为我最后不想使用 Doctrine）。

**有人知道如何解决这个问题吗？**

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-07-17T05:19:45.320

您需要安装`intl`PHP 扩展。

对于基于 APT 的系统，请尝试：`sudo apt-get install php5-intl`
对于基于 YUM 的系统，请尝试：`sudo yum install php-intl`
对于 OS X，请从[本文](http://mansion.im/2011/php-with-intl-and-gettext-on-osx-lion/)开始，但请检查您拥有的 PHP 版本并下载正确的源代码。

之后您可能需要重新启动 PHP 或 Web 服务器。

# overflow - 另一个调用时 Pascal 退出过程

> ID：11509205
> 
> 赞同：-3
> 
> 时间：2012-07-16T17:12:36.923
> 
> 标签：overflow, pascal, procedures

所以我的问题看起来像，我有两个程序，它们互相调用，但这会提供溢出。如何跳转到程序 - 像 asm jmp 不调用？我不想使用标签，因为我不能在两个不同的过程之间使用 GoTo。而且我不希望执行调用过程之后的代码。顺便说一句，我使用 FPC。

```
unit sample;
interface

procedure procone;
procedure proctwo;

implementation

procedure procone;
begin
writeln('Something');
proctwo;
writeln('After proctwo'); //don't execute this!
end;

procedure proctwo;
begin
writeln('Something else');
procone;
writeln('After one still in two'); //don't execute this either
end;

end. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T01:38:19.450

您必须使用函数参数来指示递归，以便函数知道它正在被相关函数调用。例如：

```
unit sample;

interface

procedure procone;
procedure proctwo;

implementation

procedure procone(const infunction : boolean);
begin
  writeln('Something');
  if infunction then exit;
  proctwo(true);
  writeln('After proctwo'); //don't execute this!
end;

procedure proctwo(const infunction : boolean);
begin
  writeln('Something else');
  if infunction then exit;
  procone(true);
  writeln('After one still in two'); //don't execute this either
end;

procedure usagesample;
begin
  writeln('usage sample');
  writeln;
  writeln('running procone');
  procone(false);
  writeln;
  writeln('running proctwo');
  proctwo(false);
end;

end. 
```

当`usagesample`被调用时，它应该产生这个：

```
usage sample

running procone
Something
Something else
After proctwo

running proctwo
Something else
Something
After one still in two 
```

# c++ - 访问呈现的 WPF 页面/窗口的底层 DirectX 表面/渲染目标

> ID：11509211
> 
> 赞同：1
> 
> 时间：2012-07-16T17:12:46.120
> 
> 标签：c++, wpf, graphics, directx, unmanaged

我需要从非托管代码访问（托管）WPF 页面/窗口的渲染原始像素。

在将最终光栅复制到外部设备之前，底层（非托管）引擎会在 cpu 内存和 gpu 内存 (DirectX) 中渲染像素。理想的情况是从 cpu 内存或 gpu 内存中的 directx 渲染目标或 dxgi 表面访问原始像素数据。

我需要的类似于[WPF 和 DirectX - Game Overlay](https://stackoverflow.com/questions/4388492/wpf-and-directx-game-overlay)，但这里的回复与所讨论的问题相反。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:00:44.173

几天前我偶然发现了这个信息——在这里我找到了一个关于这个主题的问题！给你，[这个](http://jmorrill.hjtcentral.com/Home/tabid/428/EntryId/438/How-to-get-access-to-WPF-s-internal-Direct3D-guts.aspx)链接应该是你需要的。

# c++ - 为什么我从 enum 到 int 的转换在发布版本中不起作用？

> ID：11509214
> 
> 赞同：3
> 
> 时间：2012-07-16T17:13:28.623
> 
> 标签：c++, casting, enums

我发现以下代码在调试版本中正常工作，但在发布时不正确：

```
enum FileFormatDetection
{
    Binary,
    ASCII,
    Auto
};

FileFormatDetection detection_mode = (FileFormatDetection)ReadIntKey(NULL, KEY_ALL, "FIL_ASCIIORBINARY", -1); // Assigns -1, as confirmed by debug output
if (detection_mode < 0 || detection_mode > 2)
{
    // Not a valid value, so set to default:
    detection_mode = Auto;
} 
```

在每个构建中，调试输出确认该值为 -1。在调试版本中，值 -1 导致输入 if-branch；在发布时，它没有。

我尝试将 detection_mode 转换为 int，如下所示：

```
if ((int)detection_mode < 0 || (int)detection_mode > 2) 
```

和：

```
if (int(detection_mode) < 0 || int(detection_mode) > 2) 
```

但两者都没有任何区别。

我可以完成这项工作的唯一方法是将枚举变量转换为整数堆栈变量并测试：

```
int detection_int = (int)detection_mode;
if (detection_int < 0 || detection_int > 2)
{
    ... 
```

现在按预期输入了 if 分支。

我不明白为什么这是必要的——我仍然认为原始代码（或至少测试临时演员）应该有效。谁能解释为什么没有？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T17:22:21.403

问题是转换导致未定义的行为，因为您正在为枚举分配一个不是枚举数之一的值。

当您在发布模式下编译时，优化器会看到以下表达式：

```
if (detection_mode < 0 || detection_mode > 2) 
```

并且知道`detection_mode`is的类型`FileFormatDetection`，它知道该特定枚举的所有有效值都在范围内，因此 if 语句永远不可能`true`（至少在定义明确的程序中），因此它`if`完全删除了。

强制转换为`int`in`if`将无济于事，因为同样的推理方式仍然适用：强制转换之前的值（同样在定义明确的程序中）在范围内`[0..2]`，因此优化器删除了`if`. 重要的是要注意强制转换是否显式并不重要，因为`int`在这两种情况下，枚举都将被转换为进行比较。

如果您将值存储在 an 中，`int`那么一切都会改变。有不少`int`值超出了该范围，因此必须进行比较。另请注意，通过此更改，程序变得定义良好，因为`-1` **它是**一个有效的`int`. 这实际上是您应该做的：将值作为 获取`int`，并且只有当它可以转换为枚举时，才执行转换。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T17:23:54.180

该变量`detection_mode`具有 type `FileFormatDetection`，因此它只能（合法地）包含 0..2 范围内的值。其他任何事情都是未定义的行为。显然，在您的情况下，优化器正在识别这一点，并将测试抑制为小于零。

您应该做的是阅读, 并且仅在范围检查*后*`int`转换为 ：`FileFormatDetection`

 *```
int raw_detection_mode = ReadIntKey(...);
if ( raw_detection_mode <= 0 || raw_detection_mode > 2 ) {
    raw_detection_mode = Auto;
}
FileFormatDetection detection_mode =
    static_cast<FileFormatDetection>( raw_detection_mode ); 
```*

# python - 虚拟环境 Python 2.4

> ID：11509228
> 
> 赞同：4
> 
> 时间：2012-07-16T17:14:39.437
> 
> 标签：python, virtualenv

使用 virtualenv 时，我发现命令： virtualenv -p python2.6 --no-site-packages ~/env/NEW_PROJECT 可以正常工作，但是如果我尝试执行 virtualenv -p python2.4 --no-site-包 ~/env/NEW_PROJECT 我收到错误“可执行python2.4（来自--python=python2.4）不存在。有没有办法用python2.4设置virtualenv？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T14:28:57.143

您可能尚未`python2.4`安装或不在您的`$PATH`.

`virtualenv`，不同于`rvm`，不安装 Python 版本，它只使用你已经安装的。当您使用`-p`选项时，这意味着`--python`您告诉 virtualenv 基于该 Python 安装创建一个新的隔离环境。

因此，如果您在某处安装了 Python 2.4，只需执行以下操作：

```
$ virtualenv --python /path/to/python2.4/bin/python2.4 --no-site-packages ~/env/NEW_PROJECT 
```

PS.：在新版本`--no-site-packages`中已弃用。`virtualenv`默认情况下，它不使用全局站点包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-13T16:16:51.833

对的支持已`python2.4`被删除，`virtualenv 1.8`因此请确保您使用`virtualenv<=1.7.2`.

# javascript - Photoshop中的溢出效果

> ID：11509229
> 
> 赞同：0
> 
> 时间：2012-07-16T17:14:39.947
> 
> 标签：javascript, html, css

我想知道是否可以制作像 photoshop 或 illustrator 效果这样的叠加效果。

我有一张图片作为背景，在前面我放了一个带有彩色背景的 div，我想在前面的 div 上应用一个叠加效果（就像在 PS 或 Illustrator 中一样），这实际上看起来比简单的透明效果更好。

你知道有什么办法吗？也许使用任何 JS 库？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:19:00.280

试试[http://www.pixastic.com/](http://www.pixastic.com/)

不确定它是否会满足您的需求，但值得一看。

[http://www.pixastic.com/lib/docs/actions/blend/](http://www.pixastic.com/lib/docs/actions/blend/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:31:04.473

如果您想要的叠加效果就像显示透明效果，那么试试这个

[http://ajaxdump.com/2009/09/02/image-overlay-effect-using-jquery/](http://ajaxdump.com/2009/09/02/image-overlay-effect-using-jquery/)

或者

[http://tommcfarlin.com/simple-overlay/](http://tommcfarlin.com/simple-overlay/)

实际上有更多使用 jquery（js 库）的叠加效果教程，就像你想要的那样

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:18:57.313

如果您指的是 PS/AI 中的混合模式，那么不，这些混合选项在 HTML/CSS 中尚不可用。[某些滤镜效果](http://davidwalsh.name/dw-content/css-filters.php)即将出现，但混合模式（据我所知）不会出现。

# c++ - 提高 SDL 的每像素访问速度

> ID：11509237
> 
> 赞同：0
> 
> 时间：2012-07-16T17:15:07.750
> 
> 标签：c++, sdl

我开始制作康威生命游戏的 SDL 版本。我以前使用过 SDL，但从未直接访问像素。我编写了以下代码，它的执行速度很慢。我尝试过使用 UpdateRect 而不是 Flip，两者之间没有区别。我用 SWSURFACE 初始化了 SDL。我能做些什么来改善它吗？我想到了解决方法（将 bmp 用于更大的像素等）。绘图数组是 640x480 的 Cell 对象，它只包含一个可以通过 getter/setter 访问的成员 'alive'。我要做的就是让鼠标有效地绘制像素。我需要使用 OpenGL 来执行此操作吗？我想澄清一下，我意识到现代硬件并不意味着每像素访问。但鉴于这是我需要的，我正在寻找解决方案。

```
while (quit == false)
    {
            int pX = 0;
            int pY = 0;
            bool did_set = false;
            if (SDL_PollEvent(&event))
            {
                    switch(event.type)
                    {
                            case SDL_MOUSEBUTTONDOWN:
                                    plot[event.button.y][event.button.x].setAlive(true);
                                    pX = event.button.x;
                                    pY = event.button.y;
                                    did_set = true;
                            break;
                            case SDL_QUIT:
                                    quit = true;
                            break;
                    }
            }

            if (did_set)
            {
                    SDL_LockSurface(screen);
                    Uint32 p = SDL_MapRGB(screen->format, 255,255,255);
                    putpixel(screen, pX, pY, p);
                    SDL_UnlockSurface(screen);
            }
            SDL_Flip(screen);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:30:50.910

每个“帧”只处理一个事件。

尝试将 更改`SDL_PollEvent()` `if`为 a `while`：

```
const Uint32 p = SDL_MapRGB(screen->format, 255,255,255);
while (quit == false)
{
    while (SDL_PollEvent(&event))
    {
        switch(event.type)
        {
        case SDL_MOUSEBUTTONDOWN:
            {
                int pX = event.button.x;
                int pY = event.button.y;
                plot[pY][pX].setAlive(true);
                SDL_LockSurface(screen);
                putpixel(screen, pX, pY, p);
                SDL_UnlockSurface(screen);
            }
            break;
        case SDL_QUIT:
            quit = true;
            break;
        }
    }

    SDL_Flip(screen);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:31:34.577

您可能在一帧中收到多个事件，但您一次只处理一个，然后等待下一帧。在几乎每个 SDL 示例代码中，您都会`SDL_PollEvent`在`while`语句中看到。

此外，鼠标一次可以移动多个像素，因此您必须从旧位置绘制整条线到新位置（例如使用 Bresenham 算法）；在这一点上，你最好避免使用`putpixel`，因为当你实际上只是沿着列和线走时，它会进行整个乘法以获得内存中的位置（这可以通过加法来完成。）

# wpf - 样式 WPF DataGrid 以在有 0 个项目时显示红色边框

> ID：11509245
> 
> 赞同：2
> 
> 时间：2012-07-16T17:15:35.953
> 
> 标签：wpf, datagrid, styles

我正在尝试设置样式以在集合`DataGrid`中没有项目时显示红色错误边框。`ItemsSource`我已经为触发器编写并工作了所有代码。

这是我尝试过的：

```
<Style x:Key="WarningDataGrid" TargetType="DataGrid" BasedOn="{StaticResource {x:Type DataGrid}}">
    <Style.Triggers>
        <Trigger Property="ocean:DataGridBehavior.HasWarning" Value="true">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border BorderThickness="1" BorderBrush="Red">
                            <AdornedElementPlaceholder />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=(ocean:CheckBoxBehavior.Warning)}" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

但由于我没有使用验证框架，所有发生的事情都是红色边框替换了 DataGrid。

我需要从默认样式开始吗？如果是这样，我在哪里可以找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:58:28.607

您正在替换整个模板。只需设置`BorderBrush`：

```
<Style x:Key="WarningDataGrid" TargetType="DataGrid" BasedOn="{StaticResource {x:Type DataGrid}}">
    <Style.Triggers>
        <Trigger Property="ocean:DataGridBehavior.HasWarning" Value="true">
             <Setter Property="BorderBrush" Value="AliceBlue"/>
            <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=(ocean:CheckBoxBehavior.Warning)}" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:21:22.777

在 Binding 中设置 ValidateOnErrors=True 和 ValidateOnExceptions=True 。我希望这将有所帮助。

# django - 自动为帖子创建 url 别名

> ID：11509246
> 
> 赞同：0
> 
> 时间：2012-07-16T17:15:45.567
> 
> 标签：django, django-urls

我希望能够将博客文章的标题转换为 django 中自动生成的 URL，如下所示：

*   标题：这是文章 #1 => blog/article-1
*   标题：烹饪意大利面和肉丸 => 博客/烹饪意大利面肉丸
*   标题：#%#@$！h4h4h4 垃圾邮件 5@#$! => 博客/h4h4h4-垃圾邮件

它们应该在创建时自动生成并过滤多余的单词/字符。每次保存博客文章时，如果更改标题，URL 也可能会更改。

我绝对可以从头开始编程。但是，例如在 Drupal 中，已经有一个名为 'url alias' 和 'autopath' 的模块会在您提交新博客文章后立即生成这些 url。我想知道是否有人已经为 Django 1.4 构建了一些简单的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:18:11.343

您想使用[SlugField ，并使用 Django 的](https://docs.djangoproject.com/en/1.4/ref/models/fields/#slugfield)[预填充字段](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.prepopulated_fields)功能将其与标题字段配对。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:22:29.687

```
from django.template.defaultfilters import slugify
slugify("b b b b")
u'b-b-b-b' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:15:41.620

我一直在使用一个非常漂亮、简单的模块，称为[Django Autoslug](http://packages.python.org/django-autoslug/) ，它构建在 mipadi 提到的 SlugField 之上，但它会自动为您创建 slug，检查数据库的唯一性（默认情况下，添加“-#”到 slug 的末尾，直到它是唯一的），并将其存储到一个字段中。

# .net - 如何将元数据分配给 DataSet/DataGridView 对中的一行？

> ID：11509249
> 
> 赞同：1
> 
> 时间：2012-07-16T17:16:09.130
> 
> 标签：.net, datagridview, dataset

当我打开我的表单时，我将一堆行添加到绑定到 DataGridView 的 DataSet 中。稍后，当我枚举 DataGridView 中的行时，我希望能够访问一些用于填充 DataSet 但未正确存储在 DataSet 中的数据。

像这样的东西：

```
public void OnStartup()
{
  foreach (var data in GetData())
  {
    var row = MyDataSet.MyTable.AddRow(data.Value);

    // here's the part where I'm not sure what to do.. ideally:
    row.GetDataGridViewRow().Tag = data.Metadata;
  }
}

public void LaterOn()
{
  foreach (var row in MyDataGridView.GetSelected())
  {
     var metadata = (Metadata)row.Tag;  // or something
     ...
  }
} 
```

将一些元数据附加到 DataSet 或 DataGridView 行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:27:49.143

我会说这是没有单一“正确”方法的情况之一，只是根据具体情况选择一种方法。

使用这样的[`DataGridView` `Tag`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewband.tag.aspx)属性没有任何问题。事实上，这就是它的目的，如 MSDN 上所述：

> Tag 属性可以存储您想要与波段关联的任何对象。此属性通常用于存储标识信息，例如字符串名称、唯一标识符（例如 Guid）或数据库中乐队数据的索引。

* * *

我会考虑的一种替代方法是使用`BindingList<T>`带有自定义支持对象的`DataSource`a 而不是 a`DataSet`并将元数据存储在支持对象中。然后，您可以使用`DataGridViewRow`'`DataBoundItem`属性访问每个对象。

我稍微倾向于这种方式，因为它使数据和 UI 更加分离，这意味着即使您只有支持对象，您也可以获取元数据，但我怀疑在性能或内存方面是否存在任何具体差异用法。

# google-analytics - 谷歌分析似乎显示两倍

> ID：11509254
> 
> 赞同：6
> 
> 时间：2012-07-16T17:16:27.783
> 
> 标签：google-analytics

我刚刚推出了一个由 Wordpress 提供支持的网站。我将 Google Analytics（分析）跟踪代码放在标题中，但由于某种原因，每次访问似乎都可能是双重触发。我的跳出率是 0%，“浏览量”是“唯一身份访问者”的两倍。

[http://www.super-average.com](http://www.super-average.com)

有没有人有这方面的经验并且知道可能是什么问题？我已经浏览了该站点，但不明白为什么可能存在双重实例。我也安装了网站管理员工具，但这不应该引起我认为的问题。

任何帮助将不胜感激，我很乐意粘贴任何有用的代码。

更新：对不起，标题代码在这里。虽然我只是从 GA 网站复制了这个：

```
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-33137300-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T15:46:55.147

您的跟踪代码已正确部署，因此不应有任何重复计算的理由。

您可以通过查看 firebug 中的网络面板或 Google Chrome 的开发人员工具来验证访问已注册的次数。我已经完成了您网站上的实现，它似乎只声明每个页面加载一个页面浏览量。

### 这里有一些关于如何自己检查的说明。

如果您在页面加载时加载了网络面板，它会向您显示浏览器发出的每个 http 请求。Google Analytics 通过从服务器 www.google-analytics.com 对文件 _utm.gif 发出 http 请求来跟踪网页浏览量。它记录了它传回的各种数据位作为此图像请求的参数。

这是从您的网站发出的请求：

> `http://www.google-analytics.com/__utm.gif?utmwv=5.3.3&utms=2&utmn=988228308&utmhn=www.super-average.com&utmcs=UTF-8&utmsr=1280x1024&utmvp=1264x292&utmsc=32-bit&utmul=en-gb&utmje=1&utmfl=11.3%20r300&utmdt=%3A%20Super%20Average&utmhid=1247225166&utmr=http%3A%2F%2Fstackoverflow.com%2Fquestions%2F11509254%2Fgoogle-analytics-appears-to-be-showing-twice-as-much&utmp=%2F&utmac=UA-33137300-1&utmcc=__utma%3D15652916.287814062.1342537195.1342537195.1342537195.1%3B%2B__utmz%3D15652916.1342537195.1.1.utmcsr%3Dstackoverflow.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fquestions%2F11509254%2Fgoogle-analytics-appears-to-be-showing-twice-as-much%3B&utmu=q~`

虽然手动分解和读取有点复杂，但网络面板也可以用于以可读的形式向您显示请求的参数。以下是它对您网站的说明：

```
utmwv:5.3.3
utms:5
utmn:693086318
utmhn:www.super-average.com
utmcs:UTF-8
utmsr:1280x1024
utmvp:1264x292
utmsc:32-bit
utmul:en-gb
utmje:1
utmfl:11.3 r300
utmdt:Super Average - Just another WordPress site: Super Average
utmhid:126380308
utmr:http://stackoverflow.com/questions/11509254/google-analytics-appears-to-be-showing-twice-as-much
utmp:/
utmac:UA-33137300-1
utmcc:__utma=15652916.287814062.1342537195.1342537195.1342539325.2;+__utmz=15652916.1342539325.2.2.utmcsr=stackoverflow.com|utmccn=(referral)|utmcmd=referral|utmcct=/questions/11509254/google-analytics-appears-to-be-showing-twice-as-much;
utmu:q~ 
```

这些不同的 utm 变量声明了有关被跟踪访问的不同信息。[您可以在此博客文章](http://www.lunametrics.com/blog/2011/10/04/utmgif-request-parameters/)中找到它们的完整列表和解释。

在这种情况下，真正重要的是看到只有一个 utmcc 实例，即帐户字符串；这意味着该请求仅发送一次，发送到该帐户。

### 您可能会看到重复计算的原因。

您列出了您认为可能会看到重复计算的两个原因。

一是您看到的网页浏览量是唯一身份访问者的两倍。除非您看到的网页浏览量是您拥有的唯一身份访问者的两倍，否则这应该不是问题。如果一个人在您为 Google Analytics（分析）中的报告设置的日期范围内多次访问您的网站，他们只会被计为一个唯一身份访问者，但每次他们回来时，他们都会产生额外的网页浏览量。如果他们刷新页面，他们还将生成额外的综合浏览量，但仍不计为新访问者 - 唯一或其他访问者。

您应该始终期望在您的网站上看到比您拥有的唯一身份访问者更多的综合浏览量。如果您想更多地了解网络分析中的各种指标（访问量、访问者、网页浏览量等），您可以从[数字分析协会的标准页面](http://www.digitalanalyticsassociation.org/?page=standards)找到它们的官方定义。

您认为您可能会看到重复访问的第二个原因是您的 0% 跳出率。不幸的是，我不清楚是什么原因造成的。如果一次访问未对 www.google-analytics.com 服务器产生至少两次调用，则 Google Analytics 会将访问视为退回。在像这样的简单实现中，产生对 google 服务器的调用的唯一事物是页面加载和与视频交互的人。由于您的主页肯定只创建了一个服务器调用，并且没有任何视频，因此它肯定应该至少跟踪一些反弹（如果有的话）。

如果您的流量非常低，那么到目前为止您的每次访问都可能包含至少两次页面加载（因此至少有两次服务器调用），但如果您看到大量流量，那么您应该期待以您所做的方式设置跟踪，至少看到几次反弹。

编辑：为了通过垃圾邮件过滤器，我不得不从这个答案中删除所有超链接和屏幕截图。由于这是我的第一个 Stack Overflow 答案，我不允许使用多个超链接或链接图片。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T13:11:36.797

查看您的 Javascript 代码中的任何引用`_gaq.push(['_trackPageview']);`- 这在将网页浏览信息发送给 Google 的行中具有特色。

我们通过搜索这一行发现了一个非常出色的 jQuery 地址历史插件导致的问题。进一步查看 SO 发现其他人也有这个问题：

[带有和不带有正斜杠的 Google Analytics 双重列表](https://stackoverflow.com/questions/11608769/google-analytics-double-listing-with-and-without-forward-slash)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-24T14:43:21.317

我也有同样的问题。问题是我在我的主页文件中包含了谷歌分析，并且一个模块正在从后端触发综合浏览量。所以你可以检查从后台触发的任何模块，因为我不太确定 wordpress。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-05T21:18:26.680

会不会是您在页面中包含两次 GA 代码？您可以将它放在另一个文件中，并且该文件（隐式或显式）包含在您的页面中。虽然我可能是错的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-10T15:21:28.200

我遇到了一个问题，即 Google Analytics 在我的所有页面中都包含了两次。一个实例是通过我手动添加的代码，但我无法弄清楚第二个实例的来源。

经过大量调试后，我注意到 Cloudflare（我的 CDN）安装了 Google Analytics 应用程序。所以它会自动将 GA 脚本添加到我的所有网页中，甚至是我通过代码添加 GA 的那些。

在你的情况下可能不是答案，但如果其他人有类似的问题，请记录下来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-20T00:02:55.507

我遇到了类似的问题，一些名为“Yontoo”的广告软件以一种将每个页面请求都视为新访问者的方式破坏了分析。这个“Yontoo”将自己安装为 Chrome 扩展程序（或者我猜它是随 Daemon Tools 安装程序提供的）。因此，如果您查看了 20 个页面，则页面上显示了 20 个唯一身份访问者。

删除 Chrome 扩展程序有帮助。它还作为 Windows 程序安装 - 卸载时要小心，它会询问您要保留而不是删除的内容，因此默认情况下您保留所有内容。这是一个鬼鬼祟祟的广告软件病毒间谍软件恶意软件胡说八道。我恨它。

这应该是违法的：

![在此处输入图像描述](../Images/0a8fc99a478c9400e473066bac337708.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-28T15:46:46.800

我对 gtags.js 也有类似的问题。我正在制作一个单页应用程序，我遵循了文档： [单页应用程序开发指南](https://developers.google.com/analytics/devguides/collection/gtagjs/single-page-applications)

但是，经过几次尝试，我发现 page_view 事件被重复了。经过一番搜索，我发现 page_view 事件是**在修改历史记录时触发的，**或者在某些情况下，我修改历史记录以“虚拟”更改当前页面的 url。因此，当我更改当前页面时，在我触发它时发送了第一个事件（就像在文档中手动一样），在修改历史记录时发送了第二个事件。

要禁用此选项，您可以输入通量的参数（对不起，法语）：

[![选项](../Images/041594e3593b60e351323b0e19f14462.png)](https://i.stack.imgur.com/JRDWv.png)

# python - wxHtmlWindow，页面加载后做一些事情

> ID：11509255
> 
> 赞同：0
> 
> 时间：2012-07-16T17:16:29.370
> 
> 标签：python, html, wxpython, wxhtmlwindow

我正在使用 wxPython，我遇到了麻烦。基本上，我只需要一个带有前进和后退按钮的基本 htmlwindow，但是当人们点击页面中的链接时我会遇到麻烦。加载页面后似乎没有发生任何事件，仅在单击链接时发生，因此我无法检查是否需要更新前进/后退按钮。

这是我尝试过的一些东西：

```
def log_link_clicked(self, evt):
    evt.Skip()
    self.log_check_history() 
```

我以为我可以跳过单击链接的事件，该事件将加载它，然后调用我的 check_history() 方法来更新我的按钮，但这不起作用。

我也尝试过这样做：

```
class BetterHtmlWindow(wx.html.HtmlWindow):
    def __init__(self, parent, window_id, pos, size, style, name = 'htmlWindow', frame=None):
        super(BetterHtmlWindow,self).__init__(parent,window_id,pos,size,style,name)
        self.frame = frame

    def __OnOpeningURL(self, type, url, redirect):
        res = super(BetterHtmlWindow,self).OnOpeningURL(type,url,redirect)
        self.LoadPage(url)
        self.frame.log_check_history() 
```

覆盖打开网址时发生的方法，但这也没有给我任何帮助。

有任何想法吗？

提前致谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:53:04.797

我只是想出了如何去做。我必须重写 LoadPage 方法，并重写 link_clicked 事件来调用我的重写版本

# java - 服务器请求 xmlrpc 上的错误 403

> ID：11509262
> 
> 赞同：0
> 
> 时间：2012-07-16T17:16:59.093
> 
> 标签：java, wordpress, xml-rpc

我正在使用 wordpress-java (http://code.google.com/p/wordpress-java/) 在我的博客中创建一个测试帖子，但出现异常：

```
redstone.xmlrpc.XmlRpcException: The response could not be parsed.  
    at redstone.xmlrpc.XmlRpcClient.handleResponse(Unknown Source)
    at redstone.xmlrpc.XmlRpcClient.endCall(Unknown Source)
    at redstone.xmlrpc.XmlRpcClient.invoke(Unknown Source)
    at redstone.xmlrpc.XmlRpcProxy.invoke(Unknown Source)
    at net.bican.wordpress.$Proxy1.newPost(Unknown Source)
    at net.bican.wordpress.Wordpress.newPost(Wordpress.java:606)
    at Ienmx.<init>(Ienmx.java:39)
    at Pulso.obtenerMinutoAMinuto(Pulso.java:68)
    at principal$1.run(principal.java:24)
    at java.util.TimerThread.mainLoop(Timer.java:534)
    at java.util.TimerThread.run(Timer.java:484)
Caused by: java.io.IOException: Server returned HTTP response code: 403 for URL: http://pulso.wpengine.com/xmlrpc.php
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1403)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
    ... 11 more 
```

这是我的代码：

```
this.w = new Wordpress(usuario, password, xmlUrl);
Page p = new Page();
p.setTitle("Se crea el objeto en el script");
p.setDescription("Este es el cuerpo del post");
try{
    w.newPost(p, true);
}catch(Exception e){
    e.printStackTrace();
    System.out.println(e.getMessage());
} 
```

如果您转到 url，则 url 显示经典消息：

> XML-RPC 服务器只接受 POST 请求。

我不知道出了什么问题:(

谢谢 ：）

# java - Android 操作栏删除带有浅色主题的主页图标恢复为蓝色分隔线

> ID：11509264
> 
> 赞同：0
> 
> 时间：2012-07-16T17:17:21.117
> 
> 标签：java, android, xml

我使用的是浅色全息主题，它下面通常有一个灰色的分隔条，但后来我决定从操作栏中删除我的主页图标，它恢复为深色主题中的蓝色分隔条。我怎样才能把灰色的那个拿回来？

我的代码是这样的：

```
<style name="MyTheme" parent="android:style/Theme.Holo.Light">        
    <item name="android:actionBarStyle">@style/MyActionBar</item>
</style>

<style name="MyActionBar" parent="@android:style/Widget.Holo.Light.ActionBar">
    <item name="android:displayOptions">showTitle</item>
</style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:29:35.800

找到了修复：

```
<style name="MyActionBar" parent="@android:style/Widget.Holo.Light.ActionBar.Solid"> 
```

# asp.net - MVC3 控制器和视图

> ID：11509265
> 
> 赞同：0
> 
> 时间：2012-07-16T17:17:22.990
> 
> 标签：asp.net, asp.net-mvc-3, views, controllers

好的，现在在我的主控制器类中，我只是让每个单独的东西返回一个视图，例如：

```
 public ActionResult Contact()
    {
        return View();

    } 
```

我有这个向下拍，因为它不是很困难！不过，我想知道的是，在这个 actionresult 中我还能做什么？通过这个可以完成哪些其他事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:19:42.257

您可以返回硬编码的内容而不是视图：

```
public ActionResult Contact()
{
    return Content("Hello");
} 
```

您可以返回 JSON：

```
public ActionResult Contact()
{
    return Json(new { Foo = "bar" }, JsonRequestBehavior.AllowGet);
} 
```

您可以返回 javascript：

```
public ActionResult Contact()
{
    return JavaScript("alert('Hello World');");
} 
```

您可以直接流式传输文件：

```
public ActionResult Contact()
{
    return File(@"c:\work\foo.pdf", "application/pdf", "foo.pdf");
} 
```

您可以返回 404：

```
public ActionResult Contact()
{
    return HttpNotFound();
} 
```

您可以返回 401：

```
public ActionResult Contact()
{
    return new HttpUnauthorizedResult();
} 
```

如果内置的操作结果不适合您的需求，您可以随时编写自定义结果。例如一个返回 XML 的：

```
public class XmlResult : ActionResult
{
    private readonly object _data;
    public XmlResult(object data)
    {
        if (_data == null)
        {
            throw new ArgumentNullException("data");
        }
        _data = data;
    }

    public override void ExecuteResult(ControllerContext context)
    {
        var response = context.HttpContext.Response;
        response.ContentType = "text/xml";
        var serializer = new XmlSerializer(_data.GetType());
        serializer.Serialize(response.OutputStream, _data);
    }
} 
```

接着：

```
public ActionResult Contact()
{
    return new XmlResult(new { Foo = "Bar" });
} 
```

如您所见，您可以做很多事情。问题是：你想做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:20:48.470

通常在控制器上的操作中，您将从数据存储中获取数据并将其返回到视图。如果您询问有哪些类型的 ActionResult，您可以在[此处](https://stackoverflow.com/questions/1490548/what-are-all-the-asp-net-mvc-action-results)找到它们的列表。

# r - 如何使行名和列名成为R中的因子或字段之一？

> ID：11509267
> 
> 赞同：4
> 
> 时间：2012-07-16T17:17:24.663
> 
> 标签：r

如何使用行名和列名转换以下矩阵（或表/数据框），

```
 A       B
M   27143   18324
F   29522   18875 
```

变成类似的东西

```
27143  M  A
18324  M  B
29522  F  A
18875  F  B 
```

以便我可以在 R 中进行一些分析？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T17:26:03.093

您可以使用`reshape2`包和`melt`数据。

```
temp = read.table(header=TRUE, text="    A       B
M   27143   18324
F   29522   18875")
library(reshape2)
temp$id = rownames(temp)
melt(temp)
# Using id as id variables
# id variable value
# 1  M        A 27143
# 2  F        A 29522
# 3  M        B 18324
# 4  F        B 18875 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-31T09:52:23.260

您还可以使用`data.table`将行名添加为第一列，然后根据行名将其融化

```
df<- structure(list(A = c(27143L, 29522L), B = c(18324L, 18875L)), .Names = c("A", 
"B"), class = "data.frame", row.names = c("M", "F"))

library(data.table)
library(reshape2)
setDT(df, keep.rownames = TRUE)[]

#   rn     A     B
#1:  M 27143 18324
#2:  F 29522 18875

(melt(df, id.vars="rn"))
#   rn variable value
#1:  M        A 27143
#2:  F        A 29522
#3:  M        B 18324
#4:  F        B 18875 
```

或`gather`改用`melt`

```
library(tidyr)
gather(df, "rn")
#  rn rn value
#1  M  A 27143
#2  F  A 29522
#3  M  B 18324
#4  F  B 18875 
```

# c# - ASP.net MVC JsonValueProvider 字节类型问题

> ID：11509274
> 
> 赞同：2
> 
> 时间：2012-07-16T17:18:01.360
> 
> 标签：c#, asp.net-mvc-3, value-provider

我将 JSON 发布到控制器方法，当它尝试将 JSON 数字转换为字节类型时，似乎 ASP.Net MVC 3 中包含的 JsonValueProvider 已损坏。

基本上正在发生的事情是任何需要转换为字节的非空值都是空的，并且我的模型状态有错误，没有错误消息。如返回 JSON 中的问题列表所示。dnbscore 和 region 有错误，但 rating 没有。返回的数据的 dnbscore 和 region 为 null，即使在传递 JSON 时，这些字段也有值。我可以使用自定义模型绑定器来解决这个问题，但我想知道是否有不同的方法可以让 JsonValueProider 像我期望的那样工作。

这是我要构建的对象：

```
public class APICustomerDetailsDTO
{
    public int customerid { get; set; }

    [StringLength(30)]
    public string customername { get; set; }
    public decimal? globalcredit { get; set; }
    [Range(0,5)]
    public byte? rating { get; set; }
    [Range(0, 100)]
    public byte? dnbscore { get; set; }
    [Range(0, 8)]
    public byte? region { get; set; }
    [Required]
    public bool isnotactive { get; set; }
    public string salesperson { get; set; }
    [StringLength(30)]
    public string newmill_venderid { get; set; }
    [StringLength(30)]
    public string newmill_supplierid { get; set; }
    [StringLength(30)]
    public string edi_receiverid { get; set; }
    [Required]
    public bool edi_invoice { get; set; }
    [StringLength(15)]
    public string bill_code { get; set; }
} 
```

这是我在发布请求中发送的 JSON：

```
{"bill_code":"good","customerid":50,"customername":"Ted","dnbscore":80,"edi_invoice":false,"edi_receiverid":null,"globalcredit":null,"isnotactive":false,"newmill_supplierid":null,"newmill_venderid":null,"rating":null,"region":0,"salesperson":null} 
```

我检查模型状态的方法的一部分：

```
 if (!ModelState.IsValid)
        {
            var issues = ModelState.Where(m => m.Value.Errors.Any())
                                   .Select((m)=> new {field = m.Key, error = m.Value.Errors.FirstOrDefault().ErrorMessage})
                                   .ToArray();

            var result = new
            {
                result = "Failure",
                message = "Invalid data received. See issues for details.",
                issues = issues,
                data = cust
            }; 
```

返回 JSON：

```
{"result":"Failure","message":"Invalid data received. See issues for details.","issues":[{"field":"dnbscore","error":""},{"field":"region","error":""}],"data":{"customerid":50,"customername":"Ted","globalcredit":null,"rating":null,"dnbscore":null,"region":null,"isnotactive":false,"salesperson":null,"newmill_venderid":null,"newmill_supplierid":null,"edi_receiverid":null,"edi_invoice":false,"bill_code":"good"}} 
```

为了完整起见，这是我为解决此问题所做的工作：

通过 Darin 提供的信息，我意识到这是一个比字节更大的问题？诠释？转换。对于默认绑定器提供的任何非整数转换，这将是一个问题。因此，我制作了一个自定义活页夹，它可以很好地处理字节、十进制等数字。见下文：

```
public class APICustomerDetailsDTOBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        APICustomerDetailsDTO model = (APICustomerDetailsDTO)bindingContext.Model ??
            (APICustomerDetailsDTO)DependencyResolver.Current.GetService(typeof(APICustomerDetailsDTO));

        bool hasPrefix = bindingContext.ValueProvider.ContainsPrefix(bindingContext.ModelName);
        string searchPrefix = (hasPrefix) ? bindingContext.ModelName + "." : "";

        int customerid = 0;
        int.TryParse(GetValue(bindingContext, searchPrefix, "customerid"), out customerid);
        model.customerid = customerid;

        string customername = GetValue(bindingContext, searchPrefix, "customername");
        if (!String.IsNullOrEmpty(customername))
        { model.customername = customername; }
        else
        { model.customername = null; }

        decimal globalcredit;
        if (decimal.TryParse(GetValue(bindingContext, searchPrefix, "globalcredit"), out globalcredit))
        { model.globalcredit = globalcredit; }
        else
        { model.globalcredit = null; }

        byte rating;
        if (byte.TryParse(GetValue(bindingContext, searchPrefix, "rating"), out rating))
        { model.rating = rating; }
        else
        { model.rating = null; }

        byte dnbscore;
        if (byte.TryParse(GetValue(bindingContext, searchPrefix, "dnbscore"), out dnbscore))
        { model.dnbscore = dnbscore; }
        else
        { model.dnbscore = null; }

        byte region;
        if (byte.TryParse(GetValue(bindingContext, searchPrefix, "region"), out region))
        { model.region = region; }
        else
        { model.region = null; }

        bool isnotactive;
        if (bool.TryParse(GetValue(bindingContext, searchPrefix, "isnotactive"), out isnotactive))
        { model.isnotactive = isnotactive; }
        else
        { model.isnotactive = false; }

        string salesperson = GetValue(bindingContext, searchPrefix, "salesperson");
        if (!String.IsNullOrEmpty(salesperson))
        { model.salesperson = salesperson; }
        else
        { model.salesperson = null; }

        string newmill_venderid = GetValue(bindingContext, searchPrefix, "newmill_venderid");
        if (!String.IsNullOrEmpty(newmill_venderid))
        { model.newmill_venderid = newmill_venderid; }
        else
        { model.newmill_venderid = null; }

        string newmill_supplierid = GetValue(bindingContext, searchPrefix, "newmill_supplierid");
        if (!String.IsNullOrEmpty(newmill_supplierid))
        { model.newmill_supplierid = newmill_supplierid; }
        else
        { model.newmill_supplierid = null; }

        string edi_receiverid = GetValue(bindingContext, searchPrefix, "edi_receiverid");
        if (!String.IsNullOrEmpty(edi_receiverid))
        { model.edi_receiverid = edi_receiverid; }
        else
        { model.edi_receiverid = null; }

        bool edi_invoice;
        if (bool.TryParse(GetValue(bindingContext, searchPrefix, "edi_invoice"), out edi_invoice))
        { model.edi_invoice = edi_invoice; }
        else
        { model.edi_invoice = false; }

        model.bill_code = GetValue(bindingContext, searchPrefix, "bill_code");

        return model;
    }

    private string GetValue(ModelBindingContext context, string prefix, string key)
    {
        ValueProviderResult vpr = context.ValueProvider.GetValue(prefix + key);
        return vpr == null ? null : vpr.AttemptedValue;
    }

    private bool GetCheckedValue(ModelBindingContext context, string prefix, string key)
    {
        bool result = false;
        ValueProviderResult vpr = context.ValueProvider.GetValue(prefix + key);
        if (vpr != null)
        {
            result = (bool)vpr.ConvertTo(typeof(bool));
        }
        return result;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:25:19.323

您可以将它们作为字符串发送：

```
{ 
    "bill_code": "good", 
    "customerid": 50, 
    "customername": "Ted", 
    "dnbscore": "80", 
    "edi_invoice": false, 
    "edi_receiverid": null, 
    "globalcredit": null, 
    "isnotactive": false, 
    "newmill_supplierid": null, 
    "newmill_venderid": null, 
    "rating": null, 
    "region": "0", 
    "salesperson": null 
} 
```

如果您对更多详细信息感兴趣，可以查看[以下帖子](https://stackoverflow.com/a/8968207/29407)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T17:04:43.400

我的自制解决方案是创建一个 javascript 函数，以确保所有数值都用它们周围的引号进行序列化，如下所示

```
$.toJson = function (data) {
    return JSON.stringify(param, function (k, v) { return typeof v === 'number' ? v.toString() : v; });
}; 
```

# jquery - 使一段文本位于顶部

> ID：11509278
> 
> 赞同：2
> 
> 时间：2012-07-16T17:18:20.130
> 
> 标签：jquery, css

我正在玩的 CSS/jQuery 的想法是，基本上，一个颜色的 div 位于另一个 div 的顶部，然后淡出顶部的链接，以便主 div 后面的颜色在鼠标悬停时显示出来并在您离开 div 后返回主颜色。

我的问题是，基本上我不能将文本放入一个分区并始终将其放在顶部，因为如果将其放置在淡入淡出的 div 中，那么文本显然会淡出，同样，当它位于底部 div 时，它也不会总是出现. 到目前为止，我有这个：

CSS：

```
 .logo{
        width: 200px;
        height: 100px;
        background-color: #519CC4;
        float: left;
        text-align: center;
    }

    .barofcolour{
        width: 200px;
        height: 100px;
        background-color: #51B9C4;
        float: left;
        position: absolute;
    } 
```

身体：

```
<div class="logo">
      <!--put text here-->
</div>
<div class="barofcolour">
      <!--or here-->
</div> 
```

jQuery：

```
 $(document).ready(function(){
        $(".barofcolour").hover(function(){
            $(".barofcolour").fadeTo("1000", 0);
            },function(){
            $(".barofcolour").fadeTo("1000", 1);
        });
    }); 
```

因此，如果有人能提供任何关于我如何让一些文本始终位于褪色颜色条和静态颜色条之上的见解。那会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:29:38.157

如果你总是想要相同的文本但只是改变背景颜色，你可以使用 CSS 过渡而不是淡化重叠`div`：

**HTML**

```
<div class="logo">
      Text 
</div>​ 
```

**CSS**

```
.logo{
    width: 200px;
    height: 100px;
    background-color: #519CC4;
    float: left;
    text-align: center;

    transition: background-color 1s;
    -moz-transition: background-color 1s; /* Firefox */
    -webkit-transition: background-color 1s; /* Safari and Chrome */
    -o-transition: background-color 1s; /* Opera */
}
.logo:hover { background-color: #51B9C4; } 
```

​<a href="http://jsfiddle.net/xGBAz/" rel="nofollow">演示

**编辑：**如果你想使用 jQuery 解决方案，你也可以这样做：

```
$(document).ready(function(){
    $(".logo").hover(function(){
        $(this).animate({ backgroundColor: '#51B9C4'}, 1000);
        },function(){
        $(this).animate({ backgroundColor: '#519CC4'}, 1000);
    });
});​ 
```

请注意，您需要 jQuery UI 或其他一些彩色动画插件（或自己编写一个）。

[演示](http://jsfiddle.net/xGBAz/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:26:10.917

在透明背景（css3）上使用不透明文本

```
background-color: rgba(...); 
```

您可以在其中指定背景透明度的 Alpha 通道而不影响文本。如果你想为 rgba 背景设置动画，我推荐在[https://github.com/jquery/jquery-color/](https://github.com/jquery/jquery-color/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:35:21.407

这可能有点笨拙，但我在途中感到困惑。给你：HTML

```
<div class="wrapper">

<div class="logo">
      <!--put text here--> </div> <div class="barofcolour">
       <!--or here--> </div>

 <div class="textboox"> TEXT</div> </div> 
```

**CSS**

```
.logo{
        width: 200px;
        height: 100px;
        background-color: #519CC4;
        float: left;
        text-align: center;
                z-index: 11;
    position: relative;

    }

    .barofcolour{
        width: 200px;
        height: 100px;
        background-color: #51B9C4;
        float: left;
        z-index: 12;
            position: relative;
            margin-top: -100px;

    }

    .wrapper {
    width: 200px;
        height: 100px;
    position: relative;
    float: left;
    z-index: 50;}

    .textboox {
    float: left;
    position: relative;
    margin-top: -20px;
    z-index: 60;
    } 
```

# c# - 如何通过电脑控制 Windows Phone 7？

> ID：11509282
> 
> 赞同：1
> 
> 时间：2012-07-16T17:18:28.650
> 
> 标签：c#, windows-phone-7

我的一个朋友和我在 Arduino 和 Java 的帮助下制作了一个 RGB Strip。该设备通过 USB 连接到 PC，代码计算 PC 屏幕上的平均 RGB 值，并相应地使条带发光。

我想尝试的是-

我有一个 Windows Phone。我想使用它而不是 RGB 条，以便手机屏幕提供平均颜色 o/p。

1.  我该如何开始呢？如何让我的手机通过 USB 与我的 PC 进行通信，以便它以良好的刷新率接收输入？

2.  我应该使用哪些命名空间在 C# 中对其进行编程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:41:11.503

Windows Phone 将 USB 端口抽象为以太网连接，因此您可以创建与虚拟适配器的 IP 连接（请参阅[通过 USB 电缆将数据从 WP7 手机发送到 PC](https://stackoverflow.com/questions/4842534/send-data-from-wp7-phone-to-pc-via-usb-cable)），因此您需要做的就是编写一个在您的计算机上运行的服务器程序和设备上的客户端（我不建议反其道而行之）。然后服务器将颜色信息发送给客户端，然后您的程序相应地设置手机的屏幕颜色。

网络类包含在`System.Net`命名空间中，但您最终可能会在`System.IO`.

我的纯粹主义者想推荐`Socket`直接使用类，但我发现`NetworkStream`该类更易于使用，因为它符合 .NET 的双向流约定（并且不必自己管理缓冲区）。

# c# - 行走 NHibernate 实体的 IQueryable 时出现消息“plan b”的 Antlr 异常

> ID：11509283
> 
> 赞同：11
> 
> 时间：2012-07-16T17:18:34.953
> 
> 标签：c#, linq, nhibernate, fluent-nhibernate

尝试实现`IQueryable`I got form时，我遇到了非常奇怪的异常`NHibernate.Linq`。type 的例外`Antlr.Runtime.Tree.RewriteEmptyStreamException`只是 states `plan b`，仅此而已。可以在[http://pastebin.com/kR2dvDHd找到详细的异常](http://pastebin.com/kR2dvDHd)

这是引发异常的代码：

```
var matterExtractor = new MatterExtractor();
var InactiveMatters = matterExtractor.GetMattersAtStatus(General.InactiveMatterStatus);
Assert.IsNotNull(InactiveMatters); //OK
Assert.IsInstanceOfType(InactiveMatters, typeof (IQueryable<Matter>)); // OK
var MaterializedMatters = InactiveMatters.ToList(); //Exception is thrown 
```

物质提取器类很简单，如下所示：

```
public class MatterExtractor
{
    public virtual IQueryable<Matter> GetMattersAtStatus(MatterStatus status)
    {
        return
            (new NHibernateRepository.Repository<Matter>()).Where(
                m => m.MatterStatusHistories.OrderByDescending(msh => msh.CreateTime).FirstOrDefault().MatterStatus == status);
    }
} 
```

`NHibernateRepository.Repository<T>`是一个实用程序类，它通过`NHibernate.LINQ`扩展方法实现 IQueryable 到`NHibernate.Session`. 这里没有什么特别的，但以防万一，这里是清单： http: [//pastebin.com/MgDxDg3Y](http://pastebin.com/MgDxDg3Y)

我认为它与 NHibernate 映射无关，因为与`Matter`实体交互的其他测试运行得很好。很可能它与该`Where`子句有关，但我不明白该子句出了什么问题。我试过更换

```
OrderByDescending(msh => msh.CreateTime).FirstOrDefault() 
```

至

```
OrderBy(msh => msh.CreateTime).LastOrDefault() 
```

但它只是告诉我`The LastResultOperator result operator is not current supported`，所以我认为`NHibernate.Linq`不能留下来`LastOrDefault`。

任何想法是什么`plan b`意思，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-23T15:31:58.770

你确定 OrderByDescending(msh => msh.CreateTime).FirstOrDefault()

没有为存储库中的任何元素返回 null 吗？在我看来，那段代码是有问题的。

(...OrderByDescending(msh => msh.CreateTime).FirstOrDefault() ?? someDummyStatusNotSatisfyingClause)

或许能解决你的问题。

另一种可能性是您没有指示 NHibernate 如何/何时实现实体定义中的状态历史。我对 NHibernate 的经验是，像您尝试的某些查询可能更适合作为存储库函数（存储过程）

# c++ - 用 Pattern 初始化 `constexpr` 数组

> ID：11509284
> 
> 赞同：2
> 
> 时间：2012-07-16T17:18:39.400
> 
> 标签：c++, templates, c++11, template-meta-programming, constexpr

我想`constexpr`用使用可变参数模板参数生成的模式初始化一个数组。为简单起见，考虑使用`constexpr unsigned`类型列表的大小初始化静态数组的问题，例如`unsigned, short, char, int, long`. 我怎样才能做到这一点，以便*在编译期间完成所有计算？*我需要解决方案才能很好地使用 C++ 类型系统，所以我不能使用宏。

我能想到的最好的结果如下所示，~~但使用`g++ -std=c++11 -Wall -Ofast -S`（使用 g++ 4.7）进行编译和检查程序集清楚地表明，这些值在运行时被推入堆栈。有任何想法吗？~~ **并且工作正常**。

*如果我能以某种方式告诉扩展n +1*关于扩展*n*，则使用如下的数组初始化程序将起作用。

`static constexpr unsigned foo[] = { compute_element<Args>::value... };`

**编辑：**等等，没关系，我脑子有问题。上面的行工作正常......

**这是~~代码~~答案**：

```
#include <iostream>

template <class... Args>
struct foo
{
    static constexpr unsigned bar[] = { sizeof(Args)... };
};

int main()
{
    std::cout << foo<unsigned, short, char, int, long>::bar[2] << std::endl;
    return 0;
} 
```

非常感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:21:33.920

这是答案。请记住，由于 C++ 的限制，我认为这只能在编译时完成，以创建与可变参数模板参数包大小相同的数组。

```
#include <iostream>

template <class... Args>
struct foo
{
    static constexpr unsigned bar[] = { sizeof(Args)... };
};

int main()
{
    std::cout << foo<unsigned, short, char, int, long>::bar[2] << std::endl;
    return 0;
} 
```

# java - PMD ：该方法具有圈复杂度 10\. 有什么替代方案或者可以吗？

> ID：11509287
> 
> 赞同：0
> 
> 时间：2012-07-16T17:18:54.557
> 
> 标签：java

此方法为表单中的每个文本字段调用不同的验证方法，并且 Map 中的 int[] 数组决定对文本字段执行哪些方法或哪种类型的验证。但是这种方法的圈复杂度为 10。请提出更好的替代方案或可以做些什么来改进此代码？

```
public final boolean validateFields(final HashMap<JTextField, int[]> textFieldMap) {
        boolean flag = false;
        for (Map.Entry<JTextField, int[]> entry : textFieldMap.entrySet()) {
            JTextField field = entry.getKey();
            for (int constant : entry.getValue()) {
                switch (constant) {
                    case Constants.VAL_CHAR : flag = validateChar();
                        break;
                    case Constants.VAL_DATE : flag = validateDate();
                        break;
                    case Constants.VAL_DUPLICATE : flag = validateDuplicate();
                        break;
                    case Constants.VAL_EMAIL : flag = validateEmail();
                        break;
                    case Constants.VAL_LENGTH : flag = validateLength();
                        break;
                    case Constants.VAL_NUMERIC : flag = validateNumeric();
                        break;
                    case Constants.VAL_STRING : flag = validateNumeric();
                        break;
                    default : flag = validateNotNull();
                        break;
                }
            }
        }
        return flag;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:25:11.433

我不知道这是否适用于您的情况，但您可以使用枚举而不是 int 常量：

```
public enum Constants {

    VAL_CHAR {
        public boolean validate() {
            return validateChar();
        }
    },
    VAL_DATE {
        public boolean validate() {
            return validateDate();
        }
    },
    ...
    ;

    public abstract boolean validate();

} 
```

然后，您可以像这样重构您的代码：

```
public final boolean validateFields(final HashMap<JTextField, int[]> textFieldMap) {
    boolean flag = false;
    for (Map.Entry<JTextField, int[]> entry : textFieldMap.entrySet()) {
        JTextField field = entry.getKey();
        for (int constant : entry.getValue()) {
            Constants enumConstant = ...; //mapping from int if you need to keep ints
            flag = enumConstant.validate();
        }
    }
    return flag;
} 
```

或者只是摆脱整数：

```
public final boolean validateFields(final HashMap<JTextField, Constants[]> textFieldMap) {
    boolean flag = false;
    for (Map.Entry<JTextField, Constants[]> entry : textFieldMap.entrySet()) {
        JTextField field = entry.getKey();
        for (Constants constant : entry.getValue()) {
            flag = constant.validate();
        }
    }
    return flag;
} 
```

PS：在您当前的代码中，您可能的意思是`flag = flag && validateXXX()`除非您只想返回与最后检查的字段相对应的标志。

# c# - 我们如何从矩阵中获取旋转角度？

> ID：11509294
> 
> 赞同：-1
> 
> 时间：2012-07-16T17:19:31.877
> 
> 标签：c#, javascript, css, matrix, svg

请任何人解释一下我将如何从其矩阵属性中获取以下图像的 x、y 和旋转角度？

```
<image
   y="-136.18584"
   x="343.87161"
   id="image3000"
   xlink:href="file:///C:/Users/gaurav/Documents/testing.jpg"
   height="369"
   width="360"
   transform="matrix(0.75329963,0.65767748,-0.65767748,0.75329963,0,0)" /> 
```

我数学太弱了，请帮帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:36:55.880

根据[Coordinate Systems, Transformations and Units – SVG 1.1 (Second Edition)](http://www.w3.org/TR/SVG/coords.html#TransformMatrixDefined)，如果我的袖珍计算器是正确的，它大约是 41 度，逆时针。

第一个值`0.75329963`是 cos(theta)，其中 theta 是寻找的角度。因此，您只需计算该值的反余弦值并得到结果。

x&y 定义旋转的中心。确切的值取决于开发人员的意图。换句话说：旋转图像后放置图像的位置。它们的效果还取决于图像大小。

# objective-c - 在代码中为 UITextField 分配方法

> ID：11509296
> 
> 赞同：0
> 
> 时间：2012-07-16T17:19:41.533
> 
> 标签：objective-c, uitextfield

我的视图底部有一个文本字段。当您单击编辑它时，键盘将其覆盖，您无法看到您正在输入的内容。我想创建一种方法，在编辑此文本字段时重新调整视图。

如果我通过界面生成器声明了文本字段，那么我知道我所要做的就是链接（ctrl 单击然后拖动）它。但是我有在代码中声明的文本字段，所以我想知道如何为它分配一个方法。

我想做的伪代码：

```
if (the text field is currently being edited){
    call method: adjust view
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:24:51.233

在 .h 中实现 UITextFieldDelegate，如下所示：

`@interface ShippingInfoViewController : UIViewController < UITextFieldDelegate>`

并确保将您的 textField 的委托设置为`self`

然后您可以访问许多方法，例如

`- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {`

`-(void) textFieldDidBeginEditing:(UITextField *)textField{`

`-(BOOL)textFieldShouldReturn:(UITextField *)textField{`

`- (void)textFieldDidEndEditing:(UITextField *)textField {`

和许多其他人。

[苹果参考](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextField_Class/Reference/UITextField.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:24:30.247

创建文本字段时，将其委托设置为 self。

```
[textField setDelegate:self]; 
```

然后实现委托方法

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    //adjust view here
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    //move view back to correct position here
} 
```

您还可以注册 UIKeyboardWillShow/UIKeyboardWillHide 或 UIKeyboardDidShow/UIKeyboardDidHide 消息并为此实现功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:49:48.790

使用以下功能：

```
- (void)viewWillAppear:(BOOL)animated
{
   [super viewWillAppear:animated];

   [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillShow:) name:UIKeyboardWillShowNotification object:nil];

   [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UIKeyboardWillHideNotification object:nil];
}

- (void)keyboardWillShow:(NSNotification *)notification
{  
  [self moveTextViewForKeyboard:notification up:YES];
}

- (void)keyboardWillHide:(NSNotification *)notification
{
  [self moveTextViewForKeyboard:notification up:NO];
}

- (void)moveTextViewForKeyboard:(NSNotification*)notification up:(BOOL)up {
   NSDictionary *userInfo = [notification userInfo];
   NSTimeInterval animationDuration;
   UIViewAnimationCurve animationCurve;
   CGRect keyboardRect;

  [[userInfo objectForKey:UIKeyboardAnimationCurveUserInfoKey] getValue:&animationCurve];
  animationDuration = [[userInfo objectForKey:UIKeyboardAnimationDurationUserInfoKey] doubleValue];
  keyboardRect = [[userInfo objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue];
  keyboardRect = [self.view convertRect:keyboardRect fromView:nil];

  [UIView beginAnimations:@"ResizeForKeyboard" context:nil];
  [UIView setAnimationDuration:animationDuration];
  [UIView setAnimationCurve:animationCurve];

 if (up == YES) {
    CGFloat keyboardTop = keyboardRect.origin.y;
    CGRect newTextViewFrame = self.noteTextView.frame;
    originalTextViewFrame = self.noteTextView.frame;
    newTextViewFrame.size.height = keyboardTop - self.noteTextView.frame.origin.y - 10;

    self.noteTextView.frame = newTextViewFrame;
 } else {
    // Keyboard is going away (down) - restore original frame
    self.noteTextView.frame = originalTextViewFrame;
 }

  [UIView commitAnimations];
} 
```

对 originalTextViewFrame 使用静态变量：

```
static CGRect originalTextViewFrame; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T17:23:57.930

您必须为文本视图分配一个委托：

```
[textView setDelegate: self] 
```

我假设，那`self`是你的视图控制器，它需要符合[`UITextViewDelegate`协议](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextViewDelegate_Protocol/Reference/UITextViewDelegate.html#//apple_ref/occ/intf/UITextViewDelegate)。文本视图将在开始其编辑周期时调用`textViewShouldBeginEditing:`/ 。`textViewWillBeginEditing`

# asp.net - ListView 评估具有多个变量的项目模板

> ID：11509298
> 
> 赞同：1
> 
> 时间：2012-07-16T17:19:46.630
> 
> 标签：asp.net, .net, listview, data-binding

我试图在我的 ListView 控制器的项目模板中打印出包含图像标记的行。我已经尝试了多种方法，但都没有成功。

```
<ItemTemplate>
  <tr id="itemTemplate" runat="server">
    <td>
      <asp:Literal ID="litImg" runat="server" Text='<%= "<img src="" & PathtoImg & "ProcessImage.aspx?Img=" & Eval("Img") & "&amp;PID="Resize"" alt=""ProductID"" />")))) %>' />
     </td>
     <td>
         <asp:Literal ID="litID" runat="server" Text='<%# Eval("Department") %>' />
     </td>
    </tr>
</ItemTemplate> 
```

第一个 eval 不起作用（并且有点像集群），第二个简单的行起作用。它没有错误，但它显示

显然这不起作用

```
<img src="<%= PathtoImg %>ProcessImage.aspx?Img=<%= Eval("Img")%>&amp;PID=Resize" alt="ProductID" /> 
```

因为它给出了错误

> “Eval()、XPath() 和 Bind() 等数据绑定方法只能在数据绑定控件的上下文中使用。”

这是我第一次使用 Listview，对这些模板非常陌生。我想要的 - 在图像标签的 src 中显示带有服务器变量的数据项 - 可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:11:15.827

使用代码隐藏函数或 runat="server" 您的 HTML 控件：

**标记：**

```
<ItemTemplate>
  <tr id="itemTemplate" runat="server">
    <td>
       <asp:Image id="Image1" runat="server" 
                    ImageUrl="<% GetImageUrl(Eval("Img"), PathToImg))%>"/>
     </td>   
    </tr>
</ItemTemplate> 
```

**代码隐藏：**

```
protected string GetImageUrl(object img, string pathToImg)
{
     //example business logic, change for your needs
     //build your url etc....
     string imgPathFromDb = (string)img;

     return PathToImg + imgPathFromDb; 

} 
```

其他选项：

```
<img runat="server" src="<%# PathtoImg %>ProcessImage.aspx?Img=<%# Eval("Img")%>&amp;PID=Resize" alt="ProductID" /> 
```

# assembly - 在加载程序后插入 FAT

> ID：11509301
> 
> 赞同：1
> 
> 时间：2012-07-16T17:19:58.190
> 
> 标签：assembly, filesystems, boot

我正在尝试制作引导加载程序，它将第二阶段加载到内存中。完成后，我想从 FAT12 文件系统加载文件。我的问题是我不知道如何在为引导和第二阶段保留的扇区之后添加 FAT（FAT12 为 2）。我不能使用格式化工具，因为它在软盘启动时启动并且有引导加载程序。有谁知道这怎么可能？我正在阅读[本](http://www.brokenthorn.com/Resources/)教程，但没有写如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:03:57.127

FAT12 文件系统为引导扇区保留前 512 个字节。一个好的格式化工具可以让您将自定义引导扇区加载到磁盘上。

我使用[UltraISO](http://www.ezbsystems.com/ultraiso/)来创建磁盘映像。它让您：

*   一键在磁盘映像中添加或提取文件。
*   创建音频 CD、数据 CD/DVD、可启动 CD/DVD 以及软盘和 HDD 映像。
*   使用来自 MS-DOS 和 Windows 等磁盘的预定义引导扇区。
*   在物理磁盘上刻录和翻录图像文件。
*   和更多。

要使用 UltraISO 创建可引导软盘，只需创建一个空的软盘映像，然后在其上加载引导扇区。然后，您可以轻松添加或删除文件，或加载新的引导扇区。

# jquery - jQuery 的 submit() 不会被解雇

> ID：11509308
> 
> 赞同：0
> 
> 时间：2012-07-16T17:20:40.290
> 
> 标签：jquery

我有以下代码，但它不起作用我认为问题出在我的函数声明周围，但不确定如何调试它。欢迎任何帮助。

```
<script type="text/javascript">
$(function(){   
if ($('select#prod_category').val() == ''){
          $('select#prod_group').hide();
          }
if ($('select#prod_group').val() == ''){
          $('select#product').hide();
          } 
$("form#g_search select").change(function(){
    $("div#gutschein_filter form#g_search").submit(function(){
        event.preventDefault();
        window.location.href = "/folder/" +
        encodeURI($("#prod_category").val()) + "/" +
        encodeURI($("#prod_group").val());
    });

  });
});
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:23:57.630

```
$("div#gutschein_filter form#g_search").submit(function( event ){                                                     
    event.preventDefault();
    window.location.href = "/folder/" +
    encodeURI($("#prod_category").val()) + "/" +
    encodeURI($("#prod_group").val());
}); 
```

我在您的代码中发现了一个问题。缺少回调函数的`event`参数。`submit`

使用***firebug***或类似的调试器来获取错误。这是关于**[JavaScript 的 firebug](http://getfirebug.com/javascript/)**。

# java - 通过 Java 在 .csv 文件中添加 ListBox

> ID：11509309
> 
> 赞同：0
> 
> 时间：2012-07-16T17:20:42.770
> 
> 标签：java, csv, drop-down-menu, openoffice.org

我在 openoffice 中有一个 .CSV（或 .ods）文件。我想将选项列表添加到列中。例如，

Language_Annotated，文本摘要
英语，等等等等

法语

意大利语

乌尔都语

因此，对于我的第一列中的每一列，我想通过脚本在其中一个列中添加一个下拉列表。我怎样才能做到这一点？

PS下拉列表：openoffice.blogs.com/openoffice/2007/07/dropdown-lists.html

# ios - 在 Objective-C 中设置另一个类的属性

> ID：11509315
> 
> 赞同：1
> 
> 时间：2012-07-16T17:21:09.047
> 
> 标签：ios, objective-c, class, properties

我在尝试设置将由另一个类设置的属性时遇到问题，这里有两个属性将用于填充表：

```
@interface TableViewController : UITableViewController
    @property (nonatomic, retain) NSArray *friendsNames;
    @property (nonatomic, retain) NSArray *friendsIDs;
@end 
```

在这个类（继承自`NSObject`）中，我使用这种方法设置它们：

```
@implementation MyFacebooDelegate

-(void)getFriends:(NSArray *)names {
    NSMutableArray *friendsNames = [[NSMutableArray alloc] init];
    NSMutableArray *friendsIDs = [[NSMutableArray alloc] init];
    for (int i=0; i<[names count]; i++) {
        NSDictionary *friend = [names objectAtIndex:i];
        NSString *name = [friend objectForKey:@"name"];
        [friendsIDs addObject:[friend objectForKey:@"id"]];
        [friendsNames addObject:name];
    }

    if(tableController == nil)
        tableController = [[TableViewController alloc] init];

    [tableController setFriendsIDs:friendsIDs];
    [tableController setFriendsNames:friendsNames];
    NSLog(@"%@", [tableController friendsNames]); 

    [friendsNames release];
    [friendsIDs release];
} 
```

这些名称都打印在控制台 ( `NSLog(@"%@", [tableController friendsNames])`) 上，但不在 TableViewController 类中。

如果我尝试在`viewDidLoad`TableViewController 类中打印两个数组的内容，那么它将为空，并且这些数组也是在表格出现在屏幕上之前设置的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:27:49.953

你做错了......你应该设置`MyFaceboo` `delegate`为`UITableViewController`'s `tableView`的数据源并实施`UITableViewDataSourceProtocol`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:40:08.023

Assuming that you would use value of `friendNames` & `friendIds` from with in `UITableViewController` (that would implement `UITableViewDataSource` .. I do not see it in your snippet so mentioning it)

Can you re-write your properties as (assuming you are using ARC):

```
@property (nonatomic, strong) NSArray *friendsNames;
@property (nonatomic, strong) NSArray *friendsIDs; 
```

and use this syntax:

```
tableController.friendNames = friendNames;
tableController.friendIDs = frinedIDs 
```

and make sure that you do show the `tableController` that you are creating here and not some other (it is not clear from your snippet how you are showing/pushing this `tableController` so mentioning it)

# macos - 将预安装的应用程序/包转换为 Homebrew

> ID：11509316
> 
> 赞同：0
> 
> 时间：2012-07-16T17:21:13.373
> 
> 标签：macos, command-line, installation, uninstallation, homebrew

我真的很喜欢家酿。然而，在我了解神奇的 OS X 包管理器*之前*，我一直遇到我安装的东西的问题。

我得到的是：

```
Error: The linking step did not complete successfully
The formula built, but is not symlinked into /usr/local
You can try again using `brew link [name]' 
```

这当然也失败了。也许我遗漏了一些东西——我觉得这个问题*一定*是在某个地方问过的，但我找不到。卸载应用程序的 Homebrew 版本，然后`brew link`在其上运行也会失败（因为没有桶`/usr/local/Cellar`）。

这是公式编写者的问题，而不是 Homebrew 本身的问题吗？似乎通过 Homebrew 提供的大部分软件也不是具有简单卸载过程的软件，这可能是问题的一部分。

只需删除初始（Homebrew 前）安装时放置的文件，我就可以开始工作。这非常耗时，我希望有一些更自动化的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:53:03.427

（您显然不能像标题所暗示的那样“将预安装的应用程序/软件包转换为 Homebrew”；您必须删除它们并安装 brew 替代品。鉴于您的问题文本，您显然已经知道这一点，所以我并不是说这是光顾之类的，以防其他读者感到困惑。）

真的没有什么可以自动做你想做的事。如果你仔细想想，真的不可能——如果你在没有包管理器的情况下安装了一些东西，那么就没有安装过程的记录，所以没有办法自动卸载它。

在某些情况下，您只需 cd 进入源代码并“进行卸载”即可。在其他情况下，您可以查看 brew 将安装的内容，并假设您的 pre-brew 安装创建了完全相同的文件集。（我想你甚至可以用脚本自动化它。）安装至少会告诉你它失败的原因，以及你必须删除哪些文件（你也可以用脚本自动化——尽管如果你只完全删除那些你经常会留下很多配置/等信息的文件）。

但无论如何，如果您希望 brew 和非 brew 的东西共享 /usr/local （这通常有效，并且似乎是官方推荐的），您必须手动处理冲突，因为它们出现了。

有关更多信息，请参阅[常见问题解答](https://github.com/mxcl/homebrew/wiki/FAQ)（如果您还没有）。

如果你想避免痛苦，有几种方法可以做到这一点。以下是选择：

1.  清除 /usr/local 中的所有内容，重新安装 brew，然后重新安装您需要的所有内容（最好使用 Homebrew 版本——如果它们不存在，您通常可以非常轻松地创建自己的公式）。您可能想要备份旧的 /usr/local，以防万一您以后发现“您需要的一切”不完整……这显然是最干净的解决方案，但这意味着重复您已经完成的工作。

2.  将 /usr/local 重命名为 /opt/oldusrlocal 之类的名称，将其放在 /usr/local 之后的路径上，然后让 Homebrew 完全管理 /usr/local。这可能会破坏一些在构建/安装过程中存储绝对路径的包，这意味着您必须重新构建它们（这是切换到 brew 版本的好机会），而且它看起来很hacky，但它工作得很好。

3.  像上面一样重命名 /usr/local，不要把它放在你的路径中，当你发现你需要它时，手动将东西符号链接到 /usr/local 中。

4.  在 /usr/local 之外的某个地方安装 brew（并将其放在 /usr/local 之前的路径上）。正如 Homebrew FAQ 所解释的那样，有一些公式（以及 egss/gems/etc. 之外的公式）不能正常工作（因为几乎每个人都针对 /usr/local 进行测试），但它是可行的。

# php - MySQL 和 CI 的 UTF8 数据问题

> ID：11509319
> 
> 赞同：0
> 
> 时间：2012-07-16T17:21:32.860
> 
> 标签：php, mysql, codeigniter, utf-8, character-encoding

我正在建立一个使用“geoanems”数据库的快速网站，用于世界各地。我正在使用 Mysql、PHP 和 CodeIgniter，但我遇到了 UTF8 地名的问题。我已经导入了数据库，一切都是用 UTF-8 设置的。

但是，我正在运行一个简单的测试，看看我是否可以正确地在浏览器中获取名称，并且我被问号所困扰。MySQL 显示 1123230 的名称和 sname 的正确十六进制，但相同的字符“C481”在 1127766 的 sname 中被剥离并被“3F”替换。

这是怎么回事？看到这是运行十六进制的 MySQL 为什么它改变了值？另外，如果我可以看到一排很好，为什么不能看到另一排？

我已经为 UTF8 设置了服务器，并在 MySQL 上运行检查以查看是否设置正确。这在 CodeIgniter 中也不起作用`:(`。我也发送了“SET NAMES 'UTF8'”，但仍然没有喜悦。

这是 SQL：

```
$sql = 'select geonameid,name,sname, hex( name ) ,hex( sname ) from pp_adm1 where country = "af" COLLATE utf8_general_ci'; 
```

![在此处输入图像描述](../Images/6be6b902b2cb15e30bcd91c04238c086.png)

Sequel Pro - 在 DB 中显示正确的编码

![SequelPro - 在 DB 中显示正确的编码](../Images/15f6fd1212c2d36100851f783e16d1e7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:56:23.563

正如 elvispt 提到的，检查字符集和 dbcollat​​。

以下链接将有助于转换 mysql 的字符集（如果那是问题）

[http://www.bdunagan.com/2011/09/29/converting-mysql-from-latin1-to-utf8/](http://www.bdunagan.com/2011/09/29/converting-mysql-from-latin1-to-utf8/)

要验证字符集和排序规则，您始终可以查询 MySQL 变量：

```
show variables like 'collation%';
show variables like 'character%'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:30:30.277

雅也和我一样。我也有这个问题。你看对了，哪个是 HEX 代码 :) 常见的解决方案是使用 UTF-8 编码文件和 UTF-8 数据库，每当你编写查询，如 SELECT 、 UPDATE 不管什么时，你必须对这个查询进行 ass。

例如：

/* 在查询前添加这一行 */

```
<?php
mysql_set_charset('utf8');
SELECT * FROM bla bla bla....  

?> 
```

还有一件事我想告诉你，每当你连接数据库时，都会添加同样的东西。

例如 。

```
<?php

mysql_set_charset('utf8');
mysql_connect('localhost','root','');
mysql_select_db('yourDatabase');

?> 
```

我希望这个例子会有所帮助。无论如何对不起我的英语不好:(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:43:32.087

在 database.php 中检查`charset`和配置参数。`dbcollat`检查数据库和 CI 上的字符集是否相同。检查 php.ini 也不会有什么坏处`default_charset`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T08:37:33.767

[已修复] - 不知道是什么导致了问题。4 小时后，我放下了受影响的桌子并非常非常小心地重建了它......

HEX() - 函数有很大帮助......！！

对不起所有..不能提供更好的洞察力。

# sqlite - sqlite 如果没有返回行打印 0

> ID：11509320
> 
> 赞同：0
> 
> 时间：2012-07-16T17:21:36.060
> 
> 标签：sqlite

我有以下查询：

```
 SELECT user_tag, device_type,  ip_address

 FROM
 devices 

 WHERE (user_tag like '|%frt%|'
 OR user_tag like '|%bck%|'
 OR user_tag like '|%ppp%|'
 OR user_tag like '|%smes%|'
 OR user_tag like '|%gm%|') 
```

现在，如果只为 user_tag 'frt' 返回记录，我只会收到一行（如您所料）。有没有办法为空白行设置默认值，例如，对于不返回任何真实数据的行，我会收到一个“0”或类似的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:02:06.730

这个查询是一个“草稿”。由于我使用所有类型的 SQL，有时我会遇到特定于 SQLite 的语法问题，而且我现在没有任何方法来测试这个查询，所以它可能需要一些语法修改。

但它的想法是交叉的......**使用您的硬编码值列表，使其成为子查询并对其进行左连接而不是位置。**

当给定类型没有任何用户标签时，user_tag_exists 应该为 0。

```
Select CASE WHEN d.user_tag is null THEN '0' ELSE '1' END AS user_tag_exists,
       tagTypes.tagType,
       d.user_tag, d.device_type, d.ip_address
From
(
    Select '%frt%' as tagType
    UNION
    Select '%bck%' as tagType
    UNION
    Select '%ppp%' as tagType
    UNION
    Select '%smes%' as tagType
    UNION
    Select '%gm%' as tagType
) as tagTypes
left join
    devices d
        on d.device_type like tagTypes.tagType 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:32:42.733

我不确定你是否想要：

1.  列中的值“0”而不是 null
2.  如果不存在类似于值的 user_tag，则为 '0' 的行。

如果您正在寻找 1)，您可以使用 CASE 语句。

```
 SELECT 
        user_tag, 
        CASE WHEN device_type is not null THEN device_type ELSE '0' END as device_type, 
        ip_address

 FROM
 devices 

 WHERE (user_tag like '|%frt%|'
 OR user_tag like '|%bck%|'
 OR user_tag like '|%ppp%|'
 OR user_tag like '|%smes%|'
 OR user_tag like '|%gm%|') 
```

即使**device_type**为空，这也会给您一个**device_type的“0”。**

# jquery - 带有 Knockout JS 和 Jquery 模板的递归 tr

> ID：11509324
> 
> 赞同：1
> 
> 时间：2012-07-16T17:21:43.570
> 
> 标签：jquery, knockout.js, jquery-templates

我要疯了，试图为我的问题找到解决方案。我有一个具有层次结构的 JS 对象，并且层次结构的级别是未知的。使用 JQuery 模板和 Knockout JS 我可以使用`<ul>`&获得树结构，`<li>`但我的要求是，对于每个孩子，我需要在 a 中渲染一个新`Row`的`Table`所以可以说我的结构是：

```
{
    Name: 'First', 
    Total: 100,
    Set: [
        { 
            Name: 'First_1', Total: 30,
            Set: [{Name: 'First_1_1', Total: 10}, {Name: 'First_1_2', Total: 20}]  
        },
        { Name: 'First_2', Total: 0 }
    ]
} 
```

该表应如下所示：

```
<table width="100%">
    <tbody>
    <tr><th>Name</th><th>Total</th></tr>
    <tr><td>First</td><td>100</td></tr>
    <tr><td>First_1</td><td>30</td></tr>
    <tr><td>First_1_1</td><td>10</td></tr>
    <tr><td>First_1_2</td><td>20</td></tr>
    <tr><td>First_2</td><td>0</td></tr>
    </tbody>
</table> 
```

以下是我想出的小提琴：http: [//jsfiddle.net/paragnair/xpsa4/](http://jsfiddle.net/paragnair/xpsa4/)

如果我正在使用`ul` `li`，我可以使用递归调用模板

```
<ul data-bind="template: {name: 'tree1', foreach: Set}"></ul> 
```

但是由于我的模板本身以 a 开头，所以`<tr>`我不确定如何在不使用该`data-bind="template:{...}`部分编写节点的情况下调用模板？初始调用将起作用，因为它在`<tbody>`但我不能在 a`tbody`内`tbody`递归调用模板以呈现 other `tr`。

我希望这个解释是足够的。如果您需要更多详细信息，请告诉我。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:48:12.333

您可以从该模板内部递归调用一个模板，该模板与 foreach 的 $data 上下文属性相结合，可以让您做您正在寻找的事情...我不擅长解释事情，所以我更新了您的 jsfiddle 来做您想做的事重新寻找，[http://jsfiddle.net/xpsa4/5/](http://jsfiddle.net/xpsa4/5/)

# java - 向 GestureDetector 添加事件

> ID：11509325
> 
> 赞同：-1
> 
> 时间：2012-07-16T17:21:44.203
> 
> 标签：java, android, webview, gesturedetector

实际上，我有用于 WebView 的 GestureDetector，它可以工作，我可以通过左右滑动更改页面以加载，但缩放、平移和活动链接已停止工作。这是听众：

```
private GestureDetector.SimpleOnGestureListener sogl = new GestureDetector.SimpleOnGestureListener() {

        public boolean onDown(MotionEvent event) {
            Log.d("Gesture","onDown");
            return true;
        }

        public boolean onFling(MotionEvent event1, MotionEvent event2, float velocityX, float velocityY) {
            if (event1.getRawX() > event2.getRawX()) {
                if(currentPage<maxPage)
                    currentPage++;
                webV.loadUrl("file:///sdcard" + Values.APP_FOLDER + "/" + catalogo +"/versione-html/" + currentPage + estensione);
            } else {
                if(currentPage>1)
                    currentPage--;
                webV.loadUrl("file:///sdcard" + Values.APP_FOLDER + "/" + catalogo +"/versione-html/" + currentPage + estensione);
            }
            return true;
        }
    }; 
```

问题是：我可以将此单个事件（左右滑动）添加到 webview 默认 GestureDetector 吗？我需要在 webview 上缩放并保持活动链接，还需要通过滑动来更改页面。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:38:46.677

Wild guess, but I would consider sending all the touches you receive inside the GestureDetector down to the WebView via `webV.onTouchEvent(event)`

# database - 有没有办法将图形存储在数据库中，以便它易于遍历？

> ID：11509331
> 
> 赞同：0
> 
> 时间：2012-07-16T17:22:17.347
> 
> 标签：database, algorithm, graph

如果我有一个大图，我如何存储它以便它仍然可以轻松遍历，*最好*不必将它拉回内存。这个问题与平台和语言无关。我会选择适合问题的语言和平台，而不是试图用错误的平台强行解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:23:53.890

存在专门为此目的定制的数据库系统，即[图形数据库](http://en.wikipedia.org/wiki/Graph_database)。我自己没有用过，但文章列出了几个这样的系统，其中一些是免费的。

为了完整性：使用存储在常规 SQL 数据库中的图形而不将其全部加载到内存中是可能的，但很麻烦（而且效率不高）。作为一个可能的例子，我的一个朋友[在 T-SQL 中实现了 Dijkstra 的最短路径算法](http://hansolav.net/blog/ImplementingDijkstrasAlgorithmUsingTSQL.aspx)......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:24:13.510

可能图形数据库会满足您的需求。Neo4J就是这样一个数据库系统的java实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:33:30.393

好吧，您可以简单地将图形存储为节点列表，将唯一 ID 附加到每个节点，并将相邻节点 ID 的列表与节点一起存储。

所以基本不用从数据库拉出整个图就可以看到相邻的节点ID，查询数据库中的相邻节点。（节点 ID 是一个很好的主键候选者。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:45:51.117

数据库越来越多地具有帮助解决问题的功能，例如图遍历。

SQL Server 提供递归 CTE，非常适合此目的。Oracle 有“connect by”，可以达到同样的目的。

这是否“容易”取决于您的 SQL 编程技能。我猜答案是否定的。

但是，如果您有一个非常适合数据库的系统，那么除了需要遍历这样的图之外，您还可以将图拟合到许多数据库系统中。

# java - 如何在 Rythm 中编写 WHILE 循环

> ID：11509337
> 
> 赞同：2
> 
> 时间：2012-07-16T17:22:33.790
> 
> 标签：java, template-engine, templating, rythm

我尝试在 HTML 标记中的 Rythm 中编写 While 循环，但我不能

像这样的代码：

```
@{
int i = 0;
while( i< 5){
i++;
}

<h2>hello</h2>

@{
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T05:54:36.200

目前**Rythm**不支持`while`循环。使用`for`循环代替您的情况：

```
@for(int i = 0; i < 5; ++i) {
    <h2>hello</h2>
} 
```

# c# - 函数和文本框作为参数的 C# 错误

> ID：11509341
> 
> 赞同：-5
> 
> 时间：2012-07-16T17:23:01.580
> 
> 标签：c#, parameters

我在编写函数并将参数传递给它时遇到问题。

我的问题是我创建了名为`mySum`. 我已经展示了下面的代码。

注意：我使用了两个文本框从用户那里获取值，该函数应该将这两个值相加并显示在`MessageBox`.

```
void mySum(int a, int b)
{
    int ans;
    ans = a + b;
    MessageBox.Show(ans.ToString());
}

private void button1_Click(object sender, EventArgs e)
{
    //Here i want to ass two text boxes values as given below.
    mySum(txtbox1.text,txtbox2.text); //Here it shows me the error
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:24:59.210

您的函数期望`integer`作为参数。但是您正在传递一个字符串（ Text 属性返回字符串）。所以转换为它。

```
mySum(Convert.ToInt32(txtbox1.Text),Convert.ToInt32(txtbox2.Text)); 
```

您可以在转换之前检查 null 值/是否为有效数值，否则 ToInt32 函数将抛出异常。利用`Int32.TryParse`

```
int value1=0;
int value2=0;
int result;

if (!Int32.TryParse(txtbox1.Text, out value1))
{   
   MessageBox.Show("Not valid number");
   return;
}  
if (!Int32.TryParse(txtbox2.Text, out value2))
{   
   MessageBox.Show("Not valid number");
   return;
}

mySum(value1,value2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:26:03.057

将文本框值解析为整数：

```
mySum(int.Parse(txtbox1.text),int.Parse(txtbox2.text)); 
```

添加适当的错误处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T17:26:09.547

```
private void button1_Click(object sender, EventArgs e)
    {

          mySum(Int32.Parse(txtbox1.text), Int32.Parse(txtbox2.text));          

    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T17:26:51.840

只需这样做：

```
int mySum(string a, string b)
    {
       return Convert.ToInt32(a) + Convert.ToInt32(b);
    } 
```

在文件后面的代码中，像这样调用上面的函数：

```
 MessageBox.Show(mySum(txtbox1.Text,txtbox2.Text)..ToString()); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-16T17:28:43.637

问题是 thsat txtBox1.Text 不是存储为 int，而是存储为字符串。您需要使用 System.Int32.TryParse***安全地***查看文本是否为字符串并将其转换为 int。

```
private void button1_Click(object sender, EventArgs e)
{

     int firstInt = -1;
     int secondInt = -1;

    if(!System.Int32.TryParse(txtbox1.Text, out firstInt)
    {
       MessageBox.Shw("Invalid value in Textbox 1");
       return; // Stop procesing
    }
    if(!System.Int32.TryParse(txtbox2.Text, out secondInt)
    {
       MessageBox.Show("Invalid value in Textbox 2");
       return; // Stop procesing
    }
    //Here i want to add the values from two text boxes values as given below.
     mySum(firstInt, secondInt); //Here it shows me the error . Please help me.           
 } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-16T17:25:45.587

您将 s 传递`string`给期望`int`s 尝试的函数

```
mySum(int.Parse(txtbox1.text),int.Parse(txtbox2.text)) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-16T17:25:55.100

`Textbox.Text`属性返回字符串。在你的函数声明中，你传递了两个整数。所以你需要将字符串转换为整数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-16T17:28:20.423

C# 没有从 String 到 Int32 的隐式转换，因此如果您的方法采用 int 参数，则必须在传入之前将该值转换为 int。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-16T17:29:00.113

这不是执行此操作的好方法。

我推荐这个：

```
public int mySum(int a, int b)
{
    return a + b;
} 
```

然后在您的活动中，执行以下代码：

```
var t1 = int.Parse(txtbox1.text);
var t2 = int.Parse(txtbox2.text);
MessageBox.Show(mySum(t1,t2)) 
```

...请记住，如果您的文本框实际上没有保存整数值，则会出现问题。您可以查看`int.TryParse()`更强大的解决方案。

# html - 如何用 CSS 和一些 JS 布局这样的表单？

> ID：11509343
> 
> 赞同：2
> 
> 时间：2012-07-16T17:23:17.087
> 
> 标签：html, css

我有一个在文本字段左侧内嵌表单标签的设计。标签都是不同的宽度。我需要使文本字段的右边缘右对齐。

**目前，这些字段看起来像这样。看看右边缘如何不对齐？**

姓名：***_* __ *_* __ *_* __ *_* ___**

地址：***_* __ *_* __ *_* __ *_* ___**

城市：***_* __ *_* __ *_* __ *_* ___**

**我需要它看起来像这样......**

姓名：***_* __ *_* __ *_* __ *_* __ *_* __**

地址：***_* __ *_* __ *_* __ *_* ___**

城市：***_* __ *_* __ *_* __ *_* __ *_* ____**

我可以这样做而不必在每个文本字段上设置固定宽度吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:48:36.340

当然，这可能不是最有效的方法，但您可以为每个字段制作一个单独的表。

**HTML**

```
<table>
    <tr>
        <th>Name:</th>
        <td><input type="text"></td>
    </tr>
</table>

<table>
    <tr>
        <th>Address:</th>
        <td><input type="text"></td>
    </tr>
</table>

<table>
    <tr>
        <th>City:</th>
        <td><input type="text"></td>
    </tr>
</table> 
```

**​CSS**

 **```
table { width: 300px; }
td { border-bottom: 1px solid black; }
th { width: 1em; }

input { width: 100%; border: none; }
input:focus { outline: none; } 
```

​ ​ JS 小提琴： http: [//jsfiddle.net/BUy6f/2/](http://jsfiddle.net/BUy6f/2/) ​</p>

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T17:26:12.137

您可以使用无边框表格，如下所示：[示例](http://jsfiddle.net/A84c2/)**

# ruby-on-rails - 报价网站上的保留价

> ID：11509348
> 
> 赞同：0
> 
> 时间：2012-07-16T17:23:36.770
> 
> 标签：ruby-on-rails

我在用户输入报价的网站（如投标系统）上需要重新定价的代码有问题，但报价将得到验证，如果高于保留价，则接受，如果低于，再试一次等.

关于如何在 ruby​​ on rails 中执行此操作的指针的任何想法？我为用户完成了大部分代码，只是这部分我发现很难研究。

因此，他们的用户将有一个输入字段，他们在验证之前输入价格。（明显地）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:33:10.960

您没有提供太多关于您的业务对象的信息，因此我将做出一些假设。我的假设是：

1.  您正在制作 eBay 克隆，因此您有两个相关模型：`Item`和`Bid`.
2.  一个`Item`可以有多个出价
3.  `Item`有一个属性，`reserve_price`（小数？）
4.  A`Bid`有一个属性，`amount`（也是一个小数）

如果您只想创建满足`Item`其所属底价的出价，您将需要使用自定义验证器。这是通过调用`validate`你的模型来完成的，当你的模型得到验证时，将你想要调用的方法的名称（作为符号）传递给它。像这样：

```
class Bid < ActiveRecord::Base

    belongs_to :item

    validate :ensure_meets_reserve_price

    private
    def ensure_meets_reserve_price
        if amount < self.item.reserve_price
            errors.add(:amount, "does not meet reserve price")
        end
    end

end 
```

请记住，这是对您的要求做出很多假设，但希望这能展示 Rails 的自定义验证器。在此示例中，如果`amount`指定的 for`Bid`不符合 的保留价格，`Item`则不会创建出价，并且会提供一条错误消息，您可以向用户显示。

# sql - 如何修改加入以获得相同的价格以匹配

> ID：11509349
> 
> 赞同：1
> 
> 时间：2012-07-16T17:23:47.387
> 
> 标签：sql, sql-server-2008

我有一个运行良好的比较查询，但我有许多结果，我认为应该匹配的价格出现在不同的行中。有什么好方法可以让他们匹配给定的代码和帐户，以便将他们排除在我的结果集中吗？

询问：

```
with cteDev3 (Sequence, AccountID, SecurityID, Ticker, UniqueAccountID, BuyPrice, BuyDate, Shares)as
      (select Al.Sequence, Al.AccountID, al.SecurityID, s.Ticker,ad.UniqueAccountId, BuyPrice, BuyDate, Shares
        from dev3TM2.dbo.AccountLot al
        join dev3TM2.dbo.AccountDetails ad
        on al.AccountID = ad.AccountId
        join dev3TM2.dbo.Security s
        on al.SecurityId = s.SecurityId
        where ad.EnterpriseId = 'HuberFinancial'),
    cteTest2 (Sequence, AccountID, SecurityID,Ticker, UniqueAccountID, BuyPrice, BuyDate, Shares)as
       (select Al.Sequence, Al.AccountID, al.SecurityID, s.Ticker,ad.UniqueAccountId, BuyPrice, BuyDate, Shares
        from test2TM2.dbo.AccountLot al
        join test2TM2.dbo.AccountDetails ad
        on al.AccountID = ad.AccountId
        join Test2TM2.dbo.Security s
        on al.SecurityId = s.SecurityId
        where ad.EnterpriseId = 'HuberFinancial')

select c3.UniqueAccountId as 'Dev3', t2.UniqueAccountId as 'Test2',c3.Ticker, t2.Ticker,
       c3.Shares,t2.Shares, c3.BuyDate, t2.BuyDate, c3.BuyPrice as 'Dev3_BuyPrice', t2.BuyPrice as 'Test2_BuyPrice'
from cteTest2 t2 full outer join
     cteDev3 c3
     on c3.UniqueAccountId = t2.UniqueAccountId
where
--c3.UniqueAccountID is null or t2.UniqueAccountID is null and
        c3.SecurityID = t2.SecurityID and
        c3.BuyDate = t2.BuyDate and
       c3.Shares = t2.Shares and
        (c3.BuyPrice <= t2.BuyPrice -0.001 or c3.BuyPrice >=t2.BuyPrice + 0.001) 
        --c3.BuyPrice = t2.BuyPrice
order by c3.UniqueAccountID, t2.UniqueAccountID, c3.Ticker, t2.Ticker, c3.BuyDate, t2.BuyDate,
c3.BuyPrice, t2.BuyPrice 
```

结果集（部分）：

```
Dev3 | Test2 | Ticker | Ticker | Shares | Shares | BuyDate | BuyDate | Dev3_BuyPrice | Test2_BuyPrice
10735975 | 10735975 | TLM | TLM | 100.000000 | 100.000000 | 2012-01-12 00:00:00 | 2012-01-12 00:00:00 | 11.859000 | 11.860000
10735975 | 10735975 | TLM | TLM | 100.000000 | 100.000000 | 2012-01-12 00:00:00 | 2012-01-12 00:00:00 | 11.860000 | 11.859000
11123259 | 11123259 | EDC | EDC | 0.297700 | 0.297700 | 2010-03-31 00:00:00 | 2010-03-31 00:00:00 | 163.329750 | 163.318777
11123259 | 11123259 | EDC | EDC | 0.337700 | 0.337700 | 2010-06-30 00:00:00 | 2010-06-30 00:00:00 | 110.489221 | 110.482677
11123259 | 11123259 | EDC | EDC | 1.379500 | 1.379500 | 2011-03-30 00:00:00 | 2011-03-30 00:00:00 | 201.048191 | 201.051105
11123259 | 11123259 | EDC | EDC | 0.023500 | 0.023500 | 2011-03-30 00:00:00 | 2011-03-30 00:00:00 | 201.105442 | 201.276596
11123259 | 11123259 | EDC | EDC | 1.022900 | 1.022900 | 2011-06-29 00:00:00 | 2011-06-29 00:00:00 | 179.398940 | 179.391925
11123259 | 11123259 | EDC | EDC | 0.063500 | 0.063500 | 2011-06-29 00:00:00 | 2011-06-29 00:00:00 | 179.414542 | 179.527559 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:20:20.000

也许我遗漏了一些东西，但是您看到的价格差异不到十分之一美分（好吧，我假设是美元）。

你给出的例子似乎相差这么多。

也许你应该尝试：

```
abs(c3.BuyPrice - t2.BuyPrice) >= 0.01 
```

这将消除您拥有的大多数示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:54:46.973

将价格和数量字段的类型从浮点更改。您不想要这种类型的舍入误差，各种会计师和认证机构也不想要。可以是内置的[Money](http://msdn.microsoft.com/en-us/library/ms179882.aspx)类型，也可以是带有您自己的刻度的整数类型来放置小数点，最好是前者。

# prolog - Herbrand 宇宙、Herbrand Base 和 Herbrand 二叉树模型 (prolog)

> ID：11509350
> 
> 赞同：4
> 
> 时间：2012-07-16T17:23:48.597
> 
> 标签：prolog

二叉树的 Herbrand 宇宙、Herbrand Base 和 Herbrand 模型是什么：

```
binary_tree(empty). 
binary_tree(tree(Left,Element,Right)) :- 
     binary_tree(Left), 
     binary_tree(Right). 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T19:12:59.457

Herbrand 宇宙是给定签名的基本术语。许多 Prolog 系统都有一个谓词 ground/1，您可以使用它来检查一个术语是否实际上是 ground。ground/1 的定义是它不包含变量：

```
?- ground(empty).
Yes
?- ground(tree(X,Y,Z)).
No 
```

Herbrand 基础是给定签名的基本公式。素数公式是谓词或等式。您还可以使用 ground/1 来检查素数公式是否为地面：

```
?- ground(a = X).
No
?- ground(a = b).
Yes
?- ground(binary_tree(X)).
No
?- ground(binary_tree(tree(empty,n,empty))).
Yes 
```

Herbrand 模型是宇宙是 Herbrand 宇宙的模型。Herbrand 模型从图表的角度来看是 Herbrand 基础的子集。一个理论可能没有、一个或多个 Herbrand 模型。

喇叭子句总是有一个 Herbrand 模型，特别是作为 Herbrand 基础的完整 Herbrand 模型，始终是一个模型。喇叭子句和克拉克方程理论也有一个独特的最小 Herbrand 模型。这是 Herbrand 程序操作员的固定点。程序运算符的某些属性允许声明可以在 omega 阶段达到固定点。

但是使用 Herbrand 模型很笨拙，因为它们没有排序。许多排序的签名和相应的地面模型更方便。为简单起见并避免在当前情况下出现许多排序逻辑，我们可以假设您的程序读取，即树元素是 peano 数字：

```
binary_tree(empty). 
binary_tree(tree(Left,Element,Right)) :- 
    binary_tree(Left),
    tree_element(Element), 
    binary_tree(Right).
tree_element(n).
tree_element(s(X)) :-
    tree_element(X). 
```

然后您的二叉树定义将导致以下递归关系：

```
T_0 = {}
T_n+1 = {binary_tree(empty)} u {binary_tree(tree(s,e,t)) | 
       binary_tree(s) in T_n, 
       tree_element(e) in T_n, 
       binary_tree(t) in T_n } u 
        {tree_element(n)} u {tree_element(s(e)) |
       tree_element(e) in T_n} u T_n 
```

唯一的最小 Herbrand 模型将是 T = union_n T_n，这是上述递归关系的最小固定点。好像什么都没说。

# excel - 检查其他两个工作表中是否存在单元格值

> ID：11509351
> 
> 赞同：0
> 
> 时间：2012-07-16T17:23:48.720
> 
> 标签：excel, excel-2007, vba

我正在尝试在几个不同的工作表中跟踪 ID，并且我希望能够为一个标准提供 True 值，而为另一个标准提供 false 值。这是我想要完成的伪代码。

```
IF sheet1.A1.value EXISTS AND DOES NOT EXIST IN sheet2.A:A OR sheet3.A:A
THEN RETURN "true"
ELSE RETURN "false" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:31:14.770

试试这个

```
Sub Sample()
    Dim SearchString As String

    SearchString = "Blah"

    If Application.WorksheetFunction.CountIf(Sheets("Sheet1").Columns(1), SearchString) > 0 And _
    Application.WorksheetFunction.CountIf(Sheets("Sheet2").Columns(1), SearchString) = 0 And _
    Application.WorksheetFunction.CountIf(Sheets("Sheet3").Columns(1), SearchString) = 0 Then
        '~~> Display relevant message
    Else
        '~~> Display relevant message
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:20:49.673

您也可以只使用这样的 excel 公式来执行此操作：

```
=IF(AND(len('Sheet1'!A1)>0 , ISERROR(MATCH('Sheet1'!A1,'Sheet2'!A:A,0)), ISERROR(MATCH('Sheet1'!A1,'Sheet3'!A:A,0))) , "True", "False") 
```

内容如下：

*   如果满足以下三个条件，则为 True，否则为 False
*   条件一：Sheet1的单元格A1存在
    *   检查其中任何值的长度是否大于0
*   条件 2：Sheet1 的单元格 A1 不在 Sheet 2 的 A 列
    *   运行一个匹配公式来检查这个
    *   如果匹配返回错误，则未找到
*   条件 3
    *   运行一个匹配公式来检查这个
    *   如果匹配返回错误，则未找到

# .net - EF codefirst 使用 MySqlConnector

> ID：11509361
> 
> 赞同：1
> 
> 时间：2012-07-16T17:24:25.117
> 
> 标签：.net, mysql, connector

将 mysql 中的 dotnetconnector 用于 ado.net 时。一旦我尝试做超过 2 个包含，我就会遇到以下问题。

错误消息：对象必须实现 IConvertible。

我在互联网上查看，显然它与 mysql 驱动程序有关。问题是他们不承认这是一个错误。

有人可以帮助我解决重写下面给出的代码以使其正常工作吗？

```
toSave = worker.Persons.Data.OfType<Employee>()
                .Where(x => x.Id == toCopyFrom.Id)
                .Include(x => x.PhoneNumbers)
                .Include(x => x.Contracts)
                .Include(x => x.Addresses)
                .Include(x => x.WorkAreas)
                .SingleOrDefault(); 
```

延迟加载被禁用，因为 json 序列化程序无法使用它。

# google-app-engine - 从数据存储区查询大量 ndb 实体的最佳实践

> ID：11509368
> 
> 赞同：62
> 
> 时间：2012-07-16T17:24:55.303
> 
> 标签：google-app-engine, app-engine-ndb, google-cloud-datastore

我在 App Engine 数据存储区遇到了一个有趣的限制。我正在创建一个处理程序来帮助我们分析我们的一个生产服务器上的一些使用数据。要执行分析，我需要查询和汇总从数据存储中提取的 10,000 多个实体。计算并不难，它只是通过使用样本的特定过滤器的项目的直方图。我遇到的问题是，在达到查询截止日期之前，我无法足够快地从数据存储中取回数据以进行任何处理。

我已经尝试了所有我能想到的将查询分块为并行 RPC 调用以提高性能，但根据 appstats，我似乎无法让查询实际并行执行。无论我尝试哪种方法（见下文），RPC 似乎总是会退回到顺序下一个查询的瀑布。

注意：查询和分析代码确实有效，只是运行缓慢，因为我无法从数据存储区快速获取数据。

# 背景

我没有可以分享的实时版本，但这里是我正在谈论的系统部分的基本模型：

```
class Session(ndb.Model):
   """ A tracked user session. (customer account (company), version, OS, etc) """
   data = ndb.JsonProperty(required = False, indexed = False)

class Sample(ndb.Model):
   name      = ndb.StringProperty  (required = True,  indexed = True)
   session   = ndb.KeyProperty     (required = True,  kind = Session)
   timestamp = ndb.DateTimeProperty(required = True,  indexed = True)
   tags      = ndb.StringProperty  (repeated = True,  indexed = True) 
```

您可以将样本视为用户使用给定名称的功能的时间。（例如：'systemA.feature_x'）。标签基于客户详细信息、系统信息和功能。例如：['winxp'、'2.5.1'、'systemA'、'feature_x'、'premium_account']）。因此，这些标签形成了一组非规范化的标记，可用于查找感兴趣的样本。

我正在尝试进行的分析包括获取日期范围并询问每个客户帐户（公司，而不是每个用户）每天（或每小时）使用的一组功能（可能是所有功能）的次数。

所以处理程序的输入类似于：

*   开始日期
*   结束日期
*   标签

输出将是：

```
[{
   'company_account': <string>,
   'counts': [
      {'timeperiod': <iso8601 date>, 'count': <int>}, ...
   ]
 }, ...
] 
```

# 查询通用代码

这是所有查询的一些共同代码。处理程序的一般结构是一个使用 webapp2 的简单 get 处理程序，它设置查询参数、运行查询、处理结果、创建要返回的数据。

```
# -- Build Query Object --- #
query_opts = {}
query_opts['batch_size'] = 500   # Bring in large groups of entities

q = Sample.query()
q = q.order(Sample.timestamp)

# Tags
tag_args = [(Sample.tags == t) for t in tags]
q = q.filter(ndb.query.AND(*tag_args))

def handle_sample(sample):
   session_obj = sample.session.get()    # Usually found in local or memcache thanks to ndb
   count_key   = session_obj.data['customer']
   addCountForPeriod(count_key, sample.timestamp) 
```

# 尝试的方法

我尝试了多种方法来尝试尽快并行地从数据存储中提取数据。到目前为止我尝试过的方法包括：

## A. 单次迭代

这更像是与其他方法进行比较的简单基本情况。我只是构建查询并遍历所有项目，让 ndb 做它做的事情来一个接一个地拉它们。

```
q = q.filter(Sample.timestamp >= start_time)
q = q.filter(Sample.timestamp <= end_time)
q_iter = q.iter(**query_opts)

for sample in q_iter:
   handle_sample(sample) 
```

## B. 大取数

这里的想法是看看我是否可以进行一次非常大的提取。

```
q = q.filter(Sample.timestamp >= start_time)
q = q.filter(Sample.timestamp <= end_time)
samples = q.fetch(20000, **query_opts)

for sample in samples:
   handle_sample(sample) 
```

## C. 跨时间范围的异步获取

这里的想法是认识到样本在时间上的间隔相当好，因此我可以创建一组独立的查询，将整个时间区域分成块，并尝试使用异步并行运行每个查询：

```
# split up timestamp space into 20 equal parts and async query each of them
ts_delta       = (end_time - start_time) / 20
cur_start_time = start_time
q_futures = []

for x in range(ts_intervals):
   cur_end_time = (cur_start_time + ts_delta)
   if x == (ts_intervals-1):    # Last one has to cover full range
      cur_end_time = end_time

   f = q.filter(Sample.timestamp >= cur_start_time,
                Sample.timestamp < cur_end_time).fetch_async(limit=None, **query_opts)
   q_futures.append(f)
   cur_start_time = cur_end_time

# Now loop through and collect results
for f in q_futures:
   samples = f.get_result()
   for sample in samples:
      handle_sample(sample) 
```

## D. 异步映射

我尝试了这种方法，因为文档听起来像是 ndb 在使用 Query.map_async 方法时可能会自动利用一些并行性。

```
q = q.filter(Sample.timestamp >= start_time)
q = q.filter(Sample.timestamp <= end_time)

@ndb.tasklet
def process_sample(sample):
   period_ts   = getPeriodTimestamp(sample.timestamp)
   session_obj = yield sample.session.get_async()    # Lookup the session object from cache
   count_key   = session_obj.data['customer']
   addCountForPeriod(count_key, sample.timestamp)
   raise ndb.Return(None)

q_future = q.map_async(process_sample, **query_opts)
res = q_future.get_result() 
```

# 结果

我测试了一个示例查询来收集总体响应时间和 appstats 跟踪。结果是：

## A. 单次迭代

真实：15.645s

这个顺序通过一个接一个地获取批次，然后从 memcache 中检索每个会话。

![方法 A appstats](../Images/a0621af387b3559d23381aa83ea820ef.png)

## B. 大取数

真实：12.12s

实际上与选项 A 相同，但由于某种原因要快一些。

![方法 B 应用统计](../Images/aab01430c295a91886141ff4875e0376.png)

## C. 跨时间范围的异步获取

真实：15.251s

似乎在开始时提供了更多的并行性，但似乎在结果迭代期间因一系列对 next 的调用而减慢了速度。似乎也无法将会话 memcache 查找与挂起的查询重叠。

![方法 C 应用程序统计](../Images/9feecf800c72a7de5f3394e96ad57adb.png)

## D. 异步映射

真实：13.752s

这个是我最难理解的。看起来它有很多重叠，但一切似乎都在瀑布中延伸而不是平行。

![方法 D appstats](../Images/064a6987df37ea6dda21a03ab16b3ef8.png)

# 建议

基于这一切，我错过了什么？我只是达到了 App Engine 的限制，还是有更好的方法来并行拉下大量实体？

我不知道接下来要尝试什么。我考虑过重写客户端以并行向应用程序引擎发出多个请求，但这似乎很暴力。我真的希望应用引擎应该能够处理这个用例，所以我猜我缺少一些东西。

# 更新

最后我发现选项 C 最适合我的情况。我能够优化它以在 6.1 秒内完成。仍然不完美，但要好得多。

在听取了几个人的建议后，我发现以下几点是理解和牢记的关键：

*   多个查询可以并行运行
*   一次只能有 10 个 RPC 飞行
*   尝试去规范化到没有辅助查询的程度
*   这种类型的任务最好留给映射reduce和任务队列，而不是实时查询

所以我做了什么让它更快：

*   我从一开始就根据时间对查询空间进行了分区。（注意：分区在返回的实体方面越相等越好）
*   我进一步对数据进行非规范化以消除对辅助会话查询的需要
*   我利用 ndb 异步操作和 wait_any() 将查询与处理重叠

我仍然没有得到我期望或喜欢的性能，但它现在是可行的。我只是希望它们是一种更好的方法，可以在处理程序中快速将大量顺序实体拉入内存。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T07:50:46.403

像这样的大型处理不应该在有 60 秒时间限制的用户请求中完成。相反，它应该在支持长时间运行请求的上下文中完成。[任务队列](https://developers.google.com/appengine/docs/python/taskqueue/overview-push)最多支持 10 分钟的请求，并且（我相信）正常的内存限制（F1 实例，默认情况下，有[128MB 的内存](https://developers.google.com/appengine/docs/adminconsole/performancesettings)）。对于更高的限制（无请求超时，1GB+ 内存），请使用[backends](https://developers.google.com/appengine/docs/python/backends/overview)。

这里有一些可以尝试的方法：设置一个 URL，当访问该 URL 时，它会触发一个任务队列任务。如果任务队列任务尚未完成，它会返回一个网页，该网页每隔约 5 秒轮询另一个以 true/false 响应的 URL。任务队列处理数据，这可能需要大约 10 秒，并将结果作为计算数据或呈现的网页保存到数据存储区。一旦初始页面检测到它已经完成，用户就会被重定向到该页面，该页面从数据存储中获取现在计算的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-22T05:12:00.100

新的实验性[数据处理](https://developers.google.com/appengine/docs/python/dataprocessing/)功能（MapReduce 的 AppEngine API）看起来非常适合解决这个问题。它执行自动分片以执行多个并行工作进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-07T12:35:12.690

我有一个类似的问题，在与谷歌支持合作几周后，我可以确认至少在 2017 年 12 月没有神奇的解决方案。

**tl;dr：**对于运行在 B1 实例上的标准 SDK，可以预期吞吐量为**220个实体/秒，而对于在 B8 实例上运行的已修补 SDK，吞吐量可以达到****900**个实体/秒。

限制与 CPU 相关，更改实例类型直接影响性能。在 B4 和 B4_1G 实例上获得的类似结果证实了这一点

对于具有大约 30 个字段的 Expando 实体，我获得的最佳吞吐量是：

# 标准 GAE SDK

*   B1 实例：~220 个实体/秒
*   B2 实例：~250 个实体/秒
*   B4 实例：~560 个实体/秒
*   B4_1G 实例：~560 个实体/秒
*   B8 实例：~650 个实体/秒

# 已修补的 GAE SDK

*   B1 实例：~420 个实体/秒
*   B8 实例：~900 个实体/秒

对于标准 GAE SDK，我尝试了各种方法，包括多线程，但最好的方法是[`fetch_async`](https://cloud.google.com/appengine/docs/standard/python/ndb/async#using)使用[`wait_any`](https://cloud.google.com/appengine/docs/standard/python/ndb/async#Future_wait_any). 当前的 NDB 库已经在后台使用异步和期货方面做得很好，所以任何使用线程来推动它的尝试只会让情况变得更糟。

我发现了两种有趣的方法来优化它：

*   Matt Faus -[使用 Protobuf 投影加速 GAE 数据存储读取](http://mattfaus.com/2014/12/)
*   Evan Jones -[跟踪 App Engine 上的 Python 性能错误](http://www.evanjones.ca/app-engine-db-serialization.html)

Matt Faus 很好地解释了这个问题：

> GAE SDK 提供了一个 API，用于读取和写入从您的类派生的对象到数据存储区。这为您省去了验证从数据存储返回的原始数据并将其重新打包成易于使用的对象的枯燥工作。特别是，GAE 使用协议缓冲区将原始数据从存储传输到需要它的前端机器。然后 SDK 负责解码此格式并将干净的对象返回给您的代码。这个实用程序很棒，但有时它做的工作比你想要的要多。[...] 使用我们的分析工具，我发现在 protobuf-to-python-object 解码阶段花费了整整 50% 的时间来获取这些实体。这意味着前端服务器上的 CPU 是这些数据存储读取的瓶颈！

![GAE 数据访问网络请求](../Images/1c3d3e72a26eea395426e7ca61957331.png)

这两种方法都试图通过减少解码字段的数量来减少对 Python 解码执行 protobuf 所花费的时间。

我尝试了这两种方法，但我只用马特的方法成功了。自 Evan 发布他的解决方案以来，SDK 内部结构发生了变化。我不得不稍微修改一下 Matt[在这里](https://gist.github.com/MattFaus/bd8c0a1a4fb3d7cc3fe3)发布的代码，但这很容易——如果有兴趣，我可以发布最终代码。

对于具有大约 30 个字段的常规 Expando 实体，我使用 Matt 的解决方案仅解码几个字段并获得了显着改进。

总之，需要相应地进行计划，并且不要期望能够在“实时”GAE 请求中处理超过数百个实体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T17:43:52.227

App Engine 上的大数据操作最好使用某种 mapreduce 操作来实现。

这是描述该过程的视频，但包括 BigQuery [https://developers.google.com/events/io/sessions/gooio2012/307/](https://developers.google.com/events/io/sessions/gooio2012/307/)

听起来您不需要 BigQuery，但您可能希望同时使用管道的 Map 和 Reduce 部分。

您正在做的事情与 mapreduce 情况之间的主要区别在于，您正在启动一个实例并遍历查询，而在 mapreduce 上，您将为每个查询并行运行一个单独的实例。您将需要一个 reduce 操作来“总结”所有数据，并将结果写入某处。

您遇到的另一个问题是您应该使用游标进行迭代。 [https://developers.google.com/appengine/docs/java/datastore/queries#Query_Cursors](https://developers.google.com/appengine/docs/java/datastore/queries#Query_Cursors)

如果迭代器使用查询偏移量，它会效率低下，因为偏移量发出相同的查询，跳过一些结果，并给你下一组，而光标直接跳转到下一组。

# iphone - UIBarButtonItem 外观我需要一个例外

> ID：11509371
> 
> 赞同：5
> 
> 时间：2012-07-16T17:25:14.973
> 
> 标签：iphone, objective-c, uikit, uinavigationbar, uiappearance

在我`application:didFinishLauchginWithOptions:`的设置中，我为我的控件设置了默认外观。

```
UIImage *transparentImage = [UIImage imageNamed:@"transparent.png"];

[[UIBarButtonItem appearance]setBackgroundImage:transparentImage 
                                       forState:UIControlStateNormal 
                                     barMetrics:UIBarMetricsDefault]; 
```

这对我很有用，因为它为普通 UIBarButtonItems 提供了透明的平面外观。但是，当您按下“快速查看”时，会出现一个按钮 I，但`UIDocumentInteractionController`外观不正确。

![在此处输入图像描述](../Images/5961f2a006be5ce16dbc22d7b25fbc65.png)

我相信这是我拥有的唯一一个只是图像的 barbuttonitem。有没有办法我可以修改这个按钮来给它一些对比，让它看起来不那么难看？即使是原始背景在我的导航栏背景下看起来也不错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:49:25.760

我最终实施

> documentInteractionControllerWillBeginPreview, documentInteractionControllerDidEndPreview

在 willBegin 中我保留了右键并将 navigationItem 的右键设置为 nil。我这样做是因为在 didEnd 中已经显示了视图，因此重置外观在添加回来之前不会生效。

```
- (void)documentInteractionControllerWillBeginPreview:(UIDocumentInteractionController *)controller
{
    [[UIBarButtonItem appearance] setBackgroundImage:nil forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
    [[UIBarButtonItem appearance] setBackgroundImage:nil forState:UIControlStateHighlighted barMetrics:UIBarMetricsDefault];
    [[UIBarButtonItem appearance] setBackgroundImage:nil forState:UIControlStateSelected barMetrics:UIBarMetricsDefault];

    self.rightButton = self.navigationItem.rightBarButtonItem;
    self.navigationItem.rightBarButtonItem = nil;
}

- (void)documentInteractionControllerDidEndPreview:(UIDocumentInteractionController *)controller
{
    UIImage *transparentImage = [UIImage imageNamed:@"transparent.png"];
    [[UIBarButtonItem appearance] setBackgroundImage:transparentImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
    [[UIBarButtonItem appearance] setBackgroundImage:transparentImage forState:UIControlStateHighlighted barMetrics:UIBarMetricsDefault];
    [[UIBarButtonItem appearance] setBackgroundImage:transparentImage forState:UIControlStateSelected barMetrics:UIBarMetricsDefault];

    self.navigationItem.rightBarButtonItem = self.rightButton;
} 
```

它并不完美，但比以前好得多。如果有人能弄清楚如何处理呈现控制器的`rightBarButtonItem`问题，我会接受你的回答。

# java - JRuby - 方法“eval”的第二次调用给出（Errno::EBADF）错误的文件描述符

> ID：11509373
> 
> 赞同：0
> 
> 时间：2012-07-16T17:25:20.547
> 
> 标签：java, ruby-on-rails, ruby, file, jruby

我有一个 JRuby 引擎，它从 Ruby 类调用方法“run_code”。“run_code”方法调用 IRB 命令并捕获其输出。

方法“run_code”的第一次调用每次都可以正常工作**。**

第二**个电话**给了我这些错误：

```
(Errno::EBADF) Bad file descriptor 
Caused by: org.jruby.embed.InvokeFailedException: (Errno::EBADF) Bad file descriptor                                                  
     at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.call(EmbedRubyObjectAdapterImpl.java:406)   
     at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.callMethod(EmbedRubyObjectAdapterImpl.java:3
    33)                                                                                                 
     at org.jruby.embed.ScriptingContainer.callMethod(ScriptingContainer.java:1334)                     
     at org.apache.hadoop.hbase.master.ShellEndPoint.commandResponse(ShellEndPoint.java:87)             
     at org.apache.hadoop.hbase.master.ShellEndPoint.doGet(ShellEndPoint.java:114)                      
     at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)                                    
     at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)                                    
     at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)                          
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)         
     at org.apache.hadoop.http.HttpServer$QuotingInputFilter.doFilter(HttpServer.java:835)              
     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)         
     at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)                        
     at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)                     
     at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)                        
     at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)                        
     at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)                           
     at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)    
     at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)                        
     at org.mortbay.jetty.Server.handle(Server.java:326)                                                
     at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)                         
     at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)         
     at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)                                     
     at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)                                
     at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)                                
     at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)                    
     at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)                   
    Caused by: org.jruby.exceptions.RaiseException: (Errno::EBADF) Bad file descriptor                  
    Caused by:org.jruby.exceptions.RaiseException: (Errno::EBADF) Bad file descriptor     
     at org.jruby.RubyIO.initialize(org/jruby/RubyIO.java:981)                                          
     at org.jruby.RubyIO.new(org/jruby/RubyIO.java:868)                                                 
     at Engine.run_code(&lt;script&gt;:28) 
```

第三**个电话**给了我这些错误：

```
(NoMethodError) undefined method `to_i' for #&lt;StringIO:0x128ef465   

Problem accessing /shell. Reason:                                                                
(NoMethodError) undefined method `to_i' for #&lt;StringIO:0x128ef465&gt;
Caused by: org.jruby.embed.InvokeFailedException: (NoMethodError) undefined method `to_i' for StringIO:0x128ef465;                                                                          
 at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.call(EmbedRubyObjectAdapterImpl.java:406)   
 at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.callMethod(EmbedRubyObjectAdapterImpl.java:3
33)                                                                                                 
 at org.jruby.embed.ScriptingContainer.callMethod(ScriptingContainer.java:1334)                     
 at org.apache.hadoop.hbase.master.ShellEndPoint.commandResponse(ShellEndPoint.java:87)             
 at org.apache.hadoop.hbase.master.ShellEndPoint.doGet(ShellEndPoint.java:114)                      
 at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)                                    
 at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)                                    
 at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)                          
 at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)         
 at org.apache.hadoop.http.HttpServer$QuotingInputFilter.doFilter(HttpServer.java:835)              
 at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)         
 at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)                        
 at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)                     
 at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)                        
 at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)                        
 at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)                           
 at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)    
 at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)                        
 at org.mortbay.jetty.Server.handle(Server.java:326)                                                
 at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)                         
 at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)         
 at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)                                     
 at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)                                
 at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)                                
 at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)                    
 at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)                   
Caused by: org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `to_i' for #&lt;Str
ingIO:0x128ef465&gt;                                                                                                                                                                              
Caused by:org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `to_i'
 for #&lt;StringIO:0x128ef465&gt;                                                                   
 at Engine.run_code(&lt;script&gt;:12) 
```

我的**Java 代码**如下所示：

```
ScriptEngineManager manager = new ScriptEngineManager();
ScriptEngine engine = manager.getEngineByName("jruby");
ScriptingContainer container = new ScriptingContainer();

Reader reader = new FileReader(myEngine);

try {
  receiver = engine.eval(reader);
  ob = container.callMethod(receiver,"run_code",command);
  response = ob.toString();
} catch(ScriptException e) {
      LOG.debug(e.getMessage());
      response ="ERROR";
} 
```

我的**红宝石代码**如下所示：

```
require 'stringio'
require 'irb'
require 'hirb'

class Engine
  extend Shell
  def initialize()
    @binding = Kernel.binding
  end
  def run_code(code)
    # run something
    stdout_id = $stdout.to_i
    $stdout = StringIO.new
    cmd = <<-EOF
    $stdout = StringIO.new
    begin
      #{code}
    end
    EOF
    begin
      result = Thread.new { Kernel.eval(cmd, @binding) }.value
    rescue SecurityError
      return "illegal"
    rescue Exception => e
      return e
    ensure
      output = get_stdout
      $stdout = IO.new(stdout_id)
    end

    return output
  end

   private
   def get_stdout
     raise TypeError, "$stdout is a #{$stdout.class}" unless $stdout.is_a? StringIO
     $stdout.rewind
     $stdout.read
   end

end

module Kernel
  @shell = Shell::Shell.new(@hbase, @formatter)

  # Add commands to this namespace
  @shell.export_commands(self)
  @formatter = Shell::Formatter::Console.new

  # Setup the HBase module.  Create a configuration.
  @hbase = Hbase::Hbase.new

  # Setup console
  @shell = Shell::Shell.new(@hbase, @formatter)

  # Add commands to this namespace
  @shell.export_commands(self)

  # Add help command
  def help(command = nil)
    @shell.help(command)
  end

# Backwards compatibility method
  def tools
    @shell.help_group('tools')
  end
end 
```

你知道可能是什么问题吗？

我没有创建新的 $stdout 对象，而是保留了对旧对象的引用。现在它给了我

```
 javax.script.ScriptException: org.jruby.exceptions.RaiseException: (Errno::
EBADF) Bad file descriptor 
```

错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T03:31:28.347

我最初建议做这样的事情，因为它过去为我修复了同样的错误：

```
ScriptingContainer container = new ScriptingContainer();
try {
    Reader reader = new FileReader(myEngine);
    // rest of your code here...
} finally {
    container.terminate();
} 
```

# javascript - 这个函数调用有什么区别？

> ID：11509375
> 
> 赞同：3
> 
> 时间：2012-07-16T17:25:38.410
> 
> 标签：javascript

```
setInterval("RunSlide()", 5000); 
```

首先，调用带括号和引号的函数。

```
setInterval("RunSlide", 5000); 
```

其次，调用不带括号但仍使用引号的函数。

```
setInterval(Runslide, 5000); 
```

第三，调用不带括号和引号的函数。

```
RunSlide(); 
```

第四，用括号调用函数。

```
RunSlide; 
```

第五，调用不带括号的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:37:03.930

即使结果可能相同，使用不同的参数类型也会有所不同。

* * *

*   `setInterval ("argument as string", delay)`

    这将导致与将字符串传递给相同的行为，`eval`因此**不**建议这样做（出于相同的确切原因，可以[在网络上找到有关](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/eval#Don%27t_use_eval!)该主题的更多信息）。

^(**示例片段：**)

```
 setInterval ("console.log ('hello world');", 100); 
```

* * *

*   `setInterval (func_reference, delay, param1, param2, ...)`

    这将导致 所指向的函数`func`被调用，这是推荐的选项。如果您以这种方式调用函数，您还可以将参数传递给要执行的函数。

^(**示例片段：**)

```
function say_it (word1, word2) {
  console.log (word1 + " " + word2);
}

setInterval (say_it, 100, "hello", "world"); 
```

```
setInterval (function (word1, word2) {
   console.log (word1 + " " + word2);
}, 100, "hello", "world); 
```

* * *

### 笔记）

`setInterval`使用第一个参数作为**仅**包含函数名称的字符串进行调用是完全没有意义的，该函数将不会被执行。这与在代码中的某处编写以下内容相同。

```
alert; 
```

`RunSlide();`和之间的区别在`RunSlide;`上面的例子之后应该很明显，一个会调用名称*RunSlide*引用的函数，另一个不会（根本不做任何事情）。

# css - 仅在 IE6 中换行

> ID：11509377
> 
> 赞同：0
> 
> 时间：2012-07-16T17:25:45.087
> 
> 标签：css, html, css-float, internet-explorer-6

你可以在这里看到这个问题：http: [//jsfiddle.net/6WuVz/7/](http://jsfiddle.net/6WuVz/7/)

这适用于所有其他浏览器（图像顶部），但在 ie6（图像底部）中查看时，它会错误地换行：

![在此处输入图像描述](../Images/c204a7b8eb1ecd5fa92dc1dad2567487.png)

注意：您可以通过使用兼容性视图并选择 IE5 Quirks 在更高版本的 IE 中看到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:15:31.947

据我所知，包含标题的 div 没有固定宽度。因此，IE 告诉它扩展，当它扩展时，它会向下移动，那里有空间。尝试仅为 IE6 设置宽度，看看是否可以解决问题。

此外，[IE6 在`overflow: hidden`](https://stackoverflow.com/questions/2403011/ie6-ie7-css-problem-with-overflow-hidden-position-relative-combo). 虽然它通常与 结合使用`position: relative`，但您可能会遇到类似的情况。如果以前的解决方案不起作用，你可以试试这个。

**编辑**- 由于您不想设置明确的宽度，我想到了一些其他选项留给您：

1.  `clear: none`在非浮动元素上显式设置
2.  使用`span`元素而不是有`div`问题的文本（`span`是内联的，`div`而是块的，所以它不应该扩展到父宽度；考虑到你在做什么，无论如何使用它可能更有意义`span`）。
3.  使用 JavaScript 确定`div`IE6 的浮动宽度，并相应地设置非浮动的大小`div`（同样，您可以在 HTML 中使用条件注释来专门针对 IE6）
4.  认真考虑是否值得支持 IE6（即 - 如果这是在一个受众相当精通技术的网站上，您可能完全可以放弃对 IE6 的支持，或者至少，解决这个问题将花费您的项目而不是回报你明白了；但如果你正在与医疗保健提供者打交道，你可能仍然必须与 IE6 打交道）。

IE6 有一个非标准的盒子模型，它告诉块级元素扩展其容器的整个宽度，而不是“收缩包装”到它们的内容。它们的内容大于它们允许的宽度，并且该`float`属性将浮动元素从文档流中取出（这就是为什么您的`overflow: hidden`，当变成 时`overflow: visible`，会超出浮动内容的顶部）。较新的浏览器基本上具有属性的“更新定义”（可以这么说）`float`，它告诉兄弟内容围绕浮动元素流动，除了将其从正常的文档流中取出。[CSS-tricks 有一篇关于 float 的好文章](http://css-tricks.com/all-about-floats/)，[A List Apart](http://www.alistapart.com/articles/css-floats-101/)也是如此，如果您需要更多信息。

# jquery - jQuery：使用 $.load 获取内容，结果格式如下： \n \n Apply<\/a> \n <\/div>\n \n

> ID：11509380
> 
> 赞同：0
> 
> 时间：2012-07-16T17:25:48.720
> 
> 标签：jquery, ajax

```
 nextPageURL = nextPage.find('a').attr('href') + '#searchResults';
    searchResults.append('<div class="moreList" />');
    $('.moreList').load(nextPageURL);
    var newHTML = $('.moreList').html().replace(/\s+<\/TD>/g,'');
    $('.moreList').html(newHTML); 
```

这是它的要点。更多输出如下所示：

```
\n Android application design<\/a> <\/h3>\n

\n

Hourly<\/dt>\n
- Est. Time: Less than 1 week, 10 hrs\/week <\/dd>\n
- Posted <\/span> <\/dd>\n
- 3 Interviews<\/dd>\n <\/dl>\n <\/div> \n
\n \n Apply<\/a> \n <\/div>\n \n
<\/div>\n 
```

* * *

帮助，会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:51:41.213

只是一个猜测，但如果你使用这种语法：

```
$('#result').load('ajax/test.html #container'); 
```

你肯定在`#`.

# android - Android 浏览器不考虑溢出：以最大宽度隐藏

> ID：11509383
> 
> 赞同：0
> 
> 时间：2012-07-16T17:25:59.780
> 
> 标签：android, html, css, layout, android-browser

我试图让我的博客在安卓浏览器上可读，但它总是需要水平滚动。现在，我的解决方案是在 chrome 中工作，因此当我将窗口大小调整为小于文章内容的宽度时，文章将随之缩小，而没有水平滚动条。[您可以在此处](http://connermcd.com/blog/2012/07/15/managing-music-with-mpd-and-mpc/)查看博客文章的示例。

如果我这样做：

```
<head>
   <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0; minimum-scale=1.0; user-scalable=yes;" />
   <meta name="apple-mobile-web-app-capable" content="yes" />

   <style type="text/css">
      body {
        overflow: hidden;
        margin: 0;
      }

      #container {
        max-width: 650px;
        margin: auto;
      }
   </style>
</head>
<body>
   <div id="container">Content goes here.</div>
</body> 
```

然后它就像[这里](http://connermcd.com/test.html)看到的那样工作，但是我页面中的其他东西把事情搞砸了。在 chrome 中，我得到了我想要的效果，但是当我在 android 浏览器上打开页面时，我必须水平滚动。

**编辑：**我将其追溯到 facebook iframe。无论如何要解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:02:01.613

我偶尔会遇到同样的问题，android 完全忽略溢出命令。我认为第一个问题是使用隐藏在主体上的溢出，而不是内部元素。

我会改变：

```
<style type="text/css">
   body {
     overflow: hidden;
     margin: 0;
   }

   #container {
     max-width: 650px;
     margin: auto;
   }
</style> 
```

对此：

```
<style type="text/css">
   body {
     margin: 0;
   }

   #container {
     overflow: hidden;
     max-width: 650px;
     margin: auto;
   }
</style> 
```

注意实际的“#container”div 中的内容。虽然它可能会显示在屏幕外，但我永远无法修复对象标签（flash 视频播放器）的错误。溢出是移动设备的痛点。如果可能的话，我会开发液体并从那里开始。在这种情况下不需要设置最大宽度——它将允许用户根据需要浏览网站。

# telerik - 如何使用 Telerik Grid 组件显示内容项列表

> ID：11509392
> 
> 赞同：0
> 
> 时间：2012-07-16T17:26:31.200
> 
> 标签：telerik, orchardcms

我是 Orchard CMS 的初学者。我想创建由我以前知道的不同部分和字段组成的内容类型。我希望这个内容类型是可枚举的，即我使用内容部分列表，我想使用 Telerik 组件列出它。

例如，我的内容类型是产品，我指定了它的字段：价格，SKU 除了默认值：用户（谁创建它）和创建时间字段。此外，该产品还包含图片库，即图片库内容部分。我希望使用 Telerik 组件网格显示产品列表，包括创建时间和用户名。

创建指定所有字段（价格，SKU）及其模板的整个模块是否更好，或者有什么方法可以将果园中已经创建的内容作为内容类型并以不同的方式显示（使用telerik）..

感谢您的任何建议；）托马斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T10:21:08.760

看来这个话题在这里被移动和回答：

[http://orchard.codeplex.com/discussions/371276](http://orchard.codeplex.com/discussions/371276)

# r - 基本数据摘要 - 按日期确定最大值

> ID：11509394
> 
> 赞同：1
> 
> 时间：2012-07-16T17:26:40.500
> 
> 标签：r, summary

这是我第一次使用 R。我正在尝试进行一些基本数据汇总（查找最大值）以进行绘图。我可以在 Excel 中完成此操作，但这需要一段时间，而且由于我一遍又一遍地做同样的事情，因此开发 R 脚本很有意义。我搜索了以前的帖子，发现了类似的问题，但无法找出正确的 R 语法。同样，我是一个绝对的初学者，所以非常感谢任何帮助。

问题描述：我有一个包含两列的数据框：日期/时间（10 分钟时间戳）和压力。我需要确定每天 PRESSURE 的最大值。

```
 DateAndTime   Pressure
1  8/1/2011 0:06 0.06119370

2  8/1/2011 0:16 0.06003765

3  8/1/2011 0:26 0.06118049 
```

我曾尝试从上一篇文章中修改下面的代码（尝试删除“which.max”部分）但没有成功。

```
for (imonth in 1:12) {

    month <- which(data[,2]==imonth) 
    monthly_max[imonth] <- max(data[month,3]) 
    maxi[imonth] <- which.max(data[month,3]) 
} 
tabela <- cbind(monthly_max, maxi) 
write.table(tabela, col.names=TRUE, row.names=TRUE, append=FALSE, sep="\t") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:00:35.987

```
#creating some data for demonstration purpose
time1 <- seq(from=as.POSIXct("2011-01-08 00:06:00"),to=as.POSIXct("2011-01-18 00:06:00"),by="10 min")
DateAndTime <- format(time1,"%d/%m/%Y %H:%M")
Pressure <- rnorm(length(DateAndTime),0.06,0.01)
DF <- data.frame(DateAndTime,Pressure)

#look at first lines
head(DF)

#convert character in datetime format
DF$DateAndTime2 <- strptime(DF$DateAndTime,"%d/%m/%Y %H:%M",tz="GMT")
DF$Days <- trunc(DF$DateAndTime2,"days")

#create the summary
require(plyr)
summaryDF <- ddply(DF,.(Days),summarise,max(Pressure))
names(summaryDF)<-c("Day","Maximum")

#write to CSV file, which can be read into Excel
write.table(summaryDF,file="output.csv",col.names=TRUE,row.names=FALSE,dec=".",sep=",") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:46:12.247

我建议使用时间序列类，例如 xts 或 zoo。

```
# create some data that looks like the OP's
NOW <- .POSIXct(1342460400)
d <- data.frame(DateAndTime=format(NOW+seq(0,3600*72,600), "%Y-%m-%d %H:%M"))
d$Pressure <- runif(NROW(d))/10

library(xts)  # load the xts package
# create an xts object from the OP's data.frame
x <- xts(d["Pressure"], as.POSIXct(d$DateAndTime))
# apply the max function to each day
dx <- apply.daily(x, max)
#                       Pressure
# 2012-07-16 23:50:00 0.09872622
# 2012-07-17 23:50:00 0.09947256
# 2012-07-18 23:50:00 0.09932375
# 2012-07-19 12:40:00 0.09971159 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:40:39.110

This?

```
dat <- data.frame(date = rep(seq(1,50,2),2), value = rnorm(50))
head(dat)   
require(plyr)
ddply(dat, .(date), summarise, max(value)) 
```

# php - 查找数组重复项，添加到原始然后删除

> ID：11509395
> 
> 赞同：0
> 
> 时间：2012-07-16T17:26:41.643
> 
> 标签：php, arrays, function

当在 URL 中找到重复项时，我想：

1.  取“分数”并将其添加到原件中
2.  获取“引擎”字符串并将其附加到原始字符串
3.  然后删除整个重复条目

> ```
> array
>   0 => 
>     array
>       'url' => string 'http://blahhotel.com/'
>       'score' => int 1
>       'engine' => string 'cheese'
>   1 => 
>     array
>       'url' => string 'http://www.blahdvd.com/'
>       'score' => int 2
>       'engine' => string 'cheese'
>   2 => 
>     array
>       'url' => string 'http://blahhotel.com/'
>       'score' => int 1
>       'engine' => string 'pie'
>   3 => 
>     array
>       'url' => string 'http://dictionary.reference.com/browse/blah'
>       'score' => int 2
>       'engine' => string 'pie'
>   4 => 
>     array
>       'url' => string 'http://dictionary.reference.com/browse/blah'
>       'score' => int 1
>       'engine' => string 'apples' 
> ```

最后应该是这样的：

> ```
> array
>   0 => 
>     array
>       'url' => string 'http://blahhotel.com/'
>       'score' => int 2
>       'engine' => string 'cheese, pie'
>   1 => 
>     array
>       'url' => string 'http://www.blahdvd.com/'
>       'score' => int 2
>       'engine' => string 'cheese'
>   3 => 
>     array
>       'url' => string 'http://dictionary.reference.com/browse/blah'
>       'score' => int 3
>       'engine' => string 'pie, apples' 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:30:41.387

我相信这符合您的要求。

根据您提供的所需输出，您似乎希望保留每个条目的数字索引。如果您实际上不需要保留这些数字，则可以删除第二个`foreach`循环和有关`$indices`变量的行，然后只需 return `$tmpList`。

```
function reduceEntries($entries)
{
    $tmpList = array();
    $indices = array();

    foreach ($entries as $i => $entry) {
        if (isset($tmpList[$entry['url']])) {
            $tmpList[$entry['url']]['score'] += $entry['score'];
            $tmpList[$entry['url']]['engine'] .= ', ' . $entry['engine'];
        } else {
            $tmpList[$entry['url']] = $entry;
            $indices[$entry['url']] = $i;
        }
    }

    // rebuild final array with indices
    $finalList = array();
    foreach ($tmpList as $url => $entry) {
        $finalList[$indices[$url]] = $entry;
    }

    return $finalList;
} 
```

*（这是键盘上的[一个工作示例。）](http://codepad.org/mDpAwWeZ)*

# c++ - 使用 GL_LINE_LOOP 绘制许多圆圈

> ID：11509399
> 
> 赞同：0
> 
> 时间：2012-07-16T17:27:09.470
> 
> 标签：c++, opengl

我在使用这些代码在屏幕上渲染许多圆圈时遇到问题。

```
float degree = 0;
unsigned int ctr = 0;
for(int xi = -3200; xi < 3200; xi+= 2*r)
{
    for(int yi = 4800; yi > -4800; yi-= 2*r)
    {
        for(int i = 0; i < 360; ++i)
        {
            vertices.push_back(xi + r * cos(float(degree)));
            vertices.push_back(yi + r * sin(float(degree)));
            vertices.push_back(-8);

            indices.push_back(i+ctr);               
            ++degree;
        }
        ctr += 360;
        degree = 0;
    }
}

unsigned int i = 0;
for(i = 0; i < indices.size()/360; ++i) 
{
    glEnableClientState(GL_VERTEX_ARRAY);
    glVertexPointer(3, GL_FLOAT, 0, &vertices[i*360]);
    glLineWidth(1);
    glDrawElements(GL_LINE_LOOP, 360, GL_UNSIGNED_INT, &indices[i*360]);
    glDisableClientState(GL_VERTEX_ARRAY);
} 
```

这是结果 ![界](../Images/7792120e9940e0f79b766e8e3c83c9de.png)

另外，当我将 xi 值更改为 [-6400, 6400] 时程序崩溃

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:00:38.333

撇开这种技术的可疑性质不谈，您看起来访问索引不正确。

```
glVertexPointer(3, GL_FLOAT, 0, &vertices[i*360]);
glDrawElements(GL_LINE_LOOP, 360, GL_UNSIGNED_INT, &indices[i*360]); 
```

glDrawElements 的索引指定从 glVertexPointer 顶点的偏移量。您已将索引定义为相对于顶点缓冲区的开始：

```
indices.push_back(i+ctr); 
```

但是您正在为您绘制的每个圆圈移动缓冲区偏移量。因此，在您的索引缓冲区中，第二个圆从索引 360 开始。但是当您绘制第二个圆时，您还移动了顶点指针，使得索引 360 是指针的第 0 个元素。

然后，当您尝试访问索引 360 时，您实际上是在访问元素 720（360 + 缓冲区开始 @360）。

# eclipse - 如何获取 Eclipse 视图和 IJavaElement 的屏幕尺寸

> ID：11509401
> 
> 赞同：0
> 
> 时间：2012-07-16T17:27:25.057
> 
> 标签：eclipse, plugins, screen, multi-touch, dimension

我编写了一个 Eclipse 插件，将一些 Java 类可视化为视图部分中的 UML。您在包资源管理器中选择一个包，然后单击该包后，您可以通过单击菜单中的自创命令菜单项来将其可视化。可视化是使用 prefuse 库创建的。我的下一个目标是让它能够用于多点触控。我使用[PQLabs multitouch SDK](http://multi-touch-screen.com/sdk.html)的 Multitouch Library 。现在，在多点触控屏幕上，我可以移动我的 UML 模型、调整它的大小等。

但我无法从包资源管理器中获取信息。我试图在屏幕上找出 Package Explorer 和 IJavaElements 的位置，但失败了。我的想法是将手指的 x 和 y 点（我从 PQL Labs SDK 获得）与 IJavaElements 的 x 和 y 坐标进行比较。我从一开始就失败了，我无法识别触摸点是否在 Package Explorer 视图的边界内。我唯一得到的是整个显示器的界限。我搜索了互联网和 stackoverflow，但没有找到有用的东西。

我不知道这是否可能，但当有人可以给我信息或指导我找到好的链接时，我会很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:36:40.540

我对包资源管理器了解不多，但是使用项目资源管理器（通用导航器）（您也应该解决），有一个与之关联的 TreeViewer（在这种情况下，该类是 CommonViewer）。您可以通过执行 CommonNavigator.getCommonViewer() 来实现。一旦有了 TreeViewer，您就可以访问底层 SWT 树，并从那里使用标准 SWT 方法来获取树相对于封闭窗口的位置。还有一些方法可以让您获得树细胞的边界。查看 SWT Snippets (Google it) 以帮助您使用 Tree。

对于包资源管理器，它将是类似的；您将不得不查看源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:01:04.493

如弗朗西斯的回答中所述，您应该能够获得`TreeViewer`,`TreeViewer#getControl()`并将提供基础控制。

当您通过 获取控件的位置和大小时`control.getBounds()`，这些将相对于外壳/窗口的坐标。如果您需要绝对显示/屏幕坐标，请参阅`control.toDisplay(some_x, some_y)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T15:06:13.617

我想分享我如何解决问题的步骤。根据这些建议，我深入研究了 Java IDE 的 jdt Java 基础架构。要获得 Package Explorer 的 TreeViewer，我必须将“ *PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage().findView("org.eclipse.jdt.ui.PackageExplorer* ")”转换为“PackageExplorerPart”在“ *org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart* ”中。我做的进一步步骤是：

treeViewer = packageExplorerPart.getTreeViewer();

树 = (树) treeViewer.getControl();

之后，我创建了一个坐标为 x 和 y 的“*点*”，它们通过触摸屏幕传递。但是，点的位置代表了整个屏幕，为了获得包资源管理器的正确坐标，我使用 tree.toControl(...) 方法转换了点。最后，我检查了是否使用 tree.getItem(....) 方法给出了一个项目。

# c# - MVC3 模型绑定器无法绑定字典 这是我的 ViewModel 的一部分

> ID：11509405
> 
> 赞同：2
> 
> 时间：2012-07-16T17:27:50.157
> 
> 标签：c#, asp.net-mvc-3, razor, dictionary, model-binding

我不知道我在搞砸什么。`FormCollection`似乎表明一切都是正确的。`RoleName`回来也很好。那为什么又`RoleMembership`回来了`null`？

**型号**：

```
public class EditRoleMembershipViewModel
{
    public string RoleName { get; set; }
    public Dictionary<string, bool> RoleMembership { get; set; }
} 
```

**控制器动作**：

```
[HttpGet]
public ActionResult EditRoleMembership(string roleName)
{
    var viewModel = new EditRoleMembershipViewModel {RoleName = roleName};

    var allUsers = _userServices.GetAllUsers();
    getRolesForUsers(allUsers);
    var role = _roleServices.GetRole(roleName);

    viewModel.RoleMembership = new Dictionary<string, bool>();
    foreach (var user in allUsers)
    {
        var isMember = user.Roles != null && user.Roles.Contains(role);
        viewModel.RoleMembership.Add(user.UserName, isMember);
    }

    return View(viewModel);
} 
```

**查看**：

```
@model CI.Portal.Mvc.ViewModels.EditRoleMembershipViewModel
@{
    ViewBag.Title = "Edit Role";
}
<h2>@ViewBag.Title: @Model.RoleName</h2>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    <table>
        <thead>
            <tr>
                <th>
                </th>
                <th>
                    In Role
                </th>
            </tr>
        </thead>
        <tbody>
            @{
                int index = 0;
                foreach (var item in Model.RoleMembership)
                {
                    <tr>
                        <td>
                            @item.Key
                            @Html.Hidden(string.Format("model.RoleMembership[{0}].Key", index), item.Key)
                        </td>
                        <td>@Html.CheckBox(string.Format("model.RoleMembership[{0}].Value", index), item.Value)</td>
                    </tr>
                    index++;
                }
            }
        </tbody>
    </table>

    <p>
        <input type="submit" value="Save" />
    </p>
}
<div>
    @Html.ActionLink("Back to Details", "RoleDetails", new { Model.RoleName })
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:32:36.257

您能否尝试删除“模型”。复选框助手声明的前缀。

代替

```
<td>
    @item.Key
    @Html.Hidden(string.Format("model.RoleMembership[{0}].Key", index), item.Key)
</td>
<td>
    @Html.CheckBox(string.Format("model.RoleMembership[{0}].Value", index), item.Value)
</td> 
```

做这个：

```
<td>
    @item.Key
    @Html.Hidden(string.Format("RoleMembership[{0}].Key", index), item.Key)
</td>
<td>
    @Html.CheckBox(string.Format("RoleMembership[{0}].Value", index), item.Value)
</td> 
```

# string - 从字符串中获取图片 url

> ID：11509406
> 
> 赞同：-2
> 
> 时间：2012-07-16T17:27:50.643
> 
> 标签：string

我的字符串是： [slide image="http://themes.devatic.com/konzept/wp-content/themes/konzept/includes/uploadify/uploads/bas_006.jpg" slide_desc="

如何从中获取“image=”之后的部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:34:05.390

简而言之，使用 RegEx 获取 2 个字符串之间的数据。在大多数情况下，不同语言之间的相同 Reg 表达式应该可以正常工作。

在 PHP 中，您可能希望使用 preg_match。

```
$string = "[slide image=\"http://themes.devatic.com/konzept/wp-content/themes/konzept/includes/uploadify/uploads/bas_006.jpg\" slide_desc=\""
preg_match("/image=\"(.*)\"/i", $string, $results)
var_dump($results) 
```

更新正则表达式（更严格一点）：

```
/image\="([^"]*)"/i 
```

总而言之，将取决于所使用的语言以及在什么上下文中。您可以使用 RegEx 获得更高级的信息，但这只是快速而肮脏的。

![在此处输入图像描述](../Images/297dbfc6c3c2983dbaf6e38599a4e693.png)

完整的 PHP 代码示例：

```
<?php
$string = '[slide image="http://themes.devatic.com/konzept/wp-content/themes/konzept/includes/uplo‌​adify/uploads/bas_006.jpg" slide_desc="<h4>Promotional Package</h4> Project description sentence" text_color="#464646" slide_horizontal="false"] [slide image="http://themes.devatic.com/konzept/wp-content/themes/konzept/includes/uplo‌​adify/uploads/bas_005.jpg" slide_desc="<h4></h4>" text_color="#464646" slide_horizontal="false"]';
preg_match_all('/image\="([^"]*)"/i', $string, $results);
foreach ($results[1] as $res):
  echo 'Image URL:'.$res."\n";
endforeach;
?> 
```

# mysql - 从单个表的一行中添加多行

> ID：11509407
> 
> 赞同：3
> 
> 时间：2012-07-16T17:27:52.027
> 
> 标签：mysql, sql, view

如何通过mysql在一行中加入多行？

例子 ：

学生桌

```
Sno.| Name  |  Subjects
1\.  | ABC   |  English
2\.  | ABC   |  Mathematics
3\.  | ABC   |  Science
4\.  | FMC |  French
5\.  | ABC   |  Russian
6\.  | JBC   |  French 
```

现在我想要这种格式

```
Sno.| Name |   Sub1 |  Sub2 | Sub3 |  Sub4 |
1\.  | ABC |   Eng  |  Maths| Science| Russian
2\.  | FMC |    French| Null| Null   | Null
3\.  | JBC |   French| Null | Null   | Null 
```

我不知道该怎么做？我应该创建一个视图还是一个表？

我想一个视图会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:59:39.733

我同意其他答案，`GROUP_CONCAT`与 PHP 一起拆分逗号分隔值可能是最好的方法，但是如果出于任何其他原因您需要通过 Pure SQL 建议的输出，我会建议以下方法之一。

**[1\. 自加入](http://sqlfiddle.com/#!2/f738c/3)**

```
SELECT  t1.Name, 
        MIN(t1.Subject) AS Sub1,
        MIN(t2.Subject) AS Sub2,
        MIN(t3.Subject) AS Sub3,
        MIN(t4.Subject) AS Sub4
FROM    Students t1
        LEFT JOIN Students T2 
            ON t1.Name = t2.Name 
            AND t2.Subject > t1.Subject
        LEFT JOIN Students T3 
            ON t2.Name = t3.Name 
            AND t3.Subject > t2.Subject
        LEFT JOIN Students T4 
            ON t3.Name = t4.Name 
            AND t4.Subject > t3.Subject
GROUP BY t1.Name; 
```

**[2.使用ROW_NUMBER类型函数进行聚合](http://sqlfiddle.com/#!2/f738c/12)**

```
SELECT   Name,
         MAX(IF(RowNum = 1,Subject, NULL)) AS Sub1,
         MAX(IF(RowNum = 2,Subject, NULL)) AS Sub2,
         MAX(IF(RowNum = 3,Subject, NULL)) AS Sub3,
         MAX(IF(RowNum = 4,Subject, NULL)) AS Sub4
FROM     (    SELECT   Name,
                       Subject,
                       @r:= IF(@Name = Name, @r + 1, 1) AS RowNum,
                       @Name:= Name AS Name2
              FROM    Students,
                      (SELECT @Name:='') n,
                      (SELECT @r:= 0) r
              ORDER BY Name, Sno
          ) t
GROUP BY Name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:02:56.553

使用以下查询，获取姓名和他/她的主题。

```
SELECT Name, GROUP_CONCAT(Subjects) AS List
FROM myTable
GROUP BY Name 
```

然后在 PHP 中，您可以使用**[`implode`](http://php.net/manual/en/function.implode.php)**函数来打印主题。

希望这可以帮助。

## [在 sqlfiddle 演示](http://sqlfiddle.com/#!2/2f108/7)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:35:31.317

尝试使用 GROUP BY 和[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.5/en/group-by-functions.html#function_group-concat)：

```
SELECT Name, GROUP_CONCAT(Subjects) AS Subjects_list
FROM students_table
GROUP BY Name 
```

然后在获取记录时使用PHP函数[explode](http://php.net/explode)来获取存储在Subjects_list列中的不同值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:15:11.730

不漂亮！

要使用上述解决方案，您可以执行以下操作：

```
SELECT 
  Sno, 
  Name,
  NULLIF(SUBSTRING_INDEX(SUBSTRING_INDEX(all_subjects, ',', 1), ',', -1), '') AS Sub1,
  NULLIF(SUBSTRING_INDEX(SUBSTRING_INDEX(all_subjects, ',', 2), ',', -1), '') AS Sub2,
  NULLIF(SUBSTRING_INDEX(SUBSTRING_INDEX(all_subjects, ',', 3), ',', -1), '') AS Sub3,
  NULLIF(SUBSTRING_INDEX(SUBSTRING_INDEX(all_subjects, ',', 4), ',', -1), '') AS Sub4
FROM (
  SELECT Sno, Name, CONCAT(GROUP_CONCAT(Subjects ORDER BY Sno),',,,') AS all_subjects FROM table GROUP BY name
) inner_sel
; 
```

您的请求导致假设永远不会超过**4 个**主题。`NULL`如果没有提到四个主题，您还需要s。

有一种请求会导致强制执行 SQL 代码，这通常是 SQL 的用途。

解释上述内容：我们使用`GROUP_CONCAT`，然后再次将其分解。由于可能少于**4 个**元素，我们用逗号 ( ) 填充`',,,'`。然后我们根据它在连接字符串中的位置分解每个部分，`NULL`如果它是空的，则返回。

不能说这是我在漂亮方面更好的答案之一。希望对你有帮助。

# url-rewriting - 使用 apache2 在文档根目录中服务 tomcat6 应用程序

> ID：11509408
> 
> 赞同：0
> 
> 时间：2012-07-16T17:28:05.113
> 
> 标签：url-rewriting, apache2, tomcat6, mod-jk, document-root

我有一台运行 apache2 的服务器，该服务器目前正在为一个 tomcat6 实例上的多个应用程序提供服务。这些已经配置并且可以工作，并且有一个重写规则，如下所示：

```
RewriteCond %{REQUEST_URI} ^/app1 [NC,OR]
RewriteCond %{REQUEST_URI} ^/app2 [NC,OR]
RewriteCond %{REQUEST_URI} ^/app3 [NC,OR]
RewriteCond %{REQUEST_URI} ^/aap4 [NC,OR]
RewriteCond %{REQUEST_URI} ^/app5 [NC,OR]
RewriteCond %{REQUEST_URI} ^/app6 [NC]
RewriteCond %{SERVER_PORT} !443
RewriteRule ^(.*)$ https://%{SERVER_NAME}$1 [R,L] 
```

然后它有 JKMounts：

```
JkMount /app1/*.jsp tomcat.web
JkMount /app2* tomcat.web
JkMount /app3* tomcat.web
JkMount /app6* tomcat.web
JkMount /app6* tomcat.web
JkMount /app6* tomcat.web 
```

worker.properties 看起来像这样：

```
workers.tomcat_home=/usr/local/tomcat
workers.java_home=/usr/local/java
ps=\

worker.list=tomcat.web

# Set properties for worker 'tomcat.web' (ajp13)
worker.tomcat.web.type=ajp13
worker.tomcat.web.host=localhost
worker.tomcat.web.port=8009
worker.tomcat.web.cachesize=10
worker.tomcat.web.cache_timeout=600
worker.tomcat.web.socket_keepalive=1
worker.tomcat.web.connection_pool_size=150
worker.tomcat.web.connection_pool_minsize=75
worker.tomcat.web.connection_pool_timeout=10000 
```

我添加了一个新的 tomcat 安装，并在那里运行了一个名为“在线”的新应用程序。所以我添加了一个新的工人，像这样（也将工人名称附加到worker.list中）：

```
# Set properties for worker 'tomcatb.web' (ajp13)
worker.tomcatb.web.type=ajp13
worker.tomcatb.web.host=localhost
worker.tomcatb.web.port=8109
worker.tomcatb.web.cachesize=10
worker.tomcatb.web.cache_timeout=600
worker.tomcatb.web.socket_keepalive=1
worker.tomcatb.web.connection_pool_size=150
worker.tomcatb.web.connection_pool_minsize=75
worker.tomcatb.web.connection_pool_timeout=10000 
```

然后我只是在所有其他 COND 之上添加了一个新的 COND

```
RewriteCond %{REQUEST_URI} ^/online [NC,OR] 
```

和一个像这样的新 JKMount：

```
JkMount /online* tomcatb.web 
```

在这里一切正常。我可以访问我的应用程序

```
http://MYSERVER/online 
```

它工作正常。现在我需要能够通过访问来服务该应用程序

```
http://MYSERVER/ 
```

但我无法做到这一点。我一直在尝试编写这样的重写规则（删除以前的 COND，并添加这个）：

```
RewriteCond %{REQUEST_URI} ^/online [NC,OR]
RewriteCond %{SERVER_PORT} !443
RewriteRule ^online(.*)$ / [PT,QSA,L] 
```

但这不起作用，当我去

```
http://MYSERVER/ 
```

我得到错误：

```
Forbidden
You don't have permission to access / on this server. 
```

有人可以为我指出如何配置 apache 以按照我需要的方式为我的应用程序提供服务的正确方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T22:22:16.373

我解决了这个问题，不确定我是否使用了最好的方法，但这就是我最终所做的（它满足了我的要求，所以现在已经足够好了）

我添加了一个新的重写条件，如下所示：

```
RewriteCond %{REQUEST_URI} ^/ [NC,OR] 
```

然后这个 JKMount

```
JkMount /* tomcatb.web 
```

由于我需要服务器的应用程序在单独的 tomcat 实例中运行，因此我删除了所有 webapps 并将战争部署为 ROOT.war。

重新启动一切，现在如果我去

```
http://MYSERVER/ 
```

它显示了我期待的内容

# java - Jersey 客户端 API 是否已经支持 JAX-RS 2.0？

> ID：11509414
> 
> 赞同：0
> 
> 时间：2012-07-16T17:28:20.207
> 
> 标签：java, jersey, jax-rs

当前的 Jersey 客户端 API 是否已经实现了 JAX-RS 2.0 客户端 API，或者这些是球衣的独立尝试？

我查看了上一个 JAx-RS 2.0 的早期草稿审查，客户端 Api 的尝试似乎与球衣的相似。不要误会我的意思——我知道 jersey 是参考实现。我只是想知道 jersey 是否在 2.0 版中实现了新的 jax-rs 2.0 客户端 api，或者它是否已经完成或其他。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:59:59.813

球衣 1 = JAX-RS 1，球衣 2 = JAX-RS 2。

从 Jersey 2 状态页面 - “超过一半的 Jersey 1.x 专有 API 在 2.0 版中成为 JAX-RS 的一部分”（但有一些变化 - 免责声明是我的）

# c++ - 字符数组作为 C++ 映射中的值

> ID：11509415
> 
> 赞同：6
> 
> 时间：2012-07-16T17:28:35.770
> 
> 标签：c++, dictionary, std, stdmap, c++-standard-library

我想定义类似的东西

```
Map<int, char[5] > myMap; 
```

上面的声明被 c++ 编译器接受并且没有抛出错误但是当我做这样的事情时

```
int main()
{
    char arr[5] ="sdf";
    map <int, char[5]> myMap;
    myMap.insert(pair<int, char[5]>(0,arr));
    return 0;
} 
```

我得到错误：

```
In file included from /usr/include/c++/4.6/bits/stl_algobase.h:65:0,
                 from /usr/include/c++/4.6/bits/char_traits.h:41,
                 from /usr/include/c++/4.6/ios:41,
                 from /usr/include/c++/4.6/ostream:40,
                 from /usr/include/c++/4.6/iostream:40,
                 from charMap.cpp:1:
/usr/include/c++/4.6/bits/stl_pair.h: In constructor ‘std::pair<_T1, _T2>::pair(const _T1&, const _T2&) [with _T1 = int, _T2 = char [5]]’:
charMap.cpp:9:42:   instantiated from here
/usr/include/c++/4.6/bits/stl_pair.h:104:31: error: array used as initializer
/usr/include/c++/4.6/bits/stl_pair.h: In constructor ‘std::pair<_T1, _T2>::pair(const std::pair<_U1, _U2>&) [with _U1 = int, _U2 = char [5], _T1 = const int, _T2 = char [5]]’:
charMap.cpp:9:43:   instantiated from here
/usr/include/c++/4.6/bits/stl_pair.h:109:39: error: array used as initializer 
```

定义一个固定大小的字符数组对我来说很重要，因为它优化了我的网络流操作。有没有办法实现它？我不想使用`char *`or `std::string`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T17:32:04.817

我了解您的性能要求（因为我也做类似的事情），但是以这种方式使用字符数组是相当不安全的。

如果您有权访问 C++11，则可以使用[`std::array`](http://en.cppreference.com/w/cpp/container/array). 然后你可以像这样定义你的地图：

```
map <int, array<char, 5>> myMap; 
```

如果你不能使用 C++11，那么你可以使用[`boost::array`](http://www.boost.org/doc/libs/1_50_0/doc/html/array.html).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:34:40.943

一种方法是将固定大小的字符数组包装为结构。

```
struct FiveChar
{
   FiveChar(char in[5]) { memcpy(data, in, 5); }
   char& operator[](unsigned int idx) { return data[idx]; }
   char data[5];
};

int main(void)
{
   char arr[5] = "sdf";
   map<int, FiveChar> myMap;
   myMap.insert(pair<int, FiveChar>(0, arr));
   return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:35:23.280

您不能在标准容器中使用数组。

1.  使用 an`std::vector`而不是数组

2.  使用指向 5 个元素的数组的指针映射。

3.  使用[boost 元组](http://www.boost.org/doc/libs/1_42_0/libs/tuple/doc/tuple_users_guide.html)而不是 5 个元素的数组。

4.  而不是使用数组创建一个`struct`需要 3 个元素的新数组。使`map<int, newstructtype>`. 或者将您的数组包装在 a 中`struct`，这也可以。

\

```
struct ArrayMap
{
    int color[5];
}; 
```

/

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-16T17:35:17.510

根据[文档](http://cplusplus.com/reference/std/utility/pair/)对可以保存（并定义）不同的类。C数组不是一个类，而是一个构造。您必须使用重载定义自己的类`operator[]()`。可能还需要比较运算符

# javascript - 在 Impactjs 中重复背景

> ID：11509416
> 
> 赞同：2
> 
> 时间：2012-07-16T17:28:37.720
> 
> 标签：javascript, mobile

我想创建一个在 y 轴上有重复背景的游戏，如下所示：

![在此处输入图像描述](../Images/7b594695af9d89c22cb3cb78ad8fa125.png)

我在 Weltmeister 中勾选了“重复”，并且重复了背景。但是在游戏运行中，只有在后台运行完成后才会重复后台。所以，现在我将在后台运行完成和新背景出现之间有一个空白背景。

有什么办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T04:21:06.157

确保您已将 Weltmeister 中背景层的距离属性从 1 增加到 2。还要确保您的关卡已正确保存并且权限已应用于`lib/game/levels`文件夹。

```
chmod -R 777 lib/game/levels 
```

# sql-server - 在 SQL Server Management Studio 的“单一实例”中打开备用扩展

> ID：11509420
> 
> 赞同：1
> 
> 时间：2012-07-16T17:28:57.470
> 
> 标签：sql-server, sql-server-2008

我知道如何向 SQL Server Management Studio 添加额外的扩展，让它们像 .sql 文件一样对待。但是，当打开它们时，会创建一个新的 Management Studio 实例。

我还看到许多关于双击 .SQL 文件并让它们在现有 SQL 服务器实例中打开的问题。这已经对我有用了。

不起作用的是我添加的其他扩展。我正在使用.PRC。所有修复都建议更改各种注册表设置，所有这些都与默认的 .sql 扩展名相关。

我看不出如何应用这些修复中的任何一个来使其他扩展工作，或者我是否可以做任何其他事情来解决这个问题？

编辑：

到目前为止我所做的...

1) 将所有相同的设置从 [HKEY_CLASSES_ROOT.sql] 复制到 [HKEY_CLASSES_ROOT.prc]。

2) 检查 sql server central 文章中提到的所有设置，以解决 .SQL 扩展的此问题。

3) 配置 SSMS 文件类型 .PRC 与编辑体验“SQL 查询编辑器”。

4) 我什至尝试创建一个批处理文件来为我打开文件："c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\ssms.exe" /dde %1

即使是我尝试的第四件事也会打开一个新实例，尽管这与在注册表中为 sqlweb.sql.9.0 配置的调用相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-26T12:04:59.870

我解决了双击打开PRC文件的问题。我只是从 regedit 导出了这个密钥

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.sql 
```

将此文件修改为如下所示

Windows 注册表编辑器版本 5.00

```
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.PRC]

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.PRC\OpenWithList]
"a"="ssms.exe"
"MRUList"="a"

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.PRC\OpenWithProgids]
"ssms.sql.11.0"=hex(0):
"ssms.sql.12.0"=hex(0):

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.PRC\UserChoice]
"Progid"="ssms.sql.12.0" 
```

并将其应用于注册表。在应用新密钥之前，我备份并从注册表中删除的原始 PRC 密钥。现在通过在打开的 SSMS 实例中双击 PRC 文件来打开 PRC 文件。

但是突出显示对我来说仍然不起作用:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:26:50.160

您似乎在处理您的源代码控制系统时遇到了很多麻烦。您是否考虑过让您的源代码控制系统识别过程、表、视图等的不同扩展名，这将阻止您必须在每个开发人员的计算机上进行这些注册表更改？

```
.proc.sql -> stored procedure
.view.sql -> view
.fn.sql   -> function 
```

等等等等。当然，您的源代码控制系统可以处理包含`.`.

# iphone - 我可以在使用 iOS Safari 浏览器的网页上使用第三方 PhoneGap 插件吗？

> ID：11509424
> 
> 赞同：0
> 
> 时间：2012-07-16T17:29:06.797
> 
> 标签：iphone, html, cordova, phonegap-plugins

我正在使用 PhoneGap 库和 HTML5 开发一个仅针对 iOS 设备的应用程序（目前）。这个应用程序将只是一个通过 iOS Safari 浏览器访问的网页。我将使用某些功能，例如使用 PhoneGap 库访问 iOS 设备的加速度计、地理位置、联系人等。

1.  我可以在设备上不安装任何东西的情况下访问所有这些功能吗？

2.  我想了解 PhoneGap 如何仅通过使用 JavaScript 来访问设备的本机功能？

3.  我看到有几个为 PhoneGap 库编写的有用插件。我可以在我的页面中简单地使用这些插件（js 文件）而不在设备上安装任何东西吗？例如PhoneGap ChildBrowser 插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:03:34.613

> 我可以在设备上不安装任何东西的情况下访问所有这些功能吗？

您必须构建为本机 ios 应用程序并将其安装到设备上。

> 我想了解 PhoneGap 如何仅通过使用 JavaScript 来访问设备的本机功能？

Phonegap 提供了一个 Javascript 接口来访问实际上是 Objective-C 函数的硬件特性。如果您查看 Phonegap 源代码，您会看到很多 Objective-C 代码。所以它不仅仅是Javascript。

> 我看到有几个为 PhoneGap 库编写的有用插件。我可以在我的页面中简单地使用这些插件（js 文件）而不在设备上安装任何东西吗？例如PhoneGap ChildBrowser 插件？

不可以。它们必须在 iOS 应用程序中才能工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:51:07.167

似乎您追求的是一种仅通过浏览器访问 APP 功能的方式。

您可以使用 HTML5 访问一些内容，例如：

*   地理位置[http://html5demos.com/geo](http://html5demos.com/geo)
*   Accelerometer [http://menscher.com/teaching/woaa/examples/html5_accelerometer.html](http://menscher.com/teaching/woaa/examples/html5_accelerometer.html)
*   Video Embedding [http://www.w3schools.com/html5/html5_video.asp](http://www.w3schools.com/html5/html5_video.asp)

# javascript - 使网页的 URL 永久化

> ID：11509428
> 
> 赞同：-3
> 
> 时间：2012-07-16T17:29:24.120
> 
> 标签：javascript, html, url-routing

我有一个网页（本地主机）。当我在浏览器中键入它的 URL 时，我正在使用 Javascript 将其重定向到另一个网页。

```
<head>
<script type="text/javascript">
    function wa() {
        window.location = "http://www.anyWebsite.com";
    }
</script>
</head>
<body onload="wa()"> 
```

因此，Web 浏览器中的 URL 也会发生变化。我在这里唯一需要的是 URL 不应该改变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:31:17.070

您可以将其他页面加载到覆盖整个页面的`<iframe>`或中。`<frameset>`

请注意，您将无法显示其他页面的标题。

另请注意，出于安全原因，许多网站（例如 StackOverflow）会阻止此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:31:40.667

简单的回答！！不可能

每次更改时页面都会刷新`window.location`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:31:42.843

出于安全原因，这是不可能的，用户应该看到他们所在的 URL。

但是有一些解决方法 - 为整个页面制作一个 IFrame 并在那里设置位置或动态加载页面并从不同位置更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T17:31:53.550

我不敢相信我要建议使用 iframe，但你最简单的解决方案确实是 iframe。

创建一个 100%x100% 的 iframe，并在窗口加载时将 iframe 的位置设置为您的新 url。位置栏将（应该？）保持不变，而页面似乎已移动到不同的位置。

iframe：[http ://www.w3schools.com/tags/tag_iframe.asp](http://www.w3schools.com/tags/tag_iframe.asp)

# lisp - 计算列表中的数字

> ID：11509434
> 
> 赞同：1
> 
> 时间：2012-07-16T17:29:41.717
> 
> 标签：lisp, common-lisp

有没有人可以帮助我用普通的 LISP 编写一个计算列表中数字的函数？我写的代码如下，但它不起作用！

```
(defun count-numbers(lst)
    (let(result()))
    (dolist(number lst)
    (push number result))
    (length result)) 
```

例如，当我输入这个查询时`"(count'(r 4 f d w 2 3 4 1 z))"`，我必须得到 5。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:19:24.837

既然是作业，我就给点指点。第一：简单。如果您是 Common-Lisp 的新手，请使用它的基本功能。例如：**递归**。纯粹的功能风格。想想这样的事情：

```
(defun count (list counter) 
    ;; something
) 
```

我们先检查*清单*。如果它是空的，我们已经检查了所有的元素，所以我们返回*counter*。如果*列表*不为空，我们

1.  取它的第一个元素
2.  我们检查它是否是一个数字
3.  这是一个数字！我们在列表的其余部分递归调用**count并且 counter = counter + 1**
4.  这不是一个数字！我们使用与以前相同的*计数器*递归调用列表其余部分的**计数**

 *使用 (numberp n)。如果*n*是数字，则返回 T，否则返回 NIL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:11:20.170

```
(defun count-numbers (lst)
  (let (result ()))
  (dolist (number lst)
     (push number result))
  (length result)) 
```

检查压痕。那是你想要的吗？也许不吧。

然后你也将所有元素推送到结果列表中？那是你要的吗？

这是数字函数的列表。[http://www.lispworks.com/documentation/HyperSpec/Body/c_number.htm](http://www.lispworks.com/documentation/HyperSpec/Body/c_number.htm) 也许你需要一个？

这是一本很好的 Lisp 入门书籍，可供下载： [http ://www.cs.cmu.edu/~dst/LispBook/](http://www.cs.cmu.edu/~dst/LispBook/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T03:22:35.770

我想说有多种方法可以解决这个问题，一种是命令式循环，就像已经编写的最正确的解决方案一样，递归计数函数（这可能是最糟糕的方法，因为 CL 不能保证你会赢' t 破坏堆栈），或者您可能会在生产中实际使用的功能方法。最后一个是这样的：

```
(defun count-numbers (list) (count-if #'numberp list)) 
```*

# ruby-on-rails - Rails 是否为 rake 任务运行初始化程序？

> ID：11509439
> 
> 赞同：32
> 
> 时间：2012-07-16T17:30:13.770
> 
> 标签：ruby-on-rails, initializer, rake-task

运行 rake 任务时是否执行了来自配置/初始化程序的脚本？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-16T17:50:12.133

如果您的 rake 任务依赖于`:environment`.

即，您像这样声明您的任务：

```
task :my_task => :environment do
     ...
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:50:11.633

**大部分是的。**当您的任务依赖于`:environment`.

# delphi - 使用 Indy 10.5.8 POST 时标题中的垃圾

> ID：11509442
> 
> 赞同：2
> 
> 时间：2012-07-16T17:30:33.507
> 
> 标签：delphi, post, indy, multipart

我正在尝试通过 Indy 10.5.8 在多部分/表单数据中使用 POST 发送文件。我正在使用 Delphi XE2，并且一直在尝试将文件发布到服务器。这是我第一次尝试这个，由于我对 Indy 的经验非常有限，我采用了以下代码片段：

```
unit MsMultiPartFormData;

interface

uses
  SysUtils, Classes;

const
  CONTENT_TYPE = 'multipart/form-data; boundary=';
  CRLF = #13#10;
  CONTENT_DISPOSITION = 'Content-Disposition: form-data; name="%s"';
  FILE_NAME_PLACE_HOLDER = '; filename="%s"';
  CONTENT_TYPE_PLACE_HOLDER = 'Content-Type: %s' + crlf + crlf;
  CONTENT_LENGTH = 'Content-Length: %d' + crlf;

type
  TMsMultiPartFormDataStream = class(TMemoryStream)
  private
    FBoundary: string;
    FRequestContentType: string;
    function GenerateUniqueBoundary: string;
  public
    procedure AddFormField(const FieldName, FieldValue: string);
    procedure AddFile(const FieldName, FileName, ContentType: string; FileData: TStream); overload;
    procedure AddFile(const FieldName, FileName, ContentType: string); overload;
    procedure PrepareStreamForDispatch;
    constructor Create;
    property Boundary: string read FBoundary;
    property RequestContentType: string read FRequestContentType;
  end;

implementation

{ TMsMultiPartFormDataStream }

constructor TMsMultiPartFormDataStream.Create;
begin
  inherited;
  FBoundary := GenerateUniqueBoundary;
  FRequestContentType := CONTENT_TYPE + FBoundary;
end;

procedure TMsMultiPartFormDataStream.AddFile(const FieldName, FileName,
  ContentType: string; FileData: TStream);
var
  sFormFieldInfo: string;
  Buffer: PChar;
  iSize: Int64;
begin
  iSize := FileData.Size;
  sFormFieldInfo := Format(CRLF + '--' + Boundary + CRLF + CONTENT_DISPOSITION +
    FILE_NAME_PLACE_HOLDER + CRLF + CONTENT_LENGTH +
      CONTENT_TYPE_PLACE_HOLDER, [FieldName, FileName, iSize, ContentType]);
  {so: boundary + crlf + content-disposition+file-name-place-holder}

  Write(Pointer(sFormFieldInfo)^, Length(sFormFieldInfo));
  FileData.Position := 0;
  GetMem(Buffer, iSize);
  try
    FileData.Read(Buffer^, iSize);
    Write(Buffer^, iSize);
  finally
    FreeMem(Buffer, iSize);
  end;
end;

procedure TMsMultiPartFormDataStream.AddFile(const FieldName, FileName,
  ContentType: string);
var
  FileStream: TFileStream;
begin
  FileStream := TFileStream.Create(FileName, fmOpenRead or fmShareDenyWrite);
  try
    AddFile(FieldName, FileName, ContentType, FileStream);
  finally
    FileStream.Free;
  end;
end;

procedure TMsMultiPartFormDataStream.AddFormField(const FieldName,
  FieldValue: string);
var
  sFormFieldInfo: string;
begin
  sFormFieldInfo := Format(CRLF + '--' + Boundary + CRLF + CONTENT_DISPOSITION + CRLF + CRLF +
    FieldValue, [FieldName]);
  Write(Pointer(sFormFieldInfo)^, Length(sFormFieldInfo));
end;

function TMsMultiPartFormDataStream.GenerateUniqueBoundary: string;
begin
  Result := '---------------------------' + FormatDateTime('mmddyyhhnnsszzz', Now);
end;

procedure TMsMultiPartFormDataStream.PrepareStreamForDispatch;
var
  sFormFieldInfo: string;
begin
  sFormFieldInfo := CRLF + '--' + Boundary + '--' + CRLF;
  Write(Pointer(sFormFieldInfo)^, Length(sFormFieldInfo));
  Position := 0;
end;

end. 
```

我这样调用代码：

```
function PostFile(filename, apikey: string): boolean;
var
  ResponseStream: TMemoryStream;
  MultiPartFormDataStream: TMsMultiPartFormDataStream;
begin
//  Form5.IdHTTP1.HandleRedirects := true;
  Form5.idHTTP1.ReadTimeout := 0;
//  Form5.idHTTP1.IOHandler.LargeStream           := True;
  Result := false;
  MultiPartFormDataStream := TMsMultiPartFormDataStream.Create;
  ResponseStream := TMemoryStream.Create;
  try
    try
    Form5.IdHttp1.Request.ContentType := MultiPartFormDataStream.RequestContentType;
    MultiPartFormDataStream.AddFormField('apikey', apikey);
    MultiPartFormDataStream.AddFile('file', filename, 'multipart/form-data');

    MultiPartFormDataStream.PrepareStreamForDispatch;
    MultiPartFormDataStream.Position := 0;
    Form5.IdHTTP1.Post('http://www.updserver.tld/api//file/save', MultiPartFormDataStream, ResponseStream);
    MultiPartFormDataStream.SaveToFile(ExtractFilePath(Application.ExeName) + 'a.txt');
    Result := true;
    except
 on E:Exception do
   begin
    Form5.Close;
    ShowMessage('Upload failed! '+E.Message);
   end;

    end;
  finally
    MultiPartFormDataStream.Free;
    ResponseStream.Free;
  end;
end; 
```

文件被发送，但被服务器拒绝。仔细检查发送的数据会发现数据有些损坏（我怀疑编码问题） - 我看到的是：

```
POST /api/file/save HTTP/1.0
Connection: keep-alive
Content-Type: multipart/form-data; boundary=---------------------------071312151405662
Content-Length: 11040172
Host: www.updserver.tld
Accept: text/html, */*
Accept-Encoding: identity
User-Agent: Mozilla/3.0 (compatible; Indy Library)

.
.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.0.7.1.3.1.2.1.5.1.4.0.5.6.6.2.
.
.C.o.n.t.e.n.t.-.D.i.s.p.o.s.i.t.i.o.n.:. .f.o.r.m.-.d.a.t.a.;. .n
.
.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.0.7.1.3.1.2.1.5.1.4.0.5.6.6.2.
.
.C.o.n.t.e.n.t.-.D.i.s.p.o.s.i.t.i.o.n.:. .f.o.r.m.-.d.a.t.a.;. .n.a.m.e.=.".f.i.l.e.".;. .f.i.l.e.n.a.m.e.=.".C.:.\.U.s.e........................>.......................................................v.......:...;...<.......[.......v.......................t.......o.......z............
...
... 
```

从正常工作的 Python 客户端发送的常规标头如下所示：

```
POST https://updserver.tld/api/file/save HTTP/1.0
content-type: multipart/form-data; boundary=---------------------------071312151405662
content-length: 6613364

---------------------------071312151405662
Content-Disposition: form-data; name="apikey"
ac36fae9a406596[rest-of-api-key-goes-here]17966c42b60c8c4cd
---------------------------071312151405662
Content-Disposition: form-data; name="file"; filename="C:\Users\User\Desktop\Project1.exe"
Content-Type: application/octet-stream 
```

知道我做错了什么吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T21:10:06.890

问题的根源在于您的自定义`TStream`代码与D2009+ 版本的Delphi 不兼容。Delphi`String`和`PChar`类型不再是 Ansi，但代码假定它们仍然是。它们现在是 Unicode UTF-16。您没有正确考虑这一点，例如：

```
procedure TMsMultiPartFormDataStream.AddFile(const FieldName, FileName, ContentType: string; FileData: TStream);   
var   
  sFormFieldInfo: AnsiString;
  iSize: Int64;   
begin   
  iSize := FileData.Size;   
  // NOTE: this will only work for ASCII filenames!!!!
  //
  // Non-ASCII filenames will get converted to Ansi, which can cause data loss.
  // To send non-ASCII filenames correctly, you have to encode it to a charset
  // first, such as UTF-8, and then encode the resulting bytes using
  // MIME's RFC2047 encoding so the server can decode the filename properly
  // on its end...
  //
  sFormFieldInfo := Format(CRLF + '--' + Boundary + CRLF + CONTENT_DISPOSITION +   
    FILE_NAME_PLACE_HOLDER + CRLF + CONTENT_LENGTH +   
      CONTENT_TYPE_PLACE_HOLDER, [FieldName, FileName, iSize, ContentType]);   
  {so: boundary + crlf + content-disposition+file-name-place-holder}   

  Write(sFormFieldInfo[1], Length(sFormFieldInfo) * SizeOf(AnsiChar));   

  if iSize > 0 then
  begin
    FileData.Position := 0;   
    CopyFrom(FileData, iSize);   
  end;
end;   

procedure TMsMultiPartFormDataStream.AddFormField(const FieldName, FieldValue: string);   
var   
  sFormFieldInfo: AnsiString;   
begin   
  // NOTE: this will only work for ASCII text!!!!
  //
  // Non-ASCII text will get converted to Ansi, which can cause data loss.
  // To send non-ASCII text correctly, you have to encode it to a charset
  // first, such as UTF-8 and then encode the resulting bytes using
  // MIME's 'quoted-printable' or 'base64' enoding, and then include
  // appropriate 'charset' and Content-Transfer-Encoding' headers so the
  // server can decode the data properly on its end...
  //
  sFormFieldInfo := Format(CRLF + '--' + Boundary + CRLF + CONTENT_DISPOSITION + CRLF + CRLF +   
    FieldValue, [FieldName]);   
  Write(sFormFieldInfo[1], Length(sFormFieldInfo) * AnsiString(AnsiChar));   
end;   

procedure TMsMultiPartFormDataStream.PrepareStreamForDispatch;   
var   
  sFormFieldInfo: AnsiString;   
begin   
  sFormFieldInfo := CRLF + '--' + Boundary + '--' + CRLF;   
  Write(sFormFieldInfo[1], Length(sFormFieldInfo) * SizeOf(AnsiChar));   
  Position := 0;   
end; 
```

话虽如此，我强烈建议您完全摆脱自定义`TMsMultiPartFormDataStream`类。它所做的只是模仿 Indy 自己的`TIdMultipartFormDataStream`class 的过时版本。只需`TIdMultipartFormDataStream`按原样使用 Indy 的原生类。它为您处理 D2009+ Unicode，例如：

```
uses
  ..., IdMultipartFormData;

function PostFile(const filename, apikey: string): boolean; 
var 
  ResponseStream: TMemoryStream; 
  MultiPartFormDataStream: TIdMultiPartFormDataStream; 
begin 
  Result := False; 

  //Form5.IdHTTP1.HandleRedirects := true; 
  Form5.idHTTP1.ReadTimeout := 0; 
  //Form5.idHTTP1.IOHandler.LargeStream := True; 

  try
    ResponseStream := TMemoryStream.Create; 
    try
      MultiPartFormDataStream := TIdMultiPartFormDataStream.Create; 
      try 
        MultiPartFormDataStream.AddFormField('apikey', apikey); 
        MultiPartFormDataStream.AddFile('file', filename, 'application/octet-stream');      
        Form5.IdHTTP1.Post('http://www.updserver.tld/api/file/save', MultiPartFormDataStream, ResponseStream); 
        ResponseStream.SaveToFile(ExtractFilePath(Application.ExeName) + 'a.txt'); 
        Result := True; 
      finally 
        MultiPartFormDataStream.Free; 
      end;
    finally
      ResponseStream.Free; 
    end; 
  except 
    on E:Exception do 
    begin 
      Form5.Close; 
      ShowMessage('Upload failed! ' + E.Message); 
      end; 
    end; 
  end; 
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:48:01.173

所有这些`.`字符都代表一个`00`字节吗？因为这看起来像是 ASCII->UTF16 转换的结果。并且 Content-Disposition 中的垃圾可能与诸如复制字节并导致缓冲区末尾错误的转换有关，从而使您得到损坏的字符串。

如果你能想出代码来一致地重现这个，你可能应该[在 Indy 论坛上发布一个错误报告。](http://forums2.atozed.com/viewforum.php?f=6)

# c# - 如何使用实体框架从数据库生成可用的 dbcontext？

> ID：11509449
> 
> 赞同：1
> 
> 时间：2012-07-16T17:30:54.790
> 
> 标签：c#, entity, dbcontext

我制作了一个简单的数据库，其中包含 2 个表和几列。在我安装实体框架 4.1+ 时阅读的一些教程中，我可以生成“DbContext 代码”，然后我可以使用本地上下文来获取比 DbSet 更好的 ObservableCollection，因为它会自动更新 UI。所以我安装了实体框架 4.1，选择了我的数据库模型并选择了“ADO.NET DbContext Generator”。所以我得到了这个：

```
namespace BazaStudentow
{
    using System;
    using System.Data.Entity;
    using System.Data.Entity.Infrastructure;

    public partial class DatabaseEntities : DbContext
    {
        public DatabaseEntities()
            : base("name=DatabaseEntities")
        {
        }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            throw new UnintentionalCodeFirstException();
        }

        public DbSet<Notes> Notes { get; set; }
        public DbSet<Students> Students { get; set; }
    }
} 
```

加上带有简单表模型的 StudModel.tt 文件。

所以在主课中我添加了这个： `DatabaseEntities db = new DatabaseEntities();`

但后来我意识到 db.Students.Local 是空的（我之前在编辑器中手动添加了 2 条记录），虽然 db.Students 有 2 条记录。所以我发现了这个：[ObservableCollection 比 ObjectSet 更好](https://stackoverflow.com/questions/6193625/observablecollection-better-than-objectset)（第二个答案），但是没有“Load”这样的方法。我错过了什么？我应该添加一些特殊代码来让这个“加载”工作吗？

我只是简单地想： 1。创建新项目并添加简单的数据库。2.使用Entity Framework自动生成一些代码，这样我就可以将表绑定到DataGrid或其他东西，当数据更改时会自动更新（所以我需要ObservableCollection）。3\. 当我有这个添加一些功能到插入/更新/删除数据（使用自动更新 ofc）。

请帮忙，干杯；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:56:21.030

在您对数据库执行查询之前，Local 中不会有任何内容。实现此目的的一种方法是调用 Load，它会这样做，并返回 ObservableCollection(Of Student)（在您的情况下）。

```
Dim bs = New BindingSource
Dim s = db.Students

s.Load()

'At this point, Local will contain all students.
'Cast to a BindingList, which stays in sync with the ObservableCollection.

bs.DataSource = s.Local.ToBindingList 
```

或者我想你可以走这条路：

```
Dim bs = New BindingSource
db.Students.Load
bs.DataSource = db.Students.Local.ToBindingList 
```

抱歉，C# 不是我的朋友。上面的代码应该很容易转换。

您在上面生成模型和上下文的步骤看起来不错。

# templates - jsRender 模板在渲染后消失

> ID：11509452
> 
> 赞同：1
> 
> 时间：2012-07-16T17:31:09.713
> 
> 标签：templates, jsrender

在我调用`render`我的 jsRender 模板后，它似乎被消耗掉了，因此从 DOM 中删除了。这令人沮丧，因为我有一个页面需要根据用户交互多次呈现模板。

```
console.log($('#tpl'));
$('#container').html($('#tpl').render(json));
console.log($('#tpl')); 
```

第二个 console.log 是一个空数组，我可以使用 DOM 检查器和 jsRender 抛出的异常确认模板不再存在：`Uncaught JsRender Error: Unknown template: "#tpl"`-- 必须重新加载页面才能将模板重新注入 DOM。

如何在渲染之间保留 jsRender 模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:31:09.713

我仍然不确定为什么它必须被消耗并且在第一次渲染后根本不能留在 DOM 中，但我找到了一种解决方法。如果有人知道从 DOM 中删除模板的原因，我仍然很感兴趣。

**更新：实际答案**（谢谢，鲍里斯）

我的模板在我的`#container`元素中，所以该`html()`方法当然是覆盖它。傻我。

**~~无论如何~~，巧妙的小技巧**

使用[这个“变体”示例](http://borismoore.github.com/jsrender/demos/variants/accessing-templates/03_getting-template-objects-from-script-declaration.html)，我将模板保存在局部变量中。然后我调用`render`变量名而不是 jQuery 选择器：

```
var tpl = $.templates('#tpl');

.
.
.

console.log(tpl);
$('#container').html(tpl.render(json));
console.log(tpl); 
```

这*也*设法在渲染中保留模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T15:27:19.330

我今天也遇到了类似的问题，我在正文中有两个目标 div 和两个脚本块模板。我的问题是我没有正确关闭 div 元素标签（太多的 xaml），结果是第二个模板从未呈现，因为它找不到。

这是一个显示正确用法的 JsFiddle（而不是 /> 自关闭语法）：

[http://jsfiddle.net/jgoldsmith/XvvPC/](http://jsfiddle.net/jgoldsmith/XvvPC/)

希望对其他人有所帮助。

# android - 在 onLoadFinished 方法中启动 Activity

> ID：11509455
> 
> 赞同：4
> 
> 时间：2012-07-16T17:31:11.933
> 
> 标签：android, android-fragments, android-activity, android-loadermanager, android-loader

我有`DialogFragment`一个`Loader`.

对话框提示用户从应用程序中注销。

当用户选择注销时，我会触发`Loader`它清除首选项和数据库，然后我完成 current `Activity`。

完成`Loader`后我想`Activity`用登录屏幕开始一个新的，但我遇到了两个问题：

1.  `getActivity()`方法返回`null`
2.  我无法运行新`Activity`的，因为我没有了`Activity` `context`

您对此有任何解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:45:30.573

听起来您的情况根本不需要使用 a`Loader`或 the `LoaderManager`。

1.  使用 an`AsyncTask`清除首选项和数据库（`ProgressDialog`如果此操作很耗时，可能会显示某种类型的 a）。

2.  当任务完成时，`onPostExecute`被调用。将片段中的回调方法写入将首先调用`startActivity(...)`然后调用的活动`finish()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:05:21.557

您可以再次调用意图：

```
final Context context = this;

//load next activity by intent
Intent intent = new Intent(context, YourActivity.class); 
//use the YourActivity activity project
startActivity(intent); 
```

# arrays - 在 O(1) 中确定基于数组的二叉树中的最低子节点（具有最大索引的后代）？

> ID：11509459
> 
> 赞同：4
> 
> 时间：2012-07-16T17:31:20.267
> 
> 标签：arrays, algorithm, math, data-structures, binary-tree

一些二叉树结构（例如堆）可以通过从左到右、从上到下设置索引来使用数组来实现

```
           0
      / \
     1 2
   / \ / \
  3 4 5 6
 / \ / \ / \ / \
7 8 9 10 11 12 13 14
       ... ETC。

```

`x`可以在 O(1) 中轻松找到索引处节点的子节点和父节点：

```
左孩子（x）= 2x+1
儿童权利(x) = 2x+2
父母（x）=（x-1）/ 2

```

但是**有没有办法在 O(1) 中找到 x 的最低后代** *（即具有最高索引的后代）*？例如，在上面的树中， 的最低后代`x=0`是 14，而 for`x=1`是`10`。请注意，对于`x=1`，如果树中只有 10 个元素，则它应该返回`9`。

我可以假设我的数组中的元素永远不会超过 2 ^(32 个)，因此可以使用位移在 O(1) 中实现2 ^(n 。)可能`log_2`还有（？？？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:54:36.093

嗯，我想通了。节点 x 的深度为

```
深度(x) = log2(x+1)

```

`x`类似地，可以很容易地找到节点的第 i 个左孩子和第 i 个右孩子：

```
ithLeftChild(x, i) = 2 i (x+1) - 1
ithRightChild(x, i) = 2 i (x+2) - 2

```

最左边的孩子在深度处的索引`d`是`ithLeftChild(x, d - depth(x))`，对于右边的孩子也是如此。

让我们调用最后一个元素的索引`n`。所以，现在我们可以找到 的深度，并且我们还可以找到该深度的和`n`的索引*（可能比最后一个元素大，这意味着它们实际上并不存在）*。`leftmostChild``rightmostChild`

 *现在我们只有三种情况：

*   `n < leftmostChild`. 那么我们的子树在那个深度没有元素，所以最高索引必须是`parent(rightmostChild)`。
*   `leftmostChild <= n <= rightmostChild`. 那么最高的指数必然是`n`。
*   `rightmostChild < n`. 那么`rightmostChild`一定是我们的最高指标。

* * *

2 ^i可以在 O(1) 中实现，以合理`i`使用位移；`log2(x)`可以[使用 256 字节的查找表](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogLookup)在 O(1) 中实现。所以整体算法是**O(1)**。*

# jquery - 在不使用效果回调的情况下链接效果

> ID：11509460
> 
> 赞同：2
> 
> 时间：2012-07-16T17:31:20.733
> 
> 标签：jquery, jquery-animate

我知道如何链接两个效果，以便在使用回调完成第一个效果后执行第二个效果。如此；

```
$("#target").fadeOut('slow',function(){
   $(this).slideUp('slow');
}); 
```

所以这很有效，并且 div 在它向上滑动之前先淡出。我希望在成功的 ajax 调用之后发生 slideUp，但是**在**fadeOut 完成之后，但是当我执行以下代码时，ajax 请求发生得很快，并且在 fadeOut 完成之前它会滑动。

```
$.ajax({
    /** settings **/
    beforeSend: function() {
       $("#target").fadeOut('slow');
    },
    success: function() {
       $("#target").slideUp('slow');
    },
    error: function() {
       $("#target").fadeIn('slow');
    }
}); 
```

如何在成功回调中告诉 jQuery 在 fadeOut 完成后执行 slideUp。

我确实试过这个。

```
 $("#target").queue(function(){
    $(this).slideUp('slow');
 }); 
```

但它没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:36:37.737

简单的解决方案！

```
var flag=false;

$.ajax({
    /** settings **/
    beforeSend: function() {
       $("#target").fadeOut('slow', function() {
           flag=true;
       });
    },
    success: function() {
       var timer = setInterval(function() {
            if (flag) {
                $("#target").slideUp('slow');
                clearInterval(timer);
            }
       }, 500)
    },
    error: function() {
       $("#target").fadeIn('slow');
    }
}); 
```

还有完整的处理程序（现在称为`.done()`）、promises 或 just `.is(':animated')`，可用于此类事情。我发现一个简单的区间通常是最简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:35:46.950

这是一个粗略的方法：

```
var done = false;
var todo = null

var amDone = function() {
   if (todo) {
      todo();
   } else {
      done = true;
   }
};

var ifDone = function(f) {
  return function() {
     if (done) {
        f();
     } else {
        todo = f;
     }
  };
};

$.ajax({
    /** settings **/
    beforeSend: function() {
       $("#target").fadeOut('slow', amDone);
    },
    success: ifDone(function() {
       $("#target").slideUp('slow');
    }),
    error: ifDone(function() {
       $("#target").fadeIn('slow');
    })
}); 
```

**编辑**固定以允许不同的效果

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:41:21.737

我建议使用[jquery Deferred](http://api.jquery.com/category/deferred-object/)。

```
var myDfd = $.Deferred();
$("#target").fadeOut('slow',function(){
   myDfd.resolve();
});

var ajaxDfd = $.ajax({
    /** settings **/
    beforeSend: function() {
       $("#target").fadeOut('slow');
    },
    error: function() {
       $("#target").fadeIn('slow');
    }
});

$.when(ajaxDfd, myDfd).then(function() {
   $("#target").slideUp('slow');
}); 
```

您等待第一个 Deferred（fadeOut）和 AJAX 查询完成以执行一个回调。

# android - 是否可以使用 Android 中的后台服务检查“联系人”和“消息”应用程序状态？

> ID：11509465
> 
> 赞同：4
> 
> 时间：2012-07-16T17:31:49.363
> 
> 标签：android, galaxy

**介绍**

你们中的一些人可能知道，新的三星 Galaxy S3 具有一些很酷的运动功能，可用于简化一些“任务”。对于那些不知道的人，[这里是解释的链接](http://www.youtube.com/watch?v=YhMgYl3CCxc)

**动机**

我想写一个后台服务来充当这个`Touchwizz-exclusive set of features`。

**有什么可能**

根据有关传感器提供程序和后台服务的 android 文档，以及[在此链接上找到](http://www.youtube.com/watch?v=YhMgYl3CCxc)的有用信息（由@Michal K 提供），可以从后台服务拦截这些传感器事件。即使电池非常昂贵，它仍然是可能的。

**我不确定这是可能的**

我不确定是否可以使用后台服务或任何其他方式与前台应用程序（无论是“联系人”、“消息传递”还是我们）进行交互。

通过交互，我的意思是，能够做这样的事情，例如：

1.  BGService 拦截“说”手机处于“通话位置”的事件
2.  BGService 检查前台应用程序是“联系人”还是“消息传递”
3.  如果是，BGService 会检查是否有任何打开的短信或联系人
4.  如果有一个打开的（聚焦的）联系人或短信线程，BgService 会为该联系人（或短信的发件人）启动呼叫。

这是我要实现的核心思想，这是否可能，或者应用程序和事件之间的这种集成是可能的，因为它们都捆绑在一个框架中（在这种情况下是 Touchwizz）？

如果可能的话，欢迎任何提示。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T04:50:28.413

> 1.BGService拦截事件“说”手机处于“通话位置”

您可以使用[TelephonyManager API](http://developer.android.com/reference/android/telephony/TelephonyManager.html)来确定电话状态

> 2.BGService 检查前台应用是“Contacts”还是“Messaging”

您可以使用[ActivityManager API](http://developer.android.com/reference/android/app/ActivityManager.html)来确定前台应用程序。有关示例，请参见以下帖子： [从后台任务或服务确定当前前台应用程序](https://stackoverflow.com/questions/2166961/determining-the-current-foreground-application-from-a-background-task-or-service)

> 3.如果是，BGService检查是否有打开的短信或联系方式

这我不知道它是否可以做到。您需要一种方法来查询 SMS 或联系人应用程序以找出视图中的焦点。SmsManager [API](http://developer.android.com/reference/android/telephony/SmsManager.html)仅提供发送 SMS 的方法。

> 4.如果有一个打开的（聚焦的）联系人或短信线程，BgService 会为该联系人（或短信的发送者）启动呼叫。

与＃3相同的答案。

或者，如果您只对 SMS 和联系人应用程序中的内容更改感兴趣，您可以使用[ContentObserver API](http://developer.android.com/reference/android/database/ContentObserver.html)做一些事情。

另请查看[ContentProviders](http://developer.android.com/guide/topics/providers/content-providers.html)的 API 文档和[Content Provider Basics](http://developer.android.com/guide/topics/providers/content-provider-basics.html)文档。

# objective-c - 将离散数据转换为连续数据

> ID：11509468
> 
> 赞同：0
> 
> 时间：2012-07-16T17:32:05.223
> 
> 标签：objective-c, ios, nsarray

我正在编写一个程序，作为一个方面，波过滤/解析程序。我收集的数据越多，存储到设备中的文件就越大。我以离散的时间步长收集数据，为了准确起见，我经常这样做。但是，我注意到整体波形趋于足够宽，以至于我可以以大约一半的速率收集数据，并且仍然能够在数据上绘制出足够准确的波形。

所以问题是：有没有办法从这些数据中创建曲线的连续数学描述？我什么都没找到。我的数据包含`float`在`NSNumbers`一个`NSArray`.

我想做的两件事是获取阈值的交点并找到局部最大值。执行其中任何一项的能力就足够了。

**-编辑-**

如果有人知道用于一维实数数组的良好 Objective-c FFT 方法，我很想听听。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:02:20.937

Apple 在 Accelerate 框架中包含 FFT。

[使用傅里叶变换](http://developer.apple.com/library/ios/documentation/Performance/Conceptual/vDSP_Programming_Guide/UsingFourierTransforms/UsingFourierTransforms.html#//apple_ref/doc/uid/TP40005147-CH202-SW1)

示例：[FFT 示例](http://developer.apple.com/library/ios/documentation/Performance/Conceptual/vDSP_Programming_Guide/SampleCode/SampleCode.html#//apple_ref/doc/uid/TP40005147-CH205-45465)

另外：[使用 Apple FFT 和 Accelerate 框架](https://stackoverflow.com/questions/3398753/using-the-apple-fft-and-accelerate-framework)

# mysql - 怎么做点，协助领导在Mysql

> ID：11509471
> 
> 赞同：2
> 
> 时间：2012-07-16T17:32:20.587
> 
> 标签：mysql

我有 'stats' 表和 'id'、'playername'、'point'、'asist' 列。我想制作像这张图片的表。

![在此处输入图像描述](../Images/5302c6b382dfdf2f1accbe87098af013.png)

例子：
![在此处输入图像描述](../Images/0e6c2e4c4c0449ce0ed3235fbf9ce35e.png)

我怎么能只用 1 个查询来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:59:32.100

您可以为此使用`UNION ALL`运算符

```
SELECT 'Points','Leaders' UNION ALL
SELECT Playername,point order by point desc UNION ALL
SELECT 'AsIst','Leaders' UNION ALL
SELECT Playername,asist order by asist desc 
```

希望这可以帮助。

# codeigniter - 授权对 CodeIgniter 应用程序的 webhook 调用？

> ID：11509472
> 
> 赞同：0
> 
> 时间：2012-07-16T17:32:31.547
> 
> 标签：codeigniter, authorization, webhooks

外部 CRM webhook 偶尔会调用我的 CI 应用程序来通知我数据更改，以便我可以更新 CI 应用程序的缓存。确保对我的应用程序的调用来自授权来源的最佳方法是什么？

我查看了 Tank Auth 和 Ion Auth 之类的选项，但对于我正在尝试做的事情来说，它们似乎有点矫枉过正？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:49:02.113

你可能最好把它留给网络服务器，比如添加 http auth 或 ip 限制。但是，如果您想在 CI 中执行此操作，您也可以检查请求的主机/域或 IP 地址。

# java - 在 Java 中将“\\”替换为“/”

> ID：11509476
> 
> 赞同：2
> 
> 时间：2012-07-16T17:32:42.810
> 
> 标签：java, android, replace

我正在尝试`'\\'`用`'/'`java(Android) 替换，但这似乎不起作用！

```
String rawPath = filePath.replace("\\\\", "/"); 
```

这有什么问题？我已经转义“\”并尝试转义“/”但没有用。原始字符串没有任何反应。

```
 filePath = abc\\xyz(not after escaping two \\, the original string is with two \\)
    rawPath = abc \ xyz
    expected = abc/xyz 
```

这样做的正确方法是什么？（另一个 Windows 文件到 Android 路径转换问题）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T17:35:35.540

使用`String.replace(String, String)`反斜杠时不需要转义两次（即使用时`replaceAll`- 它处理正则表达式）。所以：

```
String rawPath = filePath.replace("\\", "/"); 
```

或使用`char`版本：

```
String rawPath = filePath.replace('\\', '/'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T17:34:37.087

你不需要四重转义，

> \\\\

, 只是简单

> \\

.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-16T17:35:12.513

用单斜杠转义就足够了。以下对我来说很好。

`String rawPath = filePath.replace("\\", "/");`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-16T17:39:31.643

```
public static void main(String[] args) {
    String s = "foo\\\\bar";
    System.out.println(s);
    System.out.println(s.replace("\\\\", "/"));     
} 
```

将打印

```
foo\\bar
foo/bar 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-16T17:39:03.087

如果您想用单个正斜杠替换原始字符串中的 2 个反斜杠序列，则应该可以：

```
String filePath = "abc\\\\xyz";
String rawPath = filePath.replace("\\\\", "/");

System.out.println(filePath);
System.out.println(rawPath); 
```

输出：

```
abc\\xyz  
abc/xyz 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-17T02:36:42.003

首先，您真的在 String 中有两个反斜杠吗？这只出现在 Java 源代码中。在运行时只有一个反斜杠。因此，任务减少到将反斜杠更改为正斜杠（为什么？）。如果您使用`replaceAll()`，则需要一个正则表达式，这将需要其中四个：两个用于编译器，两个用于正则表达式，但您没有使用它，您正在使用`replace()`，这不是正则表达式，所以您只需要两个，一个用于编译器，一个用于自身。

你为什么做这个？根本不需要在 Java 的文件路径中使用反斜杠，也不需要将它们转换为 / 除非你正在用它们做类似 URL 的事情，在这种情况下有`File.toURI()`方法和 URI 和 URL 类为了那个原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-19T06:11:25.503

这是获取桌面路径的一个非常小的方法，并向您展示如何在 return 语句中替换它们。

```
 public static String getDesktopPath() {

      String desktopPath = System.getProperty("user.home") + "/Desktop";
      return desktopPath.replace("\\", "/");

} 
```

# excel - 如果区域中只有一个单元格有值，如何将单元格区域中的值复制到另一个单元格？

> ID：11509478
> 
> 赞同：0
> 
> 时间：2012-07-16T17:32:53.537
> 
> 标签：excel, formula

我在 Excel 电子表格中有 40 列和数百行。

```
Range C6:AQ6, C7:AQ7, C8:AQ8, and so on

CASE 1: Only one cell in the range D6:AQ6 usually contains a value. 
CASE 2: In some rare cases, more than one cell OR no cells contain a value in this range. 
```

这是我想要完成的事情：

```
If CASE 1: Populate the cell C6 with the value in the only cell in the range D6:AQ6.
If CASE 2: Leave C6 blank 
```

如何使用 Excel 公式执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:55:56.700

在单元格 C6 中输入此公式：

```
=IF(COUNTA(D6:AQ6)=1,INDEX(D6:AQ6,Match("*",D6:AQ6,0)),"") 
```

这个怎么运作：

*   计算“D6：AQ6”范围内有多少个单元格不为空。
    *   如果只有 1 个包含数据的单元格（案例 1）
        *   然后使用索引返回值
            *   索引的工作原理是将单元格 X 的值返回到右侧，其中 X 是 Match 找到的第一列，其中包含任何内容
    *   如果没有1（超过1或0，Case2）
        *   然后将单元格设置为空白

# macos - 按下向上箭头后，Mac OS X 终端命令卡住

> ID：11509479
> 
> 赞同：2
> 
> 时间：2012-07-16T17:32:57.607
> 
> 标签：macos, terminal

在我的 mac 终端中，按下几次以查看我以前的命令后，一个命令卡在终端中。它是这样的，

普通的：

```
[ 10:23:34 ] > MY_COMMAND 
```

几次按下后

```
[ 10:23:34 ] > git commit -mMY_COMMAND
[ 10:23:35 ] > git commit -mMY_COMMAND
[ 10:23:36 ] > git commit -mMY_COMMAND 
```

`git commit -m`只是卡在那里，直到我在终端中输入“清除” 。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-12-16T13:04:50.800

最可能的原因是格式不正确的`PS1`提示字符串。当您将非打印控制字符放在提示符中时，您必须将它们括起来`\[ … \]`以告诉 Bash 在计算提示符宽度时不要计算它们。

如果宽度计算不正确，命令行显示可能会以多种方式混乱，包括您描述的方式。

你在评论中写道：

> 这是我的 .bash_profile export PATH=${PATH}:/Users/offirgolan/android-sdk-macosx/platform-tools export TERM="xterm-color" alias ls="ls -G" export PS1="\e[ 1;30m][\e[\e[1;30m]\e[1;33m] \u@\H [\e[1;32m]\w[\e[0m] \e[1;30m] ]\n[[ \e[1;31m]\T[\e[0m]\e[1;30m] ] > \e[37m]"

看起来您可能打算包含括号，因为所有额外的括号都没有前导反斜杠，但它们不一致，您的字符串甚至包含不完整的转义序列，例如`\e[\e[`. 很难说出您打算在提示中显示哪些括号（如果有的话），以及您想要它们的颜色，但您`PS1`应该更像

```
PS1='\[\e[1;30m\][\[\e[1;30m\e[1;33m\] \u@\H [\[\e[1;32m\] \w\[\e[0m \e[1;30m\]]\n[ \[\e[1;31m\]\T\[\e[0m\e[1;30m\] ] > \[\e[37m\]' 
```

**专业提示：**不要在提示符中对终端命令进行硬编码——它们不可移植，并且不适用于所有终端。相反，使用`tput`为当前终端选择适当的命令序列。例如

```
PS1="\[$(tput setaf 1)\]Red Text\[$(tput sgr0)\] \$ " 
```

将显示提示“Red Text $”，其中“Red Text”为红色。这也使查看`\[ \]`括号是否正确变得更加容易，因为您没有乱扔字符串的文字转义字符，并且助记符`tput`可以更容易地找出正在发送的命令。

# objective-c - iOS：UIPickerView 默认尺寸

> ID：11509482
> 
> 赞同：1
> 
> 时间：2012-07-16T17:33:13.840
> 
> 标签：objective-c, ios, uipickerview

我想知道内部选择器部分两侧的深灰色框架的宽度以及组件之间分隔符的宽度。这将是默认设置（例如，.xib 中显示的内容）。或者，如何以编程方式找到这些值。谢谢

为了澄清，我正在寻找这些值的“建议最小值”可能是什么。我将我的 UIPickerView 放在一个弹出窗口中，并且 UIPickerView 的宽度超过 320 像素（这是 .xib 作为“默认值”给出的）。我想知道这些值，以便我可以将它们添加到弹出框的宽度，以确保它不会切断 UIPickerView 右侧的组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:44:34.140

好吧，这可能有点棘手，因为 Picker 可以有动态数量的组件。因此，为了找到宽度，您必须考虑组件的数量。这可以这样做：

```
 NSInteger n = picker.numberOfComponents;        

        const CGFloat separatorWidth = 8.0f;
        const CGFloat sectionExceedWidth = -2.0f;
        CGFloat totalWidth = picker.bounds.size.width;
        CGFloat panesWidth = totalWidth - separatorWidth * (n - 1);
        for (NSInteger i = 0; i < n; i++) {
            CGFloat sectionWidth = [picker rowSizeForComponent:i].width + sectionExceedWidth;
            panesWidth -= sectionWidth;
        }
        CGFloat leftPaneWidth = ceilf(panesWidth * 0.5f);
        CGFloat rightPaneWidth = panesWidth - leftPaneWidth;
        CGFloat totalHeight = picker.bounds.size.height;
        CGRect totalRect = CGRectMake(0, 0, totalWidth, totalHeight); 
```

找到左右窗格宽度并且分隔符大小是静态的。

这是从[这里](https://github.com/Inexika/Inexika-Custom-Controls)拉出来的。

# ajax - Rails - button_to 和提交

> ID：11509484
> 
> 赞同：0
> 
> 时间：2012-07-16T17:33:14.550
> 
> 标签：ajax, ruby-on-rails-3

在我的 Rails 3.2.3 应用程序中，我使用 Ajax 和 jQuery。页面上有一个按钮。通过单击此按钮，它必须被禁用，必须出现一个微调器并开始一个 ajax 请求。只有当我不禁用按钮时它才有效。如果我禁用它，则不会运行 ajax 请求。

所以我需要做的是能够同时发送一个 ajax 请求、显示一个微调器并禁用一个按钮。

```
 <script>
    $(document).ready( function() {
         $("#lnk_more").click(function() {
            //if I uncomment this then an ajax request won't be be sent
            // $("#lnk_more").attr('disabled','disabled'); 
            $("#spinner").show(); 
         });
    </script>

    <%= button_to "More", {:controller => 'home', :action => "test_method", :page=>@current_page }, {:remote => true,:id => 'lnk_more', :method => :get} %>

<%= image_tag('ajax-loader.gif',:style => 'display:none', :id => 'spinner') %>

#result html
<form action="/home/test_method?page=1" class="button_to" data-remote="true" method="get"><div> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:23:05.963

检查[button_to](http://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to)文档。在最后一个示例中，您将找到一个带有 :disable_with 参数的示例，您可以在提交后使用它来禁用按钮。

# c# - 如何在 C# windows 应用程序中锁定文本框（防止用户输入任何内容）（不禁用它或使其不可见）

> ID：11509487
> 
> 赞同：1
> 
> 时间：2012-07-16T17:33:19.510
> 
> 标签：c#, windows-applications

:) 我正在制作一个 C# 打字程序，我希望用户在输入错误的字母时无法输入任何内容，（我希望打字光标冻结在其位置）并且当他按下退格键时，只有这样他才能继续他的打字。

我通过操作 ConsoleScreenCursorCoordinates 在 C++ 中完成了这个程序，我尝试通过操作 textBox.Location 在 C# 中做同样的事情，但它没有用。

在我的程序中，有 2 个文本框，sourceTextBox 和 TypingTextBox 还有一个名为“文本”的字符串变量，它将通过 StreamReader 从文本文件中读取，然后我使用这个文本变量将其中的每个元素与用户的内容进行比较在打字。

我厌倦了这个：

```
bool madeMistake = false;
Point CurrentTypingPosition;
string whatIsWrittenBeforeTheMistake = "";

private void TypingTextBox_KeyPress(object sender, KeyPressEventArgs e)
{
     try
     {
       if (!madeMistake)
       {
           if (e.KeyChar == text[typingIndex])
           {
               typingIndex++;
           }
           else if (e.KeyChar == backspace)
           {
               typingIndex--;
           }
           else
           {
               CurrentTypingPosition = TypingTextBox.Location;
               madeMistake = true;
               TypingTextBox.Text += " ";
               TypingTextBox.Location = CurrentTypingPosition;
               whatIsWrittenBeforeTheMistake = TypingTextBox.Text;
           }
       }
       else
       {

           if (e.KeyChar == backspace)
               madeMistake = false;
           else
           {
               TypingTextBox.Text = whatIsWrittenBeforeTheMistake;
               TypingTextBox.Location = CurrentTypingPosition;
           }
        }
     }
     catch (Exception ex)
     {
       MessageBox.Show(ex.Message);
     }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:47:16.500

另一种更强大的解决方法是创建一个自定义 TextBox，继承自 TextBox 本身。然后，您将能够处理 KeyDown (PreviewKeyDown) 事件等，并在每次击键时确定是否有问题。如果无效，您可以将 KeyEventArgs (e.Handled) 设置为 true，并阻止进一步的用户输入（除了退格，您可以检查）。

这避免了必须挂钩文本框事件，如果使用 MVVM，这是可取的。如果您需要非常精细的控制，您可以使用此方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:52:49.883

另一个变体是使用事件 args 的`Handled`属性`KeyPress`，所以你会得到类似的东西：

```
void textBox1_KeyPress(object sender, KeyPressEventArgs e)
{

    if (Char.IsControl(e.KeyChar))
    {
        e.Handled = false;
        return;
    }

    char expectedNext = expected[textBox1.SelectionStart];

    if (expectedNext != e.KeyChar)
    {
        e.Handled = true;
        Console.WriteLine("Incorrect input");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:39:13.013

这对你有用吗？

```
 private void TypingTextBox_KeyPress(object sender, KeyPressEventArgs e)
    {
        ...
        if (madeMistake)
            TypingTextBox.ReadOnly = true;
        ...
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:12:04.493

您将不得不调整它以使用您的 StreamReader 对象代替我在这里使用的字符数组，但这会起作用，但不需要它们必须退格。

```
 private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
    {            
        char[] charArr = { 'a', 'b', 'c' };  //spec out what is acceptable here

        foreach (char c in charArr)
        {
            if (e.KeyChar.CompareTo(c) > 0)
            {
                e.Handled = true;                    
            }
            else
            {
                e.Handled = false;
            }
        }
    } 
```

# php - 动态 PHP 图像

> ID：11509488
> 
> 赞同：1
> 
> 时间：2012-07-16T17:33:22.977
> 
> 标签：php, html, image, dynamic

我正在查看有关在 PHP 中修改/打包图像的帖子，但似乎找不到任何东西。我想要做的是有一个图像模板，我可以通过 $_GETting 一个变量来修改它。

例如： http: [//foo.bar/image.php?content=Monday](http://foo.bar/image.php?content=Monday)

如果我们将以上内容包装在标签中，它将显示为“您已被邀请参加星期一的聚会！” （大意的东西）

基本上：

*   设置模板
*   在所述模板上更改了一两个单词
*   自动调整大小以适应页面

如果有人可以提供指向执行此操作的库的链接或提供代码示例，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:36:11.033

您可以使用 Cairo、ImageMagick 或 GD 在 PHP 中生成图像。PHP 网站上有大量文档：[http ://www.php.net/manual/en/refs.utilspec.image.php](http://www.php.net/manual/en/refs.utilspec.image.php)

请注意，并非每个系统都可以使用每个 API/函数库。我记得几年前 ImageMagick 和 GD 很难在非 Linux 系统上工作。不过不知道今天怎么样了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:36:52.540

可能想从 PHP.net -> [http://us3.php.net/manual/en/image.examples-png.php获取此页面](http://us3.php.net/manual/en/image.examples-png.php)

# .net - OpenFileDialog：文件名和安全文件名之间的区别

> ID：11509494
> 
> 赞同：5
> 
> 时间：2012-07-16T17:34:02.317
> 
> 标签：.net, openfiledialog

对于[OpenFileDialog](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.aspx)，[SafeFileNames](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.safefilenames.aspx)和[FileNames](http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.filenames.aspx)
有什么区别？

为什么`SafeFileNames`是`safe`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T17:39:13.687

The answer is right there on the pages you linked. The "safe" filename doesn't include the path. Just the filename and the extension. The regular filename includes the full path.

The SafeFileName is safe because it doesn't expose the directory structure of your computer.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T17:41:31.060

The main difference is that `FileNames` requires `FileIOPermissionAccess.AllAccess` security permissions, since it's returning path information about the system into the process. A user running with very low trust permission sets will trigger security exceptions if you try to access `FileNames`, as the path information is not available.

With `SafeFileNames`, the property "should be accessible to code running with limited trust." It's "safe" in terms of being able to be used with limited rights.

# php - PHP -- 在主题行中获取时间

> ID：11509497
> 
> 赞同：2
> 
> 时间：2012-07-16T17:34:15.567
> 
> 标签：php, email

我正在通过 Second Life 将数据获取到 PHP 脚本，而 PHP 脚本正在通过电子邮件发送数据。

我的问题是如何将时间（即变量 $time）放入电子邮件的主题行。现在，它只是忽略了变量 $time。

这是我的代码的那一部分：

```
$time = $_POST["time"];
$log = $_POST["log"];

$to = "OSU@gmail.com";
$subject =  <<<TEST
New Visitor; VDC2; $time
TEST;

$theMes =  <<<TEST
Visitor Log for VDC2:
$log
TEST;

$headers = 'From: TecEdgeDL@gmail.com' . "\r\n" .
'Message-Id: TecEdgeDL@gmail.com' . "\r\n" .
'Reply-To: TecEdgeDL@gmail.com' . "\r\n" .
'X-Mailer: PHP/' . phpversion();

mail($to, $subject, $theMes, $headers); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:39:56.300

你为什么不这样写 $subject 变量呢？

```
$subject = "New Visitor; VDC2; " . $time; 
```

当你这样做的时候，像这样写 $theMes ：

```
$theMes = "Visitor Log for VDC2:" . "\n\n" . 
   $log; 
```

* * *

如果这不起作用，请尝试对内容进行编码。我仍然不知道为什么它不会显示，但这可能值得一试，因为邮件确实编码。

```
$subject = "New Visitor; VDC2; " . $time;
$subject = '=?UTF-8?B?'.base64_encode($subject).'?='; 
```

分号或时间戳可能会使 PHP 感到困惑。

# android - eclipse 仅在 Galaxy nexus 的 logcat 中不显示时间？

> ID：11509498
> 
> 赞同：3
> 
> 时间：2012-07-16T17:34:22.037
> 
> 标签：android, eclipse, android-logcat, nexus-s

我正在将 Galaxy nexus 与 Jelly bean 一起使用，我注意到 logcat 不显示时间。我还注意到它没有为 Galaxy Nexus 应用过滤器。它也没有以红色显示异常。

```
?:??: W/?(?): [ 07-16 10:31:42.153   462:  462 D/PhoneStatusBar ]
?:??: W/?(?): disable: < expand icons alerts ticker system_info back home RECENT* clock >
?:??: W/?(?): [ 07-16 10:31:42.231   309:  341 V/LockPatternKeyguardView ]
?:??: W/?(?): Set visibility on com.android.internal.policy.impl.LockPatternKeyguardView$4@42bb3168 to 8388608
?:??: W/?(?): [ 07-16 10:31:42.231   462:  462 D/PhoneStatusBar ]
?:??: W/?(?): disable: < expand icons alerts ticker system_info BACK* HOME* RECENT CLOCK* >
?:??: W/?(?): [ 07-16 10:31:42.270   309:  311 D/dalvikvm ]
?:??: W/?(?): GC_CONCURRENT freed 521K, 17% free 25327K/30343K, paused 14ms+13ms, total 152ms
?:??: W/?(?): [ 07-16 10:31:42.302   309:  341 V/LockPatternKeyguardView ]
?:??: W/?(?): Set visibility on com.android.internal.policy.impl.LockPatternKeyguardView$4@42bb3168 to 8388608 
```

这使得调试非常困难。请帮我 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T20:18:51.897

我想到了 。我更新了我的 ADT 版本，因为我没有果冻豆。主要是你也需要更新你的 sdk 工具。看看这个问题

[调试问题 (Android Eclipse)](https://stackoverflow.com/questions/11439821/debugging-issues-android-eclipse)

# replace - Gimp Script Fu 中的字符串替换

> ID：11509500
> 
> 赞同：5
> 
> 时间：2012-07-16T17:34:31.180
> 
> 标签：replace, str-replace, gimp, script-fu

我有一个重命名文件的 Gimp 插件，我需要一个替换功能。不幸的是，Gimp 使用的 TinyScheme 没有字符串的替换功能。我搜索了很多，但找不到一个真正的字符串替换。回复关注...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T15:54:26.200

这是我创建的实现。如果有更好的解决方案，请随时告诉我。

```
(define (string-replace strIn strReplace strReplaceWith)
    (let*
        (
            (curIndex 0)
            (replaceLen (string-length strReplace))
            (replaceWithLen (string-length strReplaceWith))
            (inLen (string-length strIn))
            (result strIn)
        )
        ;loop through the main string searching for the substring
        (while (<= (+ curIndex replaceLen) inLen)
            ;check to see if the substring is a match
            (if (substring-equal? strReplace result curIndex (+ curIndex replaceLen))
                (begin
                    ;create the result string
                    (set! result (string-append (substring result 0 curIndex) strReplaceWith (substring result (+ curIndex replaceLen) inLen)))
                    ;now set the current index to the end of the replacement. it will get incremented below so take 1 away so we don't miss anything
                    (set! curIndex (-(+ curIndex replaceWithLen) 1))
                    ;set new length for inLen so we can accurately grab what we need
                    (set! inLen (string-length result))
                )
            )
            (set! curIndex (+ curIndex 1))
        )
       (string-append result "")
    )
) 
```

# javascript - 谷歌驱动 API Dredit Jplayer

> ID：11509504
> 
> 赞同：0
> 
> 时间：2012-07-16T17:34:44.377
> 
> 标签：javascript, google-drive-api, jplayer

我正在尝试从 Dredit（示例驱动器应用程序）开始开发一个应用程序，该应用程序可用于使用 Jplayer 从谷歌驱动器上播放音乐。我在 index.jsp 上安装了 Jplayer，但我不知道如何与之交互，或者我需要在哪里更改代码。我知道在某些时候代码正在使用 Java Script ace 文本阅读器来读取文件。相反，我想使用 Jplayer Javscript。我也从未使用 Java Servlet 或 Java 代码与 Java Script 文件进行交互。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T22:58:28.883

只是一些指针：

您需要将文件的 downloadURL（它位于您从 API 获得的文件元数据中）传递给 Jplayer。例如，您可以简单地在呈现的 HTML 上编写或使用一些 AJAX 回调。

您还需要传递 OAuth 2.0 访问令牌，以便您可以授权对文件的请求，例如，您将使用 Jplayer 读取位于以下位置的音频文件：

downloadUrl + '&access_token=' + accessToken

# iis - 我的网络上的用户如何浏览到我机器上的特定命名站点？

> ID：11509515
> 
> 赞同：0
> 
> 时间：2012-07-16T17:35:25.527
> 
> 标签：iis, windows-7, iis-7

我在本地机器上托管了 2 个正在开发的站点。它们是通过工作中的脚本配置的。我觉得我的 IIS 知识存在差距，因为我不知道不在我本地主机上的人如何访问特定站点。我的绑定看起来像：

```
AlphaSite
  http   siteAlpha  80   * 
  https  siteAlpha  443  *

BetaSite
  http   siteBeta   80   * 
  https  siteBeta   443  * 
```

等等。另一台机器上的用户可以浏览将`http://myMachine/theSite/default`它们发送到的位置`AlphaSite`。我可以通过转到 Beta 站点进行浏览`http://siteBeta/default`。不在我机器上的人怎么能找到`siteBeta`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T13:56:32.920

您可以尝试将 betaSite 的端口更改为其他端口，例如：8080。然后您将拥有

*   “http://myMachine/siteAlpha/default”
*   “http://myMachine:8080/siteBeta/default”

# machine-learning - kmeans是否需要三角不等式？

> ID：11509516
> 
> 赞同：4
> 
> 时间：2012-07-16T17:35:27.887
> 
> 标签：machine-learning, cluster-analysis, distance, data-mining, k-means

我想知道kmeans中使用的距离度量是否需要三角不等式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:46:50.980

好吧，经典的 kmeans 是在具有 L2 距离的欧几里得空间上定义的，所以你会自动得到三角不等式（三角不等式是定义距离/度量的一部分）。如果您使用的是非欧几里德度量，则需要定义“均值”的含义等。

如果你没有三角不等式，这意味着两点可能相距很远，但都可能靠近第三点。您需要考虑如何解释这个案例。

说了这么多，我过去曾使用平均链接层次聚类和距离度量，但不能满足三角不等式等要求，它非常适合我的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T05:37:43.247

k-means 是为**欧几里得距离***设计*的，恰好满足三角不等式。

 ****使用其他距离函数是有风险的，因为它可能会停止收敛**。然而，原因*不是*三角不等式，而是**平均值可能不会最小化距离函数**。（算术平均值最小化平方和，而不是任意距离！）

有更快的 k-means 方法利用三角不等式来避免重新计算。但是如果你坚持经典的 MacQueen 或 Lloyd k-means，那么你就*不需要*三角不等式。

请注意使用其他距离函数，以免陷入无限循环。您需要**证明均值可以最小化您**到聚类中心的距离。如果你不能证明这一点，它可能无法收敛，因为目标函数不再单调递减！所以你真的应该**尝试证明你的距离函数的收敛性**！**

# ios - 我的 UIButtons 有很大的延迟？

> ID：11509519
> 
> 赞同：1
> 
> 时间：2012-07-16T17:35:39.327
> 
> 标签：ios, xcode, uiscrollview, lag

我有一个游戏，有 48 个按钮，我有一个 6 x 8 的网格。这些游戏在布局上有点像国际象棋游戏，所以拥有所有这些按钮很重要。好吧，如果您可以想象一个布局如此之大的国际象棋游戏，我可能需要一个垂直滚动视图，以便用户可以上下滚动以完全玩游戏。而且，当我滚动时，我显然不希望顶部的导航按钮也滚动（例如菜单按钮）。所以，我所做的是我做了一个视图控制器，我添加了一个 UIView，然后在 UIView 中我添加了一个滚动视图，在那个滚动视图中，我首先为我的象棋游戏添加了所有 48 个按钮，然后是我的 bg那个游戏，所以当用户垂直滚动时，不仅bg会滚动，所有按钮也会滚动。我做了所有的代码和一切来使我的滚动视图工作，

* * *

好吧，在我这样做之后，我的滚动工作正常，除了当我试图按下我的 48 个按钮中的一个时出现延迟。这是我在将所有按钮放入滚动视图之前没有经历过的延迟。在此之前，我的按钮表现出色，但现在它们处于滚动视图中，它们有点滞后。就像当您触摸按钮时，按钮需要大约五分之一秒才能改变，而不是瞬间改变。它的滞后很小，但绝对引人注目。然而，当我尝试触摸我的导航按钮（未嵌入滚动视图中）时，根本没有延迟，

我把按钮放在滚动视图中做错了吗？如果是这样，我还能做些什么来让我的按钮滚动而不滚动导航按钮。

任何帮助表示赞赏！

编辑：如果有什么不同，我会在模拟器上运行它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:57:40.397

我相信这与[响应者](http://developer.apple.com/library/ios/#DOCUMENTATION/EventHandling/Conceptual/EventHandlingiPhoneOS/MultitouchEvents/MultitouchEvents.html#//apple_ref/doc/uid/TP40009541-CH3-SW1)有关，并且您的 UIButton 和 UIScrollView 都需要知道如何处理您的触摸。

如果您将手指放在 UIButton 上，UIScrollView 也会看到这种触摸。UIScrollView 有兴趣知道此触摸是否会变成拖动，因此等待查看您是否移动手指。也许这会阻止您的 UIButton 触发。

# java - 泛型不会从“this”自动推断类型？

> ID：11509521
> 
> 赞同：4
> 
> 时间：2012-07-16T17:35:47.100
> 
> 标签：java, generics, jackson

（这是与`Java 7`）

我试图在我的基类中放置一些 JSON 字符串生成方法，而不是在所有子类中使用几乎相同的代码。我尝试的第一个天真的事情是：

```
public abstract class Base
{
    [rest of class...]

    final public <T extends Base> String toJsonString() throws IOException {
        JacksonRepresentation<T> rep =
             new JacksonRepresentation<>(MediaType.APPLICATION_JSON, this);
        return rep.getText();
    }    
} 
```

但这不会编译，给出错误：

```
error: incompatible types
required: JacksonRepresentation<T>
found:    JacksonRepresentation<Base>
where T is a type-variable:
T extends Base declared in method <T>toJsonString() 
```

所以我尝试了这个：

```
public abstract class Base
{
    [rest of class...]

    final public String toJsonString() throws IOException {
        return jsonStringHelper(this);
    }

    private static <T extends Base> String jsonStringHelper(T object)
        throws IOException {
        JacksonRepresentation<T> rep =
             new JacksonRepresentation<>(MediaType.APPLICATION_JSON, object);
        return rep.getText();
    }
} 
```

效果很好。这是为什么？为什么编译器不能/没有意识到 of`this`的类型是满足`T extends Base`并进行必要解析的类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T17:40:10.163

Because you can have Class1 and Class2 that both extend base, and someone could do this:

```
Class1 class1 = new Class1();

String result = class1.<Class2>jsonStringHelper(); 
```

So while it is guaranteed that 'this' is a subclass of Base, there is no guarantee that 'this' is an instance of T.

# iphone - iPhone将旋转锁定为纵向视图

> ID：11509522
> 
> 赞同：0
> 
> 时间：2012-07-16T17:35:59.727
> 
> 标签：iphone, rotation

我知道之前有人问过这个问题，我实际上搜索了这些问题以确保我做的事情正确。我的应用需要保持纵向，所以我想禁止它旋转成横向。

在总结中，我只支持纵向和倒置的设备方向。在视图控制器中，我有：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
```

{返回否；}

我有 6 个其他视图控制器，在每个视图控制器中我都有以下内容：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
return (interfaceOrientation == UIInterfaceOrientationPortrait);
} 
```

但是当我在我配置的 iPhone 上测试应用程序时，它会旋转。呸呸呸。我究竟做错了什么？

谢谢

在模拟器中也是一样的。

# jquery - 从 JQuery 调用 web api 的问题

> ID：11509525
> 
> 赞同：0
> 
> 时间：2012-07-16T17:36:06.560
> 
> 标签：jquery, knockout.js, asp.net-web-api, knockout-mapping-plugin

我在使用来自 JQuery 的 JSon 数据时遇到了一些问题。

```
 $(function () {
           $.getJSON("/api/Movies", function (data) {
        // ko.mapping.fromJS(data, viewModel);
    }); 
```

这段代码抛出异常。

Microsoft JScript 运行时错误：无法获取属性“上下文”的值：对象为空或未定义

我已经从提琴手测试了 WebAPI，它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:42:40.717

Because you did not close the parens:

```
 $(function () {
    $.getJSON("/api/Movies", function (data) {
        // ko.mapping.fromJS(data, viewModel);
    });
 }); 
```

Also you did not define `viewModel`

# iphone - 精灵没有正确旋转（cocos2d）

> ID：11509526
> 
> 赞同：1
> 
> 时间：2012-07-16T17:36:07.933
> 
> 标签：iphone, cocos2d-iphone, rotation, sprite

我在坦克底座顶部有一个炮塔，两者都在同一个精灵表内，并正确指定了框架。当我构建和运行项目时，我希望炮塔沿着坦克中心的锚点旋转。炮塔是坦克的一个孩子，因此它们在移动时会保持在一起。但是，当我尝试旋转它时，炮塔似乎将其锚点设置在远处的某个地方，如下所示：![在此处输入图像描述](../Images/c1ae1f106b5ce5f240868aea89a711ce.png)![在此处输入图像描述](../Images/911005b3863c988593ee6bfcbd4602a8.png)

这是我的初始化：

```
- (id)initWithLayer:(HelloWorldLayer *)layer type:(int)type hp:(int)hp {

NSString *spriteFrameName = [NSString stringWithFormat:@"tank%d_base.png", type];    
if ((self = [super initWithSpriteFrameName:spriteFrameName])) {
    _layer = layer;
    _type = type;
    self.hp = hp;
    _turret = [CCSprite spriteWithSpriteFrameName:[NSString stringWithFormat:@"tank%d_turret.png", type]];
    _turret.anchorPoint = ccp(0.5, 0.25);
    [self scheduleUpdateWithPriority:-1];
    [self addChild:_turret];
     _turret.position = ccp(40, 50);
}

return self;
} 
```

我在这里旋转精灵（我使用 360 度拍摄范围）

```
- (void)shootToward:(CGPoint)targetPosition {

//CGPoint offset = ccpSub(targetPosition, self.position);
float x = abs(targetPosition.x) - self.position.x;
float y = abs(targetPosition.y) - self.position.y;
float angle;
float angleDegrees;
if (x < 0 && y > 0) {
    angle = atanf(y/x);
    angleDegrees = -CC_RADIANS_TO_DEGREES(angle) - 90;
}
else if (x < 0 && y < 0) {
    angle = atanf(y/x);
    angleDegrees = -CC_RADIANS_TO_DEGREES(angle) - 90;
}
else if (x > 0 && y < 0) {
    angle = atanf(y/x);
    angleDegrees = 90 - CC_RADIANS_TO_DEGREES(angle);
}
else if(x > 0 && y > 0) {
    angle = atanf(y/x);
    angleDegrees = 90 - CC_RADIANS_TO_DEGREES(angle);
}
switch (_layer.rotateInt) {
    case 0:
        angleDegrees = angleDegrees;
        break;
    case 1:
        angleDegrees = angleDegrees+ 180;
        break;
    case 2:
        angleDegrees = angleDegrees;
        break;
    case 3:
        angleDegrees = angleDegrees + 90;
        break;
    case 4:
        angleDegrees = angleDegrees - 90;
        break;
    default:
        break;
}

NSLog(@"%f",angleDegrees);
_turret.rotation = angleDegrees; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:40:31.417

Since the turret is a child of the tank, this:

```
 _turret.position = ccp(40, 50); 
```

offsets the turret by 40x50 away from the tank's origin (lower left corner of bounding box). Try settings the position so the turret is centered on the tank:

```
 _turret.position = ccp(tank.contentSize.width * tank.anchorPoint.x,
                        tank.contentSize.height * tank.anchorPoint.y); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:39:40.590

Hmm. The only thing that I think could be causing this is that the turret asset is not centered or has a lot of blank space. That said, I'd try playing with the anchor point of the turret.

# iphone - Xcode：如何在朋友的手机上获取我的应用程序？

> ID：11509528
> 
> 赞同：0
> 
> 时间：2012-07-16T17:36:11.480
> 
> 标签：iphone, xcode

我为我的 iPhone 制作了一个应用程序。我想让我的朋友也看到这个应用程序。通过在 Xcode 中选择我的 iphone 并单击“运行”，我一直在将应用程序加载到我的手机上。我不能让他这样做，因为他在另一个州。无论如何我可以设置它以便他可以将其加载到手机上吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:44:09.580

查看[TestFlight](https://testflightapp.com/)。您必须将他的设备添加到您的帐户并为他的设备创建一个新的配置文件，然后您可以使用 TestFlight 分发它并自动向他推送任何更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:38:36.027

您确实无法通过无线方式共享它，但您可以将他的设备添加到您的帐户，并创建一个包含他的设备的新配置文件，他可以下载该项目并在那里运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:52:24.457

创建一个临时配置文件并使用此配置文件来验证和分发您的应用程序。不要选择 App Store，而是选择另一个选项（不记得现在叫什么）。这将创建一个 .IPA 文件，您的朋友可以将其拖入 iTunes 并安装在他的设备上。请注意，您需要将他的 UDID 添加到您的开发人员门户中才能正常工作。

# python - PySide QFTP 只上传 35-40 字节

> ID：11509530
> 
> 赞同：1
> 
> 时间：2012-07-16T17:36:36.540
> 
> 标签：python, pyqt, pyside

当我使用 QFTP 的 put 命令上传文件时，它只上传大约 40 个字节的指定文件。我正在捕捉 dataProgress 信号并且我正在获得进度，但文件的总大小仅读取为大约 40 个字节。我的代码有什么问题，还是 FTP 服务器方面的问题？

这是我的上传功能：

```
 def upload(self):
        filename = QFileDialog.getOpenFileName(self, 'Upload File', '.')
        fname = QIODevice(filename[0])
        dataname = filename[0]
        data = os.path.basename(dataname)
        #data = data[data.find("/") + 1:]
        print data
        print fname
        if not self.fileTree.currentItem():
            self.qftp.put(fname, data)
        elif "." in self.fileTree.currentItem().text(0):
            self.qftp.put(fname, self.fileTree.currentItem().parent().text(0) + data)
        elif self.fileTree.currentItem().text(0) == "/":
            self.qftp.put(fname, data)
        else:
            return 
```

好吧，想通了我需要做什么。我需要创建一个 QFile 并从该文件中读取所有字节，然后将其传递给 put 命令。

```
def upload(self):
    filename = QFileDialog.getOpenFileName(self, 'Upload File', '.')
    data = QFile(filename[0])
    data.open(1)
    qdata = QByteArray(data.readAll())
    file = os.path.basename(filename[0])
    print data
    if not self.fileTree.currentItem():
        self.qftp.put(qdata, file, self.qftp.TransferType())
    elif "." in self.fileTree.currentItem().text(0):
        self.qftp.put(qdata, self.fileTree.currentItem().parent().text(0) + file)
    elif self.fileTree.currentItem().text(0) == "/":
        self.qftp.put(qdata, file)
    else:
        return 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:30:46.743

我猜这`data = os.path.basename(dataname)`意味着数据总是一个包含文件名的字符串。尝试通过使用将其更改为打开的 fileobj`data = open(os.path.basename(dataname), 'rb')`

**编辑**

查看`PySide.QtNetwork.QFtp.put(data, file[, type=Binary])`and `PySide.QtNetwork.QFtp.put(dev, file[, type=Binary])`- 参数的顺序是**data/dev** *然后是* **文件**- 所以它在你的代码中是错误的方式......

# java - JList AbstractListModel - fireIntervalAdded & AutoScroll to new element

> ID：11509532
> 
> 赞同：1
> 
> 时间：2012-07-16T17:36:38.757
> 
> 标签：java, swing, jlist

我对 Java 比较陌生，尤其是摇摆。我使用 Netbeans 6.8 进行开发。

我有一个使用自定义 AbstractListModel 的 JList。此 AbstractListModel 跟踪数据库中数据的更改，并在将新元素添加到列表时调用 fireIntervalAdded。这完美地工作。

我遇到的问题是我希望 JList（或 JScrollPane）自动滚动到列表中的新元素。我已经读到我可以使用 JList.ensureIndexIsVisible，但我不知道如何从其关联的 ListModel 中获取对 JList 实例的引用（因为我从 ListModel 中触发了“fireIntervalAdded”）。

稍微解释一下，我在 ListModel 中构建了一个轮询器来轮询来自 SQL 服务器的新数据。由于我将 ListModel 视为列表的“数据源”，因此将数据检索（在我的情况下为轮询）逻辑放入此 ListModel 是有意义的。这些教程似乎没有涵盖从模型本身控制滚动的这种特定需求（这是有道理的，因为 ListModel 可以一次在多个 JList 中使用......）

我可以做些什么来让 JList 从 ListModel 代码中滚动到最后创建的元素？

另外，我想如果我能在 JList 中找到一个在添加新元素时会触发的事件，我可以解决我的问题，但我没有找到！

谢谢

- 编辑 -

好的，根据 MadProgrammer 的回复，这是我构建的：

```
public class JListDataListener implements ListDataListener {
    JList _listToControl = null;
    public JListDataListener(JList listToControl) {
        this._listToControl = listToControl;
        this._listToControl.getModel().addListDataListener(this);
    }

    public void intervalAdded(final ListDataEvent e) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
                            public void run() {
                                _listToControl.ensureIndexIsVisible(e.getIndex1() + 1);
                            }
                        });
    }

    public void intervalRemoved(ListDataEvent e) {
        //throw new UnsupportedOperationException("Not supported yet.");
    }

    public void contentsChanged(ListDataEvent e) {
        //throw new UnsupportedOperationException("Not supported yet.");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:10:25.657

就个人而言，我不会尝试直接从这样的模型更改用户界面。您最好将另一个侦听器附加到模型并引用相关列表，这使得解决方案可重用。

我可能很想扩展 jlist 并使用专门的内部侦听器，但这取决于您的要求

# cocos2d-iphone - 选择世界地图的不同区域

> ID：11509534
> 
> 赞同：0
> 
> 时间：2012-07-16T17:36:41.433
> 
> 标签：cocos2d-iphone

在 cocos2d for iPhone 中，如何将屏幕的选定部分变成具有选择器功能的菜单项？

想象一下不同区域之间具有弯曲边界的世界地图。当玩家触摸这些区域之一时，应该有一个选择器/回调。有点像标准菜单，但没有选择标签或图像。相反，我想要的是能够手动指定可点击区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:43:30.997

制作一个包含这个自定义区域的 CCLayer 怎么样？CCLayer 已经实现了触摸代理，您可以通过将 self.isTouchEnabled 设置为 true 来轻松开始捕获区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:45:45.580

手动定义世界地图的区域，理想情况下作为多边形的矩形，您需要查找多边形相交测试。然后只需将 CGRectContainsPoint 与所有矩形和触摸点一起使用。如果触摸在世界区域内，则运行需要运行的任何代码。

# php - Magento：添加到购物车的昵称产品

> ID：11509542
> 
> 赞同：0
> 
> 时间：2012-07-16T17:37:07.930
> 
> 标签：php, magento

我在一家销售捆绑产品的店面工作，有点像自己制造个人电脑。

一旦客户选择了他们想要的选项，**我希望他们在将产品添加到他们的购物车之前也给产品一个（昵称）名称**。这将是一个纯粹供客户参考的标准文本字段。

此字段将显示在购物车中、结帐期间以及提交订单后的订单详细信息中。

**实施此用户可编辑产品字段的最佳/正确方法是什么？**

我曾认为自定义选项是最好的，但它指出“ `Bundle with dynamic pricing cannot include custom defined options. Options will not be saved.`”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:32:17.687

据我所知，Magento 没有任何内置方法来实现这一点。您的选择是找到第三方扩展或编写自定义模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T16:14:39.713

我找到并实施了此处显示的解决方法：http: [//amirshakya.wordpress.com/2012/07/08/custom-options-on-a-bundle-product-in-dynamic-pricing/](http://amirshakya.wordpress.com/2012/07/08/custom-options-on-a-bundle-product-in-dynamic-pricing/) 它基本上禁用了警告和强制执行该规则的。

是的，我意识到这有点像 hack，但它的效果很好，因为：

*   自定义选项不需要影响价格（我认为这就是 Magento 阻止它的原因）
*   它将在页面上显示捆绑选项和自定义昵称选项
*   将同时保存用户选择

# javascript - 为什么 JavaScript 函数可以在定义之前被访问？

> ID：11509547
> 
> 赞同：1
> 
> 时间：2012-07-16T17:37:29.257
> 
> 标签：javascript, function, syntax

> **可能重复：**
> [为什么我可以在 Javascript 中定义函数之前使用它？](https://stackoverflow.com/questions/261599/why-can-i-use-a-function-before-its-defined-in-javascript)

`Foo`正如所料，以下代码由于未定义而引发错误：

```
window.Foo = Foo; 
```

同样如预期的那样，这会引发相同的错误：

```
window.Foo = Foo;
Foo = function() {
    ...
}; 
```

奇怪的是，这很好用：

```
window.Foo = Foo;
function Foo(){
    ...
}; 
```

这怎么可能？JavaScript 不是逐行解释的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:58:38.910

吊装只是这里故事的一部分。

首先，解释吊装：

当你`var`在 JavaScript 程序中使用时，你声明了一个变量。无论该变量在 JS 作用域中的何处声明，它都会被提升到该作用域的顶部。JavaScript 只有 Global 或 Function 范围；在函数的情况下

```
function hoistAway() {
  console.log(a);
  var a = 5;
} 
```

相当于

```
function hoistAway() {
  var a;
  console.log(a);
  a = 5;
} 
```

如您所见，*声明*被提升，但初始化没有。因此，此代码将登录`undefined`控制台，而不是 5。但是，它会满足于`a`存在。

当你不使用`var`时，声明是不明确的，所以它不会被提升。因此：

```
function hoistAway() {
  console.log(a);
  a = 5;
} 
```

将导致错误消息。

在您的示例中：

```
window.Foo = Foo; 
```

`Foo`从未声明过，所以你得到一个错误。

```
window.Foo = Foo;
Foo = function() {
    ...
}; 
```

同样， Foo 没有被声明，所以没有提升。作为记录：

```
window.Foo = Foo;
var Foo = function() {
    ...
}; 
```

不会抛出错误。但是，只有声明被提升，所以如果你做了类似的事情

```
var bob = {};
bob.Foo = Foo;
var Foo = function() {
    ...
}; 
```

那么`bob.Foo`将是`undefined`。的特殊情况`window.Foo = Foo`很奇怪，因为`Foo`和`window.Foo`在全局范围内是相同的。

最后：

```
window.Foo = Foo;
function Foo(){
    ...
}; 
```

有效，因为函数声明（与函数表达式相反）也被提升了；名称和定义都被提升了，所以这将按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:38:34.170

首先解析脚本，允许您的代码调用稍后定义的函数。

# imagemagick - Get text from image with ImageMagick and Tesseract

> ID：11509548
> 
> 赞同：2
> 
> 时间：2012-07-16T17:37:39.273
> 
> 标签：imagemagick, tesseract

I wanted to know if anyone has ever used Tesseract with ImageMagick to get precise text from image. My main concern is with the small font texts present in an image (or some text that are not clearly visible). The only way I am able to retrieve those unclear texts are by modifying the image by ImageMagick like - by scaling the image, sometimes cropping the image....

I wanted to know if someone has integrated ImageMagick and Tesseract to create even powerful tool?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T23:17:19.170

到目前为止，我已经想出了一个可以搜索图像中文本的脚本......该脚本使用了imagemagick和tesseract。该脚本仍在开发中，但您可以在[此处查看](https://stackoverflow.com/questions/11978986/ocr-getting-text-from-image-using-tesseract-3-0-and-imagemagick-6-6-5)

# php - 为什么不画图？(PHP)

> ID：11509551
> 
> 赞同：0
> 
> 时间：2012-07-16T17:37:45.917
> 
> 标签：php, draw

为什么我的班级不画画？如果我让它成为它运行的唯一函数，但在类中它不起作用:(。我是 PHP 类的新手（Java 类对我来说不是新的）。

```
<?php

class Schild
{

    public function __construct(){
        $text = $_GET['text'];
        $picture = imagecreatefrompng("bild.png");
        $pika = imagecreatefromjpeg("pika.jpg");
        $pika_size = getimagesize("pika.jpg");
    }

    public function drawPicture()
    {
        $im = imagecolorallocate ($picture, 255, 0, 255);
        imagettftext($picture, 111, 0, 100, 100,$im , "Marmellata(Jam)_demo.ttf", $text);

        # int ImageCopy ( resource $dst_im , resource $src_im , int $dst_x , int $dst_y , int $src_x , int $src_y , int $src_w , int $src_h )
        imagecopy($picture, $pika, 50, 50, 0, 0, $pika_size[0], $pika_size[1]);

        $zufall = rand(1,99999999);

        #header("Content-Type: image/jpeg");
        imagejpeg($picture);
        imagedestroy($picture);

    }
}

$schild1 = new Schild();
$schild1->drawPicture();
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:40:55.777

```
<?php

class Schild
{
    protected $picture;
    protected $pika;
    protected $pika_size;
    protected $text;

    public function __construct(){
        $this->text = $_GET['text'];
        $this->picture = imagecreatefrompng("bild.png");
        $this->pika = imagecreatefromjpeg("pika.jpg");
        $this->pika_size = getimagesize("pika.jpg");
    }

    public function drawPicture()
    {
        $im = imagecolorallocate ($this->picture, 255, 0, 255);
        imagettftext($this->picture, 111, 0, 100, 100,$im , "Marmellata(Jam)_demo.ttf", $this->text);

        # int ImageCopy ( resource $dst_im , resource $src_im , int $dst_x , int $dst_y , int $src_x , int $src_y , int $src_w , int $src_h )
        imagecopy($this->picture, $this->pika, 50, 50, 0, 0, $this->pika_size[0], $this->pika_size[1]);

        $zufall = rand(1,99999999);

        #header("Content-Type: image/jpeg");
        imagejpeg($this->picture);
        imagedestroy($this->picture);

    }
}

$schild1 = new Schild();
$schild1->drawPicture();
?> 
```

问题是您在 中声明变量`__construct`，但它们是局部变量。执行完成后`__construct()`，它会删除所有局部变量。您必须使用关键字将它们声明为 CLASS 变量`$this`，以便您的其他函数可以访问它们。

# sorting - sorting array of tuple in haskell by index

> ID：11509552
> 
> 赞同：2
> 
> 时间：2012-07-16T17:37:46.340
> 
> 标签：sorting, haskell

I write a code to sort index of tuple list I try to use **map** with `bubblesort()` to avoid using **loops**

```
 bubblesort::(Ord t) => [t]->[t]
     bubblesort[x,y,z,xs]=
                if x<y then x : map bubblesort [y,z,xs]
                       else y : map bubblesort [x,z,xs] 
```

but it give me an error that :

```
ERROR line 20 - Type error in list
*** Expression     : [y,xs]
*** Term           : xs
*** Type           : [a]
*** Does not match : a
*** Because        : unification would give infinite type

```

*note please give me instruction only

--The complier is online compiler

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:45:42.757

我不知道对此的完整解决方案，但bubblesort 期望`[t]`，但`bubblesort [x,z,xs]`将是`[[t]] -> [[t]]`. 所以每次，类型都会被另一个类型包裹起来`[]`

此外，您不需要这样做`map bubblesort`。试着记住这个`map`函数到底做了什么，看看为什么这没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T12:18:44.807

您遇到的主要问题是我看到初学者一直在做的一个问题。您正在使用列表，因此您决定必须使用方括号。你真正需要的是这样的：

```
bubblesort (x:y:xs) = 
    if x < y 
       then x : bubblesort (y:xs)
       else y : bubblesort (x:xs) 
```

当你使用类似的东西时

```
foo [a,b,c] = … 
```

您在一个*恰好*包含三个元素的列表上进行显式模式匹配。如果你使用

```
foo (a:b:c:xs) = … 
```

那么你在一个*至少有*三个元素的列表上显式匹配，其中第一个绑定到名称 a，第二个 b，第三个 c，并且列表的其余部分（不管它有多长）称为 xs .

我希望这有助于清除它。这是一个非常常见的错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T19:58:15.580

Thanx alote etemalmatt 这是我自己的问题的奴隶

```
 bubbleSort::(Ord t) => [t]->[t]
  bubbleSort[x,y,z,xs]=
                if x<y then x : [y,z,xs]
                       else y : [x,z,xs]
   superBubble::(Ord t) => [[t]]->[[t]]
   superBubble a=map bubbleSort a 
```

我的问题是使用`map`递归应用于所有元素的函数，所以我的解决方案是让它与一个元素一起工作，正如你`bubbleSort()`现在看到的那样，它已修复

# javascript - Insert new list sorted in alphabetical order, javascript or jquery

> ID：11509555
> 
> 赞同：4
> 
> 时间：2012-07-16T17:38:03.290
> 
> 标签：javascript, jquery, sorting

I have lists, already sorted alphabetically as below:

```
<ul>
  <li><a href='#'>Apple</a></li>
  <li><a href='#'>Banana</a></li>
  <li><a href='#'>Grapes</a></li>
<ul> 
```

So i wanted to add new list which has the value of `Chico` so it should be inserted between `Banana` and `Grapes`...like it will fade in. So i have a form or an input field to add a new list of fruits...

Is there any way to do that using jquery or javascript?

Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:57:35.720

```
function sortAlpha(a,b){  
    return a.innerHTML.toLowerCase() > b.innerHTML.toLowerCase() ? 1 : -1;  
}

$("#insert").on('click', function() {
    var newLi = $("<li><a href='#'>"+$("#fruit").val()+"</a></li>").hide();
    $('li', 'ul').add(newLi.fadeIn(800)).sort(sortAlpha).appendTo('ul');
});​ 
```

[小提琴](http://jsfiddle.net/cJL6L/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:03:02.213

请参阅此[工作小提琴示例](http://jsfiddle.net/zuul/eJSe6/)！

此函数将新列表项添加到提供的列表中。添加新项目后，它将按内容对所有项目进行排序。

```
function addNewListItem($list, $ele) {

    // append new element
    $list.append($ele);

    // get all elements
    var listItems = $list.children('li').get();

    // sort elements by contents
    listItems.sort(function(a, b) {
       return $(a).text().toUpperCase().localeCompare($(b).text().toUpperCase());
    });
    $.each(listItems, function(idx, itm) { $list.append(itm); });
} 
```

**示例用法：**

```
//Creating a new item
var $newLI = $('<li/>').append($('<a/>', {"href":'#',"title":''}).html('Chico'));

// adding and sorting
addNewListItem($('ul'), $newLI); 
```

* * *

通过[这个](https://stackoverflow.com/a/1134983/352449)stackoverflow 答案，原始排序功能归功于[Dan @ onemoretake 。](http://www.onemoretake.com/2009/02/25/sorting-elements-with-jquery/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:45:31.997

***CSS***

```
.hide {
   display: none
} 
```

***jQuery***

```
function addListElement(el) {
    var lis = $('ul li').add(el).sort(function(a, b) {
        return $('a', a).text() > $('a', b).text();
    });

    $('ul').html(lis).find('.hide').fadeIn(3000, function() {
        $(this).removeClass('hide')
    });
}

addListElement('<li class="hide"><a href="#">Chico</a></li>'); 
```

**[工作样本](http://jsfiddle.net/QStkd/610/)**

# java - HQL Join Statement

> ID：11509557
> 
> 赞同：0
> 
> 时间：2012-07-16T17:38:14.350
> 
> 标签：java, sql, hibernate, hql, spring-roo

I have a class employee. It has a primary key ID and column called supervisorID. I want to display supervisor ID as the employees name, so I must do a join back to the same table. I'm using Spring Roo and Hibernate so I need to create an HQL query to do this but I can't figure out how to translate from SQL to HQL, the below is an example of the SQL query.

```
SELECT e.ID, e.name AS Employee, s.name AS Supervisor  
FROM employee e  
  INNER JOIN employee s  
  ON s.ID = e.supervisorID  
ORDER BY e.ID; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:48:02.110

看起来你想要一个标量查询。

```
 List<Object[]> rows = getEntityManager().createQuery(
       "select e.id, e.name, s.name "
        + " from Employee e join fetch e.supervisor s "
        + " order by e.id").getResultList();

   for ( Object[] row: rows ) {
       // Construct an instance (or whatever) with the values
       Long id = (Long) row[0];
       String eName = (String) row[1];
       String sName = (String) row[2];
   } 
```

# wpf - ListBox binding results in doubled items

> ID：11509566
> 
> 赞同：1
> 
> 时间：2012-07-16T17:38:59.517
> 
> 标签：wpf, data-binding, listbox

I have a very weird problem. I am binding `ListBox.ItemSource` to an `ObservableCollection`. I subscribe to the `CollectionChanged` event of the collection if any items are added, I show the window with the `ListBox` that is bound to the collection. The first time I do this, the `ListBox` shows only one item as it should. The second time however, the `ListBox` which is in a newly created `Window` shows two items. I have verified that the `ObservableCollection` never has more than one item in it. What the heck is going on?

Here is the code in my view model.

```
 public ObservableCollection<AlarmItemViewModel> RaisedAlarms
    {
        get { return _raisedAlarms; }
        set { _raisedAlarms = value; RaisePropertyChanged("RaisedAlarms"); }
    }

    protected override void OnAlarmRaised(AlarmItem a_alarmItem)
    {
        var activeAlarmItems = from alarmItem in RaisedAlarms
                               select alarmItem.AlarmItem;

        if (!activeAlarmItems.Contains(a_alarmItem))
            RaisedAlarms.Add(new AlarmItemViewModel(this, a_alarmItem));
    }

    private void OnActiveAlarmsCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        if (e.Action == NotifyCollectionChangedAction.Add)
        {
            if (_alarmRaiseWindow == null)
            {
                _alarmRaiseWindow = new SetupWindow();
                _alarmRaiseWindow.Title = "Alarm Raised";
                _alarmRaiseWindow.WindowStartupLocation = System.Windows.WindowStartupLocation.CenterScreen;
                _alarmRaiseWindow.Topmost = true;
                _alarmRaiseWindow.Content = new AlarmRaise();
                _alarmRaiseWindow.DataContext = this;
                _alarmRaiseWindow.Closed += OnAlarmNotifyClosed;
            }
        }

        if (!RaisedAlarms.Any() && _alarmRaiseWindow != null)
        {
            _alarmRaiseWindow.Close();
        }
    }

    private void OnAlarmNotifyClosed(object sender, EventArgs e)
    {
        if (_alarmRaiseWindow != null)
        {
            _alarmRaiseWindow.Closed -= OnAlarmNotifyClosed
            _alarmRaiseWindow = null;
        }
    } 
```

Here is a simplified version of the XAML:

```
<UserControl x:Class="MyNamespace.AlarmRaise"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300" Width="400" Height="300">
    <Border>
        <Grid>
            <ListBox ItemsSource="{Binding RaisedAlarms, Mode=OneWay}">
            </ListBox>
        </Grid>
    </Border>
</UserControl> 
```

**Edits**:

The way my code works is basically this. When the first item in the collection is added it shows a `Window` containing a `ListBox` bound the collection, so if any others are added in the collection they will show as well. Once the last item in the collection is removed, the `Window` is closed.

So say I have an "Alarm 1", "Alarm 2" and "Alarm 3", and they show the first time, and I remove them by sleeping them for five seconds, then the next time the window comes up, it will show the first item twice: "Alarm 1", "Alarm 1", "Alarm 2", "Alarm 3". Not always in that order.

This is true for subsequent iterations as well (i.e. it never shows up more than doubled).

**Further Edits**:

It seems that the issue is either with the view or the binding. The view model is always showing the correct data at the correct times. I am wondering if maybe I need to refresh the binding in some way, or bind in code. I am wanting to avoid both.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:35:50.900

呜呼，我已经解决了这个问题！它与设置`DataContext`和调用的顺序有关`Show()`。如果我设置`DataContext` *after* I call ，它工作正常`Window.Show()`。`Show()`糟糕，我在示例代码中省略了对的调用。我不得不更改代码以删除与此问题无关的外部依赖项，并且会提出更多问题。我现在会编辑它。

# java - Generic ListView Adapter

> ID：11509572
> 
> 赞同：1
> 
> 时间：2012-07-16T17:39:27.697
> 
> 标签：java, android, android-layout, android-listview, android-adapter

I am trying to create a Custom `Adapter` which can handle any kind of layout to be inflated. By generic I mean any kind of data to be set in an adapter and any kind of a layout could be used with Event Listeners to be set for an item.

For example:

I have a contact list and a country list. The Contact list has four items in its layout i.e person image, name, number and a checkBox. The Country List contains a CountryName(TextView) and a checkbox.

Is it possible for both to use the same adapter and that adapter handle all kind of items?

I wish the tick images would reset after clicking on any item.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T16:39:01.520

如果您有一个包含不同对象的列表，该对象可以是不同类型的并且需要不同的视图来显示。这样做：

让对象自己定义视图。`ViewProvider`在每个对象上实现一个接口。这个接口应该提供`getView()`可以在适配器中调用的方法。

适配器现在只需将元素从列表中取出`ViewProviders`并调用方法`getView`来获取视图。

您不必担心视图的回收，因为视图存储在每个视图中`ViewProvider`并且只会创建一次。然后也可以在对象端而不是在适配器中更新字段（如果有）。但是您必须通过调用通知适配器有关数据更改`notifyDataSetChanged()`

# android - send arraylist to another intent

> ID：11509578
> 
> 赞同：0
> 
> 时间：2012-07-16T17:39:38.960
> 
> 标签：android, arraylist, parcelable

I have this class:

```
public class  Hotel implements Parcelable {

public Hotel() {
    super();
}

public Hotel(Parcel in) {
    this.id = in.readString();
    this.hotelFileName = in.readString();
    this.hotelName = in.readString();
    this.rating = in.readString();
    this.cityId = in.readString();
    this.cityFileName = in.readString();
    this.cityName = in.readString();
    this.stateId = in.readString();
    this.stateFileName = in.readString();
    this.stateName = in.readString();
    this.countryCode = in.readString();
    this.countryFileName = in.readString();
    this.countryName = in.readString();
    this.imageId = in.readString();
    this.address = in.readString();
    this.minRate = in.readString();
    this.currencyCode = in.readString();
    Latitude = in.readString();
    Longitude = in.readString();
    NumberOfReviews = in.readString();
    ConsumerRating = in.readString();
    PropertyType = in.readString();
    ChainID = in.readString();
    Facilities = in.readString();
}

public Hotel(String id, String hotelFileName, String hotelName,
        String rating, String cityId, String cityFileName, String cityName,
        String stateId, String stateFileName, String stateName,
        String countryCode, String countryFileName, String countryName,
        String imageId, String address, String minRate,
        String currencyCode, String latitude, String longitude,
        String numberOfReviews, String consumerRating, String propertyType,
        String chainID, String facilities) {
    super();
    this.id = id;
    this.hotelFileName = hotelFileName;
    this.hotelName = hotelName;
    this.rating = rating;
    this.cityId = cityId;
    this.cityFileName = cityFileName;
    this.cityName = cityName;
    this.stateId = stateId;
    this.stateFileName = stateFileName;
    this.stateName = stateName;
    this.countryCode = countryCode;
    this.countryFileName = countryFileName;
    this.countryName = countryName;
    this.imageId = imageId;
    this.address = address;
    this.minRate = minRate;
    this.currencyCode = currencyCode;
    Latitude = latitude;
    Longitude = longitude;
    NumberOfReviews = numberOfReviews;
    ConsumerRating = consumerRating;
    PropertyType = propertyType;
    ChainID = chainID;
    Facilities = facilities;
}

private String id;
private String hotelFileName;
private String hotelName;
private String rating;
private String cityId;
private String cityFileName;
private String cityName;
private String stateId;
private String stateFileName;
private String stateName;
private String countryCode;
private String countryFileName;
private String countryName;
private String imageId;
private String address;
private String minRate;
private String currencyCode;
private String Latitude;
private String Longitude;
private String NumberOfReviews;
private String ConsumerRating;
private String PropertyType;
private String ChainID;
private String Facilities;
private String distance;

@Override
public String toString() {
    return "Hotel [id=" + id + ", hotelFileName=" + hotelFileName
            + ", hotelName=" + hotelName + ", rating=" + rating
            + ", cityId=" + cityId + ", cityFileName=" + cityFileName
            + ", cityName=" + cityName + ", stateId=" + stateId
            + ", stateFileName=" + stateFileName + ", stateName="
            + stateName + ", countryCode=" + countryCode
            + ", countryFileName=" + countryFileName + ", countryName="
            + countryName + ", imageId=" + imageId + ", address=" + address
            + ", minRate=" + minRate + ", currencyCode=" + currencyCode
            + ", Latitude=" + Latitude + ", Longitude=" + Longitude
            + ", NumberOfReviews=" + NumberOfReviews + ", ConsumerRating="
            + ConsumerRating + ", PropertyType=" + PropertyType
            + ", ChainID=" + ChainID + ", Facilities=" + Facilities + "]";
}

public String getId() {
    return id;
}

public String getHotelFileName() {
    return hotelFileName;
}

public void setHotelFileName(String hotelFileName) {
    this.hotelFileName = hotelFileName;
}

public String getHotelName() {
    return hotelName;
}

public void setHotelName(String hotelName) {
    this.hotelName = hotelName;
}

public String getRating() {
    return rating;
}

public String getCityId() {
    return cityId;
}

public void setCityId(String cityId) {
    this.cityId = cityId;
}

public String getCityFileName() {
    return cityFileName;
}

public void setCityFileName(String cityFileName) {
    this.cityFileName = cityFileName;
}

public String getCityName() {
    return cityName;
}

public void setCityName(String cityName) {
    this.cityName = cityName;
}

public String getStateId() {
    return stateId;
}

public void setStateId(String stateId) {
    this.stateId = stateId;
}

public String getStateFileName() {
    return stateFileName;
}

public void setStateFileName(String stateFileName) {
    this.stateFileName = stateFileName;
}

public String getStateName() {
    return stateName;
}

public void setStateName(String stateName) {
    this.stateName = stateName;
}

public String getCountryCode() {
    return countryCode;
}

public void setCountryCode(String countryCode) {
    this.countryCode = countryCode;
}

public String getCountryFileName() {
    return countryFileName;
}

public void setCountryFileName(String countryFileName) {
    this.countryFileName = countryFileName;
}

public String getCountryName() {
    return countryName;
}

public void setCountryName(String countryName) {
    this.countryName = countryName;
}

public String getImageId() {
    return imageId;
}

public void setImageId(String imageId) {
    this.imageId = imageId;
}

public String getAddress() {
    return address;
}

public void setAddress(String address) {
    this.address = address;
}

public String getMinRate() {
    return minRate;
}

public void setMinRate(String minRate) {
    this.minRate = minRate;
}

public String getCurrencyCode() {
    return currencyCode;
}

public void setCurrencyCode(String currencyCode) {
    this.currencyCode = currencyCode;
}

public String getLatitude() {
    return Latitude;
}

public void setLatitude(String latitude) {
    Latitude = latitude;
}

public String getLongitude() {
    return Longitude;
}

public void setLongitude(String longitude) {
    Longitude = longitude;
}

public String getNumberOfReviews() {
    return NumberOfReviews;
}

public void setNumberOfReviews(String numberOfReviews) {
    NumberOfReviews = numberOfReviews;
}

public String getConsumerRating() {
    return ConsumerRating;
}

public void setConsumerRating(String consumerRating) {
    ConsumerRating = consumerRating;
}

public String getPropertyType() {
    return PropertyType;
}

public void setPropertyType(String propertyType) {
    PropertyType = propertyType;
}

public String getChainID() {
    return ChainID;
}

public void setChainID(String chainID) {
    ChainID = chainID;
}

public String getFacilities() {
    return Facilities;
}

public void setFacilities(String facilities) {
    Facilities = facilities;
}

public void setId(String id) {
    this.id = id;
}

public void setRating(String rating) {
    this.rating = rating;
}

public String getDistance() {
    return distance;
}

public void setDistance(String distance) {
    this.distance = distance;
}

@Override
public int describeContents() {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public void writeToParcel(Parcel dest, int flags) {
    dest.writeString(id.isEmpty()?"":id);
    dest.writeString(hotelFileName.isEmpty()?"":hotelFileName);
    dest.writeString(hotelName.isEmpty()?"":hotelName);
    dest.writeString(rating.isEmpty()?"":rating);
    dest.writeString(cityId.isEmpty()?"":cityId);
    dest.writeString(cityFileName.isEmpty()?"":cityFileName);
    dest.writeString(cityName.isEmpty()?"":cityName);
    dest.writeString(stateId.isEmpty()?"":stateId);
    dest.writeString(stateFileName.isEmpty()?"":stateFileName);
    dest.writeString(stateName.isEmpty()?"":stateName);
    dest.writeString(countryCode.isEmpty()?"":countryCode);
    dest.writeString(countryFileName.isEmpty()?"":countryFileName);
    dest.writeString(countryName.isEmpty()?"":countryName);
    dest.writeString(imageId.isEmpty()?"":imageId);
    dest.writeString(address.isEmpty()?"":address);
    dest.writeString(minRate.isEmpty()?"":minRate);
    dest.writeString(currencyCode.isEmpty()?"":currencyCode);
    dest.writeString(Latitude.isEmpty()?"":Latitude);
    dest.writeString(Longitude.isEmpty()?"":Longitude);
    dest.writeString(NumberOfReviews.isEmpty()?"":NumberOfReviews);
    dest.writeString(ConsumerRating.isEmpty()?"":ConsumerRating);
    dest.writeString(PropertyType.isEmpty()?"":PropertyType);
    dest.writeString(ChainID.isEmpty()?"":ChainID);
    dest.writeString(Facilities.isEmpty()?"":Facilities);
    dest.writeString(distance.isEmpty()?"":distance);
}

public static final Parcelable.Creator<Hotel> CREATOR = new Parcelable.Creator<Hotel>() {
    public Hotel createFromParcel(Parcel in) {

        return new Hotel(in);
    }

    public Hotel[] newArray(int size) {

        return new Hotel[size];
    }
};

} 
```

I want to send an `arraylist<Hotel>` from one intent to another by using `i.putExtra("hotels", hotels);`

I receive the `arraylist<Hotel>` by this

```
ArrayList<Hotel> hotels = (ArrayList<Hotel>) i
                .getSerializableExtra("hotels"); 
```

Note that hotels can contain some empty fields.

When I execute, obtain this error:

> 07-16 18:35:59.779: E/AndroidRuntime(6335): FATAL EXCEPTION: main 07-16 18:35:59.779: E/AndroidRuntime(6335): java.lang.RuntimeException: Unable to start activity ComponentInfo{suptechnique.hotelsdirectory/com.suptech.hotels.map.CarteActivity}: java.lang.RuntimeException: Parcel android.os.Parcel@40511ae8: Unmarshalling unknown type code 3473457 at offset 448 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.app.ActivityThread.access$1500(ActivityThread.java:117) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Handler.dispatchMessage(Handler.java:99) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Looper.loop(Looper.java:123) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.app.ActivityThread.main(ActivityThread.java:3687) 07-16 18:35:59.779: E/AndroidRuntime(6335): at java.lang.reflect.Method.invokeNative(Native Method) 07-16 18:35:59.779: E/AndroidRuntime(6335): at java.lang.reflect.Method.invoke(Method.java:507) 07-16 18:35:59.779: E/AndroidRuntime(6335): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867) 07-16 18:35:59.779: E/AndroidRuntime(6335): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625) 07-16 18:35:59.779: E/AndroidRuntime(6335): at dalvik.system.NativeStart.main(Native Method) 07-16 18:35:59.779: E/AndroidRuntime(6335): Caused by: java.lang.RuntimeException: Parcel android.os.Parcel@40511ae8: Unmarshalling unknown type code 3473457 at offset 448 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Parcel.readValue(Parcel.java:1913) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Parcel.readListInternal(Parcel.java:2092) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Parcel.readArrayList(Parcel.java:1536) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Parcel.readValue(Parcel.java:1867) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Parcel.readMapInternal(Parcel.java:2083) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Bundle.unparcel(Bundle.java:208) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.os.Bundle.getSerializable(Bundle.java:1189) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.content.Intent.getSerializableExtra(Intent.java:3583) 07-16 18:35:59.779: E/AndroidRuntime(6335): at com.suptech.hotels.map.CarteActivity.onCreate(CarteActivity.java:39) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) 07-16 18:35:59.779: E/AndroidRuntime(6335): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) 07-16 18:35:59.779: E/AndroidRuntime(6335): ... 11 more

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:40:58.773

Let your Hotel class implement `Serializable` instead of `Parcelable`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:42:33.647

replace `implements Parcelable` with `implements Serializable`..it will work like a charm!

# javascript - 调用与局部变量同名的函数

> ID：11509582
> 
> 赞同：1
> 
> 时间：2012-07-16T17:39:54.293
> 
> 标签：javascript, debugging, if-statement

我有以下代码...

```
var firstPlay = 1;
if (firstPlay == 1) {
    firstPlay();
} 
```

当我删除 if 语句并放

```
 firstPlay(); 
```

然后它可以工作，但如果使用 if 语句则不能。

我打错字了吗？如果不是，我该如何调试这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T17:42:45.097

You are setting the variable `firstPlay` to the value 1, you can't run a value... use different names for your variables.

Such as:

```
var firstPlayTest = 1;
if (firstPlayTest == 1) { firstPlay(); }​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:53:00.290

函数 firstPlay() 的先前函数定义被数值 1 替换/重新定义。在以下代码中

```
 function firstPlay() {alert("firstPlay");}
        alert(firstPlay);
        var firstPlay = 1;
        alert(firstPlay); 
```

第一个警报显示函数定义，而第二个警报显示“1”。

# tokyo-cabinet - TokyoTyrant - restart with clean datastore

> ID：11509587
> 
> 赞同：1
> 
> 时间：2012-07-16T17:40:15.827
> 
> 标签：tokyo-cabinet, tokyo-tyrant

What is the correct way to restart with a clean datastore with TokyoTyrant? Can it be done via the Linux command line?

I'm working on a project where I need to restart both TokyoTyrant and Solr in sync.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T06:54:05.013

您可以通过 tokyotyrant 使用 vanish 命令删除数据库的所有记录，例如

tcrmgr vanish [-port num] 主机

# ipad - Event delegation from template on an iPad in Sproutcore framework

> ID：11509590
> 
> 赞同：1
> 
> 时间：2012-07-16T17:40:22.000
> 
> 标签：ipad, sproutcore, event-delegation

I am working on iPad web application(not a native application) and am using the Sproutcore framework. I have a button defined in a .template file and is defined as:

{{view Octopus.ButtonView content="action_ChangePassword" targetBinding=".parentView.parentView.changePasswordTarget" actionBinding=".parentView.parentView.changePasswordAction" }}

changePasswordAction is defined in the view page but the function that it is binded with doesn't get triggered on an iPad. However the same function is triggered on the Desktop web application without a code-change. May I know if there is a different way for event-delegation from .template files on iPad as compared to desktop web applications?

# actionscript-3 - Flex（桌面浏览器）项目会无缝导出到 AIR（桌面），还是需要调整？

> ID：11509596
> 
> 赞同：0
> 
> 时间：2012-07-16T17:40:42.187
> 
> 标签：actionscript-3, apache-flex, air

我正在为桌面浏览器开发一个 Flex Web 应用程序。我没有使用 AIR 的经验。

将 Flex 应用程序导出到桌面环境的 AIR 是否是一个简单的交钥匙过程（例如，我在这里不是在谈论移动或平板电脑应用程序，只有桌面）？或者，我是否需要重新编写 Flex/AS3 代码才能使其适用于 AIR？

也就是说，我是否需要在 AIR 应用程序的代码中开发一个分支并致力于在 AIR 环境中进行故障排除，还是 100% 的代码在两个（桌面浏览器和 AIR 桌面）应用程序中的工作方式相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:53:02.693

如果您没有计划在您的 Web 应用程序的 Air 版本中使用任何特定于 Air 的功能（例如文件系统操作），同时您没有使用任何特定于 Web 的功能（例如 JavaScript 到 Flash 通信），那么将您的 Web 应用程序发布为空气应用应该是平稳的。否则可能会很棘手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:59:32.647

代码不会 100% 工作。

在我的脑海中，基于 Web 的 Flex 应用程序的基类是基于`Application`AIR 的 Flex 应用程序的基类`WindowedApplication`（编辑：阅读文档，这可能不是*严格*要求的，因为`WindowedApplication`继承自`Application`）。您还需要处理诸如应用程序菜单（以及该菜单在 Mac 和 Windows 上不同的事实）以及用户单击应用程序窗口上的“x”关闭按钮等情况。

我希望您的应用程序的核心代码能够在没有任何重大更改的情况下工作。如果我这样做，我会进行分支，以便我拥有“网络”和“桌面”版本，并希望抽象出差异（`isDesktop()`例如有一个辅助方法）。

# ios - How to detect if a user is signed in to iCloud?

> ID：11509601
> 
> 赞同：5
> 
> 时间：2012-07-16T17:41:08.397
> 
> 标签：ios, icloud

How would I detect *specifically* if a user is signed into iCloud? Checking the return value of URLForUbiquityContainerIdentifier is very limited:

1) It can't distinguish between a user not being signed into iCloud versus other scenarios, e.g. iCloud not enabled. 2) It doesn't appear to change its behavior if a user signs into iCloud from the Settings app while the game is still running in the background, then returns to the app to try to access iCloud services.

Is there a more reliable way to detect specifically if a user is signed in?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-17T14:25:00.347

此外，从 iOS 6 开始，还有一个方法`[[NSFileManager defaultManager] ubiquityIdentityToken]`，它会告诉您 iCloud 是否可用以及用户是否切换了帐户

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T01:01:03.670

无法区分“用户未登录”和“iCloud 未启用”。您在您的应用程序中了解的是您的应用程序当前是否可以访问 iCloud，但如果答案是否定的，那么您不知道为什么。

但是，您的问题 #2 有一个解决方案 - 观察`NSUbiquityIdentityDidChangeNotification`。它会在整个 iCloud 状态发生变化时触发——用户登录、用户注销、用户切换帐户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-21T15:51:37.763

```
func isUserSignedIntoICloud() -> Bool {
    return FileManager.default.ubiquityIdentityToken != nil
} 
```

# python - 使用枚举选择列表的随机成员

> ID：11509602
> 
> 赞同：-2
> 
> 时间：2012-07-16T17:41:08.897
> 
> 标签：python, enumerate

假设 mylist 是 70 个元素的列表，我想从 mylist 中随机选择 0、12、5 个元素。我在“rand:”处收到语法错误

```
rand = [0, 12, 5]
LL=[]
for x in enumerate(mylist) if i in rand:
        LL.append(x) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T17:42:58.717

为什么不只是：

```
for i in rand:
   LL.append(mylist[i]) 
```

或更好：

```
LL = [mylist[i] for i in rand] 
```

但请注意，您的代码定义不明确。我认为您正在尝试的是：

```
LL = [ x for i,x in enumerate(mylist) if i in rand ] 
```

这将起作用，但除非您需要保留原始列表中的顺序，否则没有必要遍历整个枚举列表。

最后，如果您只想从列表中随机选择 N 个元素，[则 random.sample](http://docs.python.org/library/random.html#random.sample)非常适合。

```
import random
LL = random.sample(mylist,3) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:47:26.283

另外一个选项：

```
from operator import itemgetter
LL = list(itemgetter(*rand)(mylist)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:51:17.560

其他选项：

```
# just pick the items
from operator import itemgetter
print list(itemgetter(*rand)(mylist))

# pick 3 **actual** unique random items
from random import shuffle
shuffle(mylist)
print mylist[:3]

# Or as I've been reminded, and it preserves order of mylist (kudos @mgilson)
from random import sample
sample(mylist, 3) 
```

# java - 关于 JVM 内部的 -classpath 初始化

> ID：11509609
> 
> 赞同：2
> 
> 时间：2012-07-16T17:41:37.733
> 
> 标签：java

我知道当我们启动任何 java 进程时，我们使用类路径来添加第三方 jar。是否有人有关于 JVM 如何读取或 JVM 对类路径中指定的 jar 做什么的任何资源或信息？

我只是好奇 JVM 究竟是如何处理类路径的。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:10:00.837

类路径是线性读取的，因此当请求一个类时，Java 会在它的类路径上找到它的第一个实例。话虽如此，当您启动 Java 时，实际上存在三个类路径级别。第一个是包含 java 核心 jars（java.lang 等）的引导类路径。第二个是扩展类路径，其中包含在 java 安装的扩展 (ext) 目录中找到的任何 jar。第三个是用户指定的运行程序的类路径。这些类路径将始终按照从引导程序开始的顺序线性读取，然后是扩展，最后是用户指定的类路径。这就是阻止某人在普通程序中覆盖 java.lang 类的原因。即使类路径中稍后有另一个匹配项，找到匹配项的第一个类总是获胜。

# asp.net-mvc - 使用 nlog 在 nhibernate asp.net mvc 应用程序中记录 sql

> ID：11509612
> 
> 赞同：2
> 
> 时间：2012-07-16T17:41:56.540
> 
> 标签：asp.net-mvc, nhibernate, nlog

只是无法在 asp.net mvc 应用程序中创建由 nhibernate 生成的 nlog log sql 查询。

是否有任何示例开源应用程序使用 nlog 和 nhibernate 来查看（codeplex、github、bitbucket）？

任何文章如何使它们一起工作？

NHibernate 3，Nlog 2

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T14:22:12.040

终于修好了。使用 NHibernate.Nlog 包，并按照那里所说的那样[做](http://joseoncode.com/2011/05/04/nhibernate-nlog-support-in-nuget/)。仍然必须创建一个单独的 NLog.config，并将一个魔术字符串放入 web.config。Fluent NHibernate 不想暴露这一点。我不知道为什么。

# activemq - ActiveMQ STOMP Client access

> ID：11509614
> 
> 赞同：1
> 
> 时间：2012-07-16T17:41:59.907
> 
> 标签：activemq, stomp

We are planning to use ActiveMQ (STOMP) for one of our project. One of the requirement is to kick out/ban a user if we find them to be inappropriate. How can this be achieved with STOMP? Something like a KICK in IRC.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:30:33.720

ActiveMQ 的 JMX 接口允许您停止连接，这就像踢球一样。对于禁令，您需要将 ActiveMQ 设置为 JAAS 安全性。那么这只是禁用对该用户的访问的问题。

# xml - Why is this comparison only works for integer type id?

> ID：11509615
> 
> 赞同：-2
> 
> 时间：2012-07-16T17:42:02.107
> 
> 标签：xml, xslt, xpath

I am wondering does the statement `[@id=current()/@id]` can only work if the id is integer for example:

```
<elem id="1">
<elem id="1"> 
```

But if I have:

```
<elem id="AAA">
<elem id="AAA"> 
```

It does not work.

My XSL where it fails:

```
<xsl:stylesheet version="2.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:xs="http://www.w3.org/2001/XMLSchema"
                xmlns:fn="http://www.w3.org/2005/xpath-functions"
                xmlns:tn="http://"
                exclude-result-prefixes="xsl xs fn tn">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*" />

    <xsl:template match="@*|node()">
        <xsl:copy> 
            <xsl:apply-templates select="@*|node()" />
        </xsl:copy> 
    </xsl:template>

 <xsl:template match="genre/*">
        <xsl:copy>
            <xsl:apply-templates select="@*" />

            <xsl:apply-templates select="
     book[@id=current()/@id][@action='extend']                             
         [not( preceding-sibling::book[@id=current()/@id][@action='borrow'])]" />

            <xsl:for-each-group
                select="book[@id=current()/@id][@action='borrow'] 
             |   
            book[@id=current()/@id][@action='extend']
                [preceding-sibling::book[@id=current()/@id][@action='borrow']]"
                group-starting-with="book[@action='borrow']">
                <xsl:for-each select="current-group()[1]">
                    <xsl:copy>   
                        <xsl:apply-templates select="@*" />
                        <xsl:call-template name="merge-books-deeply">    
                            <xsl:with-param name="books" select="current-group()" />
                            <xsl:with-param name="name-path" select="()" />
                        </xsl:call-template>
                    </xsl:copy>
                </xsl:for-each>     
            </xsl:for-each-group>

            <xsl:apply-templates select="                             
     node()[ not( self::book[@id=current()/@id][@action=('borrow','extend')])]" />

        </xsl:copy>
    </xsl:template>

    <xsl:function name="tn:children-on-path" as="element()*">
        <xsl:param name="base" as="element()*" />   
        <xsl:param name="path" as="xs:string*" />    
        <xsl:choose>
            <xsl:when test="fn:empty($base)">
                <xsl:sequence select="()" />
            </xsl:when>
            <xsl:when test="fn:empty($path)">
                <xsl:copy-of select="$base/*" />     
            </xsl:when>
            <xsl:otherwise>
                <xsl:sequence select="tn:children-on-path(
     $base/*[name()=$path[1]],         
     $path[position() ne 1])" /> 
            </xsl:otherwise>  
        </xsl:choose>
    </xsl:function>

    <xsl:template name="merge-books-deeply">
        <xsl:param name="books" as="element()*" />
        <xsl:param name="name-path" as="xs:string*" />
        <xsl:for-each-group
            select="tn:children-on-path($books,$name-path)"
            group-by="name()">                                             
            <xsl:for-each select="current-group()[last()]" >  
                <xsl:copy>
                    <xsl:apply-templates select="@*" />
                    <xsl:call-template name="merge-books-deeply"> 
                        <xsl:with-param name="books" select="$books" />
                        <xsl:with-param name="name-path" select="$name-path,name()" />
                    </xsl:call-template>
                    <xsl:apply-templates select="text()" />        
                </xsl:copy>
            </xsl:for-each>
        </xsl:for-each-group>
    </xsl:template>

</xsl:stylesheet> 
```

input sample where it works:

```
<root> 
    <library id="L1">
        <genre id="a">
            <shelf1 id="1">                
                <book id="1" action="borrow">
                    <attributes>
                        <user>John</user>                    
                    </attributes>
                    <other1>y</other1>
                </book>  
                <book id="1" action="extend">
                    <attributes>
                        <user>Woo</user>           
                        <length>3</length>
                    </attributes>
                    <other2>y</other2>
                </book>  
                <book id="1" action="extend">
                    <attributes>
                        <length>2</length>
                        <condition>ok</condition>
                    </attributes>
                    <other3>y</other3>
                </book>
                <book id="2" action="extend">
                    <attributes>
                        <length>99</length>
                        <condition>not-ok</condition>
                    </attributes>
                    <other>y</other>
                </book>
            </shelf1>
            <shelf1 id="b">...
            </shelf1>

        </genre>
        <genre id="b">...
        </genre>
    </library>
</root> 
```

If I change the id of the book to `1a`:

```
<root> 
    <library id="L1">
        <genre id="a">
            <shelf1 id="1">                
                <book id="1a" action="borrow">
                    <attributes>
                        <user>John</user>                    
                    </attributes>
                    <other1>y</other1>
                </book>  
                <book id="1a" action="extend">
                    <attributes>
                        <user>Woo</user>           
                        <length>3</length>
                    </attributes>
                    <other2>y</other2>
                </book>  
                <book id="1a" action="extend">
                    <attributes>
                        <length>2</length>
                        <condition>ok</condition>
                    </attributes>
                    <other3>y</other3>
                </book>
                <book id="2" action="extend">
                    <attributes>
                        <length>99</length>
                        <condition>not-ok</condition>
                    </attributes>
                    <other>y</other>
                </book>
            </shelf1>
            <shelf1 id="b">...
            </shelf1>

        </genre>
        <genre id="b">...
        </genre>
    </library>
</root> 
```

My Error Output: (it doesn't merge at all)

```
<root> 
    <library id="L1">
        <genre id="a">
            <shelf1 id="1">                
                <book id="a1" action="borrow">
                    <attributes>
                        <user>John</user>                    
                    </attributes>
                    <other1>y</other1>
                </book>  
                <book id="a1" action="extend">
                    <attributes>
                        <user>Woo</user>           
                        <length>3</length>
                    </attributes>
                    <other2>y</other2>
                </book>  
                <book id="a1" action="extend">
                    <attributes>
                        <length>2</length>
                        <condition>ok</condition>
                    </attributes>
                    <other3>y</other3>
                </book>
                <book id="2" action="extend">
                    <attributes>
                        <length>99</length>
                        <condition>not-ok</condition>
                    </attributes>
                    <other>y</other>
                </book>
            </shelf1>
            <shelf1 id="b">...
            </shelf1>

        </genre>
        <genre id="b">...
        </genre>
    </library>
</root> 
```

Expected Output:

```
<root> 
    <library id="L1">
        <genre id="a">
            <shelf1 id="1">                
                <book id="1a" action="borrow">
                    <attributes>
                        <user>Woo</user>           
                        <length>2</length>
                        <condition>ok</condition>                  
                    </attributes>
                    <other1>y</other1>
                </book>  
                <book id="2" action="extend">
                    <attributes>
                        <length>99</length>
                        <condition>not-ok</condition>
                    </attributes>
                    <other>y</other>
                </book>
            </shelf1>
            <shelf1 id="b">...
            </shelf1>

        </genre>
        <genre id="b">...
        </genre>
    </library>
</root> 
```

For every node with action=borrow followed by one or more node with action=extend

*   Merge it together to the node with action=borrow.

*   Merge the attributes children together such that it will have all the unique attributes from the siblings with the latest value.

*   leave other children unchanged

****THe merging only happen with node that has the same id.****

 **Thanks. Regards, John

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:32:19.100

也许您遇到了上下文问题。比较应该有效。这是一个例子......

**XML 输入**

```
<tests>
    <test>
        <elem id="1"/>
        <elem id="1"/>
    </test>
    <test>
        <elem id="AAA"/>
        <elem id="AAA"/>
    </test>
    <test>
        <elem id="BBB"/>
        <elem id="CCC"/>
    </test>
    <test>
        <elem id="2"/>
        <elem id="3"/>
    </test>
</tests> 
```

**XSLT 2.0**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="@*|node()">
        <xsl:apply-templates select="@*|node()"/>
    </xsl:template>

    <xsl:template match="elem[1]">
        <xsl:text>Comparing id </xsl:text>
        <xsl:value-of select="concat('&quot;',@id,'&quot;&#xA;')"/>
        <xsl:value-of select="concat('&#x9;',
            boolean(following-sibling::*[@id=current()/@id]),
            '&#xA;')"/>
    </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
Comparing id "1"
    true
Comparing id "AAA"
    true
Comparing id "BBB"
    false
Comparing id "2"
    false 
```

* * *

**编辑**

在查看您更新的示例之后，它肯定看起来像一个上下文问题。看一下模板的开头：

```
<xsl:template match="genre/*">
        <xsl:copy>
            <xsl:apply-templates select="@*" />

            <xsl:apply-templates select="
     book[@id=current()/@id][@action='extend']                             
         [not( preceding-sibling::book[@id=current()/@id][@action='borrow'])]" /> 
```

注意匹配是`genre/*`; 这就是当前的情况。有了您的输入，这将是`shelf1`. 然后第二个的选择`xsl:apply-templates`以`book[@id=current()/@id]`. 对我来说，这看起来像是在选择`book`它是否具有`id`等于的`id`属性`shelf1`。要对此进行测试，您还可以将 of 更改`id`为`shelf1`，`1a`它可能会起作用。（这就是第一个示例有效的原因；`id`of`shelf1`和`book`match。

我现在无法测试这个理论，但我认为这就是比较不起作用的原因。（它正在工作，你只是没有比较你认为你正在比较的东西。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:26:10.063

字符串比较不需要显式的字符串转换。换句话说，它应该像你写的那样工作。这是一个例子：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="elem">
    <xsl:if test="count(../elem[@id=current()/@id]) &gt; 1">
      <xsl:value-of select="@id"/>: has dup
    </xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

应用于此输入时：

```
<r>
    <elem id="AAA">one</elem>
    <elem id="AAA">two</elem>
    <elem id="ZZZ">three</elem>
</r> 
```

产生以下输出：

```
AAA: has dup
AAA: has dup 
```

从[XPath 规范](http://www.w3.org/TR/xpath/#booleans)：

> 否则，如果至少一个要比较的对象是一个数字，则每个要比较的对象都被转换为一个数字，就好像通过应用 number 函数一样。否则，两个要比较的对象都被转换为字符串，就好像通过应用字符串函数一样。**

# mule - 在 Mule Flow 中自定义过滤器后返回不同的响应

> ID：11509616
> 
> 赞同：0
> 
> 时间：2012-07-16T17:42:14.400
> 
> 标签：mule

这似乎是一件很常见的事情，但我无法弄清楚如何让它发挥作用。我为具有入站 http 端点的请求-响应流编写了一个自定义过滤器。自定义过滤器检查某些必需的查询参数是否存在并包含有效值。如果过滤器拒绝消息，我想返回一个 HTTP 错误状态代码，但我不知道如何发送不同的响应。

Mule 文档说：

> 如果流上定义的入站端点具有请求-响应交换模式并且流中没有响应块，则使用的响应只是流中最后一个消息处理器的结果，它将为空。

我不确定这是否完全准确。我的流程确实有一个`<response>`块，但如果我的自定义过滤器返回 false，它不会被调用。

如果过滤器拒绝消息，返回不同响应的最佳方法是什么？

这是我的流程示例：

```
<flow name="Incoming_requests">
    <http:inbound-endpoint exchange-pattern="request-response" host="localhost" port="8081" path="incoming" />

    <http:body-to-parameter-map-transformer />

    <custom-filter class="com.mycompany.MyQueryParamFilter"/>

    <!--  Process valid messages here -->

    <response>
       <!--  Return a successful response  -->
    </response>
</flow> 
```

编辑：这是推断`<response>`将执行块的文档。 [http://www.mulesoft.org/documentation/display/MULE3USER/Using+Filters#UsingFilters-UsinginFlows](http://www.mulesoft.org/documentation/display/MULE3USER/Using+Filters#UsingFilters-UsinginFlows)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:41:29.707

在您的情况下使用[选择路由器](http://www.mulesoft.org/documentation/display/MULE3USER/Routing+Message+Processors#RoutingMessageProcessors-Choice)会更好：

```
<choice>
  <when expression="...validation expression...">
    <!--  Process valid messages here -->
    <!--  Return a successful response  -->
  </when>
  <otherwise>
    <!--  Return a failure response  -->
  </otherwise>
</choice> 
```

如果位于 末尾，则不需要任何`response`元素。`choice``flow`

# php - 如何从 GET 提交中删除特殊字符

> ID：11509621
> 
> 赞同：1
> 
> 时间：2012-07-16T17:42:35.817
> 
> 标签：php, html, post, get, sanitize

我有一个 Web 脚本的特殊字符问题，该脚本执行命令以将用户名发送到我的游戏服务器以奖励他们进行投票。

`<form action="index.php" method="GET"> <input type="submit" value="Submit" /> </form>`

它使用正确的特殊字符和所有信息向数据库提交 - 但是当执行到我的游戏服务器时，它会否定特殊字符，他们可以通过使用名称 Testusername/ 或 Testusername// 来滥用它，并每天获得多个奖励。

我曾尝试使用隐藏类型，但我的系统无法使用 POST。

有任何想法吗？我很无奈。

****编辑*******

 **任何 0-9 _ az 字符都允许特殊字符为 !@#$%^&*()_+[}{} 等。我正在使用转义字符串，我不担心 sql 注入我尝试了多种清理方法和他们都失败了。我正在使用 mySQL，但不是为了发送奖励，它作为日志存在并验证过去 24 小时内未投票的用户并阻止他们再次投票。基本上说清楚，他们用用户名 Test 投票并获得奖励并用用户名 Test/ 投票，它说 Test 在游戏中再次投票并获得 x2 奖励

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:15:26.500

简单`preg_replace`应该这样做：

```
$username = preg_replace('#[^a-z0-9_]#', '', $username); 
```

这剥离了所有内容，但：

*   小写字母字符
*   数字 0 到 9
*   下划线

如果大写是可以的，那么添加`A-Z`到正则表达式，或者可能`strtolower()`是预先输入。在保存输入或将其发送到其他服务器之前执行此操作。

我有点不确定您对游戏服务器的确切困境，但理想情况下，您应该从另一台服务器获得响应，以便在保存之前查看实际输入的用户名，并且您根本不必过滤它因为您将获得来自另一台服务器的过滤值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:11:31.480

像这样的东西应该可以工作..只需用所有坏字符填充 bad_chars 数组......

```
array $bad_chars = array('@', '!', '#'); // setup your chars to filter out

for($i = 0; $i < size_of($bad_chars); $i++) // iterate through them all
{
     str_replace($bad_chars[i], '', $_GET['string_to_be_filtered']); // replace all
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:18:58.340

由于您只想替换斜线，因此可以使用它。

```
<?php 
$user = $_GET["user"];
$user = str_replace("/", "", $user);
?> 
```

这是在我之前的另一篇文章的更有效版本：

```
<?php 
$user = $_GET["user"];
$special = array('@', '!', '#'); 
$user = str_replace($special, "", $user);
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:23:30.923

您可以替换以下内容以隐藏特殊字符

```
$formdesc = htmlentities($_POST['formdesc'], ENT_QUOTES, 'UTF-8'); 
```

希望这对你有帮助**

# hadoop - Retrieve a changed variable from a map/reduce task in hadoop

> ID：11509624
> 
> 赞同：0
> 
> 时间：2012-07-16T17:42:45.040
> 
> 标签：hadoop, global-variables

I have a global boolean variable that controls a loop in the main function to determine whether or not to start over. The decision is made in a reduce where the variable is set to true if a condition is met. Then in the main, if the condition is met it runs the entire program again. This works on one machine but when I try to run it on Amazons EC2 it does not loop through.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:30:24.463

问题在于，在 EC2 上，您以真正的分布式模式运行（多台机器，每台机器运行自己的 JVM），而在您的机器上，您以独立模式（仅使用 1 个 JVM）运行。

当您在您的机器上运行作业时，hadoop 框架会在同一个 JVM 中运行客户端（所谓的驱动程序）、map 任务和 reduce 任务。因此，您的 reduce 函数和 main 将能够使用 SAME 全局变量。（附带说明，我认为这个全局变量应该是静态的，因为 hadoop 框架可能会为客户端、映射、reduce 执行创建多个对象。如果您没有将其设为静态并且它仍然可以在您的机器上运行，则意味着它使用同一个对象）。

当您在 EC2 上运行作业时，您将在不同的 JVM 中运行客户端、map 任务和 reduce 任务。因此，reducer 将修改驻留在当前 JVM 中的对象的“全局”变量，因此运行客户端的 JVM（在驻留在其 JVM 中的对象中拥有自己的全局变量版本）将看不到所做的修改由减速器到“全局”变量。

请注意 global 周围的引号。它们表示变量并不像您期望的那样全局。

您可以将变量从减速器传递回驱动程序（主类），方法是将该变量的值写入文件并将该文件放在分布式缓存中，或者将变量的值写入作业的输出中（ part-r-xxxx 文件），以防您可以将其与实际输出/有效负载分开。

在这两种情况下，驱动程序都可以从缓存中检索文件，也可以从作业的输出目录中检索输出文件。读入变量的值，并在此基础上做出决定。

如果您想计算有多少减速器达到特定状态。您可以使用用户定义的计数器（当达到该状态时，每个 reducer 将递增该计数器），您可以在映射器中对其进行解释。可以使用 Mapper.Context/Reducer.Context 的 getCounter() 方法通过其名称访问计数器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T17:58:21.690

我最终用计数器做了这个，它不那么漂亮，但它有效。我创建了两个变量 cnt 和 cnt1。如果满足条件，我使用计数器递增。cnt 保存上次循环作业时的计数 cnt1 在作业后更新，如果它们相同，则不会再次循环。这最终会额外运行所有作业一次，但它会提供正确的输出。

谢谢您的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:24:28.927

正如 Razvan 所提到的，您的 map reduce 作业中不能有全局变量，因为您的代码在多台机器（分布式）上并行运行。服务器 A 上的 reduce 作业（并且必须用于 MapReduce）完全独立于机器 B 上运行的代码。在重新启动之前，您必须等待作业完成（成功与否）。如果您可以等待完成，您可以在配置中设置一个变量或使用服务器计数器作为您的“全局变量”，并在作业停止时引用它。如果您使用的是 HBase，您可以在 HBase 中设置一个值并根据需要读取它的作业完成情况。

除非您已经设置好 HBase，否则您的情况可能会让 HBase 有点矫枉过正。

要设置配置，请在主驱动程序函数中执行以下操作：

```
conf.set("variableName",variableValue); 
```

要访问 Mapper 或 Reducer 中的配置：

```
Configuration conf = context.getConfiguration();
String variableValue = conf.get("variableName"); 
```

请注意，每个 mapper 或 reducer 都不会看到另一个 mapper 或 reducer 对变量所做的任何更改。我不确定您是否甚至想在映射器或减速器中修改 conf 变量——这可能不是最佳实践。

对于计数器，您可以在映射器或减速器中执行以下操作（将计数器增加 1）：

```
context.getCounter("counterName").increment(new Long(1)); 
```

当您的 MR 工作完成后，您可以通过以下方式引用计数器：

```
Counters counters = job.getCounters();
Counter counter = counters.findCounter("counterName");
long cntVal = counter.getValue(); 
```

同样，您只能在 MR 作业完成后信任您的计数器值，而不是在 MR 作业运行时。

# javascript - Extending Audio / HTMLMediaElement javascript object

> ID：11509626
> 
> 赞同：3
> 
> 时间：2012-07-16T17:42:47.227
> 
> 标签：javascript, google-chrome-extension, html5-video, html5-audio

I need to extend the Audio object to provide a stop function. Normally this code would work:

```
Audio.prototype.stop = function() {
    this.pause();
    this.currentTime = 0;
} 
```

However, I need this to happen from within a content script of a Chrome Extension, and as the contexts are separate the change does not propagate to the other context.

I have tried using [this `unsafeWindow` hack](https://gist.github.com/1143845) to attempt to break out of the isolated environment, with no success, as well as attempting to use Object.create and set the `constructor` property.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:03:07.857

内容脚本有一个独立的执行环境，但它与页面共享 DOM。您可以通过在 DOM 中添加标签来在页面的*实际*执行环境中运行脚本：`<script>`

```
var s = document.createElement("script");
s.innerText = "Audio.prototype.stop = function() { this.pause(); this.currentTime = 0; }";
document.documentElement.appendChild(s); 
```

我相信这段代码将在两个执行环境中运行脚本（或者，至少它应该在页面环境中运行）。

请注意，此解决方案只能在资源加载期间或之后运行脚本，而不是在 DOM 完成后立即运行，因为它需要浏览器处理添加到页面的新脚本资源。对于您当前的需求，这应该不是问题。

# unix - 如何将标题和数据放入 Tar 文件格式？

> ID：11509627
> 
> 赞同：1
> 
> 时间：2012-02-13T14:51:08.327
> 
> 标签：unix, tar

我正在尝试编写一个纯 C++ tar 文件操作库。是否可以简单地将 tar 标头放在数据后面，中间没有什么特别的，我浏览了 Wikipedia 和 gnu 站点，并提出了我需要的一切，除了一些东西，包括这个。我正在尝试使用（新的？）ustar 格式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-02-13T15:07:30.803

BSD [tar(5)](http://www.freebsd.org/cgi/man.cgi?query=tar&sektion=5)手册页可以被认为是权威的。

相关：[libarchive-formats(5)](http://www.freebsd.org/cgi/man.cgi?query=libarchive-formats&sektion=5)、[cpio(5)](http://www.freebsd.org/cgi/man.cgi?query=cpio&sektion=5)、[libarchive](http://libarchive.github.com/)库，您可以为其编写 C++ 包装器

# java - 如何分配小程序

> ID：11509634
> 
> 赞同：1
> 
> 时间：2012-07-16T17:43:11.863
> 
> 标签：java, applet

按照本[教程](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/signed.html)，我在第 7 步，我不明白该怎么做`PolicyTool`。我需要它来在我的应用程序中分配我的小程序，因为当我运行我的小程序时，我收到了`SecurityException`以下错误消息：

```
Could not open file policy C:\Program Files\Java\jdk1.7.0_05\bin\raystore: 
sun.security.provider.PolicyParser$ParsingException line 1: expected [;] found[pípí] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:50:33.733

> 这是一个文件，其内容显然会导致问题：C:\Program Files\Java\jdk1.7.0_05\bin\raystore

生成密钥时

```
keytool -import -alias company -file 
        CompanyCer.cer -keystore 
    raystore -storepass abcdefgh 
```

仔细检查它是否确实在同一位置生成了一个文件。

然后，

```
keystore "/home/ray/raystore"; // make sure you reference the path to the key you generated in the previous step

// A sample policy file that lets a program 
// create demo.ini in user's home directory
// Satya N Dodda

grant SignedBy "company" {
  permission java.util.PropertyPermission 
    "user.home", "read";
  permission java.io.FilePermission 
    "${user.home}/demo.ini", "write";
}; 
```

**编辑：**

生成密钥

```
keytool -genkey -keystore mykeys -storepass abc123 
```

标志罐

```
jarsigner -keystore mykeys -storepass abc123 app.jar johndoe 
```

> [http://docs.oracle.com/javase/tutorial/deployment/jar/signing.html](http://docs.oracle.com/javase/tutorial/deployment/jar/signing.html)

# c - 通过一次仅更改一个字母将一个单词转换为另一个单词

> ID：11509636
> 
> 赞同：1
> 
> 时间：2012-07-16T17:43:16.507
> 
> 标签：c, algorithm, graph

我将如何处理这个算法问题？

> 给定字典中长度相等的两个单词，编写一个方法，通过一次仅更改一个字母将一个单词转换为另一个单词。你每一步得到的新词必须在字典里。

例子：

```
Input: DAMP, LIKE
Output: DAMP -> LAMP -> LIMP -> LIME -> LIKE 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T17:48:01.813

[试着用图](http://en.wikipedia.org/wiki/Graph_%28mathematics%29)来思考这个问题：将字典中的所有单词视为顶点，并在每两个仅相差一个字母的顶点之间插入一条边。输出是图中众所周知的对象，您可能已经知道解决问题的算法。

**剧透**：

> 输出是图中的一条路径，通过寻找路径来解决问题。[广度优先搜索](http://en.wikipedia.org/wiki/Breadth-first_search)(BFS) 或[Dijkstra 算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)可以优雅地解决问题。

# spring - Spring Tomcat 应用程序中的 NoSuchMethodError

> ID：11509641
> 
> 赞同：1
> 
> 时间：2012-07-16T17:43:31.003
> 
> 标签：spring, tomcat, maven, nosuchmethoderror

我正在尝试实现一个新的安全 bean，它依赖于一些 Base64 编码。在eclipse中，这个类编译得很好，事实上，它在部署到tomcat时构建，在本地运行；但是，当代码实际到达它调用的行时

```
Base64.encodeBase64String(rawBytes) 
```

我明白了

```
SEVERE: Servlet.service() for servlet analytics threw exception
java.lang.NoSuchMethodError: org.apache.commons.codec.binary.Base64.encodeBase64String([B)Ljava/lang/String; 
```

我已经注意导入我想要的类型（org.apache.commons.codec.binary.Base64）并尝试更改调用以使用方法的绝对包名称。

当我检查项目的 pom.xml 时，我看到存在以下内容，并且它是正确的工件，根据 apache 站点：

```
 <dependency>
        <groupId>commons-codec</groupId>
        <artifactId>commons-codec</artifactId>
    </dependency> 
```

查看 Eclipse 中的依赖层次结构视图，commons-codec jar 包含在 1.4 版的编译时（其中包含有问题的类）。

这里有一个类似的问题建议清除 tomcat 工作目录，所以我这样做无济于事。我不是 maven 或 tomcat 的专家，所以任何建议都会有所帮助。我知道这是一个非常具体的问题，所以我发布这个是希望得到一些线索，并向自己澄清这个问题。不过，我会接受任何指向正确方向的答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:46:54.807

尝试使用该库的最新版本：

```
<dependency>
    <groupId>commons-codec</groupId>
    <artifactId>commons-codec</artifactId>
    <version>20041127.091804</version>
</dependency> 
```

# java - 在 AsyncTask onPostExecute 中动态添加按钮

> ID：11509642
> 
> 赞同：1
> 
> 时间：2012-07-16T17:43:34.577
> 
> 标签：java, android, android-asynctask, android-button, dynamically-generated

我正在尝试`Button`在`onPostExecute`. `AsyncTask`我在扩展的类中执行此操作`Fragment`。我可以使用此代码动态创建一个`Button`外部`AsyncTask`：

```
public class Tab2Fragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, 
            Bundle savedInstanceState) 
    {
        LinearLayout theLayout =  (LinearLayout) inflater.inflate(R.layout.tab2, container, false);
        Context mFragmentContext=getActivity().getApplicationContext(); 
        Button btn=new Button(mFragmentContext);
        btn.setText("Hello Button");
        RelativeLayout.LayoutParams paramsd = new RelativeLayout.LayoutParams(150,30);
        paramsd.height = paramsd.WRAP_CONTENT;
        paramsd.width = paramsd.WRAP_CONTENT;
        btn.setLayoutParams(paramsd);
        theLayout.addView(btn); 

        Button test = (Button)theLayout.findViewById(R.id.test41);
        test.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Log.v("response", "Button Clicked");
                new loadSomeStuff().execute();
                Intent log = new Intent();
                log.setClass(getActivity(), Assignment.class);
                startActivity(log);
            }
        });

        return theLayout;
    }

    // Method to load stuff using async task. Grabs information from URL and
    // calls read stream
    public class loadSomeStuff extends AsyncTask<String, Integer, String> {
        protected String doInBackground(String... arg0) {
            try {
                int limit = 100;
                String accessToken = "";
                URL url = new URL( "SomeSite" + accessToken 
                            + "&status=active" + "&limit=" + limit);
                HttpURLConnection con = (HttpURLConnection) url.openConnection();
                con.setRequestProperty("Accept", "application/json");
                readStream(con.getInputStream());
            } catch (Exception e) {
                e.printStackTrace();
            }

            return null;
        }

        protected void onPostExecute( String result )  {
            super.onPostExecute(result);

            Context mFragmentContext=getActivity().getApplicationContext(); 
            Button btn=new Button(mFragmentContext);
            btn.setText("Hello Button");
            RelativeLayout.LayoutParams paramsd = new RelativeLayout.LayoutParams(150,30);
            paramsd.height = paramsd.WRAP_CONTENT;
            paramsd.width = paramsd.WRAP_CONTENT;
            btn.setLayoutParams(paramsd);
            //theLayout.addView(btn); 

            Log.v("response", "on post biatch");
        }
    }

    // Processes information from URL and prints it in format
    private void readStream(InputStream in) throws JSONException {
        BufferedReader reader = null;
        try {
            reader = new BufferedReader(new InputStreamReader(in));

            String line = reader.readLine();
            String total_results = new JSONObject(line).getJSONObject(
                "response").getString("total_results");
            int assignCount = Integer.parseInt(total_results.toString());
            Log.v("response", total_results);
            JSONObject data;

            for (int i = 0; i < assignCount; i++) {
                data = new JSONObject(line).getJSONObject("response");
                String id = data.getJSONArray("data").getJSONObject(i).getString("id");
                String title = data.getJSONArray("data").getJSONObject(i).getString("title");
                Log.v("response", title);

            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            if (reader != null) {
                try {
                    reader.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }

} 
```

问题是，当我尝试将此代码放入`onPostExecute`of 时`AsyncTask`，`addview(btn)`行有错误，因为`Layout`未定义。我不知道如何通过`Layout`. `Layout`有没有办法通过某种内置方法来获取活动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:57:20.427

你为什么不给你的`loadSomeStuff`类添加一个构造函数？在构造函数上，传递`View`要添加`Button`到的 。

```
public class loadSomeStuff extends AsyncTask<String, Integer, String> {
    private View view;

    public loadSomeStuff(View v) {
        view = v;
    }

    public String doInBackground(String... strings) {
       //...
    }

    public void onPostExecute(String result) {
        //...
        view.addView(btn);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:41:22.857

您可以使用`Handler; add the following to the main`Activity`：

```
private Handler handler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        switch(msg.what) {
        case 0:
            Context mFragmentContext=getActivity().getApplicationContext(); 
            Button btn=new Button(mFragmentContext);
            btn.setText("Hello Button");
            RelativeLayout.LayoutParams paramsd = new RelativeLayout.LayoutParams(150,30);
            paramsd.height = paramsd.WRAP_CONTENT;
            paramsd.width = paramsd.WRAP_CONTENT;
            btn.setLayoutParams(paramsd);
            // addView(btn) in your LinearLayout
            break;  
        }
    }
}; 
```

通过`Handler`with`AsyncTask`构造函数并在`onPostExecute(String result)`使用`Handler`中如下：

```
public void onPostExecute(String result) {
    Message msg = new Message();
    msg.what = 0;
    handler.sendMessage(msg);
} 
```

您可以在课堂上创建不同的事件`Handler`并使用 选择类型`msg.what`。

希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T03:06:34.167

这对我来说可以以编程方式添加一个 RelativeLayout 并在其中放置一个按钮：

```
RelativeLayout.LayoutParams yourlayout = new RelativeLayout.LayoutParams(
RelativeLayout.LayoutParams.MATCH_PARENT,
RelativeLayout.LayoutParams.WRAP_CONTENT);

yourlayout.addRule(RelativeLayout.ALIGN_PARENT_TOP,anotherview.getId());
yourlayout.addView(yourbutton, yourlayout); 
```

如果您使用动态布局而不是静态 XML，我强烈建议您必须使用 setId() 并为每个视图分配一个唯一的 ID。这是使用其他视图参考定位视图所必需的。

# wpf - 当新值为空时恢复为原始值

> ID：11509643
> 
> 赞同：0
> 
> 时间：2012-07-16T17:43:39.257
> 
> 标签：wpf, binding, mvvm

警告——我是 WPF 的新手。所以我想要做的是在我的 ViewModel 中有一个绑定到字符串属性的文本框。当用户清除文本框时，我希望它自动回到用户最初的状态（当窗口打开时）。基本上我阻止用户清除文本框。

目前，我的 WPF 绑定为 TwoWay，并且我确实将 UpdateSourceTrigger 设置为 PropertyChanged。我想我想保留那个 UpdateSourceTrigger，因为我喜欢我的 ViewModel 中的属性在用户进行一点点更改时得到更新。这样，当用户执行某些操作时，我可以执行其他 UI 操作（例如，更新我的保存按钮，因为用户更改了某些内容）。

我的 ViewModel 中的属性目前看起来像这样，我尝试使用原始值：

```
public string SourceName
{
    get { return this.sourceName; }
    set
    {
        if (!this.sourceName.Equals(value, StringComparison.OrdinalIgnoreCase))
        {
            if (!string.IsNullOrWhiteSpace(value))
                this.sourceName = value;
            else
                this.sourceName = this.configuredSource.Name;

            RaisePropertyChanged("SourceName");
        }
    }
} 
```

我遇到的问题是我认为视图忽略了我的“RaisePropertyChanged”，因为我设置了 UpdateSourceTrigger。如果我取出触发器，那么这可行，但我必须失去对控件的关注才能更新 UI。因此，如果可以的话，为什么我想保留触发器。

如果用户清除文本框，任何人都有一个很好的方法来恢复原始值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:31:53.437

我让它工作。解决方案是将我的属性设置为“dumber”并允许将其设置为空。

```
public string SourceName
{
    get { return this.sourceName; }
    set
    {
        if (!this.sourceName.Equals(value, StringComparison.OrdinalIgnoreCase))
        {
            this.sourceName = value;
            RaisePropertyChanged("SourceName");
        }
    }
} 
```

然后我会有一个 RelayCommand (MVVM Light)，只要文本框上的焦点丢失，就会触发它。

```
public RelayCommand SourceNameLostFocusCommand
{
    get 
    { 
        return new RelayCommand(() => 
            {
                if (string.IsNullOrWhiteSpace(this.SourceName))
                    this.SourceName = this.configuredSource.Title;
            }); 
    }
} 
```

这是我的 xaml 的片段，用于让 RelayCommand 在失去焦点时触发：

```
xmlns:cmd="clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.Extras.WPF4"
xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"

<TextBox Text="{Binding Path=SourceName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
   <i:Interaction.Triggers>
      <i:EventTrigger EventName="LostFocus">
         <cmd:EventToCommand Command="{Binding SourceNameLostFocusCommand, Mode=OneWay}" />
      </i:EventTrigger>
   </i:Interaction.Triggers>
</TextBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:18:12.343

问题不`UpdateSourceTrigger`在于，就 WPF 而言，它传递给您的财产的价值就是它将承担的价值。它会忽略您引发的属性更改事件以避免递归循环。

您需要在单独的消息中引发事件，如下所示：

```
public string SourceName
{
    get { return this.sourceName; }
    set
    {
        if (!this.sourceName.Equals(value, StringComparison.OrdinalIgnoreCase))
        {
            if (!string.IsNullOrWhiteSpace(value))
            {
                this.sourceName = value;
                RaisePropertyChanged("SourceName");
            }
            else
            {
                this.sourceName = this.configuredSource.Name;
                this.dispatcherService.BeginInvoke(() => this.RaisePropertyChanged("SourceName"));
            }
        }
    }
} 
```

这是一种伪代码，因为没有标准方法可以`Dispatcher`从您的 VM 访问 （除非您的 MVVM 框架提供了一种）。我通常将它包装在一个带有漂亮接口的服务中，用于同步和异步调用，如上所示。

无论如何，重点是 WPF 这次会得到事件，因为它在单独的消息中。因此，UI 将反映您的更改。

# sql-server - 使用 Visual Studio 2010 访问 SQL Server 时出错

> ID：11509645
> 
> 赞同：0
> 
> 时间：2012-07-16T17:43:48.467
> 
> 标签：sql-server

尝试在 Visual Studio 2010 中使用服务器资源管理器创建数据库时出现错误。

我检查了 SQL Server 配置管理器，发现 SQL 服务没有运行，但是当我尝试启动它时；它没有开始:(

请指导我解决这个问题，我发现我可能已经禁用了运行 SQL Server 所需的一些 Windows 服务（在几个月前安装它后优化 WinXP 时）。

截图1：

![在此处输入图像描述](../Images/10c517bba99a4bffcd911e45ffb7fece.png)

截图2：

![在此处输入图像描述](../Images/139db3d27c44dafda0e5925ade6acc6d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:19:55.547

从错误中可以清楚地看出您的 SqlServerExpress 主数据库文件已损坏。

由于这是新安装，最好卸载并重新安装 SqlServerExpress。

如果您有 SqlServer 的副本，安装它也可以解决问题。

如果不想重新安装，可以重建master数据库。

从[如何重建主数据库](http://msdn.microsoft.com/en-us/library/ms143269.aspx)：

> 在此 Microsoft SQL Server 版本中，使用 Setup 命令重建 master 数据库已更改。运行 Setup.exe 以重建、验证和修复 SQL Server 实例，并重建系统数据库。此过程最常用于为损坏的 SQL Server 安装重建主数据库。

# c++ - 使用 GL Load 时未声明 GLenum 和 GLint

> ID：11509646
> 
> 赞同：0
> 
> 时间：2012-07-16T17:43:48.803
> 
> 标签：c++, opengl

像这样的东西不会编译，因为`GLenum`并且`GLint`没有在命名空间中声明`gl`：

```
#include <glload/gl_3_3.hpp>
#include <glload/gll.hpp>

void foo(gl::GLenum, gl::GLint); 
```

我如何使用`GLenum`GL `GLint`Load？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:46:18.157

从这个[链接](http://glsdk.sourceforge.net/docs/html/group__module__glload.html "关联")看来你只需要做`GLuint`而不是`gl::GLuint`. 我会假设这也是这种`GLenum`情况`GLint`。

# database - 我应该如何拆分数据库？

> ID：11509651
> 
> 赞同：2
> 
> 时间：2012-07-16T17:43:57.613
> 
> 标签：database, database-design

我有一个需要存储客户数据的数据库，我试图找出我需要哪些表。到目前为止，我在想这样的事情：

客户表：

*   ID
*   公司名称
*   名
*   姓
*   笔记
*   电话
*   替代电话

地址表：

*   第1行
*   线2
*   镇
*   邮政编码

站点表（需要完成工作的物理站点）

*   网站名称
*   笔记

一个客户将有 1 个联系地址和 1 个以上的站点地址。这两个地址可能相同（如果客户使用公司地址作为联系人）。但是，有时联系地址与站点地址不同。

我需要两个地址表吗？一个用于客户地址，一个用于站点？电话也应该是一个单独的表，因为我有时会为每个客户存储 2 个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:51:37.560

您的设计看起来不错，尽管您可能希望在地址和站点中添加一个 id。我不确定您是否要在客户表中使用电话，除非您限制他们可以拥有的号码数量。站点是否需要地址（我只问是因为我不确定它是物理站点还是网站）？我提出这个是因为它会影响设计。如果与地址相关联的唯一实体是客户，那么在地址中有一个 customer_id 是有意义的。但是，如果地址在客户之间共享，或者在站点表中使用，那么我会为它制作连接表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:31:47.877

您提到用户可以拥有的电话号码数量是可变的。在这种情况下，我不会像您现在那样对拥有两个电话号码的客户进行硬编码。拥有一个单独的电话号码表将使这更加灵活。

电话表：

*   客户 ID（外键）
*   电话号码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:53:41.317

如果您有 Customer 表和 Site 表，您可以在其中引用 Address 表。

这将允许您为客户和站点使用相同的地址或不同的地址。请注意，更新地址将同时更新客户和站点的地址。

客户表：

*   ID
*   公司名称
*   名
*   姓
*   笔记
*   电话
*   替代电话
*   地址 ID（外键）

网站表：

*   ID
*   网站名称
*   笔记
*   地址 ID（外键）

地址表：

*   ID
*   第1行
*   线2
*   镇
*   邮政编码

至于电话号码，该表已经可以处理 2 个电话号码。你的意思是他们会有2个主号码，然后交替？

# regex - 最严格的正则表达式

> ID：11509653
> 
> 赞同：0
> 
> 时间：2012-07-16T17:44:05.113
> 
> 标签：regex

假设我有几个正则表达式：

expr_1：“test_file”

expr_2：“test_*”

expr_3：“测试*”

所有这些都匹配字符串“test_file”。如何在程序中确定哪个规则是最严格的规则（在本例中为 expr_1 ）？

我想要达到的目标：

我有一个适用于很多文件的一般规则，但对于 .jpeg 文件为例，我想做一个特殊的操作。例如，如何确定选择“.jpeg”文件的规则比“*”规则更严格？

编辑：我正在使用 Qt 中的 QRegExp，但这不应该改变任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:49:08.087

这是基于语言理论解决该问题的正确方法：

计算作为所有其他正则表达式的“与”或“组合”的正则表达式。您可以将所有正则表达式转换为 DFA，然后您可以创建所有自动机的交集，这将为您提供一个新的 DFA，它只接受所有三个正则表达式都接受的东西。然后您还可以最小化自动机，并将其转换回正则表达式。如果你这样做，你将得到一个正则表达式，它与所有其他正则表达式一样具有限制性，并且是执行此操作的最短正则表达式。

解释如何做到这一切的好书：[自动机理论、语言和计算简介](https://rads.stackoverflow.com/amzn/click/com/0321455363)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:51:42.427

您使用什么语言？

“限制性”的一个很好的衡量标准可能是通过正则表达式运行一组潜在的字符串（在这种情况下是一堆文件名），并查看每个字符串匹配的数量。

# cakephp - CakePHP 2：覆盖 AuthComponent 的“密码”方法

> ID：11509655
> 
> 赞同：10
> 
> 时间：2012-07-16T17:44:09.157
> 
> 标签：cakephp, authentication, passwords

我的目标是为每个用户提供独特的盐，而不仅仅是`Configure::read('Security.salt')`为每个用户使用。

我知道 CakePHP 2.x 不再自动散列密码。这允许我对密码执行模型验证，这非常好。但是，我看不到可以覆盖 AuthComponent 的“密码”方法的方法。因此，即使我可以控制密码在保存到数据库之前的哈希方式，但我无法控制在执行实际登录时密码的哈希方式。来自食谱：

> 在调用 `$this->Auth->login()`.

我该怎么做才能`$this->Auth->login()`使用自定义的密码散列方法？

谢谢。

**更新：**我最终选择了 Hannibal Lecter 博士的答案（创建自定义身份验证对象）。这是如何做到的：

旧代码：

```
$this->Auth->authenticate = array('Form' => array('fields' => array('username' => 'email'))); 
```

新代码（将“表单”更改为“自定义”）：

```
$this->Auth->authenticate = array('Custom' => array('fields' => array('username' => 'email'))); 
```

创建“app/Controller/Component/Auth/CustomAuthenticate.php”并使其如下所示：

```
<?php
App::uses('FormAuthenticate', 'Controller/Component/Auth');

class CustomAuthenticate extends FormAuthenticate {
} 
```

从“lib/Cake/Controller/Component/Auth/BaseAuthenticate.php”复制“_findUser”和“_password”方法并将它们粘贴到“CustomAuthenticate”类中。然后对“_findUser”方法进行如下两处修改：

1.  从“$conditions”数组中删除这一行：`$model . '.' . $fields['password'] => $this->_password($password),`

2.  更改`if (empty($result) || empty($result[$model])) {`为`if (empty($result) || empty($result[$model]) || $result[$model][$fields['password']] != $this->_password($password, $result[$model]['id'])) {`

然后对“_password”方法进行如下两处修改：

1.  `protected function _password($password) {`通过更改为来创建“$id”参数`protected function _password($password, $id) {`

2.  `return Security::hash($password, null, true);`通过更改为来更新盐值`return Security::hash($password, null, Configure::read('Security.salt') . $id);`

最后，更新所有出现的`AuthComponent::password`以使用`Security::hash`与上述相同的逻辑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:38:48.280

您可能可以创建一个[自定义身份验证对象](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#creating-custom-authentication-objects)并随意散列密码。查看[现有的 auth 对象](https://github.com/cakephp/cakephp/tree/master/lib/Cake/Controller/Component/Auth)以大致了解它们的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:28:14.837

您是否考虑过不使用 Auth->login() 调用，而是使用模型中当前实现的代码？(http://api20.cakephp.org/view_source/auth-component#line-506) 你可以重写它以满足你的需要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T12:50:42.037

对于任何想了解为什么对每个密码加盐是散列密码的正确方法的更多信息（带有代码示例），请访问：http: [//crackstation.net/hashing-security.htm](http://crackstation.net/hashing-security.htm)。

也许对这里发布的代码的轻微改进是采纳我刚刚链接到的文章的建议，并生成一个“新的随机盐”......“每次用户创建帐户或更改他们的密码”。

此处发布的实现使用原始 Auth 的硬编码静态 salt 和用户 ID 作为 salt 的组合，这意味着每当用户更改密码时，相同的 salt 都会被重新使用。因此，如果您想遵循本散列指南的建议，您需要在用户每次创建/更改密码时生成一个新的随机盐，并且必须将该唯一盐与散列密码一起存储在用户表中。

您可以使用他们的随机盐生成器：

```
define("PBKDF2_SALT_BYTES", 24);
$salt = base64_encode(mcrypt_create_iv(PBKDF2_SALT_BYTES, MCRYPT_DEV_URANDOM)); 
```

按照惯例，将其存储在 users 表中名为“salt”的新字段中。由于代码已经为您提供了用户 ID，您可以随时根据需要存储/查找盐。

文章中还提到了“慢散列函数”一节，它使用了一种称为“密钥拉伸”的技术，以及如何使用 PBKDF2 或 bcrypt 等标准算法来实现。提供了 PHP 代码示例，可以将其复制并粘贴到您的自定义 Auth 实现中以增加安全性。

CakePHP 开发人员 Mark Story 发表了一篇关于如何 [在 CakePHP 的 Auth 中实现 bcrypt的博客文章](http://mark-story.com/posts/view/using-bcrypt-for-passwords-in-cakephp/)

在评论部分，Mark Story 评论说 CakePHP 2.3 将有一些新的内置特性来生成 bcrypt 哈希。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T17:10:08.533

至少在 cake 2.3 中已经使用了一个独特的盐，即使你的配置值中的盐总是相同的。我不确定这是否适用于旧版本。

您也可以使用 Configure::write("Security.salt", $superAwesomeUserSpecificSalt); 在 User 模型中更改 beforeSave() 函数中的盐值。

# java - 在 doget() 方法中调用 servlet 的 destroy 方法

> ID：11509657
> 
> 赞同：0
> 
> 时间：2012-07-16T17:44:20.623
> 
> 标签：java, jakarta-ee, tomcat, servlets

我想知道会发生什么，如果我在 doget() 方法中调用 servlet 的 destroy() 方法，假设这是我在 doget() 方法本身中的第一个语句。请告知..

我已经在我的应用程序中尝试过，如下所示..

```
public class MyServlet extends HttpServlet
{
public void doGet(HttpServletRequest request,HttpServletResponse response) throws ServletException,IOException
{

     destroy(); //calling destroy

String name=request.getParameter("txtName");
HttpSession ses=request.getSession();
ses.setAttribute("username",name);
response.setContentType("text/html");
PrintWriter out=response.getWriter();
out.println("<html><head><title>Cookie example</title></head><body>");
out.println("welcome,"+name);
out.println("<br><a href=ck>Take a Tour</a></body></html>");
out.close();
}
} 
```

但是我的应用程序运行良好，但仍然请解释我的逻辑，因为我仍然不清楚。

请告知需要编写哪段代码，我想覆盖 destroy() 以便在执行它时 servlet 立即被销毁

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:28:05.877

这当然完全取决于您的实施。如果你没有覆盖它，那么它几乎什么都不做，因为在 HttpServlet 中销毁的实现是空的。结果应用程序继续正常运行。

也许对destroy方法的目的有些混淆。**目的不是 servlet 容器提供一些破坏 servlet 的方法**。

**相反，它使您可以提供一些代码，这些代码将在容器调用 destroy 方法时执行。**在某些情况下，当容器决定删除 servlet 时，需要清理资源（例如关闭数据库连接）。容器可以非常独立地删除 servlet：例如，如果它内存不足。方法`destroy`将作为删除的一部分被调用。

如果您的目标是销毁 servlet 实例，那么 destroy 方法不是正确的工具。再一次，对destroy 的调用是删除servlet 实例的一部分，而不是删除的原因。正确的工具是从 doGet 抛出[UnavailableException](http://docs.oracle.com/javaee/6/api/javax/servlet/UnavailableException.html)（这里不需要销毁方法）。正如[Javadoc](http://docs.oracle.com/javaee/6/api/javax/servlet/UnavailableException.html#UnavailableException%28java.lang.String%29)中所说，无参数构造函数会创建这样一个实例，表明 servlet 永久不可用。此外，容器任务对此做出反应，如 servlet 规范中所述：

> 如果 UnavailableException 指示永久不可用，则 servlet 容器必须从服务中删除 servlet，调用其 destroy 方法，并释放 servlet 实例。任何因该原因被容器拒绝的请求都必须返回一个 SC_NOT_FOUND (404) 响应。

# c# - 如何在 .NET 应用程序中运行 Windows 命令提示符？

> ID：11509659
> 
> 赞同：-2
> 
> 时间：2012-07-16T17:44:26.260
> 
> 标签：c#, .net

我正在制作一个 .NET 应用程序，我需要在该应用程序中运行 Windows 命令提示符。

这可能吗？如果是，那怎么办？

我需要制作如下图所示的东西：

[http://imgur.com/4sEen](http://imgur.com/4sEen)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:54:49.100

看一下 System.Diagnostics.Process 类。使用此类启动 cmd 并重定向 Streams。然后你可以画一个白色字体的位图并展示给用户。

无论如何，就像 Ramhound 一样，我会直接显示命令提示符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:52:44.470

使用[`Process.Start`](http://msdn.microsoft.com/en-us/library/53ezey2s.aspx)：

```
Process.Start("cmd.exe"); 
```

# javascript - 在 Express.js 中使特定目录可浏览

> ID：11509660
> 
> 赞同：2
> 
> 时间：2012-07-16T17:44:28.180
> 
> 标签：javascript, node.js, express, connect

我有一个目录，其中包含一些我想在浏览器中查看的图像。

该目录位于我的服务器上 /public/images

在 /public 内，我还有其他不想公开的目录，因此使整个 /public 目录可见并不是解决方案。

如何使用连接目录中间件使我的 /public/images 可浏览？

使用[此处](https://stackoverflow.com/questions/6294186/express-js-any-way-to-display-a-file-dir-listing)描述的解决方案使 /public 中的所有内容都可见，并且尝试以下方法不起作用：

```
 app.use(exp.static(__dirname + '/public'));
    app.use(exp.static(__dirname + '/public/images'));
    app.use(exp.directory(__dirname + '/public/images')); 
```

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T09:54:27.513

您必须将路线安装到特殊路径，例如

```
app.use('/', exp.static(__dirname + '/public'));
app.use('/images', exp.static(__dirname + '/public/images'));
app.use('/images',exp.directory(__dirname + '/public/images')); 
```

这样，您可以使用 url / 访问 /public 的内容，使用 /images 访问 /public/image 的内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-16T17:53:56.807

快递4：

```
npm install serve-index 
```

--

```
var serveIndex = require('serve-index');

app.use('/images', express.static(__dirname + '/public/images'), serveIndex(__dirname + '/public/images')); 
```

# html - 在样式上调用 onclick 按钮

> ID：11509662
> 
> 赞同：0
> 
> 时间：2012-07-16T17:44:40.747
> 
> 标签：html

我很好奇是否可以在样式上调用我的 onclick 功能。

例如：

```
<a style="margin-right: 10px; onclick=\"return confirm("Confirm?") href=""  title="Confirm" ><img src="Confirm.png" alt="Confirm" /></a> 
```

我想在这里调用我的 onclick 事件，可以吗？它可以引用下一页，但不能引用 onclick 功能。好心提醒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:46:43.227

不，但是如果您要将这种样式分配给一个类，您可以在课堂上调用它。

# ruby-on-rails - 更快的heroku推送

> ID：11509663
> 
> 赞同：3
> 
> 时间：2012-07-16T17:44:43.647
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, deployment, heroku

我们正在使用带有rails的heroku，推送总共需要将近2分钟。

我假设大部分时间都花在编译 slug、资产预编译和捆绑安装上。

关于如何使这更快的任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:27:14.470

删除所有未使用的 .coffe 和 .scss 资产。

即使是一个空文件也可以增加 10/20ms 到资产预编译时间。此外，更喜欢 sprockets'`//=require`而不是 sass' `@import`，它要快得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T10:59:51.137

要减少捆绑时间，请在更新捆绑包后在本地运行以下命令：

```
bundle package 
```

或者，也包括从 git 源获得的 gem：

```
bundle package --all 
```

然后，将您的供应商/缓存目录提交到您的存储库。当你部署时，这将导致 Heroku 使用你的 vendor/cache 目录中的 gem，而不是从你的 Gemfile 中下载所有的 gem。

这将节省一点时间，并且在尝试加快部署速度时每一点都有所帮助。

# c - 在 C shell 程序中从 system() 更改为 execvp()

> ID：11509664
> 
> 赞同：2
> 
> 时间：2012-07-16T17:44:57.983
> 
> 标签：c, linux, shell

我正在用 C 编写一个简单的 shell。用户输入命令并将它们存储在二维数组中，例如：

```
SHELL$ ls ; date ; ls
// This is parsed into the following
char* commands[1000] = {"ls", "date", "ls"}; 
```

如果在整个程序中我没有该输入的特定角色，我有一个 for 循环将数组的每个元素传递给系统 - 我没有 ls 和日期的特定角色：

```
if (did_not_process == 0)
    system(commands[i]); 
```

现在我想将 system() 转换为 execvp() 并具有完全相同的功能。这是我的方法无法正常运行：

```
if (did_not_process == 0) {        
    command[0] = commands[i];
    command[1] = NULL;

    if (fork() == 0) {
        execvp(command[0], command);
    } else {
        wait(NULL); //wait for child to complete?
    }
} 
```

唯一的问题是，当我通过 shell 的进一步迭代（一个简单的 while 循环）时，它会零星且无法控制地打印执行。问题出在我展示的代码中，但我不知道在哪里。

这是示例输出：

```
SHELL$ ls;date;ls
file
Mon Jul 16 13:42:13 EDT 2012
file
SHELL$ ls
SHELL$ file 
```

第一次工作，然后在与 shell 输入相同的行上打印文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:11:41.407

仅根据一般原则，您应该检查系统调用的返回值是否存在错误：

```
int cpid = fork()
if (cpid == -1) {
    perror("fork");
} else if (cpid == 0) {
    execvp(command[0], command);
    perror("execvp");
    _exit(1);
} else {
    if (waitpid(cpid, 0, 0) < 0)
        perror("waitpid");
} 
```

# javascript - EXTJS 3 API 转换日期时间

> ID：11509666
> 
> 赞同：0
> 
> 时间：2012-07-16T17:45:11.607
> 
> 标签：javascript, extjs

在 EXTJS 3 中，如果我有一个像 'Fri Jul 13 00:00:00 EDT 2012' 这样的字符串，我怎样才能得到日期字符串 '07/13/2012' ？EXTJS 是否有一些 API 来处理这个问题？

谢谢

----更新---我找到了一个方法，像这样

```
 if (Ext.isDate("Fri Jul 13 00:00:00 EDT 2012")) {
                    var date1 = new Date("Fri Jul 13 00:00:00 EDT 2012");
                    var start_str = date1.format('m/d/Y');
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:48:00.107

我不确定 ExtJS，但这里有一个非常相似的问题[，](https://stackoverflow.com/questions/1259013/extjs-datefield-using-different-display-format)答案链接到[文档](http://docs.sencha.com/ext-js/3-4/#!/api/Date)；不过，仅针对答案中的示例，就值得检查该问题！

在纯 Javascript 实现中，正则表达式可能是要走的路。如果您对正则表达式不太自信，有很多可用的正则表达式示例，甚至还有一些生成器，它们可以让您的生活[更](http://www.javascriptkit.com/javatutors/redev3.shtml)轻松[。](http://txt2re.com/)这是从该站点生成的代码示例 - [jsFiddle 链接](http://jsfiddle.net/5wZak/)。（*这不是做正则表达式的最干净的方法，当你使用生成器时，不幸的是它实际上留下了很多不足之处。**但它确实有效并且给出了一个不错的起点！***）

在仔细检查字符串后，我注意到它使用文本来表示月份。这可以通过使用[enum](https://stackoverflow.com/questions/287903/enums-in-javascript)来解决。

**就 ExtJS 而言 - 这里有一篇关于一些日期格式选项的非常好的博客[文章](http://aboutfrontend.com/extjs/extjs-date-format-demystified/)。但我认为答案顶部链接的文档是最好的地方。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:00:27.273

JavaScript 的[`Date`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)对象应该在这里提供你需要的一切：

```
var d = new Date('Fri Jul 13 00:00:00 EDT 2012');
var out = (d.getMonth()+1) + '/' + d.getDate() + '/' + d.getFullYear() 
```

# jpa - Select DIstinct single column JPQL

> ID：11509667
> 
> 赞同：0
> 
> 时间：2012-07-16T17:45:14.570
> 
> 标签：jpa, distinct, jpql

I am trying to get a distinct list of one particular column.
Somehow or the other, I am just not getting what I expect back... Here is the query that I am trying...

```
@NamedQuery(name="getDstResourceIDsByOrgIDs", query="SELECT DISTINCT d.resourceId FROM DistListPermission d WHERE d.organizationId in ?1") 
```

Now if I am not correct, should that return a distinct list of resourceID's where the organizationID is in a list of organizationID's. Right now this is the result I get...

```
org.apache.openjpa.kernel.DistinctResultList@191f191f 
```

I mean, what on earth is that???

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:05:40.377

It is immutable list of unique elements that is used by OpenJPA to provide result from such a query. It implements java.util.List, so there is no problem. Actual implementation of list does not matter, as long as elements are of correct type.

If you iterate over this list, you will likely see expected distinct values of resourceId.

# android - Horizo ntalScrollView 在片段替换时滚动到 0 (Jelly Bean)

> ID：11509675
> 
> 赞同：1
> 
> 时间：2012-07-16T17:45:50.707
> 
> 标签：android, android-fragments, horizontalscrollview, android-4.2-jelly-bean

我有一个`HorizontalScrollView`包含两个片段，片段 A 有列表，片段 B 显示片段 A 中所选项目的详细信息。两个片段都有一个特定的宽度，所以总宽度大于屏幕并且启用了水平滚动. 其中一个可能的详细视图包含一个带有`EditText`.

在 JellyBean 之前，替换细节片段永远不会影响水平滚动的位置。但是在 4.1.1 中，如果用户选择带有表单类型详细信息的项目，单击 EditText，然后选择另一个项目（按返回隐藏键盘并向右滚动一点，以便两个片段都可见），`HorizontalScrollView`回滚到 0。

以下是一些基于`FragmentLayout`ApiDemos 演示问题的代码：

```
package com.example.testproject;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentTransaction;
import android.support.v4.app.ListFragment;
import android.util.TypedValue;
import android.view.Display;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.TextView;

public class FragmentLayout extends FragmentActivity {

    public static final String[] TITLES = { "Row 1", "Row 2", "Row 3", "Row 4",
            "Row with EditText as detail" };

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.fragment_layout);

        Fragment sideList = getSupportFragmentManager().findFragmentById(
                R.id.titles);
        if (sideList == null) {
            sideList = new TitlesFragment();
            FragmentTransaction ft = getSupportFragmentManager()
                    .beginTransaction();
            ft.replace(R.id.titles, sideList, "side_list").commit();

        }

    }

    public static class TitlesFragment extends ListFragment {

        int mCurCheckPosition = 0;

        @Override
        public void onActivityCreated(Bundle savedInstanceState) {
            super.onActivityCreated(savedInstanceState);

            setListAdapter(new ArrayAdapter<String>(getActivity(),
                    android.R.layout.simple_list_item_activated_1,
                    TITLES));

            if (savedInstanceState != null) {

                mCurCheckPosition = savedInstanceState.getInt("curChoice", 0);
            }

            getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);

            showDetails(mCurCheckPosition);

        }

        @Override
        public void onSaveInstanceState(Bundle outState) {
            super.onSaveInstanceState(outState);
            outState.putInt("curChoice", mCurCheckPosition);
        }

        @Override
        public void onListItemClick(ListView l, View v, int position, long id) {
            showDetails(position);
        }

        void showDetails(int index) {
            mCurCheckPosition = index;

            getListView().setItemChecked(index, true);
            Fragment details = getFragmentManager().findFragmentById(
                    R.id.details);
            if (index < 4) {
                details = DetailsFragment.newInstance(index);
            } else {
                details = FormFragment.newInstance(index);
            }

            FragmentTransaction ft = getFragmentManager().beginTransaction();
            ft.replace(R.id.details, details);
            ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
            ft.commit();

        }
    }

    public static class DetailsFragment extends Fragment {

        public static DetailsFragment newInstance(int index) {
            DetailsFragment f = new DetailsFragment();
            Bundle args = new Bundle();
            args.putInt("index", index);
            f.setArguments(args);

            return f;
        }

        public int getShownIndex() {
            return getArguments().getInt("index", 0);
        }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            if (container == null) {
                    return null;
            }
            Display display = getActivity().getWindowManager()
                    .getDefaultDisplay();
            LinearLayout l = new LinearLayout(getActivity());
            TextView text = new TextView(getActivity());
            l.addView(text);
            text.getLayoutParams().width = display.getWidth();

            int padding = (int) TypedValue.applyDimension(
                    TypedValue.COMPLEX_UNIT_DIP, 4, getActivity()
                            .getResources().getDisplayMetrics());
            text.setPadding(padding, padding, padding, padding);
                    // use the ApiDemos Shakespeare.java file for the DIALOGUe
            text.setText(Shakespeare.DIALOGUE[getShownIndex()]);

            return l;
        }
    }

    public static class FormFragment extends Fragment {

        public static FormFragment newInstance(int index) {
            FormFragment f = new FormFragment();
            return f;
        }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            if (container == null) {
                    return null;
            }

            Display display = getActivity().getWindowManager()
                    .getDefaultDisplay();
            LinearLayout l = new LinearLayout(getActivity());
            EditText text = new EditText(getActivity());
            l.addView(text);
            text.getLayoutParams().width = display.getWidth();
            return l;
        }
    }

} 
```

和唯一有趣的 xml fragment_layout.xml：

```
<?xml version="1.0" encoding="utf-8"?>

<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:baselineAligned="false"
        android:orientation="horizontal" >

        <FrameLayout
            android:id="@+id/titles"
            android:layout_width="300dip"
            android:layout_height="fill_parent" />

        <FrameLayout
            android:id="@+id/details"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:background="?android:attr/detailsElementBackground" />
    </LinearLayout>

</HorizontalScrollView> 
```

# winapi - 有没有办法在 Windows 上以编程方式查找芯片组的北桥、南桥名称和其他硬件信息？

> ID：11509676
> 
> 赞同：6
> 
> 时间：2012-07-16T17:45:55.030
> 
> 标签：winapi, visual-c++, wmi, device-driver

有没有办法在 windows 上以编程方式查找系统芯片组的北桥、南桥名称和其他硬件信息？我不认为 WMI 提供了这些信息。我试图找出像[hwinfo](http://www.hwinfo.com/)和[cpuinfo](http://www.cpuid-pro.com/products-system-information-kit.php)这样的工具是如何找到这些信息的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T01:35:46.873

人们通常通过 WMI 执行此类操作，*但*它很多时候无法提供有用的信息，甚至提供“错误”信息，因为有时它依赖于来自 BIOS（通过 SMBIOS）的供应商填充信息，这些信息经常为空或错误，而不是去与特定的硬件部分进行通信。

我以前经历过这种经历来获取 RAM 信息。WMI 提供了错误的 BIOS 信息，我发现 RAM 芯片带有一个特殊的 SPD（串行存在检测）芯片，我需要与之通信。最后我的雇主选择了 CPUID API。

这里 CPU-Z 的作者在一次采访中谈到了这个话题：

[http://www.techpowerup.com/mobile/reviews/Interviews/Franck_Delattre/1.html](http://www.techpowerup.com/mobile/reviews/Interviews/Franck_Delattre/1.html)。

要获得这样的信息，您需要搜索如何通过驱动程序在内核模式下与 PCI 配置空间进行通信，或者寻找一些可以为您执行此操作的替代 API。

以下是我当时浏览的一些链接：

[http://www.codeproject.com/Articles/35378/Access-Physical-Memory-Port-and-PCI-Configuration](http://www.codeproject.com/Articles/35378/Access-Physical-Memory-Port-and-PCI-Configuration)

[http://support.microsoft.com/?scid=kb;en-us;253232&x=3&y=13](http://support.microsoft.com/?scid=kb;en-us;253232&x=3&y=13)

[http://www.hollistech.com/Resources/Misc%20articles/getbusdata.htm](http://www.hollistech.com/Resources/Misc%20articles/getbusdata.htm)

[http://www.osronline.com/showThread.CFM?link=176210#T4](http://www.osronline.com/showThread.CFM?link=176210#T4)

另外，我认为值得一提的是 Windows 中的 SetupDi 函数，它有时能够提供 WMI 无法提供的信息。

# javascript - 浏览器扩展：如何将 javascript 代码注入页面而不会发生冲突？

> ID：11509678
> 
> 赞同：4
> 
> 时间：2012-07-16T17:46:03.297
> 
> 标签：javascript, browser-extension, content-script, javascript-injection

我已经开始开发浏览器扩展。我注意到一个常见的概念是扩展可以将 JS 代码注入当前浏览器选项卡。

我对这不会经常引起问题感到有些困惑。

我的意思是，如果我在已经包含 JQuery 版本 y 的页面中注入版本 x 的 JQuery（通过我的浏览器扩展程序），事情怎么可能仍然有效？功能不会有冲突`$()`吗？

事情怎么可能这么顺利？开发人员是否应该采用任何特定技术来确保不会发生此类冲突，或者浏览器会处理所有事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T02:16:07.313

虽然`noConflict()`可能大部分时间都适用于 jQuery，但它对于扩展仍然不是一个好主意，并且不适用于大多数其他库或实用程序。

明智的做法是根本不注入代码（有一个例外¹）。该扩展可以包含您需要的任何库，这样做有很多好处：

1.  不存在与页面的 javascript 冲突的可能性。

2.  对页面的 JS 没有依赖，它会在没有通知的情况下发生变化，您的扩展将不那么频繁地中断。

3.  当您注入一个库时，它必须从某个外部服务器中获取。这会减慢您的扩展程序并使其容易受到您无法控制的崩溃的影响。

    当您在扩展中包含该库时，它是：(a) 始终存在，(b) 始终是已知良好的版本，以及 (c) 几乎立即从本地计算机加载，而不是从某个遥远的服务器加载。

4.  即使页面的 javascript 被禁用，您的扩展程序也可以运行。

5.  您的扩展可以同时利用库和扩展 API。

使用扩展很容易合并像 jQuery 这样的库。例如，使用 Chrome：

1.  将库文件复制到您的扩展文件夹。
2.  将库添加到`manifest.json`文件中。

    一个包含 jQuery 的简单清单可以是：

    ```
    {
        "content_scripts": [ {
            "exclude_globs":    [  ],
            "include_globs":    [ "*" ],
            "js":               [ "jquery.min.js", "myJS.js" ],
            "matches":          [ "http://stackoverflow.com/*"
                                ]
        } ],
        "description":  "Hello world with jQuery",
        "name":         "Hello world with jQuery",
        "version":      "1"
    } 
    ```

Firefox 和其他浏览器的机制类似。

* * *

¹一个例外？对于扩展，当且仅当满足所有这些条件时才注入代码：

1.  该扩展仅适用于一个特定站点。
2.  您绝对，肯定地，必须使用目标页面创建的一些对象/功能。
3.  轻松复制扩展中的功能太复杂了。
4.  您不介意为网站设计的每一个微小变化都重写或调整您的扩展。
5.  您可以确定所有用户都将启用该站点的 javascript。
6.  您可以确定为您的图书馆提供服务的网站速度相当快，而且不会经常离线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:47:41.377

这个问题的常见解决方案是使用 jQuery.noConflict() 将 jQuery 别名为不同的变量，确保它不会与页面的`$`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:56:07.813

jQuery 有一个`noConflict()`函数可以用来将 jQuery 与使用`$`命名空间的其他任何东西（例如不同的 jQuery 实例）隔离开来。

避免前向命名空间污染的更通用方法是考虑在闭包中执行 JavaScript。

```
(function () {
    // Your Code Here
})(); 
```

这将防止闭包范围内的任何内容在您自己的代码之外可用。

# c# - 将来自控制台的用户输入解析为 C# 中的命令行参数

> ID：11509679
> 
> 赞同：1
> 
> 时间：2012-07-16T17:46:04.960
> 
> 标签：c#, .net-4.0, console-application

我需要在我正在制作的控制台应用程序中的空格上拆分用户输入，但我不太确定该怎么做。我不能只是盲目地拆分它，因为它会引用字符串和类似的东西。有什么快速方法可以做到这一点？

或者有什么方法可以访问 Windows 命令行解析器并使用它来拆分它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:52:48.010

在 Visual Studio 中创建新的控制台应用程序时，您会得到如下内容：

```
class Program
{
    static void Main(string[] args)
    {
    }
} 
```

传递给应用程序的命令行参数将在“args”参数中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:14:54.517

控制台应用程序中的用户输入很简单：[Console.ReadLine()](http://msdn.microsoft.com/en-us/library/system.console.readline.aspx)。

您可能想尝试这样的事情：

```
static void Main(string[] args)
{
    Console.WriteLine("Input please:");
    string input = Console.ReadLine();
    // Parse input with Regex (This splits based on spaces, but ignores quotes)
    Regex regex = new Regex(@"\w+|""[\w\s]*""");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:15:35.123

要将输入读取为字符串，我将使用：

```
string stringInput = Console.ReadLine(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:19:46.333

好吧，您必须构建自己的“转换器”。基本上，在你的 main 中，你可以只有一个`switch`语句和一个`Console.ReadLine()`. 当用户运行您的可执行文件时，您可以输出类似的内容`Enter Command:`并等待用户输入。然后只需捕获用户输入并打开它。

```
class Program
{
    static void Main(string[] args)
    {       
        string cmd = Console.ReadLine();
        switch(cmd)
        {
            case "DoStuff":
                someClass.DoStuff();
                break;
            case "DoThis":
                otherClass.DoThis();
                break;
        }       
    }
} 
```

如果你想继续接收来自用户的输入命令，那么只需将类似的东西包装在一个 while 循环中，当用户想要`Quit`跳出循环并终止程序时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T20:25:50.190

感谢[这个答案](https://stackoverflow.com/a/11510088/258482)，我终于明白了。这会检查引号，但不担心嵌套引号。根据[对该答案](https://stackoverflow.com/a/11510088/258482)的评论，它如何知道它是两个引号还是嵌套引号。您不能真正使用空格，因为字符串可以以空格开头或结尾。

```
using System.Text.RegularExpressions;
...
Console.Write("Home>");
string command = Console.ReadLine();
Regex argReg = new Regex(@"\w+|""[\w\s]*""");
string[] cmds = new string[argReg.Matches(command).Count];
int i = 0;
foreach (var enumer in argReg.Matches(command))
{
    cmds[i] = (string)enumer.ToString();
    i++;
} 
```

# c# - 获取文件列表并将其传递给 cmd

> ID：11509680
> 
> 赞同：1
> 
> 时间：2012-07-16T17:46:10.650
> 
> 标签：c#, visual-studio-2010

我目前正在从 OpenFileDialog 获取文件列表，然后以这种方式添加到列表中

```
private void BtnSelect_Click(object sender, RoutedEventArgs e)
        {
            OpenFileDialog Open = new OpenFileDialog();
            Open.Filter = "RIFF/RIFX (*.Wav)|*.wav";
            Open.CheckFileExists = true;
            Open.Multiselect = true;
            Open.ShowDialog();

            LstFile.Items.Clear();
            foreach (string file in Open.FileNames)
            {
                LstFile.Items.Add(file);

            }
        } 
```

我将如何从列表中获取单个文件名并将它们传递给 cmd.exe

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:53:52.440

以下是如何使用参数创建流程

```
 Process p = new Process();
        p.StartInfo.FileName = "cmd";
        p.StartInfo.Arguments = "arg1 arg2";
        p.StartInfo.UseShellExecute = false;

        p.Start();
        p.WaitForExit(); 
```

只需传递您想要传递的任何参数来代替`arg1`and`arg2`

如果您需要知道如何从流程中获取输出，请直接说出来，我也会将其包括在内。

您可以通过遍历列表来获取单个文件名，只需使用`foreach`循环

```
foreach(string fn LstFile.Items)
{
    //do something with fn
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:00:38.880

用于[`ProcessStartInfo`](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo)将参数传递给`Process`：

```
ProcessStartInfo startInfo = new ProcessStartInfo("Explore.exe");
startInfo.Arguments = yourArguments;
Process.Start(startInfo); 
```

# javascript - Javascript src 加载顺序

> ID：11509686
> 
> 赞同：0
> 
> 时间：2012-07-16T17:46:41.417
> 
> 标签：javascript, html

我有以下代码布局

```
<script src="http://some.javascript/file.js"></script> // This should load first
<script language="JavaScript">
    document.write('<SCR'+'IPT language="JavaScript1.1" SRC="http://a.link.to.an.external.url/that/returns/a/full/html/page/including/some/javascript">'); // This should load second
    document.write('</SCR'+'IPT>');
</script>

MyJavascriptFunctionThatDependsOnStuffLoadedFromThe.documentWritePage(); <!-- Those files above should have loaded before this call --> 
```

我知道这看起来很奇怪。让我们假设它**必须**看起来像这样，原因不会影响 JS 的加载方式。这不需要跨浏览器工作——只需要 WebKit 浏览器。

如何确保每个文档在下一个文档之前完全加载？也就是说，如何确保这些文档同步加载，以便最后的函数调用可以呈现适当的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:51:58.123

JavaScript 文件应该按顺序加载并阻塞，因此除非您所依赖的脚本正在做一些不寻常的事情，否则您需要做的就是在其他文件之后加载 application.js。

跨域脚本是在站点本身的脚本之后加载的，这就是你得到错误的原因。

您可以添加事件侦听器并在此事件上加载您的 js 文件，如下所示：

```
function addJavaScript( js, onload ) {
   var head, ref;
   head = document.getElementsByTagName('head')[0];
   if (!head) { return; }
   script = document.createElement('script');
   script.type = 'text/javascript';
   script.src = js;
   script.addEventListener( "load", onload, false );
   head.appendChild(script);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:56:26.297

我认为您不能始终如一地跨浏览器这样做。

IE（至少许多旧版本）将按照从服务器**返回的顺序处理脚本标签。****许多其他浏览器按照定义**的顺序处理它们。像这样动态添加到 DOM 的，谁知道呢？我当然不会指望能够控制它们的执行顺序，除非您在尝试添加下一个之前添加某种包装器来测试一个包装器是否到位。

如果它只是必须这样，我真的不知道该建议什么。但是，如果您可以切换使用它们，那么有很多模块加载器。你可能会特别关注[AMD](http://requirejs.org/docs/whyamd.html)

# java - 在Java中克隆通用对象的有效方法最好没有工厂

> ID：11509693
> 
> 赞同：1
> 
> 时间：2012-07-16T17:46:56.383
> 
> 标签：java, generics, cloning

我发现自己必须导出对底层 Java`collections`映射中键的引用。我不想给出对实际关键对象的引用，而是给出它们的副本，以确保没有人摆弄这些值并弄乱地图。所以我需要创建一个任意泛型类型的副本。

我已经编写了一个实用程序类，它通过内存序列化来实现这一点，但后来注意到它`Collections.nCopies`也给了我一些东西的副本。

所以只是为了让我知道我在做什么，例如，我需要在给定其他键值的情况下访问下一个（更高/更低）键值。

```
public class MapWrapper<T, K extends Comparable<K>>
    implements OtherThing<T, K>
{
    public K next (K current) {
        return ... cloned next highest key as per NavigableMap.higherKey()
    }
} 
```

所以问题是复制对象是否更好

```
T copy = Collections.nCopies(1,item).get(0) 
```

或序列化对象然后反序列化它

```
final ByteArrayOutputStream outputBuffer = new ByteArrayOutputStream();
final ObjectOutputStream outputStream = new ObjectOutputStream(outputBuffer);
outputStream.writeObject(item);
outputStream.close();

final ByteArrayInputStream inputBuffer = new ByteArrayInputStream(buffer);
final ObjectInputStream inputStream = new ObjectInputStream(inputBuffer);T copy = null;
T item = null;
try {
    copy = (T)inputStream.readObject();
} catch (ClassNotFoundException e) {
    Logger.getLogger(SerialisationService.class.getName()).log(Level.WARNING, null, e);
}

inputStream.close();
inputBuffer.close();
outputBuffer.close(); 
```

复制 a 的快速测试`Long`表明a`Collections.nCopies`更快（0 ms / 8 ms）。不过，这种方法是否有一些我无法在这么晚的时候考虑的警告，或者你能想出一个更好的方法来获取密钥的副本吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:13:28.823

有一个显着的区别 -`Collections.nCopies`不复制对象！它只返回一个`List`包含`n`条目，所有这些都是提供的对象（[检查源](http://www.docjar.com/html/api/java/util/Collections.java.html#3451)！）。对您从该列表中选择的任何内容所做的任何更改都将反映在原始对象中。所以这段代码：

```
Point original = new Point(0, 0);
Point supposedCopy = Collections.nCopies(1, original).get(0);
supposedCopy.x = 13;
System.out.println("x = " + original.x); 
```

会打印`13`，不会`0`。哎呀。

序列化往返不是一个坏主意。另一种方法是 using [`Cloneable`](http://docs.oracle.com/javase/7/docs/api/index.html?java/lang/Cloneable.html)，不幸的是，它有点坏了。`Cloneable`没有声明`clone()`，但它被[声明为`protected`in`Object`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#clone%28%29)，所以你必须通过反射来调用它。

就个人而言，如果可能的话，我更喜欢在您的情况下使用不可变对象。

# c# - 使用反射的通用列表

> ID：11509695
> 
> 赞同：4
> 
> 时间：2012-07-16T17:47:00.987
> 
> 标签：c#, reflection, generic-list

我有一个场景，`Class name as a string`我只想创建`List`该类的泛型。我尝试了以下

```
 Type _type = Type.GetType(className);

            List<_type> list = new List<_type>(); 
```

但我得到了`error`。我不能将该 _type 作为列表参数。如果有人知道请帮助我

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T17:52:15.190

最接近您可以获得：

```
Type listType = typeof(List<>).MakeGenericType(_type);
IList list = (IList) Activator.CreateInstance(listType); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:50:41.977

反射发生在运行时，因为对象的类型可以通过正在运行的程序更改为任何类型。

另一方面，类型参数（泛型）仅由编译器使用，以检查类型安全。

所以不可能使用反射指定类型参数，因为编译器不会知道反射的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:33:03.397

如果您使用的是 .Net 4，那么使用`dynamic`可能会有所帮助。在这种情况下，您将能够在实例上使用无法通过非泛型接口（例如`IList`）访问的方法。

例如， using`dynamic`允许您调用`AddRanges`列表的方法，而您无法通过强制转换来执行此操作`IList`：

```
Type _type = typeof(int);
Type listType = typeof(List<>).MakeGenericType(_type); 
dynamic list = Activator.CreateInstance(listType); 

list.Add(1);   
list.AddRange(new int[] {0, 1, 2, 3}); 
```

但是，这种方法不像强制转换为非泛型接口那样类型安全，因为它无法在编译时捕获错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T17:50:06.890

不幸的是，这是不可能的，因为泛型需要在编译时知道。您正试图通过在运行时使它们为人所知来重新定义这一点。需要在编译时知道它们的原因是编译器可以验证传递给它的所有变量是否有效。AFAIK，做你想做的事需要完全重写泛型。

编译时检查背后的主要原因是它`_type`可以在运行时更改，然后添加到`List<T>`JIT 编译器需要进行类型检查时会产生开销。

@MarkusJarderot 说的是最接近的，因为使用的是接口而不是泛型。

# java - JTree：如何获取选定节点的路径

> ID：11509700
> 
> 赞同：5
> 
> 时间：2012-07-16T17:47:23.397
> 
> 标签：java, swing, jtree

有没有办法像使用类似的东西来获取 JTree 中选定节点的选定路径

```
String pathForNode = JTree.getLastSelectedPathComponent().getPath().toString(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:54:10.967

```
 tree.addTreeSelectionListener(new TreeSelectionListener() {  
    public void valueChanged(TreeSelectionEvent e) {  
       TreePath tp = e.getNewLeadSelectionPath();  
       if (tp != null) {
          pathForNode = tp.getLastPathComponent();  
       }
    }  
 }); 
```

> [http://www.coderanch.com/t/453540/GUI/java/Getting-path-file-selected-JTree](http://www.coderanch.com/t/453540/GUI/java/Getting-path-file-selected-JTree)

**编辑：**

尝试

```
 tree.addMouseListener(new MouseAdapter() {
      public void mouseClicked(MouseEvent me) {
        doMouseClicked(me);
      }
    });
  }

  void doMouseClicked(MouseEvent me) {
    TreePath tp = tree.getPathForLocation(me.getX(), me.getY());
    if (tp != null) {
      System.out.println(tp.toString());
    }
  } 
```

[JTree路径](http://www.java2s.com/Tutorial/Java/0240__Swing/JTreenodemouseclickevent.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-12T02:27:53.400

[![在此处查看输出](../Images/da74e92bdd0e51cbe1865e1831584bd9.png)](https://i.stack.imgur.com/UUTZi.png)

```
 tree.addTreeSelectionListener(new TreeSelectionListener() {
        public void valueChanged(TreeSelectionEvent e) {
            TreePath treepath = e.getPath();
            System.out.println("Java: " + treepath.getLastPathComponent());
            Object elements[] = treepath.getPath();
               for (int i = 0, n = elements.length; i < n; i++) {
                   System.out.print("->" + elements[i]);

         // JOptionPane.showMessageDialog(null,"->"+elements[i]);
         //lblNewLabel.setText(">"+ elements[i]);

           value+=elements[i]+"\\";

        }

        //String x=String.valueOf(value);            
        //lblNewLabel.setText(String.valueOf(value));

        JOptionPane.showMessageDialog(null, value);

        //System.out.println(value);
        }
    });

  static String value="";    //add this just before the void main function 
```

在 C# .net 中，它曾经很容易获得路径并且对我来说有点直观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-21T11:35:55.913

我用这个：

```
 jTreeVarSelectedPath = "";
    Object[] paths = jTreeDirectorios.getSelectionPath().getPath();
    for (int i=0; i<paths.length; i++) {
        jTreeVarSelectedPath += paths[i];
        if (i+1 <paths.length ) {
            jTreeVarSelectedPath += File.separator;
        }
    } 
```

# php - MySQL - Search PHP script

> ID：11509707
> 
> 赞同：7
> 
> 时间：2012-07-16T17:47:55.743
> 
> 标签：php, mysql

I'm currently coding my own CMS and I'm at the point of the `search.php`. I need to search in 4 tables that haves different columns name within only one query because my server is not the fastest.

There's my DB arrangement:

`cmw_admin` (users table)

```
+-----------------+------------+------+-----+---------+----------------+
| Field           | Type       | Null | Key | Default | Extra          |
+-----------------+------------+------+-----+---------+----------------+
| id              | int(11)    | NO   | PRI | NULL    | auto_increment |
| role            | int(11)    | NO   |     | 1       |                |
| username        | text       | NO   |     | NULL    |                |
| password        | text       | NO   |     | NULL    |                |
| email           | text       | NO   |     | NULL    |                |
| phone           | text       | NO   |     | NULL    |                |
| location        | text       | NO   |     | NULL    |                |
| full_name       | text       | NO   |     | NULL    |                |
| bio             | text       | NO   |     | NULL    |                |
| website         | text       | NO   |     | NULL    |                |
| last_login      | datetime   | NO   |     | NULL    |                |
| registered_date | datetime   | NO   |     | NULL    |                |
| registered_ip   | text       | NO   |     | NULL    |                |
| credits         | tinyint(1) | NO   |     | NULL    |                |
| online          | int(11)    | NO   |     | 0       |                |
+-----------------+------------+------+-----+---------+----------------+ 
```

`cmw_blog` (articles table)

```
+------------+----------+------+-----+---------+----------------+
| Field      | Type     | Null | Key | Default | Extra          |
+------------+----------+------+-----+---------+----------------+
| id         | int(11)  | NO   | PRI | NULL    | auto_increment |
| title      | text     | NO   |     | NULL    |                |
| content    | text     | NO   |     | NULL    |                |
| date       | datetime | NO   |     | NULL    |                |
| author     | int(11)  | NO   |     | NULL    |                |
| categories | text     | NO   |     | NULL    |                |
| media      | text     | NO   |     | NULL    |                |
| thumb      | text     | NO   |     | NULL    |                |
+------------+----------+------+-----+---------+----------------+ 
```

`cmw_projects` (portfolio)

```
+-------------+------------+------+-----+---------+----------------+
| Field       | Type       | Null | Key | Default | Extra          |
+-------------+------------+------+-----+---------+----------------+
| id          | int(11)    | NO   | PRI | NULL    | auto_increment |
| owner_id    | int(11)    | NO   |     | NULL    |                |
| title       | text       | NO   |     | NULL    |                |
| content     | text       | NO   |     | NULL    |                |
| date        | date       | NO   |     | NULL    |                |
| link        | text       | NO   |     | NULL    |                |
| img         | text       | NO   |     | NULL    |                |
| type        | int(11)    | NO   |     | NULL    |                |
| start_date  | date       | NO   |     | NULL    |                |
| end_date    | date       | NO   |     | NULL    |                |
| done        | tinyint(1) | NO   |     | 0       |                |
| screenshots | text       | NO   |     | NULL    |                |
+-------------+------------+------+-----+---------+----------------+ 
```

`cmw_services` (services table)

```
+-------------+---------------+------+-----+---------+----------------+
| Field       | Type          | Null | Key | Default | Extra          |
+-------------+---------------+------+-----+---------+----------------+
| id          | int(11)       | NO   | PRI | NULL    | auto_increment |
| cat_id      | int(11)       | NO   |     | NULL    |                |
| name        | text          | NO   |     | NULL    |                |
| description | text          | NO   |     | NULL    |                |
| img         | text          | NO   |     | NULL    |                |
| price       | decimal(11,2) | NO   |     | NULL    |                |
+-------------+---------------+------+-----+---------+----------------+ 
```

In my search, I need to search for string in every `name`/`title` columns and in all `description`/`content` columns too. In clear, I want to search all those table for one string, in only one query. Is that possible? I know that using `JOIN`, `LEFT JOIN`, `RIGHT JOIN` and `INNER JOIN` may be easy but I don't know how to use them. Google is not very explicit on that things!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:50:27.420

The total cost of four straight queries is in all likelihood much less than the cost of a JOIN plus a search of those same records/fields.

If anything, check the possibilities of a FULLTEXT index.

In any case, you can do this with something like

```
 SELECT "cmw_admin" as source, id FROM cmw_admin, NULL as date [...] WHERE bio LIKE '%search%'
 UNION
 SELECT "cmw_blog"  as source, id FROM cmw_admin, date as date [...] WHERE
     (title LIKE '%search%' OR content LIKE '%search%')
 UNION
 ... 
```

which will give you a list of the found records, together with a hint of where the record came from ("cmw_admin", "cmw_blog", ...); that will allow you to choose how to present the records from the various sources.

The query will always return the same set of fields, some with valid values, some not, depending on what the "source" is. Then in your PHP script you can do something like,

```
 $source = $record['source'];
 if (!isset($template[$source]))
     $template[$source] = file_get_contents("templates/search/$source.html");

 $html_view = preg_replace('#{{\s*([^}\s]*)\s*}}#e', 'isset(\$record["\1"])?\$vars["\1"]:""', $template[$source]); 
```

This will take a HTML template containing a HTML fragment like

```
 <h2>{{ date }}</h2> 
```

and "populate" the field with the [date] entry of the current $record. I find this is a good way to keep HTML and code separated (YMMV). If you already have a templating system, you can (and should!) adapt that one instead.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:56:21.643

If you want to search in mysql only, the FULLTEXT index is the way to go.

When searching you should use a single query pr table since you most likely need to build links/result html that is different based on what table the match was found in.

But you should consider looking into a real search engine like Apache Lucene. Zend has a very good implementation for it that does not depend on any external services [http://framework.zend.com/manual/en/zend.search.lucene.html/](http://framework.zend.com/manual/en/zend.search.lucene.html/) it will help rank the results better than you can do with mysql and it should scale better.

# javascript - IE 0.width 为空或不是对象

> ID：11509708
> 
> 赞同：0
> 
> 时间：2012-07-16T17:47:59.607
> 
> 标签：javascript, internet-explorer, dom

我正在做一个 Javascript 和 jQUery 动画，它在所有浏览器中的 Internet Explorer 中运行良好，它显示了这个警报：'0.width 为空或不是对象'看看这里的代码：[http：/ /jsfiddle.net/3y8cN/](http://jsfiddle.net/3y8cN/)

这是一个动画百分比栏，在 Chrome 中运行良好，但在 IE 中不行，看起来问题出在`if`：

```
if (barracent[0].style.width != '0'){
    multiplier[0].innerHTML = value1+'%';
} 
```

我怎样才能避免这个问题？

是的，我知道我可以使用循环来避免那些大代码，我稍后再做。非常感谢提前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:53:41.013

`DIV`'s 不支持 'name' 属性，因此`document.getElementsByName('barracent')`在 IE 中不返回任何元素（其他浏览器不得有此限制）。查看[此答案](https://stackoverflow.com/a/278773/508537)以获取有关该问题的更多详细信息。

# c - 函数原型声明 c

> ID：11509711
> 
> 赞同：6
> 
> 时间：2012-07-16T17:48:00.903
> 
> 标签：c, function-prototypes

今天看到一个表单的函数原型（为了完整起见，添加了几行开头）

```
typedef unsigned char md5_byte_t; /* 8-bit byte */
typedef unsigned int md5_word_t; /* 32-bit word */
/* Define the state of the MD5 Algorithm. */
typedef struct md5_state_s {
    md5_word_t count[2];    /* message length in bits, lsw first */
    md5_word_t abcd[4];     /* digest buffer */
    md5_byte_t buf[64];     /* accumulate block */
} md5_state_t;

void md5_finish(md5_state_t *pms, md5_byte_t digest[16]); 
```

这已经采取了 L. Peter Deutsch 的*md5 实现形式。*据我所知，写`16`在原型中没有任何意义。那么为什么包含在这里

这是否只是向程序员表明，无论您传递给函数的指针或数组，它只会考虑它的前 16 个字节。它在这里实际上意味着什么。这是[github 上托管的实现的链接](http://sourceforge.net/projects/libmd5-rfc/files/libmd5-rfc/2002-04-13/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T17:52:25.593

在实践中，它会衰减到

`void md5_finish(md5_state_t *pms, md5_byte_t *digest);`

这`16`可能是对用户摘要使用的大小的提示，但从技术上讲，该函数将接受参数中的任何大小，除非函数中有代码检查某个大小。

# actionscript-3 - Flash - ComboBox 控件的替代品

> ID：11509713
> 
> 赞同：2
> 
> 时间：2012-07-16T17:48:02.460
> 
> 标签：actionscript-3, flash

我的表单需要一个下拉菜单。看起来[ComboBox 控件](http://help.adobe.com/en_US/ActionScript/3.0_UsingComponentsAS3/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa9.html)是我需要使用的。它有效，但它为我的 SWF 添加了 50k。我想知道是否可以采取一些措施来减轻这种文件大小的增加。或者还有其他替代 ComboBox 控件的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:58:06.157

你可以：

1.  编写您自己的可能更小的简单 ComboBox 实现，因为它不会编译所有框架依赖项。尽管这可能是一项艰巨的任务，尤其是如果您希望具有与标准组件一样的灵活性，那么开箱即用。
2.  如果适用，请为您的问题寻找另一个 UI 解决方案。
3.  在您的 Flash 应用程序之外使用 HTML 标记，并使用 ExternalInterface 在 HTML 和 Flash 之间进行通信（如果适用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:11:14.913

我可以试试[Liquid Components](http://www.bytearray.org/?p=137)，看看有什么不同。

# javascript - 我应该使用其他东西而不是 setTimeout 吗？

> ID：11509714
> 
> 赞同：0
> 
> 时间：2012-07-16T17:48:03.257
> 
> 标签：javascript, jquery, jquery-plugins

我有以下 HTML：

```
<div id="wrapper">
      <div class="p1">
          <a href="#" class="quickFlipCta"><img src="Test Pictures/QuestionMark.gif" /></a>
      </div>

      <div class="p2">
          <a href="#" class="quickFlipCta"><img src="Test Pictures/flower.gif" /></a>
      </div>
</div> 
```

我正在使用一个插件，该插件可用作面板（`p1`和`p2`）之间的翻转动画

以下工作完美：

```
last.parent().parent().quickFlipper({refresh :1});
$(this).parent().parent().quickFlipper({refresh :1}); 
```

但是，我想`$(this).parent().parent().quickFlipper({refresh :1});`延迟。我尝试使用 setTimeout：

```
last.parent().parent().quickFlipper({
    refresh: 1
});
setTimeout(function () {
    $(this).parent().parent().quickFlipper({
        refresh: 1
    });
}, 1200); 
```

当我这样做时， setTimeout 中的函数根本不会执行。我想知道我是否应该使用除了 setTimeout 之外的其他东西来延迟`$(this).parent().parent().quickFlipper({refresh :1});`

我已阅读有关插件的文档，但没有关于此问题的任何内容。

这是我的完整代码：http: [//jsfiddle.net/kBDFD/](http://jsfiddle.net/kBDFD/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:57:56.417

您想在第一个动画完成后运行第二个动画，还是想同时运行它们但有一些延迟？

您始终可以使用动画延迟对象并这样做。

```
var self = this;
last.parent().parent().quickFlipper({refresh :1}).promise().done(function() {
  $(self).parent().parent().quickFlipper({refresh :1});     
}); 
```

当第一个动画完成时，第二个动画将开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:53:26.000

在 内部`setTimeout()`，您将失去 的值，`this`这就是您的代码无法工作的原因（`this`将被设置为`window`对象）。

你可以改用这样的东西：

```
var self = this;
setTimeout(function () {
    $(self).parent().parent().quickFlipper({refresh: 1});
}, 1200); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:53:59.450

你不能在回调中使用它，它会指向另一个对象

```
last.parent().parent().quickFlipper({
    refresh: 1
});
var thiz = this;
setTimeout(function () {
    $(thiz).parent().parent().quickFlipper({
        refresh: 1
    });
}, 1200); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:02:59.870

您不需要使用超时。每个好的插件都会在动画完成时提供回调，甚至那些不会使用`.animate()`. 这意味着，您可以通过获取[`.promise`](http://api.jquery.com/promise/)for it（如 Grzegorz 的回答）或使用[`.queue`](http://api.jquery.com/queue/)：

```
last.parent().parent().quickFlipper({refresh :1}).queue(function(next) {
   $(this).parent().parent().quickFlipper({refresh :1});
   next();
}); 
```

# c++ - Clang - 删除某些文件的“永远不会使用转换为基类的转换函数”警告

> ID：11509715
> 
> 赞同：2
> 
> 时间：2012-07-16T17:48:07.173
> 
> 标签：c++, winapi, directx, clang

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:25:19.430

所以，对于任何可能有这个“问题”的人：

不使用`-I<path>`，使用`-isystem<path>`。

# web-applications - 将 jetty url-pattern 匹配到仅根目录

> ID：11509716
> 
> 赞同：8
> 
> 时间：2012-07-16T17:48:13.280
> 
> 标签：web-applications, servlets, passwords, jetty, cometd

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T22:16:03.783

这是给你的答案：

```
<?xml version="1.0" encoding="UTF-8"?>

<web-app xmlns="http://java.sun.com/xml/ns/javaee"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
        version="3.0">
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <security-constraint>   
        <web-resource-collection>
            <web-resource-name>Private Page</web-resource-name>
            <url-pattern>/</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>moderator</role-name>
        </auth-constraint>
    </security-constraint>
    <security-constraint>   
        <web-resource-collection>
            <web-resource-name>Public page</web-resource-name>
            <url-pattern>/test/*</url-pattern>
        </web-resource-collection>        
    </security-constraint>
    <login-config>
        <auth-method>BASIC</auth-method>
        <realm-name>Test Realm</realm-name>
    </login-config>
</web-app> 
```

在此配置中，根目录受密码保护，而`/test/...`目录则不受密码保护。我想这就是你所要求的。

此配置在 Tomcat 7+ 上进行了测试，并在 NetBeans 中从一开始就创建了一个新项目（如果您需要，我可以通过电子邮件将整个源代码发送给您）。

这是输出： ![输出](../Images/4688dbeab33df04db4b03ac86bedcd63.png)

# c# - HTML 敏捷包 - 从相对路径解析 img src 和 href

> ID：11509720
> 
> 赞同：1
> 
> 时间：2012-07-16T17:48:28.197
> 
> 标签：c#, html-agility-pack

我有一个具有 img src 和链接 href 作为相对路径的 html。我需要使用 Html Agility Pack 从相对路径移动到完整的 url 路径，例如“http://localhost:port..”。

S3 中的 src="/Expo/imagename.s3lb" href="../Etch/Exposition/...aspx?sflang=en"

有人可以告诉我一种方法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:46:55.110

我现在无法测试或运行它，但你可以尝试这样的事情：

```
var htmlStr = "yourhtml";
var doc = new HtmlDocument();
doc.LoadHtml(htmlStr);
var baseUri = new Uri("baseUriOfYourSite");
var images = doc.DocumentNode.SelectNodes("//img/@src").ToList();
var links = doc.DocumentNode.SelectNodes("//a/@href").ToList();
foreach (var item in images.Concat(links))
{
    item.InnerText =  new Uri(baseUri, item.InnerText).AbsoluteUri;    
} 
```

# python - 如何在 Python 中初始化空列表字典？

> ID：11509721
> 
> 赞同：106
> 
> 时间：2012-07-16T17:48:30.917
> 
> 标签：python, list, dictionary

我以编程方式创建列表字典的尝试未能允许我单独处理字典键。每当我创建列表字典并尝试附加到一个键时，它们都会更新。这是一个非常简单的测试用例：

```
data = {}
data = data.fromkeys(range(2),[])
data[1].append('hello')
print data 
```

实际结果：`{0: ['hello'], 1: ['hello']}`

预期结果：`{0: [], 1: ['hello']}`

这是有效的

```
data = {0:[],1:[]}
data[1].append('hello')
print data 
```

实际和预期结果：`{0: [], 1: ['hello']}`

为什么该`fromkeys`方法没有按预期工作？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-07-16T17:50:49.670

`[]`作为第二个参数传递`dict.fromkeys()`给了一个相当无用的结果——字典中的所有值都是*同一个*列表对象。

在 Python 2.7 或更高版本中，您可以改用字典推导：

```
data = {k: [] for k in range(2)} 
```

在早期版本的 Python 中，您可以使用

```
data = dict((k, []) for k in range(2)) 
```

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2012-07-16T17:50:10.870

改用[defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)：

```
from collections import defaultdict
data = defaultdict(list)
data[1].append('hello') 
```

这样，您不必事先将要用于列表的所有键初始化。

您的示例中发生的是您使用*了一个*（可变）列表：

```
alist = [1]
data = dict.fromkeys(range(2), alist)
alist.append(2)
print data 
```

会输出`{0: [1, 2], 1: [1, 2]}`.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-16T17:50:42.740

您正在使用对单个列表的引用填充字典，因此当您更新它时，更新会反映在所有引用中。尝试使用字典理解。请参阅 [在 Python 中创建具有列表理解的字典](https://stackoverflow.com/questions/1747817/python-create-a-dictionary-with-list-comprehension)

```
d = {k : v for k in blah blah blah} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2017-06-15T17:44:47.520

你可以使用这个：

```
data[:1] = ['hello'] 
```

# datetime - 无法更改 DateTime 字段的错误/消息并出现重复错误

> ID：11509726
> 
> 赞同：0
> 
> 时间：2012-07-16T17:48:46.887
> 
> 标签：datetime, symfony, twig

我还在那个`DateTime`领域，现在我有这两个问题。

我在一个表单上有两个字段`date_start`，`date_end`两者的定义如下：

### 实体

```
/**
 * @ORM\Column(type="datetime", nullable=true)
 * @Assert\DateTime( message="My error message" )
 */
protected $date_start; 
```

### 表格类型

```
->add('date_start', 'datetime', array(
        'label' => 'incoming',
        'date_widget' => 'single_text',
        'time_widget' => 'single_text',
        'date_format' => 'dd/MM/yyyy',
        'with_seconds' => false,
        'required' => false,
    ) ) 
```

### 树枝场

```
{% block form_errors %}
{% spaceless %}
    {% if errors|length > 0 %}
        {% for error in errors %}
            <li>{{ error.messageTemplate }}</li>
        {% endfor %}
    {% endif %}
{% endspaceless %}
{% endblock form_errors %}

{% block field_errors %}{{ block('form_errors') }}{% endblock %} 
```

### 树枝模板

```
{{ form_errors(form.date_start.date) }}
{{ form_errors(form.date_end.date) }}

<div class="row{% if form_errors(form.date_start.date) or form_errors(form.date_start.time) %} error{% endif %}">
    {{ form_label(form.date_end, null, { 'attr': {'class': '_hint'} }) }}
    {{ form_widget(form.date_end) }}
</div> 
```

而这又是一模一样的`date_end`。

### 问题

`date_start.date` **当我为两者** 输入错误的输入时，都会`<div>`得到错误类，并且**两者**都附加了相同的错误。反之亦然（`date_start.date`正确，但`date_end.date`不是）。

第二个问题是错误消息总是显示“ **This value is not valid** ”，并且该行`@Assert\DateTime( message="My error message" )`似乎没有任何效果。`date`而且我不知道如何分别更改这两者`time`。

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T19:35:40.490

对于您的第二个问题，由于在验证之前发生数据转换失败，因此设置了错误消息**“此值无效” 。**所以`@Assert`实际上是无关紧要的。`invalid_message`您可以通过在表单字段声明中设置选项来更改消息。

# silverlight - SL 5 中 GoToStateAction 的替代品是什么？

> ID：11509729
> 
> 赞同：0
> 
> 时间：2012-07-16T17:49:08.170
> 
> 标签：silverlight, silverlight-4.0, silverlight-5.0

我尝试将 SL 4 应用程序迁移到 SL5 并在编译应用程序时出现以下错误：

```
Error   17  The tag 'GoToStateAction' does not exist in XML namespace 
'http://schemas.microsoft.com/expression/2010/interactions'.    

Error   31  The type 'GoToStateAction' from assembly 'Microsoft.Expression.Interactions' is built with an older version of the Blend SDK, and is not supported in a Silverlight 5 project. 
```

此错误的 xaml 是： xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"

```
 <i:Interaction.Triggers>
                <i:EventTrigger EventName="MouseEnter">
                    <ei:GoToStateAction StateName="ShowStatus"/>
                </i:EventTrigger>
                <i:EventTrigger EventName="MouseLeave">
                    <ei:GoToStateAction StateName="HideStatus"/>
                </i:EventTrigger>
            </i:Interaction.Triggers> 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:24:21.977

想通了：为 SL5 安装 Blend Preview。谢谢。

# c++ - CMake add_library( 是否有环境变量？ 目的 )?

> ID：11509730
> 
> 赞同：4
> 
> 时间：2012-07-16T17:49:22.210
> 
> 标签：c++, makefile, cmake, shared-libraries

CMake 是 2.8.8 在编译时引入了 OBJECT 库类型：add_library( OBJECT )。能够将所有类编译为 .o 文件是一个有用的构造，但还不能将它们添加到库中。

但是，我不确定它最终会附加到生成的 make 文件中的命令的哪些标志。基本上，在执行 add_library(SHARED) 命令时，它会添加由 CMAKE_SHARED_LIBRARY_CXX_FLAGS 指定的任何标志。我希望能够为 JUST OBJECT 库指定构建标志，而不必求助于更多的全局标志，例如 CMAKE_CXX_FLAGS_DEBUG 和 CMAKE_CXX_FLAGS_RELEASE。如果这样的标志存在或计划中，是否有人有任何想法？

回顾：

```
# has CMAKE_SHARED_LIBRARY_CXX_FLAGS to set SHARED library build flags
add_library(<lib> SHARED <srcs>)

# Is any environment variable available to set OBJECT library build flags?
add_library(<lib> OBJECT <srcs>) 
```

我期待像 CMAKE_OBJECT_LIBRARY_CXX_FLAGS 这样的环境变量来设置 OBJECT 构建标志。查看源代码（Modules/SystemInformation.in 和 Modules/CMakeCXXInformation.cmake），我没有发现任何看起来像是特定于 OBJECT 库的内容。

**编辑：** 具体来说，我想将 -fPIC 添加到 OBJECT 库，而不是可执行文件，这就是为什么我不想在 CMAKE_CXX_FLAGS_* 中指定标志

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T11:13:03.580

使用 CMake 2.8.9 或更高版本时，使用属性[POSITION_INDEPENDENT_CODE](https://cmake.org/cmake/help/latest/prop_tgt/POSITION_INDEPENDENT_CODE.html)以编译器独立方式启用与位置无关的代码：

```
add_library(<lib> OBJECT <srcs>)
set_target_properties(<lib> PROPERTIES POSITION_INDEPENDENT_CODE ON) 
```

对于旧版本的 CMake，您可以设置目标的[COMPILE_FLAGS](http://www.cmake.org/cmake/help/v2.8.8/cmake.html#prop_tgt:COMPILE_FLAGS)属性`OBJECT_LIBRARY`：

```
add_library(<lib> OBJECT <srcs>)
set_property(TARGET <lib> PROPERTY COMPILE_FLAGS "-fPIC") 
```

# java - 抬起手指时Android MultiTouch崩溃

> ID：11509732
> 
> 赞同：2
> 
> 时间：2012-07-16T17:49:23.770
> 
> 标签：java, android, multi-touch

我不想编写动态壁纸，我需要一个当前按下的点列表。我将点存储在 SpareArray 中（与 HashMap 基本相同，但速度更快）。

现在，当我用两根手指（1 和 2）触摸屏幕并抬起手指（第一根手指 2，而不是 1）时，它就可以工作了。但是当我先抬起手指 1 时，应用程序崩溃了。我必须以相反的顺序抬起手指，然后按下它们。

```
@Override
public void onTouchEvent(MotionEvent event) {
    for (int i = 0; i < event.getPointerCount(); i++) {
        switch (event.getAction() & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN:
            case MotionEvent.ACTION_POINTER_DOWN:
            case MotionEvent.ACTION_MOVE:
                int pID = event.getPointerId(i);
                Points.put(pID, new Point((int)event.getX(pID), (int)event.getY(pID))); //CRASH HERE
                break;
            case MotionEvent.ACTION_UP:
            case MotionEvent.ACTION_POINTER_UP:
                Points.remove(event.getPointerId(i));
                break;
        }
    }
    super.onTouchEvent(event);
    handler.post(drawRunnable);
} 
```

我总是收到“java.lang.IllegalArgumentException：pointerIndex out of range”异常

谢谢，多米尼克

编辑：堆栈跟踪

```
07-16 19:55:58.354: E/AndroidRuntime(4986): FATAL EXCEPTION: main
07-16 19:55:58.354: E/AndroidRuntime(4986): java.lang.IllegalArgumentException: pointerIndex out of range
07-16 19:55:58.354: E/AndroidRuntime(4986):     at android.view.MotionEvent.nativeGetAxisValue(Native Method)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at android.view.MotionEvent.getX(MotionEvent.java:1974)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at net.ta.livewp.LiveWallpaper$xEngine.onTouchEvent(LiveWallpaper.java:103)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at android.service.wallpaper.WallpaperService$IWallpaperEngineWrapper.executeMessage(WallpaperService.java:1047)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at com.android.internal.os.HandlerCaller$MyHandler.handleMessage(HandlerCaller.java:61)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at android.os.Looper.loop(Looper.java:137)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at android.app.ActivityThread.main(ActivityThread.java:4575)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at java.lang.reflect.Method.invokeNative(Native Method)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at java.lang.reflect.Method.invoke(Method.java:511)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
07-16 19:55:58.354: E/AndroidRuntime(4986):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:01:07.530

我相信你想打电话`event.getX(i)`而不是`event.getX(pID)`。getPointerId(i) 返回一个指针标识符，而不是指针的索引，这正是您想要的。

有关这方面的更多信息，请参阅[MotionEvent 文档](http://developer.android.com/reference/android/view/MotionEvent.html)

# regex - Reg ex - 查找字符串的一部分

> ID：11509733
> 
> 赞同：1
> 
> 时间：2012-07-16T17:49:28.200
> 
> 标签：regex

我有这种类型的数据（重复多次）：

```
@@@FFDFFHHHHHJJFFHGIJJJJGI   
@M00332:5:000000000-A0TVJ:1:1:13498:26189 2:N:0:1   
ACCACAGCCGCTGCCCATTTGCATAA 
+ 
```

使用 regexp 我试图选择包含特定字符串的所有行`cagccgctgcccatttg`。我是一个正则表达式新手，所以我试过这个：`\w{3,}(cagccgctgcccatttg)\w{3,}`

任何帮助深表感谢。

干杯西蒙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:07:17.187

据我了解，您想收集包含单个子序列的所有序列。我不知道您使用的是什么环境，但这应该以一种非常简单的方式返回您正在寻找的任何序列。

```
([ACGT]{3,}CAGCCGCTGCCCATTTG[ACGT]{3,}) 
```

括号是一个字符类，这意味着它匹配内部的任何单个字符。你不想匹配 \w，你只想匹配一个字符，如果它是你正在寻找的 4 个字符之一。此外，您可以使用括号覆盖整个正则表达式以获取整个匹配项。

# c# - 替换 MS Word 2010 文档中的书签会丢失格式

> ID：11509735
> 
> 赞同：0
> 
> 时间：2012-07-16T17:49:35.020
> 
> 标签：c#, openoffice.org, openoffice-writer, uno

我创建了一个 MS Word 文档，其中包含一些我想在运行时用从数据库中获取的一些文本替换的书签。
最初这个应用程序使用 OLE 自动化 (Word) 来做这些事情，但后来我决定寻找一些替代方案。
我已经下载并使用了 Open Office SDK（最新版本）并实现了一个简单的项目。

```
// Opens a MS Word document 
XComponent document = OpenDocument("Test.docx", "_blank", true);
XNameAccess xna = ((XBookmarksSupplier) document).getBookmarks();
string[] documentBookMarkKeys = xna.getElementNames();

if (documentBookMarkKeys.Length > 0) {
    uno.Any currentBookmark = xna.getByName("bookmark1");
    XTextContent bookmarkContent = currentBookmark.Value as XTextContent;

    if (bookmarkContent != null) {
        XTextRange xFound = bookmarkContent.getAnchor();
        xFound.setString("Some text here!");
    }
} 
```

我整理的这个简单的例程试图抓取在 Internet 上找到的一些代码似乎工作正常，但它并没有保留这些书签的格式。我不知道是否有任何其他替代方案可以达到相同的结果。难道我做错了什么？

我正在通过 UNO 使用 Open Office 3.4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T22:37:22.933

如果您的目标是将文档保存在 Microsoft Word 中，那么您可能需要调整您的方法。我的理解是，OpenOffice 不会保留与原始文档关联的所有元数据，即在我的经验中，来自 MS Word 文档的数据字段将仅复制文本，并且到原始数据源/数据字段的链接将丢失。我的猜测是书签也可能发生同样的情况，因为这两种产品都支持书签，所以使用 OO 操作 Word 可能会导致底层链接丢失。您可以通过手动尝试来证明这一点，即使用 OO 修改您的 .docx 只是为了查看当您保存修改后的文档时是否获得了所需的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:38:16.013

我只是删除并重新创建了书签，现在一切似乎都很好。

# c# - 如何使用 wi-fi 从服务器自动更新 Windows Mobile 应用程序？

> ID：11509736
> 
> 赞同：1
> 
> 时间：2012-07-16T17:49:43.147
> 
> 标签：c#, wcf, c#-2.0, windows-mobile-6.5, windows-mobile-5.0

我正在使用 C# 和 .NET Framework 2.0 开发一个需要零星升级的 Windows Mobile（CE 和 6.5）应用程序。此应用程序将与 .NET Framework 4.0 中构建的 WCF 服务进行通信。

客户希望应用程序在每次启动时检查新的升级。如果有新的升级，必须下载并替换旧的（不想使用 ActiveSync 或通过电缆/usb 进行）。

我正在考虑构建一个应用程序来检查状态并将旧文件替换为新文件（并启动真正的 .exe 文件）。

删除旧的 .exe 文件并替换为新文件有一些限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:47:37.663

我做过类似的事情。我必须创建 2 个应用程序才能完成此任务。有主应用程序，然后是一个单独的更新程序应用程序。

当主应用程序启动时，它将检查服务器是否有更新。如果找到更新，主应用程序将启动更新程序应用程序。更新程序应用程序将杀死/关闭主应用程序，为主应用程序下载新的 exe，然后执行它。

再次加载主应用程序后，它将检查更新程序应用程序的任何打开实例并终止它们。我们必须实现模态“加载”屏幕，以防止用户在此过程中点击任何内容。

# linux - Cent OS - 如何为网络机器人使用多个 IP 地址？

> ID：11509739
> 
> 赞同：0
> 
> 时间：2012-07-16T17:49:57.200
> 
> 标签：linux, hosting, centos, vps

我是一名 PHP webbot 开发人员，我经常看到 VPS 服务为其客户提供多个 IP 地址。

我的问题是如何将这些额外的 IP 用于我创建的网络机器人？

（假设 centos 等）

如果您需要更多信息来回答我的问题，请告诉我，因为我知道这有点含糊，但我对它的工作原理不是很了解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:53:37.293

绑定到特定地址而不是`0.0.0.0`or `::`。

# c - 关于指针差异的指针 netbeans gdb 调试器和 gcc

> ID：11509742
> 
> 赞同：0
> 
> 时间：2012-07-16T17:50:08.513
> 
> 标签：c, linux, netbeans

我的问题是

```
void function (const char **params)     
{
    const char *para;       
    para = &params[0]; //1
    para = params;     //2
    para = *&params;   //3 
} 
```

所有 3 个选项都将由 Netbeans gdb 编译，但 gcc 表示来自不兼容的指针类型的赋值。

为什么会有这种差异....得到了 gcc 4.6.1，我可以在 gcc 中做什么来用 *para 指向 **params 的值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:28:07.700

在所有三种情况下，右侧的类型都是`const char **`，不能在没有强制转换的情况下将其分配给 a `const char *`。

如果您将警告级别提高到足够高，所有编译器都应该警告您。

不清楚你想做什么；如果您想指向第一个子数组的开头，那么这将起作用：

```
para = params[0]; 
```

# c++ - C++ 中 `virtual` 关键字在对象而不是指针上的行为

> ID：11509748
> 
> 赞同：4
> 
> 时间：2012-07-16T17:50:17.370
> 
> 标签：c++, virtual

我试图理解虚函数。

考虑以下代码，

```
#include <iostream>
#include <memory>
#include <vector>

class Animal 
{
public:
     virtual void eat() 
    {
        std::cout << "I eat like a generic animal.\n";
    }

};

class Wolf : public Animal 
{
public:
    void eat() 
    {
        std::cout << "I eat like a wolf!\n";
    }
};

int main() 
{

  Animal      a;
  Wolf        w;

  a.eat();
  w.eat(); 
```

}

使用`virtual`关键字我得到输出

```
I eat like a generic animal.
I eat like a wolf! 
```

正如它应该。

但是如果我删除 virtual 关键字，我仍然会得到相同的输出！从我对虚函数的基本理解来看，没有`virtual`我应该得到输出

```
I eat like a generic animal.
I eat like a generic animal. 
```

我缺少什么基本的东西吗？

我在 Linux 上使用 g++ 编译器

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:53:32.270

不，这是正确的行为。需要虚函数来引入多态性。要启用多态行为，您需要使用如下指针：

```
 Animal * a = new Animal();
 Animal * w = new Wolf();

 a->eat();
 w->eat();

 <...>

 delete a;
 delete w; 
```

如果您现在拥有它的方式，那么行为是正确的，因为这两个变量显然具有不同的类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T17:59:27.197

**多态性通过识别实例实际引用的对象类型来工作。**

在您的情况下，您的实际动物如下：

```
Animal      a;  //a is an animal.
Wolf        w;  //w is a wolf. 
```

* * *

**所以，你根本没有使用多态性。**

你需要做的更像是这样的：

```
//Create a couple animal pointers.
Animal* a;
Animal* b;

//Create an animal instance and have a point to it.
a = new Animal();

//Create a wolf instance and have b point to it.
b = new Wolf();

//Calls Animal::eat as a is an animal.
a->eat();

//Calls Wolf::eat as a is a wolf.
b->eat(); 
```

* * *

**请注意，您可以使用指针或引用来实现多态性的这种使用。**

这就是为什么在使用类类型时通常应该通过 const-reference 传递对象。

```
//Will call Animal::eat or Wolf::eat depending on what animal was created as.
void foo(const Animal& animal) {
    animal.eat();
}

//Will always call Animal::eat and never Wolf::eat since this isn't a reference or
//a pointer.  Will also "slice" a Wolf object.
void foo(Animal animal) {
    animal.eat();
} 
```

请注意，切片意味着它将不分青红皂白地将派生程度更高的类（狼）转变为该类（动物）的派生程度较低的副本，这可能会非常误导和出乎意料。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:56:34.877

即使没有虚拟，它仍然是一种方法。virtual 关键字在以下情况下允许多态行为：

```
Animal* wolf = new Wolf; // I eat like a wolf! (as long as eating is virtual) 
```

通过使用 virtual 关键字，您告诉编译器根据派生类型选择适当的实现以在运行时调用。

# mysql - 如何使用 JDBC 连接到带有 X509 的 MySQL？

> ID：11509751
> 
> 赞同：4
> 
> 时间：2012-07-16T17:50:38.370
> 
> 标签：mysql, ssl, jdbc

我已经建立了一个 MySQL (Community Server, 5.1) 数据库服务器。

我已经设置了 SSL，创建了证书等。

我创建了一个具有 REQUIRES X509 属性的用户。

我可以使用命令行客户端“mysql”使用此用户进行连接，“status”命令显示 SSL 处于活动状态等。

我完全按照 MySQL 站点上关于将证书导入 Java 信任库/密钥库文件的说明进行操作。

我只是无法使用这些连接到数据库。

如果我只使用具有 REQUIRES SSL 的用户使用信任库文件，那么一切都很好。与具有 REQUIRES X509 的用户一起使用密钥库文件只是没有它。

网上似乎有很多证据表明人们正在为此苦苦挣扎，而答案却不多。有没有人真正得到这个工作？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-23T20:11:09.350

破解，列在这里，在我的页面底部的评论中：http: [//dev.mysql.com/doc/refman/5.0/en/connector-j-reference-using-ssl.html](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-using-ssl.html)

在花了一周的时间做这件事之后，我终于设法使用客户端证书进行连接（在用户定义上需要 X509）！！！！

```
rem NOTE: these commands are run using the Java 6 (1.6) JDK as it requires the "-importkeystore" command
rem which is not available before this JDK version.

rem Import the self signed Certifacte Authority certificate into a keystore.
keytool -import -alias mysqlCACert -file ca-cert.pem -keystore truststore -storepass truststore
rem Shows only the signed certificate.
keytool -v -list -keystore truststore -storepass truststore

rem Create a PKCS12 file from an existing signed client certifcate and its private key.
rem set password to "keystore".
openssl pkcs12 -export -in client-cert.pem -inkey client-key.pem -out client.p12 -name clientalias -CAfile ca-cert.pem -caname root
rem Import the combined certificate and private key into the keystore.
keytool -importkeystore -deststorepass keystore -destkeystore keystore -srckeystore client.p12 -srcstoretype PKCS12 -srcstorepass keystore -alias clientalias 
```

然后通过连接 URL、JVM 启动参数参数 (-D=,...) 或System.setProperty(var,val),...

它确实有效！

# c# - 如何在网站更改时自动加载新文件

> ID：11509753
> 
> 赞同：0
> 
> 时间：2012-07-16T17:50:39.867
> 
> 标签：c#, xml, rss, xml-parsing

我有一个关于轮询或检测网站上 XML 文件更改的问题。我在下面有一个非常硬编码的系统，它从纽约联储读取关于他们日常证券借贷的 XML 文件。它运行良好，我对此没有任何问题。我的主要问题是我如何在每个工作日轮询网站的变化。我知道我可以检查 XML 文件上的“Last Modified”字段（或者在[本](http://www.newyorkfed.org/markets/seclend/xml/v3_0/secLendingXML.cfm)例中为“Prepared”字段），但我很好奇我是如何做到这一点的，以便在实际进行更改时XML 站点，我的计算机会自动加载并解析新的 XML 文件。信息一出来就立即获取对我来说非常重要，所以每 X 分钟轮询一次并没有我想要的那么好。有任何想法吗？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml;
using System.IO;
using System.Xml.Linq;
using System.Diagnostics;

namespace ConsoleApplication2 {
    class Program {
        static void Main(string[] args) {
            // XML text reader stuff
            //XmlReader textReader = XmlReader.Create("http://www.newyorkfed.org/markets/seclend/xml/v3_0/secLendingXML.cfm");
            XmlTextReader textReader = new XmlTextReader("http://www.newyorkfed.org/markets/seclend/xml/v3_0/secLendingXML.cfm");
            //SyndicationFeed feed = SindicationFeed.Load(textReader);
            //XmlTextReader textReader = new XmlTextReader("LOCATION");
            //string[] Fed_Array = new string[] {"Actual Available to Borrow", "Outstanding Loans",
            //"Par Submitted", "Par Accepted", "WTD Average Rate"};
            int j = 0;
            int icount = 0;
            using(StreamWriter writer = new StreamWriter("LOCATION"))
            //using (StreamWriter writer = new StreamWriter("LOCATION"))    
            while (textReader.Read()) {
                switch (textReader.NodeType) {
                case XmlNodeType.Element:
                    for (int i = 0; i < textReader.AttributeCount; i++) {
                        textReader.MoveToAttribute(i);
                        switch (textReader.Name) {
                        case "securityMaturityDate":
                            string textvalmatd = textReader.Value;
                            if (i == 0 && icount == 0) {
                                writer.Write("N/A,");
                                Console.Write("N/A,");
                                icount = 1;
                                i = -1;
                            } else {
                                writer.Write(textvalmatd + ",");
                                Console.Write(textvalmatd + ",");
                                icount = 0;
                            }
                            break;
                        case "couponRate":
                            string textvalcoup = textReader.Value;
                            writer.Write(textvalcoup + ",");
                            Console.Write(textvalcoup + ",");
                            break;
                        case "securityType":
                            string textvalsec = textReader.Value;
                            writer.Write(textvalsec + ",");
                            Console.Write(textvalsec + ",");
                            j = 0;
                            break;
                        case "value":
                            string textval = textReader.Value;
                            writer.Write(textval + ",");
                            Console.Write(textval + ",");
                            j = j + 1;
                            if (j > 4) {
                                writer.Write(Environment.NewLine);
                                Console.Write(Environment.NewLine);
                            }
                            break;

                        }
                    }
                    break;
                }
            }
        }

        private static IDisposable StreamWriter(string p) {
            throw new NotImplementedException();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:53:49.913

除非美联储提供某种事件表明有新文件可用（我怀疑是这种情况），否则理论上最好的做法是下载最新的 XML 文件并检查它是否比以前的文件更新。

如果该文件确实每天发布一次，您可以生成自己的统计信息，了解该文件每天发布的确切时间。在围绕该典型发布时间的窗口中加强您的轮询（但请确保您在轮询频率中没有违反任何服务条款）。

# installation - 需要帮助安装 pear、pecl 和 pecl->ps

> ID：11509754
> 
> 赞同：0
> 
> 时间：2012-07-16T17:50:41.560
> 
> 标签：installation, pear, pecl, yum, ps

最终目标是能够使用我相信包含在 PEAR 中的 PECL -> PS 来读取/写入/执行 postscript 文件。

我已经完成了所有基础知识`# yum update`，`# yum install php-pear`. 但是，我不能将 PEAR 与 php 脚本一起使用，但可以通过 ssh。我想我需要更新一些 .ini 文件，但哪些？

系统：Linux虚拟服务器，CentosOS 5。

更新：我做了如下

```
# cd /usr/share/
# wget http://pear.php.net/go-pear.phar
# php go-pear.phar 
```

它将 /usr/share/pear 中的所有内容解压缩并使用`include_path = ".:/usr/share/pear:"`. 现在，当我使用`echo get_include_path();`它时，它会按预期显示，但仍然不能包含或需要“pear.php”。`# pear version`返回 PEAR 版本：1.9.4 - 所以它可以工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:01:12.490

您需要更改以更改 php 文件夹中的 php.ini 设置文件。基本上您必须取消注释有关扩展的行，才能激活它！这是一个参考链接：http: [//phphints.wordpress.com/2008/08/26/installing-pear-package-manager-on-wamp/](http://phphints.wordpress.com/2008/08/26/installing-pear-package-manager-on-wamp/)

# c++ - 隐式将返回的左值视为右值

> ID：11509757
> 
> 赞同：19
> 
> 时间：2012-07-16T17:50:45.143
> 
> 标签：c++, c++11, return, move-semantics

12.8 复制和移动类对象 [class.copy] §31 和 §32 说：

> 在具有类返回类型的函数的 return 语句中，**当表达式是**具有与函数返回类型相同的 cv 非限定类型的非易失性自动对象（函数或 catch 子句参数除外）的名称时，通过将自动对象直接构造到函数的返回值中，可以省略复制/移动操作
> 
> 当满足或将满足复制操作的省略标准时，除了源对象是函数参数的事实，并且要复制的对象由左值指定时，选择复制构造函数的重载决策是首先执行好像对象是由右值指定的。

因此我们可以写：

```
unique_ptr<int> make_answer()
{
    unique_ptr<int> result(new int(42));
    return result;   // lvalue is implicitly treated as rvalue
} 
```

但是，我注意到 g++ 4.6.3 也接受**不是名称**的左值，例如：

```
 return (result);
    return *&result;
    return true ? result : result; 
```

相比之下，`return rand() ? result : result;`行不通。编译器的优化器是否干扰了语言语义？正如我解释的标准，`return (result);`不应该编译，因为`(result)`不是一个名字，而是一个带括号的表达式。我是对还是错？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T18:20:28.340

## 关于*括号表达式*[√]

在谈论带括号的表达式时，您错了，并且在*返回*并且仅包含*可移动*对象的名称时，它不应该能够触发*移动。*

 **> ### 5.1.1/1 一般 [expr.prim.general]
> 
> 带括号的表达式是主要表达式，其类型和值与括起来的表达式相同。括号的存在不会影响表达式是否为左值。**带括号的表达式可以用在与可以使用括起来的表达式完全相同的上下文中**，并且**具有相同的含义**，除非另有说明。

* * *

## 关于 constexpr**条件运算符**[╳]

~~^(我解释关于*常量表达式*和*条件运算符*的标准的方式是，由于它是一个常量表达式，因此它的使用`return true ? result : result`表现良好，因此相当于*返回结果；*)~~

我现在已经更仔细地阅读了该标准，并且没有任何地方说*常量条件表达式*与仅编写*“返回”表达式相同。*

```
true ? <expr1> : <expr2>; // this is not the same as just writing <expr1>; 
```

* * *

## 关于*退货 *&result;* [╳]

在 C99 中明确指出，`*&result`这**完全**等同于编写`result`，而在 C++ 规范中并非如此。

尽管我们都同意 using`*&result`确实会产生与 相同的左*值*`result`，但根据标准`*&result`（当然）不是*“表达式是非易失性自动对象的名称”的表达式*。

当然，*表达式*包含一个适当的名称，但不仅如此。

* * *

### 总结一下...

```
return result; // #1, OK 
```

```
return (result);                  // as described earlier, OK
return true ? result : result;    // as described earlier, ill-formed
return rand () ? result : result; // as described earlier, ill-formed
return *&result;                  // as described earlier, ill-formed 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:46:55.163

除非另有说明（例如，在 ADL 规则中所做的那样，或者在另一个示例中通过 decltype 完成），否则带括号的表达式等同于它们未带括号的表达式。有时，当某些东西以这种方式不等价时，有时会很棘手（例如，ADL 规则没有明确提到“无括号”，但它们使用了显式的非终结语法，并且示例清楚地表明括号不是认为是等价的）。

对于其他问题：是的，GCC 直接对 AST 进行了一些优化，使其接受各种无效程序，如下所示

```
int a = 42;
int *p = 0 * a; 
```**

# ios - 在构建之前配置应用沙盒

> ID：11509758
> 
> 赞同：0
> 
> 时间：2012-07-16T17:50:49.143
> 
> 标签：ios, core-audio, sandbox, audioqueue

我想我的问题是如何预先配置我的 iOS 沙箱以在其中包含音频文件，以便在构建后立即测试我的音频队列结构。

我正在开发一个 iOS 应用程序来播放我在服务器上托管的流中的音频。在我解决如何从 HTTP 流中获取数据之前，我想我会先使用音频队列服务来播放手机中的文件。据我了解，如果您想一次播放多个音频流，则必须使用音频队列，而不是 AVPlayer 或任何其他服务。

我遇到的问题是我无法配置我的 CFURLRef 因为我找不到我的文件。

```
AudioBufferPlayer *player = (AudioBufferPlayer*) inUserData;

if (player.playing) {

    NSString *path = @"/Users/acopp/Library/Application Support/iPhone Simulator/5.1/Applications/F9CA1197-A661-4B2F-9B42-68A991F61B19/";
    const char *filePath = [path cStringUsingEncoding:[NSString defaultCStringEncoding]];
    CFURLRef audioFileURL = CFURLCreateFromFileSystemRepresentation(NULL, (const UInt8*)filePath, strlen(filePath), false);

    OSStatus result = AudioFileOpenURL(audioFileURL, kAudioFileReadPermission, kAudioFileCAFType, player.mAudioFile); 

    UInt32 numBytesReadFromFile;
    UInt32 numPackets = player.mNumPacketsToRead;

    AudioFileReadPackets(
                         *(player.mAudioFile),
                         false,
                         &numBytesReadFromFile,
                         NULL,
                         player.mCurrentPacket,
                         &numPackets,
                         inBuffer->mAudioData
                         );

    if (numPackets > 0) {
        inBuffer->mAudioDataByteSize = numBytesReadFromFile;
        AudioQueueEnqueueBuffer(inAudioQueue, inBuffer, 0, NULL);
        player.mCurrentPacket += numPackets;
    } 
```

我在我的 AudioFileReadPackets 收到一条错误消息 EXC_BAD_ACCESS，此时我的 OSStatus 结果设置为 -50，所以我认为我的 AudioFileOpenURL 调用失败。

我认为我的问题是我的 *path 在这一点上并没有真正指向任何东西。问题是当我去

```
@"/Users/acopp/Library/Application Support/iPhone Simulator/5.1/Applications/F9CA1197-A661-4B2F-9B42-68A991F61B19/" 
```

我的四个选项是 Demo3、Documents、Library 和 temp。这些都没有我添加到项目中的 quick.caf 文件。

**TL，DR - 除非我忽略了某些东西，否则我相信我会在构建之前询问如何将音频文件添加到我的沙箱中，以便我可以在 iPhone 模拟器上测试我的代码。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:44:17.287

添加到项目中的文件最终位于应用程序的 Bundle 目录中，而不是 Documents 或 Library/Caches。对于 Simulator，此应用程序包通常位于 Xcode Build 或 DerivedData 目录中，而不是 Simulator Application Support 区域。

获得良好路径的一种简单方法是，在应用程序的第一次运行期间，在应用程序的沙箱 Documents 或 Library/Caches 目录中创建一些具有唯一名称的微小虚拟文件。退出应用程序，删除此文件创建代码，然后在 Mac 上使用 Spotlight 查找虚拟文件。用任何你想要的替换。然后运行应用程序，从用于创建虚拟文件的相同路径读取代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T12:50:07.080

您可以使用 ：

```
 NSString *bundlePath = [[NSBundle mainBundle] bundlePath]; 
```

获取项目中包含的文件。

# java - Java中的组织结构图/树

> ID：11509760
> 
> 赞同：1
> 
> 时间：2012-07-16T17:50:51.453
> 
> 标签：java, charts, tree

我正在尝试用 Java 制作组织结构图/树。我尝试使用 Prefuse，但它的库非常有问题，而且我有点编程初学者。我还研究了使用 google 的图表工具，但它是基于 JavaScript 的。我需要使用 Java 而不是 JavaScript，因为我需要访问本地文件。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T10:28:33.877

There is organisation chart component already implemented in Vaadin you can find and download it [here](http://www.lexaden.com/main/entry/lexaden_organisation_chart)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:11:22.330

我以前没有使用过 Prefuse，但假设您的组织结构图可以建模为图形，那么[JGraphT可能对您有用。](http://jgrapht.org/)

# php - 使用PHP按字母顺序对html字符串进行排序

> ID：11509774
> 
> 赞同：0
> 
> 时间：2012-07-16T17:52:28.510
> 
> 标签：php

请参阅下面的代码。我想按名称而不是 id 对选项标签进行排序。

这是我的代码：

```
<?php

$string = '<option id=a1>Sinead Shannon Roche<option id=a2>Emile Abossolo Mbo<option id=a3>Youssouf Djaoro<option id=a4>Dioucounda Koma';
$new_string = '';

$s = explode('<', $string);
asort($s);
foreach($s AS $v) {
    $new_string = $new_string . '<' . $v;
}

// I want $new_string to be "<option id=a4>Dioucounda Koma<option id=a2>Emile Abossolo Mbo<option id=a1>Sinead Shannon Roche<option id=a3>Youssouf Djaoro"

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:58:19.057

我自己会为此使用 JQuery...

如果你有兴趣这里的代码。

声明一个全局函数

```
$.fn.sortSelect = function() {
    var op = this.children("option");
    op.sort(function(a, b) {
        return a.text > b.text ? 1 : -1;
    })
    return this.empty().append(op);
} 
```

并从代码中调用该函数。

```
$("#my_select").sortSelect(); 
```

# .htaccess - 重定向旧 URL 并避免 404

> ID：11509775
> 
> 赞同：0
> 
> 时间：2012-07-16T17:52:32.083
> 
> 标签：.htaccess, redirect

我的旧网址是

```
http://site.com/news/183/Blue+Lagoon 
```

这是htaccess

```
RewriteRule ^([a-z]+)(/([^/]{0,32})(/.+)?)?$  index.php?a=$1&q=$3    [L] 
```

现在我改变了 url 结构，我的 url 就像

```
http://site.com/news/183 
```

htaccess 中的行是

```
RewriteRule ^([a-z]+)(/([^/]{0,32})?)?$  index.php?a=$1&q=$3    [L,NC] 
```

现在，当用户在我的网站上来自 google 时，我有 404 错误，google 网站管理员工具也向我报告了这个错误，我如何使用 htaccess 将旧 url 重定向到新 url...

# entity-framework - 为原始表创建视图时，如何在实体框架流式映射中使用相同的 FK 到另一个表

> ID：11509783
> 
> 赞同：0
> 
> 时间：2012-07-16T17:52:51.930
> 
> 标签：entity-framework

我正在尝试为视图的实体设置流畅的映射。问题是，我有一个类似于视图的表（视图是用于 - 不同之处在于视图在末尾添加了一些聚合列）和一个实体，所以我可以有一个 FK它的同一个子表。我希望视图和表都能够具有相同的子列表定义，但 EF 不喜欢它，因为它不允许视图的实体和表的实体使用相同命名的外部关键，但我需要。我怎样才能解决这个问题？

IE

```
 public class ViewEntity
  {
      public ICollection<ChildEntity> ChildEntities { get;set;}
  }

  public class TableEntity
  {
      public ICollection<ChildEntity> ChildEntities { get;set;}
  }

  public class ChildEntity
  {
      public int TableEntityId { get; set; } 
  } 
```

# symfony - Symfony 2 - 使用表单时未设置 Sluggable

> ID：11509784
> 
> 赞同：8
> 
> 时间：2012-07-16T17:52:54.003
> 
> 标签：symfony, doctrine-orm, slug

我正在尝试使用 Doctrine Extensions 捆绑包中的 Sluggable 行为：

[http://gediminasm.org/article/sluggable-behavior-extension-for-doctrine-2](http://gediminasm.org/article/sluggable-behavior-extension-for-doctrine-2)

我已经使用注释在我的实体中设置了一个 sluggable 字段，但是当我使用表单创建实例时没有设置值，这会导致以下错误：

> SQLSTATE [23000]：违反完整性约束：1048 列“slug”不能为空

这是我的控制器的代码：

```
 $form = $this->createFormBuilder($section)
                        ->add('title', 'text')
                        ->getForm();

        if ($request->getMethod() == 'POST') {
        $form->bindRequest($request);

            if ($form->isValid()) {

                $em = $this->getDoctrine()->getEntityManager();
                $em->persist($section);
                $em->flush();

                if (empty($id)) {
                    return $this->redirect($this->generateUrl('ContentBundle_section_new'));
                }
                else {
                    return $this->redirect($this->generateUrl('ContentBundle_section_edit', array('id' => $id)));
                }

            }
        } 
```

以及 Entity 类中的 sluggable 字段定义：

```
 /**
     * @Gedmo\Slug(fields={"title"})
     * @ORM\Column(length=128, unique=true)
     */
    private $slug; 
```

如果我将 slug 字段添加到 formbuilder 并手动设置一个值，它可以正常工作，但显然我不想搞砸这个。

任何人都可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-16T19:23:01.100

知道了。

我忘记将以下行添加到 config.yml 文件中：

sluggable：真

所以它应该是这样的：

```
stof_doctrine_extensions:
    default_locale: en
    translation_fallback: true
    orm:
        default:
            tree: true
            timestampable: true
            sluggable: true 
```

# git - 使用 git add --patch 时查找下一个匹配的块

> ID：11509789
> 
> 赞同：2
> 
> 时间：2012-07-16T17:53:19.650
> 
> 标签：git, git-add

我发现使用**git add --patch**有时对我的工作流程非常有用，例如当我需要在准备提交任何内容之前修改很多内容时，尤其是文档。如果我有大量要筛选的帅哥，通过**/**的搜索功能很有帮助，但我还没有找到任何方法来搜索与我的正则表达式匹配的下一个帅哥，而无需每次都重新输入正则表达式。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:57:36.907

`git add`不是 bash shell，所以你不能只回忆历史。只需在执行之前将正则表达式复制到剪贴板即可。然后你可以在下次粘贴它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:14:54.623

您可以尝试使用[rlwrap](http://utopia.knoware.nl/~hlub/rlwrap/#rlwrap)（这是任何命令的 readline），例如：

```
rlwrap git add --patch 
```

# iphone - 在 iphone 中创建注册表单

> ID：11509800
> 
> 赞同：0
> 
> 时间：2012-07-16T17:53:58.377
> 
> 标签：iphone

我们正在开展该项目，我们的要求之一是创建一个注册表单，它看起来与下图相同 ![在此处输入图像描述](../Images/fe391277eb2835cf3c882ff1cdb81ec8.png)

我们正在尝试使用表格视图控制器并尝试使用文本字段，但它看起来并不好。

我们正在寻求一个建议，如何获得一个好的和友好的注册表格式。

如果您有任何建议，请提供帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:58:21.617

一个表格*可以*工作，但你会有很多不同类型的单元格。如果您想在一个巨大的视图中显示整个内容，请在 IB 中布置视图，然后将整个内容粘贴到滚动视图中。表格实际上只是一个专门的滚动视图，因此您将获得大致相同的效果。

另一种选择是使用 HTML 进行布局并使用 web 视图显示它（它有自己的滚动视图，所以你不必担心那部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:03:11.243

将这个巨大的表单拆分为适合小屏幕的几个较小的视图，逻辑分组的字段使用户一个接一个地完成......也许将用户对象从一个表单传递到另一个表单，最后将其发布到您希望的任何地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:53:23.133

与 Ivor 的回答类似，您应该将上图中的每个部分制作成一屏内容，每个屏幕上都有下一步和后退按钮。另外，绝对要使用文本字段。UITableViews 不是为处理这样​​的表单而设计的。

# ruby-on-rails - 在 Rails 中压缩目录

> ID：11509802
> 
> 赞同：7
> 
> 时间：2012-07-16T17:54:02.393
> 
> 标签：ruby-on-rails, ruby, zip, rubyzip

如何在 ruby​​ on rails 中压缩目录？我试过 ruby​​zip 没有成功。我不需要单独压缩目录的内容，只需压缩目录本身。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T17:58:34.320

您将不得不遍历目录中的项目以在压缩文件中添加一个条目。

```
def compress(path)
  gem 'rubyzip'
  require 'zip/zip'
  require 'zip/zipfilesystem'

  path.sub!(%r[/$],'')
  archive = File.join(path,File.basename(path))+'.zip'
  FileUtils.rm archive, :force=>true

  Zip::ZipFile.open(archive, 'w') do |zipfile|
    Dir["#{path}/**/**"].reject{|f|f==archive}.each do |file|
      zipfile.add(file.sub(path+'/',''),file)
    end
  end
end 
```

> [http://grosser.it/2009/02/04/compressing-a-folder-to-a-zip-archive-with-ruby/](http://grosser.it/2009/02/04/compressing-a-folder-to-a-zip-archive-with-ruby/)

另一种使用命令的方法

```
Dir["*"].each do |file|
  if File.directory?(file)
    #TODO add OS specific,
    #  7z or tar .
    `zip -r "#{file}.zip" "#{file}"`
  end
end 
```

> [http://ruby-indah-elegan.blogspot.com/2008/12/zipping-folders-in-folder-ruby-script.html](http://ruby-indah-elegan.blogspot.com/2008/12/zipping-folders-in-folder-ruby-script.html)

**更新**

感谢 Mahmoud Khaled 的编辑/更新

对于新版本使用`Zip::File.open`，而不是`Zip::ZipFile.open`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T05:19:30.027

您可以使用 tar 创建目录的存档 `tar -cvf your_dir.tar your_dir/`

然后使用 - 压缩rails中的焦油 -

```
def gzip_my_dir_tar(your_dir_tar_file)
  content = File.read(your_dir_tar_file)
  ActiveSupport::Gzip.compress(content)
end 
```

它已经在 Rails 3 上得到了回答[：如何根据请求生成压缩文件](https://stackoverflow.com/questions/5030583/rails-3-how-do-i-generate-a-compressed-file-on-request)

# c# - 从 URL 读取 XML 并将其分配给列表

> ID：11509804
> 
> 赞同：-1
> 
> 时间：2012-07-16T17:54:11.523
> 
> 标签：c#, xml

[http://api.serviceu.com/rest/events/occurrences?orgkey=613dc2ce-0b32-4926-8e7e-33ee279be1cb](http://api.serviceu.com/rest/events/occurrences?orgkey=613dc2ce-0b32-4926-8e7e-33ee279be1cb)

我有上面有 n 次出现的 xml url。我需要阅读所有事件并将其加载到列表项中。如何使用 xml 阅读器做到这一点。

```
 XmlTextReader reader = new XmlTextReader(strURL);

 while (reader.Read())
 {

 } 
```

例如，我如何阅读每个事件的 CategoryList、ContactEmail、Description。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:16:19.770

您可以使用[`XmlReader`](http://msdn.microsoft.com/en-us/library/b8a5e1s5)：

```
using(XmlReader reader = XmlReader.Create("..."))
{
    while (reader.Read())
    {
        if (reader.IsStartElement())
        {
            switch (reader.Name)
            {
                case "CategoryList":
                    var cat = reader.ReadElementContentAsString();
                    break;
                case "ContactEmail":
                    var email = reader.ReadElementContentAsString();
                    break;
            }
        }
    }
} 
```

或[`XmlDocument`](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument)白衣`XPath`：

```
XmlDocument document = new XmlDocument();
document.Load("...");
foreach (XmlNode node in document.SelectNodes("//CategoryList"))
{
    var cat = node.InnerText;
}

foreach (XmlNode node in document.SelectNodes("//ContactEmail"))
{
    var email = node.InnerText;
} 
```

*或LB*提到的 Linq-to-Xml 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:05:18.707

Linq2Xml 可以让生活更轻松。

```
XDocument xDoc = XDocument.Load("http://api.serviceu.com/rest/events/occurrences?orgkey=613dc2ce-0b32-4926-8e7e-33ee279be1cb");
var list = xDoc.Descendants("Occurrence")
            .Select(o => new Item
            {
                Category = (string)o.Element("CategoryList"),
                EMail = (string)o.Element("ContactEmail"),
                Description = (string)o.Element("Description"),
            })
            .ToList();

public class Item
{
    public string Category;
    public string EMail;
    public string Description;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:00:35.783

```
XmlTextReader reader = new XmlTextReader(strURL);

    while (reader.Read())
    {
        switch(reader.Name)
         {
            case "ContactEmail":
                  //reader.ReadElementContentAsString();
              break;
             //...
         }
    } 
```

我将为 XML 文档中的每个集合创建一个支持类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:25:49.887

```
[DataContract(Name = "Occurrence", Namespace = "")]
class Occurrence
{
    [DataMember]
    public string CategoryList { get; set; }
    [DataMember]
    public string ContactEmail { get; set; }
    [DataMember]
    public string Description { get; set; }
} 
```

```
var ser = new DataContractSerializer(typeof(List<Occurrence>), "Occurrences", "");

List<Occurrence> objects = null;
using (var reader = XmlReader.Create(strURL))
{
    objects = (List<Occurrence>) ser.ReadObject(reader);
} 
```

# jquery - jquery自动完成标签值在asp.net中未定义

> ID：11509806
> 
> 赞同：0
> 
> 时间：2012-07-16T17:54:16.700
> 
> 标签：jquery, asp.net, web-services, jquery-ui, jquery-autocomplete

我正在尝试使用 jquery 在自动完成中显示一些城市，当任何人选择城市时，然后将目标 ID 设置为隐藏字段。我正在使用 Web 服务来获取 ajax 调用的数据。

这是我的网络服务方法：

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public List<BALDestinations> AuotExtenderDestination(string destinationname)
    {
        DataSet ds=objDestination.GetDestination(destinationname);
        List<BALDestinations> result = new List<BALDestinations>();
        foreach (DataRow dr in ds.Tables[0].Rows)
        {
            BALDestinations b = new BALDestinations();
            b.City = dr["City"].ToString();
            b.DestinationId = dr["DestinationId"].ToString();
            result.Add(b);
        }
        return result;
    } 
```

这是我的 jquery 自动完成文本框扩展器的代码

```
<script type="text/javascript">
    $(document).ready(function () {
        SearchText();
        $('#btnSearch').click(function () {
            alert($("#hiddenAllowSearch").val());
        });
    });  
    function SearchText() {
        $(".txtdest").autocomplete({
            //   source: $local_source,
            source: function (request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "WebService.asmx/AuotExtenderDestination",
                    data: "{'destinationname':'" + $('.txtdest').val() + "'}",
                    dataType: "json",
                    success: function (data) {
                      response(data.d);                      
                    },
                    error: function (result) {
                        alert("Error");
                    }
                });
            },
            focus: function (event, ui) {
                $(".txtdest").val(ui.item.label);
                return false;
            },
            select: function (event, ui) {
                $(".txtdest").val(ui.item.label);
                $("#hiddenAllowSearch").val(ui.item.value);
                return false;
            }
        });
    } 
</script> 
```

当我们在文本框中输入任何内容时，undefined 会出现在文本框中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:59:07.780

如果您从 Web 服务返回的类的属性不是`label`, 和`value`，那么 jQuery 自动完成代码将尝试从不存在的属性中读取值，从而出现您的`undefined`问题。

如果您不想更改您的类属性，您可以设置自动完成以查看您的实际属性名称。您可以在通过函数发送之前手动`response(data.d)`将类属性映射到`label`并手动映射，而不是仅仅调用：`value``response`

```
response($.map(data.d, function (item) {
    return { 
        label: item.City, 
        value: item.DestinationId
    };
})); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T21:17:06.513

如果您想将城市、州/省和国家/地区名称添加到标签而不是单个城市名称，那么您可以扩展您的代码并将额外的值添加到自定义对象：

服务：

```
foreach (DataRow dr in ds.Tables[0].Rows)
{
    BALDestinations b = new BALDestinations();
    b.City = dr["City"].ToString();
    b.DestinationId = dr["DestinationId"].ToString();
    b.State = dr["State"].ToString();
    b.Province = dr["Province"].ToString();
    b.Country = dr["Country"].ToString();

    result.Add(b);
} 
```

阿贾克斯`success`回调：

```
response($.map(data.d, function (item) {

    // return custom object
    var resultList = { 
        label: item.City + ", " + item.State + ", " +
               item.Province + "' " + item.Country, 
        value: item.DestinationId,

        // Alternatively, you can return the properties in
        // this object and display them via _renderItem     
        state: item.State, 
        province: item.Province, 
        country: item.Country 
    };

    return resultList;
})); 
```

要在自动完成列表中显示州、省和国家/地区，请覆盖`_renderItem`：

```
$(".txtdest").autocomplete({
    source: function (request, response) {
        // etc.
    }
}).data("autocomplete")._renderItem = function (ul, item) {
    return $("<li></li>")
    .data("item.autocomplete", item)
    .append("<a><strong>" + item.value + "</strong><br>" + item.state +
            " PROVINCE: " + item.province + " COUNTRY: " + item.country + "</a>")
    .appendTo(ul);
}; 
```

# r - barplot() 中的标签

> ID：11509809
> 
> 赞同：2
> 
> 时间：2012-07-16T17:54:33.943
> 
> 标签：r

我正在尝试将名称添加到我的条形图的列中...每组中有 2 个条具有相同的名称..

我正在使用这样的代码：

```
l<-c(.6286, .2212, .9961, .5831, .8703, .6990, .9952, .9948)

r<-c(.2721, .5663, .0, .3961, .0696, .1180, .0, .0)

tab<-rbind(l,r)

plot<-barplot(tab, beside=TRUE, axisnames=FALSE, main = 'Time Spent Left vs. Right', sub = 'Female 2c', xlab= 'Days After Entry', ylab = 'Proportion of Time Spent', col=c('blue', 'red'), ylim = c(0,1))
legend('topleft', .8,  c('Left' , 'Right'), pch=c(.8), col=c('blue', 'red'))
names.arg = jd2c$d.in.p

names.arg=c(3,4,5,6,6,7,10,11) #listed for informational purposes, same as jd2c$d.in.p 
```

jd2c$d.in.p 也在上面列出。由于某种原因，names.arg 函数似乎没有按照我的预期进行。即使我把它放在 bar plot() 函数的括号内..

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:12:48.360

使用你的数据和`names.arg`适当的设置`axisnames=TRUE`，我得到一个合理的结果。我调整了其他一些东西（设置`las=1`为水平轴标签，使用`fill`而不是`col`在图例中，摆脱了`pch=0.8`）。

```
par(las=1)
bnames <- c(3,4,5,6,6,7,10,11) #listed for informational purposes, same as jd2c$
plot<-barplot(tab, beside=TRUE, axisnames=TRUE,
              main = 'Time Spent Left vs. Right',
              sub = 'Female 2c', xlab= 'Days After Entry',
              ylab = 'Proportion of Time Spent',
              col=c('blue', 'red'), ylim = c(0,1),
              names.arg=bnames)
legend('topleft', cex=1,  c('Left' , 'Right'), fill=c('blue', 'red')) 
```

![在此处输入图像描述](../Images/16136ff05d4b25cb63673c0c852725d8.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:17:35.443

您`names.arg`不是将其定义为`barplot`函数的参数，而是定义为一个完全独立的变量——它位于括号之外。这个：

```
plot<-barplot(tab, beside=TRUE, axisnames=FALSE, main = 'Time Spent Left vs. Right', sub = 'Female 2c', xlab= 'Days After Entry', ylab = 'Proportion of Time Spent', col=c('blue', 'red'), ylim = c(0,1))
legend('topleft', .8,  c('Left' , 'Right'), pch=c(.8), col=c('blue', 'red'))
names.arg = jd2c$d.in.p 
```

应该：

```
plot<-barplot(tab, beside=TRUE, axisnames=FALSE, main = 'Time Spent Left vs. Right', sub = 'Female 2c', xlab= 'Days After Entry', ylab = 'Proportion of Time Spent', col=c('blue', 'red'), ylim = c(0,1), names.arg = jd2c$d.in.p)
legend('topleft', .8,  c('Left' , 'Right'), pch=c(.8), col=c('blue', 'red')) 
```

您还必须设置`axisnames=TRUE`要显示的名称。

# objective-c - 如何在 Objective-C 中使图像适合屏幕大小

> ID：11509810
> 
> 赞同：0
> 
> 时间：2012-07-16T17:54:36.073
> 
> 标签：objective-c, xcode

我正在处理应用程序的图像查看部分，我正在寻找一种调整图像大小或使其适合屏幕的方法。我的设置目前看起来像这样。

```
photos = [[NSMutableArray alloc]init];

Photo *pic = [[Photo alloc]init];
[pic setName:@"Picture"];
[pic setFilename:@"Pic.jpeg"];
[pic setNotes:@"Description"];
[photos addObject:pic];

pic = [[Photo alloc]init];
[pic setName:@"Picture2"];
[pic setFilename:@"pic2.jpeg"];
[pic setNotes:@"Description2"];
[photos addObject:pic];

pic = [[Photo alloc]init];
[pic setName:@"Picture3"];
[pic setFilename:@"Pic3.jpeg"];
[pic setNotes:@"Description3"];
[photos addObject:pic];

pic = [[Photo alloc]init];
[pic setName:@"Picture4"];
[pic setFilename:@"Pic4.jpeg"];
[pic setNotes:@"Description4"];
[photos addObject:pic]; 
```

这是我为segue方法做的准备

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{

    if ([segue.identifier isEqualToString:@"ShowPhoto"]) 
    {
        DisplayViewController *dvc = [segue destinationViewController];
        NSIndexPath *path = [self.tableView indexPathForSelectedRow];
        Photo *c = [photos objectAtIndex:path.row];
        [dvc setCurrentPhoto:c];
    }
} 
```

应该添加什么代码以使图像适合屏幕？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:02:26.360

在您的 UIImageView 中是 UIView 的子类。这允许您设置 UIViewContentMode 属性。您的选择是：

```
typedef enum {
   UIViewContentModeScaleToFill,
   UIViewContentModeScaleAspectFit,
   UIViewContentModeScaleAspectFill,
   UIViewContentModeRedraw,
   UIViewContentModeCenter,
   UIViewContentModeTop,
   UIViewContentModeBottom,
   UIViewContentModeLeft,
   UIViewContentModeRight,
   UIViewContentModeTopLeft,
   UIViewContentModeTopRight,
   UIViewContentModeBottomLeft,
   UIViewContentModeBottomRight,
} UIViewContentMode; 
```

我相信您正在寻找 ScaleAspectFit。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:02:57.047

制作一个与屏幕大小相同的 UIImageView。我假设你所有的照片都不是正确的比例不能被拉伸，所以我要做的是前面提到的 UIImageView （从现在开始我会调用它`backImageView`）并将它的背景设置为白色，或者任何颜色的背景你的图像。然后在你的view的viewDidLoad中，创建一个尽可能大的新的UIImageView，同时尊重原来的纵横比，然后把它放在新的UIImageView之上。像这样的东西：

```
double x = pic.size.width;
double y = pic.size.height;
if(x != 0 && y != 0){

    double ratio = x/y;
    CGRect cellImageFrame = backImageView.frame;
    UIImageView *actualPic = [[UIImageView alloc] init];

    if(y <= 320){
            if(x < 320){

                y = 320;
                x = y*ratio;
                double xoffset = cellImageFrame.size.width -x;
                cellImageFrame = CGRectMake(cellImageFrame.origin.x + (xoffset/2), cellImageFrame.origin.y+2, x, y);
            }else{
                x = 320;
                y = x/ratio;
                double yoffset = cellImageFrame.size.height -y;
                cellImageFrame = CGRectMake(cellImageFrame.origin.x+2, cellImageFrame.origin.y + (yoffset/2), x, y);

            }
        }else{
            y = 320;
            x = ratio*y;
            if(x < 320){
                double xoffset = cellImageFrame.size.width -x;
                cellImageFrame = CGRectMake(cellImageFrame.origin.x + (xoffset/2), cellImageFrame.origin.y+2, x, y);
            }else{
                x = 320;
                y = x/ratio;

                double yoffset = cellImageFrame.size.height -y;
                cellImageFrame = CGRectMake(cellImageFrame.origin.x+2, cellImageFrame.origin.y + (yoffset/2), x, y);

            }
        }

        actualPic.image = pic;
        actualPic.frame = cellImageFrame; 
```

这可能需要一些调整，我的代码不是全屏的，我试图修改它，但我现在无法测试它，所以我不能确定。基本上你只需弄清楚尺寸和纵横比，然后找出它是否比屏幕大。如果是，找出它是否比它高，或者它是否是方形的，并相应地缩放。这不考虑放大图像，如果你想这样做，请检查最小尺寸，然后使用纵横比将其放大。一旦你将框架设置为所需的大小，设置图像将使图像自动填充框架，只要你有 UIViewContentModeScaleAspectFit。

# php - 从函数调用 PHP 对象方法

> ID：11509812
> 
> 赞同：4
> 
> 时间：2012-07-16T17:54:40.433
> 
> 标签：php, class, function, object, methods

我有创建类对象的受保护函数

```
protected function x() {
    $obj = new classx();
} 
```

现在我需要从不同的函数访问类对象的方法（我不想再次初始化）。

```
protected function y() {
    $objmethod = $obj->methodx();
} 
```

我怎样才能完成它？

哦，这两个函数都存在于同一个类中说'class z{}'

错误信息是

```
Fatal error: Call to a member function get_verification() on a non-object in 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:58:54.573

Store ， 的一个属性中`$obj`的实例，可能作为一个属性。在构造函数或其他初始化方法中对其进行初始化，并通过.`classx``ClassZ``private``ClassZ``$this->obj`

```
class ClassZ {
  // Private property will hold the object
  private $obj;

    // Build the classx instance in the constructor
  public function __construct() {
    $this->obj = new ClassX();
  }

  // Access via $this->obj in other methods
  // Assumes already instantiated in the constructor
  protected function y() {
    $objmethod = $this->obj->methodx();
  }

  // If you don't want it instantiated in the constructor....

  // You can instantiate it in a different method than the constructor
  // if you otherwise ensure that that method is called before the one that uses it:
  protected function x() {
    // Instantiate
    $this->obj = new ClassX();
  }

  // So if you instantiated it in $this->x(), other methods should check if it
  // has been instantiated
  protected function yy() {
    if (!$this->obj instanceof classx) {
      // Call $this->x() to build $this->obj if not already done...
      $this->x();
    }
    $objmethod = $this->obj->methodx();
  }
} 
```

# ios - 可以覆盖类别方法吗？IOS

> ID：11509813
> 
> 赞同：12
> 
> 时间：2012-07-16T17:54:44.313
> 
> 标签：ios, overriding, objective-c-category

我正在尝试计划如何向某些对象的所有实例添加几个方法。我认为向父对象（UIViewController）添加一个类别可以满足我的需求，但是我可以覆盖以这种方式添加的方法吗？大多数情况下，子类将使用默认方法，但我知道我至少需要重写该方法一次。

我还应该考虑什么其他方法来做我想做的事情？

我正在尝试做的示例：

我有一组像日记页面一样的对象。这些页面是 UIViewControllers 的子类。我想添加用于加载、保存和类似的方法。在日志类（NSObject 的子类）中，我有一个存储每个日志页面实例的数组。我想要它，所以我可以从数组中选择一个页面并运行这些方法，而不必知道特定的对象类，因为它们都应该具有这些方法。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-16T18:44:28.027

简短的回答：是的，你可以。出于继承的目的，超类上的类别方法被视为在超类中实际定义的方法，并且可以以相同的方式被覆盖。

# javascript - 在 JavaScript / jQuery 中将日期字符串转换为 unix 时间戳

> ID：11509814
> 
> 赞同：38
> 
> 时间：2012-07-16T17:54:44.127
> 
> 标签：javascript, jquery, unix-timestamp

我有这种格式的日期字符串：

```
2009-07-15 00:00:00 - 2009-07-15 08:16:23 
```

谁能帮我将日期字符串调整为 unix 时间戳，如下所示：

```
1247634000 - 1247663783 
```

我正在使用`GMT-5`时区。

可以使用哪些 JavaScript 或 jQuery 技术？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-07-16T18:01:15.087

我强烈建议您在 js 中处理日期时使用[Moment Date 库。](http://momentjs.com/)它真的很轻，很棒。

```
var timeStamp = ( moment('2009-07-15 00:00:00').unix() )*1000 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-16T18:06:33.097

在 Javascript 中，您可以直接将字符串传递给 Date 对象构造函数，例如

`var date = new Date('2009-07-15 00:00:00'.split(' ').join('T'))`

这将为您提供日期对象并从中获取时间戳，您可以这样做

`date.getTime() / 1000`

除以 1000 因为`getTime`将以毫秒为单位给出时间戳

[工作演示](http://codebins.com/bin/4ldqpas/2)

**笔记：**

Firefox 无法解析给定的日期时间格式，因此我们需要先将其转换为正确的格式，因为我们只需将日期和时间组件之间的空格替换为“T”，这将使其成为有效的 ISO 8601 格式和Firefox 将能够解析它

参考：

[MDN 中的日期解析](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/parse)

[ISO 8601 日期格式](http://www.w3.org/TR/NOTE-datetime)

[在这里问了同样的问题](https://stackoverflow.com/questions/8831338/date-issue-in-firefox)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-07-16T18:02:07.187

```
var input = "2009-07-15 00:00:00 - 2009-07-15 08:16:23";
input = input.split(" - ").map(function (date){
    return Date.parse(date+"-0500")/1000;
}).join(" - "); 
```

[演示](http://jsfiddle.net/LjNbw/1/)

[`Date.parse`文档](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/parse)

注意：这不适用于旧浏览器，因为我使用的是[`Array.map`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map)，但我认为您应该可以轻松地对其进行填充。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-26T15:44:18.243

使用 split 方法，您可以将日期时间格式更改为最新，这对每个人来说都非常简单易行。

```
 var str = "2017-05-09T00:00:00.000Z";
 var res = str.split("-",2);
 var res = str.split("T",1);
 var temp=res; 
```

# c# - MySqlException: Timeout expired - 增加连接超时没有效果

> ID：11509817
> 
> 赞同：11
> 
> 时间：2012-07-16T17:55:00.540
> 
> 标签：c#, mysql, connection-timeout

随着数据库大小的增加，我有一个查询需要更长的时间来执行。该查询已优化且必要，但我的 C# 控制台应用程序最近一直给我这个错误：

```
Unhandled Exception: MySql.Data.MySqlClient.MySqlException: Timeout expired. 
```

增加连接字符串中的连接超时无济于事；我从

> 连接超时=28800

至

> 连接超时=128800

但尽管发生了这种变化，我仍然收到错误消息。

如果我从 MySQL 工作台运行查询，它只需要大约 10 秒，所以我不确定如何防止这个未处理的异常。

除了“查询所用的时间”之外，是否还有其他因素会产生此异常？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-16T19:39:45.283

我以前遇到过这个问题。ConnectTimeout 属性仅适用于连接到数据库时发生的超时，不适用于查询。

**然而， CommandTimeout**指定它应该等待查询返回多长时间。我相信默认值为 30 秒。仔细检查您的 MySql 库的文档，但对于 SqlCommand，CommandTimeout 的单位是秒而不是毫秒。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T18:13:31.143

如果您可以向我们展示您的方法，我们可以帮助查找错误。

如果历史（和 SO）教会了我什么，它

```
"You better be using Paramaterized SQL statements before posting any code" 
```

如果您不确定如何使用参数化命令，这里是一个示例（取自我没有使用参数化 SQL 的答案之一）

```
var command = new MySqlCommand(
    "SELECT * FROM tblPerson WHERE LastName = @Name AND Height > @Height AND BirthDate < @BirthDate", connection);

command.Parameters.AddWithValue("@Name", lastname);
command.Parameters.AddWithValue("@Height", height);
command.Parameters.AddWithValue("@Name", birthDate); 
```

如果您还没有尝试过并发布一些代码:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-02T23:11:44.583

您也可以尝试在连接字符串中添加“默认命令超时=360”；例如

```
Server=myServerAddress;Database=myDataBase;Uid=myUsername;Pwd=myPassword;default command timeout=20; 
```

此选项在 Connector/NET 版本 5.1.4 中可用。

[我从[connectionstrings.com/mysql/](https://www.connectionstrings.com/mysql/)

# colors - 在 SVG 文件中编码 PANTONE 颜色的正确方法是什么？

> ID：11509818
> 
> 赞同：5
> 
> 时间：2012-07-16T17:55:11.727
> 
> 标签：colors, svg, color-space, pantone

我有一个应用程序可以输出 SVG 图像，出于打印目的，我希望它能够生成正确编码的 PANTONE 颜色（如果已知）。SVG 规范在输出的外观方面不是很详细，尽管进行了一些搜索，但我无法在网上找到任何示例。

到目前为止，我的尝试不适用于显示目的（至少在 Google Chrome 中不起作用），所以我可能不在此处，但到目前为止，我已经尝试过[这个](http://bl.ocks.org/d/3123914/italy.svg)（[要点](https://gist.github.com/3123914)）：

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- This file is an attempt at specifying the Italian flag with the -->
<!-- proper Pantone colours, as noted in the Wikipedia talk page, at -->
<!--  http://commons.wikimedia.org/wiki/File_talk:Flag_of_Italy.svg  -->
<svg xmlns="http://www.w3.org/2000/svg" version="1.2" viewBox="0 0 3 2">
<!-- Verde  --><rect fill="#009246 icc-color(17-6153)" width="1" height="2"/>
<!-- Bianco --><rect fill="#f1f2f1 icc-color(11-0601)" width="1" height="2" x="1"/>
<!-- Rosso  --><rect fill="#ce2b37 icc-color(18-1662)" width="1" height="2" x="2"/>
</svg> 
```

我可能需要根据[SVG 规范的注释](http://www.w3.org/TR/2007/WD-SVGPrintPrimer12-20070501/#color)指定这是什么颜色配置文件，但我不太确定如何。输入赞赏。

# php - 验证 URL 中的变量

> ID：11509821
> 
> 赞同：1
> 
> 时间：2012-07-16T17:55:17.433
> 
> 标签：php

如果我知道我的 URL 中可以有哪些变量，我如何验证我的 URL 并忽略不在我列表中的变量？

我想我将在一个数组中包含所有“好”变量

```
$good = array("name", "car", "year", "color"); 
```

然后我需要获取请求 URL，然后将其拆分以查找 QUERY 元素并将它们循环到我的 $good 数组中，剥离不属于的那些并处理请求。从理论上讲，这似乎是一个不错的计划。还是有更好的计划？如果没问题，我该怎么做？

```
$url = http://mydomain.com/?car=1&color=red&bad=asdasd 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:56:57.853

尝试使用这个：[http_build_query](http://www.php.net/manual/pl/function.http-build-query.php)。

# c - 分配过多内存的性能损失（？）

> ID：11509824
> 
> 赞同：0
> 
> 时间：2012-07-16T17:55:28.913
> 
> 标签：c, performance, memory

作为我正在使用的算法的新变体的一部分（倾向于使用 SMP），我正在考虑将我`particle`的 s 排序为`box`es，让每个`box`人都有一个`particle* []`. 我唯一担心的是，由于每个盒子的粒子数量可能会有所不同（在极少数情况下，平均 10 个会高达 70 个），我需要大量过度分配指针数组。我在想大概是 5-10% 的利用率。

极端情况下大约有一百万个，所以我们正在考虑分配半 GB 的内存。就它将运行的机器而言，这不是问题，但我想知道是否存在与跨步内存相关的性能损失（缓存讨厌它或其他东西）。（例如，访问 500 个字节中的前 60 个左右的字节）。我确实知道要确保我的步幅宽度最终不会成为 64 的缓存破坏倍数......

我可以在非常罕见的情况下让它失败，只要这个计划能让我获得足够的性能提升，以便能够在相同的时间内运行更多成功的副本。

如果相关，这段代码将主要在 Xeon E5620 上运行，尽管这会改变，我宁愿不做任何特定于架构的事情。

编辑：这是将连续内存中的 N 字节打包数据与均匀跨过更大的连续内存区域的 N 字节数据进行比较。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:59:51.843

如果您分配的内存不会导致交换，那么简单地分配它不会导致任何额外的开销。

但是，如果您的算法当前将数据点打包到连续的内存中，并且您的新算法将 5%-10% 的利用率分布在整个分配的缓冲区中（如果是这种情况，您的问题不清楚），您将有更多的缓存未命中访问内存。

另一方面，如果每个 CPU 有一个缓冲区（并且使用连续内存），由于减少了[错误共享](http://www.drdobbs.com/parallel/eliminate-false-sharing/217500206?pgno=3)的机会，您的算法可能会执行得更好。

# google-apps-script - 编写 Google Apps 演示文稿脚本

> ID：11509827
> 
> 赞同：1
> 
> 时间：2012-07-16T17:55:42.150
> 
> 标签：google-apps-script

我正在尝试将多个演示文稿（谷歌格式）组合成一个脚本。我没有看到特定的`Presentation`服务`Documents`和`Spreadsheet`。有没有办法在`Documents`服务中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:19:10.057

Apps 脚本中目前没有用于操作 Google 演示文稿的服务。您可以通过[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)提出请求。

# github - 如何为 GitHub 的 README.md 文件添加颜色

> ID：11509830
> 
> 赞同：442
> 
> 时间：2012-07-16T17:55:53.063
> 
> 标签：github, colors, markdown, github-pages, readme

`README.md`我的项目[underscore-cli](http://github.com/ddopson/underscore-cli)有一个文件，我想记录该`--color`标志。

目前，*唯一*的方法是使用屏幕截图（可以存储在项目存储库中）：

[![例子.png](../Images/d7fa4de0e73df42e6352722a43e008e8.png)](https://raw.github.com/ddopson/underscore-cli/master/doc/example.png)

但截图不是文本，防止读者在截图中复制/粘贴命令。它们的创建/编辑/维护也很痛苦，并且浏览器加载速度较慢。现代网络使用文本样式，而不是一堆渲染的文本图像。

虽然一些 Markdown 解析器支持内联 HTML 样式，但 GitHub 不支持；这不起作用：

```
<span style="color: green"> Some green text </span> 
```

这不起作用：

```
<font color="green"> Some green text </font> 
```

* * *

## 回答 #1

> 赞同：493
> 
> 时间：2016-12-20T17:21:13.243

为自述文件添加颜色的一种方法是利用提供[占位符图像](https://commons.wikimedia.org/wiki/Category:Image_placeholders)的服务。

例如，可以使用这个 Markdown：

```
- ![#f03c15](https://via.placeholder.com/15/f03c15/000000?text=+) `#f03c15`
- ![#c5f015](https://via.placeholder.com/15/c5f015/000000?text=+) `#c5f015`
- ![#1589F0](https://via.placeholder.com/15/1589F0/000000?text=+) `#1589F0` 
```

要创建您喜欢的任何颜色的列表：

*   ![#f03c15](../Images/0ec2f0cd5bdb9d64a7e4bf337fbd5891.png) `#f03c15`
*   ![#c5f015](../Images/349c9088ff9ee2fd3a024bbaeb8288b1.png) `#c5f015`
*   ![#1589F0](../Images/39375b3b956e1c1fe88911d9c4569d1d.png) `#1589F0`

* * *

## 回答 #2

> 赞同：320
> 
> 时间：2016-09-09T14:23:03.553

您可以使用`diff`语言标签生成一些彩色文本：

```
```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
``` 
```

但是，它将它添加为一个以要么开头的新行，要么`- + ! #`以开头和结尾`@@`

![在此处输入图像描述](../Images/3a9c675e1443bf846eac6b3a005d30ef.png)

这个问题是在[GitHub 标记 #369](https://github.com/github/markup/issues/369)中提出的，但自那以后（2014 年）他们没有对决定做出任何改变。

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2014-06-11T16:26:19.713

您不能在 GitHub`README.md`文件中为纯文本着色。但是，您可以使用以下标签为代码示例添加颜色。

为此，只需将这些示例之类的标签添加到您的 README.md 文件中：

```
```json
   // 着色代码
```
```html
   // 着色代码
```
```js
   // 着色代码
```
```css
   // 着色代码
```
// ETC。

```

不需要“pre”或“code”标签。

这在[GitHub Markdown 文档](https://help.github.com/articles/github-flavored-markdown)中有介绍（大约在页面的一半处，有一个使用 Ruby 的示例）。GitHub 使用[Linguist来识别和突出语法 - 您可以在](https://github.com/github/linguist)[Linguist 的 YAML 文件](https://github.com/github/linguist/blob/master/lib/linguist/languages.yml)中找到支持的语言（以及它们的 markdown 关键字）的完整列表。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2014-06-11T23:45:17.793

不幸的是，目前这是不可能的。

[GitHub Markdown 文档](https://help.github.com/articles/github-flavored-markdown)没有提到“颜色”、“CSS”、“HTML”或“样式” 。

虽然一些 Markdown 处理器（例如[Ghost](https://ghost.org/)中使用的那个）允许 HTML，例如`<span style="color:orange;">Word up</span>`GitHub 丢弃任何 HTML。

如果您必须在自述文件中使用颜色，则您的*README.md*文件可以简单地将用户引至*README.html*文件。当然，对此的权衡是可访问性。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2016-03-20T02:31:28.913

作为渲染光栅图像的替代方法，您可以嵌入[SVG](https://en.wikipedia.org/wiki/Scalable_Vector_Graphics)文件：

```
<a><img src="https://dump.cy.md/6c736bfd11ded8cdc5e2bda009a6694a/colortext.svg"/></a> 
```

然后，您可以像往常一样向 SVG 文件添加颜色文本：

```
<?xml version="1.0" encoding="utf-8"?>
<svg version="1.1"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="100" height="50"
>
  <text font-size="16" x="10" y="20">
    <tspan fill="red">Hello</tspan>,
    <tspan fill="green">world</tspan>!
  </text>
</svg> 
```

不幸的是，即使您可以在打开`.svg`文件时选择和复制文本，但在嵌入 SVG 图像时文本是不可选择的。

演示：[https ://gist.github.com/Cyber​​Shadow/95621a949b07db295000](https://gist.github.com/CyberShadow/95621a949b07db295000)

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2020-12-06T23:50:17.860

如果您对这种有限的颜色和形状种类没问题（尽管它们在不同的操作系统和浏览器中可能看起来不同），这些表情符号字符也很有用，这是[AlecRust 的答案](https://stackoverflow.com/a/41247934/1494686)的替代方案，它需要有朝一日可能会停止的外部服务，并考虑使用[Luke Hutchison 的回答](https://stackoverflow.com/a/51531800/1494686)中的表情符号：

⚫⚪⭕</p>

⬛⬜⏹☑✅❎

❤️♥️❣️♡</p>

♦</p>

◻️◼️◾️◽️▪️▫️

还有许多带有字母数字、箭头和其他符号的彩色矩形字符可能适合您。

* * *

**示例用法：** [这是我用](https://gist.github.com/unicornist/60c70a8fd02bf8721969b7ce6b425982#colored-bash-prompt-with-git-prompt)这些表情符号解决的用例（在阅读此处的答案后想到）

* * *

此外，以下表情符号是肤色*修饰符*，仅在某些设备上具有这种矩形形状内的肤色。例如，在 Windows 中，它们甚至没有颜色。不要使用它们！因为它们不应该单独使用，所以它们应该与其他表情符号一起使用来修改其兄弟表情符号的输出。而且它们在单独使用时在不同的操作系统、版本、浏览器和版本组合中呈现出如此大的差异。

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2014-08-29T15:29:36.177

我倾向于同意[M-Pixel](https://stackoverflow.com/questions/11509830/how-to-add-color-to-githubs-readme-md-file/24174358#24174358)的观点，即目前无法为 GitHub Markdown 内容中的文本指定颜色，至少不能通过 HTML。

GitHub 确实允许一些 HTML 元素和属性，但只允许某些（请参阅他们的有关其[HTML sanitization](https://github.com/github/markup/tree/master#html-sanitization)的文档）。它们确实允许`p`和`div`标记，以及`color`属性。但是，当我尝试在 GitHub 上的 Markdown 文档中使用它们时，它不起作用。我尝试了以下（以及其他变体），但它们不起作用：

*   `<p style='color:red'>This is some red text.</p>`
*   `<font color="red">This is some text!</font>`
*   `These are <b style='color:red'>red words</b>.`

正如[M-Pixel 建议的那样](https://stackoverflow.com/questions/11509830/how-to-add-color-to-githubs-readme-md-file/24174358#24174358)，如果您真的必须使用颜色，您可以在*README.html*文件中执行此操作并将其引用。

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2019-09-24T15:30:19.223

在撰写本文时，GitHub Markdown``#ffffff``使用颜色预览呈现颜色代码（注意反引号！）。只需使用颜色代码并用反引号将其包围。

例如：

[![带有颜色代码的 GitHub Markdown](../Images/9aeb4c80f703bff19eb693bc9877b514.png)](https://i.stack.imgur.com/WunTd.png)

变成

[![用颜色代码渲染 GitHub Markdown](../Images/1bd6f9907d46b0ee1bbf74577967af2c.png)](https://i.stack.imgur.com/GA9Iv.png)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2018-07-26T05:48:30.137

我使用 emoji Unicode 字符为 GitHub 标记页面添加了一些颜色，例如，或者 - 在某些浏览器中，某些 emoji 字符是彩色的。

还有一些彩色的表情符号字母：血型️️️；停车标志️; 地铁标志Ⓜ️; 其他一些有两个或多个字母的，例如 ，和框数字，例如 0️⃣。如果标志不可用，标志表情符号将显示为字母（通常是彩色）：.

但是，我认为表情符号中没有定义完整的彩色字母表。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-02-22T19:32:42.180

基于[AlecRust 的想法](https://stackoverflow.com/questions/11509830/how-to-add-color-to-githubs-readme-md-file/41247934#41247934)，我做了一个 PNG 文本服务的实现。

演示在这里：

[http://lingtalfi.com/services/pngtext?color=cc0000&size=10&text=Hello%20World](http://lingtalfi.com/services/pngtext?color=cc0000&size=10&text=Hello%20World)

有四个参数：

*   text：要显示的字符串
*   字体：未使用，因为在这个演示中我只有 Arial.ttf。
*   fontSize：一个整数（默认为 12）
*   颜色：一个六字符的十六进制代码

请不要直接使用此服务（测试除外），而是使用我创建的提供服务的类：

[https://github.com/lingtalfi/WebBox/blob/master/Image/PngTextUtil.php](https://github.com/lingtalfi/WebBox/blob/master/Image/PngTextUtil.php)

```
class PngTextUtil
{
    /**
     * Displays a PNG text.
     *
     * Note: this method is meant to be used as a web service.
     *
     * Options:
     * ------------
     * - font: string = arial/Arial.ttf
     *          The font to use.
     *          If the path starts with a slash, it's an absolute path to the font file.
     *          Else if the path doesn't start with a slash, it's a relative path to the font directory provided
     *          by this class (the WebBox/assets/fonts directory in this repository).
     * - fontSize: int = 12
     *          The font size.
     * - color: string = 000000
     *          The color of the text in hexadecimal format (6 characters).
     *          This can optionally be prefixed with a pound symbol (#).
     *
     *
     *
     *
     *
     *
     * @param string $text
     * @param array $options
     * @throws \Bat\Exception\BatException
     * @throws WebBoxException
     */
    public static function displayPngText(string $text, array $options = []): void
    {
        if (false === extension_loaded("gd")) {
            throw new WebBoxException("The gd extension is not loaded!");
        }
        header("Content-type: image/png");
        $font = $options['font'] ?? "arial/Arial.ttf";
        $fontsize = $options['fontSize'] ?? 12;
        $hexColor = $options['color'] ?? "000000";
        if ('/' !== substr($font, 0, 1)) {
            $fontDir = __DIR__ . "/../assets/fonts";
            $font = $fontDir . "/" . $font;
        }
        $rgbColors = ConvertTool::convertHexColorToRgb($hexColor);

        //--------------------------------------------
        // GET THE TEXT BOX DIMENSIONS
        //--------------------------------------------
        $charWidth = $fontsize;
        $charFactor = 1;
        $textLen = mb_strlen($text);
        $imageWidth = $textLen * $charWidth * $charFactor;
        $imageHeight = $fontsize;
        $logoimg = imagecreatetruecolor($imageWidth, $imageHeight);
        imagealphablending($logoimg, false);
        imagesavealpha($logoimg, true);
        $col = imagecolorallocatealpha($logoimg, 255, 255, 255, 127);
        imagefill($logoimg, 0, 0, $col);
        $white = imagecolorallocate($logoimg, $rgbColors[0], $rgbColors[1], $rgbColors[2]); // For font color
        $x = 0;
        $y = $fontsize;
        $angle = 0;
        $bbox = imagettftext($logoimg, $fontsize, $angle, $x, $y, $white, $font, $text); // Fill text in your image
        $boxWidth = $bbox[4] - $bbox[0];
        $boxHeight = $bbox[7] - $bbox[1];
        imagedestroy($logoimg);

        //--------------------------------------------
        // CREATE THE PNG
        //--------------------------------------------
        $imageWidth = abs($boxWidth);
        $imageHeight = abs($boxHeight);
        $logoimg = imagecreatetruecolor($imageWidth, $imageHeight);
        imagealphablending($logoimg, false);
        imagesavealpha($logoimg, true);
        $col = imagecolorallocatealpha($logoimg, 255, 255, 255, 127);
        imagefill($logoimg, 0, 0, $col);
        $white = imagecolorallocate($logoimg, $rgbColors[0], $rgbColors[1], $rgbColors[2]); // For font color
        $x = 0;
        $y = $fontsize;
        $angle = 0;
        imagettftext($logoimg, $fontsize, $angle, $x, $y, $white, $font, $text); // Fill text in your image
        imagepng($logoimg); // Save your image at new location $target
        imagedestroy($logoimg);
    }
} 
```

注意：如果您不使用[Universe 框架](https://github.com/karayabin/universe-snapshot)，则需要替换此行：

```
$rgbColors = ConvertTool::convertHexColorToRgb($hexColor); 
```

使用此代码：

```
$rgbColors = sscanf($hexColor, "%02x%02x%02x"); 
```

在这种情况下，您的十六进制颜色必须正好是六个字符长（不要将井号 (#) 放在它前面）。

注意：最后我没有使用这个服务，因为我发现字体很丑更糟糕：无法选择文字。但为了讨论，我认为这段代码值得分享......

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2021-10-15T08:19:07.653

可以这样做：

![](../Images/b3b748be9e9285fa332cb46df8f08b99.png) ![]( [https://img.shields.io/static/v1?label=&message=Ааи&color=green](https://img.shields.io/static/v1?label=&message=%D0%90%D0%B0%D0%B8&color=green) )

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2022-01-15T16:49:19.737

可能不是所问问题的确切答案，但是当我处于 OP 的情况时，我正在寻找以下解决方案：

[![](../Images/24447bbdcdb5ca58504762b8f14af3d7.png)](https://github.com/hamzamohdzubair/redant) [![](../Images/869291bde7e8afe461581a660b268c37.png)](https://hamzamohdzubair.github.io/redant/) [![](../Images/d287df3c1177be238e7356f0c4dbf66d.png)](https://docs.rs/crate/redant/latest) [![](../Images/244c1af46225a8700d8689a77345eed0.png)](https://crates.io/crates/redant) [![](../Images/a9d34ec8d587aebf14d4fe579b49ae2f.png)](https://lib.rs/crates/redant)

只需：

```
[![](https://img.shields.io/badge/github-blue?style=for-the-badge)](https://github.com/hamzamohdzubair/redant)
[![](https://img.shields.io/badge/book-blueviolet?style=for-the-badge)](https://hamzamohdzubair.github.io/redant/)
[![](https://img.shields.io/badge/API-yellow?style=for-the-badge)](https://docs.rs/crate/redant/latest)
[![](https://img.shields.io/badge/Crates.io-orange?style=for-the-badge)](https://crates.io/crates/redant)
[![](https://img.shields.io/badge/Lib.rs-lightgrey?style=for-the-badge)](https://lib.rs/crates/redant) 
```

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2020-12-04T08:20:10.470

问题是“如何在 github 自述文件中为文本着色”
，这很难/不可能

题外话：在 github 问题中，我们可以使用

```
<span color="red">red</span> 
```

例子：

```
#!/bin/bash

# Convert ANSI-colored terminal output to GitHub Markdown

# To colorize text on GitHub, we use <span color="red">red</span>, etc.
# Depends on:
#   aha: convert terminal colors to html
#   xclip: copy the result to clipboard
# License: CC0-1.0
# Note: some tools may need other arguments than `--color=always`
# Sample use: colors-to-github.sh diff a.txt b.txt

cmd="$1"
shift # now the arguments are in $@
(
    echo '<pre>'
    $cmd --color=always "$@" 2>&1 | aha --no-header
    echo '</pre>'
) \
| sed -E 's/<span style="[^"]*color:([^;"]+);"/<span color="\1"/g' \
| sed -E 's/ style="[^"]*"//g' \
| xclip -i -sel clipboard 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2020-10-18T23:02:38.900

这是您可以为彩色文本编写的代码：

```
<h3 style="color:#ff0000">Danger</h3> 
```

# asp.net-mvc - 下拉列表的值不会传回控制器

> ID：11509831
> 
> 赞同：2
> 
> 时间：2012-07-16T17:55:54.000
> 
> 标签：asp.net-mvc

我有一个由患者对象和访问集合组成的视图模型。视图模型填充了所有正确的属性值，并且属性在编辑视图中正确显示。在将模型传递给控制器​​的编辑 (GET) 操作中的视图之前，我还验证了视图模型中的属性值。

问题是，即使我在编辑视图中没有更改任何属性，绑定到下拉列表（性别和条件）的属性也不会传递回控制器的编辑（POST）操作。这会导致抛出异常。

这些属性具有值，但在某个地方它们会丢失。我该如何解决这个问题？

ASP.NET MVC 4 RC

```
public ActionResult Edit(int id = 0)
{
    var patient = this.db.Patients.Where(p => p.Id == id).FirstOrDefault();
    var visits = this.db.Visits.Where(v => v.PatientId == patient.Id && v.IsActive).OrderByDescending(v => v.VisitDate);

    PatientEditViewModel model = new PatientEditViewModel();
    model.Patient = patient;
    model.Visits = visits;

    if (patient == null)
    {
        return this.HttpNotFound();
    }

    ViewBag.GenderId = new SelectList(this.db.Genders, "Id", "Name", patient.GenderId);
    ViewBag.HandednessId = new SelectList(this.db.Handednesses, "Id", "Name", patient.HandednessId);

    return this.View(model);
}

[HttpPost]
public ActionResult Edit(PatientEditViewModel model)
{
    Mapper.CreateMap<PatientEditViewModel, Patient>();

    var entity = Mapper.Map<PatientEditViewModel, Patient>(model);

    if (ModelState.IsValid)
    {
        this.db.Entry(entity).State = EntityState.Modified;
        this.db.SaveChanges();
    }

    this.ViewBag.GenderId = new SelectList(this.db.Genders, "Id", "Name", entity.GenderId);
    this.ViewBag.HandednessId = new SelectList(this.db.Handednesses, "Id", "Name", entity.HandednessId);

    return this.View(model);
} 
```

* * *

```
@model Web.Models.PatientEditViewModel

@{
    ViewBag.Title = "XXX";
}

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Patient</legend>

        @Html.HiddenFor(model => model.Patient.Id)

        <div class="editor-label">
            @Html.LabelFor(model => model.Patient.GenderId, "Gender")
        </div>
        <div class="editor-field">
            @Html.DropDownFor("GenderId", String.Empty)
            @Html.ValidationMessageFor(model => model.Patient.GenderId)
        </div>
        <div class="editor-label">
            @Html.LabelFor(model => model.Patient.HandednessId, "Handedness")
        </div>
        <div class="editor-field">
            @Html.DropDownFor("HandednessId", String.Empty)
            @Html.ValidationMessageFor(model => model.Patient.HandednessId)
        </div>
        <div class="editor-label">
            @Html.LabelFor(model => model.Patient.Comments)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Patient.Comments)
            @Html.ValidationMessageFor(model => model.Patient.Comments)
        </div>

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
}

@Html.Partial("_CurrentAndPreviousVisits", Model.Visits)

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:44:15.403

没有`Html.DropDownFor`帮手。也许你的意思是`Html.DropDownList`或`Html.DropDownListFor`。就我个人而言，我会向您推荐第二个强类型版本。

因此，在您的`PatientEditViewModel`模型中，您定义了以下属性：

```
public string GenderId { get; set; }
public IEnumerable<SelectList> Genders { get; set; }

public string HandednessId { get; set; }
public IEnumerable<SelectList> Handednesses { get; set; } 
```

然后在您的控制器操作中，您忘记`ViewBag`并正确填充您的视图模型。因此，您将 ViewBag 的 2 行替换为 2 行视图模型分配：

```
model.Genders = new SelectList(this.db.Genders, "Id", "Name", patient.GenderId);
model.Handednesses = new SelectList(this.db.Handednesses, "Id", "Name", patient.HandednessId); 
```

在您看来，您使用强类型的助手版本：

```
@Html.DropDownListFor(x => x.GenderId, Model.Genders) 
```

和：

```
@Html.DropDownListFor(x => x.HandednessId, Model.Handednesses) 
```

现在在您的 POST 操作中，您将在视图模型的`GenderId`和属性中获得 2 个选定的值。`HandednessId`显然，在您的 POST 操作中，如果您想重新显示相同的视图，您可以使用 2 行视图模型属性分配删除 2 行 ViewCrap（请原谅我的意思是 ViewBag）。

# java - 如何将键盘事件添加到数据网格单元格中的 textinputcells？

> ID：11509836
> 
> 赞同：2
> 
> 时间：2012-07-16T17:56:15.170
> 
> 标签：java, gwt, datagrid

我想知道在 InputTextCell 中添加事件的方法。此事件必须尚未：“当用户按下 Tab 时，下一个单元格将获得焦点，此单元格将在其他列中。”

我尝试使用 onBrowserEvent，但找不到找到其他单元格的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:03:02.187

您在 CellPreviewHandler 中执行此操作：

```
myTable.addCellPreviewHandler(new Handler<T>() {
    @Override
    public void onCellPreview(CellPreviewEvent<T> event) {
        if ("keydown".equals(event.getNativeEvent().getType())) {
            int col = event.getContext().getColumn();
            int row = event.getContext().getIndex();
            if (event.getNativeEvent().getKeyCode() == 9) {
                col++;
                if (col == getColumnCount()) {
                    col = 0;
                }
                getRowElement(row).getCells().getItem(col).getFirstChildElement().getFirstChildElement().focus();
            }
        }
    }); 
```

# ios - iOS - 禁用 MPMoviePlayerController 全屏的两指缩放

> ID：11509842
> 
> 赞同：1
> 
> 时间：2012-07-16T17:56:37.480
> 
> 标签：ios, video, mpmovieplayercontroller, gesture-recognition

我怎样才能做到这一点？我不能只将 userInteraction 设置为 NO，因为我仍然需要用户能够通过捏合/缩放来调整视频大小。我只是不希望播放器进入全屏模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:17:16.243

希望这可以帮助！！

```
 - (void)viewDidLoad {
        [super viewDidLoad];

        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                 selector:@selector(movieEventFullscreenHandler:) 
                                                     name:MPMoviePlayerWillEnterFullscreenNotification 
                                                   object:nil];

        [[NSNotificationCenter defaultCenter] addObserver:self 
                                                 selector:@selector(movieEventFullscreenHandler:) 
                                                     name:MPMoviePlayerDidEnterFullscreenNotification 
                                                   object:nil];

        self.moviePlayer.controlStyle = MPMovieControlStyleEmbedded;
    }

    - (void)movieEventFullscreenHandler:(NSNotification*)notification {
        [self.moviePlayer setFullscreen:NO animated:NO];
        [self.moviePlayer setControlStyle:MPMovieControlStyleEmbedded];
    } 
```

# code-generation - SBT 使用项目定义的生成器生成代码

> ID：11509843
> 
> 赞同：16
> 
> 时间：2012-07-16T17:56:43.623
> 
> 标签：code-generation, sbt

我想编译一个包含 java 源代码生成器的项目，然后在单个项目中编译生成的代码。即：编译Generator.scala，运行Generator.generate(outputDir)，编译outputDir，打包成jar。我正在尝试这个：

```
sourceGenerators in Compile <+= sourceManaged in Compile map { out =>
    Generator.generate(out / "generated")
} 
```

但 sbt 抱怨

```
[error] Build.scala:1: object example is not a member of package org
[error] import org.example.Generator 
```

基本上，sbt 没有在它编译的项目中看到 Generator 定义。sbt可以按照我的方式来做吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-25T14:47:37.067

因此，在对此进行了深入研究之后，我想出了一个解决方案。首先，您需要将您的项目分成两个子项目。 `gen`拥有包含您的生成器代码的所有源代码。 `use`依赖`gen`并使用生成器。

```
 import sbt._
    import Keys._
    import java.io.{ File ⇒ JFile, FileOutputStream }

    object OverallBuild extends Build {

      lazy val root = Project(id = "overall", base = file(".")).aggregate(gen, use)

      lazy val gen = Project(id = "generate", base = file("gen"))

      val myCodeGenerator = TaskKey[Seq[File]]("mycode-generate", "Generate My Awesome Code")

      lazy val use = Project(id = "use", base = file("use"),
        settings = Defaults.defaultSettings ++ Seq(

          sourceGenerators in Compile <+= (myCodeGenerator in Compile),

          myCodeGenerator in Compile <<=
            (javaSource in Compile, dependencyClasspath in Runtime in gen) map {

              (javaSource, cp) ⇒ runMyCodeGenerator(javaSource, cp.files)

            })).dependsOn(gen)

      def runMyCodeGenerator(javaSource: File, cp: Seq[File]): Seq[File] = {
        val mainClass = "com.yourcompany.myCodeGenerator"
        val tmp = JFile.createTempFile("sources", ".txt")
        val os = new FileOutputStream(tmp)

        try {
          val i = new Fork.ForkScala(mainClass).fork(None, Nil, cp,
            Seq(javaSource.toString),
            None,
            false,
            CustomOutput(os)).exitValue()

          if (i != 0) {
            error("Trouble with code generator")
          }
        } finally {
          os.close()
        }
        scala.io.Source.fromFile(tmp).getLines.map(f ⇒ file(f)).toList
      }
    } 
```

在这种情况下，我正在生成 .java 文件，因此我将其传递`javaSource`给了生成器。

重要的是，当我们在这里使用 sourceGenerators 时，执行的任务必须返回`Seq[File]`所有生成的文件中的一个，以便 sbt 可以管理它们。在这个实现中，我们的生成器将完整路径文件名输出到标准输出，然后我们将它们保存到一个临时文件中。

就像 Scala 和 SBT 一样，你可以做任何事情，只需要深入研究它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:47:52.170

项目描述在加载时被编译。没有办法直接调用运行时生成的新代码。除非我猜想使用某种反射来确保没有 JVM 的分叉并且以某种方式将这些类加载到类加载器中。

我能想到的唯一方法是在您的项目定义中创建一个项目。

```
root
 - src
 - project/
   - Build.scala // normal project definition
   - project/
     - Build.scala // inner most 
```

在最里面的项目定义中，您可以将外部 src 定义为 src 文件夹。这将为您提供可用于实际项目的生成器的编译版本。然后在正常的项目定义中添加一个导入到生成器并像你一样使用它。

我很确定最里面的项目只会被加载和编译一次。如果您对生成器进行更改，您将需要让 sbt 重新加载项目定义。退出并重新打开是最简单/最愚蠢的方法，但它可能有助于测试。如果可行，请稍后查找更智能的重新加载方式。

# caching - AppFabric 安装后我看不到缓存集群，因为我看不到命令 powershell

> ID：11509844
> 
> 赞同：0
> 
> 时间：2012-07-16T17:56:46.233
> 
> 标签：caching, appfabric

安装 AppFabric 缓存后，我看不到缓存集群，因为我在 Powershell 中看不到缓存命令。

如果我运行命令 Get-Help * cache * 我会得到以下结果：

Get-Counter
Invoke-Command
New-PSSession
Remove-Job
New-PSSessionOptio
New-ModuleManifest
Export-FormatData
Get-WmiObject
about_jobs
about_preference_v
about_remote_jobs

其中没有一个是 AppFabric 缓存。

我必须做什么才能使缓存命令出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:01:28.590

如果您不使用 AF instalker 提供的 shell 链接，则需要通过以下方式导入多个模块：

```
Import-Module DistributedCacheAdministration 
```

然后，要附加到集群，您需要执行以下操作：

```
Use-CacheCluster 
```

# iphone - iPhone游戏中的分析

> ID：11509847
> 
> 赞同：0
> 
> 时间：2012-07-16T17:56:50.317
> 
> 标签：iphone, xcode, analytics

我正在考虑在我的新游戏中实施一些简单的分析工具。我想分析例如，最多播放什么场景等。（我的游戏中有6个场景）这可能吗，还是违反了Apple的一些规则？如果可能的话，最好的解决方案是什么？我有哪些选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:01:16.027

是的，这是可能的，而且不违反 Apple 的任何规则。谷歌分析有一个易于使用的 SDK，可以跟踪你在应用程序中想要的任何内容。

[https://developers.google.com/analytics/devguides/collection/ios/](https://developers.google.com/analytics/devguides/collection/ios/)

我以前用过很多次，效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:01:48.233

也许可以选择适用于 iOS 的 Google Analytics SDK？[https://developers.google.com/analytics/devguides/collection/ios/](https://developers.google.com/analytics/devguides/collection/ios/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:08:10.667

当然这是可能的，而且绝对不违反**苹果的规定**。[谷歌分析](https://developers.google.com/analytics/devguides/collection/ios/)可能是一种选择，但这里是另一种选择：

所以首先，我会通过检查每个视图控制器的视图是否已加载来检查哪个场景实际上是可见的

```
if (myViewController.isViewLoaded && myViewController.view.window) {

} 
```

然后可能会启动一个 NSTimer 来触发一个将一个添加到计数器的方法（每个视图单独的一个）。跟踪每个计数器，并且每个视图对应的计数器值最大，该视图使用时间最长。

# android - Android - 将 HeaderView 添加到 ListView 会引发 ClassCastException

> ID：11509853
> 
> 赞同：0
> 
> 时间：2012-07-16T17:57:16.093
> 
> 标签：android, listview, header, classcastexception, layoutparams

任何人都知道如何正确地将 HeaderView 添加到 android 中的 ListView 中？这就是我所拥有的：

```
LayoutInflater inflater = (LayoutInflater)this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
View inflatedView = inflater.inflate(R.layout.adapter_post_note, commentsListView, false); 
```

之后，我通过设置图像资源和/或文本来设置一个 ImageView 和几个 TextView，它们已经是 adapter_post_note 布局的一部分。然后这里是我添加 HeaderView

```
commentsListView.addHeaderView(inflatedView);
commentsAdapter = new CommentsAdapter(this, post.getComments(), post);
commentsListView.setAdapter(commentsAdapter); 
```

适配器是扩展 BaseAdapter 的自定义适配器，我传入上下文、填充 ListView 的 List 以及出于某种原因的“post”，但这并不重要。

这是我得到的错误

```
07-16 12:39:58.858: E/AndroidRuntime(1562): FATAL EXCEPTION: main
07-16 12:39:58.858: E/AndroidRuntime(1562): java.lang.ClassCastException: android.widget.FrameLayout$LayoutParams
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.widget.LinearLayout.measureVertical(LinearLayout.java:360)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:309)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.view.View.measure(View.java:8372)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.view.View.measure(View.java:8372)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.view.View.measure(View.java:8372)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.view.ViewRoot.performTraversals(ViewRoot.java:844)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1868)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.os.Looper.loop(Looper.java:130)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at android.app.ActivityThread.main(ActivityThread.java:3701)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at java.lang.reflect.Method.invokeNative(Native Method)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at java.lang.reflect.Method.invoke(Method.java:507)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
07-16 12:39:58.858: E/AndroidRuntime(1562):     at dalvik.system.NativeStart.main(Native Method) 
```

我尝试将 inflatedView 的布局参数设置为 ListView.LayoutParams、FrameLayout.LayoutParams、AbsListView.LayoutParams，没有任何效果。在我看来，好像它正在添加 inflatedView 作为标题就好了，但是后来当它试图使屏幕无效时，它试图通过并回收 ListView 子状态并且它失败了，这只是一个猜测，但任何想法？

另外，我尝试过的另一件事是

```
View.inflate(this, R.layout.adapter_post_note, null); 
```

但它仍然不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:12:33.493

将父视图设置为 null 就可以了。无需引用视图的父级。只需将其充气并将其传递给该方法。

# php - 在 Fetch 中使用变量

> ID：11509857
> 
> 赞同：0
> 
> 时间：2012-07-16T17:57:35.920
> 
> 标签：php, mysql, fetch

```
$pullItem = mysql_query("SELECT * FROM items WHERE item_id = '$itemid'");
while ($fetch = mysql_fetch_array($pullItem)) {
    $statinc = $fetch['statinc'];
}

$pullUserStats = mysql_query("SELECT * FROM userstats WHERE user_id = '$uid'");
while ($fetch = mysql_fetch_array($pullUserStats)) {
    $curstat = $fetch[$statinc];
}

mysql_query("UPDATE userstats SET $statinc=('$curstat' + '$incamount') WHERE user_id='$uid'"); //LINE 76 
```

这就是我遇到麻烦的地方。我之间确实有一些编码，但我的错误是：“注意：未定义的变量：curstat in ..... on line 76”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:17:47.193

这段代码背后的逻辑有一些问题，使它看起来要么没有被编码成看起来像它实际在做的事情，要么只是可能没有做你想让它做的事情。

第一件事是，按照你写代码的方式，看起来你想在循环中循环一堆结果`while`，当你到达循环结束时，`$statinc`是查询的 LAST 结果的值.

`SELECT * FROM items WHERE item_id = '$itemid'`建议您要么有一堆带有 id 字段的项目`item_id`，要么您将可能应该命名为的项目命名`id`为`item_id`.

如果是第二种情况，则加载项目的第一个查询实际上应该如下所示：

```
$pullItem = mysql_query("SELECT * FROM items WHERE item_id = '$itemid'");
$item = mysql_fetch_array($pullItem); //There's only one item to be returned, no need to loop over the array over and over again
$statinc = $item['statinc']; 
```

这也意味着您的第二个查询应如下所示：

```
$pullUserStats = mysql_query("SELECT * FROM userstats WHERE user_id = '$uid'");
$userstat = mysql_fetch_array($pullUserStats);
$curstat = $userstat[$statinc]; 
```

这让我相信 userstat 返回一个空查询，因此在您的原始代码中，`$curstat`永远不会被设置。

```
$increase_stat_to = $curstat + $incamount;
mysql_query("UPDATE userstats SET $statinc=('$increase_stat_to') WHERE user_id='$uid'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:30:58.883

错误是不言自明的，`$curstat`没有设置。在 while 循环中，回显结果`$fetch[$statinc];`以确保它实际上返回了一个有效值。如果没有，请检查 mysql 查询的语法。如果 mysql_query 没有返回有效的结果集，while 循环甚至可能不会执行，这可以解释为什么*根本*`$curstat`没有设置。

 *将来如果出现此类错误，请回显查询和任何相关变量，以便您可以在 phpMyAdmin 中对其进行测试，以确保生成正确的查询。

尽管有我的回答 - **Anther**已经发布了很多关于代码质量的信息，我必须说 - 这些建议值得跟进！*

# asp.net - .NET 3.5 意外错误并包含

> ID：11509869
> 
> 赞同：0
> 
> 时间：2012-07-16T17:58:22.967
> 
> 标签：asp.net, .net, json.net

我正在使用 Newtonsoft.JSON 库开发一个 .NET 2.0 C# 项目。当我检查 web.config 文件时，所有程序集都指的是 2.0 版本。

但是，当我在服务器上部署时，出现以下错误：

```
 Could not load file or assembly 'System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. The system cannot find the file specified.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.IO.FileNotFoundException: Could not load file or assembly 'System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. The system cannot find the file specified.

Source Error:

Line 21:     }
Line 22: 
Line 23:     Dictionary<string, string> config = JavaScriptConvert.DeserializeObject<Dictionary<string, string>>(jason);
Line 24: 
Line 25:     if (Request.Form["login"] == config["adminLogin"] && FormsAuthentication.HashPasswordForStoringInConfigFile(Request.Form["password"], "sha1") == config["adminPass"])

Source File: c:\Website\WSRecrut\Test\ConnectionPost.aspx    Line: 23

Assembly Load Trace: The following information can be helpful to determine why the assembly 'System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' could not be loaded.

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure logging.
To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].

Stack Trace:

[FileNotFoundException: Could not load file or assembly 'System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. The system cannot find the file specified.]
   Newtonsoft.Json.Utilities.CollectionUtils.CreateDictionaryWrapper(Object dictionary) in D:\Newtonsoft\Projects\Json\trunk\Src\Newtonsoft.Json\Utilities\CollectionUtils.cs:422
   Newtonsoft.Json.JsonSerializer.CreateObject(JsonReader reader, Type objectType, Object existingValue) in D:\Newtonsoft\Projects\Json\trunk\Src\Newtonsoft.Json\JsonSerializer.cs:223
   Newtonsoft.Json.JsonSerializer.Deserialize(JsonReader reader, Type objectType) in D:\Newtonsoft\Projects\Json\trunk\Src\Newtonsoft.Json\JsonSerializer.cs:169
   Newtonsoft.Json.JavaScriptConvert.DeserializeObject(String value, Type type, JsonConverter[] converters) in D:\Newtonsoft\Projects\Json\trunk\Src\Newtonsoft.Json\JavaScriptConvert.cs:512
   Newtonsoft.Json.JavaScriptConvert.DeserializeObject(String value, JsonConverter[] converters) in D:\Newtonsoft\Projects\Json\trunk\Src\Newtonsoft.Json\JavaScriptConvert.cs:485
   Newtonsoft.Json.JavaScriptConvert.DeserializeObject(String value) in D:\Newtonsoft\Projects\Json\trunk\Src\Newtonsoft.Json\JavaScriptConvert.cs:457
   ASP.connectionpost_aspx.__Render__control1(HtmlTextWriter __w, Control parameterContainer) in c:\Website\WSRecrut\Test\ConnectionPost.aspx:23
   System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children) +2113547
   System.Web.UI.Control.RenderChildren(HtmlTextWriter writer) +24
   System.Web.UI.Page.Render(HtmlTextWriter writer) +26
   System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter) +25
   System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter) +121
   System.Web.UI.Control.RenderControl(HtmlTextWriter writer) +22
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1896 
```

有人有想法吗？3.5 上的那个程序集可能来自哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:23:16.567

1、解析器错误消息：无法加载文件或程序集 'System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' 或其依赖项之一。该系统找不到指定的文件。

我建议您投资是否在您的目标计算机上安装了 .NET Framework 3.5。您可以下载验证工具来验证目标计算机上的 .NET Framework 状态。您可以点击以下链接。

[http://blogs.msdn.com/b/astebner/archive/2008/10/13/8999004.aspx](http://blogs.msdn.com/b/astebner/archive/2008/10/13/8999004.aspx)

2、WRN：程序集绑定日志被关闭。

要启用程序集绑定失败日志记录，请将注册表值 [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) 设置为 1。

注意：有一些与程序集绑定失败日志相关的性能损失。

要关闭此功能，请删除注册表值

如果不起作用，您可以根据错误信息修改注册表。

您可以按照以下步骤一一进行。

1、打开“运行”</p>

2、输入'regedit'</p>

3、备份你的注册表

4、在Registry中搜索key

5、根据错误信息修改其值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:17:01.437

获取此数据的另一种方法是查看异常的详细信息……您需要确保调试器正在运行并停止异常以查看详细信息。

所有这一切似乎要么是配置问题（可能是所有细节——仔细检查所有内容，如“aspnet_regiis -lk”的输出），或者 .NET 安装已损坏（但这似乎不太可能）。

别的 ，

“'System.Web.Extensions”是应该安装在GAC中的强命名程序集，文件找不到问题应该不是子目录的相对路径问题引起的。在我看来，问题在于服务器上没有安装 AJAX 1.0 扩展。

为了解决这个问题，我们可以从“程序集”部分删除“1.0.61025.0”版本的“System.Web.Extensions”程序集。正如您所说，这样做之后，出现了 LINQ 程序集未找到问题。对于这个问题，我建议检查服务器上是否安装了 .NET Framework 3.5。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:54:17.060

我怀疑您包含了错误的`NewtonSoft.Json.dll`库。有多个程序集——其中只有一个支持 .NET 2.0。

如果你有 Reflector/JustDecompile，你可以验证它是否有一个内部类`Newtonsoft.Json.Utilities.LinqBridge`——这就是它不使用`System.Core`LINQ 方法的原因。

文件详细信息的描述中也包含 .NET 2.0。

# c# - 实体框架预先加载与相关对象相关的对象

> ID：11509875
> 
> 赞同：0
> 
> 时间：2012-07-16T17:58:47.617
> 
> 标签：c#, entity-framework

当我尝试查询请求时，我想从用户对象加载渴望的图片对象。

模型

用户 [表]

--图片【导航属性】

--Friends【航海属性】

请求 [表格]

--用户[导航属性]

我，我使用以下查询。

```
var req = Context.Requests.Include(e => e.User).Include(d => d.User.Pictures).Where(c => c.Destination.Contains(CityName)); 
```

如果我看到 SQL 服务器跟踪执行的查询已加入图片表并获取相关数据。

但在 C# 中无法获取急切加载图片对象。

当我尝试寻找图片对象的任何属性时[发生延迟加载]，我可以在 sql server 跟踪中看到另一个查询。

如何在不延迟加载的情况下访问图片属性。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:09:25.660

您可以通过在 edmx 文件中关闭延迟加载选项并在查询中使用 Include("yourtable") 方法来做到这一点。

# meteor - 使用 $set 更新集合对象的嵌套属性

> ID：11509888
> 
> 赞同：1
> 
> 时间：2012-07-16T17:59:44.177
> 
> 标签：meteor

如果一个人有一组看起来像这样的对象：

```
{
    name:"some name",
    dob:"april 4, 1985",
    address:{
        street:"some street",
        city:"some city",
    }
} 
```

...可以使用 $set 仅更新城市吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:16:26.567

此查询应该为您完成：

```
Collection.update({sel}, {"$set" : {"address.city": "new city"}}) 
```

# android - Android Testerfield 失败 - 带有 JSON 对象的 Android HTTPPost

> ID：11509890
> 
> 赞同：0
> 
> 时间：2012-07-16T17:59:45.597
> 
> 标签：android, json, http-post, httpclient, logcat

我是使用 HTTP 的新手，更多的是在 Android 中。我正在尝试/必须对使用 JSON 对象通过 HTTP Post 发送所需信息的登录名进行身份验证。

当我运行应用程序时，我使用登录屏幕登录，该屏幕要求将安装添加到访问 URL、用户名和密码中。我输入这些，点击确认按钮，然后应用程序崩溃并出现一条消息：“不幸的是，TesterField 已停止。”

我无法破译 LOGCAT 中识别的内容。

**有人能告诉我这个（运行时）错误背后的原因吗？**

代码：

```
package name.company.androidlogin;

import java.io.BufferedOutputStream;
import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.UnsupportedEncodingException;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.HTTP;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class LoginScreen extends Activity {

    private Button loginButton;
    private TextView resultText;
    private EditText usernameText;
    private EditText passwordText;
    private EditText installText;
    private String accessURL = "http://url";
    public final String CONSUMER_KEY = "KEY";
    public final String CONSUMER_SECRET = "SECRET";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.login_screen);

        loginButton = (Button) findViewById(R.id.btn_login);
        resultText = (TextView) findViewById(R.id.lbl_result);
        usernameText = (EditText) findViewById(R.id.txt_username);
        passwordText = (EditText) findViewById(R.id.txt_password);
        installText = (EditText) findViewById(R.id.txt_install);
        loginButton.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.login_screen, menu);
        return true;
    }
    public void sendJson()
    {
        JSONObject jOb;
        try {
            jOb = toJSON();
            HttpPost httpPost = new HttpPost(accessURL);
            StringEntity entity = new StringEntity(jOb.toString(), HTTP.UTF_8);
            entity.setContentType("application/json");
            httpPost.setEntity(entity);
            HttpClient client = new DefaultHttpClient();
            HttpResponse response = client.execute(httpPost);
            resultText.setText(response.getStatusLine().getStatusCode()+" "+response.getStatusLine().getReasonPhrase());
        } catch (JSONException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } catch (UnsupportedEncodingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    public JSONObject toJSON() throws JSONException {
        JSONObject credentials = new JSONObject();
        try {
            credentials.put("ConsumerSecret", CONSUMER_SECRET);
            credentials.put("ConsumerKey", CONSUMER_KEY);
            credentials.put("Password", passwordText.getText());
            credentials.put("Username", usernameText.getText());
        } finally {
            resultText.setText(credentials.toString(2));
        }
        return credentials;
    }
} 
```

日志猫：

```
07-16 13:55:50.834: I/ActivityManager(93): START {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=name.company.testerfield/.URLBuilder bnds=[120,402][240,552]} from pid 192
07-16 13:55:50.834: W/WindowManager(93): Failure taking screenshot for (180x300) to layer 21005
07-16 13:55:50.954: D/dalvikvm(1122): Not late-enabling CheckJNI (already on)
07-16 13:55:50.997: I/ActivityManager(93): Start proc name.company.testerfield for activity name.company.testerfield/.URLBuilder: pid=1122 uid=10040 gids={3003}
07-16 13:55:51.134: I/WindowManager(93): createSurface Window{415d4950 Starting name.company.testerfield paused=false}: DRAW NOW PENDING
07-16 13:55:51.474: W/NetworkManagementSocketTagger(93): setKernelCountSet(10040, 1) failed with errno -2
07-16 13:55:52.474: I/WindowManager(93): createSurface Window{41620b70 name.company.testerfield/name.company.testerfield.URLBuilder paused=false}: DRAW NOW PENDING
07-16 13:55:52.604: D/gralloc_goldfish(1122): Emulator without GPU emulation detected.
07-16 13:55:52.704: I/ActivityManager(93): Displayed name.company.testerfield/.URLBuilder: +1s788ms
07-16 13:55:52.974: W/NetworkManagementSocketTagger(93): setKernelCountSet(10005, 0) failed with errno -2
07-16 13:55:55.054: I/WindowManager(93): createSurface Window{415cdbe0 InputMethod paused=false}: DRAW NOW PENDING
07-16 13:55:56.084: D/dalvikvm(147): GC_CONCURRENT freed 306K, 35% free 10784K/16455K, paused 6ms+8ms
07-16 13:56:09.504: D/dalvikvm(93): GC_CONCURRENT freed 483K, 10% free 12354K/13639K, paused 6ms+33ms
07-16 13:56:13.364: D/dalvikvm(376): GC_CONCURRENT freed 499K, 6% free 11433K/12039K, paused 6ms+27ms
07-16 13:56:17.134: D/AndroidRuntime(1122): Shutting down VM
07-16 13:56:17.134: W/dalvikvm(1122): threadid=1: thread exiting with uncaught exception (group=0x409961f8)
07-16 13:56:17.164: E/AndroidRuntime(1122): FATAL EXCEPTION: main
07-16 13:56:17.164: E/AndroidRuntime(1122): java.lang.NullPointerException
07-16 13:56:17.164: E/AndroidRuntime(1122):     at java.net.URI.parseURI(URI.java:353)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at java.net.URI.<init>(URI.java:204)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at java.net.URI.create(URI.java:725)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at org.apache.http.client.methods.HttpPost.<init>(HttpPost.java:79)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at name.company.testerfield.URLBuilder.postLoginData(URLBuilder.java:57)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at name.company.testerfield.URLBuilder.onClick(URLBuilder.java:50)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at android.view.View.performClick(View.java:3480)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at android.view.View$PerformClick.run(View.java:13983)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at android.os.Handler.handleCallback(Handler.java:605)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at android.os.Handler.dispatchMessage(Handler.java:92)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at android.os.Looper.loop(Looper.java:137)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at android.app.ActivityThread.main(ActivityThread.java:4340)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at java.lang.reflect.Method.invokeNative(Native Method)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at java.lang.reflect.Method.invoke(Method.java:511)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-16 13:56:17.164: E/AndroidRuntime(1122):     at dalvik.system.NativeStart.main(Native Method)
07-16 13:56:17.204: W/ActivityManager(93):   Force finishing activity name.company.testerfield/.URLBuilder
07-16 13:56:17.204: W/WindowManager(93): Failure taking screenshot for (180x300) to layer 21010
07-16 13:56:17.344: I/WindowManager(93): createSurface Window{41642a88  paused=false}: DRAW NOW PENDING
07-16 13:56:17.724: W/ActivityManager(93): Activity pause timeout for ActivityRecord{4133b488 name.company.testerfield/.URLBuilder}
07-16 13:56:17.743: W/NetworkManagementSocketTagger(93): setKernelCountSet(10005, 1) failed with errno -2
07-16 13:56:17.814: I/WindowManager(93): createSurface Window{41622c28 com.android.launcher/com.android.launcher2.Launcher paused=false}: DRAW NOW PENDING
07-16 13:56:18.694: W/NetworkManagementSocketTagger(93): setKernelCountSet(10040, 0) failed with errno -2
07-16 13:56:28.634: W/ActivityManager(93): Activity destroy timeout for ActivityRecord{4133b488 name.company.testerfield/.URLBuilder} 
```

编辑：我应该提到一些其他要求： - 将内容类型设置为“application/json; charset=utf-8″ - 将接收 cookie 作为响应的一部分

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T15:00:22.067

该错误来自尝试在主线程上连接到 Internet。我使用 AsyncTask 在不同线程的后台连接到互联网。

# python - 当 .pyc 文件位于同一目录中时，可执行文件不起作用

> ID：11509892
> 
> 赞同：1
> 
> 时间：2012-07-16T17:59:51.720
> 
> 标签：python, tkinter, python-2.7, pyinstaller

有人可以解释为什么或如何解决这个问题。

我使用 pyinstaller 创建了一个可执行文件，它工作正常。当脚本 .pyc 文件存在于同一目录和可执行文件中时，可执行文件将退出并出现错误（如下所示）。如果我删除 *.pyc 文件，可执行文件就可以正常工作。

```
Y:\BatchPlot\New folder>"Batch Plot.exe"
Traceback (most recent call last):
  File "<string>", line 12, in <module>
  File "C:\Python27\pyinstaller\iu.py", line 436, in importHook
    mod = _self_doimport(nm, ctx, fqname)
  File "C:\Python27\pyinstaller\iu.py", line 521, in doimport
    exec co in mod.__dict__
  File "Y:\BatchPlot\View.py", line 10, in <module>
    from Tkinter import *
ImportError: from-import-* object has no __dict__ and no __all__ 
```

# javascript - 目的 ＃ 没有方法“绑定”

> ID：11509893
> 
> 赞同：1
> 
> 时间：2012-07-16T17:59:53.110
> 
> 标签：javascript, jquery, html, dynamic, html-lists

我正在尝试动态迭代列表并将每个“li”元素与 dblclick 事件绑定。

我想要的是能够执行以下操作：

```
var sorttList = document.getElementById("list1");
for (var k = 0; k < sorttList.childNodes.length; ++k) {
    sorttList.childNodes[k].bind('dblclick', function() {
        //some event
    });
} 
```

当我尝试这样做时，我收到错误“Uncaught TypeError: Object #HTMLLIElement has no method 'bind'”

此任务的适当语法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:04:58.917

`bind()`不是原生 JavaScript 的一部分。您的意图可能是使用作为[jQuery 库](http://www.jquery.com)`bind()`一部分的函数。

如果您不使用 jQuery，则需要获取它，然后更新您的代码以使用 jQuery 选择器并传递 jQuery 对象。

如果您已经在页面中包含 jQuery，那么您需要确保调用`bind()`的是 jQuery 对象。改变：

```
sorttList.childNodes[k].bind('dblclick', function() { 
```

到

```
$(sorttList.childNodes[k]).bind('dblclick', function() { 
```

这不是一个完美的解决方案，但希望这将演示`$()`在使用 jQuery 时如何返回一个*jQuery Object*，而不是一个标准的 HTML 元素 JavaScript 对象。该`bind()`方法存在于 jQuery 对象上，但不存在于您正在使用的标准 DOM 对象上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:04:29.270

```
var sorttList = document.getElementById("list1"); 
```

那是 DOM 对象，而不是 jQuery，并且您正在抓取与 html 节点集相对的子节点，而不是 jQuery 对象。

```
jQuery("#list1 li").on("dblclick", function(){}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:15:24.440

如果使用 jQuery：

```
$("#list1").children().on('dblclick', function() {
    //some event
    //var k = $(this).index(); will get the elements index
}); 
```

或者如果你只需要迭代：

```
$.each($("#list1").children(), function(k, elm) {
    $(elm).on('dblclick', function() {
        //some event, k still refers to the index
    });
}); 
```

或者只是简单的：

```
var sorttList = document.getElementById("list1");
for (var k = 0; k < sorttList.childNodes.length; ++k) {
    sorttList.childNodes[k].ondblclick = function() {
        //some event
    };
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:03:25.590

您的另一个选择是将函数直接分配给 DOM 事件处理程序：

```
sortList.childNodes[k].ondblclick = function(){ ... }; 
```

为避免覆盖现有侦听器：

```
var curr = sortlist.childNodes[k].ondblclick;
var olddblclick = curr.ondblclick;
curr.ondblclick = function(e){
                     if(olddblclick) olddblclick.call(curr,e);
                     // code for new evt listener here
                  }; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T18:21:03.287

正确的方法可能是在父级上添加事件。您正在为所有孩子添加相同的事件，这有什么好处？使用 jQuery：

```
$( '#list1' ).on( 'dblclick', function() {
});

// If you want to reduce to "li" elements only:
$( '#list1' ).on( 'dblclick', 'li', function() {
}); 
```

如果您只是使用普通的 javascript，我想您并不关心浏览器的兼容性。下面是如何做到这一点：

```
document.getElementById( 'list1' ).addEventListener( 'dblclick',
    function( e ) {
    if ( e.target.tagName === 'LI' ) {
        // you clicked a LI element
    }
}); 
```

仅供参考，`bind`是 jQuery 绑定事件的（旧）函数。它在 jQuery 对象上可用。不是 DOM 元素（`getElementById`返回的内容）。它也是自 ES5（javascript 标准）以来的另一个可用功能`Function.prototype`。您可以在函数上调用它，而不是在 DOM 元素上调用它，因为您的错误显示:-)。

# imagemagick - ImageMagick - 如何将白色水平变平为纯白色？

> ID：11509894
> 
> 赞同：7
> 
> 时间：2012-07-16T17:59:53.230
> 
> 标签：imagemagick, transparent, levels, threshold

我有一个白色背景的 png 图像，我想将其变为透明。这个命令[相当简单](https://stackoverflow.com/a/5230125/187907)：

```
$ convert image.png -transparent white image-trans.png 
```

但是，如果白色背景不是完全白色的（即 、`#FFFFFF`等`rgb(255,255,255)`），则此方法效果不佳。

有没有办法将所有内容减少到某个阈值以下以完成白色？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T01:29:27.823

您正在寻找的命令行选项是

```
-white-threshold value{%} 
```

所以一个命令

```
convert image.png \
  -white-threshold 90% \
  -transparent white \
   image-trans.png 
```

**注意：**各个参数的顺序很重要！（您首先需要将所有浅灰色像素转换为白色，然后将所有白色像素转换为透明。）

适用于我的*“ImageMagick 版本 6.7.8-0 2012-07-12 Q16”* ...

# php - PHP MYSQL 细化搜索多个查询

> ID：11509895
> 
> 赞同：3
> 
> 时间：2012-07-16T18:00:04.730
> 
> 标签：php, mysql, search, count

我目前正在为汽车经销商建立一个网站。我想允许用户细化类似于 amazon 或 ebay 的搜索结果。通过单击缩小结果范围的能力会很棒。问题是我现在这样做的方式有许多不同的查询需要完成，每个查询都有 COUNT 个总数。

因此，缩小结果范围的主要方法是：

*   车辆类型
*   年
*   制作
*   价格范围
*   新/二手

目前，每次加载此页面时我都会执行 5 次查询，以便在传入设置值时获取结果数。

查询一：

```
SELECT vehicle_type, COUNT(*) AS total FROM inventory
[[ Already Selected Search Parameters]]
GROUP BY vehicle_type
ORDER BY vehicle_type ASC 
```

查询 2：

```
SELECT make, COUNT(*) AS total FROM inventory
[[ Already Selected Search Parameters]]
GROUP BY make
ORDER BY make ASC 
```

查询 3,4,5...

有没有办法在一个查询中做到这一点？它更快吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:09:04.520

您的查询似乎是合理的。

您可以使用以下命令在单个查询中执行此操作`UNION ALL`：

```
SELECT 'vehicle_type' AS query_type, vehicle_type, COUNT(*) AS total
FROM inventory
...
GROUP BY vehicle_type

UNION ALL

SELECT 'make', make, COUNT(*) AS total FROM inventory ... GROUP BY make

UNION ALL

SELECT ... etc ... 
```

这样做的性能优势不会很大。

如果您发现您经常触发这些查询并且结果不经常更改，您可能需要考虑缓存结果。考虑使用类似[memcache](http://php.net/manual/en/book.memcache.php)的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:09:19.080

有几种方法可以按照数据仓库的方式对数据进行排名，但您试图在搜索词中完成的任务称为构面。一个真正的搜索引擎（将与您提到的网站一起使用）执行此操作。

*   参见：[MySQL 和 Solr 中的分面搜索和类别](https://stackoverflow.com/questions/4702222/faceted-searching-and-categories-in-mysql-and-solr)

许多站点使用带有 SOLR 的 Lucene（基于 Java）搜索引擎来完成您所指的内容。有一个名为 ElasticSearch 的较新解决方案具有 RESTful API 并提供方面，但您需要安装 Java、ES，然后可以调用返回本机 JSON 的搜索引擎。

*   参见：[http ://www.elasticsearch.org/guide/reference/api/search/facets/](http://www.elasticsearch.org/guide/reference/api/search/facets/)

在 MySQL 中执行此操作而不需要如此多的连接可能需要额外的表，并且可能需要触发器并变得复杂。如果汽车经销商不期望 Cars.com 的流量（数百万/天），那么**您可能会尝试在它实际需要之前优化某些东西**。您的递归查询可能足够快，并且您还没有报告存在实际问题或瓶颈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:12:08.180

使用 JOIN 语法： [http ://dev.mysql.com/doc/refman/5.6/en/join.html](http://dev.mysql.com/doc/refman/5.6/en/join.html)

或者，我认为您可以为此编写 MySQL 函数。您将在哪里传递您的搜索参数。 [http://dev.mysql.com/doc/refman/5.1/en/create-function.html](http://dev.mysql.com/doc/refman/5.1/en/create-function.html)

要找到更快的位置，您应该进行自己的速度测试。这帮助我发现我的一些查询在不加入它们的情况下更快。

# java - Java/Maven：不同项目中的不同 slf4j 版本导致集成时出现构建错误

> ID：11509896
> 
> 赞同：5
> 
> 时间：2012-07-16T18:00:06.853
> 
> 标签：java, maven, slf4j

我有一个`project A`who`pom.xml`具有以下依赖项`slf4j`

```
 <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.5.10</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.5.10</version>
    </dependency> 
```

现在我有不同`project B`的人`pom.xml`有以下依赖`slf4j`

```
 </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.6.4</version>
    </dependency>
    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>1.0.3</version>
    </dependency> 
```

现在我需要**集成**两个项目，但是当它们有不同的版本时，它们不能很好地协同工作。所以这就是我尝试的方法1 - 在更改为之后升级
**slf4j`project A`**`pom.xml`

```
 <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.6.4</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.6.4</version>
    </dependency> 
```

我开始看到构建错误说

```
SLF4J: The requested version 1.5.10 by your slf4j binding is not compatible with [1.6]
SLF4J: See http://www.slf4j.org/codes.html#version_mismatch for further details. 
```

并且测试似乎失败了

```
java.lang.IllegalStateException: Failed to load ApplicationContext
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:308)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:109)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)
    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:321)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:220)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:301)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:303)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:240)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:46)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:180)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:41)
    at org.junit.runners.ParentRunner$1.evaluate(ParentRunner.java:173)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:220)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:180)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:59)
    at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:115)
    at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:102)
    at org.apache.maven.surefire.Surefire.run(Surefire.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:350)
    at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:1021)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 
```

**方法 2 - 降级 slf4j`project B`**

改变`pom.xml`如下

```
 <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.5.10</version>
    </dependency>
    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>1.0.3</version>
    </dependency> 
```

我在测试中看到错误

```
testPutDocument(com.org.sparrow.business.persist.MongoServiceTest): org.slf4j.helpers.MessageFormatter.arrayFormat(Ljava/lang/String;[Ljava/lang/Object;)Lorg/slf4j/helpers/FormattingTuple;
  testPutDocuments(com.org.sparrow.business.persist.MongoServiceTest): org.slf4j.helpers.MessageFormatter.arrayFormat(Ljava/lang/String;[Ljava/lang/Object;)Lorg/slf4j/helpers/FormattingTuple;
  testGetDocument(com.org.sparrow.business.persist.MongoServiceTest): org.slf4j.helpers.MessageFormatter.arrayFormat(Ljava/lang/String;[Ljava/lang/Object;)Lorg/slf4j/helpers/FormattingTuple; 
```

解决这个问题的最佳方法是什么？

**更新** 依赖树在这里

```
[INFO] +- commons-codec:commons-codec:jar:1.4:compile
[INFO] +- spy:spymemcached:jar:2.6:compile
[INFO] +- com.google.code.findbugs:annotations:jar:1.3.9:compile
[INFO] +- com.google.code.findbugs:jsr305:jar:1.3.9:compile
[INFO] +- redis.clients:jedis:jar:1.4.0:compile
[INFO] +- com.googlecode:hibernate-memcached:jar:1.2.2:compile
[INFO] |  \- spy:memcached:jar:2.4.2:compile
[INFO] +- j2ssh:core:jar:0.2.9-SR:compile
[INFO] +- emma:maven-emma-plugin:jar:0.5:test
[INFO] |  +- ant:ant:jar:1.6.3:test
[INFO] |  \- emma:emma_ant:jar:2.0.5312:test
[INFO] +- emma:emma:jar:2.0.4217:test
[INFO] |  +- commons-jelly:commons-jelly-tags-regexp:jar:1.0:test
[INFO] |  \- regexp:regexp:jar:1.3:test
[INFO] +- org.apache.commons:commons-email:jar:1.1:compile
[INFO] |  +- javax.mail:mail:jar:1.4:compile
[INFO] |  \- javax.activation:activation:jar:1.1:compile
[INFO] +- hsqldb:hsqldb:jar:1.8.0.7:test
[INFO] +- org.aspectj:aspectjrt:jar:1.6.1:compile
[INFO] +- org.aspectj:aspectjweaver:jar:1.6.1:compile
[INFO] +- org.springframework:spring-context-support:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-web:jar:3.0.5.RELEASE:compile
[INFO] |  \- aopalliance:aopalliance:jar:1.0:compile
[INFO] +- org.springframework:spring-tx:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-core:jar:3.0.5.RELEASE:compile
[INFO] |  +- org.springframework:spring-asm:jar:3.0.5.RELEASE:compile
[INFO] |  \- commons-logging:commons-logging:jar:1.1.1:compile
[INFO] +- org.springframework:spring-context:jar:3.0.5.RELEASE:compile
[INFO] |  \- org.springframework:spring-expression:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-beans:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-jdbc:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-orm:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-webmvc:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-agent:jar:2.5.6:compile
[INFO] +- org.springframework:spring-aop:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework:spring-aspects:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework.security:spring-security-core:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework.security:spring-security-web:jar:3.0.5.RELEASE:compile
[INFO] +- org.springframework.security:spring-security-cas-client:jar:3.0.5.RELEASE:compile
[INFO] |  \- org.jasig.cas:cas-client-core:jar:3.1.10:compile
[INFO] +- org.springframework.security:spring-security-config:jar:3.0.5.RELEASE:compile
[INFO] +- org.jasig.cas.client:cas-client-core:jar:3.2.0:compile
[INFO] +- org.hibernate:hibernate-envers:jar:3.5.6-Final:compile
[INFO] |  +- org.hibernate:hibernate-core:jar:3.5.6-Final:compile
[INFO] |  |  +- antlr:antlr:jar:2.7.6:compile
[INFO] |  |  \- javax.transaction:jta:jar:1.1:compile
[INFO] |  +- org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.0.Final:compile
[INFO] |  +- org.hibernate:hibernate-commons-annotations:jar:3.2.0.Final:compile
[INFO] |  +- org.hibernate:hibernate-annotations:jar:3.5.6-Final:compile
[INFO] |  \- org.hibernate:hibernate-tools:jar:3.2.0.ga:compile
[INFO] |     +- org.beanshell:bsh:jar:2.0b4:compile
[INFO] |     +- freemarker:freemarker:jar:2.3.8:compile
[INFO] |     \- org.hibernate:jtidy:jar:r8-20060801:compile
[INFO] +- org.hibernate:hibernate-entitymanager:jar:3.5.6-Final:compile
[INFO] |  \- cglib:cglib:jar:2.2:compile
[INFO] |     \- asm:asm:jar:3.1:compile
[INFO] +- org.hibernate:hibernate-c3p0:jar:3.5.6-Final:compile
[INFO] +- org.hibernate:hibernate-validator:jar:4.1.0.Final:compile
[INFO] |  \- javax.validation:validation-api:jar:1.0.0.GA:compile
[INFO] +- org.springframework:spring-hibernate3:jar:2.0.8:compile
[INFO] +- org.slf4j:slf4j-api:jar:1.5.10:compile
[INFO] +- org.slf4j:slf4j-log4j12:jar:1.5.10:compile
[INFO] +- javassist:javassist:jar:3.4.GA:compile
[INFO] +- c3p0:c3p0:jar:0.9.1.2:compile
[INFO] +- eu.medsea:utils:jar:1.0:compile
[INFO] +- velocity-tools:velocity-tools-view:jar:1.4:compile
[INFO] +- velocity:velocity:jar:1.5:compile
[INFO] |  +- commons-collections:commons-collections:jar:3.1:compile
[INFO] |  +- commons-lang:commons-lang:jar:2.1:compile
[INFO] |  \- oro:oro:jar:2.0.8:compile
[INFO] +- axis:axis:jar:1.4:compile
[INFO] |  +- org.apache.axis:axis-jaxrpc:jar:1.4:compile
[INFO] |  +- org.apache.axis:axis-saaj:jar:1.4:compile
[INFO] |  \- commons-discovery:commons-discovery:jar:0.2:runtime
[INFO] +- junit:junit:jar:4.8.2:compile
[INFO] +- org.jmock:jmock-junit4:jar:2.5.1:compile
[INFO] |  \- org.jmock:jmock:jar:2.5.1:compile
[INFO] |     +- org.hamcrest:hamcrest-core:jar:1.1:compile
[INFO] |     \- org.hamcrest:hamcrest-library:jar:1.1:compile
[INFO] +- xalan:xalan:jar:2.7.0:compile
[INFO] |  \- xml-apis:xml-apis:jar:1.0.b2:compile
[INFO] +- xerces:xercesImpl:jar:2.4.0:compile
[INFO] +- jdom:jdom:jar:1.0:compile
[INFO] +- net.sourceforge.jexcelapi:jxl:jar:2.6:compile
[INFO] +- log4j:log4j:jar:1.2.15:compile
[INFO] +- jaxen:jaxen:jar:1.1.1:compile
[INFO] |  +- dom4j:dom4j:jar:1.6.1:compile
[INFO] |  \- xom:xom:jar:1.0:compile
[INFO] |     +- xerces:xmlParserAPIs:jar:2.6.2:compile
[INFO] |     \- com.ibm.icu:icu4j:jar:2.6.1:compile
[INFO] +- mapquest:mapquest:jar:5.3.0:compile
[INFO] +- jfree:jfreechart:jar:1.0.0:compile
[INFO] |  \- jfree:jcommon:jar:1.0.0:compile
[INFO] +- org.fraid.fraid:fraid:jar:1.5:compile
[INFO] +- com.thoughtworks.xstream:xstream:jar:1.3.1:compile
[INFO] |  \- xpp3:xpp3_min:jar:1.1.4c:compile
[INFO] +- mysql:mysql-connector-java:jar:5.1.13:compile
[INFO] +- joda-time:joda-time:jar:1.6:compile
[INFO] +- nl.jqno.equalsverifier:equalsverifier:jar:0.6.2:test
[INFO] |  +- org.objenesis:objenesis:jar:1.1:test
[INFO] |  \- cglib:cglib-nodep:jar:2.2:test
[INFO] +- org.easymock:easymockclassextension:jar:2.5.2:test
[INFO] |  \- org.easymock:easymock:jar:2.5.2:test
[INFO] +- org.springframework:spring-test:jar:3.0.5.RELEASE:compile
[INFO] +- cdyne:cdyne:jar:3.0:compile
[INFO] |  \- javax.xml:jaxrpc-api:jar:1.1:compile
[INFO] +- json:json:jar:0.0.1:compile
[INFO] +- org.dbunit:dbunit:jar:2.4.8:test
[INFO] +- org.mongodb:mongo-java-driver:jar:2.2:compile
[INFO] +- com.google.code.gson:gson:jar:1.4:compile
[INFO] +- xml-security:xmlsec:jar:1.3.0:compile
[INFO] \- javatar:javatar:jar:2.5:compile 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:43:13.530

在您的问题中，您提到您在项目**A的 pom.xml 中将 slf4j-api 和 slf4j-log4j12 升级到版本****1.6.4**但您发布的依赖关系树提到了 slf4j-api 和 slf4j-log4j12 版本**1.5.0**。只要你确定一个版本，使 slf4j-api 和它的绑定版本匹配，你会没事的。

 ****您的其他依赖项为 SLF4J 声明的 SLF4J 版本无关紧要。从客户端的角度来看[，所有版本的 slf4j 都是二进制兼容的](http://www.slf4j.org/manual.html#compatibility)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T21:24:42.663

作为库包含在其他项目中的 Jar 项目不应在 POM 中包含除 slf4j-api 之外的任何内容。由最终项目（即您的示例中的项目 A）决定实施。对于测试项目 B，可以包含诸如 slf4j-log4j12 和 log4j 本身之类的实现，但这些应该`test`在 Maven 中进行。****

# opencv - OpenCV 标头错误 (YAML)

> ID：11509901
> 
> 赞同：0
> 
> 时间：2012-07-16T18:00:29.413
> 
> 标签：opencv, yaml

好的，所以我觉得我终于成功地在我的应用程序中使用了 OpenCV 库，除了一件事......

我的 .yml 文件生成正确，除了顶部的 '%YAML:1.0' 标头变成了这样的 '01%YAML:1.0'。标题前面的 '01' 导致了这个错误（我认为）：

```
OpenCV Error: Parsing error (/var/mobile/Applications/53C6CBA3-15B7-436A-892B-2ECFA75B72CD/Library/DownloadedDescriptors/descriptors.yml(1): Valid XML should start with '<?xml ...?>') in icvXMLParse, file /Users/Dash/Documents/SmartServices/AirLink/ProjectGhost/FairfaxNewsDemo/opencv-2.3.1/OpenCV-2.3.1/modules/core/src/persistence.cpp, line 2163 
```

有谁知道如何解决这个问题？

好吧，在进一步研究之后，我认为这不是标题问题。我的文件总是在开始时生成'01'。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:54:28.647

嗯……这很尴尬。但事实证明，我在 php 文件中保留了一个“打印”语句，该语句有助于生成我的 .yaml 文件，导致将 0 和 1 添加到文档的开头。

这意味着我的文件没有按预期以 '%YAML:1.0' 开头，而是 '01%YAML:1.0'

# c# - Microsoft.Web.Administration 内存泄漏

> ID：11509902
> 
> 赞同：5
> 
> 时间：2012-07-16T18:00:34.747
> 
> 标签：c#, .net

拥有一个 Windows 服务，其中包括监视 IIS 应用程序池。如果任何池已配置应用程序且未运行，则启动它（池）。这已经有一段时间了。最近发现该服务正在泄漏内存。查看内存转储，罪魁祸首是用于检查应用程序池的 Microsoft.Web.Administration。唯一一次性的对象是 ServerManager，我在 using 块中有它。已找到有关此泄漏的其他报告，但尚无解决方案。[（请参阅http://msdn.microsoft.com/en-us/library/microsoft.web.administration.servermanager(v=vs.90).aspx#CommunityContent](http://msdn.microsoft.com/en-us/library/microsoft.web.administration.servermanager(v=vs.90).aspx#CommunityContent)中的用户评论）

当转储 Microsoft.Web.Administration.ServerManager 的所有根目录（此转储中的 481）时，我只看到其中一个根目录。假设这是当前迭代。

不确定为什么无法收集这些 Web.Administration 对象，即使它们似乎没有被植根（？）。关于如何堵塞这个泄漏的任何想法？

我将代码移动到控制台应用程序并在那里重现了泄漏。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using Microsoft.Web.Administration;

namespace Web.Administration.LeakExample
{
    public static class ServerManagerExtensions
    {
        /// <summary>
        /// Returns the application counts for application pools under the specified ServerManager.
        /// Application pools without applications will not be returned.
        /// </summary>
        /// <param name="manager"></param>
        /// <returns></returns>
        public static Dictionary<string, uint> GetPoolApplicationCounts(this ServerManager manager)
        {
            if (manager == null)
            {
                throw new ArgumentNullException();
            }

            var appCounts = new Dictionary<string, uint>(manager.ApplicationPools.Count);
            foreach (var app in manager.Sites.SelectMany(site => site.Applications))
            {
                if (!appCounts.ContainsKey(app.ApplicationPoolName))
                {
                    appCounts.Add(app.ApplicationPoolName, 1);
                }
                else
                {
                    appCounts[app.ApplicationPoolName]++;
                }
            }

            return appCounts;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            while (!Console.KeyAvailable)
            {
                Console.WriteLine("Checking App Pools...");

                using (var manager = new ServerManager())
                {
                    var appCounts = manager.GetPoolApplicationCounts();

                    var appPools = manager.ApplicationPools.Where(pool => appCounts.ContainsKey(pool.Name));

                    foreach (
                        var pool in
                            appPools.Where(
                                pool => (pool.State != ObjectState.Started) && (pool.State != ObjectState.Starting)))
                    {
                        var state = pool.Start();

                        if ((state == ObjectState.Started) || (state == ObjectState.Starting))
                        {
                            Console.WriteLine("Started app pool \"{0}\"", pool.Name);
                        }
                        else
                        {
                            Console.WriteLine("Failed to start app pool \"{0}\". state:{1}", pool.Name, state);
                        }
                    }
                }

                Console.WriteLine("Sleeping...");
                Thread.Sleep(1000);
            }
        }
    }
} 
```

WinDbg 会话：

```
> !dumpheap -stat

606b778c      479         5748 System.Runtime.Remoting.Activation.ConstructionLevelActivator
00472088      480         5760 System.Collections.Generic.Dictionary`2+ValueCollection[[System.String, mscorlib],[Microsoft.Web.Administration.Interop.IAppHostElement, Microsoft.Web.Administration]]
00471d5c      480         5760 System.Collections.Generic.SortedList`2+ValueList[[System.String, mscorlib],[Microsoft.Web.Administration.Configuration, Microsoft.Web.Administration]]
00194568      481         5772 Web.Administration.LeakExample.Program+<>c__DisplayClass3
00198438      480         7680 Microsoft.Web.Administration.Interop.AppHostWritableAdminManager
0047199c      481         7696 System.Linq.Enumerable+<>c__DisplayClassf`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
606cc200      958        11496 System.Char
00471e2c      479        11496 System.Collections.Generic.SortedList`2+SortedListValueEnumerator[[System.String, mscorlib],[Microsoft.Web.Administration.Configuration, Microsoft.Web.Administration]]
0047090c      479        11496 System.Collections.Generic.List`1+Enumerator[[Microsoft.Web.Administration.Site, Microsoft.Web.Administration]]
004706f0      958        11496 Microsoft.Web.Administration.ConfigurationElementCollectionBase`1+<>c__DisplayClass4[[Microsoft.Web.Administration.Site, Microsoft.Web.Administration]]
00471aec      480        11520 System.Collections.Generic.List`1+Enumerator[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
0047041c      480        11520 System.Collections.Generic.List`1[[Microsoft.Web.Administration.Site, Microsoft.Web.Administration]]
00196d58      480        11520 System.Collections.Generic.List`1[[Microsoft.Web.Administration.Configuration, Microsoft.Web.Administration]]
004715cc      481        11544 System.Collections.Generic.List`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
0047103c     1437        17244 Microsoft.Web.Administration.ConfigurationElementCollectionBase`1+<>c__DisplayClass4[[Microsoft.Web.Administration.Application, Microsoft.Web.Administration]]
606ccfc8     1438        17256 System.Int32
00196a58      480        19200 System.Collections.Generic.SortedList`2[[System.String, mscorlib],[Microsoft.Web.Administration.Configuration, Microsoft.Web.Administration]]
0019660c      480        21120 Microsoft.Web.Administration.ConfigurationManager
00471130      958        22992 System.Collections.Generic.List`1+Enumerator[[Microsoft.Web.Administration.Application, Microsoft.Web.Administration]]
00470d68      960        23040 System.Collections.Generic.List`1[[Microsoft.Web.Administration.Application, Microsoft.Web.Administration]]
00198558      480        23040 System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[Microsoft.Web.Administration.Interop.IAppHostElement, Microsoft.Web.Administration]]
00196a08      481        23088 Microsoft.Web.Administration.Configuration
00183170      481        23088 System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.UInt32, mscorlib]]
606b7574      479        24908 System.Runtime.Remoting.Messaging.ConstructorCallMessage
00199e7c      479        24908 System.Linq.Enumerable+<SelectManyIterator>d__14`2[[Microsoft.Web.Administration.Site, Microsoft.Web.Administration],[Microsoft.Web.Administration.Application, Microsoft.Web.Administration]]
00199384      480        28800 System.Collections.Generic.Dictionary`2+Entry[[System.String, mscorlib],[Microsoft.Web.Administration.Interop.IAppHostElement, Microsoft.Web.Administration]][]
00470874      958        30656 System.Predicate`1[[Microsoft.Web.Administration.Site, Microsoft.Web.Administration]]
004718a8      962        30784 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
001944d8      481        30784 Microsoft.Web.Administration.ServerManager
00195178      963        30816 System.Func`2[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration],[System.Boolean, mscorlib]]
606ccf90      968        31268 System.Int32[]
00197a50      480        32640 Microsoft.Web.Administration.SiteCollection
00194da0      481        32708 Microsoft.Web.Administration.ApplicationPoolCollection
004719f8     2874        34488 Microsoft.Web.Administration.ConfigurationElementCollectionBase`1+<>c__DisplayClass4[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
0019810c      960        42240 Microsoft.Web.Administration.ConfigurationSection
00471098     1437        45984 System.Predicate`1[[Microsoft.Web.Administration.Application, Microsoft.Web.Administration]]
606cc1c8      961        46638 System.Char[]
001838d0      481        59644 System.Collections.Generic.Dictionary`2+Entry[[System.String, mscorlib],[System.UInt32, mscorlib]][]
606bedd0     5269        63228 System.UInt32
00470a7c      960        69120 Microsoft.Web.Administration.ApplicationCollection
00197c60      960        76800 Microsoft.Web.Administration.Site
00197ea8     1440        86400 Microsoft.Web.Administration.Application
00471a54     2874        91968 System.Predicate`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
6067c684     4832       141272 System.Object[]
00195024     2886       196248 Microsoft.Web.Administration.ApplicationPool
606c7b20    16323       261168 System.__ComObject

>.foreach (obj {!dumpheap -mt 001944d8 -short}){!gcroot -all obj}

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+70: 002ef148
            ->  02773270 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+68: 002ef150
            ->  02773270 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+78: 002ef140
            ->  027732c0 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+6c: 002ef14c
            ->  02773270 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+74: 002ef144
            ->  027732c0 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+60: 002ef158
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+3c: 002ef17c
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+4c: 002ef16c
            ->  027732c0 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+40: 002ef178
            ->  02773270 System.Linq.Enumerable+WhereEnumerableIterator`1[[Microsoft.Web.Administration.ApplicationPool, Microsoft.Web.Administration]]
            ->  02772948 Microsoft.Web.Administration.ApplicationPoolCollection
            ->  02772060 Microsoft.Web.Administration.ServerManager

    002ef124 003f0359 Web.Administration.LeakExample.Program.Main(System.String[]) [c:\Users\Chuck\Documents\Visual Studio 2012\Projects\Web.Administration.LeakExample\Web.Administration.LeakExample\Program.cs @ 74]
        ebp+50: 002ef168
            ->  02772060 Microsoft.Web.Administration.ServerManager

Found 10 roots. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:17:21.867

当我第一次阅读这个问题时，我首先想到的是，通过使用[Windows 激活服务 (WAS)](http://msdn.microsoft.com/en-us/library/ms789006.aspx)可以完全避免整个问题。

我第一次浏览您发布的代码让我觉得您的问题可能与访问/修改`foreach`循环创建的各种闭包有关。

尝试这些小的重构，看看是否有任何/全部能够减少或消除问题或失败，提供有关根本原因的更多信息：

1.  `.ToList()`通过立即调用避免延迟执行 LINQ 查询
2.  不要重复使用`ServerManager`对象，而是在循环的每次迭代中创建一个新对象
3.  由于您只使用`ApplicationPool.Name`，请重构：

    `foreach (var app in manager.Sites.SelectMany(site => site.Applications))`

对此：

```
foreach (var app in manager.Sites.SelectMany(site => site.Applications, 
   (s, a) => a.Name)
    .ToList()) 
```

我的假设是这就是正在发生的事情：

*   的新实例`ServerManager`在`using`语句中创建
*   对该对象引用调用静态扩展方法，该对象引用在`ApplicationPools`内部使用
*   `ApplicationPools`立即在构造 IQueryable 时再次使用，该 IQueryable 立即使用（但未完全执行——`foreach`语句在`yield return`内部使用）并过滤。
*   调用对象引用所引用的`.Start()`更改（变异）状态`ApplicationPool``ServerManager`
*   其余的无关紧要，因此循环回到开头。它仍然使用相同的`ServerManager`. 由于该引用具有突变状态（由于调用`.Start()`），它可能会被 GC 标记并且永远不会被收集 - 该应用程序池永远不会在后续迭代的结果中返回，并且可能导致内存中引用的孤立。

这只是一个假设，请记住！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:50:12.773

我现在相信这不是真正的泄漏。[我按照乔希](https://stackoverflow.com/users/105566/josh-e)的建议尝试了 ToList() 一切。这并不影响内存使用。

我在循环中添加了一个 GC.Collect() （仅用于测试目的），这消除了“泄漏”。我通过内存转储验证了这一点，是否在堆上没有发现 Web.Application 对象。这与我在以前的转储中看到的所有 Web.Application 对象中的一个实际上都被植根的事实不谋而合。其他的都没有扎根，等待收集。

我被 .NET 垃圾收集器的不确定性所困扰。对不起，噪音。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-23T15:08:51.947

我在这里找到了解决方案：[www.tomanderson.me](http://www.tomanderson.me/2014/04/microsoftwebadministration-memory-leak.html)。

建议使用

```
using (ServerManager sm = ServerManager.OpenRemote("localhost"))
{ /*..*/ } 
```

对我有用。

# php - 通知网页有关插件的新版本 php

> ID：11509907
> 
> 赞同：0
> 
> 时间：2012-07-16T18:00:43.257
> 
> 标签：php, plugins, notifications

我正在开发一个 Web 应用程序，用户可以在其中上传多个插件。我想通过 wordpress 插件版本顾问等功能为我的应用程序提供额外的价值。我不知道如何深入这个领域才能调查。我听到类似“pingtracks”的声音，但不确定这是否正确。好吧，这是我的疑问，我如何确定是否有要升级的新插件版本？

提前致谢。

PS：我的数据库中有一个表，其中包含所有插件相关数据，如 url、作者、当前版本等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:05:10.810

每个插件都应该有一个用于某种更新清单的 URL。该 URL 处的资源应包含当前可用版本和需要更新的文件的 URL 等信息。该文件可以像静态 JSON 数据一样简单。

请记住使用 HTTPS，这样更难欺骗您的更新站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:09:57.653

每次该用户上传新插件时，请检查数据库中的“当前版本”并将其与上一次上传的同名插件进行比较。（例如创建另一个表来保存所需的数据）

# java - Android 中带有 Selector 的 Java TCP 服务器 NIO

> ID：11509909
> 
> 赞同：0
> 
> 时间：2012-07-16T18:00:48.580
> 
> 标签：java, android, selector, nio

我正在android中开发一个将充当服务器的应用程序，也就是说，将有一个平板电脑将成为“服务器”，并且会有其他平板电脑将连接到“服务器”。我正在尝试将 java NIO 与选择器一起使用，以节省线程。但我的问题是，我在 android 的线程中运行了 java 代码，但是当线程运行时它不会发生任何事情。在客户端，它给出了连接被拒绝的例外情况。该代码在 java 应用程序中运行，但在 android 中没有。

我也有互联网许可。

java选择器：

```
Thread t = new Thread(new Runnable() {

    private Selector            selector;
    private ServerSocketChannel sChan;
    private List<SocketChannel> sockets;

    public void run() {

        try {
            selector = SelectorProvider.provider().openSelector();
            sChan = ServerSocketChannel.open();
            InetSocketAddress iaddr = new InetSocketAddress(InetAddress.getLocalHost(), 8000);

            sChan.configureBlocking(false);
            sChan.socket().bind(iaddr);

            System.out.println("Running on port:" + sChan.socket().getLocalPort());

            sChan.register(selector, SelectionKey.OP_ACCEPT);
            sockets = new LinkedList<SocketChannel>();

        }
        catch (IOException e) {
            e.printStackTrace();
        }

        Iterator<SelectionKey> it;

        try {
            while (true) {
                selector.select();

                it = selector.selectedKeys().iterator();
                while (it.hasNext()) {
                    SelectionKey key = it.next();

                    it.remove();
                    if (!key.isValid()) {
                        continue;
                    }

                    // Finish connection in case of an error
                    if (key.isConnectable()) {
                        SocketChannel ssc = (SocketChannel) key.channel();
                        if (ssc.isConnectionPending()) {
                            ssc.finishConnect();
                        }
                    }

                    if (key.isAcceptable()) {
                        ServerSocketChannel ssc = (ServerSocketChannel) key.channel();
                        SocketChannel newClient = ssc.accept();

                        newClient.configureBlocking(false);
                        newClient.register(selector, SelectionKey.OP_READ);
                        sockets.add(newClient);

                        System.out.println("new client: " + newClient.socket().getInetAddress().getHostAddress());
                    }

                    if (key.isReadable()) {
                        SocketChannel sc = (SocketChannel) key.channel();
                        ByteBuffer data = ByteBuffer.allocate(sc.socket().getSendBufferSize());

                        System.out.println("new message: " + sc.socket().getInetAddress().getHostAddress());

                        if (sc.read(data) == -1) {
                            continue;
                        }

                        data.flip();

                        Teste m = (Teste) UdpUtil.byteToMessage(data.array());

                        System.out.println("message: " + m);
                        System.out.println("\n\n" + m.cenas);
                        sc.close();
                    }
                }
            }
        }
        catch (IOException e) {
            e.printStackTrace();
        }
    }
});
t.start(); 
```

和客户端应用程序：

```
InetSocketAddress isa = new InetSocketAddress(InetAddress.getByName("192.168.2.102"), 8000);

    SocketChannel sc = null;

    try {

        // Connect
        sc = SocketChannel.open();
        sc.connect(isa);

        // Read the time from the remote host. For simplicity we assume
        // that the time comes back to us in a single packet, so that we
        // only need to read once.

        byte[] message = UdpUtil.messageToByteMessage(new messages.Teste("hello there"));

        ByteBuffer buf = ByteBuffer.wrap(message);
        sc.write(buf);
    }
    finally {
        // Make sure we close the channel (and hence the socket)
        if (sc != null) {
            sc.close();
        }
} 
```

**注意：** Teste*类*只是一个类，将用作机器人之间的消息。

我什至尝试过这段[代码](http://systembash.com/content/a-simple-java-tcp-server-and-tcp-client/)，一切顺利，但选择器没有。我希望我清楚自己的问题是什么。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T02:56:35.580

删除 new InetSocketAddress() 的第一个参数，用于绑定 ServerSocketChannel。目前您只绑定到 127.0.0.1，从其他主机看不到。通过省略参数，您将绑定到 0.0.0.0，这意味着“监听所有接口”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:29:51.957

通过进入您的 AndroidManifest.xml 文件并输入：uses-permission android:name="android.permission.INTERNET" />，确保您已在 Android 中请求互联网权限

# tomcat - IIS 7.5 和 ColdFusion 10 的 SES 问题

> ID：11509912
> 
> 赞同：3
> 
> 时间：2012-07-16T18:01:12.353
> 
> 标签：tomcat, url-rewriting, iis-7.5, coldfusion-10, coldbox

我有一个使用[ColdBox](http://www.coldbox.org/)构建的站点，并试图从 URL 中删除 /index.cfm/。我使用下面的 web.config 文件在 IIS7 上运行的 ColdFusion 9 上运行良好，但我无法让它在 CF10/IIS7.5 上运行。安装了重写模块，并且包含 index.cfm（即 index.cfm/product/1）的 SES URL 可以正常工作。我知道 CF10 现在在 Tomcat 而不是 JRun 上运行，并且开箱即用的 Tomcat 不支持 SES URL，但据我了解，CF 团队明确添加了对它们的支持（并且确实检查了 web.xml 文件表明是真的。）我真的不相信这是一个 ColdBox 特定的问题，而是 CF10/Tomcat 和 IIS7.5 之间的问题。

注意：我没有直接访问网络服务器的权限，但正在与托管服务提供商合作。无论如何，我也不是 IIS 专业人士。最后，不，Apache 不是一个选项 - 相信我，我希望不是这样；-)

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
<system.webServer>
    <defaultDocument>
        <files>
            <clear />
            <add value="index.cfm" />
            <add value="Default.htm" />
            <add value="Default.asp" />
            <add value="index.htm" />
            <add value="index.html" />
            <add value="iisstart.htm" />
            <add value="default.aspx" />
        </files>
    </defaultDocument>
    <rewrite>
        <rules>
            <rule name="SQL Injection - EXEC" stopProcessing="true">
                <match url="^.*EXEC\(@.*$" />
                <action type="CustomResponse" url="/includes/templates/404.html" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
            </rule>
            <rule name="SQL Injection - CAST" stopProcessing="true">
                <match url="^.*CAST\(.*$" />
                <action type="CustomResponse" url="/includes/templates/404.html" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
            </rule>
            <rule name="SQL Injection - DECLARE" stopProcessing="true">
                <match url="^.*DECLARE.*$" />
                <action type="CustomResponse" url="/includes/templates/404.html" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
            </rule>
            <rule name="SQL Injection - DECLARE%20" stopProcessing="true">
                <match url="^.*DECLARE%20.*$" />
                <action type="CustomResponse" url="/includes/templates/404.html" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
            </rule>
            <rule name="SQL Injection - NVARCHAR" stopProcessing="true">
                <match url="^.*NVARCHAR.*$" />
                <action type="CustomResponse" url="/includes/templates/404.html" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
            </rule>
            <rule name="SQL Injection - sp_password" stopProcessing="true">
                <match url="^.*sp_password.*$" />
                <action type="CustomResponse" url="/includes/templates/404.html" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
            </rule>
            <rule name="SQL Injection - xp" stopProcessing="true">
                <match url="^.*%20xp_.*$" />
                <action type="CustomResponse" url="/includes/templates/404.html" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
            </rule>
            <rule name="Application Adminsitration" stopProcessing="true">
                <match url="^(.*)$" />
                <conditions logicalGrouping="MatchAll">
                    <add input="{SCRIPT_NAME}" pattern="^/(.*(CFIDE|cfide|CFFormGateway|jrunscripts|railo-context|fckeditor)).*$" ignoreCase="false" />
                </conditions>
                <action type="None" />
            </rule>
            <rule name="Flash and Flex Communication" stopProcessing="true">
                <match url="^(.*)$" ignoreCase="false" />
                <conditions logicalGrouping="MatchAll">
                    <add input="{SCRIPT_NAME}" pattern="^/(.*(flashservices|flex2gateway|flex-remoting)).*$" ignoreCase="false" />
                </conditions>
                <action type="Rewrite" url="index.cfm/{PATH_INFO}" appendQueryString="true" />
            </rule>
            <rule name="Static Files" stopProcessing="true">
                <match url="^(.*)$" />
                <conditions logicalGrouping="MatchAll">
                    <add input="{SCRIPT_NAME}" pattern="\.(bmp|gif|jpe?g|png|css|js|txt|pdf|doc|xls)$" ignoreCase="false" />
                </conditions>
                <action type="None" />
            </rule>
            <rule name="RESTful Applications (not working yet)" stopProcessing="true">
                <match url="^(.*)$" />
                <conditions logicalGrouping="MatchAll">
                    <add input="{SCRIPT_NAME}" pattern="^/(.*(rest)).*$" ignoreCase="false" />
                </conditions>
                <action type="None" />
            </rule>
            <rule name="Insert index.cfm" stopProcessing="true">
                <match url="^(.*)$" ignoreCase="false" />
                <conditions logicalGrouping="MatchAll">
                    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                    <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                </conditions>
                <action type="Rewrite" url="index.cfm/{PATH_INFO}" appendQueryString="true" />
            </rule>
        </rules>
    </rewrite>
</system.webServer>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:03:06.240

我发现的唯一解决方法是安装不同的 URL 重写器，例如 Helicon 的。

但这已在本周末发布的 10.0.1 更新中得到修复！ [http://blogs.coldfusion.com/post.cfm/coldfusion-10-update-1-10-0-1-released](http://blogs.coldfusion.com/post.cfm/coldfusion-10-update-1-10-0-1-released)

# php - 绑定到套接字时执行循环

> ID：11509914
> 
> 赞同：0
> 
> 时间：2012-07-16T18:01:15.493
> 
> 标签：php, sockets

所以我已经让我的 PHP 脚本绑定到套接字并将传入数据写入文本文件，因为新信息会顺流而下。这运作良好。我想做的是每次更新文本文件时运行另一个单独的 PHP 脚本。

我试图通过使用“包含”命令来实现这一点，但它不起作用。我已经通过使用该命令模拟一个非常简单的脚本来测试我的“包含”方法是否有效。也许我将代码行放在错误的位置？我在 do-while 循环中有它（参见下面的代码）。

也许需要重新启动或重置脚本/套接字才能进行更改？

任何帮助，将不胜感激。谢谢！

这是我的代码的要点：

```
[socket create, bind, and listen stuff goes here]

do {
$input = socket_read($spawn, 4096, 1) or die("Could not read input\n");
$trimmed = trim($input);

if ($trimmed != "") {
  echo date($dateformat) . ": Received input: $trimmed\n";
  if ($trimmed == "END") {
     socket_close($spawn);
     break;
  }
  else {
     // write content
     $fhp = fopen($textFile, 'w') or die("can't open file");
     fwrite($fhp, $trimmed);
     fclose($fhp);
     echo date($date) . ": Wrote: " . $trimmed ."\n";

    // run my other PHP script - the crux of my issue - this is not working
    include '/home/public_html/update.php';

     }
     echo date($dateformat) . ": updated \n";
    }
   }
} while (true);

socket_close($socket);
echo "Socket term\n"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:22:05.187

您问题中脚本中的逻辑是

*   开始循环
*   读取套接字
*   打开文件句柄
*   写入文件
*   关闭文件

*   回声
*   关闭套接字
*   结束循环

我不明白为什么脚本不能像你说的那样工作，因为文件在 include() 行之前被写入和关闭。以下代码行在 if/else 之外，可能会引起一些混乱，因为如果 IF 条件为 TRUE，那么它仍然会输出更新的内容。

```
 echo date($dateformat) . ": updated \n"; 
```

如果问题仍然存在，您能否粘贴 update.php 脚本，可能问题出在此处。

* * *

-- 编辑以包含 update.php 如果文件有内容，则在文件关闭后应用此代码。

```
if(filesize($textFile) != 0){
 include '/home/public_html/update.php';
} 
```

上面的代码检查 $textFile 是否不等于 0，以便包含 update.php 文件。

# google-maps-api-3 - 在 google maps api v3 中隐藏方向服务中的标记

> ID：11509917
> 
> 赞同：13
> 
> 时间：2012-07-16T18:01:27.997
> 
> 标签：google-maps-api-3

我正在使用此服务[https://developers.google.com/maps/documentation/javascript/directions](https://developers.google.com/maps/documentation/javascript/directions)在两个标记之间创建一条路线。

问题是，当我运行创建路径的函数时，当我创建具有不同样式的标记时，他默认从谷歌地图（开头和结尾）输入两个标记。

结果：在每个点上都有我的标记和标记的默认谷歌地图。

如何隐藏谷歌创建的标记？

我正在使用的代码是：

```
function makePathToMarker(position1, position2) {
    var request = {
        origin: new google.maps.LatLng(myLocation.split(",")[0],myLocation.split(",")[1]),
        destination: new google.maps.LatLng(position1, position2),
        travelMode: google.maps.DirectionsTravelMode.DRIVING
    };

    var directionsService = new google.maps.DirectionsService();

    directionsService.route(request, function(response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-16T18:50:36.340

实例化 DirectionsRenderer 时，将 suppressMarkers 设置为 true。

```
 directionsDisplay = new google.maps.DirectionsRenderer(
  {
      suppressMarkers: true
  }); 
```

这是[**参考**](https://developers.google.com/maps/documentation/javascript/reference#DirectionsRendererOptions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-28T11:30:34.507

取决于你需要什么

```
directionsDisplay.setOptions({ 
     suppressPolylines: true, 
     suppressMarkers: true
}); 
```

# android - 有没有一种简单的方法可以像电影学分一样自动垂直滚动 TextView？

> ID：11509924
> 
> 赞同：3
> 
> 时间：2012-07-16T18:02:16.770
> 
> 标签：android, textview

我有一个带有任意数量文本的 TextView。我的目标是让它自动从完全超出视图底部滚动，一直滚动到顶部，并以与文本长度无关的固定速率完全离开顶部。我目前主要使用线性滚动器，但它是一个巨大的混乱。Scroller 仅适用于固定持续时间的滚动范围，因此我必须根据 TextView 中有多少行、行高以及每秒要滚动多少行来计算它。

因此，在视图完成调整大小之后，我什么都做不了，暂停和恢复滚动是一团糟，等等。代码看起来很糟糕，我想知道是否有更简单的方法来实现这种效果而无需跳过箍和很可能会引入不可预见的错误？

谢谢！

# css - 让容器适合其一个孩子的宽度，另一个孩子使用 text-overflow

> ID：11509928
> 
> 赞同：0
> 
> 时间：2012-07-16T18:02:38.037
> 
> 标签：css

我正在寻找一种方法让 HTML 容器适合其一个孩子的宽度。

好的，我知道，这就是它的设计方式。

但！我还需要另一个孩子用“文本溢出：省略号”折叠。问题是：要应用这样的属性，你需要这个孩子处于“显示：块”模式，这使得它扩大了容器的宽度。

是否有任何秘密时间来实现我正在寻找的东西。

这是一个[JsFiddle](http://jsfiddle.net/7ddSJ/1/)，以防你不明白或想试一试。

编辑：顺便说一句，这很重要，我专门针对 Internet Explorer 10。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:49:17.210

正如沃森所说，没有“缩小到适合”的 css 规则。所以，你有两个选择：

1.  手动和静态设置 .overflow 元素的大小。所以，不是宽度：100%，而是宽度：330px。

2.  使用 javascript 动态调整 .overflow 元素的大小。（我假设你有不止一个。）你说你想缩小到最大的内部 div。假设您有几个 div 可能要缩小到，但您想缩小到其中最大的一个。首先，您将它们全部设置为这样的类：

    ```
    .good-width{
        border: solid 2px salmon;
        width:auto; /* necessary for some browsers' offsetWidth */
        display:inline-block; /* gives it the width of the contents */
    } 
    ```

你把类似这样的javascript放在页面顶部：

```
var goods = document.getElementsByClassName('good-width');
//collect the widest one's width
var maxwidth = 0;
for(var x = 0; x < goods.length; x++) {
    if(goods[x].offsetWidth > maxwidth) {
        maxwidth = goods[x].offsetWidth;
    }
}
//set the width of the overflow divs to match
var overflows = document.getElementsByClassName('overflow');
for(var y = 0; y < overflows.length; y++) {
    overflows[y].style.width = maxwidth + 'px';
} 
```

如果我误解了，并且您试图将特定的溢出与特定的宽度匹配，您应该为每个元素分配一个 id 并以这种方式执行操作：

```
document.getElementById('overflowID').style.width = document.getElementById('good-widthID').offsetWidth + 'px'; 
```

如果它是我的网站，我实际上会将#1 和#2 结合起来，以便让它对于那些没有 javascript 的人来说至少看起来不错。也就是说，您将静态宽度设置为不会太远的溢出内容，然后允许 javascript 覆盖它（如果可以）。

# c# - 从 perl 到 .net 的 AES 和 SHA1

> ID：11509938
> 
> 赞同：0
> 
> 时间：2012-07-16T18:03:03.400
> 
> 标签：c#, .net, perl, aes

我正用头撞墙。

我有以下 Perl 代码，我试图在 .NET 中执行此操作但没有成功：

```
 my $cipher = Crypt::CBC->new(
            -iv => $iv,
            -literal_key => 1,
            -key => $key,
            -cipher => "Crypt::OpenSSL::AES",
            -blocksize => length($iv),
            -keysize => length($key),
            -header => "none"
            ); 
```

我的 .net 代码是：

```
byte[] iv = new byte[] { 0x01,..... };
byte[] key = new byte[] { 0x01..... };

            RijndaelManaged aes = new RijndaelManaged();
            aes.Key = key;
            aes.IV = iv;

encryptStringToBytes_AES("bla bla bla", aes.KEY, aes.IV)

...
static byte[] encryptStringToBytes_AES(string plainText, byte[] Key, byte[] IV)
        {
            // Check arguments.
            if (plainText == null || plainText.Length <= 0)
                throw new ArgumentNullException("plainText");
            if (Key == null || Key.Length <= 0)
                throw new ArgumentNullException("Key");
            if (IV == null || IV.Length <= 0)
                throw new ArgumentNullException("Key");

            // Declare the stream used to encrypt to an in memory
            // array of bytes.
            MemoryStream msEncrypt = null;

            // Declare the RijndaelManaged object
            // used to encrypt the data.
            RijndaelManaged aesAlg = null;

            try
            {
                // Create a RijndaelManaged object
                // with the specified key and IV.
                aesAlg = new RijndaelManaged();
                aesAlg.Key = Key;
                aesAlg.IV = IV;

                // Create a decrytor to perform the stream transform.
                ICryptoTransform encryptor = aesAlg.CreateEncryptor(aesAlg.Key, aesAlg.IV);

                // Create the streams used for encryption.
                msEncrypt = new MemoryStream();
                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                {
                    using (StreamWriter swEncrypt = new StreamWriter(csEncrypt))
                    {

                        //Write all data to the stream.
                        swEncrypt.Write(plainText);
                    }
                }

            }
            finally
            {
                // Clear the RijndaelManaged object.
                if (aesAlg != null)
                    aesAlg.Clear();
            }

            // Return the encrypted bytes from the memory stream.
            return msEncrypt.ToArray();

        } 
```

我究竟做错了什么？？？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:15:49.023

试试这个：

```
UnicodeEncoding UE = new UnicodeEncoding();
byte[] bfr;
byte[] pwdBits = UE.GetBytes(plainText);
byte[] result;

int extends = (1 + (pwdBits.Length / 16)) * 16;
bfr = new byte[extends];

pwdBits.CopyTo(bfr, 0);

using (MemoryStream msCrypt = new MemoryStream())
{
    RijndaelManaged RMCrypto = new RijndaelManaged();
    RMCrypto.Padding = PaddingMode.PKCS7;
    using (ICryptoTransform encriptor = RMCrypto.CreateEncryptor(Key, IV))
    {
         using (CryptoStream cs = new CryptoStream(msCrypt, encriptor, CryptoStreamMode.Write))
         {
              cs.Write(bfr, 0, bfr.Length);
              cs.FlushFinalBlock();
              result = msCrypt.ToArray();
              cs.Close();
         }
         msCrypt.Close();
    }
}
return result; 
```

# php - 没有域的 URL 重写

> ID：11509941
> 
> 赞同：0
> 
> 时间：2012-07-16T18:03:21.157
> 
> 标签：php, mod-rewrite, url-rewriting

我有两个 .htaccess 文件。1 在基本目录 (public_html) 中，另一个在 public_html/application

**public_html/.htaccess**

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule . - [L]
    RewriteRule ^$   application/    [L]
    RewriteRule (.+) application/$1  [L]
</IfModule> 
```

**public_html/application/.htaccess**

```
<IfModule mod_rewrite.c>                                                                                  
    RewriteEngine on                                                                                  
    RewriteCond %{REQUEST_FILENAME} !-f                                                               
    RewriteCond %{REQUEST_FILENAME} !-d                                                               
    RewriteRule ^(.*)$ index.php?url=$1 [PT,L]                                                        
</IfModule> 
```

现在，当它位于[http://domain.com](http://domain.com)时，它可以完美运行，但是当我在开发文件夹中工作并通过[http://domain.com/~user/](http://domain.com/~user/)访问它时它不会- 页面以 404 结束。

我的假设是它必须是波浪号用户名 url 将其丢弃。有什么想法吗？

# java - 转换 ArrayList 进入多维列表

> ID：11509946
> 
> 赞同：-2
> 
> 时间：2012-07-16T18:03:48.950
> 
> 标签：java

我有一个 HashMap 元素的 ArrayList，其格式为类别、活动和时间。IE

```
{CATEGORY=Planning, ACTIVITY=Bills, TIME=5}
{CATEGORY=Planning, ACTIVITY=Bills, TIME=7}
{CATEGORY=Planning, ACTIVITY=Meetings, TIME=10}
{CATEGORY=Resources, ACTIVITY=Room1, TIME=15}
.... 
```

*记下重复的 CATEGORY/ACTIVITY 对，因为这可能在列表中发生*

我需要能够将此列表转换为多维列表。对于这个列表的外观，我能想到的最好方法是编写一些伪代码……请在帖子底部查看。

我已经想到了几种不同的方法来实现这一点，但坦率地说，我对如何做到这一点感到困惑和沮丧。我曾考虑过在外部和内部循环中多次循环 ArrayList 的低效方法，但我知道这不是一个好的编码实践。

关于如何实现这种转换的任何建议，以便我可以像下面的伪代码一样循环？

```
For CATEGORY in CATEGORIES {
    CategoryTime = 0
    Display Category Header
    For ACTIVITY in ACTIVITIES {
        Activity Time = 0
        For TIME_RECORD in ACTIVITY
            Add time to activity total time, category total time & grand total
        }
        Display Activity Total
    }
    Display Category Total
}
Display Grand Total and rest of information... 
```

**编辑** 我感谢针对此问题提供的所有反馈，看来最好的方法是增强 HashMap 元素的 ArrayList 所属的类。

我已经投票结束这个问题，因为它太本地化了。如果你们中的一些其他开发人员能效仿以结束这个问题，我将不胜感激。我会删除它，但我现在不能，因为有问题的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:14:53.593

我会写一个看起来像这样的类：

```
public class Planner  
{    
   Map<Category, Collection<Planner>  details;  
   String activity;  
   long time;  

}  

public enum Category  
{  
    PLANNING,RESOURCES,ETC;  
} 
```

然后您应该能够执行以下操作：

```
for(Category current: Planner.getDetails().keySet())  
{  
    CategoryTime = 0  
    Display Category Header
    Activity Time = 0
    for(Planner currentPlanner : planner.getDetails().get(current))  
    {  
          currentPlanner.getActivity();  
          Activity Time += currentPlanner.getTime();
    }  
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:19:18.403

使用 Collections API 时会遇到的问题，除了糟糕的抽象之外，还必须`Activities`为给定的`Category`. 如果`Category`是 键，那么您将被迫将 a`List<Activity>`作为`Map`. 如果您查询给定的`Category`，您的工作还没有完成：您必须遍历`List<Activity>`才能找到您想要的。你怎么知道？

这不是`Map`; 这是一张多地图。

我同意推荐课程的人。它要好得多，而且工作量也不大。更好的抽象和更多的信息隐藏通常对您和您的客户更好。

```
public class Activity {
    private Category category;
    private Duration duration; // You want to encapsulate value and units together, right?
    // I can see sequencing information that could be useful.  Your whole Planner seems to be in need of work.
} 
```

I think your idea of time units is poorly done, too. I can't tell if TIME=10 means 10 hours, days, weeks, months, years, decades - you get the point. Units matter a lot, especially in this context. You would not want people to add times together that used different units.

# mysql - 如何优化 SQLAlchemy 生成的这个查询？

> ID：11509947
> 
> 赞同：8
> 
> 时间：2012-07-16T18:03:58.350
> 
> 标签：mysql, sql, orm, sqlalchemy

我有一个由 SQLAlchemy ORM 生成的查询。它应该检索特定课程的 stream_items，以及它们的所有部分——资源、内容文本块等，以及发布它们的用户。然而，这个查询似乎非常慢，在我们的生产数据库上花费几分钟，数据库中有大约 20,000 个用户，课程有 25 个左右的 stream_items，每个 stream_item 有几个内容文本块。请注意，数据库中除了用户之外几乎没有任何其他记录，因为我们导入了一堆用户但内容很少。

编辑：请注意，每个对象 id 都是 franklin_object 表的外键。

我试过查看查询，并确定了几个令人不安的位（查看 EXPLAIN 输出）

1.  其中一项查找是“使用临时的；使用文件排序'。
2.  用户表被命中两次，没有索引
3.  内容文本块表被命中两次，没有索引

但是，我真的不知道该怎么办，尤其是后两个问题。

这是查询：

```
SELECT stream_item.id                               AS stream_item_id,
       franklin_object.id                           AS franklin_object_id,
       franklin_object.type                         AS franklin_object_type,
       franklin_object.uuid                         AS franklin_object_uuid,
       stream_item.parent_id                        AS stream_item_parent_id,
       stream_item.shown_at                         AS stream_item_shown_at,
       stream_item.author_id                        AS stream_item_author_id,
       stream_item.stream_sort_at                   AS stream_item_stream_sort_at,
       stream_item.PUBLIC                           AS stream_item_public,
       stream_item.created_at                       AS stream_item_created_at,
       stream_item.updated_at                       AS stream_item_updated_at,
       anon_1.content_text_block_text               AS anon_1_content_text_block_text,
       anon_2.resource_id                           AS anon_2_resource_id,
       anon_2.franklin_object_id                    AS anon_2_franklin_object_id,
       anon_2.franklin_object_type                  AS anon_2_franklin_object_type,
       anon_2.franklin_object_uuid                  AS anon_2_franklin_object_uuid,
       anon_2.resource_top_parent_resource          AS anon_2_resource_top_parent_resource,
       anon_2.resource_top_parent_id                AS anon_2_resource_top_parent_id,
       anon_2.resource_title                        AS anon_2_resource_title,
       anon_2.resource_url                          AS anon_2_resource_url,
       anon_2.resource_image                        AS anon_2_resource_image,
       anon_2.resource_created_at                   AS anon_2_resource_created_at,
       anon_2.resource_updated_at                   AS anon_2_resource_updated_at,
       franklin_object_1.id                         AS franklin_object_1_id,
       franklin_object_1.type                       AS franklin_object_1_type,
       franklin_object_1.uuid                       AS franklin_object_1_uuid,
       anon_1.content_text_block_id                 AS anon_1_content_text_block_id,
       anon_1.franklin_object_id                    AS anon_1_franklin_object_id,
       anon_1.franklin_object_type                  AS anon_1_franklin_object_type,
       anon_1.franklin_object_uuid                  AS anon_1_franklin_object_uuid,
       anon_1.content_text_block_position           AS anon_1_content_text_block_position,
       anon_1.content_text_block_franklin_object_id AS anon_1_content_text_block_franklin_object_id,
       anon_1.content_text_block_created_at         AS anon_1_content_text_block_created_at,
       anon_1.content_text_block_updated_at         AS anon_1_content_text_block_updated_at,
       anon_3.user_password                         AS anon_3_user_password,
       anon_3.user_auth_token                       AS anon_3_user_auth_token,
       anon_3.user_id                               AS anon_3_user_id,
       anon_3.franklin_object_id                    AS anon_3_franklin_object_id,
       anon_3.franklin_object_type                  AS anon_3_franklin_object_type,
       anon_3.franklin_object_uuid                  AS anon_3_franklin_object_uuid,
       anon_3.user_email                            AS anon_3_user_email,
       anon_3.user_auth_token_expiration            AS anon_3_user_auth_token_expiration,
       anon_3.user_active                           AS anon_3_user_active,
       anon_3.user_activation_token                 AS anon_3_user_activation_token,
       anon_3.user_first_name                       AS anon_3_user_first_name,
       anon_3.user_last_name                        AS anon_3_user_last_name,
       anon_3.user_image                            AS anon_3_user_image,
       anon_3.user_bio                              AS anon_3_user_bio,
       anon_3.user_aspirations                      AS anon_3_user_aspirations,
       anon_3.user_website                          AS anon_3_user_website,
       anon_3.user_resume                           AS anon_3_user_resume,
       anon_3.user_resume_name                      AS anon_3_user_resume_name,
       anon_3.user_primary_role                     AS anon_3_user_primary_role,
       anon_3.user_institution_id                   AS anon_3_user_institution_id,
       anon_3.user_birth_date                       AS anon_3_user_birth_date,
       anon_3.user_gender                           AS anon_3_user_gender,
       anon_3.user_graduation_year                  AS anon_3_user_graduation_year,
       anon_3.user_complete                         AS anon_3_user_complete,
       anon_3.user_masthead_y_position              AS anon_3_user_masthead_y_position,
       anon_3.user_masthead                         AS anon_3_user_masthead,
       anon_3.user_fb_access_token                  AS anon_3_user_fb_access_token,
       anon_3.user_fb_user_id                       AS anon_3_user_fb_user_id,
       anon_3.user_location                         AS anon_3_user_location,
       anon_3.user_created_at                       AS anon_3_user_created_at,
       anon_3.user_updated_at                       AS anon_3_user_updated_at,
       anon_4.content_text_block_text               AS anon_4_content_text_block_text,
       anon_4.content_text_block_id                 AS anon_4_content_text_block_id,
       anon_4.franklin_object_id                    AS anon_4_franklin_object_id,
       anon_4.franklin_object_type                  AS anon_4_franklin_object_type,
       anon_4.franklin_object_uuid                  AS anon_4_franklin_object_uuid,
       anon_4.content_text_block_position           AS anon_4_content_text_block_position,
       anon_4.content_text_block_franklin_object_id AS anon_4_content_text_block_franklin_object_id,
       anon_4.content_text_block_created_at         AS anon_4_content_text_block_created_at,
       anon_4.content_text_block_updated_at         AS anon_4_content_text_block_updated_at,
       anon_5.user_password                         AS anon_5_user_password,
       anon_5.user_auth_token                       AS anon_5_user_auth_token,
       anon_5.user_id                               AS anon_5_user_id,
       anon_5.franklin_object_id                    AS anon_5_franklin_object_id,
       anon_5.franklin_object_type                  AS anon_5_franklin_object_type,
       anon_5.franklin_object_uuid                  AS anon_5_franklin_object_uuid,
       anon_5.user_email                            AS anon_5_user_email,
       anon_5.user_auth_token_expiration            AS anon_5_user_auth_token_expiration,
       anon_5.user_active                           AS anon_5_user_active,
       anon_5.user_activation_token                 AS anon_5_user_activation_token,
       anon_5.user_first_name                       AS anon_5_user_first_name,
       anon_5.user_last_name                        AS anon_5_user_last_name,
       anon_5.user_image                            AS anon_5_user_image,
       anon_5.user_bio                              AS anon_5_user_bio,
       anon_5.user_aspirations                      AS anon_5_user_aspirations,
       anon_5.user_website                          AS anon_5_user_website,
       anon_5.user_resume                           AS anon_5_user_resume,
       anon_5.user_resume_name                      AS anon_5_user_resume_name,
       anon_5.user_primary_role                     AS anon_5_user_primary_role,
       anon_5.user_institution_id                   AS anon_5_user_institution_id,
       anon_5.user_birth_date                       AS anon_5_user_birth_date,
       anon_5.user_gender                           AS anon_5_user_gender,
       anon_5.user_graduation_year                  AS anon_5_user_graduation_year,
       anon_5.user_complete                         AS anon_5_user_complete,
       anon_5.user_masthead_y_position              AS anon_5_user_masthead_y_position,
       anon_5.user_masthead                         AS anon_5_user_masthead,
       anon_5.user_fb_access_token                  AS anon_5_user_fb_access_token,
       anon_5.user_fb_user_id                       AS anon_5_user_fb_user_id,
       anon_5.user_location                         AS anon_5_user_location,
       anon_5.user_created_at                       AS anon_5_user_created_at,
       anon_5.user_updated_at                       AS anon_5_user_updated_at,
       anon_6.stream_item_id                        AS anon_6_stream_item_id,
       anon_6.franklin_object_id                    AS anon_6_franklin_object_id,
       anon_6.franklin_object_type                  AS anon_6_franklin_object_type,
       anon_6.franklin_object_uuid                  AS anon_6_franklin_object_uuid,
       anon_6.stream_item_parent_id                 AS anon_6_stream_item_parent_id,
       anon_6.stream_item_shown_at                  AS anon_6_stream_item_shown_at,
       anon_6.stream_item_author_id                 AS anon_6_stream_item_author_id,
       anon_6.stream_item_stream_sort_at            AS anon_6_stream_item_stream_sort_at,
       anon_6.stream_item_public                    AS anon_6_stream_item_public,
       anon_6.stream_item_created_at                AS anon_6_stream_item_created_at,
       anon_6.stream_item_updated_at                AS anon_6_stream_item_updated_at
FROM   franklin_object
       INNER JOIN stream_item
               ON franklin_object.id = stream_item.id
       INNER JOIN (SELECT franklin_object.id                    AS franklin_object_id,
                          franklin_object.type                  AS franklin_object_type,
                          franklin_object.uuid                  AS franklin_object_uuid,
                          content_text_block.id                 AS content_text_block_id,
                          content_text_block.text               AS content_text_block_text,
                          content_text_block.position           AS content_text_block_position,
                          content_text_block.franklin_object_id AS content_text_block_franklin_object_id,
                          content_text_block.created_at         AS content_text_block_created_at,
                          content_text_block.updated_at         AS content_text_block_updated_at
                   FROM   franklin_object
                          INNER JOIN content_text_block
                                  ON franklin_object.id = content_text_block.id) AS anon_1
               ON stream_item.id = anon_1.content_text_block_franklin_object_id
       LEFT OUTER JOIN contents_resources AS contents_resources_1
                    ON anon_1.content_text_block_id = contents_resources_1.content_id
       LEFT OUTER JOIN (SELECT franklin_object.id           AS franklin_object_id,
                               franklin_object.type         AS franklin_object_type,
                               franklin_object.uuid         AS franklin_object_uuid,
                               resource.id                  AS resource_id,
                               resource.top_parent_resource AS resource_top_parent_resource,
                               resource.top_parent_id       AS resource_top_parent_id,
                               resource.title               AS resource_title,
                               resource.url                 AS resource_url,
                               resource.image               AS resource_image,
                               resource.created_at          AS resource_created_at,
                               resource.updated_at          AS resource_updated_at
                        FROM   franklin_object
                               INNER JOIN resource
                                       ON franklin_object.id = resource.id) AS anon_2
                    ON anon_2.resource_id = contents_resources_1.resource_id
       LEFT OUTER JOIN contents_franklin_objects AS contents_franklin_objects_1
                    ON anon_1.content_text_block_id = contents_franklin_objects_1.content_id
       LEFT OUTER JOIN franklin_object AS franklin_object_1
                    ON franklin_object_1.id = contents_franklin_objects_1.franklin_object_id
       LEFT OUTER JOIN likers AS likers_1
                    ON stream_item.id = likers_1.post_id
       LEFT OUTER JOIN (SELECT franklin_object.id         AS franklin_object_id,
                               franklin_object.type       AS franklin_object_type,
                               franklin_object.uuid       AS franklin_object_uuid,
                               USER.id                    AS user_id,
                               USER.email                 AS user_email,
                               USER.password              AS user_password,
                               USER.auth_token            AS user_auth_token,
                               USER.auth_token_expiration AS user_auth_token_expiration,
                               USER.active                AS user_active,
                               USER.activation_token      AS user_activation_token,
                               USER.first_name            AS user_first_name,
                               USER.last_name             AS user_last_name,
                               USER.image                 AS user_image,
                               USER.bio                   AS user_bio,
                               USER.aspirations           AS user_aspirations,
                               USER.website               AS user_website,
                               USER.resume                AS user_resume,
                               USER.resume_name           AS user_resume_name,
                               USER.primary_role          AS user_primary_role,
                               USER.institution_id        AS user_institution_id,
                               USER.birth_date            AS user_birth_date,
                               USER.gender                AS user_gender,
                               USER.graduation_year       AS user_graduation_year,
                               USER.complete              AS user_complete,
                               USER.masthead_y_position   AS user_masthead_y_position,
                               USER.masthead              AS user_masthead,
                               USER.fb_access_token       AS user_fb_access_token,
                               USER.fb_user_id            AS user_fb_user_id,
                               USER.location              AS user_location,
                               USER.created_at            AS user_created_at,
                               USER.updated_at            AS user_updated_at
                        FROM   franklin_object
                               INNER JOIN USER
                                       ON franklin_object.id = USER.id) AS anon_3
                    ON anon_3.user_id = likers_1.user_id
       LEFT OUTER JOIN contents_franklin_objects AS contents_franklin_objects_2
                    ON franklin_object.id = contents_franklin_objects_2.franklin_object_id
       LEFT OUTER JOIN (SELECT franklin_object.id                    AS franklin_object_id,
                               franklin_object.type                  AS franklin_object_type,
                               franklin_object.uuid                  AS franklin_object_uuid,
                               content_text_block.id                 AS content_text_block_id,
                               content_text_block.text               AS content_text_block_text,
                               content_text_block.position           AS content_text_block_position,
                               content_text_block.franklin_object_id AS content_text_block_franklin_object_id,
                               content_text_block.created_at         AS content_text_block_created_at,
                               content_text_block.updated_at         AS content_text_block_updated_at
                        FROM   franklin_object
                               INNER JOIN content_text_block
                                       ON franklin_object.id = content_text_block.id) AS anon_4
                    ON anon_4.content_text_block_id = contents_franklin_objects_2.content_id
       LEFT OUTER JOIN (SELECT franklin_object.id         AS franklin_object_id,
                               franklin_object.type       AS franklin_object_type,
                               franklin_object.uuid       AS franklin_object_uuid,
                               stream_item.id             AS stream_item_id,
                               stream_item.parent_id      AS stream_item_parent_id,
                               stream_item.shown_at       AS stream_item_shown_at,
                               stream_item.author_id      AS stream_item_author_id,
                               stream_item.stream_sort_at AS stream_item_stream_sort_at,
                               stream_item.PUBLIC         AS stream_item_public,
                               stream_item.created_at     AS stream_item_created_at,
                               stream_item.updated_at     AS stream_item_updated_at
                        FROM   franklin_object
                               INNER JOIN stream_item
                                       ON franklin_object.id = stream_item.id) AS anon_6
                    ON anon_6.stream_item_parent_id = franklin_object.id
       LEFT OUTER JOIN likers AS likers_2
                    ON anon_6.stream_item_id = likers_2.post_id
       LEFT OUTER JOIN (SELECT franklin_object.id         AS franklin_object_id,
                               franklin_object.type       AS franklin_object_type,
                               franklin_object.uuid       AS franklin_object_uuid,
                               USER.id                    AS user_id,
                               USER.email                 AS user_email,
                               USER.password              AS user_password,
                               USER.auth_token            AS user_auth_token,
                               USER.auth_token_expiration AS user_auth_token_expiration,
                               USER.active                AS user_active,
                               USER.activation_token      AS user_activation_token,
                               USER.first_name            AS user_first_name,
                               USER.last_name             AS user_last_name,
                               USER.image                 AS user_image,
                               USER.bio                   AS user_bio,
                               USER.aspirations           AS user_aspirations,
                               USER.website               AS user_website,
                               USER.resume                AS user_resume,
                               USER.resume_name           AS user_resume_name,
                               USER.primary_role          AS user_primary_role,
                               USER.institution_id        AS user_institution_id,
                               USER.birth_date            AS user_birth_date,
                               USER.gender                AS user_gender,
                               USER.graduation_year       AS user_graduation_year,
                               USER.complete              AS user_complete,
                               USER.masthead_y_position   AS user_masthead_y_position,
                               USER.masthead              AS user_masthead,
                               USER.fb_access_token       AS user_fb_access_token,
                               USER.fb_user_id            AS user_fb_user_id,
                               USER.location              AS user_location,
                               USER.created_at            AS user_created_at,
                               USER.updated_at            AS user_updated_at
                        FROM   franklin_object
                               INNER JOIN USER
                                       ON franklin_object.id = USER.id) AS anon_5
                    ON anon_5.user_id = likers_2.user_id
WHERE  stream_item.parent_id = 11
ORDER  BY stream_item.stream_sort_at DESC,
          anon_1.content_text_block_position,
          anon_6.stream_item_stream_sort_at DESC 
```

和解释输出：

```
ID   SELECT_TYPE   TABLE    POSSIBLY_KEYS KEY KEY_LEN REF ROWS EXTRA
1   PRIMARY <derived2>  ALL NULL    NULL    NULL    NULL    599 Using     temporary; Using filesort
1   PRIMARY stream_item eq_ref  PRIMARY,parent_id   PRIMARY 4   anon_1.content_text_block_franklin_object_id    1   Using where
1   PRIMARY contents_resources_1    ref content_id  content_id  5    anon_1.content_text_block_id   2   
1   PRIMARY <derived3>  ALL NULL    NULL    NULL    NULL    7   
1   PRIMARY contents_franklin_objects_1 ref content_id  content_id  5   anon_1.content_text_block_id    1   
1   PRIMARY franklin_object eq_ref  PRIMARY PRIMARY 4   franklin.stream_item.id 1   Using where
1   PRIMARY franklin_object_1   eq_ref  PRIMARY PRIMARY 4   franklin.contents_franklin_objects_1.franklin_object_id 1   
1   PRIMARY likers_1    ref post_id post_id 5   franklin.stream_item.id 1
1   PRIMARY <derived4>  ALL NULL    NULL    NULL    NULL    136 
1   PRIMARY contents_franklin_objects_2 ref franklin_object_id  franklin_object_id  5   franklin.stream_item.id 1   
1   PRIMARY <derived5>  ALL NULL    NULL    NULL    NULL    599 
1   PRIMARY <derived6>  ALL NULL    NULL    NULL    NULL    608 
1   PRIMARY likers_2    ref post_id post_id 5   anon_6.stream_item_id   1   
1   PRIMARY <derived7>  ALL NULL    NULL    NULL    NULL    136 
7   DERIVED user    ALL PRIMARY NULL    NULL    NULL    133 
7   DERIVED franklin_object eq_ref  PRIMARY PRIMARY 4   franklin.user.id    1   
6   DERIVED stream_item ALL PRIMARY NULL    NULL    NULL    709 
6   DERIVED franklin_object eq_ref  PRIMARY PRIMARY 4   franklin.stream_item.id 1   
5   DERIVED content_text_block  ALL PRIMARY NULL    NULL    NULL    666 
5   DERIVED franklin_object eq_ref  PRIMARY PRIMARY 4   franklin.content_text_block.id        1 
4   DERIVED user    ALL PRIMARY NULL    NULL    NULL    133 
4   DERIVED franklin_object eq_ref  PRIMARY PRIMARY 4   franklin.user.id    1   
3   DERIVED resource    ALL PRIMARY NULL    NULL    NULL    7   
3   DERIVED franklin_object eq_ref  PRIMARY PRIMARY 4   franklin.resource.id    1   
2   DERIVED content_text_block  ALL PRIMARY NULL    NULL    NULL    666 
2   DERIVED franklin_object eq_ref  PRIMARY PRIMARY 4   franklin.content_text_block.id  1 
```

如何更快地减少所有查询？还有什么其他方法可以加快速度？

franklin_objects 的设置方式是反模式吗？它的工作方式是 franklin_object 表有两列：id 和 type。然后每个类型都是一个表，主键是 franklin_object 的外键。

生成 sql 的代码类似于：

`stream_item_query = StreamItem.query.options(db.joinedload('stream_items'),db.joinedload('contents_included_in'),db.joinedload('contents.resources'),db.joinedload('contents.objects'),db.subqueryload('likers'))`

`stream_items = stream_item_query.filter(StreamItem.parent_id == community_id).order_by(db.desc(StreamItem.stream_sort_at)).all()`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-20T18:56:31.510

哇，这个有点伤脑筋。试图弄清楚查询在做什么，所有的表是什么，以及关系是乏味的。如果您有类似的经历，请首先提示您可能在这个单一查询中尝试做太多事情。

我的建议是重新考虑你的整个方法。

SQLAlchemy 是一个非常好的工具，我不会抨击它（或您选择的 mysql），但与大多数 ORM 工具一样，您需要考虑使用它们的成本。一个例子是这种`franklin_object`餐桌业务。这是反模式吗？是和否。从纯粹的面向对象的角度来看，这是有道理的。您可以通过在此表中查找来确定要查询哪些`id`表。从关系查询的角度来看，它的用途很小。我可以从您的查询中删除每个实例，`franklin_object`并且除了...中的列之外什么也不会丢失`franklin_object`。如果这是一个可行的选择，我会立即这样做。

让我们进一步研究这种联系`franklin_object`。查看子查询，它们都具有相同的形式：

```
 SELECT franklin_object.id           AS franklin_object_id,
         franklin_object.type         AS franklin_object_type,
         franklin_object.uuid         AS franklin_object_uuid,
         linked_table.id              AS linked_table_id,
         linked_table.col2            AS col2 --and more
  FROM   franklin_object
  INNER JOIN linked_table
         ON franklin_object.id = linked_table.id) AS anon_n 
```

关于如何优化这部分查询，无论统计信息如何，数据库都没有太多信息可以继续。也许如果通过在子句中`franklin_object`指定限制，查询会更好。也许。`type``where`

这对于 USER 表尤其成问题，因为该表有很多记录（如您所说）。由于您正在查询大部分列，并且优化器无法准确计算将检索多少行，因此执行全表扫描是有意义的。在你的情况下，两次。

另一个方面是所涉及的连接的绝对数量。如果我们取出所有`franklin_object`引用，仍然有 11 个连接。如果您的数据模型更具相关性，那并不可怕，但事实并非如此。生成的查询对数据库找出执行查询的最佳方式没有多大帮助，因此它做得不好。也许你可以通过提示等来缓解这种情况，但我敢打赌，从长远来看，这会咬你一口。

您正在使用 ORM 工具，所以请*真正使用*它。通过一次完成如此大的查询，您不会获得任何好处。为了性能，它可以分开一点。执行惰性检索以避免庞大、复杂的查询。我会说尝试，只是为了看看进展如何，懒洋洋地做每一件事。性能可能会好，我会说更好。不太好，甚至可能无法接受，但比在数据库翻腾时喝咖啡要好。

然后，开始将事物拼凑成更流线型的块。将逻辑上有意义的对象联系在一起，例如`resource`和`contents_resources`。`stream_item`另一个例子，`likers`和之间的连接`user`是重复的。做一个查询，让 SQLAlchemy 做它的事。

作为最后的手段，可以实现某种缓存机制。也许在某处非规范化表格。在一个变化缓慢、读取量大的系统上，您可以将这些表输入到另一个结构中，在该结构中查询是直接且快速的。也就是说，预先进行处理并将其存储在一个表中。

祝你好运

# c++ - 在另一个类中创建一个类的对象时链接错误

> ID：11509948
> 
> 赞同：0
> 
> 时间：2012-07-16T18:04:13.630
> 
> 标签：c++, class, linker, embedding

我一直在尝试从 HEVC 参考解码器中创建一个 DLL 并集成到我的应用程序中，但我遇到了无法解决的链接错误我尝试添加项目依赖项/引用。我附上了下面的代码片段。我不断收到以下链接错误。

```
HEVCDecoderDXVA.lib(HEVCRefDecImp.obj) : error LNK2019: unresolved external symbol "public: __thiscall TAppDecTop::TAppDecTop(void)" (??0TAppDecTop@@QAE@XZ) referenced in function "public: __thiscall CHEVC::CHEVC(void)" (??0CHEVC@@QAE@XZ)
TLibDecoder.lib(TDecGop.obj) : error LNK2001: unresolved external symbol "bool g_md5_mismatch" (?g_md5_mismatch@@3_NA)
C:\HEVCDecoder3\build\Debug\HEVCDecoderDLL.dll : fatal error LNK1120: 2 unresolved externals 
```

我想要做的是让解码器实例作为我的 CHEVC 类中的成员变量

```
TAppDecTop m_RefDecoder; 
```

上面这行是导致 line 的问题，unresolved external symbol "bool g_md5_mismatch" 错误也是由于这行，

在 LibraryAPI.h 中

```
#ifndef _LIBRARY_API_H_
#define _LIBRARY_API_H_

namespace NSF
{

    class CAPI
    {
    public:
        virtual ~CAPI() { }
    };

}

#endif // _LIBRARY_API_H_ 
```

在 AppDecInf.h

```
#ifndef REF_DEC_INF_H
#define REF_DEC_INF_H

#include "LibraryAPI.h"

namespace NAppDecoderAPI
{

    class AppDecInf : public NSF::CAPI
    {
    public:
        virtual ~AppDecInf()
        {

        }

        virtual int InitRefDecoder(char *fileName)=0;
        virtual int TerminateRefDecoder()=0;
        virtual int DecodeFrame()=0;

    };

} 
```

在 HEVCRefDecImp.h

```
#ifndef HEVC_REF_DEC_INF_H
#define HEVC_REF_DEC_INF_H

#include "AppDecInf.h"
#include "TAppDecTop.h"

class CHEVC : public  NAppDecoderAPI::AppDecInf 
{
public:
    CHEVC();
    virtual ~CHEVC();

    int InitRefDecoder(char *fileName);
    int TerminateRefDecoder();
    int DecodeFrame();

private:
    bool temp;
    TAppDecTop m_RefDecoder;
};

#endif  //HEVC_REF_DEC_INF_H 
```

在 HEVCRefDecImp.cpp

```
#include"HEVCRefDecImp.h"

CHEVC::CHEVC()
{
    temp = false;
}

CHEVC::~CHEVC()
{

}

int CHEVC::InitRefDecoder(char* fileName)
{
    m_RefDecoder.create();
    return(0);

}

int CHEVC::DecodeFrame()
{
    m_RefDecoder.decode();
    return(0);

}

int CHEVC::TerminateRefDecoder()
{
    m_RefDecoder.destroy();
    return(0);
} 
```

在 TAppDecTop.h 中

```
#ifndef __TAPPDECTOP__
#define __TAPPDECTOP__

#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

#include "TLibVideoIO/TVideoIOYuv.h"
#include "TLibCommon/TComList.h"
#include "TLibCommon/TComPicYuv.h"
#include "TLibDecoder/TDecTop.h"
#include "TAppDecCfg.h"

//! \ingroup TAppDecoder
//! \{

// ====================================================================================================================
// Class definition
// ====================================================================================================================

/// decoder application class
class TAppDecTop : public TAppDecCfg
{
private:
  // class interface
  TDecTop                         m_cTDecTop;                     ///< decoder class
  TVideoIOYuv                     m_cTVideoIOYuvReconFile;        ///< reconstruction YUV class

  // for output control
  Bool                            m_abDecFlag[ MAX_GOP ];         ///< decoded flag in one GOP
  Int                             m_iPOCLastDisplay;              ///< last POC in display order

public:
  TAppDecTop();
  virtual ~TAppDecTop() {}

  Void  create            (); ///< create internal members
  Void  destroy           (); ///< destroy internal members
  Void  decode            (); ///< main decoding function

protected:
  Void  xCreateDecLib     (); ///< create internal classes
  Void  xDestroyDecLib    (); ///< destroy internal classes
  Void  xInitDecLib       (); ///< initialize decoder class

  Void  xWriteOutput      ( TComList<TComPic*>* pcListPic , UInt tId); ///< write YUV to file
  Void  xFlushOutput      ( TComList<TComPic*>* pcListPic ); ///< flush all remaining decoded pictures to file
};

//! \}

#endif 
```

在 TAppDecTop.cpp 中

```
#include <list>
#include <vector>
#include <stdio.h>
#include <fcntl.h>
#include <assert.h>

#include "TAppDecTop.h"
#include "TLibDecoder/AnnexBread.h"
#include "TLibDecoder/NALread.h"

//! \ingroup TAppDecoder
//! \{

// ====================================================================================================================
// Constructor / destructor / initialization / destroy
// ====================================================================================================================

TAppDecTop::TAppDecTop()
{
  ::memset (m_abDecFlag, 0, sizeof (m_abDecFlag));
  m_iPOCLastDisplay  = -MAX_INT;
}

Void TAppDecTop::create()
{
}

Void TAppDecTop::destroy()
{
}

// ====================================================================================================================
// Public member functions
// ====================================================================================================================

/**
 - create internal class
 - initialize internal class
 - until the end of the bitstream, call decoding function in TDecTop class
 - delete allocated buffers
 - destroy internal class
 .
 */
Void TAppDecTop::decode()
{
  UInt                uiPOC;
  TComList<TComPic*>* pcListPic = NULL;

  ifstream bitstreamFile(m_pchBitstreamFile, ifstream::in | ifstream::binary);
  if (!bitstreamFile)
  {
    fprintf(stderr, "\nfailed to open bitstream file `%s' for reading\n", m_pchBitstreamFile);
    exit(EXIT_FAILURE);
  }

  InputByteStream bytestream(bitstreamFile);

  // create & initialize internal classes
  xCreateDecLib();
  xInitDecLib  ();
  m_iPOCLastDisplay += m_iSkipFrame;      // set the last displayed POC correctly for skip forward.

  // main decoder loop
  bool recon_opened = false; // reconstruction file not yet opened. (must be performed after SPS is seen)

  while (!!bitstreamFile)
  {
    /* location serves to work around a design fault in the decoder, whereby
     * the process of reading a new slice that is the first slice of a new frame
     * requires the TDecTop::decode() method to be called again with the same
     * nal unit. */
    streampos location = bitstreamFile.tellg();
    AnnexBStats stats = AnnexBStats();
    bool bPreviousPictureDecoded = false;

    vector<uint8_t> nalUnit;
    InputNALUnit nalu;
    byteStreamNALUnit(bytestream, nalUnit, stats);

    // call actual decoding function
    bool bNewPicture = false;
    if (nalUnit.empty())
    {
      /* this can happen if the following occur:
       *  - empty input file
       *  - two back-to-back start_code_prefixes
       *  - start_code_prefix immediately followed by EOF
       */
      fprintf(stderr, "Warning: Attempt to decode an empty NAL unit\n");
    }
    else
    {
      read(nalu, nalUnit);
      if(m_iMaxTemporalLayer >= 0 && nalu.m_temporalId > m_iMaxTemporalLayer)
      {
        if(bPreviousPictureDecoded)
        {
          bNewPicture = true;
          bPreviousPictureDecoded = false;
        }
        else
        {
          bNewPicture = false;
        }
      }
      else
      {
        bNewPicture = m_cTDecTop.decode(nalu, m_iSkipFrame, m_iPOCLastDisplay);
        if (bNewPicture)
        {
          bitstreamFile.clear();
          /* location points to the current nalunit payload[1] due to the
           * need for the annexB parser to read three extra bytes.
           * [1] except for the first NAL unit in the file
           *     (but bNewPicture doesn't happen then) */
          bitstreamFile.seekg(location-streamoff(3));
          bytestream.reset();
        }
        bPreviousPictureDecoded = true; 
      }
    }
    if (bNewPicture || !bitstreamFile)
    {
      m_cTDecTop.executeDeblockAndAlf(uiPOC, pcListPic, m_iSkipFrame, m_iPOCLastDisplay);
    }

    if( pcListPic )
    {
      if ( m_pchReconFile && !recon_opened )
      {
        if ( m_outputBitDepth == 0 )
        {
          m_outputBitDepth = g_uiBitDepth + g_uiBitIncrement;
        }

        m_cTVideoIOYuvReconFile.open( m_pchReconFile, true, m_outputBitDepth, g_uiBitDepth + g_uiBitIncrement ); // write mode
        recon_opened = true;
      }
      if (bNewPicture && (nalu.m_nalUnitType == NAL_UNIT_CODED_SLICE_IDR))
      {
        xFlushOutput( pcListPic );
      }
      // write reconstruction to file
      if(bNewPicture)
      {
        xWriteOutput( pcListPic, nalu.m_temporalId );
      }
    }
  }

  xFlushOutput( pcListPic );
  // delete buffers
  m_cTDecTop.deletePicBuffer();

  // destroy internal classes
  xDestroyDecLib();
}

// ====================================================================================================================
// Protected member functions
// ====================================================================================================================

Void TAppDecTop::xCreateDecLib()
{
  // create decoder class
  m_cTDecTop.create();
}

Void TAppDecTop::xDestroyDecLib()
{
  if ( m_pchReconFile )
  {
    m_cTVideoIOYuvReconFile. close();
  }

  // destroy decoder class
  m_cTDecTop.destroy();
}

Void TAppDecTop::xInitDecLib()
{
  // initialize decoder class
  m_cTDecTop.init();
  m_cTDecTop.setPictureDigestEnabled(m_pictureDigestEnabled);
}

/** \param pcListPic list of pictures to be written to file
    \todo            DYN_REF_FREE should be revised
 */
Void TAppDecTop::xWriteOutput( TComList<TComPic*>* pcListPic, UInt tId )
{
  TComList<TComPic*>::iterator iterPic   = pcListPic->begin();
  Int not_displayed = 0;

  while (iterPic != pcListPic->end())
  {
    TComPic* pcPic = *(iterPic);
    if(pcPic->getOutputMark() && pcPic->getPOC() > m_iPOCLastDisplay)
    {
       not_displayed++;
    }
    iterPic++;
  }
  iterPic   = pcListPic->begin();

  while (iterPic != pcListPic->end())
  {
    TComPic* pcPic = *(iterPic);
    TComSPS *sps = pcPic->getSlice(0)->getSPS();

    if ( pcPic->getOutputMark() && (not_displayed >  pcPic->getSlice(0)->getSPS()->getNumReorderPics(tId) && pcPic->getPOC() > m_iPOCLastDisplay))
    {
      // write to file
       not_displayed--;
      if ( m_pchReconFile )
      {
        m_cTVideoIOYuvReconFile.write( pcPic->getPicYuvRec(), sps->getPicCropLeftOffset(), sps->getPicCropRightOffset(), sps->getPicCropTopOffset(), sps->getPicCropBottomOffset() );
      }

      // update POC of display order
      m_iPOCLastDisplay = pcPic->getPOC();

      // erase non-referenced picture in the reference picture list after display
      if ( !pcPic->getSlice(0)->isReferenced() && pcPic->getReconMark() == true )
      {
#if !DYN_REF_FREE
        pcPic->setReconMark(false);

        // mark it should be extended later
        pcPic->getPicYuvRec()->setBorderExtension( false );

#else
        pcPic->destroy();
        pcListPic->erase( iterPic );
        iterPic = pcListPic->begin(); // to the beginning, non-efficient way, have to be revised!
        continue;
#endif
      }
      pcPic->setOutputMark(false);
    }

    iterPic++;
  }
}

/** \param pcListPic list of pictures to be written to file
    \todo            DYN_REF_FREE should be revised
 */
Void TAppDecTop::xFlushOutput( TComList<TComPic*>* pcListPic )
{
  if(!pcListPic)
  {
    return;
  } 
  TComList<TComPic*>::iterator iterPic   = pcListPic->begin();

  iterPic   = pcListPic->begin();

  while (iterPic != pcListPic->end())
  {
    TComPic* pcPic = *(iterPic);
    TComSPS *sps = pcPic->getSlice(0)->getSPS();

    if ( pcPic->getOutputMark() )
    {
      // write to file
      if ( m_pchReconFile )
      {
        m_cTVideoIOYuvReconFile.write( pcPic->getPicYuvRec(), sps->getPicCropLeftOffset(), sps->getPicCropRightOffset(), sps->getPicCropTopOffset(), sps->getPicCropBottomOffset() );
      }

      // update POC of display order
      m_iPOCLastDisplay = pcPic->getPOC();

      // erase non-referenced picture in the reference picture list after display
      if ( !pcPic->getSlice(0)->isReferenced() && pcPic->getReconMark() == true )
      {
#if !DYN_REF_FREE
        pcPic->setReconMark(false);

        // mark it should be extended later
        pcPic->getPicYuvRec()->setBorderExtension( false );

#else
        pcPic->destroy();
        pcListPic->erase( iterPic );
        iterPic = pcListPic->begin(); // to the beginning, non-efficient way, have to be revised!
        continue;
#endif
      }
      pcPic->setOutputMark(false);
    }

    iterPic++;
  }
  pcListPic->clear();
  m_iPOCLastDisplay = -MAX_INT;
} 
```

# mysql - 如何使用 MySQL 中的最后更新值合并列数据？

> ID：11509950
> 
> 赞同：0
> 
> 时间：2012-07-16T18:04:18.203
> 
> 标签：mysql, sql

有点令人困惑，所以如果我放下示例和预期的输出开始，它会更容易。

我有一个看起来像这样的表：（Unit1 - Unit2 列可以以相同的通用格式跨越多达 30 列）

```
| ID | Name | Unit1_left | Unit2_left |
| 1  | Tom  |     50     |     NULL   |
| 2  | Tom  |    NULL    |      1     |
| 3  | Tom  |     45     |     NULL   |
| 4  | Dan  |    NULL    |     NULL   | 
```

我要选择的是这样的表：

```
| Name | Unit1_left | Unit2_left |
| Tom  |     45     |      1     |
| Dan  |    NULL    |     NULL   | 
```

这样做是按名称分组并尝试在其他 2 列中查找最后一个值（如果它们存在）（如果不存在则返回 NULL）。

我查看了其他各种问题，他们都说要使用`Max()`，但这不起作用，因为它选择了最高值（不正确）。我已经看到在 MsSQL 中有一个`Last()`函数看起来有点像我想要它做的，但它没有在 MySQL 中实现，也不是我需要的。

我想问的是，有没有人知道选择这样的数据的可能方法，或者我是否必须使用单独的编程语言来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:16:15.683

这将产生您描述的结果集

```
SELECT dname.name, 
       l1value.unit1_left, 
       l2value.unit2_left 
FROM   (SELECT DISTINCT `name` 
        FROM   table1) `DName` 
       LEFT JOIN (SELECT `name`, 
                         Max(id) id 
                  FROM   table1 
                  WHERE  unit1_left IS NOT NULL 
                  GROUP  BY `name`) l1 
              ON dname.`name` = l1.`name` 
       LEFT JOIN table1 l1value 
              ON l1.id = l1value.id 
       LEFT JOIN (SELECT `name`, 
                         Max(id) id 
                  FROM   table1 
                  WHERE  unit2_left IS NOT NULL 
                  GROUP  BY `name`) l2 
              ON dname.`name` = l2.`name` 
       LEFT JOIN table1 l2value 
              ON l2.id = l2value.id ; 
```

[演示](http://sqlfiddle.com/#!2/89123/24)

我通过为 unit1_left 和 unit2_left（l1 和 l2）的非空值创建 2 个内联视图来实现。然后将其加入原始表以获取值（l1value 和 l2value）。然后，我们将其连接回创建不同名称的第三个内联视图（dname）。

这很混乱，只是以更明智的方式保存数据可能更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:20:02.553

您可以在 select 语句中使用子查询。使用 SqlFidlle 我想出了[这个](http://sqlfiddle.com/#!2/e6e65/11)。

```
select o.name,
      (select o2.Unit1_left 
         from original as o2
         where o.name = o2.name
             and o2.Unit1_left is not null
         order by o2.id desc
         LIMIT 1) as Unit1_left,
      (select o3.Unit2_left 
         from original as o3
         where o.name = o3.name
             and o3.Unit2_left is not null
         order by o3.id desc
         LIMIT 1) as Unit2_left
    from original as o 
       group by o.name
       order by id; 
```

# javascript - 防止jquery浏览器在点击时滚动到顶部

> ID：11509955
> 
> 赞同：2
> 
> 时间：2012-07-16T18:04:50.030
> 
> 标签：javascript, jquery

我有以下用于缩略图查看器的脚本。我将每个缩略图图像和大型父图像分别命名为 thumb 和 large 结尾。该脚本通过更改文件路径将大图像替换为单击的任何缩略图。

```
<script>
$('.thumbs').delegate('img','click', function(){
    $('.large').attr('src',$(this).attr('src').replace('thumb','large'));
    $('.large').hide().fadeIn(500);
});
</script> 
```

每次单击缩略图时，页面都会滚动回顶部。我试图用

```
return false; 
```

但是，它可以工作，然后大图像不会更新。还有其他方法可以防止页面滚动到顶部吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:10:08.797

我似乎没有在 IE9 中这样做。尝试阻止默认操作：

```
<script> 
$('.thumbs').delegate('img','click', function(event){ 
    $('.large').attr('src',$(this).attr('src').replace('thumb','large')); 
    $('.large').hide().fadeIn(500); 
    event.preventDefault();
}); 
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:22:10.043

该页面不会滚动到页面顶部，它会滚动到大图像的顶部，因为您更改了图像源。

您可以尝试禁用和隐藏和淡入淡出效果，看看问题是否仍然存在。

如果问题仍然存在，只需添加以下代码即可解决问题。

```
<script>
$('.thumbs').delegate('img','click', function(){
    var y = window.pageYOffset;
    $('.large').attr('src',$(this).attr('src').replace('thumb','large'));
    $('.large').hide().fadeIn(500);
    window.scrollTo(0, y)
});
</script> 
```

对不起任何英语错误。我在用谷歌翻译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T18:10:06.217

你到底把返回错误放在哪里？如果你最后做到了，它应该有效。像这样：

```
<script>
$('.thumbs').delegate('img','click', function(){
    $('.large').attr('src',$(this).attr('src').replace('thumb','large'));
    $('.large').hide().fadeIn(500);
    return false;
});
</script> 
```

您还可以使用 e.preventDefault() 停止默认链接操作：

```
<script>
    $('.thumbs').delegate('img','click', function(e){
        $('.large').attr('src',$(this).attr('src').replace('thumb','large'));
        $('.large').hide().fadeIn(500);
        e.preventDefault();
        return false;
    });
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T18:16:33.747

发生这种情况是因为当您替换大图像 src 时，它会暂时消失，页面变小并且不需要滚动，所以向上。尝试缩放页面，然后您会看到它不会发生（ctrl + 鼠标向上滚动）。

只需将您的大图像与 DIV 固定大小不变：

```
<div style="height: 490px; width: 490px;float: left;">
    <img style="display: block;" class="large" src="images/06_large.png">
</div> 
```

# php - 无法将xml中的关键字与php连接起来

> ID：11509968
> 
> 赞同：0
> 
> 时间：2012-07-16T18:05:39.590
> 
> 标签：php, simplexml

我有以下问题：

我无法将所有关键字连接到一个字符串中。它返回一个数组......我尝试了几个小时，但我没有管理它。

这是代码：

（if 条件在循环中）

```
$keyword="";
$entry=0;

if ($index=="keywordterm){
            $kword=$arrObjData[$index]; // takes the value of keywordterm
            $kwords[$entry]=$kword;
            echo "keywords[$entry]: ".$kwords[$entry]."</br></br>";
            $keywordd.=$kwords[$entry]." | ";   
            $entry++;           
}
print_r($keywordd);
echo "Keywords: ".$keywordd."<br><br>"; 
```

结果是：

```
keywords[1]: telecommunication computing

keywords[2]: multi-agent systems

keywords[3]: state estimation

keywords[4]: control engineering computing

keywords[5]: telecommunication control

keywords[6]: Matlab-Simulink platform

keywords[7]: networked multiagent systems

keywords[8]: information sharing

keywords[9]: multiple cooperative agents

keywords[10]: networked control system

Array ( )
Keywords: Array 
```

我想要这样的东西：

```
Keywords: telecommunication computing | multi-agent systems | state estimation......... 
```

XML 代码如下：

```
<keywordset keywordtype="Inspec">
      <keyword>
        <keywordterm><![CDATA[computer aided manufacturing]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[semantic Web]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[factory automation]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[ontologies (artificial intelligence)]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[knowledge based systems]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[inference mechanisms]]></keywordterm>
      </keyword>
    </keywordset>
    <keywordset keywordtype="InspecFree">
      <keyword>
        <keywordterm><![CDATA[reconfigurable manufacturing systems]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[semantic Web services]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[factory automation]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[ontologies]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[explicit semantics]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[logical reasoning]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[autonomous manufacturing orchestration]]></keywordterm>
      </keyword>
      <keyword>
        <keywordterm><![CDATA[knowledge based systems]]></keywordterm>
      </keyword>
    </keywordset> 
```

在此先感谢，并对这个 loooong 代码感到抱歉..

所有的代码都是这样的：

```
$keywordd="";
$entry=0;
$kwords=array();
$xmlUrl = "9424.xml"; // XML feed file/URL

$xmlStr = file_get_contents($xmlUrl);

$xmlObj = simplexml_load_string($xmlStr);

$arrXml = objectsIntoArray($xmlObj, $entry, $keywordd);

function objectsIntoArray(&$arrObjData, &$entry, &$keywordd, $arrSkipIndices = array()) {

if (is_array($arrObjData)) {

    echo "<pre>";

        //print_r($arrObjData);
        echo "</pre>";  

        foreach ($arrObjData as $index => $value) {

if ($index=="keywordterm"&&$index!="0"){
            $kword=$arrObjData[$index];
            echo "<b>KEYWORD: </b>".$kword."</br></br>";
            $kwords[$entry]=$kword;
            echo "keywords[$entry]: ".$kwords[$entry]."</br></br>";
            $keywordd.=$kwords[$entry]." | ";
            //echo $keywordd."<br><br>";
            $entry++;
            //echo "entry: ".$entry."<br>";

        }
        elseif ($index=="joursec"&&$index!="0"){
            //print_r($keywordd);
            echo "<b>Keywords: </b>".$keywordd."<br><br>";
        }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:14:31.600

由于我看到 $keywordd 是一个字符串，所以你不能用 print_r 打印它吗？如果你只做 "echo $keywordd" 会发生什么？

您应该使用 implode() 将数组转换为字符串吗？

例子：

```
$array = array('lastname', 'email', 'phone');
$comma_separated = implode(",", $array);
echo $comma_separated; // lastname,email,phone 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:21:03.123

您是否尝试过使用[implode](http://php.net/manual/en/function.implode.php)：

```
$array = array('lastname', 'email', 'phone');
$comma_separated = implode(" | ", $array); 
```

# javascript - cgi 脚本多次发送表单数据，每次刷新一次

> ID：11509969
> 
> 赞同：1
> 
> 时间：2012-07-16T18:05:56.220
> 
> 标签：javascript, python, forms, cgi

我正在尝试使用带有 smtplib 和 imaplib 的 python cgi 编写我自己的 webmail 应用程序。但是，当我点击“发送”表单上的发送按钮时，会发送电子邮件，之后每次刷新都会再次发送消息。页面（cgi 脚本）通过 javascript 每两分钟自动刷新一次：

```
 <script language="javascript">

    window.setInterval('refresh()', 180000);

    function refresh() 
    {
      // this checks to see which tab is selected, page is refreshed only if compose tab is not selected
      elList = document.getElementsByTagName("a");
      for (i = 0; i < elList.length; i++)
      { 
        if (elList[i].className === 'tab active') 
        {
          var activeTab = elList[i].innerHTML;
        }
      }

      if (activeTab.indexOf("Unread") >= 0)
      {
         window.location.reload(true);
      }

    } 
  </script> 
```

我真的无法判断表单数据是多次发送还是只是多次读取。但是，我认为没有理由在刷新时再次提交表单，所以我不得不相信它只是被多次阅读。以下是能够读取表单数据的组件：

```
# Create instance of FieldStorage 
form = cgi.FieldStorage()

if form.keys() != []:
  for x in form.keys():
    if x == 'send':
      send_email() 
```

我尝试在页面头标记中使用 javascript 重置表单，但这不起作用：

```
<script language="javascript">
  Form.reset('send');  // reset send form so email is not sent again
</script> 
```

为了完整起见，这里是表单定义：

```
 <form name="send" action="/cgi-bin/myemail.py" method="post" >
  <table id="example" class="compose" >
    <tr>
      <td><input type="submit" value="To:" style="height: 1.95em; width: 4em"></td><td><input type="text" name="send_to" size="90"></td><td><input type="submit" name="send" value="SEND" style="height: 1.95em; width: 12em"></td> 
    </tr>
    <tr>
      <td><input type="submit" value="Cc:" style="height: 1.95em; width: 4em"></td><td><input type="text" name="send_cc" size="90"></td> <td><input type="submit" name="send" value="SAVE" style="height: 1.95em; width: 12em"></td>
    </tr>
    <tr>
      <td><input type="submit" value="Bcc:" style="height: 1.95em; width: 4em"></td><td><input type="text" name="send_bcc" size="90"></td> <td><input type="submit" name="send" value="DELETE" style="height: 1.95em; width: 12em"></td>
    </tr>
    <tr>
      <td><input type="submit" value="Subj:" style="height: 1.95em; width: 4em"></td><td><input type="text" name="send_subj" size="90"></td> <td><input type="submit" name="send" size="200" value="ATTACH" style="height: 1.95em; width: 12em"></td> 
    </tr>
    <tr>
      <td colspan="3">
        <!-- <td colspan="3"> <div id="result" class="body" style="background-color:#000000"></div></td> -->
        <textarea name="send_body" cols="118" rows="23"> </textarea>
      </td>
    </tr>
  </table>
  </form> 
```

如何防止此表单数据被多次读取？谢谢。

# css - 使 div 扩展到可用宽度，以及 h1/h2 标签

> ID：11509972
> 
> 赞同：1
> 
> 时间：2012-07-16T18:06:06.173
> 
> 标签：css, html

这是一个JSFiddle：

[http://jsfiddle.net/cKuUy/2/](http://jsfiddle.net/cKuUy/2/)

* * *

这是我的目标截图：

![在此处输入图像描述](../Images/b88495d06a18f14a8a0b85ce16642b77.png)

我在浏览器中得到了什么：

![在此处输入图像描述](../Images/de677e954466ce34011f782527a48443.png)

关键区别在于，在实际实现中，条不填充包含 div 元素的可用宽度。如果我放置：`width:100%`，栏会扩展到它的容器宽度，但会下降到文本下方；尽管两个元素都向左浮动。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:12:54.460

这个解决方案应该有帮助：[https ://stackoverflow.com/a/1767270/1472586](https://stackoverflow.com/a/1767270/1472586)

基本上从酒吧中删除`float: left`和添加到它们。您可能还必须相应地调整边距（例如，标题上的右填充可能会更好）。`width``overflow: hidden`

# android - 如何保存会话之间的文件路径列表？

> ID：11509973
> 
> 赞同：0
> 
> 时间：2012-07-16T18:06:14.947
> 
> 标签：android, android-preferences

我想在我的应用程序中实现书签功能。除了保存然后加载保存的书签列表之外，我可以处理所有事情。我计划将位置保存为包含书签目录路径的字符串。

开发者指南的“存储选项”页面列出了可用的选项，但并没有具体说明每个选项的好处。

在会话之间保存此类数据的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:13:02.787

*   `shared preferences`当您有少量数据时使用，当您想要保存有关应用程序的一些首选项时，更可能使用名称-值对 。
*   `Sqlite`当您拥有大量结构化数据时使用。就像你有一个班级的名字和成绩一样，你必须使用`SQLite`
*   将文件用于更大尺寸的数据，例如图像、视频、xmls

我希望它能帮助你决定你想要什么。但在你的情况下`Sqlite`是一个最好的选择。

# ms-access - access中的dlookup函数

> ID：11509974
> 
> 赞同：1
> 
> 时间：2012-07-16T18:06:17.817
> 
> 标签：ms-access

我第一次尝试在访问中使用 dlookup 函数，如下所示，但我得到空白输出。

```
select dlookup ("quantity","test","series > 2000") from test 
```

这是测试表

```
 id series  quantity
 1  1000    25
 2  2000    33
 3  3000    44
 4  4000    55
 5  5000    66
 6  6000    77 
```

我认为上面的查询将显示下表中具有超过 2000 个系列的所有记录，即如下所示，但它显示空白结果。

```
 id series  quantity
 3  3000    44
 4  4000    55
 5  5000    66
 6  6000    77 
```

我不确定我的语法是否不正确或其他。不过，我已经从各种来源仔细检查了我的语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:14:53.290

`DLookup()`返回一个值，这不是我认为你想要的。只需将您的选择约束放在 WHERE 子句中。

```
SELECT id, series, quantity
FROM test
WHERE series > 2000; 
```

# ms-access - 隐藏打印报告字段

> ID：11509983
> 
> 赞同：1
> 
> 时间：2012-07-16T18:07:00.980
> 
> 标签：ms-access, printing, vba, ms-access-2003

在 Access 2003 数据库中，我有一个通过 VBA 生成的员工状态/反馈报告。我在 VBA 中创建报告是因为所需的报告格式是这样的，我发现这样做对我来说更容易（组合多个记录集，显示与其他记录集对齐的记录集中的多个记录，自定义一些基于格式的格式化元素部门等）。可能有更好的方法来创建这些报告，但这运行得很好，所以我宁愿尽可能避免重新创建。

我的问题是：由于这是一份员工反馈表，因此主管希望能够看到一些细节，但不向员工展示。生成报告时，主管有机会审查数据/对报告本身进行更改（通过用户表单、报告上的事件处理）。审查的一部分是查看一组字段（作为标签添加到报告中），但在最终打印报告时应该隐藏这些字段。

在我的脑海中，我以为我以前见过一种以这种方式隐藏特定控件的方法，并进行了一些谷歌搜索[以](http://msdn.microsoft.com/en-us/library/aa195851%28office.11%29.aspx)在`DisplayWhen`. 但是，它似乎`DisplayWhen`只能在表单上使用。有没有办法使用报告设置此值（或类似/相关选项）？**在 SO 上进行搜索时，我在DisplayWhen**的查询中只发现了一个问题，这对我没有帮助。

在创建报告时使用`.Visible = False`该报告将不起作用，因为主管需要查看这些字段。我似乎无法在打印时设置此属性，因为我没有看到任何事件处理选项。我可以创建一个自定义事件处理程序来捕获打印命令吗？

这是控件创建代码：

```
Private Sub AddOneOnOneField(Rpt As Report, Left As Integer, Top As Integer, Width As Integer, Height As Integer, _
    Optional Cap As String = vbNullString, Optional Align As Integer = cnFontCenter, Optional Size As Integer = 10, _
    Optional Bold As Integer = cnBoldFont, Optional DisplayWhen As Byte = 0)

    With CreateReportControl(Rpt.Name, acLabel, acDetail, vbNullString, vbNullString, _
        Left, Top, Width, Height)

        .Properties("FontSize") = Size
        .Properties("FontWeight") = Bold
        .Properties("BorderStyle") = 1
        .Properties("TextAlign") = Align
        .Properties("Caption") = Cap
        .Properties("DisplayWhen") = DisplayWhen ' This does not work!
    End With

End Sub 
```

* * *

*重申我的问题：*

*   **如何将某些报表字段设置为仅在打印预览中显示，而不在打印时显示？**
*   **我可以创建一个自定义事件处理程序来从报告中捕获打印命令吗？**
*   **有没有办法`DisplayWhen`在报告字段上设置属性（或类似/相关选项）？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:39:41.910

如果隐藏数据真的很重要，那么您选择了错误的数据库，如果有点随意，您可以要求管理员输入代码，然后根据代码隐藏或显示字段。或者，您可以为管理员提供稍微不同的前端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T14:44:49.363

这并不理想，但它有效。通过 VBA 创建报表时，我已经有了在报表模块中创建代码的代码。我添加到该功能以捕获字段的打印/强制隐藏，打印，然后取消隐藏。

```
Private Sub AddReportCode(mdlNew As Module)
Dim sNewCode As String

    sNewCode = "Option Compare Database" & vbCr & "Option Explicit"
    sNewCode = sNewCode & vbCr
    sNewCode = sNewCode & vbCr & "Public Sub CapturePrint()"
    sNewCode = sNewCode & vbCr & "Dim v As Variant"
    sNewCode = sNewCode & vbCr & "If Application.CurrentObjectName = ""OneOnOneReport"" And Application.CurrentObjectType = acReport Then"
    sNewCode = sNewCode & vbCr & "DoCmd.OpenReport ""OneOnOneReport"", acViewDesign"
    sNewCode = sNewCode & vbCr & "Reports(""OneOnOneReport"").Visible = False"
    sNewCode = sNewCode & vbCr & "For Each v In Reports(""OneOnOneReport"").Controls"
    sNewCode = sNewCode & vbCr & "If Left(v.Properties(""Name""), 3) = ""Occ"" Then"
    sNewCode = sNewCode & vbCr & "v.Visible = False"
    sNewCode = sNewCode & vbCr & "End If"
    sNewCode = sNewCode & vbCr & "Next v"
    sNewCode = sNewCode & vbCr & "DoCmd.OpenReport ""OneOnOneReport"", acNormal"
    sNewCode = sNewCode & vbCr & "DoCmd.OpenReport ""OneOnOneReport"", acViewDesign"
    sNewCode = sNewCode & vbCr & "For Each v In Reports(""OneOnOneReport"").Controls"
    sNewCode = sNewCode & vbCr & "If Left(v.Properties(""Name""), 4) = ""HIDE"" Then"
    sNewCode = sNewCode & vbCr & "v.Visible = True"
    sNewCode = sNewCode & vbCr & "End If"
    sNewCode = sNewCode & vbCr & "Next v"
    sNewCode = sNewCode & vbCr & "Reports(""OneOnOneReport"").Visible = True"
    sNewCode = sNewCode & vbCr & "DoCmd.OpenReport ""OneOnOneReport"", acViewPreview"
    sNewCode = sNewCode & vbCr & "End If"
    sNewCode = sNewCode & vbCr & "End Sub"

    mdlNew.DeleteLines 1, mdlNew.CountOfLines

    mdlNew.InsertText sNewCode

End Sub 
```

为了便于阅读，这是运行后模块中的实际代码：

```
Option Compare Database
Option Explicit

Public Sub CapturePrint()
Dim v As Variant
If Application.CurrentObjectName = "OneOnOneReport" And Application.CurrentObjectType = acReport Then
    DoCmd.OpenReport "OneOnOneReport", acViewDesign
    Reports("OneOnOneReport").Visible = False
    For Each v In Reports("OneOnOneReport").Controls
        If Left(v.Properties("Name"), 3) = "Occ" Then
            v.Visible = False
        End If
    Next v
    DoCmd.OpenReport "OneOnOneReport", acNormal
    DoCmd.OpenReport "OneOnOneReport", acViewDesign
    For Each v In Reports("OneOnOneReport").Controls
        If Left(v.Properties("Name"), 4) = "HIDE" Then
            v.Visible = True
        End If
    Next v
    Reports("OneOnOneReport").Visible = True
    DoCmd.OpenReport "OneOnOneReport", acViewPreview
End If
End Sub 
```

在向报告中添加新控件时（请参阅有问题的原始代码正文），我添加了可以选择为控件分配名称的功能：

```
.Properties("Name") = NewName 
```

控件创建代码使用`NewName`参数调用，`"HIDE" & ControlTop & ControlLeft`以允许命名所有需要的控件而无需重复名称。隐藏之前，报表以设计模式打开，以防止屏幕闪烁/减速。然后，打印代码循环遍历报表上的所有控件，查找以“HIDE”开头的名称并隐藏它们。一旦所有控件都被隐藏，报表将正常重新打开以打印，然后重复该过程以取消隐藏这些控件并向用户显示原始报表。

我仍然无法`print`正确捕获事件（这是解决方案不是我最喜欢的选项的地方），所以我在最初创建报告时提示用户打印，调用新创建的`CapturePrint`Sub（同时隐藏这些字段）。如果他们选择不这样做，那么他们可以在不隐藏字段的情况下正常打印，或者重新生成报告以隐藏它们/再次提示。

# mysql - 对简单 InnoDB 表的简单 MySQL INSERT 查询需要 40+ms

> ID：11509984
> 
> 赞同：1
> 
> 时间：2012-07-16T18:07:14.817
> 
> 标签：mysql, performance, insert, innodb, myisam

我想知道究竟是什么原因导致 mysql/innodb 上的插入查询在 CPU 相当强大的机器上持续至少 40 毫秒。“等效”查询在同一个 MyISAM 表上运行 <10 毫秒（表没有任何外键）。时间来自 MySQL 控制台。

这是用于复制的“尽可能简单”的数据库结构。

```
CREATE TABLE `test_table_innodb` (
  `id` int NOT NULL AUTO_INCREMENT,
  `int_column` int NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `test_table_myisam` (
  `id` int NOT NULL AUTO_INCREMENT,
  `int_column` int NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1; 
```

我正在从 mysql 控制台运行相同的查询（在 InnoDB 的情况下自动提交事务）。当时没有在机器上执行其他查询，结果是：

```
 mysql> insert into test_table_myisam (int_column) values (5);
 Query OK, 1 row affected (0.00 sec)

 mysql> insert into test_table_innodb (int_column) values (5);
 Query OK, 1 row affected (0.06 sec) 
```

事务开销是否会使查询对 InnoDB 表运行更长时间？或者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:24:35.860

每个自动提交的 INSERT 都需要考虑三个方面

# 方面#1。高架

InnoDB 支持 MVCC 和事务隔离作为 ACID 兼容的存储引擎。为了适应这一点，在提交更改之前的行副本被写入系统表空间文件的撤消表空间部分`ibdata1`。如果您正在运行 INSERT，会写什么？*一个空白行的副本*。这样，回滚就可以简单地删除插入的尝试。当一个 INSERT 被提交时，Undo Tablespace 中的空白副本被删除。

# 方面#2。聚集索引

对于每个 InnoDB 表，都存在[**一个名为 的内部默认行索引`gen_clust_index`**](https://serverfault.com/a/239554/69271)。无论是否存在 PRIMARY KEY，都会创建它。由于您的表具有 id 的 PRIMARY KEY，因此 gen_clust_index 被构造为与包含唯一 id 字段的行相关联。

# 方面#3。配置

信不信由你，有时开箱即用的 MySQL 4.1 比 MySQL 5.5 更快。听起来很震惊，不是吗？Percona 实际上对 MySQL 的几个版本进行了基准测试，发现情况确实如此。

我之前在 DBA StackExchange 上写过这个

*   [为什么 mysql 5.5 比 5.1 慢（linux，使用 mysqlslap）](https://dba.stackexchange.com/questions/8384/why-mysql-5-5-slower-than-5-1-linux-using-mysqlslap/8385#8385 "2011 年 11 月 24 日")（2011 年 11 月 24 日）
*   [查询在一些较新的 MySQL 版本中运行很长时间](https://dba.stackexchange.com/questions/6526/query-runs-a-long-time-in-some-newer-mysql-versions/6542#6542 "2011 年 10 月 5 日")（2011 年 10 月 5 日）
*   [多核和 MySQL 性能](https://dba.stackexchange.com/questions/5926/multi-cores-and-mysql-performance/5968#5968 "2011 年 9 月 20 日")（2011 年 9 月 20 日）
*   [如何正确执行 MySQL 烘烤？](https://dba.stackexchange.com/questions/3375/how-do-i-properly-perform-a-mysql-bake-off/3376#3376 "2011 年 6 月 19 日")（2011 年 6 月 19 日）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:49:14.020

CPU不是这里的因素。因素是磁盘。在 innodb 中该命令需要写入 log ，所以如果 log 磁盘是同一个磁盘或磁盘不是碎片或磁盘慢的话，你会有很大的不同。

# scala - 在没有 Actor 的情况下在 Scala 中同时改变 HashMap

> ID：11509987
> 
> 赞同：1
> 
> 时间：2012-07-16T18:07:33.677
> 
> 标签：scala, concurrency, parallel-collections

我想要做的是开始使用 a 的一些实现，`Map`并通过迭代并行集合将数据累积到其中。密钥可以在线程之间“重叠”，因为密钥是概率生成的（与随机数生成有关）。

前任。线程 1 想要将 key = A value = 1 添加到映射中。如果它已经存在，则将 1 添加到现有值（因为值是 1） - 如果不存在，则创建映射。同时，另一个线程有 key = A 和 value = 2，并且想做同样的事情。

有没有办法在不创建整个`Actor`系统的情况下做到这一点？

`ConcurrentHashMap`来自 Java 的库似乎看起来很有趣，但是“弱一致性”迭代器让我担心跨线程更新映射的安全性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T18:47:36.903

如果没有 Actors，这是一件非常微不足道的事情。

```
class CountMap[K <: AnyRef](mapSize: Int = 16) extends ConcurrentHashMap[K, AtomicLong](mapSize) {
  def addCount(key: K): Long = (get(key) match { // Check value for key
    case null =>  // If not mapped yet
      val al = new AtomicLong(0) // Create a new memory slot to keep the count in that is thread safe
      putIfAbsent(key, al) match { // Try to put our memory slot in atomically
        case null => al // If we succeeded then our memory slot should be used
        case some => some // if there already was a memory slot, use that one
      }
    case some => some // If there already was a memory slot, use that one
    }).incrementAndGet() // increment and get the current value of the slot associated with the given key

  def getCount(key: K): Long = get(key) match { // get the memory slot associated with the key
    case null => 0L // if none, say it's 0
    case some => some.get() // if some get its value
  }
} 
```

# javascript - 如何在新窗口中提交表单，然后重定向父页面

> ID：11509988
> 
> 赞同：1
> 
> 时间：2012-07-16T18:07:33.160
> 
> 标签：javascript, html, forms, onsubmit

我在这里尝试做的事情有一些浏览器兼容性问题。

我在网页上有一个表格：

```
 <form method="POST" target="_blank" 
       onsubmit="refreshparent()" action="https://processor.com/payment.php" >
       <input type="HIDDEN" name="unit_key" value="92393d" >
       <input type="HIDDEN" name="cost" value="100.20" >
       <input type="HIDDEN" name="user_id" value="92393d" >
       <input type="SUBMIT" name="SUBMIT"  value="Click to open payment site" >
 </form> 
```

当用户提交表单时，我希望打开一个新窗口，并且我希望调用一个名为“refreshparent”的 javascript 函数。

```
 <script type="text/javascript">
       function refreshparent()
       {
           alert("test");
           window.location.replace ("http://mysite.com/main-menu.html");
        }
  </script> 
```

这适用于某些浏览器，但不适用于 Chrome。有没有更好的方法让表单提交和 javascript 调用通过同一个按钮单击发生？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-16T18:16:46.730

而不是使用`target='_blank'`打开新窗口，您可以阻止默认提交操作并`window.open`改为使用。不确定，但这可能会解决您的 Chrome 问题。

# c# - 将现有表单添加到项目导致 Intellitrace 崩溃

> ID：11509989
> 
> 赞同：1
> 
> 时间：2012-07-16T18:07:37.390
> 
> 标签：c#, winforms, visual-studio-2010, c#-4.0, intellitrace

我正在创建一个新项目，该项目需要 4 或 5 个以前项目中已经创建的表单。

我通过右键单击项目来添加它们 -> 添加现有 -> 浏览到表单并添加 Form.cs、form.Designer.cs 和 Form.resx

我进入并更改了表单上的名称空间。

现在，当我尝试在调试模式下运行项目时，IntelliTrace 崩溃。

该程序打开，但在我关闭它后需要大约 5 分钟才能在 VS 中停止“运行”。

我 95% 确定唯一可能导致此问题的原因是我将表单添加到项目中。我在这里做错了什么？

**编辑：**当我尝试打开添加的表单时，它们不会打开。没有错误或任何东西，它们只是不会打开。

当我调试 IntelliTrace 时

```
StackOverFlow Exception was unahndled
{Cannot evaluate expression because the current thread is in a stack overflow state.} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:15:04.023

您可能在某个地方的设置不好。

这将重置您的所有 VS 设置：

> devenv /重置设置

# xml-parsing - 使用 Linq 读取 xml

> ID：11509991
> 
> 赞同：1
> 
> 时间：2012-07-16T18:07:43.760
> 
> 标签：xml-parsing, linq-to-xml

我无法弄清楚如何获取以下 XML 中的所有 ItemDetail 节点：

```
<?xml version="1.0" encoding="UTF-8"?>
<AssessmentMetadata xmlns="http://tempuri.org/AssessmentMetadata.xsd">
   <ItemDetails>
    <ItemName>I1200</ItemName>
    <ISC_Inactive_Codes>NS,NSD,NO,NOD,ND,NT,SP,SS,SSD,SO,SOD,SD,ST,XX</ISC_Inactive_Codes>
    <ISC_StateOptional_Codes>NQ,NP</ISC_StateOptional_Codes>
  </ItemDetails>
  <ItemDetails>
    <ItemName>I1300</ItemName>
    <ISC_Inactive_Codes>NS,NSD,NO,NOD,ND,NT,SP,SS,SSD,SO,SOD,SD,ST,XX</ISC_Inactive_Codes>
    <ISC_StateOptional_Codes>NQ,NP</ISC_StateOptional_Codes>
  </ItemDetails>
  <ItemDetails>
    <ItemName>I1400</ItemName>
    <ISC_Active_Codes>NC</ISC_Active_Codes>
    <ISC_Inactive_Codes>NS,NSD,NO,NOD,ND,NT,SP,SS,SSD,SO,SOD,SD,ST,XX</ISC_Inactive_Codes>
    <ISC_StateOptional_Codes>NQ,NP</ISC_StateOptional_Codes>
  </ItemDetails>
</AssessmentMetadata> 
```

我尝试了很多事情，我认为这可能是命名空间问题，所以这是我最后一次尝试：

```
var xdoc = XDocument.Load(asmtMetadata.Filepath);
var assessmentMetadata = xdoc.XPathSelectElement("/AssessmentMetadata"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:34:32.593

您需要获取默认命名空间并在查询时使用它：

```
var ns = xdoc.Root.GetDefaultNamespace();
var query = xdoc.Root.Elements(ns + "ItemDetails"); 
```

您需要为任何元素添加前缀。例如，以下查询检索所有`ItemName`值：

```
var itemNames = xdoc.Root.Elements(ns + "ItemDetails")
                    .Elements(ns + "ItemName")
                    .Select(n => n.Value); 
```

# objective-c - 如何在断点处查看Objective-c（等效的汇编代码）？

> ID：11509993
> 
> 赞同：3
> 
> 时间：2012-07-16T18:07:53.317
> 
> 标签：objective-c, xcode, cocoa-touch, assembly

如何在断点处查看 XCode（等效汇编代码）？

我去了 Thread1，它显示了 [ViewController viewDidLoad] 的 Objective-c，然后显示了 [UIViewController view] 和 [UIWindow makeKeyAndVisible] 的程序集。我希望能够在中断点看到带有标记的 [ViewController viewDidLoad] 的程序集？

（Product->GenerateOutput->Generate Assembly File：不显示中断点。）

谢谢

```
void addme(int *a)
{
    *a += 0xFF;// <-- I want to see the assembly for this:  should see an instruction "ADD" in the assembly break down
    *a += 1;
    *a += 2;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    int a = 12;
    addme(&a);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:24:41.180

脚步：

1.  在要查看汇编代码的地方放置断点
2.  运行程序
3.  一旦程序暂停，点击看起来像 ->| 的按钮 （但指向下方）
4.  多次重复步骤 3
5.  舞蹈
6.  看世界
7.  惊叹于生活的乐趣
8.  汽水瓶
9.  变老
10.  死

我不太确定这是您要的，但我刚刚做到了（嗯，步骤 1-5 和 8），它对我有用。

![在此处输入图像描述](../Images/ae2f65b8f7ad8711af19fa9f640ccb85.png)

它位于屏幕底部，位于控制台上方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:04:21.497

而且您也很可能根本看不到汇编 ADD 指令，因为编译时常量是在编译时计算并因此被编译器优化掉的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:01:02.053

@jdl At the matter of fact i don't know Objective-C and @Dustin doesn't know asm... As i understood `viewDidLoad` function will execute a code in it when some object is loaded. In my opinion you can compile only that part of code which you included in your question and look into assembly code via `IDA pro` for Mac OS or some other debugger.

# asp.net-mvc-3 - 从 PartialView 设置页面标题

> ID：11509996
> 
> 赞同：1
> 
> 时间：2012-07-16T18:08:11.217
> 
> 标签：asp.net-mvc-3, razor, viewbag

> **可能重复：**
> [在局部视图中修改 MVC 3 ViewBag 不会持续到 _Layout.cshtml](http://stackoverflow.com/questions/4974027/modifying-mvc-3-viewbag-in-a-partial-view-does-not-persist-to-the-layout-cshtml)

我正在尝试从 PartialView 设置 pageTitle

这是我的代码：

**部分视图模板：**

```
@{
    ((WebViewPage)WebPageContext.Current.Page).ViewBag.Title = "Page title";
} 
```

**_Layout.cshtml：**

```
<title> @ViewBag.Title</title> 
```

这个怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:51:30.563

这不是部分人应该做的事情。修改父视图不是它的责任`ViewBag`。除此之外，这是不可能的。[引用 MSDN](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.renderpartialextensions.renderpartial.aspx)：

> 当一个局部视图被实例化时，它会获得它自己的 ViewDataDictionary 对象的副本，该副本可用于父视图。因此，部分视图可以访问父视图的数据。但是，如果局部视图更新数据，这些更新只会影响局部视图的 ViewData 对象。父视图的数据没有改变。

您始终可以执行[此处显示的](https://stackoverflow.com/questions/4974027/modifying-mvc-3-viewbag-in-a-partial-view-does-not-persist-to-the-layout-cshtml)*解决方法* ，但请不要这样做。部分不应该设置任何父状态。他们不应该对父母一无所知。