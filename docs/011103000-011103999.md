# StackOverflow 问答 11103000-11103999

# c# - 从 SQL Server 检索一行到 Windows Phone

> ID：11103000
> 
> 赞同：1
> 
> 时间：2012-06-19T14:20:56.257
> 
> 标签：c#, windows-phone-7

我正在使用此代码在 SQL Server 中搜索数据。但结果是返回列表，我应该返回什么才能只得到一行？意味着我想使用文本块绑定来获取记录而不使用列表框模板..

```
public List<Customer> FindProfile(string custemail)
{
    var findprofile = from r in cust.Customers where r.CustEmail == custemail select r;
    return findprofile.ToList();
}

public List<Customer> GetProfileData()
{
    var profiledata = from r in cust.Customers
                      select r;
    return profiledata.Take(5).ToList();
}

public pgProfile()
{
   InitializeComponent();
   proxy.FindProfileCompleted += new EventHandler<FindProfileCompletedEventArgs>(proxy_FindProfileCompleted);
   proxy.FindProfileAsync(custemail);
}

void proxy_FindProfileCompleted(object sender, FindProfileCompletedEventArgs e)
        {
            ListBox1.ItemsSource = e.Result;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:23:35.707

你不能只使用`.First()`或`.FirstOrDefault()`在被退回的客户名单上吗？

```
List<Customer> customers = GetProfileData();

// get just the first customer:
Customer first = customers.First(); 
```

# php - 从 Kitco Inc. 纯文本市场页面提取 Web 数据/抓取数据

> ID：11103001
> 
> 赞同：0
> 
> 时间：2012-06-19T14:20:56.790
> 
> 标签：php, web-scraping

我希望从

[http://www.kitco.com/texten/texten.html](http://www.kitco.com/texten/texten.html)：

```
<html>
<head>
<title>Text Only Market Page</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#FFFFFF">
<br><br>
<pre>
<b><font size=6>
  Kitco Inc.

  Text Only Market Page</font></b>

    <a href="http://www.kitco.com/market/">Graphic version of this page</a>

    <a href="http://www.kitco.com/market/LFrate.html">Precious Metals Lease Rates</a>  
    <a href="http://www.kitco.com/gold.londonfix.html">Historical Price Data</a>  
    <a href="http://www.kitco.com/market/marketnews.html">Precious Metals News Headlines</a>

    <font size=4><b><a href="https://online.kitco.com/bullion/completelist_USD.html#gold">Buy gold and silver online direct from Kitco!</a> 
   Live quotes for all bullion products.</b></font>

   --------------------------------------------------------------------------------
   London Fix          GOLD          SILVER       PLATINUM           PALLADIUM
                   AM       PM                  AM       PM         AM       PM
   --------------------------------------------------------------------------------
   Jun 19,2012   1628.50   1625.50   28.8100   1486.00   1486.00   629.00   634.00  
   Jun 18,2012   1623.50   1615.50   28.4300   1486.00   1484.00   626.00   628.00  
   --------------------------------------------------------------------------------

                  New York Spot Price
                MARKET IS OPEN
            Will close in 4 hour 25 minutes
   ----------------------------------------------------------------------
   Metals          Bid        Ask           Change        Low       High 
   ----------------------------------------------------------------------
   Gold         1619.80     1620.80     -8.90  -0.55%    1616.60  1632.70 
   Silver         28.46       28.56     -0.28  -0.97%      28.24    28.95 
   Platinum     1479.00     1489.00      0.00   0.00%    1476.00  1500.00 
   Palladium     627.00      632.00      0.00   0.00%     622.00   639.00 
   ----------------------------------------------------------------------
   Last Update on Jun 19, 2012 at 12:50.59
   ----------------------------------------------------------------------

                Asia / Europe Spot Price
                MARKET IS OPEN
            Will close in 4 hours 25 minutes
   ----------------------------------------------------------------------
   Metals                      Bid          Ask      Change from NY close
   ----------------------------------------------------------------------
   Gold                      1619.80      1620.80     -8.90   -0.55%
   Silver                      28.46        28.56     -0.28   -0.97%
   Platinum                  1479.00      1489.00     +0.00   +0.00%
   Palladium                  627.00       632.00     +0.00   +0.00%
   ----------------------------------------------------------------------
   Last Update on Jun 19, 2012 at 12:50.59
   ----------------------------------------------------------------------

<b>   File created on Tue Jun 19 12:51:04 2012</b>

        <style type="text/css"><!--
 #main_container_footer {width:100%;text-align: center;}
    #main_container_footer #footer_container {width:auto; margin:25px auto 25px auto;}
    #main_container_footer #footer_container ul {margin:0; padding:0;}
    #main_container_footer #footer_container ul li {float:left; display:inline; list-style:none; padding:0 8px; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000; border-right:1px #000 solid;}
    #main_container_footer #footer_container ul li a {font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; color:#000; text-decoration:underline; font-weight:normal;}
    #main_container_footer #footer_container ul li a:hover {color:#ac1a2f; text-decoration:none; font-weight:normal;}
    #main_container_footer #footer_container ul li.no_border {border:0px;}
--></style>
  <table border="0" cellspacing="0" cellpadding="0"><tr><td>
 <div id="main_container_footer">
        <div id="footer_container">
            <ul>
                <li class="no_border"><script type="text/javascript">
copyright=new Date();
update=copyright.getFullYear();
document.write("&copy; "+ update + " Kitco Metals Inc.");
</script></li>
                <li><a href="https://corp.kitco.com/index.html">About Us</a></li>
                <li><a href="http://www.kitco.com/TermsofUse/" target="_top" onclick="Window_open(this.href,'KITCO','top=120,left=250,width=500,height=350'); return false">Website Terms of Use</a></li>
                <li><a href="https://online.kitco.com/help/privacy_policy.html" target="_top" onclick="Window_open(this.href,'KITCO','top=120,left=250,width=500,height=350'); return false">Privacy Policy</a></li>
                <li><a href="http://www.kitco.com/ads/">Advertise With Us</a></li>
                <li><a href="https://corp.kitco.com/en/corporate_culture.html">Careers</a></li>
                <li><a href="https://corp.kitco.com/en/contact.html" target="_top" onclick="Window_open(this.href,'KITCO','top=120,left=250,width=500,height=350'); return false">Contact Us</a></li>
                <li class="no_border"><a href="https://corp.kitco.com/en/feedback.html" target="_top" onclick="Window_open(this.href,'KITCO','top=120,left=250,width=500,height=350'); return false">Feedback</a></li>
            </ul>
        </div>
    </div>  

    </td></tr></table><br /><br />
<script language="JavaScript" type="text/javascript">
<!--
function Window_open (Address) {
  NewWindow = window.open(Address, "Popup", "width=695,height=600,left=100,top=200,resizable=yes,scrollbars=yes");
  NewWindow.focus();
}
// -->
</script>
 <!-- img src="http://www.kitco.com/scripts/counter/counter.pl?txtonlyE.txt" width="1" height="1" -->
<!-- Google-Analytics Code-->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-4074364-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html> 
```

更具体地说，我希望捕获以下数据：

```
--------------------------------------------------------------------------------
London Fix          GOLD          SILVER       PLATINUM           PALLADIUM
               AM       PM                  AM       PM         AM       PM
--------------------------------------------------------------------------------
Jun 19,2012   1628.50   NA        28.8100   1486.00   1486.00   629.00   634.00  
Jun 18,2012   1623.50   1615.50   28.4300   1486.00   1484.00   626.00   628.00  
-------------------------------------------------------------------------------- 
```

有人对我如何使用 PHP 执行此操作有任何建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:44:34.400

快速而肮脏的正则表达式方法：

```
$data = file_get_contents('http://www.kitco.com/texten/texten.html');
preg_match_all('/([A-Z]{3,5}\s+[0-9]{1,2},[0-9]{4}\s+([0-9.NA]{2,10}\s+){1,7})/si',$data,$result);

$records = array();
foreach($result[1] as $date) {
    $temp = preg_split('/\s+/',$date);
    $index = array_shift($temp);
    $index.= array_shift($temp);
    $records[$index] = implode(',',$temp);
}
print_R($records); 
```

请注意，您可能想要添加一些验证等。

# c# - 为什么我应该使用 RedirectToAction？

> ID：11103003
> 
> 赞同：4
> 
> 时间：2012-06-19T14:20:58.297
> 
> 标签：c#, asp.net, asp.net-mvc

有什么区别：

```
public ActionResult logOff()
{
    FormsAuth.SignOut();
    return RedirectToAction("index", "Home");
} 
```

和：

```
public ActionResult logOff()
{
    FormsAuth.SignOut();
    return index();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T14:24:40.927

是的。

您的用户将`RedirectToAction()`被重定向到索引页面（这就是他们将在浏览器地址栏上看到的内容）。只需返回您的`index()`方法的结果，就会用其他页面的内容填充当前页面（`LogOff`？）。

在这种情况下，可能没有区别，但如果您的操作执行一些逻辑，那么当用户只是刷新页面时您可能会遇到问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:28:05.750

看看[发布/重定向/获取模式](http://en.wikipedia.org/wiki/Post/Redirect/Get)

> 当通过 HTTP POST 请求将 Web 表单提交给服务器时，Web 用户尝试在某些用户代理中刷新服务器响应可能会导致重新提交原始 HTTP POST 请求的内容，可能会导致不希望的结果，例如重复的网络购买。为了避免这个问题，许多 Web 开发人员使用 PRG 模式[1](http://en.wikipedia.org/wiki/Post/Redirect/Get)— POST 操作不是直接返回网页，而是返回重定向命令。HTTP 1.1 规范引入了 HTTP 303 响应代码，以确保在这种情况下，Web 用户的浏览器可以安全地刷新服务器响应，而不会导致重新提交初始 HTTP POST 请求。但是，当今使用的大多数常见商业应用程序（新旧都一样）在这些情况下仍会继续发出 HTTP 302 响应。通常避免使用 HTTP 301，因为符合 HTTP-1.1 的浏览器在接收到 HTTP 301 后不会将该方法转换为 GET，这在 HTTP 302 中更常见。 [2] 但是，在不希望将 POST 参数转换为 GET 参数并因此记录在日志中的情况下，可能首选 HTTP 301。PRG 模式无法解决重复表单提交的所有情况。PRG 无法解决的一些已知的重复表单提交是：如果 Web 用户由于服务器滞后而在初始提交完成之前刷新，导致某些用户代理中的重复 HTTP POST 请求。

当重定向模式与 asp.net mvc 中的 HTTP Posts 一起使用时，这也是最常见的情况之一。

# asp.net-mvc-3 - 数据注释验证规则“必需”不适用于“varchar”（但适用于“int”）

> ID：11103006
> 
> 赞同：0
> 
> 时间：2012-06-19T14:21:05.090
> 
> 标签：asp.net-mvc-3, entity-framework-4, data-annotations, scaffolding

我使用 DBContext 生成器使用 EF 4.3（数据库优先）构建 MVC3 应用程序，并使用脚手架选项模板创建控制器及其视图，因此它根据 db 中字段的属性创建具有模型（数据注释）客户端验证的视图。

我的情况下，客户端验证适用`'Field Required'`于数字字段而不是 nvarchar 字段（至少在我的情况下），

```
table/class -> Table1
    id
    Name -> nvarchar(50) -> not allow null
    Count -> int -> not allow null 
```

验证规则`'Required'`适用于`'Count'`字段，但不适用于`'Name'`字段

有什么想法为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T20:21:19.233

您的模型是否包含 [Required()]？您的网页是否在字符串字段中包含 datal-val* 属性？

如果您想要客户端验证，您应该使用属性，或 IValidateableObject 接口进行自定义验证或流利的 api（注意最后两个仅是服务器端，但如果处理则可以向客户端显示消息）不要依赖 db 错误冒泡（如果这就是我上面的理解你在做什么）

# mysql - sql查询获取已删除记录

> ID：11103016
> 
> 赞同：13
> 
> 时间：2012-06-19T14:21:38.643
> 
> 标签：mysql, sql, select, gaps-and-islands

您有一个`table1`包含`id`列的表，即`int(11), not null, auto_increment`从 1 开始。

假设您有 10,000 条记录。很明显，最后一条记录的 id 是 10,000。删除 3 条记录后，表中有 9,997 条记录，但最后一条记录 id 值仍为 10,000（如果最后一条记录没有删除）。

如何使用 1 个 sql 查询显示已删除的记录？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T14:28:47.603

我认为最简单的方法是拥有一个只有 id 的虚拟/临时表。1-1000 然后左连接到该表。

但是，一旦完成，请务必从您的虚拟/临时表中删除“已删除”的记录。否则，他们每次都会出现。

**>> 编辑 <<** 您可以自行加入以确定您是否缺少 ids....

```
select a.id + 1 MissingIds
from <table> a
left join <table> b
  on a.id = b.id - 1
where b.id is null
  and a.id < 10000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T14:49:38.737

我用[这个答案](https://stackoverflow.com/questions/4340793/how-to-find-gaps-in-sequential-numbering-in-mysql)作为参考。

您可以使用以下查询来查找差距，这实质上将为您提供已删除的记录“范围”。例如，在下面的示例中，您在最终结果中返回 2 行，其值为 2 和 3，以及 6 和 7。因此您知道 ID 为 2 到 3 的行已被删除，并且 ID 为6 到 7 行已被删除（总共 4 行已删除）。

**我相信这满足了您在“1 SQL 查询”中获得最终结果的要求，并且不使用中间表或虚拟表。**

```
delimiter $$
use test
$$

create table mytable (id int not null auto_increment, name varchar(100), primary key (id));
$$

insert into mytable (name) values('a')$$
insert into mytable (name) values('b')$$
insert into mytable (name) values('c')$$
insert into mytable (name) values('d')$$
insert into mytable (name) values('e')$$
insert into mytable (name) values('f')$$
insert into mytable (name) values('g')$$
insert into mytable (name) values('h')$$

delete from mytable where id = 2$$
delete from mytable where id = 3$$
delete from mytable where id = 6$$
delete from mytable where id = 7$$

SELECT (t1.id + 1) as gap_starts_at
     , (SELECT MIN(t3.id) -1
          FROM mytable t3 
         WHERE t3.id > t1.id) as gap_ends_at
  FROM mytable t1
 WHERE NOT EXISTS (SELECT t2.id FROM mytable t2 WHERE t2.id = t1.id + 1)
HAVING gap_ends_at IS NOT NULL 
```

输出：

```
gap_starts_at  gap_ends_at
2              3
6              7 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T14:29:10.610

您可能会在此处发现此 sql 有用 [http://www.sqlservercurry.com/2009/06/find-missing-identity-numbers-in-sql.html](http://www.sqlservercurry.com/2009/06/find-missing-identity-numbers-in-sql.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T17:39:11.470

因此，首先，我将展示生成 10.000 条记录的最简单方法。没有巨大的查询，没有变量。执行时间：~3ms。[关联](http://sqlfiddle.com/#!2/fbf0b/2)

现在关于我承诺的那个触发器。[关联](http://sqlfiddle.com/#!2/ab17a/1)

如您所见，创建一个非常容易。请记住，触发器不仅不需要各种连接更好，而且您还可以存储日期、用户 ID 等（非常可扩展的示例）。**联接触发的要点是：您不在乎曾经/现在/将会有多少条记录。**您不需要严格控制尺寸。这就是为什么我称*sam yi*的回答不够专业。抱歉造成误会，我敢肯定我们都不想侮辱任何人。

通过创建这个例子，我确实学到了一些东西。希望你也这样做了:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-19T14:48:10.923

```
DECLARE @myTestTable1 TABLE
(
id INT IDENTITY(1,1) NOT NULL
,testVal int
)

DECLARE @increment AS int = 1

WHILE (@increment <= 10000)
BEGIN
INSERT INTO @myTestTable1
VALUES (@increment)

SET @increment += 1
 END

DELETE FROM @myTestTable1 WHERE id IN (100,200,300)

--SELECT * FROM @myTestTable1

 ;WITH Missing (missnum, maxid)
 AS
 (
  SELECT 1 AS missnum, (select max(id) from @myTestTable1)
  UNION ALL
   SELECT missnum + 1, maxid FROM Missing
   WHERE missnum < maxid
   )
     SELECT missnum
     FROM Missing
     LEFT OUTER JOIN @myTestTable1 tt on tt.id = Missing.missnum
     WHERE tt.id is NULL
     OPTION (MAXRECURSION 0); 
```

但这需要很多时间。我们必须减少时间。

# rubygems - 我们如何修复“gem rake-hooks (1) has an invalid gemspec”？

> ID：11103021
> 
> 赞同：0
> 
> 时间：2012-06-19T14:21:50.667
> 
> 标签：rubygems

这个问题来自一位关心的用户。我们正在尝试使用 rake-hooks gem，但`bundle install`给我们一个错误：

```
Unfortunately, the gem rake-hooks (1) has an invalid gemspec. As a result, Bundler cannot install this Gemfile. Please ask the gem author to yank the bad version to fix this issue. For more information, see http://bit.ly/syck-defaultkey. 
```

我认为这对 gem 所有者来说是一件简单的事情，所以我让他们知道了这个问题 (https://github.com/guillermo/rake-hooks/issues/10)。时间飞逝。我忘记了。

然后，需求再次出现。这次我分叉了这个项目并尝试了很多方法来修复它，包括通过`bundle gem rake-hooks`. 我仍然收到同样的错误。

是什么赋予了？新铸造的 gemspec 怎么可能无效？
您可以在以下位置找到这两个 gemspecs：[https ://gist.github.com/2954475](https://gist.github.com/2954475)

[如果有人可以在https://github.com/guillermo/rake-hooks](https://github.com/guillermo/rake-hooks)上查看 gemspec，我将不胜感激。

谢谢，马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:51:50.157

如果您使用的是 bundler 1.1.x 这可能是问题所在

[https://github.com/carlhuda/bundler/issues/1715](https://github.com/carlhuda/bundler/issues/1715)

这是解决方案：

```
bundle install --full-index 
```

bundler 1.1.x 和 Rubygems 索引之间似乎存在问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T02:48:40.307

我的调查表明 rake-hooks 版本 1 导致了这个问题。直到我调试时，我才意识到错误消息“rake-hooks (1)”中的“1”是一个版本号。缺少“.0”，如“1.0”，让我失望。

即使我们指定版本 1.2.3 或安装本地软件包，版本“1”会影响我们似乎有点奇怪，但是...... Rubygems 家伙建议我们为 ruby​​gems 拉出有问题的版本。

我已要求 gem 所有者删除有问题的版本。

# android - Phonegap 下载器插件，将数据保存到 /data 文件夹

> ID：11103022
> 
> 赞同：1
> 
> 时间：2012-06-19T14:21:55.957
> 
> 标签：android, cordova, phonegap-plugins

我正在使用 jquery-mobile 和 phonegap 为 Android 开发一个应用程序。我正在使用[Downloader Plugin](https://github.com/phonegap/phonegap-plugins/tree/master/Android/Downloader)，以便从远程服务器下载一些文件。

我已经安装了插件并按照文档中的建议调用它：

```
window.plugins.downloader.downloadFile("http://server/file.txt", {overwrite: true, dirName: 'sdcard/MyFolder'}, 
      function(res) {
        alert(JSON.stringify(result));
    }, function(error) {
        alert(error);
    }
); 
```

到目前为止它工作得很好。

我要做的是将下载的数据保存在根目录下。特别是在数据文件夹 ( `/data/MyAppData`) 中。可以使用这个插件吗？

也欢迎其他实现此功能的解决方案（例如，使用 phonegap 的 File API）

# html - 根据 Rails 3 应用程序中的字段值修改视图？

> ID：11103027
> 
> 赞同：0
> 
> 时间：2012-06-19T14:22:04.633
> 
> 标签：html, ruby-on-rails-3, helper

我的 Rails 3 应用程序视图之一中有以下代码：

```
<ul>
<li style="position:relative">
<b>MR</b> - 18 Jun. 2012 -  11:07<br />
<p style="width:85%">Paid by Cheque  000562</p>
<span style="position:absolute;top:0px;right:0px;text-align:right">&pound;0,00<br /><b>Balance: -&pound;7,36</b></span>
</li>
<hr />
<li style="position:relative">
<b>JJ</b> - 01 May. 2012 -  09:35<br />
<p style="width:85%">label 2 Packets Recovery -Rabbit</p>
<span style="position:absolute;top:0px;right:0px;text-align:right">&pound;0,00<br /><b>Balance: &pound;7,36</b></span>
</li>
<hr /> 
```

这显示内容如下：

![截屏](../Images/71c948d6b67b03965e879b0c4b656273.png)

原始 Rails 代码如下：

```
<ul>
<% @animal.clinicals.each do |clinical| %>
<li>
<b><%= clinical.UserID %></b> - <%= clinical.FullDateTime.strftime("%d %b. %Y -  %H:%M") %><br />
<p><%= clinical.ClinicalText %></p>
<span><%= number_to_currency(clinical.Fees, :unit => "&pound;", :separator => ",", :delimiter => "") %><br /><b>Balance: <%= number_to_currency(clinical.LineBalance, :unit => "&pound;", :separator => ",", :delimiter => "") %></b></span>
</li>
<hr />
<% end %>
</ul> 
```

我要做的是根据 ClinicalText 字段中的值更改 HTML 代码。例如，以下是该字段的可能条目：

```
label 2 Packets Recovery -Rabbit
Surcharge (Credit)
disp 250 Tabs... 
```

因此，如果 ClinicalText 开头包含“标签”，我想删除单词标签并向 li 添加 css 样式。同样，如果它包含 'Surcharge' 或 'disp' 我想为 li 添加不同的 css 样式。

我可以想到一种在视图中使用 if、else 和 elseif 语句的方法，但我更希望这是某种帮助器。

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T17:20:33.740

我会编写一个生成整个`<p>`标签的助手 - 这将使您更容易添加类，然后您可以使用 CSS 设置样式。您可以使用`case`（`switch`在大多数其他语言中）语句：

```
def format_clinical_text(txt)
    cls = ''

    case(txt)
    when /\Alabel/i
        txt.sub!(/label\s*/, '')
        cls = 'label'
    when /\Asurcharge/i
        cls = 'surcharge'
    when /\Adisp/i
        cls = 'disp'
    end

    return "<p class=\"#{cls}\">#{ERB::Util.h(txt)}</p>".html_safe
end 
```

然后这一行：

```
<p><%= clinical.ClinicalText %></p> 
```

会成为：

```
<%= format_clinical_text(clinical.ClinicalText) %> 
```

就是这样！请注意，这些正则表达式不区分大小写，但要求触发词是输入字符串中的第一件事（没有空格或小写字母）；此外，只有`"label"`大小写会删除它匹配的单词。这就是我解释你的问题的方式，但我可能是错的。根据需要进行调整。

希望有帮助！

# c# - 普通的旧 HTTP GET 使用 用 ASP.NET 标记

> ID：11103028
> 
> 赞同：1
> 
> 时间：2012-06-19T14:22:05.013
> 
> 标签：c#, asp.net, webforms, progressive-enhancement

我有一个使用主页面的渐进增强构建的 WebForms 站点。显然，ASP.NET 默认注入标签，因此它可以管理回发。

我需要一种方法来执行以下操作

```
<form action="new_url" method="get">
 <input ... />
</form> 
```

显然，.NET 正在用外部拦截请求并将其发回给自己。我可以用 JavaScript 做到这一点，但我会打破我网站的渐进增强策略。如果没有本质上构建一个 ASP.NET 服务器控件来管理重定向，这是不可能的吗？

谢谢马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:38:22.813

标签应该在您的源文件中清晰可见，带有`runat="server"`. 但是，应该不可能在另一个表单标签中添加另一个表单标签*，*并且不能有两个`<form runat="server">`.

因此，实现此目的的一种方法是将表单附加到现有表单*之后*。您当前的 MasterPages / Pages / UserControls 设置可能无法实现，特别是如果您`<form runat="server">`在 MasterPage 中有标签。

因此，您可以使用嵌套母版页重新评估您的结构，以便您可以选择哪些页面将实际使用 PostBack 功能并`<form>`为其他页面使用较少的 MasterPage。

另一种方法是使用 javascript 从某些字段构建 URL。

看看这篇文章，它可能会对你有所帮助：[ASP.NET 页面上的多个表单](https://stackoverflow.com/questions/91350/multiple-forms-on-asp-net-page)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:36:56.480

使用表单和 ASP.net，您可以访问 Get 变量

```
Page.Request.QueryString[<param>]; 
```

它是这样使用的

```
<form action="new_url" method="get">
    <input type="text" id="txtName" name="name" />
</form> 
```

在您的 page_load 方法或提交页面中，您可以使用此代码访问输入字段

```
Page.Request.QueryString["name"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T14:30:54.433

我相信 Page 类上有一个名为“PostBackUrl”的属性，您可以使用它来告诉 ASP.NET 将回发发送到哪里。

我不记得它是页面还是链接按钮类之一，但只是谷歌“PostBackURL”，你应该会得到一些好的结果。

# iphone - 将int保存到内部存储器xcode iphone dev

> ID：11103031
> 
> 赞同：2
> 
> 时间：2012-06-19T14:22:15.537
> 
> 标签：iphone, ios, xcode

我有一个`int`名为的值`score`，我想将其保存到手机的内存中，这样即使游戏关闭并重新打开，这也是永远不会删除的高分，

有人可以建议一种方法来实现吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T14:25:39.073

使用`NSUserDefaults`.

保存：

```
int score = 12345;
[[NSUserDefaults standardUserDefaults] setObject:[NSNumber numberWithInt:score] forKey:@"HIGHSCORE"]; 
```

装载：

```
int score = [[[NSUserDefaults standardUserDefaults] objectForKey:@"HIGHSCORE"] integerValue]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T14:25:00.103

您应该阅读 Apple 文档`NSUserDefaults`

参见[NSUserDefaults](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html)和[Preferences and Settings 编程指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/UserDefaults/Introduction/Introduction.html#//apple_ref/doc/uid/10000059i)

```
[[NSUserDefaults standardUserDefaults] setInteger: score forKey: @"Score"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T15:12:25.313

在我看来，保存最佳分数的简单方法是将分数保存为字符串值，并在需要时将其召回。

```
//this example assume that high score is in text    
NSString *SaveHighScore = HighScore.text;
    NSUserDefaults *defaultsHighScore = [NSUserDefaults standardUserDefaults];
    [defaultsHighScore setObject:SaveHighScore forKey:@"savedHighScore"];
    [defaultsHighScore synchronize]; 
```

并回忆

```
 NSUserDefaults *defaultsHighScore = [NSUserDefaults standardUserDefaults];
NSString *loadHighScore = [defaultsHighScore objectForKey:@"savedHighScore"];
[HighScore setText :loadHighScore]; 
```

# css - 是否可以让我的 CSS 列的高度看起来相等？

> ID：11103037
> 
> 赞同：1
> 
> 时间：2012-06-19T14:22:25.020
> 
> 标签：css

好吧，在设计这个网站时，我认为将所有内容放在左侧列或右侧列中会很聪明。我在左边有一个透明的标题，在右边有另一个透明的位，然后两边都有一个白色的背景。现在花了一点时间在它上面，我不再喜欢它的外观，当一侧完成而另一侧继续向下到页面底部时，如下所示：

![在此处输入图像描述](../Images/f80582c2c8cea71f56fd839fb7342705.png)

在上面的图片中，我希望左侧的背景颜色继续向下，不幸的是，由于到目前为止我布置课程的方式，我无论如何都看不到“修复”这个问题。

这有点厚颜无耻，但我想知道是否有经验的人可以解决这个问题？或者对此事有什么明智的建议？

* * *

编辑：这是复制粘贴墙的替代方法：http: [//jsfiddle.net/TZucm/](http://jsfiddle.net/TZucm/) 这有点乱，但你明白了，你可以在 jsfiddle 中看到右边的列在左边之前很久就完成了。我想知道是否有可能在不完全重写我的 div 结构的情况下继续使用白色背景。

* * *

我的 css （简化，我编辑了你不需要知道的任何进一步的 div 类）：

```
* {margin: 0; padding:0;}
body
{
font: normal 100% 'Poiret One', 'Trebuchet MS', sans-serif;
color: Grey;
background-image: url('Images/background_gradient.png');
background-repeat:repeat-x;
background-color: #d4ffaa;
margin: 0 auto;
height: auto;
max-width: 90%; 
}

h2
{ 
margin: 0.6em 0;
color: Grey;
border-bottom: 2px solid #d4ffaa; 
font: normal 2em 'Poiret One', 'Trebuchet MS', sans-serif;
}

#central_container
{
width: 100%;
margin: 0 auto;
height: 100%;
float: left;
}
#leftside_container
{
float: left;
width: 67.1%; 
clear: left;
}
    #header_container
    {
    width: 100%;
    max-height: 300px;
    height: 15em;
    }
        #header_title
        {
        width: 100%;
        height: 80%;
        }
            #header_title h1{ font-size: 4em; color: Ivory;}

        #navbar_container
        {
        width: 100%;
        height: 20%;
        }
            //edited

        #currentpage_container
        {
        background-color: Ivory;
        width: 100%;
        height: 20%;
        }
            #currentpage_content
            {
            font-family: 'Trebuchet Ms';
            padding: 1em 3em;
            }
            //edited

#rightside_container
{
float: right;
width: 33%;
}
    #register_container
    {
    width: 100%;
    max-height: 300px;
    height: 15em;
    }
        //edited

    #contact_container
    {
    background-color: Ivory;
    width: 100%;
    }
    #contacts_content{ padding: 1em 3em; }
        //edited

    #logos_content
    {
    padding: 0.5em 3em;
    height: 150px;
    }
        //edited

    #social_content
    {
    padding: 1em 3em;
    } 
```

我的 html 以防万一（请记住，未针对相关性进行编辑）：

```
<!DOCTYPE HTML>
<html lang="en">

<head>
    <title>Verge Green IT</title>
    <link href='http://fonts.googleapis.com/css?family=Poiret+One' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

    <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">stLight.options({publisher: "ur-ea3b6db-3e14-19ab-cd0a-b82a99b4706"}); </script>

    {% load static %}
    <script type="text/javascript" src="{% static "JS/CycleLogos.js" %}" defer="defer"></script>
    <link rel="stylesheet" href="{% static "CSS/base.css" %}" type="text/css" />
</head>

<body> 
<div id="central_container">

<!--Left-side Current-page Content-->
<div id="leftside_container">

    <!--Header-->
    <div id="header_container">

        <div id="header_title">
        <h1>Green IT at The Verge</h1>
        </div>

        <!--Navbar-->
        <div id="navbar_container"> 
        <div class="navbar_links">
        <ul>
            <li><a href="">Home</a></li>
            <li><a href="About">About</a></li>
            <li><a href="Speakers">Speakers</a></li>
            <li><a href="Exhibitors">Exhibitors</a></li>
            <li><a href="Agenda">Agenda</a></li>
            <li><a href="Location">Location</a></li>
        </ul>
        </div>
        </div>

    </div>
    <!--Current Page Contents-->
    <div id="currentpage_container">
        <div id="currentpage_content">
        <h2>Currentpage Content</h2>
        <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
        <h2>I'm another header</h2>
        <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididus nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p><p>
        "Lorem ipsum dolor sit amet, voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
        </div>
    </div>

</div>

<!--Right-side Every-page Content-->
<div id="rightside_container">
    <div id="register_container">
        <div class="bubble"> <p>Register now > For free entry to the expo</p></div>
    </div>
    <div id="contact_container">
        <div id="contacts_content">
        <h2>Contact</h2>
        <p class="text">
        For more information on the event or if your interested in Speaking / Exhibiting don't hesitate to get in touch:  </p>
        <p class="contactNum"> 02082394073 </p>
        <p class="contactEmail"> info@vergegreenit.com </p>
        </div>

        <div id="logos_content">
        <h2>Associates</h2>
        <div id="img0" class="logo">
        <img src="{% static "CSS/Images/phone_icon.gif" %}"/>
        </div>
        <div id="img1" class="logo2">
        <img src="{% static "CSS/Images/email_icon.gif" %}"/>
        </div>
        <div id="img2" class="logo">
        <img src="{% static "CSS/Images/phone_icon2.gif" %}"/>
        </div>
        <div id="img3" class="logo2">
        <img src="{% static "CSS/Images/email_icon2.gif" %}"/>
        </div>
        </div>

        <div id="social_content">
        <h2>Share Event</h2>
        <span class='st_linkedin_large' displayText='LinkedIn'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
        <span class='st_facebook_large' displayText='Facebook'></span>
        </div>
    </div>
</div>

</div> 
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T14:37:00.577

你可以在 CSS 中使用这个相等的高度列来做到这一点

您将容器设置为隐藏溢出，然后在每个 div 上添加负边距底部和相等的正填充底部。

```
#container { overflow: hidden; }
#container div { float: left; background: #ccc; width: 200px; margin-bottom: -2000px; padding-bottom: 2000px; }
#container .col2 { background: #eee; }

<div id="container">
   <div>
        <p>Content 1</p>
   </div>
   <div class="col2">
        <p>Content 2</p>
        <p>Content 2</p>
        <p>Content 2</p>
        <p>Content 2</p>
   </div>
</div> 
```

如果你只是想要一些东西而不用 CSS，那么你也可以使用 jQuery：

```
// JQuery function for equal height divs
function equalHeight(group) {
    var tallest = 0;
    group.each(function() {
        var thisHeight = $(this).height();                                      
        if(thisHeight > tallest) {
            tallest = thisHeight;
        }
    });
    group.height(tallest);
}   

// Set the divs to have the height equaliser applied to them. 
equalHeight($('.equalColumns')); 
```

如果您使用此处的代码并将类 equalColumns 添加到您的两列中，jQuery 应该为您完成其余的工作。

# javascript - Cufon.refresh 意外行为

> ID：11103038
> 
> 赞同：0
> 
> 时间：2012-06-19T14:22:27.860
> 
> 标签：javascript, cufon

这是我的问题。我有以下代码（我去掉了不相关的部分）：

```
 $('.poll').click(function (e) {
         $.post('/my/ajax/script', {}, function(d) {
             j = $.parseJSON(d);
             var el = $('#my_msg').find('.message-text').find('p'); 
             // That p has class which was consumed by Cufon at document ready
             el.html(j.message);
             $('#my_div').fadeIn(fadeTime, function() { Cufon.refresh(); });                      
         });
     }
     e.preventDefault();
 }); 
```

如果我删除`Cufon.refresh`回调，一切都会按预期工作（包含弹出`j.message`窗口）。但是如果我离开它，文本只会部分呈现（最后一个单词丢失，整个文本不可见）。

这种行为的原因可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T20:54:32.757

我找到了解决方案，而且非常简单。在我的页面的头部加载了两种 Cufon 准备的字体，用于不同的（不相交的）选择器。在关于第一个（所需）字体的行之后，`Cufon.replace`被调用。由于没有其他字体，Cufon 用这种字体替换所有给定的字体。但在那之后是第二种字体。

在这种情况下，`Cufon.refresh()`奇怪地用最后一个字体替换了它之前使用的每个选择器。发生这种情况是因为第一`Cufon.replace(...)`行没有指定字体。

`Cufon.replace(selector, fontOptions)`而不是`Cufon.refresh()`解决它。

# android - android webview 是如何工作的？它是否使用客户端-服务器关系？它会导致服务器端代码错误吗？

> ID：11103040
> 
> 赞同：2
> 
> 时间：2012-06-19T14:22:40.590
> 
> 标签：android, webview, client-server, android-webview, server-side

简而言之，我想知道 android webview 在幕后是如何工作的。我搜索了互联网，找不到讨论 webview 类的内部工作的文章或资源。它本质上是一个用于在浏览器中查看网页的模拟器，对吧？

这是否意味着它采用了严格的客户端-服务器关系，类似于 Android 浏览器，还是比这更复杂？

是否有任何理由网页将在 Android 浏览器中完美显示，但在通过 webview 从 Android 应用程序中打开时会产生服务器端错误？也就是webview会不会诱发服务端代码错误？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T16:16:04.030

您的问题似乎基于其他人已经解决的一些误解。

相反，我将评论其他人忽略的内容：

虽然默认的 Android 浏览器*基于*与 webview 相同的引擎，但它以未完全记录/非公共 api 的方式进行了大幅扩展，并且**实际上会表现不同**。所以是的，有很多原因可以在默认浏览器中工作，但在 web 视图中却不行。其中一些差异可以通过 webview 的配置选项轻松纠正，其他差异将非常棘手，您可能需要查看替代浏览器的来源以找到可跨 android 版本移植的解决方案（就像浏览器一样它与为其构建的特定版本耦合）。

客户端行为的差异是否会导致服务器端错误取决于服务器对客户端的假设，以及它对意外客户端行为的鲁棒性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T16:09:38.650

> 它本质上是一个用于在浏览器中查看网页的模拟器，对吧？

仅限于任何 Web 浏览器“是在浏览器中查看网页的模拟器”。`WebView`是位于 Safari、Chrome 等核心的 WebKit Web 资产检索和渲染引擎。

> 这是否意味着它采用了严格的客户端-服务器关系，类似于 Android 浏览器

AOSP Android 浏览器以及除 Opera 和 Mozilla 之外的大多数 Android 浏览器都*使用* `WebView`. 因此，您在服务器端使用 . 时看到的行为`WebView`通常应该与`WebView`.

> 也就是webview会不会诱发服务端代码错误？

不比任何其他浏览器都多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T14:29:06.443

考虑 webview 的最佳方式是它是没有地址栏的本机 web 浏览器。它将以与普通浏览器完全相同的方式呈现 HTML、CSS、javascript 等。

我看不出谷歌为什么会创建本机浏览器然后忽略该代码而不将其扩展为其 SDK 中的 webview 的任何原因？

# google-maps - 谷歌地理编码服务是否不如谷歌地图搜索引擎强大？

> ID：11103046
> 
> 赞同：3
> 
> 时间：2012-06-19T14:23:06.913
> 
> 标签：google-maps, google-maps-api-3

我正在使用谷歌地图地理编码服务来对一些地址进行地理编码，我意识到某些地址出现在谷歌地图搜索引擎中，但谷歌地图地理编码服务无法访问它们。

例如，地理编码服务找不到以下地址，但可以通过谷歌地图找到。

地址：雷纳克里斯蒂娜阿尔赫西拉斯酒店

[http://maps.googleapis.com/maps/api/geocode/json?address=HOTEL+REINA+CRISTINA+ALGECIRAS&sensor=true](http://maps.googleapis.com/maps/api/geocode/json?address=HOTEL+REINA+CRISTINA+ALGECIRAS&sensor=true)（发现阿尔赫西拉斯不是酒店）

[https://maps.google.es/maps?q=HOTEL+REINA+CRISTINA+ALGECIRAS&hl=es&ie=UTF8&sll=36.123247,-5.444669&sspn=0.014525,0.020471&hq=HOTEL+REINA+CRISTINA&hnear=阿尔赫西拉斯,+C%C3% A1diz,+Andaluc%C3%ADa&t=m&z=16&iwloc=A](https://maps.google.es/maps?q=HOTEL+REINA+CRISTINA+ALGECIRAS&hl=es&ie=UTF8&sll=36.123247,-5.444669&sspn=0.014525,0.020471&hq=HOTEL+REINA+CRISTINA&hnear=Algeciras,+C%C3%A1diz,+Andaluc%C3%ADa&t=m&z=16&iwloc=A)

有人可以证实吗？我是否需要像 google maps api 这样的特殊许可证才能开展业务？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:46:51.953

尝试改用[Places API](https://developers.google.com/maps/documentation/places/#PlaceSearchRequests)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:49:09.767

API 地理编码器查找地址（有极少数非常明显的例外）。地图地理编码器也使用其他索引，类似于 Places API。如果您想在没有完整邮政地址的情况下查找感兴趣的地方，请使用 Places API。

# android - 我的安卓应用程序泄漏，我应该检查什么？

> ID：11103049
> 
> 赞同：1
> 
> 时间：2012-06-19T14:23:25.580
> 
> 标签：android, android-layout, memory-leaks

我的安卓应用程序泄漏，我应该检查什么？

我看了一下[避免内存泄漏](http://developer.android.com/resources/articles/avoiding-memory-leaks.html)，并在活动的 onDestroy() 方法中添加了一些 unbindDrawables() 调用以进行清理，但没有任何改变。我还用 getApplicationContext() 替换了每个 getContext() 调用，但也没有任何改变。

我在 DDMS eclipse 透视图中监控堆大小：当我第一次启动应用程序时，分配了 3Mb，在 10 次关闭/重新启动后，分配了 10Mb。

我的视图主要由 ViewFlippers 和许多继承自 LinearLayout 子类的嵌套布局组成。

编辑：

运行 MAT 以识别泄漏嫌疑人后，主要问题是：

```
16 instances of "org.apache.http.impl.conn.tsccm.ConnPoolByRoute", 
loaded by "<system class loader>" occupy 4,000,328 (44.08%) bytes. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:09:56.440

如果您在`getApplicationContext()`整个地方都在使用，那么您肯定会泄漏内存！这通常是个坏主意。您需要在适当的地方使用适当的上下文。

进行堆转储，使用分析器（如 MAT 或 jhat）并查看不应该存在的实例（应该被销毁的活动）。追溯参考链，找出它们没有被回收的原因。

# android - Image has disappeared from drawable folder?

> ID：11103065
> 
> 赞同：1
> 
> 时间：2012-06-19T14:23:52.303
> 
> 标签：android, validation, drawable

In my code, I have two text boxes that validate input as the user types, and they either display a red cross or a green tick to the right of the box depending on whether the current input is valid or not. I had the red cross image stored in my drawable folder.

Everything was working fine until I decided to get rid of my splash screen. I deleted the class and XML layout file and changed the default activity to 'Login', the one with the tick/cross validation.

Now instead of showing a cross when there is incorrect input, a red square is shown. There are no error messages saying that the image can't be found, but I couldn't see it in the drawable folder, so I copied the image across again with the same name. I can now see the image in the folder after refreshing the project, but still the same thing happens.

I've tried restarting eclipse to no avail. Any ideas?

The android manifest file:

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.crowded.media"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:targetSdkVersion="8" 
              android:minSdkVersion="8"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".Login"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name="RegisteredUser"></activity>
        <activity android:name="OnePennyChallenge"></activity>
        <activity android:name="GamesScreen"></activity>
        <activity android:name="SafeCracker"></activity>

    </application>

</manifest> 
```

The code where I change the image:

```
 // Add key listener to email edittext and validate as user enters data
    email.addTextChangedListener(new TextWatcher() {

        @Override
        public void afterTextChanged(Editable s) {
            String enteredEmail = email.getText().toString();

            if (validateEmail(enteredEmail) == true) {
                image1.setImageResource(R.drawable.greentick);
            }

            else {
                image1.setImageResource(R.drawable.redcross);
            }
        } 
```

Screen shot showing the res/drawable folder:

![enter image description here](../Images/5db950be2fe3ee8394589d1971fb397e.png)

And the mysterious red box image:

![enter image description here](../Images/f7a5af9b3e4027287f630a744d4bb1f8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:54:02.060

I had a problem like this.You can solve it:
1-Change an Id of a view or layout in one layout that is in your res folder.(for example from "@+id/textView" to "@+id/textView1").
2-Do save all(Ctrl + Shift + s).
3-Change that Id to it's previous value(from "@+id/textView1" to "@+id/textView").
4-Do save all(Ctrl + Shift + s) again.
This must solve your problem.
It may be a bug in eclipse ADT and I heard that it has been resolved in ADT 10.

# javascript - how can I set my objects in array?

> ID：11103072
> 
> 赞同：1
> 
> 时间：2012-06-19T14:24:32.520
> 
> 标签：javascript, jquery

I have lots of details. I want to stack them within an array, can I do that?

```
detailObj = {

    textDetail: "hello this is my text!",
    id: "tooltip_businessDetails"

};

var idArray[0] = detailObg; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T14:26:44.363

Yes:

```
var idArray = [
    {
        textDetail: "hello this is my text!",
        id: "tooltip_businessDetails"
    },
    {
        textDetail: "another",
        id: "anotherid"
    },
    // ...and so on
]; 
```

Or if you already have variables pointing at them:

```
var idArray = [detailObj, anotherDetailObj, yetAnotherDetailObj]; 
```

You can also do it dynamically after array creation:

```
var idArray = [];
idArray.push(detailObj);
idArray.push({
    textDetail: "another",
    id: "anotherid"
});
idArray.push(yetAnotheretailObj); 
```

And you can do it the way you tried to, just with a slight change:

```
var idArray = [];
idArray[0] = detailObj;
idArray[1] = anotherDetailObj; 
```

Any time you set an array element, the array's `length` property is updated to be one greater than the element you set if it isn't already (so if you set `idArray[2]`, `length` becomes `3`).

Note that JavaScript arrays are *sparse*, so you can assign to `idArray[52]` without creating entries for `0` through `51`. In fact, JavaScript arrays [aren't really arrays at all](http://blog.niftysnippets.org/2011/01/myth-of-arrays.html).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T14:26:46.933

instead of doing this thing use below code

```
var arr = [];

arr.push(detailobj); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T14:27:39.833

You can use object-oriented approach:

```
var detail = function(id, text) {
    this.id = id;
    this.text = text;
};

​var arr = [];
arr.push(new detail("myid", "mytext"));

console.log(arr); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T14:26:12.767

> I want to stack them within an array, can I do that ?

Yes you can do that. Array in JavaScript are flexible and can hold objects as well.

**Example:**

```
var myArr = [];
myArr.push(detailObj); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T14:26:37.840

for example:

```
var idArray = [detailObj1, detailObj2]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-19T14:28:46.553

Another one :

```
var myArray = new Array();
myArray.push(<your object>) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-19T14:29:01.003

```
detailObj = {

    textDetail: "hello this is my text!",
    id: "tooltip_businessDetails"

};

var array = [];
for(var key in detailObj) {
   array.push(detailObj[key]);
}
alert(array[0]); 
```

# c - 在 OpenGL 窗口中绘制 2D 叠加层（文本 + 图标）

> ID：11103073
> 
> 赞同：0
> 
> 时间：2012-06-19T14:24:33.987
> 
> 标签：c, windows, opengl

我需要在 OpenGL 场景上绘制 2D 叠加层。OpenGL 用于 2D 动画，只是在正交投影中绘制带纹理的 2D 矩形，这是绘图代码：

```
//视口设置为整个窗口客户区
// m_fRectX, m_fRectY 在 OnSize 中计算并定义
// 用于图像绘制的子矩形
// m_nImageWidth, m_nImageHeight 是纹理尺寸

glClear(GL_COLOR_BUFFER_BIT);
glEnable(GL_TEXTURE_RECTANGLE_ARB);
glBegin(GL_TRIANGLE_STRIP);

glTexCoord2d(0.0f, (float)m_nImageHeight);
glVertex2d(-m_fRectX, -m_fRectY);
glTexCoord2d((float)m_nImageWidth, (float)m_nImageHeight);
glVertex2d(+m_fRectX, -m_fRectY);
glTexCoord2d(0.0f, 0.0f);
glVertex2d(-m_fRectX, +m_fRectY);
glTexCoord2d((float)m_nImageWidth, 0.0f);
glVertex2d(+m_fRectX, +m_fRectY);

glEnd();
交换缓冲区（m_hDC）；

```

我的要求：

1.  **性能至关重要**。

2.  允许使用特定于 Windows 的 API。

3.  需要文本和图像叠加（图标样式）。

4.  定义覆盖位置和大小的唯一因素是窗口客户区大小（在我的情况下等于 OpenGL 视口）。

什么技术适合这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:16:54.603

使用 OpenGL 绘制文本的最高效方法是使用[位图字体](http://www.gamedev.net/topic/330742-quick-tutorial-variable-width-bitmap-fonts/)。这使用了小的纹理映射四边形来渲染文本。不过，它也有一些缺点。这种渲染很难（[但并非不可能](http://bitsquid.blogspot.com/2010/04/distance-field-based-rendering-of.html)）从字体纹理烘焙的分辨率放大。我喜欢并使用[AngelCode 的 Bitmap Font generator](http://www.angelcode.com/products/bmfont/)，但有很多类似的工具。您可以选择适合您需求的一种。

另一种选择是使用[大纲字体](http://nehe.gamedev.net/tutorial/outline_fonts/15004/)。这可以在不损失质量的情况下放大或缩小，但使用[wglUseFontOutlines](http://msdn.microsoft.com/en-us/library/windows/desktop/dd374393%28v=vs.85%29.aspx)。

第三个也是最难的（但质量最好的）是自己渲染文本。[Microsoft Research 的这篇](http://research.microsoft.com/en-us/um/people/cloop/loopblinn05.pdf)论文有一些非常酷的技术可以在 GPU 上渲染矢量图。[这篇 GPU Gems](http://http.developer.nvidia.com/GPUGems3/gpugems3_ch25.html)文章向我们展示了如何操作。

在性能、复杂性和质量之间有许多权衡。在决定使用其中一种之前，了解每种方法的优缺点非常重要。

# oop - MATLAB：将一个类从空实例实例化为“空白”实例

> ID：11103079
> 
> 赞同：3
> 
> 时间：2012-06-19T14:24:54.720
> 
> 标签：oop, class, matlab

为什么我的 Instantiate 函数没有创建 That 的“空白”实例？

我有以下最小类：

```
classdef That < handle
 properties
  This = ''
 end
 methods
  function Self = That(String)
   if exist('String','var') == 1
    Self.This = String;
   end
  end
  function Self = Instantiate(Self)
   if isempty(Self)
    Self(1,1) = That;
   end
  end
 end
end 
```

如果我跑

```
This = That;
disp(size(This))     % 1x1
disp(isempty(This))  % False 
```

一切都很好，我有一个“空白”类的实例

如果我跑

```
TheOther = That.empty;
disp(size(TheOther))     % 0x0
disp(isempty(TheOther))  % True
TheOther.Instantiate;  
disp(size(TheOther))     % 0x0   - Expecting 1x1
disp(isempty(TheOther))  % True  - Expecting False 
```

如您所见，运行我的 Instantiate 不起作用，我不明白为什么？当然它应该用一个非空但空白的实例替换空实例？

更新 ：

SCFrench 的链接指向创建空数组标题下的[http://www.mathworks.com/help/techdoc/matlab_oop/brd4btr.html](http://www.mathworks.com/help/techdoc/matlab_oop/brd4btr.html)，尽管这也不起作用：

```
function Self = Instantiate(Self)
 if isempty(Self)
  Blank = That;
  Props = properties(Blank)
  for idp = 1:length(Props)
   Self(1,1).(Props{idp}) = Blank.(Props{idp});
  end
 end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:54:34.933

*MATLAB按 value*传递句柄对象数组（包括 1×1“标量”数组）。句柄值是对对象的引用，可以用来改变对象的状态（即其属性），但重要的是，它不是对象本身。如果将句柄值数组传递给函数或方法，则实际上将数组的*副本*传递给函数，并且修改副本的维度对原始没有影响。事实上，当你打电话

```
TheOther.Instantiate; 
```

`That`您分配给的实例`Self(1,1)`作为 的输出返回`Instantiate`并分配给`ans`。

[这个指向](http://www.mathworks.com/help/matlab/matlab_oop/matlab-vs-other-oo-languages.html#bslvcv1)MATLAB Object-Oriented Design 文档部分的链接也可能有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:35:37.553

也许你应该把它变成一个静态函数：

```
methods (Static)
    function Self = Instantiate(Self)
        if isempty(Self)
            Self(1,1) = That;
        end
    end
end 
```

然后：

```
>> TheOther = That.empty;
>> size(TheOther)
ans =
     0     0
>> isempty(TheOther)
ans =
     1
>> TheOther = That.Instantiate(TheOther);
>> size(TheOther)
ans =
     1     1
>> isempty(TheOther)
ans =
     0 
```

# ruby - 在 Ruby 中获取降序范围序列

> ID：11103084
> 
> 赞同：7
> 
> 时间：2012-06-19T14:25:06.297
> 
> 标签：ruby, range

所以这会上升

```
(1..5).to_a => [1, 2, 3, 4, 5] 
```

但这并不

```
(5..1).to_a => [] 
```

我试图从任意天花板上得到一个降序。谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-19T14:27:26.250

试试这个：

```
5.downto(1).to_a # => [5, 4, 3, 2, 1] 
```

当然，也有对应的`#upto`。如果你想要步骤，你可以这样做：

```
1.step(10, 2).to_a # => [1, 3, 5, 7, 9]
10.step(1, -2).to_a # => [10, 8, 6, 4, 2] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-19T14:30:52.973

或者你可以试试这个： `(1..5).to_a.reverse # => [5, 4, 3, 2, 1]`

# php - 传递字符串时PHP MySQL查询错误

> ID：11103090
> 
> 赞同：2
> 
> 时间：2012-06-19T14:25:30.090
> 
> 标签：php, mysql

嗨，我遇到了 MySQL 查询未传递字符串变量的问题。

如果`$pass`仅包含数字，则可以正常工作。当它包含字母时，我得到`Cannot execute the query`错误。

例子：

```
$pass=123456     //works fine
$pass=z23456     //cannot execute the query
$_SESSION['id']=$pass;           //start session

if (isset($_SESSION['id'])) {

// Query database for user information.
$query = "SELECT RepName FROM RepTable WHERE RepNumber = 
".$_SESSION['id']."";
$result = mysql_query ($query) OR die ('Cannot execute the query.');
$rinfo = mysql_fetch_array ($result);
$RepInfo = $rinfo[0]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T14:26:35.157

尝试 ：

```
'".$_SESSION['id']."'" 
```

代替 ：

```
".$_SESSION['id']."" 
```

您还可以添加：

```
mysql_escape_string($_SESSION['id']) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:30:18.590

您应该在 mysql 中使用准备好的语句，它更安全（例如 SQL 注入）：

[http://php.net/manual/en/pdo.prepared-statements.php](http://php.net/manual/en/pdo.prepared-statements.php)

例如：

```
$stmt = $dbh->prepare("SELECT RepName FROM RepTable WHERE RepNumber = ?");
$stmt->execute($_SESSION['id']) 
```

# list - 通用列表的长度函数

> ID：11103091
> 
> 赞同：2
> 
> 时间：2012-06-19T14:25:35.003
> 
> 标签：list, function, generics, z3, axiom

[这篇文章](https://stackoverflow.com/questions/10473042/list-concat-in-z3)展示了如何公理化 Z3 内置列表的长度函数。但是，该函数是特定于排序的（此处为 Int），不适用于布尔列表或自定义排序。

```
; declare len as an uninterpreted function
(declare-fun len ((List Int)) Int)

; assert defining equations for len as an axiom
(assert (forall ((xs (List Int)))
  (ite (= nil xs)
    (= 0 (len xs))
    (= (+ 1 (len (tail xs))) (len xs))))) 
```

编码排序通用列表函数的最聪明的方法是什么？（如果我没记错的话，函数本身不能是通用的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:15:11.950

SMT 2.0 格式或 Z3*不*支持 SMT 2.0 脚本中的参数公理。一种替代方法是使用编程 API。`len`您可以创建为给定排序创建公理的函数。这是一个关于如何使用 Python API 进行操作的示例。

[http://rise4fun.com/Z3Py/vNa](http://rise4fun.com/Z3Py/vNa)

```
from z3 import *
def MkList(sort):
    List = Datatype('List')
    List.declare('insert', ('head', sort), ('tail', List))
    List.declare('nil')
    return List.create()

def MkLen(sort):
    List = MkList(sort)
    Len  = Function('len', List, IntSort())
    x    = Const('x', List)
    Ax   = ForAll(x, If(x == List.nil, Len(x) == 0, Len(x) == 1 + Len(List.tail(x))))
    return (Len, [Ax])

IntList = MkList(IntSort())
IntLen,  IntLenAxioms = MkLen(IntSort())
print IntLenAxioms
s = Solver()
l1 = Const('l1', IntList)
s.add(IntLenAxioms)
s.add(IntLen(l1) == 0)
s.add(l1 == IntList.insert(10, IntList.nil))
print s.check() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-30T12:42:02.957

您可以为此使用排序。该`len`函数是在用户定义的 sort 的通用 List 上定义的`T`。只有第一个`define-sort`链接`T`到一个`Int`类型。

```
(define-sort T () Int)
(define-sort MyList() (List T))

(declare-const listlen Int)
(declare-const a MyList)
(declare-const b MyList)
(declare-const c MyList)
(declare-const d MyList)
(declare-const e MyList)

(define-fun-rec len((l MyList)) Int
    (ite
        (= l nil)
        0
        (+ (len (tail l)) 1)
    )
)
(assert (= a nil))
(assert (= b (insert 2 a)))
(assert (= c (insert 8 b)))
(assert (= d (insert 6 c)))
(assert (= e (insert 10 d)))

(assert (= listlen (len e)))

(check-sat)
(get-model) 
```

# maven - Maven 似乎正在拉入具有测试范围的罐子

> ID：11103092
> 
> 赞同：5
> 
> 时间：2012-06-19T14:25:35.937
> 
> 标签：maven, maven-3, dependency-management

我有一个正在构建的战争模块，其中包括一些不应该包含的收缩包装罐。即：

```
WEB-INF/lib/shrinkwrap-api-1.0.0.jar
WEB-INF/lib/shrinkwrap-descriptors-api-base-2.0.0-alpha-2.jar
WEB-INF/lib/shrinkwrap-descriptors-spi-2.0.0-alpha-2.jar
WEB-INF/lib/shrinkwrap-resolver-api-1.0.0-beta-6.jar
WEB-INF/lib/shrinkwrap-spi-1.0.0.jar 
```

这些依赖项都在我们的 pom 中列为测试范围，因此它们不应该出现在我们的打包战争中。下面有更多信息，但我的问题是：为什么这些在这里。显然我缺少一些东西 - 它是什么/我在哪里可以找到它？

当我展示我的有效 pom 时，我看到了以下依赖项（这里省略了一堆东西）：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
...
  <dependencyManagement>
    <dependencies>
    ...
      <dependency>
        <groupId>org.jboss.shrinkwrap</groupId>
        <artifactId>shrinkwrap-extension-descriptors</artifactId>
        <version>1.0.0-beta-6</version>
        <scope>test</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap</groupId>
        <artifactId>shrinkwrap-api</artifactId>
        <version>1.0.0</version>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap</groupId>
        <artifactId>shrinkwrap-spi</artifactId>
        <version>1.0.0</version>
        <scope>runtime</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap</groupId>
        <artifactId>shrinkwrap-impl-base</artifactId>
        <version>1.0.0</version>
        <scope>runtime</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.resolver</groupId>
        <artifactId>shrinkwrap-resolver-api</artifactId>
        <version>1.0.0-beta-6</version>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.resolver</groupId>
        <artifactId>shrinkwrap-resolver-api-maven</artifactId>
        <version>1.0.0-beta-6</version>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.resolver</groupId>
        <artifactId>shrinkwrap-resolver-impl-maven</artifactId>
        <version>1.0.0-beta-6</version>
        <scope>runtime</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-api-base</artifactId>
        <version>2.0.0-alpha-2</version>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-api-javaee</artifactId>
        <version>2.0.0-alpha-2</version>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-api-jboss</artifactId>
        <version>2.0.0-alpha-2</version>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-gen</artifactId>
        <version>2.0.0-alpha-2</version>
        <scope>provided</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-impl-base</artifactId>
        <version>2.0.0-alpha-2</version>
        <scope>runtime</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-impl-javaee</artifactId>
        <version>2.0.0-alpha-2</version>
        <scope>runtime</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-impl-jboss</artifactId>
        <version>2.0.0-alpha-2</version>
        <scope>runtime</scope>
      </dependency>
      <dependency>
        <groupId>org.jboss.shrinkwrap.descriptors</groupId>
        <artifactId>shrinkwrap-descriptors-spi</artifactId>
        <version>2.0.0-alpha-2</version>
        <scope>runtime</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>
  <dependencies>
    ...
    <dependency>
      <groupId>org.jboss.shrinkwrap.resolver</groupId>
      <artifactId>shrinkwrap-resolver-api-maven</artifactId>
      <version>1.0.0-beta-6</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.jboss.shrinkwrap.resolver</groupId>
      <artifactId>shrinkwrap-resolver-impl-maven</artifactId>
      <version>1.0.0-beta-6</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.jboss.shrinkwrap</groupId>
      <artifactId>shrinkwrap-impl-base</artifactId>
      <version>1.0.0</version>
      <scope>test</scope>
    </dependency>
  </dependencies>
  ...
</project> 
```

当我打印依赖关系树时，我得到下面的输出（仅显示其中包含有问题的 jar 的节点。我确实看到其中一些 jar 被列为“运行时”和“运行时（从测试管理的范围）”但是我不确定这是否相关或它们如何被切换/包含为运行时，因为在大多数情况下，它们所属的依赖项是测试范围：

```
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ name_removed ---
...
[INFO] +- org.jboss.arquillian.extension:arquillian-seam2:jar:1.0.0.Alpha2:test
[INFO] |  \- org.jboss.shrinkwrap:shrinkwrap-extension-descriptors:jar:1.0.0-beta-6:test (version managed from 1.0.0-beta-5)
[INFO] +- org.jboss.arquillian.protocol:arquillian-protocol-servlet:jar:1.0.0.Final:test
[INFO] |  +- org.jboss.arquillian.container:arquillian-container-spi:jar:1.0.0.Final:test
[INFO] |  |  +- org.jboss.arquillian.config:arquillian-config-api:jar:1.0.0.Final:test
[INFO] |  |  \- org.jboss.arquillian.config:arquillian-config-impl-base:jar:1.0.0.Final:test
[INFO] |  +- org.jboss.arquillian.container:arquillian-container-test-api:jar:1.0.0.Final:test
[INFO] |  \- org.jboss.shrinkwrap.descriptors:shrinkwrap-descriptors-spi:jar:2.0.0-alpha-2:runtime
[INFO] |     \- org.jboss.shrinkwrap.descriptors:shrinkwrap-descriptors-api-base:jar:2.0.0-alpha-2:runtime (version managed from 1.2.0-alpha-1)

[INFO] +- org.jboss.shrinkwrap.resolver:shrinkwrap-resolver-api-maven:jar:1.0.0-beta-6:test (scope not updated to runtime)
[INFO] +- org.jboss.shrinkwrap.resolver:shrinkwrap-resolver-impl-maven:jar:1.0.0-beta-6:test (scope not updated to runtime)
[INFO] |  +- org.jboss.shrinkwrap.resolver:shrinkwrap-resolver-api:jar:1.0.0-beta-6:test
[INFO] |  +- org.sonatype.aether:aether-api:jar:1.8:test
[INFO] |  +- org.sonatype.aether:aether-util:jar:1.8:test
[INFO] |  +- org.sonatype.aether:aether-connector-wagon:jar:1.8:test
[INFO] |  |  +- org.sonatype.aether:aether-spi:jar:1.8:test
[INFO] |  |  \- org.codehaus.plexus:plexus-container-default:jar:1.5.5:test
[INFO] |  |     +- org.codehaus.plexus:plexus-classworlds:jar:2.2.2:test
[INFO] |  |     +- org.apache.xbean:xbean-reflect:jar:3.4:test
[INFO] |  |     |  \- commons-logging:commons-logging-api:jar:1.1:test
[INFO] |  |     \- com.google.collections:google-collections:jar:1.0:test
[INFO] |  +- org.apache.maven:maven-aether-provider:jar:3.0.1:test
[INFO] |  |  +- org.apache.maven:maven-model:jar:3.0.1:test
[INFO] |  |  +- org.apache.maven:maven-model-builder:jar:3.0.1:test
[INFO] |  |  +- org.apache.maven:maven-repository-metadata:jar:3.0.1:test
[INFO] |  |  +- org.sonatype.aether:aether-impl:jar:1.8:test
[INFO] |  |  +- org.codehaus.plexus:plexus-component-annotations:jar:1.5.5:test
[INFO] |  |  \- org.codehaus.plexus:plexus-utils:jar:2.0.4:test
[INFO] |  +- org.apache.maven:maven-settings-builder:jar:3.0.1:test
[INFO] |  |  +- org.codehaus.plexus:plexus-interpolation:jar:1.14:test
[INFO] |  |  +- org.apache.maven:maven-settings:jar:3.0.1:test
[INFO] |  |  \- org.sonatype.plexus:plexus-sec-dispatcher:jar:1.3:test
[INFO] |  |     \- org.sonatype.plexus:plexus-cipher:jar:1.4:test
[INFO] |  +- org.apache.maven.wagon:wagon-provider-api:jar:1.0-beta-7:test
[INFO] |  +- org.apache.maven.wagon:wagon-file:jar:1.0-beta-7:test
[INFO] |  \- org.apache.maven.wagon:wagon-http-lightweight:jar:1.0-beta-7:test
[INFO] |     \- org.apache.maven.wagon:wagon-http-shared:jar:1.0-beta-7:test
[INFO] \- org.jboss.shrinkwrap:shrinkwrap-impl-base:jar:1.0.0:test (scope not updated to runtime)
[INFO]    \- org.jboss.shrinkwrap:shrinkwrap-spi:jar:1.0.0:runtime (scope managed from test)
[INFO]       \- org.jboss.shrinkwrap:shrinkwrap-api:jar:1.0.0:runtime 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T18:36:32.570

It looks like this was a problem with a BOM used by Arquillian:

[https://issues.jboss.org/browse/ARQ-889](https://issues.jboss.org/browse/ARQ-889)

We've updated to the fix version and all is well.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T17:16:19.923

您不想要的 5 个 shrinkwrap jar 都是您的测试范围依赖项的依赖项。但是在dependencyManagement 部分中`shrinkwrap-spi`，`shrinkwrap-descriptors-spi`、 和`shrinkwrap-resolver-impl-maven`被列为运行时范围。我的猜测是这些运行时声明会覆盖传递依赖项的测试范围。并且运行时范围由这些依赖项的依赖项继承。

所以`shrinkwrap-spi`和`shrinkwrap-descriptors-spi`被包括在内，因为它们在dependencyManagement 中的运行时声明覆盖了从显式测试范围依赖项中传递继承的测试范围。因为这两个依赖项现在是运行时范围的，所以它们也导致`shrinkwrap-api`并`shrinkwrap-descriptors-api-base`成为运行时。我认为`shrinkwrap-resolver-api`还从`shrinkwrap-resolver-impl-maven`（它是dependencyManagement中的运行时）传递运行时范围，由于显式测试范围，它本身不包括在内。

然而，这主要是一个猜测，通过在一个空项目中使用一些收缩包装依赖项测试不同的范围并查看解决了什么来支持。

如果没有理由需要`shrinkwrap-spi`,`shrinkwrap-descriptors-spi`和`shrinkwrap-resolver-impl-maven`在dependencyManagement 中运行时范围，我将删除范围位并再次尝试打包。如果出于某种原因确实需要将它们设置为运行时范围，则可能必须在依赖项块中将五个 jar 设置为显式测试范围。

* * *

## **编辑：**

这是一个简单的项目来演示：

**pom.xml**

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>my.group</groupId>
    <artifactId>my-artifact</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>war</packaging>
    <dependencies>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
            <version>3.0.6.RELEASE</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-core</artifactId>
                <version>3.0.6.RELEASE</version>
                <scope>runtime</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>
</project> 
```

（`spring-beans`工件取决于`spring-core`。）

然后我运行`mvn clean package`并得到以下输出：

```
[INFO] Building war: /home/matts/test/target/my-artifact-0.0.1-SNAPSHOT.war
[DEBUG] adding directory META-INF/
[DEBUG] adding entry META-INF/MANIFEST.MF
[DEBUG] adding directory WEB-INF/
[DEBUG] adding directory WEB-INF/classes/
[DEBUG] adding directory WEB-INF/lib/
[DEBUG] adding entry WEB-INF/classes/Test.class
[DEBUG] adding entry WEB-INF/lib/spring-core-3.0.6.RELEASE.jar
[DEBUG] adding entry WEB-INF/lib/spring-asm-3.0.6.RELEASE.jar
[DEBUG] adding entry WEB-INF/lib/commons-logging-1.1.1.jar
[DEBUG] adding entry WEB-INF/web.xml 
```

但是，如果我`dependencyManagement`从 POM 中删除该部分，并再次创建战争，我会得到以下输出：

```
[INFO] Building war: /home/matts/test/target/my-artifact-0.0.1-SNAPSHOT.war
[DEBUG] adding directory META-INF/
[DEBUG] adding entry META-INF/MANIFEST.MF
[DEBUG] adding directory WEB-INF/
[DEBUG] adding directory WEB-INF/classes/
[DEBUG] adding entry WEB-INF/classes/Test.class
[DEBUG] adding entry WEB-INF/web.xml 
```

即使`spring-beans`是测试范围，因为我`spring-core`在该部分中设置了运行时范围`dependencyManagement`，它仍然包含在战争中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:35:21.077

您的依赖树报告显示了其中一些 jar 的运行时范围，因此它们相应地包含在战争中，即在运行时可用。有效的 pom 还显示了一些 jar 的默认范围，因此包含。总而言之，您必须追查依赖项的来源。检查你的 pom 中的依赖和依赖管理部分，以及所有的父 pom。

为了更容易调查，我会创建一个声明了其中一些依赖项的测试战争项目，这样您就可以逐步添加和删除 pom 片段，看看它如何影响最终结果。

# python - from __future__ import ... 可以保证 Python 2 和 3 的兼容性吗？

> ID：11103099
> 
> 赞同：12
> 
> 时间：2012-06-19T14:25:51.837
> 
> 标签：python, python-3.x, python-2.x

我对热身“Python 2 还是 Python 3？”不感兴趣。问题（即使我发现[的最近一个](https://stackoverflow.com/q/5478518/321973)问题已经超过一年了），但我偶然发现了[这个说法](http://www.raspberrypi.org/phpBB3/viewtopic.php?f=10&t=3676)：

> 如果您的文件以以下行开头，您可以在 Python 2 下编写 Python 3 代码：
> 
> ```
> from __future__ import absolute_import, division, generators, unicode_literals, print_function, nested_scopes, with_statement 
> ```
> 
> 有了该行，您的代码将适用于 Python 2 或 Python 3。可能在极少数情况下它不起作用，但我没有发现任何情况，

这是真的？这一行是否足以确保您编写的代码将在 Python 2.x（我假设 >=2.5）和 3.x（假设导入的模块在两者中都可用）上运行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T14:46:13.120

我会说不，这是胡说八道。即使有了这些导入，Python 2 和 3 之间仍然存在显着差异：例如，`input()`在 Python 3 中就像`raw_input()`在 Python 2 中一样；`range()`在 Python 3 中就像`xrange()`在 Python 2 中一样。在这种情况下，只要范围很小，`xrange()`您就可以`range()`在 Python 2 中使用，但如果它们很大，那么您的程序在 Python 2 和蟒蛇 3。

您可以在代码中添加类似这样的内容：

```
try:
    range = xrange
    input = raw_input
except NameError:
    pass 
```

但是你必须找到所有这些边缘情况并修复它们。例如，在 Python 3 中有返回迭代器的`keys()`and`values()`方法，`dict`但在 Python 2 中有列表，因此您需要编写一个`dict`“修复”它的子类（然后永远不要在代码中使用字典文字而不包装它们，因为否则将是内置`dict`类型）。

我想，通过使用`__future__`和各种修复，并限制自己在这样创建的 Python 子集中编写代码，该子集将在 2.x 和 3.x 下运行，有可能编写在两者中运行的代码版本。不过，看起来工作量很大。有一个`2to3`实用程序是有原因的...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-21T02:54:49.473

“这取决于”

**否：**将这些导入添加到您的 Python 2 代码不会使其在 Python 3 下运行。

**是的：**有了这些导入，您可以编写在 Python 2 和 Python 3 下运行的代码。

**但是**：再一次，你也可以在没有这些导入的情况下做到这一点，其中有几个，例如`unicode_literals`已经证明根本没有帮助。`generators`并且`with_statement`与 Python 2 到 Python 3 完全无关，这些是 Python 2 版本中添加的功能。

所以总而言之，这些进口有点像红鲱鱼，而且这种说法错多于正确。

**然而，**这并不意味着编写同时在 Python 2 和 Python 3 下运行的代码是不可能的，甚至是非常困难的。有关更多信息，请参见[http://python3porting.com/](http://python3porting.com/)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-19T15:19:38.880

这并非不可能，具体取决于您的代码库的需求。您可能会发现[六](http://packages.python.org/six/)（2 * 3，哈哈）库必不可少；另一个有用的工具是[python-modernize](https://github.com/mitsuhiko/python-modernize)，它尝试将您的代码转换为交叉兼容状态。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-19T14:30:49.800

它会增加它的可能性，但是有些东西不能从`__future__`导入中获得，有些东西在 3.x 中会被删除。

在我的脑海中，您仍然可以使用在 3.x 中删除的参数元组解包，并且您将无法使用在 3.x 中引入的带有星号运算符的漂亮元组解包。

例如：

```
def some_function((x, y), magnitude): #This has been removed in 3.x
    pass

x, *y = (1, 2, 3) #This does not exist in 2.x 
```

就是说，要小心避免此类事情，您绝对可以编写适用于两个版本的代码，是的。

显然，这也仅适用于将功能向后移植到其中的 2.x 版本。正因为如此，该行中的某些行实际上是完全没有意义的——例如，没有理由导入`generators`，因为任何可以导入 with 语句的版本都已经有生成器作为标准工作。也一样`nested_scopes`。

一般来说，我建议只为 3.x 编写 - 安装和使用这两个版本没有障碍。如果你真的非常需要 2.x 支持，那么就为 2.x 编写尽可能多的向后移植的特性，并使用 2to3 来清理其他任何东西。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-19T15:22:52.387

不。其他人指出了一些差异，还有其他人。最基本的一点是 Python 3 原生字符串是多字节的——这在与单字节机制（例如与其他进程的管道）通信时会引发问题。其他包括模块重命名（Tkinter 到 tkinter），True 和 False 现在是关键字。

甚至对比也可能不一样，以下不正确的代码：

```
num = 42
txt = "3"

if txt < num:
    print ('Wow!')
else:
    print ('Doh!') 
```

在 Py3 上产生 a `TypeError`，但在 Py2 上不产生。

已经提到了拆包。字典方法`items()`、`keys()`和`values()`返回视图对象（在 2.7 上使用不同的方法名称）。在 Py3 中，迭代器被更多地使用，例如从`map()`and中返回`filter()`，等等......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-14T07:59:28.903

你可以使用*future*包：*pip install future*

```
In [1]: range(10)
Out[1]: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

In [2]: from future.builtins import range

In [3]: range(10)
Out[3]: range(0, 10) 
```

这是他们的备忘单和更多示例： http: [//python-future.org/compatible_idioms.html](http://python-future.org/compatible_idioms.html)

# asp.net-mvc-3 - 选择外键后读取相关数据 - MVC3 和 EF4

> ID：11103100
> 
> 赞同：0
> 
> 时间：2012-06-19T14:25:54.480
> 
> 标签：asp.net-mvc-3, entity-framework

我是 MVC 和 EF 的新手，我有一个问题。我已经建立了一个带有模型视图控制器等的站点。在一个案例的编辑视图上（相当大的模型，所以我不会在这里发布）我有一个使用 CustomerID 的客户模型的 FK。当用户从下拉列表中选择客户 ID 时，我想在选择 ID 后显示 CustomerName、CustomerPhone 等。我想我可能需要回帖才能让它工作？

另外，我是否需要将相关实体作为初始数据“获取”的一部分？我已经阅读了一些细节，但我不完全理解它需要如何工作。

如果我应该发布更多信息，请告诉我。谢谢！

这是我编辑的 ActionResult

```
public ActionResult Edit(int id)
    {
        Cases cases = db.Cases.Find(id);

        //related data needs to loaded to show related data fields
        //include related data entities
        var v = db.Cases.Include("Customers");

        ViewBag.TechnicianID = new SelectList(db.Technicians, "TechnicianID", "LastName", cases.TechnicianID);
        ViewBag.BranchID = new SelectList(db.Branches, "BranchID", "BranchName", cases.BranchID);
        ViewBag.EngineModelID = new SelectList(db.EngineModels, "EngineModelID", "EngineModelName", cases.EngineModelID);
        ViewBag.CaseCategoryID = new SelectList(db.CaseCategories, "CaseCategoryID", "CategoryName",cases.CaseCategoryID);
        ViewBag.Qualified = new SelectList(new[] { "YES", "NO", "PARTIALLY" });
        ViewBag.CaseStatus = new SelectList(new[] { "OPEN/IN PROCESS", "CLOSED" });
        return View(cases);
    } 
```

var v = db.Cases.Include("Customers") 行是我试图用来加载相关客户数据然后在我的编辑视图中显示的内容，如下所示：

```
@Html.EditorFor(model => model.Customer.CustomerName) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:33:15.900

好吧，这取决于您要做什么。您可以包含一个模型，该模型包含所有必需的数据，并在该页面上的每次调用中发送它（当然初始为空）一旦您选择了客户，进行回发并将 customerId 发送到您的应用程序并返回具有所需的相同页面模型。你也可以通过 AJAX 做到这一点。

> 另外，我是否需要将相关实体作为初始数据“获取”的一部分？

不知道我是否明白你想说什么。您的意思是您认为您必须将所有客户数据发送到页面并在客户端选择相关数据？

# algorithm - 由路径定义的两个多边形的并集

> ID：11103102
> 
> 赞同：0
> 
> 时间：2012-06-19T14:26:01.160
> 
> 标签：algorithm, language-agnostic, geometry, computational-geometry

我有两个由点列表定义的多边形：

```
x1,y1; x2,y2; x3,y3; ...; xn,yn 
```

我想找到他们的联合，以相同的形式表达。

假设这两个重叠没有留下孔是可以接受的。更好的是，一般来说，允许两个多边形有孔但要填充它们。

在这个应用程序中，速度并不重要；低效的算法/实现会很好。我对任何类型的答案持开放态度：解决任务、算法或代码的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:40:35.777

你可以试试Angus Johnson 的[Clipper](http://angusj.com/delphi/clipper.php)库。它可以与 C++、C# 和 Delphi 一起使用。

# jquery - 在 jquery ui draggables 中使用时，文本字段变得不可编辑

> ID：11103104
> 
> 赞同：1
> 
> 时间：2012-06-19T14:26:09.307
> 
> 标签：jquery, jquery-ui-dialog, jquery-ui-draggable

我在页面中使用 jquery 可拖动 UI 对话框插件，如图所示。

![在此处输入图像描述](../Images/60b6abf2aa844fe767f234b60b113bf1.png)

在图像中，以黄色标记的区域都是可排序和可拖动的。以红色标记的文本框仅在 Firefox 中不可编辑。这在 chrome 浏览器中没有任何问题。

请为 Firefox 提出正确的修复建议。

# excel - Excel VBA计算经过一定秒数的记录

> ID：11103105
> 
> 赞同：0
> 
> 时间：2012-06-19T14:26:11.680
> 
> 标签：excel, vba

我试图在这些休息时间报告“经过的秒数”：少于 15 分钟、15 到 19 分钟、20 到 24 分钟、25 到 29 分钟、30 到 45 分钟、45 到 60 分钟以及 60 分钟或更多.

我有一个显示经过的秒数的字段，我可以使用以下公式获得我想要的休息时间 - 总计 -

=SUMPRODUCT((ABS(TestTable!$AF$2:$AF$50)>=0)*(ABS(TestTable!$AF$2:$AF$)<=899))

（其中“TestTable”是数据所在的工作表，Col AF 是存储经过的秒数的地方）。问题？

我需要通过另一个字段来减少每个细分。'TestTable' 中还有一个包含 PRODx 或 PRODz 的字段（它是 Col H）。

所以我需要说“如果 Col H = PRODx，那么计算有多少条记录小于 15 分钟并将其放在某个单元格中 ---THEN--- 如果 Col H = PRODz 然后计算有多少条记录小于 15 min 并将结果放在不同的单元格中”。

有谁知道写这个的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:58:43.180

如果你有 excel 2007 或更高版本，`COUNTIFS`应该适合你。
`=COUNIFS(H:H,AF:AF,"<900",H:H,"PRODx")`少于 15 分钟，PRODx
`=COUNIFS(H:H,AF:AF,"<900",H:H,"PRODz")`少于 15 分钟，然后 PRODz
为您扩展选择范围
`=COUNIFS(H:H,AF:AF,">=900",AF:AF,"<1200",H:H,"PRODx")`为 15-19 分钟，PRODx
`=COUNIFS(H:H,AF:AF,">=900",AF:AF,"<1200",H:H,"PRODz")`为 15-19 分钟，以及 PRODz

在您需要的所有时间/产品范围内重复此操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:42:25.293

在单元格 A1 中，键入：

```
=COUNT(IF(H:H="PRODx",IF(AF:AF="Less Than 15 Seconds",M1:M5)))
M is just another random column 
```

在单元格 A2 中，键入相同内容，但将 PRODx 更改为 PRODz。

确保将所有公式作为数组公式输入，键入后按 CTRL + SHIFT + ENTER，而不是直接输入。

有关更多信息，请参阅此链接：[Count If With Multiple Criteria](http://www.ozgrid.com/Excel/count-if.htm)

**编辑**

如果您必须有 VBA 解决方案，请告诉我。否则，您不需要 VBA。此外，如果您运行的是 Excel 2007 或更高版本，则可以使用 CountIfs 函数，它比上面的 Array 公式更简洁且资源消耗更少。

# html - 带有标签的谷歌地图链接

> ID：11103108
> 
> 赞同：2
> 
> 时间：2012-06-19T14:26:13.453
> 
> 标签：html, google-maps

我正在尝试通过使用数据库提供的 long 和 lat 来创建 Google 地图链接。我从 PHP echo 得到的链接是`http://maps.google.com/maps?z=16&t=m&q=loc:59.337129+18.032856`

有没有办法在地图上指向同一个地点，但得到一个更友好的标签，比如在这种情况下，比如瑞典斯德哥尔摩。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:42:06.093

[http://maps.google.com/maps?z=16&t=m&q=59.337129,18.032856+（一些标签）](http://maps.google.com/maps?z=16&t=m&q=59.337129,18.032856%20%28Some%20label%29)

详见： http:
[//mapki.com/wiki/Google_Map_Parameters](http://mapki.com/wiki/Google_Map_Parameters)

# java - AndroidHttpClient线程安全吗

> ID：11103109
> 
> 赞同：4
> 
> 时间：2012-06-19T14:26:19.027
> 
> 标签：java, android, androidhttpclient

我想知道，[AndroidHttpClient](http://developer.android.com/reference/android/net/http/AndroidHttpClient.html)线程是否安全，因为文档中没有提到这一点。意味着，单个实例`AndroidHttpClient`可以在多个线程之间共享。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T14:41:51.847

是的，它是线程安全的。

`AndroidHttpClient``DefaultHttpClient`是为 Android 预先配置的特殊实现。它注册`ThreadSafeClientConnManager`允许通过托管连接池进行线程安全的 HTTP 访问。`AndroidHttpClient`还为超时和套接字缓冲区大小应用合理的默认设置。它还默认支持 HTTPS。

[**您可以在此处**](http://grepcode.com/file_/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/net/http/AndroidHttpClient.java/?v=source)找到源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T12:29:41.933

是的，它是线程安全的。另外，一定要使用工厂方法：

```
newInstance(String userAgent, Context context) 
```

将其与 HTTPS 一起使用以确保 SSL 会话的缓存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T14:48:51.860

根据代码它是线程安全的，因为它使用

```
ClientConnectionManager manager =
                new ThreadSafeClientConnManager(params, schemeRegistry); 
```

根据[来源](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/net/http/AndroidHttpClient.java)

唯一的缺点是它的 Api 级别 8 及以上 (2.2.x)

# java - XMLStreamException 未绑定到前缀。Stax 实现 WebSphere

> ID：11103110
> 
> 赞同：0
> 
> 时间：2012-06-19T14:26:25.327
> 
> 标签：java, serialization, websphere, stax, wss4j

我在尝试在 WAS 6.1.0.43 上部署带有 WSS4J 密码回调的 Web 服务时遇到问题。

基于 XFire 1.2.2 的 Web 服务

我对 Tomcat 7.0.25 没有任何问题：

好像和STAX Implementation有关；IBM 在 WAS 上使用自己的。

如果您有任何提示。

堆栈跟踪 ：

```
Caused by: 
javax.xml.stream.XMLStreamException: The namespace URI "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" has not been bound to a prefix.
    at com.ibm.xml.xlxp.api.stax.msg.StAXMessageProvider.throwXMLStreamException(StAXMessageProvider.java:59)
    at com.ibm.xml.xlxp.api.stax.XMLStreamWriterBase.writeAttribute(XMLStreamWriterBase.java:464)
    at com.ibm.xml.xlxp.api.stax.XMLOutputFactoryImpl$XMLStreamWriterProxy.writeAttribute(XMLOutputFactoryImpl.java:157)
    at org.codehaus.xfire.util.STAXUtils.writeElement(STAXUtils.java:366)
    at org.codehaus.xfire.util.STAXUtils.writeNode(STAXUtils.java:391)
    at org.codehaus.xfire.util.STAXUtils.writeElement(STAXUtils.java:380)
    at org.codehaus.xfire.util.STAXUtils.writeNode(STAXUtils.java:391)
    at org.codehaus.xfire.util.STAXUtils.writeElement(STAXUtils.java:380)
    at org.codehaus.xfire.util.STAXUtils.writeNode(STAXUtils.java:391)
    at org.codehaus.xfire.util.STAXUtils.writeElement(STAXUtils.java:380)
    at org.codehaus.xfire.util.STAXUtils.writeDocument(STAXUtils.java:285)
    at org.codehaus.xfire.util.dom.DOMSerializer.writeMessage(DOMSerializer.java:40) 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:49:38.317

在 EAR/WAR 中使用 XFire 发行版中的 stax 相关 jars（可能是 wstx-asl/stax-api/stax-util jars）并将类加载器设置为 PARENT_LAST。看看是否有帮助。

# javascript - 根据内容自动调整文本框大小

> ID：11103111
> 
> 赞同：5
> 
> 时间：2012-06-19T14:26:26.330
> 
> 标签：javascript, jquery

[http://jsfiddle.net/h2vMN/1/](http://jsfiddle.net/h2vMN/1/)

我里面已经有一个文本框文本，在实际应用程序中这将被动态填充，但为了这个问题，它已经被预先填充。

```
<textarea id="textarea">
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempor commodo ornare. Donec lobortis dui sed lectus egestas tristique. Vivamus vel metus turpis, faucibus varius risus. Aenean ante mauris, ultrices id facilisis vitae, dignissim eget sem. Quisque sed justo lectus, eget aliquet leo. Curabitur in mauris et diam fermentum venenatis. Proin ullamcorper, neque a vehicula euismod, odio enim aliquam ipsum, eu tristique urna sapien nec erat.

Aliquam erat volutpat. In in lacus cursus dolor pellentesque posuere. Cras eu metus urna, a rhoncus ligula. Ut hendrerit orci in arcu dignissim id fermentum orci vulputate. Sed ante ligula, volutpat eu convallis vel, auctor in metus. Mauris euismod, metus eget venenatis sodales, risus tellus volutpat elit, et aliquet massa tellus ut sapien. Mauris tempor posuere massa et consectetur. Duis dignissim enim a nulla ultricies vitae vulputate felis commodo. Phasellus mollis est eget odio porttitor consequat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Phasellus ut nibh auctor libero sagittis semper vitae quis erat.
</textarea>​ 
```

当我运行上面的代码时，它会显示一个带有滚动条的小文本区域。换句话说，在用户友好方面完全没有用。如何根据内容的数量自动调整文本框的大小，并且它的宽度设置为 600px。

```
#textarea{width:600px;}​ 
```

我想要一个 javascript/jquery 解决方案。

我尝试了该`.autoresize`解决方案，但未成功，可在此处找到：

[http://james.padolsey.com/demos/plugins/jQuery/autoresize.jquery.js/view](http://james.padolsey.com/demos/plugins/jQuery/autoresize.jquery.js/view)

请注意，高度应自动调整大小

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:36:33.220

你这个：

```
$(document).ready(function(){
    tx = $('#textarea')
    tx.height(tx.prop('scrollHeight'));
}) 
```

[演示](http://jsfiddle.net/acrashik/h2vMN/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:38:42.313

```
$(document).ready(function(){
    var heightFudgeFactor = 10;
    var id = 'tempid' + Date.now();
    $('#textarea').after( $('<div>').css('font-family','monospace').css('white-space','pre-wrap').css('word-wrap','break-word').attr('id',id).css('width',$('#textarea').width()).text( $('#textarea').text() ) );
    $('#textarea').css('height',$('#'+id).outerHeight() + heightFudgeFactor).next().remove();
});​ 
```

这是一种方法，我正在创建一个辅助 div，它是 textarea 的高度，基于内容，但你需要多玩一点才能让它符合你的实际喜好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:33:30.737

我曾经使用过这个插件：[http](http://www.jacklmoore.com/autosize) ://www.jacklmoore.com/autosize 它工作得很好。

# sql-server - 在 SQL Server 和 EF 中采取和跳过

> ID：11103115
> 
> 赞同：2
> 
> 时间：2012-06-19T14:26:32.960
> 
> 标签：sql-server, asp.net-mvc, entity-framework, skip-take

我有一个 ASP.NET MVC 4 应用程序，我正在使用 EF。我有一个表和一个 SQL 视图（视图显示该表中的行加上一些不重要的数据（~ 1000 条记录）），有 ~ 400.000 条记录。当我在 EF 中显示数据时，需要 25 秒

```
 MVCAppEntities db = new MVCAppEntities();
    public ActionResult Index()
    {
        return View(db.vvItem.OrderBy(n => n.Code).Skip(20).Take(40).ToList());
    } 
```

在 SQL Server Management Studio 中，此查询需要 0-1 秒

```
select  code, quantity, name, price
from (
    select *,
           row_number() over(order by code) as rn
    from vvItem       
 ) as T
where T.rn between 20 and 40 
```

**问**：为什么 EF 查询这么慢？我应该做一个 SP 来做 Skip and Take 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T05:03:44.303

它在后续调用中运行得更快吗？这可能只是第一次出现问题。看看这个链接。

[http://www.dotnetspark.com/kb/3706-optimizing-performance.aspx](http://www.dotnetspark.com/kb/3706-optimizing-performance.aspx)

# themes - {PreviousPost} 和 {NextPost} 无法在 Tumblr 上运行

> ID：11103125
> 
> 赞同：6
> 
> 时间：2012-06-19T14:26:53.503
> 
> 标签：themes, tumblr

{PreviousPost} 和 {NextPost} 似乎没有在 Tumblr 上创建自定义主题。这是我的代码。谁能指出我的错误...

```
<div>
    {block:PreviousPost}<a href="{PreviousPost}"><span>Previous Post</span></a>{/block:PreviousPost}
    {block:NextPost}<a href="{NextPost}"><span>Next Post</span></a>{/block:NextPost}
</div> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-19T17:11:25.357

您需要将其包装在`{block:PermalinkPagination}…{/block:PermalinkPagination}`块中，如下所示：

```
{block:PermalinkPagination}
    {block:PreviousPost}
        <a rel="prev" href="{PreviousPost}">{lang:Previous Post}</a>
    {/block:PreviousPost}
    {block:NextPost}
        <a rel="next" href="{NextPost}">{lang:Next Post}<a/>
    {/block:NextPost}
{/block:PermalinkPagination} 
```

# mysql - mysql order by 然后为最新日期设置一个值

> ID：11103132
> 
> 赞同：0
> 
> 时间：2012-06-19T14:27:26.840
> 
> 标签：mysql, perl, email, variables

我目前正在制作一个程序，如果一个人最后一次进入的日期已经结束（某个时间范围），它将发送一封电子邮件。我的桌子是这样布置的：

```
employee   | dept. | date       | other | 
bob        | 1     | 2012-05-29 | abc   |
bob        | 1     | 2012-07-15 | xyz   |
jon        | 2     | 2012-05-29 | abc   | 
```

（我已经用 mysql 按员工然后日期排序）例如，对于鲍勃，我想自动将一个变量分配给日期 2012-07-15，因为那是他最后一次输入的日期。然后根据当前日期，如果提交之间的时间过长，我想发送一封电子邮件。我的问题是如何为表中每个人的最后日期分配一个变量？我也愿意接受不同的更好的方法来做到这一点。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:18:44.447

这是 Perl 中的一个解决方案。SQL 查询的功劳归于@spencer7593。

如果您不熟悉[DBI](http://search.cpan.org/~timb/DBI-1.622/DBI.pm) ，我建议您快速浏览一下。另请查看[DBD::mysql](http://search.cpan.org/~capttofu/DBD-mysql-4.021/lib/DBD/mysql.pm)以了解如何创建*数据源*(DSN)。

您基本上需要连接到数据库，准备查询，执行它并获取结果。然后，您可以使用它们发送您的电子邮件。

这是一个不包括实际电子邮件发送的快速示例：

```
use strict;
use warnings;
use DBI;
require 'script_that_has_custom_email_sub.pl'; # or use a module or whatever

# create the database handle
my $dbh = DBI->connect("DBI:mysql:database=test;host=localhost", # <-- DSN
                       'username', 'password')
            or die $DBI::errstr;

# prepare the query to get a statement handle
my $sth = $dbh->prepare(<<__SQL__
SELECT employee
     , MAX(`date`) AS latest_date
  FROM mytable
 GROUP BY employee
 ORDER BY employee
__SQL__
);
$sth->execute; # send the query to the mysql server

# fetch each row of the result as a hashref
while (my $res = $sth->fetchrow_hashref) {
  # access $res with the keys employee and latest_date from the query
  # and send the mail
  &custom_send_email_sub($res->{'employee'}, $res->{'latest_date'});
}
$sth->finish; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:32:54.947

要返回每个员工的最新日期，这样的事情会起作用。

```
SELECT employee
     , MAX(`date`) AS latest_date
  FROM mytable
 GROUP BY employee
 ORDER BY employee 
```

* * *

附录，

正如 simbabque 指出的那样，这适用于获取最新日期，但不返回`other`值。有几种方法可以获取该结果集。

如果我们保证 (employee,date) 是唯一的（例如，通过唯一约束），我们可以使用如下查询返回具有最新日期的行上的其他列：

```
SELECT t.employee, t.`date`, t.other
 FROM mytable t
 JOIN ( SELECT r.employee, MAX(r.`date`) AS latest_date
         FROM mytable r
        GROUP BY r.employee
      ) s
   ON s.employee = t.employee
  AND s.latest_date = t.`date`
ORDER BY t.employee 
```

如果我们不能保证 (employee, date) 是唯一的，那么这个查询是不够的。但是有几种方法可以解决这个问题。

# html - Apache 速度 - 与随机数比较

> ID：11103135
> 
> 赞同：0
> 
> 时间：2012-06-19T14:27:35.090
> 
> 标签：html, apache, velocity

我将如何检查字符串是否符合这些条件：

```
#if ($x.contains("http://www.google.com/*"))
#macro
#else
#other-macro
#end 
```

其中 * 代表任何数字。例如[http://www.google.com/9430857](http://www.google.com/9430857) 这不起作用 - 有没有办法用速度表示“任何值”？干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T13:04:21.953

关于什么

```
#if ($x.matches("http://www.google.com/[0-9]+")
... 
```

这样您就可以避免匹配没有尾随数字的 google.com 链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:35:23.630

`if ($x.indexOf("http://www.google.com/") == 0)`

# javascript - MVC3部分视图中的客户端验证一半工作

> ID：11103136
> 
> 赞同：0
> 
> 时间：2012-06-19T14:27:35.843
> 
> 标签：javascript, asp.net-mvc, asp.net-mvc-3, jquery-validate

我在 MVC3 中的帐户创建表单上遇到客户端验证问题。我在模型上使用数据注释，视图是局部视图。当我在局部视图中运行它时，只有两个字段正在验证。当我将代码放在常规视图中时，所有字段都正在验证中。

搜索后这似乎是一个常见问题，但这种情况似乎不同，因为它是“半工作”，这意味着我确信 .js 库已加载并且至少可以正常工作。我没有用 Ajax 加载任何似乎会导致问题的东西。我正在使用 jquery 1.5.1 和 jquery.validate 1.8.0，它们是安装 MVC3 时附带的 IIRC。

有没有人看到/解决过这类问题？

这是我的看法：

```
<%: Html.Hidden("Bounce", Model.Bounce)%>

<div class="editor-label"><label for="FirstName">First Name</label></div>
<div class="editor-field">
    <%: Html.TextBox("FirstName", Model.FirstName)%><br />
    <%=Html.ValidationMessage("FirstName")%>
</div>

<div class="editor-label"><label for="MiddleName">Middle Name</label></div>
<div class="editor-field">
    <%: Html.TextBox("MiddleName", Model.MiddleName)%><br />
    <%=Html.ValidationMessage("MiddleName")%>
</div>

<div class="editor-label"><label for="LastName">Last Name</label></div>
<div class="editor-field">
    <%: Html.TextBox("LastName", Model.LastName)%><br />
    <%=Html.ValidationMessage("LastName")%>
</div>

<div class="editor-label"><label for="Email">Email</label></div>
<div class="editor-field">
    <%: Html.TextBox("Email", Model.Email)%><br />
    <%=Html.ValidationMessage("Email")%>
</div>

<div class="editor-label"><label for="Password1">Password</label></div>
<div class="editor-field">
    <%: Html.Password("Password1",Model.Password1)%><br />
    <%=Html.ValidationMessage("Password1")%>
</div>

<div class="editor-label"><label for="Password2">Confirm Password</label></div>
<div class="editor-field">
    <%: Html.Password("Password2",Model.Password2)%><br />
    <%=Html.ValidationMessage("Password2")%>
</div>

<div class="form-controls"><input type="submit" value="Create Account" /></div> 
```

视图正在渲染

`<% Html.RenderPartial("create", new CustomerCreationRequest()); %>`

这是模型

```
public class CustomerCreationRequest
{

    [Required(ErrorMessage = "First Name is required")]
    public string FirstName { get; set; }

    public string MiddleName { get; set; }

    [Required(ErrorMessage = "Last Name is required")]
    public string LastName { get; set; }

    [Required(ErrorMessage = "Email Address is required")]
    public string Email { get; set; }

    [Required(ErrorMessage = "Password is required")]
    public string Password1 { get; set; }

    [Compare("Password1", ErrorMessage = "The password and confirmation do not match.")]
    [Required(ErrorMessage = "Password confirmation is required")]
    public string Password2 { get; set; }

    public string Bounce { get; set; } //bounce
} 
```

正常工作的两个字段是 Password1 和 Password2 字段。两种验证规则都可以正常工作（即要求和比较）。所有其他字段都未经过验证，并且允许在空白时提交表单。

**更新**

查看生成的标记时，前 4 个正常输入字段中不存在 data-val-required 字段，但出现在最后 2 个密码字段（有效的字段）中。

**更新 2**

在表单提交并被服务器拒绝后，data-val-required 字段*确实*会出现，并且所有输入都正常工作并且正在验证。只有在初始加载时，它们才会出现在密码字段中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:19:27.060

我希望这主要是由于库不匹配（可能是 jquery 验证库）。当我创建一个新的 MVC 3 项目时，我没有看到版本号。在 jquery 验证库中。

请使用 nuget 将库更新到最新版本。

PM> 安装包jQuery

PM> 安装包 jQuery.Validation

PM> 安装包 jQuery.Validation.Unobtrusive

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T18:27:36.900

我正在将代码更新为 MVC 并使用强类型视图，并且在以前的版本中，控制器中有一段代码将这些命名字段写入 ViewData。例如

```
 ViewData["loginError"] = "";
        ViewData["createError"] = "";
        ViewData["firstName"] = "";
        ViewData["middleName"] = "";
        ViewData["lastName"] = "";
        ViewData["email"] = ""; 
```

当我删除这些时，一切正常。

# javascript - 如何使用jquery按值复制对象

> ID：11103141
> 
> 赞同：4
> 
> 时间：2012-06-19T14:27:43.610
> 
> 标签：javascript, jquery

您好，我对此复选框有疑问：

```
<input type="checkbox" id="hideTempSeries" checked="checked" value="0" /> 
     Temperature <br />
<input type="checkbox" id="hideFlowSeries" checked="checked" value="1" /> 
     Flow <br />
<input type="checkbox" id="hidePressSeries" checked="checked" value="2"/> 
     Pressure <br /> 
<input type="checkbox" id="hideCondSeries" checked="checked" value="3" /> 
     Conductivity  <br /> 
```

.. 和这个 jQuery 函数，它将这个复选框值的数组发送到一个名为 `removePanes(checkedArray)` “每次任何复选框发生变化时”的函数

```
 $("#tools :checkbox").change(function(){
       if($(this).prop('checked')){// when Checked

       }
       else{// when unChecked
       var checkedArray = [] ; 
        $("#tools :checkbox").each(function(index,value){
           if($(this).prop('checked') == false){checkedArray.push($(this).val())}

        });
        removePanes(checkedArray) ;
       } 
```

**removePanes() 函数**

```
 function removePanes(id){
       var removeUncheckedSeries = $.map(newSeries , function(index,value){
        for(var i=0 ; i < id.length ; i++){  
            if(index.yAxis == id[i])return null;
        }  
       return index ;
       });
       var modified = $.map(removeUncheckedSeries, function(index,value) {
        index.yAxis = 15 ; 
        return index ;
       });
      console.log(modified) ;
    } ; 
```

这是 [newSeries[] 对象](http://screencast.com/t/P8MFrhzK)

然后该`removePanes(checkedArray)` 函数获取此数组并从以下位置删除与未检查值等效的所有对象：`newSeries[]`object

然后它将所有 yAxis 值设置为 15。

此功能不起作用。

*因为每次复选框更改时，函数都不会重新加载 newSeries[] 对象，它只是在最后一次更改时修改它。*

它的作用是，第一次单击工作正常，然后将所有 yAxis 设置为 15。当我取消选中任何其他框时，因为所有 yAxis 都等于 15 并且 jQuery 数组发送值从 0 到 3 什么也没发生。

**问题**：每次更改复选框触发时，如何`removePanes(checkedArray)`重新加载对象？`newSeries[]`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:59:56.657

> 发生这种情况是因为默认情况下对象是通过 Javascript 中的引用复制的。

因此，如果您从任何地方更改复制对象的任何属性，它将影响所有其他对象。要仅按值（或克隆）复制对象，您可以使用 jQuery 的`$.extend()`方法，如 Jonh Resig（是的，他本人）在此处显示[https://stackoverflow.com/a/122704/344304](https://stackoverflow.com/a/122704/344304)

```
var newObj = $.extend(true, {}, oldObj); // deep copy 
```

所以改变你的`removePanes`功能如下

```
function removePanes(id) {
        var seriesCopy = jQuery.extend(true, {}, newSeries);
        var removeUncheckedSeries = $.map(seriesCopy, function(obj, index) {
            return   $.inArray(obj.yAxis,id) == -1 ? obj : null;
        });
        var modified = $.map(removeUncheckedSeries, function(obj, index) {
            obj.yAxis = 15;
            return obj;
        });
        console.log(modified);
    };​ 
```

**演示：http:** [//jsfiddle.net/joycse06/w2KS2/](http://jsfiddle.net/joycse06/w2KS2/)

# ruby-on-rails - 如何将模型的值设置为 f.label

> ID：11103142
> 
> 赞同：2
> 
> 时间：2012-06-19T14:27:44.400
> 
> 标签：ruby-on-rails, ruby-on-rails-3, fields-for

我正在使用rails 3.2。

我有很多类型的模型。有没有办法将模型的“值”设置为 field_for.label？

这就是我想做的。

客户模型

```
class Client < ActiveRecord::Base
  attr_accessible :name, :renewal_month1, :renewal_month10, :renewal_month11, :renewal_month12, :renewal_month2, :renewal_month3, :renewal_month4, :renewal_month5, :renewal_month6, :renewal_month7, :renewal_month8, :renewal_month9, :sales_person_id, :usable, :user_id, :licenses_attributes

  has_many :licenses, :dependent => :destroy
  has_many :systems, :through => :licenses
  accepts_nested_attributes_for :licenses

end 
```

许可模式

```
class License < ActiveRecord::Base
  attr_accessible :amount, :client_id, :system_id

  belongs_to :client
  belongs_to :system
  def system_name
    self.system.name
  end

end 
```

系统型号

```
class System < ActiveRecord::Base
  attr_accessible :name, :sort

  has_many :clients

  has_many :licenses
  has_many :clients, :through => :licenses

end 
```

在客户端控制器中，我为所有系统构建了许可证对象。

```
def new
  @client = Client.new
  @title = "New Client"

  System.all.each do |system|
    @client.licenses.build(:system_id => system.id)
  end

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @client }
  end
end 
```

在 _form.html.erb 我使用 fieds_for 获取许可证

```
<%= f.fields_for :licenses do |ff| %>
<tr>
    <td><%= ff.label :system_id %></td>
    </td>
    <td> <%= ff.number_field :amount %>
    <%= ff.hidden_field :system_id %> 
    <%= ff.hidden_field :system_name %> 
    </td>
</tr>
<% end %> 
```

我得到的结果是这个

```
<tr>
    <td><label for="client_licenses_attributes_0_system_id">System</label></td>
    </td>
    <td> <input id="client_licenses_attributes_0_amount" name="client[licenses_attributes][0][amount]" type="number" value="10" />
    <input id="client_licenses_attributes_0_system_id" name="client[licenses_attributes][0][system_id]" type="hidden" value="1" /> 
    <input id="client_licenses_attributes_0_system_name" name="client[licenses_attributes][0][system_name]" type="hidden" value="SYSTEMNAME" /> 
    </td>
</tr> 
```

我希望标签看起来像这样。

```
 <td><label for="client_licenses_attributes_0_system_id">SYSTEMNAME</label></td> 
```

SYSTEMNAME 是模型 SYSTEM 的值。我在 LICENSE 模型中有一个虚拟属性，定义为 system_name。我能够在 hidden_​​field 中获得 SYSTEMNAME，所以我认为模型和控制器都很好。我只是不知道如何将模型的值设置为标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:57:30.510

为什么不能使用以下？

```
<%= ff.label :system_name %> 
```

我认为下一个代码也应该可以工作

```
<%= ff.label :amount, ff.object.system_name %> 
```

我无法对此进行测试，但我希望它会生成

```
<label for="client_licenses_attributes_0_amount">SYSTEMNAME</label> 
```

请注意，它为金额字段创建了一个标签，因此当用户单击它时，金额字段将被聚焦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:57:20.620

您是否尝试将 system_name 添加到标签

```
<%= f.fields_for :licenses do |ff| %>
<tr>
    <td><%= ff.label :system_id, :system_name %></td>

    <td> <%= ff.number_field :amount %>
    <%= ff.hidden_field :system_id %> 
    <%= ff.hidden_field :system_name %> 
    </td>
</tr>
<% end %> 
```

# c# - 如何使用 NHibernate 映射自定义列表

> ID：11103143
> 
> 赞同：1
> 
> 时间：2012-06-19T14:27:52.110
> 
> 标签：c#, .net, nhibernate, mapping, custom-lists

我有一个带有自定义列表的类，它继承自 List 并且无法使 NHibernate 映射工作。

```
public class MyClass
{
  private MyList<Foo> foos;

  public virtual MyList<Foo> Foos
  {
      get { return foos; }
      set { foos= value; }
  }
}

<bag name="Foos" access="property" cascade="all-delete-orphan" batch-size="5">
      <key column="MyClassId"/>
      <one-to-many class="Domain.Model.MyClass, Domain"/>
</bag> 
```

我得到了例外

> 无法转换类型为“NHibernate.Collection.Generic.PersistentGenericBag `1[Domain.Model.Foo]' to type 'Domain.Model.MyList`1[Domain.Model.Foo]”的对象。

在这个[博客](http://colinjack.blogspot.de/2008/09/nhibernate-mapping-custom-collections.html)之后，我尝试将包包在一个组件中，

```
<component name="Foos" access="nosetter.camelcase-underscore">
  <bag name="Foos" access="property" cascade="all-delete-orphan" batch-size="5">
      <key column="MyClassId"/>
      <one-to-many class="Domain.Model.MyClass, Domain"/>
  </bag>
</component> 
```

导致错误

> 在“Domain.Model.MyList`1[Domain.Model.Foo]”类中找不到属性“Foos”的吸气剂

MyList 只有一个添加对象的方法。

```
public class MyList<T> : List<T>
{
    public new void Add(T item)
    {
        //custom stuff

        base.Add(item);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:36:55.470

这应该工作...

```
public class MyClass
{
    public virtual IList<Foo> Foos { get; private set; }

    public MyClass()
    {
        Foos = new MyList<Foo>();
    }
} 
```

将映射属性更改为 an`IList`并将其设置为`MyList`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:49:13.963

**如果** `MyList<T>`是一个具体类型（如果我没记错的话）NHibernate 会抱怨一个类似于（或相同？）你得到的异常。

这可以通过使用`IList<T>`来解决。

# sql-server - SQL Server 数据库 内网 应用

> ID：11103148
> 
> 赞同：0
> 
> 时间：2012-06-19T14:28:07.913
> 
> 标签：sql-server, web-applications, user-interface, internal, frontend

我有一个 SQL Server 数据库后端。我想要一个内部网络前端 UI，这样它只能在公司网络中访问，而不是 Web。哪个平台最适合用于带有 SQL Server 数据库后端的前端 UI 应用程序？ASP.NET、PHP、Silverlight 或其他。

我想要显示数据趋势的图表，并且我希望用户能够选择某些报告的参数。

我对前端用户界面没有太多经验，所以我对任何事情都持开放态度。如果您需要更多信息，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:36:54.720

如果您真的对获得更好的 UI 体验感兴趣，那么我建议您使用 Silverlight。如果不使用 ASP.NET 中的 3rd 方工具，您将无法获得可调整大小的布局、网格和功能丰富的 UI。

如果您希望您的应用程序可以在任何设备上使用，而不是 ASP.NET，因为 silverlight 存在一些兼容性问题，因为您需要为其安装插件。所以这一切都取决于要求。不知道 PHP 或任何其他技术

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:47:24.497

如果您想构建一个主要用于报表的前端，我建议使用[SQL Server Reporting Services](http://www.microsoft.com/sqlserver/en/us/solutions-technologies/business-intelligence/reporting-services.aspx "SQL Server 报告服务")。

# c++ - 将 _bstr_t 原地转换为 char 数组

> ID：11103152
> 
> 赞同：0
> 
> 时间：2012-06-19T14:28:24.893
> 
> 标签：c++, string, com

我正在尝试将 _bstr_t 对象转换为 char 数组。更具体地说，我有一个预先分配的 char 数组，我知道它的大小，我想将 _bstr_t 复制到那里。

有一段时间我的代码看起来像这样：

```
 bool ReadCharPtr(_bstr_t const& input, char* output, unsigned int max_len)
  {
    //  THIS CODE IS WRONG !
    const char * temp (input );
    return ::strcpy_s(output, max_len, temp) == 0;
  } 
```

但是......我不确定，并且在 Windows 文档中也不清楚，当我调用`operator char*() const`. 是否在堆中分配了一些东西，我必须稍后解除分配？

有没有办法避免这一步，并将字符中的 _bstr_t 实际转换为预分配数组？这将避免在堆上分配字符...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:48:19.800

不，这不是必需的。文档说“运算符将指针返回到实际的内部缓冲区，因此无法修改生成的字符串。” 这意味着 _bstr_t 负责删除。

此外，您可以检查 _bstr_t 的实现：

在 MSVC 2010 中：

_bstr_t 使用 _com_util::ConvertBSTRToString() 从 BSTR 中获取字符指针。_com_util::ConvertBSTRToString() 文档说这需要被调用者删除。但是，_bstr_t 缓存这个指针并在析构函数中删除。

# php - 将数据传递给其他网站搜索

> ID：11103161
> 
> 赞同：0
> 
> 时间：2012-06-19T14:29:01.283
> 
> 标签：php, ajax, search

有没有办法`www.qantas.com.au`从我自己的表单中搜索不使用 GET 方法的其他网站？

我的意思是这样的：[http ://site.com/search.php?data=myData](http://site.com/search.php?data=myData)

我不想在我的网页上返回结果，我只想发送带有 href 的数据

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T14:32:29.330

根据网站的不同，许多表格可能包含旨在防止这种行为的 CSRF 令牌（想象一下，如果第三方网站可以为您“提交”表格到另一个网站，可能是为了转账或写令人尴尬的帖子）

也就是说，对于没有实现此功能的网站，应该可以只复制他们的表单（从`<form>`到`</form>`），包括`action="/their/website/controller"`和`method="POST"`（如果你想要它发布）

如果您想设计自己的提交相同数据的表单，只需确保输入字段`name="blah"`与您要提交的表单数据值相同

如果您不想使用表单，AJAX 也是一种选择。（见[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)）

# ruby-on-rails - Rails - “union all”之后的“order by”

> ID：11103168
> 
> 赞同：1
> 
> 时间：2012-06-19T14:29:11.787
> 
> 标签：ruby-on-rails, activerecord, sql-order-by, union-all

如何使用 Rails 语法制作这个（PostgreSQL）？：

```
SELECT fld1, fld2
FROM
(
    SELECT fld1, fld2, count(*) as cnt FROM data WHERE fld2 not in('exclude1', 'exclude2') GROUP BY fld1, fld2 ORDER BY COUNT(*) DESC LIMIT 100
    UNION ALL
    SELECT fld1, fld2, count(*) as cnt FROM data WHERE fld2 in('exclude1', 'exclude2') GROUP BY fld1, fld2
) x
ORDER BY x.cnt DESC 
```

我做了以下：

```
my_data = (Data.all(
    :select => sel_clause,
    :conditions => "data.fld2 not in %s" % [in_clause],
    :group => grp_clause,
    :order => 'count(*) desc',
    :limit => @max_rows) <<
    Data.all(
        :select => sel_clause,
        :conditions => "data.fld2 in %s" % [in_clause],
        :group => grp_clause).order('cnt desc') 
```

问题是这个 << 不是经典的“UNION ALL”，而是两个数组的连接，“order”不能应用于结果数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:00:11.903

这是我倾向于使用 find_by_sql 的地方。结果将作为一个数组返回，其中请求的列封装为您调用此方法的模型的属性。

[http://ar.rubyonrails.org/classes/ActiveRecord/Base.html](http://ar.rubyonrails.org/classes/ActiveRecord/Base.html)

~查尔斯~

# c# - 从任务栏选择子窗口时将父窗口置于前面

> ID：11103172
> 
> 赞同：0
> 
> 时间：2012-06-19T14:29:28.963
> 
> 标签：c#, wpf, window, focus, parent-child

标题几乎说明了一切，但基本上我有一个主父窗口，它偶尔会打开子窗口。现在可以从 Windows 7 任务栏中选择一个子窗口，并且只有那个窗口会被带到前面。我希望它找到一种将父窗口链接到此命令的方法，以便在任何时候选择子窗口时，父窗口也会自动被带到前面。

我尝试在子窗口“GotFocus BringIntoView()”方法中同时使用`Focus()`和`Topmost = true`命令，但同样没有乐趣。`event handler, but neither seemed to make a difference. I also tried the`有没有人见过这个或者知道实现这个的方法？

这是我到目前为止所尝试的。`mainWindow`先设置然后立即设置子窗口的逻辑是我仍然希望子窗口具有焦点，但我希望`mainWindow`高于任何其他正在运行的程序（即 Excel、VS 等）。

```
 private void Window_GotFocus(object sender, RoutedEventArgs e)
    {
        var mainWindow = Application.Current.Windows.Cast<Window>().FirstOrDefault(window => window is MainWindow) as MainWindow;

        mainWindow.Topmost = true;
        this.Topmost = true;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T18:52:14.100

我认为您正在收听错误的事件，以便在选择窗口时得到通知。订阅`Activated`您的子窗口上的事件，该事件应该让您知道您的窗口何时在任务栏中被选中。从那里你可以激活（）你的主窗口。

此外，我认为如果您将父窗口设置为子窗口的所有者，您将自动获得此行为。

# xslt - 转变 字符串值，我可以选择的值

> ID：11103173
> 
> 赞同：1
> 
> 时间：2012-06-19T14:29:37.383
> 
> 标签：xslt, xpath

我有一个变量，我需要从中动态生成节点

```
<xsl:template match="banner_discount_1 | banner_discount_2 | banner_discount_3"> 
    <xsl:variable name="link">banner_discount_<xsl:value-of select="substring-after(name(.) ,'banner_discount_')" />_link</xsl:variable>

    <xsl:value-of select="$link" />
</xsl:template> 
```

<xsl:value-of> 选择字符串，但我希望能够选择名称与变量名称匹配的节点。在我的情况下，节点看起来像这样：

```
<banner_discount_1_link />
<banner_discount_2_link />
... 
```

这是我正在使用的 xml

```
<banner_discount_1> 12 </banner_discount_1>
<banner_discount_2> 21 </banner_discount_2>
<banner_discount_3> 32 </banner_discount_3>

<banner_discount_1_link> link1 </banner_discount_1_link>
<banner_discount_2_link> link2 </banner_discount_2_link>
<banner_discount_3_link> link3 </banner_discount_3_link> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:32:33.207

使用`<xsl:value-of select="*[local-name() = $link]"/>`. 如果这没有帮助，请考虑显示 XML 示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:46:34.930

@MartinHonnen 在正确的轨道上，但您还需要设置选择上下文。

由于您在选择`banner_discount_`节点的模板中，这就是您的上下文。从您的 XML 示例中，您想要选择的节点看起来是兄弟节点，因此应该可以：

```
<xsl:value-of select="../*[local-name() = $link]"/> 
```

最好直接定位节点，但如果它们可以在文档中的任何位置，那么您可以诉诸

```
<xsl:value-of select="//*[local-name() = $link]"/> 
```

这是最后的手段，因为就文档中的节点数量而言，它可能是 O(n)。

# sql - 在 Microsoft Access 中更新询问起点和终点记录的信息

> ID：11103174
> 
> 赞同：0
> 
> 时间：2012-06-19T14:29:39.383
> 
> 标签：sql, ms-access

似乎这对你来说是一个简单的问题，但这个问题在我脑海中融化了将近 1 个小时！

我有一张桌子 (noeuds)，里面有许多不同的设备 (noeud)，每个设备的地址都是 Rivoli、insee_com、num_voie。

我需要在一个简单的查询中将地址从一个 noeud 复制到另一个由 microsoft access 用户提示的 noeud。我尝试了这样一个简单的方法，任何人都可以为我的房间带来灯光并帮助我解决这个问题吗？

```
UPDATE noeuds AS n 
SET n.RIVOLI = SELECT RIVOLI FROM noeuds WHERE (NOEUD=[orig])

WHERE (SELECT noeuds.NOEUD, noeuds.* FROM noeuds WHERE (((noeuds.NOEUD)=[dest]))); 
```

我正在使用 M$ Access 数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:41:29.610

你想多了。只需在 UPDATE 子句中使用 aliases set destination field = source field 两次引用 noeuds 表并使用简单的 where

```
UPDATE noeuds AS dest, noeuds AS source 
SET dest.RIVOLI = source.RIVOLI
WHERE 
      dest.NOEUD =[dest]  
      and 
     source.NOEUD  = [orig] 
```

# c# - 一次删除数据表所有行的快速方法

> ID：11103181
> 
> 赞同：27
> 
> 时间：2012-06-19T14:30:01.633
> 
> 标签：c#, datatable

我想删除数据表中的所有行。我使用这样的东西：

```
foreach (DataRow row in dt.Rows)
{
  row.Delete();
}
TableAdapter.Update(dt); 
```

它工作得很好，但如果我有很多行，它需要很多时间。有没有办法一次删除所有行？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-19T14:38:50.253

如果您正在针对 sqlserver 数据库运行代码，请
使用此命令

```
string sqlTrunc = "TRUNCATE TABLE " + yourTableName
SqlCommand cmd = new SqlCommand(sqlTrunc, conn);
cmd.ExecuteNonQuery(); 
```

这将是最快的方法，它将从您的表中删除所有内容并将身份计数器重置为零。

其他 RDBMS 也支持 TRUNCATE 关键字。

**5年后：**
回顾这个答案，我需要补充一些东西。仅当您绝对确定*yourTableName*变量中值的来源时，上面的答案才是好的。这意味着你不应该从你的用户那里得到这个值，因为他可以输入任何东西，这会导致 Sql Injection 问题在[这个著名的漫画](https://www.xkcd.com/327/)中得到很好的描述。始终使用不可编辑的 UI 向用户展示硬编码名称（表格或其他符号值）之间的选择。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-19T14:34:44.123

这将允许您清除所有行并保持`DataTable`.

```
dt.Rows.Clear(); 
```

还有

```
dt.Clear(); 
```

但是，调用( ) 将从 DataTable 中删除列和格式`Clear()`。`DataTable``dt`

根据[在 MSDN question 中找到的代码](https://social.msdn.microsoft.com/Forums/en-US/be8066c7-0415-4977-9277-e73da98198b6/difference-between-datatableclear-and-datatablerowsclear?forum=csharplanguage)，内部方法由`DataRowsCollection`, 和`DataTable`使用不同的`boolean`参数调用：

```
internal void Clear(bool clearAll)
{
    if (clearAll) // true is sent from the Data Table call
    {
        for (int i = 0; i < this.recordCapacity; i++)
        {
            this.rows[i] = null;
        }
        int count = this.table.columnCollection.Count;
        for (int j = 0; j < count; j++)
        {
            DataColumn column = this.table.columnCollection[j];
            for (int k = 0; k < this.recordCapacity; k++)
            {
                column.FreeRecord(k);
            }
        }
        this.lastFreeRecord = 0;
        this.freeRecordList.Clear();
    }
    else // False is sent from the DataRow Collection
    {
        this.freeRecordList.Capacity = this.freeRecordList.Count + this.table.Rows.Count;
        for (int m = 0; m < this.recordCapacity; m++)
        {
            if ((this.rows[m] != null) && (this.rows[m].rowID != -1))
            {
                int record = m;
                this.FreeRecord(ref record);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-06-19T14:34:23.747

正如有人提到的，只需使用：

```
dt.Rows.Clear() 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-19T14:36:09.503

这是从 dbms 中的表中删除所有行的最简单方法`DataAdapter`。但是如果你想在一批中完成，你可以将 DataAdapter 设置[`UpdateBatchSize`](http://msdn.microsoft.com/en-us/library/system.data.common.dbdataadapter.updatebatchsize.aspx)为 0（无限制）。

另一种方法是使用简单`SqlCommand`的 CommandText `DELETE FROM Table`：

```
using(var con = new SqlConnection(ConfigurationSettings.AppSettings["con"]))
using(var cmd = new SqlCommand())
{
    cmd.CommandText = "DELETE FROM Table";
    cmd.Connection = con;
    con.Open();
    int numberDeleted = cmd.ExecuteNonQuery();  // all rows deleted
} 
```

但是，如果您只想`DataRows`从中删除`DataTable`，则只需调用[`DataTable.Clear`](http://msdn.microsoft.com/en-us/library/system.data.datatable.clear.aspx). 这将防止在 dbms 中删除任何行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-19T14:31:31.097

你为什么不直接用 SQL 来做呢？

```
DELETE FROM SomeTable 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-19T14:37:21.970

只需使用`dt.Clear()`

您还可以将 TableAdapter/DataAdapter 设置为在填充数据之前清除。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-19T14:35:42.233

如果您真的关心速度而不担心数据，您可以执行截断。但这是假设您的 DataTable 位于数据库上，而不仅仅是内存对象。

```
TRUNCATE TABLE tablename 
```

不同之处在于这会删除所有行而不记录行删除，从而使事务更快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-27T09:44:57.147

[在这里](https://stackoverflow.com/questions/4828036/how-to-remove-rows-from-huge-data-table-without-iterating-it/17896351#17896351)，我们有同样的问题。您可以使用以下代码：

```
SqlConnection con = new SqlConnection();
con.ConnectionString = ConfigurationManager.ConnectionStrings["yourconnectionstringnamehere"].ConnectionString;
con.Open();
SqlCommand com = new SqlCommand();
com.Connection = con;
com.CommandText = "DELETE FROM [tablenamehere]";
SqlDataReader data = com.ExecuteReader();
con.Close(); 
```

但在您需要将以下代码导入项目之前：

```
using System.Configuration;
using System.Data.SqlClient; 
```

这是可以删除所有行的代码的特定部分是一个表：

```
DELETE FROM [tablenamehere] 
```

这必须是您的表名：`tablenamehere` - 这可以删除表中的所有行：`DELETE FROM`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-23T09:40:37.570

我使用[MDaf](https://www.nuget.org/packages/MDaf/)只需使用以下代码：

```
DataContext db = new DataContext(ConfigurationManager.ConnectionStrings["con"].ConnectionString);
db.TruncateTable("TABLE_NAME_HERE");
//or
db.Execute("TRUNCATE TABLE TABLE_NAME_HERE "); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-06T23:20:11.023

这是一种使用实体固件且没有 SQL 注入或 TSQL 的干净而现代的方法。

```
using (Entities dbe = new Entities())
{
    dbe.myTable.RemoveRange(dbe.myTable.ToList());
    dbe.SaveChanges();
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-06-19T14:32:20.287

DataTable 类上是否有 Clear() 方法？

我认为有。如果有，请使用它。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2012-06-19T14:34:08.450

`Datatable.clear()`来自类 DataTable 的方法

# c# - 如何在 Visual Studio 中创建独立的 exe？

> ID：11103188
> 
> 赞同：5
> 
> 时间：2012-06-19T14:30:29.197
> 
> 标签：c#, visual-studio, compilation

> **可能重复：**
> [在编译的可执行文件中嵌入 DLL](https://stackoverflow.com/questions/189549/embedding-dlls-in-a-compiled-executable)

我想将我的 C# 应用程序编译为单个 exe 文件。问题是我的项目依赖于许多其他项目，导致在`Release`编译时文件夹中有许多 dll。有什么方法可以制作包含这些 dll 的 exe？

注意：它不需要独立于 .NET 框架。我假设任何使用这个 exe 的人都会安装它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T14:34:45.010

.NET 附带了一个名为 ILMerge 的工具，可以将多个程序集打包到一个文件中。你会像这样使用它：

```
ilmerge /target:winexe /out:myoneexecutable.exe Foo.exe Bar1.dll Bar2.dll 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T14:39:09.380

ILMerge 是一种选择，但它不能合并 WPF 程序集。您可以将程序集作为资源嵌入并动态加载它们。请参阅[此 Richter 文章](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:35:20.117

我相信最接近能够编译为单个可执行文件的方法是使用 Visual Studio 的安装项目功能/向导来生成标准 MSI 包，然后您可以使用它来分发您的应用程序。

但是，很可能有 3rd 方工具可让您将所有内容压缩到一个文件中。但我认为这不会比标准的 MSI 方法为您带来任何好处——事实上，这只是构建过程中的一个额外手动步骤，您并不需要这样做。

# r - 如何找出 R 中加载了哪个包版本？

> ID：11103189
> 
> 赞同：505
> 
> 时间：2012-06-19T14:30:29.473
> 
> 标签：r, package, version

我正在弄清楚如何使用我的大学集群。它安装了 2 个版本的 R。系统范围的 R 2.11 (Debian 6.0) 和 R 2.14.2 在非标准位置。

我正在尝试将 MPI 与雪一起使用。我试图运行的代码如下

```
library(snow)
library(Rmpi)
cl <- makeMPIcluster(mpi.universe.size()-1)
stopCluster(cl)
mpi.quit() 
```

它在 R 2.11 上没有问题。（我用 启动脚本`mpirun -H localhost,n1,n2,n3,n4 -n 1 R --slave -f code.R`）。现在，当我尝试使用 R 2.14.2 执行此操作时，我收到以下消息：

```
Error: This is R 2.11.1, package 'snow' needs >= 2.12.1
In addition: Warning message: 
```

所以看起来 R 加载了为 R 2.11 编译的包雪版本。我已将 R 2.14 下的 snow 安装到我的主文件夹中，并将以下几行添加到我的代码中：

```
.libPaths("/soft/R/lib/R/library")
.libPaths("~/R/x86_64-pc-linux-gnu-library/2.11")
print(.libPaths())
print(sessionInfo())
print(version) 
```

并且错误之前的输出确认我确实在运行 R 2.14.2 并且我的 R 包文件夹在搜索路径中是第一个。但我仍然得到错误。

所以我的问题是如何确定 R 中加载了哪个版本的包？我可以看到 `installed.packages`所有已安装的软件包，所以也许有一些函数列出了已加载软件包的类似信息？

* * *

## 回答 #1

> 赞同：653
> 
> 时间：2012-06-19T14:31:47.137

你可以用它`sessionInfo()`来实现。

```
> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] graphics  grDevices utils     datasets  stats     grid      methods   base     

other attached packages:
[1] ggplot2_0.9.0  reshape2_1.2.1 plyr_1.7.1    

loaded via a namespace (and not attached):
 [1] colorspace_1.1-1   dichromat_1.2-4    digest_0.5.2       MASS_7.3-18        memoise_0.1        munsell_0.3       
 [7] proto_0.3-9.2      RColorBrewer_1.0-5 scales_0.2.0       stringr_0.6       
> 
```

但是，根据评论和下面的答案，有更好的选择

```
> packageVersion("snow") 
```

[1] '0.3.9'</p>

或者：

```
"Rmpi" %in% loadedNamespaces() 
```

* * *

## 回答 #2

> 赞同：320
> 
> 时间：2012-06-19T14:36:34.357

您可以使用[`utils::packageVersion`](https://rdrr.io/r/utils/packageDescription.html)查看安装了哪个版本的软件包：

```
> packageVersion("snow")
[1] ‘0.3.9’ 
```

[注意](https://rdrr.io/r/utils/packageDescription.html#heading-3)

> `DESCRIPTION`除非包含包含有效`Version`字段的文件，否则不会“找到”包。当没有找到包目录和有合适的目录但没有有效`DESCRIPTION`文件时会给出不同的警告。

尽管听起来您想查看正在运行的 R 版本，但在这种情况下，[@Justin 的`sessionInfo`建议](https://stackoverflow.com/a/11103209/7196903)是可行的方法。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2016-05-22T00:07:35.793

从技术上讲，此时所有的答案都是错误的。`packageVersion`不返回加载包的版本。它进入磁盘，并从那里获取包版本。

在大多数情况下，这不会产生影响，但有时会。据我所知，获取*加载*包版本的唯一方法是相当 hackish：

```
asNamespace(pkg)$`.__NAMESPACE__.`$spec[["version"]] 
```

`pkg`包名称在哪里。

编辑：我不确定何时添加此功能，但您也可以使用`getNamespaceVersion`，这更清洁：

```
getNamespaceVersion(pkg) 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-06-19T14:32:09.583

要检查 R 的版本，请执行：`R --version`

或者在你进入 R shell 之后打印`version$version.string`

**编辑**

要检查已安装软件包的版本，请执行以下操作。

加载库后，可以执行`sessionInfo ()`

但是要知道所有已安装软件包的列表：

```
packinfo <- installed.packages(fields = c("Package", "Version"))
packinfo[,c("Package", "Version")] 
```

或者要提取特定的库版本，一旦您使用上述`installed.package`函数提取了信息，只需在矩阵的第一维中使用包的名称。

```
packinfo["RANN",c("Package", "Version")]
packinfo["graphics",c("Package", "Version")] 
```

以上将打印RANN库和图形库的版本。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2012-09-23T02:22:49.407

你可以尝试这样的事情：

1.  `package_version(R.version)`

2.  `getRversion()`

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2016-10-17T13:25:08.813

**图形界面解决方案：**

如果您使用的是 RStudio，则可以在`Packages`窗格中检查包版本。

[![在此处输入图像描述](../Images/dc5a717aff13608349bc7e322dd6395f.png)](https://i.stack.imgur.com/aQP0w.png)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-05-14T05:04:44.163

使用 R 方法`packageDescription`获取已安装的包描述，对于版本，只需使用`$Version`：

```
packageDescription("AppliedPredictiveModeling")$Version
[1] "1.1-6" 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-02-24T16:49:23.397

根据前面的答案，这里是打印 R 版本的简单替代方法，后跟命名空间中加载的每个包的名称和版本。它适用于 Jupyter 笔记本，我在其中运行时遇到问题，`sessionInfo()`并且`R --version`.

```
print(paste("R", getRversion()))
print("-------------")
for (package_name in sort(loadedNamespaces())) {
    print(paste(package_name, packageVersion(package_name)))
} 
```

出去：

```
[1] "R 3.2.2"
[1] "-------------"
[1] "AnnotationDbi 1.32.2"
[1] "Biobase 2.30.0"
[1] "BiocGenerics 0.16.1"
[1] "BiocParallel 1.4.3"
[1] "DBI 0.3.1"
[1] "DESeq2 1.10.0"
[1] "Formula 1.2.1"
[1] "GenomeInfoDb 1.6.1"
[1] "GenomicRanges 1.22.3"
[1] "Hmisc 3.17.0"
[1] "IRanges 2.4.6"
[1] "IRdisplay 0.3"
[1] "IRkernel 0.5" 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-10-04T12:12:25.070

老问题，但不是答案之一是我最喜欢的命令来快速和简短地了解所有加载的包：

```
(.packages()) 
```

要查看所有已加载包的安装版本，只需使用上述命令来设置子集`installed.packages()`。

```
installed.packages()[(.packages()),3] 
```

通过更改列号（包版本为 3），您可以获得存储在`installed.packages()`易于阅读的矩阵中的任何其他信息。以下是版本号和依赖关系的示例：

```
installed.packages()[(.packages()),c(3,5)] 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-24T08:07:42.083

使用以下代码获取系统中安装的R包的版本：

```
installed.packages(fields = c ("Package", "Version")) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-01-13T17:15:32.460

Search() 可以给出会话中附加包的更简化列表（即，没有 sessionInfo() 给出的详细信息）

search {base}- R 文档
描述：给出附加包的列表。[搜索（）](https://stat.ethz.ch/R-manual/R-devel/library/base/html/search.html)

```
search()
#[1] ".GlobalEnv"        "package:Rfacebook" "package:httpuv"   
#"package:rjson"    
#[5] "package:httr"      "package:bindrcpp"  "package:forcats"   # 
#"package:stringr"  
#[9] "package:dplyr"     "package:purrr"     "package:readr"     
#"package:tidyr"    
#[13] "package:tibble"    "package:ggplot2"   "package:tidyverse" 
#"tools:rstudio"    
#[17] "package:stats"     "package:graphics"  "package:grDevices" 
#"package:utils"    
#[21] "package:datasets"  "package:methods"   "Autoloads"         
#"package:base" 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-04-03T02:10:57.183

只需使用`help(package="my_package")`并查看显示的版本。

这假设在同一`.libPaths`.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-08-23T09:40:52.280

要添加@GSee 的答案，请注意返回的值`utils::packageVersion()`不是 a`character`并且您可以完美地使用它来编写条件：

```
packageVersion("dplyr")
#> [1] '1.0.7'
packageVersion("dplyr")>1
#> [1] TRUE
packageVersion("dplyr")>'1.0'
#> [1] TRUE
packageVersion("dplyr")>'1.1'
#> [1] FALSE 
```

^(由[reprex 包](https://reprex.tidyverse.org)于 2021-08-23 创建 (v2.0.0 ))

# scala - Scala - 带有 MultiMap 的双 HashMap

> ID：11103197
> 
> 赞同：0
> 
> 时间：2012-06-19T14:30:51.553
> 
> 标签：scala, hash, hashtable, nested

我目前有一个看起来像这样的变量：

```
val someVal = new HashMap[Float, Set[String]] with MultiMap[Float, String] 
```

现在我想要这些散列形式的散列：

```
val someHashOfSomeVal = new HashMap[String, HashMap[Float, Set[String]] with MultiMap[Float, String]] 
```

换句话说，我需要一个哈希表（每个键有多个值）的哈希表（每个键有多个值）。谁能帮助我如何声明/改变这个变量？

我要这样变异吗？`someHashOfSomeVal.addBinding("someKey", someVal)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T18:18:15.033

我不清楚为什么您希望顶级映射每个键具有多个值（在本例中为其他映射），或者在实践中如何工作。我假设您只想要`MultiMap`较低级别的，在这种情况下您可以使用以下方法：

```
import scala.collection.mutable.{ HashMap, MultiMap, Set }    

class TwoLevel[A, B, C] extends HashMap[A, MultiMap[B, C]] {
  override def default(key: A) = new HashMap[B, Set[C]] with MultiMap[B, C]
  def addTriple(a: A, b: B, c: C) {
    this += a -> this(a).addBinding(b, c)
  }

  def lookupPair(a: A, b: B): Set[C] = this(a).getOrElse(b, Set.empty)
}

val m = new TwoLevel[String, Float, String]

m.addTriple("a", 1.0F, "b")
m.addTriple("a", 0.0F, "c")

println(m.lookupPair("a", 0.0F)) 
```

`Set(c)`正如您所期望的那样打印。

# objective-c - 使用同一项目中的 ARC 和非 ARC 版本会出现重复符号错误

> ID：11103200
> 
> 赞同：0
> 
> 时间：2012-06-19T14:30:56.343
> 
> 标签：objective-c, automatic-ref-counting

这个问题在某种程度上类似于关于如何使 ARC 和非 ARC 代码一起工作的问题，但这有点不同，因为我需要使用的 ARC 和非 ARC 代码实际上都来自同一个项目。详细信息如下：

我在我的项目中使用了启用 ARC 的[SBJson](http://stig.github.com/json-framework/)有一段时间了，一切都很好，需要包含util [sinaweibosdkforoauth2 。](http://code.google.com/p/sinaweibosdkforoauth2/)通过[使用静态库混合 ARC 和非 ARC 代码，](http://www.seriousmonster.com/mixing-arc-and-non-arc-code-with-static-libraries/)我能够在启用 ARC 的项目中使用非 ARC 项目，对我来说真正的问题是 sinaweibosdkforoauth2 请求启用非 ARC 的 SBJson（当时它是 json -framework on google code）所以在链接时我收到一个错误，说找到了重复的符号（例如 SBJsonWriter）。

我在 Internet 上找到的一种可能的解决方案是在任一项目中重命名重复的类名。我还没有尝试过，因为我不想接触第 3 方源代码。可能吗？还是我走错了方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T02:31:19.880

你越来越糊涂了。没有什么可以“要求”非 ARC 启用的 SBJSON。ARC 代码与非 ARC 代码完全兼容。只需在您的项目中包含一次 SBJSON，它是否为 ARC 都没有关系。

# sql - 如何使 SQL 符合 zIIP 处理条件？

> ID：11103202
> 
> 赞同：3
> 
> 时间：2012-06-19T14:31:16.623
> 
> 标签：sql, db2, query-optimization, zos

是否可以更改 z/OS 大型机 COBOL 应用程序中的 SQL，使其有资格被定向到 IBM System z 集成信息处理器 (zIIP)？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T16:18:33.313

一个重要的区别是，根据 IBM 的说法，zIIP 仅适用于“符合条件的数据库工作负载”，而这些“符合条件的”负载主要针对在分布式服务器上运行的大型 BI/ERP/CRM 解决方案，这些解决方案通过[DDF进行连接（分布式数据设施）](https://www.ibm.com/support/knowledgecenter/SSEPEK_12.0.0/intro/src/tpc/db2z_distributeddatafacility.html)通过 TCP/IP。

[IBM 有一个](https://www.ibm.com/support/knowledgecenter/SSEPEK_12.0.0/perf/src/tpc/db2z_ibmziip.html)可以利用 zIIP 的 DB2 工作负载列表。这些包括：

*   处理来自通过 TCP/IP 访问 DB2 的应用程序的 SQL 请求的 DDF 服务器线程（高达 60%）
*   并行子进程。如果每个子进程代表源自相关地址空间的应用程序进行处理，则每个子进程的一部分在依赖飞地 SRB 下执行；如果代表通过 TCP 访问 DB2 的远程应用程序执行处理，则在独立飞地 SRB 下执行处理/IP。飞地优先级继承自从属飞地的调用相关地址空间或独立飞地的主 DDF 服务器线程飞地分类。（最高 11 的版本允许 80% 在 zIIP 上运行，v12 将此提升到 100% 合格）。
*   LOAD、REORG 和 REBUILD INDEX 实用程序的实用程序索引构建和维护过程。

如果您使用的是 DB2 v10，您还可以将 zIIP 用于：

*   远程本地 SQL 过程。
*   XML Schema 验证和非验证解析。
*   用于维护索引结构的 DB2 实用程序函数。
*   RUNSTATS 实用程序的某些处理部分。
*   DB2 缓冲池的预取和延迟写入处理

版本 11 添加了以下内容：

*   在 Db2 ssnmMSTR、ssnmDBM1 和 ssnmDIST 地址空间中执行的异步飞地 SRB（服务请求块），除了 p-lock 协商处理。这些进程包括用于预取、延迟写入、页面集排除、日志读取和日志写入处理的 Db2 缓冲池处理。其他符合条件的过程包括索引伪删除和 XML 多版本文档清理处理。

版本 12 允许并行子任务在达到一定的 CPU 使用阈值后 100% 进入 zIIP。

因此，如果您使用的是 COBOL 程序，那么 IBM 似乎并不打算让您将 zIIP 用于这些工作负载。您仍然可以通过实用程序（LOAD、REORG）和 RUNSTATS 实用程序的某些步骤来利用 zIIP，因此拥有一些 zIIP 可能仍然值得。

# debugging - 使用带有 jinja2 模板的应用引擎交互控制台

> ID：11103205
> 
> 赞同：3
> 
> 时间：2012-06-19T14:31:28.240
> 
> 标签：debugging, google-app-engine, python-2.7, jinja2

```
from jinja2 import Template
template = Template('Hello {{ name }}!')
template.render(name='John Doe') 
```

我已将上述内容输入到应用引擎的交互式控制台中，但没有得到任何输出。我怎样才能得到输出？

我尝试将在以下链接中找到的代码添加到控制台，但仍然没有输出。

[在 Google App Engine 中调试 Jinja2](https://stackoverflow.com/questions/3086091/debug-jinja2-in-google-app-engine)

谢谢，

布赖恩在亚特兰大

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T14:49:57.803

您忘记添加打印件了。试试这个：

```
from jinja2 import Template
template = Template('Hello {{ name }}!')
print template.render(name='John Doe') 
```

# mysql - 比较两个表 MySQL

> ID：11103208
> 
> 赞同：4
> 
> 时间：2012-06-19T14:31:37.603
> 
> 标签：mysql, join, compare

我有两个相似的表 table_a 和 table_b table_a 是我的当前数据，我需要使用临时表 table_b 更新此信息。两者之间的唯一区别是 table_a 有一个 table_b 没有的密码字段。

我正在尝试做几件事。

```
1.Compare the data based on the "user_id" field. 
2\. If there is a user_id not found in table_b but there is one in table_a remove that row in table_a
3\. If there is a user_id in table_b that is not found in table_a add that row of data to table_a
4\. If the user_id is found in both then check two of the fields "email" and "job_code" and make sure they are both whatever table_b says. 
```

我应该按照上面编号的顺序在单独的 MySQL 语句中执行此操作吗？以下是我对上述陈述的尝试。非常感谢任何帮助或故障排除。谢谢！

声明 1：

```
SELECT * FROM table_a
WHERE table_a.user_id
NOT IN (
SELECT table_b.user_id
FROM table_b
WHERE table_a.user_id=table_b.user_id
)  // But how do I delete those records that are selected? 
```

声明 2：

```
SELECT * FROM table_b
WHERE table_b.user_id
NOT IN (
SELECT table_a.user_id
FROM table_a
WHERE table_a.user_id=table_b.user_id
) //How do I Insert these records that I have in table_b but not in table_a 
```

声明 3：

```
SELECT email FROM table_b
WHERE table_b.user_id = table_a.user_id,
AND table_b.email != table_a.email  //now I need to update table_a with the emails from table_b 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:43:17.240

声明#1

```
DELETE A.*
FROM table_a A
LEFT JOIN table_b B
USING (user_id)
WHERE B.user_id IS NULL; 
```

声明#2

```
INSERT INTO table_b (column1,column2,...,columnN)
SELECT A.column1,A.column2,...,A.columnN
FROM table_b B LEFT JOIN table_a A
USING (user_id)
WHERE A.user_id IS NULL; 
```

声明#3

```
UPDATE table_a A INNER JOIN table_b B USING (user_id)
SET A.email = B.email,A.job_code = B.job_code; 
```

## **更新 2012-06-19 11:54 EDT**

A 和 B 只是表的别名。

例如，语句#3 的查询可以写成如下：

```
UPDATE table_a as A INNER JOIN table_b as B USING (user_id)
SET A.email = B.email,A.job_code = B.job_code; 
```

或者没有任何别名，像这样：

```
UPDATE table_a INNER JOIN table_b USING (user_id)
SET table_a.email = table_b.email,table_a.job_code = table_b.job_code; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:38:56.747

第一个问题的解决方法:: 1)

```
delete FROM table_a
left join table_b
on 
table_a.user_id=table_b.user_id
and  table_a.user_id is null 
```

# python - PyV8，我可以操作 DOM 结构吗？

> ID：11103210
> 
> 赞同：5
> 
> 时间：2012-06-19T14:31:51.273
> 
> 标签：python, v8

假设我们有 PyV8：

```
import PyV8
ctxt = PyV8.JSContext() 
```

和一个 python DOM 结构，例如`xml.dom`

如何将 .js 文件提供给 PyV8，以便它可以更改我拥有的 DOM 结构。
如果我有它的内容：

```
$("#id").remove(); 
```

我希望删除 dom 项。

[PyV8](http://code.google.com/p/pyv8/)有完美的 hello-world 示例。但我想看看有用的东西。

说清楚，我想做的是：
`"Javascript file"`-->--**魔法**-->--`DOM, (already built with html file) and changed now with passed javascript file`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T09:10:20.840

可以在这里找到您尝试做的一个很好的例子：

[https://github.com/buffer/thug](https://github.com/buffer/thug)

它是一个 python http 客户端，通过 PyV8 执行 JS 用于安全研究目的，但可以很容易地捆绑起来以满足更简单的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T04:44:38.730

格式化的应用程序。我尽可能地隔开，但我的屏幕阅读器不喜欢 SO 的格式控制。

我将尝试回答您的问题，尽管它似乎有点模糊。如果我需要重写此答案以适应不同的情况，请告诉我。我假设您正在尝试从 Web 获取 HTML 文件，并从该文件中运行 Javascript，以对所述文档执行操作。不幸的是，没有一个 Python xml 库具有真正的 DOM 支持，而且我发现的每个包中都不存在 W3C DOM 合规性。您可以做的是使用 PyV8 w3c.py dom 文件作为起始示例，并创建您自己的完整 DOM。 [W3C Sample Dom](http://code.google.com/p/pyv8/source/browse/trunk/demos/w3c.py) 不过，您需要重写此模块，因为它不尊重引号或撇号。BeautifulSoup 也不是最快的解析器。我建议使用类似 lxml.etree 的目标解析器选项。 [LXML 目标解析器](http://lxml.de/parsing.html) 搜索“提要解析器接口”。然后，您可以使用 LXML 加载 HTML/Script 文档，将其解析如下，然后在创建的 DOM 上运行您需要的每个脚本。

在下面找到一个部分示例。（请注意，HTML 标准是庞大的、分散的，并且 _highly 浏览器特定，因此您的 milage 可能会有所不同）。

```
class domParser(object):
    def __init__(self):
    #initialize dom object here, and obtain the root for the destination file object.
        self.dom = newAwesomeCompliantDom()
        self.document = self.dom.document
        self.this = self.document

    def comment(self, commentText):
    #add commentText to self.document or the above dom object you created
        self.this.appendChild(self.document.DOMImplementation.createComment(commentText))

    def start(self, tag, attrs):
    #same here
        self.this = self.this.appendChild(self.document.DOMImplimentation.newElement(tag,attrs))

    def data(self, dataText):
    #append data to the last accessed element, as a new Text child
        self.this.appendChild(self.document.DOMImpl.createDataNode(dataText))

    def end(self):
    #closing element, so move up the tree
        self.this = self.this.parentNode

    def close(self):
        return self.document

#unchecked, please validate yourself
x = lxml.etree.parse(target=domParser)
x.feed(htmlFile)
newDom = x.close() 
```

# java - 如何在 solr 中搜索短语

> ID：11103211
> 
> 赞同：0
> 
> 时间：2012-06-19T14:31:53.833
> 
> 标签：java, solr, lucene, full-text-search

我有一个关于dismax的问题​​。

我有这个查询：

```
/itas?q=privacy%20policy&debugQuery=true&wt=xml&indent=on&pf=title^99&ps=2&mm=2&ps=2&qs=2 
```

我在打开 debugQuery 的情况下得到了这个响应

```
 <lst name="debug">
    <str name="rawquerystring">privacy policy</str>
    <str name="querystring">privacy policy</str>
    <str name="parsedquery">
+((DisjunctionMaxQuery((text:privacy)~0.01) DisjunctionMaxQuery((text:polici)~0.01))~2) DisjunctionMaxQuery((title:"privacy polici"~2^99.0)~0.01)
    </str>
    <str name="parsedquery_toString">
+(((text:privacy)~0.01 (text:polici)~0.01)~2) (title:"privacy polici"~2^99.0)~0.01
    </str>

    <lst name="explain">
        <str name="http://blah.com/">
0.0 = (MATCH) sum of: 0.0 = (MATCH) sum of: 0.0 = (MATCH) weight(text:privacy in 0), product of: 7.610095E-4 = queryWeight(text:privacy), product of: 1.0009153 = idf(docFreq=1091, maxDocs=1093) 7.603136E-4 = queryNorm 0.0 = (MATCH) fieldWeight(text:privacy in 0), product of: 1.4142135 = tf(termFreq(text:privacy)=2) 1.0009153 = idf(docFreq=1091, maxDocs=1093) 0.0 = fieldNorm(field=text, doc=0) 0.0 = (MATCH) weight(text:polici in 0), product of: 7.6379965E-4 = queryWeight(text:polici), product of: 1.004585 = idf(docFreq=1087, maxDocs=1093) 7.603136E-4 = queryNorm 0.0 = (MATCH) fieldWeight(text:polici in 0), product of: 1.0 = tf(termFreq(text:polici)=1) 1.004585 = idf(docFreq=1087, maxDocs=1093) 0.0 = fieldNorm(field=text, doc=0)
        </str> 
```

我在 parsedquery_toString 部分看到标题被查询“隐私策略”，但为什么在响应中不考虑相同的字符串？一切都分为“隐私”和“政策”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:36:13.410

那么你必须搜索`q="privacy polici"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-25T15:33:01.030

您实际上是否有任何与该短语查询匹配的文档？在我看来是正确的。该短语不会出现在由单个单词短语匹配但与该短语不匹配的文档的解释中。文档的分数将仅包括匹配的术语 \ 短语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-26T02:26:54.680

看起来搜索只在文本字段而不是标题字段上完成

使用 pf（短语字段）时要注意的是它只影响结果的提升，但不影响匹配。

因此，如果您没有通过 title 字段获得结果，请回顾架构，并确保 title 字段为 (indexed = true)，也许这就是原因。

如果您将得到的响应的架构和示例放入其中，也许您可​​以获得更多帮助

# java - ConcurrentHashMap 内存开销

> ID：11103216
> 
> 赞同：10
> 
> 时间：2012-06-19T14:32:07.100
> 
> 标签：java, hashmap, concurrenthashmap, memory-profiling

有人知道 ConcurrentHashMap 的内存开销是多少（与“经典”HashMap 相比）？

*   在施工？
*   在插入元素时？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-19T15:33:00.073

`-XX:-UseTLAB -XX:NewSize=900m -mx1g`如果您在 64 位 JVM 上运行以下命令。

```
public static void main(String... args) throws NoSuchMethodException, IllegalAccessException {
    for (int i = 0; i < 4; i++) {
        long used1 = usedMemory();
        populate(new HashMap());
        long used2 = usedMemory();
        populate(new ConcurrentHashMap());
        long used3 = usedMemory();
        System.out.println("The ratio of used memory is " + (double) (used3 - used2) / (used2 - used1));
        System.out.println("For an extra " + ((used3 - used2) - (used2 - used1)) / 1000000 + " bytes per entry was used.");
    }
}

private static void populate(Map map) {
    for (Integer i = 0; i < 1000000; i++)
        map.put(i, i);
}

private static long usedMemory() {
    return Runtime.getRuntime().totalMemory() - Runtime.getRuntime().freeMemory();
} 
```

使用 Java 6 和 7 可以获得一百万个条目。

```
The ratio of used memory is 1.1291128466982379
For an extra 8 bytes per entry was used.
The ratio of used memory is 1.1292086928728067
For an extra 8 bytes per entry was used.
The ratio of used memory is 1.1292086928728067
For an extra 8 bytes per entry was used.
The ratio of used memory is 1.1292086928728067
For an extra 8 bytes per entry was used. 
```

8 MB 内存的成本约为 5 美分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T16:18:18.090

`ConcurrentHashMap``HashMap`在构造和插入时都不会使用比 更多的内存。

**初始化时**

`ConcurrentHashMap`使用与 HashMap 几乎相同的内存量，对于几个额外的簿记变量和锁可能会稍微多一些。

初始化时，`ConcurrentHashMap`创建16个Segment来存储key-value，每个Segment相当于一个HashMap。

每个Segment的初始容量/大小是整体初始容量的1/16。所以本质上，`ConcurrentHashMap`创建了16个小HashMap，相当于一个HashMap。每个 Segment 都有自己的锁和几个簿记变量（计数、阈值等），这是额外的内存开销。

您可以`ConcurrentHashMap`通过将适当的值传递给*concurrencyLevel*参数来控制所创建的段数`ConcurrentHashMap`。这个值越小，当大量线程更新 Map 时，将使用更少的空间但更多的争用。此值越高，将创建更多 Segment，但并行更新的性能会更快。*注意： concurrencyLevel*参数的值明显较高，会影响空间和时间。

内存中的这种小开销是开发人员愿意接受的以换取并发性。

**插入时**

当 Segments 被填充时，该 Segment 的大小将增加。增加大小的策略与 HashMap 相同。*loadfactor*参数决定何时增加 Segment 的大小。请注意，仅填充的 Segment 会增加。再一次，内存开销几乎与 HashMap 相同。

总体而言，`ConcurrentHashMap`它使用的内存并不比. 多得多`HashMap`，但很难测量`ConcurrentHashMap`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T14:38:49.240

我真的不明白这个问题的前提——要么你需要并发，要么你不需要。

但是，根据[这个链接](http://www.javatuning.com/concurrenthashmap-fat-memory-footprint/)，一个空的内存占用`ConcurrentHashMap`是 1700 字节。`ConcurrentHashMap`如果您有多个线程需要读/写访问权限，则建议您使用，但`Hashtable`如果您有许多线程需要读访问权限但一个线程需要写权限，则建议您使用。

# php - 重新写入或格式化 .txt 文件中的内容以在前面添加编号，在末尾添加分号

> ID：11103223
> 
> 赞同：0
> 
> 时间：2012-06-19T14:32:35.027
> 
> 标签：php, file

我有一个包含内容的 .txt 文件（见第一张图片） 我需要的内容是它应该在每行的末尾编号和逗号（见第二张图片）。

![第一张图片：文件中的原始内容](../Images/8128538ce170cf707c7a41f9bb40d89b.png)

![第二张图片：文件中的所需内容](../Images/a1942f1839798cf71eb7b6355a3d3251.png)

1.  我想在第一行前面插入说：“1”=>”。编号将在第二行增加，因此大约有 4747 行，最后一个数字将是 4747。
2.  然后在每一行的末尾插入："。

我对 PHP 有一些了解，所以如果有人有解决方案或想法会有所帮助。我一直在手动格式化，这非常耗时

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:36:44.980

使用 PHP：

1.  打开您的原始文件（考虑 fopen() 或 file_get_contents）
2.  通过换行符拆分为数组（explode()）
3.  逐行处理数组（for 或 foreach）
4.  前置当前行号
5.  附加引号和逗号
6.  循环到下一个数组成员
7.  完成后 - 将内容保存到文件 (file_put_contents())

这应该足以让您自己解决！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:37:22.673

使用 PHP 的[file()](http://www.php.net/manual/en/function.file.php)，它将为您提供一个数组，每行一个元素。之后，它应该是一个简单的问题，即迭代数组`foreach`并将适当的位连接到字符串上。然后使用`fopen()`和`fwrite()`将编辑的行写入输出文件。

# android - 在 LoaderManager 和 MediaStore 中使用多个 Loader “找不到这样的列”

> ID：11103224
> 
> 赞同：0
> 
> 时间：2012-06-19T14:32:39.083
> 
> 标签：android, mediastore, android-loadermanager, android-cursorloader

从音乐的标题中，尝试得到对应的艺术家、专辑名称和专辑封面。我使用`LoaderManager`和`CursorLoader`。创建 Activity 后，我用`getLoaderManager().initLoader(1, null, this)`. 这是我的加载器的代码：

**在创建加载器时**

```
static final String[] PLAYER_SUMMARY_PROJECTION = { MediaStore.Audio.Media._ID, MediaStore.Audio.Media.TITLE, MediaStore.Audio.Media.ARTIST, MediaStore.Audio.Media.ALBUM};
    static final String[] PLAYER_COVER_SUMMARY_PROJECTION = { MediaStore.Audio.Albums.ALBUM_ID, MediaStore.Audio.Albums.ALBUM_ART, MediaStore.Audio.Albums.ALBUM};

    public Loader<Cursor> onCreateLoader(int id, Bundle arg1) {
        CursorLoader loader;    

    if(id==1){

        String where = android.provider.MediaStore.Audio.Media.TITLE
                  + "=?";
        String whereVal[] = {dataalbumsTrackRequested};
        loader = new CursorLoader(getActivity(), MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,  
        PLAYER_SUMMARY_PROJECTION, where, whereVal,null); }

    else{

         String where2 = android.provider.MediaStore.Audio.Media.ALBUM
          + "=?";
         String whereVal2[] = {album};
         loader = new CursorLoader(getActivity(), MediaStore.Audio.Albums.EXTERNAL_CONTENT_URI,  
         PLAYER_COVER_SUMMARY_PROJECTION, where2, whereVal2,null);  }

    return loader;

    } 
```

**加载完成**

```
public void onLoadFinished(Loader<Cursor> loader, Cursor cursor) {

     if(loader.getId()==1){

     //Fill the text view with their value

     //Set Title
     String title =cursor.getString(cursor.getColumnIndex(MediaStore.Audio.Media.TITLE));
     TextView titleView = (TextView)getView().findViewById(R.id.musicTitle);
     titleView.setText(title);

     //Set Artist
     String artist =cursor.getString(cursor.getColumnIndex(MediaStore.Audio.Media.ARTIST));
     TextView artistView = (TextView)getView().findViewById(R.id.artistName);
     if (artist.equals("<unknown>")){artistView.setText(R.string.unknown_album);}
     else { artistView.setText(artist);}

     //Set Album
     album =cursor.getString(cursor.getColumnIndex(MediaStore.Audio.Media.ALBUM));
     TextView albumView = (TextView)getView().findViewById(R.id.albumTitle);
     if (album.equals("<unknown>")){albumView.setText(R.string.unknown_album);}
     else { albumView.setText(album);}

             }

    else {   

     ImageView coverView = (ImageView)getView().findViewById(R.id.playerCoverView);

     if (cursor.getString(cursor.getColumnIndex(MediaStore.Audio.Albums.ALBUM_ART)).equals(null)){
            //if no cover returned, display the by default (empty) cover
            coverView.setImageResource(R.drawable.listcoverthumbnail);}

     else{
            Bitmap coverImage = BitmapFactory.decodeFile(cursor.getString(cursor.getColumnIndex(MediaStore.Audio.Albums.ALBUM_ART)));
                    coverView.setImageBitmap(coverImage);}

      getLoaderManager().initLoader(2, null, this);
  } 
```

该变量`album`是为整个类定义的，`dataalbumsTrackRequested`是一个字符串，等于所需专辑的标题。

该应用程序崩溃，我得到：

```
06-19 16:21:42.720: E/AndroidRuntime(6516): Caused by: android.database.sqlite.SQLiteException: no such column: album_art: , while compiling: SELECT album_id, album_art, album FROM audio WHERE (album=?) 
```

如果我删除了第二个加载器（Id=2），那么封面当然不会显示，但应用程序不会崩溃。所以问题来自第二个Loader。

我究竟做错了什么 ？我确信这个专栏`album_art`存在，因为我已经在我的另一个应用程序中获得了这样的封面。但是在这里，我找不到错误的来源。是因为我使用了多个 Loaders 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T17:33:44.497

好的，问题解决了。

**1）**在第二个加载器中，我使用的是`MediaStore.Audio.Media.ALBUM`而不是`MediaStore.Audio.albums.ALBUM`

**2）**我的预测是`PLAYER_COVER_SUMMARY_PROJECTION = { MediaStore.Audio.Albums.ALBUM_ID, MediaStore.Audio.Albums.ALBUM_ART, MediaStore.Audio.Albums.ALBUM}`

代替`PLAYER_COVER_SUMMARY_PROJECTION = { MediaStore.Audio.Albums._ID, MediaStore.Audio.Albums.ALBUM_ART, MediaStore.Audio.Albums.ALBUM};`

然后，如果您收到错误`06-19 19:29:18.115: E/AndroidRuntime(22943): android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 1`，我用`cursor.move(cursor.getPosition()+2)`in `OnLoadFinished`of the解决了它`Loader`。这是一个可怕的黑客，但它的工作原理。

显然我不是唯一一个遇到这个问题的人（例如，参见这篇[文章](http://code.google.com/p/android/issues/detail?id=1630)），但我已经以另一种方式解决了它。

# drag-and-drop - 带有拖放选项的挂毯调色板

> ID：11103225
> 
> 赞同：1
> 
> 时间：2012-06-19T14:32:38.897
> 
> 标签：drag-and-drop, tapestry, palette

我想知道，是否有任何简单的方法可以在 Tapestry 5 中制作拖放调色板或通过拖放制作两个连接列表？我知道如何在 jQuery 中执行此操作，但是当我在 JQuery 中执行此操作时，我不知道如何将选定的数据从 javascript 提取到 java。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:24:12.663

我无法使调色板与对象一起使用，在我的研究中我遇到了这个[网站](http://tapestry5-jquery.com/core/docsjquerypalette)。唯一对我来说似乎遥不可及的挂毯调色板。

# iphone - 暂停 UIImageview 动画

> ID：11103227
> 
> 赞同：4
> 
> 时间：2012-06-19T14:32:53.550
> 
> 标签：iphone, uiimageview

我想暂停`UIImageView animation`，根据我的研究发现，您可以停止图像的动画，但不能暂停序列。`stop animating`通过在then 上调用语句，`UIImageView`它会停止动画并使图像视图空白。

要暂停 UIImages 的动画，必须使用`NSTimer`.

我已经在应用程序中使用一个在不同的时间间隔一个接一个`NSTimer`地加载。`view controllers`我`UIImages`在每个`view controller`.

问题是当 Timer 暂停时`view controllers`会暂停进一步加载，但`view controller`当时显示的仍会重复显示幻灯片`UIImages`，`view controller`直到暂停恢复。所以我也想暂停那个幻灯片。

这是我使用`NSTimer`

```
-(void)playpauseAction:(id)sender {
if([audioPlayer isPlaying])
{
    [sender setImage:[UIImage imageNamed:@"Play Icon.png"] forState:UIControlStateSelected];
    [audioPlayer pause];
    [self pauseTimer];
}else{
    [sender setImage:[UIImage imageNamed:@"pause.png"] forState:UIControlStateNormal];
    [audioPlayer play];
    [self resumeTimer];
if(isFirstTime == YES)
    {
     self.timer = [NSTimer scheduledTimerWithTimeInterval:11.0
                                         target:self
                                         selector:@selector(displayviewsAction:)
                                         userInfo:nil
                                        repeats:NO];
        isFirstTime  = NO;
    }         
    } 
    } 
```

这就是 displayviewsAction 以不同的时间间隔依次加载 11 个视图控制器的方式

```
- (void)displayviewsAction:(id)sender
 {  
 First *firstController = [[First alloc] init];
 firstController.view.frame = CGRectMake(0, 0, 320, 480);
 CATransition *transitionAnimation = [CATransition animation];
 [transitionAnimation setDuration:1];
 [transitionAnimation setType:kCATransitionFade];
 [transitionAnimation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];
 [self.view.layer addAnimation:transitionAnimation forKey:kCATransitionFade];
 [self.view addSubview:firstController.view];
 [self.view addSubview:toolbar];
 [firstController release];   
 self.timer = [NSTimer scheduledTimerWithTimeInterval:23 target:self selector:@selector(Second) userInfo:nil repeats:NO];     

 }

 -(void)Second 
{
Second *secondController = [[Second alloc] init];
secondController.view.frame = CGRectMake(0, 0, 320, 480);
CATransition *transitionAnimation = [CATransition animation];
[transitionAnimation setDuration:1];
[transitionAnimation setType:kCATransitionReveal];
[transitionAnimation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];
[self.view.layer addAnimation:transitionAnimation forKey:kCATransitionReveal];
[self.view addSubview:secondController.view]; 
[self.view addSubview:toolbar];
[secondController release];
self.timer = [NSTimer scheduledTimerWithTimeInterval:27 target:self selector:@selector(Third) userInfo:nil repeats:NO];
} 
```

这就是在视图控制器中启动图像动画的方式

```
// Displays UIImageView
UIImageView* ImageView = [[UIImageView alloc] initWithFrame:CGRectMake(10, 5, 300, 235)];
self.view.backgroundColor = [UIColor brownColor];
// load all the frames of our animation
ImageView.animationImages = [NSArray arrayWithObjects:    
                                [UIImage imageNamed:@"1a.png"],
                                [UIImage imageNamed:@"1b.png"],
                                nil];

 // all frames will execute in 25 seconds
 ImageView.animationDuration = 25;
// start animating
[ImageView startAnimating];
ImageView.layer.borderWidth = 2;
ImageView.layer.borderColor = [[UIColor whiteColor]CGColor];
[ImageView.layer setMasksToBounds:YES];
[ImageView.layer setCornerRadius:15.0f];
[baseView addSubview:ImageView]; 
```

现在，如果有人可以指导我如何暂停这个暂停`UIImage animation`时的幻灯片`NSTimer`。

感谢帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-19T15:48:57.913

你可以使用苹果提供的代码来暂停和恢复你的动画。

```
-(void)pauseLayer:(CALayer*)layer
{
CFTimeInterval pausedTime = [layer convertTime:CACurrentMediaTime() fromLayer:nil];
layer.speed = 0.0;
layer.timeOffset = pausedTime;
}

-(void)resumeLayer:(CALayer*)layer
{
CFTimeInterval pausedTime = [layer timeOffset];
layer.speed = 1.0;
layer.timeOffset = 0.0;
layer.beginTime = 0.0;
CFTimeInterval timeSincePause = [layer convertTime:CACurrentMediaTime() fromLayer:nil] - pausedTime;
layer.beginTime = timeSincePause;
} 
```

而要让 CALayer 传递给 pauseLayer 函数，可以使用以下代码。

```
CALayer *player = ImageView.layer;
[self pauseLayer:player]; 
```

希望它可以帮助你。

# c# - RadDatePicker 和 RadTimePicker 在回发后失去样式

> ID：11103229
> 
> 赞同：2
> 
> 时间：2012-06-19T14:33:04.780
> 
> 标签：c#, asp.net, telerik, raddatepicker

我在我的网站上发现了一个错误，但我似乎找不到解决方案。我正在动态生成控件，其中两个是 RadDatePicker 和 RadTimePicker。当页面上发生不同的事件时，我会在生成控件后在真假之间更改控件的可见性（主要基于页面是处于“编辑”模式还是查看模式）。但是，在控件可见的第一个实例之后，控件将失去其样式。请参阅下面的屏幕截图：

![RadDatePicker 和 RadTimePicker 样式丢失示例](../Images/33fcc49347ef5ff94f30c7fc4fd91afe.png)

如果有人有任何建议或建议，那就太好了。谢谢

**更新：这是所要求的代码**

这隐藏和显示控件（只需更改真/假）

```
for (int i = 0; i < customProperties.Rows.Count; i++)
{
    customProperties.FindControl("CustomControl" + (i + 1).ToString()).Visible = false;
    customProperties.FindControl("lblCustomControl" + (i + 1).ToString()).Visible = true;
    Type aType = customProperties.FindControl("CustomControl" + (i + 1).ToString()).GetType();
    if (aType.Name == "RadBinaryImage")
    customProperties.FindControl("CustomControl" + (i + 1).ToString() + "_btn").Visible = false;
} 
```

所以基本上它在 htmltable (customProperties) 中搜索控件并更改可见性

这是生成控件的地方：

```
case DynamicFieldTypeEnum.Date:
    RadDatePicker dp = new RadDatePicker();
    dp = currentValues as RadDatePicker;
    if (dp.SelectedDate == null)
        customProperty.Text = "Not Specified";
    else
        customProperty.Text = dp.SelectedDate.Value.ToString(dp.DateInput.DateFormat);
    dp.ID = "CustomControl" + (position + 1).ToString();

    newControls[0] = customProperty;
    newControls[1] = dp;
    break;
case DynamicFieldTypeEnum.Time:
    RadTimePicker tp = new RadTimePicker();
    tp = currentValues as RadTimePicker;
    if (tp.SelectedDate == null)
        customProperty.Text = "Not Specified";
    else
        customProperty.Text = tp.SelectedDate.Value.ToString(tp.DateInput.DateFormat);
    tp.ID = "CustomControl" + (position + 1).ToString();

    newControls[0] = customProperty;
    newControls[1] = tp;
    break; 
```

这是在给定对象定义然后返回控件数组的方法中。控件数组中的第一个值是“查看”模式的标签，第二个控件是“编辑”模式的控件。

然后将该数组传递给不同的方法，该方法将控件放置在表格单元格中，该单元格放置在表格行中，然后放置在表格“customProperties”中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-11T16:44:36.630

我已经遇到过这种问题。

作为 Telerik Support 的建议，我在发现您的问题的页面中添加了此代码。

```
 <telerik:RadStyleSheetManager ID="RadCssManager" runat="server">
        <StyleSheets>
            <telerik:StyleSheetReference Assembly="Telerik.Web.UI" Name="Telerik.Web.UI.Skins.RadDatePicker.css" />
            <telerik:StyleSheetReference Assembly="Telerik.Web.UI" Name="Telerik.Web.UI.Skins.MetroTouch.RadDatePicker.MetroTouch.css" />
        </StyleSheets>
    </telerik:RadStyleSheetManager> 
```

Ps：就我而言，我使用的是“MetroTouch”皮肤。

# php - smarty中的动态数组键

> ID：11103235
> 
> 赞同：2
> 
> 时间：2012-06-19T14:33:29.620
> 
> 标签：php, smarty, smarty3

我只想知道如何访问 SMARTY 中通过 smarty 生成索引的数组。我想稍后访问它。

得到这样的东西：

```
{if $smarty.get.{param_{$k.id}_{$p.num}} eq $key} 
```

我喜欢访问`$smarty.get.(dynamic generated index)`

尝试了几种变体，但没有任何运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T18:51:15.483

您可以将变量用于索引，但不能按照您尝试的方式构建字符串。尝试在之前构建自定义变量：

```
{$myIndex = "param_{$k.id}_{$p.num}"}
{if $smarty.get.$myIndex eq $key}
    ... 
```

这应该有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-07T16:43:05.133

在我的例子中，我使用了 UnLoCo 解决方案，并尝试使用动态键直接访问数组内容（**没有 if 语句**），并且效果很好：

```
{$arr1["column_{$arr2.month}_price"]} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-15T13:21:35.957

这也可以

```
{if $smarty.get["param_{$k.id}_{$p.num}"] eq $key}
  ... 
```

# ios - 在没有 contentView 框架的情况下计算 UITableViewCell 高度的最佳方法

> ID：11103238
> 
> 赞同：9
> 
> 时间：2012-06-19T14:33:44.370
> 
> 标签：ios, objective-c, iphone, uitableview, heightforrowatindexpath

**概括**

*鉴于我们并不总是知道单元格的框架或其内容视图将是什么（由于编辑、旋转、辅助视图等），`tableView:heightForRowAtIndexPath:`当单元格包含可变高度文本字段或标签？*

我的其中一个`UITableViewController's`包含以下演示文稿：带有 UITextView 的 UITableViewCell。

UITextView 应该和 UITableViewCell 一样宽高。

![在此处输入图像描述](../Images/819f3026be0b42c5f525d8f843648635.png)

我创建了 UITableViewCell 子类，然后用 UITextView 初始化它（UITextView 是我的 UITableViewController 的私有字段）

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{ 
     static NSString *CellIdentifier = @"TextViewCell";
     UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
     if (cell == nil) {
         cell = [[[BTExpandableTextViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier textView:_notesTextView] autorelease];
     }    
     return cell;
} 
```

我在 UITableViewCell 子类中实现了以下方法：

```
- (void)layoutSubviews{
    [super layoutSubviews];
    CGFloat height = [textView.text sizeWithFont:textView.font constrainedToSize:CGSizeMake(textView.frame.size.width, MAXFLOAT)].height + textView.font.lineHeight;
    textView.frame = CGRectMake(0, 0, self.contentView.frame.size.width, (height < textView.font.lineHeight * 4) ? textView.font.lineHeight * 4 : height);    
    [self.contentView addSubview:textView];
} 
```

当然我实现了以下 UITableViewDataSource 方法（看！我正在使用 self.view.frame.size.width （但我真的需要 UITableViewCell contentView 框架宽度）：

```
- (CGFloat)tableView:(UITableView*)tableView heightForRowAtIndexPath:(NSIndexPath*)indexPath{

    CGFloat height  = [_notesTextView.text sizeWithFont:_notesTextView.font 
                                      constrainedToSize:CGSizeMake(self.view.frame.size.width, MAXFLOAT)].height;        
    CGFloat groupedCellCap = 20.0;     
    height          += groupedCellCap; 

    if(height < [BTExpandableTextViewCell minimumTextViewHeightWithFont:_notesTextView.font]){
        height = [BTExpandableTextViewCell minimumTextViewHeightWithFont:_notesTextView.font];
    }        
    return height;
} 
```

我也实现了以下方法（这不是那么重要，但无论如何我都会发布它，只是为了解释单元格的高度是动态的，它会在 UITextView 中更改文本后缩小或扩大）

```
 - (void)textViewDidChange:(UITextView *)textView{
    CGFloat height = [_notesTextView.text sizeWithFont:_notesTextView.font 
                                 constrainedToSize:CGSizeMake(_notesTextView.frame.size.width, MAXFLOAT)].height;
    if(height > _notesTextView.frame.size.height){
        [self.tableView beginUpdates];
        [self.tableView endUpdates];
    }
} 
```

**现在，我的问题是：** 加载视图后， UITableViewController 按以下顺序调用方法：（为了简化，我删除了一些，如 titleForHeaderInSection 等）

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
- (CGFloat)tableView:(UITableView*)tableView heightForRowAtIndexPath:(NSIndexPath*)indexPath{ 
```

只有这样

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

看！我应该在 cellForRowAtIndexPath 之前返回正确的 UITableViewCell 高度！这意味着：我不知道 UITableViewCell contentView 框架。而且我无法以编程方式获得它。

此宽度可以是以下之一：

1.  iPhone 普通桌子，纵向
2.  iPhone 普通桌子，横向
3.  iPhone 分组表，纵向
4.  iPhone 分组表，横向
5.  和 iPad 相同（另外 4 个值）

并且不要忘记，因为 UITableViewCell 附件类型，或者因为 UITableView 编辑状态，contentView 框架可以更小。（例如，如果我们有 UITableViewCell 与任何高度的多行 UILabel 在任何编辑状态和任何附件视图）

所以这个问题是根本的：我只是无法获得单元格 contentView 框架宽度进行约束，因为我应该在单元格布局 contentView 之前返回这个高度。（顺便说一句，这很合乎逻辑）但是这个 contentView 框架真的很重要。

当然有时我可以准确地知道这个宽度并“硬编码”它（例如：UITableViewCellAccessoryDisclosureIndicator 有 20 px 宽度，而 tableView 不能处于编辑状态，那么我可以写 self.view.frame.size.width - 20 和任务已经完成了）！或者有时 contentView 等于 UITableViewController 的视图框架！

有时我在 -tableView:heightForRowAtIndexPath: 方法中使用 self.view.frame.width 。（就像现在一样，它工作得很好，但由于分组的 UITableView 并不完美，应该减去一些常量值，它们是不同的2 个设备 * 2 个方向）

有时我在 UITableViewCell 中有一些#defined 常量（如果我确切地知道宽度）......

有时我正在使用一些虚拟的预分配 UITableViewCell （这很愚蠢，但有时非常优雅且易于使用）......

但我不喜欢那种东西。

**最好的决定是什么？** 也许我应该创建一些辅助类，它将使用以下参数进行初始化：附件视图、设备方向、设备类型、表视图编辑状态、表视图样式（普通、分组）、控制器视图框架和其他一些，这将包括一些常量（如分组的 tableView 偏移量等）并使用它来查找预期的 UITableViewCell contentView 宽度？;)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T09:45:27.630

表格视图使用该`tableView:heightForRowAtIndexPath:`方法在创建任何单元格之前确定其 contentSize `UITableViewCell`。如果你停下来想一想，这是有道理的，因为你对 a 做的第一件事`UIScrollView`就是设置它的 contentSize。我之前遇到过类似的问题，我发现最好有一个辅助函数，可以将内容放入 UITableViewCell 并预测它的高度`UITableViewCell`。因此，我认为您将希望创建某种数据结构，将文本存储在 each`UITableViewCell`中，以 NSIndexPaths 作为键并将文本作为值的 NSDictionary 会做得很好。这样，您可以找到所需文本的高度，而无需参考`UITableViewCell`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T07:43:02.373

尽管您可以在 UITableViewCell 子类的“layoutSubviews”中真正动态地计算表格视图单元格中包含的标签的高度，但对于“-tableView:heightForRowAtIndexPath:”中的单元格高度没有类似的方法（据我所知）的表视图委托。

考虑一下：

```
- (void)layoutSubviews
{
    [super layoutSubviews];

    CGSize size = [self.textLabel.text sizeWithFont:self.textLabel.font
                                  constrainedToSize:CGSizeMake(self.textLabel.$width, CGFLOAT_MAX)
                                      lineBreakMode:self.textLabel.lineBreakMode];
    self.textLabel.$height = size.height;
} 
```

不幸的是，当 '-tableView:heightForRowAtIndexPath:' 被调用时，这还为时过早，因为`cell.textLabel.frame`它尚未设置为`CGRectZero = {{0, 0}, {0, 0}}`.

AFAIK 你既不能用内容视图的框架来做到这一点，也不能总结单个标签的框架......

我能想到的唯一方法是想出一个便利类、方法、常量等，试图在任何设备上覆盖任何设备方向上的所有可能宽度：

```
@interface UITableView (Additions)

@property (nonatomic, readonly) CGFloat padding;

@end

@implementation UITableView (Additions)

- (CGFloat)padding
{
    if (self.formStyle == PTFormViewStylePlain) {
        return 0;
    }

    if (self.$width < 20.0) {
        return self.$width - 10.0;
    }

    if (self.$width < 400.0 || [[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return 10.0;
    }

    return MAX(31.0, MIN(45.0, self.$width * 0.06));
}

@end 
```

另请注意，最近我们也有新的 iPhone 5 的 4 英寸宽度（568 而不是 480）横向。

这整件事很令人不安，我知道……干杯。

# jquery - jqgrid：JQGrid 脚本未在 IE 中加载

> ID：11103239
> 
> 赞同：1
> 
> 时间：2012-06-19T14:33:44.293
> 
> 标签：jquery, jqgrid, struts2

我正在研究 struts2-jquery 插件。下面的代码片段在 Firefox、Chrome 中运行良好。但是 JQGrid 相关库没有在 IE 中加载，因为它不允许进行正常的 Ajax 调用。在我的页面中，我从用户那里获取值，并根据我在网格中显示的搜索条件。同样在页面加载时，我在网格中显示完整数据。谁能帮我这个

```
$(document).ready(function() {
        alert("test");
        $("#refresh").bind('click', myhandler);
        $("#channel").bind('change', myhandler1);
        });
    function myhandler() {
        alert("test handler");
        dataString = $("#branchmonitoring").serialize();
        alert(dataString);
        //refer below
    }
    function myhandler1() {
        var formInput = $(this).serialize();
        //java.awt.Toolkit.getDefaultToolkit().beep();
        $.get('struts/onSelectshowBranchDetails', formInput, function(data) {
            $("#branch").get(0).options.length = 0;
            $("#branch").get(0).options[0] = new Option(data.branchList);
        });
    }
//code to refer 
$("#gridtable").jqGrid('setGridParam', {
            url : 'showBatchAction.action?',
            datatype : 'JSON',
            postData : dataString,
        }).trigger("reloadGrid");
        return false; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T16:11:33.723

我找到了原因，我添加了一个尾随逗号

```
$("#gridtable").jqGrid('setGridParam', {
            url : 'showBatchAction.action?',
            datatype : 'JSON',
            postData : dataString,
        }).trigger("reloadGrid"); 
```

在 dataString 旁边，IE 无法遍历这些逗号，无论如何感谢 Justin Ethier 的回复

# php - 如何使用 wp_remote_post 在其他服务器上接收数据

> ID：11103240
> 
> 赞同：1
> 
> 时间：2012-06-19T14:33:47.747
> 
> 标签：php, html, wordpress

所以基本上，我正在使用 wp_remote_post 发布数据，并且我想在其他服务器上接收发送的数据（用户名和密码）。我该怎么做？我试过`<?php echo $_POST['username']; ?>`了（之前没有别的，之后没有别的），但它没有用。在 Wordpress Codex 中也找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:40:50.270

Wordpress 可以保护您免受攻击，因此很难利用您的代码。

使用此代码使其工作：

在functions.php中添加：

```
add_filter('query_vars', 'add_my_var');
function add_my_var($public_query_vars) {
    $public_query_vars[] = 'username';
    return $public_query_vars;
} 
```

然后你可以在你的代码中使用来读取变量：

```
get_query_var('username'); 
```

这个线程有帮助：[http ://wordpress.org/support/topic/using-an-extra-parameter-in-an-url](http://wordpress.org/support/topic/using-an-extra-parameter-in-an-url)

# ruby-on-rails - 从租赁应用程序获取可用日期列表

> ID：11103243
> 
> 赞同：0
> 
> 时间：2012-06-19T14:34:11.640
> 
> 标签：ruby-on-rails, database, activerecord

我正在为电子商务网站创建一个 ROR 应用程序，该应用程序在一段时间内处理租赁物品的管理。这些物品将被实际交付和提取。项目总是租用 30 天。

所以我面临的问题是，我需要以某种方式获得可以租用物品的日期，并且从那时起至少可以使用 30 天。（例如，如果某件商品被预订为从现在起 10 天后租用，则客户今天无法租用该商品）

在我的数据库中，我有一个租金表，其中存储了取货和交货日期。

我将使用 jQuery 日期选择器，并且只需要一次加载 1 个月的可用日期（我可以在每次按下下个月按钮时重做查询以隐藏不可用的日期）

执行此类查询并获取一个月中某项可用 30 天的所有天数的最佳方法是什么？我总是可以遍历该月的每一天并检查 30 天内是否有任何其他记录，但这似乎是查询的过剩。

任何帮助将不胜感激。

谢谢，泰勒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:53:09.877

您怎么知道某件物品是在哪一天被预约取走的？在此基础上进行查询。也许您的 Rental 模型有一个`reserved_on`属性？

```
class Rental < ActiveRecord::Base

  scope :available, where('rented = ? AND reserved_on > ?', false, 30.days.from_now)

end 
```

* * *

编辑以回应评论

如果正在查看单个对象，您可以在其上创建如下方法：

```
def last_available_day
  delivery_date && delivery_date - rental_period  # 30 days
end

def is_available_on?(date)
  return true unless last_available_day
  date <= last_available_day
end 
```

# jquery - 在 jQuery 中使用 .when 和 .done 设置函数序列

> ID：11103245
> 
> 赞同：0
> 
> 时间：2012-06-19T14:34:14.517
> 
> 标签：jquery, function, callback

仅在设置变量后才尝试显示数据。

```
$("document").ready(function () {
    function setdata() {
        var mydata = '123';
    };

    $.when(setdata()).done(function () {
        $(".content").text(mydata);
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:54:10.310

在这种情况下你不需要`$.when`，因为你实际上并没有传递一个 Promise 对象。

```
$("document").ready(function () {
    var mydata;
    function setdata() {
        mydata = '123';
    };

    setdata();
    $(".content").text(mydata);
}); 
```

`setdata`做的比你在问题中显示的更多吗？我猜它做了一个ajax请求，在这种情况下它应该是这样的：

```
$("document").ready(function () {
    function setdata() {
        return $.ajax(ajaxOptions);
    };

    setdata().done(function(mydata){
        $(".content").text(mydata);
    });
}); 
```

# c++ - .raw 文件格式 C++

> ID：11103249
> 
> 赞同：0
> 
> 时间：2012-06-19T14:34:34.807
> 
> 标签：c++, file, file-io, paraview

我想知道是否可以使用 C++ 生成 .raw 文件格式。如果是，那么哪个类处理它？如果可能，请记下示例代码。

我有格式的数据，`(X Y Z) <Number>`它表示 和 之间的粒子`(X Y Z)`数`(X+1 Y+1 Z+1)`。我需要使用[ParaView](http://paraview.org)以图形方式表示这些数据，因此需要二进制格式的数据。所以想知道是否可以直接生成.raw文件格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:48:14.353

通常，要将二进制数据写入 C++ 中的文件，您需要使用`ofstream`：

```
#include <fstream.h>
...

{
   MyData myData = GetData();
   ofstream binaryFile ("file.raw", ios::out | ios::binary);
   binaryFile.write ((char*)&myData, sizeof (MyData));
   binaryFile.close();
} 
```

由您决定`Data`此应用程序使用的实际格式（如上例中的结构），然后将其写入文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:41:37.087

原始图像文件有很多定义，很大程度上取决于上下文。最古老和最简单的定义是没有标题的文件，并且像素值以二进制形式打包，没有任何压缩。这实现起来很简单，只需将每个像素写成`unsigned char`红色、绿色和蓝色的 3 个值，从左到右和从上到下。

# c# - 用 c# 编写一个敌人类：从哪里开始？

> ID：11103253
> 
> 赞同：-5
> 
> 时间：2012-06-19T14:34:45.727
> 
> 标签：c#, class

我是新来的，有问题。我必须接`C#`，但我没有这方面的经验。我最终会（可能）主要做工具类的东西，但我有一段时间没有编程了，我也不知道很多。

我必须写一个描述敌方飞船的类，但我不太确定怎么写！我似乎忘记了我在写作课上学到`Java`的一切。`VB`我在哪里可以找到很好的资源来重新学习编写课程、学习编写课程`C#`以及学习编写视频游戏课程？

具体来说，我必须展示它如何与其他敌人、武器相互作用、它有多大、它的外观等。

我不是要代码，只是要学习资源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T14:38:19.400

也许您应该在 gamedev stackexchange 平台上询问以获得更相关的回复：[Gamedev Stackexchange](https://gamedev.stackexchange.com/)

此外，MSDN 是一个很好的解决方案：[Learn Visual C# on MSDN](http://msdn.microsoft.com/en-us/vstudio/hh341490.aspx)。他们描述了很多基础知识，概念、类、结构、接口，还有很多教程和资源（例如[创建迷宫](http://msdn.microsoft.com/en-en/library/dd492162)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:37:32.683

不是直接的答案，而是：

[http://www.3dbuzz.com](http://www.3dbuzz.com)

他们有关于 c# 和 C 的令人难以置信的教程，并且在大多数情况下 - 编程逻辑就是编程逻辑，一旦你有一种思维方式，它就更容易与语言无关。他们也有 XNA 的东西来帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T14:41:41.330

您应该遵守 MSDN[文档](http://msdn.microsoft.com/en-us/library/gg145045%28v=VS.100%29.aspx)。对于您需要了解的所有信息，这是一个很好的信息来源`C#`。

一旦你掌握了，`C#`你应该看看 XNA 平台。它是微软为`C#`.

您可以为 Windows、Xbox360 和 Windows Phone 制作游戏。

[http://www.microsoft.com/en-us/download/details.aspx?id=23714](http://www.microsoft.com/en-us/download/details.aspx?id=23714)

[这](http://www.xnadevelopment.com/tutorials.shtml)是我所知道的学习如何使用 XNA 的最佳教程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T15:42:02.703

好吧，如果您是从头开始，我建议您下载 Microsoft 的 Visual Web Developer。这是一个免费的 IDE，在编程时对您很有帮助。

[http://www.microsoft.com/visualstudio/en-us/products/2010-editions/visual-web-developer-express](http://www.microsoft.com/visualstudio/en-us/products/2010-editions/visual-web-developer-express)

Once you have that installed, you can follow csharp.net's introductory tutorials: [http://csharp.net-tutorials.com/basics/introduction/](http://csharp.net-tutorials.com/basics/introduction/)

# android - 对 Android 应用程序使用 Facebook 身份验证

> ID：11103256
> 
> 赞同：0
> 
> 时间：2012-06-19T14:34:49.523
> 
> 标签：android, facebook, authentication

我正在开发一个需要集成 Facebook 社交功能的应用程序。

我想知道用户是否已经通过 Facebook 应用程序或其他使用 Facebook 的应用程序连接到 Facebook，并使用此身份验证。这意味着如果用户已经通过他的设备连接到 Facebook，我会识别并在我的应用程序中使用它——不要要求用户重新登录。

是否可以？

我在网上找到了很多东西，但没有与此相关。我已经下载了 facebook SDK 并将其添加到我的项目中。我看到有一个方法 ( `facebook.getAccessToken()`) 可以获取访问令牌，但我认为只有当用户第一次登录我的应用程序时才能使用它。

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:49:24.263

```
That means that if the user is already connect to Facebook through his device I recognize that and use it in my application - not ask the user for a new login. 
```

**是的，有可能**..这在 facebook中称为**Single-Sign-On ，默认情况下 Single-Sign-On 已****启用**。您需要做的一件事也是唯一一件事是您需要生成哈希键并在 Facebook 中创建的应用程序中注册。

也可以通过传递一个额外的参数来禁用 Single-Single-On，如下所示：

```
authenticatedFacebook.authorize(context PERMISSIONS,-1,new LoginListener()); 
```

-1 - 表示禁用 SSO

[Facebook 文档](http://developers.facebook.com/docs/mobile/android/build/#sso)中清楚地解释了单点登录。

# telerik - Telerik PanelBar：可以使项目重定向到新页面吗？

> ID：11103259
> 
> 赞同：0
> 
> 时间：2012-06-19T14:34:56.857
> 
> 标签：telerik, panelbar

在我的应用程序中，我希望程序将用户重定向到新页面并在单击/选择 panelBar 项目时滑动打开 SUBITEMS 列表。但是，我不确定应该如何实施。

我已经将“.Action”与面板栏的“项目”一起使用，但不幸的是这引发了错误。为方便起见，下面显示一小部分代码（主要关注倒数第二行）。抛出的错误是：

> HttpException 未被用户代码处理

```
 <% Html.Telerik().PanelBar()
            .Name("PanelBar")
            .SelectedIndex(0)
            .Items(item =>
            {
                item.Add()
                    .Text("Home").Action("Index", "Home")
                    .Items(subItem =>
                     {
                         subItem.Add().Text("My Profile").Action("MyProfile", "Profile");
                         subItem.Add().Text("Test");
                     });

                item.Add()
                    .Text("Orientation").Action("Index", "Orientation")
                    .Items(subItem =>
                    {
                        subItem.Add().Text("GridView");
                        subItem.Add().Text("Scheduler");
                        subItem.Add().Text("Docking");
                        subItem.Add().Text("Chart");
                    });                

            }).Render();
    %> 
```

在这种情况下，“.Action”似乎不起作用。所以我的问题是，我应该如何让该项目参加活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T21:48:22.073

这是我如何使用 javascript 执行此操作的片段，它工作得很好。我不否认还有其他方法可以做到这一点。所以你知道，这个片段来自我正在做的一个 MVC 应用程序。我还包含了样式代码，以便您知道您可以这样做。我意识到您并没有要求该功能，只是认为它可能有助于您更好地理解该属性。

假设我想要粗体字体，没有边框，我们想要捕获鼠标事件来执行重定向。

要处理样式，我只需添加我的项目，然后使用 HtmlAttributes 属性设置我的样式。

*这是样式的代码...*

```
**item.Add()     
    .Text("Surf Shop")     
    .HtmlAttributes(new { style = "font-weight: bold; border:none;" })** 
```

由于我的网站是一个冲浪网站，我想同时打开冲浪店主页并放下子菜单。为此，我使用相同的 HtmlAttributes 属性属性并挂钩到 onmousedown 事件事件处理程序。然后我调用我的处理程序，传入我希望加载的控制器名称。我只需要控制器，因为所有页面都称为索引。但是，您可以在此处传入一个完整的字符串并简单地重定向到它。无论什么让你的头发吹回来...... :-)

*这是带有挂钩到事件处理程序的代码...*

```
**item.Add()
    .Text("Surf Shop")
    .HtmlAttributes(new { onmousedown="onBaseNavItemClick('SurfShop');" })** 
```

*最后，这是包含样式和挂钩到事件处理程序的完整代码*

```
**item.Add()
    .Text("Surf Shop")
    .HtmlAttributes(new { style = "font-weight: bold; border:none;",onmousedown="onBaseNavItemClick('SurfShop');" })** 
```

*我们的事件处理函数*

```
**function onBaseNavItemClick(itemText)
{
    window.location = BASE_URL + itemText + "/index";
}** 
```

附言。被调用的 MVC 控制器必须在 ViewData 中传回一个值，以便切换 PanelBar 的 selectedIndex 属性。这样才能在执行重定向时打开正确的面板。

希望这可以帮助...

# magento - 如何从管理面板隐藏 magento 价格选项卡

> ID：11103265
> 
> 赞同：1
> 
> 时间：2012-06-19T14:35:12.923
> 
> 标签：magento

我为在管理面板中设置产品价格做了单独的规定。现在我想隐藏管理产品部分的默认价格选项卡。我该怎么做？我需要改变的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T16:22:54.743

转到后端的属性集，选择您的属性集，然后从属性集中删除价格组。

# c++ - 使用函数指针切割 if 语句会更有效吗？

> ID：11103269
> 
> 赞同：7
> 
> 时间：2012-06-19T14:35:18.730
> 
> 标签：c++, performance, function-pointers, data-oriented-design

因此，有这条规则可以尝试将`if`语句从高重复循环中拉出来：

```
for( int i = 0 ; i < 10000 ; i++ )
{
    if( someModeSettingOn )  doThis( data[i] ) ;
    else  doThat( data[i] ) ;
} 
```

他们说，最好将其分解，将 if 语句放在外面：

```
if( someModeSettingOn )
  for( int i = 0 ; i < 10000 ; i++ )
    doThis( data[i] ) ;
else
  for( int i = 0 ; i < 10000 ; i++ )
    doThat( data[i] ) ; 
```

（如果您说“哦！不要自己优化！编译器会这样做！”）当然优化器可能会为您执行此操作。但是在[典型的 C++ 废话](http://macton.smugmug.com/gallery/8936708_T6zQX/1/593426709_ZX4pZ#!i=593437390&k=pJVYX&lb=1&s=L)中（我不同意他的*所有*观点，例如他对虚函数的态度）Mike Acton 说：“为什么要让编译器猜测你*知道*的东西？对我来说，这几乎是这些粘性的最佳点。

那么为什么不使用函数指针呢？

```
FunctionPointer *fp ;
if( someModeSettingOn )  fp = func1 ;
else fp = func2 ;

for( int i = 0 ; i < 10000 ; i++ )
{
    fp( data[i] ) ;
} 
```

函数指针是否存在某种隐藏开销？调用直接函数是否有效？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T14:55:09.473

在这个例子中，不可能说哪种情况会更快。您需要在目标平台/编译器上分析此代码以估计它。

通常，在 99% 的情况下，此类代码不需要优化。这是邪恶的过早优化的例子。编写人类可读的代码并仅在分析后需要时对其进行优化。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-19T15:07:13.177

不要猜测，**测量**。

但是，如果我*必须*猜测的话，我会说第三个变体（函数指针）会比第二个变体（`if`外部循环）慢，我怀疑这可能会更好地使用 CPU 的分支预测。

正如您已经指出的，第一个变体可能与第二个变体等效，也可能不等效，具体取决于编译器的智能程度。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-19T15:31:55.220

> 为什么要让编译器猜测你知道的东西？

因为您可能会使未来的维护者的代码复杂化，而不会为您的代码用户提供任何切实的好处。这种变化有强烈的过早优化的味道，只有在分析之后，我才会考虑除了明显的（`if`内部循环）实现之外的任何东西。

鉴于分析表明这是一个问题，那么作为一种猜测，我认为`if`退出循环会比函数指针更快，因为指针可能会添加编译器无法优化的间接级别。它还将降低编译器可以内联任何调用的可能性。

但是，我*也会*考虑使用抽象接口而不是`if`循环内的替代设计。然后每个数据对象已经自动知道要做什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-06T12:47:04.493

我的赌注是第二个版本`if/else`在循环外是最快的，前提是当我们在最广泛的编译器中捆绑和测试它时我会得到退款。:-DI 在 VTune 的支持下用了很多年的时间做这个赌注。

也就是说，如果我输了赌注，我实际上会很高兴。我认为现在许多编译器可以优化第一个版本以与第二个版本竞争是非常可行的，检测到您正在重复检查一个在循环内不会改变的变量，因此有效地将分支提升到循环外。

但是，我还没有遇到过这样的情况，即我已经看到优化器执行与内联间接函数调用类似的等价物......尽管如果有优化器可以做到这一点的情况，那么你的肯定是最简单的，因为它将地址分配给函数以调用与它通过函数指针调用这些函数的函数相同的函数。如果优化器现在可以做到这一点，我会感到非常惊喜，特别是因为从可维护性的角度来看，我最喜欢您的第三个版本（如果我们想添加导致不同函数调用的新条件，最容易更改的版本，例如）。

尽管如此，如果它不能内联，那么函数指针解决方案将倾向于成为最昂贵的，不仅因为长跳转和潜在的额外堆栈溢出等，还因为优化器将缺乏信息——当它不知道将通过指针调用什么函数时，就会出现优化器障碍。到那时，它就不能再在 IR 中合并所有这些信息，并在指令选择、寄存器分配等方面做得最好。间接函数调用的编译器设计方面没有经常讨论，但可能是最昂贵的部分间接调用函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-19T15:09:12.207

你有三种情况：

如果在循环内，则函数指针在循环内取消引用，如果在循环外。

在这三个中，没有编译器优化，第三个将是最好的。第一个执行条件，第二个在您要运行的代码之上执行指针取消引用，而第三个只是运行您想要的。

如果您想优化自己，请不要使用函数指针版本！如果您不相信编译器会进行优化，那么额外的间接性最终可能会让您付出代价，并且将来意外中断会容易得多（在我看来）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-19T16:43:07.247

您必须测量哪个更快 - 但我非常怀疑函数指针的答案会更快。在具有深度多管道的现代处理器上检查标志概率具有零延迟。而函数指针可能会使编译器被迫执行实际的函数调用、推送寄存器等。

“为什么要让编译器猜测你知道的东西？”

你和编译器在编译时都知道一些事情——但处理器在运行时知道更多的事情——比如内部循环中是否有空管道。在嵌入式系统和图形着色器之外进行这种优化的日子已经一去不复返了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-19T14:57:48.517

不确定它是否符合“隐藏”的条件，但当然使用函数指针需要多一层间接。

编译器必须生成代码来取消引用指针，然后跳转到结果地址，而不是直接跳转到常量地址的代码，用于正常的函数调用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-06T13:45:28.667

其他人都提出了非常有效的观点，最值得注意的是你必须衡量。我想补充三点：

1.  一个重要方面是使用函数指针通常会阻止内联，这会降低代码的性能。但这绝对取决于。尝试使用 Godbolt 编译器资源管理器并查看生成的程序集：

    [https://godbolt.org/g/85ZzpK](https://godbolt.org/g/85ZzpK)

    请注意，当`doThis`和`doThat`未定义时，例如可能发生在 DSO 边界上，不会有太大差异。

2.  第二点与分支预测有关。看看[https://danluu.com/branch-prediction/](https://danluu.com/branch-prediction/)。应该清楚的是，您在此处拥有的代码实际上是分支预测器的理想情况，因此您可能不必费心。同样，像 perf 或 VTune 这样的好的分析器会告诉您是否遇到分支错误预测。

3.  最后，我至少见过一种情况，尽管有上述推理，但将条件从循环中取出会产生巨大的差异。这是在一个紧密的数学循环中，由于条件而没有自动矢量化。GCC 和 Clang 都可以输出关于什么循环被矢量化或为什么没有完成的报告。就我而言，条件确实是自动矢量化器的问题。虽然这是 GCC 4.8，但从那时起事情可能已经发生了变化。使用 Godbolt，很容易检查这是否对您来说是个问题。同样，始终在您的目标机器上进行测量并检查您是否受到影响。

# c++ - 当数据存在时，使用 select() 检查套接字返回 0

> ID：11103270
> 
> 赞同：4
> 
> 时间：2012-06-19T14:35:20.113
> 
> 标签：c++, sockets, select

我的套接字类已经工作了一段时间，但我想使用 select() 添加超时。看起来很简单，但我总是从 select() 返回 0。我什至删除了 select() 检查，因此它读取数据而不管 select() 并读取数据，但 select() 仍然报告数据不存在。关于如何让 select() 停止对我撒谎的任何线索？我还将套接字设置为非阻塞。谢谢。

代码：

```
char buf [ MAXRECV + 1 ];

s = "";

memset ( buf, 0, MAXRECV + 1 );

struct timeval tv;
int retval;

fd_set Sockets;
FD_ZERO(&Sockets);
FD_SET(m_sock,&Sockets);

// Print sock int for sainity
std::cout << "\nm_sock:" << m_sock << "\n";

tv.tv_sec = 1;
tv.tv_usec = 0;

retval = select(1, &Sockets, NULL, NULL, &tv);
std::cout << "\nretval is :[" << retval << "]\n\n";

// Check
if (FD_ISSET(m_sock,&Sockets))
  std::cout << "\nFD_ISSET(m_sock,&Sockets) is true\n\n";
else
  std::cout << "\nFD_ISSET(m_sock,&Sockets) is false\n\n";

// If error occurs
if (retval == -1)
{
  perror("select()");
  std::cout << "\nERROR IN SELECT()\n";
}
// If data present
else if (retval)
{
  std::cout << "\nDATA IS READY TO BE READ\n";
  std::cout << "recv ( m_sock, buf, MAXRECV, 0)... m_sock is " << m_sock << "\n";
  int status = recv ( m_sock, buf, MAXRECV, 0 );

  if ( status == -1 )
  {
      std::cout << "status == -1   errno == " << errno << "  in Socket::recv\n";
      return 0;
  }
  else if ( status == 0 )
  {
      return 0;
  }
  else
  {
      s = buf;
      return status;
  }
}
// If data not present
else
{
std::cout << "\nDATA WAS NOT READY, TIMEOUT\n";
return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T15:36:34.617

`select`正如您已经发现的那样，您的呼叫不正确。尽管第一个参数`nfds`在许多形式的文档中都被命名，但它实际上比任何`fd_set`传递给`select`. 在这种情况下，由于您只传递一个文件描述符，因此调用应该是：

```
retval = select(m_sock + 1, &Sockets, NULL, NULL, &tv); 
```

如果您有任意数量的套接字，您在不同的线程中处理每个套接字，您可能会发现我对[这个问题](https://stackoverflow.com/questions/11008570/how-to-set-time-out-for-receiving-message-fromt-client-of-server-with-non-blocki/)的回答是一种更好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:55:08.623

哎呀。看起来我忘了设置 select() 的 int nfds：

现在工作得很好。

# sql - 使用某些业务条件连接两个表的 SQL

> ID：11103273
> 
> 赞同：1
> 
> 时间：2012-06-19T14:35:21.080
> 
> 标签：sql

我有一个有趣的要求要实现。能否请你帮忙？
请找到下表

* ***CheckingAccountTable（假设表名 - CAT）**

```
AccountNo  TransactionId    BalanceID       Balance1
123           080              103             $30
123           081              103              $20
123           082              103              $10
123           083              62              $0
123           084              63              $0  
123           085              64              $0
123           086              65              $0
123           087              66              $0  
124           090              103             $3
124           091              103             $2
124           092              103             $1
124           093              72              $0
124           094              73              $0  
124           095              74              $0
124           096              75              $0
124           097              76              $0 
```

**SavingsAccountTable（假设表名称 - SAT）**

```
BalanceID    Balance2
103                    $0
62                    $15
63                    $12  
64                    $20
65                    $0
66                    $0
72                    $11
73                    $0  
74                    $0
75                    $0
76                    $0 
```

**结果应该看起来像**

```
AccountNo  Count(TransactionId)  Sum(Balance1+Balance2)
123            6                   107
124            4                   17 
```

好的，这里，CAT 是主表，SAT 是返回余额的子表我想找出 transactionID 的计数和 Sum(Balance1 + Balance 2)

条件。如果 Balance1 OR Balance 2 为 0，我无法计算 transactionID

我无法通过以下操作来实现它

```
SELECT  T.AccountNo,Count(T.TransactionId),
                SUM(T.Balance1 + T.Balance2) 'Stressdays'
        FROM 
                (
                    SELECT  CAT.AccountNo,CAT.Balance1,CAT.BalanceID,CAT,TransactionId  
                            ,CASE   WHEN SAT.BalanceID= 103 THEN
                                        0
                                    ELSE
                                        SAT.Balance2
                                    END AS 'Balance2'
                    FROM    CAT
                            INNER   JOIN  SAT ON CAT.BalanceID = SAT.BalanceID
                            WHERE   CAT.Balance1 <> 0
                            AND     SAT.Balance2 <> 0
                )T
        GROUP BY T.AccountNo 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:41:31.273

如果我了解您的需求，请尝试以下操作：

```
SELECT cat.AccountNo, Count(TransactionId), SUM(cat.Balance1+sat.Balance2)
FROM cat INNER JOIN sat 
    ON cat.BalanceID = sat.BalanceID
   AND (cat.Balance1 <> 0 OR sat.Balance2 <> 0)
GROUP BY cat.AccountNo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:42:08.757

尝试以下操作：

```
SELECT  CAT.AccountNo, 
        SUM(CASE WHEN CAT.Balance1 <> 0 OR ISNULL(SAT.Balance2,0) <> 0 THEN 1 ELSE 0 END) CountTransactionId,
        SUM(CASE WHEN CAT.Balance1 <> 0 OR ISNULL(SAT.Balance2,0) <> 0 THEN CAT.Balance1+SAT.Balance2 ELSE 0 END) SumBalance1Balance2
FROM CAT
LEFT JOIN SAT
ON CAT.BalanceId = SAT.BalanceId 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T14:59:41.483

```
SELECT C.AccountNo,Count(C.TransactionId) AS [Count(TransactionId)],
     SUM(C.Balance1 + S.Balance2) AS [Sum(Balance1+Balance2)]
FROM SO_CAT C
JOIN SO_SAT S ON S.BalanceID =  C.BalanceID--  AND S.BAlance2 <> 0
WHERE C.BALANCE1 <> 0 OR S.BALANCE2 <> 0
GROUP BY C.ACCOUNTNO 
```

# html - plsql中的html输出-日期不正确

> ID：11103274
> 
> 赞同：0
> 
> 时间：2012-06-19T14:35:21.580
> 
> 标签：html, sql, oracle, to-date

我正在尝试提取以下查询：

```
select
'<tr><td>'||column1||'</td>',
'<td>'||column2||'</td>',
'<td>'||column3||'</td></tr>'
from table 
```

在上面，column3 是一个日期字段。打印输出时，它忽略了时间部分。例如：

```
If columns 3 output is : 5/25/2011 3:03:17 AM
The above query returns : <tr><td>column1</td><td>column2</td><td>**25-JUN-11**</td></tr> 
```

我试过 to_date(column3,'yyyy/mm/dd HH24:MI:SS') 而且，正常查询打印时间

```
select
column1,
column2,
column3,
from table 
```

第 3 列打印时间。任何帮助表示赞赏。

**编辑：** 我正在使用 Oracle 10g。我也在 Oracle 9i 中尝试过

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T14:40:39.473

不要依赖隐式转换，使用[`TO_CHAR`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions200.htm#i1009324)显示[您喜欢](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#i34924)的日期：

```
select '<tr><td>'||column1||'</td>', 
       '<td>'||column2||'</td>', 
       '<td>'||to_char(column3, 'dd/mm/yyyy hh24:mi:ss')||'</td></tr>' 
  from table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:49:22.683

[TO_DATE](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions183.htm)正是它应该做的事情，格式掩码为它提供了它的主要输入格式，因此它可以将其转换为日期。格式掩码不用于定义输出，而是用于定义输入。您需要使用的是[TO_CHAR](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions180.htm)

```
TO_CHAR(column3,'yyyy/mm/dd HH24:MI:SS') 
```

# java - 如何使用 Java 调用新的记事本并将其保存在 windows 的目录中？

> ID：11103278
> 
> 赞同：0
> 
> 时间：2012-06-19T14:35:36.510
> 
> 标签：java

我目前正在将测试执行结果记录到一个文本文件中（一个现有的）。如何创建一个带有时间戳的文本文件并将其保存在 windows 目录中？我目前使用的代码是

```
 File outputResultFile = new File(CompleteFileNameForNotepad);
    PrintWriter outputFile = new PrintWriter(new FileWriter(outputResultFile));
    String str = "text to write in to the file";
    outputFile.println(str);
    outputFile.close(); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T14:38:56.820

```
String fileName = new SimpleDateFormat("yyyy-MM-ddTHH-mm-ss").format(new Date()) + ".txt";
File outputResultFile = new File(fileName);
... 
```

注意：您所说的记事本通常称为“文件”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T14:41:20.680

您应该考虑改用日志框架。例如，查看[Log4j](http://logging.apache.org/log4j/1.2/manual.html)。然后，您可以通过调整日志记录配置来更改日志记录格式以及记录哪些类。这意味着您不必更改代码。

下面的 log4j.properties 将使用模式“2000-09-07 14:07:41,508 [main] INFO MyApp - Entering application”将包 foo 下的所有类以 WARN 或更高级别记录到控制台。

```
log4j.rootLogger=DEBUG, A1
log4j.appender.A1=org.apache.log4j.ConsoleAppender
log4j.appender.A1.layout=org.apache.log4j.PatternLayout

# Print the date in ISO 8601 format
log4j.appender.A1.layout.ConversionPattern=%d [%t] %-5p %c - %m%n

# Print only messages of level WARN or above in the package com.foo.
log4j.logger.com.foo=WARN 
```

要登录到文件，请使用不同的 Appender，例如 org.apache.log4j.FileAppender 或 org.apache.log4j.RollingFileAppender。对于您的目的 org.apache.log4j.DailyRollingFileAppender 将是合适的。

# postgresql - 使用 pg_dump 结果作为 pg_restore 的输入

> ID：11103279
> 
> 赞同：14
> 
> 时间：2012-06-19T14:35:37.163
> 
> 标签：postgresql

我需要在同一台服务器上克隆一个数据库（仅模式）。我想使用来自 pg_dump 的输入并将其通过管道传输到 pg_restore。我知道这可以用 psql 完成，但 psql 没有“-c clean”选项。

这可能但使用 pg_restore 吗？

```
 pg_dump --schema public dbName | psql dbNameTest 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-05T10:34:22.940

以下接近：

```
pg_dump --schema-only --format c dbName | \
  pg_restore --schema-only --clean --dbname=dbNameTest 
```

除非它不`dbNameTest`存在，否则它不起作用。以下完成了这项工作（尽管如果`dbNameTest`已经存在它会抱怨。我可以忍受）

```
createdb dbNameTest
pg_dump --schema-only --format c dbName | \
  pg_restore --schema-only --clean --dbname=dbNameTest 
```

具有短选项的 oneliner 将是：

```
createdb dbNameTest ; pg_dump -s -F c dbName | pg_restore -s -c -d dbNameTest 
```

一个 sh 脚本`pg_copy_schema`会是这样的：

```
#!/bin/sh
if [ -z "$2" ] ; then echo "Usage: `basename $0` original-db new-db" ; exit 1 ; fi
echo "Copying schema of $1 to $2"
createdb "$2" 2> /dev/null
pg_dump --schema-only --format c "$1" | pg_restore --schema-only --clean --dbname="$2" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T16:24:07.513

[http://www.postgresql.org/docs/9.1/static/app-pgdump.html](http://www.postgresql.org/docs/9.1/static/app-pgdump.html)

您需要将 -F 与 -c 、 -d 或 -t 选项与 pg_dump 结合使用，以便将其与 pg_restore 一起使用。您不能将 pg_restore 与纯文本 SQL 转储一起使用。

# asp.net - LINQ：具有多对多关系，从列表中选择

> ID：11103283
> 
> 赞同：3
> 
> 时间：2012-06-19T14:36:07.853
> 
> 标签：asp.net, asp.net-mvc-3, linq, entity-framework

我无法弄清楚如何根据多对多关系中的列表进行选择。

我使用实体框架创建了以下实体和多对多关系（如果我要解决这个问题，请纠正我）：

```
public class Foo {
  public int FooID { get; set; }
  public string FooName { get; set; }
  public virtual ICollection<FooBar> Foo_Bar { get; set; }
}

public class Bar {
  public int BarID { get; set; }
  public string BarName { get; set; }
  public virtual ICollection<FooBar> Foo_Bar { get; set; }
}

public class FooBar {
  public int FooBarID{ get; set; }
  public virtual int BarID { get; set; }
  public virtual int FooID { get; set; }
} 
```

在我的代码中，我的控制器将收到一个 Foo 列表，我需要找到所有带有这些 foo 的 Bar （包括 only 和 with any ）

我不知道从哪里开始……这就是我想出的全部：

```
public PartialViewResult SearchAnyBar(List<Foo> foos) {
    List<FooBar> foobars = _db.FooBar.Select(fb => fb).ToList<FooBar>();
    List<Bar> searchedBars = new List<Bar>();

    foreach (Foo f in foos)
    {
        foreach (FooBar fXb in foobars) 
        {
            if (fXb.FooID == f.FooID)
            {
                searchedBars.Add(_db.Bar.Where(b => b.BarID == fXb.BarID).FirstOrDefault());
            }
        }
    }        

    return PartialView("The View", searchBars);
} 
```

但是，这适用于抓取任何 Bar：

1.  我很肯定有一种更好的方法可以做到这一点，有没有一种方法可以根据列表进行选择，而不是进行大约 2 个 foreach 循环？

2.  我不确定如何获取 Foo 的列表，其中 Foo 具有所有酒吧，而不仅仅是任何酒吧。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T15:07:42.550

删除 FooBar 类。

`public virtual ICollection<Foo> Foos {get;set;}`只需在您的 Bar 类中创建一个

和`public virtual ICollection<Bar> Bars {get;set;}`你的 Foo 类

这将创建多对多关系（在您的数据库中使用名为 [Foo-Bar] 的关系表或类似的东西......但谁介意，您将使用对象）。

然后

任何查询：

```
var listOfFooId = <a list of Foo>.Select(m => m.FooId).ToList;
return _db.Bar.Where(m => m.Foos.Any(x => listOfFooId.Contains(x.FooId))); 
```

不确定我是否理解“唯一”和“任何”，但如果您对其他查询有疑问......请问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:48:12.683

未经测试，但看起来您只需要在这里加入...加入所有 FooBar 中的所有 Bar，加入到传入的 Foos 中，对吗？

```
public PartialViewResult SearchAnyBar(List<Foo> foos) { 

    var bars = (from f in foos
               join fb in _db.FooBars on f.Id equals fb.FooId
               join b in _db.Bars on fb.BarId equals b.BarId
               select b).ToList();

        return PartialView("The View", bars); 
    } 
```

# javascript - 如何将动画例程转换为通用的、可重用的 jQuery 函数？

> ID：11103286
> 
> 赞同：0
> 
> 时间：2012-06-19T14:36:09.677
> 
> 标签：javascript, jquery, animation

我首先开发了一个简单的 jQuery 动画，然后我创建了一个 jQuery 函数来实现可重用性，它会做同样的事情。这是一个演示：http: [//jsfiddle.net/SpMns/](http://jsfiddle.net/SpMns/)

我的代码正在运行，但并不可靠：当我单击按钮运行代码时，什么也没有发生；单击它两到三下将启动动画。为什么第一次就不行？

请看一下我的例行程序并告诉我需要纠正的区域：

```
jQuery.fn.busyToggle = function(ImgLoadSrc, marginBottom, opacity, speed, 
                                easing, callback) {
  var oDiv = $("<div id='BusyBox'><img src='" + ImgLoadSrc 
           + "'  alt='Loading...'/><div><em>Loading Wait...</em></div></div>");
  if ($("#BusyBox").exists() == false) {
    //alert('div not exist');
    oDiv.css("background", "-moz-linear-gradient(center top , #F1F2F2 0%, #F1F2F2 100%) repeat scroll 0 0 transparent");
    oDiv.css("border-top-left-radius", "5px");
    oDiv.css("border-top-right-radius", "5px");
    oDiv.css("bottom", "0px");
    oDiv.css("font-size", "0.8em");
    oDiv.css("font-style", "normal");
    oDiv.css("font-weight", "normal");
    oDiv.css("left", "50%");
    oDiv.css("margin-left", "-45px");
    oDiv.css("padding-top", "20px");
    oDiv.css("position", "fixed");
    oDiv.css("text-align", "center");
    oDiv.css("width", "90px");
    oDiv.css("height", "50px");
    oDiv.css("margin-bottom", "-70px");
    oDiv.css("background-repeat", "no-repeat");
    oDiv.css("background-position", "center center");
    oDiv.data('IsUp', 1)
    oDiv.appendTo('body');
  }

  // i work with jquery data function for achieving toggle behaviour
  if (oDiv.data('IsUp') == 1) {
    oDiv.data('IsUp', 0);
    return this.stop(true).animate({
      marginBottom: marginBottom,
      opacity: opacity
    }, {
      queue: false,
      duration: speed,
      complete: callback
    });
  }
  else {
    oDiv.data('IsUp', 1);
    return this.stop(true).animate({
      marginBottom: marginBottom,
      opacity: opacity
    }, {
      queue: false,
      duration: speed,
      complete: callback
    });
  }
};
$(document).ready(function() {
  $("#Process").click(function() {
    if (flag == 1) {
      $('#BusyBox').busyToggle('images/loader.gif', 0, 1, 500, 0, function() {
        alert('div visible')
      });
      flag = 0;
    }
    else {
      $('#BusyBox').busyToggle('images/loader.gif', -70, 0, 500, 0, function(){
        alert('div hide')
      });
      flag = 1;
    }
    return false;
  });
}); 
```

什么可能导致它在第一次运行时失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:04:06.207

问题是#busyToggle 中的*这种用法*

在第一次调用时，$('#BusyBox') 变成了一个空数组，这意味着这个（在#busyToggle 中）也是一个空数组。

A better solution to your probelm would be to call busyToggle this way:

```
$('#Process').busyToggle('images/loader.gif', 0, 1, 500, 0, function() {
    alert('div visible')
}); 
```

and use $('#BusyBox') instead of this in your function.

You can find all the code over there: [http://jsfiddle.net/ubmCt/8/](http://jsfiddle.net/ubmCt/8/)

P.S: I've also added following line to the ready function, otherwise it won't run in most browsers

> var flag = 1;

# html - ASP.NET MVC 中的 HTML 标签颜色

> ID：11103288
> 
> 赞同：7
> 
> 时间：2012-06-19T14:36:17.957
> 
> 标签：html, asp.net-mvc

我有一个非常通用的网页来显示信息。我的 .cshtml 中有这段代码：

```
<div style="text-align: left">
    Test&nbsp;&nbsp;<p style="color: #1e83ca;"> @Html.Label(Model.MemberName) &nbsp;&nbsp;&nbsp;&nbsp;</p>
    Beruf&nbsp;&nbsp;@Html.Label(Model.ProfessionName)&nbsp;&nbsp;&nbsp;&nbsp;
    Datum&nbsp;&nbsp;@Html.Label(Model.TestTakenDate.ToString()) 
</div> 
```

我想将我显示的从数据库读取的文本与固定文本区分开来。我正在使用助手标签，没有区别。我得到所有黑色文本。如何仅以不同颜色制作 @Html.label 中的内容？或者我还能用什么让它们看起来不同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-29T14:44:42.067

我刚刚做了以下事情，它对我有用：

```
@Html.Label("This is a label", new { style = "color:#ff0000"}) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T09:53:26.157

正如我的评论中提到的，尝试使用`<span>`. 那可行 ！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T14:41:09.487

```
@Html.Label(Model.ProfessionName, new {@class = "mylabel" }) 
```

在 CSS 中

```
.mylabel
{
   color: green;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T14:42:43.107

尝试给你的@Html.Label 课程。

所以在你的 CSS 中：

```
.database { color: #1e83ca; } 
```

在你的cshtml中

```
@Html.Label(Model.MemberName, new { @class = "database"} ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T14:44:44.073

您可以通过向标签 HTMLHelper 提供附加参数来指定 HTML 属性吗？

就像是：

```
<%= Html.Label("This is a label", new { style : "color:#FF0000;" } ) %> 
```

# api - Restful api结构

> ID：11103293
> 
> 赞同：0
> 
> 时间：2012-06-19T14:36:45.570
> 
> 标签：api, rest

简单地说，什么更好？

**API 方法：**

```
GET videos/getall
GET videos/get?id=1

GET news/getall
GET news/get/?id=1

GET blogs/getall
GET blogs/get?id=1 
```

**或者**

```
GET content/getall/?type=videos
GET content/getall/?type=news
GET content/get?id=1&type=blogs 
```

第一种方法看起来不像 DRY。但它有一些优点。那么有什么更好的方法呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:39:45.963

所有这些 URI 都是错误的。它们包括将您的 URI 转换为常规 RPC 调用的操作信息（即 getall 和 get）。

您可以选择更简单的方法：

```
GET /videos
GET /videos/1

GET /news
GET /news/1

GET /blogs
GET /blogs/1 
```

HTTP GET 已经意味着您正在检索数据。

# android - 如何将上面有网络摄像头层的surfaceview保存为图像？

> ID：11103300
> 
> 赞同：0
> 
> 时间：2012-06-19T14:37:10.893
> 
> 标签：android, surfaceview

我在android上开发了一个非常简单的应用程序来获取surfaceView上的网络摄像头屏幕，现在我想将surfaceView作为图像捕获到SDCard上，但在保存下面的图片后我只得到一个黑屏是我的完整应用程序在表面上获取网络摄像头屏幕并从表面视图中捕获图像：

```
imported packages 
import android.app.Activity;
import android.content.pm.ActivityInfo;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.PixelFormat;
import android.hardware.Camera;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;
import android.view.*;
import android.widget.Button;
import android.widget.Toast;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException; 
```

在surfaceview上获取网络摄像头屏幕的方法

```
Camera camera;
SurfaceView surfaceView;
SurfaceHolder surfaceHolder;
boolean previewing = false;

private String mScreenshotPath = Environment.getExternalStorageDirectory() + "/myimages";
//private ArrayList<Element> mElements = new ArrayList<Element>();

private Button takePicture;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);

    getWindow().setFormat(PixelFormat.UNKNOWN);
    surfaceView = (SurfaceView)findViewById(R.id.camerapreview);
    surfaceHolder = surfaceView.getHolder();
    surfaceHolder.addCallback(this);
    surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    surfaceView.setDrawingCacheEnabled(true);

    LayoutInflater controlInflater = LayoutInflater.from(getBaseContext());
    View viewControl = controlInflater.inflate(R.layout.control, null);
    ViewGroup.LayoutParams layoutParamsControl = new ViewGroup.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT
            ,ViewGroup.LayoutParams.FILL_PARENT);
    this.addContentView(viewControl,layoutParamsControl);
    takePicture = (Button) findViewById(R.id.takepicture);
    takePicture.setOnClickListener(this);

}

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width,
                           int height) {
    // TODO Auto-generated method stub
    if(previewing){
        camera.stopPreview();
        previewing = false;
    }

    if (camera != null){
        try {
            camera.setPreviewDisplay(surfaceHolder);
            camera.startPreview();
            previewing = true;
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    camera = Camera.open();
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    // TODO Auto-generated method stub
    camera.stopPreview();
    camera.release();
    camera = null;
    previewing = false;
} 
```

在同一堂课上，我将surfaceView捕获为图像的方法

```
@Override
public void onClick(View view) {
    //To change body of implemented methods use File | Settings | File Templates.
    Toast.makeText(getApplicationContext() , "pucture saved" , Toast.LENGTH_SHORT).show();
    saveScreenshot();
    //takePicture.setVisibility(View.GONE);
}

private boolean ensureSDCardAccess() {
    File file = new File(mScreenshotPath);
    if (file.exists()) {
        return true;
    } else if (file.mkdirs()) {
        return true;
    }
    return false;
}

public void saveScreenshot() {
    if (ensureSDCardAccess()) {
        //Bitmap bitmap = Bitmap.createBitmap(surfaceView.getWidth(), surfaceView.getHeight(), Bitmap.Config.ARGB_8888);
        surfaceHolder.getSurface().freeze();
        Bitmap bitmap = surfaceView.getDrawingCache();

        Canvas canvas = new Canvas(bitmap);

        //surfaceView.draw(canvas);
        File file = new File(mScreenshotPath + "/" + System.currentTimeMillis() + ".jpg");
        FileOutputStream fos;
        try {
            fos = new FileOutputStream(file);
            bitmap.compress(Bitmap.CompressFormat.JPEG, 100, fos);
            fos.close();
        } catch (FileNotFoundException e) {
            Log.e("Panel", "FileNotFoundException", e);
        } catch (IOException e) {
            Log.e("Panel", "IOEception", e);
        }
    }
} 
```

布局：

```
//main.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
        >
    <SurfaceView
            android:id="@+id/camerapreview"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            />

</LinearLayout>

//control.xml
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
              android:orientation="vertical"
              android:layout_gravity="bottom"
        >
    <Button android:id="@+id/takepicture"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Take picture"
            android:layout_gravity="right"
            android:layout_margin="10dp"

            />

</LinearLayout> 
```

如您所见，我能够在位图对象中捕获surfaceView，但我的问题是，在将surfaceView 保存在位图对象中期间，在surfaceView 上没有任何网络摄像头屏幕的线索。

我怎样才能有一个持久的surfaceView，这样我就不会错过网络摄像头屏幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:39:46.307

我有一个类似的事情，我需要用覆盖来保存我的图像。我首先保存捕获的图像，然后将其放回我的视图中，然后将其保存为位图来实现这一点。它对我需要的东西来说足够好。

# javascript - 将鼠标悬停两次以加载 ajax

> ID：11103302
> 
> 赞同：1
> 
> 时间：2012-06-19T14:37:12.547
> 
> 标签：javascript, jquery, html

这行得通，但是当我第一次悬停时，什么都没有加载。当我关闭鼠标然后重新打开时，ajax 已加载。我希望 ajax 在第一次悬停时加载。

索引.html

```
<span title="" id="test" class="tooltip"></span> 
```

工具提示.html

```
<span id="test">this is ajax</span> 
```

jQuery

```
$('.tooltip').hover(function () {
    var id = $(this).attr('id');
    $.get('tooltip.html #'+id, function(data) {
        $('#'+id).attr('title', data);
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:41:48.037

看起来您依赖于浏览器的内置工具提示（在悬停时显示标题。）该工具提示可能是由`mouseover`事件触发的，这意味着在您动态添加标题后，您需要另一个`mouseover`事件来实际触发工具提示。似乎它按设计工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:44:47.100

这是因为第一次悬停（实际上是 mouseenter 事件）时，ajax 函数会加载数据并更改标题，但是 mouseenter 事件已经触发并且您的工具提示已经打开，所以为时已晚。

最好的办法是直接更改工具提示，而不是更改原始元素的标题。

您实际上应该做的是更改两者并更改悬停功能以检查标题，以便下次悬停时您不需要再次加载信息，而是参考您已经填充的标题。

希望有帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:46:59.723

如前所述，问题在于浏览器会在您将元素悬停时立即显示内置标题，并且 ajax 会使用一些时间来加载内容并附加它。

我建议您使用许多工具提示插件之一：[https ://www.google.com/search?q=tooltip+jquery+plugin](https://www.google.com/search?q=tooltip+jquery+plugin)

我对 qTip 有过一些很棒的经验。易于设置且易于重新设计。

# javascript - while循环中的Javascript同步超时

> ID：11103310
> 
> 赞同：0
> 
> 时间：2012-06-19T14:37:40.537
> 
> 标签：javascript, asynchronous, timeout, while-loop, synchronous

我试图在执行 AJAX 请求时伪造同步 JavaScript。我有一个`getPagePath(id)`函数需要通过给它一个页面 ID 来获取页面的页面路径，它通过 Web API 接收数据。我认为这很简单，只需向服务器发出 ajax 请求并接收页面路径。但是发生了什么：当请求页面路径时，我的代码继续运行并返回一个空 var，之后 ajax 调用完成，但迟到了。

我知道我的解释不多，所以这是我的代码：

```
var getPagePath = function() {

    // Function to check if this.pagePath is set.
    var pagePathReady = function() {
        console.log('PAGEPATH: CHECKING');
        if (this.pagePath && this.pagePath != null) {
            return true;
        } else {
            return false;
        }
    };

    if (!pagePathReady()) {
        // No pagePath defined so lets set it.
        this._setPagePath();

        while (!pagePathReady())
        {
            // Not yet defined, check again..

            // *** The problem ***
            // This while loop is running insanely fast making the browser crash.
            // How can I make this wile loop pause for 1 sec?
            // *******************

            console.log('PAGEPATH: NOT READY -> CHECK AGAIN');
        }

        // READY
        console.log('PAGEPATH: READY -> VALUE: ' + this.pagePath);
        return this.pagePath;
    } else {
        return this.pagePath;
    }
};

var _setPagePath = function() {
    if (!this.pagePathRequestFired) {
        this.pagePathRequestFired = true;
        // Fire request.
        system.url(
            this.getNodeId(), 
            function(url) {
                // Request ready, set pagePath.
                this.pagePath = url;
                this.pagePathRequestFired = false;
            }, 
            this
        );
    } else {
        // Call already running..
    }
}; 
```

我已经在更多解释性的评论中设置了问题。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:44:47.200

与其轮询`pagePath`（恕我直言，这似乎不是必需的），为什么不在 _setPagePath 准备好时执行回调？如果你想伪造一个同步请求，你可以只向用户显示一个加载微调器作为覆盖，禁用 UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:31:51.320

如果你真的需要，你可以同步 ajax 调用。

```
xmlhttp.open("GET", "url", false); 
```

注意第三个参数。

但是，我认为您只需要更多的练习来编写代码以使用事件/回调概念。

# clojure - 使用 clojure 进行大规模数据挖掘

> ID：11103317
> 
> 赞同：10
> 
> 时间：2012-06-19T14:37:49.693
> 
> 标签：clojure, data-mining

我正在寻找一个很好的参考

使用 Clojure 进行大规模数据挖掘

我知道许多优秀的 clojure 编程书籍（Programming Clojure、Joy of Clojure……），以及许多优秀的数据挖掘教科书（挖掘海量数据集、管理千兆字节……）。但是我不知道有任何专门针对

使用 Clojure 进行大规模数据挖掘

“with clojure”部分对我来说相当重要，原因如下：

```
* most theoretical analysis uses big-Oh running time, which ignores constants
* constants matter, if it ends up being a matter of 1 second vs 1 hour (for things that need to be real time)
* or 1 hour vs 1 week (for batch jobs) 
```

特别是，我认为 JVM、Clojure 数据结构之间存在很多相互作用，无论数据是存储在内存中还是从磁盘中懒惰地读取——它们可以通过“稍微”不同的实现来让“相同”的算法具有截然不同的运行时间.

因此，我的问题（以上所有内容都是为了避免被“Check Google”关闭）：

用 Clojure 进行海量数据挖掘的好资源是什么？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-19T15:42:17.440

我认为还没有人写过一个很好的综合参考。但在这个领域肯定有很多工作正在进行（包括我自己的公司！）

一些有趣的后续链接：

*   [Storm](https://github.com/nathanmarz/storm/wiki) - 使用 Clojure 的分布式实时计算。可用于大规模数据挖掘。
*   [http://www.infoq.com/presentations/Why-Prismatic-Goes-Faster-With-Clojure](http://www.infoq.com/presentations/Why-Prismatic-Goes-Faster-With-Clojure) - 关于 Clojure 性能和机器学习应用程序优化的有趣视频
*   [Incanter](http://incanter.org/) - 可能是领先的 Clojure 统计和数据可视化库
*   [Weka](http://www.cs.waikato.ac.nz/ml/weka/) - 非常全面的 Java 数据挖掘/机器学习库（因此非常容易直接从 Clojure 中使用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T19:38:09.603

2013 年 5 月出版了一本很棒的书：**Clojure Data Analysis Cookbook**。我可能会买它。

[http://www.amazon.co.uk/Clojure-Data-Analysis-Cookbook-ebook/dp/B00BECVV9C/ref=sr_1_1?s=books&ie=UTF8&qid=1360697819&sr=1-1](http://www.amazon.co.uk/Clojure-Data-Analysis-Cookbook-ebook/dp/B00BECVV9C/ref=sr_1_1?s=books&ie=UTF8&qid=1360697819&sr=1-1)

> 详细地
> 
> 数据无处不在，能够获得我们可以采取行动的洞察力变得越来越重要。使用 Clojure 进行数据分析和收集，本书将向您展示如何通过实用的结构化方法的基本集合从数据中获得新的见解和观点。
> 
> “Clojure 数据分析食谱”为数据分析过程的每个阶段提供了秘诀。无论是从网页上抓取数据、执行数据挖掘，还是为网络创建图表，这本书都可以完成手头的任务。
> 
> 您将学习如何获取数据、清理数据并将其转换为有用的图表，然后可以对其进行分析并发布到 Internet。涵盖的内容包括高级主题，例如同时处理数据、应用贝叶斯建模等强大的统计技术，甚至是 K-means 聚类、神经网络和关联规则等数据挖掘算法。
> 
> 方法
> 
> 充满实用技巧的“Clojure 数据分析食谱”将通过一系列涵盖数据分析各个方面的逐步、真实世界的食谱来帮助您充分利用您的数据。
> 
> 这本书是给谁看的
> 
> Clojure 和数据分析技术和工作流程的先前经验将是有益的，但不是必需的。

# python - 在windows中使用资源

> ID：11103321
> 
> 赞同：12
> 
> 时间：2012-06-19T14:38:04.350
> 
> 标签：python, windows

我有一个使用 python 中的资源模块的脚本（有关信息，请参阅[http://docs.python.org/library/resource.html](http://docs.python.org/library/resource.html)）。现在我想将此脚本移植到 Windows。是否有任何替代版本（python-docs 将其标记为“仅限 unix”）。如果没有，还有其他解决方法吗？

我正在使用以下方法/常量：

```
resource.getrusage(resource.RUSAGE_CHILDREN)
resource.RLIMIT_CPU 
```

谢谢

PS：我正在使用 python 2.7 / 3.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:19:54.240

对于所有“资源”没有通用的好方法 - 因此它是一个仅限 Unix 的命令。仅对于 CPU 速度，您可以使用注册表项来设置进程 ID 限制：

[http://technet.microsoft.com/en-us/library/ff384148%28WS.10%29.aspx](http://technet.microsoft.com/en-us/library/ff384148%28WS.10%29.aspx) 在这里完成：http: [//code.activestate.com/recipes/286159/](http://code.activestate.com/recipes/286159/)

*重要提示：*在尝试使用注册表之前备份您的注册表

或者您可以设置线程优先级：

[http://msdn.microsoft.com/en-us/library/ms685100%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms685100%28VS.85%29.aspx) 在这里完成：http: [//nullege.com/codes/search/win32process.SetThreadPriority](http://nullege.com/codes/search/win32process.SetThreadPriority)

对于其他资源，您必须将类似的 DLL 访问 API 拼凑在一起才能达到预期的效果。您应该首先问自己是否需要这种行为。通常，您可以通过在方便的时间使运行中的线程休眠来限制 CPU 时间，以允许操作系统交换进程，并且可以有问题地进行内存控制以检查数据结构大小。

# c - 从用户空间管理虚拟内存

> ID：11103322
> 
> 赞同：0
> 
> 时间：2012-06-19T14:38:08.070
> 
> 标签：c, linux, gcc, x86-64

我真正想做的是将某个内存区域中的写入重定向到两个进程之间共享的单独内存区域。这可以在用户级别完成吗？例如，对于某些页面 X。我想做的是在写入时将其（虚拟到物理）映射更改为某些共享映射。这是可以实现的吗？我也需要透明地做到这一点，即程序仍然通过名称或指针使用页面 X 中的变量，但在幕后，我们使用的是不同的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:53:21.933

您尝试做的事情并不完全可能，因为至少在 x86 上，内存无法重新映射到细粒度的规模上。您可以重新映射内存的最小量是 4k 页面，包含任何给定变量（例如 X）的页面很可能包含其他变量或程序数据。

话虽如此，您可以使用`mmap()`系统调用在进程之间共享内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:57:52.587

是的，可以在 Linux 中替换内存映射，但不建议这样做，因为它非常不便携。

`X`首先，您应该通过获取变量地址并屏蔽最后几位来找出变量位于哪个页面- 查询系统页面大小`sysconf(_SC_PAGE_SIZE)`以了解要屏蔽多少位。然后，您可以使用 to或`MAP_FIXED | MAP_SHARED`标志创建与此页面重叠的共享内存映射。您应该复制页面的初始内容并在新映射后恢复它。由于其他变量可能驻留在同一页面中，因此您应该非常小心内存布局并更好地使用专用的共享内存对象。`mmap(2)``mmap2(2)`

# vb.net - 它怎么会发生 - 如果 case 语句抛出异常“case else”开始工作？

> ID：11103324
> 
> 赞同：0
> 
> 时间：2012-06-19T14:38:10.363
> 
> 标签：vb.net, exception-handling, switch-statement

看起来不可能，但是...

```
 Try
    Select Case command
            Case 1
              smth()
            Case 2
                If Not validSmth() Then
                    Throw New Exception(errMsg)
                Else
                   doSmth()
                End If
            Case 3
                doSmthElse()
            Case Else
                Throw New Exception(errMsg2)
        End Select
    Catch ex As Exception
        ProcessEx()
    End Try 
```

首先`Case 2`运行。抛出异常。在这个调试器显示下一个处理的语句之后是`Case Else`. 只有在`Case Else`抛出自己的异常`Catch`块后才开始工作。我从来没有见过这种伎俩。为什么会发生这种情况？

我确定该块被输入一次（不是这样的：first enter hit `Case 2`and second hit `Case Else`）。

感谢您的任何想法。

## 更新：

——致马特·威尔科。谢谢你的回答。我已经切换到`Strict On`VS2010 的选项，但没有任何改变。 `Command`是变量，不是函数。观察工具显示每一步`Command`都是相同的（`Command`= 2）。

## 回答

固定的。是啊啊啊。我将代码简化为

```
 Try
        Select Case 2
            Case 2
                Throw New Exception("123")
            Case Else
                Throw New Exception("345")
        End Select
    Catch ex As Exception
        wtf(ex.Message)
    End Try 
```

并将项目更改为控制台应用程序。正如我所提到的，这很有效。修复在`Release mode`. 我正在调试`Release mode`. 当我切换到`Debug mode`一切正常时。

感谢大家的快速解答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:32:54.207

我刚刚尝试了一个简单的示例来说明您所展示的内容，但对我来说它按预期工作。当抛出异常时，执行会直接跳转到`Catch`其他地方。输出显示“EX:2”。

我会设置更多断点以确保您不会输入两次代码。如果失败，请重新启动 Visual Studio（有时调试器会变得很奇怪）。我认为您描述的行为不可能发生。

```
Sub Main()

    Dim Command As Integer = 2
    Try
        Select Case Command
            Case 1
                Console.WriteLine("1")
            Case 2
                Throw New Exception("2")
            Case 3
                Console.WriteLine("3")
            Case Else
                Throw New Exception("ELSE")

        End Select
    Catch ex As Exception
        Console.WriteLine("EX:" & ex.Message)
    End Try

    Console.ReadLine()

End Sub 
```

# java - 未找到 Amazon 凭证方法

> ID：11103325
> 
> 赞同：5
> 
> 时间：2012-06-19T14:38:16.010
> 
> 标签：java, servlets, amazon

所以我的下一个问题是这段代码。似乎没有找到方法，我的眼睛没有受过训练。对此有任何帮助吗？

```
package packeging;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.Calendar;
import java.util.Date;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.amazonaws.HttpMethod;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3Client;
import com.amazonaws.auth.BasicAWSCredentials;
import org.apache.http.*;
/**
 * Servlet implementation class Hashtastic
 */
@WebServlet("/Hashtastic")
public class Hashtastic extends HttpServlet {
    private static final long serialVersionUID = 1L;
    private final static String BUCKET_NAME = "idlatestingbucket";//http://s3.amazonaws.com/THESISDB/techy.jpg
    private final static String FILE_NAME = "TestPicture/wallpaper-264411.png";
    private final static String ACCESS_KEY = "Fakepass";
    private final static String SECRET_KEY = "Fakekey";
    /**
     * Default constructor. 
     */
    public Hashtastic() {
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
         PrintWriter out = response.getWriter();
          Calendar cal = Calendar.getInstance();
         cal.add(Calendar.SECOND, 1000);
         Date expDate = cal.getTime();
         out.println(expDate+"\n");

         BasicAWSCredentials cre = new BasicAWSCredentials(ACCESS_KEY, SECRET_KEY);
        AmazonS3 s3 = new AmazonS3Client(cre);
        String url = s3.generatePresignedUrl(BUCKET_NAME, FILE_NAME, expDate, HttpMethod.GET).toString();
        out.println(url);
         out.close();
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
    }

} 
```

我收到这个 500 错误。它说它缺少一种方法。我的库中有 jar 和 Eclipse 插件。

```
description The server encountered an internal error () that prevented it from fulfilling this request.

exception 

javax.servlet.ServletException: Servlet execution threw an exception

root cause 

java.lang.NoSuchMethodError: org.apache.http.impl.conn.tsccm.ThreadSafeClientConnManager: method <init>()V not found
    com.amazonaws.http.ConnectionManagerFactory.createThreadSafeClientConnManager(ConnectionManagerFactory.java:26)
    com.amazonaws.http.HttpClientFactory.createHttpClient(HttpClientFactory.java:83)
    com.amazonaws.http.AmazonHttpClient.<init>(AmazonHttpClient.java:116)
    com.amazonaws.AmazonWebServiceClient.<init>(AmazonWebServiceClient.java:60)
    com.amazonaws.services.s3.AmazonS3Client.<init>(AmazonS3Client.java:291)
    com.amazonaws.services.s3.AmazonS3Client.<init>(AmazonS3Client.java:273)
    packeging.Hashtastic.doGet(Hashtastic.java:48)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

note The full stack trace of the root cause is available in the Apache Tomcat/7.0.27 logs. 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T16:22:03.003

如果您的类路径中有错误版本的 httpclient jar，或者如果您的类路径中有多个版本的 jar（例如同时具有 httpclient-4.0.1.jar 和 httpclient-4.1.1.jar，则可能会发生这种情况）。

它也可能是由另一个包含同一类的不同版本的 jar 引起的。例如，我知道 gwt-dev.jar 包含一个版本的 ThreadSafeClientConnManager。如果是这种情况，可以通过调整构建路径顺序将 httpclient.jar 放在 gwt-dev.jar 之前（或导致问题的其他 jar）来解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T23:22:19.490

根据对这个完全相同的异常的经验，它很有可能是由于 gwt-dev 出现在类路径中的 aws-java-sdk 之前以及由于 gwt-dev 包含冲突（就类加载而言）版本的 org. apache.http.impl.conn.tsccm.ThreadSafeClientConnManager

如果您碰巧使用 Maven，请按如下方式重新排序您的依赖项，并可能向其他维护者添加关于排序重要性的警告。

```
<dependency>
   <groupId>com.amazonaws</groupId>
   <artifactId>aws-java-sdk</artifactId>
   <version>1.3.26</version>
</dependency>

<dependency>
  <groupId>com.google.gwt</groupId>
  <artifactId>gwt-dev</artifactId>
  <version>2.3.0</version>
</dependency> 
```

# php - 将 HTML 表格转换为文本

> ID：11103327
> 
> 赞同：9
> 
> 时间：2012-06-19T14:38:20.527
> 
> 标签：php, html, text, html-table

我正在开发一个需要将 html 电子邮件转换为文本的项目。以下是 HTML 代码的简化版本：

```
<table>
    <tr>
        <td width="10%"></td>
        <td width="60%"> test product </td>
        <td width="20%">5</td>
        <td width="10%"> £50.00 </td>
    </tr>
    <tr>
        <td></td>
        <td colspan="3" width="100%"> Project Name: Test Project </td>
    </tr>
    <tr>
        <td width="10%"> </td>
        <td colspan="2" width="80%"> Page 1 : 01 New York 1.jpg </td>
        <td width="10%"> £0.00 </td>
    </tr>
</table> 
```

文本文件中的预期结果应如下所示（列对齐良好）：

```
test product                                      5            £50.00
Project Name: Test Project                                                            
Page 1 :  01 New York 1.jpg                                    £0.00 
```

我的想法是通过 DOMDocument 解析 HTML 内容。然后我将为表格设置一个默认宽度（即：100 个空格），然后将每列的宽度从 % 转换为空格数（基于标签的`colspan`&`width`属性）。`<td>`然后，我将从每列中的数据中减去这些列宽，`strlen`以归档我需要 pad_right 到字符串以使所有内容垂直对齐的空格数。

我一直在这样工作，还没有归档我想要的东西，但只是想知道这是否是愚蠢的，或者有人知道更好的方法，请帮助我。

此外，当涉及到多字节语言（日语、韩语等）时，我认为我的方法不会奏效，因为它们的字符会大于一个空格并且最终会变得一团糟。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-19T15:02:48.957

不要重新发明轮子。表格渲染很困难，仅使用文本渲染表格更加困难。为了阐明提供 HTML 的所有功能的基于文本的表格渲染器的复杂性，请看一下开源的 w3m： [这 3000 行代码](https://github.com/tats/w3m/blob/master/table.c)仅用于显示 html 表格。

# 将 HTML 转换为文本

命令行可以使用一些基于文本的浏览器，例如 lynx。您可以将`fwrite`您的 html 表放入一个文件中，将该文件传递到基于文本的浏览器中并获取其输出。

注意：基于文本的浏览器通常在 shell 中使用，它通常以等宽显示。这仍然是一个先决条件。

lynx 和 w3m 都可以在 Windows 上使用，你不需要“安装”它们，你只需要拥有可执行文件和从 PHP 运行它们的权限。

代码示例：

```
<?php
$table = '<table><tr><td>foo</td><td>bar</td></tr></table>'; //this contains your table
$html = "<html><body>$table</body></html>";

//write html file
$tmpfname = tempnam(sys_get_temp_dir(), "tblemail");

$handle = fopen($tmpfname, "w");
fwrite($handle, $html);
fclose($handle);

$myTextTable = shell_exec("w3m.exe -dump \"$tmpfname\"");
unlink($tmpfname); 
```

`w3m.exe`需要在您的工作目录中。

（没试过）

# 渲染文本表

如果您想要一个原生 PHP 解决方案，那么至少还有一个框架 ( [https://github.com/c9s/CLIFramework](https://github.com/c9s/CLIFramework) ) 针对具有表格渲染器的 PHP 控制台应用程序。

它不会将 HTML 转换为文本，但它可以帮助您构建一个支持多行单元格的文本格式表格（这似乎是最复杂的部分）。

使用 CLIFramework 你需要这样的代码来呈现你的表格：

```
<?php
require 'vendor/autoload.php';
use CLIFramework\Component\Table\Table;

$table = new Table;
$table->addRow(array( 
    "test product", "5", "£50.00"
));
$table->addRow(array( 
    "Project Name: Test Project", "", ""
));
$table->addRow(array( 
    "Page 1 : 01 New York 1.jpg", "", "£0.00"
));

$myTextTable = $table->render(); 
```

然而，CLIFramework 表渲染器似乎不支持任何类似于“colspan”的东西。

这是表格组件的文档：[https ://github.com/c9s/CLIFramework/wiki/Using-Table-Component](https://github.com/c9s/CLIFramework/wiki/Using-Table-Component)

# java - 表单值上的 getMethod 安全吗？

> ID：11103329
> 
> 赞同：0
> 
> 时间：2012-06-19T14:38:23.400
> 
> 标签：java, reflection, portlet

最近我在一个通用的 JSR245 portlet 类中发现了一个这样的函数：

```
 public class MyGenericPortlet extends GenericPortlet {
      @Override
      public void processAction(ActionRequest rq, ActionResponse rs) throws PortletException{
        String actParam = rq.getParameter("myAction");

        if( (actParam != null) && (!("").equals(actParam))) {
          try{
            Method m = this.getClass().getMethod(actParam, new Class[]{ActionRequest.class, ActionResponse.class});
                m.invoke(this, new Object[]{rq, rs});
            }
            catch(Exception e){
                setRequestAttribute(rq.getPortletSession(),"error", "Error in method:"+action);
                e.printStackTrace();
            }
        }
        else setRequestAttribute(rq.getPortletSession(),"error", "Error in method:"+action);
      }
    } 
```

这样的代码有多安全？据我所知，可能会出现以下问题：

1.  从客户端传输的参数未经检查用于调用函数。这允许任何可以将数据传输到相应 portlet 的人调用任何匹配的函数。另一方面，要调用的函数必须具有特定的接口。通常这样的功能非常少见。
2.  程序员可能不小心添加了具有相应接口的函数。由于似乎只发现了公共功能，只要该功能是私有的或受保护的，这没有问题。
3.  错误消息可以向客户端揭示有关软件的信息。这应该不是问题，因为软件本身是开源的。

显然，存在一些可以利用的编程错误空间。是否还有其他可能发生的不良副作用？我（或开发人员）应该如何判断这个功能带来的风险？

如果你认为它是安全的，我想知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:56:35.353

只能远程调用具有特定签名的公共方法这一事实很好。但是，可以通过例如要求对操作方法进行特殊注释来使其更加安全。这表明开发人员特别打算将该方法作为可调用的操作。

当前实现可能存在危险的现实场景是，开发人员添加了一个操作来验证请求中的信息是否安全，然后将请求和响应传递给另一个方法进行实际处理。如果攻击者可以获知委托方法的名称，他就可以直接调用它，绕过参数安全验证。

# ruby-on-rails - RSpec，方法帖子中的错误参数

> ID：11103331
> 
> 赞同：1
> 
> 时间：2012-06-19T14:38:33.870
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

我测试密码恢复，但有错误。最近进行了 Rspec 研究。

代码（用户控制器）

```
def forgot
  if request.post?
    user = User.find_by_email(params[:user][:email])
    if user
      user.create_reset_code
    end
    flash[:notice] = t('helpers.notice_email')
    render :template => "sessions/new"
  end
end 
```

rspec 测试

```
it "POST 'reset page'" do
  User.should_receive(:find_by_email).with({:email => @user.email})
  post :forgot, :user => {"email" => @user.email}
end 
```

我在测试中做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:48:43.603

```
User.should_receive(:find_by_email).with(@user.email) 
```

# java - 使用OOo在Java中将文档转换为pdf

> ID：11103343
> 
> 赞同：2
> 
> 时间：2012-06-19T14:39:03.640
> 
> 标签：java, pdf

我正在寻找一种使用 Java API 将 docx、doc、odt 和其他文档转换为 PDF 的方法

我以前使用过 JODConverter，但它不再维护。

谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-19T14:44:05.813

我没用过，但我知道它在那里。

[http://www.aspose.com/categories/java-components/aspose.pdf-for-java/default.aspx](http://www.aspose.com/categories/java-components/aspose.pdf-for-java/default.aspx)

# java - 异常 java.lang.NoSuchMethodError

> ID：11103344
> 
> 赞同：4
> 
> 时间：2012-06-19T14:39:04.967
> 
> 标签：java, exception, spring-mvc

我正在尝试在服务器中上传 pdf 文件。我在控制器中使用以下代码块：

```
 @RequestMapping(value = /submit, method = RequestMethod.POST)
 public String upload(UploadItem uploadItem, BindingResult result, HttpServletRequest request, HttpSession session) {

   //some code here

   String name = request.getServletContext().getRealPath("/pdf/" + filename);
   File dest = new File(name);
   try {
        file.transferTo(dest);
   }catch(Exception e){
        System.err.println(e);
   }

   return "redirect:/details"; 
```

我这样做是为了将pdf存储到pdf文件中。在我的本地主机中工作正常，但是当我在服务器上执行此操作时，我遇到了以下异常：

```
exception

org.springframework.web.util.NestedServletException: Handler processing failed; nested exception is java.lang.NoSuchMethodError: javax.servlet.http.HttpServletRequest.getServletContext()Ljavax/servlet/ServletContext;
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:839)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)

root cause

java.lang.NoSuchMethodError: javax.servlet.http.HttpServletRequest.getServletContext()Ljavax/servlet/ServletContext;
frontend.controller.EsteemRatingsController.handleFormUpload(EsteemRatingsController.java:113)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
java.lang.reflect.Method.invoke(Method.java:601)
org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)
org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76) 
```

如果我删除上面在控制器类中提供的行是有效的（ofcource 不上传 pdf）。谁能帮我这个？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-19T14:42:52.997

该方法`request.getServletContext()`是在 servlet 3.0 中引入的。确保您的容器/库支持该版本。

编辑：tomcat 6 只有 servlet 2.5，见[http://tomcat.apache.org/whichversion.html](http://tomcat.apache.org/whichversion.html)

它可以自动装配：[ServletContext 和 Spring MVC](https://stackoverflow.com/questions/5739491/servletcontext-and-spring-mvc)

```
public class Xxxx{
    @Autowired
    ServletContext context;

    @RequestMapping(value = "/submit", method = RequestMethod.POST)
    public String upload(UploadItem uploadItem, BindingResult result, HttpServletRequest request, HttpSession session) {

       //some code here

       String name = context.getRealPath("/pdf/" + filename);
... 
```

# c# - .NET 实体框架使用 Table.ModelName_Column 约定生成查询

> ID：11103347
> 
> 赞同：0
> 
> 时间：2012-06-19T14:39:13.187
> 
> 标签：c#, asp.net, asp.net-mvc-3, entity-framework, sqlite

我已经开始使用 ASP.NET MVC 并使用实体框架，特别是使用 SQLite db，但我有一个小问题：

我有一个一对多的关系，但 EF 生成错误的查询，

```
SQLite error
no such column: Extent1.Category_CategoryID 
```

所以，他使用 ModelName 作为前缀，这是错误的。有什么约定，我可以删除吗？还是出发？

谢谢，对不起我的英语不好

// 更新，添加类别实体

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel.DataAnnotations;

namespace Eshop.Domain.Entities
{
    [Table("Categories")]
    public class Category
    {
        public Int64 CategoryID { get; set; }
        public string Name { get; set; }
        public virtual ICollection<Product> Products { get; set; }
    }
} 
```

// 添加产品实体

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel.DataAnnotations;

namespace Eshop.Domain.Entities
{
    [Table("Products")]
    public class Product
    {
        public Int64 ProductID { get; set; }
        public string Name { get; set; }
        public decimal Price { get; set; }
        public int CategoryID { get; set; }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:22:28.933

如果您使用的是 Code-First（我假设），您需要...

*   要么引入导航属性`Product`：

    ```
    [Table("Products")]
    public class Product
    {
        public Int64 ProductID { get; set; }
        public string Name { get; set; }
        public decimal Price { get; set; }
        public int CategoryID { get; set; }

        public virtual Category Category { get; set; }
    } 
    ```

    然后EF将识别`CategoryID`为外键。

*   `CategoryID`或使用 Fluent API配置为外键：

    ```
    modelBuilder.Entity<Category>()
        .HasMany(c => c.Products)
        .WithRequired()
        .HasForeignKey(p => p.CategoryID); 
    ```

# javascript - IE7 中的 iframe 作为表单上传目标？

> ID：11103348
> 
> 赞同：0
> 
> 时间：2012-06-19T14:39:25.820
> 
> 标签：javascript, html, internet-explorer

我的页面上有一个 ID 为 uploadtarget 的 iframe。

```
<iframe id="uploadTarget" name="uploadTarget" src="" ></iframe> 
```

在我的 js 中，我将表单目标设置为 iframe

```
$('#myForm').submit(function() {
        this.target = 'uploadTarget';
        document.getElementById("uploadTarget").onload = uploadDone; 
    }); 
```

这在 IE7 和 8 中不起作用。

任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:48:13.950

*首先：*您将 jQuery 与普通的 JavaScript 混合在一起。利用

```
$('#uploadTarget').load(uploadDone); 
```

代替

```
document.getElementById("uploadTarget").onload = uploadDone; 
```

获得更整洁的代码。

*第二：*`<form>`我的猜测是，一旦提交表单 ，IE 就不允许您再更改目标。如果您中止提交，然后在更改后以编程方式重新提交表单，则`target`可能会起作用。

```
$('#myForm').submit(function(event) {
    if($(this).attr('target')!=='uploadTarget'){
       $(this).attr('target','uploadTarget');

       event.preventDefault();

       this.submit();//Now submit the form. This should call this function again.
    }else{
       $('#uploadTarget').load(uploadDone);
    }
}); 
```

# jquery - 使用 jQuery Star Rating 插件

> ID：11103351
> 
> 赞同：0
> 
> 时间：2012-06-19T14:39:31.300
> 
> 标签：jquery, jquery-plugins

我有一个关于[jQuery Star Rating Plugin](http://www.fyneworks.com/jquery/star-rating/#tab-Testing)的问题。我正在使用这个插件对购买文章的人进行评分，但这些文章只能被评分一次。对一篇文章进行评分后，它必须变为只读（禁用），我不想再次单击它或将其悬停。我正在使用悬停选项，并且我希望在悬停此选项时将已评级文章的悬停文本固定为文本（例如：“确定”）。我需要知道如何禁用单选按钮（使它们只读），禁用悬停方法并将文本设置为单击单选按钮时的悬停文本（函数回调）。

我尝试`disabled= true;`使用 JavaScript 将单选按钮设置为，但它不起作用。

# c++ - 我可以有条件地替换预处理器参数吗？

> ID：11103352
> 
> 赞同：6
> 
> 时间：2012-06-19T14:39:31.433
> 
> 标签：c++, c, c-preprocessor

在使用单元测试框架时，我遇到了一种我想测试宏参数的情况。`FOO(x)`简单地说，我想将宏`FOO(int)`扩展为.`short``FOO(anything_else)``long`

使用 C++ 模板，这当然不是问题。但在这里我需要一个真正的令牌替换，而不仅仅是一个`typedef`. 即`FOO(char) FOO(char) i;`应该是一个有效的定义，等于`long long i;`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T16:43:33.330

据我所知，C 宏中唯一可用的类似字符串的操作是粘贴/连接标记（使用`##`）和对它们进行字符串化（使用`#`）。

我很确定您将获得的最接近的涉及列举如下可能性：

```
#define FOO(x) FOO__##x
#define FOO__int   short
#define FOO__short long
#define FOO__long  long
#define FOO__char  long
// ... for each type you want to replace 
```

* * *

灵感来自[这个问题](https://stackoverflow.com/questions/2831934/c-preprocessor-using-if-inside-define)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T16:36:38.700

你想做的事情是不可能的。

宏由 c 预处理器评估，顾名思义，它在编译器运行之前运行。它还不知道您的符号类型是什么。

为什么不为在编译器评估时将其自身转换为正确事物的类型创建一个类。

# matlab - Matlab 合适的数据选择

> ID：11103354
> 
> 赞同：2
> 
> 时间：2012-06-19T14:39:35.857
> 
> 标签：matlab, user-interface, matlab-guide, matlab-uitable

我有从 AScii 文件读取的数据的 Uitable。

1.  我想使用鼠标和复选框来选择列。我尝试了很多，但我无法弄清楚如何使用鼠标选择合适的列并获取该数据。

2.  我也试图在 uitable 的最后一行插入复选框，所以当用户选择复选框时，会选择特定的列。

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T16:14:54.797

要处理对列标题的点击，必须去[无证区域](http://undocumentedmatlab.com/blog/uitable-sorting/)：

```
%# old UITABLE (based on Swing JTable, instead of the new JIDE-based)
[hTable,hContainer] = uitable('v0', 'Parent',gcf, ...
    'Data',magic(7), 'ColumnNames',cellstr(num2str((1:7)','C%d'))');
set(hContainer, 'Units','normalized', 'Position',[0 0 1 1])

%# handle mouse clicks on table headers
jTableHeader = hTable.getTable().getTableHeader();
h = handle(jTableHeader, 'CallbackProperties');
set(h, 'MousePressedCallback',...
    @(src,evt) disp( src.columnAtPoint(evt.getPoint())+1 ))  %# zero-based index 
```

![截屏](../Images/3e97873fa3644221fe6ed78adede6eb9.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T14:56:03.130

您应该编辑表格的`CellSelectionCallback`和`CellEditCallback`属性。

```
 set(myTable,`CellSelectionCallback`,@CallBack) 
```

为了查看选择了哪些列/行，请使用您在回调中收到的事件数据。

```
 function CallBack(hObj,evt)   
      disp(evt);
  end 
```

据我所知，当未触发回调时，无法发现当前选择了哪些列。

# android - 如何在 onSaveInstanceState 中保存 ArrayAdapter？

> ID：11103355
> 
> 赞同：0
> 
> 时间：2012-06-19T14:39:41.410
> 
> 标签：android, android-activity, android-arrayadapter

我正在做一个信使应用程序，对于消息历史记录，我使用 ArrayAdapter 创建了一个 ListView。我有一个执行消息传递活动的服务，所以即使用户正在与其他东西交互，它也应该收到一条消息。但是，当我按下主页按钮后返回应用程序时，我得到一个空列表视图，这对我的应用程序来说是一件奇怪的事情。H 尝试将适配器保存在 onsavingInstance 中，但它不起作用，因为它不可序列化。请帮助我如何保留我的列表视图。下面是我的代码的一些补丁。

```
// Array adapter for the conversation thread
private ArrayAdapter<String> mConversationArrayAdapter;

private ListView mConversationView;
// Initialize the array adapter for the conversation thread

mConversationArrayAdapter = new ArrayAdapter<String>(this, R.layout.message);
mConversationView = (ListView) findViewById(R.id.in);
mConversationView.setAdapter(mConversationArrayAdapter);

/** 
 * save the listView 

protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putSerializable("mArrayAdapter",  (Serializable) mConversationArrayAdapter);
    Toast.makeText(this, "History saved.", Toast.LENGTH_SHORT).show();
    }
 */

public void onStart(Bundle savedInstanceState) {
    super.onStart();
    if(D) Log.e(TAG, "++ ON START ++");
   // if (savedInstanceState != null) {
  //    mConversationArrayAdapter = (ArrayAdapter<String>) savedInstanceState.getSerializable("mArrayAdapter");
  //  }
    setupChat();
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-19T14:54:26.693

`onSaveInstanceState`不是保存持久数据的地方......事实上，它甚至可能不会被调用。

我建议您填充并保存`ArrayAdapter`在.`onResume``onPause`

# asp.net-mvc - Telerik MVC Splitter 在提交页面时保持状态

> ID：11103356
> 
> 赞同：0
> 
> 时间：2012-06-19T14:39:42.137
> 
> 标签：asp.net-mvc, asp.net-mvc-3, telerik, telerik-mvc, splitter

我正在使用这样的 Telerik MVC 拆分器：

```
@(Html.Telerik().Splitter().Name("MainSplitter") _
            .Orientation(SplitterOrientation.Horizontal) _
            .HtmlAttributes( New With { .style = "height: 100%;" }) _
            .Panes(Sub(p)
                          p.Add().Collapsible(True).Size("15%").Content(Html.Partial("Menu").ToHtmlString)
                          p.Add().Content(RenderBody().ToHtmlString)
                  End Sub)) 
```

当我折叠菜单窗格时，我希望它保持折叠状态，即使在我浏览 trought 页面时也是如此。刷新页面或用户在页面之间导航时是否可以保持拆分器的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:55:24.890

基本上你想保持控件的状态。我不确定 Telerik MVC 控件是否以内置方式支持此功能（请确认）。

您可以使用两种方式来存储控件的状态，您可以使用 cookie 或[html5 本地存储](http://diveintohtml5.info/storage.html)。

您可以侦听 Splitter 的客户端事件并将状态更新到本地存储或 cookie 中，否则您可以在窗口卸载事件中获取存储并存储它。

当页面加载时，您必须从 cookie/本地存储中重置状态。

参考：[http ://www.telerik.com/support/kb/aspnet-mvc/treeview/persisting-treeview-state-in-cookie.aspx](http://www.telerik.com/support/kb/aspnet-mvc/treeview/persisting-treeview-state-in-cookie.aspx)

# c - GTK 文本框编号输入

> ID：11103359
> 
> 赞同：1
> 
> 时间：2012-06-19T14:39:52.297
> 
> 标签：c, linux, gtk, special-characters

我正在尝试在 GTK+3.0（在 Linux 中使用 C）中创建一个文本框，该文本框可以作为双精度数读取，其中该双精度数将被插入到一个方程中，然后在另一个框中返回。

所以我的问题是：创建一个可以输入的文本框的最佳方法是什么，然后我如何将它读取为双精度？

我目前正在尝试使用`gtk_entry_new()`初始化和 - 经过一些中间步骤 -`*gtk_entry_get_text`来阅读。

我的阅读行目前看起来像这样：

```
double y = (double)*gtk_entry_get_text(GTK_ENTRY(input_y)); 
```

我不断将 y 作为指针，并且`*gtk_entry_get_text(...)`格式为 const gchar*

我相信最好的方法是转换`const gchar*`成`double`，但是如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T18:06:25.600

$ 男子 atof

```
NAME
   atof - convert a string to a double

SYNOPSIS
   #include <stdlib.h>

   double atof(const char *nptr);

DESCRIPTION
   The atof() function converts the initial portion of the string
   pointed to by nptr to double.  The behavior is the same as

       strtod(nptr, (char **) NULL);

   except that atof() does not detect errors.

RETURN VALUE
   The converted value. 
```

因此：

```
double y = atof(gtk_entry_get_text(GTK_ENTRY(input_y))); 
```

# c# - 需要将每个数字 0-x 添加到行尾吗？

> ID：11103370
> 
> 赞同：0
> 
> 时间：2012-06-19T14:40:19.223
> 
> 标签：c#, list, stream

我正在制作一个应用程序，我几乎完成了。我只需要知道如何流式读取 txt 列表和 foreach 行，添加数字 0-x（x 将是用户在文本框中输入的数字）并将其添加到列表中。所以基本上，它会是这样的

您导入一个列表，其中一行是“dog”，另一行是“cat”，第三行是“fish”。您在文本框中键入“5”。该应用程序将所有这些都放入一个列表中：

```
狗1
狗2
狗3
狗4
狗5
猫1
猫2
三类
第四类
猫5
鱼1
鱼2
鱼3
鱼4
鱼5

```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T14:44:51.740

下面的代码应该适合你。我假设您可以`count`自己获得价值。

```
var animals = File.ReadAllLines("yourFile.txt"); //new[] {"dog", "cat", "fish"};
var count = 5;

var merged =
    from a in animals
    from n in Enumerable.Range(1, count)
    select a + n;

foreach (var m in merged)
    Console.WriteLine(m);  //act on each however you want 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:47:31.097

您可以使用[`File.ReadAllLines`](http://msdn.microsoft.com/en-us/library/s2tte0y1.aspx). 这为您提供了一个可以迭代的数组[`foreach`](http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx)。

在这个`foreach`循环中，您可以执行另一个循环，从 1 到用户输入的数字。[`int.Parse`](http://msdn.microsoft.com/en-us/library/b3h1hf19.aspx)可以方便地将用户输入的字符串转换为 C# 可以使用的数字。对于实际的迭代，您可以使用[`for`循环](http://msdn.microsoft.com/en-us/library/ch45axte.aspx)。

然后，您可以将每个项目添加到列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:45:02.517

这里有一个很好的例子来读取文件流中的每一行：http: [//msdn.microsoft.com/en-us/library/e4y2dch9.aspx](http://msdn.microsoft.com/en-us/library/e4y2dch9.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T14:48:48.787

```
private List<string> GetThings(string fileName, int count)
    {
        string[] lines = File.ReadAllLines(fileName);
        List<string> result = new List<string>();
        foreach (string item in lines)
        {
            for (int i = 1; i <= count; i++)
                result.Add(item + i.ToString());
        }
        return result;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T14:51:51.860

```
 string[] inputList = File.ReadAllLines("yourFile.txt");
        List<String> listOfThings = new List<String>();
        foreach (string i in inputList)
        {
            for (int k = 0; k < 5; k++)
            {
                listOfThings.Add(i + " " + k.ToString());
            }
        } 
```

然后，您可以像这样打印出列表：

```
foreach (string outp in listOfThings)
 {
   Console.WriteLine(outp);
 } 
```

输出：

```
some value 0
some value 1
some value 2
some value 3
some value 4
some other value 0
some other value 1
some other value 2
some other value 3
some other value 4 
```

# ios - 微软翻译 API-iOS

> ID：11103371
> 
> 赞同：1
> 
> 时间：2012-06-19T14:40:21.843
> 
> 标签：ios, oauth-2.0, microsoft-translator

我最近开始使用 Objective C 进行开发，并且正在尝试使用 Microsoft Translator API。到目前为止，如果我使用 appID，它就可以工作，但现在不推荐使用该方法。我正在尝试使用 OAuth 等以正确的方式学习它。

谁能给我一个样本（显然没有我拥有的clientID和client_secretcode）来获取access_token？

编辑：似乎我还不够清楚，所以有完整的故事。

我一直在尝试使用 Microsoft Translator API。在提出问题时，我发现了一个使用 AppID 的旧实现（现已弃用）。MS Translator API 使用 OAuth 进行身份验证，公平地说，当时我不知道如何处理它。现在，我这样做了，我发布了我的代码，以便人们在遇到同样问题时可以得到它。

希望现在更清楚:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T23:15:27.420

这是我可以使用的示例：

```
-(IBAction)getToken:(id)sender {
NSString *clientSecret = (__bridge NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
                                                                                      (CFStringRef)CLIENT_SECRETCODE,
                                                                                      NULL,
                                                                                      (CFStringRef) @"!*'();:@&=+$,/?%#[]",
                                                                                      kCFStringEncodingUTF8);
NSMutableString* authHeader = [NSMutableString stringWithString:@"client_id="];
[authHeader appendString:CLIENT_ID];
[authHeader appendString:@"&client_secret="];
[authHeader appendString:clientSecret];
[authHeader appendString:@"&grant_type=client_credentials&scope=http://api.microsofttranslator.com"];

NSMutableURLRequest *request =[NSMutableURLRequest
                               requestWithURL:[NSURL URLWithString:TOKEN_STRING]
                               cachePolicy:NSURLRequestUseProtocolCachePolicy
                               timeoutInterval:60.0];

[request setHTTPMethod:@"POST"];
[request addValue:@"application/x-www-form-urlencoded"
         forHTTPHeaderField:@"Content-Type"];

const char *bytes = [authHeader UTF8String];
[request setHTTPBody:[NSData dataWithBytes:bytes length:strlen(bytes)]];

NSURLResponse* response; 
NSError* error;

NSData* data = [NSURLConnection sendSynchronousRequest: request returningResponse: &response error: &error];

if (data != nil) {
    NSString* contents = [[NSString alloc] initWithData: data encoding: NSUTF8StringEncoding];
    NSString *formattedContents = [contents stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
} 
```

即使它适用于 Microsoft 翻译，也应该不难将其适用于其他服务。在这里，令牌没有被解析，代码很粗糙，因为我使用的是自动引用计数，所以应该注意，在您的配置之后可能需要自动释放。

# c# - 使用实体框架在具有绑定源控制的主详细信息案例中添加新记录

> ID：11103373
> 
> 赞同：1
> 
> 时间：2012-06-19T14:40:26.103
> 
> 标签：c#, winforms, entity-framework, data-binding, datagridview

有 1 个带有 bindingNavigator 控件的 winForm，2 个绑定到 bindingsource 控件的网格：1 个网格用于类别（主）和 1 个网格用于产品（详细），数据和关系加载良好。

现在，我尝试将新的（主）记录添加到类别：

对于接下来的两种情况，我遇到了问题：

第一种情况：当我单击“+”按钮而不输入任何内容时，未添加“新类别”并且我收到消息：“无法将值 NULL 插入到列‘CategoryName’，表‘Northwind.dbo.Categories’；列没有允许空值。INSERT 失败。\r\n语句已终止。" 尽管用代码填充它。

第二种情况：当我单击“+”按钮并在 CategoryName 单元格中手动输入内容时，单击保存按钮后它会被保留，但我收到消息：“对数据库的更改已得到验证，但更新时发生错误对象上下文。ObjectContext 可能处于不一致状态。内部异常消息：AcceptChanges 无法继续，因为对象的键值与 ObjectStateManager 中的另一个对象冲突。请确保键值是唯一的，然后再调用 AcceptChanges”。

这是我的代码：

```
 NorthwindEntities ctx;
    bool _adding;

    private void Form2_Load(object sender, EventArgs e)
    {
        ctx = new NorthwindEntities();
        categoriesBindingSource.DataSource = ctx.Categories;
    }

    private void categoriesBindingSource_AddingNew(object sender, AddingNewEventArgs e)
    {
        _adding = true;
    }

    private void categoriesBindingSource_CurrentChanged(object sender, EventArgs e)
    {
        if (_adding)
        {

            categoriesBindingSource.EndEdit();
            var newCat = (Categories)categoriesBindingSource.Current;
            if (newCat.Products == null)
            {
                Products Prd = new Products();
                Prd.Discontinued = false;
                Prd.ProductName = "New Product Name";
                ctx.AddToProducts(Prd);
            }
            newCat.CategoryName = " New Category";
            ctx.AddToCategories(newCat);
            _adding = false;
        }
    }

    private void categoriesBindingNavigatorSaveItem_Click(object sender, EventArgs e)
    {
        categoriesBindingSource.EndEdit();
        ctx.SaveChanges();
    } 
```

请帮忙...

# mysql - 如何实现一个高效的数据库驱动的票证/协议控制系统？

> ID：11103374
> 
> 赞同：2
> 
> 时间：2012-06-19T14:40:28.280
> 
> 标签：mysql, database, wampserver

*场景：WAMP 服务器、InnoDB 表、自增唯一 ID 字段 [ `INT(10)`]、100+ 并发 SQL 请求。如果需要，也应该使用 VB.Net。*

我的数据库有一个**自动增量**字段，用于为每个存储的新信息（服务订单）生成**唯一的票证/协议号。**

问题是这个数字**必须**每年重新设置。即它从`000001/12` 01/01/2012 00:00:00 开始直到最大值`999999/12`，然后在 01/01/2013 00:00:00 它必须重新开始`000001/13`。

显然，它应该使用某种算法轻松完成，但是，我正在尝试找到一种**更有效的方法**来做到这一点。考虑：

1.  它必须（？）使用自动增量，因为数据库有一些并发性（+100）。

2.  每张票必须是**唯一的**。所以`000001`2012 年不等于`000001`2013 年。

3.  它必须是自动的。（无需人工干预即可进行重置，或其他）

4.  它应该是相当有效的。（监视程序应该每天检查数据库（？），但它似乎不是最好的解决方案，因为它会“*失败*”364 次，只有一次成功）。

我能想到的“最佳”方法是使用年份存储票号，例如：

`12000001`- `12999999`（无论如何，它永远不应该达到 999.999）

然后监视程序应将自动增量字段设置`13000000`为 2013 年 1 月 1 日。

有什么建议么？

PS：感谢阅读... ;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:35:33.260

因此，为了进一步参考，我采用了以下解决方案：

我确实在数据库上创建了*n 个*表（每年一个），只有一个自动增量字段负责生成每年的唯一 ID。

**因此，考虑到事件**日期，将新插入到相应的表中。之后，该算法将 last_inseted_id() 使用格式 000001/12 将该值存储到主表中。（票/年）

那是因为每年都必须有自己的计数器，因为即使当前日期已经是 2013 年，也会插入 2012 年的事件。

这样事件应该是可追溯的，不需要重置，并且很容易实现。

插入示例代码：

```
$eventdate="2012-11-30";
$eventyear="2012";
$sql = "INSERT INTO tbl$eventyear VALUES (NULL)";
mysql_query ($sql);
$sql = "LAST_INSERT_ID()";
$row = mysql_fetch_assoc(mysql_query($sql));
$eventID = $row(0)
$sql = "INSERT INTO tblMain VALUES ('$eventID/$eventYear', ... ";
mysql_query($sql) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:53:32.013

[MongoDB 使用与此非常相似的东西来](http://www.mongodb.org/display/DOCS/Object+IDs)编码日期、进程 id 和生成 id 的主机以及一些随机熵来创建 UUID。不是满足您对单调增加的要求的东西，而是一些有趣的东西来寻找一些关于方法的想法。

如果我正在实现它，我将创建一个简单的 ID 代理服务器，它将按日期执行逻辑处理，并为您描述的 id 创建一个唯一的 slug。只要你知道它是如何构造的，你就有原生的 MySql 等价物来让你的排序/分组工作，并且表示可以优雅地序列化这将工作。带有 UTC 日期字符串的东西，然后是作为字符串附加的单调序列。

Twitter 在实现自定义 ID 服务器[Snowflake时，对](https://github.com/twitter/snowflake)[自定义索引设计](http://engineering.twitter.com/2010/06/announcing-snowflake.html)有一些有趣的见解。

生成不仅是简单整数而且还包含一些业务逻辑的 UUID 的代理端点的想法变得越来越普遍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T16:07:42.523

You can set up a combined `PRIMARY KEY` for both of the two columns `ID` and `YEAR`; this way you would only have one `ID` per year.

MySQL:

```
CREATE TABLE IF NOT EXISTS `ticket` (
    `id` INT(11) NOT NULL AUTO_INCREMENT,
    `year` YEAR NOT NULL DEFAULT '2012',
    `data` TEXT NOT NULL DEFAULT '',
    PRIMARY KEY (`id`, `year`)
)
ENGINE = InnoDB DEFAULT CHARACTER SET = utf8 COLLATE = utf8_unicode_ci 
```

**UPDATE:** (to the comment from @Paulo Bueno) How to reset the auto-increment-value could be found in the [MySQL documentation](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html): `mysql> ALTER TABLE ticket AUTO_INCREMENT = 1;`. If you also increase the default value of the year-column when resetting the auto-increment-value, you 'll have a continuous two-column primary key. But I think you still need some sort of trigger-program to execute the reset. Maybe a yearly cron-job, which is launching a batch-script to do so on each first of January.

**UPDATE 2:** ~~OK, I've tested that right now and one can not set the auto-increment-value to a number lower than any existing ID in that specific column. My mistake – I thought it would work on combined primary keys…</del>~~

```
INSERT INTO `ticket` (`id`, `year`, `data`) VALUES
    (NULL , '2012', 'dtg htg het'),
    -- some more rows in 2012
);

-- this works of course
ALTER TABLE `ticket` CHANGE `year` `year` YEAR( 4 ) NOT NULL DEFAULT '2013';

-- this does not reset the auto-increment
ALTER TABLE `ticket` AUTO_INCREMENT = 1;

INSERT INTO `ticket` (`id`, `year`, `data`) VALUES
    (NULL , '2013', 'sadfadf asdf a'),
    -- some more rows in 2013
);
-- this will result in continously counted ID's 
```

**UPDATE 3:** The MySQL-documentation page has a working example, which uses grouped primary keys on MyISAM table. They are using a table similar to the one above, but with reversed column-order, because one must not have auto-increment as first column. It seems this works only using MyISAM instead of InnoDB. If MyISAM still fits your needs, you don't need to reset the ID, but merely increase the year and still have a result as the one you've questioned for.

See: [http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html) (second example, after "For MyISAM and BDB tables you can specify AUTO_INCREMENT on a secondary column in a multiple-column index.")

# streaming - Safari Mobile 上的 Soundcloud 流媒体

> ID：11103383
> 
> 赞同：1
> 
> 时间：2012-06-19T14:40:54.090
> 
> 标签：streaming, soundcloud

我尝试使用 Soundcloud API 中的这个片段：

```
<script src="http://connect.soundcloud.com/sdk.js">
<script>
SC.initialize({
client_id: 'YOUR_CLIENT_ID'
});

# stream track id 293
SC.stream("/tracks/293", function(sound){
 sound.play();
});
</script> 
```

它适用于除 Safari 移动设备之外的任何浏览器，包括 iPhone 和 iPad，在这些浏览器中根本不播放音乐流。

我究竟做错了什么？（我用自己的详细信息替换了跟踪 ID 和客户 ID）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-25T13:25:11.567

这是解决此问题的方法。您需要添加额外的 html 元素。

```
<div class="player-helper"></div> 
```

JavaScript

```
SC.stream('/tracks/' + id, {
  useHTML5Audio: true,
  debugMode: true
}, function(sound) {
  let $eventEmitter = $('.player-helper');

  $eventEmitter.on('click', function () {
    sound.play();
  });
  $eventEmitter.trigger('click');
  $eventEmitter.off('click');
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-21T00:00:49.480

在移动 Safari 中，播放具有必须由用户操作触发音频播放的限制。因此，您必须添加某种按钮或链接，单击它们会调用 sound.play() 函数。

# c++ - 从 std::function 调用签名推断模板参数

> ID：11103384
> 
> 赞同：13
> 
> 时间：2012-06-19T14:40:56.017
> 
> 标签：c++, templates, std-function, template-argument-deduction

考虑这个模板函数：

```
template<typename ReturnT>
ReturnT foo(const std::function<ReturnT ()>& fun)
{
    return fun();
} 
```

为什么编译器不能`ReturnT`从传递的调用签名中推断出来？

```
bool bar() { /* ... */ }

foo<bool>(bar); // works
foo(bar); // error: no matching function call 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-19T15:03:34.480

类型的函数指针`bool (*)()`可以转换为`std::function<bool()>`但不是同一类型，所以需要转换。在编译器可以检查该转换是否可能之前，它需要推断`ReturnT`为`bool`，但要做到这一点，它需要已经知道这`std::function<bool()>`是一个可能的转换，在它推断之前这是不可能的`ReturnT`......看到问题了吗？

另外，考虑一下`bool(*)()`也可以转换为`std::function<void()>`or `std::function<int()>`... 应该推导出来？

考虑这种简化：

```
template<typename T>
  struct function
  {
    template<typename U>
      function(U) { }
  };

template<typename T>
  void foo(function<T>)
  { }

int main()
{
    foo(1);
} 
```

编译器如何知道您是否要创建`function<int>`或何时可以全部从 构造？`function<char>``function<void>``int`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-19T15:02:29.263

```
std::function<bool()> bar;

foo(bar); // works just fine 
```

C++ 不能从你的函数中推断出返回类型，`bar`因为它必须知道类型才能找到所有接受你的函数指针的构造函数。

例如，谁能说`std::function<std::string()>`没有构造函数采用`bool (*)()`？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T14:44:03.530

该函数`bar`是类型`bool (*)()`左右的，即：一个普通的 pre-C++11 函数类型。我对 C++11 没有那么自信，但我猜编译器看不到 and 之间的联系`bool (*)()`，`const std::function<ReturnT()>&`即使第一个可以隐式转换为第二个 for `ReturnT = bool`。

# css - 如何仅使用 css 更改 JStree 节点的图标？

> ID：11103388
> 
> 赞同：5
> 
> 时间：2012-06-19T14:41:16.867
> 
> 标签：css, icons, jstree

我正在尝试找出如何仅使用 css 更改 JStree 节点的图标？有很多帖子解释如何使用 javascript 进行操作，但我更喜欢仅使用 css。

到目前为止，这是我的代码：

```
$("#treeview").jstree().on('loaded.jstree', function()
{
    $("#treeview").jstree('open_all');
}); 
```

和HTML：

```
<div id="treeview">
  <ul>
    <li>
      <a href="#">abcdefghijkl</a>
      <ul>
        <li>
          <a href="#" onclick="goTo('index.php?module=klimaat&amp;pagina=dashboard&amp;id=6',false);">
          Beneden</a>
        </li>
        <li>
          <a href="#" onclick="goTo('index.php?module=klimaat&amp;pagina=dashboard&amp;id=7',false);">
          Boven</a>
        </li>
      </ul>
    </li>
  </ul>
</div> 
```

对于 CSS，我使用的是 jstree 提供的默认样式表。jstree提供的文档真的很烂。所以stackoverflow是一个很大的帮助，但我在网站上找不到这个。

如果您需要更多代码或信息，请询问。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T19:56:05.847

您只需将其包含在 CSS 中：

```
a .jstree-icon
{
    background-image: url("yourimage.png")!important;
    background-position: 0!important;
} 
```

​</p>

这是一个正常工作[的小提琴（2016年更新）：](https://jsfiddle.net/arWQR/62/)

# objective-c - 如何在导航栏下的iOS中绘制方形按钮

> ID：11103390
> 
> 赞同：3
> 
> 时间：2012-06-19T14:41:21.267
> 
> 标签：objective-c, ios, xcode

我有这个代码，我想让我的按钮**变成一个正方形，**也在**导航栏下**，你能帮帮我吗

提前致谢！

**我想让我的按钮变成一个正方形**

```
- (void)viewDidLoad
{
[super viewDidLoad];

int rows = 13, columns = 4;
UIView *buttonView = [[UIView alloc] initWithFrame:CGRectMake(0.f, 0.f, 70*columns, 70*rows)];
for (int y = 0; y < rows; y++) {
    for (int x = 0; x < columns; x++) {
        UIButton * button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
        button.frame = CGRectMake(70 * x, 28 * y, 70, 28);

        [button addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside];
        [buttonView addSubview: button];

    }
 }

// Center the view which contains your buttons
CGPoint centerPoint = buttonView.center;
centerPoint.x = self.view.center.x;
buttonView.center = centerPoint;
[self.view addSubview:buttonView];    

}

-(void)buttonPressed:(UIButton *)button
{
NSLog(@"button %u -- frame: %@", button.tag, NSStringFromCGRect(button.frame));
} 
```

**编辑 2**

我使用边框时的错误

```
 [button.layer setBorderWidth:1.0]; 
    [button.layer setBorderColor:[UIColor blackColor]]; 
```

![在此处输入图像描述](../Images/82c636a60f409fd2c569847d41da2268.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T05:22:11.213

定义一个整数变量并将其设置为按钮标题

```
int rows = 13, columns = 4;
int number=1;
UIView *buttonView = [[UIView alloc] initWithFrame:CGRectMake(0.f,44, 70*columns, 70*rows)];
for (int y = 0; y < rows; y++) {
    for (int x = 0; x < columns; x++) {
        UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(75 * x, 75 * y, 70, 70);
        button.backgroundColor=[UIColor redColor];
        [button setTitle:[NSString stringWithFormat:@"%d",number] forState:UIControlStateNormal];

        button.tag=number;
        [button addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside];
        [buttonView addSubview: button];
        number++;
    }
} 
```

希望这将帮助您移动到下一个屏幕。Button.tag 给出了您选择的确切按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:28:43.630

尝试这个

```
int rows = 13, columns = 4;  
UIView *buttonView = [[UIView alloc] initWithFrame:CGRectMake(0.f,44, 70*columns, 70*rows)];
for (int y = 0; y < rows; y++) {
    for (int x = 0; x < columns; x++) {
        UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(75 * x, 75 * y, 70, 70);
        button.backgroundColor=[UIColor redColor];
        [button addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside];
        [buttonView addSubview: button];

    }
}

// Center the view which contains your buttons
CGPoint centerPoint = buttonView.center;
centerPoint.x = self.view.center.x;
buttonView.center = centerPoint;
[self.view addSubview:buttonView]; 
```

要使用图层属性，您需要在项目中添加 QuartzCore.framework。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:46:04.340

您正在设置大小为 70x28 的按钮，因此如果您想要一个 70x70 的按钮，则必须更改 button.frame = CGRectMake(70*x, 70*y, 70, 70)，这样您将拥有方形按钮。

另外，你确定这是一个导航栏还是一个工具栏？如果您使用使用导航栏的 NavigationController，Apple 自己的 SDK 将不允许您轻松绘制它。

无论如何，在您的情况下，只需从 y = 44 开始绘制按钮，您就不会让按钮与工具栏重叠。

# mysql - 如何强制执行自定义 MySQL 列格式

> ID：11103391
> 
> 赞同：2
> 
> 时间：2012-06-19T14:41:23.060
> 
> 标签：mysql, regex

如果我想在 MySQL 中定义自定义列格式怎么办？我想要的自定义格式始终是 2 位整数，后跟 # 符号，然后是空格，然后是小数点后 2 位的十进制数。允许值的示例如下：

```
30# 11.00
27# 17.25
40# 17.25 
```

**不允许**的值是这样的：

```
30# 11
40# 20.5
some string 
```

这在 MySQL 中可能吗？如果是这样，关于如何做的任何提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:47:35.663

好吧，因为“所有存储引擎都解析了 CHECK 子句但忽略了它。” 在 mysql 中，您唯一剩下的选择是在您的表上添加一个插入/更新前触发器来正则[表达式](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)您的输入并继续。

# asp.net - 日历扩展器不工作

> ID：11103394
> 
> 赞同：0
> 
> 时间：2012-06-19T14:41:33.170
> 
> 标签：asp.net

我需要在单击添加新链接时将编辑面板显示为数据网格的第二行。为此，我采用了一个设置了 display:none 的 div。单击添加新链接后，我可以显示为第二行。现在实际问题开始了。

此 div 有一个文本框，该文本框与日历扩展器相关联，在文本框单击时充当 claendar。但是当不可见 div 的 html 作为网格的第二行插入时，日历没有显示。请让我知道是否有人需要代码以更好地理解问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T11:39:45.427

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %> 

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="AjaxControlToolkit" %> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head runat="server"> 
    <title></title> 
    <script src="jquery-1.4.1.js" type="text/javascript"></script> 
    <script type="text/javascript"> 
        function AddCalendars() 
        { 

            //The last parameter should be the TargetControl's id. If you use "TextBox1", the TextBox1 would be associated. 
            var elem = $(".deneme"); 

            for (var a = 0; a < elem.length; a++) 
             { 
                 if ($find("CalendarExtender"  + elem[a].id)) 
                 { 
                   $find("CalendarExtender" + elem[a].id).dispose(); 
                 } 
            } 
            for (var i = 0; i < elem.length; i++) 
            { 
                $create(AjaxControlToolkit.CalendarBehavior, { "id": "CalendarExtender" + elem[i].id  }, null, null, elem[i]); 
            } 

        } 
    </script> 

</head> 
<body> 
    <form id="form1" runat="server"> 
    <div> 
        <asp:ScriptManager ID="ScriptManager1" runat="server" /> 
        <%--the dummy calendar which is used to download the related script file.--%> 
        <asp:TextBox ID="dummyTextBox" runat="server" Style="display: none"></asp:TextBox> 
        <AjaxControlToolkit:CalendarExtender ID="dummyCalendarExtender" runat="server" Enabled="True" 
            TargetControlID="dummyTextBox"> 
        </AjaxControlToolkit:CalendarExtender> 
        <%--the dummy calendar which is used to download the related script file.--%> 
        <asp:Button ID="Button1" OnClientClick="AddCalendars();return false" runat="server" 
            Text="CreateCalendarFromClient" /><br /> 
        input:<input id="deneme1" type="text" class="deneme" /><br /> 
        <br /> 
        <br /> 
        <br /> 
        <br /> 
        <br /> 
        <br /> 
        <br /> 
        TextBox: 
        <asp:TextBox ID="deneme2" runat="server" cssclass="deneme" ClientIDMode="Static"></asp:TextBox> 
    </div> 
    </form> 
</body> 
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:00:44.813

在您的 gridview 中放置一个模板字段而不是 div。使该模板化字段包含一个文本框和日历扩展器。

```
<asp:GridView ID="GridView1" runat="server">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:TextBox ID="textbox1" runat="server"></asp:TextBox>
                <asp:CalendarExtender ID="CalendarExtender1" TargetControlID="textbox1" runat="server">
                </asp:CalendarExtender>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

但是如果你在插入时想要它，你应该放

```
<asp:GridView ID="GridView1" runat="server">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:TextBox ID="textbox1" runat="server"></asp:TextBox>
                <asp:CalendarExtender ID="CalendarExtender1" TargetControlID="textbox1" runat="server">
                </asp:CalendarExtender>
            </ItemTemplate>
            <InsertItemTemplate>
                <asp:TextBox ID="textbox1" runat="server"></asp:TextBox>
                <asp:CalendarExtender ID="CalendarExtender1" TargetControlID="textbox1" runat="server">
                </asp:CalendarExtender>
            </InsertItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

我希望这有帮助。

# bash - 如何让 HBase 等待启动，直到 HDFS 准备好？

> ID：11103396
> 
> 赞同：1
> 
> 时间：2012-06-19T14:41:37.343
> 
> 标签：bash, hadoop, hbase, hdfs

我正在为 Hadoop 构建一个自动安装脚本，并且遇到了 HBase 无法启动的问题，因为 HDFS 尚未完全启动并准备好。我如何以编程方式（理想情况下来自 Bash）判断 HDFS 系统是否已准备好让 HBase 启动，以便我可以等到它准备好？

我尝试使用“hadoop dfsadmin -report”并寻找正确数量的节点，但显然在集群实际准备好之前仍然会返回。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T14:57:57.627

用于`hadoop dfsadmin -safemode wait`检查 HDFS 是否已退出安全模式。这样的事情应该可以解决问题：

```
while $HADOOP_HOME/bin/hadoop dfsadmin -safemode wait | grep ON
do
    sleep 1s # Or 10s or 1m or whatever time
done 
```

**编辑**：正如评论中提到的，根据[HADOOP-756](https://issues.apache.org/jira/browse/HADOOP-756)，`-safemode wait`它本身会等到安全模式关闭。在这种情况下，您可以简单地发出等待，而 while 循环将是不必要的。但是，如果您只想继续尝试一段时间并在 DFS 仍未启动或其他情况下终止进程，那么`while`循环可能仍然有用。当我们在设置集群时出错时，我已经看到了这种情况。

# java - 检测启动器是否在前台

> ID：11103404
> 
> 赞同：1
> 
> 时间：2012-06-19T14:42:00.737
> 
> 标签：java, android

我正在使用以下代码来了解当前在前台的进程：

```
ActivityManager activityManager = (ActivityManager) newContext.getSystemService( Context.ACTIVITY_SERVICE );
List<RunningAppProcessInfo> appProcesses = activityManager.getRunningAppProcesses();
for(RunningAppProcessInfo appProcess : appProcesses){
    if(appProcess.importance == RunningAppProcessInfo.IMPORTANCE_FOREGROUND){
        Log.i("Foreground App", appProcess.processName);
          [...]
    }
} 
```

但它只有在我使用 4.0.4 发射器（如 stock one、apex、nova 发射器）时才有效。如果我切换到 GoLauncher 或 Launcher Pro，它们不会被记录。看起来它们永远不会进入前台（或者这部分代码无法检测到它们）。

# gwt - 将鼠标悬停在列表项上时，GWT ListBox getSelectedIndex() 无法按预期工作

> ID：11103405
> 
> 赞同：1
> 
> 时间：2012-06-19T14:42:02.927
> 
> 标签：gwt, listbox

我有一个 GWT 列表框。我的验证代码查询 ListBox 的选定索引是否为 -1（我的 ListBox 的默认状态）。如果我不触摸 ListBox，getSelectedIndex() 会按预期返回 -1。**如果我将鼠标悬停在 ListBox 项目上但不单击一个（即单击外部），则 getSelectedIndex() 返回非 (-1) index**。我希望它返回 -1 ，除非我单击 ListBox 项并且 ListBox 会自行更新以反映该选择。

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:11:53.197

您将无法以`<select>`一种很好的方式使用本机元素，因为浏览器确定所选元素是什么，而不是 GWT。换句话说，这就是`<select>`工作原理。

您必须创建自己的选择小部件（出于样式原因，这可能是首选小部件）或发挥创意并在现有小部件旁边拼凑一些东西。您可以将单击处理程序添加到 ListBox 并“手动”将所选索引设置为 -1，但您必须确定用户是否取消他的操作并在之后恢复选择。您必须从自定义代码中抑制选择事件，因为您可能不希望应用程序的其余部分对您的新 -1 hack 做出反应。啊! 可能最容易以不同的方式处理这个问题。

# python - Python/Tkinter：用大画布破坏窗口会导致程序停止响应

> ID：11103407
> 
> 赞同：0
> 
> 时间：2012-06-19T14:42:08.723
> 
> 标签：python, tkinter

我正在使用 Tkinter 维护一个用 Python 编写的图形解析应用程序。它可以选择在可滚动的电子表格中显示其结果，这是我使用 Canvas 小部件创建的。但是，它似乎存在一些可扩展性问题。当主画布太大时，试图破坏显示结果的窗口会导致程序停止响应，需要被杀死。当显示的数据较少时，我可以正常销毁它。这是 Tkinter/大型 Canvi 的已知问题吗？我能做些什么来防止这些冻结吗？

```
#Function being called to destroy window
def justexit():
    savepopup.destroy() #Destroy the popup asking to save (that called this function)
    deleteall() #Destroy canvi and their contents
    popup.destroy() #Destroy the window containing all the canvi

def deleteall():
    for i, itemset in enumerate(items): #Items stores lists containing every item added to the canvi
        for item in itemset:
            canvi[i].delete(item)
        canvi[i].destroy() 
```

我的估计有点偏离。确实有多达数万个项目在发挥作用，但我不认为减速会如此明显。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T21:54:57.267

是的，画布小部件存在可伸缩性问题。通常，直到您的画布上有数以万计的项目时，这才会生效。你有多少物品？

我隐约记得听说如果您在删除画布之前删除项目，它可能会更快。不过，我不知道这是事实。

尝试运行以下代码。它创建 5000 个随机矩形。当您单击删除按钮时，它将删除画布小部件，在我的机器上这是即时的。

```
import Tkinter as tk
import random

class SampleApp(tk.Tk):
    def __init__(self, *args, **kwargs):
        tk.Tk.__init__(self, *args, **kwargs)
        self.wm_geometry("400x400")
        self.del_button = tk.Button(text="delete", command=self.delete)
        self.del_button.pack()
        self.create_button = tk.Button(text="create", command=self.create)
        self.create_button.pack()
        self.canvas = None
        self.create()

    def create(self):
        if self.canvas is not None:
            self.canvas.destroy()
        self.canvas = tk.Canvas(self)
        self.canvas.pack(side="top", fill="both", expand=True)
        colors = ["red","orange","green","blue", "violet","bisque","white"]
        for i in range(5000):
            x0 = random.random()*400
            y0 = random.random()*400
            width = random.randint(10,100)
            height = random.randint(10,100)
            x1 = x0 + width
            y1 = y0 + height
            color = colors.pop(0)
            colors.append(color)
            self.canvas.create_rectangle(x0,y0,x1,y1, outline="black", fill=color)

    def delete(self):
        self.canvas.destroy()
        self.canvas = None

app = SampleApp()
app.mainloop() 
```

# c# - 运算符 && 不能应用

> ID：11103412
> 
> 赞同：5
> 
> 时间：2012-06-19T14:42:22.843
> 
> 标签：c#, .net

我正在测试一个示例片段，我发现它是[另一个问题的答案](https://stackoverflow.com/questions/3920551/permission-deny-mask-in-sharepoint/4320497#4320497)

但是编译器吐出这个“运算符 && 不能应用于 long 和 bool 类型的操作数”。为什么这样做？当我阅读代码时，它说“如果掩码和权限大于 0，则返回成功布尔值”

我读错了吗？

（此外，没有人把它称为一个坏例子，所以我希望它能够工作。并不是说我是一个复制粘贴编码器）

```
bool CheckMask( long Mask, long TestPermission ) {
    return Mask && TestPermission > 0;
}

long mask = 4611686844973976575;

const long MASK_ViewListItems = 0x0000000000000001;
bool HasPermission_ViewListItems = CheckMask(mask, MASK_ViewListItems);
// HasPermission_ViewListItems is true

const long MASK_UseClientIntegration = 0x0000001000000000;
bool HasPermission_UseClientIntegration = CheckMask(mask, MASK_UseClientIntegration);
// HasPermission_UseClientIntegration is false 
```

StackOverflow 上有很多类似的问题，我已经点击了其中的大部分，在我输入的时候右边有一个很大的列表。没有一个适用于我的情况，至少我能够看到答案和我的问题之间的关系。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-19T14:44:04.403

您使用的是[`&&`（条件与，仅对`bool`操作数有效）](http://msdn.microsoft.com/en-us/library/2a723cdk.aspx)而不是[`&`（按位与，对`bool`操作数或整数操作数有效）](http://msdn.microsoft.com/en-us/library/sbf85k1c.aspx) -我怀疑您想要后者，并且由于优先规则，您还应该使用括号。我也会更改参数名称以遵循 .NET 命名约定 - 并将其设为静态，因为它不依赖任何状态：

```
static bool CheckMask(long mask, long testPermission)
{
    return (mask & testPermission) > 0;
} 
```

您可能还想更改为使用枚举而不是`long`：

```
[Flags]
public enum Permissions
{
    ViewListItems = 1 << 0,
    ...
    UseClientIntegration = 1 << 9
}

static bool CheckMask(Permissions mask, Permissions testPermission)
{
    return (mask & testPermission) != 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T14:47:39.863

我猜这就是你想要的：

```
(Mask & TestPermission) != 0 
```

所以，你需要：

*   按位`&`（而不是`&&`仅适用于布尔）
*   我猜你想检查是否设置了任何位，包括符号位（`!=`而不是`>`）。

# assembly - 有什么方法可以找到无证处理器的指令集？

> ID：11103422
> 
> 赞同：3
> 
> 时间：2012-06-19T14:42:54.450
> 
> 标签：assembly, reverse-engineering, cpu-architecture, instruction-set

有些处理器没有商业发布的文档来解释其指令集是什么。如果您可以访问处理器，有没有办法通过篡改或外部设备找到指令集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:12:24.467

一般来说，不，仅仅看比特不会让你走得太远。想象一下其中一个混乱的谜题，但你有超过 26 个字符（字母表）。您可以对位模式进行一些分析，但这会给您带来什么，不知道可能是无条件分支或其他一些流行指令的体系结构，而不知道您不知道流行指令是什么。例如，对于假设英语的混乱拼图，您了解哪些字母和单词是常见的，可以尝试从那里开始，您在指令宽度方面没有内部知识等。

如果它碰巧类似于一个已知的指令集，你仍然有同样的问题，修改指令，如果已经取消定义并使其成为新指令，你可能无法在没有芯片可见性的情况下判断它们是什么（哪个 jtag在这个级别上不会真正给你，因为 jtag 提供的信息也需要内部信息）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T16:54:16.730

“通过篡改”？当然。撬开芯片的盖子。拍摄芯片布局的快照（您可以使用各种扫描电子显微镜进行此操作）。推断数字电路（一些特殊设备会告诉您芯片元件在运行时的*状态*；斯伦贝谢的 ATE 设备就是这样做的）。解码它的作用。拥有源代码会有所帮助。

您可能很难猜测操作码的*作用*；想象一个指令，它执行用于计算超越数的部分多项式求值，或者更糟糕的是，它在快速傅立叶变换中执行蝴蝶步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:51:36.477

您可以检查[JTAG](http://en.wikipedia.org/wiki/Jtag)。它是一种用于调试 CPU 的协议。

另一种选择是检查架构是否基于另一个公共架构并尝试比较以发现差异。

**编辑**：此外，该架构没有调试器吗？交流编译器？这是非常罕见的。如果您有调试器和/或 C 编译器，您可以检查汇编并与生成的二进制文件进行比较。调试器还应该允许您反汇编已经存在的二进制文件。

# jquery - 持久的jquery移动导航栏

> ID：11103426
> 
> 赞同：0
> 
> 时间：2012-06-19T14:43:11.273
> 
> 标签：jquery, mobile, cordova, persistence, navbar

我正在尝试使持久的 Jquery Mobile 导航栏页脚工作。我希望它使用 javascript 动态绘制（它用于 PhoneGap 应用程序），而不是使用 PHP 来模板页脚。

以下改编自： [http ://the-jquerymobile-tutorial.org/jquery-mobile-tutorial-CH21.php](http://the-jquerymobile-tutorial.org/jquery-mobile-tutorial-CH21.php)

但是，jquery 样式并未应用于第 2 页和第 3 页。就好像 $("#navbar").navbar() 没有为这些页面调用或调用太早。

谁能帮我解决我可能出错的地方？或者指向一个具有动态持久导航栏的代码示例，最好具有活动按钮持久性？

```
<!DOCTYPE html> 
<html> 
<head> 
  <meta name=viewport content="user-scalable=no,width=device-width" />
  <link rel=stylesheet href=jquery.mobile.css />
  <script src=lib/jquery.js></script>
  <script src=lib/jquery.mobile.js></script>
</head> 

<body> 

<div data-role=page id=page1>
  <div data-role=header>
    <h1>1</h1>
  </div>

  <div data-role=content>
   <p> Window content </p>
  </div>
</div>

<div data-role=page id=page2>
  <div data-role=header>
    <h1>2</h1>
  </div>

  <div data-role=content>
   <p> Window content </p>
  </div>
</div>

<div data-role=page id=page3>
  <div data-role=header>
    <h1>3</h1>
  </div>

  <div data-role=content>
   <p> Window content </p>
  </div>
</div>

</body>
</html>

<script>

var html = "";
html += "<div data-role=footer data-position=fixed>";
html +=   "<h1> Footer part </h1>";

html +=   "<div id=navbar>";
html +=     "<ul>";
html +=       "<li><a href=#page1 data-icon=refresh>Refresh</a></li>";
html +=       "<li><a href=#page2 data-icon=info>Help</a></li>";
html +=       "<li><a href=#page3 data-icon=delete>Close</a></li>";
html +=     "</ul>";
html +=   "</div>";
html += "</div>";

$("#page1").append (html);
$("#page2").append (html);
$("#page3").append (html);
$("#navbar").navbar();

</script>

<script>

$("li").bind ("click", function (event)
{

  alert ($(this).find ("a").text ());

});

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T06:43:15.263

在您的代码中，`navbar()`对我来说看起来很奇怪。因为我在 jquery mobile 官方文档中从未见过这些方法。还有一件事，你从来没有提到`data-role="navbar"`listview div 元素。

`.append()`您可以使用正常的 jquery方法动态附加 jquery navbar 。

我会给你jquery中动态导航栏的示例代码。它会解决你的问题。

```
$navbar="";
$navbar+="<div data-role='navbar'>";
$navbar+="<ul><li><a href='a.html' class='ui-btn-active ui-state-persist'>One</a></li>";
/*This class="ui-btn-active ui-state-persist" is to highlight the first tab*/
$navbar+="<ul><li><a href='b.html'>Two</a></li>";
$navbar+="<li><a href='c.html'>Three</a></li></ul></div>";
$("#page1").append ($navbar); /*First append to page 1 of the footer*/
$("#page1").trigger("pagecreate"); /*To refresh the page and load the dynamic append navbar*/ 
```

在 page2 和 page3 的按钮单击中执行相同的过程更改相应的`class='ui-btn-active ui-state-persist'`页面。

# java - 所有单独的面板都没有显示在根面板内

> ID：11103427
> 
> 赞同：3
> 
> 时间：2012-06-19T14:43:11.663
> 
> 标签：java, swing, jpanel, layout-manager, flowlayout

我想在 jpanel 中添加多个 jpanel。所以我在 jpanel 中添加了一个根面板。然后将所有单独的 jpanel 添加到这个根面板中。我根据需要制定了 jscrollpane 的滚动策略。即 HORIZONTAL_SCROLLBAR_​​AS_NEEDED、VERTICAL_SCROLLBAR_​​AS_NEEDED。但问题是所有单独的面板都没有显示在根面板内。

代码：

```
JScrollPane scPanel=new JScrollPane();

JPanel rootPanel=new JPanel();
rootPanel.setLayout(new FlowLayout());

JPanel indPanel = new JPanel();
rootPanel.add(indPanel);

JPanel indPanel2 = new JPanel();
rootPanel.add(indPanel2);

//.....like this added indPanals to rootPanel.
scPanel.setViewPortView(rootPanel);
//scPanel.setHorizontalScrollPolicy(HORIZONTAL_SCROLLBAR_AS_NEEDED); 
```

还有一件事是，当我滚动滚动条时，面板将超出 jscrollpane 区域。我无法看到所有单独的面板，请建议我。

编辑：来自双重帖子的代码片段：

```
MosaicFilesStatusBean mosaicFilesStatusBean = new MosaicFilesStatusBean();
DefaultTableModel tableModel = null;
tableModel = mosaicFilesStatusBean.getFilesStatusBetweenDates(startDate, endDate);
if (tableModel != null) {
    rootPanel.removeAll();        
    rootPanel.setLayout(new BoxLayout(rootPanel, BoxLayout.PAGE_AXIS));      
    for (int tempRow = 0; tempRow < tableModel.getRowCount(); tempRow++) {

        int fileIdTemp = Integer.parseInt(tableModel.getValueAt(tempRow, 0).toString());
        String dateFromTemp = tableModel.getValueAt(tempRow, 3).toString();
        String dateToTemp = tableModel.getValueAt(tempRow, 4).toString();
        int processIdTemp = Integer.parseInt(tableModel.getValueAt(tempRow, 5).toString());
        int statusIdTemp = Integer.parseInt(tableModel.getValueAt(tempRow, 6).toString());
        String operatingDateTemp = tableModel.getValueAt(tempRow, 7).toString();                
        MosaicPanel tempPanel =           
           new MosaicPanel(fileIdTemp, dateFromTemp, dateToTemp, processIdTemp, statusIdTemp, operatingDateTemp);             
        rootPanel.add(tempPanel);             
    }
    rootPanel.revalidate();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:44:57.897

不要将 FlowLayout 用于 rootPanel。而是考虑使用[BoxLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html)：

```
JPanel rootPanel=new JPanel();
// if you want to stack JPanels vertically:
rootPanel.setLayout(new BoxLayout(rootPanel, BoxLayout.PAGE_AXIS)); 
```

**编辑 1**
这是一个松散地基于您发布的最新代码的[SSCCE ：](http://sscce.org)

```
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.util.Random;

import javax.swing.*;

@SuppressWarnings("serial")
public class PanelsEg extends JPanel {
   private static final int MAX_ROW_COUNT = 100;
   private Random random = new Random();
   private JPanel rootPanel = new JPanel();

   public PanelsEg() {
      rootPanel.setLayout(new BoxLayout(rootPanel, BoxLayout.PAGE_AXIS));
      JScrollPane scrollPane = new JScrollPane(rootPanel);
      scrollPane.setPreferredSize(new Dimension(400, 400)); // sorry kleopatra

      add(scrollPane);

      add(new JButton(new AbstractAction("Foo") {

         @Override
         public void actionPerformed(ActionEvent arg0) {
            foo();
         }
      }));
   }

   public void foo() {
          rootPanel.removeAll();        
          // rootPanel.setLayout(new BoxLayout(rootPanel, BoxLayout.PAGE_AXIS)); // only need to set layout once 
          int rowCount = random.nextInt(MAX_ROW_COUNT);
         for (int tempRow = 0; tempRow < rowCount ; tempRow++) {

              int fileIdTemp = tempRow;
              String data = "Data " + (tempRow + 1);
              MosaicPanel tempPanel =           
                 new MosaicPanel(fileIdTemp, data);             
              rootPanel.add(tempPanel);             
          }
          rootPanel.revalidate();
          rootPanel.repaint(); // don't forget to repaint if removing
   }

   private class MosaicPanel extends JPanel {

      public MosaicPanel(int fileIdTemp, String data) {
         add(new JLabel(data));
      }

   }

   private static void createAndShowGui() {
      PanelsEg mainPanel = new PanelsEg();

      JFrame frame = new JFrame("PanelsEg");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }  
} 
```

这个 SSCCE 工作，因为它很容易显示删除和添加 JPanel 到另一个 JScrollPane 持有的 JPanel。如果您仍然有问题，您应该修改此 SSCCE 以便它显示您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T15:12:57.267

你看不到你的主要原因`JPanel`是你使用`FlowLayout`的`LayoutManager`是`rootPanel`. 并且由于您`JPanel`添加到`rootPanel`其中的内容没有任何内容，因此它的大小`0, 0`分别为 , 宽度和高度。虽然`GridLayout`不应该使用这种情况。看看这个附加的代码示例：

```
import java.awt.*;
import javax.swing.*;

public class PanelAddition
{
    private void createAndDisplayGUI()
    {
        JFrame frame = new JFrame("Panel Addition Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel contentPane = new JPanel();
        contentPane.setLayout(new GridLayout(0, 1));        
        JScrollPane scroller = new JScrollPane();

        CustomPanel panel = new CustomPanel(1);
        contentPane.add(panel);
        scroller.setViewportView(contentPane);
        frame.getContentPane().add(scroller, BorderLayout.CENTER);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);

        for (int i = 2; i < 20; i++)
        {
            CustomPanel pane = new CustomPanel(i);
            contentPane.add(pane);
            contentPane.revalidate();
            contentPane.repaint();
        }
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new PanelAddition().createAndDisplayGUI();
            }
        });
    }
}

class CustomPanel extends JPanel
{

    public CustomPanel(int num)
    {
        JLabel label = new JLabel("" + num);
        add(label);
    }

    @Override
    public Dimension getPreferredSize()
    {
        return (new Dimension(200, 50));
    }
} 
```

# php - jquery 移动应用程序 - 如何登录和存储 PHP 会话

> ID：11103432
> 
> 赞同：1
> 
> 时间：2012-06-19T14:43:43.170
> 
> 标签：php, jquery, session

我在为用 JQuery 编写的移动应用程序创建会话时遇到困难。我希望我的应用程序检查是否存在用户会话，如果不存在，它将用户重定向到登录表单。我使用 ajax 检查登录凭据，并以 JSON 格式返回用户详细信息。

如何将这些 JSON 变量存储在会话中，以便我可以在我的应用程序中访问这些变量？

```
function ajaxPost(LoadUrl, redirect) {
    jQuery.ajax({ 
        type: "POST", 
        url: LoadUrl, 
            data: "email=" + $("#email").val() + "&pw=" + $("#pw").val(),
            complete: function(xhr, statusText){ 
                if (xhr.status == 401){     
                    alert('Unauthorised');
                } 
        } ,

        success:function(response){ 
                if(redirect != null){
                    alert(response);
                    <? 
                    //session_start(); 
                    //$_SESSION['user'] = $response;  // this is JSON: {"id":"45454","name":"Joe Blog","username":"joebloguser"} 
                    ?>
                   app.navigate(redirect);

                }
            }
    });                 
} 
```

我已经注释掉了启动 PHP 会话的 PHP 代码，因为无论是否进行 ajax 调用，这似乎都会启动一个会话，因此总是有一个 $_SESSION 集，这显然是我不想要的。任何人都可以建议进行此操作的最佳方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:51:07.987

有几种方法可以解决这个问题（问题是嵌入式 JS 脚本和驻留在服务器端的 PHP 数据之间的即时通信）

一种方法是简单地将 JSON 字符串回显到隐藏元素中（如果它存在于会话中），然后使用 jquery 获取并将其解析为对象文字（如果存在）。

PHP：

```
<?php
if(isset($_SESSION['some_var'])) {
?>
<div id="#jsondata">
<?php echo json_encode($_SESSION['some_var']); ?>
</div> 
```

JS

```
var jsonData = JSON.parse($('#jsondata').html()); 
```

由于 PHP 会立即输出这些数据，所以当 PHP 完成向浏览器输出时，它会被渲染到 DOM 中，当 JQuery 触发时，它会呈现出来以供读取。显然，这会在源代码中暴露您的数据结构，因此在使用这种方法时需要考虑这一点。

另一种方法是有一个 PHP 端点，如果存在则输出用户数据，mimetyped 为 json，如果没有用户会话，则输出失败值，并让 JS 根据输出值引导体验：

PHP：

```
//in some accessible url
<?php
if(isset($_SESSION['some_var'])){
  $data = array('flag'=>1,'obj'=>$_SESSION['some_var']);
}else{
  $data = array('flag'=>0);
}
header('Content-type:application/json');
echo json_encode($data); 
```

然后，您可以像在给定示例中一样在页面加载时为此进行 ajax，并检查重定向的标志值。

您通常需要在设计这类事情时考虑到一种通用的方法来解决问题，因为它需要在经过身份验证的页面上普遍复制。您是否真的需要在客户端检查身份验证，或者您可以让服务器端代码操纵身份验证的分支（也许通过选择性地包含 javascript/模板文件。）最好考虑一下普遍适用于您的目的.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:46:46.427

如果你把 php 放在你的 javascript 之间，它会在页面第一次加载时运行（在任何 javascript 运行之前......），这样就行不通了。

您需要将会话逻辑移至`loadUrl`脚本；验证那里的登录并在必要时启动会话。

# .net - 实体和集合的缓存策略

> ID：11103435
> 
> 赞同：2
> 
> 时间：2012-06-19T14:43:54.703
> 
> 标签：.net, design-patterns, caching, architecture, scalability

我们目前有一个应用程序框架，在该框架中，我们会在业务层自动缓存实体和实体集合（使用 .NET 缓存）。因此，GetWidget(int id) 方法在访问数据库之前使用 GetWidget_Id_{0} 键检查缓存，而 GetWidgetsByStatusId(int statusId) 方法使用 GetWidgets_Collections_ByStatusId_{0} 检查缓存。如果对象不在缓存中，则从数据库中检索它们并将其添加到缓存中。

这种方法对于读取场景显然是快速的，并且作为一揽子方法对我们来说实施起来很快，但是在对实体执行 CRUD 操作时需要清除大量缓存键。显然，随着其他方法的添加，这会影响性能，并且缓存的好处会减少。

我对处理集合缓存的替代方法感兴趣。我知道 NHibernate 缓存了集合中的标识符列表，而不是实际的实体。这是其他人尝试过的方法吗？有什么优点和缺点？

特别是我正在寻找优化性能并且可以通过样板生成代码自动实现的选项（我们有自己的代码生成工具）。我知道有些人会说每次都需要手动完成缓存以满足特定情况的需要，但我正在寻找能够自动完成大部分工作的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T16:38:45.283

不确定你的问题到底是什么。

但是看看redis，它是一个数据结构缓存，你可以使用它。

根据您的定义，您正在存储 GetWidget_Id_{0} ，为什么要这样做？首先，您可以拥有自己的缓存，并且可以相当轻松地编写内存缓存容器。

```
interface ICache<K,V>{
   put(K,V)
   V get(K)
   delete(K)
}

class CacheContainer<K,V> : ICache<K,V>
{

   ConcurrentHashMap<K,V> _cache = new ....

   put impl..
   get impl..
   delete impl..

   purge..

} 
```

您可以扩展它并在您的子类中使用 LRU、LFU 和任何类型的缓存算法。

至于存储集合，与将项目存储为列表或集合的想法相同。

看看 redis 真的了解内存/缓存集合。一旦你理解了这些概念，看看缓存算法

希望这可以帮助。

# java - Java Neo4J 内存不足

> ID：11103436
> 
> 赞同：3
> 
> 时间：2012-06-19T14:43:54.940
> 
> 标签：java, memory, neo4j

这有点像：[Neo4j OutOfMemory 问题](https://stackoverflow.com/questions/2927329/neo4j-outofmemory-problem)

但它已经过时了，据我所知，解决方案显然也是如此。

所以我试图插入大约 10 万个具有 550 万关系的节点（我实际上削减了我的数据集，所以它现在更像是具有 280 万关系的 <100K 节点）。

过了一会儿，它的内存用完了，我得到一个像这样的异常：

```
Exception in thread "GC-Monitor" java.lang.OutOfMemoryError: Java heap space
    at java.util.Arrays.copyOfRange(Unknown Source)
    at java.lang.String.<init>(Unknown Source)
    at java.lang.StringBuilder.toString(Unknown Source)
    at org.neo4j.kernel.impl.util.StringLogger$ActualStringLogger.logMessage(StringLogger.java:276)
    at org.neo4j.kernel.impl.cache.MeasureDoNothing.run(MeasureDoNothing.java:85)
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
    at java.util.LinkedList.addBefore(Unknown Source)
    at java.util.LinkedList.add(Unknown Source)
    at org.neo4j.kernel.impl.nioneo.store.IdGeneratorImpl.freeId(IdGeneratorImpl.java:291)
    at org.neo4j.kernel.impl.nioneo.store.CommonAbstractStore.freeId(CommonAbstractStore.java:382)
    at org.neo4j.kernel.impl.nioneo.xa.WriteTransaction.doRollback(WriteTransaction.java:315)
    at org.neo4j.kernel.impl.transaction.xaframework.XaTransaction.rollback(XaTransaction.java:278)
    at org.neo4j.kernel.impl.transaction.xaframework.XaResourceManager.rollback(XaResourceManager.java:518)
    at org.neo4j.kernel.impl.transaction.xaframework.XaResourceHelpImpl.rollback(XaResourceHelpImpl.java:111)
    at org.neo4j.kernel.impl.transaction.TransactionImpl.doRollback(TransactionImpl.java:558)
    at org.neo4j.kernel.impl.transaction.TxManager.rollback(TxManager.java:610)
    at org.neo4j.kernel.impl.transaction.TransactionImpl.rollback(TransactionImpl.java:129)
    at org.neo4j.kernel.TopLevelTransaction.finish(TopLevelTransaction.java:119)
    at sqlToGraph.SqlToGraph.main(SqlToGraph.java:81) 
```

我已经尝试将 -Xmx1500m 传递给 java，这大约是我可以通过的限制，因为在它抱怨无法分配堆空间之前。它持续的时间明显更长，但仍然没有完成。

这是（略微编辑的）代码：

```
/* Postgres query and setup stuff cut */
Transaction tx = graphDb.beginTx();
try {
    while (rs.next()) {
        user_lo = rs.getInt(1);
        user_hi = rs.getInt(2);
        n_lo = getOrCreate(user_lo, graphDb);
        n_lo.setProperty("user_id", user_lo);
        n_lo.setProperty("total", rs.getInt(3));
        n_hi = getOrCreate(user_hi, graphDb);
        n_hi.setProperty("user_id", user_hi);
        n_hi.setProperty("total", rs.getInt(4));
        relationship = n_lo.createRelationshipTo(n_hi, RelTypes.PLAYED_WITH);
        relationship.setProperty("mean_percent", rs.getDouble(5));
    }
    tx.success();
} finally {
    tx.finish();
}
graphDb.shutdown(); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T14:05:48.867

在此处添加另一个答案。所以给定代码，问题是你永远不会提交你的事务。事务数据在提交之前一直保存在内存中，因此您创建的所有节点和关系都将留在内存中等待提交，这就是您最终获得 OOM 的原因。

我建议更改此代码：

```
/* Postgres 查询和设置的东西 cut */
交易 tx = graphDb.beginTx();
尝试 {
    for (int i = 0; rs.next(); i++) {
        user_lo = rs.getInt(1);
        user_hi = rs.getInt(2);
        n_lo = getOrCreate(user_lo, graphDb);
        n_lo.setProperty("user_id", user_lo);
        n_lo.setProperty("总计", rs.getInt(3));
        n_hi = getOrCreate(user_hi, graphDb);
        n_hi.setProperty("user_id", user_hi);
        n_hi.setProperty("总计", rs.getInt(4));
        关系 = n_lo.createRelationshipTo(n_hi, RelTypes.PLAYED_WITH);
        关系.setProperty("mean_percent", rs.getDouble(5));

        // 不时提交以释放内存。
        如果 ( 我 > 0 && 我 % 10000 == 0 ) {
            tx.成功（）；
            tx.finish();
            tx = graphDb.beginTx();
        }
    }
    tx.成功（）；
} 最后 {
    tx.finish();
}
graphDb.shutdown();

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-25T10:49:35.210

如果拆分事务对您来说不可行，因为您依赖单个事务的原子性保证，另一种选择可能是简化数据模型，例如减少添加到节点/关系的属性数量。

在我们的例子中，我们可以通过省略保存默认值或零的属性来解决 OOM 问题。

# macos - 带有我自己的服务器的 Mac Os 的最佳 Git 客户端是什么？

> ID：11103438
> 
> 赞同：13
> 
> 时间：2012-06-19T14:43:58.393
> 
> 标签：macos, git, github

好吧，我尝试[了 GitHub for Mac](http://mac.github.com/) - 非常有用的东西，但我不想与其他人分享我的私人代码（对不起，来自 github，但有商业项目）。

我还尝试处理[SourceTree](http://www.sourcetreeapp.com/) - 也很棒，还有私有的 Atlassian Bitbucket。

但是我仍然找不到可以支持我自己的服务器的客户端。可能吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-19T15:46:38.983

Sourcetree 当然支持本地 git 安装，Tower 也是如此。

你想错了。你在想，因为 SourceTree 只要求你输入 BitBucket、GitHub 或 Kiln 的凭据，这是你可以使用的唯一类型的 git 服务器。这是不正确的。它具有这些服务的身份验证对话框，因为这些服务提供了除 git 托管之外的额外功能，因此需要登录。

如果是标准共享存储库而不是商业服务，只需`File->New`在克隆存储库对话框中输入共享存储库的 URL。如果您已经通过命令行克隆了它，则单击“添加工作副本”按钮并将 SourceTree 指向它在磁盘上存在的位置。

克隆存储库后，您可以像使用命令行一样从/向中央存储库拉取和推送。Tower 也是如此。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T14:47:13.573

这是官方 Git GUI 客户端的列表

[http://git-scm.com/downloads/guis](http://git-scm.com/downloads/guis)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T14:48:47.347

我个人使用`/usr/bin/git`.

如果您更喜欢使用图形化的东西，那么请在[https://github.com/gitx/gitx/releases上查看](https://github.com/gitx/gitx/releases)[GitX](http://gitx.frim.nl/)或更好的最新版本。

我不使用 SourceTree，但我原以为它们会支持任何服务器 - 您可能需要仔细检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T14:48:05.857

你可以试试[gitx](http://gitx.frim.nl/)。但我更喜欢终端。
Source Tree 是我测试过的最完整的 GIT GUI 应用程序。

看起来最新版本在[https://github.com/gitx/gitx/releases](https://github.com/gitx/gitx/releases)

# java - 构造函数可以返回一个空对象吗？

> ID：11103444
> 
> 赞同：77
> 
> 时间：2012-06-19T14:44:15.610
> 
> 标签：java, constructor, null

在查看一些旧代码时，我遇到了这个 gem：

```
MyObject o = new MyObject("parameter");
if (o == null) o = new MyObject("fallback parameter"); 
```

第二行在 Eclipse 中被标记为死代码，我明白为什么。似乎没有显式抛出异常，构造函数也不可能`MyObject`抛出任何类型的异常（例如`NullPointerException`s）。

我的问题是*为什么*有一个空检查？以前在旧版本的 Java 中构造函数是否可以返回 null？或者这只是无用和死代码？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-06-19T14:46:25.680

该代码在任何版本的 Java 中都已失效。构造函数不可能返回`null`，即使构造函数抛出异常，也不会调用下一行。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-06-19T14:47:27.897

不，这是不可能的。也许之前版本的代码使用了一些可以返回 null 的工厂方法：

```
MyObject o = createMyObject("parameter");
if (o == null) o = createMyObject("fallback parameter"); 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2012-06-19T14:50:38.660

从[JLS 的第 15.9.4 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.9.4)：

> 类实例创建表达式的值是对指定类的新创建对象的引用。每次计算表达式时，都会创建一个新对象。

所以不，它永远不能返回null。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-06-19T18:17:13.147

我的猜测是它是由一个 C 程序员编写的，他习惯于测试`malloc()`for的返回值，如果您的系统内存不足`NULL`， `malloc()`可以返回。`NULL`

该代码在 Java 中没有意义，因为如果内存不足，Java 将抛出 OutOfMemoryError`。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-06-19T15:22:31.637

答案很简单：编写代码的人是一个偏执的 C++ 程序员。在 C++ 中，您可以重载 operator new 并将其用作简单的内存分配器（又名 malloc）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-06-19T14:46:37.847

这只是无用的死代码。一旦 CTOR 成功执行，您就可以引用该对象。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-19T14:46:50.173

当您创建一个*new Object()*时，您会在内存中创建一个地址，并且该地址不是“null”，但您的 Object 可能为空。

您必须为参数传输的对象测试“空”。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-06-19T14:47:43.573

这只是死代码。

`new MyObject("parameter")`不会`null`在任何版本的 java 中返回。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-10-21T00:26:58.657

正如我今天发现的那样，尽管在所有其他答案中都说了些什么，但`Foo x = new Foo(...)`如果所述代码在使用[PowerMock](https://powermock.googlecode.com/svn/docs/powermock-1.5/apidocs/org/powermock/api/mockito/PowerMockito.html#whenNew%28java.lang.Class%29)（或其他具有类似效果的模拟框架）的测试中运行，则确实可以返回 null：

```
PowerMockito.whenNew(Foo.class).withAnyArguments().thenReturn(mockFoo); 
```

在这种情况下，Foo 的构造函数中的代码被完全绕过`new Foo(...)`。但是，如果您编写了一个测试，但没有以上述方式指定模拟，那么您最终可能会得到`null`相反的结果。

但是*即使*您使用这样的框架，您也不希望在您的类中添加额外的代码，只是为了优雅地处理您忘记在测试中正确模拟对象的情况！这*不是*您的代码打算运行的真实场景。无论如何都应该消除只有在测试时才处于活动状态的代码，在这种情况下，它只会在测试失败时才处于活动状态。

因此，即使您使用的是 PowerMock，第二行也应该被正确地视为“死代码”并删除。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-01-02T09:41:39.487

这个问题是绝对合法的。您可以像这样添加静态方法`MyObject`：

```
static MyObject create(String parameter)) {
       if (parameter.satisfySomething())
          return new MyObject(parameter);
       else
          return null;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-04T20:00:18.767

所有答案都基于理论和编辑的警告。

事实上，大多数编辑器在针对 null 测试 new object() 的结果时会报告死代码。

但是，至少在 Android 上，我有很多关于新 xxx() 返回 null 的崩溃报告，我认为在大多数情况下是因为内存不足。

一个简单的例子是这样的：

```
object_class obj = new object_class(context);
obj.getCount(); 
```

我在 getCount() 行得到这样的报告：

java.lang.NullPointerException：尝试在空对象引用上调用虚拟方法“int object_class.getCount()”

所以这是可能的，但大多数编辑器/编译器不会让你检查这种情况。

# php - 使用 XPath 和 PHP 访问和更新 XML 中的属性值

> ID：11103445
> 
> 赞同：0
> 
> 时间：2012-06-19T14:44:21.767
> 
> 标签：php, xml, xpath

这是我今天上一篇文章的扩展，可以在这里找到：[点击这里](https://stackoverflow.com/questions/11099208/xpath-attribute-value-check-with-a-variable-passed-using-php)

现在我想根据 id 属性访问另一个属性并更改它。这是我修改后的 xml 文件：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<document>
    <item id="a12sd">       
        <name>James</name>
        <age years="25"/>
        <pdf>0023.pdf</pdf>
    </item>
    <item id="rdf23">       
        <name>Alex</name>
        <age years="35"/>
        <pdf>0178.pdf</pdf>
    </item>
    <item id="2we34">       
        <name>Tom</name>
        <age years="25"/>
        <pdf>0886.pdf</pdf>
    </item>
    <item id="123de">       
        <name>Robby</name>
        <age years="28"/>
        <pdf>1239.pdf</pdf>
    </item>
</document> 
```

我已经能够使用以下代码更新标签：

```
$id = "a12sd";
$xml = simplexml_load_file('items.xml');  

$itemsList = $xml->xpath('/document/item[@id = "a12sd"]');             

$itemsList[0]->name = "Arnold";

$xml->asXml("items.xml"); 
```

现在我需要访问 id="a12sd" 的属性年龄并将年龄更新为：26

知道如何为给定的 id 达到该属性并更改该值。

注意：在更改值之前，用户只知道“id”值，因此基于 id 值我想更改该特定 id 的年份属性。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T14:51:34.240

```
$itemsList[0]->age->attributes()->years = 26; 
```

# javascript - jQuery触发带有单独元素的锚点击动作

> ID：11103446
> 
> 赞同：2
> 
> 时间：2012-06-19T14:44:21.843
> 
> 标签：javascript, jquery, hyperlink, theory

*这更像是一个假设性的问题。*

我想知道是否有人知道是否/如何通过使用 jQuery 单击另一个元素来触发锚点上的单击事件。

我想，我显而易见的解决方案是获取`src`锚点上的内容，然后 js 导航到该位置。不幸的是，锚是一个`mailto`.

这似乎有点像软糖。有没有其他（*更优雅*）的方式来模拟用户通过点击说一个按钮来点击锚点？

该链接看起来像： -

```
<a id="testAnchor" href="mailto:test@stackoverflow.com">Email test</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:46:24.523

**不，**你不能这样做。但是您可以执行以下操作：

```
window.location = $('#testAnchor').attr('href'); 
```

上面的代码就像触发点击一样。

您可以尝试使用链接绑定单击事件，然后触发该单击。

```
$('#testAnchor').click(function() {
   window.location = this.href;
}); 
```

然后触发点击：

```
$('#testAnchor').click(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:50:21.047

如果你有一个像这样的按钮：

```
<input type="button" id="clickme" value="Click Me!" /> 
```

然后您可以通过执行以下操作来模拟对 a 标签的点击：

```
<script language="javascript" type="text/javascript">
$(document).ready(function() {
  $("#clickme").click(function() {
    document.location.href=$("#testAnchor").attr('href');
  });
});
</script> 
```

# javascript - jQuery Sortable - 取消和恢复不能按预期工作

> ID：11103447
> 
> 赞同：13
> 
> 时间：2012-06-19T14:44:24.540
> 
> 标签：javascript, jquery, jquery-ui

## 问题（问题[的jsFiddle演示](http://jsfiddle.net/9THR9/)）

当与jQuery sortable 中`revert`的方法结合使用时，我在设置方面遇到了一些问题。[jQuery Sortable 文档](http://jqueryui.com/demos/sortable/#method-cancel)`cancel`中记录的取消方法指出：

> 取消当前可排序的更改并将其恢复到当前排序开始之前的状态。在停止和接收回调函数中很有用。

这在回调`stop`和`receive`回调中都可以正常工作，但是如果我向可排序的连接列表添加`revert` *持续时间*，它就会开始变得有趣（请参阅[此处的 jsFiddle](http://jsfiddle.net/9THR9/)）。

理想情况下，取消后，它`revert`根本不会发生，或者在更理想的世界中，它会优雅地恢复到原来的位置。`revert`有什么想法可以让我`cancel`玩得更好吗？

## 预期的

1.  从左侧列表拖动到右侧列表
2.  掉落物品
3.  项目动画到**原始**位置*- 或 -*立即转移到原始位置

## 实际的

1.  从左侧列表拖动到右侧列表
2.  掉落物品
3.  假设可排序成功，项目动画到**新位置**
4.  项目立即转移到原始位置，因为可分类已被取消

## 澄清

如果成功，该属性会将项目移动到该项目将下降的位置，然后由于该方法之前发生的`revert`原因立即移回原始位置。有没有办法改变生命周期，所以如果方法被执行，不是，而是项目立即返回到它的原始位置？`revert``cancel``cancel``revert`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T16:10:20.103

我在这里为您创建了一个演示：

[jsfiddle 代码](http://jsfiddle.net/nickadeemus2002/jraWM/)

它似乎产生了您期望的输出。

我从这里更改了接收回调方法：

```
$(ui.sender).sortable('cancel'); 
```

对此：

```
$(ui.sender).sortable( "option", "revert", false ); 
```

希望这是您所期望的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T08:53:27.440

在寻找解决方案数小时后，我决定实现我想要做的事情的唯一方法是修改 jQuery 可排序插件注册恢复时间的方式。目的是允许该`revert`属性不仅接受 a `boolean`or `integer`，而且还接受 a `function`。这是通过非常轻松地连接到`prototype`on来实现的`ui.sortable`，看起来像这样。

## jQuery 可排序修补程序

```
$.ui.sortable.prototype._mouseStop = function(event, noPropagation)
{
    if (!event) return;

    // if we are using droppables, inform the manager about the drop
    if ($.ui.ddmanager && !this.options.dropBehaviour)
        $.ui.ddmanager.drop(this, event);

    if (this.options.revert)
    {
        var self = this;
        var cur = self.placeholder.offset();

        // the dur[ation] will not determine how long the revert animation is
        var dur = $.isFunction(this.options.revert) ? this.options.revert.apply(this.element[0], [event, self._uiHash(this)]) : this.options.revert;

        self.reverting = true;

        $(this.helper).animate({
            left: cur.left - this.offset.parent.left - self.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft),
            top: cur.top - this.offset.parent.top - self.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)
        }, !isNaN(dur) ? dur : 500, function ()
        {
            self._clear(event);
        });
    } else
    {
        this._clear(event, noPropagation);
    }

    return false;
} 
```

## 执行

```
$('ul').sortable({
    revert: function(ev, ui)
    {
        // do something here?
        return 10;
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T03:28:50.813

我最终创建了一个名为 beforeRevert 的新事件，它应该返回 true 或 false。如果为 false，则调用取消函数并将项目动画回其原始位置。我没有考虑到 helper 选项对此进行编码，因此它可能需要一些额外的工作来支持它。

## 带有动画的 jQuery 可排序修补程序

```
var _mouseStop = $.ui.sortable.prototype._mouseStop;
$.ui.sortable.prototype._mouseStop = function(event, noPropagation) {
  var options = this.options;
  var $item = $(this.currentItem);
  var el = this.element[0];
  var ui = this._uiHash(this);
  var current = $item.css(['top', 'left', 'position', 'width', 'height']);
  var cancel = $.isFunction(options.beforeRevert) && !options.beforeRevert.call(el, event, ui);

  if (cancel) {
    this.cancel();
    $item.css(current);
    $item.animate(this.originalPosition, {
      duration: isNaN(options.revert) ? 500 : options.revert,
      always: function() {
        $('body').css('cursor', '');
        $item.css({position: '', top: '', left: '', width: '', height: '', 'z-index': ''});
        if ($.isFunction(options.update)) {
          options.update.call(el, event, ui);
        }
      }
    });
  }

  return !cancel && _mouseStop.call(this, event, noPropagation);
}; 
```

## 执行

```
$('ul').sortable({
  revert: true,
  beforeRevert: function(e, ui) {
    return $(ui.item).hasClass('someClass');
  }
}); 
```

# jquery - 滑块定位宽度

> ID：11103458
> 
> 赞同：0
> 
> 时间：2012-06-19T14:44:55.633
> 
> 标签：jquery, css

我做了一个滑块：http: [//dranz1r.com/index.html](http://dranz1r.com/index.html)

例如，当您向右滑动时，图像与右边缘之间有一个空间。我无法理解这个空间是如何创建的，因为所有东西的宽度都是 1100 像素。

你能帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:51:30.907

您的图像不够宽，无法填充滑块

```
 .slider {
position: relative;
display: block;
width: 1090px;   //this line
height: 300px;
margin: 60px auto;
overflow: hidden; 
```

}

使容器小 10 px，或小 20 px，而不是图像更大，如果图像太大，它会溢出到下一张幻灯片

# entity-framework-4 - EF Code First 逆向工程定制模板（EF Power Tools Beta 2）

> ID：11103462
> 
> 赞同：0
> 
> 时间：2012-06-19T14:45:11.640
> 
> 标签：entity-framework-4, ef-code-first, t4

我正在从现有的 pgsql 数据库生成 POCO。

我想将生成的 POCO 放入自己的 C# 类库和 DbContext 并映射到不同的项目中，这样我的 POCO 就不会引用任何与 EF 相关的内容。

我正在尝试修改 Context.tt 模板以在 OnModelCreating() 期间在运行时指定表架构，因为在生成的实体上使用 [Table] 属性会引入到 EF 库的硬链接。

我的问题是我目前无法从当前的 EnitySet 中检索架构名称。这是我到目前为止所做的摘录：

```
var efHost = (EfTextTemplateHost)Host;

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
<#
foreach (var set in efHost.EntityContainer.BaseEntitySets.OfType<EntitySet>())
{
#>
  modelBuilder.Configurations.Add(new <#= set.ElementType.Name #>Map());
  modelBuilder.Entity<<#= set.ElementType.Name #>>().ToTable("<#= set.Name #>", "<#=????#>");
<#
}
#>
    } 
```

此时唯一可用的对象是**EfTextTemplateHost**的一个实例。

任何帮助表示赞赏。

TIA。

**编辑**：我找到了检索模式的方法（set.MetadataProperties["Schema"].Value ?? ""），但该值始终为 null ！这可能意味着逆向工程代码优先工具不会将值提供给模板主机。我可能会结束解析 edmx 文件。未完待续。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T17:04:03.720

我查看了电动工具附带的 mapping.tt 文件，它通过执行以下操作获取架构：

```
var tableSet = efHost.TableSet;
var tableName = (string)tableSet.MetadataProperties["Table"].Value
    ?? tableSet.Name;
var schemaName = (string)tableSet.MetadataProperties["Schema"].Value; 
```

你能做类似的事情吗？也许这个（我自己还没有尝试过）：

```
<#   
foreach (var set in efHost.EntityContainer.BaseEntitySets.OfType<EntitySet>())   
{
#>   
    modelBuilder.Configurations.Add(new <#= efHost.TableSet.MetadataProperties[set.ElementType.Name].Value #>Map());   
    modelBuilder.Entity<<#= efHost.TableSet.MetadataProperties[set.ElementType.Name].Value #>>().ToTable("<#= set.Name #>", "<#=efHost.TableSet.MetadataProperties[set.ElementType.Name].Value #>");   
<#   
}
#> 
```

# c# - 如何保留 WPF 中自定义按钮的默认突出显示和单击属性？

> ID：11103464
> 
> 赞同：0
> 
> 时间：2012-06-19T14:45:19.733
> 
> 标签：c#, wpf, button

我为我的 Button 创建了自定义样式，但它不再可点击，如何保留按钮的默认点击属性。

```
 <Style x:Key="customStyle" TargetType="Button">   
    <Setter Property="BorderThickness" Value="3"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Padding" Value="0,0,1,1"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Canvas x:Name="ButtonCanvas" Width="171" Height="144">
                    <Image x:Name="ButtonImage" Width="171" Height="144" Source="{Binding thumbnail}"/>
                </Canvas>             
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:55:07.437

您提供了一个自定义模板，其中不包含通常与按钮相关联的任何视觉状态（例如 Pressed、Disabled、...）

您可以做的最好的事情是使用 Expression Blend，它可以让您轻松地自定义标准模板。或者，您可以从[http://msdn.microsoft.com/en-us/library/ms753328(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms753328(v=vs.100).aspx)上提供的默认模板开始。

# javascript - Next() 在 Node.js 中是如何工作的？

> ID：11103465
> 
> 赞同：0
> 
> 时间：2012-06-19T14:45:25.137
> 
> 标签：javascript, node.js

我最近在[Nodejitsu](http://blog.nodejitsu.com/http-proxy-middlewares)上阅读了一篇博客，我想知道这段代码是如何工作的。

```
var fs = require('fs'),
http = require('http'),
httpProxy = require('../lib/node-http-proxy');

module.exports = function (logging) {
  // Code here is run when the middleware is initially loaded.
  var logFile = fs.createWriteStream('./requests.log');

  return function (request, response, next) {
    // Code here is run on each request.
    if (logging) {
      logFile.write(JSON.stringify(request.headers, true, 2));
    }
    next();
  }
} 
```

而对这段代码给出的解释是：

> 该中间件用于非常简单的日志记录——它将每个请求的标头写入日志文件。

上面导出的模块可以用作，

```
httpProxy.createServer(
  require('./example-middleware')(true),
  8000, 'localhost'
).listen(9000) 
```

上述方法中的代码如何`next()`在每个请求中调用？用法很简单： require 上面的模块，它每次都会被调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:09:32.830

我将简化实际过程，但它的要点：

当请求进来时，节点将请求和响应对象传递给中间件堆栈中的第一个中间件。如果该中间件以任何方式发送响应或关闭连接，则不会调用后续中间件。否则，该中间件必须告诉节点它完成了继续在中间件堆栈中移动的工作，因此您在中间件中调用 next() 以告诉它继续处理中间件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:44:10.253

好的，所以这是一个很常见的事情。这个模块包含的是一个函数，由这一行指定，我们将 module.exports 设置为一个函数，`module.exports = function (logging) {`. 模块返回的函数（因此返回`require()`）返回另一个函数，它是 HTTP 代理的中间件（这个中间件允许您转换请求）。对于向服务器发出的每个 HTTP 请求，都会调用此中间件函数。Quickredfox 的回答对中间件提供了相当好的解释。

所以`require('./example-middleware')(true)`实际调用分配给的函数`module.exports`，但不调用其中的函数，该函数立即返回并作为中间件传递给`httpProxy.createServer`函数。这是使用闭包为中间件设置一些选项的好方法。如果您还有任何问题，请随时发表评论。:D

# ruby-on-rails - semantic_fields_for 不会将所有内容归为一个 li

> ID：11103467
> 
> 赞同：1
> 
> 时间：2012-06-19T14:45:35.920
> 
> 标签：ruby-on-rails, formtastic

我将 f.semantic_fields_for 与 haml 一起使用

这是当前的片段。

```
 %ul.documents
        =f.semantic_fields_for :documents do |u|
          = link_to(u.object.comment.presence || u.object.file.original_filename, u.object.file.url)                                                                                     
          = u.input :comment, :as=>:string
          = u.hidden_field :_destroy
          = link_to_function image_tag("/img/del_documets.png"), "remove_fields(this)", :class => "btn" 
```

这里的问题是只有“u.input :comment, :as=>:string” 在由 formtastic 创建的“li”内。链接和其他字段位于其他位置，并且无法正确设置这个损坏的 html 的样式。

有没有办法确保一切都在正确的 li 内？

即使我在 f.semantic_fields_for 之后添加一个 li，它也只会包装第一个链接，并且以下元素只会被上面的 ul 完全包装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T19:06:03.120

您还可以在生成包装器时覆盖 Formtastic 的默认行为，`inputs`如下所示：

```
module Formtastic
  module Inputs
    module Base
      module Wrapping
        def input_wrapping(&block)
          template.content_tag(:li,
            [template.capture(&block), error_html, hint_html].join("\n").html_safe, 
            wrapper_html_options
          )
        end
      end
    end
  end
end 
```

注意`content_tag(:li`. 例如，您可以将其替换`content_tag(:div`为。

你知道如何在 Rails 中重写模块方法吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:30:53.527

似乎 formtastic 总是将输入包装起来`<li>`以避免`<fieldsets>`在里面`<ol>`，这是无效的。

最好的解决方法是放置`<li>`所有元素并根据需要添加`wrapper_html => { :class => :your_class }`到您的输入中。这样你就可以按照自己的方式设计风格。

我认为您不需要`ul.documents`输入，`semantic_fields_for`已经使用`<ol>`.

直接生成 html 的库不是这样，你最好让你的 html 和 css 适应它们，而不是试图让它们生成你的 html。

我会这样做（并从中设置我自己的 CSS 样式）：

```
 =f.semantic_fields_for :documents do |u|
      %ul.documents
        %li= link_to(u.object.comment.presence || u.object.file.original_filename, u.object.file.url)                                                                                     
        = u.input :comment, :as=>:string
        %li= u.hidden_field :_destroy
        %li= link_to_function image_tag("/img/del_documets.png"), "remove_fields(this)", :class => "btn" 
```

希望这可以帮助。

# c# - 为 ASP .NET MVC3 应用程序使用 Active Directory

> ID：11103470
> 
> 赞同：-1
> 
> 时间：2012-06-19T14:46:03.153
> 
> 标签：c#, .net, asp.net-mvc-3, active-directory, ldap

除了根据用户组管理对应用程序部分的访问之外，我还尝试使用 Active Directory（没有登录页面）在 MVC3 应用程序上对用户进行身份验证。我已经广泛搜索，没有端到端的例子。我希望有人可以提供帮助。我的 Active Directory 设置是：CN=Test User,OU=NETDOM,DC=NETLAB,DC=COM。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:56:16.703

在您的下方`appSettings`，您应该添加

```
<add key="enableSimpleMembership" value="false" />
<add key="autoFormsAuthentication" value="false" /> 
```

然后在

```
<system.web>
<authentication mode="Windows" />
</system.web> 
```

下面的第一项`appSettings`关闭自动重定向到`/account/login`路线。而`authenication`节点在 IIS 中打开 Windows Auth。

只要它们在服务器所在的域上，那么这应该可以工作，而无需实施任何身份验证

**如果要使用成员资格提供程序，请**编辑**`system.web`，然后在节点下添加。**

 **```
<membership defaultProvider="MyADMembershipProvider">
            <providers>
                <add name="MyADMembershipProvider" type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" connectionStringName="ConnectionStringFromConnectionSettings" attributeMapUsername="sAMAccountName" />
            </providers>
        </membership> 
```

那么您所要做的就是在 Global.asax 中添加一个事件处理程序

```
PostAuthenticateRequest 
```

检查AD。
这里要小心，因为此事件会针对服务器上的所有请求触发，并且可能会影响性能。**

# javascript - Internet Explorer 将不支持通过 jQuery 或 CSS 停止滚动

> ID：11103475
> 
> 赞同：2
> 
> 时间：2012-06-19T14:46:12.123
> 
> 标签：javascript, jquery, html, css

我正在制作一个重叠的屏幕（如 facebook 照片查看器），现在它在 chrome、safari 和 firefox 中运行良好，但我也需要它在 IE 中运行。实际上 div 像我想要的那样完美重叠，但它允许它滚动，我不想这样做。所以我尝试使用溢出：隐藏；单击按钮时，它不会滚动。它工作正常，但现在我的问题是让它再次滚动。我都尝试过 overflow: auto 和一些 jquery 函数，但它似乎不起作用。而且我还检测到它不会执行 jquery，例如 $(document).ready(function() { ... });

我用来重叠的代码：

```
var outercontent = document.getElementById('transparent')
var innercontent = document.getElementById('innercont')
browser = navigator.appName;
explore = "Microsoft Internet Explorer";
if(browser == explore) {
    outercontent.style.zIndex = '9989';
    outercontent.style.display = 'block';
    outercontent.style.position = 'absolute';
    outercontent.style.top = '0';
    outercontent.style.left = '0';
    outercontent.style.width = viewportwidth;
    outercontent.style.height = viewportheight;
    outercontent.style.margin = '0';
    outercontent.style.padding = '0';

    innercontent.style.left = '20%';
    innercontent.style.background = 'white';
    innercontent.style.zIndex = '9999';
    innercontent.style.width = '60%';
    innercontent.style.height = '80%';
    innercontent.style.marginBottom = '10%';
    innercontent.style.marginTop = '5%';
    innercontent.style.padding = '10px';

} 
```

在我的 html 页面中，我放置了 div：

```
<div id='transparent' style='background-color: rgba(0, 0, 0, 0.5);
filter:
progid:DXImageTransform.Microsoft.Gradient(GradientType=0,
StartColorStr='#e5000000',EndColorStr='#e5000000');
text-align: center;'>
    <div id='innercont' style='position: absolute; color: black;'></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T12:30:32.747

如何将您的内容包装在`<div>`with `height: 100%; overflow: hidden;`inside of 中`#innercont`？那应该更可控。

# javascript - html5可以将数据发送到不同的程序吗？

> ID：11103483
> 
> 赞同：0
> 
> 时间：2012-06-19T14:46:29.537
> 
> 标签：javascript, html

我目前正在处理一个提示您输入名称的 html 文件。然后它将采用该名称并将其添加到 SQL 服务器数据库。这是代码：

```
<!DOCTYPE html>
<html>
<body>

<form name="customerForm" action="" method="get">
First Name: <input type="text" name="firstname" /><br />
Last Name: <input type="text" name="lastname" /><br />
<input type="button" name="button" value="Add Customer" onClick="addCustomer(this.form)">
</form>

<script type="text/javascript">
function addCustomer(form)
{
    var x = form.firstname.value;
    var y = form.lastname.value;
    var name = x+" "+y;
    alert(name);
}
</script>
</body>
</html> 
```

目前我有 javascript 函数将名称放入警报框以查看它是否有效。

我了解程序的 html 方面。我不知道将数据添加到 SQL Server 数据库中的任何技术或有效方法。

如果有人愿意提供帮助，我将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:49:51.090

您需要对某种用 Python/Perl/PHP/Ruby/etc 编写的服务器端脚本使用 POST 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:50:12.947

替换`button`为`submit`，在属性中设置一个URI，`action`即提交数据的程序。

您需要它和您的网络服务器之间的接口。具体情况取决于您的服务器和语言选择。[CGI](http://www.ietf.org/rfc/rfc3875)是一种简单的通用方法（但效率很低）。[FastCGI](http://www.fastcgi.com/)是一种更复杂、更高效的替代方案。还有语言/服务器特定的接口，例如[mod_perl](http://perl.apache.org/)和[mod_php](http://www.php.net/manual/en/install.unix.apache2.php)。如果我今天开始一个项目，我可能会用 Perl 编写它并使用[PSGI/Plack](http://plackperl.org/)为我的部署方式提供灵活性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:51:39.223

您需要一种服务器端技术，如 ASP.NET、PHP 或类似的技术来提交表单并在服务器端对其进行处理。

可能有某种 jQuery 插件可以做到这一点，但你会更适合学习上述技术之一。

是否有某种原因导致您不能使用服务器端技术？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T14:53:10.093

Html5 在客户端工作。如果 Webstorage (http://davidwalsh.name/html5-storage) 符合您的需要，您可以使用它，但要将数据保存在另一台服务器中，您必须发送它。

# sql - 在 SQL Server 中将 ProcessParameters 处理为 XML

> ID：11103484
> 
> 赞同：2
> 
> 时间：2012-06-19T14:46:31.950
> 
> 标签：sql, sql-server, xml, sql-server-2008, xquery

我正在尝试从 XML 列中提取值。不幸的是，无论我尝试什么组合，我都无法从中得到任何有意义的结果。

可以在[此处找到带有数据的测试脚本](https://data.stackexchange.com/stackoverflow/query/edit/73392)

**没有为我打开灯的相关问题**

*   [从 XML 类型字段中获取值](https://stackoverflow.com/questions/7558400/getting-values-from-xml-type-field-using-in-sql-server)
*   [XML query() 有效，value() 需要单例](https://stackoverflow.com/questions/1302064/sql-server-2005-xml-query-works-value-requires-singleton-found-xdtuntyp?rq=1)
*   [从 XQuery 和 SQL Server 2005 获取行集](https://stackoverflow.com/questions/652268/getting-rowsets-from-xquery-and-sql-server-2005?rq=1)

**一项内容示例**

```
<Dictionary xmlns="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:mtbwa="clr-namespace:Microsoft.TeamFoundation.Build.Workflow.Activities;assembly=Microsoft.TeamFoundation.Build.Workflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" x:TypeArguments="x:String, x:Object">
  <mtbwa:BuildSettings x:Key="BuildSettings" ProjectsToBuild="$/Projects/BpABA/Dev/V6/DUnit/FrameworkTests.dproj">
    <mtbwa:BuildSettings.PlatformConfigurations>
      <mtbwa:PlatformConfigurationList Capacity="1">
        <mtbwa:PlatformConfiguration Configuration="Debug" Platform="Win32" />
      </mtbwa:PlatformConfigurationList>
    </mtbwa:BuildSettings.PlatformConfigurations>
  </mtbwa:BuildSettings>
  <mtbwa:SourceAndSymbolServerSettings SymbolStorePath="{x:Null}" x:Key="SourceAndSymbolServerSettings" />
  <mtbwa:AgentSettings x:Key="AgentSettings" MaxExecutionTime="01:00:00" MaxWaitTime="04:00:00" Tags="Delphi 5" />
  <x:Boolean x:Key="CreateWorkItem">False</x:Boolean>
  <x:Boolean x:Key="PerformTestImpactAnalysis">False</x:Boolean>
</Dictionary> 
```

**最近的尝试**

```
;WITH XMLNAMESPACES('http://schemas.microsoft.com/winfx/2006/xaml' AS mtbwa)
, q AS (
  SELECT  CAST(bd.ProcessParameters AS XML) p
  FROM    dbo.tbl_BuildDefinition bd     
) 
SELECT  X.Doc.value('mtbwa:BuildSettings[0]', 'VARCHAR(50)') AS 'Test'
FROM    q CROSS APPLY p.nodes('/mtbwa:Dictionary') AS X(Doc) 
```

**背景**

该列`ProcessParameters`是`tbl_BuildDefinition`表中 TFS 构建系统的一部分。完整的DDL如下

```
USE [Tfs_ProjectCollection]
GO

/****** Object:  Table [dbo].[tbl_BuildDefinition]    Script Date: 06/19/2012 16:28:56 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tbl_BuildDefinition](
    [DefinitionId] [int] IDENTITY(1,1) NOT NULL,
    [GroupId] [int] NOT NULL,
    [DefinitionName] [nvarchar](260) NOT NULL,
    [ControllerId] [int] NOT NULL,
    [DropLocation] [nvarchar](260) NULL,
    [ContinuousIntegrationType] [tinyint] NOT NULL,
    [ContinuousIntegrationQuietPeriod] [int] NOT NULL,
    [LastBuildUri] [nvarchar](64) NULL,
    [LastGoodBuildUri] [nvarchar](64) NULL,
    [LastGoodBuildLabel] [nvarchar](326) NULL,
    [Enabled] [bit] NOT NULL,
    [Description] [nvarchar](2048) NULL,
    [LastSystemQueueId] [int] NULL,
    [LastSystemBuildStartTime] [datetime] NULL,
    [ProcessTemplateId] [int] NOT NULL,
    [ProcessParameters] [nvarchar](max) NULL,
    [ScheduleJobId] [uniqueidentifier] NOT NULL,
 CONSTRAINT [PK_tbl_BuildDefinition] PRIMARY KEY CLUSTERED 
(
    [GroupId] ASC,
    [DefinitionName] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[tbl_BuildDefinition] ADD  DEFAULT (newid()) FOR [ScheduleJobId]
GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:22:30.933

我认为您`mbtwa`在 XML/XQuery 文本中为前缀定义了错误的命名空间，并且在使用该函数时需要使用基于 1 的索引来获取数据`.value()`（而不是像常用的那样基于 0）。

所以试试这个：

```
;WITH XMLNAMESPACES('clr-namespace:Microsoft.TeamFoundation.Build.Workflow.Activities;assembly=Microsoft.TeamFoundation.Build.Workflow' AS mtbwa, 
                    DEFAULT 'clr-namespace:System.Collections.Generic;assembly=mscorlib')
, q AS (
  SELECT CAST(bd.ProcessParameters AS XML) p
  FROM dbo.tbl_BuildDefinition bd     
  WHERE DefinitionId = 1
) 
SELECT  
    X.Doc.query('mtbwa:BuildSettings') AS 'Node',
    X.Doc.value('(mtbwa:BuildSettings/@ProjectsToBuild)[1]', 'VARCHAR(50)') AS 'ProjectsToBuild'
FROM
    q 
CROSS APPLY 
    p.nodes('/Dictionary') AS X(Doc) 
```

`<mtbwa:BuildSettings>`这应该为您提供作为 XML的整个节点（使用该`.query()`函数），以及该节点的单个属性`ProjectsToBuild`( `$/Projects/BpABA/Dev/V6/DUnit/FrameworkTests.dproj`) 的值。

![在此处输入图像描述](../Images/63c5a0156c6c22dbfed9ec10448fa545.png)

如果您想要一个完整的节点（如 XML），那么您需要使用`.query('xpath')`- 该`.value()`函数可以获得节点的内部文本（如果存在）或单个属性的值。

这些帮助有用？

# javascript - 如何在JavaScript中将数字的二进制表示从字符串转换为整数？

> ID：11103487
> 
> 赞同：48
> 
> 时间：2012-06-19T14:46:36.510
> 
> 标签：javascript, type-conversion

有人可以给我一点建议吗？

我有一个字符串，例如“01001011”，我需要做的是反转它，所以我使用`.split('')`了`.reverse()`，现在我需要将数组作为字符串读取并将其转换为整数。可能吗？

谢谢

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-06-19T14:48:43.993

如果要将数组转换回字符串，请使用 `join()`( [MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/join) ) 并将字符串转换为整数，请使用`parseInt()`( [MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt) )。后者的第二个参数是可选的基数。

JavaScript 将尝试确定要使用的基数，但要确保始终手动添加基数。引用 MDN：

> 如果 radix 未定义或为 0，JavaScript 假定如下：
> 
> *   如果输入字符串以“0x”或“0X”开头，则基数为 16（十六进制）。
>     
>     
> *   如果输入字符串以“0”开头，则基数为八（八进制）。这个特性是非标准的，一些实现故意不支持它（而是使用基数 10）。由于这个原因，在使用 parseInt 时总是指定一个基数。
>     
>     
> *   如果输入字符串以任何其他值开头，则基数为 10（十进制）。

因此，在您的情况下，以下代码应该可以工作：

```
var a = '01001011';

var b = parseInt( a.split('').reverse().join(''), 2 ); 
```

或者只是（如果您想转换起始字符串，而不需要反转）：

```
var b = parseInt( a, 2 ); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-19T14:48:12.373

只需`parseInt`使用不同的基数调用，在这种情况下使用 2 表示二进制。

```
var a = parseInt("01001011", 2);
// a === 75 
```

`parseInt`当您没有明确指定基数时，它会尝试找出基数本身。[来自 Mozilla 开发者网络](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt#Description)：

> 如果 radix 是`undefined`或 0，JavaScript 假设如下：
> 
> *   如果输入`string`以“0x”或“0X”开头，则基数为 16（十六进制）。
> *   如果输入`string`以“0”开头，则基数为八（八进制）。这个特性是非标准的，一些实现故意不支持它（而是使用基数 10）。出于这个原因**，在使用时总是指定一个基数`parseInt`**。
> *   如果输入`string`以任何其他值开头，则基数为 10（十进制）。

在这种情况下，指定基数至关重要，否则它可能被解释为十进制或八进制数。根据经验，始终指定基数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-26T20:32:02.857

这将采用缓冲区十六进制并将其转换为二进制 str 并返回到缓冲区十六进制。

注意：当我说缓冲区十六进制时，我指的是十进制值，因为当您遍历缓冲区并拉取数组中的每个项目时，它会为您提供十进制值（例如：210，而不是 d2）。

`var buffer - new Buffer([0, 210, 242]); // Node`

`// var arrayBuffer = new ArrayBuffer(3); // JavaScript`

`// var uint8 = new Uint8Array(arrayBuffer); // JavaScript/ 16Array, 32Array, etc`

需要熟悉缓冲区

您将使用 a 遍历缓冲区，`for(){}`并且在内部您可以执行以下操作：

`(210).toString(2); // '11010010'`

`(210).toString(16); // 'd2' (untested)`

`(210).toString(8); // (Octal-Digits representation)`

`parseInt((210).toString(2), 2); // 210`

`parseInt((210).toString(2), 2).toString(16); // 'd2'`

显然，不要使用“ `(210).toString(2)`”IN YOU FOR LOOP，而是使用“ `(buffer[i]).toString(2)`”

Endian 代表由您决定！:) (array.reverse())

希望这可以帮助！

PS。`parseInt(('00000' + (210).toString(2).substring(5, 8)), 2); // 2`

`parseInt((210).toString(2).substring(5, 8), 2); // 2`

# c++ - CPP中的定时器同步问题？

> ID：11103489
> 
> 赞同：0
> 
> 时间：2012-06-19T14:46:37.880
> 
> 标签：c++, timer, synchronization, timer-jobs

我有一个计时器类..这个计时器将从我的代码块的各个部分启动..我有另一个类来管理这个计时器，即 CTimerManager...这是一个静态类..所以我在这里面临的问题是当我取消初始化我的应用程序，我所有的计时器需要被破坏......但是由于我已经启动了许多计时器，当第一个计时器关闭时，内存变为 NULL，并且如果任何其他计时器处于活动状态并且它尝试访问内存异常发生（由于CTimerManager 的 singletn 实例）...任何人都知道如何面对这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:50:07.737

仅通过类的工厂方法创建计时器实例`CTimerManager`。这些计时器本质上与您的经理绑定，并且属于它，因此只有经理应该负责它们的创建和删除。

在您的经理类的析构函数中，您应该停止所有计时器并删除它们。这样，一旦经理被销毁，任何计时器都不会保持活动或活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T16:25:28.190

根据您的描述，您正在创建一个类，该类包含在给定时间后回调自身的计时器。当您销毁管理器时，计时器数据结构消失，然后计时器回调对象被销毁。

当您调用 CTimerManager 的析构函数时，您必须确保关闭所有计时器。

您是否使用线程然后调用睡眠？在这种情况下，每个计时器都需要定期检查一个标志，以查看计时器是否提前终止。然后在析构函数中设置一个标志以提前终止计时器并加入（）所有计时器线程。

如果您正在调用某些操作系统计时器回调，它可能具有取消计时器的功能。

# iphone - AVPlayer 未从音乐库播放

> ID：11103490
> 
> 赞同：5
> 
> 时间：2012-06-19T14:46:45.837
> 
> 标签：iphone, objective-c, avplayer

我正在尝试使用 AVPlayer 从我的 iPhone 音乐库中播放一首歌曲。一切似乎都可以播放了，但播放器根本不会发出任何声音。我已经为此苦苦挣扎了一段时间，任何帮助将不胜感激！

注意：我意识到我可以使用 AVAudioPlayer，但我想直接从我的音乐库中读取文件，据我了解，AVAudioPlayer 不支持（我必须先导出歌曲，占用更多时间）。我不能使用 MPMusicPlayerController 因为最终目标是将歌曲转换为 NSData 并在另一台设备上播放。

最重要的是，我想知道为什么这段代码没有播放：

```
NSArray *itemsFromQuery = [[MPMediaQuery songsQuery] items];
MPMediaItem *song = [itemsFromQuery objectAtIndex:29];
NSURL *songURL = [song valueForProperty:MPMediaItemPropertyAssetURL];
AVURLAsset *urlAsset = [[AVURLAsset alloc] initWithURL:songURL options:nil];

NSArray *keyArray = [[NSArray alloc] initWithObjects:@"tracks", nil];

[urlAsset loadValuesAsynchronouslyForKeys:keyArray completionHandler:^{

    AVPlayerItem *playerItem = [[AVPlayerItem alloc] initWithAsset:urlAsset];

    AVPlayer *player = [[AVPlayer alloc] initWithPlayerItem:playerItem];

    while (true) {
        if (player.status == AVPlayerStatusReadyToPlay && playerItem.status == AVPlayerItemStatusReadyToPlay) {
            break;
        }
    }

    if (player.status == AVPlayerStatusReadyToPlay && playerItem.status == AVPlayerItemStatusReadyToPlay) {
        NSLog(@"Ready to play");
        [player play];
    }
    else 
        NSLog(@"Not ready to play");
}]; 
```

输出为“Ready to play”，我调用play方法后AVPlayer的“rate”属性为1.0。MPMediaItem 存在，我可以使用 valueForProperty 方法来获取正确的标题、艺术家等。任何想法为什么播放器没有声音？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-22T21:44:18.377

发现了一些有用的东西：

1.  我将 AVPlayer 设为属性（感谢小费 meggar！）
2.  在使用 initWithAsset 方法之前，我确保 AVPlayer 为零。

    ```
    NSArray *itemsFromQuery = [[MPMediaQuery songsQuery] items];
    MPMediaItem *song = [itemsFromQuery objectAtIndex:0];
    NSURL *songURL = [song valueForProperty:MPMediaItemPropertyAssetURL];
    AVURLAsset *urlAsset = [[AVURLAsset alloc] initWithURL:songURL options:nil];

    NSArray *keyArray = [[NSArray alloc] initWithObjects:@"tracks", nil];

    [urlAsset loadValuesAsynchronouslyForKeys:keyArray completionHandler:^{

        AVPlayerItem *playerItem = [[AVPlayerItem alloc] initWithAsset:urlAsset];

        player = nil;
        player = [[AVPlayer alloc] initWithPlayerItem:playerItem];

        while (true) {
            if (player.status == AVPlayerStatusReadyToPlay && playerItem.status == AVPlayerItemStatusReadyToPlay)
                break;
        }

        [player play];

    }]; 
    ```

希望这可以帮助某人！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-12T13:47:54.873

另一个原因是配置 AVAudioSession。为我工作。

```
 [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
  [[AVAudioSession sharedInstance] setActive: YES error: nil]; 
```

# mysql - 在 Matlab 中使用 jdbc 连接 Mysql 时附加 dbname 的字符集字符串

> ID：11103493
> 
> 赞同：1
> 
> 时间：2012-06-19T14:46:49.673
> 
> 标签：mysql, matlab, jdbc

当让 Matlab 连接到远程 mysql 数据库服务器时，我试图设置字符集。

连接网址是这样的：

```
jdbc:mysql://host/mtdb?useUnicode=true&characterEncoding=UTF8 
```

并在执行后：

```
c = database("mydb", 'username', 'password','com.mysql.jdbc.Driver', "connection_string as above"); 
```

但是Matlab抛出了一个异常：

```
'Unsupported character encoding 'UTF8mydb'. 
```

我不明白为什么字符编码会附加`"mydb"`. 我在连接 url 格式中看不到任何语法错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T17:28:12.653

试试这个：

```
dbURL = 'jdbc:mysql://localhost/mydb?useUnicode=true&characterEncoding=UTF8';
conn = database('', 'user', 'pass', 'com.mysql.jdbc.Driver', dbURL)
curs = exec(conn, 'select * from table') 
```

# xhtml - 在 UTF-8 文件中找到字节顺序标记。W3C 验证错误

> ID：11103500
> 
> 赞同：0
> 
> 时间：2012-06-19T14:47:00.233
> 
> 标签：xhtml, w3c-validation, byte-order-mark

我创建了一个对严格 XHTML 有效并通过验证的网站，但 W3C 验证器告诉我我有一个注释（错误）：

> 在 UTF-8 文件中找到字节顺序标记。
> 
> 众所周知，UTF-8 编码文件中的 Unicode 字节顺序标记 (BOM) 会导致某些文本编辑器和旧版浏览器出现问题。在得到更好的支持之前，您可能需要考虑避免使用它。

但我的文件中没有 BOM。它是在 VS 中完成的直接 XHTML。

服务器添加了吗？我怎样才能摆脱错误？

这很重要，因为它搞砸了语义提取。[http://www.w3.org/2003/12/semantic-extractor.html](http://www.w3.org/2003/12/semantic-extractor.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:58:30.387

您的资源中确实有 BOM (EF BB BF)。考虑删除它，也许，使用一些十六进制编辑器。[如何从我的 xml 文件中删除 BOM 字符](https://stackoverflow.com/questions/295472/how-do-i-remove-the-bom-character-from-my-xml-file)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T17:38:14.743

W3C 标记验证器不会将 UTF-8 中的 BOM 指示为错误；如果这样做，它本身就是错误的，因为在 UTF-8 数据的开头允许使用 BOM。它发出警告。

该警告已严重过时。多年来在相关浏览器中未发现任何问题。相反，BOM 应该被认为是有用的，因为例如，如果文件保存在本地（因此 HTTP 标头丢失，UTF-8 格式的 BOM 让浏览器可以推断出，实际确定性，该文档是 UTF-8编码。

Semantic 数据提取工具不是很新，而且它的方法过于理论化，但它在 UTF-8 数据开头的 BOM 似乎没有任何问题。

可能是服务器添加了 BOM，或者您的创作工具添加了它。无论哪种方式，它都应该被认为是有用的，而不是一个问题。

# css - 使用没有表格的 CSS 定位按钮

> ID：11103503
> 
> 赞同：0
> 
> 时间：2012-06-19T14:47:02.950
> 
> 标签：css, css-float

我在这里拉头发，试图让 CSS 只定位少数几个 html 元素。

这是代码：http: [//jsfiddle.net/7pTL8/](http://jsfiddle.net/7pTL8/)

我想要的是“person@business.com [v]”位于右上角，然后在其下方“平均深度”、“[x] 设置”和“过去 24 小时 [v]”都显示一起处于同一水平。我试过浮动，结果很奇怪。我不想在这里使用表格，因为我读到的关于 CSS 的所有内容都建议使用表格进行布局是一个糟糕的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:11:32.050

它不像你想的那样凝灰岩..这是一个小解决方案..它不是很好但它现在可以解决你的问题..

[链接] [http://jsfiddle.net/7pTL8/2/](http://jsfiddle.net/7pTL8/2/)

```
<div id="user-selection">person@business.com [v]</div>
<div id="settings-container">
 <h1 id="graph-title">Average Depth</h1>
<span id="settings-button">[x] Settings</span>
<span id="timeframe-dropdown">Past 24 hours [v]</span>
</div> 
```

CSS

```
​#graph-title {
   position:absolute;
   left:1px;
   text-align: left;
}

#settings-container {
   text-align: right;
   }    

 #user-selection {
    text-align: right; 
  } 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:50:27.567

`<span>`元素使用`display:inline`，而`<h1>`元素`block`默认使用。手动覆盖要使用的#graph-title，`display:inline`它将与您的其余元素对齐：

```
#graph-title
{
    display:inline;       
}
​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T14:54:07.770

您的问题可能是`h1`元素的使用。默认情况下`h1`具有样式`display: block`. 如果添加样式`display: inline`就可以了。

**编辑：**`span`如果您没有任何特殊原因， 我认为您应该使用它。

# macos - 在 Mac 上构建 Qt 消息传递框架

> ID：11103504
> 
> 赞同：0
> 
> 时间：2012-06-19T14:47:07.193
> 
> 标签：macos, qt, qt-mobility

我正在尝试从 OS X 10.6 上的 Git 源代码构建最新版本的 QMF，但我一直遇到此错误：

```
"QPrivatelyImplemented<QMailMessageBodyPrivate>::~QPrivatelyImplemented()", referenced from:
  QMailMessageBody::~QMailMessageBody()in qmfstoragemanager.o
  QMailMessageBody::~QMailMessageBody()in qmfstoragemanager.o
  PartStorer::operator()(QMailMessagePart const&)in qmfstoragemanager.o
  PartLoader::operator()(QMailMessagePart&)in qmfstoragemanager.o
 "QPrivatelyImplemented<QMailMessageHeaderFieldPrivate>::~QPrivatelyImplemented()", referenced from:
  QMailMessageContentType::~QMailMessageContentType()in qmfstoragemanager.o
  QMailMessageContentType::~QMailMessageContentType()in qmfstoragemanager.o
  ReferenceLoader::operator()(QMailMessagePart&)in qmfstoragemanager.o
  PartLoader::operator()(QMailMessagePart&)in qmfstoragemanager.o
"QPrivatelyImplemented<QMailMessagePartContainerPrivate>::~QPrivatelyImplemented()", referenced from:
  QMailMessage::~QMailMessage()in qmfstoragemanager.o
"QPrivatelyImplemented<QMailMessageMetaDataPrivate>::~QPrivatelyImplemented()", referenced from:
  QMailMessage::~QMailMessage()in qmfstoragemanager.o
 "QPrivatelyImplemented<QMailMessageMetaDataPrivate>::operator=(QPrivatelyImplemented<QMailMessageMetaDataPrivate> const&)", referenced from:
  QmfStorageManager::load(QString const&, QMailMessage*) in qmfstoragemanager.o
"QPrivatelyImplemented<QMailMessagePartContainerPrivate>::operator=(QPrivatelyImplemented<QMailMessagePartContainerPrivate> const&)", referenced from:
  QmfStorageManager::load(QString const&, QMailMessage*) in qmfstoragemanager.o
ld: symbol(s) not found for architecture x86_64 
```

但是，它确实可以在 Ubuntu 下完美编译，而且我已经足够肯定我之前已经在 OS X 上编译过，所以我有点困惑，没有找到明显的符号通常意味着缺少一些源代码，任何人都遇到过这个我开始撕开它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T13:01:58.707

发生此错误是因为编译器从库中省略了未引用的类。**我能够通过在src\libraries\qmfclient\qmailinstantiations.cpp**中的所有显式模板实例化（或只是将其添加到文件末尾）添加以下代码来解决此问题：

```
class reference_holder
{
    struct helper
    {
        helper(QPrivatelyImplemented<QMailMessageBodyPrivate>* = 0)
        {
        }

        ~helper()
        {
        }
    };

    static helper helper_;

    static void use_helper()
    {
        (void)helper_;
    }

    template<void(*)()>
    struct helper2 {};

    static helper2<&reference_holder::use_helper> helper2_;
}; 
```

# c++ - 有没有办法让 MSAA IAccessible 遍历更快？

> ID：11103505
> 
> 赞同：4
> 
> 时间：2012-06-19T14:47:11.267
> 
> 标签：c++, winapi, accessibility, msdn

现在我有这个 C++ 函数（删除了安全检查和一些代码以使其更具可读性）：

```
HRESULT WalkTreeWithAccessibleChildren(wstringstream *ss, IAccessible* pAcc, int depth)
{
    long childCount;
    long returnCount;   

    VARIANT* pArray = new VARIANT[childCount];
    hr = AccessibleChildren(pAcc, 0L, childCount, pArray, &returnCount);
    for (int x = 0; x < returnCount; x++) {
        VARIANT vtChild = pArray[x];
        Get the role and name of the component here
        // If it's an accessible object, get the IAccessible, and recurse.
        if (vtChild.vt == VT_DISPATCH) {
            IDispatch* pDisp = vtChild.pdispVal;
            IAccessible* pChild = NULL;
            hr = pDisp->QueryInterface(IID_IAccessible, (void**) &pChild);
            WalkTreeWithAccessibleChildren(ss, pChild, depth + 1);
    }
} 
```

对于一些组件相对较少（200 个左右）的程序，例如 Paint.NET，这大约需要 2 秒，有没有办法可以让这个功能更快，在一个 COM 调用中获取所有组件或类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:53:31.710

这在某种程度上取决于您要做什么。

如果您正在寻找特定项目，有时可以使用导航（accNavigate）更快地找到项目，而不是浏览所有项目。

如果您确实需要获取所有项目，则后台线程效果很好。

另一种选择是使用 UIAutomation api，它仍然支持所有 IAccessible 服务器，并且内置了更丰富的缓存和过滤。在 MSDN 上查找 IUIAutomationCacheRequest 及其方法 TreeFilter 和 TreeScope 以获取更多信息。如果您处于特定项目案例中，它还可以搜索特定项目。

将 UIAutomation 视为 IAccessible 的超集。UIAutomation 在 Vista SP2 及更高版本上可用。

# php - Internet Explorer，jQuery，会话丢失 php

> ID：11103507
> 
> 赞同：0
> 
> 时间：2012-06-19T14:47:11.423
> 
> 标签：php, jquery, internet-explorer, session

我有一个不寻常的问题。我正在开发一个网站，女巫在负载均衡器后面。我们有 4 个前端。由于某种原因，在 Internet Explorer 中，会话丢失。我们正在使用数据库会话，它可以在所有其他浏览器中运行。经过几天的调试，我从 JS 文件中删除了以下行：

```
$('div').each(function(){
    console.log($(this));
    if($(this).attr('role') == 'dialog') {
        $(this).addClass('callmenow_wrapper');
    }
    if($(this).attr('class') == 'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix') {
        $(this).addClass('callmenow_title');
    }
    if($(this).attr('class') == 'ui-dialog-buttonpane ui-widget-content ui-helper-clearfix') {
        $(this).removeClass('ui-widget-content');
    }
    $('button').addClass('button-call-popup');
}); 
```

现在一切都按预期工作。如果我把这行放回 IE 中，会话将丢失。如果有人遇到过这样的事情，请指教。

谢谢你。

PS：我阅读了大量的文档和类似的问题。我已经设置了 P3P 标题等。在我删除这些行之前没有任何效果。

# php - set_include_path() 用于 CLI 的子目录？

> ID：11103510
> 
> 赞同：1
> 
> 时间：2012-06-19T14:47:21.763
> 
> 标签：php, zend-framework, command-line-interface, autoload, include-path

我在应用程序中使用 Zend Framework 1.11。我正在尝试实施[手册建议的性能升级，](http://framework.zend.com/manual/en/performance.classloading.html)以消除不必要的 require_once() 语句并完全自动加载。这在正常应用程序中工作正常。

我还有一个 CLI 接口，我为守护进程编写了代码（通过 Bootstrap.php 中的自定义路由器），它似乎不想与我的更改配合得很好。它与我设置的包含路径有关，该路径当前在我的 index.php ZF 入口点中配置：

```
set_include_path(implode(PATH_SEPARATOR, array(
   realpath(APPLICATION_PATH . '/../library/'),
   get_include_path(),
))); 
```

库文件夹的布局如下：

```
- library
   -Zend
      -Acl
      -Amf
       ... etc, Zend Framework files
   -Custom
      -Api
      -Twitter
       ... etc, My Custom library files 
```

通过 CLI 运行应用程序时，它无法在这些目录或子目录中找到任何文件。所以我改变了我的包含路径看起来像：

```
set_include_path(implode(PATH_SEPARATOR, array(
   realpath(APPLICATION_PATH . '/../library/'),
   realpath(APPLICATION_PATH . '/../library/Custom/Twitter/'),
   get_include_path(),
))); 
```

然后它能够​​找到我需要的文件。

**TL;博士;** 我在这些库中有很多文件，如果我必须手动将每个文件夹放入包含路径，我可能从自动加载中获得的任何性能提升都会消失。有没有更好的办法？

PS 一时兴起，我也尝试了**/../library/***之类的路径，但这也不起作用。

# module - NGINX Header 和 Body 过滤器模块

> ID：11103514
> 
> 赞同：6
> 
> 时间：2012-06-19T14:47:32.560
> 
> 标签：module, filter, nginx

我一直在编写一个 NGINX 过滤器模块，它可以读取/写入传入请求的 cookie。如果某个特定的 cookie 设置不正确（即身份验证 cookie），它会将传出的标头状态设置为适当的错误代码。[根据Evan Miller's tutorial](http://www.evanmiller.org/nginx-modules-guide.html#filters-header)的指示，这可以正常工作。我试图开始工作的下一部分（到目前为止还没有）是调用正文过滤器，以便在遇到错误响应时插入/替换正文响应文本。我再次按照[Evan Miller 的关于身体过滤器的教程](http://www.evanmiller.org/nginx-modules-guide.html#filters-body)进行操作，但我终生无法完成这项工作。这是我的设置：

```
static ngx_http_output_header_filter_pt ngx_http_next_header_filter;
static ngx_http_output_body_filter_pt ngx_http_next_body_filter;
...
...

static ngx_http_module_t ngx_http_source_cookie_module_ctx = {
    NULL,                             /* preconfiguration */
    ngx_http_source_cookie_init,             /* postconfiguration */

    NULL,                             /* create main configuration */
    NULL,                             /* init main configuration */

    NULL,                             /* create server configuration */
    NULL,                             /* merge server configuration */

    ngx_http_source_cookie_create_loc_conf,  /* create location configuration */
    ngx_http_source_cookie_merge_loc_conf    /* merge location configuration */
};

ngx_module_t ngx_http_source_cookie_module = {
    NGX_MODULE_V1,
    &ngx_http_source_cookie_module_ctx,      /* module context */
    ngx_http_source_cookie_commands,         /* module directives */
    NGX_HTTP_MODULE,                  /* module type */
    NULL,                             /* init master */
    NULL,                             /* init module */
    NULL,                             /* init process */
    NULL,                             /* init thread */
    NULL,                             /* exit thread */
    NULL,                             /* exit process */
    NULL,                             /* exit master */
    NGX_MODULE_V1_PADDING
};
/*--------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------*/
static ngx_int_t
ngx_http_source_cookie_header_filter(ngx_http_request_t *r)
{
   // this gets invoked
   ...
}

/*--------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------*/
static ngx_int_t
ngx_http_body_filter(ngx_http_request_t *r, ngx_chain_t *in)
{
   // this never get invoked
   ...
}

/*--------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------*/
static ngx_int_t
ngx_http_source_cookie_init(ngx_conf_t *cf)
{
    // registering of my filters

    ngx_http_next_header_filter = ngx_http_top_header_filter;
    ngx_http_top_header_filter = ngx_http_source_cookie_header_filter;

    ngx_http_next_body_filter = ngx_http_top_body_filter;
    ngx_http_top_body_filter = ngx_http_body_filter;

    return NGX_OK;
} 
```

这是我的基本设置，据我所知，它出现在我遇到的所有示例/教程中。我想知道我是否需要启用一些完全不同的东西......比如 NGINX 配置选项、NGINX ./configure 编译选项等。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T11:38:03.927

我注意到 Evan 没有在`ngx_http_<module_name>_header_filter()`.

如果我不添加 http 内容长度（`r->headers_out.content_length_n`），插入到请求末尾的文本将不会从 nginx-1.2.7 stable 输出。

您还可以看到[页脚过滤器模块](https://github.com/alibaba/nginx-http-footer-filter)。

# python - Python wxImage：将图像保存为 wx.BITMAP_TYPE_BMP

> ID：11103525
> 
> 赞同：0
> 
> 时间：2012-06-19T14:47:48.397
> 
> 标签：python, wxpython

我正在尝试保存在运行时生成的图像。这适用于 wx.BITMAP_TYPE_JPEG 和 ..._PNG，但不适用于 wx.BITMAP_TYPE_BMP 和 ..._GIF。

这是代码：

```
imgName = 'test.png'
imgType = wx.BITMAP_TYPE_BMP
img = wx.EmptyImage(width, height)
[...]
img.SaveFile(imgName, imgType) 
```

我也尝试通过初始化其他处理程序，`wx.InitAllImageHandlers()`但这也不起作用。

`.SaveFile(...)`不断返回`False`，生成的 bmp 大小为 0 字节，尽管图像应该包含数据。

我的代码有什么问题还是可能有其他问题？

提前致谢

# javascript - 页面刷新后如何保持 ExtJs App 活着

> ID：11103526
> 
> 赞同：1
> 
> 时间：2012-06-19T14:47:48.847
> 
> 标签：javascript, cookies, extjs, extjs4, refresh

页面刷新后显示 ExtJs 应用程序的最佳方式是什么？

示例：位于 x,y 位置的窗口带有一些面板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:58:18.610

查看`stateId`属性以及如何在 ExtJs 中保存状态：[http ://docs.sencha.com/ext-js/4-0/#!/api/Ext.state.Stateful-cfg-stateful](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.state.Stateful-cfg-stateful)

# javascript - 如何在移动应用程序中使用 javascript 向上和向下旋转图像？

> ID：11103542
> 
> 赞同：0
> 
> 时间：2012-06-19T14:48:50.217
> 
> 标签：javascript, jquery, image, mobile, rotation

目前我正在尝试做的是旋转图像，如椅子或桌子，当用户

触摸图像并向上或向下拖动，他们将能够看到顶部和底部

那把椅子或桌子。有人可以给我一个解决方案或任何可以帮助我的参考吗

完成这个任务？非常感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:04:04.983

如果您使用的是 jQuery Mobile（我假设您是因为您在帖子中应用的标签），请尝试使用 Touch 事件。具体来说，尝试`taphold`.

[jQuery 手机 >](http://jquerymobile.com/demos/1.1.0/docs/api/events.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T07:16:31.570

对于触摸和拖动，您可以使用 touchstart/touchmove/touchend 事件。您可以从 Apple 的开发者网站轻松找到有关触控事件的文档。iOS 和 Android 都支持触摸事件。

因为触摸和拖动是一种手势，你可能想看看是否有任何库实现了这个手势。手势是触摸与限制的组合。当然，您可以使用触摸事件和大量 JavaScript 代码定义手势，但重用其他人编写和测试的内容会更容易。看看你是否能在 jQuery Mobile、Sencha 或 Pointer.js 中找到任何有用的东西。

图像旋转可以通过 CSS3 变换来完成。您可以从 Apple 的开发者网站或 Google 搜索轻松获取有关转换属性的信息。如果可用，请使用 3D 变换而不是 2D，因为在大多数设备中，3D 变换是硬件加速的，而 2D 不是。

# apache-flex - 在 mx.flash.UIMovieClip 中非法覆盖 UIMovieClip

> ID：11103543
> 
> 赞同：0
> 
> 时间：2012-06-19T14:48:50.643
> 
> 标签：apache-flex, flash, runtime-error

我不知道如何解决这个问题......请帮忙。

我有加载另一个 Flex SWF 的 Flex 应用程序。一年后我已经更改了正在加载的 SWF，我还没有碰过它。一切正常，但更改后突然，当加载 SWF 时，它卡住了，我收到错误：

**VerifyError：错误 #1053：在 mx.flash.UIMovieClip 中非法覆盖 UIMovieClip。**

就是这样，它没有给我更多关于问题出在哪里的线索。

我希望有人可以帮助我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:02:09.153

看起来 UIMovieClip 与您编译的 UIMovieClip 来自不同的版本。UIMovieClip 的实现可能从 3.ab 到 3.xy 不同

# android - Android - 扩展 BasicNameValuePair

> ID：11103544
> 
> 赞同：0
> 
> 时间：2012-06-19T14:48:51.827
> 
> 标签：android, database

我正在尝试开发一个通过 POST 请求访问数据库并在数据库中返回值的应用程序。

我对某事很好奇。如果我想将一个数字或一个列表传递给数据库，例如要为每一行抓取的列列表，该怎么办？是否可以扩展 BasicNameValuePair 类来完成这个，或者我错过了正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:10:07.497

扩展 对`BasicNameValuePair`您没有帮助，因为 HTTP 请求的参数需要是名称值对。如果要传递更多的参数，添加更多的名称值对并在服务器中处理它们。

如果参数数量较多，则谨慎使用 HTTP POST。如果参数会很复杂，最好以更用户友好的格式（如 JSON 或 XML）提交请求并在服务器端解析它。但是，如果只是表格行的列名，也可以考虑使用逗号分隔列表之类的格式。

`http://mydomain/getdata?id=10&columns=1,2,3,4`

在上述情况下，您需要在服务器端解析逗号分隔列表中的列，而您正在为列创建名称-值对，如下所示：

```
BasicNameValuePair columnData = new BasicNameValuePair("columns", "1,2,3,4"); 
```

# excel - 将 Excel 2007 VBA 转换为 Excel 2003

> ID：11103547
> 
> 赞同：2
> 
> 时间：2012-06-19T14:48:56.727
> 
> 标签：excel, vba, excel-2003

我正在尝试调整我为 Excel 2007 编写的 xla 加载项以在 Excel 2003 中工作。我已对大部分问题进行了排序，但我无法找到对工作表中的字段进行排序的方法。我有需要按创建日期顺序排序的数据行（其值在 H 列中）。这是我使用的 Excel 2007 代码：

```
 'sort issues into descending order
        Sheets("In Progress").Sort.SortFields.Clear
        Sheets("In Progress").Sort.SortFields.Add _
                Key:=Range("H:H"), _
                SortOn:=xlSortOnValues, _
                Order:=xlDescending, _
                DataOption:=xlSortNormal
        With Sheets("In Progress").Sort
            .SetRange Range("A2:M" & rowCount - 1)
            .Header = xlNo
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With 
```

任何人都可以帮助我让它与 Excel 2003 一起使用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:59:32.133

最好的方法是在较低版本中编写代码，以便它适用于所有版本。

我将使用此代码进行排序，这将适用于所有版本。

```
With Sheets("In Progress")
    .Range("A2:M" & rowCount - 1).Sort Key1:=.Range("A2"), _
    Order1:=xlDescending, Header:=xlNo, _
    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
    DataOption1:=xlSortNormal
End With 
```

# c# - 从一个数据库表中读取并将其存储在 2 个对象中

> ID：11103548
> 
> 赞同：1
> 
> 时间：2012-06-19T14:48:57.240
> 
> 标签：c#, asp.net, sql-server, visual-studio-2010, web

**这是有问题的两种方法**

我想返回 csVehicle 和 csDistributor 的对象，因为我下面的代码只返回 csVehicle

请帮忙

```
public List<csVehicle> get_All_Vehicles()
{            
    var objv = new List<csVehicle>(); 
    IDataReader dr = null;
    var objdal = new csDAL();
    dr = objdal.executespreturndr("sp_Get_All_Distributor");
    while (dr.Read())
    {
        var d = new csDistributor();     // I put this here so that I can use the propDistrbutorId
        var v = new csVehicle();
        populate_Data(dr, d,v);
        objv.Add(v);                    //It only adds object of csVehicles and csDistributor is not added
    }
    return objv;                        // csDistributor is not returned
} 
```

populate_Date 方法将数据添加到两个对象 csDistributor 和 csVehicle

```
private void populate_Data(IDataReader dr, csDistributor d, csVehicle v)
{
    v._vehicleRegNo = dr["VehicleRegNo"].ToString();
    d.propDistrbutorId = Convert.ToInt32(dr["DistrbutorId"]);                      
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:56:57.050

这是一个简单的解决方案：

```
public List<object> get_All_Vehicles()
{            
    var objv = new List<object>(); 
    IDataReader dr = null;
    var objdal = new csDAL();
    dr = objdal.executespreturndr("sp_Get_All_Distributor");
    while (dr.Read())
    {
        var d = new csDistributor();
        var v = new csVehicle();
        populate_Data(dr, d,v);
        objv.Add(v);                
        objv.Add(d);    
    }
    return objv;                        
} 
```

更复杂的解决方案是定义一个父类，csDistributor 和 csVehicle 都从该类继承，然后返回`List<>`该特定类型的 a。

或者使用一个`ArrayList`，它只是一个无类型的对象集合。

**编辑：**我不得不猜测您的代码是如何在其他地方使用的，但试试这个：

```
public void get_All_Vehicles(out csVehicle vehicle, out csDistributor distributor)
{            
    vehicle = new List<csVehicle>(); 
    distributor = new List<csDistributor>();
    IDataReader dr = null;
    var objdal = new csDAL();
    dr = objdal.executespreturndr("sp_Get_All_Distributor");
    while (dr.Read())
    {
        var d = new csDistributor();
        var v = new csVehicle();
        populate_Data(dr, d,v);
        vehicle.Add(v);                
        distributor.Add(d);    
    }
} 
```

# iphone - 应用内购买重新获得

> ID：11103552
> 
> 赞同：1
> 
> 时间：2012-06-19T14:49:10.093
> 
> 标签：iphone, ipad, in-app-purchase

如果客户在新 iPhone 上重新安装应用程序，是否有办法重新获取客户已经购买的应用程序内购买？这样就省去了客户再过一遍购买流程，才知道自己已经购买了？

谢谢

适合

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:55:46.160

看看`SKPaymentQueue`类和方法`restoreCompletedTransactions`

# c# - Selenium WebDriver IE6 启用代理问题

> ID：11103554
> 
> 赞同：0
> 
> 时间：2012-06-19T14:49:12.153
> 
> 标签：c#, .net, internet-explorer, selenium, webdriver

我有一些使用 Selenium WebDriver 创建的测试。当我在没有代理的情况下使用 IE 运行它们时 - 它的效果很棒，但是当我尝试打开代理（自动检测设置）时，Selenium 无法识别对象。我收到错误消息：“无法找到元素”

有没有其他人遇到同样的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T13:11:15.970

问题在于具有袜子配置参数的“自动检测设置”功能。不知何故，它阻止了浏览器的一些 selenium 交互通道。

# ruby-on-rails - rails composite_primary_key 的问题

> ID：11103558
> 
> 赞同：2
> 
> 时间：2012-06-19T14:49:18.673
> 
> 标签：ruby-on-rails, undefined-behavior, composite-primary-key, flatten, fixnum

我正在尝试使用 rails 和 postgresql 创建复合主键。我已经清楚地遵循了 gem Composite_primary_keys 文档中的说明。

当我执行“puts modelname.primary_keys”时，我得到了我为其创建复合主键的列。

但问题是，当我尝试通过给出以下命令将数据插入模型时：

```
m = classname.new
m.id = 10   # One of the columns in composite primary key
m.another_table_id = 5 # the second column in composite primary key
m.name = "Test"
m.save

I'm getting "undefined method 'flatten!' for 1:Fixnum
path/composite_primary_keys/base.rb:134in 'id=' " 
```

所以请告诉我出了什么问题。或者请给我一个使用composite_pirmary_keys 的示例项目的链接。

提前致谢。森提尔。

# c# - 是什么导致系统发出蜂鸣声？

> ID：11103561
> 
> 赞同：4
> 
> 时间：2012-06-19T14:49:32.343
> 
> 标签：c#, system, beep, keyeventargs

这就是我用来允许输入按钮开始搜索的方法。它可以工作，但会导致系统发出哔哔声。我不知道为什么。

```
 private void searchbox_KeyUp(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Enter)
        {
            searchbutton.PerformClick();
        }
        else
        {
            //Run.
        }

    } 
```

一旦我按下回车而不是代码中的其他行，它就会发生。对我缺少什么的想法？

这是searchbutton_Click：

```
 private void searchbutton_Click(object sender, EventArgs e)
    {
        var searchvar = searchbox.Text;
        SqlParameter var1 = new SqlParameter(@"var1", SqlDbType.Text);
        var1.Value = "%" + searchvar + "%";
        var conn = new SqlConnection("Data Source=TX-MANAGER;Initial Catalog=Contacts;Integrated Security=True");
        var comm = new SqlCommand(@"SELECT [Name ID], First, Last, Address, City, State, ZIP FROM contacts WHERE (First LIKE @var1) OR (Last LIKE @var1)", conn);
        if (checkBox1.Checked == true)
        {
            comm.CommandText += "ORDER BY ZIP";
        }
        else
        {
            //Run.
        }
        try
        {
            comm.Parameters.Add(var1);
            conn.Open();
            comm.CommandType = CommandType.Text;
            SqlDataAdapter da = new SqlDataAdapter(comm);
            DataTable dt = new DataTable();
            da.Fill(dt);
            dataGridView1.DataSource = dt;
            conn.Close();
        }
        catch (Exception e1)
        {
            display_box.Text = e1.ToString();
            tabControl1.Focus();
        }
        finally
        {
            int rowcount = dataGridView1.RowCount - 1;
            count.Text = rowcount.ToString();
            tabControl1.SelectedTab = tabPage2;
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:56:35.270

您可以尝试`e.Handled = true;`为`KeyPressed`您的`TextBox`.

通常，如果您`Form`没有`AcceptButton`设置其属性，则在`TextBox`. 哔声表示没有为您的`Form`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:04:02.160

添加以下事件处理程序（除了`KeyUp`）：

```
private void searchbox_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == '\r')
        e.Handled = true;
} 
```

也就是说，订阅`KeyPress`事件并且当`Enter`被按下时，设置`e.Handled`为`true`。我刚刚在我的机器上测试了它并且它有效；它消除了哔哔声。

# c++ - MFC .exe 和 .dll 为相同的代码产生不同的结果

> ID：11103563
> 
> 赞同：2
> 
> 时间：2012-06-19T14:49:37.207
> 
> 标签：c++, delphi, visual-studio-2008, dll, mfc

我的工作遇到了以下问题：有两个项目：基于相同源代码的 MFC .dll 和 MFC .exe（当然入口点除外），我观察到它们在处理相同数据时产生的不同结果。我检查了两者的所有项目设置，发现所有项目属性都相似（至少那些我认为很重要的）。在运行了几次测试后，我了解到以下内容：

1.  MFC .exe 在“调试”和“发布”模式下对同一数据集产生相同的结果
2.  MFC .dll在同一数据集上为“调试”和“发布”模式产生**不同的结果**
3.  .dll 的“发布”结果与 .dll 的“调试”结果不匹配，也与 .exe 的“调试”或“发布”结果不匹配。

我想 .exe 工作正常只是因为它为两种编译器配置提供了相同的结果，但我无法确定这一点。那么，如何解决 .dll 'Release' 配置的问题呢？我的意思是，我怎么能强迫它与其他人一致？什么可以解释这种行为？

**编辑**

我猜出现问题是因为我使用了在 Delphi 上编写的主机应用程序。我什至创建了新的 C++ exe 来测试这个建议，发现它运行正常，没有任何错误。唯一的区别是创建要在 Delphi 应用程序中使用的 DLL 我将其标记为**extern "C"**，但对于 C++ 应用程序我只写了**extern**。可以在[此处](https://stackoverflow.com/questions/10933998/problems-with-postmessage-from-c-dll-to-delphi-forms-application/10938781#10938781)找到有关此主题的另一个讨论的详细信息。但是，如果尝试使用只有**extern**标记的 DLL，而没有**"C"**，我的 Delphi 应用程序会报告函数入口点无法位于那里......现在对我来说这是一个大问题，为什么会发生这种情况......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:56:35.840

检查每个主机的 8087 控制字的值。我很确定 Microsoft C 使用的值与 Delphi 使用的值不同。在较新的 Delphi 版本中，您拥有诸如 Set8087CW 之类的函数以及诸如 SetPrecisionMode 和 SetRoundMode 之类的包装器。但是您可能希望在 DLL 中专门设置它们，然后在计算结束时将它们恢复为原始值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T16:16:06.353

如果没有一些代码示例，很难回答这个问题。但是要考虑的一件事是，您的数据处理代码是否使用了调用处理器的代码也使用的全局数据结构。

Dll 创建自己的独立地址空间，默认情况下可以访问一组不同的全局数据结构。

假设您有一个全局表，用于将在主代码和处理代码中使用的结果制成表格。

在所有在一个 exe 中的版本中，它们都将使用同一个表。在 dll 版本中，处理 dll 将使用一组全局变量，并且链接到它的 exe 使用不同的版本。

# javascript - JS/Knockout 无限滚动 - 滚动条跳转到页面顶部

> ID：11103566
> 
> 赞同：2
> 
> 时间：2012-06-19T14:49:40.860
> 
> 标签：javascript, knockout.js, scroll, infinite-scroll

所以我有一大块用 js 编写的代码，或多或少地检查滚动条相对于文档/窗口大小的位置。如果它在底部附近，它将触发函数调用。

一切都很好，直到我开始编写函数，该函数实际上将在当前显示的数据下加载额外的页面/数据。

以下是目前在加载额外数据的函数中编写的内容：

```
var appendData = function () {
    _loading(true);
    spinner.spin(spinnerTarget);
    FC.WebAPI.RouteTemplates.GetTemplates({ "criteria": _searchTerm(), "pageNumber": dataGridViewModel.currentPage(), "pageSize": dataGridViewModel.pageSize(), "filter": Filter.toODataString(filterViewModel.selectedFilters()), "orderBy": _getSortODataString() }).execute(function (response) {
        _data.concat(response.Results);
        spinner.stop();
        _loading(false);
        if (_searchTerm().trim() != "") {
            setTimeout(function () {
                var terms = _searchTerm().split();
                for (var i = 0; i < terms.length; i++) {
                    $('.routedetails span').highlight(terms[i]);
                }
            }, 200);
        }

    }, function (fail) {
        spinner.stop();
        _loading(false);
    });
} 
```

在实现无限滚动功能之前，它被用作一个简单的 Next 按钮，为了让所有内容都在同一页面上而不是加载新页面，我们添加了

```
_data.concat(response.Results); 
```

每当调用该函数时，它似乎将滚动条跳到屏幕顶部，而不是或多或少地保持相同的位置。不知道为什么它有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-11T15:10:02.647

我曾经遇到过这个问题，这是因为屏幕顶部有一个控件具有焦点。在加载页面过程中，我在该控件上调用了 $(element).blur()，问题就消失了。

# c# - 为什么这一行会抛出类型初始化失败的异常？

> ID：11103568
> 
> 赞同：1
> 
> 时间：2012-06-19T14:49:46.660
> 
> 标签：c#, asp.net, .net, c#-4.0, asp.net-4.0

我有一堂课：

```
public class Constant
{

    public static string ConnString = ConfigurationManager.ConnectionStrings["ConnString"].ConnectionString;
} 
```

这将在 LIVE 上引发异常：常量 ctor 的类型初始化失败

如果我将课程更改为：

```
public class Constant
{
    public static string ConnString
    {
        get
        {
            return ConfigurationManager.ConnectionStrings["ConnString"].ConnectionString;
        }
    }
} 
```

有用。我在这之后浪费了 2 个小时，但我仍然不知道为什么会发生这种情况。有任何想法吗？

**注意：**第一堂课以前在 DEV 环境下工作，但不是在 LIVE 上工作。第二类在 DEV 和 Production 上工作。

我在生产和 Asp.Net 4.0 网站项目中使用 VS2010。

至少可以说，我对这种不一致感到非常惊讶！

**编辑：**这个类在`App_Code`文件夹中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:52:52.467

我认为主要区别在于：

*   第一个是在`Constant`类初始化时计算的
*   第二个是在第一次`ConnString`访问属性时评估的（所以初始化阶段可能已经完成）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:53:06.393

显然这条线

```
ConfigurationManager.ConnectionStrings["ConnString"].ConnectionString 
```

将在 LIVE 上引发异常。

然而，在第一种情况下，这发生在您的类构造函数中，因此类型初始化失败。

在第二种情况下，异常会延迟到您使用该属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:55:08.593

很可能无论出于何种原因，在第一个示例中初始化 Constant 时，ConfigurationManager 都没有初始化。但是，Class 2 会在实际需要时去获取 ConfigurationManager 中的属性，而不是在初始化您的 Constant 类时。

# asp.net - asp.net 中的 HTTP 到 HTTPS 重定向不起作用

> ID：11103569
> 
> 赞同：0
> 
> 时间：2012-06-19T14:49:48.740
> 
> 标签：asp.net, https

我们有一个简单的要求，即对 asp.net 4.0 Web 应用程序中的某些特定页面使用 https。为了检查我们的实现，我们将一个简单的 asp.net 4.0 应用程序部署到 IIS 7。该应用程序已被编码为基于 web.config 标志通过 https 将 default.aspx 页面重定向到 securepage.aspx。

```
protected void Page_Load(object sender, EventArgs e)
    {
        Uri requestUri = Page.Request.Url;
        UriBuilder builder = new UriBuilder("https", requestUri.Host, requestUri.Port, "SecurePage.aspx");
        string secureUrl = builder.Uri.ToString();

        if (bool.Parse(ConfigurationManager.AppSettings["UseSecure"]))
        {
            Response.Redirect(secureUrl, true);
        }
        else
        {
            Response.Write(secureUrl);
        }
    } 
```

但是我们在 IIS 7 上部署这个应用程序并加载 default.aspx 页面后，它显示“Internet Explorer 无法显示网页”。但是如果我们关闭配置标志，它会正确显示页面。该应用程序在端口 82 上具有 http 绑定，在端口 444 上具有 https 绑定。

谁能指出我们哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:58:41.587

当您在前面键入时`https`，浏览器将继续使用端口`443`而不是 444，因此要在您的自定义端口上移动，您需要将其键入为。

```
UriBuilder builder = new UriBuilder("http", requestUri.Host, 444, "SecurePage.aspx"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:58:44.363

您正在通过 requestUri.Port 使用当前请求的端口，它返回 80。您应该硬编码 444：

```
UriBuilder builder = new UriBuilder("https", requestUri.Host, 444, "SecurePage.aspx"); 
```

或者，如果端口更改，请使用可配置变量。

# java - 无法在 Kendo ui 移动应用程序中访问 Web 服务

> ID：11103572
> 
> 赞同：0
> 
> 时间：2012-06-19T14:49:54.450
> 
> 标签：java, android, web-services, kendo-ui

有人可以帮我吗伙计。我正在尝试为我的公司创建一个简单的移动应用程序。因为它必须是一个独立于平台的应用程序，所以我决定使用带有电话间隙的新 Kendo ui。

一切似乎都运行良好但我无法在移动模拟器中访问任何类型的网络服务。我在 Windows 7 PC 上使用 android 模拟器。我也在 AndroidManifest.xml 文件中授予了 Internet 权限。这是我的 Kendoui 访问服务

```
TaskManager.DataAccess = {}

TaskManager.DataAccess._sprints = null;

TaskManager.DataAccess.getSprints = function(callback) {
  try {

    if (TaskManager.DataAccess._sprints == null) {
        $.ajax({
            url: "http://localhost/TaskManager.Mvc/Mobile/Sprints",
            dataType: "jsonp",
            jsonp: "d",
            cache: false
        })
        .done(function (response) {
            alert("helloo");
            TaskManager.DataAccess._sprints = response.sprints;
            callback(TaskManager.DataAccess._sprints);
        })
    }
  } catch (err) {
  }
} 
```

我尝试在 Telerik 网站上编译入门示例，这里是链接[http:](http://www.kendoui.com/blogs/teamblog/posts/12-02-22/building_your_first_kendo_ui_mobile_phonegap_application.aspx) //www.kendoui.c​​om/blogs/teamblog/posts/12-02-22/building_your_first_kendo_ui_mobile_phonegap_application.aspx 。

如果我通过 pc 上的任何浏览器访问它，我可以让 web 服务正常工作，但不知何故，模拟器无法访问数据。我不知道原因，但它让我发疯。

我也试过这个例子[http://www.aspnetwiki.com/page:kendo-ui-mobile-task-manager-part-1](http://www.aspnetwiki.com/page:kendo-ui-mobile-task-manager-part-1)但结果相同。

任何形式的帮助表示赞赏。请

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:58:11.307

将您的网址更改为：

```
url: "http://10.0.2.2/TaskManager.Mvc/Mobile/Sprints", 
```

请参阅[常见任务以及如何在 Android 中执行它们](http://developer.android.com/resources/faq/commontasks.html#localhostalias)

> 如果您需要引用主机的 localhost，例如当您希望模拟器客户端联系运行在同一主机上的服务器时，请使用别名 10.0.2.2 来引用主机的环回接口。从模拟器的角度来看，localhost (127.0.0.1) 指的是它自己的环回接口。

# c - 从 GDB 获取堆栈跟踪

> ID：11103574
> 
> 赞同：2
> 
> 时间：2012-06-19T14:49:59.673
> 
> 标签：c, gdb, stack, backtrace

我一定对堆栈或函数的调用方式有误解，我从 GDB 获得的回溯结果对我来说毫无意义。我试图找出程序中调用的位置，以便我可以添加我的组件。

该工具在视频上绘制边界框，我制作的是插值器。我认为只有在绘制框时打开 GDB 并在其中设置断点并运行回溯才有意义。这是 mu 输出（从 运行程序后`ffmpeg.c main()`）

```
#0  draw_glyphs (vidatbox=0x10183d200, picref=0x10141e340, width=720, height=480,
rgbcolor=0x10183d284 "????", yuvcolor=0x10183d278 "뀀?\020???\020???????", x=0, y=0) at 
libavfilter/vf_VidAT.c:627
#1  0x000000010001ce4c in draw_text (ctx=0x10120df20, picref=0x10141e340, width=720, 
height=480) at libavfilter/vf_VidAT.c:787 
```

`draw_glyphs`忽略所有非 ascii 字符，这两个函数是如何`draw_text`被调用的？为什么堆栈上没有其他内容？当我选择 Frame #1 并尝试 go`up`时，它告诉我：

```
Initial frame selected; you cannot go up. 
```

编辑：

我看了更多，当我问的时候，我更加困惑。该函数`draw_glyphs`甚至没有在我正在运行的 main 内部调用。我已经浏览了所有用于编译的文件，而且……它没有在任何地方调用！

这是否意味着它是一个动态创建的函数指针或什么？如果是这样，那会使堆栈像我的那样不可访问吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T09:20:10.497

如果堆栈跟踪信息丰富但意外终止（尤其是在仅一两个条目之后），则表明 gdb 无法跟踪调用堆栈超过该点。

干扰堆栈展开的编译器选项包括更高的优化级别（尤其是`-O3`）和`-fomit-frame-pointer`，因此请搜索您的 Makefile 并删除这些选项。[帧指针](http://en.wikipedia.org/wiki/Call_stack#The_stack_and_frame_pointers)通常不是执行代码所必需的，因此将其用作通用寄存器将提高寄存器匮乏架构（如 x86）的性能，但会干扰调试。

最近基于帧的堆栈展开被[展开表](http://gnu.wildebeest.org/blog/mjw/2007/08/23/stack-unwinding/)取代，但如果展开表不存在，gdb 仍然依赖于帧指针。

# ruby-on-rails - 如何使用 twitter bootstrap-sass mixins

> ID：11103575
> 
> 赞同：2
> 
> 时间：2012-06-19T14:50:05.943
> 
> 标签：ruby-on-rails, twitter-bootstrap

使用 Rails 3。

现在在`.css.scss`我创建的每个新文件中，我希望能够使用`mixins`，但我似乎无法使用它。

这是我的`bootstrap_import.css.scss`：

```
// Import bootstrap
// --------------------------------------------------
@import "bootstrap";
@import "bootstrap-responsive";
@media (min-width: 1200px) {
  .span12, .container {
    width: 1170px;
  }
}
@import "base"; 
```

当我调用另一个文件`a.css.scss`并尝试调用时`@include border-radius(12px);`，它只是给出了这个错误：

```
Undefined mixin 'border-radius'. 
```

**同样`variables`，我想更改一些变量的一些颜色，以便我可以在任何文件上使用它，而无需包含在每个 CSS 文件中。**

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T00:49:20.570

我的项目中只有一个导入有效，可能是我这边的错误或错误。

我用 bootstrap-sass v2.0.3.1 实现的解决方案是：（不是 100% 你期望的，我知道..）

我创建了一个新的 scss 文件，例如：myAppBase.css.scss

```
/* override bootstrap default variables */
$linkColor:      #FF0000;
$linkColorHover: #000;

@import "bootstrap";

/* App variables */
$bgImage: url('bg.jpg');
$radius: 4px;
$maxHeight:600px;
$minHeight:400px;
$bSize:1px; 
```

如果我需要 bootstrap 和另一个 *.css.scss 文件中的变量。我在顶部包括这一行：

```
@import  "myAppBase"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T03:53:05.703

我遵循了这个指南，我能够修复错误“未定义的边界半径”。 [https://github.com/thomas-mcdonald/bootstrap-sass](https://github.com/thomas-mcdonald/bootstrap-sass)

# php - jQuery Post、PHP 和 MySQL 返回数据

> ID：11103576
> 
> 赞同：1
> 
> 时间：2012-06-19T14:50:07.053
> 
> 标签：php, jquery, arrays

当我单击一个按钮时，我想使用 jQuery 从我的数据库中提取信息。

我设法让 console.log 显示以下内容

> [对象 { id="16", user_to="Obadiah Stane", user_delivery_add1="The Lanesborough"}]

但我不知道如何提取每个值以在表单中使用。

有人可以帮忙吗？

jQuery

```
$.post('/assets/inc/get-delivery-details.php', qString, function (data) {
        console.log(data);
        var json = $.parseJSON(data);
        $('.addAddressDialog').html(json);   
    }, "json"); 
```

PHP

```
 $q = "SELECT * FROM tbl_user_delivery WHERE id = '$selectedID'";
$sql = mysql_query($q);

$results = array();
while($row = mysql_fetch_array($sql))
{
   $results[] = array(
      'id' => $row['id'],
      'user_to' => $row['user_to'],
      'user_delivery_add1' => $row['user_delivery_add1']
   );
}
echo json_encode($results); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T14:51:50.293

```
 $.post('/assets/inc/get-delivery-details.php', qString, function (data) {

        //var json = $.parseJSON(data); // don't need this line, because you've
                                        // already set dataType json as fourth 
                                        // arguments of $.post()

        // To get values
        alert(data[0].id);
        alert(data[0].user_to); // so on

        // To set above values to a form fields
        // just an example, don't know your form markup

        $('input[name=id]').val(data[0].id);  // so on

    }, "json"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:52:42.357

`$('.addAddressDialog').html(json.id);`将`16`在您的示例中输出。

解析变量json后，就变成了一个对象。

# c# - WPF DataTemplate 方法与参数绑定

> ID：11103580
> 
> 赞同：2
> 
> 时间：2012-06-19T14:50:16.880
> 
> 标签：c#, wpf, binding, datatemplate

我有一个 ListBox 的自定义 ItemTemplate ，我需要将 TextBlock “绑定”到一些特殊的方法/属性。

我的 ListBox 源是一个`ObservableCollection<SearchResultItem>`. `SearchResultItem`包含一些属性。

文本需要根据另一个对象的值进行更改。例如，如果这个对象等于“foo”，我需要文本值来调用方法`GetProperty("foo")`以`SearchResultItem`获得正确的值。

这是一个代码示例：

```
<DataTemplate>
..
//Here is a Label bound to the Date Property of the SearchResultItem
<Label Margin="2,2,2,0" Grid.Row="0" Grid.Column="2" Content="{Binding Path=Date}" HorizontalAlignment="Right" HorizontalContentAlignment="Right" />
//Here is the textblock that needs to call the method with the parameter based on the value of the other object.
<TextBlock Margin="2,2,2,0" TextTrimming="CharacterEllipsis"  Grid.Row="0" Grid.Column="1" Text="I need some help there" HorizontalAlignment="Left" VerticalAlignment="Center" Foreground="Black"/>
..
</DataTemplate> 
```

您对如何做到这一点或更好的方法有任何想法吗？

编辑：

-假设`SearchResultItem`来自外部库并且只公开`GetProperty`方法。

- 假设“foo”值来自`ConfigurationManager.AppSettings["propertyName"];`它是否有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:17:35.070

好的，因为您的属性永远不会改变，这是一种解决方案。您可以通过 SearchResultItem 类上的另一个属性来执行此操作：

```
public string MyTextBinding
{
    get 
    {
        return myDictionary.ContainsKey("foo") ? return myDictionary["foo"] : return "myDictionary doesn't contain foo"; 
    }
} 
```

然后只需将您的文本框绑定到此属性：

```
<DataTemplate>    
    <Label Margin="2,2,2,0" Grid.Row="0" Grid.Column="2" Content="{Binding Path=Date}" HorizontalAlignment="Right" HorizontalContentAlignment="Right" />
    <TextBlock Margin="2,2,2,0" TextTrimming="CharacterEllipsis"  Grid.Row="0" Grid.Column="1" Text="{Binding Path=MyTextBinding, Mode=OneWay}" HorizontalAlignment="Left" VerticalAlignment="Center" Foreground="Black"/>
</DataTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:57:59.237

只需使用 a`IValueConverter`并`SearchResultItem`返回预期的文本

```
<TextBlock Margin="2,2,2,0" TextTrimming="CharacterEllipsis" 
           Grid.Row="0" Grid.Column="1" 
           Text="{Binding Path=., 
                Converter={StaticResource PropertyValueFromSearchResultItemConverter}, 
                ConverterParameter=Foo}" 
           HorizontalAlignment="Left" VerticalAlignment="Center" Foreground="Black"/> 
```

# javascript - 您如何检测 HTML5 音频何时播放完毕（不止一次）？

> ID：11103582
> 
> 赞同：35
> 
> 时间：2012-06-19T14:50:25.820
> 
> 标签：javascript, jquery, html, audio

我在检测标签何时播放完 mp3 时遇到问题。当我做这样的事情时：

```
 myAudio.addEventListener("ended", function() 
     {
          alert("ended");
     }); 
```

它仅在第一次播放音频时发生。当我再次播放音频时，没有任何反应。当我使用该`onended=doThis();`方法时也会发生同样的事情。我听说在 jQuery 中可能有一种方法可以做到这一点，但我无法让它工作。我还听说有一种方法可以通过`id`每次播放 mp3 时更改音频 div 来修复它，但这对我不起作用，因为我需要`id`保持不变。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-06-19T15:13:32.030

`ended`事件是基于`.currentTime`属性 创建的。[http://w3c.github.io/html/semantics-embedded-content.html#eventdef-media-ended](http://w3c.github.io/html/semantics-embedded-content.html#eventdef-media-ended)

因此，您所要做的就是`.currentTime`再次将其设置为零。

```
myAudio.addEventListener("ended", function(){
     myAudio.currentTime = 0;
     console.log("ended");
}); 
```

# java - 如何针对 Windows AD 对用户进行身份验证？

> ID：11103585
> 
> 赞同：0
> 
> 时间：2012-06-19T14:50:34.213
> 
> 标签：java, windows, hibernate, jsf, authentication

我有一个 JSF-Hibernate Web 应用程序。我需要针对 Windows AD 对用户进行身份验证，并且 Web 应用程序应该只允许来自组 X 的成员登录，否则它应该重定向到错误页面。我该如何配置？

另外，我想在所有页面上显示登录用户的名称，而不是服务器计算机的 Windows 用户的名称。我已经为此尝试过`System.property("user.name")`，但这仅返回服务器名称的 Windows 用户的名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T15:07:56.090

您需要在 servlet 容器上创建一个所谓的“LDAP 领域”。如何做到这一点取决于所使用的 servletcontainer。由于您没有提供有关所使用的 servletcontainer 的任何详细信息，因此很难给出合适的答案，但通常只需阅读 servletcontainer 的有关 Realm 配置的文档就足够了。例如 Tomcat，它是[Realm Configuration HOW-TO](http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html)。对于 Tomcat，您需要一个[`JNDIRealm`](http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html#JNDIRealm). 更多细节可以在[JSP wiki](http://www.jspwiki.org/wiki/ActiveDirectoryIntegration)中找到。

然后，您需要通过`<security-constraint>`在`web.xml`. `<login-config>`您可以在相同的条目中配置登录和错误页面`web.xml`。

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>secured</web-resource-name>
        <url-pattern>/secured/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>X</role-name> <!-- Should be your AD group name. -->
    </auth-constraint>
</security-constraint>

<login-config>
    <auth-method>FORM</auth-method>
    <form-login-config>
        <form-login-page>/login.xhtml</form-login-page>
        <form-error-page>/error.xhtml</form-error-page>
    </form-login-config>
</login-config> 
```

登录表单应该 POST`j_security_check`并使用`j_username`和`j_password`作为输入字段名称。

```
<form action="j_security_check" method="post">
    <input type="text" name="j_username" />
    <input type="password" name="j_password" />
    <input type="submit" value="login" />
</form> 
```

如果您想要对验证进行更细粒度的控制并因此想要使用 JSF`<h:inputText required="true" />`等，那么您还可以提交一个支持 bean 操作方法，该方法依次调用[`HttpServletRequest#login()`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#login%28java.lang.String,%20java.lang.String%29). 另请参阅[使用 j_security_check 在 Java EE / JSF 中执行用户身份验证](https://stackoverflow.com/questions/2206911/best-way-for-user-authentication-on-javaee-6-using-jsf-2-0/2207147#2207147)

至于获取登录用户的名字，[`ExternalContext#getRemoteUser()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#getRemoteUser%28%29)在 JSF 上下文或[`HttpServletRequest#getRemoteUser()`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getRemoteUser%28%29)servlet 上下文中使用即可。您可以在 JSF EL 中访问它，如下所示：

```
<p>Welcome, #{request.remoteUser}</p> 
```

系统属性确实返回了服务器自己的用户，这在这种情况下完全没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:21:22.747

我想建议你看看[oVirt](http://www.ovirt.org)的开源项目。我们有一个基于 GWT 的 webadmin 和一个 REST-API Web 应用程序，它使用 Kerberos 作为身份验证协议（它还支持 SIMPLE 身份验证）对 LDAP 服务器执行身份验证。

我将在这里大致描述我们所做的事情，但请 - 看看代码：

*   我们使用 JAAS +`Krb5LoginModule`来执行 Kerberos 的登录操作（您必须通过`System.setProperties`KDC 等设置 Kerberos 相关信息，或者使用 krb5.conf 文件）

*   登录成功后，我们运行一个`PrivilegedAction`（见 JAAS API）

*   我们`PrivilegedAction`使用 GSSAPI（这是用于 Kerberos，您也可以改用 SIMPLE）并且由于成功登录而具有正确的凭据。

此时，您已通过 Active-Directory 的身份验证，该 Active-Directory 同时用作 Ldap 服务器和 KDC

这个解决方案是独立于容器的，甚至可以从一个简单的、独立的 Java 程序工作（当然你需要定义一个适当的 JAAS conf 文件。如果你使用 JBoss AS 7.1.x，就像我们一样，`standalone.xml`照顾这个问题

代码位于`ovirt-engine/backend/manager/modules/bll/src/main/java/org/ovirt/engine/core/bll/adbroker`，您可以通过 git clone 从 oVirt 获取它。

# javascript - jquery的第一个孩子问题

> ID：11103586
> 
> 赞同：0
> 
> 时间：2012-06-19T14:50:36.597
> 
> 标签：javascript, jquery

告诉我另一种写法，以便找到第一个 A：

```
$("UL.tab LI A.selected, UL.tab LI A:first-child").corner("tl:7px bl:7px"); 
```

因为我的 Jquery 似乎没有选择第一个 A 标签！？

**标记：**

```
<ul class="tabNavigation">
            <li><a href="#Description" class="selected">Description</a></li>
            <li><a href="#Details">Details</a></li>
            <li><a href="#Features">Features</a></li>
            <li><a href="#SpareParts">Spare Parts</a></li>
            <li><a href="#Downloads">Downloads</a></li>
          </ul> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T14:53:54.900

对于您的标记，您可以使用以下选择器：

```
$("ul.tabNavigation li:first a").corner("tl:7px bl:7px"); 
```

这里最好使用`:first`选择器 for `<li>`，因为`<a>`总是`:first-child`of `<li>`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T14:54:34.947

`$('ul.tab li a.selected :first')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T15:21:10.157

如果要选择第一个 ANCHOR 元素（位于第一个 LI 元素内的元素），可以这样做：

```
$( 'a:first', '.tabNavigation' ) 
```

通常，您希望您的“主要”元素在整个代码中都可用作引用（这样您就不必重复查询它们）。例如，您可以事先检索对 UL 元素的引用：

```
var tabnav = $( '.tabNavigation' )[0]; 
```

然后当你想选择第一个 ANCHOR 时，你可以这样做：

```
$( 'a:first', tabnav ) 
```

这将表现得非常好。

同样，要选择具有“选定”类的 ANCHOR：

```
$( 'a.selected', tabnav ) 
```

# java - Oracle Weblogic 将 jars 添加到类路径？

> ID：11103588
> 
> 赞同：8
> 
> 时间：2012-06-19T14:50:44.913
> 
> 标签：java, oracle, weblogic, weblogic11g

如何将 jars 添加到 Oracle 10.3.5 的类路径中...据我了解，文档（自述文件）中存在一个错误（或错误信息），指出任何 jars 放置在 $DOMAIN_HOME/lib 目录中将被动态添加到类路径中......但在 10.3.3 的真实文档中，它指出这些文件不再添加到类路径中......

所以在这里我试图找出 - 你如何将罐子添加到类路径......我已经尝试更改 commonEnv.sh 并且目前正在寻找 setDomainEnv.sh （但目前还找不到）并且没有这些东西已经将这个 jar 添加到类路径中......

我的整个问题是我将数据源添加到我的服务器......我正在尝试将 DB2 jar 添加到环境中以便可以使用它......有趣的是，在 $DOMAIN_HOME/lib 中添加 jar 之后我在尝试测试与数据库的连接时，能够摆脱管理控制台中的连接错误......这一切似乎都有效，但现在我得到一个类定义错误......

```
]] Root cause of ServletException.
java.lang.NoClassDefFoundError: com/ibm/db2/jcc/DB2Connection
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:630)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:614)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at weblogic.utils.classloaders.GenericClassLoader.defineClass(GenericClassLoader.java:343)
    Truncated. see log file for complete stacktrace
Caused By: java.lang.ClassNotFoundException: com.ibm.db2.jcc.DB2Connection
    at weblogic.utils.classloaders.GenericClassLoader.findLocalClass(GenericClassLoader.java:297)
    at weblogic.utils.classloaders.GenericClassLoader.findClass(GenericClassLoader.java:270)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:305)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:246)
    at weblogic.utils.classloaders.GenericClassLoader.loadClass(GenericClassLoader.java:179)
    Truncated. see log file for complete stacktrace 
```

不知道还有什么可以尝试的-我搜索了一些答案，但似乎所有答案都过时了...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T15:56:25.787

$DOMAIN/lib 应该可以正常工作，但不是动态的。你必须重新启动。但是，处理数据源驱动程序的 JAR 文件可能会有所不同。

只是好奇-您是否确认 jar 文件包含有问题的类？

也可以试试：[http ://docs.oracle.com/cd/E17904_01/web.1111/e13753/db2.htm](http://docs.oracle.com/cd/E17904_01/web.1111/e13753/db2.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T16:57:32.433

I ended up finding out the problem was that I was editing the commEnv.sh file on windows instead of the commEnv.cmd file...really dumb but editing that and adding the jar to the classpath there worked...bah!

# php - PayPal API 直接付款流程

> ID：11103589
> 
> 赞同：0
> 
> 时间：2012-06-19T14:50:54.303
> 
> 标签：php, paypal

我在沙盒上使用了通常的卖家帐户，而不是 wpp。我可以在该帐户上使用信用卡直接付款还是只需要创建 wpp 帐户？现在我收到错误：

```
[L_ERRORCODE0] => 10501
[L_SHORTMESSAGE0] => Invalid Configuration
[L_LONGMESSAGE0] => This transaction cannot be processed due to an invalid merchant configuration.
[L_SEVERITYCODE0] => Error 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T13:24:55.490

不可以，您必须设置一个 Website Payments Pro 帐户才能测试 DoDirectPayment API。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-19T16:47:02.597

您需要在沙盒中设置买家帐户并使用该帐户进行测试

# tomcat - 分析tomcat中的高CPU使用率

> ID：11103590
> 
> 赞同：4
> 
> 时间：2012-06-19T14:50:56.383
> 
> 标签：tomcat, cpu

我有一个在三个 tomcat 服务器上运行的生产系统。突然，我的一个 tomcat 服务器显示 100% 的 CPU 使用率，这是我从池中取出的。

任何人都可以指导我如何开始调试这个问题？任何工具/实用程序？

谢谢， 哈里什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:54:12.357

我要尝试的第一件事是获取线程转储并查看正在运行的内容。

从[这篇文章](http://java.sys-con.com/node/1611555)：

> 生成 Java 线程转储 线程转储是通过向 JVM 进程发送 SIGQUIT 信号来生成的。有多种方法可以将此信号发送到进程。
> 
> 在 Unix 中，使用“kill -3”，其中 pid 是 JVM 的进程 ID。
> 
> 在 Windows 中，在运行 JVM 的窗口上按 CTRL+BREAK

这至少会向您显示应用程序中的哪些线程正在运行，并为您提供有关正在发生的事情的基本指示。[jstack](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstack.html)将提供另一种获取此信息的方法，并且对于与控制台断开连接的服务器进程可能更容易。

[使用VisualVM](http://visualvm.java.net/)报告线程/CPU + 内存使用情况可以获得更详细的报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T09:22:06.697

看看[JTop](http://lsd.luminis.nl/top-threads-plugin-for-jconsole/)，它就像 unix `top`，但用于 JVM 中的线程。

# c# - 如何在 ZedGraph 中将特定曲线置于前面

> ID：11103596
> 
> 赞同：6
> 
> 时间：2012-06-19T14:51:12.680
> 
> 标签：c#, plot, zedgraph, curves

在绘制两条曲线后，我在 zedgraph 控件上有两条曲线......

```
PointPairList thresholdList = new PointPairList();
PointPairList powerList = new PointPairList();

private void plotPower()
{
        // Create an object to access ZedGraph Pane
        GraphPane pane = zedGraphControl1.GraphPane;            
        LineItem thresholdLine = new LineItem("thresholdLine");
        LineItem powerLine = new LineItem("powerLine");

        // Set the Threshold Limit
        double thresoldLimit = Convert.ToDouble(numAnalysisThreshold2.Value);

        // Points
        double[] x = new double[]{0, pane.XAxis.Scale.Max};
        double[] y = new double[]{thresoldLimit, thresoldLimit};

        // Set the threshold line curve list
        thresholdList.Add(x, y); 

        // Set the Power Line curve list
        powerdList.Add(XData, YData);

        // Add Curves
        thresholdLine = pane.AddCurve("", thresholdList, Color.Red, SymbolType.None);
        powerLine = pane.AddCurve("", powerList, Color.Red, SymbolType.None);

        // Refresh Chart
        this.Invalidate();
        zedGraphControl1.Refresh();
} 
```

从上面的代码中，我设法将两条曲线绘制为阈值线曲线上的电源线曲线。

现在我的问题是，如果我想把任何一条曲线放在前面......有没有可用的方法（例如：bringittoFront（）......）......？

非常感谢您抽出宝贵的时间...... :)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T17:40:05.723

GraphPane包含一个[CurveList](http://zedgraph.sourceforge.net/documentation/html/T_ZedGraph_GraphPane.htm)属性，[CurveList](http://zedgraph.sourceforge.net/documentation/html/P_ZedGraph_GraphPane_CurveList.htm)[类](http://zedgraph.sourceforge.net/documentation/html/T_ZedGraph_CurveList.htm)是`List<CurveItem>`. 如果为绘制的每条曲线都设置了[CurveItem.Tag](http://zedgraph.sourceforge.net/documentation/html/F_ZedGraph_CurveItem_Tag.htm)属性，相信您应该可以通过使用`CurveList.Sort(IComparer<CurveItem>)`方法对曲线项进行排序，并使用`Tag`来表示排序顺序。

**更新 6 月 19 日**

简单的例子：两条线，蓝色`line2`的`line2.Tag = 2`和红色`line1`的`line1.Tag = 1`。在初始化`line2`时首先将其添加到图形窗格中，因此它将显示在顶部。

```
void GraphInit()
{
    var line2 = _graph.GraphPane.AddCurve("Second", 
        new[] { 0.1, 0.5, 0.9 }, new[] { 0.1, 0.5, 0.1 }, Color.Blue);
    line2.Tag = 2;

    var line1 = _graph.GraphPane.AddCurve("First", 
        new[] { 0.1, 0.5, 0.9 }, new[] { 0.1, 0.5, 0.9 }, Color.Red);
    line1.Tag = 1;

    _graph.Refresh();
} 
```

![排序前的初始显示](../Images/1b4c6f11d5641352e353243be62761fd.png)

要排序，首先实现一个实现 的类`IComparer<CurveItem>`，并根据属性的数值按升序对曲线项进行排序`CurveItem` `Tag`：

```
class CurveItemTagComparer : IComparer<CurveItem>
{
    public int Compare(CurveItem x, CurveItem y)
    {
        return ((int)x.Tag).CompareTo((int)y.Tag);
    }
} 
```

要执行重新排序和更新图形，请为*排序*按钮实现以下事件处理程序：

```
void SortButtonClick(object sender, EventArgs e)
{
    _graph.GraphPane.CurveList.Sort(new CurveItemTagComparer());
    _graph.Refresh();
} 
```

现在，当单击*排序*按钮时，将对曲线进行排序，以便将具有最低标记值的曲线（即`line1`）绘制在顶部。此外，请注意图例中的曲线顺序会随之更改。

![单击排序按钮后的图表](../Images/7874e279cabb94bdc9433a7e5073d5b1.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-26T16:35:16.130

有一个非常简单的方法。使用类[`Move()`](http://zedgraph.sourceforge.net/documentation/html/M_ZedGraph_CurveList_Move.htm%20%22Move%28%29)中的方法`CurveList`。例如在：

`zedGraphControl1.GraphPane.CurveList.Move(index,relativePos)`

设置`relativePos`为`-1`将对象在列表中前移一位，而`1`将其后移一位。要将项目移动到列表的开头，请使用较大的负值（例如`-999`）。要将其移动到列表的末尾，请使用较大的正值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-24T19:36:55.740

而且，对于需要它的人来说，这是 vb.net 的 IComparer 类的代码：

```
 Public Class CurveItemTagComparer
    Implements IComparer(Of CurveItem)
    Function Compare(ByVal x As ZedGraph.CurveItem, ByVal y As ZedGraph.CurveItem) As Integer _
    Implements System.Collections.Generic.IComparer(Of CurveItem).Compare
        Return CInt(x.Tag).CompareTo(CInt(y.Tag))
    End Function
End Class 
```

乔瓦尼

# asp.net - Visual Studio 调试器仍显示从 iframe 中删除的旧页面

> ID：11103599
> 
> 赞同：3
> 
> 时间：2012-06-19T14:51:23.663
> 
> 标签：asp.net, .net, debugging, visual-studio-2008, iframe

我使用模态对话框。一个模态对话框由一个掩码 div 和一个容器 div 组成。容器 div 包含一个带有模态 aspx 页面的 iFrame。初始化模态对话框时，将掩码和容器添加到页面正文中。当我关闭模态对话框时，遮罩和容器会从正文中移除。

一切正常，当我在 Visual Studio 中开始调试并打开一个新的模式对话框时，我在调试器中的“脚本文档 - Windows Internet Explorer - somePage.aspx”中看到了新页面

但是当我关闭并删除对话框时，页面在 VS 调试器中保持“活动”状态，直到我刷新整个页面。

这很糟糕吗？即使页面从正文中删除，页面是否“还活着”？或者它只是一个 Visual Studio 调试器 UI 的东西？

我发现[了这个问题](https://stackoverflow.com/questions/7109103/why-do-script-blocks-grow-endlessly-in-vs2010-debugger-when-running-asp-net-page)，关于不断增长的脚本块文件。我认为那是同一个问题，但那里并没​​有真正回答这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T10:58:36.937

仅删除包含 iframe 的容器 div是**不够的。**

我希望这足以删除和销毁 iframe：

```
$(this.mask).remove();
$(this.container).remove(); 
```

该容器包含另一个 div（模式对话框标题）和一个 iframe。使用上述代码终止容器**不会删除**该 iframe 。看起来它不仅仅是一个 Visual Studio 调试器问题，因为每次我关闭并打开一个新对话框时，Windows 任务管理器中 iexplore.exe 进程的内存也在不断增加。

**解决方案：** 当我明确删除 iframe 时，页面确实从调试器中消失了！

我可以通过在初始化模态对话框时将 iframe 保存在 var 中来做到这一点，然后在删除模态对话框时显式删除 iframe。这边走：

在创建/初始化模式对话框：

```
this.frame = this.container.childNodes[0].childNodes[1]; 
```

并在关闭模式对话框中：

```
$(this.frame).remove(); 
```

# iphone - 将 NSDictionary 的 NSArray 保存到文件

> ID：11103604
> 
> 赞同：0
> 
> 时间：2012-06-19T14:51:35.833
> 
> 标签：iphone, objective-c, ios, arrays, ios5

我正在尝试将一个巨大的 NSArray 保存到一个文件中，然后检索它......

```
NSURL *documentsDirectory = 
[[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory 
                            inDomains:NSUserDomainMask] lastObject];
NSURL *fileURL = [documentsDirectory 
                  URLByAppendingPathComponent:@"scorecards.dgs"];

NSMutableArray *savedArrayOfScorecards = [NSMutableArray arrayWithContentsOfURL:fileURL];
[savedArrayOfScorecards addObject:currentScoreCard];

[savedArrayOfScorecards writeToURL:fileURL atomically:YES];

NSMutableArray *mynewArray = [NSMutableArray arrayWithContentsOfURL:fileURL];

NSLog(@"%@, %@",[[mynewArray objectAtIndex:0] objectForKey:@"info"], course); 
```

NSLog 回来了...

```
(null), BridgeMill 
```

逗号两边应返回哪个 BridgeMill。但是数组不会保存...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:54:12.697

检查是否正确保存：

```
if([savedArrayOfScorecards writeToURL:fileURL atomically:YES])
{
    NSLog(@"Was saved");
}
else
{
    NSLog(@"Houston we have a problem...");
} 
```

在[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html)上：

> - (BOOL)writeToURL:(NSURL *)aURL atomically:(BOOL)atomically

您还可以使用它来检查发生了什么：

> - (BOOL)writeToURL:(NSURL *)aURL 选项:(NSDataWritingOptions)掩码错误:(NSError ** )errorPtr

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:01:46.393

什么课`course`？

[`writeToURL`](https://developer.apple.com/library/ios/documentation/cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/doc/uid/20000137-BCIGIJII)只支持可以转换成 plist 格式的类型。这些类型是 NSString、NSData、NSArray 或 NSDictionary。

如果您的 NSArray 中有其他类型，则必须[归档该数组](https://stackoverflow.com/questions/1286212/how-to-convert-nsarray-to-nsdata)。

# .htaccess - 我不知道我的网址重写中有什么错误

> ID：11103606
> 
> 赞同：-1
> 
> 时间：2012-06-19T14:51:37.787
> 
> 标签：.htaccess

我正在尝试使用 htaccess 文件重写我的 url，但它不起作用。我启用了 mod_rewrite 和 Allow Access，但它仍然不适用于本地和在线。我的重写代码有什么问题？

我想重写这个网址

> [http://example.com/post/post.php?pid=104](http://example.com/post/post.php?pid=104)

像这样

> [http://example.com/post/post-pid-104.htm](http://example.com/post/post-pid-104.htm)

这是我的 htaccess 代码：

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule post-pid-(.*)\.htm$ post.php?pid=$1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:57:52.557

这应该有效：`RewriteRule post.php?pid=(.*)$ post-pid-$1.htm$`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:30:39.140

重写行很好，看起来是您的服务器配置有问题。你可以用这个来测试你的重写规则：http: [//htaccess.madewithlove.be/](http://htaccess.madewithlove.be/)

# iphone - 主视图外的子视图不接收触摸事件

> ID：11103608
> 
> 赞同：1
> 
> 时间：2012-06-19T14:51:44.760
> 
> 标签：iphone, objective-c, uiview

在我的应用程序中，我有一个主屏幕，它有一个子视图（这是另一个屏幕），但是这个子视图向右移动了 320，所以它只是在屏幕外。效果是主屏幕向左移动了320，隐藏了主屏幕并显示了另一个屏幕，因为它是一个子视图。问题是，另一个屏幕没有接收到触摸事件，因为它超出了主屏幕（superview）的范围。我如何让这个其他屏幕也接收触摸事件，以便我可以点击按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T14:57:30.120

看看[这个关于 SO](https://stackoverflow.com/questions/5844356/uiview-why-does-a-subviews-outside-its-parents-extent-not-receive-touches)的帖子以获得解释。解决方案是使用以下代码实现您自己的 hitTest：

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {

    BOOL isInside = [super pointInside:point withEvent:event];

    // identify the button view subclass
    UIButton *b = (UIButton *)[self viewWithTag:3232];
    CGPoint inButtonSpace = [self convertPoint:point toView:b];

    BOOL isInsideButton = [b pointInside:inButtonSpace withEvent:nil];

    if (YES == isInsideButton) {

       return isInsideButton;

    } // if (YES == isInsideButton)

    return isInside;
 }

 - (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {

    UIView *v = nil;

    v = [super hitTest:point withEvent:event];

    return v;
 } 
```

# ruby - 漂亮地在 Ruby 中打印树数据结构

> ID：11103613
> 
> 赞同：7
> 
> 时间：2012-06-19T14:51:57.990
> 
> 标签：ruby, expression-trees, abstract-syntax-tree

我正在构建一个编译器，并在其中生成一棵树，它代表传入的源程序。我想显示这是一棵树，就像时尚一样，所以我可以向任何感兴趣的人显示程序的结构。

现在我只是将树打印在一行上，如下所示：

```
ProgramNode -> 'Math' BlockNode -> DeclarationNode -> ConstantDeclarationNode -> const ConstantListNode -> [m := 7, ConstantANode -> [n := StringLiteralNode -> ""TEST"" ]] ; 
```

我想要的是这样的：

```
 ProgramNode 
    /     \
'Math' BlockNode
           |
    DeclarationNode
           |
    ConstantDeclarationNode ------------------------------
        /      \                                         |
     const ConstantListNode                              |
             /  |  \      \                              |
             m  :=  7    ConstantANode                   |
                            /  |    \                    |
                           n   :=  StringLiteralNode     |
                                      /    |   \         |
                                      "   TEST  "        ; 
```

我还没有真正在 Ruby 中使用过树，它们通常是如何表示的？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:05:27.213

这种漂亮的印刷需要相当多的数学知识。此外，如果树对于控制台窗口来说太宽，会发生什么还不清楚。我不知道有任何现有的库可以做到这一点。我个人使用[`awesome_print`](https://github.com/michaeldv/awesome_print).

```
tree = {'ConstantDeclarationNode' => ['const',
                                      'ConstantListNode' => ['m', ':=', '7']]}

require 'awesome_print'

ap tree
# >> {
# >>     "ConstantDeclarationNode" => [
# >>         [0] "const",
# >>         [1] {
# >>             "ConstantListNode" => [
# >>                 [0] "m",
# >>                 [1] ":=",
# >>                 [2] "7"
# >>             ]
# >>         }
# >>     ]
# >> } 
```

它有很多选择，看看吧！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T18:04:41.903

您需要查看[Graph](http://rubygems.org/gems/graph) gem。使用起来非常棒，而且非常简单。您可以选择树的方向和节点的形状，以及颜色等等。我在去年的 Rubyconf 上第一次发现了它并被震撼了。

它很简单：

```
digraph do
  edge "Programnode", "Blocknode"
  edge "Programnode", "Math"
  edge "Blocknode", "DeclarationNode"
end 
```

显然你会想以编程方式输入边缘:)

这是演讲[pdf](https://github.com/kushali/RubyConf2011_GraphTalk)的链接，其中将提供更多信息：

如果您有兴趣，还有关于[Confreaks的演讲视频。](http://www.confreaks.com/videos/617-cascadiaruby2011-powerful-but-easy-data-visualization-with-the-graph-gem)

干杯，肖恩

# eclipse - Eclipse中VerticalRuler的AnnotationRulerColumn的着色行

> ID：11103614
> 
> 赞同：1
> 
> 时间：2012-06-19T14:52:06.503
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我正在尝试更改 Eclipse 中 VerticalRuler 的 AnnotationRulerColumn 的背景颜色。到目前为止，我只能在更改边界后分别更改整个区域的颜色。有没有办法将 Colum 划分为行来表示源代码行？

```
Color co = new Color(display,2,3,2);
Color co2 = new Color(display,2,3,255);
Rectangle rect = new Rectangle(0,0,25,200);
column1.getControl().setBounds(rect);
column1.getControl().setBackground(co);
column2.getControl().setBackground(co2); 
```

![在此处输入图像描述](../Images/8a4d1fbb214deffaf29168a9bc2109b4.png)

相关话题：

[Eclipse 编辑器：在垂直标尺的自定义列上显示标记](https://stackoverflow.com/questions/11082933/eclipse-marker-on-diffrent-column)

[创建 VerticalRuler 并添加信息](https://stackoverflow.com/questions/10992863/creating-verticalruler-and-add-information)

[在eclipse插件中获取行号](https://stackoverflow.com/questions/10980082/get-line-number-within-a-eclipse-plugin)

# c# - 如何更改某些元素的 XML 命名空间

> ID：11103615
> 
> 赞同：7
> 
> 时间：2012-06-19T14:52:14.537
> 
> 标签：c#, .net, xml, xml-parsing

我有一些通过一些 WCF 消息的 xmlserialization 生成的 xml。现在我想创建一个通用方法，在该方法中我将提供一个 xml 文件名和一个前缀，如`mailxml12`. 然后在 xml 文件中，那些名称中没有任何命名空间前缀的元素应替换为`mailxml12:`

像源文件是：

```
<DeliveryApptCreateRequest d2p1:ApptType="Pallet" d2p1:PickupOrDelivery="Delivery" d2p1:ShipperApptRequestID="4490660303D5" d2p1:SchedulerCRID="234234" xmlns:d2p1="http://idealliance.org/Specs/mailxml12.0a/mailxml_defs" xmlns="http://idealliance.org/Specs/mailxml12.0a/mailxml_tm">
<SubmittingParty d2p1:MailerID6="123446" d2p1:CRID="342343" d2p1:MaildatUserLicense="A123" />
<SubmittingSoftware d2p1:SoftwareName="asds" d2p1:Vendor="123" d2p1:Version="12" />
<SubmitterTrackingID>2CAD3F71B4405EB16392</SubmitterTrackingID>
<DestinationEntry>No</DestinationEntry>
<OneTimeAppt>
  <PreferredAppt>2012-06-29T09:00:00Z</PreferredAppt>
</OneTimeAppt>    
<TrailerInfo>
  <Trailer>
    <TrailerNumber>A</TrailerNumber>
    <TrailerLength>20ft</TrailerLength>
  </Trailer>
  <Carrier>
    <CarrierName>N/A</CarrierName>
    <URL>http://test.com</URL>
  </Carrier>
  <BillOfLadingNumber>N/A</BillOfLadingNumber>
</TrailerInfo>   
</DeliveryApptCreateRequest> 
```

在所需方法之后，应将其更改为所有不带前缀的元素名称`mailxml:`。Like`DeliveryApptCreateRequest`应该成为`mailxml:DeliveryApptCreateRequest` ，而 element like`d2p1:CompanyName`应该保持原样。

我试过以下代码

```
 private void RepalceFile(string xmlfile)
    {
        XmlDocument doc = new XmlDocument();
        doc.Load(xmlfile);
        var a = doc.CreateAttribute("xmlns:mailxml12tm");
        a.Value = "http://idealliance.org/Specs/mailxml12.0a/mailxml_tm";
        doc.DocumentElement.Attributes.Append(a);
        doc.DocumentElement.Prefix = "mailxml12tm";

        foreach (XmlNode item in doc.SelectNodes("//*"))
        {
            if (item.Prefix.Length == 0)
                item.Prefix = "mailxml12tm";
        }
        doc.Save(xmlfile);
    } 
```

唯一的问题是根元素保持原样，而所有元素都根据需要进行更改

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T19:18:01.673

您可以将整个 XML 解析为字符串并在适当的位置插入名称空间。但是，这种解决方案可以创建大量仅在算法中使用的新字符串，这对性能不利。但是，我已经编写了一个以这种方式解析它的函数，并且对于您发布的示例 XML，它似乎运行得非常快；）。如果您想使用它，我可以发布它。

另一种解决方案是将 XML 加载为[XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)并利用它是树状结构的事实。这样，您可以创建一个方法，在适当的地方递归地添加适当的命名空间。不幸的是，`XmlNode.Name`属性是只读的，这就是为什么您必须手动复制 xml 的整个结构来更改某些节点的名称。我现在没时间写代码，就让你写吧。如果您遇到任何问题，请告诉我。

**更新**

我已经测试了您的代码和*Jeff Mercado*建议的代码，它们似乎都可以正常工作，至少在您在问题中发布的示例 XML 中。确保您尝试解析的 XML 与您发布的 XML 相同。

只是为了让它工作并解决最初询问的添加命名空间问题，您可以使用代码，它将整个 XML 处理为 a`String`并手动解析它：

```
private static String UpdateNodesWithDefaultNamespace(String xml, String defaultNamespace)
    {
        if (!String.IsNullOrEmpty(xml) && !String.IsNullOrEmpty(defaultNamespace))
        {
            int currentIndex = 0;

            while (currentIndex != -1)
            {
                //find index of tag opening character
                int tagOpenIndex = xml.IndexOf('<', currentIndex);

                //no more tag openings are found
                if (tagOpenIndex == -1)
                {
                    break;
                }

                //if it's a closing tag
                if (xml[tagOpenIndex + 1] == '/')
                {
                    currentIndex = tagOpenIndex + 1;
                }
                else
                {
                    currentIndex = tagOpenIndex;
                }

                //find corresponding tag closing character
                int tagCloseIndex = xml.IndexOf('>', tagOpenIndex);
                if (tagCloseIndex <= tagOpenIndex)
                {
                    throw new Exception("Invalid XML file.");
                }

                //look for a colon within currently processed tag
                String currentTagSubstring = xml.Substring(tagOpenIndex, tagCloseIndex - tagOpenIndex);
                int firstSpaceIndex = currentTagSubstring.IndexOf(' ');
                int nameSpaceColonIndex;
                //if space was found
                if (firstSpaceIndex != -1)
                {
                    //look for namespace colon between tag open character and the first space character
                    nameSpaceColonIndex = currentTagSubstring.IndexOf(':', 0, firstSpaceIndex);
                }
                else
                {
                    //look for namespace colon between tag open character and tag close character
                    nameSpaceColonIndex = currentTagSubstring.IndexOf(':');
                }

                //if there is no namespace
                if (nameSpaceColonIndex == -1)
                {
                    //insert namespace after tag opening characters '<' or '</'
                    xml = xml.Insert(currentIndex + 1, String.Format("{0}:", defaultNamespace));
                }

                //look for next tags after current tag closing character
                currentIndex = tagCloseIndex;
            }
        }

        return xml;
    } 
```

您可以检查此代码以使您的应用程序正常工作，但是，我强烈建议您确定为什么建议的其他解决方案不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T22:52:43.400

由于在这种情况下您定义了默认命名空间，您可以删除默认命名空间声明并使用旧命名空间名称为新前缀添加新声明，从而有效地替换它。

```
var prefix = "mailxml";
var content = XElement.Parse(xmlStr);
var defns = content.GetDefaultNamespace();
content.Attribute("xmlns").Remove();
content.Add(new XAttribute(XNamespace.Xmlns + prefix, defns.NamespaceName)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-03T08:59:15.193

@JeffMercado 的解决方案对我不起作用（可能是因为我没有默认命名空间）。

我最终使用：

```
XNamespace ns = Constants.Namespace;
el.Name = (ns + el.Name.LocalName) as XName; 
```

要更改我使用的整个文档的命名空间：

```
private void rewriteNamespace(XElement el)
{
    // Change namespace
    XNamespace ns = Constants.Namespace;
    el.Name = (ns + el.Name.LocalName) as XName;

    if (!el.HasElements)
        return;

    foreach (XElement d in el.Elements())
        rewriteNamespace(d);
} 
```

用法：

```
var doc = XDocument.parse(xmlStr);
rewriteNamespace(doc.Root) 
```

高温高压

# apache-flex - Adobe 是否建议我们使用 Flex 或 HTML5 进行企业应用程序开发？

> ID：11103619
> 
> 赞同：0
> 
> 时间：2012-06-19T14:52:37.500
> 
> 标签：apache-flex

**Adobe 是否建议我们使用 Flex 或 HTML5 进行企业应用程序开发？**

*从长远来看，我们相信 HTML5 将是企业应用程序开发的最佳技术。我们还知道，目前，Flex 对于通常与桌面应用程序配置文件相关的大型客户端项目具有明显的优势。鉴于我们在 Flex 方面的创新经验，我们完全有能力为 HTML5 开发的进步做出积极贡献，从移动应用程序开始。事实上，许多从事 Flex SDK 工作的工程师和产品经理将转而从事我们的 HTML 工作。我们将继续为 WebKit 和 jQuery 等开放 Web 技术做出重大贡献，推进 PhoneGap 的开发，并创建新工具来解决开发人员在使用 HTML5 构建应用程序时面临的挑战。*

* * *

这对 flex 是积极的还是消极的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:58:17.267

Flex 现在正在成为 apache 的一部分[http://incubator.apache.org/projects/flex.html](http://incubator.apache.org/projects/flex.html)并且没有人能真正知道聚会的去向。但据我所知，人们对保持 Flex 的活力以及使其更加成熟有着巨大的兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T16:15:32.627

来自 Adob​​e 的博客文章[http://blogs.adobe.com/flex/2011/11/your-questions-about-flex.html](http://blogs.adobe.com/flex/2011/11/your-questions-about-flex.html)

***注意答案的第二部分。***

> **> Adob​​e 是否建议我们使用 Flex 或 HTML5 进行企业应用程序开发？**
> 
> 从长远来看，我们相信 HTML5 将是企业应用程序开发的最佳技术。我们还知道，目前，Flex 对于通常与桌面应用程序配置文件相关的大型客户端项目具有明显的优势。
> 
> 鉴于我们在 Flex 方面的创新经验，我们完全有能力为 HTML5 开发的进步做出积极贡献，从移动应用程序开始。事实上，许多从事 Flex SDK 工作的工程师和产品经理将转而从事我们的 HTML 工作。我们将继续为 WebKit 和 jQuery 等开放 Web 技术做出重大贡献，推进 PhoneGap 的开发，并创建新工具来解决开发人员在使用 HTML5 构建应用程序时面临的挑战。
> 
> **> 你说你相信 HTML 是“企业应用程序的长期解决方案”——你能澄清一下这个说法吗？**
> 
> HTML5 相关技术（包括 HTML、JavaScript 和 CSS）正变得越来越强大，以至于我们有充分的理由相信表现力（例如 Canvas）、性能（例如许多浏览器中的 VM 和 GPU 加速）和应用程序相关功能（例如离线存储、网络工作者）将继续快速发展。随着时间的推移（根据您的应用程序，可能需要 3-5 年），我们相信 HTML5 可以支持当今使用 Flex 的大多数用例。
> 
> 然而，在企业应用程序开发方面，Flex 现在并将继续拥有优于 HTML5 的优势——特别是：
> 
> Flex 跨多个平台提供完整的功能级别一致性 Flex 组件集和编程模型使其在构建复杂的应用程序用户界面时非常高效 ActionScript 是一种成熟的语言，适用于大型应用程序开发 支持工具（Adobe 和第三方）提供关于代码编辑、调试和分析的高效环境 我们关于 Flex SDK 开发方式变化的公告并没有改变 Flex 的基本附加值，也没有使 HTML5 突然比上周更强大。
> 
> 我们打算在 HTML 相关技术上进行投资，以便我们可以帮助推进 HTML5 使其适用于企业应用程序。

# c - mystrlen 函数出错

> ID：11103620
> 
> 赞同：1
> 
> 时间：2012-06-19T14:52:42.107
> 
> 标签：c

我试图写出 C 中可用的字符串函数的一些实现。我的代码是：

```
#include <stdio.h>
#include <stdlib.h>   

char *mystrcpy(char *s1, char *s2)
{
    while(*s1++ = *s2++);
    return s1;
}

int mystrlen(char *s)
{
    int len = 0;
    while(*s != '\0')
    {
        len++;
    }
    return len;
}

int main(void)
{
    char arr = "Hi";
    char arr1[10];
    char arr2[] = "Hello";
    int length;

    mystrcpy(arr1, arr2);
    printf("%s", arr1);

    length = mystrlen(arr);
    printf("%d", length);

    return 0;
} 
```

`mystrcpy`工作正常，但其他方法`mystrlen`不执行。可能是什么错误？以下是程序终止说明：

> 进程以 -1073741510 状态终止（0 分 4 秒）

此外，很少有与演员表相关的警告。代码中是否有我应该使用任何演员表的地方？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:54:52.903

**首先，你`mystrlen`有一个无限循环。**

固定代码：

```
int mystrlen(const char *s)
{
    int len = 0;
    while (*s++ /* increment to next character every loop */ != '\0')
    {
        len++;
    }
    return len;
} 
```

还添加了`const`，因为您从不更改引用的数据`*s`

**二、赋值：`char arr="Hi";`无效。**

您正在尝试将`char[]`数组分配给`char`变量。正确的形式是以下*之一*：

```
char arr[]="Hi"; // array syntax
char *arr="Hi";  // pointer syntax 
```

鉴于您的`arr`分配无效，您的运行时错误很可能是由于`mystrlen`尝试不正确的 deference引起的`arr`。

*你用的是什么编译器？大多数符合标准的编译器应该已经发现了第二个问题。如果使用 GCC，请将`-Wall`标志添加到您的 makefile。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T14:55:03.527

这：

```
char arr="Hi"; /* Should have caused compiler warning,
                  as is attempting to assign a char
                  to a char[3]. */ 
```

应该：

```
char arr[] ="Hi"; 
```

或者：

```
char* arr = "Hi"; 
```

# knockout.js - 使用 Mapping 插件的 Knockoutjs Cascading 下拉列表：未定义的引用错误

> ID：11103623
> 
> 赞同：0
> 
> 时间：2012-06-19T14:52:54.083
> 
> 标签：knockout.js, knockout-mapping-plugin, knockout-2.0

我正在尝试基于 Knockout.js [Cart 示例](http://knockoutjs.com/examples/cartEditor.html)创建一个级联下拉列表，但使用 Mapping 插件来获取我的数据。

我的映射插件工作正常，模板工作正常，第一个选择很好，但第二个选择出错。

错误：

```
Uncaught Error: Unable to parse bindings. 
```

消息：ReferenceError：PayCodes 未定义；绑定值：options:PayCodes, optionsValue:'Value', optionsText:'Text', value: $parent.PayCodeId

换行：

```
<select data-bind="options:PayCodes, optionsValue:'Value', optionsText:'Text', value: $parent.PayCodeId" class='type'></select> 
```

to：（添加了“this”关键字）

```
<select data-bind="options:this.PayCodes, optionsValue:'Value', optionsText:'Text', value: $parent.PayCodeId" class='type'></select> 
```

修复了错误，但第二个选择仍然不起作用。它永远不会有任何选择。PayCodes 数组存在，如附加的 JSON 数据所示。

这是复制问题的小提琴：http: [//jsfiddle.net/JLhSx/13/](http://jsfiddle.net/JLhSx/13/)

格式化的 JSON 在[这里](http://jsfiddle.net/8kbTR/)，以防万一。

有什么建议么？

**编辑原件：**

添加

在我的“with:”部分中只返回我的 PayTypeId 的 ID，因此“with:”部分没有像我预期的那样获得完整的可观察的 PayTypes 数组。我该如何重构它，以便第一个下拉列表显示 PayTypes 列表，第二个下拉列表显示所选 PayType 的 PayCodes？

更新[的小提琴](http://jsfiddle.net/XJScd/2/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T14:08:40.213

好的，我已经成功了。请让我知道是否有更好的方法。

[在这里更新小提琴](http://jsfiddle.net/JLhSx/14/)

我使用了带有嵌套 if 的 foreach。不过，这似乎有点骇人听闻或矫枉过正。现在我很高兴它有效！

```
<td>
    <select data-bind='options:PayTypes, optionsValue:"Id",optionsText:"PayType", value: PayTypeId ' class='type'></select>
</td>
<td data-bind="foreach: PayTypes">
    <!-- ko if: (Id() == $parent.PayTypeId())  -->
       <select data-bind="options:PayCodes, optionsValue:'Value', optionsText:'Text', value:$parent.PayCodeId" class='type'></select>
    <!-- /ko -->
</td> 
```

没有循环的更好版本受到赞赏，并且肯定会被标记为答案。

# javascript - 除非我按下“返回”按钮，否则 jQuery 结果不会显示

> ID：11103626
> 
> 赞同：1
> 
> 时间：2012-06-19T14:53:09.627
> 
> 标签：javascript, jquery, html, back

我有一个奇怪的问题，我的函数正在正常工作（一个 jQuery 抽奖生成器），但除非我按下浏览器上的后退按钮，否则它不会显示输出。代码是：

```
$(document).ready(function() {
$("input[name=Submit]").click(function() {
    var x = $("input[name=playerNumber]").val();
    var y = $("input[name=teamNumber]").val();
    var playerArray = new Array(x);
    var teamArray   = new Array(y);
    var areaToAddTo = $('#playerArea');
    for (var i = 0; i < x; i++) {
        playerArray[i] = prompt("What is the name of player "+(i+1)+"?");
    }
    for (var j = 0; j < y; j++) {
        teamArray[j] = prompt("What is the name of team "+(j+1)+"?");
    }
    var teamsToLeaveOut = teamArray.length % playerArray.length;
    var count = 0;
    var randomNumber;
    while (count < teamsToLeaveOut) {
        randomNumber = Math.floor(Math.random()*(teamArray.length));
        teamArray.splice(randomNumber, 1);
        count++;
    }
    count = teamArray.length;
    var spliceTeam;
    var l;
    while (count > 0) {
        for (i = 0; i < playerArray.length; i++) {
            randomNumber = Math.floor(Math.random()*teamArray.length);
            spliceTeam = teamArray[randomNumber];
            l += ('<h3>'+playerArray[i]+'</h3>');
            l += ('<p>'+spliceTeam+'</p>');
            teamArray.splice(randomNumber,1);
            count--;
        }
    }
    if (1 == 1) {
        areaToAddTo.append(l);
    }
});
}); 
```

在运行该函数时，屏幕上没有写入任何内容，浏览器 url 为： `/sweepstake.html?playerNumber=2&teamNumber=5&Submit=Submit`

按下后退按钮时，输出应为正常，浏览器 url 为： `/sweepstake.html`

对于如何解决这个问题，有任何的建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T14:59:36.937

您的表单正在提交，阻止提交，您将不必返回它。

```
 ...
    if (1 == 1) { // ??
        areaToAddTo.append(l);
    }
    return false;
});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T14:59:53.333

正如评论中提到的，浏览器正在尝试提交表单，这会将您带到一个新的 url，这不是您想要的。要么使用一个普通的旧按钮来启动你的函数，要么通过在处理程序的最后一行返回 false 来防止默认提交行为。

# c# - 使用带有 where 子句的数据表数据更新数据库

> ID：11103630
> 
> 赞同：0
> 
> 时间：2012-06-19T14:53:17.003
> 
> 标签：c#, asp.net, sql, datatable

我正在构建一个程序，如果选民提前投票，它将用 1 更新我的数据库中的提前投票列。我需要一种方法，用户可以上传 CSV 并将该 CSV 的 id 列与我数据库中选民的 id 匹配，然后更新他的早期投票状态。由于 CSV 将来自用户，因此我不知道 CSV 中的列数，有些可能有 2 列，有些可能有 10 列，但所有列都会有一个 id 列，该列将与我数据库中选民的 id 匹配。我有上传 CSV 并将其插入数据表的代码，但我需要有关插入数据库的逻辑的帮助。我在想这样的事情，但不知道正确的处理方法。

```
 UPDATE personal SET earlyVoted = 1 where personal.id = datatable.id 
```

这是我的数据表代码

```
string target = Server.MapPath("~/Upload");
    if (FileUpload1.HasFile)
    {
        FileUpload1.SaveAs(System.IO.Path.Combine(target, FileUpload1.FileName));
        string connString = string.Format("Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0};Extended Properties=Text;", System.IO.Path.GetDirectoryName(target + "\\" + FileUpload1.FileName));
        string cmdString = string.Format("SELECT * FROM {0}", System.IO.Path.GetFileName(target + "\\" + FileUpload1.FileName));
        OleDbDataAdapter dataAdapter = new OleDbDataAdapter(cmdString, connString);
        DataSet dataSet = new DataSet();
        dataAdapter.Fill(dataSet);
        GridView1.DataSource = dataSet.Tables[0];
        GridView1.DataBind();
    } 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:14:54.793

```
UPDATE (SELECT personal.earlyvoted 
          FROM personal
             , datatable 
         WHERE personal.id = datatable.id) 
   SET earlyvoted = 1; 
```

您将需要每个表中 id 的主键。

# selenium-webdriver - 尝试在 JMeter 中运行 Selenium JUnit 测试

> ID：11103636
> 
> 赞同：1
> 
> 时间：2012-06-19T14:53:45.333
> 
> 标签：selenium-webdriver, jmeter, junit4

我想做的是在 JMeter 中运行一些我用 Selenium Webdriver 和 JUnit 进行的测试。我遵循的步骤是：

*   在 Eclipse 中进行测试后，我用文件制作了一个 .jar 存档并将其放在 JMeter ./lib/junit 目录中。我还将 selenium-server.jar 添加到 ./lib 目录
*   在此之后，在 JMeter 中，我将测试 .jar 添加到测试计划类路径中，并制作了一个 JUnit 请求采样器。在这里，我可以看到并选择我的测试类名称和测试方法。问题是当我单击“运行”按钮时，没有浏览器启动，并且测试在几秒钟后停止。它似乎没有做任何事情。该日志包含以下内容：

```
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：运行测试！
2012/06/19 14:53:07 信息 - jmeter.testelement.TestPlan：将 /home/x/apache-jmeter-2.7/lib/junit/jmeterTest.jar 添加到类路径
2012/06/19 14:53:07 信息-jmeter.gui.util.JMeterMenuBar:setRunning(true,*local*)
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：为组线程组启动 2 个线程。
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：线程将继续出错
2012/06/19 14:53:07 信息 - jmeter.threads.JMeterThread：线程开始：线程组 1-1
2012/06/19 14:53:07 信息 - jmeter.protocol.java.sampler.JUnitSampler: 字符串构造函数:: net.basic.SupplierViewTest.(java.lang.String)
2012/06/19 14:53:07 信息 - jmeter.protocol.java.sampler.JUnitSampler: 字符串构造函数:: net.basic.SupplierViewTest.(java.lang.String)
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：所有线程都已启动
2012/06/19 14:53:07 信息 - jmeter.threads.JMeterThread：线程完成：线程组 1-1
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：结束线程线程组 1-1
2012/06/19 14:53:07 信息 - jmeter.threads.JMeterThread：线程开始：线程组 1-2
2012/06/19 14:53:07 信息 - jmeter.protocol.java.sampler.JUnitSampler: 字符串构造函数:: net.basic.SupplierViewTest.(java.lang.String)
2012/06/19 14:53:07 信息 - jmeter.protocol.java.sampler.JUnitSampler: 字符串构造函数:: net.basic.SupplierViewTest.(java.lang.String)
2012/06/19 14:53:07 信息 - jmeter.threads.JMeterThread：线程完成：线程组 1-2
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：结束线程线程组 1-2
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：通知测试侦听器测试结束
2012/06/19 14:53:07 信息 - jmeter.gui.util.JMeterMenuBar: setRunning(false,*local*)
2012/06/19 14:53:07 信息 - jmeter.engine.StandardJMeterEngine：测试已在主机 null 上结束

```

从我从 JMeter 收到的信息中，我无​​法弄清楚发生了什么以及问题出在哪里。有没有人对此有所了解或已尝试成功完成这项工作？有没有我错过的步骤？谢谢你。

玛丽亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:52:02.883

看看[这个](https://stackoverflow.com/a/7823777/993246)，也许它会对你有所帮助。

# r - 生成/绘制对数正态生存函数

> ID：11103637
> 
> 赞同：6
> 
> 时间：2012-06-19T08:49:02.650
> 
> 标签：r, data-visualization

我想绘制 SAS LIFEREG 中的加速故障时间模型。因为 SAS 在绘图方面非常糟糕，所以我想实际为 R 中的曲线重新生成数据并在那里绘制它们。SAS 给出了一个尺度（在指数分布固定为 1 的情况下）、一个截距和一个用于暴露或未暴露人群的回归系数。

有两条曲线，一条用于暴露人群，一条用于未暴露人群。其中一个模型是指数分布，我生成的数据和图表如下：

```
intercept <- 5.00
effect<- -0.500
data<- data.frame(time=seq(0:180)-1)
data$s_unexposed <- apply(data,1,function(row) exp(-(exp(-intercept))*row[1]))
data$s_exposed <- apply(data,1,function(row) exp(-(exp(-(intercept+effect))*row[1])))

plot(data$time,data$s_unexposed, type="l", ylim=c(0,1) ,xaxt='n',
     xlab="Days since Infection", ylab="Percent Surviving", lwd=2)
axis(1, at=c(0, 20, 40, 60, 80, 100, 120, 140, 160, 180))
lines(data$time,data$s_exposed, col="red",lwd=2)
legend("topright", c("ICU Patients", "Non-ICU Patients"), lwd=2, col=c("red","black") ) 
```

这给了我这个：

![在此处输入图像描述](../Images/adc2816cf078e05b67eacb0ba68673f5.png)

不是有史以来最漂亮的图表，但我真的不知道如何围绕 ggplot2 来修饰它。但更重要的是，我有第二组数据来自对数正态分布，而不是指数，我尝试为其生成数据的尝试完全失败了——将 cdf 合并为正态分布等它超出了我的 R 技能。

谁能指出我正确的方向，使用相同的数字和 1 的比例参数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T16:25:17.253

对数正态模型在时间 t 的生存函数可以用 R 表示`1 - plnorm()`，其中`plnorm()`是对数正态累积分布函数。为了说明，为了方便起见，我们首先将您的绘图放入一个函数中：

```
## Function to plot aft data
plot.aft <- function(x, legend = c("ICU Patients", "Non-ICU Patients"),
    xlab = "Days since Infection", ylab="Percent Surviving", lwd = 2,
    col = c("red", "black"), at = c(0, 20, 40, 60, 80, 100, 120, 140, 160, 180),
        ...)
{
    plot(x[, 1], x[, 2], type = "l", ylim = c(0, 1), xaxt = "n", 
            xlab = xlab, ylab = ylab, col = col[2], lwd = 2, ...)
    axis(1, at = at)
    lines(x[, 1], x[, 3], col = col[1], lwd=2)
    legend("topright", legend = legend, lwd = lwd, col = col)
} 
```

接下来，我们将指定系数、变量和模型，然后生成指数和对数正态模型的生存概率：

```
## Specify coefficients, variables, and linear models
beta0 <- 5.00
beta1 <- -0.500
icu <- c(0, 1)
t <- seq(0, 180)
linmod <- beta0 + (beta1 * icu)
names(linmod) <- c("unexposed", "exposed")

## Generate s(t) from exponential AFT model
s0.exp <- dexp(exp(-linmod["unexposed"]) * t)
s1.exp <- dexp(exp(-linmod["exposed"]) * t)

## Generate s(t) from lognormal AFT model
s0.lnorm <- 1 - plnorm(t, meanlog = linmod["unexposed"])
s1.lnorm <- 1 - plnorm(t, meanlog = linmod["exposed"]) 
```

最后，我们可以绘制生存概率：

```
## Plot survival
plot.aft(data.frame(t, s0.exp, s1.exp), main = "Exponential model")
plot.aft(data.frame(t, s0.lnorm, s1.lnorm), main = "Log-normal model") 
```

结果数字：

![指数模型](../Images/0a4f343191809e5479d7d6c5124b481d.png)

![对数正态模型](../Images/d52c370fb1f9dc135d27099965aee4fe.png)

注意

```
plnorm(t, meanlog = linmod["exposed"]) 
```

是相同的

```
pnorm((log(t) - linmod["exposed"]) / 1) 
```

这是对数正态生存函数的规范方程中的 Φ：S(t) = 1 - Φ((ln(t) - µ) / σ)

我相信您知道，有许多 R 包可以处理具有左、右或间隔审查的加速故障时间模型，如[生存任务视图](http://cran.r-project.org/web/views/Survival.html)中所列，以防您碰巧对 R 产生了偏好SAS。

# c# - 使用循环为数据网格单元格赋值

> ID：11103639
> 
> 赞同：0
> 
> 时间：2012-06-19T14:53:51.277
> 
> 标签：c#, list

我想为数据网格中的单元格分配一些值（一些列）使用

```
foreach(var member in listofmember)
{
   ///what method is possible
} 
```

listofmember 是一个结构列表。我只想在数据网格中显示一些结构的成员。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T20:52:04.347

如果您分配 ItemSource 更好地处理此类情况，例如您的 DataGrid 包含`Person`类信息，因此您可以将其分配给 Person 列表：

```
myDataGrid.ItemSource = new List<Person>{p1,p2,p3}; 
```

您也可以简单地在您的列表中搜索并对其进行更改，最后将其重新分配给您的网格。通过这种方式，您可以将它们分开，您也可以在将来使用 NotifyPropertyChange。

# imagemagick - ImageMagick - 禁止警告信息

> ID：11103640
> 
> 赞同：2
> 
> 时间：2012-06-19T14:53:54.910
> 
> 标签：imagemagick, cmd

我有以下内容用于获取 PDF 文档中的总页数：

```
identify -format %n test.pdf 
```

然后我去除所有非数字字符以从响应中获取单个整数。

有时会产生以下错误，这会导致上面产生错误的页数，因为它们是与响应中的页面无关的其他数字。

```
 **** Warning: Fonts with Subtype = /TrueType should be embedded.
             The following fonts were not embedded:
                    Arial
                    Arial,Bold
                    Arial,Italic
                    Times New Roman

    **** This file had errors that were repaired or ignored.
    **** The file was produced by:
    **** >>>> Microsoft« Office Word 2007 <<<<
    **** Please notify the author of the software that produced this
    **** file that it does not conform to Adobe's published PDF
    **** specification.

    9 
```

“9”是文档中的页数。

如何抑制警告消息，我尝试使用“-quiet”标志，但仍然产生消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T11:00:23.287

警告会发送到 stderr，所以一个简单的输出重定向就可以解决问题：

```
 identify -format %n test.pdf 2>/dev/null 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-09T16:59:31.030

从识别的手册页：

> -quiet 抑制所有警告信息

因此，为了抑制警告消息，您的命令应如下所示：

```
identify -quiet -format %n test.pdf 
```

# sharepoint - SharePoint 控制台程序无法加载 System.Web.Extensions，Version=4.0.0.0 程序集

> ID：11103642
> 
> 赞同：0
> 
> 时间：2012-06-19T14:53:57.283
> 
> 标签：sharepoint, assemblies

我正在编写一个控制台应用程序，它使用 SharePoint 对象模型来操作 SharePoint 内部的数据。

有两个变量：

```
SPWeb spWeb
string formsUser   //username 
```

我正在尝试解决用户

```
SPUser userF = spWeb.EnsureUser(formsUser); 
```

此行不断抛出异常：

> 无法加载文件或程序集“System.Web.Extensions，Version=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。系统找不到指定的文件。

我项目的目标框架是 .Net Framework 3.5。我有参考`System.Web.Extensions.dll`，版本 3.5.0.0..

我不理解的：

1.  为什么我的应用程序期望这个程序集是版本`4.0.0.0`而不是版本`3.5.0.0`？
2.  为什么这一行会抛出异常`System.Web.Extensions`，如果这一行中的所有内容都与`Microsoft.SharePoint`汇编有关

**更新：**
在上面的示例中，我使用基于表单的用户，因此字符串类似于：`i:0#.f|someprovider|john.doe`. 如果我改用基于 Windows 的用户，`i:0#.w|domain\john.doe`则不会引发此异常。

有没有什么机会，`SPUser`就是偷偷尝试使用`System.Web.Extensions`，却失败了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T08:04:09.057

我找到了解决方案：

我的应用程序中的`app.config`文件包含`system.web/membership`和`roleManager`部分。并且提到了`System.Web.Extensions, Version=4.0.0.0`

```
<add name="ClientAuthenticationMembershipProvider" 
     type="System.Web.ClientServices.Providers.ClientFormsAuthenticationMembershipProvider, System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" /> 
```

# php - 将 JS 变量数据发送到可下载页面

> ID：11103649
> 
> 赞同：0
> 
> 时间：2012-06-19T14:54:12.997
> 
> 标签：php, javascript

这个 javascript 函数接受 JSON 并将其格式化为 XML。数据是一个长的 XML 字符串，我想允许用户下载。我正在尝试使用 ajax 将数据发布到 php 页面，wichi 将创建文件，然后允许用户下载它。

```
 json2xml(eval(data)); 
```

JS

```
 $.ajax({
   type: 'POST',
   url: 'download/functions.php',
   data: xml2,
   dataType: XML
 }); 
```

我已使用此 PHP 函数写入文件，但我不确定现在如何将 js 变量发送到此函数。

```
 $data = $_POST['xml2'];

 writetoxml($data, 'WF-XML'.$current. '.xml'); 

 function writetoxml($stringData, $myFile) {
    $current = date('m-d-Y-g-i-s');
    $fh = fopen('download/'.$myFile, 'w') or die("can't open file");
    fwrite($fh, $stringData);
    fclose($fh);
    download($file);
  }

 function downloadFile($file) {

 if(!file)
 {
     // File doesn't exist, output error
     die('file not found');
 }
 else
 {
     // Set headers
     header("Cache-Control: public");
     header("Content-Description: File Transfer");
     header("Content-Disposition: attachment; filename=$file");
     header("Content-Type: application/csv");
     header("Content-Transfer-Encoding: binary");

     // Read the file from disk
     readfile($file);
     exit;
 } 
```

}

这当前返回服务器 500 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:55:39.407

### 更新：

使用您提供的 jQuery AJAX 调用：

```
$.ajax({
   type: 'POST',
   url: 'download/yourphpscript.php',
   data: { xml: xml2 },
   dataType: XML
}); 
```

你的 PHP 看起来像这样：

```
<?php
$xml = $_POST['xml'];
// Not sure where you're trying to get $file from

writetoxml($xml, $file);

function writetoxml($stringData, $myFile) {
    $current = date('m-d-Y-g-i-s');
    $fh = fopen('download/'.$myFile, 'w') or die("can't open file");
    fwrite($fh, $stringdata);
    fclose($fh);

    download($file);
}

function download($file)
{
    if (file_exists($file)) {
        header('Content-Description: File Transfer');
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename='.basename($file));
        header('Content-Transfer-Encoding: binary');
        header('Expires: 0');
        header('Cache-Control: must-revalidate');
        header('Pragma: public');
        header('Content-Length: ' . filesize($file));
        ob_clean();
        flush();
        readfile($file);
        exit;
    }
}
?> 
```

尝试传递一个对象（在本例`{ key: value }`中为`$.ajax`调用的 data 属性，以便您可以通过您的密钥引用它。在这种情况下，我们的密钥`xml`在 PHP 端，我们抓取`$_POST['xml']`它应该为您提供 xml2.xml 的内容。

下载代码取自[readfile() 上的 PHP 文档](http://php.net/manual/en/function.readfile.php)。但是，我仍然不禁想到有更好的方法来实现这一点。

我**强烈**建议不要让用户在您的服务器上有效地创建一个包含他们想要的任何内容的 Web 可访问文件。如前所述，澄清您的总体目标会有所帮助。我想我理解*你*想要做什么，但你*为什么*这样做会很高兴知道，因为可能有更好、更安全的方法来实现相同的结果。

# c++ - C++ 向量对初始化

> ID：11103652
> 
> 赞同：39
> 
> 时间：2012-06-19T14:54:31.903
> 
> 标签：c++, vector, std-pair

我有

```
vector< pair<int, int>> myVec (N); 
```

我想让所有对初始化为-1，-1。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-06-19T14:55:19.777

干得好：

```
#include <utility>

vector<pair<int, int>> myVec (N, std::make_pair(-1, -1)); 
```

该构造函数的第二个参数是 N 对将采用的初始值。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2017-08-08T08:48:43.167

只是添加一些额外的信息（不是提问者想要的，但在接受的答案的评论中要求）：

可以使用 (C++11) 完成单独的初始化：

```
std::vector<std::pair<int, int> > vec1 = { {1, 0}, {2,0}, {3,1} };

std::vector<std::pair<int, int> > vec2 = {std::make_pair(1, 0),
                                           std::make_pair(2, 0),
                                           std::make_pair(3, 0)}; 
```

在旧的 C++ 标准中，这样的事情会起作用：

```
const std::pair<int,int> vals[3] = {std::make_pair(1, 0),
                                    std::make_pair(2, 0),
                                    std::make_pair(3, 0)};
std::vector<std::pair<int, int> > vec2 (&vals[0], &vals[0] + 3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-25T11:19:55.293

如果你想**初始化所有 pair**，也许你可以这样做：

```
vector<pair<int, int>> directions {
    {1, 0},
    {-1, 0},
    {0, 1},
    {0, -1},    
}; 
```

在这里，4 对已经被初始化。

# wcf - Castle Windsor 和 WCF 何时注册和发布组件

> ID：11103662
> 
> 赞同：0
> 
> 时间：2012-06-19T14:55:00.510
> 
> 标签：wcf, dependency-injection, castle-windsor, global-asax

我正在使用 Castle Windsor 将依赖项注入到多个 WCF 服务中。我们还使用 Castle.Facilities.WcfIntegration.DefaultServiceHostFactory 和城堡的 wcfFacility。我们的服务托管在 IIS 中，这使我可以访问 Global.aspx 事件。我们所有的组件都在瞬态生命周期中注册。目前我在 application_start 事件期间注册容器中的所有组件，然后在 application_end 中处理容器。

但是，在阅读了几个博客和一些 SO 帖子后，我开始担心我的解决方案有漏洞。换句话说，我认为在 application_end 释放容器会导致内存从我的应用程序中慢慢泄漏。我正在考虑在 request_start 和 request_end 或mabye session_start 和 session_end 事件中注册和释放。我遇到的问题是我不知道在哪里“保留”容器，所以我可以在会话或请求结束后释放它。有没有人遇到过这个问题？如果是这样，你是如何解决的？我的解决方案听起来对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T05:05:37.503

实例化容器并在其中注册所有内容`Application_Start`是正确的做法，并且将容器处置在其中`Application_End`也是正确的。

通常，当提到与 Castle Windsor 相关的“内存泄漏”一词时，这是因为临时组件没有正确释放其实例，这反过来可能导致实例在容器中累积。这是因为 Windsor 会跟踪它交给您的实例，如果它们的依赖关系图包含任何涉及退役的东西（例如，实现的东西`IDisposable`）。

因此，作为温莎的一般规则，您应该始终释放您解决的问题。

从未使用过 WCF 设施，我并不是这方面的专家，但如果它没有正确发布它解决的所有问题，我会感到非常惊讶 - 所以我很好奇你是否*知道*有问题，或者如果你只是保持谨慎？

# android - Android 在 Equalizer 类中提供的频段范围是多少？

> ID：11103673
> 
> 赞同：4
> 
> 时间：2012-06-19T14:55:18.283
> 
> 标签：android

默认情况下，android 在其 Equalizer 类中提供了 5 个波段。
我想知道每个波段的范围是多少。

这就是每个频段的起始和最终范围（Hz/KHz 或任何其他单位）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T10:25:11.767

自己搞定了：

```
short minEQLevel = mEqualizer.getBandLevelRange()[0];
short maxEQLevel = mEqualizer.getBandLevelRange()[1]; 
```

# rest - SOAP 应用程序和 REST 应用程序可以通过 IIS 托管在同一台服务器上吗？

> ID：11103675
> 
> 赞同：1
> 
> 时间：2012-06-19T14:55:19.653
> 
> 标签：rest, soap, iis-7

如果这个问题没有意义，我提前道歉。我是新手。

我有一台通过 IIS 7.0 托管多个 SOAP 服务的服务器。我现在需要使用 REST 模型编写不同的服务。这可以与我的其他服务托管在同一台服务器上吗？

与我一起工作的高级开发人员认为这是不可能的，但似乎没有人能确定哪一种方式。

感谢您提供的任何帮助或指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:40:00.100

是的，它们甚至可以托管在 IIS 内的同一个网站中。IIS 并不关心您的网站正在实施什么，它只是传递请求。

我为 Silverlight 页面托管 SOAP，为同一网站内的客户端应用程序托管 REST。

您真正需要做的就是在 Web.Config 中正确设置端点配置

# path - 在 OSx 上设置 PATH 有什么作用？

> ID：11103677
> 
> 赞同：0
> 
> 时间：2012-06-19T14:55:34.740
> 
> 标签：path

我正在尝试在我的 Mac 上使用 django 安装 mysql，教程说我必须：

```
Add /usr/local/mysql/bin/ to PATH
export PATH=/usr/local/mysql/bin/:$PATH
(from my ~/.bashrc) 
```

我知道设置路径有助于查找可执行文件，但我知道您可以在 bash 配置文件中设置多个路径。这是如何运作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:01:24.440

> 我知道设置路径有助于查找可执行文件

当您键入时，它会依次在路径中的每个目录中`foo`查找调用的可执行文件。`foo`

> 但我知道您可以在 bash 配置文件中设置多个路径。这是如何运作的？

您只能设置一个 PATH 变量。它包含将要检查的目录的冒号分隔列表。

# c# - 同步 SQL Server 和程序

> ID：11103678
> 
> 赞同：0
> 
> 时间：2012-06-19T14:55:38.717
> 
> 标签：c#, sql-server, c#-4.0, sql-server-ce, console-application

我有两个脚本在一个程序中调用，第一个脚本创建一个数据库，另一个是填充数据库的脚本。

如何在启动第二个脚本之前知道第一个脚本是否完成？

如何等待第一个通知进程结束的第二个脚本？服务器如何通知数据库程序的创建，然后继续进行进一步的工作？代码

字符串 createDatabasePath = args[0];

```
 sqlConnectionStr = Properties.Settings.Default.conString;
        SqlConnection conn = new SqlConnection(sqlConnectionStr);
        conn.Open();
        SqlCommand comm = new SqlCommand();
        comm.Connection = conn;
        FileInfo file = new FileInfo(createDatabasePath);
        string script = file.OpenText().ReadToEnd();
        script = script.Replace("GO", "");
        comm.CommandText = script;
        comm.ExecuteNonQuery(); 
```

我的问题是executenonquery何时完成？我怎么知道？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T16:24:27.977

我们需要知道“在一个程序中”是什么意思——是一组 T-SQL 命令还是一个 C# 应用程序等？但是，确保一个在另一个之前完成的最简单方法是将它们组合成一个过程，或者让第一个调用第二个：

```
...Do the stuff in Process1;
EXEC Process2; 
```

一个更复杂的选项是更改第二个过程以检查新数据库是否存在并等待一段时间，直到它完成：

```
DECLARE @I INT
SET @I = 0

WHILE @I = 0
BEGIN
    IF OBJECT_ID('NewDB..tblFinalTableCreated') IS NOT NULL 
        SET @I = 1
    ELSE 
        WAITFOR DELAY '00:05:00' --Wait 5 minutes
END

StartProcess2; 
```

# c# - 连接字符串中下划线后的数据库名称被忽略

> ID：11103679
> 
> 赞同：5
> 
> 时间：2012-06-19T14:55:41.213
> 
> 标签：c#, .net, sql

我正在尝试做一些我认为非常简单的事情。我有一个从数据库中获取的连接字符串。当我创建一个新的 SQL 连接实例时，它看起来（当我调试和查看对象时）就像它正在正确填充 db 连接字符串一样。但是，我收到的错误消息让我认为数据库名称中下划线之后的所有信息都被删除了。

代码示例：

```
Database db = new SqlDatabase(ConnectionString); // Connection string appears correct
DbCommand dbCommand = db.GetStoredProcCommand("StoredProcName");
DataSet approverDataset = db.ExecuteDataSet(dbCommand); // when this executes, exception is generated 
```

当我运行此代码时，我收到以下异常消息：服务器主体“testdb_psidentity”无法在当前安全上下文下访问数据库“testdb”

这是我的连接字符串：

```
DataSource=testserver.com;Database=testdb_ps;Trusted_Connection=false;uid=testdb_psidentity;pwd=testpwd 
```

我尝试将其更改为：

```
DataSource=testserver.com;Database=[testdb_ps];Trusted_Connection=false;uid=testdb_psidentity;pwd=testpwd 
```

虽然这似乎得到了数据库的全名，但它似乎也在寻找名称中包含这些括号的数据库。当我收到此错误时：无法打开登录请求的数据库“[testdb_ps]”。登录失败。用户“testdb_psidentity”登录失败。

但是，我可以在 SQL Server Management Studio 中使用该登录名/密码登录连接到数据库。

有什么办法可以让它接受数据库名称 testdb_ps 数据库名称？我无法简单地更改数据库名称，因为我无权访问它，而且我被告知根本不会更改数据库名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:08:17.947

您可以尝试在连接字符串周围加上引号，我认为它将下划线解释为分隔符。

根据您使用它的方式使用引号或

```
&quot; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T17:49:28.290

您可以通过 SQL Server Management Studio 连接到数据库吗？

尝试

1.  禁用防火墙
2.  使用 IP 地址
3.  显式使用 sql server 实例名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T19:33:17.447

使用向导生成实体类。这样，您将在 app.config 中获得编码的连接字符串

# actionscript-3 - 如何在 as3、flex 中加载多层图像？

> ID：11103680
> 
> 赞同：0
> 
> 时间：2012-06-19T14:55:43.180
> 
> 标签：actionscript-3, flash, apache-flex

有谁知道如何在 as3, flex 中加载多层图像。并且应该可以选择更改每一层的填充颜色。就像这个网站上的这里一样，剪贴画被加载到图层中，并且可以为每个图层指定颜色

[http://opentshirts.org/version1](http://opentshirts.org/version1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T18:25:35.343

看看[ColorTransform](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/geom/ColorTransform.html)。

```
// some displayobject
var someDisplayObject:DisplayObject = topLayer;

// tint to white 100%
someDisplayObject.transform.colorTransform = new ColorTransform(1,1,1,1,255,255,255,0);

// tint to black 100%
someDisplayObject.transform.colorTransform = new ColorTransform(0,0,0,1); 
```

# java - 默认 java 构造函数

> ID：11103681
> 
> 赞同：2
> 
> 时间：2012-06-19T14:55:48.610
> 
> 标签：java, class, constructor

由于我是 java 新手，所以我想知道， 1\. 当我创建一个空类时定义了多少个默认构造函数？2\. 我需要定义复制构造函数还是像 C++ 中那样自动定义？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T14:57:46.910

> ***1\. 创建一个空类时定义了多少个默认构造函数？***

一类如

```
class MyClass {
} 
```

有*一个*默认（空）构造函数，其行为类似于

```
...
    public MyClass() {
    }
... 
```

> ***2\. 我需要定义复制构造函数还是像 C++ 中那样自动定义？***

Java 中没有内置复制构造函数的概念，这有一个根本原因：

在 Java**中，变量永远不能包含对象**（它只能包含对对象的*引用*）。所以在做的时候，就不需要复制引用`foo(obj)`的对象了。`obj`

要制作对象的副本，您通常会创建一个构造函数，例如

```
...
    public MyClass(MyClass objToCopy) {
        this.field1 = objToCopy.field1;
        ...
        this.fieldN = objToCopy.fieldN;
    }
... 
```

或者你依赖`clone()`机制。

**相关问题：**

*   [为什么Java没有复制构造函数？](https://stackoverflow.com/questions/827785/why-doesnt-java-have-a-copy-constructor)
*   [Java 默认构造函数](https://stackoverflow.com/questions/4488716/java-default-constructor)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-19T14:57:40.060

只有一个默认构造函数，仅在您为类声明没有构造函数时才定义。否则，声明的构造函数将是唯一的构造函数。如果不包含构造函数，编译器会插入相当于

```
public ClassName() {
  super();
} 
```

另外，如果你为一个类声明了构造函数，而你没有显式定义超类的构造函数调用，编译器会插入一个参数匹配调用到超类。

```
public ClassName extends SuperClassName {

  public ClassName(String item, List stuff) {
    // no explicit super class constructor called
    ...
  }

} 
```

在编译器中被转换成类似的东西

```
public ClassName extends SuperClassName {

  public ClassName(String item, List stuff) {
    // explicit super class constructor call to SuperClassName(item, stuff);
    super(item, stuff); 
    ...
  }

} 
```

要定义复制构造函数，没有特殊的语法，您基本上定义了一个构造函数，它将您的类的另一个实例作为参数。

```
public ClassName(ClassName other) {
  field = other.field;
  field2 = other.field2;
  field3 = new ArrayList(other.field3);
  ...
} 
```

没有默认的复制构造函数，实际上没有复制构造函数，只有构造函数。如果您决定创建一个或多个似乎复制对象的东西，那就这样吧。

Java 需要较少类型的项目的原因在某种程度上与不重载基本运算符有关。如果您不赋予更多含义，`=`那么您就不需要那么多类型的构造函数来支持不同的对象分配方法。

`=`可以如此简单地使用的原因之一是由于 Java 只传递引用，这有点像指针。但是，它们是强类型的，你不能做任何指针数学，也不能访问偏移量。因此，它们仅适用于赋值和通过引用传递，这可以防止大多数指针问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T15:06:51.987

如果没有指定构造函数，则自动定义一个空的构造函数。只要您指定一个或多个构造函数，就只会定义这些构造函数。

没有复制构造函数，但 Java 中的每个类都从作为 clone() 方法的 Object 扩展而来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T15:01:44.460

最重要的是，答案都很好..只需再添加一件事就可以更清楚地了解..默认构造函数是当您没有定义任何构造函数时编译器会自行添加的构造函数...根据上面的 ans ：

`public ClassName() { super(); }`

但是如果你自己在类中编写构造函数......就像你在类中编写相同的构造函数一样......从技术上讲，这个构造函数不会被称为默认构造函数......

我希望你明白这一点..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-19T14:56:42.840

如果您不创建任何构造函数，那么编译器只会隐式添加一个默认构造函数。它是非参数化的构造函数。

```
class SomeClass{

public SomeClass() // all this is implicitly added if you don't specify anything.
{
super();
}

} 
```

从[文档](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)中：

*编译器会自动为任何没有构造函数的类提供无参数的默认构造函数。此默认构造函数将调用超类的无参数构造函数。在这种情况下，如果超类没有无参数构造函数，编译器会报错，因此您必须验证它是否存在。如果你的类没有显式的超类，那么它有一个 Object 的隐式超类，它确实有一个无参数的构造函数。*

在 Java 中，没有复制构造函数之类的东西。如果您明确定义一个，那么这是一个不同的问题，但编译器永远不会在 Java 中自动定义这样的事情。

# c++ - 欧拉角到四元数然后四元数到欧拉角

> ID：11103683
> 
> 赞同：13
> 
> 时间：2012-06-19T14:56:04.753
> 
> 标签：c++, math, rotation, quaternions, euler-angles

我正在使用 lib glm ( [http://glm.g-truc.net/](http://glm.g-truc.net/) ) 测试四元数，但我遇到了问题；当我将欧拉角转换为四元数然后立即将四元数转换为欧拉角时，我的结果与我最初的欧拉角完全不同。这是正常的吗？可能是因为轮换不是交流的吗？

代码测试：

```
#include <glm\quaternion.hpp>
#include <math.h>

#define PI M_PI
#define RADTODEG(x) ( (x) * 180.0 / PI )
#define DEGTORAD(x) ( (x) * PI / 180.0 )

int         main( void )
{
    float RotX = 90.f;
    float RotY = 180.f;
    float RotZ = -270.f;

    if ( RotX || RotY || RotZ )
    {
        std::cout << "Init: x= " << RotX << ", y= " << RotY << ", z= " << RotZ << "\n";
        glm::quat key_quat(glm::detail::tvec3<float>(DEGTORAD( RotX ),
                                                     DEGTORAD( RotY ),
                                                     DEGTORAD( RotZ )));
        glm::detail::tvec3<float> v = glm::eulerAngles(key_quat);

        /*  // the result is even worse with this code here
        RotX = RADTODEG(v.x);
        RotY = RADTODEG(v.y);
        RotZ = RADTODEG(v.z);
        */

        RotX = v.x;
        RotY = v.y;
        RotZ = v.z;

        std::cout << "Final: x= " << RotX << ", y= " << RotY << ", z= " << RotZ << "\n";
    }
    return (0);
} 
```

结果：

```
Init: x= 90, y= 180, z= -270
Final: x= -90, y= -3.41509e-006, z= -90 
```

提前谢谢你o/

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-19T15:28:56.100

是的，这很正常。[有两种方法](https://drive.google.com/file/d/0B9rLLz1XQKmaUHhmMExJbVZtb0U/view?usp=sharing)可以用欧拉角表示相同的旋转。

我个人不喜欢欧拉角，[它们会破坏应用程序的稳定性。](https://stackoverflow.com/q/5577334/341970)我会避开他们。另外，它们[也不是很方便](https://stackoverflow.com/a/5580491/341970)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-12-16T03:24:09.757

If you end up needing quaternion's to Euler angles, but you need an arbitrary rotation order, I came across a site with conversion code. Sometimes the trick is just finding the right rotation order. (Btw, the orders that have the same letter twice, like XYX, are proper Euler angles, but the ones like XYZ are Tait-Bryan angles).

Here's the link: [http://bediyap.com/programming/convert-quaternion-to-euler-rotations/](http://bediyap.com/programming/convert-quaternion-to-euler-rotations/)

And here's the code:

```
///////////////////////////////
// Quaternion to Euler
///////////////////////////////
enum RotSeq{zyx, zyz, zxy, zxz, yxz, yxy, yzx, yzy, xyz, xyx, xzy,xzx};

void twoaxisrot(double r11, double r12, double r21, double r31, double r32, double res[]){
  res[0] = atan2( r11, r12 );
  res[1] = acos ( r21 );
  res[2] = atan2( r31, r32 );
}

void threeaxisrot(double r11, double r12, double r21, double r31, double r32, double res[]){
  res[0] = atan2( r31, r32 );
  res[1] = asin ( r21 );
  res[2] = atan2( r11, r12 );
}

void quaternion2Euler(const Quaternion& q, double res[], RotSeq rotSeq)
{
    switch(rotSeq){
    case zyx:
      threeaxisrot( 2*(q.x*q.y + q.w*q.z),
                     q.w*q.w + q.x*q.x - q.y*q.y - q.z*q.z,
                    -2*(q.x*q.z - q.w*q.y),
                     2*(q.y*q.z + q.w*q.x),
                     q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z,
                     res);
      break;

    case zyz:
      twoaxisrot( 2*(q.y*q.z - q.w*q.x),
                   2*(q.x*q.z + q.w*q.y),
                   q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z,
                   2*(q.y*q.z + q.w*q.x),
                  -2*(q.x*q.z - q.w*q.y),
                  res);
      break;

    case zxy:
      threeaxisrot( -2*(q.x*q.y - q.w*q.z),
                      q.w*q.w - q.x*q.x + q.y*q.y - q.z*q.z,
                      2*(q.y*q.z + q.w*q.x),
                     -2*(q.x*q.z - q.w*q.y),
                      q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z,
                      res);
      break;

    case zxz:
      twoaxisrot( 2*(q.x*q.z + q.w*q.y),
                  -2*(q.y*q.z - q.w*q.x),
                   q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z,
                   2*(q.x*q.z - q.w*q.y),
                   2*(q.y*q.z + q.w*q.x),
                   res);
      break;

    case yxz:
      threeaxisrot( 2*(q.x*q.z + q.w*q.y),
                     q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z,
                    -2*(q.y*q.z - q.w*q.x),
                     2*(q.x*q.y + q.w*q.z),
                     q.w*q.w - q.x*q.x + q.y*q.y - q.z*q.z,
                     res);
      break;

    case yxy:
      twoaxisrot( 2*(q.x*q.y - q.w*q.z),
                   2*(q.y*q.z + q.w*q.x),
                   q.w*q.w - q.x*q.x + q.y*q.y - q.z*q.z,
                   2*(q.x*q.y + q.w*q.z),
                  -2*(q.y*q.z - q.w*q.x),
                  res);
      break;

    case yzx:
      threeaxisrot( -2*(q.x*q.z - q.w*q.y),
                      q.w*q.w + q.x*q.x - q.y*q.y - q.z*q.z,
                      2*(q.x*q.y + q.w*q.z),
                     -2*(q.y*q.z - q.w*q.x),
                      q.w*q.w - q.x*q.x + q.y*q.y - q.z*q.z,
                      res);
      break;

    case yzy:
      twoaxisrot( 2*(q.y*q.z + q.w*q.x),
                  -2*(q.x*q.y - q.w*q.z),
                   q.w*q.w - q.x*q.x + q.y*q.y - q.z*q.z,
                   2*(q.y*q.z - q.w*q.x),
                   2*(q.x*q.y + q.w*q.z),
                   res);
      break;

    case xyz:
      threeaxisrot( -2*(q.y*q.z - q.w*q.x),
                    q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z,
                    2*(q.x*q.z + q.w*q.y),
                   -2*(q.x*q.y - q.w*q.z),
                    q.w*q.w + q.x*q.x - q.y*q.y - q.z*q.z,
                    res);
      break;

    case xyx:
      twoaxisrot( 2*(q.x*q.y + q.w*q.z),
                  -2*(q.x*q.z - q.w*q.y),
                   q.w*q.w + q.x*q.x - q.y*q.y - q.z*q.z,
                   2*(q.x*q.y - q.w*q.z),
                   2*(q.x*q.z + q.w*q.y),
                   res);
      break;

    case xzy:
      threeaxisrot( 2*(q.y*q.z + q.w*q.x),
                     q.w*q.w - q.x*q.x + q.y*q.y - q.z*q.z,
                    -2*(q.x*q.y - q.w*q.z),
                     2*(q.x*q.z + q.w*q.y),
                     q.w*q.w + q.x*q.x - q.y*q.y - q.z*q.z,
                     res);
      break;

    case xzx:
      twoaxisrot( 2*(q.x*q.z - q.w*q.y),
                   2*(q.x*q.y + q.w*q.z),
                   q.w*q.w + q.x*q.x - q.y*q.y - q.z*q.z,
                   2*(q.x*q.z + q.w*q.y),
                  -2*(q.x*q.y - q.w*q.z),
                  res);
      break;
    default:
      std::cout << "Unknown rotation sequence" << std::endl;
      break;
   }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-07-03T13:14:26.557

看看这个页面。它拥有处理 3D 转换所需的一切（甚至是一些代码示例！）。

[四元数到欧拉角](http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToEuler/index.htm)

[欧拉角到四元数](http://www.euclideanspace.com/maths/geometry/rotations/conversions/eulerToQuaternion/index.htm)

[所有旋转转换](http://www.euclideanspace.com/maths/geometry/rotations/conversions/index.htm)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-05-14T20:50:03.257

欧拉 -> 四元数

从 Three.js 中提取。

这是一段对我有用的代码：

```
function eulerToQuaternion(eulerXYZ) {
  var c1 = Math.cos(eulerXYZ[0] / 2),
    c2 = Math.cos(eulerXYZ[1] / 2),
    c3 = Math.cos(eulerXYZ[2] / 2),
    s1 = Math.sin(eulerXYZ[0] / 2),
    s2 = Math.sin(eulerXYZ[1] / 2),
    s3 = Math.sin(eulerXYZ[2] / 2),
    x = s1 * c2 * c3 + c1 * s2 * s3,
    y = c1 * s2 * c3 - s1 * c2 * s3,
    z = c1 * c2 * s3 + s1 * s2 * c3,
    w = c1 * c2 * c3 - s1 * s2 * s3;

  return [x, y, z, w];
};

function calculate() {
  var quat = eulerToQuaternion([document.querySelector('#x').value, document.querySelector('#y').value, document.querySelector('#z').value]);

  document.querySelector('#result').innerHTML = quat.join(' &nbsp; ');
}
```

```
<h3>Euler radians in XYZ order:</h3>
<fieldset>
  <label>X:
    <input id="x" value="1.5" />
  </label>
  <label>Y:
    <input id="y" value="1" />
  </label>
  <label>Z:
    <input id="z" value="0" />
  </label>
  <button onClick="calculate()">To Quaternion</button>
</fieldset>
<h3>X Y Z W result:</h3>
<div id="result"></div>
```

# mysql - MySQL 更新语法以将列转换为自定义格式

> ID：11103684
> 
> 赞同：0
> 
> 时间：2012-06-19T14:56:06.830
> 
> 标签：mysql, regex, custom-formatting

这个问题与另一个问题有关，我想在其中定义自定义 MySQL 列格式。问题在这里：[如何强制执行自定义 MySQL 列格式](https://stackoverflow.com/questions/11103391/how-to-enforce-custom-mysql-column-format)。

我想要的自定义格式始终是 2 位整数，后跟 # 符号，然后是空格，然后是小数点后 2 位的十进制数。允许值的示例如下：

```
30# 11.00
27# 17.25
40# 17.25 
```

不允许的值是这样的：

```
30# 11
40# 20.5
27# 13 
```

如您所见，不允许的值的问题基本上只是最后一个十进制数字缺少“。” 和尾随零。是否有一些更新语法可用于修复所有这些*不正确*的列值？基本上我只需要检查“#”之后的最后一个十进制数字是否有2个尾随十进制数字。如果没有，那么我想添加“。” 和尾随零。有谁知道`UPDATE`可以做到这一点的命令？

谢谢！

**编辑**

对一些评论的回答：是的，它是`VARCHAR`类型列。如果该值与我们想要的完全不同，那就别管它了。大多数问题都是我解释的，如果我可以通过一个查询解决所有问题，那么这是一个好的开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T14:59:27.460

```
update your_table
set some_column = case when len(some_column) = 6
                       then some_column + '.00'
                       when len(some_column) = 8
                       then some_column + '0'
                  end
where len(some_column) < 9; 
```

看[这个例子](http://sqlfiddle.com/#!3/5faaa/3)

这里有一些更精确的语法，效果很好：

```
update your_table 
set some_column =
case 
    when length(some_column) = 6 
    then concat(some_column,".00") 
    when length(some_column) = 7
    then concat(some_column,"00") 
    when length(some_column) = 8
    then concat(some_column,"0") 
    else some_column 
end 
where some_column REGEXP '^[0-9][0-9]# [0-9][0-9]'; 
```

# python - Python getattr() 成员或函数？

> ID：11103685
> 
> 赞同：4
> 
> 时间：2012-06-19T14:56:10.340
> 
> 标签：python

我正在尝试使用 Python 的 getattr() 从我从无法控制的各种 API 获得的许多对象中提取数据。我的想法是通过一个异质对象列表并尝试对它们进行 getattr() 直到我提取出我需要的所有内容。

所以我正在做其中之一：

```
if hasattr(o, required_field):
    value = getattr(o, required_field)
    result.append([required_field, value])
    print 'found field', field, 'for value', value 
```

我的问题有时是我正在处理的对象有 object.data() 和 sometiems object.data 来拉出东西。有时这些对象实际上是生成器。

所以偶尔我会得到这样的东西：

```
found field ValueOfRisk for value
CellBM:<Instrument:/limbo/WLA_YdgjTdK1XA2qOlm8cQ==>.ValueOfRisk> 
```

问题：有没有一种方法可以说“当它是数据成员时访问数据成员，或者当它是函数时​​调用函数”来从这些东西中取出值？似乎使用 Python 应该很容易，但我找不到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T15:00:58.380

```
if hasattr(value, '__call__'):
    value = value() 
```

备用：

```
if callable(value):
    value = value() 
```

还：

```
import types
if isinstance(value, types.GeneratorType):
    # Handle generator case 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T15:04:49.593

使用[`callable`](http://docs.python.org/library/functions.html#callable)功能：

```
if hasattr(o, required_field):
    v = getattr(o, required_field):
    if not callable(v):
        print "found field", required_value, "for value", v 
```

在 Python 3 中，使用`isinstance(obj, collections.Callable)`（`import collections`当然是在 之后）。此外，它似乎`callable`是在 Python 3.2 中添加回来的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-19T14:59:28.153

假设调用该方法是安全的：

```
methods = []
properties = []

if hasattr(o,required_field):
  value = getattr(o,required_field)
  try:
     #see if this value is callable
     value()
     methods.append(value)
  except TypeError:
     #property is not a method
     properties.append(value) 
```

# reporting-services - 报告运行总计

> ID：11103688
> 
> 赞同：1
> 
> 时间：2012-06-19T14:56:16.273
> 
> 标签：reporting-services, ssrs-tablix

我有一个 tablix 报告，它有一个组。一个组可能会跑几页，所以我需要把上一页的余额，作为新页面的第一行，然后是详细信息，最后是页面总数。

```
Group Header
Groups Balance from the previous page
Details
Groups Balance(including previous page values) 
```

我怎样才能做到这一点，谢谢你的时间。假设只列出两列，借方金额、贷方金额和账户代码

```
Account code, Debit, Credit    
group1 (account code)
    balance 0,0
    group-1-detail-1, 10,  0
    group-1-detail-2, 20,  0
    totals (group-1-so-far)   30, 0
    end of page
    beginning of page
Account code, Debit, Credit
    group1
    balance    30,0
    group-1-detail-3, 10,  0
    group-1-detail-4, 0,  40
    totals (group-1-so-far)   40, 40
    end of page 
```

# sql-server - sql server xml同时删除两个属性

> ID：11103690
> 
> 赞同：2
> 
> 时间：2012-06-19T14:56:28.843
> 
> 标签：sql-server, xml, sqlxml

我发现以下内容显示了如何在 SQL Server 中从 XML 中删除属性：[如何从 sql server 2008 中的 XML 变量中删除属性？](https://stackoverflow.com/questions/5345746/how-to-delete-an-attribute-from-an-xml-variable-in-sql-server-2008)

但我想一次删除两个属性。我尝试了类似以下的方法：

```
UPDATE TABLE SET
  xmlField.modify('delete  (/clue_personal_auto/@attr1)[1]'),
  xmlField.modify('delete  (/clue_personal_auto/@attr2)[1]')
 WHERE compare = 357 
```

但是我收到一个错误，即在更新期间不能多次修改同一列。有没有办法在一次语句中删除两者，或者我应该只运行两个单独的更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:20:28.440

```
UPDATE TABLE SET
  xmlField.modify('delete (/clue_personal_auto/@*[local-name()=("attr1", "attr2")])')
 WHERE compare = 357 
```

[SE-数据](https://data.stackexchange.com/stackoverflow/query/73394)

# android - Android NDK - 在本机代码中使用 AssetManager

> ID：11103692
> 
> 赞同：6
> 
> 时间：2012-06-19T14:56:31.060
> 
> 标签：android, thread-safety, android-assets, android-ndk

我需要从 C/C++ 代码中处理我的资产文件夹中的资产。像这样缓存指向 AAssetManager 的指针是否安全...：

```
AAssetManager* assetMgr = NULL; 

void Java_com_example_createAssetManager(JNIEnv* env, jclass clazz, jobject assetManager)
{
  AAssetManager* mgr = AAssetManager_fromJava(env, assetManager);
  assert(NULL != mgr);
  assetMgr = mgr;    
} 
```

...然后在我需要的时候使用它？createAssetManager 是从主 Activity（UI 线程）的 Java onCreate 方法调用的，但在 C/C++ 中的用法是在 GLSurfaceView 实现中原生处理从本机方法调用的渲染和游戏滴答时。

1）assetMgr 指针会在整个应用程序生命周期内指向有效对象吗？在 Java 端（在 Activity 类中）像静态变量一样创建它是否足以让垃圾收集器不会破坏它？

2）我会遇到线程问题吗？

谢谢，汤姆原子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:29:48.840

缓存资产管理器的一种稍微安全一点的方法是在 C 端保存对底层 Java 对象的全局引用以及缓存的`AAssetManager`指针。至少你会知道 C 对象后面/周围的 Java 对象不会被垃圾收集。

为此，请致电`env->NewGlobalRef(assetManager)`.

恕我直言，跨线程边界访问资产管理器将是相当疯狂的。这是一个非常强大的设计约束 - 除非明确记录，否则默认情况下永远不会假定线程安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-25T08:02:26.550

I've written an NDK module, [Assetbridge](https://bitbucket.org/smh377/assetbridge), that you might also find useful. It exports the contents of your project's assets/ folder (files and directories) to a temporary directory, and then sets an environment variable to that path, so your native code can chdir() to the temp directory and you can use the regular old standard library file IO routines.

# java - Java颜色直方图所有颜色不是RGB分开的

> ID：11103702
> 
> 赞同：0
> 
> 时间：2012-06-19T14:57:06.283
> 
> 标签：java, histogram

我想从 BufferedImage (Java) 中提取颜色直方图。我不想为红色、绿色和蓝色提取单独的直方图，但我想要一个包含所有可用颜色（包括分箱）的直方图。如果相邻的垃圾箱看起来彼此相似，那就太好了。

我不知道如何定义垃圾箱，因为颜色不是一维的。另一个问题是将颜色分配给它的 bin。

有人有想法或图书馆来实现它吗？

最好的，迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:15:39.283

您可以分别计算红色、绿色和蓝色的直方图，然后找到它们的平均值并绘制结果图。看看[这篇文章](http://www.scarletuser.com/showthread.php?t=567)。

或者您可以创建一个立方体 3d 直方图（每个边缘对应一种颜色）。这是它的[结果](http://rsbweb.nih.gov/ij/plugins/color-inspector.html)（java）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:15:58.000

只是一个想法：打开一些图像编辑器（例如 Paint）并查看他们的颜色选择器以了解如何排列颜色。

我想我会按 HUE 排列它们（[在此处输入链接描述](http://en.wikipedia.org/wiki/Hue)），因为这将是一种一维排列，很容易与“颜色箱”的概念相匹配，并且它还将相似的颜色以彩虹的方式彼此靠近。但是，仅使用色调（放弃亮度和饱和度）意味着您可能会将图片中看起来非常不同的颜色放在同一个 bin 中。

另一种方法是通过对完整 RGB 信息（例如使用所有 3 个 RGB 分量）使用某种静态[聚类分析](http://en.wikipedia.org/wiki/Cluster_analysis)，将图片中的所有颜色自动“聚类”到固定数量的 bin（例如 16 个）中，然后显示在相应的直方图条下方显示每个集群的 16 个“平均颜色”。

# java - MySQL 中的精密 Java 浮点数与 JPA (EclipseLink)

> ID：11103705
> 
> 赞同：3
> 
> 时间：2012-06-19T14:57:13.583
> 
> 标签：java, mysql, jpa, floating-point

我通过 jpa (EclipseLink) 在 mysql 中存储浮点值时遇到精度问题。在我的代码中，我用

```
@Column(precision=15, scale=7)
private float x; 
```

但是当我存储像 322,249878 这样的值时，数据库返回 322.25。那里发生了什么:)？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T15:13:40.910

`precision`和`scale`设置仅适用于精确的数字类型（即`BigDecimal`在 Java 和`decimal`MySQL 中）。

浮点类型 (`float`和`double`) 本质上是近似的，因此这些设置对它们没有意义。

另请注意，如果您将此字段的类型更改为`BigDecimal` [您也应该使用精确值对其进行初始化](https://stackoverflow.com/questions/5734036/hibernate-loss-of-precision-in-results-when-mapping-a-number-22-21-to-bigdecim/5734172#5734172)。

# haskell - Data Parallel Haskell 中的 PArray 和 [::] 有什么区别？

> ID：11103707
> 
> 赞同：33
> 
> 时间：2012-06-19T14:57:17.673
> 
> 标签：haskell, data-parallel-haskell

我一直在对 Data Parallel Haskell 进行大量研究，并发现了两种单独的并行数组类型。该`[::]`类型似乎更多地出现在研究论文中，似乎是理想的类型，但`PArray`似乎无处不在。关于该主题的 wiki 页面非常清楚地表明，`[::]`不能将类型数组传递给未矢量化的代码。为什么？为什么会有这种中间`PArray`类型？这对我来说似乎完全是多余的。wiki 将其称为“平面数组”，但矢量化的全部意义在于使并行数组平面化。

更新：在阅读了更多论文、文档和源代码后，我更加困惑。`[::]`或其同义词`PArr`似乎在[GHC.PArr](http://www.haskell.org/ghc/docs/latest/html/libraries/base/src/GHC-PArr.html)中作为平面数组实现，而`PArray`在多个地方称为“平面”的中间类型在[Data.Array.Parallel.PArray.Base](http://hackage.haskell.org/packages/archive/dph-par/latest/doc/html/src/Data-Array-Parallel-PArray-Base.html#PArray)和从那里导入的其他模块中实现为一个数据系列，使用我阅读的许多论文中描述的扁平化转换。为什么平面阵列不平坦而嵌套阵列不平坦？

更新2：经过更多研究，我发现文档完全是一团糟。wiki 页面近一年[没有任何内容更新，与 hackage 文档相矛盾（请参阅](http://www.haskell.org/haskellwiki/index.php?title=GHC/Data_Parallel_Haskell&diff=46527&oldid=42299)[Data.Array.Parallel.Prelude](http://hackage.haskell.org/packages/archive/dph-lifted-vseg/0.6.1.2/doc/html/Data-Array-Parallel-Prelude.html)，其中明确表示不要导入特殊前奏），并且通常已过时。[GHC Trac 页面](http://hackage.haskell.org/trac/ghc/wiki/DataParallel)也已过时，例如，包括 DPH 软件包指南，其中提到了至少就 Hackage 而言（我没有，也不完全没有地方可以查看）其他地方），不存在，也没有提到像 dph-lifted-vseg 这样的包。

[更好的一点是，我相信我现在理解了第一次更新的答案， GHC.PArr](http://www.haskell.org/ghc/docs/latest/html/libraries/base/src/GHC-PArr.html)中的这部分评论暗示了这一点：

```
-- BIG UGLY HACK: The desugarer special cases this module.  Despite the uses of '-XParallelArrays',
--                the desugarer does not load 'Data.Array.Parallel' into its global state. (Hence,
--                the present module may not use any other piece of '-XParallelArray' syntax.)
--
--                This will be cleaned up when we change the internal represention of '[::]' to not
--                rely on a wired-in type constructor. 
```

我的猜测是，启用矢量化后，该模块会自动替换为使用扁平化转换的另一种表示形式。这甚至可能类似于

```
type [::] = PArray 
```

，解决了我原来的问题。然而，后一点不仅没有多大意义（为什么`[::]`在向量化关闭时限制为平面数组类型？），而且除了上面提到的评论之外，我没有发现任何证据支持这两种理论。似乎学习任何东西的唯一可靠方法是查看 GHC 源，考虑到它的大小和复杂性，这是我渴望做的事情，即使我确信我会成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T10:07:57.837

参考这个：

[http://hackage.haskell.org/packages/archive/dph-seq/0.5.1.1/doc/html/Data-Array-Parallel.html](http://hackage.haskell.org/packages/archive/dph-seq/0.5.1.1/doc/html/Data-Array-Parallel.html)

# asp.net-mvc - EF oData - 元素类型不是实体类型

> ID：11103708
> 
> 赞同：3
> 
> 时间：2012-06-19T14:57:17.923
> 
> 标签：asp.net-mvc, entity-framework, odata

我正在尝试启动并运行一个 odata 演示，但我看到了这个错误：

> '在数据上下文类型'TweetPicContext'上，有一个顶级 IQueryable 属性'Users'，其元素类型不是实体类型。确保 IQueryable 属性是实体类型或在数据上下文类型上指定 IgnoreProperties 属性以忽略此属性。

令人讨厌的是，我的代码几乎是现有项目的剪切和粘贴 - 但显然出了点问题......

查看以前的问题/答案，常见的答案似乎是`DataServiceKey`属性 - 但我已经在使用它了。

有人知道我哪里出错了吗？

这是我的数据上下文：

```
public class TweetPicContext : DbContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<Picture> Pictures { get; set; }
} 
```

这是我的用户数据类：

```
[DataServiceKey("UserID")]
public class User
{
    [Key]
    public int UserID { get; set; }

    public string Name { get; set; }
    public string TwitterHandle { get; set; }
    public string TwitterIconUrl { get; set; }
    public int TwitterId { get; set; }
    public string TwitterAuthorizationToken { get; set; }
    public string TwitterAuthorizationTokenSecret { get; set; }
    public DateTime DateJoinedUtc { get; set; }
    public string UniqueDeviceToken { get; set; }

    public virtual ICollection<Picture> Pictures { get; set; } 

    public User()
    {
        DateJoinedUtc = DateTime.UtcNow;
        UniqueDeviceToken = Guid.NewGuid().ToString("N");
    }
} 
```

这是我的用户服务：

```
[ServiceBehavior(IncludeExceptionDetailInFaults = true)]
public class TweetPicOData : DataService<TweetPicContext>
{
    // This method is called only once to initialize service-wide policies.
    public static void InitializeService(IDataServiceConfiguration config)
    {
        config.SetEntitySetAccessRule("Users", EntitySetRights.AllRead);
        config.SetEntitySetAccessRule("Pictures", EntitySetRights.AllRead);
        config.UseVerboseErrors = true;
    }

    // see http://romiller.com/2010/07/19/ef-ctp4-tips-tricks-wcf-data-service-on-dbcontext/
    protected override TweetPicContext CreateDataSource()
    {
        var ctx = base.CreateDataSource();

        // Disable proxy object creation.
        ctx.Configuration.ProxyCreationEnabled = false;
        return ctx;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T16:10:31.197

WCF 数据服务 5.0 添加了在使用 DbContext 时调用 EF 提供程序所需的支持。如果您将 DbContext 与早期版本的 WCF 数据服务一起使用，堆栈将回退到使用反射提供程序而不是 EF 提供程序。这将导致类似于您所描述的行为。

升级到 WCF 数据服务 5.0 或更高版本应该可以解决该问题。从 5.0 版开始，我们一直在通过 NuGet 分发位：[http](http://www.nuget.org/packages/Microsoft.Data.Services.Client) ://www.nuget.org/packages/Microsoft.Data.Services.Client 。

HTH，马克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T07:26:36.993

我有同样的问题。我用作数据源的对象位于一个单独的库中，出于某种原因，当我在我的网站中将该类复制为 .cs 文件时，一切正常。我认为这是因为版本问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-22T11:35:29.613

我和@Trevor 有同样的问题，一开始我用同样的方法解决了。然后我找到[了这个线程](http://social.msdn.microsoft.com/Forums/en-US/34ef1bdc-2a73-4f11-a478-630be2332434/data-service-using-the-reflection-provider-wcf-data-services?forum=adodotnetdataservices)，发现我的服务项目指的是 Microsoft.Data.Services.Client，而我的实体项目指的是 System.Data.Services.Client。通过更改我的实体项目中的引用，我得到了它的工作。

# iframe - AutoIt - 单击 iFrame 中的链接

> ID：11103711
> 
> 赞同：1
> 
> 时间：2012-06-19T14:57:23.680
> 
> 标签：iframe, hyperlink, autoit

我是使用 AutoIt 的新手。我一直在努力使用 Internet Explorer 单击 iframe 中的链接。我已经研究了几种方法来做到这一点，但没有任何工作。

所以这可能是一个简单的问题。如何使用 AutoIt 单击 iFrame 内的链接？该链接位于第 8 帧中，文本名称为“人物”。

有人可以提供一个例子吗？

我假设我必须使用 _IEFrameGetCollection 和 _IELinkClickByText。我还设法使用 _IEFrameGetCollection 确定页面上的总帧数为 9。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T06:50:47.180

> 我假设我必须使用 _IEFrameGetCollection 和 _IELinkClickByText。我还设法使用 _IEFrameGetCollection 确定页面上的总帧数为 9。

恰恰。您可能想先看看这个答案：[Can't retrieve links inside Frame](https://stackoverflow.com/questions/10982682/autoit-cant-retrieve-links-inside-frame)

您的代码最终将类似于：

```
#include <IE.au3>

$URL="http://www.acgme.org/adspublic/"
$MyIExplorer=_IECreate($URL,1,1,1,1)

Local $theFrame = _IEFrameGetCollection($MyIExplorer, 8)

Local $oLinks = _IELinkGetCollection($theFrame)
MsgBox(0, "Link Count", @extended & " links found") 
```

# ios - 关于 CCSpriteBatchNode 的 addchild 方法的古玩

> ID：11103712
> 
> 赞同：0
> 
> 时间：2012-06-19T14:57:27.253
> 
> 标签：ios, cocos2d-iphone

在 ch08 中潜入“用 ios5 学习 cocos2d 游戏开发”时

在`EnemyCache.m`

```
-(id) init
{
    if ((self = [super init]))
    {
        // get any image from the Texture Atlas we're using
        CCSpriteFrame* frame = [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:@"monster-a.png"];
        batch = [CCSpriteBatchNode batchNodeWithTexture:frame.texture];
        [self addChild:batch];

        [self initEnemies];
        [self scheduleUpdate];
    }

    return self;
} 
```

所以批次是纹理“monster-a.png”

in`EnemyEntity.m`的`initWithType`方法

```
switch (type)
{
    case EnemyTypeUFO:
        enemyFrameName = @"monster-a.png";
        bulletFrameName = @"shot-a.png";
        break;
    case EnemyTypeCruiser:
        enemyFrameName = @"monster-b.png";
        bulletFrameName = @"shot-b.png";
        shootFrequency = 1.0f;
        initialHitPoints = 3;
        break;
    case EnemyTypeBoss:
        enemyFrameName = @"monster-c.png";
        bulletFrameName = @"shot-c.png";
        shootFrequency = 2.0f;
        initialHitPoints = 15;
        break;

    default:
        [NSException exceptionWithName:@"EnemyEntity Exception" reason:@"unhandled enemy type" userInfo:nil];
}

if ((self = [super initWithSpriteFrameName:enemyFrameName]))
{
    //...
} 
```

所以返回的对象可能在 3 个不同的帧中。由于[只有包含在该纹理中的 CCSprites 才能添加到 CCSpriteBatchNode](http://www.cocos2d-iphone.org/api-ref/0.99.5/interface_c_c_sprite_batch_node.html)中，显然 'monster-b.png' 不包含在 'monster-a.png' 中，为什么仍然可以将不同的敌人添加到批处理中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:13:30.840

可以将多个图像合二为一。这样的图像称为图集。所以所有的怪物都在一个大纹理中。对每个图像的访问是使用 .plist 配置文件完成的，其中存储了有关具体图像在大纹理中放置位置的信息。

它很有意义，因为它是一个昂贵的操作来切换纹理。更快的是将您需要的所有内容放入一个纹理并使用批处理。此外，由于纹理存储在 GPU 上的 (2^n, 2^m) 缓冲区中并提供大纹理，因此它在 GPU 上占用的内存也更少，您可以最大限度地减少纹理中的可用空间。例如，加载每 65 像素大小为 65 的图像将创建每 128 像素 128 的纹理。

# python - Pyramid：防止强制重启 pserve

> ID：11103718
> 
> 赞同：3
> 
> 时间：2012-06-19T14:57:41.913
> 
> 标签：python, python-2.7, pyramid

尽管我已将 pyramid.reload_templates 设置为 true 例如“ **pyramid.reload_templates = true** ”，但每次修改视图时，我都必须终止 pserve 进程并重新启动它才能看到更改。

我怎样才能克服这个问题，只需刷新页面即可获得结果？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T15:33:29.080

好吧，我认为您可以`--reload`在启动网络服务器时添加标志。这将监视文件的任何更改并自动重新加载服务器。IE`/pserve --reload develoment.ini`

# c# - 隐藏/显示表单元素的设计模式

> ID：11103719
> 
> 赞同：3
> 
> 时间：2012-06-19T14:57:42.233
> 
> 标签：c#, asp.net, design-patterns, webforms

我是设计模式的新手，所以我的问题听起来有点疯狂。

我有一个 Web 表单，上面有很多控件。根据用户拥有的权限和表单状态，一些控件需要是可编辑的、只读的或隐藏的等等。

我正在徘徊我应该实现什么设计模式来整理所有这些混乱？

我在考虑责任链，所以链中的每个链接都将负责一些逻辑。

我走对了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:52:11.153

虽然可能有很多方法可以解决您的问题，但如果没有关于用例的更多细节，很难推荐任何东西。

但是，听起来您可能需要考虑更广泛的问题。很少有业务需要应用您所说的那种细粒度权限。我经常看到开发人员在创建极其灵活的角色/权限授权系统方面做得过火——但从业务角度考虑问题。通常有一些角色的需求（权利）随着时间的推移变化很小——每个角色都在尝试执行不同的任务。

您能否通过引入针对手头任务优化的每个角色和/或状态的表单来更简单地解决这个问题？从长远来看，您可能会发现这更容易维护，并且对您的用户来说更清晰。

# css - css实现{Width:100% -150px}

> ID：11103728
> 
> 赞同：6
> 
> 时间：2012-06-19T14:58:04.990
> 
> 标签：css, height

我有一个带有侧面导航的网站，我希望屏幕的其余部分充满图像，侧面导航在左侧，宽度为 150 像素。

理想情况下，我喜欢将全屏图像设置为，`width:100% -150px;`但我很确定这不是正确的 CSS。

有没有办法达到同样的效果？我不能`width:90%;`在更宽的屏幕上使用 150px 更像是宽度的 5% 而不是 10%。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T15:00:49.417

事实上 - 它是！（使用css3）

```
width: calc(100% -150px);
width: -moz-calc(100% - 150px);
width: -webkit-calc(100% - 150px); 
```

有效，但仅适用于最现代的浏览器... [caniuse](http://caniuse.com/#search=calc)

如果您不想使用它，可以使用边距创建偏移量：`margin-left:150px;`。然而，这需要一个具有 100% 宽度的父元素，并且您的图像是一个块级元素 ( `display:block`)。

另一种选择是使用[box-sizing](http://caniuse.com/#search=box-sizing)。这使您可以选择另一个不计算元素宽度的边距和填充的框模型。这也有助于一些典型的“我需要 100% 宽度 - Xpx 边框”的情况。

回应@BerkerYüceer 的评论 - 您还可以在计算中使用动态值，如下所示：

```
/* declare css variable */
--leftmargin:150px;

/* use the variable like following */
calc(100% - var(--leftmargin)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T15:03:35.237

您可以使用[calc()](http://www.w3.org/TR/css3-values/#calc)仅使用 CSS3 来获得所需的内容。

```
div{
width: 100%;
width: calc(100% - 150px);
width: -moz-calc(100% - 150px);
width: -webkit-calc(100% - 150px);
} 
```

你可以在这里看到一个[例子](http://jsfiddle.net/masimao/2EkLv/)

在 IE9、Firefox 和 Google Chrome 中运行良好。

附加参考：[https ://developer.mozilla.org/en/CSS/-moz-calc](https://developer.mozilla.org/en/CSS/-moz-calc)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T15:03:06.967

## 演示：http: [//jsfiddle.net/MY6Z9/](http://jsfiddle.net/MY6Z9/)

```
#content { margin-left:150px } 
```

假设您的`#content`项目是`display:block`默认情况下将填充可用宽度的元素。

* * *

如果您想要单个图像来填充宽度，而不是平铺，您可以[`background-size`](http://www.css3.info/preview/background-size/)在现代浏览器上使用背景图像：

```
#content {
  background:url(myimage.jpg) no-repeat;
  background-size:100% auto; 
} 
```

## 演示：http: [//jsfiddle.net/MY6Z9/5/](http://jsfiddle.net/MY6Z9/5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T15:00:41.727

对于非`position:static`元素，您可以尝试设置`right: 150px;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T15:06:26.620

您可以在 #image-full div 周围使用包装 div 来实现此目的：

```
#image-wrapper
{
    position:absolute;
    width:100%;
    padding-right:150px;
}

#image-full
{
    width:100%;
    background-image:url(...);
    /* ... */
}

#navigation
{
    position:absolute;
    width:150px;
} 
```

# mysql - 错误：错误 1005：无法创建表 'website.#sql-3e5_102'（错误号：150）

> ID：11103731
> 
> 赞同：0
> 
> 时间：2012-06-19T14:58:25.070
> 
> 标签：mysql, relational-database

我正在尝试在 3 个表之间设置外键并收到标题中的错误，所有 _id 字段都是无符号的，并且格式与它们的父级相同。

有问题的表：

```
CREATE TABLE `Group` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(250) COLLATE utf8_unicode_ci DEFAULT NULL,
  `name_url` varchar(250) COLLATE utf8_unicode_ci DEFAULT NULL,
  `enabled` tinyint(1) unsigned NOT NULL DEFAULT '1',
  `order` int(11) NOT NULL DEFAULT '0',
  `internal` tinyint(1) NOT NULL,
  `updated` int(11) DEFAULT NULL,
  `created` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=12 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `Permission` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `description` tinytext COLLATE utf8_unicode_ci,
  `controller` varchar(250) CHARACTER SET utf8 DEFAULT NULL,
  `action` varchar(250) CHARACTER SET utf8 DEFAULT NULL,
  `enabled` tinyint(1) unsigned NOT NULL DEFAULT '0',
  `updated` int(11) DEFAULT NULL,
  `created` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=40 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `Group_Permission` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `group_id` int(11) unsigned DEFAULT NULL,
  `permission_id` int(11) unsigned DEFAULT NULL,
  `enabled` tinyint(1) unsigned NOT NULL DEFAULT '1',
  `use_client_id` tinyint(1) DEFAULT '0',
  `updated` int(11) DEFAULT NULL,
  `created` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `perm, group_id` (`permission_id`,`group_id`)
) ENGINE=InnoDB AUTO_INCREMENT=58 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

mysql Workbench 正在运行的查询

```
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';

ALTER TABLE `website`.`Group` 
  ADD CONSTRAINT `fk_Group_Group_Permission1`
  FOREIGN KEY (`id` )
  REFERENCES `website`.`Group_Permission` (`group_id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

ALTER TABLE `website`.`Group_Permission` 
DROP INDEX `perm, group_id` 
, ADD INDEX `permission_id` (`group_id` ASC) 
, ADD INDEX `group_id` (`group_id` ASC) ;

ALTER TABLE `website`.`Permission` 
  ADD CONSTRAINT `fk_Permission_Group_Permission1`
  FOREIGN KEY (`id` )
  REFERENCES `website`.`Group_Permission` (`permission_id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS; 
```

查询创建外键：

```
New client connection
client connection established
Executing SQL script in server

> ERROR: Error 1005: Can't create table 'website.#sql-3e5_102' (errno:
> 150)

ALTER TABLE `website`.`Group` 
  ADD CONSTRAINT `fk_Group_Group_Permission1`
  FOREIGN KEY (`id` )
  REFERENCES `website`.`Group_Permission` (`group_id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION

SQL script execution finished: statements: 3 succeeded, 1 failed 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:01:26.220

在我看来，你的人际关系倒退了。 `Group_Permission`应该包括与 的 FK 关系`Group`，而不是相反。同样，`Group_Permission.permission_id`应该引用`Permission.id`而不是相反。约束无法创建，因为`id`当您尝试使其成为外键时，它已经是主键。

```
ALTER TABLE `website`.`Group_Permission` 
  ADD CONSTRAINT `fk_Group_Group_Permission1`
    FOREIGN KEY (`group_id` )
    REFERENCES `website`.`Group` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
  ADD CONSTRAINT `fk_Permission_Group_Permission1`
    FOREIGN KEY (`permission_id` )
    REFERENCES `website`.`Permission` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION; 
```

# c# - 在 C# .NET 中绘制实时频谱的最佳方法是什么？

> ID：11103732
> 
> 赞同：0
> 
> 时间：2012-06-19T14:58:26.880
> 
> 标签：c#, .net, fft, draw

我的程序每秒两次或三次从 LAN 接收频谱数据。该数据是 FFT 的结果。我需要尽快重新绘制光谱并实时显示。现在我在 C++ Builder 上有一个应用程序可以完成这项工作，但在画布上逐点绘制它，或者像这样......它太慢了。此外，我有时需要从文件中加载光谱并移动图片。

问：现在我需要在.NET 上重写这样的程序。实现这一目标的最佳方法是什么？

什么是最好的技术？WPF、XNA 还是只是 GDI？

我在哪里可以找到一个例子？

提前致谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-11-30T17:04:02.013

因此，根据我的调查，快速重绘图像并使用边距移动它是最佳选择之一。

为了加快图像创建 LockBits 被使用

[http://msdn.microsoft.com/en-us/library/5ey6h79d(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/5ey6h79d(v=vs.110).aspx)

[C# LockBits 性能（int[,] 到 byte[]）](https://stackoverflow.com/questions/7535812/c-sharp-lockbits-perfomance-int-to-byte)

# git - 使用 svn2git 转换本地 Tortoise SVN repo

> ID：11103733
> 
> 赞同：2
> 
> 时间：2012-06-19T14:58:29.107
> 
> 标签：git, svn, tortoisesvn, git-svn

我正在尝试将位于我的 Windows/Ubuntu 双启动机器共享的分区上的 Tortoise SVN 存储库转换为 git 存储库。我为 git repo 创建了一个新目录，并`svn2git svn://media/mpoint/School/OLD_SVN_DIR`在 Ubuntu 机器上进行了尝试，但没有成功。

我已经看到很多 SVN 存储库基于服务器的示例，但我还没有看到任何本地示例。即：`svn2git svn://localhost/name-of-repo`。如果它有帮助，在 Windows 端（SVN 回购的地方）地址是`https:/John-T60/svn/OLD_SVN_DIR/`. 我已经尝试过使用该命令`svn2git https://John-T60/svn/OLD_SVN_DIR`但没有运气。

我的 SVN 存储库不是很复杂，可能 50-100 次提交，只是主分支。有什么例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T09:12:19.130

如何简单地解决这个问题：导出您的颠覆存储库通过

```
svnadmin dump /path/to/your/repo > yourreporname.dump 
```

临时安装 VisualSVN（这是一个非常容易设置和使用的 SVN 存储库），使用其方便的 GUI 导入您的转储，然后继续将您的存储库转换为 Git 作为常规远程 SVN 存储库。

# jquery-mobile - Jquery Mobile 中的 FieldContain 文本输入和复选框

> ID：11103740
> 
> 赞同：0
> 
> 时间：2012-06-19T14:58:53.243
> 
> 标签：jquery-mobile

在 Jquery Mobile 中，我想做一个带有“收音机”和文本输入的 controlGroup。我只能用标签来做！

有人可以帮助我吗？

```
<legend>B&uacutesqueda de pacientes</legend>
<input type="radio" name="radio-choice-1" id="radio-choice-1" value="choice-1" checked="checked" />
<label for="radio-choice-1">N.H.Cl&iacutenico.</label>
<input type="text" name="NHClinico" id="Text1" placeholder="N.H.Cl&iacutenico.">
</legend> 
```

我不需要标签，只有一个字段包含在收音机和文本输入之间。

感谢所有朋友。

此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T18:26:36.593

你需要**显示：inline !important;** 在广播组。这是 2 LI 行中的普通按钮和迷你按钮的示例。

[http://jsfiddle.net/den232/5mVv8/](http://jsfiddle.net/den232/5mVv8/)

```
 .floatleft {
    float:left;
 }
.floatright {
    float:right;
 }
.forceinline{  /* Prevent fieldcontain from doing a BLOCK thing */
    display:inline !important;
}
.textwidth {  /* limit width of input fields */
    width:80px;
}
.closespacing { /* controls spacing between elements */
    margin:0px 5px 0px 0px;
 }
.bigselect {   /* centers select with big buttons */
    padding: 0px;
    margin:2px 5px 0px 0px;
 }
.biginputheight {   /* matches text input height to big buttons */
    padding-top:10px !important;
    padding-bottom:12px !important;
}
.miniinputheight { /* matches text input height to minibuttons */
    padding-top:5px !important;
    padding-bottom:5px !important;
}

<div data-role="page" class="type-home"> 
```

```
<ul data-role="listview">
  <li  data-role="fieldcontain">first LI line</li>
  <li  data-role="fieldcontain">

    <div data-role="fieldcontain" class= 'forceinline'>
      <div class='floatleft closespacing'>    
        <fieldset data-role="controlgroup" data-type="horizontal">
          <input type="radio" name="radio-view" id="radio-view-a" value="aa"  />
          <label for="radio-view-a">A1</label>
          <input type="radio" name="radio-view" id="radio-view-b" value="bb"  />
          <label for="radio-view-b">B1</label>
        </fieldset>
      </div>
    </div>

    <div  class='floatleft textwidth'>
      <input type="text" placeholder="left" class='biginputheight'></input>
    </div>  

  </li>
  <li  data-role="fieldcontain">

    <div data-role="fieldcontain" class= 'forceinline'>
      <div class='floatleft closespacing'>    
        <fieldset data-role="controlgroup" data-type="horizontal" data-mini='true'>
          <input type="radio" name="radio-view" id="radio-view-a" value="aa"  />
          <label for="radio-view-a">AA</label>
          <input type="radio" name="radio-view" id="radio-view-b" value="bb"  />
          <label for="radio-view-b">BB</label>
        </fieldset>
      </div>
    </div>

    <div  class='floatleft textwidth'>
      <input type="text" placeholder="e2" class='miniinputheight'></input>
    </div>  

     <div class='floatright closespacing'>
      <div  class='floatright textwidth'>
        <input type="text" placeholder="e3" class='miniinputheight'></input>
      </div>  
    </div>
  </li>
  <li  data-role="fieldcontain">last LI line</li>

</ul><!-- /listview --> 
```

# python - Python Tkinter - 一段时间后隐藏小部件

> ID：11103741
> 
> 赞同：4
> 
> 时间：2012-06-19T14:58:54.317
> 
> 标签：python, tkinter

我想绘制一个小部件（在本例中为画布），然后在一段时间后将其移除。就像显示然后被删除的消息一样，只是为了让用户可以阅读它，但不需要单击“确定”或类似的东西来删除消息。

这是一个示例代码。

```
from tkinter import*

root = Tk()

canvas_1 = Canvas(root, width = 300, height = 300, bg = 'white')
canvas_1.grid(column = 0, row = 0)

canvas_2 = Canvas(canvas_1, width = 200, height = 200, bg = 'blue')
canvas_2.place(x = 50, y = 50)

canvas_1.after(1000, canvas_2.place_forget())

root.mainloop() 
```

问题在于，`after()`无论何时在代码中调用它，tkinter 似乎都在其他所有操作之前运行该方法。结果是`canvas_2`永远不会出现。

我已经尝试过`time.sleep()`，但在这种情况下它似乎以相同的方式工作。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-19T15:36:16.293

问题是您的`after`陈述实际上导致立即`canvas_2`被遗忘*。*这是因为 () 告诉 Python*运行*该`place_forget`函数（而不是在 1000 毫秒内运行它）。删除（）的，你会很高兴。祝你好运。

替换这个：

```
canvas_1.after(1000, canvas_2.place_forget()) 
```

有了这个：

```
canvas_1.after(1000, canvas_2.place_forget) 
```

# jsf-2 - ui:include 的替代方案，用于在 JSF 2.0 中动态包含页面

> ID：11103743
> 
> 赞同：1
> 
> 时间：2012-06-19T14:59:08.893
> 
> 标签：jsf-2, myfaces

开始之前：我在 Tomcat 6 上运行 JSF 2.0 MyFaces，并且我已经在这个项目中使用了一些 primefaces。

我有一个包含三个过滤下拉列表的页面，它们在我的支持 bean 中设置了一堆参数。然后使用这些参数在下拉菜单下包含一个页面。我正在使用 ui:include 来包含此页面，但我很确定 ui:include 每个生命周期只执行一次。这意味着该页面只显示一次，并且在下拉列表更改时不会更改。

这是我的观点的一个例子

```
<h:form>
    <!-- dropdowns to build the route to the included page -->
    <h:selectOneMenu>
        <f:selectItems ... />
        <f:ajax 
           event="change" 
           render=":formInclude" 
           execute=":formInclude" 
           listener="#{control.handledd1Change}"/>
    </h:selectOneMenu>
    <h:selectOneMenu>
        <f:selectItems ... />
        <f:ajax 
           event="change" 
           render=":formInclude" 
           execute=":formInclude" 
           listener="#{control.handledd2Change}"/>
    </h:selectOneMenu>
    <h:selectOneMenu>
        <f:selectItems ... />
        <f:ajax 
           event="change" 
           render=":formInclude" 
           execute=":formInclude" 
           listener="#{control.handledd3Change}"/>
    </h:selectOneMenu>
</h:form>
<h:panelGrid id="formInclude">
    <ui:include src="#{control.formName}.xhtml"/>
</h:panelGrid> 
```

所以，我想知道在 JSF 中动态包含页面的最正确方法是什么。我对 ui:include 只执行一次是否正确？还有什么我可以用来动态包含页面的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:39:29.373

事实证明，我能够在每次下拉更改后执行 ui:insert 。我所要做的就是使用 ajax 执行并重新渲染它。这是我用来帮助找到方法的页面：

[如何使用 JSF 2.0 Facelets 在 XHTML 中包含另一个 XHTML？](https://stackoverflow.com/questions/4792862/how-to-include-another-xhtml-in-xhtml-using-jsf-2-0-facelets)

# c# - C# Lambda 和“this”变量范围

> ID：11103745
> 
> 赞同：14
> 
> 时间：2012-06-19T14:59:15.890
> 
> 标签：c#, lambda, scope, this

我想知道我是否可以`this`在 C# lambda 中使用关键字，虽然实际上我*知道*我可以，但我想确保这不是一件坏事，或者以后会产生微妙的问题。

阅读了[lambdas 变量范围](http://msdn.microsoft.com/en-us/library/bb397687.aspx)的规则后，我可以看到：

> 在引用它的委托超出范围之前，不会对捕获的变量进行垃圾收集。

所以这让我假设对象实例 ( `this`) 也将被捕获。为了测试这一点，我写了这个人为的例子，这是我想在我的真实代码中大致瞄准的 - 用 LINQPad 编写，因此我有`Dump()`方法调用：

```
void Main()
{
    Repository repo = new Repository();
    Person person = repo.GetPerson(1);

    person.ID.Dump("Person ID - Value Assigned");
    person.Name.Dump("Person Name - Lazily Created");
}

class Person
{
    public Person(Lazy<string> name)
    {
        this.name = name;
    }

    public int ID { get; set; }

    private Lazy<string> name;
    public string Name
    {
        get { return name.Value; }
    }
}

class Repository
{
    public Person GetPerson(int id)
    {
        // Setup person to lazily load a name value
        Person person = new Person(
            new Lazy<string>(
                () => this.GetName()    // <--- This I'm not sure on...
            )
        );
        person.ID = id;
        return person;
    }

    public string GetName()
    {
        return "John Smith";
    }
} 
```

这运行并为我提供了正确的输出，因此`this`从 lambda 中访问显然有效。我想检查的是：

*   这是否遵循与局部变量相同的变量范围规则，这意味着`this`引用将保留在内存中，直到不再使用 lambda？从我的小实验中可以看出，但如果有人能提供更多细节，我会很感兴趣。
*   这是可取的吗？我不想在以后陷入这种模式可能导致问题的情况。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-19T16:43:54.663

在 lambda中使用没有任何问题`this`，但是正如您所提到的，如果您确实使用`this`（或者如果您隐式使用它，通过调用任何非静态成员函数或使用非静态成员变量），那么垃圾收集器将保留`this`引用的对象至少只要代表还活着就活着。由于您将 lambda 传递给`Lazy`，这意味着`Repository`至少只要`Lazy`对象还活着（即使您从不调用`Lazy.Value`）， 将是活着的。

为了稍微揭开它的神秘面纱，它有助于查看反汇编程序。考虑这段代码：

```
class Foo {
    static Action fLambda, gLambda;

    int x;
    void f() {
        int y = 0;
        fLambda = () => ++y;
    }
    void g() {
        int y = 0;
        gLambda = () => y += x;
    }
} 
```

标准编译器将其更改为以下内容（尝试忽略`<>`额外的尖括号）。如您所见，使用函数体内部变量的 lambda 被转换为类：

```
internal class Foo
{
    private static Action fLambda;
    private static Action gLambda;
    private int x;

    private void f()
    {
        Foo.<>c__DisplayClass1 <>c__DisplayClass = new Foo.<>c__DisplayClass1();
        <>c__DisplayClass.y = 0;
        Foo.fLambda = new Action(<>c__DisplayClass.<f>b__0);
    }
    private void g()
    {
        Foo.<>c__DisplayClass4 <>c__DisplayClass = new Foo.<>c__DisplayClass4();
        <>c__DisplayClass.<>4__this = this;
        <>c__DisplayClass.y = 0;
        Foo.gLambda = new Action(<>c__DisplayClass.<g>b__3);
    }

    [CompilerGenerated]
    private sealed class <>c__DisplayClass1
    {
        public int y;
        public void <f>b__0()
        {
            this.y++;
        }
    }
    [CompilerGenerated]
    private sealed class <>c__DisplayClass4
    {
        public int y;
        public Foo <>4__this;
        public void <g>b__3()
        {
            this.y += this.<>4__this.x;
        }
    }

} 
```

如果您使用`this`，无论是隐式还是显式，它都会成为编译器生成的类中的成员变量。所以`f()`, `DisplayClass1`, 的类不包含对 的引用`Foo`，但 , , 的类`g()`包含`DisplayClass2`。

如果 lambdas 不引用任何局部变量，编译器会以更简单的方式处理它们。所以考虑一些稍微不同的代码：

```
public class Foo {
    static Action pLambda, qLambda;

    int x;
    void p() {
        int y = 0;
        pLambda = () => Console.WriteLine("Simple lambda!");
    }
    void q() {
        int y = 0;
        qLambda = () => Console.WriteLine(x);
    }
} 
```

这次 lambda 不引用任何局部变量，因此编译器将您的 lambda 函数转换为普通函数。in 中的 lambda`p()`不使用`this`，因此它成为一个静态函数（称为`<p>b__0`）；lambda in`q()`确实`this`（隐式）使用，因此它成为一个非静态函数（称为`<q>b__2`）：

```
public class Foo {
    private static Action pLambda, qLambda;

    private int x;
    private void p()
    {
        Foo.pLambda = new Action(Foo.<p>b__0);
    }
    private void q()
    {
        Foo.qLambda = new Action(this.<q>b__2);
    }
    [CompilerGenerated] private static void <p>b__0()
    {
        Console.WriteLine("Simple lambda!");
    }
    [CompilerGenerated] private void <q>b__2()
    {
        Console.WriteLine(this.x);
    }
    // (I don't know why this is here)
    [CompilerGenerated] private static Action CS$<>9__CachedAnonymousMethodDelegate1;
} 
```

**注意：我使用**[ILSpy](https://github.com/icsharpcode/ILSpy)查看了编译器输出，并**关闭**了“反编译匿名方法/lambdas”选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:17:17.520

虽然`this`在这样的 lambda 中使用是正确的，但您只需要注意，在您的`Repository`对象可垃圾回收之前，您的对象不会是可垃圾回收的`Person`。

您可能希望有一个字段来缓存 lambda 的结果，一旦它被延迟填充，请释放 lambda，因为您不再需要它。

就像是：

```
private Lazy<string> nameProxy; 
private string name;
public string Name 
{ 
  get 
  {
    if(name==null)
    {
      name = nameProxy.Value;
      nameProxy = null;
    }
    return name;
  } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T15:08:27.263

在 lambdas中使用绝对`this`没问题，但有一些事情你应该记住：

*   `this`将保留在内存中，直到不再使用 lambda
*   如果你没有`this`在课堂外通过 lambda "with"，那么你就不会遇到问题
*   如果你确实在你的类之外传递了 lambda "with "，那么你应该记住，在剩下对 lambda 的引用之前`this`，你的类不会被收集。`GC`

并且与您的用例相关，您应该记住，在它创建的人正在使用之前，`Repository`实例永远不会被收集。`GC`

# android - android中带有textviews的listview

> ID：11103751
> 
> 赞同：0
> 
> 时间：2012-06-19T14:59:31.523
> 
> 标签：android, listview, layout, textview

我正在尝试设计一个包含 3 个文本视图的列表视图。1 个文本视图用于作者，第 2 个用于日期，最后一个用于评论。但是我在布局方面遇到了一些问题，而且我不是 XML 中的怪物。所以我确实需要一些建议。这是我的清单看起来像 atm：[http ://tinypic.com/view.php?pic=357khhj&s=6](http://tinypic.com/view.php?pic=357khhj&s=6)

正如你所看到的，每当有人输入超过几个词（如 jesper 的评论）时，一切看起来都很糟糕。任何提示如何在没有行的情况下解决这个问题都会像图片中一样被搞砸？此外，我只希望能够在评论中显示 2 行文本，即使该人实际键入，例如 10 行。谢谢！

这是xml代码：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:background="#ffffff" >

<TableLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:stretchColumns="1"
    android:weightSum="1.0" >

    <TableRow>

        <TextView
            android:id="@+id/feedback_list_item_name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="5dp"
            android:layout_marginTop="5dp"
            android:layout_weight="0.8"
            android:gravity="left"
            android:shadowColor="#bdbebd"
            android:shadowDx="1.0"
            android:shadowDy="1.0"
            android:shadowRadius="0.5"
            android:text="Unknown"
            android:textColor="#000000"
            android:textSize="16dp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/feedback_list_item_time"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginRight="5dp"
            android:layout_marginTop="5dp"
            android:layout_weight="0.2"
            android:gravity="right"
            android:shadowColor="#bdbebd"
            android:shadowDx="1.0"
            android:shadowDy="1.0"
            android:shadowRadius="1.0"
            android:text="00:00"
            android:textColor="#3c6dae"
            android:textSize="16dp" />
    </TableRow>

    <TableRow>

        <TextView
            android:id="@+id/feedback_list_item_comment"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="5dp"
            android:layout_marginTop="5dp"
            android:shadowColor="#cccccc"
            android:shadowDx="1.0"
            android:shadowDy="1.0"
            android:shadowRadius="0.5"
            android:text="No comment"
            android:textColor="#222222"
            android:textSize="16dp" />
        >
    </TableRow>
</TableLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:12:22.993

为表格的每一行使用一个 RelativeLayout。例如，尝试使用以下代码代替您的两个 TableRows：

```
<RelativeLayout
    android:layout_height="wrap_content">

    <TextView
        android:id="@+id/feedback_list_item_name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="5dp"
        android:layout_marginTop="5dp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:gravity="left"
        android:shadowColor="#bdbebd"
        android:shadowDx="1.0"
        android:shadowDy="1.0"
        android:shadowRadius="0.5"
        android:text="Unknown"
        android:textColor="#000000"
        android:textSize="16dp"
        android:textStyle="bold"
        android:lines="1"/>

    <TextView
        android:id="@+id/feedback_list_item_time"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginRight="5dp"
        android:layout_marginTop="5dp"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:gravity="right"
        android:shadowColor="#bdbebd"
        android:shadowDx="1.0"
        android:shadowDy="1.0"
        android:shadowRadius="1.0"
        android:text="00:00"
        android:textColor="#3c6dae"
        android:textSize="16dp" />

    <TextView
        android:id="@+id/feedback_list_item_comment"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="5dp"
        android:layout_marginTop="5dp"
        android:layout_alignParentLeft="true"
        android:layout_below="@id/feedback_list_item_name"            
        android:shadowColor="#cccccc"
        android:shadowDx="1.0"
        android:shadowDy="1.0"
        android:shadowRadius="0.5"
        android:text="No comment"
        android:textColor="#222222"
        android:textSize="16dp"
        android:maxLines="2" />

</RelativeLayout> 
```

此外，将 maxLines="2" 添加到注释 TextView 会将其限制为两行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:43:56.083

试试这个

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:singleLine="true" />

        <TextView
            android:id="@+id/textView2"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:singleLine="true" />
    </LinearLayout>

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:singleLine="true" />

</LinearLayout> 
```

# c++ - 调用 Boost JSON 解析器永远不会返回

> ID：11103753
> 
> 赞同：4
> 
> 时间：2012-06-19T14:59:34.540
> 
> 标签：c++, linux, json, qt, boost

我在 Linux 上运行的基于 QT 的单线程控制台应用程序使用 Boost 解析 JSON 字符串，并且它正常工作，除非接收到非常大的 JSON 块。我有一个大小约为 160kb 的有效 JSON（！），当我尝试解析它时，对 Boost 的 JSON 解析器的调用永远不会返回。我已经离开了很长一段时间。如果我随后中断使用调试器，我的应用程序就会闲置在它的消息循环中，就好像什么都没发生一样。该调用不会引发异常。除了它的大尺寸之外，JSON 没有什么值得注意的——它格式正确并且完全由 ASCII 字符组成。

执行如何简单地“放弃”并返回 QT 消息循环？

```
void IncomingRequestHandler::OnRequest(const QString& message)
{
    try
    {
        std::stringstream ss;
        ss << message.toStdString();
        boost::property_tree::ptree requestObject;

        cout << "Before read_json" << endl;  // Gets here
        boost::property_tree::json_parser::read_json(ss, requestObject);
        cout << "After read_json" << endl;  // Never gets here

        // ... Some other code ...
    }
    catch (const boost::property_tree::json_parser::json_parser_error& e)
    {
        cout << "Invalid JSON" << endl;  // Never gets here
    }
    catch (const std::runtime_error& e)
    {
        cout << "Invalid JSON" << endl;  // Never gets here
    }
    catch (...)
    {
        cout << "Invalid JSON" << endl;  // Never gets here
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T21:05:50.303

首先，我同意上面的两条评论：尽量减少你的程序。

其次，我会尝试检查 Qt（stl，boost，这个特定版本的任何东西）是否可以处理那么大的字符串。确保您的解析器正在获取整个字符串。

第三，我会使用 ostringstream 而不是 sstream。:)

根据 boost 文档，解析器返回错误的唯一方法似乎是在您的 property_tree 中返回错误信息。如果它一直持续读取，则可能意味着它正在读取超出实际 JSON 数据的垃圾并卡在上面。

最后，read_json 可以接受文件名，那么为什么还要费心读取文件和创建流呢？你为什么不试试这个：

```
 boost::property_tree::ptree requestObject;
    cout << "Before read_json" << endl;  // Gets here
    boost::property_tree::json_parser::read_json(jsonFileName.toStdString(),
                                                 requestObject);
    cout << "After read_json" << endl;  // Never gets here 
```

我刚刚用 400Kb 大的 JSON 文件进行了一个小测试，它工作得很好：

```
 #include <iostream> 
    #include <string> 
    #include <boost/property_tree/ptree.hpp>
    #include <boost/property_tree/json_parser.hpp>

    using namespace std;

    int main(int argc, char* argv[])
    {
        string infname = argv[1];

        boost::property_tree::ptree requestObject;
        cout << "Before read_json" << endl;  // Gets here
        boost::property_tree::json_parser::read_json(infname, requestObject);
        cout << "After read_json" << endl;  // Works fine

        return 0;
    } 
```

# unit-testing - CakePHP 2.1：使用组件重定向时使用 $this->testAction() 测试控制器时未设置 $this->headers

> ID：11103759
> 
> 赞同：0
> 
> 时间：2012-06-19T14:59:50.377
> 
> 标签：unit-testing, cakephp, phpunit, cakephp-2.1

我开始为应用程序编写测试，并且我制作了一个包装器 RedirectComponent 来处理所有重定向。现在我开始测试我的应用程序（我对测试相当陌生）我在这里遵循这个例子...... [http://book.cakephp.org/2.0/en/development/testing.html#a-more -复杂示例](http://book.cakephp.org/2.0/en/development/testing.html#a-more-complex-example)

现在一切都很好，除了我不能对`$this->headers`参数运行断言，因为它总是空白的。我发现如果我使用控制器重定向方法直接在控制器中重定向一切正常并`$this->headers`设置为：

```
array(
    'Location' => 'http://localhost/inquiries/view/4'
) 
```

但是，整个应用程序都在使用这个 RedirectComponent，我希望`$this->headers`在编写使用这个组件重定向的控制器测试时显示出来。

不过，我不知道如何解决这个问题，因为似乎我做的一切都是正确的，它应该可以工作。

下面是我的代码。

```
class InquiriesControllerTestCase extends ControllerTestCase {

    /**
     * Test Add Pass
     *
     * @return void
     */
    public function testAddPass() { 
        $minimumInsertData = array(
                'Inquiry'=>array(
                    'fname'=>'---Minimum Insert---',
                    'lname'=>'---Minimum Insert---',
                    'phone'=>'---Minimum Insert---',
                    'email'=>'email@email.com',
                    'subject'=>'---Minimum Insert---',
                    'inquiry'=>'---Minimum Insert---',
                )
            );

        #create mock controller
        $Inquiries = $this->generate('Inquiries', array(
            'components'=>array(
                'Email',    
                'Redirect',
                'Session',
                'Sms',
            )
        ));

        #expects one sms message
        $Inquiries->Sms
            ->expects($this->once())
            ->method('send')
            ->will($this->returnValue(true));

        #expects two emails
        $Inquiries->Email
            ->expects($this->exactly(2))
            ->method('send')
            ->will($this->returnValue(true));

        #expects flash success

        $Inquiries->Redirect
            ->expects($this->once())
            ->method('flashSuccess');

        #call add
        $test = $this->testAction('/inquiries/add', array('data'=>$minimumInsertData, 'method'=>'post', 'return'=>'contents'));
        debug($this->headers);
        die;
    }
}

class InquiriesController extends MastersController {

    /*
     * Name
     */
    public $name = 'Inquiries';

    /*
     * Attached Components
     */
    public $components = array(     
        'Captcha',
        'Email',
        'PersistentValidation',
        'Sms',
    );

    /*
     * Helpers
     */
    public $helpers = array(
        'AjaxChat',
    );

    /**
     * Add
     * @return void
     */
    public function add(){
        $this->viewPath = 'Inquiries';
        $this->set("title_for_layout", 'Contact Us');
        if(!empty($this->request->data)) {
            $this->request->data['Inquiry']['status_id'] = $this->Inquiry->Status->id('unresolved', 'inquiry');
            //$this->request->data['Inquiry']['user_id'] = $this->Auth->user('id');
            //$this->request->data['Inquiry']['account_id'] = $this->Auth->user('account_id');
            $this->request->data['Inquiry']['ip'] = env('REMOTE_ADDR');
            if($this->Inquiry->save($this->request->data)) {

                #send SMS
                if($this->sendSms) {                    
                    $smsToAso = array(
                        'number'=>Configure::read('Inquiry.add.sms.number'),
                        'from'=>Configure::read('Inquiry.add.sms.from'),
                        'carrier'=>Configure::read('Inquiry.add.sms.carrier'),
                        'text'=>Configure::read('Inquiry.add.sms.text').' https://www.airsatone.com/admin/inquiries/view/'.$this->Inquiry->id,
                    );
                    $this->Sms->send($smsToAso);                    
                }

                #send email
                if($this->sendEmail){                       
                    #send user an email
                    $this->Email->template = Configure::read('Inquiry.add.email.template');
                    $this->Email->to = $this->request->data['Inquiry']['email'];
                    $this->Email->from = Configure::read('Inquiry.add.email.from');
                    $this->Email->subject = Configure::read('Inquiry.add.email.subject');
                    $this->Email->message = Configure::read('Inquiry.add.email.message');                   
                    $this->Email->send();

                    #send email to ASO                  
                    $message = '<p>ASO Inquiry from '.$this->request->data['Inquiry']['fname'].' '.$this->request->data['Inquiry']['lname'];
                    if(!empty($this->request->data['Inquiry']['company'])) $message .= ' at '.$this->request->data['Inquiry']['company'].'</p>';
                    $message .= '<p>You may contact this individual by phone:'.$this->request->data['Inquiry']['phone'].' or email:'.$this->request->data['Inquiry']['email'].'</p>';
                    $message .= $this->request->data['Inquiry']['inquiry'];

                    $this->Email->template = Configure::read('Inquiry.add.email_aso.template');
                    $this->Email->to = Configure::read('Inquiry.add.email_aso.to');
                    $this->Email->from = Configure::read('Inquiry.add.email_aso.from');
                    $this->Email->subject = Configure::read('Inquiry.add.email_aso.subject');
                    $this->Email->message = $message;
                    $this->Email->send();
                }           
                 return $this->redirect(array('controller'=>'inquiries', 'action'=>'view', $this->Inquiry->id));            
                //return $this->Redirect->flashSuccess('Thanks for your inquiry, XXXXXX will be contacting you regarding your inquiry shortly.', array('controller'=>'inquiries', 'action'=>'view', $this->Inquiry->id));
            } else {
 return $this->redirect($this->referer());
                //return $this->Redirect->flashWarning('There was a problem submitting your form. Please check to make sure the form was filled out correctly.', $this->referer());
            }
        }
    }
}

class RedirectComponent extends Component {

    /*
     * Controller
     */
    public $controller = null;

    /*
     * Components
     */
    public $components = array('Session');

    /*
     * Settings
     */
    public $settings = array();

    /*
     * Success
     */
    public $success = null;

    /*
     * Warning
     */
    public $warning = null;

    /*
     * Notice
     */
    public $notice = null;

    /*
     * Config
     */
    public $config = array();

    /**
     * Initialize
     * @param $controller
     */
    public function initialize(&$controller){
        $this->controller = $controller;
        $this->settings = array_merge(array('success'=>'success', 'warning'=>'warning', 'notice'=>'notice'), $this->config);
        $this->success =  $this->settings['success'];
        $this->warning = $this->settings['warning'];
        $this->notice = $this->settings['notice'];
    }

    /**
     * Flash Success
     * 
     * Redirects a user with a success flash message
     * @param $msg
     * @param $url
     */
    public function flashSuccess($msg, $url=null){
        $this->Session->setFlash($msg, $this->success);
        if(!empty($url)){
            return $this->controller->redirect($url, null, true);
        }
    }

    /**
     * Flash Warning
     *  
     * Redirects a user with a warning flash message
     * @param $msg
     * @param $url
     */
    public function flashWarning($msg, $url=null) {
        $this->Session->setFlash($msg, $this->warning);
        if(!empty($url)){
            return $this->controller->redirect($url, null, true);
        }
    }

    /**
     * Flash Notice
     *  
     * Redirects a user with a notice flash message
     * @param $msg
     * @param $url
     */
    public function flashNotice($msg, $url=null){
        $this->Session->setFlash($msg, $this->notice);
        if(!empty($url)){
            return $this->controller->redirect($url, null, true);
        }
    }

    /**
     * Determines if an id is empty & sends a flash arning if it is.
     * 
     * @param $id
     * @param $url
     * @param $msg
     */
    public function idEmpty($id=null, $url=null, $msg='Invalid Id'){
        if (!$id && empty($this->controller->data)) {
            $this->flashWarning($msg, $url);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:18:28.573

您的`SessionComponent::flashSuccess()`方法从未真正执行过，因为您模拟了它。因此，它无法操纵`$this->header`. 如果您想测试您的重定向是否正确，为什么不检查您的重定向函数是否使用正确的参数调用，如下所示：

```
$Inquiries->Redirect
            ->expects($this->once())
            ->method('flashSuccess')
            ->with('/where/it/should/redirect');
              // or whatever parameters it takes 
```

# c# - 互联网和智能手机浏览器之间的网络代理

> ID：11103765
> 
> 赞同：0
> 
> 时间：2012-06-19T15:00:17.397
> 
> 标签：c#, c#-4.0, proxy, web, wireless

我已经通过 wifi 在我的 Win-7 笔记本电脑和三星智能手机 (Bada OS 2.0) 之间创建了一个 ad-hoc 网络连接。我还通过验证 ip 地址并从笔记本电脑 ping 我的智能手机来检查连接性。

现在，我想编写一个代理服务器，它位于我的 Win-7 上，在端口 8080 上接受来自智能手机的 HTTP 请求，从互联网检索网页，并将其传递回智能手机。这个想法是双重的：在我的智能手机上访问互联网，并学习关于移动设备的网络编程。我编写了以下 c-sharp 代码，它实现了 TCPListener 以接收请求并发送回响应，这非常好：

```
 private void listen()
    {
        try
        {
            listener.Start();
            while (true)
            {
                Socket client= listener.AcceptSocket();
                ProcessClient(client);
            }
        }
        catch (ThreadAbortException ex)
        {
            WriteLog("Error occured: " + ex.Message);
        }
    }

    private void ProcessClient(Socket client)
    {
        //extract client data
        byte[] bytes=new byte[1024];
        int size = client.Receive(bytes, bytes.Length, SocketFlags.None);

        string clientmessage = System.Text.Encoding.ASCII.GetString(bytes);

        if (size == 0)
            return;

        int index1  = clientmessage.IndexOf(@" ");
        int index2 = clientmessage.IndexOf(@" ", index1 + 1);
        if (index1 == -1 || index2 == -1)
        {
            throw( new Exception());
        }

        //extract client url
        string part1 = clientmessage.Substring(index1 + 1, index2 - index1);
        int index3 = part1.IndexOf(@"/", index1 + 8);
        int index4 = part1.IndexOf(@" ", index1 + 8);
        int index5 = index4 - index3;
        string sURL= part1.Substring(index1 + 4, part1.Length - index5 - 8);

        //send request to web server
        IPHostEntry serverHost = Dns.GetHostEntry(sURL);
        string[] aliases = serverHost.Aliases;
        IPAddress[] addresses = serverHost.AddressList;
        IPEndPoint serverEP = new IPEndPoint(addresses[0], 80);
        Socket server = new Socket((addresses[0].AddressFamily), SocketType.Stream, ProtocolType.Tcp);
        server.Connect(serverEP);

        //server.Send(bytes, bytes.Length, SocketFlags.None);
        byte[] sendbytes = new byte[1024];
        size = System.Text.Encoding.ASCII.GetBytes(clientmessage, 0, clientmessage.Length, sendbytes, 0);
        server.Send(sendbytes, sendbytes.Length, SocketFlags.None);
        //server.Send(System.Text.ASCIIEncoding.ASCII.GetBytes(clientmessage), System.Text.ASCIIEncoding.ASCII.GetByteCount(clientmessage), SocketFlags.None);

        //read response from web server
        byte[] rbytes = new byte[4096];
        string strPage = "";
        size = 1;
        while (size > 0)
        {
            size = server.Receive(rbytes, rbytes.Length, SocketFlags.None);
                strPage += System.Text.Encoding.ASCII.GetString(rbytes,0,size);
        }
        server.Shutdown(SocketShutdown.Both);
        server.Close();

        //send the page back to the client
        //bytes = System.Text.Encoding.ASCII.GetBytes(strPage);
        bytes = new byte[strPage.Length+1];
        size = System.Text.Encoding.ASCII.GetBytes(strPage,0,strPage.Length,bytes,0);
        client.Send(bytes, size, SocketFlags.None);
    } 
```

上面的代码从客户端（智能手机浏览器）获取请求，获取请求头部分并将其传递给网络服务器，然后通过相同的客户端套接字将响应中继回智能手机。这一切正常。出了问题的是网络服务器正在发送“错误请求 - 状态代码 400”的响应。我很惊讶这种情况正在发生，因为我所做的只是在两个端点之间来回转发请求。你能分享一下这个吗？以下是我通过分别获取变量 clientmessage 和 strPage 获得的发送的请求标头和接收的响应标头：

**要求：**

```
GET http://prahlad-tosh/welcome.png HTTP/1.1
Proxy-Connection: Keep-Alive
Host: prahlad-tosh
Accept: text/html, application/xml, image/vnd.wap.wbmp, image/png, image/jpeg, image/gif, image/bmp, application/vnd.wap.xhtml+xml, application/xhtml+xml, application/vnd.wap.multipart.mixed, multipart/mixed, application/vnd.oma.dd+xml, text/vnd.sun.j2me.app-descriptor, application/java-archive, application/vnd.youtube, */*
Accept-Language: en
X-Wap-Proxy-Cookie: none
Accept-Charset: utf-8;q=1.0,iso-8859-1;q=0.6
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/5.0 (SAMSUNG; SAMSUNG-GT-S5380K/S5380KDDKK6; U; Bada/2.0; en-us) AppleWebKit/534.20 (KHTML, like Gecko) Dolfin/3.0 Mobile HVGA SMM-MMS/1.2.0 OPN-B
Referer: `http://prahlad-tosh/` 
```

**回复：**

```
HTTP/1.1 400 Bad Request
Content-Type: text/html; charset=us-ascii
Server: Microsoft-HTTPAPI/2.0
Date: Tue, 19 Jun 2012 14:10:14 GMT
Connection: close
Content-Length: 326
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN""http://www.w3.org/TR/htm/strict.dtd">
<HTML><HEAD><TITLE>Bad Request</TITLE>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=us-ascii"></HEAD>
<BODY><h2>Bad Request - Invalid Verb</h2>
<hr><p>HTTP Error 400\. The request verb is invalid.</p>
</BODY></HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:04:30.630

编辑：我认为问题可能出在服务器上。改用 Apache 或连接到 google.com 怎么样？

旁注：我认为您不需要`http://prahlad-tosh`GET 请求中的部分，就`/welcome.png`可以了。

# c# - 在 ASP.Net 中使用的最佳会话状态模式是什么，这样我的网站的 CPU 使用率不会很高？

> ID：11103766
> 
> 赞同：1
> 
> 时间：2012-06-19T15:00:20.153
> 
> 标签：c#, asp.net-mvc-3, session-state, cpu-usage, signalr

我有这个在线商店，使用以下语言/技术 C#、MVC3、DI 的结构图、实时通知的 SignalR 和会员登录的 FBConnect。

我在具有 Core2 Quad CPU @ 2.40GHz 和 8GB RAM 的专用服务器上运行该站点，但是当许多用户访问该站点时，CPU 使用率仍然达到 60-80%。该站点正在从数据库中加载照片，但我认为这不是问题，因为我已经实现了这些照片的缓存，您可以在我的旧帖子@ [MVC3 + 中看到来自数据库的流式图像导致 CPU 使用率非常高在我的服务器上](https://stackoverflow.com/questions/10791933/mvc3-streaming-images-from-the-database-is-causing-very-high-cpu-usage-on-my-s)。我什至将我的页面修改为最初加载 20 张照片，并且仅在用户滚动到页面底部时才加载更多照片。

我已经和一位也是 .net 开发人员的朋友讨论过这个问题，他说我可能应该研究 Session-State 模式，因为它可能会有所帮助。我没有对我网站上的 Session-State 进行任何更改，因此它仍在使用默认的 InProc。

我的问题是：可以处理大流量的最佳会话状态模式是什么？它会提高我网站的性能吗？

只是为了让您了解该网站如何获得大量用户，以下是它的工作原理： 1\. 卖家在相册中发布待售物品的照片（最大照片/相册为 200，并且它们在 20 之前加载）。2.第一个评论/预订该项目的客户将是获胜的买家。3.卖方然后向第一位买方确认评论/保留。

该网站有超过 1000 名用户，其中至少 80% 的用户同时访问该网站。

我可以使用默认的 InProc 吗？还是应该使用 StateServer 或 SQLServer 模式？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:05:44.527

> 我认为这不是问题，因为[...]

你在猜测。只要您猜测您将无法处理性能问题（假设这是一个问题：见下文）。

你需要*测量*。使用类似[mini-profiler](http://miniprofiler.com/)的东西来确定到底是什么花费了时间。

但：

> CPU使用率仍然达到60-80%

网站变慢了吗？请求是否在排队？*用户是否认为网站速度很慢？*

对于您获得的请求率，该级别的 CPU 使用率可能是相当正常的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:05:28.057

如果您使用单独的服务器来存储会话，这将减轻主服务器上的会话管理负载，但在读取/写入另一台服务器上的会话时会增加网络开销。

我认为使用 SQLServer 模式是您情况下的最佳选择，特别是因为它使您受益于拥有会话的“硬”副本，以防对谁首先评论/保留该项目存在任何争议。

您已经在使用 SQL 来加载图像，那么为什么不再给它做一件事呢？

如果我忽略了什么，我会让社区指出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T15:16:02.500

在我看来，800 个用户访问同一台服务器并不是那么简单。

Sessionstate 与它无关。

您正在从数据库加载图像并将它们保存在缓存中。缓存中有多少张图片？每张图片100KB？50K 图像或更多？

如果缓存中的内容过多（不仅仅是图像！），ASP.NET 将自动丢弃缓存中的内容（取决于它们的重要性）。当您到达这一点时，您的应用程序将不断地将新内容放入缓存中，这些新内容在插入后几乎立即被删除，这与没有缓存中的图像相同。

无论如何，我仍然认为情况可能并非如此，因为如果你真的有 800 个用户同时访问同一台服务器，那就很多了。

我同意@Richard。使用类似迷你分析器的东西。

# sql - 使用带有缺陷字段的 MAX() 函数

> ID：11103767
> 
> 赞同：1
> 
> 时间：2012-06-19T15:00:31.857
> 
> 标签：sql, sql-server-2008, tsql, crystal-reports-2008

## 样本数据

## 表格1

```
table.DateTime_From          |         table.DateTime_To
-----------------------------|--------------------------------
01/05/2001 00:00:00          |         01/05/2001 08:00:00
01/05/2001 08:00:00          |         01/05/2001 18:00:00
01/05/2001 18:00:00          |         01/05/2001 00:00:00
03/05/2001 00:00:00          |         03/05/2001 12:00:00
03/05/2001 12:00:00          |         03/05/2001 15:00:00
03/05/2001 15:00:00          |         03/05/2001 00:00:00
07/05/2001 00:00:00          |         07/05/2001 00:00:00
06/05/2001 00:00:00          |         06/05/2001 00:00:00
05/06/2001 00:00:00          |         05/06/2001 00:00:00
07/06/2001 00:00:00          |         07/06/2001 11:00:00
07/06/2001 11:00:00          |         07/06/2001 14:00:00
07/06/2001 14:00:00          |         07/06/2001 00:00:00 
```

上表具有以下属性：

1.  对于每条记录`table.DateTime_From` <= `table.DateTime_To`。
2.  `24:00:00`可悲的是，时间值**有时**表示为`00:00:00`例如比较`table 2`和`table 3`- 这无法更改，因此更改它甚至不是一个选项。
3.  单个记录有时可以`00:00:00`在 和 下都有时间值`table.DateTime_From`，`table.DateTime_To`例如参见`table 4`。

## 表 2

```
table.DateTime_From          |         table.DateTime_To
-----------------------------|--------------------------------
01/05/2001 18:00:00          |         01/05/2001 00:00:00 
```

## 表3

```
table.DateTime_From          |         table.DateTime_To
-----------------------------|--------------------------------
01/05/2001 18:00:00          |         01/05/2001 24:00:00 
```

## 表 4

```
table.DateTime_From          |         table.DateTime_To
-----------------------------|--------------------------------
07/05/2001 00:00:00          |         07/05/2001 00:00:00 
```

* * *

## 观察

1.  使用`MIN (table.DateTime_From)`给`01/05/2001 00:00:00`

2.  尝试使用`MAX (table.DateTime_To)`会产生问题，因为这会给出`07/06/2001 14:00:00`- 尽管这实际上应该是`07/06/2001 00:00:00`ie `07/06/2001 24:00:00`。

3.  请记住，`07/06/2001 24:00:00`它表示为`07/06/2001 00:00:00`- 因此使用`MAX (table.DateTime_From)`.

* * *

## 问题

1.  有没有办法解决使用观察到的问题`MAX (table.DateTime_From)`，这样我就可以得到`07/06/2001 00:00:00`- 即使它对 . 的表示非常差`07/06/2001 24:00:00`。

2.  或者是否有一些我在这里不理解的基本细节......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:11:07.613

为什么不创建一个执行类似操作的视图（在 SQL Server 方言中）

```
SELECT table.DateTime_From
 , table.DateTime_To
 , CASE 
    WHEN DATEPART(table.DateTime_From, hour) = 0 
        AND DATEPART(table.DateTime_From, minute) = 0
        AND DATEPART(table.DateTime_From, second) = 0 
      THEN DATEADD(day, 1, table.DateTime_From)
    ELSE table.DateTime_From
   END AS DateTime_From_Corrected
 , CASE 
    WHEN DATEPART(table.DateTime_To, hour) = 0 
        AND DATEPART(table.DateTime_To, minute) = 0
        AND DATEPART(table.DateTime_To, second) = 0 
      THEN DATEADD(day, 1, table.DateTime_To)
    ELSE table.DateTime_To
   END AS DateTime_To_Corrected
FROM MyData table 
```

然后您可以使用`Corrected`查询中的列？

# javascript - 如何跨框架访问元素？

> ID：11103768
> 
> 赞同：6
> 
> 时间：2012-06-19T15:00:41.267
> 
> 标签：javascript, html, dom, frames

文件1.html

```
<html>
<head>
<title>AIDS (Automated ID System)</title>
<HTA:APPLICATION 
    id="frames" 
    border="thin" 
    caption="yes" 
    icon="http://www.google.com/favicon.ico" 
    showintaskbar="yes" 
    singleinstance="yes" 
    sysmenu="yes" 
    navigable="yes" 
    contextmenu="no" 
    innerborder="no" 
    scroll="auto" 
    scrollflat="yes" 
    selection="yes" 
    windowstate="normal" />

<script language="javascript" type="text/javascript">

    function pausecomp(millis) 
    { 
        var date = new Date(); 
        var curDate = null; 
        do { curDate = new Date(); } 
        while(curDate-date < millis); 
    } 

    function getWindowsUserName()
    {
        var WinNetwork = new ActiveXObject("WScript.Network");
        var urlToSite = createCustomURL(WinNetwork.UserName);
        var frame = document.getElementById("psyncLink"); 
        frame.onload = function() { 
            frame.onload = null; 
            if (requestingPassword()) { 
                //alert("password button screen");
                passwordButtonScreen();
            } else { 
                alert("direct password required"); 
            } 
        } 
        frame.src = urlToSite;
    }

    function requestingPassword()
    {       
        var btn = window.frames[1].document.getElementsByName("SUBMIT-password.pss");
        if (btn.length == 0) {
            return false;
        } else {
            return true;
        }
    }

    function passwordButtonScreen()
    {       
        var btn = window.frames[1].document.getElementsByName("SUBMIT-password.pss");       
        btn[0].click();     
    }

    function createCustomURL(userName)
    {
        var customURL = "http://localhost/nph-psf.exe?HOSTID=AD&ALIAS=" + userName;
        return customURL;
    }

    function Sleep(milliseconds) {
        var start = new Date().getTime();
        for (var i = 0; i < 1e7; i++) {
            if ((new Date().getTime() - start) > milliseconds){
                break;
            }
        }
    }

    function whichScreen() { 
        var btn = window.frames[1].document.getElementsByName("SUBMIT-password.pss"); 
        if (btn.length == 0) { 
            alert("no button!"); 
            // User is at password screen
            var textField = window.frames[1].document.getElementsByName("_MYPW");
            textField[0].text = "";
            return; 
        } else { 
            btn[0].click();
            WaitSeconds(5);
            var textField = window.frames[1].document.getElementsByName("_MYPW");
            textField[0].value = "ios12sdk";
            btn = window.frames[1].document.getElementsByName("SUBMIT-VERIFY");
            btn[0].click();
        }
    }

    var loadOtherFrame = function (text) { 
        getWindowsUserName(); 
        alert(text);
    };

</script>

    </head>     
    <frameset cols="300px, *"> 
        <frame src="leftframe.html" name="topo" id="topo" application="yes" /> 
        <frame src="topo1.htm" name="psyncLink" id="psyncLink" application="yes" /> 
    </frameset>     
</html> 
```

leftframe.html

```
<html>

<head>
  <title>AIDS&nbsp;Assistant</title>
</head>
<script language="javascript">

function checkPassword() {
  var validString = /^[a-z](?=[a-z]*[0-9])[a-z0-9]{0,6}[a-z]$/;
  if (validString.test(document.getElementById("newPassword").value)) {
    alert("The password is valid");
    var validate = function () {
        // validate textbox input ...
        // call parent page function
        parent.loadOtherFrame(document.getElementById("newPassword").value);
    };
  } else {
    alert("The new password does NOT meet the requirements. Please try again.");
  }
}

</script>

<body>
    <table width="300px">
        <tr>
            <td>Type Your Old Password</td>
            <td><input id="oldPassword" type="text" maxlength="8" /></td>
        </tr>
        <tr>
            <td>Please type your new password</td>
            <td><input id="newPassword" type="text" maxlength="8" min="8" /></td>
        </tr>
        <tr>
            <td colspan="2"><input id="checkOldPassword" type="button" title="Check New Password" value="Check New Password" onclick="checkPassword()" /></td>
        </tr>
    </table>

</body>

</html> 
```

让我澄清一下我在做什么

1.  leftframe.html 需要验证一个文本框
2.  处理完左帧后。它需要通知父窗口file1.html，这样才能加载第二帧（topo1.htm）

topo.htm 不存在，因此 HTA 应用程序加载页面无法找到该特定框架，但当我们从 loadOtherFrame 调用函数 getWindowsUserName() 时它应该改变。如 tjscience 所示，从 leftframe.html 文件调用 loadOtherFrame。

当我运行 HTA 时，正在调用 loadOtherFrame（在单击 leftframe.html 按钮之前）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:08:22.627

我假设你`frameset`的`frame`已经不在了。`top.window.frame_name`您可以通过任何`frame`或`top.window`本身访问所有帧。

```
form_in_psyncLink=top.window.psyncLink.document.getElementById('form_id'); 
```

* * *

**编辑**

如果此外部页面不在同一个域中，则您无法通过常规方式访问其内容。阅读更多关于[JavaScript 的同源政策](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)。（AFAIK HTA 不会改变这种行为。）

我上面的示例为您提供了对 的引用`psyncLink`，您自然会在验证脚本中使用它来访问元素`psyncLink`以“粘贴”数据。（在这种情况下，由于跨域页面，这可能是不可能的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T16:49:28.307

**编辑以包括将文本输入传递到父页面**

验证文本框时，您可以从框架中调用父页面中的函数：

**JS IN Leftframe.html**

```
<script type="text/javascript">
    var validate = function () {
        // validate textbox input ...
        // call parent page function, passing the text from the input
        parent.loadOtherFrame(text);
    };
</script> 
```

**file1.html 中的 JS**

```
<script type="text/javascript">
    var loadOtherFrame = function (text) {
        // load other frame here ...
    };
</script> 
```

# c# - iTextSharp 打印网格视图

> ID：11103771
> 
> 赞同：8
> 
> 时间：2012-06-19T15:00:47.503
> 
> 标签：c#, asp.net, printing, fonts, itextsharp

我使用 iTextSharp 打印网格视图，但我遇到了一些问题：

1.  根本没有出现阿拉伯字符。

2.  方向是 LTR，我改用 RTL。

3.  gridview 中的某些列是模板字段（标签、图像按钮、...），我无法处理这种情况。我不会显示所有这些（如删除按钮，...）

编码 ：

```
 protected void ExportToPDF(GridView gvReport, bool LandScape)
        {
            int noOfColumns = 0, noOfRows = 0;
            DataTable tbl = null;

            if (gvReport.AutoGenerateColumns)
            {
                tbl = gvReport.DataSource as DataTable; // Gets the DataSource of the GridView Control.
                noOfColumns = tbl.Columns.Count;
                noOfRows = tbl.Rows.Count;
            }
            else
            {
                noOfColumns = gvReport.Columns.Count;
                noOfRows = gvReport.Rows.Count;
            }

            float HeaderTextSize = 8;
            float ReportNameSize = 10;
            float ReportTextSize = 8;
            float ApplicationNameSize = 7;

            // Creates a PDF document

            Document document = null;
            if (LandScape == true)
            {
                // Sets the document to A4 size and rotates it so that the     orientation of the page is Landscape.
                document = new Document(PageSize.A4.Rotate(), 0, 0, 15, 5);
            }
            else
            {
                document = new Document(PageSize.A4, 0, 0, 15, 5);
            }

            // Creates a PdfPTable with column count of the table equal to no of columns of the gridview or gridview datasource.
            iTextSharp.text.pdf.PdfPTable mainTable = new iTextSharp.text.pdf.PdfPTable(noOfColumns);

            // Sets the first 4 rows of the table as the header rows which will be repeated in all the pages.
            mainTable.HeaderRows = 4;

            // Creates a PdfPTable with 2 columns to hold the header in the exported PDF.
            iTextSharp.text.pdf.PdfPTable headerTable = new iTextSharp.text.pdf.PdfPTable(2);

            // Creates a phrase to hold the application name at the left hand side of the header.
            Phrase phApplicationName = new Phrase("Contact List", FontFactory.GetFont("Arial", ApplicationNameSize, iTextSharp.text.Font.TIMES_ROMAN));

            // Creates a PdfPCell which accepts a phrase as a parameter.
            PdfPCell clApplicationName = new PdfPCell(phApplicationName);
            // Sets the border of the cell to zero.
            clApplicationName.Border = PdfPCell.NO_BORDER;
            // Sets the Horizontal Alignment of the PdfPCell to left.
            clApplicationName.HorizontalAlignment = Element.ALIGN_LEFT;

            // Creates a phrase to show the current date at the right hand side of the header.
            Phrase phDate = new Phrase(DateTime.Now.Date.ToString("dd/MM/yyyy"), FontFactory.GetFont("Arial", ApplicationNameSize, iTextSharp.text.Font.NORMAL));

            // Creates a PdfPCell which accepts the date phrase as a parameter.
            PdfPCell clDate = new PdfPCell(phDate);
            // Sets the Horizontal Alignment of the PdfPCell to right.
            clDate.HorizontalAlignment = Element.ALIGN_RIGHT;
            // Sets the border of the cell to zero.
            clDate.Border = PdfPCell.NO_BORDER;

            // Adds the cell which holds the application name to the headerTable.
            headerTable.AddCell(clApplicationName);
            // Adds the cell which holds the date to the headerTable.
            headerTable.AddCell(clDate);
            // Sets the border of the headerTable to zero.
            headerTable.DefaultCell.Border = PdfPCell.NO_BORDER;

            // Creates a PdfPCell that accepts the headerTable as a parameter and then adds that cell to the main PdfPTable.
            PdfPCell cellHeader = new PdfPCell(headerTable);
            cellHeader.Border = PdfPCell.NO_BORDER;
            // Sets the column span of the header cell to noOfColumns.
            cellHeader.Colspan = noOfColumns;
            // Adds the above header cell to the table.
            mainTable.AddCell(cellHeader);

            // Creates a phrase which holds the file name.
            Phrase phHeader = new Phrase("Contact List", FontFactory.GetFont("Arial", ReportNameSize, iTextSharp.text.Font.BOLD));
            PdfPCell clHeader = new PdfPCell(phHeader);
            clHeader.Colspan = noOfColumns;
            clHeader.Border = PdfPCell.NO_BORDER;
            clHeader.HorizontalAlignment = Element.ALIGN_CENTER;
            mainTable.AddCell(clHeader);

            // Creates a phrase for a new line.
            Phrase phSpace = new Phrase("\n");
            PdfPCell clSpace = new PdfPCell(phSpace);
            clSpace.Border = PdfPCell.NO_BORDER;
            clSpace.Colspan = noOfColumns;
            mainTable.AddCell(clSpace);

            // Sets the gridview column names as table headers.
            for (int i = 0; i < noOfColumns; i++)
            {
                Phrase ph = null;

                if (gvReport.AutoGenerateColumns)
                {
                    ph = new Phrase(tbl.Columns[i].ColumnName, FontFactory.GetFont("Arial", HeaderTextSize, iTextSharp.text.Font.BOLD));
                }
                else
                {
                    ph = new Phrase(gvReport.Columns[i].HeaderText, FontFactory.GetFont("Arial", HeaderTextSize, iTextSharp.text.Font.BOLD));
                }

                mainTable.AddCell(ph);
            }

            // Reads the gridview rows and adds them to the mainTable
            for (int rowNo = 0; rowNo < noOfRows; rowNo++)
            {
                for (int columnNo = 0; columnNo < noOfColumns; columnNo++)
                {
                    if (gvReport.AutoGenerateColumns)
                    {
                        string s = gvReport.Rows[rowNo].Cells[columnNo].Text.Trim();
                        Phrase ph = new Phrase(s, FontFactory.GetFont("Arial", ReportTextSize, iTextSharp.text.Font.NORMAL));
                        mainTable.AddCell(ph);
                    }
                    else
                    {
                        if (gvReport.Columns[columnNo] is TemplateField)
                        {
                            try
                            {
                                Label lc = gvReport.Rows[rowNo].Cells[columnNo].Controls[1] as Label;

                                string s = lc.Text.Trim();
                                Phrase ph = new Phrase(s, FontFactory.GetFont("Arial", ReportTextSize, iTextSharp.text.Font.NORMAL));
                                mainTable.AddCell(ph);
                            }
                            catch (NullReferenceException ee)
                            {
                                noOfColumns--;
                            }
                            catch (Exception ee)
                            {
                                noOfColumns--;
                            }
                        }
                        else
                        {
                            string s = gvReport.Rows[rowNo].Cells[columnNo].Text.Trim();
                            Phrase ph = new Phrase(s, FontFactory.GetFont("Arial", ReportTextSize, iTextSharp.text.Font.NORMAL));
                            mainTable.AddCell(ph);
                        }
                    }
                }

                // Tells the mainTable to complete the row even if any cell is left incomplete.
                mainTable.CompleteRow();
            }

            // Gets the instance of the document created and writes it to the output stream of the Response object.
            PdfWriter.GetInstance(document, Response.OutputStream);

            // Creates a footer for the PDF document.
            HeaderFooter pdfFooter = new HeaderFooter(new Phrase(), true);
            pdfFooter.Alignment = Element.ALIGN_CENTER;
            pdfFooter.Border = iTextSharp.text.Rectangle.NO_BORDER;

            // Sets the document footer to pdfFooter.
            document.Footer = pdfFooter;
            // Opens the document.
            document.Open();
            // Adds the mainTable to the document.
            document.Add(mainTable);
            // Closes the document.
            document.Close();

            Response.ContentType = "application/pdf";
            Response.AddHeader("content-disposition", "attachment; filename= ContactList.pdf");
            Response.End();
        } 
```

* * *

原来的[在这里](http://www.dotnetspider.com/resources/29759-Exporting-GridView-PDF.aspx)

我更改了这一行并添加了 try 和 catch 以避免异常（问题 3）：

```
DataBoundLiteralControl lc = gvReport.Rows[rowNo].Cells[columnNo].Controls[0] as DataBoundLiteralControl; 
```

到

```
Label lc = gvReport.Rows[rowNo].Cells[columnNo].Controls[1] as Label; 
```

如何解决这些问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-23T02:23:14.513

![在此处输入图像描述](../Images/53c08ed3bc1f10c7961d595379efaea3.png)

在输出中，您可以看到 LTR 上的英语列和 RTL 上的阿拉伯语列。如果您想使用 RTL 在页面上显示 GridView，则可以使用`<div dir="rtl">Put the Grid View here</div>`. 网格视图：

```
 <asp:GridView ID="GridView1" runat="server" DataSourceID="SqlDataSource1" AutoGenerateColumns="False">
        <Columns>
            <asp:TemplateField HeaderText="العربية" SortExpression="العربية">
                <ItemTemplate>
                    <asp:Label ID="arabic" runat="server" Text='<%# Eval("العربية")%>' />
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
        <Columns>
            <asp:TemplateField HeaderText="English" SortExpression="English">
                <ItemTemplate>
                    <asp:Label ID="english" runat="server" Text='<%# Eval("English") %>' />
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
        <Columns>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:Button ID="deleteButton" runat="server" Text="Delete" />
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
        <Columns>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:HyperLink ID="open" runat="server" Text="Open" NavigateUrl="~/Default.aspx"/>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView>
    <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:ConnectionString %>"
        SelectCommand="SELECT [English], [العربية] FROM [Test]"></asp:SqlDataSource>
    <br />
    <asp:Button ID="btnExport" runat="server" OnClick="btnExport_Click" Text="Export to PDF" /> 
```

客服代码：

```
 protected void ExportPDF(GridView gridViewReport)
    {
        int columnNumber = 0, rowNumber = 0;
        DataTable tbl = null;

        if (gridViewReport.AutoGenerateColumns)
        {
            tbl = gridViewReport.DataSource as DataTable; // Gets the DataSource of the GridView Control.
            columnNumber = tbl.Columns.Count;
            rowNumber = tbl.Rows.Count;
        }
        else
        {
            columnNumber = gridViewReport.Columns.Count;
            rowNumber = gridViewReport.Rows.Count;
        }
        // Creates a PDF document
        Document document = null;
        document = new Document(PageSize.A4, 0, 0, 15, 5);
        PdfPTable _table = new PdfPTable(GridView1.Columns.Count);
        _table.RunDirection = PdfWriter.RUN_DIRECTION_RTL;
        BaseFont baseFont = BaseFont.CreateFont("c:\\\\windows\\\\fonts\\\\tahoma.ttf", BaseFont.IDENTITY_H, true); // Font which has Arabic characters
        iTextSharp.text.Font font = new iTextSharp.text.Font(baseFont, 10, iTextSharp.text.Font.NORMAL);

        // Sets the gridview column names as table headers.
        for (int i = 0; i < columnNumber; i++)
        {
            iTextSharp.text.pdf.PdfPCell ph = null;

            if (gridViewReport.AutoGenerateColumns)
            {
                ph = new PdfPCell(new Phrase(10, tbl.Columns[i].ColumnName, font));
            }
            else
            {
                ph = new PdfPCell(new Phrase(10, gridViewReport.Columns[i].HeaderText, font));
            }
            if (ph != null && gridViewReport.Columns[i].HeaderText != "")
            {
                if (Regex.IsMatch(gridViewReport.Columns[i].HeaderText, "^[a-zA-Z0-9 ]*$")) // Check if Header Text is English
                {
                    ph.RunDirection = PdfWriter.RUN_DIRECTION_LTR; // Left to Right
                    BaseColor color = new BaseColor(Color.Red);
                    ph.BackgroundColor = color;
                    _table.AddCell(ph);
                }
                else
                {
                    ph.RunDirection = PdfWriter.RUN_DIRECTION_RTL; //Right to Left
                    BaseColor color = new BaseColor(Color.Red);
                    ph.BackgroundColor = color;
                    _table.AddCell(ph);
                }
            }
            else
            {
                ph.Border = iTextSharp.text.Rectangle.NO_BORDER;
                _table.AddCell(ph);
            }
        }
        // Get the gridview rows and adds them to the _table
        for (int rowIteration = 0; rowIteration < rowNumber; rowIteration++)
        {
            for (int columnIteration = 0; columnIteration < columnNumber; columnIteration++)
            {
                if (gridViewReport.AutoGenerateColumns) //Check if AutoGenrated Colunms
                {
                    string s = gridViewReport.Rows[rowIteration].Cells[columnIteration].Text.Trim();
                    PdfPCell ph = new PdfPCell(new Phrase(10, s, font));
                    _table.AddCell(ph);
                }
                else
                {
                    if (gridViewReport.Columns[columnIteration] is TemplateField) // Check if Item Template
                    {
                        PdfPCell ph = null;
                        Label lc = gridViewReport.Rows[rowIteration].Cells[columnIteration].Controls[1] as Label; // Label
                        Button btn = gridViewReport.Rows[rowIteration].Cells[columnIteration].Controls[1] as Button;// Button
                        HyperLink hyperLink = gridViewReport.Rows[rowIteration].Cells[columnIteration].Controls[1] as HyperLink; // HyperLink

                        if (lc != null)
                        {

                            string s = lc.Text.Trim();
                            ph = new PdfPCell(new Phrase(10, s, font));
                            if (Regex.IsMatch(s, "^[a-zA-Z0-9 ]*$")) //Check if cell string is English
                            {   ph.RunDirection = PdfWriter.RUN_DIRECTION_LTR; // Left to Right
                                _table.AddCell(ph); 
                            }
                            else
                            {
                                ph.RunDirection = PdfWriter.RUN_DIRECTION_RTL; // Right to Left
                                _table.AddCell(ph);
                            }

                        }
                        else if (btn != null)
                        {
                            ph = new PdfPCell(new Phrase(10, btn.Text, font));
                            ph.Phrase.Clear(); // Clear the Cell Phrase
                            ph.Border = iTextSharp.text.Rectangle.NO_BORDER;

                            _table.AddCell(ph);
                        }
                        else if (hyperLink != null)
                        {
                            ph = new PdfPCell(new Phrase(10, hyperLink.Text, font));
                            ph.Phrase.Clear(); //Clear the Cell Phrase
                            ph.Border = iTextSharp.text.Rectangle.NO_BORDER; 
                            _table.AddCell(ph);
                        }
                        else
                        {
                            _table.AddCell("--");
                        }
                    }
                    else
                    {
                        string s = gridViewReport.Rows[rowIteration].Cells[columnIteration].Text.Trim();
                        PdfPCell ph = new PdfPCell(new Phrase(10, s, font));
                        _table.AddCell(ph);
                    }
                }
            }
            _table.CompleteRow();
        }
        PdfWriter.GetInstance(document, Response.OutputStream);
        // Opens the document.
        document.Open();
        // Adds the _table to the document.
        document.Add(_table);
        // Closes the document.
        document.Close();
        Page.Response.ContentType = "application/pdf";
        Page.Response.AddHeader("content-disposition", "attachment;filename=MyGrid.pdf");
        Page.Response.Cache.SetCacheability(HttpCacheability.NoCache);
        Page.Response.Write(document);
        Page.Response.End();

    } 
```

**此代码可能不是完美编码的，但我希望这将帮助您获得所需的结果。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T18:27:36.073

[此 GridView 导出库](http://hasheminezhad.com/sites/default/files/hasheminezhad.com/GridToPdf-lib.zip)支持 RTL。您也可以尝试[PdfReport](http://pdfreport.codeplex.com)库。

# php - PHP - 从特定位置读取 TXT

> ID：11103775
> 
> 赞同：3
> 
> 时间：2012-06-19T15:00:59.467
> 
> 标签：php, parsing, text, position

我在解析 PHP 文本时遇到问题 我有一个包含此类信息的 txt 文件：

> sometext::sometext.0 = 整数：254

我需要的是获取 254 的最后一个值作为 PHP 中的变量。在这个 txt 文件中，最后一个值可以从 0 更改为 255

"sometext::sometext.0 = INTEGER: " 这部分根本没有改变。它的长度为 36 个符号，因此我需要使用 PHP 将 36 个符号之后的内容转换为变量。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:03:29.417

尝试使用[`sscanf`](http://php.net/manual/en/function.sscanf.php)：

```
$string = "sometext::sometext.0 = INTEGER: 254";    
sscanf($string, "sometext::sometext.0 = INTEGER: %d", $number);
echo $number; 
```

演示：[http ://codepad.org/Ash2QHvI](http://codepad.org/Ash2QHvI)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:12:41.983

也许[substr()](http://php.net/substr)会做？

```
$text = "sometext::sometext.0 = INTEGER: 254";    
print substr($text, 37); 
```

在这里查看它的实际效果（调整以匹配您的示例数据）：[http ://codepad.org/5Ikt3kRh](http://codepad.org/5Ikt3kRh)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T15:13:25.433

尝试使用[fgets](http://php.net/manual/en/function.fgets.php)读取文件。

对于解析，我使用*split*。我在这里写了一个[例子](http://codepad.org/JbLxWJbc)。但 sscanf 似乎是更好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T15:20:00.297

由于您知道字符串总是采用这种形式，因此您可以使用[substr()](http://php.net/manual/en/function.substr.php)函数来提取您想要的字符串部分。如果需要，然后使用[intval()](http://php.net/manual/en/function.intval.php)将其设为整数。

注意：我的计数显示您尝试获取的数字从第 33 位开始（以下变为 32，因为 substr 是基于 0 的），而不是第 36 位。

你可以得到你想要的：

```
$the_str = 'sometext::sometext.0 = INTEGER: 254';
$num = intval(substr($the_str, 32)); 
```

# mysql - mysql union 和 group by 类似字段

> ID：11103776
> 
> 赞同：1
> 
> 时间：2012-06-19T15:01:06.517
> 
> 标签：mysql, group-by, union, alias

这是我的查询（我用通用的表名替换了表名）。我正在尝试对两个不同的查询进行联合，以便按日期对它们进行分组，以便日期相似的结果显示为一行。

尝试执行时出现“每个派生表必须有自己的别名”错误。我打错了什么？

我对此进行了研究，但找不到答案。每个选定的字段都有一个别名？还是第一个 SELECT 中的问题？

```
SELECT SUM(val), id, dat, title FROM (

                      SELECT table1.product_id as id, SUM(table1.qty) as val, DATE_FORMAT(table1.created, '%Y-%m-1') as dat, table2.title as title 
                      FROM table1
                      LEFT JOIN table3 ON table1.event_id = table3.id
                      LEFT JOIN table2 ON table1.product_id = table2.id
                      WHERE table1.user_id = $user_id AND table3.active != 2 AND table3.temp = 0 AND table2.active != 2

                      GROUP BY dat

                      UNION ALL

                      SELECT table4.product_id as id, SUM(table4.qty) as val, DATE_FORMAT(table4.created, '%Y-%m-1') as dat, table2.title as title 
                      FROM table4
                      LEFT JOIN table5 ON table4.festival_id = table5.id
                      LEFT JOIN table2 ON table4.product_id = table2.id
                      WHERE table4.user_id = $user_id AND table5.active != 2 AND table2.active != 2

                      GROUP BY dat

                      )
                      GROUP BY id
                      ORDER BY dat ASC 
```

这是我正在尝试做的事情：

我原来的结果：

```
Array
(
[0] => stdClass Object
    (
        [id] => 1
        [val] => 1
        [dat] => 2012-05-1
        [title] => Test Product
    )

[1] => stdClass Object
    (
        [id] => 1
        [val] => 8
        [dat] => 2012-06-1
        [title] => Test Product
    )

[2] => stdClass Object
    (
        [id] => 2
        [val] => 4
        [dat] => 2012-06-1
        [title] => Test Product 2
    )

[3] => stdClass Object
    (
        [id] => 3
        [val] => 6
        [dat] => 2012-06-1
        [title] => Test Product 3
    )

[4] => stdClass Object
    (
        [id] => 1
        [val] => 10
        [dat] => 2012-05-1
        [title] => Test Product
    )

[5] => stdClass Object
    (
        [id] => 1
        [val] => 8
        [dat] => 2012-06-1
        [title] => Test Product
    )

[6] => stdClass Object
    (
        [id] => 2
        [val] => 3
        [dat] => 2012-06-1
        [title] => Test Product 2
    )

[7] => stdClass Object
    (
        [id] => 3
        [val] => 3
        [dat] => 2012-06-1
        [title] => Test Product 3
    )

) 
```

因此，如果他们有相似的日期和 ID，我需要这些只是一个结果。像这样：

```
 Array
(
[0] => stdClass Object
    (
        [id] => 1
        [val] => 11
        [dat] => 2012-05-1
        [title] => Test Product
    )

[1] => stdClass Object
    (
        [id] => 1
        [val] => 8
        [dat] => 2012-06-1
        [title] => Test Product
    )

[2] => stdClass Object
    (
        [id] => 2
        [val] => 7
        [dat] => 2012-06-1
        [title] => Test Product 2
    )

[3] => stdClass Object
    (
        [id] => 3
        [val] => 9
        [dat] => 2012-06-1
        [title] => Test Product 3
    )

) 
```

如果您需要其他任何东西，请告诉我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:05:46.527

尝试这个：

```
SELECT SUM(val), id, dat, title FROM (

                  SELECT table1.product_id as id, SUM(table1.qty) as val, DATE_FORMAT(table1.created, '%Y-%m-1') as dat, table2.title as title 
                  FROM table1
                  LEFT JOIN table3 ON table1.event_id = table3.id
                  LEFT JOIN table2 ON table1.product_id = table2.id
                  WHERE table1.user_id = $user_id AND table3.active != 2 AND table3.temp = 0 AND table2.active != 2

                  GROUP BY dat

                  UNION ALL

                  SELECT table4.product_id as id, SUM(table4.qty) as val, DATE_FORMAT(table4.created, '%Y-%m-1') as dat, table2.title as title 
                  FROM table4
                  LEFT JOIN table5 ON table4.festival_id = table5.id
                  LEFT JOIN table2 ON table4.product_id = table2.id
                  WHERE table4.user_id = $user_id AND table5.active != 2 AND table2.active != 2

                  GROUP BY dat

                  ) AS t
                  GROUP BY id, dat
                  ORDER BY dat ASC 
```

正如错误所暗示的，每个视图/派生表都必须有一个别名..

**编辑：**这将为您提供具有不同 id/dat 对的记录。看来这就是你所追求的。

# sql-server-2008 - SSIS 包日志记录中的 ExecutionID 更改

> ID：11103777
> 
> 赞同：1
> 
> 时间：2012-06-19T15:01:06.907
> 
> 标签：sql-server-2008, logging, ssis

我希望为此找到答案：

在 sysssislog 表中，同一包的 executionID 更改了两次。例如，在 prevalidate 阶段， executionID 是`19EF7848-F626-4AF6-8B5F-0F419530597E`. 但是这个 executionID 会更改为`DA549ABD-27CC-4965-9DA0-FC701FB8F92C`包开始执行的时间。

要查找有关此的更多信息，我阅读了有关 sysssislog 表的 BOL 条目，它指出（作为 ExecutionID 的特别说明）：

> 运行单个包可能会为 ExecutionID 元素创建具有不同值的日志条目。例如，当您在 SQL Server Data Tools 中运行包时，验证阶段可能会创建带有对应于 SQL Server Data Tools 的 ExecutionID 元素的日志条目。但是，执行阶段可能会使用对应于 dtshost.exe 的 ExecutionID 元素创建日志条目。再例如，当您运行包含执行包任务的包时，这些任务中的每一个都运行一个子包。这些子包创建的日志条目可能具有与父包创建的日志条目不同的 ExecutionID 元素。

我无法理解这种行为。在整个包的执行过程中，executionID 不应该保持不变吗？我正在考虑使用 packageGUID 作为我的标识符，这样我就可以解决这个问题，但是对此的任何帮助将不胜感激。TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T16:45:13.757

正如 BOL 所说，如果您从 BIDS (2005-2008R2)/SSDT (2012) 中运行包，则包的执行 ID 将根据事件处理流的位置而波动。如果这是不可接受的，请仅从命令行 ( `dtexec /file myPackage.dtsx`) 或通过代理作业运行包。这将消除验证阶段获取不同执行 ID 的机会。我不相信您对儿童包裹有任何追索权。

# python - 基于 Python 的 3D 模拟

> ID：11103778
> 
> 赞同：0
> 
> 时间：2012-06-19T15:01:08.450
> 
> 标签：python, 3d, simulation

我想使用路径数据模拟几架飞机的飞行。我想做它，这样你就可以看到路径和播放/暂停，以及环顾四周并与环境互动。我可以使用哪些开源 python 包/程序来导入数据并从中显示飞机的飞行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:19:28.020

我想你可以提供更多你想要的细节，你已经有 3D 模型了吗？您的路径是否在地理坐标中？根据您提供的信息，您似乎想要一个 3D 引擎。

对于使用 Python 的开源 3D 显示，我建议使用[Ogre 3D](http://www.ogre3d.org/)或[Panda 3D](http://www.panda3d.org/)。第一个是3D图形渲染引擎，第二个是3D游戏引擎。

还有[Blender 3D](http://www.blender.org/)，这是一个完整的 3D 软件。

请记住，使用 3 个维度始终是一项艰巨的任务。对于上述所有解决方案，您需要时间来学习和理解正在发生的事情。我会推荐 Blender 用于模型和 Panda 以将所有东西放在一起并工作（虽然 Blender 有一个游戏引擎，但它不如 Panda）。

另外，看看这些[其他](https://stackoverflow.com/questions/1755035/3d-engine-for-driving-simulation?rq=1) [问题](https://stackoverflow.com/questions/10489377/what-are-good-libraries-for-creating-a-python-program-for-visually-appealing-3?rq=1)。

# c# - IEnumerable Linq 方法是线程安全的吗？

> ID：11103779
> 
> 赞同：23
> 
> 时间：2012-06-19T15:01:09.540
> 
> 标签：c#, multithreading, thread-safety, atomic

我想知道 Linq 扩展方法是否是原子的？或者我是否需要在任何类型的迭代之前跨线程使用`lock`任何对象？`IEnumerable`

将变量声明为`volatile`对此有任何影响吗？

综上所述，以下哪个是最好的、线程安全的操作？

**1-没有任何锁：**

```
IEnumerable<T> _objs = //...
var foo = _objs.FirstOrDefault(t => // some condition 
```

**2-包括锁定语句：**

```
IEnumerable<T> _objs = //...
lock(_objs)
{
    var foo = _objs.FirstOrDefault(t => // some condition
} 
```

**3- 将变量声明为 volatile：**

```
volatile IEnumerable<T> _objs = //...
var foo = _objs.FirstOrDefault(t => // some condition 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-19T15:06:37.447

该接口`IEnumerable<T>`不是线程安全的。请参阅[http://msdn.microsoft.com/en-us/library/s793z9y2.aspx](http://msdn.microsoft.com/en-us/library/s793z9y2.aspx)上的文档，其中指出：

> 只要集合保持不变，枚举数就保持有效。如果对集合进行了更改，例如添加、修改或删除元素，则枚举器将不可恢复地失效，并且其行为未定义。
> 
> 枚举器没有对集合的独占访问权；因此，通过集合进行枚举本质上不是线程安全的过程。为了保证枚举过程中的线程安全，可以在整个枚举过程中锁定集合。要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

Linq 不会改变这一切。

锁定显然可以用来同步对对象的访问。但是，您必须在访问它的任何地方锁定对象，而不仅仅是在迭代它时。

将集合声明为 volatile 不会产生积极影响。它只会在读取之前和写入对集合的引用之后导致内存屏障。它不同步集合读取或写入。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-20T20:45:26.593

简而言之，它们不是如上所述的线程安全的。

但是，这并不意味着您必须在“每种迭代”之前锁定。

您需要将所有更改集合的操作（添加、修改或删除元素）与其他操作（添加、修改、删除元素或读取元素）同步。

如果您只是同时对集合执行读取操作，则不需要锁定。（所以一起运行 LINQ 命令，如 Average、Contains、ElementAtOrDefault 就可以了）

如果集合中的元素是机器字长，例如大多数 32 位计算机上的 Int，那么更改该元素的值已经是原子执行的。在这种情况下，不要在没有锁定的情况下从集合中添加或删除元素，但是如果您可以处理设计中的一些不确定性，修改值可能是可以的。

最后，您可以考虑对集合的单个元素或部分进行细粒度锁定，而不是锁定整个集合。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-06-25T13:53:36.467

这是一个证明`IEnumerable`扩展方法不是线程安全的示例。在我的机器上，`throw new Exception("BOOM");`线路总是在几秒钟内响起。

希望我已经很好地记录了代码以解释如何触发线程问题。

[您可以在linqpad](https://www.linqpad.net/)中运行此代码以亲自查看。

```
async Task Main()
{
    // The theory is that it will take a longer time to query a lot of items
    // so there should be a better chance that we'll trigger the problem. 
    var listSize = 999999;

    // Specifies how many tasks to spin up. This doesn't necessarily mean
    // that it'll spin up the same number of threads, as we're using the thread
    // pool to manage that stuff. 
    var taskCount = 9999;

    // We need a list of things to query, but the example here is a bit contrived. 
    // I'm only calling it `ages` to have a somewhat meaningful variable name. 
    // This is a distinct list of ints, so, ideally, a filter like:
    // `ages.Where(p => p == 4` should only return one result. 
    // As we'll see below, that's not always the case. 
    var ages = Enumerable
        .Range(0, listSize)
        .ToList();

    // We'll use `rand` to find a random age in the list. 
    var rand = new Random();

    // We need a reference object to prove that `.Where(...)` below isn't thread safe. 
    // Each thread is going to modify this shared `person` property in parallel. 
    var person = new Person();

    // Start a bunch of tasks that we'll wait on later. This will run as parallel
    // as your machine will allow. 
    var tasks = Enumerable
        .Range(0, taskCount)
        .Select(p => Task.Run(() =>
        {
            // Pick a random age from the list. 
            var age = ages[rand.Next(0, listSize)];

            // These next two lines are where the problem exists. 
            // We've got multiple threads changing `person.Age` and querying on `person.Age` 
            // at the same time. As one thread is looping through the `ages` collection
            // looking for the `person.Age` value that we're setting here, some other
            // thread is going to modify `person.Age`. And every so often, that will
            // cause the `.Where(...)` clause to find multiple values. 
            person.Age = age;
            var count = ages.Where(a => a == person.Age).Count();

            // Throw an exception if the `.Where(...)` filter returned more than one age. 
            if (count > 1) {
                throw new Exception("BOOM");
            }
        }));

    await Task.WhenAll(tasks);

    Console.WriteLine("Done");
}

class Person {
    public int Age { get; set; }
} 
```

# google-chrome - Chrome DevTools API 的控制台日志

> ID：11103780
> 
> 赞同：6
> 
> 时间：2012-06-19T15:01:12.803
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-devtools

我正在使用“chrome.devtools.panels.create”API 扩展谷歌浏览器，这意味着我现在在浏览器中有一些需要调试的逻辑。

无论如何可以查看控制台日志/调试我的 DevTools 添加？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-10T03:37:28.607

您需要在 inspectedWindow 中评估一个脚本：

`chrome.devtools.inspectedWindow.eval('console.log("test")')`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T19:08:28.337

如果你只需要`console.log`你可以把它包起来。实际上它适用于任何其他功能，不仅仅是`console.log`这里的包装示例`console.log`：

```
console._log = console.log;
console.log = function(){ 
    // you can do whatever you want with arguments, output to div, alert / etc.
    return console._log.apply(console,arguments); 
}; 
```

# html - HTML5 video onended 事件触发一次

> ID：11103782
> 
> 赞同：2
> 
> 时间：2012-06-19T15:01:16.273
> 
> 标签：html, events, video

我真的被这个难住了。我正在尝试在 safari 中使用 html5 视频播放器和 javascript。我想 1 播放问候视频 2 在用户进行选择时播放默认循环视频 3 播放用户选择 4 返回默认循环视频。

1、2、3 有效，但 4 无效。

我从身体呼叫问候视频

```
<video id="videok" width=400 height=400 autoplay="autoplay" src="sacagreeting.mov" >

    video not supported
</video> 
```

我在正文中设置了我的事件侦听器

```
body onload="myAddListener()"

 function myAddListener(){
    var myVideo = document.getElementsByTagName('video')[0];
        myVideo.addEventListener('ended',myNewSrc,false);
        } 
```

我播放循环默认视频的功能是

```
function myNewSrc() {
        myVideo = document.getElementsByTagName('video')[0];
        myVideo.src="sacarest.mov";
    myVideo.loop="loop";
        myVideo.load();
        myVideo.play();
    } 
```

我使用一个选择元素让用户选择一个视频和 onchange 事件来调用我的视频功能

```
function myNewSrcii() {

        myVideo = document.getElementById('videok');

    myVideo.loop=""

    myquest = document.getElementById('vidquest').value;

    switch(myquest)
    {
    case "a":
        myVideo.src="sacaa.mov"; 
        break;
    case "b":
        myVideo.src="sacab.mov";
        break;
    case "c":
        myVideo.src="sacac.mov";
        break;
    case "d":
        myVideo.src="sacad.mov";
        break;
    case "e":
        myVideo.src="sacae.mov";
        break;
    case "f":
        myVideo.src="sacaf.mov";

    }

     myVideo.load();
     myVideo.play();
} 
```

我尝试删除循环属性，在 myNewSrcii 函数中再次设置事件侦听器，在视频标签中使用 onended 事件，但没有运气。当我检查视频事件结束为真时，侦听器从不调用我的默认视频函数。任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-04T01:13:42.270

这是由于 Safari 的 HTML5 视频标签实现中的一个奇怪错误。它也可以在 Windows 的 Safari 上重现。我刚刚找到了解决此问题的一种解决方法 - 只需绑定到`loadedmetadata`事件并将其设置`currentTime`为某个非零值。这是一个例子：

```
<!doctype html>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.9.0.min.js"></script>
</head>
<body>
<video id="video" width="500" height="400" controls autoplay></video>
<script>
var src = [
 "http://content.adfox.ru/131007/adfox/205544/865991_11.mp4",
 "http://all.rutube.ru/130627/gpmdigital/217059/805529_11.mp4"
];
var curSrc = 0;
$(function() {
 $('#video').attr("src", src[curSrc % src.length]);
 curSrc++;
 var video = $('#video').get(0);

 $('#video')
 .on('loadedmetadata', function() {
  video.currentTime=0.01;
  video.play();
 })
 .on('ended', function() {
  console.log('ended');
  video.src = src[curSrc % src.length];
  video.load();
  curSrc++;
 });
});
</script>
</body>
</html> 
```

您可以在这个 jsfiddle 中尝试这个演示：http: [//jsfiddle.net/j2knz6sv/](http://jsfiddle.net/j2knz6sv/)

# javascript - jQuery 插件，用于处理鼠标移动/拖动，并在隐藏的 div 上进行缓动（类似于“内部缩放”）

> ID：11103785
> 
> 赞同：2
> 
> 时间：2012-06-19T15:01:23.520
> 
> 标签：javascript, jquery, html, ios

其实我正在寻找一个可以处理这个的jQuery插件：

*   有一个隐藏溢出的容器
*   在这个里面是另一个，它更大
*   当我在 div 上移动时，我看到的部分取决于我当前的位置
    *   当我在左上角时，我看到内部容器的左上角
    *   当我在中间时，我看到了容器的中间……</li>

我写了一个小 JavaScript 来做到这一点：

```
this.zoom.mousemove( function(event) {

    var parentOffset    = $(this).parent().offset(); 
    var relativeX       = event.pageX - parentOffset.left;
    var relativeY       = event.pageY - parentOffset.top;

    var differenceX     = that.zoom.width() - that.pageWidth;
    var differenceY     = that.zoom.height() - that.pageHeight;

    var percentX        = relativeX / that.pageWidth;
    var percentY        = relativeY / that.pageHeight;

    if (1 < percentX) {
        percentX        = 1;
    }
    if (1 < percentY) {
        percentY        = 1;
    }

    var left            = percentX * differenceX;
    var top             = percentY * differenceY;

    that.zoom.css('left', -left).css('top', -top);

}); 
```

但是，当您从容器的另一点进入时，这不是很顺利而且有点跳动。所以，在重新发明轮子之前：是否有一个插件可以做到这一点并且支持 iOS（拖动而不是鼠标移动）？为此目的，所有缩放插件（如 Cloud Zoom）都在顶部，并且大多数不支持在 iOS 上拖动。

如果没有这样的事情。我怎样才能使它更顺畅和凉爽。任何方法都会有所帮助。:)

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T14:02:28.417

所以，这是我的解决方案——效果很好并且很容易实现。可以做一些改进，但为了得到这个想法，我会保持这种状态。:)

jsfiddle上有一个演示：

[http://jsfiddle.net/insertusernamehere/78TJc/](http://jsfiddle.net/insertusernamehere/78TJc/)

**CSS**

```
<style>
    div.zoom_wrapper {
        position:   relative;
        overflow:   hidden;
        width:      500px;
        height:     500px;
        border:     1px solid #ccc;
        cursor:     crosshair;
    }
    div.zoom_wrapper > * {
        position:   absolute;
    }
</style> 
```

**HTML**

```
<div class="zoom_wrapper">
    <img id="zoom" src="http://lorempixel.com/output/people-q-c-1020-797-9.jpg" alt="">
</div> 
```

**JAVASCRPT**

```
<script>

    var zoom        = null;

    // this function will work even if the content has changed
    function move() {

    // get current position
    var currentPosition = zoom.position();
    var currentX        = currentPosition.left;
    var currentY        = currentPosition.top;

    // get container size
    var tempWidth       = zoom.parent().width();
    var tempHeight      = zoom.parent().height();

    // get overflow
    var differenceX     = zoom.width() - tempWidth;
    var differenceY     = zoom.height() - tempHeight;

    // get percentage multiplied by difference (in pixel) cut by percentage (here 1/4) that is used as "smoothness factor"
    var tempX           = zoom.data('x') / tempWidth * differenceX / 4;
    var tempY           = zoom.data('y') / tempHeight * differenceY / 4;

    // get real top and left values to move to and the last factor slows it down and gives the smoothness (and it's corresponding with the calculation before)
    var left            = (tempX - currentX) / 1.25;
    var top             = (tempY - currentY) / 1.25;

    // finally apply the new values
    zoom.css('left', -left).css('top', -top);   

}

$(document).ready(function () {

    zoom    = $('#zoom');

    //handle mousemove to zoom layer - this also works if it is not located at the top left of the page
    zoom.mousemove( function(event) {
        var parentOffset    = $(this).parent().offset(); 
        zoom.data('x', event.pageX - parentOffset.left);
        zoom.data('y', event.pageY - parentOffset.top);
    });

    // start the action only if user is over the container
    zoom.hover(
        function() {
            zoom.data('running', setInterval( function() { move(); }, 30) );
        },
        function() {
            clearInterval(zoom.data('running'));
        }
    );

});

</script> 
```

注意：这个当然不支持触摸设备。但为此我（再次）使用/我可以推荐好的旧 iScroll ... :)

# excel - Excel没有在表格中保留格式

> ID：11103792
> 
> 赞同：0
> 
> 时间：2012-06-19T15:01:45.097
> 
> 标签：excel, colors, formatting

我目前有下表![在此处输入图像描述](../Images/b8f302928d341fd180b0582a7053ef70.png)

当我尝试在顶部添加一行时，我单击第 4 行，然后单击插入。这给了我以下屏幕截图![在此处输入图像描述](../Images/268804d0705394b74c1ffd8b203f05ca.png)

如您所见，除了第一个单元格外，所有颜色和格式都保留了。虽然看起来我已经选择了它，但它实际上是默认的浅色（或稍暗的浅色）蓝色。我什至可以选择“格式与上述相同”，但这仍然会发生。我该如何解决这个问题？

我还应该声明，没有为条件格式设置规则

# performance - 性能调优小T-SQL IF ELSE STATEment，运行上千次

> ID：11103795
> 
> 赞同：0
> 
> 时间：2012-06-19T15:02:03.067
> 
> 标签：performance, tsql, if-statement

我试图从这个查询中挤出一些性能，任何帮助将不胜感激，我唯一能做的就是在第二条语句中删除顺序，因为它是按主键排序的

```
--SET STATISTICS TIME ON

DECLARE             
        @MasterAdGroupId Int = 3469476,
        @IncludeDeleted Bit = 1,
        @Deleted Bit = 0,
        @IncludeDirty Bit= 0,
        @Dirty Bit =1,
        @IncludeDupes Bit=0,
        @OrderByText Bit= 1,
        @UseInDisplayNetworkOnly Bit=0

BEGIN

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED 
IF @OrderByText=1 
BEGIN
    SELECT MasterKeywordId, Text, URL, MasterAdGroupId, mk.KeywordTemplateId, Dirty, mk.Deleted, Negative, Duplicate  
      FROM admanMasterKeyword_tbl mk
INNER JOIN admanKeywordTemplate_tbl kt on kt.KeywordTemplateId = mk.KeywordTemplateId
     WHERE MasterAdGroupId = @MasterAdGroupId 
       AND mk.Deleted = CASE WHEN @IncludeDeleted=0 THEN @Deleted ELSE mk.Deleted END
       AND Dirty = CASE WHEN @IncludeDirty=0 THEN @Dirty ELSE Dirty END
       AND Duplicate = CASE WHEN @IncludeDupes=1 THEN Duplicate ELSE 0 END
       AND UseInDisplayNetwork = CASE WHEN @UseInDisplayNetworkOnly=1 THEN 1 ELSE UseInDisplayNetwork END
  ORDER BY Text 
END
ELSE
BEGIN
    SELECT MasterKeywordId, Text, URL, MasterAdGroupId, mk.KeywordTemplateId, Dirty, mk.Deleted, Negative, Duplicate  
      FROM admanMasterKeyword_tbl mk
INNER JOIN admanKeywordTemplate_tbl kt on kt.KeywordTemplateId = mk.KeywordTemplateId
     WHERE MasterAdGroupId = @MasterAdGroupId 
       AND mk.Deleted = CASE WHEN @IncludeDeleted=0 THEN @Deleted ELSE mk.Deleted END
       AND Dirty = CASE WHEN @IncludeDirty=0 THEN @Dirty ELSE Dirty END
       AND Duplicate = CASE WHEN @IncludeDupes=1 THEN Duplicate ELSE 0 END
       AND UseInDisplayNetwork = CASE WHEN @UseInDisplayNetworkOnly=1 THEN 1 ELSE UseInDisplayNetwork END
  ORDER BY MasterKeywordId 
END

END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:09:46.810

这不会改变任何性能，但是如果您在两个查询中更改的只是它们的排序方式（我看不出任何差异），您可以在 ORDER BY 中放置一个 CASE 语句而不是必须重复自己或根本做一个 IF 语句：

```
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED 

    SELECT MasterKeywordId, Text, URL, MasterAdGroupId, mk.KeywordTemplateId, Dirty, mk.Deleted, Negative, Duplicate  
      FROM admanMasterKeyword_tbl mk
INNER JOIN admanKeywordTemplate_tbl kt on kt.KeywordTemplateId = mk.KeywordTemplateId
     WHERE MasterAdGroupId = @MasterAdGroupId 
       AND mk.Deleted = CASE WHEN @IncludeDeleted=0 THEN @Deleted ELSE mk.Deleted END
       AND Dirty = CASE WHEN @IncludeDirty=0 THEN @Dirty ELSE Dirty END
       AND Duplicate = CASE WHEN @IncludeDupes=1 THEN Duplicate ELSE 0 END
       AND UseInDisplayNetwork = CASE WHEN @UseInDisplayNetworkOnly=1 THEN 1 ELSE UseInDisplayNetwork END
  ORDER BY (CASE WHEN @OrderByText = 1 THEN Text ELSE MasterKeywordId END) 
```

此查询的查询计划是什么样的？你可以在哪里创建索引？

# java - 如何使用 Java Spring Framework 搜索字符串 LIKE 'something%'？

> ID：11103797
> 
> 赞同：22
> 
> 时间：2012-06-19T15:02:05.330
> 
> 标签：java, spring, jdbctemplate, spring-jdbc

我有一个带有 Foos 的 MySQL 表。每个 Foo 都有一个数字非唯一代码和一个名称。现在我需要查找是否有任何具有某些代码之一的 Foo 恰好具有以给定字符串开头的名称。在普通 SQL 中，这将是微不足道的：

```
select * from FOO where CODE in (2,3,5) and NAME like 'bar%'; 
```

但是我现在如何在春天正确地做到这一点？不需要“喜欢”运算符，我会这样做：

```
public List<Foo> getByName(List<Integer> codes, String namePart) {
    String sql = "select * from FOO where CODE in (:codes) and NAME=:name"
    Map<String,Object> params = new HashMap<String,Object>();
    params.put("codes", codes);
    params.put("name", namePart);
    return getSimpleJdbcTemplate().query(sql, new FooRowMapper(), params);
} 
```

但是，使用 'like' 似乎没有任何效果：`NAME like :name%`,`NAME like ':name%'`或`NAME like ?%`使用占位符而不是命名参数时。

我可能会很残酷并以

```
String sql = "select * from FOO where CODE in (:codes) and NAME like '"+namePart+"%'";` 
```

但显然，如果 Spring 能够正确清理输入参数等，那就太好了，你知道......

你会认为 Spring 会以某种方式支持这一点，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-19T15:08:37.450

等等，当然我必须“再尝试最后一件事”才能结束一天，你瞧，我所有的单元测试突然通过了：

```
public List<Foo> getByName(List<Integer> codes, String namePart) {
    String sql = "select * from FOO where CODE in (:codes) and NAME like :name"
    Map<String,Object> params = new HashMap<String,Object>();
    params.put("codes", codes);
    params.put("name", namePart+"%");
    return getSimpleJdbcTemplate().query(sql, new FooRowMapper(), params);
} 
```

我没有想到在参数中输入“%”，我确信 Spring 会自动转义它。我想知道我做得对吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T15:09:04.467

要使命名参数起作用，您需要使用[NamedParameterJdbcTemplate](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/namedparam/NamedParameterJdbcTemplate.html)

```
params.put("name", "Joe%");

jdbcTemplate.query("select * from FOO where CODE in (:codes) and NAME like :name" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-04-26T14:13:18.517

在另一种形式中，我遇到了同样的问题，我尝试通过这种方式解决它：

```
public List<MyEntity> getMyEntityValuesBySearchText(String searchText) {

    String query = "SELECT * FROM MY_ENTITY_TABLE WHERE NAME LIKE ?";
    return this.getJdbcTemplate().query(query, new String[] { "%" + searchText + "%" },
                (rs, rowNum) -> new MyEntity(rs.getLong("PK"), rs.getString("NAME")));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-03T05:45:28.633

上面的代码有问题。代码结构正确，但映射变量有问题。您将收到错误消息“索引超出范围”SQL 异常错误。

为了避免这个错误，我们使用“MySqlParameterSource”类正确映射我们的变量。我们需要为该类创建一个对象并将我们的变量传递到内部以映射变量。

以此为例。

```
 public List<Products> getParticular2(@RequestParam String charc){

        String sql ="select * from products where name like :name";

        Map<String, Object> params = new HashMap<String, Object>();
                params.put("name", charc+"%");

        MapSqlParameterSource param = new MapSqlParameterSource(params);

        List <Products> list = template.query(sql, param, new 
                                BeanPropertyRowMapper<>(Products.class));
        return list;
    } 
```

# android - 在墙上贴上一个朋友标签 android

> ID：11103799
> 
> 赞同：1
> 
> 时间：2012-06-19T15:02:08.590
> 
> 标签：android, facebook-graph-api, facebook-android-sdk

我想向 facebook 发送一个墙帖并通过 graph api 标记我的一个朋友。我有我朋友的 Facebook ID。我应该在哪里写他/她的 ID 以便能够在我的墙贴中标记他/她？

```
params.putString("access_token", facebook.getAccessToken());
params.putString("Message","I m here");

String response = facebook.request("me/feed", params, "POST"); 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T13:24:56.637

1) 创建好友 ID 的字符串数组并将其传递给 .request() 方法

```
for(int j=0;j<numArr.length;j++)
{
   Utility.mAsyncRunner.request("Photo_id/tags/"+numArr[j], param, "POST", new SampleUploadListener(), null); 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-20T14:08:29.920

在您的代码中，只需添加：

```
params.putString("place", "155021662189"); 
```

如果您不知道任何 FB placeId，请使用“155021662189”。在我的应用程序中，这有效。

参考：[http ://codenigeria.com/discussion/245/facebook-api-how-to-make-status-update-on-facebook-but-also-tag-some-facebook-friends-in-it-/p1](http://codenigeria.com/discussion/245/facebook-api-how-to-make-status-update-on-facebook-but-also-tag-some-facebook-friends-in-it-/p1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T15:00:13.047

## 此帖子中标记的人员的 Facebook ID 的逗号分隔列表。例如：1207059,701732。该字段在读取 Post 时作为 with_tags 字段返回。

## 注意：您不能在不指定地点的情况下指定此字段。

地点在哪里：- 与此帖子关联的位置的 Facebook 页面 ID

## 检查这个： -

[https://developers.facebook.com/docs/reference/api/user/#posts](https://developers.facebook.com/docs/reference/api/user/#posts)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T15:05:24.263

看看图形 api：http: [//developers.facebook.com/docs/reference/api/post/](http://developers.facebook.com/docs/reference/api/post/)

message_tags 可用于标记任何内容

# java - 接口如何执行操作

> ID：11103801
> 
> 赞同：1
> 
> 时间：2012-06-19T15:02:11.233
> 
> 标签：java, interface, observer-pattern

现在我遇到了观察者/观察者模式，我让观察者通知我所有的观察者。Observer 都实现了 Observer 接口，而 Observable 扩展了 Observable。我想我正在尝试填补我在接口方面的知识空白。我理解抽象类的意义以及它们是如何工作的，但是接口一直很棘手。对于接口，我知道它们充当模板，如果您实现一个模板，那么您需要从接口添加所有方法。我认为这纯粹是为了在您的项目中提供组织帮助。

但是，对于这种 Observer/Observable 案例，我不明白在实现 Observer 的对象中如何调用 update() 函数。与 Observable 的唯一链接是您必须调用 addObserver() 来添加 Observer，然后将其存储在一个列表中，并添加其他 Observer。但在那之后，如何在每个 Observer 上调用 update() 呢？一旦我调用 setChanged() 然后 notifyObservers()，Observable 是否只是通过观察者列表并调用observer.update() 吗？这是有道理的，但实现比我想象的要隐藏得多。

我把它放在观察者模式的上下文中，但它确实适用于任何事情。我注意到几乎所有基于事件的事物都使用接口。这是因为可以保证 Object 将具有随后调用的函数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:04:50.007

> 我理解抽象类的意义以及它们是如何工作的

那么你就理解了接口的 95%。接口与抽象类几乎相同，只是接口不能包含*任何*具体的方法实现。

> 这是因为可以保证 Object 将具有随后调用的函数吗？

是的，这是完全正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T15:08:58.987

是的。一个接口定义了一个契约。所有实现接口的类都必须遵守这个约定。当你想观察一个 Observable 时，你需要做的就是遵守 Observer 的约定：实现 Observer 接口，从而拥有一个可以被 Observable 调用的更新方法。

Observer 的具体类型与 Observable 无关。使用接口非常方便，因为它允许任何类型的对象观察 Observable，只要它实现了 Observer 接口。你不需要有任何特定的具体类型，也不需要扩展任何特定的类来观察 Observable。

# c# - 客户端 Winforms 应用程序中的 Signalr 集线器连接管理

> ID：11103804
> 
> 赞同：1
> 
> 时间：2012-06-19T15:02:18.887
> 
> 标签：c#, winforms, .net-4.0, signalr

我正在寻找有关如何最好地在充当客户端的 winforms 应用程序中处理 Signalr 集线器连接的建议。

我有一个 Web 应用程序作为 Signalr (v0.5.1) 服务器和一个使用集线器的客户端 winforms 应用程序。一切都按预期工作，我只是觉得我与服务器的 Signalr 连接太多。对于每个表单，我都创建了一个新`HubConnection`实例，因为[集线器需要在连接启动之前订阅事件](https://github.com/SignalR/SignalR/wiki/SignalR-Client-Hubs)。每个表单使用一个或两个集线器，并非所有表单都订阅服务器事件，有些只是调用服务器端方法。

我可以拥有一个（静态）`HubConnection`（例如程序的属性）并将其用于所有形式吗？这种策略意味着启动/停止/状态管理的麻烦，因为每个表单可能订阅不同的事件。

在 .Net 客户端中管理 Signalr 连接（和集线器）的最佳策略是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T09:58:03.530

是的，您的整个应用程序只需要一个连接。您如何选择存储取决于您（静态与 DI 等）。

# javascript - 如何测试使用 Jasmine 加载谷歌地图的脚本

> ID：11103805
> 
> 赞同：1
> 
> 时间：2012-06-19T15:02:22.067
> 
> 标签：javascript, unit-testing, requirejs, jasmine

我在为加载谷歌地图的页面编写测试时遇到困难。我总是收到错误

> “无法读取未定义的属性‘offsetWidth’”

这意味着当地图脚本加载我用来保存地图的 div 时，可能已经被删除（我在 div 的样式属性中将宽度和高度设置为 100% 确保它具有宽度和高度） .

我正在以一种涉及 requirejs 的非常复杂的方式加载我的 gmaps 脚本，但我认为问题与此无关（即使我在运行 specRunner 时从 requirejs 收到错误，但一切正常）。

我应该如何测试这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:22:33.447

我用过`waitFor()`，效果很好。

```
describe( "Test suite for the 'Event location' Box", function() {
    it( "Should show the map when the appropriate checkbok is clicked and should hide it when clicked again", function() {
        // Wait for the loading of the gmaps. This is simply when the <div> we use as a container has some html
        waitsFor(function() {
            return $('#ai1ec_map_canvas').html() !== '';
        }, "gmaps never loaded", 15000 );
        runs( function() {
            $( "#ai1ec_google_map" ).click();
            expect( $( '#ai1ec_map_canvas' ) ).toBeVisible();
            $( "#ai1ec_google_map" ).click();
            expect( $( '#ai1ec_map_canvas' ) ).not.toBeVisible();
        } );
    } );
} ); 
```

# javascript - Coffeescript 观察 src 目录编译

> ID：11103809
> 
> 赞同：10
> 
> 时间：2012-06-19T15:02:30.210
> 
> 标签：javascript, coffeescript

我正在这样做——

`$ coffee -c assets/js`

将所有 .coffee 文件编译为该目录中的 .js 文件。但我不明白如何观看目录？

我试试这个但得到错误 -

```
$ coffee -wc assets/js

/usr/lib/node_modules/coffee-script/lib/coffee-script/command.js:287
      if (e.code !== 'ENOENT') throw e;
                                     ^
Error: watch EMFILE
    at errnoException (fs.js:648:11)
    at FSWatcher.start (fs.js:676:11)
    at Object.watch (fs.js:704:11)
    at /usr/lib/node_modules/coffee-script/lib/coffee-script/command.js:256:27
    at Object.oncomplete (/usr/lib/node_modules/coffee-script/lib/coffee-script/command.js:85:25) 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-19T15:06:21.100

在我的一个蛋糕文件中，我这样做：

```
"coffee -o javascript/ -cw coffeescript/" 
```

我所有的 .coffee 文件都在 coffeescript 文件夹中，这会将它们编译到 javascript 文件夹中的相同层次结构中，并观看它们。

它来自[文档](http://coffeescript.org/)。希望能帮助到你。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-05-11T12:06:32.473

使用 CoffeeScript 1.7.1 测试

在命令行中：

```
coffee -wc DIR 
```

*   w = 观看
*   c = 编译

# c++ - 独立读取多个文件

> ID：11103810
> 
> 赞同：1
> 
> 时间：2012-06-19T15:02:43.597
> 
> 标签：c++, root-framework

我有一个用于数据分析软件 Root (CERN) 的相当大的代码，并且我有一系列数据，我想查看这些数据是否存在不良运行。我将它们全部放在一个目录中，但是想编写一段代码以一次从该文件夹中取出一个文件，运行代码，输出结果图，然后取出下一个文件..等等。我正在使用宏来像现在一样运行此代码。我希望只是为那个宏添加一些东西。我对编程有点陌生。

```
gSystem->Load("AlgoCompSelector_C.so");
// make the chains
std::string filekey;
TChain tree1 = new TChain("tree");
filekey = std::string("data/run715604.EEmcTree_Part1.root");
tree1->Add( filekey.data() ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:30:10.500

要在单个根宏中执行此操作，您可以尝试以下代码片段。在这里，我将文件添加到 TChain，但您当然可以`TChain::Add`用您想要的任何内容替换。

```
int addfiles(TChain *ch, const char *dirname=".", const char *ext=".root")
{
   int added = 0;
   TSystemDirectory dir(dirname, dirname);
   TList *files = dir.GetListOfFiles();
   if (files) {
      TSystemFile *file;
      TString fname;
      TIter next(files);
      while ((file=(TSystemFile*)next())) {
         fname = file->GetName();
         if (!file->IsDirectory() && fname.EndsWith(ext)) {
         ch->Add(fname); // or call your function on this one file
         ++added;
         }
     }
   }
   return added;
} 
```

（改编自这篇root-talk帖子：[http](http://root.cern.ch/phpBB3/viewtopic.php?f=3&t=13666) ://root.cern.ch/phpBB3/viewtopic.php?f=3&t=13666 ）

话虽如此，我认为@m0skit0 每次启动一个较小的脚本的建议比执行您上面建议的操作更好。Root 是挑剔的，拥有较小的工作更好。

# sql - 如何将持久列格式化为填充整数字符串 [SQL Server 2008]

> ID：11103821
> 
> 赞同：-2
> 
> 时间：2012-06-19T15:03:11.230
> 
> 标签：sql, sql-server-2008, formula, persisted-column

我将在持久列中使用什么公式，以便可以将下面的两列添加在一起，第一列必须填充为 5 个字符：

*   身份证 (INT)
*   引用编号（字符串）

我去了`format(ID,"00000") & RefNum`，但它不起作用，请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:06:48.040

你可以使用这样的东西：

```
ALTER TABLE dbo.YourTable
ADD FormattedColumn AS RIGHT('00000' + CAST(ID AS VARCHAR(5)), 5) + RefNum PERSISTED 
```

基本上，将 转换`ID`为 a `VARCHAR(5)`，在它前面加上`00000`，然后抓住最右边的五个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:06:52.003

```
SELECT RIGHT('00000' + CAST(ID AS VARCHAR(5)), 5) + RefNum 
```

# vba - Excel VBA - 两个值之间的总和

> ID：11103822
> 
> 赞同：3
> 
> 时间：2012-06-19T15:03:12.770
> 
> 标签：vba, excel

我有一份报告，我试图获取动态行数的总和以生成小计。

```
If Cells(s, 1).Value = "start" Then
   If Cells(r, 1).Value = "subtotal" Then
    'Set the Monthly Subtotal Formulas
     Cells(r, 44) = "=SUM(AR" & Trim(Str(s)) & ":AR" & Trim(Str(r - 1)) & ")"
     Cells(r, 46) = "=SUM(AT" & Trim(Str(s)) & ":AT" & Trim(Str(r - 1)) & ")"
    'Set the Weekly Subtotal Formulas
     Cells(r, 48) = "=SUM(AV" & Trim(Str(s)) & ":AV" & Trim(Str(r - 1)) & ")"
     Cells(r, 52) = "=SUM(AZ" & Trim(Str(s)) & ":AZ" & Trim(Str(r - 1)) & ")"
     'Set the Daily Subtotal Formulas
     Cells(r, 54) = "=SUM(BB" & Trim(Str(s)) & ":BB" & Trim(Str(r - 1)) & ")"
     Cells(r, 56) = "=SUM(BD" & Trim(Str(s)) & ":BD" & Trim(Str(r - 1)) & ")"
     'Set the Hourly Formulas
     Cells(r, 60) = "=SUM(BH" & Trim(Str(s)) & ":BH" & Trim(Str(r - 1)) & ")"
     Cells(r, 62) = "=SUM(BJ" & Trim(Str(s)) & ":BJ" & Trim(Str(r - 1)) & ")"
     Cells(r, 1) = ""
    End If
    Cells(s, 1) = ""
End If 
```

基本上，每个工作组都在单元格值“开始”和“小计”内。如何找到“s”或行号并在公式中使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:18:05.757

大多数时候，**[Excel 的内置小计功能](http://office.microsoft.com/en-us/excel-help/insert-subtotals-HP005200946.aspx)**就足够了

* * *

如果您确实需要使用 VBA 解决方案并且不知道如何遍历数据中已经存在的所有“小计”标签，请将您的代码放在这样的循环中：

```
header_column = Intersect(ActiveSheet.Range("A:A"), ActiveSheet.UsedRange).Value2
s = 1
For r = 1 To UBound(header_column)
    If header_column(r, 1) = "start" Then
        s = r
    End If
    If header_column(r, 1) = "subtotal" Then
        ' ... do your stuff here ... '
        ' s = r ' if the next "start" tag always follows a subtotal tag, no need for the "start" tags at all, just uncomment this line just before End If
    End If
Next 
```

PS：不需要`"string" & Trim(Str(integer))`，`"string" & integer`改用

# c# - 如何在允许写访问的同时返回具有可变属性的 ReadOnly 对象类

> ID：11103823
> 
> 赞同：0
> 
> 时间：2012-06-19T15:03:13.613
> 
> 标签：c#, class, readonly

我有很多类，它们都有标准的 set 和 get 方法。我的问题是这些设置方法中的许多不应*从*包含对象的类外部调用。我不太确定是否有任何模式或 C# 缺少更好的词 - 可以使这更容易的操作。

参考下面的代码，有许多类似于 SecureSite 的类，控制器应该能够调用函数或访问变量来修改 SecureSite（以及其他类似的类）。但是，当用户要求查看 SecureSite 等时，他们应该无法更改此设置。

根据我有限的知识和我在本网站上看到的类似问题的答案，主要问题似乎是由于变量，Write_SecureSite 不能完全不可`List<String> AccessHistory`变。所以，我想出的东西看起来像斗牛犬的背面一样丑陋，而且同样凌乱。本质上，有一个 SecureSite 类的写入版本，其中包含一个类，它返回 SecureSite 类的只读版本。

那么，我是否错过了 C# 中的一些魔法，这会使这一切变得如此简单？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ReadOnlyExample {

    public class Write_SecureSite {

        private List<String> mAccessHistory;
        public List<String> AccessHistory {
            get {
                return mAccessHistory;
            }
        }
        public SecureSite ReadOnly {
            get {
                return new SecureSite(this);
            }
        }

        public class SecureSite {
            public SecureSite(Write_SecureSite aParent) {
                AccessHistory=aParent.AccessHistory;
            }
            public IEnumerable<String> AccessHistory;
        }

    }

    public static class Controller {

        private static Write_SecureSite SimpleSecureSite=new Write_SecureSite();

        public static Write_SecureSite.SecureSite Login(String MyLogin) {
            SimpleSecureSite.AccessHistory.Add(MyLogin);
            return SimpleSecureSite.ReadOnly;
        }

        public static Write_SecureSite.SecureSite Details() {
            return SimpleSecureSite.ReadOnly;
        }

    }

    public static class User {

        public static void Miscellaneous() {
            Controller.Login("Me");
            Write_SecureSite.SecureSite SecureSite=Controller.Details();

            //Not going to happen.
            SecureSite.AccessHistory.Add("Me2");

            //No problem.
            foreach(String AccessedBy in SecureSite.AccessHistory) {
                Console.Out.WriteLine("Accessed By: "+AccessedBy);
            }

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:23:26.597

我建议使用接口：

```
public interface IReadSecureSite
{
  IEnumerable<String> AccessHistory { get; }
}

class Write_SecureSite : IReadSecureSite
{
    public IList<String> AccessHistoryList { get; private set; }

    public Write_SecureSite()
    {
        AccessHistoryList = new List<string>();
    }

    public IEnumerable<String> AccessHistory {
        get {
            return AccessHistoryList;
        }
    }
 }

 public class Controller
 {
    private Write_SecureSite sec= new Write_SecureSite();

    public IReadSecureSite Login(string user)
    {
       return sec;
     }

 }

 ...
 Controller ctrl = new Controller();
 IReadSecureSite read = ctrl.Login("me");
 foreach(string user in read.AccessHistory)
 {
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:11:24.480

这与其说是一个答案，不如说是一个研究方向。我也在不可变类中苦苦挣扎

到目前为止，我正在使用我的构造函数来设置我的只读私有变量，我正在使用方法在内部更新我的列表，而不是将它们公开为公共属性：即。使用公共无效添加（字符串 itemToAdd）

我正在阅读 Petricek 和 Skeet 的一本书，名为“ [Real World Functional Programming](http://www.manning.com/petricek/) ”，它帮助我朝着您讨论的方向前进

这是同一作者的一个小教程，介绍了一些基本概念：http: [//msdn.microsoft.com/en-us/library/hh297108.aspx](http://msdn.microsoft.com/en-us/library/hh297108.aspx)

希望这个对你有帮助

更新：我可能应该更清楚：我希望为您指明一个更实用的视图的方向，而不是重写您在问题中列出的课程 - 我很抱歉（已删除示例）

# c# - 带有 Framework 2.0 的 Visual Studio 2010 命令行

> ID：11103824
> 
> 赞同：3
> 
> 时间：2012-06-19T15:03:16.513
> 
> 标签：c#, visual-studio-2010, visual-studio-2008, frameworks, command-prompt

之前，我使用的是 VS 2008 命令提示符，当我这样做时

```
clrver 
```

我有

```
Versions installed on the machine:
v1.1.4322
v2.0.50727 
```

现在使用 Visual Studio 2010 命令提示符，我得到：

```
Versions installed on the machine:
v1.1.4322
v2.0.50727
v4.0.30319 
```

我想知道是否有办法使用 VS 2010 命令行使用 Framework 2.0 而不是 4.0 编译我的 C# 代码

- 编辑 -

除了进入项目的属性之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:25:25.397

使用[MSBuild 命令行](http://msdn.microsoft.com/en-us/library/ms164311.aspx)并传递`ToolsVersion`(2.0,3.0,3.5,4.0) 和`TargetFrameworkVersion`(v2.0,v3.0,v3.5,v4.0) 属性：

```
msbuild your.sln /p:TargetFrameworkVersion=v2.0;ToolsVersion=3.5 
```

UI 选项在[此处](http://msdn.microsoft.com/en-us/library/bb398202.aspx)描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:06:10.300

您可以在项目设置中更改目标框架。

[http://msdn.microsoft.com/en-us/library/bb398202.aspx](http://msdn.microsoft.com/en-us/library/bb398202.aspx)

（我的工作机器上还没有 VS 2010，所以我无法测试是否支持扩展到 .NET 2.0，尽管我相信它确实如此）

# c# - XNA 3.1 特定精灵的自定义着色器

> ID：11103826
> 
> 赞同：1
> 
> 时间：2012-06-19T15:03:30.397
> 
> 标签：c#, xna, 2d, sprite, shader

我现在正在尝试几个小时来解决这个问题..

所以.. 我想在屏幕上绘制的每个 Sprite 上使用不同的着色器。我尝试制作不同的 RenderTarget2D，但没有成功。

无论我如何努力使 Graphicsdevice.Clear() 透明，它都无法正常工作。（我使用 xna 3.1）

所以我所有的精灵都挡住了其他精灵，因为我不能让背景透明：\

## 任何的想法 ？

我使用的代码（这是一种方法）：

```
 graphicsDevice.SetRenderTarget(0, r2d);
    graphicsDevice.Clear(ClearColor);
    spriteBatch.Begin();

    spriteBatch.Draw(
                tex,
               Dest,
               Source,
               moodcolor,
               this.RotationAngle,
               new Vector2(0, 0),
               Zoom,
               spriteEffect,
               this.Z_Index);

    spriteBatch.End();

    graphicsDevice.SetRenderTarget(0, null);
    graphicsDevice.Clear(ClearColor);

    for (int i = 0; i < efs.Count; i++)
    {
        efs[i].effect.CurrentTechnique = efs[i].effect.Techniques["Deferred"];

        foreach (EffectPass pass in efs[i].effect.CurrentTechnique.Passes)
        {

            spriteBatch.Begin(SpriteBlendMode.None, SpriteSortMode.Immediate, SaveStateMode.None);
            efs[i].effect.Begin();
            pass.Begin();
            spriteBatch.Draw(r2d.GetTexture(), Vector2.Zero, Color.White);
            spriteBatch.End();
            pass.End();
            efs[i].effect.End();
        }
   } 
```

更新！您不必使用 RenderTarget2D！保留 AlphaBlend 很重要！这是任何遇到相同问题的人的解决方案！

解决方案片段：

```
foreach (EffectPass pass in efs[ObjShaders[i].ShaderID].effect.CurrentTechnique.Passes)
                    {

                        spriteBatch.Begin(SpriteBlendMode.AlphaBlend, SpriteSortMode.Immediate, SaveStateMode.None);
                        efs[ObjShaders[i].ShaderID].effect.Begin();
                        pass.Begin();

                        spriteBatch.Draw(
                         tex,
                        Dest,
                        Source,
                        moodcolor,
                        this.RotationAngle,
                        new Vector2(0, 0),
                        Zoom,
                        spriteEffect,
                        this.Z_Index);

                        spriteBatch.End();
                        pass.End();
                        efs[ObjShaders[i].ShaderID].effect.End();
                    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T16:22:13.597

再次阅读您的问题，也许您需要做的就是

```
 spriteBatch.Begin(SpriteSortMode.BackToFront, BlendState.AlphaBlend); 
```

现在，如果您的精灵纹理具有 Alpha 通道，它们将被正确混合。

# xcode - 在 XCODE 上的 WWW 文件夹电话间隙中添加新文件和文件夹

> ID：11103831
> 
> 赞同：0
> 
> 时间：2012-06-19T15:03:37.280
> 
> 标签：xcode, cordova

我在 XCODE 上创建了一个新的 cordova 项目，我通过在 finder 中打开 www 然后将文件复制到其中，将一些文件复制到“www”文件夹中。这些文件现在在 www 文件夹中，但它们没有出现在 XCODE 上，那么，你知道我怎样才能让它们出现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:10:53.420

将 www 文件夹拖放到 Xcode 中的项目中，然后从弹出窗口中选择“为任何添加的文件夹创建文件夹引用”，然后单击“完成”。

# magento - 如何在magento中删除std div

> ID：11103834
> 
> 赞同：3
> 
> 时间：2012-06-19T15:03:45.740
> 
> 标签：magento

我试图从我的 magento 主页中删除“std div”，但找不到相同的任何建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T19:13:19.987

您要查找的 div 是通过 cms.xml 布局文件添加的 page/html_wrapper 块。

以下是摘自 app/design/frontend/base/default/layout/cms.xml 的摘录：

```
<cms_page translate="label">
        <label>CMS Pages (All)</label>
        <reference name="content">
            <block type="core/template" name="page_content_heading" template="cms/content_heading.phtml"/>
            <block type="page/html_wrapper" name="cms.wrapper" translate="label">
                <label>CMS Content Wrapper</label>
                <action method="setElementClass"><value>std</value></action>
                <block type="cms/page" name="cms_page"/>
            </block>
        </reference>
    </cms_page> 
```

因此，根据您开发主题的方式，有几种方法可以**删除 div 。**

如果您使用 local.xml，第一个选项将适用：

```
 <cms_page>
        <reference name="content">
            <action method="unsetChild">
                <alias>cms.wrapper</alias>
            </action>
            <block type="cms/page" name="cms_page"/>
        </reference>
    </cms_page> 
```

如果您将基本布局文件复制到以下位置，则第二个选项将适用：

复制 cms.xml from `app/design/frontend/base/default/layout/cms.xml`to`app/design/frontend/your_package/your_theme/layout/cms.xml`并将上面的第一个布局片段编辑为以下内容：

```
 <cms_page translate="label">
        <label>CMS Pages (All)</label>
        <reference name="content">
            <block type="core/template" name="page_content_heading" template="cms/content_heading.phtml" />
            <block type="cms/page" name="cms_page" />
        </reference>
    </cms_page> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-04T12:34:02.737

此代码帮助我从单个 cms 页面中删除“std”div，将其放入“Layout Update XML”部分：

```
<reference name="content">
<action method="unsetChild">
<alias>cms.wrapper</alias>
</action>
<block type="cms/page" name="cms_page"/>
</reference> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T01:58:23.173

**编辑：** 德鲁问了一个问题，这让我意识到你的问题是如何删除 div（不仅仅是删除 div 的类）。理想情况下，它就像布局 XML 中的任何其他“移动”操作一样，这意味着取消设置父子关系（在本例中为`cms.wrapper`and之间的关系`cms_page`）并将子关系设置为另一个块 ( `content`)：

```
<?xml version="1.0"?>
<layout>
     <cms_page>
         <reference name="content">
             <action method="unsetChild">
                <alias>cms.wrapper</alias>
             </action>
             <action method="insert">
                <alias>cms_page</alias>
             </action>
         </reference>
    </cms_page>
</layout> 
```

**我的原始回复如下：**

德鲁在他的回答中有很多很好的信息。我只想指出块 API 有一些细微差别可以使布局 XML 非常干净。

在您的 local.xml 中：

```
<?xml version="1.0"?>
<layout>
     <cms_page translate="label">
        <reference name="cms.wrapper">
            <action method="unsetElementClass" />
        </reference>
    </cms_page>
</layout> 
```

参考`Mage_Page_Block_Html_Wrapper->_toHtml()`和`Varien_Object->__call()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-27T10:42:35.573

这是您要找到的解决方案:)

将此 xml 代码放入 Page -> Design -> Layout Update XML

```
<block type="page/html_wrapper" name="cms.wrapper" translate="label"> 
<label>CMS Content Wrapper</label> 
<action method="setElementClass"><value>your_class_name</value></action> 
<block type="cms/page" name="cms_page"/> 
</block> 
```

干杯!

萨兰

# c++ - TeamCity CppUnit 插件打印额外的 '\n'

> ID：11103840
> 
> 赞同：0
> 
> 时间：2012-06-19T15:04:06.733
> 
> 标签：c++, tfs, continuous-integration, teamcity, cppunit

我已经使用[他们的插件](http://confluence.jetbrains.net/display/TW/Cpp+Unit+Test+Reporting)将 TeamCity 与 Cppunit 集成在一起。

我试图摆脱`'\n'`每次测试后附加的内容。我尝试`details.append("\n");`从 teamcity_cppunit.cpp 中注释掉，但这并没有成功。而且我没有找到其他任何`'\n'`被附加的地方。

基本上我想得到这个：

```
16>  Description: Executing Unit Tests...
16>  Running 4 test cases...
16>  CoreTechUnitTests::CLogExtractorTestCase::CreateLogExtractorTest... [0.2503s]
16>  CoreTechUnitTests::CLogExtractorTestCase::CreateOutputFolderTest... [0.0057s]
16>  CoreTechUnitTests::CLogExtractorTestCase::WriteLogFileTest... [0.0050s]
16>  CoreTechUnitTests::CLogExtractorTestCase::LastRunUnitTest... [0.0001s]
16>  Total test execution took 0.2612s
16>  
16>  OK (4) 
```

与此相反：

```
9>  CoreTechUnitTests::CMcMd5TestCase::MD5Test...CoreTechUnitTests::CMcMd5TestCase::MD5Test [0.0001s] : OK
9>  
9>  CoreTechUnitTests::CByteBufferTest::TestBuffer...CoreTechUnitTests::CByteBufferTest::TestBuffer [0.0003s] : OK
9>  
9>  CoreTechUnitTests::CETWLogConsumerTestCase::CreateETWReaderTests...CoreTechUnitTests::CETWLogConsumerTestCase::CreateETWReaderTests [0.0106s] : OK
9>  
9>  CoreTechUnitTests::CETWLogConsumerTestCase::ExtractEventSystemTimeTests...CoreTechUnitTests::CETWLogConsumerTestCase::ExtractEventSystemTimeTests [0.0001s] : OK 
```

我想知道是否有人知道将`'\n'`其附加在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T19:29:27.633

看起来在第 71 行的 teamcity_messages.cpp 中的输出流中写入了一个 endl：

```
*m_out << endl; 
```

另一个值得一看的地方是 teamcity_boost.cpp 的第 153 行：

```
out << endl; 
```

看看删除其中一个是否有用。

# node.js - NodeJS + MongoDB + Redis：注册和登录 - 会话问题

> ID：11103842
> 
> 赞同：2
> 
> 时间：2012-06-19T15:04:10.997
> 
> 标签：node.js, session, mongodb, login, redis

我在生产服务器上的代码有一个相当奇怪的问题。在我的 MacOS 上它运行良好，但是当我部署我的应用程序时，我无法登录。调试后，我发现我无法从 req-object 加载会话。这是所有主要部分的代码（设置，登录页面和登录后的主页）

```
//SETTINGS
var express = require('express');
var app = express.createServer();
var mongo = require('mongodb'),
    Server = mongo.Server,
    Db = mongo.Db,
    ObjectID = require('mongodb').ObjectID;
var BSON = require('mongodb').BSONPure;

var RedisStore = require('connect-redis')(express);

//connecting to mongo
var server = new Server('localhost', 27017, {
    auto_reconnect: true
});
var db = new Db('metadocs-node_db', server);

//setting express app
app.set('view engine', 'ejs');
app.configure(function () {
    app.use("/static", express.static(__dirname + '/static'));
    app.use(express.bodyParser());
    app.use(express.cookieParser());
    app.use(express.session({
        secret: "meta-meta",
        store: new RedisStore
    }));
    app.use(express.methodOverride());
});

//login page - POST for /login page
app.post('/login', function (req, res) {
    db.collection("users", function (err, collection) {
        collection.findOne({
            username: req.body.username
        }, function (err, doc) {
            if (doc && doc.password == req.body.password) {
                req.session.user_id = doc._id;
                res.redirect('/');
            } else {
                res.render('login.ejs', {
                    success_login: 1
                });
            }
        });
    });
});

//GET INDEX PAGE - only after login
app.get('/', loadUser, function (req, res) {
    db.collection("companies", function (err, collection) {
        collection.count(function (err, count) {
            res.render('index.ejs', {
                total_companies: count,
                current_user: req.currentUser['username']
            });
        });
    });
});

//loadUser() is function that creates/loads user session if possible
function loadUser(req, res, next) {
    if (req.session.user_id) {
        db.collection("users", function (err, collection) {
            collection.findOne({
                _id: new ObjectID(req.session.user_id)
            }, function (err, user) {
                if (user) {
                    req.currentUser = user;
                    next();
                } else {
                    res.redirect('/login');
                }
            });
        });
    } else {
        res.redirect('/login');
    }
} 
```

这是问题代码行：

```
if (req.session.user_id) { 
```

在 loadUser() 函数中。问题是 req.session.user_id 是空的——我在逐步调试每一行时发现了它。我做错了什么？它适用于我的 Mac，但不适用于 Ubuntu。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T23:40:57.497

对于同样的问题，我已经尝试过您在另一篇帖子中提供地址的服务器。Cookie 设置没有任何问题。我登录成功。但是，有一件事引起了我的注意：到期时间。现在是格林威治标准时间 2012 年 6 月 26 日 23:18，您的 cookie 过期时间设置为 2012 年 6 月 27 日 03:18 格林威治标准时间，距离 cookie 过期仅剩 4 小时。

设置 4 小时后过期的 cookie 是完全可以的；除非您的服务器或客户端设置了错误的日期/时间或时区。您能否确保工作/非工作客户端，当然还有您的服务器设置了正确的日期/时间和时区？我相信这可能是你的问题的原因。

在我开发的系统上，我将 cookie 的有效期设置为一年。我在服务器端验证会话而不依赖于 cookie 过期。我不使用 connect 进行 cookie 和会话管理，因为我自己做这些事情总是更自在。但是，您仍然可以在使用 connect 时执行相同的操作。在会话设置中，您应该将 cookie 的 maxAge 设置为更高的值：

下面的代码是从连接文档中复制的。我刚刚在第三行添加了 maxAge 参数，将过期设置为一天。

```
connect().
  .use(connect.cookieParser('keyboard cat'))
  .use(connect.session({ key: 'sid', cookie: { secure: true, maxAge:86400000 }})) 
```

我希望你的问题可以通过这个解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T18:53:28.837

以下是我会尝试的一些事情：

1.  确保您使用的不是 Ubuntu 10.04 或 10.10：

    > Ubuntu 10.04 和 10.10 存在严重的错误（尤其是 10.10），如果不只是实例挂起，则会导致速度变慢。[http://redis.io/topics/problems](http://redis.io/topics/problems)

2.  你在哪里配置你的redis服务器连接？我认为默认情况下它会查看 localhost 但在生产环境中，您通常需要指定主机/端口/身份验证（尽管我不确定您是否拥有生产环境或者您是与第 3 方一起托管，所以这可能不适用。）

3.  尝试将 no_ready_check 标志也设置为 true：

    ```
    client = redis.createClient(port, host, {no_ready_check: true}); 
    client.auth(password, function() { 
        console.log('Redis client connected');
    });
    //then pass client into expressjs like so:
    ...
    store: new RedisStore {client: client} 
    ```

4.  还为“错误”添加一个事件处理程序，并查看 redis 是否报告了任何问题：

    ```
    client.on('error', function (e) {
        console.log(e);
    }); 
    ```

5.  最后，我会将您的环境变量转储到生产环境和您的本地主机开发中，以查看是否存在任何配置差异。有时您在开发中设置这些，然后在您投入生产时忘记它们:)

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T08:46:08.033

我找到的另一个解决方案是：当您使用 Debian 时，请确保您获得不同的 aptitude 源，以便您可以安装最新版本的 Redis。

这个问题让我忙着寻找几个小时......

# ms-access - MS Access 是否有“任务列表”形式？

> ID：11103843
> 
> 赞同：1
> 
> 时间：2012-06-19T15:04:30.390
> 
> 标签：ms-access

MS Access 中是否有等效的 Visual Studio 任务列表？

我希望能够将 TODO 放入我的代码中，然后一目了然地查看我打开的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:43:31.267

玩得开心 ：）

```
Sub ToDoList()
Dim afind As Variant
Dim sfound as String
Dim mdl As Object
Dim modtext As String, modarray As Variant
Dim leline As Long
Dim i, j, k   

afind = Split("HACK,TODO", ",")

For i = 1 To VBE.ActiveVBProject.VBComponents.Count
    Set mdl = VBE.ActiveVBProject.VBComponents(i).CodeModule
    leline = mdl.CountOfLines
    If leline > 0 Then
        modtext = mdl.Lines(1, leline)           
        For j = 0 To UBound(afind)
            If InStr(modtext, afind(j)) > 0 Then
                sfound = sfound & vbCrLf & "****" & afind(j) _
                       & " found in " & mdl.Name
                modarray = Split(modtext, vbCrLf)
                For k = 0 To UBound(modarray)
                    If InStr(modarray(k), afind(j)) > 0 Then
                        sfound = sfound & vbCrLf & k
                        sfound = sfound & "  " & modarray(k)
                    End If
                Next
            End If
        Next
    End If
Next

MsgBox sfound
End Sub 
```

# eclipse - 在 CheckBoxTable 中显示来自 EMF 模型的所有枚举？

> ID：11103846
> 
> 赞同：0
> 
> 时间：2012-06-19T15:04:33.503
> 
> 标签：eclipse, eclipse-plugin, eclipse-emf, eclipse-emf-ecore, emf

我试图在 Eclipse 页面中显示一个 CheckBoxTable，它使用户能够选择多个项目中的任何一个 - 可用的项目来自 EMF 模型并且是枚举。

我已经正确设置了内容提供程序和标签提供程序（我认为），但我无法确定使用什么来设置输入以显示完整的枚举列表。

因此，假设我的模型有一个名为 MyEnum 的枚举，其值为 ONE、TWO 和 THREE - 我希望能够将所有这三个枚举作为复选框显示给用户。

我需要在查看器上调用 setInput(...) 但是我应该传递什么来获取这些枚举？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:24:26.673

虽然我从未为 a 做过，但我已将 a`CheckboxTableViewer`设置`EEnum`为其他`StructuredViewer`类（如`ComboViewer`. 我所做的是创建一个自定义`IStructuredContentProvider`，它是的子类`ArrayList`并将其`EEnum`作为构造函数参数（调用此类`EEnumContentProvider`）。在构造函数中，我遍历`EEnum`'s`getELiterals()`并调用`add()`它们的每个`getInstance()`值。像这样：

```
public EEnumContentProvider(EEnum source) {
    List<EEnumLiteral> literals = source.getELiterals();
    for (EEnumLiteral aLiteral : literals) {
        add(aLiteral.getInstance());
    }
} 
```

`IStructuredContentProvider.getElements(Object)`您可以通过使用返回结果轻松实现`toArray()`并且您不关心，`IContentProvider.setInput()`因为内容不是基于输入，它们是静态的。

然后，您可以将 的实例设置`EEnumContentProvider`为查看器的内容提供者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T08:20:30.343

只需获取文字并将它们添加到控件中，如下所示：

```
/* Populate the Combo Box with the Literals */    
EEnum cFEnum = Package.Literals.LITERAL_ENUMERATION;
/* 
 * Add an EMPTY item value so that the user can disable the specific 
 * feature 
 */
this.cmbNames.add( EMPTY_STRING );

/*
 * Add the  Enumeration Literals to the 
 * appropriate SWT Combo widget.
 */
for (int i=0; i<cFEnum.getELiterals().size(); i++){         
  this.cmbNames.add( cFEnum.getEEnumLiteral( i ).toString() );
}
cFEnum = null;

String[] sortedTypes = this.cmbNames.getItems();
Arrays.sort( sortedTypes );
this.cmbNames.setItems( sortedTypes ); 
```

# sql - 子报告标题未显示在主报告中

> ID：11103847
> 
> 赞同：0
> 
> 时间：2012-06-19T15:04:49.043
> 
> 标签：sql, reporting-services, reporting

我有一份称为子报告的主报告。

在这个子报告中，我有一个 tablix。tablix 大小将根据列分组中可用的数据增长。

我在 tablix 上方有一个固定大小的标题。如果第一组值包含多个页面，我需要在所有页面上显示标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:15:50.313

您的问题有点含糊，但是要在多个页面上显示 tablix 的标题，过程如下：

1.  单击“分组”窗格中“行”和“列”部分最右侧的小下拉箭头（默认情况下，它位于设计窗口的底部中心）
2.  点击“高级模式”
3.  在您想要的分组级别单击 tablix 的“静态”行分组
4.  在“属性”部分中，将“RepeatOnNewPage”属性更改为“True”

![在此处输入图像描述](../Images/933e99a2e3d7db87658363401a7a7c3b.png)

我希望这有帮助。

# java - 如何使用java声明“任何东西”？

> ID：11103850
> 
> 赞同：3
> 
> 时间：2012-06-19T15:04:51.397
> 
> 标签：java, netbeans-7

我正在尝试使用 java 中的“.equal”从文本文件中查找和读取字符串。我知道我可以通过使用“.contain”来简单地做到这一点，但我只想知道是否有办法找到并阅读这样的行：

例如，我在文本文件中有以下数据：

```
ID1   123   123
ID2   125   136 
```

现在

```
String ID="ID1"; 
while ((ss = buffered_reader.readLine()) != null){
if (ss.equals(ID+[anything])){do something} } 
```

我为什么要这样做是为了防止只输入“ID”就得到结果。那么有没有像正则表达式或其他可以提供帮助的方法？

澄清：

我想找到 ID 的完全匹配，例如：

如果您输入 ID1，那么程序会说： true but false for enter just ID

如果我使用 .contain 程序找到单词 ID1 或 ID2 并且因为它们包含 "ID" ，那么它总是返回一个真值。

现在我想使用 .eqaual 来查找完全匹配的内容，然后是任何内容

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T15:10:50.923

试试这个：

```
String ID="ID1"; 
while ((ss = buffered_reader.readLine()) != null) {
    if (ss.matches(ID+".*")){do something} }
} 
```

表达式`.*`表示任何字符序列，甚至是空序列。因此，如果`ID`是“ID1”，那么它将匹配`string`以 ID1 开头的任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T15:07:24.650

试试这个正则表达式：

```
ID.+ 
```

仅当字符串具有“ID”子字符串加上至少一个字符时才会匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T15:11:05.013

一个正则表达式，例如：

```
(ID\d+)\s+(\d+)\s+(\d+) 
```

将让您捕获三个组，其中包含感兴趣的值。例如对于这个输入：

```
ID1   123   123 
```

第一组将包含`ID1`组 twp 将包含`123`和`123`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T15:29:09.747

您还可以测试行的**长度**，如下所示（移动的代码比*regex*少）：

```
while ((ss = buffered_reader.readLine()) != null) {
   if (ss.length()>3) {
       // Do your job
   }
} 
```

# functional-programming - 经验丰富的计划者，letcc 和诡计

> ID：11103852
> 
> 赞同：9
> 
> 时间：2012-06-19T15:05:01.053
> 
> 标签：functional-programming, scheme, seasoned-schemer

这里有几个问题，关于`letcc`那个在 The Seasoned Schemer 中使用。

```
(define (intersect-all sets)
  (letcc hop
    (letrec
      ((A (lambda (sets)
            (cond
              ((null? (car sets)) (hop '())
              ((null? (cdr sets)) (car sets))
              (else
                (intersect (car sets)
                           (A (cdr sets)))))))
       ; definition of intersect removed for brevity
      (cond
        ((null? sets) '())
        (else (A sets)))))) 
```

1.  我想我理解`letcc`实现了什么，这基本上类似于ruby​​ 中的`catch`and `throw`（并且看似 CL），这基本上意味着可以通过调用任何命名的东西来缩短整个代码块`letcc`。这感觉像是我在这一系列短书中遇到的最不“实用”的东西，它让我觉得使用它有点犹豫，因为我想学习一种好的实用风格。我只是误解`letcc`，还是它不是真正的函数式编程概念，只是为了提高性能而存在？我可以在一些例程中间然后突然进入代码中的另一个点的整个想法感觉有点不对……就像在 Java 中滥用 try/catch 来进行程序流一样。

2.  `letcc`我在 OS X 中安装的 guile (1.8.7) 版本中似乎不存在。我应该在 guile 中寻找它的另一个名称吗？

3.  如果我`letcc`通过将它与 Java 中的 try/catch 或 ruby​​ 中的 catch/throw 进行比较而产生误解（这*不是*异常处理，只是为了清楚，对于非 ruby​​ 主义者），它在功能级别上究竟是如何工作的? 它能否以更长、更复杂的方式表达，让我相信它毕竟是功能性的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-19T16:49:31.270

1.  “功能性”有多种含义，但没有任何通俗的含义以任何方式与延续相矛盾。但是它们*可能*被滥用来创建难以阅读的代码。它们不是可以“被滥用于程序流”的工具——它们*是*程序流工具。

2.  帮不了你。我知道 Guile 有半新的续集，但我不知道情况如何。它肯定应该有`call-with-current-continuation`，通常也是在更友好的名称下`call/cc`，并且`let/cc`是一个可以构建的简单宏`call/cc`。

    我可以告诉你，在 Racket 中，有一个内置[`let/cc`](http://docs.racket-lang.org/reference/cont.html#%28form._%28%28lib._racket/private/more-scheme..rkt%29._let/cc%29%29)函数以及[同一系列的](http://docs.racket-lang.org/reference/cont.html)[其他一些内置](http://docs.racket-lang.org/guide/control.html)函数，此外还有一个包含各种控制运算符的[完整库](http://docs.racket-lang.org/reference/cont.html#%28part._.Classical_.Control_.Operators%29)（带有广泛的参考列表。）。

3.  的简单用法`let/cc`确实类似于 catch/throw 之类的东西——更具体地说，这种延续通常被称为“转义延续”（或有时“向上”）。这是您在该代码中的一种用途，通常用于实现 an`abort`或 a `return`。

    但是 Scheme 中的延续是可以在任何地方使用的东西。对于显示这种差异的非常简单的示例，请尝试以下操作：

    ```
    (define (foo f) (f 100))
    (let/cc k (+ (foo k) "junk") (more junk)) 
    ```

4.  最后，如果您想了解更多关于延续的信息，您可以查看[PLAI](http://www.plai.org/)的相关部分，还有 Matthew Might 写的更[简短的示例概述](http://matt.might.net/articles/programming-with-continuations--exceptions-backtracking-search-threads-generators-coroutines/)，您可以看到我写的一些基于 PLAI 的[课堂笔记](http://tmp.barzilay.org/cont.txt)，有一些受后一篇文章启发的例子。

# ios - UI 自动化 onAlert 方法没有被调用以获取警报

> ID：11103855
> 
> 赞同：1
> 
> 时间：2012-06-19T15:05:11.487
> 
> 标签：ios, instruments, ios-ui-automation

我正在编写一个 UI 自动化测试脚本，我注意到`onAlert`每次向用户显示警报时应该由测试脚本自动调用的函数没有被调用。

为了测试这一点，我有一个简单的`UIALogger.logMessage()`调用，只记录一条输入该`onAlert`方法的消息。

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T20:31:25.823

我发现如果测试脚本的执行结束并弹出警报，即使测试会话仍在运行并记录诊断，onAlert 处理功能也不再触发。

# python - re.findall 返回命名捕获组的字典？

> ID：11103856
> 
> 赞同：68
> 
> 时间：2012-06-19T15:05:11.490
> 
> 标签：python, regex

受到一个现已删除的问题的启发；给定带有命名组的正则表达式，是否有一种方法`findall`可以返回`dict`带有命名捕获组的列表而不是列表`tuple`？

鉴于：

```
>>> import re
>>> text = "bob sue jon richard harry"
>>> pat = re.compile('(?P<name>[a-z]+)\s+(?P<name2>[a-z]+)')
>>> pat.findall(text)
[('bob', 'sue'), ('jon', 'richard')] 
```

应该改为：

```
[{'name': 'bob', 'name2': 'sue'}, {'name': 'jon', 'name2': 'richard'}] 
```

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-06-19T15:17:49.570

```
>>> import re
>>> s = "bob sue jon richard harry"
>>> r = re.compile('(?P<name>[a-z]+)\s+(?P<name2>[a-z]+)')
>>> [m.groupdict() for m in r.finditer(s)]
[{'name2': 'sue', 'name': 'bob'}, {'name2': 'richard', 'name': 'jon'}] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-19T15:19:53.433

你可以切换到查找器

```
>>> import re
>>> text = "bob sue jon richard harry"
>>> pat = re.compile('(?P<name>[a-z]+)\s+(?P<name2>[a-z]+)')
>>> for m in pat.finditer(text):
...     print m.groupdict()
... 
{'name2': 'sue', 'name': 'bob'}
{'name2': 'richard', 'name': 'jon'} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-04-21T17:22:40.100

如果您使用匹配：

```
r = re.match('(?P<name>[a-z]+)\s+(?P<name2>[a-z]+)', text)
r.groupdict() 
```

[文档在这里](https://docs.python.org/3.5/library/re.html#re.match.groupdict)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T15:05:39.307

没有内置的方法可以做到这一点，但可以通过使用列表推导来实现预期的结果。

```
[dict([[k, i if isinstance(i, str) else i[v-1]] for k,v in pat.groupindex.items()]) for i in pat.findall(text)] 
```

使用友好的格式：

```
>>> [
...     dict([
...         [k, i if isinstance(i, str) else i[v-1]]
...         for k,v in pat.groupindex.items()
...     ])
...     for i in pat.findall(text)
... ] 
```

我们使用列表推导式构造一个列表，遍历结果，`findall`其中要么是字符串列表，要么是元组列表（0 或 1 个捕获组导致 的列表`str`）。

对于结果中的每个项目，我们`dict`从另一个列表推导中构造一个，该推导是从`groupindex`编译模式的字段生成的，如下所示：

```
>>> pat.groupindex
{'name2': 2, 'name': 1} 
```

为 中的每个项目构造一个列表`groupindex`，如果来自的项目`findall`是一个元组，则使用来自的组号`groupindex`来查找正确的项目，否则将该项目分配给（仅现存的）命名组。

```
[k, i if isinstance(i, str) else i[v-1]] 
```

最后，从字符串列表的列表构造一个 dict。

请注意，`groupindex`它仅包含命名组，因此结果中将省略未命名的捕获组`dict`。

结果：

```
[dict([[k, i if isinstance(i, str) else i[v-1]] for k,v in pat.groupindex.items()])  for i in pat.findall(text)]
[{'name2': 'sue', 'name': 'bob'}, {'name2': 'richard', 'name': 'jon'}] 
```

# c++ - 是否可以在 Windows XP 上以编程方式检测特定以太网接口上 IP 地址的变化？

> ID：11103858
> 
> 赞同：0
> 
> 时间：2012-06-19T15:05:17.387
> 
> 标签：c++, .net, winapi, c++-cli, windows-embedded

我可以轻松地以编程方式检查 IP 地址，但是有没有办法设置通知以防接口的 IP 地址发生变化？

这可以是windos API 或.net 解决方案；两者都可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T19:10:20.017

[NotifyAddrChange](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366329%28v=vs.85%29.aspx)或其他 Notify* 函数之一应该可以完成这项工作。

各种嵌入式 Windows 版本也支持此功能。

# google-analytics - 对 Google Analytics __utm.gif 的调用有什么问题？

> ID：11103859
> 
> 赞同：0
> 
> 时间：2012-06-19T15:05:17.840
> 
> 标签：google-analytics

我正在尝试使用 PHP 在 Google 上触发点击，以跟踪新闻通讯的打开和点击。我想对点击和打开使用相同的技术，因为点击将转到我自己控制之外的网站 - 我希望能够报告新闻通讯的点击率，无论点击去哪里。我正在考虑尝试`code.google.com/p/php-ga/`，但示例代码/支持文档的方式很少，所以我很犹豫。

`__utm.gif`为了清楚起见，这是我的网址：

> utm.gif?utmac=MO-xxx31982-1">http://www.google-analytics.com/_utm.gif?utmac=MO-xxx31982-1
> 
> &utmhn=myfake.com
> 
> ＆utmcc = _ *UTMA％3D7042858245.1436153422.1214501708.1340117181.1340117181.1％3B％2B％2B* _UTMZ％3D1.134011181.1.1.1.1.1.1.utmcsr clutct rimccs rimccsr an
> 
> &utmwv=1
> 
> &utmr=点击
> 
> &utm_source=电子邮件
> 
> &utm_medium=时事通讯
> 
> &utm_campaign=春节+2012-06-19+10%3A41%3A30
> 
> &utmp=%2FMYZZ%2F新闻通讯
> 
> &uservar=16430

`utmhn`需要是合法的 URL 还是与帐户关联的 URL ？怎么样`utmr`？我用它来包含“点击”或“打开”，所以我可以区分。

当我单击时事通讯中的链接时，我会返回预期的像素图像，因此即使忽略我的查询字符串，Google 也会得到一些东西。在我的 Google Analytics（分析）帐户中，我应该在哪里看到与`__utm.gif`点击相关的数据？到目前为止，我在使用这种技术时看不到任何东西。

PS我[从这里得到了这个技术](http://www.kontain.com/karlstanton/entries/47993/tracking-your-email-campaigns/)

跟进：我改变了一些东西，我的网址现在看起来像这样：

> utm.gif?utmwv=1">http://www.google-analytics.com/_utm.gif?utmwv=1
> 
> &utmn=8391432847
> 
> &utmsr=点击
> 
> &utmsc=-
> 
> &utmul=-
> 
> &utmje=0
> 
> &utmfl=-
> 
> &utmdt=-
> 
> &utmhn=myfake.com
> 
> &utm_source=my_newsletter
> 
> &utm_medium=电子邮件
> 
> &utm_campaign=春节 2012-06-19 10:41:30
> 
> &utmr=my_newsletter
> 
> &utmp=图片/谷歌/点击
> 
> &utmac=MO-xxx31982-1
> 
> &utmcc=_ *utma%3D24820632.1925394567.1340121629.1340121629.1340121629.2%3B%2B* _utmb%3D24820632%3B%2B_ *utmc%3D24820632%3B%2B* _utmz%3D24820632.1340121629.2.2.utmccn%3D(direct)%7Cutmcsr%3D(direct )%7Cutmcmd%3D(无)%3B%2B__utmv%3D24820632.6430%3B

并且什么都没有发生，除非我将该链接粘贴到我的浏览器然后谷歌得到它，那么为什么从 PHP 行调用它时它不起作用`$handle = fopen ($urchinUrl1, "r");`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T18:30:16.907

好吧，那算了。我更改了我的应用程序，因此 utm.gif 仅包含在电子邮件和重定向页面中，而不是从脚本中调用。应该这样做，但陷入了从 php.ini 调用 url 的更奇特的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T00:28:11.100

即使这个问题已有一年多的历史了……GA 测量协议可用于将点击数发送回 GA，以便打开新闻通讯和点击。

要回答您最初的问题，您似乎缺少 utmhid 和 utmn 参数。

# actionscript-3 - AS3 代码暂停和播放 Flash 中的“整体”音频（从场景到场景）？

> ID：11103860
> 
> 赞同：1
> 
> 时间：2012-06-19T15:05:21.520
> 
> 标签：actionscript-3, flash

我的问题是，如何暂停音频`"scene 1"`并让它播放，这样当你去`"scene 3"`（它附加了一个不同的音频文件将要播放）时，它的音频通常仍然是静音的，但是当你点击**“on "**按钮播放场景中的相应歌曲，有点像在游戏中您可以在主菜单中静音，然后在整个游戏过程中取消静音；

另外一般来说，我将如何制作播放/暂停按钮（我假设“ `if else`”语句可能有效但不确定）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T23:03:33.913

这实际上取决于您是要实际暂停音频、停止音频还是只是静音音频。每个都有不同的用途。

但是，对于您的使用，听起来您需要使用“静音”按钮。我敢肯定，有很多方法可以做到这一点。我推荐的是专门为音频创建一个 AS3 类。然后，您需要在文档类中设置此类。

转到文件 --> 新建...并选择 ActionScript 3.0 类。将其命名为“gamesounds.as”。在单击保存之前，请在与 .fla 相同的目录中创建一个新文件夹。将此文件夹命名为“gamecore”，然后将“gamesounds.as”保存在其中。我刚刚这样做的原因是，您需要将所有此类自定义类放在一起。

现在，这是您班级的基本结构：

```
package gamecore
{
    public class GameSounds
    {
        //constructor code
    }
} 
```

在我们做任何其他事情之前，我们需要确保我们的游戏能够访问这个类。我们不想创建一百万个副本，因为这会破坏类的主要功能。打开您的文档类（创建一个新的文档类超出了此答案的范围。查找它。）当然，文档类必须与 gamecore 文件夹位于同一目录中（不在 gamecore 文件夹中）。

在文档类中的类声明上方，输入这行代码：

```
import gamecore.GameSounds; 
```

然后，在你的类声明中，输入这一行：

```
public static var GameSounds:GameSounds = new GameSounds(); 
```

显然，保存，然后返回到您的 gamesounds.as 文件。这是您要使用的代码。我添加了注释来说明不同代码的作用。

我假设您已将所有歌曲导入到 .fla 的库中，并创建了它们的动作脚本绑定。您也可以修改它以在外部播放歌曲，但我不会在这里讨论。

以下应替换`//constructor code`

```
import flash.media.Sound;
import flash.media.SoundChannel;
import flash.media.SoundTransform;

//Create a variable to indicate whether the music is muted.
var isMuted:Boolean = false;

/*Create a string variable for the name of the song that should be playing. Alternatively, you could just name this an int and store the scene number. It all depends on what you want to do.*/
var songName:String;

//Create a sound channel for playing audio.
var musicChannel:SoundChannel = new SoundChannel();

//Import your songs.
var fooForYou:Sound = new fooForYou();
var iveBeenAFoo:Sound = new iveBeenAFoo();
var pityTheFoo:Sound = new pityTheFoo();

/*This function sets the target song based on location. Just pass it the integer of the stage. Alternatively, you can make this work with the stage name as a String.*/
function startMusic(targetScene:int):void
{
    /*Depending on the targetScene number, set the correct song name. Note these match the song declarations above.*/
    switch(targetScene)
    {
        case 1:
            songName = "fooForYou";
        break;
        case 2:
            songName = "iveBeenAFoo";
        break;
        case 3:
            songName = "pityTheFoo;
        break;
    }
    //Start the actual music playing.
    playMusic();
}

/*This function starts the music itself. Keep it separate, in case you need to bypass the startMusic code for some reason.*/
function playMusic():void
{
    //I'd imagine you want your music looped, so int.MAX_VALUE accommodates for that.
    musicChannel = this[songName].play(0, int.MAX_VALUE);

    //Mute or unmute depending on that variable above.
    adjustVolume();
}

//This function mutes or unmutes depending on the variable condition.
function adjustVolume():void
{
    //We create a SoundTransform.
    var transform:SoundTransform = musicChannel.soundTransform;

    //We set the volume to 0 or 1, depending on the isMuted variable.
    if(isMuted)
    {
        transform.volume = 0;
    }
    else
    {
        transform.volume = 1;
    }

    //We apply the transform to the song.
    musicChannel.soundTransform = transform;
}

/*This function is present for convenience's sake. Calling this adjusts the variable AND the music that is currently playing.*/
function setMute(mute:Boolean):void
{
    //Sets the isMuted variable to the mute argument.
    isMuted = mute;

    //Mutes or unmutes the currently playing sound.
    adjustVolume();
} 
```

现在，您只需要在 .fla 本身中使用两个函数。我将假设“DocClass”是您的文档类的名称。在每个阶段开始时，调用这行代码，将参数中的“1”替换为阶段编号（或名称，如果您选择了该路线）。

```
DocClass.GameSounds.startMusic(1); 
```

它将开始播放有效的音乐，但只有在音乐未设置为静音时才能听到。

将此代码添加到静音按钮以静音，将“true”替换为“false”以取消静音。

```
DocClass.GameSounds.setMute(true); 
```

-- 关于暂停键，这个问题应该单独问。我会告诉你，如果你打算循环播放音乐，在使用 SoundChannel 时暂停它会给你带来一个问题，因为音乐将从上次暂停的点开始循环播放。

我希望这对你有帮助！我已经在我的项目中使用这种代码一年多了，而且我从来没有遇到过问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T20:58:33.257

首先包括 SoundMixer 类：

导入 flash.media.SoundMixer；

然后停止声音调用 stopAll 方法：

SoundMixer.stopAll();

# javascript - 将事件委托给自己

> ID：11103867
> 
> 赞同：0
> 
> 时间：2012-06-19T15:05:40.720
> 
> 标签：javascript, jquery, event-delegation

我正在编写一个需要 4 个参数的事件委托插件：

*   上下文 = 字符串选择器
*   子元素 = 字符串选择器
*   事件 = 字符串
*   fn = 要调用的函数

如果父元素存在于 DOM 中，那么插件必须将事件委托给子元素。

当上下文元素与子元素相同时，**就会出现问题。**委托不再起作用，因为它期望传递的孩子是上下文的孩子。

这是一个失败的示例输入：

*   上下文 = “ul”
*   子元素 = “ul.active”
*   事件 = “点击”

你不能这样做，`$('ul').on('click', 'ul.active', fn())`因为有时'ul.active'会与'ul'相同。

我能想到的一种解决方案可能是：

```
var $context = $('ul');
$(document).on('click', 'ul.active', function(e){
   var $target = $(e.target);
   if($target.is($context) || $target.closest($context).length){
      fn()
   }
}) 
```

我想知道在绑定委托事件之前检查'is child == context'是否更好，并将它们适当地绑定到情况

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T16:19:31.083

我并不是说这是一个很好的解决方案，但这是我能想到的唯一方法`$(document)`

```
var parent = 'ul';
var child = 'ul.active';

$(parent).on('click', child, function() {
    console.log('ul.active clicked')
})​;

$(child)
    .filter(function(){
        return $(this).parents(parent).length == 0;
    })
    .on('click', function() {
        console.log('ul.active clicked')
    });​ 
```

你可能可以做得更好 - 只是按照我的想法输入:)

# asp.net - 在 WCF WebHttp 服务中同时支持 ASP.NET 缓存和 ETag/Conditional GET

> ID：11103874
> 
> 赞同：0
> 
> 时间：2012-06-19T15:05:58.213
> 
> 标签：asp.net, wcf, caching, rest

我正在尝试使用支持缓存和条件 GET 的 WCF 实现 REST Web 服务。

[我按照MSDN](http://msdn.microsoft.com/en-us/library/ee230443.aspx)中的说明实现了基本缓存：Caching Support for WCF Web HTTP Services 。这意味着`[AspNetCacheProfile("MyOutputCacheProfile")]`为我的每个 web 方法添加一个属性并将适当的条目添加到`web.config`. 这似乎工作正常：当将相同的参数传递给 Web 方法时，将返回缓存的响应。

然后，我通过计算 ETag 值并将其设置在响应中，添加了对 Conditional GET 的支持，如下所示：

```
WebOperationContext.Current.OutgoingResponse.SetETag(myETag); 
```

这种方法有效：我`ETag`第一次调用 web 方法时可以在响应中看到标题。

但问题是：下次我使用相同的参数调用该 Web 方法时，会返回一个缓存的响应，并且缓存的响应不包含`ETag`标头。（如果我等到缓存到期，或完全禁用缓存，则 ETag 标头会正确返回。）

那么，有没有办法让缓存的响应包含该 ETag 值？

* * *

*更新：*经过更多的研究和实验，我发现这样做会导致 ETag 标头包含在所有缓存的响应中：

```
HttpContext.Current.Response.Cache.SetETag(myETag); 
```

如果我调用它，那么我不需要调用相关的`WebOperationContext...SetETag()`操作来使一切正常。

这是这样做的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T16:51:31.687

如果我错了，请纠正我。Restful 服务更接近 Http 和 Http 缓存说

> HTTP/1.1 中缓存的目标是在许多情况下消除发送请求的需要，并在许多其他情况下消除发送完整响应的需要。前者减少了许多操作所需的网络往返次数；为此，我们使用“过期”机制（参见第 13.2 节）。后者降低了网络带宽需求；为此，我们使用“验证”机制（参见第 13.3 节）。

Asp.net 缓存不属于此类（既不过期也不验证）。缓存仅在 Web 服务器和 IIS 上完成，而不是执行该方法，发送存储的响应。有些不适合 RESTful 模型。

为了实现缓存，我们应该将Cache Control Headers和Etag添加到响应头中，然后尝试处理条件Get。请查阅这篇优秀的[文章](http://joseoncode.com/2011/04/27/rest-and-the-http-cache-with-wcf-web-api/)。

# osgi - 为什么导入的类优先于捆绑类？

> ID：11103876
> 
> 赞同：3
> 
> 时间：2012-06-19T15:06:02.943
> 
> 标签：osgi, classloader

我知道规范准确定义了它，但不知道这是什么原因：

```
A class space is then all classes reachable from a given bundle’s class loader. 
Thus, a class space for a given bundle can contain classes from:
• The parent class loader (normally java.* packages from the boot class path)
• Imported packages
• Required  bundles
• The bundle's class path (private packages)
• Attached fragments 
```

让我们假设：

1.  一个包声明“import-package: a”
2.  此捆绑包中有一个本地类 aX
3.  在另一个捆绑包中有一个 aX 类

new aX() 将从另一个包中加载该类。

导入类优先于捆绑类的原因是什么？它只是java分层类加载策略的后续延续吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T15:30:16.177

这实际上是 OSGi 的核心方面。

## 分享课

整个导入/导出机制旨在让不同的包在通信时使用*相同*的类。在这种情况下，same 不仅意味着二进制相等，而且由*同**一个类加载器加载*（回想一下，每个包都有自己的类加载器）。如果捆绑包自己的类比导入的类更受青睐，捆绑包将无法“同意”使用哪个类的副本。

## 但为什么？

为什么你会有一个你也打算导入的类的副本？考虑一种情况，您想进行一些日志记录，因此您 import `org.osgi.service.log`，但这不是一个重要方面，您可以在没有`LogService`礼物的情况下愉快地运行。现在，

*   如果您只导入包，您的包将无法解析，因此无法启动，并且
*   如果您只包含该类，则永远不会使用其他捆绑包的`LogService`类，因此您不能使用该服务（这是同意的部分）。

在这种情况下，您*既可以*导入也可以包含该类，因此您可以在任何一种情况下运行，在没有其他人拥有的情况下使用您自己的副本，并在其他人有的情况下共享副本。您甚至可以选择导出您的副本，并让框架来决定。

作为旁注，这正是您应该（几乎）始终*导入您导出*的内容的原因。

# c# - 在 C# 中运行 Java 代码

> ID：11103878
> 
> 赞同：3
> 
> 时间：2012-06-19T15:06:20.827
> 
> 标签：c#, java, silverlight

我正在`silverlight application`使用 c# 编写一个。对于该项目，我需要能够编译程序并将其下载到外部驱动器。我有执行此操作的代码，但是它是用 Java 编写的。

代码很广泛，需要花费大量时间将其全部转换为 c#。有没有另一种方法可以将代码翻译成 c#，或者有没有办法在 ac# 项目中运行 java 代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T15:08:48.540

您始终可以将其编译为可执行文件并使用`Process.Start`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:09:45.947

您可以使用[IKVM.net](http://www.ikvm.net/)将 jar 转换为 dll

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T15:09:56.560

在谷歌你可以找到它的在线服务或更改相同的代码女巫不起作用

# c# - 批量插入查询将数据从文本文件导入数据库表

> ID：11103880
> 
> 赞同：0
> 
> 时间：2012-06-19T15:06:25.670
> 
> 标签：c#, sql, bulkinsert

我有一个包含 25 个字段的文本文件，用管道符号分隔。

现在，我创建了一个控制台应用程序来将此文本文件数据导入到数据库表中。在我的数据库表中，我只有 10 列，用户将从 25 列中选择 10 列。所以我必须将用户选择的特定 10 个字段导入数据库。我正在使用批量插入查询将文本文件导入控制台应用程序的临时表中。

现在，如何仅将用户选择的 10 列从文本文件导入数据库表？如何修改批量插入查询来实现这一点？

# vb.net - 查找重叠同一矩形的多个矩形的总重叠百分比？

> ID：11103888
> 
> 赞同：3
> 
> 时间：2012-06-19T15:06:44.093
> 
> 标签：vb.net, intersection, system.drawing, overlap

我有一个`System.Drawing.RectangleF`对象列表，它们都与同一个`RectangleF`对象重叠。在我下面的图片中，3 个重叠的矩形将是粉红色、黄色和红色矩形。我的主要矩形是浅蓝色矩形。

![在此处输入图像描述](../Images/8365e962a903b8a368cd7e6ff825ee08.png)

第二张图片： ![在此处输入图像描述](../Images/d1eb9b72c4bddf93d25ea5b3cb5642bb.png)

我知道对于`RectangleF`对象，我可以使用`Intersect()`返回另一个`RectangleF`表示重叠的对象的方法。但据我所知，这只在比较两个矩形时才真正有效。

**我的问题是**：如何确定总面积/百分比（即，与浅蓝色矩形相比，红色、黄色和粉红色矩形的*总重叠总和*- 但它需要足够聪明才能不计算面积红色和黄色重叠*两次*，粉色和黄色重叠）？

**注意：绿线代表我正在寻找的区域，只是不可见的蓝色矩形的总区域。**

**更新**：我添加了第二张图片以进一步展示我正在寻找的内容。在第二张图片中，酒红色矩形的存在应该不会影响覆盖的总百分比，因为该区域已经被黄色和绿色矩形覆盖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:26:47.303

好的，我想我找到了一个解决方案，该解决方案`Region`似乎适用于上面的两个示例图像：

```
Private Function TotalCoveredAreaPercent(ByVal oRectToCheck As RectangleF, ByVal oOverlappingRects As List(Of RectangleF)) As Double

    Dim oRegion As New Region(oRectToCheck)
    Dim dTotalVisibleArea As Double = 0
    Dim dTotalCoveredArea As Double = 0

    'now we need to exclude the intersection of our 
    'overlapping rectangles with our main rectangle:
    For Each oOverlappingRect As RectangleF In oOverlappingRects

        oRegion.Exclude(RectangleF.Intersect(oRectToCheck, oOverlappingRect))

    Next

    'now we have access to the non-overlapping 
    'rectangles that make up the visible area of our main rectangle:
    Dim oVisibleRects As RectangleF()

    oVisibleRects = oRegion.GetRegionScans(New Drawing2D.Matrix())

    'add the area of the visible rectangles together 
    'to find the total visible area of our main rectangle:
    For Each oVisibleRect As RectangleF In oVisibleRects
        dTotalVisibleArea += AreaOf(oVisibleRect)
    Next

    Dim dPercentVisible As Double = dTotalVisibleArea / AreaOf(oRectToCheck) * 100

    'percent covered is 100 - the visible percentage:
    Return (100 - dPercentVisible)

End Function 
```

这似乎工作得很好，而且很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T22:09:10.583

这是我的算法。关键是我们要减去重叠的重叠。

```
 Dim baseRect As New RectangleF(10, 10, 20, 20)
    Dim otherRectList As New List(Of RectangleF)
    otherRectList.Add(New RectangleF(5, 5, 10, 10))
    otherRectList.Add(New RectangleF(20, 20, 10, 10))
    otherRectList.Add(New RectangleF(10, 5, 10, 10))

    Dim overlapRectList As New List(Of RectangleF)
    For Each otherRect As RectangleF In otherRectList
      If RectangleF.Intersect(otherRect, baseRect) <> RectangleF.Empty Then
        overlapRectList.Add(RectangleF.Intersect(otherRect, baseRect))
      End If
    Next

    Dim totalArea As Single = 0
    For Each overlapRect As RectangleF In overlapRectList
      totalArea += overlapRect.Width * overlapRect.Height
    Next

    'Subtract out any overlaps that overlap each other
    For i = 0 To overlapRectList.Count - 2
      For j = i+1 To overlapRectList.Count - 1
        If i <> j Then
          If RectangleF.Intersect(overlapRectList(i), overlapRectList(j)) <> RectangleF.Empty Then
            Dim dupeRect As RectangleF = RectangleF.Intersect(overlapRectList(i), overlapRectList(j))
            totalArea -= dupeRect.Width * dupeRect.Height         
          End If
        End If
      Next
    Next 
```

我修改了代码以考虑到 tcarvin 的注释。但是，我还没有在方格纸上画出结果来看看这是否完全正确。我会尽快查看它，我有额外的时间。另请注意，我没有包含任何代码来处理少于 2 个交叉点的情况。

# javascript - 为什么我应该使用backbone.js 或spine.js

> ID：11103893
> 
> 赞同：0
> 
> 时间：2012-06-19T15:07:09.853
> 
> 标签：javascript, architecture, backbone.js, spine.js

我正在开发一个主要面向公众的信息网站。我的架构是为站点中的页面向客户端提供 JSON 数据。我计划在客户端的 localStorage 中缓存 JSON，并让它在刷新之前保持 XX 时间。我正在使用客户端模板 (jsRender) 将 JSON 呈现到 UI 小部件中，然后使用 jQuery 将其推送到视图中。

在我为此进行的研究中，我偶然发现了 JavaScript MVC 方法，例如backbone.js 和spine.js 等。我已经通读了它们并将它们与我上面的方法进行了比较，但不确定我是否/为什么需要像backbone.js 或spine.js 这样的东西。除了让用户填写联系我们表格或注册我们的时事通讯外，我几乎不做任何数据输入。所以，真的不需要保持视图和模型同步。我只是从我的服务器中检索 JSON 并使用模板呈现它并在 localStorage 中缓存 JSON 一段时间。

如果我的方法看起来合适，我想与专家核实一下，看看我是否真的“需要”backbone.js 或 spin.js。这些方法中的任何一种对我的架构方向有什么帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:16:59.113

如果您觉得不需要其他任何东西，我建议您不要使用它。“过早的优化是万恶之源”。当您因为应用程序变得混乱而遇到麻烦并且您花费大量时间实现新功能或解决错误时，那么所有这些东西对您来说都会开始有意义。然后您将了解为什么从一开始就在您的应用程序中实现 MVC 非常方便和优雅。

# c# - C# Array resize 是否需要更长的数组越大？

> ID：11103899
> 
> 赞同：3
> 
> 时间：2012-06-19T15:07:27.643
> 
> 标签：c#, arrays

在我的应用程序中，我每帧执行一次 System.Array.Resize。最初，我将数组设置为最大可能大小，然后将它们调整为更小的值。在某些情况下，它可能会小很多，在其他情况下，它可能会更小一些。但在我看来，要调整大小的元素越多，所需的时间就越长。也许我的观察是错误的，这就是我在这里问的原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-19T15:09:31.127

应该可以，调整大小涉及将新内存分配到您想要的大小并将旧数组复制到新数组中。数组越大，复制的越多。

[来自 MSDN](http://msdn.microsoft.com/en-us/library/bb348051.aspx)：

> 此方法分配一个指定大小的新数组，将元素从旧数组复制到新数组，然后用新数组替换旧数组。

在不太了解代码的情况下，尝试使用`List<T>`来管理列表和您需要做的调整大小，当您需要将其提供给 Unity 时，请调用`list.ToArray();`.

这仍然会创建数组并复制它，但每帧只复制一次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T15:52:31.740

正如其他答案所指出的，“调整大小”数组需要复制所有元素，当 N 变大时，这是一个 O(N) 操作。请注意，有多种方法可用于复制数组，具有不同的“设置”和“每项”成本。一个小的数组复制操作一次可以处理 4 个字节（或者在某些情况下，一次一个字节），而一个较大的数组操作将使用特殊的 16 字节操作来完成大部分复制。这些操作仅限于一次写入对齐的 16 字节内存块。根据源和目标对齐方式，大型数组操作可能需要复制四组四字节（其中最后一个字节将与下一组重叠），多组 16 字节，以及另外四组四字节（第一个字节）这将与前一组重叠）。

请注意，最小化数组大小调整成本的真正关键是尽可能少地这样做。每当`List<T>`类型必须扩展其数组的大小时，它就会加倍。如果它的数组从 16 项开始，那么当它将数组加倍到 256 个元素时，128 将为空，64 将被复制一次，32 将被复制两次，16 将被复制三次。请注意，虽然某些元素最终会被复制 lg(N) 次，但在构建大小为 N 的列表的过程中，元素复制操作的总数将始终小于 2N。

没有办法将 a 的后备数组`List<T>`作为数组访问，但是以公开数组的方式重新实现类是相当容易的，并确保任何接受数组作为参数的方法都允许指定要使用的部分的长度（而不仅仅是访问`Length`数组的属性）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T15:13:01.167

是的。数组调整大小是一个 O(n) 操作。它必须将每个元素复制到新数组中。

但是，如果您不使用数组，也许会更好？数组是做什么用的？可能有适合您的应用程序的更好的数据结构。

# c++ - 使用opencv的光流

> ID：11103901
> 
> 赞同：5
> 
> 时间：2012-06-19T15:07:30.053
> 
> 标签：c++, image-processing, opencv

我正在使用 OpenCV 的 Pyramid Lukas Kanade 函数来估计光流。我打电话给`cvGoodFeaturesToTrack`然后`cvCalcOpticalFlowPyrLK`。这是我的代码：

```
while(1)
{
...

cvGoodFeaturesToTrack(frameAth,eig_image,tmp_image,cornersA,&corner_count,0.01,5,NULL,3,0.4);

std::cout<<"CORNER COUNT AFTER GOOD FEATURES2TRACK CALL = "<<corner_count<<std::endl;

cvCalcOpticalFlowPyrLK(frameAth,frameBth,pyrA,pyrB,cornersA,cornersB,corner_count,cvSize(win_size,win_size),5,features_found,features_errors,cvTermCriteria( CV_TERMCRIT_ITER| CV_TERMCRIT_EPS,20,0.3 ),CV_LKFLOW_PYR_A_READY|CV_LKFLOW_PYR_B_READY);

cvCopy(frameBth,frameAth,0);
...
} 
```

`frameAth`是前一个灰色帧和`frameBth`是来自网络摄像头的当前灰色帧。但是当我输出每帧中要跟踪的好特征的数量时，这个数字在求和时间后会减少并继续减少。但是，如果我终止程序并再次执行代码（不干扰网络摄像头的视野），则会显示更多的点作为跟踪的好功能......对于相同的视野和相同的视野如何场景函数给出了这样的点数差异......并且差异很大......例如......执行4分钟后跟踪的良好特征的点数是20或50......但是当同一个程序终止并且再次执行，最初的数字是 500 到 700，但再次缓慢减少..我在过去 4 个月内使用 opencv，所以我对 openCV 很陌生..请指导我或告诉我在哪里可以找到解决方案...很多提前谢谢..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-19T15:21:30.687

您必须调用`cvGoodFeaturesToTrack`一次（在开始时，在循环之前）来检测要跟踪的好特性，而不是使用`cvCalcOpticalFlowPyrLK`. 看一下默认的 opencv 示例：`OpenCV/samples/cpp/lkdemo.cpp`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T09:17:58.260

您正在调用`cvGoodFeatureToTrack`并通过`corner_count`引用传递。如果发现较少的特征，它的值会降低。在调用while 循环的每次迭代之前，您必须将 的值重置`corner_count`为其初始值。`cvGoodFeaturesToTrack`

# java - 检索 android 本机应用程序的 facebook 图形数据

> ID：11103906
> 
> 赞同：1
> 
> 时间：2012-06-19T15:07:46.263
> 
> 标签：java, android, facebook, graph

我正在创建一个与 facebook 集成的 android 游戏，以使用图表检索他们的照片和名字以及其他信息，我已经找到了如何使用以下代码检索他们的照片，该代码运行良好，但我正在努力寻找工作提取其他信息（例如 first_name 等）的示例...

下面是我用来检索照片并将其显示在 ImageView 中的代码。

```
public void showPhoto(View v) {
    try {
        ImageView MyProfilePicImageView = (ImageView)findViewById(R.id.temp);
        URL MyProfilePicURL = new URL("https://graph.facebook.com/me/picture?type=normal&method=GET&access_token="+ access_token );
        Bitmap MyprofPicBitMap = null;

        try {
            MyprofPicBitMap = BitmapFactory.decodeStream(MyProfilePicURL.openConnection().getInputStream());
            MyProfilePicImageView.setImageBitmap(MyprofPicBitMap);
        }
        catch (IOException e) {
            e.printStackTrace();
        }

    } catch (MalformedURLException e) {
        e.printStackTrace();
    }
} 
```

我搜索了高低，但似乎无法找到有关如何使用图表检索其他信息的信息，其他信息意味着 first_name 等......包括在 facebook 开发者网站（[https://developers.facebook. com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)）但找不到工作示例。

任何人都可以向我展示一个工作示例来检索用户的名字，以便我可以在文本视图中显示它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T21:19:45.047

使用此 url `"https://graph.facebook.com/me/friends?access_token="+accessToken`，您可以获得包含他们的姓名和 ID 的朋友，以获取有关他们中的任何一个的信息，只需使用 `"https://graph.facebook.com/"+yourFriendId+"?access_token="+accessToken' 这将返回 json您可以解析和使用
示例

```
HttpClient httpclient = new DefaultHttpClient();
String url = "https://graph.facebook.com/me/friends?access_token=" + URLEncoder.encode(token);
HttpGet httppost = new HttpGet(url);
try {
                HttpResponse response = httpclient.execute(httppost);

                // to get the response string
                BufferedReader reader = new BufferedReader(
                        new InputStreamReader(
                                response.getEntity().getContent(), "UTF-8"));
                // used to construct the string
                String res = "";
                for (String line = null; (line = reader.readLine()) != null;) {
                    res += line + "\n";

                }
// here we will parse the response
                JSONObject obj = new JSONObject(new JSONTokener(res));
                JSONArray data = obj.getJSONArray("data");
int len = data.length();
for (int i = 0; i < len; i++) {
                    JSONObject currentResult = data.getJSONObject(i);
                    String name = currentResult.getString("name");
                    String icon = currentResult.getString("id");

                    // do what ever you want

                }
} catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T21:21:27.013

如果您将请求 URL 更改为仅`/me`(ie `https://graph.facebook.com/me?type=normal&method=GET&access_token=...`)，您将获得当前经过身份验证的用户的所有可用配置文件信息。

此 JSON 对象应具有`first_name`和，以及[此处](https://developers.facebook.com/docs/reference/api/user/)`last_name`发现的其他属性。

看看这个[方便的 API 浏览器工具](https://developers.facebook.com/tools/explorer/?method=GET&path=me)来玩转你应该看到的东西。

# linux - 连接sda时如何使用udev触发脚本，但不是sda1-x

> ID：11103908
> 
> 赞同：0
> 
> 时间：2012-06-19T15:07:50.263
> 
> 标签：linux, udev

将 USB 驱动器连接到嵌入式系统时，我需要运行脚本。我的想法是：

```
SUBSYSTEM=="block",ACTION=="add", KERNELS=="sd?",RUN+="/script param1 %k" 
```

它需要使用任何 USB 棒运行，因此我无法使用供应商特定的参数。现在脚本使用 sd[a..][ *,1..] 执行，但它应该只在 sd[a..]* 连接时执行（_ 表示 NULL）。与？它在断开连接时有效，但在连接时，它为每个分区执行是否有可能或者我必须在 Shell 脚本中解析它？

如果有人可以在这里帮助我，那就太好了。（如果有人看到，我删除了问题：对不起，我想， ? 是最终的解决方案。但它也没有工作）。

这是 udevadm info --attribute-walk -name /dev/sda1 的输出

```
 looking at device '/devices/platform/fsl-ehci.1/usb1/1-1/1-1:1.0/host2/target2:0:0/2:0:0:0/block/sda/sda1':
    KERNEL=="sda1"
    SUBSYSTEM=="block"
    DRIVER==""
    ATTR{partition}=="1"
    ATTR{start}=="63"
    ATTR{size}=="1526112"
    ATTR{alignment_offset}=="0"
    ATTR{discard_alignment}=="4294935040"
    ATTR{stat}=="       0        0        0        0        0        0        0        0        0        0        0"
    ATTR{inflight}=="       0        0"

  looking at parent device '/devices/platform/fsl-ehci.1/usb1/1-1/1-1:1.0/host2/target2:0:0/2:0:0:0/block/sda':
    KERNELS=="sda"
    SUBSYSTEMS=="block"
    DRIVERS==""
    ATTRS{range}=="16"
    ATTRS{ext_range}=="256"
    ATTRS{removable}=="1"
    ATTRS{ro}=="0"
    ATTRS{size}=="15656960"
    ATTRS{alignment_offset}=="0"
    ATTRS{discard_alignment}=="0"
    ATTRS{capability}=="51"
    ATTRS{stat}=="       1        0        8        4        0        0        0        0        0        4        4"
    ATTRS{inflight}=="       0        0" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:14:00.507

```
SUBSYSTEM=="block", ACTION=="add", KERNELS=="sd*[!0-9]", RUN+="/script param1 %k" 
```

`sd*`将匹配任何字符，但`[!0-9]`会排除分区号，因此您只剩下块设备。

至少在 CentOS 6 系统上，/lib/udev/rules.d 中有很多规则。规则文件 60-persistent-storage.rules 定义了上述规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T09:12:24.360

当它被调用时让脚本退出怎么样`/dev/sd??*`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-18T14:04:18.593

简单地：

```
SUBSYSTEM=="block", ACTION=="add", KERNELS=="sd?",  DEVTYPE="disk", RUN+="/script param1 %k" 
```

# c# - 评估 DBNull：检查是否相等或使用“is”运算符？

> ID：11103910
> 
> 赞同：6
> 
> 时间：2012-06-19T15:07:59.880
> 
> 标签：c#, .net

我有一个 C# 问题。我只是想向社区询问[System.DBNull](http://msdn.microsoft.com/en-us/library/system.dbnull.aspx)与 DataReader 的结合使用。

在查询数据库并检查空值时，哪个更合适/首选？

使用“[是](http://msdn.microsoft.com/en-us/library/scekt9xw%28v=vs.100%29.aspx)”运算符：

```
reader["fieldname"] is DBNull 
```

或者只是检查值：

```
reader["fieldname"] == DBNull.Value 
```

两者似乎都有效。我只是想得到一些其他的意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T15:10:48.383

鉴于这`DBNull.Value`是该类的唯一非空值[`DBNull`](http://msdn.microsoft.com/en-us/library/934efkk6)，两者实际上是等效的。你觉得哪个更具可读性？我个人非常喜欢第一个版本，但你的里程可能会有所不同。

无论哪种方式，在性能方面都不太可能成为问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T15:11:03.390

您也可以通过这种方式进行检查：

```
Convert.IsDBNull(reader["field name"]); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T15:16:58.327

我认为 Microsoft 通常建议使用 Convert.IsDBNull，因为他们倾向于希望您使用 Convert 进行大多数转换和等效检查。

从[http://msdn.microsoft.com/en-us/library/system.dbnull.aspx](http://msdn.microsoft.com/en-us/library/system.dbnull.aspx)：

> 您可以通过将该字段的值传递给 DBNull.Value.Equals 方法来确定从数据库字段检索的值是否为 DBNull 值。但是，某些语言和数据库对象提供了更容易确定数据库字段的值是否为 DBNull.Value 的方法。其中包括 Visual Basic IsDBNull 函数、Convert.IsDBNull 方法、DataTableReader.IsDBNull 方法和 IDataRecord.IsDBNull 方法。

# jquery-mobile - 方向更改事件不起作用

> ID：11103915
> 
> 赞同：3
> 
> 时间：2012-06-19T15:08:16.943
> 
> 标签：jquery-mobile, orientation, screen-orientation

我正在尝试检测移动设备、iphone 和 ipad 中的方向变化。

我正在使用以下代码：

```
 $(window).bind("orientationchange", function (event) {
    alert(event.orientation);

    position = $.event.special.orientationchange.orientation();

    event.preventDefault();
}); 
```

这里警报的值，即 event.orientation 显示为“未定义”，正如我在一些帖子中读到的那样，它确实支持检测方向。同样在 jquery 文档中，它被写入更好地使用“event.orientation”而不是“window.orientation”，但这些都没有返回所需的结果，两者都返回“未定义”。

所以我使用了“$.event.special.orientationchange.orientation();” 来检测方向。

但我想将 jquery 文档中定义的功能用作 event.orientation。如[链接](http://jquerymobile.com/test/docs/api/events.html)

同样在我的代码中，“$.mobile.orientationChangeEnabled”设置为 true，如上面的链接中所示。

请为此建议我任何可能的解决方案。

任何帮助，将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-27T16:15:50.840

老问题，但以防万一其他人遇到它，您必须使用 window.orientation，并以度数表示：

```
portrait: 0
portrait (upside down): 180 
landscape: (counterclockwise): 90
landscape: (clockwise): -90 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-28T09:57:28.037

我有同样的问题。以防万一有人遇到这个问题。试试 window.screen.orientation.type

```
jQuery( window ).on( "orientationchange", function( event ) {
    if(window.screen.orientation.type == 'landscape-primary')
    {

    }
    if(window.screen.orientation.type == 'portrait-primary')
    {

    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-31T23:33:20.957

event.orientation 并不总是设置。我在 IOS Safari 中遇到了这个“未定义”的问题。相反，请尝试使用 window.orientation：

```
//trigger a button click when orientation is changed to landscape mode
$(window).on('orientationchange', function(event) {
    if (window.orientation == 90 || window.orientation == -90) {
        $('.close-button').click();
    }
}); 
```

window.orientation 可以是 0 或 180（纵向模式），或 90 或 -90（横向模式）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T14:01:11.060

尝试这个：

```
$(window).bind('orientationchange',function(){
    if(event.orientation == 'portrait'){
        alert('portrait');
    }
    else if(event.orientation == 'landscape') {
        alert('landscape');
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-13T15:27:12.810

```
$(window).on("orientationchange", function (event) { 
```

# c# - 如何拥有一个 IEnumerable .ToObservableCollection()？

> ID：11103922
> 
> 赞同：2
> 
> 时间：2012-06-19T15:08:39.177
> 
> 标签：c#, wpf

我知道我可以通过做来创建一个`List<T>`from ，但是我怎样才能为一个实现同样的事情呢？`IEnumerable<T>`
`myEnumerableCollection.ToList()``ObservableCollection<T>`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-19T15:11:47.973

您正在寻找的是扩展方法。

您可以像这样扩展[`IEnumerable<T>`](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)类型：

```
namespace myNameSpace
{
    public static class LinqExtensions
    {
       public static ObservableCollection<T> ToObservableCollection<T>(this IEnumerable<T> _LinqResult)
       {
          return new ObservableCollection<T>(_LinqResult);              
       }
    }
} 
```

不要忘记在要使用它的类中添加 using 指令（即`using myNameSpace;`：）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-19T15:11:35.773

为什么你需要投射它？这是常见操作的语法糖。

```
var observableCollection = new ObservableCollection<object>(regularCollection); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T15:14:48.063

这对我有用：

```
 List<string> ll = new List<string> { "a", "b","c" };
 ObservableCollection<string> oc = new ObservableCollection<string>(ll); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T15:11:04.967

您必须创建新的 ObservableCollection 实例，其中填充了您的集合（IEnumerable）。

# jquery - jQuery悬停传播

> ID：11103927
> 
> 赞同：1
> 
> 时间：2012-06-19T15:08:45.383
> 
> 标签：jquery, hover, fadeto

我在悬停图像上使用它：

```
$('.img-style').hover (function(e) {
    var prixPlus = $(this).closest('a').attr('data-prix'); 
    prixPlus = parseFloat(prixPlus);
    var prixNew = prix + prixPlus;

    $('#chgePrix').html(prixNew.toFixed(2));
    $('#txtapart').fadeTo('fast', 0.1);
}, function(e) {
    $('#chgePrix').html(prix.toFixed(2));
    $('#txtapart').fadeTo('fast', 1);
}); 
```

但是，如果我在图像上快速通过鼠标 2 次或更多次，$('#txtapart') 淡入淡出 2 次或更多次！如何停止淡入淡出传播？

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:15:42.267

使用`stop()`方法

```
 $('#txtapart').stop(true,true).fadeTo('fast', 0.1); 
```

这会强制之前的动画结束。这两个`true`参数清除队列并在其终点设置动画，以便在触发其他事件时新动画可以立即开始。

[http://api.jquery.com/stop/](http://api.jquery.com/stop/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:13:00.553

每次鼠标悬停时都会调用该函数。没有很好的方法来检测一个函数是否已经在 J​​avascript 中运行。

# c++ - 此代码中使用 osstreamstring 的潜在问题

> ID：11103935
> 
> 赞同：-3
> 
> 时间：2012-06-19T15:09:26.687
> 
> 标签：c++, ostringstream

下面的代码有问题吗？听说有，但是没找到。。。

```
std::string fun(int i)
{
    std::ostringstream t;
    t<<"My int is "<<i<<returnSomething();
return t.str();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:13:05.573

问题中的代码很好。如果你返回一个指向本地对象的指针（比如你返回了一个`const char*`获取的 as `t.str().c_str()`）或者你返回了一个引用，这将是一个问题。*但是在您的代码中，在函数完成之前*（作为 return 语句的一部分）执行内部字符串的副本，并且在`std::ostringstream`被销毁之前执行，所以没关系。*`t`*

# php - 根据标签从 wordpress 博客中获取最新帖子并将其显示在基础站点中

> ID：11103938
> 
> 赞同：0
> 
> 时间：2012-06-19T15:09:30.490
> 
> 标签：php, wordpress

这对你来说可能是一个简单的问题，但对我来说不是，因为我对 wordpress 真的很陌生，我`Wordpress`在我的网站中设置了博客（我对此很满意），

**我想将**一些帖子从我的 wordpress 博客显示到我的基本站点，我正在环顾四周，但这就像头疼，因为我有成千上万的参考资料，我很困惑，

`i want to display posts from certain tags,`

任何帮助将非常感激。提前致谢

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T20:07:21.493

我使用带有类别参数的名为 rss2html setup 的程序。花费几美元，但您几乎可以用它做任何事情（或通过同一站点上可用的配套程序之一）。我已经使用了很多次，使用配置文件将类别、自定义查询或其他参数传递给它。

如果您选择拿起副本并有配置问题，请大声喊叫，我已经完成了数百个。

你可以在这里找到我使用的程序：[www.feedforall.com](http://www.feedforall.com)

# c# - 如何在 Linq 中进行 Pivot

> ID：11103940
> 
> 赞同：2
> 
> 时间：2012-06-19T15:09:31.567
> 
> 标签：c#, linq, pivot, pivot-without-aggregate

> **可能重复：**
> [我怎样才能为此做一个支点](https://stackoverflow.com/questions/8578547/how-can-i-made-a-pivot-for-this)

我有一个如下提供的表格

```
 ID     |     value     |    Name
--------+---------------+------------------
  1           Digital        Model
  1           companyA       Manufacturer
  2           Analog         Model
  2           CompanyB       Manufacturer
  3           Fiber          Model
  3           CompanyC       Manufacturer

I need to convert this back to 

 ID     |     Model    |     Manufacturer
--------+--------------+-------------------
 1           Digital          companyA           
 2           Analog           CompanyB        
 3            Fiber           CompanyC 
```

请帮助我解决这个问题。使用 T-SQL，我能够正确转换它。但是，使用 Linq，我发现编写 Query 有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:20:46.957

试试这个：

```
 var results = Data.GroupBy(l => l.Name);
            .SelectMany( g => 
                         new 
                         { 
                             Metadata = g.Key, 
                             data = g 
                         });
var pivoted = new List<PivotedEntity>();

foreach(var item in results)
{
    pivoted.Add( 
        new PivotedEntity
        {
            Id  = item.Id,
            Model = item.data.Where(x => x.Name == "Model")
                        .FirstOrDefault().value,
            Manufacturer = item.data.Where(x => x.Name == "Manufacturer")
                         .FirstOrDefault().value,
        });
} 
```

您应该首先定义一个新类：

```
public class PivotedEntity
{
    public int Id {get; set;}
    public string Model {get; set;}
    public string Manufacturer {get; set;}   
} 
```

# usb - 我的手机与 PC 的 USB 网络共享？

> ID：11103944
> 
> 赞同：0
> 
> 时间：2012-06-19T15:09:34.853
> 
> 标签：usb

我正在为我的 android 设备使用 Wi-Fi 连接。这是信号非常周，大部分时间我厌倦了互联网连接不可用。

但是我手里有一台电脑，它是局域网连接的。有没有办法通过 USB 电缆使用这个互联网连接我的手机？

只是想知道这将解决我的问题。如果是，请详细给我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:29:17.357

PC LAN 连接到 Mobile 根本不可能。但是，您可以使用 USB 网络共享在 PC 中使用移动连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T09:33:32.350

是的，有可能。在 Google Play 商店中查找“USB 反向网络共享”。这并不容易，但有可能。

还有另一种方法可以做到这一点，使用“虚拟 WiFi 路由器”，它们将您的计算机用作热点。但是安装时要小心，始终拒绝他们尝试在您的计算机上安装的所有程序。可以在没有广告软件程序的情况下安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-18T14:19:10.913

看看这个。它是 Microsoft 网站上适用于 Windows 7 的 ICS（Internet 连接共享）设置指南：http: [//windows.microsoft.com/en-US/windows-vista/Using-](http://windows.microsoft.com/en-US/windows-vista/Using-) ...

# ruby-on-rails-3 - 为来自多个 GApps 域的用户设计身份验证

> ID：11103945
> 
> 赞同：1
> 
> 时间：2012-06-19T15:09:36.000
> 
> 标签：ruby-on-rails-3, devise, omniauth

我有一个带有 Devise 1.4.9 的 rails 应用程序。目前，它只允许来自 mydomain.com 的用户使用该应用程序。我需要向一些为我工作的承包商开放它。他们的域名是 theirdomain.com。

如何扩展[OmniAuth 指南中的](https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview)这一行以允许来自两个域的用户？

```
config.omniauth :google_apps, :store => OpenID::Store::Filesystem.new('/tmp'), :domain => 'mydomain.com' 
```

也包括“他们的域名.com”。

还有，我该如何为它写一个测试？我已经用 sign_in_user "test" 编写了规范测试，但即使没有 "test@mydomain.com"，它们也通过了。我在他们的域上没有帐户，因此无法轻松测试。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T00:59:30.397

这似乎行不通。我深入研究了 gem 代码，它只支持一个域。

我将改为切换到 open id。

# c# - MVC3 View For 循环值初始化

> ID：11103946
> 
> 赞同：1
> 
> 时间：2012-06-19T15:09:38.757
> 
> 标签：c#, asp.net-mvc-3, razor, viewmodel, asp.net-mvc-views

所以我的视图中有一个 for 循环，它应该渲染出输入框。现在在这些输入框中，我想放置当你点击它们时消失的标签。这一切都很简单。现在可能是因为我的大脑首先是为 php 连接的，并且很难让它以 lambdas 和面向对象的方式思考，但我不知道如何做到这一点：

```
@{ for (int i = 0; i < 3; i++)
               {
                   <div class="editor-label grid_2">User</div>
                   Model.Users[i].UserFirstName = "First Name";
                   Model.Users[i].UserLastName = "Last Name";
                   Model.Users[i].UserEmailAddress = "Email Address";
                <div class="grid_10">
                @Html.TextBoxFor(m => Model.Users[i].UserFirstName, new { @class = "user-input" })
                @Html.TextBoxFor(m => Model.Users[i].UserLastName, new { @class = "user-input" })
                @Html.TextBoxFor(m => Model.Users[i].UserEmailAddress, new { @class = "user-input-long" })
                @Html.CheckBoxFor(m => Model.Users[i].IsUserAdmin)
                <span>&nbsp;admin?</span>
                </div>
                <div class="clear">
                </div>
               }
            } 
```

并为用户初始化值。

而且您可能在想“这当然行不通。您将获得空引用异常”，您是对的。

我可能需要在其他地方初始化它们，但我没有意识到，但我不确定。我已经尝试过 [DefaultValue("First Name")] 路线，但它不起作用。

我可能在想这个错误，但我的大脑已经因为试图弄清楚如何将这些事件连接到控制器而被击中，所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:12:57.323

> 现在在这些输入框中，我想放置当你点击它们时消失的标签

您可以使用 HTML5[`placeholder`](http://davidwalsh.name/html5-placeholder)属性：

```
@Html.TextBoxFor(
    m => m.Users[i].UserFirstName, 
    new { @class = "user-input", placeholder = "First Name" }
) 
```

对于不支持此属性的旧浏览器，请使用 javascript 添加此功能。这是关于此主题的博客文章：http: [//davidwalsh.name/html5-placeholder](http://davidwalsh.name/html5-placeholder)

还有一些示例如何使用元数据直接在视图模型中实现这一点：[https ://stackoverflow.com/a/5824169/29407](https://stackoverflow.com/a/5824169/29407)

# php - 查询返回没有找到的行

> ID：11103950
> 
> 赞同：-1
> 
> 时间：2012-06-19T15:09:54.280
> 
> 标签：php, mysql

我在 PHP 中开发了表单来搜索 MySQL 数据库，但是无论我如何尝试它仍然无法检索到任何结果。而且我在下面的代码中找不到任何语法错误或其他类似问题，

```
 <?php
    $txtkv=$_POST['txtkv'];
    $cbgen=$_POST['txtgenerator'];
    $cbinsulation=$_POST['txtinsulation'];
    $cbclass=$_POST['txtclass'];
    $cbairinlet=$_POST['txtairInlet'];
    $cbip=$_POST['txtIp'];

    // set database server access variables: 
    $host = "localhost"; 
    $user = "root"; 
    $pass = ""; 
    $db = "nordhavn";

    $connection = mysql_connect($host, $user, $pass) or die ("Unable to connect!"); 
    mysql_select_db($db) or die ("Unable to select database!"); 

    $query="SELECT Scania.GensetType, Scania.EngineType, Scania.Engine60Hz, Scania.Alternator,NordhavnGenset.MaxKw,  NordhavnGenset.MaxKva, Scania.PriceEur
    FROM Scania 
    LEFT JOIN NordhavnGenset ON Scania.Alternator=NordhavnGenset.Alternator 
    LEFT JOIN Generator ON Generator.Alternator=Scania.Alternator
    LEFT JOIN Insulation ON Insulation.Insulation=NordhavnGenset.Insulation
    LEFT JOIN Klasse ON Klasse.Klasse=NordhavnGenset.Class
    LEFT JOIN AirInletFilter ON AirInletFilter.AirInletFilter=NordhavnGenset.AirInletFilter
    LEFT JOIN IP ON IP.IP=NordhavnGenset.Ip
    WHERE (NordhavnGenset.MaxKva='".$txtkv."')   and (Generator.Alternator='".$cbgen."')  and (Insulation.Insulation='".$cbinsulation."')  and (Klasse.Klasse='".$cbclass."')  and (AirInletFilter.AirInletFilter='".$cbairinlet."')  and (IP.IP='".$cbip."')";        
    $result = mysql_query($query) or die ("Error in query: $query. ".mysql_error()); 
    $i = 0;
    if (mysql_num_rows($result) > 0) { 
          echo "<table cellpadding=10 border=1>
                <tr>
                    <td>    Gense Type (Scania.GensetType)  </td>
                <td>    Engine type (Scania.Enginetype) </td>
                <td>    Engine 60Hz  (Scania.Engine60hz)</td>
                <td>    Alternator (Scania.Alternator and Genrator.Alternator)  </td>   <td>    Max Kw  (NordhavnGenset.MaxKw)  </td>
                    <td>    Max Kva  (NordhavnGenset.MaxKva)</td>
                    <td>    Price Euro (Scania.PriceEur)    </td>
                </tr>";    
          while(($row = mysql_fetch_row($result)) !== false) { 
                $i++;
                echo "<tr class=\"d".($i & 1)."\">"; 
                echo "<td>"."<center>".$row[1]."</center>"."</td>";
                echo "<td>"."<center>".$row[2]."</center>"."</td>";
                echo "<td>"."<center>".$row[3]."</center>"."</td>";
                echo "<td>"."<center>".$row[4]."</center>"."</td>"; 
                echo "<td>"."<center>".$row[5]."</center>"."</td>";
                echo "<td>"."<center>".$row[6]."</center>"."</td>";
                echo "<td>"."<center>".$row[7]."</center>"."</td>";
                echo "<td>"."<center>".$row[8]."</center>"."</td>"; 
                echo "<td>"."<center>".$row[9]."</center>"."</td>";
                echo "<td>"."<center>".$row[10]."</center>"."</td>";
                echo "<td>"."<center>".$row[11]."</center>"."</td>";
                echo "</tr>"; 
            } 
                echo "</table>"; 
        }else { 
            echo "No rows found!"; 
        }     
    mysql_free_result($result); 
    mysql_close($connection); 
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T15:59:59.623

结果你期待什么，你似乎有很多条件。搜索表单应该为用户提供许多标准，但只有在用户提供某些内容时才使用它们。

例如，不要在一个大查询中一次使用所有条件，而是这样做：

```
$criterias = array("1=1");
if(isset($_POST['txtkv'])){ $criterias[] = 'NordhavnGenset.MaxKva = "'.mysql_real_escape_string($_POST['txtkv']).'"'; }
if(isset($_POST['cbgen'])){ $criterias[] = 'Generator.Alternator = "'.mysql_real_escape_string($_POST['cbgen']).'"'; }
if(isset($_POST['cbinsulation'])){ $criterias[] = 'Insulation.Insulation = "'.mysql_real_escape_string($cbinsulation).'"'; }
if(isset($_POST['cbclass'])){ $criterias[] = 'Klasse.Klasse = "'.mysql_real_escape_string($cbclass).'"'; }
if(isset($_POST['cbairinlet'])){ $criterias[] = 'AirInletFilter.AirInletFilter = "'.mysql_real_escape_string($cbairinlet).'"'; }
if(isset($_POST['cbip'])){ $criterias[] = 'IP.IP = "'.mysql_real_escape_string($cbip).'"'; }

$query = "
SELECT 
    Scania.GensetType, Scania.EngineType, Scania.Engine60Hz, 
    Scania.Alternator,NordhavnGenset.MaxKw, NordhavnGenset.MaxKva, 
    Scania.PriceEur

FROM 
    Scania 
    LEFT JOIN NordhavnGenset ON Scania.Alternator = NordhavnGenset.Alternator 
    LEFT JOIN Generator ON Generator.Alternator = Scania.Alternator
    LEFT JOIN Insulation ON Insulation.Insulation = NordhavnGenset.Insulation
    LEFT JOIN Klasse ON Klasse.Klasse = NordhavnGenset.Class
    LEFT JOIN AirInletFilter ON AirInletFilter.AirInletFilter = NordhavnGenset.AirInletFilter
    LEFT JOIN IP ON IP.IP = NordhavnGenset.Ip

WHERE 
    ".implode(' AND ', $criterias);

$result = mysql_query($query) or die ("Error in query: $query. ".mysql_error()); 
```

这将创建一个仅包含您需要的条件的完整查询。请注意，在顶部，我们创建了标准数组，然后在我们进行时填充所有标准。我们还花时间逃避它们以保护我们在原始请求中没有看到的输入。

然后，使用 IMPLODE，我们将 AND 之间的所有项目整理在一起，以创建标准列表。“1=1”用于防止出现空的 WHERE 子句，以防没有提供标准，但在所有情况下 1=1 始终为真，因此它不会过滤掉任何内容。

我希望这会有所帮助，我希望这真的是你的问题......

祝你好运

# mysql - MySQL 将 48 小时转换为 48:00:00

> ID：11103958
> 
> 赞同：1
> 
> 时间：2012-06-19T15:10:17.510
> 
> 标签：mysql, date

我有一个常规的**DATETIME**行，例如：**2012-06-19 13:56:56**

我正在运行以下命令以查看时差有多少：

```
DATEDIFF(end_time, NOW()) * 24 
```

它返回**48**

编辑：我如何获得分钟/秒？我已经尝试过`UNIXTIME(field) - UNIXTIME(NOW())`，但我无法超越它。

我试图将其转换为**48:00:00**（或者该时间戳有效）

我一直在查找时间函数，但它们与 EXTRACT 有关，我不确定这就是解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:14:03.260

由于 datediff 只返回天数的差异，您不妨只使用字符串操作来进行格式化：

```
SELECT CONCAT(DATEDIFF(end_time, NOW()) * 24), ':00:00') 
```

# c# - 在 GridView 中找到 TextBox

> ID：11103959
> 
> 赞同：1
> 
> 时间：2012-06-19T15:10:26.480
> 
> 标签：c#, asp.net, gridview, webforms

我下面的代码没有找到`textbox`：

```
 protected void AddActivityTextBox_TextChanged(object sender, EventArgs e)
    {
        TextBox tb = (TextBox)sender;
        string ID = tb.UniqueID;
        TextBox tb2 = (TextBox)GvAddActivityData.FindControl(ID);
    } 
```

这是`textbox`来自内部的 a `GridView`，因此我必须使用a`UniqueID`而不是`ID`属性，因为每一行都有`textbox`相同的 a。`ID`

然而`FindControl()`回报`null`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:21:16.193

您不需要找到 TextBox，您已经使用`tb`. TextBox 调用了这个函数，因此是`sender`对象。

任何你能用你做的事情`tb2`都可以用`tb`.

话虽如此，如果您有控件的 UniqueID，您可以使用以下方法找到它`Page.FindControl`：

```
TextBox tb2 = (TextBox)Page.FindControl(ID); 
```

# iphone - iPhone Ipad Dual 应用程序无法弄清楚如何为双应用程序指定 2 个图标

> ID：11103960
> 
> 赞同：0
> 
> 时间：2012-06-19T15:10:33.110
> 
> 标签：iphone, ipad

我正在编写我的第一个双应用程序，但无法弄清楚如何告诉它要使用的 2 个图标我阅读了以下文档

要为您的应用指定图标，请将 CFBundleIcons 键添加到应用的 Info.plist 文件中。该键的内容包括旨在用作主要应用程序图标的文件名列表。文件名可以是您想要的任何名称，但所有图像文件必须为 PNG 格式并位于应用程序包的顶层。当系统需要适当大小的图标时，它会使用密钥中的信息来选择大小最接近预期用途的图像文件。

我无法弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:29:05.223

正如 Dan 提到的，您只需要将图像拖放到适当的框（iPhone 图标框、iPhone Retina 图标框等）中。

不过，您需要适当大小的 PNG。您可以在以下链接中找到有关尺寸的信息：http: [//developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/IconsImages/IconsImages.html](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/IconsImages/IconsImages.html)

此外，如果您使用图像作为元素（UIButton、UINavigationBar 等），最好将 *@2x.png 命名为您的视网膜显示图稿，例如：

navBarBackground.png <- 普通屏幕

navBarBackground@2x.png <- 视网膜屏幕

**编辑：**这样，您的应用程序将自动使用正确的图像文件和正确的屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:14:27.410

如果您使用的是 Xcode 4+，那么您需要做的就是单击项目导航器顶部的项目文件，然后选择您正在构建的目标，然后将您的图标文件拖放到相应的框中摘要视图

# cookies - 使用 JMeter 对受 Siteminder 保护的 Web 应用程序进行负载测试

> ID：11103966
> 
> 赞同：1
> 
> 时间：2012-06-19T15:10:53.200
> 
> 标签：cookies, jmeter, load-testing, siteminder

我目前正在尝试使用 Siteminder 对 Web 应用程序的登录页面进行负载测试以进行访问。我尝试使用 JMeter 的 HTTP cookie 管理器，但没有成功！一直重定向到登录页面！

您是否有此类案例的示例或教程的链接？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-10T11:24:23.890

使用 JMeter 测试受 Siteminder 保护的应用程序并不复杂。您需要使用 HTTP Tracer 来检查在身份验证过程中完成的重定向，然后在 JMeter 中模仿其中的一些。

我有点困惑为什么您设置中的登录页面受 Siteminder 保护，它应该不受保护以允许未经身份验证的用户访问它。

下面的描述适用于需要使用 JMeter 测试受 Siteminder 保护的应用程序的一般情况。

通常，受 Siteminder 保护的应用程序中的身份验证流程如下：

> 1.  请求被发送到受 Siteminder 保护的页面
>     
> 2.  Siteminder 将请求重定向到登录页面
>     
> 3.  用户在登录页面上输入他的用户名/密码
>     
> 4.  在 Siteminder '.fcc' 资源上完成带有用户名/密码和其他一些参数的 POST
>     
> 5.  Siteminder 创建一个会话（添加/更新 SMTOKEN cookie）并执行重定向到上述步骤 1 中访问的页面

我发现了一个简化的场景，可以在 JMeter 中实现以执行身份验证：

> 1.  **上面的第 1 步**：访问受保护的页面（Siteminder 发送重定向到登录页面）
>     
> 2.  **上面的第 4 步**：直接在 Siteminder '.fcc' 资源上发布在您的环境中使用的用户名/密码和其他参数
>     
> 3.  **上面的第 1 步**：再次访问受保护的页面（Siteminder 会话可用并且请求将通过）

就是这样。可以对带有用户名/密码的 POST 请求进行参数化，以使用测试用户池执行测试。

* * *

因此，需要在 JMeter 项目中完成以下工作：

1.  需要将 HTTP Cookie 管理器添加到项目中，以确保 Siteminder 令牌与每个请求一起存储和发送
2.  需要在 Threadgroup 中添加三个 HTTP Request 来实现上面的简化场景。“跟随重定向”选项必须打开。

下面的屏幕截图显示了 JMeter 请求配置以使用用户名/密码参数执行 POST 到“.fcc”资源。

[![JMeter 请求在 Siteminder '.fcc' 资源上执行 POST](../Images/da8c977940da5aef140fd13ef671c767.png)](https://i.stack.imgur.com/TeuG0.png)

身份验证流程在您的设置中可能会很谨慎，只需使用 HTTP Tracer 来查找要在 JMeter 中执行的正确请求序列。

# jquery - jquery：检查图像然后应用 css

> ID：11103967
> 
> 赞同：1
> 
> 时间：2012-06-19T15:10:53.360
> 
> 标签：jquery

如果 relatedProductsArea 不包含图像，则隐藏 div。

```
<div id="RelatedProductsArea" style="border-radius: 7px 7px 7px 7px;"><br clear="all"><div style="clear:both;"></div>
</div> 
```

未找到图像意味着没有相关产品。

**我试过的：**

```
$('#RelatedProductsArea').has('img').css('border', 'none'); 
```

这是一个例子：http: [//jsfiddle.net/K2Cp6/](http://jsfiddle.net/K2Cp6/)

**问题：**如何在我的 jsfiddle 示例中隐藏 div 或删除边框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T15:13:55.037

尝试

```
$('#RelatedProductsArea:not(:has(img))').hide() 
```

您需要使用[`:not()`](http://api.jquery.com/not-selector/)选择器来选择与给定选择器不匹配的元素。在这种情况下，`#RelatedProductsArea`没有`img`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T15:15:03.920

```
$('#RelatedProductsArea:not(:has(img))').css('border', 'none'); 
```

[http://jsfiddle.net/Curt/K2Cp6/1/](http://jsfiddle.net/Curt/K2Cp6/1/)

尝试添加和删除`<img />`元素以`#RelatedProductsArea`进行测试。

> 如果 relatedProductsArea 不包含图像，则隐藏 div。

如果您希望隐藏 div，请使用`.hide()`而不是。`.css('border', 'none')`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T15:13:50.907

```
if($('#RelatedProductsArea img').length)) {
  $('#RelatedProductsArea').hide();
} 
```

**[演示](http://jsfiddle.net/K2Cp6/4/)**

或者

```
$('#RelatedProductsArea').not(':has(img)').hide(); 
```

**[`.not()`](http://api.jquery.com/not)**将过滤`div`没有图像。

**[演示](http://jsfiddle.net/K2Cp6/3/)**

或者

```
$('#RelatedProductsArea').has(':not(img)').css('display', 'none'); 
```

**[演示](http://jsfiddle.net/K2Cp6/2/)**

### 根据编辑

隐藏使用`.hide()`或`.css('display','none')`删除边框使用`.css('border', 'none')`。如果你想要两个

```
.css({
   display: 'none',
   border: 'none'
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T15:15:36.397

```
if($('#RelatedProductsArea').find("img").length == 0)
   $('#RelatedProductsArea').css('border', 'none'); 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-06-19T15:13:14.403

解决方案很简单：

```
$('#RelatedProductsArea').not('img').css('border', 'none'); 
```

# android - 轮询 ACTION_BATTERY_LOW

> ID：11103969
> 
> 赞同：4
> 
> 时间：2012-06-19T15:10:54.513
> 
> 标签：android, battery

当电池电量不足时，Android 将发送一个 ACTION_BATTERY_LOW 意图。然后当它再次正常时，它会发送 ACTION_BATTERY_OKAY。

不幸的是，如果我的应用程序在电池电量不足时启动*，*那么我不会收到意图；它不粘，所以我无法检测当前是否存在电池警报。ACTION_BATTERY_CHANGED*是*粘性的，但它只告诉我当前的电池充电状态，而不是系统是否已宣布低电量警报。

有没有办法在任何给定的时刻检测电池是否电量不足？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-06T22:12:51.243

这是一个非常棘手的问题。Android Developer 上的相关代码有错误。

基本上，您可以在此链接上了解如何检测它：

[https://developer.android.com/training/monitoring-device-state/battery-monitoring.html](https://developer.android.com/training/monitoring-device-state/battery-monitoring.html)

您可以使用 OnReceive(Context context, Intent intent){} 方法通过广播接收器检测它是否正在充电和电池电量不足

但是，这个链接有一个错误，用于监控重大变化。[注意这里，动作名称是android.intent.action.ACTION_BATTERY_LOW]

[1]

但是让我们看看它是如何在 Intent 中描述的。

ACTION_BATTERY_LOW

在 API 级别 1 中添加字符串 ACTION_BATTERY_LOW 广播操作：指示设备上的电池电量不足。该广播对应于“低电量警告”系统对话框。

这是一个只能由系统发送的受保护意图。

常量值：“android.intent.action.BATTERY_LOW” 你可以在 Android Developers Intent 中找到它。

换句话说，这里发生了错误。它应该是 action.BATTERY_LOW 而不是 action.ACTION_BATTERY_LOW。所以你在 AndroidManifest 中的代码应该是：

```
<receiver android:name=".receiver.BatteryLevelReceiver">
        <intent-filter>
            <action android:name="android.intent.action.BATTERY_LOW"/>

            <!--instead of android.intent.action.ACTION_BATTERY_LOW-->
        </intent-filter>
    </receiver> 
```

还要确保您的接收器正确。

```
public class BatteryLevelReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {

        Toast.makeText(context, "BAttery's dying!!", Toast.LENGTH_LONG).show();
        Log.e("", "BATTERY LOW!!");

} 
```

}

在笔记本电脑上调试或登录很困难，使用 Toast 可能会有所帮助。

```
 Toast.makeText(context, "BAttery's dying!!", Toast.LENGTH_LONG).show();
        //Toast.makeText(Context context, String str, Integer integer).show(); 
```

希望它有助于解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T15:38:25.577

粘性意图仍然包含一些信息。您仍然应该能够获得电池电量

```
int level = battery.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);
int scale = battery.getIntExtra(BatteryManager.EXTRA_SCALE, -1);

float batteryPct = level / (float)scale; 
```

取自[http://developer.android.com/training/monitoring-device-state/battery-monitoring.html](http://developer.android.com/training/monitoring-device-state/battery-monitoring.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T15:32:55.750

通常低电量警告出现在 15% 时，因此您可以检查电池电量是否等于或低于 15%。

# php - 如何找出以前调用的类？

> ID：11103970
> 
> 赞同：1
> 
> 时间：2012-06-19T15:10:56.523
> 
> 标签：php, late-static-binding

我有一个包含许多子类的基类，以及一个用于缓存函数结果的通用函数。在缓存函数中，我如何确定调用了哪个子类？

```
class Base {
  public static function getAll() {
    return CacheService::cached(function() {
      // get objects from the database
    });
  }
}

class X extends Base {}
class Y extends Base {}
class Z extends Base {}

class CacheService {
  function cached($callback) {
    list(, $caller) = debug_backtrace();

    // $caller['class'] is always Base!
    // cannot use get_called_class as it returns CacheService!

    // see if function is in cache, otherwise do callback and store results
  }
}

X::getAll();
Z::getAll(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:36:00.390

如果您使用的是 PHP >= 5.3，则可以使用[`get_called_class()`](http://us3.php.net/manual/en/function.get-called-class.php).

**编辑：**为了更清楚，`get_called_class()`必须在您的`Base::getAll()`方法中使用。当然，您随后必须告诉`CacheService::cached()`报告的是哪个类（添加方法参数将是最直接的方式）：

```
class Base {
  public static function getAll() {
    return CacheService::cached(get_called_class(), function() {
      // get objects from the database
    });
  }
}

class X extends Base {}
class Y extends Base {}
class Z extends Base {}

class CacheService {
  function cached($caller, $callback) {
    // $caller is now the child class of Base that was called

    // see if function is in cache, otherwise do callback and store results
  }
}

X::getAll();
Z::getAll(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T15:14:58.380

尝试使用魔法常数`__CLASS__`

**编辑：**像这样：

```
class CacheService {
  function cached($class, $callback) {
    // see if function is in cache, otherwise do callback and store results
  }
}

class Base {
  public static function getAll() {
    return CacheService::cached(__CLASS__, function() {
      // get objects from the database
    });
  }
} 
```

**进一步编辑：**使用 get_call_class：

```
class CacheService {
  function cached($class, $callback) {
    // see if function is in cache, otherwise do callback and store results
  }
}

class Base {
  public static function getAll() {
    return CacheService::cached(get_called_class(), function() {
      // get objects from the database
    });
  }
} 
```

# delphi - TPaintBox 转 JPEG/BMP - 缓冲区

> ID：11103975
> 
> 赞同：3
> 
> 时间：2012-06-19T15:11:12.327
> 
> 标签：delphi, graphics, delphi-7

我有一个油漆盒，我画了一个像这样的 TBitmap：

```
procedure MyForm.PaintBoxPaint(Sender: TObject); // ONPAINT
begin
 PaintBox.Canvas.Lock;
 MyBitMap.Canvas.Lock;
 PaintBox.Canvas.Draw(0, 0, MyBitMap);
 PaintBox.Canvas.UnLock;
 MyBitMap.Canvas.UnLock;
end; 
```

我想从 PaintBox 中“映射”/“复制”一个 JPEG 或 BMP。我必须首先考虑一些挑战。第一件事是我想将 JPEG 或 BMP 保存到支持 WidePath/WideFileName 的文件中。我使用 Delphi 7 和 .SaveToFile 程序只支持 AnsiPaths/AnsiFileNames。接下来是我想制作一个独立于“MainGUI Thread”的副本。因此，当 GUI 将副本保存在后台时（所以没有 TTimer），GUI 应该仍然处于活动状态并绘制到画框。最后一件事是“副本”的实际文件名。我想设置一个从 1.jpg ... 到 2.jpg ... 到 N.jpg 的计数器 问题是整数的计数，由于每个函数都试图增加计数器，这可能导致访问冲突。

我的想法如下：

保存线程的结构：

```
type
 PTRTSaveImage = ^TSaveImage;
 TSaveImage = record
 Number : Integer;
 Pic    : TBitMap;
end; 
```

实际的 SaveImageThread：

```
function SaveImageToHDD ( p : pointer ) : Integer; stdcall;
var
 jpg      : TJpegImage;
 jpgStr   : TStringStream;
 _infos   : TSaveImage;
begin
 CopyMemory(@_infos, p, SizeOf(_infos));
 jpg    := TJpegImage.Create;
 jpgStr := TStringStream.Create ('');
 jpg.assign (_infos.Pic);
 _infos.Pic.Free;
 jpg.SaveToStream(jpgStr);
 jpg.Free;
 StrToFile ('C:\' + inttostr(_infos.Number) + '.jpg',0,jpgStr.DataString); // for WidePath/WideFileName Support.
 jpgStr.Free;
end; 
```

这就是我所说的线程：

```
procedure MyForm.PaintBoxPaint(Sender: TObject); // ONPAINT
var
 Saving : PTRTSaveImage;
 BackUp : TBitMap;
begin
 PaintBox.Canvas.Lock;
 MyBitMap.Canvas.Lock;
 PaintBox.Canvas.Draw(0, 0, MyBitMap);
 BackUp := TBitMap.Create;
 BackUp.Assign (MyBitMap); // Immediate copy of the actual drawing! 
 Saving   := PTRTSaveImage(LocalAlloc(LPTR, SizeOf(TSaveImage)));
 Saving^.Pic    := BackUp;
 Saving^.Number := Counter;
 inc (Counter);
 PaintBox.Canvas.UnLock;
 MyBitMap.Canvas.UnLock;
end; 
```

它拍了几张照片就好了，但是调试器向我显示了一个异常：

调试器故障通知项目 C:....exe 出现错误消息：“应用程序定义的异常（代码 0x0eedfade）在 0x759d9617”。进程停止。使用 Step 或 Run 继续。

有没有“更好的方法”来做到这一点？同时保存和绘图...？！

谢谢你的帮助。

编辑：

然后我还考虑只制作 1 个线程来代替 TTimer，如下所示：

```
function SaveImages ( p : TMyForm ) : Integer; stdcall
var
 jpg    : TJpegImage; 
 jpgStr : TStringStream;
begin
while true do begin   // ---> constant LOOP that saves pictures in the intervall
 sleep (1000);        // Intervall
 jpg    := TJpegImage.Create;
 jpg.assign (p.MyBitMap);
 jpgStr := TStringStream.Create ('');
 jpg.SaveToStream(jpgStr);
 jpg.Free;
 StrToFile ('C:\' + inttostr(p.Counter) + '.jpg',0,jpgStr.DataString); // for WidePath/WideFileName Support.  
 inc (p.Counter);  
 jpgStr.Free;
end;
end; 
```

但会发生相同的错误/异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T16:41:13.767

AVI 文件...我确实想知道...我会创建一个从 TPaintBox 派生的新 Paintbox 控件。（你可能已经这样做了？）

添加一个计数器属性和代码，使用 BitBlit 将画布捕获为 Bmp，然后创建一个线程以将位图转换并保存为 jpg，并在计数器**启动**时递增计数器。（您将需要使用 Synchronize 进行该调用）。将其命名为 CaptureCanvas。

最后添加一个名为 say afterChange 或 afterTimePeriod 的方法，该方法调用 captureCanvas。确保您试一试......最后确保位图和 Jpeg 在保存出现任何问题时被销毁。然后它都在一个地方（在 TNewPaintbox 内，如果它落后了，那么正在创建的图像已经有了它们的索引，你不会把它们乱序保存......只是一个想法:)

抱歉意味着添加表单代码将简化为：

```
Form1.Paintboxpaint()
begin
.
.
PaintBox.Canvas.Draw(x, y, bitmap);
Paintbox.AfterChange;
. 
```

抱歉简洁，编辑答案，看不到原帖

# eclipse - 如何国际化java源代码？

> ID：11103976
> 
> 赞同：5
> 
> 时间：2012-06-19T15:11:14.060
> 
> 标签：eclipse, internationalization, antlr, abstract-syntax-tree

**编辑**：我完全重写了这个问题，因为我的前两个版本似乎不够清楚。**感谢您迄今为止的建议。**

我想国际化教程项目的**源代码**（请注意，不是运行时应用程序）。这是一个示例（在 Java 中）：

```
/** A comment */
public String doSomething() {
  System.out.println("Something was done successfully");
} 
```

用英语，然后让法语版本类似于：

```
/** Un commentaire */
public String faitQuelqueChose() {
  System.out.println("Quelque chose a été fait avec succès.");
} 
```

等等。然后在某处有一个属性文件之类的东西来使用常用工具编辑这些翻译，例如：

```
com.foo.class.comment1=A comment
com.foo.class.method1=doSomething
com.foo.class.string1=Something was done successfully 
```

对于其他语言：

```
com.foo.class.comment1=Un commentaire
com.foo.class.method1=faitQuelqueChose
com.foo.class.string1=Quelque chose a été fait avec succès. 
```

我试图找到最简单、最有效和不引人注目的方法，用最少的人工繁重的工作（除了明显地翻译实际文本）来做到这一点。最好在 Eclipse 下工作。例如，原始代码将用英语编写，然后外部化（到属性，最好保持原始源不变），翻译（人工）然后重新生成（作为单独的源文件/项目）。

我发现的一些小径（除了 AlexS 建议的）：

*   [AntLR](http://www.antlr.org/)，一种语言解析器/生成器。似乎有一个支持的[Eclipse 插件](http://www.antlr.org/wiki/display/ANTLR3/Integration+with+Development+Environments#IntegrationwithDevelopmentEnvironments-%C2%A0Eclipse33forAntlr3x)
*   使用[Eclipse 的 AST](http://www.eclipse.org/articles/article.php?file=Article-JavaCodeManipulation_AST/index.html#sec-how-to-apply-changes)（抽象语法树），我猜想构建某种插件。

我只是很惊讶没有一个工具可以做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T15:28:27.327

我会使用唯一的字符串作为方法名（或任何你想被本地化版本替换的东西。

```
public String m37hod_1() {
  System.out.println(m355a6e_1);
} 
```

然后我会为每种语言定义一个属性文件，如下所示：

```
m37hod_1=doSomething
m355a6e_1="Something was done successfully" 
```

然后我会编写一个小程序来解析源文件并替换字符串。所以一切都在日食之外。

或者我也会使用 ant 任务[Replace](http://ant.apache.org/manual/Tasks/replace.html)和 propertyfiles，而不是独立的翻译程序。像这样的东西：

```
<replace 
    file="${src}/*.*"
    value="defaultvalue"
    propertyFile="${language}.properties">
  <replacefilter 
    token="m37hod_1" 
    property="m37hod_1"/>
  <replacefilter 
    token="m355a6e_1" 
    property="m355a6e_1"/>
</replace> 
```

使用其中一种方法，您无需在教程中解释任何有关本地化的内容（除非您愿意），但可以专注于您的真正主题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T11:03:06.393

你想要的是一个庞大的代码更改引擎。

ANTLR 不会成功；AST 是必要的，但还不够。请参阅我关于[解析后的生活](http://www.semanticdesigns.com/Products/DMS/LifeAfterParsing.html)的文章。如果 Eclipse 包对名称和类型解析提供一些支持，Eclipse 的“AST”可能会更好；否则你将永远无法弄清楚如何替换每个“doSomething”（可能是重载的或本地的），除非你愿意*全部*替换它们（你可能不能这样做，因为有些符号是指 Java库元素）。

我们的[DMS 软件再造工具包](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)可用于完成您的任务。DMS 可以将 Java 解析为 AST（包括注释捕获），以任意方式遍历 AST，分析/更改 AST，并将修改后的 AST 导出为有效源代码（包括注释）。

基本上，您想枚举所有注释、字符串和标识符声明，将它们导出到外部“数据库”以映射（手动？通过谷歌翻译？）到等价物。在每种情况下，您不仅要注意感兴趣的项目，还要注意其精确位置（源文件、行、甚至列），因为在原始文本中拼写相同的项目在修改后的文本中可能需要不同的拼写。

如果你有 AST，那么枚举字符串非常容易；只需爬取树并查找包含字符串文字的树节点。（ANTLR 和 Eclipse 也确实可以做到这一点）。

如果您拥有的解析器捕获了评论，那么评论的枚举也很简单。DMS 可以。我不太确定是 ANTLR 的 Java 语法还是 Eclipse AST 引擎；我怀疑他们都有能力。

声明（类、方法、字段、局部变量）的枚举相对简单；有更多的情况需要担心（例如，匿名类包含对基类的扩展）。您可以编写一个过程来遍历 AST 并匹配树结构，但这是 DMS 开始发挥作用的地方：您可以编写看起来像您想要匹配的源代码的表面语法模式。例如：

```
 pattern local_for_loop_index(i: IDENTIFIER, t: type, e: expression, e2: expression, e3:expression): for_loop_header
         = "for (\t \i = \e,\e2,\e3)" 
```

将匹配本地 for 循环变量的声明，并返回 IDENTIFIER、类型和各种表达式的子树；您只想捕获标识符（及其位置，可以通过从 DMS 在每个树节点上标记的源位置信息中获取 if 轻松完成）。您可能需要 10-20 个这样的模式来涵盖所有不同类型标识符的情况。

捕获步骤完成，需要将所有捕获的实体翻译成您的目标语言。我把它留给你；剩下的就是把翻译后的实体放回去。

关键是精确的源位置。行号在实践中不够好；您可能在同一行中有多个翻译的实体，在最坏的情况下，一些具有不同的范围（例如嵌套 for 循环）。注释、字符串和声明的替换过程很简单；重新扫描树中与任何已识别位置匹配的节点，并用其翻译替换在那里找到的实体。（您可以使用 DMS 和 ANTLR 执行此操作。我认为 Eclipse ADT 需要您生成“补丁”，但我想这会起作用。）。

有趣的部分在于替换标识符*uses*。为此，您需要知道两件事：

*   对于标识符的任何*使用，声明的用途是什么；*如果您知道这一点，则可以将其替换为声明的新名称；DMS 提供完整的名称和类型解析以及使用列表，使这变得非常简单，并且
*   重命名的标识符是否在与原始标识符不同的范围内相互影响？一般来说，这更难做到。但是，对于 Java 语言，我们有一个“阴影”检查，因此您至少可以在重命名后确定您有问题。（甚至还有一个重命名程序可以用来解决这种阴影冲突

修补树后，您只需使用 DMS 的内置漂亮打印机将修补的树重写为源文件。我认为 Eclipse AST 可以写出它的树和补丁。我不确定 ANTLR 是否提供了从 AST 重新生成源代码的任何工具，尽管有人可能已经为 Java 语法编写了一个工具。由于所有挑剔的细节，这[比听起来更难做到。](https://stackoverflow.com/questions/5832412/compiling-an-ast-back-to-source-code/5834775#5834775)YMMV。

鉴于您的目标，我有点惊讶您不希望包含“class foo { ... }”的源文件“foo.java”重命名为.java。这不仅需要将转换后的树写入翻译后的文件名（非常容易），甚至可能需要重建目录树（DMS 也提供了用于进行目录构建和文件复制的工具）。

如果您想为多种语言执行此操作，则需要为每种语言运行一次该过程。如果您只想为字符串执行此操作（经典的国际化案例），您可以通过调用具有唯一资源 ID 的资源访问来替换每个字符串（需要更改，并非所有字符串都需要更改）；运行时表将保存各种字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T19:26:48.823

一种方法是用一种语言完成代码，然后翻译成其他语言。

您可以使用 Eclipse 来帮助您。

1.  将完成的代码复制到特定语言的项目中。
2.  然后：
    *   **标识符：**在大纲视图（窗口>显示视图>大纲）中，选择每个项目并重构>重命名（Alt+Shift+R）。这负责重命名标识符，无论它在哪里使用。
    *   **评论**：使用*搜索>文件*查找“/*”或“//”的所有实例。单击每个并修改。
    *   **字符串**：
        1.  使用*Source>Externalize* strings 查找所有文字字符串。
        2.  搜索>“Messages.getString()”文件。
        3.  单击每个结果并进行修改。
        4.  在每个文件上，“编辑>查找/替换”，将“//\$NON-NLS-.*\$”替换为空字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-16T14:42:41.023

[您可以使用freemarker](http://freemarker.org/)模板（或其他模板语言，例如[velocity](http://velocity.apache.org/) ）编写代码。

做某事.tml

```
/** ${lang['doSomething.comment']} */
public String ${lang['doSomething.methodName']}() {
    System.out.println("${lang['doSomething.message']}");
} 
```

lang_en.prop

```
doSomething.comment=A comment
doSomething.methodName=doSomething
doSomething.message=Something was done successfully 
```

然后在构建过程中将模板与每个语言属性文件合并（使用 Ant / Gradle / Maven 等）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-19T15:16:22.310

使用 .properties 文件，例如：

```
Locale locale = new Locale(language, country);
ResourceBundle  captions= ResourceBundle.getBundle("Messages",locale); 
```

这样，Java 会根据当前本地（从操作系统或 Java 区域设置获取）选择 Messages.properties 文件

该文件应该在类路径上，称为 Messages.properties（默认文件），或 Messages_de.properties 用于德语等。

完整教程请参见：http: [//docs.oracle.com/javase/tutorial/i18n/intro/steps.html](http://docs.oracle.com/javase/tutorial/i18n/intro/steps.html)

就源代码而言，我强烈建议使用英语。像 getUnternehmen() 这样的方法名称对于普通开发人员来说比普通的英文名称更糟糕。如果您需要让外国开发人员熟悉您的代码，请用他们的语言编写适当的开发人员文档。

如果您想要英语和其他语言的 Javadoc，请参阅此[SO 线程](https://stackoverflow.com/questions/3389459/how-to-provide-the-javadoc-in-other-languages)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-19T15:17:47.103

对于打印/记录的字符串，java 拥有一些国际化功能，即 ResourceBundle。[oracle网站上](http://docs.oracle.com/javase/tutorial/i18n/TOC.html)有一个关于这个的教程

Eclipse 也为此提供了功能（我记得是“外部化字符串”）。

对于函数名称，我不认为有任何问题，因为这将需要您维护许多版本的代码源...

问候

# clojure - def的clojure行为

> ID：11103980
> 
> 赞同：3
> 
> 时间：2012-06-19T15:11:19.800
> 
> 标签：clojure, leiningen

我有一个 lein 项目（使用 cascalog——但这并不是特别重要）。我正在尝试将诸如文件路径之类的属性外部化，因此最终得到的代码如下所示：

```
(defn output-tap [path] (hfs-textline (str (get-prop :output-path-prefix) path) :sinkmode :replace))

(def some-cascalog-query 
    (<- [?f1 ?f2 ?f3] 
        ((output-tap (get-prop :output-path)) ?line)
        (tab-split ?line :> ?f1 ?f2 ?f3))) 
```

在上面的例子中，假设函数`get-prop`存在；它只是使用标准 java 来读取属性值（基于此示例：[在 clojure 中加载配置文件作为数据结构](https://stackoverflow.com/questions/7777882/loading-configuration-file-in-clojure-as-data-structure)）。

现在我有一个加载属性值的主要方法，例如：

```
(defn -main [& args] (do (load-props (first args)) (do-cascalog-stuff))) 
```

但是当我`lein uberjar`得到一个编译时错误说：

```
Caused by: java.lang.IllegalArgumentException: Can not create a Path from an empty string
at org.apache.hadoop.fs.Path.checkPathArg(Path.java:82)
at org.apache.hadoop.fs.Path.<init>(Path.java:90)
at cascading.tap.hadoop.Hfs.getPath(Hfs.java:343) 
```

defs 是否总是在编译时评估（而不是运行时评估）？还是我误解了这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T16:35:56.307

那么，您希望在运行时进行属性查找吗？那么是的，您需要定义`some-cascalog-query`为函数或宏。bare`def`导致在加载代码时评估表达式，而不是在取消引用 var 时。

这可以在 REPL 中非常简单地说明：

```
user=> (def foo (do (println "Hello, world!") 1))
Hello, world!
#'user/foo
user=> foo
1 
```

从[文档](http://clojure.org/special_forms)（强调我的）：

> **（定义符号初始化？）**
> 
> 使用符号名称和当前命名空间 ( *ns* ) 的值的命名空间创建和实习或定位一个全局变量。*如果提供了 init，则对其进行评估，并将 var 的根绑定设置为结果值。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T16:11:33.397

该错误看起来像`(get-prop :output-path)` `(get-prop :output-path-prefix)`什么都没有返回，它被包装成一个空字符串`str`。也许没有找到该属性？

get-prop 是否按预期工作？

您对 defs 的理解是正确的，它们是编译时，而不是（通常）运行时。

# git - 对于我们的 2 人网络团队来说，理想的 Git 工作流程是什么？

> ID：11103990
> 
> 赞同：2
> 
> 时间：2012-06-19T15:11:39.360
> 
> 标签：git, version-control, workflow, git-workflow

我们正在寻找使用 GIT 来帮助管理我们的 Web 文件，因为我们刚刚聘请了第二位开发人员。

我们不会使用 GitHub，但我们确实有一个 NAS 驱动器（共享驱动器），所以我们最初的想法是这样的某种计划：

*   DVCS（根）
    *   主控（NAS）
        *   项目一
        *   项目 2
    *   开发者1 (NAS)
        *   项目一
        *   项目 2
    *   开发者2 (NAS)
        *   项目一
        *   项目 2
    *   developer1（本地工作站）
        *   项目一
        *   项目 2
    *   developer2（本地工作站）
        *   项目一
        *   项目 2

所以基本上每个开发人员都会将主项目存储库克隆到他们的开发人员存储库（质量控制），然后他们会将这个开发人员存储库克隆到他们的本地存储库。他们将进行更改/编辑，然后提交并将这些更改推送回他们的开发人员存储库，以供高级开发人员批准。一旦他们这样做，就会被推送给主人。

我不确定这是否是正确的方法，或者我是否应该使用分支，或者我需要不同的工作流程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:54:36.253

这个问题没有“正确”的答案。适合您和您的团队的工作流程就是正确的工作流程。

话虽如此，如果您只有两个开发人员，我不确定您为什么觉得需要多个裸存储库。在这种情况下，最简单的做法是：

1.  在您的 NAS 上拥有一个中央存储库。

    *   用于集成开发代码的主分支。
    *   开发人员处理主题以合并到 master 的功能分支。
    *   用户私有分支，开发人员可以在其中推送内容以进行备份或挑选，但可以自由进行变基或强制推送。
    *   已发布代码的稳定分支（如果适合您的模型）。如果他们进行持续交付，一些商店只需要在 master 上标记。
2.  开发人员将克隆存储在他们的工作站上，而不是存储在网络驱动器上。

    *   在 NAS 丢失数据或离线时提供冗余。
    *   允许未集中存储或不属于项目历史的一次性分支。

小型团队通常不需要拉取请求模型的复杂性。你的旅费可能会改变。

# objective-c - NSDate 和 CFGregorianDate 有什么区别？

> ID：11103991
> 
> 赞同：1
> 
> 时间：2012-06-19T15:11:44.777
> 
> 标签：objective-c, ios

我有一些我正在从 iPhone 转换到 iPad 的 Objective-C 代码。CFGregorianDate 始终用于日期函数。我从未使用过它，更喜欢使用 NSDate。

我想获取日期并对其进行格式化，以便使用格式字符串“MMMM”获得完整的月份名称，而使用 CFGregorianDate 似乎无法做到这一点。

两者有什么区别，在使用上有什么不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:14:45.587

从[文档](https://developer.apple.com/library/mac/#documentation/CoreFoundation/Reference/CFDateRef/Reference/reference.html)：

> CFDate 与其对应的 Cocoa 基金会 NSDate 是“免费桥接”。这意味着 Core Foundation 类型在函数或方法调用中可以与桥接的 Foundation 对象互换。换句话说，在你看到 NSDate * 参数的方法中，你可以传入一个 CFDateRef，而在你看到 CFDateRef 参数的函数中，你可以传入一个 NSDate 实例。这也适用于 NSDate 的具体子类。

~~所以，在使用上没有区别，真的。主要区别在于 CFDate 及其子类是遗留类型。~~

但是，正如已经指出的那样，`CFGregorianDate`与`CFDate`. 它不存储时间戳，而是将年、月、日、小时、分钟和秒存储为单独的整数。

所以最好的办法是创建一个方法，`cfGregorianToNSDate:`在其中解析这些整数并构造一个新`NSDate`对象。

# ios - ShareKit 导致我的 iOS 应用程序崩溃？

> ID：11103994
> 
> 赞同：0
> 
> 时间：2012-06-19T15:11:55.247
> 
> 标签：ios, crash, sharekit, viewdidload

我刚刚在 iTunes Connect 中出现了一个崩溃报告，所以我已经将它加载到 Xcode 中，这对我来说象征着它。

相关部分是：

```
Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x323e188f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x34437259 objc_exception_throw + 33
2   CoreFoundation                  0x323e1789 +[NSException raise:format:] + 1
3   CoreFoundation                  0x323e17ab +[NSException raise:format:] + 35
4   Bitrate Tester                  0x00048435 0x0001a435
5   Bitrate Tester                  0x00031473 -[FirstViewController viewDidLoad] (FirstViewController.m:27) 
```

毫不奇怪，FirstViewController 是我的应用程序显示的第一个视图控制器，这意味着它`[FirstViewController viewDidLoad]`基本上是我的应用程序中调用的第一个实际方法。因此，以前调用错误的可能性不大。

现在，`viewDidLoad`看起来是这样的：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    DefaultSHKConfigurator *configurator = [[MySHKConfigurator alloc] init];
    [SHKConfiguration sharedInstanceWithConfigurator:configurator];
    [SHK setFavorites:[NSArray arrayWithObjects:@"SHKFacebook",@"SHKTwitter",@"SHKMail",nil] forType:SHKShareTypeText];
} 
```

第 27 行是

```
 [SHKConfiguration sharedInstanceWithConfigurator:configurator]; 
```

那么，ShareKit 是否会导致我的应用程序崩溃？请注意，我无法在我的任何设备上重现该问题（我在 iOS 模拟器、iOS 5.1.1 上的 iPhone 4、iOS 5.1.1 上的 iPad 2 和 iOS 5.1 上的 iPhone 3GS 上进行了测试。 1）。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T19:36:32.127

我认为您的应用程序中调用的第一个方法是 applicationDidFinishLaunchingWithOptions: 在您的应用程序委托中，而不是 viewDidLoad。

有时会发生，您的视图被卸载（例如，由于内存不足），然后再次加载。这次配置器可能会被加载两次，这很糟糕。

因此，解决方案可能是将 ShareKit 配置移动到 applicationDidFinishLaunchingWithOptions，如[配置 wiki](https://github.com/ShareKit/ShareKit/wiki/Configuration)中所述。此方法保证只被调用一次。

# jquery - jQuery .load 的回调函数中 textStatus 参数的所有可能值是多少？

> ID：11103995
> 
> 赞同：13
> 
> 时间：2012-06-19T15:11:55.400
> 
> 标签：jquery

如果方法的参数等于某个字符串，我正在利用 jQuery 的[.load](http://api.jquery.com/load/)方法的回调函数来运行某些代码。`textStatus``.load`

**例如我有**

```
jQuery("#myContainer").load('/seperate-file-with-content.asp', function(responseText, textStatus, xhr){                     
    if (textStatus === "error" || responseText.length <= 0) {
        //file failed to load i.e. textStatus == error 
        //or file loaded but has no content
    } else {
        //file loaded successfully i.e. textStatus == success
    }       
}); 
```

但我担心语句的`else`一部分可能会捕获其他不等于的`if`非预期值。`textStatus``success`

**`error`除了和之外，textStatus 是否还有其他可能的值`success`？**

**编辑/更新：**正如我现在认为`.load`的那样`.ajax`，以下问题中的答案可能对其他有类似问题的人有用：-[在 jQuery 的 ajax 成功回调中， textStatus 永远不会是“成功”吗？](https://stackoverflow.com/questions/3461491/in-jquerys-ajax-success-callback-will-textstatus-ever-not-be-success?rq=1)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-19T15:15:10.657

`load()`基于[$.ajax()](http://api.jquery.com/jQuery.ajax/)，该方法的文档列出了可能的状态：

*   `abort`
*   `error`
*   `notmodified`
*   `parsererror`
*   `success`
*   `timeout`

# jquery - 使用 jquery 跳过特定 tr 的条带表组

> ID：11103997
> 
> 赞同：0
> 
> 时间：2012-06-19T15:11:59.190
> 
> 标签：jquery, css

我一直在敲这个头太久了。

我有一个基本表（除了那些包含 th 的所有 TR 都是带有 classme 的类）

```
<table>
<tr class="classme"><td>1</td></tr>
<tr class="classme"><td>1a</td></tr>
<tr class="classme"><td>2</td></tr>
<tr class="classme"><td>2a</td></tr>
<tr><th>skip me</th></tr>
<tr class="classme"><td>3</td></tr>
<tr class="classme"><td>3a</td></tr>
<tr ...><td>4</td></tr>
<tr ...><td>4a</td></tr>
<tr ...><td>5</td></tr>
<tr><td>5a</td></tr>
<tr><td>8</td></tr>
<tr><td>8a</td></tr>
<tr><td>9</td></tr>
<tr><td>9a</td></tr>
<tr><td>10</td></tr>
<tr><td>10a</td></tr>
<tr><th>skip me</th></tr>
<tr><td>11</td></tr>
<tr><td>11a</td></tr>
<tr><td>12</td></tr>
<tr><td>12a</td></tr>
</table> 
```

我想用 tr 背景颜色条纹。

我正在使用 jQuery 并在这里找到了一些帖子，Google 与剥离有关，但未能找到跳过任意行的内容。

我已经尝试...

```
$("tr:nth-child(4n)").addClass("alt").prev().addClass("alt"); 
```

效果很好，但它计算了我想跳过的那些。

和

```
$("tr:not(tr th):nth-child(4n)").addClass("alt").prev().addClass("alt"); 
```

没有运气。我什至试图为结果分配一个变量

```
var trs = $(".classme"); 
$(trs + ":nth-child(4n)").addClass("alt").prev().addClass("alt"); 
```

但它仍然计算错误地应用了样式。

如何设置一组选定元素，以便在将添加类放在元素上时我要排除的行不在计数中？

**编辑：** 我想条纹（在表格示例中）1,1a,3,3a,5,5a。所以我认为 1 和 1a 是一个组。我想删除其他所有组。

**编辑：** 用[jsFiddle更新](http://jsfiddle.net/pgNpY/1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:30:52.197

试试这个：

```
var rows=   $('.classme:last').nextAll().not(':has(th)');
rows.filter(':even').addClass('evenClass) 
```

现在编辑 .skips lower th 标签

演示[http://jsfiddle.net/YXDMH/](http://jsfiddle.net/YXDMH/)

编辑：所有行不`TH`包括

```
var rows=   $('tr').not(':has(th)');
rows.filter(':even').addClass('evenClass').end().filter(':odd').addClass('odd') 
```

[http://jsfiddle.net/YXDMH/1/](http://jsfiddle.net/YXDMH/1/)