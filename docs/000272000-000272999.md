# StackOverflow 问答 000272000-000272999

# vba - 在 ms-access 数据库中验证用户

> ID：272003
> 
> 赞同：3
> 
> 时间：2008-11-07T13:02:02.797
> 
> 标签：vba, ms-access, authentication, ms-office

我有一个 MS-access 数据库。但它在共享驱动器上。并且要求只有选定数量的人才能使用它。有没有办法对用户进行身份验证？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T13:08:05.127

是的，打开数据库然后运行工具->安全->用户级安全向导。它将引导您完成创建新工作组文件、创建用户和组以及保护访问对象的过程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T13:37:35.220

由于 Access 是文件驱动的，为什么不在共享驱动器中创建一个文件夹并将文件夹权限分配给适当的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T15:26:46.547

**两者都做。**设置目录的访问权限并为其创建一个新的安全文件。

目录是您的前线安全，并在宏观层面限制访问

安全文件可用于对各种表格、表单、报告等的访问进行分段。您甚至可以将它授予某些人只读访问权限和其他人更完整的权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T13:31:56.480

Access 2007 中不提供用户级安全性。

[开始使用 Access 2007 安全](http://office.microsoft.com/en-us/access/HA101980471033.aspx)产品：

*   信任（启用）数据库中的禁用内容
*   使用密码加密或解密数据库
*   打包、签名和部署 Office Access 2007 数据库

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T13:43:59.983

如果您在域上，您是否可以不使用文件级安全性来阻止用户访问它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T19:34:28.480

我在 VBA 中完成所有这些工作。在交换机 Form_Open 子中，使用 windows API 将用户名读入字符串变量，然后检查用户名是否在您的有效用户列表中。如果 OK，则发出欢迎消息，如果不是 OK，则退出 Access。

' 检查用户 Dim user As String Dim AuthorizedUser As Boolean user = UCase(CurrentUser())

```
AuthorizedUser = True
Select Case user
    Case "USER_A":
    Case "USER_B":
    Case "USER_C":     
    Case Else: AuthorizedUser = False
End Select

If AuthorizedUser = True Then
   MsgBox "Welcome authorized user " & user
Else
   MsgBox user & "is not Authorized. For access to this database contact User_A"
   DoCmd.Quit
End If 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-11-07T15:11:53.033

两种解决方案：

1.  将 Access 文件放在具有适当权限设置的文件共享上。如果您需要提供只读访问权限，这将无法正常工作，因为 Access 无法写出它在打开 Access 文件 (.mdb) 时创建的临时 .ldb 文件。

2.  将 Access 文件的“数据”移动到 Sql Server 实例中......您可以在 SQL Server 中授予权限以限制人们可以执行的操作。我们使用这种方法为每个人提供只读访问权限，然后为特定人员提供读写访问权限。要将数据移动到 SQL，您可以将其导入新的 SQL 数据库，然后将表链接到 Access 文件（重命名以便报告/查询/等继续工作）。

# clickonce - 修改clickonce的安装弹窗

> ID：272004
> 
> 赞同：3
> 
> 时间：2008-11-07T13:02:33.543
> 
> 标签：clickonce

解决了 clickonce 部署的问题后，客户询问我们是否可以修改安装顺序并美化它们。任何人都可以阐明如何自定义 clickonce 初始安装程序的外观和感觉吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T19:52:45.167

您是在谈论用户必须访问以安装应用程序的初始页面 (publish.htm) 吗？如果是这样，它只是一个 html 页面，您可以根据需要进行编辑。

如果您正在谈论用户必须单击过去才能安装您的应用程序的安全警告，那么您需要使用客户端机器信任的证书对清单文件进行签名。这个 MSDN 链接有一些关于如何做到这一点的信息。

[http://msdn.microsoft.com/en-us/library/ms996418.aspx](http://msdn.microsoft.com/en-us/library/ms996418.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T13:09:58.990

安装后，您可以通过代码进行所有更新，但我从未找到跳过初始安装弹出窗口的方法。

# asp.net - 使用 JavaScript 和 jQuery 获取嵌入式 ASP 对象的 ID

> ID：272007
> 
> 赞同：1
> 
> 时间：2008-11-07T13:03:11.983
> 
> 标签：asp.net, jquery, datagridview, drop-down-menu, css-selectors

[当ASP.NET](http://en.wikipedia.org/wiki/ASP.NET) (2.0) 下拉列表的更改事件由 jQuery 处理时，我正在使用 jQuery 尝试触发方法。问题是下拉列表位于网格视图内，即使这样，只有当用户决定编辑该网格视图中的一行时。

我想我让它使用 ASP 代码块来拾取对象，但问题是当页面第一次加载时，行的编辑索引不存在并且会引发错误。将块放在`IF`语句中也不起作用。

```
$(document).ready(function() //when DOM is ready, run containing code
{
    <% if (grvTimeSheets.EditIndex > -1) {%>
        $(#<%=grvTimeSheets.Rows[grvTimeSheets.EditIndex].FindControl("ddlClients").ClientID %>).change(function() {
             $(#<%= grvTimeSheets.ClientID %>).block({ message: null }
        });
}
);
<% } %> 
```

这是我的一次尝试，我还尝试将 IF 语句 ASP 代码放在 JavaScript 块之外。它也不起作用。

如何将 jQuery 事件应用到 drop drop 框？理想情况下尽可能简洁。

* * *

感谢您的回答，但不，它不起作用:(。JavaScript代码似乎没有被输出......令人困惑......

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="jquery.tablesorter.js"></script>
<script type="text/javascript" src="jquery.blockUI.js"></script>
<script type="text/javascript">
    $(document).ready(function() //When DOM is ready, run the containing code
    {

    }
    );
</script> 
```

是输出。即使这是代码：

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="jquery.tablesorter.js"></script>
<script type="text/javascript" src="jquery.blockUI.js"></script>
<script type="text/javascript">
    $(document).ready(function() //when DOM is ready, run containing code
    {<% if (grvTimeSheets.EditIndex > -1) {%>
        var id = '#<%=grvTimeSheets.Rows[grvTimeSheets.EditIndex].FindControl("ddlClients").ClientID %>';
        $(id).change(function() {
             $(id).block({ message: null }
        });
     <% } %>
    }
    );
</script> 
```

以前也是这样，让我发疯。

* * *

对不起，你能说得清楚一点吗？我尝试在后面的代码中定义整个事情，如下所示：

```
DropDownList ddl (DropDownList)grvTimeSheets.Rows[grvTimeSheets.EditIndex].FindControl("ddlClients");
if (ddl != null)
{
    ClientScriptManager csm = Page.ClientScript;
    Type cstype = this.GetType();
    String csname1 = "PopupScript";

    string script = @"
    <script language='javascript' type='text/javascript'>
    $(#" + ddl.ClientID + ").change(function() { $(" + grvTimeSheets.ClientID + ").blockUI({ message: null }});} </script>";
          csm.RegisterStartupScript(cstype, csname1, script, true);
} 
```

这是你的意思吗？

顺便说一句，以上没有奏效。没有错误，只是没有任何事件起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T14:54:19.560

这里有几件事。

1.  当您将选择器传递给`$()`函数时，您需要将它们用引号括起来。上面的代码片段会生成类似 的东西`$(#some-generated-id)`，但它不起作用。
2.  服务器端的右花括号 if 语句在 onready 函数之外。它需要嵌套在与开头 if 相同的级别。

试试这个：

```
$(document).ready(function() //when DOM is ready, run containing code
{
  <% if (grvTimeSheets.EditIndex > -1) {%>
      var id = '#<%=grvTimeSheets.Rows[grvTimeSheets.EditIndex].FindControl("ddlClients").ClientID %>';
      $(id).change(function() { 
           $(id).block({ message: null }
        }); 
 <% } %>
}
); 
```

如果它不起作用，请继续粘贴生成的 javascript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T17:04:27.923

我使用[Page.ClientScript](http://msdn.microsoft.com/en-us/library/system.web.ui.page.clientscript.aspx)属性注册了一个脚本块以包含我需要使用 jQuery 访问的任何 ID。

这是我在外部文件中的 JavaScript 示例：

```
var myFancySelector = '#' + myControlId;
selectedValue = $(myFancySelector).val(); 
```

myControlId 是从后面的代码中定义的，并在 ClientScriptBlock 中注册。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T17:13:05.863

用这个：

```
cs.RegisterClientScriptBlock(cstype, csname, cstext2.ToString(), False) 
```

不创建脚本标签是错误的，因为您包含它们。MSDN 文档在解释标志的方式上是错误的。

此外，只需将控件的客户端 ID 与后面的代码（而不是[jQuery](http://en.wikipedia.org/wiki/JQuery)代码）放在单独的变量中。

然后在 jQuery 代码中使用包含 id 的变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T17:31:52.893

在您在后面的代码中创建的脚本块内：

```
string script = @"<script type=text/javascript> var myControlId = '" + ddl.ClientId  "';") + "</script>" 
```

我没有验证这个语法，但它应该很接近。您可以自己添加附加语法`grvTimeSheets.ClientID`。如果你得到这个工作，那么你可能想要改变它来构建一个 JavaScript 数组并以这种方式存储 ClientId，然后你只有一个需要使用的全局 JavaScript 变量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T17:34:26.600

另一种选择是只为您正在寻找的元素提供描述其行为的类名。然后你的 jQuery 代码变得非常清晰：

```
$(function() {
    $("select.yourMarkerClass").change(....);
}); 
```

如果没有编辑行，则此代码不执行任何操作。如果存在与选择器匹配的元素，您将获得添加的新行为。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T17:34:30.080

如果您没有在页面的其他地方使用相同的 ID，则可以使用 jQuery 的高级选择器之一来阻止[ASP.NET的 UniqueID：](http://en.wikipedia.org/wiki/ASP.NET)

```
$('[id$=ddlClients]') 
```

这仅匹配 id 字符串的结尾而不是整个字符串。请记住，如果控件在不同的行中多次出现，这将匹配所有实例。

有关更多示例，请参见*[选择器。](http://docs.jquery.com/Selectors)*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T17:24:13.563

密钥可以是您想要的任何东西，但它应该是唯一的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T17:28:12.683

周末后我会尝试更多。不过，这是代码：

```
DropDownList ddl = (DropDownList)grvTimeSheets.Rows[grvTimeSheets.EditIndex].FindControl("ddlClients");
if (ddl != null)
{
    ClientScriptManager csm = Page.ClientScript;
    Type cstype = this.GetType();
    String csname1 = "PopupScript";

    string script = @"
    <script language='javascript' type='text/javascript'>
    jQuery(#" + ddl.ClientID + ").change(function() { $(" + grvTimeSheets.ClientID + ").blockUI({ message: null }});} </script>";
    csm.RegisterStartupScript(cstype, csname1, script, false); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-07T18:03:18.400

因为你在每一行都有一个下拉菜单。每个下拉菜单都有一个唯一的 ClientId，所以我建议按照 Ben 的建议进行操作并使用类选择器，因为它是最简单的解决方案。

或者，您可以在编辑单击时创建一个 JavaScript 函数，然后在正在编辑的那一行中获取下拉列表的唯一客户端 ID。

抱歉，我应该仔细阅读您的代码。

# php - 寻找最好的 PHP 嵌套集类（PEAR 类除外）

> ID：272010
> 
> 赞同：6
> 
> 时间：2008-11-07T13:04:19.440
> 
> 标签：php, class, nested, set, nested-sets

我正在寻找具有所有需要功能的 PHP（使用 MYSQL）嵌套集类。例如：

createLeftNode、createRightNode、createRootNode、createSubNode、deleteNode 和**moveTree**。不仅是一左一右，一上一下，而且是另一棵树中的一棵树的一部分。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T14:27:34.793

看看Doctrine的[嵌套行为](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/behaviors.html#nesting-behaviors)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T13:48:21.860

如果您正在处理分层数据，那么嵌套良好的集合非常有用。仅使用 php 数组实现它要复杂得多，特别是如果您想将这些信息保存在数据库中。

你可以试试这个。从未使用过它，但经过简短的代码筛选后，它看起来几乎完成了。

[http://www.edutech.ch/contribution/nstrees/index.php](http://www.edutech.ch/contribution/nstrees/index.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T14:34:59.007

有一些新的东西：[http ://www.sidelis.org/baobab/](http://www.sideralis.org/baobab/)

* * *

旧的和过时的答案。不再支持该库。

我在一个项目中使用了发布的**nstrees 库**“buggzzy”（[http://www.edutech.ch/contribution/nstrees/index.php](http://www.edutech.ch/contribution/nstrees/index.php)），我必须让用户能够创建和编辑他公司的组织结构图.

我非常喜欢“ **Modified Preorder Tree Traversal** ”算法，但在我看来 nstree 库很慢。就我而言，我必须递归地遍历树。也许这是我脚本中的其他内容，速度很慢。

无论如何，我还在寻找替代方案，我最近检查了 PEAR 网站，在那里也找到了一个树库：http: [//pear.php.net/package/Tree](http://pear.php.net/package/Tree)

PEAR 库似乎不像 NSTREE 那样全面，但我认为它的性能可能更高。

一篇对这个问题帮助很大的文章：[Storing Hierarchical Data in a Database](http://www.sitepoint.com/article/hierarchical-data-database/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-23T20:34:08.907

看看这个库[https://github.com/fpietka/Zend-Nested-Set](https://github.com/fpietka/Zend-Nested-Set)： *与 Zend 框架一起使用的嵌套集模型的实现*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-29T14:57:36.317

姗姗来迟，但我更新了[https://github.com/fpietka/Zend-Nested-Set](https://github.com/fpietka/Zend-Nested-Set)（即使有单元测试）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-06T20:37:23.910

我编写了一个嵌套集实现，它使用 Doctrine DBAL 作为数据库抽象层。因为我们将它与 Drupal 一起使用，所以它还跟踪一个`revision_id`.

[https://github.com/previousnext/nested-set](https://github.com/previousnext/nested-set)

# c# - C# Float vs. VB.net Single - Namin'抱怨'

> ID：272013
> 
> 赞同：25
> 
> 时间：2008-11-07T13:06:18.450
> 
> 标签：c#, vb.net, naming-conventions

为什么它在 VB.net 中被称为单曲？我确信这是有充分理由的，但对于像我这样未经正式培训的程序员来说，这似乎并不直观。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-07T13:38:10.603

BPAndrew 的问题似乎真的是“为什么在 C# 中浮动而在 VB.NET 中是单一的”，实际上没有人回答，所以这是我的 2p ...

在 C# 中使用“float”似乎是对其 C/C++ 传统的回归。“float”仍然映射到 C# 中的 System.Single 类型，因此关键字只是为了方便而存在。您可以像在 VB.NET 中一样在 C# 中将变量声明为“Single”。

（如上所述，将它们命名为 Single/Double 实际上更有意义，因为它们是单/双精度浮点数。）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-07T14:18:58.960

正如其他人所说，它们映射到“单”和“双”精度二进制浮点类型。就我个人而言，我认为只是命名`System.Single`和匹配整数类型是一个侧面步骤`System.Double`- 为什么不`System.Float32`匹配`System.Float64`整数类型？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-07T13:12:46.830

原因是 single 和 double 都是浮点数。

single 是单精度浮点数（32 位）
的缩写 double 是双精度浮点数（64 位）的缩写

因此，调用浮点数 float 是模棱两可的。

[http://en.wikipedia.org/wiki/Single_precision](http://en.wikipedia.org/wiki/Single_precision)
[http://en.wikipedia.org/wiki/Double_precision](http://en.wikipedia.org/wiki/Double_precision)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T13:08:21.880

我认为这是一个`shorthand`for `"Single-precision"` `Double`is "`Double-precision"`

虽然`C-style int`和`float`可能指的是`"integer"`和`"floating point"`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-04T13:53:56.857

我想为命名约定添加我的假设。

在 Java 和 C# 诞生的 C/C++ 词中，int/long 和 float/double 可能会根据其所在的体系结构（32 位或 64 位）而有所不同。

在 Java 和 C# 等可移植 VM 语言中，这些类型不会改变，因此命名约定*可以*反映这一点。或者它可能只是上一代程序员最舒服的东西。或者我们可以为所有内容创建别名，让每个人为所欲为！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T13:11:23.153

技术名称是“单精度浮点”，“单”是因为它在内存中占用一个单词（32 位）。与此同时，在大多数架构上，double 占用 64 位。

# sharepoint - 如何限制可以访问 SharePoint 网站集的用户数量？

> ID：272028
> 
> 赞同：5
> 
> 时间：2008-11-07T13:10:48.847
> 
> 标签：sharepoint, wss

我们正在实施一个托管的 Windows SharePoint Services 3.0 系统，我需要限制客户可以授予网站集访问权限的用户数量。客户应该能够管理他的整个网站集。他应该只是不能删除网站集本身或将超过给定数量的用户添加到网站集和子网站。

似乎使用 WSS 2.0，您可以使用配额模板限制网站集中的用户数量。在 WSS 3.0 中，您仍然可以使用配额模板限制网站集的大小，但不能限制用户数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T10:34:49.293

没有标准的方法来限制可以添加到站点的用户数量。并非没有严重的黑客攻击或从用户那里删除功能。

不能消除问题，只能管理它：

*   将*peoplepicker-onlysearchwithinsitecollection*属性与 Stsadm.exe 一起使用，以将人员选取器限制为仅返回已添加到网站集中的用户。
*   当宿主授予用户访问网站集的权限时，宿主必须将用户添加到该网站集。

站点所有者仍然可以使用其完全限定名称或 SAM 帐户名称将其他用户添加到站点。

您可以定期向 SharePoint 查询添加到网站集的用户数（使用 SPWeb 类的 SiteUsers 属性）。如果添加的数量超过指定的限制，您可以通知某人或自动删除用户或其他方式。

希望未来版本的 SharePoint 和 WSS 将具有更细粒度的权限模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T20:52:13.160

我不知道任何开箱即用的东西。您可以通过编写自定义 wsp 以编程方式实现相同的目的。我在这种方法中发现的唯一问题是网站集管理员可以撤回或删除解决方案，即使您隐藏了您的功能。

顺便说一句，我们的客户想要限制并发用户，我们使用 Session Provider 以编程方式做到了这一点

# c# - 影子复制，以及从任意文件夹加载的混合 C# 和 C++ DLL

> ID：272030
> 
> 赞同：3
> 
> 时间：2008-11-07T13:12:04.367
> 
> 标签：c#, c++, dll, shadow-copy

我有一个 VS 2005 C# 项目，它使用一个特殊的插件文件夹来加载额外的 DLL（用作资产转换过程中的节点）。

我在这个文件夹中混合了 C# 和 C++ DLL。

我遇到的问题是，当启用影子复制时，C++ DLL 拒绝使用 Assembly.LoadFrom 加载。我试图创建一个自定义应用程序域，并使用了 Load，但这也失败了。

最后，我尝试将 DLL 作为 byte[] 数据读取并在其上使用 Load - 再次，只有 C# DLL 会以这种方式工作，并出现错误“附加信息：无法验证的代码未能通过策略检查。（来自 HRESULT 的异常：0x80131402） ”。

网上的一篇文章提示我在构建该特定 DLL 时尝试使用 /clr:safe，但由于 Microsoft 代码中的数千个错误，它根本无法构建......（显然）

禁用影子复制后，LoadFrom 对所有 DLL 都可以正常工作。该应用程序本身是 Maya 的插件，它曾经与 Maya 8.5 一起使用，但在 2008 / 2009 中失败（如果启用了 Shadow Copying）。

我们真的更喜欢使用影子复制，因为它可以在应用程序运行时防止 DLL 文件锁定（插件文件夹存储在 Perforce 可以在应用程序运行时更新的位置）。

关于如何说服 Shadow Copying 使用自定义文件夹和 C#/C++ DLL 的混合而没有这些问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T14:52:55.303

听起来像是信任问题。尝试获取 Fusion 日志（请参阅[此博客文章](http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx)）。您的 C++ DLL 无法验证，因为它们不是用 编译的`/clr:safe`，因此它们只能作为完全信任加载。大概在卷影复制时，下载缓存位置没有完全信任。

如果这是一个仅用于开发的问题，运行`caspol -s`可能会让您启动并运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-01T10:18:17.353

Assembly.Load(byte[] ...) 明确禁止无法验证的（混合模式）程序集。您可以在[Microsoft Connect](https://connect.microsoft.com/VisualStudio/feedback/details/97801/loading-mixed-assembly-with-assembly-load-byte-throw-exception-changed-behaviour)上检查问题。

# c# - 如何获取与文件类型关联的图标？

> ID：272035
> 
> 赞同：7
> 
> 时间：2008-11-07T13:16:55.700
> 
> 标签：c#, icons, file-association

我有一个在 TabControl 中显示文件信息的表单，我希望页面在其选项卡中包含文件的图标。如何获取与文件类型关联的图标？

我更喜欢不涉及在注册表中查找内容的解决方案，但如果这是唯一的方法，那就这样吧。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-07T13:23:38.417

[CodeProject](http://www.codeproject.com/KB/dotnet/System_File_Association.aspx)有一些你可以下载的类。

首先得到`FileAssociationInfo`，然后从中得到`ProgramAssociationInfo`。该`pai`对象可以为您提供图标。

```
FileAssociationInfo fai = new FileAssociationInfo(".bob");
ProgramAssociationInfo pai = new ProgramAssociationInfo(fai.ProgID);
ProgramIcon icon = pai.DefaultIcon; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-07T13:30:16.437

[System.Drawing.Icon.ExtractAssociatedIcon（字符串文件路径）](http://msdn.microsoft.com/en-us/library/system.drawing.icon.extractassociatedicon.aspx)

# c++ - Windows 2000 的 GetProcessID 的替代方法

> ID：272036
> 
> 赞同：4
> 
> 时间：2008-11-07T13:17:08.693
> 
> 标签：c++, windows, winapi

我不小心使用[GetProcessID](http://msdn.microsoft.com/en-us/library/ms683215(VS.85).aspx)从应用程序中删除了 Win2K 兼容性。

我像这样使用它来获取已启动应用程序的主要 HWND。

```
ShellExecuteEx(&info); // Launch application
HANDLE han = info.hProcess; // Get process

cbinfo.han = han;

//Call EnumWindows to enumerate windows....
//with this as the callback

static BOOL CALLBACK enumproc(HWND hwnd, LPARAM lParam)
{
  DWORD id;
  GetWIndowThreadProcessID(hwnd, &id);
  if (id == GetProcessID(cbinfo.han))
    setResult(hwnd)
 ...
} 
```

任何想法如何在 Win2K 上实现相同的功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T13:36:57.437

有一个“不支持的”函数：ZwQueryInformationProcess()：见

[http://msdn.microsoft.com/en-us/library/ms687420.aspx](http://msdn.microsoft.com/en-us/library/ms687420.aspx)

给定句柄，这将为您提供进程 ID（除其他外）。这不能保证适用于未来的 Windows 版本，所以我建议有一个帮助函数来测试操作系统版本，然后使用 GetProcAddress() 来调用 XP 及更高版本的 GetProcessId() 和 ZwQueryInformationProcess() 仅用于 Win2K .

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-10T06:32:09.337

大卫K是对的。请参阅 ZwQueryInformationProcess 文档中的注释：

> [ZwQueryInformationProcess 可能在未来版本的 Windows 中被更改或不可用。应用程序应使用本主题中列出的替代功能。]

这意味着微软可以选择在未来的任何时候删除它，从而破坏你的应用程序。我强烈认为您遵循 DavidK 的建议并在不支持 GetProcessID 的操作系统上使用 ZwQueryInformationProcess 并在支持它的操作系统上使用 GetProcessID（XP SP1 及更高版本）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-11T10:32:08.323

感谢 DavidK 和 Larry - 这是我的最终解决方案。完整的错误处理留给读者练习。

请注意，我不是专门检查操作系统版本，而是尝试动态链接到函数。静态链接意味着如果该过程不可用，应用程序将无法加载。

这已在 Win2K 和 Vista 上成功尝试过：

```
#include "Winternl.h"

typedef DWORD (WINAPI* pfnGetProcID)(HANDLE h);

typedef NTSTATUS (WINAPI* pfnQueryInformationProcess)(
    HANDLE ProcessHandle,
    PROCESSINFOCLASS ProcessInformationClass,
    PVOID ProcessInformation,
    ULONG ProcessInformationLength,
    PULONG ReturnLength);

DWORD MyGetProcessId(HANDLE h)
{
    static pfnQueryInformationProcess ntQIP = (pfnQueryInformationProcess) GetProcAddress(GetModuleHandle("NTDLL.DLL"),"NtQueryInformationProcess");
    static pfnGetProcID getPId  = (pfnGetProcID) GetProcAddress(GetModuleHandle("KERNEL32.DLL"),"GetProcessId");

    if ((ntQIP == NULL) && (getPId == NULL))
        throw Exception("Can't retrieve process ID : GetProcessID not supported");

    if (getPId != NULL)
        return getPId(h);
    else
    {
        PROCESS_BASIC_INFORMATION info;
        ULONG returnSize;
        ntQIP(h, ProcessBasicInformation, &info, sizeof(info), &returnSize);  // Get basic information.
        return info.UniqueProcessId;
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-07T16:56:48.737

不，这不是 ZwQueryInformationProcess() 它是 NtQIP，当然它适用于 NT 3.5 以来的所有版本，您根本不需要测试操作系统

# list - 有条件地包装 HTML 元素

> ID：272038
> 
> 赞同：0
> 
> 时间：2008-11-07T13:20:05.960
> 
> 标签：list, jsf, seam

在我的 Seam 应用程序中，我有一个 Seam 组件，它返回一个 ( `@Datamodel`) 我想要转换为一组`<li>`HTML 元素的项目列表。我有这个工作没有问题。

但是现在，我想根据 EL 表达式拆分列表。因此 EL 表达式确定是否`<ul>`应该启动一个新元素。我尝试了以下方法：

```
<s:fragment rendered="#{action.isNewList(index)}">
  <ul>
</s:fragment>
<!-- stuff that does the <li>'s goes here -->
<s:fragment rendered="#{action.isNewList(index)}">
  </ul>
</s:fragment> 
```

但这是无效的，因为 for 的嵌套`<ul>`是错误的。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T13:51:19.460

您可以使用 JSF`<f:verbatim>`标记来执行此操作，这不是很漂亮，但很有效：

```
<f:verbatim rendered="#{action.isNewList(index)}">
  &lt;ul&gt;
</f:verbatim>
<!-- stuff that does the <li>'s goes here -->
<f:verbatim rendered="#{action.isNewList(index)}">
  &lt;/ul&gt;
</f:verbatim> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T15:48:52.437

我不熟悉 Seam 框架，但如果我正确理解了这个问题，这样的事情可能会奏效。

```
<!-- before your loop, open your first <ul> if the (@Datamodel) is not empty -->

<s:fragment rendered="#{action.isNewList(index)}">
  </ul>
  <ul>
</s:fragment>
<!-- stuff that does the <li>'s goes here -->

<!-- after your loop, close your last </ul> if the (@Datamodel) is not empty --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T15:56:43.513

我对 Seam 并不特别熟悉，但我在使用 XSLT 和其他基于 XML 的框架时也看到过同样的问题。

一般有两种解决方案：

1.  重新考虑您的页面和数据架构，以便根据单个条件编写整个列表。这可能需要 s:fragment 内的循环。
2.  将有问题的无效片段 html 包装在 <![CDATA[ ... ]]> 中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T22:20:07.747

你应该有这样的东西（我将使用伪代码）：

```
<ul>
    <s:for items="itemList" ...>

      <s:fragment rendered="#{action.isNewList(index) && index > 0}">
        </ul>
        <ul>
      </s:fragment>
      <li>
        <!-- stuff that does the <li>'s goes here -->
      </li>

    </s:for>
</ul> 
```

# python - Django中的用户身份验证

> ID：272042
> 
> 赞同：2
> 
> 时间：2008-11-07T13:21:04.740
> 
> 标签：python, django

有什么方法可以确保一个用户只登录一次？

我想避免两个不同的人使用相同的登录名/密码登录系统。

我想我可以通过在登录用户之前检查 django_session 表来自己完成，但如果已经有这样的功能，我更喜欢使用框架。

干杯，

感谢您的回复！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T13:37:07.110

通过 HTTP 登录两次是不明确的。没有发送“断开”信号。如果你不小心，你可能会让人们感到沮丧。

如果我关闭浏览器并意外删除了 cookie，则可能会阻止我再次登录。

服务器如何知道是我尝试重新登录还是我尝试登录两次？

您可以尝试检查 IP 地址等操作。如果意外断开连接是我的路由器崩溃，释放我的 DHCP 租约怎么办？现在我正在尝试重新登录，但我有一个新地址并且没有建立 cookie。我不是想创建第二个会话，我只是想在当前会话断开后重新开始。

关键是对于可以安装在框架中的“单个会话”没有完善的规则。您必须制定适合您的应用程序的规则并弄清楚如何执行它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T15:39:19.970

我去年做的一个网站担心用户名/密码可能会发布到论坛上。我通过向登录视图添加一个模型和一个检查来处理这个问题，该视图查看过去 X 小时内使用了多少个唯一 IP。我在 settings.py 中为站点管理员提供了两个值来调整小时数和唯一 IP 的数量。如果一个名称被“过度使用”，它将被阻止从新 IP 登录，直到有足够的时间低于阈值。

令他们惊讶的是，去年他们只有一个名字触发了封锁，结果证明是公司总裁出差并不断从新位置登录。

附言。代码很简单。如果您愿意，请通过 techbuddy 的 peter 给我发电子邮件。

# sql - 如何删除一个表中在另一个表中有对应记录的所有记录

> ID：272045
> 
> 赞同：4
> 
> 时间：2008-11-07T13:23:48.883
> 
> 标签：sql, mysql, sql-server

我有两个表 A 和 B。我想从表 A 中删除以下查询中返回的所有记录：

```
SELECT A.*
FROM A , B
WHERE A.id = B.a_id AND
    b.date < '2008-10-10' 
```

我试过了：

```
DELETE A 
WHERE id in (
    SELECT a_id 
    FROM B 
    WHERE date < '2008-10-10') 
```

但这仅在内部选择实际上返回一个值时才有效（如果结果集为空则无效）

**注意：**这必须适用于**SQLServer 和 MySQL**

编辑：更多信息

上述删除在 SQLServer 上 100% 有效

在 MySQL 上运行它时，我收到一条“SQL 语法错误”消息，指出 SELECT 的开始是问题。如果我用 (1,2) 替换内部选择，那么它可以工作。

*@Kibbee您是对的，内部选择是否返回行实际上没有区别。*

*@Fred 我收到“不是唯一的 table.alias: a”消息*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T13:40:18.087

我认为这应该有效（无论如何都适用于 MySQL）：

```
DELETE a.* FROM A a JOIN B b ON b.id = a.id WHERE b.date < '2008-10-10'; 
```

没有别名：

```
DELETE A.* FROM A JOIN B ON B.id = A.id WHERE B.date < '2008-10-10'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T13:32:21.503

我不确定为什么你的方法失败了。如果内部查询返回一个空集，那么第一个查询也应该返回一个空集。我不认为@Fred 的解决方案是正确的，因为他似乎加入了错误的专栏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T14:28:44.260

或者您可以切换到带有相关子查询的存在语法......

```
Delete A 
From A
Where Exists 
      (Select * From B 
       Where B.Id = A.Id
         And B.date < '2008-10-10'); 
```

根据查询优化器的智能程度（以及子查询将返回表 B 中的记录数），这可能会更快，因为存在不需要完全生成完整的结果集......它可以尽快停止因为它找到了一条记录...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T13:29:00.793

你离答案不远了！

已编辑后：删除表 A 和 B 上的别名

```
DELETE FROM A
WHERE A.id in (
    SELECT B.a_id 
    FROM B
    WHERE B.date < '2008-10-10'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T14:00:23.210

您还可以在子表中使用 ON CASCADE，以便在父表中删除一行时，它会自动删除子表中的子行。这样，当父行被删除时，您就不必担心参照完整性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T14:06:43.073

```
delete from a inner join b on a.id = b.a_id and b.date < '2008-10-10' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-10T08:47:42.560

MYSQL 和 MSSQL 中的另一种选择，但要做到这一点还有很长的路要走：

```
select b.ID
into #T
from 
    [Table b] with (nolock) 
where 
  b.date > '2008-10-10'

if exists (select * from #T with (nolock))
    delete from [Table a] where a.id in (select id from #T with (nolock))
    drop table #T 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-07T13:46:19.977

根据您对 DELETE 语句的描述，您还想删除表 A 中的空孤儿吗？

```
删除 A.*
从一个
在 A.id = B.a_id AND b.date > '2008-10-10' 上左连接 B
哪里 b.id 为空

```

（请注意B中的倒装方式）

在这种情况下应该做的伎俩。我不确定 MSSQL 如何处理连接删除，但我想它应该以相同的方式工作。

# sql-server - 如何将 BIDS 解决方案置于源代码控制之下？

> ID：272090
> 
> 赞同：7
> 
> 时间：2008-11-07T13:41:39.427
> 
> 标签：sql-server, visual-studio, version-control, business-intelligence

我开始使用 Microsoft BI 套件：Analysis services 2005、Business Intelligence Development Studio 2005 等。当然，我的第一个愿望是为我的 .NET 项目设置相同的源代码控制/自动化测试环境。

但是分析服务（dwproj、cube、dim、ds、dsv）和集成服务（dtsx）使用的 xml 文件对源代码控制不友好。它们不仅将实际数据与图表坐标等表示细节混合在一起，而且还经常在 Visual Studio 保存时重新格式化。这会在 TortoiseSVN 中导致完全无用的差异，其中一半文件已更改，但您无法理解位置和原因。

你怎么解决这个问题？是否有适合该工作的特定系统/插件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-10T02:34:07.557

我们在[BIDS Helper](http://www.codeplex.com/bidshelper)（一个免费的开源插件）中有一个功能，它可以执行“智能差异”。我们无法停止正在进行的所有重新格式化，但智能差异功能会尽可能多地去除演示细节，这通常可以让您看到任何更改的重要细节。我知道它适用于 Source Safe 和 TFS，我不知道是否有人尝试过 SVN。

# .net - .net 动态刷新 app.config

> ID：272097
> 
> 赞同：29
> 
> 时间：2008-11-07T13:44:03.570
> 
> 标签：.net, app-config

如何在 .net Windows 应用程序中动态重新加载 app.config？我需要动态地打开和关闭日志记录，而不仅仅是基于应用程序启动时的值。

ConfigurationManager.RefreshSection("appSettings") 不起作用，我也尝试使用 OpenExeConfiguration 显式打开配置文件，但我总是在应用程序启动时获得缓存值，而不是当前值。

我已经接受了创建自定义配置部分的答案。作为一个旁注和愚蠢的错误 - 如果您从 IDE 运行，那么更新 app.config 文件并期待更改是没有意义的。必须修改 bin\debug 文件夹中的 .exe.config 文件。嗬！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-07T13:48:58.910

您可以按照您所说的方式刷新**自己的部分：**

```
ConfigurationManager.RefreshSection("yoursection/subsection"); 
```

只需将记录真/假移动到一个部分，你会没事的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-07T13:52:08.327

如果您使用的是 log4Net，您可以按照您的要求进行操作：

尽管可以将 log4net 配置设置添加到项目`app.config`或`web.config`文件中，但最好将它们放在单独的配置文件中。除了可维护性的明显好处之外，它还有一个额外的好处，即 log4net 可以`FileSystemWatcher`在您的配置文件中放置一个对象以监控它何时更改并动态更新其设置。

要使用单独的配置文件，请将名为 Log4Net.config 的文件添加到您的项目中，并将以下属性添加到您的 AssemblyInfo.cs 文件中：

```
[assembly: log4net.Config.XmlConfigurator(ConfigFile="Log4Net.config", Watch = true)] 
```

注意：对于 Web 应用程序，这假定`Log4Net.config`驻留在 Web 根目录中。确保`log4net.config`文件在属性中标记为“复制到输出”->“始终复制”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-08-31T09:42:16.087

以下是您可以使用的 hack，这将使配置从磁盘读取。

您只需要在修改模式下保存配置文件，然后刷新这将使应用程序重新从磁盘读取文件。

```
ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None).Save(ConfigurationSaveMode.Modified);
            ConfigurationManager.RefreshSection("appSettings"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T16:55:51.810

请注意，在 WinForms 中，您可以在应用程序加载之前（之前`Application.Start(new Form1())`）对您的 app.config 进行编程更改，只要您使用`System.Xml`而不是`System.Configuration.ConfigurationManager`

```
string configFile = Application.ExecutablePath + ".config";  //c:\path\exename.exe.config
XmlDocument xdoc = new XmlDocument();
xdoc.Load(configFile);
XmlNode node = xdoc.SelectSingleNode("/configuration/appSettings/add[@key='nodeToChange']/@value");
node.Value = "new value";
File.WriteAllText(setFile, xdoc.InnerXml); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-27T07:56:02.613

我编写了这个实现来在运行时更改日志级别并将新的阈值保留回 app.config（实际上是 Application.exe.config）。

界面：

```
internal interface ILoggingConfiguration
{
  void SetLogLevel(string level);

  string GetLogLevel();
} 
```

实施：

```
internal sealed class LoggingConfigurationImpl : ILoggingConfiguration
{
  #region Members

  private static readonly ILog _logger = 
    ObjectManager.Common.Logger.GetLogger();
  private const string DEFAULT_NAME_SPACE = "Default.Name.Space";

  #endregion

  #region Implementation of ILoggingConfiguration

  public void SetLogLevel(string level)
  {
    Level threshold = Log4NetUtils.ConvertToLevel(level);
    ILoggerRepository[] repositories = LogManager.GetAllRepositories();

    foreach (ILoggerRepository repository in repositories)
    {
      try
      {
        SetLogLevelOnRepository(repository, threshold);
      }
      catch (Exception ex)
      {
        _logger.ErrorFormat("Exception while changing log-level: {0}", ex);
      }
    }
    PersistLogLevel(level);
  }

  public string GetLogLevel()
  {
    ILoggerRepository repository = LogManager.GetRepository();
    Hierarchy hierarchy = (Hierarchy) repository;
    ILogger logger = hierarchy.GetLogger(DEFAULT_NAME_SPACE);
    return ((Logger) logger).Level.DisplayName;
  }

  private void SetLogLevelOnRepository(ILoggerRepository repository,
                                       Level threshold)
  {
    repository.Threshold = threshold;
    Hierarchy hierarchy = (Hierarchy)repository;
    ILogger[] loggers = hierarchy.GetCurrentLoggers();
    foreach (ILogger logger in loggers)
    {
      try
      {
        SetLogLevelOnLogger(threshold, logger);
      }
      catch (Exception ex)
      {
        _logger.ErrorFormat("Exception while changing log-level for 
            logger: {0}{1}{2}", logger, Environment.NewLine, ex);
      }
    }
  }

  private void SetLogLevelOnLogger(Level threshold, ILogger logger)
  {
    ((Logger)logger).Level = threshold;
  }

  private void PersistLogLevel(string level)
  {
    XmlDocument config = new XmlDocument();
    config.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile);
    string xpath =
      String.Format("configuration/log4net/logger[@name='{0}']/level",
        DEFAULT_NAME_SPACE);
    XmlNode rootLoggerNode = config.SelectSingleNode(xpath);

    try
    {
      rootLoggerNode.Attributes["value"].Value = level;
      config.Save(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile);

      ConfigurationManager.RefreshSection("log4net");
    }
    catch(Exception ex)
    {
      _logger.ErrorFormat("error while persisting new log-level: {0}", ex);
    }
  }

  #endregion
} 
```

辅助类 Log4NetUtils：

```
public sealed class Log4NetUtils
{
  private static readonly ILoggerRepository _loggerRepository =
     LoggerManager.GetAllRepositories().First();

  public static Level ConvertToLevel(string level)
  {
    return _loggerRepository.LevelMap[level];
  }
} 
```

XAML 代码：

```
<ComboBox Name="cbxLogLevel" Text="{Binding LogLevel}">
  <ComboBoxItem Content="DEBUG" />
  <ComboBoxItem Content="INFO" />
  <ComboBoxItem Content="WARN" />
  <ComboBoxItem Content="ERROR" />
</ComboBox>
<Button Name="btnChangeLogLevel" 
        Command="{Binding SetLogLevelCommand}"
        CommandParameter="{Binding ElementName=cbxLogLevel, Path=Text}" >
            Change log level
</Button> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T13:46:31.193

我认为没有任何方法可以做到这一点，除非您使用 XML 编写自己的配置文件阅读器。为什么不根据配置文件设置在应用程序启动时打开或关闭日志记录，然后在程序运行时动态打开或关闭它？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T13:46:35.033

我想我在 log4net 文档中读到这是不可能的。

尝试将日志记录在可以使用文件系统观察器监视的外部日志文件中

更新：再次找到它.. [http://logging.apache.org/log4net/release/manual/configuration.html#.config%20Files](http://logging.apache.org/log4net/release/manual/configuration.html#.config%20Files)

在运行时无法重新加载 app.config。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T13:46:55.593

我建议使用另一个 XML 文件而不是 app.config。您甚至可以查看文件的更改并在更改时自动重新加载它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-29T07:55:04.573

实际上使用：

应用程序.restart();

对我来说效果很好。

问候

乔治

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-11T05:15:43.987

我尝试使用 RefreshSection 方法并使用以下代码示例使其工作：

```
class Program
    {
        static void Main(string[] args)
        {
            string value = string.Empty, key = "mySetting";
            Program program = new Program();

            program.GetValue(program, key);
            Console.WriteLine("--------------------------------------------------------------");
            Console.WriteLine("Press any key to exit...");
            Console.ReadLine();
        }

        /// <summary>
        /// Gets the value of the specified key from app.config file.
        /// </summary>
        /// <param name="program">The instance of the program.</param>
        /// <param name="key">The key.</param>
        private void GetValue(Program program, string key)
        {
            string value;
            if (ConfigurationManager.AppSettings.AllKeys.Contains(key))
            {
                Console.WriteLine("--------------------------------------------------------------");
                Console.WriteLine("Key found, evaluating value...");
                value = ConfigurationManager.AppSettings[key];
                Console.WriteLine("Value read from app.confg for Key = {0} is {1}", key, value);
                Console.WriteLine("--------------------------------------------------------------");

                //// Update the value
                program.UpdateAppSettings(key, "newValue");
                //// Re-read from config file
                value = ConfigurationManager.AppSettings[key];
                Console.WriteLine("New Value read from app.confg for Key = {0} is {1}", key, value);
            }
            else
            {
                Console.WriteLine("Specified key not found in app.config");
            }
        }

        /// <summary>
        /// Updates the app settings.
        /// </summary>
        /// <param name="key">The key.</param>
        /// <param name="value">The value.</param>
        public void UpdateAppSettings(string key, string value)
        {
            Configuration configuration = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);

            if (configuration.AppSettings.Settings.AllKeys.Contains(key))
            {
                configuration.AppSettings.Settings[key].Value = value;
            }

            configuration.Save(ConfigurationSaveMode.Modified);
            ConfigurationManager.RefreshSection("appSettings");
        } 
```

# javascript - 在菜单中嵌入 YUI Treeview

> ID：272101
> 
> 赞同：0
> 
> 时间：2008-11-07T13:46:13.287
> 
> 标签：javascript, treeview, yui

我想要一个网站导航菜单，每当有人点击它时，就会出现一个带有复选框的树视图，他们可以在其中选择树中的节点。

YUI Treeview ( [http://developer.yahoo.com/yui/treeview/](http://developer.yahoo.com/yui/treeview/) ) 是否可以做到这一点，还是我必须自己制作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-28T10:19:27.773

是的，这应该是可能的。[查看带有复选框](http://developer.yahoo.com/yui/examples/treeview/tasklist.html)YUI 示例的自定义 TreeView。

# html - 如何删除和转换选择性 HTML 标记？

> ID：272109
> 
> 赞同：1
> 
> 时间：2008-11-07T13:47:47.120
> 
> 标签：html, filtering

我有一个格式为 csv 的文件：

```
270291014011    ED HARDY - TRUE TO MY LOVE - Cap NEU 2008 NEU       0,00 €  0,00 €  0   1   0   22.10.2008 03:37:10 21.11.2008 02:37:10 21.11.2008 02:42:10 50  0   0   0   39,99 € http://i7.ebayimg.com/02/i/001/16/0d/68af_1.JPG?set_id=800005007    0   2   8.10.2008 13:40:20  8.10.2008 13:40:20  80587   0   <table bordercolordark="#999900" bordercolorlight="#666666" bgcolor="#ffffff" border="10" bordercolor="#666666" width="100%">
<tbody>
<tr>
<td><b><font color="#990000" face="arial" size="5"><br>
</font></b><blockquote>
<div align="center"><b><font color="#990000" face="arial" size="5"><font color="#ff0000">

</font></font></b><h1><font size="6"><b><font color="#990000" face="arial"><font color="#ff0000">100% ORGINAL MARKENWARE AUS DEN USA</font></font></b></font></h1>
<p style="color: rgb(0, 0, 0);"><font size="6"><b><font face="arial">ED HARDY</font></b></font></p><p style="color: rgb(0, 0, 0);"><b><font face="arial" size="5">CAP<br></font></b></p></div><div style="text-align: center;"><font size="5"><br><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">Style: TRUE ROSE<br></font></b></font></font></b><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial"><br></font></b></font></font></b></font><font size="5"><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">Die Kollektion von der trend Marke Ed Hardy kreiert sportlich, hipe Mode die bei den Stars in Hollywood der absolute Renner ist. In diesem super Trucker Cap fallen Sie auf !!&nbsp; </font></b></font></font></b></font><font size="5"><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">Dieses Cap ist nagelneu mit Etikett und</font></b></font></font></b></font><font size="5"><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial"> 100% orginal.</font></b></font></font></b></font><font size="5"><br><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial"><br><br></font></b></font></font></b><br><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">Wir tragen die ebay Kosten und der Kaeufer die Versandkosten.</font></b></font></font></b><br><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">Versandkosten nach Europa sind folgend:</font></b></font></font></b><br><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">fuer unversicherten Versand 6,00 Euro<br></font></b></font></font></b></font><font size="5"><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">fuer versicherten Versand 12,00 Euro</font></b></font></font></b></font><br>
<font size="5"><span style="font-family: arial;"><span style="font-weight: bold;">Bei paypal Bezahlungen akzeptieren wir nur noch versicherten Versand!</span></span></font><br><font size="5"><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">Auf Ihren Wunsch versenden wir die Ware auch versichert. Ansonsten trägt das Risiko beim Versand der Käufer. </font></b></font></font></b><br><b><font color="#990000" face="arial"><font color="#ff0000"><b><font color="black" face="arial">Wir bitten um Ihre Zahlung innerhalb 10 Tage nach Auktionsende.</font></b></font></font></b><br></font></div><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><b><font color="black" face="arial" size="3"><br>
</font></b></font></font></b><div align="center"><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><b><font color="black" face="arial" size="3"><font color="#ff0000">
</font></font></b></font></font></b><marquee width="70%" bgcolor="#ffffff">
<h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><b><font color="black" face="arial" size="3"><font color="#ff0000">Schauen Sie unbedingt bei unserem Shop "cheap-and-hip" vorbei!!!</font></font></b></font></font></b></h2></marquee><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><br><b><font color="black" face="arial" size="5"><br>
</font></b></font></font></font></b><blockquote>
<div align="center">
<center>
<h1><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><b><font color="black" face="arial" size="5">Abwicklung Ihres Einkaufs bei uns</font></b></font></font></font></b></h1><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><b><font color="black" face="arial" size="5"><br></font></b></font></font></font></b></center><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><br></font></font></font></b></div><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Jeder Käufer erhält innerhalb von 24 Stunden nach Auktionsende eine e-mail mit allen für die Kaufabwicklung relevanten Informationen. Sollten Sie nach 24 Stunden noch keine e-mail erhalten haben, setzen Sie sich bitte mit uns per e-mail in Verbindung. <br><br>
</font></font></font></font></b><h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Kauf von mehreren Artikeln</font></font></font></font></b></h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Da das Porto aus den USA nach Gewicht berechnet wird, werden die Versandkosten beim Einkauf von mehreren Artikeln neu berechnet. Bitte teilen Sie uns per e-mail mit, wenn Sie mehrere Artikel ersteigert/gekauft haben, bzw. noch ersteigern/kaufen moechten, Sie erhalten von uns dann die kompletten Versandkosten. Die Kosten fuer den Versand werden von dem Kaeufer getragen. Die Versanddauer betraegt bei Luftversand zirka 5-10 Tage.<br><br>
</font></font></font></font></b><h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Versand</font></font></font></font></b></h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Der Versand erfolgt innerhalb von 2-3 Werktagen nach Zahlungseingang (Gutschrift der Überweisung auf unserem Konto bei der Postbank oder bei paypal). Bitte beachten Sie, dass es je nach Kreditinstitut 2-4 Werktage dauern kann, bis Ihre Überweisung auf unserem Konto gutgeschrieben wird. Kreditkarten Gutbuchung ueber paypal erfolgt noch am gleichen Tag.<br>Als Betreff einer Ueberweisung muß unbedingt die eBay-Artikelnummer der Auktion angegeben werden. Ohne diese Information ist eine Zuordnung der Überweisung leider fast nicht möglich! <br>ZOLL: Bitte beachten Sie das Zollgebuehren anfallen koennen auch wenn es nur selten vorkommt sollten Sie sich mit den Einfuhrbestimmungen Ihres Landes vertraut machen. <br></font></font></font></font></b><br><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3"><br>
</font></font></font></font></b><h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Umtausch</font></font></font></font></b></h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Wir tauschen gerne Ihren Artikel um sofern Sie die Ware innerhalb von 14 Tagen nach erhalt den Artikel uns wieder zuschicken. Wir nehmen nur ungetragene Ware zurueck und alle Etiketten muessen noch an dem Artikel befestigt sein<br><br>
</font></font></font></font></b><h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Falls Sie Reklamationen haben</font></font></font></font></b></h2><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3">Wir bitten bei Beanstandungen der Ware sich erst mit uns in Verbindung zu setzten. Wir pruefen unsere Ware immer auf Defekte aber es kann vorkommen das uns etwas entgeht und bevor Sie eine "negative Bewertung" abgeben moechten wir die Chance bekommen Sie zufrieden zustellen. 
</font></font></font></font></b><p><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3"><b><font color="#ff0000" face="arial" size="5">
</font></b></font></font></font></font></b></p><center><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3"><b><font color="#ff0000" face="arial" size="5">Vielen Dank fuer Ihr Intresse!</font></b></font></font></font></font></b></center><p><b><font color="#990000" face="arial" size="5"><font color="#ff0000"><font color="black" face="arial" size="3"><font color="black" face="arial" size="3"><b><font color="#ff0000" face="arial" size="5"><br></font></b></font></font></font></font></b></p></blockquote></div></blockquote></td></tr></tbody></table><br><br>   1   Baltimore   1   0   1   0   0   0,10 €  0,00 €  0,00 €  0   0   1   77 
```

我想知道 sed 或 awk 是否有一种简单的方法可以删除除标签之外的 HTML`<p>`标签。我还想知道是否可以将任何链接 html 嵌入 Flash SWF 文件，以自动更改 HTML 以链接到该文件。

因此，本质上，要替换任何代码，例如

```
<embed src="http://backend.supremeauction.com/app/gallery/loader.swf"> 
```

使用类似的东西`<a href="http://backend.supremeauction.com/app/gallery/loader.swf">Click here for external description</a>`，然后删除所有其他 HTML 标签，除了`<p>`

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T15:06:29.160

这是用于删除非 p 标记的 Perl——尽管它不能跨行工作

```
perl -pe 's/<\/?(?>[^p]|p\w+)[^>]*>//ig' 
```

这会将其打印到标准输出，您可以从那里重定向它。

如果你只有一个链接，你可以这样做：

```
perl -pe 's/<embed\s+src="(.*?\.swf)"\/?>/<a href="$1">Click here for external description<\/a>/i;s/<\/?(?>[^ap]|[ap]\w+)[^>]*>//ig' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T15:14:10.177

对于 sed，我想出了这个：

```
sed -e 's/[<][/][^Pp][^>]*[>]//g' -e 's/[<][^/Pp][^>]*[>]//g' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T15:41:24.207

使用[xmlstarlet](http://xmlstar.sf.net/)过滤掉你想要的标签；因为它知道 XML 语法（这比在正则表达式中正确捕获的要复杂得多），所以它在嵌套标签等极端情况下不容易失败，并且可以`&amp;`正确解码和关联元素。该`select`子命令将采用 XPath，因此查找`A`元素的简单表达式将满足您的需求。

该`format`子命令有一个将 HTML 作为输入的选项，因此如果您的内容不是有效的 XHTML，您需要对其进行初始处理阶段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T20:35:57.997

如果您想在 Perl 中执行此操作，有许多 HTML 实用程序模块可以帮助您转换和过滤 HTML。其他语言可能有类似的库。例如，参见[HTML::Parser](http://search.cpan.org/dist/HTML-Parser)。您为要影响的部分定义处理程序。一旦您控制了该部分，您就可以对其进行转换并决定如何输出它。

如果您有由另一个程序生成的非常规则的输出，您也许可以使用正则表达式。但是，每当我发现特殊情况和异常时，正则表达式开始变得非常讨厌。

听起来你也许可以扭转这个问题。您真的只是想提取 URL 并链接到它们吗？与其搞乱解析器，你可以直接提取 URL 并编写一个全新的文档而不关心旧文档吗？或者也许只是用更大的文档完全替换一个区域？

# c++ - XP SP3 中的用户界面权限隔离

> ID：272112
> 
> 赞同：0
> 
> 时间：2008-11-07T13:48:25.247
> 
> 标签：c++, security, winapi, windows-xp, uipi

经过一番确认，真的：

XP SP3 是否实现了 Vista 中的用户界面特权隔离 (UIPI) 机制？

人类兴趣的背景故事 :) 我最近将 C++ 源代码交给了一个相当大的应用程序。遗憾的是，自 90 年代中期以来，该应用程序的唯一开发人员最近去世了，这使我们处于非常紧张的境地，直到我们可以聘请新的开发人员。

最近用户报告说该应用程序随机停止工作和/或以前工作的某些功能似乎根本没有触发“尽管没有任何改变我的结局！”。“没有改变”原来是SP3 :)

知道这一点，虽然我不是 C/C++ 人，但我想我会看看源代码，看看是否能找到任何东西（花了很多时间查看防火墙、病毒扫描程序和其他外在因素）。

我追踪到一个错误是调用 Api 函数 SendMessage，然后去 MSDN 文档查看。它明确指出**“Microsoft Windows Vista 及更高版本。消息发送受用户界面特权隔离 (UIPI) 的约束。进程的线程只能将消息发送到具有较低或相等完整性级别的进程中的线程的消息队列。”** 虽然我不是 100% 确定，但这似乎是一个可能的原因。

干杯!

莱尼。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T14:09:52.847

不，XP SP3 没有实现任何 Vista 安全更改，至少没有任何与窗口管理器相关的更改。您并没有真正提供太多背景信息来提供帮助，但是您会得到与 SendMessage() 相关的哪种错误？

SendMessage() 是一个使用非常广泛的例程，它只是将 Windows 消息发送到窗口，所以我希望该错误与接收者窗口如何处理传入消息（或不处理）有关，而不是与 SendMessage() 本身有关。与其将 SendMessage() 视为只是一个 Windows 函数，不如将其视为一个函数，该函数最终会在任何拥有您将消息发送到的窗口的应用程序中调用进一步的应用程序代码 - 特别是SendMessage() 的返回代码告诉您窗口的应用程序是如何尝试处理消息的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T15:38:51.187

UIPI 不会在 SendMessage 上报告错误 - 如果您收到错误返回，那么它是另一回事。其他评论者是对的，UIPI 仅适用于 Vista，除非您尝试向服务发送消息，否则*无论如何您都不会对此感到厌烦。*

# java - 每个 webapp 一个或多个 servlet？

> ID：272118
> 
> 赞同：28
> 
> 时间：2008-11-07T13:50:45.977
> 
> 标签：java, servlets, web-applications

我知道，这取决于webapp。但在正常情况下，您会做什么：一个 servlet，它服务于不同的页面（例如一个具有变化内容的独立应用程序），或者为每个页面提供一个 servlet。

以博客为例。有一个带有最新博客条目的起始页、一个用于显示一个博客条目的文章视图和一个存档。你是用三个不同的 servlet 实现的，还是用一个分派给函数的 servlet 来实现的。至少有一部分内容是共享的，例如 http-headers。

那么，你的经验是什么，什么最有效？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-07T13:56:03.797

通常，您将为每个用例创建一个 servlet。Servlet 就像您的应用程序的控制器一样。当您识别来自用户的交互时，然后实现一个 servlet 来控制该交互。

也就是说，如果您使用普通的 servlet/JSP 来构建站点。如果您使用像 struts 这样的框架，您会发现它们实现了前端控制器模式并使用单个 servlet 接收所有请求并将这些请求转发到实现用户请求的实际逻辑的操作类。自己做这件事要困难得多，但这是一个很好的做法……这就是为什么这么多人使用这些框架的原因。

所以简短的回答是，您将为每个 webapp 创建许多 servlet，因为每个 webapp 都会公开几个用例。

[编辑] 重新阅读您的问题，好像您使用术语*站点*来表示页面或视图。同样，这取决于该视图上发生的情况。例如，要显示最新的博客条目，您可以有一个 servlet，它从数据库中构造条目列表以供显示。如果用户单击一个条目，则另一个 servlet 可以检索该单个条目以进行查看等。主要是，每个动作都是一个用例，因此是一个不同的 servlet。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-07T15:48:40.853

大多数 Web 框架使用调度程序 servlet（例如：Spring MVC），负责将请求路由到适当的类/控制器。

当您开始拥有大量页面时，这种方法效果最好，因为您有一种更加用户友好的方式（关于 web.xml）来声明/管理一个处理 http 请求及其 url 的类。示例（再次使用 spring mvc）：

```
@Controller
public class MyController {
 @RequestMapping("/viewPosts")
 public void doViewPosts(HttpRequest r, HttpResponse res) {
  //...
 }
} 
```

此外，拥有调度程序 servlet 可以使您的代码流保持集中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T16:39:28.740

这取决于。

在我最近的项目中，我实现了一个 servlet，它委托给几个类似 servlet 的对象，这些对象以依赖注入的方式实例化。例如，我的 servlet 中有这样的东西（伪代码）：

```
for(Handler handler : handlers) {
    if(handler.handle(request, response)) {
         return;
    }
} 
```

其中 Handler 是一个带有布尔句柄（请求，响应）方法的接口。我从一个容器中获取我的处理程序（无论是 Spring 还是更轻量级的东西）。

原因是我很喜欢依赖注入，在Servlet中很难实现；对于大多数提供 Web 组件依赖注入的框架，我真的不太熟悉——我喜欢 servlet 的简单性。

如果不是这样，我会使用多个 servlet，尽管有一个权衡；要么你有一个巨大的 web xml，有很多（和很多）servlet 映射，要么你有一个非常复杂的 servlet（除非你使用类似我的 di 方法）。

# macos - OSX 的 Mach-O 二进制编辑器？

> ID：272121
> 
> 赞同：4
> 
> 时间：2008-11-07T13:52:39.280
> 
> 标签：macos, editor, osx-leopard, mach-o

py-macholib 在 osx 上无法正常工作（使用 darwin 端口）。我还没有找到任何其他选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-07-23T18:12:19.013

试试这个：[MachOView](http://machoview.sourceforge.net/)

# java - 为 JTree 实现工具提示的最佳方式？

> ID：272124
> 
> 赞同：19
> 
> 时间：2008-11-07T13:53:49.493
> 
> 标签：java, swing, tooltip, jtree

由于 JTree 和 TreeModel 不直接提供开箱即用的工具提示，您认为，为 JTree 提供特定于项目的工具提示的最佳方式是什么？

编辑：（之后回答我自己的问题。）

@Zarkonnen：感谢 getTooltipText 的想法。

我发现了另一种（可能还是更好一点）覆盖 DefaultTreeCellRenderer 的方法，并想分享它：

```
public class JTreeWithToolTips {
    private static class OwnRenderer extends DefaultTreeCellRenderer {
        @Override
        public Component getTreeCellRendererComponent(JTree tree, Object value,
                boolean sel, boolean expanded, boolean leaf, int row,
                boolean hasFocus) {
            setToolTipText("foobar" + row);
            return super.getTreeCellRendererComponent(tree, value, sel,
                    expanded, leaf, row, hasFocus);
        }
    }

    public static void main(String[] args) {
        JTree tree = new JTree(new Object[] { "foo", "bar", "foobar" });
        tree.setCellRenderer(new OwnRenderer());
        ToolTipManager.sharedInstance().registerComponent(tree);

        JFrame frame = new JFrame();
        frame.getContentPane().add(tree);
        frame.pack();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-07T14:15:21.480

请参阅JTree 上的[getTooltipText](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTree.html#getToolTipText(java.awt.event.MouseEvent))。这应该允许您根据悬停在树中的内容显示工具提示。（尽管请阅读文档，您需要使用 ToolTipManager 注册 JTree。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-21T05:33:05.923

是的，您可以使用`onMouseMoved`然后使用一种方法（我不记得名称）告诉您您在哪个节点结束。如果你得到空值，显然你没有超过一个节点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-06T21:43:34.410

在处理特定`TreeNode`的子类时，根据您自己的回答和评论，我想出了一个接口供我`TreeNode`实现。

请注意我们如何检查 是否是 中的`value`实例：`Tooltipable``TreeCellRenderer`

```
public static interface Tooltipable {
    public String getToolTip();
}

public static class TheNode extends DefaultMutableTreeNode implements Tooltipable {

    private String shortDesc, longDesc;

    public TheNode(String shortDesc, String longDesc) {
        super();
        this.shortDesc = shortDesc;
        this.longDesc = longDesc;
    }

    @Override
    public String getToolTip() {
        return longDesc;
    }

    @Override
    public String toString() {
        return shortDesc;
    }
}

public static class TheModel extends DefaultTreeModel {
    public TheModel() {
        super(new TheNode("Root", "The base of everything"));
        TheNode root = (TheNode)getRoot();
        root.add(new TheNode("Second", "I am a number two"));
        TheNode node = new TheNode("Third", "Another one bites the dust");
        root.add(node);
        node.add(new TheNode("Last", null)); // No tooltip for this one
    }
}

public static class TreeTooltipRenderer extends DefaultTreeCellRenderer {
    @Override
    public Component getTreeCellRendererComponent(JTree tree, Object value, boolean sel, boolean expanded, boolean leaf, int row, boolean hasFocus) {
        if (value instanceof Tooltipable)
            setToolTipText(((Tooltipable)value).getToolTip());
        return super.getTreeCellRendererComponent(tree, value, sel, expanded, leaf, row, hasFocus);
    }
}

public static void main(String[] args) {
    JFrame frame = new JFrame();
    frame.setBounds(100, 100, 300, 300);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    JTree tree = new JTree(new TheModel());
    ToolTipManager.sharedInstance().registerComponent(tree);
    tree.setCellRenderer(new TreeTooltipRenderer());
    frame.add(new JScrollPane(tree), BorderLayout.CENTER);
    frame.setVisible(true);
} 
```

# language-agnostic - 构建农场：选项

> ID：272128
> 
> 赞同：3
> 
> 时间：2008-11-07T13:54:50.303
> 
> 标签：language-agnostic, distributed, compiler-construction, buildfarm

我们在这里使用 Incredibuild 以分布式方式编译我们的代码。我想知道在家庭网络上是否有任何开源（或免费）替代品？

如果做不到这一点，是否还有其他与 Visual Studio 良好集成的简单解决方案？

编辑：我应该说我很高兴自己动手并在需要时手动配置每台机器上的所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T14:23:49.403

我不能将[TeamCity](http://www.jetbrains.com/teamcity/)视为 CI 环境——除其他功能外，它还允许多个构建代理在一个构建网格中链接在一起。

哦，它还与 VS 和 SubVersion 完美集成。而且它是免费使用的，最多 20 个构建配置和 2 个构建代理。

# php - 动态调整 div 的大小/重新定位以进行多列查看

> ID：272131
> 
> 赞同：2
> 
> 时间：2008-11-07T13:55:14.267
> 
> 标签：php, html, css, styling, dynamic-css

## 设置

我有一个网站，可以绘制 RSS 提要并在页面上显示它们。目前，我在包含每个提要的 div 上使用百分比，以便倍数可以彼此相邻出现。

但是，我只有两个彼此相邻，如果窗口调整大小，屏幕上可能会有一些难看的空白空间。

## 欲望

我想要做的，但还没有想出办法，就是将所有提要线性放入页面中，并具有：

*   一个“预建”的多列视图，其中提要将自己“平衡”到列中

这导致我：

*   列数根据当前屏幕的宽度而变化\

这类似于文字处理应用程序处理列式布局的方式。

## 问题

我认为我需要实现某种形式的 AJAXy 幸福，但目前对 Javascript 知之甚少。

有没有办法***只***用CSS/HTML/PHP 做到这一点？

如果没有，我应该如何解决这个问题？

### 最终解决方案：

（基于[@warpr](https://stackoverflow.com/a/272183/4418)和[@joh6nn](https://stackoverflow.com/a/272229/4418)的回答）

```
#rss
        {min-width: 10em;
        max-width: 25em;
        min-height: 15em;
        max-height: 25em;
        font-size: .97em;
        float: left;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T14:16:08.810

您可能无法仅使用 CSS/HTML 获得您想要的，但您可以得到一些接近。

我用于相册的技巧是这样的：

1.  确保每个提要都有固定的宽度，我会推荐像“20em”这样的东西；
2.  确保每个饲料具有相同的高度。
3.  把剩下的东西都浮起来。

因为每个 div 具有相同的尺寸，所以当它们向左浮动时，它们将形成一个网格，其中的列数正好适合您的浏览器。

除非您实际上修复了 div 的高度并使用 CSS 来剪辑内容，否则您将需要 javascript 来执行第 2 步，我所做的是：

1.  遍历每个提要 div，找到最高的 div。
2.  再次遍历每个 div，更改高度以匹配第一步中找到的 div。

这很容易实现，但显然不是最优的。我期待阅读此处发布的任何更好的解决方案:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T14:30:50.823

你也许可以用列表来做到这一点；我从未尝试过，所以我不确定。

如果您使列表项显示：内联，则列表变为水平而不是垂直。从那里开始，如果您将列表填充到包含元素中并摆弄填充和边距，您可能能够使列表像文本一样进行线扭曲：再次，我从未尝试过，所以我不知道。

如果这种技术有效，我很想听听。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T15:05:44.140

我能想到的唯一方法是动态 CSS 和 javascript 的混合。每次添加列（提要）时，使用 javascript 重写每个 div 的宽度（百分比）。

jQuery 在这里会派上用场。

```
var columns = $(".feed").size();
var size = 100/columns;
$(".feed").css("width",size+"%"); 
```

如果我错了，有人随时纠正我。我的 jQuery 有点不稳定。

当然，如果您不使用 AJAX，您可以完全在 PHP 中实现相同的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T10:16:08.967

你也可以使用这个 jQuery javascript（你需要 jQuery 库）。

```
var docwidth = $(document).width();
var numOfCollums = $('.feed').length;
var colWidth = docwidth/numOfCollums;
$('.feed').each( function() {
     $(this).width(colWidth);
}); 
```

这将动态设置列宽。

为此，您的列应具有“提要”类

编辑：

你应该为你的 div 设置如下样式：

```
.feed{
  float:left;
} 
```

# iphone - 如何使用 iPhone 的内置 PDF 查看器显示文档

> ID：272132
> 
> 赞同：6
> 
> 时间：2008-11-07T13:55:35.247
> 
> 标签：iphone, pdf

我想创建一个从 Internet 下载 PDF 文档并将其显示给用户的应用程序。我想重新使用整个核心应用程序中使用的 iPhone 的内置 PDF 查看器来查看 PDF 文档。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-07T14:27:01.050

你可以只使用 UIWebView 类来做到这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-12-18T23:55:53.330

试试这个：[https ://github.com/vfr/Reader](https://github.com/vfr/Reader)

# windows - 我需要做什么才能将 DIB 转换为 BMP？

> ID：272152
> 
> 赞同：2
> 
> 时间：2008-11-07T14:05:23.683
> 
> 标签：windows, image

我需要做什么才能将 DIB 转换为 BMP？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-17T18:53:39.157

位图标题类型的文档位于[http://msdn.microsoft.com/en-us/library/dd183386%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/dd183386%28VS.85%29.aspx)。

在代码中，bmp 文件和 dib 内存表示之间的区别在于开头存在 BITMAPFILEHEADER 结构 ( [http://msdn.microsoft.com/en-us/library/dd183374(v=vs.85)。 .aspx](http://msdn.microsoft.com/en-us/library/dd183374(v=vs.85).aspx)）。因此，将 bmp 转换为 dib 的字面意思是跳过 BITMAPFILEHEADER 并从 DIB 头的内存地址开始（紧跟在位图文件头之后），它总是比 bmp 内存地址的开头晚 14 个字节。

```
BITMAPFILEHEADER *bmp = ...;
char * bmpBytes = reinterpret_cast<char *>(bmp);
void * myDib = (void *)bmpBytes + BMP_HEADER_LENGTH; /* (14 bytes) */
/* cast and do something with myDib */
... 
```

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T14:08:49.120

检查 API GdipCreateBitmapFromGdiDib

示例： http: [//www.codeproject.com/KB/GDI-plus/DIBtoBitmap.aspx](http://www.codeproject.com/KB/GDI-plus/DIBtoBitmap.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T15:19:46.107

[Imagemagick 的](http://www.imagemagick.org/www/formats.html)转换功能将在命令行上为您执行此操作（以及许多其他转换）。免费、开源，可在所有主要平台上使用。这是一款很棒的软件，应该放在任何人的工具箱中。

# c# - 为什么必须在结构上调用 :this() 才能在 c# 中使用自动属性？

> ID：272153
> 
> 赞同：54
> 
> 时间：2008-11-07T14:06:03.043
> 
> 标签：c#, struct, cil, automatic-properties

如果我使用这样的自动属性在 C# 中定义一个结构：

```
public struct Address
{
    public Address(string line1, string line2, string city, string state, string zip)
    {
        Line1 = line1;
        Line2 = line2;
        City = city;
        State = state;
        Zip = zip;
    }

    public string Line1 { get; protected set; }
    public string Line2 { get; protected set; }
    public string City { get; protected set; }
    public string State { get; protected set; }
    public string Zip { get; protected set; }
} 
```

当我尝试构建文件时，我得到一个编译错误，说`The 'this' object cannot be used before all of its fields are assigned to`. 这可以通过更改构造函数以对默认构造函数进行链式调用来解决，如下所示：

```
public Address(string line1, string line2, string city, string state, string zip): this()
{
    Line1 = line1;
    Line2 = line2;
    City = city;
    State = state;
    Zip = zip;
} 
```

我的问题是，为什么这会起作用，发生了什么？我有一个猜测，我试图通过查看 IL 来证明这一点，但如果我认为我可以分解 IL，那我只是在开玩笑。但我的猜测是，自动属性通过让编译器在幕后为您的属性生成字段来工作。这些字段无法通过代码访问，所有设置和获取都必须通过属性完成。创建结构时，不能显式定义默认构造函数。因此，在幕后，编译器必须生成一个默认构造函数，该构造函数设置开发人员看不到的字段的值。

欢迎任何和所有 IL 向导来证明或反驳我的理论。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-07T14:10:33.207

**注意：从 C# 6 开始，这不是必需的 - 但无论如何您都应该在 C# 6 中使用只读自动实现的属性...**

`this()`确保就编译器而言明确分配了字段 - 它将所有字段设置为其默认值。*在开始访问任何*属性之前，您必须拥有一个完全构造的结构。

这很烦人，但就是这样。你确定你真的希望这是一个结构吗？为什么要在结构上使用受保护的设置器（不能从中派生）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T15:46:11.003

属性只不过是`Get`方法和/或`Set`方法的封装。CLR 具有指示特定方法应被视为属性的元数据，这意味着编译器应允许一些它不允许使用方法的构造。例如，如果`X`是 的读写属性`Foo`，编译器将转换`Foo.X += 5`为`Foo.SET_X_METHOD(Foo.GET_X_METHOD() + 5)`（尽管方法名称不同，并且通常不能通过名称访问）。

尽管自动属性实现了一对 get/set 方法，这些方法访问私有字段的方式或多或少像一个字段，但从属性之外的任何代码的角度来看，自动属性是一对 get/像任何其他属性一样设置方法。因此，语句 like`Foo.X = 5;`被翻译为`Foo.SET_X_METHOD(5)`。由于 C# 编译器只是将其视为方法调用，并且由于方法不包含任何元数据来指示它们读取或写入的字段，因此编译器将禁止方法调用，除非它知道每个字段`Foo`都已写入。

就个人而言，我的建议是避免使用结构类型的自动属性。自动属性对类有意义，因为类属性可以支持更新通知等功能。即使类的早期版本不支持更新通知，让这些版本使用自动属性而不是字段将意味着未来版本可以添加更新通知功能，而无需重新设计类的使用者。然而，结构不能有意义地支持人们可能希望添加到类似字段的属性中的大多数特征类型。

此外，与类类型相比，大型结构的字段和属性之间的性能差异要大得多。事实上，避免大型结构的大部分建议都是这种差异的结果。如果避免不必要地复制它们，大型结构实际上可以非常有效。即使有一个巨大的结构`HexDecet<HexDecet<HexDecet<Integer>>>`，其中`HexDecet<T>`包含暴露的字段`F0`..`F15`类型`T`，类似的语句`Foo = MyThing.F3.F6.F9;`也只需要从 读取一个整数`MyThing`并将其存储到`Foo`，即使`MyThing`按结构标准（4096 个整数占用 16K）是巨大的。此外，可以非常轻松地更新该元素，例如`MyThing.F3.F6.F9 += 26;`. 相比之下，如果`F0`..`F15`是自动属性，该语句`Foo = MyThing.F3.F6.F9`需要从. 伊克。更糟糕的是，尝试将 26 添加到 in 的值将需要类似.`MyThing.F3``temp1``temp1.F6``temp2``temp2.F9``MyThing.F3.F6.F9``var t1 = MyThing.F3; var t2 = t1.F6; t2.F9 += 26; t1.F6 = f2; MyThing.F3 = t1;`

许多关于“可变结构类型”的长期抱怨实际上是对具有读/写属性的结构类型的抱怨。只需用字段替换属性，问题就会消失。

PS：有时候，拥有一个结构，它的属性访问一个类对象，它持有一个引用，这可能会很有用。例如，最好有一个`ArraySegment<T>`允许说 的类的版本`Var foo[] = new int[100]; Var MyArrSeg = New ArraySegment<int>(foo, 25, 25); MyArrSeg[6] += 9;`，并让最后一条语句将 9 添加到元素 (25+6)`foo`. 在旧版本的 C# 中可以做到这一点。不幸的是，在框架中频繁使用自动属性，其中字段更合适导致了对编译器允许在只读结构上无用地调用属性设置器的广泛抱怨。因此，现在禁止在只读结构上调用任何属性设置器，无论属性设置器是否会实际修改结构的任何字段。如果人们只是避免通过属性设置器使结构可变（在可变性适当时使字段直接可访问），那么编译器将永远不必实现该限制。

# opengl - OpenGL 中的光照问题

> ID：272157
> 
> 赞同：3
> 
> 时间：2008-11-07T14:07:36.317
> 
> 标签：opengl

我有一个没有纹理的三角形网格，但是有一个固定的颜色（蓝色）和 alpha（0.7f）。该网格是运行时生成的，并且法线是正确的。我发现在打开照明的情况下，我的对象的颜色会随着它在关卡中移动而发生变化。另外，灯光看起来也不对。当我绘制这个对象时，这是代码：

```
glEnable( GL_COLOR_MATERIAL );
float matColor[] = { cur->GetRed(), cur->GetGreen(), cur->GetBlue(), cur->GetAlpha() };
float white[] = { 0.3f, 0.3f, 0.3f, 1.0f };
glMaterialfv(GL_FRONT_AND_BACK, GL_DIFFUSE, matColor);
glMaterialfv(GL_FRONT_AND_BACK, GL_SPECULAR, white); 
```

我注意到的另一件奇怪的事情是，当我禁用`GL_FRONT_AND_BACK`并仅使用`GL_FRONT`or时，照明会失败`GL_BACK`。这是我的照明设置（在渲染器开始时完成一次）：

```
m_lightAmbient[] = { 0.2f, 0.2f, 0.2f, 1.0f };
m_lightSpecular[] = { 1.0f, 1.0f, 1.0f, 1.0f };
m_lightPosition[] = { 0.0f, 1200.0f, 0.0f, 1.0f };

glLightfv(GL_LIGHT0, GL_AMBIENT, m_lightAmbient);
glLightfv(GL_LIGHT0, GL_SPECULAR, m_lightSpecular);
glLightfv(GL_LIGHT0, GL_POSITION, m_lightPosition); 
```

编辑：我做了很多工作来使法线“更”正确（因为我自己生成了表面），但是对象的颜色仍然会根据它的位置而变化。为什么是这样？openGL 是否有一些我不知道的特殊环境混合？

编辑：原来颜色变化是因为以前的纹理在纹理堆栈上，即使它没有被绘制，`glMaterialfv`也正在与它混合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T14:14:06.270

如果在禁用 GL_FRONT_AND_BACK 时您的照明失败，则您的法线可能会被翻转。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T17:12:04.273

你能发布初始化OpenGL的代码吗？您是说所有其他网格都绘制得很完美？你是同时渲染它们吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T09:31:00.880

@对斯图史密斯的回应：

Z 测试不会帮助您处理透明三角形，您还需要每个三角形的 alpha 排序。如果您有一个对象在任何时候都可能有重叠的三角形面向相机（一个凹面对象），您必须首先绘制最远的三角形以确保正确执行混合，因为 Z 测试不考虑透明度。考虑这两个重叠（和透明）的三角形，并考虑在绘制那个小的重叠区域时会发生什么，无论是否进行 Z 测试。您可能会得出这样的结论：绘图顺序确实很重要。透明度很烂：P

```
 /\    /\
   /  \  /  \
  /    \/    \
 /     /\     \
/_____/__\_____\ 
```

我不相信这是您的问题，但是在处理部分透明的对象时，您需要考虑 alpha 排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-20T06:38:25.060

原来颜色变化是因为之前的纹理在纹理堆栈上，即使它没有被绘制，glMaterialfv 也在与它混合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T14:39:14.987

如果您的三角形是 alpha 混合的，您是否不必从相机按 z 顺序对脸部进行排序？否则，您可能会在前面的面之上渲染对象后面的面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T08:54:14.840

@sebastion：多个绘图调用，每个对象都有一个 glDrawArrays。有些是有纹理的，有些是彩色的，都带有法线。gl 初始化代码是：glMatrixMode(GL_MODELVIEW);

```
// Vertices!
glEnableClientState(GL_VERTEX_ARRAY);

// Depth func
glEnable(GL_DEPTH_TEST);
glDepthFunc( GL_LESS );

// Enable alpha blending
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

// Lighting
glEnable(GL_LIGHTING);
glEnable(GL_LIGHT0);
glLightfv(GL_LIGHT0, GL_AMBIENT, m_lightAmbient);
glLightfv(GL_LIGHT0, GL_SPECULAR, m_lightSpecular);
glLightfv(GL_LIGHT0, GL_POSITION, m_lightPosition);

// Culling
glDisable( GL_CULL_FACE );
// Smooth Shading
glShadeModel(GL_SMOOTH);

m_glSetupDone = true; 
```

在此之后，我设置了一些相机，但那是完全标准的，投影模式，平截头体，模型视图，查看，翻译。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-05T14:08:15.673

你确定你的法线是**标准化**的吗？如果没有，并且您通过 glNormal 调用指定法线，您可以尝试让 OpenGL 为您进行标准化，请记住，应该避免这种情况，但您可以对其进行测试：

```
glEnable(GL_NORMALIZE); 
```

这样你就告诉 OpenGL 重新缩放通过 glNormal 提供的所有法线向量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-19T02:12:02.653

我的地形显示存在透明度问题，从某个角度看时，斜坡看起来是透明的。它仅在着色器中启用照明时发生。原来我没有开启深度测试，从某个角度看，地形被其他地形覆盖，显示为半透明。

TLDR；检查您是否启用了深度测试，将其关闭可能会在涉及照明时产生类似透明的效果。 [https://learnopengl.com/Advanced-OpenGL/Depth-testing](https://learnopengl.com/Advanced-OpenGL/Depth-testing)

# asp.net-mvc - ASP.NET MVC 无法以编程方式找到路由

> ID：272159
> 
> 赞同：2
> 
> 时间：2008-11-07T14:08:21.277
> 
> 标签：asp.net-mvc, global-asax, routes

我有以下一条路线，在我的 global.asax 中注册。

```
routes.MapRoute(
    "Home", // Unique name
    "", // Root url
    new { controller = "Home", action = "Index", 
        tag = string.Empty, page = 1 }
); 
```

科尔。当我启动该站点时，它正确地选择了这条路线。

现在，当我尝试以编程方式执行以下操作时，它返回 NULL。

```
var pageLinkValueDictionary = 
    new RouteValueDictionar(linkWithoutPageValuesDictionary)
        {{"page", 2}};

VirtualPathData virtualPathData = 
    RouteTable.Routes.GetVirtualPath(viewContext, "Home"
        pageLinkValueDictionary);

// NOTE: pageLinkValueDictionary == 
//     Key: Action, Value: Index; Key: page, Value: 2 
```

为什么会发生这种情况？

我的印象是它会找到 Home 路线，但会附加任何未找到的值作为查询字符串项？

## 更新

仍然没有运气。此外，使用[MVC RC](https://www.microsoft.com/downloads/details.aspx?FamilyID=f4e4ee26-4bc5-41ed-80c9-261336b2a5b6&displaylang=en)，我现在需要将 viewContext 更改为 veiwContext.RequestContext .. 编译但我仍然得到一个空结果。

## 更新 2

当我有没有`page=1`默认项目的路线时，路线*IS FOUND*。例如。

```
routes.MapRoute(
        "Home",
        "",
        new { controller = "Post", action = "Index", tags = string.Empty }
    ); 
```

..并`RouteTable.Routes.GetVirtualPath`返回一个`VirtualPathData`实例。当我重新添加`page=1`（默认值）时，`VirtualPathData`返回的实例为空？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T15:57:26.483

那么它返回 null 的原因是因为没有带有“页面”路由数据的路由。

你能稍微扩展一下你想要实现的目标吗？如果您想重定向到带有 /page/2 或 /?page=2 url 的页面，那么您应该使用 RedirectToRoute 或 RedirectToAction：

```
return RedirectToRoute("IndexDefault", new {page = "2"}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T17:45:38.950

我认为你的路线应该是这样的：

```
route.MapRoute("theRoute", "{controller}/{action}/{tag}/{page}",
  new { controller="Post", action="Index", tag="", page=1 }); 
```

或（取决于完整的 URL 应该是什么样子）...

```
route.MapRoute("theRoute", "/{tag}/{page}",
  new { controller="Post", action="Index", tag="", page=1 }); 
```

这仍然会匹配对[http://mysite.com/](http://mysite.com/)的请求，并转到上面定义的默认路由值。但是现在当你指定一个标签或页面时，你会得到你想要的 url。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T05:11:21.577

您应该查看 Phil 的 Route Tester：

[ASP.NET 路由调试器](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

# c++ - 为什么我不能在 VS2008 的类中使用静态成员，例如静态结构？

> ID：272161
> 
> 赞同：3
> 
> 时间：2008-11-07T14:09:38.307
> 
> 标签：c++, visual-studio-2008, definition, static-members

当我在 VS 2008 中编写这样的代码时：

```
.h
struct Patterns {
        string ptCreate;
        string ptDelete;
        string ptDrop;
        string ptUpdate;
        string ptInsert;
        string ptSelect;
    };     

class QueryValidate {
    string query;
    string pattern;
    static Patterns pts;
public:
    friend class Query;
    QueryValidate(const string& qr, const string& ptn):
      query(qr), pattern(ptn) {}
    bool validate() {
        boost::regex rg(pattern);
        return boost::regex_match(query, rg);
    }
    virtual ~QueryValidate() {}
}; 
```

然后我像这样初始化我的结构：

```
.cpp
string QueryValidate::pts::ptCreate = "something";
string QueryValidate::pts::ptDelete = "something";
//... 
```

编译器给出以下错误：

> “模式”：“::”左侧的符号必须是类型“ptSelect”：不是“QueryValidate”的成员

我究竟做错了什么？这是 Visual Studio 还是我的代码的问题？我知道除了 const 之外的静态成员必须在声明它们的类之外定义。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-07T14:33:15.077

您正在尝试创建静态成员 (pts) 的非静态成员 (ptCreate)。这不会像这样工作。

你有两个选择，要么使用 Patterns 类的结构初始化列表。

```
Patterns QueryValidate::pts = {"CREATE", "DELETE"}; // etc. for every string 
```

或者，更安全（我认为更好），在 Patterns 中提供一个构造函数并调用它。

```
struct Patterns {
   Patterns() { /*...*/ }
   /* ... */
} 
```

另一方面，您的代码在任何 C++ 编译器中都不起作用，它与 Visual Studio 的东西没有冲突。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T14:49:06.793

您只能将结构作为一个整体进行初始化，如下所示：

```
Patterns QueryValidate::pts = { "something", "something", ... }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T14:34:50.567

这不是有效的 C++。在 cpp 文件中，您声明了静态结构“QueryValidate::pts”的一部分，但这是不允许的：您必须声明整个结构，如下所示：

模式 QueryValidate::pts;

如果你想初始化成员，你可以在另一个方法中初始化它们，或者向 Patterns 添加一个构造函数，它接受你想要的任何初始化参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T15:01:29.140

我不确定您要在这里做什么。看起来有点像您试图分别声明和初始化 pts 中的每个字段，而不是将 pts 声明为单个对象一次。我真的很惊讶 VS 让你这样做。

在 gcc 中对我有用的是：

```
Patterns QueryValidate::pts;

void foo () {
    QueryValidate::pts.ptCreate = "something";
    QueryValidate::pts.ptDelete = "something";
} 
```

# asp.net - ASP.NET 服务器是否可以为多个用户生成相同的 GUID？

> ID：272169
> 
> 赞同：0
> 
> 时间：2008-11-07T14:13:48.363
> 
> 标签：asp.net, guid

我已经看过[GUID Collisons](https://stackoverflow.com/questions/184869/are-guid-collisions-possible)的 讨论，但只是想知道如果两个客户端同时访问生成 GUID 的同一个网页（可能低至微秒）是否会发生 GUID 冲突？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-07T14:15:17.720

这在理论上是可能的，但极不可能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T14:15:19.513

不，如果发生这种情况，赶紧出去买彩票！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T14:32:28.433

在单个服务器上，不，这是不可能的。第 4 版 Guid 由（除其他外）伪随机 54 位值组成，据我了解，它们在重复之前循环遍历所有值。

如果在多个服务器上创建，则可能会发生 guid 冲突，尽管这种可能性极小。

请参阅[RFC 4122](http://www.ietf.org/rfc/rfc4122.txt)，特别是第 4.1.5 节。我相信现代 Windows 使用 v4 UUID。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T14:21:31.827

[维基百科，自由的百科全书](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)

全球唯一标识符或 GUID（发音为 /ˈguːɪd/ 或 /ˈgwɪd/）是软件应用程序中使用的一种特殊类型的标识符，用于**提供在任何上下文中唯一的参考编号**（因此，“全球”），例如，在为软件应用程序中的一种访问点定义内部引用，或在数据库中创建唯一密钥时。**虽然不能保证每个生成的 GUID 都是唯一的，但唯一键的总数（2128 或 3.4×1038）是如此之大，以至于两次生成相同数字的概率非常小**。例如，考虑可观测宇宙，它包含大约 5×1022 颗恒星；然后，每颗星都可以有 6.8×1015 个普遍唯一的 GUID。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T14:40:00.947

如果您生成大量的 GUID，那么由于[**生日悖论**](http://en.wikipedia.org/wiki/Birthday_paradox)，碰撞的可能性会变得非常高。理论上 GUID 冲突应该是极不可能的（天真的直觉），但实际上它时常发生。

当然，以编程方式处理这些冲突是浪费时间，但您仍然应该以这样的方式编写代码，如果它发生，那么您的代码应该大声失败，而不是悄悄地和未被检测到。

# iphone - 仅使用 OpenGL 而不是 Cocoa Touch 来制作 iPhone 应用程序是否可行？

> ID：272175
> 
> 赞同：3
> 
> 时间：2008-11-07T14:14:26.567
> 
> 标签：iphone, c, opengl

我更愿意使用 OpenGL 等纯 C api 编写应用程序，而不是 Cocoa Touch。所以我想知道：这可行吗？我能否保持与 ​​Interface Builder 相同的用户体验？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T14:20:04.370

所有 UI 组件都没有 OpenGL 等效项。是否可以？是的。*明智*吗？不——你最好学习如何使用 IB 和 UIView 类。在 OpenGL 中编写 UI 就像用艺术家的画笔画你的房子，使用手工绘制的颜料而不是 Dulux。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T14:22:55.987

除非您正在开发游戏，否则用户会希望您的用户界面小部件能够像在其他应用程序中一样工作。您永远无法正确模拟，特别是如果苹果决定在未来的固件升级等中修复某些问题......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T14:47:02.493

通常，您还需要 Cocoa 与系统集成以存储数据、首选项等。您不愿意使用 Cocoa 有什么具体原因吗？如果是因为你对学习objective-c感到厌恶，那你真的应该给它一个适当的机会。它是构建 ui 应用程序的绝佳语言。如果您正在尝试移植现有应用程序，那么我建议您构建一个包装器，该包装器将与 iphone 正确交互并从那里调用您的 c 代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T17:33:14.137

这不是一个富有成果的答案（为此，请参阅[AirSource's](https://stackoverflow.com/questions/272175/is-it-feasible-to-make-iphone-apps-using-just-opengl-and-not-cocoa-touch#272189)），而是对您关于不使用 Objective-C 的答案的评论，但我在 C# 之后几个月学习了 Objective-C，我发现我在这两个方面都做得很好。给它一个机会，它会让你大吃一惊。有一个学习曲线，它们是不同的，但特别是界面工具远远领先，你可能会发现它值得你花时间。对于您和您的应用程序的用户来说，它肯定会比在 OpenGL 中手动滚动它更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-25T10:27:24.383

取决于您的应用程序。我的游戏是一个“身临其境”的游戏，所以我使用 openGL 而不是 CocoaTouch，并使用少量
Core Graphics/UIKit 调用来生成漂亮的纹理。

如果我必须显示任何一种标准的、重要的小部件，我会使用 CocoaTouch。

# python - Python代码的代码覆盖率和单元测试

> ID：272188
> 
> 赞同：26
> 
> 时间：2008-11-07T14:19:49.317
> 
> 标签：python, visual-studio-2008, unit-testing, code-coverage

我已经访问了[Preferred Python unit-testing framework](https://stackoverflow.com/questions/191673/preferred-python-unit-testing-framework)。我不仅关注 Python 单元测试框架，还关注单元测试的代码覆盖率。到目前为止，我只遇到了[coverage.py](http://nedbatchelder.com/code/modules/coverage.html)。有没有更好的选择？

对我来说，一个有趣的选择是通过插件（类似于[IronPython Studio ）将](http://www.codeplex.com/IronPythonStudio)[cpython](http://www.python.org/) 、Python 代码的单元测试和 Python 代码的代码覆盖率与 Visual Studio 2008 集成。可以做些什么来实现这一目标？我期待着建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T19:10:05.923

我们使用这个[Django 覆盖集成](http://www.djangosnippets.org/snippets/705/)，但不是使用默认的coverage.py 报告，而是生成一些简单的 HTML： [使用内置标记器对 Python 源代码进行着色](http://code.activestate.com/recipes/52298/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-27T18:50:18.507

PyDev 似乎允许在 Eclipse 中进行代码覆盖。

我还没有找到如何将它与我自己的（相当复杂的）构建过程集成，所以我在命令行中使用了 Ned Batchelder 的 coverage.py。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T16:22:17.620

还有我认为基于 Ned Batchelder 的coverage.py 的figleaf [。](http://darcs.idyll.org/~t/projects/figleaf/doc/)我们使用[鼻子](http://somethingaboutorange.com/mrl/projects/nose/)作为测试的驱动程序。这一切都很好。我们使用内置的 unittest 和 doctest 模块编写单元测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T03:58:49.237

NetBeans 的新 Python 支持具有紧密集成的代码覆盖支持 -[更多信息请点击此处](http://blogs.oracle.com/tor/entry/netbeans_screenshot_of_the_week6)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-24T19:46:26.987

如果您想要交互式代码覆盖率，您可以在其中实时查看覆盖率统计数据的变化，请查看[Python Coverage Validator](http://www.softwareverify.com/python/coverage/index.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-13T23:12:22.510

[Testoob](http://code.google.com/p/testoob/)有一个简洁的“ `--coverage`”命令行选项来生成覆盖率报告。

# sql - SQL：复杂删除

> ID：272190
> 
> 赞同：1
> 
> 时间：2008-11-07T14:20:36.180
> 
> 标签：sql, count, hsqldb

我基本上创建了一些表来玩：我有两个主表和一个多对多连接表。这是 DDL：（我正在使用 HSQLDB）

```
CREATE TABLE PERSON
(
    PERSON_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    NAME VARCHAR(50), MAIN_PERSON_ID INTEGER
)

CREATE TABLE JOB
(
    JOB_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    NAME VARCHAR(50)
)
CREATE TABLE JOB_PERSON
(
    PERSON_ID INTEGER, 
    JOB_ID INTEGER
)
ALTER TABLE JOB_PERSON ADD 
    CONSTRAINT FK_PERSON_JOB FOREIGN KEY(PERSON_ID) 
    REFERENCES PERSON ON DELETE CASCADE ON UPDATE CASCADE 

ALTER TABLE JOB_PERSON ADD
    CONSTRAINT FK_JOB_PERSON FOREIGN KEY(JOB_ID) 
    REFERENCES JOB ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE PERSON ADD
    CONSTRAINT FK_PERSON_PERSON FOREIGN KEY(MAIN_PERSON_ID) 
    REFERENCES PERSON ON DELETE CASCADE ON UPDATE CASCADE

insert into person values(null,'Arthur', null);
insert into person values(null,'James',0);
insert into job values(null, 'Programmer')
insert into job values(null, 'Manager')
insert into job_person values(0,0);
insert into job_person values(0,1);
insert into job_person values(1,1); 
```

我想创建一个删除语句，根据 PERSON.PERSON_ID 从 JOB 中删除孤儿（如果特定作业的连接表中只存在一个条目）。

在伪语言中：

```
delete from job where job_person.job_id=job.job_id 
AND count(job_person.job_id)=1 AND job_person.person_id=X 
```

其中 X 是一些 person_id。我尝试了很多不同的方法；我认为这是导致问题的“COUNT”部分。我是 SQL 菜鸟，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T14:34:04.623

我不跟。

由于您的 FK 约束，您不能删除`JOB`具有行（甚至是一个）的行。`JOB_PERSON`因此，无法`JOB`根据行删除`PERSON`行。

`JOB_PERSON`必须先删除行，然后才能删除 a`JOB`或`PERSON`可以删除​​。

如果要删除所有`JOB`没有 no 的行`JOB_PERSON`，那么一种方法是：

```
DELETE FROM JOB
WHERE JOB_ID NOT IN (
    SELECT JOB_ID
    FROM JOB_PERSON
) 
```

如果要删除`JOB_PERSON`特定人员的所有行，然后删除所有孤儿，请分两步执行：

```
DELETE FROM JOB_PERSON
WHERE PERSON_ID = X

DELETE FROM JOB
WHERE JOB_ID NOT IN (
    SELECT JOB_ID
    FROM JOB_PERSON
) 
```

如果您只想删除`JOB`以前链接到 X 的孤儿，则需要在第一次删除之前将它们保存在临时表中。

```
INSERT INTO TEMP_TABLE
SELECT JOB.JOB_ID
FROM JOB
INNER JOIN JOB_PERSON
    ON JOB_PERSON.JOB_ID = JOB.JOB_ID
WHERE JOB_PERSON.PERSON_ID = X

DELETE FROM PERSON
WHERE PERSON_ID = X

-- YOUR CASCADING DELETE DOES THIS:
/*
DELETE FROM JOB_PERSON
WHERE PERSON_ID = X
*/

-- Now clean up (only) new orphans on the other side
DELETE FROM JOB
WHERE JOB_ID NOT IN (
    SELECT JOB_ID
    FROM JOB_PERSON
)
AND JOB_ID IN (
    SELECT JOB_ID
    FROM TEMP_TABLE
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T14:36:23.387

这将从您的表 JOB 条目中删除，这些条目在表 JOB_PERSON（Orpheans）中没有条目。

```
DELETE FROM JOB
WHERE JOB_ID NOT IN (
    SELECT JOB_ID
    FROM JOB_PERSON
) 
```

您不能删除由其他表上的外部链接的行...

# java - 启动时中止 java webapp

> ID：272194
> 
> 赞同：5
> 
> 时间：2008-11-07T14:21:54.977
> 
> 标签：java, websphere, web-applications

我的 webapp 是部署到 websphere 服务器中的更大 EAR 的一部分。服务器在同一虚拟服务器上托管许多其他应用程序。我的 webapp 在 servletContextListener->contextInitialized 方法中有一些初始化/健康检查。如果初始化/健康检查失败，我想让 webapp 不可用。这样做的可行方法是什么？从 contextInitialized 中抛出 RuntimeException 就足够了吗？EAR 的其余部分是否仍然可用？谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T17:03:01.437

我建议扔一个`RuntimeException`from `ServletContextListener.contextInitialized`。

Servlet 2.3 对此不是很清楚，但 Servlet 2.4 添加了以下细节：

> 应用程序中另一个组件的调用堆栈下不会发生某些异常。这方面的一个例子是...... ServletContextListener 在通知 servlet 上下文初始化时抛出未处理的异常......。在这种情况下，开发者没有机会处理异常。容器 **可以**使用 HTTP 状态代码 500 来响应对 Web 应用程序的所有后续请求，以指示应用程序错误。

由于它说 servlet 引擎“可能”禁用对应用程序的访问，因此您可能会找到执行其他操作的服务器。但是，Tomcat 和 WebLogic 都禁用了该应用程序，而我能想到的唯一其他合理的事情就是忽略该异常。我看不出有这样的容器非常流行——所以您最好自己在 WebSphere 中测试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T15:34:24.270

抛出 RuntimeException 可能只会使该 servlet 不可用。一种更安全的方法可能是实现类似于 Spring 拦截器的东西，如果检查没有成功，它将转发到错误页面或其他东西。这样，您不需要阻止应用程序加载，而是可以在运行时更优雅地处理它。

# database-design - “伪造”位图索引有意义吗？

> ID：272196
> 
> 赞同：1
> 
> 时间：2008-11-07T14:22:03.527
> 
> 标签：database-design, olap

我正在计划软件，它的核心是一个 OLAP 应用程序（它有助于分析计量数据），并且将为其数据库提供某种星型模式，因为将从不同的角度（时间、来源、类型）查看存储的值等），并且请求将要求提供这些维度的聚合数据。查询往往会提供很多行（最多约 100 000 行）。

我对该主题的研究（另请参阅[我的问题here](https://stackoverflow.com/questions/261743/good-fast-storage-strategy-for-facts-with-dynamically-evolving-dimensions)）似乎表明位图索引是按照我计划的方式搜索数据的好方法。但是，我想支持多个数据库引擎，其中一些不提供其表上的位图索引（特别是 MySQL）。

现在，我当然可以构建和维护自己的位图索引，并使用它来查找指向事实表的行 ID。但是，我怀疑这会破坏索引的全部目的，因为数据库仍将在 B-Tree 中搜索行 ID。有更深厚的理论背景或更多经验的人可以告诉我我是否还能获得任何东西，比如不必在维度表上进行缓慢的 JOIN 操作？

如果答案不直截了当，我也将感谢有关我必须评估的内容的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T14:44:14.963

在使用自定义数据结构处理内存中的大量数据时，我对位图索引很幸运，但是在没有好的（类似 postgresql 的）API 的第三方数据库上实现它们有点尴尬扩展它们的索引结构。

一般来说，因为无论如何您都将通过 B-Tree 索引进行搜索，如果我的经验是任何指导，您将不会获得任何东西。

所以不行。

如果您的应用程序本质上是 OLAP，并且您有少量自然分组为有序范围的维度，并且您确实需要更改问题的渐近线，您可以考虑构建类似“和表”的结构，然后您可以查询它适用于任何具有 2^d 操作的分层答案，如果您正在执行许多相关查询，则可以摊销。

坐标 x 和 y 的 2d 示例，您对 (x1,y1) 到 (x2,y2) 范围内的总和感兴趣。

单独存储，您必须将与该区域成比例的条目数相加。

使用求和表，对于每个位置 (x,y) 不存储该位置的值，而是存储从 (0,0) 到 (x,y) 的区域的总和。

然后你可以通过询问来回答任何范围查询：

和(x2,y2) - 和(x1,y2) - 和(x2,y1) + 和(x1,y1)

恒定数量的开销（好吧，数据集大小的对数，假设您在 x 和 y 上有一个索引并将其存储在 SQL 中）

如果您有复杂的属性不能分解成范围，但可以处理简单的字典索引、日期等，这当然会分解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T14:40:01.553

一些不直接支持位图索引的数据库引擎仍然具有星型优化，可以在不触及事实表的情况下执行此类查询。例如，SQL Server 有一个名为 Index Intersection 的功能，它通过动态构建位图来执行类似的操作来进行解析。Microsoft*声称*其性能可与位图索引相媲美。有关此主题的一些扇出，请参阅[此帖子。](https://stackoverflow.com/questions/126188/ms-sql-server-and-oracle-which-one-is-better-in-terms-of-scalability#126267)

我不确定 MySQL 是否会这样做，但 Postgresql 肯定会这样做。IIRC 的一些变体（我认为是 Greenplum）也直接支持位图索引，并且有人谈到将其合并到主数据库引擎中。我不记得这是否已经完成。

我认为您会发现大多数现代 DBMS 平台都提供了一种或另一种星型查询优化，因此您可能不需要重新发明轮子。您可能会发现一两个无法做到这一点，但您始终可以选择不支持它们。

# asp.net - 为什么我在使用 MsBuild 编译时会丢失 bin 目录中的程序集？

> ID：272199
> 
> 赞同：5
> 
> 时间：2008-11-07T14:23:30.433
> 
> 标签：asp.net, msbuild

我有一个解决方案，其中包含许多类库和一个引用这些程序集的 ASP .NET 网站。

当我从 IDE 中构建解决方案时，网站引用的所有程序集最终都在 bin 目录中。伟大的！

当我从命令行使用 MsBuild 时，所有引用的程序集都不会复制到 bin 目录中。为什么？

我的命令行很简单：

```
msbuild.exe d:\myproject\mysolution.sln 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T22:46:49.490

我面临的问题是我有一个依赖于库项目的项目。为了构建，我遵循以下步骤：

```
msbuild.exe myproject.vbproj /T:Rebuild
msbuild.exe myproject.vbproj /T:Package 
```

这当然意味着我在 bin 中丢失了我的库的 dll 文件，最重要的是在包 zip 文件中。我发现这非常有效：

```
msbuild.exe myproject.vbproj /T:Rebuild;Package 
```

我不知道为什么这个工作或为什么它没有放在首位。但希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T21:22:43.850

我在网上发现了各种关于这个问题的参考资料——我自己也遇到过。显然，命令行上的 MSBuild 在跟踪依赖链方面不如 IDE 好。

据我了解，如果 A 依赖于 B 而 B 又依赖于 C，那么命令行可能不会意识到 A 依赖于 C。

我发现的唯一解决方案是确保您手动设置项目依赖项，以便 ASP 项目引用它所依赖的所有内容 - 不要指望它能够在命令行上将它们全部弄清楚。这对我很有用，虽然我只有 5 个项目，所以这不是一个约束。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T17:45:48.957

You could always use a copy task in MSBuild to pull your assemblies into the proper directory. I asked a question not to long ago and ended up answering it myself. It shows how you can setup your Copy task to grab output from another project and pull it into your target project:

[MSBuild copy output from another project into the output of the current project](https://stackoverflow.com/questions/266888/msbuild-copy-output-from-another-project-into-the-output-of-the-current-project)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T19:07:48.010

我没有为 ASP.NET 使用 msbuild，而是使用 aspnet_compiler。虽然......我不记得为什么。对不起。

```
%windir%\Microsoft.Net\framework\v2.0.50727\aspnet_compiler -v \%~n1  -f -p .\%1 .\Website 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T14:49:07.293

您引用的是哪个 msbuild？是正确的吗？

我通常这样调用（来自批处理文件）：

> %WINDIR%\Microsoft.NET\Framework\v3.5\msbuild.exe deploy.proj /v:n

在此示例中，deploy.proj 只是一个常规的 msbuild 文件，它在对 .sln 文件调用 msbuild 之前和之后执行一些其他操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T14:54:20.840

我认为只有当您的 bin 目录不是框架的默认解决方案时，才会出现此问题。

我了解 msbuild 使用每个项目设置来构建它。如果是这样，请转到每个项目属性页面并检查构建后事件命令行参数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-23T01:48:01.183

您可以利用项目属性中的 Post-Build 步骤将项目的输出复制到特定位置。

这将复制到与 Sln 文件位于同一目录中的 Assemblies 目录。我在所有项目的后期构建步骤中都有这个。

```
md "$(SolutionDir)Assemblies"
del "$(SolutionDir)Assemblies\$(TargetFileName)"
copy "$(TargetPath)" "$(SolutionDir)Assemblies" /y 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-12T13:56:22.250

MSBuild 3.5 和 msbuild 4.5 的已知问题。我正在使用在以下位置找到的 Msbuild 4

```
 c:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <yourSolutionFile>.sln 
```

它似乎解决了这个问题。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2008-11-07T14:59:19.223

如果我记得，MSBuild 不会复制引用的程序集。我刚刚发布了一个“解决方案”： [http ://www.brunofigueiredo.com/post/Issue-Tracker-part-IV-The-Build-Enviroment-using-MSBuild-(or-NAnt).aspx](http://www.brunofigueiredo.com/post/Issue-Tracker-part-IV-The-Build-Enviroment-using-MSBuild-(or-NAnt).aspx)

希望能帮助到你。

# php - PDO try-catch 在函数中的使用

> ID：272203
> 
> 赞同：33
> 
> 时间：2008-11-07T14:24:41.413
> 
> 标签：php, pdo

我正在考虑在我未来的所有 webapp 中使用 PDO。目前（使用到目前为止我从 SO 中学到的知识），我在我的站点中处理数据库连接的是一个像这样的 Singleton 类：

```
class DB {

    private static $instance = NULL;
    private static $dsn      = "mysql:host=localhost;dbname=mydatabase;";
    private static $db_user  = 'root';
    private static $db_pass  = '0O0ooIl1';

    private function __construct() 
    {

    }
    private function __clone()
    {

    }   
    public static function getInstance() {

        if (!self::$instance)
        {           
            self::$instance = new PDO(self::$dsn, self::$db_user, self::$db_pass);
            self::$instance-> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        }
        return self::$instance;
    }
} 
```

和另一个文件（functions.php），其内容特定的功能看起来与这个完全一样：

```
function get_recent_activities ()
{    
    try
    {    
        $db = DB::getInstance();
        // --prepare and execute query here, fetch the result--
        return $my_list_of_recent_activities;
    }
    catch (PDOException $e)
    {
        return "some fail-messages";
    }
}
... 
```

这意味着我必须`try .. catch`在所有功能中重复该部分。

我的问题是：

1.  我应该如何提高效率？（例如，不必`try..catch`在所有功能中重复，但仍然能够在每个功能上返回不同的“失败消息”）
2.  这已经是一个好习惯了吗？我还是 PDO 和 OOP 的新手（还有很多东西要学），所以（到目前为止），我真的看不出有任何缺点或可以改进的地方。

如果这看起来不清楚或太长，我很抱歉。提前致谢。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-07T18:27:55.433

你的实现很好，它可以很好地用于大多数目的。

没有必要将每个查询都放在 try/catch 块中，事实上在大多数情况下您实际上并不想这样做。这样做的原因是，如果查询产生异常，它是致命问题（如语法错误或数据库问题）的结果，而这些问题不是您应该在执行的每个查询中考虑的问题。

例如：

```
try {
    $rs = $db->prepare('SELECT * FROM foo');
    $rs->execute();
    $foo = $rs->fetchAll();
} catch (Exception $e) {
    die("Oh noes! There's an error in the query!");
} 
```

此处的查询将正常工作或根本不工作。它根本不起作用的情况不应该在生产系统上以任何规律发生，因此它们不是您应该在此处检查的情况。这样做实际上会适得其反，因为您的用户会收到一个永远不会改变的错误，并且您不会收到提醒您该问题的异常消息。

相反，只需这样写：

```
$rs = $db->prepare('SELECT * FROM foo');
$rs->execute();
$foo = $rs->fetchAll(); 
```

通常，您想要捕获和处理查询异常的唯一时间是当查询失败时您想要执行其他操作。例如：

```
// We're handling a file upload here.
try {
    $rs = $db->prepare('INSERT INTO files (fileID, filename) VALUES (?, ?)');
    $rs->execute(array(1234, '/var/tmp/file1234.txt'));
} catch (Exception $e) {
    unlink('/var/tmp/file1234.txt');
    throw $e;
} 
```

您需要编写一个简单的异常处理程序来记录或通知您生产环境中发生的数据库错误，并向您的用户显示友好的错误消息而不是异常跟踪。有关如何执行此操作的信息，请参阅[http://www.php.net/set-exception-handler 。](http://www.php.net/set-exception-handler)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T14:43:32.997

这里有几个注意事项：

*   编写此代码是为了考虑几个遗留问题，例如数据库日志记录和数据库配置管理。
*   我强烈建议您在构建自己的解决方案之前先查看现有解决方案。很多人在刚开始的时候会想，他们不想使用现有的框架或库，因为它们太大了，需要太多时间来学习等等，但是在成为这些人中的一员之后，我不能足够强调地说明我将离开我的自定义框架和包装类以转移到框架。我希望搬到 Zend，但有许多优秀的选择可供选择。

哦，我应该指出，这一点说明了如何包装一个函数来处理您的查询的所有异常处理。我现在几乎不会在其他任何地方编写 try catch 块，因为来自查询的堆栈跟踪为我提供了调试和修复问题所需的所有信息。

这是我当前的 PDO 包装类实现：

```
class DB extends PDO 
{
    // Allows implementation of the singleton pattern -- ndg 5/24/2008
    private static $instance;

    // Public static variables for configuring the DB class for a particular database -- ndg 6/16/2008
    public static $error_table;
    public static $host_name;
    public static $db_name;
    public static $username;
    public static $password;
    public static $driver_options;
    public static $db_config_path;

    function __construct($dsn="", $username="", $password="", $driver_options=array()) 
    {
        if(isset(self::$db_config_path))
        {
            try 
            {
                if(!require_once self::$db_config_path)
                {
                    throw new error('Failed to require file: ' . self::$db_config_path); 
                }
            } 
            catch(error $e) 
            {
                $e->emailAdmin();
            }
        }
        elseif(isset($_ENV['DB']))
        {
            self::$db_config_path = 'config.db.php';

            try 
            {
                if(!require_once self::$db_config_path)
                {
                    throw new error('Failed to require file: ' . self::$db_config_path); 
                }
            } 
            catch(error $e) 
            {
                $e->emailAdmin();
            }
        }

        parent::__construct("mysql:host=" . self::$host_name . ";dbname=" .self::$db_name, self::$username, self::$password, self::$driver_options);
        $this->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        $this->setAttribute(PDO::ATTR_STATEMENT_CLASS, array('QueryStatement', array($this)));

        if(!isset(self::$error_table))
        {
            self::$error_table = 'errorlog_rtab';
        }
    }

    /**
     * Return a DB Connection Object
     *
     * @return DB
     */
    public static function connect()
    {

        // New PDO Connection to be used in NEW development and MAINTENANCE development
        try 
        {
            if(!isset(self::$instance))
            {   
                if(!self::$instance =  new DB())
                {
                    throw new error('PDO DB Connection failed with error: ' . self::errorInfo());
                }
            }

            return self::$instance;
        }
        catch(error $e)
        {
            $e->printErrMsg();
        }
    }

    /**
     * Returns a QueryBuilder object which can be used to build dynamic queries
     *
     * @return QueryBuilder
     * 
     */
    public function createQuery()
    {
        return new QueryBuilder();
    }

    public function executeStatement($statement, $params = null, $FETCH_MODE = null)
    {
        if($FETCH_MODE == 'scalar')
        {
            return $this->executeScalar($statement, $params);   
        }

        try {
            try {
                if(!empty($params))
                {
                    $stmt = $this->prepare($statement);
                    $stmt->execute($params);
                }
                else 
                {
                    $stmt = $this->query($statement);
                }
            }
            catch(PDOException $pdo_error)
            {
                throw new error("Failed to execute query:\n" . $statement . "\nUsing Parameters:\n" . print_r($params, true) . "\nWith Error:\n" . $pdo_error->getMessage());
            }
        }
        catch(error $e)
        {
            $this->logDBError($e);
            $e->emailAdmin();
            return false;
        }

        try 
        {
            if($FETCH_MODE == 'all')
            {
                $tmp =  $stmt->fetchAll();
            }
            elseif($FETCH_MODE == 'column')
            {
                $arr = $stmt->fetchAll();

                foreach($arr as $key => $val)
                {
                    foreach($val as $var => $value)
                    {
                        $tmp[] = $value;
                    }
                }           
            }
            elseif($FETCH_MODE == 'row') 
            {
                $tmp =  $stmt->fetch();
            }
            elseif(empty($FETCH_MODE))
            {
                return true;
            }
        }
        catch(PDOException $pdoError)
        {
            return true;
        }

        $stmt->closeCursor();

        return $tmp;

    }

    public function executeScalar($statement, $params = null)
    {
        $stmt = $this->prepare($statement);

        if(!empty($this->bound_params) && empty($params))
        {
            $params = $this->bound_params;
        }

        try {
            try {
                if(!empty($params))
                {
                    $stmt->execute($params);
                }
                else 
                {
                        $stmt = $this->query($statement);
                }
            }
            catch(PDOException $pdo_error)
            {
                throw new error("Failed to execute query:\n" . $statement . "\nUsing Parameters:\n" . print_r($params, true) . "\nWith Error:\n" . $pdo_error->getMessage());
            }
        }
        catch(error $e)
        {
            $this->logDBError($e);
            $e->emailAdmin();
        }

        $count = $stmt->fetchColumn();

        $stmt->closeCursor();

        //echo $count;
        return $count;      
    }

    protected function logDBError($e)
    {
        $error = $e->getErrorReport();

        $sql = "
        INSERT INTO " . self::$error_table . " (message, time_date) 
        VALUES (:error, NOW())";

        $this->executeStatement($sql, array(':error' => $error));
    }
}

class QueryStatement extends PDOStatement 
{
    public $conn;

    protected function __construct() 
    {
        $this->conn = DB::connect();
        $this->setFetchMode(PDO::FETCH_ASSOC);
    }

    public function execute($bound_params = null)
    {
        return parent::execute($bound_params);          
    }
} 
```

# .net - .Net 1.1 Windows 应用程序无法调用 .Net 3.5 WebService

> ID：272207
> 
> 赞同：4
> 
> 时间：2008-11-07T14:25:28.790
> 
> 标签：.net, web-services, .net-3.5, .net-1.1

我有一个奇怪的问题。我有一个在 2.0 框架下编译的 Web 服务，它被一个使用 1.1 框架编译的 Windows 应用程序使用。这工作得很好。现在，将 web 服务升级到 3.5 框架后，windows 应用程序不再能够调用它。

在 3.5 中创建一个小 Windows 应用程序作为测试能够毫无问题地调用 Web 服务，所以我知道它仍然可以工作。

代码中没有任何变化，它只是编译为 3.5 项目而不是 2.0 项目。

对于那些关心我得到什么错误的人来说，就是这样：

> system.web.services.dll 中出现“System.Net.WebException”类型的未处理异常
> 
> 附加信息：基础连接已关闭：接收时发生意外错误。

我可以对 Web 服务做些什么来使其向后兼容（如果这甚至是问题的话）？

[编辑] 对以下答案的回应（到目前为止）：重新发现不起作用，删除和重新添加 Web 服务也不起作用。我不相信这是一个 SOAP 问题，因为 WSDL 是相同的（都显示 SOAP 1.2）。从服务器浏览到 web 服务工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T03:03:20.027

KeepAlives 可能有问题（例如，通过代理）。作为测试，将下面的代码添加到客户端生成的 Reference.cs 中（丑陋——是的）。我在使用 Fiddler（它是一个代理）来测试客户端和服务器之间的通信时看到了这个问题。

```
 // Put this override in the generated Reference.cs of the client proxy
    protected override System.Net.WebRequest GetWebRequest(Uri uri)
    {
        HttpWebRequest webRequest = (HttpWebRequest)base.GetWebRequest(uri);

        webRequest.KeepAlive = false;
        webRequest.ProtocolVersion = HttpVersion.Version10;
        return webRequest;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T14:30:18.017

它可能是 SOAP 1.0 与 SOAP 1.1。默认情况下，3.5 服务可能使用 1.1 或 1.2，我认为可以在 web.config 绑定中进行配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T14:28:12.123

尝试在 .NET 1.1 中“重新发现”Web 服务（可能只是一个测试应用程序），看看问题是否仍然存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-18T17:52:11.840

我遇到了这个问题，并通过在服务上强制使用域信用来解决它。

[网络服务].Credentials = System.Net.CredentialCache.DefaultCredentials;

或者

[webservice].Credentials = new System.Net.NetworkCredential([user], [pwd], [domain]);

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T19:48:57.373

[作为附加的“健全性检查”， soapUI](http://www.soapui.org/)能否成功调用 3.5 网络服务？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T14:30:01.123

您可以直接在 IIS 安装上访问 Web 服务吗？如果没有，请检查 IIS 中的应用程序配置。您必须切换 ASP.NET 的版本。

# sql - SQL 语句缩进的好习惯

> ID：272210
> 
> 赞同：78
> 
> 时间：2008-11-07T14:26:02.673
> 
> 标签：sql, coding-style, indentation

缩进 SQL 语句的公认做法是什么？例如，考虑以下 SQL 语句：

```
SELECT column1, column2
FROM table1
WHERE column3 IN
(
SELECT TOP(1) column4
FROM table2
INNER JOIN table3
ON table2.column1 = table3.column1
) 
```

这应该如何缩进？非常感谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-07T14:31:25.520

```
SELECT column1
     , column2
FROM table1
WHERE column3 IN
(
    SELECT TOP(1) column4
    FROM table2
    INNER JOIN table3
    ON table2.column1 = table3.column1
) 
```

我喜欢把所有**的“，”放在前面**，这样当 SQL 编辑器在 X 行出现错误时，我永远不会搜索它们。

* * *

### 这是不使用这种编写 SQL 语句的人的示例。两者都包含缺少逗号的错误。

```
SELECT sdcolumn123
 , dscolumn234
 , sdcolumn343
 , ffcolumn434
 , sdcolumn543
 , bvcolumn645
  vccolumn754
 , cccolumn834
 , vvcolumn954
 , cvcolumn104
FROM table1
WHERE column3 IN
(
    ...
)

SELECT sdcolumn123, dscolumn234, asdcolumn345, dscolumn456, ascolumn554, gfcolumn645 sdcolumn754, fdcolumn845, sdcolumn954, fdcolumn1054
FROM table1
WHERE column3 IN
(
    ...
) 
```

在第一个示例中，我发现更简单、更快捷。希望这个例子能更多地展示我的观点。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-11-07T14:30:47.690

```
SELECT column1, column2
FROM table
WHERE column3 IN (
    SELECT TOP(1) column4
    FROM table2
    INNER JOIN table3 ON table2.column1 = table3.column1
) 
```

这非常简短且易于阅读。如果选择了更多列或更多连接条件，我会进行调整。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-11-07T14:31:20.933

不确定是否有公认的做法，但现在我会这样做：

```
SELECT 
    column1, 
    column2 
FROM 
    table1 
WHERE 
    column3 IN 
    ( 
     SELECT TOP(1) 
         column4 
     FROM 
         table2 
         INNER JOIN 
         table3 
             ON table2.column1 = table3.column1 
    ) 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-07T14:41:01.897

我喜欢在代码中有“河流”的空白。它使扫描更容易一些。

```
SELECT column1,
       column2
  FROM table1
 WHERE column3 IN (SELECT column4
                     FROM table2
                     JOIN table3
                       ON table2.column1 = table3.column1); 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-11-07T15:03:44.440

我喜欢 jalbert 将关键字排列在右侧的形式。我还要补充一点，我喜欢左边的 AND 和 OR（有些人把它们放在右边。）此外，我喜欢尽可能排列我的等号。

```
 SELECT column1, 
       column2  
  FROM table1, table2 
 WHERE table1.column1 = table2.column4 
   AND table1.col5    = "hi" 
    OR table2.myfield = 678 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-11-07T14:30:42.900

这是我个人的方法。根据连接条件的长度，我有时会在下面的行上缩进它。

```
SELECT
  column1,
  column2
FROM
  table1
WHERE
  column3 IN ( 
    SELECT TOP(1)
      column4
    FROM
      table2
      INNER JOIN table3 ON table2.column1 = table3.column1
  )

SELECT
  column1,
  column2
FROM
  table1
WHERE
  column3 IN ( 
    SELECT TOP(1)
      column4
    FROM
      table2
      INNER JOIN table3
        ON table2.column1 = table3.column1 -- for long ones
  ) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-11-07T15:17:27.610

我为我们的商店编写了一个代码标准，该标准极度偏向于可读性/“可发现性”（后者主要在插入-选择语句中有用）：

```
SELECT 
    column1, 
    column2
FROM 
    table1
WHERE 
    column3 IN
    (
        SELECT TOP(1) 
            column4
        FROM 
            table2
            INNER JOIN table3 ON table2.column1 = table3.column1
    ) 
```

在更复杂的查询中，它的用处变得更加明显：

```
SELECT
    Column1,
    Column2,
    Function1
    (
        Column1,
        Column2
    ) as Function1,
    CASE
    WHEN Column1 = 1 THEN
        a
    ELSE
        B
    END as Case1       
FROM
    Table1 t1
    INNER JOIN Table2 t2 ON t1.column12 = t2.column21
WHERE
    (
        FilterClause1
        AND FilterClause2
    )
    OR
    (
        FilterClause3
        AND FilterClause4
    ) 
```

一旦您迁移到在大多数查询中具有多个连接的系统，根据我的经验，自由使用垂直空间是您处理复杂 SQL 的最佳朋友。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-07T15:02:15.753

SQL 格式化是一个存在大量差异和分歧的领域......但首先，我喜欢关注可读性，并认为无论你做什么，始终遵守任何降低可读性的规则，就像老套路所说的那样， “愚蠢的一致性”（“愚蠢的一致性是简单头脑的妖精”）

因此，这里有一些准则，而不是称它们为规则。对于 SQL 语句中的每个主要子句（Select、Insert、Delete、From、Where、Have、Group BY、Order By ......我可能会遗漏一些）应该很容易识别。因此，我通常将它们缩进最高级别，甚至彼此缩进。然后在每个子句中，我均匀地缩进下一个逻辑子结构......等等......但是如果在任何个别情况下这样做会更易读，我可以随意（并且经常这样做）更改模式......复杂案例语句就是一个很好的例子。因为任何需要水平滚动的东西都会极大地降低可读性，所以我经常在多行上编写复杂的（嵌套的）Case 表达式。当我这样做时，我会尝试根据它在 SQL 语句中的逻辑位置来保持这种语句的开头悬挂缩进，

SQL 数据库代码已经存在很长时间了，因为在计算机使用小写字母之前，所以历史上对大写关键字的偏好，但我更喜欢可读性而不是传统......（现在我使用的每个工具都使用颜色编码关键字反正）

我还会使用表别名来减少眼睛必须扫描的文本量，以便了解查询的结构，只要别名不会造成混淆。在少于 3 或 4 个表的查询中，单字符别名很好，如果所有表都以不同的字母开头，我经常使用表的第一个字母......同样，任何最有助于可读性的东西。最后，如果您的数据库支持它，许多关键字都是可选的，（如别名的“Inner”、“Outer”、“As”等）“Into”（来自 Insert Into）在 Sql Server 上是可选的 - 但不是在 Oracle 上）因此，如果您的代码需要独立于平台，请小心使用它...

你的例子，我会写成：

```
Select column1, column2
From table1 T1
Where column3 In (Select Top(1) column4
                  From table2 T2
                     Join table3 T3
                         On T2.column1 = T3.column1) 
```

或者

```
Select column1, column2
From table1 T1
Where column3 In 
     (Select Top(1) column4
      From table2 T2
         Join table3 T3
            On T2.column1 = T3.column1) 
```

如果 select 子句中有更多列，我会缩进第二行和后续行...我通常不遵守任何严格的（每行一列）规则，因为垂直滚动几乎与水平滚动一样不利于可读性是，特别是如果只有屏幕的前十列有任何文本）

```
Select column1, column2, Col3, Col4, column5,
    column6, Column7, isNull(Column8, 'FedEx') Shipper,
    Case Upper(Column9) 
       When 'EAST'  Then 'JFK'
       When 'SOUTH' Then 'ATL'
       When 'WEST'  Then 'LAX'
       When 'NORTH' Then 'CHI' End HubPoint
From table1 T1
Where column3 In 
     (Select Top(1) column4
      From table2 T2
         Join table3 T3
            On T2.column1 = T3.column1) 
```

以任何方式格式化代码使其最易读......

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-11-07T15:27:58.713

如果你有一个冗长的 SQL 语句，你想重新格式化而不需要所有的打字和制表符，你可以把它放到[这个网站上](http://www.orafaq.com/cgi-bin/sqlformat/pp/utilities/sqlformatter.tpl)，得到一个格式很好的结果。您可以尝试各种格式，看看哪种格式使您的文本最易读。

编辑：我相信[这](http://sqlformat.org/)是 SQL 格式化程序的 2014 年位置。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-11-07T14:44:48.143

我喜欢让查询的不同部分垂直排列。我倾向于为 SQL 使用 8 个空格的制表符，这似乎效果很好。

```
SELECT  column1, 
        column2
FROM    table1
WHERE   column3 IN
(
        SELECT TOP(1) column4
        FROM    table2
        INNER JOIN table3
        ON      table2.column1  = table3.column1
) 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2010-08-21T01:01:51.607

缩进非常非常复杂的 SQL 的示例：

```
SELECT 
    produtos_cesta.cod_produtos_cesta, 
    produtos.nome_pequeno,
    tab_contagem.cont,
    produtos_cesta.sku, 
    produtos_kits.sku_r AS sku_kit, 
    sku_final = CASE
        WHEN produtos_kits.sku_r IS NOT NULL THEN produtos_kits.sku_r
        ELSE produtos_cesta.sku
    END,
    estoque = CASE
        WHEN produtos2.estoque IS NOT NULL THEN produtos2.estoque
        ELSE produtos.estoque
    END,
    produtos_cesta.unidades as unidades1, 
    unidades_x_quantidade = CASE
        WHEN produtos.cod_produtos_kits_tipo = 1 THEN CAST(produtos_cesta.quantidade * (produtos_cesta.unidades / tab_contagem.cont) * produtos_kits.quantidade AS int)
        ELSE CAST(produtos_cesta.quantidade * produtos_cesta.unidades AS int)
    END,
    unidades = CASE
        WHEN produtos.cod_produtos_kits_tipo = 1 THEN produtos_cesta.unidades / tab_contagem.cont * produtos_kits.quantidade
        ELSE produtos_cesta.unidades
    END,
    unidades_parent = produtos_cesta.unidades,
    produtos_cesta.quantidade,
    produtos.controla_estoque, 
    produtos.status
FROM 
    produtos_cesta 
INNER JOIN produtos 
    ON (produtos_cesta.sku = produtos.sku) 
INNER JOIN produtos_pacotes 
    ON (produtos_cesta.sku = produtos_pacotes.sku) 
INNER JOIN (
    SELECT 
        produtos_cesta.cod_produtos_cesta,
        cont = SUM(
            CASE
                WHEN produtos_kits.quantidade IS NOT NULL THEN produtos_kits.quantidade
                ELSE 1
            END
        )
    FROM 
        produtos_cesta 
    LEFT JOIN produtos_kits 
        ON (produtos_cesta.sku = produtos_kits.sku) 
    LEFT JOIN produtos 
        ON (produtos_cesta.sku = produtos.sku) 
    WHERE 
        shopper_id = '" + mscsShopperId + @"' 
    GROUP BY 
        produtos_cesta.cod_produtos_cesta, 
        produtos_cesta.sku, 
        produtos_cesta.unidades 
) 
AS tab_contagem
    ON (produtos_cesta.cod_produtos_cesta = tab_contagem.cod_produtos_cesta)
LEFT JOIN produtos_kits 
    ON (produtos.sku = produtos_kits.sku) 
LEFT JOIN produtos as produtos2
    ON (produtos_kits.sku_r = produtos2.sku) 
WHERE 
    shopper_id = '" + mscsShopperId + @"' 
GROUP BY 
    produtos_cesta.cod_produtos_cesta, 
    tab_contagem.cont,
    produtos_cesta.sku, 
    produtos_kits.sku_r, 
    produtos.cod_produtos_kits_tipo, 
    produtos2.estoque,
    produtos.controla_estoque, 
    produtos.estoque, 
    produtos.status, 
    produtos.nome_pequeno, 
    produtos_cesta.unidades, 
    produtos_cesta.quantidade,
    produtos_kits.quantidade
ORDER BY 
    produtos_cesta.sku, 
    produtos_cesta.unidades DESC 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-03-28T15:04:37.873

由于上面大多数都排列了返回列名，我发现排列表名和条件有助于提高可读性。

```
SELECT 
    column1, 
    column2
FROM 
    table1
WHERE 
    column3 IN
    (
        SELECT TOP(1) 
            column4
        FROM 
            table2 INNER JOIN 
            table3 ON table2.column1 = table3.column1
    ) 
```

当加入条件变长时。

```
SELECT
    Column1,
    Column2
FROM 
    Table1 JOIN 
    Table2 ON 
        Table1.Column3 = Table2.Column4 JOIN 
    Table3 ON 
        Table2.Column1 = Table3.Column1 and
        Table2.ColumnX = @x and
        Table3.ColumnY = @y
WHERE
    Condition1=xxx and
    Condition2=yyy and
    (
        Condition3=aaa or
        Condition4=bbb
    ) 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-08-07T08:54:50.883

这是我对此的看法：

```
select column1, column2
    from table1
    where (column3 in (
        select top(1) column4
            from table2
            inner join table3
                on (table2.column1 = table3.column1)
    ))
; 
```

*   全部小写，因为它更容易阅读小写字符（我们有代码突出显示来强调关键字）也更容易输入
*   关键字上的每个限制或选项（例如 select 上的 from 或 join 上的 on ）都缩进以显示它们对outward关键字的依赖性
*   右括号与开头的缩进级别相同
*   在 where 和 on 子句中使用括号以增加可读性
*   让分号在同一缩进处关闭选择语句，以便更好地区分多个语句（如果您需要像 SAS PROC SQL 那样的语言中的分号）
*   它仍然非常紧凑，不会在整个页面上伸展

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-11-07T14:32:22.553

当然，这取决于个人喜好。如果在团队环境中，为了保持一致性，应该在成员之间达成一致。但这将是我的偏好：

```
SELECT column1, column2
FROM   table1
WHERE  column3 IN(SELECT     TOP(1) column4
                  FROM       table2
                  INNER JOIN table3 ON
                             table2.column1 = table3.column1
                 ) 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-11-07T14:34:04.077

我会这样格式化：

```
SELECT
    column1, 
    column2
FROM 
    table1
WHERE 
    column3 IN (SELECT TOP(1) 
                    column4 
                FROM 
                    table2 
                    INNER JOIN table3 ON table2.column1 = table3.column1) 
```

或像这样：

```
SELECT
    column1, 
    column2
FROM 
    table1
WHERE 
    column3 IN (SELECT TOP(1) column4 
                FROM table2 
                INNER JOIN table3 ON table2.column1 = table3.column1) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-11-07T14:41:26.997

这是我的正常偏好：

```
 SELECT column1
        ,column2
    FROM table1
    WHERE column3 IN (
        SELECT TOP(1) column4
        FROM table2
        INNER JOIN table3
            ON table2.column1 = table3.column1
    ) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-11-07T14:45:43.977

好吧，当然这取决于查询。

对于简单的查询，一个高度正式的缩进方案只是麻烦多于它的价值，实际上会使代码*的*可读性降低，而不是更多。但是随着复杂性的增加，您需要开始更加小心地构建语句，以确保以后可以再次阅读。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-11-07T14:52:18.177

是的，这是相当主观的......但这是我的 2 美分：

```
SELECT
   Column1,
   Column2
FROM Table1
WHERE 
   Column3 IN (
      SELECT Column4
      FROM Table2
      JOIN Table3 ON
         Table2.Column1 = Table3.Column1
   ) 
```

但是，真的，我可能会在没有 IN 的情况下重写它：

```
SELECT
   Column1,
   Column2
FROM Table1
JOIN Table2 ON
   Table1.Column3 = Table2.Column4
JOIN Table3 ON
   Table2.Column1 = Table3.Column1 
```

基本上，我的规则是：

*   大写关键字
*   列在单独的行上，但 SELECT 修饰符（SELECT TOP 100、SELECT DISTINCT 等）或单个列（SELECT 1、SELECT Id、SELECT * 等）在同一行上
*   在 JOIN 子句下缩进的连接条件
*   将 JOIN 用于 INNER JOIN（因为它是常见的），并完全指定其他（LEFT OUTER JOIN、FULL OUTER JOIN 等）
*   在同一行打开括号，在单独的行关闭括号。如果您有别名，则别名与紧括号一起使用。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-11-07T16:40:56.647

我刚刚把它通过我的 SQL 美化器，结果是这样的......

```
SELECT column1, column2
FROM table1
WHERE column3 IN
(
SELECT TOP(1) column4
    FROM table2
            INNER JOIN table3
            ON table2.column1 = table3.column1
) 
```

[http://extras.sqlservercentral.com/prettifier/prettifier.aspx](http://extras.sqlservercentral.com/prettifier/prettifier.aspx)

.....但是我还没有找到一种将颜色输入 StackOverflow 的方法。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-11-07T14:34:11.723

我不知道是否有标准，但我喜欢这样做；

```
SELECT column1, column2
  FROM table1
WHERE column3 IN
(
    SELECT TOP(1) column4
      FROM table2
    INNER JOIN table3
      ON table2.column1 = table3.column1
) 
```

因为我可以更好地阅读和分析 SQL。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-01-03T05:56:03.267

```
SELECT
    Column1,
    Column2
FROM
    Table1
WHERE
    Column3 IN
    (
        SELECT TOP (1)
            Column4
        FROM 
            Table2
        INNER JOIN 
            Table3
        ON
            Table2.Column1 = Table3.Column1
    ) 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-07T14:31:41.477

我通常做的是，

```
print("SELECT column1, column2
       FROM table1
       WHERE column3 IN (SELECT TOP(1) column4
                         FROM table2 INNER JOIN 
                              table3 ON table2.column1 = table3.column1)"); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-11-07T14:44:21.607

这是一个品味问题。

这是我的偏好。

```
SELECT 
  column1
 ,column2
FROM
  table1
WHERE column3 IN (
                 SELECT TOP(1) column4
                 FROM 
                   table2
                   INNER JOIN table3
                 ON table2.column1 = table3.column1
                 ) 
```

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2013-07-26T09:01:54.880

这就是我们在这里的做法：

```
选择
        第 1 列，
        第 2 列，
        COLUMN5 = 'X' 时的情况
                        和
                        第 6 列 = 'Y'
                然后是“一个”
                当 COLUMN5 在 (
                                'AAA',
                                'BBB'
                        )
                然后是“两个”
                否则“三”
        以 COLUMN7 结尾
从
        表格1
在哪里
        第 2 列 (
                选择顶部(1)
                        第 4 栏
                从
                        表2
                        内部联接
                        表3
                                在
                                        表 2.COLUMN1 = 表 3.COLUMN1
                                        和
                                        表 2.COLUMN2
                                                之间
                                                        表 3.COLUMN2
                                                        和
                                                        表 3.COLUMN3
        )

```

我们的想法是：将 sql 关键字保持小写，并将所有变化的（因此“更有趣”）的东西（例如表或列名）都放在大写中。此处的代码可能看起来有点“夸张”，但如果您的复杂查询的名称（包括架构等）比本示例中的长得多，它会增加可读性。并且：根据对象的“级别”缩进所有对象。

# python - 来自 Windows PowerShell 中 ipy.exe 的“文件 -X：不存在”消息

> ID：272233
> 
> 赞同：1
> 
> 时间：2008-11-07T14:31:30.603
> 
> 标签：python, powershell, ironpython

如果我在 MS-DOS 命令提示符窗口中键入这一行：

```
ipy -X:ColorfulConsole 
```

IronPython 在启用彩色控制台选项的情况下按预期启动。但是，如果我在 Windows PowerShell 中键入同一行，我会收到以下消息：

```
File -X: does not exist 
```

有人可以解释我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T14:45:15.990

试试这个代码：

```
ipy '-X:ColorfulConsole' 
```

或者 Windows PowerShell 中支持的任何引用机制 - shell 正在拆分您的论点。

打字

```
ipy -X: ColorfulConsole 
```

在 MS-DOS 命令提示符窗口中返回相同的响应：

`File -X: does not exist`.

# language-agnostic - 处理器优化代码有哪些技巧？

> ID：272246
> 
> 赞同：10
> 
> 时间：2008-11-07T14:34:36.993
> 
> 标签：language-agnostic, optimization, processor

我正在寻找诸如在多处理器的情况下甚至可能破坏代码的代码重新排序之类的东西。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-07T14:48:34.580

最重要的是内存访问重新排序。

没有内存栅栏或序列化指令，处理器可以自由地重新排序内存访问。一些处理器架构对它们可以重新排序的数量有限制；Alpha 以最弱（即最能重新排序）而闻名。

可以在 Linux 内核源文档的[Documentation/memory-barriers.txt](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=blob;f=Documentation/memory-barriers.txt;hb=HEAD)中找到对该主题的非常好的处理。

大多数时候，最好使用编译器或标准库中的锁定原语；这些都经过了很好的测试，应该有所有必要的内存屏障，并且可能已经非常优化（优化锁定原语很棘手；即使是专家有时也会弄错）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T14:39:08.157

是的，但你的问题到底是什么？

然而，因为这是一个有趣的话题：编译器和处理器用来优化代码的技巧不应该破坏代码，即使是多个处理器，在代码中没有竞争条件的情况下。这称为顺序一致性保证：如果您的程序没有任何竞争条件，并且所有数据在访问之前都被正确锁定，那么代码的行为就好像它是按顺序执行的一样。

Herb Sutter 有一个非常好的视频在这里谈论这个：

[http://video.google.com/videoplay?docid=-4714369049736584770](http://video.google.com/videoplay?docid=-4714369049736584770)

每个人都应该看这个:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T14:44:42.277

[维基百科在这里](http://en.wikipedia.org/wiki/Compiler_optimization)有一个相当全面的优化技术列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T14:58:03.500

DavidK 的回答是正确的，但是了解您的语言/运行时的内存模型也非常重要。即使没有竞争条件并且具有顺序一致性和互斥锁使用情况，当运行在 cpu 不同内核中的不同线程缓存数据时，您的代码仍然可能中断。一些语言，Java 就是一个例子，在使用互斥锁时确保线程之间的数据状态，但是仅仅确保没有两个线程可以同时访问数据是不够的。您需要以正确的方式使用互斥锁，以确保语言运行时同步两个线程之间的数据状态。在java中，这是通过让两个线程在同一个对象上同步来完成的。

这是一个很好的页面，解释了这个问题以及它是如何在 javas 内存模型中处理的。

[http://gee.cs.oswego.edu/dl/cpj/jmm.html](http://gee.cs.oswego.edu/dl/cpj/jmm.html)

# sql-server - 使用 TRUNCATE_ONLY 替代备份日志

> ID：272254
> 
> 赞同：4
> 
> 时间：2008-11-07T14:37:58.970
> 
> 标签：sql-server, sql-server-2005, sql-server-2000

这段 T-SQL 在 2005 年被弃用：

```
BACKUP LOG [DB_NAME] WITH TRUNCATE_ONLY 
```

我不需要为我的数据库保留日志备份 - 但如果我们将来移植到 SQL2008 或后续版本，我不希望这段代码停止工作。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T14:44:39.220

将数据库恢复模式切换为 SIMPLE，然后使用 DBCC SHRINKFILE。然后恢复您原来的恢复模式。如果您的 LOG 文件没有缩小，您可能有未提交的事务。有关更多详细信息，请参阅 Tibor 的 Karaszi 关于[收缩](http://www.karaszi.com/SQLServer/info_dont_shrink.asp)的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T14:44:05.570

如果您将数据库的恢复模式更改为简单，我认为它将停止强制您备份/截断日志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T14:49:52.097

更改您的数据库以使用简单恢复模型。这意味着您没有时间点恢复（如果您要截断日志，则无论如何都不会有），但是日志文件会自动循环并且不会变得太大。

日志文件是强制性的，您别无选择，只能保留它，您不希望它失去控制并填满您的磁盘。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T15:03:31.617

正如安迪琼斯回答的那样，日志文件是强制性的。它不仅仅是为了您而记录的事件，而是数据库处理事务回滚和内存提交方式的重要组成部分。

# html - 我该如何更新此代码

> ID：272270
> 
> 赞同：2
> 
> 时间：2008-11-07T14:41:39.787
> 
> 标签：html, legacy

```
 <object height="25" width="75" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">
        <param value="http://click-here-to-listen.com/players/iaPlay13.swf?x=1058286910FTRZGK" name="movie"/> 
        <param value="high" name="quality"/>
        <param value="#FFFFFF" name="bgcolor"/> 
        <param value="opaque" name="wmode"/>
        <embed height="25" width="75" wmode="opaque" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" bgcolor="#FFFFFF" quality="high" src="http://click-here-to-listen.com/players/iaPlay13.swf?x=1058286910FTRZGK"/>
    </object> 
```

我必须将此旧标记插入到我正在构建的新站点中。问题是它使用`<embed>`标签。

`<embed>`对于那些没有闪存的人，我是否会取消并放入一些内容作为替代方案？基本上我只是想把这段 html 带入 21 世纪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T14:53:12.697

您可以嵌套对象元素以显示备选方案。W3C[在这里](http://www.w3.org/TR/html401/struct/objects.html#h-13.3)解释它。我在下面复制了一个片段：

> OBJECT 元素设计的一个重要结果是它提供了一种指定替代对象渲染的机制。每个嵌入的 OBJECT 声明都可以指定替代的内容类型。如果用户代理无法渲染最外层的 OBJECT，它会尝试渲染内容，可能是另一个 OBJECT 元素等。
> 
> 在下面的例子中，我们嵌入了几个 OBJECT 声明来说明交替渲染是如何工作的。用户代理将尝试按以下顺序呈现它可以呈现的第一个 OBJECT 元素：(1) 用 Python 语言编写的地球小程序，(2) 地球的 MPEG 动画，(3) 地球的 GIF 图像, (4) 替代文本。

```
<P>                 <!-- First, try the Python applet -->
<OBJECT title="The Earth as seen from space" 
    classid="http://www.observer.mars/TheEarth.py">
                <!-- Else, try the MPEG video -->
    <OBJECT data="TheEarth.mpeg" type="application/mpeg">
                <!-- Else, try the GIF image -->
      <OBJECT data="TheEarth.gif" type="image/gif">
                <!-- Else render the text -->
       The <STRONG>Earth</STRONG> as seen from space.
     </OBJECT>
   </OBJECT>
</OBJECT> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T15:11:09.323

我建议您使用**swfobject**，它是一个跨平台的开源库，可以在您的页面上显示 Flash。

[http://code.google.com/p/swfobject/](http://code.google.com/p/swfobject/)

有多种方法可以加载 Flash 和替代（非 Flash）内容。例如，以下代码可以替换您的代码：

```
<script type="text/javascript" src="swfobject.js"></script>
<script type="text/javascript">
    swfobject.embedSWF("http://click-here-to-listen.com/players/iaPlay13.swf?x=1058286910FTRZGK", 
        "myContent", "25", "75", "9.0.0");
</script>
<div id="myContent">
  <p>Alternative content</p>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T14:52:35.880

我使用函数 AC_FL_RunContent 来嵌入 Flash 对象 - 这很好，因为它支持所有浏览器并且是 Adob​​e 推荐的。

更多在[这里](http://www.adobe.com/devnet/activecontent/articles/devletter.html)：

他们还建议使用 <object> 标签而不是 <embed>

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T14:54:30.510

基本上，你应该继续嵌入，因为它是一些旧浏览器的后备。它可能会损害页面的验证，但只要您知道它为什么存在，就可以了。

至少这是 Adob​​e 官方推荐的方式：[Macromedia Flash OBJECT 和 EMBED 标签语法](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_4150 "Macromedia Flash OBJECT 和 EMBED 标签语法")

你想做二十一世纪的代码是对的，但我们必须处理上千年的浏览器...... :-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T14:58:59.753

我在网络上找到了这个代码（来自一个可用性网站），它适合 IE 和其他人，我在我的 flash 页面上使用它（我已经将它更改为你的代码）：

```
<!--[if !IE]> -->
<object type="application/x-shockwave-flash" data="http://click-here-to-listen.com/players/iaPlay13.swf?x=1058286910FTRZGK" width="75" height="25">
<!-- <![endif]-->

<!--[if IE]>
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="75" height="25">
  <param name="movie" value="http://click-here-to-listen.com/players/iaPlay13.swf?x=1058286910FTRZGK" />
<!--><!--dgx-->
  <param name="loop" value="false">
  <param name="menu" value="false">
  <param name="quality" value="high">
</object>
<!-- <![endif]--> 
```

# usb - 如何让电脑闪灯

> ID：272286
> 
> 赞同：8
> 
> 时间：2008-11-07T14:46:12.760
> 
> 标签：usb, monitoring, status, health-monitoring

我想要一个用 C# 编写的应用程序监视器来监控一组外汇交易头寸。它将通过 USB 连接到位于桌子上的一组真实的“交通灯”，用于指示系统状态。任何人都可以提出一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T15:01:21.167

通常我会说并行端口或其他类似的东西，但如果你对 USB 寄予厚望，那么*一定*要看看[Arduino](http://www.arduino.cc/)。它是一款成本非常低的微控制器，可以独立运行，也可以通过许多灵活的接口（包括 USB）与 PC 通信。

它在爱好者社区中非常受欢迎，因此，有许多入门级项目可以开始使用该设备。Sparkfun 的价格[为 35 美元](http://www.sparkfun.com/commerce/product_info.php?products_id=666)，完全组装的支持 USB 的版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T15:17:03.150

最简单的解决方案是购买一个 USB 交通灯，而不是自己建造一个。例如[USB Ampel](http://www.cleware.de/p-usbampel-E.html)。如果包含一个简单的 API，它可能会容易得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T14:58:33.530

我已使用[此 CodeProject 文章](http://www.codeproject.com/KB/vb/PortAccess.aspx)中的概念成功点亮 LED。如果满足以下条件，它可能会满足您的要求：

*   您可以使用并行端口而不是 USB（或者可能是 USB 到并行电缆/加密狗）
*   您已准备好解决一些焊接和简单的电子修补问题
*   你可以修改vb代码来监控你的状态

正如作者在文章中提到的，***如果您不小心，您可能会破坏计算机的并行端口（甚至更糟！）***。

此外，优秀的工程师会坚持将灯与端口隔离，以进一步保护计算机。（继电器、双向可控硅、光隔离器等）

话虽如此，它确实有效！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T14:49:40.613

传统上人们使用 X10 自动化框架来处理这类事情。我公司的人用它来控制熔岩灯，以指示我们持续集成构建的状态。

有一个指针指向[如何开始编写与 x10 协议交互的应用程序？](https://stackoverflow.com/questions/141338/how-does-one-get-started-writing-applications-that-interact-with-x10-protocol)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-07T15:01:14.023

更进一步的是使用像[Arduino](http://www.arduino.cc/)这样的微控制器平台自己构建一些东西。[Arduino Playground](http://www.arduino.cc/playground/Projects/ArduinoUsers)页面上提供了 Arduino 平台可能实现的一些示例。

[Instructables上](http://www.instructables.com/id/Arduino_Making_a_set_of_traffic_lights/)[有一篇](http://www.instructables.com/id/Arduino_Making_a_set_of_traffic_lights/)关于如何使用 Arduino 制作红绿灯的文章。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-07T15:41:19.950

Channel9 有一个来自 Microsoft PDC 的视频，展示了一些开发人员如何使用“Build Bunny”来完成类似的事情：[PDC2008 ShowOff 条目：Brian the Build Bunny](http://channel9.msdn.com/posts/briankel/PDC2008-ShowOff-Entry-Brian-the-Build-Bunny/)

这里还有更多信息和[源代码](http://www.woodwardweb.com/vsts/behind_brian_th.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T19:18:09.727

在我的上一份工作中，我们使用这个产品来控制一组旋转的交通信号灯，当我们的 CI 服务器上的构建中断时。以太网很好，因此您不限于 USB 的 3M 范围，它就像打开 TCPClient 到端口 10000 并发送“1R1\r”一样简单。

[http://www.6bit.com/products/smartrelayE.php?products_id=33](http://www.6bit.com/products/smartrelayE.php?products_id=33)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-07T15:17:52.943

尝试使用简单的 USB 实验接口，例如 Phidg​​ets (Www.phidgets.com) 或 Velleman k8055 USB 实验板 ( [http://www.velleman.be/ot/en/product/view/?id=351346](http://www.velleman.be/ot/en/product/view/?id=351346) )。

# vba - 在 Microsoft Word 2003 中调用宏

> ID：272302
> 
> 赞同：2
> 
> 时间：2008-11-07T14:51:29.863
> 
> 标签：vba, ms-word

我需要加强 Microsoft Word 文档的结构。
例如：

**风格问题在这里等等等等**
*风格答案在这里等等等等*

此处的强制执行将是“答案”样式不能放置，除非其上方有“问题”样式。

为此，我将使用宏，因此理想情况下，我想在每次编辑文档时调用我的宏。

我已通读 Microsoft Office Word 2003 Visual Basic 参考，但未发现任何具有此效果的事件。

有谁知道如何做到这一点。或者任何人有任何其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T14:54:13.197

此线程[事件 - 已编辑文档](https://stackoverflow.com/questions/269252/vba-event-for-document-edited)与 Word 文档的事件相关，包括更改事件。也许它会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T14:54:47.717

> 或者任何人有任何其他想法？

您可以使用一个按钮打开自定义对话框，用户可以在其中输入问题和答案，然后按 Enter，然后对话框会自动正确格式化问题/答案。只有一条路要走。。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T14:57:45.840

我想知道 WindowSelectionChange 是否可行。

# asp.net-mvc - 在 ASP.NET MVC 中动态更改主模板

> ID：272313
> 
> 赞同：5
> 
> 时间：2008-11-07T14:54:21.057
> 
> 标签：asp.net-mvc, master-pages

我需要在我的应用程序 (ASP.NET MVC) 上支持不同的母版页。推荐的方法是什么：

1.  将母版页名称传递给视图。
2.  存储母版页（在会话中或其他内容中），以便在用户访问期间保持不变。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T11:01:38.783

使用自定义基本控制器并从它继承：

```
Public Class CustomBaseController
    Inherits System.Web.Mvc.Controller

    Protected Overrides Function View(ByVal viewName As String, ByVal masterName As String, ByVal model As Object) As System.Web.Mvc.ViewResult

       Return MyBase.View(viewName, Session("MasterPage"), model)

    End Function

End Class 
```

我在 global.asax Session_Start 中设置了我的 Session 变量：

```
Sub Session_Start(ByVal sender As Object, ByVal e As EventArgs)

//programming to figure out your session
Session("MasterPage")="MyMasterPage"

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T15:12:11.927

您可以将母版页名称放入会话中，但会话不可靠。我建议把它扔进数据库。

进入页面后，您可以通过访问 page.masterpagefile 更改/设置母版页。这是一个字符串；只需传入 .master 名称即可。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-11-07T15:20:05.593

为什么不将母版页保留在用户配置文件中？然后只需在 PreLoad 事件上更改它。

[http://www.odetocode.com/articles/440.aspx](http://www.odetocode.com/articles/440.aspx)

# asp.net - 部署到 IIS 时 ASP.NET 应用程序中断

> ID：272338
> 
> 赞同：0
> 
> 时间：2008-11-07T15:01:50.247
> 
> 标签：asp.net, iis, deployment, nullreferenceexception, ikvm

我正在开发一个用于在线购物的小型 ASP.NET 网站，在 Visual Studio 中对其进行测试时，一切正常，但是当我将其部署到 IIS 时，情况不再如此。

问题似乎出在我引用的 DLL 文件中，该 DLL 文件包含我需要初始化的类并将查询请求发送到具有所有产品信息的另一台服务器。这个 DLL 最初是一个 Jar 文件，我使用 IKVM 将其转换为 DLL。

当我将应用程序部署到 IIS 时，尝试实例化在该 DLL 中定义的对象的任何页面都会失败并显示空引用，例如：

```
Fulfiller fulfiller = new Fulfiller();
string result = fulfiller.initialize("host", port, "user", "pass"); 
```

返回此错误：

> `System.NullReferenceException`： 你调用的对象是空的。在`Fulfiller.toLog(String )`在 `Fulfiller.initialize(String str1, Int32 i, String str2, String str3)` _`Orders.createDataSource()`

现在再次，这在 VS 开发服务器上完美运行，但在 IIS 中中断，我不知道为什么。在 IIS 上运行时，DLL 没有正确加载是某种编码问题吗？还是 IIS 的问题，可能会阻止 DLL 执行或发送请求，我非常渴望解决这个问题

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T15:11:51.007

通常，当在开发服务器上工作的东西在 IIS 上不起作用时，问题是授权（VS 服务器在您的凭据下运行，但 IIS 作为“网络服务”或其他系统用户运行）。

例如，我看到您的代码在fulfiller.toLog() 上中断。

会不会是 toLog() 函数试图打开一个日志文件，而被 IIS 模拟的用户无权读取或写入它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T16:45:40.770

我没有使用过 IKVM，但我确信服务器上必须安装一些 IKVM 运行时。你检查过服务器上的 IKVM 吗？

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T15:23:08.737

我赞同洛里斯的回答。

开发服务器具有您的权限。假设您要部署到 Windows Server 或任何运行 Active Directory 的机器，您应该能够右键单击存储日志文件的目录并选择属性。在对话框中，将有一个标签为安全的选项卡。如果网络服务用户（或 IUSR_machinename）不可见，您必须将它们添加到列表中。选择用户并为其分配读写权限。

不要授予 IIS 用户对整个应用程序目录的完全权限。这是一个巨大的安全漏洞，因此默认部署不会为您提供当前所需的权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T15:04:19.757

什么是fulfiller.Initialize() 在做什么？您可以发布该代码吗？

显然，您有一个实现者引用，因为您不能无错误地传递构造函数然后有一个空引用。

# javascript - 免费的 JavaScript 混淆器？

> ID：272342
> 
> 赞同：6
> 
> 时间：2008-11-07T15:02:51.133
> 
> 标签：javascript, compression, obfuscation

我正在寻找一个*免费*的JavaScript 混淆器。压缩就够了吗？你会推荐什么工具？当然，我不需要军事风格的混淆，我需要一种*简单*的方法来防止小子通过查看源代码或使用诸如 unescape() 之类的简单方法来窃取我的 javascript。

谢谢，汤姆

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-07T15:09:00.420

您的问题是，无论您如何压缩或隐藏它，最终浏览器都必须对其进行解释。您能做的最好的事情是将所有变量重命名为无意义的随机变量，并删除所有注释和空格。

**几个好工具：**

*   [http://www.dev411.com/dojo/javascript_compressor/](http://www.dev411.com/dojo/javascript_compressor/)
*   [http://javascriptcompressor.com/Default.aspx](http://javascriptcompressor.com/Default.aspx)
*   [http://developer.yahoo.com/yui/compressor/](http://developer.yahoo.com/yui/compressor/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-08T07:54:03.463

您可以使用 /packer/

[http://dean.edwards.name/packer/](http://dean.edwards.name/packer/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-07T22:58:19.007

根据经验，不要使用使用 eval 的混淆器，因为这会减慢您的页面速度，请使用不使用的压缩器。这将为新手提供混淆，无论如何其他人都不会被任何混淆器吓倒。

大多数混淆器最终会创建一个代表代码的字符串，然后使用 eval，这可以通过简单的警报语句撤消，有什么意义？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-07T15:17:25.520

如果你想要简单的混淆和出色的压缩，我可以推荐 Yahoo 的[YUI Compressor](http://developer.yahoo.com/yui/compressor/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-13T07:51:56.400

看看那些正在寻找的人 - [http://javascript-reference.info/javascript-obfuscators-review.htm](http://javascript-reference.info/javascript-obfuscators-review.htm) - JS混淆器的很好的概述

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T16:14:51.097

我也会推荐 YUI Compressor，效果很好，可以压缩和混淆，还对 javascript 编码提出建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-13T14:42:39.700

我也投票给Packer。有在线版本、独立版本，甚至还有一个控制台版本，我在构建 Web 应用程序时使用这些版本自动打包我的 javascript。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-07T22:52:25.037

试试[http://digua.sourceforge.net](http://digua.sourceforge.net)。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-07T15:06:10.893

[http://www.javascriptobfuscator.com/Default.aspx](http://www.javascriptobfuscator.com/Default.aspx)

[http://ajaxian.com/archives/utility-javascript-obfuscator](http://ajaxian.com/archives/utility-javascript-obfuscator)

# reliability - 您如何评估软件的可靠性？

> ID：272345
> 
> 赞同：7
> 
> 时间：2008-11-07T15:03:45.827
> 
> 标签：reliability

我们目前正在为我们将要进行的贸易研究制定评估标准。

我们选择的标准之一是可靠性（和/或稳健性 - 这些是否相同？）。

您如何评估软件是否可靠而无需花费大量时间进行评估？

编辑：按照 KenG 的回答，缩小问题的重点：您可以在 50 种现有软件解决方案中进行选择。您需要评估它们的可靠性，而不是能够测试它们（至少在最初）。您可以使用哪些*有形*指标或其他指标来评估所述可靠性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T15:33:00.543

可靠性和稳健性是系统的两个不同属性：

[可靠性](http://en.wikipedia.org/wiki/Reliability)

> IEEE 将其定义为“……系统或组件在规定的时间段内，在规定的条件下执行其所需功能的能力”。

[鲁棒性](http://en.wikipedia.org/wiki/Robustness#Computer_Science)

> 如果它在输入、计算等异常的情况下继续运行，则它是稳健的。

因此，一个*可靠*的系统会按照其设计的约束条件执行其功能；如果发生意外/未预料到的情况，*稳健*的系统将继续运行。

如果您可以访问您正在评估的软件的任何历史记录，则可以从报告的缺陷、随着时间的推移“补丁”发布的数量，甚至代码库中的流失中推断出一些关于可靠性的想法。

产品是否有自动化测试流程？测试覆盖率可能是信心的另一个指标。

一些使用敏捷方法的项目可能不太符合这些标准——预计会频繁发布和大量重构

与软件/产品的当前用户核实真实世界的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T15:16:03.837

这取决于您正在评估的软件类型。网站的主要（也许是唯一的）可靠性标准可能是其正常运行时间。 [NASA](http://satc.gsfc.nasa.gov/support/ISSRE_NOV98/software_metrics_and_reliability.html)将对其软件的可靠性有一个完全不同的定义。您的定义可能介于两者之间。

如果您没有很多时间来评估可靠性，那么自动化您的测量过程绝对是*至关重要的。*您可以使用[持续集成](http://martinfowler.com/articles/continuousIntegration.html)工具来确保您只需手动查找一次错误。

我建议您或您公司的某个人阅读[持续集成：提高软件质量和降低风险](https://rads.stackoverflow.com/amzn/click/com/0321336380)。我认为这将有助于引导您对软件可靠性进行自己的定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T15:16:02.573

好吧，“可靠”这个关键词可能会导致不同的答案……在考虑可靠性时，我想到了两个方面：

1.  总是给出正确答案（或最佳答案）
2.  总是给出相同的答案

无论哪种方式，我认为它归结为一些可重复的测试。如果有问题的应用程序没有使用强大的单元测试和验收测试套件构建，您仍然可以提出一组手动或自动测试来重复执行。

测试总是返回相同结果的事实将表明第 2 方面得到了照顾。对于第 1 方面，这实际上取决于测试编写者：提出可以暴露错误或缺陷的良好测试。

如果不知道应用程序是关于什么的，我无法更具体，抱歉。例如，如果消息始终被传递、永不丢失、永不包含错误等，那么消息传递系统将是可靠的……计算器对可靠性的定义会大不相同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T15:16:03.337

与已经使用它的人交谈。您可以测试自己的可靠性，但这很困难、昂贵，并且可能非常不可靠，具体取决于您要测试的内容，尤其是在您时间紧迫的情况下。大多数公司愿意让您与现有客户联系，如果这有助于向您销售他们的软件，并且他们将能够让您对软件的处理方式有一个真实的了解。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T15:16:56.627

与任何事情一样，如果您没有时间自己评估某件事，那么您必须依靠他人的判断。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T15:59:04.577

可靠性是事物有效性的三个方面之一。另外两个是可维护性和可用性...

一篇有趣的论文... [http://www.barringer1.com/pdf/ARMandC.pdf](http://www.barringer1.com/pdf/ARMandC.pdf)更详细地讨论了这一点，但一般来说，

可靠性基于系统崩溃的概率。即，越有可能崩溃，可靠性越低……在其他系统（软件除外）中，它通常以平均故障间隔时间 (MTBF) 来衡量）这是硬盘之类的常用指标...（10000 小时 MTBF）在软件中，我想您可以用关键系统故障之间、应用程序崩溃之间、不可恢复错误之间或错误之间的平均时间来衡量它任何阻碍或不利影响正常系统生产力的...

可维护性是衡量当它发生故障时修复它需要多长时间/多昂贵（多少工时和/或其他资源）的量度。在软件中，您可以在此概念中添加增强或扩展软件的时间/成本（如果这是一个持续的要求）

可用性是前两者的结合，它向计划者表明，如果我有 100 个这样的东西运行了十年，在计算出故障以及每个故障单元在修复、修理时不可用多长时间之后，平均而言，这 100 家中有多少家会在任何时候启动并运行？20% 还是 98% ？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T15:16:13.963

您必须通过理解并完全接受您将做出妥协来进入该过程，如果可靠性是关键标准并且您没有（或不愿意承诺）适当评估的资源，这可能会产生负面影响基于此。

话虽如此 - 确定使软件可靠性至关重要的关键要求是什么，然后设计测试以根据这些要求进行评估。

鲁棒性和可靠性相互交叉，但不一定相同。

如果您的数据服务器无法处理超过 10 个连接，并且您希望有 100000 个连接 - 它并不可靠。如果它在 > 10 个连接处死掉，那将是不可靠的。如果同一台服务器可以处理所需的连接数但间歇性地死机，您可以说它仍然不健壮且不可靠。

我的建议是您咨询一位经验丰富的 QA 人员，该人员在您将进行的研究方面具有丰富的知识。该人将能够帮助您设计关键领域的测试 - 希望在您的资源限制范围内。我会推荐一个中立的第三方（而不是软件编写者或供应商）来帮助你决定你需要测试的关键特性来做出决定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-08T04:44:36.600

如果您无法对其进行测试，则必须依赖开发人员的声誉以及他们在此应用程序上遵循与其他测试应用程序相同的做法的程度。示例：Microsoft 在其应用程序的版本 1 方面做得不是很好，但 3 和 4 通常都非常好（Windows ME 是版本 0.0001）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-04T20:14:50.400

根据您正在评估的服务类型，您可能会获得可靠性指标或 SLI - 服务级别指标 - 衡量服务/产品执行情况的指标。例如 - 在 1 秒内处理 99% 的请求。

根据 SLI，您可以设置服务级别协议 - 您和软件提供商之间关于您想要什么 SLO（服务级别目标）的合同，而不是他们不提供这些的后果。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-28T15:08:04.307

我的建议是围绕 SLI、SLO 和 SLA 遵循 SRE 方法，最好在免费电子书中进行总结：

*   提供主要介绍的[站点可靠性工程](https://landing.google.com/sre/sre-book/toc/)
*   带有具体示例[的站点可靠性工作簿](https://landing.google.com/sre/workbook/toc/)

更多地从您需要的工具角度看待可靠性：

*   监控基础设施（我推荐[Prometheus](https://prometheus.io)）
*   警报（我推荐[Prometheus AlertManager](https://prometheus.io/docs/alerting/latest/alertmanager)、[OpsGenie](https://www.atlassian.com/software/opsgenie)或[PagerDuty](https://www.pagerduty.com)）
*   SLO 计算工具，例如[slo-exporter](https://medium.com/@sklik.devops/our-journey-towards-slo-based-alerting-d23d4f6f620e?source=friends_link&sk=0146af550c042d0c497105cee945d2ca)

# certificate - 适用于 Gmail.com/Jabber.org 的 XMPP 服务器到服务器

> ID：272350
> 
> 赞同：0
> 
> 时间：2008-11-07T15:05:23.937
> 
> 标签：certificate, xmpp, ssl, server-to-server

我正处于实现 XMPP 服务器的服务器到服务器通信部分的阶段。

我正在使用 Gmail.com 和 Jabber.org 测试我的实现，但两者似乎都使用回拨协议。有谁知道有关与此服务器相关的此协议的更多信息？

该协议似乎分为几种联合类型，并且似乎找不到该服务器使用的那个，以及它的含义（根证书，自签名证书，......）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-04T04:04:54.080

[XEP-220](http://xmpp.org/extensions/xep-0220.html)指定回拨协议。

请记住，在您的实现中，您可能会被要求在已经完全设置并有流量通过的套接字上进行回拨。

# html - opacity:0 是否与 visibility:hidden 具有完全相同的效果

> ID：272360
> 
> 赞同：130
> 
> 时间：2008-11-07T15:10:44.613
> 
> 标签：html, css

如果是这样，它是否有效地贬低了该`visibility`属性？

（我意识到 Internet Explorer 还不支持这个 CSS2 属性。）
[布局引擎的比较](http://en.wikipedia.org/wiki/Comparison_of_layout_engines_(CSS)#Properties)

[另请参阅：visibility:hidden 和 display:none 有什么区别](https://stackoverflow.com/questions/133051/what-is-the-difference-between-visibilityhidden-and-displaynone)

* * *

## 回答 #1

> 赞同：282
> 
> 时间：2008-11-07T18:25:45.560

这是来自各种答案的经过验证的信息的汇编。

这些 CSS 属性中的每一个都是独一无二的。除了使元素不可见之外，它们还有以下附加效果：

1.  **折叠**元素通常占用的空间
2.  响应**事件**（例如，点击、按键）
3.  参与**标签**

```
                     折叠事件标签
不透明度：0 否 是 是
可见性：隐藏 否 否 否
可见性：折叠 是* 否 否
显示：无 是 否 否

* 在表格元素内是，否则否。

```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-12T19:59:56.097

不。

具有不透明度的元素会创建新的堆叠上下文。

此外，CSS 规范没有定义这一点，但带有的元素`opacity:0`是可点击的，而带有的元素`visibility:hidden`则不是。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-12-30T12:25:50.570

不，不是的。有一个很大的不同。它们是相似的，因为如果可见性被隐藏或不透明度为 0，您可以看穿元素，但是

**opacity: 0** :**你不能点击**它后面的元素。

**可见性：隐藏**：**你可以点击**它后面的元素。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-04-25T16:21:13.453

`visibility`和之间有很多区别`opacity`。大多数答案都提到了一些差异，但这里有一个完整的列表。

1.  不透明度不会继承，而可见性会

2.  opacity 是可动画的，而可见性不是。
    （嗯，*从技术上讲*是这样，但是根本没有为“37% 折叠和 63% 隐藏”定义行为，因此您可以将其视为不可动画。）

3.  使用不透明度，您不能使子元素比其父元素更不透明。例如，如果您有颜色：黑色和不透明度：0.5 的 ap，则不能将其任何子项设置为全黑。不透明度的有效值介于 0 和 1 之间，此示例需要 2！
    因此，根据[Martin 的评论](https://stackoverflow.com/questions/272360/does-opacity0-have-exactly-the-same-effect-as-visibilityhidden#comment57887943_273076)，您可以在不可见的父级（可见性：隐藏）中有一个可见的子级（可见性：可见）。这是不透明的。如果父母有 opacity:0; 它的孩子总是看不见的。

4.  [Kornel 的回答](https://stackoverflow.com/a/742324/1016716)提到小于 1 的不透明度值会创建自己的堆叠上下文；没有可见性的价值。
    （我希望我能想出一种方法来证明这一点，但我想不出任何方法来显示可见性的堆叠上下文：隐藏元素。）

5.  根据[philnash 的回答](https://stackoverflow.com/a/272371/1016716)，屏幕阅读器仍会读取 opacity:0 的元素，而 visible:hidden 元素则不会。

6.  根据[Chris Noe 的回答](https://stackoverflow.com/a/273076/1016716)，可见性有更多的选项（例如折叠），不可见的元素不再响应点击，也不能被标签到。

（将其设为社区 wiki，否则从现有答案中借用是不公平的。）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-07T15:12:33.937

我对此并不完全确定，但我认为屏幕阅读器不会阅读设置为隐藏可见性的内容，但无论其不透明度如何，他们都可以阅读内容。

这是我能想到的唯一区别。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-07T15:15:22.340

我不完全确定，但这就是我跨浏览器透明度的方式：

```
opacity: 0.6;
-moz-opacity: 0.6;
filter: alpha(opacity=60); 
```

Visibility:hidden 的对象仍然有形状，它们只是不可见。不透明度为零的元素仍然可以被点击并对其他事件做出反应。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-04-18T21:08:02.073

在制作影响 a 中元素的用户样式时`contenteditable`，我注意到如果您将某些内容设置为`visibility: hidden`，那么输入插入符号并不想与之交互。例如，如果你有

```
<div contenteditable><span style='visibility: hidden;'></span></div> 
```

...那么，如果你关注那个 div/span，你实际上就不能输入它。而`opacity: 0`它似乎可以。我没有对此进行广泛的测试，但认为值得在此提及这一点，因为此页面上没有其他人讨论过对文本输入的影响。不过，这似乎可能与上面提到的**事件有关。**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T15:15:47.550

菲尔说的是真的。

IE 支持不透明度：

```
filter:alpha(opacity=0); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-07T18:34:13.080

这些属性具有不同的*语义*含义。虽然语义 CSS 听起来可能很愚蠢，但正如其他用户所提到的，它会对屏幕阅读器等设备产生影响——其中语义会影响页面的可访问性。

# php - 如何处理 PHP 中 file_get_contents() 函数的警告？

> ID：272361
> 
> 赞同：345
> 
> 时间：2008-11-07T15:10:52.867
> 
> 标签：php, function, exception, warnings, file-get-contents

我写了一个这样的PHP代码

```
$site="http://www.google.com";
$content = file_get_content($site);
echo $content; 
```

但是，当我从中删除“http://”时，`$site`会收到以下警告：

> 警告：file_get_contents(www.google.com) [function.file-get-contents]：未能打开流：

我试过了`try`，`catch`但没有用。

* * *

## 回答 #1

> 赞同：565
> 
> 时间：2008-11-07T15:14:11.923

第一步：查看返回码：`if($content === FALSE) { // handle error here... }`

*第 2 步：通过在对file_get_contents()*的调用前面放置一个[错误控制运算符](http://php.net/manual/en/language.operators.errorcontrol.php)（即）来抑制警告： `@`*`$content = @file_get_contents($site);`*

 ** * *

## 回答 #2

> 赞同：170
> 
> 时间：2010-08-04T13:51:34.467

您还可以[将错误处理程序设置](http://us2.php.net/set_error_handler)为调用[Exception的](http://us.php.net/manual/en/class.errorexception.php)[匿名函数](http://php.net/manual/en/functions.anonymous.php)，并对该异常使用 try / catch。

```
set_error_handler(
    function ($severity, $message, $file, $line) {
        throw new ErrorException($message, $severity, $severity, $file, $line);
    }
);

try {
    file_get_contents('www.google.com');
}
catch (Exception $e) {
    echo $e->getMessage();
}

restore_error_handler(); 
```

似乎有很多代码可以捕获一个小错误，但如果您在整个应用程序中使用异常，则只需执行一次，在顶部（例如在包含的配置文件中），它会在整个过程中将所有错误转换为异常。

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2012-11-13T17:06:48.690

我最喜欢的方法很简单：

```
if (($data = @file_get_contents("http://www.google.com")) === false) {
      $error = error_get_last();
      echo "HTTP request failed. Error was: " . $error['message'];
} else {
      echo "Everything went better than expected";
} 
```

我在尝试了`try/catch`上面的 @enobrev 之后发现了这一点，但这允许更少的冗长（和 IMO，更易读）的代码。我们只是`error_get_last`用来获取最后一个错误的文本，并`file_get_contents`在失败时返回 false，所以一个简单的“if”可以捕捉到它。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-11-07T15:13:51.313

你可以在前面加上一个@： `$content = @file_get_contents($site);`

这将抑制任何警告 -**谨慎使用！**. 请参阅[错误控制运算符](http://www.php.net/@)

编辑：当您删除“http://”时，您不再寻找网页，而是磁盘上名为“www.google .....”的文件

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2011-06-24T04:17:00.403

一种替代方法是抑制错误并引发稍后可以捕获的异常。如果您的代码中有多个对 file_get_contents() 的调用，这尤其有用，因为您不需要手动抑制和处理所有这些调用。相反，可以在单个 try/catch 块中对该函数进行多次调用。

```
// Returns the contents of a file
function file_contents($path) {
    $str = @file_get_contents($path);
    if ($str === FALSE) {
        throw new Exception("Cannot access '$path' to read contents.");
    } else {
        return $str;
    }
}

// Example
try {
    file_contents("a");
    file_contents("b");
    file_contents("c");
} catch (Exception $e) {
    // Deal with it.
    echo "Error: " , $e->getMessage();
} 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2014-02-24T00:28:28.073

```
function custom_file_get_contents($url) {
    return file_get_contents(
        $url,
        false,
        stream_context_create(
            array(
                'http' => array(
                    'ignore_errors' => true
                )
            )
        )
    );
}

$content=FALSE;

if($content=custom_file_get_contents($url)) {
    //play with the result
} else {
    //handle the error
} 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-03-06T05:11:17.760

我是这样做的……不需要 try-catch 块……最好的解决方案总是最简单的……享受吧！

```
$content = @file_get_contents("http://www.google.com");
if (strpos($http_response_header[0], "200")) { 
   echo "SUCCESS";
} else { 
   echo "FAILED";
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-02-24T00:05:14.657

这是我的处理方式：

```
$this->response_body = @file_get_contents($this->url, false, $context);
if ($this->response_body === false) {
    $error = error_get_last();
    $error = explode(': ', $error['message']);
    $error = trim($error[2]) . PHP_EOL;
    fprintf(STDERR, 'Error: '. $error);
    die();
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-07T16:57:28.483

最好的办法是设置您自己的错误和异常处理程序，它们会做一些有用的事情，例如将其记录到文件中或通过电子邮件发送关键文件。 [http://www.php.net/set_error_handler](http://www.php.net/set_error_handler)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-18T18:01:34.310

由于 PHP 4 使用[error_reporting()](http://php.net/function.error_reporting)：

```
$site="http://www.google.com";
$old_error_reporting = error_reporting(E_ALL ^ E_WARNING);
$content = file_get_content($site);
error_reporting($old_error_reporting);
if ($content === FALSE) {
    echo "Error getting '$site'";
} else {
    echo $content;
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-04-23T16:36:32.967

像这样的东西：

```
public function get($curl,$options){
    $context = stream_context_create($options);
    $file = @file_get_contents($curl, false, $context);
    $str1=$str2=$status=null;
    sscanf($http_response_header[0] ,'%s %d %s', $str1,$status, $str2);
    if($status==200)
        return $file        
    else 
        throw new \Exception($http_response_header[0]);
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2012-02-27T07:57:12.027

你可以使用这个脚本

```
$url = @file_get_contents("http://www.itreb.info");
if ($url) {
    // if url is true execute this 
    echo $url;
} else {
    // if not exceute this 
    echo "connection error";
} 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2016-10-03T18:18:20.680

在使用 file_get_contents() 之前，您应该使用 file_exists() 函数。通过这种方式，您将避免 php 警告。

```
$file = "path/to/file";

if(file_exists($file)){
  $content = file_get_contents($file);
} 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2019-02-08T07:56:33.447

最简单的方法是在 file_get_contents 之前添加一个 @，即。即：

```
$content = @file_get_contents($site); 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2021-10-09T09:12:24.083

我解决了所有问题，所有链接都可以使用

```
public function getTitle($url)
    {
        try {
            if (strpos($url, 'www.youtube.com/watch') !== false) {
                $apikey = 'AIzaSyCPeA3MlMPeT1CU18NHfJawWAx18VoowOY';
                $videoId = explode('&', explode("=", $url)[1])[0];
                $url = 'https://www.googleapis.com/youtube/v3/videos?id=' . $videoId . '&key=' . $apikey . '&part=snippet';

                $ch = curl_init();

                curl_setopt($ch, CURLOPT_HEADER, 0);
                curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
                curl_setopt($ch, CURLOPT_URL, $url);
                curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
                curl_setopt($ch, CURLOPT_VERBOSE, 0);
                curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
                $response = curl_exec($ch);
                curl_close($ch);

                $data = json_decode($response);
                $value = json_decode(json_encode($data), true);

                $title = $value['items'][0]['snippet']['title'];
            } else {
                set_error_handler(
                    function () {
                            return false;
                    }
                );
                if (($str = file_get_contents($url)) === false) {
                    $title = $url;
                } else {
                    preg_match("/\<title\>(.*)\<\/title\>/i", $str, $title);
                    $title = $title[1];
                    if (preg_replace('/[\x00-\x1F\x7F-\xFF]/', '', $title))
                        $title = utf8_encode($title);
                    $title = html_entity_decode($title);
                }
                restore_error_handler();
            }
        } catch (Exception $e) {
            $title = $url;
        }
        return $title;
    } 
```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2020-02-17T03:18:36.407

```
if (!file_get_contents($data)) {
  exit('<h1>ERROR MESSAGE</h1>');
} else {
      return file_get_contents($data);
} 
```

* * *

## 回答 #17

> 赞同：-4
> 
> 时间：2016-07-28T16:37:04.193

这将尝试获取数据，如果它不起作用，它将捕获错误并允许您在捕获中做任何您需要的事情。

```
try {
    $content = file_get_contents($site);
} catch(\Exception $e) {
    return 'The file was not found';
} 
```

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2016-12-14T08:50:33.820

```
try {
   $site="http://www.google.com";
   $content = file_get_content($site);
   echo $content;
} catch (ErrorException $e) {
    // fix the url

}

set_error_handler(function ($errorNumber, $errorText, $errorFile,$errorLine ) 
{
    throw new ErrorException($errorText, 0, $errorNumber, $errorFile, $errorLine);
}); 
```

# c# - 检查引用是否为特定泛型类型的快速方法是什么？

> ID：272368
> 
> 赞同：0
> 
> 时间：2008-11-07T15:12:05.157
> 
> 标签：c#, reflection

如果我有一个带有接口参数的方法，那么查看接口的引用是否属于特定泛型类型的快速方法是什么？

更具体地说，如果我有：

```
interface IVehicle{}

class Car<T> : IVehicle {}

CheckType(IVehicle param)
{
    // How do I check that param is Car<int>?
} 
```

我也将不得不在检查后施放。因此，如果有一种方法可以用一块石头杀死 2 只鸟，请告诉我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-07T15:18:00.010

要检查参数是否为 a `Car<int>`，您可以正常使用“is”和“as”：

```
CheckType(IVehicle param)
{
    Car<int> car = param as Car<int>;
    if (car != null)
    {
         ...
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T15:21:25.840

或者，您可以这样做：

```
if(param is Car<int>)
{
    // Hey, I'm a Car<int>!
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T15:31:44.710

为什么不把这个通用？

```
interface IVehicle{}

class Car<T> : IVehicle {

    public static bool CheckType(IVehicle param)
    {
        return param is Car<T>;
    }
} 
```

...

```
Car<string> c1 = new Car<string>();
Car<int> c2 = new Car<int>();
Console.WriteLine(Car<int>.CheckType(c1));
Console.WriteLine(Car<int>.CheckType(c2)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T18:24:52.427

代码差异很大，具体取决于您是否想知道引用是基于泛型类型原型还是专用原型。

专业的很简单，你可以使用`is`：

```
CheckType(IVehicle param)
{
   var isofYourType = param is Car<int>;
   ...
} 
```

或者一个安全的演员，如前所示：

```
CheckType(IVehicle param)
{
   var value = param as Car<int>;
   if(value != null)    
       ...
} 
```

如果您想知道您的 var 是否只是某种专业化`Car<T>`，事情会变得非常**丑陋**。在这种情况下，您最不应该担心的是速度，因为这将比代码*g*更难看：

```
class Car<T>
{ }

interface IVehicle { }

class YourCar : Car<int>, IVehicle
{ }

static bool IsOfType(IVehicle param)
{
    Type typeRef = param.GetType();
    while (typeRef != null)
    {
        if (typeRef.IsGenericType &&
            typeRef.GetGenericTypeDefinition() == typeof(Car<>))
        {
            return true;
        }
        typeRef = typeRef.BaseType;
    }
    return false;
}

static void Main(string[] args)
{
    IVehicle test = new YourCar();
    bool x = IsOfType(test);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T15:18:45.407

我经常发现，如果我的代码要求我为特定类型编写检查，我可能做错了什么。不过，您没有为我们提供足够的背景信息，以便我们就此提供建议。

这是否满足您的需求？

```
Car<int> carOfInt = param as Car<int>;
if (carOfInt != null)
{
    // .. yes, it's a Car<int>
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T15:20:39.350

使用“as”运算符一次性完成所有操作。"as" 将返回您想要的类型的对象，如果您检查的内容不匹配，则返回 null。不过，这仅适用于引用类型。

```
interface IVehicle { }
class Car<T> : IVehicle 
{
    static Car<int> CheckType(IVehicle v)
    {
        return v as Car<int>;
    }
} 
```

“is”运算符将让您测试是否`v`是`Car<int>`.

# sql - SQL Server 打印没有空格的空行

> ID：272387
> 
> 赞同：5
> 
> 时间：2008-11-07T15:16:16.613
> 
> 标签：sql, sql-server, printing

在 SQL Server 2005 中，我想用 PRINT 语句打印出一个空白行，但是，当我运行

```
PRINT '' 
```

它实际上打印了一个带有单个空格的行。

有谁知道是否可以只打印一个没有空格的空行？

如果我打印一个换行符，它不会打印一个空格，但我最终会得到两个新行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-07T15:26:33.787

如果有的话，您可以在之前的打印语句中添加一个换行符。

代替：

```
PRINT 'BLABLABLA'
PRINT '' 
```

你可以写：

```
PRINT 'BLABLABLA
' <- the string finishes here! 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-07T18:07:37.890

与此处的其他建议非常相似，这似乎有效：

```
print '
'
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-11T21:07:57.027

```
-- Search the web for: SQL PRINT NewLine
-- What you'll end up finding:

DECLARE @CR AS CHAR(1)    -- Carriage Return (CR)
DECLARE @LF AS CHAR(1)    -- Line Feed (LF)
DECLARE @CrLf AS CHAR(2)  -- Carriage Return / Line Feed

SET @CR = CHAR(10)
SET @LF = CHAR(13)
SET @CrLf = @CR + @LF

PRINT '--==--==--==--==--=='
PRINT @CrLf + 'Use variables as you see fit' + @CrLf
PRINT '--==--==--==--==--=='

-- AntGut 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T15:39:07.863

你能编码退格字符并打印出来吗？

更新： PRINT '' + CHAR(8) 似乎不是特别好:(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T16:50:31.010

这表明您要打印空白消息。你确定这是你的意图吗？Print 语句实际上将消息发送到错误/消息处理机制，然后将其传输到调用应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T15:21:22.563

AFAIK 没有办法解决这个问题，这是 print 语句的工作方式

# cvs - 列出与 CVS 命令行上的标记关联的所有文件

> ID：272401
> 
> 赞同：5
> 
> 时间：2008-11-07T15:20:05.593
> 
> 标签：cvs

有没有办法在 CVS 命令行上列出与标签关联的所有文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T15:38:52.963

关于你能得到的最接近的是：

cvs -q log -R -N -S -rTAGNAME

这适用于本地副本，它不会从服务器中提取。

编辑：

正如 Ken 提到的，稍有变化就会使其从服务器中提取，但在这种情况下，您也需要指定模块名称。

cvs -q rlog -R -N -S -rTAGNAME MODULENAME

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T15:46:46.663

编辑：更正下面的命令以包含模块名称（见上文）

```
cvs -q rlog -R -N -S -rTAGNAME MODULENAME 
```

将对存储库起作用，而不是本地副本

仍然与 CVS 一样接近。

[蜥蜴比尔](https://stackoverflow.com/users/1288/bill-the-lizard)发布的命令将与 CVSNT 一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T15:25:02.913

我想这是

```
cvs ls -lR -r tag 
```

但我现在在 SVN 上，所以你必须测试它。

# flash - 创建概述 Papervision3D 场景的相机

> ID：272408
> 
> 赞同：1
> 
> 时间：2008-11-07T15:22:28.957
> 
> 标签：flash, papervision3d

在第一次设置并随后尝试使用 Papervison3D 场景时，我经常发现自己迷失了方向，因为我不知何故让相机没有看到场景的几何形状。如果我没有意识到这是问题所在，那么我会开始尝试找出我的场景没有渲染的原因 - 哦！

是否有最佳实践来设置一个可以概览整个场景的相机，以便您可以看到所有东西的位置？我正在考虑像全场景范围的等距自上而下视图 - 有点像你在 3D 包中看到的那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T05:04:22.653

这是在 Papervision 中设置场景的许多棘手问题之一。我通常首先将相机设置为`org.papervision3d.cameras.DebugCamera3D`. 这基本上与 完全相同`Camera3D`，但在场景顶部的调试窗口中显示了所有旋转、缩放、聚焦 - 所有这些好东西。键盘还通过一堆快捷键激活（在 .as 文件中查看这些快捷键），您可以在其中手动移动并查看场景效果（只需确保在调试电影时选择“控制 > 禁用键盘快捷键” . 我发现它对那些“哦，我的场景在那边！”的时刻非常有帮助。

# security - 如何安全地引用 Web 根目录之外的 ASP 经典包含文件？

> ID：272409
> 
> 赞同：3
> 
> 时间：2008-11-07T15:22:36.803
> 
> 标签：security, asp-classic

我希望能够将我所有的 ASP Classic 包含文件放在 web 根目录之外。这确保不能通过 URL 直接调用包含文件。

实现这一目标的最佳方法是什么？

我知道我可以使用[虚拟目录](http://msdn.microsoft.com/en-us/library/zwk103ab.aspx)来引用 web 根目录之外的包含文件夹，但这是否仍然允许通过 URL 直接访问该目录？也许我误解了虚拟目录的性质。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T16:51:58.543

从[这篇文章](http://forums.iis.net/t/1148178.aspx)：

（我自己从来不需要这样做）

> 明白了。在默认网站“内部”创建一个虚拟目录，指向工作文件夹“外部”的文件。在您的代码中引用指向正常结构之外的文件夹/文件的虚拟目录。例如
> 
> 您的默认网站是一个名为 c:\websites\example.com 的本地文件夹。在 example.com 下，您的所有文件夹和文件。但是，您需要的文件位于名为 FileServerA 的文件服务器上，位于名为 D:\MyWebsiteIncludes 的文件夹中。UNC 路径为 \FileServerA\D$\MyWebSiteIncludes，或者如果您在文件夹上创建共享，则为 \FileServerA\MyWebsiteIncludes 在 Web 服务器上，创建一个映射到任一共享路径的虚拟目录。您需要确保配置了正确的凭据以访问远程服务器上的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T17:08:36.887

虽然不推荐，但您也可以在 IIS 中启用“启用父路径”选项，这将允许您通过 include 指令引用 webroot 之外的文件，并允许通过文件系统对象进行访问。但通常不建议这样做，因为它确实会带来安全风险。

有关如何执行此操作的说明，请查看[MSDN 上的启用父路径文章](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/40993ff2-22c3-48a9-ba01-1056a9425a1e.mspx?mfr=true)。

自从我使用 Classic ASP 以来已经有一段时间了，但通常我只会在包含文件中声明子例程和函数，然后从主应用程序代码中调用它们。这会产生意想不到的副作用，如果有人确实猜到了包含的路径并直接通过他们的浏览器访问文件，它实际上不会做任何事情，因为没有执行任何代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T12:57:50.267

我能够检查[Diodeus 的回答](https://stackoverflow.com/a/272696/87015)中提到的程序，它确实有效。

### 示例文件/文件夹设置：

```
E:\includes\
           \include.asp
           \another.asp
E:\websites\
           \business-website.com\
                                \config.asp
                                \default.asp
           \personal-website.com\
                                \config.asp
                                \default.asp
           \whatever-website.com\
                                \config.asp
                                \default.asp 
```

### IIS 网站设置

```
business-website.com -> E:\websites\business-website.com\
     v. dir /include -> E:\includes\
personal-website.com -> E:\websites\personal-website.com\
     v. dir /include -> E:\includes\
whatever-website.com -> E:\websites\whatever-website.com\
     v. dir /include -> E:\includes\ 
```

注意：虚拟目录未转换为应用程序。

### 什么在起作用`default.asp`

```
Files in current directory:
<!-- #include file="config.asp" -->

Files in current directory (using virtual path):
<!-- #include virtual="/config.asp" -->

Files in include directory:
<!-- #include virtual="/include/include.asp" --> 
```

### 虚拟包含的内容`include.asp`

```
Files in current directory:
<!-- #include file="another.asp" -->

Files in current directory (using virtual path):
<!-- #include virtual="/include/another.asp" -->

Files in root application:
<!-- #include virtual="/config.asp" --> 
```

这使得将所有包含文件合并到一个位置变得更加容易。

# php - 如何在 php 中检查字符串的开头？

> ID：272412
> 
> 赞同：3
> 
> 时间：2008-11-07T15:23:21.840
> 
> 标签：php, string, hyperlink

我想要这样的东西

1.  用户输入网站链接

2.  如果链接不以“http://”开头，我需要检查链接我想将“http://”附加到链接。

我怎么能在 PHP 中做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-07T15:25:09.373

```
if (stripos($url, 'http://') !== 0) {
   $url = 'http://' . $url;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-07T15:27:26.187

我会建议对汤姆的稍作改进

> ```
> if (0 !== stripos($url, 'http://') && 0 !== stripos($url, 'https://')) {
>    $url = 'http://' . $url;
> } 
> ```

但是，这会弄乱使用其他协议的链接（ftp:// svn:// gopher:// 等）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T15:28:42.393

```
if (!preg_match("/^http:\/{2}/",$url)){
    $url = 'http://' . $url;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T20:35:43.177

我会检查一些字母后跟冒号。根据 URI 规范，冒号用于将“模式”（http、ftp 等）与“模式特定部分”分开。这样，如果有人输入（例如）mailto 链接，这些链接就会得到正确处理。

# c++ - Boost Graph Library：BGL 中是否有用于社区检测的简洁算法？

> ID：272414
> 
> 赞同：6
> 
> 时间：2008-11-07T15:23:54.197
> 
> 标签：c++, algorithm, boost-graph

有人将 BGL 用于大型生产服务器吗？

*   您的网络由多少个节点组成？
*   您如何处理[社区检测](http://en.wikipedia.org/wiki/Community_structure)
*   BGL 有什么很酷的方法来检测社区吗？
*   有时，两个社区可能通过一两条边连接在一起，但这些边不可靠，可能会逐渐消失。有时根本没有边缘。

有人可以简要谈谈如何解决这个问题。请打开我的心扉，启发我。

到目前为止，我已经设法以最便宜的方式确定两个节点是否位于一个岛上（在一个社区中），但现在我需要确定不同岛上的哪些两个节点彼此最接近。我们只能尽量少地使用不可靠的地理数据。

如果我们将其比喻为大陆和岛屿，并将其排除在社会距离背景之外。我想计算出在一片水域中哪两块土地最靠近。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T15:42:23.830

我已经将 BGL 用于具有数百万个节点的图，但是您可以使用的图的大小取决于您尝试运行的算法。您可以快速计算节点之间的距离。根据您的数据，有 4 种最适用的最短路径算法：（单对点，对于所有点对，稀疏和密集图，...）。

至于社区检测，BGL 中没有专门为此而内置的任何算法（但也许您可以在项目完成后贡献一个）。有一些算法可能有助于构建社区检测算法。[max-flow/min-cut](http://www.boost.org/doc/libs/1_37_0/libs/graph/doc/edmunds_karp_max_flow.html)算法通常用于社区检测（如果两个节点之间可能有很多流量，那么它们很可能在同一个社区中，如果没有太多流量，那么最小-cut 可能代表社区之间的道路）。还有一些启发式方法可以对图的节点进行排序以减少[带宽](http://www.boost.org/doc/libs/1_37_0/libs/graph/doc/cuthill_mckee_ordering.html)。组成“社区”的节点可能以这样的顺序彼此靠近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T15:41:30.790

据我所知，BGL 没有任何专门用于社区检测的算法。

“岛”是指断开的子图吗？

此外，图表没有任何“距离”的概念。

这种“社交距离”是你必须定义的。一旦你完成了大部分工作。

您链接到的页面上列出了许多方法，其中大多数只需要您定义诸如“距离”度量之类的东西，然后将您的定义插入算法中。

@大卫尼姆

没有边权重的图只是关于连通性，它们没有距离的概念。如果您想谈论网络，那么您可以谈论距离。但是没有边权重的图没有任何距离，除非您想假设所有边的隐含边权重为 1。但这实际上只是将图形变成了网络。

此外，他正在谈论两个断开连接的图之间的距离。为了对此建模，您必须为节点之间的距离引入一个外部概念，与边缘距离分开。

# winapi - 在 Lua 中调用 Win32 函数返回带有外星人的字符串

> ID：272425
> 
> 赞同：10
> 
> 时间：2008-11-07T15:26:07.623
> 
> 标签：winapi, lua

我正在尝试使用[外星人](http://alien.luaforge.net/)来调用 Win32 函数。我试过这段代码，但它崩溃了，我不明白为什么。

```
require( "alien" )

local f = alien.Kernel32.ExpandEnvironmentStringsA
f:types( "int", "string", "pointer", "int" )
local buffer = alien.buffer( 512 )
f( "%USERPROFILE%", 0, 512 ) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T16:25:36.860

这是一个很好的问题，对我来说，这是一个测试外星人的机会......

如果你不介意，我借此机会解释如何使用 Alien，所以像我这样（不太习惯`require`）偶然发现这个线程的人会开始......

你给了 LuaForge 页面的链接，我去了那里，发现我需要 LuaRock 来获取它。:-( 总有一天我应该安装后者，但我现在选择跳过它。所以我去了存储库并下载了[alien-0.4.1-1.win32-x86.rock](http://www.lua.inf.puc-rio.br/~mascarenhas/rocks/alien-0.4.1-1.win32-x86.rock "外星人-0.4.1-1.win32-x86.rock")。我发现它是一个普通的 Zip文件，我可以像往常一样解压缩。

在摸索了一下之后`require`，我结束了破解 Lua 脚本中的路径以进行快速测试。我应该创建`LUA_PATH`并`LUA_CPATH`在我的环境中，我稍后会这样做。

所以我从解压后的文件夹中取出了alien.lua、core.dll和struct.dll，并将它们放在了一个公共库存储库中名为Alien的目录下。
我在脚本的开头添加了以下几行（错误的黑客警告！）：

```
package.path = 'C:/PrgCmdLine/Tecgraf/lib/?.lua;' .. package.path
package.cpath = 'C:/PrgCmdLine/Tecgraf/lib/?.dll;' .. package.path
require[[Alien/alien]] 
```

然后我尝试了一个简单、简洁的功能，并立即获得视觉结果：MessageBox。

```
local mb = alien.User32.MessageBoxA
mb:types{ 'long', 'long', 'string', 'string', 'long' }
print(mb(0, "Hello World!", "Cliché", 64)) 
```

是的，我收到了消息框！但是单击确定后，我遇到了 Lua 崩溃，可能和您一样。在快速浏览 Alien 文档后，我发现了（未命名的）罪魁祸首：我们需要使用 Windows API 的 stdcall 调用约定：

```
mb:types{ ret = 'long', abi = 'stdcall', 'long', 'string', 'string', 'long' } 
```

因此，让您的工作变得微不足道：

```
local eev = alien.Kernel32.ExpandEnvironmentStringsA
eev:types{ ret = "long", abi = 'stdcall', "string", "pointer", "long" }
local buffer = alien.buffer(512)
eev("%USERPROFILE%", buffer, 512)
print(tostring(buffer)) 
```

注意我将缓冲区参数放在 eev 调用中......

# search - Lucene.Net 是否适合作为内容频繁变化的搜索引擎？

> ID：272427
> 
> 赞同：12
> 
> 时间：2008-11-07T15:26:10.103
> 
> 标签：search, lucene, indexing, lucene.net

Lucene.Net 是否适合作为内容频繁变化的搜索引擎？

或者更具体地说，任何人都可以就 lucene.net 索引的更新速度给出主观意见。任何其他搜索频繁变化的内容的方法都会很棒。

我们正在开发一个论坛。论坛帖子将经常添加到论坛存储库中。我们认为我们需要将这些帖子快速添加到 lucene 索引中（<0.5 秒），以便可以搜索。最初在存储库中将有大约 5E6 个帖子。假设搜索引擎在非异国服务器上运行（我知道这很模糊！）。

其他关于解决搜索频繁变化的内容问题的建议表示赞赏。论坛帖子需要在可变数量的命名标签上进行搜索（标签名称和值必须匹配）。基于 SQL 的方法（基于 Toxi 模式）并没有给我们想要的性能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-07T15:39:07.300

Out 论坛 ( [http://episteme.arstechnica.com](http://episteme.arstechnica.com) ) 使用 Lucene 作为搜索后端，所以它是可行的。帖子的索引速度不如您希望的那样快，但我们可以通过增强索引硬件和使用更智能的缓存策略来解决这个问题。

这个问题的一般答案是：这取决于您的写入/更新模式是什么。论坛相对容易，因为大多数内容都是新内容，而现有内容的更新频率较低。

对于论坛，我建议有一个“存档”索引和一个“实时”索引。实时索引可能包括最后一天、一周、一年的帖子，而存档索引将包括大量可能永远不会再被触及的帖子。因此，当有人创建新帖子时，它最初会在实时索引中被索引。稍后，一些批处理作业会清除实时索引，并将所有内容重新索引到存档中。

Lucene 非常擅长跨多个索引进行查询。你应该滥用这种能力。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T10:59:09.927

Lucene.Net 速度非常快，但是当使用错误时，有很多事情会减慢查询速度。我强烈推荐阅读 Erik Hatcher 和 Otis Gospodnetić 的[Lucene in Action](http://www.manning.com/hatcher2/)一书。它包含一个关于性能测试和调优的非常好的章节。

# class - 关于类继承的协变与逆变

> ID：272428
> 
> 赞同：6
> 
> 时间：2008-11-07T15:26:11.460
> 
> 标签：class, inheritance, terminology, covariance, contravariance

“协变”和“逆变”这两个概念的含义是什么？

给定 2 个类**Animal**和**Elephant**（从**Animal**继承），我的理解是，如果您尝试将 Elephant 放入 Animals 数组中，您会遇到运行时错误，这是因为 Elephant 是“更大”（更多具体）比动物。但是，您能否将 Animal 放入 Elephant 数组中，看看 Elephant 是如何保证包含 Animal 属性的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-07T15:31:34.290

你倒过来了。您可以将 Elephant 添加到 Animal 数组中，因为它*是*Animal，并且保证具有 Animal 所需的所有方法。您不能将 Animal 添加到 Elephant 数组，因为它没有**Elephant**所需的所有方法。

[关于协变和逆变](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))的维基百科文章对此有很好的解释：

> 在编程语言的类型系统中，从类型到类型的运算符是协变的，如果它保留类型的顺序 ≤ ，它将类型从更具体的类型排序到更通用的类型；如果它颠倒这个顺序，它就是逆变的。如果这些都不适用，则运算符是不变的。这些术语来自范畴论。

另外，您说 Elephant 类型“更大”，事实并非如此。类型 Animal 是“更大”的，因为它包括更具体的类型，例如 Elephant、Giraffe 和 Lion。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T15:31:28.597

查看 C# 4.0 中协变和逆变的概述，看看是否有帮助：

[http://blogs.msdn.com/charlie/archive/2008/10/27/linq-farm-covariance-and-contravariance-in-visual-studio-2010.aspx](http://blogs.msdn.com/charlie/archive/2008/10/27/linq-farm-covariance-and-contravariance-in-visual-studio-2010.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T00:43:22.720

[您应该尝试阅读使用 Visual Studio 2010 介绍 .NET 4.0](https://rads.stackoverflow.com/amzn/click/com/143022455X)的第 45-49 页，其中处理了这个确切的示例。它甚至还有一些漂亮的大象照片。

要点是，要做到这一点

```
var things = new List<IThing<IContent>> { new ConcreteThing() } 
```

和：

```
public class ConcreteThing : IThing<ConcreteContent>
{

} 
```

您需要接口定义中的“out”，这将允许设置更具体的形式，但必须保证从 IThing 读出的任何内容都是更通用的类型。

```
public interface IThing<out T> where T : IContent
{
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-11-14T17:02:00.490

[![在此处输入图像描述](https://i.stack.imgur.com/0goxP.jpg)](https://i.stack.imgur.com/0goxP.jpg)

```
public interface IGoOut<out T>
{
    T Func();
}
public interface IComeIn<in T>
{
    void Action(T obj);
}
public class GoOutClass<T>:IGoOut<T>
{
    public T Func()
    {
        return default(T);
    }
}

public class ComeInClass<T> : IComeIn<T>
{
    public void Action(T obj) {  }
}

==========================================================
object obj = null;
//Covariance Example [Array +  IEnumerable<T> +  IEnumerator<T>  +  IInterface<Out T>  +  Func<T>]
object[] array = (string[]) obj;
IEnumerable<object> enumerable = (IEnumerable<string>) obj;
IEnumerator<object> enumerator = (IEnumerator<string>)obj;
IGoOut<object> goOut = (GoOutClass<string>)obj;
Func<object> func = (Func<string>)obj;

//Contravariance Example[IInterface<in T>]
IComeIn<string> comeIn = (ComeInClass<object>) obj; 
```

# sql-server - SQL Server 2005 命名实例端口问题

> ID：272429
> 
> 赞同：2
> 
> 时间：2008-11-07T15:26:23.770
> 
> 标签：sql-server, sql-server-2005

我在单个服务器上有 4 个不同命名的 SQL Server 2005 实例（用于测试目的）。服务器上没有默认实例。

因为我最终需要允许跨防火墙与这些实例进行通信，所以我将每个实例的端口设置为静态侦听服务器的所有 IP。

**编辑**：TCP/IP、共享内存和命名管道都已启用。威盛被禁用。在 TCP/IP 协议上为所有 IP 静态设置端口，并且每个命名实例都使用单独的端口。

我还运行了 SQLBrowser 服务，并且所有实例都配置为允许远程连接。

一个实例设置为默认端口 (1433)，它工作正常。

然而，其他实例表现出非常奇怪的行为。当我使用网络中的 Sql Server Management Studio 连接到他们时（所以我什至还没有穿过防火墙），工作室毫无怨言地连接。但是，一旦我尝试扩展实例的数据库列表、刷新实例或几乎其他任何东西，我就会收到以下错误：

标题：Microsoft SQL Server 管理工作室

* * *

未能为此请求检索数据。(Microsoft.SqlServer.SmoEnum)

如需帮助，请单击： http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL+Server&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&LinkId=20476)

* * *

附加信息：

无法连接服务器 。(Microsoft.SqlServer.ConnectionInfo)

* * *

与服务器成功建立连接，但在登录过程中出现错误。（提供者：命名管道提供者，错误：0 - 管道的另一端没有进程。）（Microsoft SQL Server，错误：233）

如需帮助，请单击： http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=233&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=233&LinkId=20476)

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T16:08:11.173

> 首先要做的是尝试在服务器名称之前添加前缀 np: 或 tcp:（对于命名管道或 TCP/IP）。对于 tcp/ip，您也可以尝试在服务器名称后添加端口号 (,1433)。如果这不是默认实例，则必须在服务器名称后添加实例名称；例如：

```
> sqlcmd -S
> tcp:NameOfTheServer\sqlexpress,1433 
```

编辑：删除源链接，因为它现在是一个死链接

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T21:54:48.837

Bofe 的回答奏效了，这表明端口有问题。

事实证明，在命名实例的 TCP/IP 设置中，我在协议上设置了全部侦听，然后为 IPAll 设置了静态端口，但为 IP1 设置了动态端口。我假设由于 IP1 被禁用，我不需要担心它，但显然如果你设置了 Listen All，那么 IP1 的 enabled 属性将被忽略。因此，服务器上只有一个 IP 地址，并且配置 IP1 动态端口和 IPAll 静态端口导致了某种奇怪的冲突。

为了解决这个问题，我只是将 IP1 设置为使用与 IPAll 相同的静态端口，启用 IP1，重新启动服务器，然后一切正常，无需在连接字符串中明确设置端口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T15:43:35.763

尝试为服务器上的每个实例使用不同的 TCP/IP 端口。您需要进入 SQL Server 配置管理器来更改这些设置。在 TCP/IP 下，您可以更改端口号，然后在连接时在连接字符串或 SQL Management Studio 中使用这些端口号。

出于好奇，为什么你有服务器的实例？您可以使用一个实例并拥有多个数据库吗？如果您正在使用其他实例进行开发或测试，您可能需要考虑将它们移至另一个盒子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T15:33:23.973

尝试启用与 SQL 服务器实例的 TCP/IP 通信。如果您最终要穿越防火墙，那么您可能无论如何都希望使用 TCP/IP 而不是命名管道。

# c# - 如何使用 C# 从 Windows 读取“公司名称”？

> ID：272433
> 
> 赞同：3
> 
> 时间：2008-11-07T15:27:44.017
> 
> 标签：c#, registry

有些程序会读取您在安装 Windows 时输入的公司名称，并将其显示在程序中。这是怎么做到的？他们只是从注册表中读取名称吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-07T15:47:20.123

如果您想要在注册表中输入的注册公司名称，您可以从以下位置获取：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\RegisteredOrganization 
```

使用 Registry 类，您可以执行以下操作：

```
string org = (string)Microsoft.Win32.Registry.GetValue(@"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion", "RegisteredOrganization", ""); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T16:22:00.397

您可以阅读此 Using WMI，在我看来，您在 Win32_OperatingSystem 类之后，并且该类的 Organization 元素包含公司名称。

下面的代码是一个控制台应用程序，它显示了注册用户和组织。要让它运行，您需要向项目添加对 System.Management.dll 的引用。应该只有一个管理对象，因此 foreach 可能是多余的，不太确定最佳实践是什么：

```
using System;
using System.Management;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            ManagementClass c = new ManagementClass("Win32_OperatingSystem");

            foreach (ManagementObject o in c.GetInstances())
            {
                Console.WriteLine("Registered User: {0}, Organization: {1}", o["RegisteredUser"], o["Organization"]);
            }
            Console.WriteLine("Finis!");
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T15:47:22.777

Windows 将注册的公司名称存储在注册表中：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\RegisteredOrganization 
```

导入以下内容：

```
using Microsoft.Win32; 
```

读取所需注册表项的值，如下所示：

```
RegistryKey hklm = Registry.LocalMachine;
hklm = hklm.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion");
Object obp = hklm.GetValue("RegisteredOrganization");`
Console.WriteLine("RegisteredOrganization :{0}",obp);` 
```

或者，正如[小福](https://stackoverflow.com/users/31967/xiaofu)所建议的那样。

*但是，正确的方法是使用双反斜杠。这是因为反斜杠是 C# 转义字符 - 也就是说，您可以使用 \n 插入换行符，或者使用 \t 插入制表符，因此要让 C# 知道我们想要一个普通的反斜杠而不是一些转义字符，我们必须使用两个反斜杠 (\) 或在字符串前面使用 @，例如 (@"\somestring") ：*

```
string org = (string)Microsoft.Win32.Registry.GetValue("HKEY_LOCAL_MACHINE\\\Software\\Microsoft\\Windows NT\\CurrentVersion", "RegisteredOrganization", ""); 
```

**注意：** RegisteredOrganization 键不保证包含值，因为它可能在操作系统安装过程中未填写。所以总是使用 try/catch 块或检查返回值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T15:46:34.930

检查 API SystemParametersInfo 和名为 SPI_GETOEMINFO 的常量

```
int details = SystemParametersInfo(SPI_GETOEMINFO, OEMInfo.Capacity, OEMInfo, 0);
        if (details != 0)
        {
            MessageBox.Show(OEMInfo.ToString());
        } 
```

这将返回 OEM 的公司名称。我认为您在安装 Windows 时不必输入公司名称，只需输入计算机名称（我可能在这里错了）

您可以在此处查看所有常量和示例：http:
[//pinvoke.net/default.aspx/Enums.SystemMetric](http://pinvoke.net/default.aspx/Enums.SystemMetric)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T15:49:41.057

我在 .NET 中找不到可以获取信息的方法或属性，但我找到了一个技术说明，它告诉哪些注册表项包含信息：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\RegisteredOrganization 
```

[http://support.microsoft.com/kb/310441](http://support.microsoft.com/kb/310441)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-07T16:35:50.557

我不喜欢在我的业务代码中调用 text-y 注册表，而且我不喜欢实用程序类，因此我编写了一个从注册表中获取公司名称的扩展方法。

```
using Microsoft.Win32;

namespace Extensions
{
    public static class MyExtensions
    {
        public static string CompanyName(this RegistryKey key)
        {
            // this string goes in my resources file usually
            return (string)key.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion").GetValue("RegisteredOrganization");
        }
    }
} 
```

然后我可以很容易地得到这个值：

```
RegistryKey key = Registry.LocalMachine;
return key.CompanyName(); 
```

这没什么花哨的，只是处理经常检索的注册表值的一种更漂亮的方式。

# asp.net - 如何将全球化资源提供者重置为默认 resx 提供者

> ID：272435
> 
> 赞同：0
> 
> 时间：2008-11-07T15:28:24.030
> 
> 标签：asp.net, globalization

我想为我网站的内部部分重置我的全球化提供程序。

站点根目录使用自定义 sql 提供程序，我想在我的子文件夹中使用 resx。

我应该在 resourceProviderFactoryType="???" 中设置什么

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-18T20:59:43.720

我认为您应该能够使用以下方法将其设置为默认值：

```
<globalization resourceProviderFactoryType=""/> 
```

希望有帮助。

# postgresql - 在 Postgresql 中将一列的注释设置为另一列的注释

> ID：272438
> 
> 赞同：6
> 
> 时间：2008-11-07T15:29:19.443
> 
> 标签：postgresql, ddl, comments

假设我在 Postgresql 中创建了一个表，并在列上添加了注释：

```
create table t1 (
   c1 varchar(10)
);
comment on column t1.c1 is 'foo'; 
```

一段时间后，我决定添加另一列：

```
alter table t1 add column c2 varchar(20); 
```

我想查找第一列的评论内容，并与新列关联：

```
select comment_text from (what?) where table_name = 't1' and column_name = 'c1' 
```

（什么？）将是一个系统表，但是在 pgAdmin 中环顾四周并在网上搜索之后，我还没有知道它的名字。

理想情况下，我希望能够：

```
comment on column t1.c1 is (select ...); 
```

但我有一种感觉，这有点扯远了。感谢您的任何想法。

更新：根据我在这里收到的建议，我最终编写了一个程序来自动化传输评论的任务，作为更改 Postgresql 列的数据类型的更大过程的一部分。[你可以在我的博客上](http://wirespeed.wordpress.com/2008/11/07/alter-column-type-postgres/)读到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T16:00:52.687

接下来要知道的是如何获取表 oid。正如您所怀疑的，我认为将其用作评论的一部分是行不通的。

```
    postgres=# 创建表 comtest1 (id int, val varchar);
    创建表
    postgres=# 插入 comtest1 值 (1,'a');
    插入 0 1
    postgres=# 从 comtest1 中选择不同的 tableoid；
     表格
    ----------
        32792
    (1 行)

    postgres=#comtest1.id 列上的注释是“标识符一号”；
    评论
    postgres=# 选择 col_description(32792,1);
        col_description
    ----------------------
     标识符一号
    (1 行)

```

无论如何，我启动了一个快速的 plpgsql 函数来将注释从一个表/列对复制到另一个。您必须在数据库上创建lang plpgsql 并像这样使用它：

```
    将表comtest1第一列的注释复制到id
    表comtest2的列。是的，应该改进，但是
    这是留给读者的工作。

    postgres=# select copy_comment('comtest1',1,'comtest2','id');
     复制评论
    --------------
                1
    (1 行)

```

```
CREATE OR REPLACE FUNCTION copy_comment(varchar,int,varchar,varchar) RETURNS int AS $PROC$
DECLARE
        src_tbl ALIAS FOR $1;
        src_col ALIAS FOR $2;
        dst_tbl ALIAS FOR $3;
        dst_col ALIAS FOR $4;
        row RECORD;
        oid INT;
        comment VARCHAR;
BEGIN
        FOR row IN EXECUTE 'SELECT DISTINCT tableoid FROM ' || quote_ident(src_tbl) LOOP
                oid := row.tableoid;
        END LOOP;

        FOR row IN EXECUTE 'SELECT col_description(' || quote_literal(oid) || ',' || quote_literal(src_col) || ')' LOOP
                comment := row.col_description;
        END LOOP;

        EXECUTE 'COMMENT ON COLUMN ' || quote_ident(dst_tbl) || '.' || quote_ident(dst_col) || ' IS ' || quote_literal(comment);

        RETURN 1;
END;
$PROC$ LANGUAGE plpgsql; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T15:55:56.130

您可以使用系统函数 col_description(table_oid, column_number) 检索列的注释。有关详细信息，请参阅[此页面](http://www.postgresql.org/docs/8.2/static/functions-info.html#FUNCTIONS-INFO-COMMENT-TABLE)。

# visual-studio - Visual Studio 远程调试可扩展性

> ID：272439
> 
> 赞同：3
> 
> 时间：2008-11-07T15:29:24.450
> 
> 标签：visual-studio, vsx, remote-debugging, extensibility

我正在尝试使用类似于以下代码的远程计算机附加：

```
Debugger2 db (Debugger2)dte.Debugger;
Transport trans = db.Transports.Item("Default");
Process2 proc2 = (Process2)db.GetProcesses(trans, "MACHINENAME").Item("SERVICENAME");
proc2.Attach2(); 
```

我已经通过远程桌面登录并手动启动调试器来让它工作，但我必须保持登录状态。问题是，我不想保持登录到远程机器。有没有办法自动启动调试器，类似于我通过 IDE 附加时发生的情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T01:40:00.880

您可以将调试代码包装为 Windows 服务，该服务在启动时以更高的权限执行。

***但是，我不推荐这条路线***，因为根据经验，我认为它对于最可能需要的东西来说太过分了。您能否详细说明为什么要将调试器自动附加到远程进程？

我的猜测是你想做一些最适合 WinDbg 的事情。类似于这些的东西。

*   [启用 windbg 以打破 clr 异常](http://dotnetdebug.net/2006/10/21/enabling-windbg-to-break-on-clr-exceptions/)
*   [将服务配置为使用附加的 windbg 调试器启动](http://support.microsoft.com/kb/824344)

但是，如果没有有关您要完成的工作的更多背景信息，我显然只是在猜测。

# windows - 如何将按钮添加到其他应用程序窗口标题栏（XP/Vista）

> ID：272440
> 
> 赞同：1
> 
> 时间：2008-11-07T15:29:38.397
> 
> 标签：windows, titlebar, cross-process

我有一个打开窗口的处理程序，它不一定由我的进程打开。如何在该窗口中添加一个按钮并在单击时使该按钮调用某个应用程序 (.exe)？该按钮可以在系统菜单或最小化按钮旁边。这应该适用于 XP 和 Vista（每个版本都可以使用不同的方法）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T18:32:27.357

标准方法是使用 SetWindowsHookEx 将 DLL 注入进程，挂钩 WH_CALLWNDPROC 以监视 WM_NCPAINT 消息。这曾经工作得很好，但现在没有了。Visual Styles 和 Vista UAC 会让你留长胡子。在 Windows 3.x 时代很常见，我已经有一段时间没有看到这样做了。

# .net - .NET Forms 身份验证：如何将 pdf 文件等资源的访问权限仅限于经过身份验证的用户

> ID：272447
> 
> 赞同：3
> 
> 时间：2008-11-07T15:32:55.503
> 
> 标签：.net, security, authentication, file, iis-6

我正在使用 .net2.0 和 IIS6。

使用 .net 表单身份验证时：如何将 pdf 文件等资源的访问权限仅限于经过身份验证的用户；所以为了访问一个文件说 mysite.com/mydoc.pdf 他们必须首先通过身份验证（通过登录页面）

似乎默认情况下只有 .aspx 页面受到保护。例如，要包含 .html，我必须按照[此处](http://forums.asp.net/p/1184547/2096319.aspx)描述的步骤进行操作。

**编辑**

感谢大家的快速回复，[Keltex 的回答](https://stackoverflow.com/questions/272447/net-forms-authentication-how-to-limit-access-to-resources-like-pdf-files-to-aut#272455)对我来说非常有效，因为我需要快速修复演示系统。

其他答案也很有趣，在处理生产系统时它们会很有用。

更欢迎您发布其他答案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T15:34:43.317

您必须配置 IIS 以处理通配符扩展。因此 .pdf 和 .html 扩展名将被验证。以下是 IIS6 的方法：

[http://professionalaspnet.com/archive/2007/07/27/Configure-IIS-for-Wildcard-Extensions-in-ASP.NET.aspx](http://professionalaspnet.com/archive/2007/07/27/Configure-IIS-for-Wildcard-Extensions-in-ASP.NET.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T15:38:36.007

您可以将文件存储在无法通过网络直接访问的目录中，然后用户必须访问一个 ASPX 页面，其 ID 指向他们需要下载的文件。那时，您将文件流式传输出来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T16:35:16.017

创建一个 httphandler，它在将文档流式传输到浏览器之前检查经过身份验证的用户。然后，您可以将页面上的链接设置为指向具有文档 id 的处理程序，而不是直接指向文件。

完成此操作后，文档可以存储在您选择的任何位置附近，可以是文件系统或数据库，甚至可以根据需要编码为 xml 文件。当您想要移动存储位置但又不想更新 Web 应用程序中的所有链接时，这很有用。

有用的链接：http: [//msdn.microsoft.com/en-us/library/system.web.ihttphandler](http://msdn.microsoft.com/en-us/library/system.web.ihttphandler)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T15:41:38.247

您是否关闭了匿名访问？如果您只有集成 Windows 身份验证，如果您使用这些设置设置 Web 配置，它应该会阻止所有访问

# version-control - 有没有一种简单的方法可以从 ms vss 中获取具有版本号的文件列表？

> ID：272452
> 
> 赞同：2
> 
> 时间：2008-11-07T15:34:14.643
> 
> 标签：version-control, visual-sourcesafe

我经常需要制作带有 Microsoft Visual Source Safe 版本号的文件清单。有没有办法在项目中获取带有版本号的文件列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T14:20:38.803

您可以使用自动化，VSS 6.0（及更早版本）附带一个您可以使用的 ActiveX dll。在您的项目中参考 Microsoft SourceSafe 6.0 类型库，类似（下面未经验证和未经测试的 VB 代码）应该适合您。

自动化非常强大，我曾经用它来证明 Vss 集成到我曾经构建的 Ide 中，业务类型人员编写 XQuery 片段来查询 Xml 消息。

```
Private Sub GetAllVersionNumbers()
    Dim db As New VSSDatabase
    Call db.Open("\\codestore\myProject\srcsafe.ini", "Myuser", "password")

    Call GetItemVersion(db.CurrentProject)
End Sub

Private Sub GetItemVersion(ByVal root As VSSItem)
    Dim item As VSSItem

    For Each item In root
        If item.Type = VSSITEM_FILE Then
            Call Output(item.Name, item.VersionNumber)
        Else ' item.Type =VSSITEM_FDOLDER
            'recurse
            Call GetItemVersion(item)
        End If
    Next
End Sub 
```

# asp.net - ASP.NET MVC：当没有为 URL 提供参数时重定向回页面

> ID：272454
> 
> 赞同：3
> 
> 时间：2008-11-07T15:34:34.550
> 
> 标签：asp.net, asp.net-mvc

[http://localhost:50034/Admin/Delete/723](http://localhost:50034/Admin/Delete/723)

总是需要这个参数来执行动作，但是，如果你去没有参数的URL，就会发生异常。你如何处理这个问题并在不做任何事情的情况下重定向回主页？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-07T15:41:37.483

我不确定你的意思，你的意思是 url [http://localhost:50034/Admin/Delete/](http://localhost:50034/Admin/Delete/)正在生成异常吗？

尝试将 id 参数设置为可为空，如下所示：

```
public class MyController : Controller
{
  public void Delete(int? id)
  {
    if (!id.HasValue)
    {
      return RedirectToAction("Index", "Home");
    }

    ///
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T15:39:50.187

```
public ActionResult Details(int? Id)
{
     if (Id == null)
           return RedirectToAction("Index");
     return View();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T15:51:53.920

假设您使用的是默认路由规则：

```
 routes.MapRoute(
     "Default",  // Route name
     "{controller}/{action}/{id}",  // URL with parameters
     new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
   ); 
```

然后为 id 参数创建一个可以为空的 int (int?) 的 Delete 方法，类似于

```
public ActionResult Delete(int? id)
{
   if (id.HasValue)
   {
      // do your normal stuff 
      // to delete
      return View("afterDeleteView");
    }
    else
    {
      // no id value passed
      return View("noParameterView");
    } 
```

}

# database - 数据库引擎独立数据建模

> ID：272456
> 
> 赞同：0
> 
> 时间：2008-11-07T15:35:24.673
> 
> 标签：database

我正在寻找一种工具，我可以在其中维护一个简单的数据模型，然后使用可能的插件，为 MSSQL 和 mySQL 生成实际的数据库，作为奖励，其他的。这不应该是一个完整的 ORM 工具，只是抽象为具体的数据模型。我应该去哪里看？谁知道一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-07T16:12:34.270

以下是我之前评估过的一些工具

[CA ERWin 数据建模器](http://www.ca.com/us/products/product.aspx?ID=260)

[可见分析师数据库工程师](http://www.visible.com/Products/Analyst/vadbengineer.htm)

[TOAD 数据建模器](http://www.quest.com/toad-data-modeler/)

[急诊室](http://www.embarcadero.com/products/erstudio/)

高温高压

# javascript - noscript 是否得到启用 javascript 的浏览器的确认？

> ID：272457
> 
> 赞同：2
> 
> 时间：2008-11-07T15:36:06.887
> 
> 标签：javascript, jquery, html

我正在考虑通过将广告代码移至外部 jQuery 脚本来收紧我们的广告代码，但显然我仍然需要一些 HTML 来定位广告。所以我想知道我是否可以定位一个 noscript 元素（或在一个 noscript 元素内），因为无论如何我都必须将它留在页面上，或者我是否需要一些其他元素供 JavaScript 定位？

```
<noscript>
  <div class="ad"><a href="foo"><img src="bar" alt="ad" /></a></div>
</noscript> 
```

我的意图是更改或删除 noscript 元素。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T15:40:44.460

`<noscript>`内容不仅在 JS 处于活动状态时不显示，而且显然也不在 DOM 中。我尝试访问一个`<noscript>`区域内的内容（希望你可以`clone()`使用 jQuery 并将其插入其他地方）但什么也没得到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T16:02:52.933

您可以定位 noscript 元素。

```
 <noscript>asdfasFSD</noscript>

    <script>
        alert(document.getElementsByTagName("noscript")[0].innerHTML);
    </script> 
```

这适用于 FF3、IE6 和 Google Chrome。它会提醒我 asdfasFSD。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T15:39:40.187

为什么需要 noscript 元素？如果您只是在 javascript 运行时将其删除或替换为不同的元素，那么 div 的行为就像 noscript 元素一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T15:37:35.790

如果浏览器启用了 javascript，则不会显示 no-script 元素内的内容。

您需要将其放在 javascript 定位之外，并使用 NoScript 部分来实现其目的，即未启用 JavaScript 的用户。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T15:40:31.493

大多数浏览器不会让你定位 noscript 元素，即使你（错误地）给它一个 id。您可以尝试类似[http://dev.opera.com/articles/view/replacing-noscript-with-accessible-un/](http://dev.opera.com/articles/view/replacing-noscript-with-accessible-un/) - 这是实现相同目的的标准兼容方法，但没有 noscript 标签。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T15:37:48.630

如果没有别的，您总是可以使用 JS 来使用 CSS 隐藏该广告。

# java - Struts Validation.xml - requiredif 问题

> ID：272458
> 
> 赞同：0
> 
> 时间：2008-11-07T15:36:22.643
> 
> 标签：java, jsp, tags, jsp-tags

如果从下拉列表中选择了某些选项，我希望我的validation.xml 仅检查空值。到目前为止我有

```
<field property="empFDServiceStartDate" depends="requiredif, date">
        <arg0 key="Service Start date" resource="false"/>
        <var>
                <var-name>field[0]</var-name>
                <var-value>moverChangeType</var-value>
        </var>
        <var>
                <var-name>fieldTest[0]</var-name>
                <var-value>EQUALS</var-value>
        </var>
        <var>
                <var-name>fieldValue[0]</var-name>
                <var-value>Conversion</var-value>
        </var>
</field> 
```

当从 moverChangeType 下拉列表中选择值“Conversion”时，我希望在保存之前检查 empFDServiceStartDate 字段是否为空。目前这不起作用，它允许我保存空值。

任何想法？

我绑定到 struts 1.1，因此不能使用更新的命令。

米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T08:37:13.890

您可以在同一个测试中执行多个测试，如下所示：

```
<field property="empFDServiceStartDate" depends="requiredif, date">
    <arg0 key="Service Start date" resource="false"/>
    <var>
      <var-name>test</var-name>
      <var-value>((moverChangeType == "Conversion") or (moverChangeType == "SomethingElse"))</var-value>
    </var>  
</field> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T15:46:31.950

如果您想检查 moverChangeType 是否等于“Conversion”的字段，请尝试此...

```
<field property="empFDServiceStartDate" depends="requiredif, date">
    <arg0 key="Service Start date" resource="false"/>
    <var>
        <var-name>test</var-name>
        <var-value>(moverChangeType == "Conversion")</var-value>
    </var>
</field> 
```

# c# - 有没有办法在运行时设置#define 的值？

> ID：272459
> 
> 赞同：4
> 
> 时间：2008-11-07T15:37:29.053
> 
> 标签：c#, c-preprocessor

我想知道是否有办法在运行时设置#define 的值。

我假设在下面的代码中有针对特定于 Oracle 和特定于 Sql Server 的查询。

```
#define oracle

// ...    

#if oracle
// some code
#else
// some different code.
#endif 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-07T15:40:44.460

绝对不是，#defines 甚至在编译器看到它之前就由预处理器编译出来 - 所以标记“oracle”甚至不在您的代码中，只是“1”或“0”。将#define 更改为全局变量或（更好）返回正确值的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T15:41:11.743

`#if`是编译时。您可以在构建过程中指定它（通过切换到 msbuild/csc），但不是在运行时指定。排除的代码*不存在*。您可能会更好地建议 (1 of)：

*   使用依赖注入/IoC 为每个后端提供单独的 DAL 堆栈
*   使用支持任一的 ORM 工具
*   基于提供者的代码分支（在单个 DAL 中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T15:41:34.567

不，预处理器在编译之前运行并且可以在那个时候改变代码，这就是它的目的，如果你想在运行时根据某些东西切换行为，请使用变量和正常的条件逻辑。

# sharepoint - 复制 SharePoint 列表

> ID：272468
> 
> 赞同：3
> 
> 时间：2008-11-07T15:39:14.617
> 
> 标签：sharepoint

有没有办法轻松复制 SharePoint 列表代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T17:38:32.130

从 SharePoint 标记来看，我假设您要问“如何以编程方式复制 SharePoint 列表 (SPList)？”
如果不对其进行测试（甚至尝试编译它），我会执行以下操作：

```
SPWeb web; /* add code to initialize to current web */
SPList sourceList = web.Lists["nameOfSourceList"];
sourceList.SaveAsTemplate("templateFNM.stp", "tempList", "tempListDescription", 
                          true /* include list content */);
SPListTemplate template = web.ListTemplates["tempList"];
web.Lists.Add("newListName", "newListDescription", template);
web.Update();
SPList newList = web.Lists["newListName"]; 
```

此外，[这里是](http://www.sharepointblogs.com/sajana/archive/2008/07/06/saving-a-custon-list-template-and-uploading-it-to-another-site-programmatically.aspx)一个博客文章的链接，它实现了相同的跨网络应用程序。

最后一句忠告：如果您使用“程序化”而不是“代码明智”，您将获得更好的搜索结果。

希望这可以帮助。

# mysql - 插入mysql

> ID：272469
> 
> 赞同：0
> 
> 时间：2008-11-07T15:39:19.267
> 
> 标签：mysql

我因此创建了以下数据库表：

```
CREATE TABLE AUCTIONS (
  ARTICLE_NO      VARCHAR(20),
  ARTICLE_NAME    VARCHAR(100),
  SUBTITLE        VARCHAR(20),
  CURRENT_BID     DECIMAL(5,2),
  START_PRICE     DECIMAL(5,2),
  BID_COUNT       VARCHAR(20),
  QUANT_TOTAL     VARCHAR(20),
  QUANT_SOLD      VARCHAR(20),
  ACCESSSTARTS    VARCHAR(20),
  ACCESSENDS      VARCHAR(20),
  ACCESSORIGIN_END VARCHAR(20),
  SELLER_ID       VARCHAR(20),
  BEST_BIDDER_ID  VARCHAR(20),
  FINISHED        TINYINT,
  WATCH           TINYINT,
  BUYITNOW_PRICE  DECIMAL(5,2),
  PIC_URL         VARCHAR(20),
  PRIVATE_AUCTION TINYINT,
  AUCTION_TYPE    VARCHAR(20),
  ACCESSINSERT_DATE     VARCHAR(20),
  ACCESSUPDATE_DATE     VARCHAR(20),
  CAT_1_ID        VARCHAR(20),
  CAT_2_ID        VARCHAR(20),
  ARTICLE_DESC    TEXT,
  COUNTRYCODE     VARCHAR(20),
  LOCATION        VARCHAR(20),
  CONDITIONS      VARCHAR(20),
  REVISED         TINYINT,
  PAYPAL_ACCEPT   TINYINT,
  PRE_TERMINATED  TINYINT,
  SHIPPING_TO     VARCHAR(20),
  FEE_INSERTION   DECIMAL(5,2),
  FEE_FINAL       DECIMAL(5,2),
  FEE_LISTING     DECIMAL(5,2),
  PIC_XXL         TINYINT,
  PIC_DIASHOW     TINYINT,
  PIC_COUNT       VARCHAR(20),
  ITEM_SITE_ID    VARCHAR(20),
  STARTS          DATETIME,
  ENDS            DATETIME,
  ORIGIN_END      DATETIME,
  PRIMARY KEY ( `ARTICLE_NO` )); 
```

这很好。

但是，当尝试输入此行时：

```
5555555 This is the best ARticle in the world!!!!!! True    55.55   3232.2  6   5   5   8.7.2008 17:18:37   8.7.2008 17:18:37   8.7.2008 17:18:37   5454    7877    1   1   46.44 http//www.x.com   1   good    8.7.2008 17:18:37   8.7.2008 17:18:37   22  44  ANZTHINGcanogoherehihhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh    77  germanz none    1   1   1   446 everzwhere australia    22.2    22.2    22.2    1   1   5   1 
```

作为制表符分隔的文本文件，buy_it_nowprice 周围似乎有问题

从 Auctions 执行 select buy_it_nowprice 时，buy_it_nowprice 正确显示为 46.44，但 select pic_url from Auctions 显示返回 1 而不是网站，因此所有后续记录都不合适。

我确定我错过了一个领域或其他东西，但我无法弄清楚它是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T15:43:29.883

你在 46.44 之后有一个空格，而不是一个制表符，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T15:46:30.250

数字后面有一个空格。如果您可以选择使用为您创建文本文件的应用程序中的另一个字段分隔符，这可能会使这类问题更容易被发现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T15:46:59.437

检查 buyitnow_price 和 pic_url 数据字段是否实际上是制表符分隔的，看起来好像它可能是一个空格，而不是一个制表符

# c++ - 如何在 Linux 上获得等效的 printf_l？

> ID：272479
> 
> 赞同：5
> 
> 时间：2008-11-07T15:41:24.317
> 
> 标签：c++, thread-safety, locale, printf

此函数存在于 OS X 上，并允许您将自定义本地传递给函数。setlocale 不是线程安全的，并且将 locale 作为参数传递。

如果没有等效项，则任何与语言环境无关的 printf 或仅用于双打 (%g) 的 printf 都可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T16:04:33.943

您可以尝试[`uselocale`](http://refspecs.freestandards.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/baselib-uselocale-3.html)在调用之前设置线程区域设置（而不是进程区域设置）`printf`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T16:28:48.853

[在http://www.netlib.org/fp/](http://www.netlib.org/fp/)上有独立于语言环境的双精度字符串转换例程。字符串到双重转换也可用。API 不是很好，但代码可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-18T22:43:28.577

有一个独立于语言环境的 sprintf 系列例程，如 stb_sprintf：[https](https://github.com/nothings/stb) ://github.com/nothings/stb 它作为公共域（如果可能）和 MIT 许可证双重许可。

# asp.net - 在不安装 Windows SDK 的情况下安装和使用 aspnet_merge.exe？

> ID：272484
> 
> 赞同：6
> 
> 时间：2008-11-07T15:42:18.183
> 
> 标签：asp.net, msbuild

我使用了网站部署项目，但我发现 aspnet_merge.exe 实用程序不在我的构建服务器上。这使我无法构建。为了获得这个实用程序，我必须安装 Windows SDK，它以 ISO 文件形式提供并且超过 1gb。当我只需要一个组件时，我不想安装整个东西。但我不确定该文件是否依赖于该安装程序中的任何其他内容。我也不明白为什么 Web 工具隐藏在 Windows SDK 中。我希望它包含在一些网络工具安装程序中。

有没有人刚刚将此程序集复制到 FrameworkSDKDir 并使其以这种方式工作？

相关：[使用 Visual Studio 2008 Web 部署项目 - 发现 aspnet_merge.exe 时出错](https://stackoverflow.com/questions/28765/using-visual-studio-2008-web-deployment-projects-getting-an-error-finding-aspne)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-05T20:02:09.680

我下载了 SDK 的“网络”版本，因为设置只有 500KB，它会提示您安装哪些组件，并且只下载和安装您选择的组件。除了“ **.NET 开发工具**”之外，我没有选中所有内容。然后它下载并安装了大约 250MB 的东西，包括 aspnet_merge.exe 和 sgen.exe

[您可以在此处](http://www.microsoft.com/downloads/details.aspx?FamilyID=c17ba869-9671-4330-a63e-1fd44e0e2505&displaylang=en)下载 Win 7 和 .NET 3.5 SP1 的 winsdk_web.exe 安装程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T20:39:50.850

看起来 aspnet_merge.exe 可以在[Web 部署项目](http://msdn.microsoft.com/en-us/library/aa479568.aspx)安装中找到。我没有要测试的干净盒子，但如果我没记错的话，您可以将它放在构建服务器上，而无需安装 VisualStudio 或 Windows SDK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-12T10:53:31.897

实际链接：

[针对 .NET 平台](http://getdotnet.azurewebsites.net/target-dotnet-platforms.html)

在服务器上安装[.NET Framework 4.6.1 Targeting Pack 。](http://go.microsoft.com/fwlink/?LinkId=690706)

# delphi - Delphi 7 - 表单中的嵌入式文件打开对话框

> ID：272489
> 
> 赞同：2
> 
> 时间：2008-11-07T15:44:27.523
> 
> 标签：delphi, delphi-7, topendialog, opendialog

有谁知道是否可以在您自己的表单中嵌入文件打开对话框？

我们有一个选项卡式对话框，在其中一个选项卡上，我们希望用户能够浏览与标准打开对话框具有相同功能的文件，例如“查找”组合框、位置栏、shell 文件列表、文件名组合编辑名称完成等

我已经研究过使用一些 3rd 方组件重新创建对话框，即[Jam Shell Browser Components](http://www.jam-software.com/shellbrowser_delphi/components.shtml)

我可以通过这种方式获得大部分功能，但我缺少一些东西，例如位置栏和文件名自动完成\建议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T16:52:59.913

我不想说这是不可能的，但考虑到你可能涉及的丑陋 winapi 黑客的数量，我建议“使用一些 3rd 方组件重新创建对话框”但使用~~[VirtualShellTools](http://www.mustangpeak.net/)~~。
VirtualShellTools 可以从[这个 SVN 存档](http://www.mswil.ch/websvn/listing.php?repname=devphp&path=/component/VirtualShellTools/&opt=dir&sc=1)下载。
这[是谷歌代码项目页面](https://code.google.com/p/mustangpeakvirtualshelltools/)。

（至少它有文件名自动完成组合框，虽然我不确定它是否有位置栏）。希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T20:15:27.290

使用设置为大图标的 TListView 组件来实现位置栏并不难。Raize [Components](http://www.raize.com)库也有一些可以在这个领域有所帮助的源代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T22:50:20.893

只是一个小提示，使用 SHAutoComplete 添加自动完成组合框相当容易。

有关详细信息，请参阅[本文](http://www.delphi3000.com/articles/article_1852.asp?SK=)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T08:04:48.840

也许这个[Shell Controls Demo](http://www.codebot.org/delphi/?doc=9448)可以帮助你。

![样本表格](https://i.stack.imgur.com/PgOrU.png)

**编辑：** ATM 该站点似乎已关闭。[Wayback 机器有帮助](http://replay.waybackmachine.org/20090416201959/http://www.codebot.org/delphi/?doc=9448)。
这是Wayback 机器所涉及的控件的[最新下载链接：](http://web.archive.org/web/20090214231301/http://codebot.org/delphi/packages/dcodebot.1.00.01.zip)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-09T23:13:44.560

我会重新创建它：使用 VCL 组件应该不会花很长时间。自动完成并不难，如果您浏览 windows 文档足够长的时间，您可以获得其余数据。

您可以通过检测标签更改并像显示标签页一样显示打开的对话框来尝试作弊。您必须检测到用户在对话框外（例如在不同的选项卡上）单击并阻止它关闭，直到您想要更改选项卡。

干杯

# netbeans - NetBeans 6.1 最好的静态分析工具是什么？

> ID：272490
> 
> 赞同：2
> 
> 时间：2008-11-07T15:44:30.660
> 
> 标签：netbeans, plugins

一般来说，我正在为 Java 找到一些插件，但没有我能看到的 netbeans 插件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T15:48:40.027

我使用了[PMD NetBeans 插件](http://sourceforge.net/project/showfiles.php?group_id=56262&package_id=63621)，[这里](http://pmd.sourceforge.net/integrations.html#netbeans)是安装说明（可能有点过时，由于 NetBeans 开发的速度，但我让它们工作）。

这是[静态分析工具](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#Java_2)的列表。也许您可以交叉检查提供 NetBeans 支持的其他人。

**编辑：这些指令有点旧，所以我**[在这里](http://www.billthelizard.com/2008/11/netbeans-pmd-plugin.html)放了一个更新的设置（链接到我的博客）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T21:33:37.757

我找到了[SQE 插件](https://sqe.dev.java.net/)，它将 FindBugs、CheckStyle 和 PMD 集成到一个方便的插件中。

CheckStyle 配置尚未完成，但功能已完整。

# asp.net - ListView、LinqDataSource、linq-to-sql 和排序

> ID：272492
> 
> 赞同：0
> 
> 时间：2008-11-07T15:45:29.940
> 
> 标签：asp.net, linq, linq-to-sql

所以我正在写一个页面，它会做一些报告，而且它非常动态，用户可以对数据进行分组和对列进行排序。我已经能够得到我的动态分组，然后排序，除了现在我生成的 linq-to-sql sql order by 语句与我想要的相反。我想我需要弄清楚在 ListView 中触发 Sorting 事件时如何获取从 LinqDataSource 返回的结果，以便我可以按子句附加分组顺序。

目前我正在覆盖 LinqDataSource 选择事件以提供它的结果并在那里进行动态分组，但是结果由列表视图上的排序修改，我认为在排序期间必须有某种方法来获得该结果或排序事件。

任何见解都将不胜感激，与此同时，我将尝试自己解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T16:24:13.637

太棒了，我想我找到了答案，在我的 LinqDataSource 上将 AutoSort 设置为 false，然后自己对数据进行排序，因为我已经为其他数据对自己进行了排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T16:32:23.747

您可以使用 Linq 根据用户输入操作查询结果 (IEnumerables)。例如（非常伪代码事件处理程序如下）：

```
public void OnUserClickNameColumn(object sender, EventArgs e){
  var data = DataProvider.RetrieveAllUsers();
  // switch between sorting asc and desc when user clicks on a column head
  SessionHelper.CurrentUser.NameColumnSort = !SessionHelper.CurrentUser.NameColumnSort;
  if(SessionHelper.CurrentUser.NameColumnSort) // true =  sort asc else sort desc
    UserDataGrid.DataSource = data.OrderBy(x=>x.Name);
  else
    UserDataGrid.DataSource = data.OrderByDescending(y=>y.Name);
} 
```

# vba - 从 VBA 项目中删除密码

> ID：272503
> 
> 赞同：59
> 
> 时间：2008-11-07T15:48:20.357
> 
> 标签：vba, security, excel, password-protection

如何以编程方式从 Excel VBA 项目中删除（已知）密码？

明确一点：我想从 VBA 项目中删除密码，而不是从工作簿或任何工作表中删除。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2011-10-20T12:23:39.997

删除 VBA 项目密码的另一种方法是；

*   使用十六进制编辑器打开 xls 文件。（即十六进制编辑[http://www.hexedit.com/](http://www.hexedit.com/)）
*   搜索 DPB
*   将 DPB 替换为 DPx
*   保存存档。
*   在 Excel 中打开文件。
*   如果您收到任何消息框，请单击“是”。
*   从 VBA 项目属性设置新密码。
*   关闭并再次打开文件，然后输入新密码以取消保护。

**更新：**对于 Excel 2010（适用于 MS Office Pro Plus 2010 [14.0.6023.1000 64bit]），

*   使用 7zip 打开 XLSX 文件

**如果工作簿受到保护：**

*   浏览文件夹`xl`
*   如果工作簿受到保护，请右键单击`workbook.xml`并选择**编辑**
*   查找部分`<workbookProtection workbookPassword="XXXX" lockStructure="1"/>`（`XXXX`是您的加密密码）
*   移除`XXXX`部分。（即。`<workbookProtection workbookPassword="" lockStructure="1"/>`）
*   保存文件。
*   当 7zip 要求您更新存档时，说**Yes**。
*   关闭 7zip 并重新打开您的 XLSX。
*   单击“**审阅”**选项卡上的“**保护工作簿**” 。
***   可选：保存您的文件。**

 ****如果工作表受到保护：**

*   浏览到`xl/worksheets/`文件夹。
*   右键单击`Sheet1.xml`,`sheet2.xml`等并选择**Edit**。
*   找到部分`<sheetProtection password="XXXX" sheet="1" objects="1" scenarios="1" />`
*   删除加密密码（即。`<sheetProtection password="" sheet="1" objects="1" scenarios="1" />`）
*   保存文件。
*   当 7zip 要求您更新存档时，说**Yes**。
*   关闭 7zip 并重新打开您的 XLSX。
*   单击“**审阅”**选项卡上的“**取消保护工作表**” 。
***   可选：保存您的文件。**

 *** * *

## 回答 #2

> 赞同：22
> 
> 时间：2018-01-24T06:15:36.790

我找到了另一种方法来解决这个问题，以避免 VBA 项目的密码，而不会丢失 excel 密码。

使用**十六进制编辑器 XVI32** 进行处理

如果文件类型是 XLSM 文件：

1.  使用 7-Zip 打开 XLSM 文件（右键单击 -> 7-Zip -> 打开存档）。
2.  将xl/vbaProject.bin文件复制出文件（可以从7-Zip拖拽），不要关闭7-Zip
3.  使用 HexEdit 打开 vbaProject.bin 文件
4.  搜索“DPB=”并将其替换为“DPx=”
5.  保存文件
6.  将此文件复制回 7-Zip（同样，拖放工作）
7.  在 Excel 中打开 XLSX 文件，如果提示“继续加载项目”，请单击“是”。如果提示错误，请单击“确定”。
8.  按 Alt+F11 打开 VBA 编辑器。
9.  按下它会显示错误“意外错误（40230）”，只需单击确定（6 或 7 次）直到它消失。
10.  然后会自动打开

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-07T16:44:00.633

这有一个使用 SendKeys 来取消保护 VBA 项目的简单方法。这将使您进入项目，因此您必须继续使用 SendKeys 找出一种方法来删除密码保护： [http ://www.pcreview.co.uk/forums/thread-989191.php](http://www.pcreview.co.uk/forums/thread-989191.php)

这是一个使用更先进、更可靠的解除保护方法的方法。同样，它只会为您解锁 VB 项目。 [http://www.ozgrid.com/forum/showthread.php?t=13006&page=2](http://www.ozgrid.com/forum/showthread.php?t=13006&page=2)

我没有尝试过任何一种方法，但是如果这是您需要做的，这可能会为您节省一些时间......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-08-25T14:47:25.353

我在 Excel 2016 上的 2 美分：

1.  打开`xls`文件`Notepad++`
2.  搜索`DPB=`并替换为`DPx=`
3.  保存文件
4.  打开文件，打开VB编辑器，打开模块不起作用（`error 40230`）
5.  将文件另存为 xlsm
6.  有用

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-07T16:40:16.647

我发现[这里](http://www.standards.com/Office/SetVBAProjectPassword.html)描述了如何设置 VBA 项目密码。您应该能够修改它以取消设置 VBA 项目密码。

这个不使用 SendKeys。

让我知道这是否有帮助！联合部队

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-12T11:35:49.767

使用 7 zip 打开 xlsm 文件，提取 vbaproject.bin 并在记事本 ++ 中用 DPx 替换 DpB 并重新保存后，我得到了很多 vbaproject 错误，vba 项目密码消失了，但没有代码/表单。

我右键单击导出并能够重新导入到新项目。

# php - semop 调用的 EINTR 错误

> ID：272504
> 
> 赞同：1
> 
> 时间：2008-11-07T15:48:25.347
> 
> 标签：php, c, semaphore

我在 php 脚本中使用以下代码片段来安全地更新共享资源。

```
$lock_id = sem_get( ftok( 'tmp/this.lock', 'r'));
sem_acquire($lock_id)
//do something
sem_release($lock_id) 
```

当我用大量请求对这段代码进行压力测试时，我得到一个错误：

```
Warning: semop() failed acquiring SYSVSEM_SETVAL for key 0x1e: No space left on device in blahblah.php on line 1293 
```

php 源代码显示以下获取 SYSVSEM_SETVAL 失败的代码

```
while (semop(semid, sop, 3) == -1) {
    if (errno != EINTR) {
        php3_error(E_WARNING, "semop() failed acquiring SYSVSEM_SETVAL for key 0x%x: %s", key, strerror(errno));
        break;
    }
} 
```

这意味着 semop 因 EINTR 而失败。手册页显示 semop() 系统调用被信号中断。

我的问题是我可以安全地忽略此错误并重试 sem_acquire 吗？

**编辑**：我误解了这个问题，请参阅我在下面发布的说明。

拉吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T16:27:17.687

我不会忽略 ENOSPC（如代码所示，您得到的不是 EINTR）。您可能最终会进入一个繁忙的循环，等待您之前用尽的资源。如果您在某处没有空间，则要确保处理该问题。ENOSPC 通常意味着你没有……某事。

一些随机的想法：

我不是 PHP 实现方面的专家，但我会尽量避免`sem_get()`每次需要信号量时调用。而是存放手柄。可能是某些资源与对 sem_get 的每次调用相关联，这就是您空间不足的地方。

我会确保检查您的错误返回`sem_get()`。这是一个代码片段，但是如果您无法获得 sema4，那么在尝试`sem_op()`它时会得到不一致的结果（也许 EINTR 是有道理的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T17:31:39.617

在发布这个问题后，我注意到我误读了代码并得出了结论。因此，正如 bog 所指出的，错误是而不是。经过一番挖掘，我找到了原因。撤消缓冲区的数量已用尽。我增加了数量，现在代码运行没有问题。我用l 作为值`errno` **`==`** `EINTR``ENOSPC``EINTR``ENOSPC``semmnu``semmni*semms``semmnu`

# ruby-on-rails - 如何从 Rails 控制器显式声明视图？

> ID：272509
> 
> 赞同：22
> 
> 时间：2008-11-07T15:49:52.303
> 
> 标签：ruby-on-rails

我想从我的控制器显式调用一个视图。

现在我有：

```
def some_action
  .. do something ...
  respond_to do |format|
    format.xml
  end
end 
```

...然后它调用我的 some_action.xml.builder 视图。我怎样才能调用其他视图？respond_to 中是否有我缺少的参数？

谢谢，

J.P

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-07T16:10:24.697

您可以使用渲染执行以下操作：

```
respond_to do |format|
    format.html { render :template => "weblog/show" }
end 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-07T16:05:40.477

请参阅[ActionController::Base 文档的渲染部分，了解](http://api.rubyonrails.org/classes/ActionController/Base.html#M000474)您可以控制渲染内容的不同方式。

你可以告诉 Rails 渲染一个特定的视图（模板），如下所示：

```
# Renders the template located in [TEMPLATE_ROOT]/weblog/show.r(html|xml) (in Rails, app/views/weblog/show.erb)
  render :template => "weblog/show"

# Renders the template with a local variable
  render :template => "weblog/show", :locals => {:customer => Customer.new} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-30T13:02:52.950

或者更简单，因为[Rails > 3.0](http://guides.rubyonrails.org/layouts_and_rendering.html#rendering-an-action-s-view)：

```
render "edit" 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-07T16:14:04.767

如果这样更方便，您也可以传递 :action 或 :controller。

```
respond_to do |format|
    format.html { render :action => 'show' }
end 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-07-29T20:33:40.407

您可以通过`lookup_context`在控制器中执行此操作来修改控制器的内部

```
before_filter do
  lookup_context.prefixes << 'view_prefix'
end 
```

并且控制器将在查找列表中的所有其他视图前缀后`view/view_prefix/show.html`响应请求时尝试加载。`show`默认列表通常`application`是当前控制器的名称。

```
class MagicController
  before_filter do
    lookup_context.prefixes << 'secondary'
  end

  def show
    # ...
  end
end

app.get '/magic/1` 
```

此`GET`请求将按以下顺序查找视图：

*   `view/application/show.erb`
*   `view/magic/show.erb`
*   `view/secondary/show.erb`

并使用第一个找到的视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T15:24:26.533

使用渲染

[http://api.rubyonrails.com/classes/ActionController/Base.html#M000474](http://api.rubyonrails.com/classes/ActionController/Base.html#M000474)

# matlab - 如何在 MATLAB 中的函数内创建 GUI？

> ID：272511
> 
> 赞同：5
> 
> 时间：2008-11-07T15:50:24.267
> 
> 标签：matlab, function, user-interface

是否可以从函数内部编写 GUI？

问题是所有 GUI 函数的回调都在全局工作区中进行评估。但是函数有自己的工作空间，不能访问全局工作空间中的变量。是否可以让 GUI 函数使用该函数的工作区？例如：

```
function myvar = myfunc()
    myvar = true;
    h_fig = figure;

    % create a useless button
    uicontrol( h_fig, 'style', 'pushbutton', ...
                      'string', 'clickme', ...
                      'callback', 'myvar = false' );

    % wait for the button to be pressed
    while myvar
        pause( 0.2 );
    end

    close( h_fig );

    disp( 'this will never be displayed' );
end 
```

这个事件循环将无限期地运行，因为回调不会`myvar`在函数中修改。相反，它将`myvar`在全局工作区中创建一个新的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T18:39:03.643

[构建 GUI](https://www.mathworks.com/help/matlab/creating_guis/ways-to-build-matlab-guis.html)有多种方法，例如使用 App Designer、GUIDE 或以编程方式创建它（我将在下面说明此选项）。了解为您的 GUI 组件[定义回调函数的不同方法以及](https://www.mathworks.com/help/matlab/creating_guis/write-callbacks-using-the-programmatic-workflow.html)[可用于在组件之间共享数据的选项](https://www.mathworks.com/help/matlab/creating_guis/share-data-among-callbacks.html)也很重要。

我偏爱的方法是使用[嵌套函数](https://www.mathworks.com/help/matlab/matlab_prog/nested-functions.html)作为回调。以下是一个简单的 GUI 作为示例：

```
function make_useless_button()

  % Initialize variables and graphics:
  iCounter = 0;
  hFigure = figure;
  hButton = uicontrol('Style', 'pushbutton', 'Parent', hFigure, ...
                      'String', 'Blah', 'Callback', @increment);

  % Nested callback function:
  function increment(~, ~)
    iCounter = iCounter+1;
    disp(iCounter);
  end

end 
```

当您运行此代码时，每次按下按钮时显示的计数器应增加一，因为嵌套函数可以`increment`访问. 请注意，按钮回调设置为 的[函数句柄](https://www.mathworks.com/help/matlab/creating_guis/write-callbacks-using-the-programmatic-workflow.html#br7qvh9)，并且此函数默认情况下必须接受两个参数：触发回调的 UI 组件的图形句柄和关联事件数据的结构。在这种情况下，我们[忽略它们，](https://www.mathworks.com/help/matlab/matlab_prog/ignore-function-inputs.html)因为我们没有使用它们。`make_useless_button``iCounter``increment`[`~`](https://www.mathworks.com/help/matlab/matlab_prog/ignore-function-inputs.html)

将上述方法扩展到您的特定问题，您可以添加循环并更改回调，以便将标志变量设置为 false：

```
function make_stop_button()

  % Initialize variables and graphics:
  keepLooping = true;
  hFigure = figure;
  hButton = uicontrol('Style', 'pushbutton', 'Parent', hFigure, ...
                      'String', 'Stop', 'Callback', @stop_fcn);

  % Keep looping until the button is pressed:
  while keepLooping,
    drawnow;
  end

  % Delete the figure:
  delete(hFigure);

  % Nested callback function:
  function stop_fcn(~, ~)
    keepLooping = false;
  end

end 
```

这里[`drawnow`](https://www.mathworks.com/help/matlab/ref/drawnow.html)需要 给按钮回调一个机会来中断循环内的程序流程并修改`keepLooping`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T16:12:38.513

您可以在函数中声明一个全局变量，在 GUI 代码中声明一个全局变量，当然，如果回调在单独的函数中而不是内联函数中。我已经在一个用来制作快速菜单系统的小骨架 GUI 中完成了这项工作。

在上面的代码中，您可以将 global 关键字添加到初始声明以及内联回调中，即“global myvar = false”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T13:07:57.620

我找到了解决问题的方法。回调函数必须修改 GUI 的句柄结构。可以从回调内部和函数中访问此结构，而无需将新变量引入全局工作区：

```
function myfunc()
    h_fig = figure;

    % add continue_loop to the GUI-handles structure
    fig_handles = guihandles( h_fig );
    fig_handles.continue_loop = true;
    guidata( h_fig, fig_handles );

    % create a useless button
    uicontrol( h_fig, 'style', 'pushbutton', ...
                      'string', 'clickme', ...
                      'callback', @gui_callback );

    % wait for the button to be pressed
    while fig_handles.continue_loop
        fig_handles = guidata( h_fig ); % update handles
        pause( 0.2 );
    end

    close( h_fig );
    disp( 'callback ran successfully' );
end

% The arguments are the Matlab-defaults for GUI-callbacks.
function gui_callback( hObject, eventdata, handles )
    % modify and save handles-Structure
    handles.continue_loop = false;
    guidata( hObject, handles );
end 
```

请注意，由于 while 循环只会在运行时更新 fig_handles，因此在循环捕获对`fig_handles.continue_loop`

# deployment - MSBuild ReadLinesFromFile 一行中的所有文本

> ID：272518
> 
> 赞同：17
> 
> 时间：2008-11-07T15:54:00.750
> 
> 标签：deployment, msbuild, msbuild-task, msbuildcommunitytasks

当我对 MSBUILD 中的文件执行 ReadLinesFromFile 并再次输出该文件时，我将所有文本放在一行上。所有的回车和 LineFeed 都被去掉了。

```
<Project DefaultTargets = "Deploy"
xmlns="http://schemas.microsoft.com/developer/msbuild/2003" >
<Import  Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>

<ItemGroup>
    <MyTextFile Include="$(ReleaseNotesDir)$(NewBuildNumber).txt"/>
</ItemGroup>

<Target Name="ReadReleaseNotes">
    <ReadLinesFromFile
        File="@(MyTextFile)" >
        <Output
            TaskParameter="Lines"
            ItemName="ReleaseNoteItems"/>
    </ReadLinesFromFile>
</Target>

<Target Name="MailUsers" DependsOnTargets="ReadReleaseNotes" >
    <Mail SmtpServer="$(MailServer)"
        To="$(MyEMail)"
        From="$(MyEMail)"
        Subject="Test Mail Task"
        Body="@(ReleaseNoteItems)" />
</Target>
<Target Name="Deploy">
    <CallTarget Targets="MailUsers" />
</Target>

</Project> 
```

我从通常看起来像这样的文件中获取文本

> ```
> - New Deployment Tool for BLAH
> 
> - Random other stuff()"" 
> ```

这样出来

> ```
> - New Deployment Tool for BLAH;- Random other stuff()"" 
> ```

我知道 ReadLinesFromFile 的代码将一次将数据拉入一行并去掉回车符。

有没有办法把它们放回去？所以我的电子邮件看起来格式都很好？

谢谢

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-11-08T13:32:22.207

这里的问题是您`ReadLinesFromFile`以非预期的方式使用该任务。

> **ReadLinesFromFile 任务**从文本文件
> 中读取*项目列表。*

因此，它不仅仅是从文件中读取所有文本，而是从文件中读取单个项目并返回 ITaskItem 的项目组。每当您使用`@()`语法输出项目列表时，您将获得一个分隔列表，其默认值为分号。此示例说明了此行为：

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build"    xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">

    <ItemGroup>
        <Color Include="Red" />
        <Color Include="Blue" />
        <Color Include="Green" />
</ItemGroup>

<Target Name="Build">
        <Message Text="ItemGroup Color: @(Color)" />
</Target>

</Project> 
```

输出如下所示：

```
 ItemGroup Color: Red;Blue;Green 
```

因此，虽然解决您的问题的最佳解决方案是编写一个 MSBuild 任务，将文件作为字符串而不是项目列表读取到*属性中，但这确实不是您所要求的。*你问是否有*办法*把它们放回去，并且有使用[MSBuild Transforms](http://msdn.microsoft.com/en-us/library/ms171476.aspx)。

转换用于从另一个列表创建一个列表，并且还可以使用自定义分隔符进行转换。所以答案是将你读入的`ReadItemsFromFile`列表转换为另一个带有换行符的列表。这是一个这样做的例子：

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">

    <ItemGroup>
        <File Include="$(MSBuildProjectDirectory)\Test.txt" />
    </ItemGroup>

    <Target Name="Build">
        <ReadLinesFromFile File="@(File)">
            <Output TaskParameter="Lines" ItemName="FileContents" />
        </ReadLinesFromFile>

        <Message Text="FileContents: @(FileContents)" />
        <Message Text="FileContents Transformed: @(FileContents->'%(Identity)', '%0a%0d')" />
    </Target>

</Project> 
```

Test.text 看起来像：

```
Red
Green
Blue 
```

输出如下所示：

```
[C:\temp]:: msbuild test.proj
Microsoft (R) Build Engine Version 3.5.21022.8
[Microsoft .NET Framework, Version 2.0.50727.1433]
Copyright (C) Microsoft Corporation 2007\. All rights reserved.

Build started 11/8/2008 8:16:59 AM.
Project "C:\temp\test.proj" on node 0 (default targets).
  FileContents: Red;Green;Blue
  FileContents Transformed: Red
Green
Blue
Done Building Project "C:\temp\test.proj" (default targets).

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:00.03 
```

这里发生了两件事。

```
@(FileContents->'%(Identity)', '%0a%0d') 
```

*   我们使用相同的值 ( `Identity`) 将列表从一种类型转换为另一种类型，但使用自定义分隔符`'%0a%0d'`
*   我们正在使用[MSBuild Escaping](http://msdn.microsoft.com/en-us/library/ms228186.aspx)来转义换行符 ( `%0a`) 和回车符 ( `%0d`)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-02-17T20:41:51.170

如果您使用的是 MSBuild 4.0，则可以改为执行以下操作来获取文件的内容：

```
$([System.IO.File]::ReadAllText($FilePath)) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-12T09:39:42.950

而不是@(FileContents->'%(Identity)', '%0a%0d') 我相信你可以做@(FileContents, '%0a%0d')

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-02T14:59:53.613

您可以将 WriteLinesToFile 与

```
$([System.IO.File]::ReadAllText($(SourceFilePath))):

< WriteLinesToFile File="$(DestinationFilePath)"  Lines="$([System.IO.File]::ReadAllText($(SourceFilePath)))"
                      Overwrite="true" 
                      /> 
```

这将完全复制您的文件。

# sql-server - 使用 MozyPro 进行 SQL Server 联机备份

> ID：272521
> 
> 赞同：4
> 
> 时间：2008-11-07T15:54:34.383
> 
> 标签：sql-server, backup, mozy

有人使用 MozyPro 备份 SQL Server 数据库吗？

我担心它进行备份的方式。它只是按原样复制数据文件。不使用备份数据库命令。

安全吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T18:26:09.133

MozyPro 使用卷影服务 (VSS) 为 SQL Server 创建备份。SQL Server 2005 的设计使 VSS 备份保持一致。所以这绝对是备份 SQL Server 数据库的有效方法。

这是关于 SQL Server 2005 SQL Writer 如何与 VSS 一起使用[的白皮书。](http://www.microsoft.com/technet/prodtechnol/sql/2005/sqlwriter.mspx)

> Microsoft® SQL Server™ 2005 支持使用卷影复制服务 (VSS) 从 SQL Server 数据创建快照。这是通过提供与 VSS 兼容的编写器（SQL 编写器）来实现的，以便第三方备份应用程序可以使用 VSS 框架来备份数据库文件。本文介绍了 SQL 编写器组件及其在 SQL Server 数据库的 VSS 快照创建和还原过程中的作用。它还详细介绍了如何在 VSS 框架的上下文中配置和使用 SQL 编写器来处理备份应用程序。

[这是 MozyPro 手册](http://www.mozypro.com/docs/MozyPro_Client_Manual.pdf)(PDF)，其中描述了如何还原使用 VSS 制作的 SQL Server 备份。

话虽如此，如果您不信任此方法，则没有什么可以阻止您设置备份作业并让 Mozy 备份您的 *.bak 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-30T12:28:13.087

从我目前正在与 Mozy 经历的地狱来看。不不不！理论上，备份工作，但不是恢复部分。Mozy 的极端增量备份系统导致恢复可能需要数周时间。显然。尽管谈论了他们的顶级技术支持，我仍在等待，已经过去了 10 多天。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-15T17:15:40.757

[https://github.com/candera/hobocopy](https://github.com/candera/hobocopy)

> 为什么 HOBCOPY 使用卷影服务？
> 
> Because HoboCopy copies from a VSS snapshot, it is able copy even files that are in locked by some other program. Further, certain programs (such as SQL Server 2005) are VSS-aware, and will write their state to disk in a consistent state before the snapshot is taken, allowing a sort of "live backup". Files locked by VSS-unaware programs will still be copied in a "crash consistent" state (i.e. whatever happens to be on the disk). This is generally a lot better than not being able to copy the file at all.

# c++ - 套接字异常：“端点映射器没有更多可用的端点”

> ID：272523
> 
> 赞同：7
> 
> 时间：2008-11-07T15:55:08.330
> 
> 标签：c++, exception, sockets, winsock, rpc

我正在使用 winsock 和 C++ 来设置服务器应用程序。我遇到的问题是调用`listen`导致第一次机会异常。我想通常这些可以忽略（？），但我发现其他人有同样的问题，它导致应用程序每隔一段时间就会挂起。任何帮助将不胜感激。

第一次机会例外是：

> *MyApp* .exe中 0x*12345678* 处的第一次机会异常：0x000006D9：端点映射器中没有更多可用的端点。

我发现一些证据表明这可能是由套接字引起的，我正在使用的代码如下。`listen`异常发生在从底部数第五行的调用中。

```
 m_accept_fd = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);

  if (m_accept_fd == INVALID_SOCKET)
  {
    return false;
  }

  int optval = 1;

  if (setsockopt (m_accept_fd, SOL_SOCKET, SO_REUSEADDR,
                  (char*)&optval, sizeof(optval)))
  {
    closesocket(m_accept_fd);
    m_accept_fd = INVALID_SOCKET;
    return false;
  }

  struct sockaddr_in  local_addr;
  local_addr.sin_family = AF_INET;
  local_addr.sin_addr.s_addr = INADDR_ANY;
  local_addr.sin_port = htons(m_port);

  if (bind(m_accept_fd, (struct sockaddr *)&local_addr,
           sizeof(struct sockaddr_in)) == SOCKET_ERROR)
  {
    closesocket(m_accept_fd);
    return false;
  }

  if (listen (m_accept_fd, 5) == SOCKET_ERROR)
  {
    closesocket(m_accept_fd);
    return false;
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-08T04:42:39.950

在非常繁忙的服务器上，您可能会用完 Sockets。您可能需要调整一些 TCPIP 参数。在注册表中调整这两个：

```
HKLM\System\CurrentControlSet\Services\Tcpip\Parameters
   MaxUserPort  REG_DWORD  65534 (decimal)
   TcpTimedWaitDelay REG_DWORD 60 (decimal) 
```

默认情况下，释放网络端口（套接字）和重新使用它之间有几分钟的延迟。此外，根据操作系统版本，Windows 将使用的范围内只有几千个。在服务器上，在命令提示符下运行：

> netstat -an

并查看结果（管道到文件最简单：netstat -an > netstat.txt）。如果您在 Timed Wait Delay 状态下看到 1025->5000 的大量端口，那么这就是您的问题，可以通过使用上面的注册表项将最大用户端口从 5000 调整到 65534 来解决。您还可以通过使用上面的注册表项来调整延迟，以更快地回收端口。

如果这不是问题，那么问题可能是您在 Listen() 方法中设置的挂起连接数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T13:26:35.920

最初的问题与winsock无关。以上所有答案都是错误的。忽略第一次机会异常，这不是您的应用程序的问题，只是一些内部错误处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T01:25:54.900

您是否真的看到了问题，例如，程序是否因为未处理的异常而结束？

即使没有问题，调试器也可能会打印消息，例如，请参见[此处](http://blogs.msdn.com/davidklinems/archive/2005/07/12/438061.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T16:49:27.550

呃，也许是因为你极大地限制了传入连接的最大数量？

```
listen (m_accept_fd, 5)
// Limit here       ^^^ 
```

如果您允许更大的积压，您应该能够处理您的问题。使用 SOMAXCONN 之类的东西而不是 5。

此外，如果您的问题仅在服务器启动时，您可能需要关闭 LINGER (SO_LINGER) 以防止连接挂起并阻塞套接字......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T16:45:36.807

这不会直接回答您的问题，但是由于您使用的是 C++，因此我建议您使用[Boost::Asio 之](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio.html)类的东西来处理您的套接字代码。这为您提供了对 winsock API 的一个很好的抽象，并且应该允许您更轻松地诊断错误情况。

# .net - 应用程序数据同步 - 与旧应用程序一起运行新应用程序

> ID：272524
> 
> 赞同：1
> 
> 时间：2008-11-07T15:55:38.250
> 
> 标签：.net, database, synchronization, legacy

我们正在更换旧系统。这两个应用程序将在一段时间内同时运行。用户将能够使用任一系统，挑战在于能够保持他们的数据库彼此同步。

新系统是 ASP.NET，旧系统是 VB6。两者都在 SQL Server 数据库上运行。目前还不清楚数据库是否会在同一个服务器机房，更不用说同一个国家了。

到目前为止，桌面上的两个解决方案是：

1.  位于每台机器上并由其他应用程序调用的 Web 服务。
    *   需要修改本机对象的基类上的 Save 方法。这是侵入性的，并且在关闭它时可能是一个问题。
2.  一个单一的 Windows 服务，它轮询每个数据库并计算出发生了什么变化并在适当的时候转发适应的更新。

    *   需要更改两个应用程序中的模式以确保它们在所有表上都有 LastModified (DateTime)，以便我们可以在任何给定的时间间隔执行定期 SELECT。

这两种解决方案似乎都是合理的。两种解决方案各有利弊。企业要求在更新一个系统和在另一个系统中看到它之间延迟不超过 2 秒（！）。这可能是一个延伸目标，但它是一个目标。

其他被建议但被拒绝的（我愿意重新考虑）是：

*   数据库触发器 (blugrh)
*   BizTalk 或其他总线（看起来像一把大锤，对于切换解决方案来说太复杂了）
*   修改所有存储过程 (noooo.)
*   SSIS（对此还不够了解）

欣赏你可能有的任何想法。

编辑：注意架构完全不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T16:06:54.467

2 秒，这是一个非常紧迫的时间线，我猜你的 Windows 应用程序解决方案可能不会削减它，如果一次有数百个更改或任何东西，轮询时间几乎必须是每秒希望能在2以内。

数据库是否使用相同的结构？如果是这样，我会考虑实现复制。

**编辑**

在模式完全不同的评论和补充之后，我不得不说我真的看到了两组操作。

1.  修改应用程序中的数据存储选项以在两个表中进行插入/更新/删除。优点：即时，无需共享外部流程。缺点：必须修改所有代码，难以禁用等。

2.  如您所述，创建一个同步应用程序，以同步更改的数据。优点：传输完成后可以简单地禁用。缺点：写起来非常复杂，尤其是在有大量表的情况下。此外，没有那么快，2 秒将很难完成

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T16:46:42.720

我个人会拒绝用户同时使用任一系统的想法。如果用户 1 在系统 1 上更改了记录 1，而用户 2 在系统 2 上以不同的方式更改了记录 1，您将如何解决该问题？

此外，如果您不要求人们使用新系统，他们不会。在大多数组织中，对变革的抵制非常强烈。

相反，我建议您推出新系统并要求所有人使用它并每小时向旧系统发送数据，以防您出于任何原因需要恢复。

我认为没有合理的方法来获得 2 秒的同步。这是一个荒谬的要求，应该毫不含糊地告诉业务方。

有时，当业务用户想要一些不合理的东西时，您只需要反击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T10:37:23.610

你在这里描述的让我感觉像是在做噩梦！我认为您首先应该开始向所有人说明，在整个过渡过程中，不可能（或至少极其昂贵）考虑允许用户通过 2 个不同的应用程序和 2 个不同的数据库更新所有数据！我什至不是在谈论 2 秒的延迟......

在我看来，基本策略应该是逐步将数据更新权限和可能性从旧应用程序切换到新应用程序。用户将能够看到双方的数据，但只能通过其中一个应用程序进行更新。

（顺便说一下，这种方法也会迫使用户逐渐切换到新版本，避免[@HLGEM已经暴露的预期和烦人的阻力问题](https://stackoverflow.com/questions/272524/application-data-synchronisation-running-the-new-app-in-tandem-with-the-legacy#272672)）

一旦明确接受此规则，您就可以实施以下步骤。

1.  设置所有允许数据从旧数据库传输到新数据库的程序。我猜你需要在接下来的几个月里运行它们几次......
2.  设置所有允许以其他方式传输数据的程序（反向数据传输）
3.  在这里，您应该已经确定了可以一起移动的同质表组。合并前面的代码，以便为每个组获得一个“数据传输”过程和一个“反向传输”过程。

然后，对于这些组中的每一个

4.  通过代码或数据库级别设置更新限制
5.  运行您的“数据传输”程序
6.  将您的“反向传输”过程组织为新数据库中的触发器

我猜您可以传输的第一种数据将是不包含任何外键的列表。

以这种方式工作，您将逐渐从您有

*   读/写旧版应用程序 + 只读新应用程序

到

*   只读旧版应用程序 + 读/写新应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T22:40:14.270

最后，通过网络服务解决了这个问题。它工作得非常好。

# language-agnostic - 将成就添加到商务级软件的技术

> ID：272528
> 
> 赞同：9
> 
> 时间：2008-11-07T15:57:33.690
> 
> 标签：language-agnostic, design-patterns

我正在考虑在我们的内部错误跟踪和时间记录系统中添加一些**成就。**它连接到 SQL Server 后端。

起初我认为系统可以在数据库上运行，使用触发器来例如知道何时：

*   你已经记录了 1000 小时
*   创建了 1000 张票
*   关闭你自己的票
*   处理了一段时间未触及的票。
*   等（你知道 - 数据库的东西）

但后来我意识到我也想要纯粹**的前端成就**

*   使用了高级搜索功能
*   按列排序
*   将设置重置为默认值
*   搜索了 500 次

似乎每个成就的逻辑都必须手动编码。谁能想象某种*成就规则引擎*，例如您为其创建脚本？

以及如何存储它们？如果成就是：

*   在一个会话中更改列排序顺序 50 次

这意味着每次他们对 listview 列进行排序时，它都会更新数据库。

对这个 Win32 应用程序设计问题有什么想法吗？我不认为[四人帮](http://en.wikipedia.org/wiki/Gang_of_Four)有成就**设计模式**。

* * *

**注意：**它是 Win32 客户端应用程序，而不是网站。

* * *

我绝对喜欢事件系统的想法。用户采取的各种操作可以通过单个事件对象引发事件：

```
protected void TimeEntriesListView_ColumnSort(object sender, EventArgs e)
{
    _globalListener.RaiseEvent(EventType.ListViewColumnSort, sender, e);
}

protected void TimeEntriesListView_ColumnDrag(object sender, EventArgs e)
{
    _globalListener.RaiseEvent(EventType.ListViewColumnDrag, sender, e);
} 
```

然后，该对象可以添加逻辑来决定它想要计算哪些事件。但更合理的是，各种事件侦听器可以附加到中央事件侦听器，并有自己的自定义成就逻辑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T16:19:55.707

诀窍不是规则的编码，实际上，这些规则很简单，并且可能是简单的表达式（number_of_bugs > 1000）。

诀窍是积累统计数据。您应该查看一种事件流处理形式来记录您的成就。例如，您并不想一直使用“select count(*) from bugs where user= :user”来实现“1000 个错误”成就（您可以这样做，但可以说不应该这样做）。相反，每次他们发布错误时，您都应该获得一个事件，并且您的成就系统记录“发现另一个错误”。然后规则可以检查“number_of_bugs > 1000”。

显然，您可能需要“启动泵”，当您启动成就系统时，将 number_of_bugs 设置为数据库中的当前数字。

但目标是保持实际事件处理的轻量级，因此让它在事件经过时跟踪事件，所有事件都在公共的内部管道或总线上运行。

脚本语言也是一个好主意，因为它们可以轻松评估表达式和更复杂的逻辑。例如，“number_of_bugs > 1000”是一个完全有效的 Javascript 程序。游戏只是设置环境。

如果您愿意，您还可以将脚本存储在数据库中并制作一个“成就”编辑器以动态添加它们，假设您正在捕获所有相关事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T17:17:34.640

我也在试图弄清楚如何建立一个成就规则引擎。

我检查了规则引擎以及它的基础知识。维基百科中有一个[很好的总结](http://en.wikipedia.org/wiki/Business_rules_engine)

基本上，例如，当您检查某些东西的可用性时，您要么有前向链接；否则，您使用[事件条件操作](http://en.wikipedia.org/wiki/Event_Condition_Action)规则。它是最近引起我注意的。

因此，您可以预定义一组触发事件。在引擎中，您可以定义基于可用指标的检查条件，并指定关联成就。

这种方式似乎更灵活，但您必须定义事件、可能的条件检查和指标。

例如，您将在代码中触发各种事件，例如 TicketCreated。

在规则引擎中，你可以有类似的东西

```
Event: TicketCreated
Condition: UserTicketCount >= 1000
Achivement: "Created 1000 tickets" 
```

或“将设置重置为默认值”

```
Event: SettingsChanged
Condition: Settings = DEFAULT
Achievement: "Reset to Default" 
```

我还没有尝试过，但我很快就会尝试。目前主要是理论上的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:02:15.070

后端成就应该很简单——它们似乎基于已经跟踪的项目。正如您正确指出的那样，前端将需要更多跟踪。您可能想要执行此操作的一种方法是为您的前端站点实施分析引擎。

[http://www.piwik.org](http://www.piwik.org)上的Piwik 在这里可能会有所帮助 - 它是您自己托管的 google 分析克隆。这个想法是使用它的日志记录功能来跟踪成就的完成时间。

至于某种形式的规则脚本，您将始终必须手动编写代码——不过，您也许可以通过创建自己的小型脚本引擎或实现自定义 Lua 集来使其更简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T16:24:50.110

将与成就关联的sql查询存储在数据库本身中如何，因此添加新成就只涉及为其添加名称和sql查询。

例如

您已经记录了 1000 小时 - “选择 case sum(hours) > 1000 then 'true' else 'false' end from user where user_id = ?”

基于 UI 的成就也必须将数据存储在数据库中，因为您可以将相同的数据用于其他成就。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-19T01:29:37.577

我认为一张桌子可以容纳您要跟踪的每个事件。例如“*执行搜索*”。然后每个成就都可以有一个与之关联的 SQL。

**然后，您可以在Event**表上构建一个触发器，该触发器将比较适用于该事件的成就，并将该成就添加到**Achivement**表中。

以下是快速表设计：

```
EventItems:
UserId, EventName, DateOccured, AnyOtherInfo

AchievementQualifiers: 
Achievement Name, AchievementCheckSQL, EventsThisAppliesTo 
(Normalize this, if multiple events apply) 
```

在您的系统中，无论是 web 还是 win32，只要用户执行某些您想要跟踪的事件，您只需将其插入**EventItems表中。**你可以做一个类来处理这个。对于纯 DB 类型的事件，例如“Item Posted”或“Comment Posted”，您可以使用触发器来执行此操作。

然后，在**EventItems**的触发器中，对于每个具有**EventThisAppliesTo的****AchievementQualifer** ，运行 SQL 检查，如果它为真且尚未授予，则更新**UserAchievement表。**

 *****请原谅我的拼写错误，因为我坐在啤酒吧里打字。*

# sharepoint - 管理中心中的共享点选择器在服务器 VM 上的 IE 6 中不起作用 (MOSS 2007)

> ID：272532
> 
> 赞同：0
> 
> 时间：2008-11-07T15:58:49.477
> 
> 标签：sharepoint, internet-explorer-6

Sharepoint 管理中心网站使用我经常谈论的选择器控件（主要用于选择网站集和 Web 应用程序）

[![共享点选择器控件](https://i.stack.imgur.com/q3ES8.jpg)](https://i.stack.imgur.com/q3ES8.jpg)

我在 VM 上安装了 MOSS 2007。当我从桌面上的虚拟机外部打开管理中心时，一切正常。但是当我从安装在 VM 上的 IE 6 打开它时，选择器不会打开弹出窗口，当我点击它们时，似乎没有 javascript 错误。

我想这与虚拟机上浏览器的配置有关，但我不知道到底要寻找什么。

任何建议表示赞赏！

@Edit：我通过在虚拟机上安装 IE7 解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T16:11:03.587

我也有这个问题。你在桌面上使用 IE6 吗？还是IE7？

我解决它的方法是在我的桌面上使用 IE7。

# java - 如何“反编译”Java 类文件？

> ID：272535
> 
> 赞同：556
> 
> 时间：2008-11-07T16:00:03.733
> 
> 标签：java, decompiler

我可以使用什么程序来反编译类文件？我真的会得到 Java 代码，还是只是 JVM 汇编代码？

关于这个站点上的 Java 性能问题，我经常看到“反编译”Java 类文件以了解编译器如何优化某些内容的人的回复。

* * *

## 回答 #1

> 赞同：588
> 
> 时间：2008-11-07T16:18:48.140

2016 年 2 月更新：

[www.javadecompilers.com](http://www.javadecompilers.com/)将 JAD 列为：

> 最流行的 Java 反编译器，但主要仅限于这个时代。用 C++ 编写，速度非常快。
> Java 5 及更高版本已过时、不受支持且无法正确反编译

所以你的里程可能会随着最近的jdk（7、8）而变化。

同一站点列出了其他工具。

[正如Salvador Valencia](https://stackoverflow.com/users/1377112/salvador-valencia)在[评论](https://stackoverflow.com/questions/272535/how-do-i-decompile-java-class-files/272595#comment79458645_272595)（2017 年 9 月）中所指出的那样，javadecompiler提供了一个 SaaS，您可以在其中将`.class`文件上传到云端，并返回反编译的代码。

* * *

原始答案：2008 年 10 月

*   JSR 176 的最终版本定义了 J2SE 5.0 (Java SE 5) 的主要特性，已于 2004 年 9 月 30 日发布。
*   由 Pavel Kouznetsov 先生编写的著名 Java 反编译器 JAD 支持的最新 Java 版本是**[JDK 1.3](http://varaneckas.com/jad/)**。
*   今天可从 Internet 下载的大多数 Java 反编译器，例如“DJ Java Decompiler”或“Cavaj Java Decompiler”，都是由 JAD 驱动的：它们无法显示 Java 5 源代码。

[Java Decompiler](http://jd.benow.ca/)（又一个 Fast Java 反编译器）具有：

*   明确支持反编译和分析**Java 5+** “.class”文件。
*   一个不错的图形用户界面：

![截屏](https://i.stack.imgur.com/jH9Pd.png)

它适用于从 JDK 1.1.8 到 JDK 1.7.0 以及其他编译器（[Jikes](https://en.wikipedia.org/wiki/Jikes)、[JRockit](https://en.wikipedia.org/wiki/JRockit)等）。

它具有实际上功能齐全的在线[现场演示版本！](http://jd.benow.ca/#jd-online)您可以在页面上放置一个 jar 文件并查看反编译的源代码，而无需安装任何东西。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2008-11-07T16:03:59.403

那里有一些反编译器......快速搜索产生：

1.  [Procyon](https://bitbucket.org/mstrobel/procyon)：开源（Apache 2）并积极开发
2.  [Krakatau](https://github.com/Storyyeller/Krakatau)：开源（GPLv3）并积极开发
3.  [CFR](http://www.benf.org/other/cfr/) : 开源 (MIT) 并积极开发
4.  [贾德](http://varaneckas.com/jad/)
5.  [DJ Java 反编译器](http://www.neshkov.com/)
6.  [摩卡](http://www.brouhaha.com/~eric/software/mocha/)

还有很多。

这些生成 Java 代码。Java 附带了一些可以让您查看 JVM 字节码 ( [javap](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javap.html) ) 的东西。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2008-11-07T16:03:51.650

要查看 Java 源代码，请检查一些反编译器。去搜索**jad**。

如果您想查看字节码，只需使用JDK 附带的**javap 。**

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2013-10-02T19:00:30.453

我尝试了几个，[南河四](https://bitbucket.org/mstrobel/procyon/wiki/Java%20Decompiler)似乎最适合我。它正在积极开发中，并支持最新版本的 Java 的许多功能。

这些是我尝试过的其他人：

*   [病死率](http://www.benf.org/other/cfr/)
    *   有希望，但经常失败的方法反编译。我会一直关注这个。还积极开发支持最新的 Java 功能。
*   [喀拉喀托](https://github.com/Storyyeller/Krakatau)
    *   采用不同的方法，它尝试输出等效的 Java 代码，而不是尝试重建原始源代码，这有可能使其更好地用于混淆代码。根据我的测试，它与 Procyon 大致相当，但有一些不同的东西仍然很好。我确实必须使用`-skip`命令行标志，这样它就不会因错误而停止。积极开发，有趣的是它是用 Python 编写的。
*   [京东图形界面](http://jd.benow.ca/)
    *   有效，但南河四的输出要好得多。这是一个[将 Procyon 输出与原始输出和 JD-GUI 进行比较的页面](https://bitbucket.org/mstrobel/procyon/wiki/Decompiler%20Output%20Comparison)。JD-GUI 也可作为[Eclipse 插件使用](http://jd.benow.ca/#jd-eclipse)，这对我来说根本不起作用。似乎不是开源的，开发似乎是零星的。
*   [贾德](http://varaneckas.com/jad/)
    *   工作，但只支持 Java 1.4 及以下。也可作为[Eclipse 插件使用](http://jadclipse.sourceforge.net/)。不再在开发中。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-11-07T16:07:09.833

我使用[JAD 反编译器](http://www.javadecompilers.com/jad)。

它有一个[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)插件，[jadeclipse](http://sourceforge.net/projects/jadclipse/)。这很不错。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-06-10T14:02:51.750

**[Procyon](https://bitbucket.org/mstrobel/procyon)**包含一个反编译器。它是自由和开源软件。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2009-09-18T23:53:09.317

[**Soot**](http://www.sable.mcgill.ca/soot/)是较新 Java 代码的一个选项。至少它还有最近还在维护的优势……

此外，[**Java Decompiler**](http://java.decompiler.free.fr/)是一个具有独立 GUI 和 Eclipse 集成的反编译器。

最后，没有提到[**Jdec**](http://jdec.sourceforge.net/)，尽管它不像其他选项那样完善。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2011-07-01T09:33:33.300

[JD-GUI](http://jd.benow.ca/)真的很不错。您可以只打开一个[JAR](http://en.wikipedia.org/wiki/JAR_%28file_format%29)文件并浏览代码，就好像您正在使用 IDE 一样。好东西。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2015-03-07T00:06:35.967

以下是截至 2015 年 2 月的反编译器列表：

**Procyon**，开源，[https://bitbucket.org/mstrobel/procyon/wiki/Java%20Decompiler](https://bitbucket.org/mstrobel/procyon/wiki/Java%20Decompiler)

**CFR**，免费，没有可用的源代码， [http://www.benf.org/other/cfr/](http://www.benf.org/other/cfr/)

**京东**，免费用于非商业用途，[http://jd.benow.ca/](http://jd.benow.ca/)

**Fernflower**，开源，[https://github.com/fesh0r/fernflower](https://github.com/fesh0r/fernflower)，

**JAD** - 仅出于历史原因在此给出。免费，没有可用的源代码， http: [//varaneckas.com/jad/](http://varaneckas.com/jad/) 已过时、不受支持且无法正确反编译 Java 5 及更高版本。

您可以在线测试上述反编译器，无需安装，并做出自己的明智选择。

**云中的 Java 反编译器：** [http ://www.javadecompilers.com/](http://www.javadecompilers.com/)

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-11-07T16:04:02.540

您可以使用一些程序。您将获得实际的 Java 代码，但有时代码会被混淆，因此方法由一个字母或数字或字母和数字的随机组合命名。

[DJ 反编译器](http://www.neshkov.com/) [Mocha](http://www.brouhaha.com/~eric/software/mocha/)

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-11-07T16:18:26.253

Java 的大多数反编译器都是基于[JAD](http://www.kpdus.com/jad.html)的。这是一个很棒的工具，但不幸的是有一段时间没有更新，并且不能很好地处理 Java 1.5+ 类。我还没有看到任何可以正确处理 1.5+ 类的工具。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-11-07T16:02:55.710

看看[cavaj](http://www.bysoft.se/sureshot/cavaj/)。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2012-04-04T03:11:15.070

到目前为止列出的所有 JAD 链接似乎都已损坏，所以我找到了这个站点。效果很好（至少对于 Linux）！在 Ubuntu 11.10 上，无论出于何种原因，我都必须下载静态版本。

[http://www.varaneckas.com/jad](http://www.varaneckas.com/jad)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2011-03-13T05:41:45.493

*   JAD 是一种有效且简单的方法。

*   另外，如果您只想查看方法，请使用 javap。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2012-11-30T03:13:59.493

如果你想看看 Java 编译器是如何做某些事情的，你不想反编译，你想反汇编。反编译涉及将字节码转换为 Java 源代码，这意味着丢失了大量低级信息，如果您想了解编译器优化，这可能正是您感兴趣的信息。

不管怎样，我碰巧写了一个[开源的 Java 反汇编器](https://github.com/Storyyeller/Krakatau)。与 Javap 不同，这甚至适用于高度病态的类，因此您也可以看到混淆工具对您的类做了什么。它也可以进行反编译，但我不推荐它。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2013-06-25T17:52:07.810

JAD 对我不起作用（Ubuntu 11.10 问题），所以我继续前进并使用[JODO](http://jode.sourceforge.net/)。至少它有 Open Java 源代码并且能够正确地反编译我的*.class*。

我建议先检查*“分支/通用”*分支。树干不稳定。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2015-08-04T09:04:41.810

在 IntelliJ IDEA 平台上，您可以使用[Java Decompiler IntelliJ Plugin](https://plugins.jetbrains.com/plugin/7100)。它允许您在调试过程中显示所有 Java 源代码，即使您没有全部。它基于著名的工具[JD-GUI](http://jd.benow.ca/)。

[![在此处输入图像描述](https://i.stack.imgur.com/gCLny.png)](https://i.stack.imgur.com/gCLny.png)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-06-18T16:54:54.197

对于 OSX，我推荐：jarzilla 或 JD-GUI

它们都允许您查看 jar、war 等。文件内容并反编译其中的任何类文件。

Jarzilla：[https](https://code.google.com/p/jarzilla/)
://code.google.com/p/jarzilla/ JD-GUI：http: [//jd.benow.ca/](http://jd.benow.ca/)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-08-04T08:22:30.387

使用[AndroChef Java Decompiler](http://www.neshkov.com/ac_decompiler.html)，您可以反编译 apk、dex、jar 和 java 类文件。这很简单。AndroChef JD 基于[FernFlower](https://github.com/fesh0r/fernflower)。您可以在 10 次免费使用中对其进行评估。

> AndroChef 支持 Java 语言特性，如泛型、枚举和注释。根据一些研究，AndroChef Java Decompiler 能够反编译使用传统 Java 编译器生成的 98.04% 的 Java 应用程序——恢复率非常高。它是一个简单但功能强大的工具，可让您将 Java 和 Dalvik 字节码（DEX、APK）反编译为可读的 Java 源代码。

# asp.net - 身份验证/授权是否会阻止 Jquery 调用页面方法？

> ID：272536
> 
> 赞同：0
> 
> 时间：2008-11-07T16:00:09.910
> 
> 标签：asp.net, jquery, vb.net

我有以下在 C#/Asp.net 2.0 中完美运行的 JQuery 代码，可以在 default.aspx 页面中调用页面方法。现在我试图在 VB.Net 中调用共享页面方法并且页面方法没有触发，我相信是因为安全性或者它没有找到它。

此共享 vb 方法所在的页面不允许匿名访问，所以我认为这是问题所在，或者是查找该方法的路径问题。我只是在这里猜测。在我的 C# 测试应用程序中，静态 webmethod 位于 default.aspx 页面中，没有安全性。感谢您的任何建议或帮助！

```
$.ajax({
                type: "POST",
                url: "Orders.aspx/GetMailPieceGroupsByAdFundTypeId",
                data: myDataToSend,
                contentType: "application/json; charset=utf-8",
                dataType: "json", 
                //error: function(XMLHttpRequest, textStatus, errorThrown) {alert(errorThrown); this;},
                success: function(data, textStatus){alert(success);mailPieceGroups = eval('(' + data + ')'); startSlideShow(mailPieceGroups); }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T22:25:45.810

我的问题是提供的路径不正确，导致 .ajax 调用无法找到调用它的方法。这对我的场景是正确的：

url: "../Orders.aspx/GetMailPieceGroupsByAdFundTypeId",

# windows-xp - 远程桌面上的 Direct3D

> ID：272537
> 
> 赞同：6
> 
> 时间：2008-11-07T16:00:18.677
> 
> 标签：windows-xp, remote-desktop, direct3d

如何让 Direct3D 通过远程桌面连接工作？我正在使用 Windows XP 专业版。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T16:13:21.040

3D 加速不适用于远程桌面或虚拟 PC/服务器。软件渲染的 OpenGL 适用于远程桌面和虚拟 PC/服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-04T20:44:05.687

实际上，您可以通过两种不同的方式在远程桌面上使用 D3D9。我已经完成并测试了两者。

（这运行速度很快）最好的方法是使用 SwiftShader，一个 D3D9 的软件实现。这应该以任何颜色位运行。[https://opensource.google/projects/swiftshader](https://opensource.google/projects/swiftshader)

（注意：这很慢） 第二个是在远程计算机上安装 DirectX SDK。您的应用程序必须创建一个 D3D9 参考设备并且远程计算机必须设置为 16 位颜色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:06:38.040

也许您已经知道这一点，但看起来这不是受支持的场景。

请参阅 [远程桌面共享禁用 Direct3D 功能](http://web.archive.org/web/20120428201450/http://support.microsoft.com/kb/260565) 和 [要求在 Windows 中拥有一个好的图像显示 API 是否太过分？](http://www.virtualdub.org/blog/pivot/entry.php?id=146)

如果您有选择，您可能想查看 WPF。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-14T16:15:11.060

如果我*首先*在本地机器上启动 3D 程序，它对我有用，然后我使用远程桌面获取会话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-28T04:08:20.067

如果你喜欢 OpenGL，你可以为此目的使用[VirtualGL 。](http://en.wikipedia.org/wiki/VirtualGL)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T16:13:48.103

根据这篇文章 Direct3D 是可能的（但狗慢）当你远程进入的盒子运行 Vista 时。

[http://www.virtualdub.org/blog/pivot/entry.php?id=208](http://www.virtualdub.org/blog/pivot/entry.php?id=208)

我尚未对此进行验证，也无法亲自保证它是否真的有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T00:47:59.767

除了 Tim 的回答之外，在 PDC 的 WPF Futures 演讲中，D3D 团队的一名成员提到 Windows 7 下的 D3D 10 将与远程处理一起工作，并将通过原语进行远程处理（这让我相信执行远程处理的客户端将处理渲染）。他们没有提供太多信息，但在 WPF Futures talk (PC07) 的 Q&A 部分中有所涉及，您可以在 microsoftpdc.com 上查看。

不能解决 XP 中的 D3D9 问题，但在 Windows 7 下使用 D3D10 的远程桌面听起来要好一些。:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-14T12:06:12.917

我已经对此进行了测试，如果服务器运行 Vista，它确实可以工作。

# javascript - 是否可以在不完全禁用 JavaScript 的情况下禁用 AJAX？

> ID：272541
> 
> 赞同：11
> 
> 时间：2008-11-07T16:02:00.063
> 
> 标签：javascript, ajax

是否可以在不完全禁用 JavaScript 的情况下禁用 AJAX？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-07T16:15:22.983

如果您使用的是 Firefox，则可以使用 GreaseMonkey 完成此操作。( [https://addons.mozilla.org/en-US/firefox/addon/748](https://addons.mozilla.org/en-US/firefox/addon/748) )

GM 是一个框架，用于将脚本应用于您访问的部分或全部页面。我有禁用 google-analytics 下载的 GM 脚本（因为它们会减慢速度），并且禁用 google-click-tracking 在 google 结果页面上（因为他们这样做让我很困扰）。

这是我的谷歌点击禁用脚本：

```
// ==UserScript==
// @name           Google Clk
// @namespace      googleclk
// @description    Disable Google click tracking
// @include        http://*google.com/*
// ==/UserScript==
// Override google's clk() function, which reports all clicks back to google
unsafeWindow.clk = function(url) {} // { alert(url); } // I use this to test. 
```

通过对 XMLHttpRequest（和其他函数）执行类似的操作，您可以有效地禁用它们。当然，您可能会通过这样做完全破坏页面，但您已经知道这一点。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-07T16:25:25.320

您可以用自己的浏览器工具替换浏览器工具来制作 AJAX（XMLHttpRequest 对象），而无需执行任何操作。

```
XMLHttpRequest = function(){}
XMLHttpRequest.prototype = {
    open: function(){},
    send: function(){}
} 
```

确保您的替换代码在任何 AJAX 调用之前执行。

这适用于任何通过 XMLHttpRequest 对象实现 AJAX 的浏览器，但不适用于 IE。对于 IE，如果可能，您可能必须重载 CreateObject() 函数...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-08-18T16:39:50.770

在 IE 中，这可以通过以下方式完成：工具 -> Internet 选项 -> 高级选项卡 -> 向下滚动到安全 -> 取消选中“启用本机 XMLHTTP 支持”。

[http://msdn.microsoft.com/en-us/library/ms537505%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms537505%28v=vs.85%29.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-07T16:06:26.357

AJAX 只是 Javascript 中 XMLHttpRequest 函数的使用。根据您的浏览器，您可以通过安全设置锁定对此功能的访问。至少对于 Firefox，您可以通过使用自定义扩展来禁用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-06T06:39:02.430

这是对已经回答的问题的迟到评论，但为了来自谷歌的人们的利益：

使用 Firefox 的[选项卡权限](https://addons.mozilla.org/en-US/firefox/addon/4757)扩展，您可以使用右键单击上下文菜单禁用特定选项卡（而不是全局所有选项卡）的 JavaScript。我将“权限”菜单项配置为切换“重定向”和“JavaScript”，所以如果我偶然发现一个有烦人的刷新和 AJAX 的页面，我可以快速轻松地关闭行为不端选项卡的带宽活动，而不会影响 JavaScript在我的其他打开的标签上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T16:55:17.367

除了 Firefox 建议之外，您还可以在 IE 中执行此操作作为禁用 ActiveX 的副作用。同样在 IE7+ 上，您必须禁用“Native XMLHttpRequest”选项。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-11-07T16:19:28.453

只不过您可以禁用任何其他功能 - 可能会发现一些可能干扰或破坏 javascript 的 kludges 或 hack，但我们希望不要发现此类漏洞。

我会在黑暗中猛烈抨击并猜测您正试图阻止 Ajax 在某种不受信任的用户输入中？在这种情况下，您最好的选择是通过提及 Ajax 来避免过度指定您的搜索参数，而是搜索“sanitize javascript”、“user javascript safe”……之类的东西。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-11-07T16:05:33.630

不，AJAX 只是 javascript 的一种特殊用途。

如果您可以阻止特定函数调用回服务器，您也许可以这样做，但您可能必须编辑您的浏览器。

我假设您想从客户端执行此操作...您能列出一些更具体的目标吗？预期的结果是什么？

# asp.net - 如何创建一个看起来很酷的照片库

> ID：272543
> 
> 赞同：2
> 
> 时间：2008-11-07T16:02:25.397
> 
> 标签：asp.net

我怎样才能获得一个看起来很酷的照片库页面？我不知道 Flash，但可以学习并想到一个随机拼贴画，它可以“拉出”一张你悬停在上面的照片。

这是给摄影师的，所以没有缩略图、网格等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T16:06:32.940

如果您正在寻找一种非常灵活且稍后会支持自身的工具，因为您可以培训用户使用它，请查看[JAlbum](http://jalbum.net/)。

要自己进行集成，您可以查看[AJAX ASP Photo Gallery或类似](http://www.aspphotogallery.net/)[的](http://www.codeproject.com/KB/applications/Nileblitz_Photo_Gallery.aspx)东西。

如果您正在寻找一种基于 flash/flex 的解决方案，他们可以将其作为独立产品“插入”，其中包含您所描述的一些功能[StudioCloud](http://studiocloud.com/OnlineGallery.html)有一个不错的按月收费的产品......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T16:14:29.350

我使用 jQuery 的 Galleria 插件取得了不错的效果：http: [//devkick.com/lab/galleria/](http://devkick.com/lab/galleria/)。

它将需要一个 html 页面作为源，但这相对容易使用 ASP.NET 从数据库或目录结构自动生成

如果数据不需要经常更新，您甚至可以在紧要关头手动生成 HTML。虽然它不容易维护，但它并不难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T03:09:21.657

我同意 Mat - [JAlbum](http://jalbum.net/)非常出色 - 但我还想补充一点，它与[BananAlbum](http://www.bananalbum.com/)皮肤一起使用会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T16:15:37.337

有几十个现成的应用程序可用。图库、Wordpress（配置后）和一些基于 ASP.Net 的。Flash当然不是必需的。

也就是说，为了了解一些关于 Pylons 的知识，我写了自己的[基本照片博客](http://photo.krazyyak.com)。如果您可以进行基本的 CRUD 开发，那应该不会太难。

关于您的拼贴创意，您也可以使用 JavaScript 来实现。有关类似效果的内容，请参阅[本文](http://nettuts.com/javascript-ajax/leopard-desktop-in-jquery-using-jqdock/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-08T15:15:27.397

有点随机，但 Silverlight 深度缩放功能在该区域非常酷（尽管为此是否值得学习是另一回事）：

此处示例：http: [//memorabilia.hardrock.com/](http://memorabilia.hardrock.com/)

# ios - 在 iPhone 上查找用户的 Documents 目录的最佳方法是什么？

> ID：272544
> 
> 赞同：63
> 
> 时间：2008-11-07T16:02:39.953
> 
> 标签：ios, objective-c, iphone, cocoa-touch

我正在阅读 Erica Sadun 的*iPhone Developer's Cookbook*，遇到了一个问题。

她在书中说，找到用户的 Documents 目录的方法是使用代码：

```
[NSHomeDirectory() stringByAppendingPathComponent:@"Documents"]; 
```

但这似乎有点脆弱，并且与正常的 Mac 方式不同，这将是：

```
NSSearchPathForDirectoriesInDomains(NSDocumentsDirectory, NSUserDomainMask, YES); 
```

有什么特别的理由可以使用其中一个吗？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2008-11-07T16:48:34.807

对象：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) 
```

迅速：

```
var paths = NSSearchPathForDirectoriesInDomains(NSSearchPathDirectory.DocumentDirectory, NSSearchPathDomainMask.UserDomainMask, true) 
```

您需要返回数组的第一个元素。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-12-06T23:37:23.683

这是我在我的框架中使用的代码。

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0]; 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-10-11T23:34:22.393

### 您应该考虑使用返回 URL 的 FileManager 方法，这是首选格式。

```
let documentsURL = FileManager.default.urls(for: .documentDirectory, in: .userDomainMask).first 
```

此方法旨在定位系统中已知和常见的目录。

标识请求目录的 URL 对象数组。目录按照域掩码常量的顺序排列，用户域中的项目在前，系统域中的项目在后。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-17T03:25:50.113

我用这个

```
NSString *documentPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
NSString *zipLocalPath = [documentPath stringByAppendingString:fileName]; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-09-09T11:52:23.683

在 swift v3 中，我使用了以下代码段

```
var paths = NSSearchPathForDirectoriesInDomains(FileManager.SearchPathDirectory.documentDirectory, FileManager.SearchPathDomainMask.userDomainMask, true) 
```

# macos - macOS 中的电池状态 API？

> ID：272552
> 
> 赞同：32
> 
> 时间：2008-11-07T16:04:17.080
> 
> 标签：macos, battery

如何从我自己的应用程序中读取 MacBookPro 上的电池状态？

到目前为止，谷歌搜索只显示了设备驱动程序处理电源事件的 API——没有关于用户级进程访问这些信息的任何内容。

谢谢。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-06-22T03:14:56.097

如果您正在寻找一种从命令行快速查询它的方法，您会发现 pmset 命令很有帮助。要查询电池状态，具体来说，使用：

```
$ pmset -g 电池

```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-11-07T17:09:05.077

您需要为此使用 IOKit，特别是[IOPowerSources 函数](https://developer.apple.com/documentation/iokit/iopowersources.h)。您可以使用`IOPSCopyPowerSourcesInfo()`获取 blob，`IOPSCopyPowerSourcesList()`然后从中提取 CFArray，列出电源。然后使用`IOPSGetPowerSourceDescription()`拉出一个字典（字典的内容见[IOPSKeys.h](https://developer.apple.com/documentation/iokit/iopskeys.h)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-19T21:28:33.893

也许有助于将文本提取到脚本应用程序中

```
pmset -g batt | head -n 1 | cut -c19- | rev | cut -c 2- | rev 
```

输出

```
Battery Power
AC Power 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-11-07T17:10:49.457

查看系统管理控制器。我手边没有我的 MBP，但我相信你需要看看 smc.h

# flash - 有哪些资源可用于优化 ActionScript (flash) 的速度和大小

> ID：272556
> 
> 赞同：1
> 
> 时间：2008-11-07T16:05:31.397
> 
> 标签：flash, actionscript-3, performance

我对内存分析、减小已编译 .swf 的大小、测量网络延迟等特别感兴趣。此外，我完全专注于 AS3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T19:03:48.793

最新的[Flex Builder Professional](http://www.adobe.com/products/flex/features/flex_builder/)包括内置的内存和性能分析器：

***强大的测试工具（Flex Builder 3 中的新功能）（仅限专业版）***

*Flex Builder 3 内存和性能分析器使开发人员能够通过提供监控和分析内存消耗和 CPU 周期的工具来提高应用程序性能。Flex Builder 3 Professional 现在还支持自动功能测试工具，例如 HP QuickTest Professional（以前称为 Mercury QuickTest Professional）。*

它不包括网络延迟——我还没有听说过内置工具可以做这样的事情——[数据包嗅探器](http://www.wireshark.org/)是否适合你的需求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T18:58:36.680

FlexBuilder Pro 绝对是一个不错的选择。正在下载试用版...

这篇文章看起来也很有用：

[http://flexblog.edchipman.ca/?p=7](http://flexblog.edchipman.ca/?p=7)

我实际上并不关心测量网络延迟，但我关心的是测量我的应用程序的哪些部分由于延迟而变慢，哪些部分由于愚蠢的 AS3 而变慢。

# plugins - 如何为 Adob e Lightroom 重写 Adob e Photoshop 插件？

> ID：272575
> 
> 赞同：2
> 
> 时间：2008-11-07T16:11:07.970
> 
> 标签：plugins, adobe, photoshop, lightroom

Adobe 的 Photoshop 和 Lightroom 插件架构是否有任何关联？如果我有适用于 PS 3.0-CS3 和 PS Elements 6.0 的插件的源代码，我可以直接将它与 Lightroom 一起使用吗？如果没有，我需要修改什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T16:26:46.177

不，lightroom 插件是用脚本语言 lua 编写的，photoshop 插件是用 C++ 编写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T16:35:19.090

正如 kasperjj 所指出的，Lightroom 插件是用 Lua 编写的，因此没有直接的方法可以将某些东西从 Photoshop 转换为 Lightroom。此外，根据[Adob​​e Lightroom 开发人员中心](http://www.adobe.com/devnet/photoshoplightroom/)，当前 SDK 中唯一可扩展的功能是导出功能、元数据和 Web 引擎功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T07:11:04.427

正如 Rob 所指出的，Lightroom SDK 不公开任何允许操作图像文件本身的接口。部分原因是 Lightroom 是一个非破坏性的编辑器。在其“开发”模块中所做的任何编辑都不会应用于原始图像文件；它们应用于导出、打印或在 Web 画廊中使用图像时生成的文件。

也就是说，有一些导出插件可以在Lightroom 完成应用调整*后操作图像。*原则上，可以创建一个加载 Photoshop 插件并在 Lightroom 导出期间应用它的主机应用程序。甚至可以将 Photoshop 本身用作主机应用程序...

# delphi - 在 TFS MSBuild 下运行 Delphi 构建

> ID：272577
> 
> 赞同：4
> 
> 时间：2008-11-07T16:11:56.313
> 
> 标签：delphi, msbuild, build-automation

想要构建和测试一堆与 ASP.NET 服务集成的 Borland Delphi 6 项目。一直在使用 WANT 和 CruiseControl 来构建 Delphi。使用 TFS Build 代理，我们可以将所有内容捆绑在一起并进行一些测试。我正在寻找指导和方向。

我看到的一个问题是，在 Delphi 项目中没有“解决方案”作为“<'SolutionToBuild'>' 提供给 MSBuild。

```
<SolutionToBuild Include="There is no such thing as a Delphi.sln">
    <Targets></Targets>
    <Properties></Properties>
</SolutionToBuild> 
```

另外，我有对`<UsingTask`> 的引用，但我有点不确定如何使用它们。`<UsingTask`> 允许为 Delphi 命令行编译运行自定义任务。

您的指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T17:06:21.493

可以升级吗？Delphi 2006+ 默认使用 MSBuild。没有什么可配置的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T16:17:14.527

您可以使用 MSBuild 来运行 Delphi 命令行编译器。已经有一段时间了，但我很确定 IDE 是否支持命令行编译，或者有一个可以从命令行运行的独立编译器。在任何一种情况下，您都需要创建一个`<Exec`> 任务，该任务使用所需的参数运行适当的命令行构建工具。

当您说您有“对`<UsingTask`> 的引用”时，您的意思是您正在导入外部 MSBuild 任务吗？> 元素用于拉`<UsingTask`入驻留在外部程序集 (DLL) 中的自定义 MSBuild 任务。导入任务后，您可以像使用任何其他内置任务一样使用它。

# iphone - 有没有更好的方法来确定 UITableViewCell 的正确大小？

> ID：272584
> 
> 赞同：9
> 
> 时间：2008-11-07T16:14:27.777
> 
> 标签：iphone, cocoa-touch, uitableview

我有一个 UITableView 单元格，它将根据其内容（可能是几行文本）具有可变大小。

*因为在我布局单元格之前*似乎调用了 heightForRowAtIndexPath ，我只是通过在我的文本字符串上调用 [NSString sizeWithFont] 来猜测正确的高度。在我在单元格中布置文本并知道它应该是什么大小*之后*，有没有更好的方法来设置高度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-07T18:05:55.553

这听起来很愚蠢，但是......呃......“在你退出 heightForRowAtIndexPath 之前布局你的单元格”;）

不过说真的——操作系统只在需要时才调用它（例如：它即将创建单元格并将其显示在屏幕上），因此将其布置并准备好显示不会浪费精力。

请注意，您不必**在**逻辑上单独进行布局。只需在 heightForRowAtIndexPath 例程中调用 [self prepLayoutForCellAtIndex:index] 即可。

如果数据是静态的，您可以创建一个高度表并缓存信息。

```
if (0 == heightTable[index]) {
    heightTable[index] = [self prepLayoutForCellAtIndex:index];
}
return (heightTable[index]); 
```

哎呀，即使数据发生变化，您也可以在更改数据的方法中重新计算表值，或者清除为 0，以便下次需要时重新计算。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T18:19:47.460

我通常使用以下内容：

```
- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath: (NSIndexPath *) indexPath {
UITableViewCell *cell = [self tableView: tableView cellForRowAtIndexPath: indexPath];
return cell.bounds.size.height; 
```

}

请注意，我将它用于预先缓存一堆行的表，而不是用于具有大量单元格的表。但是，对于像设置表这样只有几行但很可能大小不同的东西，它运行良好。对于较大的桌子，我会按照 Olie 的建议做一些事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T20:00:36.773

如果您以 SMS.app 为例，Apple 会将单元格的行高保存在 SMS.app sqlite 数据库中。

# .net - 在 System.AddIn 中托管 WPF 时出现 NullReferenceException

> ID：272590
> 
> 赞同：3
> 
> 时间：2008-11-07T16:16:12.907
> 
> 标签：.net, wpf, exception, add-in

我们正在开发一个 WPF 应用程序，该应用程序使用 System.AddIn 框架来托管显示其他 WPF 内容的加载项。一切似乎都运行良好，但一夜之间，应用程序抛出了以下 NullReferenceException：

```
消息：错误：对象引用未设置为对象的实例。
StackTrace：在 System.Windows.Interop.HwndSource.CriticalTranslateAccelerator（MSG 和 msg，ModifierKeys 修饰符）
   在 System.AddIn.Pipeline.AddInHwndSourceWrapper.TranslateAccelerator（MSG 味精，ModifierKeys 修饰符）
   在 MS.Internal.Controls.AddInHost.System.Windows.Interop.IKeyboardInputSink.TranslateAccelerator（MSG& 味精，ModifierKeys 修饰符）
   在 System.Windows.Interop.HwndHost.OnKeyUp（KeyEventArgs e）
   在 System.Windows.UIElement.OnKeyUpThunk（对象发送者，KeyEventArgs e）
   在 System.Windows.Input.KeyEventArgs.InvokeEventHandler（委托 genericHandler，对象 genericTarget）
   在 System.Windows.RoutedEventArgs.InvokeHandler（委托处理程序，对象目标）
   在 System.Windows.RoutedEventHandlerInfo.InvokeHandler（对象目标，RoutedEventArgs routedEventArgs）
   在 System.Windows.EventRoute.InvokeHandlersImpl（对象源，RoutedEventArgs args，布尔 reRaised）
   在 System.Windows.UIElement.RaiseEventImpl（RoutedEventArgs 参数）
   在 System.Windows.UIElement.RaiseEvent（RoutedEventArgs 参数，布尔值信任）
   在 System.Windows.Input.InputManager.ProcessStagingArea()
   在 System.Windows.Input.InputManager.ProcessInput（InputEventArgs 输入）
   在 System.Windows.Input.InputProviderSite.ReportInput（InputReport inputReport）
   在 System.Windows.Interop.HwndKeyboardInputProvider.ReportInput（IntPtr hwnd，InputMode 模式，Int32 时间戳，RawKeyboardActions 操作，Int32 扫描代码，布尔 isExtendedKey，布尔 isSystemKey，Int32 虚拟键）
   在 System.Windows.Interop.HwndKeyboardInputProvider.ProcessKeyAction（味精和味精，布尔值&处理）
   在 System.Windows.Interop.HwndSource.CriticalTranslateAccelerator（味精和味精，ModifierKeys 修饰符）
   在 System.Windows.Interop.HwndSource.OnPreprocessMessage（对象参数）
   在 System.Windows.Threading.ExceptionWrapper.InternalRealCall（委托回调，对象参数，布尔 isSingleParameter）
   在 System.Windows.Threading.ExceptionWrapper.TryCatchWhen（对象源，委托回调，对象 args，布尔 isSingleParameter，委托 catchHandler）
   在 System.Windows.Threading.Dispatcher.InvokeImpl（DispatcherPriority 优先级，TimeSpan 超时，委托方法，对象参数，布尔 isSingleParameter）
   在 System.Windows.Threading.Dispatcher.Invoke（DispatcherPriority 优先级，委托方法，对象 arg）
   在 System.Windows.Interop.HwndSource.OnPreprocessMessageThunk（味精和味精，布尔值&处理）
   在 System.Windows.Interop.HwndSource.WeakEventPreprocessMessage.OnPreprocessMessage（MSG& 味精，布尔值& 处理）
   在 System.Windows.Interop.ThreadMessageEventHandler.Invoke（MSG&味精，布尔&处理）
   在 System.Windows.Interop.ComponentDispatcherThread.RaiseThreadMessage（味精和味精）
   在 System.Windows.Threading.Dispatcher.PushFrameImpl（DispatcherFrame 框架）
   在 System.Windows.Threading.Dispatcher.PushFrame（DispatcherFrame 框架）
   在 System.Windows.Threading.Dispatcher.Run()
   在 System.Windows.Application.RunInternal（窗口窗口）
   在 System.Windows.Application.Run（窗口窗口）
   在 System.Windows.Application.Run()

```

正如你所看到的，我们的代码都没有在堆栈跟踪中，所以我没有地方修复任何东西。有人对可能的解决方法有任何想法吗？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T05:14:28.883

我相信您需要查看的第一件事是更改 Visual Studio 中的设置。我对此有很多问题，不得不手动告诉 Visual Studio 打破那个 NullReferenceException。进行此调整后，IDE 实际上会抛出错误，您可以调试代码。从 VS 2008 帮助：

在引发异常时中断执行 在“调试”菜单上，单击“异常”。

在“异常”对话框中，为整个异常类别选择“引发”，例如，公共语言运行时异常。

-或者-

展开异常类别的节点，例如公共语言运行时异常，然后为该类别中的特定异常选择抛出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T22:02:56.713

此外，Steve Massing 的上述回答可能有助于禁用“仅我的代码”选项，启用“启用源服务器支持”选项并设置调试符号以闯入和调试框架代码，

这比听起来容易，请按照以下 3 步说明进行操作

红线未选中，绿线选中并设置符号如下

[![替代文字](https://i.stack.imgur.com/pVuNH.gif)](https://i.stack.imgur.com/pVuNH.gif)
[（来源：[gangleri.net](http://www.gangleri.net/content/binary/debugOptions1.gif)）][（来源：][[gangleri.net](http://www.gangleri.net/content/binary/debugOptions2.gif)][）]
[![替代文字](https://i.stack.imgur.com/0K1xF.gif)](https://i.stack.imgur.com/0K1xF.gif)

# c# - 如何在 NHibernate 中使用子对象字段作为复合键的一部分

> ID：272602
> 
> 赞同：2
> 
> 时间：2008-11-07T16:21:54.873
> 
> 标签：c#, nhibernate

我需要在我的用户实体上创建一个新的多对一关系，该实体与另一个实体连接。问题是另一个实体有一个复合键，其中一个字段是用户实体中的字段，另一个是另一个多对一实体中的字段。

User.Key -> User.NewThing.Key

User.SubThing.Key -> User.NewThing.Key

下面是我理想情况下想要使用的无效映射文件，其中 JeanieUserTyped 是我的新事物，ApplicationId 是来自 ShortCode.ApplicationId 的有问题的键。

问题是如何告诉它映射复合键的应用程序部分？

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="JeanieMaster.Domain.Entities" assembly="JeanieMaster.Domain">
    <class name="JeanieUser" table="DBSVR1.Jeanie_Master.dbo.JeanieUser" select-before-update="false" optimistic-lock="none">
        <id name="Id" column="UserId" type="Int32">
            <generator class="identity"/>
        </id>

        <property name="Mobile" type="String"/>
        <property name="UniqueReoccurBillingRefId" type="String"/>
        <property name="DateJoined" type="DateTime"/>
        <property name="IsActive" type="Boolean"/>

        <many-to-one name="MobileNetwork" class="MobileNetwork" column="MobileNetworkId" />
        <many-to-one name="ShortCode" class="ShortCode" column="ShortCodeId" />
        <many-to-one name="MobileHandset" class="MobileHandset" column="HandsetId" />

        <many-to-one name="JeanieUserTyped" class="JeanieUserTyped">
            <column name="Mobile" />
            <column name="ApplicationId" />
        </many-to-one>

    </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T09:27:45.210

你能提供更多细节吗，听起来你有3个实体，

用户子事物新事物

NewThing 在哪里解决了 User 和 SubThing 的多对多问题——我关闭了吗？

也许是这样的：

```
User         -<  SubThing
 |                   | 
 /\                  /\
        NewThing 
```

我不认为[nhibernate 中的复合键是相关的？](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/mapping.html#mapping-declaration-compositeid)

# c++ - 如何预先计算值数组？

> ID：272607
> 
> 赞同：2
> 
> 时间：2008-11-07T16:22:57.790
> 
> 标签：c++, templates

有没有办法根据模板预先计算一组值？在下面的示例中，如果可能的话，我希望 'powers_of_2' 数组在编译时计算 256 个值，而不必键入所有值。

```
#include <iostream>
using namespace std;

template <int X, char Y>
struct power {
   enum { value = X * power<X,Y-1>::value };
};

template <int X>
struct power<X,1> {
   enum { value = X };
};

template <int X>
struct power<X,0> {
   enum { value = 1 };
};

int _tmain(int argc, _TCHAR* argv[])
{
   int powers_of_2[] = { power<2,0>::value, power<2,1>::value, ..., power<2,255>::value };
   cout << powers_of_2[1] << endl;
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T16:30:10.660

除非您打算使用大整数包，否则整数类型将溢出 2^32（或 2^64，具体取决于），但要回答您的真正问题，请查看有关[模板元编程](http://en.wikipedia.org/wiki/Template_metaprogramming)的维基百科文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T16:55:39.767

保持值 2^255 需要 32 个字节。这不能保存在 int 中；你需要一个 char 数组

```
typedef unsigned char BYTE32[32];
BYTE32 powers_of_2[256] =
{
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0},
// :
// :
  {32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:27:00.747

这正是宏的用处......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-11T11:44:33.950

我在这种情况下所做的是编写一个小程序，该程序生成并将 C++ 源中的数组初始化写入文件，然后 #include 该文件。这种技术简单而有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T16:31:04.327

您可以使用您喜欢的脚本语言轻松编写一个小脚本来为您预填充数组。根据您使用的编译器和预处理器，您还应该能够将其作为宏来执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T19:33:43.897

我同意 Lokkju。仅通过模板元编程来初始化数组是不可能的，在这种情况下宏非常有用。甚至 Boost 库也使用宏来实现重复语句。

此处提供了有用的宏示例：http: [//awgn.antifork.org/codes++/macro_template.h](http://awgn.antifork.org/codes++/macro_template.h)

# matlab - 如何修改 Matlab 对象的属性

> ID：272618
> 
> 赞同：26
> 
> 时间：2008-11-07T16:27:48.980
> 
> 标签：matlab, properties, matlab-class

我创建了一个 MATLAB 类，例如：

```
classdef myclass

  properties
      x_array = [];
  end

  methods
    function increment(obj,value)
       obj.x_array = [obj.x_array ; value);
    end
  end
end 
```

问题是，当我调用该函数时，该属性`x_array`永远不会被修改`increment()`：例如：

```
>>s = myclass
>>increment(s,5)

>>s.x_array
ans = [] 
```

我做了一些研究，得出的结论是，这是因为 MATLAB 对对象使用了延迟复制，让我的类继承 HANDLE 类应该可以解决这个问题，但是没有，有人知道为什么会这样吗？如果扩展句柄类是独立的解决方案，这不是正确的方法吗：

```
classdef myclass < handle 
```

还是有任何额外的步骤？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-07T17:46:44.347

这类似于[这个问题](https://stackoverflow.com/questions/209005/object-oriented-matlab-properties)。简而言之，您所要做的就是从句柄类继承。

快速示例

文件 myclass.m 的内容

```
classdef myclass<handle
    properties
        x_array = []
    end
    methods
        function obj=increment(obj,val)
            obj.x_array=[obj.x_array val];
        end
    end
end 
```

现在在 Matlab 命令提示符下，您可以执行以下操作

```
>> s=myclass;
>> s.increment(5)
>> s.increment(6)
>> s

s = 

myclass handle

properties:
    x_array: [5 6]

lists of methods, events, superclasses 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-08T12:32:42.360

有一个更简单的方法。您只需要按`s`如下方式覆盖您的初始实例：

```
s = increment(s,5); 
```

[文档中的](https://www.mathworks.com/help/matlab/matlab_oop/matlab-vs-other-oo-languages.html)更多信息。

PS：虽然可以使用*handle*，但复制功能的工作方式不同，您应该注意使用它的方式。当您使用*handle*时，实际上您正在创建一个新地址/对 obj 的引用

# javascript - 如何使用 javascript 正确隐藏 XSL 处理的 XML 元素列表

> ID：272619
> 
> 赞同：2
> 
> 时间：2008-11-07T16:28:21.977
> 
> 标签：javascript, xslt

早上好。我有一个 XML 文件，其中包含来自构建输出的警告和错误列表。我已经成功地编写了 XSL 来遍历单独的警告和错误列表，让它们显示在我的浏览器中。我接下来要做的是添加一些 javascript 以添加链接/按钮，以便能够切换警告的显示。我无法让它正常工作。

这是相关代码（精简到我希望是必需品）

```
<xsl:template match="/">
    <xsl:variable name="messages" select="/cruisecontrol//buildresults//message" />
    <xsl:variable name="warning.messages" select="$messages[(contains(text), 'warning ')) or @level='Warning']" />
    <xsl:variable name="warning.messages.count" select="count($warning.messages)" />
    <xsl:if test="$warning.messages.count > 0">
        <script type="text/javascript">
            function toggleWarnings() {
                eDiv = document.getElementById("warnings");
                tDiv = document.getElementById("warningsTitle");
                if ( eDiv.style.display == "none" ) {
                    eDiv.style.display = "inline";
                    tDiv.innerText = "Hide Warnings";
                } else {
                    tDiv.innerText = "View Warnings";
                    eDiv.style.display = "none";
                }
            }
        </script>
        <table>
            <tr> <td>
                <a href="javascript:void()" onclick="javascript:toggleWarnings(); return false;">
                   <span id="warningsTitle">View Warnings</span>
                </a>
            </td> </tr>
            <xsl:for-each select="$warning.messages">
                <tr> <td class="warning" id="warnings" style="display: none;">
                    <xsl:value-of select="."/>
                </td> </tr>
            </xsl:for-each>
        </table> 
```

我遇到的问题是点击“查看警告”链接后只显示一个警告。我的问题是我知道足够多的 HTML、XSL 和 javascript 有点危险，而且组合证明我不够了解 :-)

有没有一种简单的方法来迭代 XSL 元素，然后在表格中显示，并且还能够在链接切换下隐藏所有这些元素？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T16:56:05.553

试一试 - 代码中包含注释。

```
<xsl:template match="/">
<xsl:variable name="messages" select="/cruisecontrol//buildresults//message" />
<xsl:variable name="warning.messages" select="$messages[(contains(text), 'warning ')) or @level='Warning']" />
<xsl:variable name="warning.messages.count" select="count($warning.messages)" />
<xsl:if test="$warning.messages.count > 0">
    <script type="text/javascript">
        function toggleWarnings()
        {
            // Get the table
            var table = document.getElementById("warnings");

            // Get all the rows in the table
            var rows = table.getElementsByTagName('tr');

            tDiv = document.getElementById("warningsTitle");

            if (tDiv.innerHTML == 'View Warnings')
            {
                for (var i = rows.length - 1; i >= 0; i--)
                {
                    // Skip any rows that aren't warnings
                    if (rows[i].className != 'warning')
                        continue;

                    try
                    {
                        // Try it the right way
                        rows[i].style.display = 'table-row';
                    }
                    catch (e)
                    {
                        // Try it the IE way
                        rows[i].style.display = 'block';
                    }

                tDiv.innerHTML = "Hide Warnings";
            }
            else
            {
                for (var i = rows.length - 1; i >= 0; i--)
                {
                    // Skip any rows that aren't warnings
                    if (rows[i].className != 'warning')
                        continue;

                    rows[i].style.display = 'none';
                }

                tDiv.innerHTML = "View Warnings";
            }

            return false;
        }
    </script>
    <!-- Moved the ID to the table - IDs must be unique! -->
    <table id="warnings">
        <tr>
            <td>
                <!-- This is must shorter, and "javascript:" inside onclick is plain wrong -->
                <a href="#" onclick="return toggleWarnings();">
                    <span id="warningsTitle">View Warnings</span>
                </a>
            </td>
        </tr>
        <xsl:for-each select="$warning.messages">
            <!-- Moved the class to the tr -->
            <tr class="warning" style="display: none;">
                <td>
                    <xsl:value-of select="."/>
                </td>
            </tr>
        </xsl:for-each>
    </table> 
```

# .net - 端点地址不为空时未找到 WCF javascript 代理

> ID：272620
> 
> 赞同：6
> 
> 时间：2008-11-07T16:29:43.347
> 
> 标签：.net, wcf, javascript-debugger

我正在尝试使用 enableWebScript 端点行为设置具有多个端点的 WCF 服务，其中一个端点使用 enableWebScript 端点行为，以便在客户端（jsdebug/js）上创建 Javascript 代理。

将服务引用添加到我的 AJAX ScriptManager 时，找不到 jsdebug 文件，除非端点的地址为空。ScriptManager 代理似乎总是生成“MyService.svc/jsdebug”的路径来查找文件，即使我的服务的地址是“ajax”。代理应将路径生成为“MyService.svc/ajax/jsdebug”。

是否有设置以正确的路径生成代理？我的服务是我网站的根。

作品：

```
<endpoint address="" 
  behaviorConfiguration="ajaxBehavior" 
  binding="webHttpBinding" 
  bindingConfiguration="webBinding" 
  contract="MyTest.Web.ICustomerService" /> 
```

想要这个（不起作用）：

```
<endpoint address="ajax" 
  behaviorConfiguration="ajaxBehavior" 
  binding="webHttpBinding" 
  bindingConfiguration="webBinding" 
  contract="MyTest.Web.ICustomerService" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T04:30:57.110

`<enableWebScript />`也称为支持 AJAX 的端点，本质上是对与地址有关的所有内容进行硬编码，因此您可以生成客户端代码。

它的硬编码方式是一切都与 .svc 文件直接相关。

请参阅[如何：使用配置添加 ASP.NET AJAX 端点](http://msdn.microsoft.com/en-us/library/bb628467.aspx)

> 端点配置在相对于 .svc 文件的空地址，因此该服务现在可用并且可以通过发送请求来调用 `service.svc/<operation>`- 例如， `service.svc/Add`对于`Add`操作。

出于这个原因，你不能与 混合`<enableWebScript />`，`UriTemplate`在我看来，这会带走 WCF 的一半乐趣。请参阅[enableWebScript、UriTemplate 和 HTTP 方法](http://blogs.msdn.com/justinjsmith/archive/2008/02/15/enablewebscript-uritemplate-and-http-methods.aspx)。

就个人而言，我喜欢配置我的 URI 并同时提供 POX 和 JSON 以及 SOAP。请参阅[WCF RESTful POX、JSON 和 SOAP 共存](http://www.codemeit.com/wcf/wcf-restful-pox-json-and-soap-coexist.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-12T00:23:07.483

在 ScriptManager 中，放置 MyService.svc/ajax 而不是 MyService.svc

# reporting-services - 移动 ssrs 即席报告

> ID：272623
> 
> 赞同：2
> 
> 时间：2008-11-07T16:30:12.253
> 
> 标签：reporting-services, report

我们有一个报告服务器，它有一堆报告和一些由用户使用报告生成器创建的临时用户报告。现在我们需要将所有这些移动到不同的服务器。新服务器中已经有一些报告。我需要将所有报告从旧服务器移动到新服务器中的文件夹，因为将数据库从旧服务器移动到新服务器不是一种选择。我想知道我们是否有其他方法可以从旧服务器导出所有报告，然后将其部署到新服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T22:58:16.900

您可以使用 ReportingService Web 服务以编程方式与 SSRS 交互。我曾经用它来创建一个基本的批量报告上传器。

[http://msdn.microsoft.com/en-us/library/reportservice2005.reportingservice2005.aspx](http://msdn.microsoft.com/en-us/library/reportservice2005.reportingservice2005.aspx)

或者，一些谷歌搜索出现了这个应用程序，虽然我从未使用过它。 [http://www.sqldbtips.com/showarticle.asp?ID=62](http://www.sqldbatips.com/showarticle.asp?ID=62)

# sharepoint - 如何通过版本控制将文档从 SharePoint 2003 移动到 SharePoint 2007？

> ID：272630
> 
> 赞同：5
> 
> 时间：2008-11-07T16:33:22.340
> 
> 标签：sharepoint, sharepoint-2007, sharepoint-2003

我正在拼命寻找一种工具，该工具允许我将带有旧版本的文档从 SharePoint 2003 复制到 SharePoint 2007 站点。
你知道有什么简单的（最好是免费的）工具可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-18T06:14:26.017

这对您来说可能为时已晚，但我需要从 SharePoint 2003 站点迁移到 SharePoint 2007 站点，并且不仅要保留版本，还要保留所有文档库中的文件元数据。迁移或升级的官方方法失败了，所以我最终编写了一个工具，该工具必须在目标 SharePoint 2007 服务器上运行，但可以从 2003 服务器复制所有列表和文档库，并且元数据和版本完好无损。它的源代码位于[http://sourceforge.net/projects/splistcp](http://sourceforge.net/projects/splistcp)，因此请随意使用和改进它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T19:16:17.817

我们最近从 SPS 2003 迁移到 MOSS 2007，我试图弄清楚如何做到这一点。可悲的是，似乎没有什么好方法。我最终做的是使用我的 SPS 2003 内容数据库的备份和 MOSS 2007 VM 对整个 SPS 2003 门户进行数据库附加升级。然后，我使用内容迁移命令（stsadm -o export、stsadm -o import）将列表及其所有版本移动到“真正的”MOSS 2007 网站集。

此[页面](http://farhanfaiz.wordpress.com/2008/05/23/sharepoint-upgrade-database-migration/)为我提供了进行数据库迁移的步骤。

还有一些不错的命令，您可以使用这些命令仅在[此处](http://stsadm.blogspot.com/)移动一个列表。作为记录，迁移命令（例如 gl-exportlist、gl-importlist）仅在两个 MOSS 2007 安装之间有效。

在结果可以接受之前，我肯定不得不尝试使用 stsadm 扩展和内置命令几次。真正的关键是将数据库迁移到 VM 以将所有内容都放入 MOSS，以便我可以使用这些工具。

我知道这似乎是一项疯狂的工作，但这是我发现在不花费数千美元购买 AvePoint 的 DocAve Migrators 之类的东西的情况下完成它的唯一方法。它真的没有*那么*糟糕。

需要注意的一件事是，如果在执行导出和导入时包含用户安全性，您将获得大量 SharePoint 组和用户添加到您的生产网站集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-05T15:27:30.750

splistcp 工作得非常好，但是当它试图移动文件时，我每隔一段时间就会出现超时错误。我收到一条超时消息，然后是一条找不到文件的消息，然后程序就退出了。我下载了源代码，在程序试图获取文件的 MBSPListItemsMap.cs 中找到。

我在第 620 行的 catch 代码下方添加了一个 finally 块，写信给 consule，告诉我系统在做什么：

```
 ` catch (Exception e)
                        {
                            Console.WriteLine(e.Message);
                            bDownloadError = true;
                        }
                        finally
                        {
                            if (bDownloadError)
                            {
                                Console.WriteLine("Error in downloading file: " + fileName);
                                Console.WriteLine("Moving to next file");
                            }

                        }
                        if (!bDownloadError)
                        {
                            if (Program.beVerbose)
                            {
                                Console.WriteLine("Attaching " + fileName);
                            }
                            byte[] fileContents = MBSPSiteMap.ByteArrayFromFilePath(downloadPath);
                            newItem.Attachments.Add(fileName, fileContents);
                            File.Delete(downloadPath);
                        } ` 
```

我还在其他地方添加了一些 Console.WriteLine 语句，让我知道系统在做什么。否则，系统只会继续运行，而您无法很好地指示它在做什么。

这个程序很有帮助，因为我必须移动 770 条记录，其中包含大约 20 列信息和几个附件。

谢谢迈克尔！！！！

# visual-studio - 构建 Apache Axis2/C 时未声明的标识符 SO_EXCLUSIVEADDRUSE

> ID：272631
> 
> 赞同：0
> 
> 时间：2008-11-07T16:33:40.937
> 
> 标签：visual-studio, axis, winsock

我正在尝试构建 Apache Axis2/C（实际上我正在为它构建 WSO2 WSF/C++ 包装器），当它遇到符号时它一直给我一个错误`SO_EXCLUSIVEADDRUSE`。这是一个套接字选项，MSDN 说它应该可用。我在 Win Server 2k3 上使用 MSVC++ 6.0。我对编译器或操作系统没有选择权......如果我在 linux 上，我已经完成了：P

我查看了一个 VS2005 安装，发现它`#define`在 winsock2.h 中包含该常量。它不在我用于 MSVC6 的 winsock2.h 中。此外，在 VS2005 中，它位于 VS2005 目录内的 PlatformSDK 文件夹下，而 MSVC6 似乎没有任何此类目录。为什么这个符号不见了？我怎么才能得到它？我很想把它复制过来，但谁知道我还会错过什么……有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-24T10:38:21.910

自 Visual Studio .Net 2003 以来，Microsoft 改变了提供 PlatformSDK 的方式。它允许 C/C++ 编译器使用 PlatformSDK，而不是与 VC 包捆绑的版本。

您可以安装适用于 Windows Server 2k3 的 PlatformSDK，但与 VC 6.0 一起使用的最后一个 SDK 是 2003 年 2 月版，该版本无法从 Microsoft 网站获得。

因此，您可以`#define`在使用`SO_EXCLUSIVEADDRUSE`. 它应该由 Win2k3 工作和支持。

# c# - 在大写字母前添加空格

> ID：272633
> 
> 赞同：211
> 
> 时间：2008-11-07T16:33:53.727
> 
> 标签：c#, regex, string

给定字符串“ThisStringHasNoSpacesButItDoesHaveCapitals”，在大写字母前添加空格的最佳方法是什么。所以结束字符串将是“这个字符串没有空格但它有大写字母”

这是我对 RegEx 的尝试

```
System.Text.RegularExpressions.Regex.Replace(value, "[A-Z]", " $0") 
```

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-11-07T17:48:36.900

正则表达式可以正常工作（我什至投票支持 Martin Browns 的答案），但它们很昂贵（而且我个人发现任何比几个字符长的模式都非常迟钝）

这个功能

```
string AddSpacesToSentence(string text, bool preserveAcronyms)
{
        if (string.IsNullOrWhiteSpace(text))
           return string.Empty;
        StringBuilder newText = new StringBuilder(text.Length * 2);
        newText.Append(text[0]);
        for (int i = 1; i < text.Length; i++)
        {
            if (char.IsUpper(text[i]))
                if ((text[i - 1] != ' ' && !char.IsUpper(text[i - 1])) ||
                    (preserveAcronyms && char.IsUpper(text[i - 1]) && 
                     i < text.Length - 1 && !char.IsUpper(text[i + 1])))
                    newText.Append(' ');
            newText.Append(text[i]);
        }
        return newText.ToString();
} 
```

将在 2,968,750 个滴答声中执行 100,000 次，正则表达式将花费 25,000,000 个滴答声（这就是编译的正则表达式）。

它更好，对于给定的更好（即更快）的值，但是它需要维护更多的代码。“更好”通常是对竞争要求的妥协。

希望这可以帮助 ：）

**更新**
自从我看到这个已经很长时间了，我才意识到自从代码改变以来时间还没有更新（它只改变了一点）。

在一个“Abbbbbbbbbb”重复 100 次（即 1,000 字节）的字符串上，运行 100,000 次转换需要手动编码函数 4,517,177 个滴答声，下面的正则表达式需要 59,435,719 次，使得手动编码函数的运行时间为它所用时间的 7.6%正则表达式。

**更新 2** 会考虑首字母缩略词吗？现在会的！if 语句的逻辑相当模糊，您可以看到将其扩展到...

```
if (char.IsUpper(text[i]))
    if (char.IsUpper(text[i - 1]))
        if (preserveAcronyms && i < text.Length - 1 && !char.IsUpper(text[i + 1]))
            newText.Append(' ');
        else ;
    else if (text[i - 1] != ' ')
        newText.Append(' '); 
```

……一点帮助都没有！

这是不用担心缩写词的原始*简单方法*

```
string AddSpacesToSentence(string text)
{
        if (string.IsNullOrWhiteSpace(text))
           return "";
        StringBuilder newText = new StringBuilder(text.Length * 2);
        newText.Append(text[0]);
        for (int i = 1; i < text.Length; i++)
        {
            if (char.IsUpper(text[i]) && text[i - 1] != ' ')
                newText.Append(' ');
            newText.Append(text[i]);
        }
        return newText.ToString();
} 
```

* * *

## 回答 #2

> 赞同：164
> 
> 时间：2008-11-07T17:19:10.873

您的解决方案有一个问题，它在第一个字母 T 之前放置了一个空格，因此您得到

```
" This String..." instead of "This String..." 
```

为了解决这个问题，还要寻找它前面的小写字母，然后在中间插入空格：

```
newValue = Regex.Replace(value, "([a-z])([A-Z])", "$1 $2"); 
```

**编辑1：**

如果您使用`@"(\p{Ll})(\p{Lu})"`它，它也会拾取重音字符。

**编辑2：**

如果您的字符串可以包含首字母缩略词，您可能需要使用：

```
newValue = Regex.Replace(value, @"((?<=\p{Ll})\p{Lu})|((?!\A)\p{Lu}(?>\p{Ll}))", " $0"); 
```

所以“DriveIsSCSICompatible”变成了“Drive Is SCSI Compatible”

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2011-02-16T20:10:35.427

没有测试性能，但这里与 linq 一致：

```
var val = "ThisIsAStringToTest";
val = string.Concat(val.Select(x => Char.IsUpper(x) ? " " + x : x.ToString())).TrimStart(' '); 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-09-27T13:31:54.267

我知道这是一个旧的，但这是我需要这样做时使用的扩展：

```
public static class Extensions
{
    public static string ToSentence( this string Input )
    {
        return new string(Input.SelectMany((c, i) => i > 0 && char.IsUpper(c) ? new[] { ' ', c } : new[] { c }).ToArray());
    }
} 
```

这将允许您使用`MyCasedString.ToSentence()`

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-10-04T17:33:05.987

我开始基于 Binary Worrier 的代码制作一个简单的扩展方法，该方法可以正确处理首字母缩写词，并且是可重复的（不会破坏已经间隔的单词）。这是我的结果。

```
public static string UnPascalCase(this string text)
{
    if (string.IsNullOrWhiteSpace(text))
        return "";
    var newText = new StringBuilder(text.Length * 2);
    newText.Append(text[0]);
    for (int i = 1; i < text.Length; i++)
    {
        var currentUpper = char.IsUpper(text[i]);
        var prevUpper = char.IsUpper(text[i - 1]);
        var nextUpper = (text.Length > i + 1) ? char.IsUpper(text[i + 1]) || char.IsWhiteSpace(text[i + 1]): prevUpper;
        var spaceExists = char.IsWhiteSpace(text[i - 1]);
        if (currentUpper && !spaceExists && (!nextUpper || !prevUpper))
                newText.Append(' ');
        newText.Append(text[i]);
    }
    return newText.ToString();
} 
```

以下是此函数通过的单元测试用例。我将大部分 tchrist 的建议案例添加到此列表中。其中没有通过的三个（两个只是罗马数字）被注释掉：

```
Assert.AreEqual("For You And I", "ForYouAndI".UnPascalCase());
Assert.AreEqual("For You And The FBI", "ForYouAndTheFBI".UnPascalCase());
Assert.AreEqual("A Man A Plan A Canal Panama", "AManAPlanACanalPanama".UnPascalCase());
Assert.AreEqual("DNS Server", "DNSServer".UnPascalCase());
Assert.AreEqual("For You And I", "For You And I".UnPascalCase());
Assert.AreEqual("Mount Mᶜ Kinley National Park", "MountMᶜKinleyNationalPark".UnPascalCase());
Assert.AreEqual("El Álamo Tejano", "ElÁlamoTejano".UnPascalCase());
Assert.AreEqual("The Ævar Arnfjörð Bjarmason", "TheÆvarArnfjörðBjarmason".UnPascalCase());
Assert.AreEqual("Il Caffè Macchiato", "IlCaffèMacchiato".UnPascalCase());
//Assert.AreEqual("Mister ǅenan ǈubović", "Misterǅenanǈubović".UnPascalCase());
//Assert.AreEqual("Ole King Henry Ⅷ", "OleKingHenryⅧ".UnPascalCase());
//Assert.AreEqual("Carlos Ⅴº El Emperador", "CarlosⅤºElEmperador".UnPascalCase());
Assert.AreEqual("For You And The FBI", "For You And The FBI".UnPascalCase());
Assert.AreEqual("A Man A Plan A Canal Panama", "A Man A Plan A Canal Panama".UnPascalCase());
Assert.AreEqual("DNS Server", "DNS Server".UnPascalCase());
Assert.AreEqual("Mount Mᶜ Kinley National Park", "Mount Mᶜ Kinley National Park".UnPascalCase()); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-03-01T00:57:42.587

# 欢迎使用 Unicode

对于现代文本来说，所有这些解决方案本质上都是错误的。你需要使用理解大小写的东西。由于 Bob 要求使用其他语言，我将提供一些 Perl 语言。

我提供了四种解决方案，从最差到最好。只有最好的永远是对的。其他人都有问题。这是一个测试运行，向您展示什么有效，什么无效，以及在哪里。我使用了下划线，以便您可以看到放置空格的位置，并且我已将任何错误的东西标记为错误。

```
Testing TheLoneRanger
               Worst:    The_Lone_Ranger
               Ok:       The_Lone_Ranger
               Better:   The_Lone_Ranger
               Best:     The_Lone_Ranger
Testing MountMᶜKinleyNationalPark
     [WRONG]   Worst:    Mount_MᶜKinley_National_Park
     [WRONG]   Ok:       Mount_MᶜKinley_National_Park
     [WRONG]   Better:   Mount_MᶜKinley_National_Park
               Best:     Mount_Mᶜ_Kinley_National_Park
Testing ElÁlamoTejano
     [WRONG]   Worst:    ElÁlamo_Tejano
               Ok:       El_Álamo_Tejano
               Better:   El_Álamo_Tejano
               Best:     El_Álamo_Tejano
Testing TheÆvarArnfjörðBjarmason
     [WRONG]   Worst:    TheÆvar_ArnfjörðBjarmason
               Ok:       The_Ævar_Arnfjörð_Bjarmason
               Better:   The_Ævar_Arnfjörð_Bjarmason
               Best:     The_Ævar_Arnfjörð_Bjarmason
Testing IlCaffèMacchiato
     [WRONG]   Worst:    Il_CaffèMacchiato
               Ok:       Il_Caffè_Macchiato
               Better:   Il_Caffè_Macchiato
               Best:     Il_Caffè_Macchiato
Testing Misterǅenanǈubović
     [WRONG]   Worst:    Misterǅenanǈubović
     [WRONG]   Ok:       Misterǅenanǈubović
               Better:   Mister_ǅenan_ǈubović
               Best:     Mister_ǅenan_ǈubović
Testing OleKingHenryⅧ
     [WRONG]   Worst:    Ole_King_HenryⅧ
     [WRONG]   Ok:       Ole_King_HenryⅧ
     [WRONG]   Better:   Ole_King_HenryⅧ
               Best:     Ole_King_Henry_Ⅷ
Testing CarlosⅤºElEmperador
     [WRONG]   Worst:    CarlosⅤºEl_Emperador
     [WRONG]   Ok:       CarlosⅤº_El_Emperador
     [WRONG]   Better:   CarlosⅤº_El_Emperador
               Best:     Carlos_Ⅴº_El_Emperador 
```

顺便说一句，这里几乎每个人都选择了第一种方式，即标记为“最差”的方式。少数人选择了第二种方式，标记为“OK”。但是在我之前没有其他人向您展示过如何做“更好”或“最好”的方法。

这是带有四种方法的测试程序：

```
#!/usr/bin/env perl
use utf8;
use strict;
use warnings;

# First I'll prove these are fine variable names:
my (
    $TheLoneRanger              ,
    $MountMᶜKinleyNationalPark  ,
    $ElÁlamoTejano              ,
    $TheÆvarArnfjörðBjarmason   ,
    $IlCaffèMacchiato           ,
    $Misterǅenanǈubović         ,
    $OleKingHenryⅧ              ,
    $CarlosⅤºElEmperador        ,
);

# Now I'll load up some string with those values in them:
my @strings = qw{
    TheLoneRanger
    MountMᶜKinleyNationalPark
    ElÁlamoTejano
    TheÆvarArnfjörðBjarmason
    IlCaffèMacchiato
    Misterǅenanǈubović
    OleKingHenryⅧ
    CarlosⅤºElEmperador
};

my($new, $best, $ok);
my $mask = "  %10s   %-8s  %s\n";

for my $old (@strings) {
    print "Testing $old\n";
    ($best = $old) =~ s/(?<=\p{Lowercase})(?=[\p{Uppercase}\p{Lt}])/_/g;

    ($new = $old) =~ s/(?<=[a-z])(?=[A-Z])/_/g;
    $ok = ($new ne $best) && "[WRONG]";
    printf $mask, $ok, "Worst:", $new;

    ($new = $old) =~ s/(?<=\p{Ll})(?=\p{Lu})/_/g;
    $ok = ($new ne $best) && "[WRONG]";
    printf $mask, $ok, "Ok:", $new;

    ($new = $old) =~ s/(?<=\p{Ll})(?=[\p{Lu}\p{Lt}])/_/g;
    $ok = ($new ne $best) && "[WRONG]";
    printf $mask, $ok, "Better:", $new;

    ($new = $old) =~ s/(?<=\p{Lowercase})(?=[\p{Uppercase}\p{Lt}])/_/g;
    $ok = ($new ne $best) && "[WRONG]";
    printf $mask, $ok, "Best:", $new;
} 
```

当您可以在此数据集上获得与“最佳”相同的分数时，您就会知道您做得正确。在那之前，你还没有。这里没有其他人做得比“好的”更好，而且大多数人都做得“最差”。我期待看到有人发布正确的ℂ♯代码。

我注意到 StackOverflow 的高亮代码再次变得非常愚蠢。他们所做的一切都与这里提到的其他糟糕方法（大多数但不是全部）一样老跛脚。让 ASCII 休息的时间不是很长吗？它不再有意义，假装它就是你所拥有的一切都是错误的。它会导致糟糕的代码。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-24T13:57:52.443

Binary Worrier，我使用了你建议的代码，它相当不错，我只有一个小补充：

```
public static string AddSpacesToSentence(string text)
{
    if (string.IsNullOrEmpty(text))
        return "";
    StringBuilder newText = new StringBuilder(text.Length * 2);
    newText.Append(text[0]);
            for (int i = 1; i < result.Length; i++)
            {
                if (char.IsUpper(result[i]) && !char.IsUpper(result[i - 1]))
                {
                    newText.Append(' ');
                }
                else if (i < result.Length)
                {
                    if (char.IsUpper(result[i]) && !char.IsUpper(result[i + 1]))
                        newText.Append(' ');

                }
                newText.Append(result[i]);
            }
    return newText.ToString();
} 
```

我添加了一个条件`!char.IsUpper(text[i - 1])`。这修复了一个错误，该错误会导致像“AverageNOX”这样的东西变成“Average NO X”，这显然是错误的，因为它应该是“Average NOX”。

可悲的是，这仍然有一个错误，如果你有文本'FromAStart'，你会得到'From AStart'。

关于解决这个问题的任何想法？

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-02-18T15:54:03.093

此正则表达式在每个大写字母前面放置一个空格字符：

```
using System.Text.RegularExpressions;

const string myStringWithoutSpaces = "ThisIsAStringWithoutSpaces";
var myStringWithSpaces = Regex.Replace(myStringWithoutSpaces, "([A-Z])([a-z]*)", " $1$2"); 
```

请注意前面的空格，如果“$ 1 $ 2”，这将完成它。

这是结果：

```
"This Is A String Without Spaces" 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-07T17:38:23.770

这是我的：

```
private string SplitCamelCase(string s) 
{ 
    Regex upperCaseRegex = new Regex(@"[A-Z]{1}[a-z]*"); 
    MatchCollection matches = upperCaseRegex.Matches(s); 
    List<string> words = new List<string>(); 
    foreach (Match match in matches) 
    { 
        words.Add(match.Value); 
    } 
    return String.Join(" ", words.ToArray()); 
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-02-16T20:24:03.507

确保您**没有**在字符串的开头放置空格，而是将**它们**放在连续的大写字母之间。这里的一些答案没有解决其中一个或两个问题。除了正则表达式还有其他方法，但如果你更喜欢使用它，试试这个：

```
Regex.Replace(value, @"\B[A-Z]", " $0") 
```

`\B`是一个否定的，`\b`所以它代表一个非单词边界。这意味着模式在 中匹配“Y” `XYzabc`，但在`Yzabc`or中不匹配`X Yzabc`。作为一个小奖励，您可以在其中包含空格的字符串上使用它，并且不会将它们加倍。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-07T16:44:25.047

你有什么完美的作品。只要记住重新分配`value`给这个函数的返回值。

```
value = System.Text.RegularExpressions.Regex.Replace(value, "[A-Z]", " $0"); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-10-15T19:22:57.993

这是您如何在 SQL 中执行此操作的方法

```
create  FUNCTION dbo.PascalCaseWithSpace(@pInput AS VARCHAR(MAX)) RETURNS VARCHAR(MAX)
BEGIN
    declare @output varchar(8000)

set @output = ''

Declare @vInputLength        INT
Declare @vIndex              INT
Declare @vCount              INT
Declare @PrevLetter varchar(50)
SET @PrevLetter = ''

SET @vCount = 0
SET @vIndex = 1
SET @vInputLength = LEN(@pInput)

WHILE @vIndex <= @vInputLength
BEGIN
    IF ASCII(SUBSTRING(@pInput, @vIndex, 1)) = ASCII(Upper(SUBSTRING(@pInput, @vIndex, 1)))
       begin 

        if(@PrevLetter != '' and ASCII(@PrevLetter) = ASCII(Lower(@PrevLetter)))
            SET @output = @output + ' ' + SUBSTRING(@pInput, @vIndex, 1)
            else
            SET @output = @output +  SUBSTRING(@pInput, @vIndex, 1) 

        end
    else
        begin
        SET @output = @output +  SUBSTRING(@pInput, @vIndex, 1) 

        end

set @PrevLetter = SUBSTRING(@pInput, @vIndex, 1) 

    SET @vIndex = @vIndex + 1
END

return @output
END 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-04-20T21:11:24.477

灵感来自@MartinBrown，两行简单正则表达式，它将解析您的姓名，包括字符串中任何位置的缩略语。

```
public string ResolveName(string name)
{
   var tmpDisplay = Regex.Replace(name, "([^A-Z ])([A-Z])", "$1 $2");
   return Regex.Replace(tmpDisplay, "([A-Z]+)([A-Z][^A-Z$])", "$1 $2").Trim();
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-06-30T14:19:27.037

```
replaceAll("(?<=[^^\\p{Uppercase}])(?=[\\p{Uppercase}])"," "); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-06-14T17:05:08.200

```
static string AddSpacesToColumnName(string columnCaption)
    {
        if (string.IsNullOrWhiteSpace(columnCaption))
            return "";
        StringBuilder newCaption = new StringBuilder(columnCaption.Length * 2);
        newCaption.Append(columnCaption[0]);
        int pos = 1;
        for (pos = 1; pos < columnCaption.Length-1; pos++)
        {               
            if (char.IsUpper(columnCaption[pos]) && !(char.IsUpper(columnCaption[pos - 1]) && char.IsUpper(columnCaption[pos + 1])))
                newCaption.Append(' ');
            newCaption.Append(columnCaption[pos]);
        }
        newCaption.Append(columnCaption[pos]);
        return newCaption.ToString();
    } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-07-26T20:24:37.410

在 Ruby 中，通过正则表达式：

```
"FooBarBaz".gsub(/(?!^)(?=[A-Z])/, ' ') # => "Foo Bar Baz" 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-10-14T13:17:18.673

我采用了 Kevin Strikers 出色的解决方案并转换为 VB。由于我被锁定在 .NET 3.5 中，我还必须编写 IsNullOrWhiteSpace。这通过了他的所有测试。

```
<Extension()>
Public Function IsNullOrWhiteSpace(value As String) As Boolean
    If value Is Nothing Then
        Return True
    End If
    For i As Integer = 0 To value.Length - 1
        If Not Char.IsWhiteSpace(value(i)) Then
            Return False
        End If
    Next
    Return True
End Function

<Extension()>
Public Function UnPascalCase(text As String) As String
    If text.IsNullOrWhiteSpace Then
        Return String.Empty
    End If

    Dim newText = New StringBuilder()
    newText.Append(text(0))
    For i As Integer = 1 To text.Length - 1
        Dim currentUpper = Char.IsUpper(text(i))
        Dim prevUpper = Char.IsUpper(text(i - 1))
        Dim nextUpper = If(text.Length > i + 1, Char.IsUpper(text(i + 1)) Or Char.IsWhiteSpace(text(i + 1)), prevUpper)
        Dim spaceExists = Char.IsWhiteSpace(text(i - 1))
        If (currentUpper And Not spaceExists And (Not nextUpper Or Not prevUpper)) Then
            newText.Append(" ")
        End If
        newText.Append(text(i))
    Next
    Return newText.ToString()
End Function 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-06-12T05:37:42.863

这个问题有点老了，但现在 Nuget 上有一个很好的库，它可以做到这一点以及许多其他对人类可读文本的转换。

查看[GitHub](https://github.com/MehdiK/Humanizer)或 Nuget上的[Humanizer 。](http://humanizr.net/)

**例子**

```
"PascalCaseInputStringIsTurnedIntoSentence".Humanize() => "Pascal case input string is turned into sentence"
"Underscored_input_string_is_turned_into_sentence".Humanize() => "Underscored input string is turned into sentence"
"Underscored_input_String_is_turned_INTO_sentence".Humanize() => "Underscored input String is turned INTO sentence"

// acronyms are left intact
"HTML".Humanize() => "HTML" 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-04-05T18:25:01.477

似乎是一个很好的机会`Aggregate`。这是为了可读性而设计的，不一定特别快。

```
someString
.Aggregate(
   new StringBuilder(),
   (str, ch) => {
      if (char.IsUpper(ch) && str.Length > 0)
         str.Append(" ");
      str.Append(ch);
      return str;
   }
).ToString(); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-08-27T14:48:32.377

发现很多这些答案相当迟钝，但我还没有完全测试我的解决方案，但它可以满足我的需要，应该处理首字母缩略词，并且比其他 IMO 更紧凑/可读：

```
private string CamelCaseToSpaces(string s)
    {
        if (string.IsNullOrEmpty(s)) return string.Empty;

        StringBuilder stringBuilder = new StringBuilder();
        for (int i = 0; i < s.Length; i++)
        {
            stringBuilder.Append(s[i]);

            int nextChar = i + 1;
            if (nextChar < s.Length && char.IsUpper(s[nextChar]) && !char.IsUpper(s[i]))
            {
                stringBuilder.Append(" ");
            }
        }

        return stringBuilder.ToString();
    } 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-02-16T18:11:55.020

除了 Martin Brown 的回答之外，我还遇到了数字问题。例如：“Location2”或“Jan22”应分别为“Location 2”和“Jan 22”。

这是我的正则表达式，使用 Martin Brown 的回答：

```
"((?<=\p{Ll})\p{Lu})|((?!\A)\p{Lu}(?>\p{Ll}))|((?<=[\p{Ll}\p{Lu}])\p{Nd})|((?<=\p{Nd})\p{Lu})" 
```

这里有几个很棒的网站，可以用来弄清楚每个部分的含义：

[基于 Java 的正则表达式分析器（但适用于大多数 .net 正则表达式）](http://xenon.stanford.edu/~xusch/regexp/analyzer.html)

[基于动作脚本的分析器](http://gskinner.com/RegExr/)

`\p{Ll}`除非您将所有的with `[a-z]`、`\p{Lu}`with`[A-Z]`和`\p{Nd}`with替换掉，否则上述正则表达式将无法在操作脚本站点上运行`[0-9]`。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-09-24T13:48:39.127

这是我的解决方案，基于 Binary Worriers 的建议和 Richard Priddys 的评论，但也考虑到提供的字符串中可能存在空格，因此它不会在现有空格旁边添加空格。

```
public string AddSpacesBeforeUpperCase(string nonSpacedString)
    {
        if (string.IsNullOrEmpty(nonSpacedString))
            return string.Empty;

        StringBuilder newText = new StringBuilder(nonSpacedString.Length * 2);
        newText.Append(nonSpacedString[0]);

        for (int i = 1; i < nonSpacedString.Length; i++)
        {
            char currentChar = nonSpacedString[i];

            // If it is whitespace, we do not need to add another next to it
            if(char.IsWhiteSpace(currentChar))
            {
                continue;
            }

            char previousChar = nonSpacedString[i - 1];
            char nextChar = i < nonSpacedString.Length - 1 ? nonSpacedString[i + 1] : nonSpacedString[i];

            if (char.IsUpper(currentChar) && !char.IsWhiteSpace(nextChar) 
                && !(char.IsUpper(previousChar) && char.IsUpper(nextChar)))
            {
                newText.Append(' ');
            }
            else if (i < nonSpacedString.Length)
            {
                if (char.IsUpper(currentChar) && !char.IsWhiteSpace(nextChar) && !char.IsUpper(nextChar))
                {
                    newText.Append(' ');
                }
            }

            newText.Append(currentChar);
        }

        return newText.ToString();
    } 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-07-26T18:35:09.150

对于正在寻找回答相同问题的 C++ 函数的任何人，您可以使用以下内容。这是根据@Binary Worrier 给出的答案建模的。此方法仅自动保留首字母缩略词。

```
using namespace std;

void AddSpacesToSentence(string& testString)
        stringstream ss;
        ss << testString.at(0);
        for (auto it = testString.begin() + 1; it != testString.end(); ++it )
        {
            int index = it - testString.begin();
            char c = (*it);
            if (isupper(c))
            {
                char prev = testString.at(index - 1);
                if (isupper(prev))
                {
                    if (index < testString.length() - 1)
                    {
                        char next = testString.at(index + 1);
                        if (!isupper(next) && next != ' ')
                        {
                            ss << ' ';
                        }
                    }
                }
                else if (islower(prev)) 
                {
                   ss << ' ';
                }
            }

            ss << c;
        }

        cout << ss.str() << endl; 
```

我用于这个函数的测试字符串，结果是：

*   “你好世界”->“你好世界”
*   “你好世界”->“你好世界”
*   “你好ABC世界”->“你好ABC世界”
*   “HelloWorldABC” -> “Hello World ABC”
*   "ABCHelloWorld" -> "ABC 你好世界"
*   “ABC 你好世界” -> “ABC 你好世界”
*   “ABCHELLOWORLD”->“ABCHELLOWORLD”
*   “A”->“A”

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-06-06T19:12:08.510

仅由 ASCII 字符组成的输入字符串的**C#解决方案。**正**则表达式**结合了**否定的lookbehind**来忽略出现在字符串开头的大写（大写）字母。使用[Regex.Replace()](http://msdn.microsoft.com/en-us/library/xwewhkd1%28v=vs.110%29.aspx)返回所需的字符串。

另请参阅[regex101.com 演示](http://regex101.com/r/gS6kD5)。

```
using System;
using System.Text.RegularExpressions;

public class RegexExample
{
    public static void Main()
    {
        var text = "ThisStringHasNoSpacesButItDoesHaveCapitals";

        // Use negative lookbehind to match all capital letters
        // that do not appear at the beginning of the string.
        var pattern = "(?<!^)([A-Z])";

        var rgx = new Regex(pattern);
        var result = rgx.Replace(text, " $1");
        Console.WriteLine("Input: [{0}]\nOutput: [{1}]", text, result);
    }
} 
```

**预期输出：**

```
Input: [ThisStringHasNoSpacesButItDoesHaveCapitals]
Output: [This String Has No Spaces But It Does Have Capitals] 
```

* * *

**更新：**这是一个也可以处理**首字母缩写词**（大写字母序列）的变体。

另请参阅[regex101.com 演示](http://regex101.com/r/yM8mJ2)和[ideone.com 演示](http://ideone.com/uJ1DHP)。

```
using System;
using System.Text.RegularExpressions;

public class RegexExample
{
    public static void Main()
    {
        var text = "ThisStringHasNoSpacesASCIIButItDoesHaveCapitalsLINQ";

        // Use positive lookbehind to locate all upper-case letters
        // that are preceded by a lower-case letter.
        var patternPart1 = "(?<=[a-z])([A-Z])";

        // Used positive lookbehind and lookahead to locate all
        // upper-case letters that are preceded by an upper-case
        // letter and followed by a lower-case letter.
        var patternPart2 = "(?<=[A-Z])([A-Z])(?=[a-z])";

        var pattern = patternPart1 + "|" + patternPart2;
        var rgx = new Regex(pattern);
        var result = rgx.Replace(text, " $1$2");

        Console.WriteLine("Input: [{0}]\nOutput: [{1}]", text, result);
    }
} 
```

**预期输出：**

```
Input: [ThisStringHasNoSpacesASCIIButItDoesHaveCapitalsLINQ]
Output: [This String Has No Spaces ASCII But It Does Have Capitals LINQ] 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-12-05T23:56:09.583

这个包括首字母缩写词和首字母缩写词复数，比公认的答案要快一点：

```
public string Sentencify(string value)
{
    if (string.IsNullOrWhiteSpace(value))
        return string.Empty;

    string final = string.Empty;
    for (int i = 0; i < value.Length; i++)
    {
        if (i != 0 && Char.IsUpper(value[i]))
        {
            if (!Char.IsUpper(value[i - 1]))
                final += " ";
            else if (i < (value.Length - 1))
            {
                if (!Char.IsUpper(value[i + 1]) && !((value.Length >= i && value[i + 1] == 's') ||
                                                     (value.Length >= i + 1 && value[i + 1] == 'e' && value[i + 2] == 's')))
                    final += " ";
            }
        }

        final += value[i];
    }

    return final;
} 
```

通过这些测试：

```
string test1 = "RegularOTs";
string test2 = "ThisStringHasNoSpacesASCIIButItDoesHaveCapitalsLINQ";
string test3 = "ThisStringHasNoSpacesButItDoesHaveCapitals"; 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-03-23T22:59:02.670

这是一个更彻底的解决方案，它不会在单词前面放置空格：

**注意：**我使用了多个正则表达式（不简洁，但它也可以处理首字母缩写词和单字母词）

```
Dim s As String = "ThisStringHasNoSpacesButItDoesHaveCapitals"
s = System.Text.RegularExpressions.Regex.Replace(s, "([a-z])([A-Z](?=[A-Z])[a-z]*)", "$1 $2")
s = System.Text.RegularExpressions.Regex.Replace(s, "([A-Z])([A-Z][a-z])", "$1 $2")
s = System.Text.RegularExpressions.Regex.Replace(s, "([a-z])([A-Z][a-z])", "$1 $2")
s = System.Text.RegularExpressions.Regex.Replace(s, "([a-z])([A-Z][a-z])", "$1 $2") // repeat a second time 
```

**在**：

```
"ThisStringHasNoSpacesButItDoesHaveCapitals"
"IAmNotAGoat"
"LOLThatsHilarious!"
"ThisIsASMSMessage" 
```

**出**：

```
"This String Has No Spaces But It Does Have Capitals"
"I Am Not A Goat"
"LOL Thats Hilarious!"
"This Is ASMS Message" // (Difficult to handle single letter words when they are next to acronyms.) 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2016-01-18T14:24:04.733

之前的所有回复看起来都太复杂了。

我有一个混合了大写字母和 _ 的字符串，因此使用 string.Replace() 来制作 _、“”，并使用以下内容在大写字母处添加空格。

```
for (int i = 0; i < result.Length; i++)
{
    if (char.IsUpper(result[i]))
    {
        counter++;
        if (i > 1) //stops from adding a space at if string starts with Capital
        {
            result = result.Insert(i, " ");
            i++; //Required** otherwise stuck in infinite 
                 //add space loop over a single capital letter.
        }
    }
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-03-08T12:37:40.337

受到 Binary Worrier 回答的启发，我对此有所了解。

结果如下：

```
/// <summary>
/// String Extension Method
/// Adds white space to strings based on Upper Case Letters
/// </summary>
/// <example>
/// strIn => "HateJPMorgan"
/// preserveAcronyms false => "Hate JP Morgan"
/// preserveAcronyms true => "Hate JPMorgan"
/// </example>
/// <param name="strIn">to evaluate</param>
/// <param name="preserveAcronyms" >determines saving acronyms (Optional => false) </param>
public static string AddSpaces(this string strIn, bool preserveAcronyms = false)
{
    if (string.IsNullOrWhiteSpace(strIn))
        return String.Empty;

    var stringBuilder = new StringBuilder(strIn.Length * 2)
        .Append(strIn[0]);

    int i;

    for (i = 1; i < strIn.Length - 1; i++)
    {
        var c = strIn[i];

        if (Char.IsUpper(c) && (Char.IsLower(strIn[i - 1]) || (preserveAcronyms && Char.IsLower(strIn[i + 1]))))
            stringBuilder.Append(' ');

        stringBuilder.Append(c);
    }

    return stringBuilder.Append(strIn[i]).ToString();
} 
```

使用运行 10000000 次迭代和各种字符串长度和组合的秒表进行了测试。

平均比 Binary Warrier 的答案快 50%（也许更多）。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-07-04T07:41:19.667

```
 private string GetProperName(string Header)
    {
        if (Header.ToCharArray().Where(c => Char.IsUpper(c)).Count() == 1)
        {
            return Header;
        }
        else
        {
            string ReturnHeader = Header[0].ToString();
            for(int i=1; i<Header.Length;i++)
            {
                if (char.IsLower(Header[i-1]) && char.IsUpper(Header[i]))
                {
                    ReturnHeader += " " + Header[i].ToString();
                }
                else
                {
                    ReturnHeader += Header[i].ToString();
                }
            }

            return ReturnHeader;
        }

        return Header;
    } 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-05-23T05:34:36.900

的实现`fold`，也称为`Aggregate`：

```
 public static string SpaceCapitals(this string arg) =>
       new string(arg.Aggregate(new List<Char>(),
                      (accum, x) => 
                      {
                          if (Char.IsUpper(x) &&
                              accum.Any() &&
                              // prevent double spacing
                              accum.Last() != ' ' &&
                              // prevent spacing acronyms (ASCII, SCSI)
                              !Char.IsUpper(accum.Last()))
                          {
                              accum.Add(' ');
                          }

                          accum.Add(x);

                          return accum;
                      }).ToArray()); 
```

除了请求之外，此实现还正确保存了前导、内部、尾随空格和首字母缩略词，例如，

```
" SpacedWord " => " Spaced Word ",  

"Inner Space" => "Inner Space",  

"SomeACRONYM" => "Some ACRONYM". 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-04-08T01:08:48.937

在小写字母、大写字母或数字之后添加空格的简单方法。

```
 string AddSpacesToSentence(string value, bool spaceLowerChar = true, bool spaceDigitChar = true, bool spaceSymbolChar = false)
    {
        var result = "";

        for (int i = 0; i < value.Length; i++)
        {
            char currentChar = value[i];
            char nextChar = value[i < value.Length - 1 ? i + 1 : value.Length - 1];

            if (spaceLowerChar && char.IsLower(currentChar) && !char.IsLower(nextChar))
            {
                result += value[i] + " ";
            }
            else if (spaceDigitChar && char.IsDigit(currentChar) && !char.IsDigit(nextChar))
            {
                result += value[i] + " ";
            }
            else if(spaceSymbolChar && char.IsSymbol(currentChar) && !char.IsSymbol(nextChar))
            {
                result += value[i];
            }
            else
            {
                result += value[i];
            }
        }

        return result;
    } 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-10-31T09:20:55.957

我想用这个

```
string InsertSpace(string text ) {
    return string.Join("" , text.Select(ch => char.IsUpper(ch) ? " " : "" + ch))  ;
} 
```

# javascript - 打开/关闭图标

> ID：272635
> 
> 赞同：1
> 
> 时间：2008-11-07T16:34:23.617
> 
> 标签：javascript, jquery, html, dom

我正在用 jQuery 做一些恶作剧，以便在我的扩展器旁边放置小加号/减号图标。它类似于 windows 文件树或 firebugs 代码扩展器。

它有效，但不够具体。

希望这是有道理的......

```
$('div.toggle').hide();//hide all divs that are part of the expand/collapse
$('ul.product-info li a').toggle(function(event){
  event.preventDefault();
  $(this).next('div').slideToggle(200);//find the next div and sliiiide it
  $('img.expander').attr('src','img/content/info-close.gif');//this is the part thats not specific enough!!!
},function(event) { // opposite here
  event.preventDefault();
  $(this).next('div').slideToggle(200);
  $('img.expander').attr('src','img/content/info-open.gif');
});

<ul class="product-info">
  <li>
    <a class="img-link" href="#"><img class="expander" src="img/content/info-open.gif" alt="Click to exand this section" /> <span>How it compares to the other options</span>
  </a>
  <div class="toggle"><p>Content viewable when expanded!</p></div>
  </li>
</ul> 
```

页面上有很多`$('img.expander')`标签，但我需要具体说明。我已经尝试过 next() 功能（就像我用来查找下一个 div 一样），但它说它未定义。如何找到我的特定 img.expander 标签？谢谢。

编辑，根据道格拉斯的解决方案更新代码：

```
$('div.toggle').hide();
            $('ul.product-info li a').toggle(function(event){
                //$('#faq-copy .answer').hide();
                event.preventDefault();
                $(this).next('div').slideToggle(200);
                $(this).contents('img.expander').attr('src','img/content/info-close.gif');
                //alert('on');
            },function(event) { // same here
                event.preventDefault();
                $(this).next('div').slideToggle(200);
                $(this).contents('img.expander').attr('src','img/content/info-open.gif');
            }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T16:56:32.417

```
$(this).contents('img.expander') 
```

这就是你想要的。它将选择作为列表子节点的所有节点。在您的情况下，您的所有图像都嵌套在列表元素内，因此这只会过滤掉您想要的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T16:56:22.013

如何让您的点击事件在父项上切换 CSS 类（在您的情况下，可能是 ul.product-info）。然后，您可以使用 CSS 背景属性来更改 <span> 的背景图像，而不是使用文字 <img> 并尝试摆弄 src。您还可以在 div.toggle 上完成显示和隐藏。

```
ul.product-info.open span.toggler {
   background-image: url( "open-toggler.png" );
}
ul.product-info.closed span.toggler {
   background-image: url( "closed-toggler.png" );
}

ul.product-info.open div.toggle {
   display: block;
}
ul.product-info.closed div.toggle {
   display: hidden;
} 
```

当 DOM 有很多项和深度嵌套时，使用 jQuery 导航/爬虫函数可能会很慢。使用 CSS，您的浏览器将更快地呈现和更改内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:55:34.293

您是否尝试过 .siblings() 方法？

```
$(this).siblings('img.expander').attr('src','img/content/info-close.gif'); 
```

# jsp - struts 逻辑标签可以评估变量的内容吗？

> ID：272638
> 
> 赞同：2
> 
> 时间：2008-11-07T16:35:07.127
> 
> 标签：jsp, struts, tags

以下是我想要实现的目标。问题是“错误”没有定义。如果我删除匹配逻辑，错误会显示在网页上。无论如何评估错误包含的文本？

```
<logic:messagesPresent>
    <tr>
        <td class="errorcicon"><img src="images/icon_caution.gif" width="18" height="18" alt="Caution" /></td>
        <td></td>
        <td colspan="4"><html:errors /></td>
    </tr>
</logic:messagesPresent>

<logic:match name="errors" property="text" value="Service Start date is required" >
    <% pageContext.setAttribute("NOORIGIONALSERVICEDATE", "-1");%>
</logic:match> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T22:38:47.143

我不确定你问的问题是否适合这个问题。查看 taglib 文档[`<logic:messagesPresent>`](http://struts.apache.org/1.3.8/struts-taglib/tlddoc/logic/messagesPresent.html)

我相信您需要的是`<logic:messagesPresent message="false">`应该查看`Globals.ERROR_KEY`而不是`Globals.MESSAGE_KEY`. 默认情况下，消息属性为“true”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T23:22:48.050

这将修复您的错误：

```
<logic:messagesPresent>
    <tr>
        <td class="errorcicon"><img src="images/icon_caution.gif" width="18" height="18" alt="Caution" /></td>
        <td></td>
        <td colspan="4"><html:errors /></td>
    </tr>
</logic:messagesPresent>

<logic:present name="errors">
    <logic:match name="errors" property="text" value="Service Start date is required" >
        <% pageContext.setAttribute("NOORIGIONALSERVICEDATE", "-1");%>
    </logic:match>
</logic:present> 
```

logic:present 允许您测试 bean 是否存在于范围内。在这种情况下，标签 logic:present 中的代码将被执行。

# gridview - 带有用于绑定到 Gridview 的元数据的自定义数据表？

> ID：272643
> 
> 赞同：1
> 
> 时间：2008-11-07T16:36:17.437
> 
> 标签：gridview, dynamic, binding, datatable, typed

我将数据表绑定到 gridview 控件，当我格式化每一列时，我需要根据该列是否具有特定的自定义属性来格式化数据。在这种情况下，一列可以表示：

*   一个文本框（在这种情况下，我只在 gridview 中显示文本框中的文本），
*   一个复选框（在这种情况下，我会根据列的基础数据值是 1 还是 0 显示“已选中”或“未选中”），
*   一个单选按钮（在这种情况下，我根据列的基础数据值是 1 还是 0 显示“开”或“关”）。

问题是列数据类型是当前绑定到网格的无类型数据表中的所有字符串。并且绑定使用 autoGenerateColumns。所以：

1.  如何将列标记为单选、文本框或复选框？
2.  如何在绑定到网格以显示文本“选中/未选中”或“开/关”时访问该“标志”？

我希望我问对了。呸！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T22:37:35.723

好的 - 我使用正确的数据类型向 DataTable 列添加了扩展属性，并在 1..numColumns 的循环中检查了 GridView 的 RowDataBound 事件：

myProperty=e.Row.DataItem.dataview.table.columns(i).extendedproperties("TYPE")

并根据类型设置值 (e.Row.Cells(i).Text)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T16:52:10.320

最好的方法是关闭列的自动生成，然后用 TemplateFields 替换您关心的列的 BoundFields。有一个[关于 ASP.NET 的教程](http://www.asp.net/learn/data-access/tutorial-12-cs.aspx)，可以填写更多的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T18:13:55.727

我对模板字段没意见；我不知道如何将元数据添加到我可以在 GridView 数据绑定期间读取的数据表列中。例如，当我绑定到具有复选框数据的列时，我想在列中放置单词“Checked”或“Unchecked”，但我需要以某种方式注释我的数据表，使其包含列数据类型。

# c# - 如何隐藏方法，使其不被程序员调用但仍可在代码中使用？

> ID：272644
> 
> 赞同：4
> 
> 时间：2008-11-07T16:36:19.277
> 
> 标签：c#, inheritance

我有一个班级`Ship`和一个班级`Lifeboat`

Lifeboat 继承自 Ship。

Ship 包含一个`Validate()`在保存之前调用的方法，它有一个`FurtherValidate()`从 Validate 调用的抽象方法。这样做的原因是，当您在基础上调用 validate 时，它​​也会验证正在继承的类。所以我们有

```
public class Ship

public bool Validate()
{
    //validate properties only found on a ship

    FurtherValidate();
}

public abstract bool FurtherValidate(); 
```

也`Lifeboat`有

```
public override bool FurtherValidate()
{
    //validate properties only found on a lifeboat
} 
```

这意味着任何实现的人`Ship`也需要为他们的类提供他们自己的验证，并且保证在保存时作为基础船被调用。`Validate()`被调用，它又调用继承的验证。

我们如何才能重新工作，所以我们仍然强制继承的类实现`FurtherValidate()`但`FurtherValidate()`程序员永远不能调用。目前你可以打电话`Lifeboat.FurtherValidate()`，我想以某种方式阻止这种情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T16:40:29.643

```
protected abstract bool FurtherValidate(); 
```

现在只有 Ship 和 Lifeboat 可以看到。

编辑：救生艇必须能够看到它。`FurtherValidate`当它甚至看不到它时，它应该如何覆盖。我会将它重命名为`ValidateCore`'Core' 部分（对我而言）意味着它不应该在没有充分理由的情况下被调用。

我认为将其抽象但不可见并不容易。你需要对你的救生艇有一些信心；）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-07T16:50:05.863

简短的回答是，您不能从派生它的类中隐藏派生方法。但是，您可以重构代码以完成您想要实现的目标：

```
public class Ship
{    
    public virtual bool Validate()    
    {        
        //validate properties only found on a ship
        return true;
    }
}
public class Lifeboat : Ship
{   
    public override bool Validate()   
    {       
        base.Validate();       
        // lifeboat specific code
        return true;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-07T16:53:57.307

您描述的确切情况是不可能的。您可以使用访问修饰符将对该方法的访问限制`FurtherValidate`为仅派生类。`protected`您还可以通过使用修饰符将其限制为仅同一程序集中的类`internal`，但这仍然允许编写派生类的程序员在他们希望的任何时候调用进一步验证。同时使用 protected 和 internal 将两者结合起来，实际上意味着仅限于派生类或在同一程序集中定义的类。

使用 [EditorBrowsable] 属性是一种 IDE 技巧，它将隐藏 IntelliSense 中的方法（除非其他程序员在 VS 中打开了正确的选项）。这将有效地阻止大多数人调用它（如果他们看不到它，它就不存在）。

您可以使用反射来询问您的调用者是谁，但我认为这样做的性能成本与收益相比太高了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-07T16:43:45.033

最简单的答案是使该方法受到保护。这允许继承者调用它，但不会使其公开可用。但是，没有什么可以阻止继承类将方法更改为 public。

我会更倾向于完全删除FurtherValidate 方法，并让任何继承类覆盖Validate，如果他们愿意，可以调用base.Validate()。这允许任何从 ship 继承的类对 validate 方法有更大程度的控制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-07T16:50:18.250

protected 是正确的方法。但在另一种情况下，您可能希望使用[editorbrowsableattribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.editorbrowsableattribute.aspx)来隐藏智能感知的方法。你仍然可以调用它，但它会减慢开发人员调用可能导致程序崩溃的东西的速度，并且通常会迫使他们阅读你巨大的评论警告。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T16:40:29.533

将其设置为受保护而不是公开至少可以防止外部对象调用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-07T17:47:32.127

我在这里看到了代码异味，因为验证不是船舶功能责任的一部分。换句话说，我认为您可能正在尝试使用继承来解决问题，而这可能不是最好的解决方案。尝试重构验证逻辑，以便将验证注入到类中。就域对象而言，这将更有意义`Ship`，因为船舶不会自我验证，它们会在外部进行验证。如果你想强制*必须*有一个验证器，那么如果属性为空，你可以抛出一个异常。

```
protected IValidator FurtherValidation { private get; set; }

public bool Validate()
{
//validate properties only found on a ship

    if (FurtherValidation == null)
        throw new ValidationIsRequiredException();
    if (!FurtherValidation.IsValid(this))
        // logic for invalid state
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T16:41:00.780

您可以将该方法标记为`protected`只有继承类才能访问它。这不会阻止继承者通过另一个公共方法公开该方法，但这通常不是主要问题。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-07T16:48:34.837

可能你可以试试 private 修饰符

# java - SQL Server 的 Java O/R 层？

> ID：272657
> 
> 赞同：3
> 
> 时间：2008-11-07T16:41:39.390
> 
> 标签：java, sql-server, database, orm

我有一个需要与 MS SQL Server 数据库通信的 Java 服务器（不是基于 Web，更像是一个大型、多线程的独立应用程序）。

我刚刚从事了一个不同的项目，该项目将一个本土的 O/R 层从 oracle 移植到 SQL Server，由于太多的 oracle 假设（主要是锁定），它遇到了重大问题。那么我应该使用什么 O/R 层呢？

编辑：我听说过 Hibernate，但其他一切都很有用！但具体来说，这些 API/框架中的任何一个是否有助于解决多线程环境中 SQL Server 锁定策略的特殊缺点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T16:46:31.893

**休眠**是通常的选择。除此之外，您还可以查看 Oracle TopLink、iBatis，以及最适合您的套件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T19:56:19.420

我使用过 Hibernate 和 iBATIS。选择其中一个取决于具体情况。

休眠：

*   对数据库模式更加挑剔
*   为您生成大部分 sql
*   更多功能
*   更复杂

伊巴蒂斯：

*   当您想使用现有架构时效果更好
*   需要你自己写sql
*   更容易学习

它们都适用于 SQL Server 并处理多线程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-10T12:12:44.690

我建议[Cayenne](http://cayenne.apache.org/)。它支持很多数据库。它也是开源的。但是没有那么多文件。您可以将 cayenne 与支柱一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T17:59:53.710

我还将[BEA Kodo](http://www.bea.com/kodo/)与 Microsoft SQL Server 一起使用（回到 Solarmetric Kodo 时）。当时，它的功能远比 Hibernate 和任何 JDO 实现丰富。情况已不再如此，尽管它仍然具有许多独特的性能/可扩展性功能。

Hibernate 是当今最流行的一种。我个人最喜欢的是 TopLink。

您要寻找的关键标准是 EJB3、Java Persistance API (JPA) 和 Java 数据对象 (JDO)。JPA 可能是其中最重要的一个，因为它更易于使用，并且是用于使用 Hibernate、JDO、Toplink、EJB3 等的通用 API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T21:06:36.097

休眠很好。但是有不同风格的 Hibernate 实现。我建议使用 JPA 的 Hibernate 3.x (3.2?)。我通常也使用 Spring 2.5 作为业务逻辑的框架。Hibernate 和 Spring 一起工作特别好，因为它们可以在一定程度上共享名称解析范围，这减少了如何访问 O/R 对象的混乱。

# silverlight - 如何在 Silverlight 中加载 png 资源图像？

> ID：272659
> 
> 赞同：5
> 
> 时间：2008-11-07T16:42:09.327
> 
> 标签：silverlight

我正在尝试在特定的 Silverlight 项目文件夹中添加 png 图像资源。我想在我的标签中引用这张图片？只有当包含图像标记的 xaml 文件与 png 文件位于同一目录中时，我才似乎可以正常工作。

例如，在 xap 文件中，png 文件将位于 xap\resource\image1.png 中，而我的 xaml 文件将驻留在根目录 xap\consumeImageA.xaml 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T19:54:12.777

我发现一篇博客文章讨论了在表达混合中[使用 URIS](http://blogs.msdn.com/jaimer/archive/2009/02/15/using-uris-in-expression-blend.aspx)对我有用。

> *   pack://application:,,,/Images/happyface.png 是错误的。这将适用于 XAML，
>     但不适用于代码。它需要是
>     
>     
> *   pack://application:,,,/WpfApplication6;component/Images/happyface.png 如果你这样做，Blend 会一直很好地解决
>     ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T17:27:10.407

您可以指定 XAP 文件所在位置的相对路径，但不能使用 .. 表示法，因此图像必须处于 XAP 文件级别或更低级别。Shawn Wildermuth 一直在尝试将 XAP 文件放在 Web 根目录而不是 ClientBin，以便您可以使用相对路径。或者，您可以使用图像的绝对路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T05:47:31.550

确保使用正斜杠，而不是反斜杠。我知道有人不止一次地咬过我的后背。

因此，在您的示例中，您应该使用 resource/image1.png

# objective-c - 我是否必须学习 Objective-C 才能进行专业的 Mac 开发？

> ID：272660
> 
> 赞同：21
> 
> 时间：2008-11-07T16:43:04.037
> 
> 标签：objective-c, cocoa, macos

我真的必须学习 Objective-C 来开发可靠的 Mac 应用程序吗？

由于 Mac 用户倾向于只使用具有良好（本机）GUI 的应用程序，我认为 Mono 和 GTK+ 或任何 Java GUI（Swing）都不能满足他们的需求。

有 Cocoa#、PyObjC 和 RubyCocoa 等项目，但它们准备好迎接黄金时段了吗？

那么我真的必须学习 Objective-C 吗？我更喜欢动态语言。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-07T16:49:41.120

就 Objective-C 部分而言， Objective-C*是*一种动态语言。这是一篇小总结文章： http: [//www.macdevcenter.com/pub/a/mac/2003/04/28/objective-c.html](http://www.macdevcenter.com/pub/a/mac/2003/04/28/objective-c.html)

语法一开始很吓人，但它会随着你的成长而成长。我建议咬紧牙关，努力通过它。

如果您想与其他人一起从事 Mac 编程的“真正工作”，您将需要了解 Objective-C（无论如何，在我看来）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-07T16:52:16.593

我认为简短的回答是肯定的，你需要学习 Objective-C。

Python 和 Ruby 的“桥梁”是有效的，但这并不是 Apple 自己推动或使用的。几年前，有一个 Java 桥接到 Cocoa，但现在已弃用。谁知道非 ObjC 语言会发生什么？

无论如何，Objective C 是非常动态的。可能不像 Ruby/Python 那样，但它肯定不像 C++。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-07T16:52:44.390

简短的回答：是的:)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-09T12:59:55.763

我们的第一个应用程序是使用 Python 构建的，使用 PyObjC 桥接器。根据经验，我可以告诉您，要使用桥接器构建应用程序，您需要学习：

1.  桥的特点
2.  用桥接语言读写代码（在我的例子中是 Python）
3.  阅读 Objective-C 中的代码（所有有用的示例代码都在 Obj-C 中）
4.  用 Objective-C 编写伪代码（如果你想在邮件列表上提问或类似的问题）
5.  可可

在所有这些要学习的东西中，Cocoa 是最重要的。这是真正有趣的东西进来的地方，也是你真正需要把你的大脑包裹起来的东西。在完成了这个 PyObjC 项目之后，我用 Obj-C 编码变得非常容易，即使我之前没有用 C 编码的经验。

所以我的建议是：专注于学习 Cocoa，并使用最适合作为工具的语言（Obj-C）。如果您找到使用桥接器的特定原因，例如需要可以处理网络 SQL 的 ORM 等。您可以应用大约 90% 的知识来编写您的第一个 Obj-C/Cocoa 应用程序（s ) 在桥接项目中。

最后：我真的不明白许多刚接触这个平台的人对学习 Objective-C 的阻力。学习新东西并用这些新知识构建最好的东西不是令人兴奋和满足吗？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-07T16:55:26.570

即使您选择使用其中一种桥梁，您也绝对需要学习 Objective-C。Apple 已经通过他们对 Java 的处理表明，他们对通过除 Objective-C 之外的任何东西来为 Cocoa 的使用提供大量支持或向后兼容性并不真正感兴趣。

因此，如果您愿意，可以使用其中一个桥接器，但要牢牢掌握 Objective-C 运行时和桥接器，以便您可以在需要时自行管理它们。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-07T22:48:48.930

> 我真的必须学习 Objective-C 来开发可靠的 Mac 应用程序吗？

目前，是的。

> 由于 Mac 用户倾向于只使用具有良好（本机）GUI 的应用程序，我认为 Mono 和 GTK+ 或任何 Java GUI（Swing）都不能满足他们的需求。

正确的。

> 有 Cocoa#、PyObjC 和 RubyCocoa 等项目，但它们准备好迎接黄金时段了吗？

Cocoa#：我不知道，因为我不使用 C#。

PyObjC：有点，但是 Python 中的 Cocoa 有点像 hack，因为 Python 还不够 Smalltalky。

RubyCocoa：也许吧。不过，我正在等待[MacRuby](http://macruby.org/)成熟。也可以看看：

*   [延斯·阿尔夫克在 MacRuby 上](http://mooseyard.com/Jens/2008/03/macruby/)
*   [MacRuby 上的 Jesper](http://waffle.wootest.net/2008/10/22/ruby-wednesday/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-07T18:33:39.897

有少数成功的 Cocoa 应用程序是用桥接语言编写的，因此您不一定需要那么多地使用它，但您确实需要学习它。试图学习用桥接语言编写 Mac OS 程序的人对自己造成了极大的伤害。桥接语言是很好的工具，但它们能让了解桥接语言和 Objective C 的人变得更有效率，而不是跳过学习 Objective C。

为了有效地使用 PyObjC 或 MacRuby 之类的东西，您需要真正了解本机运行时如何处理桥接语言和 Objective C 运行时之间可能发生的所有阻抗不匹配。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-07T16:55:43.323

简短的回答是肯定的，较长的回答是“你可以使用 Objective-C++”。无论哪种方式，您都必须至少学习一些 Objective-C。一旦您开始深入研究 Cocoa（用于构建 Mac OS X 应用程序的框架）、Xcode 工具和 Apple 人机界面设计指南，您就会意识到 Objective-C 才是正确的选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-07T16:57:45.707

不仅您必须了解 Objective-C（简单的部分），而且您必须非常熟悉普通的旧 C。在我看来，这对大多数人来说是最大的挑战。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-07T17:02:24.857

如果您已经了解 C，那么 Objective-C 很容易学习。

Ruby 和 Python 对于“真正的”Mac 应用程序都是可行的。ADC 有几篇关于[该主题](http://developer.apple.com/documentation/Cocoa/Conceptual/RubyPythonCocoa/Introduction/Introduction.html)的文章。MacRuby 看起来将[取代 RubyCocoa](http://developer.apple.com/mac/articles/scriptingautomation/cocoaappswithmacruby.html)。

不过，我仍然建议学习 Objective-C。您找到的大多数示例代码都是用 Objective-C 编写的，而且书籍往往是 Objective-C 的（尽管 Pragmatic Programmers 正在编写一[本 RubyCocoa 书籍](http://pragprog.com/titles/bmrc/rubycocoa)。大多数 Cocoa 应用程序都是用 Objective-C 编写的。

Objective-C 是动态的。[仔细看看](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/chapter_1_section_1.html)，它并不像人们想象的那样令人生畏。Cocoa 往往具有更陡峭的学习（或不学习）曲线。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-07T23:34:12.787

不，你不必学习可可，但它值得一看，因为它是一个非常强大的 api 并且有很好的文档记录，如果你已经知道 C，那么它非常容易（老实说，它是 - 我知道它在语法上看起来令人生畏）。

OS X 上桥接方法的问题在于它似乎非常不成熟，并且只为准备阅读与主要可可 api 相关文档的人设计。

老实说，如果您了解 c，您将通过一本书了解 obj-c 的基础知识，[Arron Hilligas](https://rads.stackoverflow.com/amzn/click/com/0321503619)的那本书（拼写？！？！）非常棒。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-08T06:03:58.773

如果你足够努力，你可以在不使用 Objective-C 的情况下制作软件，它有可能很棒，但最终它不会很好。你会花更多的时间试图让一种语言做一些它不是绝对擅长的事情。在 WWDC 上，我穿了一件衬衫，上面写着“学习 Objective-C 或退休”，这对一些仍然紧紧抓住 Pascal 生命的最后一根线的人来说并没有得到很好的理解，但重点是完全正确的——Objective C 是它在 Mac 上，假装不这样做是对自己的伤害。

话虽如此，您绝对不应该排除平台上用于扩展应用程序的桥梁——Bill Bumgarner[很快指出了](http://www.friday.com/bbum/2007/12/22/full-twisted-as-a-zip-for-leopard/)Twisted 网络框架通过 PyObjC 桥梁为 Cocoa 应用程序提供了多少功能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-21T20:47:39.147

当您使用 XCode 时，不使用脚本语言进行编程并不是那么糟糕。GDB集成非常好；我主要是一个 Perl 人，我发现 XCode 调试器非常好用并且非常易于使用。

“修复”功能的实用性会让您大吃一惊。想象一下在你的 ObjC 代码中发现一个错误，修复它，然后告诉调试器继续。它实际上在很多情况下都有效。

试试 objc。你可能会发现你比你想象的更喜欢它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-15T04:39:54.020

“必须”，嗯......从技术上讲，不。

由于大多数 Mac 应用程序工作都是通过 ObjC 完成的（我可能会添加一个很好的理由），所以我不会自欺欺人并学习它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-15T05:09:57.427

一定不行。您可以使用多种语言来制作漂亮的 GUI。这仅取决于平台的通常/最简单的解决方案是什么。在 Mac OS X 的情况下，Objective-C 和 AppKit 是非常容易使用的选择。但是，我有时会使用 REALBasic，这允许跨平台开发（当然，性能也会受到影响）。

所以真的取决于你想投入多少工作。如果您想真正进行认真的 Mac 开发，您应该学习 Objective-C。但是没有它你也能过得去......

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-12-03T03:04:45.380

不会。虽然 Apple 大力推动 Cocoa，但仍然支持 Carbon。它使用纯 C 代替。至于好看的 GUI，只需要使用 Interface Builder。

但是，我必须说 Objective-C 是一门很棒的语言。它真的很简单（这是我的第一语言）并且非常强大。

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2008-11-07T17:31:11.460

一般来说是的；但即使您（正确地恕我直言）排除了 Mono、GTK 和 SWING，因为它们不适合 GUI，请尝试 Qt。它非常尊重 Mac GUI 标准（ *HIG*：人机界面指南），并且可以在 C++、Python 和 Java 上同样编程。最后一个版本是基于 Cocoa 的，支持 64 位。

你从 Objective-C 中得到的 Qt 中唯一缺少的是那些糟糕的不符合 HIG 的现代 Apple 应用程序（是的，Aperture 和 Final Cut，我在看着你！）

# sql - 加快sql JOIN

> ID：272665
> 
> 赞同：2
> 
> 时间：2008-11-07T16:44:20.493
> 
> 标签：sql, sql-server, performance, join, sql-server-2000

首先，一些背景。

我们有一个订单处理系统，员工在应用程序中输入有关订单的计费数据，该应用程序将其存储在 sql server 2000 数据库中。这个数据库不是真正的计费系统：它只是一个保存位置，以便记录可以通过夜间批处理运行到大型机系统中。

此批处理是由外部供应商提供的罐装第三方包装。它应该做的部分工作是为任何被拒绝的记录提供报告。拒绝报告是手动处理的。

不幸的是，事实证明第三方软件并没有捕捉到所有的错误。我们有单独的进程将数据从大型机拉回数据库中的另一个表，并将拒绝的费用加载到另一个表中。

然后运行一个审计过程，以确保员工最初输入的所有内容都可以在某个地方进行说明。该审计采用我们运行的 sql 查询的形式，它看起来像这样：

```
SELECT *
FROM [StaffEntry] s with (nolock)
LEFT JOIN [MainFrame] m with (nolock)
    ON m.ItemNumber = s.ItemNumber 
        AND m.Customer=s.Customer 
        AND m.CustomerPO = s.CustomerPO -- purchase order
        AND m.CustPORev = s.CustPORev  -- PO revision number
LEFT JOIN [Rejected] r with (nolock) ON r.OrderID = s.OrderID
WHERE s.EntryDate BETWEEN @StartDate AND @EndDate
    AND r.OrderID IS NULL AND m.MainFrameOrderID IS NULL 
```

当然，这是经过大量修改的，但我相信重要的部分都得到了体现。问题是这个查询开始需要很长时间才能运行，我正试图弄清楚如何加快它。

我很确定问题是从`StaffEntry`表到`MainFrame`表的 JOIN。由于两者都保存了自一开始（本系统中为 2003 年）以来的每个订单的数据，因此它们往往有点大。表中使用的`OrderID`and`EntryDate`值在`StaffEntry`导入到大型机时不会保留，这就是连接稍微复杂一些的原因。最后，由于我要在`MainFrame`表中查找不存在的记录，所以在执行 JOIN 之后，我们`IS NULL`在 where 子句中有丑陋的东西。

该`StaffEntry`表由 EntryDate（集群）索引，并在 Customer/PO/rev 上单独索引。 `MainFrame`由客户和主机费用编号（集群，其他系统需要）和客户/PO/Rev 单独索引。 `Rejected`根本没有索引，但它很小，测试表明这不是问题。

所以，我想知道是否有另一种（希望更快）方式可以表达这种关系？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T16:50:21.043

首先，您可以摆脱第二个 LEFT JOIN。

无论如何，您的 WHERE 正在删除任何匹配项...例如，如果 S.OrderID 为 1 并且 R.OrderID 的值为 1，则 WHERE 中的 IS NULL 强制执行将不允许它。所以它只会返回 s.OrderID 为 NULL 的记录，如果我没看错的话......

其次，如果您要处理大量数据，添加 NOLOCK 表提示通常不会有任何影响。假设您不介意在这里或那里进行脏读的可能性：-P 通常值得冒险。

```
SELECT *
FROM [StaffEntry] s (nolock)
LEFT JOIN [MainFrame] m (nolock) ON m.ItemNumber = s.ItemNumber 
    AND m.Customer=s.Customer 
    AND m.CustomerPO = s.CustomerPO -- purchase order
    AND m.CustPORev = s.CustPORev  -- PO revision number
WHERE s.EntryDate BETWEEN @StartDate AND @EndDate
    AND s.OrderID IS NULL 
```

最后，你的问题的一部分对我来说不太清楚......

> “因为我在 MainFrame 表中查找不存在的记录，所以在执行 JOIN 之后，我们在 where 子句中有丑陋的 IS NULL。”

好的...但是您是否试图将其限制在那些 MainFrame 表记录不存在的地方？如果是这样，您也会希望在 WHERE 中表达它，对吗？所以像这样的事情......

```
SELECT *
FROM [StaffEntry] s (nolock)
LEFT JOIN [MainFrame] m (nolock) ON m.ItemNumber = s.ItemNumber 
    AND m.Customer=s.Customer 
    AND m.CustomerPO = s.CustomerPO -- purchase order
    AND m.CustPORev = s.CustPORev  -- PO revision number
WHERE s.EntryDate BETWEEN @StartDate AND @EndDate
    AND s.OrderID IS NULL AND m.ItemNumber IS NULL 
```

如果这就是您对原始语句的意图，也许您可​​以摆脱 s.OrderID IS NULL 检查？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T16:49:11.293

在您开始考虑更改查询之前，您应该确保所有表都有一个对这个查询和所有其他重要查询都有意义的聚集索引。在你的表上拥有聚集索引对于确保适当的性能在 sql server 中至关重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:49:54.430

这没有意义：

```
SELECT *
FROM [StaffEntry] s
LEFT JOIN [MainFrame] m ON m.ItemNumber = s.ItemNumber 
    AND m.Customer=s.Customer 
    AND m.CustomerPO = s.CustomerPO -- purchase order
    AND m.CustPORev = s.CustPORev  -- PO revision number
LEFT JOIN [Rejected] r ON r.OrderID = s.OrderID
WHERE s.EntryDate BETWEEN @StartDate AND @EndDate
    AND r.OrderID IS NULL AND s.OrderID IS NULL 
```

if `s.OrderID IS NULL`, then`r.OrderID = s.OrderID`永远不会为真，因此不会`[Rejected]`包含 from 的任何行，因此如给定的那样，它等效于：

```
SELECT *
FROM [StaffEntry] s
LEFT JOIN [MainFrame] m ON m.ItemNumber = s.ItemNumber 
    AND m.Customer=s.Customer 
    AND m.CustomerPO = s.CustomerPO -- purchase order
    AND m.CustPORev = s.CustPORev  -- PO revision number
WHERE s.EntryDate BETWEEN @StartDate AND @EndDate
    AND s.OrderID IS NULL 
```

您确定您发布的代码是正确的吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T16:56:04.087

除了 Kasperjj 的建议（我同意应该首先）之外，您可以考虑使用临时表来限制数据量。现在，我知道，我知道每个人都说要远离临时表。我*通常*会这样做，但有时值得一试，因为您可以使用这种方法大幅减少数据量；这使得整体查询更快。（当然，这确实取决于您可以缩小结果集的程度。）

我最后的想法是，有时您只需要尝试不同的方法来组合查询。这里的任何人都可能有太多变量无法给出答案....另一方面，这里的人很聪明，所以我可能是错的。

祝你好运！

问候， 弗兰克

PS：我忘了提到如果你想尝试这种临时表方法，你还需要在临时表上尝试不同的索引和主键。根据数据量，索引和 PK 会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T17:01:57.273

对所有表进行索引将很重要。如果您无法对连接中使用的 [MainFrame] 列进行索引，您还可以预先限制要在 [MainFrame] （和 [Rejected] 中搜索的行，尽管它看起来已经有PK）通过指定日期范围 - 如果日期窗口应该大致相似。这可以减少该连接的右侧。

我还将查看执行计划，并对您的哪个`JOIN`s 确实最昂贵进行简单的黑盒评估 -`m`或者`r`，仅使用一个或另一个对查询进行基准测试。我怀疑这是`m`因为多列和缺少有用的索引。

您可以在您的范围内的几天或几个月内使用 m.EntryDate。但是如果您已经在 Mainframe 上有索引，问题是为什么不使用它们，或者如果它们正在使用，为什么性能这么慢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T23:20:23.593

尝试将 LEFT JOIN [Rejected] r with (nolock) ON r.OrderID = s.OrderID 更改为 RIGHT MERGE JOIN：

```
SELECT ...
FROM [Rejected] r
     RIGHT MERGE JOIN [StaffEntry] s with (nolock) ON r.OrderID = s.OrderID
     LEFT JOIN [MainFrame] m with (nolock) ON.... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T17:31:10.397

**更新：**
如果还不是很明显，我在原始问题的代码中犯了一个错误。现在已经解决了，但不幸的是，这意味着这里的一些更好的响应实际上是完全错误的方向。

我还更新了一些统计信息：我可以通过严格限制与`StaffEntry.EntryDate`. 不幸的是，我之所以能做到这一点，是因为在运行了很长时间之后，我才确切地知道我关心哪些日期。我通常不会提前知道。

最初运行的执行计划显示，对表进行聚集索引扫描的成本为 78%，对`StaffEntry`表进行索引查找的成本为 11% `MainFrame`，而连接本身的成本为 0%。使用较窄的日期范围运行它，对于 的索引搜索更改为 1%，`StaffEntry`对于“MainFrame”的索引搜索更改为 1%，对于表扫描更改为 93% `Rejected`。这些是“实际”计划，不是估计的。

# .net - .Net Remoting 返回值 区分来自不同线程的调用

> ID：272671
> 
> 赞同：0
> 
> 时间：2008-11-07T16:46:38.570
> 
> 标签：.net, multithreading, remoting

我继承了一个有一些多线程问题的中间层系统。
两个不同的线程，在一个类的同一个实例的同一个方法中运行，正在对一个 .Net Remoting 服务器进行相同的调用......

客户端的代理是否知道如何将远程服务器的返回值路由到正确的线程？是否为每个线程的调用创建了单独的客户端代理，即使它们是从同一个实例调用的？客户端的代理（或代理）是否知道如何将远程服务器的返回值路由到正确的线程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-07T16:51:15.953

远程处理将自动将每次调用的返回路由到调用线程。除了正常的多线程问题之外，您无需担心它。只需将它们视为正常的方法调用即可。

您是遇到特定问题还是只是担心？

# java - 什么是类似于哈希表但不经常使用的键被删除的数据结构？

> ID：272674
> 
> 赞同：11
> 
> 时间：2008-11-07T16:47:29.940
> 
> 标签：java, algorithm, data-structures, caching

我正在寻找一种类似于哈希表的数据结构，但该表有大小限制。当哈希中的项目数达到大小限制时，应该调用一个剔除函数来去除表中检索最少的键/值对。

这是我正在处理的一些伪代码：

```
class MyClass {
  private Map<Integer, Integer> cache = new HashMap<Integer, Integer>();
  public int myFunc(int n) {
    if(cache.containsKey(n))
      return cache.get(n);
    int next = . . . ; //some complicated math.  guaranteed next != n.
    int ret = 1 + myFunc(next);
    cache.put(n, ret);
    return ret;
  }
} 
```

`n`发生的情况是，其中一些值`myFunc()`将被调用很多次，但许多其他值`n`只会被计算一次。因此，缓存可能会填满数百万不再需要的值。我想有一种方法让缓存自动删除不经常检索的元素。

这感觉像是一个必须已经解决的问题，但我不确定我将使用什么数据结构来有效地解决它。谁能指出我正确的方向？

* * *

**更新**我知道这一定是一个已经解决的问题。它被称为 LRU 缓存，通过扩展 LinkedHashMap 类很容易实现。这是包含该解决方案的代码：

```
class MyClass {
  private final static int SIZE_LIMIT = 1000;
  private Map<Integer, Integer> cache =
    new LinkedHashMap<Integer, Integer>(16, 0.75f, true) {
      protected boolean removeEldestEntry(Map.Entry<Integer, Integer> eldest)
      {
        return size() > SIZE_LIMIT;
      }
  };
  public int myFunc(int n) {
    if(cache.containsKey(n))
      return cache.get(n);
    int next = . . . ; //some complicated math.  guaranteed next != n.
    int ret = 1 + myFunc(next);
    cache.put(n, ret);
    return ret;
  }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-07T16:58:31.807

您正在寻找`LRUList`/ `Map`。签出`LinkedHashMap`：

当新的映射被添加到映射时，该`removeEldestEntry(Map.Entry)`方法可以被覆盖以施加用于自动移除陈旧映射的策略。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T16:58:16.987

谷歌搜索“LRU 地图”和“我感觉很幸运”会给你这个：

[http://commons.apache.org/proper/commons-collections//javadocs/api-release/org/apache/commons/collections4/map/LRUMap.html](http://commons.apache.org/proper/commons-collections//javadocs/api-release/org/apache/commons/collections4/map/LRUMap.html)

> 具有固定最大大小的 Map 实现，如果在满时添加条目，则删除最近最少使用的条目。

听起来很不错:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:55:32.733

WeakHashMap 可能不会像您期望的那样做...仔细阅读文档并确保您从弱引用和强引用中准确了解您的内容。

我建议您查看 java.util.LinkedHashMap 并使用它的 removeEldestEntry 方法来维护您的缓存。如果您的数学非常耗费资源，您可能希望在使用条目时将它们移到前面，以确保只有未使用的条目落到集合的末尾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T17:18:35.230

[自适应替换缓存](http://www.usenix.org/publications/library/proceedings/fast03/tech/megiddo.html)策略旨在防止一次性请求污染您的缓存。这可能比您要寻找的要好，但它确实直接解决了您“填充不再需要的值”的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T16:48:11.217

看看**WeakHashMap**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T17:03:49.720

您可能希望为您的地图实施最近最少使用策略。在 LinkedHashMap 之上有一个简单的方法：

[http://www.roseindia.net/java/example/java/util/LRUCacheExample.shtml](http://www.roseindia.net/java/example/java/util/LRUCacheExample.shtml)

# javascript - 仅打印文本区域

> ID：272676
> 
> 赞同：6
> 
> 时间：2008-11-07T16:48:11.437
> 
> 标签：javascript, printing, textarea, printing-web-page

我想*只*打印网站页面中 textarea 元素的内容。特别是，我想确保文本区域的边界不会剪裁任何内容，因为内容会非常大。

解决这个问题的最佳策略是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T16:50:12.960

制作一个打印样式表，其中*除*textarea 之外的所有元素都在 CSS 中设置为 display: none;，对于 textarea，overflow: visible。

将其链接到页眉中的链接标记设置为 media="print" 的页面。

你完成了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T16:50:20.963

使用设置为打印的媒体制作不同的 CSS

```
<link rel="stylesheet" type="text/css" href="print.css" media="print" /> 
```

[http://webdesign.about.com/cs/css/a/aa042103a.htm](http://webdesign.about.com/cs/css/a/aa042103a.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T16:50:53.037

如果用户单击“打印”，您可以在空白页上打开一个仅包含文本区域内容的新窗口并从那里开始打印，然后关闭该窗口。

**更新**：我认为建议的 CSS 解决方案可能是更好的策略，但如果有人喜欢这个建议，他们仍然可以投票。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T16:56:16.287

我会考虑其他建议的组合。

不要用样式表覆盖来杀死整个页面的打印按钮，而是通过文本区域提供一个按钮，让用户只打印那些内容。

该按钮将打开一个新窗口，其中包含菜单/chrome 等，并仅克隆 textarea 内容（和或提供打印 css 文件）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T20:54:26.307

我制作了一个印刷媒体 CSS 来隐藏一些字段。由于我使用的是动态创建 IFRAME 的 nicEdit，问题变得复杂了。所以我必须添加一个事件，该事件接受 onblur 事件并将它们复制到隐藏（打印除外）Div。“divtext”是隐藏的Div，“storyText”是TextArea。

```
textarea {
  display: none;
}

*/ #divtext {
  display: block;
}

div, DIV {
  border-style: none !important;
  float: none !important;
  overflow: visible !important;
  display: inline !important;
}

/* disable nearly all styles -- especially the nicedit ones! */

#nav-wrapper, #navigation, img, p.message, .about, label, input, button, #nav-right, #nav-left, .template, #header, .nicEdit-pane, .nicEdit-selected, .nicEdit-panelContain, .nicEdit-panel, .nicEdit-frame {
  display: none !important;
}

/*hide Nicedit buttons    */

.nicEdit-button-active, .nicEdit-button-hover, .nicEdit-buttonContain, .nicEdit-button, .nicEdit-buttonEnabled, .nicEdit-selectContain, .nicEdit-selectControl, .nicEdit-selectTxt {
  display: none !important;
} 
```

nicEdit 的 javascript 代码：

```
<script type="text/javascript" src="/media/nicEdit.js"></script>
<script type="text/javascript">
  bkLib.onDomLoaded(function () {
    var nic = new nicEditor({
      fullPanel: true
    }).panelInstance('storyText');

    document.getElementById("storyText").nic = nic;
    nic.addEvent('blur', function () {
      document.getElementById("storyText").value = 
      nic.instanceById('storyText').getContent();
      document.getElementById("divtext").innerHTML = nic.instanceById('storyText').getContent();
    });
  });
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-29T14:19:41.397

是否溢出：可见；在 textarea 上实际上对你们中的任何人有用吗？FF3 似乎忽略了打印表中 textarea 的该规则。并不是说它是一个错误或任何东西。

# sql-server-2005 - 在 SQL Server 2005 中对 PDF 文件使用全文搜索

> ID：272694
> 
> 赞同：7
> 
> 时间：2008-11-07T16:51:41.040
> 
> 标签：sql-server-2005, search, pdf, indexing, full-text-search

我在 SQL Server 2005 中索引 PDF 文件时遇到了一个奇怪的问题，希望有人能提供帮助。我的数据库有一个名为 MediaFile 的表，其中包含以下字段 - MediaFileId int identity pk、FileContent image 和 FileExtension varchar(5)。我的 Web 应用程序在此表中存储文件内容没有问题，并且能够在 doc、xls 等上毫无问题地使用全文搜索 - 唯一不工作的文件扩展名是 PDF。在此表上对我知道存在于表中保存的 PDF 文件中的单词执行全文搜索时，这些文件不会在搜索结果中返回。

操作系统是 Windows Server 2003 SP2，我安装了[Adob​​e iFilter 6.0](http://www.adobe.com/support/downloads/detail.jsp?ftpID=2611)。按照[此博客条目](http://weblogs.asp.net/wallym/archive/2005/02/28/382060.aspx)上的说明，我执行了以下命令：

```
exec sp_fulltext_service 'load_os_resources', 1;
exec sp_fulltext_service 'verify_signature', 0; 
```

之后，我重新启动了 SQL Server，并通过执行以下命令验证了用于 PDF 扩展的 iFilter 已正确安装：

```
select document_type, path from sys.fulltext_document_types where document_type = '.pdf' 
```

这将返回以下信息，看起来正确：

> 文档类型：.pdf
> 路径：C:\Program Files\Adobe\PDF IFilter 6.0\PDFFILT.dll

然后我（重新）在 MediaFile 表上创建索引，选择 FileContent 作为要索引的列，选择 FileExtension 作为其类型。向导创建索引并成功完成。为了测试，我正在执行这样的搜索：

```
SELECT MediaFileId, FileExtension FROM MediaFile WHERE CONTAINS(*, '"house"'); 
```

这将返回包含该术语的 DOC 文件，但不返回任何 PDF 文件，尽管我知道表中肯定有包含单词*house*的 PDF 文件。

顺便说一句，我让这个工作了几分钟，上面的搜索返回了正确的 PDF 文件，但后来它又无缘无故地停止工作了。

关于什么可能阻止 SQL Server 2005 索引 PDF 的任何想法，即使安装了 Adob​​e iFilter 并且似乎已加载？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T22:20:17.987

谢谢伊万。通过从头开始一切，最终成功地完成了这项工作。看起来事情完成的顺序有很大的不同，链接博客上给出的在加载 iFilter 后关闭“load_os_resources”设置的建议可能不是最好的选择，因为这会导致 iFilter SQL Server 重新启动时不会加载。

如果我没记错的话，最终对我有用的步骤顺序如下：

1.  确保该表还没有索引（如果有，请将其删除）
2.  安装 Adob​​e iFilter
3.  执行命令 exec sp_fulltext_service 'load_os_resources', 1;
4.  执行命令 exec sp_fulltext_service 'verify_signature', 0;
5.  重新启动 SQL Server
6.  验证 PDF iFilter 是否已安装
7.  在表上创建全文索引
8.  做完整的重新索引

虽然这起到了作用，但我很确定在它最终开始正常工作之前我执行了几次这些步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T22:20:29.860

我刚刚挣扎了一个小时，但终于让它工作了。我做了你所做的一切，所以试着简化查询（我`*`用字段名替换并删除了术语上的双引号）：

```
SELECT MediaFileId, FileExtension FROM MediaFile WHERE CONTAINS(FileContent, 'house') 
```

此外，当您创建全文索引时，请确保指定语言。最后一件事是也许您可以尝试将字段类型从 更改`Image`为`varbinary(MAX)`。

# mysql - Binlog MySQL 复制是一个“伤害包”。有什么好的选择吗？

> ID：272704
> 
> 赞同：6
> 
> 时间：2008-11-07T16:54:55.993
> 
> 标签：mysql, replication, binlog

老实说[，](https://stackoverflow.com/questions/3798/full-complete-mysql-db-replication-ideas-what-do-people-do)[我左右](https://stackoverflow.com/questions/8166/mysql-replication-if-i-dont-specify-any-databases-will-logbin-log-everything)[尝试](https://stackoverflow.com/questions/30660/mysql-binary-log-replication-can-it-be-set-to-ignore-errors)[过](https://stackoverflow.com/questions/35420/mysql-software-any-suggestions-to-oversee-my-mysql-replication-server) [，](https://stackoverflow.com/questions/8365/mysql-administrator-backups-compatibility-mode-what-exactly-is-this-doing) 但仍然发现我的镜像服务器设置为复制从属服务器仍然落后。我的应用程序的用户群不断增长，现在我已经到了无法继续“关闭”以“重新同步”数据库的地步（即使在周末也不行）。

无论如何，我的问题是：是否有任何合理的、**负担得起**的替代二进制日志复制的方法？我有两台服务器，所以暂时不会考虑购买第三台用于负载平衡，除非它是唯一的选择。

干杯，

/mp

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-07T19:59:31.253

你的主人并行执行，你的奴隶串行执行。如果您的 master 可以在 1 个真实小时内处理 1.5 小时的插入/更新/执行，那么您的 slave 将落后。

如果您找不到提高从属设备写入性能的方法（更多内存、更快的磁盘、删除不必要的索引），那么您的应用程序架构就遇到了限制。最终你会遇到一个点，你不能像你的主人可以并行执行它们那样快速地实时执行更改。

许多大型站点将其数据库分片：考虑将您的主+从分成多个主+从集群。然后将您的客户群拆分到这些集群中。当一个奴隶开始落后时，是时候添加另一个集群了。

这并不便宜，但除非你能找到一种方法让 binlog 复制并行执行语句，否则你可能找不到更好的方法。

**更新（2017 年）**：MySQL 现在支持[并行从属工作线程](https://dev.mysql.com/doc/refman/5.7/en/replication-options-slave.html#sysvar_slave_parallel_workers)。仍然有很多变量会导致从机落后，但是从机不再需要按串行顺序写入。选择保留并行从属线程的提交顺序是查看从属在任何时间点的确切状态是否至关重要的重要选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-07T17:07:23.883

您是否尝试过：1) SET innodb_flush_log_at_trx_commit=0 2) SET sync_binlog=0

如果您的服务器出现故障，两者都将有助于加速您的从站，但增加的风险很小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-20T22:34:12.807

向从站添加内存可能会有所帮助。我们从 32 到 128 兆，滞后或多或少消失了。但它既不便宜，也不在所有情况下都足够。

购买第三台服务器可能不会有太大帮助，您很可能只会得到另一个滞后的奴隶。

# visual-studio-2008 - 如何更改 Visual Studio 2008 中注释栏中使用的颜色？

> ID：272708
> 
> 赞同：1
> 
> 时间：2008-11-07T16:55:22.687
> 
> 标签：visual-studio-2008, annotate

我在 Visual Studio 2008 中使用自定义配色方案。注释栏（显示谁检查了每个代码块以及何时检查）以一些难以辨认的颜色呈现。我无法在相关的“选项”对话框中识别这些颜色，因此我无法将它们更改为更清晰的颜色。

有人知道如何改变这些颜色吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-27T20:57:15.083

注释仅通过 TFS 在 Visual Studio Team System 中可用。有时可能很难阅读，因为背景是渐变色，根据您的设置，渐变色可能会褪色为与字体相同的颜色。

不幸的是，没有办法专门更改注释栏的字体和背景。当您更改选项中的字体和颜色时，注释将随着文本编辑器中的设置而更改。

我可以看到您有两个选项： 1\. 更改工具/选项/字体和颜色中的设置，使纯文本的背景与注释中的字体颜色形成强烈对比，或放大字体大小。这些更改将影响注释栏的背景渐变和字体大小。**2\. 您可以下载 Team Foundation Server Power Tools 并使用tfpt annotate**在命令行上访问此信息。

# visual-studio - 在 VS 2008 安装项目中设置制造商

> ID：272717
> 
> 赞同：14
> 
> 时间：2008-11-07T16:56:14.057
> 
> 标签：visual-studio, visual-studio-2008, installation, windows-installer

我有一个安装服务的 Windows 安装项目。除了一件事之外，一切都很好：安装期间提供给用户的默认目录的格式为“C:\Program Files\Microsoft\ProgramName”。我正在尝试修改它，以便我们使用公司名称而不是“Microsoft”。

我找到了安装项目的应用程序文件夹属性，它的 DefaultLocation 属性为“[ProgramFilesFolder][Manufacturer][ProductName]”。所以，看起来我需要做的就是设置“制造商”属性，我就准备好了。但是，我找不到设置此属性的方法！我曾希望它会从主要输出项目的 AssemblyInfo 中的公司名称中获取它，但它没有。

我可以从 DefaultLocation 中删除“[Manufacturer]”并将其替换为我们的文字公司名称，但这似乎是一个 hack。

如何设置制造商名称？

请注意，我没有使用成熟的 WiX 项目。我只是在我的解决方案中添加了一个 Windows 设置项目。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-07T16:59:29.760

在 Visual Studio 中单击您的设置项目，打开属性，您会注意到您可以设置许多属性，例如制造商、SupportURL 等。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-27T08:02:33.470

请注意，如果您在做这件看似微不足道的事情时感到困惑/沮丧：如果您通过右键单击项目并单击鼠标右键菜单中的“属性”来打开属性，您将得到错误的对话框。您需要选择项目，然后导航到属性标签。导航到属性标签的一种方法是从“查看”菜单中选择“属性窗口”。

# c# - 如何为两个 nHibernate 会话维护一个对象？

> ID：272719
> 
> 赞同：6
> 
> 时间：2008-11-07T16:56:18.690
> 
> 标签：c#, multithreading, nhibernate

我正在构建一个像这样工作的多线程系统：

虽然有实体：

1.  从 nHibernate 获取实体（使用当前会话）

2.  启动一个将与此实体一起使用的新线程*

当我启动这个新线程时，它需要有一个新的 Session，因为 nHibernate 不是线程安全的。我创建了它，但之前检索到的实体不适用于此会话。

今天我正在解决这种情况，从 nHibernate 中检索一个传递 id 的新实体。但这很昂贵，我试图节省一些时间来实现我的 SLA。

有什么方法可以将此对象链接到这个新会话而无需进行新的数据库调用？另一个会话不会关闭，它们都将打开，直到应用程序结束。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T17:06:22.430

如果您正在使用分离的对象，则必须将它们重新附加到会话。如果您拥有正在使用的对象的正确 Hibernate id，则可以执行此操作，调用 get，然后将您的副本与刚刚放入会话的 Hibernate 合并。但是，请确保使用合并，因为 saveOrUpdate() 不会删除分离对象中缺少的任何子对象，只需添加新子对象并将更改保存到现有子对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T17:16:01.020

除了 Evict + Lock 之外，您还可以使用 2:nd 级缓存来重建实体而无需访问数据库。我不知道它是否适合您的应用程序，但我也认为只要第一个线程停止对其进行更改，就可以将会话传递给另一个线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T16:26:45.130

在连接到另一个线程之后，我将它从第一个线程中分离出来。

# paperless - 促进无纸化环境的最佳方式是什么？

> ID：272722
> 
> 赞同：5
> 
> 时间：2008-11-07T16:56:38.173
> 
> 标签：paperless

现代办公室的一个问题是人们仍然倾向于创建数字媒体的物理副本（例如程序手册和规范）。我知道对于某些事情，创建物理副本是谨慎的做法，但其中许多物理副本大多未使用，它们只是放在架子上，也许有一天会被翻阅以查找一条信息。这不仅浪费纸张，而且还浪费空间和打印和整理所有这些打印文档所需的时间。它还需要更多时间来利用，因为这些项目不能像数字副本那样被索引和搜索。

在工作场所推广无纸化环境有哪些好方法？我的公司已经实施了公司 Wiki。到目前为止，它似乎对我们对纸张的使用产生了影响，但有些人仍然认为这太麻烦了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T17:20:51.853

当然，它并不适合所有人，但我最近在一家没有打印机和复印机的小型 Web 开发公司（员工不到 25 人）工作了一年。只有主人在他上锁的办公室里有一台小打印机。由于他们从来没有任何打印机或复印机，他们的工作模式已经演变为不使用纸张。

这对我来说太震惊了，因为我传统上使用大量纸张。我用它来部分控制我自己的工作流程——如果需要完成，我的办公桌上有一张纸（电子邮件、Word 文档、打印出来的错误跟踪任务）关于它。我会在文档上记下完成任务所需的步骤。

当然，我们使用了错误跟踪/变更控制系统。所以，我所有的网络编码任务都在那个系统中。

我学会了更好地组织我的电子邮件，并在 Windows 中拥有良好的文件夹结构。具有讽刺意味的是，我对删除不必要的电子文档更加谨慎。我只保留有用的东西。我的电子邮件收件箱总是空的，因为所有东西都被迅速移到了一个文件夹中。

每个人的桌子都很干净，我们没有文件抽屉。我们确实都有至少两台显示器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T17:00:36.950

以电子方式分发文档（例如 Sharepoint）并向人们收取打印费用。确保人们拥有漂亮的大屏幕，以便他们可以轻松地阅读屏幕和 LCD 上的文本，这样刷新率就不会伤害他们的眼睛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T17:01:31.613

摆脱打印机。

严重地。

我意识到这不现实。我试图帮助我妻子的商店实现无纸化，而那只有 4 名员工，但因为打印机还在，他们就不会这样做。这有助于我将所有工作站上的默认打印机设置为使用 PDF 编写器打印驱动程序打印到 Windows 共享，这样一些问题就解决了（我们在她的办公室里有几盒每日销售报告，幸运的是这些报告不再生成）。

我的公司将笔记本电脑带到我们周一的状态会议上，然后分发了议程的打印副本（我们都有一份电子邮件副本）。你真的赢不了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T17:25:47.787

正如其他人所提到的，您可能不会赢，但如果您的总体倾向是环保，可以在我朋友的博客上找到提示和技巧：

[绿色用户组](http://greentug.spaces.live.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T19:13:35.293

不。

我发现当我可以将手册或编程参考放在我旁边的桌子上打开而不是在它和 Eclipse 以及我一次打开的所有其他东西之间来回切换时，拥有手册或编程参考会更有用。此外，我喜欢在所有地方都贴上便利贴，在重要段落下划线等。失去 grep 文档的能力真的不是问题。如果它是我熟悉的参考文献，我将毫无问题地找到我需要的段落，然后它会很方便地放在我的桌子上，我只是扫视而不是在屏幕上四处移动窗口。

如果出于某种原因，这是您真正需要做的事情，请摆脱打印机，并为您的开发人员提供两到三个大型 LCD。我认为更好的选择是将打印机设置为自动双面打印，并在复印室提供梳状活页夹。这将鼓励人们将打印输出视为“书籍”，而不是最终在某个时候被扔掉的一沓纸。他们没有在完成后将包扔掉，而是放在书架上，当他们意识到仍然需要它时，他们会再次将其拉出，而不是打印另一份。

如果您非常关心“绿色”，请购买再生纸，并拥有比垃圾桶更多的回收箱。让回收比扔掉更容易。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T19:15:58.313

去给自己买一个非常好的文档扫描仪。您将始终有一些传入的纸张，如果您可以轻松地将它们转换为数字，那将有很大帮助。我推荐富士通 ScanSnap 510。

并确保你有非常好的该死的备份:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T17:06:24.053

这一切都取决于个人喜好。有些人喜欢在电脑屏幕上阅读。但有些人可能不喜欢屏幕。他们倾向于把所有可能的事情都打印出来。

IMO可以推广使用双面打印。事实上，在同一张 A4 纸上打印多页。这应该将浪费减少到一定程度。

否则，我知道一家公司会发布每周在工作区域获得最多打印输出的人员名单。这肯定会阻止一些只是为了打印出来而打印出来的人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T18:27:53.967

仅仅因为您不喜欢使用纸张并不意味着其他人都可以以这种方式有效地工作。我们中的一些人有时会发现屏幕难以阅读。我最近去世的男朋友无法读取小于 800X600 的分辨率。这意味着您在屏幕上一次看不到太多东西。

就我个人而言，如果我想在一个长的存储过程中找到一个缺失的一端应该去哪里，我发现通过打印整个东西并以这种方式查看它可以更快地看到它。另外，我发现在一张纸上做笔记比在电子文档上做笔记更方便。

此外，我阅读速度非常快，在纸上阅读文档的速度可能比在屏幕上快 3-4 倍（部分原因是我不必停下来滚动）。是的，我有一个足够大的显示器，一次可以看到一整页，但是用我的双光眼镜，当字体那么小时，我实际上无法阅读它。当大型文档的纸张速度更快时，我为什么要浪费时间在屏幕上阅读？而且，如果我需要在阅读时在页面之间来回引用，翻到一个页面比通过电子方式搜索要快得多。

请记住，并非每个人都拥有许多开发人员拥有的大型显示器或双显示器。因此，当他们需要在阅读时来回参考时，他们一次在屏幕上看不到太多内容，也看不到同时拉出的文件的两页。

所以基本上我要说的是，无纸化办公室对许多人来说效率较低，这就是它们不受欢迎的原因。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-07T18:29:41.467

火。

（抱歉无法抗拒）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-07T18:38:20.810

摆脱打印机和复印机将迫使每个人都无纸化，但我认为这不是一个理想的解决方案。我建议改为建立一个好的回收计划。纸张很容易回收。今天，大多数纸张也来自管理的森林。对环境的影响很小。还要获得一些好的扫描仪、OCR 软件，并设置具有大量存储空间的服务器作为虚拟文件柜。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-07T19:17:00.420

我喜欢纸，我认为它是阅读的最佳表面。在我看来，你不应该禁止印刷——或者强迫办公室无纸化。

相反，也许你可以鼓励重用。打印并阅读文档后 - 将其分发给可能也需要它的同事。“循环信封”（因为想要一个更好的名字）是许多传统办公环境的一个特点，在这方面非常好。

也可以双面打印。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-07T19:19:43.143

首先，每个人都需要使用 LCD，因为它更容易读取。

其次，告诉每个人他们可以获得第二个 LCD，前提是他们承诺不在 LCD 上打印他们可以阅读的内容。

还就如何有效地使用两台显示器进行简短的课程。（大多数情况下，一个用于主要工作，第二个用于阅读）

# sql - 存储过程在特定用户上失败

> ID：272726
> 
> 赞同：3
> 
> 时间：2008-11-07T16:58:01.307
> 
> 标签：sql, sql-server, asp-classic, timeout, sql-server-2000

我有一个存储过程不断失败，并在特定用户上显示错误消息“超时已过期”。

所有其他用户都能够很好地调用 sp，甚至我也能够使用查询分析器正常调用 sp——它只需 10 秒即可完成。但是对于有问题的用户，日志显示 ASP 总是挂起大约 5 分钟，然后超时中止。

我像这样从 ASP 页面调用“ `EXEC SP_TV_GET_CLOSED_BANKS_BY_USERS '006111'`”

有人知道如何诊断问题吗？我已经尝试查看数据库中的死锁，但没有找到任何死锁。

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T08:13:13.753

一些想法...

阅读评论表明参数嗅探导致了问题。

*   对于其他用户，缓存的计划足以满足他们发送的参数
*   对于这个用户，缓存的计划可能是错误的

如果此用户的行数远多于其他用户，或者在另一个表中有行（因此不同的表/索引查找/扫描会更好），则可能会发生这种情况

测试参数嗅探：

*   在调用或 def 中使用 RECOMPILE（临时）。对于复杂的查询，这可能会很慢
*   超时后重建索引（或只是统计信息）并重试。这会使所有缓存的计划无效

修复：屏蔽参数

```
DECLARE @MaskedParam varchar(10)
SELECT @MaskedParam = @SignaureParam

SELECT...WHERE column = @MaskedParam 
```

只需谷歌“参数嗅探”和“参数屏蔽”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T18:51:33.997

我想要回答你的问题，我们可能需要更多信息。

例如，您是否使用 Active Directory 来验证您的用户？您是否使用过 SQL 探查器进行调查？听起来这可能是一个身份验证问题，SQL Server 在验证此特定用户时遇到问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T18:57:18.290

对我来说听起来像一个死锁问题..

还要确保此用户在 SQL Server 中具有执行权限和读取权限

但是，如果当时正在写入信息，因为它试图被读取，您将死锁，因为事务尚未提交。

Jeff 写了一篇很棒的文章，讲述了他在这方面和 stackoverflow 方面的经验。 [http://www.codinghorror.com/blog/archives/001166.html](http://www.codinghorror.com/blog/archives/001166.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T04:15:02.097

Couple of things to check:

1.  Does this happen only on that specific user's machine? Can he try it from another machine? - it might be a client configuration problem.
2.  Can you capture the actual string that this specific user runs and run it from an ASP page? It might be that user executes the SP in a way that generates either a loop or a massive load of data.
3.  Finally, if you're using an intra-organization application, it might be that your particular user's permissions are different than the others. You can compare them at the Active Directory level.

Now, I can recommend a commercial software that will definitely solve your issue. It records end-to-end transactions, and analyzes particular failures. But I do not want to advertise in this forum. If you'd like, drop me a note and I'll explain more.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T12:41:46.597

好吧，我建议您使用 SQL Server Profiler 并打开一个新会话。从您的 ASP 页调用您的存储过程，看看发生了什么。虽然这可能无法解决您的问题，但它肯定可以为您提供一个起点，让您自己进行一些“调查”。

# sql-server - SQL Server Profiler - 如何过滤跟踪以仅显示来自一个数据库的事件？

> ID：272730
> 
> 赞同：405
> 
> 时间：2008-11-07T16:58:32.303
> 
> 标签：sql-server, profiler, sql-server-profiler

如何将 SQL Server Profiler 跟踪限制到特定数据库？我看不到如何过滤跟踪以看不到我连接到的实例上所有数据库的事件。

* * *

## 回答 #1

> 赞同：616
> 
> 时间：2008-11-07T17:10:29.690

在跟踪属性 > 事件选择选项卡 > 选择显示所有列。现在在列过滤器下，您应该会看到数据库名称。输入 Like 部分的数据库名称，您应该只看到该数据库的跟踪。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-11-07T18:35:26.383

在 SQL 2005 中，您首先需要在跟踪中显示数据库名称列。最简单的做法是选择已经添加了该列的 Tuning 模板。

假设您选择了 Tuning 模板，以进行过滤：

*   单击“事件选择”选项卡
*   单击“列过滤器”按钮
*   选中显示所有列（右侧向下）
*   选择“DatabaseName”，单击右侧窗格中 Like 旁边的加号，然后键入您的数据库名称。

我也总是将跟踪保存到一个表中，这样我就可以在事后对跟踪数据进行 LIKE 查询。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-03T13:37:18.687

通过实验，我能够观察到这一点：

当 SQL Profiler 2005 或 SQL Profiler 2000 与驻留在 SQLServer 2000 中的数据库一起使用时 - 提到的问题仍然存在，但是当 SQL Profiler 2005 与 SQLServer 2005 数据库一起使用时，它可以完美运行！

总之，这个问题似乎在 SQLServer 2000 中很普遍，并在 SQLServer 2005 中得到纠正。

处理 SQLServer 2000 时问题的解决方案是（正如 wearejimbo 所解释的）

1.  通过查询 sysdatabases 表来确定要过滤的数据库的 DatabaseID，如下所示

    ```
    SELECT * 
    FROM master..sysdatabases 
    WHERE name like '%your_db_name%'   -- Remove this line to see all databases
    ORDER BY dbid 
    ```

2.  在 SQL Profiler 2000 的 New Trace 窗口中使用 DatabaseID 过滤器（而不是 DatabaseName）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-07-21T12:45:25.733

在 Trace 属性中，单击*General*旁边顶部的*Events Selection*选项卡。然后单击右下角的*列过滤器...。*然后，您可以选择要过滤的内容，例如或。**`TextData``DatabaseName`**

 **展开*Like*节点并使用百分号`%`（如`%MyDatabaseName%`或）输入过滤器`%TextDataToFilter%`。没有`%%`标志，过滤器将无法工作。

此外，请确保选中复选框*排除不包含值的行'*如果找不到要过滤的字段，例如`DatabaseName`转到*常规*选项卡并更改*模板*，则空白应包含所有字段。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-30T21:47:50.407

创建一个新模板并检查 DBname。为您的跟踪文件使用该模板。

# css - 在 FF 中引入动态生成的（不是静态文件）CSS？

> ID：272738
> 
> 赞同：1
> 
> 时间：2008-11-07T17:01:06.183
> 
> 标签：css, firefox, firefox-3, dynamic-css

有没有办法将 CSS 样式表拉入不是静态文件的 FireFox 2 或 3？

Bellow 是我们用来拉入由 CGI 脚本动态生成的样式表的代码。

```
<link rel="stylesheet" href="/cgi-bin/Xebra?ShowIt&s=LH4X6I2l4fSYwf4pky4k&shw=795430-0&path=customer/DEMO/demo1.css" type="text/css"> 
```

/cgi-bin/Xebra?ShowIt&s=LH4X6I2l4fSYwf4pky4k&shw=795430-0&path=customer/DEMO/demo1.css

**请注意，上面拉入 CSS 的 URL 不以 .css 结尾，而是以参数结尾。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T17:04:51.043

服务器的内容类型是否与提供的文件正确？

```
Content-type: text/css 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T17:07:02.320

为什么这不起作用？仔细检查 cgi 脚本的响应标头是否包含

```
Content-Type: text/css 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T17:07:21.180

扩展名无关紧要，但您应该确保内容类型是**"text/css"**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T17:08:32.223

我过去做过同样的事情——[前雇主的网站](http://support.specorp.com)使用的链接标签与你的非常相似，并且至少在 FF2 中运行良好（我刚刚检查过它，尽管我在添加该链接时在 FF 中对其进行了测试）。如果它不起作用，我怀疑它与生成的 CSS 文件有关，而不是与导入页面有关。共识似乎是来自服务器的 Content-Type 可能是错误的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T17:08:53.500

您的服务器进程（如 CGI）首先运行，不是吗？在我看来，该链接标签只会拉入已经存在的文件。

所以我要做的是在 href 中放置一个服务器标签（我的 lang 的 ASP/ASP.Net，但你可以使用 PHP 或任何东西，真的）。

像这样：

```
<link rel="stylesheet" type="text/css href="<% =getStylesheetPath() %>" media="all"> 
```

试一试。

# c++ - 杀死一个阻塞的 Boost::Thread

> ID：272750
> 
> 赞同：20
> 
> 时间：2008-11-07T17:04:06.537
> 
> 标签：c++, iostream, boost-thread

我正在编写一个阻止来自两个输入的应用程序`istreams`。

从任何一个读取`istream`都是同步（阻塞）调用，因此，我决定创建两个`Boost::thread`s 来进行读取。

这些线程中的任何一个都可以到达“结束”（基于接收到的一些输入），一旦到达“结束”，两个输入流都会停止接收。不幸的是，我不知道哪个会这样做。

因此，我不能`join()`同时处理两个线程，因为只有一个线程（无法预先确定哪个线程）将实际返回（解除阻塞）。

我必须以某种方式强制对方退出，但它在等待输入时被阻塞，所以它不能自己决定是时候返回（条件变量或其他）。

他们是一种方法吗：

*   向 boost::thread 发送信号，或
*   强制一个`istream`“失败”，或
*   杀死一个 Boost::thread？

笔记：

*   其中之一`istreams`是`cin`
*   我正在尝试重新启动该过程，因此我无法以禁止重置输入流的方式关闭它们。

编辑：

*   我确实知道何时到达“结束”，并且我确实知道哪个线程已成功完成，哪些需要被杀死。这是我需要弄清楚的杀戮（或从 istream 读取的不同策略）。
*   我需要两个线程正确退出和清理:(

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T17:11:21.810

我不认为有办法跨平台，但 pthread_cancel 应该是你正在寻找的。使用 boost 线程，您可以从线程中获取[native_handle](http://www.boost.org/doc/libs/1_37_0/doc/html/thread/thread_management.html#thread.thread_management.thread.nativehandle)，并在其上调用 pthread_cancel。

此外，更好的方法可能是在多个文件上使用与 select 调用等效的 boost [asio 。](http://www.boost.org/doc/libs/1_36_0/doc/html/boost_asio.html)这样一个线程将被阻塞等待输入，但它可能来自任一输入流。不过，我不知道用 iostreams 做这样的事情有多容易。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-12-06T04:37:47.387

就在这里！

`boost::thread::terminate()`将按照您的规格完成工作。

它将导致目标线程抛出异常。假设它未被捕获，堆栈将正确展开，破坏所有资源并终止线程执行。

终止不是即时的。（无论如何，那个时候错误的线程正在运行。）

它发生在预定义的条件下 - 对您来说最方便的可能是在调用时`boost::this_thread::sleep();`，您可以让该线程定期执行此操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-11-08T18:26:57.900

如果 boost 线程阻塞了 i/o 操作（例如`cin>>whatever`），`boost::thread::terminate()`则不会终止该线程。 `cin`i/o 不是有效的终止点。捕获 22。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-15T15:06:03.107

在 linux 上，我使用 pthread_signal(SIGUSR1)，因为它会中断阻塞 IO。我在移植代码时发现 Windows 上没有这样的调用。在套接字读取调用中只有一个已弃用的。在 Windows 中，您必须明确定义一个会中断您的阻塞调用的事件。所以没有这样的东西（AFAIK）作为中断阻塞 IO 的通用方法。

boost.thread 设计通过管理良好识别的中断点来处理这个问题。我不太了解 boost.asio，而且您似乎也不想依赖它。如果您不想重构以使用非阻塞范式，您可以做的是在非阻塞（轮询）和阻塞 IO 之间使用一些东西。那就是做类似（伪代码？）的事情：

```
while(!stopped && !interrupted)
{
    io.blockingCall(timeout);
    if(!stopped && !interrupted)
    {
        doSomething();
    }
} 
```

然后你打断你的两个线程并加入它们......

也许在您的情况下更简单？如果您有一个知道一个线程已结束的主线程，您只需要关闭另一个线程的 IO 吗？

编辑：顺便说一句，我对您拥有的最终解决方案感兴趣...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-20T22:31:23.933

我自己也遇到了类似的问题，并且已经找到了这个解决方案，这个问题的其他一些读者可能会觉得这很有用：

假设您正在使用带有 wait() 命令的条件变量，您必须知道在 Boost 中，wait() 语句是一个自然的中断点。因此，只需在带有等待语句的代码周围放置一个 try/catch 块，并允许函数在您的 catch 块中正常终止。

现在，假设您有一个带有线程指针的容器，迭代您的线程指针并在每个线程上调用 interrupt()，然后调用 join()。

现在您的所有线程都将正常终止，并且任何与 Boost 相关的内存清理工作都应该干净利落。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T17:14:46.140

而不是试图杀死你的线程，你总是可以尝试加入线程，如果失败，你加入另一个线程。（假设您将始终能够加入您的两个线程中的至少一个）。

在 boost:thread 中，您正在寻找[timed_join](http://www.boost.org/doc/libs/1_37_0/doc/html/thread/thread_management.html#thread.thread_management.thread.timed_join)函数。

但是，如果您想查看正确的答案，那就是使用带定时等待的非阻塞 io。让你得到同步io的流结构，异步io的非阻塞。

您谈论从 istream 读取，但 istream 只是一个接口。对于标准输入，您只需关闭标准输入文件描述符即可中断读取。至于另一个，这取决于你从哪里阅读......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T18:27:09.363

在 Windows 下，使用 QueueUserAPC 对引发异常的 proc 进行排队。这种方法对我来说很好。

**但是**：我刚刚发现 boost 互斥锁等在 win32 上不是“可提醒的”，因此 QueueUserAPC 无法中断它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-08T13:32:09.427

似乎线程并没有以简单的方式帮助您做您想做的事。如果您不喜欢 Boost.Asio，请考虑使用`select()`.

这个想法是获取两个文件描述符并`select()`用来告诉您其中哪些有可用的输入。的文件描述符`cin`通常是`STDIN_FILENO`; 如何获得另一个取决于您的具体情况（如果它是一个文件，则只是`open()`它而不是 using `ifstream`）。

在循环中调用`select()`以找出要读取的输入，当您想停止时，只需跳出循环即可。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-15T22:58:40.230

很晚了，但是在 Windows 中（对于那些记住这些事情的人来说，它是 VMS 或 RSX 之类的前身），我会使用 ReadFileEx 之类的东西，它带有一个完成例程，在完成时发出信号，如果需要提前取消读取，则使用 CancelIO。

Linux/BSD 有一个完全不同的底层 API，它不够灵活。使用 pthread_kill 发送信号对我有用，这将停止读取/打开操作。

恕我直言，值得为每个平台在该区域实施不同的代码。

# windows - 在 Windows 上是否有可以与 C 和 Perl 一起使用的**轻量级** IDE？

> ID：272753
> 
> 赞同：8
> 
> 时间：2008-11-07T17:04:45.553
> 
> 标签：windows, perl, svn, ide, gnu-toolchain

当我[之前](https://stackoverflow.com/questions/266121/is-there-a-windows-ide-that-can-handle-both-c-and-perl)问这个问题时，我应该提到它是我所追求的特别**轻量级的**IDE，所以我不得不再次问一个不同的问题。

不仅仅是一个文本编辑器，它是轻量级和多功能的，适合 Strawberry Perl、MinGW、GDB 和 Subversion 附带的 GCC。当我想使用它时可以立即使用它，并且可以快速关闭以保留我的所有工作。如果它不是免费或开源程序并不重要，重要的是它稳定且使用舒适。

也许试图让一个 IDE 同时用于 C 和 Perl 是错误的做法 - 导致解决方案不能像专用 IDE 那样处理一种语言或另一种语言？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-10T04:33:33.743

[Zeus](http://www.zeusedit.com)是一种语言中立的 IDE，几乎可以针对任何编程语言进行配置。

它具有语法高亮、代码折叠、项目/工作区管理、类浏览、宏脚本、集成版本控制、ftp 编辑等功能。

[![替代文字](https://i.stack.imgur.com/he8HY.jpg)](https://i.stack.imgur.com/he8HY.jpg)
[（来源：[zeusedit.com](http://www.zeusedit.com/images/_lookmain.jpg)）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T19:54:52.807

你看过[Padre](http://padre.perlide.org/)，Perl 应用程序开发和重构环境吗？

它仍在开发中，因此您可以帮助使其变得更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T12:45:47.260

[SciTE](http://www.scintilla.org/SciTE.html)值得一看。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T13:51:21.400

[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)是另一个基于[Scintilla](http://www.scintilla.org/)（作为[SciTE](http://www.scintilla.org/SciTE.html)）的源代码编辑器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-10T13:55:00.240

你可以试试 Geany 的 gnome。它相对较新，但很有趣。而且它似乎很轻。

[http://www.geany.org/](http://www.geany.org/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-18T09:39:57.903

我决定使用开源和跨平台的[Codelite](http://codelite.org/Main/ReadMore) IDE，它带有 C/C++，它与我将在不使用纯文本编辑器的情况下获得的一样轻量级。

它可以使用 VC++、GCC、G++，也可以根据需要配置为使用其他编译器。它不仅仅是一个文本编辑器，我将继续在 Perl 中使用它，直到找到更好的东西。不幸的是，对于 Perl 目前它只提供语法高亮，因此没有真正的动机在这里使用它而不是一些文本编辑器或 Padre。

尽管仍然相对较新（2008 年 7 月 1 日发布的 v1.0）Codelite 已经是比 Dev C++ 或 Code::Blocks 更好的 IDE，而且不像 Eclipse 那样缓慢或臃肿。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T17:23:02.567

是的。

记事本。

（当我输入这个时，我能感觉到我的代表正在流失）

:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-08T16:16:34.543

你试过 Eclipse 吗？我不知道它对你来说是否足够轻，但在我使用过的所有体面的 IDES 中，它是我经验中最快的一个。您应该能够下载标准的 eclipse 发行版，然后安装 c++ 和 Perl 工具。可以通过默认包含的 Ganymede 站点的更新管理器安装 C++ 工具。可以在此链接中找到有关 Perl for Eclipse 的信息。 [http://www.epic-ide.org/](http://www.epic-ide.org/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-10T13:35:47.737

[E 文本编辑器](http://e-texteditor.com/)是用于 Windows 的 TextMate 模拟。它不是免费的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T18:50:17.180

看看jEdit。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-19T17:24:02.687

Dev-C++ 非常好的 IDE。 [http://www.bloodshed.net/devcpp.html](http://www.bloodshed.net/devcpp.html)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-12-28T16:43:44.563

也许不是最轻量级的，但[Komodo Edit](http://www.activestate.com/Products/komodo_ide/komodo_edit.mhtml) 似乎是功能和程序大小之间的一个很好的折衷。它支持多种语言并且非常灵活。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-11-07T17:13:58.810

我认为是完整 IDE 的最轻量级的开源文本编辑器是[SharpDevelop](http://icsharpcode.com/OpenSource/SD/Default.aspx)，它仍然有点重。它处理许多不同的语言，但如果它为 Perl 做任何特定的事情，我不应该这样做。

# wiki - 将内容从 OpenWiki 迁移到 ScrewTurn Wiki

> ID：272760
> 
> 赞同：2
> 
> 时间：2008-11-07T17:06:02.163
> 
> 标签：wiki, migrate, screwturn

我们有一个大型的基于 OpenWiki 的 wiki。OpenWiki 似乎是一个死项目，ScrewTurn 是下一个最佳选择。

有谁知道将我们的内容从 OpenWiki SQL Server 格式移动到ScrewTurn wiki SQL Server 格式的数据迁移路线？

我们最终可能会创建自己的（并分享它），但我们宁愿不重新发明轮子。

问候，

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-31T16:53:18.203

您确定“死亡”状态吗？

[http://www.facebook.com/pages/OpenWiki-The-Post-It-Note-of-the-Web/145492998806288](http://www.facebook.com/pages/OpenWiki-The-Post-It-Note-of-the-Web/145492998806288)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-22T14:41:43.840

答案似乎是肯定的。

# windows - 在 Windows 上编写轻量级 GUI 程序的最快途径是什么？

> ID：272764
> 
> 赞同：8
> 
> 时间：2008-11-07T17:06:43.850
> 
> 标签：windows, performance, user-interface

我想要一个小的（< 30MB）独立 Windows 可执行文件（单个文件），它创建一个窗口，询问用户目录的位置，然后在该目录中启动不同的程序。

此可执行文件必须在 x86-64 架构以及安腾芯片上以 32 位和 64 位 Windows 的 XP、Vista、Server 2003 和 Server 2008 版本运行。

如果我们只需要构建一次就可以在所有这些平台上运行它，那将是惊人的，但这不是必需的。这是针对专有系统的，因此 GPL 代码是禁止使用的。

把它放在一起的最快方法是什么？

这些是我正在研究的一些事情，所以如果你有关于它们的可行性的信息，我会全力以赴：

*   Perl/Tk 使用 perl2exe 获取二进制文件。
*   Ruby 与 wxruby
*   学习 MFC 编程并像其他人一样以正确的方式进行。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-07T17:14:25.533

WSH 脚本呢？它不会是一个 exe，对，但是要一个文件夹，我认为不需要 exe 文件，更不用说 30Mb 的文件了......

一个 1Kb 的脚本，将其保存为您喜欢的任何名称并使用 vbs 扩展名并运行它。如果不清楚，它会询问您的文件夹名称，然后从 system32 子目录运行 calc.exe。您当然可以在 2 或 4 Kb 中做得比这更好。

```
Set WshShell = WScript.CreateObject("WScript.Shell")
win = InputBox("Please type your Windows folder location.")
If Right(win,1) <> "\" Then
  win = win & "\"
End If
WshShell.Run win & "system32\calc.exe" 
```

要添加文件夹浏览器对话框而不是 InputBox，请查看[此](http://wsh2.uw.hu/ch12f.html)内容。

明显的好处是：

*   简单（嗯，VB 很丑，但如果您愿意，可以使用 JScript），无需编译！
*   [兼容性](http://msdn.microsoft.com/en-us/library/x66z77t4(VS.85).aspx)，适用于我可用的每台 Windows 机器（从 98 开始）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-07T17:21:11.183

在 Windows 上实现轻量级和快速 GUI 的最快方法是什么？一句话……**德尔福！**它目前缺乏 64 位支持，但随后[FreePascal](http://www.freepascal.org/)会来救援。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-07T17:37:15.223

我会使用 .NET 和 WinForms。脚本化解决方案的想法很吸引人，但在实践中，我经常发现您最终会跳过箍做超出基本情况的任何事情，并且仍然没有灵活性来做您想做的所有事情。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-07T17:29:15.037

[带有wxWidgets](https://www.wxwidgets.org/)或[Tkinter](https://docs.python.org/2/library/tkinter.html)的 Python应该能够毫不费力地做到这一点。在所有东西上运行，py2exe 将为您提供一个独立的可执行文件。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-07T17:42:07.333

遗憾的是，拥有一个小型独立应用程序并快速开发它通常是相互冲突的需求。

老实说，考虑到应用程序非常简单，我会用 C 语言直接调用 Win32 来编写它：一次调用 SHBrowseForFolder() 以获取目录，一次调用 ShellExecuteEx() 以运行程序。即使是 MFC 对于这样一个适度的应用程序来说也太重了。将 C 运行时设置为静态链接，您应该能够将独立可执行文件的大小保持在 100k 以下。一个体面的 Windows C 编码器应该能够在不到一个小时的时间内完成它，假设你手头有一个。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-07T17:49:12.343

Tcl/tk 是一种解决方案。您可以使用称为“starpack”的东西——一个既是 tcl 解释器又是应用程序代码的虚拟文件系统来拥有一个可执行文件（包括自定义图像、dll 等）。我认为它可能会达到几兆字节。

根据您的规格，我个人可能需要 15 分钟才能获得第一个工作版本。

Tcl/Tk 有一个 BSD 许可证。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-07T17:25:08.290

尽管存在所有缺陷，Visual Basic 在历史上一直非常适合像这样的超级简单应用程序。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-07T18:03:29.333

我同意上面的 Tcl/Tk 答案。有关他所指的 starpack 的更多信息，请参见： http: [//www.equi4.com/tclkit/](http://www.equi4.com/tclkit/)它是一个可用于各种操作系统的 Tcl/Tk 解释器，大小约为 1MB。过去显然有人担心 Tcl/Tk UI 的外观和感觉，但这个问题已经通过一个名为“Tile”的新框架解决，该框架支持用户操作系统的原生外观和感觉。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-07T19:36:36.667

对于您所说的快速而肮脏的 GUI 程序，您可以使用 [AutoIt](http://www.autoitscript.com/autoit3/)脚本。您甚至可以编译为 exe。

对于 AutoIt 的 GUI 示例，您可以在[此处的上一个答案中查看我的标准输出重定向脚本](https://stackoverflow.com/questions/8004/best-way-to-wrap-rsync-progress-in-a-gui)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-07T17:09:14.403

您可以在 MFC 中执行此操作，并且可执行文件小于 100k。一般来说，如果您想减小可执行文件的大小，可以使用 UPX 执行 exe 压缩。如果您想要一个示例，请查看[uTorrent](http://www.utorrent.com/)。它是一个功能齐全的 BitTorrent 应用程序，可执行文件不到 300k。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-07T17:21:39.980

[wxWidgets](http://www.wxwidgets.org/) ; 它是跨平台、免费、开源且易于学习的

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-07T18:28:12.810

我将 HTA（HTML 应用程序）用于快速而肮脏的表单和脚本应用程序。有关详细信息和示例，请参阅[Microsoft 的 HTA 开发人员中心](http://www.microsoft.com/technet/scriptcenter/hubs/htas.mspx)。这基本上将 HTML 用于表单，并将任何 HTML 可访问的脚本语言用于脚本。绕过了正常的浏览器安全性，因此您几乎可以访问所有操作系统内部。上面的站点还​​包含几个工具的链接，这些工具几乎可以为您自动化脚本部分。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-01-18T16:52:00.913

PyQt 非常适合这个。Windows 的二进制文件在这里：

[http://www.riverbankcomputing.co.uk/software/pyqt/download](http://www.riverbankcomputing.co.uk/software/pyqt/download)

这里有一本好书：

[http://www.amazon.com/Programming-Python-Prentice-Software-Development/dp/0132354187/ref=sr_1_1?ie=UTF8&qid=1295369454&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0132354187)

如果您需要 exe，您可以使用各种方法冻结这些文件。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-07T17:44:44.147

与 Vinko Vrsalovic 所说的类似，您可以使用 HTA 应用程序。它就像使用 Windows 脚本主机功能构建网页一样简单。我用 jscript 构建了一些实用程序，它非常简单快捷 [http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536496(VS.85).aspx)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-07T17:48:11.720

这些反应令人难以置信。

Visual Studio Forms 编辑器允许您绘制 WinForms 并自动生成样板 GUI 代码（对于大多数其他语言和工具包来说，这充其量是个麻烦）。然后您可以使用 C# 或任何其他 .NET 语言。.NET 有用于文件选择器的库存小部件。我可以在 20 分钟内编写该脚本，它将免费在您的每个目标平台上运行。画出 GUI，拖放文件选择器，填写可能的两个钩子来完成“启动与他们想要的不同的文件”的事情，完成。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-01-24T08:08:52.230

我建议[Autohotkey (AHK)](http://www.autohotkey.com)或[Autoit](http://www.autoitscript.com/site/autoit/)。两者都支持win95+（对某些功能有警告）。它们可以编译成小型 .exe，无需外部依赖（本机 DLL 除外）。

优点：

*   小尺寸
*   易于编写代码
*   适用于简单 - 复杂的操作
*   可以轻松创建 GUI

缺点：

*   学习曲线（因为语法不寻常）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-31T17:54:46.393

30MB 相当大！

Qt (C++) 可能是最好的选择。它是可移植的，开发速度快，运行速度相对较快。使用 UPX（可执行文件的终极打包程序），您的程序将达到 10M+。

Qt (Python) 也可以，但会慢一些。

如果你希望它小于 1M 和/或你想要它快，你可以用 win32 api 用 C 语言编写它，或者使用 Delphi。

# active-directory - HOWTO - 设置委托的 Active Directory 权限

> ID：272765
> 
> 赞同：0
> 
> 时间：2008-11-07T17:06:50.433
> 
> 标签：active-directory, delegation

我创建了 ac# webservice，它允许我们的前端支持团队使用 system.directoryservices 查看和更新​​一些选定的 Active Directory 值

我要更新的字段是 [职位] 职务、部门、电话和员工 ID。

我可以使用具有“代表权限”的服务帐户来更新 [职位] 职位、部门、电话等，但是当我尝试更新员工 ID 时，我收到“未授权”错误消息。

如果我使用域管理员帐户，那么相同的代码可以正常工作。

我不想为此 Web 服务使用域管理员帐户，那么我需要什么权限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T17:13:11.870

**回答**

*ADS_SCHEMA_ID_GUID_USER GUID 允许您更新基本用户类详细信息，包括员工 ID*

[基于 MSDN 文章](http://www.microsoft.com/technet/scriptcenter/topics/security/exrights.mspx)

用于向服务帐户用户授予所选委派权限的 vbscript：

```
REM #
REM # Delegate AD property set admin rights to named account
REM # Based on: http://www.microsoft.com/technet/scriptcenter/topics/security/propset.mspx
REM #

Const TRUSTEE_ACCOUNT_SAM           = "ad\ADStaffUpdates"

Const ADS_ACETYPE_ACCESS_ALLOWED_OBJECT     = &H5
Const ADS_RIGHT_DS_READ_PROP            = &H10
Const ADS_RIGHT_DS_WRITE_PROP           = &H20
Const ADS_FLAG_OBJECT_TYPE_PRESENT      = &H1
Const ADS_FLAG_INHERITED_OBJECT_TYPE_PRESENT    = &H2
Const ADS_ACEFLAG_INHERIT_ACE           = &H2

Const ADS_SCHEMA_ID_GUID_USER           = "{bf967aba-0de6-11d0-a285-00aa003049e2}"
Const ADS_SCHEMA_ID_GUID_PS_PERSONAL        = "{77b5b886-944a-11d1-aebd-0000f80367c1}"
Const ADS_SCHEMA_ID_GUID_PS_PUBLIC      = "{e48d0154-bcf8-11d1-8702-00c04fb96050}"

ad_setUserDelegation    "OU=USERS, DC=AD, DC=COM", TRUSTEE_ACCOUNT_SAM, ADS_SCHEMA_ID_GUID_PS_USER
ad_setUserDelegation    "OU=USERS, DC=AD, DC=COM", TRUSTEE_ACCOUNT_SAM, ADS_SCHEMA_ID_GUID_PS_PERSONAL
ad_setUserDelegation    "OU=USERS, DC=AD, DC=COM", TRUSTEE_ACCOUNT_SAM, ADS_SCHEMA_ID_GUID_PS_PUBLIC

Function ad_setUserDelegation(          _
        ByVal   strOU           _
        ,ByVal  strTrusteeAccount   _
        ,ByVal  strSchema_GUID      _
        )

    Set objSdUtil           = GetObject( "LDAP://" & strOU )

    Set objSD           = objSdUtil.Get( "ntSecurityDescriptor" )
    Set objDACL             = objSD.DiscretionaryACL

    Set objAce          = CreateObject( "AccessControlEntry" )

    objAce.Trustee          = strTrusteeAccount
    objAce.AceFlags         = ADS_ACEFLAG_INHERIT_ACE
    objAce.AceType          = ADS_ACETYPE_ACCESS_ALLOWED_OBJECT
    objAce.Flags            = ADS_FLAG_OBJECT_TYPE_PRESENT OR ADS_FLAG_INHERITED_OBJECT_TYPE_PRESENT

    objAce.ObjectType       = strSchema_GUID

    objACE.InheritedObjectType  = ADS_SCHEMA_ID_GUID_USER
    objAce.AccessMask       = ADS_RIGHT_DS_READ_PROP OR ADS_RIGHT_DS_WRITE_PROP
    objDacl.AddAce          objAce

    objSD.DiscretionaryAcl      = objDacl

    objSDUtil.Put           "ntSecurityDescriptor", Array( objSD )
    objSDUtil.SetInfo

End Function

Function ad_revokeUserDelegation(       _
        ByVal   strOU           _
        ,ByVal  strTrusteeAccount   _
        )

    Set objSdUtil           = GetObject( "LDAP://" & strOU )

    Set objSD           = objSdUtil.Get( "ntSecurityDescriptor" )
    Set objDACL             = objSD.DiscretionaryACL

    For Each objACE in objDACL
        If UCase(objACE.Trustee) = UCase(strTrusteeAccount) Then
                objDACL.RemoveAce objACE
        End If
    Next

    objSDUtil.Put           "ntSecurityDescriptor", Array(objSD)
    objSDUtil.SetInfo

End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T17:10:00.660

代码示例（至少是移动部分）

```
string distinguishedname = "CN=Wicks\, Guy,OU=Users,DC=ad,DC=com"
using (DirectoryEntry myDirectoryEntry = new DirectoryEntry(string.Format("LDAP://{0}", distinguishedname), null, null, AuthenticationTypes.Secure))
{
    try
    {
        myDirectoryEntry.Username   = "serviceaccount";
        myDirectoryEntry.Password   = "pa55word";

        myDirectoryEntry.Properties["employeeid"][0]    = employeeID;
        myDirectoryEntry.CommitChanges();
        setresult.result        = myDirectoryEntry.Properties["employeeid"][0].ToString();
    }
    catch   ( Exception ex )
    {
        setresult.result        = ex.Message;
    }
} // end using 
```

（我为我的 C# 道歉）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T17:56:46.710

您服务的用户是否有权通过 AD 用户和计算机修改这些字段？如果他们是那么也许你可以使用模拟，只是让你的服务主机“受信任的委派”（在它的 AD 属性中）对我来说总是很好。

# ssl - 品牌名称对于 SSL EV 证书是否重要？

> ID：272770
> 
> 赞同：6
> 
> 时间：2008-11-07T17:08:38.807
> 
> 标签：ssl, ssl-certificate

最终用户是否真的关心 SSL EV 证书是否来自 VeriSign、Thwate、DigiCert 等？对于相同的基本功能，来自 VeriSign 的证书的成本可能是 DigiCert 的 3 倍。威瑞信可能是最知名的品牌名称。

我就这个话题与人们进行了多次讨论，但我从未见过任何真实数据（来自研究、调查等）来支持这样一种观点，即最终用户在看到 VeriSign 印章时会更安全地使用您的网站与 DigiCert 印章相比。

有没有人有任何真实的数据来支持这个想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T17:23:37.153

不会。威瑞信可以收取更多费用的原因是，作为最早的 CA 之一，它们被更多传统和晦涩的浏览器所认可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T00:44:05.017

我也没有看到太多这方面的数据。产品功能相同。似乎很难证明在 VeriSign 证书上花费更多是合理的，除非您绝对确定从长远来看它会为您带来更多的钱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T17:14:24.287

这真的取决于你的客户。如果你只是为大众服务，那没什么大不了的，因为很多人只要看到那个小锁，就根本不在乎。如果您正在处理一个技术含量更高的系统，可能是其他开发人员正在访问敏感数据的 Web 服务，您可能会遇到一些更“宗教”的人，他们坚持认为一个比另一个更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T10:45:58.720

自过去几年以来，我一直在为我们公司转售 SSL 证书处理数字营销活动，根据我的经验，我发现了这一点；由 verisign(symantec) 和 geotrust 提供的 SSL 证书是最受欢迎和最值得信赖的品牌。

我还发现，SSL 证书可以提高您的客户信心，这会直接影响您的转化率。但主要问题是；多少钱？如果您认为您的产品和业务很大，并且您的目标受众的技术足以了解 SSL 安全性，那么您应该在 SSL 证书上投入更多/更少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-18T20:48:37.213

我假设您正在考虑这样一个事实，即 EV 提供商可能会给您一个徽标以放在您的网站上 - 在结帐期间或其他任何时间。我一点也不担心人们点击锁并看到他们不信任的公司。

有“信任”这个词的公司会比没有“信任”的公司看起来更好——就 SSL 验证印章标志而言。

我见过的一些 SSL 封条看起来很糟糕。购买前请提前查看徽标。

# svn - 带有 Subversion 集成的票务/跟踪系统？

> ID：272776
> 
> 赞同：10
> 
> 时间：2008-11-07T17:09:26.200
> 
> 标签：svn, bug-tracking, ticket-system

我的公司使用 StarTeam 进行源代码控制和 CR 管理，但我真的很想切换到 Subversion 进行源代码控制。对于那些了解 ClearQuest 和 ClearCase 的人来说，StarTeam 能够创建工单，这些工单可以在以后与代码更改相关联。

是否有任何类似的产品可以很好地与 Subversion 集成（最好是免费的，但我不一定反对商业应用程序的想法）？前段时间我玩过[trac](http://trac.edgewall.org/)，但并没有给我留下太大的印象。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-09T18:27:24.980

一周前我安装了[Redmine 。](http://www.redmine.org/ "红米")它与 Trac 非常相似，但用 ruby​​ on rails 编写，具有更好的主题和一些不错的 ajax 功能（右键单击问题会打开一个菜单，您可以在其中更改针对特定问题的大量内容。）它与 Subversion 和您可以将其配置为对 svn-commit 中的关键字（问题）做出反应，并将这些提交连接到特定的问题 ID。

到目前为止我很满意！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-07T17:21:47.173

[Jira](http://www.atlassian.com/software/jira/)与 Subversion 很好地集成，只需一点点努力。

将[Bamboo](http://www.atlassian.com/software/bamboo/)与 Subversion 和[Jira](http://www.atlassian.com/software/jira/)一起使用可以帮助集成您的整个发布管理周期 - 请参阅[实现版本控制系统的好策略](https://stackoverflow.com/questions/262953/a-good-strategy-for-implementing-a-versioning-system)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-07T17:28:02.277

看着 DZone 似乎[汇编](http://www.assembla.com/about)可能适合您的需求。我自己没有使用过它，但它确实将 Subversion、Tickets 和项目管理集成到一个包中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-07T17:31:29.493

[FogBugz](http://fogbugz.com)也与 SVN 集成，虽然它不是免费的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-16T16:54:10.290

我也在几个项目中使用 Trac，但我正在切换到 Redmine。

Redmine 开箱即用地处理多个项目和子项目，总体上看起来比 Trac“更好”。

两者都与 subversion 集成，因此需要确定您真正需要的功能以及您可能已经拥有的后端语言（Trac 在 Python 上运行，Redmine 在 Ruby on Rails 上运行）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-07T17:36:03.290

我刚刚设置了这个组合：

*   Subversion 托管在 DreamHost（我的域）上
*   Fogbugz OnDemand - 启动版（仅限 2 位用户免费）
*   Fogbugs <--> Subversion 集成 - FogBugz 已经准备好提交后挂钩脚本，您只需将其放在您的 Subversion 存储库中的正确位置

它让我可以通过 Tortoise SVN 添加 Fogbugz 案例编号，然后我可以看到来自 FogBugz 的代码更改。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-09T18:39:25.750

我们在我的公司使用 Redmine & Beanstalk，到目前为止我们对它们很满意。

我们评估了 Trac、Bugzilla、Mantis、Lighthouse 和 Redmine（FogBugz 不是一个选项，因为价格非常高），并决定我们最喜欢 Redmine。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T03:55:08.010

所有领先的错误跟踪系统都与 Subversion 集成，以便 Subversion 修订可以与问题相关联。

[BugTracker.NET](http://ifdefined.com/bugtrackernet.html)（免费）
FogBugz（商业）
Jira（商业）
Mantis（免费）
RedMine（免费）
Trac（免费）

一个要问的问题：
您想托管它还是让它为您托管？如果您希望它为您托管，请添加到列表中：
Lighthouse（商业）
Assembla（商业）

您还可以找到 FogBugz、Jira 和 Trac 的托管解决方案。

或者您更喜欢在内部运行应用程序，甚至自定义代码？然后使用基于您熟悉的技术的免费开源替代方案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-18T13:53:56.863

我们的[Bitnami](http://bitnami.org)项目网站为许多开源项目提供免费的一键式安装程序，包括与 Subversion 的集成以及运行所需的所有依赖项（Redmine 中的 Ruby on Rails、Trac 中的 Python 等） ）。安装程序是独立的（它们不会接触您的系统），安装（或卸载）只需几分钟，因此您可以轻松地“试驾”Redmine、Mantis、Trac 等。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-19T17:05:47.820

Redmine 规则。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-05T04:42:41.833

在工作中，我们使用 redmine 并且对它非常满意......

将它与颠覆相结合真的很容易......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-11-11T08:28:11.283

好的，对我来说，杀手锏是：

Assembla Private SVN Repository（与免费啤酒一样免费）在共享主机上安装私人 Redmine。（便宜……就像便宜的啤酒一样）

您可以根据需要在 assembla 中创建任意数量的 svn 存储库（真的很酷），将它们与新的 Redmine 项目连接起来，纯正的甜蜜等待着您。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-11-14T02:21:39.253

Gemini 集成得非常好 - www.countersoft.com

# c# - 如何在系统托盘中找到图标的位置

> ID：272778
> 
> 赞同：5
> 
> 时间：2008-11-07T17:10:09.160
> 
> 标签：c#, winforms, visual-studio-2008, notifyicon

我有一个出现在系统托盘中的 NotifyIcon 控件。如何在屏幕上找到图标的位置 (x, y)？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T16:22:24.747

实际上你可以做到这一点，这里的代码向你展示了如何以及更多。

在来自 NotifyIcon 的任何鼠标事件中，只需查看 Control.MousePosition，它包含鼠标的 (x,y)。可以使用这些 (x,y) 值将 ContextMenu 准确定位在表单/控件上单击表单/控件的位置。

这两个的一个很好的例子是在这里：

更多信息：http: [//code.msdn.microsoft.com/TheNotifyIconExample](http://code.msdn.microsoft.com/TheNotifyIconExample)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T14:11:17.477

经过漫长的试错之旅，以及我自己的通知图标定位器的开发，我开发了一种找到最佳位置图标的方法，到目前为止一切顺利，直到我看到@zhwang [SuperNotifyIcon](https://github.com/rzhw/SuperNotifyIcon)这个惊人的项目。本项目有三种定位通知图标的方法，从不准确（像我自己开发的）到使用Windows 7中的new API。这是确定的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T20:25:21.390

你不能。获取系统托盘的窗口句柄并不难，GetClassName()返回“ToolbarWindow32”，标准TOOLBAR公共控件的类名。请注意，64 位操作系统有两个。然后你可以像 TB_GETBUTTONINFO 一样向它发送消息。主要问题是您不知道要选择哪个按钮 ID，并且返回的信息不包括按钮位置。

更好的是，按钮在您无法锁定的情况下四处移动。

# oracle - Oracle Streams 和变更数据捕获之间有什么区别？

> ID：272779
> 
> 赞同：12
> 
> 时间：2008-11-07T17:10:27.477
> 
> 标签：oracle, cdc, advanced-queuing, change-data-capture, oracle-streams

有几种类似的 Oracle 技术 - Oracle Streams、Oracle Change Data Capture 和 Database Change Notification。

这些之间有什么区别？

它们与 Oracle 高级队列有关吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-09T05:04:34.273

Oracle CDC 是关于捕获数据库表中的更改，并将更改存储在特殊的 Oracle 表中。CDC操作有两种模式：异步（基于Java）或同步（基于DB触发器，性能开销更大）。

Oracle Streams 位于 Oracle CDC 之上，它是一个完整的传输机制（例如通过 HTTP），用于在 2 个服务器之间进行数据同步。它基于 Oracle 高级队列技术，专为高性能和可靠性而设计。

Oracle CDC 和 Streams 通常用于 Oracle DB 服务器之间的数据同步...使用 Oracle CDC，您不必使用 Oracle Streams，例如，您可以编写自己的数据导出例程，这些例程创建平面文件2 个数据库服务器之间的同步，而使用 Streams，您必须在 2 个服务器之间建立网络链接。

数据库更改通知又是另一回事，它不用于服务器到服务器的同步，而是更多地用于服务器通知客户端的结果集更改，主要是在客户端数据缓存的上下文中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-13T19:37:34.313

我要补充一点，对于系统之间的同步，您可以通过结合 Streams 和 CDC 发布机制来实现异步模式。如果您选择不为此目的使用 Streams，您最终将使用同步模式（我认为它是通过触发器）在每个事务上增加一些额外的开销。

# multithreading - 我可以根据 ProcessID 和 ThreadID 创建一个唯一的文件名吗？

> ID：272783
> 
> 赞同：3
> 
> 时间：2008-11-07T17:11:04.247
> 
> 标签：multithreading, delphi, cgi, isapi

我有一个可以作为 CGI 应用、ISAPI 或 Apache DLL 运行的 delphi (Win32) Web 应用程序。我希望能够生成一个唯一的文件名前缀（在给定时刻对所有当前请求都是唯一的），并认为最好的方法是使用 processID（处理 CGI 模式）以及 threadID（处理dll 模式）。

如何在 Delphi 中获得唯一的进程 ID 和线程 ID？

这些在多核/多处理器情况下（在单个网络服务器机器上）是否是独一无二的？

*编辑：请注意，我被建议不要使用这种方法，因此接受的答案使用不同的方法来生成临时文件名*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T17:46:31.240

你在这里提出了很多好主意。

> 它是否还会创建一个空文件来“锁定”名称？

不; 我相信我们依靠 Windows 来确保自启动以来在同一台计算机上永远不会两次给出相同的临时文件名。

> 如果在生成名称和创建文件之间存在瞬间延迟（如果我需要自己创建文件），是否有可能发生冲突*。*

不; 那将是一件非常糟糕的事情。

这是我一直用来获取临时文件的例程。

```
function GetTemporaryFileName:string;
var
  Path, FileName: array[0..MAX_PATH] of Char;
begin
  Win32Check(GetTempPath(MAX_PATH, Path) <> 0);
  Win32Check(GetTempFileName(Path, '~EX', 0, FileName) <> 0);
  Result:=String(Filename);
end; 
```

您可以改用 JCL 中 JclFileUtils.pas 中的 FileGetTempName()。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-08T04:29:38.337

Windows 提供了创建有保证的唯一文件名的功能。无需创建自己的：

这是围绕该功能的 Delphi 包装器：

```
function CreateTempFileName(aPrefix: string): string;
var
  Buf: array[0..MAX_PATH] of Char;
  Temp: array[0..MAX_PATH] of Char;
begin
  GetTempPath(MAX_PATH, Buf);
  if GetTempFilename(Buf, PChar(aPrefix), 0, Temp) = 0 then
  begin
    raise Exception.CreateFmt(sWin32Error, [GetLastError, SysErrorMessage(GetLastError)]);
  end;
  Result := string(Temp);
end; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-07T17:13:11.697

您不能改用[GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)吗？

编辑：应该第一次说，检查以下两个功能

```
CreateGuid
GuidToString 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-07T17:15:19.277

不保证进程 ID 在 Windows 上是唯一的。它们在进程的生命周期中肯定是唯一的，但是一旦进程终止，它的 id 可以立即重用。我不确定 ThreadID。如果这些是临时文件，您可以使用与 tmpfile 或 tmpnam 等效的东西（C 函数，但我假设 Delphi 有一个等效的）。

正如 Jamie 发布的那样，GUID 可能会更好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-08T03:47:48.767

1）如何在Delphi中获取唯一的Process ID & ThreadID：

答案：
注意：确保在实现部分的使用子句中添加“windows”
注意：基数是无符号的 32 位整数，范围从 0 到 4294967295

```
implementation
uses Windows;

procedure MySolution();
var
  myThreadID:Cardinal;  
  myProcessID:Cardinal;
begin
  myThreadID := windows.GetCurrentThreadID;
  myProcessID := windows.GetCurrentProcessId;
end; 
```

2）这些在多核/多处理器情况下（在单个网络服务器机器上）是否是独一无二的？
**回答：是的。**

> 进程标识符从进程创建到进程终止有效，并且在整个系统中是唯一的。（并非处理器独有）
> 
> 在线程终止之前，线程标识符在整个系统中唯一标识线程。（同样，系统范围，不是处理器独有的）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-07T17:19:30.360

比这些选项中的任何一个都好，您应该使用系统函数[_tempnam](http://msdn.microsoft.com/en-us/library/hs3e7355.aspx)。它为不存在的文件返回目录中的随机文件名。如果您愿意，您可以为 _tempnam 提供前缀，以便您创建的文件可以识别为您的。如果您提供唯一的前缀，则不必担心有人打开您的文件。然而，还有另一种解决方案。

_tempnam 仅在您想将文件放入任意目录时才有用。如果您不关心该目录是系统临时目录，请改用[tempfile_s](http://msdn.microsoft.com/en-us/library/b3dz6009.aspx)。它还将为您创建文件，因此无需担心竞争条件...只有在您尝试打开的临时文件超出系统处理能力时才会发生错误。tempfile_s 最大的缺点是文件一旦关闭就会消失。

编辑：我被否决了，因为这是一个 C 函数。您可以通过将它们导入 delphi 来访问 C 运行时。[在这里](http://rvelthuis.de/articles/articles-cobjs.html)查看一些带有 msvcrt.dll 的示例。

```
function _tempnam(const Dir: PChar, const Prefix: PChar): PChar; cdecl;
  external 'msvcrt.dll' name '_tempnam'; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-07T17:40:14.733

其他人都给了您一个很好且合理的想法，但是仍然-如果您将文件用于临时存储并且总是首先创建这些文件（如果已经存在同名的剩余文件并不重要）磁盘，因为无论如何你都会覆盖它）然后 processid_threadid 方法是完全有效的。

使用[GetCurrentProcessID](http://msdn.microsoft.com/en-us/library/ms683180.aspx)和[GetCurrentThreadID](http://msdn.microsoft.com/en-us/library/ms683183.aspx) Win32 调用来访问这两个 ID。

# visual-studio-2008 - 从 WCF 使用 REST 服务

> ID：272791
> 
> 赞同：15
> 
> 时间：2008-11-07T17:13:12.620
> 
> 标签：visual-studio-2008, wcf, web-services, rest, twitter

我对 WCF 不太熟悉，但我想我会在尝试使用现有服务时学习。

我想到的 REST API 之一是[Twitter API](http://apiwiki.twitter.com/REST+API+Documentation)。我想开发一个 WPF 客户端，它将某个 Twitter 用户的最后 5 条推文输出到屏幕上。

我想知道是否有人可以简要概述我需要在 Visual Studio 中使用 WCF（类、向导、代理等）使用这些服务所需采取的步骤。我已经知道如何使用 Web 请求调用它们并解析返回的 XML - 我真的很想看到 WCF 部分在工作。

提前感谢任何帮助我进一步学习的人:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-08T01:10:16.167

查看 Kirk Evans[创建使用 WCF 的 REST Twitter 客户端](http://blogs.msdn.com/kaevans/archive/2008/07/26/creating-a-rest-twitter-client-with-wcf.aspx)。.NET 3.5 SP1 中对 WCF 的最新改进使许多 RESTful 接口更容易。

还可以从 MSDN 站点查看[Twitter WCF 3.5 API 声明库。](http://code.msdn.microsoft.com/dparys/Release/ProjectReleases.aspx?ReleaseId=1128)

这是[另一个例子](http://www.amptools.net/2008/07/amplify-twittern-yet-another-c-twitter.aspx)- 警告截至 2/3/10 链接是“borked”

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-08T01:06:24.443

使用 WCF 使用基于 Http 的 API（如 Twitter API）没有任何好处。System.Net.HttpWebRequest 绰绰有余。事实上，我怀疑你会有一些困难。当电线的两端都有 WCF 时，WCF 更容易开始工作。

但是，如果 REST API 返回 Atom 内容，那么您可以使用 System.ServiceModel.Syndication 类来帮助解析响应。

编辑：自从我写这篇文章以来，微软发布了一个新的 HTTP 客户端库的预览版，它在使用 RESTful 服务方面做得更好。
以下是您将如何使用它发布到 twitter：

```
var client = new HttpClient();
client.DefaultHeaders.Authorization = Credential.CreateBasic("username","password");
var form = new HttpUrlEncodedForm();
form.Add("status","Test tweet using Microsoft.Http.HttpClient");
var content = HttpContent.Create(form);
var resp = client.Post("http://www.twitter.com/statuses/update.xml", content); 
```

如果您想了解更多关于这个客户端库的详细信息，我正在[这里](http://www.bizcoder.com/index.php/2009/12/08/why-the-microsoft-http-library-is-awesome/)写一些关于它的博客文章。

# database - 在开发服务器上查看实时数据的最佳实践？

> ID：272798
> 
> 赞同：3
> 
> 时间：2008-11-07T17:15:23.723
> 
> 标签：database, production

假设：实时/生产网络应用程序抑制向最终用户显示错误。

假设您的技术支持团队希望通过应用程序的开发端查看实时数据（也许您希望查看正在发生的错误，或者希望查看何时使用最终用户的数据）。

现在我们有一个数据库同时服务于开发盒和直播盒（不是我的想法——我知道这很糟糕）。

想法？

**编辑**：实施您的建议的最佳/方便的工具？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T17:18:37.023

我们将数据复制回不同的数据库。是的，有延迟，但它使人们无法接触生产服务器。这也使我们能够“隐藏”技术支持（以及其他人）不应该看到的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T17:18:50.423

除了复制数据之外，在生产中，我们还可以查看谁登录了应用程序，如果是公司成员，则将他们发送到真正的错误页面，而不是快乐的小猫玩毛线球道歉。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T17:18:51.857

定期备份和从现场恢复到开发（一天一次，两次）。它不需要是实时的（因为无论如何您都可能从开发端输入数据，这可能会导致问题）。

如果您有 PCI 或 HIPAA 数据，请确保不要将其放入您的开发环境中——这可能会违反法律。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T17:23:11.333

我通常喜欢有一个 3 层的 Web 开发系统：
Development
Testing
Live

大多数时候测试是实时系统的精确副本，除了打开错误，当一个新版本即将被实时移动时，它被替换为新版本 BEFORE live is，以检测升级问题。

开发与实时完全分开，以允许对数据库等事物进行重大更改，或对生产环境进行更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T17:24:07.107

我首先会通过电子邮件将错误发​​送给某人，其中包含用户如何到达那里的详细信息，或者至少记录下来，这样您就可以在执行类似操作时查看错误日志，看看您是否在日志中收到相同的消息。

是的，在开发服务器/站点上复制数据库可能是您唯一的选择。您不希望开发团队对实时数据进行任何更改，并且您可能还会有一些更改在某些时候不适用于生产数据库。

我不建议每晚进行一次复制，因为开发人员可能正处于一些新功能的中间，他们已经添加了数据，然后当晚就将其删除了。每次发布主要版本时，我通常都会将生产数据库复制到 dev。这也让我可以使用大量实时数据进行速度测试。在某些系统上，我还将每个人的密码更改为默认密码，这样我就可以轻松地以任何用户身份登录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T17:29:34.613

如果您的配置允许：

一种。添加一个日志功能（如果还没有的话）将感兴趣的消息写入日志文件。

湾。运行 unix 命令

尾 -f < 日志文件.txt

这会将不断增长的日志文件流式传输到您的控制台。

[http://www.monkey.org/cgi-bin/man2html?tail](http://www.monkey.org/cgi-bin/man2html?tail)

如果你有 Windows，你可以试试这个：

[http://tailforwin32.sourceforge.net/](http://tailforwin32.sourceforge.net/)

# html - HTML 表格中的垂直（旋转）文本

> ID：272799
> 
> 赞同：119
> 
> 时间：2008-11-07T17:15:30.383
> 
> 标签：html, css, text-rendering, text-styling

是否有（便携式）方法将 HTML 表格单元格中的文本旋转 90°？

（我有一个表格，其中有很多列和很多标题文本，所以我想垂直写它以节省空间。）

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2010-03-10T10:17:04.023

```
.box_rotate {
     -moz-transform: rotate(7.5deg);  /* FF3.5+ */
       -o-transform: rotate(7.5deg);  /* Opera 10.5 */
  -webkit-transform: rotate(7.5deg);  /* Saf3.1+, Chrome */
             filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083);  /* IE6,IE7 */
         -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083)"; /* IE8 */
    }
```

```
<div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus vitae porta lectus. Suspendisse dolor mauris, scelerisque ut diam vitae, dictum ultricies est. Cras sit amet erat porttitor arcu lacinia ultricies. Morbi sodales, nisl vitae imperdiet consequat, purus nunc maximus nulla, et pharetra dolor ex non dolor.</div>
<div class="box_rotate">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus vitae porta lectus. Suspendisse dolor mauris, scelerisque ut diam vitae, dictum ultricies est. Cras sit amet erat porttitor arcu lacinia ultricies. Morbi sodales, nisl vitae imperdiet consequat, purus nunc maximus nulla, et pharetra dolor ex non dolor.</div>
<div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus vitae porta lectus. Suspendisse dolor mauris, scelerisque ut diam vitae, dictum ultricies est. Cras sit amet erat porttitor arcu lacinia ultricies. Morbi sodales, nisl vitae imperdiet consequat, purus nunc maximus nulla, et pharetra dolor ex non dolor.</div>
```

取自[http://css3please.com/](http://css3please.com/)

截至 2017 年，上述站点已简化规则集以删除旧版 Internet Explorer 过滤器并更多地依赖现在的标准[`transform`属性](https://developer.mozilla.org/en-US/docs/Web/CSS/transform)：

```
.box_rotate {
  -webkit-transform: rotate(7.5deg);  /* Chrome, Opera 15+, Safari 3.1+ */
      -ms-transform: rotate(7.5deg);  /* IE 9 */
          transform: rotate(7.5deg);  /* Firefox 16+, IE 10+, Opera */
}
```

```
<div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus vitae porta lectus. Suspendisse dolor mauris, scelerisque ut diam vitae, dictum ultricies est. Cras sit amet erat porttitor arcu lacinia ultricies. Morbi sodales, nisl vitae imperdiet consequat, purus nunc maximus nulla, et pharetra dolor ex non dolor.</div>
<div class="box_rotate">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus vitae porta lectus. Suspendisse dolor mauris, scelerisque ut diam vitae, dictum ultricies est. Cras sit amet erat porttitor arcu lacinia ultricies. Morbi sodales, nisl vitae imperdiet consequat, purus nunc maximus nulla, et pharetra dolor ex non dolor.</div>
<div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus vitae porta lectus. Suspendisse dolor mauris, scelerisque ut diam vitae, dictum ultricies est. Cras sit amet erat porttitor arcu lacinia ultricies. Morbi sodales, nisl vitae imperdiet consequat, purus nunc maximus nulla, et pharetra dolor ex non dolor.</div>
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-11-07T17:30:01.913

## 替代解决方案？

与其旋转文本，不如将其写成“从上到下”？

像这样：

```
S  
O  
M  
E  

T  
E  
X  
T 
```

我认为这会容易得多 - 您可以选择一串文本并在每个字符后插入换行符。

这可以通过浏览器中的 JavaScript 来完成，如下所示：

```
"SOME TEXT".split("").join("\n") 
```

...或者您可以在服务器端进行，因此它不依赖于客户端的 JS 功能。（我想这就是您所说的“便携式”的意思？）

此外，用户不必侧头阅读它。:)

### 更新

[这个线程](https://stackoverflow.com/questions/278940/vertical-text-with-jquery)是关于用 jQuery 做这个的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-01-26T20:11:50.680

原始答案中有一个引用，而我之前在 IE8 行上的答案在分号附近抛出了这个问题。哎呀和BAAAAD！下面的代码正确设置了旋转并且可以正常工作。您必须在 IE 中浮动才能应用过滤器。

```
<div 样式="
    向左飘浮;
    位置：相对；
    -moz 变换：旋转（270 度）；/* FF3.5+ */        
    -o-变换：旋转（270度）；/* 歌剧 10.5 */   
    -webkit-transform：旋转（270度）；/* Saf3.1+，铬 */              
    过滤器： progid:DXImageTransform.Microsoft.BasicImage(rotation=3); /* IE6,IE7 */          
    -ms-filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3); /* IE8 */           
"
>计数和价值</div>;

```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-19T07:09:24.210

在尝试了两个多小时后，我可以肯定地说，到目前为止提到的所有方法都不适用于跨浏览器，或者对于 IE，甚至跨浏览器版本...

例如（最受好评的答案）：

```
 filter:  progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083);  /* IE6,IE7 */
     -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083)"; /* IE8 */ 
```

在 IE9 中旋转两次，一次用于过滤器，一次用于 -ms-filter，所以...

所有其他提到的方法也不起作用，至少如果您必须设置表格标题单元格（带有背景颜色）的固定高度/宽度，它应该自动调整到最高元素的大小。

因此，为了详细说明 Nathan Long 提出的服务器端图像生成，这确实是唯一通用的工作方法，这里是我的通用处理程序 (*.ashx) 的 VB.NET 代码：

```
Imports System.Web
Imports System.Web.Services

Public Class GenerateImage
    Implements System.Web.IHttpHandler

    Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
        'context.Response.ContentType = "text/plain"
        'context.Response.Write("Hello World!")
        context.Response.ContentType = "image/png"

        Dim strText As String = context.Request.QueryString("text")
        Dim strRotate As String = context.Request.QueryString("rotate")
        Dim strBGcolor As String = context.Request.QueryString("bgcolor")

        Dim bRotate As Boolean = True

        If String.IsNullOrEmpty(strText) Then
            strText = "No Text"
        End If

        Try
            If Not String.IsNullOrEmpty(strRotate) Then
                bRotate = System.Convert.ToBoolean(strRotate)
            End If
        Catch ex As Exception

        End Try

        'Dim img As System.Drawing.Image = GenerateImage(strText, "Arial", bRotate)
        'Dim img As System.Drawing.Image = CreateBitmapImage(strText, bRotate)

        ' Generic error in GDI+
        'img.Save(context.Response.OutputStream, System.Drawing.Imaging.ImageFormat.Png)

        'Dim bm As System.Drawing.Bitmap = New System.Drawing.Bitmap(img)
        'bm.Save(context.Response.OutputStream, System.Drawing.Imaging.ImageFormat.Png)

        Using msTempOutputStream As New System.IO.MemoryStream
            'Dim img As System.Drawing.Image = GenerateImage(strText, "Arial", bRotate)
            Using img As System.Drawing.Image = CreateBitmapImage(strText, bRotate, strBGcolor)
                img.Save(msTempOutputStream, System.Drawing.Imaging.ImageFormat.Png)
                msTempOutputStream.Flush()

                context.Response.Buffer = True
                context.Response.ContentType = "image/png"
                context.Response.BinaryWrite(msTempOutputStream.ToArray())
            End Using ' img

        End Using ' msTempOutputStream

    End Sub ' ProcessRequest

    Private Function CreateBitmapImage(strImageText As String) As System.Drawing.Image
        Return CreateBitmapImage(strImageText, True)
    End Function ' CreateBitmapImage

    Private Function CreateBitmapImage(strImageText As String, bRotate As Boolean) As System.Drawing.Image
        Return CreateBitmapImage(strImageText, bRotate, Nothing)
    End Function

    Private Function InvertMeAColour(ColourToInvert As System.Drawing.Color) As System.Drawing.Color
        Const RGBMAX As Integer = 255
        Return System.Drawing.Color.FromArgb(RGBMAX - ColourToInvert.R, RGBMAX - ColourToInvert.G, RGBMAX - ColourToInvert.B)
    End Function

    Private Function CreateBitmapImage(strImageText As String, bRotate As Boolean, strBackgroundColor As String) As System.Drawing.Image
        Dim bmpEndImage As System.Drawing.Bitmap = Nothing

        If String.IsNullOrEmpty(strBackgroundColor) Then
            strBackgroundColor = "#E0E0E0"
        End If

        Dim intWidth As Integer = 0
        Dim intHeight As Integer = 0

        Dim bgColor As System.Drawing.Color = System.Drawing.Color.LemonChiffon ' LightGray
        bgColor = System.Drawing.ColorTranslator.FromHtml(strBackgroundColor)

        Dim TextColor As System.Drawing.Color = System.Drawing.Color.Black
        TextColor = InvertMeAColour(bgColor)

        'TextColor = Color.FromArgb(102, 102, 102)

        ' Create the Font object for the image text drawing.
        Using fntThisFont As New System.Drawing.Font("Arial", 11, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel)

            ' Create a graphics object to measure the text's width and height.
            Using bmpInitialImage As New System.Drawing.Bitmap(1, 1)

                Using gStringMeasureGraphics As System.Drawing.Graphics = System.Drawing.Graphics.FromImage(bmpInitialImage)
                    ' This is where the bitmap size is determined.
                    intWidth = CInt(gStringMeasureGraphics.MeasureString(strImageText, fntThisFont).Width)
                    intHeight = CInt(gStringMeasureGraphics.MeasureString(strImageText, fntThisFont).Height)

                    ' Create the bmpImage again with the correct size for the text and font.
                    bmpEndImage = New System.Drawing.Bitmap(bmpInitialImage, New System.Drawing.Size(intWidth, intHeight))

                    ' Add the colors to the new bitmap.
                    Using gNewGraphics As System.Drawing.Graphics = System.Drawing.Graphics.FromImage(bmpEndImage)
                        ' Set Background color
                        'gNewGraphics.Clear(Color.White)
                        gNewGraphics.Clear(bgColor)
                        gNewGraphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias
                        gNewGraphics.TextRenderingHint = System.Drawing.Text.TextRenderingHint.AntiAlias

                        ''''

                        'gNewGraphics.TranslateTransform(bmpEndImage.Width, bmpEndImage.Height)
                        'gNewGraphics.RotateTransform(180)
                        'gNewGraphics.RotateTransform(0)
                        'gNewGraphics.TextRenderingHint = System.Drawing.Text.TextRenderingHint.SystemDefault

                        gNewGraphics.DrawString(strImageText, fntThisFont, New System.Drawing.SolidBrush(TextColor), 0, 0)

                        gNewGraphics.Flush()

                        If bRotate Then
                            'bmpEndImage = rotateImage(bmpEndImage, 90)
                            'bmpEndImage = RotateImage(bmpEndImage, New PointF(0, 0), 90)
                            'bmpEndImage.RotateFlip(RotateFlipType.Rotate90FlipNone)
                            bmpEndImage.RotateFlip(System.Drawing.RotateFlipType.Rotate270FlipNone)
                        End If ' bRotate

                    End Using ' gNewGraphics

                End Using ' gStringMeasureGraphics

            End Using ' bmpInitialImage

        End Using ' fntThisFont

        Return bmpEndImage
    End Function ' CreateBitmapImage

    ' http://msdn.microsoft.com/en-us/library/3zxbwxch.aspx
    ' http://msdn.microsoft.com/en-us/library/7e1w5dhw.aspx
    ' http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=286
    ' http://road-blogs.blogspot.com/2011/01/rotate-text-in-ssrs.html
    Public Shared Function GenerateImage_CrappyOldReportingServiceVariant(ByVal strText As String, ByVal strFont As String, bRotate As Boolean) As System.Drawing.Image
        Dim bgColor As System.Drawing.Color = System.Drawing.Color.LemonChiffon ' LightGray
        bgColor = System.Drawing.ColorTranslator.FromHtml("#E0E0E0")

        Dim TextColor As System.Drawing.Color = System.Drawing.Color.Black
        'TextColor = System.Drawing.Color.FromArgb(255, 0, 0, 255)

        If String.IsNullOrEmpty(strFont) Then
            strFont = "Arial"
        Else
            If strFont.Trim().Equals(String.Empty) Then
                strFont = "Arial"
            End If
        End If

        'Dim fsFontStyle As System.Drawing.FontStyle = System.Drawing.FontStyle.Regular
        Dim fsFontStyle As System.Drawing.FontStyle = System.Drawing.FontStyle.Bold
        Dim fontFamily As New System.Drawing.FontFamily(strFont)
        Dim iFontSize As Integer = 8 '//Change this as needed

        ' vice-versa, because 270° turn
        'Dim height As Double = 2.25
        Dim height As Double = 4
        Dim width As Double = 1

        ' width = 10
        ' height = 10

        Dim bmpImage As New System.Drawing.Bitmap(1, 1)
        Dim iHeight As Integer = CInt(height * 0.393700787 * bmpImage.VerticalResolution) 'y DPI
        Dim iWidth As Integer = CInt(width * 0.393700787 * bmpImage.HorizontalResolution) 'x DPI

        bmpImage = New System.Drawing.Bitmap(bmpImage, New System.Drawing.Size(iWidth, iHeight))

        '// Create the Font object for the image text drawing.
        'Dim MyFont As New System.Drawing.Font("Arial", iFontSize, fsFontStyle, System.Drawing.GraphicsUnit.Point)
        '// Create a graphics object to measure the text's width and height.
        Dim MyGraphics As System.Drawing.Graphics = System.Drawing.Graphics.FromImage(bmpImage)
        MyGraphics.Clear(bgColor)

        Dim stringFormat As New System.Drawing.StringFormat()
        stringFormat.FormatFlags = System.Drawing.StringFormatFlags.DirectionVertical
        'stringFormat.FormatFlags = System.Drawing.StringFormatFlags.DirectionVertical Or System.Drawing.StringFormatFlags.DirectionRightToLeft
        Dim solidBrush As New System.Drawing.SolidBrush(TextColor)
        Dim pointF As New System.Drawing.PointF(CSng(iWidth / 2 - iFontSize / 2 - 2), 5)
        Dim font As New System.Drawing.Font(fontFamily, iFontSize, fsFontStyle, System.Drawing.GraphicsUnit.Point)

        MyGraphics.TranslateTransform(bmpImage.Width, bmpImage.Height)
        MyGraphics.RotateTransform(180)
        MyGraphics.TextRenderingHint = System.Drawing.Text.TextRenderingHint.SystemDefault
        MyGraphics.DrawString(strText, font, solidBrush, pointF, stringFormat)
        MyGraphics.ResetTransform()

        MyGraphics.Flush()

        'If Not bRotate Then
        'bmpImage.RotateFlip(System.Drawing.RotateFlipType.Rotate90FlipNone)
        'End If

        Return bmpImage
    End Function ' GenerateImage

    ReadOnly Property IsReusable() As Boolean Implements IHttpHandler.IsReusable
        Get
            Return False
        End Get
    End Property ' IsReusable

End Class 
```

请注意，如果您认为这部分

```
 Using msTempOutputStream As New System.IO.MemoryStream
            'Dim img As System.Drawing.Image = GenerateImage(strText, "Arial", bRotate)
            Using img As System.Drawing.Image = CreateBitmapImage(strText, bRotate, strBGcolor)
                img.Save(msTempOutputStream, System.Drawing.Imaging.ImageFormat.Png)
                msTempOutputStream.Flush()

                context.Response.Buffer = True
                context.Response.ContentType = "image/png"
                context.Response.BinaryWrite(msTempOutputStream.ToArray())
            End Using ' img

        End Using ' msTempOutputStream 
```

可以替换为

```
img.Save(context.Response.OutputStream, System.Drawing.Imaging.ImageFormat.Png) 
```

因为它在开发服务器上工作，那么如果您将相同的代码部署到 Windows 2003 IIS 6 服务器上，您就错误地认为相同的代码不会引发 Generic GDI+ 异常...

然后像这样使用它：

```
<img alt="bla" src="GenerateImage.ashx?no_cache=123&text=Hello%20World&rotate=true" /> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-12-02T20:43:07.480

我对社区的第一个贡献，例如旋转简单的文本和表格的标题，仅使用 html 和 css。

![在此处输入图像描述](https://i.stack.imgur.com/AYhIl.png)

HTML

```
<div class="rotate">text</div> 
```

CSS

```
.rotate {
  display:inline-block;
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
} 
```

[这是 jsfiddle 中的一个示例](http://jsfiddle.net/omardiaze/a2uxgm44/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-07T17:36:09.093

[IE 过滤器](http://ajaxian.com/archives/transformie-implement-webkit-css-transforms-in-ie) 和 CSS 转换（[Safari](http://webkit.org/blog/130/css-transforms/)和[Firefox](https://developer.mozilla.org/En/CSS/CSS_transform_functions)）。

IE 的支持是最古老的，Safari 在 3.1.2 中[至少有一些？] 支持，而 Firefox 直到 3.1 才支持。

或者，我建议混合使用 Canvas/VML 或 SVG/VML。（Canvas 有更广泛的支持。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-08T09:48:42.167

这是一个适用于带有一些服务器端处理的纯文本：

```
public string RotateHtmltext(string innerHtml)
{
   const string TRANSFORMTEXT = "transform: rotate(90deg);";
   const string EXTRASTYLECSS = "<style type='text/css'>.r90 {"
                                 + "-webkit-" + TRANSFORMTEXT
                                 + "-moz-" + TRANSFORMTEXT
                                 + "-o-" + TRANSFORMTEXT
                                 + "-ms-" + TRANSFORMTEXT
                                 + "" + TRANSFORMTEXT
                                 + "width:1em;line-height:1ex}</style>";
   const string WRAPPERDIV = "<div style='display: table-cell; vertical-align: middle;'>";

   var newinnerHtml = string.Join("</div>"+WRAPPERDIV, Regex.Split(innerHtml, @"<br */?>").Reverse());

   newinnerHtml = Regex.Replace(newinnerHtml, @"((?:<[^>]*>)|(?:[^<]+))",
                                 match => match.Groups[1].Value.StartsWith("<")
                                             ? match.Groups[1].Value
                                             : string.Join("", match.Groups[1].Value.ToCharArray().Select(x=>"<div class='r90'>"+x+"</div>")),
                                 RegexOptions.Singleline);
   return EXTRASTYLECSS + WRAPPERDIV + newinnerHtml + "</div>";
} 
```

这给出了类似的东西：

```
<style type="text/css">.r90 {
-webkit-transform: rotate(90deg);
-moz-transform: rotate(90deg);
-o-transform: rotate(90deg);
-ms-transform: rotate(90deg);
transform: rotate(90deg);
width: 1em;
line-height: 1ex; 
}</style>
<div style="display: table-cell; vertical-align: middle;">
<div class="r90">p</div>
<div class="r90">o</div>
<div class="r90">s</div>
</div><div style="display: table-cell; vertical-align: middle;">
<div class="r90">(</div>
<div class="r90">A</div>
<div class="r90">b</div>
<div class="r90">s</div>
<div class="r90">)</div>
</div> 
```

[http://jsfiddle.net/TzzHy/](http://jsfiddle.net/TzzHy/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-08T19:47:20.663

我正在使用 Font Awesome 库，并且能够通过将以下内容附加到任何 html 元素来实现这种效果。

```
<div class="fa fa-rotate-270">
  My Test Text
</div> 
```

你的旅费可能会改变。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-14T11:04:29.427

另一种解决方案：

```
(function () {

    var make_rotated_text = function (text)
    {
        var can = document.createElement ('canvas');
        can.width = 10;
        can.height = 10;
        var ctx=can.getContext ("2d");
        ctx.font="20px Verdana";
        var m = ctx.measureText(text);
        can.width = 20;
        can.height = m.width;
        ctx.font="20px Verdana";
        ctx.fillStyle = "#000000";
        ctx.rotate(90 * (Math.PI / 180));
        ctx.fillText (text, 0, -2);
        return can;
    };

    var canvas = make_rotated_text ("Hellooooo :D");
    var body = document.getElementsByTagName ('body')[0];
    body.appendChild (canvas);

}) (); 
```

我绝对承认这是相当骇人听闻的，但如果你想避免让你的 css 臃肿，这是一个简单的解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-01-26T20:00:47.970

```
-moz-transform: rotate(7.5deg);  /* FF3.5+ */
-o-transform: rotate(7.5deg);  /* Opera 10.5 */
-webkit-transform: rotate(7.5deg);  /* Saf3.1+, Chrome */
filter:  progid:DXImageTransform.Microsoft.BasicImage(rotation=1);  /* IE6,IE7 allows only 1, 2, 3 */
-ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)"; /* IE8 allows only 1 2 or 3*/ 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-06-10T11:10:55.643

看看这个，我在寻找 IE 7 的解决方案时发现了这个。

完全是 css only vibes 的一个很酷的解决方案

感谢aiboy的灵魂

[这是链接](https://gist.github.com/aiboy/7406727 "链接")

这是我遇到此链接的堆栈溢出[链接喵](https://stackoverflow.com/questions/17286651/vertical-text-in-ie7-ie8-ie9-and-ie10-with-css-only)

```
 .vertical-text-vibes{

                /* this is for shity "non IE" browsers
                   that dosn't support writing-mode */
                -webkit-transform: translate(1.1em,0) rotate(90deg);
                   -moz-transform: translate(1.1em,0) rotate(90deg);
                     -o-transform: translate(1.1em,0) rotate(90deg);
                        transform: translate(1.1em,0) rotate(90deg);
                -webkit-transform-origin: 0 0;
                   -moz-transform-origin: 0 0;
                     -o-transform-origin: 0 0;
                        transform-origin: 0 0;  
             /* IE9+ */    ms-transform: none;    
                   -ms-transform-origin: none;    
        /* IE8+ */    -ms-writing-mode: tb-rl;    
   /* IE7 and below */    *writing-mode: tb-rl;

            } 
```

# java - 如何解析多线程写入的日志？

> ID：272803
> 
> 赞同：0
> 
> 时间：2008-11-07T17:18:26.150
> 
> 标签：java, regex, multithreading, inheritance, parsing

我有一个有趣的问题，希望您能提出最佳解决方案。我需要解析一组日志。日志由多线程程序生成，单个进程周期会生成多行日志。

在解析这些日志时，我需要从每个进程中提取特定的信息 - 自然，这些信息跨越多行（我想将这些数据压缩成一行）。由于应用程序是多线程的，属于一个进程的行块可以作为其他进程在同时写入同一个日志文件时被分段。

幸运的是，每一行都提供了一个进程 ID，因此我能够区分哪些日志属于哪个进程。

现在，已经有几个解析器都扩展了同一个类，但被设计为从单线程应用程序读取日志（无碎片 - 来自原始系统）并在超类中使用 readLine() 方法。这些解析器将继续读取行，直到所有正则表达式都匹配到一行行（即在单个进程周期中写入的行）。

那么，我可以对超类做什么，以便它可以管理碎片日志，并确保对现有已实现解析器的更改最小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T18:04:57.193

听起来您希望利用一些已经在使用的现有解析器类。在这种情况下，我会为解析器编写一个[装饰器](http://en.wikipedia.org/wiki/Decorator_pattern)，它会删除与您正在监视的进程无关的行。

听起来您的课程可能如下所示：

```
abstract class Parser {
    public abstract void parse( ... );
    protected String readLine() { ... }
}

class SpecialPurposeParser extends Parser {
    public void parse( ... ) { 
        // ... special stuff
        readLine();
        // ... more stuff
    }
} 
```

我会写一些类似的东西：

```
class SingleProcessReadingDecorator extends Parser {
    private Parser parser;
    private String processId;
    public SingleProcessReadingDecorator( Parser parser, String processId ) {
        this.parser = parser;
        this.processId = processId;
    }

    public void parse( ... ) { parser.parse( ... ); }

    public String readLine() {
        String text = super.readLine();
        if( /*text is for processId */ ) { 
            return text; 
        }
        else {
            //keep readLine'ing until you find the next line and then return it
            return this.readLine();
        }
    } 
```

然后，您要修改的任何事件都将像这样使用：

```
//old way
Parser parser = new SpecialPurposeParser();
//changes to
Parser parser = new SingleProcessReadingDecorator( new SpecialPurposeParser(), "process1234" ); 
```

此代码片段简单且不完整，但让您了解装饰器模式如何在这里工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T23:00:20.280

我会编写一个简单的分发器，它逐行读取日志文件并将它们存储在内存中的不同 VirtualLog 对象中——VirtualLog 是一种虚拟文件，实际上只是一个字符串或现有解析器可以应用的东西。VirtualLogs 以进程 ID (PID) 作为键存储在 Map 中。当您从日志中读取一行时，请检查 PID 是否已经存在。如果是这样，请将该行添加到 PID 的相应 VirtualLog。如果没有，则创建一个新的 VirtualLog 对象并将其添加到 Map。解析器作为单独的线程运行，每个 VirtualLog 上都有一个。每个 VirtualLog 对象在被完全解析后立即被销毁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T17:24:42.300

您需要将行临时存储在队列中，其中单个线程使用它们并在每组完成后传递它们。如果您无法通过行数或行的内容来了解​​集合是否完整，您可以考虑使用滑动窗口技术，在该技术直到特定时间之后才收集各个集合已通过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T17:59:24.133

这样的事情会做吗？它为日志文件中的每个进程 ID 运行一个新线程。

```
class Parser {
   String currentLine;
   Parser() {
      //Construct parser
   }
   synchronized String readLine(String processID) {
      if (currentLine == null)
         currentLine = readLinefromLog();

      while (currentline != null && ! getProcessIdFromLine(currentLine).equals(processId)
        wait();

      String line = currentLine;
      currentLine = readLinefromLog();
      notify();
      return line;
   }
}

class ProcessParser extends Parser implements Runnable{
   String processId;
   ProcessParser(String processId) {
      super();
      this.processId = processId;
   }

   void startParser() {
       new Thread(this).start();
   }

   public void run() {
      String line = null;
      while ((line = readLine()) != null) {
          // process log line here
      }
   }

   String readLine() {
      String line = super.readLine(processId);
      return line;
   } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T19:30:06.273

一种简单的解决方案是逐行读取文件并写入多个文件，每个文件对应一个进程 ID。进程 ID 列表可以保存在内存中的哈希映射中，以确定是否需要新文件或某个进程 ID 的行将进入哪个已创建的文件。写入所有（临时）文件后，现有的解析器就可以对每个文件进行处理。

# asp.net - 在 ASP.NET MVC 框架中拦截请求

> ID：272806
> 
> 赞同：4
> 
> 时间：2008-11-07T17:18:44.107
> 
> 标签：asp.net, asp.net-mvc, security, logging

是否可以在 ASP.NET MVC 框架（beta 1）中拦截请求以进行交互和检查？

我需要附加一些日志记录，并且在某些情况下动态确定 URL 是否需要授权（例如应用 Authorize 属性 - 但在运行时）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T17:39:38.853

[使用 ASP.NET MVC 操作筛选器](http://www.google.com/search?q=asp.net+mvc+action+filters)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T17:24:45.777

标准 HttpModules 工作得很好。

您还可以选择添加您自己的自定义 IRouteHandler，并专门使用它注册路由（或劫持当前路由定义并用您的路由处理程序替换它们）。

这应该为您提供所需的灵活性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T05:52:32.413

MVC 中的过滤器在编译时应用，但在运行时执行。您可以实现一个自定义身份验证过滤器，该过滤器将检查 URL 并有选择地授权。如果您提供有关您要完成的场景的更多细节，这可能会有所帮助。

# sql - 什么是好的 Visio Enterprise Architect 替代品？

> ID：272816
> 
> 赞同：21
> 
> 时间：2008-11-07T17:20:47.517
> 
> 标签：sql, database, visio, ddl, diagramming

我一直在使用 Visio 2002/2003 Enterprise Architect 直观地进行数据库架构设计，然后向前生成 DDL 以创建数据库。

我想切换到 Visio 2007，但是虽然它确实支持数据库图表，但它*没有*生成 DDL 的能力。真可惜。

我真的很失望，因为微软似乎完全放弃了这个功能。你不能在 Visual Studio（我发现）中做到这一点。如果您将数据库图表插入数据库，您可以使用 SQL Server Management Studio 进行排序，但是对架构的任何编辑都会立即生效。

有没有人找到一个好的程序来做到这一点？我希望找到一个免费的并且可以为 SQL Server 生成 DDL/SQL。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-12-22T18:53:41.553

不幸的是，我最近遇到了同样的问题，希望 MS 能够提供新版本的 Visio Enterprise Architect，因为我一直使用它来进行 ERD/数据库设计。然而，由于这似乎并没有从他们那里得到，我被迫研究其他工具。我签出的包括以下内容：

*   Embarcadero ER/工作室
*   Visual Paradigm DB 视觉架构师
*   Altova 数据库间谍
*   数据库设计
*   Sybase PowerDesigner

此外，我尝试查看 DevGEMS Data Modeler，但下载后不断收到“设置文件已损坏”。我从来没有考虑过 ERWin，因为界面看起来太老派/遗留，而且太贵了。就在我几乎放弃了找到一个全面但[相对]便宜的替代品的所有希望时，我遇到了**[ModelRight](http://www.modelright.com)**。我觉得奇怪的是，与其他高端数据库建模工具相比，我没有听到更多关于这家公司的信息，因为他们的产品非常出色且价格低廉（多数据库支持低于 1000 美元，单一数据库类型低于 500 美元）。此外，该公司是由最早在 ERwin 上工作的开发人员之一创立的（有关更多信息，请参见他们公司的“关于”页面）。

长话短说，如果您想节省一天对这个主题的研究，请先查看 ModelRight 并从那里开始。顺便说一句，为了全面披露——我与 ModelRight 公司没有任何关系！;^)

PS - 据我目前所知，VS 2010 不会提供完整的 DB 建模环境，但仅足以支持我目前没有出售的实体框架（尤其是花时间滚动我自己的 ORM 层） .

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-13T13:38:44.453

此功能仅在 Visio 的“企业架构师”版中可用。此版本显然不是作为独立产品出售的，但它包含在 MSDN Premium 中。

请参阅 Office Online 上的这篇文章：[“数据库”菜单上的“生成”和“更新”命令发生了什么变化？](http://office.microsoft.com/en-us/visio/HA101487251033.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T17:29:38.980

不是免费的，但非常好用且易于使用：[Dezign for Databases](http://www.datanamic.com/dezign/index.html)

绘制您的模型，然后您可以为许多不同的数据库生成 DDL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T17:39:57.620

我使用[Sparks Enterprise Architect](http://www.sparxsystems.com.au/)。它可以通过使用 ODBC 来创建基本数据库，而不是您可以设计和反向更改。它不是免费的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-12T05:12:25.893

哦，DBDesigner 非常好，而且是免费的。

[http://www.fabforce.net/downloads.php](http://www.fabforce.net/downloads.php)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T17:34:38.613

如果您指的是对象角色模型图，您可以 google 或 Terry Halpern。

我恢复到 VisioModeler，它在以下位置免费提供（但不受支持）

[http://www.microsoft.com/downloads/details.aspx?familyId=27fe6786-a439-4286-b8b6-7a9b84cfa709&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyId=27fe6786-a439-4286-b8b6-7a9b84cfa709&displaylang=en)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-28T02:16:11.900

我发现 Visio 对两件事很有用：

1) 流程（流程图、线框图、站点地图） 2) 逆向工程数据库

除此之外，真的没什么用。但对那些东西还是有价值的。

Enterprise Architect 是使用 DB 建模的唯一方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-12T03:27:41.487

“大”的是[CA 的 ErWin](http://www.ca.com/us/products/product.aspx?id=260)和[Embarcadero 的 ErStudio](http://www.embarcadero.com/products/erstudio/)。

另一方面，微软似乎已经意识到对建模工具的需求，因此他们正在开发一些新的建模工具（[“Oslo”](http://msdn.microsoft.com/en-us/oslo/default.aspx)），这些工具[可能]将包含在 VS 2010 中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-12T10:28:58.067

我推荐[Sybase Power Designer](http://www.sybase.com/products/modelingdevelopment/powerdesigner)

它易于使用、直观，提供部分 SQL DDL 预览（针对选定对象）并使用脚本进行自动化。脚本功能没有很好的文档记录，但是在阅读了他们的一些示例脚本后，我能够做我想做的事。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-09-22T01:00:56.650

我厌倦了从 Visio 2007 Diagrams 对我的 DDL 进行手工编码，所以我编写了一个脚本来为我编写代码。我知道这并不完美。但是，它对我有用。欢迎您在[aboutwhatever.net/posts/visio-2007-database-model-ddl-generation 试用](http://aboutwhatever.net/posts/visio-2007-database-model-ddl-generation/)。如果有足够的兴趣，我会考虑扩展它的功能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-28T11:34:40.217

Visual Studio 2010 Beta 1 有一些非常酷的数据建模工具，尤其是[ADO .Net Entity Data Model Tools](http://msdn.microsoft.com/en-us/library/bb399249(VS.100).aspx)。是的，您可以从模型中生成 DDL。

# php - Magento 产品按类别

> ID：272818
> 
> 赞同：14
> 
> 时间：2008-11-07T17:20:54.303
> 
> 标签：php, magento, categories, product, catalog

[有谁知道我如何从Magento](http://www.magentocommerce.com/)的视图文件中获取属于特定类别的产品列表？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-04-06T12:55:39.473

您可以使用 magento 对象进行过滤。

例子：

```
$categoryId = 123; // a category id that you can get from admin
$category = Mage::getModel('catalog/category')->load($categoryId);

$products = Mage::getModel('catalog/product')
    ->getCollection()
    ->addCategoryFilter($category)
    ->load();

print_r($products); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-17T16:07:11.117

这完全取决于您所处的视图。;-)

首先，我希望你留在你的模板集中（在我的例子中是默认的）。

以此**为例**：

```
<?php
$_cat         = $this->getCurrentCategory();
$_parent      = $_cat->getParentCategory();
$_categories  = $_parent->getChildren();

/* @var $category Mage_Catalog_Model_Category */
$collection = Mage::getModel('catalog/category')->getCollection();
/* @var $collection Mage_Catalog_Model_Resource_Eav_Mysql4_Category_Collection */
$collection->addAttributeToSelect('url_key')
    ->addAttributeToSelect('name')
    ->addAttributeToSelect('is_anchor')
    ->addAttributeToFilter('is_active', 1)
    ->addIdFilter($_categories)
    ->setOrder('position', 'ASC')
    ->joinUrlRewrite()
    ->load();

$productCollection = Mage::getResourceModel('catalog/product_collection');
$layer             = Mage::getSingleton('catalog/layer');
$layer->prepareProductCollection($productCollection);
$productCollection->addCountToCategories($collection);
// $productCollection should be ready here ;-)
?> 
```

我正在使用上面的代码在我的模板中显示姐妹类别 - 这并不理想，但它可以工作。

这有点像 hack，因为我还没有时间学习所有的布局 XML 疯狂。否则，如果您使用 XML，则需要牢记——这完全取决于您所处的位置。**where**表示模板文件，本质上也是布局（在 app/design/frontend/default/default/layout/* 方面）。

我知道这并不多，但我希望它可以帮助您入门。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-04-04T09:56:15.493

这是从任何特定类别获取产品的代码。您也可以在视图文件中使用它。

```
// if you want to display products from current category
$category = Mage::registry('current_category'); 

// if you want to display products from any specific category
$categoryId = 10;
$category = Mage::getModel('catalog/category')->load($categoryId);

$productCollection = Mage::getResourceModel('catalog/product_collection')
                                 ->addCategoryFilter($category);

// printing products name
foreach ($productCollection as $product) {
    echo $product->getName(); 
    echo "<br />";
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-07-18T07:21:13.273

```
<?php
$c_id = 2;
$category = new Mage_Catalog_Model_Category();
$category->load($c_id);
$collection = $category->getProductCollection();
$collection->addAttributeToSelect('*');
foreach ($collection as $_product) { ?>
<a href="<?php echo $_product->getProductUrl(); ?>"><?php echo $_product->getName(); ?></a>
<?php } ?> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-09T12:21:59.223

我非常需要同样的东西。以下是我的做法：

```
$prod_whole = array();
if(!empty($_menu)) //$_menu = array of Categories with some basic info
foreach($_menu as $v)
{
    if($v['name']=='HOME')
    continue;

    $cat_id = $v['id'];

    #/ Setup Products
    $category = Mage::getModel('catalog/category')->load($cat_id);

    $collection = Mage::getModel('catalog/product')->getCollection()
    ->addAttributeToSelect('*') // select all attributes
    ->addCategoryFilter($category)
    ->setPageSize(8) // limit number of results returned
    ->setCurPage(0)
    ->load()
    ;

    $prod_collection = array();
    foreach ($collection as $product)
    {
      $prod_collection_1 = array();

      #/ Basic Info
      $prod_collection_1['id'] = $product->getId();
      $prod_collection_1['name'] = $product->getName();
      $prod_collection_1['price'] = (float) $product->getPrice();
      //$prod_collection_1['desc'] = $product->getDescription();
      //$prod_collection_1['short'] = $product->getShortDescription();
      $prod_collection_1['type'] = $product->getTypeId();
      $prod_collection_1['status'] = $product->getStatus();
      $prod_collection_1['special_price'] =  $product->getSpecialPrice();
      $prod_collection_1['direct_url'] =  $product->getProductUrl();

      #/ getCategoryIds(); returns an array of category IDs associated with the product
      foreach ($product->getCategoryIds() as $category_id)
      {
          $category = Mage::getModel('catalog/category')->load($category_id);
          $prod_collection_1['parent_category'] = $category->getParentCategory()->getName();
          $prod_collection_1['category'] = $category->getName();
          //$prod_collection_1['category_idx'] = preg_replace('/[\s\'\"]/i', '_', strtolower(trim($prod_collection_1['category'])));
          $prod_collection_1['category_id'] = $category->getId();
      }

      #/gets the image url of the product
      $prod_collection_1['img'] = Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_MEDIA).'catalog/product'.$product->getImage();

      $prod_collection[] = $prod_collection_1;

    }//end foreach.....

    $prod_whole[$cat_id] = $prod_collection;

}//end foreach categories.......
//var_dump('<pre>', $prod_whole); 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-05-07T07:33:31.890

```
<?php

    $category_id = 10; // if you know static category then enter number

$catagory_model = Mage::getModel('catalog/category')->load($category_id); //where $category_id is the id of the category

     $collection = Mage::getResourceModel('catalog/product_collection');

        $collection->addCategoryFilter($catagory_model); //category filter

        $collection->addAttributeToFilter('status',1); //only enabled product

        $collection->addAttributeToSelect(array('name','url','small_image')); //add product attribute to be fetched

        //$collection->getSelect()->order('rand()'); //uncomment to get products in random order    

        $collection->addStoreFilter();          

        if(!empty($collection))

        {

                foreach ($collection as $_product):

                echo $_product->getName();   //get product name        

            endforeach;

        }else

            {

                echo 'No products exists';

        }              

    ?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-11T10:26:26.920

您应该始终避免将这样的代码放入视图中，这是非常糟糕的做法。您还可能遇到问题，因为可以缓存视图，从而导致意外行为。

你应该覆盖你正在使用的块，在那里放置代码。然后，您可以在视图文件中调用任何新方法。

例如，您可以复制 Mage_Catalog_Block_Product_List

来自：app/code/core/Catalog/Block/Product/List.php

到：app/code/local/Catalog/Block/Product/List.php

然后，您可以添加一个新方法，可能使用上述帖子中提到的一些代码。然后，您的新方法将在您的视图文件中可用（list.phtml 或使用此块的任何视图）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-13T09:15:18.533

这是将所有产品及其类别导出到 csv 的代码

```
<?php 
set_time_limit(0);
ini_set("memory_limit",-1);
ini_set('max_execution_time','1800000000');

require_once '../app/Mage.php';
Mage::app(); 

$category = Mage::getModel('catalog/category');
$tree = $category->getTreeModel();
$tree->load();

$ids = $tree->getCollection()->getAllIds();
$fp = fopen('category-product-export.csv', 'w');
$field = array('Product SKU','Category Name'); 
fputcsv($fp, $field);

$_productCollection = Mage::getModel('catalog/product')
                        ->getCollection()
                        ->addAttributeToSelect('*')
                        ->addFieldToFilter('visibility', Mage_Catalog_Model_Product_Visibility::VISIBILITY_BOTH)
                        ->load();

foreach ($_productCollection as $_product){
   $cats = $_product->getCategoryIds();
   $cnt = 0;
   $catName = '';
    foreach($cats as $id) {
        $category->load($id);
        $root = 'Root Catalog';
            $isRoot = strtolower($root);
            $categoryName = strtolower($category->getName());
            if($categoryName == $isRoot){
                continue;
            }
        $categories[$id]['name'] = $category->getName();
        $categories[$id]['path'] = $category->getPath();

        $path = explode('/', $categories[$id]['path']);
        $len = count($path);
        $string = '';
        if($id > 2){
            foreach ($path as $k=>$pathId)
            {
                $separator = '';
                if($pathId > 2){
                    $category->load($pathId);
                    if($k != $len-1){ $separator = ' || ';}
                    $string.= $category->getName() . $separator;
                }

            }
            if($cnt > 0) {
                $catName.= ','.$string;
            } else {
                $catName = $string;
            }

            $cnt++;
        }
    }
    //echo $catName;
    $field = array($_product->getSku(),$catName); 
    fputcsv($fp, $field);   

} 

?>
<a href="category-product-export.csv">Download</a> 
```

# c# - 从 C# 中引用的 DLL 获取正在执行的程序集名称

> ID：272821
> 
> 赞同：39
> 
> 时间：2008-11-07T17:21:17.767
> 
> 标签：c#, .net

从 C# 中引用的类库中获取执行程序集的应用程序名称（即 MyApplication.exe）的最佳方法是什么？

我需要打开应用程序的 app.config 来检索引用的 DLL 的一些 appSettings 变量。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-07T17:24:36.823

要获得问题标题的答案：

```
// Full-name, e.g. MyApplication, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
string exeAssembly = Assembly.GetEntryAssembly().FullName;

// or just the "assembly name" part (e.g. "MyApplication")
string exeAssemblyName = Assembly.GetEntryAssembly().GetName().Name; 
```

正如@Ben 所提到的，既然您提到想要获取配置信息，请使用`ConfigurationManager`该类。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-07T17:27:29.127

如果你想获取当前 appdomain 的配置文件，那么你需要做的就是：

`ConfigurationManager.AppSettings`……

（这当然需要参考 System.Configuration）。

要回答您的问题，您可以按照 Ray 所说的（或使用`Assembly.GetExecutingAssembly().FullName`）进行操作，但我认为使用`ConfigurationManager`.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-07-14T18:36:01.217

要获得没有版本等的确切名称，请使用：

```
string appName = Assembly.GetEntryAssembly().GetName().Name; 
```

适用于 .NET v1.1 及更高版本。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-09T21:29:02.030

您可以通过类类型获取程序集...

```
typeof(MyClass).Assembly 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-18T23:44:58.553

您永远不应该将您的库与消费者（在本例中为 Web、WinForm 或 WCF 应用程序）耦合。如果您的库需要配置设置，则将其提供给库。

不要对库进行编码以从消费者的配置文件中提取该数据。为此提供重载的构造函数（这就是它们的用途）。

如果您曾经看过该`ConfigurationManager.AppSettings`对象，那它只是一个`NameValueCollection`. 因此，在您的库中创建一个构造函数来接受 a`NameValueCollection`并让您的消费者将该数据提供给库。

```
//Library
public class MyComponent
{
  //Constructor
  public MyComponent(NameValueCollection settings)
  {
     //do something with your settings now, like assign to a local collection
  }
}

//Consumer
class Program
{
  static void Main(string[] args)
  {
    MyComponent component = new MyComponent(ConfigurationManager.AppSettings);
  }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-04-09T14:37:19.817

如果你想要父 EXE 的名称而不是引用的 DLL 程序集 - 你需要使用这个：

```
Assembly.GetEntryAssembly().GetName().Name 
```

这将返回 EXE 名称（减去 .EXE 部分）。

根据 OP 的问题（第一段！），使用 GetExecutingAssembly() 是不正确的，因为它将返回 DLL 名称。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-01-12T09:50:35.537

如果您想阅读（并显示）版本号：

```
 Assembly ass = System.Reflection.Assembly.GetExecutingAssembly();
  AssemblyName assname = ass.GetName();

  Version ver=assname.Version; 
```

应用程序中的某处（即 Windows 窗体中的标题栏）

```
 this.Text = "Your title    Version " + ver; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-01T21:32:30.010

对于来自类实例的程序集的简称：

```
Me.GetType ().Assembly.GetName().Name 
```

# php - Python 的 os.execvp 等价于 PHP

> ID：272826
> 
> 赞同：4
> 
> 时间：2008-11-07T17:21:55.940
> 
> 标签：php, python, shell, command-line-interface

我有一个 PHP 命令行程序正在运行。我想直接从 PHP 连接到 mysql shell。我以前在 Python 中使用 os.execvp 做过这个，但是我不能在 PHP 中做同样的事情。

我尝试了以下功能：

*   系统
*   通路
*   执行
*   shell_exec

例子：

```
system('mysql -u root -pxxxx db_name'); 
```

但是他们似乎都在等待mysql退出并返回一些东西。我真正想要的是让 PHP 启动 mysql shell，然后自行退出。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T23:28:59.973

如果您希望 shell 命令是交互式的，请使用：

```
system("mysql -uroot -p db_name > `tty`"); 
```

这适用于大多数情况，但如果您不在终端中，则会中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T17:26:48.333

给 MySQL 一个独立于 PHP 脚本运行的脚本：

```
system('mysql -u root -pxxxx db_name < script.mysql'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T17:37:35.440

除了 acrosman 说的，还可以使用`-e`switch 从命令行传递 SQL。

```
$sql = ".....";
system("mysql -u root -pxxxx db_name -e \"$sql\""); 
```

另外，我希望您实际上没有从 PHP 应用程序以 root 身份连接到数据库。

# excel - 在 Excel 范围 (IRange) 上调用 Select 时出现 0x800a03ec。范围是从工作表的 usedrange 返回的

> ID：272847
> 
> 赞同：1
> 
> 时间：2008-11-07T17:27:18.113
> 
> 标签：excel, automation, ole, dsoframer

我正在尝试选择“使用范围”。我得到了工作表的 UsedRange，然后在其上调用 Select 函数。我在选择调用中收到 HRESULT 0x800a03ec。

这是代码：

COleVariant 结果；

HRESULT hr = AutoWrap(DISPATCH_METHOD, &result, irange, L"Select", 0);

我不会费心发布 AutoWrap 功能的代码（除非有人问）。它非常有名，我没有修改它。

我很确定 irange 很好，因为我尝试了一些调用来验证它是否符合我的期望，并且确实如此。如果我遍历它，我可以看到每个单元格的内容（并且是正确的）；返回的行数和列数是正确的，并且返回的“地址”属性签出。

工作表未锁定。

我已经看到发布与区域设置有关的其他问题，并且我的系统设置为美国英语，我的用户帐户也是如此。两者都没有改变。

希望有人能帮忙！

**更新**：我也试过

```
hr = iRange->Select(vResult); 
```

这确实返回 S_OK，但它不选择范围。通常，我不能直接调用 iRange 结构中的函数；结果是 gpf 或访问冲突——所以我必须使用 autowrap 函数（来驱动 Invoke 调用）。我对这个电话不起作用并不感到惊讶。

我还尝试以非只读模式打开 excel 文件，以防我被锁定。这并没有解决问题。我可以通过从范围中获取单个项目（单元格）并调用其 Select 来选择单个单元格，但我无法选择范围。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T19:21:37.170

我找到了这个问题的答案。仅当在 DSOFRAME 示例 (Microsoft KB 311765) 中使用时才会出现问题。DSOFramer 是用于嵌入 MS Office 文档的通用 ActiveX 控件。该问题也仅发生在调试版本中；发布版本很好。

我还发现了一种适用于发布或调试版本的解决方法：获取范围内的任何单元格（使用 get_Item），然后对该项目调用 select，然后再次选择以取消选择它。完成后，可以在范围上调用选择。显然，如果已经选择了一个单元格（或者如果选择状态未定义），则无法在范围上调用 select。

# php - PHP 用 Joomla 中的 GD 库重采样图像替换图像

> ID：272852
> 
> 赞同：1
> 
> 时间：2008-11-07T17:28:05.443
> 
> 标签：php, image, joomla, gd

我是一家在线独立报纸的技术实习生，工作人员的作家并不精通技术。他们不太了解网页的工作原理，通常他们直接从数码相机上传和包含图像，或者从原始媒体扫描。当首页上有 10 张图片，每张 3.5Mb 时，这些图片就会成为负担。

我们正在尝试制定某种培训方法来教他们如何调整和优化他们想要包含在文章中的图像，但就像我说的那样，他们不是很精通技术，我们尝试采用的任何方法都可以远远超过他们的头顶。

因此，我想知道尝试使用 PHP 函数和 GD 库对文章中包含的图像进行重新采样和缓存以简化每篇文章必须传递的数据量是否不合理。

我认为这是可能的，我只是想弄清楚花时间和精力来培训作家是否值得，或者创建一个自动化流程是否会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T17:31:08.387

您最好在上传过程中进行 GD 图像处理。GD 会占用相当多的资源，因此在每个请求上处理每个图像并不是一个可取的解决方案。如果您在上传过程中无法做到这一点，您应该缓存所有重新采样的图像，并在可用时使用这些图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T17:32:42.593

这当然是可能的，如果 Joomla！还没有可以做到这一点的模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T23:56:33.560

对于我正在开发的当前网站，我需要回答一个类似的问题。我选择使用 joomla 插件[Easy Gallery](http://www.joomla-addons.org/components/easy-gallery/easy-gallery.html)。对我来说，两个突出的功能是自动缩略图创建和图像调整大小功能。尺寸可通过组件配置页面进行配置。每次上传都会有一个缩略图、一个调整大小的图像和原始图像。

此组件是 Joomla 1.0 组件，因此，如果您正在运行 Joomla 1.5 安装，您将需要打开旧模式。本机 1.5 版本的工作似乎正在进行中。

我还发现了几个没有显示生成缩略图的地方。[我在Easy Gallery 论坛](http://forum.joomla-addons.org/index.php?topic=3196.0)上提出了这个问题，并设法为自己找到了答案。

# .net - WPF 树视图绑定

> ID：272854
> 
> 赞同：8
> 
> 时间：2008-11-07T17:28:23.070
> 
> 标签：.net, wpf, linq, entity-framework, data-binding

我有一个带有 Parent 和 Children 属性的类。

[ADO.NET 实体框架分层页面类 http://img148.imageshack.us/img148/6802/edmxxe8.gif](http://img148.imageshack.us/img148/6802/edmxxe8.gif)

我想在 WPF 树视图中显示这个层次结构。

这是我的 XAML ......

```
<TreeView Margin="12" Name="TreeViewPages" ItemsSource="{Binding}">
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding Children}">
            <TextBlock Text="{Binding Path=ShortTitle}" />
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

还有我的VB代码...

```
Dim db 作为新的 PageEntities
Dim t = From p In db.Page.Include("Children") _
        p.Parent 什么都不是 _
        选择 p
TreeViewPages.ItemsSource = t

```

但后来我只得到一棵两层深的树。我需要做什么才能使它正常工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-07T17:57:46.507

这不起作用的原因是您只为 TreeView 指定了 DataTemplate。由于它生成的 TreeViewItems 也是 ItemsControls，因此它们也需要设置 ItemTemplate。

实现您希望的最简单方法是将 HierarchicalDataTemplate 放在 TreeView（或其任何父视觉对象）的资源中，并设置 HierarchicalDataTemplate 的 DataType 以便将其应用于您的所有项目。

在容器的声明（很可能是窗口）中，您需要定义到定义 page 的命名空间的映射。

例如

```
<Window ...
    xmlns:local="clr-namespace:NamespaceOfPageClass;assembly=AssemblyWherePageIsDefined">

<TreeView Margin="12" Name="TreeViewPages" ItemsSource="{Binding}" />
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType=”{x:Type local:Page}” ItemsSource="{Binding Children}">
            <TextBlock Text="{Binding Path=ShortTitle}" />
        </HierarchicalDataTemplate>
    </TreeView.Resources>
</TreeView> 
```

# dns - 如何在地址栏中保留域名

> ID：272862
> 
> 赞同：0
> 
> 时间：2008-11-07T17:30:46.997
> 
> 标签：dns

除了使用主机之外，有没有更好的方法来保持地址栏中的域名不变？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T17:34:50.920

使用框架（或其他一些内部窗口，通过 Flash 或 Silverlight 等）确实是唯一的方法 - 如果您尝试使用 JavaScript 修改主窗口的位置，它会将页面的位置更改为您指定的 URL ，所以这也不会真正起作用。

您应该注意[**RESTful**](http://en.wikipedia.org/wiki/Representational_State_Transfer)原则 - 不允许地址栏中的 URL 反映域中用户的真实位置的意图是什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T17:34:26.350

您可以使用 AJAX 更改页面的内容，而无需更改地址。

但是，如果数据位于另一个域上，则地址应更改为指向该域。此外，建议可以将地址添加到书签中，以便用户可以轻松地返回数据。地址应该反映它指向的资源的内容。

# performance - “学生和储物柜”问题的最佳解决方案是什么？

> ID：272868
> 
> 赞同：4
> 
> 时间：2008-11-07T17:31:21.990
> 
> 标签：performance

我觉得介绍一些经典的CS问题，让人们展示他们的算法优化技能会很有趣。希望我们能够看到一些巧妙的技术来解决我们可以在实践中实现的抽象问题。

理想情况下，解决方案将以具有大 O 分类的伪代码呈现。该分类的证据是肉汁。关于问题：

有 N 个封闭的储物柜和 N 个学生在场。第一个学生打开每个储物柜。第二个学生每隔一秒打开或关闭储物柜。这会在第 n 个学生每隔第 n 个储物柜打开和关闭的地方继续进行。在 N 个学生之后，哪些储物柜是打开的？有多少储物柜是开着的？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-07T17:45:26.780

学生只会翻转他们的数字是除数的那些储物柜的状态（学生 2 翻转偶数储物柜，学生 3 翻转可被 3 整除的储物柜，依此类推......）。因此，在 N 轮之后保持打开的唯一储物柜是那些具有奇数除数的储物柜（因为它们开始关闭，奇数翻转将使其保持打开状态）。唯一具有奇数除数的数字是完全平方数，因此所有完全平方数的储物柜都将保持打开状态。所以在 N 轮之后，打开的储物柜数量将是 N 的平方根（下限）。

这个解决方案将是 O(sqrt(N)) 来准确知道**哪些**储物柜是打开的，但是如果你只需要知道**有多少**储物柜是打开的，则需要 O(1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-25T13:39:47.307

这是我的答案，没有使用数组（或对象等），也没有使用平方根方法。

====

# 包括

使用命名空间标准；

int main() {

int studentTotal，lockerTotal，访问，totalOpened = 0，totalClosed = 0；

cout << "输入学生人数" << endl; cin >> 学生总数;

储物柜总数 = 学生总数；

```
for (int locker = 1; locker <= lockerTotal;  locker++ ){ // locker loop
    cout << "\n\n\nLocker no." << locker << endl;
    cout << " is visited by student(s) ";
    visit = 0;
    for (int student = 1 ; student <= studentTotal; student++) { // student loop

    if( locker % student == 0) {
            cout << student << ", ";
            visit++;}

    }//end of locker loop

    cout << "\nTotal number of visits: " << visit;
    if (visit % 2 == 0){
        cout << " the locker will stay closed.";
        totalClosed++;}
    else { cout << " the locker will be opened.";
        totalOpened++;}

} //end of student loop

if (lockerTotal == totalOpened + totalClosed) {
    cout << "\n\n\nOf total lockers (" << lockerTotal << "), " << totalOpened << " will be left open." << "(" << totalClosed << ") " << "will be closed." << endl;
    }else cout << "Error!!";

return 0; 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T17:49:38.457

在 O(log N) 中，基于系列 1+2k 之后打开储物柜的间隔：

```
delta=1

for(index=1;index < N;index+=delta) {
   print open locker = index;
   delta+=2;
   opencount++;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-09T16:02:07.103

我想我会看到我能多快在 Perl 中想出一个解决方案。

```
use strict;
use warnings;
use 5.010;

sub lockers{
  my($number_of_lockers) = @_;

  my $largest_sqrt = sqrt $number_of_lockers;

  my @list;

  for( my $index = 1; $index <= $largest_sqrt; ++$index ){
    push @list, $index**2;
  }

  return @list;
}

say for lockers 100; 
```

```
1
4
9
16
25
36
49
64
81
100

```

或者，如果您不想计算储物柜数量的平方根。

```
use strict;
use warnings;
use 5.010;

sub lockers{
  my($number_of_lockers) = @_;

  my @list;

  for(
    my($index,$sqr) = (1,1);
    $sqr <= $number_of_lockers;
    $sqr = (++$index)**2
  ){
    push @list, $sqr;
  }

  return @list;
}

say for lockers 100; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-28T03:30:02.663

刚刚将此作为硬件任务。

```
for(int i = 0; i < SIZE / 2; i++){
   for(int k = i; k < SIZE; k = k+i+1){
      if(lockers[k] == false)
        lockers[k] = true;
      else
        lockers[k] = false;
   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-07T14:43:18.567

代码最少的简单解决方案。

作者：莫阿扎姆·阿里

```
 public class CH3 { 
```

` public static void main (String [] args) { boolean [] lockers= new boolean [100];

```
 for(int i=0;i<100;i++){
        lockers[i]=true;
                          }

    for(int s=2;s<100;s++){
        for(int y=s; y<100;y=y+s){
            if(lockers[y]==true){
                lockers[y]=false;
                               }
            else{
                lockers[y]=true;
                }
                              }
                          }
System.out.println("open lockers are:");
for(int i=0;i<100;i++){
if(lockers[i]==true){

System.out.print(i+"  ");
}
} 
```

}}

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-03-13T11:26:18.387

*下面是使用蛮力方法的java代码。它检查每个学生，以及他对每个特定储物柜所做的事情。有更好的方法。假设有 100 名学生和 100 个储物柜。然后学生 1、学生 2 和学生 3 将触碰第六储物柜。1X1、2X3、3X2。但只有带正方形的储物柜才会有偶数学生触摸它们。*

**因此，更好的解决方法是找出数字之间存在的正方形。**

***Java 代码：***

```
 int l, s;
  Scanner in = new Scanner(System.in);
  System.out.println("Enter the number of lockers");
  l = in .nextInt();
  System.out.println("Enter the number of students");
  s = in .nextInt();
  if (l

   boolean lockers[] = new boolean[l + 1]; 
   boolean students[] = new boolean[s + 1]; lockers[0] = true; students[0] = true;
   for (int i = 1; i <= l; i++) {
lockers[i] = false;
   }

   for (int j = 1; j <= s; j++) {
for (int h = 1; h <= l; h++) {
 if (h % j == 0) {
  if (lockers[h] == true) lockers[h] = false;
  else lockers[h] = true;
 }

}
 }
   System.out.println("the lockers which are open are ");
   for (int k = 1; k <= l; k++) {
       if (lockers[k] == true) {
       System.out.print(" " + k);
   }
 } 
```

# c - C 的 strtok() 和只读字符串文字

> ID：272876
> 
> 赞同：5
> 
> 时间：2008-11-07T17:32:47.930
> 
> 标签：c, string, strtok

> char *strtok(c​​har *s1, const char *s2)
> 
> 对该函数的重复调用将字符串 s1 分解为“标记”——即字符串被分解为子字符串，每个子字符串以 '\0' 结尾，其中 '\0' 替换字符串 s2 中包含的任何字符。第一次调用使用要标记为 s1 的字符串；随后的调用使用 NULL 作为第一个参数。返回指向当前标记开头的指针；如果没有更多标记，则返回 NULL。

你好，

我刚才一直在尝试使用`strtok`，发现如果我传入一个`char*`into `s1`，我会得到一个分段错误。如果我通过 a `char[]`，`strtok`工作正常。

为什么是这样？

我四处搜索，原因似乎是关于如何`char*`只读和`char[]`可写的。更彻底的解释将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-07T17:40:59.053

你初始化了`char *`什么？

如果像

```
char *text = "foobar"; 
```

然后你有一个指向一些只读字符的指针

为了

```
char text[7] = "foobar"; 
```

然后你有一个七元素的字符数组，你可以做你喜欢的事情。

`strtok`写入您给它的字符串 - 用分隔符覆盖`null`并保留指向字符串其余部分的指针。

因此，如果您将只读字符串传递给它，它将尝试写入它，并且您会得到一个段错误。

此外，因为`strtok`保留了对字符串其余部分的引用，所以它不是可重入的 - 您一次只能在一个字符串上使用它。最好避免，真的 - 请考虑 strsep(3) - 例如，请参见：[http](http://www.rt.com/man/strsep.3.html) ://www.rt.com/man/strsep.3.html （尽管它仍然写入字符串，因此具有相同的读取-仅/段错误问题）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-08T19:22:22.107

推断但未明确说明的重要一点：

根据您的问题，我猜您对 C 编程相当陌生，所以我想多解释一下您的情况。如果我弄错了，请原谅我；C 可能很难学习，主要是因为对底层机制的微妙误解，所以我喜欢让事情尽可能简单。

如您所知，当您编写 C 程序时，编译器会根据语法为您预先创建所有内容。当您在代码中的任何位置声明变量时，例如：

`int x = 0;`

编译器读取这行文本并对自己说：好的，我需要将当前代码范围内的所有出现替换为`x`对我分配用于保存整数的内存区域的常量引用。

当你的程序运行时，这一行会导致一个新的动作：我需要设置`x`引用`int`value的内存区域`0`。

请注意这里的细微差别：参考点所在的内存位置`x`是恒定的（并且不能更改）。但是，`x`可以更改点的值。您可以通过分配在代码中执行此操作，例如`x = 15;`. 另请注意，单行代码实际上相当于编译器的两个单独命令。

当您有如下声明时：

`char *name = "Tom";`

编译器的过程是这样的：好的，我需要将当前代码范围中的所有出现替换为`name`对我分配用于保存`char`指针值的内存区域的常量引用。它确实如此。

但是还有第二步，这相当于：我需要创建一个常量数组，其中包含值 'T'、'o'、'm' 和`NULL`。然后我需要用`"Tom"`该常量字符串的内存地址替换代码的一部分。

当你的程序运行时，最后一步发生：将指向`char`' 值的指针（不是常量）设置为自动创建的字符串的内存地址（它*是*常量）。

所以 a`char *`不是只读的。只有 a`const char *`是只读的。但是在这种情况下，您的问题不是`char *`s 是只读的，而是您的指针引用了只读的内存区域。

我提出这一切是因为理解这个问题是您从库中查看该函数的定义和自己理解问题与不得不问我们之间的障碍。我已经稍微简化了一些细节，希望让这个问题更容易理解。

我希望这可以帮到你。;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T19:34:40.413

我责怪C标准。

```
char *s = "abc"; 
```

可以定义为给出相同的错误

```
const char *cs = "abc";
char *s = cs; 
```

因为字符串文字是不可修改的。但它不是，它被定义为编译。去搞清楚。[编辑：Mike B 已经想通了——K&R C 中根本不存在“const”。ISO C 以及此后的每个版本的 C 和 C++，都希望向后兼容。所以它必须是有效的。]

如果它被定义为给出错误，那么你就不可能达到段错误，因为 strtok 的第一个参数是 char*，所以编译器会阻止你传入从文字生成的指针。

可能有趣的是，曾经有一个 C++ 计划要弃用它（[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/1996/N0896.asc](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/1996/N0896.asc)）。但是 12 年后，我无法说服 gcc 或 g++ 给我任何警告，让我将文字分配给非常量 char*，所以它并没有被大声反对。

[编辑：啊哈：-Wwrite-strings，不包含在 -Wall 或 -Wextra 中]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T01:21:53.783

简单来说：

```
char *s = "HAPPY DAY";
printf("\n %s ", s);

s = "NEW YEAR"; /* Valid */
printf("\n %s ", s);

s[0] = 'c'; /* Invalid */ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T01:45:35.940

如果您查看编译器文档，很可能有一个选项可以设置为使这些字符串可写。

# xml - XML 和 iSeries RPGLE - 开发工具？

> ID：272877
> 
> 赞同：3
> 
> 时间：2008-11-07T17:33:00.847
> 
> 标签：xml, ibm-midrange, rpgle

我有一个 iSeries 到 .Net 紧凑型框架项目。它包括作为 Web 服务公开的 rgple 程序和使用 Web 服务的 Windows 移动应用程序。每个 iSeries 程序都有一个特定的 web 服务包装器和 .net 应用程序引用。我想提出一个使用 XML 的更通用的消息传递服务。

我对在 .Net 中处理 XML 相当熟悉。但是没有在 iSeries 上使用 XML 的经验。您会推荐哪些 iSeries XML 工具？以及如何最好地开始/学习 iSeries 上的 XML 处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T18:00:47.967

IBM 为 IBM System i5 提供[XML Toolkit](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/rzamj/rzamjmain.htm)。

您还可以运行具有[XML 解析器](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/rzahh/rzahhxmlparserxslprocessor.htm)的 Java 。

RPG 还对语言中内置[的 XML 提供了一些支持。](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/books_web/c0925076167.htm)

您可以通过阅读这些链接中的 IBM 文档开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T18:54:30.823

还有[RPG-XML 套件](http://www.rpg-xml.com)。他们编写了一个包装器以使其更容易。但是我没有使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-10T19:18:21.910

我使用了 Krengletech 的 RPG-XML 套件，效果非常好。提供的过程都在一个绑定目录中，因此很容易将它们添加到您的程序中。还有几个示例，您可以从中剪切和粘贴，详细解释所有内容。AAron 还提供了一些命令，可以轻松地从头开始创建一个程序，该程序要么解析传入的 xml 文件，要么构建一个模板来创建您自己的 web 服务程序。我也对从他们那里得到的支持感到非常高兴。几天后，我的第一个 Web 服务程序就启动并运行了。

# mercurial - mercurial 的 hgwebdir.cgi 中的图形更改日志

> ID：272881
> 
> 赞同：3
> 
> 时间：2008-11-07T17:34:25.523
> 
> 标签：mercurial, hgweb

我有一组通过 hgwebdir.cgi 在线提供的 mercurial 存储库。我希望能够以与[该站点](http://hg.serpentine.com/mercurial/book/graph)相同的方式显示分支和合并的图形表示。我似乎找不到任何关于如何做到这一点的参考。该功能是否仅存在于 hgweb 而不是 hgwebdir 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T09:57:22.483

这个未来将在下一个版本中启用，尝试使用 repo 中的开发版本。

在控制台中你可以使用[glog 扩展](http://www.selenic.com/mercurial/wiki/index.cgi/GraphlogExtension)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T04:52:57.120

在 1.1 版发布之前（几天后），您需要从[Mercurial 船员存储库进行克隆和安装](http://hg.intevation.org/mercurial/crew/)

# c++ - 对静态类成员的未定义引用

> ID：272900
> 
> 赞同：211
> 
> 时间：2008-11-07T17:39:56.217
> 
> 标签：c++, g++

谁能解释为什么以下代码无法编译？至少在 g++ 4.2.4 上。

更有趣的是，为什么当我将 MEMBER 转换为 int 时它会编译？

```
#include <vector>

class Foo {  
public:  
    static const int MEMBER = 1;  
};

int main(){  
    vector<int> v;  
    v.push_back( Foo::MEMBER );       // undefined reference to `Foo::MEMBER'
    v.push_back( (int) Foo::MEMBER ); // OK  
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2008-11-07T17:57:35.213

您需要在某处实际定义静态成员（在类定义之后）。试试这个：

```
class Foo { /* ... */ };

const int Foo::MEMBER;

int main() { /* ... */ } 
```

那应该摆脱未定义的引用。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2008-11-07T18:00:46.907

问题的出现是因为新的 C++ 功能和您正在尝试做的事情之间发生了有趣的冲突。首先，让我们看一下`push_back`签名：

```
void push_back(const T&) 
```

它期望引用类型的对象`T`。在旧的初始化系统下，存在这样的成员。例如，以下代码编译得很好：

```
#include <vector>

class Foo {
public:
    static const int MEMBER;
};

const int Foo::MEMBER = 1; 

int main(){
    std::vector<int> v;
    v.push_back( Foo::MEMBER );       // undefined reference to `Foo::MEMBER'
    v.push_back( (int) Foo::MEMBER ); // OK  
    return 0;
} 
```

这是因为某处存在一个实际对象，其中存储了该值。但是，如果您像上面那样切换到指定静态 const 成员的新方法，`Foo::MEMBER`则不再是对象。它是一个常数，有点类似于：

```
#define MEMBER 1 
```

但是没有预处理器宏的麻烦（并且具有类型安全性）。这意味着需要参考的向量无法获得参考。

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2008-11-07T18:03:49.927

如果以某种方式需要定义，C++ 标准需要为您的静态 const 成员定义。

定义是必需的，例如，如果使用它的地址。 `push_back`通过 const 引用获取其参数，因此严格来说编译器需要您的成员的地址，您需要在命名空间中定义它。

当您显式转换常量时，您正在创建一个临时对象，并且它是绑定到引用的临时对象（根据标准中的特殊规则）。

这是一个非常有趣的案例，我实际上认为值得提出一个问题，以便将 std 更改为对您的常量成员具有相同的行为！

虽然，以一种奇怪的方式，这可以被视为对一元“+”运算符的合法使用。基本上，结果`unary +`是一个右值，因此将右值绑定到 const 引用的规则适用，我们不使用静态 const 成员的地址：

```
v.push_back( +Foo::MEMBER ); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-12-04T08:32:36.703

**啊啊啊**

```
class Aaa {

protected:

    static Aaa *defaultAaa;

}; 
```

**aaa.cpp**

```
// You must define an actual variable in your program for the static members of the classes

static Aaa *Aaa::defaultAaa; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-03-10T17:20:13.810

在 C++17 中，使用`inline`变量有一个更简单的解决方案：

```
struct Foo{
    inline static int member;
}; 
```

这是 的定义`member`，而不仅仅是它的声明。与内联函数类似，不同翻译单元中的多个相同定义不会违反 ODR。不再需要为定义选择最喜欢的 .cpp 文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-09-19T01:35:27.003

只是一些额外的信息：

C++ 允许将整型和枚举类型的 const 静态类型“定义”为类成员。但这实际上不是一个定义，只是一个“初始化标记”

您仍然应该在类之外编写您的成员的定义。

> 9.4.2/4 - 如果一个静态数据成员是 const 整数或 const 枚举类型，它在类定义中的声明可以指定一个常量初始化器，它应该是一个整数常量表达式 (5.19)。在这种情况下，成员可以出现在整型常量表达式中。如果在程序中使用该成员，则该成员仍应在名称空间范围内定义，并且名称空间范围定义不应包含初始值设定项。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-07T18:01:53.783

不知道为什么演员表起作用，但是直到第一次加载 Foo 时才分配 Foo::MEMBER ，并且由于您从不加载它，因此永远不会分配它。如果您在某处引用了 Foo，它可能会起作用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-06-20T07:12:30.527

使用 C++11，以上对于基本类型是可能的

```
class Foo {
public:  
  static constexpr int MEMBER = 1;  
}; 
```

该`constexpr`部分创建一个静态*表达式*，而不是一个静态*变量*——它的行为就像一个非常简单的内联方法定义。不过，在模板类中使用 C 字符串 constexprs 时，该方法被证明有点不稳定。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-18T12:44:30.173

关于第二个问题： push_ref 将引用作为参数，并且您不能引用类/结构的静态 const 成员。调用 static_cast 后，将创建一个临时变量。并且可以传递对该对象的引用，一切正常。

或者至少我解决这个问题的同事是这么说的。

# ruby-on-rails - 找不到“rspec”生成器

> ID：272908
> 
> 赞同：17
> 
> 时间：2008-11-07T17:42:05.027
> 
> 标签：ruby-on-rails, rspec

在将 RSpec 作为插件安装后，我正在尝试将其安装为 gem。我已经继续并按照此处[http://github.com/dchelimsky/rspec-rails/wikis](http://github.com/dchelimsky/rspec-rails/wikis)中的说明找到了标题为**rspec 和 rspec-rails gems**的部分。当我运行时`ruby script/generate rspec`，我得到了错误`Couldn't find 'rspec' generator`。只有插件有效吗？如果是这样，为什么他们甚至为 rspec 和 rspec-rails 提供 gem？我正在运行 Rails 2.1.2 的冻结副本，我使用的 rpsec 和 rspec-rails 版本是今天（2008 年 11 月 7 日）1.1.11 的最新版本。

编辑 2008 年 11 月 12 日我安装了 rspec 和 rspec-rails gems。我已将 gem 解压到 vender/gems 文件夹中。两者都是 1.1.11 版本。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-05-31T14:47:25.147

由于 RSpec 已成为 Rails 中的默认测试框架，您不再需要通过 rspec 生成器创建规范文档：

**Rails 2 RSpec 生成器**

```
 rails generate rspec_model mymodel 
```

**Rails 3 RSpec 生成器**

使用 RSpec 作为默认测试框架，只需使用 Rails 自己的生成器。这将构建您需要的所有文件，包括 RSpec 测试。例如

```
 $rails generate model mymodel
      invoke  active_record
      create    db/migrate/20110531144454_create_mymodels.rb
      create    app/models/mymodel.rb
      invoke    rspec
      create    spec/models/mymodel_spec.rb 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-07T23:03:45.220

您是否同时安装了 rspec 和 rspec-rails gems？

```
script/generate rspec 
```

需要安装 rspec-rails gem。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-23T14:48:35.693

对于 Rails 3 和 rspec 2+，您必须确保在 Gemfile Run Bundle Install 中包含“rspec”和 rspec-rails，然后运行 ​​rails g rspec:install

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-29T13:23:57.440

如果您使用的是 rails 2.3 您需要使用

ruby 脚本/插件安装 git://github.com/dchelimsky/rspec-rails.git -r 'refs/tags/1.3.3'

接着

ruby 脚本/生成 rspec

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-01T16:53:06.460

我以前遇到过这个问题，它归结为我没有使用我正在使用的 Rails 版本的 RSpec 版本。IIRC 它是 2.1 Rails，更新后的 RSpec 还没有作为 gem 发布。事实上，1.1.11 是我拥有的 gem，它将是最新可用的（忽略 github gem），所以我很确定这正是我的问题所在。

我已经习惯于将主 rspec 的负责人与我碰巧使用的任何版本的 Rails 一起使用，这对我来说似乎很稳定（并且不会破坏生产中的东西，除非测试以某种方式出现误报） .

我使用 git 使用子模块来完成它，例如：

```
git submodule add git://github.com/dchelimsky/rspec.git vendor/plugins/rspec
git submodule add git://github.com/dchelimsky/rspec-rails.git vendor/plugins/rspec_on_rails 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T20:24:38.957

是否应该有一个“rspec”生成器？我只使用了以下内容：

```
script/generate rspec_model mymodel
script/generate rspec_controller mycontroller 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-09-27T00:05:18.897

如果有人现在想知道 Rails 3，这似乎对我有用：http: [//github.com/rspec/rspec-rails/blob/29817932b99fc45adaa93c3f75d503c69aafcaef/README.markdown](http://github.com/rspec/rspec-rails/blob/29817932b99fc45adaa93c3f75d503c69aafcaef/README.markdown)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T17:38:39.803

在 Fedora 9 (OLPC) 上，我做了：

```
$ sudo gem install rspec

$ sudo gem install rspec-rails 
```

那些把我带到了我可以奔跑的地方

```
$ ruby script/generate rspec 
```

这对我有用，而 git 指令不起作用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-18T19:28:01.287

我正在使用导轨 2.3.9。我开始尝试使用 gem(s)，但无法显示 rspec 的生成器。[然后我使用https://github.com/dchelimsky/rspec/wiki/rails](https://github.com/dchelimsky/rspec/wiki/rails)上的说明安装了插件，这就成功了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-17T01:46:00.590

如果您键入，您实际看到`script/rails generate`的唯一*RSpec*`rspec:install`生成器是. 这是因为*RSpec是在**Rails*中注册为测试框架的，所以每当您生成模型、控制器等应用程序组件时，都会生成*RSpec*规范而不是`Test::Unit`测试。

请注意，生成器可以帮助您入门，但它们不能替代编写您自己的示例，并且它们只能保证在默认情况下（*ActiveRecord*和*Webrat*）开箱即用。

[https://github.com/rspec/rspec-rails](https://github.com/rspec/rspec-rails)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-22T10:12:59.003

如果您使用的是捆绑器版本 1.0.8，您应该`$ gem update bundler`使用更新的版本 1.0.9。

我有相同的症状，更新捆绑器帮助了我。现在`$ rails g`正在使用 Gemfile 中定义的 gem。我也将我的宝石分组如下：

```
source 'http://rubygems.org'

gem 'rails', '3.0.3'
gem 'sqlite3-ruby', :require => 'sqlite3'

group :test, :development do
  gem 'capybara', '0.4.1.1'
  gem 'database_cleaner'
  gem 'cucumber-rails'
  gem 'rspec-rails', '~> 2.4'
  gem 'launchy'
end 
```

（请注意，测试宝石也在该`:development`组中。）

祝你今天过得愉快 ：）

卢卡斯

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-05-04T12:52:50.040

您可能需要运行 bundle exec ：

```
bundle exec rails g rspec:install 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2010-03-15T04:55:04.983

你需要做

```
sudo gem install cucumber-rails 
```

# java - 在 Java 中，URL 连接何时关闭？

> ID：272910
> 
> 赞同：85
> 
> 时间：2008-11-07T17:42:17.397
> 
> 标签：java, exception, url, connection

java什么时候放弃与URL的连接？我在 URL 或 URLConnection 上都没有看到 close() 方法，所以它会在请求完成后立即释放连接吗？我主要是想看看我是否需要在异常处理程序中进行任何清理。

```
try {
  URL url = new URL("http://foo.bar");
  URLConnection conn = url.openConnection();
  // use the connection
}
catch (Exception e) {
  // any clean up here?
} 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-11-07T17:53:00.433

如果您转换为 HttpURLConnection，则有一个[disconnect()](http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html#disconnect())方法。如果连接空闲，它可能会立即断开连接。没有保证。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-11-07T17:46:18.900

这取决于协议中指定的具体协议。一些保持持久连接，另一些在连接给定的输入或输出流中关闭呼叫时关闭它们的连接。但除了记住关闭从 URLConnection 打开的流之外，您无能为力。

来自 java.net.URLConnection 的 javadoc

> 在请求之后对 URLConnection 的 InputStream 或 OutputStream 调用 close() 方法可能会释放与此实例关联的网络资源，除非特定的协议规范为其指定了不同的行为。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-12-10T13:20:59.953

我不得不一次下载数百个文件并遇到问题。

您可以使用以下命令检查您的应用程序的打开描述符：

```
adb shell ps 
```

在列表中找到您的应用程序 PID 并使用另一个命令：

```
adb shell run-as YOUR_PACKAGE_NAME ls -l  /proc/YOUR_PID/fd 
```

我在通常的启动中看到大约 150 个打开的描述符。下载文件时有 700 多个。它们的数量仅在几分钟后才会减少，看起来 Android 在后台释放它们，而不是当你可以`close`在流中释放它们时。

所以我们不能确定连接何时真正关闭。

# social-networking - 在社交网络中组织用户生成内容的最佳方式是什么？

> ID：272911
> 
> 赞同：2
> 
> 时间：2008-11-07T17:43:46.723
> 
> 标签：social-networking, user-generated-content

**我正在寻找在社交网络中自动组织所有用户生成内容的最佳方式。** 我正在构建一个基于 lovdbyless 框架的 ruby​​ 站点。该网站是男人分享专业知识的地方。

我查看了 wiki、论坛、博客，需要一个平台/组织结构，允许用户从这 3 个来源生成的内容自动聚合、索引并使其可搜索，以便其他用户可以轻松有效地访问它.

知识库之类的东西，在用户创建论坛帖子、个人博客帖子、wiki 条目等的任何地方都会自动更新，因此成员可以轻松访问网站的综合知识

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T17:47:36.997

标题和标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T18:18:00.880

如果我可以扩展 Lance 的答案，因为我同意标签是最好的结构，您可以将其概括为三重图，也许使用 RDF 之类的东西。[什么是 RDF 三元组？](http://www.w3.org/TR/rdf-concepts/#section-triples)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T23:43:26.227

多亏了诸如[语义媒体维基之](http://semantic-mediawiki.org/wiki/Semantic_MediaWiki)类的东西，以及在[wordpress](http://sioc-project.org/wordpress/)和[Drupal中出现的](http://drupal.org/project/sioc)[SIOC](http://sioc-project.org/)，您基本上有了一个预先构建的架构来执行此操作。

只要您对在 RDF 中工作感到满意，就应该以一种对您的社交网络项目目标有意义的方式集成各种 UI。

甚至还有“联合”查询引擎，它们将查询所有源，就好像它们是一个源一样。

# .net - 为什么是 LazyInit 仅限于引用类型

> ID：272927
> 
> 赞同：0
> 
> 时间：2008-11-07T17:48:16.730
> 
> 标签：.net, .net-3.5, parallel-extensions

我有一个要使用的伪实时数据处理应用程序，`LazyInit<double>`因此我不进行不需要的计算，而是`LazyInit<T>`将 T 限制为类。我可以解决它，但我显然不希望这样做。

有人知道这是为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-28T23:06:38.487

我们当前的（预览版）位仅提供 LazyInit 类型，并且正如您所观察到的（并且 JaredPar 正确诊断）我们将 T 限制为引用类型，以便我们可以：（i）使 LazyInit 成为结构，并且（ii）通过提供合理的默认行为CMPXCHG（即，我们可以检查“null”以表示没有值）。我们本可以使 T 不受限制，但决定针对常见情况进行优化——否则将意味着一些额外的字节；信不信由你，这可能使这种类型对某些人来说过于昂贵。

我们最近稍微改变了路线。*除了*T 限制为引用类型的 LazyInitField 类型之外，我们目前计划提供 T 不受限制的 LazyInit 类型。前者是大多数人会使用的，但后者可以用于那些有perf-conscious并且可以忍受T限制的人。

希望这可以解决问题。干杯，

---joe duffy，pfx 开发主管

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T18:46:48.297

原因是 LazyInit 中的底层 API 选择。它使用 Interlocked.CompareExchange 来设置线程安全值。CompareExchange 而泛型被限制为仅使用类类型。因此 LazyInit 的 T 值也必须是一个类。

你可以在这里查看实现：[LazyInit](http://www.bluebytesoftware.com/blog/PermaLink,guid,a2787ef6-ade6-4818-846a-2b2fd8bb752b.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T17:51:40.467

我相信这是因为值类型会自动初始化，并且 LazyInit 会根据它是否为空来确定是否需要初始化。您可以通过使用可为空的类型来解决它。

```
LazyInit<double?> 
```

# c# - 如何从回发创建按钮和连接事件

> ID：272928
> 
> 赞同：6
> 
> 时间：2008-11-07T17:48:21.190
> 
> 标签：c#, .net, asp.net, events, postback

我最初需要基于相当多的处理器和磁盘密集型搜索来生成按钮。每个按钮将代表一个选择并触发回发。我的问题是回发不会触发命令 b_Command。我猜是因为原始按钮尚未重新创建。我无法在回发中执行原始搜索以重新创建按钮，因此我想从回发信息中生成所需的按钮。

我应该如何以及在哪里做这件事？例如，我应该在 Page_Load 之前这样做吗？我怎样才能从回发中重建 CommandEventHandler - 如果有的话？

```
 namespace CloudNavigation
{
    public partial class Test : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (IsPostBack)
            {
                // how can I re-generate the button and hook up the event here
                // without executing heavy search 1
            }
            else
            {
                // Execute heavy search 1 to generate buttons
                Button b = new Button();
                b.Text = "Selection 1";
                b.Command += new CommandEventHandler(b_Command);
                Panel1.Controls.Add(b);
            }
        }

        void b_Command(object sender, CommandEventArgs e)
        {
            // Execute heavy search 2 to generate new buttons
            Button b2 = new Button();
            b2.Text = "Selection 2";
            b2.Command += new CommandEventHandler(b_Command);
            Panel1.Controls.Add(b2);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T18:09:20.430

b_Command 事件处理程序方法没有被执行，因为回发按钮没有被重新创建（因为它们是动态生成的）。每次重新创建页面时，您都需要重新创建它们，但为了做到这一点，您需要在状态的某处显式缓存信息。

如果这是一个页面范围的操作，最简单的方法是将其存储在 ViewState 中（作为字符串 - 如果您开始使用对象加载 ViewState，您将看到性能下降），以便您可以在下次加载时检查它（或任何其他先前的事件）并在重新加载页面时重新创建按钮。如果操作是会话范围的，您可以轻松地将对象（数组或其他）存储在会话中，并在下一次加载（或初始化）时检索它以重新创建控件。

这种情况意味着您只需要在 b_Command EventHandler 中存储有关按钮的一些信息，而不是创建和添加按钮，因为如果这样做，您将在下一次回发中丢失相关信息（就像现在发生的那样）。

所以你的代码会变成这样：

```
namespace CloudNavigation
{
    public partial class Test : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (IsPostBack)
            {
                this.recreateButtons();
            }
            else
            {
                // Execute heavy search 1 to generate buttons
                Button b = new Button();
                b.Text = "Selection 1";
                b.Command += new CommandEventHandler(b_Command);
                Panel1.Controls.Add(b);
                //store this stuff in ViewState for the very first time
            }
        }

        void b_Command(object sender, CommandEventArgs e)
        {
            //Execute heavy search 2 to generate new buttons
            //TODO: store data into ViewState or Session
            //and maybe create some new buttons
        }

        void recreateButtons()
        {
            //retrieve data from ViewState or Session and create all the buttons
            //wiring them up to eventHandler
        }
    }
} 
```

如果您不想在页面加载时调用 recreateButtons，您可以在 PreLoad 或 Init 事件上执行此操作，我看不出有什么不同，因为您可以在任何地方访问 ViewState/Session 变量（在 Init viewstate 上未应用但您可以访问它来重新创建您的动态按钮）。

有人会讨厌这种解决方案，但据我所知，在服务器端保留状态数据的唯一方法是**ViewState** - **Session** - Page.Transfer 或客户端 cookie。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T18:07:23.243

需要在加载事件*之前*创建按钮，否则状态将无法正确连接。而是在 Init() 中重新创建按钮。

至于如何在不重新运行搜索的情况下执行此操作，我建议您将结果缓存在某处。缓存中结果集的存在是您在 Init() 事件中的按钮代码如何知道它需要运行的方式。

或者，您可以将按钮静态放置在页面上。只要放足够的东西来处理搜索返回的任何内容。如果你认为这可能是太多的项目，那么问问你自己：你的用户真的想要对这么多项目进行排序吗*？*也许您应该考虑对这些数据进行分页，在这种情况下，静态按钮不再那么重要了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T18:22:10.577

当回发事件处理试图找到它在集合中不存在的控件时会发生什么。结帐丹尼斯 DynamicControlsPlaceholder @ [http://www.denisbauer.com/ASPNETControls/DynamicControlsPlaceholder.aspx](http://www.denisbauer.com/ASPNETControls/DynamicControlsPlaceholder.aspx)

希望它可以帮助布鲁诺·菲格雷多 [http://www.brunofigueiredo.com](http://www.brunofigueiredo.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T18:03:02.877

您的 ASPX 是否连接了事件处理程序？

```
<asp:Button id="btnCommand" runat="server" onClick="b_Command" text="Submit" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T18:16:04.833

我同意 Joel 关于缓存搜索结果的观点。至于按钮，您可以在页面生命周期的初始化或加载阶段动态创建它们，但请注意，如果您删除一个按钮，然后以编程方式将其添加回来，您将弄乱您的状态。

在我的一个项目中，我们有一个动态表单，可以动态生成字段，我们使其工作的方式是通过存储在缓存中或页面视图状态中的数组。该数组包含要显示的按钮，并在每个页面加载时重新创建按钮，以便可以将状态正确加载到其中。然后，如果我需要更多按钮或一组全新的按钮，我会在数组中标记隐藏值，并在数组中为新的一组相应按钮添加一组新值。这样状态不会丢失，按钮继续工作。

如果您以编程方式创建按钮，您还需要确保为按钮的 on_click 事件添加处理程序，我认为我在顶部的代码中看到了这些处理程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T18:28:36.490

这是一个带有自定义视图状态处理的示例（请注意，按钮具有`EnableViewState = false`）：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            // Execute heavy search 1 to generate buttons
            ButtonTexts = new ButtonState[] { 
                new ButtonState() { ID = "Btn1", Text = "Selection 1" } 
            };
        }
        AddButtons();
    }

    void b_Command(object sender, CommandEventArgs e)
    {
        TextBox1.Text = ((Button)sender).Text;

        // Execute heavy search 2 to generate new buttons
        ButtonTexts = new ButtonState[] { 
            new ButtonState() { ID = "Btn1", Text = "Selection 1" }, 
            new ButtonState() { ID = "Btn2", Text = "Selection 2" } 
        };
        AddButtons();
    }

    private void AddButtons()
    {
        Panel1.Controls.Clear();
        foreach (ButtonState buttonState in this.ButtonTexts)
        {
            Button b = new Button();
            b.EnableViewState = false;
            b.ID = buttonState.ID;
            b.Text = buttonState.Text;
            b.Command += new CommandEventHandler(b_Command);
            Panel1.Controls.Add(b);
        }
    }

    private ButtonState[] ButtonTexts
    {
        get
        {
            ButtonState[] list = ViewState["ButtonTexts"] as ButtonState[];
            if (list == null)
                ButtonTexts = new ButtonState[0];
            return list;
        }
        set { ViewState["ButtonTexts"] = value; }
    }

    [Serializable]
    class ButtonState
    {
        public string ID { get; set; }
        public string Text { get; set; }
    } 
```

# vb.net - ADO.NET 记录导航

> ID：272941
> 
> 赞同：1
> 
> 时间：2008-11-07T17:52:24.613
> 
> 标签：vb.net, ado.net, recordset

我已经在 VB6 和 VB.NET 中进行过开发，并且我在 VB6 中使用 ADODB 对象来处理记录集导航（即 MoveFirst、MoveNext 等方法），并且我已经使用 ADO.NET 来处理查询逐行性质（即 For Each Row In Table.Rows ...）

但现在我似乎陷入了两难境地。我现在正在 VB.NET 中构建一个程序，我需要在其中使用旧 Recordset 对象的移动命令的等效功能。VB.NET 是否有某种对象支持此功能，还是我必须求助于旧的 ADODB COM 对象？

编辑：为了澄清起见，我希望用户能够通过查询向前或向后导航。遍历行是一项简单的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T17:58:08.177

没有必要回到糟糕的过去。如果你能给出一个伪代码示例，我可以为你翻译成 vb.net。

这是一种通用的方法。

```
Dim ds as DataSet

'populate your DataSet'

For each dr as DataRow in ds.Tables(<tableIndex>).Rows
  'Do something with the row'

Next 
```

每个编辑 1：用户将导航结果，而不是查询。因此，您想要做的是 a) 获取结果并仅向它们显示 ds.Tables.Row() 的当前行索引，或者 b) 对每个导航执行一个新查询（不是一个真正表现良好的选项。）

每条评论：不，他们没有。但是用户通常不会像这样与数据库交互工作。您将需要获取结果的数据集/表，并使用按钮从数据集/表中检索相关行。

*   第一行是 DataTable.Rows(0)
*   最后一行是 DataTable.Rows(DataTable.Rows.Count-1)
*   *   对于介于两者之间的任何行（将当前显示的行索引存储在您的应用中），然后调用
*   DataTable.Rows(currentRowIndex -1) 用于先前和
*   DataTable.Rows(currentRowIndex +1) 用于下一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T18:08:47.983

这完全取决于使用情况：如果您只需要列出一个或多个查询的结果，您应该使用数据阅读器。DOK 是否指出，它是只读的和只转发的，所以它很快。 [http://www.startvbdotnet.com/ado/sqlserver.aspx](http://www.startvbdotnet.com/ado/sqlserver.aspx)

如果您需要浏览记录，您应该使用数据集。 [http://www.c-sharpcorner.com/UploadFile/raghavnayak/DataSetsIn.NET12032005003647AM/DataSetsIn.NET.aspx](http://www.c-sharpcorner.com/UploadFile/raghavnayak/DataSetsIn.NET12032005003647AM/DataSetsIn.NET.aspx)

数据集还具有“断开连接”工作的优势，因此您构建所有逻辑，并且仅在需要数据时调用 Fill 方法。数据集已填充，然后您可以开始处理数据，现在已与数据库断开连接。

希望它有所帮助，布鲁诺·菲格雷多 [http://www.brunofigueiredo.com](http://www.brunofigueiredo.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T17:56:50.300

在 .Net 中，有很多方法可以做到这一点。我喜欢的一种方法是使用 DataReader，它可以返回多个记录集。您可以使用 While DataReader.Read 遍历其记录。

使用 DataReader 的优点之一是它是一个只进、只读的对象，因此它既快速又轻量。

要允许用户一次浏览所有记录，您不希望在用户浏览时保持打开 DataReader。您可以将 DataReader 记录读入对象。或者，您可以将记录检索到 DataSet 中，并一次显示 DataTable 中的 DataRows。

如果可能的话，我建议您一次检索所有记录（如果不是太多）。这将保存对数据库的重复调用。

另一方面，如果有很多记录，您可以检索前几条（例如，10 或 20 条），并且如果用户点击超出初始集，则仅通过新的数据库调用检索下一组记录。这是延迟加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T18:04:37.960

下面是一个使用数据读取器的简单示例：

```
 Dim cmd As New OleDb.OleDbCommand(sql, Conn) 'You can also use command parameter here
            Dim dr As OleDb.OleDbDataReader
            dr = cmd.ExecuteReader

            While dr.Read

          ‘Do something with data
          ‘ access fields
          dr("fieldname")
          ‘Check for null
          IsDBNull(dr("fieldname"))

            End While

            dr.Close() 
```

# unit-testing - 如何创建灵活的单元测试？

> ID：272949
> 
> 赞同：6
> 
> 时间：2008-11-07T17:53:18.810
> 
> 标签：unit-testing

我们目前正在使用单元测试来测试我们的项目。我们涵盖了大部分功能，但我认为我们的测试太脆弱了。

我想知道我们是否可以做一些具体的事情来使单元测试更加灵活，这样它们就不会因为错误的原因而中断。

几个答案提到要小心嘲笑太多......那么嘲笑的正当理由是什么？我认为这可能是我们的主要问题之一，但是当您的应用程序主要是动态的、数据库驱动的站点时，您如何摆脱模拟？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-07T17:56:18.773

这是一个有点简单的答案，但显示了正确的心态：

*   如果行为以您关心的方式发生变化，则测试应该中断。
*   如果行为以您不关心的方式发生变化，测试应该继续工作。

因此，尽可能 - 在不妨碍*您*的情况下 - 确保您正在测试该方法的“最终结果”，而不关心它是如何到达那里的。需要注意的一件事是 mocking - 它非常有用，但很容易使您的测试变得脆弱。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-07T18:00:38.747

+1 乔恩。说得好。

我发现以更 BDD 风格构建我的测试很有价值。那就是......拒绝每个类别的固定装置的心态，而不是每个上下文的固定装置。

我还发现 RhinoMocks 3.5 的 AAA 语法要好得多。

这些涵盖了组织和干净/可读的测试。

为了让我的测试不那么脆弱，我开始停止嘲笑。模拟框架对于消除依赖关系至关重要，但是你模拟的越多，测试对实现的*了解*就越多。如果实现发生变化（但行为没有），那么您的测试不应该中断。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-07T18:05:15.057

也 +1 乔恩。

在典型的工程时尚中，答案总是“视情况而定”。

我建议看一下“xUnit 测试模式：重构测试代码”一书。（在这种情况下，x={J,N} 涵盖了 Java 和 .NET 世界，并不明确打算用于新的实际称为 xUnit 框架。）

正如设计模式出现在 OO 世界中一样，模式也出现在 TDD 世界中。值得一看。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T18:08:15.223

我发现当我的测试具有以下属性时，它们往往更脆弱

1）复杂地设置正确的状态以测试实际逻辑。2）对模拟的许多期望。3) 测试代码的可读性差。4) 系统设计普遍不佳。

为了解决这些问题，我们尝试执行以下操作

1) 更改系统设计以简化测试的设置，通常是通过应用 SRP 并在我们的课程中寻找责任漏洞。

2) 使用模拟，而对模拟上执行的调用的数量或顺序没有明确的期望。

3) 将测试代码视为生产代码、执行代码、设计评审等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T13:23:43.883

> 那么嘲讽的正当理由是什么？我认为这可能是我们的主要问题之一，但是当您的应用程序主要是动态的、数据库驱动的站点时，您如何摆脱模拟？

模拟对象的原因包括

*   对象是或使用外部资源，例如数据库、网络、文件系统
*   对象是一个 GUI
*   对象 [尚未] 可用
*   对象行为不是确定性的
*   对象的设置成本很高

# performance - 哪些硬件变化对 WebLogic 性能影响最大？

> ID：272956
> 
> 赞同：0
> 
> 时间：2008-11-07T17:55:29.430
> 
> 标签：performance, hardware, weblogic, redhat

在为 WebLogic 服务器请求硬件时，哪种硬件最能提高其性能？我应该给它大量内存、CPU、快速硬盘吗？操作系统将是 Redhat 4 Standard 或 Enterprise。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T18:35:21.470

内存很便宜。尽可能多地给它。4个演出是什么，50美元？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T13:48:32.453

当然，这在很大程度上取决于您在服务器上运行的应用程序类型。我知道我们的 WebLogic 门户会占用大量内存（10+ gigs），而其他应用程序占用的内存要少得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-28T15:52:53.463

取决于您在其上部署的应用程序。鉴于我们对部署的应用程序、您拥有的硬件以及典型 Java EE 应用程序服务器上可用的无数设置一无所知，因此无法回答。

越多越好。提供最多的内存、最大的硬盘驱动器、最快的多核处理器。

# c++ - c++ 编译器会优化掉未使用的返回值吗？

> ID：272964
> 
> 赞同：6
> 
> 时间：2008-11-07T17:57:33.810
> 
> 标签：c++, visual-c++, gcc, compiler-construction, return

如果我有一个返回对象的函数，但调用者从不使用这个返回值，编译器会优化掉副本吗？（可能总是/有时/从不回答。）

基本示例：

```
ReturnValue MyClass::FunctionThatAltersMembersAndNeverFails()
{
    //Do stuff to members of MyClass that never fails
    return successfulResultObject;
}

void MyClass::DoWork()
{
    // Do some stuff
    FunctionThatAltersMembersAndNeverFails();
    // Do more stuff
} 
```

在这种情况下，`ReturnValue`对象会被复制吗？它甚至可以构建吗？（我知道这可能取决于编译器，但让我们将讨论范围缩小到流行的现代编译器。）

编辑：让我们稍微简化一下，因为在一般情况下似乎没有达成共识。如果`ReturnValue`是一个 int，我们返回 0 而不是`successfulResultObject`呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T18:12:20.800

如果 ReturnValue 类具有重要的复制构造函数，则编译器不得消除对复制构造函数的调用——它是由调用它的语言所要求的。

如果复制构造函数是内联的，编译器可能能够内联调用，这反过来可能会导致删除其大部分代码（也取决于 FunctionThatAltersMembersAndNeverFails 是否内联）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T18:02:27.683

如果优化级别导致他们内联代码，他们很可能会这样做。如果不是这样，他们将不得不为相同的代码生成两种不同的翻译才能使其正常工作，这可能会引发很多极端情况问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T18:04:30.720

链接器可以处理这类事情，即使原始调用者和被调用者位于不同的编译单元中。

如果您有充分的理由担心专用于方法调用的 CPU 负载（过早的优化是万恶之源），您可能会考虑许多可用的内联选项，包括（喘气！）宏。

你真的需要在这个级别进行优化吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-11T01:47:57.803

如果返回值是一个 int 并且您返回 0（如已编辑的问题中所示），那么这*可能会*被优化掉。

您必须查看底层程序集。如果函数未内联，则底层程序集将执行 mov eax, 0（或 xor eax, eax）将 eax（通常用于整数返回值）设置为 0。如果函数内联，这肯定会得到优化了。

但是，如果您担心返回大于 32 位的对象时会发生什么，那么这个场景就不是很有用了。您需要参考 unedit 问题的答案，这描绘了一幅非常好的画面：如果所有内容都内联，那么大部分内容都会被优化。如果它不是内联的，那么即使它们没有真正做任何事情，也必须调用函数，这包括对象的构造函数（因为编译器不知道构造函数是否修改了全局变量或做了其他奇怪的事情） .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T17:59:01.200

如果大多数编译器位于不同的编译对象（即不同的文件）中，我怀疑它们是否可以做到这一点。也许如果他们都在同一个文件中，他们可以。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T18:17:46.217

窥视孔优化器很有可能会抓住这一点。许多（大多数？）编译器都实现了一个，所以答案可能是“是”。

正如其他人所指出的，这在 AST 重写级别上并不是一个微不足道的问题。

* * *

窥孔优化器在相当于汇编语言的级别上处理代码表示（但在生成实际机器代码之前）。有机会注意到将返回值加载到寄存器中，然后在没有中间读取的情况下进行覆盖，然后移除加载。这是根据具体情况进行的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-19T23:07:42.363

刚刚在编译器资源管理器上尝试了这个示例，并且在 -O3 处，`mov`当不使用返回值时不会生成。

[https://gcc.godbolt.org/z/v5WGPr](https://gcc.godbolt.org/z/v5WGPr)

[![在此处输入图像描述](https://i.stack.imgur.com/mCmTI.png)](https://i.stack.imgur.com/mCmTI.png)

# iphone - OpenGL-ES 的“输入”和“输出”是什么？（从 OpenGL 移植）

> ID：272970
> 
> 赞同：18
> 
> 时间：2008-11-07T17:58:46.193
> 
> 标签：iphone, opengl, opengl-es, porting

似乎我能找到的所有关于 OpenGL-ES 的文档都说“OpenGL-ES 就像 OpenGL，但没有很多东西。例如，没有 glBegin 或 glEnd”。

太棒了。那么，还有什么 ELSE 没有的呢？或者有什么清单*吗*？或者也许是移植指南？

（具体来说，我正在尝试将现有的 GL 应用程序移至 iPhone，尽管我不想将 Q 限制在 iPhone 上。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T19:57:37.620

回答您的问题的部分问题是缺少很多东西，而且通常是一组很少使用或不适用的位标志。描述差异的最佳文档实际上是实现标头。

对于我正在开发的框架，我决定让它在桌面和 iPhone 之间完全跨平台。我解决这个问题的方法是在 OpenGL 中编写代码，看看它在哪里中断。然后进去看看

`/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS2.2.sdk/ System/Library/Frameworks/OpenGLES.framework/Headers/ES1/gl.h`

并将其与

`/Developer/SDKs/MacOSX10.5.sdk/ System/Library/Frameworks/OpenGL.framework/Versions/A/Headers/gl.h`

这些标题非常简单易懂。

到目前为止，我发现的主要区别是没有 GLdouble（任何使用 GLdouble 的东西，例如 glOrtho 和 glFrustum 都有 GLfloat 版本的 glOrthof 和 glFrustumf）。由于某种原因，也没有 gluPerspective 或 gluPerspectivef。

这是替换的下降：

```
void gluPerspective( GLfloat fovy, GLfloat aspect, GLfloat zNear, GLfloat zFar )
{
   GLfloat xmin, xmax, ymin, ymax;

   ymax = zNear * tan(fovy * M_PI / 360.0);
   ymin = -ymax;
   xmin = ymin * aspect;
   xmax = ymax * aspect;

   glFrustumf( xmin, xmax, ymin, ymax, zNear, zFar );
} 
```

由于您没有 glBegin 和 glEnd，因此您必须通过 glDrawArray 或 glDrawElements（首选）来完成所有操作。一个快速而肮脏的例子：

```
void draw( short x, short y, short w, short h )
{
    const GLshort t[8] = { 0, 0, 1, 0, 1, 1, 0, 1 };
    const GLshort v[8] = { x, y, x+w, y, x+w, y+h, x, y+h };

    glVertexPointer( 2, GL_SHORT, 0, v );
    glEnableClientState( GL_VERTEX_ARRAY );

    glTexCoordPointer( 2, GL_SHORT, 0, t );
    glEnableClientState( GL_TEXTURE_COORD_ARRAY );

    glDrawArrays( GL_TRIANGLE_FAN, 0, 4 );
} 
```

查看 Apple 的技术说明[TN2230“针对 iPhone OS 优化 OpenGL ES”](http://developer.apple.com/iphone/library/technotes/tn2008/tn2230.html)，了解其他可能对移植有用的提示。

到目前为止，移植对我来说相当轻松，除非你的应用程序做了一些非常高级的 OGL 东西或使用了完全不受支持的功能，否则你会通过点击构建按钮来发现你的问题，并且通过挖掘一点点可以很明显地找到一个简单的修复gl.h 文件。事实上，移植到 ES 会迫使您编写良好的优化渲染代码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-07T20:43:50.790

[从Khronos.org 的 OpenGL ES 1.X 信息页面](http://www.khronos.org/opengles/1_X/)链接到的[“OpenGL ES 1.1.12 差异规范”](http://www.khronos.org/registry/gles/specs/1.1/es_cm_spec_1.1.12.pdf) (PDF)介绍了OpenGL ES 1.X 和 OpenGL 1.5 之间的差异。OpenGL ES 1.1 是 iPhone 上使用的版本。

差异规范并不是我见过的最简单的文档，但它比一般的 OpenGL 规范更容易阅读。我建议获取您调用的 OpenGL 函数列表，然后在差异文档中搜索它们。它将显示它们是否在 OpenGL ES 中受支持，如果仅部分支持，您可以查看完整规范以获取更多信息。

# asp.net - 子记录的 LinqDataSource/ListView - 仅在保存包含记录时保存？

> ID：272973
> 
> 赞同：0
> 
> 时间：2008-11-07T17:59:25.677
> 
> 标签：asp.net, linq-to-sql, linqdatasource

我有一个用于编辑事件的表单，其中用户可以（a）在 FormView 中编辑事件的详细信息（标题、描述、日期等）和（b）查看和编辑联系人的 ListView报名参加该活动。

这是我的 LinqDataSource，它允许我在事件中添加和删除联系人。

```
<asp:linqdatasource runat="server" id="ContactsDatasource" contexttypename="Db" tablename="ContactsCalendarEventsXtabs" autogeneratewhereclause="true" enabledelete="true" enableinsert="true">
    <whereparameters>
        <asp:querystringparameter name="CalendarEventID" querystringfield="id" type="Int32" />
    </whereparameters>
    <insertparameters>
        <asp:querystringparameter name="CalendarEventID" querystringfield="id" type="Int32" />
    </insertparameters>
</asp:linqdatasource> 
```

这可以正常工作，但当然它会在更改数据库时保留它们；并且仅在已创建事件时才有效。理想情况下，我希望仅在 FormView 保存后保留对 ListView 的更改（因此，如果有人对 ListView 进行了一些更改，然后从 FormView 中取消，则更改将被丢弃）。同样，我希望能够一次创建一个新活动，输入其详细信息，并让一些人注册它；当 FormView 保存时，它会获取事件的新 ID，然后 ListView 使用该 ID 保存。

在过去（Linq 之前）我已经用我自己广泛定制的 FormView 和 SqlDataSource 对象完成了这一点，它们负责临时保存数据更改、从 FormView 获取事件 ID 等。有没有更标准的方法使用 LinqDataSource 处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T04:34:51.417

因此，您希望将两个 LinqDataSource 包装在一个事务中。有一种偷偷摸摸的方法来利用 LinqDataSource 数据绑定和事件，并且仍然只执行一次提交。使用这种方法，您仍然可以使用动态数据、FormView、GridView、验证等。它只依赖于连接到数据源。

示例标记：

```
<FormView>...</FormView>
<ListView>...</ListView>
<LinqDataSource ID="dsEvent" ...> </LinqDataSource>
<LinqDataSource ID="dsContact" ...> </LinqDataSource>
<asp:Button ID="btnSubmit" runat="server" OnClick="btnSubmit_Click" Text="Submit it All!"/> 
```

现在在您后面的代码中使用单个提交按钮来模拟 LinqDataSources 的行为。您使用数据源插入项目，这将创建新对象，抓取对象，为第二个对象再次执行此操作。将这两个项目和您想要的任何其他逻辑链接在一起，然后将其作为单个事务插入到数据库中。关键是在 Inserting 事件中设置 Cancel 标志，这样数据源就不会真正插入到数据库中。

```
protected void btnSubmit_Click(object sender, EventArgs e)
{
    Event evt = null;
    Contact contact = null;

    dsEvent.Inserting += (o,ea) => { evt = (ea.NewObject as Event); ea.Cancel = true; };
    dsEvent.InsertItem(true);
    dsContact.Inserting += (o, ea) => { contact = (ea.NewObject as Contact); ea.Cancel = true; };
    dsContact.InsertItem(true);

    evt.Contacts.Add(contact);

    using (var dbContext = new ContactsCalendarEventsXtabs())
    {
        dbContext.Events.InsertOnSubmit(evt);
        dbContext.SubmitChanges();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T20:18:23.540

您是否在表之间设置了外键？如果你这样做 - 那么它应该在保存新事件列表时抛出异常。

在主题上，有一种方法可以同时以编程方式创建事件 + 列表记录。

但是您将不得不编写一些代码。

```
create all list items programmaticaly.
create event proggramaticaly.
event myevent = new event();
event.someprop = zzxxx;

link them programmaticaly.
then use  yourdatacontext.events.InsertOnSubmit(event); 
```

和列表项相同。

ScottGu 的博客 LINQ 系列肯定有这个描述

# multithreading - TThread 在 Delphi 2006 控制台应用程序中的工作方式是否不同？

> ID：272987
> 
> 赞同：6
> 
> 时间：2008-11-07T18:02:20.490
> 
> 标签：multithreading, delphi, unit-testing, console-application

我们有一个相当成熟的 COM dll，我们使用 DUnit 对其进行测试。我们最近的一项测试创建了几个线程，并从这些线程中测试对象。此测试在使用 gui 前端运行测试时运行良好，但在作为控制台应用程序运行时挂起。这是我们在测试中的快速伪视图

```
SetupTest;
fThreadRefCount := 0; //number of active threads
Thread1 := TMyThread.Create(True);
Inc(fThreadRefCount);
Thread1.OnTerminate := HandleTerminate; //HandleOnTerminate decrements fThreadRefCount
Thread3 := TMyThread.Create(True);
Inc(fThreadRefCount);
Thread2.OnTerminate := HandleTerminate; //HandleOnTerminate decrements fThreadRefCount
Thread3 := TMyThread.Create(True);
Inc(fThreadRefCount);
Thread3.OnTerminate := HandleTerminate; //HandleOnTerminate decrements fThreadRefCount

Thread1.Resume;
Thread2.Resume;
Thread3.Resume;

while fThreadRefCount > 0 do
  Application.ProcessMessages; 
```

我试过在 OnExecute 中什么都不做，所以我确定这不是我正在测试的实际代码。在控制台中，fThreadRefCount 永远不会递减，而如果我将它作为 gui 应用程序运行，那就没问题了！

据我所知， OnTerminate 事件只是没有被调用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-07T19:07:41.607

您需要提供更多数据。

请注意，OnTerminate 是通过 Synchronize 调用的，这需要在某个位置调用 CheckSynchronize。Application.ProcessMessages 通常会执行此操作，但根据 VCL 的初始化方式，同步机制可能尚未在控制台应用程序中完全挂钩。

无论如何，这个程序在我的机器上按预期工作：

```
uses Windows, SysUtils, Classes, Forms;

var
  threadCount: Integer;

type
  TMyThread = class(TThread)
  public
    procedure Execute; override;
    class procedure Go;
    class procedure HandleOnTerminate(Sender: TObject);
  end;

procedure TMyThread.Execute;
begin
end;

class procedure TMyThread.Go;
  function MakeThread: TThread;
  begin
    Result := TMyThread.Create(True);
    Inc(threadCount);
    Result.OnTerminate := HandleOnTerminate;
  end;
var
  t1, t2, t3: TThread;
begin
  t1 := MakeThread;
  t2 := MakeThread;
  t3 := MakeThread;
  t1.Resume;
  t2.Resume;
  t3.Resume;
  while threadCount > 0 do
    Application.ProcessMessages;
end;

class procedure TMyThread.HandleOnTerminate(Sender: TObject);
begin
  InterlockedDecrement(threadCount);
end;

begin
  try
    TMyThread.Go;
  except
    on e: Exception do
      Writeln(e.Message);
  end;
end. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-09T15:07:05.273

正如 Barry 正确指出的那样，除非调用 CheckSynchronize，否则不会调用 Synchronize，如果不调用 synchronize，则不会触发 OnTerminate 事件。似乎正在发生的事情是，当我将单元测试作为控制台应用程序运行时，消息队列中没有消息，因此从 Processmessages 调用的 Application.ProcessMessage 永远不会调用 checkSynchronize。我现在通过将循环更改为

```
While fThreadRefCount > 0 do
begin
   Application.ProcessMessages;
   CheckSynchronize;
end; 
```

它现在可以在控制台和 gui 模式下工作。

整个wakeupmainthread 钩子似乎设置正确。正是这个钩子发布了触发检查同步的 WM_NULL 消息。它在控制台应用程序中并没有那么远。

**更多调查**

所以 Synchronize*确实*被调用了。DoTerminate 调用 Synchronize(CallOnTerminate) 但那里有一行：

```
WaitForSingleObject(SyncProcPtr.Signal, Infinite); 
```

永远等待。

因此，虽然我的上述修复工作有效，但还有更深层次的东西！

# c# - 我应该为 .NET 使用哪个 Memcached 客户端库？

> ID：272989
> 
> 赞同：4
> 
> 时间：2008-11-07T18:02:31.600
> 
> 标签：c#, asp.net, caching, scaling

我注意到有一些解决方案允许在 C#/ASP.NET 上使用 memcached：

*   内存缓存点网

*   enyim.com Memcached 客户端

*   贝特

我应该使用哪一个？似乎 enyim 端口有更积极的发展，但我想看看你们推荐什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T18:11:50.783

我使用[BeIT](http://code.google.com/p/beitmemcached/)，对此我很满意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T18:17:11.773

看看[速度](http://msdn.microsoft.com/en-us/data/cc655792.aspx)。它是微软的新替代品，它还不稳定，但看起来很有希望。

# ruby-on-rails - 在 Rails 模板中使用条件语句修饰符

> ID：272993
> 
> 赞同：2
> 
> 时间：2008-11-07T18:03:13.780
> 
> 标签：ruby-on-rails, ruby

我有一个生成 Javascript 对象的 rails 模板（.rhtml 文件）。它看起来像下面这样：

```
var volumes = {
  <% for volume in @volumes %>
    <%= volume.id %> : <%= volume.data %> 
    <%= ',' unless volume === @volumes.last %>
  <% end %>
}; 
```

注意`unless`语句修饰符禁止在最后一个元素之后打印逗号（以满足 Internet Explorer，它难以置信地不支持 JSON 属性声明中的尾随逗号）。

这似乎可行，但就风格而言，人们认为`<%= value unless condition %>`在模板中依赖生成适当的`render`调用是否合理？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T18:07:00.780

我不明白为什么不这样做，但通常如果你发现自己在最后一个成员上设置逗号，你可能想`join`改用：

```
<%= @volumes.map {|v| "#{v.id} : #{v.data}"}.join "," %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T22:44:07.507

如果您想构建 JSON（顺便说一句，您正在构建 JavaScript 对象而不是数组），那么我建议使用 to_json 方法：

```
var volumes = <%= @volumes.inject({}){|h,v| h.merge(v.id=>v.data)}.to_json %>; 
```

或者

```
var volumes = <%= Hash[*@volumes.map{|v| [v.id, v.data]}.flatten].to_json %>; 
```

更好的办法是将 Ruby Hash 构造移动到模型中，因为它太复杂而无法查看。

```
class Volume
  def self.to_hash(volumes)
    Hash[*volumes.map{|v| [v.id, v.data]}.flatten]
  end
end 
```

然后在视图中您可以放置​​更简单的代码：

```
var volumes = <%= Volume.to_hash(@volumes).to_json %>; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T20:09:42.903

甚至：

```
<%= @volumes.map { |v| "#{v.id} : #{v.data}"}.to_sentence -%> 
```

得到“a：某物，b：其他东西，c：任何东西，d：其他东西”。***********