# StackOverflow 问答 11635000-11635999

# java - 运行时错误：NZEC

> ID：11635000
> 
> 赞同：0
> 
> 时间：2012-07-24T16:11:33.883
> 
> 标签：java, runtime-error

[在http://www.codechef.com/problems/LASTDIG](http://www.codechef.com/problems/LASTDIG)提交问题时，我不断收到运行时错误。

我的代码如下：

```
public class Main {
    public static void main(String[] args) {
        try {
            Scanner in = new Scanner(System.in);
            int i,j;
            System.out.println("Enter the no. of test cases - ");
            int cases = in.nextInt();

            int[][] a = new int[cases][2];
            int[] lds = new int[cases]; 

            for(i=0; i<cases; i++) {
                for(j=0; j<2; j++) {
                    a[i][j]=in.nextInt();
                }
            }

            for(j=0; j<cases; j++) {
                lds[j] = 0;
                int LENGTH = a[j][1] - a[j][0] +1;
                int[] arr = new int[LENGTH];
                //System.out.printf("%d\n",LENGTH);
                int[]sum = new int[LENGTH];

                for(i=0; i<LENGTH; i++) {
                    sum[i] = 0;
                    arr[i] = a[j][0] + i;
                }

                for(i=0; i<LENGTH; i++) {
                    int temp = arr[i];
                    while(temp !=0 ) {
                        int r = temp%10;
                        temp /= 10;

                        if (r%2 == 0) sum[i] += r*2;
                        else sum[i] += r;
                    }
                }

                for(i=0; i<LENGTH; i++){
                    lds[j] += sum[i]%10;
                }

            }

            for(i=0; i<cases; i++) {
                System.out.printf("%d\n",lds[i]);
            }
        }
        catch(Exception e) {
            e.printStackTrace();
        }
    }
} 
```

考虑到这个问题很简单，请在这里帮助我。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T18:01:23.597

代码本身运行良好......鉴于给出了合理的输入。对于不同的输入，可能会出现如下错误：

1.  如果个案不是整数怎么办？
2.  如果个案是负整数怎么办？

因此，当编辑试图完成时，我们需要为不可预见的用例提供合理的反馈。

但是对于链接中的问题，还有其他潜在的问题。溢出？对于非常大的数字，不会存在溢出，2^32 大于最大数字，但我确实注意到一个大整数会产生 OutOfMemory 错误，所以我认为这段代码归结为效率低下，需要更好的处理较大整数的算法。

# objective-c - 渲染多页 PDF

> ID：11635009
> 
> 赞同：0
> 
> 时间：2012-07-24T16:12:06.033
> 
> 标签：objective-c, ios, pdf-generation

我有一个用于测试的应用程序，它可以做很多事情，但最终产品是一个上传到数据库的 .pdf。不幸的是，我的一位最终用户不喜欢长 .pdf 是一页的事实。生成的页面长度变化很大，所以无论如何我都只是生成一个页面。我知道 Adob​​e Acrobat 会将大文件平铺到多个页面上进行打印，但客户担心这对某些人来说可能太难了 -_-

这是我现在创建 .pdf 的方式

```
- (void)exportAsPDF:(NSString *)filename
{        
    int restorer = mineTable.frame.size.height;

    CGRect temp = CGRectMake(mineTable.frame.origin.x, mineTable.frame.origin.y, mineTable.frame.size.width, 200*formDataStorage.cake.count);
    [self resizeTheTable:temp];

    int addNumber = temp.size.height - temp.origin.y;

    CGRect mediaBox = CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height + addNumber);

    NSString *tmpFile = filename;

    CGContextRef ctx = CGPDFContextCreateWithURL((__bridge CFURLRef)[NSURL fileURLWithPath:tmpFile], &mediaBox, NULL);

    //turn PDF upside-down
    CGAffineTransform transform = CGAffineTransformIdentity;
    transform = CGAffineTransformMakeTranslation(0, mediaBox.size.height);
    transform = CGAffineTransformScale(transform, 1.0, -1.0);

    CGPDFContextBeginPage(ctx, NULL);
    CGContextConcatCTM(ctx, transform);

    [self.view setNeedsLayout];
    [self.view setNeedsDisplay];
    [self.view.layer renderInContext:ctx];

    CGPDFContextEndPage(ctx);

    CGPDFContextClose(ctx);
    CFRelease(ctx);
} 
```

如您所见，我调整了视图的大小以显示我正在渲染的表格中的所有单元格，然后将视图截屏为 .pdf。用户永远不会看到调整大小的视图（无论如何它都不适合屏幕）。

有谁知道如何将创建的 .pdf 的不同部分与不同的页面相关联？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T17:19:07.640

我最终使用了这段代码：

```
- (void)exportAsPDF:(NSString *)filename
{        
    int restorer = mineTable.frame.size.height;
    CGRect temp = CGRectMake(mineTable.frame.origin.x, mineTable.frame.origin.y, mineTable.frame.size.width, 398*formDataStorage.cake.count);
    [self resizeTheTable:temp];

    int addNumber = temp.size.height - temp.origin.y;
    CGRect mediaBox = CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height + addNumber);

    NSMutableData *theData = [NSMutableData data];
    CGSize pageSize = CGSizeMake(self.view.frame.size.width, 792);
    UIGraphicsBeginPDFContextToData(theData, CGRectZero, nil);
    CGContextRef pdfContext = UIGraphicsGetCurrentContext();

    NSInteger currentPage = 0;
    BOOL done = NO;

    do {
        UIGraphicsBeginPDFPageWithInfo(CGRectMake(0, 0.0, pageSize.width, pageSize.height), nil);
        CGContextTranslateCTM(pdfContext, 0, -(pageSize.height*currentPage));
        [self.view.layer renderInContext:pdfContext];

        if ((pageSize.height*(currentPage+1)) > mediaBox.size.height) done = YES;
        else currentPage++;
    } while (!done);

    UIGraphicsEndPDFContext();

    [theData writeToFile:filename atomically:YES];
    NSLog(@"PDF written to: %@", filename);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T08:54:59.703

您已经回答了自己，但如果有帮助，您可以使用像[Docmosis](http://www.docmosis.com)这样的服务从 iOS 生成 PDF。在您的情况下，永远不会发生分页问题，​​因为文档“流动”，因为它们是基于模板填充的。缺点是您必须连接到网络。

# android - 在 Android 手机处于配件模式时打开或关闭 ADB 会将其从配件模式中移除

> ID：11635011
> 
> 赞同：1
> 
> 时间：2012-07-24T16:12:10.980
> 
> 标签：android, adb, adk, pyusb

我正在为与我的计算机连接的 Nexus S 编写和应用程序。

将手机设置为附件模式后，每当我在附件模式下打开或关闭 ADB 时，手机都会离开附件模式并返回常规 USB 模式，从而使我的应用程序脱离其路径。

这种行为是可以预期的吗？有什么办法可以让设备保持在附件模式并打开或关闭 ADB？我希望它从带 ADB 开启模式的附件模式转到带 ADB 关闭模式的附件模式，反之亦然，但发生的情况是它从带 ADB 开启或关闭的附件模式变为带 ADB 关闭的常规 USB 模式或开。

我正在linux VM中尝试这个，这可能是原因吗？

另外，我可以发誓我昨晚让它工作了，但不确定是什么变化导致了这种行为的发生。

# asp.net - 在维护前几个小时显示网站维护通知

> ID：11635016
> 
> 赞同：0
> 
> 时间：2012-07-24T16:12:26.880
> 
> 标签：asp.net, notifications, maintenance, maintenance-plan

我们的网站在 asp .Net 上。为了关闭网站并显示离线消息，我们使用 app_offline.htm。

但是我们想在网站关闭前一天通知我们的客户，以便他们可以相应地计划他们的活动。（我喜欢堆栈溢出的方式，它在主页上带有一个小通知）。

我想知道最好的方法是什么。是否有可能以简单的方式完成它，比如通过一些配置文件更改或其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:17:53.567

我有一个小的 CMS 片段，我会在相关时填写信息，否则留空。你可以为此做类似的事情。

或者有一个面板只显示是否设置了 web 配置标志被翻转

# angularjs - 一起使用 AngularJS ng-bind 和 ng-href？

> ID：11635018
> 
> 赞同：6
> 
> 时间：2012-07-24T16:12:30.823
> 
> 标签：angularjs

使用 AngularJS，我注意到一种对我来说似乎是错误的模式。

建表时，我的数据是使用 ng-bind 绑定的。但是，如果我需要单元格中的文本链接到某些内容，则必须手动创建链接。

非链接表格单元格如下所示：

```
<td ng-bind="customer.name"></td> 
```

但是，如果我想创建一个链接，我会这样做：

```
<td><a ng-href="/customer/{{customer.id}}">{{customer.name}}</a></td> 
```

有没有办法使用属性创建链接？就像是：

```
<td ng-bind="customer.name" ng-href="/customer/{customer.id}"></td> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T20:35:09.237

这不是一个真正的 AngularJS 问题。这更多地是关于 HTML 是如何工作的。HTML 不允许您仅`href`向任何元素添加属性来创建链接。您需要使用锚标记来创建链接。

如果需要，您可以[编写一个指令](http://docs.angularjs.org/guide/directive)，在单元格内生成锚标记。但这似乎不值得，而且大多数人可能会同意它产生的语义更少、更混乱的标记。

HTML 链接规范：[http ://www.w3.org/TR/html4/struct/links.html](http://www.w3.org/TR/html4/struct/links.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-20T11:00:44.973

你可以使用`ng-bind`，是的，但是在里面`<a>`，就像@btford 说的那样。

```
<td><a ng-href="/customer/{{customer.id}}" ng-bind="customer.name"></a></td> 
```

# ruby - 在 Ruby 中处理单个值或数组的最佳方法是什么

> ID：11635022
> 
> 赞同：1
> 
> 时间：2012-07-24T16:12:42.527
> 
> 标签：ruby, arrays

我想编写一个接受单个值或数组的方法。在 Ruby 中执行此操作的最佳习惯用法是什么？

以下是我想到的几件事：

```
def do_something(items)
  [*items].each { |item| ... }
end 
```

我喜欢那个简洁，但除非你习惯这种语法，否则不清楚

下一个只是感觉代码太多了。

```
def do_something(items)
  items = [items] unless items.respond_to? :each
  items.each { |item| ... }
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:16:58.513

该[`Kernel#Array`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-Array)方法在这里运行良好，旨在用于将事物强制转换为数组：

```
irb(main):001:0> def my_length(item_or_array)
irb(main):002:1>   Array(item_or_array).length
irb(main):003:1> end
=> nil
irb(main):004:0> my_length('one')
=> 1
irb(main):005:0> my_length([1, 2, 3])
=> 3 
```

# objective-c - 在视图中拖动项目

> ID：11635030
> 
> 赞同：0
> 
> 时间：2012-07-24T16:13:14.870
> 
> 标签：objective-c, macos, cocoa

我刚刚开始了一个小项目，它是一些自定义建模语言的编辑器。在编辑器中，用户应该能够放置新项目、连接它们并重新排列（在窗口中移动）。

我的问题是 - 我应该从头开始并实现从 继承的自定义视图`NSView`，将每个项目或连接放在它自己的层中，而不是实现用于选择项目的算法，找出已单击的项目等等？或者也许它已经完成了，但我不知道？（我问是因为我想避免重新发明轮子；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:52:22.017

您将不得不子类`NSView`化，但互联网上散布着这样的例子。

这是来自 Apple 的一些示例代码：[DragItemAround](http://developer.apple.com/library/mac/#samplecode/DragItemAround/Introduction/Intro.html)

# c++ - C++ 通过特定耳机控制音频

> ID：11635041
> 
> 赞同：0
> 
> 时间：2012-07-24T16:13:55.083
> 
> 标签：c++, audio

Windows 中是否有用于控制两个不同耳机（在一组中？即左耳机和右耳机）之间音频的内置功能，或者，您是否有为此目的向我推荐的音频库？

提前感谢！

# ruby - bundler 在哪里存储宝石？

> ID：11635042
> 
> 赞同：88
> 
> 时间：2012-07-24T16:13:58.207
> 
> 标签：ruby, gem, rvm, bundler, gemset

我知道在使用时`gem install`，gem 将存储在 /home/username/.rvm/gems/ 下，gem 安装在该 gemset 下。

但是如果我使用 Bundler 并在 Gemfile 中指定 gem，当我运行 bundle install 时，这些 gem 将存储在哪里？如果我已经使用 安装了 gem `gem install`，如果我运行 bundle install，它会使用以前安装的 gem`gem install`吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2015-09-17T19:55:40.447

如果您想找出特定 gem 的存储位置，您可以运行`bundle info <gem-name>`. 例如：

```
user@host$ bundle info rake
/var/bundle/ruby/2.1.0/gems/rake-10.4.2 
```

对于旧版本的 rake，命令可以是`bundle show <gem_name>.`

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2012-07-24T16:20:51.680

这取决于。在通常的开发设置中，当您“正常”（通过运行）安装 gem 时，它们会安装在它们所在的位置，`gem install foo`并且 bundler 不会重新安装已经存在的 gem。该位置取决于 ruby​​gems 本身的配置方式。

如果您使用该`--deployment`选项运行 bundle install，则 gem 将安装在您的应用程序独有的位置（您可以将其作为单独的选项传递，但默认为供应商/捆绑包）

您还可以运行`bundle package`以存储您的应用程序使用的所有 .gem 文件`vendor/cache`。与其他位置的 gem 相比， Running`bundle install`会更喜欢 vendor/cache 中的 gem。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2020-05-27T23:49:28.423

我`bundle config path`用来查看宝石的存储位置。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-27T11:03:16.077

这里`/usr/local/lib/ruby/gems/2.1.0/gems/`和这里：`/usr/local/lib/ruby/gems/2.1.0/bundler/gems/`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-01-29T14:14:31.360

请注意，gems 也安装`bundle`在“Gem Path”中的文件夹中（请参阅：`bundle env`）。例如，在从以下位置安装 gem 时会发生这种情况`git`：

```
gem 'my-gem', git: "https://github.com/x/y.git" 
```

我认为这是为了使自定义安装不会与 gem 服务器的安装发生冲突。

# debugging - Salesforce 调试日志过滤器卡住并且不会更改

> ID：11635043
> 
> 赞同：2
> 
> 时间：2012-07-24T16:13:59.943
> 
> 标签：debugging, salesforce

我的组织中的调试日志过滤器设置如下（直接从调试日志复制）：

APEX_CODE,FINE;APEX_PROFILING,FINE;DB,INFO;VALIDATION,INFO;WORKFLOW,FINEST

无论我尝试什么，这些设置都不会改变，并且因为其中一些设置为精细/最佳，它们使我的调试日志达到最大大小：

****** *****达到最大调试日志大小***** ********

 **它们很快就会达到最大值，以至于我在代码中放置的任何调试语句都没有达到，这使得日志毫无用处。

我尝试在我的组织的调试日志部分更改过滤器，我尝试了开发人员控制台，并使用了 Eclipse IDE。我已经在我的 Dev org 和 Sandbox 中尝试过这个。没有什么帮助。这些设置不会改变。

有没有人遇到过这种情况，或者知道如何覆盖这些选项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T00:24:07.603

Salesforce 中的调试日志级别可以在多个不同位置设置，这些位置相互覆盖，因此并不总是清楚您的代码将使用哪些日志级别执行。我在下面按优先级从低到高的顺序列出了它们：IE 2 覆盖 1、3 覆盖 1 和 2。

1.  **调试日志过滤器**- 在设置下的调试日志页面上设置的日志级别。
2.  **开发者控制台**- 在工作区管理下的开发者控制台中设置的日志级别
3.  **apex 类/触发器**- 从 apex 类或触发器的详细信息页面设置的日志级别。当您覆盖类/触发器的过滤器时，您应该在调试日志中看到 PUSH_TRACE_FLAGS 和 POP_TRACE_FLAGS。

**注意事项：**调试日志过滤不适用于[testmethods](http://success.salesforce.com/ideaView?id=08730000000iKMpAAM)。所有测试都使用一组预定义的过滤器运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T13:29:14.253

这也发生在我身上。每当我更改调试过滤器设置并单击保存时，调试日志不会根据过滤器设置进行过滤，当我再次检查过滤器设置时，它们被设置为好像我一开始没有更改它们一样 - 好像没有我对过滤器设置所做的更改已保存。

一旦我在调试日志“受监控的用户”列表中删除了我的用户并再次创建它，一切正常 - 我能够编辑过滤器设置，保存它（SF 终于记住了更改）并根据过滤器...

如果这不起作用，请尝试再次删除它并再次设置它，我认为它只有在我第二次删除它之后才开始为我工作:)

**编辑：**我现在记得我在开发人员控制台中看到在覆盖调试过滤器时没有提供“NONE”选项，所以在我最后一次尝试中，我尝试以一种没有过滤器设置为“NONE”的方式设置它. 其背后的想法是，在幕后某处处理过滤器值时可能存在 SF 内部错误……

祝你好运！**

# wcf - 将可选的 gzip 压缩添加到自托管 WCF 服务

> ID：11635044
> 
> 赞同：2
> 
> 时间：2012-07-24T16:14:01.403
> 
> 标签：wcf, rest, gzip, custom-attributes

如何为我的自托管 WCF 服务添加可选的 gzip 压缩？我在这个场景中使用`WebHttpBinding`. 我想检查`Accept`标题是否包含字符串`gzip`并压缩比内容。

我想使用自定义属性。到目前为止，我目前使用自定义属性允许我在 XML 和 JSON 输出之间切换，但我现在不知道如何压缩输出。

在我的编码器开关属性中，我实现了`IDispatchMessageFormatter`按需更改`XmlObjectSerializer`. 但我不明白如何生成输出来修改它。

如果有人能指出我可能的解决方案，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T13:49:10.693

这不是一个属性，而是压缩 WCF 服务响应的基本代码，如果需要，可以将其包装到一个属性中。

```
public static void CompressResponseStream(HttpContext context = null)
{
    if (context == null)
        context = HttpContext.Current;

    string encodings = context.Request.Headers.Get("Accept-Encoding");

    if (!string.IsNullOrEmpty(encodings))
    {
        encodings = encodings.ToLowerInvariant();

        if (encodings.Contains("deflate"))
        {
            context.Response.Filter = new DeflateStream(context.Response.Filter, CompressionMode.Compress);
            context.Response.AppendHeader("Content-Encoding", "deflate");
            context.Response.AppendHeader("X-CompressResponseStream", "deflate");
        }
        else if (encodings.Contains("gzip"))
        {
            context.Response.Filter = new GZipStream(context.Response.Filter, CompressionMode.Compress);
            context.Response.AppendHeader("Content-Encoding", "gzip");
            context.Response.AppendHeader("X-CompressResponseStream", "gzip");
        }
        else
        {
            context.Response.AppendHeader("X-CompressResponseStream", "no-known-accept");
        }
    }
} 
```

[编辑]解决评论：

只需在 Web 服务操作主体的任何位置调用它，因为它会在响应中设置属性：

```
[OperationContract]
public ReturnType GetInformation(...) {
    // do some stuff
    CompressResponseStream();
} 
```

# python - 简单的嵌套 for 循环无法正常工作

> ID：11635054
> 
> 赞同：6
> 
> 时间：2012-07-24T16:14:44.913
> 
> 标签：python, file-io, for-loop

我在这里看不到问题，这让我发疯。我正在循环浏览 2 个文本文件。每个文件中有些行匹配，有些不匹配。我正在做的是循环 file1。对于该文件中的每一行，遍历 file2 并比较每个元素以查看它们是否相同。发生的事情是我的循环在第一次循环通过 file1 之后停止。这是我的代码：

```
while f < 50:
    for line in file1:
        for name in file2:
            if name == line:
                print 'a match was found'
    f+=1 
```

while 循环来自其他地方，但它工作正常。我只是将它包含在上下文中。问题是 file1 只给了我第一行，将它与 file2 中的所有“名称”进行比较，然后停止而不是对 file1 中的下一行重复该过程。我错过了一些明显的东西吗？

编辑：如果我在第一个 for 循环之后放入一个 print 语句并注释掉另一个 for 循环，它将循环整个第一个文件

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-24T16:16:06.470

您不能在不寻找开始的情况下循环浏览一个文件，然后再次循环浏览同一个文件。

重新打开 file2，调用`.seek(0)`file2 或将所有行加载到列表中并循环遍历该列表。

在您的特定情况下，使用 a`set`作为名称可能是最快的：

```
names = set(name.strip() for name in file2)
while f < 50:
    for line in file1:
        if line.strip() in names:
            f += 1 
```

您可以对 file1 中的行执行相同操作并设置交集，前提是 file1 和 file2 中的行都是唯一的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T16:16:16.753

问题可能是，一旦你迭代了`file2`它，它就会耗尽，所以你的内部 for 循环不再执行（因为没有任何东西`file2`可以迭代了）。您可以每次通过循环关闭/重新打开 file2，或者您可以在执行该循环之前回到开头。

更好的方法是使用集合（如果文件不是太大并且您不关心文件或订单中的重复项）：

```
matches = set(file1).intersection(file2) 
```

这应该只将 file1 读入内存并隐式地对 file2 进行循环。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T16:21:03.287

第一次内循环结束后，file2上的内迭代器到达末尾，所以解决方法是每次将file2的内迭代器指向文件的开头，例如：

```
while f < 50:
    for line in file1:
        file2.seek(0, 0)
        for name in file2:
            if name == line:
                print 'match!' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T16:22:52.097

根据文件的大小，您可以使用该`readlines()`函数将每个文件的行读入列表。

然后，遍历这些列表。这将确保您对文件位置的当前位置没有问题。

# html - 将 3 个内容框并排放置

> ID：11635055
> 
> 赞同：1
> 
> 时间：2012-07-24T16:14:45.613
> 
> 标签：html, css

我有一个名为 content 的主容器，在该容器中我有 3 个 div。现在我希望它们像这样彼此相邻对齐：XX X。在我读到的教程中，我应该将它们全部浮动到左侧。这适用于前两个，但第三个永远不会出现。我确定路径是正确的，因为当我把它放在第二个位置时它确实出现了。有人可以帮助我吗？

**HTML**

```
<div id="content"
    <div id="about_us"></div>
    <div id="our_services"></div>
    <div id="contact_us"></div>
</div> 
```

**CSS**

```
#content {
width: 1200px;
height: 254px;
}

#about_us {
background-image: url(../website/images/about_benshore.png);
width: 307px;
height: 183px;
float: left;
margin-top: 26px;
margin-left: 119px;
}

#our_services {
background-image: url(../website/images/our_services.png);
width: 308px;
height: 184px;
float: left;
margin-top: 26px;
margin-left: 23px;
}

#contact_us {
background-image: url(../website/images/contact_us.png);
width: 307px;
height: 183px;
float: left;
margin-top: 26px;
margin-left: 23px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:18:51.973

尝试将溢出：自动添加到#content。

还要确保元素的宽度加上它们各自的边距加起来不超过#content 的宽度。

# javascript - WebkitAnimationEnd 没有触发。谁能明白为什么？

> ID：11635056
> 
> 赞同：3
> 
> 时间：2012-07-24T16:14:48.177
> 
> 标签：javascript, css, listener, dom-events

我最近开始使用 Javascript，并且可以在我的工作中看到一些不错的动画终端侦听器应用程序。我有以下代码，我的动画结尾的听众都没有被触发。任何人都可以看到为什么两个听众中的任何一个都不起作用的任何原因吗？我正在浏览 Chrome。

[http://jsfiddle.net/spacebeers/jkUyT/1/](http://jsfiddle.net/spacebeers/jkUyT/1/)

```
#animationTest {
    width: 150px;
    text-align: center;
    display: block;
    padding: 20px;
    background: #000;
    color: #fff;
    border-bottom: 10px solid red;
    cursor: pointer;
            transition: border-bottom 0.5s linear; /* vendorless fallback */
         -o-transition: border-bottom 0.5s linear; /* opera */
        -ms-transition: border-bottom 0.5s linear; /* IE 10 */
       -moz-transition: border-bottom 0.5s linear; /* Firefox */
    -webkit-transition: border-bottom 0.5s linear; /*safari and chrome */
}

#animationTest:hover {
    border-bottom: 10px solid blue;
}

<a id="animationTest">Hover over me</a>

$('document').ready(function(){
    var animationTest = document.getElementById('animationTest');

    animationTest.addEventListener('webkitAnimationEnd', function(event){
            alert("Finished animation (listener)!");
            console.log("Finished animation (listener)!");
        }, false );

        $('#animationTest').bind("webkitAnimationEnd", function(event){
            alert("Finished animation (bind)!");
            console.log("Finished animation (bind)!");
        }, false );
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T16:19:36.377

它应该是`webkitTransitionEnd`

[http://jsfiddle.net/jkUyT/3/](http://jsfiddle.net/jkUyT/3/)

# java - 从可读性的角度来看 Java 变量的最佳名称长度

> ID：11635058
> 
> 赞同：0
> 
> 时间：2012-07-24T16:14:50.303
> 
> 标签：java, variables, code-readability

考虑以下 Java 代码段中的常量：

```
public class ConsumerServiceTestFixture {
    private ConsumerServiceTestFixture() {
        throw new AssertionError("This class should not be instantiated");
    }

    public static final String CUSTOMER_ID_NOT_INTEGER = "12345678901";
} 
```

上面的常量**CUSTOMER_ID_NOT_INTEGER**用于存储不能转换为 Integer 的 String，因为它的值大于 Integer.MAX_VALUE。

这从变量的名称中并不明显，该变量最多表示该值是“无效的”customer_id。没有传达*为什么*该值无效。

一种选择是写一条评论，内容如下：

```
// Invalid since this number is greater than Integer.MAX_VALUE
public static final String CUSTOMER_ID_NOT_INTEGER = "12345678901"; 
```

但是，如果我们必须编写自文档代码而不使用注释，那么唯一的其他选择就是使变量名称更具描述性。就像是 ：

```
public static final String CUSTOMER_ID_GREATER_THAN_INTEGER_MAX_VALUE = "12345678901"; 
```

但是，使用上述选项，我对变量名的长度不满意，特别是如果您考虑以下代码完成 2 中关于最佳变量名长度的片段：

![第 11 章 变量名的威力](../Images/72e9926cc3bf50b1c57887f50b3d1fd5.png)

你会建议我如何平衡变量名的长度和代码的可读性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:24:09.807

如果您使用 /** 注释而不是 // 注释（即 javadoc），当程序员从 IDE 使用您的常量或查看您的 javadoc 时，他将获得有关此类优缺点的完整解释一个设计，为什么这样做等等。

不幸的是，您不能将其命名为“CUSTOMER_ID_THAT_IS_A_STRING_BECAUSE_IF_IT_WAS_AN_INT_IT_WOULD_BE_TOO_LARGE”。

# ios - iPad 键盘渲染 - 缺少字母/键

> ID：11635059
> 
> 赞同：1
> 
> 时间：2012-07-24T16:14:52.077
> 
> 标签：ios, ipad

我已经在一个应用程序上工作了几个月了，最近一两周出现了一个奇怪的错误。长时间使用该应用程序（20-30 分钟）后，我们的许多自定义标签（基于 UILabel）停止正确呈现（有些只会显示为空白）。有趣的是，在这种情况下调出键盘会显示以下内容：

![在此处输入图像描述](../Images/e8a39e4bab43f7e393e54588a13620af.png)

在过去的几周里，我对代码库的各个部分进行了多次调整，但都无济于事，我希望这里的人之前可能偶然发现过类似的问题和/或可能对在哪里寻找有一些想法一个办法。

我们在自定义标签中使用大量 CoreGraphics 调用来渲染一些非常复杂的带注释的字符串，并在另一个线程的后台服务器上来回传输大量流量。关于内存，我们使用 ARC 并且我们在任何时候都在内存中保留大约 5-10Mb 的原始数据 - 我无法想象其他任何东西都会占用大量内存。

任何关于在哪里看的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:11:41.570

好吧，不是这个确切的问题，而是在窗口中可见的类似的非常奇怪的东西。它被追踪到来自主线程以外的 UIKit 消息传递。我们最终添加了很多“assert([NSThread isMainThread]);” 在我们认为可能会在屏幕上绘制的地方，果然，我们找到了有罪的一方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:16:34.210

关于在不同线程上进行 UI 调用的主题，我想我可以添加这段代码来演示不同线程如何进行 UI 调用。

```
dispatch_sync(dispatch_get_main_queue(), ^{
    // Put your UI code here
}); 
```

这将确保您的代码在运行循环处理期间在主线程上运行。

# javascript - 将焦点设置在文本区域中的特定行上

> ID：11635063
> 
> 赞同：0
> 
> 时间：2012-07-24T16:14:58.807
> 
> 标签：javascript, jquery

> **可能的重复：**
> [jQuery 在文本区域中设置光标位置，](https://stackoverflow.com/questions/499126/jquery-set-cursor-position-in-text-area)
> [指定在文本区域内聚焦的位置](https://stackoverflow.com/questions/1552567/specifying-where-to-focus-within-textarea)

我有一个多行的文本区域。比方说 10\. 如何将光标设置在第三行？

# java - Struts 2 使用状态索引

> ID：11635067
> 
> 赞同：4
> 
> 时间：2012-07-24T16:15:13.757
> 
> 标签：java, struts2, ognl

我有一段时间试图弄清楚状态索引在 Struts 2 中是如何工作的（我使用的是 Struts 2.3.4）。我正在尝试遍历**selectedValues**字符串列表中的项目 5-9：

```
<s:iterator value="availableOptions" var="currentSelect" begin="5" end="9" status="status">
    <td><s:select list="currentSelect" name="selectedValues" value="selectedValues" cssClass="day-select" /></td>
</s:iterator> 
```

但它正在查找如下值：selectedValues[0]、selectedValues[1] 等，而不是 selectedValues[5]、selectedValues[6]...

我似乎能够让它工作的唯一方法是手动添加 5，这似乎是一个 kludge：

```
<td><s:select list="currentSelect" name="selectedValues[5+#status.index]" value="selectedValues[5+#status.index]" cssClass="day-select" /></td> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-06T19:50:29.843

你可以试试这个 `availableOptions[%{#status.index}]selectedValues"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:27:43.070

尝试添加以下内容，看看它是否有效：

```
<s:iterator value="availableOptions" var="currentSelect" begin="5" end="9" status="status" step="1">
        <td><s:select list="currentSelect" name="selectedValues" value="selectedValues[#status.index]" cssClass="day-select" /></td>
    </s:iterator> 
```

`status.index`要使用的开始结束功能在哪里。
`Step`是知道如何开始计数。

# regex - 如何使用正则表达式在java中查找url模式

> ID：11635070
> 
> 赞同：0
> 
> 时间：2012-07-24T16:15:22.243
> 
> 标签：regex, url, pattern-matching

我想知道给定的字符串（代表一个 url）是否来自同一个子域。例如，[http](http://www.myDomain.com/someThing) ://www.myDomain.com/someThing 与 myDomain.com 的组合将返回 true。以下内容也将如此：

[http://myDomain.com](http://myDomain.com)；[http://www.domain.myDomain.com](http://www.domain.myDomain.com)；

但下一个（非法）网址不会 - 'http://.myDomain.com'（注意 myDomain 之前的点）

基本上，我需要一个正则表达式来代表 myDomain.com 之前的任何内容 - 通常需要是 (http|https)://[az.] *myDomain* - 这意味着在 myDomain.com 之前可能有字母后跟点 ( 0 次或更多次） - 但如果没有字母，也不应该有点。

有谁知道如何组装那个正则表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:19:45.000

```
http(s)?://([a-z]+\.)*myDomain\.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:35:58.147

它可以通过 URL 类和正则表达式的组合来完成：

```
 String url = "myDomain.com";
    String[] urlTest = {
        "http://www.myDomain.com/someThing",
        "http://myDomain.com",
        "http://www.domain.myDomain.com",
        "http://.myDomain.com",
        "http://example.com"

    };
    for (String urlx : urlTest) {
        System.out.print(urlx + "\t");
        try {
            URL u = new URL(urlx);
            String host = u.getHost();
            System.out.print("HOST=" + host + "\t");
            Matcher m = Pattern.compile("(.+\\.)?myDomain\\.com").matcher(host);
            System.out.println(m.matches());

        } catch (MalformedURLException ex) {
            System.out.println("false (no valid url)");
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-26T06:49:34.607

在这里举个例子：

```
Pattern aPattern = Pattern.compile("https://example.com[^\"<$\n \\[\\])]+", 
Pattern.MULTILINE);
            Matcher aMatcher = aPattern.matcher(Big String);
while (aMatcher.find()) {
logger.info(aMatcher.group());
} 
```

# c# - 为什么一种查找字符串中第 n 次出现的位置的方法比另一种方法快得多？

> ID：11635076
> 
> 赞同：5
> 
> 时间：2012-07-24T16:15:41.467
> 
> 标签：c#, string, benchmarking

我注意到[一些](https://stackoverflow.com/questions/186653/c-sharp-indexof-the-nth-occurrence-of-a-string) [关于](https://stackoverflow.com/questions/3976616/how-to-find-nth-occurrence-of-character-in-a-string)在字符串中查找第 n 个字符的[问题。](https://stackoverflow.com/questions/2571716/find-nth-occurrence-of-a-character-in-a-string) 由于我很好奇（并且在应用程序中有多种用途，但主要是出于好奇），我在 Visual Studio 2010 中对其中两种方法进行了编码和基准测试，我想知道为什么方法 1 ( ) 比方法慢得多2 ( )。我能想到的唯一原因是：`FindNthOccurrence``IndexOfNth`

1.  我的基准测试代码有问题
2.  我的算法有问题
3.  这`indexOf`是一种内置的 .NET 方法，因此已经过优化

我倾向于＃2，但我仍然想知道。这是相关的代码。

### 代码

```
class Program
    {
        static void Main(string[] args)
        {
            char searchChar = 'a';
            Random r = new Random(UnixTimestamp());

            // Generate sample data
            int numSearches = 100000, inputLength = 100;
            List<String> inputs = new List<String>(numSearches);
            List<int> nth = new List<int>(numSearches);
            List<int> occurrences = new List<int>(numSearches);
            for (int i = 0; i < numSearches; i++)
            {
                inputs.Add(GenerateRandomString(inputLength, "abcdefghijklmnopqrstuvwxyz"));
                nth.Add(r.Next(1, 4));
            }

            // Timing of FindNthOccurrence
            Stopwatch timeFindNth = Stopwatch.StartNew();
            for (int i = 0; i < numSearches; i++)
                occurrences.Add(FindNthOccurrence(inputs[i], searchChar, nth[i]));
            timeFindNth.Stop();

            Console.WriteLine(String.Format("FindNthOccurrence: {0} / {1}",
                                            timeFindNth.ElapsedMilliseconds, timeFindNth.ElapsedTicks));

            // Cleanup
            occurrences.Clear();

            // Timing of IndexOfNth
            Stopwatch timeIndexOf = Stopwatch.StartNew();
            for (int i = 0; i < numSearches; i++)
                occurrences.Add(IndexOfNth(inputs[i], searchChar, nth[i]));
            timeIndexOf.Stop();
            Console.WriteLine(String.Format("IndexOfNth: {0} / {1}",
                                            timeIndexOf.ElapsedMilliseconds, timeIndexOf.ElapsedTicks));

            Console.Read();
        }

        static int FindNthOccurrence(String input, char c, int n)
        {
            int len = input.Length;
            int occurrences = 0;
            for (int i = 0; i < len; i++)
            {
                if (input[i] == c)
                {
                    occurrences++;
                    if (occurrences == n)
                        return i;
                }
            }
            return -1;
        }

        static int IndexOfNth(String input, char c, int n)
        {
            int occurrence = 0;
            int pos = input.IndexOf(c, 0);
            while (pos != -1)
            {
                occurrence++;
                if (occurrence == n)
                    return pos;
                pos = input.IndexOf(c, pos + 1);
            }
            return -1;
        }

            // Helper methods
        static String GenerateRandomString(int length, String legalCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")
        {
            if (length < 0) throw new ArgumentOutOfRangeException("length", "length cannot be less than zero.");
            if (string.IsNullOrEmpty(legalCharacters))
                throw new ArgumentException("allowedChars may not be empty.");

            const int byteSize = 0x100;
            var legalCharSet = new HashSet<char>(legalCharacters).ToArray();
            if (byteSize < legalCharSet.Length)
                throw new ArgumentException(String.Format("allowedChars may contain no more than {0} characters.", byteSize));

            // Guid.NewGuid and System.Random are not particularly random. By using a
            // cryptographically-secure random number generator, the caller is always
            // protected, regardless of use.
            using (var rng = new System.Security.Cryptography.RNGCryptoServiceProvider())
            {
                StringBuilder result = new StringBuilder();
                var buf = new byte[128];
                while (result.Length < length)
                {
                    rng.GetBytes(buf);
                    for (var i = 0; i < buf.Length && result.Length < length; ++i)
                    {
                        // Divide the byte into legalCharSet-sized groups. If the
                        // random value falls into the last group and the last group is
                        // too small to choose from the entire legalCharSet, ignore
                        // the value in order to avoid biasing the result.
                        var outOfRangeStart = byteSize - (byteSize % legalCharSet.Length);
                        if (outOfRangeStart <= buf[i]) continue;
                        result.Append(legalCharSet[buf[i] % legalCharSet.Length]);
                    }
                }
                return result.ToString();
            }
        }

        static int UnixTimestamp()
        {
            TimeSpan ts = (System.DateTime.UtcNow - new System.DateTime(1970, 1, 1, 0, 0, 0));
            return (int)ts.TotalSeconds;
        }
    } 
```

### 样本输出

每个结果输出与此类似的时间（毫秒/经过的滴答声）：

```
FindNthOccurrence: 27 / 79716
IndexOfNth: 12 / 36492 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:33:29.560

我确定您运行的是调试版本。切换到发布版本。两种方法都需要大约相同的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:53:13.477

通过使用 Reflector 的源代码浏览`System.String`，似乎`IndexOf`调用了一个方法，该方法定义为：

```
public extern int IndexOf(char value, int startIndex, int count); 
```

所以它调用了一些内部非托管代码，这可能提供了观察到的速度提升。使用托管代码不太可能更快。

# css - 基于 CSS 的移动主题 - JQM 风格的“链表”，不使用完整的 JQM 框架

> ID：11635082
> 
> 赞同：0
> 
> 时间：2012-07-24T16:16:14.693
> 
> 标签：css, html, jquery-mobile

我需要一些特定于移动设备的样式，类似于 jquery mobile（以及 enyojs、sencha touch 等）提供的样式。特别是，我想使用类似于 jqm 的“[链表](http://jquerymobile.com/demos/1.1.1/docs/lists/lists-ul.html)”导航样式的东西。但是，我不想建立一个 JQM 站点。我正在使用backbone.js 构建站点，并且想要处理我自己的点击事件、路由和工作流程——我想要的只是样式。JQM 和我列出的其他人似乎希望您使用他们的整个 javascript 框架构建一个 JQM“应用程序”。例如，在 JQM 中，样式不会作为类直接应用于元素，而是由您提供`data-role="listview" data-theme="g"`，它会动态地将您的列表转换为它们的样式。

是否有任何基于 css 的开源移动主题，我可以使用它来设置我自己`ul`的样式，类似于 jqm 链接列表，并自己处理 javascript 事件侦听器和工作流？或者我错过了什么，有一种方法可以只使用 JQM css？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T17:08:01.967

Enyo 的 Onyx 库包含一组 LESS 文件，可用于从 Onyx 获取样式。在这里查看：

[https://github.com/enyojs/onyx/tree/master/css](https://github.com/enyojs/onyx/tree/master/css)

此外，虽然不是真正的移动设备，但如果您只需要样式，则始终可以使用引导程序作为起点。

（当然，Enyo 是创建应用程序的好方法，因此您不应该直接关闭它。;)）

[哇哦，这个问题很老了]

# android - 使用上下文调用另一个类的方法

> ID：11635086
> 
> 赞同：7
> 
> 时间：2012-07-24T16:16:30.013
> 
> 标签：android, android-context

我有一个带有 ImageButton 的自定义标题栏，它会生成一个对话框，并且当从对话框中选择列表项并且标题栏和地图位于时，我希望能够在地图（在另一个类中）上显示位置（放置 itemizedOverlay）相同的上下文。我在某处读到我可以使用上下文调用另一个类的方法。我该怎么做？

```
public class MyTitleBar extends RelativeLayout{

private Context context;

public MyTitleBar(Context context, AttributeSet attrs) {
    super(context, attrs);
    this.context = context;
}

@Override
protected void onFinishInflate() {

    super.onFinishInflate();

    initViews();
}

// set up all the buttons  & clicks
private void initViews() {

    final ImageButton listImgBtn = (ImageButton) findViewById(R.id.more);
    final CharSequence [] listItems = {"Elderly","Events"};

    listImgBtn.setOnClickListener(new  View.OnClickListener() {
        @Override
        public void onClick(View v) {
            if(context instanceof UserHome)
            {
                AlertDialog.Builder builder = new AlertDialog.Builder(context);
                builder.setTitle("List");
                builder.setItems(listItems, new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int item) {
                    // TODO Auto-generated method stub
                    if(item == 0)
                    {
                        //show location of elderly
                       //DisplayLocation()

                    }
                    else if(item == 1)
                    {
                        //show location of events
                    }
                }
            });
            AlertDialog alert = builder.create();
            alert.show();
          }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-10T04:29:23.567

看起来我可以这样做：

```
UserHome userhome = (UserHome)context;
userhome.DisplayLocation(); 
```

其中 DisplayLocation() 在 UserHome 活动中。简单的。

# java - 使用投影休眠部分填充的对象

> ID：11635090
> 
> 赞同：1
> 
> 时间：2012-07-24T16:16:44.113
> 
> 标签：java, hibernate

[我的问题与这个SO question](https://stackoverflow.com/questions/7175399/hibernate-result-transformer?rq=1)完全相同。

假设我们有像这样的实体

```
public class Employee {
    Long getId();
    String getName();
    Address getAddress();  
} 
```

在 createCriteria 和 Projections 的帮助下，我们尝试从用户和地址表中获取 id、name 和 city。

我们遇到的问题是，城市没有被设置为处理对象城市属性。

这是我们尝试的代码：

```
 Criteria cr = session.createCriteria(Employee.class)
                    .setProjection(Projections.projectionList()
                    .add(Projections.property("id"), "id")
                    .add(Projections.property("Name"), "Name")
                    .add(Projections.property("address.city"), "address.city"))
                    .addOrder(Order.asc("address.city"))
                    .createAlias("address", "address")
                    .setResultTransformer(Transformers.aliasToBean(Employee.class)); 
```

根据对`JBNizet`上述问题的评论，我理解部分对象是个坏主意，但是如果我被要求这样做，我该如何实现呢？任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:42:48.073

使用[AliasToBeanConstructorResultTransformer](http://docs.jboss.org/hibernate/core/3.6/javadocs/org/hibernate/transform/AliasToBeanConstructorResultTransformer.html)，并在您的实体中定义如下构造函数：

```
public Employee(Long id, String name, String city) {
    this.id = id;
    this.name = name;
    this.address = new Address();
    this.address.setCity(city);
} 
```

或者，（这是我首选的解决方案，因为它避免了反射并允许以较小的风险重构代码）不要使用任何结果转换器并自己构建实例：

```
List<Object[]> rows = criteria.list();
List<Employee> result = new ArrayList<Employee>(rows.size());
for (Object[] row : rows) {
    Employee e = new Employee();
    e.setId((Long) row[0]);
    e.setName((String) row[1]);
    Address address = new Address();
    address.setCity((String) row[2]);
    e.setAddress(address);
    result.add(e);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-22T08:33:26.143

你也可以试试这个：

```
Criteria cr = session.createCriteria(Employee.class)
                    .setProjection(Projections.projectionList()
                    .add(Projections.property("id"), "id")
                    .add(Projections.property("name"), "name")
                    .add(Projections.property("address.city"), "addressCity"))
                    .addOrder(Order.asc("address.city"))
                    .createAlias("address", "address")
                    .setResultTransformer(Transformers.aliasToBean(Employee.class)); 
```

并在 Employee 类中为 addressCity 添加设置器

```
public void setAddressCity( String addressCity ){
    address.setCity(addressCity);
} 
```

不用说Employee的构造函数，也应该实例化Address对象。

# exception - cudaGetExportTable（CUDA 运行时库）中抛出异常'cudaError_enum'？

> ID：11635093
> 
> 赞同：0
> 
> 时间：2012-07-24T16:17:00.997
> 
> 标签：exception, cuda, mpi, icc

我正在使用 DDT 调试基于 MPI 的 CUDA 程序。当 CUDA 运行时库（libcudart）在（未记录的）函数中抛出异常时，我的代码中止`cudaGetExportTable`，当从我的代码中调用`cudaMalloc`和`cudaThreadSynchronize`（更新：使用`cudaDeviceSynchronize`给出相同的错误）时。

为什么 libcudart 会抛出异常（我使用的是 C API，而不是 C++ API），然后我才能在我的代码中使用它的`cudaError_t`返回值或 with检测到它`CHECKCUDAERROR`？

（我正在使用适用于 Linux 的 CUDA 4.2 SDK。）

输出：

```
Process 9: terminate called after throwing an instance of 'cudaError_enum'
Process 9: terminate called recursively

Process 20: terminate called after throwing an instance of 'cudaError'
Process 20: terminate called recursively 
```

我的代码：

```
cudaThreadSynchronize();
CHECKCUDAERROR("cudaThreadSynchronize()"); 
```

其他代码片段：

```
const size_t t;  // from argument to function
void* p=NULL;
const cudaError_t r=cudaMalloc(&p, t);
if (r!=cudaSuccess) {
    ERROR("cudaMalloc failed.");
} 
```

部分回溯：

```
Process 9:
cudaDeviceSynchronize()
-> cudaGetExportTable()
   -> __cxa_throw

Process 20:
cudaMalloc()
-> cudaGetExportTable()
   -> cudaGetExportTable()
      -> __cxa_throw 
```

内存调试错误：

```
Processes 0,2,4,6-9,15-17,20-21:
Memory error detected in Malloc_cuda_gx (cudamalloc.cu:35):
dmalloc bad admin structure list. 
```

这一行是上面显示的 cudaMalloc 代码片段。还：

```
Processes 1,3,5,10-11,13-14,18-19,23:
Memory error detected in vfprintf from /lib64/libc.so.6:
dmalloc bad admin structure list. 
```

此外，当在每个节点 3 个内核/gpus 而不是每个节点 4 个 gpus 上运行时，dmalloc 会检测到类似的内存错误，但是当不在调试模式下时，代码运行得非常好，每个节点 3 个 gpus（据我所知）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T21:34:30.647

用 gcc 重新编译。（我使用 icc 来编译我的代码。）

当你这样做时，调试时出现异常，但继续过去，我得到真正的 CUDA 错误：

```
Process 9: gadget_cuda_gx.cu:116: ERROR in gadget_cuda_gx.cu:919: CUDA ERROR:   cudaThreadSynchronize(): unspecified launch failure
Process 20: cudamalloc.cu:38: ERROR all CUDA-capable devices are busy or unavailable, cudaMalloc failed to allocate 856792 bytes = 0.817101 Mb 
```

Valgrind 在我的代码中没有发现内存损坏或泄漏（使用 gcc 或 icc 编译），但确实在 libcudart 中发现了一些泄漏。

更新：仍然没有修复。似乎与该线程的答案 #2 中报告的问题相同：[cudaMemset failed on __device__ variable](https://stackoverflow.com/questions/9996563/cudamemset-fails-on-device-variable)。运行时没有按应有的方式工作，似乎...

# iphone - GPS 在 iOS 4 上工作，但在 iOS 5 上不工作

> ID：11635094
> 
> 赞同：1
> 
> 时间：2012-07-24T16:17:00.917
> 
> 标签：iphone, ios

在我的 AppDelegate 我有一个属性：

```
GPSTracking*        _GPSTracker; 
```

负责启动位置更新。它使用单例`CLLocationManagerDelegate`并像这样使用它：

```
@implementation GPSTracking

-(id) initWithDelegate:(MSpyAppDelegate *) _del
{
    if (self = [super init])
    {   
        self.mainDelegate = _del;
        [[InternalGPSManager sharedInstance] setMainDelegate: self.mainDelegate];
    }
    return self;
}

//Start getting locations
- (void)startUpdatingByManager
{
    [[InternalGPSManager sharedInstance] startLocationUpdateInSeparateThread];
    self.gpsTimer = [NSTimer scheduledTimerWithTimeInterval:(gpsUpdateInterval * 60)    target:self selector:@selector(startUpdatingByManager) userInfo:nil repeats:NO] 
} 
```

实际位置经理委托：

内部GPSManager.h：

```
@interface InternalGPSManager : NSObject <CLLocationManagerDelegate>
   {
      CLLocationManager *locationManager;
   }
@property (nonatomic, retain) CLLocationManager *locationManager; 
```

内部GPSManager.m

```
static InternalGPSManager *sharedCLDelegate = nil;
@implementation InternalGPSManager
@synthesize locationManager;

- (id)init
{
    self = [super init];

    if (self != nil) 
    {
        self.locationManager = [[[CLLocationManager alloc] init] autorelease];
        self.locationManager.delegate = self;
        self.locationManager.desiredAccuracy = kCLLocationAccuracyBest;
    }

    return self;
}
    - (void)startLocationUpdateInSeparateThread
    {
        [NSThread detachNewThreadSelector:@selector(startLocationUpdate) toTarget:self withObject:nil];
    }
    - (void)startLocationUpdate
    {
        NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

        [self.locationManager startUpdatingLocation];

        [pool release];
    } 
```

它适用于 iOS 4，但不适用于 iOS 5。位置委托回调永远不会被调用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T02:02:04.293

问题是您在后台线程中开始位置更新，然后在您告诉位置更新开始时立即清理。

`detachNewThreadSelector:toTarget:withObject:`来自[Apple 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsthread_Class/Reference/Reference.html)：

> 对象 aTarget 和 anArgument 在分离线程执行期间被保留，然后被释放。一旦 aTarget 完成执行 aSelector 方法，分离的线程就会退出（使用 exit 类方法）。

因此，一旦您`startLocationUpdate`完成，该线程就会被清理。

然后，从位置管理器委托上的[这些其他 Apple 文档中：](https://developer.apple.com/library/mac/#documentation/CoreLocation/Reference/CLLocationManagerDelegate_Protocol/CLLocationManagerDelegate/CLLocationManagerDelegate.html#//apple_ref/doc/uid/TP40007124)

> 您的委托对象的方法是从您启动相应位置服务的线程中调用的。该线程本身必须有一个活动的运行循环，就像在应用程序的主线程中找到的那样

因此，他们`CLLocationManager`希望在您启动它们的同一线程（调用的线程`startUpdatingLocation`）上用位置更新给您回电，但是当位置修复可用时，该线程可能已经消失。我还可以相信，您*可以*在一个设备/操作系统上使用代码而不是在另一个设备/操作系统上幸运。

所以，要么：

*   在主线程上启动位置更新。开始位置更新是一个异步操作，所以仅仅因为您在主 (UI) 线程上执行此操作，并不意味着整个 UI 被阻塞，直到位置修复可用。这只是意味着当位置可用时，您将在 UI 线程上被回调。

或者 ...

*   只要您想继续接收位置更新，就让您的后台线程一直存在

做第一个，做这个

```
[self.locationManager startUpdatingLocation]; 
```

而不是调用`startLocationUpdateInSeparateThread`. 要执行第二个，请添加以下代码：

```
- (void)startLocationUpdate 
{ 
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init]; 

    [self.locationManager startUpdatingLocation]; 

    [[NSRunLoop currentRunLoop] run];  // keep this background thread from being cleaned up

    [pool release]; 
} 
```

如果您的`CLLocationManagerDelegate`回调（用于接收位置更新）没有进行任何繁重的处理，那么我建议您完全避免使用后台线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:08:22.300

幽默，并尝试将您的代码更改为：

```
- (void)startLocationUpdateInSeparateThread
{
   // Not a separate thread!
   NSLog(@"Starting updates using delegate: %@", self.locationManager.delegate);
   [self.locationManager startUpdatingLocation];
} 
```

PS：你为什么不使用ARC？？？

# javascript - 仅在 IE8 中出现 Javascript“未定义”错误

> ID：11635099
> 
> 赞同：-3
> 
> 时间：2012-07-24T16:17:21.913
> 
> 标签：javascript, internet-explorer

我在[http://www.mincovlaw.com/interest/calculate](http://www.mincovlaw.com/interest/calculate)的脚本在 FF、Chrome、Safari 和 IE9 中运行良好。

我刚刚意识到它会`'newamount' is undefined`在 IE8 中引发错误。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:22:17.607

**首先**，您有一个脚本错误需要修复。

```
window.onload=changeaboutfirm(1); 
```

事件`onload`应该直接绑定到对函数的引用，而不是`changeaboutfirm()`返回的任何内容。你可能想要这样的东西：

```
window.onload = function () { changeaboutfirm(1); } 
```

在 IE 中，这会引发“未实现”异常，这很可能会阻止其他脚本运行。

**其次**，`newamount`没有在任何地方定义。唯一提到它的地方是在`editamount`函数中：

```
function editamount() {
    changedamount=getAmount();
    var name=prompt("New Amount (Numbers ONLY):",changedamount);
    if (name != '' && name != null) {
        isNaN(newamount) ? changedamount : parseFloat(newamount);
        y.innerHTML="$"+nicenumber(newamount);
    }
    if (newamount != changedamount) { hideCalculated(); }
} 
```

您需要添加：

```
var newamount = ???; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:23:23.537

尝试更换

```
newamount=parseFloat(name);
if (isNaN(newamount)) {
    newamount=changedamount;
} 
```

和

```
isNaN(newamount) ? changedamount : parseFloat(newamount); 
```

`NaN`这使得它在执行之前检查`parseFloat`哪个 IE 可能存在问题。

# php - Magento: What are the empty EAV setup classes for?

> ID：11635104
> 
> 赞同：4
> 
> 时间：2012-07-24T16:17:48.310
> 
> 标签：php, magento

There are lots of descendants of `Mage_Eav_Model_Entity_Setup` for example

```
class Mage_Checkout_Model_Resource_Setup extends Mage_Eav_Model_Entity_Setup
{
} 
```

But all of them are empty.

What is the use of having all these empty classes?

Is it just for the sake of extensibiliy and to keep common functions that are shared in different setup scripts of the same module?

I was thinking there might be some kind of module autodetection triggered by these custom classes, but could not find any hints into this direction).

(Based on Magento Certification Study Guide: What are the advantages of using a custom setup class for manipulating EAV attributes in a custom module).

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T17:09:08.770

First, you need to understand that Magento organizes it's code into modules. The idea behind a module is to both help and **force** a developer to write their code in such a way that their code doesn't interfere with other system code.

Second, when a module needs to create persistant data in the Magento database, you create a [setup resource](http://alanstorm.com/magento_setup_resources) (self-link). A setup resource is an installer script that has access to special functions/methods via its parent class. These special functions/methods help the developer create and populate tables in the database for their data structures. Many of these methods can be found on the `Mage_Eav_Model_Entity_Setup` class.

When a developer creates a setup resource for their own module, **they create a new class**. By creating a new class they ensure that any special methods their setup resources need will have a place to live. The `Mage_Checkout_Model_Resource_Setup` class is the `Mage_Checkout` module's setup resource class. It just so happens that this module didn't need extra methods. Earlier versions of Magento **forced** (at least, I believe they did) module developers to create their own setup resource classes if they wanted to use the setup resource feature. This was done because, as mentioned in paragraph one, Magento's module system is there to help ensure code from Module A doesn't interfere with Module B.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T16:51:26.877

In order to understand the logic, you'll have to give [Alan Storm's tutorials](http://alanstorm.com/category/magento) a read. Maybe you should read them in the proper order, but you can also jump straight to [this one](http://alanstorm.com/magento_advanced_orm_entity_attribute_value_part_1). They definitely helped me understand what's going on a few years ago.

# javascript - 阻止第三方 cookie - 解决方法（Facebook 应用程序等）

> ID：11635105
> 
> 赞同：19
> 
> 时间：2012-07-24T16:17:50.103
> 
> 标签：javascript, facebook, actionscript-3, safari, local-shared-object

Mac 上的 Safari默认`Block cookies`设置为`From third parties and advertisers`。

如果嵌入的 swf 来自不同的域，它会阻止 SharedObject 工作。

这个问题并不新鲜： [Safari 3rd 方 cookie iframe 技巧不再起作用？](https://stackoverflow.com/questions/9930671/safari-3rd-party-cookie-iframe-trick-no-longer-working)

**有没有人找到解决方案（除了在每个请求中通过 GET/POST 参数传递会话 ID）？**

注意：我无法访问嵌入 swf 的站点，因此无法更改该 HTML 或放置任何 JavaScript 等。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-25T02:23:03.823

```
function setCookie(){
   if ( navigator.userAgent.indexOf('Safari') != -1 &&
        navigator.userAgent.indexOf('Chrome') == -1 ){
      window.open('safari.php','','width=200,height=100' );
   }
}

// then we set the cookie in safari.php 
```

资料来源：[http ://www.reizbombardement.de/archives/safari-5-1-4-enforces-cookie-policy](http://www.reizbombardement.de/archives/safari-5-1-4-enforces-cookie-policy)

**//更新 2013 年 7 月 23 日**

这种解决此问题的糟糕方法在 Safari 6 之前一直有效。

请参阅下面的@Fabio Antunes 和@ncubica 评论。

**//更新 2013 年 7 月 23 日，作者 Fabio Antunes**

这是我的代码

在登陆页面上，我们将有一个关于应用程序的简短描述和一个按钮，上面写着“进入”之类的内容。我正在使用 jquery 来简化此过程，为单击事件创建一个侦听器，我将只放置 javascript 代码，因为我假设您已经拥有着陆页的其余 html 代码：

```
$(document).on("click", "#bt-landing", function(){
var left = (screen.width/2)-(500/2);
            var top = (screen.height/2)-(250/2);
            window.open('URL_FOR_THE_PHP_THAT_WILL_CREATE_THE_SESSION', '_blank', 'width=500,height=250,toolbar=0,location=0,menubar=0, top='+top+', left='+left);
}); 
```

这将打开一个小窗口，大小为 500 x 250 像素，以屏幕为中心。

我的小窗口代码是这样的：

```
<?php setcookie("safari_cookie", "1");?>
    <html>
        <head>
            <meta charset="utf-8">
            <title>THE NAME OF YOUR APP OR SOMETHING THAT THE USER WE'LL READ AND ASSUME THAT THIS SMALL WINDOW IS RELIABLE</title>
        </head>
        <body>
        <script type="text/javascript">
        $(document).ready(function(){
           setTimeout(function(){window.close()},1000);
        })
        </script>
        </body>
    </html 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-07-16T15:35:02.210

Safari*仍然会阻止来自顶部窗口中它没有访问过的域的 cookie*。

为了解决这个问题，我们在 PHP 中计算 ($_COOKIES) 并将浏览器定向到我们域上的一个页面，该页面的工作是将浏览器简单地发送回它的来源。这是一个肮脏的把戏，这意味着一些用户会不必要地离开然后又回来，但是，网络上充满了肮脏的把戏。

如果您无法设置`top.location.href`需要设置 cookie 的域上的页面，或者您无法更改所述域上的页面，那么我可以自信地说您需要使用基于 URL 的会话。

但是，另一种选择（仍然需要能够在域上创建页面）是请求用户单击您的 SWF，然后您可以触发`window.open`并使 URL 指向您创建的页面。它所需要做的就是加载成功，然后用户（甚至弹出页面本身的JS）可以关闭弹出窗口。然后，您可以设置 cookie。

* * *

我开发了 Facebook 应用程序，这些应用程序存在于 iframe 中，遇到了这个问题。每个应用程序都必须附带此修复程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T16:29:08.690

根据最近的经验，我可以说这不是 Mac 上的 Safari 的问题，我也从未经历过它的问题。

您提到该设置阻止来自第三方的 cookie：SharedObject 存储永远不会来自第三方，它来自您正在访问的站点（第一方？）。所以我认为这永远不会成为问题。

使用 Flash Player 设置面板，用户可以禁用`SharedObject`（或限制存储空间量）。所以一般来说，你的应用程序应该处理`SharedObject`不可用的情况。

但是，我认为大多数用户都没有意识到`SharedObject`他们可以禁用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-22T20:41:59.217

您可能需要使用跨域策略文件才能使 swf 正常工作。

[http://kb2.adobe.com/cps/142/tn_14213.html](http://kb2.adobe.com/cps/142/tn_14213.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-10T21:26:31.977

我已经以这种方式解决了，但最好使用 HTML5 localstorage 并使 web 服务变得安静，因为在 server2 中保存会话变量会使您的应用程序无法很好地扩展。这是我用来解决第 3 方 cookie 问题的代码。基本上 server1 的客人首先去 server2 以获取“硬币：D”，然后他突然回到 server1。这样，server2 的会话变量在所有导航中都是可用的。www.yourserver.com/index.html 页面

```
<script src="js/jquery.cookie.js" type="text/javascript"></script>
<script src="js/mobile-detect.js" type="text/javascript"></script>
<script>
var md = new MobileDetect(window.navigator.userAgent);
if (md.userAgent()=='Safari') {
    var firstsafariuser = $.cookie('safari-user');
    if (firstsafariuser != 'true') {
        $.cookie('safari-user', true);
        location.href='http://www.yourserver2.com/coin.php?frompage='
        +location.href.replace(location.hash,"")+'&hashtags='+location.hash.substr(1);
    }
}
</script> 
```

www.yourserver2.com/coin.php

```
<?php
session_start(); 
if (isset($_GET["frompage"])&&$_GET["frompage"]!=null){
    $url=$_GET["frompage"];
} else {
    $url='http://www.yourserver.com';
}
if (isset($_GET["hashtags"])&&$_GET["hashtags"]!=null){
    $hash='#'.$_GET["hashtags"];
} else {
    $hash='';
}
header('Location:'.$url.$hash);
?> 
```

PS window.open 被视为一种弹出窗口，因此您可能会遇到广告拦截器或浏览器设置的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-29T04:14:10.023

只是为 safari.xxx 页面添加一个没有 setTimeout 和/或 jquery 的更简洁的方式。适用于最新的 ios (8.1.2)，我知道 8.1.0 存在窗口/选项卡无法关闭的错误。

这是代码：

```
<%
request.getSession(true); //or anyway to set the cookie depending on your language (jsp here)
%>

<script type="text/javascript">
    window.addEventListener("load", window.close);
</script> 
```

在我的情况下，弹出窗口不是问题，因为它是由用户单击启动的。

# ruby-on-rails - 预编译整个目录结构

> ID：11635111
> 
> 赞同：0
> 
> 时间：2012-07-24T16:18:11.693
> 
> 标签：ruby-on-rails, asset-pipeline

我有一个高度嵌套的目录结构，其中包含我的 /app/assets/templates 目录中的 Handlebars 模板。

投入生产时，我希望这些是预编译资产，但其中可能有数百个，我无法手动将这些文件中的每一个添加到`config.assets.precompile`列表中。

有没有办法指定要预编译的整个目录结构？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:29:31.853

尝试：

`config.assets.precompile += %w(templates/*.js etc/*.css)`

### 编辑

我也很好奇如果只是做 `config.assets.precompile += %w(templates/*)`会工作。

# matlab - matlab可以实时通讯吗？

> ID：11635112
> 
> 赞同：0
> 
> 时间：2012-07-24T16:18:13.893
> 
> 标签：matlab, real-time, steganography, serial-communication, audio-processing

我正在使用 dsk TMSC6713 进行音频隐写术。我想使用 dsk 实时将消息发送到 PC，然后使用 matlab 实时在发送方和接收方 PC 之间进行所有处理和串行通信，并在解码器 dsk 套件上收听发送的消息。有可能吗？请提供任何可能的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T15:40:15.293

原则上，（几乎）不可能使用消费类 PC 系统进行实时控制。

进程调度依赖于很多事情，以至于执行程序的时间是不确定的。如果你想做实时的任何事情（通信、控制……），你应该选择一个微控制器，你可以控制每个周期并确保硬时间限制。如果您需要，正如 Mark 所说的，“非常快速的通信”，您可以在 PC 上完成（如果您没有在后台运行战地 2000000），甚至可以使用 matlab。这在很大程度上取决于您所需的带宽。我已经使用 Matlab 对 50Hz 的 RC 直升机进行了自动控制。

# oracle - 为什么 Oracle odbc 驱动程序没有为整数和数字类型提供 TYPE_NAME？

> ID：11635113
> 
> 赞同：1
> 
> 时间：2012-07-24T16:18:22.740
> 
> 标签：oracle, odbc, oracle11g, unixodbc

我正在尝试使用 odbc 动态创建一个表，我需要获取正确的类型字符串以在 create table 语句中使用。但是，似乎无法从 Oracle 驱动程序 (oracle-instantclient11.2-odbc-11.2.0.1.0-1.x86_64) 中获取任何 TYPE_NAME 字符串。使用以下类型调用 SQLGetTypeInfo(hStmt, sqlType) 总是返回一个空记录：

SQL_NUMERIC、SQL_INTEGER、SQL_BIGINT

我分别期待 NUMERIC、NUMERIC(10,0) 和 NUMERIC(19,0)。或 NUMBER 替换[http://docs.oracle.com/cd/B28359_01/server.111/b28318/datatype.htm#i16209](http://docs.oracle.com/cd/B28359_01/server.111/b28318/datatype.htm#i16209)中列出的数字：NUMBER(p,s)

相反，SQL_ALL_TYPES 列表显示根本不支持 NUMBER，而是有一个未记录的（对于上述链接）DECIMAL 类型。

知道为什么会出现这种行为以及如何在无需检查驱动程序连接 DBMS 名称的情况下获取正确的字符串吗？

PS：SQL_ALL_TYPES 返回：BLOB、LONG RAW、BFILE、RAW、CLOB、LONG、CHAR、DECIMAL、BINARY_FLOAT、BINARY_DOUBLE、DOUBLE PRECISION、DATE、VARCHAR2、NCHAR、NVARCHAR2、NCLOB

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T08:20:14.027

Oracle 存储数值数据类型如下

NUMERIC：SQL_DECIMAL=3 大小 38,0
NUMERIC(10,0)：SQL_DECIMAL=3 大小 10, 0
NUMERIC(19,0)：SQL_DECIMAL=3 大小 19, 0

最后一位数字是比例，例如：-

NUMERIC(12,3) : SQL_DECIMAL=3 大小 12, 3

[Easysoft](http://www.easysoft.com/products/data_access/odbc_oracle_driver/index.html)等商业驱动程序确实支持 ODBC 中所需的数据类型：-

```
Full Connect(Default)

Env. Attr. SQL_ATTR_ODBC_VERSION set to SQL_OV_ODBC3

Successfully connected to DSN 'ESOracle32'.
SQLGetTypeInfo:
                In:             StatementHandle = 0x00DD7C58, DataType = SQL_INTEGER=4
                Return: SQL_SUCCESS=0

Get Data All:
"TYPE_NAME", "DATA_TYPE", "COLUMN_SIZE", "LITERAL_PREFIX", "LITERAL_SUFFIX", "CREATE_PARAMS", "NULLABLE", "CASE_SENSITIVE", "SEARCHABLE", "UNSIGNED_ATTRIBUTE", "FIXED_PREC_SCALE", "AUTO_UNIQUE_VALUE", "LOCAL_TYPE_NAME", "MINIMUM_SCALE", "MAXIMUM_SCALE", "SQL_DATA_TYPE", "SQL_DATETIME_SUB", "NUM_PREC_RADIX", "INTERVAL_PRECISION"
"INTEGER", 4, 9, <Null>, <Null>, <Null>, 1, 0, 3, 0, 0, 0, "NUMBER(9)", <Null>, <Null>, 6, <Null>, 10, <Null>
1 row fetched from 19 columns.

SQLGetTypeInfo:
                In:             StatementHandle = 0x00DD7C58, DataType = SQL_NUMERIC=2
                Return: SQL_SUCCESS=0

Get Data All:
"TYPE_NAME", "DATA_TYPE", "COLUMN_SIZE", "LITERAL_PREFIX", "LITERAL_SUFFIX", "CREATE_PARAMS", "NULLABLE", "CASE_SENSITIVE", "SEARCHABLE", "UNSIGNED_ATTRIBUTE", "FIXED_PREC_SCALE", "AUTO_UNIQUE_VALUE", "LOCAL_TYPE_NAME", "MINIMUM_SCALE", "MAXIMUM_SCALE", "SQL_DATA_TYPE", "SQL_DATETIME_SUB", "NUM_PREC_RADIX", "INTERVAL_PRECISION"
"NUMBER", 2, 38, <Null>, <Null>, "precision,scale", 1, 0, 3, 0, 0, 0, "NUMBER", <Null>, <Null>, 2, <Null>, 10, <Null>
1 row fetched from 19 columns. 
```

# jquery - 表单提交后无法清除输入值

> ID：11635116
> 
> 赞同：0
> 
> 时间：2012-07-24T16:18:32.397
> 
> 标签：jquery, forms

好的，我已经尝试了我能找到的每一个建议，但是在提交表单和淡出之后，这些值仍然存在。如果有人有建议...

```
<script type="text/javascript">

$(document).ready(function() { 
    $('#form1').ajaxForm( { beforeSubmit: validate } ); 

function validate(formData, jqForm, options) { 
    var name = $('input[name=name]').fieldValue(); 
    var email = $('input[name=email]').fieldValue(); 
    var message = $('textarea[name=message]').fieldValue(); 

if (!name[0]) { 
alert('Please enter a value for name'); 
return false; 
}  
if (!email[0]) { 
alert('Please enter a value for email'); 
return false; 
}  
if (!message[0]) { 
alert('Please enter a value for message'); 
return false; 
}
}
var name = $('input[name=name]').val(''); 
var email = $('input[name=email]').val('');
var message = $('textarea[name=message]').html(''); 

$("#form1").ajaxForm(function(){
        $("#formplic").fadeOut(1000, function() {
             $(this).html("<img src='images/postauto2.png'/>").fadeIn(2000);
        });
    });
});
</script> 
```

我已经添加了建议，但它仍然无法正常工作。也许我没有把它们放在正确的地方......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:21:48.217

**编辑**：为什么它不起作用通读你的脚本。您添加的建议（我的代码）只是全局范围内的常规语句 - 当浏览器加载文件时

1.  设置文档就绪方法
2.  实现函数validate
3.  **执行 set-value-to-blank**
4.  设置 ajaxForm 值

我假设您想在表单经过验证（并继续）后重置表单。

在这种情况下，您希望在表单完成后运行重置代码。那是什么时候？这里：`$("#form1").ajaxForm(function(){...`

其他人实际上已经给了您确切的代码（我相信），但我真的认为这是您对计算机和 javascript 以及语言如何执行的理解的问题。您真的应该做更多的功课并尝试遵循脚本的逻辑。简单的调试工具，例如`alert("I'm resetting the values now!")`会告诉您代码何时执行（无论它是否在正确的位置）

* * *

在您的代码中，它实际上没有尝试清除文本。这些将是告诉浏览器重置/删除内容的一些说明。我猜您只想在正确时才清除它，以便将其添加到`.ajaxForm` 回调中

```
var name = $('input[name=name]').val(''); //inputs are like this <input value="Hi">
var email = $('input[name=email]').val('');
var message = $('textarea[name=message]').html(''); //textareas are like this <textarea>Hi</textarea> 
```

顺便说一句，fadeOut 只会让它“淡出”，它最终会隐藏块（css display: none；我猜），但不会改变 DOM 元素/表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:23:44.020

提交值时尝试将输入值设置为空白。

例如，var name = $('input[name=name]').val(' ');

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:28:38.540

使用 .val() 函数清除 text 的值，使用 html() 函数清除文本 此外，如果你给每个输入一个 ID，在 jQuery 中操作会更容易。

例如，创建一个这样的表单：

```
<form method="post" id="frmMessage" action="some_script.php">
<input type="text" name="name" id="txtName" />
<input type="text" name="email" id="txtEmail" />
<textarea name="message" id="txtMessage"></textarea>
</form> 
```

然后在你的 jQuery 代码中：

```
$("#frmMessage").ajaxForm( function()
{
    // Do whatever else you need to do first...
    // Fade out the form's container

    $("#txtName").val('');   // Clear the value of each box.
    $("#txtEmail").val('');  
    $("#txtMessage").html('');   // Different for textareas!

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-20T13:49:12.040

```
$("#form")[0].reset(); 
```

这可能会有所帮助

# javascript - 用 flick 翻页 html 页面

> ID：11635117
> 
> 赞同：0
> 
> 时间：2012-07-24T16:18:38.637
> 
> 标签：javascript, android, mobile

假设我有一个页面列表。用户可以使用“上一个”和“下一个”超链​​接导航它。但是在 android 应用程序中有更符合人体工程学的方法来做到这一点。您只需向左或向右滑动即可查看下一页。有没有用javascript实现这个效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:44:03.233

在 Android 中，此实现是[Viewpager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)。这是一个javascript 实现的[链接](http://www.netcu.de/jquery-touchwipe-iphone-ipad-library)，它在我的 Android 网络浏览器上运行，详细说明了您想要的左右滑动。

# php - 从 PHP 脚本更改 Linux 用户密码

> ID：11635124
> 
> 赞同：6
> 
> 时间：2012-07-24T16:19:12.147
> 
> 标签：php, passwords, sudo, pam

我有一个“简单”的问题：如何在 PHP 脚本中安全地更改用户密码，而不授予 Apache root 权限或引入其他疯狂的安全漏洞？

背景：CentOS 6、Apache 2.2.13、PHP 5.3.3

我知道 pam_chpasswd() 命令，它是 PECL PAM 库的一部分。但是，除非主机进程 (httpd) 具有对 /etc/shadow 文件的读取权限，否则此功能会失败。（坏主意！如果它需要如此高的权限，不知道这个库有什么帮助......）

就我所见，理想的情况是让 PHP 使用 'sudo -u[username of user changed his password]' 调用 shell 脚本，这将运行脚本“AS”用户，所以他应该有权更改自己的密码。并且 sudo 将要求用户发送他现有的密码以便进行身份验证，从而防止一个用户更改另一个用户的密码。

但这由于某种原因不起作用......当使用 popen 打开进程时，该进程永远不会执行。我设置了 shell 脚本以将一些文本转储到 /tmp 中的一个可公开写入的文件中。但它永远不会到那个地步。

```
$cmd = "/usr/bin/sudo -S -u$username /file_to_execute.sh";
$handle = popen ($cmd, "w");   // Open the process for writing
fwrite ($handle, "$current_password\n");  // Send the user's current password to sudo (-S option)
fwrite  .... (write the username, current password, and new password, so the script can change it)
$result = pclose($handle); 
```

如果我访问这个 php 脚本（http://server/script.php），该函数立即失败，并且 $result = 1

如果我修改 sudoers 文件 (visudo) 并添加一行：
`$`Defaults:apache !requiretty

脚本冻结大约 10 秒，然后失败 ($result = 1)

任何这样做的建议都非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:34:33.637

为了在考虑到安全性的情况下实现上述目标，我建议使用`expect`Apche 用户或将其添加到对所述文件具有写入权限且仅对所述文件具有写入权限的组中。

使用expect，您需要包含您的`sudo`密码，因为它会侦听来自操作系统的响应`Password:`，并且当看到时，它会自动回复`sudo`密码。这将允许您`shell_exec()`与家人合作`expect`以实现您的成果。

为了安全，我会采用第二条路线，它将使用组权限来写入仅对该文件具有写入权限的组的文件。

例子：

```
groupadd secure_apache
usermod -G secure_apache apache_user
chown owner:secure_apache /tmp/file_to_change
chmod 740 /tmp/file_to_change 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:26:57.623

一种更安全的方法是将用户名和密码存储在一个特殊目录中的文件中，然后让 cron 完成这项工作（每分钟一次）

# jquery - 在jQuery中将绑定转换为委托

> ID：11635126
> 
> 赞同：2
> 
> 时间：2012-07-24T16:19:33.677
> 
> 标签：jquery

我想将绑定函数转换为委托**，但我想更改以便在初始页面加载后添加到页面的新元素上触发事件。**我怎样才能改变它？

我想更改此代码

```
$(".user").bind("mouseenter", fnShowUserHover); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:21:46.500

```
$(document).delegate(".user", "mouseenter", fnShowUserHover); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:20:29.700

使用 on()：

```
$("body").on("mouseenter", ".user", fnShowUserHover); 
```

（而不仅仅是为元素`body`选择一个共同的父级）`.user`

与[委托](http://api.jquery.com/delegate/)你可以专门写

```
$("body").delegate(".user", "mouseover", fnShowUserHover); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T16:21:42.893

如果您使用 .on() 委托

```
$('parentelement').on('mouseenter','.user',fnShowUserHover); 
```

或 .delegate()

```
$('parentelement').delegate('.user','mouseenter',fnShowUserHover); 
```

# r - 将多个字段的值聚合为一个

> ID：11635134
> 
> 赞同：1
> 
> 时间：2012-07-24T16:19:58.670
> 
> 标签：r, dataframe, aggregation

我在 R 中有以下数据框：

```
objects   categories
   A       162
   B       162
   B       190
   C       123
   C       162
   C       185
   C       190
   C        82
   C       191
   D       185 
```

如您所见，存在对象及其所属的类别。我想在逗号分隔列表中总结每个对象的类别，以获得如下所示的数据框：

```
 objects   categories
   A       162
   B       162, 190
   C       123, 162, 185, 190, 82, 191
   D       185 
```

我怎么能这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:25:02.253

```
aggregate(categories~objects,data=x,FUN=paste)
  objects                  categories
1       A                         162
2       B                    162, 190
3       C 123, 162, 185, 190, 82, 191
4       D                         185 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T16:24:36.327

这可以使用您选择的任何聚合工具来完成，我将展示一个使用`plyr`包和`paste()`函数的示例。这假设您的数据名为`x`：

```
library(plyr)
ddply(x, .(objects), summarize, categories = paste(categories, collapse = ","))
#-----
  objects             categories
1       A                    162
2       B                162,190
3       C 123,162,185,190,82,191
4       D                    185 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T16:25:08.073

正如你的问题的标题所暗示的，使用`aggregate`：

```
aggregate(list(categories=df$categories), by=list(objects=df$objects), c)
#   objects                  categories
# 1       A                         162
# 2       B                    162, 190
# 3       C 123, 162, 185, 190, 82, 191
# 4       D                         185 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T16:30:03.540

**如果**是您`DF`的数据框，请尝试以下操作：

```
aggregate(categories ~ objects, DF, function(x) toString(unique(x))) 
```

**sqldf**使用 sqldf 可以：

```
library(sqldf)
sqldf("select objects, group_concat(distinct categories) as categories
  from DF group by objects") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-10T04:55:00.673

一个`data.table`解决方案

```
library(data.table)
DT <- as.data.table(DF)
DT[,list(categories = list(categories)), by = objects]

##    objects             categories
## 1:       A                    162
## 2:       B                162,190
## 3:       C 123,162,185,190,82,191
## 4:       D                    185 
```

# c# - 确保多个线程之间的执行顺序

> ID：11635136
> 
> 赞同：1
> 
> 时间：2012-07-24T16:20:05.813
> 
> 标签：c#, multithreading, deadlock, race-condition

我遇到了一个烦人的问题，主要是因为我在 C# 多线程方面的技能水平/经验低。

这是背景。 在我的框架中`WaitFormHelper`，我有一个`Start()`静态类名为a （这是一个带有自定义消息和进度条的小型加载控件）`Close()``Start()``locker``WaitForm`

在我当前的项目中，我有一个方法，它启动 a `WaitForm`，执行计算，然后关闭`WaitForm`. 一点都不花哨。方法如下，我尽量简化了：

```
public void PerformCalculations()
{
   try
   {
      WaitFormHelper.Start("Title", "message", false);
      if (this.CalculationsParameters.IsInvalid)
      {
         return;
      }
      // Perform all those lengthy calculations here
   } 
   // catch whatever exception I may have to catch, we don't care here
   finally
   {
      WaitFormHelper.Close();
   }
} 
```

以下是具有相关方法和属性的`Start()`and方法，也简化了：`Close()`

```
private static Thread instanceCaller;
private static WaitForm instance;

private static AutoResetEvent waitFormStarted = new AutoResetEvent(false);
private static object locker = new object();

/// <summary>
/// Initializes WaitForm to start a single task
/// </summary>
/// <param name="header">WaitForm header</param>
/// <param name="message">Message displayed</param>
/// <param name="showProgressBar">True if we want a progress bar, else false</param>
public static void Start(string header, string message, bool showProgressBar)
{
    InitializeCallerThread(showProgressBar, header, message);
    instanceCaller.Start();
}

/// <summary>
/// Initializes caller thread for executing a single command
/// </summary>
/// <param name="showProgressBar"></param>
/// <param name="header"></param>
/// <param name="message"></param>
private static void InitializeCallerThread(bool showProgressBar, string header, string message)
{
    waitFormStarted.Reset();

    instanceCaller = new Thread(() =>
    {
        lock (locker)
        {
            instance = new WaitForm()
            {
                Header = header,
                Message = message,
                IsProgressBarVisible = showProgressBar
            };
            waitFormStarted.Set();
        }
        instance.ShowDialog();
    });
    instanceCaller.Name = "WaitForm thread";
    instanceCaller.SetApartmentState(ApartmentState.STA);
    instanceCaller.IsBackground = true;
}

/// <summary>
/// Closes current form
/// </summary>
public static void Close()
{
    lock (locker)
    {
        if (instance != null && !instance.IsClosed)
        {
            waitFormStarted.WaitOne();
            instance.FinalizeWork();
            instance.Dispatcher.Invoke(
                new Action(() =>
                {
                    instance.Close();
                }));
        }
    }
} 
```

**现在让我们解决问题**

这通常可以正常工作，除非在这种情况下：如果`this.CalculationsParameters.IsInvalid`为真（即您可能已经理解，由于某种原因，我无法执行计算，例如“用户在我的表单中输入废话”），执行直接关闭 my `WaitForm`. 但是在这种情况下，主线程将在方法触发的线程**之前**`Close`到达该方法并获取`locker`对象上的锁。**`Start()`**

 **发生的情况是：`Close`获取锁，尝试关闭表单但`instance`仍然为空，因为`Thread`创建的`InitializeCallerThread`仍在等待锁实际创建它。`Close`释放锁，`InitializeCallerThread`获取它并...显示一个`WaitForm`不会关闭的。

现在我知道我可以通过在实际启动 WaitForm 之前测试计算参数是否无效来简单地解决这个问题，但是问题是`WaitForm`我们框架的所有应用程序都应该使用它（其中包括 40 多个不同的应用程序使用和在 4 个国家/地区维护），因此理想情况下，我宁愿`WaitForm`在所有情况下都看到我的工作。

您对我如何同步它以确保肯定首先调用并执行启动线程有任何想法吗？如您所见，我已经`AutoResetEvent`为此使用了 an ，但是如果我在测试前听它，`if (instance != null)`我最终会陷入困境。

希望这足够清楚！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T01:55:45.743

您需要一些机制来进行“队列控制”，根据您希望它们发生的顺序协调步骤。

最近我需要实现这样的东西来强制执行单元测试中多个线程的特定顺序。

这是我的建议：

**队列同步器：**

```
/// <summary>
/// Synchronizes steps between threads.
/// </summary>
public class QueueSynchronizer
{
    /// <summary>
    /// Constructor.
    /// </summary>
    /// <param name="minWait">Minimum waiting time until the next try.</param>
    /// <param name="maxWait">Maximum waiting time until the next try.</param>
    public QueueSynchronizer(Int32 minWait, Int32 maxWait)
    {
    }

    private Mutex mx = new Mutex();
    /// <summary>
    /// Minimum waiting time until the next try.
    /// </summary>
    private Int32 minWait = 5;
    /// <summary>
    /// Maximum waiting time until the next try.
    /// </summary>
    private Int32 maxWait = 500;

    int currentStep = 1;

    /// <summary>
    /// Key: order in the queue; Value: Time to wait.
    /// </summary>
    private Dictionary<int, int> waitingTimeForNextMap = new Dictionary<int, int>();

    /// <summary>
    /// Synchronizes by the order in the queue. It starts from 1\. If is not 
    /// its turn, the thread waits for a moment, after that, it tries again, 
    /// and so on until its turn.
    /// </summary>
    /// <param name="orderInTheQueue">Order in the queue. It starts from 1.</param>
    /// <returns>The <see cref="Mutex"/>The mutex that must be released at the end of turn.
    /// </returns>
    public Mutex Sincronize(int orderInTheQueue)
    {
        do
        {
            //while it is not the turn, the thread will stay in this loop and sleeping for 100, 200, ... 1000 ms
            if (orderInTheQueue != this.currentStep)
            {
                //The next in queue will be waiting here (other threads).
                mx.WaitOne();
                mx.ReleaseMutex();

                //Prevents 100% processing while the current step does not happen
                if (!waitingTimeForNextMap.ContainsKey(orderInTheQueue))
                {
                    waitingTimeForNextMap[orderInTheQueue] = this.minWait;
                }
                Thread.Sleep(waitingTimeForNextMap[orderInTheQueue]);
                waitingTimeForNextMap[orderInTheQueue] = Math.Min(waitingTimeForNextMap[orderInTheQueue] * 2, this.maxWait);
            }
        } while (orderInTheQueue != this.currentStep);

        mx.WaitOne();
        currentStep++;
        return mx;
    }
} 
```

`Start()`并`Close()`与`QueueSynchronizer`：

```
//synchronizer
private static QueueSynchronizer queueSynchronizer;

private static Thread instanceCaller;
private static WaitForm instance;

private static AutoResetEvent waitFormStarted = new AutoResetEvent(false);
private static object locker = new object();

/// <summary>
/// Initializes WaitForm to start a single task
/// </summary>
/// <param name="header">WaitForm header</param>
/// <param name="message">Message displayed</param>
/// <param name="showProgressBar">True if we want a progress bar, else false</param>
public static void Start(string header, string message, bool showProgressBar)
{
    queueSynchronizer = new QueueSynchronizer();
    InitializeCallerThread(showProgressBar, header, message);
    instanceCaller.Start();
}

/// <summary>
/// Initializes caller thread for executing a single command
/// </summary>
/// <param name="showProgressBar"></param>
/// <param name="header"></param>
/// <param name="message"></param>
private static void InitializeCallerThread(bool showProgressBar, string header, string message)
{
    waitFormStarted.Reset();

    instanceCaller = new Thread(() =>
    {
        lock (locker)
        {
            //Queuing to run on first.
            Mutex mx = queueSynchronizer.Sincronize(1);
            try
            {
                instance = new WaitForm()
                        {
                            Header = header,
                            Message = message,
                            IsProgressBarVisible = showProgressBar
                        };
            }
            finally
            {
                //I think is here that ends the first step!?
                mx.ReleaseMutex();
            }

            waitFormStarted.Set();
        }
        instance.ShowDialog();
    });
    instanceCaller.Name = "WaitForm thread";
    instanceCaller.SetApartmentState(ApartmentState.STA);
    instanceCaller.IsBackground = true;
}

/// <summary>
/// Closes current form
/// </summary>
public static void Close()
{
    //Queuing to run on second.
    Mutex mx = queueSynchronizer.Sincronize(2);
    try
    {
        lock (locker)
        {
            if (instance != null && !instance.IsClosed)
            {
                waitFormStarted.WaitOne();
                instance.FinalizeWork();
                instance.Dispatcher.Invoke(
                    new Action(() =>
                    {
                        instance.Close();
                    }));
            }
        }
    }
    finally
    {
        mx.ReleaseMutex();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:36:12.540

您需要加入您创建的线程。通过加入线程，您将在该点阻塞，直到线程完成执行。

```
public static void Close()
{
    lock (locker)
    {
        instanceCaller.Join();

        if (instance != null && !instance.IsClosed)
        {
            waitFormStarted.WaitOne();
            instance.FinalizeWork();
            instance.Dispatcher.Invoke(
                new Action(() =>
                {
                    instance.Close();
                }));
        }
    }
} 
```**

# android - jquery mobile: $.mobile.orientationChangeEnabled = false 但不会在 android 中冻结

> ID：11635142
> 
> 赞同：0
> 
> 时间：2012-07-24T16:20:27.200
> 
> 标签：android, jquery, ruby-on-rails, mobile

我的应用程序使用 rails 和 jquery mobile。我使用警报功能查看 $.mobile.orientationChangeEnabled 设置为 false 后的值，它显示“false”但仍会更改方向。

我试过了

```
$(document).ready(function(){
     $.mobile.orientationChangeEnabled = false;  
        ........
}); 
```

和

```
$(document).bind("mobileinit", function(){
     $.mobile.orientationChangeEnabled = false;  
        ........
}); 
```

有没有一种方法，例如一个代码适合所有冻结方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-01T22:15:32.777

我认为您有一个误解：`$.mobile.orientationChangeEnabled`并不是*要*锁定页面的方向，而是与 jqm 的`orientationchange` *事件*有关-请参阅[http://api.jquerymobile.com/orientationchange/](http://api.jquerymobile.com/orientationchange/)

# symfony - 将集合表单添加到 DomCrawler

> ID：11635146
> 
> 赞同：0
> 
> 时间：2012-07-24T16:20:40.213
> 
> 标签：symfony, goutte

现在形成，当我想对表格进行功能测试时，我这样做是：

```
$crawler = $this->client->submit($form, array(
        'type[category]'  => 'foo',
        'type[administrable]'  => '1',
    )); 
```

我认为要以这种方式添加集合形式：

```
$crawler = $this->client->submit($form, array(
        'type[fields][0][length]'  => '5',
        'type[fields][0][search]'  => '1',
        'type[fields][0][required]'  => '1',
    )); 
```

但它不工作！

DomCrawler/Goutte 支持 Collection 还是有特定的处理方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T09:39:00.980

听起来这是一个开放的错误：

[https://github.com/symfony/symfony/issues/4124](https://github.com/symfony/symfony/issues/4124)

# html - 父 div，未设置高度，将高度过大几个像素以适合子 img 元素高度？为什么？

> ID：11635151
> 
> 赞同：4
> 
> 时间：2012-07-24T16:21:01.803
> 
> 标签：html, css, height, parent, image

**在所有主要浏览器**中：正如问题所述，父`<div>`容器（其高度未设置）过大其高度以适应子`<img>`元素（例如，300 像素高的图像，它是内部唯一的东西`div`）。过大的尺寸通常约为 3 到 5 个像素，最初看起来像 img`margin-bottom`或 div`padding-bottom`可能的样子。

但是，使用绝对定位，可以清楚地证明底部比底部`div`低`img`几个像素。它可能不会破坏网站的设计，但在某些情况下它是一个需要克服的障碍。**[我在这里做了一个相当详细的小提琴演示这个问题](http://jsfiddle.net/BadzT/1/)。**

*   **为什么在 Web 浏览器中采用这种标准做法？**
*   **这是为了弥补什么吗？似乎没有必要。**
*   **这是一个错误，还是一个即将过时的功能？**

> **编辑：**感谢下面的回答者/评论者，我知道原因是`<img>`默认情况下将 an 视为 `display:inline`保留元素周围空白的 CSS。将其更改为`display:block`通过消除元素周围的空格来完全解决问题。

**注意：**`float:left`可以通过为图像子元素提供or等​​ CSS 属性来避免这种尺寸过大`float:right`，但这是一种**解决方法**，因此**不是**问题的答案。这可能会出现问题的一个原因是，如果您已经`float`在 div 子图像前面分层了其他元素（Firefox、Opera、IE 不允许浮动重叠。`float`在使用 CSS`position`设置的 Chrome 和 Safari 中似乎只允许重叠）。*谢谢！*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T16:23:24.830

将 display:block 添加到您的图像中。我认为这将解决问题。

# c++ - 重载运算符的顺序

> ID：11635154
> 
> 赞同：2
> 
> 时间：2012-07-24T16:21:07.403
> 
> 标签：c++, operator-overloading

我有两个实例，我重载了 << 运算符，它始终默认为下面显示的第一个实例。有什么方法可以让自定义类 Shape 识别第二个函数？

谢谢，

约翰

第一次重载：

```
 template <class T>
    ostream & operator << (ostream & out, vector <T> & vec)
    {
      for (unsigned int i = 0;i<vec.size()-1; i++) {
        out << vec[i] << " ";
      }
      out << vec[vec.size() - 1];

      return out;
    } 
```

第二次重载：

```
 ostream & operator << (ostream & out, vector <Shape> & vec)
    {
      for (unsigned int i = 0;i<vec.size(); i++)
      {
        out << "##" << vec[i].get_shape_type << i << endl << vec[i] << endl;
      }
      return out;
    } 
```

2012 年 7 月 25 日编辑：

我添加了放在同一个文件中

```
 #ifndef _UTILS_H_
    #define _UTILS_H_
    #include <iostream>
    #include <vector>
    #include <algorithm>
    #include "Shape.H"

    using namespace std;

    template <class T>
    ostream & operator << (ostream & out, vector <T> & vec)
    {
        for (unsigned int i = 0;i<vec.size()-1; i++) {
            out << vec[i] << " ";
        }
        out << vec[vec.size() - 1];

        return out;
    }

    template <class Shape>
    ostream & operator << (ostream & out, vector <Shape> & vec)
    {
        for (unsigned int i = 0;i<vec.size(); i++)
        {
            out << "## " <<vec[i];
        }
        return out;
    }
    #endif 
```

并试图编译，我得到了这个错误

../include/utils.H:22:11：错误：重新定义'模板 std::ostream& operator<<(std::ostream&, std::vector&)' ../include/utils.H:11:11 : 错误: 'template std::ostream& operator<<(std::ostream&, std::vector&)' 之前在这里声明

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T20:14:21.503

我认为您编辑中的专业化语法是错误的。要正确执行模板特化，而不是这样：

```
template <class Shape>
ostream & operator << (ostream & out, vector <Shape> & vec) 
```

你需要：

```
template <>
ostream & operator << <Shape> (ostream & out, vector <Shape> & vec) 
```

请参阅[此参考](http://www.cplusplus.com/doc/tutorial/templates/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T06:21:36.127

您的两个函数具有相同的名称和签名。只有模板参数名称（T、SHAPE）不同。这就是为什么编译器抱怨你正在重新定义相同的函数。您需要使签名不同或添加`std::enable_if`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:03:48.277

我不是模板专业化的专家。但是，另一种解决方案是修改您的`Shape::operator<<()`以包含所有输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-28T19:34:03.260

您的“重载”基本上是具有不同命名模板参数的相同函数，因此重新声明错误。您必须使它们成为实际的重载。`Shape`版本不需要是模板，只是一个函数。此外，您可能希望通过 const 引用传递向量：

```
ostream & operator << (ostream & out, vector<Shape> const& vec)
{
    for (unsigned int i = 0;i<vec.size(); i++)
    {
        out << "## " <<vec[i];
    }
    return out;
} 
```

# java - 时钟分钟更改的 Java 事件侦听器

> ID：11635155
> 
> 赞同：4
> 
> 时间：2012-07-24T16:21:12.597
> 
> 标签：java, timer

我正在寻找 Java 中监视计算机时钟（分钟）并在每次更改时触发方法/线程的最佳方法。

因此，如果时间是 13:20 并且它更改为 13.21 则做一些事情。因此，任何时候只要有微小的变化，就会触发一些代码。

聆听时钟分钟部分的变化的最佳方式是什么？

谢谢，理查德

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T16:30:44.560

1.  使用 System.currentTimeMillis() 查找当前系统时间
2.  计算距离下一分钟还有多少毫秒
3.  在 Timer 上安排 TimerTask 以在未来的毫秒数内运行
4.  在该 TimerTask 的事件处理程序中，安排一个新的重复 TimerTask 每 60,000 毫秒运行一次。

    ```
    int milisInAMinute = 60000;
    long time = System.currentTimeMillis();

    Runnable update = new Runnable() {
        public void run() {
            // Do whatever you want to do when the minute changes
        }
    };

    Timer timer = new Timer();
    timer.schedule(new TimerTask() {
        public void run() {
            update.run();
        }
    }, time % milisInAMinute, milisInAMinute);

    // This will update for the current minute, it will be updated again in at most one minute.
    update.run(); 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T16:23:43.530

听起来像是[Quartz](http://quartz-scheduler.org)的工作。您可以使用以下 cron 表达式执行此操作：

`0 * * * * ?`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T16:24:34.350

`Date d = new Date(System.currentTimeMillis());`

然后你可以得到分钟`d.getMinutes()`。在等待值`d.getMinutes()`更改的线程中运行检查。

# c++ - 如果库 dosnt 存在于 usr/lib 下，我得到一个错误库未找到

> ID：11635158
> 
> 赞同：0
> 
> 时间：2012-07-24T16:21:14.397
> 
> 标签：c++, eclipse-cdt

我有没有放在“/usr/lib”下的第三方库。我在 Eclipse 库搜索路径中定义了它们的路径。该项目编译和链接良好，但是当我运行项目时，我遇到了找不到库的异常。如果我将第 3 方库复制到“/usr/lib”，则它运行正常。

我相信这是路径问题（我是 cpp 新手），如何在 eclipse 中配置它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:24:44.967

首先，由于它在运行时崩溃，因此您正在链接动态库（libWhatever.so），因此您必须将库路径添加到`LD_LIBRARY_PATH`环境变量中。`-static`否则，您可以使用该标志强制链接器静态链接到静态库 (libWhatever.a) 。

# python - Python：使用机械化爬取数据：字段没有名称时该怎么办？

> ID：11635159
> 
> 赞同：0
> 
> 时间：2012-07-24T16:21:15.690
> 
> 标签：python, web-crawler

尝试在 Python 中使用 mechanize 时，我被卡住了，因为我尝试提交的字段没有名称。

在机械化教程上，据说：

```
br.select_form(name="order")
# Browser passes through unknown attributes (including methods)
# to the selected HTMLForm.
br["cheeses"] = ["mozzarella", "caerphilly"]  # (the method here is __setitem__) 
```

这很好，但在我的情况下，控件没有名称。这是我运行的代码以确保：

```
resp = br.open("http://www.facebook.com/find-friends/browser/")
forms = ParseResponse(resp)
form = forms[2]  # I know I have to select form 2
for control in forms[0].controls:
    print control.name, control.type 
```

这是我得到的（部分）：

```
fb_dtsg hidden
friends_ids[] checkbox
None button
None hidden
None text
hometown_ids[] checkbox
None button
None hidden
None text
city_ids[] checkbox
None button
None hidden
None text
highschool_ids[] checkbox
None button
None hidden
None text
college_ids[] checkbox 
```

所以我被困在这里，因为我无法应用教程中的示例（我想做的是：

```
br['hometown'] = 'some town' 
```

有人有线索吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:10:45.867

我最初将此作为评论发布，但事实证明这是答案，我将其重新发布为答案（感谢@OP 提供此处引用的问题的链接）。

根据[this other SO question](https://stackoverflow.com/questions/6359817/how-do-you-select-choices-in-a-form-using-python)，您也应该能够按索引选择控件：

```
br = mechanize.Browser()
br.open('http://www.w3schools.com/html/html_forms.asp')
myControl = forms[N].controls[n] 
```

回应评论“实际上，当我可以访问我想要的控件时，这很有帮助，但它没有告诉我如何修改它 - 即 br['control'] = 'my value' 的等价物”：

```
forms[N].controls[n] = myValue 
```

[从这里](https://stackoverflow.com/questions/6359817/how-do-you-select-choices-in-a-form-using-python)复制：阅读[本教程](http://wwwsearch.sourceforge.net/mechanize/forms.html)。

基本思想是您可以通过索引获取控件并直接设置您想要的任何合法值

# c# - Selenium C# RemoteWebDriver 找不到 XPath 元素

> ID：11635160
> 
> 赞同：0
> 
> 时间：2012-07-24T16:21:20.463
> 
> 标签：c#, xpath, selenium, selenium-webdriver, invalidoperationexception

我正在使用 Selenium 2.25.1 API，并且我试图能够使用 RemoteWebDriver() 找到元素。除非我尝试，它只是找不到元素。我已经尝试了几种不同的组合，但都没有运气，并且已经查找了几天。

```
WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10));
IWebElement WaitForPage = wait.Until<IWebElement>((d) =>
{
    return driver.FindElement(By.XPath((String)data));
}); 
```

我的代码在哪里失败。基本上数据变量是从我的数据库中抓取的一个对象。我对它进行了转换，并且通过代码得到了完美的结果。区别是什么，当我只使用浏览器（即Firefox，IE）时，它工作得很好，没有错误。但是当我将它与 RemoteWebDriver() 一起使用时，它会抛出 InvalidOperationException 并抛出一个弹出窗口，说它无法找到该元素。（服务器没有提供任何堆栈跟踪信息）。

这通常是我使用的

```
IWebDriver driver = new RemoteWebDriver(new Uri("http://localhost:4444/wd/hub"), IEcapa); 
```

使用它时，它每次都会失败。

有任何想法吗？我完全不解。欢迎任何事情，并提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:15:27.213

我建议使用隐式等待而不是 WebDriverWait 语句。

```
WebDriver driver = new FirefoxDriver();
driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10));
IWebElement WaitForPage = driver.FindElement(By.XPath((String)data)); 
```

并确保您从数据变量中获取的 xpath 是有效的。如果可能，请发布您从数据库中获得的一些 xpath。

# c++ - Reinterpret_cast 与安置新

> ID：11635163
> 
> 赞同：2
> 
> 时间：2012-07-24T16:21:40.600
> 
> 标签：c++, placement-new, reinterpret-cast

通过阅读[这篇文章](https://stackoverflow.com/questions/222557/what-uses-are-there-for-placement-new)，很明显 C++ 中的放置消息用于在预分配的内存位置调用类构造函数。

在内存已经初始化的情况下，placement new 还是 reinterpret_cast 更合适？

例如，假设我从 TCP 套接字读取表示帧消息的原始字节流。我将此流放入帧同步并检索一个已知大小的缓冲区，该缓冲区代表我的类，我将其称为 Message。我知道有两种方法可以继续。

1.  创建一个带有标志的构造函数，告诉类不要初始化。在传递“不初始化”标志的缓冲区上做一个新的放置。

    ```
    Message::Message( bool initialize ) 
    {
        //
        // Initialize if requested
        //
        if( initialize )
        {
            Reset( );
        }
    }

    void Message::Reset( void )
    {
       m_member1 = 1;
       m_member2 = 2;
    }

    Message* message = new ( buffer ) Message( false ); 
    ```

2.  使用 reinterpret_cast

    ```
    Message* message = reinterpret_cast< Message* > ( buffer ); 
    ```

我相信这两者都会产生相同的结果。一个比另一个更正确、更面向对象、更安全、更易于阅读还是更好的风格？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T16:45:28.503

唯一*有意义的*规则是：

`T`如果已经在 address 构造了某种类型的实例，则获取指向已经存在的对象*的**指针*。`a``reinterpret_cast<T*>(a)`

 *如果尚未在 address 构造某种类型的实例`T`，则*使用*`a`placement new`T`在 addres构造类型的实例`a`。

它们是完全不同的操作。

你需要问的问题非常非常简单：“对象是否已经存在？” 如果是，您可以访问它（通过演员表）。如果不是，那么您需要构建它（通过放置新）

这两个操作彼此无关。

这不是你应该更喜欢哪一个的问题，因为他们做不同的事情。你应该更喜欢那个做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:38:15.477

我也不会说。

使用placement new 并具有特殊的构造方法似乎是一种技巧。一方面，标准说，例如，未初始化的 int 类成员具有“不确定值”，并且访问它“可能”导致未定义的行为。没有指定 int 将假定未修改的底层字节的值解释为 int。我不认为有任何东西可以阻止一致的实现在调用构造函数之前将内存初始化为零。

为了很好地定义 reinterpret_cast 的这种使用，您必须跳过一些障碍，即使这样使用生成的对象也可能会违反严格的别名规则。

更实际地，如果您直接通过网络发送一个类的实现指定的表示，您将依赖于具有兼容布局（兼容表示、对齐等）的通信系统。

相反，您应该进行真正的序列化和反序列化，例如使用 memcpy() 和 ntoh() 将数据从缓冲区获取到现有对象的成员中。

```
struct Message {
    uint32_t m_member1;
    uint16_t m_member2;
};

extern char *buffer;

Message m;

memcpy(&m.m_member1, buffer, sizeof m.m_member1);
m.m_member1 = ntohl(m.m_member1);
buffer += sizeof m.m_member1;

memcpy(&m.m_member2, buffer, sizeof m.m_member2);
m.m_member2 = ntohs(m.m_member2);
buffer += sizeof m.m_member2; 
```

如果您不只是使用预先存在的库，您可能希望将这些东西包装在您自己的框架中。

这样您就不必处理对齐问题，网络表示定义良好，可以在不同的实现之间传递，并且程序不使用技术上未定义的行为。*

# actionscript-3 - 搜索根容器没有找到所有文本字段？

> ID：11635169
> 
> 赞同：2
> 
> 时间：2012-07-24T16:21:56.810
> 
> 标签：actionscript-3, flash

我正在使用一个函数来更新舞台上的文本字段：

```
private function updateFields(rootContainer:DisplayObjectContainer):void
{
    for(var i=0; i < rootContainer.numChildren; i++) {
        var item:* = rootContainer.getChildAt(i);
        try {
            updateFields(item);
        } catch (e:Error) {
            trace(e.toString());
        }
        if (item.toString() == '[object TextField]') {
            trace(item.name);
        }
    }
} 
```

它找到放置在舞台上的一半文本字段。为什么是这样？让我发狂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:28:37.233

这对我有用。

```
private function updateFields(rootContainer:DisplayObjectContainer):void
{
    for (var i:uint = 0, n:uint = rootContainer.numChildren; i < n; ++i) {
        var item:DisplayObject = rootContainer.getChildAt(i);
        if (item is DisplayObjectContainer) {
            updateFields(DisplayObjectContainer(item));
        } else if (item is TextField) {
            trace(item.name);
        }
    }
} 
```

**编辑：**固定`DisplayObjectContainer`铸造

# c++ - Qt QVector - 我可以通过引用元素中的值来更改吗？

> ID：11635170
> 
> 赞同：0
> 
> 时间：2012-07-24T16:21:58.087
> 
> 标签：c++, qt

我有一个

```
QVector<structure> m_vector; 
```

该结构有许多字段，其中一些是固定维度的，其中一些是其他动态 QVectors..

我想知道我是否可以这样做：

```
m_vector[4].another_vector[9].another_vector[2].field_in_the_structure = 2; 
```

更改对整个 m_vector 是否有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:22:19.810

是的，这应该按照您预期的方式工作。

# asp.net-mvc-3 - 静态方法，非静态成员 - 数据访问层/业务层

> ID：11635171
> 
> 赞同：0
> 
> 时间：2012-07-24T16:22:11.803
> 
> 标签：asp.net-mvc-3, linq, c#-4.0, web-applications, architecture

好的，我正在创建一个 Web 应用程序。我正在使用 MVC3。我有每个视图的 ViewModel，我也有支持 viewModel 并在我的 sql 表中执行实际 CRUD 操作的数据模型，而我的 viewModel 会根据需要验证和更改数据。

这是一个问题。我一直在编码的方式是

```
 public class MyClassViewModel
 {
     public string member1{get;set;}
     public int member2{get;set;}

      public static GetAllMembers(MyClassViewModel obj, out string strErrMsg)
      {
          // code goes here, read operation
      }

      public static UpdateMyClass(MyClassViewModel obj, out string strErrMsg)
      {
           // code goes here, write operation.
      }
 } 
```

我的 ViewModel 和 DataModels 都是这样编码的，我在 HttpPost 上的控制器只是做这样的事情..

```
 MyClassViewModel.UpdateMember(obj,out strErrMsg) 
```

由于它在每个帖子上创建的 mvc 都是在强类型视图上创建的，这是我的 ViewModel 的一个新对象，因此非静态成员是不同的，并且不会在会话之间共享。

我正在使用 Linq，因此在我使用的 DataModel 的每个静态方法上

```
 var db = new MyApplicationDataContext() 
```

获取我的 linq 课程并进行研究。这解决了我的打开/关闭阅读器问题。

我的问题是，这种设计的并发性有什么问题吗？我知道如果不是通过接口设计的，我在更改数据层时可能会遇到问题，但我非常怀疑根据我的应用程序是否有必要这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:06:04.387

您本质上是在使用工厂设计模式。这是可以使用的模式；每个静态方法都有自己的上下文，这也没关系。你总是要担心并发；但是，LINQ to SQL 体系结构内置了并发检测，并在针对此做出并发更改时抛出 ChangeConflictException。

我还强烈建议您在每个静态方法调用结束时正确处理上下文，因为您可能会留下与数据库的打开连接，这可能会导致性能问题。

此外，您可能会遇到的另一个问题是互连数据。您不能通过引用将两个从不同上下文创建的对象链接在一起。而在 LINQ to SQL 中，没有办法显式分离对象......

# c++ - 如何实现swap()？

> ID：11635172
> 
> 赞同：17
> 
> 时间：2012-07-24T16:22:11.617
> 
> 标签：c++, swap

> **可能重复：**
> [如何为我的班级提供交换功能？](https://stackoverflow.com/questions/6380862/how-to-provide-a-swap-function-for-my-class)

每次我认为我理解它时，我都会看到一些让我非常困惑的东西。

如果你想`swap`为你自己的类提供一个实现，你会怎么做？

可能性列表是：

1.  [在命名空间内定义一个`std`（带两个参数）](https://stackoverflow.com/a/11599/541686)，它调用下面的#3
    （有人说这是正确的；有人说是非法的）

2.  在类中定义一个静态方法，使用两个参数进行交换（对我来说比 #4 更有意义，但我不明白为什么没有人这样做），它根据需要
    调用任何基类`swap`

3.  [在类中定义一个实例方法，将另一个参数与 交换](http://www.cplusplus.com/reference/stl/vector/swap/)`swap`，它根据需要调用任何基类

4.  [在类中定义一个实例方法，将*另外两个*参数传递给 swap](https://stackoverflow.com/a/2223288/541686)，同样[在这里](https://stackoverflow.com/a/2684544/541686)`swap`，它根据需要调用任何基类

5.  [在你自己的命名空间中定义一个（带两个参数）](https://stackoverflow.com/a/2223691/541686)，它调用#3

6.  别的东西

**我自己的**理解是我需要＃5和＃3，然后调用者会`swap`像这样调用`using std::swap; swap(a, b);`，但似乎没有人建议这种组合真的让我感到困惑。而且我真的完全不明白#4，因为实际上每个人都在使用*实例*成员，而实际上操作是静态的。我不知道我的理解是错误的还是我在查找时看到的一堆答案。

正确的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T16:30:28.380

根据您自己的理解，我看到的一个常见模式是提供 3 和 5。

1.  向命名空间添加一个特殊化`std::`，这是允许的，但可能并非在所有情况下都是可能的（如果您的类型是模板本身）。
2.  根本没有任何优势，并且在成员之一之外使用时强制使用类型进行限定，这意味着要`swap`在将您的类型作为成员的其他类型上实现，他们将需要限定调用 ( `void swap( other& l, other& r ) { T::swap( l.t, r.t ); }`)
3.  不需要友谊，允许与`rvalue`s 一起使用（即使在 C++03 中），并且在某些情况下习惯于`std::vector<int>().swap( v );`清除向量的内容。
4.  什么？你误解了代码！这不是声明一个接受两个参数的成员，而是一个接受两个参数的自由函数，并内联定义函数。这相当于 5（没有转发到 3，而是在 free 函数中实现所有内容）。
5.  同一命名空间中的自由函数允许 ADL 找到它，并允许其他代码使用通用模式，`void swap( other& l, other& r ) { using std::swap; swap( l.t, r.t ); }`而不必知道类型是否`other::t`具有特定的`swap`重载或`std::`需要使用的重载。转发到 3 允许您提供可以通过 ADL 以及临时对象使用的单个（实际）实现。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T20:52:41.253

C++11 标准规定，如果和是有效表达式，则对象`t`可与对象*交换，*这些表达式选择从包含两个模板的重载集中调用的非成员函数以及由 Argument Dependent Lookup 找到的任何重载，这样的值并被交换。`u``swap(t, u)``swap(u, t)``swap``std::swap``<utility>``t``u`

在上述条件下交换两个对象的常规方法是：

```
using std::swap;
swap(t, u); 
```

这里名称查找将考虑ADL 找到的`std::swap`任何重载`swap`，然后重载解析将选择最佳匹配。

考虑您的每个实现：

1.  将重载添加到 namespace 是不合法的`std`，并且上面的规则并不要求无论如何都要找到它们。`std::swap`如果特化是针对用户定义的类型（即不是标准库类型或基本类型），则特化标准函数模板是合法的。如果你`std::swap`特化它是有效的，否则不是，你不能部分特化函数模板.

2.  将找不到静态成员函数，`swap(t, u)`因为它需要限定，例如`Foo::swap(t, u)`

3.  一元`swap`成员函数不能被称为`swap(t, u)`，它必须被称为`t.swap(u)`

4.  您提供的链接显示了一个*非成员* `friend`函数，ADL 可以找到该函数，因此可用于使类型可交换。

5.  ADL可以找到这样的功能。

所以 2 和 3 不会使类型可交换。4个，5个。如果正确完成，1 可能会这样做，但不能用于交换类模板。

3 不是必需的，但可用于帮助实现 4 或 5，因为成员函数将有权访问类型的内部详细信息，因此可以交换私有成员。对于 4，该功能是朋友，因此已经可以访问。因此，通过消除过程，您需要*4 或*3*和*5。通常认为最好提供成员交换 (3)，然后在调用成员交换的同一命名空间 (5) 中提供非成员函数。

 ** * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-24T16:30:05.660

正如您所说，您需要 #5（与您的类型在同一命名空间中的函数）来支持惯用的`using std::swap; swap(a,b);`. 这样，您的重载将通过依赖于参数的查找优先于`std::swap`.

如果您的实现`swap`需要访问类型的私有，那么您将需要调用像 #3 这样的成员函数，或者声明非成员函数 a `friend`。这就是您在#4 中的示例所做的：`friend`可以在类中声明和定义函数，但这*不会*使其成为成员；它仍然在周围的命名空间内。

所以这：

```
class thing {
    friend void swap(thing & a, thing & b) {/*whatever*/}
}; 
```

相当于这个（或多或少 - 见评论）：

```
class thing {
    friend void swap(thing & a, thing & b);
};

inline void swap(thing & a, thing & b) {/*whatever*/} 
```

＃1（专门`std::swap`针对您的类型）是允许的，但有些人会认为将所有内容保存在您自己的命名空间中会更干净。

#2 和 #3 都不允许不合格`swap(a,b)`的人找到您的实现。*

# iphone - 如何在 iPhone 上的 VoiceOver 中退出编辑模式？

> ID：11635175
> 
> 赞同：1
> 
> 时间：2012-07-24T16:22:18.373
> 
> 标签：iphone, accessibility, screen-readers, voiceover

输入可编辑文本字段并完成输入后，我需要在 VoiceOver 中使用什么手势退出编辑模式？我可以通过选择“取消”或“完成”按钮来执行此操作，但是否有退出编辑模式并移至下一个控件的手势？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:54:01.280

点击完成按钮，或者向左或向右滑动。如果您滑动，您需要确保您在键盘上方滑动，否则您只会循环浏览所有可用键。

# ruby - 正则表达式可以实现吗

> ID：11635176
> 
> 赞同：1
> 
> 时间：2012-07-24T16:22:22.100
> 
> 标签：ruby, regex, regex-negation

我太有野心了，或者有没有办法做到这一点

`to add a string` **如果不在场？**

和

`remove a the same string` **如果在场？**

使用 Regex 执行所有这些操作并避免使用 if else 语句

这里有一个例子

我有字符串

`"admin,artist,location_manager,event_manager"`

因此可以根据上述条件添加或删除子字符串**location_manager**

基本上我希望**避免使用 if else 语句**，并在正则表达式中清楚地完成所有这些

`"admin,artist,location_manager,event_manager".test(/some_regex/)`

如果存在， some_regex 将从字符串中删除**location_manager**否则它将添加它

我是否过于雄心勃勃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:25:42.187

正则表达式实际上不会以我知道的任何语言添加或删除任何内容。它只是用来匹配。您必须使用其他语言构造（例如基于正则表达式的替换函数）来实现此功能。提及您的特定语言以便从这些用户那里获得帮助可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:47:18.313

您将需要使用某种逻辑。

```
str += ',location_manager' unless str.gsub!(/location_manager,/,'') 
```

我假设如果它不存在，你将它附加到字符串的末尾

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:34:28.293

这是一种现成的解决方案。它不使用正则表达式，但也不使用任何 if/else 语句。它比生产价值更学术。

假设：您的字符串是以逗号分隔的标题列表，并且这些是唯一的集合（没有重复），并且该顺序无关紧要：

```
titles = Set.new(str.split(','))
#=> #<Set: {"admin", "artist", "location_manager", "event_manager"}> 
titles_to_toggle = ["location_manager"]
#=> ["location_manager"]

titles ^= titles_to_toggle
#=> #<Set: {"admin", "artist", "event_manager"}>
titles ^= titles_to_toggle
#=> #<Set: {"location_manager", "admin", "artist", "event_manager"}>

titles.to_a.join(",")
#=> "location_manager,admin,artist,event_manager" 
```

所有这些都假设您使用字符串作为一种集合。如果是这样，您可能应该只使用一组。如果不是，并且您实际上需要字符串操作函数来对其进行操作，那么除了使用 if-else 或变体（例如三元运算符 or`unless`或 Bergi 的答案）之外，可能没有其他办法

同样值得注意的是，正则表达式是一种解决方案：确保您考虑了边缘情况。如果 'location_manager' 在字符串的中间，你会删除多余的逗号吗？如果逗号位于字符串的开头或结尾，您会正确处理它吗？添加逗号时您会正确添加逗号吗？由于这些原因，将集合视为集合或数组而不是字符串更有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T16:25:54.373

删除与模式匹配的内容非常简单：

```
(admin,?|artist,?|location_manager,?|event_manager,?) 
```

然后选择要替换匹配的字符串 - 在你的情况下是一个空字符串 - 并将所有内容传递给 replace 方法。

您建议的其他操作仅使用正则表达式更难实现。也许有人知道更好的答案

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T18:15:14.417

不可以。正则表达式只能匹配/测试“字符串”是否存在（或不存在）。然后，您使用的函数可以根据该结果执行某些操作，例如`replace`可以删除匹配项。

然而，你想做两个动作（每一个都可以用正则表达式完成），如果存在则删除，如果不存在则添加。您不能按顺序执行它们，因为它们重叠 - 您需要执行其中一个或另一个。这就是 if-else 结构（或三元运算符）发挥作用的地方，如果没有包含它们的库/本机函数来完成这项工作，则需要它们。我怀疑Ruby中有一个。

如果你想避免 if-else-statement（用于单行或表达式），你可以使用三元运算符。或者，您可以[使用](https://stackoverflow.com/questions/2082457/ruby-gsub-problem-when-using-backreference-and-hashes)返回正确值的 labda 表达式：

```
# kind of pseudo code
string.replace(/location,?|$/, function($0) return $0 ? "" : ",location" ) 
```

这匹配字符串“ `location`”（带有可选逗号）或字符串结尾，如果找到匹配项，则将其替换为空，否则将替换为字符串“ `,location`”。我相信您可以将其调整为 Ruby。

# php - Javascript XMLHttpRequest 结果不会存储在变量中以供其他用途

> ID：11635177
> 
> 赞同：1
> 
> 时间：2012-07-24T16:22:22.943
> 
> 标签：php, javascript, function, variables, global-variables

我正在提交一个表单，但需要我的表单首先运行一些检查，所以我调用了一些需要运行 XMLHttpRequest 以查看是否在另一个 PHP 脚本上设置了某些内容的 javascript。我可以取回值，但只在我得到响应的区域内输出消息，任何将其放入变量并在其他地方使用的尝试都不起作用，这是我的脚本：

```
function validateform() {

var complete = "Please fill in the following fields:";
var temp;

if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {

    temp=xmlhttp.responseText;
     alert(temp);
    }
  }

xmlhttp.open("GET","hrp/recaptcha/verify.php",true);
xmlhttp.send();

alert(temp); 
```

第一个“alert（temp”）被输出，但代码末尾的那个总是说未定义，所以我不能在外面使用它。

有任何想法吗？感谢：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:32:50.843

看来您不想要异步调用，在这种情况下，您需要执行以下操作：

```
xmlhttp.open("GET","hrp/recaptcha/verify.php",false); 
```

您还可以删除块：

```
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    { 
```

# intellij-idea - IntelliJ 意图不起作用

> ID：11635181
> 
> 赞同：1
> 
> 时间：2012-07-24T16:22:30.947
> 
> 标签：intellij-idea

我打算用 StringBuilder 启用替换字符串，并且意图电源包插件就在那里。IntelliJ 检查并告诉我 String 应该是 StringBuilder，但它不会触发意图。我是否缺少启用意图的设置？（我期待着启动和重构我的代码的意图）

# javascript - 将 xpathResult.snapshotItem 存储在局部变量中？

> ID：11635184
> 
> 赞同：2
> 
> 时间：2012-07-24T16:22:45.860
> 
> 标签：javascript, xpath

我正在尝试为 xml 创建一个跨浏览器界面，特别是使用 XPath 表达式来选择节点。

IE 很简单：

```
this.documentElement.selectNodes(xPathStr); 
```

返回一个对象，该对象提供类似数组的访问（`results[i]`或`results(i)`）。

然而，Firefox/chrome 并不那么容易。

```
this.xpathEvaluator.evaluate(xPathStr, this.documentElement, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null); 
```

返回一个 XPathResult，可以使用`results.snapshotItem(i)`.

我试着做

```
var items = results.snapshotItem; 
```

但是当我尝试使用它时，这给了我一个错误（“对 WrappedNative 原型对象的非法操作”）。

关于如何将其缓存为类似数组的变量的任何想法，或者我是否坚持手动创建数组然后返回它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T02:40:10.517

我相信您需要将结果切换到节点：

```
 var item = nodes.snapshotItem[i]; 
```

我正在做一个类似的项目（有不同的问题），但这对我有用。但是，我猜你可以这样做：

```
 var items = nodes.snapshotItem; 
```

然后调用 items[i]。不过，我还没有测试过。

# c++ - 如何在 C++ 中提取格式化文本？

> ID：11635187
> 
> 赞同：1
> 
> 时间：2012-07-24T16:22:59.557
> 
> 标签：c++, text, formatted

这可能以前出现过，但我不明白如何提取格式化数据。下面是我提取文本文件中字符串“[87]”和“[90]”之间所有文本的代码。

显然，[87] 和 [90] 的位置与输出中指示的位置相同。

```
void ExtractWebContent::filterContent(){
    string str, str1;
    string positionOfCurrency1 = "[87]";
    string positionOfCurrency2 = "[90]";
    size_t positionOfText1, positionOfText2;
    ifstream reading;
    reading.open("file_Currency.txt");
    while (!reading.eof()){ 
        getline (reading, str);

        positionOfText1 = str.find(positionOfCurrency1);
        positionOfText2 = str.find(positionOfCurrency2);
        cout << "positionOfCurrency1 " << positionOfText1 << endl;
        cout << "positionOfCurrency2 " << positionOfText2 << endl;

        //str1= str.substr (positionOfText);
        cout << "String" << str1 << endl;
    }

    reading.close(); 
```

货币文件的更新：

[79]更多 »由于对欧元区经济的担忧，布伦特原油跌至102美元

市场数据

```
 * Currencies 
```

标题：货币

```
 Name      Price    Change % Chg
   [80]USD/SGD
              1.2606     -0.00  -0.13%

                                       USD/SGD [81]USDSGD=X
   [82]EUR/SGD
              1.5242     0.00   +0.11%

                                       EUR/SGD [83]EURSGD=X 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T00:00:53.063

这实际上取决于“提取数据的含义”。在简单的情况下，您可以将[文件读入字符串](https://stackoverflow.com/questions/2602013/read-whole-ascii-file-into-c-stdstring)，然后使用[字符串](http://en.cppreference.com/w/cpp/string/basic_string)成员函数（尤其是`find`and `substr`）来提取您感兴趣的段。如果您对每行数据感兴趣，[getline](http://en.cppreference.com/w/cpp/string/basic_string/getline)是行提取的方法。像以前一样应用`find`以`substr`获取细分。

有时一个简单的方法`find`不会让你走得更远，你需要一个[正则表达式](http://www.boost.org/doc/libs/1_50_0/libs/regex/doc/html/index.html)来轻松找到你感兴趣的部分。

简单的解析器通常会不断发展，甚至很快就会过时`regular expressions`。这通常标志着 C++ 解析[Boost.Spirit](http://www.boost.org/doc/libs/1_50_0/libs/spirit/doc/html/index.html)的巨大锤子的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T00:06:13.577

[Boost.Tokenizer](http://www.boost.org/doc/libs/1_49_0/libs/tokenizer/)有助于解析字符串，但如果这些分隔符必须像你有它们一样用括号括起来，它会变得有点棘手。使用所描述的分隔符，正则表达式可能就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T00:01:34.943

所做的只是连接读取的输出和字符串“[1]”和“[2]”。我猜这段代码是由使用`scanf`. `scanf`（以及 C 的其余部分）仍然在 C++ 中工作，所以如果这对你有用，我会使用它。

也就是说，您可以在不同的复杂程度下做到这一点。使用正则表达式是最强大/最灵活的方法之一，但它可能有点矫枉过正。我认为最快的方法就是执行以下操作：

*   查找子字符串“[1]”的索引，`i1`
*   查找子字符串“[2]”的索引，`i2`
*   获取 和 之间`i1+3`的子字符串`i2`。

在代码中，假设`std::string line`有文本：

```
size_t i1 = line.find("[1]");
size_t i2 = line.find("[2]");
std::string out(line.substr(i1+3, i2)); 
```

警告：没有错误检查。

# android - 将可编辑（从 EditText）转换为字节数组

> ID：11635191
> 
> 赞同：0
> 
> 时间：2012-07-24T16:23:11.430
> 
> 标签：android

我正在尝试获取 EditText 框的值并将其转换为字节数组以用于 nfc 写入。基本上，我希望能够仅从 EditText 框写入 NFC 标签。我试过简单的东西，比如 .toString() 和 UTF-8 编码，但我的问题似乎是从 Editable 获取字符串值。有人在这里有经验吗？

编辑：这里的相关代码：

```
EditText msgInput = (EditText) findViewById(R.id.editText1);

    ...

String msg = msgInput.getText().toString();
Log.i(TAG, "msg: " + msg);

byte[] bytes = msg.getBytes();
Log.i(TAG, "bytes: " + bytes);

messagePayload = bytes; 
```

我在编辑文本中输入“东西”（不带引号），然后尝试编写。这给出了两个 logcat 输出：

```
 msg: stuff
    bytes: [B@412e9e80 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:41:11.717

大概，

```
editBox.getText().toString().getBytes() 
```

# linux - mediatemple 上的内存使用率增加了 105%

> ID：11635192
> 
> 赞同：1
> 
> 时间：2012-07-24T16:23:14.393
> 
> 标签：linux, memory-leaks, dedicated-server

三小时前，服务器内存使用率从 60% 左右飙升至 105%。我正在使用具有 512mb RAM 的专用 MediaTemple 服务器。我应该担心吗？为什么会发生这样的事情？

任何帮助将不胜感激。

```
Tasks:  38 total,   2 running,  36 sleeping,   0 stopped,   0 zombie
Cpu(s):  0.0%us,  0.0%sy,  0.0%ni,100.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st
Mem:    946344k total,   550344k used,   396000k free,        0k buffers
Swap:        0k total,        0k used,        0k free,        0k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
    1 root      15   0 10364  740  620 S  0.0  0.1   0:38.54 init
 3212 root      18   0 96620 4068 3200 R  0.0  0.4   0:00.21 sshd
 3214 root      15   0 12080 1728 1316 S  0.0  0.2   0:00.05 bash
 3267 apache    15   0  412m  43m 4396 S  0.0  4.7   0:03.88 httpd
 3290 apache    15   0  412m  43m 4340 S  0.0  4.7   0:02.98 httpd
 3348 root      15   0  114m  52m 2112 S  0.0  5.6   0:48.94 spamd
 3349 popuser   15   0  114m  50m  972 S  0.0  5.5   0:00.06 spamd
 3455 sw-cp-se  18   0 60116 3216 1408 S  0.0  0.3   0:00.12 sw-cp-serverd
 3525 admin     18   0 81572 4604 2912 S  0.0  0.5   0:01.74 in.proftpd
 3585 apache    18   0  379m  15m 3356 S  0.0  1.7   0:00.01 httpd
 3589 root      15   0 12624 1224  956 R  0.0  0.1   0:00.00 top
 7397 root      15   0 21660  944  712 S  0.0  0.1   0:00.58 xinetd
 9500 named     16   0  301m 5284 1968 S  0.0  0.6   0:00.43 named
 9575 root      15  -4 12632  680  356 S  0.0  0.1   0:00.00 udevd
 9788 root      25   0 13184  608  472 S  0.0  0.1   0:00.00 couriertcpd
 9790 root      25   0  3672  380  312 S  0.0  0.0   0:00.00 courierlogger
 9798 root      25   0 13184  608  472 S  0.0  0.1   0:00.00 couriertcpd 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:47:04.153

首先通过相同的 top 命令分析占用大量 CPU 的进程。如果进程是多线程程序，请使用以下 top 命令：

> top -H -p "那个进程的pid"

它将帮助您找到占用大量 CPU 的线程以进行进一步诊断。

# eclipse - 无法发布到服务器。雄猫 7.0

> ID：11635195
> 
> 赞同：6
> 
> 时间：2012-07-24T16:23:21.943
> 
> 标签：eclipse, tomcat

尝试在 Tomcat 7.0.28 服务器上部署 war 文件时出现以下错误。我的 Eclipse 是面向 Web Developers 的 Eclipse Java EE IDE。版本：Indigo Service Release 2 Build id：20120216-1857。如果有人可以提供解决方案/修复，我会很感激？它与eclipse版本或tomcat兼容性有关吗？谢谢。

```
java.lang.NullPointerException
    at java.io.FileInputStream.<init>(Unknown Source)
    at org.eclipse.wst.server.core.util.PublishHelper.copyFile(PublishHelper.java:501)
    at org.eclipse.wst.server.core.util.PublishHelper.publishDelta(PublishHelper.java:435)
    at org.eclipse.wst.server.core.util.PublishHelper.publishDelta(PublishHelper.java:459)
    at org.eclipse.wst.server.core.util.PublishHelper.publishDelta(PublishHelper.java:459)
    at org.eclipse.jst.server.tomcat.core.internal.PublishOperation2.publishDir(PublishOperation2.java:141)
    at org.eclipse.jst.server.tomcat.core.internal.PublishOperation2.execute(PublishOperation2.java:82)
    at org.eclipse.wst.server.core.model.ServerBehaviourDelegate.performTasks(ServerBehaviourDelegate.java:1290)
    at org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publish(ServerBehaviourDelegate.java:933)
    at org.eclipse.wst.server.core.model.ServerBehaviourDelegate.publish(ServerBehaviourDelegate.java:774)
    at org.eclipse.wst.server.core.internal.Server.publishImpl(Server.java:3087)
    at org.eclipse.wst.server.core.internal.Server$PublishJob.run(Server.java:345)
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)

eclipse.buildId=M20120208-0800
java.version=1.6.0_32
java.vendor=Sun Microsystems Inc.
BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_US
Framework arguments:  -product org.eclipse.epp.package.jee.product
Command-line arguments:  -os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.jee.product 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-07-17T05:51:59.960

如果您使用 Eclipse 或 Myeclipse IDE，请清理所有项目，如 Project --> Clean --> Clean all projects --> Ok。现在它工作正常

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-02T19:09:15.550

按照这个线程引导我找到一个解决方案[http://www.eclipse.org/forums/index.php/m/526327/](http://www.eclipse.org/forums/index.php/m/526327/)

您的应用程序的部署配置文件似乎不正确。

发生在我身上的是，如果我修改了我的服务器选项并取消选中“服务模块而不发布”，服务器将启动。用它检查我得到了你提到的错误。

对我来说，问题是eclipse找不到我的web.xml。我的解决方案是我必须转到我的项目设置并删除并添加对部署程序集下我的 webapp 文件夹的引用。这为我的部署描述的位置打开了一个对话框。在 Eclipse 重新启动后，一切都井井有条。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-13T14:04:42.600

似乎是一个错误。这是解决方法；

添加新服务器时，请勿向服务器添加任何 Web 应用程序。只需添加一个没有 Web 模块的服务器。添加服务器后，右键单击服务器并“添加和删除”。现在应该可以了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-13T12:17:43.087

我遇到了同样的问题。只需单独删除服务器。将新服务器和项目添加到服务器中。清理 tomcat 工作目录。然后启动服务器它会正常工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-19T00:15:04.460

Eclipse Neon 2 (4.6.2) 和 Tomcat 8.5 也有同样的问题。解决方法正在工作。添加服务器，但不要向其添加应用程序。然后运行应用程序“在服务器上运行”，它将开始工作。还需要说我删除了所有 Maven 存储库并重新启动了 Eclipse。重新启动后，Maven 下载了所有依赖项。我不喜欢删除存储库，但它似乎也是故障排除的重要部分。

# c# - 我可以将 WPF 控件绑定到字段的属性吗？

> ID：11635199
> 
> 赞同：6
> 
> 时间：2012-07-24T16:23:25.627
> 
> 标签：c#, wpf, binding, wpf-controls

因为我需要在类之间拆分一些功能，所以我遇到了以下情况

xml代码

```
<CheckBox IsChecked="{Binding MyObjectField.MyBoolean}"  /> 
```

查看模型

```
...
public MyInternalObject MyObjectField;
... 
```

MyObject 类

```
public class MyInternalObject {
    ...
    public bool MyBoolean { get; set; }
    ...
} 
```

除非我在 View Model 类中复制 MyBoolean 属性，否则它不起作用。

```
public bool MyBoolean 
{ 
    get { return MyInternalObject.MyBoolean; }
    set { MyInternalObject.MyBoolean=value; }
} 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T16:39:57.270

您还不能（[在 WPF 4.5 版中，您可以绑定到静态属性](http://msdn.microsoft.com/en-us/library/bb613588%28v=vs.110%29#static_properties)）。但是您可以在 App.xaml.cs 中创建您的属性

```
public partial class App : Application
{
    public bool MyBoolean { get; set; }
} 
```

并从各处绑定。

```
<CheckBox IsChecked="{Binding MyBoolean, Source={x:Static Application.Current}}"> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T16:26:11.207

不，你不能。因为绑定系统使用反射来查找

> DataContext 中的属性（即您的虚拟机）

它不寻找字段。我希望这将有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-13T17:47:41.610

我没有将元素绑定到字段的属性，而是将元素的 DataContext 更改为所需的字段。

```
 protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);
        MainWindowView mainWindowView = new MainWindowView();
        var mainWindowViewModel = new MainWindowViewModel();
        mainWindowView.DataContext = mainWindowViewModel;
        mainWindowView.pagerView.DataContext = mainWindowViewModel.pager;
        mainWindowView.Show();
    } 
```

在此示例中，我在其下方有一个 DataGrid 和 Pager（第一页、上一页、下一页、最后一页）。MainWindowView 的元素（包括 DataGrid）绑定到 MainWindowViewModel 中的属性，但分页器按钮绑定到 mainWindowViewModel.pager 的属性。

主窗口视图：

```
 <DataGrid Name="dgSimple" ItemsSource="{Binding DisplayedUsers}" MaxWidth="200" Grid.Row="0" SelectedItem="{Binding SelectedRow}"></DataGrid>
    <view:PagerView x:Name="pagerView" Grid.Row="2"/> 
```

寻呼机视图：

```
<UserControl x:Class="wpf_scroll.View.PagerView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:local="clr-namespace:wpf_scroll.View"
         mc:Ignorable="d" 
         d:DesignHeight="30" d:DesignWidth="350">
<StackPanel Orientation="Horizontal" Grid.Row="1">
    <Label Content="Page size:"/>
    <TextBox Text="{Binding PageSize}" Width="30" VerticalContentAlignment="Center"
                 HorizontalContentAlignment="Center"></TextBox>
    <Button Content="First" Command="{Binding FirstPageCommand}"></Button> 
```

# c# - 如何检查两个属性或它们都不存在于配置元素中？

> ID：11635200
> 
> 赞同：1
> 
> 时间：2012-07-24T16:23:26.843
> 
> 标签：c#, .net, c#-4.0, configurationelement

有没有办法写一些`ConfigurationValidatorAttribute`或以其他方式允许两者`Prop1`都`Prop2`存在或都不存在？

**已编辑**

在下面的配置文件中，当我尝试获取时，`Domains`我想获取**运行时**异常，因为`domain3`元素必须同时具有`Prop1`或`Prop2`不具有它们，但不能仅具有其中一个！

就像`IsRequired`在运行时检查并在元素没有`Name`属性时抛出错误一样。

```
<MySection>
        <Domains>
          <Domain Name="domain1" Prop1="1" Prop2="4" /> 
          <Domain Name="domain2" /> 
          <Domain Name="domain3" Prop1="1" /> 
        </Domains>         
    </MySection>

public class ConfigElement : ConfigurationElement
{     
    [ConfigurationProperty("Name", IsRequired = true)]
    public string Name
    {
        get { return (string)this["Name"]; }
        set { this["Name"] = value; }
    }        

    [ConfigurationProperty("Prop1")]
    public int Prop1
    {
        get { return (int)this["Prop1"]; }
        set { this["Prop1"] = value; }
    }

    [ConfigurationProperty("Prop2")]
    public int Prop2
    {
        get { return (int)this["Prop2"]; }
        set { this["Prop2"] = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T08:24:00.170

在你的类中覆盖[ConfigurationElement的](http://msdn.microsoft.com/en-us/library/kyx77cz3)[PostDeserialize](http://msdn.microsoft.com/en-us/library/system.configuration.configurationelement.postdeserialize.aspx)`ConfigElement`

```
 protected override void PostDeserialize()
        {
            base.PostDeserialize();
            //Do what you want
        } 
```

[这篇博文](http://blog.rjcox.co.uk/2010/05/23/custom-configuration-3/)中有一个很好的例子。

# javascript - sharepoint 2010 - 获取附件名称的 jquery 代码

> ID：11635203
> 
> 赞同：0
> 
> 时间：2012-07-24T16:23:41.303
> 
> 标签：javascript, jquery, sharepoint

在链接列表的 sharepoint 2010 新表单中，我创建了一个内容编辑器 webpart 并将此 jquery 代码放入以获取附件文档的文件名（如果用户附加了一个）。

本质上，我正在尝试将链接列表转换为文档库，以利用其项目排序功能。

这是我在新 form.aspx 页面中使用的代码：

```
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>

<script type="text/javascript">
    $('.ms-ButtonHeightWidth').eq(2).mousedown( function ( event ) {
        var my_array = $(".ms-vb");
        for (var i=0; i<my_array.length; i++) {
            text = $(my_array[i]).html();
            text = text.substring(1, text.length);
            text = text.substring(text.indexOf(">")+1, text.indexOf("<"));
            filename = text.substr(text.lastIndexOf("\\")+1);
            document.getElementById('ctl00_m_g_0440ff9f_32fb_44b5_8b6d_a9055bcb9806_ctl00_ctl05_ctl03_ctl00_ctl00_ctl04_ctl00_ctl00_TextField_inplacerte').innerHTML = filename;
        }
    });
</script> 
```

它基本上在保存按钮上放置了一个鼠标按下事件，将列字段值更改为附件文件名。它的鼠标向下，因为它需要在保存功能发生之前发生。在此之后，将发生工作流并将此列字段值更改为文档的超链接。

我想知道上面的代码是否没有缺陷。我的意思是它可以安全使用并且永远不会损坏吗？目前它对我有用。

编辑：（这是新表单中保存按钮的代码）

```
<input name="ctl00$m$g_0440ff9f_32fb_44b5_8b6d_a9055bcb9806$ctl00$toolBarTbl$RightRptControls$ctl00$ctl00$diidIOSaveItem" class="ms-ButtonHeightWidth" id="ctl00_m_g_0440ff9f_32fb_44b5_8b6d_a9055bcb9806_ctl00_toolBarTbl_RightRptControls_ctl00_ctl00_diidIOSaveItem" accessKey="O" onclick="if (!PreSaveItem()) return false;WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$m$g_0440ff9f_32fb_44b5_8b6d_a9055bcb9806$ctl00$toolBarTbl$RightRptControls$ctl00$ctl00$diidIOSaveItem", "", true, "", "", false, true))" type="button" target="_self" jQuery17203303955991604388="1" value="Save"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:54:23.093

我可以看到它可能有问题，因为在保存功能发生之前没有完成。如果可能，请尝试使用 an 覆盖按钮的默认提交处理程序，`event.preventDefault();`然后在您的代码完成后调用默认提交函数。

编辑：可能有效的代码：

```
$('.ms-ButtonHeightWidth').eq(2).click( function ( event ) {
    // Stop default save function
    event.preventDefault();

    // Add in filename of attachment
    var my_array = $(".ms-vb");
    for (var i=0; i<my_array.length; i++) {
        text = $(my_array[i]).html();
        text = text.substring(1, text.length);
        text = text.substring(text.indexOf(">")+1, text.indexOf("<"));
        filename = text.substr(text.lastIndexOf("\\")+1);
        document.getElementById('ctl00_m_g_0440ff9f_32fb_44b5_8b6d_a9055bcb9806_ctl00_ctl05_ctl03_ctl00_ctl00_ctl04_ctl00_ctl00_TextField_inplacerte').innerHTML = filename;
    }

    // Run default save function
    if (PreSaveItem()) {
        WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$m$g_0440ff9f_32fb_44b5_8b6d_a9055bcb9806$ctl00$toolBarTbl$RightRptControls$ctl00$ctl00$diidIOSaveItem", "", true, "", "", false, true));
    }
}); 
```

# xmlstarlet - xmlstarlet 格式

> ID：11635206
> 
> 赞同：3
> 
> 时间：2012-07-24T16:23:44.257
> 
> 标签：xmlstarlet

我正在尝试使用 xmlstarlet 格式化 xml 文件，但我不想创建新的 xml 文件。

我试过这个

```
xmlstarlet fo --inplace --indent-tab --omit-decl project_00.xml 
```

但是（格式）命令`--inplace`不允许使用该参数。`fo`

有谁知道我是怎么做到的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T10:38:30.707

fo 子命令始终写入标准输出，因此您必须修补 xmlstarlet。

除此以外

```
TMP_XML=$(mktemp)
xmlstarlet fo --indent-tab --omit-decl project_00.xml > "$TMP_XML"
mv "$TMP_XML" project_00.xml 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-03-17T06:55:45.327

你可以用这一个班轮

```
xmlstarlet ed -L -O  project_00.xml 
```

参考 [http://xmlstar.sourceforge.net/doc/UG/xmlstarlet-ug.html#idm47077139594320](http://xmlstar.sourceforge.net/doc/UG/xmlstarlet-ug.html#idm47077139594320)

# security - 如何防止托管服务提供商访问敏感数据？

> ID：11635209
> 
> 赞同：3
> 
> 时间：2012-07-24T16:23:45.217
> 
> 标签：security, hosting, dedicated-hosting

场景：我们的专用服务器由托管服务提供商托管。他们正在运行 Web 应用程序、控制台应用程序以及 Sql Server Express 版本的数据库。

应用程序加密/解密进出数据库的数据。我们还将密钥存储在他们的服务器中。所以理论上，托管服务提供商可以访问我们的密钥并解密我们的数据。

问题：我们如何防止托管服务提供商访问我们的数据？

* * *

1.  我们不希望托管服务提供商的用户只登录 Sql Server 并查看数据。

2.  我们不希望盒子中有未加密的数据库文件副本。

减轻没有。1：加密 app.configs 以不存储纯文本数据库用户名和密码。

减轻没有。2：在Sql Server数据文件夹上开启EFS。我们可以使用 TDE，但 Sql Server 是 Web 版版本，并且托管公司将向我们收取使用企业版的一大笔费用。

如果你们对上述内容有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:17:48.220

您可以帮助减轻它，但预防可能是不可能的。

通常认为，如果攻击者可以物理访问机器，他们就拥有机器上的一切。

如果这是一个问题，您应该考虑购买服务器、虚拟服务器或使用托管中心并提供您自己的机器或完全自己托管。

当您购买服务器、虚拟服务器或托管您自己的硬件时，服务提供商在您的操作系统上没有帐户。如果您使用加密文件系统，并且仅通过 SSH (SSL/TLS) 访问您的机器，那么他们将无法轻松访问您计算机上未发送到网络的任何数据。

唯一万无一失的方法是在自己的安全位置拥有自己的硬件并将网络带到您的盒子中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:53:15.480

可以进行数据库加密，以便*客户端*进行解密（尽管如果您的索引已排序，服务器显然需要能够找出索引中事物的相对顺序）。我想不出一个链接。但是，如果客户端是 Web 应用程序，则您无能为力。

还有各种类型的同态加密，但我不确定是否有任何可以多项式缩放的东西。无论如何，开销是*巨大的*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T17:26:55.310

我很好奇您是否有理由不信任您的托管服务提供商 - 或者这只是一个场景？

如果这是您必须担心的事情，听起来您应该寻找其他提供商。IMO，保护自己免受托管合作伙伴的侵害似乎适得其反。

# encryption - 暴力破解是检测加密的唯一合理方法吗？

> ID：11635210
> 
> 赞同：1
> 
> 时间：2012-07-24T16:23:53.487
> 
> 标签：encryption, passwords, brute-force

旧版本的应用程序有一些密码以明文形式存储在其数据库中。我已经编写了一个更新版本，可以在创建新条目时对密码进行加密，但是我无法直接访问数据库来手动加密已经存在的条目。当更新上线时，它会尝试解密明文密码，然后崩溃。

除了删除所有现有数据之类的激烈操作之外，我能想到的唯一其他方法是（使用密码数据时调用的包装伪代码。）：

```
# data refers to the password data, either encrypted or plain
if data length < AES.block_size:
    # (Shorter than initialization vector, definitely not encrypted.)
    open database and replace password entry with encrypt(data)
    login(username, data)
else:
    try: # try plaintext first
        login(username, data)
    except AuthenticationError:
        login(username, decrypt(data))
    else: #plain text worked, encrypt data for future use.
        open database and replace password entry with encrypt(data) 
```

保留此代码以解决运行一次后就消失的问题似乎是一种耻辱。是否有任何其他方法可以确保密码被加密并且只解密需要它的密码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:29:29.960

在这种情况下，我会执行以下操作之一，具体取决于所涉及的客户端和系统：

*   设置加密密码，删除所有现有密码，让每个人都输入新密码。我更喜欢这个，因为密码很简单，随着时间的推移可能会被看到或共享。
*   运行一次性脚本来加密系统中的每个密码。这种方式永远不会混合。
*   具有以加密方法为前缀的较新加密密码，例如“SHA1:”。您冒着有人使用与密码开头相同的文本的风险，但这不太可能。

# python - 为什么 python 的 eval 有长度限制？

> ID：11635211
> 
> 赞同：23
> 
> 时间：2012-07-24T16:23:55.520
> 
> 标签：python, segmentation-fault, eval

我并不主张这将是一个好主意，但我发现你可以通过`eval`在足够大的输入字符串上运行来使 Python 崩溃（检查 2.7 和 3.2）：

```
def kill_python(N):
    S = '+'.join((str(n) for n in xrange(N)))
    return eval(S) 
```

在我的计算机`S`上可以很好地生成，但是对于大约 的值`N>74900`，Python 将失败并显示`Segmentation fault (core dumped)`. 解释器可以处理的字符串（或解析树）的长度是否有限制？

**注意**：我*不需*要这样做，对我来说这是一个更深层次的问题，反映了我对盒子里发生的事情的无知。我想了解为什么 Python 在这里失败了，而且是灾难性的（为什么不抛出异常？）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-24T21:44:01.187

此问题是由 CPython 编译器中的堆栈溢出引起的。重现相同问题的简单方法是

```
>>> code = compile("1" + "+1" * 1000000, "", "eval")
Segmentation fault 
```

这证明段错误发生在编译阶段，而不是评估期间。（当然这也很容易用 gdb 确认。）

[旁注：对于较小的表达式，编译器无论如何都会在此处应用常量折叠，因此在代码执行期间唯一发生的事情就是加载结果：

```
>>> code = compile("1" + "+1" * 1000, "", "eval")
>>> eval(code)
1001
>>> dis.dis(code)
  1           0 LOAD_CONST            1000 (1001)
              3 RETURN_VALUE 
```

旁注结束。]

此问题是一个[已知缺陷](http://bugs.python.org/issue11383)。Python 开发人员在源代码分发[目录`Lib/test/crashers`](http://hg.python.org/cpython/file/d9a881b0d6ca/Lib/test/crashers)中收集了几种使 Python 解释器崩溃的方法。与此问题相对应的是[`Lib/test/crashers/compiler_recursion.py`](http://hg.python.org/cpython/file/d9a881b0d6ca/Lib/test/crashers/compiler_recursion.py).

# .net - 使用扩展功能实现 Do 循环

> ID：11635215
> 
> 赞同：0
> 
> 时间：2012-07-24T16:24:04.907
> 
> 标签：.net, vb.net, linq

我想知道是否可以使用扩展功能实现 Do Loop。

这是我的非工作代码：

```
 <System.Runtime.CompilerServices.Extension()> _
  Public Sub DoUntil(condition As Func(Of Boolean), action As Action)
    Do Until condition
      action()
    Loop
  End Sub 
```

所以它可以被称为：

```
 DoUntil(Function() Finished = True, Sub()
 x = x + 1
If IsPrime(x) Then
  Finished = True
) 
```

但我收到错误：“System.Func(Of Boolean)”类型的值无法转换为“Boolean”

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:11:37.107

```
 var myCollection = new List<string> {"Jeremy 1", "Jeremy 2", "Christy 1", "Tyler 1", ""};
    //using a while loop
    var counter = 0;
    var index = 0;
    var testString = myCollection[index];
    while (myCollection[index] != "")
    {
        counter++;
        index++;
    }
    Console.WriteLine("The count was: " + counter);

    //using linq
    Console.WriteLine("The count was: " + myCollection.Count(i => i != "")); 
```

实际上，第一个例子（尽管它可能很糟糕）是有缺陷的。一旦遇到错误条件，它将停止计数。linq 表达式将打印所有非空元素的计数。

现在，如果您希望它在遇到错误情况时停止计数，那么您正在谈论哨兵值。在这种情况下，循环可能是最简单的解决方案。通常，我只在使用与在数据库中相同的方式处理集合时使用 linq。当我想对“查询”结果执行即时操作时，我只通过使用 lambda 表达式来扩展它们（不正确地使用 imo 这个词）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:30:42.360

如果您只需要知道满足您条件的寄存器数量，您可以使用类似的东西（我从[VB.Net 的 101 个 LINQ 示例中](http://msdn.microsoft.com/en-us/vstudio/bb688088.aspx)获取了这个示例）

```
Public Sub Linq74()
Dim numbers() = {5, 4, 1, 3, 9, 8, 6, 7, 2, 0}

Dim oddNumbers = numbers.Count(Function(n) n Mod 2 = 1)

Console.WriteLine("There are {0} odd numbers in the list.", oddNumbers)
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T16:43:44.880

假设你已经有了这个（C#，对不起，我对 VB 不是很精通）：

```
//Table name we're looking for
var LookingFor = "Foo";
//Tablenamess returned by some function (in this case some array)
var Foos = new[] { "Bar", "Foobar", "Foo_w00t", "Foo1", "foo7", "SomeFoo", "Foo_3", "Foo4", "F00", "Foo" }; 
```

获得计数很容易：

```
//Look for "XXX[0-9]+" where XXX is the (case insensitive for demonstration purposes) tablename
Regex r = new Regex(string.Format("^{0}[0-9]*$", Regex.Escape(LookingFor)), RegexOptions.IgnoreCase);
var count = Foos.Count(x => r.IsMatch(x)); 
```

这将返回( `4`、`Foo1`和`foo7`) 。`Foo14``Foo`

# c - dup2 / dup - 为什么我需要复制文件描述符？

> ID：11635219
> 
> 赞同：92
> 
> 时间：2012-07-24T16:24:13.470
> 
> 标签：c, linux, operating-system, system-calls

我试图了解`dup2`and的用法`dup`。

从手册页：

```
DESCRIPTION

dup and dup2 create a copy of the file descriptor oldfd.
After successful return of dup or dup2, the old and new descriptors may
be used interchangeably. They share locks, file position pointers and
flags; for example, if the file position is modified by using lseek on
one of the descriptors, the position is also changed for the other.

The two descriptors do not share the close-on-exec flag, however.

dup uses the lowest-numbered unused descriptor for the new descriptor.

dup2 makes newfd be the copy of oldfd, closing newfd first if necessary.  

RETURN VALUE

dup and dup2 return the new descriptor, or -1 if an error occurred 
(in which case, errno is set appropriately). 
```

为什么我需要那个系统调用？复制文件描述符有什么用？

如果我有文件描述符，为什么要复制它？

如果您能解释并给我一个需要`dup2`/的例子，我将不胜感激`dup`。

谢谢

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-24T17:20:56.737

dup 系统调用复制一个现有的文件描述符，返回一个引用相同底层 I/O 对象的新文件描述符。

Dup 允许 shell 实现如下命令：

```
ls existing-file non-existing-file > tmp1  2>&1 
```

2>&1 告诉shell 给命令一个文件描述符2，它是描述符1 的副本。（即stderr 和stdout 指向同一个fd）。现在，在*不存在的文件上调用**ls*
的错误消息和在*现有文件上的**ls*的正确输出显示在*tmp1*文件中。

 ***下面的示例代码运行程序 wc，标准输入连接到管道的读取端。

```
int p[2];
char *argv[2];
argv[0] = "wc";
argv[1] = 0;
pipe(p);
if(fork() == 0) {
    close(STDIN); //CHILD CLOSING stdin
    dup(p[STDIN]); // copies the fd of read end of pipe into its fd i.e 0 (STDIN)
    close(p[STDIN]);
    close(p[STDOUT]);
    exec("/bin/wc", argv);
} else {
    write(p[STDOUT], "hello world\n", 12);
    close(p[STDIN]);
    close(p[STDOUT]);
} 
```

子进程将读取端复制到文件描述符 0 上，关闭 p 中的文件描述符，然后执行 wc。当 wc 从其标准输入中读取时，它从管道中读取。
这就是使用 dup 实现管道的方式，现在使用 dup 的一种用途是使用管道构建其他东西，这就是系统调用的美妙之处，您使用已经存在的工具构建一个接一个的东西，这些工具又是使用构建的其他的等等..最后，系统调用是你在内核中获得的最基本的工具

干杯:)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-07-24T17:53:09.897

复制文件描述符的另一个原因是将其与`fdopen`. `fclose`关闭传递给 的文件描述符`fdopen`，因此如果您不希望关闭原始文件描述符，则必须先复制它`dup`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-24T16:27:53.257

dup 用于能够重定向进程的输出。

例如，如果要保存进程的输出，则复制输出 (fd=1)，将复制的 fd 重定向到文件，然后 fork 并执行进程，当进程完成时，再次重定向保存 fd 到输出。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-24T19:01:43.007

dup/dup2相关的一些点请注意

dup/dup2 - 从技术上讲，目的是通过不同的句柄在**单个进程**内共享一个文件表条目。（如果我们分叉，默认情况下子进程中的描述符是重复的，并且文件表条目也是共享的）。

这意味着我们可以使用 dup/dup2 函数为一个打开的文件表条目拥有多个*可能具有不同属性的文件描述符。*

（虽然目前似乎只有 FD_CLOEXEC 标志是文件描述符的唯一属性）。

[http://www.gnu.org/software/libc/manual/html_node/Descriptor-Flags.html](http://www.gnu.org/software/libc/manual/html_node/Descriptor-Flags.html)

```
dup(fd) is equivalent to fcntl(fd, F_DUPFD, 0);

dup2(fildes, fildes2); is equivalent to 

   close(fildes2);
   fcntl(fildes, F_DUPFD, fildes2); 
```

区别是（最后一个）- 除了一些 errno 值beteen dup2 和 fcntl close 后跟 fcntl 可能会引发竞争条件，因为涉及两个函数调用。

详情可从 [http://pubs.opengroup.org/onlinepubs/009695399/functions/dup.html查看](http://pubs.opengroup.org/onlinepubs/009695399/functions/dup.html)

**使用示例**-

在 shell 中实现作业控制时的一个有趣示例，其中可以看到 dup/dup2 的使用..在下面的链接中

[http://www.gnu.org/software/libc/manual/html_node/Launching-Jobs.html#Launching-Jobs](http://www.gnu.org/software/libc/manual/html_node/Launching-Jobs.html#Launching-Jobs)***

# linux - CentOS 使用 SNMP 显示接口使用情况

> ID：11635221
> 
> 赞同：3
> 
> 时间：2012-07-24T16:24:25.627
> 
> 标签：linux, centos, snmp, redhat, cacti

我有一个 SNMP 监控框，想监控集群数据库服务器上的接口利用率。我正在尝试找出正确的 OID 来监控 - 我只需要 SNMP 来返回给定时间的总接口吞吐量。

SNMP 框已配置好并将正确绘制图表。我能找到的所有方法都在谈论设置 Catci 或 MRTG，这一切都很好，但我需要的似乎更简单，但我似乎无法找到我正在寻找的东西。SNMP 框已经配置了正确的社区名称等，所以理论上这应该是一个非常简单的。

非常感激地收到任何帮助

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T15:44:13.137

当您说“接口利用率”时，我假设您的意思是以太网接口利用率。如果这个假设是正确的，那么有几个 OID 需要调查：

*   `1.3.6.1.2.1.2.2.1.10`- [ifInOctets](http://tools.cisco.com/Support/SNMP/do/BrowseOID.do?local=en&translate=Translate&objectInput=1.3.6.1.2.1.2.2.1.10)返回接口上接收到的八位字节总数，包括帧字符。
*   `1.3.6.1.2.1.2.2.1.16`- [ifOutOctets](http://tools.cisco.com/Support/SNMP/do/BrowseOID.do?local=en&translate=Translate&objectInput=1.3.6.1.2.1.2.2.1.16)返回从接口传出的八位字节总数，包括帧字符。
*   `1.3.6.1.2.1.31.1.1.1.6`- [ifHCInOctets](http://tools.cisco.com/Support/SNMP/do/BrowseOID.do?local=en&translate=Translate&objectInput=1.3.6.1.2.1.31.1.1.1.6)返回接口上接收到的八位字节总数，包括帧字符（这是 ifInOctets 的 64 位版本）。
*   `1.3.6.1.2.1.31.1.1.1.10`- [ifHCInOctets](http://tools.cisco.com/Support/SNMP/do/BrowseOID.do?local=en&translate=Translate&objectInput=1.3.6.1.2.1.31.1.1.1.10)返回从接口传输出来的八位字节总数，包括帧字符（这是 ifOutOctets 的 64 位版本）。

每个 OID 都是表的一部分，并且将有一个关联的索引，将其链接到接口描述（例如，`eth0`或`br1`）。

这些 OID 提供了接收和传输的八位字节计数，因此它们需要一点点按摩才能达到您想要的利用率。过去，当我监控这些 OID 时，我会每隔几秒钟查询两个值，然后计算速率。

```
(QueryResult2 - QueryResult1) / (SecondsElapsed) 
```

我猜想 Cacti （我假设你正在使用它，因为你用它标记了你的问题）有一些方法可以从 SNMP 值计算速率，但是，我从来没有使用过它，所以我不肯定。

另一重要注意事项是 CentOS 包含的默认*snmpd.conf*可能没有启用这些 OID。如果您运行`snmpwalk`并`1.3.6.1.2.1.2`收到`1.3.6.1.2.1.31`空结果，请编辑`/etc/snmpd.conf`以配置 SNMP 守护程序以响应这些 OID。我不记得确切的语法，但我想添加一行，

```
view   all   included   .1 
```

将启用服务器上所有可用的 OID。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-12-23T09:08:08.267

[http://namhuy.net/908/how-to-install-iftop-bandwidth-monitoring-tool-in-rhel-centos-fedora.html](http://namhuy.net/908/how-to-install-iftop-bandwidth-monitoring-tool-in-rhel-centos-fedora.html)

要求： libpcap：模块提供了用户级的网络数据包捕获信息和统计信息。libncurses：是一个 API 编程库，使程序员能够在终端中提供基于文本的接口。gcc：GNU Compiler Collection (GCC) 是由 GNU 项目生产的支持各种编程语言的编译器系统。

通过 yum 安装 libpcap、libnurses、gcc

```
yum -y install libpcap libpcap-devel ncurses ncurses-devel gcc 
```

下载并安装 iftop

```
wget http://www.ex-parrot.com/pdw/iftop/download/iftop-0.17.tar.gz
./configure
make
make install 
```

# .net - Umbraco 虚拟节点

> ID：11635222
> 
> 赞同：4
> 
> 时间：2012-07-24T16:24:33.267
> 
> 标签：.net, virtual, umbraco, nodes

我目前有一个类似于这样的内容结构：

```
Content

- Home
  - Articles
    - Article 1
    - Article 2
  - About
  - Contact

- Users
  - User 1
    - Articles
      - Article 3
      - Article 4
  - User 2
    - Articles
      - Article 5 
```

总之，我有一个网站，其页面显示指向其下方文章的链接（1 和 2）。我想允许用户注册并添加他们自己的文章。所以我有一个注册脚本，它创建一个umbraco用户，然后在上面的Users文件夹中创建User节点，每个用户在他们下面都有一个文件夹来添加他们自己的文章。该脚本将每个用户的起始节点设置为内容树中相应的用户节点。

为了说明，用户 1 只看到：

```
- User 1
  - Articles
    - Article 3
    - Article 4 
```

属于用户的每篇文章都有一个类似“/Users/User 1/Articles/Article 3”的 url，但是，我希望能够在 Content/Articles 文件夹下创建一个虚拟节点，以便 url 为“/Articles/Article 3"。这可以做到吗？虚拟节点是正确的方法吗？

我也不喜欢用户文件夹仍然具有可导航 URL 的事实，即使它存在于内容树之外。也许有更好的方法呢？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T19:01:41.537

这可以做到（当然——它是 Umbraco）。

您可以这样做：

*   [umbracoHideTopLevelNodeFromPath](http://our.umbraco.org/wiki/reference/webconfig)设置`true`在 web.config 中，并稍微改变你的结构：

    > ```
    > Site
    >   Home
    >   AllArticles
    >     Article 1
    >     Article 2
    >   About
    >   Contact
    > Users
    >   User 1
    >     Articles
    >       Article 3
    >   User 2
    >   ... 
    > ```

*   使用*Manage hostnames* on`Site`定义站点的主机名（右键单击节点）。

*   配置从`Site`到的重定向`Home`（有一个重定向包）
*   该`Users`部分应完全超出通常可导航的节点结构，因此不可见。
*   文档类型`AllArticles`使用默认显示所有用户的所有文章的模板（按文档类型查询），当使用唯一标识文章的参数（或使用 url 重写时更漂亮）调用时，显示文章。
    *   当然，不同的用户可能会为他们的文章使用相同的名称，因此您将无法简单地使用文章的名称来识别它。

# batch-file - 如果 SYSDATE 是星期天，则在批处理文件中运行 java 代码

> ID：11635228
> 
> 赞同：0
> 
> 时间：2012-07-24T16:24:47.653
> 
> 标签：batch-file

我有一个 java 文件 TestOutput.java，我们只需要在星期天运行它。我们还有一个基于 DOS 的文件复制命令，只需要在周日运行。如何做到这一点？批处理文件有一些需要每天运行的部分，还有一些只在周日运行。

它必须在批处理文件中执行以下操作：

```
REM This part runs every day
copy E:\Data\output1.psv S:\Output\output1.psv
...
...
...
REM This part runs on Sunday only
IF (DAY of sysdate=='SUNDAY')
    java TestOutput
    copy E:\Data\output2.psv S:\Output\output2.psv
END IF 
```

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:14:59.463

此解决方案与语言环境无关。

```
set "dayOfWeek="
for /f "skip=1" %%A in ('wmic path win32_localtime get dayofweek') do if not defined dayOfWeek set "dayOfWeek=%%A"
::0=Sunday, 1=Monday,... 6=Saturday
if "%dayOfWeek%"=="0" (
  REM Sunday processing goes here
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:26:10.243

使用 Windows 任务计划程序。

![在此处输入图像描述](../Images/7dd945ed7a2aa9f8fed98981820db1b8.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:43:04.977

```
for /f %%a in ('echo %DATE%') do if %%a==Sun (
REM your code here
) 
```

# linux - 如何在 SMP linux 中获取给定 cpu 的当前任务？

> ID：11635234
> 
> 赞同：2
> 
> 时间：2012-07-24T16:25:05.737
> 
> 标签：linux, linux-kernel, smp

我正在编写一个内核模块，它试图获取给定 cpu 的当前任务，例如，

```
for_each_possible_cpu(cpu)
{
     p = curr_task(cpu);
     printk("current task on cpu %d is %d\n", cpu, p->pid);
} 
```

在我们的内核模块中，我们只能使用导出的函数符号，或者我们可以从模块中的系统映射硬编码内核函数地址然后使用它。

现在我只找到了 IA64 的 curr_task 函数，在 X86_32 的给定 cpu 上获取当前任务的方法是什么？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-12T09:37:24.550

你可以这样做：

```
struct task_struct *task;
task=per_cpu(current_task, cpu_id); 
```

这可以得到“per_cpu##current_task”，它代表指定cpu中的cur_task。这可能会满足您的要求。

# ruby - 处理 html 源 vs 浏览器 dom

> ID：11635236
> 
> 赞同：1
> 
> 时间：2012-07-24T16:25:10.160
> 
> 标签：ruby, html-parsing

我正在使用 nokogiri 在 ruby​​ 中构建一个刮板，我注意到有时通过解析源创建的 dom 和浏览器解析源时创建的 dom 是不同的。

例如，浏览器添加 tbody 标签，如果文档格式不正确或 javascript 进行运行时更改，浏览器可以修改标签。

问题是我从浏览器 dom 获得了所需的元素路径（在此阶段使用元素检查器）但是当我通过解析源在 dom 中搜索该元素时，由于这些差异，没有找到任何东西。

是否有可能获得与浏览器相同的 dom，如果可以，如何获得？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T20:57:34.127

您可以使用浏览器并从呈现的源中获取 dom。有几个驱动程序，如 selenium、webkit-headless、poltergeist 等，可以驱动无头浏览器或真正的浏览器。

所有浏览器可能会呈现不同的版本，因为没有官方标准实现，所以您需要找到最适合您的版本。

# macos - OSX - ZSH - PATH - /usr/bin 重复

> ID：11635237
> 
> 赞同：5
> 
> 时间：2012-07-24T16:25:11.063
> 
> 标签：macos, path, zsh

我需要一些帮助来理解为什么我的路径看起来像它的样子。

在 zsh 中发出 echo $PATH 返回：

```
/Library/Frameworks/Python.framework/Versions/3.2/bin:/usr/bin/:/bin:/usr/sbin:/sbin:
/usr/local/bin:/usr/X11/bin:/usr/local/go/bin:/usr/bin 
```

现在，让我们仔细看看不同的部分：

```
- /Library/Frameworks/Python.framework/Versions/3.2/bin: 
```

它来自我的 .zprofile（Python 3 安装）

```
- /usr/bin/: 
- /bin: 
- /usr/sbin:
- /sbin:
- /usr/local/bin: 
```

这些部分来自我的 /etc/paths 文件夹。

```
- /usr/X11/bin: 
```

这部分来自我的 etc/path.d 文件夹

```
- /usr/local/go/bin: 
```

这部分是在 GO 安装期间添加的。

```
- /usr/bin 
```

？？？

我查看了 -/etc/paths -.zshrc -.zprofile -.profile -/etc/profile -.zshenv。他们都没有向 PATH 采购或添加第二个 /user/bin 。

如果我不知道要编辑哪个文件，如何从 PATH 中删除第二个 /user/bin？

谢谢你。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-01-10T22:33:57.917

在 ZSH 中，删除 PATH 变量中的重复项是通过`typeset -U PATH`而不是完成`typeset -u PATH`（后者只会将内容转换为大写..）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T04:54:13.390

虽然这并没有解释第二个`/usr/bin`来自何处，但您可以`typeset -u PATH`将任何内容附加到 $PATH 的最后一个位置之后。这将删除重复的条目。

# javascript - 指定单词首字母的宽度

> ID：11635238
> 
> 赞同：1
> 
> 时间：2012-07-24T16:25:11.867
> 
> 标签：javascript, jquery, jquery-plugins

我正在尝试设置一个插件，它工作得很好，但我注意到第一个字符（First 中的 F）在页面加载时没有被分配正确的宽度。该插件允许您将鼠标悬停并更改为第二个单词，然后在鼠标移出时，更改回第一个单词&然后第一个字符的宽度是正确的。所以我试着在它第一次显示时修复它：

```
var firstltrwdraw = $('span.char1').width(); // this width is actually 39px but it keeps pulling 27
 console.log('1st Width Raw: ' + firstltrwdraw);
var firstltrwd = parseFloat(firstltrwdraw);
  console.log('1st Width: ' + firstltrwd);
  console.log('1st Type: ' + typeof firstltrwd);
$('span.char1').parent().css({'width': firstltrwd + 'px'}); 
```

这是一些典型的。html:

```
<div class="lslide_wrap">
  <a href="javascript:void(0)" ...>
    <span class="sl-wrapper" ...>
      <span class="char1 sl-w2" ...>S</span> // first letter of Second
      <span class="char1 sl-w1" ...>F</span> // first letter of First
    </span>
    <span class="sl-wrapper" ...>
     ... // second letter of each word, etc
     ...
    <span>
  </a>
</div> 
```

这是一个演示页面： http: [//www.partiproductions.com/letterslide_test/index.html](http://www.partiproductions.com/letterslide_test/index.html)

当然会感谢从 char1 获取宽度并将其分配给它的父 sl-wrapper 的一些帮助。

谢谢，比尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T22:08:39.313

不确定，但`.css('width')`会返回类似“100px”的内容并`Math.abs("100px")`给出`NaN`.

尝试使用`$('span.char1').width()`.

此外，您必须记住添加到`width`任何`margin`和`padding`值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T22:52:29.463

与填充有关 - 动态更改必须编写脚本等到动画结束然后分配填充以修复视觉宽度问题；）

# asp.net-mvc - ASP.NET MVC 3 路由始终具有查询字符串值“Area=”

> ID：11635246
> 
> 赞同：0
> 
> 时间：2012-07-24T16:26:07.900
> 
> 标签：asp.net-mvc, routing, query-string, asp.net-mvc-areas

这是我长期经历的烦恼，但现在我的客户要求我解决它。

在生成的每个路由（通过非默认路由）中，都会附加一个查询字符串值：“ `Area=`”

举个例子：

```
// RouteConfig.Register():
routes.MapRoute(
    "ProfileDetails",
    "{slug}",
    new { controller = "Profile", action = "Details" }
);

routes.MapRoute(
    "Default",
    "{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = UrlParameter.Optional } 
); 
```

要生成`BadgeController.Index`操作的 URL，将应用默认路由，结果将是`/Badge`……这就是预期的结果。

但是要生成`ProfileController.Details(someUser)`操作的 URL，将应用 ProfileDetails 路由，结果将是`/someUser?Area=`......这将起作用，但这`?Area=`是不必要且混乱的。

我的项目中没有区域。如何摆脱该`Area=`查询字符串值？这发生在我所有不是预定义默认路由的路由上，而不仅仅是本示例中的“ProfileDetails”路由。

我已经尝试`AreaRegistration.RegisterAllAreas()`从我的 Global.asax 文件中删除它，因为我认为它不是必需的。

# python - Python ConfigParser 元素转换为 CSV 参数

> ID：11635251
> 
> 赞同：1
> 
> 时间：2012-07-24T16:26:16.107
> 
> 标签：python, csv, tabs, configparser

我有一个解析 csv 文件并生成 XML 文件的脚本。我必须为解析器提供的参数之一是分隔符，在我的例子中它不是逗号而是制表符。

此信息存储在我提取的配置文件中，然后传递给 csv 解析器。

```
ident = parser.get('CSV', 'delimiter') #delimiter taken from config file 

csv.register_dialect('custom', 
                    delimiter= ident, #passed to csv parser
                    doublequote=False,
                    escapechar=None,
                    quotechar='"',
                    quoting=csv.QUOTE_MINIMAL,
                    skipinitialspace=False) 
```

但是我收到一个类型错误，说“分隔符”必须是 1 个字符的字符串。我检查了 ident 的类型，它是一个字符串，但它似乎没有将 \t 识别为选项卡。当我输入 ident = '\t' 或 delimiter = '\t' 时，它会起作用。如何从配置文件中正确获取值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-11-02T15:22:18.107

也许有点太晚了，但我有一个小解决方法：将参数设置为十六进制代码值，然后对其进行解码

```
from ConfigParser import ConfigParser
cp = ConfigParser()
cp.add_section('a')
cp.set('a', 'b', '09') #hex code for tab (please note that there is no \x
cp.write(open('foo.ini', 'w'))

from ConfigParser import ConfigParser
cp_in = ConfigParser()
cp_in.read('foo.ini')
print(repr(bytearray.fromhex(cp_in.get('a', 'b')).decode())) #where the magic happens 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-04T18:19:16.073

[使用ConfigParser](https://docs.python.org/2/library/configparser.html)似乎不可能。虽然文档没有明确提到这种情况，但他们确实说前导空格将从值中删除。

尝试往返该值后，它只返回一个空字符串：

```
from ConfigParser import ConfigParser
cp = ConfigParser()
cp.add_section('a')
cp.set('a', 'b', '\t')
cp.write(open('foo.ini', 'w'))

cp_in = ConfigParser()
cp_in.read('foo.ini')
print(repr(cp_in.get('a', 'b'))) # prints '' 
```

# javascript - 用javascript替换元素（没有jquery）

> ID：11635253
> 
> 赞同：0
> 
> 时间：2012-07-24T16:26:22.083
> 
> 标签：javascript, replace

我正在尝试创建一个具有动态值的链接

```
http://my.link/index.php?action=huh&id=X 
```

X 是我想用 javascript 变量动态替换的。我不想为此使用 jquery。

而且，我**不想替换整个 url(href)**，因为 URL 的某些部分需要由模板引擎解析。我认为如果我插入一个元素代替 X 并用 JS 替换它会更好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:32:59.117

只替换id

```
var elLink = document.getElementById("link");
elLink.href = elLink.href.replace(/id=(.*)/, function(){return "id=2"}); 
```

如果 id=X 是常数

```
elLink.href = elLink.href.replace("id=X", "id=2"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:31:26.087

你可以使用类似的东西

document.getElementById("YourAnchorId").href= document.getElementById("YourAnchorId").href + id;

或者

document.getElementById("YourAnchorId").href= document.getElementById("YourAnchorId").href +"?id" + id;

并且该 id 变量从文本框中获取它，或者您需要它。

不使用jquery的原因是什么？

# java - 有没有办法让我在不打印堆栈跟踪的情况下抛出异常？

> ID：11635254
> 
> 赞同：0
> 
> 时间：2012-07-24T16:26:30.973
> 
> 标签：java

目标是能够做到：

```
throw new RuntimeException(); 
```

没有它打印：

```
Exception in thread "main" java.util.RuntimeException
at grame.GrameManager.add(GrameManager.java:40)
at grame.GrameManager.add(GrameManager.java:47)
at grame.Entity.<init>(Entity.java:56)
at grame.Entity.<init>(Entity.java:28)
at test.Test.main(Test.java:20) 
```

（例如）。

这可能吗？如果是这样，我将如何去做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:29:00.213

您可以通过设置重定向 System.err`System.setErr(null);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T16:30:41.770

由于异常很重要，您可以使用 log4j (http://logging.apache.org/log4j/1.2/) 之类的日志记录机制，并在您不希望打印或记录某些异常时将日志记录设置为不同的级别例如，到文件而不是控制台。

如果您只是不关心异常，请捕获它并且什么都不做（空捕获，这很糟糕）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T18:46:38.163

任何抛出的异常都不会直接生成到错误控制台的堆栈跟踪。这取决于调用它的代码。在主程序的情况下：

```
public static void main(String args[]) throws Exception {
   // do something that throws an exception
} 
```

如果您没有捕获异常，我相信系统实际上会将其吐出到控制台。

在此过程中，您需要处理异常。如果在 GUI 中显示它是您想要的，那么您必须执行以下操作：

```
public interface ExceptionHandler {
     void handleException(Exception e);
}

public static void main(String args[]) {
  ExceptionHandler exceptionHandler = ...;

  try {
     // something that might throw an exception
  }
  catch (Exception e) {
     exceptionHandler.handle(e);
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T16:27:42.773

只需捕获异常，不要在 catch 块中放入任何内容。

我应该补充一点，这样做通常是一个坏主意。在找出程序中出了什么问题时，拥有该堆栈跟踪或某种消息非常有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T16:28:42.290

如果您希望该方法在不打印堆栈跟踪的情况下终止程序，请将其放在 try/catch 块中，并在 catch 下简单地使用以下语句：

```
System.exit(1) 
```

这让系统知道程序以不规则（非零）状态退出，但不会向 System.err 打印任何内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-24T16:28:25.900

你真正需要做的就是抓住它......然而，这是一个非常糟糕的主意。您可能想要创建自己的异常并抓住它。这样你就不会吞下你不应该忽略的异常。您真正应该考虑这样做的唯一时间是，如果您不能让您的应用程序崩溃。如果是这种情况，那么您至少应该记录错误。

[这](http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html)比我能更好地解释它（无论如何都是一个很好的资源）。基本上，它表明：

> “如果可以合理地预期客户可以从异常中恢复，则将其设为受检异常。如果客户无法从异常中恢复，则将其设为未受检异常”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-24T16:29:01.103

像这样：

```
try {
    some code...
} catch (RuntimeException e) {

  } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-24T16:34:13.617

**1.** `Java compiler` **只关心在编译期间你是否给了一个 catch 来尝试**，无论你是否**在 catch 中实现任何代码。**

**2.**您可以将catch块保持为**空**，或者**在控制台上打印**，**记录..等等......**

**例如：**

```
try{

    }catch(Exception ex){

  } 
```

**3.**但`printStackTrace()`打印`method name`、`class name`和**发生异常**`file name`的位置。`line number`

# actionscript-3 - 在 11.3 播放器上找不到 Flash 11.3 类

> ID：11635255
> 
> 赞同：0
> 
> 时间：2012-07-24T16:26:42.643
> 
> 标签：actionscript-3, flash

我正在尝试在我的 Flash 项目中包含以下类：

```
import flash.display.JPEGXREncoderOptions; 
```

根据[官方文档](http://help.adobe.com/en_US/FlashPlatform/beta/reference/actionscript/3/flash/display/JPEGXREncoderOptions.html)，这是从 Flash Player 11.3 开始可用的。我已经将 FDT 设置为`playerglobal.swc`从 11.3 开始使用（实际上，我可以从我的项目中的 FDT 浏览器看到 SWC 中的类）。这也编译得很好。但是，当我尝试运行输出 SWF 时出现以下运行时错误：

```
Error #1014: Class flash.display::JPEGXREncoderOptions could not be found. 
```

我已经验证了运行 .swf 的 Flash Player 确实是 11.3 - 更具体地说，`11.3.300.265`. 我使用调试播放器在 Windows 7 64 位上运行。

我在这里错过了什么吗？我需要设置其他东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:44:51.007

我猜您缺少正确的`-swf-version`编译器标志（您可以在调试配置中设置并选择正确的编译器标志单选，以便您可以根据需要编辑标志）

例如，在 Flash Player 11.4`-swf-version=17`中，所以我想对于 Flash Player 11.3，它类似于 15 或 16。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T15:03:20.013

这很容易。你有两个选择：

每个项目的 1-in 属性部分在编译器部分设置**-swf-version=16**

2-转到 flex sdk 文件夹并找到 Framework 文件夹下一个更改以下配置文件：

*   空气配置
*   弹性配置
*   空中移动配置

    单独打开配置文件并更改`<target-player>11.3</target-player>` 和`<swf-version>16</swf-version>`

我建议选择数字 2，因为对于所有项目，您不需要手动添加编译器参数

# java - java正则表达式返回false

> ID：11635257
> 
> 赞同：5
> 
> 时间：2012-07-24T16:26:54.800
> 
> 标签：java, regex

我是java正则表达式的新手。我编写了以下代码来验证非数字号码。如果我们输入任何非数字数字，它应该返回 false。对我来说，下面的代码总是返回 false。这里有什么问题？

包正则表达式；

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class NumberValidator {

    private static final String NUMBER_PATTERN = "\\d";
    Pattern pattern;

    public NumberValidator() {
        pattern = Pattern.compile(NUMBER_PATTERN);
    }

    public boolean validate(String line){
        Matcher matcher = pattern.matcher(line);
        return matcher.matches();
    }

    public static void main(String[] args) {

        NumberValidator validator = new NumberValidator();

        boolean validate = validator.validate("123");

        System.out.println("validate:: "+validate);
    }

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T16:28:59.360

来自 Java 文档：

> matches 方法尝试将整个输入序列与模式进行匹配。

您的正则表达式匹配单个数字，而不是数字。添加`+`after`\\d`以匹配一个或多个数字：

```
private static final String NUMBER_PATTERN = "\\d+"; 
```

作为旁注，您可以将模式的初始化和声明结合起来，使构造函数变得不必要：

```
Pattern pattern = Pattern.compile(NUMBER_PATTERN); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T16:31:05.893

`matches`“当且仅当整个区域序列与此匹配器的模式匹配时才返回 true。”

该字符串是 3 位数字，与 pattern 不匹配`\d`，意思是“一个数字”。

相反，您需要 pattern `\d+`，意思是“一个或多个数字”。这在字符串中表示为`"\\d+"`

# c# - 计时器需要更多时间

> ID：11635260
> 
> 赞同：1
> 
> 时间：2012-07-24T16:27:04.863
> 
> 标签：c#, timer

场景：在 Winform 应用程序（C#）中，我有一个 Datagridview，我必须在其中显示 4 个倒数计时器，格式为“mm:ss”。时间间隔必须为 1000 毫秒。

我在 system.timers.timer 的经过事件中倒计时。

在所有 4 个计时器上，我从 2 分钟（02:00）开始倒计时。

问题：到达 00:00 需要超过 2 分钟的时间（125 秒）。同样 4 分钟，需要 7-10 多（247 -250）秒才能到达 00:00

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:32:08.270

系统上的计时器有点不准确。更好的系统通常会提供更好的计时器，但即使是最好的系统也会出现滑点。

您还需要记住，您的进程不会在 100% 的时间内处于“完全控制”状态，它有时会被推到后台，并且必须与其他应用程序共享处理器，因此尽管它会尽最大努力跟踪时间。

您可能想要的是 C# 中的高精度计时器（又名秒表）。查看[这个线程](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/822aed2d-dca0-4a8e-8130-20fab69557d2)和[这篇关于选择计时器机制](http://www.mvps.org/directx/articles/selecting_timer_functions.htm)的文章以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:51:31.420

首先，您应该运行这个小测试并近乎实时地查看漂移。在 72 个计时器经过事件后，我失去了 1 秒（这几乎没有实际工作）。

```
using (var timer = new Timer(1000))
{
    var start = DateTime.Now;
    var i = 0;
    timer.Elapsed += (sender, args) => Console.WriteLine("{0} -> {1}", ++i, (DateTime.Now - start).TotalMilliseconds);
    timer.Start();
    Thread.Sleep(130*1000);
} 
```

我不确定您的应用程序需要多么精确，但您可以通过使用开始时间和现在之间的增量并从初始值中减去该增量并将计时器终止为零来获得“足够好”。 **使用这种方法您将失去几秒钟，**并且有合理的机会可能会发生失去的一秒钟@`0:00`导致`-0:01`滴答声，您需要处理。

```
var countdownSeconds = 120;
var startedAt = DateTime.Now;

var timer = new Timer(1000);    
timer.Elapsed += (sender, args) => Display(countdownSeconds - (int)((DateTime.Now - startedAt).TotalSeconds));
timer.Start();

//- be sure to dispose the timer 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:42:55.203

如果您需要该类型的时间分辨率（即实际时钟或倒计时时钟），您应该使用实时时钟。

您仍然使用具有亚秒级分辨率的计时器来足够频繁地触发以用于显示目的，但是您不会将这些时间相加，而是使用实时时钟来获取实际经过的时间 ( `DateTime.Now - startTime`)。

# java - setMaximumFractionDigits 的违规行为

> ID：11635261
> 
> 赞同：-1
> 
> 时间：2012-07-24T16:27:08.187
> 
> 标签：java

在下面的代码中，我想知道为什么会抛出异常：

```
import java.text.*;
 class NumFormat
    {
      public static void main(String[] args)throws Exception{
      String s = "123.456xyz";
      NumberFormat nf = NumberFormat.getInstance();
      System.out.println(nf.parse(s));
      nf.setMaximumFractionDigits(2);
     System.out.println(nf.format(s));
    }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:43:25.100

我认为您正在尝试对此进行测试。您不能将字符串传递给 format() 方法，它需要一个数字。

```
try {
    String s = "123.456xyz";
    NumberFormat nf = NumberFormat.getInstance();
    Number n = nf.parse(s);
    System.out.println(n);
    nf.setMaximumFractionDigits(2);
    System.out.println(nf.format(n));

}
catch (ParseException e) {
    e.printStackTrace();
} 
```

如果数字格式化程序无法解析输入，则会引发异常。就像您将第一行更改为：

```
String s = "%123.456xyz"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:40:16.717

`format()`期望格式化一个数字，其中 as`parse()`从字符串中返回一个数字。

```
double n = nf.parse(s);
nf.setMaximumFractionDigits(2);
System.out.println(nf.format(n)); 
```

会给你你期望的结果。

### 参考：

[格式（）文档](http://docs.oracle.com/javase/7/docs/api/java/text/NumberFormat.html#format(double))

[parse() 文档](http://docs.oracle.com/javase/7/docs/api/java/text/NumberFormat.html#parse(java.lang.String))

# .net - 通过 DotNet 网络服务返回 PDF 的最佳方式是什么？

> ID：11635262
> 
> 赞同：2
> 
> 时间：2012-07-24T16:27:19.290
> 
> 标签：.net, web-services, pdf

我们有一个 Web 服务多年来一直没有问题地运行，将 PDF 作为字节数组返回。由于我们即将增加 Web 服务的容量，我想知道是否有更好的方法？

通常，PDF 的大小范围为 100kb-2mb。

我们的客户涵盖从各种风格的 java 到 DotNet。

谢谢你的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:35:38.203

如果 PDF 是静态的，那么您可能希望将它们放在 CDN 上并使用标记化系统进行访问，然后 PDF 将被发送到离您的用户最近的端点，并且设计为可扩展的。

如果没有，那么您可能希望尽可能压缩它们（尽管 PDF 优化通常可以很好地完成此工作），但从多个 Web 服务器（即在 Web 农场中）提供服务可能是一个好的开始。

# r - 通过添加到 POSIXlt 更改不同时区的日期

> ID：11635265
> 
> 赞同：3
> 
> 时间：2012-07-24T16:27:33.940
> 
> 标签：r

当我尝试在我的数据集中本地化“日期”（class=POSIXlt 的变量）的时间时遇到错误。示例代码如下：

```
# All dates are coded by survey software in EST(not local time)
date <- c("2011-07-26 07:23", "2011-07-29 07:34", "2011-07-29 07:40")
region <-c("USA-EST", "UK", "Singapore")

#Change the times based on time-zone differences
start_time<-strptime(date,"%Y-%m-%d %h:%m")
localtime=as.POSIXlt(start_time)
localtime<-ifelse(region=="UK",start_time+6,start_time)
localtime<-ifelse(region=="Singapore",start_time+12,start_time)

#Then, I need to extract the hour and weekday
weekday<-weekdays(localtime)
hour<-factor(localtime) 
```

我的`"ifelse"`陈述一定有问题，因为我得到了错误：`number of items to replace is not a multiple of replacement length`。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:05:23.683

使用 R 的本机时间码怎么样？诀窍是在 POSIX 向量中不能有多个时区，因此请改用列表：

```
region <- c("EST","Europe/London","Asia/Singapore")
(localtime <- lapply(seq(date),function(x) as.POSIXlt(date[x],tz=region[x])))
[[1]]
[1] "2011-07-26 07:23:00 EST"

[[2]]
[1] "2011-07-29 07:34:00 Europe/London"

[[3]]
[1] "2011-07-29 07:40:00 Asia/Singapore" 
```

并转换为单个时区中的向量：

```
Reduce("c",localtime)
[1] "2011-07-26 13:23:00 BST" "2011-07-29 07:34:00 BST"
[3] "2011-07-29 00:40:00 BST" 
```

请注意，我的系统时区是 BST，但如果您的系统时区是 EST，它将转换为那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:04:53.200

您可以使用内置的时区处理`POSIXct`：

```
> start_time <- as.POSIXct(date,"%Y-%m-%d %H:%M", tz = "America/New_York")
> start_time
[1] "2011-07-26 07:23:00 EDT" "2011-07-29 07:34:00 EDT" "2011-07-29 07:40:00 EDT"
> format(start_time, tz="Europe/London", usetz=TRUE)
[1] "2011-07-26 12:23:00 BST" "2011-07-29 12:34:00 BST" "2011-07-29 12:40:00 BST"
> format(start_time, tz="Asia/Singapore", usetz=TRUE)
[1] "2011-07-26 19:23:00 SGT" "2011-07-29 19:34:00 SGT" "2011-07-29 19:40:00 SGT" 
```

# xcode - 使用故事板和uitableview问题的设备方向

> ID：11635269
> 
> 赞同：0
> 
> 时间：2012-07-24T16:27:41.853
> 
> 标签：xcode, storyboard

我正在使用 Xcode 4.3.3 和故事板，我有一个 UITableView，但是当设备方向从纵向变为横向时，间距都搞砸了，我的 tableview 也没有 .h 或 .m 文件，因为单元格是静态的帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T20:13:52.393

在实用程序导航器的大小检查器中修改单元格、标签等的支柱和字符串（选择要修改的内容并按 Command-Option-5）。在标有自动调整大小的框中，选择和取消选择连接器和箭头以使项目以正确的方式显示。右侧的示例框向您展示了当您的方向改变时项目的外观。

# moodle - Moodle 中的独家测试结果查看权限

> ID：11635273
> 
> 赞同：2
> 
> 时间：2012-07-24T16:27:47.727
> 
> 标签：moodle

有一个Moodle系统如下： 一年有20门课程，每门课程有2位老师。每门课程结束时都有期末考试。
现在 - 每个老师都可以看到所有考试的结果。
通缉状态 - 每个教师只能访问他所教课程的结果。
那可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:43:33.037

听起来教师正在从系统范围的角色而不是课程角色中获得权限。尝试转到站点管理 > 用户 > 权限 > 分配系统角色，看看是否有他们都拥有的系统角色。如果是这样，请单击它并将其从该角色中删除。

然后，仅为他们教授的课程添加教师权限。输入课程并注册教师，然后按照[文档中的说明](http://docs.moodle.org/23/en/Assign_roles#Course_context)分配课程角色。这可能会导致他们同时担任学生和教师的角色，但这不是问题；系统会将他们视为老师。

# html - 多个 HTML5 画布覆盖

> ID：11635274
> 
> 赞同：1
> 
> 时间：2012-07-24T16:27:51.317
> 
> 标签：html, canvas, html5-canvas

是否可以通过事件传播创建一些透明的 HTML5 画布堆栈？

例如，我有一个带有绘制图像的背景画布，并带有一些附加的点击处理程序。之后，我想在背景画布上添加另一个尺寸完全相同的画布，它也有透明区域。问题是，如果我在顶层点击它，背景画布的点击处理程序会被触发吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:47:44.397

> 如果我在顶层点击它，背景画布的点击处理程序会被触发吗？

不，它不会。画布阻止来自其背后事物的事件。

通常，您有两种选择：将事件放在每个画布上，并建立一个系统，如果第一个画布上没有任何事情发生，则让它们“通过”，或者仅将事件放在最顶层的画布上并使用这些事件来执行有关所有画布的操作。

我建议第二种方法。仅将所有事件保留在最顶层的画布上。

# c# - 关于使用匿名方法从单独的线程更新 GUI 的说明

> ID：11635277
> 
> 赞同：2
> 
> 时间：2012-07-24T16:27:59.913
> 
> 标签：c#, winforms, multithreading, user-interface

我找到了一个看起来非常简单的解决方案来解决我目前的情况。

我目前的情况是我想在一个新线程上执行一些 I/O 繁重的操作，这样我就不会陷入我的 GUI 线程。作为我的表单的成员，我编写了一个函数，它已经完成了这些 I/O 操作，但是在 GUI 线程上运行它确实让应用程序使用起来很痛苦。所以我的计划是在一个新的线程中运行这个函数。因此，我在表单中创建了一个 Thread 变量，并试图让它将该函数用作 ThreadStart 参数。不过，它似乎并不喜欢它。

[我在这里](https://stackoverflow.com/a/661662/1549298)找到了一个外观优雅的解决方案，作为对另一个线程的回应。

```
///...blah blah updating files
string newText = "abc"; // running on worker thread
this.Invoke((MethodInvoker)delegate {
    someLabel.Text = newText; // runs on UI thread
});
///...blah blah more updating files 
```

从该响应的外观来看，我可以在新线程中运行此函数，然后在线程完成计算后使用匿名函数更新我的表单。不过，我只是不够好，无法填补该回复中的空白。

我似乎读到的关于 Threads 的所有内容都表明我的 ThreadStart 函数需要是新类中的静态方法。该响应似乎表明我可以在我的 Form 类中执行此操作，以便`this`引用仍然引用我的 Form 实例。否则，如果我的 ThreadStart 参数是一个不同的类，我必须传入对 Form 实例的引用，这似乎需要更多代码，对吧？

有人介意帮我填写该回复的上下文吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:34:07.913

有很多方法可以做到这一点。许多版本都存在的一个非常简单直接的方法是使用[BackgroundWorker](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CGoQFjAC&url=http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx&ei=R84OUKKnK8jX6gGH84D4Dw&usg=AFQjCNFwLYOqQ7vrjVJ7SroICXQH-GDyEQ)。它正是为这种情况而设计的。它有一个`DoWork`在后台线程中运行的方法，以及一个`Completed`在工作完成后触发的事件，该事件在 UI 线程中运行（因此您不需要调用调用或任何东西来使用结果更新 UI）。它甚至支持报告进度（报告进度事件也在 UI 线程中运行），因此您可以轻松更新进度条或状态文本。

MSDN 也有一些[示例](http://msdn.microsoft.com/en-us/library/cc221403%28v=vs.95%29.aspx)，您可以通过一些简单的搜索找到更多示例。

通过 C# 4.0 提供的另一个选项是使用`Tasks`. 您可以启动一个将在后台线程中运行的新任务，然后您可以添加一个将在 UI 线程中的延续。

这是一个简单的例子：

```
private void button1_Click(object sender, EventArgs e)
{
    Task.Factory.StartNew(() => doStuffInBackground())
        .ContinueWith(task => updateUI(), TaskScheduler.FromCurrentSynchronizationContext());
}

private void updateUI()
{
    throw new NotImplementedException();
}

private void doStuffInBackground()
{
    throw new NotImplementedException();
} 
```

您当然可以在我拥有的实际 lambda 中做任何您想做的事情，或者您甚至可以删除 lambda 并将方法直接放入其中，只要您确保签名正确即可。如果需要，您还可以继续链接这些延续，例如，允许您执行任务 1，更新标签，然后执行任务 2，更新标签等。主要缺点是它不擅长更新进度条经常在一个循环里面，一路一个`BackgroundWorker`就可以了。

# ros - 我可以在播放器（播放器/舞台）驱动程序中调用 ROS "ros::init(...)" 吗？

> ID：11635280
> 
> 赞同：2
> 
> 时间：2012-07-24T16:28:01.783
> 
> 标签：ros, player-stage

我正在尝试编写一个将在 ROS 上发布消息的播放器驱动程序。

播放器驱动程序不会创建可执行文件，因此我不确定如何在播放器驱动程序中调用 ROS 初始化。

播放器驱动的主要功能是这样的……

```
void PlayerDriver::Main() 
{

int argc; // Player Main() method does not take argument 
char **argv; // What to do with argc and argv??

geometry_msgs::Point commandInput;
ros::init(argc, argv, "Command");

ros::NodeHandle n;
ros::Publisher command_pub = n.advertise<geometry_msgs::Point>("servocommand", 1000);
ros::Rate loop_rate(1);

while (ros::ok())
{

ros::spinOnce();   

ProcessMessages();

//Do some stuff
commandInput.x = globalVel.v;
commandInput.y = globalVel.w;
commandInput.z = 0.0;
command_pub.publish(commandInput);

//Do some stuff

loop_rate.sleep();
}

} 
```

播放器驱动程序编译并创建一个共享库，我有一个 cfg 文件。它由“player playerdriver.cfg”调用并且工作正常，连接到播放器客户端但它不会在 ROS 上发布消息。

由于 Player Main() 方法不接受参数，我相信这是我做错的地方。欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-17T14:31:53.057

看这里[链接](http://wiki.ros.org/roscpp/Overview/Initialization%20and%20Shutdown)。还可以阅读 ROS 的发布者/订阅者教程。您可以从研究开始 ->[示例发布](http://wiki.ros.org/ROS/Tutorials/WritingPublisherSubscriber%28c%2B%2B%29)者。

# c++ - 出于一般原因抛出异常c ++

> ID：11635281
> 
> 赞同：8
> 
> 时间：2012-07-24T16:28:02.693
> 
> 标签：c++

我的构造函数中有以下代码块（这只是一个示例，问题不是关于`split`，而是关于**抛出一个通用异常**。此外，不能使用**Boost库。**

```
Transfer::Transfer(const string &dest){
  try{
    struct stat st;
    char * token;
    std::string path(PATH_SEPARATOR) // if it is \ or / this macro will solve it
    token = strtok((char*)dest.c_str(), PATH_SEPARATOR) // 
    while(token != NULL){
        path += token;
        if(stat(path.c_str(), &st) != 0){
            if(mkdir(path.c_str()) != 0){
                 std:string msg("Error creating the directory\n");
                 throw exception // here is where this question lies
            }
        }

        token = strtok(NULL, PATH_SEPARATOR);
        path += PATH_SEPARATOR;

    }
  }catch(std::exception &e){
       //catch an exception which kills the program
       // the program shall not continue working.
  }

} 
```

如果目录不存在并且无法创建，我想要的是**抛出异常。**我想抛出一个通用异常，我该怎么做`C++`？PS：`dest`格式如下：

```
dest = /usr/var/temp/current/tree 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-24T16:44:03.247

请检查[这个答案](https://stackoverflow.com/questions/434592/create-user-exception-derived-from-stdexception)。这解释了如何使用你自己的异常类

```
class myException: public std::runtime_error
{
    public:
        myException(std::string const& msg):
            std::runtime_error(msg)
        {}
};

void Transfer(){
  try{
          throw myException("Error creating the directory\n");
  }catch(std::exception &e){
      cout << "Exception " << e.what() << endl;
       //catch an exception which kills the program
       // the program shall not continue working.
  }

} 
```

此外，如果您不想要自己的课程，您可以简单地通过

```
 throw std::runtime_error("Error creating the directory\n"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T16:43:36.130

您的[用法`strtok`不正确](https://stackoverflow.com/q/7617966/168175)-它需要 a`char*`因为它修改了字符串，但不允许修改 a`.c_str()`上的结果 a `std::string`。需要使用 C 风格的演员表（这里表现得像 a `const_cast`）是一个很大的警告。

您可以通过使用 boost 文件系统巧妙地避开这个和路径分隔符可移植性的东西，这很[可能会在 TR2](http://www.open-std.org/jtc1/sc22/WG21/docs/papers/2012/n3335.html)发布时出现。例如：

```
#include <iostream>
#include <boost/filesystem.hpp>

int main() {
  boost::filesystem::path path ("/tmp/foo/bar/test");
  try {
    boost::filesystem::create_directories(path);
  }
  catch (const boost::filesystem::filesystem_error& ex) {
    std::cout << "Ooops\n";
  }
} 
```

在平台的分隔符上拆分路径，根据需要创建目录，如果失败则抛出异常。

# java - 为什么我可以访问封闭类引用的私有成员

> ID：11635282
> 
> 赞同：4
> 
> 时间：2012-07-24T16:28:13.110
> 
> 标签：java, static-members, nested-class

我见过很多关于访问封闭类的私有成员的问题。然而，我的问题恰恰相反。

如果我有（例如），下面的代码：

```
public class A {

   private String outerString = "silly string";

   static class B {
      private final A someA = new A();      

      public void foo() {
         String b = someA.outerString ;
      }
   }
} 
```

我想知道为什么会编译？由于我从 A 类（通过 someA.outerString）访问“outerString”实例变量的方式，我会预料到会出现错误。我知道内部类可以通过隐式“this”引用直接访问封闭类成员。但是在这里，B 类是静态的，所以“this”引用不适用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:31:34.223

`B`是 的成员，`A`因此可以访问`A`的`private`字段和方法。
在这种情况下，虽然`B`它`static`是使用 A 的实例来访问字段`A.outerString`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:35:11.077

`static`一个类的方法可以`private`通过同一个类实例访问同一个类的成员。这种行为对于`static`类也是一致的。

```
static void b(A someA) {
    String b = someA.outerString;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:42:18.563

**1.`this`仅适用于非静态成员，没错**.....但是您**没有使用** `this` **外部类的实例。**

**2.**您可以**很好地**从`Outer class private member`（**顶级）内部静态类访问。**

**3.** Outer to Inner 和 from Inner to Outer 可以**互相访问私有成员**..**唯一不同**的是，`non static inner class`隐**式引用了 Outer 类**，并且`static inner class`必须**使用 Instance 访问。**

# jquery - 使用 jQuery 进行简单的数学运算

> ID：11635290
> 
> 赞同：-5
> 
> 时间：2012-07-24T16:28:48.693
> 
> 标签：jquery, math

我需要使用 jquery 一起添加一些项目，我将如何去做呢？

我有。

*   1 件 @ 1.00 英镑
*   1 运费 @ 4.05 英镑

我基本上需要添加 1 x 1.00。然后将该总计添加到运费中，以便我可以显示总计。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:30:04.433

JS很简单

```
 var answer = 1*1 
```

jQuery 不是必需的，但可能会输出您的答案

```
$('.price').html("£"+answer); 
```

# java - Java servlet 创建 tmp 文件

> ID：11635292
> 
> 赞同：-3
> 
> 时间：2012-07-24T16:28:56.077
> 
> 标签：java, servlets

我有一个上传文件的 Java servlet，但是当我两次上传同一个文件时，applet 会创建一个`.tmp`文件。我怎样才能让它停止这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:33:00.060

将随机序列附加到字符串，由一个值分隔，例如`-`

然后，一旦文件准备好下载，剥离随机序列。

# javascript - 从 IE 中的文本框中获取非选定文本

> ID：11635297
> 
> 赞同：0
> 
> 时间：2012-07-24T16:29:01.383
> 
> 标签：javascript, jquery, html, internet-explorer, cross-browser

我正在尝试使用 IE8 在 Input Text 元素中获取未选择的文本，我尝试[了这个](https://stackoverflow.com/a/235419/1301872)并且确实很有帮助，但是在没有选择文本的情况下，函数返回字符串的开始和结束的索引。

如何获取输入文本元素的未选择文本，或者我如何知道何时没有选择文本？

使用 jQuery 也会很有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:52:27.507

如果我正确理解了您的问题，您将需要以下内容：

```
function getNonSelectedText(){
    var elem=document.getElementById('input');
    var selection=document.selection;
    var range=selection.createRange();
    if(range.boundingWidth<1){
        return elem.value;
    }
    var rangePre=range.duplicate();
    rangePre.moveToElementText(range.parentElement());// For <textarea>
    // rangePre.expand('textedit'); // For <input type=text>
    var rangePost=rangePre.duplicate();
    rangePre.setEndPoint('EndToStart',range);
    rangePost.setEndPoint('StartToEnd',range);
    return rangePre.text+rangePost.text;
} 
```

# c# - 在这种情况下使用哪种数据结构更好：字典 > 或字典 ?

> ID：11635307
> 
> 赞同：2
> 
> 时间：2012-07-24T16:29:46.197
> 
> 标签：c#, algorithm, data-structures, dictionary

我正在使用 C# 4.0。我正在对 a 的每一行执行一堆计算`System.Data.DataTable`。我不能给出实际的代码，但它归结为这样的东西：

```
DataTable table = GetMyTableFromSomewhere();
string[] columnNames = table.Columns.Cast<DataColumn>().Select(c => c.ColumnName).ToArray();
foreach (var row in table.Rows.Cast<DataRow>())
{
    Dictionary<string, object> values = columnNames.ToDictionary(c => c, c => row[c]);
    EvaluateExpressionUsingTheseValues(values);
} 
```

然后`EvaluateExpressionUsingTheseValues`将`"SomeColumn"`通过`values["SomeColumn"]`.

我的想法是在循环内创建字典是资源密集型的。因此，这样的事情可能更省时：

```
DataTable table = GetMyTableFromSomewhere();
int rowIndex = -1;
var values = table.Columns.Cast<DataColumn>().Select(c => new
{ 
    Key = c.ColumnName, 
    Value = new Func<object>(() => table.Rows[rowIndex][c.ColumnName])
}).ToDictionary(kv => kv.Key, kv => kv.Value);

for (rowIndex = 0; rowIndex < table.Rows.Count; rowIndex++)
{
    EvaluateExpressionUsingTheseValues(values);
} 
```

然后`values["SomeColumn"]`in`EvaluateExpressionUsingTheseValues`将只是`values["SomeColumn"]()`，而不是。

我认为第一个构建字典的每次迭代开销很大，但查找速度很快，而第二个在构建字典方面没有每次迭代开销，但查找速度较慢。

哪个更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:37:33.353

我不认为我们可以为你回答这个问题。这取决于哪个更适合*您的*情况。

不过，就我个人而言，我会选择第一个选项，因为它更容易破译。未来开发人员的大脑可能会在看到第二个选项时爆炸，除非它有很好的文档记录！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:37:40.953

您会发现解决方案`Dictionary<string, Func<object>>`具有更多开销。

原因是这些`Func<object>`委托存在于需要分配的闭包对象上。这样做的成本可能比简单地索引到您的行一次要高得多。

此外，无论如何，您可能必须稍后再进行索引。然后，该解决方案`Func<object>`将受益于内部缓存`EvaluateExpressionUsingTheseValues(values)`以避免多次评估。但这确实是第一个解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:00:34.700

我建议创建一个 Name/Value 类来反映 DataRow，创建大量 AnonymouseType 会降低性能，即使它们相同。

你可以用这个做一个基准：

```
public class DataTableHelper
{
    class RowItem
    {
        public string Name { get; set; }
        public object Value { get; set; }
    }
    public IEnumerable<RowItem> Convert(System.Data.DataTable table)
    {
        string[] columns = (from System.Data.DataColumn n in table.Columns select n.ColumnName).ToArray();

        foreach (System.Data.DataRow row in table.Rows)
        {
            foreach (string column in columns)
                yield return new RowItem() { Name = column, Value = row[column] };
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T17:00:39.710

一个重要因素是您最终实际需要的数据百分比是多少？如果您知道要为每一行使用每一列中的每个值（也许您将其全部打印到屏幕上，或者计算聚合数据），那么您也可以直接计算实际值填充您的字典。如果您知道您只会稀疏地访问数据，仅从某些行中提取一小部分列，那么在某些情况下，可能，使用第二种延迟评估的方法是值得的。

话虽如此，由于填充实际值本质上并不是那么复杂，因此不太可能取得那么大的胜利，因此更简单的（第一种）方法很可能是更好的选择。当然，如果您知道您不需要某些行/列尽早将它们过滤掉（理想情况下甚至不需要从数据库中获取它们）将是最好的。

# javascript - 在更改时删除对选择元素的关注，如果没有使用 jquery 更改

> ID：11635310
> 
> 赞同：4
> 
> 时间：2012-07-24T16:30:03.110
> 
> 标签：javascript, jquery, onchange

我有以下代码，当所选项目更改时，它会删除选择菜单的焦点：

```
$("select").change( function() {
    $(this).blur();
}); 
```

但是，如果我没有选择与已选择的选项不同的选项，则 blur() 函数不会运行......因为没有任何改变。

是否有“改变或不改变”功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:32:59.793

尝试

```
var c = 0;
$("select").bind('click', function() {
    event.stopPropagation();
    if (c++ % 2 == 1)
    {
        console.log(c);
        $(this).blur();
    }
});

$('html').click(function() {
    if ($('select').is(':focus'))
        c = 1;
    else
        c = 0;
});
​ 
```

[jsfiddle.net/5eE8x](http://jsfiddle.net/5eE8x)

更新。

# java - Eclipse 查找方法的参考

> ID：11635325
> 
> 赞同：14
> 
> 时间：2012-07-24T16:31:00.687
> 
> 标签：java, eclipse, eclipse-jdt

我想为以下类找到方法“get”的所有调用者：

```
package com.zzz.zzz.zzz.services;

public final class EMF {
  private static final EntityManagerFactory emfInstance =
    Persistence.createEntityManagerFactory("obamaCareIsGood4U");

  private EMF() {}

  public static EntityManagerFactory get() {
    return emfInstance;
  }
} 
```

所以我突出显示文本“获取”并右键单击参考 - 项目。但它返回对每个名为“get”的方法的引用，而不仅仅是对 com.zzz.zzz.zzz.services.EMF.get() 的引用。

这是一个日食错误吗？如何让 Eclipse 仅显示对 com.zzz.zzz.zzz.services.EMF.get() 的引用？

```
Eclipse Platform  Version:
4.2.0.v20120608-135145-9JF7BHV8FyMteji0Oi_ePMz0xuZ8TVo7lV0z0ecb
Build id:
I20120608-1400,

Spring Tool Suite Version: 3.0.0.M3 Build Id: 201207050802 
```

参考搜索的输出：

```
com.google.common.base - guava-12.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\guava\guava\12.0 - PatientCare
com.google.common.base - guava-gwt-12.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\guava\guava-gwt\12.0 - PatientCare
com.google.gwt.junit.server - gwt-user-2.4.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-user\2.4.0 - PatientCare
com.google.gwt.requestfactory.server - gwt-servlet-2.2.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-servlet\2.2.0 - PatientCare
com.google.gwt.resources.rg - gwt-user-2.4.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-user\2.4.0 - PatientCare
com.google.gwt.user.cellview.client - gwt-servlet-2.2.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-servlet\2.2.0 - PatientCare
com.google.gwt.validation.rebind - gwt-user-2.4.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-user\2.4.0 - PatientCare
com.google.web.bindery.requestfactory.apt - gwt-user-2.4.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-user\2.4.0 - PatientCare
com.google.web.bindery.requestfactory.gwt.rebind.model - gwt-user-2.4.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-user\2.4.0 - PatientCare
com.google.web.bindery.requestfactory.vm - gwt-user-2.4.0.jar - C:\Users\SofiaVergara\.m2\repository\com\google\gwt\gwt-user\2.4.0 - PatientCare
com.zzz.zzz.zzz.PatientCare.services.impl - src/main/java/server - PatientCare
com.sun.istack - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
com.sun.xml.bind.v2 - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
com.sun.xml.bind.v2.runtime - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
com.sun.xml.bind.v2.runtime.output - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
com.sun.xml.bind.v2.runtime.property - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
com.sun.xml.bind.v2.runtime.reflect - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
com.sun.xml.bind.v2.runtime.reflect.opt - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
com.sun.xml.bind.v2.runtime.unmarshaller - jaxb-impl-2.2.4.jar - C:\Users\SofiaVergara\.m2\repository\com\sun\xml\bind\jaxb-impl\2.2.4 - PatientCare
javax.persistence.spi - hibernate-jpa-2.0-api-1.0.1.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\hibernate\javax\persistence\hibernate-jpa-2.0-api\1.0.1.Final - PatientCare
javax.xml.bind - jaxb-api-2.2.3.jar - C:\Users\SofiaVergara\.m2\repository\javax\xml\bind\jaxb-api\2.2.3 - PatientCare
org.codehaus.jackson - jackson-core-asl-1.8.5.jar - C:\Users\SofiaVergara\.m2\repository\org\codehaus\jackson\jackson-core-asl\1.8.5 - PatientCare
org.codehaus.jackson.impl - jackson-core-asl-1.8.5.jar - C:\Users\SofiaVergara\.m2\repository\org\codehaus\jackson\jackson-core-asl\1.8.5 - PatientCare
org.codehaus.jackson.io - jackson-core-asl-1.8.5.jar - C:\Users\SofiaVergara\.m2\repository\org\codehaus\jackson\jackson-core-asl\1.8.5 - PatientCare
org.codehaus.jackson.map.ext - jackson-mapper-asl-1.8.5.jar - C:\Users\SofiaVergara\.m2\repository\org\codehaus\jackson\jackson-mapper-asl\1.8.5 - PatientCare
org.codehaus.jackson.map.ser - jackson-mapper-asl-1.8.5.jar - C:\Users\SofiaVergara\.m2\repository\org\codehaus\jackson\jackson-mapper-asl\1.8.5 - PatientCare
org.fusesource.restygwt.client.dispatcher - restygwt-1.3-SNAPSHOT.jar - C:\Users\SofiaVergara\.m2\repository\org\fusesource\restygwt\restygwt\1.3-SNAPSHOT - PatientCare
org.hibernate.context - hibernate-core-3.6.10.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\hibernate\hibernate-core\3.6.10.Final - PatientCare
org.hibernate.stat - hibernate-core-3.6.10.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\hibernate\hibernate-core\3.6.10.Final - PatientCare
org.hibernate.util - hibernate-core-3.6.10.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\hibernate\hibernate-core\3.6.10.Final - PatientCare
org.hibernate.validator.internal.util - hibernate-validator-4.3.0.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\hibernate\hibernate-validator\4.3.0.Final - PatientCare
org.hibernate.validator.internal.util.scriptengine - hibernate-validator-4.3.0.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\hibernate\hibernate-validator\4.3.0.Final - PatientCare
org.jboss.resteasy.client - resteasy-jaxrs-2.3.4.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\jboss\resteasy\resteasy-jaxrs\2.3.4.Final - PatientCare
org.jboss.resteasy.client.cache - resteasy-jaxrs-2.3.4.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\jboss\resteasy\resteasy-jaxrs\2.3.4.Final - PatientCare
org.jboss.resteasy.core - resteasy-jaxrs-2.3.4.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\jboss\resteasy\resteasy-jaxrs\2.3.4.Final - PatientCare
org.jboss.resteasy.spi - resteasy-jaxrs-2.3.4.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\jboss\resteasy\resteasy-jaxrs\2.3.4.Final - PatientCare
org.jboss.resteasy.util - resteasy-jaxrs-2.3.4.Final.jar - C:\Users\SofiaVergara\.m2\repository\org\jboss\resteasy\resteasy-jaxrs\2.3.4.Final - PatientCare 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-25T01:56:35.587

突出显示时，按 Ctrl+Shift+G。它会在搜索选项卡/窗口中提供结果列表。它会在您的工作区中找到所有引用。它通过适当的引用而不是纯文本搜索来完成。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-24T18:13:17.740

在 Project 中查找引用依赖于方法名称，这就是它不准确的原因。尝试使用调用层次结构。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-10-16T13:24:43.780

在 Eclipse Kepler 中，您可以配置搜索以过滤掉所有*潜在匹配*项（当使用*References* - *Workspace* / *Project*或*Hierarchy时。要激活过滤器，请单击**搜索*视图右上角的小向下箭头并激活*潜在匹配*项检查-盒子。 ![在此处输入图像描述](../Images/fe104c97255fb00ff8b0c2f788022507.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-19T12:49:01.840

有时，如果您有多个同名的方法，例如，一个类的构造函数，它们都具有相同的名称但签名不同，例如，找到其中一个构造函数的所有调用者可能会很痛苦。您可以使用的一个技巧是注释掉您正在调查和构建的那个。然后，编译器会告诉您它无法找到该签名的所有位置，因此这些正是尝试使用该名称和该特定签名调用该方法的所有位置。

# mobile - 没有子域的移动网站

> ID：11635327
> 
> 赞同：2
> 
> 时间：2012-07-24T16:31:06.213
> 
> 标签：mobile, version, subdomain

我有一个网站可以检查用户代理并在需要时加载移动版本。它加载 www.mydomain.com/mobile。

但是，就像这个网站“stackoverflow”一样，没有子域：它只是桌面版和移动版的“stackoverflow.com”。这是怎么做到的？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:03:08.273

www 不是子域，它是主机名。这里发生的只是 DNS 的运行。
让我们查找[www.stackoverflow.com](http://www.stackoverflow.com)

```
www.stackoverflow.com. 3600 IN CNAME stackoverflow.com 
```

这说：“`www.stackoverflow.com`是 的别名`stackoverflow.com`，查找`stackoverflow.com`以知道 IP 地址”，所以现在我们查找 stackoverflow.com

```
stackoverflow.com. 3600 IN A 64.34.119.12 
```

它就是IP地址。这是故事的第 1 部分。

关于 SO 使用相同 URL 提供移动和桌面版本的技术，因为支持 SO 的 StackExchange 软件不是开源的，我只能引用 Jeff Atwood 的话，来自[关于移动版本的博客文章的评论](https://blog.stackoverflow.com/2011/07/mobile-stack-exchange/#comment-60071)

> 不幸的是，这种方法根本不适用于像我们这样实际上向移动客户端提供不同 HTML 的网站。

这使我推测所需的渲染（移动或桌面）是您会话的一部分，并且页面控制器只是将另一组模板应用于存储在数据库中的文章内容。

# android - 动态填充 ListPreference

> ID：11635329
> 
> 赞同：0
> 
> 时间：2012-07-24T16:31:16.070
> 
> 标签：android, android-layout

我正在尝试用 res/anim 文件夹的内容填充 ListPreference，但我遇到了一个问题，它一直显示为空白，我有一个静态的字符串数组来填充它，但我需要它是动态的，我可以在logcat中打印文本，它只是没有填充列表你能帮我吗？

PreferenceActivityMenu.java

```
 CharSequence[] entries = null;
      CharSequence[] entryValues = null;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);

    SharedPreferences prefs=getPreferences(Context.MODE_PRIVATE);

    ListPreference prefListAnim = new ListPreference(this);

    listAnim();

    prefListAnim.setEntries(entries);

    prefListAnim.setEntryValues(entryValues);

    }

@Override
public boolean onPreferenceClick(Preference preference) {
    // TODO Auto-generated method stub
    return false;
}

public void listAnim() {
    Field[] fields = R.anim.class.getFields();
    entries = new String[fields.length];
    entryValues = new String[fields.length];

    for (int count = 0; count < fields.length; count++) {
        Log.i("Raw Asset: ", fields[count].getName());
        entries[count] = fields[count].getName();

        entryValues[count] = Integer.toString(count);

    }
} 
```

和preference.xml

```
 <PreferenceCategory android:title="Animation Transitions" >

    <ListPreference 

        android:dialogTitle="@string/prefsList_dialogTitle"
        android:key="prefList_animations"
        android:summary="@string/prefsList_summary"
        android:title="@string/prefsList_title" >
    </ListPreference>
</PreferenceCategory> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:33:32.040

您正在将列表数据设置为不同于 xml 中声明的首选项。目前，您正在根据新创建的数据设置数据`ListPreference`：

```
ListPreference prefListAnim = new ListPreference(this); 
```

但是，您正在显示在 xml 中声明的（空）一个。你应该做一个或另一个。例如，最简单的解决方案可能是更改上面的内容以从 xml 中增加首选项：

```
ListPreference prefListAnim = (ListPreference) findPreference("prefList_animations"); 
```

# python - Re.findall() 不能将变量作为参数

> ID：11635334
> 
> 赞同：0
> 
> 时间：2012-07-24T16:31:44.340
> 
> 标签：python, regex, python-2.7

我正在 Project Euler 上尝试[问题 20](http://projecteuler.net/problem=20 "问题 20")，这是我目前的解决方案：

```
import re
mylist = []
var1 = 100
def exclamation(n, L):
    for n in xrange(1, (n)):
        L.append(n)
        n -= 1
    print L
def multiply(L, V):
    while len(L) > 0:
        V = L.pop(-1) * V
    print V
exclamation(100, mylist)
multiply(mylist, var1)
print mylist
list1 = re.findall('.', var1)
print list1 
```

但是， re.findall 只接受字符串，我想知道是否还有其他东西可以完成相同的工作或转义字符告诉它它是一个变量。

我尝试在它前面加上一个“/”以及我认为我在 python 文档中找到的“/escape”，但是它没有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:34:08.160

这与它是否是*变量*无关。这是关于它是否是一个*字符串*。只需将参数设为字符串即可。如果`var1`是 int，这很容易：

```
re.findall('.', str(var1)) 
```

# apache-flex - Flex DataGrid 列不会调整大小

> ID：11635338
> 
> 赞同：0
> 
> 时间：2012-07-24T16:32:11.593
> 
> 标签：apache-flex, actionscript

我在尝试调整 DataGrid 中的列大小时遇到​​严重问题。我已经坚持了一天多，但我却因头疼而不知所措。

本质上，我有一个 TabNavigator 组件，其中包含 NavigatorContent 子项。在每个 NavigatorContent 子项中，我都有一个 DataGrid，我将其宽度设置为 100%（这需要能够处理浏览器窗口的大小调整）。我使用[来自 Iwo Banas 的优秀可过滤 DataGrid](http://www.iwobanas.com/2009/06/datagrid-with-client-side-filtering-and-searching/)作为每个选项卡中的 DataGrid。

现在，我在每个 DataGrids 中使某些列可见/不可见，这工作正常。但是，我发现列宽设置不正确。每当我设置列宽（使用[此](https://stackoverflow.com/a/1545984/487812)代码）时，所有列似乎都设置为正确的宽度，除了我最近使其可见的列和紧靠这些列左侧的列。最近显示的那些非常小（尽管我将它们的宽度设置为 30），而这些列左侧的那一列非常大（尽管我也将其宽度设置为 30）。

我认为这与 DataGrids 的生命周期有关，因为第一个 DataGrid 表现良好。当我单击其他选项卡时，我发现其他 DataGrids 的宽度没有正确设置。

但是，如果我“看到”其中一个问题 DataGrids（即它出现在屏幕上）并且调整列大小的代码再次运行，则列的大小是正确的。

我已经尝试了许多在互联网上推荐的东西，包括下面列出的问题，但无济于事。

这是我用来调整列大小的代码（取自[这个](https://stackoverflow.com/a/1545984/487812)答案）

```
public static function resizeColumn(col:DataGridColumn, size:int):void
        {
                var owner:* = col.mx_internal::owner
                col.mx_internal::owner = null;

                col.width = size;

                col.mx_internal::owner = owner;
        } 
```

任何和所有的帮助将不胜感激。

我已经看过以下答案。 [Flex DataGrid 列宽：一列来统治它们？](https://stackoverflow.com/questions/4195445/flex-datagrid-column-width-one-column-to-rule-them-all) [Flex 3 DataGrid Column Width Problem](https://stackoverflow.com/questions/1302522/flex-3-datagrid-column-width-problem) [Flex DataGrid Column Width](https://stackoverflow.com/questions/1289934/flex-datagrid-column-width) (<--这个答案让我最接近) [无法在 flex datagrid 中动态更改列宽](https://stackoverflow.com/questions/6033513/unable-to-change-the-column-width-dynamically-in-flex-datagrid)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T09:56:07.590

所以，经过大量的头疼后，我终于找到了一个解决方案（至少对于我的问题，不确定它是否会帮助其他人，但我想我还是会把它贴在这里，因为你永远不知道什么可以帮助别人）。

我决定，既然在屏幕上显示 DataGrid 时调用调整大小代码可以工作，那么我只需要这样做。所以我想根据单击的选项卡放置相关 DataGrid 的调整大小代码。不是*那么*简单，因为似乎没有一种直接的方法来实现选项卡的点击处理程序。我做了一个快速的谷歌并找到[了这个](http://whatsmytitletoday.blogspot.co.uk/2009/03/flex-tabnavigator-tab-click-event.html)解决方案。

本质上，您通过循环浏览选项卡导航器的子项、获取按钮并添加事件侦听器来为每个选项卡按钮添加一个单击处理程序。

然后，您在处理程序中执行您需要执行的操作。

[代码示例（与网站](http://whatsmytitletoday.blogspot.co.uk/2009/03/flex-tabnavigator-tab-click-event.html)略有不同）：

```
 protected function tbGridArea_creationCompleteHandler(event:FlexEvent):void
        {
            for ( var i:int=0; i < tbGridArea.getChildren().length; i++ )
            {
                var tab:Object = tbGridArea.getTabAt(i);
                tab.addEventListener( FlexEvent.BUTTON_DOWN,myTabClickHandler );
            }
        }

        private function myTabClickHandler(event:Event):void {
            switch(event.currentTarget.label) {
            // do whatever you need to do here
            }
        } 
```

# jquery - 有没有办法在 jquery 中将“hasClass()”的类名写为“以 smt 开头”？

> ID：11635341
> 
> 赞同：3
> 
> 时间：2012-07-24T16:32:28.007
> 
> 标签：jquery

我需要编写 jquery 代码，例如：

```
if($('label').hasClass('info_')) {

} 
```

有很多类名，如：info_1、info_2、info_3 等。所以，如果标签有一个以 info_ 开头的类名，我必须这样写。做点什么。

但我查看了 jquery 站点并搜索了 hasClass()。没有这方面的例子。有什么办法吗？谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-24T16:35:08.297

尝试使用：

```
 $("[class^=info_]"); //Classes Starts with  info_
  $('[class*=info_]');  // Classes which contains info_ 
```

根据您的代码而不是`hasClass`

```
if($('label').is('[class*=info_]')){} //Contains 
```

或者

```
 if($('label').is('[class^=info_]')){} //Starts with 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T16:49:01.220

你不能用`hasClass`，但你可以用`filter`。您可以浏览课程，并找到匹配的课程。

```
var $labels = $('label').filter(function(){
    return /\b(info_\d+)\b/.test(this.className);
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T16:41:05.693

```
if( /(^|\s)info_/.test( $('label')[0].className ) ) {

} 
```

或者如果您有多个标签：

```
if ($("label").is(function() {
    return /(^|\s)info_/.test(this.className);
})) {

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T16:35:58.623

一个元素可以有多个`class`值（用空格分隔）。所以使用这样的东西：

```
<label class="has_info info_1">...</label> 
```

然后你可以这样做：

```
if ( $('label').hasClass('has_info')
{
    // ...
} 
```

编辑：“开始于”CSS 选择器可能是这里更好的路线。然而，接下来的内容仍然是正确的。

虽然我确实认为这`$(label).hasClass()`是一个坏主意。你可能想要这样的东西：

```
$('label').each(function() {
    if ( $(this).hasClass('has_info') )
    {
        // ...
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-30T13:09:39.607

如果要检查类名称是否以...开头，则可以使用以下代码您要检查以 myclass- 开头
的类，因此它会根据您在警报中的输入为您提供出现次数。据此，输出为 2。

```
<div class="myclass-s1"></div>
<div class="myclass-b10"></div>
<div class="myclassb10"></div>

$.expr[':'].hasClassStartingWithInput = function(obj){
return ((/\bmyclass-/).test(obj.className)); //here is the input(myclass-)that you need to give
 }; 
```

# php - PHP 5.2 升级到 5.3

> ID：11635342
> 
> 赞同：0
> 
> 时间：2012-07-24T16:32:30.700
> 
> 标签：php, upgrade, codesniffer

> **可能重复：**
> [将 PHP 从版本 5.2 升级到 5.3](https://stackoverflow.com/questions/1609325/upgrade-php-from-version-5-2-to-5-3)

我用 PHP 5.3 中已弃用的一些功能实现了 15 个站点。我的托管服务提供商为我提供了一台新服务器，但它安装了 php 5.3。我需要将所有代码升级到 5.3，因为服务器移动迫在眉睫，所以我想知道识别/更正具有已弃用功能的文件的最佳方法是什么。

我尝试使用 PHP_Codesniffer，它给了我文件列表和在 PHP5.3 中不起作用的确切函数，但我仍然需要一个一个地编辑这些文件。是否有另一个扩展程序/程序可以帮助我解决这个问题？（只是试图避免一个一个地进入所有文件的所有繁琐工作）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:36:21.603

查看有关 5.2 和 5.3 之间更改的文档：http: [//php.net/manual/en/migration53.php](http://php.net/manual/en/migration53.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:52:00.003

下载并安装[Sublime Text 2](http://www.sublimetext.com/dev)、Notepad2、Notepad++ 等。它们都在指定目录中具有搜索和替换功能。您必须对要更改的每一件事进行搜索和替换，但一次执行一个文件会更快。

# javascript - 每个链接菜单下方的进度条

> ID：11635345
> 
> 赞同：0
> 
> 时间：2012-07-24T16:32:50.353
> 
> 标签：javascript, jquery, html, css

我正在寻求帮助来创建这样的菜单[这是我想要的菜单](http://piccsy.com/investors/)

可以用 Javascript 或 Jquery 来完成吗？

我用html和css做了一个这样的菜单，但它和网站不一样。

我有 2 个选项

这是第一个代码，但问题是如果我点击网站的其他内容，它会丢失进度条......

```
body {
    padding: 10em 0 0;
}
.ui-menu {
    width: 37em;
    padding: 0;
    text-align: center;
}
.ui-menu a {
    width: 4em;
    margin: 0 .15em;
    padding: .1em .35em;
    display: inline-block;
    background: #f7f7f7;
    font: 17px "Arial Narrow", sans-serif;
    text-align: center;
    text-decoration: none;
}
.ui-menu a:focus {
    outline: none;
}
.ui-menu-bottom-line {
    width: 35em;
    height: 1px;
    margin: 1em auto;
    background: #d7d7d7
        linear-gradient(left, #d82126 50%, transparent 50%) no-repeat;
    background-size: 5em;
    transition: 1s; 
}
.ui-menu a:nth-child(2):focus ~ .ui-menu-bottom-line,
.ui-menu a:nth-child(2):active ~ .ui-menu-bottom-line {
    background-size: 15em;
}
.ui-menu a:nth-child(3):focus ~ .ui-menu-bottom-line,
.ui-menu a:nth-child(3):active ~ .ui-menu-bottom-line {
    background-size: 25em;
}
.ui-menu a:nth-child(4):focus ~ .ui-menu-bottom-line,
.ui-menu a:nth-child(4):active ~ .ui-menu-bottom-line {
    background-size: 35em;
}
.ui-menu a:nth-child(5):focus ~ .ui-menu-bottom-line,
.ui-menu a:nth-child(5):active ~ .ui-menu-bottom-line {
    background-size: 45em;
}
.ui-menu a:nth-child(6):focus ~ .ui-menu-bottom-line,
.ui-menu a:nth-child(6):active ~ .ui-menu-bottom-line {
    background-size: 55em;
}
.ui-menu a:nth-child(7):focus ~ .ui-menu-bottom-line,
.ui-menu a:nth-child(7):active ~ .ui-menu-bottom-line {
    background-size: 65em;
} 
```

和 HTML：

```
<div class="ui-menu">
<a class="goto-frame" href="#" tabindex="1">Welcome</a><a class="goto-frame" href="#" tabindex="1">Problem</a><a class="goto-frame" href="#solution" tabindex="1">
Solution</a><a class="goto-frame" href="#team" tabindex="1">Team</a><a class="goto-frame" href="#traction" tabindex="1">Traction
</a><a class="goto-frame" href="#product" tabindex="1">Product</a><a class="goto-frame" href="#contact" tabindex="1">Contact</a>
<div class="ui-menu-bottom-line"></div> 
```

第二个代码：

```
body {
    padding: 10em 0 0;
}
.ui-menu {
    width: 37em;
    padding: 0;
    font: 17px "Arial Narrow", sans-serif;
    text-align: center;
}
.ui-menu input[type=radio] { display: none; }
.ui-menu label {
    width: 4em;
    margin: 0;
    padding: .1em .5em;
    display: inline-block;
    text-align: center;
}
.ui-menu-bottom-line {
    width: 35em;
    height: 1px;
    margin: 1em auto;
    background: #d7d7d7
        linear-gradient(left, #d82126 50%, transparent 50%) no-repeat;
    background-size: 5em;
    transition: 1s;
}
.ui-menu #welcome:checked ~ .ui-menu-bottom-line {
    background-size: 5em;
}
.ui-menu #problem:checked ~ .ui-menu-bottom-line {
    background-size: 15em;
}
.ui-menu #solution:checked ~ .ui-menu-bottom-line {
    background-size: 25em;
}
.ui-menu #team:checked ~ .ui-menu-bottom-line {
    background-size: 35em;
}
.ui-menu #traction:checked ~ .ui-menu-bottom-line {
    background-size: 45em;
}
.ui-menu #product:checked ~ .ui-menu-bottom-line {
    background-size: 55em;
}
.ui-menu #contact ~ .ui-menu-bottom-line {
    background-size: 65em;
} 
```

和 HTML：

```
<div class="ui-menu">
<input type="radio" name="mi" id="welcome">
<label class="goto-frame" for="welcome">Welcome</label>
<input type="radio" name="mi" id="problem">
<label class="goto-frame" for="problem">Problem</label>
<input type="radio" name="mi" id="solution">
<label class="goto-frame" for="solution">Solution</label>
<input type="radio" name="mi" id="team">
<label class="goto-frame" for="team">Team</label>
<input type="radio" name="mi" id="traction">
<label class="goto-frame" for="traction">Traction</label>
<input type="radio" name="mi" id="product">
<label class="goto-frame" for="product">Product</label>
<input type="radio" name="mi" id="contact">
<label class="goto-frame" for="contact">Contact</label>
<div class="ui-menu-bottom-line"></div> 
```

我怎样才能制作像 piccsy.com/investors 这样的菜单？Javascript？jQuery？HTML+CSS??

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:45:42.420

您可以安装 firebug 或检查元素以查看事情是如何完成的。在这种情况下，您的进度条包含两件事：一条灰线，以及它上方的一条红线（实际是一个 div）。当您滚动或单击导航时，将有一个脚本来更改红条宽度，以便您看到进度。所以你的脚本必须处理两件事：滚动事件和点击导航事件。

例子：

```
function updateProgress(){
   $('#progress').width(maxWidth * ($(body).scrollTop() / $(body).height()) );
}

$('#Nav1').click(function(){
   //Scroll to a position
   $(body).scrollTo(100);
});

$(body).scroll(function(){
   updateProgress()
}); 
```

类似的东西

# c - 在接触大内存区域时执行 fork exec 的程序

> ID：11635350
> 
> 赞同：1
> 
> 时间：2012-07-24T16:33:01.417
> 
> 标签：c, linux, exec, fork

我想编写一些具有以下要求的 C 代码：

1.  重复分叉执行。
2.  分叉的进程应该使用大量内存，然后要么放弃它，要么干脆死掉，或者我干脆杀了它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T02:53:09.393

```
int main (int argc, char *argv[]) {
    unsigned long long bytes;
    char bytes_str[32];
    void *buf;
    int i;
    if (argc < 2) {
        fprintf(stderr, "usage: %s [megabytes]\n", argv[0]);
        exit(EXIT_SUCCESS);
    } else if (argc < 3) {
        switch (fork()) {
        case 0:  break;
        case -1: perror("fork");
                 exit(EXIT_FAILURE);
        default: exit(EXIT_SUCCESS);
        }
        bytes = strtoull(argv[1], 0, 0) * 1024 * 1024;
        snprintf(bytes_str, sizeof(bytes_str), "%llu", bytes);
        if (execlp(argv[0], argv[0], "child", bytes_str, (char *)0) != 0) {
            perror("execlp");
            exit(EXIT_FAILURE);
        }
        /* NOT REACHED */
    } else {
        bytes = strtoull(argv[2], 0, 0);
    }
    if (bytes < 1024*1024) exit(EXIT_SUCCESS);
    buf = malloc(bytes);
    if (buf == 0) {
        perror("malloc");
        exit(EXIT_FAILURE);
    }
    memset(buf, '\xff', bytes);
    free(buf);
    bytes /= 2;
    snprintf(bytes_str, sizeof(bytes_str), "%llu", bytes);
    for (i = 0; i < 2; ++i) {
        switch (fork()) {
        case 0:  break;
        case -1: perror("fork");
                 exit(EXIT_FAILURE);
        default: continue;
        }
        if (execlp(argv[0], argv[0], "child", bytes_str, (char *)0) != 0) {
            perror("execlp");
            exit(EXIT_FAILURE);
        }
        /* NOT REACHED */
    }
    return 0;
} 
```

# objective-c - 如何从 NSString 中检索数字

> ID：11635351
> 
> 赞同：0
> 
> 时间：2012-07-24T16:33:01.777
> 
> 标签：objective-c, nsstring

我有一个`NSString`看起来像这样的`@"1, 5, 23, 15, 6"`。我需要的是从这个字符串中检索所有这些数字。可能结果可能看起来像一个 NSStrings 数组 - `@"1"`, `@"5"`,`@"23"`等等。我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:36:11.577

```
NSString *string = @"1, 5, 23, 15, 6";
NSArray *chunks = [string componentsSeparatedByString: @", "]; 
```

# facebook - 为什么 Facebook 画布优于 Facebook 页面选项卡？

> ID：11635367
> 
> 赞同：9
> 
> 时间：2012-07-24T16:33:52.930
> 
> 标签：facebook, facebook-graph-api, canvas

我已经阅读了“设置”画布页面与页面选项卡的区别。我还看到 Canvas 页面允许与通知、书签、新闻源、时间线等进行交互。但是，页面选项卡是否也允许这样做？

我想弄清楚在什么情况下你会在页面选项卡上使用画布。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T10:02:23.047

[嵌入到页面中的应用程序和画布应用程序之间的主要区别是画布应用程序在https://apps.facebook.com/](https://apps.facebook.com/) ... 域下具有自己的唯一 URL 。

您的应用程序是否嵌入页面的事实不一定掌握在您手中，因为应用程序创建者和页面管理员可能是不同的人。添加的集成点 facebook 为您提供了与此 URL 相关联的所有内容。（我猜他们可以直接使用您的后端网址，但他们无法在那里展示广告。）

如果您需要以下一项或多项功能，您可能需要选择画布应用程序：

1.  ### 您想使用与画布相关的 facebook 平台功能。

    1.  [要求](http://developers.facebook.com/docs/requests/)
    2.  [书签](http://developers.facebook.com/docs/guides/canvas/#bookmarks)
    3.  [应用程序/游戏仪表板](https://www.facebook.com/games)
    4.  出现在[搜索](http://developers.facebook.com/docs/guides/canvas/#search)结果中
2.  ### 想支持宽屏

    画布页面[可以配置](http://developers.facebook.com/docs/fluidcanvas/)为扩展“墙到墙”并利用大屏幕用户。

3.  ### 想要（轻松地）在您的应用中使用深层链接。

    可以使用 GET 参数在页面选项卡上实现深度链接（通过选项卡上的[signed_request](http://developers.facebook.com/docs/authentication/signed_request/)`data`进入您的应用程序），但画布页面可以“免费”获得此功能。

文档中有一个关于如何创建好的画布应用程序的[最佳实践指南。](http://developers.facebook.com/docs/guides/games/canvas/)

# c++ - Qt 序列化 - 如何排除一个字段？

> ID：11635368
> 
> 赞同：0
> 
> 时间：2012-07-24T16:33:53.180
> 
> 标签：c++, qt, serialization, qt4

我有一个包含很多动态（QVectors）和静态字段的结构，我需要对其进行序列化。我愿意使用这个： http: [//www.developer.nokia.com/Community/Wiki/Qt_Object_Serialization](http://www.developer.nokia.com/Community/Wiki/Qt_Object_Serialization)

但是我需要这个结构中的一个字段，但我不希望它被序列化，有什么建议可以避免它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:50:57.347

要实现序列化，您将为QDataStream + 数据结构定义`<<`and运算符。`>>`所以不要写你不想序列化的字段！

**编辑：** 要使自定义类序列化，您必须做什么：

```
class MyClass
{
    int member1;
    int member2; // <- Don't serialize me!
    int member3;

public:
    //Constructors and methods and bears (oh my!)...

    friend operator << (QDataStream& stream, const MyClass& myclass)
    {
        //Don't write member2:
        return stream << myclass.member1 << myclass.member3;
    }

    friend operator >> (QDataStream& stream, MyClass& myclass)
    {
        //Don't read it, either:
        return stream >> myclass.member1 >> myclass.member3;
    }
}; 
```

# json - Apache Wink、GET 和 JSON 消费者，如何？

> ID：11635372
> 
> 赞同：0
> 
> 时间：2012-07-24T16:34:01.320
> 
> 标签：json, curl

如何通过 CURL 为这个 Apache Wink 处理程序发送有效请求？

```
@GET
@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
public JSONObject find(JSONObject request) {
// ....
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T19:03:34.460

*我意识到这是一个旧线程，但我想回答它，以防有人像我一样偶然发现这个问题*

尝试：

```
@GET
@Path ( "{json}" )
@Produces  (MediaType.APPLICATION_JSON )
public JSONObject find(@PathParam("json") JSONObject json)
{
    ...
} 
```

# mysql - 仅使用 WHERE 子句检索第一条记录

> ID：11635373
> 
> 赞同：-2
> 
> 时间：2012-07-24T16:34:07.083
> 
> 标签：mysql

我需要仅使用 WHERE 子句检索客户创建的第一条记录。我不能使用 LIMIT、ORDER BY 等。

```
SELECT *
FROM mytable
WHERE customer_id = 1
  AND created = ? the earliest timestamp for that customer 
```

编辑：预料到那些会问的人，这是我正在使用的当前框架中特定案例的限制。别担心。我只需要这样做。如果做不到，就告诉我做不到。

提前致谢。

**Edit2：**谢谢大家，但我也不能使用任何连接。还有更多的想法还是根本无法完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:37:27.673

```
SELECT * 
FROM mytable 
WHERE customer_id = 1 AND created IN (
    SELECT min(created) AS MinCreated
    FROM mytable
    WHERE customer_id = 1
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:37:36.553

`...AND created = MIN(SELECT timestamp FROM mytable)`这行得通吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:48:12.747

你可以使用，

```
select * from mytable where customer_id = 1
  AND (select count(*) from mytable) <=1 
```

# html - CSS - 显示表格和表格单元格上的水平空白

> ID：11635380
> 
> 赞同：0
> 
> 时间：2012-07-24T16:34:25.410
> 
> 标签：html, css, css-tables

我在没有任何理由的情况下出现在 div 内的水平空白区域存在问题。我的意思是，我无法弄清楚它为什么会出现，它只是没有任何意义。

这是[小提琴](http://jsfiddle.net/fzNzx/)

布局应该是两列：一右一左，后一列更大。问题是在右边的 div 上，我经常看到显示的内容，所有对齐都很好地显示出来。在左边，它的内容较低，我的意思是它似乎有一个大约 5px 的 padding-top，但根本没有 padding。空白区域位于左侧表格单元格 div 内，因为即使其中包含纯文本（“Lorem ipsum”），文本显示的内容也低于右侧 div 内的内容。

HTML代码是：

```
<div id="main_contents_cage">
    <div id="main_contents_left">
        <table> ... some content ... </table>
    </div>

    <div id="main_contents_right">
        ... some other content ...
    </div>
</div> 
```

CSS是：

```
#main_contents_cage { display: table; }
#main_contents_left, #main_contents_right { display: table-cell; }

#main_contents_left { width: 742px; }
#main_contents_right { width: 246px; border-left: 1px solid #C6C6C6; } 
```

我在互联网和 StackOv 上搜索了有同样问题的其他人，但没有找到有同样问题的人。类似，但完全不一样！

我尝试为所有元素提供边框折叠/边框间距（每个元素一次，然后是“表格”一个，然后是“表格单元格”元素，然后是三个元素）：什么都没有。

我尝试更改表格单元格 div 的内容，但没有任何不同的结果（用其他 div 替换表格，或者只是纯文本....）。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-28T17:24:20.220

我遇到了同样的问题。我也能够通过将“vertical-align:top”分配给表格单元元素来“解决”这个问题。这似乎只是 Chorme 中的一个问题。对我来说，它只是右栏（而不是像你的例子中的左栏）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:44:03.703

具有“main_contents_left”类的 div 的内容具有不包含子行或孙子单元格的表格标签，这可能与它有关吗？

如果您有兴趣，这是我的[jsFiddle的链接](http://jsfiddle.net/kcyxa/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:48:41.197

好的，我想通了：我需要将“vertical-align:top”添加到“table-cell”div，以便内容显示在顶部没有空白！

我知道它可以工作，但我真的无法让它在我的网页上工作，即使没有 CSS（只是我需要的一个......）。（FF 13，铬 20）。

谢谢

# python - web.py 开发服务器 - favicon.ico - 404 未找到

> ID：11635381
> 
> 赞同：10
> 
> 时间：2012-07-24T16:34:31.480
> 
> 标签：python, favicon, web.py

使用开发服务器运行 web.py 应用程序时，如何摆脱 favicon 的 404 错误？

```
"HTTP/1.1 GET /" - 200 OK
"HTTP/1.1 GET /favicon.ico" - 404 Not Found 
```

我能够找到的有关消除此错误的所有内容都与在 Apache 配置中指定资源的路径有关。这显然对开发服务器用例没有帮助。有没有办法在 urls 元组中指定静态资源？你能在 web.py 应用程序中定义一个文档根目录吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-19T02:21:21.427

web.py API 文档引用了一个“web.seeother()”函数，该函数生成一个
“303 SEE OTHER”响应，将浏览器重定向到不同的位置。
（见[http://webpy.org/docs/0.3/api#web.application](http://webpy.org/docs/0.3/api#web.application)）

这是一个服务器端解决方案，不需要更改 html 文件的标头；如果服务器实际上不处理 html 文件，则特别有用。

**解决方案：**

从默认 /favicon.ico 映射一个 url 路由并创建一个新类来处理此路由：

```
# Define API Routes
urls = (
    '/', 'index',
    '/favicon.ico', 'icon'
) 
```

创建一个包含 favicon.ico 的（可通过网络访问的）静态目录

创建一个新类来处理这个文件：

```
# Process favicon.ico requests
class icon:
    def GET(self): raise web.seeother("/static/favicon.ico") 
```

这是显示请求的服务器日志：

```
<ip#> - [18/Oct/2013 21:54:54] "HTTP/1.1 GET /favicon.ico" - 303 See Other
<ip#> - [18/Oct/2013 21:54:54] "HTTP/1.1 GET /static/favicon.ico" - 200
<ip#> - [18/Oct/2013 22:03:02] "HTTP/1.1 GET /favicon.ico" - 303 See Other
<ip#> - [18/Oct/2013 22:03:03] "HTTP/1.1 GET /static/favicon.ico" - 304 Not Modified 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-25T01:52:05.470

就像 Ryan Griggs 建议的那样，但使​​用 /static/favicon.ico 作为 href。

```
<html>
<head>
    <link rel="icon" type="image/png" href="/static/favicon.ico">
    ... 
```

web.py 开发服务器将所有`/static/`URL 映射到目录中的`static/`文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T16:39:35.697

浏览器会自动在您网站的根目录中查找 /favicon.ico 文件。此错误仅表示文件“favicon.ico”不存在。只需创建一个图标文件（或从众多 favicon 创建者站点之一下载一个）并将其放置在您网站的根 Web 目录（public_html 等）中。

要获得更好的解决方案，请编辑网页的 HTML 以包含指向网站图标文件的特定链接：

```
<html>
<head>
    <link rel="icon" type="image/png" href="http://example.com/myicon.png">
    ... 
```

见[http://www.w3.org/2005/10/howto-favicon](http://www.w3.org/2005/10/howto-favicon)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T23:57:24.820

由于`web.py`限制您只能使用`/static`静态数据的路径，因此实际上没有办法正确地为`favicon`开发服务器提供服务。摆脱 404 日志的最好方法是在映射中添加一个 url 处理程序：

```
urls = ("/favicon.ico", "dummy") 
```

并且在`dummy`处理程序中只传递一个空的 200 响应。

# mysql - MySQL：减少 MyISAM 表的 ibdata 文件大小

> ID：11635383
> 
> 赞同：4
> 
> 时间：2012-07-24T16:34:37.837
> 
> 标签：mysql

我的问题实际上与这个问题非常相似，并且还包括对 InnoDB Engine 表案例的一个很好的答案：

[https://dba.stackexchange.com/questions/8982/is-there-any-best-way-to-reduce-the-size-of-ibdata-in-mysql/8983#8983](https://dba.stackexchange.com/questions/8982/is-there-any-best-way-to-reduce-the-size-of-ibdata-in-mysql/8983#8983)，

我注意到 drop schema 不会缩小 ibdata 文件，因此我寻找了一种配置 DB 的方法，以便在删除 schema 后减小大小。

我发现许多链接都在谈论 InnoDB 以及每个文件保存表的方式，以便它自己的 .frm 文件将包含表数据并且它会被减少。

但是 MyISAM 表（表大小超过 5G）会发生什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:41:34.010

ibdata1 和 MyISAM 是互斥的。

您应该做的第一件事是计算有多少表同时使用这两种存储引擎：

```
SELECT COUNT(1) EngineCount,engine
FROM information_schema.tables
WHERE table_schema NOT IN ('information_schema','performance_schema','mysql')
GROUP BY engine; 
```

### 如果某些表是 InnoDB：

执行我的 InnoDB 清理

*   [Howto：清理 mysql InnoDB 存储引擎？](https://stackoverflow.com/questions/3927690/howto-clean-a-mysql-innodb-storage-engine/4056261#4056261)
*   [https://dba.stackexchange.com/questions/8982/is-there-any-best-way-to-reduce-the-size-of-ibdata-in-mysql/8983#8983](https://dba.stackexchange.com/questions/8982/is-there-any-best-way-to-reduce-the-size-of-ibdata-in-mysql/8983#8983)

### 如果您只有 MyISAM 表而没有 InnoDB 表：

首先，消除 InnoDB 的任何痕迹 执行以下操作：

STEP01) 将此添加到 my.cnf

```
[mysqld]
skip-innodb 
```

STEP02)`service mysql restart`

STEP03)`rm -f /var/lib/mysql/ibdata1 /var/lib/mysql/ib_logfile*`

在这些步骤之后，您可以像这样执行每个 MyISAM 表的压缩：

对于 MyISAM 表 mydb.mytable，只需运行以下命令之一：

*   `OPTIMIZE TABLE mydb.mytable;`
*   `ALTER TABLE mydb.mytable ENGINE=MyISAM; ANALYZE TABLE mydb.mytable;`

如果你想对所有 MyISAM 表进行碎片整理，这里有一个 shell 脚本可以做到这一点......

```
MYSQL_USER=root
MYSQL_PASS=rootpassword
MYSQL_CONN="-u${MYSQL_USER} -p${MYSQL_PASS}"
SQL="SELECT CONCAT('OPTIMIZE TABLE ',table_schema,'.',table_name,';') "
SQL="${SQL} FROM information_schema.tables "
SQL="${SQL} WHERE engine='MyISAM' AND table_schema NOT IN "
SQL="${SQL} ('information_schema','performance_schema','mysql')"
mysql ${MYSQL_CONN} -ANe"${SQL}" > GlobalMyISAMOptmizeTable.sql
less GlobalMyISAMOptmizeTable.sql 
```

一旦您在视觉上信任脚本，只需运行它

```
mysql ${MYSQL_CONN} < GlobalMyISAMOptmizeTable.sql 
```

试试看 ！！！

### **更新 2012-07-25 09:52 EDT**

我想澄清我对 MyISAM 压缩的建议之一

我之前说过

*   `OPTIMIZE TABLE mydb.mytable;`
*   `ALTER TABLE mydb.mytable ENGINE=MyISAM; ANALYZE TABLE mydb.mytable;`

这些命令在机械上是相同的。`OPTIMIZE TABLE`执行 MyISAM 表的碎片整理，然后运行`ANALYZE TABLE`以计算新的索引统计信息。

从机械上讲，这就是`ALTER TABLE mydb.mytable ENGINE=MyISAM;`：

```
CREATE TABLE mydb.mytabletmp LIKE mydb.mytable;
INSERT INTO mydb.mytabletmp SELECT * FROM mydb.mytable;
ALTER TABLE mydb.mytable RENAME mydb.mytablezap;
ALTER TABLE mydb.mytabletmp RENAME mydb.mytable;
DROP TABLE mydb.mytablezap; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:16:25.233

如前所述，MyISAM 不应该使用 ibdata。您的 my.cnf 或 MySQL shell 类型中的 innodb 设置是什么：

```
 SHOW VARIABLES LIKE "%innodb%"; 
```

是否设置了这些变量？

```
 innodb_data_home_dir
    innodb_data_file_path 
```

如果您根本不使用 INNODB，您应该能够安全地删除 ibdata 和 ib_logfile(s) 并重新启动 MySQL。通常，尽管在不首先删除表的情况下删除这些会导致问题。请参阅[如何在 MySQL 中收缩/清除 ibdata1 文件](https://stackoverflow.com/questions/3456159/how-to-shrink-purge-ibdata1-file-in-mysql)

如果您确实有超过 5Gigs 的 MyISAM 表，建议您还是使用 INNODB。（任何超过 4 Gigs）。要排除故障，您可以尝试添加

```
 skip-innodb 
```

如果您根本不使用 INNODB，请在 my.cnf 中。

# iphone - 我的 UITableViewCell 中没有文字

> ID：11635385
> 
> 赞同：0
> 
> 时间：2012-07-24T16:34:45.900
> 
> 标签：iphone, objective-c, ios, xcode

刚刚创建了一个 UITableView，

试图从数组中显示一些自定义数据，但无论我做什么，我都没有显示任何文本。

NSLog 告诉我正确的文本和正确的数量，但表格单元格中没有文本。

这是代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = @"test";

    [self configureCell:cell atIndexPath:indexPath];
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:40:40.500

检查事项：

`cellForRowAtIndexPath`被叫了吗？在里面放一个断点

在 ViewDidLoad (property, alloc'd) 中创建一个数组，`addObjects @"One", @"Two", @"Three", nil`然后`cell.textLabel.text = [theArray objectAtIndex:indexPath.row];`

如果`cellForRow`被调用，这将显示在单元格中。做什么`ConfigureCell`？请包括代码。

还要检查您的 tableView 委托方法是否被调用（`NumberofRowsInSection`等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:20:30.090

始终在

```
tableView:willDisplayCell:forRowAtIndexPath 
```

委托方法。

UITableView 有时会在从单元格返回后向单元格发送 prepareForReuse

```
tableView:cellForRowAtIndexPath 
```

这会导致单元格重置其标签和图像。

# css - Rails 3 Ajaxful_rating 样式问题

> ID：11635386
> 
> 赞同：0
> 
> 时间：2012-07-24T16:34:47.553
> 
> 标签：css, ruby-on-rails-3, styling, rating-system

我在我的 rails 应用程序中将[ajaxful_rating](https://github.com/edgarjs/ajaxful-rating/) gem 用于用户评分系统，但遇到了一个奇怪的样式问题：

![ajaxful_rating 的星星太多](../Images/ee40fce02281770769bb1c2c7c24989b.png)

如您所见，星星太多了，不应该超过5。我之前在以前的应用程序中使用过Ajaxful_rating，并没有遇到这个问题。我最近开始使用 Twitter Boostrap，但据我所知，没有任何样式冲突，因为我删除了每个 CSS 链接，除了 ajaxful_rating 所需的链接之外，我也遇到了同样的问题。

这是我的看法：

```
<dl>
   <% Upload.by_ratings.limit(5).each do |upload| %>
     <dt><%= link_to truncate(upload.name, :length => 55), upload%></dt>
     <dd><%= upload.user.username %> - <%= ratings_for upload, :static %></dd>
   <% end %>
</dl> 
```

以前有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T11:23:38.053

将 <%= ajaxful_rating_style %> 放在你的 javascripts 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T20:20:28.183

问题是我直接链接到布局中的 css。我忘记了我需要调用辅助方法`ajaxful_rating_style`。

# java - Mybatis关于配置参数的条件

> ID：11635391
> 
> 赞同：1
> 
> 时间：2012-07-24T16:35:15.713
> 
> 标签：java, mybatis

我正在尝试基于来自 mybatis 配置的参数而不是查询参数来创建条件查询片段。像这样的东西：

```
<sql id="frag">
    <if test="col_name != null">
        SELECT * FROM TABLE WHERE ${col.name}=#{value}
    </if>
    <if test="col_name == null">
        SELECT * FROM TABLE WHERE SAMPLECOL=#{value}
    </if>
</sql> 
```

其中的值`col_name`是一个全局参数，在 mybatis 配置读取的 .properties 文件中指定。

显然这不起作用；`${...}`查看源代码，OGNL 表达式评估器似乎不知道配置属性（当我通过SQL进行参数替换时，这些属性正在工作）。有没有人找到办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T12:26:40.650

我发现这是目前不可能的；OGNL 实际上无法访问配置属性。

作为一种解决方法，正如mybatis 邮件列表上的[这篇文章](https://groups.google.com/d/msg/mybatis-user/aQ_yIBNZvW0/BxncrAdSfZkJ)中所建议的那样，我编写了一个简单的拦截器，它读取配置参数并将它们添加到查询参数映射中。不完全干净，但它有效。

拦截器代码：

```
@Intercepts({
    @Signature(type = Executor.class,
    method = "query",
    args = {MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class})})
public class ConfigPropInterceptor implements Interceptor {

    private final Map<String, Object> properties = new HashMap<String, Object>();

    @Override
    public Object intercept(Invocation invocation) throws Throwable {
        Object param = invocation.getArgs()[1];
        if (param instanceof Map) {
            ((Map<String, Object>)param).putAll(properties);
        }
        return invocation.proceed();
    }

    @Override
    public Object plugin(Object target) {
        return Plugin.wrap(target, this);
    }

    @Override
    public void setProperties(Properties properties) {
        for (String p : properties.stringPropertyNames()) {
            this.properties.put(p, properties.getProperty(p));
        }
    }
} 
```

配置 .xml 中的示例用法：

```
<plugins>
    <plugin interceptor="...ConfigPropInterceptor">
        <property name="_issuerLocation" value="${issuer.location}"/>
    </plugin>
</plugins> 
```

使用此设置，我能够`_issuerLocation`像其他所有内容一样测试 OGNL 表达式中的变量。

# android - Android TableLayout 高度没有填满整个屏幕

> ID：11635393
> 
> 赞同：12
> 
> 时间：2012-07-24T16:35:30.993
> 
> 标签：android, tablelayout

我有一个线性布局，其中只有一个 TableLayout。表格布局还有两行，每行两列。第一个表行有两个图像。第二表行有两个按钮。

但这不会显示在整个屏幕上，而只会显示在前半部分，或者可能取决于图像高度。这两个图像实际上是同一个文件，但显示的宽度不同。请帮助...这是布局文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

    <TableLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:stretchColumns="*">

        <TableRow
            android:layout_height="fill_parent">

            <ImageView
                android:id="@+id/tp_image"
                android:layout_width="0dip"
                android:layout_height="fill_parent"
                android:layout_weight="0.9"
                android:scaleType="fitXY"
                android:src="@drawable/images" />

            <ImageView 
                android:id="@+id/s_image"
                android:src="@drawable/images"
                android:layout_width="0dip"
                android:layout_height="fill_parent"
                android:scaleType="fitXY"
                android:layout_weight="0.1"
                />
        </TableRow>
        <TableRow >
            <Button 
                android:id="@+id/button_LC"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/button_LC"/>
            <Button 
                android:id="@+id/button_RC"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/button_RC"/>
        </TableRow>
    </TableLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-24T16:50:13.210

放

```
<TableRow
    android:layout_height="0dp"
    android:layout_weight="1" > 
```

到两个表行或仅到第一行。

# java - Uncaught Ext.Error: You're trying to decode an invalid JSON String: Form Submission using Ext JS and Spring MVC

> ID：11635396
> 
> 赞同：3
> 
> 时间：2012-07-24T16:35:40.500
> 
> 标签：java, spring-mvc, extjs4, form-submit, json

提交我的 Ext JS 表单后，我收到以下错误：

> 未捕获的 Ext.Error：您正在尝试解码无效的 JSON 字符串

**JS：**

```
Ext.onReady(function() {

        var simple = Ext.create('Ext.form.Panel', {

                    frame : true,
                    title : 'Login Form',
                    bodyStyle : 'padding:5px 5px 0',
                    width : 350,
                    fieldDefaults : {
                        msgTarget : 'side',
                        labelWidth : 75
                    },
                    defaultType : 'textfield',
                    defaults : {
                        anchor : '100%'
                    },

                    items : [{
                                fieldLabel : 'User Name',
                                name : 'userName',
                                allowBlank : false,
                                emptyText : 'UserName'
                            }, {
                                fieldLabel : 'Password',
                                name : 'password',
                                allowBlank : false,
                                inputType : 'password',
                                emptyText : 'Password'
                            }],

                    buttons : [{
                        text : 'Save',
                        handler : function() {
                            var form = this.up('form').getForm();
                            form.submit({
                                        url : saveFormUrl
                                    //  waitMsg : 'Sending the info...',
                                    //  success : function(fp, o) {
                                    //      Ext.Msg.alert('Success',
                                    //              'Form submitted.');
                                    //  }
                                    });
                        }
                    }, {
                        text : 'Cancel'
                    }]
                });
        simple.render(document.body);
        simple.getEl().center();
    }); 
```

**控制器类：**

```
@Controller
public class UserController {

private static final Logger logger = LoggerFactory
        .getLogger(TController.class);

private TService tService = null;

@Autowired
public void setTService(TService tService) {
    this.tService = tService;
}

@RequestMapping(value = "/index.html", method = RequestMethod.GET)
public String home() {
    System.out.println("Welcome home!");
    return "login";
}

@RequestMapping(value = "/save-form.html", method = RequestMethod.POST)
public ModelAndView submitData(User user){
    System.out.println("User name:"+user.getUserName());
    ModelAndView mv = new ModelAndView("htmlLinks");
    return mv;
} 
```

**保存-form.html：**

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ page session="false"%>
<c:set var="ctx" value="${pageContext.request.contextPath}" />
<html>
<head>
<title>POC</title>

</head>
<body>
 Welcome User !!
</body>
</html> 
```

我究竟做错了什么？解决办法是什么？我正在使用 Ext JS 4 和 Spring MVC。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T22:31:11.687

根据[文档](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.action.Submit)，`form.submit`看起来响应**需要**是 JSON 或 XML，格式如下：

```
{
    success: true,
    data: {
        url: "http://somewhere",
        someData: "whatever you want"
    }
} 
```

在 JavaScript 的成功处理程序中，您可以引用`o.data.[variable]`以获取自定义数据。

不幸的是，您需要更改`submitData method`（在您的控制器中）以返回上面定义的结构中的 JSON 响应对象。在响应对象中，您可以包含指向`save-form.html`. 然后，您可以在成功处理程序中为它发出额外的 GET 请求。

我不知道这是否可行，因为我没有使用 Ext JS 的经验，但我会设想成功处理程序看起来像这样：

```
success: function(fp, o) {
    Ext.Msg.alert('Success', 'Form submitted.');
    Ext.Ajax.request({
        url: o.data.url,
        method: "GET",
        success: function(response, request) {
            // do whatever you need to with the generated HTML
            alert(response.responseText);
        },
        failure: function(response, request) {
            alert('failed');
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:35:31.537

感谢所有回复。我使用下面的代码解决了它。

```
buttons : [{ 
    text : 'Save', 
    handler : function() { 
        // The getForm() method returns the 
        // Ext.form.Basic instance: 
        var form = this.up('form').getForm(); 
        form.submit(); 
    } 
}, { 
    text : 'Cancel' 
}] 
```

# java - JUnit、JPA、Hibernate 和 Postgres：如何测试？

> ID：11635402
> 
> 赞同：4
> 
> 时间：2012-07-24T16:36:04.800
> 
> 标签：java, hibernate, jakarta-ee, junit, jpa-2.0

我已经被困了一段时间了。我进行了很多搜索，但找不到针对 postgres 数据库测试实体类或 JPA 操作的最简单方法。我已经找到了如何使用 Spring、Mockito 和其他东西，但我找不到使用纯 Java 的最简单方法。

我有以下 JUnit 测试：

```
public class ModelConverterTest {

    private static EntityManagerFactory emf;
    private static EntityManager em;

    public ModelConverterTest() {
    }

    @BeforeClass
    public static void setUpClass() throws Exception {
        emf = Persistence.createEntityManagerFactory("PU");
        em = emf.createEntityManager(); // Retrieve an application managed entity manager
    }

    @AfterClass
    public static void tearDownClass() throws Exception {
        em.close();
        emf.close(); //close at application end
    }

    @Before
    public void setUp() {
         ...    
    }

    @After
    public void tearDown() {
    }

    /**
     * Test of SIMModelToModel method, of class ModelConverter.
     */
    @Test
    public void testSIMModelToModel() {
        System.out.println("SIMModelToModel");
        SIMModel simModel = new PESMModel();
        simModel.addState(testState);
        Model expResult = null;
        Model result = ModelConverter.SIMModelToModel(em, simModel);
        assertTrue(expResult!=null);
        // TODO review the generated test code and remove the default call to fail.
        //fail("The test case is a prototype.");
    }
} 
```

运行它时，我收到以下错误：

```
java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/persistence/PersistenceContextType
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:787)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:447)
    at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
    at java.lang.Class.getDeclaredMethods(Class.java:1808)
    at sun.reflect.annotation.AnnotationType$1.run(AnnotationType.java:104)
    at sun.reflect.annotation.AnnotationType$1.run(AnnotationType.java:101)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.reflect.annotation.AnnotationType.<init>(AnnotationType.java:100)
    at sun.reflect.annotation.AnnotationType.getInstance(AnnotationType.java:84)
    at sun.reflect.annotation.AnnotationParser.parseAnnotation(AnnotationParser.java:221)
    at sun.reflect.annotation.AnnotationParser.parseAnnotations2(AnnotationParser.java:88)
    at sun.reflect.annotation.AnnotationParser.parseAnnotations(AnnotationParser.java:70)
    at java.lang.reflect.Field.declaredAnnotations(Field.java:1033)
    at java.lang.reflect.Field.getDeclaredAnnotations(Field.java:1026)
    at java.lang.reflect.AccessibleObject.getAnnotations(AccessibleObject.java:196)
    at org.junit.runners.model.FrameworkField.getAnnotations(FrameworkField.java:26)
    at org.junit.runners.model.TestClass.addToAnnotationLists(TestClass.java:52)
    at org.junit.runners.model.TestClass.<init>(TestClass.java:45)
    at org.junit.runners.ParentRunner.<init>(ParentRunner.java:73)
    at org.junit.runners.BlockJUnit4ClassRunner.<init>(BlockJUnit4ClassRunner.java:55)
    at org.junit.internal.builders.JUnit4Builder.runnerForClass(JUnit4Builder.java:13)
    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
    at org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:29)
    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
    at org.junit.internal.requests.ClassRequest.getRunner(ClassRequest.java:24)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:51)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68) 
```

我的 persistence.xml 文件是：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="PU" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>jdbc/modelsystemdb</jta-data-source>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties/>
  </persistence-unit>
</persistence> 
```

我应该怎么做才能使测试运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:39:29.280

引用[Maven 存储库中残缺的 Java EE 6 API 的问题以及](http://www.adam-bien.com/roller/abien/entry/trouble_with_crippled_java_ee)Adam Bien 的解决方案：

> 而不是使用

```
<dependency>
  <groupId>javax</groupId>
  <artifactId>javaee-web-api</artifactId>
  <version>6.0</version>
  <scope>provided</scope>
</dependency> 
```

> 您应该使用替代（geronimo、jboss 等）依赖项：

```
<dependency>
   <groupId>org.apache.geronimo.specs</groupId>
   <artifactId>geronimo-ejb_3.1_spec</artifactId>
   <version>1.0</version>
   <scope>provided</scope>
</dependency>
<dependency>
   <groupId>org.apache.geronimo.specs</groupId>
   <artifactId>geronimo-jpa_2.0_spec</artifactId>
   <version>1.0</version>
   <scope>provided</scope>
</dependency> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-21T19:36:10.453

有类似的问题。即，即使 Hibernate JPA jar 通过传递依赖项可用并且提供了 javaee 6.0 依赖项，JUNIT 测试用例也失败了。我只是在 pom 文件的依赖项定义末尾移动了 javaee 依赖项，以便在类路径解析期间休眠 JPA api jar 出现在 Javaee jar 之前。这似乎起到了作用，我能够运行测试用例。希望这可以帮助。

```
 <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>${hibernate.version}</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>${hibernate.version}</version>
    </dependency> 
```

javaee出现在hibernate依赖之后

```
<dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:00:58.150

如果你想在你的测试中使用 JPA，那么当你运行它们时，你需要在类路径上有一个 JPA 提供者。您可以针对 进行编译`javaee-api`，但您必须在运行时拥有一个真实的、实时的提供程序。

您提到您正在使用 GlassFish；它使用 EclipseLink 作为它的提供者，所以对你的测试做同样的事情是有意义的。在他们的 wiki 上有[关于通过 Maven 使用 EclipseLink 的信息。](http://wiki.eclipse.org/EclipseLink/Maven)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-19T11:31:05.193

我们有一个非常相似的问题：Junit 测试在 maven 构建期间成功执行，但是尝试从 Eclipse 直接运行它们显示了这个可怕的“缺少代码”错误。解决方案不在 pom.xml-s 中（它们必须是正确的，因为您的构建运行，对吧？），而是在 eclipse 中执行 Junit 的配置。在我们的例子中，当将 maven 依赖项移到项目本身之上时，会加载正确的实现（eclipselink 2.0.4）持久性类。因此，在 Eclipse 中尝试检查“运行配置...”，选择有问题的 Junit 配置，然后在“类路径”选项卡上，更改“用户条目”部分中库的顺序：将 Maven 依赖项移到顶部。

最好的问候，乔公众

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-24T10:52:31.930

在我的情况下，在项目的运行配置/类路径下，单击编辑并选中“仅包含导出的条目”即可。

# c# - 在 VS 2010 中扩展文件重命名

> ID：11635408
> 
> 赞同：2
> 
> 时间：2012-07-24T16:36:20.580
> 
> 标签：c#, visual-studio-2010, resharper, perforce, resharper-5.1

我希望能够**在 VS**中重命名具有关联文件的**类**，而不会丢失Perforce 中的文件历史记录。我想我可以在 Visual Studio 的文件重命名或 ReSharper 的类重命名中包含一个 Perforce 命令（p4 move...）。

 **我看到 3 个选项：

## 包装 Visual Studio 的文件重命名

**我通过自己的 VS 插件**或包装现有*重命名*菜单命令并调用*p4 move...*的宏扩展文件重命名（我的意思是文件重命名：在解决方案资源管理器中右键单击文件并选择重命名。）。

## 扩展 Visual Studio 的文件重命名

我通过任何类型的挂钩到现有的*重命名*命令来扩展文件重命名。

## 扩展 ReSharper 的类重命名

我通过调用*p4 move...*来扩展 ReSharper 的*类重命名*操作（*Ctrl+R,R*）（启用选项：*根据更改同步文件名*） 。

 *哪个选项是在 VS 中重命名具有关联文件的类而不丢失 Perforce 中的文件历史记录的最佳选项？

我没有使用 VS 插件和 ReSharper 插件的经验。因此，如果有人知道根本不可能选择一个选项，那么提示会对我有很大帮助。

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:54:06.103

Git 可以很好地处理这些类型的更改。您能否转而使用 Git 进行开发并使用[Git-P4](http://kb.perforce.com/article/1417/git-p4)将源代码导入 Perforce？我不知道 Perforce，所以我不确定这个解决方案的效果如何，但它绝对值得研究。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T12:30:25.817

您可以在 VS 2010 中扩展文件重命名，方法是使用**宏**将“p4 move -k”操作添加到**重命名事件**。请参阅[“如何在使用 Perforce 在 Visual Studio 中重命名文件时保留更改历史记录”的答案](https://stackoverflow.com/a/11647828/1187616)。当您在 Visual Studio 中执行任何重命名或移动操作时，
此宏会自动调用*p4 重命名/移动。*因此，您将文件历史记录保存在 Perforce 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T14:08:58.577

你有新的 P4VS 插件吗？我相信它很好地支持重命名。***

# dynamics-crm-2011 - 功能区按钮应根据潜在客户状态隐藏 - CRM 2011

> ID：11635412
> 
> 赞同：1
> 
> 时间：2012-07-24T16:36:41.423
> 
> 标签：dynamics-crm-2011

我在铅带中有自定义按钮。当潜在客户合格时，应隐藏自定义按钮。我怎样才能做到这一点？任何人都可以解释一下。我很感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T15:28:33.277

您实际上可以使用内置`DisplayRule`功能完全完成此操作。当 a`Lead`符合条件时，该`StatusCode`属性设置为“Qualified”，即`OptionSet`值“3”。您可以在 a 中检查此属性的值`ValueRule`并适当地显示/隐藏控件。我可以想到两种方法来实现这一点：

**Erik Pool 的可视化功能区编辑器** ![带领](../Images/e66ca9e194c1aeaca7b535441ccdee12.png)

**功能区Xml**

```
<RibbonDiffXml>
  <CustomActions>
    <CustomAction Id="CompanyName.Form.lead.MainTab.Actions.Sample.CustomAction" Location="Mscrm.Form.lead.MainTab.Actions.Controls._children" Sequence="41">
      <CommandUIDefinition>
        <Button Id="CompanyName.Form.lead.MainTab.Actions.Sample" Command="CompanyName.Form.lead.MainTab.Actions.Sample.Command" Sequence="29" ToolTipTitle="$LocLabels:CompanyName.Form.lead.MainTab.Actions.Sample.LabelText" LabelText="$LocLabels:CompanyName.Form.lead.MainTab.Actions.Sample.LabelText" ToolTipDescription="$LocLabels:CompanyName.Form.lead.MainTab.Actions.Sample.Description" TemplateAlias="isv" />
      </CommandUIDefinition>
    </CustomAction>
  </CustomActions>
  <Templates>
    <RibbonTemplates Id="Mscrm.Templates"></RibbonTemplates>
  </Templates>
  <CommandDefinitions>
    <CommandDefinition Id="CompanyName.Form.lead.MainTab.Actions.Sample.Command">
      <EnableRules />
      <DisplayRules>
        <DisplayRule Id="CompanyName.Form.lead.MainTab.Actions.Sample.Command.DisplayRule.ValueRule" />
      </DisplayRules>
      <Actions>
        <Url Address="http://www.bing.com" />
      </Actions>
    </CommandDefinition>
  </CommandDefinitions>
  <RuleDefinitions>
    <TabDisplayRules />
    <DisplayRules>
      <DisplayRule Id="CompanyName.Form.lead.MainTab.Actions.Sample.Command.DisplayRule.ValueRule">
        <ValueRule Field="statuscode" Value="3" />
      </DisplayRule>
    </DisplayRules>
    <EnableRules />
  </RuleDefinitions>
  <LocLabels>
    <LocLabel Id="CompanyName.Form.lead.MainTab.Actions.Sample.LabelText">
      <Titles>
        <Title languagecode="1033" description="Sample" />
      </Titles>
    </LocLabel>
    <LocLabel Id="CompanyName.Form.lead.MainTab.Actions.Sample.Description">
      <Titles>
        <Title languagecode="1033" description="Sample Description" />
      </Titles>
    </LocLabel>
  </LocLabels>
</RibbonDiffXml> 
```

# sql-server - 使用特定时间的今天日期构造 DateTime

> ID：11635428
> 
> 赞同：9
> 
> 时间：2012-07-24T16:37:42.133
> 
> 标签：sql-server, sql-server-2008-r2

我想获取当天的下午 4:30。以这种方式硬编码不起作用：

```
SELECT '07242012 16:30:00.000' 
```

事实证明，这比我想象的要困难得多。我该如何处理？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-24T16:38:54.773

SQL Server 2000 / 2005：

```
SELECT DATEADD(MINUTE, 30, DATEADD(HOUR, 16, DATEDIFF(DAY, 0, CURRENT_TIMESTAMP)));

-- or

SELECT DATEADD(MINUTE, (16*60) + 30, DATEDIFF(DAY, 0, CURRENT_TIMESTAMP))

-- or

SELECT CONVERT(DATETIME, CONVERT(CHAR(9), CURRENT_TIMESTAMP, 112) + '16:30'); 
```

SQL Server 2008+：

```
SELECT CONVERT(DATETIME, CONVERT(DATE, CURRENT_TIMESTAMP)) + '16:30'; 
```

SQL Server 2012：

```
SELECT SMALLDATETIMEFROMPARTS(YEAR(GETDATE()), MONTH(GETDATE()), DAY(GETDATE()), 16, 30); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-10T11:38:55.620

可能最简单的做法是将当前日期/时间转换为日期（剥离时间），将其转换回日期时间以允许使用日期时间的重载`+ (plus)`，最后将所需的文本时间转换为日期时间。如下：

```
select cast(cast(sysutcdatetime() as date) as datetime) + cast('16:30' as datetime) 
```

返回（2018 年 1 月 11 日运行时）：

```
2018-01-11 16:30:00.000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-02T15:36:37.913

您可以根据需要使用日、小时、分钟等来构建它。

```
SELECT CURDATE() - interval 1 DAY + interval 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-25T14:03:36.947

```
 select(dateadd(day, datediff(day, 0, getdate()), 0) + '20:00') as specified_date 
```

> 指定日期 - 输出列名
> 
> 20:00 - 指定时间（24 小时制 - 默认）
> 
> getdate() - 获取今天的日期。

# android - 如果当前活动可以处理 NFC，则不显示 App Picker

> ID：11635430
> 
> 赞同：1
> 
> 时间：2012-07-24T16:37:51.780
> 
> 标签：android, android-intent, nfc

我正在为工作编写一些支持 NFC 的应用程序。我的平板电脑上现在有两个，如果检测到 NFC 标签并且它们尚未打开，它们将启动。因此，由于我在同一台设备上有两个，现在我得到了一个 App Picker 对话框。这很棒。

我想做的是，如果其中一个应用程序已经打开，当检测到 NFC 标签时，它不会显示应用程序选择器，而只是使用当前活动来处理 NFC 意图。这怎么可能？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:08:32.893

如果前台活动正在使用[`enableForegroundDispatch()`](http://developer.android.com/reference/android/nfc/NfcAdapter.html#enableForegroundDispatch%28android.app.Activity,%20android.app.PendingIntent,%20android.content.IntentFilter%5B%5D,%20java.lang.String%5B%5D%5B%5D%29)，它将优先于在清单中为标记注册的任何其他内容。

[这是一个示例应用程序](https://github.com/commonsguy/cw-omnibus/tree/master/NFC/URLTagger)，它演示了如何使用`enableForegroundDispatch()`, 将从另一个应用程序（例如，来自浏览器的 URL）共享的文本写入 NFC 标签。

# alfresco - 内容服务返回旧内容一段时间

> ID：11635433
> 
> 赞同：2
> 
> 时间：2012-07-24T16:38:08.363
> 
> 标签：alfresco

我正在使用以下代码段来保存内容：

```
private void writeToFile(NodeRef nodeRef, String content) throws IOException {
    ContentWriter writer = contentService.getWriter(nodeRef, ContentModel.PROP_CONTENT, true);
    InputStream contentStream = new ByteArrayInputStream(content.getBytes(encoding));

    writer.setMimetype(mimeType);
    writer.setEncoding(encoding);
    writer.putContent(contentStream);

    Map<QName, Serializable> repoProps = nodeService.getProperties(nodeRef);

    ContentData contentData = (ContentData) repoProps.get(ContentModel.PROP_CONTENT);
    if(contentData == null)
        contentData = writer.getContentData();

    contentData = ContentData.setEncoding(contentData, encoding);
    contentData = ContentData.setMimetype(contentData, mimeType);
    repoProps.put(ContentModel.PROP_CONTENT, contentData);

    contentStream.close();

    nodeService.setProperties(nodeRef, repoProps);
} 
```

当我在其他地方在短时间内（取决于服务器负载）读取以这种方式编写的内容时，会返回旧内容。所以看起来索引可能正在进行中，所以在最终提交旧内容返回之前，这可能吗？如果是这样，是否可以覆盖此行为并访问最新的可能内容？通过内容网址？

为了避免这种行为，我为每个读取请求使用线程，它在开始时会休眠一段时间，但我真的不喜欢这个“解决方案”。

编辑：我从最新的 SVN 源代码构建，在 Linux（CentOS 和 Ubuntu）上的 Tomcat 6.0.35 上运行；系统负载 - 我的意思是每隔几秒钟就有数百个文件发生变化。

编辑：阅读看起来像这样：

```
private byte[] readFileContent(NodeRef nodeRef) throws IOException {
    ContentReader reader = contentService.getReader(nodeRef, ContentModel.PROP_CONTENT);

    if(reader == null)
        return null;

    InputStream originalInputStream = reader.getContentInputStream();
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

    final int BUF_SIZE = 1 << 8; // 1KiB buffer
    byte[] buffer = new byte[BUF_SIZE];
    int bytesRead = -1;

    while ((bytesRead = originalInputStream.read(buffer)) > -1) {
        outputStream.write(buffer, 0, bytesRead);
    }

    originalInputStream.close();

    return outputStream.toByteArray();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T15:22:00.103

好的，通过更简单的保存解决了，如下所示：

```
ContentWriter writer = contentService.getWriter(nodeRef, ContentModel.PROP_CONTENT, true);
InputStream contentStream = new ByteArrayInputStream(content.getBytes(encoding));

writer.setMimetype(mimeType);
writer.setEncoding(encoding);
writer.putContent(contentStream);

contentStream.close(); 
```

由于一些内容编码问题，之前的保存已经到位，因此测试显示这是否有效。

# javascript - 如何挂钩由 Brightcove 托管视频结束触发的事件？

> ID：11635436
> 
> 赞同：2
> 
> 时间：2012-07-24T16:38:08.910
> 
> 标签：javascript, jquery, video, brightcove, appcloud

当用户单击带有播放按钮的图像时，我有以下代码显示 Brightcove 播放器：

```
$(document).ready(function() {
    $('#performanceVideo').hide();
    $('#banner_text_wrap').click(function(e) {
        e.preventDefault();
        $('banner-image').hide().fadeOut(slow);
        $('#performanceVideo').show().fadeIn(slow).css({'float':'left','margin-top':'-251px'});
    });
}); 
```

我想在视频结束时将图像淡入。如何使用 jQuery 挂钩视频结束事件？阅读我认为我需要包含`addEventListener`在代码中的文档，但我是 JavaScript 新手，因此不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T20:00:38.337

将这两个参数添加到您的播放器片段中：

```
<param name="includeAPI" value="true" />
<param name="templateLoadHandler" value="myTemplateLoaded" /> 
```

然后添加一个与您在代码片段参数中为 templateLoadHandler 提供的值相匹配的 javascript 函数，以便为 videoPlayers 结束事件设置事件侦听器。

```
function myTemplateLoaded(experienceID){
  player = brightcove.api.getExperience(experienceID);
  modVP = player.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER);
  modVP.addEventListener(brightcove.api.events.MediaEvent.COMPLETE,onMediaComplete);
} 
```

然后在完成事件触发时隐藏播放器：

```
function onMediaComplete(evt){
  $('#performanceVideo').hide();
  $('banner-image').show().fadeIn(slow);
} 
```

# linq - 从项目列表中选择单个随机项目

> ID：11635437
> 
> 赞同：0
> 
> 时间：2012-07-24T16:38:11.077
> 
> 标签：linq, linq-to-sql, random

我有一个返回结果列表的查询。我想要该列表中的一个随机项目。

```
var query = (from...
            where...
            select q).Random(1); //Something like this? 
```

这个怎么做？假设有 1 个项目我希望选择该项目。如果还有更多，那么我希望以随机顺序选择其中一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:40:17.003

```
var query = (from...
            where...
            orderby Guid.NewGuid()
            select q).First(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:43:20.357

您可以将[`Shuffle`](https://stackoverflow.com/a/1262619/259656)发布在[C# 中的随机列表中](https://stackoverflow.com/questions/273313/randomize-a-listt-in-c-sharp)的示例与 LINQ`Take`方法结合使用在 上创建扩展方法`IList<T>`，您需要`ToList`在调用之前进行选择`Random`，除非您将其移动到扩展中。

```
public static List<T> Random<T>(this IList<T> list, int takeNumber)
{
    return list.Shuffle().Take(takeNumber);
}

public static List<T> Shuffle<T>(this IList<T> list)  
{  
    Random rng = new Random();  
    int n = list.Count;  
    while (n > 1) {  
        n--;  
        int k = rng.Next(n + 1);  
        T value = list[k];  
        list[k] = list[n];  
        list[n] = value;  
    }

    return list;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-04T20:04:40.357

这种随机播放方法比其他答案更好。链接时不会产生任何性能问题，而且它仍然是 LINQ。

```
public static IEnumerable<T> TakeRandom<T>(this IEnumerable<T> source, int count)
{
    return source.Shuffle().Take(count);
}

public static IEnumerable<T> Shuffle<T>(this IEnumerable<T> source)
{
    return source.OrderBy(x => Guid.NewGuid());
} 
```

用法：

```
var query = (from...
        where...
        select q).TakeRandom(1); 
```

# tridion - 通知用户有关工作流项目的更好方法

> ID：11635439
> 
> 赞同：5
> 
> 时间：2012-07-24T16:38:16.163
> 
> 标签：tridion, tridion-2011

我想通过通知通知用户他们的工作项目的分配列表/状态。

除了发送电子邮件通知，是否可以在 Tridion 本身中显示通知？例如：在快捷方式--> mytasks 下有新项目，如“通知”？

或者有没有更好的方法来通知用户除了电子邮件通信，因为用户不想在他们的邮箱中收到这么多邮件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T19:26:44.427

一般来说，我喜欢将工作流通知分为两大类——主动和被动。在活动通知下，我实际上只包括电子邮件通知，但您可以将概念扩展为将通知推送到 iphone 应用程序或发送短信等。在考虑活动通知时，用户厌倦了太多是很常见的来自系统的警报，因此重要的是以灵活的方式设计它，让您的用户不会感到被警报轰炸。我实现的最成功的实现允许用户说出他们收到通知的频率。通常，他们将此设置为每 24 小时一次，并且他们每天早上都会收到一封关于待处理任务的摘要电子邮件。这允许非常活跃并定期使用他们的任务列表的用户永远不会收到电子邮件，

转向被动通知形式，如果您记住可以使用 SDL 提供的 API 公开用户的任务列表，您可以考虑实现以下形式的被动通知：

*   为用户的分配列表创建 RSS 提要
*   为公司 Intranet 创建一个 Widget/Portlet 以向用户显示他们的分配
*   创建某种可以提取数据的桌面或移动应用程序
*   将 CMS 的默认启动屏幕设置为任务列表而不是仪表板

这些选项中的最后一个选项长期以来一直是 Tridion 的“开箱即用”产品（但我认为它在 Tridion 2009 或 2011 的某个时候被错误地放弃了。但是，@Alvin 最近回答了我的另一个[*questions*](https://stackoverflow.com/questions/11958962/is-it-possible-to-default-to-main-view-of-the-sdl-tridion-2011-cme-instead-of)，这可能有助于解决这个问题（尽管它可能不受支持）。基本上你可以将`<defaultpage>`CME.config 中的节点设置为`/Views/Dashboard/Dashboard.aspx#locationId=cme:workitems`。这将使 UI 自动在工作列表上打开**（但我重复......这可能不被支持）**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T17:27:28.527

是的。显示快捷方式的项目列表是可扩展的，就像我在 Tridion GUI 中查看的所有其他列表一样。

查看[Jaime 的这篇博文](http://jaimesantosalcon.blogspot.com/2012/04/sdl-tridion-2011-data-extenders-real.html)以开始使用。如何扩展的主题也包含在[这个问题](https://stackoverflow.com/questions/10486726/can-the-list-of-favorites-be-extended-using-a-data-extender)中，但 Jaime 的教程可能是一个更好的起点。

一旦您获得了编写此扩展程序的经验，您可能会遇到类似于[Nuno 在这里提出的问题](https://stackoverflow.com/questions/9995335/)（Jaime 和 Boris 熟练地回答了这个问题）。

# python - python中的API挂钩可以与操作系统无关吗？

> ID：11635443
> 
> 赞同：6
> 
> 时间：2012-07-24T16:38:26.783
> 
> 标签：python, python-3.x

在使用 Python 进行渗透测试的世界中，看起来人们通常必须连接到特定于操作系统的 API。这对我来说很有意义，因为我们正在处理 OSX、Linux、Windows 之间的不同架构和内核。但我想知道如果不是这样吗？

除了您从操作系统模块中获得的一些有限功能之外，我的假设是，与 Windows 相比，与操作系统的 API 挂钩通常会特定于 *POSIX 风格（也许它们有更多共同点）。

特别是我正在考虑 Windows 上的 Deviare。它处理 .DLL 文件。这几乎是Windows。当我们听到 DLL 时，脑海中浮现的是 windows 领域、.plist OS X 等等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T17:22:15.580

`Hook`ing 是一种让您自己的代码在另一个系统运行时执行的方法，无论该系统是操作系统、GUI 还是其他系统。Python中的一个有点愚蠢的例子：

```
def Process(records, per_record_hook=None):
    "adds all records to XYZ system"
    XYZ = []
    for record in records:
        if per_record_hook:
            per_record_hook(record)
        XYZ.append(record)

def print_record(record):
    "print a '.' for each record (primitive counter)"
    print '.' 
```

然后：

```
Process(records_from_somewhere, per_record_hook=print_record) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:00:42.597

[http://en.wikipedia.org/wiki/Hooking](http://en.wikipedia.org/wiki/Hooking)

我假设您指的是这种 ^ 类型的挂钩？我对这个术语完全不熟悉，但您似乎正在寻找一个允许与操作系统交互的库？

如果是这样，请尝试 PyWin32（google it）或遵循此处找到的一些技术： [http ://www.rohitab.com/discuss/topic/37018-api-hooking-in-python/](http://www.rohitab.com/discuss/topic/37018-api-hooking-in-python/)

同样，如果您可以将它（短语 hooking）放入更多... Python 式的术语中会更有帮助，但我希望这会有所帮助？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T21:41:39.283

在 Python 中，这样的事情通常是微不足道的，甚至很难提供示例。钩子通常是回调，是的。python 中的回调只是通过传递函数并调用它们来完成。

# javascript - Javascript 未在 Chrome 上显示 DIV，适用于 Firefox

> ID：11635445
> 
> 赞同：1
> 
> 时间：2012-07-24T16:38:29.187
> 
> 标签：javascript, ajax, google-chrome, spinner

我对这段代码有点麻烦：

包含 .gif 微调器的 div **ajaxImage**应该在我调用此函数时显示，并在该过程完成时隐藏。当我在 Firefox 上时，微调器可以正确显示和隐藏，但在 Chrome 上不起作用。任何想法为什么会发生这种情况？谢谢。

```
function searchSegments(){

    document.getElementById('ajaxImage').style.display='block';
    var lat = mainMarker.getPosition().lat();
    var lng = mainMarker.getPosition().lng();
    var url = 'index.php?option=com_socialgo';

    var ajax = new Request.JSON({
            url: url,
            method: 'get',
            async: false,
            data:{
                'lat': lat,
                'lng': lng,
                "format":"raw",
                "option":"com_socialgo",
                "task":"ajaxsegments.getSegmentsByEvent",
                "tmpl":"component"  
            },
            onComplete: function(jsonResponse){
                setMacroSegments(jsonResponse);
                document.getElementById('ajaxImage').style.display='none';                  
            }             
    }).send();
} 
```

# c# - WCF 中的 Windows 凭据出错：SecurityNegotiationException

> ID：11635446
> 
> 赞同：0
> 
> 时间：2012-07-24T16:38:39.543
> 
> 标签：c#, asp.net, .net, wcf

我将 ClientCredientialType 指定为用户名，但使用 Windows 对其进行验证所以即使提供了正确的 Windows 凭据，我也会收到错误消息。

**我在服务端使用以下配置**：-

![在此处输入图像描述](../Images/502ad92574d979a449f38a5fa29cdb83.png) 和以下

**注意：ClientCredientialType=" `UserName`" 和 userNamePasswordValidationMode=" `Windows`"**

正如我想要的那样，该客户端应提供用户名和密码（凭据），这些用户名和密码（凭据）应由服务端的 Windows 进行验证。

**这是自动生成的客户端配置**：-

![在此处输入图像描述](../Images/cbbdbac0d8a70355a104c577cc456d89.png)

**这是调用服务的客户端代码**：-

![在此处输入图像描述](../Images/3658d0e356cb0e280df75dcf0e360e59.png)

但是，即使我输入了正确的用户名和密码（Windows 凭据），我仍然收到以下错误：-

![在此处输入图像描述](../Images/8f77c4183895fac03b7c65c42e309520.png)

谁能告诉我出了什么问题。另请注意，我尝试了相同的使用**`negotiateServiceCredential="true"`**以及**`negotiateServiceCredential="false"`** 但得到相同的错误。

有没有人可以帮忙啊。。。。。。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T04:43:25.467

很好，我找到了解决我面临的问题的方法。当我在客户端使用以下行为配置时：-

![在此处输入图像描述](../Images/ef2833119285ade4ac5c0ad2e9d78730.png)

但我没有在端点中使用它。所以它抛出了谈判异常。因为它试图验证证书，但没有为端点指定验证模式。

**在端点中使用名为“ echoClaimBehavior** ”的行为配置后，它不会验证服务器证书。

感谢**@Oscar Jara**，他建议查看完整的异常消息而不仅仅是类型。

这清楚地向我展示了幕后出了什么问题。

# c# - C# winform，我可以像这样访问 GroupBox 内的控件：myGroupBox.InnerTextBox.Text "someText";？

> ID：11635450
> 
> 赞同：0
> 
> 时间：2012-07-24T16:38:58.543
> 
> 标签：c#, winforms

我有一个`GroupBox`有 3`TextBoxes`和 3`Labels` 的组框的名称是 TextInfoGroupBox .. 我正在尝试访问其中的文本框，但我似乎不知道如何.. 我尝试了类似的东西：

```
TextInfoGroupBox.innerTextbox;
TextInfoGroupBox.Controls.GetChildControl; 
```

这两个都没有出现在智能中..我怎样才能接触到它们，设置并从它们那里获取数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:42:12.073

您可以像访问任何其他控件一样访问它们：

```
innerTextBox 
```

无论嵌套如何，Visual Studio 设计器都会为您放入表单中的每个控件生成一个字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:41:06.250

`Controls`为此目的使用集合。您将需要确切知道该集合中的哪个项目是您的 TextBox。如果您的组框中只有 3 个文本框，您可以使用

```
groupBox.Controls[0], groupBox.Controls[1], groupBox.Controls[2] 
```

访问您的项目或仅使用它们各自的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:45:10.357

如果由于某种原因您无法直接访问 innerTextBox，您可以随时进行搜索：

```
 TextBox myTextBox = null;

        Control[] controls = TextInfoGroupBox.Controls.Find("InnerTextBoxName", true);
        foreach (Control c in controls)
        {
            if (c is TextBox)
            {
                myTextBox = c as TextBox;
                break;
            }
        } 
```

在 this 结束时，如果 myTextBox 为空，则找不到（显然）。希望您不要对其进行结构化，以便有多个条目。

您还可以创建一些可爱的扩展方法：

```
public static Control FindControl(this Control parent, string name)
{
    if (parent == null || string.IsNullOrEmpty(name))
    {
        return null;
    }

    Control[] controls = parent.Controls.Find(name, true);
    if (controls.Length > 0)
    {
        return controls[0];
    }
    else
    {
        return null;
    }
}

public static T FindControl<T>(this Control parent, string name) where T : class
{
    if (parent == null || string.IsNullOrEmpty(name))
    {
        return null;
    }

    Control[] controls = parent.Controls.Find(name, true);
    foreach (Control c in controls)
    {
        if (c is T)
        {
            return c as T;
        }
    }

    return null;
} 
```

你可以简单地称它们为

```
 Control c = TextInfoGroupBox.FindControl("MyTextBox");
        TextBox tb = TextInfoGroupBox.FindControl<TextBox>("MytextBox"); 
```

# asp.net-mvc - 通过使用 EF 4.1 DBContext 为 SaveChanges 分配事件处理程序来实现 OnContextCreated 以进行审计

> ID：11635451
> 
> 赞同：4
> 
> 时间：2012-07-24T16:38:59.190
> 
> 标签：asp.net-mvc, entity-framework, edmx-designer

我尝试了许多不同的方法并查看了不同的帖子，但仍然没有遇到这种审计方式的解决方案。下面是我的 DBContext 模板文件。我通过添加`OnContextCreated()`部分方法来自定义它并将`SavingChanges`事件分配给我的`OnSavingChanges`事件处理程序。

```
namespace ARSystem.Models
{
    public partial class ARSEntities : ObjectContext
    {
        public ARSEntities()
            : base("name=ARSEntities")
        {
        }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            throw new UnintentionalCodeFirstException();
        }

        public string UserName { get; set; }
        List<DBAudit> auditTrailList = new List<DBAudit>();

        public enum AuditActions
        {
            I,
            U,
            D
        }

        partial void OnContextCreated()
        {
            this.SavingChanges += new EventHandler(OnSavingChanges);
        }

        public void OnSavingChanges(object sender, EventArgs e)
        {
            IEnumerable<ObjectStateEntry> changes = this.ObjectStateManager.GetObjectStateEntries(EntityState.Added | EntityState.Deleted | EntityState.Modified);
            foreach (ObjectStateEntry stateEntryEntity in changes)
            {
                if (!stateEntryEntity.IsRelationship &&
                        stateEntryEntity.Entity != null &&
                            !(stateEntryEntity.Entity is DBAudit))
                {//is a normal entry, not a relationship
                    DBAudit audit = this.AuditTrailFactory(stateEntryEntity, UserName);
                    auditTrailList.Add(audit);
                }
            }

            if (auditTrailList.Count > 0)
            {
                foreach (var audit in auditTrailList)
                {//add all audits 
                    this.AddToDBAudit(audit);
                }
            }
        }

        private DBAudit AuditTrailFactory(ObjectStateEntry entry, string UserName)
        {
            DBAudit audit = new DBAudit();
            audit.AuditId = Guid.NewGuid().ToString();
            audit.RevisionStamp = DateTime.Now;
            audit.TableName = entry.EntitySet.Name;
            audit.UserName = UserName;

            if (entry.State == EntityState.Added)
            {//entry is Added 
                audit.NewData = GetEntryValueInString(entry, false);
                audit.Actions = AuditActions.I.ToString();
            }
            else if (entry.State == EntityState.Deleted)
            {//entry in deleted
                audit.OldData = GetEntryValueInString(entry, true);
                audit.Actions = AuditActions.D.ToString();
            }
            else
            {//entry is modified
                audit.OldData = GetEntryValueInString(entry, true);
                audit.NewData = GetEntryValueInString(entry, false);
                audit.Actions = AuditActions.U.ToString();

                IEnumerable<string> modifiedProperties = entry.GetModifiedProperties();
                //assing collection of mismatched Columns name as serialized string 
                audit.ChangedColumns = XMLSerializationHelper.XmlSerialize(modifiedProperties.ToArray());
            }

            return audit;
        }

        private string GetEntryValueInString(ObjectStateEntry entry, bool isOrginal)
        {
            if (entry.Entity is EntityObject)
            {
                object target = CloneEntity((EntityObject)entry.Entity);
                foreach (string propName in entry.GetModifiedProperties())
                {
                    object setterValue = null;
                    if (isOrginal)
                    {
                        //Get orginal value 
                        setterValue = entry.OriginalValues[propName];
                    }
                    else
                    {
                        //Get orginal value 
                        setterValue = entry.CurrentValues[propName];
                    }
                    //Find property to update 
                    PropertyInfo propInfo = target.GetType().GetProperty(propName);
                    //update property with orgibal value 
                    if (setterValue == DBNull.Value)
                    {//
                        setterValue = null;
                    }
                    propInfo.SetValue(target, setterValue, null);
                }//end foreach

                XmlSerializer formatter = new XmlSerializer(target.GetType());
                XDocument document = new XDocument();

                using (XmlWriter xmlWriter = document.CreateWriter())
                {
                    formatter.Serialize(xmlWriter, target);
                }
                return document.Root.ToString();
            }
            return null;
        }

        public EntityObject CloneEntity(EntityObject obj)
        {
            DataContractSerializer dcSer = new DataContractSerializer(obj.GetType());
            MemoryStream memoryStream = new MemoryStream();

            dcSer.WriteObject(memoryStream, obj);
            memoryStream.Position = 0;

            EntityObject newObject = (EntityObject)dcSer.ReadObject(memoryStream);
            return newObject;
        }

        public DbSet<Student> Students { get; set; }
        public DbSet<User> Users { get; set; }
        public DbSet<aspnet_Applications> aspnet_Applications { get; set; }
        public DbSet<aspnet_Membership> aspnet_Membership { get; set; }
        public DbSet<aspnet_Roles> aspnet_Roles { get; set; }
        public DbSet<aspnet_SchemaVersions> aspnet_SchemaVersions { get; set; }
        public DbSet<aspnet_Users> aspnet_Users { get; set; }
        public DbSet<vw_aspnet_Applications> vw_aspnet_Applications { get; set; }
        public DbSet<vw_aspnet_MembershipUsers> vw_aspnet_MembershipUsers { get; set; }
        public DbSet<vw_aspnet_Roles> vw_aspnet_Roles { get; set; }
        public DbSet<vw_aspnet_Users> vw_aspnet_Users { get; set; }
        public DbSet<vw_aspnet_UsersInRoles> vw_aspnet_UsersInRoles { get; set; }
        public DbSet<Cours> Courses { get; set; }
        public DbSet<Enrollment> Enrollments { get; set; }
        public DbSet<Modules> Modules { get; set; }
        public DbSet<EnrollmentsByCourse> EnrollmentsByCourse { get; set; }
        public DbSet<EnrollmentsByCourseAudit> EnrollmentsByCourseAudit { get; set; }
        public DbSet<DBAudit> DBAudit { get; set; }
    }
} 
```

但是，当我编译时，我收到以下错误消息：

> 错误 1 ​​'ARSystem.Models.ARSEntities.OnModelCreating(System.Data.Entity.DbModelBuilder)'：找不到合适的方法来覆盖 C:\Users\mngum\Documents\Visual Studio 2010\Projects\ARSystem\ARSystem\Models\ARSystem。上下文.cs 35 33 ARSystem

我在 DBContext 元数据类中看不到 OnContextCreated 方法，但我可以在 edmx 设计器中找到它。请让我知道如何实现该`OnContextCreated()`方法，以便我可以覆盖`SavingChanges`事件以进行审计。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T22:41:32.043

`DbContext`没有`OnContextCreated`事件，但这不是问题，因为您不需要它来实现相同的目标。取而代之的`DbContext`是`SaveChanges`方法是可覆盖的。因此，您使用的不是`OnSavingChanges`事件处理程序：

```
public override int SaveChanges()
{
    // custom code...

    return base.SaveChanges();
} 
```

每当您调用时都会调用此方法`ARSEntities.SaveChanges()`，并且您可以在调用`base.SaveChanges()`base之前执行自定义操作`DbContext`（当然`ARSEntities`必须派生自`DbContext`。）

`ObjectContext`您还可以从以下位置访问底层证券`DbContext`：

```
public override int SaveChanges()
{
    var objectContext = ((IObjectContextAdapter)this).ObjectContext;

    // use methods and properties of ObjectContext now like
    // objectContext.ObjectStateManager, etc.

    // custom code...

    return base.SaveChanges();
} 
```

这是关于使用 EF 4.1/ 进行变更审计的类似问题和答案`DbContext`：

[Entity Framework 4.1 DbContext 覆盖 SaveChanges 以审计属性更改](https://stackoverflow.com/questions/6156818/entity-framework-4-1-dbcontext-override-savechanges-to-audit-property-change)

# php - WordPress - 保留表单字段名称？

> ID：11635456
> 
> 赞同：2
> 
> 时间：2012-07-24T16:39:12.137
> 
> 标签：php, forms, plugins, wordpress

我安装了一个简单的 PayPal 购物车插件：

[http://wordpress.org/extend/plugins/wp-ultra-simple-paypal-shopping-cart/](http://wordpress.org/extend/plugins/wp-ultra-simple-paypal-shopping-cart/)

安装好了。但是，当更新数量或涉及表单发布的任何内容时，WordPress 会返回 404 错误页面。

现在，在调查时，我注意到有人提到 WordPress 内部有一些用于表单字段名称的保留字。

（[http://wordpress.org/support/topic/404-pops-after-custom-form-submission-by-post](http://wordpress.org/support/topic/404-pops-after-custom-form-submission-by-post)）

我跟着这条线索，用 Firebug 即时更改了名称字段并发布了表单。

*一切都张贴到当前页面，它保持在同一页面（如预期）而不是404。*所以看来这确实是一个 WordPress 问题。

有什么方法可以在 WordPress 中为某些名称添加例外作为某种设置？或者，如果有人知道此插件的解决方法，我将不胜感激。

非常感谢您的意见。迈克尔。

**编辑：**

有人也遇到过这个问题。看到这个线程...

[http://www.ultra-prod.com/developpement-support/wp-ultra-simple-paypal-shopping-cart-group3/bugs-errors-help-forum8/404-error-thread76/](http://www.ultra-prod.com/developpement-support/wp-ultra-simple-paypal-shopping-cart-group3/bugs-errors-help-forum8/404-error-thread76/)

关于解决方案的任何想法？我不能简单地重命名我的帖子类型。这适用于已经投入生产并拥有数百种产品的网站。

希望有人可以提供帮助。

# security - 用于匿名日志文件的“用户友好”但安全的算法

> ID：11635458
> 
> 赞同：3
> 
> 时间：2012-07-24T16:39:17.693
> 
> 标签：security, hash, privacy

我有一组 IIS 日志文件，我想发布这些文件用于研究。

但是，这些包含一些我想匿名的敏感信息，例如：

```
UserName=XXXX65 
```

我想使用一种算法，该算法保留一些“用户友好”性来对日志文件进行目视检查，但它也足够安全，无法/不切实际地推导出原始用户名。

我不能只是*** * 排除所有用户名，因为能够关联来自同一用户名的请求在日志中很重要。

使用 SHA1 散列给了我类似的东西

```
UserName=AD5CBF0BA0A8646EBDBA6BE1B5DA4FCB1F385D39 
```

这几乎是可用的，

SHA256 给出：

```
UserName=C9B84EE0DD2EFA53645D5268602E23A9E788903B31BBEB99C03982D9B50AF70C 
```

这开始变得太长而无法使用，

和[PBKDF2-SHA1 散列](http://crackstation.net/hashing-security.htm#properhashing)给出

```
UserName=1000:153JkeeGAqtG2UsHX57RBqm3O0DIkXhF:31BBDlQrUqqeyaMo/ikCJAXRC4fFXf82 
```

在我看来，这太长了，无法使用。

是否有一种算法可以提供相对较短的单向哈希但仍然安全/不可逆？

我正在寻找可以用眼睛扫描日志文件的东西，并且仍然注意到 UserName 相关性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:09:06.280

**一种方式哈希并不是真正的匿名。**为什么？可以很容易地验证哪个用户对应于哪个哈希：

1.  说`"root"`是用户。
2.  你申请`hash("root")`，结果是`foo`。您发布的日志包含对`foo`.
3.  我做了一个聪明的猜测，那`root`就是你机器上的用户。然后我申请`hash("root")`并获得`foo`. 现在我知道哪些日志对应于`"root"`.

所以本质上：当您以后希望能够从已发布的日志中验证某个用户是某个日志的原因时，哈希很有用。当目标是匿名时不是。

**另外，哈希很难阅读。**

**我会生成随机的可发音字符串，并将一个映射到每个用户名。**然后使用随机字符串发布日志。真正匿名且真正可读。

如何产生随机发音的字符串？**交替的辅音和元音。以下是使用 C**的方法（当然，这只产生一个随机的 6 个字符的字符串。在处理日志时，您需要更多的逻辑来处理它，例如：将每个用户名映射到一个字符串，确保字符串是唯一的）：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <time.h>

#define NAME_LENGTH 6

#define RAND_CHAR(string) \
  ( (string)[rand () % strlen (string)])

int main (void)
{
  char vowel[] = "aeiou";
  char consonant[] = "bcdfghjklmnpqrstvwxyz";
  int i;

  char rand_name[NAME_LENGTH + 1];

  srand (time (NULL));

  for (i = 0; i < NAME_LENGTH; i++)
    rand_name[i] = (i % 2) ? RAND_CHAR (vowel) : RAND_CHAR (consonant);

  rand_name[NAME_LENGTH] = '\0';

  printf ("%s\n", rand_name);

  return 0;
} 
```

**这是它为我制作的一些示例：**

*cemala
gogipa
topeqe
lixate
fasota
rironu*

如果您服务的用户数量与*125 * 21 ³*相当，则需要生成更长的字符串，并且可能使用分隔符使其易于发音：

*切马拉戈吉帕*

# javascript - 在 Javascript 中删除或区分触发事件的原因

> ID：11635460
> 
> 赞同：0
> 
> 时间：2012-07-24T16:39:25.220
> 
> 标签：javascript, jquery, internet-explorer, events, japplet

我相信每个 Web 开发人员都遇到过这种情况，但 IE 并没有按照我的意愿执行。目前的问题是它在页面未卸载时触发[onbeforeunload 。](http://msdn.microsoft.com/en-us/library/ie/ms536907%28v=vs.85%29.aspx)我已经在[另一个问题](https://stackoverflow.com/questions/11549856/ie9-firing-onbeforeunload-event-when-the-window-opens)中问过这个问题，并且我已经解决了任何`document.write()`问题、任何锚点以及所有其他导致页面“卸载”的荒谬事情。也就是说，据我所知。该事件仍然在不应该触发的时候触发。

我想知道是否有任何方法可以标记导致事件触发的原因或删除任何会导致事件触发的东西，这有点荒谬。要么防止不得不处理它，要么解决可能导致事件发生的任何事情。

如果答案是简单的“不”，我会垂头丧气，继续尝试解决这个荒谬的浏览器，但我想我会在放弃之前尝试挑选聪明人的大脑。

## 更多信息

我在此页面上使用[jfileupload 。](https://stackoverflow.com/questions/11549856/ie9-firing-onbeforeunload-event-when-the-window-opens)这是事件的代码。`bCancel`设置`false`在页面的最开头，因此除非开始上传，否则不会发生这种情况。`canClose`在开始时设置为`true`，以便取消上传不会要求再次关闭窗口。该事件`onbeforeunload`在文件通过小程序完成上传后立即触发。

```
 document.uploader.setEnabled(true);

        function JSTransferTriggered(){
            bCancel=true;
        }

        function JSTransferDone(){
            bCancel=false;
            window.open("uploads_finished.php",'_self',null);
        }

        function JSTransferCancelled(){
            $.ajax({
               'async': false,
               'type': 'POST',
               'url': 'cancel.php'              
            });
            bCancel=false;
            if(canClose)self.close();
        }
    $(window).load(function(){  
        $(window).bind('beforeunload',function(){
            document.uploader.setEnabled(false);
            if(bCancel){
                canClose=false;
                document.uploader.cancel();
            }           
        });
    }); 
```

当小程序中发生某些事件时，上传者使用类似于等的其他函数`JSTransfertriggered`来调用。`JSTransferDone`这些函数没有被改变，它们所做的只是调用一个`log`如下所示的函数：

```
 function log() {
            var msg = Array.prototype.join.call(arguments, '');

            var match = msg.match(/^([a-zA-Z]+)\((.*)\)/);
            if (match) {
                msg = ["<span class='fname'>", match[1], '</span>',
                       "<span class='p'>(</span>",
                       match[2],
                       "<span class='p'>)</span><br>"].join('');
            }
            //msg = msg.replace(/^[a-zA-Z]+/, "<span class='fname'>$&</span>");

            var elt = document.getElementById('event_log');
            //elt.appendChild(document.createTextNode(msg + "\n"));
            elt.innerHTML += msg;
        } 
```

我并不是说我已经完美或完全清除了所有列出的触发器的页面。我正在尝试找出一种方法来找到*触发*事件的原因，以便修复它。

# css - 如何使浮动元素列表跳过居中元素（脊柱对齐/中心标记）？

> ID：11635461
> 
> 赞同：0
> 
> 时间：2012-07-24T16:39:27.333
> 
> 标签：css, position, alignment, centering, jquery-isotope

我有这个代码：http: [//jsfiddle.net/XXu8G/](http://jsfiddle.net/XXu8G/)

我希望元素与脊柱周围的中心对齐。Isotope jQuery 插件有一个类似的功能叫做脊椎对齐： http: [//isotope.metafizzy.co/custom-layout-modes/spine-align.html](http://isotope.metafizzy.co/custom-layout-modes/spine-align.html)但不幸的是它在每一侧只列出了一个项目。我想在每一边都有多个项目。

如果没有单独的“左”和“右”div，如何实现这些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:10:12.310

此代码适用于 CSS3 浏览器（[**请参阅 fiddle**](http://jsfiddle.net/XXu8G/11/)；注意，在 IE8 及以下版本以及其他不支持它的`nth-child`情况下，必须用每个需要“跳过”脊椎中心的元素上的*类替换）。*需要成为列表的`center-stamp`一部分以使其适合我（但请参阅下面的可选解决方案）。

```
#container {
    width: 380px;
    margin: 0 auto;
    overflow: hidden;
}

#items li#center-stamp { 
    width:100px; 
    height:100px; 
    background:red; 
    margin: 0 -240px 0 140px;
}
#items li { 
    width:50px; 
    height:50px; 
    background:#ccc; 
    margin:10px; 
    float:left; 
    display:block; 
}

#items li:nth-of-type(4n) {
    margin-left: 110px;
} 
```

## 可选解决方案

如果`center-stamp`纯粹是展示性的，则可以将其移动到像这样的伪元素（[**参见小提琴**](http://jsfiddle.net/XXu8G/18/)）。

```
#container {
    width: 380px;
    margin: 0 auto;
    overflow: hidden;
}

#items:before { 
    content: '';
    width:100px; 
    height:100px; 
    background:red; 
    margin: 0 -240px 0 140px;
    float: left;
    display: block;
}
#items li { 
    width:50px; 
    height:50px; 
    background:#ccc; 
    margin:10px; 
    float:left; 
    display:block; 
}

#items li:nth-of-type(4n+3) {
    margin-left: 110px;
} 
```

## 更“灵活”（仍然是 CSS3）的解决方案

对于灵活宽度和动态元素个数的新需求，假设元素宽度是标准的，还是有纯CSS3的方案。它是通过明智地使用`@media`查询来完成的（可能最好由 CSS 预处理器（如 LESS 或 SCSS）生成），您需要对查询的范围设置实际限制。[**这是一个小提琴**](http://jsfiddle.net/XXu8G/48/)和其中的css代码：

```
#container {
    width: 100%;
    overflow: hidden;
}

#center-stamp {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 50%;
    width: 100px;
    margin-left: -50px;
    background-color: red;
    z-index: -1;
}

#items {
    overflow: hidden;
    width: 240px;
    margin: 0 auto;
}

#items li { 
    width:50px; 
    height:50px; 
    background:#ccc; 
    margin:10px; 
    display: block; 
    float: left;
}

#items > li:nth-child(2n) {
    margin-left: 110px;
}

@media all and (min-width: 380px) {
    #items {
        width: 380px;
    }
    #items > li:nth-child(2n) {
        margin-left: 10px;
    }    
    #items > li:nth-child(4n+3) {
        margin-left: 110px;
    }
}

@media all and (min-width: 520px) {
    #items {
        width: 520px;
    }
    #items > li:nth-child(4n+3) {
        margin-left: 10px;
    }    
    #items > li:nth-child(6n+4) {
        margin-left: 110px;
    }
}

@media all and (min-width: 660px) {
    #items {
        width: 660px;
    }
    #items > li:nth-child(6n+4) {
        margin-left: 10px;
    }    
    #items > li:nth-child(8n+5) {
        margin-left: 110px;
    }
} 
```

**注意：**关键是将宽度重置为允许的块数，然后覆盖先前宽度的`nth-child`选择器将其放回`10px`边距，然后为`nth-child`.

# c++ - 如何将此 C++ 函数转换为 Objective-C？

> ID：11635467
> 
> 赞同：0
> 
> 时间：2012-07-24T16:40:02.333
> 
> 标签：c++, objective-c

我的 C++ 知识很糟糕，我需要以正确的方式转换 C++ 函数。

这是我的代码（摘自[http://www.sky.franken.de/doxy/xmlstorage/c++/base64_8cpp_source.html](http://www.sky.franken.de/doxy/xmlstorage/c++/base64_8cpp_source.html)）。

```
void* base64_decode(const char* s, size_t& data_len)
{
  size_t len = strlen(s);

  if (len % 4)
          throw Exception("invalid BASE64 string length");

  unsigned char* data = (unsigned char*) malloc(len/4*3);

  int n[4];
  unsigned char* q = (unsigned char*) data;

  for(const char*p=s; *p; ) {
          n[0] = POS(*p++);
          n[1] = POS(*p++);
          n[2] = POS(*p++);
          n[3] = POS(*p++);

          if (n[0]==-1 || n[1]==-1)
              throw Exception("invalid BASE64 encoding");

      if (n[2]==-1 && n[3]!=-1)
              throw Exception("invalid BASE64 encoding");

      q[0] = (n[0] << 2) + (n[1] >> 4);
      if (n[2] != -1) q[1] = ((n[1] & 15) << 4) + (n[2] >> 2);
      if (n[3] != -1) q[2] = ((n[2] & 3) << 6) + n[3];
      q += 3;
  }

       data_len = q-data - (n[2]==-1) - (n[3]==-1);

       return data;
   } 
```

我需要这个以前的函数来拥有这个标题

```
void * base64_decode(const char* s, size_t * data_len) 
```

所以，你看到这是标题上的“&”和“*”的问题。如你所见，第一个函数有这个

```
size_t& data_len 
```

在标题中，但我需要它接受表单中的数据长度

```
size_t * data_len 
```

我不知道如何在第二个中转换第一个，或者换句话说，我必须对该方法执行什么样的更改才能使其与作为“size_t *”提供的 data_len 一起工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:43:58.667

```
void* base64_decode(const char* s, size_t* data_len_ptr)
{
    size_t len = strlen(s);

    if (len % 4)
        [NSException raise:@"Invalid input in base64_decode" format:@"%d is an invalid length for an input string for BASE64 decoding", len];

    unsigned char* data = (unsigned char*) malloc(len/4*3);

    int n[4];
    unsigned char* q = (unsigned char*) data;

    for(const char*p=s; *p; )
    {
        n[0] = POS(*p++);
        n[1] = POS(*p++);
        n[2] = POS(*p++);
        n[3] = POS(*p++);

        if (n[0]==-1 || n[1]==-1)
            [NSException raise:@"Invalid input in base64_decode" format:@"Invalid BASE64 encoding"];

        if (n[2]==-1 && n[3]!=-1)
            [NSException raise:@"Invalid input in base64_decode" format:@"Invalid BASE64 encoding"];

        q[0] = (n[0] << 2) + (n[1] >> 4);
        if (n[2] != -1) q[1] = ((n[1] & 15) << 4) + (n[2] >> 2);
        if (n[3] != -1) q[2] = ((n[2] & 3) << 6) + n[3];
        q += 3;
    }

    // make sure that data_len_ptr is not null
    if (!data_len_ptr)
        [NSException raise:@"Invalid input in base64_decode" format:@"Invalid destination for output string length"];

    *data_len_ptr = q-data - (n[2]==-1) - (n[3]==-1);

    return data;
} 
```

调用该函数将如下所示：

```
const char* string = /*Base-64 encoded string*/;
size_t data_len;
void* decoded_data = base64_decode(string, &data_len);
// the length of the decoded data is now indicated by data_len 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:42:24.157

每当您看到时`data_len.something`将其更改为`data_len->something``data_len``*data_len`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T16:45:56.267

将倒数第二行替换为

```
*data_len = q-data - (n[2]==-1) - (n[3]==-1); 
```

或者更好的是，为 iOS 找到一个现成的 Base64 实现。这些很多。

# css - 等效于 FF 和 IE 的 -webkit-text-stroke

> ID：11635472
> 
> 赞同：16
> 
> 时间：2012-07-24T16:40:32.793
> 
> 标签：css, firefox, google-chrome, webkit

我在[某处](http://www.browsersupport.net/CSS/-webkit-text-stroke)看到样式 -webkit-text-stroke 不支持**任何**版本的 FF（或 IE，就此而言，但最后一个并不令人惊讶）。如果我需要让我的 Mozilla/Microsoft 支持的访问者看到大纲，我该怎么办。

我有以下解决方案，没有一个感觉很正确。

1.  忘记它，让人们选择更好的浏览器。
2.  加入 Mozilla 团队，在微软工作，加速发展
3.  使用图像进行概述，让 Paint.NET 完成这项工作。
4.  等到其他人对此做了适当的事情。

建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T16:42:58.647

根据[this blog](http://css-tricks.com/adding-stroke-to-web-text/)，您可以使用阴影来模拟效果。

# php - 如何动态填充 DataTables 选择菜单？

> ID：11635482
> 
> 赞同：0
> 
> 时间：2012-07-24T16:41:18.587
> 
> 标签：php, javascript, mysql, datatables

我有一个显示来自 MySQL 数据库的信息的 DataTables 表。我正在尝试创建下拉过滤器`<select>`，就像[这里](http://datatables.net/examples/api/multi_filter_select.html)使用的过滤器一样。我知道服务器端表不能使用那个精确的例子，但我不确定如何更改它以使其与服务器端数据库表一起工作。

我将如何创建下拉菜单，填充来自表/数据库的信息，以过滤 DataTables 表？

编辑：服务器端在 PHP 中。我尝试查询数据库并使用 PHP 创建一个单独的菜单，并将 JSON 编码的信息发送到选择菜单中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:25:49.027

好的，我不知道如何使用 PHP 实现这一点的具体细节（我知道这绝对是可能的）所以我会给你一个通用的纲要。你可以稍后向我询问具体细节，我会编辑我的答案。

首先你必须有ajax源。

然后，您可以使用相同的功能（来自服务器端）动态填充下拉列表中的选项。这是如何

首先，您将 html 代码设为空`<select id='id1'></select>` 然后您可以使用数据表中的`draw`事件，您可以在该事件上发出 ajax 请求来填充下拉菜单`$(oTable).on("draw", function() { ... });`。After that you can refresh the table and the dropdowns when one of the select option changes.

这是回答您（模糊）问题的最通用方式。

这里还有一些资源：

刷新 ajax 数据：[单击按钮时如何触发 jquery datatables fnServerData 通过 AJAX 更新表？](https://stackoverflow.com/questions/11566463/how-can-i-trigger-jquery-datatables-fnserverdata-to-update-a-table-via-ajax-when/11566783#11566783)

如果您有更具体的问题，请告诉我。

# c++ - 使用 mingw-w64 工具链时，发布模式下的正则表达式 Boost 库链接警告“重复部分具有不同的大小”

> ID：11635485
> 
> 赞同：11
> 
> 时间：2012-07-24T16:41:26.270
> 
> 标签：c++, boost, mingw-w64

在发布模式下链接我的项目时，我收到以下警告：

```
myProject-libs/release/libboost_regex-mt-s-1.50.0.a(cpp_regex_traits.o): duplicate section `.data$_ZZN5boost16cpp_regex_traitsIcE21get_catalog_name_instEvE6s_name[boost::cpp_regex_traits<char>::get_catalog_name_inst()::s_name]' has different size 
```

我怀疑原因可能是 boost 库的编译选项与我用于项目的选项不同，但我不知道如何找到差异（boost 在构建期间没有输出这些选项）。

为了在 Ubuntu 12.04 上为 win32 编译 boost，我使用了这个过程：

```
tar jxf boost_1_50_0.tar.bz2
cd boost_1_50_0
./bootstrap.sh
echo "using gcc : 4.6 : i686-w64-mingw32-g++ : <rc>i686-w64-mingw32-windres <archiver>i686-w64-mingw32-ar ;" > user-config.jam
./bjam toolset=gcc target-os=windows --address-model=32 variant=release threading=multi threadapi=win32 link=static runtime-link=static --prefix=/opt/boost_1_50_0-release-static-windows-32 --user-config=user-config.jam -j 10 --without-mpi --without-python -sNO_BZIP2=1 -sNO_ZLIB=1 --layout=tagged install 
```

为了在我的项目中编译文件，我使用类似的东西

```
i686-w64-mingw32-g++ -march=corei7 -mfpmath=sse -m32 -Wall -fmessage-length=0 -I"/opt/boost_1_50_0-release-static-windows-32/include" -std=c++0x -O3 -g0 -DNDEBUG -I"myProject/src/cpp" -c -o myProject/build/release/src/cpp/myproject.o myproject/src/cpp/myproject.cpp 
```

我的测试表明正则表达式运行良好，但我仍然想解决警告。

编辑

我发现可以使用 bjam 的 cxxflags= 参数添加到 boost 编译器的附加选项。

示例：bjam cxxflags='-fPIC' ....

也许确保将与我相同的参数传递给项目可以解决问题（特别是与链接问题中建议的优化相关的参数）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-07T19:11:47.910

您的编译器是使用不同的选项编译的：) 在 Linux 上编译库和在 Windows 上编译程序会导致存在相同名称的 .data 段，但它们的大小不同。从理论上讲，这可能很有趣，因为数据段是可写的，但实际上，这无关紧要。除非有证据表明这会导致我不知道的问题，否则您可以放心地取消该警告；不过，我不知道你怎么让它消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-24T17:50:52.577

我最近在尝试使用 mingw 为 Windows 编译 boost 时遇到了这个问题（即链接器警告“重复部分具有不同的大小”）。

我遇到的问题是我编译了我的应用程序，`-std=c++14`但是在编译 boost 时我没有专门提供方言标志（默认`-std=c++98`为 g++ 5.3.0）。在编译 boost 时添加方言标志`-std=c++14`为我解决了这个问题。有关如何在编译 boost 时设置 cxxflags 的说明，请参阅此[答案。](https://stackoverflow.com/a/43716427/6332023)

我相信我的解决方案可能对您有用（您的应用程序已编译，`-std=c++0x`但未提供任何方言标志）。尽管我已经晚了 6 年，但我会将我的答案留给其他偶然发现这个问题的人。

# java - 集成 Struts 2 和 hibernate 的最佳方法

> ID：11635487
> 
> 赞同：0
> 
> 时间：2012-07-24T16:41:26.347
> 
> 标签：java, spring, hibernate, struts2

我打算整合hibernate和struts2。请告知哪种方法最好，我在想在 Struts2 中，没有官方插件可以集成 Hibernate 框架。但是，您可以通过以下步骤解决：

1.  注册一个自定义的 ServletContextListener。
2.  在 ServletContextListener 类中，初始化 Hibernate 会话并将其存储到 servlet 上下文中。
3.  在 action 类中，从 servlet 上下文中获取 Hibernate 会话，并正常执行 Hibernate 任务。

请告知我用于初始化休眠会话工厂的 servlet 上下文方法是可以的，或者也可以有其他最好的方法。这是该项目的快照。

这是一段代码..

模型类...

```
package com.mkyong.customer.model;

import java.util.Date;

public class Customer implements java.io.Serializable {

    private Long customerId;
    private String name;
    private String address;
    private Date createdDate;

    //getter and setter methods
} 
```

hbm 映射文件..

```
<hibernate-mapping>
    <class name="com.mkyong.customer.model.Customer" 
    table="customer" catalog="mkyong">

        <id name="customerId" type="java.lang.Long">
            <column name="CUSTOMER_ID" />
            <generator class="identity" />
        </id>
        <property name="name" type="string">
            <column name="NAME" length="45" not-null="true" />
        </property>
        <property name="address" type="string">
            <column name="ADDRESS" not-null="true" />
        </property>
        <property name="createdDate" type="timestamp">
            <column name="CREATED_DATE" length="19" not-null="true" />
        </property>
    </class>
</hibernate-mapping> 
```

配置文件是...

```
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.bytecode.use_reflection_optimizer">false</property>
    <property name="hibernate.connection.password">password</property>
    <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/mkyong</property>
    <property name="hibernate.connection.username">root</property>
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    <property name="show_sql">true</property>
    <property name="format_sql">true</property>
    <property name="use_sql_comments">false</property>
    <mapping resource="com/mkyong/customer/hibernate/Customer.hbm.xml" />
  </session-factory>
</hibernate-configuration> 
```

监听类...

```
package com.mkyong.listener;

import java.net.URL;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;

public class HibernateListener implements ServletContextListener{

    private Configuration config;
    private SessionFactory factory;
    private String path = "/hibernate.cfg.xml";
    private static Class clazz = HibernateListener.class;

    public static final String KEY_NAME = clazz.getName();

    public void contextDestroyed(ServletContextEvent event) {
      //
    }

    public void contextInitialized(ServletContextEvent event) {

     try { 
            URL url = HibernateListener.class.getResource(path);
            config = new Configuration().configure(url);
            factory = config.buildSessionFactory();

            //save the Hibernate session factory into serlvet context
            event.getServletContext().setAttribute(KEY_NAME, factory);
      } catch (Exception e) {
             System.out.println(e.getMessage());
       }
    }
} 
```

终于动作课了​​。。

```
ackage com.mkyong.customer.action;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.apache.struts2.ServletActionContext;
import org.hibernate.Session;
import org.hibernate.SessionFactory;

import com.mkyong.customer.model.Customer;
import com.mkyong.listener.HibernateListener;
import com.opensymphony.xwork2.ActionSupport;
import com.opensymphony.xwork2.ModelDriven;

public class CustomerAction extends ActionSupport 
    implements ModelDriven{

    Customer customer = new Customer();
    List<Customer> customerList = new ArrayList<Customer>();

    public String execute() throws Exception {
        return SUCCESS;
    }

    public Object getModel() {
        return customer;
    }

    public List<Customer> getCustomerList() {
        return customerList;
    }

    public void setCustomerList(List<Customer> customerList) {
        this.customerList = customerList;
    }

    //save customer
    public String addCustomer() throws Exception{

        //get hibernate session from the servlet context
        SessionFactory sessionFactory = 
             (SessionFactory) ServletActionContext.getServletContext()
                     .getAttribute(HibernateListener.KEY_NAME);

        Session session = sessionFactory.openSession();

        //save it
        customer.setCreatedDate(new Date());

        session.beginTransaction();
        session.save(customer);
        session.getTransaction().commit();

        //reload the customer list
        customerList = null;
        customerList = session.createQuery("from Customer").list();

        return SUCCESS;

    }

    //list all customers
    public String listCustomer() throws Exception{

        //get hibernate session from the servlet context
        SessionFactory sessionFactory = 
             (SessionFactory) ServletActionContext.getServletContext()
                     .getAttribute(HibernateListener.KEY_NAME);

        Session session = sessionFactory.openSession();

        customerList = session.createQuery("from Customer").list();

        return SUCCESS;

    }   
} 
```

伙计们请发布更新的代码非常感谢，我坚持这个..!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:01:54.533

你不想`Session`在`ServletContext`. 会话不是线程安全的，Hibernate 的最佳实践是为每个请求创建和销毁一个`Session`（或者如果您使用 JPA）。`EntityManager`

这可以使用拦截器来完成。正如 Umesh 所指出的，您应该倾向于使用服务层类（例如 DAO）来直接与会话交互，而不是在操作类中使用它。这为您提供了模型和控制器层之间更明确的分离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:48:39.033

我对阅读标题感到困惑，因为它提到了 Spring 和 Hibernate，但在阅读之后，结果是 Struts2 和 Hibernate。这是我对您的输入的快速思考

Struts2 用于 Web 层作为 MVC 框架，而 Hibernate 负责处理 DB 交互，尽管您始终可以同时使用两者，并且可以在 Struts2 操作中注入休眠会话，但我不建议您使用这种方法。我的建议是创建一个服务层，它应该负责在您的 Struts2 操作类和您的 Hibernate 层之间进行交互，这将帮助您微调您的代码，并使您更容易进行任何代码更改或任何修改未来。

Struts2 中已经有一个插件允许您在动作类中注入 Hibernate 会话

1.  [struts2 的全休眠插件/](http://code.google.com/p/full-hibernate-plugin-for-struts2/)

但我仍然认为不要将休眠会话与 Struts2 操作混合在一起，最好在两者之间放置一个服务层来执行此操作。

此外，由于您已经用 Spring 标记了您的问题，所以我相信您也在应用程序中使用 Spring，因此最好让 Spring 处理您与 Hibernate 的交互，同时引入服务层将帮助您高效地进行事务划分并进行微调可能的。

# python - 为什么 Python 在创建实例时不调用实例方法 __init__() 而是调用类提供的 __init__() ？

> ID：11635489
> 
> 赞同：14
> 
> 时间：2012-07-24T16:41:30.770
> 
> 标签：python, object, methods, instances

我正在覆盖`__new__()`一个类的方法以返回一个具有特定`__init__()`集合的类实例。Python 似乎调用类提供的`__init__()`方法而不是实例特定的方法，尽管 Python 文档位于

[http://docs.python.org/reference/datamodel.html](http://docs.python.org/reference/datamodel.html)

说：

> 典型的实现通过使用 super(currentclass, cls).__new__(cls[, ...]) 和适当的参数调用超类的 __new__() 方法来创建类的新实例，然后在返回之前根据需要修改新创建的实例它。
> 
> 如果 __new__() 返回 cls 的实例，则新实例的 __init__() 方法将像 __init__(self[, ...]) 一样被调用，其中 self 是新实例，其余参数与传递给的参数相同__新的__（）。

这是我的测试代码：

```
#!/usr/bin/env python

import new

def myinit(self, *args, **kwargs):
    print "myinit called, args = %s, kwargs = %s" % (args, kwargs)

class myclass(object):
    def __new__(cls, *args, **kwargs):
        ret = object.__new__(cls)

        ret.__init__ = new.instancemethod(myinit, ret, cls)
        return ret

    def __init__(self, *args, **kwargs):
        print "myclass.__init__ called, self.__init__ is %s" % self.__init__
        self.__init__(*args, **kwargs)

a = myclass() 
```

哪个输出

```
$ python --version
Python 2.6.6
$ ./mytest.py
myclass.__init__ called, self.__init__ is <bound method myclass.myinit of <__main__.myclass object at 0x7fa72155c790>>
myinit called, args = (), kwargs = {} 
```

似乎唯一可以`myinit()`运行的方法是将其明确称为`self.__init__()`inside `myclass.__init__()`。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T16:45:14.357

Special methods on new-style classes are looked up on the instance's type, not on the instance itself. This is [documented behaviour](http://docs.python.org/reference/datamodel.html#special-method-lookup-for-new-style-classes):

> For new-style classes, implicit invocations of special methods are only guaranteed to work correctly if defined on an object’s type, not in the object’s instance dictionary. That behaviour is the reason why the following code raises an exception (unlike the equivalent example with old-style classes):

```
>>> class C(object):
...     pass
...
>>> c = C()
>>> c.__len__ = lambda: 5
>>> len(c)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: object of type 'C' has no len() 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T16:45:03.987

各种特殊方法（包括`__init__`，但也包括运算符重载，例如`__add__`等）[总是通过类而不是实例访问](http://docs.python.org/dev/reference/datamodel.html#special-lookup)。不仅如此，它们不能通过类或元类上的`__getattr__`or`__getattribute__`方法访问，它们必须直接在类上。这是出于效率的原因：

> Bypassing the `__getattribute__()` machinery in this fashion provides significant scope for speed optimisations within the interpreter, at the cost of some flexibility in the handling of special methods (the special method must be set on the class object itself in order to be consistently invoked by the interpreter).

It's not entirely clear what you're trying to accomplish, but one thing you could do here is to subclass `myclass` within the `__new__` method:

```
class myclass(object):
    def __new__(cls, *args, **kwargs):
        class subcls(cls):
            def __new__(cls, *args, **kwargs):
                return object.__new__(cls)
        subcls.__init__ = myinit
        return subcls(*args, **kwargs) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-04T09:13:53.950

> Why doesn't Python call instance method **init**() on instance creation but calls class-provided **init**() instead?

Check out this example.

```
class C:
   one = 42
   def __init__(self,val):
        self.two=val
ci=C(50)
print(ci.__dict__)
print(C.__dict__) 
```

* * *

The result will be like this:

```
{'two': 50}
{'__module__': '__main__', 'one': 42, '__init__': <function C.__init__ at 0x00000213069BF6A8>, '__dict__': <attribute '__dict__' of 'C' objects>, '__weakref__': <attribute '__weakref__' of 'C' objects>, '__doc__': None} 
```

Note that only the value `{'two': 50}` is part of the instance dict.

`'one': 42` belongs to a class `C` dict. The same is with the `__init__` method.

This is per design.

# asp.net - 好奇我的控制器在 webapi 发布时的位置

> ID：11635490
> 
> 赞同：0
> 
> 时间：2012-07-24T16:41:32.013
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-web-api

与其说是直接的编程查询，不如说是为了信息/知识……

当我单击 Publish (VS2012 RC) 并查看发布文件夹时，我只能看到 bin、内容、图像、脚本和视图的文件夹。

没有控制器文件夹。

这是因为 VS 将所有内容打包到 BIN 文件夹中的 DLL 中吗？

谢谢，马克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:43:05.100

`DLLs`您的文件夹内有`bin`控制器和其他类文件的代码（例如：您的模型类）。如果你使用任何反编译工具，你可以看到。

![在此处输入图像描述](../Images/b44c28461b9bd6fc3f0fd31b098a1116.png)

DLL（动态链接库）文件包含网站的可执行代码，例如您创建的类文件。您的应用程序将与这些 DLL 一起正常工作，因为您的所有代码（您的方法/属性等）都可以在其中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:43:56.940

您的控制器（和任何其他`.cs`文件）被编译成`bin`文件夹中的 dll。

# r - 在 R 中扫描 csv 文件中的字符串

> ID：11635491
> 
> 赞同：0
> 
> 时间：2012-07-24T16:41:34.960
> 
> 标签：r, function, csv

我希望能够在 R 中逐行扫描 csv 文件并排除包含“目标”一词的行。

问题是数据来自不同的地方，“目标”一词可能出现在数据框中的许多不同列中。

所以我需要一个函数中的一行来查找这个字符串，如果它不存在，那么将该行附加到一个新的数据帧（然后我将作为一个新的 csv 写出来）。

任何和所有的帮助都非常感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T16:54:22.380

Andrie 的评论可能是大多数用户处理这个问题的方式，但如果你想在阅读阶段这样做，你可以试试这个：

1.  使用读取您的 csv`readLines`并将任何具有文本*目标*的行设为空白：

    ```
    temp = gsub(".*target.*", "", readLines("test.csv")) 
    ```

2.  用于`read.table`转换`temp`为`data.frame`. 由于具有文本*目标*的所有行现在都是空白的，因此默认`blank.lines.skip=TRUE`in`read.table`应正确读取其余数据为`data.frame`.

    ```
    read.table(text=temp, sep=",", header=TRUE) 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T16:50:44.893

使用 readLines：

```
lines <- readLines(file)
n.lines <- length(lines)
vec.1 <- rep(0, n.lines)
vec.2 <- rep(0, n.lines)
# more vectors as necessary

counter <- 0
for (i in 1:n.lines){           
  this.line <- strplit(lines[i], ",")
  if ("target" %in% this.line) next
  counter <- counter + 1
  vec.1[counter] <- this.line[1]
  vec.2[counter] <- this.line[2]
  # etc.
}

df <- data.frame(vec.1[1:counter], vec.2[1:counter]) 
```

如果您的文件有标题，您可能需要稍微更改 n.lines 并更改 for 循环的索引；两行将更改如下：

```
n.lines <- length(lines) - 1 
```

和

```
for(i in 2:(n.lines+1)){ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:06:15.420

我会打电话`from.readLines <- readLines(filename)`，然后只选择不包含目标字符串的行：`data <- read.csv(text = from.readLines[-grep('target', from.readLines)], header = F)`。

更快的方法（如果您的文件很大）将`grep -v 'target' original.csv > new.csv`首先在命令行上运行，然后`read.csv(new.csv, ...)`在`R`.

但不管怎么说，

```
> #Without header
> from.readLines <- c('afaf,afasf,target', 'afaf,target,afasf', 'dagdg,asgst,sagga', 'dagdg,dg,sfafgsgg')
> data <- read.csv(text = from.readLines[-grep('target', from.readLines)], header = F)
> print(data)
     V1    V2       V3
1 dagdg asgst    sagga
2 dagdg    dg sfafgsgg
> 
> #With header
> from.readLines <- c('var1,var2,var3', 'afaf,afasf,target', 'afaf,target,afasf', 'dagdg,asgst,sagga', 'dagdg,dg,sfafgsgg')
> data <- read.csv(text = from.readLines[-(grep('target', from.readLines[-1]) + 1)])
> print(data)
   var1  var2     var3
1 dagdg asgst    sagga
2 dagdg    dg sfafgsgg 
```

# vba - VBA宏根据用户输入删除行

> ID：11635492
> 
> 赞同：0
> 
> 时间：2012-07-24T16:41:37.483
> 
> 标签：vba, excel

我正在尝试找到一个宏，它将删除用户指定数字以下的所有行。例如，用户将输入“19”，宏将删除第 20 行及以下的行。我真的很感激帮助。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:22:48.567

尝试这个。我用过`ActiveSheet`。您可以将其设置为您想要使用的任何工作表。

```
Sub Sample()
    Dim Ret As Long

    Ret = Application.InputBox(Prompt:="Please enter a row number", Type:=1)

    If Ret = False Then Exit Sub

    With ActiveSheet
        .Rows(Ret + 1 & ":" & .Rows.Count).Delete
    End With
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:04:04.527

您可以在 column=1 和 Row=1 中输入要保留的行号。数据在 rows=deleterowsbefore 每行回到 row=2 将被删除。

```
Sub Macro1()
'
' Macro1 Macro
'

    deleterowsbefore = ActiveSheet.Cells(1, 1)
    Rows("2:" & deleterowsbefore - 1).Select
    Selection.Delete Shift:=xlUp
End Sub 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-24T16:57:03.177

这应该可以解决问题：

```
Sub UserInput()
    Dim num As Integer
    num = InputBox(Prompt:="Enter the row number.", Title:="Enter Row Number", Default:="Row number")
    If (num < 1) Then
        GoTo Whoops:
    End If
    Dim i As Integer
    i = 1
    Do While i <= num
        Rows(1).EntireRow.Delete
        i = i + 1
    Loop
    GoTo Fin:
    Whoops:
        MsgBox ("You have entered an invalid row number")
    Fin:
End Sub 
```

# git - 将 git 更改推送到共享网络驱动器

> ID：11635493
> 
> 赞同：97
> 
> 时间：2012-07-24T16:41:42.083
> 
> 标签：git, networking, push, shared, drive

一个四人团队如何使用 Git（特别[是 Windows 版 Github](http://windows.github.com/)）将本地更改推送到共享网络驱动器？

现在（没有 Git）我们必须将文件从网络驱动器复制到我们的本地计算机，编辑文件，然后将它们重新上传到共享网络驱动器。这是一个艰苦的过程，可能会导致很多错误，但看起来 Git 可以帮助我们。

我们可以简单地在共享驱动器上安装 Git 并从那里开始吗？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2013-03-18T21:38:52.850

不确定您是否找到了适合您的东西，但我有一篇关于如何在 Windows 网络驱动器上执行此操作的文章：

[http://tony.halcyonlane.com/blog/2011/09/22/Using-git-at-work-on-a-Windows-network-drive/](http://tony.halcyonlane.com/blog/2011/09/22/Using-git-at-work-on-a-Windows-network-drive/)

从 cmd 提示符更改为您的映射驱动器。

> $ cd g：

然后 cd 进入您即将成为 git 存储库。

> $ cd 脚本

然后创建一个空的 git 存储库。如果你不使用 --bare 选项，你会遇到问题，所以不要忽略它。

> $ git init --bare

现在，如果您还没有本地 git 存储库，那么您可以通过导航回本地驱动器来克隆您的新存储库。

> $c:
> 
> $ cd 工作/脚本
> 
> $ git clone file://g:\scripts

克隆时，您会自动获得一个名为“origin”的远程服务器，并且您可以在本地进行任何更改时推送到服务器以安全保存。

> $ git push 起源大师

如果您已经有一个 git 存储库并且只想推送到共享驱动器，那么您可以在本地 git 目录中执行此操作。

> $ git 远程添加源文件：//g:\scripts
> 
> $ git push 起源大师

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-07-24T16:46:36.620

我们的团队目前正是这样做的。每个开发人员都有以下内容：

1.  Git 安装在他们的本地机器上
2.  访问他们自己的个人共享驱动器 ( `L:`)
3.  访问共享群组云端硬盘 ( `V:`)

我们在驱动器上有“远程”存储库（使用 设置`init -bare`）`V:`，每个人的个人`L:`驱动器上都有一个克隆。所有更改都对`L:`驱动器进行并推送到`V:`驱动器，然后其他开发人员稍后将其拉到驱动器上各自的个人存储库中`L:`。这没有任何问题，并且减少了对 Git 服务器的需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T16:54:10.153

您可以添加另一个指向您的网络驱动器的[远程（git remote）](http://gitref.org/remotes/)

然后你可以推拉类似于你对 github 所做的事情

# insert - RIA 服务 - 插入期间更新

> ID：11635505
> 
> 赞同：0
> 
> 时间：2012-07-24T16:42:48.923
> 
> 标签：insert, wcf-ria-services

问题：在 entity_A 的插入操作期间，我想更新特定 entity_B 上的属性并更新更改。我这样做如下：

```
public void InsertEntity_A(Entity_A entity_A)
{
    // fetch entity_B and change a property
    Entity_B entity_B = ObjectContext.Entity_B.SingleOrDefault(...);
    entity_B.Counter++;
    this.UpdateEntity_B(entity_B);

    // continue normal processing for entity_A
    if((entity_A.EntityState != ...) 
    ...
    ...
} 
```

“UpdateEntity_B(...)”会生成一个错误，指出 entity_B 不在当前的 ChangeSet 中。我怎样才能做到这一点？

TIA 海子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T08:17:17.383

如果发现使用

```
ObjectContext.Entity_B.ApplyCurrentValues(entity_B); 
```

而不是`UpdateEntity()`做到这一点，显然将 entity_B 保存到数据库中。任何人都可以确认这是正确的方法吗？

问候海科

# resharper - 在许多属性和类中自动化 Resharper 的“带有支持字段的属性”？

> ID：11635508
> 
> 赞同：3
> 
> 时间：2012-07-24T16:42:57.723
> 
> 标签：resharper

我有一些像这样的 C# 代码（类文件 = Status.cs）：

```
 /// <summary>
    /// Constructs a status entity with the text specified
    /// </summary>
    /// <param name="someParameter">Some parameter.</param>
    public Status(string someParameter)
    {
        SomeProperty = someParameter;
    }

    /// <summary>
    /// An example of a virtual property.
    /// </summary>
    public virtual string SomeProperty { get; private set; } 
```

我想对它做三件事：

1.  在其上执行 Resharper “具有支持字段的属性”
2.  摆脱“私人集”并用常规“集”替换它
3.  更改构造函数，使其初始化私有字段而不是属性

所以最终的结果应该是这样的：

```
 /// <summary>
    /// Constructs a status entity with the text specified
    /// </summary>
    /// <param name="someParameter">Some parameter.</param>
    public Status(string someParameter)
    {
        _someProperty = someParameter;
    }

    private string _someProperty;

    /// <summary>
    /// An example of a virtual property.
    /// </summary>
    public virtual string SomeProperty
    {
        get { return _someProperty; }
        set { _someProperty = value; }
    } 
```

我的问题是：有没有办法使用 Resharper API 来自动化这种类型的重构？

背景：

对于那些可能想知道我为什么要这样做的人，这是因为：

1.  我正在升级 NHibernate (old=2.1.2.4000, new=3.3.1.4000) 和 Fluent NHibernate (old=1.1.0.685, new=1.3.0.0)。

2.  我已经摆脱了旧的 NHibernate.ByteCode.Castle.dll 和配置文件中的相应行，所以我现在可以使用内置在最新 NHibernate 中的默认代理。

3.  在 NHibernate 的新实现和 Fluent 的新版本之间，当我尝试构建和运行单元测试时似乎存在两个问题（其中一部分是 FxCop 抱怨，但无论如何）：

a）由于“私有集”而引发异常，并且 b）由于正在构造函数中初始化虚拟属性而引发异常。

所以我发现如果我进行这些更改，它会编译并且单元测试通过。

所以这对一两个类来说很好，但是有超过 800 个类文件，谁知道有多少属性。

我确信有很多方法可以做到这一点（例如，使用反射、通过目录递归和解析文件等），但似乎 Resharper 是这样的合适工具。

任何帮助表示赞赏，谢谢，-Dave

- 回答“只需将其更改为受保护的集合就完成了”的答案：

不幸的是，事情并没有那么简单。

这是运行单元测试时发生的错误（在对任何类进行任何更改之前）：

测试方法抛出异常：NHibernate.InvalidProxyTypeException：以下类型不能用作代理：.Status：方法 set_StatusText 应该是“公共/受保护的虚拟”或“受保护的内部虚拟”..Status：方法 set_Location 应该是“公共/受保护”虚拟”或“受保护的内部虚拟”

因此，如果我按照建议更改类（唯一的更改是将“私有集”更改为“受保护集”），项目将不会构建，因为：

错误 2 CA2214：Microsoft.Usage：“Status.Status(string, StatusLocation)”包含一个调用链，该调用链导致调用该类定义的虚拟方法。查看以下调用堆栈以了解意外后果：Status..ctor(String, StatusLocation) Status.set_Location(StatusLocation):Void C:\\Status.cs 28

这就是为什么还需要更改构造函数中初始化这些虚拟属性之一的任何语句的原因。

NHibernate 代理 (ByteCode.Castle) 的先前实现似乎并不关心“私有集”，而这个实现。

而且，不可否认，第二个错误是因为 FxCop，我可以在类上放置一个属性来告诉 FxCop 不要抱怨这个，但这似乎只是让问题消失了，在构造函数中初始化虚拟属性是，据我了解，无论如何都是不好的做法。

所以我的问题仍然存在。我最初描述的更改是我想做的更改。如何自动化这些更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T14:56:23.147

我继续编写了一个 C# 实用程序来解析这样的类文件。“受保护的集合”的想法在某种程度上是有效的（感谢 Hazzik），但它仍然需要一个支持字段。下面的代码产生我上面描述的输出（除了使用“保护集”）。问候，-戴夫

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;

namespace ConsoleApplication3
{
// TODO:  write recursive algorithm to loop through directories
// TODO:  handle generic collections as Fluent NHibernate treats those differently

class Program
{
    public static string ConvertInitialCapitalToUnderscoreAndLowerCase(string input)
    {
        var firstChar = input.Substring(0, 1);
        var restOfStmt = input.Substring(1);
        var newFirst = "_" + firstChar.ToLower();
        var output = newFirst + restOfStmt;
        return output;
    }

    // this gets any tabs or spaces at the beginning of the line of code as a string,
    // so as to preserve the indentation (and/or add deeper levels of indentation)
    public static string GetCodeLineIndentation(string input)
    {
        var charArray = input.ToCharArray();

        var sbPrefix = new StringBuilder();

        foreach (var c in charArray)
        {
            // if it's a tab or a space, add it to the "prefix"
            if (c == 9 || c == ' ')
            {
                sbPrefix.Append(c);
            }
            else
            {
                // get out as soon as we hit the first ascii character (those with a value up to 127)
                break;
            }
        }

        return sbPrefix.ToString();
    }

    static void Main(string[] args)
    {

        const string path = @"C:\pathToFile\Status.cs";

        Console.WriteLine("Examining file:  " + path);

        if (!File.Exists(path))
        {
            Console.WriteLine("File does not exist:  " + path);
            throw new FileNotFoundException(path);
        }

        // Read the file.
        var arrayOfLines = File.ReadAllLines(path);

        // Convert to List<string>
        var inputFileAsListOfStrings = new List<string>(arrayOfLines);

        // See if there are any virtual properties.
        var virtualProps = inputFileAsListOfStrings.Where(s => s.Contains("public virtual")).ToList();

        // See if there are any "private set" strings.
        var privateSets = inputFileAsListOfStrings.Where(s => s.Contains("private set")).ToList();

        if (virtualProps.Count > 0)
        {
            Console.WriteLine("Found " + virtualProps.Count + " virtual properties in the class...");
        }

        if (privateSets.Count > 0)
        {
            Console.WriteLine("Found " + privateSets.Count + " private set statements in the class...");
        }

        // Get a list of names of the virtual properties
        // (the 4th "word", i.e. index = 3, in the string, will be the property name, 
        // e.g. "public virtual string SomePropertyName"
        var virtualPropNames = virtualProps.Select(vp => vp.Trim().Split(' ')).Select(words => words[3]).ToList();

        if (virtualPropNames.Count() != virtualProps.Count())
        {
            throw new Exception("Error:  the list of virtual property names does not equal the number of virtual property statements!");
        }

        // Find all instances of the virtual properties being initialized.

        // By examining the overall file for instances of the virtual property name followed by an equal sign,
        // we can identify those lines which are statements initializing the virtual property.
        var initializeStatements = (from vpName in virtualPropNames
                                    from stmt in inputFileAsListOfStrings
                                    let stmtNoSpaces = stmt.Trim().Replace(" ", "")
                                    where stmtNoSpaces.StartsWith(vpName + "=")
                                    select stmt).ToList();

        if (initializeStatements.Count() > 0)
        {
            Console.WriteLine("Found " + initializeStatements.Count + " initialize statements in the class...");
        }

        // now process the input based on the found strings and write the output
        var outputFileAsListOfStrings = new List<string>();

        foreach (var inputLineBeingProcessed in inputFileAsListOfStrings)
        {
            // is the input line one of the initialize statements identified previously?
            // if so, rewrite the line.

            // e.g.  
            // old line:  StatusText = statusText;  
            // becomes:  _statusText = statusText;

            var isInitStmt = false;
            foreach (var initStmt in initializeStatements)
            {
                if (inputLineBeingProcessed != initStmt) continue;

                // we've found our statement; it is an initialize statement;
                // now rewrite the format of the line as desired
                var prefix = GetCodeLineIndentation(inputLineBeingProcessed);

                var tabAndSpaceArray = new[] {' ', '\t'};

                var inputLineWithoutPrefix = inputLineBeingProcessed.TrimStart(tabAndSpaceArray);

                var outputLine = prefix + ConvertInitialCapitalToUnderscoreAndLowerCase(inputLineWithoutPrefix);

                // write the line (preceded by its prefix) to the output file
                outputFileAsListOfStrings.Add(outputLine);

                Console.WriteLine("Rewrote INPUT: " + initStmt + " to OUTPUT:  " + outputLine);
                isInitStmt = true;

                // we have now processed the input line; no need to loop through the initialize statements any further
                break;
            }

            // if we've already determined the current input line is an initialize statement, no need to proceed further;
            // go on to the next input line
            if (isInitStmt)
                continue;

            // is the input line one of the "public virtual SomeType SomePropertyName" statements identified previously?
            // if so, rewrite the single line as multiple lines of output.

            // the input will look like this:

            /*

            public virtual SomeType SomePropertyName { get; set; }

            */

            // first, we'll need a private variable which corresponds to the original statement in terms of name and type.

            // what we'll do is, write the private field AFTER the public property, so as not to interfere with the XML
            // comments above the "public virtual" statement.

            // the output will be SIX LINES, as follows:

            /*

            public virtual SomeType SomePropertyName
            {
                get { return _somePropertyName; }
                protected set { _someProperty = value; }
            }
            private SomeType _somePropertyName;

            */

            var isPublicVirtualStatement = false;

            foreach (var vp in virtualProps)
            {
                if (inputLineBeingProcessed != vp) continue;

                // the input line being processed is a "public virtual" statement;
                // convert it into the six line output format
                var thisOutputList = new List<string>();

                // first separate any indentation "prefix" that may exist (i.e. tabs and/or spaces),
                // from the actual string of text representing the line of code
                var prefix = GetCodeLineIndentation(inputLineBeingProcessed);

                var tabAndSpaceArray = new[] { ' ', '\t' };

                var inputLineWithoutPrefix = inputLineBeingProcessed.TrimStart(tabAndSpaceArray);

                var originalVpStmt = inputLineWithoutPrefix.Split(' ');

                // first output line (preceded by its original prefix)
                var firstOutputLine =   prefix + 
                                        originalVpStmt[0] + ' ' + 
                                        originalVpStmt[1] + ' ' + 
                                        originalVpStmt[2] + ' ' +
                                        originalVpStmt[3];
                thisOutputList.Add(firstOutputLine);

                // second output line (indented to the same level as the original prefix)
                thisOutputList.Add(prefix + "{");

                // get field name from property name
                var fieldName = ConvertInitialCapitalToUnderscoreAndLowerCase(originalVpStmt[3]);

                // third output line (indented with the prefix, plus one more tab)
                var thirdOutputLine = prefix + "\t" + "get { return " + fieldName + "; }";
                thisOutputList.Add(thirdOutputLine);

                // fourth output line (indented with the prefix, plus one more tab)
                var fourthOutputLine = prefix + "\t" + "protected set { " + fieldName + " = value; }";
                thisOutputList.Add(fourthOutputLine);

                // fifth output line (indented to the same level as the first curly bracket)
                thisOutputList.Add(prefix + "}");

                // sixth output line (the "index 2" value of the original statement will be the string representing the .Net type)
                // (indentation is the same as the "public virtual" statement above)

                var sixthOutputLine =   prefix + 
                                        "private" + ' ' +
                                        originalVpStmt[2] + ' ' +
                                        fieldName + ";";
                thisOutputList.Add(sixthOutputLine);

                // now write the six new lines to the master output list
                outputFileAsListOfStrings.AddRange(thisOutputList);

                isPublicVirtualStatement = true;
                Console.WriteLine("Rewrote INPUT: " + inputLineBeingProcessed + " to OUTPUT:  <multi-line block>");
                break;

            }

            // if we've already determined the current input line is a "public virtual" statement, no need to proceed further;
            // go on to the next input line
            if (isPublicVirtualStatement)
                continue;

            // if we've gotten this far, the input statement is neither an "initialize" statement, nor a "public virtual" statement;
            // So just write the output.  Don't bother logging this as most lines will not be ones we'll process.
            outputFileAsListOfStrings.Add(inputLineBeingProcessed);

        }

        // write the output file
        var newPath = path.Replace(".cs", "-NEW.cs");
        File.WriteAllLines(newPath, outputFileAsListOfStrings);

    }
} 
```

# facebook - 基于每个用户的新 Facebook 评论通知

> ID：11635513
> 
> 赞同：0
> 
> 时间：2012-07-24T16:43:10.207
> 
> 标签：facebook, facebook-javascript-sdk

我正在使用 Facebook 评论插件作为网站上的评论机制。我知道如何以管理员身份接收每条评论的新通知，但是我希望创建评论所在页面的用户也能收到通知。用户登录/注册 Facebook，他们可以在网站上发布某些项目。这些项目属于他们，并有自己的个人评论框。在页面上，我可以轻松获取页面作者的 Facebook 用户 ID，并且我们存储了他们的电子邮件。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:22:41.347

以为我会自己回答这个问题。它实际上很容易。

Facebook 允许您订阅评论事件。所以在你的 Facebook javascript 初始化中：

```
<script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '###########',
        frictionlessRequests: true,
        status     : true, 
        cookie     : true,
        xfbml      : true,
        oauth      : true,
      });

     FB.Event.subscribe('auth.login', function(response) {
         if(response.authResponse)
           window.location.reload();
     });

     FB.Event.subscribe('comment.create', function(resp) {

        $.ajax({url:baseUrl+'/user/facebookcommentcallback/',

                data: {
                    list_id: 'Whatever ID'
                },

                success: function(data) {

                }
            });
        }); 
```

因此，在回调中，我只有一个 ajax 函数，它获取当前页面的 id，查找它，找到页面所有者，并在该页面上发布评论时向他们发送电子邮件。简单的！

# regex - 正则表达式，preg_replace：用单个替换多个实例

> ID：11635515
> 
> 赞同：0
> 
> 时间：2012-07-24T16:43:15.063
> 
> 标签：regex, preg-replace

我有自动生成的字符串。

它的元素之一是组“/__nh”。

有时它会成倍增加，例如：

```
$string = some_stuff_here/__nh/__nh/__nh

```

我尝试了下面的代码（以及其他一些变体）来用一个替换多个实例：

```
return preg_replace('/(//__nh)+/', '/__nh', $string);

```

..但我失败了（正则表达式不是我喜欢的东西）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:46:48.180

您应该使用反斜杠而不是另一个正斜杠来转义正斜杠：

```
return preg_replace('/(\/__nh)+/', '/__nh', $string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:49:33.270

为什么你的正则表达式上有一个双斜杠？

不应该是反斜杠吗？

[无论如何：一个伟大的正则表达式参考是： http](http://weblogtoolscollection.com/regex/regex.php) ://weblogtoolscollection.com/regex/regex.php

# kerberos - Linux 上的 Java 和 Exchange Web 服务 (EWS) 之间的 Kerberos 身份验证

> ID：11635518
> 
> 赞同：2
> 
> 时间：2012-07-24T16:43:22.380
> 
> 标签：kerberos, exchangewebservices

是否可以让在 Linux 上运行的 Java 进程仅使用 kerberos 访问 EWS，而不需要预定义的用户名/密码组合？

我当前的系统架构包含一个使用存储的用户名/密码组合访问 EWS 的 Java 进程。要求是确保运行 Java 进程的凭据在 Exchange 上使用 Kerberos 进行身份验证。

有可能有这个设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T01:56:49.033

是的，应该可以使用 Kerberos 对 EWS 进行身份验证。您可以通过 Java GSSAPI 获取 Kerberos 票证（从票证缓存或提示用户）。[在http://docs.oracle.com/javase/1.5.0/docs/guide/security/jgss/tutorials/BasicClientServer.html](http://docs.oracle.com/javase/1.5.0/docs/guide/security/jgss/tutorials/BasicClientServer.html)有一个 Java GSS 示例程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T16:48:27.110

对的，这是可能的。它已经在“JWebServices for Exchange”、Java API for EWS 中实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T16:33:00.643

您的问题似乎更多地是关于 Java 可以做什么而不是 Exchange/IIS 可以做什么。我根本不了解 Java，但我确实了解 EWS 和 IIS 主题。

请记住以下几点 - IIS 进行身份验证，而不是 EWS。您可以对 IIS 服务器上虚拟文件夹中的文件执行 HTTP GET 以验证您的 API 是否有效。如果您可以向 IIS 进行身份验证，那么 EWS 应该可以工作。现在已经说过您还需要处理访问问题 - 即模拟和委派 - 您需要确保在 EWS XML 中有所需的内容，并为模拟设置正确的 Exchange 设置，并为委派设置正确的文件夹权限。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-24T17:35:51.113

您在票证缓存或该帐户的密钥表中为 TGT 出票。

# stored-procedures - 计算存储过程变量中的不同项

> ID：11635522
> 
> 赞同：0
> 
> 时间：2012-07-24T16:43:43.867
> 
> 标签：stored-procedures, plsql

在存储过程中，我有 value1, value2, value3, ..., value8

价值结果将在 A 和 F 之间。

将值存储到变量中后，有没有办法查看 value1~8 中存储了多少不同的值？

```
 example) 
 value1 = F; value2 = A; value3 = B; value4 = B;
 value5 = B; value6 = D; value7 = D; value8 = F; 
```

然后在我的计数（不同 *）之后，结果应该是 4 个不同的组。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-24T20:10:38.607

```
select Value, COUNT(*) from (
select value1 as Value from sometable
union all 
select value2 as Value from sometable
union all 
select value3 as Value from sometable
union all 
select value4 as Value from sometable
union all 
select value5 as Value from sometable
union all 
select value6 as Value from sometable
union all 
select value7 as Value from sometable
union all 
select value8 as Value from sometable) as SomeTable
group by Value 
```

# android - 如何获得 OpenCV 库以支持 Android 2.3.4 和 4.1？

> ID：11635525
> 
> 赞同：3
> 
> 时间：2012-07-24T16:43:46.900
> 
> 标签：android, opencv

我在 Android 上玩 OpenCV。我曾经能够让示例应用程序在运行 4.0.X 的 Galaxy Nexus 上运行，但自从升级到 Jelly Bean 4.1.X 后，它们不再工作了。我还尝试在我的 Droid 2 上运行带有 Android 2.3.4 的示例，这也是不行的。他们在我运行 2.3.3 的 HTC Evo 4G 上工作。

我正在使用 OpenCV 2.4.2。我可以看到应用程序启动时会尝试加载 libnative_camera_r*.so。它尝试加载以下内容之一：

```
 07-24 10:15:24.394: E/CAMERA_ACTIVITY(6688): ||libnative_camera_r2.3.3.so
    07-24 10:15:24.394: E/CAMERA_ACTIVITY(6688): ||libnative_camera_r4.0.3.so
    07-24 10:15:24.394: E/CAMERA_ACTIVITY(6688): ||libnative_camera_r2.2.0.so
    07-24 10:15:24.394: E/CAMERA_ACTIVITY(6688): ||libnative_camera_r3.0.1.so
    07-24 10:15:24.394: E/CAMERA_ACTIVITY(6688): ||libnative_camera_r4.0.0.so 
```

很明显，.so 文件的版本与 Android 版本有关。Android 2.3.4 和 4.1.X 不在列表中，因此它没有加载必要的库。

我的问题：A）我在哪里可以找到必要的 .so 文件？B）我可以采取哪些步骤来为这些版本构建自己的库？c) 我可以欺骗系统使用以前的版本，比如 4.0.3 到 4.1 吗？（我将对此进行更多调查）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T05:08:06.137

尝试在 Nexus 上更新 OpenCV 管理器并删除其他架构包

# excel - 将 csv 文件作为记录集返回

> ID：11635526
> 
> 赞同：6
> 
> 时间：2012-07-24T16:43:50.563
> 
> 标签：excel, vba

我有一个将数据导出到 CSV 文件的外部程序。我的用户希望通过 Excel 中的 VBA 函数访问这些数据。为了做到这一点，我考虑将读取的 CSV 文件包装到一个返回 ADODB.Recordset 的函数中。我的代码是

```
Public Function getData(fileName As String) As ADODB.Recordset
Dim path As String
path = "C:\testDir\"
Dim cN As New ADODB.Connection
Dim RS As New ADODB.Recordset
cN.Open ("Provider=Microsoft.Jet.OLEDB.4.0;" & _
               "Data Source=" & path & ";" & _
               "Extended Properties=""text; HDR=Yes; FMT=Delimited; IMEX=1;""")
RS.ActiveConnection = cN
RS.Source = "select * from " & fileName
Set getData = RS
End Function 
```

我正在尝试使用调用此函数

```
Dim a As ADODB.Recordset
Set a = getData("testFile.csv")
a.Open() 
```

此时，我收到一个编译错误，提示“=”预期。有人可以指出我应该如何调用我的函数并遍历数据的正确方向吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T18:37:45.510

通过我自己的一些调整以及蒂姆·威廉姆斯的意见解决了这个问题。这是其他可能需要帮助的人的代码

```
Public Function getData(fileName As String) As ADODB.Recordset

    Dim path As String
    path = "C:\testDir\"
    Dim cN As ADODB.Connection
    Dim RS As ADODB.Recordset
    Set cN = new ADODB.Connection
    Set RS = new ADODB.Recordset
    cN.Open ("Provider=Microsoft.Jet.OLEDB.4.0;" & _
                   "Data Source=" & path & ";" & _
                   "Extended Properties=""text; HDR=Yes; FMT=Delimited; IMEX=1;""")
    RS.ActiveConnection = cN
    RS.Source = "select * from " & fileName
    Set getData = RS

End Function 
```

现在，该函数可以称为

```
Dim a As ADODB.Recordset
Set a = getData("testFile.csv")
a.Open
MsgBox(a.GetString())
a.Close 
```

# java - 使用参数 null 重载方法调用

> ID：11635528
> 
> 赞同：16
> 
> 时间：2012-07-24T16:43:56.363
> 
> 标签：java, overloading

> **可能重复：**
> [NULL 参数的方法重载](https://stackoverflow.com/questions/5229809/method-overloading-for-null-parameter)

在下面的代码中，输出是

> 细绳

如果我删除带有类型参数的方法，`String`那么输出是

> 目的

我知道当参数类型不完全匹配时方法的重载是如何起作用的，但我不明白如何将**null**视为一个`Object`和/或`String`参数。

对此有何解释？

```
class C {

    static void m1(Object x) {
        System.out.print("Object");
    }
    static void m1(String x) {
        System.out.print("String");
    }

    public static void main(String[] args) {
        m1(null);
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-24T16:46:59.127

它总是根据[Java 规范](http://docs.oracle.com/javase/specs/jls/se5.0/html/expressions.html#15.12.2.5)第 15.12.2.5 节使用最具体的方法。

介绍是相当具体的：

> 如果多个成员方法既可访问又适用于方法调用，则有必要选择一个为运行时方法分派提供描述符。Java 编程语言使用选择最具体方法的规则。
> 
> 非正式的直觉是，如果第一个方法处理的任何调用可以传递给另一个方法而不会出现编译时类型错误，那么一个方法比另一个方法更具体。

一般来说，至少为了代码的可读性，最好尽可能地明确。您可以将您`null`的类型转换为与您要调用的签名匹配的类型。但这绝对是一个有问题的做法。它假设每个人都知道这条规则，并使代码更难阅读。

但这是一个很好的学术问题，所以我 +1 你的问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T16:48:10.093

当多个重载与一个签名匹配时，Java 会从中选择最具体的方法。

的值`null`同时匹配`Object`和`String`，但`String`它是 的子类`Object`，因此`String`被选中。如果`String`在类层次结构中添加另一个具有同级的重载，则会出现编译错误。\

```
// DOES NOT COMPILE
class C {
    static void m1(Object x) {
        System.out.print("Object");
    }
    static void m1(String x) {
        System.out.print("String");
    }
    static void m1(Integer x) {
        System.out.print("Integer");
    }
    public static void main(String[] args) {
        m1(null);
    }
} 
```

这是一篇[文章的链接，该文章](http://geekexplains.blogspot.com/2009/06/choosing-most-specific-method-tricky.html)详细讨论了您的代码示例。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-24T16:46:27.123

`null`如果您需要在作为参数传递时强制调用特定的重载方法，则必须对其进行强制转换，如下所示：

```
m1((String)null); 
```

通过这样做，您可以确保调用正确的重载版本的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T16:46:45.957

你必须设置类型`null`来告诉 Java 你想调用什么函数。

所以你这样做：`m1((Object) null);`用`Object`参数调用实现，然后`m1((String) null);`调用另一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T16:49:41.577

**1.**由于**String 也是一个对象**，**因此在****运行时**`JVM`会混淆调用哪个方法。

 ******2.**如果要指定在运行时调用哪个方法，可以通过**显式强制转换来实现**

**例如：**

```
m1((String)null); 
```****

# actionscript-3 - Actionscript 3动态创建的按钮未显示

> ID：11635531
> 
> 赞同：0
> 
> 时间：2012-07-24T16:43:59.453
> 
> 标签：actionscript-3, flash

我是 Flash 和 Actionscript 的新手。我有一部电影是从 C# 程序启动的。在电影中，我正在创建不同的文本字段并将数据传递回 C# 程序。我还有一个热点，当它被点击时，我想创建一个弹出的小菜单。我已经研究了很多方法来做到这一点，我决定最简单的方法（或者我认为）是在热点下方创建几个按钮。由于某种原因，当我单击热点时，按钮不会出现在舞台上。我知道它正在执行创建按钮的例程，因为我显示了一条消息。我已经发布了我的代码。谢谢您的帮助！！

```
import flash.text.TextField;
import fl.controls.Button; 
import flash.events.Event;

hotSpot.addEventListener(MouseEvent.CLICK, showMenu);

var continueBtn:Button;
var exitBtn:Button;

function showMenu(evt: Event):void
{
    continueBtn = new Button();

    continueBtn.x = 20;
    continueBtn.y = 100;
    continueBtn.width = 30;
    continueBtn.height = 20;
    continueBtn.border = true;
    continueBtn.visible = true;
    continueBtn.label = "Continue";
    addChild(continueBtn);

    exitBtn = new Button();

    exitBtn.x = continueBtn.x;
    exitBtn.y = continueBtn.y + continueBtn.height;
    exitBtn.width = 30;
    exitBtn.height = 20; 
    exitBtn.border = true;
    exitBtn.visible = true;
    exitBtn.label = "Exit";
    addChild(exitBtn);

    continueBtn.addEventListener(MouseEvent.CLICK, sendMsg);
    exitBtn.addEventListener(MouseEvent.CLICK, endFlash);

    inTxt.text = "showMenu";

} 
```

显示消息“showMenu”，但没有一个按钮显示。

加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:42:10.430

```
function showMenu(evt: Event):void 
```

evt 必须是“MouseEvent”而不是“Event”，因为您添加到“hotSpot”精灵（可能或其他显示对象）的侦听器是 MouseEvent 而不是 Event。

```
hotSpot.addEventListener(MouseEvent.CLICK, showMenu); 
```

这将调用 showMenu 函数，该函数侦听并捕获 MouseEvent 而不是 Event 事件。

您还只导入了事件，而是导入了 MouseEvent！新代码：

```
import flash.text.TextField;
import fl.controls.Button; 
import flash.events.MouseEvent; //This line changed!

hotSpot.addEventListener(MouseEvent.CLICK, showMenu);
var continueBtn:Button;
var exitBtn:Button;
 //This line changed!
function showMenu(evt:MouseEvent):void{
continueBtn = new Button();
continueBtn.x = 20;
continueBtn.y = 100;
continueBtn.width = 30;
continueBtn.height = 20;
continueBtn.border = true;
continueBtn.visible = true;
continueBtn.label = "Continue";
addChild(continueBtn);

exitBtn = new Button();

exitBtn.x = continueBtn.x;
exitBtn.y = continueBtn.y + continueBtn.height;
exitBtn.width = 30;
exitBtn.height = 20; 
exitBtn.border = true;
exitBtn.visible = true;
exitBtn.label = "Exit";
addChild(exitBtn);

continueBtn.addEventListener(MouseEvent.CLICK, sendMsg);
exitBtn.addEventListener(MouseEvent.CLICK, endFlash);

inTxt.text = "showMenu";
} 
```

# c# - 发送消息速度套接字

> ID：11635536
> 
> 赞同：1
> 
> 时间：2012-07-24T16:44:03.547
> 
> 标签：c#, performance, sockets, transfer

我一直在做一个项目，我在 C# 中将字符串从客户端发送到服务器。如果你们中的一些人有时间回答，我的问题如下：

*   我发送我的字符串如下：

    ```
    clientStream.Write(buffer, 0, buffer.Length);
    clientStream.Flush(); 
    ```

其中clientStream 是一个网络流。但是如果函数处于如下的while循环中，就会出现问题：

```
while(true)
{
        clientStream.Write(buffer, 0, buffer.Length);
        clientStream.Flush();
} 
```

消息似乎有时在服务器部分交织在一起并损坏。但如果我在 while 循环中添加一个 Thread.Sleep （可能有 30 个作为 in 参数）调用，则不会。我想知道如果它是 TCP 套接字连接，为什么消息会交织在一起？函数如何调用：

```
clientStream.Write(buffer, 0, buffer.Length);
clientStream.Flush(); 
```

工作？

*   通过 TCP 套接字连接每秒可以发送多少条消息？速度取决于什么？感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:49:46.523

不要总是刷新您的客户端流，您只想在写入周期结束时刷新，否则让 .NET 为您处理。每次发送东西时都刷新是低效的。

还要记住，TCP 流可以以不同的顺序到达，并在接收端重新组装以使用 TCP 序列号，这是透明地完成的，但是如果您通过 wireshark 查看流，那么您可能会看到这一点。

理论上，您可以通过带宽支持的套接字发送尽可能多的数据。但是你永远不应该回复 Thread.Sleeps ，因为有一天这会让你崩溃。依靠时间来进行这样的任何事情都被认为是“肮脏的黑客”并且会导致问题。

# sql-server-2008 - 使用 SSMS 2008 添加登录时出错

> ID：11635539
> 
> 赞同：1
> 
> 时间：2012-07-24T16:44:25.350
> 
> 标签：sql-server-2008, ssms, smo

我刚刚安装了 SQL Server Management Studio，我正在尝试添加一个基本登录名。（我对 SSMS 相当陌生）。

我已经连接到本地服务器，然后我右键单击`Security > Logins > New Login...`，然后我得到一个对话框，上面写着：

> 无法显示请求的对话框。(SqlMgmt)
> 无法读取属性排序规则。此属性在 SQL Server 7.0 上不可用。(Microsoft.SqlServer.Smo)

所以这是我要提出的问题。我确信它可能是一个简单的修复，但我似乎无法弄清楚。多谢你们！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:17:55.843

在 Management Studio 中，您的连接应该是以下之一：

```
localhost\SQLEXPRESS
(local)\SQLEXPRESS
.\SQLEXPRESS
YOUR_MACHINE_NAME\SQLEXPRESS 
```

您可能应该考虑卸载该 SQL Server 7.0 实例。

# wcf - wcf HMAC 总是失败

> ID：11635541
> 
> 赞同：0
> 
> 时间：2012-07-24T16:44:53.213
> 
> 标签：wcf, hmac

我正在尝试使用我的 SOAP WCF 服务实现 HMAC 授权解决方案。我已经有一个用于客户端和服务器的消息检查器。服务器似乎向不在请求中的消息添加了“操作”标头（由提琴手验证）。然后我就做

message.WriteBodyContents(xdw);

解决了这个问题，但是一些 xml 元素是自关闭的 (/>) 或者一些像“”一样关闭。

有什么建议么？

编辑。我还希望解决方案简单，到目前为止，这一切都是通过服务上的属性和客户端的单行语句完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T12:49:30.920

使用 .Net 中的 System.Security.Cryptography.Xml.XmlDsigC14NTransform 类对 XML 进行规范化，以便对语法不同但数据相似的两个 XML 进行规范化，并且可以逐字节比较哈希值。

# javascript - 单击图像 href=# 时，它会滚动到顶部

> ID：11635549
> 
> 赞同：0
> 
> 时间：2012-07-24T16:45:35.117
> 
> 标签：javascript, html

下面是我用于我的网站的代码每个图像链接都设置为在单击时前进到下一个图像问题是当我单击图像时页面会滚动回顶部。我想让这停止

我在 onclick 标记上使用了 return false 标记，但是当单击图像时，它会连续滚动图像数组。

有什么解决办法吗？下面是我的代码

```
<script language="JavaScript">

  <!-- -->

var interval = 1500;
var random_display = 0;
var imageDir = "imgs/";

var imageNum = 0;
imageArray = new Array();
imageArray[imageNum++] = new imageItem(imageDir + "1.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "2.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "3.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "4.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "5.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "6.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "7.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "8.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "9.jpg");
imageArray[imageNum++] = new imageItem(imageDir + "10.jpg");

var imageNumTwo = 0;
imageArrayTwo = new Array();
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t1.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t2.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t3.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t4.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t5.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t6.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t7.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t8.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t9.jpg");
imageArrayTwo[imageNumTwo++] = new imageItem(imageDir + "t10.jpg"); 

var imageNumThree = 0;
imageArrayThree = new Array();
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th1.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th2.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th3.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th4.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th5.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th6.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th7.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th8.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th9.jpg");
imageArrayThree[imageNumThree++] = new imageItem(imageDir + "th10.jpg");    

var totalImages = imageArray.length;
var totalImagesTwo = imageArrayTwo.length;
var totalImagesThree = imageArrayThree.length;

function imageItem(image_location) {
    this.image_item = new Image();
    this.image_item.src = image_location;
}
function get_ImageItemLocation(imageObj) {
    return(imageObj.image_item.src)
}

function randNum(x, y) {
    var range = y - x + 1;
    return Math.floor(Math.random() * range) + x;
}

function getNextImage() {
    if (random_display) {
        imageNum = randNum(0, totalImages-1);
    }
    else {
        imageNum = (imageNum+1) % totalImages;
    }   

    var new_image = get_ImageItemLocation(imageArray[imageNum]);
return(new_image);
}

function getNextImageTwo() {
    if (random_display) {
        imageNumTwo = randNum(0, totalImagesTwo-1);
    }
    else {
        imageNumTwo = (imageNumTwo+1) % totalImagesTwo;
    }   

    var new_image = get_ImageItemLocation(imageArrayTwo[imageNumTwo]);
return(new_image);
}

function getNextImageThree() {
    if (random_display) {
        imageNumThree = randNum(0, totalImagesTwo-1);
    }
    else {
        imageNumThree = (imageNumThree+1) % totalImagesThree;
    }   

    var new_image = get_ImageItemLocation(imageArrayThree[imageNumThree]);
return(new_image);
}

function prevImage(place) {
    var new_image = getPrevImage();
    document[place].src = new_image;
}

function switchImage(place) {
    var new_image = getNextImage();
    document[place].src = new_image;
    var recur_call = "switchImage('"+place+"')";
    timerID = setTimeout(recur_call, interval);
    }

function switchImageTwo(place) {
    var new_image = getNextImageTwo();
    document[place].src = new_image;
    var recur_call = "switchImageTwo('"+place+"')";
    timerID = setTimeout(recur_call, interval);
    }

function switchImageThree(place) {
    var new_image = getNextImageThree();
    document[place].src = new_image;
    var recur_call = "switchImageThree('"+place+"')";
    timerID = setTimeout(recur_call, interval);
    }

</script>

  </head>

<body>

<div id="content">
<div id="title"><a href="mailto:hello@a.com"><center><img src="imgs/adil.gif" alt="A D I L" width="293" height="115" border="0"></center></a></div>
<div id="books">
  <p><a href="#" onclick="switchImage('slideImg'); clearTimeout(timerID)"><img src="imgs/1.jpg" name="slideImg" width="300" height="427" border="0"></a>
  <img src="imgs/px.gif" width="40">
  <a href="#" onclick="switchImageTwo('slideImg2'); clearTimeout(timerID)"><img src="imgs/t1.jpg" name="slideImg2" width="300" height="423" border="0"></a>
  <img src="imgs/px.gif" width="40">
  <a href="#" onclick="switchImageThree('slideImg3'); clearTimeout(timerID)"><img src="imgs/th1.jpg" name="slideImg3" width="300" height="427" border="0"></a>
  <img src="imgs/px.gif" width="993" height="40"></p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:48:41.557

我认为您只需要从单击处理程序调用的任何函数中返回 false 即可。

# xslt - 获取节点集的属性集合

> ID：11635552
> 
> 赞同：0
> 
> 时间：2012-07-24T16:45:42.623
> 
> 标签：xslt, xpath

我有一个这样的节点集合

```
<node id="1">
  <languaje>c</languaje>
  <os>linux</os> 
</node>
<node id="2">
  <languaje>c++</languaje>
  <os>linux</os> 
</node>
<node id="3">
  <languaje>c#</languaje>
  <os>window</os> 
</node>
<node id="4">
  <languaje>basic</languaje>
  <os>mac</os> 
</node> 
```

我想创建一个像这样的所有属性 id 的新集合

```
<root>
 <token>1</token>
 <token>2</token>
 <token>3</token>
 <token>4</token>
</root> 
```

怎么能这样

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:05:39.380

所有你需要的是

```
<xsl:output indent="yes"/>

<xsl:template match="*[node]">
  <root>
    <xsl:apply-templates select="node"/>
  </root>
</xsl:template>

<xsl:template match="node">
  <token><xsl:value-of select="@id"/></token>
</xsl:template> 
```

如果要将结果存储在变量中，可以使用 XSLT 1.0 创建结果树片段，例如

```
<xsl:variable name="rtf1">
  <xsl:apply-templates select="node()" mode="m1"/>
</xsl:variable>

    <xsl:template match="*[node]" mode="m1">
      <root>
        <xsl:apply-templates select="node" mode="m1"/>
      </root>
    </xsl:template>

    <xsl:template match="node" mode="m1">
      <token><xsl:value-of select="@id"/></token>
    </xsl:template> 
```

然后您可以`<xsl:copy-of select="$rtf1"/>`使用结果树片段，或者使用“exsl:node-set”，您可以使用 XPath 和 XSLT 处理创建的节点，例如

```
<xsl:apply-templates select="exsl:node-set($rtf1)/root/token"/> 
```

使用 XSLT 2.0 不再有结果树片段，因此您可以像使用任何输入一样使用变量，而无需扩展函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:07:51.567

如果您可以使用 XQuery，您可以这样做：

```
<root>
   { ($document/node/<node>{string(@id)}</node>) }
</root> 
```

这是最清晰的解决方案。

否则，您可以通过连接标签和您的 ids 来使用 XPath 2 创建一个包含所需结果的字符串（不是文档）：

```
concat("<root>", string-join(for $i in /base/node/@id return concat("<node>",$i,"</node>"), " ") , "</root>") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:23:27.897

如果将所有节点包装在标签下，例如 <nodes> ，则可以：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
<root>
  <xsl:apply-templates select="*" />
</root>
</xsl:template>

<!-- templates -->
  <xsl:template match="node">
  <token><xsl:value-of select="@id" /></token>
</xsl:template>
</xsl:stylesheet> 
```

在 XsltCake 上测试

[http://www.xsltcake.com/slices/E937yH](http://www.xsltcake.com/slices/E937yH)

# css - CSS：非常简单的图片库

> ID：11635556
> 
> 赞同：1
> 
> 时间：2012-07-24T16:45:54.197
> 
> 标签：css, html, image

我并不总是做 Web 开发，但是当我做 CSS 时，我能想象到最令人沮丧的事情。我正在尝试创建一个简单的类来保存图像和描述。我想要两行，每行有三个图像。非常简单。

这是我仅显示图像的代码，可以正常工作。

```
img {
  position: relative;
  margin: 0 auto;
  max-width: 650px;
  padding: 5px;
  margin: 10px 0 5px 0;
  border: 1px solid #ccc;  
}

<h3>Screenshots</h3>

<p>
<a href="images/img1.png"><img src="images/img1.png" width="200" height="140"></a>
<a href="images/img2.png"><img src="images/img2.png" width="200" height="140"></a>
<a href="images/img3.png"><img src="images/img3.png" width="200" height="140"></a>
<a href="images/img4.png"><img src="images/img4.png" width="200" height="140"></a>
<a href="images/img5.png"><img src="images/img5.png" width="200" height="140"></a>
<a href="images/img6.png"><img src="images/img6.png" width="200" height="140"></a>
</p>

<h3>Installation</h3> 
```

这完全按照我的意愿显示图像，每行三个，然后是 < p > 的填充，然后是*安装*部分。为了在同一 div 中的图像下获取描述，我将 css 中的 img 更改为 div.img 并将 htm 代码更改为：

```
<h3>Screenshots</h3>

<p>
<div class="img">
  <a target="_blank" href="images/img1.png"><img src="images/img1.png" width="200" height="140"></a>
</div>
<div class="img">
  <a target="_blank" href="images/img1.png"><img src="images/img1.png" width="200" height="140"></a>
</div>
<div class="img">
  <a target="_blank" href="images/img1.png"><img src="images/img1.png" width="200" height="140"></a>
</div>
<div class="img">
  <a target="_blank" href="images/img1.png"><img src="images/img1.png" width="200" height="140"></a>
</div>
<div class="img">
  <a target="_blank" href="images/img1.png"><img src="images/img1.png" width="200" height="140"></a>
</div>
<div class="img">
  <a target="_blank" href="images/img1.png"><img src="images/img1.png" width="200" height="140"></a>
</div>
</p>

<h3>Installation</h3> 
```

有人会认为生成的网页将与第一种情况下的 img 完全相同，而第二种情况下的 div.img 具有相同的属性。但事实并非如此。使用此代码，我将每个 div 拉伸到列的整个宽度，并且图像在 div 的左侧是一个在另一个之下。

我也尝试过这段代码：[http](http://www.w3schools.com/CSS/css_image_gallery.asp) ://www.w3schools.com/CSS/css_image_gallery.asp ，但在这种情况下，我得到了*安装*，随后的所有文本都进入图像，忽略具有底部边距的 < p > 标签.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:49:44.680

为了简单起见：用`<span>`元素替换你的 div，或者`display: inline`在你的 CSS 上为 div 设置。这将使它们的行为符合您的预期（作为*inline*，而不是*块*元素）。

还：

*   你不需要`margin: 0 auto`. 它不会像块元素那样居中内联元素
*   您添加了`position: relative`，但似乎也不需要它。除非您打算`absolute`稍后将位置应用于 div 内的某些内容。

这是一个没有这两个属性的 jsfiddle，并添加`display: inline`到 div：http: [//jsfiddle.net/3BwKY/](http://jsfiddle.net/3BwKY/)。

# iphone - 加快 xCode 中的编译速度

> ID：11635558
> 
> 赞同：3
> 
> 时间：2012-07-24T16:46:07.600
> 
> 标签：iphone, ios, xcode, compilation

我有一个相当大的项目，在带有 i5 处理器的 Mac 上编译需要 1 个多小时。只需在一处更改一小段代码，就需要进行完整的长时间编译。

**有什么办法可以减少这个时间吗？**

如果有类似的话，我正在考虑“预编译类”或“预链接”。即使将一个小应用程序上传到设备也需要 10 秒。

ps 在这种情况下，任何人都可以提供一些经验，xCode4.3 在新的 Mac Retinas 上是否更快？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:59:35.997

1) 使用预编译的头文件并删除 Xcode 在创建类时添加的那些文件（UIKite、Foundation、Cocoa 等）的任何导入）

2) 在 .pch 中添加合理的稳定用户头文件 - 以减少预编译工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:02:37.680

*   在您的类中，在实现文件 (.m) 中进行大部分导入，而不是在标题中。适当时使用前向声明。请参阅“ [@class 与 #import](https://stackoverflow.com/a/1350029/250164) ”和“[在目标 c 中导入标头](https://stackoverflow.com/a/10531937/250164)”

*   您可能会考虑将主项目的稳定且受限的部分移动到单独的项目中，并将其作为静态库包含在主项目中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T09:05:16.440

最近，我删除了一些我一直作为`.a`文件引用的库，并将代码与代码一起移入。速度惊人地提高了。编译过去需要 15 分钟，现在需要 15 秒。索引过去需要一整天才能完成（及时关闭），但现在它真的很快。该库位于网络驱动器上，这可能会加剧问题。

# java - Java 输入缓冲区垃圾

> ID：11635559
> 
> 赞同：-1
> 
> 时间：2012-07-24T16:46:19.807
> 
> 标签：java

为什么在这样的代码块中清空输入缓冲区中的“垃圾”是一种好的做法？如果我不这样做会怎样？

```
try{
    age = scanner.nextInt();
    // If the exception is thrown, the following line will be skipped over.
    // The flow of execution goes directly to the catch statement (Hence, Exception is caught)
    finish = true;
} catch(InputMismatchException e) {
    System.out.println("Invalid input. age must be a number.");
    // The following line empties the "garbage" left in the input buffer
    scanner.next();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:53:04.907

假设您正在循环读取扫描仪，如果您不跳过无效令牌，您将永远继续阅读它。就是这样`scanner.next()`做的：它将扫描仪移动到下一个令牌。请参阅下面的简单示例，该示例输出：

> 发现 int: 123
> 输入无效。年龄必须是一个数字。
> 跳过：abc
> 找到 int：456

如果没有该`String s = scanner.next()`行，它将继续打印“无效输入”（您可以尝试注释掉最后两行）。

* * *

```
public static void main(String[] args) {
    Scanner scanner = new Scanner("123 abc 456");
    while (scanner.hasNext()) {
        try {
            int age = scanner.nextInt();
            System.out.println("Found int: " + age);
        } catch (InputMismatchException e) {
            System.out.println("Invalid input. age must be a number.");
            String s = scanner.next();
            System.out.println("Skipping: " + s);
        }
    }
} 
```

# javascript - 代码在哪里更改另一个选项

> ID：11635563
> 
> 赞同：1
> 
> 时间：2012-07-24T16:46:39.703
> 
> 标签：javascript, html

我在 Javascript 中编写了相同的代码，当用户更改状态时，它将更改城市下拉列表中的选项。

代码的问题是它不起作用。我认为该代码还可以，但是我对 JavaScript 很陌生，所以我看不到错误。

你能检查我的代码，看看我在哪里出错了。谢谢。

JavaScript：

```
function drzava_promjena() {
    var obj_state = document.getElementById("id_drzava")
    var index = obj_states.selectedIndex;
    var value_state = obj_state.options[index].value;
    towns = town_list[value_state];
    var obj_town = document.getElementById("id_gradovi");
    while (obj_town.options.length > 0) {
        obj_town.remove(0);
    }
    var new_value;
    for (var i = 0; i < towns.length; i++) {
        new_value = document.createElement("option");
        new_value.value = towns[i];
        new_value.text = towns[i];
        try {
            obj_town.add(new_value);
        } catch (e) {
            obj_town.appendChild(new_value);
        }
    } 
```

这是 HTML：

```
 <select id="id_drzava" onchange="drzava_promjena(this);">
        <option value="Austrija">Austrija</option>
        <option value="Njemacka">Njemacka</option>
        <option value="Slovenija">Slovenija</option>
        <option value="Ceska">Ceska</option>
    </select>
    <br>
    <select id="id_gradovi" onchange="">
        <option value="0"></option> 
    </select>
    <br>
    <select id="id_uni" onchange="">
        <option></option>
    </select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:21:32.263

试试下面的代码。我还[提出了一个小提琴](http://jsfiddle.net/stevenschobert/nqwv8/)来演示。

JavaScript：

```
var populateCities = function (country, target_id) {
    var i = 0, options, cities, selection, target;

    cities = {
        "usa": {
            "dallas": "dal",
            "san francisco": "sf",
            "houston": "hou"
        },
        "fr": {
            "paris": "pr",
            "la riche": "lr"
        }
    };

    selection = country.options[country.selectedIndex].value;
    target = document.getElementById(target_id);
    target.options.length = 0;

    if(selection !== 'none') {
        options = cities[selection];

        for(var city in options) {
            target.options[i] = new Option(city, options[city]);
            i++;
        }
    }
}​ 
```

HTML：

```
<select id="country" onchange="populateCities(this, 'cities')">
    <option selected value="none">Pick a country</option>
    <option value="usa">USA</option>
    <option value="fr">France</option>
</select>
<select id="cities"></select> 
```

# algorithm - 计算将硬币放在网格上的方法

> ID：11635567
> 
> 赞同：3
> 
> 时间：2012-07-24T16:46:52.197
> 
> 标签：algorithm

这个问题要求我们找出在 N*M 网格上放置 R 个硬币的方法的数量，使得每一行和每一列至少有一个硬币。给定的约束是 N、M < 200、R < N*M。我最初想到回溯，但我意识到它永远不会及时完成。有人可以指导我找到另一种解决方案吗？（DP，封闭式公式。）任何指针都会很好。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:31:23.020

## 回答

根据[OEIS 序列 A055602](http://oeis.org/A055602)，一种可能的解决方案是：

```
Let a(m, n, r) = Sum_{i=0..m} (-1)^i*binomial(m, i)*binomial((m-i)*n, r)

Answer = Sum_{i=0..N} (-1)^i*binomial(N, i)*a(M, N-i, R) 
```

您将需要为 a 评估 N+1 个不同的值。

假设您已经预先计算了二项式系数，a 的每次评估都是 O(M)，因此总复杂度是 O(NM)。

## 解释

这个公式可以使用[包含排除原理](http://en.wikipedia.org/wiki/Inclusion%E2%80%93exclusion_principle)两次推导出来。

a(m,n,r) 是将 r 个硬币放在大小为 m*n 的网格上的方式数，这样 m 列中的每一列都被占用，但并非所有行都必须被占用。

包含-排除将此变成正确答案。（想法是我们从 a(M,N,R) 中得到我们的第一个估计值。这高估了正确答案，因为并非所有行都被占用，所以我们减去只占用 N 的情况 a(M,N-1,R) -1 行。然后这低估了所以我们需要再次更正......）

类似地，我们可以通过考虑 b(m,n,r) 来计算 a(m,n,r)，它是在我们不关心行或列被占用的网格上放置 r 个硬币的方式的数量。这可以简单地从在网格大小 m*n 中选择 r 个位置的方式数得出，即二项式 (m*n,r)。我们使用 IE 将其转换为函数 a(m,n,r)，我们知道所有列都被占用。

如果您想对每个方格上的硬币数量允许不同的条件，那么您只需将 b(m,n,r) 更改为适当的计数函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:59:33.763

这很难，但如果你首先计算出每行和每列至少有一枚硬币（称为储备硬币）有多少种方法。答案将是 #1 的乘积`(n! / r! (n - r)!) *`，其中 #2`n = N*M - NUMBER_OF_RESERVE_COINS`和 #3`r = (R - NUMBER_OF_RESERVE_COINS)`表示 #4 的每一种安排，在每一行/列上保留一个硬币。

#4 是更棘手的事情发生的地方。对于 N*M，其中 N!=M，`abs(N-M)`告诉您单行/列上将有多少储备硬币。我无法确定进行下一步的正确方法，主要是因为时间不够（虽然我可以在周末回到这里），但我希望我已经为您提供了有用的信息，如果我说的是正确的，您将能够完成该过程。

# c# - 如何让这个 LINQ 全外连接正常工作？

> ID：11635568
> 
> 赞同：3
> 
> 时间：2012-07-24T16:46:55.990
> 
> 标签：c#, .net, linq, full-outer-join

我正在构建一个 WPF 应用程序来监视用户计算机上的目录。该应用程序从受监控的目录上传文件，然后将一些信息保存到 SQLite 数据库中。部分业务处理是不重新处理已上传的文件，并重新上传已上传但自上次上传后发生更改的文件。

我有两个辅助方法来构建并返回一个`List<FileMetaData>`我使用[LINQ - Full Outer Join](https://stackoverflow.com/questions/5489987/linq-full-outer-join)来加入的。`FileMetaData`我的问题是当我使用我的对象时代码似乎不起作用。似乎一切都应该正常工作，但我不知道为什么它不工作。我通常会尝试在另一个线程上发表评论，但我目前没有“代表”来执行此操作。

下面是我构建的一个示例，如果您在[LINQpad](http://www.linqpad.net/)中运行它，它会显示我的问题。在单击运行按钮之前，请确保将语言设置为“C# 程序”。为了让样本与对象一起工作，我应该做些什么不同的事情？万分感谢！

```
 void Main()
    {
        var dbItems = new List<FileMetaData>() { 
                new FileMetaData {FilePath = "C:\\Foo.txt", DbTimestamp = "1" },
                new FileMetaData {FilePath = "C:\\FooBar.txt", DbTimestamp = "3" },
            };

        var fsItems = new List<FileMetaData>() {
                new FileMetaData {FilePath = "C:\\Bar.txt", FsTimestamp = "2" },
                new FileMetaData {FilePath = "C:\\FooBar.txt", FsTimestamp = "3" },
            };

            var leftOuter = from d in dbItems
                    join f in fsItems on d.FilePath equals f.FilePath
                    into temp
                    from o in temp.DefaultIfEmpty(new FileMetaData(){})
                    select new FileMetaData { 
                        FilePath = d.FilePath, 
                        DbTimestamp = d.DbTimestamp,
                        FsTimestamp = o.FsTimestamp,
                    };

            var rightOuter = from f in fsItems
                    join d in dbItems on f.FilePath equals d.FilePath
                    into temp
                    from o in temp.DefaultIfEmpty(new FileMetaData(){})
                    select new FileMetaData { 
                        FilePath = f.FilePath, 
                        DbTimestamp = o.DbTimestamp,
                        FsTimestamp = f.FsTimestamp,
                    };

            var full = leftOuter.AsEnumerable().Union(rightOuter.AsEnumerable());

            leftOuter.Dump("Left Results");
            rightOuter.Dump("Right Results");

            full.Dump("Full Results");
    }

    // Define other methods and classes here
    public class FileMetaData
    {
        public string FilePath;
        public string DbTimestamp;
        public string FsTimestamp;
    } 
```

编辑：

下面的答案正是我想要的。我实现了`IEqualityComparer`如下定义并将我的调用更改为`var full = leftOuter.Union(rightOuter, new FileMetaDataCompare())`...

```
 public class FileMetaDataCompare : IEqualityComparer<FileMetaData>
    {
        public bool Equals(FileMetaData x, FileMetaData y)
        {
            var areEqual = x.FilePath == y.FilePath;
            areEqual = areEqual && x.DbTimestamp == y.DbTimestamp;
            areEqual = areEqual && x.FsTimestamp == y.FsTimestamp;

            return areEqual;
        }

        public int GetHashCode(FileMetaData obj)
        {
            var hCode = string.Concat(obj.FilePath, obj.DbTimestamp, obj.FsTimestamp);
            return hCode.GetHashCode();
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:40:11.220

问题在于，这`Union`将为您提供通过检查相等性来*消除重复项的结果。*当您使用匿名类型时，相等的定义是“所有字段都具有相等的值”。当您声明一个类型时，它将使用该`Equals`方法。由于您没有覆盖`Equals`，它默认为`ReferenceEquals`，这意味着无论它们的字段值如何，两个单独的实例都不相等。

解决这个问题的三种方法：

1）在查询中使用匿名类型并在联合之后转换为定义的类型：

```
var full = leftOuter.Union(rightOuter).Select(
    i=> new FileMetaData {
        FilePath = i.FilePath,
        DbTimestamp = i.DbTimestamp,
        FsTimestamp = i.FsTimestamp
    }); 
```

2）定义一个`IEqualityComparer<FileMetaData>`定义相等性的类（只是FilePath？所有字段？）并将它的实例传递给`Union()`

3）覆盖`Equals()`（和`GetHashCode()`）在`FileMetaData`。

2) 和 3) 将非常相似，但`Equals()`无论何时检查是否相等，都可以（并且将）使用覆盖，而不仅仅是在这种情况下。

# mysql - 使用“WHERE IN”的 Rails 3.2 查询不使用我的主键作为索引

> ID：11635569
> 
> 赞同：0
> 
> 时间：2012-07-24T16:46:57.727
> 
> 标签：mysql, ruby-on-rails-3, ruby-on-rails-3.2

我有一个 Rails 3.2 应用程序，我试图在其中获取一组用户。我的 Rails 查询代码如下所示：

```
@users = User.where("user_id IN (?)", foo) 
```

生成以下 SQL：

```
SELECT 'users'.* FROM 'users' WHERE id IN (1, 2, 3, 4) 
```

当我对此查询运行解释时，它正在搜索我的用户表中的所有行。它`PRIMARY`在该`possible_keys`字段下列出，但键显示为空。

如果我删除“IN (?)”部分并只提取一条记录：

```
@user = User.where("user_id = ?", bar) 
```

生成

```
SELECT 'users'.* FROM 'users' WHERE id = 1 
```

然后使用主键作为索引执行查询，只搜索一行。

知道为什么这在我的第一个示例中不起作用吗？我是否在 Rails 中错误地构造了这个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:38:53.333

问题不在于 Rails，这是“如何”编写你的 sql。

当您使用“in”子句时，查询不要使用它的索引。

您可以查看以下链接：

[MySQL 不使用带有 WHERE IN 子句的索引？](https://stackoverflow.com/questions/586381/mysql-not-using-indexes-with-where-in-clause)

[http://dev.mysql.com/doc/refman/5.1/en/mysql-indexes.html](http://dev.mysql.com/doc/refman/5.1/en/mysql-indexes.html)

# c# - 如何使用 Booksleeve 从 Redis 返回 C# 位数组

> ID：11635571
> 
> 赞同：1
> 
> 时间：2012-07-24T16:46:59.793
> 
> 标签：c#, redis, booksleeve

我可能正在处理这一切都错了，但我想使用 REDIS 位图来跟踪我的应用程序中的活动。我有一段代码如下：

```
 using (var conn = new RedisConnection("localhost"))
        {
            conn.Open();

            var b1 = conn.Strings.SetBit(1, "test:2012-07-25", 1, true);
            conn.Wait(b1);

            var b2 = conn.Strings.SetBit(1, "test:2012-07-25", 3, true);
            conn.Wait(b2);

            var arr = conn.Strings.Get(1, "test:2012-07-25");
            conn.Wait(arr);

            BitArray bits = new BitArray(arr.Result);

        } 
```

我可以毫无问题地添加条目（b1 和 b2）。但是，当我尝试将位图作为位数组从服务器取回时，它无法正常工作（我得到一个值，但设置的位完全不正确）。我假设我在使用 Strings.Get 函数尝试返回位时做错了，但我不知道该怎么做。唯一明显的方法是在我感兴趣的每个日期对 getbit 进行单独调用，但这似乎会给服务器带来大量往返。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:59:49.760

对不起，伙计们，正在返回正确的结果，我读错了。确实有两个陷阱：

*   这些位是从右向左写入的。当返回一个字节时，它基本上与预期的顺序相反（至少在我看来）。所以在上面的例子中。我被发回了一个看起来像这样的字节（与我预期的相反）

[0] 假 [1] 假 [2] 假 [3] 假 [4] 真 [5] 假 [6] 真 [7] 假

*   您需要按字节顺序读取。字节 0 将包含前 8 位，1 包含下一组位，无穷无尽。由于第 1 点中提到的位反转，这一点很重要。如果在我的原始示例中，我在 Redis 中将偏移量 10 设置为 true，这将显示在位位置 13。这是因为偏移量（位）0-7 存储在第一个字节中，而偏移量 8-15 存储在第二个字节。偏移量 10 是存储在第二个字节中的第三个，由于它是反向的，我们从 15,14...13 倒数

我想关键实际上是在处理之前反转字节/位......希望这对未来的人有所帮助......

# ruby - 结合 Nokogiri XML 构建器

> ID：11635572
> 
> 赞同：10
> 
> 时间：2012-07-24T16:47:01.370
> 
> 标签：ruby, xml, nokogiri

我喜欢这个`Nokogiri::XML::Builder`结构，但是如果我可以通过在几个构建器之间拆分工作来进一步模块化构建过程，那么组装大型 XML 文档会更容易。

有没有人看到**让多个建筑商合作**的方法？（例如，父构建器调用设置子构建器以创建文档的较小部分的函数）

或者有没有办法在它的块终止后修改构建器？（---缺少输出XML，然后将其解析为Nokogiri::XML::Document，然后添加节点，然后再次输出XML）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-24T22:30:18.837

## Delegating Builder Functionality

> *for instance, a parent builder calling functions that set child builders to create smaller portions of the document*

You can easily delegate responsibility to methods that take the builder's current state and use it. For example:

```
require 'nokogiri'

def add_kids_for(name,xml)
  xml.send(name){ 1.upto(3){ |i| xml.kid("#{name}'s kid ##{i}") } }
end

build = Nokogiri::XML::Builder.new do |xml|
  xml.root do
    add_kids_for("Danny",xml)
    add_kids_for("Billy",xml)
  end
end
puts build.to_xml
#=> <?xml version="1.0"?>
#=> <root>
#=>   <Danny>
#=>     <kid>Danny's kid #1</kid>
#=>     <kid>Danny's kid #2</kid>
#=>     <kid>Danny's kid #3</kid>
#=>   </Danny>
#=>   <Billy>
#=>     <kid>Billy's kid #1</kid>
#=>     <kid>Billy's kid #2</kid>
#=>     <kid>Billy's kid #3</kid>
#=>   </Billy>
#=> </root> 
```

Just pass the `xml` (or whatever you call your builder object) to the method and let that method do what it needs to (either procedurally or manually).

## Modifying a Builder after Creation

> *Or is there a way to modify a builder after its block terminates?*

Yes! :) You want to the `doc` method of the Builder to get the `Nokogiri::XML::Document` driving it. Carrying on the above example:

```
doc = build.doc
doc.css('kid').each do |kid|
  kid['name'] = %w[Bobby Jenny Jill Sam Gish Gavin Lisa Imogen Lachlan].sample
end
puts doc
#=> <root>
#=>   <Danny>
#=>     <kid name="Lisa">Danny's kid #1</kid>
#=>     <kid name="Imogen">Danny's kid #2</kid>
#=>     <kid name="Lachlan">Danny's kid #3</kid>
#=>   </Danny>
#=>   <Billy>
#=>     <kid name="Gish">Billy's kid #1</kid>
#=>     <kid name="Gavin">Billy's kid #2</kid>
#=>     <kid name="Sam">Billy's kid #3</kid>
#=>   </Billy>
#=> </root> 
```

# objective-c - UIImagePickerController 与带有固定大小照片的照片库

> ID：11635577
> 
> 赞同：0
> 
> 时间：2012-07-24T16:47:37.867
> 
> 标签：objective-c, uiimagepickercontroller, fixed

我有一些代码：

```
pV = [[UIImagePickerController alloc] init];
pV.delegate = self;
pV.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;

[self presentModalViewController:pV animated:YES]; 
```

我尝试只显示照片库中尺寸为 X 和 Y 的这些图像。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:31:02.540

您需要实现自己的图像选择器并按属性过滤 ALAsset

# javascript - Twitter 内嵌推文 移除 @reply

> ID：11635579
> 
> 赞同：1
> 
> 时间：2012-07-24T16:47:40.953
> 
> 标签：javascript, api, twitter, tweets

我尝试使用 twitter 新嵌入[的推](https://dev.twitter.com/docs/embedded-tweets)文嵌入推文，但我不希望 @reply 显示。我希望从同一个对话中嵌入多条推文，但不想要冗余信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:28:29.247

添加`.twt-actions { display: none; }`到您的 CSS 中，这将删除“回复”、“转发”和“收藏”操作。

# php - json_decode 失败

> ID：11635580
> 
> 赞同：0
> 
> 时间：2012-07-24T16:47:41.417
> 
> 标签：php, json

我对 json 很陌生，我遇到了 json_decode 的问题。我想我知道为什么，但我无法弄清楚如何解决它。

基本上，我有一个提供 json 信息的 URL。我使用 cURL 抓取它，并将其作为 PHP 变量返回，这很好用。我可以打印出我想要的所有信息。但是，当我使用 json_decode($json, true) 时，它返回 NULL。

我认为这是因为从技术上讲，返回的不是字符串，而是更像一个对象——我无法弄清楚如何获取该对象的内容。

例如，当我将 json 内容作为 php 变量返回时：

```
print_r($json); 
```

返回的输出看起来像这样（我不会完全这样做，因为它很大，所以我将向您展示布局以使其保持简单）

```
MyThing.returnedItems({MyThing.returnedItems({
"projects":[{
    "completed":"2010-12-21",
    "status":"finished",
    "favorited":0,
    "started":"2010-12-20",
    "percentage":78,
    "permalink":"slug to post",
    "size":"One size",
    "thumbnail":{"src":"full path to full size image",
                 "medium":"full path to thumbnail"},
    "name":"Some title here",
    "notes":"description here",
    "url":"URL to page",
    "comments":0}, 
```

所以你可以看到它就像一个嵌套数组。我不介意，但我希望能够将这些数组的所有键/值对作为 PHP 变量访问。但似乎因为围绕它的“MyThing.returnedItems()”，它没有将其视为要解码的字符串，所以我每次都得到一个 NULL 值。

有人知道我在这里缺少什么吗？一旦我弄清楚如何抓住里面的东西，我想我已经得到了它（简单的 foreach 或其他根据需要获取变量的东西），但我似乎无法进入那里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:52:48.777

这是有效的 JSON

```
{
"item1": [
    {
        "something": [],
        "something else": "some value"
    }
],
"another fun thing": [
    {
        "more fun": "fun value 1",
        "even more!": "fun value 2"
    }
],
"item2": {
    "another thing": "another value"
}
} 
```

这不是！

```
 MyThing.returnedItems({
 "item1":[{"something:[],
           "something else": "some value"},
           "another fun thing": [{"more fun": "fun value 1",
                                  "even more!": "fun value 2"}]
         ],
 "item2":{"another thing": "another value"}
 }) 
```

它是一个javascript方法调用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:55:09.717

好的，我只是想补充一点，你们真的帮助了我。尤其是 MaX，因为通过了解正在发生的事情的“官方术语”，我更好地搜索并最终找到了一些非常有趣的代码，最终让我找到了我的解决方案。但是，我确实发现了将我的 json 包装在那个奇怪的函数方法调用中的原因：该站点为我提供的用于访问其 API 的 URL 实际上包含该调用，因此它被包装在其中返回。换句话说，我得到的 json 文件 URL 是这样的：

```
somesite.com/apicall.json?key=1234567890&callback=MyThing&version=0... 
```

因此，一旦我删除了“回调”部分 - BAM，json 就不再被包装，一个全新的 foreach 函数世界向我打开了。所以，即使解决方案最终对我来说是一个非常愚蠢的疏忽，我还是要感谢大家的投入，因为我学到了很多我今天不打算学习的东西 XD

哦，实际上最终工作的代码（在我摆脱了 URL 的回调部分之后，因为 json_decode 仍然在我身上返回 NULL）是这样的：

```
$data = json_decode(file_get_contents($json), true);
print_r($data); // array of everything available for me to mess with! 
```

再次感谢大家的帮助：）我真的很感激！

# c# - 如何使用自定义 IXmlSerializable 作为 XmlAttribute？

> ID：11635582
> 
> 赞同：9
> 
> 时间：2012-07-24T16:47:41.490
> 
> 标签：c#, xml

我`IXmlSerializable`为以下类型实现，它将 RGB 颜色值编码为单个字符串：

```
public class SerializableColor : IXmlSerializable
{
    public int R { get; set; }
    public int G { get; set; }
    public int B { get; set; }

    public XmlSchema GetSchema()
    {
        return null;
    }

    public void ReadXml(XmlReader reader)
    {
        var data = reader.ReadString();
        reader.ReadEndElement();
        var split = data.Split(' ');
        R = int.Parse(split[0]);
        G = int.Parse(split[1]);
        B = int.Parse(split[2]);
    }

    public void WriteXml(XmlWriter writer)
    {
        writer.WriteString(R + " " + G + " " + B);
    }
} 
```

由于它是单个字符串，因此我想将其存储为属性以节省空间。但是，一旦我将其添加`[XmlAttribute]`到我的属性中，就会出现以下异常：

> {“无法序列化 SerializableColor 类型的成员 'Color'。XmlAttribute/XmlText 不能用于编码实现 IXmlSerializable 的类型。”}

有没有办法让它也作为一个属性工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-25T02:33:08.967

[遗憾的是（奇怪的是）根据此链接http://connect.microsoft.com/VisualStudio/feedback/details/277641/xmlattribute-xmltext-cannot-be-used-to-encode-types-implementing-ixmlserializable](http://connect.microsoft.com/VisualStudio/feedback/details/277641/xmlattribute-xmltext-cannot-be-used-to-encode-types-implementing-ixmlserializable)是不可能的

为了解决这个问题，我目前正在使用 XmlIgnore 属性来隐藏复杂属性并通过另一个属性将其公开为字符串

```
public class MyDto
{
    [XmlAttribute(AttributeName = "complex-attribute")]
    public string MyComplexPropertyAsString
    {
        get { return MyComplexMember.ToString(); }
        set { MyComplexMember.LoadFromString(value); }
    }
    [XmlIgnore]
    public MyComplexMember At { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T18:07:16.913

错误的意思正是它所说的。当实现 IXmlSerializable 时，您不能使用这些 XML 序列化属性，因为 IXmlSerializable 期望 XML 序列化是完全自定义的。如果要使用 XmlSerializer 使用属性使类可序列化，则可以执行此操作。

```
[XmlRoot("SerializableColor")]
public class SerializableColor
{
    [XmlAttribute("R")]
    public int R { get; set; }
    [XmlAttribute("G")]
    public int R { get; set; }
    [XmlAttribute("B")]
    public int B { get; set; }    
} 
```

此外，对于 XmlSerializable 的实现：

```
 public void ReadXml(XmlReader reader)
    {
        string data = null;

        reader.MoveToAttribute("Color");
        if (reader.ReadAttributeValue())
        {
            data = reader.Value;
        }
        reader.ReadEndElement();

        var split = data.Split(' ');
        R = int.Parse(split[0]);
        G = int.Parse(split[1]);
        B = int.Parse(split[2]);
    }

    public void WriteXml(XmlWriter writer)
    {
        writer.WriteAttributeString("Color", R + " " + G + " " + B);
    } 
```

另一方面，如果您希望能够做的只是用一个短字符串表示一种可逆的颜色，请查看[ColorTranslator 类](http://msdn.microsoft.com/en-us/library/system.drawing.colortranslator.aspx)。特别是，请参阅 FromHtml 和 ToHtml 方法。

# javascript - document.referrer 和 close()

> ID：11635583
> 
> 赞同：0
> 
> 时间：2012-07-24T16:47:58.433
> 
> 标签：javascript, if-statement, referrer

我在页面上有以下脚本，比如说“child.html”。

`opener.opener = opener; opener.close()`如果引用 URL 是脚本语句 (parent.html) 中列出的 URL，我只希望浏览器看到该函数`if`，否则我不希望浏览器看到它。

此脚本所在的页面是父页面的子页面（弹出窗口）。用户（希望）只会访问父页面，随后将使用该`opener.opener = opener; opener.close()`功能打开该子页面并同时关闭父页面。

该功能工作正常，可以做我需要做的事情（打开弹出窗口后关闭父级）。**但是**，如果直接访问子页面 URL（换句话说，没有从父页面定向），那么显然没有要关闭的父页面，我得到脚本错误：

'opener' 为 null 或不是对象

**我理解错误消息，因此如果引用 URL不是**parent.html，我为什么要尝试隐藏“opener”，这样如果有人碰巧直接访问子页面，opener 会被隐藏并且没有错误消息。

我需要在以下脚本中进行哪些更改才能使其正常工作？

```
 <script type="text/javascript">
        //<![CDATA[<!--
        if (document.referrer != '../parent.html') {
        opener.opener = opener;
        opener.close();}
        else {}
        //-->
        //]]>
        </script> 
```

或者，我尝试编写以下内容：

```
 <script type="text/javascript">
        //<![CDATA[<!--
        if (document.referrer = '../parent.html') {
        return false;
        } else {
        opener.opener = opener;
        opener.close();}
        //-->
        //]]>
        </script> 
```

但这会返回脚本错误：函数之外的'return'语句。

非常感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:14:24.110

如果您将`AND`条件与开启者变量的初始化一起设置，则您的第一个脚本是正确的，例如：

```
 if (document.referrer !== '../popup.html' && opener) { ... } 
```

对于第二个，如果要使用以下`return`语句，则必须写下一个函数：

```
<script type="text/javascript">
   //<![CDATA[<!--
   function(){
     function myFunct() {
       if (document.referrer === '../parent.html' || !opener) {
         return false;
       } else {
         opener.opener = opener;
         opener.close();
         return true;
       }
    }
    myFunct();
   }();​
   //-->
   //]]>
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:02:48.823

感谢 Dario 的建议 :) 我重写了它并且下面的脚本有效：

```
 <script type="text/javascript">
        //<![CDATA[<!--
        if (document.referrer != '../popup.html' && opener) { 
        opener.opener = opener;
        opener.close();}
        //-->
        //]]>
        </script> 
```

# artificial-intelligence - 将规划应用到网络搜索

> ID：11635586
> 
> 赞同：1
> 
> 时间：2012-07-24T16:48:07.117
> 
> 标签：artificial-intelligence

这是一个作业，问题是：你会如何将规划的想法应用到网络搜索中？请高水平回答；一两段就足够了。

我不确定什么是高水平的计划，也不知道从哪里开始。我阅读了一些关于信息检索和网络搜索的论文，但仍然无法将它们与 Planning 联系起来。希望有人能给我一些提示，比如规划与信息检索或网络搜索的关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T15:47:03.687

我不确定您指的是网络搜索的哪一部分。我假设你的问题是关于人工智能规划和网络搜索之间的联系。

网络爬虫是搜索引擎不可或缺的一部分。我认为有大量的 AI 规划算法用于决定接下来要爬取哪种类型的页面以及以什么频率爬取域。

人工智能规划有助于广告竞价的另一个领域。我不太确定应用程序具体使用了哪种算法。可能是做一些谷歌搜索来弄清楚。

# jquery - CSS 多个 div 溢出

> ID：11635590
> 
> 赞同：0
> 
> 时间：2012-07-24T16:48:19.563
> 
> 标签：jquery, html, css, mobile

我有一个连续 10 个 div 的示例，放置在一个容器中，位于站点的页脚中。该站点将是响应式站点，它也可以在智能手机上运行。

在智能手机上，我想制作一个水平滚动视图，但我需要将溢出的 div（例如，4、5、6、7、8、9、10）放在视口之外的一行中（我将滑动它们在）。使用[此 jsFiddle](http://jsfiddle.net/hkFPB/)中的 css，行中没有位置的 div 被放置在视口下，而不是在同一行中。**如何将它们放在同一行？**

基本上，我只想要视口中的 n 个正方形，其余的，我将它们滑入。

PS我正在尝试手动执行此操作，jQuery中有一些滚动查看器插件吗？（不是 jQuery 移动）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:13:44.500

这是[你](http://jsfiddle.net/hkFPB/31/)的意思吗？

HTML

```
 <body>
        Content
        <div class="footer">
            <div class="footer_contents">
                    <div class="square selected">1</div>
                    <div class="square">2</div>
                    <div class="square">3</div>
                    <div class="square">4</div>
                    <div class="square">5</div>
                    <div class="square">6</div>
                    <div class="square">7</div>
                    <div class="square">8</div>
                    <div class="square">9</div>
                    <div class="square">10</div>
            </div>
        </div>
    </body> 
```

CSS

```
.footer {
    height:50px; 
    width: 100%;
    position: fixed;
    bottom: 0;
    left: 0;
    overflow: scroll;
    overflow-y: hidden;
}   

.footer_contents {
    height: 50px;
    width: 1000px;
    margin: auto;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T16:00:56.550

我认为您可能需要另一个包装 div。我见过的大多数滑块都会有一个 div，`overflow: hidden`里面是一个非常宽的 div（至少足够宽以容纳所有内容），可以移动。至于插件，我用过几次[jQuery Tools](http://jquerytools.org/)

# drupal - 如何在挂钩菜单中调用节点？

> ID：11635592
> 
> 赞同：2
> 
> 时间：2012-07-24T16:48:21.123
> 
> 标签：drupal, menu, drupal-7

我希望你能帮助我，因为我不知道如何在 Drupal 7 的 hook_menu 中调用节点。

可能吗 ？

```
$items['basketfacile/planning'] = array(
        'type' => MENU_LOCAL_TASK,
        'title' => 'Test',
        'description' => "description",
        'page callback' => 'drupal_get_form',
        'page arguments' => array('basketfacile_plannings_form'),
        'access arguments' => array('access content')
    ); 
```

这是我调用表单的项目菜单，但我想调用我的 Drupal 安装中已经存在的节点表单。我们可以以文章为例。

你有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:34:03.203

实际上，将节点嵌入到其他页面中非常容易，您可以这样做：

```
$items['menu/submenu'] = array(
        'type' => MENU_LOCAL_TASK,
        'title' => 'YOUR_TITLE',
        'description' => "YOUR_DESCRIPTION",
         'page callback' => 'node_add',
        'page arguments' => array('YOUR_NODE_TYPE_NAME_MACHINE'),
        'access callback' => 'node_access',
        'access arguments' => array('create', 'YOUR_NODE_TYPE_NAME_MACHINE'),
        'file' => 'node.pages.inc',
        'file path' => drupal_get_path('module', 'node')
); 
```

# jquery - 同时动画和淡出

> ID：11635594
> 
> 赞同：0
> 
> 时间：2012-07-24T16:48:31.920
> 
> 标签：jquery

[http://jsfiddle.net/AndyMP/UpLts/1/](http://jsfiddle.net/AndyMP/UpLts/1/)

这只是一个用于说明目的的示例，但我想要做的是动画一个盒子并同时淡出它。就您在示例中看到的而言，我所拥有的是一个动画，紧随其后的是淡入淡出。我可以让它在动画时淡化吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:50:52.553

现在您正在使用“animate”和“fadeTo”，但您可以使用“animate”来完成这一切。换句话说，您可以使用“动画”功能“动画”对象的多个属性。因此，请改用：`box.stop(true, true).delay(100).animate({top:-0, opacity: 0},150);`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T16:52:46.140

您可以更改`opacity`元素的：

```
c.mouseenter(function (){
     box.stop(true, true).delay(100).animate({top:-0, opacity: 0}, 150)
})
.mouseleave(function (){
     box.stop(true, true).delay(100).animate({top:40, opacity: 1}, 150)
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T16:59:44.060

如果你对 CSS 解决方案持开放态度，你可以在没有 JS 的情况下做到这一点 - [http://jsfiddle.net/UpLts/2/](http://jsfiddle.net/UpLts/2/)

```
.blocks {
    position: relative;
    float: left;
    margin: 20px;
    width: 100px;
    height: 100px;
    border: 1px dotted #333;
    overflow: hidden;
}

.blocks_title {
    position: relative;
    width: 20px;
    height: 20px;
    top: 40px;
    left: 40px;
    background: #333;
    opacity: 1;
    -webkit-transition: all .25s;
       -moz-transition: all .25s;
            transition: all .25s;
}

.blocks:hover .blocks_title {
    top: 0;
    opacity: 0;
} 
```

# javascript - 多个元素一次使用相同的点击功能。如何？

> ID：11635601
> 
> 赞同：0
> 
> 时间：2012-07-24T16:48:53.287
> 
> 标签：javascript, jquery

我正在使用 Raphael JS，但我认为这是纯 JavaScript 或 jQuery 问题。

我有两个元素，一个文本和一个圆圈（椭圆），我正在使用一个变量来存储它们以供以后使用。

所以，我在想，与其一遍又一遍地重复自己，我将创建一个数组并在点击时使用它。

但它不起作用。如何解决这个问题并为我的数组中的每个变量（对象）分配 onclick？

```
var circle = paper.ellipse(350, 320, 95, 90);
var text = paper.text(350, 320, "My text");

var myArray = [circle, text];
myArray.click(function () {
    window.location = "http://somewebsite.com";
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:55:08.027

jQuery $.each 函数可以帮助你解决这个问题；

```
$.each(myArray, function(i, v) {
    v.click(function() {
        window.location = "http://somewebsite.com";
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:11:51.977

如果您只想保留对象，则无需将对象存储在数组中，您已经使用两个变量引用了它们：`circle`和`text`. 定义一次函数，然后将其分配给使用它的任何元素：

```
var circle = paper.ellipse(350, 320, 95, 90);
var text = paper.text(350, 320, "My text");

function clickFunction()
{
    window.location = "http://somewebsite.com";
}

circle.addEventListener("click", clickFunction);
text.addEventListener("click", clickFunction); 
```

或者，使用 jQuery：

```
circle.click(clickFunction);
text.click(clickFunction); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T19:38:21.957

如果你想用 raphaelJS 来做......

```
var circle = paper.ellipse(350, 320, 95, 90);
var text = paper.text(350, 320, "My text");
var click_set = paper.set();
click_set.push(circle);
click_set.push(text);

click_set.click(function(){
 // do what you want ... this function will automatically be bound to all the elements that //you push in the set
               }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T17:32:43.500

只需遍历元素并将处理程序附加到每个元素。不需要任何库。

```
var circle = paper.ellipse(350, 320, 95, 90);
var text = paper.text(350, 320, "My text");

var myArray = [circle, text];
var handler = function () {
    window.location = "http://somewebsite.com";
};

for (var i = 0; i < myArray.length; i++) {
    myArray[i].onclick = handler;
} 
```

# python - 类格式问题

> ID：11635602
> 
> 赞同：2
> 
> 时间：2012-07-24T16:48:56.343
> 
> 标签：python, class, formatting, python-2.7

我是python的新手程序员。我目前正在构建一个解析日志文件并完成该类的所有元素的类。尽管如此，由于 python 中的大多数东西都对我不利，我要么错误地格式化了我的类，要么搞砸了我的语义。我想知道是否存在用于构建类的明确格式，以及我所写的格式是否遵循所述格式。

以下是日志中的一些行：

```
2012-06-12 14:02:21,813 [main]  INFO  ConnectionManager.java (line 238) Initializing the ConnectionManager.
2012-06-12 14:02:21,844 [main]  INFO  CimListener.java (line 142) Starting listener at http://127.0.0.1:7012
2012-06-12 14:02:21,974 [main]  INFO  CimListener.java (line 158) Listening at http://127.0.0.1:7012
2012-06-12 14:02:23,209 [main]  INFO  RmiServiceExporter.java (line 393) Looking for RMI registry at port '10099'
2012-06-12 14:02:23,232 [main]  INFO  RmiServiceExporter.java (line 404) Could not detect RMI registry - creating new one 
```

这是课程：

```
import re
import time
import calendar
from datetime import datetime

f = open("C:\Users\-----\Desktop\Real Logs\controllersvc.log", "r")
while True:
    line = f.readline()
    if not line:
        break

class LogLine:

    SEVERITIES = ['EMERG','ALERT','CRIT','ERR','WARNING','NOTICE','INFO','DEBUG']
    severity = 1

    def __init__(self, line):
        try:
            timestr, msstr, sevstr, self.filename, linestr, self.message = re.match(r"^(\d\d\d\d-\d\d-\d\d[ \t]\d\d:\d\d:\d\d),(\d\d\d),(?i[a-z]+),([A-Za-z]{1,.}),([(]\[lL]ine\>\s+\d+[)]),^(?<=\)\s?\w+$)", line).groups()
            self.line = int(linestr)
            self.sev = self.SEVERITIES.index(sevstr)
            self.time = float(calendar.timegm(time.strptime(timestr, "%Y-%m-%d %H:%M:%S,%f"))) + float(msstr)/1000.0
            dt = datetime.strptime(t, "%Y-%m-%d %H:%M:%S,%f")
        except Exception:
            print 'error',self.filename

    def get_time(self):
        return self.time
    def get_severity(self):
        return self.sev
    def get_message(self):
        return message
    def get_filename(self):
        return filename
    def get_line(self):
        return line 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T21:49:53.783

您的代码有几处问题：

*   **self.filename 属性在init**中使用之前不一定要定义
***   您应该尝试更具体地说明您希望捕获哪些异常（您想禁止 KeyboardInterruptException 吗？）*   您的正则表达式复杂且难以维护（我认为是错误的）*   您将“getter”暴露给对象的公共属性，这是不必要的。*   一些“getter”返回全局变量（消息、行和文件名），这些变量可能是为了返回实例属性*   理想情况下，新编写的类应该子类化某些东西（在这种情况下，`object`）**

 **我希望这份清单是有帮助的，并被视为建设性的批评。

为了帮助您查看更多 Python 代码，我为您的数据编写了一个日志阅读器，它没有复杂的正则表达式，也没有任何“getter”（如果您真的需要，可以添加）。可以进行进一步的简化（例如使用 namedtuple ），但为了清晰和教育，我保持原样：

```
import datetime

class LogEntry(object):
    @staticmethod
    def from_str(line):
        """Converts a log line in a string, into a LogEntry."""
        # split the line by one or more spaces
        date, time, _, severity, filename, _, line, message = re.split('\s+', line, 7)

        # strip the trailing bracket on the line and cast to an int
        line = int(line[:-1])

        # combine the date and time strings and turn them into a datetime
        dt = datetime.datetime.strptime(date + time, "%Y-%m-%d%H:%M:%S,%f")

        return LogEntry(dt, severity, filename, line, message)

    def __init__(self, dt, severity, filename, line_num, message):
        self.datetime = dt
        self.severity = severity
        self.filename = filename
        self.line_num = line_num
        self.message = message

    def __str__(self):
        return '%s %s %s L%s: %s' % (self.datetime, self.severity, self.filename, self.line_num, self.message)

if __name__ == '__main__':

    log_contents = """2012-06-12 14:02:21,813 [main]  INFO  ConnectionManager.java (line 238) Initializing the ConnectionManager.
    2012-06-12 14:02:21,844 [main]  INFO  CimListener.java (line 142) Starting listener at http://127.0.0.1:7012
    2012-06-12 14:02:21,974 [main]  INFO  CimListener.java (line 158) Listening at http://127.0.0.1:7012
    2012-06-12 14:02:23,209 [main]  INFO  RmiServiceExporter.java (line 393) Looking for RMI registry at port '10099'
    2012-06-12 14:02:23,232 [main]  INFO  RmiServiceExporter.java (line 404) Could not detect RMI registry - creating new one"""

    # uncomment for real log reading
    #fh = file(filename, 'r')

    # emulate a log file by providing an iterable of lines (just like fh will do)
    fh = log_contents.split('\n')

    for line in fh:
        print LogEntry.from_str(line.strip()) 
```

产生输出：

```
2012-06-12 14:02:21.813000 INFO ConnectionManager.java L238: Initializing the ConnectionManager.
2012-06-12 14:02:21.844000 INFO CimListener.java L142: Starting listener at http://127.0.0.1:7012
2012-06-12 14:02:21.974000 INFO CimListener.java L158: Listening at http://127.0.0.1:7012
2012-06-12 14:02:23.209000 INFO RmiServiceExporter.java L393: Looking for RMI registry at port '10099'
2012-06-12 14:02:23.232000 INFO RmiServiceExporter.java L404: Could not detect RMI registry - creating new one 
```

我真的希望这能帮助你发现 Python 有多么有趣！**

# iphone - 旋转图层的图形上下文忽略任何变换

> ID：11635603
> 
> 赞同：0
> 
> 时间：2012-07-24T16:48:57.687
> 
> 标签：iphone, objective-c, calayer, catransform3d

我正在由几个图层组成一个视图，其中一些是旋转的。这些图层的显示效果很好，但是当我尝试制作图像时，所有的旋转/变换都被忽略了。

例如，如果我有一个包含指向左侧的箭头图像的 CALayer，则在围绕 z 轴旋转（使用 CATransform3DMakeRotation）后，它指向顶部，并且图层正确显示。但是，如果我得到该层的图像（使用 renderInContext），箭头仍然指向左侧，忽略任何转换。

任何人都知道为什么，我该怎么做才能得到我想要的结果？:-)

示例代码：

```
//  ViewController.m

#import "ViewController.h"
#import <QuartzCore/QuartzCore.h>

// Don't forget to add the QuartzCore framework to your target.

@interface ViewController ()
@end

@implementation ViewController

- (void)loadView {
    self.view = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.view.backgroundColor = [UIColor lightGrayColor];
}

- (void)viewDidLoad {
    [super viewDidLoad];

    // Get the arrow image (tip to the left, 50 x 50 pixels).
    // (Download the image from here: http://www.4shared.com/photo/uQfor7vC/arrow.html )
    UIImage *arrowImage = [UIImage imageNamed:@"arrow"];

    // The arrow layer in it's starting orientation (tip to the left).
    CGRect layerFrame = CGRectMake(50.0, 50.0, arrowImage.size.width, arrowImage.size.height);
    CALayer *arrowLayerStart = [CALayer new];
    arrowLayerStart.frame = layerFrame;
    [arrowLayerStart setContents:(id)[arrowImage CGImage]];
    [self.view.layer addSublayer:arrowLayerStart];

    // The arrow layer rotated around the z axis by 90 degrees.
    layerFrame.origin = CGPointMake(layerFrame.origin.x + layerFrame.size.width + 25.0, layerFrame.origin.y);
    CALayer *arrowLayerZ90 = [CALayer new];
    arrowLayerZ90.frame = layerFrame;
    [arrowLayerZ90 setContents:(id)[arrowImage CGImage]];
    arrowLayerZ90.transform = CATransform3DMakeRotation(M_PI/2.0, 0.0, 0.0, 1.0);
    [self.view.layer addSublayer:arrowLayerZ90];

    // Now make images of each of these layers and display them in a second row.

    // The starting layer without any rotation.
    UIGraphicsBeginImageContext(arrowLayerStart.frame.size);
    [arrowLayerStart renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *arrowStartImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    layerFrame.origin = CGPointMake(arrowLayerStart.frame.origin.x,
                                    arrowLayerStart.frame.origin.y + arrowLayerStart.frame.size.height + 25.0);
    CALayer *arrowLayerStartCaptured = [CALayer new];
    arrowLayerStartCaptured.frame = layerFrame;
    [arrowLayerStartCaptured setContents:(id)[arrowStartImage CGImage]];
    [self.view.layer addSublayer:arrowLayerStartCaptured];

    // The second layer, rotated around the z axis by 90 degrees.
    UIGraphicsBeginImageContext(arrowLayerZ90.frame.size);
    [arrowLayerZ90 renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *arrowZ90Image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    layerFrame.origin = CGPointMake(arrowLayerZ90.frame.origin.x,
                                    arrowLayerZ90.frame.origin.y + arrowLayerZ90.frame.size.height + 25.0);
    CALayer *arrowLayerZ90Captured = [CALayer new];
    arrowLayerZ90Captured.frame = layerFrame;
    [arrowLayerZ90Captured setContents:(id)[arrowZ90Image CGImage]];
    [self.view.layer addSublayer:arrowLayerZ90Captured];    
}

@end

//  ViewController.h

#import <UIKit/UIKit.h>

@interface ViewController : UIViewController
@end

//  AppDelegate.h

#import <UIKit/UIKit.h>

@interface AppDelegate : UIResponder <UIApplicationDelegate>
@property (strong, nonatomic) UIWindow *window;
@end

//  AppDelegate.m

#import "AppDelegate.h"
#import "ViewController.h"

@implementation AppDelegate
@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.window.rootViewController = [[ViewController alloc] init];
    [self.window makeKeyAndVisible];
    return YES;
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:56:27.950

[的文档`-[CALayer renderInContext:]`](https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CALayer_class/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004500-CH1-SW120)说：

> 此方法的 Mac OS X v10.5 实现不支持整个 Core Animation 合成模型。QCCompositionLayer、CAOpenGLLayer 和 QTMovieLayer 图层不会被渲染。此外，**不会渲染使用 3D 变换的**图层，也不会渲染指定背景过滤器、过滤器、合成过滤器或遮罩值的图层。Mac OS X 的未来版本可能会增加对渲染这些层和属性的支持。

（iOS 上也存在此限制。）

标题`CALayer.h`还说：

```
 * WARNING: currently this method does not implement the full
 * CoreAnimation composition model, use with caution. */ 
```

本质上，`-renderInContext:`在一些简单的情况下很有用，但在更复杂的情况下不会按预期工作。您将需要找到其他方法来进行绘图。Quartz（Core Graphics）适用于 2D，但对于 3D，您就得靠自己了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-29T05:22:26.480

你可以用 Core Graphicaic 代替 CATransform3DMakeRotation ：）

```
CGAffineTransform flip = CGAffineTransformMakeScale(1.0, -1.0); 
```

# xquery - Oracle Service Bus 中的 xquery 替换问题

> ID：11635605
> 
> 赞同：0
> 
> 时间：2012-07-24T16:49:03.247
> 
> 标签：xquery, osb

我正在尝试使用替换功能在 Oracle Service Bus xquery 转换中用一个反斜杠替换两个反斜杠：

让 $str := replace($srcStr, "\\\\", "\\")，其中 $srcStr 保存值 "^\\d{1,4}$"

但由于某种原因，这不起作用。结果仍然是 "^\\d{1,4}$"

当我在例如 Altova XmlSpy 中调用相同的函数时，这工作正常：replace("^\\d{1,4}$", "\\\\", "\\") 导致 ^\d{1 ,4}

有人知道为什么 OSB 与源字符串中的反斜杠不匹配吗？什么可能是解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T11:40:33.710

这是一个错误。

您可以编写自定义正则表达式来解决此错误。

```
declare function xf:replace_test($e as element()) as xs:string {
    let $str := replace("junk (\)\ junk", ".*\\.*", "\$1")
    return $str
};
declare variable $e as element() external; 
xf:replace_test($e)` 
```

# mediawiki - MediaWiki LocalSettings.php $wgSiteName 问题

> ID：11635607
> 
> 赞同：0
> 
> 时间：2012-07-24T16:49:27.397
> 
> 标签：mediawiki, wiki, config

所以我有我想要的wiki，但sitename变量总是恢复为小写......

我假设可能有一个特殊字符......就像在 c# 中你有 \t 或 \n 来格式化文本但我找不到任何类型的东西..

这直接来自描述站点名称的维基页面

“站点名称 $wgSitename 变量包含您的 wiki 设置的名称。此名称在整个系统中多次包含，例如通过 MediaWiki:Pagetitle。例如，维基百科的标语“来自维基百科，免费的百科全书。”使得使用此设置。”

它指出，维基百科使用站点名称将其站点命名为......“来自维基百科，免费的百科全书。”

它们有多个大写字母

提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T17:11:05.290

该文本实际上来自页面[MediaWiki:Tagline](http://www.mediawiki.org/wiki/Manual%3aTagline_%28Site_Subtitle%29)。在您的 wiki 上编辑该页面，您可以让该行说出您想要的任何内容。您还必须像该链接中所说的那样编辑 MediaWiki:Common.css 以使标语显示在页面上。

# c# - 如何在 C# 中使用存储过程时将数据保存在具有多个外键的表中

> ID：11635615
> 
> 赞同：0
> 
> 时间：2012-07-24T16:49:46.143
> 
> 标签：c#, stored-procedures, foreign-keys

我有一个`Item_Order`列的表

```
orderId, clintName, companyName, itemName, orderDate, qauntity, clintId_FK, itemId_FK, status 
```

其中`clintId_FK`和分别是表和表`item_FK`的主键。`Clint``Item_Configuration`

我为`Item_Order`表中的插入记录创建了一个存储过程。IE

```
ALTER PROCEDURE [dbo].[Order_Create_SP]
@orderId varchar(50),
@clintName varchar(50),
@companyName varchar(50),
@itemName  varchar(50),
@orderDate datetime,
@qauntity int,
@status char(10),
@operation int

AS
DECLARE @id1 varchar(50)
DECLARE @id2 varchar(50)
BEGIN
SET NOCOUNT ON;

if @operation = 0
BEGIN

SELECT top(1)@id1 = clintId FROM dbo.Clint order by clintId desc
select top(1)@id2 =  itemId from dbo.Item_Configuration order by itemId desc

insert into Item_Order(orderId, clintName, companyName, itemName, orderDate, qauntity, clintId_FK, itemId_FK, status)
 values(@orderId, @clintName, @companyName, @itemName, @orderDate, @qauntity, @id1, @id2, 'OPEN')

END
END 
```

我的 C# 代码是

```
private void btnOrder_Click(object sender, EventArgs e)
{
        SqlConnection conn1 = new SqlConnection();
        try
        {
            SqlCommand inserOrder= new SqlCommand("Order_Create_SP", conn1);
            inserOrder.CommandType = CommandType.StoredProcedure;

            inserOrder.Parameters.Add("@orderId", SqlDbType.VarChar);
            inserOrder.Parameters["@orderId"].Value = oredrId.Text;

            inserOrder.Parameters.Add("@clintName", SqlDbType.VarChar);
            inserOrder.Parameters["@clintName"].Value = comboClint.Text;

            inserOrder.Parameters.Add("@itemName", SqlDbType.VarChar);
            inserOrder.Parameters["@itemName"].Value = comboItem.Text;

            inserOrder.Parameters.Add("@orderDate", SqlDbType.DateTime);

          inserOrder.Parameters["@orderDate"].Value=Convert.ToDateTime(orderDate.Text);
          inserOrder.Parameters.Add("@qauntity", SqlDbType.Int);
            inserOrder.Parameters["@qauntity"].Value = Convert.ToInt32(qauntity.Text);

            inserOrder.Parameters.Add("@stauts", SqlDbType.VarChar);
            inserOrder.Parameters["@stauts"].Value = "OPEN";

            inserOrder.Parameters.Add("@companyName", SqlDbType.VarChar);
            inserOrder.Parameters["@companyName"].Value = companyName.Text;

            inserOrder.Parameters.Add("@operation", SqlDbType.VarChar);
            inserOrder.Parameters["@operation"].Value = 0;

            inserOrder.ExecuteNonQuery(); 
```

我正在做一些不兼容的事情？它无法正常工作。请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:54:26.977

不确定这是否是您的问题，但您的存储过程`WHERE`在查找外键时缺少子句。尝试更改为类似

```
SELECT top(1)@id1 = clintId FROM dbo.Clint WHERE Name = @clintName order by clintId desc
SELECT top(1)@id2 =  itemId from dbo.Item_Configuration WHERE name = @itemName order by itemId desc 
```

# popup - 更新 OpenLayers 弹出窗口

> ID：11635617
> 
> 赞同：1
> 
> 时间：2012-07-24T16:49:49.467
> 
> 标签：popup, openlayers, marker

我正在尝试更新我的地图中的一些弹出窗口，但我无法做到这一点。

首先，我创建一些标记，然后使用下一个代码，创建一个与它们关联的弹出窗口。每个标记一个弹出窗口：

```
 popFeature = new OpenLayers.Feature(markers, location); 
                         popFeature.closeBox = true;
                         popFeature.popupClass =     OpenLayers.Class(OpenLayers.Popup.FramedCloud, {
                                 'autoSize': true
                         });
                         popFeature.data.popupContentHTML = "hello";                         
popFeature.data.overflow = (false) ? "auto" : "hidden";     
                         var markerClick = function (evt) {
                                if (this.popup == null) {
                                    this.popup = this.createPopup(this.closeBox);
                                    map.addPopup(this.popup);
                                    this.popup.show();
                                } else {
                                    this.popup.toggle();
                                }
                                currentPopup = this.popup;
                                OpenLayers.Event.stop(evt);
                         };
                         mark.events.register("mousedown",     popFeature, markerClick); 
```

之后，我将新标记添加到我的标记层。

直到这里一切都很好，但是，我想稍后更新 popupcontentHTML，我不知道如何访问该值。

我阅读了 OL API，但我不明白如何获取它。我对功能、事件、扩展感到迷茫……

我想知道我是否可以访问该属性并写下其他单词。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T09:10:16.300

我回答自己，也许它会在未来帮助其他人：

```
for(i = 0; i < map.popups.length; i++){
if(map.popups[i].lonlat.lon == marker.lonlat.lon){
map.popups[i].setContentHTML("new content");
}
} 
```

内容将在此刻刷新。

# ssis - 为什么我不能保存一些 SSIS 包

> ID：11635624
> 
> 赞同：0
> 
> 时间：2012-07-24T16:50:32.927
> 
> 标签：ssis

尝试保存 ssis 包时，出现另存为窗口，提示“.dtsx 文件已存在，是否要替换？”

如果我按是，它会显示“操作无法完成”。我使用的是 SSIS 2008 R2。它是某种错误吗？如果不是，解决方案是什么？

# php - 如何从 MySQL 数据库表中获取随机值而不重复？

> ID：11635625
> 
> 赞同：0
> 
> 时间：2012-07-24T16:50:34.417
> 
> 标签：php, mysql

我有一个名为主题的表，其中有一个名为 vTopicName 的字段。我想通过单击按钮来显示随机主题而不重复它们应该是什么SQL查询？

在控制器中我调用

```
public function browse()
{
    $data['topic'] = $this->topics_model->get_random_topic();
    $topic = $data['topic']['vTopicName'];
    redirect("/$topic");

} 
```

在模型中有

```
public function get_random_topic()
{
    $query = $this->db->query("SELECT * FROM ws_topics ORDER BY RAND() LIMIT 1");
    return $query->row_array();
} 
```

这将重定向到 domainname.com/topicname

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:55:57.367

第一的。**使用数据库**

您应该在同一个表中添加一个日期时间字段，让我们说“displayed_on”，当您显示一个主题时，将其 display_on 设置为当前时间。现在，当您下次获取记录时，您可以对 display_on 字段应用升序排序并限制结果以跳过之前显示（或最近显示）的结果。

```
select vTopicName from (select * from topics order by rand() limit
    30) order by displayed_on asc limit 5; 
```

第二。**使用会话**

您还可以将所有显示的主题放在会话变量中，并且可以在获取下一组主题时跳过它们。

```
$query = "select vTopicName from topics where topics.id not in (".implode(',',$_SESSION['displayed_topics']).") order by rand limit 5; 
```

如果表中的记录很少，则应在从上述查询中获得少于 5 条记录时重置会话变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:54:45.443

这将是您的基本查询：

```
SELECT * FROM vTopicName WHERE displayed = false ORDER BY RANDOM() LIMIT 1 
```

然后，您必须将该主题“标记”为显示的内容。如果不知道您在桌子上的主要 id，很难准确地说出如何做到这一点，但这里有一个近似值：

```
UPDATE vTopicName SET displayed = true WHERE primaryId = <id of the row you got> 
```

但是，如果您希望不同的用户受到不同的影响，您将需要一个单独的表格来涵盖他们的操作：

```
SELECT * FROM vTopicName as topic 
  JOIN userActivity AS user ON topic.id = user.topicid 
 WHERE user.displayed = false ORDER BY RANDOM() LIMIT 1; 
```

然后你需要更新`userActivity`表：

```
UPDATE userActivity SET displayed = true WHERE topicid = <topic id> AND id = <userid> 
```

为了确保用户在查看完所有内容后将拥有所有可用的主题，您还必须运行此查询：

```
SELECT COUNT(topicid) FROM userActivity WHERE id = <user id> AND displayed = false; 
```

如果这等于 0（或某个较小的数字），则您必须运行：

```
UPDATE userActivity SET displayed = false WHERE id = <user id>; 
```

# android - 使用 NDK 从 Native 代码调用 Java 函数

> ID：11635628
> 
> 赞同：3
> 
> 时间：2012-07-24T16:50:51.560
> 
> 标签：android, c, android-ndk

前几天我问了这个问题，但不是太具体，所以我想重新澄清一下。

我正在使用 NDK 创建一个使用 C 中现有库的 Android 应用程序。我遇到的问题是C代码使用了很多java没有的东西（函数指针作为参数是个大问题）。

无论如何，我想知道是否可以在我的 Java 代码中编写 C 代码调用的函数。现在，据我所知，您可以做到，所以如果没有人回答“是的，您可以，LINK，我将不胜感激。” .

任何人都可以尝试解释这个过程吗？我知道这涉及在 C 代码中创建 JVM；任何有助于新手站起来的信息都将不胜感激。

谢谢

编辑 ：

所以，我不知道这三个步骤该怎么做。

```
To call a specific Java function from C, you need to do the following:

Obtain the class reference using the FindClass(,,) method.
Obtain the method IDs of the functions of the class that you want to call using the 
GetStaticMethodID and GetMethodID function calls.

Call the functions using CallStaticVoidMethod, CallStaticIntMethod, and CallStaticObjectMethod. 
```

这没有太多解释，我在 C 方面几乎没有经验。 FindClass 是 C 方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T01:16:07.213

每个可通过 JNI 从 Java 调用的 C 函数都有一个类型为 的第一个参数`JNIEnv*`。在 C 端，这是一个指向一个结构的指针，该结构带有一堆指向函数的指针。这些函数是您与 Java 世界的接口。`FindClass`，`GetMethodID`其余的都在其中。

因此，当您想从 C 端调用 FindClass 时，您可以这样做：

```
void Java_com_mypackage_MyClass_MyMethod(JNIEnv *jniEnv, jobject thiz)
{
    jclass *clazz = (*(*jniEnv)->FindClass)(jniEnv, "com/mypackage/SomeClass");
    jmethodID MethodID = (*(*jniEnv)->GetStaticMethodID)(jniEnv, clazz, "SomeMethod", "(I)I");
    int result = (*(*jniEnv)->CallStaticIntMethod)(jniEnv, clazz, MethodID, 18); 
```

等等。该行取消引用`jniEnv`参数，获取函数指针并通过它调用函数。自然，类和方法名完全是伪造的。我怎么会知道你的。

注意：我在这里谈论的是函数指针，但与您的意义不同；这些是指向 JNI 提供的函数的函数指针，而不是指向您的函数的函数指针。

调用语法的冗长与 C 的局限性有关。在 C++ 中，您可以改为编写

```
jclass *cl = jniEnv->FindClass("com/mypackage/SomeClass"); 
```

因为 C++ 通过虚函数本机支持这种类型的函数表指针。

在此过程中，您可能会走一些捷径。如果您在与 C 入口点相同的类中调用方法，并且它恰好是静态的，那么您的第二个参数已经是类对象指针。如果您有一个`this`指向要调用方法的对象的指针，则可以使用 GetObjectClass。

# android - 如何在 android ndk 上使用 FFmpeg 制作视频播放器

> ID：11635630
> 
> 赞同：2
> 
> 时间：2012-07-24T16:50:56.950
> 
> 标签：android, android-ndk, ffmpeg

我正在尝试使用 ffmpeg 制作视频播放器，我使用本教程[http://dranger.com/ffmpeg/tutorial08.html](http://dranger.com/ffmpeg/tutorial08.html)，我理解本教程将视频转换为视频图像 YUV，我正在尝试制作从 .c 到 .java 交互的文件，我有这个

来自tutorial08（http://dranger.com/ffmpeg/tutorial08.c）的代码c，然后我做了

公共类 RtspReceiver 扩展 Activity {

```
public SurfaceView sfv;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.principal);
    sfv=(SurfaceView) findViewById(R.id.im);
}

/* load our native library */
static {
    System.loadLibrary("Interface");
}

private static native void Receive(SurfaceView  sf); 
```

}

在c中，我试图了解如何使用它

```
JNIEXPORT void JNICALL isec_projecto_rtspreceiver_RtspReceiver_Receive(JNIEnv * env, jobject  obj, jobject Surface)
{
//what I have to put in here?
} 
```

我怎样才能把我在java中的SurfaceView放在c中？？？和其他的事情，在tutorial08.c 中如何提取视频并将它们放入java 中？我想对了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:15:26.193

本教程的编写并未考虑 Android 或 Java。

你可以做的一件事是在你的 C 代码中做所有的`FFMPEG`事情，把你解码的图像放在一个队列中。在 Java`SurfaceView`中，从一个单独的线程中，您将把位图传递给本机代码。在本机代码中，您将使用解码图像`AndroidBitmap_lockPixels`和其他类似的东西填充该位图的像素。

NDK 中有一个`'bitmap-plasma'`示例。虽然它与它无关，`FFMPEG`但它显示了如何`Bitmap`从本机代码操作 a。

# ruby-on-rails - Rails 3 印象派每日索引

> ID：11635631
> 
> 赞同：0
> 
> 时间：2012-07-24T16:50:59.003
> 
> 标签：ruby-on-rails

我正在使用 Ruby gem Impressionist。它使您能够查看从特定日期到今天的页面点击次数。我试图获得过去 7 天的点击量，但每天都吐出数字。

```
@widget.impressionist_count(:start_date=>"2011-01-01")  #specify start date only, end date = now 
```

我该怎么做？我想要 7 天前，但每一天都给我当天的确切计数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-13T06:05:06.870

尝试这个：

```
@widget.impressionist_count(:start_date => 1.week.ago) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T06:53:04.727

您可以像这样获得 1 周前的日期

```
t = Time.now
lastweek = t - 1.week 
```

然后你可以这样做

```
@widget.impressionist_count(:start_date=>lastweek.strftime('%Y-%m-%d')) 
```

我猜您应该在控制器中执行此操作，或者您可以仅将上周日期传递给视图。此代码适用于 Rails 应用程序，因为它使用 active_support。

我用 mongoid 尝试了印象派，但过滤器功能在我的环境中根本不起作用。

我希望它在你的应用程序中。

# wpf - 动画控件大小从 0 到首选

> ID：11635632
> 
> 赞同：2
> 
> 时间：2012-07-24T16:51:04.070
> 
> 标签：wpf

有没有一种方法可以创建动画来为控件高度设置动画，将其从 0 拉伸到原始（首选）大小？也就是说，我可以控制取决于其文本内容的高度，并且我想引入一个动画，它会向下滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:25:55.610

当我过去研究这个时，答案是动画到最大高度而不是高度。这样一来，您仍然会得到扩展以适应内容时的高度。

当然，问题在于更难获得精确的动画速度，因为在动画完成之前控件自然会停止增长。

我所做的是，我将动画设置为屏幕工作高度，然后在动画完成事件中，我将最大高度设置为正无穷大，这意味着没有最大高度。与从 0 到无穷大的动画相比，这将使设置持续时间容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:21:06.210

这有点棘手，因为实际值是动态的，所以你不能绑定动画，因为它们需要是可冻结的。此外，表示此行为的值 ( `Double.NaN`) 不能用于非离散动画。使用流体布局`Interactivity`或您背后的一些代码可以做到这一点，[这个问题](https://stackoverflow.com/questions/8221230/)可以作为参考。如果您还没有合适的状态，则必须创建自己的状态并手动更改状态以触发转换。

# java - Android 错误：无法启动活动

> ID：11635638
> 
> 赞同：0
> 
> 时间：2012-07-24T16:51:53.957
> 
> 标签：java, android, eclipse, error-handling, nullpointerexception

这是我用来启动活动的代码：

```
startActivity(new Intent(getApplicationContext(), Giveaway.class)); 
```

这是我提出的活动：

```
public class Giveaway extends Activity implements OnClickListener{

static SharedPreferences settings;
SharedPreferences.Editor prefEditor;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.giveaway);

    settings = getSharedPreferences("firsttime", 0);

    LinearLayout facebook = (LinearLayout)findViewById(R.id.facebooklayout);
    Button later = (Button)findViewById(R.id.later);
    Button dontshowagain = (Button)findViewById(R.id.dontshowagain);

    facebook.setOnClickListener(this);
    later.setOnClickListener(this);
    dontshowagain.setOnClickListener(this);

}

public void onClick(View v) {
    switch (v.getId()) {
    case R.id.facebooklayout:
        Uri localuri = Uri.parse("http://www.facebook.com/pages/Bright-Design/366832480049386");
        startActivity(new Intent("android.intent.action.VIEW", localuri));
        break;
    case R.id.later:
        finish();
        break;
    case R.id.dontshowagain:
        finish();
        prefEditor = settings.edit();
        prefEditor.putBoolean("showgiveaway", false);
        prefEditor.commit();
        break;
    }
} 
```

我已经在清单文件夹中声明了 Activity：

```
<activity
        android:name=".Giveaway"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.Dialog"
        android:screenOrientation="portrait"/> 
```

但我不断收到 java.lang.RuntimeException: Unable to start activity java.lang.NullPointerException 错误。这是我的日志：

```
 07-24 12:43:59.082: E/AndroidRuntime(7039): FATAL EXCEPTION: main
07-24 12:43:59.082: E/AndroidRuntime(7039): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.brightdesign.blackops2/com.brightdesign.blackops2.Giveaway}: java.lang.NullPointerException
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.os.Looper.loop(Looper.java:123)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.app.ActivityThread.main(ActivityThread.java:4627)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at java.lang.reflect.Method.invokeNative(Native Method)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at java.lang.reflect.Method.invoke(Method.java:521)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at dalvik.system.NativeStart.main(Native Method)
07-24 12:43:59.082: E/AndroidRuntime(7039): Caused by: java.lang.NullPointerException
07-24 12:43:59.082: E/AndroidRuntime(7039):     at com.brightdesign.blackops2.Giveaway.onCreate(Giveaway.java:29)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-24 12:43:59.082: E/AndroidRuntime(7039):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T16:56:09.400

您需要发布您的布局代码，但最有可能发生的是这三行之一正在返回一个空值：

```
LinearLayout facebook = (LinearLayout)findViewById(R.id.facebooklayout);
Button later = (Button)findViewById(R.id.later);
Button dontshowagain = (Button)findViewById(R.id.dontshowagain); 
```

在调试器中逐步执行这些行，如果其中一个为空，则存在您的问题，因为一旦您尝试设置 on click 侦听器，它就会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:56:46.747

```
Caused by: java.lang.NullPointerException
     at com.brightdesign.blackops2.Giveaway.onCreate(Giveaway.java:29) 
```

告诉我们 Giveaway.onCreate() 中存在 NullPointerException，特别是 Giveaway.java 第 29 行。赔率是`facebook`、`later`和/或`dontshowagain`确实为空。您是否在 giveaway.xml 中定义了所有这三个？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T16:59:33.657

试试这个...

**1.**

```
Intent i = new Intent(Your_Activity.this, Another_Activity.class);
startActivity(i); 
```

**2.**下面这行指向类和空行。

**类：** com.brightdesign.blackops2/com.brightdesign.blackops2.Giveaway}：java.lang.NullPointerException

**行：请检查以下四行，我认为您在这里得到空值。**

```
Uri localuri = Uri.parse("http://www.facebook.com/pages/Bright-Design/366832480049386");

 LinearLayout facebook = (LinearLayout)findViewById(R.id.facebooklayout);
    Button later = (Button)findViewById(R.id.later);
    Button dontshowagain = (Button)findViewById(R.id.dontshowagain); 
```

# c# - 无法在 WPF 中创建未知类型的“样式”异常？

> ID：11635643
> 
> 赞同：0
> 
> 时间：2012-07-24T16:52:37.077
> 
> 标签：c#, wpf, xaml

我有这段代码可以根据在运行时生成的另一个类的生成点创建动态按钮样式，并且我有这个异常'无法创建未知类型'样式'。行号“1”和行位置“2”。

```
string s = "<Style xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" x:Key=\"Mystyle\" TargetType=\"Button\">" +
        "<Setter Property=\"Template\">" +
            "<Setter.Value>" +
              "  <ControlTemplate TargetType=\"{x:Type Button}\">" +
                   " <Grid >" +
                           " <Polygon  Points=\""+points+" Fill=\"{TemplateBinding Background}\"" +
                         "Stroke=\"{TemplateBinding BorderBrush}\" DataContext=\"{Binding}\" />" +
                       " <ContentPresenter HorizontalAlignment=\"Center\"" +
                                   "   VerticalAlignment=\"Center\"/>" +
                   " </Grid>" +
              "  </ControlTemplate>" +
           " </Setter.Value>" +
    "    </Setter>" +
   " </Style>";
        StringReader stringReader = new StringReader(s);
        XmlReader xmlReader = XmlReader.Create(stringReader);
        Style  readerLoadButton = (Style)XamlReader.Load(xmlReader); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:02:02.313

尝试添加命名空间信息......

# php - 将变量从 PHP 传递到 HTML

> ID：11635646
> 
> 赞同：1
> 
> 时间：2012-07-24T16:52:52.260
> 
> 标签：php, html

我有一个页面，`play.html`：

```
 <form method="post" action="play.php">
         <input type="hidden" name="mp3name" value="/MP3/1.mp3">
         <input type="submit"  value="Play My MP# #1" />
    </form>

<form method="post" action="play.php">
    <input type="hidden" name="mp3name" value="/MP3/2.mp3">
    <input type="submit"  value="Play My MP# #2" />
</form> 
```

这会调用另一个页面`play.php`：

```
<?php

$formurl = "play.html" ;
$playerurl = "player.html" ;

$mymp3 = $_GET["mp3name"]; 

header( "Location: $playerurl?mp3name=$mymp3" );
exit ;
?> 
```

然后它调用另一个页面，`player.html`：

```
<audio id="player" src="$mymp3" autoplay preload="auto"> </audio>
       <div>
       <button onclick="document.getElementById('player').play()">Play</button>
       <button onclick="document.getElementById('player').pause()">Pause</button>
       <button onclick="document.getElementById('player').volume+=0.1">Volume Up</button>
       <button onclick="document.getElementById('player').volume-=0.1">Volume Down</button>
          </div> 
```

如何将变量从 PHP 传递到`player.html`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T16:56:43.223

`$mymp3`您在使用`$_GET`时获取变量`<form method='post'..`，将其更改为`$mymp3 = $_POST['mp3name']`;

然后，将您的 player.html 扩展名更改为 player.php 以在其上使用 PHP 代码。

所以，当你有你的 player.php 文件时，改变这个......

```
<audio id="player" src="$mymp3" autoplay preload="auto"> </audio> 
```

对这个...

```
<audio id="player" src="<?php echo $mymp3 ?>" autoplay preload="auto"> </audio> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T16:57:23.940

如果它只是一个纯 HTML 文件，则不能。将其更改为 PHP 文件并使用`<?= $_GET['mymp3'] ?>`. 在`play.php`中，由于您是`mp3name`通过 POST 传递的，因此您还需要`$_POST`代替`$_GET`.

如果您不使用 PHP 5.4，`<?php echo $_GET['mymp3']; ?>`推荐使用 PHP 5.4（感谢@Palladium）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:00:56.637

可能最简单的方法（至少考虑到我们从问题中获得的信息）是摆脱从`play.html`to的重定向`player.html`并从前者发出播放器，而不是让它成为静态 HTML 页面。所以`play.html`看起来像这样：

```
$formurl = "play.html" ;
$playerurl = "player.html";

$mymp3 = $_GET["mp3name"]; 
```

```
<audio id="player" src="<?php echo $mymp3; ?>" autoplay preload="auto"></audio>
<div>
    <button onclick="document.getElementById('player').play()">Play</button>
    <button onclick="document.getElementById('player').pause()">Pause</button>
    <button onclick="document.getElementById('player').volume+=0.1">Volume Up</button>
    <button onclick="document.getElementById('player').volume-=0.1">Volume Down</button>
</div> 
```

或者是否有特殊原因需要通过重定向发生这种情况？如果它*必须*是重定向，那么它是 HTML 页面这一事实限制了您的选择，因为它没有服务器端处理。您*可以*在查询字符串中传递值，因为您已经尝试过：

```
header("Location: $playerurl?mp3name=$mymp3"); 
```

但是随后您会遇到在没有服务器端处理的情况下从查询字符串中*读取它的问题。*不过，您也许可以[使用 JavaScript 做到这一点](https://stackoverflow.com/q/901115/328193)。您必须读取值并在元素上设置`src`属性。`audio`但是使用服务器端处理可能会*更*容易和更可靠。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-04-29T17:48:50.823

完整的html代码、表单、整个页面都可以放在第一个PHP本身。复制第二个 HTML 中的所有内容并放在原始 PHP 文件本身的底部。移除重定向命令头("Location: $playerurl?mp3name=$mymp3"); 从你的PHP。而是使用您的代码编写完整的 html 文件

```
<audio id="player" src="$mymp3" autoplay preload="auto"> </audio>
<div>
<button onclick="document.getElementById('player').play()">Play</button>
 <button onclick="document.getElementById('player').pause()">Pause</button><button onclick="document.getElementById('player').volume+=0.1">Volume Up</button><button onclick="document.getElementById('player').volume-=0.1">Volume Down</button>
</div> 
```

并将它们放在 ?> 下方。将整个文件（底部带有完整 HTML 的 php）全部保存为一个以 .php 作为扩展名的文件。现在，您的 HTML 代码具有已在 PHP 部分本身中定义的变量 $mymp3，其值将可用于该文件中的所有 HTML 和其他 PHP 代码。您可以在同一个文件中添加多个 php 和 html 部分）。将整个文件保存在一个名称中，扩展名为 .php。为此，您不需要另一个单独的 html 文档。在 PHP 中，您可以混合和混合 php 代码和 HTML 页面。

# java - 删除目录时遇到问题，Java

> ID：11635649
> 
> 赞同：1
> 
> 时间：2012-07-24T16:53:09.137
> 
> 标签：java

在我的`jUnit`中，我有以下代码段：

```
private String  session = "/tmp/session/";
private File    f;

@Before
public void setUp() {
    f = new File(session);
    f.mkdir();
}

@After
public void tearDown() {
    System.out.println("Directory deleted:   " + f.delete()); // always false
} 
```

同时：

*   目录权限没问题 ( `drwxr-xr-x`)
*   目录包含一些文件 ( `-rw-r--r--`)
*   没有所有权问题（创建者用户删除）

什么会导致`f.delete()`失败？`f.delete()`相当于`rm -rf`? _

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T17:01:57.730

递归删除非空目录（而不是在此过程中重新发明轮子）的最简单方法是使用现有库中的功能，例如 Apache Commons 文件实用程序的[FileUtils.deleteQuietly()](https://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/FileUtils.html#deleteQuietly%28java.io.File%29)方法，它指定：

> 如果文件是一个目录，删除它和所有子目录（...）要删除的目录不必为空

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T16:59:54.703

如前所述，您的目录在删除之前需要为空。[这里](http://www.mkyong.com/java/how-to-delete-directory-in-java/)有一个很棒的教程，你应该看看。你需要一个`recursive delete`目录和它的所有文件，因为在你删除它之前目录需要是空的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T16:56:15.470

从 File.delete 的 API 文档中：

> ```
> delete
> 
> public boolean delete()
> Deletes the file or directory denoted by this abstract pathname. If this pathname
> denotes a directory, then the directory must be empty in order to be deleted.
> Returns:
> true if and only if the file or directory is successfully deleted; false otherwise
> Throws:
> SecurityException - If a security manager exists and its SecurityManager.checkDelete(java.lang.String) method denies delete 
> ```
> 
> 访问文件

请注意有关目录需要为空的位。

# android - ViewPagerIndicator 不会添加到项目中

> ID：11635650
> 
> 赞同：0
> 
> 时间：2012-07-24T16:53:32.817
> 
> 标签：android, eclipse, android-library, viewpagerindicator

我正在尝试使用 Jake Wharton 的 ViewPagerIndicator 库。我为它创建了一个新的库项目。当我尝试将它添加到 Eclipse时，`<ProjectProperties> -> Android -> Add`它​​会给我一个绿色的复选标记。当我单击菜单然后返回时，库引用消失了。

然后，当我转到我的 Java 构建路径时，我在`Order and Export`和下看到“库” `Projects`。`Projects`我已经读到，从这个 SO 帖子中查看是否是不好的：[找不到 Library.apk！](https://stackoverflow.com/questions/6337673/could-not-find-library-apk)

我也`Could not find library.apk!`从那个 SO 问题中得到了错误。我曾尝试删除 中的库`Projects`，但这只会导致我的导入混乱。

将其从Eclipse 错误中删除`Projects`并悬停在 Eclipse 错误上然后选择`Fix project setup`它后，建议`Add project "library" to <my app>'s Build Path.` 这只是让我回到第一方。

我也尝试过这个 SO 解决方案：[ViewPagerIndicator](https://stackoverflow.com/questions/10654201/viewpagerindicator)

这并没有改变我的项目中的任何内容。我仍然得到`Could not find library.apk!`错误。当我让我的应用程序运行和编译时，它给了我这个错误：

`Caused by: java.lang.ClassNotFoundException: com.viewpagerindicator.UnderlinePageIndicator`

我认为这只是因为我的项目设置太乱了。知道如何最终解决这个问题吗？几个小时以来我一直在尝试不同的事情......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:36:07.540

项目属性 -> Java 构建路径 -> 项目。删除 library.apk。

# silverlight-5.0 - SlowCheetah 无法识别 ServiceReferences.ClientConfig 文件

> ID：11635651
> 
> 赞同：1
> 
> 时间：2012-07-24T16:53:38.797
> 
> 标签：silverlight-5.0, slowcheetah

我正在开发一个 Silverlight 5 应用程序，尝试使用 SlowCheetah 让我的 xml 转换在构建过程中发生，因此它只在构建的部署部分完成。我的问题是，虽然我的“发布”文件夹正在获取转换后的文件，但当我发布代码时，xap 文件无法识别转换后的文件，而是引入了基础 *.ClientConfig 文件。

我试过 Len Charest 的[帖子](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5/view/Reviews/2)但没有成功。

有没有人克服这个？

# android - 将 Android 手机视为其他 Android 手机的遥控器

> ID：11635653
> 
> 赞同：0
> 
> 时间：2012-07-24T16:53:56.920
> 
> 标签：android, bluetooth, wifi

我正在从事最后一年的项目，该项目需要使用一部安卓手机通过蓝牙或 wi-fi 控制另一部手机。我对这个领域很陌生，所以我不知道应该从哪里开始。

基本要求是控制器可以交换屏幕并点击对象。有没有我可以参考的网站或示例？

这是我在互联网上找到的示例应用程序 [http://www.addictivetips.com/mobile/tablet-remote-control-one-android-device-with-another-via-bluetooth/](http://www.addictivetips.com/mobile/tablet-remote-control-one-android-device-with-another-via-bluetooth/)

所以我想知道我是否可以使用 GesturesBuilder 来编写这个应用程序？一部手机作为服务器，一部作为客户端。我在服务器上进行操作，客户端将收到执行相同操作的信号。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:33:54.030

您可以使用套接字编程来做到这一点。见这里：[http ://thinkandroid.wordpress.com/2010/03/27/incorporating-socket-programming-into-your-applications/](http://thinkandroid.wordpress.com/2010/03/27/incorporating-socket-programming-into-your-applications/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-06T16:47:54.617

该应用程序是蓝牙遥控安卓应用程序

[https://play.google.com/store/apps/details?id=com.shakej.blectrl.toll](https://play.google.com/store/apps/details?id=com.shakej.blectrl.toll)

# php - 如何让 Codeigniter CSRF 保护与 SSL 一起正常工作？

> ID：11635654
> 
> 赞同：2
> 
> 时间：2012-07-24T16:53:59.370
> 
> 标签：php, codeigniter, csrf, ssl

我打开了 CI CSRF 保护，它适用于 http。一旦我打开 https（通过将站点的基本 URL 更改为 https 并将所有流量从 http 重定向到 https），我开始看到：

`csrf token is missing on request`

日志中的错误。Codeigniter 在两种情况下报告此错误：

1) csrf 令牌不在 POST 请求中 2) csrf 令牌 cookie 未设置或已过期。

我们所有的 post 请求（主要是 AJAX）都有一个 csrf 令牌，因为我们的自定义 ajax 函数默认包含它，所以我认为它必须是 #2。此外，我在配置中选择了安全和非安全 cookie 设置，在这两种情况下都会出现此错误。

我的猜测是 csrf 令牌 cookie 未设置或未加密。我的主要问题是我无法在自己的系统（Ubuntu 上的 Chrome）上重现，但是一旦我投入生产，我就看到日志立即爆发。

关于我做错了什么甚至如何调试这种情况的任何想法？谢谢！

会话和 Cookie 配置：

```
$config['sess_cookie_name']        = 'session';
$config['sess_expiration']         = 1209600;
$config['sess_expire_on_close']    = FALSE;
$config['sess_encrypt_cookie']     = FALSE;
$config['sess_use_database']       = FALSE;
$config['sess_table_name']         = 'ci_sessions';
$config['sess_match_ip']           = FALSE;
$config['sess_match_useragent']    = TRUE;
$config['sess_time_to_update']     = 300;

$config['cookie_prefix']    = "my";
$config['cookie_domain']    = "";
$config['cookie_path']      = "/";
$config['cookie_secure']    = myconfig('use_https'); //this is true when https 
//is forced, false otherwise 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T06:25:22.267

我将在这里随机回答，因为您提到了**AJAX**调用。我在使用 CI CSRF 保护时遇到的问题：

[http://blog.biernacki.ca/2011/12/enabling-csrf-protection-in-codeigniter-for-ajax-calls/](http://blog.biernacki.ca/2011/12/enabling-csrf-protection-in-codeigniter-for-ajax-calls/)

因为**SSL**与您的 CSRF 工作无关。我什至根本不会认为是这样。您正在查看对非 HTTPS 端口的静态调用，或者在 ajax 调用时未传递 CSRF 的令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T20:08:08.090

可能是用户正在访问[https://example.com](https://example.com)，但请求正在 POST 到[https://www.example.com](https://www.example.com)（反之亦然）。尝试 a) 将 cookie_domain 设置为“.example.com”；[或 b) 创建一个 .htaccess 规则，将所有对https://example.com](https://example.com)的请求重定向到[https://www.example.com](https://www.example.com)

# linux - 使用 SED 与模式匹配来替换命令

> ID：11635655
> 
> 赞同：1
> 
> 时间：2012-07-24T16:54:00.120
> 
> 标签：linux, unix, sed

我想找到所有包含`self.vars['stuff']`该文本的文件并将其替换为`self.v.stuff`.

我曾尝试使用：`sed -e "s/self.vars\['/self.v./" -e "s/'\]//"`，但这会影响碰巧包含`]`的其他行......

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:57:34.657

使用反向引用。这适用于 sed，假设您只使用单引号作为键：

```
s/self\.vars\['\([^]]\+\)'\]/self.v.\1/g 
```

# javascript - 当您单击展开而不是服务器 ping 时，TreeView 执行 javascript 方法

> ID：11635657
> 
> 赞同：0
> 
> 时间：2012-07-24T16:54:06.437
> 
> 标签：javascript, asp.net, user-controls, telerik

***编辑：这个网站是我正在寻找的开始： [http](http://www.telerik.com/help/aspnet-ajax/treeview-client-basics.html) ://www.telerik.com/help/aspnet-ajax/treeview-client-basics.html但是为了选择东西，我没有看到特定于问题的信息. 旁注：如果你知道，findNodeByText(); 递归调用，还是只是离开，还是什么？***

我希望它执行一个javascript命令，而不是按照正常的服务器功能扩展树视图。我的目标是填充 TreeView 客户端，而不是在服务器上使用 Controls.add(child); 在服务器上。

话虽如此，我将如何设置它以覆盖展开/折叠服务器 ping 以将其路由到我自己的呼叫？

```
<telerik:RadTreeView runat="server" ID = "FieldTreeViewer" OnClientNodePopulating="nodePopulating">
   <Nodes>
       <telerik:RadTreeNode runat="server" Text="<%$ Resources: bicweb_resources, REPORT_TYPES %>" ExpandMode = "WebService" Value = "{TopNode}" ></telerik:RadTreeNode>
       <telerik:RadTreeNode runat="server" Text="<%$ Resources: bicweb_resources, UNASSIGNED_FIELDS %>" ExpandMode = "WebService" Value = "{Unassigned}"></telerik:RadTreeNode>
   </Nodes>
   <WebServiceSettings Path="webservices/FormDesigner.svc" Method="getNodesWEBSERVICE" />
</telerik:RadTreeView> 
```

单击时（执行功能），然后相应地展开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T12:52:20.810

这里的诀窍是要扩展，你需要 +，所以在你设置的控件中：

```
ExpandMode="ServerSide" 
```

这为您提供了扩展选项。当您这样做时，要扩展，您还需要设置：

```
OnClientNodeExpanded="FUNCTION" 
```

这将调用函数并展开。接下来是您将要构建节点。我这样做的方式是对服务进行 AJAX 调用，该服务将获取我的孩子，然后在客户端创建节点。请参阅 AJAX 了解如何进行 ajax 调用。要创建节点，类似于：

```
if (result.getChildrenFromTelTreeResult == "") {
    alert("No Children");
} else {
    var childNodes = JSON.parse(result.getChildrenFromTelTreeResult);
    var newChild;
    //alert(childNodes.length);
    for (var i = 0; i < childNodes.length; i++) {
         TV.trackChanges();
         newChild = new Telerik.Web.UI.RadTreeNode();
         newChild.set_text(childNodes[i].pText);
         newChild.set_value(childNodes[i].pValue);
         //confirmed that newChild is set to ServerSide through debug and get_expandMode();
         parentNode.get_nodes().add(newChild);
         TV.commitChanges();
         var parts = childNodes[i].pValue.split(",");
         if (parts[0] != "{fe_id}") {
            newChild.set_expandMode(Telerik.Web.UI.TreeNodeExpandMode.ServerSide);
         }
    }
} 
```

这将通过并创建所有的孩子。最后，我声明如果它是一片叶子，则没有可用的展开按钮。默认值是 CleintSide，所以我只是说基本。if (!leaf){SET NODE = ServerSide} 给它扩展选项。

# java - 引发了一个 SQLException，java.lang.InterruptedException，我的数据库连接用完了吗？

> ID：11635658
> 
> 赞同：3
> 
> 时间：2012-07-24T16:54:08.247
> 
> 标签：java, database, spring, spring-webflow

所以我们运行一个 Hibernate、Spring、Spring Webflow 堆栈。从我目前所读到的内容来看，知道我们使用 c3p0-0.9.1.2 可能也很重要。

在过去的几天里，我们注意到服务器突然停止了。用户无法登录网站，似乎什么也没有发生，浏览器只是永远加载页面。服务器日志也简单地停止。

当我们注意到这一点时，我们关闭了 tomcat 实例，突然间记录了很多以下错误；

```
13:05:57.492 [TP-Processor7]   WARN  o.h.util.JDBCExceptionReporter - SQL Error: 0, SQLState: null
13:05:57.492 [TP-Processor7]   ERROR o.h.util.JDBCExceptionReporter - An SQLException was provoked by the following failure: java.lang.InterruptedException 
```

任何想法这些是什么意思？谷歌并没有太大帮助。我们是否在某处泄漏了数据库连接并且池无法获得新会话？

我们刚刚添加了几个新的 Spring Webflow 流，并且网站流量略有增加，但我们以前从未见过这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:56:01.353

我怀疑这些`InterruptExceptions`来自容器对这些线程的实际关闭，并且只是表明当 Tomcat 关闭时这些线程是存在的。

相反，当它下一次冻结时，我会从 Tomcat 中获取一个[线程转储。](http://expertodev.wordpress.com/2009/05/30/how-to-take-java-thread-dump/)我还会请一位 DBA 告诉您数据库中发生了什么。从上面我猜你挂在数据库资源上，但是来自 DBA 的线程转储和分析肯定会为你指明正确的方向。

这是一个[Thread Dump JSP](http://www.dzone.com/snippets/embed-thread-dump-tool-using)作为生成线程转储的替代方法。

# c# - 从 ArrayList 保存和恢复值

> ID：11635660
> 
> 赞同：1
> 
> 时间：2012-07-24T16:54:15.390
> 
> 标签：c#, store

我在运行时将一些字符串值存储在数组列表中。当应用程序关闭时，我想将数组列表中的数据存储在另一个位置，以便下次应用程序启动时可以打开并检索数据。有哪些可能的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:00:49.790

您可以使用`Reading`和`Writing`从/到文件或将值存储在 Windows 注册表中。对于从/向文件读取/写入，请使用：

```
StreamReader sr = new StreamReader(@"C:/store.dll"); //for reading
StreamWriter sw = new StreamWriter(@"C:/store.dll"); //for writing 
```

这是基本的。这里有两篇很棒的文章：

1.  [从文件中恢复](http://msdn.microsoft.com/en-us/library/ezwyzy7b)
2.  [写入文件](http://msdn.microsoft.com/en-us/library/8bh11f1k)

我用它来存储一个简单游戏的高分。:)

[这](http://www.codeproject.com/Questions/189670/Accessing-Windows-Registry-in-C-net)是一个很好的使用 Windows 注册表的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:59:22.343

您可以`Serialize`将 ArrayList 写入磁盘，然后将文件加载`Deserialize`到对象中：

```
 public static XDocument Serialize<T>(T objectIn, Type[] extraTypes)
    {
        try
        {
            var target = new XDocument();
            XmlSerializer s = extraTypes != null ? new XmlSerializer(objectIn.GetType(), extraTypes) : new XmlSerializer(objectIn.GetType());
            s = extraTypes != null
                ? new XmlSerializer(objectIn.GetType(), extraTypes)
                : new XmlSerializer(objectIn.GetType());

            var writer = target.CreateWriter();

            s.Serialize(writer, objectIn);

            writer.Close();
            return target;
        }
        catch (Exception ex)
        {
            throw new Exception(string.Format("Could not serialize object: {0}", ex.Message));
        }
    }

    public static T Deserialize<T>(XDocument xDocument, string defaultNamespace)
    {
        XmlSerializer s = new XmlSerializer(typeof(T), defaultNamespace);

        T result = (T)s.Deserialize(xDocument.CreateReader());

        return result;
    } 
```

# django - Django：限制对视图的访问，取决于引用 url

> ID：11635666
> 
> 赞同：3
> 
> 时间：2012-07-24T16:54:31.937
> 
> 标签：django, decorator, user-accounts

我正在制作一个学校记录 webapp。我希望员工用户能够通过访问正确的 url 查看任何学生的用户数据页面，但不允许学生访问彼此的页面。但是我对两个 url 使用相同的视图函数。

我有一个`@user_is_staff`基于`user.staff`对象存在的工作装饰器。学生用户有一个`user.pupil`对象。这些自然是离散的，因为没有用户可以同时拥有 a`.staff`和`.pupil`条目。

网址.py

```
(r'^home/(?P<subject>[^/]+)/$', 'myproject.myapp.views.display_pupil')
(r'^admin/user/(?P<user>\d+)/(+P<subject>[^/]+)/$', 'myproject.myapp.views.display_pupil') 
```

视图.py

```
@login_required
def display_pupil(request, subject, pupil=None):
    if pupil:
        try:
            thepupil = get_object_or_404(Pupil, id = pupil, cohort__school = request.user.staff.school)
        except Staff.DoesNotExist:
            return HttpResponseForbidden()
    else:
        thepupil = request.user.pupil
    thesubject = get_object_or_404(Subject, shortname = subject)
    # do lots more stuff here
    return render_to_response('pupilpage.html', locals(), context_instance=RequestContext(request)) 
```

这样做是可行的，但感觉很笨拙，特别是因为我的“@user_is_staff”装饰器比这里的 403 错误更优雅地重定向到登录页面。

我不知道的是如何仅在使用kwarg`@user_is_staff`访问该函数时将装饰器应用于该函数。`pupil`真实视图函数中有更多代码，所以我不想写第二个，因为那将是严重的非 DRY。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:23:05.193

听起来您想要两个单独的视图——一个用于特定学生，一个用于当前用户——以及一个包含共享逻辑的实用程序函数。

```
@login_required:
def display_current_pupil(request, subject):
    thepupil = request.user.pupil
    return display_pupil_info(request, subject, thepupil)

@user_is_staff
def display_pupil(request, subject, pupil):
    thepupil = get_object_or_404(Pupil, id=pupil, cohort__school=request.user.staff.school)
    return display_pupil_info(request, subject, thepupil)

def display_pupil_info(request, subject, thepupil):
    thesubject = get_object_or_404(Subject, shortname=subject)
    # do lots more stuff here
    return render_to_response('pupilpage.html', locals(), context_instance=RequestContext(request)) 
```

# browser - 为什么我的网站要调整浏览器窗口的大小

> ID：11635668
> 
> 赞同：0
> 
> 时间：2012-07-24T16:54:39.930
> 
> 标签：browser, windows-7, resize

我收到一份报告，称我公司的网站正在调整至少一名员工的浏览器窗口的大小。我在用户的计算机上亲身经历了这种行为，这很奇怪，因为调整大小只发生在我们的网站上，而不是在任何其他网站上，而且它发生在 Firefox 和 Internet Explorer 上。用户有一台运行更新软件的 Windows 7 机器。除了通常的（Flash 等）之外，她没有附加组件、主题或插件，她的设置是出厂默认设置。我清除了两个浏览器上的浏览器缓存并重新启动计算机，它仍然发生。唯一剩下的是css，但对我来说似乎没有任何可疑之处。

发生的情况是，当她单击站点上的按钮或内部链接时，当新页面完成加载时，浏览器窗口的大小会调整为内容宽度的大约 80%。也就是说，页面在加载时所做的最后一件事就是调整自身大小。如果她放大或缩小，那么在下一次加载时，它会再次将大小调整为较小或较大内容大小的 80% 左右。如果她最大化然后加载页面，则窗口将调整为 80%，但以某种方式保持“最大化”图标。（然后您必须在“最大化”图标上单击两次才能最大化。）

我感到困惑的原因是，我认为这种行为只能用 JavaScript 才能做到，但我故意用完全没有 JavaScript 的页面进行了测试，它仍然发生。网站上只有一个页面上有浏览器调整大小的 JavaScript，但它调整为像素大小，而不是百分比，而且它是我测试时未使用的 Web 服务的一部分。

我应该调查哪些事情来解决这个问题？因为这是一名员工，我必须修复网站或修复她的电脑，所以调查这两者的想法会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-08T18:48:15.277

问题原来是我提到的带有浏览器大小调整 JavaScript 的单个页面。另一组页面需要来自该 Web 服务的一些 JavaScript 函数，因此有人复制并粘贴了所需的函数。然后其他人出现，注意到复制粘贴是一个愚蠢的想法，并决定简单地包含具有这些功能的 JavaScript 文件。

问题是，调整窗口大小的命令在该文件中是空的。对于那个用户，该命令正在执行并调整每个窗口的大小。对于其他所有人，他们的浏览器都忽略了调整大小命令，除了 web 服务弹出窗口。我只能假设她有问题，因为她有工厂标准设置，而我们其他人没有。为了解决这个问题，我将调整大小命令从 JavaScript 文件移到了 Web 服务页面的头部。

# xml - OpenXML - 从 docx 中提取文本和格式（MS Office *2010*）

> ID：11635670
> 
> 赞同：2
> 
> 时间：2012-07-24T16:54:47.870
> 
> 标签：xml, extract, openxml, docx, office-2010

如果目标是能够将开放的 XML 转换为不太复杂的 XML，那么从 2010 年的 docx 中提取文本和内联标签（粗体、斜体等）的最佳工具是什么？

想到的一个想法是将 docx 转换为另一种格式。如果是这样，您会建议哪种格式以及在哪个程序上（最好是开源的）？

任何其他想法（即不同的方法）？许多工具似乎仍然适用于 MSOffice 2007。即 Xpath、XQuery 和 XSLT 是要走的路吗？如果是，***为什么***？

请耐心等待。我是这方面的初学者，我也很乐意欢迎有关最好简洁的知识来源的指示。

木糖醇

# list - 当无限列表开始重复时过滤

> ID：11635671
> 
> 赞同：4
> 
> 时间：2012-07-24T16:54:49.400
> 
> 标签：list, haskell, sequences

我`[Integer]`在 Haskell 中创建了一个序列。该序列的数学定义是它对一些正整数重复。在这种情况下，我想终止序列并确定有限列表的长度。

我的解决方案尝试是首先从数学序列中创建一个无限列表。然后我想过滤所有元素的列表，直到第一个元素重复。结果不应包括列表的重复标题。

我在这里有两个问题/疑虑：

1）如何将列表的头部与列表后面的元素匹配？2）这是解决我的问题的有效方法吗？（如果需要，我稍后会添加有关确切顺序的更多详细信息。现在我正在寻找一般性评论。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T17:13:16.583

您描述的算法可以简单地实现如下：

```
findPeriodic :: Eq a => [a] -> [a]
findPeriodic [] = error "there are no periodic sequences in the empty list"
findPeriodic (x : xs) = x : takeWhile (/= x) xs 
```

它完全按照您的描述进行：它获取某个列表的头部，并收集列表的一部分，直到该头部元素再次出现在列表中。因此，例如：

```
list = [1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, ...]
findPeriodic list => [1, 2, 3, 4, 5] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T11:31:12.803

第一个元素可能永远不会以`1,2,3,4,5,3,4,5,3,4, ...`, where之类的顺序重复`(a !! i) == (a !! j) ==> (a !! (i+1)) == (a !! (j+1))`（就像您在评论中添加的那样，这与您在问题中要求的不同）。

这称为[循环检测，最近在](http://en.wikipedia.org/wiki/Cycle_detection#Algorithms)[此处](https://stackoverflow.com/questions/11591362/finding-the-beginning-node-of-a-loop-in-a-linked-list)进行了讨论。

# javascript - Javascript：离开单页应用程序时的用户确认

> ID：11635675
> 
> 赞同：3
> 
> 时间：2012-07-24T16:55:02.577
> 
> 标签：javascript, extjs, extjs4.1, extjs-mvc

我想让用户确认她想离开我的单页应用程序。ExtJS 4.1 提供了[`onWindowUnload`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.EventManager-method-onWindowUnload)我想插入的[`Confirm`对话框](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.window.MessageBox-method-confirm)。

如果用户决定继续关闭选项卡/窗口，则对注销 URL 的[Ajax 请求](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Ajax)应告知服务器端用户已注销。

上述方法可行吗？

是否可以在 ExtJS 中插入`onWindowUnload`事件[`MVC controller`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.app.Controller)？

**PS** *离开单页应用的*用户可以是以下任意一种：浏览器标签关闭、浏览器窗口关闭、浏览器后退按钮、浏览器前进按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:37:34.180

您需要为窗口的`onbeforeunload`事件添加一个侦听器。

它是一种特殊类型的事件处理程序，您应该仔细阅读文档。

MDN 文档：[https ://developer.mozilla.org/en/DOM/window.onbeforeunload](https://developer.mozilla.org/en/DOM/window.onbeforeunload)

微软文档： http: [//msdn.microsoft.com/en-us/library/ie/ms536907 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms536907(v=vs.85).aspx)

Ext 附加事件处理程序的标准方法不适用于此特定事件。

您需要使用标准`addEventListener`或`attachEvent`方法。

例子：

[http://jsfiddle.net/NhLQK/9/](http://jsfiddle.net/NhLQK/9/)

*   我可以使用自己的对话框吗？不
*   我可以在 Firefox 中显示我自己的消息吗？不
*   我可以使用确认（）吗？不
*   我可以让它们在不同的浏览器中看起来一样吗？不
*   我可以在用户关闭浏览器之前触发 AJAX 消息吗？是的，如果是`synchronous`：

    Ext.Ajax.request({ url:'some url', async:false, method:'POST' });

† 它似乎在带有 ext 4.1.1 的 Chrome 中工作

# java - 如何与 getString() string.xml 和 String Object 进行比较？

> ID：11635678
> 
> 赞同：1
> 
> 时间：2012-07-24T16:55:14.690
> 
> 标签：java, android, getstring

我在比较字符串时遇到问题：我在 string.xml 中获得了“activation”的字符串值。当我将它与具有相同值的字符串值进行比较时，结果始终为假（在 string.xml 中激活 = 测试）

```
<?xml version="1.0" encoding="utf-8"?>
<resources> 
    <string name="app_name">MyNameApp</string>
    <string name="activation">test</string>
</resources> 
```

* * *

```
public class CheckGenuine {     
    public static String cod;
    public static String app;

    public static Boolean chk(Context ctx) {    
        Boolean ret;
        cod = ctx.getString(R.string.activation);
        app = ctx.getString(R.string.app_name);

        if (cod == "test") {
            Toast.makeText(ctx, "True cod = " + cod, Toast.LENGTH_LONG).show();     
            ret = true;} 
        else {
            Toast.makeText(ctx, "False cod = " + cod, Toast.LENGTH_LONG).show();  
            ret = false;}

  // *** why ret is always false and Toast shows "False cod = test"   ????????????????  

        return ret;     
    }   

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:56:24.190

您应该使用`.equals()`比较字符串值，而不是`==`运算符。[本文](http://leepoint.net/notes-java/data/expressions/22compareobjects.html)很好地解释了差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:59:31.457

利用**`if (cod.equals("test")) {`**

**`==`**->> 比较字符串引用（内存位置）

**`.equals()`** 比较字符串值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-12T06:03:43.257

字符串比较在Java中是通过equals()函数进行的，如果使用'==操作'，则表示按2个对象本身进行比较，而不是按值进行比较。

```
String value = "myString"
if (value.equals("myString")) {
} 
```

# javascript - 元素 ID 未被接受为函数参数？

> ID：11635680
> 
> 赞同：1
> 
> 时间：2012-07-24T16:55:27.653
> 
> 标签：javascript, jquery

我试图将参数传递给函数，即

```
 animateDiv(div) {
  .....

} 
```

这个函数有效，但是当我尝试像这样向它传递参数时，它不起作用，即

```
$activeToggle.toggle("slow", function(){
            $(this).find(".anime_yellow").each(function (i,e){

            console.log(e.id); // this prints simple
            animateDiv(simple); // this works
            animateDiv(e.id);   //this deosnt work but it prints 'simple' 

         }); 
```

当我将核心值传递给它工作的函数时，即`animateDiv(simple)`，如果我尝试放置一个包含相同内容的变量，它不会工作`animateDiv(e.id)`，谢谢

完整的代码在这里：http: [//jsfiddle.net/Fwhtv/22/](http://jsfiddle.net/Fwhtv/22/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T16:59:37.230

您`animateDiv`假设您将传递一个对象。请注意以下几行：

```
function animateDiv(div){
   var text = $('#' + div.id).text(); //div is assumed to be a div element 
```

如果您想传入一个`id`，则必须将其更改为：

```
function animateDiv(divId){
   var text = $('#' + divId).text(); 
```

当然`div.id`，还要更新其他参考资料。

工作：http: [//jsfiddle.net/Fwhtv/22/](http://jsfiddle.net/Fwhtv/22/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:59:07.700

从你的jsfiddle：

```
function animateDiv(div){

var text = $('#' + div.id).text();

var doAnimate = function() {
    $('span.' + div.id).each(function() {
        var that = $(this);
        setTimeout(function() {
            that.animate({ fontSize: "90px" }, 1500 )
                .animate({ fontSize: "50px" }, 1500 );
        },that.index()*100);
    });
} 
```

您正在传递 ID，但在函数中您期望该元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:38:21.000

```
$activeToggle.toggle("slow", function(){
      $(this).find(".anime_yellow").each(function (i,e){

            console.log(e.id); // this prints simple
            animateDiv(simple); // this works
            animateDiv(e.id);   //this deosnt work but it prints 'simple' 

         }); 
```

在函数 (i, e) 中，e 是元素。

```
<span id="simple" class="anime_yellow"> 
```

要获取 的 id，您需要使用 $(e).attr('id');

```
animateDiv($(e).attr('id')); 
```

当前，您将参数作为对象传递。如果您传递对象（跨度）的 id，则需要按如下方式更改跨度的 id。

```
function animateDiv(div){
// var text = $('#' + div.id).text();
var text = $('#' + div).text();

var doAnimate = function() {
    //  $('span.' + div.id).each(function() {
     $('span.' + div).each(function() {

        var that = $(this);
        setTimeout(function() {
            that.animate({ fontSize: "90px" }, 1500 )
                .animate({ fontSize: "50px" }, 1500 );
        },that.index()*100);
    });
} 
```

# mysql - MySQL 查询 - 选择最近的配置和最近的操作

> ID：11635681
> 
> 赞同：0
> 
> 时间：2012-07-24T16:55:32.520
> 
> 标签：mysql, sql

我真的需要帮助通过一个查询来解决这个问题。

我有四张桌子：

```
[Assets]
[id | serial_number | date_created] (other stuff)

[Parts]
[id | unit_number | date_created] (other stuff)

[Groups]
[id | asset_id | part_id | date_created] (other stuff)

[Activity]
[id | group_id | date_recorded | action_id] (other stuff) 
```

如何选择所有资产并找到它们最近的配对（组）以及在该组中的最新活动。在一个记录行中。

编辑：我尝试过的：

1.  我这样做了，`php`但它非常难看，需要三个单独的查询。

2.  我通过单独的从每个表中选择了所有属性`SELECT`，我认为这是一种可怕的方式

    ```
    SELECT
        *,
        (
            SELECT
                part_id
            FROM
                groups
            ORDER BY
                date_created 
            DESC
            LIMIT 1
        ) AS part_id
    FROM
        assets 
    ```

为了抓住`part_id`我做一个嵌套选择，但如果我需要 9 个属性，我需要 9 个嵌套选择，这是一个不好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:32:38.367

您的查询建议如下：

```
SELECT *
FROM assets a cross join
     (select *
      from groups
      order by date_created
      limit 1
     ) g 
```

但是，我怀疑您可能真的想在某个字段（组 ID？部分 ID？）上加入资产和组，并根据该字段选择最近的记录。以下查询执行此操作，假设部分是匹配字段：

```
SELECT *
FROM assets a join
     (select *
      from groups g join
           (select g.part_id, max(date_created) as maxdate
            from groups g
            group by g.part-id
           ) gmax
           on g.part_id = gmax.part_id and
              g.date_created = gmax.maxdate
     ) g
     on a.parts_id = g.parts_id 
```

# mysql - mysql如何与进程一起工作？

> ID：11635682
> 
> 赞同：0
> 
> 时间：2012-07-24T16:55:33.847
> 
> 标签：mysql

```
mysql  Ver 14.16 Distrib 5.2.12-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2, tables MyISAM 
```

情况：来自两个不同客户端的两个选择查询到一个数据库和表（带有连接的查询）。
服务器上的处理器有 8 个内核。
我想知道，是不是启动了两个进程，每个客户端一个，8核中的一个执行每个进程？
这是可能的？max_process 是否有任何 MySQL/MariaDBoption 或其他选项？
据我了解，一个 mysql 进程可以与 1 个处理器核心一起工作。我让谷歌搜索它，并找到有关 InnoDB 表的一些插件的信息，它适用于多核处理器，但我想了解 mysql 的工作原理。我需要对此做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T20:35:01.120

默认情况下（MySQL 5.5+） MySQL 对线程数没有限制，您的操作系统将负责调度线程（在处理器之间拆分它们等）。

阅读：

[**innodb_thread_concurrency**](http://dev.mysql.com/doc/refman/5.5/en/innodb-parameters.html#sysvar_innodb_thread_concurrency)

> 推荐值是 CPU 数量加上磁盘数量的 2 倍。

要深入了解此主题，请阅读有关[线程并发的更改](http://dev.mysql.com/doc/innodb/1.1/en/innodb-performance-thread_concurrency.html)和[MySQL 如何使用线程进行客户端连接](http://dev.mysql.com/doc/refman/5.5/en/connection-threads.html)。

# stl - stl 库在复制指针时是否使用 malloc？

> ID：11635684
> 
> 赞同：3
> 
> 时间：2012-07-24T16:55:39.557
> 
> 标签：stl, copy, malloc, shallow-copy

我有一个关于在 stl 库中复制指针的问题。说我定义：

`struct A{ int x; }`

`std::map<int, const A*> map1;`

然后，我使用堆中的内存填充 map1，使用 malloc 作为指向 A 的指针。

然后我做

`std::map<int, const A*> map2 = map1;`

对于 map2 中结构 A 的每个指针，std::map 是对指针进行浅拷贝，还是从堆中为每个指针分配新内存？

干杯

尚克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T16:58:52.707

它只会复制指针。这意味着将制作浅拷贝而不是深拷贝。您可以使用简单的测试程序轻松检查实际行为：

```
int main() {
    std::map<int, int*> map1;        
    map1[0] = new int(10);

    std::map<int, int*> map2 = map1;
    *(map2[0]) = 20;

    // this must print 20 if a shallow copy is used
    std::cout << *(map1[0]) << std::endl;
} 
```

# interop - Word Interop 逐字逐句检查文档太慢

> ID：11635685
> 
> 赞同：0
> 
> 时间：2012-07-24T16:55:47.123
> 
> 标签：interop, ms-word, spell-checking

使用下面的代码基本上我正在逐字检查文档并分离正确的文档。我工作，但太慢了，我必须等待 10 多分钟才能写 4 万字。当我打开同一个文档时，Word 会在几秒钟内对其进行检查。我究竟做错了什么？

```
var application = new Application();
        application.Visible = false;
        Document document = application.Documents.Open("C:\\Users\\hrzafer\\Desktop\\spellcheck.docx");

        // Loop through all words in the document.
        int count = document.Words.Count;
        IList<string> corrects = new List<string>();
        for (int i = 1; i <= count; i++)
        {
            if (document.Words[i].SpellingErrors.Count == 0)
            {
                string text = document.Words[i].Text;
                corrects.Add(text);
            }
        }

        File.WriteAllLines("corrects.txt", corrects);
        application.Quit(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T15:37:28.570

一种解决方法，因为您似乎只需要文档中的正确单词：

```
for i=ActiveDocument.Range.SpellingErrors.Count to 1 step -1
    ActiveDocument.Range.SpellingErrors(i).Delete
next 
```

然后用新名称保存文档

```
ActiveDocument.SaveAs FileName:="C:\MyWordDocs\NewFile.docx", _ 
    FileFormat:=wdFormatXMLDocument 
```

# php - PHP：解析 JSON 和方括号

> ID：11635686
> 
> 赞同：1
> 
> 时间：2012-07-24T16:55:47.997
> 
> 标签：php, arrays, json

使用 PHP，我如何解析 JSON 对象，其数组在方括号中给出并由管道“|”分隔？

例如，我需要访问“数据”的第二个组件，在本例中为“英语”。假设长度是可变的，因此您不能按字符位置切片。

```
{"Username":"5018",
 "Data":["53094185|English|USA|2012-07-24 12:49:00|AZ|"],
 "Location":"New York"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:59:41.397

这很简单：

```
$X = json_decode($JSON);
$arr = explode('|', $X->Data[0]);
print_r($arr) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:58:50.770

json_decode 它。您仍然需要拆分数据数组值字符串，因为这只是 JSON 中的一个简单字符串。

# node.js - windows node.js REPL 命令提示错误信息

> ID：11635687
> 
> 赞同：0
> 
> 时间：2012-07-24T16:55:53.373
> 
> 标签：node.js, x86, read-eval-print-loop

我对开源完全陌生，真的很想更多地使用它。我从 nodejs.org 安装了 (x86)node.js。我从安装列表中启动了“Node.js 命令提示符”，并执行了 node.exe。我正在尝试运行一些示例 javascript。如果我这样做，为什么会这样：

```
>var life = 11;
undefined
^^^^^^^^^
why am I getting this message?

or 

>a = [1,2,3]
[1,2,3]
>a.forEach(function (v) {console.log(v);});
1
2
3
undefined 
^^^^^^^^^
//still get this, even though the script executed??
> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:59:26.573

`undefined`只是您执行的语句的返回值。只有当你执行了一个函数时才有意义/有用，真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:59:36.357

控制台打印脚本的返回值，即`undefined`

写这个：

```
"hello"; 
```

然后按回车。现在返回值应该是`"hello"`而不是`undefined`。

你也可以这样做；

```
var life = 11; life; 
```

# wpf - 为什么 WPF 不能正确渲染我的颜色？

> ID：11635688
> 
> 赞同：3
> 
> 时间：2012-07-24T16:55:55.140
> 
> 标签：wpf, blend

如果这个问题已经得到回答，我提前道歉，但我无法通过几个谷歌得到任何东西。

我有一个 8 位颜色配置文件的 Photoshop 图像。我正在使用 Blend 将其转换为 WPF 应用程序。但是，当我运行应用程序时，我输入的颜色不是正在渲染的颜色。

具体来说，我的灰色是#111111。这就是我在 Blend (BorderBrush="#FF111111") 中所拥有的，也是我在 Photoshop 中展示的。然而，当我运行应用程序时，我注意到我的颜色有所不同。我在渲染的应用程序上做了一个屏幕截图，我得到了#090909。

这些是微妙的灰色调，实际上对应用程序有很大的视觉影响。

我在这里遗漏了什么，还是我只需要猜测“应该”的值是什么，直到 WPF 真正正确地得到它们......？

# jquery - 更改不透明度和背景时的箱形阴影不一致

> ID：11635692
> 
> 赞同：0
> 
> 时间：2012-07-24T16:56:07.310
> 
> 标签：jquery, opacity, css

我有[这个 jsFiddle](http://jsfiddle.net/TMXLz/6/)。当任何块悬停时，它会扩展（通过用填充替换其边距）并获得一个盒子阴影，而其余块通过 jQuery 变为半透明。

没有一个元素有定义的背景，所以默认情况下它是白色的，每个块内都是一个大部分是白色的图像。但是，正如您所看到的，悬停的块`box-shadow`并不统一：它取决于它是在白色背景（图像）还是*未定义*的背景（其余块，它们之间的空间）之上。

将s的背景设置为`div.block`白色[解决了部分问题](http://jsfiddle.net/TMXLz/8/)，即整个块的阴影是相同的；但是我似乎对块*之间*的空间无能为力。

jQuery 是否也应该对悬停块的父容器做些什么？使用 rgba 代替 opacity 会有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:08:46.777

我不完全确定我理解你的问题，但是在你的第二个小提琴的基础上，我相信*添加这个 css*有助于使阴影看起来更好（[**见 fiddle**](http://jsfiddle.net/TMXLz/11/)），我认为这可以解决你所指的问题：

```
div.block.expanded {
    position: relative;
    z-index: 2;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:08:55.777

这个怎么样：

[http://jsfiddle.net/seY6L/](http://jsfiddle.net/seY6L/)

# asp.net-mvc - 哪些文件要上传到 ASP.NET MVC 网站的 Web 服务器

> ID：11635694
> 
> 赞同：1
> 
> 时间：2012-07-24T16:56:13.003
> 
> 标签：asp.net-mvc, hosting

我已经创建了一个 ASP.NET MVC 站点，现在我需要将它上传到 Web 托管服务器，为此我必须上传整个项目还是只上传选定的文件和文件夹集。如果是这样，我应该将哪些文件夹和文件上传到 Web 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:28:51.087

只需在 Visual Studio 中右键单击项目并选择发布...这会将所需文件发布到您可以上传它们的文件夹。

有几点需要注意。

*   在运行 Publish 之前将构建配置设置为 Release。这会替换您的 Web.Release.config 文件中的值，该文件默认将 debug 设置为 false，但您也可以放入服务器连接字符串和其他生产设置。

*   默认情况下，一些必需的 dll 不会包含在 Publish 文件夹中。要包含引用的 dll，请在 Reference 文件夹中选择它并将其 Copy Local 属性设置为 True。弄清楚哪些 dll 不在您的服务器上并且需要手动添加，这有点麻烦。

# delphi - 检查内存是否可读或为什么它没有捕获异常？

> ID：11635701
> 
> 赞同：0
> 
> 时间：2012-07-24T16:56:43.643
> 
> 标签：delphi, winapi, fpc

我有从外部进程注入的 DLL 调用的这段代码。它可以读取一些内存范围，但我有时会在这一行遇到分段错误`DataBuffer := TCharPointer(Address + CharOffset)^;`。那么有没有办法检查内存是否可读？

```
function GetCurrentData(Address: Pointer): PChar;
var
  DataBuffer: Char;
  CharArray: Array of Char;
  CharOffset: Integer;
  ReadBytes: longword;
begin
  CharOffset := 0;
  SetLength(CharArray, 0);
  repeat
    DataBuffer := TCharPointer(Address + CharOffset)^;
    CharOffset := CharOffset + 1;
    SetLength(CharArray, CharOffset);
    CharArray[CharOffset - 1] := DataBuffer;
  until (Ord(DataBuffer) = 0);
  Result := PChar(@CharArray[0]);
end; 
```

我也试图捕捉异常，但由于某种原因这不起作用。主机程序仍然崩溃。

```
unit UnitEventBridgeExports;

{$mode objfpc}{$H+}

interface

uses
  Classes, SysUtils, Windows, ShellAPI, JwaTlHelp32, SimpleIPC;

type
  TCharPointer = ^Char;

const
  WOWEXE = 'TestProgramm.exe';

var
  IPCClient: TSimpleIPCClient;
  PID: DWord;
  Process: THandle;

procedure EventCalled;
procedure InitializeWoWEventBridge; stdcall;

implementation

function GetProcessIDByName(Exename: String): DWord;
var
  hProcSnap: THandle;
  pe32: TProcessEntry32;
begin
  Result := 0;
  hProcSnap := CreateToolHelp32SnapShot(TH32CS_SNAPPROCESS, 0);
  if hProcSnap <> INVALID_HANDLE_VALUE then
  begin
    pe32.dwSize := SizeOf(ProcessEntry32);
    if Process32First(hProcSnap, pe32) = True then
    begin
      while Process32Next(hProcSnap, pe32) = True do
      begin
        if pos(Exename, pe32.szExeFile) <> 0 then
          Result := pe32.th32ProcessID;
      end;
    end;
    CloseHandle(hProcSnap);
  end;
end;

procedure InitializeEventBridge; stdcall;
begin
  IPCClient := TSimpleIPCClient.Create(nil);
  IPCClient.ServerID := 'EventBridgeServer';
  IPCClient.Active := True;
  IPCClient.SendStringMessage('init');
  PID := GetProcessIDByName(EXE);
  Process := OpenProcess(PROCESS_ALL_ACCESS, False, PID);
end;

function GetCurrentData(Address: Pointer): PChar;
var
  DataBuffer: Char;
  CharArray: Array of Char;
  CharOffset: Integer;
  ReadBytes: longword;
  CharPointer: TCharPointer;
  BreakLoop: Boolean;
begin
  CharOffset := 0;
  SetLength(CharArray, 0);
  BreakLoop := False;
  repeat
    try
      CharPointer := TCharPointer(Address + CharOffset);
      DataBuffer := CharPointer^;
      CharOffset := CharOffset + 1;
      SetLength(CharArray, CharOffset);
      CharArray[CharOffset - 1] := DataBuffer;
    except
      BreakLoop := True;
    end;
  until (Ord(DataBuffer) = 0) or BreakLoop;
  Result := PChar(@CharArray[0]);
end;

procedure EventCalled;
var
  TmpAddress: Pointer;
  StringData: PChar;
begin
  {$ASMMODE intel}
  asm
    mov [TmpAddress], edi
  end;
  StringData := GetCurrentData(TmpAddress);
  IPCClient.SendStringMessage('update:' + StringData);
  //IPCClient.SendStringMessage('update');
end;

end. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T20:03:24.737

您的`GetCurrentData()`实现正在返回一个指向本地数组的指针，该数组在函数退出时超出范围，然后`EventCalled()`在它不再有效后尝试使用该指针。试试这个：

```
function GetCurrentData(Address: Pointer): AnsiString; 
var 
  Offset: Integer; 
begin 
  Result := '';
  Offset := 0; 
  repeat 
    try 
      if PByte(Longint(Address) + Offset)^ = #0 then Break;
      Inc(Offset); 
    except 
      Break; 
    end; 
  until False; 
  SetString(Result, PAnsiChar(Address), Offset); 
end; 

procedure EventCalled; 
var 
  TmpAddress: Pointer; 
  StringData: AnsiString; 
begin 
  {$ASMMODE intel} 
  asm 
    mov [TmpAddress], edi 
  end; 
  StringData := GetCurrentData(TmpAddress); 
  IPCClient.SendStringMessage('update:' + StringData); 
  //IPCClient.SendStringMessage('update'); 
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:03:58.757

[`IsBadReadPtr`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366713%28v=vs.85%29.aspx)API 可以为您提供帮助。你给出地址和大小，你就可以恢复可读性。Raymond Chen[建议不要使用它](http://blogs.msdn.com/b/oldnewthing/archive/2006/09/27/773741.aspx)。

除此之外，[VirtualQuery](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366902%28v=vs.85%29.aspx)应该为您提供有关地址的信息，以说明其可读性。

由于肯在下面的评论中重新警告了 的危险`IsBadReadPtr`，因此我提出了不要错过的答案。请务必阅读 Raymdond 博客的评论和链接。一定要看看：

*   [IsBadReadPtr 的最有效替代品？](https://stackoverflow.com/questions/496034/most-efficient-replacement-for-isbadreadptr)
*   [如何检查指针是否有效？](https://stackoverflow.com/questions/993324/how-to-check-if-a-pointer-is-valid)

# ruby-on-rails - `rails generate scaffold_controller`不响应视图的参数

> ID：11635704
> 
> 赞同：2
> 
> 时间：2012-07-24T16:57:02.957
> 
> 标签：ruby-on-rails, thor

在`scaffold_controller`帮助 ( `rails generate scaffold_controller -h`)

> > 传递模型名称（CamelCased 或 under_scored）**以及视图列表作为参数**。

当我添加输入类似

```
rails generate scaffold_controller Page home 
```

我获得了所有 REST 操作和视图，但没有主视图。

我在这里检查了 rails repo 的历史，可以追溯到scaffold_controller 生成器的诞生，[我](https://github.com/rails/rails/commit/35c4df4aa5812abcd5928c31c1e673e32434b751#diff-5)没有看到任何似乎可以接受参数的东西，但是相同的文档。

**这只是一个被忽视的错误，还是我错误地输入了我的论点（或其他东西；）？**

### 更新

好像一直在寻找`rails generate controller Page home`。不过，文档中似乎仍然存在错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:12:58.230

我认为

```
rails generate controller Page home 
```

将为您产生预期的结果，尽管它在控制器中缺少常规 show/index/update/destroy 方法的生成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:13:28.030

我认为您必须像这样传递模型字段：

```
rails generate scaffold_controller Page title:string description:text 
```

如果你想生成一些视图，你必须这样做：

```
rails generate controller Page home 
```

# arrays - .NET Linq。对 SelectMany 的困惑

> ID：11635707
> 
> 赞同：2
> 
> 时间：2012-07-24T16:57:14.813
> 
> 标签：arrays, list, select, linq

在给定的代码示例中，为什么我们使用 x.ToArray() ？每个元素 x 已经是一个数组不是吗？

请让我不那么困惑:)

```
 var array1 = new int[3] { 1, 2, 3 };     //New integer array
    var array2 = new int[3] { 4, 5, 6 };     //New integer array
    var array3 = new int[3] { 7, 8, 9 };     //New integer array

    IList<int[]> list4 = new List<int[]> { array1, array2, array3 };

    var theManyList = list4.SelectMany(x => x.ToArray()).ToList(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T17:02:10.177

你不需要它。你可以这样做：

```
list4.SelectMany(x => x).ToList(); 
```

原因正如您所说，数组已经是数组。SelectMany 需要一个`IEnumerable<T>`，所以不需要添加额外的操作。为什么有人在一个例子中这样做，不知道。也许他们试图明确表示您必须通过 IEnumerable？

# settings - 根据文件名设置 Vim 选项

> ID：11635710
> 
> 赞同：4
> 
> 时间：2012-07-24T16:57:23.657
> 
> 标签：settings, vim

[Pentadactyl](http://5digits.org/pentadactyl/)允许您在网站上使用外部文本编辑器`<textarea>`和`<input type="text">`元素。我为此使用 GVim。这个功能非常有用，但让我想到了一个问题。我经常想在编辑后换行，所以我的工作流程如下：

1.  `CTRL+I`启动 GVim
2.  采用`:set tw=72`
3.  执行我的文本操作
4.  用于`gq`重新包装需要它的区域
5.  `:wq`

`tw=72`我想跳过第 2 步而不影响 [G]Vim中的其他编辑（即我不想直接设置`.[g]vimrc`所有文件）。`:set tw=72`例如，在 Linux 上的这种特定情况下，Pentadactyl 总是启动`$EDITOR`的最佳方法是什么`/tmp/pentadactyl.txt`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T16:59:32.533

将此文件添加`autocmd`到您的 .vimrc 中：

```
autocmd BufRead  /tmp/pentadactyl.txt  setlocal tw=72 
```

这会添加一个挂钩，`setlocal tw=72`当您在读取给定文件名后开始编辑缓冲区时，该挂钩会自动执行。

请参阅`:help autocmd`和`:help autocmd-events`了解更多信息。

同样，如果您的第 4 步是可预测的，即您总是重新格式化整个文件，您可以添加一个`autocmd`for `BufWrite`。

# ruby - AJAX 调用在 Ruby on rails 中不起作用

> ID：11635711
> 
> 赞同：0
> 
> 时间：2012-07-24T16:57:31.257
> 
> 标签：ruby, ruby-on-rails-3

我正在从“Agile web development with rails, 4th edtion”一书中学习 ruby​​。我正在使用 rails 3.2 和 ruby​​ 1.9.2 。

我尝试使用以下代码调用卡的 AJAX 功能

```
 <%= button_to 'Add to Cart', line_items_path(product_id: product) , remote: true %> 
```

然后在控制器的“创建”操作方法中为 line_item 添加

```
 respond_to do |format|
      if @line_item.save
       # format.html { redirect_to @line_item.cart,notice: 'Line item was successfully created.' }
        format.html { redirect_to store_url }
        format.js 
```

然后在 line_items 视图中创建 create.js.erb 文件并添加内容

```
$('#cart').html("<%=j render @cart %>"); 
```

“购物车”部分是

```
<div class="cart_title">Your Cart</div>
<table>
  <%= render(cart.line_items) %>

  <tr class="total_line">
    <td colspan="2">Total</td>
    <td class="total_cell"><%= number_to_currency(cart.total_price) %></td>
  </tr>
</table>
  <%= button_to 'Empty cart', cart, method: :delete, confirm: 'Are you sure?' %> 
```

“line_item”部分是

```
<tr>

  <td><%= line_item.quantity %>&times;</td>
  <td><%= line_item.product.title %></td>
  <td class="item_price"><%= number_to_currency(line_item.total_price) %></td>
</tr> 
```

现在，当我在正常刷新页面的情况下运行它时，购物车内容会更新并且工作正常，但是当我使用上面显示的“添加到购物车”按钮执行此操作时，它会触发 AJAX 调用，并且似乎以某种方式控制是未到达 create.js.erb 文件或“line_items”部分。当我在开发日志中看到时，我看到了以下消息。

```
Started POST "/line_items?product_id=1" for 127.0.0.1 at 2012-07-24 22:04:24 +0530
Processing by LineItemsController#create as JS
  Parameters: {"authenticity_token"=>"+8jnhCPyLhj26JDuaP1LRUNhVGGlOpFyJcfVXoffX+U=", "product_id"=>"1"}
  [1m[35mCart Load (0.2ms)[0m  SELECT "carts".* FROM "carts" WHERE "carts"."id" = ? LIMIT 1  [["id", 14]]
  [1m[36mProduct Load (0.1ms)[0m  [1mSELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT 1[0m  [["id", "1"]]
  [1m[35mLineItem Load (0.3ms)[0m  SELECT "line_items".* FROM "line_items" WHERE "line_items"."cart_id" = 14 AND "line_items"."product_id" = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.8ms)[0m  UPDATE "line_items" SET "quantity" = 18, "updated_at" = '2012-07-24 16:34:24.620944' WHERE "line_items"."id" = 40
  [1m[36m (12.1ms)[0m  [1mcommit transaction[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT "line_items".* FROM "line_items" WHERE "line_items"."cart_id" = 14
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT "products".* FROM "products" WHERE "products"."id" = 1 LIMIT 1[0m
  Rendered line_items/_line_item.html.erb (5.3ms)
  Rendered carts/_cart.html.erb (7.2ms)
  Rendered line_items/create.js.erb (8.4ms)
Completed 500 Internal Server Error in 30ms

ActionView::Template::Error (undefined method `title' for nil:NilClass):
    1: <tr>
    2: 
    3:   <td><%= line_item.quantity %>&times;</td>
    4:   <td><%= line_item.product.title %></td>
    5:   <td class="item_price"><%= number_to_currency(line_item.total_price) %></td>
    6: </tr>
    7: <!-- <%= debug(line_item) %> -->
  app/views/line_items/_line_item.html.erb:4:in `_app_views_line_items__line_item_html_erb__4463614436040447986_70300167607120'
  app/views/carts/_cart.html.erb:3:in `_app_views_carts__cart_html_erb___214977825009850242_70300164957540'
  app/views/line_items/create.js.erb:3:in `_app_views_line_items_create_js_erb___2733752682449914066_70300166787700'
  app/controllers/line_items_controller.rb:52:in `create' 
```

请帮助指出错误？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:54:12.383

您将获得一个没有产品的 line_item。因此，当你这样做时，你`line_item.product`会得到一个`nil`然后，当你这样做时`nil.title`会抛出一个错误，因此不会渲染视图。也许您忘记在创建操作中获取（正确的）line_item？

# sql - 单个外键可以指向多个主键吗？

> ID：11635714
> 
> 赞同：0
> 
> 时间：2012-07-24T16:57:42.177
> 
> 标签：sql, foreign-keys

我有一个使用（简化）表用户和表超级用户设置数据库的情况。两者都有一个列 ID。每个 SuperUser 行在 User 表中都有一行具有相同的 Id 值（不是我的设计！！！）。SUperUser 表不会从 User 表中提取公共信息，它会复制它。

是否可以/应该指向 User.Id 的任何外键也与 SuperUser.Id 具有 FK:PK 关系？我对此的看法是，这至少是一个非常糟糕的主意，并且许多（大多数？）数据库无法强制执行这种关系/

我在这儿不准吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:29:51.713

根据我对您的问题的理解，您将遇到两个主要问题，即同时为 User 和 SuperUser 表设置外键。

1.  除非用户在两个表中，否则您将无法使用这样设置的外键输入或更新任何表，因为外键期望用户 ID 存在于它们中。

2.  如果您使用级联删除设置外键并从 SuperUser 中删除记录，则具有该设置的所有表都将删除与该用户 ID 关联的记录，可能只留下 User 表中的记录和所有其他信息丢失。

更好的选择是将 SuperUser 表中的 userid 列设置为 User 表中 userid 列的外键，这样您就不会遇到用户不在两个表中或从中删除用户的问题超级用户表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:34:30.760

由于每个用户在用户表中都有一条记录，并且我假设并非每个用户都是超级用户，因此我只会按用户引用它们并在需要时检查他们是否是超级用户。

如果可能的话，最好删除重复的字段。随着事情的发展，这很容易成为一场噩梦。

# asp.net-mvc - 在 WCF 服务内渲染 Razor 视图

> ID：11635716
> 
> 赞同：4
> 
> 时间：2012-07-24T16:57:53.860
> 
> 标签：asp.net-mvc, wcf, soap, razor

这是一项非常奇怪的任务，但我无法更改要求。我们必须编写一个 WCF 服务（SOAP，而不是 REST）并返回一个 HTML 作为响应对象的属性。

我不想使用：

*   硬编码字符串并使用 string.Format() 填充一些值；
*   t4 模板，因为将来没有多少人可以支持这种方法；
*   WebForm 控件，因为我们的大多数开发人员都习惯于使用 MVC 项目。

我已经知道如何将一些 ActionResult 呈现为字符串。所以，理想情况下，我希望能够创建一个控制器，调用一些动作并获得一个 ActionResult。

为此，我创建了 MVC 应用程序并向其中添加了 service.svc 文件。服务工作正常——我可以调用它的方法并接收结果。但是当我尝试渲染 Razor View 时，我的问题就开始了。如果我只是创建任何控制器的实例然后调用一个动作，控制器的属性 ControllerContext 为空，因此无法呈现视图。我尝试即时制作 ControllerContext，但似乎我遗漏了一些东西。

[我在这里](https://stackoverflow.com/questions/7114351/render-an-mvc3-action-to-a-string-from-a-wcf-rest-service-method)发现了非常相似的问题，但是那里提供的解决方案对我不起作用，因为 HttpContext.Current 在 wcf 方法中为 null。

有没有人知道如何实现这一目标？或者也许有人可以建议其他简单灵活的方法在 WCF 方法中呈现 HTML？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T15:45:43.160

您还应该看看 Nancy 框架 ( [http://nancyfx.org](http://nancyfx.org) )，因为他们的 RazorEngine 实现更加轻量级。

我在使用 Nancy 按需生成 HTML 方面取得了相当大的成功——因为它被设计为本质上可测试的，你可以很容易地将它作为模板框架滥用到你自己的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:11:33.820

您将需要在您的应用程序中托管 Razor 引擎。查看这篇文章[Rendering ASP.NET MVC Views to String](http://www.west-wind.com/weblog/posts/2012/May/30/Rendering-ASPNET-MVC-Views-to-String)，尤其是**“Rendering without a ControllerContext”部分**

此外，可以在此答案中找到更多信息[Render a view as a string](https://stackoverflow.com/questions/483091/render-a-view-as-a-string)。（有几个“正确”的答案，不同的上下文）

# css - 将之前的 div 放在“浮动属性”下

> ID：11635717
> 
> 赞同：0
> 
> 时间：2012-07-24T16:58:03.520
> 
> 标签：css, html, css-float

假设我有一个包含三个并排的 div 的部分，主 div（中心）占据 50% 的空间，左侧和右侧占 25%。

现在，我正在使用媒体查询在 kindle 肖像（600 x 1024）上以最佳条件显示网站。

由于它的分辨率较低，为了使网站看起来更好，我想在放置主列时出现，并在她的底部放置之前在旁边的两个。

我能够使用“浮动”属性将主 div 放在左侧，但碰巧另外两个不在主 div 之下。

这甚至可能吗？我正在努力，但我离能够做我假装的事情还很遥远。

html代码：

```
<section id="content">
<div class="main_1">
    <div></div>
</div>
<div class="main_2">
    <div></div>
</div>
<div class="main_3">
    <div></div>
</div> 
```

CSS：

```
 #content{
    border:0;
    padding:15px 5px 15px 55px;
    margin:0;
    min-height:600px;
    border:1px solid;
    overflow:visible;
    box-shadow:3px 0 4px rgba(0, 0, 0, 0.1);
    overflow:hidden;
    left:0px;
    right:0px;
    top:0px;
    z-index:1;
}

.main_1,.main_2,.main_3{
    display:inline;
    float:left;
    margin-left:1%;
    margin-right:1%;
    padding:9px 0;
    min-height:10px;
}

.main_1{width:23.0%;}
.main_2{width:45.0%;}
.main_3{width:22.0%;} 
```

之前的代码用于高分辨率。现在对于kindle（600x1024），我使用以下方法将主div放在右边，但其他的在左边一团糟：

CSS：

```
.main_1,.main_3{
        display:inline;
        float:right;
        margin-left:1%;
        margin-right:1%;
        padding:9px 0;
        min-height:10px;
    }

    #content .main_2{
    float: left;

} 
```

解决了：

我不知道这在代码方面是否是最好的主意，但我复制了左侧的 div 并将其隐藏在 beetwen div 的中心和右侧。

在媒体查询中，我只需要隐藏左侧的 div 并“激活”我隐藏的那个相等但现在位于中心 div 右侧的那个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:28:14.710

如果您总是先设置较宽的内容，然后按顺序设置最后两个，这样会很好，并且这种更改会帮助您并且可能会解决您的问题，因为当您没有足够的空间容纳较小的内容时，它们会掉落在第一个内容框下。你明白吗？

这样做，您可以将较宽的元素浮动到左侧，将其他两个浮动到右侧。只是不要忘记将其他两个元素向右浮动会颠倒它们的顺序，因此您必须稍微处理一下 html。

# android - 原生视频库不显示所有视频

> ID：11635718
> 
> 赞同：1
> 
> 时间：2012-07-24T16:58:14.810
> 
> 标签：android

我的应用程序拍摄了一段视频，然后返回到允许我选择另一个视频或画廊显示视频的屏幕。问题是画廊没有显示我录制的所有视频，只有一个。我确定我会录制视频，因为它们出现在“我的文件”中。

用于显示图库的代码如下：

```
final static int REQUEST_VIDEO_CAPTURED = 1;
    private Uri uriVideo;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.video_list);

        Intent intent = new Intent(Intent.ACTION_GET_CONTENT, null);
        intent.setType("video/*");
        startActivityForResult(intent, 1);

            //I also try this
        // Intent intent = new Intent(Intent.ACTION_PICK,
        // android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
        // intent.setType("video/*");
        // startActivityForResult(intent, 1);

            // and this
        // Intent intent = new Intent();
        // intent.setType("video/*");
        // intent.setAction(Intent.ACTION_GET_CONTENT);
        // startActivityForResult(Intent.createChooser(intent, "Select Video"),
        // 1);

    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (resultCode == RESULT_OK) {
            if (requestCode == REQUEST_VIDEO_CAPTURED) {
                uriVideo = data.getData();
                Toast.makeText(VideoList.this, uriVideo.getPath(), Toast.LENGTH_LONG).show();

                ContentResolver res = getApplicationContext().getContentResolver();
                Cursor cursor = MediaStore.Video.query(res, data.getData(), new String[] { MediaStore.Video.VideoColumns.DURATION });
                if (cursor.moveToFirst()) {
                    duration = cursor.getString(0);
                }

                if (uriVideo != null) {

                }
            }
        } else if (resultCode == RESULT_CANCELED) {
            uriVideo = null;
            finish();
        }
    } 
```

我希望你明白，这是我的第一个问题。

非常感谢你！对不起，我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:04:25.000

您必须请求系统更新媒体库

# mysql - SQL 按列值重新组合成行

> ID：11635719
> 
> 赞同：0
> 
> 时间：2012-07-24T16:58:27.450
> 
> 标签：mysql, sql, row, pivot

我有一个软件可以为我提供看起来像这些的数据。

```
| Date |   Programme    | Groupe | Rat | Actif | RFS | Inactif |  Relevance  |   Etape  | 
|120227| ANS-FR2-85s TO |   5    |  9  |  20   |  5  |   10    | Rats finaux | Training |
|120228| ANS-FR2-85s TO |   5    |  9  |  10   |  3  |    4    | Rats finaux | Training |
|120229| ANS-FR2-85s TO |   5    |  9  |  100  | 20  |   50    | Rats finaux |    ShA   |
|120230| ANS-FR2-85s TO |   5    |  9  |  100  | 20  |   50    |    Exclus   | Training |
|120231| ANS-FR2-85s TO |   5    |  9  |  100  | 20  |   50    | Rats finaux | Training |
|120227| ANS-FR2-85s TO |   5    | 10  |  20   |  5  |   10    | Rats finaux | Training |
|120228| ANS-FR2-85s TO |   5    | 10  |  10   |  3  |    4    | Rats finaux | Training |
|120229| ANS-FR2-85s TO |   5    | 10  |  100  | 20  |   50    | Rats finaux |    ShA   |
|120230| ANS-FR2-85s TO |   5    | 10  |  100  | 20  |   50    |    Exclus   | Training | 
```

我希望能够创建一个**视图**，该视图将**根据“Rat”**值重新组合“RFS”并**应用“Etape”和“Relevance”的标准**

标准

*   WHERE Relevance='Rats finaux'
*   WHERE Etape='培训'

同样重要的是要注意行数是可变的。所以在这个例子中我可以有 2 或 3 行，但也可以有 20 行。我认为也许一个循环可能会很棒，而不是调用每个特定的行。

所以它看起来像这样：

```
| Groupe | Rat | D1  | D2  |  D3  |
|   5    |  9  |  5  |  3  |  20  |
|   5    | 10  |  20 | 10  |      | 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:51:02.287

SO 可用数据变为（在 where 条件之后）：

```
 Date      Programme         Groupe      Rat     Actif   RFS     Inactif      Relevance        Etape  
120227   ANS-FR2-85s TO        5          9       20      5        10        Rats finaux     Training 
120228   ANS-FR2-85s TO        5          9       10      3         4        Rats finaux     Training 
120231   ANS-FR2-85s TO        5          9       100    20        50        Rats finaux     Training 

120227   ANS-FR2-85s TO        5         10       20      5        10        Rats finaux     Training 
120228   ANS-FR2-85s TO        5         10       10      3         4        Rats finaux     Training 
```

我们如何制作 D1、D2、D3 列...？我看到对于第 5 组大鼠 9，您使用 D1、D2、D3 的 RFS 值......但是对于第 5 组大鼠 10，您使用行数据的 Actif 值......？如何以及为什么这样做？最终，您可能需要某种数据透视表（Mysql 没有），可能还需要动态列。我不知道。让我们先尝试了解您的数据需求...

另一个链接： [http ://www.jasny.net/articles/creating-a-cross-tab-in-mysql/](http://www.jasny.net/articles/creating-a-cross-tab-in-mysql/)

那是你想要的吗？我可以提供更多帮助，但我不明白您如何获得作为示例提供的最终结果。

# javascript - 在for循环javascript中创建对象

> ID：11635720
> 
> 赞同：0
> 
> 时间：2012-07-24T16:58:30.023
> 
> 标签：javascript, object, loops, for-loop

我希望你能帮助我解决这个有希望的愚蠢问题。我尝试执行以下操作：

*   用数据创建数组
*   在 for 循环中循环遍历此数组（基于 array.length）
*   根据数组中的数据创建新对象

到目前为止，我得到了以下信息：

*   创建数组
*   遍历数组
*   根据我的构造函数创建一个对象

问题是，数组的长度为 4，因此应该创建 4 个对象，但它只创建一个。如果我删除对象的创建并仅记录“i”它可以工作，但在最初的意图中它在第一个循环之后结束循环如下所示：

```
for(i=0;i<array.length;i++)
        {
        newObj[i]=new ObjectName(array[i].param1,array[i].param2,array[i].param3)
        } 
```

我不知道为什么它在第一次运行后结束，而且在查看 firebug 时也没有显示错误。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:02:06.837

是否改变

`newObj[i] =`

至

`newObj.push(...)`

帮助？

还有 newObj 是如何初始化的？

`newObj = []`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-05T04:36:12.317

```
for (i = 0; i < (stringNums.length); i++) {             
    Dictionary[stringNums[i]] =  stringNums[i].length;
} 
```

# php - PHP随机长度的零字符串？

> ID：11635721
> 
> 赞同：0
> 
> 时间：2012-07-24T16:58:30.303
> 
> 标签：php, string

如何在下面的代码片段的四位数字中的每一位之前插入一个随机的零字符串（长度在 x 和 x+y 之间）？

一个例子是：

$quotes=array("000350.00155.062.00000044");

> ```
> <?php
> 
>  $quotes=array("$random+00350.$random2+0155.$random3+062.$random4+044"); 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:04:56.417

这样的事情会起作用，但是我并不完全理解您的数组声明，并且可能错过了重点。

```
$quotes = array("00350","0155","062","044");

foreach($quotes as $i => $v) {
    $a = rand($x, $x + $y);
    $zeros = "";
    for($j = 0; $j < $a; $j++) $zeros .= "0";
    $quotes[$i] = $zeros . $v;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:02:19.430

我会在均匀分布 [0-1] 上运行伪随机。然后，数字的 ceil 将是我的零个数。

完毕！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:09:14.167

如果您只有 $quotes 变量，我建议您这样做：

->explode $quotes（使用“explode”函数并将“.”作为分隔符）

-> 使用 rand(x, x+y) 获取从 x 到 x+y 的随机整数

-> 使用循环连接各个部分

# javascript - Javascript - 格式化数字以始终显示原始小数位

> ID：11635723
> 
> 赞同：1
> 
> 时间：2012-07-24T16:58:32.547
> 
> 标签：javascript, numbers, format

我需要一个 js 函数来显示数字中的原始小数位数。例如：

```
value          display
2.31             2
1.0              1
2.3500           4 
```

问题是我不知道如何获得小数位数。我有那个代码： value=2.3500; 返回 CountofDecimals(值); // 必须是显示 4：

有什么帮助？？？谢谢：P

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:05:44.747

那是不可能的。`3.5`数字与`3.50`JavaScript 或任何其他常见编程语言之间没有区别。

如果您实际上是说它们是字符串（`value = '2.3500'`而不是`value = 2.3500`），那么您可以使用`indexOf`：

```
var decimalPlaces = value.length - value.indexOf('.') - 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:12:38.533

***警告：我讨厌这个答案，我并不真正提倡它***

不要将其存储为数字，将其存储为字符串。这会很快导致“字符串类型”代码，因此不可取。这是一种解决方法，因为 JavaScript 使用浮点数作为数字类型。

或者将其存储为 Object 并通过函数调用解析出格式：

```
{ value = "1.2345", decimal = 4} 
```

并使用它来创建正确的数字格式。如果我有要求，这可能是我会使用的 hack。或者，我会让我的服务器返回格式化的字符串，因为您可以轻松地将其从服务器端拉出来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:16:24.347

如果可以将这些数字作为字符串，那绝对是可能的……而且实际上很简单。

```
function countDecimals(string){
   var delimiters = [",","."];
   for(var i = 0; i<delimiters.length; i++){

        if(string.indexOf(delimiters[i])==-1) continue;
        else{
        return string.substring(string.indexOf(delimiters[i])+1).length;
    }
 }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T17:57:12.500

你可以使用这个功能：

```
function decimalplaces(number)
{
    numberastring = number.toString(10);
    decimalpoint = numberastring.indexOf(".");

    if(decimalpoint == -1)
    {
       return 0;
    }
    else
    {
        return numberastring.length - decimalpoint - 1;
    }
} 
```

# php - 集成电子邮件验证

> ID：11635725
> 
> 赞同：0
> 
> 时间：2012-07-24T16:58:37.197
> 
> 标签：php, forms, validation, email, spam

有人可以帮我证明这个 PHP 脚本的垃圾邮件吗？另外，当我使用这个脚本时，我会收到两封电子邮件，一封是空的，另一封是结果。

```
<?php 
    $to = "voodoocastde@gmail.com"; 
    $subject = "Registrierung auf voodooCAST.de";
    $headers = "From: Form Mailer";
    $forward = 0;
    $location = "";

    $date = date ("l, F jS, Y"); 
    $time = date ("h:i A"); 

    $msg = "Below is the result of your feedback form. It was submitted on $date at $time.\n\n"; 

    if ($_SERVER['REQUEST_METHOD'] == "POST") {
        foreach ($_POST as $key => $value) { 
            $msg .= ucfirst ($key) ." : ". $value . "\n"; 
        }
    }
    else {
        foreach ($_GET as $key => $value) { 
        $msg .= ucfirst ($key) ." : ". $value . "\n"; 
        }
    }

    mail($to, $subject, $msg, $headers); 
    if ($forward == 1) { 
        header ("Location:$location"); 
    } 
    else { 
        header( 'Location: http://www.voodoocast.de/confirm.php' ) ;     
    } 

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:13:53.377

在您的 html 表单中，您可以使用`<input type="email"></input>`它，它会自我验证

# python - 忽略测试结果的标准错误输出

> ID：11635728
> 
> 赞同：0
> 
> 时间：2012-07-24T16:58:45.793
> 
> 标签：python, jenkins, jython, nose

我正在尝试使用`nose`. 在我写的其中一个测试期间`stderr`，这会导致测试被报告为中断`Jenkins`（我开始使用`nose`并生成 Junit`.xml`输出以确定成功）是否可以输入`stderr`或检查某些值？

所以我的测试看起来大致是这样的：

```
def testFunc() {
    f1()
    f2() } 
```

并且由于我从内部写入 stderr 而失败，我可以告诉鼻子忽略这个还是测试遗漏了什么（我希望它只有在生成异常时才会失败）

**编辑**：错误输出导致失败的假设是错误的。在调试输出的 100 行之间是一个例外。（出于某种原因，詹金斯首先显示了未格式化的（无换行符）输出，然后是异常跟踪，之后再次输出，带有换行符。我只是忽略了异常）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:16:09.313

如果您不想看到标准错误，可以使用`logging` [tutorial](http://docs.python.org/howto/logging.html#logging-basic-tutorial)。

例子：

```
import logging
logging.basicConfig(level=logging.ERROR)
# instead of sys.stderr.write():
logging.warning("This is a warning!") 
```

在这种情况下，警告低于日志记录级别阈值，因此不会打印到 stderr。如果您想查看错误但不一定是实时的，您可以指定一个日志文件（使用 logging.basicConfig 的文件名参数）。

# mysql - SELECT ORDER BY FIELD 即使它不存在

> ID：11635729
> 
> 赞同：0
> 
> 时间：2012-07-24T16:58:49.337
> 
> 标签：mysql

```
SELECT *
                    FROM  products2tecspecs as p2t, products_tecspecs as pt 
                    WHERE p2t.fk_product_id = '%s' AND pt.pts_id = fk_tecspec_id AND pt.pts_id 
                    IN (5275, 21, 5276, 5277, 5278,  49, 5279)
                    ORDER BY FIELD(pts_id, 5275, 21, 5276, 5277, 5278,  49, 5279) 
```

我有这个选择，我可以在其中找到特定的 ID 并按照我想要的顺序将其带入。但我对这种关系有疑问。我在 foreach 函数中使用它，我需要 7 个循环。问题不是空值，问题是它只带来了相关的产品。当然这不是问题，感谢上帝，它发生了，但在我的情况下，如果它只有 2 个，它就会破坏布局。

有没有办法可以做类似的事情：如果找不到字段，请将其放置到位？

如果我创建关系，它可以工作，但我需要用 700 个产品来做......

我找到[了这个](https://stackoverflow.com/questions/1174850/mysql-view-check-if-data-is-null)，但它似乎不是一个 NULL 问题......

我也尝试使用 LEFT JOIN 但正如我所说，如果关系不存在，它不能带来 NULL ...

我瞎了

* * *

我找到了这个`SELECT pts_name FROM ( SELECT pts_name, CASE pts_id WHEN 5275 THEN 1 WHEN 21 THEN 2 WHEN 5276 THEN 3 WHEN 5277 THEN 4 WHEN 5278 THEN 5 WHEN 49 THEN 6 WHEN 5279 THEN 7 END AS sort_order FROM products_tecspecs WHERE pts_id IN ( 5275, 21, 5276, 5277, 5278, 49, 5279 ) )a ORDER BY a.sort_order ASC`。它带来了我想要的选择，但仍然找不到实现我的目标的方法......

* * *

加入
`SELECT * FROM products2tecspecs AS p2t LEFT JOIN products_tecspecs AS pt ON ( p2t.fk_tecspec_id = pt.pts_id ) WHERE p2t.fk_product_id =34 AND pt.pts_id IN ( 5275, 21, 5276, 5277, 5278, 49, 5279 ) OR p2t.p2t_value IS NULL ORDER BY FIELD( pts_id, 5275, 21, 5276, 5277, 5278, 49, 5279 ) LIMIT 40`

* * *

但没有用。它带来了超出`IN`所选领域的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:42:57.023

您能否简单地在 WHERE 子句中添加这些选项之一（使用 LEFT JOIN 解决方案）：

```
 OR pt.pts_id IS NULL
    OR fk_tecspec_id IS NULL 
```

?

# c# - 我们可以像调整窗口大小一样调整 Datagridview 的大小吗？

> ID：11635737
> 
> 赞同：1
> 
> 时间：2012-07-24T16:59:23.330
> 
> 标签：c#, winforms, datagridview

我想让用户能够像调整窗口大小一样调整 datagridview 的大小。我的意思是，当鼠标越过窗口边缘时，它会变为两侧箭头，您可以调整窗口大小。在 winforms 中是否可以这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T04:59:31.417

尽管我完全同意 Tergiver 的观点，即这样的设计几乎总是应该被拒绝，但我记得很久以前当要求在表单上显示一些图像并且用户出于某种原因想要调整图片框的大小时，我就创建了类似的东西。因此，如果它绝对必要或学术你可以尝试这样的事情：

将网格添加到面板 将图片框添加到面板，现在将网格停靠为填充，以便它占用所有面板空间并且图片框浮动在 DataGridView 上方，您可能需要更改图片框的 z-index 以防万一它低于网格。将图片框的 Anchor 属性从 Top,Left 更改为 Bottom,Right 在网格的右下角完美对齐，使图片框尽可能小，以免遮挡网格中的任何单元格。向图片框添加一个抓手图像，该图片将用于拖动整个内容并将图片框的光标设置为 SizeNWSE。很好地混合图片框的背景色和抓手图像，使其看起来是网格的一部分。现在像这样处理图片框的鼠标移动事件：

```
 private void pictureBox1_MouseMove(object sender, MouseEventArgs e)
    {
        if (e.Button == System.Windows.Forms.MouseButtons.Left)
        {
            this.panel1.Height = pictureBox1.Top + e.Y; 
            this.panel1.Width = pictureBox1.Left + e.X;
        }
    } 
```

Panel1 是我们停靠 Grid 的面板，而 picturebox1 是网格上的图片框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:04:20.550

虽然可能，但这样做没有意义。相反，您应该锚定/停靠 DGV，以便用户可以调整整个表单的大小，并且 DGV 也会效仿。

在这里您可以找到有关如何在 WinForms 中布局控件的信息。[http://msdn.microsoft.com/en-us/library/ms951306.aspx](http://msdn.microsoft.com/en-us/library/ms951306.aspx)

# javascript - 如何使用 RequireJS 优化器删除评论？

> ID：11635739
> 
> 赞同：19
> 
> 时间：2012-07-24T16:59:24.907
> 
> 标签：javascript, optimization, requirejs, js-amd, uglifyjs

我正在尝试从优化的脚本文件中删除版权注释。我们将 RequireJS 与默认的 UglifierJS 一起使用。我查看了 Uglifier，它本身有一个名为`-nc`or的标志`--no-comments`，但 RequireJS 似乎不允许您在构建配置文件中设置该选项。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-25T02:44:50.290

您可以将以下行添加到用于 r.js 的 build.js 文件中

```
preserveLicenseComments: false, 
```

这是完整的文档：[https ://github.com/jrburke/r.js/blob/master/build/example.build.js#L519](https://github.com/jrburke/r.js/blob/master/build/example.build.js#L519)

# android - 应用名称是 Eclipse MainActivity？

> ID：11635749
> 
> 赞同：1
> 
> 时间：2012-07-24T16:59:46.013
> 
> 标签：android, eclipse, android-layout, android-emulator, android-activity

我已经完成了一个小费计算器应用程序，但是当我运行它时，它的名称是`MainActivity`，我不知道如何更改它，我尝试过编辑`strings.xml`但是当我运行该应用程序时出现错误，我不知道还能尝试什么，关于我可以做些什么来改变它以便它出现在模拟器上的任何建议

在字符串.xml...

名称：`title_activity_main` 值：`MainActivity`

这也是我的java代码我必须在这里改变什么吗？

```
package tip.calculator;

import android.os.Bundle;
import android.app.Activity;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.TextView;
import android.view.View;
import android.widget.Button;
import java.text.DecimalFormat;

public class TipCalculator extends Activity 
{
private EditText myEditField;
private EditText myEditField2;
private Button enter;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    myEditField2 = (EditText) findViewById(R.id.billText);
    myEditField = (EditText) findViewById(R.id.percentText);
    enter = (Button)findViewById(R.id.button1);

    enter.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            TextView textView;

            textView = (TextView) findViewById(R.id.textView1);

            final EditText myEditField = (EditText) findViewById(R.id.percentText);
            final EditText myEditField2 = (EditText) findViewById(R.id.billText);

            float percentage;
            float percentageInp;
            float billAmount;
            double output; 
            String output1;

            percentageInp = Float.parseFloat(myEditField.getText().toString());
            billAmount = Float.parseFloat(myEditField2.getText().toString());

            percentage = ((float)percentageInp /100);

            output = (double)(billAmount * percentage);

            double result = output * 100;
            result = Math.round(result);
            result = result / 100;

            output1 = Double.toString(result);

            textView.setText(output1);

        }
    });
}
} 
```

清单.xml ...

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="tip.calculator"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="13"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" android:debuggable="true">
        <activity
            android:name=".TipCalculator"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

这是我的strings.xml

```
<resources>

    <string name="app_name">Tip Calculator</string>
    <string name="hello_world">Hello world!</string>
    <string name="menu_settings">Settings</string>
    <string name="title_activity_main">MainActivity</string>

</resources> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T04:34:56.303

更改标签

> android:label="小费计算器"

或更改您的 strings.xml

```
<string name="app_name">Tip Calculator</string>
<string name="hello_world">Hello world!</string>
<string name="menu_settings">Settings</string>
<string name="title_activity_main">Tip Calculator</string> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-05T08:03:31.833

这是因为 android 不允许 app_name 和 main Activity 名称使用两个不同的标签。但如果您想同时使用两个不同的标签，您可以按以下方式完成；

应用程序菜单上显示的应用程序名称

```
<application> android:lable = "@string/app_name" </application> 
```

以及启动活动时的不同标签；

在主要活动的 onCreate() 方法中放置；

```
this.setTitle("Your Title for the Activity"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T12:37:29.403

有时这只是eclipse中的一个错误，关闭eclipse然后清理你的项目，它应该没问题

# iphone - 强制如何运作？

> ID：11635751
> 
> 赞同：1
> 
> 时间：2012-07-24T16:59:55.200
> 
> 标签：iphone, ios, coercion

我刚刚创建了一个普通的 MyClass 并定义了一个实例变量

```
@interface MyMFMessageComposeViewController : NSObject
{
    NSString *body;
    NSArray * recipients; 
}

@property (readwrite, strong) NSString *body;
@property (readwrite, strong) NSArray * recipients; 
@end 
```

然后我核心到`MFMessageComposeViewController`.

它起作用了——令人惊讶的是——由于某种原因，类变量被正确地转移了。

**这是如何运作的？运行时是否真的搜索类变量 NAMES 来找到合适的类变量？**

我认为强制只是记忆的叠加。

非常感谢您的洞察力？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:14:08.310

Objective-C 是弱类型的（有些人甚至说它是无类型的），这意味着对象的确切类型并不重要，只要它响应程序尝试发送的所有选择器（方法名称）即可。

MyMFMessageComposeViewController 和 MFMessageComposeViewController 都有名为`body`, `setBody`,的方法`recipients`，`setRecipients`因为这两个类都声明并合成了名为 body 和 recipients 的属性。（请记住，合成属性只会创建这些访问器方法。）如果您从外部对象访问成员变量，那么您就是在使用这些方法，**即使您使用点符号来执行它**。

简而言之，您不是直接访问实例变量；而是直接访问实例变量。相反，您使用的是访问器方法，并且因为 Objective-C 在调用方法时不关心对象的类型，所以一切正常。

话虽如此，您应该删除此类并将其替换为适当的子类，此时您（可能）不必担心类型转换。

# jquery - 模态元素被剪裁的Highcharts

> ID：11635752
> 
> 赞同：0
> 
> 时间：2012-07-24T17:00:05.700
> 
> 标签：jquery, iframe, modal-dialog, highcharts

我们有一个生成报告的 Java servlet。现在我们包含了一个选项来生成一个包含 N 个 highcharts 图表的 highcharts 图。该图应该在模态元素（灯箱，iframe，没关系）上打开。我使用了fancybox并在iframe中显示了图表加载，但是高度和宽度都搞砸了。

似乎浏览器/花式框正在/正在计算图表元素的大小，然后再渲染 highcharts，并显示小尺寸的 iframe。

我并不一定要使用 iframe，尽管该图是从 servlet URL 调用的，并且不可能事先知道它的大小。

如果是这样，我可以使用另一个 jquery 库。

使用fancybox 2.0.5、jquery 1.7.2、highcharts 2.2.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T15:50:04.850

我解决了这个问题，将 highcharts HTML 容器从浮动 div 更改为表格结构，并将 fancybox 模式从 iframe 更改为 ajax。

这样，fancybox 可以读取正确的大小。

Fancybox 是唯一一个能够从链接正确触发的 jquery 插件（我也测试了 jqmodal 和 simplemodal）。在页面加载之后，链接由页面上的 ajax 调用动态加载。

这是 $(document).ready( 调用上的代码

```
$("a.modalLightbox").fancybox({
type : 'ajax'
autoSize : true,
padding : 5,
fitToView : true,
}); 
```

表格的宽度是通过内联 CSS 设置的（不是最好的，但必须内联完成，因为每个图表都有自己的宽度，由 servlet 计算）。

全浮点方法将 iframe 的 body 元素保留为 0 高度和继承的宽度。

# php - PHP 动态包含内容方法

> ID：11635753
> 
> 赞同：1
> 
> 时间：2012-07-24T17:00:17.773
> 
> 标签：php, dynamic, include

我想在每个页面上都有相同的页眉和页脚，只有使用 PHP 的不同内容。做到这一点的最佳方法是什么？

我知道这两个流行的，但不知道选择哪一个（或者可能是其他一些）：

## 1\. 在每一页上包含页眉和页脚

在每个页面中，如*contact.php*、*about.php*等，您必须在页面顶部包含页眉，在底部包含页脚。然后内容也介于两者之间。例如*contact.php*看起来像这样：

```
<?php include("header.php"); ?>
Lorem ipsum dolor sit amet...
<?php include("footer.php"); ?> 
```

当你想做请求时，你只需输入`example.com/contact.php`

## 2\. index.php?page=xyz

在*contact.php*、*about.php*等页面中，您只存储实际内容。然后你有*index.php*和一些参数（例如页面），你可以通过它指定要包含的内容。例如，*contact.php*文件如下所示：

```
Lorem ipsum dolor sit amet... 
```

像这样的*index.php*文件（这是简化版）：

```
<html>
    <head>
        <title>Lorem ipsum</title>
    </head>
    <body>
        <?php include(some_parser_function($_GET["page"].".php")); ?>
    </body>
</html> 
```

现在，当您请求它时，`index.php?page=contact`它会显示*index.php*以及在开始和结束`body`标记之间来自*contact.php*的内容。

第一种方法在我看来有点不切实际，因为您必须将包含函数写入每个页面。在第二种方法中，如果你想拥有像`example.com/contact.php`或只是这样的好 URL `example.com/contact`，你需要做 apache mod_rewriting...

**这些（和其他）方法中的哪一种更好/更受欢迎，为什么？**

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:19:02.427

如果可能的话，我会避免动态包含。它会打开一个安全漏洞，除非您清理来自外部源的变量，即您的案例中的 GET 参数。您可以采用像 Model-View-Controller 框架那样的方法。他们的代码基本上将模板的输出放入布局中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:16:54.037

选项 2 更适合模板化。您还可以使用 Rewrite 使其在 url 末尾没有 ?page=pagename 的情况下显示。此外，根据您网站上有多少页面，必须在每个文件中都包含这两个内容是一种痛苦。

但是，如果我是你，我会考虑使用 ob_start() ob_get_contents() 和 ob_flush()。然后，您可以在开始输出 html 之前实际运行包含文件上的所有代码。

这是一个例子：

```
ob_start();
include("{$page_name}.php");
$page_contents = ob_get_contents();
ob_end_clean();

ob_start();
include("templates/standard.php");
$full_html = ob_get_contents();
ob_end_clean();

echo $full_html; 
```

通过这种方式，您可以轻松创建多个模板以随时使用。模板文件如下所示：

```
<html>
    <head>
        <title>Lorem ipsum</title>
    </head>
    <body>
        <?php echo $page_contents; ?>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:16:27.987

一般来说，2 方法的最大优点是验证/插入。如果您采用第一种方法，您将不得不一次又一次地进行所有验证/插入。而且，如果您必须更改/添加/删除某些内容，则必须更改所有页面。这很烦人。我通常更喜欢第二种方法，因为您可以集中所有内容并避免重复相同的指令。

但这也很大程度上取决于您的网站。

我给你举个例子：我曾经做过一个有 2 个主要部门的网站。

在这种情况下，我做了第二种方法的 2 个不同页面。

（当我谈论验证时，我的意思是验证所有 SESSION 变量、用户是否已登录、他是否是 ADM 等）

# jquery - js/ajax POST 不提交

> ID：11635754
> 
> 赞同：-2
> 
> 时间：2012-07-24T17:00:18.070
> 
> 标签：jquery, ajax, jquery-mobile

我想以此作为开头，“我是个菜鸟，所以请像我五岁一样解释。” 我已经查看了这个常见问题的很多答案，但我无法为我的特定问题找到合适的答案。下面是有问题的脚本位。当前，用户输入订单号。这通过 ajax 调用发送到 php 处理器脚本。处理器脚本验证订单号，然后发回数据。如果 data !="NO" 我们被发送到一个新页面。

```
<script type="text/javascript">
function resetTextFields()
{
    $("#orderNum").val("");                
}

function onSuccess(data, status)
{
    resetTextFields();
    // Notify the user the new post was saved
    $("#message").fadeIn(2000);
    data = $.trim(data);
    if(data != "NO")
    {
        location.href="labOrders.php";
    }
    else
    {
        $("#message").css("background-color", "#ff0000");
        $("#message").text("Not a valid order number...");
    }
    $("#message").fadeOut(2500);
}

$(document).ready(function() {
    $("#submitSearch").click(function(e){

        var formData = $("#labOrderFind").serialize();

        $.ajax({
            type: "POST",
            url: "labSearch.php",
            cache: false,
            data: formData,
            success: onSuccess
        });

        e.preventDefault();
    });

}); 
```

我想做的是 onSuccess 如果数据！=“否”，再次将 formData 发布到 labOrders.php，以便 labOrders.php 可以使用它对数据库进行更多查找。我尝试了很多方法，但我没有成功。我会以错误的方式解决这个问题吗？只要我们可以使用 POST，我对所有解决方案都持开放态度。

额外信息：jquery 和 jquery.mobile 加载在头部（它是一个平板应用程序）。

也许stackoverflow需要一个noob标签来解决这样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:35:14.997

改变

```
location.href="labOrders.php"; 
```

至

```
$("#labOrderFind").submit(); 
```

“labOrderFind”的“action”必须是“labOrders.php”，如果你要使用labOrders.php中的订单号，不要重置它的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T14:48:47.793

我解决了我自己的问题。以下是我的解决方案，以防其他人将来遇到此类问题。

我找到了这个功能。

```
function post(URL, PARAMS) {
    var temp=document.createElement("form");
    temp.action=URL;
    temp.method="POST";
    temp.style.display="none";
    for(var x in PARAMS) {
        var opt=document.createElement("textarea");
        opt.name=x;
        opt.value=PARAMS[x];
        temp.appendChild(opt);
    }
    document.body.appendChild(temp);
    temp.submit();
    return temp; 
```

}

然后我稍微修改了我的 onSuccess 函数：

```
 function onSuccess(data, status)
{
    data = $.trim(data);
    if(data != "NO")
    {
                    post("labOrders.php", {
                        orderNum:data
                    })
    }
    else
    {
            resetTextFields();
        $("#message").css("background-color", "#ff0000");
        $("#message").text("Not a valid order number...");
    }
    $("#message").fadeOut(2500);
} 
```

# php - PHP 谷歌 YouTube API 身份验证

> ID：11635763
> 
> 赞同：0
> 
> 时间：2012-07-24T17:00:50.163
> 
> 标签：php, authentication, oauth, youtube, google-api

我正在使用谷歌数据 PHP API。我关注[https://developers.google.com/youtube/2.0/developers_guide_php#AuthSub_for_Web_Applications](https://developers.google.com/youtube/2.0/developers_guide_php#AuthSub_for_Web_Applications)，希望我保留刷新令牌，并发送请求以获取访问令牌。刷新令牌适用于拥有视频的用户（我已使用 Java 完成此操作）。但最后我仍然无法通过身份验证。这里有什么问题？代码如下。

```
$refreshToken = '1/wY9.......';
$postString = 'client_id=' . $_SESSION['clientId'] .
        '&client_secret=' . $_SESSION['clientSecret'] . 
        '&refresh_token=' . $refreshToken .
        '&grant_type=refresh_token';

$ch = curl_init($_SESSION['oauth2Url']);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $postString);
$result = curl_exec($ch);
curl_close($ch);

$json = json_decode($result);
$accessToken = $json->access_token;

$httpClient = Zend_Gdata_AuthSub::getHttpClient($accessToken);

$yt = new Zend_Gdata_YouTube($httpClient, null, $_SESSION['clientId'], $_SESSION['developerKey']);
$yt->setMajorProtocolVersion(2);

$youtubeId = 'xxxxxxxxxxx';

$videoEntry = $yt->getVideoEntry($youtubeId);
if ($videoEntry->getEditLink() !== null) {
    echo 'can edit!';
} else {
    echo 'cannot edit!';
} 
```

*** 更新 ***

正如其他人建议的那样，我尝试`var_dump($httpClient)`了，并得到以下信息：

```
object(Zend_Gdata_HttpClient)#1 (23) { 
  ["_authSubPrivateKeyId":"Zend_Gdata_HttpClient":private]=> NULL 
  ["_authSubToken":"Zend_Gdata_HttpClient":private]=> string(61) "yaXXXXX"
  ["_clientLoginToken":"Zend_Gdata_HttpClient":private]=> NULL
  ["_clientLoginKey":"Zend_Gdata_HttpClient":private]=> NULL 
  ["_streamingRequest":protected]=> NULL 
  ["config":protected]=> array(12) { 
    ["maxredirects"]=> int(5) 
    ["strictredirects"]=> bool(true) 
    ["useragent"]=> string(28) "Zend_Framework_Gdata/1.11.12" 
    ["timeout"]=> int(10) 
    ["adapter"]=> string(31) "Zend_Http_Client_Adapter_Socket" 
    ["httpversion"]=> string(3) "1.1" 
    ["keepalive"]=> bool(false) 
    ["storeresponse"]=> bool(true) 
    ["strict"]=> bool(true) 
    ["output_stream"]=> bool(false) 
    ["encodecookies"]=> bool(true) 
    ["rfc3986_strict"]=> bool(false) 
  } 
  ["adapter":protected]=> NULL 
  ["uri":protected]=> NULL 
  ["headers":protected]=> array(0) { } 
  ["method":protected]=> string(3) "GET" 
  ["paramsGet":protected]=> array(0) { } 
  ["paramsPost":protected]=> array(0) { } 
  ["enctype":protected]=> NULL 
  ["raw_post_data":protected]=> NULL 
  ["auth":protected]=> NULL 
  ["files":protected]=> array(0) { } 
  ["body_field_order":protected]=> array(0) { } 
  ["cookiejar":protected]=> NULL 
  ["last_request":protected]=> NULL 
  ["last_response":protected]=> NULL 
  ["redirectCounter":protected]=> int(0) 
  ["_unmaskStatus":protected]=> bool(false) 
  ["_queryBracketsEscaped":protected]=> bool(true)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:54:56.737

终于，我知道发生了什么。

认证实际上已经完成。但不要用于`$videoEntry->getEditLink()`测试服务是否经过身份验证。Zend PHP 库已经很老了。也许新的数据结构没有编辑链接。

# iphone - ImageView 的 Alpha 值在 Interface Builder 中不断变化

> ID：11635764
> 
> 赞同：0
> 
> 时间：2012-07-24T17:00:51.847
> 
> 标签：iphone, uiimageview, alpha-transparency

我将 IB 中的 alpha 值设置为 imageView os 的 0.1，它略微透明。但出于某种原因，IB 不断将该值更改为 0.100000001490116。知道为什么吗？我当然可以通过编程将其设置为 0.1 以确保它具有我想要的值。但是仍然很高兴理解为什么 IB 会应用该更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:25:37.423

该数字不能由浮点格式精确定义。在代码中试试这个：

```
CGFloat foo = 0.1f;
NSLog(@"foo = %.12f", foo); 
```

结果是“foo = 0.100000001490”，正是你得到的。

# java - 从 Java 生成 iMovie 编辑决策列表？

> ID：11635766
> 
> 赞同：1
> 
> 时间：2012-07-24T17:00:56.983
> 
> 标签：java, macos, video, video-editing

是否有任何已知的方法可以从 iMovie 外部生成 iMovie 项目（或更具体地说，编辑决策列表 - 一系列视频文件和输入/输出点）？我想在外部创建这个列表，并以某种方式将其导入当前一代的 iMovie。iMovie 文件格式似乎是一个 Apple Binary PList，但它没有在任何地方记录（我相信逆向工程违反了使用条款）。

有什么想法吗？

或者，谁能推荐一个类似的低成本/对消费者友好的编辑应用程序，它可以在 OS X 上运行，并且支持 EDL 导入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:08:38.250

AFAIK，我不认为 iMovie 是为批量编辑文件而设计或设计的。我相信这就是你所追求的？

我自己有 iMovie，但我没有在 iDevices 上进行任何应用程序开发。最好的办法是通过另一个应用程序以某种方式触发 UI 元素，然后编写触发脚本。但我什至不确定这是否可能，也许 iphone 上的一些应用程序开发人员可以在这里帮助你..

# java - 运行从 izpack 创建的 install.jar 没有给我这样的方法异常

> ID：11635767
> 
> 赞同：0
> 
> 时间：2012-07-24T17:01:06.373
> 
> 标签：java, izpack

使用 Izpack 5.0.0-beta10 和 compiler.bat 构建了 install.jar

当我尝试使用 java -jar install.jar 运行它时，我得到了

```
Exception in thread "AWT-EventQueue-0" java.lang.NoSuchMethodError: com.izforge.izpack.util.file.FileUtils.close(Ljava/io/Closeable;)V
        at com.izforge.izpack.installer.container.impl.EventFiller.readObject(EventFiller.java:154)
        at com.izforge.izpack.installer.container.impl.EventFiller.loadCustomData(EventFiller.java:62)
        at com.izforge.izpack.installer.container.impl.InstallerContainer.fillContainer(InstallerContainer.java:98)
        at com.izforge.izpack.core.container.AbstractContainer.initBindings(AbstractContainer.java:25)
        at com.izforge.izpack.installer.bootstrap.InstallerGui$1.run(InstallerGui.java:47)
        at java.awt.event.InvocationEvent.dispatch(Unknown Source)
        at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
        at java.awt.EventQueue.access$000(Unknown Source)
        at java.awt.EventQueue$3.run(Unknown Source)
        at java.awt.EventQueue$3.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
        at java.awt.EventQueue.dispatchEvent(Unknown Source)
        at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.run(Unknown Source) 
```

这在 Windows 上我将 JAVA_HOME 设置为 Java 7 jdk，从命令提示符键入 java -version 也会给我 Java 7

我可以使用 Izpack 4.3.5 构建和运行相同的 install.xml 没问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:47:16.497

您可能依赖于与安装程序不同的 izpack-util 版本。

无论如何，您运行的是 5.0 的旧版本。我建议从[存储库下载最新的快照](https://nexus.codehaus.org/content/repositories/snapshots/org/codehaus/izpack/izpack-dist/5.0.0-beta11-SNAPSHOT/)

# asp.net-mvc - 如何在 ORCHARD 的查询结果中添加 OrderBy

> ID：11635768
> 
> 赞同：0
> 
> 时间：2012-07-24T17:01:15.170
> 
> 标签：asp.net-mvc, orchardcms

如何`OrderBy(a=>a.SortField)`通过“SortField”对以下查询结果进行添加或排序

```
var slideShowProducts = _contentManager.Query<JewelleryProductPart, JewelleryProductPartRecord>("JewelleryProduct")
                .Join<CustomPropertiesPartRecord>()
                .Where(cpp => cpp.CustomOne == catViewModel.Number)
                .Join<BodyPartRecord>()
                    .List()                                               
                    .Select(sp => new SlideShowProductViewModel
                    {

                        Count = sp.Count,
                        CategoryName = sp.Fields.Single(f => f.PartFieldDefinition.Name == "Category").Storage.Get<string>(""),
                        SortField = sp.Fields.Single(f => f.PartFieldDefinition.Name == "Sort Field").Storage.Get<string>(""),
                        Description = sp.Get<BodyPart>().Text
                    }).ToList();

                SlideShowProductsViewModel products = new SlideShowProductsViewModel();
                products.Number = catViewModel.Number;
                products.CategoryName = catViewModel.Name;
                products.SlideShowProducts = slideShowProducts;                  

                productList.Add(products); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T21:14:04.503

您是否尝试过以下操作？

```
products.SlideShowProducts =slideShowProducts.OrderBy(a=>a.SortField).ToList(); 
```

# php - 如何限制 SHOW TABLES 查询

> ID：11635769
> 
> 赞同：14
> 
> 时间：2012-07-24T17:01:22.127
> 
> 标签：php, mysql, pagination, information-schema

我有以下查询：

```
SHOW TABLES LIKE '$prefix%' 
```

它完全按照我想要的方式工作，尽管我需要对结果进行分页。我试过了：

```
SHOW TABLES LIKE '$prefix%' ORDER BY Comment ASC LIMIT 0, 6 
```

我需要它来返回所有带有特定前缀的表，并按它们的注释对它们进行排序。我想通过 LIMIT 进行分页，每页有 6 个结果。

我显然做错了什么。如何实现？

编辑：我确实看过[这个](https://stackoverflow.com/questions/9782948/how-to-apply-pagination-to-the-result-of-show-tables-query-in-php)。它对我不起作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T17:04:27.040

以上不能直接通过 MySQL Syntax 完成。MySQL 不支持`LIMIT`某些`SHOW`语句上的子句。这是其中之一。[MySQL 参考文档。](http://dev.mysql.com/doc/refman/5.0/en/show-tables.html)

如果您的 MySQL 用户有权访问`INFORMATION_SCHEMA`数据库，则以下内容将起作用。

```
SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'DATABASE_TO SEARCH_HERE' AND TABLE_NAME LIKE "table_here%"  LIMIT 0,5; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:08:06.053

只需通过标准查询而不是使用 SHOW TABLES 进行选择。例如

```
select table_name from information_schema.tables 
```

然后你可以使用诸如 ASC 和 LIMIT 之类的东西......

# performance - 带有 if 条件的 for 循环向量化变慢

> ID：11635772
> 
> 赞同：0
> 
> 时间：2012-07-24T17:01:41.537
> 
> 标签：performance, matlab, optimization, for-loop, vectorization

我有一个 for 循环，我正在对其进行矢量化处理。问题是，一旦矢量化，代码会慢 3 倍。原始代码是热力学算法的一部分，是：

```
Matrix=rand(10,10,20);
someMatrix=rand(50);
m=5; n=6; CONSTj=9; CONSTk=10; maxGrid=5;
Total=0;

for var=0:maxGrid
    Factor=1;
    p=CONSTj-var;
    q=CONSTk-var;

    if p>=1 && q>=1
        Factor=Matrix(n,m,p)*Matrix(m,n,q);
    elseif p>=1 && q<1
        Factor=Matrix(n,m,p);
    elseif p<1 && q>=1
        Factor=Matrix(m,n,q);
    end

    Total=Total+Factor*(someMatrix(m)^var);
end 
```

我将其矢量化为：

```
Matrix=rand(10,10,20);
someMatrix=rand(50);
m=5; n=6; CONSTj=9; CONSTk=10; maxGrid=5;

var=(0:maxGrid)';
Factor=ones(maxGrid+1,1);
tempoJ=zeros(maxGrid+1,1);
tempoK=zeros(maxGrid+1,1);
p=CONSTj-var;
q=CONSTk-var;

index1 = find(p>=1 & q>=1);
index2 = find(p>=1 & q<1 );
index3 = find(p<1  & q>=1);

tempoJ(index1)=squeeze(Matrix(n,m,p(index1)));
tempoJ(index2)=squeeze(Matrix(n,m,p(index2)));
tempoK(index1)=squeeze(Matrix(m,n,q(index1)));
tempoK(index3)=squeeze(Matrix(m,n,q(index3)));

Factor(index1)=tempoJ(index1).*tempoK(index1);
Factor(index2)=tempoJ(index2);
Factor(index3)=tempoK(index3);

Total=Factor.*(someMatrix(m).^var);
Total=sum(Total); 
```

探查器说*找到*，*squeeze*和*sum*是最耗时的函数。我相信可以做一些事情来从 if 语句中获取信息，但是如果不更改索引，我找不到更简单的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:39:04.850

好的，这不是答案，但评论中没有足够的空间让我全部输入。

这是我使用的测试代码。基于OP提供的内容。请注意，我将 提高到 15，因此和`maxGrid`中会有一些负值。我还增加了其他矩阵的大小。我也删除了和函数调用。`p``q``find``squeeze`

结果输出是这样的：

```
Elapsed time is 0.078117 seconds.
Elapsed time is 0.096412 seconds. 
```

最终，这表明代码的第一个版本运行得更快。

```
tic
Matrix=rand(100,100,200); 
someMatrix=rand(500); 
m=5; n=6; CONSTj=9; CONSTk=10; maxGrid=15; 
Total=0; 

for var=0:maxGrid 
    Factor=1; 
    p=CONSTj-var; 
    q=CONSTk-var; 

    if p>=1 && q>=1 
        Factor=Matrix(n,m,p)*Matrix(m,n,q); 
    elseif p>=1 && q<1 
        Factor=Matrix(n,m,p); 
    elseif p<1 && q>=1 
        Factor=Matrix(m,n,q); 
    end 

    Total=Total+Factor*(someMatrix(m)^var); 
end 
toc

tic
Matrix=rand(100,100,200); 
someMatrix=rand(500); 
m=5; n=6; CONSTj=9; CONSTk=10; maxGrid=15; 

var=(0:maxGrid)'; 
Factor=ones(maxGrid+1,1); 
tempoJ=zeros(maxGrid+1,1); 
tempoK=zeros(maxGrid+1,1); 
p=CONSTj-var; 
q=CONSTk-var; 

% index1 = find(p>=1 & q>=1); 
index1 = ((p>=1) & (q>=1));
% index2 = find(p>=1 & q<1 ); 
index2 = ((p>=1)&(q<1));
% index3 = find(p<1  & q>=1); 
index3 = ((p<1)&(q>=1));

tempoJ(index1)=(Matrix(n,m,p(index1))); 
tempoJ(index2)=(Matrix(n,m,p(index2))); 
tempoK(index1)=(Matrix(m,n,q(index1))); 
tempoK(index3)=(Matrix(m,n,q(index3))); 

Factor(index1)=tempoJ(index1).*tempoK(index1); 
Factor(index2)=tempoJ(index2); 
Factor(index3)=tempoK(index3); 

Total=Factor.*(someMatrix(m).^var); 
Total=sum(Total); 
toc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:40:25.400

我实际上不会对这段代码进行矢量化。最新版本的 Matlab 具有出色的 JIT 编译器，并且矢量化代码没有与旧版本相同的性能改进。

原始代码更容易理解和维护。如果您绝对需要性能，我会考虑为此编写一个 MEX 函数（用 C 语言）。

但是，如果您打算对代码进行矢量化，我会消除不必要的`find`和`squeeze`调用（正如@mutzmatron 所建议的那样）。代替：

```
index1 = find(p>=1 & q>=1);
index2 = find(p>=1 & q<1 );
index3 = find(p<1  & q>=1);

tempoJ(index1)=squeeze(Matrix(n,m,p(index1)));
tempoJ(index2)=squeeze(Matrix(n,m,p(index2)));
tempoK(index1)=squeeze(Matrix(m,n,q(index1)));
tempoK(index3)=squeeze(Matrix(m,n,q(index3))); 
```

和：

```
p_gt1 = p >= 1;
q_gt1 = q >= 1;

index1 =  p_gt1 &  q_gt1;
index2 =  p_gt1 & ~q_gt1;
index3 = ~p_gt1 &  q_gt1;

tempoJ(index1)=Matrix(n,m,p(index1));
tempoJ(index2)=Matrix(n,m,p(index2));
tempoK(index1)=Matrix(m,n,q(index1));
tempoK(index3)=Matrix(m,n,q(index3)); 
```

没必要`squeeze`。行的 RHS 与`squeeze`LHS 具有相同数量的元素，因此 Matlab 很乐意将它们一对一映射并填充。

即使有了这种改进，矢量化代码仍然比原来的 for 循环慢一些。我每次都使用[`TIMEIT`](http://www.mathworks.com/matlabcentral/fileexchange/18798)：

```
% 'foo'     your original for loop
% 'foo_v0'  the original vector code, with find and squeeze
% 'foo_v'   the modified vector code, without find/squeeze

>> timeit(@()foo(Matrix,someMatrix))
ans =
   1.1482e-05

>> timeit(@()foo_v(Matrix,someMatrix))
ans =
   2.8039e-05

>> timeit(@()foo_v0(Matrix,someMatrix))
ans =
   1.3256e-04 
```

诚然，这是您为解释问题而简化的代码；您可能会在实际问题上得到不同的结果。但是，请注意，Matlab 在编译代码方面变得更加智能，因此矢量化不再像过去那样产生速度提升。

# mysql - 如何在系统启动时在 OS X 中启动分离的 mySQL 服务器？

> ID：11635773
> 
> 赞同：0
> 
> 时间：2012-07-24T17:01:42.487
> 
> 标签：mysql, macos, shell

我知道我可以启动服务器

```
mysqld_safe 
```

如何在每次系统启动时分离启动它？

在哪个初始化文件中，`~/.bash_profile`,`/etc/profile`比较好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T00:31:38.477

如果您[从 MySQL.com 下载 OS X 安装程序，](http://www.mysql.com/downloads/mysql/)它会包含一个可以安装的[首选项窗格。](http://dev.mysql.com/doc/refman/5.5/en/macosx-installation-prefpane.html)这包括在启动时自动运行以及查看 MySQL 服务器的当前状态的选项。

# php - 使用 PDO 选择多个数据库

> ID：11635775
> 
> 赞同：2
> 
> 时间：2012-07-24T17:01:48.590
> 
> 标签：php, mysql, database, pdo

我有一个`functions.php`文件有一个`PDO`我用来访问数据库的连接和所有好东西就是这个：

```
$host = "localhost";
$db = "maindatabase";
$adminuser = "admin";
$adminpw = "123456";
global $connection;

$connection = new Connection($host,$adminuser,$adminpw,$db); 
```

我`require`在每个需要访问数据库的文件上都有这个脚本，事情是在某些情况下我想从更改`$db = "maindatabase";`为`$db = "anotherdb";`我知道我可以只用一个 setter

```
$connection->setDatabase("anotherdb"); 
```

但由于`require`我`functions.php`文件放入每个其他文件中，我不知道它是否会将自己覆盖回默认值，有谁知道我该如何更改它并使其保持不变？

**编辑**

我在代码中*更改*`require`为`require_once`

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:08:16.873

您可以为每个数据库建立两个连接

```
$host = "localhost";
$db1 = "maindatabase";
$db2 = "anotherdb";
$adminuser = "admin";
$adminpw = "123456";
global $connection1, $connection2;

$connection1 = new Connection($host,$adminuser,$adminpw,$db1);
$connection2 = new Connection($host,$adminuser,$adminpw,$db2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:24:01.630

这是全局变量的**经典**问题。您的程序状态是不可预测的。你不知道你指的是哪个数据库。

您的解决方案是正确的依赖注入。

实现一个工厂类来按需生成正确的数据库连接，不要使用全局变量。这才是**正确**的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:18:24.677

当涉及到漂亮的代码时，根据您的分析水平，它可能会变得很难看，但是如果 MySQL 用户可以访问这两个数据库，为什么不在查询中指定数据库前缀呢？

例子：

```
SELECT * FROM maindatabase.tablename WHERE this='that'; 
```

在您的其他功能上，执行以下操作：

```
SELECT * FROM anotherdb.tablename WHERE this='that'; 
```

你也可以这样做：

```
$database_name = 'maindatabase';
$query = "SELECT * FROM {$database_name}.table";

$database_name = 'anotherdb';
$query = "SELECT * FROM {$database_name}.table"; 
```

这样你就可以`$database_name`在需要的地方切换你的变量。*

# string - QSocketNotifier 似乎没有读取完整的流

> ID：11635779
> 
> 赞同：0
> 
> 时间：2012-07-24T17:02:00.630
> 
> 标签：string, qt, sockets

我有一个 QSocketNotifier，它从串行端口（从文件 /dev/ttyUSB0）读取数据。不过，QSocketNotifier 似乎切断了字符串......我从 CuteCom 获取了一些代码（*apt-get source cutecom*在类 Debian 系统中），我试图在仅限终端的程序中实现它。所以，到目前为止：

**主.cpp：**

```
#include <QtCore/QCoreApplication>
#include <QSocketNotifier>
#include <QTimer>
#include <QDebug>

#include <sys/termios.h>
#include <stdio.h>
#include <fcntl.h>
#include <iostream>

using namespace std;

QSocketNotifier *m_notifier;
QString output_buffer="";
int m_fd;
char m_buf[4096];

class Timer : public QTimer {
  Q_OBJECT
public:
  explicit Timer(QObject *parent = 0) : QTimer(parent) {

  }
public slots:
    void readData(int fd){
        if (fd!=m_fd)
           return;

        int bytesRead=::read(m_fd, m_buf, 4096);

        if (bytesRead<0)
        {
           cerr << "read result: " << bytesRead << endl;
           return;
        }
        // if the device "disappeared", e.g. from USB, we get a read event for 0 bytes
        else if (bytesRead==0)
        {
           disconnectTTY();
           return;
        }

        const char* c=m_buf;
        qDebug() << "THEY CAME " << bytesRead << " bytes!";
        QString text="";
        for (int i=0; i<bytesRead; i++)
        {
            // also print a newline for \r, and print only one newline for \r\n
            if ((isprint(*c)) || (*c=='\n') || (*c=='\r'))
            {
                text+=(*c);
            }
            else
            {
                char buf[64];
                unsigned int b=*c;
                snprintf(buf, 16, "\\0x%02x", b & 0xff);
                text+=buf;
            }
         c++;
        }
        addOutput(text);
    }
    void addOutput(QString text){
        output_buffer+=text;
        this->setSingleShot(true);
        this->start(100);
    }
    void process_input(){
        //this function processes the input strings.
        cout << QString(output_buffer).toLocal8Bit().data();
        output_buffer.clear();
    }
    void create_avg(){
        cout << "I will create the average in the future!\n";
    }
    void disconnectTTY(){
        delete m_notifier;
        m_notifier=0;
    }
    void connect_normal_timer()
    {
        connect(this, SIGNAL(timeout()), this, SLOT(process_input()));
    }
    void connect_avg_maker_timer()
    {
        connect(this ,SIGNAL(timeout()), this, SLOT(create_avg()));
    }
    void disconnect_from_slot()
    {
        disconnect(this, 0, this, 0);
    }
    void create_notifier(){
        m_notifier=new QSocketNotifier(m_fd, QSocketNotifier::Read, this);
        connect(m_notifier, SIGNAL(activated(int)), this, SLOT(readData(int)));
    }
};

void open_device(QString device){
    m_fd=open(device.toLatin1(), O_RDONLY | O_NDELAY | O_NONBLOCK);//O_NDELAY);
    if(m_fd<0){
        cerr << QString("Cannot open device '"+device+"'\n").toLocal8Bit().data();
        exit(1);
    }
   tcflush(m_fd, TCIOFLUSH);
}

Timer timer;
Timer avg_maker;

#include "main.moc"

int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);

    /*
      SETTING UP TIMERS
    */

    timer.connect_normal_timer();
    avg_maker.connect_avg_maker_timer();

    /*
      OPENING DEVICE
    */

    open_device("/dev/ttyUSB0");

    /*
      CREATE SOCKET READER
    */
    timer.create_notifier();

    avg_maker.start(3000);
    return a.exec();
} 
```

所以，我设置了 2 个计时器，我打开 /dev/ttyUSB0 只读，然后连接我的 QSocket 通知程序。问题是我只被切碎（在中间）字符串，而不是真正的大字符串！我不知道是什么导致了这个问题，但是Cutecom 运行良好，而上述程序却不行！

虽然我不知道实际问题是什么，但我知道我的任何检查都没有真正导致这个程序（我没有应用任何字符串过滤）并且 QSocketNotifier 实际上只发送了字符串的第一部分和最后一部分（从不整个字符串）。

我知道这很难，但是，如果有人可以帮助...谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T07:00:06.627

open_device() 函数应该是：

```
void open_device(QString device){
    m_fd=open(device.toLatin1(), O_RDONLY | O_NDELAY);
    if(m_fd<0){
        cerr << QString("Cannot open device '"+device+"'\n").toLocal8Bit().data();
        exit(1);
    }
   tcflush(m_fd, TCIOFLUSH);
   int n = fcntl(m_fd, F_GETFL, 0);
   fcntl(m_fd, F_SETFL, n & ~O_NDELAY);
   if (tcgetattr(m_fd, &m_oldtio)!=0)
   {
      cerr << "tcgetattr() 2 failed" << endl;
   }

   struct termios newtio;

   if (tcgetattr(m_fd, &newtio)!=0)
   {
      cerr << "tcgetattr() 3 failed" << endl;
   }

   speed_t _baud=B9600;

   cfsetospeed(&newtio, (speed_t)_baud);
   cfsetispeed(&newtio, (speed_t)_baud);

   newtio.c_cflag = (newtio.c_cflag & ~CSIZE) | CS8;
   newtio.c_cflag |= CLOCAL | CREAD;

   newtio.c_cflag &= ~(PARENB | PARODD);

   newtio.c_cflag &= ~CRTSCTS;

   newtio.c_cflag &= ~CSTOPB;

   newtio.c_iflag=IGNBRK;

   newtio.c_iflag &= ~(IXON|IXOFF|IXANY);

   newtio.c_lflag=0;
   newtio.c_oflag=0;

   newtio.c_cc[VTIME]=1;
   newtio.c_cc[VMIN]=60;

   if (tcsetattr(m_fd, TCSANOW, &newtio)!=0)
   {
      cerr << "tcsetattr() 1 failed" << endl;
   }

   int mcs=0;
   ioctl(m_fd, TIOCMGET, &mcs);
   mcs |= TIOCM_RTS;
   ioctl(m_fd, TIOCMSET, &mcs);

   if (tcgetattr(m_fd, &newtio)!=0)
   {
      cerr << "tcgetattr() 4 failed" << endl;
   }

   newtio.c_cflag &= ~CRTSCTS;

   if (tcsetattr(m_fd, TCSANOW, &newtio)!=0)
   {
      cerr << "tcsetattr() 2 failed" << endl;
   }
} 
```

# php - 缓存用户权限的缺点

> ID：11635783
> 
> 赞同：1
> 
> 时间：2012-07-24T17:02:18.087
> 
> 标签：php, caching, fuelphp

我正在为 FuelPHP 中的应用程序编写身份验证包。权限将是相当细粒度的，并且需要为每个页面加载确定几个权限。

如果我要在服务器上缓存我的 groups_permissions 表，并且每次都查询它，而不是每次都查询数据库，是否会出现任何问题？

我想到的一个明显问题是，如果有人要获得对服务器的访问权限，他们可以更改他们的权限。但是，该论点似乎并不相关，就好像有人获得了对服务器的访问权，他们无论如何都可以访问数据库凭据。

谢谢，

詹姆士

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:06:33.980

想象一下这种情况。您 /Admin 取消了特定用户的某些权限，并且他正在访问该站点。如果缓存持续时间长并且还没有过期，他仍然可以做那些他现在不应该访问的操作。

一种解决方案是每当您对用户权限进行任何更改时更新缓存/在用户会话中保留权限。

# java - 如何在 Hibernate 中进行具有一对一关系的继承映射？

> ID：11635787
> 
> 赞同：2
> 
> 时间：2012-07-24T17:02:34.313
> 
> 标签：java, mysql, hibernate, inheritance, one-to-one

我有两个 MySQL 表，想用 hibernate 映射它们：

```
cars
- Id
- owner

audis:
- AudiId
- model 
```

在代码中：

```
@Entity
@Table(name = "cars")
public class Car{
    Integer id;
    String owner;
}

@Entity
@Table(name = "audis")
public class Audi extends Car{
    String model;
} 
```

我想在它们之间有一个连接的主键，以便 audiId 引用汽车表中的 Id。ID 应自动递增。

例子：

```
cars
id: 1 owner: "John"
id: 2 owner: "Jim"
id: 3 owner: "Jake"

audis
audiId: 1 model: "A8"
audiId: 3 model: "A6" 
```

用hibernate做到这一点的最佳方法是什么？我必须添加哪些注释？缺少哪些代码（getter 和 setter 除外）？

我发现很多关于这个主题的教程非常令人困惑，所以我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:14:27.613

尝试`@Inheritance(strategy=InheritanceType.JOINED)`class的注释`Car`。您也可以`@Id @GeneratedValue`用于班级`Id`成员。`Car`

[这](http://blog.v-s-f.co.uk/2010/12/inheritance-type-with-hibernate/)是一个如何使用 hibernate 继承的示例。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:23:50.603

您可以在您的超类 (Car) 中使用注释，并使用**@Id**`@Inheritance(strategy=InheritanceType.JOINED)`在您的 Car 中创建一个 id 属性并将其标记为**@GeneratedValue**。

 ****然后，在您的子类中使用**@PrimaryKeyJoinColumn(name="car_id")**，其中名称必须与 Car 超类的 id 中使用的名称相同。

**@PrimaryKeyJoinColumn**注释指定一个主键列，用作连接到另一个表的外键。

这是一个[非常简单的例子](http://viralpatel.net/blogs/hibernate-inheritance-table-per-subclass-annotation-xml-mapping/)来了解它。****

# dll - LoadLibrary 访问冲突

> ID：11635789
> 
> 赞同：0
> 
> 时间：2012-07-24T17:02:38.023
> 
> 标签：dll

当我尝试 LoadLibrary 收到错误消息 988（访问冲突）时，这个 dll 不是我的，我知道它是用 borland c++ 构建的，我试图解决这个问题好几个星期，请帮帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:06:26.447

使用[dependency walker](http://www.dependencywalker.com/)来检查dll 以查看它是否需要加载其他dll。

# javascript - 在 WebGL 着色器中使用 UInt8Array 数据

> ID：11635791
> 
> 赞同：3
> 
> 时间：2012-07-24T17:02:44.500
> 
> 标签：javascript, glsl, webgl, three.js

HTML FFT 音频分析器将其数据输出到 UInt32Array(64) 类型。

根据three.js文档，不支持这种数据类型：[https ://github.com/mrdoob/three.js/wiki/Uniforms-types](https://github.com/mrdoob/three.js/wiki/Uniforms-types)

如何以便宜的方式将我的每帧 FFT 缓冲区数据放入我的顶点着色器？

由于不兼容，我无法编译着色器。

任何帮助，建议表示赞赏。

```
 attributes = {
            customColor:  { type: "c", value: [] },
            tick:      { type: "f", value: 1.0 }
        };

        uniforms = {
            amplitude: { type: "f", value: 5.0 },
            opacity:   { type: "f", value: 0.3 },
            color:     { type: "c", value: new THREE.Color( 0xff0000 ) },
            fftSize:   { type: "i", value: 63 },
            freqData:  { type: "fv1", value: freqByteData }
        };

... 
```

在 render() 循环中：

```
 freqByteData = new Uint8Array(analyser.frequencyBinCount);
        analyser.getByteFrequencyData(freqByteData)

        uniforms.freqData = freqByteData; 
```

和 GLSL v-shader：

```
 uniform float freqData[64]; // not working, primitive type conflict
        uniform int fftSize;
        uniform float amplitude;

        attribute vec3 customColor;
        attribute int tick;

        varying vec3 vColor;

        void main() {

            vec3 norm = normalize(position);

            vec3 newPosition = position * freqData[tick % fftSize] + amplitude;

            vColor = customColor;

            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T19:17:17.267

我添加了新的统一类型“iv1”以便能够传入整数数组。你可以试试：

[https://github.com/alteredq/three.js/commit/4eedc69fa7344f4a512d6ae17427c7e109e0c550](https://github.com/alteredq/three.js/commit/4eedc69fa7344f4a512d6ae17427c7e109e0c550)

# php - 基于php返回值的实时jquery弹窗

> ID：11635797
> 
> 赞同：0
> 
> 时间：2012-07-24T17:03:17.943
> 
> 标签：php, jquery, ajax, jgrowl

我有一个 php 程序，它将计算时间差并以分钟为单位返回值。

对于消息弹出我使用[jGrowl](http://stanlemon.net/pages/jgrowl)

所以我想做的是获取返回值，如果它不到 30 分钟显示 jquery 消息。

最重要的是它应该实时运行。因此，如果用户在没有导航或刷新的页面中，如果时间少于 30 分钟，则弹出窗口应实时显示。

有人可以建议我如何使用返回值来实现上述要求吗？

下面是我用来计算时间差的代码

```
 function time($dbtime, $currtime)
    {
        //format year-month-day hour:min:secs
        $current = strtotime($currtime);
        $indb = strtotime($dbtime);
        $minits =  round(abs($current - $indb) / 60,2);

        return $minits;
    } 
```

目前我只弹出日期的消息

```
<script type="text/javascript">

        (function($){

            $(document).ready(function(){

                // jGrowl
                if ($.fn.jGrowl) {
                    // This value can be true, false or a function to be used as a callback when the closer is clciked
                            $.jGrowl.defaults.closer = function() {
                                console.log("Closing everything!", this);
                            };

                            // A callback for logging notifications.
                            $.jGrowl.defaults.log = function(e,m,o) {
                                $('#logs').append("<div><strong>#" + $(e).attr('id') + "</strong> <em>" + (new Date()).getTime() + "</em>: " + m + " (" + o.theme + ")</div>")
                            }               

                            <?php foreach ($dailies as $daily):?>
                            $.jGrowl("<?php echo $daily['calendars'][0]['Title']?>", { header: 'At <?php echo $daily['calendars'][0]['Start'];?>', sticky: true });

                            <?php endforeach;?>

                            $.jGrowl.defaults.closerTemplate = '<div>hide everything</div>';

                }

            });
        })(jQuery);

    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:42:55.723

有一个接受传递参数的 php 脚本，在这种情况下是两次。编写脚本以将结果返回为 JSON。这是我假设你已经完成的部分。如果您没有以 JSON 字符串形式返回的结果，您可以[在此处阅读 JSON](http://www.w3schools.com/json/default.asp)。

在您的网页中，使用 javascript 和 ajax 发出请求。基本上，当用户单击按钮时，将信息异步发送到您的 php 脚本，并在收到响应时向用户显示 inf。您可以[在此处阅读 Javascript 和 Ajax](http://www.w3schools.com/ajax/default.asp)。

# database - 将密码存储在数据库中的首选可恢复方法

> ID：11635798
> 
> 赞同：2
> 
> 时间：2012-07-24T17:03:21.173
> 
> 标签：database, encryption, password-encryption

我想在服务器上的数据库中存储一些密码。

密码应该是可恢复的，因为我想将它们用于需要密码的第三方 api。（所以我不能使用像md5这样的单向方法......）

将密码保存在数据库中的最佳方法是什么？没有比存储纯文本更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:07:25.990

[AES](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aes.aspx)在密码学上是健全的，并且可能是为新应用程序选择的最常见的加密（与散列相反）机制。

注意为您加密的每个密码生成一个随机初始化向量 (IV)，并将密钥和 IV 与加密的密码字节分开存储。

要了解 AES 和 Rijndael 之间的区别，请查看

[http://blogs.msdn.com/b/shawnfa/archive/2006/10/09/the-differences-between-rijndael-and-aes.aspx](http://blogs.msdn.com/b/shawnfa/archive/2006/10/09/the-differences-between-rijndael-and-aes.aspx)

> Rijndael 与 AES 的官方 FIPS-197 规范之间存在一些差异

您应该为每个用户使用唯一的 IV。但是，存储每个用户的密钥会导致复杂的密钥管理方案。我建议为应用程序提供一个密钥，并为每个用户提供一个 IV。

IV 可以与密文一起保存。密钥应存储在数据库之外。

您可以将加密的密钥存储在 web.config 中。看到[这个](https://stackoverflow.com/questions/54200/encrypting-appsettings-in-web-config)。

# ruby-on-rails - Rails 应用程序在远程机器上运行命令

> ID：11635799
> 
> 赞同：1
> 
> 时间：2012-07-24T17:03:21.720
> 
> 标签：ruby-on-rails, ruby, ssh, command, capistrano

我有一个 Ruby on Rails 3 应用程序，我想通过 SSH 访问控制远程机器。

基本上，我希望 Rails 应用程序能够通过 SSH 在远程计算机上编辑文件、复制文件、移动目录等。

我已经为我想要执行的功能创建了 Capistrano 任务，但我想知道：

1.  从 Rails 运行远程 shell 代码的最佳实践是什么
2.  如何从 Rails 应用程序调用 Capistrano 任务（基本上可以实现 1）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:50:40.660

对于#1，ruby 有一个 net-ssh 库——http: [//net-ssh.rubyforge.org/——](http://net-ssh.rubyforge.org/)它包含了你想要的功能。

对于#2，这个问题的公认答案包含从 Rails 内部运行 Capistrano 任务的信息——[有没有更好的方法从 rake 中运行 Capistrano 任务？](https://stackoverflow.com/questions/966467/is-there-a-better-way-to-run-a-capistrano-task-from-within-rake)

虽然文中说的是 rake，但它也普遍适用于 ruby​​。但是，应该注意的是，根据您的主机配置方式，您可能会遇到 Capistrano 创建子shell 以执行脚本的方式的问题，因此您可能需要尝试一下或发布后续问题

# html - 电子邮件中的表格背景图像

> ID：11635803
> 
> 赞同：3
> 
> 时间：2012-07-24T17:03:44.450
> 
> 标签：html, css, html-email

我的背景图片没有出现在电子邮件中时遇到了问题。谁能告诉我为什么会发生这种情况。

```
 <table border="0" cellpadding="0" cellspacing="0" height="489" width="638" align="left" background="http://www.bla.com/images/email-bg.jpg"> 
```

这是带有嵌套表格的完整设置，用于将文本覆盖在表格背景图像的顶部。

```
 <table border="0" cellpadding="0" cellspacing="0" height="489" width="638" align="left" background="images/email-bg.jpg">
     <tr>
            <td valign="top" align="left">
                <table border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td align="left" valign="top" width="100%" style="font-family: Arial, sans-serif; font-size:12px; color:#585858; padding:35px 230px 0 40px">
                            <p style="font-size:28px; color:#474747">Welcome to <b>bla bla</p>
                            <p style="font-weight:bold; margin-bottom: 4px;">Just click the link below to finish your registration:</p>
                            <a href="#">Continue</a>
                        </td>
                    </tr>
                    <tr>
                        <td align="left" valign="top" width="100%" style="font-family: Arial, sans-serif; font-size:10px; color:#FFF; padding:80px 120px 0 40px">
                            <p style="margin-bottom:0">** Please do not reply to this automated message. The Email box that sent the message is not monitored.**</p>
                        </td>
                    </tr>

                </table>
            </td>
        </tr>
    </table> 
```

**更新代码**

我更改了我的代码以使用它而不是使用样式属性

```
<table border="0" cellpadding="0" cellspacing="0" height="489" width="638" align="left" style="background-image:url(http://www.bla.com/images/email-bg.jpg)"> 
```

这适用于苹果邮件客户端，但不适用于 Outlook。有人知道前景的任何答案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:06:22.120

大多数电子邮件客户端不显示背景图像。使用纯色。或者一些解决方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T18:48:23.183

表格和表格单元格上的背景图像无法在 Outlook 2007 和 Outlook 2010 中呈现。

使用 vml hack

```
<td align="center" bgcolor="#ffffff" style="border-bottom:1px solid #000; border-top:1px solid #000;" valign="middle" background="image_name.jpg">
<!-- EMAIL CONTENT STARTS HERE -->
                <!--[if gte mso 9]>
            <v:image xmlns:v="urn:schemas-microsoft-com:vml" id="theImage" 

    style='behavior: url(#default#VML); display:inline-block; position:absolute; height:250px; width:600px; top:0; left:0; border:0; z-index:1;' src="image_name.jpg"/>
                <v:shape xmlns:v="urn:schemas-microsoft-com:vml" id="theText" style='behavior: url(#default#VML); display:inline-block; position:absolute; height:250px; width:600px; top:-5; left:-10; border:0; z-index:2;'>
             <![endif]-->
    <table>
    <tr><td>CONTENT HERE</td></tr>

    </table>

<!-- EMAIL CONTENT ENDS HERE -->
                <!--[if gte mso 9]>
            </v:shape>
            <![endif]--> 
```

确保高度和宽度正确并且应该可以

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T20:10:54.000

试试这个：在代码中填写相关信息并将其放置在您希望图像作为背景的位置。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-24T17:06:05.980

除非您设置了基本 href，否则您的图像路径应该包含整个路径 ( `http://domain/path`)，因为电子邮件客户端不知道您所指的域。

# asp.net - 如何访问 Razor 视图中的数据？

> ID：11635811
> 
> 赞同：1
> 
> 时间：2012-07-24T17:04:01.693
> 
> 标签：asp.net, asp.net-mvc-3, razor

在标准的 WebForms 中，我会拥有一些属性并设置它们。然后网页将绑定到它们，例如使用`<%#CustomerName%>`.

我知道 MVC 是一种不同的方法，但仍然必须同时显示来自多个来源的数据的基本需求。

我可以看到，如果我使用`@Model`then 它将访问控制器中的数据集。但是，如果您想显示来自 2 或 3 个单独项目的数据怎么办？

如果我想`Customer`在同一页面上显示 a ，他们的地址和他们的当前订单，有没有办法将这 3 个单独的模型传递给一个视图，或者我需要为每个视图创建一个局部视图，然后将它们全部显示在同一页面上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:10:07.683

物品有关系吗？如果是，则考虑创建一个 ViewModel，它是每个模型的聚合：

```
public CustomerViewModel
{
    public Customer Customer {get; set;
    public AddressViewModel Address {get; set;}
    public OrderViewModel Order {get; set;}
} 
```

那么在你看来：

```
@inherits System.Web.Mvc.WebViewPage<CustomerViewModel>

@model CustomerViewModel

@Model.Customer.Name

@Model.Address.Street

@Model.Order.Name

@model.Order.Date 
```

否则，如果这些项目根本*不*相关，那么您可以使用`RenderAction`：

在您`Customer`看来：

```
@Model.Customer.Name

@(Html.RenderAction("GetAddress", "Customer", new { customerId = Model.Customer.Id });) 

@(Html.RenderAction("GetOrders", "Order", new { customerId = Model.Customer.Id });) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T17:10:49.953

拥有一个`ViewModel`将所有这些数据（类）保存为属性并将其返回到您的视图

```
public class CustomerViewModel
{
  public int ID { set;get;}
  public string Name { set;get;}
  public Address Address{ set;get;}
  public IEnumerable<Order> Orders { set;get;}

  public CustomerViewModel()
  {
    if(Address==null)
        Address=new Addres();
    if(Orders ==null)
        Orders =new List<Order>();

  }
}
public class Address
{  
   public string AddressLine1 { set;get;}
   //Other properties
}
public class Order
{  
   public int ORderID { set;get;}
   //Other properties
} 
```

您的 GET 操作方法

```
public ActionResult Index(int id)
{
  var vm=new CustomerViewModel();

  vm.Name=repo.GetUser(id).Name;

  vm.Address=repo.GetAddressFromUserID(id);

  vm.Orders=repo.GetOrdersFromUser(id); 

  return View(vm);
} 
```

你的 View 将是强类型的 tp`CustomerViewModel`

```
@model CustomerViewModel

<p>@Model.Name</p>
<p>@Model.Address.AddressLine1</>
@foreach(var item in Model.Orders)
{
  <p>@item.OrderID</p>
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:09:35.007

您要做的是在您的上创建一个`Model`包含三个客户模型的集合。当我们谈论 MVC 中的模型时，将它们视为`ViewModels`. 也就是说，每个视图一个模型，它将包含该视图的所有数据。

因此，在下面的示例中，您将数据模型中的客户集合设置为视图模型的属性。您现在可以在您的视图中迭代`@Model.Customers`（或在 Html 辅助扩展方法中）

**例子**

```
public class MyViewModel{
    private List<Customer> _customers;

    public List<Customer> Customers{
        get{
            return _customers;
        }
    }
    //Other View Model Properties and Methods
} 
```

# xpath - 如何更改 XPath 查询返回的节点值？

> ID：11635824
> 
> 赞同：0
> 
> 时间：2012-07-24T17:04:47.930
> 
> 标签：xpath

例如，我需要我的结果是形式

```
<result>
  <French>
    <country>country-name</country>
    <country>country-name</country>
    ...
  </French>
  <German>
    <country>country-name</country>
    <country>country-name</country>
    ...
  </German>
</result> 
```

但目前，我的结果是形式

```
 <language percentage="100">German</language>
  <language percentage="32">French</language>
  <language percentage="1">German</language>
  <language percentage="100">French</language>
  <language percentage="100">French</language>
  <language percentage="100">German</language>
  <language percentage="99">French</language>
  <language percentage="100">French</language>
  <language percentage="10">French</language>
  <language percentage="32">German</language>
  <language percentage="100">French</language>
  <language percentage="18">French</language>
  <language percentage="65">German</language> 
```

这是我的查询：

```
 doc("countries.xml")//country/language[contains(text(), "French") or contains(text(), "German")] 
```

原始数据如下所示：

```
<country name="Afghanistan" population="22664136" area="647500">
    <language percentage="11">Turkic</language>
    <language percentage="35">Pashtu</language>
    <language percentage="50">Afghan Persian</language>
</country> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:35:46.633

使用 XQuery，这将解决问题：

```
 <result>
  {
    for $language in distinct-values(doc("countries.xml")//language)
    return
      element {translate($language, " ", "_")}
      {
        for $country in doc("countries.xml")//country[language = $language]
        return element country {string($country/@name)}
      }
  }
  </result> 
```

请注意，该语言不能立即用作标签名称，因为它包含空格（如“阿富汗波斯语”） - 因此调用`translate`.

如果您只想要您命名的语言，请将`for`子句替换为

```
 for $language in ("French", "German") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:10:13.847

您可以使用 LinQ to XML/Object，使用 GroupBy 创建查询并使用 XMLWriter 重写 XML，或者将 XML StyleSheet Transform 与 xml/xsl 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T21:38:01.513

XPath 只能选择输入文档中的节点。如果您想构建一个新的输出文档，您可以使用 XSLT 或 XQuery 来做到这一点，两者都使用 XPath 从输入中选择节点，并添加设施以在输出中构建新节点。

# django - 组合和排序来自不同表的两个查询集？

> ID：11635826
> 
> 赞同：4
> 
> 时间：2012-07-24T17:04:52.953
> 
> 标签：django

我有两个要组合和排序的查询集。

这是我的查询：

`latestbooks = Book.objects.all().order_by('-added')` `latestvideos = Video.objects.all().order_by('-added')`

我想组合这些查询并在将它们传递给我的模板之前对其进行排序，这样我就可以创建一个列表来显示网站上的最新活动——无论是新书还是新视频，都按添加的顺序排列.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T17:16:52.347

您可以将它们组合并排序为*列表*，但不能作为查询集。功能，无关紧要，但请记住，不可能进行进一步的过滤。

```
latestbooks = Book.objects.all().order_by('-added')
latestvideos = Video.objects.all().order_by('-added')

latest = list(latestbooks) + list(latestvideos)
latest_sorted = sorted(latest, key=lambda x: x.added, reverse=True) 
```

**更新**

如果您使用不同的属性名称，它仍然是可能的，但它开始变得丑陋，这可能不仅适用于两种变体：

```
sorted(latest, key=lambda x: x.added if hasattr(x, 'added') else x.desadded, reverse=True) 
```

# logging - 输出重定向 - 如何使用 tail -f 获得实时流

> ID：11635832
> 
> 赞同：0
> 
> 时间：2012-07-24T17:05:24.137
> 
> 标签：logging, ubuntu

我正在使用 runnit 在 ubuntu 上运行 python 进程。我将程序的输出重定向到日志文件。

```
exec /usr/bin/python /home/ubuntu/workspace/monitor.py >> /tmp/monitor.out 2>&1 
```

然后我用

```
tail -f /tmp/monitor.out 
```

看看发生了什么。

但是，它的输出不是流式传输的。总是落后，有时落后几分钟。它的输出并不多。

如何获得实时流媒体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:31:05.340

输出可能正在缓冲。在脚本循环的末尾放置`sys.stdout.flush()`某处以立即将缓冲区写入磁盘。（有关更多信息，请参见[此处](https://stackoverflow.com/a/2753361/392143)）

# c# - 处置的控件是否应该能够安全地忽略事件回调？

> ID：11635833
> 
> 赞同：3
> 
> 时间：2012-07-24T17:05:26.587
> 
> 标签：c#, .net, winforms, idisposable

我有一个类是一次性 UI 控件。它订阅模型对象的更改以重绘其内容。

另一方面，在某些情况下，同一模型对象的某些特殊更改会指示包含此控件的视图将其删除并处置（控件）。

结果，模型中的更改取决于订阅顺序-首先导致控制处置，然后是方法调用-最终以`ObjectDisposedException`.

**问题**：控件是否应该设计为安全地**忽略事件回调**，或者我们是否应该尝试阻止来自其他层**的这种调用？**

对于那些喜欢看更多代码而不是文字的人，我准备了一个非常简化的示例：

```
//############################################
class View
{
    private Control m_Control;

    public View(Logic logic, Model model)
    {
        m_Control = new Control(model);
        logic.Changed += LogicChanged;
    }

    private void LogicChanged(object sender, EventArgs e)
    {
        m_Control.Dispose();
        m_Control = null;
    }
}

//############################################
class Control : IDisposable
{
    private readonly Model m_Model;

    public Control(Model model)
    {
        m_Model = model;
        m_Model.Changed += ModelOnChanged;
    }

    public bool IsDisposed { get; private set; }

    public void Dispose()
    {
        m_Model.Changed -= ModelOnChanged;
        IsDisposed = true;
    }

    private void ModelOnChanged(object sender, EventArgs e)
    {
        if (IsDisposed)
        {
            throw new ObjectDisposedException(ToString());
        }
        //Do something
    }
}

//############################################
class Model
{
    public event EventHandler<EventArgs> Changed;

    private void OnChanged(EventArgs e)
    {
        EventHandler<EventArgs> handler = Changed;
        if (handler != null)
            handler(this, e);
    }

    public void Change()
    {
        OnChanged(null);
    }
}

//############################################
class Logic
{
    private readonly Model m_Model;

    public Logic(Model model)
    {
        m_Model = model;
        m_Model.Changed += ModelOnChanged;
    }

    private void ModelOnChanged(object sender, EventArgs e)
    {
        OnChanged(null);
    }

    public event EventHandler<EventArgs> Changed;

    private void OnChanged(EventArgs e)
    {
        EventHandler<EventArgs> handler = Changed;
        if (handler != null)
            handler(this, e);
    }
}

//############################################
class Program
{
    private static void Main(string[] args)
    {
        var model = new Model();
        var logic = new Logic(model);

        var view = new View(logic, model);
        model.Change();
        //And crash!
    }
} 
```

在给定的示例中，您会在哪里提出修复建议？`Model`和`Logic`类只是在不知道事件订阅顺序的情况下做他们的事情。我也没有看到任何设计缺陷`View`和`Control`实现。

想象一下，有三个不同的团队在实施`Model`，`Logic`并且`UI`不仅有这四个组件，而且还有数百个。这个问题可能在任何地方发生。

在这种特殊情况下，我正在寻找的不是本地修复，但我想找到一种模式来防止这种情况发生。例如：“控件必须优雅地忽略已处置实例上的事件调用”或“逻辑必须阻止模型上的订阅，仅允许 UI 这样做。” 等等

* * *

## 除了接受的答案

是的，已处置的对象事件回调不应引发异常。更一般地说：

> ...即使在事件被取消订阅后，事件处理程序也必须在被调用时保持健壮。

这有很多原因 - 请参阅 Eric Lippert 的精彩文章[Event and Races](http://blogs.msdn.com/b/ericlippert/archive/2009/04/29/events-and-races.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:50:44.103

在决定是否抛出`ObjectDisposedException`时，应该考虑几个因素：

1.  对象能否满足特定方法调用的约定，而不必使用不再可用的资源？
2.  如果函数成功返回，调用者可能会期望做一些没有必要资源就无法完成的事情，这意味着由于失败是不可避免的，无论如何应该早点而不是晚点，或者调用者甚至可能做正确的事情如果没有抛出异常？

在许多情况下，尤其是在“更新事件”场景中，调用者并不特别关心被调用方法的作用；调用的语义基本上是“做任何你认为需要做的事情”。任何对象都可以成功地执行这样的操作，即使它已被释放，只需确定无需执行任何操作即可。如果使用的回调模式不允许事件处理程序通知事件发布者它不希望接收更多事件（Microsoft 的正常事件模式不提供任何此类设施），则 Disposed 对象可能是继续接收回调，因为事件发布者处于错误状态，但抛出异常可能对解决该问题没有多大帮助，并且可能会产生更多问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:45:43.453

我见过的一种模式如下。如果您已被处置，则什么也不做，而不是抛出异常。

```
private void ModelOnChanged(object sender, EventArgs e)
{
    if (IsDisposed) { return; } // i.e. Do nothing

    //Do something
} 
```

该模式的最大问题之一`IDisposable`是它试图同时进行确定性和非确定性内存管理。你可以打电话`Dispose()`，或者 GC 可以为你做。它用终结器之类的东西制造了所有的混乱。

与只保留引用计数器的语言不同——当最后一个引用消失时调用“析构函数”——.NET 选择一种方法，其中对象的内存可能已被释放但对该对象的引用仍然存在。因此，您必须确保您的代码不会访问处于无效状态的对象。这通常采用以下两种形式之一：

1.  检查`IsDisposed`一切，如果它被丢弃`Public`，抛出一个`ObjectDisposedException`
2.  如果对象被释放，则不执行任何操作（提前返回）

从长远来看，第一种选择不太可能咬你，因为你知道你马上犯了一个错误。但是，如果行为不可预测并且您有[时间耦合](http://blog.ploeh.dk/2011/05/24/DesignSmellTemporalCoupling.aspx)问题，您最终将不得不处理整个`ObjectDisposedException`程序。在这种情况下，您可能会采用“无所事事”的方法，这样您的程序中的绒毛就会减少。不幸的是，它有可能会咬你，因为它*看起来*像你调用的方法完成了它的工作。

直到现在我还没有考虑过的另一个选项是订阅`Disposed`你有类级别引用的事件对象`IDisposable`。释放对象时，将该字段设置为空。同样，您可以在对对象执行某些操作之前检查 IsDisposed （如果它已暴露）（在您跳转之前询问）。

```
Public Class Foo
  Private _disposableObject As IDisposableFoo

  Private Sub OnBarDisposed(sender As Object, e As EventArgs) Handles IDisposableFoo
    _disposableObject = Nothing 
    'Hmm, now we'll get null-references everywhere
  End Sub 
```

和...

```
Public Sub DoesStuffWithIDisposableObject()
  If Me.DisposableObjectReference.IsDisposed Then Exit Sub

  'Yay, valid reference! Let's get stuff done!
End Sub 
```

仍然可能不是最好的选择，但不幸的是，语言的设计使得这种笨拙是不可避免的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:48:25.190

我想我会抛出一个 ObjectDisposedException 如果有东西试图用处置的控件做某事。放置控件意味着您已经完成了它，因此不应再尝试使用它。如果有问题，我会将其视为程序中需要修复的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T20:09:25.647

在[关于处置对象的指南中，](http://code.logos.com/blog/2008/02/disposed_objects.html)我读到：

> 关于处置的对象有一些规则。首先，对已经释放的对象调用 Dispose 应该什么都不做。其次，**在已释放的对象上调用任何其他属性或方法都应该抛出 ObjectDisposedException**。

另一个[准则](http://msdn.microsoft.com/en-us/magazine/cc188935.aspx#S4)：

> 一旦一个物体被丢弃，它就应该被视为禁区。按照惯例，**如果在调用 Dispose 之后调用了一次性对象的任何方法，则一次性对象应该抛出异常**。在 System 命名空间中有一个名为 ObjectDisposedException 的内置异常类型，已为此确切目的添加到框架类库中。

遵循这些规则，您的代码完全没问题（尽管它会引发异常）。

**两个引号都表示，如果调用其任何**方法或属性，则已处置对象应引发异常。我更愿意说“如果调用**任何公共**方法或属性，则抛出异常”。

如果调用私有方法，我认为什么都不做是安全的。因此，您的问题的答案是：“**是的，处置的控件应该能够安全地忽略事件回调**”。

顺便说一句：也许问题也可能是：“谁负责处置一个对象？”

在给定的示例中，您可以让控件在 ModelOnChanged 方法中自行处理。我没有找到通用的指导方针，但[有一些建议](https://stackoverflow.com/questions/4085939/who-should-call-dispose-on-idisposable-objects-when-passed-into-another-object)。

# java - 是否建议将此进程拆分为不同的线程？

> ID：11635836
> 
> 赞同：0
> 
> 时间：2012-07-24T17:05:38.257
> 
> 标签：java, multithreading, directory

我有一个设计为在可移动设备上运行的 Java 应用程序。它的一个特点是它旨在列出驱动器上的所有文件夹，但显然文件和文件夹越多，花费的时间就越多（不管计算机有多强大），并且移除设备越来越大，这些天来更大，我认为在这个过程中获得尽可能快的速度是很重要的。

我知道最好/最快（就列表而言，而不是编码而言）方法是创建一个索引文件，但我认为这错过了我的应用程序的全部意义。所以，我想也许线程会有所帮助，因为理论上，即使是两个线程也会使上市速度提高一倍，但我不知道这是否可能，如果可以，如何？

任何答案将不胜感激。这是我目前拥有的递归方法：

```
private static void recursiveNodeCreation(DefaultMutableTreeNode node, String root){
        if(root==null) root = RUNNING_DRIVE = ".";

        try{
        // Get a list of files/folders in the root directory
        File rootDir = new File(root);

        File[] files = rootDir.listFiles();
        // Loop through the files/folders
        for(File current : files){
            if(Files.isReadable(current.toPath()) && !current.isHidden() && current.isDirectory()){
                DefaultMutableTreeNode folder = new DefaultMutableTreeNode(new FolderOnDrive(current.getName(), current.getPath()));
                recursiveNodeCreation(folder, current.getPath());
                node.add(folder);
            }
        }
        }catch(Exception e){e.printStackTrace();}
} 
```

（`RUNNING_DRIVE`保存应用程序正在运行的驱动器的驱动器号。我只是添加`= "."`以使其在测试时更快。您可能已经猜到了，我列出了 JTree 中的所有文件夹。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:16:43.883

如果可以*并行*执行多个操作，线程化应用程序将提高应用程序的速度。例如，如果您正在从单个网络连接进行读取和写入，那么分叉一个线程以便您可以同时处理其他连接是有意义的。

但是，在您的情况下，我怀疑您受到可移动设备服务 IO 请求的能力的限制。每个设备（包括内存）都有一个最大请求数和一个时间段内可以处理的最大数据量——与线程数无关。众所周知，记忆棒之类的速度很慢，这就是为什么许多相机内部都有内存，以便随着时间的推移在写入 SD 卡的同时快速拍摄许多照片。添加额外的线程很可能不会提高整体应用程序的性能，实际上可能会减慢它，因为 IO 请求将在存储驱动器的不同部分工作并相互竞争。

让您的应用程序看起来更高效的一种方法是让一个线程在后台实际读取设备。然后，您的 UI 可以向用户显示初始结果（如顶级目录），并在后台线程从设备读取时填写更多信息。

要测试您是否受 IO 限制，您应该在更快的硬盘驱动器上运行您的代码，以将其目录递归速度与可移动设备进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:13:54.967

IO真的很慢。[本文介绍了如何调整文件 IO 以提高性能](http://java.sun.com/developer/technicalArticles/Programming/PerfTuning/)，但由于您的程序没有读取任何文件的内容，我怀疑您是否可以加快速度。程序的瓶颈不是列出文件的速度有多快，而是从设备获取文件列表的速度有多快。

您可以根据需要添加任意数量的线程，瓶颈仍然是 IO。

# html - 列表但不是文本的 CSS 3 不透明度

> ID：11635837
> 
> 赞同：1
> 
> 时间：2012-07-24T17:05:38.010
> 
> 标签：html, css, opacity

> **可能重复：**
> [背景不透明，但文本不透明](https://stackoverflow.com/questions/637921/opacity-of-background-but-not-the-text)

我有一个 HTML 无序列表。我需要背景的不透明度为“0.3”。但我不希望将这种不透明度应用于文本。这是我当前的 CSS；它使文本的不透明度也为 0.3：

```
li {
    background-color:pink;
    opacity: 0.3;
}

a {
    color: white;
    opacity: 1.0;
} 
```

如何使链接文本呈现白色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:08:50.457

您将不得不使用另一种方式来设置您的颜色，如 rgba，如下所示：

```
li { background-color: rgba(0,0,0,.3); } 
```

您还需要摆脱 opacity 属性/值。顺便说一句，css 粉色的 rgb 值为：250,192,203，因此：rgba(250,192,203,.3)；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:12:03.847

这就是你需要的我的朋友！

[http://www.css3.info/introduction-opacity-rgba/](http://www.css3.info/introduction-opacity-rgba/)

你不能像那样使用不透明度......它会被继承，并且多年来一直对开发人员非常烦人。

# wordpress - 如何在 WordPress 的循环和单个中拥有不同的内容

> ID：11635839
> 
> 赞同：0
> 
> 时间：2012-07-24T17:05:42.560
> 
> 标签：wordpress

[http://css-tricks.com/video-screencasts/](http://css-tricks.com/video-screencasts/)

试着看看这个同样由 wordpress 提供支持的著名网站。循环中的内容与单个帖子不同。它在循环中使用“dl”元素，但不是单个帖子中的主要内容。就像它有一个帖子的另一个简短摘要，只会在循环中显示。

所以我的麻烦是如何在多个帖子的循环中显示一些东西（包括图像、文章、视频嵌入）但不显示在单个帖子本身中，反之亦然。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:32:10.960

首先，让我们从我们对这个网站结构方式的了解开始。您正在查看的页面有一个名为“视频截屏”的自定义帖子类型，或者它使用的是“视频截屏”类别，因此在多个帖子页面上使用的模板可能是以下之一：

**如果 video-screencasts 是一个类别**

1.  类别-视频-screencasts.php
2.  类别-{cat_id}.php
3.  类别.php

**如果 video-screencasts 是自定义帖子类型**

1.  存档-视频-screencasts.php
2.  存档.php
3.  index.php（不太可能）

最终，它可能使用的任何模板文件都不会对您产生太大影响。这些只是您如何以类似方式组织自己的网站的可能选项。

其次，我们来看看多篇文章页面和单篇文章页面在结构上的区别。多个帖子页面正在运行查询，并根据查询结果返回一系列**特色图像**和**摘录**。单个帖子页面返回帖子本身的实际**内容**。

所以现在，我们需要了解我们将如何做这样的事情。所以让我们从图像开始：

这可以通过以下两种方式之一来完成。创建主题时，您可以将预览图像附加到帖子中最适合 Wordpress 的方式可能是[添加主题支持帖子缩略图](http://codex.wordpress.org/Post_Thumbnails)。另一种可能的方法是[添加一个自定义字段](http://codex.wordpress.org/Custom_Fields)（可能将其命名为“previewImg”），其中包含您要显示的图像缩略图的路径。

至于摘录：

帖子和页面有一个您可以设置的可选[摘录字段。](http://codex.wordpress.org/Function_Reference/the_excerpt)要亲自查看此内容，请导航到您的帖子编辑器，然后查看页面的右上角。您会看到一个显示“屏幕选项”的按钮。这将允许您打开可用于微调条目的各种帖子/页面控件。摘录和自定义字段只是您可以在此区域内启用的众多选项中的两个。

每个帖子和页面都有一个摘录。通常，Wordpress 会默认使用帖子内容的前 50 个左右的单词，但您可以通过将 HTML 放入帖子的摘录字段来覆盖此设置。现在只需要生成循环：

```
<?php
$query = new WP_Query(array('category_name'=>'video-screencasts'));
if($query->have_posts()) : while($query->have_posts()) : $query->the_post();
?>
<div class="post_result">
    <a class="thumb" href="<?php the_permalink(); ?>"><?php the_post_thumbnail(); ?></a>
    <h1 class="title"><?php the_title(); ?></h1>
    <p class="excerpt"><?php the_excerpt(); ?></p>
</div>
<?php
endwhile;endif;
?> 
```

这只是一个示例，可以利用我上面描述的一些内容在非常基本的级别上工作。这也假设“video-screencasts”是一个类别，并且已启用对 Post Thumbnails 的主题支持。

至于单个帖子模板，代码本身将是最少的：

```
<?php
if(have_posts()) : while(have_posts()) : the_post();
?>
<h1 class="title"><?php the_title(); ?></h1>
<?php
the_content();
endwhile;endif;
?> 
```

如前所述，这并不是他们的页面的确切设置方式，这些代码示例旨在说明如何实现您想要的。

总而言之，您需要阅读一些关于如何利用大量功能来根据您的需要定制所有内容的信息，并通过编写一些自己的代码来了解一下。但总的来说，我认为这涵盖了您需要了解的所有内容，以帮助您朝着正确的方向开始。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T13:51:24.687

我完成了 2 个解决方案

1.）使用自定义摘录+特征图像

2.) 在 wordpress 函数中使用带有 get_post_custom 构建的自定义字段

# c++ - OpenCV没有填充整个图像

> ID：11635842
> 
> 赞同：1
> 
> 时间：2012-07-24T17:06:04.330
> 
> 标签：c++, image, opencv, osx-lion

我对 OpenCV 有一个奇怪的问题。这是代码：

```
 cv::Mat cvSideDepthImage1(150, 150, CV_8UC1, cv::Scalar(100));
    cv::imshow("side1", cvSideDepthImage1); 
```

根据[文档`cv::Mat`](http://opencv.willowgarage.com/documentation/cpp/basic_structures.html)，我希望这会显示一个 150x150 的图像，所有像素都设置为 100（所以整个图片应该是灰色的）。

相反，我得到了这个：

![在此处输入图像描述](../Images/f2f7bf106ae28e30a27502ed18014937.png)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:27:33.937

这似乎是 OS X 上 OpenCV 中的一个错误。

我已经[在这里](http://code.opencv.org/issues/2189)报告了。

# node.js - 通过 node.js/express 将 socket.io javascript 文件提供给客户端

> ID：11635845
> 
> 赞同：1
> 
> 时间：2012-07-24T17:06:13.717
> 
> 标签：node.js, websocket, express, socket.io

我正在尝试使用 socket.io 和 express 获得一个示例客户端连接（具体来说，这个：[http ://www.catonmat.net/blog/nodejs-modules-socketio/ 以及](http://www.catonmat.net/blog/nodejs-modules-socketio/)[https](https://github.com/LearnBoost/socket.io/blob/master/examples/chat/app.js)上其他示例中的一些片段[://github.com/LearnBoost/socket.io/blob/master/examples/chat/app.js](https://github.com/LearnBoost/socket.io/blob/master/examples/chat/app.js)）。

我已经完成了大部分的设置和工作——服务器运行，我可以点击 / 将 index.jade 文件发送到浏览器。但是，一旦发生这种情况，它什么也不做。

服务器：

```
var io = require('socket.io');
var express = require('express')
, stylus = require('stylus')
, nib = require('nib');

var app = express.createServer()
var io = io.listen(app);

app.configure(function () {
  app.use(stylus.middleware({ src: __dirname + '/public', compile: compile }));
  app.use(express.static(__dirname + '/public'));
  app.set('views', __dirname);
  app.set('view engine', 'jade');

  function compile (str, path) {
    return stylus(str)
      .set('filename', path)
      .use(nib());
  };
});

app.get('/', function (req, res) {
  res.render('index', { layout: false });
});

app.listen(8080);

io.sockets.on('connection', function (socket) {
  console.log('A socket connected!');
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
  socket.on('disconnect', function () {
    console.log('user disconnected');
  });
}); 
```

index.jade:

```
doctype 5
html
  head
    link(href='/stylesheets/style.css', rel='stylesheet')
    script(src='http://code.jquery.com/jquery-1.6.1.min.js')
    script(src='/socket.io/socket.io.js')
    script
      // socket.io specific code
      var socket = io.connect('http://localhost:8080');
      socket.on('connect', function () {
        alert('connected');
      });
      socket.on('news', function (data) {
          console.log(data);
          socket.emit('my other event', { my: 'data' });
        });
  body
    #chat 
```

看来服务器没有服务 /socket.io/socket.io.js （http://localhost:8080/socket.io/socket.io.js 产生错误）。我需要做什么才能获得快递服务该文件？我在任何示例中都找不到。

还有什么我做错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T21:42:00.797

[将 Socket.IO](http://socket.io/#how-to-use)与 Express 3 一起使用需要您实例化 a`http.Server`以将 socket.io 附加到：

```
var express = require('express')
  , http = require('http')
  , app = express()
  , server = http.createServer(app).listen(3000)
  , io = require('socket.io').listen(server)
  ; 
```

这应该适合你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T00:54:42.410

将 Express 3 与 socket.io 一起使用的一些升级指南建议将 http.createServer 传递给 socket.io。

这可行，但似乎不能正确地提供 socket.io 客户端文件。经过一些测试，我发现如果你将 app.listen 返回的内容传递给 socket.io，它就可以工作：

```
var express = require('express'),
    app = express(),
    server = app.listen(3000),
    io = require('socket.io').listen(server); 
```

**一些回复的人请注意：**这不是文件路径问题。当使用 node + socket.io http server socket.io 会自动拦截对*“/socket.io/socket.io.js”*的 get 调用并为您提供客户端文件。它实际上并不存在于 Web 文件结构中。使用 Express 3 时，此功能出现故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:59:51.740

我假设错误是 404 - 您没有设置 ExpressJS 来提供静态文件。当您请求`/socket.io/socket.io.js`时，它没有找到路由，也没有提供静态文件，因此它返回 404。

通常，您需要设置一个用于提供静态文件的文件夹，例如`public`. 在其中，放置您的`socket.io`文件夹，然后在该`socket.io.js`文件中。然后，您将其添加到您的`app.configure`块中：

`app.use(express.static(__dirname + '/public'));`

现在 ExpressJS 知道在发出请求时提供 JS 文件。[您可以在此处](http://expressjs.com/guide.html#configuration)阅读有关 ExpressJS 静态配置的更多信息。

**更新：**
我的错误 - 我看到你已经设置了静态服务器。您的目录路径是否正确？`socket.io`文件夹在你的文件夹里吗`public`？如果没有看到您的具体错误，很难知道问题可能是什么。

# ruby-on-rails - 无线接口上的 Web 服务器？

> ID：11635851
> 
> 赞同：0
> 
> 时间：2012-07-24T17:06:35.217
> 
> 标签：ruby-on-rails, ruby, sinatra

我想知道是否可以让“Sinatra”在无线接口上收听。通过我的小实验，我没有成功。当我尝试运行 sinatra 并通过无线接口访问它时，我得到

```
 Forbidden

     You were denied access because: Access denied by access control policy. 
```

通常，Sinatra 从 0.0.0.0:4567 开始侦听，据我了解，这包括所有接口（以太网、环回和 wifi 或更多）。如果我错了，请澄清这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:23:21.630

你做错了。

如果您使用该`-h`标志调用您的服务器，Sinatra 将吐出它的帮助：

```
用法：服务器[选项]
    -p port 设置端口（默认为4567）
    -o addr 设置主机（默认为 0.0.0.0）
    -e env 设置环境（默认为开发）
    -s server 指定机架服务器/处理程序（默认为瘦）
    -x 开启互斥锁（默认关闭）

```

`-e env`告诉 Sinatra 使用特定的环境。

如果我没记错的话，问题与 Sinatra 和 Rack 环境有关，认为您正在运行“开发”、“测试”或“生产”。“ [Sinatra 动态配置环境](https://stackoverflow.com/a/5834009/128421)” 为您提供了一些重要信息，Sinatra 的“[配置设置](http://www.sinatrarb.com/configuration.html)”文档也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T08:53:07.770

原来是代理是罪魁祸首，并给出了 403 错误消息。

并且可以使用 Tin Man 提到的选项设置部署的地址、环境和端口（包括无线接口）。谢谢！

# struts2 - 关于 struts 2 工作流程的步骤顺序

> ID：11635852
> 
> 赞同：0
> 
> 时间：2012-07-24T17:06:36.523
> 
> 标签：struts2

我是 struts 2 的新手，虽然我通过阅读 mkyong tutorials for struts 2 部分阅读并理解了 Struts 2 的流程，但是请按顺序步骤详细告诉我 struts 2 框架的流程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:45:41.390

struts 中的流序列实际上可以在 Ian Roughley 的书《Starting Struts2》的封面上找到：http: [//www.infoq.com/minibooks/starting-struts2](http://www.infoq.com/minibooks/starting-struts2)

![在此处输入图像描述](../Images/95bfa04ac55de853a2629e9c9e22835e.png)

我推荐它作为 Struts2 的介绍。我还推荐 David Newton 的 Apache Struts 2。

# php - nginx 与 php 并重写规则

> ID：11635853
> 
> 赞同：0
> 
> 时间：2012-07-24T17:06:42.843
> 
> 标签：php, nginx, rewrite

我想用 php 和一个简单的重写规则设置我的 nginx 服务器。我试图制定一个重写规则，任何指向不存在的文件或目录的 url 都会重写为 /index.php?q=。我创建了这个 nginx.conf：

```
events {
}

http {
  include fastcgi.conf;
  server {
    listen          80;
    server_name     www.example.com;
    index           index.php;
    root            /var/www/html/www.example.com;
    location / {
      index     index.php;
      if (!-f $request_filename) {
        rewrite ^/(.*)$ /index.php?q=$1 last;
      }
      if (!-d $request_filename) {
        rewrite ^/(.*)$ /index.php?r=$1 last;
      }
    }
    location ~ \.php {
      try_files $uri =404;
      fastcgi_pass 127.0.0.1:9999;
    }
  }
} 
```

这有效，但并非在所有情况下都有效。它完美地重写了 tihs 之类的 utls：

[http://www.example.com/111/222/333](http://www.example.com/111/222/333)

但是两种情况不能按我的意愿工作：

[http://www.example.com/111/222/333.php](http://www.example.com/111/222/333.php)

丢弃 404 错误。

并且 www.example.com/forum/index.php 存在，所以 www.example.com/forum/index.php 执行论坛目录下的 index.php 就可以了。但是 www.example.com/forum url 重写为 /index.php，而不是我想要的在论坛目录中执行 index.php。

我该如何解决这两个问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T19:32:10.153

您的配置绝对错误，将位置/内容替换为一行：

```
try_files $uri $uri/ /index.php?q=$uri; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:20:58.740

如果要重定向到特定目录中的索引文件，则需要将重定向格式设置为这样

```
rewrite ^/((.*/)*)(.*)$ /$1index.php?q=$3 
```

# android - stopLoading() 究竟做了什么？

> ID：11635854
> 
> 赞同：14
> 
> 时间：2012-07-24T17:06:59.410
> 
> 标签：android, webview, android-webview, webviewclient

是的，我知道[stopLoading()](http://developer.android.com/reference/android/webkit/WebView.html#stopLoading%28%29)的文档说“*停止当前负载。* ”

但是，当我尝试在加载新页面之前使用它来停止加载当前正在进行的页面时，它的行为似乎并不[如预期](https://stackoverflow.com/q/3679080/1088880)：

```
07-24 12:53:30.177: V/WebView.loadUrl: http://www.google.com
07-24 12:53:30.227: V/WebViewClient.onPageStarted: http://www.google.com

===> WebView.stopLoading() called here <====

07-24 12:53:31.917: V/WebView.loadUrl: http://www.stackoverflow.com
07-24 12:53:32.697: V/WebViewClient.onPageFinished: http://www.google.com

07-24 12:53:32.767: V/WebViewClient.onPageStarted: http://www.stackoverflow.com
07-24 12:53:33.587: V/WebViewClient.onPageFinished: http://www.stackoverflow.com 
```

正如您在日志中看到的那样，尽管事实上大约**1 秒前**`WebViewClient.onPageFinished()`被调用，但第一个被调用。`loadUrl()``WebView.stopLoading()`

 **这是为什么？

[stopLoading()](https://stackoverflow.com/q/2223068/1088880)究竟做了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T15:51:24.000

you786 是对的：

```
public void stopLoading() {
    checkThread();
    // TODO: should we clear all the messages in the queue before sending
    // STOP_LOADING?
    switchOutDrawHistory();
    mWebViewCore.sendMessage(EventHub.STOP_LOADING);
} 
```

对于他们在剩余消息中标记的 TODO，将首先得到处理。所以这导致了我只是好奇：当停止加载时

```
WebViewClient.onReceivedError(WebView view, int errorCode, String description, String failingUrl) 
```

WebView 并没有真正停止，而是加载自己的 404 页面（如果您不调用 stopLoading()，它通常会执行此操作）：

```
11-07 16:30:01.112: I/MainActivity(19189): Loading: http://92.53.45.42
11-07 16:30:01.253: V/MainActivity.WebViewClient(19189): SHOULD_INTERCEPT_REQUEST: http://92.53.45.42/
11-07 16:30:01.347: V/MainActivity.WebViewClient(19189): PAGE_STARTED: http://92.53.45.42/
11-07 16:30:01.347: V/MainActivity.WebChromeClient(19189): ON_PROGRESS_CHANGED: 10
11-07 16:30:01.347: V/MainActivity.WebViewClient(19189): LOAD_RESOURCE: http://92.53.45.42/
11-07 16:30:25.292: I/GATE(19189): <GATE-M>DEV_ACTION_ERROR</GATE-M>
11-07 16:30:25.300: E/MainActivity.WebViewClient(19189): (CONNECT - Failed to connect to the server) -> http://92.53.45.42/
11-07 16:30:25.300: W/MainActivity.WebViewClient(19189): loading stopped..:
11-07 16:30:25.300: V/MainActivity.WebViewClient(19189): PAGE_STARTED: http://92.53.45.42/
11-07 16:30:25.300: I/MainActivity.WebViewClient(19189): PAGE_FINISHED: http://92.53.45.42/
11-07 16:30:25.339: I/MainActivity.WebChromeClient(19189): ON_RECEIVED_TITLE: Webseite nicht verfügbar
11-07 16:30:25.339: V/MainActivity.WebChromeClient(19189): GET_VISITED_HISTORY
11-07 16:30:25.339: I/GATE(19189): <GATE-M>DEV_ACTION_COMPLETED</GATE-M>
11-07 16:30:25.339: V/MainActivity.WebChromeClient(19189): ON_PROGRESS_CHANGED: 100
11-07 16:30:25.339: I/MainActivity.WebViewClient(19189): PAGE_FINISHED: http://92.53.45.42/ 
```**

# java - 如何使文件可从 JPanel 中拖出？

> ID：11635855
> 
> 赞同：0
> 
> 时间：2012-07-24T17:07:02.793
> 
> 标签：java, swing, file, drag-and-drop, jpanel

我正在尝试制作一个允许用户将文件拖到窗口上的程序，然后它将在他们放置它的地方绘制他们的图标/名称。我有这个工作。我唯一的问题是我希望用户能够将文件拖出它（它会在中间做一些事情）。所以他们可以继续拖着一堆文件，然后把它们取下来（我也希望它看起来像它应该的那样，下图）。我相信如果您将文件选择器中的项目从其中拖出，它会做我想要的，我只是不确定他们是如何做到的。

这是我将文件拖到面板上的示例：（ [来源：][[gyazo.com](http://gyazo.com/66910f1a4065b2a4111ede192bbd3028.png?1343149174)][）][![](../Images/947eb9ce442b63ecb281533110b7f407.png)](https://i.stack.imgur.com/8ewr2.png)

我希望能够做同样的事情，但要拖延。有谁知道该怎么做？我正在使用 DragAndDrop 侦听器来检测用户何时将文件拖到它上面，我想我应该能够进行相反的排序，以某种方式将我的文件放到拖放处理程序上。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:34:15.613

不久前我自己想出来了，我想我会在这里为任何想要它的人发布答案；必须创建我自己的扩展 JLabel 的类（我使用 JLabel 来显示图标），它实现了 Transferable、DragSourceListener 和 DragGestureListener，当然还覆盖了所需的方法。花了一段时间来解决所有的问题，但让它起作用了:)

# c# - 从 Windows 窗体运行 .exe 应用程序

> ID：11635856
> 
> 赞同：8
> 
> 时间：2012-07-24T17:07:03.513
> 
> 标签：c#, vb.net, windows-forms-designer, visual-c#-express-2010

我有一个在命令提示符下运行的应用程序，如下所示：

```
C:\some_location> "myapplication.exe" headerfile.h 
```

我想创建一个 Windows 窗体应用程序，用户可以在其中指定可执行文件的位置以及头文件，以便 Windows 窗体应用程序可以为他/她执行此操作，而用户不必转到命令行并去做。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-24T17:09:06.990

您需要使用[`Process`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)该类：

```
Process.Start(@"C:\some_location\myapplication.exe"); 
```

对于参数：

```
ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = @"C:\some_location\myapplication.exe";
startInfo.Arguments = "header.h";
Process.Start(startInfo); 
```

显然，您可以从文本框中提取这些名称/参数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T17:11:12.260

您可以尝试使用以下代码：

```
ProcessStartInfo startInfo = new ProcessStartInfo("yourExecutable.exe");

startInfo.Arguments = "header.h"; // Your arguments

Process.Start(startInfo); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-20T13:52:35.963

请参阅*[ProcessStartInfo.UseShellExecute](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo.useshellexecute?redirectedfrom=MSDN&view=netframework-4.8#System_Diagnostics_ProcessStartInfo_UseShellExecute)*。此页面将为您提供有关 .exe 进程信息的完整信息。

我使用的另一种方法是：

```
ProcessStartInfo objProcess = new ProcessStartInfo(@"Yours .exe path");
objProcess.UseShellExecute = false;
objProcess.RedirectStandardOutput = true;
Process.Start(objProcess); 
```

它工作正常。

# python - 如何在 heroku cedar 上安装 scikit-learn？

> ID：11635857
> 
> 赞同：6
> 
> 时间：2012-07-24T17:07:10.763
> 
> 标签：python, heroku, scikit-learn

[我已经使用此](https://stackoverflow.com/a/10632272/986743)答案中描述的方法成功安装了 numpy 和 scipy 。然后我想添加 scikit-learn，所以一开始我尝试添加`scikit-learn==0.11`到 requirements.txt，当推送到 heroku 时，我收到一条错误消息：

```
ImportError: liblapack.so.3gf: cannot open shared object file: No such file or directory 
```

所以我已经添加到`LD_LIBRARY_PATH`我拥有的路径中，`liblapack.so.3gf`但后来我得到了这个：

```
ImportError: libgfortran.so.3: cannot open shared object file: No such file or directory 
```

我相信heroku没有fortran编译器，但也许我错了。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T14:50:43.600

基于这些指示，我刚刚在 heroku 上完成了 scikit-learn 的安装。我很高兴看到不需要获取自定义二进制文件，但是设置一些环境就可以了:)

您可以在我的 wyn buildpack 的 fork 中找到额外的自定义步骤： [https ://github.com/ToonTimbermont/heroku-buildpack-python](https://github.com/ToonTimbermont/heroku-buildpack-python)

关键是为 LD_LIBRARY_PATH 设置正确的值： `export LD_LIBRARY_PATH=$(pwd)/vendor/lib:$(pwd)/vendor/lib/atlas- base:$(pwd)/vendor/lib/atlas-base/atlas`

我还将这些路径添加到 heroku 配置中： `heroku config:add LD_LIBRARY_PATH=/app/.heroku/vendor/lib/atlas-base/atlas:/app/.heroku/vendor/lib/atlas-base:/app/.heroku/vendor/lib/`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-27T02:34:39.343

另一个不错的选择是[conda buildpack](https://github.com/kennethreitz/conda-buildpack)，它允许您将通过 Anaconda/Miniconda 提供的任何免费 Linux64 包添加到 Heroku 应用程序。一些最受欢迎的软件包包括 numpy、scipy、scikit-learn、statsmodels 和 pandas。虽然 buildpack 使得将包添加到应用程序变得相当简单，但缺点是 buildback 占用了大量空间，并且您必须等待 Anaconda 更新存储库中的库。

如果您在 Heroku 上启动一个新的 Python 应用程序，您可以使用以下命令添加 conda buildpack：

```
$ heroku create YOUR_APP_NAME --buildpack https://github.com/kennethreitz/conda-buildpack.git 
```

如果您已经在 Heroku 上设置了 Python 应用程序，则可以使用以下命令将 conda buildpack 添加到现有应用程序：

```
$ heroku config:add BUILDPACK_URL=https://github.com/kennethreitz/conda-buildpack.git 
```

或者，如果您需要按名称指定应用程序：

```
$ heroku config:add BUILDPACK_URL=https://github.com/kennethreitz/conda-buildpack.git --app YOUR_APP_NAME 
```

要使用 buildpack，您需要在 app 目录中包含两个文本文件，requirements.txt 和 conda-requirements.txt。就像标准的 Python buildpack 一样，requirements.txt 文件列出了应该使用 pip 安装的包。conda-requirements.txt 文件中列出了应使用 conda 安装的软件包。一些最有用的科学软件包包括 numpy、scipy、scikit-learn、statsmodels、pandas 和 cvxopt。可以在[repo.continuum.io](https://repo.continuum.io/pkgs/free/linux-64/index.html)找到可用 conda 包的完整列表。

例如：

```
$ cat requirements.txt
gunicorn==0.14.2
requests==0.11.1

$ cat conda-requirements.txt
scipy
numpy
cvxopt 
```

而已！您现在可以将 Anaconda 包添加到 Heroku 上的 Python 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:10:55.103

您也许可以在应用程序本身中打包您需要的所有库，但更优雅的解决方案是在 git 上克隆[Heroku Python Buildpack](https://github.com/heroku/heroku-buildpack-python/)，并对其进行修改以包含这些库。然后，您可以指示您的应用程序使用修改后的 buildpack 和`--buildpack`命令行客户端上的标志。

编辑：我最初没有点击其他答案，但听起来您已经在使用自定义 buildpack。您正在使用的 buildpack 具有各种[自定义步骤](https://github.com/wyn/heroku-buildpack-python/tree/master/bin/steps)，可下载[自定义二进制文件](https://github.com/wyn/npscipy-binaries)。二进制文件在 64 位 Debian 下编译。

您应该能够剖析 buildpack 正在使用的其他自定义二进制文件之一，以找出可以使用的二进制文件`--prefix`并`./configure`构建所需的额外库。这并不容易或不方便，但它应该与 numpy 和 scipy 的工作方式相同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-06-12T17:34:33.430

如果您像我一样来到这里，在安装 scikit learn 时遇到问题并出现错误，

```
ImportError: numpy is not installed.
scikit-learn requires numpy >= 1.11.0. 
```

您需要做的是检查本地/开发环境的版本，并在部署时使用该特定版本，甚至是 python 版本。

`pip freeze`如 zenpoy 或以下所述使用。

```
import scipy
import sklearn
import numpy

print(scipy.__version__)
print(sklearn.__version__)
print(numpy.__version__) 
```

将此版本专门添加到`requirements.txt`

```
scipy==1.4.1
scikit-learn==0.22.2.post1
numpy==1.19.5 
```

在`heroku`设置[Python 运行时](https://devcenter.heroku.com/articles/python-runtimes)，将`runtime.txt`文件添加到应用程序的根目录，声明要使用的确切版本号：

```
python-3.7.10 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-24T21:38:01.613

我在 Python3 上为此创建了一个 buildpack：[https ://github.com/dwnld/heroku-buildpack-python3-sklearn](https://github.com/dwnld/heroku-buildpack-python3-sklearn)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-06-24T15:58:39.140

使用 conda buildpack 并将“nomkl”添加到 conda-requirements.txt 文件以减小 slugsize。

# php - 使用 PHP 连接 MySQL 并插入 $Variables

> ID：11635860
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:07:25.950
> 
> 标签：php, mysql

这段代码不起作用 - 它说我在 ** 行上有意外的 T_STRING 错误..它真的让我很烦恼..它可能是基本的，但我有点菜鸟，所以任何帮助都会很棒！

```
<?php

$dbhost = 'localhost';
$dbname = 'main';
$dbuser = 'root';
$dbpass = '';
$tbl_name="business";

$country = $_POST['country'];
$name = $_POST['name'];
$business_name= $_POST['business_name'];
$address1= $_POST['address1'];
$address2= $_POST['address2'];
$city= $_POST['city'];
$county= $_POST['county'];
$zip= $_POST['zip'];
$phone = $_POST['phone'];
$web_address = $_POST['web_address'];
$email= $_POST['email'];
$password=$_POST['password'];
$open= $_POST['open'];
$closed= $_POST['closed'];
$description=$_POST['description']

**mysql_connect("$dbhost", "$dbuser", "$dbpass") or die (mysql_error());**
mysql_select_db("$dbname") or die (mysql_error());

$sql_insert = "INSERT INTO $tbl_name VALUES                      ('','$country','$name','$business_name','$address1','$address2','$city','$county','$zip','$    phone','$web_address','$email','$password','$open','$closed','$description');";
$result=mysql_query($sql_insert);
$rows = mysql_num_rows($result);

if($result){
echo "Successful";
echo "<BR>";
}

else {
echo "ERROR";
}

mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:08:39.633

你需要添加一个`;`之后`$description=$_POST['description']`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:08:40.097

错误是缺少分号来关闭此行：

`$description=$_POST['description']`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:08:37.070

这是因为您在前面的代码行中缺少分号：

```
$description=$_POST['description'] 
```

PHP 错误消息倾向于给出解析器注意到问题的行号，而不是问题发生的位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T17:08:45.040

这里缺少分号...

```
$closed= $_POST['closed'];
$description=$_POST['description']; <------

**mysql_connect("$dbhost", "$dbuser", "$dbpass") or die (mysql_error());**
mysql_select_db("$dbname") or die (mysql_error()); 
```

# mysql - 左连接中的 MySQL 选择 where 子句的问题

> ID：11635868
> 
> 赞同：0
> 
> 时间：2012-07-24T17:08:14.593
> 
> 标签：mysql

我有一个订单项目和一个零件表，我将加入零件 ID 外键：

```
SELECT orderID,qty,minorder 
FROM 
  orderitem 
LEFT JOIN 
  parts 
ON orderitem.partID=parts.partID 
WHERE orderitem.orderID='2128' AND qty < minorder 
```

当我执行此查询时，我没有得到任何结果。[当我`qty < minorder`从 where 子句中删除时，我得到以下内容。](http://i.stack.imgur.com/EIGB2.png)

我正在尝试制作此查询，以便获得第二条记录（其中数量小于次要记录）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:15:13.023

在我上面的评论中，如果您的数据类型是字符串，只需将其添加到您的查询中......

```
select orderID,qty,minorder from orderitem left join parts ON orderitem.partID=parts.partID where orderitem.orderID='2128' AND (0+qty) < (0+minorder) 
```

通过向字符串添加数字，它将隐式转换为数字并执行预期的比较。

# actionscript-3 - 你如何从另一个班级访问一个班级？

> ID：11635873
> 
> 赞同：0
> 
> 时间：2012-07-24T17:08:21.530
> 
> 标签：actionscript-3

我有两节课；我的 Main 类和一个名为 BlockPlace 的类。我想使用我的 Main 类来运行 BlockPlace，但由于某种原因它不起作用。我已经尝试更改这两个代码，但它只会导致错误。我知道代码有效，因为我在时间轴上对其进行了测试。我应该重组整个事情还是有不同的解决方案？这是我的课程：

**主类：**

```
package  
{  
    import flash.display.*;
    import source.map.*;

    public class Main extends MovieClip{
        public function Main()  
        {  
            BlockPlace();
        }  
    }  
} 
```

**街区：**

```
package source.map{

    import flash.display.MovieClip;
    import flash.display.Stage;

    public class BlockPlace extends MovieClip{

        public function BlockPlace(){
            var db:MovieClip = new dbox();
            stage.addChild(db);
            db.x = stage.stageWidth / 2;
            db.y = stage.stageHeight / 2;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:45:27.877

我可以看到您有几个问题，这可以解释您所看到的行为。

首先，您调用 this 就像是一个函数，而不是构造函数。

如果你想静态引用这个函数，那么你想稍微改变一下：

```
package source.map{

    import flash.display.Stage;

    public class BlockPlace {
        public static function create(stage:Stage){
            var db:MovieClip = new dbox();
            stage.addChild(db);
            db.x = stage.stageWidth / 2;
            db.y = stage.stageHeight / 2;
        }
    }
} 
```

然后使用以下命令调用它：

```
BlockPlace.create(stage); 
```

请注意，该类不再扩展 MovieClip，并且该方法被标记为静态，这意味着它可以直接从该类中引用，而无需该类的实例。另请注意，函数签名已更改。它现在接受一个从外部传入的参数——舞台。

使用这种方法，您将引用从您的`Main`实例到此实用程序函数的阶段来做一些工作。这可能是解决您的问题的最直接的解决方案。

* * *

相反，如果您想将其保留为扩展 MovieClip 的类——这意味着一些含义——那么您需要实例化该类的一个实例：

```
var blockPlace:BlockPlace = new BlockPlace(); 
```

然后，你需要把它放在圣人身上：

```
this.addChild(blockPlace); 
```

但是舞台上仍然存在一些鸡/蛋问题。当您实例化该类时，您在其构造函数中引用该`stage`属性。然而，在它的建造的这一点上，它还没有被添加到任何`DisplayObjectContainers`与舞台相连的人身上。所以`stage`属性将是`null`。因此，您无法向舞台添加任何内容或获取`stageHeight`or `stageWidth`。

您需要等到这种情况发生——直到`addChild(blockPlace)`得到评估才会发生。

因此，您需要重新考虑一下您的架构，您可以将逻辑移动到另一个函数中，一旦您确定它已附加到舞台上，您将显式调用该函数。就像是：

```
package source.map{

    import flash.display.Stage;

    public class BlockPlace {
        public function BlockPlace() {

        }

        public function initialize():void {
            var db:MovieClip = new dbox();
            stage.addChild(db);
            db.x = stage.stageWidth / 2;
            db.y = stage.stageHeight / 2;
        }
    }
} 
```

然后使用类似的东西消费：

```
var blockPlace:BlockPlace = new BlockPlace();
addChild(blockPlace);
blockPlace.initialize(); // safe to call because its on the stage now given that `this` is on the stage 
```

* * *

然而，更惯用的方法是使用事件等到将 MovieClip 添加到舞台上，然后执行一些工作。例如：

```
package source.map{

    import flash.display.Stage;

    public class BlockPlace {
        public function BlockPlace() {
            this.addEventListener(Event.ADDED_TO_STAGE, stageAvailable);

        }

        private function stageAvailable(e:Event):void {
            var db:MovieClip = new dbox();
            stage.addChild(db);
            db.x = stage.stageWidth / 2;
            db.y = stage.stageHeight / 2;
        }
    }
} 
```

请注意，构造函数现在设置了一个事件侦听器，该侦听器说：“当我被添加到舞台时，去做另一个名为 . 的函数中的工作`stageAvailable`。”

您必须注意一些小注意事项，显示对象可以直接在舞台上构建——flash IDE 就是这样做的。所以事件不会为这些项目触发，因为当事件被附加时，它已经在舞台上，因此不会触发。最防御的写法是这样的：

```
package source.map{

    import flash.display.Stage;

    public class BlockPlace {
        public function BlockPlace() {
            if(stage) stageAvailable()
            else this.addEventListener(Event.ADDED_TO_STAGE, stageAvailable);

        }

        private function stageAvailable(e:Event = null):void {
            if(event) this.removeEventListener(Event.ADDED_TO_STAGE, stageAvailable);
            var db:MovieClip = new dbox();
            stage.addChild(db);
            db.x = stage.stageWidth / 2;
            db.y = stage.stageHeight / 2;
        }
    }
} 
```

In the constructor, it checks to see if there is a stage, and if so then it immediately calls the function. If not, then it sets up a listener to wait until that happens. Then in the handler, if it was called because of an event, then clean up after itself and remove the listener.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:17:39.573

改变：

`BlockPlace();`

到：

`var blockPlace:BlockPlace = new BlockPlace();`

您需要实际实例化它。

# ios - UIImagePickerController 模块化替换

> ID：11635874
> 
> 赞同：5
> 
> 时间：2012-07-24T17:08:28.167
> 
> 标签：ios, facebook-graph-api, picasa, flickr, photolibrary

我正在寻找 UIImagePickerController 的替代品，它允许对本地图片、公共 API（如 Facebook/Flickr/Tumblr/Picasa/SmugMug）和自定义专有图片集（本地或国外）进行自定义扩展。

到目前为止我发现的解决方案以及它们的问题：

## [http://picture.io/photopickerplus](http://picture.io/photopickerplus)

这几乎是完美的，除了我被迫使用 getchute.com 的 3rd 方服务 - 如果这个网站永久变暗会发生什么？并且所有权限对话框都将“Chute”列为应用程序名称。我的应用在其他地方使用 Facebook SDK，所以我想使用我现有的 APP id/key。当我通过 chute 应用程序控制面板添加它时，我收到 Facebook API 错误“无效的 redirect_uri：应用程序配置不允许给定 URL”。我可以用 Facebook API 修复它，但是如果 A. 我知道 URL 是什么（我不知道），并且 B. 我真的可以接受 API 请求的中间人（我不知道）。

它也非常具有 ARC 敌意，这是一个可以运行的 PITA。

## [https://github.com/arturgrigor/AGImagePickerController](https://github.com/arturgrigor/AGImagePickerController)

UIImagePickerController 的非常好的替代品，包括多选。没有内置的模块化来支持 Facebook 或其他 API。

## [https://github.com/jeena/JPImagePickerController](https://github.com/jeena/JPImagePickerController)

仅 UIImagePickerController 的简单替换 - 似乎没有可导航的视图。没有明显的模块化。

## [https://github.com/facebook/three20/](https://github.com/facebook/three20/)

看起来很复杂。由于显而易见的原因，非 Facebook 服务无法很好地发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-22T23:00:20.820

[https://github.com/mrdavenz/CaptureSessionManager](https://github.com/mrdavenz/CaptureSessionManager) 有使用 AVCamera 创建您自己的照片选择器的示例代码。您可以以此为起点。[请参阅http://www.musicalgeometry.com/?p=1297](http://www.musicalgeometry.com/?p=1297)上的博客

# python - 使用关键字 cwd 打开导致 Windows 错误 2

> ID：11635883
> 
> 赞同：0
> 
> 时间：2012-07-24T17:09:05.447
> 
> 标签：python, windows

我有一段代码接受用户提供的可执行文件或批处理文件的路径。我拆分路径以获取文件名和路径（尾部和头部），并将头部用作新进程的当前工作目录。如果路径不包含目录，则可以正常工作。但是，如果确实如此，我会收到以下错误：

```
WindowsError: [Error 2] The system cannot find the file specified 
```

示例代码：

```
def poop(self, path_to_program):
    head, tail = path.split(path_to_program)
    if(head.startswith('"')):
        head = head.strip('"')

    if(tail.endswith('"')):
        tail = tail.strip('"')                

    if(head<>''):
        p = Popen(tail, cwd=head, shell=False)
    else:
        p = Popen(tail) 
```

如果`path_to_program`没有拆分并直接传递给 Popen，它可以正常工作。

不知道出了什么问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:19:56.980

从文档中：

> 如果 cwd 不为 None，则子进程的当前目录将在执行之前更改为 cwd。请注意，搜索可执行文件时不考虑此目录，因此您不能指定程序相对于 cwd 的路径。

发生的事情是`cwd`执行可执行文件的目录。它**不是**子进程查找可执行文件的目录。你可能想要的是：

```
p = Popen(path_to_program, cwd=head, shell=False) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:22:33.797

Popen的[Python 文档对 cwd 参数进行了说明：](http://docs.python.org/library/subprocess.html#popen-constructor)

> 请注意，搜索可执行文件时不考虑此目录，因此您不能指定程序相对于`cwd`.

所以我认为在`head`不是空字符串的情况下，您需要将 Popen 称为：

```
p = Popen(path_to_program, cwd=head, shell=False) 
```

# jquery - 如何使用 Jquery 中的 enter 键来浏览表单元素

> ID：11635893
> 
> 赞同：2
> 
> 时间：2012-07-24T17:09:51.657
> 
> 标签：jquery, javascript-events

我知道有几个条目已经在处理这类问题，我也看过不少，但似乎没有一个适合我的情况。对此的任何帮助将不胜感激。

我所拥有的是一个动态生成的表单（可以有不同数量的输入）。我需要使用我的回车键来浏览它们。目前标签键标签通过元素很好，但我的标准要求我启用输入键。当我到达最终输入并按下回车键时，它需要执行当前通过 a 标签完成的提交操作

下面是我的 HTML 表单以及处理按键事件的 JS 的代码片段

```
<div class="credential_form">
<div class="error_msg">
    <h4>There was a problem connecting.</h4>
</div>
<div class="credential_inputs">
    <div class="txt_wrapper">
        <input type="text" style="width: 130px">
    </div>
    <div class="txt_wrapper">
        <input type="password" style="width: 130px; display: none;" class="real">
    </div>
    <div class="clear"></div>
</div>
<div class="add_button">
    <a class="button" href="javascript:void(0)"><span>Add</span></a>
</div>
<div class="clear"></div>
<div class="sub_input">
    <div class="link">
        <span class="sub_text">Forget your details? Go to&nbsp;</span>
        <a class="sub_link" href="http:somewhere.com">Somewhere</a>
    </div>
</div>
</div> 
```

由于某种原因，我的集合变量无法识别 if 条件中的当前元素。

```
var code = (event.keyCode ? event.keyCode : event.which);

if (code == 13) {

var $inputs = $(event.target).closest('.credential_inputs').children($(':input:visible'));
var $addButton = $(event.target).closest('.credential_form').children($('a:first-child'));

if ( $(event.target) == $inputs[$inputs.length - 1] ) {
    $addButton.click()
} else {
    $(event.target).closest(".credential_inputs").nextAll('input:first').focus();
}
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:17:15.827

[`.is()`](http://api.jquery.com/is/)在您的比较中使用。

```
if( $(event.target).is($inputs.last()) ) { ... } 
```

虽然，您可能想要检查匹配元素（`$inputs`和`$addButton`）的匹配表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:20:55.723

你需要使用`find()`而不是孩子

```
var $inputs = $(event.target).closest('.credential_inputs').find(':input:visible'); 
```

> .children() 方法与 .find() 的不同之处在于 .children() 仅沿 DOM 树向下移动一个级别，而 .find() 也可以向下遍历多个级别以选择后代元素（孙子等）。

这意味着它`$('.credential_inputs').children()`只会返回您的`.txt_wrapper`div，而不会进一步遍历。

# java - XYDotRenderer 工具提示不起作用

> ID：11635898
> 
> 赞同：0
> 
> 时间：2012-07-24T17:10:07.630
> 
> 标签：java, tooltip, jfreechart

我正在使用 JFreeChart 进行绘图。默认情况下`XYLineAndShapeRenderer`可以显示工具提示。如果我将其更改为 a `XYDotRenderer`，工具提示就会消失。我错过了什么吗？这是代码片段

```
JFreeChart chart = ChartFactory.createTimeSeriesChart(
    "Test Prices","time","price",dataset,true,true,false);

XYPlot plot = (XYPlot)chart.getPlot();
XYDotRenderer renderer = new XYDotRenderer();
renderer.setDotHeight(10);
renderer.setDotWidth(10);
renderer.setLegendItemToolTipGenerator(
    new StandardXYSeriesLabelGenerator("ToolTip {0}"));
plot.setRenderer(renderer); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:26:30.287

从您的代码段中不清楚您是否需要项目工具提示或图例工具提示；我将解决这两个问题：

*   与 不同`XYLineAndShapeRenderer`，`XYDotRenderer`不包括对图表实体的支持，这是项目工具提示所必需的。

*   图例工具提示正常工作。

    ```
    XYSeriesLabelGenerator legendGenerator = new StandardXYSeriesLabelGenerator();
    renderer.setLegendItemToolTipGenerator(legendGenerator); 
    ```

# php - 自动化 xml 导入的正确方法是什么

> ID：11635903
> 
> 赞同：1
> 
> 时间：2012-07-24T17:10:22.467
> 
> 标签：php, xml, web-services

我编写了一个脚本，通过从源磁盘中选择数据并通过按钮提交将数据从 xml 文件导入 mysql 数据库。但是，如果要使用 3rd 方应用程序来自动执行此导入会怎样。检查xml路径的get参数是否存在并获取其内容并以我以前的方式导入是否合适？还是有更好的方法？

通过获取参数我的意思是这样的：

```
http://domain.com/import.php?path=externaldomain.com/xml/page.xml 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:26:21.590

这取决于您要导入的数据类型。如果您从 rss 提要导入数据，则此方法很好。但是，如果您要导入个人数据，这可能不是一个好方法。

如果您正在处理其他人不应该看到的关键数据，我会建议更安全的东西。您可以开始考虑通过 ftp 导入 xml 文件，从服务器安全文件夹后面下载它们。要求第 3 方应用程序将 xml 文件上传到您选择的安全位置。在某种安全性背后发生的任何事情都比建议的个人数据方法更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T20:26:21.013

首先，我建议您使用`cURL`. 无论您的 XML 有多大，内存问题都会减少。

```
$fp = fopen('/var/www/vhosts/my.com/xml/feed.xml', 'w'); // opening file handler to write feed in

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://domain.com/xml/page.xml'); // setting URL to take XML from
curl_setopt($ch, CURLOPT_ENCODING, 'gzip'); // If result is gziped
curl_setopt($ch, CURLOPT_SSLVERSION, 3); // OpenSSL issue
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);  // Wildcard certificate
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 0); // disabling buffer output, bec. we want to write XML to the file first and don't need it to be returned into variable
curl_setopt($ch, CURLOPT_FILE, $fp); // here we should transfer opened file handler to the cURL and it should be writable!
$result = curl_exec($ch); // executing download
$reponse_code = (int)curl_getinfo($ch, CURLINFO_HTTP_CODE); // retrieving HTTP return code for our request. Was it successful or not. 
```

因此，即使 XML 提要在 SSL 和 GZIPed 之后，您也可以直接下载/保存到文件中。

使用`curl_getinfo()`您可以获得有关您的请求的各种信息。**如果程序应该是自动化的，那么在请求失败**时决定做什么会更好。

比，如果文件不大（*我的意思是超过 200 - 300 Mb 的非常大的文件*），您可以使用`SimpleXML`（*仅从 PHP5 开始可用*）库并解析您的数据。如果您在 PHP4 下（*今天仍然可以*）尝试找到`libXML`也非常有用的。

如果您检索的文件相当大:) 具有`FILE`权限的 MySQL 数据库是您的朋友。

# java - 我什么时候在 Java 中使用类变量与实例变量？

> ID：11635907
> 
> 赞同：0
> 
> 时间：2012-07-24T17:10:46.937
> 
> 标签：java, oop, instance-variables, class-variables

这是我定义的一个泛型类，我想知道的是，当我创建更具体的类时，例如 CAR 类，我什么时候使用类变量？我个人对类变量的理解是，已经在类中声明的类变量的单个副本将使用关键字static来声明，并且从该类中实例化的每个对象都将包含该类的单个副本多变的。

实例变量允许从该类创建的类/对象的每个实例都具有每个对象的实例变量的单独副本？

因此，实例变量对于定义类/数据类型的属性很有用，例如 House 会有一个位置，但是现在我什么时候可以在 House 对象中使用类变量？或者换句话说，在设计类时类对象的正确用途是什么？

```
public class InstanceVaribale {
public int id; //Instance Variable: each object of this class will have a seperate copy of this variable that will exist during the life cycle of the object.
static int count = 0; //Class Variable: each object of this class will contain a single copy of this variable which has the same value unless mutated during the lifecycle of the objects.

InstanceVaribale() {
    count++;

}
public static void main(String[] args) {

    InstanceVaribale A = new InstanceVaribale();
    System.out.println(A.count);
    InstanceVaribale B = new InstanceVaribale();
    System.out.println(B.count);
    System.out.println(A.id);
    System.out.println(A.count);
    System.out.println(B.id);
    System.out.println(B.count);    
    InstanceVaribale C = new InstanceVaribale();
    System.out.println(C.count);
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T17:14:33.463

> 我个人对类变量的理解是，已经在类中声明的类变量的单个副本将使用关键字static来声明，并且从该类中实例化的每个对象都将包含该类的单个副本多变的。

不，不是“每个对象都包含一个副本”。静态变量与*类型*相关联，而不是与类型的每个实例相关联。*实例*根本没有变量。

确实只有一个变量（假设您只从一个类加载器加载它） ，*但*该类型的实例有很多。没有实例？还是一个变数。一百万个实例？还是一个变数。

静态变量对常量或常量类似物最有用——比如记录器，或“有效价格集”等。在应用程序过程中不会改变的东西。根据我的经验，它们几乎总是应该`final`存在的，并且类型应该是不可变的类型（如`String`）。在可能的情况下，对静态变量也使用不可变集合——或者确保变量是私有的，并且你永远不会在类中改变集合。

您应该*避免*使用静态变量来存储全局变化状态。它使代码更难测试和推理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:31:16.527

**1.**每个`object of the class`人都有**自己的实例变量副本**，它的`One per Object.`

**2.**但是`static variable`会被**类的所有对象共享**，它的`One per Class.`

**3.**现在我将举两个例子，这两个例子很重要。

**实例变量：**

考虑一个游戏程序，然后每个玩家将有**不同的名称、分数、武器威力、达到的阶段等......**

**静态变量：**

考虑一个银行程序，其中每个客户都将获得**一个 ID，该 ID 比前一个更大且唯一**，因此静态变量将适用于此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T00:23:34.607

静态变量用于存储在类的所有实例之间共享的值。

如果不是这种情况，它应该是一个实例变量。

# python - Python 子进程允许用户交互

> ID：11635909
> 
> 赞同：1
> 
> 时间：2012-07-24T17:10:50.467
> 
> 标签：python, fortran, subprocess

我正在尝试从 python 脚本运行一些学生 FORTRAN 程序。这些程序不是按任何特定顺序编写的，通常依赖于简单的 FORTRAN`read(*,*)`命令。一个简单的程序可以是：

```
program main
    implicit none
    real :: p,t
    write(*,*)'Enter p'
    read(*,*)p
    write(*,*)'Enter t'
    read(*,*)t
    write(*,*)p,t
end program main 
```

此代码暂停并允许用户根据提示输入某些信息。我想通过使用 subprocess Popen 命令来实现类似的功能。脚本在运行之前不知道输入是什么，甚至不知道它们是否需要发生。

目前，对于没有必要输入的程序，以下脚本有效：

```
p = sub.Popen('./file',stdout=sub.PIPE,stderr=sub.PIPE,stdin=sub.PIPE,shell=True)
output,error = p.communicate() 
```

有没有办法让脚本运行器在程序运行时在终端中输入数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:18:50.473

看起来你想使用[`pexpect`](http://pypi.python.org/pypi/pexpect/)：

```
import pexpect
child = pexpect.spawn('student_program')
while child.expect('Enter (\w+)\r\n', pexpect.EOF) == 0:
    if child.match[1] == 'p':
        child.sendline('3.14159') 
```

要将程序的交互控制传递给用户，请使用`child.interact()`.

# sql-server - 如何在服务器上更新 SSIS 包

> ID：11635918
> 
> 赞同：1
> 
> 时间：2012-07-24T17:11:46.127
> 
> 标签：sql-server, ssis, bids

我已经更新了 BIDS 2005 中的包（我更改了备份例程以保存到不同的驱动器），现在我正试图将它恢复到服务器上（2005 年）。我尝试了 File > Save Copy As... 然后运行了执行包的作业，它仍然保存到旧驱动器，因此，我的包没有被保存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:17:10.150

在我看来，始终使用您的 SSIS 项目创建一个部署实用程序。这是在项目属性下配置的（见下文）。配置项目部署实用程序后，转到您的项目，找到“bin”文件夹并双击部署实用程序。我将引导您非常轻松地将您的包裹放到服务器上。

![SSIS 项目属性](../Images/5a73ef478054242fd265b82543e1ce33.png)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:44:41.217

快速而肮脏的答案是使用[dtutil](http://msdn.microsoft.com/en-us/library/ms162820.aspx)

```
dtutil /file C:\Src\MyPackage.dtsx /destserver thatDatabase /COPY SQL;MyPackage 
```

我也是清单文件的粉丝，但是，虽然对于您的问题可能有点矫枉过正，但我​​更喜欢使用允许无人值守使用的工具。我将 ssisdeploymanifest 与 PowerShell 脚本结合起来处理所有 SSIS 部署。

[Powershell SSIS 部署和维护](http://billfellows.blogspot.com/2011/08/powershell-ssis-deployment-and.html)

# javascript - 如何将自定义属性传递给函数？

> ID：11635920
> 
> 赞同：10
> 
> 时间：2012-07-24T17:11:55.117
> 
> 标签：javascript, html, onchange

```
<select data-myattr="123" id="cboTest" 
        onchange="SayHello(this.data-myattr)"> 
```

这行不通。如果我把它取`data-`下来，它会起作用，但从我读过的内容来看，这样做是 html5 安全的。但是，这样做，我得到：**"Microsoft JScript runtime error: 'myattr' is undefined"**。

这是我的超级复杂功能：

```
function SayHello(msg) {
    alert(msg);
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T17:15:10.967

试试这样：

```
<select data-myattr="123" id="cboTest" 
        onchange="SayHello(this.getAttribute('data-myattr'))"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:15:33.587

表达方式：

> onchange="SayHello(this.data-myattr)">

被解释为`this.data` *减号* `myattr`。你必须使用：

```
onchange="SayHello(this.getAttribute('data-myattr'))" 
```

反而。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:17:39.303

[`getAttribute()`](https://developer.mozilla.org/en/DOM/element.getAttribute)应该做的事情

[这是一个例子](http://jsfiddle.net/M4aXH/)：

```
<select data-myattr="123" id="cboTest" 
onchange="SayHello(this.getAttribute('data-myattr'))">
    <option>1</option>
    <option>2</option>
</select> 
```

另外，我会尽量避免使用内联脚本，因为它们会使 HTML 变得混乱。请改用[`addEventListener`](https://developer.mozilla.org/en/DOM/element.addEventListener)/ [`attachEvent`](http://msdn.microsoft.com/en-us/library/ie/ms536343%28v=vs.85%29.aspx)（旧 IE）。

# java - 关于具有多个视图的单个模型的操作实施和使用的不确定性

> ID：11635924
> 
> 赞同：1
> 
> 时间：2012-07-24T17:12:20.650
> 
> 标签：java, swing, model-view-controller

我是一个关于 GUI 编程的新手，也许我的问题有一个非常简单的解决方案。我正在尝试实现一个 Java Swing GUI，它充当树状数据结构的编辑器。GUI分为三个部分：

1.  窗口左侧四分之一的树查看器显示树结构数据。

2.  右上角的大区域显示包含文本字段、表格等的编辑器。树结构中的每种不同类型的对象都有自己的编辑器，当在树查看器中选择它时会显示该编辑器。

3.  右下方区域显示了一个控制台查看器。它用于显示有关特定操作的消息。

我正在努力遵守模型与程序中树查看器/编辑器中的可视化的严格分离。因此，我创建了一个 DefaultTreeModel (MyTreeModel) 子类的实例，它存储对业务数据的引用，以及一个 JTree 子类的实例，它提供了树结构的可视化表示。

我正在尝试实现使用 Action 类修改数据的功能。任何动作（如 CreateNode、RenameNode、DeleteNode）都在它自己的动作类（AbstractAction 的子类）中实现。这些操作在树查看器的上下文菜单和应用程序“编辑”菜单中使用。但我也想在 GUI 的编辑器部分重用其中的一些，例如 RenameNode 操作。在这里，我目前被困住了。

树查看器显示一个图标以及树中每个节点的名称。除其他内容外，相应的编辑器还包含一个显示关联节点名称的 JTextField。

我知道我可以使用 setAction 方法将操作对象附加到 JMenu、JPopupMenu 甚至 JTextField 对象。我这样做了，现在我在程序的“编辑”菜单中有一个“重命名”菜单条目，在与代表树查看器的 JTree 关联的弹出菜单中，显示节点名称的 JTextField 也附加了此操作。

为了更改树节点的“名称”属性，我创建了类 RenameNode 作为 AbstractAction 的子类。如前所述，名称显示在树查看器中的每个节点上，并且该操作只是使该文本可编辑。执行此操作的代码如下所示（在 RenameNode 类中）：

```
public void actionPerformed(ActionEvent ev) {
    // "mouseOverPath" is the Treepath were the mouse was placed on
    // when the popup menu was opened
    if (tree.existsMouseOverPath()) {
        tree.startEditingAtPath(tree.mouseOverPath);
    } else if (tree.getSelectionCount() != 0) {
        tree.startEditingAtPath(tree.getSelectionPath());
    }
} 
```

需要这些 if 语句才能使操作正常工作：

-- 弹出菜单（第一个 if 语句；这里打开弹出菜单时鼠标下的对象可编辑）

-- 应用程序的菜单（第二个 if 语句；这里当前选择的树节点 -- 如果有的话 -- 可编辑）。

嗯，这工作正常，原则上但实际上节点的重命名不是通过 RenameAction 类的 actionPerformed(ActionEvent ev) 方法中的代码完成的。节点名称的真正更改是在树的 MyTreeModel 类中的 valueForPathChanged() 方法中执行的，该方法被覆盖如下：

```
public class MyTreeModel extends DefaultTreeModel {

[...]

    @Override
    public void valueForPathChanged(TreePath path, Object newValue) {
    final MyTreeNode aNode = (MyTreeNode)path.getLastPathComponent();
    if (newValue instanceof String) {
        ((MyNode) aNode.getUserObject()).setName((String) newValue);
    } else {
        aNode.setUserObject(newValue);
    }
        nodeChanged(aNode);
    }

[...]

} 
```

我完全不知道如何在这里正确应用动作的概念。更糟糕的是执行重命名操作更改 JTextField 对象中的文本时的情况。目前我不知道如何以干净的方式实现它。JTextField 应与树模型结构中的单个节点作为其模型关联，并且附加的操作应修改该模型，并且当此模型更改时，树查看器需要得到通知以更新树查看器中相应节点的名称。

我假设 MyNode 类（它一直是 DefaultMutableTreeNode 的子类）必须实现接口 Document 并且 RenameAction 类必须修改它，然后必须发出一个事件来通知显示改变节点。

底线：我必须承认我还没有完全理解如何正确实现要在 GUI 中的多个位置使用的操作，并且我不完全理解如何实现可以被多个 GUI 对象使用的模型（在我的例子中是一个 JTree 和一个 JTextField）。可能这一切都很简单......

提前感谢您的帮助！

那么给出的答案对于解释如何将动作与 JTrees 一起使用非常有帮助。但还有一点我想讨论。在我的 GUI 中，我有一个业务数据的树表示与数据的编辑器相结合（树位于窗口的左四分之一处，旁边是一个节点类型特定的编辑器）。所有节点都有可以更改的名称。并且，编辑器包含一个文本字段（使用 JTextField 实现），其中显示了节点的名称并且也可以进行编辑。我的不确定性如下： JTextField 允许为它分配一个动作对象和一个模型。实际上，该模型将是已在 JTree 中查看的节点对象。我认为应该有一种方法可以使用 JTree 中使用的相同模型对象，也可以作为编辑器中 JTextField 的模型，并在那里重用 Action 类。关于模型的重用，我认为我的模型类 MyTreeNode 也必须实现 Document 接口，对吗？当启动节点特定的编辑器时，我必须使用其 setDocument() 方法将 JTree 中当前选择的节点与 JTextField 对象相关联。最后，我的 RenameNodeAction 必须更改 JTextField 的节点名称。所以我的中心点是：让一个模型显示在多个视图中，并在要重命名节点的任何地方重用一个 RenameAction。这有意义吗？我的想法是如何实现的？关于模型的重用，我认为我的模型类 MyTreeNode 也必须实现 Document 接口，对吗？当启动节点特定的编辑器时，我必须使用其 setDocument() 方法将 JTree 中当前选择的节点与 JTextField 对象相关联。最后，我的 RenameNodeAction 必须更改 JTextField 的节点名称。所以我的中心点是：让一个模型显示在多个视图中，并在要重命名节点的任何地方重用一个 RenameAction。这有意义吗？我的想法是如何实现的？关于模型的重用，我认为我的模型类 MyTreeNode 也必须实现 Document 接口，对吗？当启动节点特定的编辑器时，我必须使用其 setDocument() 方法将 JTree 中当前选择的节点与 JTextField 对象相关联。最后，我的 RenameNodeAction 必须更改 JTextField 的节点名称。所以我的中心点是：让一个模型显示在多个视图中，并在要重命名节点的任何地方重用一个 RenameAction。这有意义吗？我的想法是如何实现的？d 必须使用其 setDocument() 方法将 JTree 中当前选择的节点与 JTextField 对象相关联。最后，我的 RenameNodeAction 必须更改 JTextField 的节点名称。所以我的中心点是：让一个模型显示在多个视图中，并在要重命名节点的任何地方重用一个 RenameAction。这有意义吗？我的想法是如何实现的？d 必须使用其 setDocument() 方法将 JTree 中当前选择的节点与 JTextField 对象相关联。最后，我的 RenameNodeAction 必须更改 JTextField 的节点名称。所以我的中心点是：让一个模型显示在多个视图中，并在要重命名节点的任何地方重用一个 RenameAction。这有意义吗？我的想法是如何实现的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T21:28:59.503

超出 Stackoverflow 范围的应用程序设计完整指南。相反，从[*如何使用树*](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)`TreeIconDemo`中显示的示例开始。请注意它如何添加 a以更新附近的. 现在，将另一个添加到不同的视图中，看看如何更新新视图。您还可以从这个相关的[答案](https://stackoverflow.com/a/3072979/230513)中获得一些见解。[](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)*`TreeSelectionListener``tree``JEditorPane``TreeSelectionListener`*

 *附录：从这个[例子](https://stackoverflow.com/a/11113648/230513)开始，你可以做如下的事情。更改选择会更新`textField`以显示所选节点的名称。编辑节点（通常是`F2`）或`textField`更改所选节点的名称。

```
private JTextField textField = new JTextField(10);
...
final DefaultTreeModel treeModel = new DefaultTreeModel(root);
tree = new JTree(treeModel);
tree.addTreeSelectionListener(new TreeSelectionListener() {

    @Override
    public void valueChanged(TreeSelectionEvent e) {
        TreePath path = e.getNewLeadSelectionPath();
        if (path != null) {
            DefaultMutableTreeNode node =
                (DefaultMutableTreeNode) path.getLastPathComponent();
            if (node.isLeaf()) {
                Resource user = (Resource) node.getUserObject();
                textField.setText(user.toString());
            } else {
                textField.setText("");
            }
        }
    }
});
textField.addActionListener(new AbstractAction("edit") {

    @Override
    public void actionPerformed(ActionEvent e) {
        TreePath path = tree.getSelectionPath();
        if (path != null) {
            DefaultMutableTreeNode node =
                (DefaultMutableTreeNode) path.getLastPathComponent();
            if (node.isLeaf()) {
                String s = textField.getText();
                Resource user = (Resource) node.getUserObject();
                user.setName(s);
                treeModel.reload(node);
            }
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T23:17:30.843

不完全确定，但我认为你正在寻找这样的东西

```
public class RenameNode extends AbstractAction
        implements TreeSelectionListener, CellEditorListener { 

    // Replace with whatever you're storing your text fields with
    private FieldStorage fields;

    private JTree tree;

    public RenameNode(FieldStorage fields, JTree tree) {
        this.fields = fields;
        this.tree = tree;
    }

    public void actionPerformed(ActionEvent ev) {
        // "mouseOverPath" is the Treepath were the mouse was placed on
        // when the popup menu was opened
        if (tree.existsMouseOverPath()) {
            tree.startEditingAtPath(tree.mouseOverPath);
        } else if (tree.getSelectionCount() != 0) {
            tree.startEditingAtPath(tree.getSelectionPath());
        }
    }

    public void valueChanged(TreeSelectionEvent e) {
        tree.startEditingAtPath(tree.getSelectionPath());
        setFieldText();
    }

    public void editingCanceled(ChangeEvent e) {
        // empty
    }

    public void editingStopped(ChangeEvent e) {
        setFieldText();
    }

    private void setFieldText() {
        MyTreeNode node = (MyTreeNode) tree.getSelectionPath()
                .getLastPathComponent();
        String text = node.getUserObject().toString();
        fields.getFieldFor(node).setText(text);
    }

} 
```

然后当你初始化你的树时添加

```
RenameNode renameNodeAction = new RenameNode(fields, tree);
tree.addTreeSelectionListener(renameNodeAction);

// editor is your TreeCellEditor. Can be the DefaultTreeCellEditor
// if you haven't already made your own
editor.addCellEditorListener(renameNodeAction);
tree.setCellEditor(editor);
tree.setEditable(true); 
```

这将使您的树编辑与您的字段同步。

顺便说一句，我喜欢你很好地遵守 MVC。而且，你的设计听起来很复杂。您可能想重新考虑一些功能，使其更精简。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T21:19:34.903

哇，好详细啊！谢谢！

`JTable`好的，我对's（插入/删除行）做了类似的事情。

本质上，您想要`Action`一个可以引用 a 的`JTree`. 然后`Action`可以将其提供给您的文件菜单、弹出菜单和分配给击键的事件。如果你超级高效地编写代码，可以共享相同的操作，但这不是必要的要求。

你想要做的是让视图和模型做他们设计的事情，你的行动只是启动过程的催化剂。

所以基本上你可以做类似的事情：

```
public class RenameNodeAction extends AbstractAction {

    private JTree tree;
    public RenameNodeAction(JTree tree) {
        this.tree = tree;

        // Initialise action as you require...
    }

    // Access to the tree, provide mostly so you can extend the action
    public JTree getTree() {
        return tree;
    }

    public void actionPerformed(ActionEvent evt) {

        JTree tree = getTree();
        TreePath path = tree.getSelectionPath();
        if (path != null && tree.isPathEditable(path)) {
            tree.startEditingAtPath(path);
        }

    }
} 
```

为了让它更高级一点，您可以将 a 附加`TreeSelectionListener`到提供的树并`enabled`根据选择更改操作的状态。

因此，当没有选择任何内容时，您将禁用该操作，如果所选内容不可编辑，您将禁用选择等。

这意味着（正如您正确地尝试实现的那样）是实现此目标的代码是集中的和可重用的。`JButtons`您可以对文件菜单、工具栏按钮、弹出菜单和击键应用相同的操作（相同的实例或多个实例），并确保为每个执行相同的代码。*

# android - 如何与半透明 Android 应用程序背后的元素进行交互？

> ID：11635934
> 
> 赞同：14
> 
> 时间：2012-07-24T17:13:27.297
> 
> 标签：android

我已经找到了如何为我的 android 应用程序创建半透明背景，但到目前为止我还没有找到如何与它背后的内容（例如主屏幕）进行交互。

[这篇文章](http://www.41post.com/4213/programming/android-transparent-or-translucent-view-background)帮助我使应用程序视图半透明。

如何让用户与半透明应用程序背后的内容进行交互？ [这个应用程序](http://techcrunch.com/2012/02/06/transparent-screen-android-app-lets-you-text-and-walk-without-fear/)是一个很好的例子，它允许这是“透明屏幕”Android 应用程序。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-24T17:29:59.153

理解视图堆叠的一个非常简单的方法是拿一本书（任何书）。将每个页面视为一个视图。

能见度

*   当您打开这本书时，您可以看到一个页面（主视图 - `VISIBLE`）
*   翻到当前页面可以看到下一页( `INVISIBLE`- Main View 显示下一个视图。记住你只是隐藏视图，如果你设置可见性到`GONE`这里就相当于撕掉当前页面来查看下一页.)

触控场景

*   假设您的第一页是蜡页（类似于您的半透明视图的半透明页面），因此您可以看到底层页面
*   当您尝试触摸第二页上的图形时，尽管您可以在第二页上看到图形，但您正在触摸第一页。不可能通过第一页触摸到第二页上的图形。

不要灰心，因为这是您将要处理的观点而不是论文，您仍然可以做您想做的事情:)

*   `View.OnTouchListener`为您的两个视图实施
*   对于半透明视图您获得的任何触摸事件，请`FALSE`在方法中返回`onTouch`
*   Android 会将触摸事件传递给您的底层视图。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-11-12T09:33:28.307

我得到了答案。`getWindow().addFlags(WindowManager.LayoutParams.FLAG_NOT_TOUCHABLE);` 在第二个顶级活动的 onCreate 中添加行（这是透明的）。

上面的解决方案有问题。使用以上整个窗口后，将触摸传递到背景。因此，如果您想要完全控制，那么最好扩展一个布局，例如 Framelayout 并覆盖“onTouchEvent”，并使用 event.getX() 和 event.getY() 方法获取触摸位置，并在您想要传递触摸事件的地方返回 false。它将被传递给父视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-05T03:12:06.160

[FLAG_NOT_TOUCH_MODAL](https://stuff.mit.edu/afs/sipb/project/android/docs/reference/android/view/WindowManager.LayoutParams.html#FLAG_NOT_TOUCH_MODAL)会用最少的代码做你想做的事。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL);
    ...
    setContentView(R.layout.my_activity_view);
    ...
} 
```

> 公共静态最终 int FLAG_NOT_TOUCH_MODAL
> 
> 窗口标志：即使此窗口可聚焦（其 {@link FLAG_NOT_FOCUSABLE 未设置），也允许将窗口外的任何指针事件发送到其后面的窗口。否则它将消耗所有指针事件本身，无论它们是否在窗口内。

# grails - grails 重新加载类运行时

> ID：11635936
> 
> 赞同：0
> 
> 时间：2012-07-24T17:13:40.280
> 
> 标签：grails, grails-controller

我开始修改从其他人创建的 grails 应用程序。我不明白为什么当我尝试使用*run-app*并修改控制器时，grails 不会在运行时重新加载它。我必须停止并重新启动它，这非常令人沮丧。
我正在使用正常的*开发*环境。
操作系统 Ubuntu 11.10，Grails 2.0.1
有人可以帮我理解为什么吗？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T15:35:35.297

问题是 Eclipse (STS)，当您从那里修改类但从控制台执行 run-app 它不会重新加载，它只是从 eclipse 执行 run-app

# ruby-on-rails - 添加 SSL 证书后 Apache + Passenger + Rails 不提供资产

> ID：11635939
> 
> 赞同：3
> 
> 时间：2012-07-24T17:13:45.117
> 
> 标签：ruby-on-rails, apache, ssl, asset-pipeline, production-environment

在添加 SSL 证书和使用 force_ssl 之前，我的 Rails 服务器一直运行良好，以至于它既不会完全验证（即站点仅部分加密），也不会加载任何资产。加载的只是一个静态 html 页面——带有工作链接，但仅此而已。

有没有人遇到过这个问题？

**更新**

这是我在 production.log 中得到的堆栈跟踪（有几个，这只是单个请求的一个示例）

```
Started GET "/internal-nginx-static-locationassets/slide2.png" for 129.21.79.202 at 2012-07-24 10:18:39 -0700

ActionController::RoutingError (No route matches [GET] "/internal-nginx-static-locationassets/slide2.png"):
  vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:26:in `call_app'
  vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:16:in `call'
  vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/request_id.rb:22:in `call'
  vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
  vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
  vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
  vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
  vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
  vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'
  vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'
  vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
  vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:479:in `call'
  vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:220:in `call'
  vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/rack/request_handler.rb:96:in `process_request'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_request_handler.rb:516:in `accept_and_process_next_request'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_request_handler.rb:274:in `main_loop'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/classic_rails/application_spawner.rb:321:in `start_request_handler'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/classic_rails/application_spawner.rb:275:in `block in handle_spawn_application'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/utils.rb:470:in `safe_fork'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/classic_rails/application_spawner.rb:270:in `handle_spawn_application'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server.rb:180:in `start'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/classic_rails/application_spawner.rb:149:in `start'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/spawn_manager.rb:219:in `block (2 levels) in spawn_rails_application'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server_collection.rb:132:in `lookup_or_add'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/spawn_manager.rb:214:in `block in spawn_rails_application'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server_collection.rb:82:in `block in synchronize'
  <internal:prelude>:10:in `synchronize'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server_collection.rb:79:in `synchronize'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/spawn_manager.rb:213:in `spawn_rails_application'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/spawn_manager.rb:132:in `spawn_application'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/spawn_manager.rb:275:in `handle_spawn_application'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
  /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/helper-scripts/passenger-spawn-server:99:in `<main>' 
```

# c# - 在 C# 中使用参数委托给其他线程

> ID：11635940
> 
> 赞同：1
> 
> 时间：2012-07-24T17:13:50.843
> 
> 标签：c#, windows, multithreading

如何将带参数的函数委托给 C# 中的其他线程？

如果我自己尝试，我会收到此错误：

```
error CS0149: Method name expected 
```

这就是我现在所拥有的：

```
delegate void BarUpdateDelegate();
    private void UpdateBar(int Value,int Maximum,ProgressBar Bar)
    {
        if (Bar.InvokeRequired)
        {
            BarUpdateDelegate Delegation = new BarUpdateDelegate(Value, Maximum, Bar); //error CS0149: Method name expected
            Bar.Invoke(Delegation);
            return;
        }
        else
        {
            Bar.Maximum = Maximum;
            Bar.Value = Value;

            //Insert the percentage
            int Percent = (int)(((double)Value / (double)Bar.Maximum) * 100);
            Bar.CreateGraphics().DrawString(Percent.ToString() + "%", new Font("Arial", (float)8.25, FontStyle.Regular), Brushes.Black, new PointF(Bar.Width / 2 - 10, Bar.Height / 2 - 7));

            return;
        }
    } 
```

我想从另一个线程更新主线程中的进度条。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:17:35.287

您不使用参数初始化委托：

```
BarUpdateDelegate Delegation = new BarUpdateDelegate(Value, Maximum, Bar); //error CS0149: Method name expected
Bar.Invoke(Delegation); 
```

相反，将这些参数传递给`Invoke`.

```
BarUpdateDelegate delegation = new BarUpdateDelegate(UpdateBar);
Bar.Invoke(delegation, Value, Maximum, Bar); 
```

您还需要在委托定义中指定这些参数。但是，有一种更简单的方法，使用内置的`Action<...>`委托。我还做了一些其他的代码改进。

```
private void UpdateBar(int value, int maximum, ProgressBar bar)
{
    if (bar.InvokeRequired)
    {
        bar.Invoke(new Action<int, int, ProgressBar>(UpdateBar),
                   value, maximum, bar);
    }
    else
    {
        bar.Maximum = maximum;
        bar.Value = value;

        // Insert the percentage
        int percent = value * 100 / maximum;
        bar.CreateGraphics().DrawString(percent.ToString() + "%", new Font("Arial", 8.25f, FontStyle.Regular), Brushes.Black, bar.Width / 2 - 10, bar.Height / 2 - 7);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:15:38.203

这不是有效的代码：

```
BarUpdateDelegate Delegation = new BarUpdateDelegate(Value, Maximum, Bar); 
```

请参阅[MSDN Delegates 文档](http://msdn.microsoft.com/en-us/library/ms173171%28v=vs.100%29.aspx)作为起点。

# facebook - 无需按钮即可显示 Facebook 点赞

> ID：11635942
> 
> 赞同：0
> 
> 时间：2012-07-24T17:13:54.563
> 
> 标签：facebook, facebook-like

我正在尝试显示我在 Facebook 上的点赞数，但没有丑陋的按钮。有没有办法在没有任何图像的情况下获得喜欢的数量，以便我可以将 css 应用于数量并将其显示在我的主网页上？

那里的开发人员页面似乎没有我能找到的任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:35:53.533

向图形 API 发出 http 请求：

[https://graph.facebook.com/](https://graph.facebook.com/) {your-page-name-or-id}

它将返回一个包含此页面信息的 json 对象。您可以在浏览器上进行测试。一个例子：

[https://graph.facebook.com/cocacola](https://graph.facebook.com/cocacola)

返回：

```
{
   "id": "40796308305",
   "name": "Coca-Cola",
   "picture": "http://profile.ak.fbcdn.net/hprofile-ak-snc4/174560_40796308305_2093137831_s.jpg",
   "link": "https://www.facebook.com/coca-cola",
   "likes": 45669549,
   "cover": {
      "cover_id": "10151829640053306",
      "source": "http://a8.sphotos.ak.fbcdn.net/hphotos-ak-ash3/s720x720/529413_10151829640053306_446360541_n.jpg",
      "offset_y": 0
   },
   "category": "Food/beverages",
   "is_published": true,
   "website": "http://www.coca-cola.com",
   "username": "coca-cola",
   "founded": "1886",
   "description": "Created in 1886 in Atlanta, Georgia, by Dr. John S. Pemberton, Coca-Cola was first offered as a fountain beverage at Jacob's Pharmacy by mixing Coca-Cola syrup with carbonated water. \n\nCoca-Cola was patented in 1887, registered as a trademark in 1893 and by 1895 it was being sold in every state and territory in the United States. In 1899, The Coca-Cola Company began franchised bottling operations in the United States. \n\nCoca-Cola might owe its origins to the United States, but its popularity has made it truly universal. Today, you can find Coca-Cola in virtually every part of the world.",
   "about": "The Coca-Cola Facebook Page is a collection of your stories showing how people from around the world have helped make Coke into what it is today.",
   "checkins": 106,
   "talking_about_count": 671246
} 
```

它也适用于个人资料（返回的信息不同）、应用程序和任何 facebook 对象！这仅返回公共信息。如果您想检索私人信息（可能是图片或帖子），您需要获取 OAuth 令牌并将其传递给 Graph API

如果您需要更多信息，请查看开发人员帮助中的 OAuth 和 Open Graph API。（https://developers.facebook.com/docs/opengraph/tutorial/）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T20:27:11.797

```
$pageContent = file_get_contents('http://graph.facebook.com/YOURPAGENAMEHERE');
$parsedJson  = json_decode($pageContent);
$likes = $parsedJson->likes;
echo $likes; 
```

I have this one running myself. Keep in mind that you do this with a cronjob and store it in your database because it is quite slow.

# iis - 将用户添加到不在 IIS_WPG 组中的 DefaultAppPool

> ID：11635945
> 
> 赞同：0
> 
> 时间：2012-07-24T17:14:03.277
> 
> 标签：iis, windows-server-2003, application-pool

我的问题有两个：

1.  需要一个用户帐户来写入不在 IIS_WPG 组中的 inetpub/wwwroot
2.  将 DefaultAppPool 帐户更改为 #1 中的指定用户帐户

我们不能从 Windows 读取的默认匿名用户帐户从服务器 B 向服务器 A 进行匿名 HTTP 写入，因此对于 #2。由于上述服务器权限，我们也不能让 IIS_WPG 组对 inetpub/wwwroot 进行任何写入。

我创建了一个新用户帐户，但它没有与任何组关联。然后，我将此用户添加到 DefaultAppPool 身份，而不是使用网络服务。然后，在 Inetpub/wwwroot 下，我授予了该用户帐户的读/写权限。然后我重新启动 w3svc。

当我尝试查看日志中包含此错误的任何网页时，我现在收到服务不可用错误：*启动服务应用程序池“DefaultAppPool”的进程时遇到故障。应用程序池已被禁用。*

**注意**：无论如何，我都不是 Windows 管理员，所以我所做的是基于我能找到的任何文章，并且 100% 相信它们的准确性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T16:07:38.490

IIS_WPG 组的全部意义在于对运行应用程序池所需的权限进行预设分组。所以最好的情况是创建新用户，然后将该用户添加到 IIS_WPG 组。

如果你不能这样做，那么我相信你必须明确地为你的新用户提供与 IIS_WPG 相同的权限集。可以在这里找到：http: [//support.microsoft.com/kb/812614](http://support.microsoft.com/kb/812614)

# iphone - 使用 NSKeyedArchiver 读写，ios

> ID：11635948
> 
> 赞同：1
> 
> 时间：2012-07-24T17:14:16.320
> 
> 标签：iphone, nskeyedarchiver

下面是一个使用nsarchive读写数据的类

**数据.m**

```
-(id)init {
    self        =   [super init];
    if(self) {
        arr     =   [[NSMutableArray alloc] init];
    }
    return self;
}

-(NSString *)getPath {
    NSArray     *paths          =   NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString    *documentPath;

    if ([paths count] > 0)
        documentPath            =   [paths objectAtIndex:0];

    NSString *draftDataPath     =   [documentPath stringByAppendingPathComponent:@"draftData.dat"];
    return draftDataPath;
}

-(void)saveDataToDisk {
    NSString *path              =   [self getPath];
    [NSKeyedArchiver archiveRootObject:arr toFile:path];

}

-(void)loadDataFromDisk {
    NSString    *path           =   [self getPath];
    self.arr                    =   [NSKeyedUnarchiver unarchiveObjectWithFile:path];
} 
```

稍后，我`arr`通过 CustomerClass.m添加一些对象

```
- (void) viewDidLoad {

Data *data = [[Data alloc] init];
[data.arr addObject:myObject1]
[data.arr addObject:myObject2]
[data.arr addObject:myObject3]
[data saveDataToDisk];
} 
```

在 DisplayData.m，我想通过以下方式检查 data.arr

```
- (void) viewDidLoad {
   Data *data = [[Data alloc] init];
   [data loadDataFromDisk];

   NSLog(@"length of array is %d",[data.arr count]);

} 
```

在控制台上，我得到

```
length of array is 1 
```

我认为它应该是3毕竟。

如果您有任何线索，请指出我在工作中犯的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:56:28.197

所以，我怀疑你的“myObjects”不符合 NSCoding。我只是这样做了：

```
NSMutableArray *arr = [NSMutableArray arrayWithCapacity:3];
[arr addObject:@"Hello"];
[arr addObject:@" "];
[arr addObject:@"World"];
BOOL ret = [NSKeyedArchiver archiveRootObject:arr toFile:[self getPath]];

NSArray *arr2 = [NSKeyedUnarchiver unarchiveObjectWithFile:[self getPath]];
NSLog(@"count = %d", [arr2 count]); 
```

结果是“count = 3”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T17:31:01.510

我觉得这里有太多代码来做你正在寻找的东西。我想你需要的只是：

```
[[NSUserDefaults standardUserDefaults] setObject:[NSKeyedArchiver archivedDataWithRootObject:dataClass] forKey:NSUserDefaultString];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

保存它。

和：

```
NSData *someData = [[NSUserDefaults standardUserDefaults] objectForKey:NSUserDefaultString];
if (settingsData != nil)
{
    dataClass = [NSKeyedUnarchiver unarchiveObjectWithData:settingsData];
} 
```

检索它。

# vim - Vim 在文件完成中忽略路径名

> ID：11635957
> 
> 赞同：0
> 
> 时间：2012-07-24T17:15:09.493
> 
> 标签：vim

假设我`/tmp`在 vim 中打开了两个文件：`test.txt`和`tmpfile.txt`. 现在我想删除`tmpfile.txt`缓冲区。我打字`:bd tm``TAB`。我想要的行为是让它自动完成`tmpfile.txt`；我得到的行为是 and 的列表`tmpfile.txt`，`/tmp/test.log`因为它会自动完成目录名和文件名。我怎样才能让 vim 表现得像我想要的那样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T19:18:43.010

这是不可能的，该列表来自缓冲区列表中的内容，而不是来自您的本地路径，您可以在任何地方（：pwd），没关系，当您按 Tab 时，结果来自内存列表，这就是 /tmp 出现的原因，因为如果你在 /tmp 上，/tmp 不应该再次出现。

如果您查看 :help :bd 它需要 bufname 作为参数，而不是 fname 作为 :badd

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T07:59:41.557

改为用于`^tm`匹配文件名的开头。（你必须在 /tmp 中才能工作，这样相对路径就是文件名。）

# iphone - 苹果新验证控制器的异步部分有必要吗？

> ID：11635961
> 
> 赞同：5
> 
> 时间：2012-07-24T17:15:14.973
> 
> 标签：iphone, objective-c, ios, ipad, in-app-purchase

我在这里查看了 Apple 的应用内购买验证控制器补丁：[https ://developer.apple.com/library/ios/#releasenotes/StoreKit/IAP_ReceiptValidation/_index.html](https://developer.apple.com/library/ios/#releasenotes/StoreKit/IAP_ReceiptValidation/_index.html)

我正计划实施服务器验证，但不需要立即响应。

他们的新代码的异步部分是绝对必要的吗？与幼稚的服务器端验证相比，它有什么优势吗？

如果我可以使用即时解析和检查并获得好处，那就太好了。

谢谢！

编辑：没有一些代码，这个问题感觉有点空：

我专门谈论将主要的 verifyPurchase 函数更改为仅包含：

```
- (BOOL)verifyPurchase:(SKPaymentTransaction *)transaction;
{
    return [self isTransactionAndItsReceiptValid:transaction];
} 
```

...并摆脱客户端-> 服务器帖子。我是否仍然容易受到最近的黑客攻击？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T13:17:25.323

查看代码后，您的问题更有意义。

有问题的攻击是有人出示了*其他人的*有效收据。收据数据中似乎没有任何内容将其与设备/购买者联系起来。您可以通过检查购买日期在一定程度上缓解这种情况（但*前提*是设备有准确的时间，这在用户的控制之下）。

*（如果客户端*生成必须与收据匹配的 256 位随机随机数，则此攻击将不起作用。攻击者显然可以破解二进制/PRNG，但在任何一种情况下，您都已经丢失了。）

顺便说一句，代码有很多问题：

*   服务器证书的唯一检查是它是 EV 证书。这应该很容易伪造，因为攻击者完全控制了 CA。
*   在网络检查完成之前，交易 ID 会永久添加到“已看到”交易列表中`-isTransactionAndItsReceiptValid:`，但内容只有在网络返回后才会解锁。如果连接失败，收据将永远无法重新验证，因此用户的钱实际上会进入一个黑洞。
*   它期望事务发生在验证它的同一设备上。
*   它期望 ITC_CONTENT_PROVIDER_SHARED_SECRET 嵌入到可执行文件中（用越狱设备解密很简单）。
*   它假定`-connection:didReceiveData:`返回完整的收据数据（由于碎片可能不是这种情况，但由于 Apple 控制服务器实现，因此可能可以保证）。

# java - java单元测试可以像.NET那样隐藏生产代码的接缝接口吗？

> ID：11635962
> 
> 赞同：2
> 
> 时间：2012-07-24T17:15:16.080
> 
> 标签：java, unit-testing

正如我从单元测试的艺术中读到的，知道 .NET 可以隐藏用于在生产运行时进行测试的接缝方法。（第 78 页~第 80 页）。如，

```
public class LogAnalyzer
{
...
internal LogAnalyzer (IExtensionManager extentionMgr)
{
manager = extentionMgr;
}
} 
```

像这样跑。

```
using System.Runtime.CompilerServices;
[assembly:
InternalsVisibleTo("AOUT.CH3.Logan.Tests")] 
```

所以 LogAnalyzer() 只能为测试类调用，不用担心为了可测试性而在生产代码上增加额外的成本。经过简要调查，似乎 Java 没有等效的功能。但是Java有替代品吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:25:18.680

实现你自己的自定义[`ClassLoader`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ClassLoader.html)怎么样？您可以定义自己的注释，如果它加载具有注释的类，则`@HideFromProductionCode`让您的自定义`ClassLoader`抛出异常`@HideFromProductionCode`。请参阅[如何将我的自定义类加载器设置为默认值？](https://stackoverflow.com/questions/3801714/how-to-set-my-custom-class-loader-to-be-the-default)

或者，只需在构建过程中添加一个脚本，该脚本会遍历所有已编译的生产代码并查找`@HideFromProductionCode`注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:47:21.053

一种相当直接的方法是使用类似 Maven 的目录结构，为生产代码和测试代码使用单独的目录（通常在名为`src/main`and的目录下`src/test`）。运行单元测试时，类路径包括主目录和测试目录。但是当您构建部署在生产环境中的 JAR 时，只包含在主目录中定义的类；这样，引用测试类的生产代码将导致编译错误。

# c# - 如何拥有超过 1 个多对多关系

> ID：11635966
> 
> 赞同：2
> 
> 时间：2012-07-24T17:15:27.690
> 
> 标签：c#, visual-studio-2010, entity-framework, entity-framework-4, devart

我的问题很简单，但我似乎无法让 EF 了解我的数据库架构（Oracle）。

**问题**

我想建模**超过 1** MM 的关系见下图：

![在此处输入图像描述](../Images/1a0d49713109e222d7d08efce38fbcb1.png)

正如你所看到的，我有一本书和一本日记——我想通过使用链接表（联结表、交集表，你明白了！）来存储这两者的 URI。在这种情况下，我想针对 Journal 16 和 Book 75 存储它恰好是“www.google.com”，它们将以蓝色标记的以下格式存储在链接表中。为了完整起见，我为 ID 为 5 的链接添加了一个绿色示例。所以你可以看到数据是如何结合在一起的，我想你会同意这没什么太疯狂的。

无论如何，当我尝试更新 EF 模型时，它会抱怨（在 Visual Studio 中）出现类似的错误。

> 从第 210 行开始映射片段时出现问题：从表 REF_URI (REF_ID) 到表 JOURNALs (REF_ID) 的外键约束“REF_URI_JOURNAL_FK1”：表 REF_URI 的列映射到 AssociationSet BOOK_URISet 的 End BOOKs 但表 JOURNALs 的键列未映射到与此 End 对应的 EntitySet BOOKs 的键。

是的 - 没有真正得到那个错误信息！
我可以让 EF 处理 1 MM 关系，例如

![在此处输入图像描述](../Images/78d3792dec3b89ed6180726d6bd2e6b8.png)

这一切都有效，“hunky dory”，但是当我添加第二个 MM 关系时，它因上面的错误消息而崩溃，例如

![在此处输入图像描述](../Images/fa34302967f5cef7b3a3f6b6ecbed961.png)

任何人都知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T21:28:11.780

对于*两个*多对多关系，您需要*两个*链接表（联结表、交集表）`REFBOOK_URI`和`REFJOURNAL_URI`. 我认为这就是例外以一种神秘的方式所说的。如果您只有一个表，则意味着如果 Journal 123 链接到 URI 789，那么 Book 123 也必须链接到 URI 789，因为链接表中的列对于表和表*都是*`REF_ID`不可为空的外键。*`Journal``Book`*

# java - 为什么要报错？

> ID：11635970
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:15:38.777
> 
> 标签：java, multithreading

我只是想找出为什么这段代码会引发错误。错误是：

> “线程“线程 1”java.lang.Error 中的异常”

```
class Salmon extends Thread
{
    public static long id;
    public void run()
    {
        for(int i = 0;i<4; i++){
            if(i==2&& id ==Thread.currentThread().getId()){
            //if(i==2){
                new Thread(new Salmon()).start();
                throw new Error();
             }
             System.out.println(i + " ");
          }
     }
     public static void main(String[] args)
     {
         Thread t1 = new Salmon();
          id = t1.getId();
          t1.start();
      }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T17:17:00.947

因为你告诉它。

```
 if(i==2){
          new Thread(new Salmon()).start();
          throw new Error(); // <---- 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T17:20:00.127

我认为您的问题可能会更好地说明“为什么执行会继续超出`new Thread(new Salmon()).start();`？您正在启动一个新线程。当您调用时`start()`，新线程中的`run()`方法的执行与立即返回方法之后的继续执行*并行继续。*`start()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:34:32.720

`id == Thread.currentThread().getId()`从主线程开始的第一个线程 (t1) 总是如此。

一旦`i`在该线程中达到 2，`if(i == 2 && id == Thread.currentThread().getId())`也将是 true，并且将执行以下代码：

```
new Thread(new Salmon()).start();
throw new Error(); 
```

正如已经指出的，`new Thread(new Salmon()).start();`立即返回（新创建的线程与 t1 并行运行）并且 t1 继续到下一行，这会引发异常。

# sql - 从聚合自联接创建视图

> ID：11635971
> 
> 赞同：1
> 
> 时间：2012-07-24T17:15:39.480
> 
> 标签：sql, sql-server, join, aggregate-functions, self-join

我已经工作了大约两周来为我工作的公司构建一些详细的报告选项。上周某个时候或前一周我在这里问了一个问题，这让我开始了一个查询，我最终大大加强了这个查询。

我从一个只跟踪单个交易的库存分类帐开始。目标是建立一个更全面的分类账，以保持库存总量、销售总量，如果某件商品缺货，它将跟踪补货前的天数。

初始查询使用 With ... as 语句来定义表及其聚合，然后对聚合列进行自连接。不幸的是，我不能做同样的事情来创建一个视图，所以我需要找到一种方法来不同地创建这些聚合，这仍然允许我自行加入它们以保持我的总数井井有条。

到目前为止，这是我重新整理我的陈述的方式：

```
Create View 'QLedger' as
Select tcum.txnid,
        tcum.Item, 
        tcum.TxnDate, 
        tcum.[Tran Type], 
        tcum.Quantity,
        tcum.cumq 

 from (select *, SUM( Quantity ) 
            OVER (PARTITION BY InventoryLedger.Item 
            ORDER BY InventoryLedger.TxnID
            ROWS UNBOUNDED PRECEDING ) cumq, 
            abs( 
                sum( 
                    case when [Tran Type] = 'Shipping' 
                    or [Tran Type] = 'Customer Return' 
                    then Quantity end) 
                    over (partition by qryrptInventoryLedger.item 
                            order by InventoryLedger.txnid 
                                    rows unbounded preceding)) LifeSales
            from InventoryLedger) tcum 
 left outer join InventoryLedger tcumnext
 on tcum.Item = tcumnext.Item
 and tcum.TxnID < tcumnext.TxnID 
 and
 tcum.cumq = 0 and tcumnext.cumq >0
 where tcum.Item = '103-02'
 and tcum.cumq = 0
 group by tcum.TxnID, tcum.TxnDate, tcum.Item, tcum.[tran type], tcum.Quantity 
```

这几乎是正确的，除了我自己加入的表 (tcumnext) 没有运行/累积数量列来与 tcum 进行比较。我根本不知道如何制作一个与之比较。谁能帮我吗？我真的很感激。经过这么长时间的努力，如此接近，令人兴奋和沮丧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:39:14.950

如果您已经在查询中使用 with 解决了聚合函数问题，您也可以使用视图来解决。

这是一个使用包含聚合函数的 with 子句的视图示例：

[http://social.msdn.microsoft.com/Forums/sk/sqlgetstarted/thread/302040c6-6a1b-4f99-8a1d-84bb196cb5e6](http://social.msdn.microsoft.com/Forums/sk/sqlgetstarted/thread/302040c6-6a1b-4f99-8a1d-84bb196cb5e6)

第一次发帖。

希望这会有所帮助=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:23:52.643

您可以在视图中使用*with*语句：

```
create view xxx as
    with <blah blah blah>
    select <your query> 
```

这能解决你的问题吗？

# full-text-search - sphinxsearch 中的“NOT NEAR”匹配？

> ID：11635975
> 
> 赞同：2
> 
> 时间：2012-07-24T17:15:48.747
> 
> 标签：full-text-search, sphinx

说有一些字符串，比如

```
sphinxQL> select * from rttest where match('beach');
+------+--------+---------------------------------------------+
| id   | weight | value                                       |
+------+--------+---------------------------------------------+
|   12 |   1576 | looking down on the beach from Beach Street |
|   10 |   1555 | This is a beach                             |
|   11 |   1555 | photo of Beach Street                       |
+------+--------+---------------------------------------------+ 
```

如何匹配包含“海滩”的文档，但不是当它只是“海滩街”短语的一部分时。

这类作品：

```
sphinxQL> select * from rttest where match('beach -"beach street"');
+------+--------+-----------------+
| id   | weight | value           |
+------+--------+-----------------+
|   10 |   1527 | This is a beach |
+------+--------+-----------------+ 
```

但理想情况下，我们也应该得到文件 12。因为我们也有自己的海滩。

> 从海滩街俯瞰**海滩**

仅排除短语，排除所有包含该短语的文档，无论它们是否也仅匹配单个关键字。

像'NOT NEAR'这样的东西是理想的：

```
sphinxQL> select * from rttest where match('beach -NEAR/1 street');
ERROR 1064 (42000): index rttest: syntax error, unexpected TOK_NEAR near 'NEAR/1 street' 
```

但由于我们没有，还有其他方法吗？（除了后期处理；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-31T20:05:40.463

好吧，万一有人发现了这一点，我想出了一个解决方法。发表在狮身人面像论坛上：

[http://sphinxsearch.com/forum/view.html?id=9869](http://sphinxsearch.com/forum/view.html?id=9869)

但是一个快速的总结

```
select *,weight() MOD 4 AS w from from rttest 
  where match('beach | "beach street" | "beach street" | "beach street" ') 
  and w > 0 order by w desc option ranker=wordcount;

+------+---------------------------------------------+------+
| id   | value                                       | w    |
+------+---------------------------------------------+------+
|   10 | This is a beach                             |    1 |
|   12 | looking down on the beach from Beach Street |    1 |
+------+---------------------------------------------+------+ 
```

这包括带有“海滩”的文件，不包括任何**只有****“**海滩街”的文件。

 **（因为“海滩街”匹配所有 4 个术语，4 的倍数被排除在外。如果有一个单一的海滩 - 单独或**与**短语一起，它不再是 4（例如它的 1 或 5），因此仍然包括在内. 取模运算的结果应该是有多少个单字）**

# perl - 在 Perl 中，我可以动态地将方法添加到包的一个对象吗？

> ID：11635977
> 
> 赞同：1
> 
> 时间：2012-07-24T17:15:52.817
> 
> 标签：perl, monkeypatching, www-mechanize

我正在使用[`WWW::Mechanize`](https://metacpan.org/module/WWW%3a%3aMechanize)自动化基于 Web 的后台点击我需要做的事情是让我的测试电子商务订单进入我需要它们的状态来测试我对一个长的、多部分的特定部分所做的更改工作流程。要批量处理大量订单，我需要`Home`经常点击链接。为了缩短时间，我`WWW::Mechanize`在运行时像这样破解了一个方法（基于brian d foy在*Mastering Perl中的一个示例）：*

```
{ # Shortcut to go back to the home page by calling $mech->go_home
  # I know I'll get a warning and do not want it!
  no warnings 'once';
  my $homeLink = $mech->find_link( text => 'Home' )->url_abs();
  $homeLink =~ s/system=0/system=1/;
  *WWW::Mechanize::go_home = sub {
    my ($self) = @_;
    return $self->get($homeLink);
  };
} 
```

这很好用，并且不会伤害任何人，因为我使用它的脚本仅供我使用，而不是更大系统的一部分。

但是现在我想知道是否有可能实际上只告诉一个`$mech`具有此方法的对象，而另一个`WWW::Mechanize`可能稍后创建的对象（例如，做一些交叉引用而不混淆另一个具有活动会话的对象我的后台）不能使用这种方法。

我不确定这是否可能，因为如果我了解对象在 Perl 中的工作方式，`->`操作员会告诉它`go_home`在包中查找子例程`WWW::Mechanize`并将其`$mech`作为第一个参数传递给它。如果这种理解是错误的，请纠正我。

我通过添加一种仅让原始`$mech`对象使用该功能的硬编码检查来进行实验。

```
my $onlyThisMechMayAccessThisMethod = "$mech";
my $homeLink = $mech->find_link( text => 'Home' )->url_abs();
$homeLink =~ s/system=0/system=1/;
*WWW::Mechanize::go_home = sub {
  my ($self) = @_;
  return undef unless $self eq $onlyThisMechMayAccessThisMethod;
  return $self->get($homeLink);
}; 
```

由于`"$mech"`包含存储数据的地址（例如`WWW::Mechanize=HASH(0x2fa25e8)`），因此当以这种方式进行字符串化时，另一个对象看起来会有所不同。

然而，我不相信这是要走的路。所以我的问题是：**有没有更好的方法只让`WWW::Mechanize`类的一个对象有这个方法？**我也很高兴有关此代码的其他建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:36:05.387

这只是

```
$mech->follow_link(text => 'Home') 
```

而且我认为它不够特别，不足以保证有自己的方法，或者需要限制在一个独家的对象俱乐部。

还值得注意的是，无需使用 typeglob 来在不同的包中声明子例程。例如，您只需要编写

```
sub WWW::Mechanize::go_home {
    my ($self) = @_;
    return $self->get($homeLink);
}; 
```

但一般的解决方案是子类化[`WWW::Mechanize`](http://p3rl.org/WWW%3a%3aMechanize)并仅将那些您希望拥有新方法的对象声明为成员。

* * *

文件`MyMechanize.pm`

```
package MyMechanize;

use strict;
use warnings;

use parent 'WWW::Mechanize';

sub go_home {
  my $self = shift;
  my $homeLink = $self->find_link(text => 'Home')->url_abs;
  $homeLink =~ s/system=0/system=1/;
  return $self->get($homeLink);
}

1; 
```

文件`test.pl`

```
use strict;
use warnings;

use MyMechanize;

my $mech = MyMechanize->new;
$mech->get('http://mydomain.com/path/to/site/page.html')
$mech->go_home; 
```

# scala - Scala：构建特征和类的复杂层次结构

> ID：11635981
> 
> 赞同：10
> 
> 时间：2012-07-24T17:16:11.227
> 
> 标签：scala

我最近发布了几个关于 SO 的问题，涉及 Scala[特征](https://stackoverflow.com/questions/11618915)、[表示类型](https://stackoverflow.com/questions/11277656)、[成员类型](https://stackoverflow.com/questions/11236122)、[清单](https://stackoverflow.com/questions/11284538)和[隐式证据](https://stackoverflow.com/questions/11588014)。这些问题的背后是我为生物蛋白质网络构建建模软件的项目。尽管得到了非常有用的答案，这些答案让我比我自己能得到的更接近，但我仍然没有为我的项目找到解决方案。有几个答案表明我的设计存在缺陷，这就是解决方案的原因`Foo`框架式问题在实践中不起作用。在这里，我发布了我的问题的更复杂（但仍然大大简化）的版本。我希望这个问题和解决方案对于试图在 Scala 中构建复杂的特征和类层次结构的人来说将是广泛有用的。

我项目中最高级别的课程是生物反应规则。规则描述了一种或两种反应物如何通过反应转化。每个反应物都是一个图，它具有称为单体的节点和连接单体上命名位点的边。每个站点也有一个它可以处于的状态。**编辑：边缘的概念已从示例代码中删除，因为它们使示例复杂化而对问题没有太大贡献。**一条规则可能是这样说的：有一种反应物由单体 A 组成，分别通过位点 a1 和 b1 与单体 B 结合；该键被规则破坏，使位点 a1 和 b1 未绑定；同时在单体 A 上，位点 a1 的状态从 U 变为 P。我将其写为：

```
A(a1~U-1).B(b1-1) -> A(a1~P) + B(b1) 
```

（在 Scala 中解析这样的字符串非常简单，让我头晕目眩。）这`-1`表明第 1 个键位于这些站点之间——该数字只是一个任意标签。

这是我到目前为止所拥有的内容以及我添加每个组件的原因。它可以编译，但只能无偿使用`asInstanceOf`. 如何摆脱`asInstanceOf`s 以使类型匹配？

我用一个基本类来表示规则：

```
case class Rule(
  reactants: Seq[ReactantGraph], // The starting monomers and edges
  producedMonomers: Seq[ProducedMonomer] // Only new monomers go here
) {
  // Example method that shows different monomers being combined and down-cast
  def combineIntoOneGraph: Graph = {
    val all_monomers = reactants.flatMap(_.monomers) ++ producedMonomers
    GraphClass(all_monomers)
  }
} 
```

图的类`GraphClass`具有类型参数，因为这样我就可以对特定图中允许的单体和边的种类进行限制；例如， a中不能有任何`ProducedMonomer`s 。我还希望能够对特定类型的所有s 说s。我使用类型别名来管理约束。`Reactant``Rule``collect``Monomer``ReactantMonomer`

```
case class GraphClass[
  +MonomerType <: Monomer
](
  monomers: Seq[MonomerType]
) {
  // Methods that demonstrate the need for a manifest on MonomerClass
  def justTheProductMonomers: Seq[ProductMonomer] = {
    monomers.collect{
      case x if isProductMonomer(x) => x.asInstanceOf[ProductMonomer]
    }
  }
  def isProductMonomer(monomer: Monomer): Boolean = (
    monomer.manifest <:< manifest[ProductStateSite]
  )
}

// The most generic Graph
type Graph = GraphClass[Monomer]
// Anything allowed in a reactant
type ReactantGraph = GraphClass[ReactantMonomer]
// Anything allowed in a product, which I sometimes extract from a Rule
type ProductGraph = GraphClass[ProductMonomer] 
```

单体类`MonomerClass`也有类型参数，这样我就可以对站点进行约束；例如， a`ConsumedMonomer`不能有 a `StaticStateSite`。此外，我需要`collect`特定类型的所有单体，例如，收集产品中规则中的所有单体，因此我在`Manifest`每个类型参数中添加一个。

```
case class MonomerClass[
  +StateSiteType <: StateSite : Manifest
](
  stateSites: Seq[StateSiteType]
) {
  type MyType = MonomerClass[StateSiteType]
  def manifest = implicitly[Manifest[_ <: StateSiteType]]

  // Method that demonstrates the need for implicit evidence
  // This is where it gets bad
  def replaceSiteWithIntersection[A >: StateSiteType <: ReactantStateSite](
    thisSite: A, // This is a member of this.stateSites
    monomer: ReactantMonomer
  )(
    // Only the sites on ReactantMonomers have the Observed property
    implicit evidence: MyType <:< ReactantMonomer
  ): MyType = {
    val new_this = evidence(this) // implicit evidence usually needs some help
    monomer.stateSites.find(_.name == thisSite.name) match {
      case Some(otherSite) => 
        val newSites = stateSites map {
          case `thisSite` => (
            thisSite.asInstanceOf[StateSiteType with ReactantStateSite]
            .createIntersection(otherSite).asInstanceOf[StateSiteType]
          )
          case other => other
        }
        copy(stateSites = newSites)
      case None => this
    }
  }
}

type Monomer = MonomerClass[StateSite]
type ReactantMonomer = MonomerClass[ReactantStateSite]
type ProductMonomer = MonomerClass[ProductStateSite]
type ConsumedMonomer = MonomerClass[ConsumedStateSite]
type ProducedMonomer = MonomerClass[ProducedStateSite]
type StaticMonomer = MonomerClass[StaticStateSite] 
```

我当前的实现`StateSite`没有类型参数；它是一个标准的特征层次结构，终止于具有名称和一些`String`s 代表适当的状态。（最好使用字符串来保存对象状态；它们实际上是我真实代码中的名称类。）这些特征的一个重要目的是提供所有子类所需的功能。好吧，这不就是所有特质的目的。我的特征很特别，因为许多方法对特征的所有子类共有的对象属性进行了微小的更改，然后返回一个副本。如果返回类型与对象的基础类型匹配，那将是更可取的。这样做的蹩脚方法是将所有特征方法抽象化，并将所需的方法复制到所有子类中。我不确定执行此操作的正确 Scala 方式。一些消息来源建议一种成员类型`MyType`存储基础类型（此处显示）。其他来源建议使用表示类型参数。

```
trait StateSite {
  type MyType <: StateSite 
  def name: String
}
trait ReactantStateSite extends StateSite {
  type MyType <: ReactantStateSite
  def observed: Seq[String]
  def stateCopy(observed: Seq[String]): MyType
  def createIntersection(otherSite: ReactantStateSite): MyType = {
    val newStates = observed.intersect(otherSite.observed)
    stateCopy(newStates)
  }
}
trait ProductStateSite extends StateSite
trait ConservedStateSite extends ReactantStateSite with ProductStateSite 
case class ConsumedStateSite(name: String, consumed: Seq[String]) 
  extends ReactantStateSite {
  type MyType = ConsumedStateSite
  def observed = consumed
  def stateCopy(observed: Seq[String]) = copy(consumed = observed)
}
case class ProducedStateSite(name: String, Produced: String)
  extends ProductStateSite 
case class ChangedStateSite(
  name: String, 
  consumed: Seq[String], 
  Produced: String
)
  extends ConservedStateSite {
  type MyType = ChangedStateSite
  def observed = consumed
  def stateCopy(observed: Seq[String]) = copy(consumed = observed)
}
case class StaticStateSite(name: String, static: Seq[String])
  extends ConservedStateSite {
  type MyType = StaticStateSite
  def observed = static
  def stateCopy(observed: Seq[String]) = copy(static = observed)
} 
```

我最大的问题是像`MonomerClass.replaceSiteWithIntersection`. 许多方法对类的特定成员进行一些复杂的搜索，然后将这些成员传递给对其进行复杂更改的其他函数并返回一个副本，然后在更高级别对象的副本中替换原来的。我应该如何参数化方法（或类）以便调用是类型安全的？现在我可以让代码编译只有很多`asInstanceOf`无处不在。Scala 对传递类型或成员参数的实例特别不满意，因为我可以看到两个主要原因：（1）协变类型参数最终作为任何将它们作为输入的方法的输入，以及（2）它是很难让 Scala 相信一个返回副本的方法确实返回了一个与放入的类型完全相同的对象。

毫无疑问，我留下了一些大家都不清楚的东西。如果我需要添加任何细节，或者我需要删除多余的细节，我会尽量快速清理。

**编辑**

@0__ 用`replaceSiteWithIntersection`编译时没有`asInstanceOf`. 不幸的是，我找不到在没有类型错误的情况下调用该方法的方法。他的代码本质上是这个新类中的第一个方法`MonomerClass`；我添加了调用它的第二种方法。

```
case class MonomerClass[+StateSiteType <: StateSite/* : Manifest*/](
  stateSites: Seq[StateSiteType]) {
  type MyType = MonomerClass[StateSiteType]
  //def manifest = implicitly[Manifest[_ <: StateSiteType]]

  def replaceSiteWithIntersection[A <: ReactantStateSite { type MyType = A }]
    (thisSite: A, otherMonomer: ReactantMonomer)
    (implicit ev: this.type <:< MonomerClass[A])
  : MonomerClass[A] = {
    val new_this = ev(this)

    otherMonomer.stateSites.find(_.name == thisSite.name) match {
      case Some(otherSite) =>
        val newSites = new_this.stateSites map {
          case `thisSite` => thisSite.createIntersection(otherSite)
          case other      => other
        }
        copy(stateSites = newSites)
      case None => new_this // This throws an exception in the real program
    }
  }

  // Example method that calls the previous method
  def replaceSomeSiteOnThisOtherMonomer(otherMonomer: ReactantMonomer)
      (implicit ev: MyType <:< ReactantMonomer): MyType = {
    // Find a state that is a current member of this.stateSites
    // Obviously, a more sophisticated means of selection is actually used
    val thisSite = ev(this).stateSites(0)

    // I can't get this to compile even with asInstanceOf
    replaceSiteWithIntersection(thisSite, otherMonomer)
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T14:01:36.187

我已将您的问题简化为特征，并且我开始理解为什么您会遇到强制转换和抽象类型的麻烦。

您实际上缺少的是临时多态性，您可以通过以下方式获得它： - 编写一个具有泛型签名的方法，依赖于相同泛型的隐式来委派工作 - 使隐式仅可用于该泛型的特定值参数，当您尝试执行非法操作时，它将变成“隐式未找到”编译时错误。

现在让我们按顺序来看问题。首先是您的方法的签名是错误的，原因有两个：

*   替换站点时，您希望创建新泛型类型的新单体，就像您向集合中添加作为现有泛型类型的超类的对象时所做的一样：您将获得一个类型参数为超类的新集合. 结果，您应该产生这个新的单体。

*   您不确定该操作是否会产生结果（以防您无法真正替换状态）。在这种情况下，正确的类型是 Option[T]

    ```
    def replaceSiteWithIntersection[A >: StateSiteType <: ReactantStateSite]
    (thisSite: A, monomer: ReactantMonomer): Option[MonomerClass[A]] 
    ```

如果我们现在在类型错误中查看挖掘机，我们可以看到真正的类型错误来自此方法：

```
 thisSite.createIntersection 
```

原因很简单：它的签名与您的其他类型不一致，因为它接受 ReactantSite 但您想将其作为参数之一传递给您的 stateSite （类型为 Seq[StateSiteType] ）但您无法保证那

```
StateSiteType<:<ReactantSite 
```

现在让我们看看证据如何帮助您：

```
trait Intersector[T] {
  def apply(observed: Seq[String]): T
}

trait StateSite {

  def name: String
}

trait ReactantStateSite extends StateSite {

  def observed: Seq[String]

  def createIntersection[A](otherSite: ReactantStateSite)(implicit intersector: Intersector[A]): A = {
    val newStates = observed.intersect(otherSite.observed)
    intersector(newStates)
  }
}

import Monomers._
trait MonomerClass[+StateSiteType <: StateSite] {

    val stateSites: Seq[StateSiteType]

    def replaceSiteWithIntersection[A >: StateSiteType <: ReactantStateSite](thisSite: A, otherMonomer: ReactantMonomer)(implicit intersector:Intersector[A], ev: StateSiteType <:< ReactantStateSite): Option[MonomerClass[A]] = {

      def replaceOrKeep(condition: (StateSiteType) => Boolean)(f: (StateSiteType) => A)(implicit ev: StateSiteType<:<A): Seq[A] = {
        stateSites.map {
                         site => if (condition(site)) f(site) else site
                       }
      }

      val reactantSiteToIntersect:Option[ReactantStateSite] = otherMonomer.stateSites.find(_.name == thisSite.name)
      reactantSiteToIntersect.map {
               siteToReplace =>
               val newSites = replaceOrKeep {_ == thisSite } { item => thisSite.createIntersection( ev(item) ) }
               MonomerClass(newSites)
             }

    }

  }

object MonomerClass {
  def apply[A <: StateSite](sites:Seq[A]):MonomerClass[A] =  new MonomerClass[A] {
    val stateSites = sites
  }
}
object Monomers{

  type Monomer = MonomerClass[StateSite]
  type ReactantMonomer = MonomerClass[ReactantStateSite]
  type ProductMonomer = MonomerClass[ProductStateSite]
  type ProducedMonomer = MonomerClass[ProducedStateSite]

} 
```

1.  请注意，如果您以巧妙的方式使用隐式解析规则（例如，您将昆虫放在 Intersector 特征的伴生对象中，这样它将自动解析），则可以在没有特殊导入的情况下使用此模式。

2.  虽然此模式完美运行，但存在与您的解决方案仅适用于特定 StateSiteType 的事实相关的限制。Scala 集合解决了一个类似的问题，添加了另一个隐式调用 CanBuildFrom。在我们的例子中，我们称之为 CanReact

您将不得不使您的 MonomerClass 保持不变，但这可能是一个问题（但是，为什么需要协方差？）

```
trait CanReact[A, B] {
  implicit val intersector: Intersector[B]

  def react(a: A, b: B): B

  def reactFunction(b:B) : A=>B = react(_:A,b)
}

object CanReact {

  implicit def CanReactWithReactantSite[A<:ReactantStateSite](implicit inters: Intersector[A]): CanReact[ReactantStateSite,A] = {
    new CanReact[ReactantStateSite,A] {
      val intersector = inters

      def react(a: ReactantStateSite, b: A) = a.createIntersection(b)
    }
  }
}

trait MonomerClass[StateSiteType <: StateSite] {

    val stateSites: Seq[StateSiteType]

    def replaceSiteWithIntersection[A >: StateSiteType <: ReactantStateSite](thisSite: A, otherMonomer: ReactantMonomer)(implicit canReact:CanReact[StateSiteType,A]): Option[MonomerClass[A]] = {

      def replaceOrKeep(condition: (StateSiteType) => Boolean)(f: (StateSiteType) => A)(implicit ev: StateSiteType<:<A): Seq[A] = {
        stateSites.map {
                         site => if (condition(site)) f(site) else site
                       }
      }

      val reactantSiteToIntersect:Option[ReactantStateSite] = otherMonomer.stateSites.find(_.name == thisSite.name)
      reactantSiteToIntersect.map {
               siteToReplace =>
               val newSites = replaceOrKeep {_ == thisSite } { canReact.reactFunction(thisSite)}
               MonomerClass(newSites)
             }

    }

  } 
```

有了这样的实现，当你想用不同类型的另一个站点替换一个站点时，你所需要的就是使用不同类型的 CanReact 的新隐式实例。

最后，我将（我希望）清楚地解释为什么你不需要协方差。

假设您有 a`Consumer[T]`和 a `Producer[T]`。

当您想提供给`Consumer[T1]`a `Producer[T2]`where时，您需要协方差`T2<:<T1`。但是如果需要在T1内部使用T2产生的值，可以

```
class ConsumerOfStuff[T <: CanBeContained] {

  def doWith(stuff: Stuff[T]) = stuff.t.writeSomething

}

trait CanBeContained {
  def writeSomething: Unit
}

class A extends CanBeContained {
  def writeSomething = println("hello")
}

class B extends A {
  override def writeSomething = println("goodbye")
}

class Stuff[T <: CanBeContained](val t: T)

object VarianceTest {

  val stuff1 = new Stuff(new A)
  val stuff2 = new Stuff(new B)
  val consumerOfStuff = new ConsumerOfStuff[A]
  consumerOfStuff.doWith(stuff2)

} 
```

这东西显然不能编译：

> 错误：类型不匹配；found : Stuff[B] required: Stuff[A] 注意：B <: A，但 Stuff 类在类型 T 中是不变的。您可能希望将 T 定义为 +T。(SLS 4.5) consumerOfStuff.doWith(stuff2)。

但同样，这来自对方差使用的误解，如[在设计业务应用程序时如何使用协方差和反方差？](https://stackoverflow.com/questions/5277526/real-world-examples-of-co-and-contravariance-in-scala)Kris Nuttycombe 回答解释。如果我们像下面这样重构

```
class ConsumerOfStuff[T <: CanBeContained] {

  def doWith[A<:T](stuff: Stuff[A]) = stuff.t.writeSomething

} 
```

你可以看到一切编译正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:51:32.983

不是答案，但我可以通过查看问题观察到：

*   我看到`MonomerClass`但没有`Monomer`

我的胆量说你应该尽可能避免清单，因为你已经看到它们会使事情变得复杂。我不认为你会需要它们。例如中的`justTheProductMonomers`方法`GraphClass`——既然你可以完全控制你的类层次结构，为什么不直接添加任何涉及*运行时*检查的测试方法`Monomer`呢？例如

```
trait Monomer {
   def productOption: Option[ProductMonomer]
} 
```

那么你会有

```
def justTheProductMonomers : Seq[ProductMonomer] = monomers.flatMap( _.productOption ) 
```

等等。

这里的问题是，您似乎可以拥有一个满足产品谓词的通用单体，而您却以某种方式想要 sub-type `ProductMonomer`。

我给出的一般建议是首先定义处理规则所需的测试矩阵，然后将这些测试作为方法放入特定特征中，*除非*您有一个可以进行模式匹配的平面层次结构，即更容易，因为消歧将集中在您的使用站点上，而不是分布在所有实现类型中。

也不要试图用编译时类型约束来逾期。通常在运行时检查一些约束是非常好的。这样至少你可以构建一个完全工作的系统，然后你可以尝试找出可以将运行时检查转换为编译时检查的点，并决定是否值得付出努力。在 Scala 中解决类型级别的问题很有吸引力，因为它很复杂，但它也需要最多的技能才能正确完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T23:11:51.490

有多个问题。首先，整个方法很奇怪：一方面你传入了一个`monomer`参数，如果`thisState`找到了参数，该方法与接收者无关——那为什么这根本是一个方法*而* `MonomerClass`不是“自由浮动” " 函数——另一方面，`this`如果`thisSite`未找到*，则返回返回。*既然你原来也有`implicit evidence: MyType <:< ReactantMonomer`，我猜整个`monomer`论点已经过时了，你实际上想对`new_this`.

稍微清理一下，暂时忘记清单，你可以

```
case class MonomerClass[+StateSiteType <: StateSite, +EdgeSiteType <: EdgeSite](
  stateSites: Seq[StateSiteType], edgeSites: Seq[EdgeSiteType]) {

  def replaceSiteWithIntersection[A <: ReactantStateSite { type MyType = A }]
  (thisSite: A)(implicit ev: this.type <:< MonomerClass[A, ReactantEdgeSite])
  : MonomerClass[A, ReactantEdgeSite] = {
    val monomer = ev(this)
    monomer.stateSites.find(_.name == thisSite.name) match {
      case Some(otherSite) => 
        val newSites = monomer.stateSites map {
          case `thisSite` => thisSite.createIntersection(otherSite)
          case other      => other
        }
        monomer.copy(stateSites = newSites)
      case None => monomer
    }
  }
} 
```

这是一个有趣的问题，我花了一些迭代来摆脱（错误的！）演员表。现在它实际上是非常可读的：此方法仅限于`StateSiteType`实际上`A`是`ReactantStateSite`. 因此，类型参数`A <: ReactantStateSite { type MyType = A }`——最后一点很有趣，这对我来说是一个新发现：您可以在此处指定类型成员以确保您的返回类型 from`createIntersection`实际上是`A`.

* * *

您的方法仍然有些奇怪，因为如果我没记错的话，您最终会调用`x.createIntersection(x)`（`thisSite`与自身相交，这是一个无操作）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T19:22:39.913

有一个缺陷`replaceSiteWithIntersection`是，根据方法签名，`thisSite`( `A`) 的类型是 的**超类型**和`StateSiteType`的子类型`ReactantStateSite`。

但是你最终将它转换为`StateSiteType with ReactantStateSite`. 这对我来说没有意义。

你从哪里得到的保证`A`突然是一个`StateSiteType`？

# javascript - 如何绑定到单击以切换复选框？

> ID：11635982
> 
> 赞同：0
> 
> 时间：2012-07-24T17:16:11.077
> 
> 标签：javascript, jquery, html

给定一个 LI 列表，每个 LI 都包含一个复选框，如下所示：

```
<li class="contact">
    <input type="checkbox" class="checkbox" name="checkableitems[]" value="1333">
    <div class="content">
        <cite>Baby James</cite>
    </div>
</li> 
```

我希望能够在单击 LI 时切换复选框，而不仅仅是单击复选框。我得到了这项工作，你可以在这里看到：

[http://jsfiddle.net/xgB5X/2/](http://jsfiddle.net/xgB5X/2/)

问题是，当点击LI切换复选框时，直接点击复选框是没有坏的。单击复选框不再切换。有什么建议可以让它工作吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:27:11.980

为什么不使用`label`标签？

```
<li class="contact">
    <input id='input1' type="checkbox" class="checkbox" name="checkableitems[]" value="1333">
    <label for='input1'>Baby James</label>
</li> 
```

[演示](http://jsfiddle.net/xgB5X/5/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T17:23:15.810

[http://jsfiddle.net/xgB5X/3/](http://jsfiddle.net/xgB5X/3/)检查这个。

我添加了一些代码来阻止传播。这将阻止事件到达`li`标签。

```
$('input[type=checkbox]').on('click', function(e) {
    e.stopPropagation();
}); 
```

您的问题是，当单击复选框时，它正在更改其状态，但是当事件到达 li 标签时，它再次包含复选框，它正在更改其状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:25:04.537

你可以试试这样的***[jsFiddle](http://jsfiddle.net/sNJLV/1/)***

```
$('.listview li > *').children().bind({
    click: function(e) {
        checkbox = $(this).closest('li').find('.checkbox');
        checkbox.attr('checked', !checkbox.is(':checked'));
    }
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T17:27:30.800

```
$('.listview li').on('click', function(e) {
      var c = $('.checkbox', this);
      c.prop('checked', !c[0].checked);
}).find('.checkbox').on('click', function(e) {e.stopPropagation();});​​​​​ 
```

[小提琴](http://jsfiddle.net/xgB5X/6/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T17:37:47.427

几点注意事项：

使用 .prop() 而不是 .attr() （它也更容易判断真/假，必须通过所有浏览器相互连接。

您可以在 click() 中检查 e.srcElement 以获取您的复选框的类名。

```
$('.listview li').on('click', function(e) {

  if (e.srcElement.className === 'checkbox') {
      e.stopPropagation();   
      return;
  }

  checkbox = $(this).find(':checkbox');

   // Toggle Checkbox
   if (checkbox.prop('checked')) {
       checkbox.prop('checked', false);
   } else {
       checkbox.prop('checked', true);
   }

}); 
```

[jsFiddle](http://jsfiddle.net/pQCMR/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-24T17:40:29.767

即使我认为您应该为此使用标签，但这是有效的方法

```
$('.listview li').bind({
  click: function(e) {
      var checkbox = $(this).find('.checkbox').get(0);
      if (e.target == checkbox) return;
      checkbox.click();
  }
}); 
```

[小提琴](http://jsfiddle.net/xgB5X/9/)

# java - 如何给 JavaFX TextField 一个 Swing 风格的降低斜角边框？

> ID：11635987
> 
> 赞同：1
> 
> 时间：2012-07-24T17:16:26.223
> 
> 标签：java, css, swing, javafx-2

我喜欢由 BorderFactory.createLoweredBevelBorder() 创建的带有边框的 JTextField 的 3D 效果。现在我正在使用 JavaFX，边框的 L&F 由 CSS 控制。而默认的外观只是一个简单的线条描边边框。我想出了如何编辑 CSS 文件以加厚边框并更改其颜色：

```
.text-field { -fx-border-color: color; -fx-border-width: #; } 
```

但是，如果您查看 Swing 生成的降低斜角效果，它是通过在 4 条边中的 2 条边上具有不同的颜色并且将边缘屏障以 45 度角创建的。那么如何使用 CSS 来实现呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T09:18:02.410

JavaFX CSS参考[指南](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html)说：

> 虽然 JavaFX CSS 解析器将解析有效的 CSS 语法，但它并不是一个完全兼容的 CSS 解析器。不应期望解析器处理本文档中未指定的语法。

`border`or`border-top`和其他人属于此不受支持的类别。
要降低斜边边框，请尝试

```
.text-field {
    -fx-border-insets: 0;
    -fx-border-width: 2px;
    -fx-border-color: black lightgray lightgray black;
} 
```

或者尝试使用内部阴影的 JavaFX 风格的方式

```
.text-field {
    -fx-effect: innershadow(three-pass-box, gray, 12 , 0.5, 1, 1);
} 
```

然而，你想要的真正风格可以通过`-fx-border-style`属性 IMO 来实现。请参阅上面提到的指南。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-06T21:42:35.307

```
-fx-border-color: top right bottom left;
-fx-border-color: transparent transparent red transparent; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T00:12:23.143

我还没有看到您所指的 Swing 样式，但是根据您的描述，这应该会给您带来斜面的外观。

您应该能够通过简单地将边框定义为**inset**而不是默认的*solid*来做到这一点。

```
.text-field {
    border: 4px inset #aaaaaa;
} 
```

或者，如果您想要更多控制，您可以将边框的每一侧设置为不同的颜色：

```
.text-field {
    border-top: 4px solid #555555;
    border-left: 4px solid #555555;
    border-bottom: 4px solid #aaaaaa;
    border-right: 4px solid #aaaaaa;
} 
```

[​还有*outset*、*ridge*和其他边界类型可供选择。](http://www.w3schools.com/css/css_border.asp)

# c# - 您如何确保异步方法将异步运行？

> ID：11635989
> 
> 赞同：1
> 
> 时间：2012-07-24T17:16:32.277
> 
> 标签：c#, .net-4.0, asynchronous

在 .NET 4.0 中，我使用的是`FtpWebRequest`异步方法。

我遇到的一个问题是我想要一个超时选项。

为了实现这一点，我目前`ManualResetEvent`在异步状态下传递 a ，然后`ResetEvent.WaitOne(30000)`在启动请求后调用，确保布尔响应为真（或抛出 a `TimeoutException`）。

如果我的异步方法异步运行，我相信这很好，因为它们在另一个线程中启动，我当前的线程继续执行`WaitOne`，然后异步方法完成或超时触发。

像这样的东西：

```
 var ar = state.Request.BeginGetResponse(
  new AsyncCallback(BeginGetResponseCallback),
  state // has a ManualResetEvent
 );

 // Won't reach here if BeginGetResponse run synchronously
 // as indicated by ar.CompletedSynchronously.
 // The risk is then that BeginGet blocks infinitely
 // without a timeout (as I'm seeing)

 if (!state.ResetEvent.WaitOne((int)5000))
   throw new TimeoutException(); 
```

但是，如果我的异步方法同步运行（如 所示`CompletedSynchronously`），`WaitOne`则永远不会到达，并且线程会无限阻塞。

有没有一种可靠的方法（也许是`BackgroundWorker`？）来确保`Begin/End`调用异步发生，或者有一种更好、更可靠的方法来强制超时？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:22:56.627

您是否考虑过简单地使用[FtpWebRequest.TimeOut 属性](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.timeout.aspx)？

方向：

```
 FtpWebRequest request = null;

        request.Timeout = 3000;

        Func<WebResponse> responseDelegate = () => request.GetResponse();

        var asynchRes = responseDelegate.BeginInvoke(null, null);

        try
        {
            responseDelegate.EndInvoke(asynchRes);
        }
        catch (TimeoutException e)
        { 
            // bla
        } 
```

**想一想，也尝试指定 TimeOut 并调用 BeginGetResponse，它应该可以工作，因为它实际上在后台调用了 Synchronous 方法。**

# actionscript-3 - Flash网站中的中心符号？

> ID：11635993
> 
> 赞同：0
> 
> 时间：2012-07-24T17:16:45.487
> 
> 标签：actionscript-3, flash, actionscript-2

我被要求帮助一个 Flash 网站： [http](http://tomix.110mb.com/) ://tomix.110mb.com/ （点击漫画页面的中心）

该网站的所有者希望在舞台中间放置一个符号。

我不熟悉 Adob​​e Flash，只使用 AS3，我建议他使用

```
symbol.x = stage.stageWidth / 2; 
```

我什至不确定他使用的是 AS3。他还问将脚本放在哪里（我不知道，我不使用 Adob​​e Flash）。

请注意，您可以左右滚动站点，因此您不能只提前计算 x。它必须在您滚动页面时移动。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:22:49.823

除非`symbol`已经以它自己的起源为中心，否则您可能需要将您的建议修改为：

`symbol.x = (stage.stageWidth - symbol.width) / 2;`

至于将这行代码放在哪里，没有足够的信息来给出决定性的答案。最有可能的是，这条线应该在`symbol`实例化之后出现。如果站点动态调整大小，那么它应该在调整大小处理程序中。如果`symbol`没有以编程方式实例化，那么它应该是放置在舞台上且实例名称为“symbol”的对象可访问的任何位置。

# java - 如何创建可编辑

> ID：11635994
> 
> 赞同：0
> 
> 时间：2012-07-24T17:16:44.967
> 
> 标签：java, jsf, jsf-2

我找到了这个[示例](http://www.mkyong.com/jsf2/how-to-update-row-in-jsf-datatable/)如何`h:datatable`在 JSF 页面中创建可编辑的。

我想创建类似的东西，但有`h:panelGrid`：

```
<h:panelGrid columns="2">

    <h:panelGroup>User ID</h:panelGroup>
    <h:panelGroup>
        <h:outputText value="#{AccountProfileController.settings['USERID']}"/>
        <h:inputText value="#{AccountProfileController.settings['USERID']}"/>
    </h:panelGroup>

    <h:panelGroup>Group ID</h:panelGroup>
    <h:panelGroup>
        <h:outputText value="#{AccountProfileController.settings['GROUPID']}"/>
        <h:inputText value="#{AccountProfileController.settings['GROUPID']}"/>
    </h:panelGroup>

    <h:panelGroup>Special Number</h:panelGroup>
    <h:panelGroup>
        <h:outputText value="#{AccountProfileController.settings['SPECIALNUMBER']}"/>
        <h:inputText value="#{AccountProfileController.settings['SPECIALNUMBER']}"/>
    </h:panelGroup>

    <h:panelGroup>Username</h:panelGroup>
    <h:panelGroup>
        <h:outputText value="#{AccountProfileController.settings['USERNAME']}"/>
        <h:inputText value="#{AccountProfileController.settings['USERNAME']}"/>
    </h:panelGroup>
</h:panelGrid> 
```

托管bean：

```
import javax.sql.DataSource;
import javax.annotation.Resource;
import javax.faces.bean.ViewScoped;
import javax.faces.context.FacesContext;

import org.glassfish.osgicdi.OSGiService;

@Named("AccountProfileController")
@ViewScoped
public class AccountProfile implements Serializable {

    @Resource(name = "jdbc/Oracle")
    private DataSource ds;

    private int id;
    // This Hash Map will be used to store setting and value
    private HashMap<String, String> settingsMap = new HashMap<>();

    public HashMap<String, String> getsettings()
    {
        return settingsMap;
    }

    public AccountProfile()
    {
        // get the ID value 
        try
        {
            this.id = Integer.parseInt((String) FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("id"));
        }
        catch (Exception e)
        {
            this.id = 0;
        }
    }

    @PostConstruct
    public void initData() throws SQLException
    {
        //     settingsMap = new HashMap<String, String>();

        if (ds == null)
        {
            throw new SQLException("Can't get data source");
        }
        // Initialize a connection to Oracle
        Connection conn = ds.getConnection();

        if (conn == null)
        {
            throw new SQLException("Can't get database connection");
        }
        // With SQL statement get all settings and values
        PreparedStatement ps = conn.prepareStatement("SELECT * from USERS where USERID = ?");
        ps.setInt(1, id);
        try
        {
            //get data from database        
            ResultSet result = ps.executeQuery();
            while (result.next())
            {
                // Put the the data from Oracle into Hash Map                
                settingsMap.put("USERID", result.getString("USERID"));
                settingsMap.put("GROUPID", result.getString("GROUPID"));
                settingsMap.put("SPECIALNUMBER", result.getString("SPECIALNUMBER"));
                settingsMap.put("USERNAME", result.getString("USERNAME"));
                settingsMap.put("PASSWD", result.getString("PASSWD"));
                settingsMap.put("DATETOCHANGEPASSWD", result.getString("DATETOCHANGEPASSWD"));
                settingsMap.put("ADDRESS", result.getString("ADDRESS"));
                settingsMap.put("STATEREGION", result.getString("STATEREGION"));
                settingsMap.put("COUNTRY", result.getString("COUNTRY"));
                settingsMap.put("USERSTATUS", result.getString("USERSTATUS"));
                settingsMap.put("TELEPHONE", result.getString("TELEPHONE"));
                settingsMap.put("DATEUSERADDED", result.getString("DATEUSERADDED"));
                settingsMap.put("USEREXPIREDATE", result.getString("USEREXPIREDATE"));
                settingsMap.put("DATEUSERLOCKED", result.getString("DATEUSERLOCKED"));
                settingsMap.put("CITY", result.getString("CITY"));
                settingsMap.put("EMAIL", result.getString("EMAIL"));
                settingsMap.put("DESCRIPTION", result.getString("DESCRIPTION"));
            }
        }
        finally
        {
            ps.close();
            conn.close();
        }
    }

    // Editable
    boolean editable;

    public boolean isEditable()
    {
        return editable;
    }

    public void setEditable(boolean editable)
    {
        this.editable = editable;
    }
} 
```

示例中的 JSF 页面`alue="#{order.orderList}" var="o"`用于显示数据。在我的情况下，我使用 Java`hashmap`来显示数据，我不知道如何使用`hashmap`. 你能告诉我如何创建可编辑的`h:panelGrid`吗？

最好的祝愿