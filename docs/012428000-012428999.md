# StackOverflow 问答 12428000-12428999

# javascript - Ruby on Rails - 我应该朝哪个方向构建交互式界面？

> ID：12428004
> 
> 赞同：0
> 
> 时间：2012-09-14T15:55:52.970
> 
> 标签：javascript, ruby-on-rails, ruby, interface

因此，我的第一个 Ruby on Rails 应用程序已准备好用于接口。我想添加某种类型的 Javascript 来改善用户体验和一些设计以使界面看起来更清晰。停留在 HTML5、CSS3 和 Javascript 领域内，我应该向哪个方向构建这个界面？请记住，我是初学者。

这个界面有三个主要的东西： 1\. 显示来自控制器@variable 的值（0-100）作为仪表。2\. 按顺序列出数组的内容。（见下面的代码） 3\. 执行 ruby​​ 的 button_to 代码。（见下面的代码）

```
<div id="page-wrap">
<% @finalcarssneeded.each do|x| %>
<div><%= button_to "add #{x}", send(:"#{x}a_cars_path", id: @user.id),  class: "btn       btn-large btn-primary" %></div>
<% end %>
</div> 
```

您可以提供有关教程、Javascript 框架或任何建议的任何提示，我们将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:25:08.803

我可以想到 2 种非常流行的入门方法。

1.  看看[Twitter Bootsrap](http://railscasts.com/episodes/328-twitter-bootstrap-basics)，这里有一个关于如何使用它的[Railscast 。](http://railscasts.com/episodes/328-twitter-bootstrap-basics)这会让你走得相当快。

2.  [JQuery UI](http://jqueryui.com/)，它将让您在将 javascript 连接到 Rails 方面领先一步。IIRC Rails 3 附带 JQuery，因此您已经在使用它。

# c# - C#托盘图标使用wpf

> ID：12428006
> 
> 赞同：13
> 
> 时间：2012-09-14T15:55:55.277
> 
> 标签：c#, wpf, trayicon

我对 C# 编程非常陌生，尽管我已经在 unity3D 中编写 C# 脚本已有几年了。我目前正在尝试制作 WPF 托盘图标，我在网上找到的所有资源都告诉我使用

```
System.Windows.Forms 
```

但是 .Forms 在 System.Windows 中对我不可用，我不知道为什么不可用。谁能帮我这个？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-14T15:58:40.483

您需要添加对 System.Window.Forms 和 System.Drawing 程序集的引用，然后像这样使用它。假设您尝试将 Window 最小化到托盘图标并在用户单击该图标时再次显示它：

```
public partial class Window : System.Windows.Window
{

    public Window()
    {
        InitializeComponent();

        System.Windows.Forms.NotifyIcon ni = new System.Windows.Forms.NotifyIcon();
        ni.Icon = new System.Drawing.Icon("Main.ico");
        ni.Visible = true;
        ni.DoubleClick += 
            delegate(object sender, EventArgs args)
            {
                this.Show();
                this.WindowState = WindowState.Normal;
            };
    }

    protected override void OnStateChanged(EventArgs e)
    {
        if (WindowState == WindowState.Minimized)
            this.Hide();

        base.OnStateChanged(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T15:58:10.993

您需要添加对 System.Windows.Forms.dll 的引用，然后使用 NotifyIcon 类。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.notifyicon.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.notifyicon.aspx)

# php - 如何回显 Prolog 在查询后返回的真/假值

> ID：12428012
> 
> 赞同：0
> 
> 时间：2012-09-14T15:56:07.977
> 
> 标签：php, swi-prolog

我想提出一个问题。我尝试使用 exec 函数将 php 与 SWI-Prolog 连接起来，我的努力很成功。我设法通过 php 查询 prolog，并且能够回应 Prolog 的答案。

我想做但不知道如何完成它，是回显真/假序言返回。

假设我有一个简单的**Knowledge_base.pl**文件，其中包含以下事实和规则：

* * *

```
girl(erin).
boy(john).
likes(erin,reading).
likes(john,reading).
hangs_out_with(erin,X) :- likes(X,reading), boy(X), writeln('Someone s got a new friend!!'). 
```

* * *

鉴于上面的简单知识库，可以提出查询和序言响应。

例如：

```
?- girl(erin). Prolog based on our knowledge base will respond true.
?- girl(john). Prolog based on our knowledge base will respond false.
?- hangs_out_with(erin,john). Proslog will respond : Someone s got a new friend!! true. 
```

我需要的是让 PHP 回显真假响应。我怎样才能做到这一点？

提前感谢您的帮助。

# vba - 在循环访问各种文件时在 VBA 中编写公式？

> ID：12428019
> 
> 赞同：0
> 
> 时间：2012-09-14T15:56:22.190
> 
> 标签：vba

我有以下具有特定文件名的代码：

```
 BD.Sheets("Sheet1").Cells(Rows.Count, 6).End(xlUp).Offset(1, 0).Formula = "=SUMIF('P:\Actuary\Cash Flow Forecast\Annual and Quarterly Budget Data\[ECMQA 2012Q1.xls]Sheet1'!$D$13:$D$234,D2,OFFSET('P:\Actuary\Cash Flow Forecast\Annual and Quarterly Budget Data\[ECMQA 2012Q1.xls]Sheet1'!$D$13:$D$234,0,MATCH(E2,'P:\Actuary\Cash Flow Forecast\Annual and Quarterly Budget Data\[ECMQA 2012Q1.xls]Sheet1'!$D$12:$R$12,0)-1))" 
```

但是，我正在运行一个循环，该循环进入一个文件夹并选择其中的所有文件（上面的文件位于该文件夹中，我正在测试我的代码以查看它是否适用于一个文件）：

```
Dim wb As Workbook, sFile As String, sPath As String
Dim itm As Variant
Dim strFileNames  As String

sPath = "C:\Actuary\Cash Flow Forecast\Annual and Quarterly Budget Data\"

''Retrieve the current files in directory
sFile = Dir(sPath)
Do While sFile <> ""
    strFileNames = strFileNames & "," & sFile
    sFile = Dir()
Loop

''Open each file found
For Each itm In Split(strFileNames, ",")
    If itm <> "" Then
        Set wb = Workbooks.Open(sPath & itm)

        ''LOTS OF CALCULATIONS, INCLUDING ABOVE CODE

    End If
Next itm 
```

如果我不知道文件名（因为它遍历所有文件名），我将如何编写第一个代码？

任何帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:57:57.563

```
Sub WriteFormulas()

    Dim sFile As String
    Dim sPath As String
    Dim sh As Worksheet
    Dim rNext As Range

    sPath = Environ("USERPROFILE") & "\My Documents\Tester\"

    'Get the first file
    sFile = Dir(sPath & "*.xls")

    Do While Len(sFile) > 0
        'don't process this workbook
        If sFile <> ThisWorkbook.Name Then
            'set a variable to the first sheet in the file
            Set sh = Workbooks.Open(sFile).Worksheets(1)
            'find the next available cell in column A in this workbook
            Set rNext = Sheet1.Cells(Sheet1.Rows.Count, 1).End(xlUp).Offset(1, 0)
            'create a formula using the address with the external argument
            rNext.Formula = "=SUM(" & sh.Range("A1:A10").Address(True, True, xlA1, True) & ")"
            'close the workbook
            sh.Parent.Close False
        End If
        sFile = Dir
    Loop

End Sub 
```

当您关闭工作簿时，Excel 将扩展对完整路径和文件名的引用。所以虽然`Range("A1").Address(,,,true)`可能会解决

```
[MyBook.xls]Sheet1!A1 
```

当您关闭 MyBook.xls 时，它将转换为

```
'C:\Path\[MyBook.xls]Sheet1'!A1 
```

# linux - Subversion：不在工作目录中时跳过文件夹

> ID：12428021
> 
> 赞同：0
> 
> 时间：2012-09-14T15:56:24.093
> 
> 标签：linux, svn, ubuntu

我们在我们的 Ubuntu 12.04 Web 服务器上检查了各种 Subversion 项目中的网站文件，每个站点的项目。

例如

*   /var/www/site1/
*   /var/www/site2/
*   /var/www/site3/

现在，如果我在正确的工作目录中，我可以从颠覆更新，例如我去

```
cd /var/www/site1
svn update filepath 
```

工作正常

...但如果我去

```
svn update /var/www/site1 
```

我得到错误：

```
Skipped 'site1' 
```

是否与 /var/www 的每个子文件夹都是单独签出的单独 Subversion 项目有关？还是我完全误解了某些东西。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:03:51.020

您需要进入工作副本目录，然后`svn up`在该文件夹中执行。

您可以参考另一个问题[SVN update: 'skipped' message](https://stackoverflow.com/questions/4892281/svn-update-skipped-message)

# xcode - 在 iOS6 presentViewController 上崩溃：但在 iOS5 上没有

> ID：12428022
> 
> 赞同：1
> 
> 时间：2012-09-14T15:56:27.557
> 
> 标签：xcode, viewcontroller, ios6

当我使用 Xcode 4.5 GM Seeds 在 iOS6 Simulator 上运行我的应用程序时，此代码崩溃：

```
if ([[[UIDevice currentDevice] systemVersion] isEqualToString:@"6.0"]) {
    XLog(@"hier checken");

    self.tabBarController = [[UITabBarController alloc] init];

    self.window.rootViewController = self.tabBarController;
    [self.window makeKeyAndVisible];

}

[...]

self.loginController = [[[LoginController alloc] initWithNibName:@"LoginController_iPhone" bundle:nil] autorelease];

self.loginController.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;

//this line occurs a crash on iOS 6 (simulator, device not tested)
[self.tabBarController presentViewController:self.loginController
                                        animated:YES
                                      completion:nil]; 
```

崩溃是 SIGABRT。没有更多关于坠机的信息。

iOS6 上发生了什么崩溃？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T03:13:29.557

`initWithNibName:bundle:`是 UIViewController 的指定初始化器，iOS6 中有一些新的东西。

您可以尝试修改 LoginController_iPhone.xib 并删除其控制器：

![在此处输入图像描述](../Images/cb62f25f2ad14b19c24393760a2ac76e.png) **---->** ![在此处输入图像描述](../Images/a96121b23e588c0b3edceeeea2846b8a.png)

这个对我有用 。希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-19T18:49:03.883

我正在开发的一个应用程序在我试图访问通讯录时会崩溃而没有任何痕迹。关闭应用程序访问联系人的权限的 ABAddressBookRef 或 ABAddressBookCreate 将使应用程序崩溃。希望这可以帮助！

# java - Spring - 是否可以将多个字段映射到单个表单错误？

> ID：12428023
> 
> 赞同：4
> 
> 时间：2012-09-14T15:56:28.420
> 
> 标签：java, spring-mvc, user-interface

我在表单中有名字和姓氏字段，但我想使用相同的 div 来显示它们的任何错误。

表单字段：

```
<form:input path="firstName" id="firstName" cssErrorClass="errorStyle"/>
<form:input path="firstName" id="firstName" cssErrorClass="errorStyle"/> 
```

我希望能够将 form:errors 绑定到多个路径，如下所示：

```
<form:errors path="firstName, lastName" element="div"/> 
```

这可能吗？
我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:59:21.377

采用

```
<form:errors path="*" element="div" cssClass="error-message"/> 
```

* * *

一种选择可能是投资的话

```
 nameFirst = firstName 

     nameLast = lastName 
```

然后使用

```
<form:errors path="name*" element="div" cssClass="error-message"/> 
```

参考：[http ://static.springsource.org/spring/docs/2.5.x/reference/view.html](http://static.springsource.org/spring/docs/2.5.x/reference/view.html)

# vba - 恒定运行时错误“1004”

> ID：12428024
> 
> 赞同：1
> 
> 时间：2012-09-14T15:56:29.373
> 
> 标签：vba, excel-2010

我正在尝试将 3 列中的数据一一汇总，并将总数粘贴到下一张表中的三个单元格中。我想出了以下代码。它工作正常几次，但随后开始抛出错误：运行时错误'1004'应用程序定义或对象定义错误。

```
Sub test1()

Dim Counter As Integer
Counter = 1

For i = 1 To 3

Do Until ThisWorkbook.Sheets("Sheet1").Cells(Counter, i).Value = ""

    ThisWorkbook.Sheets("Sheet1").Range(Cells(1, i), Cells(Counter, i)).Select
    Counter = Counter + 1

Loop

    Value1 = Application.WorksheetFunction.Sum(Selection)
    ThisWorkbook.Sheets("Sheet2").Cells(1, i).Value = Value1

Next i

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:18:38.233

您不能在工作表中选择不活动的范围，这就是导致错误的原因。

如果您还有任何工作表`Sheet1`处于活动状态，您的代码将抛出您列出的错误。作为快速修复`Thisworkbook.Sheets("Sheet1").Activate`在循环之前添加。

作为更好的解决方法，您应该尝试从代码中选择。

# python - 安全地迭代 WeakKeyDictionary 和 WeakValueDictionary

> ID：12428026
> 
> 赞同：10
> 
> 时间：2012-09-14T15:56:30.610
> 
> 标签：python, dictionary, weak-references

*Python 3.2*`weakref`模块的文档并`WeakKeyDictionary`有`WeakValueDictionary`关于迭代这些容器的注释：

> **注意：**注意：因为 WeakKeyDictionary 是建立在 Python 字典之上的，所以在迭代它时不能改变大小。这对于 WeakKeyDictionary 可能很难确保，因为程序在迭代期间执行的操作可能会导致字典中的项目“神奇地”消失（作为垃圾收集的副作用）。

作为这些容器行为的规范，这似乎相当可怕。尤其是在运行使用 CPython 的垃圾收集器的代码时（当使用包含循环的数据结构时）或使用另一个 Python 实现（例如 Jython）时，听起来好像没有对这些集合进行迭代的安全方法。

当垃圾收集器可以在我的程序中的任何时候清除引用时，我如何安全地迭代这些集合？为 CPython 提供解决方案是我的首要任务，但我也对其他实现的问题感兴趣。

这可能是迭代 WeakKeyDictionary 的安全方法吗？

```
import weakref

d = weakref.WeakKeyDictionary()

...

for k, v in list(d.items()):
    ... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2018-10-07T23:05:57.267

在 Python 2.7 或 Python 3.1+ 中迭代 、 或 实际上是安全`WeakKeyDictionary`的`WeakValueDictionary`。[早在 2010 年，他们就设置了一个迭代保护](https://github.com/python/cpython/commit/1a2d3563f960bc284daf146a1b6944cb16167666)，以防止弱引用回调从底层 dict 中删除引用或在迭代期间设置，但文档从未更新。`WeakSet`

使用警卫，如果一个条目在迭代到达它之前死亡，迭代将跳过该条目，但不会导致段错误或 RuntimeError 或任何东西。死条目将被添加到待删除的列表中并稍后处理。

[这是警卫](https://github.com/python/cpython/blob/v3.7.0/Lib/_weakrefset.py#L10)（不是线程安全的，尽管有评论）：

```
class _IterationGuard:
    # This context manager registers itself in the current iterators of the
    # weak container, such as to delay all removals until the context manager
    # exits.
    # This technique should be relatively thread-safe (since sets are).

    def __init__(self, weakcontainer):
        # Don't create cycles
        self.weakcontainer = ref(weakcontainer)

    def __enter__(self):
        w = self.weakcontainer()
        if w is not None:
            w._iterating.add(self)
        return self

    def __exit__(self, e, t, b):
        w = self.weakcontainer()
        if w is not None:
            s = w._iterating
            s.remove(self)
            if not s:
                w._commit_removals() 
```

[这是 WeakKeyDictionary weakref 回调检查守卫的地方](https://github.com/python/cpython/blob/v3.7.0/Lib/weakref.py#L356)：

```
def remove(k, selfref=ref(self)):
    self = selfref()
    if self is not None:
        if self._iterating:
            self._pending_removals.append(k)
        else:
            del self.data[k] 
```

[这里是`WeakKeyDictionary.__iter__`设置警卫](https://github.com/python/cpython/blob/v3.7.0/Lib/weakref.py#L445)的地方：

```
def keys(self):
    with _IterationGuard(self):
        for wr in self.data:
            obj = wr()
            if obj is not None:
                yield obj

__iter__ = keys 
```

在其他迭代器中使用相同的保护。

* * *

如果这个守卫不存在，呼叫`list(d.items())`也不安全。GC 传递可能发生在`items`迭代器内部，并在迭代期间从 dict 中删除项目。（用 C 编写的事实`list`不会提供任何保护。）

* * *

回到 2.6 和更早版本，迭代 WeakKeyDictionary 或 WeakValueDictionary 的最安全方法是使用`items`. `items`将返回一个列表，它将使用底层 dict 的`items`方法，该方法（大多数情况下？）不会被 GC 中断。3.0 中 dict API 的变化改变了`keys`//的工作方式`values`，`items`这可能就是当初引入守卫的原因。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-14T17:55:51.713

为了安全起见，您必须在某处保留参考。使用成语：

```
for k,v in list(d.items()): 
```

不是完全安全的，因为即使它在大多数情况下都可以工作，但在循环的最后一次迭代期间，列表可能会被垃圾收集。

正确的方法是：

```
items = list(d.items())
for k,v in items:
    #do stuff that doesn't have a chance of destroying "items"
del items 
```

如果您使用 a `WeakKeyDictionary`，您可以简单地存储键，如果使用 ，则存储值`WeakValueDictionary`。

附带说明：在 python2 中`.items()`已经返回一个列表。

最终，这取决于您所说的“安全”是什么意思。如果您只是意味着迭代将正确进行（对所有元素迭代一次），那么：

```
for k,v in list(d.items()): 
```

是安全的，因为字典上的迭代实际上是由 执行的`list(d.items())`，那么你只是在迭代列表。

相反，如果您的意思是在迭代期间元素不应作为 -loop 的副作用从字典中“消失” `for`，那么您必须保持强引用直到循环结束，这需要您存储列表在开始循环之前在变量中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-31T05:36:50.487

在不首先使用迭代的情况下转换为强引用。

```
items = []
while d:
    try:
        items.append(d.popitem())
    except KeyError:
        pass 
```

如果它在 while 循环期间丢失了一些键，它不应该引起问题。

然后你可以迭代`items`。完成后，`d.update(items)`将它们放回原处，然后`del items`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-31T05:47:43.550

禁用垃圾收集器。

```
import gc

gc.disable()
try:
    items = list(d.items())
finally:
    gc.enable() 
```

然后迭代`items`。

# mysql - Mysql Regexp 搜索记录包含一些特定的单词

> ID：12428027
> 
> 赞同：3
> 
> 时间：2012-09-14T15:56:31.030
> 
> 标签：mysql, regex

我想使用 mysql 来选择所有记录**只有**

上面写着：

**4ahhyes4,4ahh4,4ahaa4 ，空白和点。**

这是我的查询。

```
SELECT * FROM p_posts WHERE post_content REGEXP '^(4ahhyes4|4ahh4|4ahaa4|\.|\s)+$'; 
```

但它将所有记录与其他字符匹配（就像 LIKE 语法一样）：

```
abcde 4ahhyes4 4ahhyes4 4ahhyes4 ~> failed because abcde
123sdasd 4ahhyes4 ..... ~> failed because 123sdasd
4ahhyes4 4ahhyes4.... ..... ~> OK 
```

如何只匹配包含这些单词的记录呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:00:53.540

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-14T15:59:56.517

`WHERE post_content IN ( '4ahhyes4', '4ahh4', '4ahaa4', 'white space and dot' )`不是吗？

# perl - 在 Perl 中从网络驱动器读取文件

> ID：12428029
> 
> 赞同：4
> 
> 时间：2012-09-14T15:56:40.177
> 
> 标签：perl, networking, drive, file-find

我正在研究一个 perl 脚本，该脚本从我们网络上的某个根目录开始为所有目录中的 pdf 进行文档清单。该脚本在本地运行良好，但我无法让它从网络驱动器读取文件。我有草莓perl

这是我的代码的开始

```
use strict;
use Excel::Writer::XLSX;
use Cwd;
use Tk;
use File::Find;

my @analystreports;
my @directories; 
```

我使用 Tk Gui 来获取目录

```
my $homeDir  = Tk::MainWindow->new->chooseDirectory; 
```

捕获当前目录中的所有文件和文件夹

```
find(\&grabPDF, $homeDir);

sub grabPDF {

    my $file = $_;
    if ($file =~ /\.pdf/g) {

        push @analystreports, $File::Find::name;
    }
} 
```

我的网络驱动器在网络使用中看起来像这样

本地 N：远程 \abc-file-01\shared 数据

请原谅我的初学者代码。我的问题是我是否对网络驱动器做错了，或者我是否必须向我们的管理员询问权限。非常感谢，丹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:54:57.187

驱动器就是驱动器。您可以传递以下任何字符串：

```
N:\
n:\
N:/
n:/ 
```

您甚至可以传递 UNC 名称。

```
\\abc-file-01\shared data
//abc-file-01/shared data 
```

当然，您可能必须使用一些转义来构建字符串。

```
"N:\\"
"N:/"
"n:\\"
"n:/"
"\\\\abc-file-01\\shared data"
"//abc-file-01/shared data" 
```

但这可能不相关，因为您似乎是从 Tk 获取字符串而不是构建它。

您的代码中有一个错误。

```
if ($file =~ /\.pdf/g) { 
```

应该

```
if ($file =~ /\.pdf/) { 
```

并且可能

```
if ($file =~ /\.pdf\z/) { 
```

那里没有任何意义并且可能导致问题（尽管我认为您的`g`特定代码不会受到影响）。摆脱`g`.

# java - Spring MVC 获取当前登录用户

> ID：12428033
> 
> 赞同：8
> 
> 时间：2012-09-14T15:56:50.677
> 
> 标签：java, spring-mvc, spring-security

我的应用程序仅在当前用户是特定类型时才允许访问，这也意味着他们拥有的角色可以登录到其他应用程序，然后以特定角色访问我的应用程序的某些部分，例如，我的 Web 应用程序配置为

```
<security-role> 
   <role-name>teamb</role-name>       
</security-role> 
```

现在我需要的是能够在我的应用程序中访问有关此角色的详细信息，即用户名

我怎样才能在我的`Spring MVC`应用程序中做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-14T16:21:12.853

首先，在你的页面中包含相应的标签库（我会用JSP做一个例子）

```
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %> 
```

然后你只需要使用这些标签来查询权限，当然还有数据。

查看用户是否对某事有足够的权限：

```
<sec:authorize ifAllGranted="ROLE_ADMIN">
    <a href="page.htm">Some Admin Stuff</a>
</sec:authorize> 
```

如果用户有足够的权限，链接`page.htm`将被呈现。

要获取用户名，请使用`${SPRING_SECURITY_LAST_USERNAME}`. 这是一个注销链接作为示例：

```
<a href="<c:url value="/j_spring_security_logout" />">Logout <c:out value="${SPRING_SECURITY_LAST_USERNAME}"/></a> 
```

**编辑**

要查询当前经过身份验证的用户，您可以尝试不同的方法：

```
Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
String username = authentication.getName(); 
```

或者

```
Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
User user = (User)authentication.getPrincipal();
user.getUsername(); 
```

请记住在调用or方法之前检查 if `authentication`is not null 。`getName``getPrincipal`

# ios - uiscrollview 和 cocos2d 粘贴

> ID：12428036
> 
> 赞同：1
> 
> 时间：2012-09-14T15:57:08.583
> 
> 标签：ios, xcode, cocos2d-iphone

我在使用带有 cocos2d 的 uiscrollview 时遇到问题。

我跟着这个： [http ://bitbattalion.com/2011/09/uikit-uiscrollview-and-cocos2d/](http://bitbattalion.com/2011/09/uikit-uiscrollview-and-cocos2d/)

然后，我用这个完成了它： [当 UIScrollView 在 iPhone 上拖动时，OpenGL ES 视图中的动画冻结](https://stackoverflow.com/questions/4876488/animation-in-opengl-es-view-freezes-when-uiscrollview-is-dragged-on-iphone)

它在模拟器上似乎工作正常，但在 iPod 上变得奇怪：它非常生涩，当你轻弹它时不会继续滚动。这种行为会在您轻弹一段时间后消失，有时它可以正常启动。

我正在使用 iOS 5.1 和 cocos2d 2.x。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:00:14.300

在显示滚动视图时尝试将动画间隔设置为当前帧速率的一半：

```
CCDirector* director = [CCDirector sharedDirector];
director.animationInterval = director.animationInterval * 2.0f; 
```

然后稍后当您不再显示滚动视图时，将其重置回原始间隔。

我还发现在我的情况下，第二个链接（OpenGL 冻结）不起作用。我不得不在 cocos2d 的主要渲染方法中实际使用 GCD 和一个信号量来让 Cocoa 有足够的时间来动画和渲染它自己的东西。

# google-places-api - Google Places API - 尝试过的解决方案

> ID：12428038
> 
> 赞同：1
> 
> 时间：2012-09-14T15:57:19.583
> 
> 标签：google-places-api

关于导致 Google Places API 出错以及使用 JSON 作为输出的原因似乎有些混乱。

例如，输出（将 URL 粘贴到浏览器的地址 abr 时会返回：

```
{
   "html_attributions" : [],
   "results" : [],
   "status" : "REQUEST_DENIED"
} 
```

起初，我认为这可能与我的 API 访问状态设置为“非活动”有关，但在阅读了关于 SO 的几篇文章之后......

*   [REQUEST_DENIED Google Maps API v3 Places 错误](https://stackoverflow.com/questions/10385990/request-denied-google-maps-api-v3-places-error)
*   [Google Places API - REQUEST_DENIED](https://stackoverflow.com/questions/9060563/google-places-api-request-denied)
*   [使用 Google Places API 时的 REQUEST_DENIED](https://stackoverflow.com/questions/8427980/request-denied-when-using-the-google-places-api)

...我一点也不聪明。这篇文章/线程的目的是尝试准确地确定 Google Places API 的功能，是否需要 API 密钥，以及为什么`REQUEST_DENIED`对许多用户如此频繁地出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T01:39:08.693

`"status" : "REQUEST_DENIED"`在以下情况下返回：

*   缺少`sensor`参数
*   缺少`key`参数
*   该`sensor`参数未设置为`true`或`false`
*   参数有问题，`key`例如
    *   您尚未在[API 控制台](https://code.google.com/apis/console)服务选项卡中激活 Places API 服务
    *   [您的 API 密钥与API 控制台](https://code.google.com/apis/console)API 访问选项卡中的密钥不匹配
    *   您的 API 密钥已被泄露并被阻止；您可以在[API 控制台](https://code.google.com/apis/console)API 访问选项卡中生成新的 API 密钥
*   请求未作为`HTTPS GET`请求发送
    *   `HTTPS`所有 Places API Web 服务请求都需要
    *   `POST`requests 仅适用于 Places API [Place Actions](https://developers.google.com/places/documentation/actions)，例如 Check-In 和 Event 请求

# c# - 在签名 C# 中包含中间证书

> ID：12428039
> 
> 赞同：1
> 
> 时间：2012-09-14T15:57:22.700
> 
> 标签：c#, ssh, x509certificate2, smime, passbook

我正在尝试使用 c# 对要在 Passbook 中使用的清单文件进行签名。在他们发布 iOS6 的 GM 之前，我的代码运行良好。在这个种子中，他们希望签名包含中间证书。这是我的代码：

```
var dataToSign = System.IO.File.ReadAllBytes(filePathToSign);
ContentInfo contentInfo = new ContentInfo(new Oid("1.2.840.113549.1.7.2"), dataToSign);

var signerCert = new X509Certificate2(signerPfxCertPath, signerPfxCertPassword);

var signedCms = new SignedCms(contentInfo, true);

var signer = new CmsSigner(signerCert);
signer.IncludeOption = X509IncludeOption.ExcludeRoot;

signedCms.ComputeSignature(signer);

var myCmsMessage = signedCms.Encode();

return myCmsMessage; 
```

我在我的机器上安装了证书，但它不起作用。任何想法我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:24:03.773

正如评论中提到的（感谢Rudi）：

> Blockquote 看[这里](http://geekswithblogs.net/MobileLOB/archive/2012/07/30/part-3ndashpassbook-server.aspx)或[这里](http://github.com/tomasmcguinness/dotnet-passbook)

# android - 使用 AsyncTask 显示动态表格内容

> ID：12428040
> 
> 赞同：0
> 
> 时间：2012-09-14T15:57:29.533
> 
> 标签：android, android-listview, android-asynctask, google-tv, android-tablelayout

我正在为 GoogleTV 开发，我创建了一个包含 3 列的动态表（使用 TableLayout），它显示了 HTTP 从网站获取的前 10 个结果。

当用户开始滚动表格中的元素时（只有行是可选的，而不是列），我希望立即获取和呈现更多结果（行）（类似于 Google Reader）。

为了实现这一点，我正在使用从网站获取更多结果并将它们添加到表中的 AsyncTask。问题是我发现它的行为有点迟钝和不自然，所以我认为我可能没有使用正确的方法。

使用 TableLayout + AsyncTask 有更好的选择吗？我选择了 TableLayout 而不是 ListView，因为我想以“类似表格”的方式显示结果，这样更容易吸收信息。

感谢您的回复。

# ada - 使用 gnatbench 进行多语言构建

> ID：12428041
> 
> 赞同：1
> 
> 时间：2012-09-14T15:57:30.597
> 
> 标签：ada, gnat

我正在尝试在 gnatbench (C/C++) 中构建一个多语言项目，它只是忽略了构建我的 c++ 代码。我的项目文件如下所示：

```
 project Ralt_Pss is

  for Main use ("locationalpsses_part_main.adb");
  for Languages use ("Ada", "C", "C++");
  for Source_Dirs use ("../../../AdaExamples/CPP", "src","../../../AdaExamples/ARINC653", "../../../ada_common/face");
  for Object_Dir use "obj";

 package Compiler is
    for Default_Switches ("ada") use ("-g", "-gnato", "-gnatwa", "-gnatQ", "-gnat05");
 end Compiler;

 package Builder is
    for Default_Switches ("ada") use ("-g");
  end Builder;

 package Ide is
 end Ide;

 package Naming is
    for Spec_Suffix ("c++") use ".h";
    for Body_Suffix ("c++") use ".cc";
 end Naming;

 end Ralt_Pss; 
```

GPS 似乎可以正确构建它，但 gnatbench 没有。另外，我注意到 gnatbench 使用 gnatmake 构建，而 GPS 使用 gprbuild 构建。除了不使用 gnatbench 之外，知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:47:52.870

多语言项目需要 gprbuild。

恐怕我不确定如何告诉 Eclipse 这样做；您可以尝试将`gnatmake`gnatbench`.xml`文件更改为`gprbuild`.

谷歌搜索“告诉 gnatbench 使用 gprbuild”显示 AdaCore 在 2012 年 8 月 7 日修复了这个问题，但您可能需要等待几个月才能让 GNAT GPL 2013 公开发布该修复程序。

# c++ - 使用悬停事件

> ID：12428045
> 
> 赞同：2
> 
> 时间：2012-09-14T15:57:40.393
> 
> 标签：c++, qt, qt-events

我无法在`QGraphicsRectItem`.

我已经对这个对象进行了子类化，并重新实现了悬停进入和悬停离开处理程序......或者至少我认为我有。我还在构造函数中将接受悬停事件设置为 true。

但是，该事件永远不会被触发。处理程序内的断点永远不会被命中。

这是课程：

```
#include "qhgraphicsrectitem.h"

QhGraphicsRectItem::QhGraphicsRectItem(QGraphicsRectItem *parent) :
    QGraphicsRectItem(parent)
{
    setAcceptHoverEvents(true);
    setAcceptsHoverEvents(true);
}

void QhGraphicsRectItem::hoverEnterEvent(QGraphicsSceneHoverEvent *event) {
    oldBrush = brush();
    setBrush(QBrush(QColor((oldBrush.color().red() + (0.5 * (255-oldBrush.color().red()))),(oldBrush.color().green() + (0.5 * (255-oldBrush.color().green()))),(oldBrush.color().blue() + (0.5 * (255-oldBrush.color().blue()))))));
}

void QhGraphicsRectItem::hoverLeaveEvent(QGraphicsSceneHoverEvent *event) {
    setBrush(oldBrush);
} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T20:46:33.927

您是否将您的`hoverEnterEvent`和标记`hoverLeaveEvent`为虚拟的？如果您不这样做，则事件可能正在触发，但`QGraphicsItem`正在处理事件。

```
class QhGraphicsRectItem : public QGraphicsItem
{
    ...
    virtual void hoverEnterEvent(QGraphicsSceneHoverEvent *event);
    virtual void hoverLeaveEvent(QGraphicsSceneHoverEvent *event);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T18:56:48.140

您的物品是否位于`QGraphicsItemGroup`?

在找到这句话之前，我遇到了完全相同的问题：

“A`QGraphicsItemGroup`是一种特殊类型的复合项，它将自身及其所有子项视为一个项（即，所有子项的所有事件和几何图形都合并在一起）。”

（看这里：http: [//qt-project.org/doc/qt-4.8/qgraphicsitemgroup.html](http://qt-project.org/doc/qt-4.8/qgraphicsitemgroup.html)）

这意味着`QGraphicsItemGroup`调用`setHandlesChildEvents(true)`.

我通过调用`parentItem->setHandlesChildEvents(false)`位于我的项目上方的任何（和所有）组来捕获悬停事件来解决我的问题。噗！这些事件开始出现在您提到的虚拟回调中。

# c# - 如何在不使用 LINQ 的情况下查询 XmlDocument

> ID：12428049
> 
> 赞同：0
> 
> 时间：2012-09-14T15:58:08.383
> 
> 标签：c#, xml

我正在使用 .NET Framework 2，但无法使用 LINQ to XML。执行从加载到 XmlDocument 对象的 XML 文件中返回多列的 SQL SELECT 等效项的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:24:03.020

使用 XPath 和 SelectNodes 函数：

从链接的文章：

```
System.Xml.XmlNodeList MSPressBookList = xmldoc.SelectNodes("//Publisher[. = 'MSPress']/parent::node()/Title"); 
```

[http://support.microsoft.com/kb/318499](http://support.microsoft.com/kb/318499)

# jquery - 图像列表的多个加载微调器

> ID：12428051
> 
> 赞同：1
> 
> 时间：2012-09-14T15:58:13.717
> 
> 标签：jquery, html, image, css, animated-gif

当单个图像完成加载但遇到问题时，尝试删除加载动画。加载第一张图片后加载动画被删除，而不是在加载特定图片时单独删除。

我想要一排图像，每个图像都有自己的加载 gif，有什么想法吗？

这是我到目前为止想出的......

```
.img-container{
float:left;
width:500px;
height:500px;}
.img-loading{
position:absolute;
background:url('loading.gif') center center no-repeat;
width:500px;
height:500px;}

<div class="img-container"><div class="img-loading"></div><img src="example.jpg"    height="500" width="500" border="0"/></div>
<div class="img-container"><div class="img-loading"></div><img src="example2.jpg" height="500" width="500" border="0"/></div>
<div class="img-container"><div class="img-loading"></div><img src="example.jpg3" height="500" width="500" border="0"/></div>

$(document).ready(function(){
$('img').css({'display':'none'});
$('img').bind('load', function () { $(this).fadeIn(1500);$('.img-loading').fadeOut(2000);});                
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:04:26.197

你只需要稍微改变一下fadeOut：

```
$('img').bind('load', function () { $(this).fadeIn(1500).prev().fadeOut(2000);}); 
```

这会淡入图像并获取它之前的元素并将其淡出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:03:02.533

尝试这个：

```
$(document).ready(function(){
    $('img').css({'display':'none'});
    $('img').bind('load', function () { 
        $(this).fadeIn(1500);
        $(this).prev('.img-loading').fadeOut(2000);
    });                
}); 
```

在您的代码中，`.img-loading`当您需要指定与正在加载的图像相关的元素时，您将使用该类调用所有元素以淡出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:05:05.197

尝试一个`each()`功能

```
$('img').each(function(){
        var container = $(this).parent();
        $(this).bind('load', function () { $(this).fadeIn(1500);$('.img-loading', container).fadeOut(2000);});
}); 
```

那很粗糙可能需要改进，但基本概念是存在的。

# linux - 如何执行 x86 机器的硬件重置？

> ID：12428055
> 
> 赞同：1
> 
> 时间：2012-09-14T15:58:16.527
> 
> 标签：linux, assembly, embedded, x86, embedded-linux

我有一个在嵌入式 x86 微控制器上运行在 Linux 下的应用程序。我想保证我可以从应用程序中重置这个 CPU。

假设此时内核和操作系统可能受到威胁，因此调用“rebo​​ot”或“shutdown”将不起作用。

假设我没有看门狗定时器。即使这样，有时看门狗定时器也会被守护进程调用（例如[Busybox](http://www.busybox.net/downloads/BusyBox.html#watchdog)有一个）

是否有一些我可以编写的内联程序集会调用 x86 上的某个寄存器来重置 CPU？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T13:46:31.130

保证这将在用户空间（即您的应用程序）发生的最简单方法是编写一个系统调用，根据情况的严重性执行 arch/x86/kernel/reboot.c 中的任何一个函数。

但是，如果您最终走这条路，您可能需要确保其他应用程序无法进行该系统调用！

# android - 在 SQLiteOpenHelper 中使用 ContentResolver 可以吗？

> ID：12428056
> 
> 赞同：0
> 
> 时间：2012-09-14T15:58:19.033
> 
> 标签：android, android-contentprovider, android-contentresolver

期间`SQLiteOpenHelper.onCreate`，我需要向数据库中添加各种行。为了没有多余的代码，我想调用使用`ContentResolver`的包装函数 - 即应用程序级代码使用的函数。

但是，这样做意味着`ContentProvider`将调用`getContentResolver`并最终生成对自身的递归调用。这个可以吗？我会在某些环境中遇到问题吗？有一个更好的方法吗？

我意识到这不是最有效的方法，但数据库创建应该很少发生。我更关心的是避免冗余代码 - 具有两个具有相同`ContentValues`.put 调用的函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:08:06.017

佩里，

没有冗余代码是什么意思。您应该能够将 SqlLiteOpenHelper 用于您想要的，而不必使用内容解析器。让我知道您要做什么，我可以分享一些代码。我在项目中广泛使用 SqliteOpenHelper。

# ember.js - 从视图访问动态路由参数 - ember.js

> ID：12428057
> 
> 赞同：0
> 
> 时间：2012-09-14T15:58:25.133
> 
> 标签：ember.js

如果我在 ember.js 中有一个名为“:albumid”的动态段的路由，我如何从视图中访问它？

```
Ember.Route.extend({
    route: "/:albumid"
}) 
```

参数设置如下：

```
gotoAlbum = function(r,e) {
    router.transitionTo("album", {albumid: StuffThatReturnsTheAlbumid});
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-14T16:21:42.387

You'll need to use the albumid param in the `deserialize()` method of your route to return a context object. This context will be passed into `connectOutlets()` for your route. Within `connectOutlets()` you can pass the context along to the controller and/or view.

In the example below, an AlbumController will be created in which its `content` property is set to be the context passed into `connectOutlets()`. An AlbumView will also be created, which will have access to the controller's `content`:

```
Ember.Route.extend({
  route: "/:albumid",

  serialize: function(router, context){
    return {albumid: context.get('albumid')};
  },

  deserialize: function(router, params){
    // return a context object that will be passed into connectOutlets()
    return App.store.find(App.Album, params.albumid);
  },

  connectOutlets: function(router, context) {
    // context comes from deserialize(), and will be passed in as the
    // content property for AlbumController
    router.get('albumsController').connectOutlet('album', context);
  }
}) 
```

# python - 从运行脚本获取python安装路径

> ID：12428059
> 
> 赞同：8
> 
> 时间：2012-09-14T15:58:31.730
> 
> 标签：python

我的电脑上安装了两个版本的 python。3.2 64 位安装在 C:\Python32\ 和 2.7 32 位安装在 C:\Python27。

我还有一个 C# 应用程序在注册表（64 位和 32 位）中挖掘，以根据各种条件获取最合适的 python 版本的安装路径。

我有一个名为 Code.py 的脚本，它由 C# 应用程序使用它选择的 python 版本运行。

在 Code.py 脚本中，我想运行位于 C:\Python32\Scripts 或 C:\Python27\Scripts 中的另一个脚本，具体取决于使用的 python 版本。但是，我想知道用于运行我当前所在的脚本的那个 python.exe 文件的安装路径是什么。有没有办法做到这一点，或者我必须将 C# 应用程序选择的安装路径传达为运行脚本时的参数（我想避免）？

编辑：我使用此代码将脚本内的脚本称为外部脚本

```
p = subprocess.Popen(["python", installPath + "\\Scripts\\Flake8", file], stdout=subprocess.PIPE) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-14T16:00:16.793

使用[`sys.executable`](http://docs.python.org/library/sys.html#sys.executable).

```
>>> import sys
>>> sys.executable
'/usr/bin/python' 
```

[`os.path.split()`](http://docs.python.org/library/os.path.html#os.path.split)如果您只需要路径，则为您删除最后一个组件：

```
>>> import os.path
>>> os.path.split(sys.executable)
('/usr/bin', 'python') 
```

# mysql - mySQL：用前一行的数据填充行

> ID：12428065
> 
> 赞同：1
> 
> 时间：2012-09-14T15:58:49.393
> 
> 标签：mysql

我的数据大致如下：

```
user_id   range   start   end
10        500     1       500
11        175
12        200 
```

并需要将其转换为如下内容：

```
user_id   range   start   end
10        500     1       500
11        175     501     675
12        200     676     875 
```

所以每个后续行的起始编号是前一行的结束编号。当前行的结束编号是开始编号 + range-1。

我试图纯粹在 SQL 中执行此操作，但似乎有点卡住，因为这会产生错误：

```
UPDATE  users U
SET     start = ( SELECT end+1 FROM users U2 WHERE U2.id = U.id - 1 )
WHERE   U.id > 1; 
```

这导致`You can't specify target table 'users' for update in FROM clause`- 虽然我仍在寻找解决方案，但似乎无法找到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:04:03.407

[看看这个答案](https://stackoverflow.com/questions/45494/mysql-error-1093-cant-specify-target-table-for-update-in-from-clause)

基本上，用子查询更改您的子查询部分

```
(SELECT end+1 FROM (SELECT end, id FROM users) U2 WHERE U2.id = U.id - 1) 
```

它很脏，但它应该可以工作。请注意，如果您的表很大（并且取决于 mysql 服务器上的其他一些配置值），它会非常慢，我不建议在生产代码中使用它。此外，您假设您拥有所有后续用户 ID，但情况可能并非如此。如果您的 id 上有空白，它将在该字段上设置为 null ，否则可能会失败。

如果您的 ID 上有空白，您可以执行以下操作：

```
(SELECT end+1 FROM (SELECT end, id FROM users) U2 WHERE U2.id < U.id LIMIT 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:24:22.270

如果您有大型表，这将是一个缓慢的查询，但您可以使用交叉连接来解决这个问题。

```
UPDATE users U CROSS JOIN users U2
SET U.start = U2.end WHERE U.id = U2.id - 1; 
```

我可能会考虑有一个附加字段的想法，该字段引用包含用于其起始值的结束值的记录。当您的自动增量存在差距时，这将允许有效的自加入更新并解决问题。查询可能看起来像

```
UPDATE users U INNER JOIN users U2 on U.prev_id = U2.id
SET U.start = U2.end; 
```

# java - 将 Spring3 移至 Maven 构建并在 Eclipse 中出现错误，但运行良好

> ID：12428066
> 
> 赞同：0
> 
> 时间：2012-09-14T15:58:54.387
> 
> 标签：java, eclipse, spring, maven, spring-mvc

我将我的 Spring3 项目移动到 Maven 构建并在 Eclipse 中出现错误，但运行良好，有人可以告诉我如何解决这个问题

```
Description Resource    Path    Location    Type
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'http'.    my-security.xml /SchoolVisit/target/SchoolVisit/WEB-INF/spring  line 13 XML Problem
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'authentication-manager'.  my-security.xml /SchoolVisit/target/SchoolVisit/WEB-INF/spring  line 21 XML Problem
schema_reference.4: Failed to read schema document 'http://www.springframework.org/schema/security/spring-security-3.1.xsd', because 1) could not find the document; 2) the document could not be read; 3) the root element of the document is not <xsd:schema>.    my-security.xml /SchoolVisit/target/SchoolVisit/WEB-INF/spring  line 11 XML Problem
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'global-method-security'.  my-security.xml /SchoolVisit/target/SchoolVisit/WEB-INF/spring  line 11 XML Problem
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'http'.    my-security.xml /SchoolVisit/src/main/webapp/WEB-INF/spring line 13 XML Problem
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'global-method-security'.  my-security.xml /SchoolVisit/src/main/webapp/WEB-INF/spring line 11 XML Problem
cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'authentication-manager'.  my-security.xml /SchoolVisit/src/main/webapp/WEB-INF/spring line 21 XML Problem 
```

我的 my-serurity.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                        http://www.springframework.org/schema/security
                        http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <global-method-security pre-post-annotations="enabled" />

    <http use-expressions="true">
        <intercept-url access="hasRole('ROLE_USER')" pattern="/visit**" />
        <intercept-url pattern='/*' access='permitAll' />
        <form-login default-target-url="/visit" />

        <logout logout-success-url="/" />
    </http>

    <authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="user" password="user" authorities="ROLE_USER" />
            </user-service>

        </authentication-provider>
    </authentication-manager>
</beans:beans> 
```

这是我的 pom.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.uftwf.schoolvisit</groupId>
    <artifactId>SchoolVisit</artifactId>
    <name>School Visit</name>
    <packaging>war</packaging>
    <version>1.0.0-BUILD-SNAPSHOT</version>

    <properties>
        <java-version>1.5</java-version>
        <springframework-version>3.1.1.RELEASE</springframework-version>
        <springwebflow-version>2.3.1.BUILD-SNAPSHOT</springwebflow-version>
        <springsecurity-version>3.1.1.RELEASE</springsecurity-version>
        <org.slf4j-version>1.5.10</org.slf4j-version>
        <hibernate.version>4.1.1.Final</hibernate.version>
    </properties>

    <dependencies>
        <!-- Spring -->

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${springframework-version}</version>
            <!-- will come with all needed Spring dependencies such as spring-core 
                and spring-beans -->
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>${springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${springframework-version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.webflow</groupId>
            <artifactId>spring-faces</artifactId>
            <version>${springwebflow-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-ldap</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-cas</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-cas-client</artifactId>
            <version>3.0.7.RELEASE</version>
            <exclusions>
                <exclusion>
                    <artifactId>cas-client-core</artifactId>
                    <groupId>org.jasig.cas</groupId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>javax.transaction</groupId>
            <artifactId>jta</artifactId>
            <version>1.1</version>
        </dependency>

        <dependency>
            <groupId>javax.mail</groupId>
            <artifactId>mail</artifactId>
            <version>1.4.5</version>
        </dependency>

        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2.2</version>
        </dependency>

        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.21</version>
        </dependency>

        <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpcore</artifactId>
            <version>4.2.1</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.2.1</version>
            <exclusions>
                <exclusion>
                    <artifactId>commons-logging</artifactId>
                    <groupId>commons-logging</groupId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>1.6.2</version>
        </dependency>

        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <!-- Logging -->

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-ext</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.16</version>

        </dependency>
        <!-- JSF-303 Dependency Injection -->
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>
        <!-- Servlet -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <!-- Sun Mojarra JSF 2 runtime -->
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.7</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.7</version>
        </dependency>

        <!-- JSR 303 validation -->
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>1.0.0.GA</version>
        </dependency>

        <!-- ********************************************************************** 
            ** HIBERNATE DEPENDENCIES ** ********************************************************************** -->

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.0.2.GA</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.0.2.GA</version>
        </dependency>
        <!-- Test -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.7</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <repositories>
        <!-- For testing against latest Spring snapshots -->
        <repository>
            <id>org.springframework.maven.snapshot</id>
            <name>Spring Maven Snapshot Repository</name>
            <url>http://maven.springframework.org/snapshot</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
        <!-- For developing against latest Spring milestones -->
        <repository>
            <id>org.springframework.maven.milestone</id>
            <name>Spring Maven Milestone Repository</name>
            <url>http://maven.springframework.org/milestone</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Hibernate Validator -->
        <repository>
            <id>org.jboss.repository.releases</id>
            <name>JBoss Maven Release Repository</name>
            <url>https://repository.jboss.org/nexus/content/repositories/releases</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Sun Mojarra JSF 2 implementation -->
        <repository>
            <id>maven2-repository.dev.java.net</id>
            <name>Java.net Repository for Maven</name>
            <url>http://download.java.net/maven/2/</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For PrimeFaces JSF component library -->

    </repositories>

    <build>
    <plugins>
    <plugin>
        <groupId>org.mortbay.jetty</groupId>
        <artifactId>maven-jetty-plugin</artifactId>
        <configuration>
          <webApp>${basedir}/target/SchoolVisit.war</webApp>
        </configuration>
      </plugin>
    </plugins>

        <finalName>SchoolVisit</finalName>
    </build>
</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-18T06:49:23.223

您需要将添加 M2_REPO 类路径变量添加到 Eclipse IDE-

1.  手动添加 M2_REPO

手动定义 M2_REPO 类路径变量并将其添加到 Eclipse IDE 中。请按照以下步骤操作：

```
Eclipse IDE, menu bar
Select Window > Preferences
Select Java > Build Path > Classpath Variables
Click on the new button > defined a new M2_REPO variable and point it to your local Maven repository
Done. 
```

这是链接- [http://www.mkyong.com/maven/how-to-configure-m2_repo-variable-in-eclipse-ide/](http://www.mkyong.com/maven/how-to-configure-m2_repo-variable-in-eclipse-ide/)

然后错误将得到解决。

# spring-mvc - 无法在 Spring MVC 应用程序中点击 index.jsp

> ID：12428068
> 
> 赞同：1
> 
> 时间：2012-09-14T15:59:03.327
> 
> 标签：spring-mvc, tomcat7

我有一个在 Tomcat 7 上运行的 Spring 2.5.6 MVC 应用程序。但是，当我尝试访问下的 index.jsp 页面时`http://localhost:8080/myapp-web/`，出现 404 错误。上下文根是 /myapp-web/。

servlet.xml：

```
...
<bean name="/app.htm" class="com.myapp.web.MyAppController">
        ...
  </bean>
 <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
      <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"></property>
    <property name="prefix" value="/WEB-INF/jsp/" />
      <property name="suffix" value=".jsp"></property>        
  </bean> 
```

WEB-INF下的jsp文件为：index.jsp，在web.xml中列出为：

```
<servlet-mapping>
    <servlet-name>myapp</servlet-name>
    <url-pattern>*.htm</url-pattern>
  </servlet-mapping>

  <welcome-file-list>
    <welcome-file>
      index.jsp
    </welcome-file>
  </welcome-file-list>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>

  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
  </context-param>

  <servlet>
    <servlet-name>myapp</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet> 
```

这里的一切似乎都是正确的，但由于我得到了 404，我意识到我没有找到资源。关于我在这里做错了什么的任何想法？

**后果：**

原始代码可能还有另一个问题，但我能够得到另一个教程，并且我从得到的答案中更好地理解了映射。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:01:40.190

您应该更改`<property name="prefix" value="/WEB-INF/jsp/" />`或`<property name="prefix" value="/WEB-INF/" />`将 index.jsp 移动到`/WEB-INF/jsp/`...

**编辑：**

尝试更改`servlet-mapping`为：

```
<servlet-mapping>
  <servlet-name>myapp</servlet-name>
  <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

# javascript - 对 ExtJs 4 的 spket 支持

> ID：12428069
> 
> 赞同：0
> 
> 时间：2012-09-14T15:59:09.290
> 
> 标签：javascript, extjs, extjs4, extjs4.1

我安装了 spket 并执行了以下链接中列出的所有步骤，以在 Eclipse IDE 中设置自动完成功能支持，但不幸的是 suto 完成不起作用：

[http://ria.arunkumarm.com/2010/09/setting-up-eclipse-ide-for-extjs-jquery.html](http://ria.arunkumarm.com/2010/09/setting-up-eclipse-ide-for-extjs-jquery.html)

我相信我可能会丢失一些罐子（可能是）。有人可以告知第 9 步所指的链接是什么吗？它在谈论哪个图书馆？通过成功添加 ext.jsb2 文件，我已经完成了第 8 步。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T05:16:38.963

您需要为 ExtJS 4 添加 sdk.jsb3 文件。

ext.jsb2 用于 ExtJS 3

下载最新的[Spket](http://www.spket.com/download.html)插件。

请参阅配置[链接](http://www.spket.com/extjs.html)。

# sql - 子查询返回超过 1 个值错误

> ID：12428075
> 
> 赞同：0
> 
> 时间：2012-09-14T15:59:31.280
> 
> 标签：sql, sql-server, database, select

我在更大的查询中有以下子查询。我收到错误“子查询返回超过 1 个值”。我不确定如何解决这个问题，并且仍然会发生两个查询的结果划分。我正在使用 SQL Server 2005。

谢谢。

```
SELECT 
    sample_fields, -- some fields here
    (SELECT 
        c1/c2 AS department_occupancy_rate  -- doing division of results of both queries
     FROM 
        property as c
        JOIN (
               SELECT store_id, cast(count(*) as decimal(10,2)) AS c1
               FROM property 
               WHERE 
                   non_ha =1 
               AND property_type LIKE '%587%'     
               GROUP BY store_id
             ) AS sub1 
             ON c.store_id = sub1.store_id
             JOIN (
                SELECT store_id, cast(count(*) as decimal(10,2)) AS c2
                FROM property 
                WHERE 
                    property_type LIKE '%587%'
                GROUP BY store_id
             ) AS sub2 
             ON c.store_id = sub2.store_id
        ) as results,
FROM 
    sample_table -- a table here
    INNER JOIN sample_table1 
    ON sample_table2 -- joining here
GROUP BY sample_field -- grouping 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:09:35.323

好吧，这不清楚您想要做什么，因为没有条件可以将内部查询与外部查询相关联。我想这将是一个 store_id，如果是，你应该这样做：

```
SELECT sample_fields,-- some fields here
       results.department_occupancy_rate
FROM   sample_table -- a table here
       INNER JOIN sample_table1
               ON sample_table2 -- joining here
       JOIN (SELECT c.store_id,
                    c1 / c2 AS department_occupancy_rate
             -- doing division of results of both queries
             FROM   property AS c
                    JOIN (SELECT store_id,
                                 Cast(Count(*) AS DECIMAL(10, 2)) AS c1
                          FROM   property
                          WHERE  non_ha = 1
                                 AND property_type LIKE '%587%'
                          GROUP  BY store_id) AS sub1
                      ON c.store_id = sub1.store_id
                    JOIN (SELECT store_id,
                                 Cast(Count(*) AS DECIMAL(10, 2)) AS c2
                          FROM   property
                          WHERE  property_type LIKE '%587%'
                          GROUP  BY store_id) AS sub2
                      ON c.store_id = sub2.store_id) AS results
         ON ( sample_table.store_id = results.store_id )
GROUP  BY sample_field -- grouping 
```

# matlab - 最接近一组曲面的点

> ID：12428078
> 
> 赞同：1
> 
> 时间：2012-09-14T15:59:37.607
> 
> 标签：matlab, optimization, minimization

我有这些表面由它们在空间中的位置（x，y，z）定义。理想情况下，它们应该相交，但并非总是如此。但是，应该有一个点与所有表面的 Ecludian 距离最短。我的曲面没有解析表达式。我如何找到这一点，而不是遍历所有可能的候选人，这可能是数千人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:10:43.057

如果您知道这些表面背后的数学方程，我建议您通过制定最小二乘问题并解析求解来找到最近点。

如果您对这些表面一无所知，您应该尝试：

1.  穷举搜索 - 缓慢，但在可行的情况下，它总是有效的。
2.  某种非线性优化方法，例如`fminsearch`. 如果这些网格有足够的点，您可以简单地找到最近的点。如果没有，您也应该进行某种插值。如果您有一些起点，请将其提供给算法。

# java - 在 Android 中从 GUI 处理后台服务

> ID：12428080
> 
> 赞同：-1
> 
> 时间：2012-09-14T15:59:45.213
> 
> 标签：java, android

我在广播接收器的启动宽度上启动服务：

```
public class Autostart extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent arg1) {
        Intent intent = new Intent(context, MyService.class);
        MyService.setContext(context);
        context.startService(intent);
    }
} 
```

这很有效，当我启动手机时，服务正在后台运行。然后我想从我的 GUI 停止/启动/重新启动服务：

```
Intent intent = new Intent(MyService.getContext(), MyService.class);
getActivity().stopService(intent); 
```

但它不会杀死任务。我认为当上下文相同时，这必须工作，所以我制作了一个静态内容持有者，但它不起作用。

请注意，我可以从该代码轻松启动服务并停止启动的服务。

如何停止该自动启动/后台服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:02:50.043

要调用任何 android 后台服务，请执行以下操作

首先添加创建一个获取服务类，然后调用它

```
public class FetchUnreadMailService extends Service {

    private NotificationManager mNotificationManager;
    private int SIMPLE_NOTFICATION_ID;
    private Timer myTimer;
    Session mySession;      
    int unread_count = 0;

    @Override
    public IBinder onBind(Intent arg0) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();

        myTimer = new Timer();
        myTimer.schedule(new TimerTask() {
            @Override
            public void run() {

                    mySession = new Session();
                     if(mySession.getStatus()){
                            APIHelper api = new APIHelper();
                            unread_count =  (Integer) api.getMailBoxNotification(mySession.getUserId());
                            }
                        if(unread_count>0){
                            mNotificationManager = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);
                            Intent notifyIntent = new Intent(FetchUnreadMailService.this,MailBox.class);
                            Context context = getApplicationContext();
                            CharSequence contentTitle = "New Mail";
                            CharSequence contentText = "You Have ("+ unread_count +") unread mails";
                            PendingIntent intent = PendingIntent.getActivity(FetchUnreadMailService.this, 0,notifyIntent, android.content.Intent.FLAG_ACTIVITY_NEW_TASK);
                            final Notification notifyDetails = new Notification(R.drawable.youtube,"New Alert, Click Me!",System.currentTimeMillis());  
                            notifyDetails.setLatestEventInfo(context, contentTitle, contentText, intent);
                            notifyDetails.flags= Notification.FLAG_AUTO_CANCEL;//for auto cancel notification
                            mNotificationManager.notify(SIMPLE_NOTFICATION_ID, notifyDetails);  
                            }   

            }

        }, 0, 30000);

    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Toast.makeText(this, "Service destroyed ...", Toast.LENGTH_LONG).show();
    }

} 
```

创建此类后，通过以下方式调用它

```
startService(new Intent(Home.this,FetchUnreadMailService.class)); 
```

有关更多详细信息，请查看以下链接[http://grabcodes.blogspot.com](http://grabcodes.blogspot.com)

# spring - JPA 和 Hibernate 中的 LazyInitializationException

> ID：12428085
> 
> 赞同：15
> 
> 时间：2012-09-14T16:00:05.617
> 
> 标签：spring, hibernate, jpa

我知道这个问题已经在这里和互联网上被问过很多次，我已经阅读了许多答案，但我仍然不明白解决这个问题的正确方法。我正在尝试使用 Spring MVC 和 JPA，每次访问延迟加载的属性时，我都会收到 LazyInitializationException。

这是我正在试验的一些代码：

```
@Repository
public class MyDAO {
    private static final Logger logger = LoggerFactory.getLogger(MyDAO.class);

    @PersistenceContext
    private EntityManager em;

    @Transactional
    public void logDOI() {
        DOI myDOI = em.find(DOI.class, Long.valueOf(1));

        // This line gives the expected output
        logger.info("Fetched DOI: " + myDOI.getDoiKey());

        // This line throws the LazyInitalizationException
        for(DOIMembership m : myDOI.getDoiMemberships()) {
            logger.info("Got DOI Membership id: " + m.getId());
        }
    }
} 
```

我正在访问的实体：

```
@Entity
@Table(name="DOI")
public class DOI implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @SequenceGenerator(name="DOI_ID_GENERATOR", sequenceName="DOI_SEQ")
    @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="DOI_ID_GENERATOR")
    private long id;

    // Other properties omitted

    //bi-directional many-to-one association to DOIMembership
    @OneToMany(mappedBy="doi", fetch=FetchType.LAZY)
    private Set<DOIMembership> doiMemberships;

    public DOI() {
    }

    public long getId() {
        return this.id;
    }

    public void setId(long id) {
        this.id = id;
    }

    // Other Accessors Omitted

} 
```

从 DOI 引用的实体

```
@Entity
@Table(name="DOI_MEMBERSHIP")
public class DOIMembership implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @SequenceGenerator(name="DOI_MEMBERSHIP_ID_GENERATOR", sequenceName="DOI_MEMBERSHIP_SEQ")
    @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="DOI_MEMBERSHIP_ID_GENERATOR")
    private long id;

    //bi-directional many-to-one association to DOI
    @ManyToOne(fetch=FetchType.LAZY)
    @JoinColumn(name="DOI_ID")
    private DOI doi;

    @Column(name="GROUP_ID")
    private BigDecimal groupId;

    @Column(name="DATA_SET")
    private BigDecimal dataSetId;

    public DOIMembership() {
    }

    public BigDecimal getGroupId() {
        return groupId;
    }

    public BigDecimal getDataSetId() {
        return dataSetId;
    }

    public void setDataSetId(BigDecimal dataSetId) {
        this.dataSetId = dataSetId;
    }

    public void setGroupId(BigDecimal groupId) {
        this.groupId = groupId;
    }

    public long getId() {
        return this.id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public DOI getDoi() {
        return this.doi;
    }

    public void setDoi(DOI doi) {
        this.doi = doi;
    }

} 
```

Spring MVC 控制器：

```
@Controller
@RequestMapping("/summary")
public class DOISummaryController {
    @Autowired
    MyDAO myDAO;

    @RequestMapping()
    public String DOISummary() {
        myDAO.logDOI();

        return "home";
    }
} 
```

我的弹簧配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:task="http://www.springframework.org/schema/task"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/task
        http://www.springframework.org/schema/task/spring-task-3.0.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <!-- Root Context: defines shared resources visible to all other web components -->

    <context:property-placeholder location="WEB-INF/spring/root-context.properties, WEB-INF/spring/datasource-context.properties"  />

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName">
            <value>oracle.jdbc.driver.OracleDriver</value>
        </property>
        <property name="url">
            <value>${Url}</value>
        </property>
        <property name="username">
            <value>${Username}</value>
        </property>
        <property name="password">
            <value>${Password}</value>
        </property>
    </bean>

    <bean id="emf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
        </property>
        <property name="packagesToScan" value="org.myorg.doi.domain" />
        <property name="jpaProperties">
            <props>
                <prop key="hibernate.dialect">
                    org.hibernate.dialect.Oracle10gDialect
                </prop>
                <prop key="hibernate.max_fetch_depth">3</prop>
                <prop key="hibernate.jdbc.fetch_size">50</prop>
                <prop key="hibernate.jdbc.batch_size">10</prop>
                <prop key="hibernate.show_sql">true</prop>
            </props>
        </property>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="emf" />
    </bean>

    <tx:annotation-driven transaction-manager="transactionManager" />

    <context:annotation-config />

    <task:annotation-driven />

    <context:component-scan base-package="org.myorg.doi" />

</beans> 
```

和堆栈跟踪，根据要求：

```
SEVERE: Servlet.service() for servlet [appServlet] in context with path [/DOI] threw exception [Request processing failed; nested exception is org.hibernate.LazyInitializationException: could not initialize proxy - no Session] with root cause
org.hibernate.LazyInitializationException: could not initialize proxy - no Session
    at org.hibernate.collection.internal.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:430)
    at org.hibernate.collection.internal.AbstractPersistentCollection.read(AbstractPersistentCollection.java:121)
    at org.hibernate.collection.internal.PersistentSet.iterator(PersistentSet.java:180)
    at org.myorg.doi.dao.MyDAO.logDOI(MyDAO.java:27)
    at org.myorg.doi.web.DOISummaryController.DOISummary(DOISummaryController.java:29)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213)
    at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126)
    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at com.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.traceNextValve(HttpRequestOperationCollectionValve.java:116)
    at com.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.invoke(HttpRequestOperationCollectionValve.java:98)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680) 
```

你可以看到，我正在尝试使用纯 JPA，并且只使用 Hibernate 作为 JPA 提供程序。

我了解该异常是由会话与实体分离引起的。但是，我认为如果我们当前处于事务中就不会发生这种情况，因为 logDOI 方法是用@Transactional 注释的，所以应该是这种情况。

当然，如果我将 FetchType 更改为 EAGER，一切都会完美运行，但似乎我不应该这样做。

我也知道 OpenEntityManagerInViewFilter 但如果我在使用 @Transactional 注释的 DAO 中保留对我的实体的所有访问权限（或通过我不知道的其他方式），我似乎也不必使用它。

我认为我可能错误地处理了这个问题，但我不知道正确的方法是什么。应该如何有效地使用延迟加载的属性？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-17T16:30:54.790

感谢 Shailendra，我开始仔细查看交易并注意到交易从未开始。有了这些信息，我做了一些调查，发现：[Spring @Transaction not started transactions](https://stackoverflow.com/questions/7561360/spring-transaction-not-starting-transactions)。我输入`<tx:annotation-driven/>`了我的 servlet-context.xml 文件，突然 logDOI 的事务启动了，一切正常；我不再得到 LazyInitializationException。我完全不清楚为什么会这样。任何有关这方面的信息将不胜感激。

更新：

我想到了。我的一个关键问题是在 servlet-context.xml 文件中。这就是它的样子

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <annotation-driven />

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
    <resources mapping="/resources/**" location="/resources/" />

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
    <beans:bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

    <context:component-scan base-package="org.myapp.doi" />

</beans:beans> 
```

主要问题是在这种情况下：组件扫描线。Spring MVC 创建 bean 实例化的两个上下文：在 web.xml 文件中使用 contextConfigLocation 参数定义的根应用程序上下文和在 web.xml 文件中的 DispatcherServlet 中定义的 servlet 上下文。servlet 上下文可以看到应用程序上下文，但反之则不行。现在，由于在 servlet 上下文中定义了 context:component-scan 并扫描了**整个**应用程序命名空间，我的 DAO 正在 servlet 上下文中被实例化。但是，事务注释扫描是在应用程序上下文中完成的，并且无法从那里完成它的 AOP 代理内容。只需修改 servlet 上下文中的 context:component-scan 以仅扫描 MVC 控制器（`<context:component-scan base-package="org.myapp.doi.web" />`修复一切；DAO 是在应用程序上下文中创建的，并为事务正确设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-16T10:36:02.503

解决此问题的最佳方法是首先了解会话关闭的原因和时间，尽管处于单个事务下。最好的方法是在 log4j 配置中启用休眠（当您使用休眠作为 JPA 提供程序时）日志级别到 DEBUG 并跟踪会话关闭的位置。这会给你一个清晰的画面。尽管堆栈跟踪表明底层会话已关闭，但显然没有原因？您可以发布记录的相关调试/信息消息。

您还可以为 Spring 框架设置日志记录以跟踪事务管理基础架构

日志在底层会话关闭和事务提交时给出了相当好的消息。

例如，

```
opened session at timestamp: 13476520251
............
...........
after transaction begin
..............

select x,y,z from......
...............
...commit
..........
..flushing session
..after transaction completion
..closing session 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-29T01:26:47.500

我也遇到了这个问题，但是受到您的回答的启发，我解决了。就这个。

我的应用程序尝试使用 Jpa Repository 处理休息控制器中的数据，结果出现无会话错误。这是代码：

```
@RequestMapping(value = "/create", method = POST, consumes = MediaType.APPLICATION_JSON_VALUE)
public ResponseEntity<Void> create(@RequestBody Map<String, Object> params) {
    Project project = Factory.project().build(params);
    project = repository.save(project);
    return ResponseEntity.ok().build();
} 
```

根据这篇[文章](https://stackoverflow.com/questions/3652090/difference-between-applicationcontext-xml-and-spring-servlet-xml-in-spring) 和这篇[文章](https://stackoverflow.com/questions/11708967/what-is-the-difference-between-applicationcontext-and-webapplicationcontext-in-s)，我们知道 servlet 上下文中的 bean 可以引用应用程序上下文中的 bean。所以 TransactionManager 不能访问这个 rest 控制器 bean，导致这个错误。

解决方案，在 rest 控制器和存储库之间创建一个中间层 bean 应用程序上下文，封装那些代码。我试了一下，效果很好。稍后更新代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T17:00:43.773

首先，对于使用@Autowired 设置的任何依赖项，您必须为您将使用的每个DAO 声明一个Spring Bean，它将在运行时注入。

也许这些 DAO 需要有这样的 sessionFactory 引用：

```
<!-- a dao in which you inject your Hibernate SessionFactory bean by its own id -->
<bean id="userDAO" class="com.enterprise.model.dao.UserDAO">
    <property name="sessionFactory">
        <ref bean="sessionFactoryId" />
    </property>
</bean>

<!-- activate the @Repository annotation -->
<bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor" /> 
```

其次，也许你忘记在你的 Spring XML 配置中添加这个：

```
<!-- Add JPA support -->
<bean id="emf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="loadTimeWeaver">
        <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver"/>
    </property>
</bean>

<!-- Add Transaction support -->
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="emf"/>
</bean> 
```

第三，你的拦截器的东西：

```
<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
    <property name="interceptors">
        <list>
            <ref bean="openEntityManagerInViewInterceptor"/>
        </list>
    </property>
</bean>

<bean id="openEntityManagerInViewInterceptor"
      class="org.springframework.orm.jpa.support.OpenEntityManagerInViewInterceptor">
    <property name="entityManagerFactory" ref="entityManagerFactory" /> 
```

# python - 获取文件并以另一种方法放入列表

> ID：12428089
> 
> 赞同：0
> 
> 时间：2012-09-14T16:00:38.413
> 
> 标签：python, file, directory

我有一个包含文件的目录，我需要获取这些文件的列表以放入另一个方法。它是在 webassets (https://github.com/miracle2k/webassets) 的上下文中，所以它看起来像这样，具体情况：

```
app_css = Bundle('app_assets/css/base.css',
                 'app_assets/css/layout.css',,
                 output='output.css',
                 filters='cssmin') 
```

我想成为这样：

```
app_css = Bundle( {any number of files in a directory},
                 output='output.css',
                 filters='cssmin') 
```

所以我需要检索一个可能不同且不固定的文件列表，然后将该列表放入另一个函数中，而不是对每个更改进行硬编码。

我从上次不成功的尝试中得到了这个：

```
csspath = "{}/static/css".format(os.path.dirname(__file__))
csss = [["app_assets/css/{}".format(files)] for files in os.listdir(csspath)]
app_css = Bundle("{}".format(*csss), output="packed.css", filters="cssmin") 
```

但这不对。其中一个问题是我只需要文件名，因为它是一个烧瓶蓝图，需要使用“app_assets/directory/files”格式。

这是 basic-python-should-be-easy-101 和学习经验，我会明白的，但现在我回到这个我对其他解决方案、建议等感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:05:01.563

如果要获取目录中所有`css`文件的列表，可以使用该`glob`模块：

```
my_files = glob.glob('path_to_the_directory/*.css') 
```

基本上`glob`会像 shell 中的文件名一样扩展。您也可以将它用于目录。例如这个：

```
glog.glob('My/dir/*/*.css') 
```

将返回以“.css”结尾且位于“My/dir”子目录中的所有文件名的列表。

编辑：您的三行代码的“翻译”：

```
csspath = os.path.join(os.path.dirname(__file__), 'static', 'css')
csss = [os.path.join('app_assets', 'css', fname) for fname in os.listdir(csspath)]
app_css = Bundle(*csss, output='packed.css', filters='cssmin') 
```

但我不明白您是否只是想改进它们或原始版本不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:14:58.730

Python 教程，§4.7.4，[“解包参数列表”](http://docs.python.org/tutorial/controlflow.html#unpacking-argument-lists)：

```
app_css = Bundle(*['app_assets/css/base.css',
                 'app_assets/css/layout.css'],
                 **dict(output='output.css',
                 filters='cssmin')) 
```

# spring - 在 JBoss 7.1 上的 Spring 应用程序中休眠日志记录

> ID：12428094
> 
> 赞同：2
> 
> 时间：2012-09-14T16:00:56.917
> 
> 标签：spring, hibernate, logging, log4j

我有与 Hibernate 集成的 Spring MVC 应用程序。

我正在尝试使用 Log4j 记录 jdbc SQL 语句参数，但它不起作用。我的 log4j.properties 配置文件似乎没有做任何更改。这是项目配置：

我正在使用 Maven、Eclipse 和 log4j.properties 文件位于项目源文件夹的顶部（所以我在类路径中理解）。

pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>TestProject</groupId>
  <artifactId>TestProject</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <properties>
    <org.hibernate.version>3.6.0.Final</org.hibernate.version>
    <org.springframework.version>3.1.2.RELEASE</org.springframework.version>
    <org.apache.tiles.version>2.2.2</org.apache.tiles.version>
    <slf4j-log4j12.version>1.7.0</slf4j-log4j12.version>
  </properties>
  <dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${org.springframework.version}</version>
        <scope>runtime</scope>
        <exclusions>
            <exclusion>
                <artifactId>commons-logging</artifactId>
                <groupId>commons-logging</groupId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>${org.hibernate.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.hsqldb</groupId>
        <artifactId>hsqldb</artifactId>
        <version>2.2.8</version>
    </dependency>
    <dependency>
        <groupId>org.javassist</groupId>
        <artifactId>javassist</artifactId>
        <version>3.16.1-GA</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-extras</artifactId>
        <version>${org.apache.tiles.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-web</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-config</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>cglib</groupId>
        <artifactId>cglib</artifactId>
        <version>2.2</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>${slf4j-log4j12.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${slf4j-log4j12.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>${slf4j-log4j12.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.17</version>
    </dependency>
  </dependencies>
</project> 
```

log4j.properties

```
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Target=System.out
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n

log4j.rootLogger=ERROR, stdout

log4j.logger.main.mvc.model.hibernate=DEBUG

log4j.logger.org.hibernate=INFO
log4j.logger.org.hibernate.SQL=DEBUG
log4j.logger.org.hibernate.type=TRACE 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T19:41:04.517

好的。所以我终于让它工作了！

所有这些问题都是由 JBoss AS 7.1 造成的。

所以这里是如何在 JBoss AS 7.1 上运行的 Spring MVC 应用程序上设置 slf4j+log4j 日志记录：

1.  有内置的 JBoss 模块必须关闭所以 - 将**jboss-deployment-structure.xml**添加到您的**META-INF/**目录
2.  您必须在类路径中有这些库：**log4j.jar**、**slf4j-api.jar**、**slf4j-log4j12.jar**、**jcl-over-sfl4j.jar**。Spring 的默认**common-logging.jar**必须从类路径中排除。
3.  您必须在类路径中有**log4j.properties**或**log4j.xml**文件。

这些文件让我可以控制日志，我实现了我的目标——记录 Hibernate SQL 语句参数。

jboss-部署-结构.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-deployment-structure>
    <deployment>
        <exclusions>
            <module name="org.apache.log4j" />
            <module name="org.slf4j" />
            <module name="org.slf4j.impl" />
        </exclusions>
    </deployment>
</jboss-deployment-structure> 
```

pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>bladositto</groupId>
  <artifactId>TestLogging</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <properties>
    <org.hibernate.version>3.6.0.Final</org.hibernate.version>
    <org.springframework.version>3.1.2.RELEASE</org.springframework.version>
    <org.apache.tiles.version>2.2.2</org.apache.tiles.version>
    <slf4j-log4j12.version>1.7.0</slf4j-log4j12.version>
  </properties>
  <dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${org.springframework.version}</version>
        <scope>runtime</scope>
        <exclusions>
            <exclusion>
                <artifactId>commons-logging</artifactId>
                <groupId>commons-logging</groupId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>${org.hibernate.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.hsqldb</groupId>
        <artifactId>hsqldb</artifactId>
        <version>2.2.8</version>
    </dependency>
    <dependency>
        <groupId>org.javassist</groupId>
        <artifactId>javassist</artifactId>
        <version>3.16.1-GA</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-extras</artifactId>
        <version>${org.apache.tiles.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-web</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-config</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>cglib</groupId>
        <artifactId>cglib</artifactId>
        <version>2.2</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>${slf4j-log4j12.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${slf4j-log4j12.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>${slf4j-log4j12.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.17</version>
    </dependency>
  </dependencies>
</project> 
```

log4j.properties

```
log4j.rootLogger=INFO, A1, R

log4j.appender.A1=org.apache.log4j.ConsoleAppender
log4j.appender.A1.Target=System.out
log4j.appender.A1.layout=org.apache.log4j.PatternLayout
log4j.appender.A1.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n

log4j.appender.R=org.apache.log4j.RollingFileAppender
log4j.appender.R.File=example.log
log4j.appender.R.MaxFileSize=100KB
log4j.appender.R.MaxBackupIndex=1
log4j.appender.R.layout=org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern=%p %t %c - %m%n

log4j.logger.org.hibernate.SQL=DEBUG
log4j.logger.org.hibernate.type=TRACE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T08:10:30.180

您在 log4j 配置中使用它

```
org.apache.commons.digester.Digester=INFO
org.hibernate=INFO
org.springframework.orm=DEBUG,stdout 
```

而它应该是

```
log4j.logger.org.apache.commons.digester.Digester=INFO
log4j.logger.org.hibernate=INFO
log4j.logger.org.springframework.orm=DEBUG,stdout 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:24:22.130

`hibernate.cfg.xml`在您的或您的中尝试以下内容`persistence.xml`：

```
<property name="hibernate.show_sql">true</property>
<property name="hibernate.use_sql_comments">true</property> 
```

加上您的以下内容`log4j.properties`：

```
log4j.rootLogger=INFO,stdout

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Threshold=INFO
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{dd/MM/yyyy HH:mm:ss} %-5p %x - %m%n

org.apache.commons.digester.Digester=INFO
org.hibernate=INFO
org.springframework.orm=DEBUG,stdout 
```

如果你把这两个文件放在你的 webapp 的类路径中，我毫不怀疑你会有日志。

使用 Maven，您应该将这些文件放在文件夹`src/main/resources`中。`target`如果您执行“mvn clean package”，它们将被打包在您将获得的结果文件夹中。

要声明一个 slf4j 记录器，你应该这样做：

```
public class User {
    public static final Logger logger = LoggerFactory.getLogger(User.class);

    //fields getters and setters...

    public User() {

    }

    public User(DTO userDTO) {
        this.username = userDTO.username;
        // etc.
        logger.debug("your user was initialized with the DTO, see this.toString()=?", this.toString());
    } 

    //etc. some other methods, if any

    //toString()
    public String toString() {
        //return a String representation of an User object.
    }
} 
```

要限制特定附加程序的日志级别，您应该使用：

```
log4j.logger.appenderName.packageName.className=LEVEL 
```

请注意，您当前正在使用：

```
log4j.logger.packageName.className=LEVEL 
```

祝你好运！

# c# - 以编程方式检测上下文切换

> ID：12428098
> 
> 赞同：4
> 
> 时间：2012-09-14T16:01:03.013
> 
> 标签：c#, cpu

我想知道是否可以在每次我的代码检测到发生 CPU 上下文切换时检测并执行一些操作（而不是计算在特定时间段内发生了多少次上下文切换）。无论如何要在 C# 中执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T16:08:05.100

不，这在 C# 中是不可能的。因为 C# 是一种在用户模式下运行代码的托管语言。上下文切换源自用户级代码无法访问的内核模式。

这可能使用 C 驱动程序，但是，代码可能会严重损害操作系统的性能和稳定性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:08:57.600

上下文切换是非常低级的内核活动，因此（我不确定）这种钩子不太可能存在。

您肯定无法使用在正常 .Net 运行时运行的代码来做到这一点，至少因为它不会让您完全控制线程并且不会在内核模式下运行。

现在，如果问题是“我可以在 C# 中编写内核代码”而不是 - 是*（*- 我不相信有可用的 C# 编译器可以生成可以在内核级别执行的本机代码 - 编写你自己的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-20T01:18:47.970

我认为使用带有 getrusage()的[纯 C可能是有用的信息](https://stackoverflow.com/a/9317908/751932)

```
struct rusage {
 ...
    long   ru_nvcsw;         /* voluntary context switches */
    long   ru_nivcsw;        /* involuntary context switches */
}; 
```

但我不知道 C#

# vb.net - 为什么我的 Excel 工作簿在 Excel 2010 中不可见？

> ID：12428101
> 
> 赞同：2
> 
> 时间：2012-09-14T16:01:10.283
> 
> 标签：vb.net, excel, excel-2010

我一直在使用 .xlsx 文件运行 excel 导出功能。有时在加载 excel 文件时，我会使用 System.Runtime.InteropServices.Marshal.BindToMoniker() 方法。当有问题的文件*未*打开但存在时，我得到以下结果：

Excel 将启动，但不会加载工作簿，也不会加载任何工作表。Excel 显示为空白。

在执行导出的程序之外打开文件时，它以完全相同的方式加载。Excel 已打开，窗口顶部显示 Microsoft Excel，但没有可见工作表。Excel 看起来根本没有打开任何东西。

进入选项还表明没有打开工作簿。该文件肯定有内容，当我在 Notepad++ 中打开它时可以看到该文件有足够的细节让我看到工作簿中有工作表，但没有显示。

我不确定如何以编程方式防止这种损坏发生，或者如何修复它。任何建议或想法将不胜感激！

为了避免这个问题，我从不在关闭的 Excel 文件上使用 BindToMoniker（通过检查文件是否被锁定，如果它被解锁，我只使用 open 函数）

这是我遇到此问题时运行的代码。仅当文件存在且未打开时才会发生：

```
 Public Function OpenExcelFile( _
    ByRef pobjExcel As Excel.Application, _
    ByRef pwkbWorkBook As Excel.Workbook, _
    ByVal pstrFileName As String) As Boolean 
```

...

```
pwkbWorkBook = BindToMoniker(pstrFileName)
            pobjExcel = pwkbWorkBook.Parent
            pobjExcel.Visible = True 'Temp; I use this to see the state of the file 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T20:25:46.047

难道是工作簿被隐藏了？在视图选项卡上，如果启用取消隐藏，您可以显示隐藏的工作簿。

此外，如果您认为工作簿应该可见，您可以通过更新 Windows 可见属性来显示它。

```
pobjExcel.Windows(workbookName).Visible = True 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T20:25:24.497

只需添加

```
pobjExcel.Windows(1).Visible = True 
```

在您将 Excel 设置为可见的位置之后。我相信您正在使应用程序可见，但工作簿仍然不可见（至少这是我之前遇到的问题）。这应该解决它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-28T15:52:41.063

我在 excel 2010 中遇到了同样的问题。今天早些时候，我保存了文件并关闭了 excel。我的电脑进入睡眠模式，当我重新启动并使用 Windows 资源管理器打开相同的 excel 2010 文件时，excel 只显示一个空白（灰色）屏幕。只有在 VBA 编辑器中，我才能看到工作簿已打开。

我的解决方案（与上述相同但已详细说明）

*   使用 ALT + F11 打开 VBA 编辑器
*   在左上角项目资源管理器树形视图中，点击刚刚打开的没有出现在excel前端的工作簿
*   打开直接窗口（CTRL + G）
*   键入“Windows(thisworkbook.name).Visible = True”，然后按 Enter

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-13T23:54:58.310

试试这个

转到查看菜单并点击全部排列。它会给你一些选项复选标记平铺。

它对我有用，希望对你也有用。

最好的，汗

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-13T14:51:10.943

这个简单的解决方案对我有用：打开工作表并转到“查看”选项卡，然后单击“新窗口”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-13T16:41:19.460

我在 2015 年 1 月 1 日对整个工作表不可见时遇到了同样的问题，我转到“查看”菜单并单击“取消隐藏”图标所有选项卡都变得可见，我再次快速保存了文件；-)

# ios - iOS - 如何使用 openGL 绘制 YUV 图像

> ID：12428108
> 
> 赞同：15
> 
> 时间：2012-09-14T16:01:22.067
> 
> 标签：ios, opengl-es, yuv

目前，我正在尝试使用 openGL 绘制图像（图像经常更新，因此必须重新绘制）。以前，我将我的图像从 YUV 转换为 RGB，然后使用这个新图像使用 openGL 进行绘制。一切正常，但转换过程并不是特别快。

我现在正在尝试更改代码，以便在 openGL 着色器中处理转换。环顾四周后，我发现了一些代码片段（特别是着色器和我的 renderImage 函数的大部分），它们帮助我获得了基线，但我似乎无法真正让图像正确绘制——我曾经看到的是黑色图像。

我很可能遗漏了一些极其简单和重要的东西——我对 openGL 的经验相当有限。如果有人可以看一下，看看他们是否发现有任何问题，请告诉我。

我应该指出，我正在尝试支持 iOS 4.x，所以 CVOpenGLESTextureCacheCreateTextureFromImage 不应该可用（即使我想，我也不是很肯定如何设置使用它）。

任何帮助，将不胜感激。下面的代码 -

我的顶点着色器：

```
attribute vec4 position;
attribute vec4 inputTextureCoordinate;

varying vec2 textureCoordinate;

void main()
{
    gl_Position = position;
    textureCoordinate = inputTextureCoordinate.xy;
} 
```

片段着色器：

```
#ifdef GL_ES
precision mediump float;
#endif

varying vec2 textureCoordinate;

uniform sampler2D videoFrame;
uniform sampler2D videoFrameUV;

const mat3 yuv2rgb = mat3(
                          1, 0, 1.2802,
                          1, -0.214821, -0.380589,
                          1, 2.127982, 0
                          );

void main() {
    vec3 yuv = vec3(
                    1.1643 * (texture2D(videoFrame, textureCoordinate).r - 0.0625),
                    texture2D(videoFrameUV, textureCoordinate).r - 0.5,
                    texture2D(videoFrameUV, textureCoordinate).a - 0.5
                    );
    vec3 rgb = yuv * yuv2rgb;

    gl_FragColor = vec4(rgb, 1.0);
} 
```

渲染图像函数：

```
-(void)renderImage:(ImageBuffer *)image
{
    if (image)
    {        
        int bufferHeight = image->GetHeight();
        int bufferWidth = image->GetWidth();

        if(!imageTexture){
            // Dealing with the Y portion of the YCbCr
            glActiveTexture(GL_TEXTURE0);
            glGenTextures(1, &imageTexture);
            //Bind Y texture
            glBindTexture(GL_TEXTURE_2D, imageTexture);
            glUniform1i(uniforms[UNIFORM_VIDEOFRAME], 0);
            // For fitting
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
            // This is necessary for non-power-of-two textures
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);

            glTexImage2D(GL_TEXTURE_2D, 0, GL_LUMINANCE, bufferWidth, bufferHeight, 0, GL_LUMINANCE, GL_UNSIGNED_BYTE, image->GetPlanePointer(0));

            // Dealing with the CbCr potion of the YCbCr
            glActiveTexture(GL_TEXTURE1);
            glGenTextures(1, &imageTextureUV);
            //Bind CbCr texture
            glBindTexture(GL_TEXTURE_2D, imageTextureUV);
            glUniform1i(uniforms[UNIFORM_VIDEOFRAMEUV], 1);
            // For fitting
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
            // This is necessary for non-power-of-two textures
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
            glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);

            glTexImage2D(GL_TEXTURE_2D, 0, GL_LUMINANCE_ALPHA, bufferWidth/2, bufferHeight/2, 0, GL_LUMINANCE_ALPHA, GL_UNSIGNED_BYTE, image->GetPlanePointer(1));

        }

        [self drawFrame];
    }
} 
```

最后，drawFrame 函数：

```
- (void)drawFrame
{
    [self setFramebuffer];

    // Replace the implementation of this method to do your own custom drawing.
    static const GLfloat squareVertices[] = {
        -1.0f, -1.0f,
        1.0f, -1.0f,
        -1.0f, 1.0f,
        1.0f, 1.0f
    };

    static const GLfloat textureVertices[] = {
//        1.0f, 1.0f,
//        1.0f, 0.0f,
//        0.0f,  1.0f,
//        0.0f,  0.0f,
        0.0f, 1.0f,
        1.0f, 1.0f,
        0.0f, 0.0f,
        1.0f, 0.0f
//        0.0f, 0.8f,
//        1.0f, 0.8f,
//        0.0f, 0.2f,
//        1.0f, 0.2f
    };

    static float transY = 0.0f;

    if ([context API] == kEAGLRenderingAPIOpenGLES2) {
        // Use shader program.
        glUseProgram(program);

        glActiveTexture(GL_TEXTURE0);
        glBindTexture(GL_TEXTURE_2D, imageTexture);

        // Update attribute values.
        glVertexAttribPointer(ATTRIB_VERTEX, 2, GL_FLOAT, 0, 0, squareVertices);
        glEnableVertexAttribArray(ATTRIB_VERTEX);
        glVertexAttribPointer(ATTRIB_TEXTUREPOSITON, 2, GL_FLOAT, 0, 0, textureVertices);
        glEnableVertexAttribArray(ATTRIB_TEXTUREPOSITON);

        glActiveTexture(GL_TEXTURE1);
        glBindTexture(GL_TEXTURE_2D, imageTextureUV);

        // Update attribute values.
        glVertexAttribPointer(ATTRIB_VERTEX, 2, GL_FLOAT, 0, 0, squareVertices);
        glEnableVertexAttribArray(ATTRIB_VERTEX);
        glVertexAttribPointer(ATTRIB_TEXTUREPOSITON, 2, GL_FLOAT, 0, 0, textureVertices);
        glEnableVertexAttribArray(ATTRIB_TEXTUREPOSITON);

        // Validate program before drawing. This is a good check, but only really necessary in a debug build.
        // DEBUG macro must be defined in your debug configurations if that's not already the case.
#if defined(DEBUG)
        if (![self validateProgram:program]) {
            NSLog(@"Failed to validate program: %d", program);
            return;
        }
#endif
    } else {
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
        glTranslatef(0.0f, (GLfloat)(sinf(transY)/2.0f), 0.0f);
        transY += 0.075f;

        glVertexPointer(2, GL_FLOAT, 0, squareVertices);
        glEnableClientState(GL_VERTEX_ARRAY);
    } 

    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

    [self presentFramebuffer];
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-27T06:05:23.077

这是我的项目“iOS 电影播放器​​”中的一些代码片段。

## 1.片段着色器

```
varying highp vec2 v_texcoord;  
uniform sampler2D s_texture_y;  
uniform sampler2D s_texture_u;  
uniform sampler2D s_texture_v;   
void main() {  
    highp float y = texture2D(s_texture_y, v_texcoord).r;  
    highp float u = texture2D(s_texture_u, v_texcoord).r - 0.5;  
    highp float v = texture2D(s_texture_v, v_texcoord).r - 0.5;  
    highp float r = y +             1.402 * v;  
    highp float g = y - 0.344 * u - 0.714 * v;  
    highp float b = y + 1.772 * u;  
    gl_FragColor = vec4(r,g,b,1.0);  
} 
```

## 2.从YUV420p帧创建纹理

```
glPixelStorei(GL_UNPACK_ALIGNMENT, 1);  
glGenTextures(3, _textures);  
const UInt8 *pixels[3] = { yuvFrame.luma.bytes, yuvFrame.chromaB.bytes, yuvFrame.chromaR.bytes };  
const NSUInteger widths[3]  = { frameWidth, frameWidth / 2, frameWidth / 2 };  
const NSUInteger heights[3] = { frameHeight, frameHeight / 2, frameHeight / 2 };  
for (int i = 0; i < 3; ++i) {  
    glBindTexture(GL_TEXTURE_2D, _textures[i]);  
    glTexImage2D(GL_TEXTURE_2D, 0, GL_LUMINANCE, widths[i],heights[i],0,GL_LUMINANCE,GL_UNSIGNED_BYTE,pixels[i]);  
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);  
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);  
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);  
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);  
} 
```

## 3\. 初始化顶点和纹理坐标

```
static const GLfloat texCoords[] = { 0.0f, 1.0f, 1.0f, 1.0f, 0.0f, 0.0f, 1.0f, 0.0f };  
static const GLfloat vertices[]= {-1.0f, -1.0f, 1.0f, -1.0f, -1.0f, 1.0f, 1.0f, 1.0f }; 
```

## 4.渲染帧

```
[EAGLContext setCurrentContext:_context];  
glBindFramebuffer(GL_FRAMEBUFFER, _framebuffer);  
glViewport(0, 0, _backingWidth, _backingHeight);  
glClearColor(0.0f, 0.0f, 0.0f, 1.0f);  
glClear(GL_COLOR_BUFFER_BIT);  
glUseProgram(_program);  
for (int i = 0; i < 3; ++i) {  
    glActiveTexture(GL_TEXTURE0 + i);  
    glBindTexture(GL_TEXTURE_2D, _textures[i]);  
    glUniform1i(_uniformSamplers[i], i);  
}  
glVertexAttribPointer(ATTRIBUTE_VERTEX, 2, GL_FLOAT, 0, 0, vertices);  
glEnableVertexAttribArray(ATTRIBUTE_VERTEX);  
glVertexAttribPointer(ATTRIBUTE_TEXCOORD, 2, GL_FLOAT, 0, 0, texCoords);  
glEnableVertexAttribArray(ATTRIBUTE_TEXCOORD);  
glBindRenderbuffer(GL_RENDERBUFFER, _renderbuffer);  
[_context presentRenderbuffer:GL_RENDERBUFFER]; 
```

[github 上的项目](https://github.com/kolyvan/kxmovie)链接。

# php - 显示过去 24 小时的列表

> ID：12428110
> 
> 赞同：0
> 
> 时间：2012-09-14T16:01:28.883
> 
> 标签：php, mysql, list, date, filter

我有一个列表，其中显示了从一开始就向公司下达的所有订单。用于此的 php 脚本如下所示：

```
<?php
    if (isset($HTTP_GET_VARS['cID'])) {
      $cID = tep_db_prepare_input($HTTP_GET_VARS['cID']);
      $orders_query_raw = "select o.orders_id, o.customers_id, o.customers_name, o.customers_id, o.payment_method, o.date_purchased, o.franchise_id, o.last_modified, o.date_allocated, o.currency, o.currency_value, s.orders_status_name, ot.text as order_total from " . TABLE_ORDERS . " o left join " . TABLE_ORDERS_TOTAL . " ot on (o.orders_id = ot.orders_id), " . TABLE_ORDERS_STATUS . " s where o.customers_id = '" . (int)$cID . "' and o.orders_status = s.orders_status_id and s.language_id = '" . (int)$languages_id . "' and ot.class = 'ot_total' order by orders_id DESC";
    } elseif (isset($HTTP_GET_VARS['status']) && is_numeric($HTTP_GET_VARS['status']) && ($HTTP_GET_VARS['status'] > 0)) {
      $status = tep_db_prepare_input($HTTP_GET_VARS['status']);
      $orders_query_raw = "select o.orders_id, o.customers_id, o.customers_name, o.payment_method, o.franchise_id,o.date_purchased, o.last_modified, o.currency, o.currency_value, o.date_allocated, s.orders_status_name, ot.text as order_total from " . TABLE_ORDERS . " o left join " . TABLE_ORDERS_TOTAL . " ot on (o.orders_id = ot.orders_id), " . TABLE_ORDERS_STATUS . " s where o.orders_status = s.orders_status_id and s.language_id = '" . (int)$languages_id . "' and s.orders_status_id = '" . (int)$status . "' and ot.class = 'ot_total' order by o.orders_id DESC";
    } else {
      $orders_query_raw = "select o.orders_id, o.customers_id, o.customers_name, o.payment_method, o.date_purchased, o.franchise_id, o.last_modified, o.date_allocated, o.currency, o.currency_value, s.orders_status_name, ot.text as order_total from " . TABLE_ORDERS . " o left join " . TABLE_ORDERS_TOTAL . " ot on (o.orders_id = ot.orders_id), " . TABLE_ORDERS_STATUS . " s where o.orders_status = s.orders_status_id and s.language_id = '" . (int)$languages_id . "' and ot.class = 'ot_total' order by o.orders_id DESC";
    }
    $orders_split = new splitPageResults($HTTP_GET_VARS['page'], MAX_DISPLAY_SEARCH_RESULTS, $orders_query_raw, $orders_query_numrows);
    $orders_query = tep_db_query($orders_query_raw);
    while ($orders = tep_db_fetch_array($orders_query)) {
    if ((!isset($HTTP_GET_VARS['oID']) || (isset($HTTP_GET_VARS['oID']) && ($HTTP_GET_VARS['oID'] == $orders['orders_id']))) && !isset($oInfo)) {
        $oInfo = new objectInfo($orders);
      }

      if (isset($oInfo) && is_object($oInfo) && ($orders['orders_id'] == $oInfo->orders_id)) {
        echo '              <tr id="defaultSelected" class="dataTableRowSelected" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href=\'' . tep_href_link(FILENAME_ORDERS, tep_get_all_get_params(array('oID', 'action')) . 'oID=' . $oInfo->orders_id . '&action=edit') . '\'">' . "\n";
      } else {
        echo '              <tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href=\'' . tep_href_link(FILENAME_ORDERS, tep_get_all_get_params(array('oID')) . 'oID=' . $orders['orders_id']) . '\'">' . "\n";
      }
?>
                <td class="dataTableContent"><?php echo '<a href="' . tep_href_link(FILENAME_ORDERS, tep_get_all_get_params(array('oID', 'action')) . 'oID=' . $orders['orders_id'] . '&action=edit') . '">' . tep_image(DIR_WS_ICONS . 'preview.gif', ICON_PREVIEW) . '</a>&nbsp;' . $orders['customers_name']; ?></td>
                <td class="dataTableContent" align="right"><?php echo strip_tags($orders['order_total']); ?></td>
                <td class="dataTableContent" align="center"><?php echo tep_datetime_short($orders['date_purchased']); ?></td>
                <td class="dataTableContent" align="right"><?php echo $orders['orders_status_name'].' '.'['.$orders ['franchise_id'].']'; ?></td>
                <td class="dataTableContent" align="right"><?php if (isset($oInfo) && is_object($oInfo) && ($orders['orders_id'] == $oInfo->orders_id)) { echo tep_image(DIR_WS_IMAGES . 'icon_arrow_right.gif', ''); } else { echo '<a href="' . tep_href_link(FILENAME_ORDERS, tep_get_all_get_params(array('oID')) . 'oID=' . $orders['orders_id']) . '">' . tep_image(DIR_WS_IMAGES . 'icon_info.gif', IMAGE_ICON_INFO) . '</a>'; } ?>&nbsp;</td>
              </tr>
<?php
    }
?> 
```

这显示了`'<td>'`标记中的结果。我要显示的只是前一天下午 5 点到当天下午 5 点的订单。我将如何使用标记为 : 的数据库列来做到这一点`date_purchased`？此列中的一个值示例是`03/09/2012 16:46:05`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:12:55.007

甚至不会去检查你的乱七八糟的代码。但在这儿：

```
WHERE date = CONCAT(DATE(DATE_SUB(NOW(), INTERVAL 1 day)), " 17:00:00") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:04:28.420

[@wes 的答案](https://stackoverflow.com/a/12428270/623041)的替代方法，使用 MySQL 的[`BETWEEN ... AND ...`](http://dev.mysql.com/doc/en/comparison-operators.html#operator_between)运算符：

```
WHERE date_purchased BETWEEN ADDTIME(CURRENT_DATE - INTERVAL 1 DAY, '17:00:00')
                         AND ADDTIME(CURRENT_DATE                 , '17:00:00') 
```

注意：

*   这假定`date_purchased`是一个[时间数据类型](http://dev.mysql.com/doc/en/datetime.html)。如果不是，您可以使用[`STR_TO_DATE()`](http://dev.mysql.com/doc/en/date-and-time-functions.html#function_str-to-date)它来转换它；和

*   `BETWEEN ... AND ...`期望一个封闭的时间间隔（即它包含两个值）——根据您的要求，您可能希望在开始/结束日期指定晚于/早于 17:00 的一秒，或者使用显式比较运算符，例如`WHERE [start] <= date_purchased AND date_purchased < [end]`.

# objective-c - 在 Objective-C 中循环重用对象

> ID：12428111
> 
> 赞同：0
> 
> 时间：2012-09-14T16:01:29.317
> 
> 标签：objective-c, ios5, nsarray, nsdictionary

我正在用字符串对象填充数组。可能有数千个。我在 for 循环中做了很多 alloc 和 inits，我知道这很昂贵。有什么更好、更有效的方法来做到这一点？

谢谢

```
 //loop through the array of dictionaries
 for(NSUInteger i =0; i < [latestResults count]; i++){

        self.workingEntry = [[AppRecord alloc] init];

        //Get the next dictionary from the array of dictionaries
        NSDictionary *currentRecord = [latestResults objectAtIndex:i];

        //Set the object
        [self.workingEntry setAppURLString:[currentRecord valueForKeyPath:@"id.label"]];
        [self.workingEntry setAppName:[currentRecord valueForKeyPath:@"im:name.label"]];

        NSArray *imageArray = [currentRecord valueForKeyPath:@"im:image.label"];

        [self.workingEntry setImageURLString:[imageArray objectAtIndex:0]];
        [self.workingEntry setArtist:[currentRecord valueForKeyPath:@"im:artist.label"]];

       //Add object to array
       [self.workingArray addObject:self.workingEntry];

        currentRecord = nil;
        self.workingEntry = nil;
        imageArray = nil;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:12:10.617

Off the cuff, I'd be more worried about all those `valueForKeyPath:` calls than calls to `+alloc`.

Irrelevant until it is measured, though.

If you want to reduce the # of allocations, move to using singletons or a global cache or some other mechanism to uniquify the objects. Of course, you then run the risk of a performance bottleneck in cache maintenance.

# c# - 为选定文本添加外壳扩展

> ID：12428114
> 
> 赞同：1
> 
> 时间：2012-09-14T16:01:38.123
> 
> 标签：c#, selection, windows-shell

我正在尝试添加一个 Windows Shell 快捷方式（右键单击上下文菜单项），以便在 Windows 中的任何地方，当我选择了文本时，该项目就会出现。我找不到要更改/添加的注册表项或要放在那里以使这种情况发生的内容。

选定的文本也需要以某种方式作为参数传递给我的应用程序。我将选择一些 ID 号，然后在项目中操作它们。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:57:48.793

据我所知，没有办法创建允许您注入任何文本框的上下文菜单的 shell 扩展。

您最多可以做的是连接窗口创建 API，过滤掉除上下文菜单创建（WPF 窗口关闭）之外的所有内容，然后做任何您想做的事情。

# android - 每 20 秒更改一次列表视图颜色

> ID：12428117
> 
> 赞同：0
> 
> 时间：2012-09-14T16:01:43.937
> 
> 标签：android, android-listview, background-color

![在此处输入图像描述](../Images/6426182cd2b65bd6533c5be20b4166ac.png)

是否可以每 10 或 15 秒更改一次列表视图颜色或背景颜色。我已为此列表视图使用现有代码。在 mycode 中添加必要步骤的位置。我不想每次选择项目时都为用户更改颜色。如果用户简单地打开我的应用程序并在 10 秒后背景颜色会自动更改。

我的代码：

```
public class MainActivity extends Activity {
    private ListView lv;
    private EditText et;
    private String listview_array[] = { "ONE", "TWO", "THREE", "FOUR", "FIVE",
    "SIX", "SEVEN", "EIGHT", "NINE", "TEN" };
    private ArrayList<String> array_sort= new ArrayList<String>();
    int textlength=0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        lv = (ListView) findViewById(R.id.ListView01);
        et = (EditText) findViewById(R.id.EditText01);
        lv.setAdapter(new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1, listview_array));

        et.addTextChangedListener(new TextWatcher()
        {
        public void afterTextChanged(Editable s)
        {
                                                                        // Abstract Method of TextWatcher Interface.
        }
        public void beforeTextChanged(CharSequence s,
        int start, int count, int after)
        {
        // Abstract Method of TextWatcher Interface.
        }
        public void onTextChanged(CharSequence s,
        int start, int before, int count)
        {
        textlength = et.getText().length();
        array_sort.clear();
        for (int i = 0; i < listview_array.length; i++)
        {
        if (textlength <= listview_array[i].length())
        {
        if(et.getText().toString().equalsIgnoreCase(
        (String)
        listview_array[i].subSequence(0,
        textlength)))
        {
                                                                                                                        array_sort.add(listview_array[i]);
                                                                                                        }
                                                                                        }
                                                                        }
        lv.setAdapter(new ArrayAdapter<String>
        (MainActivity.this,
        android.R.layout.simple_list_item_1, array_sort));
        }
        });

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:06:47.840

在 customview 的 getview() 中更改您正在膨胀的文本视图的颜色。并在每次需要时使用 notifydatasetchanged()

# sql-server-2008 - SQL Server 中的 ErrorHandling 使用 ExecuteReader 链接存储过程

> ID：12428119
> 
> 赞同：1
> 
> 时间：2012-09-14T16:01:50.520
> 
> 标签：sql-server-2008, stored-procedures, ado.net, error-handling

我将一些存储过程链接在一起，并且在使错误处理正常工作时遇到了一些问题。由于其中一些存储过程是长期运行的，因此我使用了存储过程中的`SqlInfoMessageEventHandler`代码`RAISERROR('whatever',10,1) WITH NOWAIT`来向用户报告操作的进度。为了做到这一点，我读到您不能使用 cmd.ExecuteNonQuery()，而必须使用 cmd.ExecuteReader()。我已经尝试过了，似乎确实如此；我没有看到来自 ExecuteNonQuery 的任何消息。

我发现的问题是，当我使用 ExecuteReader 时，如果我的存储过程抛出任何错误，那么它们将被忽略。我的意思是我的 .NET 应用程序从 try 块调用此存储过程，当存储过程遇到错误（如 SELECT 1/0）时，执行永远不会进入 catch 块，而是提交我的事务。这方面的一个例子如下；

```
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TempTstTbl]') AND type in (N'U'))
DROP TABLE [dbo].[TempTstTbl]

CREATE TABLE [dbo].[TempTstTbl] (
    Step INT,
    Val  VARCHAR(50)
)

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Child]') AND type in (N'P', N'PC'))

DROP PROCEDURE [dbo].[Child]
GO 
CREATE PROCEDURE [dbo].[Child]
AS
BEGIN
BEGIN TRY
    INSERT INTO [dbo].[TempTstTbl] (Step, Val) VALUES (1, 'FROM CHILD BEFORE FAULT')
    SELECT 1/0
    --RAISERROR ('This should really fail', 16, 2)
    INSERT INTO [dbo].[TempTstTbl] (Step, Val) VALUES (2, 'FROM CHILD AFTER FAULT')
END TRY
BEGIN CATCH
    DECLARE @ErrorMessage NVARCHAR(4000);
    DECLARE @ErrorSeverity INT;
    DECLARE @ErrorState INT;

    SELECT 
        @ErrorMessage = ERROR_MESSAGE(),
        @ErrorSeverity = ERROR_SEVERITY(),
        @ErrorState = ERROR_STATE();

    -- Use RAISERROR inside the CATCH block to return error
    -- information about the original error that caused
    -- execution to jump to the CATCH block.
    RAISERROR (@ErrorMessage, -- Message text.
               @ErrorSeverity, -- Severity.
               @ErrorState -- State.
               );
END CATCH;
END
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Parent]') AND type in (N'P', N'PC'))

DROP PROCEDURE [dbo].[Parent]
GO
CREATE PROCEDURE [dbo].[Parent]
AS
BEGIN
BEGIN TRY
    INSERT INTO [dbo].[TempTstTbl] (Step, Val) VALUES (1, 'FROM PARENT BEFORE CHILD')
    Exec [dbo].[Child]
    INSERT INTO [dbo].[TempTstTbl] (Step, Val) VALUES (2, 'FROM PARENT AFTER CHILD')
END TRY
BEGIN CATCH
    DECLARE @ErrorMessage NVARCHAR(4000);
    DECLARE @ErrorSeverity INT;
    DECLARE @ErrorState INT;

    SELECT 
        @ErrorMessage = ERROR_MESSAGE(),
        @ErrorSeverity = ERROR_SEVERITY(),
        @ErrorState = ERROR_STATE();

    -- Use RAISERROR inside the CATCH block to return error
    -- information about the original error that caused
    -- execution to jump to the CATCH block.
    RAISERROR (@ErrorMessage, -- Message text.
               @ErrorSeverity, -- Severity.
               @ErrorState -- State.
               );
END CATCH;
END
GO

EXEC [dbo].[Parent]
SELECT * FROM [dbo].[TempTstTbl] 
```

使用一些 .NET 代码，例如；

```
private void button4_Click(object sender, EventArgs e)
{
    using (SqlConnection conn = new SqlConnection(@"Data Source=XPDEVVM\XPDEV;Initial Catalog=MyTest;Integrated Security=SSPI;"))
    {
        conn.Open();
        using (SqlTransaction trans = conn.BeginTransaction())
        {
            using (SqlCommand cmd = conn.CreateCommand())
            {
                cmd.Transaction = trans;
                cmd.CommandText = "[cfg].[Parent]";
                cmd.CommandType = CommandType.StoredProcedure;

                try
                {
                    -- cmd.ExecuteReader(); -- Using this instead of ExecuteNonQuery means the divide by 0 error in the stored proc is ignored, and everything is committed :(
                    cmd.ExecuteNonQuery();
                    trans.Commit();
                }
                catch (Exception ex)
                {
                    trans.Rollback();
                }
            }
        }
    }
} 
```

是否有人对如何从存储过程中获取进度消息有任何想法，但如果存储过程中发生错误，仍然会捕获 .NET 异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T15:08:48.990

这个问题似乎源于 DataReader 的工作方式。我第一次在 Nelson Rothermel 的评论中看到了一个提示，[这](https://stackoverflow.com/a/7024159/685760)是对一个单独的 SO 问题的回答。

[然后，我进一步阅读了此线程](http://www.dotnet247.com/247reference/msgs/14/71559.aspx)中描述的此问题的详细信息，其中 Richard McKinnon 给出了以下示例作为解决问题的一种方式（我的重点）；

> > > 在严重性 > 10 时尝试相同（我使用的是 11）并将 SELECT 行添加到 SP（我使用 NorthWind DB 进行了检查）。您会看到，当您有一个检索数据的 SELECT 时，您永远不会遇到异常。
> 
> [原始消息剪辑]
> 
> 在这种情况下，ExecuteReader() 将开始处理第一组结果，即 SELECT 语句。要获得下一组结果，RAISERROR，**您需要调用 NextResult()**。
> 
> 因此，仅查看错误，我会将之前的代码更改为如下所示；
> 
> SqlDataReader dr = command.ExecuteReader(); **博士下一个结果（）；** 博士关闭（）；

我尝试将 dr.NextResult() 添加到我的代码中，它似乎确实为我解决了这个问题。

然后，这允许我从我的存储过程中获取信息消息，但也允许我捕获存储过程中引发的错误。

# codeigniter - 将 CodeIgniter PayPal IPN 处理程序迁移到 Payza IPN 处理程序

> ID：12428121
> 
> 赞同：0
> 
> 时间：2012-09-14T16:02:02.153
> 
> 标签：codeigniter, paypal

对于这样的新手请求，我们深表歉意，但非常感谢您的指导。我需要将 Payza（以前称为 AlertPay）IPN 处理程序集成到以前与 PayPal 一起使用的类/函数结构中。

我的 PayPal IPN 处理程序具有以下结构：

```
class PayPalIPN {

public $paypal_url;
public $socket_url;
public $ipn_response;
public $ipn_data;

function __construct() {
    $this->paypal_url       = 'https://www.paypal.com/cgi-bin/webscr';
    $this->socket_url       = 'www.paypal.com';
    $this->ipn_response     = '';
}

function validate_ipn($logId = null) {

Do stuff
} 
```

Payza（以前称为 AlertPay）IPN 处理程序示例代码如下所示：

```
define("IPN_V2_HANDLER", "https://secure.payza.com/ipn2.ashx");
define("TOKEN_IDENTIFIER", "token=");

// get the token from Payza
$token = urlencode($_POST['token']);

//preappend the identifier string "token=" 
$token = TOKEN_IDENTIFIER.$token;

/**
 * 
 * Sends the URL encoded TOKEN string to the Payza's IPN handler
 * using cURL and retrieves the response.
 * 
 * variable $response holds the response string from the Payza's IPN V2.
 */

$response = '';

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, IPN_V2_HANDLER);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $token);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, false);
curl_setopt($ch, CURLOPT_TIMEOUT, 60);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);

$response = curl_exec($ch);

curl_close($ch); 
```

我从这个开始：

```
class PayzaIPN {

public $IPN_V2_HANDLER;
public $TOKEN_IDENTIFIER;
public $response;
public $ipn_data;
public $token;  

//define("TOKEN_IDENTIFIER", "token=");

//define("IPN_V2_HANDLER", "https://secure.payza.com/ipn2.ashx");
//define("IPN_V2_HANDLER", "https://sandbox.Payza.com/sandbox/IPN2.ashx");

function validate_ipn($logId = null)  { 
$this->IPN_V2_HANDLER = 'https://sandbox.Payza.com/sandbox/IPN2.ashx';
$this->token = TOKEN_IDENTIFIER.$token; 
```

我无法在正确的结构中正确声明变量 - 出现 T_function 预期错误和未定义的常量错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T20:19:38.777

查看我们的开发中心[https://dev.payza.com/中的信息](https://dev.payza.com/)

您会在那里找到大量信息来帮助您整理任何与 IPN 相关的内容。

这是我相信您正在寻找的代码的直接链接：

[https://dev.payza.com/sdks-and-sample-codes/php/ipn/sample-ipn-v2-handler-item.txt](https://dev.payza.com/sdks-and-sample-codes/php/ipn/sample-ipn-v2-handler-item.txt)

一切顺利！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T12:20:07.530

我无法在评论中发布代码 - 这是我迄今为止实现的代码：

```
class PayzaIPN {  
function validate_ipn($payzaIPN ='',$logId = null)  {

define("IPN_V2_HANDLER", "https://secure.payza.com/ipn2.ashx");
define("TOKEN_IDENTIFIER", "token=");
$_POST['token'] = ''; 

$token = urlencode($_POST['token']);

$token = TOKEN_IDENTIFIER.$payzaIPN;

$response = '';

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, IPN_V2_HANDLER);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $token);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, false);
curl_setopt($ch, CURLOPT_TIMEOUT, 60);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);

$response = curl_exec($ch);

curl_close($ch);

if(strlen($response) > 0) 
```

当我直接从浏览器运行代码以测试令牌处理时，它会显示在日志中并且我得到正确的响应： token=47TXhMVgdPrmV3n5aauIZ5CC0MrytYXWjID81pjVnQsEhkSUklPXT3clXZ4SFUFOL5WqepRUpBz5SKomoyPuDw==& INVALID TOKEN

但是当我从 Payza 生成交易或重新发送 IPN 时，它没有显示在日志中，并且我收到 500 内部服务器错误。托尼，听起来你和 Payza 在一起——很高兴在这里见到你 :)

# sql-server - 检查条件，做计算和过滤记录，做数据库与Web服务器

> ID：12428125
> 
> 赞同：0
> 
> 时间：2012-09-14T16:02:24.713
> 
> 标签：sql-server, database, iis, webserver

我怀疑从数据库中检索多条记录。

情况1：

*   应用联接，从数据库中选择所有记录（选定的列），并在 Web 服务器中进行过滤条件。

案例二：

*   应用连接，应用过滤条件，在数据库中进行计算，在 Web 中什么也不做，只是显示数据。

在上述两种情况下，哪一种是可取的？

我在想的是，

*   案例1中DB没有太多工作，但是网络承载了很多数据，Web服务器要做更多的工作。
*   在案例2中，DB的工作量很大，但网络承载的记录比案例1少，Web服务器的工作量也少。

Web 服务器也是可扩展的，DB 服务器也是可扩展的（假设我的 DB 大小可能不超过 50GB）。

那么我应该在哪里进行过滤和计算以提高性能，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:15:08.387

这是一个相当抽象的问题——这将有助于获得一个更具体的例子。

但是，如果通过过滤意味着从结果集中删除不需要的项目，那么这种情况非常适合 SQL 中的“where”子句。

数据库在这方面比您的 Web 服务器快得多，因为它利用了索引。由于数据库向您的 Web 服务器流式传输的数据也较少，因此数据库的整体性能可能会提高，因为在高流量时，I/O 会成为一个重要的瓶颈；如果您将大量数据流式传输到 Web 服务器，那将影响您的 I/O 性能。

在某些情况下，这很难做到——特别是过滤器动态变化的情况。在您的 Web 服务器逻辑中构建有效的 SQL where 子句有点棘手 - 例如，如果您想为用户提供动态构建过滤器。即使那样，我仍然建议在 SQL 中进行过滤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:09:05.203

我会选择案例 1，因为 RDBMS 非常适合以有效的方式进行选择和过滤。我不会通过网络将所有数据带到 Web 服务器，其中过滤可能涉及浏览每条记录以评估它是否满足过滤条件。

# c# - WPF TreeViewItem 上下文菜单使用 HierarchicalDataTemplate 取消突出显示项目

> ID：12428127
> 
> 赞同：0
> 
> 时间：2012-09-14T16:02:26.237
> 
> 标签：c#, wpf, treeview

[我和这个问题](https://stackoverflow.com/questions/3030292/wpf-treeviewitem-context-menu-unhighlights-item)有同样的问题，我希望 TreeViewItem 在显示其上下文菜单时仍然看起来被选中。但是，在我的树中，每个级别都有不同类型的对象，因此我希望每个级别都有不同的 ContextMenu。我正在使用 HierachicalDataTemplate 完成此操作。所以我有以下 XAML：

```
<Window x:Class="Project.MainWindow">
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Project" ContentRendered="Window_ContentRendered">
    <Grid>
        <Grid.Resources>
            <DataTemplate x:Key="VolumeTemplate">
                <StackPanel Orientation="Horizontal">
                    <Image Source="{StaticResource VolumeIcon}" Margin="3,3,3,3" />
                    <TextBlock Text="{Binding Path=Name}" Margin="3,3,3,3">
                        <TextBlock.ContextMenu>
                            <ContextMenu>
                                <MenuItem Command="{Binding VolumeTestCommand}"
                                          Header="VolumeTest" />
                            </ContextMenu>
                        </TextBlock.ContextMenu>
                    </TextBlock>
                </StackPanel>
            </DataTemplate>
            <HierachicalDataTemplate x:Key="ServerTemplate"
                                     ItemsSource="{Binding Volumes}"
                                     ItemTemplate="{StaticResource VolumeTemplate}">
                <StackPanel Orientation="Horizontal">
                    <Image Source="{StaticResource ServerIcon}" Margin="3,3,3,3" />
                    <TextBlock Text="{Binding Name}" Margin="3,3,3,3" >
                        <TextBlock.ContextMenu>
                            <ContextMenu>
                                <MenuItem Command="{Binding ServerTestCommand}"
                                          Header="ServerTest" />
                            </ContextMenu>
                        </TextBlock.ContextMenu>
                    </TextBlock>
                </StackPanel>
            </HierarchicalDataTemplate>
        </Grid.Resources>
        <TreeView HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                  ItemsSource="{Binding Servers}" Name="tvMain"
                  ItemTemplate="{StaticResource ServerTemplate}"
                  PreviewMouseRightButtonDown="tvMain_PreviewMouseRightButtonDown" />
    </Grid>
</Window> 
```

和后面的代码：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void Window_ContentRendered(object sender, EventArgs e)
    {
        //set DataContext here, based on a login dialog
    }

    static T VisualUpwardSearch<T>(DependencyObject source) where T : DependencyObject
    {
        DependencyObject returnVal = source;

        while (returnVal != null && !(returnVal is T))
        {
            if (returnVal is Visual || returnVal is Visual3D)
            {
                returnVal = VisualTreeHelper.GetParent(returnVal);
            }
            else
            {
                returnVal = LogicalTreeHelper.GetParent(returnVal);
            }
        }

        return returnVal as T;
    }

    private void tvMain_PreviewMouseRightButtonDown(object sender, MouseButtonEventArgs e)
    {
        TreeViewItem treeViewItem = VisualUpwardSearch<TreeViewItem>(e.OriginalSource as DependencyObject);

        if(treeViewItem != null)
        {
            treeViewItem.IsSelected = true;
            e.Handled = true;
        }
    }
} 
```

我尝试了引用问题的答案，但我认为它不起作用，因为上下文菜单位于 TextBlock 而不是 TreeViewItem 上。有没有办法将 ContextMenu 附加到 DataTemplate 中的 TreeViewItem，或者解决这个问题的另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T14:03:59.187

我最终不得不创建一个附加属性，它将上下文菜单从 TextBlock 移动到 TreeViewItem：

```
public static readonly DependencyProperty StealContextMenuProperty = 
    DependencyProperty.RegisterAttached(
        "StealContextMenu", 
        typeof(bool), 
        typeof(ParentClass),
        new UIPropertyMetadata(false, new PropertyChangedCallback(SCMChanged))
    );

public static bool GetStealContextMenu(FrameworkElement obj)
{
    return (bool)obj.GetValue(StealContextMenuProperty);
}

public static void SetStealContextMenu(FrameworkElement obj, bool value)
{
    obj.SetValue(StealContextMenuProperty, value);
}

public static void SCMChanged(object sender, DependencyPropertyChangedEventArgs e)
{
    FrameworkElement fe = sender as FrameworkElement;
    if (fe == null) return;

    bool value = (bool)e.NewValue;
    if (!value) return;

    fe.Loaded += new RoutedEventHandler(fe_Loaded);
}

public static void fe_Loaded(object sender, RoutedEventArgs e)
{
    FrameworkElement fe = (FrameworkElement)sender;
    FrameworkElement child;
    child = VisualDownwardSearch<FrameworkElement>(fe, x => x.ContextMenu != null);
    if (child != null)
    {
        fe.ContextMenu = child.ContextMenu;
        child.ContextMenu = null;
    }
}

public static T VisualDownwardSearch<T>(T source, Predicate<T> match)
    where T : DependencyObject
{
    Queue<DependencyObject> queue = new Queue<DependencyObject>();
    queue.Enqueue(source);
    while(queue.Count > 0)
    {
        DependencyObject dp = queue.Dequeue();

        if (dp is Visual || dp is Visual3D)
        {
            int childrenCount = VisualTreeHelper.GetChildrenCount(dp);
            for (int i = 0; i < childrenCount; i++)
            {
                DependencyObject child = VisualTreeHelper.GetChild(dp, i);
                if (child is T)
                {
                    T tChild = (T)child;
                    if (match(tChild)) return tChild;
                }
                queue.Enqueue(child);
            }
        }
        else
        {
            foreach (DependencyObject child in LogicalTreeHelper.GetChildren(dp))
            {
                if (child is T)
                {
                    T tChild = (T)child;
                    if (match(tChild)) return tChild;
                }
                queue.Enqueue(child);                    
            }
        }
    }
    return null;      
} 
```

# model-view-controller - PAC，只是被动观点的 MVP 吗？

> ID：12428128
> 
> 赞同：1
> 
> 时间：2012-09-14T16:02:28.303
> 
> 标签：model-view-controller, mvp, pac

简而言之：PAC（Presentation-Abstraction-Control）设计模式，仅仅是视图是被动视图的 MVP（Model-View-Presenter）模式吗？

据我所知

*   MVP 是 Presenter，与 Model 交谈。然后是 View 与 Presenter 对话，另外一种方式，Presenter 也可以与 View 对话，即：

    ```
    View <--> Presenter --> Model 
    ```

    来自视图 [*] 的传入用户事件。

*   PAC 是一个控制器，它与 Presentation 和 Abstraction 对话，但 Presentation 不与 Controller 对话（但仍发送 Controller 可能拦截的事件），即：

    ```
    Presentation <-- Controller --> Abstraction 
    ```

    来自 Presentation (?) 的传入用户事件。

这让我觉得理解 PAC 和 MVP 一样，视图是被动的。这是对这两种模式的正确解释吗？

[*]：与 MVC 不同，用户事件来自控制器

PS 可以问一个关于*Stackoverflow*设计模式的一般性问题吗？还是有更好的地方？我有一个疑问，因为这更像是一种设计而不是编程问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:30:40.927

不同之处在于应用程序的结构。虽然 MVC 和其他受 MVC 启发的模式只有一个三元组，但 PAC 结构是分层的。

你得到的是一个`Control`实例树，它组装了应用程序。

                              ![在此处输入图像描述](../Images/a8e8e04799cf3dd0c6a645a0ec64d98c.png)

在这些三元组中的每一个中，控件从抽象中获取数据并将其放置在表示中。

还有 HMVC 模式，它对 PAC 模式的解释有点不同，其中 Control（重命名为 Controller）只应该操纵 Presentation（重命名为 View）和 Abstraction（模型层）的状态。在这种情况下，视图直接与模型层通信并提取它需要的内容。

基本上，PAC 是分布式 MVP，HMVC 是分布式 Model2 MVC。

# iphone - NSString stringWithFormat 中的 EXC_BAD_ACCESS？

> ID：12428134
> 
> 赞同：1
> 
> 时间：2012-09-14T16:02:54.807
> 
> 标签：iphone, objective-c, exc-bad-access

我编写了一些代码来获取我想要在 ARC 中使用的格式的字符串，我得到了 EXC_BAD_ACCESS(code=2 address=0x100)。

这里的代码：

```
NSString *inCook = [NSString stringWithFormat:@"GETAFREE_AUTH_HASH=%@; GETAFREE_USER_ID=%@", FRLAuthHash, FRLUserID];
NSLog(@"%@",inCook);

NSString *cookie1 = [[NSString alloc]init]; 
cookie1 = [NSString stringWithFormat:@"__utma=138759908.342110698.1339513728.1347619146.1347628547.51; __utmz=138759908.1339513728.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); __atuvc=0%7C33%2C0%7C34%2C0%7C35%2C16%7C36%2C50%7C37; GETAFREE_REFERRAL_URL=https%3A%2F%2Fwww.freelancer.com%2Fusers%2Fonlogin.php; _chartbeat2=skcgjvrzgugx7kr0.1339513733066.1347628548930.00000000000001; WRUID=0; session2=6d909115a69f37ff641d798045d6f252; __qca=P0-624434954-1344332147605; FL_DASHBOARD_VIEWPAGE_4164248=sellerview; FL_DASHBOARD_TABINDEX_4164248=6; GETAFREE_LANGUAGE=en; __utmc=138759908; __utmb=138759908.1.10.1347628547; SpryMedia_DataTables_project_table_=%7B%22iCreate%22%3A1347628548100%2C%22iStart%22%3A0%2C%22iEnd%22%3A0%2C%22iLength%22%3A10%2C%22sFilter%22%3A%22%22%2C%22sFilterEsc%22%3Atrue%2C%22aaSorting%22%3A%5B%20%5B7%2C%22desc%22%5D%5D%2C%22aaSearchCols%22%3A%5B%20%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%5D%2C%22abVisCols%22%3A%5B%20false%2Ctrue%2Cfalse%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Cfalse%2Cfalse%2Cfalse%2Cfalse%2Ctrue%2Cfalse%2Cfalse%2Cfalse%5D%7D"];

NSString *cookie2 = [NSString stringWithFormat:@"%@; %@",cookie1,inCook];

NSLog(@"%@",cookie2); 
```

我在这条线上得到了 EXC_BAD_ACCESS：

```
 cookie1 = [NSString stringWithFormat:@"__utma=138759908.342110698.1339513728.1347619146.1347628547.51; __utmz=138759908.1339513728.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); __atuvc=0%7C33%2C0%7C34%2C0%7C35%2C16%7C36%2C50%7C37; GETAFREE_REFERRAL_URL=https%3A%2F%2Fwww.freelancer.com%2Fusers%2Fonlogin.php; _chartbeat2=skcgjvrzgugx7kr0.1339513733066.1347628548930.00000000000001; WRUID=0; session2=6d909115a69f37ff641d798045d6f252; __qca=P0-624434954-1344332147605; FL_DASHBOARD_VIEWPAGE_4164248=sellerview; FL_DASHBOARD_TABINDEX_4164248=6; GETAFREE_LANGUAGE=en; __utmc=138759908; __utmb=138759908.1.10.1347628547; SpryMedia_DataTables_project_table_=%7B%22iCreate%22%3A1347628548100%2C%22iStart%22%3A0%2C%22iEnd%22%3A0%2C%22iLength%22%3A10%2C%22sFilter%22%3A%22%22%2C%22sFilterEsc%22%3Atrue%2C%22aaSorting%22%3A%5B%20%5B7%2C%22desc%22%5D%5D%2C%22aaSearchCols%22%3A%5B%20%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%5D%2C%22abVisCols%22%3A%5B%20false%2Ctrue%2Cfalse%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Cfalse%2Cfalse%2Cfalse%2Cfalse%2Ctrue%2Cfalse%2Cfalse%2Cfalse%5D%7D"]; 
```

里面的值只是从我从网站上捕获的内容中复制和粘贴。

谁能告诉我做错了什么？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:07:11.670

那个超长的 gobbledy-gook 字符串中有一大堆未转义的`%`字符。如果其中任何一个转换为格式字符串模式，它将尝试从`stringWithFormat:`调用中获取一个不存在的参数并构造一个格式化字符串。

不要使用`stringWithFormat:`. 鉴于它是一个静态字符串，只需使用一个裸`@"....gobbledy-gook.....";`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:15:13.227

在线上

```
cookie1 = [NSString stringWithFormat:@"__utma=138759908.342110698.1339513728.1347619146.1347628547.51; __utmz=138759908.1339513728.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); __atuvc=0%7C33%2C0%7C34%2C0%7C35%2C16%7C36%2C50%7C37; GETAFREE_REFERRAL_URL=https%3A%2F%2Fwww.freelancer.com%2Fusers%2Fonlogin.php; _chartbeat2=skcgjvrzgugx7kr0.1339513733066.1347628548930.00000000000001; WRUID=0; session2=6d909115a69f37ff641d798045d6f252; __qca=P0-624434954-1344332147605; FL_DASHBOARD_VIEWPAGE_4164248=sellerview; FL_DASHBOARD_TABINDEX_4164248=6; GETAFREE_LANGUAGE=en; __utmc=138759908; __utmb=138759908.1.10.1347628547; SpryMedia_DataTables_project_table_=%7B%22iCreate%22%3A1347628548100%2C%22iStart%22%3A0%2C%22iEnd%22%3A0%2C%22iLength%22%3A10%2C%22sFilter%22%3A%22%22%2C%22sFilterEsc%22%3Atrue%2C%22aaSorting%22%3A%5B%20%5B7%2C%22desc%22%5D%5D%2C%22aaSearchCols%22%3A%5B%20%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%5D%2C%22abVisCols%22%3A%5B%20false%2Ctrue%2Cfalse%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Cfalse%2Cfalse%2Cfalse%2Cfalse%2Ctrue%2Cfalse%2Cfalse%2Cfalse%5D%7D"]; 
```

您要求格式化字符串，而 '%' 是[格式说明符](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265)。换句话说，`-stringWithFormat`需要 double- `%`(like `%%`) 在结果字符串中生成单个百分比。否则，它希望您使用上面链接中的说明符之一。

您的意思是简单地分配字符串，例如？

```
cookie1 = @"__utma=138759908.342110698.1339513728.1347619146.1347628547.51; __utmz=138759908.1339513728.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); __atuvc=0%7C33%2C0%7C34%2C0%7C35%2C16%7C36%2C50%7C37; GETAFREE_REFERRAL_URL=https%3A%2F%2Fwww.freelancer.com%2Fusers%2Fonlogin.php; _chartbeat2=skcgjvrzgugx7kr0.1339513733066.1347628548930.00000000000001; WRUID=0; session2=6d909115a69f37ff641d798045d6f252; __qca=P0-624434954-1344332147605; FL_DASHBOARD_VIEWPAGE_4164248=sellerview; FL_DASHBOARD_TABINDEX_4164248=6; GETAFREE_LANGUAGE=en; __utmc=138759908; __utmb=138759908.1.10.1347628547; SpryMedia_DataTables_project_table_=%7B%22iCreate%22%3A1347628548100%2C%22iStart%22%3A0%2C%22iEnd%22%3A0%2C%22iLength%22%3A10%2C%22sFilter%22%3A%22%22%2C%22sFilterEsc%22%3Atrue%2C%22aaSorting%22%3A%5B%20%5B7%2C%22desc%22%5D%5D%2C%22aaSearchCols%22%3A%5B%20%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%5D%2C%22abVisCols%22%3A%5B%20false%2Ctrue%2Cfalse%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Cfalse%2Cfalse%2Cfalse%2Cfalse%2Ctrue%2Cfalse%2Cfalse%2Cfalse%5D%7D"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:08:30.130

您的字符串中的`%`符号`cookie1`正在抛出解析器。如果您想要一个实际的百分号，请使用`%%`而不是`%`.

或者：由于您没有在该字符串中添加任何其他内容，因此您也可以使用该`stringWithString`方法而不是`stringWithFormat`. 或者干脆`@"your cookie"`。

# html - 定位h3、img和p

> ID：12428137
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:03:09.973
> 
> 标签：html, css, css-float

好的，这可能很容易，但是我一个小时要摆弄它四个，但仍然无法按照我想要的方式定位它。

[http://jsfiddle.net/Yx65d/9/](http://jsfiddle.net/Yx65d/9/)

我试图将 h3 放在 img 的顶部，它们都向左浮动，而 p 向右对齐，如下所示：

[http://s10.postimage.org/gq1lgcm15/example.jpg](http://s10.postimage.org/gq1lgcm15/example.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:07:01.350

这是我的小提琴：http: [//jsfiddle.net/Yx65d/10/](http://jsfiddle.net/Yx65d/10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:09:40.280

试试这个解决方案来解决你的问题：[jsFiddle](http://jsfiddle.net/Yx65d/11/) you have too many clear both

# javascript - 使用 javascript 在网页中选择用于剪辑的元素

> ID：12428138
> 
> 赞同：0
> 
> 时间：2012-09-14T16:03:13.050
> 
> 标签：javascript, jquery, html, canvas, selection

目前我正在尝试制作一个网页剪辑 chrome 扩展。

我考虑了2个选项

1.  [使用html2canvas](http://www.nihilogic.dk/labs/canvas2image/)将选定元素的 html 渲染到 canvas 元素，然后可以选择使用[canvas2image](https://github.com/niklasvh/html2canvas)将其保存为图像文件。

2.  第二个选项是获取所选元素的内部 html 及其样式，并以某种方式在剪贴板上重现该元素。

对于这两种方法，我首先需要让用户通过拖动选择框或其他东西以图形方式选择元素。但我真的不知道该怎么做。有哪些可能的解决方案？

顺便说一句，我真的很感激有关上述两种方法的可行性的一些意见。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:16:49.653

```
var selection = document.getSelection();
var range = selection.getRangeAt(selection.rangeCount - 1).cloneRange();
var clonedSelection = range.cloneContents();
var div = document.createElement('div');
div.appendChild(clonedSelection);
var html = div.innerHTML;
return html; 
```

这可以完成工作:)。也在普通文本、图像和 youtube 视频上进行了测试 :)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:56:43.267

根据我们在评论中的对话。我正在发布从用户选择中获取图像的解决方案

这是解析用户选择的内容后获取图像的步骤

正如您已经提到的，使用它来获取选定的 HTML

```
 $sel = document.commandDispatcher.focusedWindow.getSelection(); 
```

现在您拥有用户选择的完整 innerHTML 以及您必须序列化为字符串以处理它的标签和属性

```
var node = sel.getRangeAt(0).cloneContents();       
var htmlContent = new XMLSerializer().serializeToString(node); 
```

稍后获取使用 javascript DOM 解析器来解析 htmlcontent

循环遍历每个元素并获取图像标签

像这样

```
 var parser = new DOMParser();
 var xmlDoc = parser.parseFromString(htmlContent, "text/xml"); 
```

你解析的 foreach 图像标签

```
 var image_src = xmlDoc.getElementsByTagName("img")[0].getAttribute("src"); 
```

现在变量image_src保存了用户选择的图片的实际完整src路径​</p>

# c# - 消除 Visual Studio 解决方案文件夹中的临时文件

> ID：12428140
> 
> 赞同：9
> 
> 时间：2012-09-14T16:03:26.483
> 
> 标签：c#, c++, vb.net, visual-studio

我正在清理一堆来自不同来源的 Visual Studio 项目/解决方案，并且每个解决方案中都存储了大量的**临时文件**和**临时文件夹。**

我想知道哪些文件类型可以安全删除，这样我就可以编写一个脚本来处理繁重的工作，这样当我试图将整个文件夹结构组织起来并链接到正确的共享时，就有更少的垃圾可以推动文件位置。

据我所知，以下文件和文件夹是临时的，可以安全删除：

**文件**

*   *.sdf
*   *.sln.docstates
*   *.suo
*   *.upgradelogxml
*   *。用户
*   *.vcxproj.filters
*   *.sln.old
*   *.suo.old
*   升级日志.XML
*   *.wi​​xproj.vspscc
*   *.csproj.vspscc
*   *.SCC
*   *.ncb
*   *。选择
*   *.plg
*   *.aps
*   *.clw

**文件夹**

*   _UpgradeReport_Files（文件夹）
*   ipch（文件夹）
*   bin、obj、debug、release 和其他构建输出文件夹，尽管在构建过程中可能会有文件复制到这里...
*   备份、备份 1 等...

我什至不确定其中一些文件类型到底是什么，我只知道当您打开解决方案时它们会重新生成——而且我知道在旧版和新版 Visual Studio 中我错过了更多文件类型。

**上面的列表中是否应该保留任何文件类型？如果是这样，出于什么原因，是否还有其他文件类型可以清除而不会产生任何严重的副作用？**

总的想法是最小化解决方案的大小和复杂性，当它被迁移、移动或重组或以其他方式洗牌时，足以使这个“解决方案脂肪”成为一个严重的性能和管理问题。

通常，如果我需要将某些内容签入新的源代码控制系统、压缩并通过电子邮件发送示例代码，或者将第三方或对等代码放入现有的共享文件夹和文件层次结构中，我就会看到这个问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-14T16:27:23.227

我不同意你的“临时”文件列表——当然它们中很少有是临时的（否则它们会在 %TEMP% 目录中）。当然，它们中的大多数对于您的项目成功构建并不是必需的，但它们仍然很重要。

*   sdf - SQL Server 紧凑型数据库。VS2012 用于存储 VC 智能感知数据。如果没有此文件，您将无法获得智能感知和代码完成，直到它重建。
*   sln.docstates - 在您的解决方案中存储有关文件的临时状态信息。
*   suo - 包含有关每个解决方案 IDE 自定义设置的信息，例如窗口布局和工具箱加载。删除它通常是安全的，但您的解决方案将来可能需要更长时间才能加载，并且您将丢失任何 UI 自定义。
*   upgradelog.xml - 是的，升级日志文件有点乱。这可以删除。
*   用户 - 我确定这是 VC6 天的旧文件...
*   vcxproj.filters - 保留这个，它是每台计算机/每项目文件系统组织列表的东西
*   sln.old - “旧”文件不是 VS 文件。这看起来像是用户或工具制作的备份文件。
*   suo.old -
*   UpgradeLog.XML - 如果您不使用 UpgradeLog 工具，可以将其删除
*   wixproj.vspscc - 如果您使用源代码管理，请不要删除此文件。它是 VS 源代码控制集成的一部分。在删除绑定文件后，试图将未经检查的更改重新集成到源代码控制中，这简直是地狱。仅当您不使用源代码管理时才删除它。
*   csproj.vspscc - 同上。
*   SCC - 用于源代码控制。如果您使用源代码管理，请不要删除它。
*   ncb - 在 VC6 到 2010 中使用的 Intellisense 缓存。如果删除它，您将丢失 VC intellisense，直到 IDE 重建它，这可能会在大型项目中占用 aaaggess。

我不知道这个或其他文件是什么：.opt、.plg、.aps、.clw

当然，诀窍是首先在解决方案中正确安排文件。项目源文件应该与项目元数据（即我刚刚在上面列出的文件）分开保存，最好是在它们自己的层次结构中的单独文件夹中（这样你就可以为同一个源代码拥有多个 VC 项目文件，允许贡献者使用 VC2005， 2008 年和 2010 年）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-14T16:25:06.060

[查看此 Visual Studio .gitignore 问题](https://stackoverflow.com/questions/2143956/gitignore-for-visual-studio-projects-and-solutions)的答案中列出的文件夹和扩展名，了解通常被认为是非必要的文件。

但是，如果您不知道它是什么，一般来说删除它不是一个好主意。例如，.sdf 文件可能是 SQL Server CE 数据库，这在某些项目中可能很重要。因此，请确保在运行任何解决方案清理脚本之前在某处进行备份。

# eclipse - 将 APK 文件从 Android 手机恢复到 Eclipse

> ID：12428141
> 
> 赞同：0
> 
> 时间：2012-09-14T16:03:28.613
> 
> 标签：eclipse, decoding, apk, smali

不幸的是，我的电脑被盗了，自动云服务备份似乎是自动的，但它在几个月前就停止了。所以我丢失了我的 Android 应用程序的所有 Eclipse 源文件。

我正在尝试恢复所有这些文件，并希望您能帮助我完成最后的步骤。

所以，我做了什么：

1.  从 Play 商店下载的 Astro 文件管理器：https: [//play.google.com/store/apps/details?id=com.metago.astro&hl=en](https://play.google.com/store/apps/details?id=com.metago.astro&hl=en)

2.  使用 Astro 文件管理器备份我的应用程序并将它们从我的 SD 卡复制到计算机。

3.  下载 APK 工具：[http](http://code.google.com/p/android-apktool/) ://code.google.com/p/android-apktool/ （`apktool-install-windows-r04-brut1.tar.bz2`和`apktool1.4.3.tar.bz2`）并将它们解压缩到`c:\windows`文件夹中。

4.  解码apk：`apktool d name.apk`

到目前为止一切顺利，但我在这里卡住了。由于我对 Android 编程很陌生：

我得到以下文件夹：`res`和`smali`

res 文件夹包含我所有的资源，但是...

我可以看到我以前在`src`文件夹中的 Eclipse 中的所有文件现在都在`smali`文件夹中并具有`.smali`扩展名，但它们看起来完全不同。

有什么方法可以让它们恢复“正常”（Java 代码）？逐步使用某种工具/技巧？

谢谢！

我来到了这个博客：http: [//jack-mannino.blogspot.com.es/2010/09/reversing-android-apps-101.html](http://jack-mannino.blogspot.com.es/2010/09/reversing-android-apps-101.html)

但是在提取dex2jar 文件后，Eclipse 无法打开.class 文件。有谁能帮忙吗？另外，文件名后面的 $1、$2 等是什么意思？

* * *

好的，基本上，我做了什么，但我错过了最后一步（我猜）：

*   安装 Astro 文件管理器
*   备份应用程序
*   复制 APK 并使用 dex2jar: 'd2j-dex2jar c:\apk\myappname.apk' 创建 jar 文件
*   使用 JD (http://java.decompiler.free.fr/?q=jdgui) 创建一个 zipfile
*   提取压缩文件

所以我可以看到所有的源代码，但是 Manifest 似乎不见了，所以 Eclipse 仍然没有将它作为项目打开。

谁能给我最后的提示？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:30:12.783

在这种情况下，您最好的办法是使用[dex2jar](http://code.google.com/p/dex2jar/)工具将 apk（实际上是其中的 dex）转换为 jar 文件，并使用 java 反编译器（如[jd](http://java.decompiler.free.fr/?q=jdgui) ）对其进行检查。

但是 JD 有时会产生误导性的 java 源代码，因此您可能必须参考可以通过[apktool](http://code.google.com/p/android-apktool/)获取的类的 smali 代码。

这是 dalvik 操作码：[http ://s.android.com/tech/dalvik/dalvik-bytecode.html](http://s.android.com/tech/dalvik/dalvik-bytecode.html)

最后，类名后面的 $1、$2 表示该类中使用的内部类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T13:37:45.220

使用 axmlprinter 2 解码您的清单（大多数情况下 apktool 不起作用）所以使用 dex 2 jar 和使用 AXMLprinter2 您必须解压缩文件

# asp.net-mvc-3 - 获取 MVC 验证属性适配器

> ID：12428142
> 
> 赞同：1
> 
> 时间：2012-09-14T16:03:29.870
> 
> 标签：asp.net-mvc-3

我正在尝试从 ValidationAttribute 中提取客户端验证规则。有问题的验证器具有通过 DataAnnotationsModelValidator 附加的客户端验证规则，该 DataAnnotationsModelValidator 使用 DataAnnotationsModelValidatorProvider.RegisterAdapter 作为适配器附加。

但是，我一生都无法弄清楚如何在运行时恢复适配器。任何帮助，将不胜感激。

谢谢，安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T14:10:34.777

看一下这个例子[-](http://setiabud.blogspot.com/2010/08/stringlength-validator-into-maxlength.html)显示模板拉取字符串长度验证器（如果存在）并相应地添加 html 属性。以下是相关代码：

```
IEnumerable<ModelValidator> validators = ModelValidatorProviders.Providers.GetValidators(ViewData.ModelMetadata, ViewContext);
ModelClientValidationRule stringLengthRule = validators.SelectMany(v => v.GetClientValidationRules()).FirstOrDefault(m => m.ValidationType == "stringLength"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:44:47.290

您需要使用反射来获取`MemberInfo`具有属性的属性的对象。然后，

```
// given memberInfo, controllerContext, and modelMetadata 
// (see below on how to get metadata)
foreach (var attribute in memberInfo.GetCustomAttributes(typeof(ValidationAttribute), true)
{
    var clientValidationAttribute = attribute as IClientValidatable;
    if (clientValidationAttribute == null)
    {
        continue;
    }

    var clientValidationRules = clientValidationAttribute.GetClientValidationRules(modelMetadata, controllerContext);

    // do something with the rules
} 
```

要获取模型元数据，您可以调用

```
ModelMetadata.FromLambdaExpression(expression, viewData) 
```

如果您有方便的视图数据。您也可以通过显式调用 ModelMetadataProvider 来获取它。如果您需要更多细节，请告诉我。

# python - 如何重新启动 scrapyd 守护进程？

> ID：12428143
> 
> 赞同：2
> 
> 时间：2012-09-14T16:03:42.987
> 
> 标签：python, daemon, scrapy

[我已经完全按照文档](http://doc.scrapy.org/en/0.14/topics/scrapyd.html)中的描述在 EC2 服务器上安装了 scrapyd 守护程序。现在我已经更改了`/etc/scrapyd/conf.d/000-default`.

我如何让 scrapyd 识别这些变化？我认为它涉及重新启动守护程序，但我找不到任何关于如何这样做的好的指导。

一个复杂的因素：我有一堆爬虫在排队，我不想失去它们。我认为scrapy 知道如何优雅地退出和恢复它们，但是这个功能没有很好的记录。有什么指导吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T09:43:06.433

Debian/Ubuntu：

```
sudo /etc/init.d/scrapyd restart 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T22:28:15.973

如果你在 Ubuntu 或 Debian 机器上通过 apt 安装了 scrapyd，以下应该可以工作：

```
sudo service scrapyd reload 
```

然而，我不知道它是否会持续你预定的蜘蛛运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T17:28:19.517

事实证明这很简单。

像这样杀死进程：

```
kill -INT $(cat /var/run/scrapyd.pid) 
```

然后像这样重新启动它：

```
/usr/bin/python /usr/local/bin/twistd -ny /usr/share/scrapyd/scrapyd.tac -u scrapy -g nogroup --pidfile /var/run/scrapyd.pid -l /var/log/scrapyd/scrapyd.log & 
```

据我所知，这两个命令都需要以 root 身份运行。

# ios - MonoTouch：Default.png 文件作为链接不起作用

> ID：12428149
> 
> 赞同：0
> 
> 时间：2012-09-14T16:03:51.063
> 
> 标签：ios, xamarin.ios, hyperlink, monodevelop, splash-screen

MonoTouch 5.4，XCode（最新）

我们有许多共享`common splash screen`. 我们希望拥有`1 real folder`, 然后拥有`Default.png`for each 的所有变体并存`Links`在于那个简单的文件夹中，以便使编辑更有效。

当我们将`Default.png`文件设置为`Link`and`Content`时，我们在`Project's Properties`. 当我们将副本物理地移动到项目的根目录时，它就会出现并且可以工作。

有没有办法让 Default.png 作为每个项目中的链接存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T19:36:35.497

我做了一个测试，使用符号链接有效。如果您将 Git 用于版本控制， [Git 可以处理文件同步链接。](https://stackoverflow.com/a/954575/420175)

例如：

```
$ rm Default.png
$ ln -s ../../Common/splash-iPhone.png Default.png 
```

运行时，模拟器上的 Default.png 是一个“真实”文件。

# c++ - Realloc 在循环中使用

> ID：12428150
> 
> 赞同：-2
> 
> 时间：2012-09-14T16:03:54.907
> 
> 标签：c++, c, memory-leaks, segmentation-fault, realloc

我试图模拟使用 push_back 时矢量容器的行为。我创建了一个指针数组。每个元素可以有不同的长度，所以每次存储新元素时我都需要重新分配：

```
 void *reallocf(void *p, size_t s)
{
    void *tmp = realloc(p, s);
    if(tmp) return tmp;
    free(p);
    return NULL;
}
int main(){
   int rows = 9000;
   int cols = 23000; 
   int *matrix = (int*)malloc(sizeof(int)*rows*cols);

   //counter of elements
   int *nums = new int [rows];
   memset(num, 0, sizeof(int)*rows)

    /* populate matrix*/
            ....
   int **Xcc = new int *[rows];

  for(i = 0; i < rows; i++){
      for(k = 0; k < cols; k++){
          if(matrix[i*cols +k] == 0){
             Xcc[i] = (int*) reallocf(Xcc[i], sizeof(int)*(num[i]+1));
             Xcc[i][num[i]] = k;
             num[i]++;
          }
       }
   } 
```

}

基本上我所做的是存储一个元素的位置为 0。因此，`Xcc[i]`每次需要时，数组都会增加一个元素。新长度将是前一加 1，它将被存储。

显然对我来说似乎很好，但这取决于我得到的东西，`segmentation faults`并且在从许多不同的角度观察它之后，我目前被卡住了。任何帮助都会很棒，想法或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:37:22.650

问题可能是这样的：当你这样做时

```
int **Xcc = new int *[rows]; 
```

对于泛型 i，Xcc[i] 未初始化，那么对 realloc() 的调用有时会起作用（如果 Xcc[i] 为空），有时可能不起作用（segfault）。

您缺少一个：

```
memset(Xcc, 0, sizeof(int*) * rows); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T16:12:01.787

您不需要通过 . 显式地`free`重新分配指针`realloc`。`realloc`释放传递给它的指针（如果不是`NULL`）。

所以`free(p);`从你的`reallocf()`功能中删除。

正如@Joachim Pileborg 指出的那样，您不能重新分配分配给`new`. 所以`new`改为`malloc`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T16:16:36.080

```
 if(matrix[i*cols +k] == 0){
         Xcc[i] = (int*) reallocf(Xcc[i], sizeof(int)*(num[i]+1));
         Xcc[i][num[i]] = k; // bad access here 
```

`k`首先，您正在根据对or的多个值有效的条件重新分配内存`j`。其次，当重新分配失败时，您返回并尝试通过执行`null`来访问内存`0`

```
 Xcc[i][num[i]] = k; 
```

**问题**

*   矩阵的作用是什么？
*   为真`matrix`后为什么不修改？`matrix[i*cols +k] == 0`

**评论**

*   不要`1`在没有空间的时候增加！IT 效率非常低，因为在某个时间点之后，每次插入都需要重新分配。

你不需要`reallocf`。当 realloc 失败时，原始内存保持不变。如果无法为新项目分配更多空间，请停止插入方法并返回错误。

# c# - 线上线下班主任

> ID：12428152
> 
> 赞同：1
> 
> 时间：2012-09-14T16:04:01.233
> 
> 标签：c#, generics, unity-container, aop, interceptor

好的，首先我将描述我的**目标**，然后是我**编写**的代码，最后是**问题**。

## 目标

拥有一个管理多个*合约的***通用类**，并且能够在进行操作的那一刻找出它是在线还是离线情况。有一种非常简单的方法：为每个 Online-Offline 对创建一个类，该类实现合约并检查每个方法是否在线，并做出正确的调用。这正是我想要避免的。

 *仅供参考，在幕后它将是一个连接到**WCF 服务的***在线*场景和一个连接到**客户端本地数据库的***离线场景*。

 *****仅供参考 2：我试图避免拦截和 AOP 的东西，但我发现了一个死胡同。您可以看到[**这篇文章**](https://stackoverflow.com/questions/12395778/how-to-code-a-good-offline-online-dispatcher)*，我在其中实现了似乎是一个很好的解决方案，但是如果它在构造*函数上已连接或未连接则稳定，但现实世界的场景需要在*操作级别*而不是*构造函数级别*进行此检查。

## 代码

它已准备好运行和测试：只需复制/粘贴到新的控制台应用程序上。

```
using System;
using System.Reflection;
using Microsoft.Practices.Unity;
using Microsoft.Practices.Unity.InterceptionExtension;

namespace ConsoleApplication1
{
    public class Unity
    {
        public static IUnityContainer Container;

        public static void Initialize()
        {
            Container = new UnityContainer();

            Container.AddNewExtension<Interception>();
            Container.RegisterType<ILogger, OnlineLogger>();
            Container.Configure<Interception>().SetInterceptorFor<ILogger>(new InterfaceInterceptor());
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Unity.Initialize();

            var r = new Router<ILogger, OnlineLogger, OfflineLogger>();

            try
            {
                r.Logger.Write("Method executed.");
            }
            catch (CantLogException ex)
            {
                r.ManageCantLogException(ex);
            }

            Console.ReadKey();
        }
    }

    public class Router<TContract, TOnline, TOffline>
        where TOnline : TContract, new()
        where TOffline : TContract, new()
    {
        public TContract Logger;

        public Router()
        {
            Logger = Unity.Container.Resolve<TContract>();
        }

        public void ManageCantLogException(CantLogException ex)
        {
            // Is this an ugly trick? I mean, the type was already registered with online.
            Unity.Container.RegisterType<TContract, TOffline>();
            Logger = Unity.Container.Resolve<TContract>();

            var method = ((MethodBase)ex.MethodBase);
            method.Invoke(Logger, ex.ParameterCollection);
        }
    }

    public interface ILogger
    {
        [Test]
        void Write(string message);
    }

    public class OnlineLogger : ILogger
    {
        public static bool IsOnline()
        {
            // A routine that check connectivity
            return false;
            // Should I perform a "lock" here to make this tread safe?
        }

        public void Write(string message)
        {
            Console.WriteLine("Logger: " + message);
        }
    }

    public class OfflineLogger : ILogger
    {
        public void Write(string message)
        {
            Console.WriteLine("Logger: " + message);
        }
    }

    [System.Diagnostics.DebuggerStepThroughAttribute()]
    public class TestAttribute : HandlerAttribute
    {
        public override ICallHandler CreateHandler(IUnityContainer container)
        {
            return new TestHandler();
        }
    }

    public class TestHandler : ICallHandler
    {
        public int Order { get; set; }
        public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
        {
            Console.WriteLine("It's been intercepted.");

            if (!OnlineLogger.IsOnline() && input.Target is OnlineLogger)
            {
                Console.WriteLine("It's been canceled.");
                throw new CantLogException(input.MethodBase, input.Inputs);
            }
            return getNext()(input, getNext);
        }
    }

    public class CantLogException : Exception
    {
        public MethodBase MethodBase { get; set; }

        public object[] ParameterCollection { get; set; }

        public CantLogException(string message)
            : base(message)
        {
        }

        public CantLogException(MethodBase methodBase, IParameterCollection parameterCollection)
        {
            this.MethodBase = methodBase;

            var parameters = new object[parameterCollection.Count];

            int i = 0;
            foreach (var parameter in parameterCollection)
            {
                parameters[i] = parameter;
                i++;
            }

            this.ParameterCollection = parameters;
        }
    }
} 
```

## 问题

1.  我提出的这个设计是线程安全的吗？

2.  这是性能的耻辱吗？处理在线-离线情况的异常和那里的反思让我觉得我做错了。

3.  我认为这是一个常见的要求，是不是有任何 api/fwk/whatever 可以进行在线-离线管理？感觉就像我在这里重新发明了轮船。

4.  这是一个长期的问题：我真的不希望客户端（本例中的**Program**类）知道异常，是否有任何其他方法可以**取消**方法执行，而是通过拦截器上的异常？也欢迎任何其他方法。

* * *

我对付费的第三方东西不感兴趣，所以遗憾的是像[**PostSharp**](http://www.sharpcrafters.com/)这样的东西不是我的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:18:24.520

关于线程安全 - 特别是在您的评论建议锁定的情况下：

```
 public static bool IsOnline()
    {
        // A routine that check connectivity
        return false;
        // Should I perform a "lock" here to make this tread safe?
    } 
```

您不能“将自己锁定在线”，尽管您想知道状态是否可以在检查语句和返回之间更改（请参见经典单例模式）是正确的，但这里担心的是无论您的检查是否是线程，连接都会断开安全与否。

在这种情况下，您只能处理（或选择不处理）抛出的异常

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T21:45:40.230

好的，最后，我有解决方案。我会分享它，因为我发现这在这种在线 - 离线场景中非常有用。有一点改进会很不错：这样一来，在线总是首先被击中，最好设置谁必须首先使用。但那是为了发布，这对于测试版来说就很好了。

```
using System;
using Microsoft.Practices.Unity;
using Microsoft.Practices.Unity.InterceptionExtension;

namespace ConsoleApplication1
{
    public enum ConnectionStatus
    {
        Online,
        Offline,
        System // System checks connectivity
    }

    public static class Connectivity
    {
        private static ConnectionStatus ConnectionStatus = ConnectionStatus.Offline;

        public static void ForceConnectionStatus(ConnectionStatus connectionStatus)
        {
            ConnectionStatus = connectionStatus;
        }

        public static bool IsConnected()
        {
            switch (ConnectionStatus)
            {
                case ConnectionStatus.Online:
                    return true;
                case ConnectionStatus.Offline:
                    return false;
                case ConnectionStatus.System:
                    return CheckConnection();
            }
            return false;
        }

        private static bool CheckConnection()
        {
            return true;
        }
    }

    public class Unity
    {
        public static IUnityContainer Container;

        public static void Initialize()
        {
            Container = new UnityContainer();

            Container.AddNewExtension<Interception>();
            Container.RegisterType<ILogger, OnlineLogger>();
            Container.Configure<Interception>().SetInterceptorFor<ILogger>(new InterfaceInterceptor());
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Unity.Initialize();

            var r = new Router<ILogger, OnlineLogger, OnlineLogger>();

            Connectivity.ForceConnectionStatus(ConnectionStatus.Offline);

            Console.WriteLine("Calling Online, will attend offline: ");

            r.Logger.Write("Used offline.");

            Connectivity.ForceConnectionStatus(ConnectionStatus.Online);

            Console.WriteLine("Calling Online, will attend online: ");

            r.Logger.Write("Used Online. Clap Clap Clap.");

            Console.ReadKey();
        }
    }

    public class Router<TContract, TOnline, TOffline>
        where TOnline : TContract
        where TOffline : TContract
    {
        public TContract Logger;

        public Router()
        {
            Logger = Unity.Container.Resolve<TContract>();
        }
    }

    public interface IOnline
    {
        IOffline Offline { get; set; }
    }

    public interface IOffline
    {
    }

    public interface ILogger
    {
        [Test()]
        void Write(string message);
    }

    public class OnlineLogger : ILogger, IOnline
    {
        public IOffline Offline { get; set; }

        public OnlineLogger()
        {
            this.Offline = new OfflineLogger();
        }

        public void Write(string message)
        {
            Console.WriteLine("Online Logger: " + message);
        }
    }

    public class OfflineLogger : ILogger, IOffline
    {
        public IOnline Online { get; set; }

        public void Write(string message)
        {
            Console.WriteLine("Offline Logger: " + message);
        }
    }

    [System.Diagnostics.DebuggerStepThroughAttribute()]
    public class TestAttribute : HandlerAttribute
    {
        public override ICallHandler CreateHandler(IUnityContainer container)
        {
            return new TestHandler();
        }
    }

    public class TestHandler : ICallHandler
    {
        public int Order { get; set; }

        public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
        {
            Console.WriteLine("It's been intercepted.");

            if (!Connectivity.IsConnected() && input.Target is IOnline)
            {
                Console.WriteLine("It's been canceled.");

                var offline = ((input.Target as IOnline).Offline);

                if (offline == null)
                    throw new Exception("Online class did not initialized Offline Dispatcher.");

                var offlineResult = input.MethodBase.Invoke(offline, this.GetObjects(input.Inputs));

                return input.CreateMethodReturn(offlineResult, this.GetObjects(input.Inputs));
            }

            return getNext()(input, getNext);
        }

        private object[] GetObjects(IParameterCollection parameterCollection)
        {
            var parameters = new object[parameterCollection.Count];

            int i = 0;
            foreach (var parameter in parameterCollection)
            {
                parameters[i] = parameter;
                i++;
            }
            return parameters;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T04:45:35.663

我想提出另一种可能的方法。它与您的计划完全不同，但可能会更好。

基本思想是将您的应用程序分成两部分。第一部分是您所描述的 - 用户界面。但是，它是假设您处于离线状态的情况下编写的。它将所有内容存储到本地数据库/文件/内存存储中。

然后，您拥有程序的另一部分，可能在另一个负责同步的线程（或可能在另一个进程中）上。它查看数据存储，等待更改，如果在线，它将它们写入服务器。当更新从服务器下来时，数据存储将需要引发事件来告诉主程序发生了一些变化，但无论如何它都必须这样做。如果您处于离线状态，同步器不会执行任何操作，但所有数据更改都会自动安全地隐藏起来，直到您稍后重新在线。

这种方法的好处是您无需担心任何地方的在线/离线切换，除了专门处理同步的代码部分。假设您处于离线状态，您已经设置了默认情况。您可以完全摆脱所有拦截/ AOP 的东西。******

# nhibernate - QueryOver API OrderBy 使用案例

> ID：12428159
> 
> 赞同：8
> 
> 时间：2012-09-14T16:04:29.573
> 
> 标签：nhibernate, queryover

如何使用 QueryOver API 执行以下 LINQ to NHibernate 查询。这会从数据库中获取项目的所有记录的列表，并将状态为“已返回”的项目放在列表的末尾。状态是一个 Enum，它映射到数据库中的 nvarchar。

```
var workList = session.Query<Item>()
                .OrderBy(i=> i.Status == Status.Returned ? 1 : 0)
                .ToList(); 
```

SQL 等价物是

```
SELECT *
FROM Item
ORDER BY case when Status='Returned' then 1 else 0 end 
```

我当然试过

```
var workList = session.QueryOver<Item>()
                .OrderBy(i => i.Status == Status.Returned ? 1 : 0).Asc
                .ToList(); 
```

但我得到以下

> InvalidOperationException：从范围“”引用的“MyProject.Model.Entities.Item”类型的变量“i”，但未定义

在这种情况下，由于某些其他功能存在问题，我无法使用 LINQ。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-14T16:58:08.737

你应该可以`Projections.Conditional`在这里使用：

```
Item itemAlias = null;

var workList = 
    session.QueryOver<Item>(() => itemAlias)
        .OrderBy(Projections.Conditional(
            Restrictions.Where(() => itemAlias.Status == Status.Returned),
            Projections.Constant(1),
            Projections.Constant(0))).Asc
        .List(); 
```

这有点冗长，但应该可以完成工作。

# facebook - 套接字IO | 如果客户重新打开连接，如何将客户重新连接到同一个房间？

> ID：12428160
> 
> 赞同：2
> 
> 时间：2012-09-14T16:04:31.123
> 
> 标签：facebook, node.js, socket.io

我在徘徊，如果您有一个使用房间的 node.js / socket.io 应用程序并且一个客户端失去连接或关闭他的浏览器，是否可以将他重新连接到与上一次会话相同的房间？我说的是合理的时间。

例如，如果我们创建了一个 facebook 游戏，我们有房间供玩家玩，但有人错误地退出了应用程序，考虑到我们有他的 fb 唯一 ID，如果他重新进入，我们可以把他放在同一个游戏房间里吗？应用程序，比如 30 秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T05:05:58.147

也许在让用户离开房间之前使用 setTimeout 等待。

此外，您应该跟踪用户的房间和超时 ID，如果相同的用户 ID 重新连接，请取消设置超时并将用户加入房间。

# python - Python语法错误...不知道为什么

> ID：12428162
> 
> 赞同：0
> 
> 时间：2012-09-14T16:04:41.990
> 
> 标签：python, syntax

我之前使用过类似下面的语句，但是当我尝试使用类似的东西时，它会返回一个错误......

```
 File "test.py", line 73
    with open(hostsTxt, 'a+') as f1, open(hostsCSV,'a+') as f2, open(hostNameLook, 'a+') as f3, open(webHostsTxt,'a+') as f4:
            ^
SyntaxError: invalid syntax 
```

上面一行的语法：

```
if hostName != "*" and hostIP != "*":
  with open(hostsTxt, 'a+') as f1, open(hostsCSV,'a+') as f2, open(hostNameLook, 'a+') as f3, open(webHostsTxt,'a+') as f4: 
```

任何想法都会受到欢迎。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T16:06:10.007

查看它*前面*的行，会缺少括号或括号。

那，或者你有一个根本不支持的 python 版本，`with`直到 python 2.6 才引入语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:13:37.503

我在 Python 2.4 和 2.7 上都试过了，似乎在 2.4 上发生了同样的错误，而在 2.7 上没有

Python 2.4 - 我确实得到了和你一样的错误。

```
Python 2.4.3 (#1, Nov  3 2010, 12:52:40) 
[GCC 4.1.2 20080704 (Red Hat 4.1.2-48)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> if hostName != "*" and hostIP != "*":
...   with open(hostsTxt, 'a+') as f1, open(hostsCSV,'a+') as f2, open(hostNameLook, 'a+') as f3, open(webHostsTxt,'a+') as f4:
  File "<stdin>", line 2
    with open(hostsTxt, 'a+') as f1, open(hostsCSV,'a+') as f2, open(hostNameLook, 'a+') as f3, open(webHostsTxt,'a+') as f4:
            ^
SyntaxError: invalid syntax 
```

蟒蛇 2.7

```
Launching python -O
Python 2.7.2 (default, Apr 17 2012, 22:01:25) 
[GCC 4.1.2 20080704 (Red Hat 4.1.2-48)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> hostIP ='localhost'
>>> hostName = 'abcd'
>>> if hostName != "*" and hostIP != "*":
...   with open(hostsTxt, 'a+') as f1, open(hostsCSV,'a+') as f2, open(hostNameLook, 'a+') as f3, open(webHostsTxt,'a+') as f4:
...     print 'testing'
... 
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
NameError: name 'hostsTxt' is not defined 
```

据我所知，您正在尝试与不支持的 python 2.4 一起使用 open。

# themes - 复制 XPages 主题

> ID：12428169
> 
> 赞同：0
> 
> 时间：2012-09-14T16:05:22.153
> 
> 标签：themes, xpages, lotus, ibm-oneui

我想将 Teamroom 应用程序中的 XPages 主题复制到我自己的应用程序中，但没有成功。我只是复制了一个 dpaste 主题文件，但浏览器将不会显示和使用复制的主题之一进行页面。我还必须做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:46:32.837

没有研究主题，但也可能依赖于 css 文件和图像资源。因此，您也必须将这些文件复制到您的应用程序中。此外，您必须设置应用程序属性才能使用主题。而且，您必须在其属性中为您的设计元素提供适当的 theme.id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:53:46.287

Have you changed the Application Properties to use one of the themes you pasted into your app? Sorry if you have but not mentioned that in your question.

# javascript - 优化性能的 JS 动画架构设计

> ID：12428173
> 
> 赞同：9
> 
> 时间：2012-09-14T16:05:45.457
> 
> 标签：javascript, jquery, jquery-animate, gsap

[GreenSock 动画引擎](http://www.greensock.com/js/speed.html)的性能提升*非常显着*。

该库为实现这些收益而做出了哪些潜在的架构决策和权衡？特别是，这个引擎与[jQuery animate](http://api.jquery.com/animate/)有什么不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-22T20:25:07.260

greensock的人在这里给出了很好的答案：

1.  全面使用高度优化的 JavaScript（这需要很多东西，比如使用链表、局部变量、快速查找表、内联代码、按位运算符、利用原型而不是为每个实例重新创建函数/变量等）
2.  设计平台的结构，使其非常适合高压情况，最大限度地减少函数调用并确保事情对 gc 友好。
3.  在由 requestAnimationFrame 驱动的单个更新循环中进行更新，仅在必要时回退到 setTimeout()。
4.  在内部缓存一些重要值以加快更新速度。
5.  对于 CSS 变换，我们计算矩阵值并在有任何旋转或倾斜时构造一个 matrix() 或 matrix3d()，因为我们的测试表明它更快。

更多信息：http: //forums.greensock.com/topic/9346-how-does-greensock-perform-b​​etter-than-other-solutions-for-animation/ [#entry37777](http://forums.greensock.com/topic/9346-how-does-greensock-perform-better-than-other-solutions-for-animation/#entry37777)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T23:16:07.910

据我所知，flash 版本：

*   它的构建/设计和优化速度，jquery 是为一致的工作流程而构建的。
*   它使用对象池，也就是回收多种类型的内部对象以最小化实例化
*   它为每个场景使用优化的循环
*   它使用信息对象来帮助/说明正在动画的属性。
*   我不确定他们是否使用相同的缓动功能，但这也可能有所作为。

Tweenlite 作为 tweenengine 有着悠久的历史，它也有很多 jQuery 没有包含的特性。

# c++ - 为什么这种从 int 到 double& 的转换不起作用？

> ID：12428174
> 
> 赞同：0
> 
> 时间：2012-09-14T16:05:54.843
> 
> 标签：c++, reference

错误！

```
$ cat double.cc
#include<iostream>

int main() {
    int i = 42;
    double &r = i;
}
$ g++ double.cc
double.cc: In function ‘int main()’:
double.cc:5: error: invalid initialization of reference of type ‘double&’
from expression of type ‘int’
$ 
```

作品！

```
$ cat double.cc
#include<iostream>

int main() {
    int i = 42;
    const double &r = i;
}
$ g++ double.cc
$ 
```

为什么我们会在第一种情况下得到错误？我知道这是在[这里](https://stackoverflow.com/questions/2908244)讨论的，但我不确定我是否理解为什么不允许这样做，而`int`允许`const double&`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T16:06:50.920

```
int i = 42;
double &r = i; 
```

这里`r`是一个引用`double`，但`i`不是一个`double`，那怎么能`r`引用呢？这不可以。所以它`double`从表达式中创建了一个类型的临时对象`i`。但同样，`r`它是*非常量*引用，不能绑定到临时对象。

但是，如果您将其设为 const 引用，那么它将起作用：

```
double const & r = i; 
```

请注意，`const`引用可以绑定到由`i`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T16:09:57.177

在 C++ 中，您几乎可以将引用视为另一个变量的别名。它们必须在非 cv 限定类型中匹配，在这种情况下类型是不同的。

它使用的原因`const double&`是因为编译器使用 ' 值`double`的副本创建了一个临时文件，`i`并将 const 引用绑定到该临时文件。这是允许的，因为绑定到临时对象会将临时对象的生命周期延长到引用的生命周期。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T16:10:15.913

当你写

```
int i = 42;
double const &r = i; 
```

`i`隐式转换为双精度值，这会产生一个临时值或*rvalue*。不允许非常量引用绑定到右值，因此`r`需要 a`double const&`才能使上述内容起作用。

# javascript - 使用 subgrid 实现 jqGrid 需要哪些 js 文件

> ID：12428179
> 
> 赞同：0
> 
> 时间：2012-09-14T16:06:25.030
> 
> 标签：javascript, jquery, jqgrid

我正在尝试在 jqGrid 中实现子网格。我在 js lib 中添加了 grid.subgrid.js 但仍在浏览器控制台中我在控制台上看到错误“未捕获的类型错误：对象 # 没有方法‘扩展’”

```
/**
 * jqGrid extension for SubGrid Data
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/ 
 * Dual licensed under the MIT and GPL licenses:
**/
"use strict";
**$.jgrid.extend({
Uncaught TypeError: Object #<Object> has no method 'extend'**
setSubGrid : function () {
    return this.each(function (){
        var $t = this, cm, 
```

# javascript - 访问父对象属性的父对象

> ID：12428181
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:06:28.020
> 
> 标签：javascript

如果我有 ：

```
var obj= {
    a:"something", 
    b:{ 
        a:function (){
        // Can I access obj properties through the this keyword here
        }
    }
}; 
```

我可以`obj`通过函数`this`中的关键字访问属性吗？`obj.b.a`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:09:25.523

简短的回答：没有。

长答案：指向该对象的许多对象可能有许多属性。哪一个会是父母？另外，请阅读[此处](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)关键字的实际工作原理：它仅在您的函数被调用时`this`指向对象。`obj.b``obj.b.a()`

但是，您仍然可以使用该`obj`变量作为参考。在[这个答案](https://stackoverflow.com/a/10711164/1048572)中，我讨论了与`this`.

# asp.net - 动态数据：如何将特定列值绑定到下拉列表中

> ID：12428185
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:06:40.427
> 
> 标签：asp.net, data-binding, asp.net-dynamic-data

我正在研究“ASP.NET 动态数据 LINQ to LINQ 应用程序”类型的项目。

当我执行我的应用程序时，我得到所有标签和 DropDownLists 动态绑定。

我指的是[这个](http://www.shubho.net/2011/03/customizing-dynamic-data-application.html)博客。

现在我需要根据我的标准填充那些 DropDownList。目前，它正在填充该列的表中的所有记录。如何自定义此 DropDownList 就像我只想选择具有`Mak`名称的用户一样？

我想我需要在下拉填充值时在这里进行一些 linq 查询？没有把握

```
protected void Page_Load(object sender, EventArgs e)
        {
            if (DropDownList1.Items.Count == 0)
            {
                if (Mode == DataBoundControlMode.Insert || !Column.IsRequired)
                {
                    DropDownList1.Items.Add(new ListItem("[Not Set]", ""));
                }
                PopulateListControl(DropDownList1);
            }

            SetUpValidator(RequiredFieldValidator1);
            SetUpValidator(DynamicValidator1);
        } 
```

![在此处输入图像描述](../Images/0628e357d966f4cb1a976f9e92dbe979.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T10:20:07.980

为了`DropDownList`在动态数据站点中自定义控制数据，您应该使用`FilterUIHintAttribute`允许替换（或添加新过滤器）默认（`built-in filters templates`）过滤器的类（在您的元数据中）。

考虑使用类型列的**内置**`Boolean`过滤器模板实现新过滤器模板的示例（如附图所示）。

假设您有一个类型为`WorkFlows`列`Status`的表`Boolean`（`bit`对于 SQL Server），并且您希望该`DropDownList`控件只有`false`值（默认情况下，如果该列允许空值，用户可以从*All、True、False* 和*[Not Set]*中选择过滤器值）。

首先复制内置过滤器模板`Boolean.ascx`（您可以在`~\DynamicData\Filters`目录中找到它），然后将其粘贴到同一目录中。然后将新过滤器重命名为`StatusBoolean.ascx`.

然后你可以编辑代码隐藏`StatusBoolean.ascx`和删除行

```
DropDownList1.Items.Add(new ListItem("True", Boolean.TrueString)); 
```

`WorkFlows`然后您应该更改实体的元数据：

```
[FilterUIHint("StatusBoolean")]
public bool Status { get; set; } 
```

就这样。

[FilterUIHintAttribute 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.filteruihintattribute.aspx)的更多信息。

您还可以查看我在[ASP.NET Dynamic Data 中根据 Metadata 自动填充下拉列表的](https://stackoverflow.com/questions/16146497/asp-net-dynamic-data-automatically-populating-a-drop-down-list-based-on-metadata/16211566)帖子。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-14T17:03:53.537

我假设您要绑定的数据类型是可为空的 bool（bool？）。分配 DataSource 属性时，您可以使用`myObjects.Where( o => o.TheNullableBool.HasValue )`.

# websphere - 在 Websphere 中使用多个数据源

> ID：12428200
> 
> 赞同：2
> 
> 时间：2012-09-14T16:07:54.220
> 
> 标签：websphere, websphere-7

我要将 Web 应用程序从 Oracle Weblogic Server 11 移植到 Websphere 8.5。我发现的一个问题是 WLS 应用程序使用了一种称为“**多数据源**”的功能，其中多个 JDBC 连接可作为单个组件使用（从而提供对数据库的更健壮的访问）。
Websphere 是否也有等效的解决方案或我可以用来模拟它的解决方法？非常感谢
路易斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T16:25:33.147

检查[WLS 文档](http://docs.oracle.com/cd/E13222_01/wls/docs103/jdbc_admin/jdbc_multidatasources.html)；

> 多数据源可以被认为是一个数据源池。多数据源最适合用于高可用性数据库系统（例如冗余数据库或 Oracle 真正应用集群 (RAC)）节点之间的故障转移或负载平衡。

据我所知，WAS 不存在这样的设施。尽管如此，您可以通过使用负载平衡的 JDBC 连接字符串来获得相同的结果。Oracle RAC 的示例可能如下所示（引用[Oracle 文档](http://docs.oracle.com/cd/B28359_01/java.111/e10788/rac.htm)）；

```
jdbc:oracle:thin@(DESCRIPTION=
  (LOAD_BALANCE=on)
  (ADDRESS=(PROTOCOL=TCP)(HOST=racnode1) (PORT=1521))
  (ADDRESS=(PROTOCOL=TCP)(HOST=racnode2) (PORT=1521))
  (CONNECT_DATA=(SERVICE_NAME=service_name))) 
```

您要做的是在您喜欢的范围内在 WAS 中定义一个单一的、正常的数据源，并如上所述配置负载平衡的 JDBC 连接字符串（此处示例负载平衡两个 RAC 节点）。

如上配置的负载平衡功能由数据库供应商提供的 JDBC 驱动程序提供，因此如果您使用不同的数据库，则应查看数据库文档以获得支持。

* * *

编辑：对我的答案的更正是有序的。我遇到了这个功能，它确实是 WAS8 中的一个新特性，称为[Resource 工作负载路由](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/index.jsp?topic=/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/cdat_dsfailover.html)。以下是说明；

> 资源工作负载路由包括数据源和连接工厂故障转移以及从预定义的备用或备份资源进行的后续故障恢复。此功能使应用程序能够轻松地从资源中断（例如数据库故障）中恢复，而无需您嵌入备用资源和配置信息。您可以定制资源故障转移和故障回复灵活的配置选项，以满足特定环境和应用程序的需求。

您可以通过向数据源添加自定义属性来简单地配置此新功能。此功能的主要属性是；

```
alternateResourceJNDIName
Values: String value containing a direct JNDI name.

Description: An alternate connection factory or data source resource
should be like the primary resource. Provide the JNDI name of the 
alternate resource to enable the fail over feature. 
```

# jquery - 从 jquery datepicker 获取今天的日期

> ID：12428203
> 
> 赞同：5
> 
> 时间：2012-09-14T16:08:06.530
> 
> 标签：jquery, jquery-ui, jquery-ui-datepicker

我需要将`currentText`jquery datepicker 中属性的默认显示从“今天”更改为“今天：2012 年 9 月 14 日”。所以问题是日期选择器是否通过某种方法公开今天的日期？还是我必须创建自己的 JS new Date() 并从那里获取日期，这是我试图避免的！

```
$('#txtSelectedDate').datepicker({
        showButtonPanel: true,
        currentText: "Today: " + getTodaysDate(); // Is there such a method?
    }); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T16:10:21.917

是的，这`currentText`就是你要找的。

```
$('#txtSelectedDate').datepicker({
    showButtonPanel: true,
    currentText: "Today:" + $.datepicker.formatDate('MM dd, yy', new Date())  
});​ 
```

[演示](http://jsfiddle.net/LgTZt/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:15:41.560

如果您需要使用当前日期初始化日期选择器，您可以使用：

```
$(".selector").datepicker( "option", "gotoCurrent", true ); 
```

当然，您可以使用`dateFormat`此处[定义的格式](http://docs.jquery.com/UI/Datepicker/formatDate)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-05-30T07:22:15.220

如果您需要使用当前日期初始化日期选择器，您可以使用：

```
 $(".selector").datepicker( "option", "gotoCurrent", true ); 
```

# java - 建设一阵子，导入大量数据

> ID：12428205
> 
> 赞同：0
> 
> 时间：2012-09-14T16:08:14.553
> 
> 标签：java, android

我正在创建一个测试应用程序，其目的是将大量文本消息导入短信收件箱。我在“地址”和“正文”两列中有几千条消息。我可以将它们保存为 csv、sqlite 或字符串数​​组格式。我不确定如何解决这个问题，以使这个 while 循环有效，以及我可能希望以何种方式解析数据。

请指导完成此任务的最佳方法。

为简单起见，我在这里尝试将其作为数组，但存在一些语法错误。使用数组将值添加到数据库中的正确方法是什么？

这是我到目前为止所拥有的：

```
 private void importSms(final String[] addressvariable, final String[] bodyvariable) {
    Thread queue = new Thread(new Runnable() {
        public void run() {
             while(true) { //will have to define this boolean
                 ContentValues values = new ContentValues{);
                 values.put("address", [addressvariable]);
                 values.put("body", [bodyvariable]);
                 getContentResolver().insert(Uri.parse("content://sms/inbox"), values);
             }
         }
       }); 
       queue.start(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:17:42.263

像这样的长操作应该使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)来完成。这将确保您不会阻塞 UI 线程，并允许您在处理时轻松显示进度对话框，让用户了解情况。

至于格式，我会使用数据库，因为它可以在以后轻松升级并修改以满足新的需求。为此使用字符串数组会相当复杂，特别是如果您的消息已格式化。原生不支持 CSV 解析，所以我不会在数据库中选择它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:43:09.280

**1.**保持`UI work`on`UI thread`和`Non-UI work`on `Non-UI thread`，被认为是一种很好的编程方法，但是随着Android`HoneyComb`版本的到来，它变成了`rule`......

**2.** Android 应用程序始终启动`DUI`（专用 UI​​ 线程）。

**3.**您可以使用`Thread`，这将在 上进行长时间的处理`separate Non-UI thread`（创建任何其他线程，立即将您从 UI 线程中删除）。

**4.**现在我们可以**使用**`Handler`在.**`Non-UI thread``UI thread`**

 ****5.**现在由于使用Thread，然后Handler似乎有点压倒性，所以`AsyncTask`被引入Android，也被称为`PainLess threading`......这有助于**UI和Non-UI线程的同步。****

# unicode - 当在容量不足的编码方案中编码时，具有大代码点的字符串会是什么样子？

> ID：12428210
> 
> 赞同：0
> 
> 时间：2012-09-14T16:08:44.890
> 
> 标签：unicode, encoding, character-encoding

在阅读[了 Joel 关于 Unicode 的文章](http://www.joelonsoftware.com/articles/Unicode.html)后，我仍然对自己的 unicode 知识感到非常不确定。具体来说，我留下了这个问题：

假设我有一个代码点太大而无法适应某些编码（即 ASCII）的字符串，例如：

```
U+67CF U+1AAB U+ABCD U+7034 
```

然后乔尔说：

> 如果你试图在你试图表示它的编码中表示的 Unicode 代码点没有等价物，你通常会得到一个小问号：？或者，如果你真的很好，一个盒子。

但是这个字符串看起来像什么（在二进制/十六进制级别）以 ASCII 编码或其他一些大小不足的编码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:20:10.150

如果将字符串（例如，“ユニコード”）转换为 ASCII，则 ASCII 中没有定义可以表示任何这些字符的代码。这完全取决于转换软件应该做什么。通常，该软件会将它无法编码的任何字符替换为“？”，即字面上的 ASCII 问号字符。然后，该字符串是包含常规 ASCII 问号字符的常规 ASCII 字符串。

作为对 Joel 文章的更深入跟进，请参阅[每个程序员绝对、积极需要了解的关于使用文本的编码和字符集的知识。](http://kunststube.net/encoding)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T16:26:16.777

引用的声明没有多大意义。如果编码没有 Unicode 代码点的代码，那么您根本无法在其中表示该代码点。就是这样。例如，您不能用 ASCII 表示“é”。

也许该语句的意思是，如果您尝试将字符串从一种编码转换为另一种编码，并且字符串中的某些字符在目标编码中没有表示，那么您可能会看到奇数字符。嗯，是的，但你也可以看到其他任何东西。转换程序可以将“é”映射到“e”，或者它可以发出错误消息并拒绝正确生成输出。通常，后者是正确的举动。

但在某些情况下，转换是即时进行的，不能纠缠于人际互动，但必须做*一些事情*。那时当然不再是字符码转换，而是广义上的转换。它可以应用许多不同的策略，比如只是删除字符，或者通过某种逻辑将它们映射到可表示的字符或字符组合，甚至更改目标编码。

# c - 没有优化，C 函数只调用一次

> ID：12428213
> 
> 赞同：1
> 
> 时间：2012-09-14T16:09:04.147
> 
> 标签：c, optimization, g++

我正在运行包含 g++ 的最新 cygwin。

在我看来，一个函数调用正在被优化，即使编译器标志包括 -O0。

从此循环调用该函数（示例中的所有代码都已简化）：

```
void my_func ( void )
{
    for ( int i = 0; i < 2; i++) {
        var1 = table[i];
        printf("i = %d\n", i);
        function_to_call();
        printf("Called the function\n");
     }
} 
```

它调用的函数如下：

```
void function_to_call()
{
   int internal_var = var1;
   // do some math using internal_var, passing the result
   // as an input to another function

   printf("var1: %d\n", internal_var);
} 
```

运行它，输出将是：

```
i = 0
var1 = 0
Called the function
i = 1
Called the function 
```

为什么会这样？我希望每次通过循环调用 function_to_call() 。这是编译器输出的摘录，直接取自标准输出：

```
 g++ -O0 -Wall -Wno-write-stings -Wextra 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:22:23.240

首先，您发布的只是图片的“一部分”，因为您的示例输出`function_to_call()`有一段时间的输出是. 不过，如果我不得不尝试解决这个问题......`var1: ...``var1 = ...`

```
void function_to_call()
{
   int internal_var = var1;
   // do some math using internal_var, passing the result
   // as an input to another function

   printf("var1: %d\n", internal_var);
} 
```

我猜想“做一些数学......”部分正在迫使提前返回；但是，只有当输入（可能作为全局变量在 中传递`var1`）设置为特定值时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:02:48.437

你们是对的，我发布了一个不完整的代码示例。该函数实际上没有任何返回语句，但我找到了罪魁祸首。function_to_call() 中的代码位于状态机中。发生的事情是在该代码完成之前状态已更改，因此下一次通过它进入了不同的情况。我向所有人道歉，并吸取教训。我感谢你的努力。

# indexing - 在 RavenDB 中创建更多这样的

> ID：12428215
> 
> 赞同：3
> 
> 时间：2012-09-14T16:09:05.303
> 
> 标签：indexing, mapreduce, ravendb, morelikethis

我的域中有这些文件：

```
public class Article {
    public string Id { get; set; }
    // some other properties
    public IList<string> KeywordIds { get; set; }
}

public class Keyword {
    public string Id { get; set; }
    public string UrlName { get; set; }
    public string Title { get; set; }
    public string Tooltip { get; set; }
    public string Description { get; set; }
} 
```

我有这种情况：

*   文章`A1`有关键字`K1`
*   文章`A2`有关键字`K1`
*   一位用户阅读文章`A1`
*   我想建议用户阅读文章`A2`

我知道我可以使用`More Like This`bundle 并且我阅读了文档，但我不知道该怎么做？你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T15:02:59.040

看看这个例子，你可以用“流派”代替你的“关键词”：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Linq.Expressions;
using Lucene.Net.Analysis;
using Raven.Abstractions.Data;
using Raven.Abstractions.Indexing;
using Raven.Client;
using Raven.Client.Bundles.MoreLikeThis;
using Raven.Client.Indexes;
using Raven.Tests.Helpers;
using Xunit;

namespace RavenDBEval
{
    public class MoreLikeThisEvaluation : RavenTestBase
    {
        private readonly IDocumentStore _store;

        public MoreLikeThisEvaluation()
        {
            _store = (IDocumentStore)NewDocumentStore();
            _store.Initialize();
        }

    [Fact]
    public void ShouldMatchTwoMoviesWithSameCast()
    {
        string id;
        using (var session = _store.OpenSession())
        {
            new MoviesByCastIndex().Execute(_store);
            new MoviesByGenreIndex().Execute(_store);
            GetGenreList().ForEach(session.Store);
            var list = GetMovieList();
            list.ForEach(session.Store);
            session.SaveChanges();
            id = session.Advanced.GetDocumentId(list.First());
            WaitForIndexing(_store);
        }

        using (var session = _store.OpenSession())
        {
            var moreLikeThisByCast = session
                .Advanced
                .MoreLikeThis<Movie, MoviesByCastIndex>(new MoreLikeThisQuery
                                                     {
                                                         DocumentId = id, 
                                                         Fields = new[] { "Cast" },
                                                         MinimumTermFrequency = 1,
                                                         MinimumDocumentFrequency = 2
                                                     });
            var moreLikeThisByGenre = session
                .Advanced
                .MoreLikeThis<Movie, MoviesByGenreIndex>(new MoreLikeThisQuery
                {
                    DocumentId = id,
                    Fields = new[] { "Genres" },
                    MinimumTermFrequency = 1,
                    MinimumDocumentFrequency = 2
                });

            foreach (var movie in moreLikeThisByCast)
            {
                Debug.Print("{0}, Cast={1}", movie.Title, string.Join(",", movie.Cast));
            }

            Assert.NotEmpty(moreLikeThisByCast);

            foreach (var movie in moreLikeThisByGenre)
            {
                Debug.Print("{0}", movie.Title);
                foreach (var genreId in movie.Genres)
                {
                    var genre = session.Load<Genre>(genreId);
                    Debug.Print("\t\t{0}", genre.Name);
                }
            }
            Assert.NotEmpty(moreLikeThisByGenre);

        }
    }

    private static List<Genre> GetGenreList()
    {
        return new List<Genre>
                   {
                       new Genre {Id = "genres/1", Name = "Comedy"},
                       new Genre {Id = "genres/2", Name = "Drama"},
                       new Genre {Id = "genres/3", Name = "Action"},
                       new Genre {Id = "genres/4", Name = "Sci Fi"},
                   };
    } 

    private static List<Movie> GetMovieList()
    {
        return new List<Movie>
                   {
                       new Movie
                           {
                               Title = "Star Wars Episode IV: A New Hope",
                               Genres = new[] {"genres/3", "genres/4"},
                               Cast = new[]
                                          {
                                              "Mark Hamill",
                                              "Harrison Ford",
                                              "Carrie Fisher"
                                          }
                           },
                       new Movie
                           {
                               Title = "Star Wars Episode V: The Empire Strikes Back",
                               Genres = new[] {"genres/3", "genres/4"},
                               Cast = new[]
                                          {
                                              "Mark Hamill",
                                              "Harrison Ford",
                                              "Carrie Fisher"
                                          }
                           },
                       new Movie
                           {
                               Title = "Some Fake Movie",
                               Genres = new[] {"genres/2"},
                               Cast = new[]
                                          {
                                              "James Franco",
                                              "Sting",
                                              "Carrie Fisher"
                                          }
                           },
                       new Movie
                           {
                               Title = "The Conversation",
                               Genres = new[] {"genres/2"},
                               Cast =
                                   new[]
                                       {
                                           "Gene Hackman",
                                           "John Cazale",
                                           "Allen Garfield",
                                           "Harrison Ford"
                                       }
                           },
                       new Movie
                           {
                               Title = "Animal House",
                               Genres = new[] {"genres/1"},
                               Cast = new[]
                                          {
                                              "John Belushi",
                                              "Karen Allen",
                                              "Tom Hulce"
                                          }
                           },
                       new Movie
                           {
                               Title="Superman",
                               Genres = new[] {"genres/3", "genres/4"},
                               Cast= new[]
                                         {
                                             "Christopher Reeve", 
                                             "Margot Kidder", 
                                             "Gene Hackman",
                                             "Glen Ford"
                                         }
                           }
                   };
    }
}

public class Movie
{
    public string Id { get; set; }
    public string Title { get; set; }
    public string[] Cast { get; set; }
    public string[] Genres { get; set; }
}

public class Genre
{
    public string Id { get; set; }
    public string Name { get; set; }
}

public class MoviesByGenreIndex : AbstractIndexCreationTask<Movie>
{
    public MoviesByGenreIndex()
    {
        Map = docs => from doc in docs
                      select new { doc.Genres };

        Analyzers = new Dictionary<Expression<Func<Movie, object>>, string>
                        {
                            {
                                x => x.Genres,
                                typeof (KeywordAnalyzer).FullName
                                }
                        };

        Stores = new Dictionary<Expression<Func<Movie, object>>, FieldStorage>
                     {
                         {
                             x => x.Genres, FieldStorage.Yes
                         }
                     };
    }
}

public class MoviesByCastIndex : AbstractIndexCreationTask<Movie>
{
    public MoviesByCastIndex()
    {
        Map = docs => from doc in docs
                      select new { doc.Cast };

        Analyzers = new Dictionary<Expression<Func<Movie, object>>, string>
                        {
                            {
                                x => x.Cast,
                                typeof (KeywordAnalyzer).FullName
                                }
                        };

        Stores = new Dictionary<Expression<Func<Movie, object>>, FieldStorage>
                     {
                         {
                             x => x.Cast, FieldStorage.Yes
                         }
                     };
    }
} 
```

}

输出：

-星球大战第五集：帝国反击，演员=马克哈米尔，哈里森福特，嘉莉费雪 -Some Fake Movie，演员=詹姆斯弗兰科，斯汀，嘉莉费雪 -对话，演员=吉恩哈克曼，约翰卡扎尔，艾伦加菲尔德，哈里森福特按类型：-星球大战第五集：帝国反击动作科幻-超人动作科幻

注意 nuget 包：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="Lucene.Net" version="3.0.3" targetFramework="net40" />
  <package id="Lucene.Net.Contrib" version="3.0.3" targetFramework="net40" />
  <package id="RavenDB.Client" version="2.0.2261" targetFramework="net40" />
  <package id="RavenDB.Database" version="2.0.2261" targetFramework="net40" />
  <package id="RavenDB.Embedded" version="2.0.2261" targetFramework="net40" />
  <package id="RavenDB.Tests.Helpers" version="2.0.2261" targetFramework="net40" />
  <package id="SharpZipLib" version="0.86.0" targetFramework="net40" />
  <package id="xunit" version="1.9.1" targetFramework="net40" />
</packages> 
```

# sql-server-2008 - 执行标量错误

> ID：12428216
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:09:10.570
> 
> 标签：sql-server-2008, c#-4.0

我不断收到错误“NullReferenceException 未处理。对象引用未设置为对象的实例”在第 5 行

```
1\.    Private void textbox1_TextChanged(object sender,EventArgs e)
2     {
3\.       SqlConnection cn=new SqlConnection("Connection string");
4\.       String sql ="select name from bank_info where account_no ='"+textbox1.Text+"'";
5\.       SqlCommand cmd =new SqlCommand(sql,cn);
6\.       Cn.Open();
7\.       String s1 = cmd.ExecuteScalar().ToString();
8\.       TextBox2.Text =s1.ToString(); 
```

我是编程新手。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:20:03.460

Try something like the following. Your connection should noremally be created from your connection. Using statements are a good way of ensuring that classes that implement IDisposable have Dispose called. Use SqlParameters to avoid SQL Injection issues.

```
using(SqlConnection cn=new SqlConnection("Connection string"))
{
   cn.Open();

   String sql ="select name from bank_info where account_no = @accNo"; // '"+textbox1.Text+"'";

   using (SqlCommand cmd = cn.CreateCommand())
   {
       cmd.CommandText = sql;
       SqlParameter param = cmd.CreateParameter();
       param.ParameterName = "@accNo";
       param.Value = textbox1.Text;
       cmd.Parameters.Add(param);
       object obj = cmd.ExecuteScalar();
       TextBox2.Text = obj != null ? obj.ToString() : string.Empty;
   }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:34:45.223

这将有助于

```
 Private void textbox1_TextChanged(object sender,EventArgs e)
 {
   SqlConnection cn=new SqlConnection("Connection string");
   String sql ="select name from bank_info where account_no ='"+textbox1.Text+"'";
   SqlCommand cmd =new SqlCommand(sql,cn);
   Cn.Open();
   Object obj = cmd.ExecuteScalar()
   String s1 = (obj!=null)?(String)obj:"";
   TextBox2.Text =s1.ToString(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-14T16:38:51.100

能不能在dubug模式下看到查询，看到sql。检查在 sql 中运行相同的查询以查看该帐号是否返回结果。如果没有结果可以避免异常，您可以检查不会引发异常的 DB Null。

# python - 当 x 是数字数组时，在 python 中绘制 f(x) 时出错

> ID：12428226
> 
> 赞同：0
> 
> 时间：2012-09-14T16:09:44.967
> 
> 标签：python, numpy

我刚开始尝试学习python。我在绘制函数时遇到问题。我遵循网络上的示例，它似乎工作正常。但是，当我在自己的东西上尝试它时，我收到一个错误，即该函数只能将长度为 1 的数组用作标量，但我在自己的尝试中看不到差异，然后复制绘图示例。我的代码如下：

```
i = np.arange(-16, -7, 1)
r = []
y = []
for x in i:
    r.append(math.pow(10, x))

x = np.asarray(r)
y = (math.cos(1.2) - (1 / x) * (math.sin(1.2 + x) - math.sin(1.2)))
plot(x,y)
show() 
```

基本上我只想输出`y=f(x)`值`10^-16, 10^-15...10^-7`。但我发誓我发现的所有绘图示例都以相同的方式实现它。例如，这很好用：

```
x = arange(0, 2, 0.01)
y = 2 * sin(2 * pi * (x - 1 / 4))
plot(x, y) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:11:52.333

Are you using the functions in the correct module? Python's built-in `math.cos` only takes a single scalar value, whereas `numpy.cos` takes arrays as well:

```
>>> import numpy
>>> import math
>>> math.cos([1, 2, 3])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: a float is required
>>> numpy.cos([1, 2, 3])
array([ 0.54030231, -0.41614684, -0.9899925 ]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T13:38:16.830

你的主要问题是你混合了两种类型的数学运算

*   模块的操作[`math`](http://docs.python.org/library/math.html)。
*   来自[NumPy](http://docs.scipy.org)的操作，适用于`ndarrays`（NumPy 数组）。这或多或少是传统的`import numpy as np`。

模块中的函数仅`math`适用于浮点**标量**。如果你想`math`在一组标量（一个列表、一个数组......）上使用一个函数，你必须通过迭代将它应用于你的集合的每个项目。这就是您在构建`r`列表时当前正在做的事情：您的循环可以转换为`r = [math.pow(10,x) for x in i]`

相反，NumPy 是为处理大型数据数组而设计的。对数组的操作直接在 C 级别执行，这比我描述的迭代方法要快得多，效率更高。使用`np`函数时，输入集在底层转换为 a `ndarray`。

例如，您可以使用以下函数`r`非常有效地创建数组：`np.power`

```
r = np.power(10., i) 
```

（请注意，我正在使用`10.`而不是`10`强制输出数组具有 float `dtype`。我也可以这样做`np.power(10, i, dtype=float)`）。

你的`y`变成：

```
y = (math.cos(1.2) - (1\. / r) * (np.sin(1.2 + r) - math.sin(1.2))) 
```

可以继续`math`计算 的正弦和余弦`1.2`，因为它只是一个标量。但是对于*已经*是的`sin(1.2 + x)`部分，您应该使用. 另一种方法是迭代并创建一个类似的数组，但它首先完全违背了使用的意义。`x`*`ndarray``np.sin``x``np.array([math.sin(i+1.2) for i in x])``ndarrays`*

 *在您提到的最后一个示例中，缺少一个步骤：

```
from numpy import sin 
```

您现在必须记住这`sin`是 NumPy 函数，而不是它的`math`对应函数。由于存在混淆的风险，您可能不应该单独导入函数并`np.sin`改为使用。*

# php - 手工制作的博客代码查看/显示？

> ID：12428227
> 
> 赞同：0
> 
> 时间：2012-09-14T16:09:46.997
> 
> 标签：php, view, xhtml, blogs

我已经手动编写了我的博客，没有 wordpress 或任何东西，我正在尝试制作一个功能，让我可以在我的博客中编写代码并显示它：`<div>Like This</div>` 我可能正在考虑它的方式，它可能比它更简单我认为。我试图做的只是`<code></code>`在博客文章中找到标签，然后替换标签内的所有`<`with`$lt;`和`>`with`&gt;`等`<code></code>`。但我可以想出一种方法来处理多个`<code></code>`标签。

然后在代码的最后，我将替换`<code></code>`为`<div class="code"></div>`

有一个更好的方法吗？多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:33:55.753

使用[preg_replace](http://php.net/manual/en/function.preg-replace.php)替换`<code></code>`为`<div class="code"></div>`和[htmlentities](http://php.net/manual/en/function.htmlentities.php)对所有 html 标记进行编码，以便可以将其视为源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:34:58.983

```
<?php
$html="<code>this is the first code snippet</code><p>This is a normal paragraph</p><code>this is the second code snippet</code>";
preg_match_all("'<code>(.*?)</code>'si", $html, $match);
if ($match) {
    foreach ($match[1] as $snippet) {
            echo htmlspecialchars($snippet, ENT_QUOTES);
            echo "\n";           
    }
 }
?> 
```

# c# - ObjC 与 MonoTouch 浮点和数组性能对比

> ID：12428229
> 
> 赞同：4
> 
> 时间：2012-09-14T16:09:56.600
> 
> 标签：c#, objective-c, ios, ipad, xamarin.ios

**编辑：**添加`unsafe`了 C# 代码版本。谢谢大家的建议，`unsafe`C# 代码运行速度更快，但只有 3% 左右。

* * *

**短版：**我用 C# 和 Objective-C 编写了一些基准代码，并在 iPad 3 上对其进行了测试。MonoTouch/C# 版本比 Objective-C 中的相同代码需要多 50%-150% 的时间来执行。这是我的问题：**我可以编写比我用于基准测试的代码（见下文）执行得更快的 C# 代码，还是这是由某些固有的 MonoTouch/Obj-C 差异引起的？**

* * *

**长版：**我刚刚为一个计划中的多平台游戏写了一个小原型。将游戏核心从 Windows/.NET 移植到 iPad 3/MonoTouch 后，我注意到代码在 iPad 上运行的速度慢了很多。游戏核心的某些关键部分在 iPad CPU 上的运行速度比在 Intel CPU 上慢约 10 倍（这似乎是正常的，因为 iPad 使用 ARM 处理器运行）。

然而，由于这对我们的游戏来说是一个主要问题，所以我在 iPad 3 上运行了一个小型基准测试，一次使用**MonoTouch**，然后使用普通的**Objective-C**进行同样的测试。基准做了很多简单的`float`添加和`float`数组查找。由于 MonoTouch 是经过 GC 处理的，我预计会看到有利于 Obj-C 的微小差异，但令我惊讶的是，MonoTouch 代码需要比 Obj-C 代码更多的时间来运行。准确地说：

*   **Obj-C**代码需要在`47'647 ms`DEBUG 模式和`27'162 ms`RELEASE 模式下运行。
*   **MonoTouch**代码无需使用在 DEBUG 模式和RELEASE 模式下运行所需的`unsafe`指针。`116'885 ms``40'002 ms`
*   **带有****指针**的**MonoTouch**代码需要在 DEBUG 模式和RELEASE 模式下运行。**`unsafe`**`90'372 ms``38'764 ms`

当然，RELEASE模式是我关心的。

`LLVM`考虑到 MonoTouch 编译为与Obj-C相同的本机代码，这种差异对我来说似乎有点高。

这是我使用的 Obj-C 代码：

```
int i, j;
long time = GetTimeMs64();
float * arr = (float *) malloc(10000 * sizeof(float)); //  10'000
for (j = 0; j < 100000; j++) {                         // 100'000
    arr[0] = 0;
    arr[1] = 1;
    for (i = 2; i < 10000; i++) {                      //  10'000
        arr[i] = arr[i - 2] + arr[i - 1];
        if (arr[i] > 2000000000) {             // prevent arithm. overflow
            arr[i - 1] = 0;
            arr[i] = 1;
        }
    }
}
long time2 = GetTimeMs64() - time; 
```

`GetTimeMs64()`使用. `<sys/time.h>`_`gettimeofday`

这是我的 C#/MonoTouch 代码，在`unsafe`版本中：

```
var array = new float[10000];                          //  10'000
var watch = System.Diagnostics.Stopwatch.StartNew();
fixed (float* arr = array)
{
    for (int j = 0; j < 100000; j++)                   // 100'000
    {
        *(arr + 0) = 0;
        *(arr + 1) = 1;
        for (int i = 2; i < 10000; i++)                //  10'000
        {
            *(arr + i) = *(arr + i - 2) + *(arr + i - 1);
            if (*(arr + i) > 2000000000)               // prevent arithm. overflow
            {
                *(arr + i - 1) = 0;
                *(arr + i) = 1;
            }
        }
    }
}

watch.Stop(); 
```

**编辑 2：**这是我们从 Xamarin 得到的答案：

> 这个特定示例存在两个影响单声道性能的问题。
> 
> 首先，如果您使用的是默认的 MonoTouch 编译器，而不是 LLVM，则可能会出现较低的性能，因为它针对的是编译速度而不是执行速度。LLVM 会给你更好的结果。
> 
> 其次，mono 符合有关浮点的 ECMA 规范，并以双精度进行所有计算。与使用浮点数的 C 代码相比，这通常具有可衡量的性能成本。
> 
> 我们一直在寻找在不影响正确性的情况下放松双精度性能的方法，或者至少有一个选择机制。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T17:14:07.997

就像 Marc 建议你应该使用`unsafe`代码一样，MonoTouch 支持这个 .NET 特性。

这将删除 .NET 数组边界检查，这是 .NET 的**一个很好、更安全的功能，**但会降低性能（因为**必须**检查每个数组访问）。

这将使您的代码（无论是源代码还是本机代码）看起来更像 Objective-C 代码，并且性能应该更接近。我仍然建议您`unsafe`仅在性能真正重要时才使用代码（并且在衡量收益是否值得之后）。

# asp.net-mvc-3 - Unity 依赖解析器的正确配置与 MvcMembership 一起使用？

> ID：12428238
> 
> 赞同：2
> 
> 时间：2012-09-14T16:10:36.987
> 
> 标签：asp.net-mvc-3, dependency-injection, asp.net-membership, unity-container

我无法找到正确的 Unity 配置以使其与 MvcMembership 一起使用。

此时，我收到以下错误消息：

> 无法构造 Boolean 类型。您必须配置容器以提供此值。

这是我注册依赖项的代码：

```
 container.RegisterInstance<MembershipProvider>(Membership.Provider);

    container.RegisterType<IMembershipSettings,AspNetMembershipProviderSettingsWrapper>();
    container.RegisterType<IUserService, AspNetMembershipProviderWrapper>();
    container.RegisterType<IPasswordService, AspNetMembershipProviderWrapper>();
    container.RegisterType<IRolesService, AspNetRoleProviderWrapper>();
    container.RegisterType<ISmtpClient, SmtpClientProxy>();
    container.RegisterType<IRegistrationSettings, RegistrationSettings>(); 
```

这是我的堆栈跟踪：

[InvalidOperationException：无法构造布尔类型。您必须配置容器以提供此值。] Microsoft.Practices.ObjectBuilder2.DynamicMethodConstructorStrategy.GuardTypeIsNonPrimitive(IBuilderContext context, SelectedConstructor selectedConstructor) +277 Microsoft.Practices.ObjectBuilder2.DynamicMethodConstructorStrategy.PreBuildUp(IBuilderContext context) +485 Microsoft.Practices.ObjectBuilder2。 StrategyChain.ExecuteBuildUp(IBuilderContext context) +434 Microsoft.Practices.ObjectBuilder2.DynamicMethodBuildPlanCreatorPolicy.CreatePlan(IBuilderContext context, NamedTypeBuildKey buildKey) +400 Microsoft.Practices.ObjectBuilder2.BuildPlanStrategy.PreBuildUp(IBuilderContext context) +222 Microsoft.Practices.ObjectBuilder2.StrategyChain。 ExecuteBuildUp（IBuilderContext 上下文）+434 Microsoft.Practices。

[ResolutionFailedException：依赖项解析失败，类型=“MyProject.Web.Areas.MvcMembership.Controllers.UserAdministrationController”，名称=“（无）”。异常发生时：解决时。

## 例外是： InvalidOperationException - 无法构造 Boolean 类型。您必须配置容器以提供此值。

在异常发生时，容器是：

解析 MyProject.Web.Areas.MvcMembership.Controllers.UserAdministrationController,(none) 解析构造函数 MyProject.Web.Areas.MvcMembership.Controllers.UserAdministrationController 的参数“membershipSettings”(MvcMembership.Settings.IMembershipSettingsmembershipSettings, MvcMembership.IUserService userService, MvcMembership.IPasswordService passwordService, MvcMembership.IRolesService rolesService, MvcMembership.ISmtpClient smtpClient) Resolving MvcMembership.Settings.AspNetMembershipProviderSettingsWrapper,(none) (映射自 MvcMembership.Settings.IMembershipSettings, (none)) 解析参数“注册”的构造函数 MvcMembership.Settings.AspNetMembershipProviderSettingsWrapper(MvcMembership Settings.IRegistrationSettings 注册，MvcMembership.Settings.IPasswordSettings 密码，MvcMembership.Settings.ILoginSettings login) Resolving MvcMembership.Settings.RegistrationSettings,(none) (映射自 MvcMembership.Settings.IRegistrationSettings,(none)) 解析构造函数的参数“requiresUniqueEmailAddress” MvcMembership.Settings.RegistrationSettings(System.Boolean requiresUniqueEmailAddress) 解析系统.Boolean,(none) ] Microsoft.Practices.Unity.UnityContainer.DoBuildUp（类型 t，对象存在，字符串名称，IEnumerable布尔值，（无）] Microsoft.Practices.Unity.UnityContainer.DoBuildUp（类型 t，现有对象，字符串名称，IEnumerable布尔值，（无）] Microsoft.Practices.Unity.UnityContainer.DoBuildUp（类型 t，现有对象，字符串名称，IEnumerable`1 resolverOverrides) +546 Microsoft.Practices.Unity.UnityContainer.DoBuildUp(Type t, String name, IEnumerable`1 resolverOverrides) +20 System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +68

[InvalidOperationException：尝试创建类型为“MyProject.Web.Areas.MvcMembership.Controllers.UserAdministrationController”的控制器时发生错误。确保控制器有一个无参数的公共构造函数。] System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +634403 System.Web.Mvc.DefaultControllerFactory.CreateController(RequestContext requestContext, String controllerName) +93 System. Web.Mvc.MvcHandler.ProcessRequestInit(HttpContextBase httpContext, IController& controller, IControllerFactory& factory) +346 System.Web.Mvc.<>c_ *DisplayClass6.b* _2() +71 System.Web.Mvc.<>c__DisplayClassb`1.<ProcessInApplicationTrust>b__a() +19 System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Func`1 func) +161 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +405 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:13:42.063

我通过使用上述构造函数上方的以下属性指定用于 UserAdministrationController 的构造函数来解决此问题：

```
[Microsoft.Practices.Unity.InjectionConstructor] 
```

当构造函数重载时，Unity 会尝试使用具有最多参数的构造函数。使用 InjectionConstructor 属性，我强制它使用带有零参数的构造函数。

# ruby-on-rails - 可以从视图和控制器呈现的部分的准备代码放在哪里？

> ID：12428240
> 
> 赞同：1
> 
> 时间：2012-09-14T16:10:40.890
> 
> 标签：ruby-on-rails, ruby, model-view-controller, architecture

在我的 Rails 应用程序中，我有一个`Foo`模型`has_many` `Bar`。我想编辑`Bar`s控制器`show`视图中`Foo`的 s 。另外，我不想在每次编辑`Bar`.

为此，我正在使用 AJAX。控制器有`Bar`两个视图 -`show`和`edit`. `bar#show`有一个编辑按钮，并且两个`Bar`视图都使用 AJAX 来执行 HTTP 请求，然后替换包含表示该特定`Bar`对象`Foo`的HTML 标记的内容，而不是重新加载整个页面`show`。

渲染时`foo#show`，我不想为每个`Bar`对象执行 HTTP 请求。此外，`Bar`的控制器方法需要`Bar`从数据库中获取记录——这是我不想在 中做的事情`foo#show`，因为我可以用一个查询加载所有这些，这比单独加载每个查询要快得多。

所以，我所做的就是将`Bar`'s 的视图设为局部视图，而不是普通视图。这样，我可以从控制器和另一个视图中渲染它们。

现在，问题是除了`Bar`从数据库加载记录之外，这些视图还需要更多的准备工作，并且与加载记录不同 - 无论部分是从控制器还是从另一个视图呈现，这些准备工作都需要完成。

我现在正在做的是在 partial's 的开头有一个大约 10 行的红宝石块`erb`，并在那里做准备。虽然这样可行，但我意识到这是一个糟糕的设计——这种准备应该在控制器中完成，而不是在视图中。更糟糕的是 - 有时，`show`部分的准备代码可以决定`edit`需要渲染部分，所以我需要从`show`部分调用另一个部分渲染 - 再次，应该在另一个地方完成的事情。

但是，我只是不知道将代码放在哪里。我想过把它作为一个视图助手，但是视图助手应该是从视图中调用的，我还需要从控制器中调用它。

那么，解决这个问题的 RoR 方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:13:10.500

为什么不创建控制器方法？请记住，控制器方法不必绑定到操作 - 控制器只是应用程序中的另一个类。这个控制器方法可以设置一个可以在你的部分中使用的状态（控制器中的变量）。此外，所述控制器的动作方法可以根据该方法来实现（即调用它来获取/准备他们需要的数据）。

```
class MyController < ApplicationController
  def show
    @intermediate_state = another_method
  end

  private
  def another_method
    "some value is returned here!"
  end
end 
```

查看/部分：

```
<%= @intermediate_state %> 
```

# ms-access - 错误：此记录集不可更新

> ID：12428241
> 
> 赞同：2
> 
> 时间：2012-09-14T16:10:45.590
> 
> 标签：ms-access, sql-update, sql-server-2012, ms-access-2010, recordset

我被这个错误困扰了好几个小时。如果`open_form`我将值设置为`recordset`这样

`Id = vId`. 但是对于 1 个表单，无论我更新什么字段，我都会收到此错误。

```
This recordset is not updateable 
```

我读了这篇文章[http://support.microsoft.com/default.aspx?...kb;en-us;328828](http://support.microsoft.com/default.aspx?...kb;en-us;328828)

我尝试了很多东西。没什么用 没有关系，我得到了`navigation control`，形式是`dynaset`，我有`primary key autoincrement`， `allow edits`已启用并`data entry`设置为 yes

另外，我获得了编辑此表的权限

以前有人遇到过这个错误吗？

此外，我将 97 转换为 2010，现在我的表格链接到`SQL server 2012`. 我不知道它之前是否有效，因为它不是我的应用程序，但我想它是功能性的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:46:44.497

检查表单的记录源。如果是`SELECT`语句，请将 SQL 复制到新 Access 查询的 SQL 视图中。

然后在数据表视图中打开该查询。如果您无法在数据表视图中编辑数据，则必须弄清楚如何修改查询，以便它可以返回可编辑的记录集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-09T20:49:09.870

如果这对任何人都有帮助，我对这个问题有不同的原因。

当我们从一个 SQL Server 转换到另一个 SQL Server 时，这里的人删除了所有的链接表，并为每个 Access MDB 重新设置它们。

对于一个表（它实际上指向一个 SQL 视图，并且它是它正在查询导致问题的表单的链接表），人们没有检查列来指定链接表的“索引”（IIRC）列......即使对话框中甚至有一点评论，如果您想更新，就必须检查一个或多个字段。幸运的是，视图正在选择一个 ID，所以我尝试了它并且它起作用了。（如果这不起作用，我将指定构成 SQL 表键的视图列，该表是由表单更新的表。）

我在论坛上看到过关于“所有更新表单的表都需要有索引”的评论，并且我检查了视图引用的 SQL 表，但我没有想到“表”意味着访问“链接表”。我看到在链接表上指定索引的唯一地方是重新添加链接表时。

# jquery - Captcha Code onload/document.ready issue

> ID：12428243
> 
> 赞同：0
> 
> 时间：2012-09-14T16:11:01.923
> 
> 标签：jquery, captcha

I'm designing a form which will include a captcha code.

I've decided to go with Solve Media to provide this as they offer potential revenue from CAPTCHA codes (see [http://www.solvemedia.com/publishers/captcha-type-in](http://www.solvemedia.com/publishers/captcha-type-in)).

However, I'm having an issue with my code to display the 'puzzle'

The following code works (which uses body onload="function"

```
 <html><head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

    $.getScript("https://api-secure.solvemedia.com/papi/challenge.ajax", function() {
    });

});
function showPuzzle(){
    ACPuzzle.create('v3IzWqCqSh23kq5PnRSbVZrYwWlRYBL-', 'acwidget', { lang: 'en', size: 'standard' });      
}   

function submitButton(){
var user_challenge = document.getElementById('adcopy_challenge').value;
var user_response = document.getElementById('adcopy_response').value;

$.ajax({ url: 'libs/shared-functions.php',
    data: {action:'solveCaptchaCode',challenge:user_challenge, response:user_response},
    type: 'post',
    success: function (output) {
        alert(output);
        console.log(output);
    }
});}
    </script>
    </head>
    <body onload="showPuzzle();">
    Puzzle: <br />
    <div id="acwidget"></div>

      <br />  <br />  <br />  <br />
      <button onclick="submitButton()">Submit</button>
    </body>
    </html> 
```

However, when I remove the tage

```
 <body onload="showPuzzle();"> 
```

and change the .ready function to

```
 $(document).ready(function() {

    $.getScript("https://api-secure.solvemedia.com/papi/challenge.ajax", function() {
        showPuzzle();
    });

}); 
```

The error 'ReferenceError: Can't find variable: ACPuzzle' occurs. I've uploaded the failing code to: [http://jsfiddle.net/Mhpmf/](http://jsfiddle.net/Mhpmf/)

**Does anybody know of any solutions to this problem?**

I need the request to create the puzzle to be made inside the .ready function to integrate with the existing code.

Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:28:55.650

您可以使用：

```
window.onload = function() {
    $.getScript("https://api-secure.solvemedia.com/papi/challenge.ajax", function() {
        showPuzzle();
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:28:00.847

正如@Zathrus Writer 正确所说，

window.onload = function() { ... } 有效。

# c# - Sorting a list by content and length of element

> ID：12428245
> 
> 赞同：4
> 
> 时间：2012-09-14T16:11:09.650
> 
> 标签：c#, .net, list, sorting

I am new to c# and am looking for a bit of help with a problem I have sorting a list by the length of an element within the list, I will try to explain using a simplified version.

I have an Object List for categories with the following format List:

```
category.Name;
category.Path; 
```

When I extract the list of categories from the external database and import them into the List they come in in no particular order, for example:

```
Luxury Seats      /Base/Seats
Small Seats       /Base/Seats/Luxury Seats
Seats             /Base
Small Gloves      /Base/Gloves
Large Seats       /Base/Seats/Luxury Seats
Small Red Gloves  /Base/Gloves/Small Gloves
Gloves            /Base
Budget Seats      /Base/Seats/Luxury Seats/Small Seats 
```

From the above youcan see that they are in no particular order and simply follow the order they were in in the database. What I am trying to do is to organise them using both the name of the Path element and the length of the component parts of the path element. I need to achieve the following format by re-organising the list:

```
Seats             /Base
Luxury Seats      /Base/Seats
Small Seats       /Base/Seats/Luxury Seats
Budget Seats      /Base/Seats/Luxury Seats/Small Seats
Large Seats       /Base/Seats/Luxury Seats
Gloves            /Base
Small Gloves      /Base/Gloves
Small Red Gloves  /Base/Gloves/Small Gloves

```

So the List is structured into a heirarchy based on the depth and category names of the Path component elements.

If anyone can help me out that would be really great.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:16:56.687

假设：

```
var list = new List<Category>(); 
```

你只有两个选择：

```
var result = list.OrderBy(c => c.Name) // Luxury Seats; Seates (L -> S)
                 .ThenBy(c => c.Path); // /Base; /Base/Seats (shorter -> longer) 
```

或相反亦然：

```
var result = list.OrderBy(c => c.Path) // /Base; /Base/Seats
                 .ThenBy(c => c.Name); // Luxury Seats; Seates 
```

* * *

您也可以按路径深度排序：

```
var result = list.OrderBy(c => c.Path.Split(new[] { '\' }).Length) // less slashes -> more slashes
                 .ThenBy(c => ...); 
```

# android - how to align the item on android sqlite database

> ID：12428256
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:12:08.793
> 
> 标签：android

I want to align the item on respective column title,here is what happen,is there a way to align this or do i need to code it manually thanks

```
Name                       Hotness
Yan 10 
```

My xml code

```
 <TableLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <TableRow>

            <TextView
                android:layout_width="fill_parent"    //this is my column 1 which Name
                android:layout_weight="1"
                android:layout_height="fill_parent"
                android:text="Names" >
            </TextView>

            <TextView

                android:layout_width="fill_parent"     //the column 2 which is Hotness
                   android:layout_weight="1"
                android:layout_height="fill_parent"
                android:text="Hotness" >
            </TextView>
        </TableRow>
        </TableLayout>

        <TextView
            android:id="@+id/tvSqlInfo"       //to save on the database 
            android:layout_width="fill_parent"
            android:layout_weight="1"
            android:layout_height="fill_parent"
            android:text="get info" >
        </TextView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:25:41.457

如果您要动态插入信息，看起来就像您一样，则在插入时必须指定行的 LayoutParams。它看起来像这样

```
TableLayout table = (TableLayout) findViewById(SOME_ID_THAT_YOU_ASSIGN_TO_YOU_LAYOUT)
TableRow row = new TableRow(this);
TextView text = new TextView(this);
TableLayout.LayoutParams l = 
            new TableLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);
l.weight = 1;
row.addView(text);
table.addView(row); 
```

这应该给你你想要的。您将确保为 textView 设置文本

# css - 如何防止 tr > td 元素中的双边框

> ID：12428259
> 
> 赞同：7
> 
> 时间：2012-09-14T16:12:09.737
> 
> 标签：css, border

我想知道是否可以防止`tr > td`元素中的双边框。如果我使用`border:1px solid #DDD`，那么第一个元素将具有所有边框，然后是第二个元素，但是因为第一个元素具有右边框而第二个具有左边框，所以边框是双的，并且对于第一个具有的第二个 tr 也会发生同样的情况边框底部和第二个有边框顶部。有小费吗？我看到了这篇[文章](https://stackoverflow.com/questions/10927216/how-to-set-border-for-inner-and-outer-element-to-prevent-double-border-in-beside)，但对我不起作用，因为它适用于 DIV 并且我正在使用表格。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-14T16:14:12.967

从...开始：

`border-collapse:collapse;`

然后根据需要进行调整。使用`:first-child`和`:last-child`伪选择器可用于修改一端的默认样式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T16:34:23.580

不要在单元格上设置边框，而是将表格本身的背景颜色设置为您希望边框的颜色，然后将单元格间隔 1px：

HTML：

```
​&lt;table>
    <tr>
        <td>One</td>
        <td>Two</td>
        <td>Three</td>
    </tr>
    <tr>
        <td>Four</td>
        <td>Five</td>
        <td>Six</td>
    </tr>
</table> 
```

CSS：

```
table {
    background: #ccc;
    border-spacing: 1px;
}
td {
    background: #fff;
    padding: 5px;
} 
```

这会给你这个：

![单元格间距示例](../Images/dcc90e93a2a5021b100380c6166d02ab.png)

请注意，您还必须在单元格本身上设置背景颜色，否则表格的背景颜色将显示出来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T16:15:19.267

您正在寻找[边框折叠](https://developer.mozilla.org/en-US/docs/CSS/border-collapse)

> border-collapse CSS 属性选择表格的边框模型。这对表格单元格的外观和样式有很大影响。

价值观就是这样。

```
border-collapse:  collapse | separate | inherit 
```

# jquery - jQuery Ui Droppable Drop位置问题

> ID：12428265
> 
> 赞同：0
> 
> 时间：2012-09-14T16:12:34.423
> 
> 标签：jquery, jquery-ui

我正在尝试为我的网站使用可放置插件。我有一个在 ul 列表中有项目的页脚停靠栏，我试图能够将项目从页脚停靠栏拖到任何地方，但停靠栏以删除项目。但是，无论我尝试了什么，它都无法按预期工作。它可以让我把它放在任何地方，它会被删除。

这是我的示例代码：

**HTML**

```
<html>
<body>
...
<div id="page">
...
<div id="dock">
     <ul>
          <li class="item">item 1</li>
          <li class="item">item 2</li>
     </ul>
</div>
...
</div>
...
</body>
</html> 
```

**JS**

```
$("body").droppable({
     accept: ".item",
     drop: function(event, ui) {
          removeItem();
     }
});

$(".item").draggable({
     helper: "clone"
}); 
```

所以上面的代码没有达到我的预期。即使我还在码头，我也可以移除这些物品。所以我可以将项目拖动几个像素然后放开它会删除该项目。我想要的是让它能够下降到任何地方，但要移除的码头区域。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:36:51.357

尝试使用选项使您的 Dock 可拖动，`greedy: true`并在放置时还原该项目：http: [//jsfiddle.net/SKDDZ/](http://jsfiddle.net/SKDDZ/)

# zend-studio - Zend Studio 9 - 从 Git (BitBucket) 创建 PHP 项目

> ID：12428267
> 
> 赞同：2
> 
> 时间：2012-09-14T16:12:38.917
> 
> 标签：zend-studio, bitbucket

我一辈子都无法让 Zend Studio 从 git (bit bucket) 创建一个项目

我尝试过 HTTPS、SSH

我已经生成了一个密钥并将它放在位桶中，我在 Zend 中配置了密钥，我不确定我还能尝试什么，我渴望简单的分步说明来创建这个项目

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T20:49:34.753

事实证明，我需要使用导入的密钥运行 Putty 的 Pageant.exe。

# ajax - Ajax 请求未检测到 500 错误

> ID：12428268
> 
> 赞同：1
> 
> 时间：2012-09-14T16:12:39.707
> 
> 标签：ajax, request, prototype

我正在使用原型 1.6.1。该功能旨在在该功能开启时每 5 秒向服务器发送一次请求。它在大多数情况下都有效，但每隔一段时间就会有一个请求返回 500 内部服务器错误。发生这种情况时，该函数不会将其视为成功或失败，因此它只是完全停止该函数。我无法弄清楚为什么这会在我的一生中发生......

我在下面附上了一些代码。我已经清理了一些功能，使其更容易诊断。您是否可以在其中看到某些内容，使其无法将 500 内部服务器错误识别为成功或失败？

原型 1.6.1：

```
function AjaxRequest (url, opts){
  var headers = {
    'X-Requested-With': 'XMLHttpRequest',
    'X-Prototype-Version': '1.6.1',
    'Accept': 'text/javascript, text/html, application/xml, text/xml, */*'
  };
  var ajax = null;

  if (window.XMLHttpRequest)
    ajax=new XMLHttpRequest();
  else
    ajax=new ActiveXObject("Microsoft.XMLHTTP");

  if (opts.method==null || opts.method=='')
    method = 'GET';
  else
    method = opts.method.toUpperCase();  

  if (method == 'POST'){
    headers['Content-type'] = 'application/x-www-form-urlencoded; charset=UTF-8';
  } else if (method == 'GET'){
    addUrlArgs (url, opts.parameters);
  }

  ajax.onreadystatechange = function(){
//  ['Uninitialized', 'Loading', 'Loaded', 'Interactive', 'Complete']; states 0-4
    if (ajax.readyState==4) {
      if (ajax.status >= 200 && ajax.status < 305)
        if (opts.onSuccess) opts.onSuccess(ajax);
      else
        if (opts.onFailure) opts.onFailure(ajax);
    } else {
      if (opts.onChange) opts.onChange (ajax);
    }
  }  

  ajax.open(method, url, true);   // always async!

  for (var k in headers)
    ajax.setRequestHeader (k, headers[k]);
  if (matTypeof(opts.requestHeaders)=='object')
    for (var k in opts.requestHeaders)
      ajax.setRequestHeader (k, opts.requestHeaders[k]);

  if (method == 'POST'){
    var a = [];
    for (k in opts.parameters){
      if(matTypeof(opts.parameters[k]) == 'object')
        for(var h in opts.parameters[k])
            a.push (k+'['+h+'] ='+ opts.parameters[k][h] );
      else
        a.push (k +'='+ opts.parameters[k] );
    }
    ajax.send (a.join ('&'));
  } else               {
    ajax.send();
  }
} 
```

功能：

```
 sendRequest: function(p,callback,r,retry, CrestDataNum){
    var t = Tabs.Crest;
    new AjaxRequest(unsafeWindow.g_ajaxpath + "ajax/crest.php" + unsafeWindow.g_ajaxsuffix, {    
         method: "post",
         parameters: p,
         loading: true,

         onSuccess: function (transport) {       
            var rslt = eval("(" + transport.responseText + ")");
            if (rslt.ok) {
                setTimeout (function(){callback(r,0,parseInt(CrestDataNum)+1);},(1000)); //Goes to next request   
                return;
            } 
        },
         onFailure: function () { 
            setTimeout (function(){callback(r,retry,CrestDataNum);}, 5000); //repeats request on failure
            return;
         }
      });    
}, 
```

# ios - iPad 模拟器损坏

> ID：12428273
> 
> 赞同：2
> 
> 时间：2012-09-14T16:13:07.873
> 
> 标签：ios, xcode, ipad, ios-simulator

我在 Mountain Lion 上运行最新版本的 Xcode。我的 iPad 模拟器似乎已损坏。我所有的 ipad 应用程序都只是在左上角显示为一个 iphone 大小的屏幕，带有损坏的图形状态栏，包括新项目和旧项目。

![屏幕](../Images/5d0d4bc28dc6b549fc07b618d90fad3d.png)

有人遇到过这个吗？我已经重置了模拟器中的内容和设置。

干净的安装是这里唯一的选择吗？

# download - 下载页面 - 同步，而不是异步

> ID：12428276
> 
> 赞同：2
> 
> 时间：2012-09-14T16:13:14.050
> 
> 标签：download, actionscript-2

我是 AS2 的新手，我看到有异步发布数据的函数：Send 和 SendAndLoad。但是，它们在执行时具有不可预测的行为，因为它们是异步的，并且可以在其他函数之后或之前完成。

但是我的脚本是否阻塞等待下载并不重要。

因此，我正在寻找一种将 AS2 中的网页同步下载到字符串的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T17:51:34.420

以同步方式加载数据会导致您的 Flash 电影在下载外部数据时“锁定”——这并不是您真正想要发生的。最好以异步加载数据的方式构建代码，然后再启动同步操作。

我不认为像你所追求的同步加载过程真的是可能的，所以它可能是重写你的代码的情况。你能提供一个代码示例吗？

# prototypejs - 使用 noConflict 后 jQuery 和prototype.js 不工作

> ID：12428278
> 
> 赞同：2
> 
> 时间：2012-09-14T16:13:22.827
> 
> 标签：prototypejs, jquery

我正在为一个项目使用[Acuity Scheduling](http://acuityscheduling.com)。它使用prototype.js 并允许我将自己的自定义代码添加到页面的页眉和页脚（通过iframe 提供给我的网站）。我不熟悉prototype.js，所以我试图以一种不会冲突的方式运行jQuery。到目前为止，我什至无法`alert()`成功工作。**我该怎么做才能在这个页面上使用 jQuery？**

你可以在这里看到我的 iframe 的内容：[https ://acuityscheduling.com/schedule.php?owner=11134756](https://acuityscheduling.com/schedule.php?owner=11134756)

如果您查看源代码，您会在底部看到我添加的代码：

```
<script language="javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script language="javascript">
  jQuery.noConflict();

  jQuery(document).ready(function(){
    jQuery('.time-selection').click(function() {
      jQuery('#rest').append('<p class="continueAlert">Please enter your name and contact info below.</p>');  
    });
  });
</script> 
```

我阅读了所有[关于将 jQuery 与其他库一起使用的 jQuery 文档，](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)并尝试了我认为可能有用的示例。使用上面的代码，我也尝试过不`jQuery.noConflict();`使用 ，因为上面的代码我没有使用`$`，而是使用`jQuery`.

感谢您对此提供的任何见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:31:54.677

我现在最喜欢的 javascript 调试器是 chrome。在 Chrome 中查看您的网站，我发现`jQuery('.time-selection');`在 jquery.ready() 期间不会返回任何结果。这意味着实际上没有将点击处理程序添加到时间选择单选按钮。

一旦选择了约会类型和日期并且单选按钮出现在屏幕上，然后`jQuery('.time-selection');`返回所有按钮。我此时使用 javascript 控制台窗口手动添加了事件，当单击单选按钮时，文本消息正确附加到窗口底部。

因此，我不认为此时您的库之间存在冲突 - 问题是您无法将事件添加到尚未创建的项目中。

幸运的是，看起来[JQuery 有一个解决方案。](https://stackoverflow.com/questions/1359018/in-jquery-how-to-attach-events-to-dynamic-html-elements) 使用 .on() 事件处理程序，您可以为尚未创建的项目指定事件处理程序。试试这个代码：

```
<script language="javascript">
  jQuery.noConflict();

  jQuery(document).ready(function(){
     jQuery('body').on('click', '.time-selection', function() {
        jQuery('#rest').append('<p class="continueAlert">Please enter your name and contact info below.</p>');  
     });
  });
</script> 
```

当创建 .time-selection 项目时，此事件处理程序将应用于它们。

**注意：** 必须通过 https 访问 Acuityscheduling.com。由于您的 jquery 库 url 使用 http 而不是 https，因此我在 Chrome 中收到不安全的内容警告。您的浏览器可能会完全拒绝 jquery 库。

Google 也支持 https，所以我建议改用 https。改变

```
<script language="javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script> 
```

至

```
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script> 
```

应该做的伎俩。

# c++ - 录制音频，存储在缓冲区中，然后通过 PulseAudio 将字节写入声卡

> ID：12428281
> 
> 赞同：1
> 
> 时间：2012-09-14T16:13:39.293
> 
> 标签：c++, record, playback, pulseaudio

我正在尝试使用以下代码行录制音频：

```
// The sample type to use
static const pa_sample_spec ss = {
.format = PA_SAMPLE_S32LE , //PA_SAMPLE_S16BE, ??? Which one to us here ??? BE...Big Endian
.rate = 44100, // That are samples per second
.channels = 2
};

// Create the recording stream
// see: http://freedesktop.org/software/pulseaudio/doxygen/parec-simple_8c-example.html
if (!(s = pa_simple_new(NULL, "Record", PA_STREAM_RECORD, NULL, "record", &ss, NULL, NULL, &error))) {
    fprintf(stderr, __FILE__": pa_simple_new() failed: %s\n", pa_strerror(error));
    pa_simple_free(s);
    exit(EXIT_FAILURE);
}

int i = -1;

while (!exit_program) {
    i = (i+1) % BUFNUMBER;

    pthread_mutex_lock(&(buffer[i].write));
    // Record data and save it to the buffer
    if (pa_simple_read(s, buffer[i].buf, sizeof(buffer[i].buf), &error) < 0) {
        fprintf(stderr, __FILE__": pa_simple_read() failed: %s\n", pa_strerror(error));
        pa_simple_free(s);
        exit(EXIT_FAILURE);
    }

    // unlock the reading mutex
    pthread_mutex_unlock(&(buffer[i].read)); // open up for reading

} 
```

如您所见，我将读取的字节存储在一个名为 buffer 的结构中，如下所示：

```
#define BUFSIZE 44100  // Size of one element
#define BUFNUMBER 16 // Number of elements
#define AUDIO_BUFFER_FORMAT char

// one element of the ringbuffer
typedef struct ringbuf {
    AUDIO_BUFFER_FORMAT buf[BUFSIZE]; /* The buffer array */
    pthread_mutex_t read; /* indicates if block was read */
    pthread_mutex_t write; /* for locking writing */
} ringbuffer_element; 
```

另一个线程尝试读取和播放存储在缓冲区中的字节：

```
// The sample type to use
static const pa_sample_spec ss = {
.format = PA_SAMPLE_S32LE , //PA_SAMPLE_S16BE,
.rate = 44100,
.channels = 2
};

if (stream == NULL) {
    if (!(stream = pa_simple_new(NULL, "Stream", PA_STREAM_PLAYBACK, NULL, "playback", &ss, NULL, NULL, &error))) {
        fprintf(stderr, __FILE__": pa_simple_new() failed: %s\n", pa_strerror(error));
        return false;
    }
}

if (pa_simple_write(stream, buf, (size_t) size, &error) < 0) {
    fprintf(stderr, __FILE__": pa_simple_write() failed: %s\n", pa_strerror(error));
    pa_simple_free(stream);
    return false;
}

/* Make sure that every single sample was played */
if (pa_simple_drain(stream, &error) < 0) {
    fprintf(stderr, __FILE__": pa_simple_drain() failed: %s\n", pa_strerror(error));
    pa_simple_free(stream);
    return false;
} 
```

但是，我测试了缓冲区的实现，效果很好。尽管如此，我唯一能听到的就是噪音。所以我想知道，如果我需要转换字节才能再次播放它们，以便听起来像录音。

此外，我找不到我的声卡等的任何数据表。我必须转换字节还是可以按录制的方式播放它们？我使用的格式是否破坏了某些东西？

我真的被困在这里了。希望你们能帮助我。

编辑：还有一个问题：如果我使用 ALSA API 为了我的目的更接近硬件会更好吗？是的，我对声音编程完全陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T11:13:00.690

解决方案：

两个值： #define BUFSIZE 44100 // 一个元素的大小 #define BUFNUMBER 16 // 元素个数

没关系。它们不应该太小。否则程序将卡住播放音频。

重要的不是！！！每次播放缓冲区结构片段时调用以下代码片段。音频声卡包含一个缓冲区，默认情况下，缓冲区首先被填充然后播放。这也是为什么播放音频会有一点延迟的原因。

```
/* Make sure that every single sample was played */
if (pa_simple_drain(stream, &error) < 0) {
    fprintf(stderr, __FILE__": pa_simple_drain() failed: %s\n", pa_strerror(error));
    pa_simple_free(stream);
    return false;
} 
```

可以通过以下代码找出延迟量：

```
pa_usec_t latency;

if ((latency = pa_simple_get_latency(stream, &error)) == (pa_usec_t) -1) {
    fprintf(stderr, __FILE__": pa_simple_get_latency() failed: %s\n", pa_strerror(error));
}

fprintf(stderr, "%0.0f usec  \r", (float)latency); 
```

然而，延迟不是恒定的，并且一直在变化。顺便说一句：如果需要，可以在创建播放流时设置缓冲区大小。

哦，我用的是：PA_SAMPLE_S16LE，但是你只需要使用相同的值来录制和播放，否则听起来很奇怪。

希望对某人有所帮助。

# c++ - 错误 LNK2001：无法解析的外部符号“__declspec(dllimport) public: class QString & __thiscall QString::operator=(class QString &&)”

> ID：12428282
> 
> 赞同：6
> 
> 时间：2012-09-14T16:13:40.543
> 
> 标签：c++, visual-studio-2010, qstring, lnk2001

我迫切希望找到有关上述错误的任何信息。

我正在使用 Visual Studio 2010。当我在调试或发布时编译我的项目（32 位）时，我收到以下消息：

> 1>heterogeneous.obj：错误LNK2001：无法解析的外部符号“__declspec(dllimport) public: class QString & _ *thiscall QString::operator=(class QString &&)”(* _imp_??4QString@@QAEAAV0@$$QAV0@@Z )
> 
> 1>debug\nori.exe : 致命错误 LNK1120: 1 unresolved externals

我在 Linker->Input 中链接了 QtCore4.lib，我将 Qt\4.8.2\lib 添加到 Linker->General 中的库目录中，并包含了 Qt\4.8.2\include 和 Qt\4.8.2\include\QtCore在 C/C++-> 常规中。在我看来，他们应该定义 QString。我不知道我还能做什么。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T19:25:45.800

我有同样的问题，但我使用的是 VS2008 的 Qt 库。

我[为 VS2010 安装了 Qt 库](http://qt-project.org/downloads#qt-lib)来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:32:38.817

找出 Qt DLL 在哪里。您可能必须将该目录添加到 Debugging->Environment。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T09:57:40.187

一段时间后，我决定删除并重新安装 Qt 库，它可以工作。但是，我不知道为什么。

谢谢你的帮助 ！

# html - 像文本字段一样设置输入类型搜索字段的样式

> ID：12428286
> 
> 赞同：1
> 
> 时间：2012-09-14T16:14:18.617
> 
> 标签：html, css, safari

我希望我的搜索字段（在 Safari 中）看起来像一个普通的文本字段，（但添加了 x 按钮来清除搜索）

这是我到目前为止所拥有的：

[http://jsfiddle.net/Pss4Z/1/](http://jsfiddle.net/Pss4Z/1/)

基本上，我只是应用它来重置样式。

```
-webkit-appearance:textfield;
-moz-appearance:textfield; 
```

一切都很好，除了一件事。在 safari（尚未测试 firefox）中，当您单击所有输入字段时，它们周围会显示一个蓝色边框。但是，如果您在此示例中尝试这样做，您会注意到该边框的显示在文本和搜索字段之间是不同的；

对于文本字段，蓝色边框直接在字段的灰色边框上方，但对于搜索字段，有一点间距，您可以同时看到灰色边框和蓝色边框。

是否可以将其更改回其默认行为（如文本字段）？

谢谢你，韦斯利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:55:59.600

您需要定义边框以消除蓝色边框效果。

[http://jsfiddle.net/Pss4Z/5/](http://jsfiddle.net/Pss4Z/5/)

```
border: 1px solid gray; 
```

这是针对火狐的。

对于 Safari，您需要添加

```
outline: none; 
```

[http://jsfiddle.net/Pss4Z/6/](http://jsfiddle.net/Pss4Z/6/)

# web-services - 在 Excel VBA 函数中缓存密码的最佳方法

> ID：12428293
> 
> 赞同：1
> 
> 时间：2012-09-14T16:14:59.443
> 
> 标签：web-services, security, excel, vba, passwords

我需要通过 Excel 连接到一些远程数据库（不要问我为什么 ^^'）。我们不能直接通过 ODBC 连接，但是我会在连接到数据库的另一台计算机上查询一个 web 服务。要发送的登录名/密码将通过 excel 的 https 发送。然后，Web 服务将使用这些信息连接到数据库。我不想每次查询webservice时都询问密码，我需要缓存它。有没有比存储在某种全局变量中更好的方法（我很确定有）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:49:42.190

对于您所描述的，我认为全局变量是最好的选择。

但是，如果您希望密码“持续更长时间”。您可以对其进行哈希处理，并将其存储在工作簿、注册表或您喜欢的任何其他地方。如果要遵循注册表方法，请使用`GetSetting`and 。`SaveSetting`

# parsing - prolog解析操作问题

> ID：12428303
> 
> 赞同：2
> 
> 时间：2012-09-14T16:15:20.930
> 
> 标签：parsing, prolog

这是问题所在。我想做一个序言程序，`count(a*b*c, * , N)`它会计算`*`in `a*b*c`和 return `N=2`。

我怎样才能做到这一点？

我做了一些研究，要么将其作为 s 字符串传递，要么使用列表来分隔`a*b*c`.

然而，到目前为止，没有任何事情是成功的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T18:06:27.853

该表达式`a*b*c`是一个简化的复合项：

```
?- write_canonical(a*b*c).
*(*(a,b),c) 
```

你可以看到这`*`只是一个二元关系的函子，表达式树的访问可以使用内置的[univ来完成：](http://www.swi-prolog.org/pldoc/doc_for?object=%28=..%29/2)

```
count(Expression, Request, N) :-
    (   Expression =.. [Op, Left, Right]
    ->  count(Left, Request, NLeft),
        count(Right, Request, NRight),
        (   Request == Op
        ->  N is NLeft + NRight + 1
        ;   N is NLeft + NRight
        )
    ;   N = 0
    ). 
```

这接受带有任何二元运算符的树表达式，但也可以，例如

```
?- count(e(a,e(b,c)),e,N).
N = 2. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T18:10:00.377

它只会计算 * 但修改它以计算其他东西应该很困难：

```
main :-
    atom_chars('a*b*c', CharList),
    star_counter(CharList, Count),
    write(Count).

star_counter([], 0).

star_counter(['*'|R], Count) :-
    star_counter(R, Sum),
    Count is Sum + 1.

star_counter([H|R], Count) :-
    star_counter(R, Count). 
```

**编辑**这是一个版本，其中包含您要查找的字符的参数：

```
main :-
    atom_chars('a*b*c', CharList),
    star_counter('*',CharList, Count),
    write(Count).

star_counter(_,[], 0).

star_counter(X,[X|R], Count) :-
    star_counter(X,R, Sum),
    Count is Sum + 1.

star_counter(X,[_|R], Count) :-
    star_counter(X,R, Count). 
```

# regex - 用于重命名包含空格的文件夹的 Unix CLI 脚本

> ID：12428306
> 
> 赞同：1
> 
> 时间：2012-09-14T16:15:27.453
> 
> 标签：regex, bash, unix, rename

我有一个文件夹结构如下的目录：

```
DATA -- ABD 1231345 -- 2012_01_08
                    -- 2012_03_09
                    -- 2012_06_11

     -- DEF 4859480 -- 2012_02_10
                    -- 2012_05_10
                    -- 2012_07_10 
```

我想做的是：

*   `cd DATA`
*   运行一个 bash 脚本（在 中`/DATA`），它将重命名所有第一个子文件夹

> ABD 1231345

至

> ABD_1231345

你对如何在 Mac OSX / unix 上使用命令行有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:19:14.290

```
for i in *; do mv "$i" "${i// /_}"; done 
```

Note that the `${i//string/repl}` syntax is a non-standard extension of sh, but you can do the same thing portably with something like:

```
for i in *; do j=$( echo "$i" | tr ' ' _); mv "$i" "$j"; done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T19:47:03.750

**当前目录包含：**

```
aa 111
bb 222
aaa.txt
aaa 1111.txt
bbb 2222.txt 
```

**输出：**

```
aa_111
bb_222
aaa.txt
aaa 1111.txt
bbb 2222.txt 
```

**代码：**

```
ls -ltr|awk -F" " '{print $9,$10}'|sed 's/ $//g'|grep -v "^$">abc

while read line
do
val=`echo $line`
echo $line|grep " ">/dev/null
rc=$?
if [[ -d "$val" && $rc -eq 0 ]]
then
replace=`echo $line|sed 's/ /_/g'`
mv "$val" "$replace"
fi
done<abc

rm -f abc 
```

在这里，上面的脚本仅重命名当前目录中的文件夹。您可以跳过 grep 部分（为了提高效率）。

# c++ - 隐式复制构造函数

> ID：12428308
> 
> 赞同：7
> 
> 时间：2012-09-14T16:15:34.083
> 
> 标签：c++, c++11, copy-constructor, implicit-conversion

引自 n3337 12.3.1/3

> 非显式复制/移动构造函数 (12.8) 是转换构造函数。隐式声明的复制/移动构造函数不是显式构造函数；可能会调用它进行隐式类型转换。

引用自 ANSI ISO IEC 14882 2003

> 非显式复制构造函数 (12.8) 是转换构造函数。隐式声明的复制构造函数不是显式构造函数；可能会调用它进行隐式类型转换。

我没有想法，如何`copy-constructor`用于`implicit`type `conversions`。如果它是标准中的印刷错误/错误，为什么自 C++03 标准以来没有更正？`type conversions`非常感谢任何链接和示例（如果我们可以将其用于）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T16:21:42.650

A copy constructor can convert from an object of a derived type by slicing it:

```
struct A {};
struct B : A {};

B b;
A a = b; // uses A::A(A const&) to convert B to A 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-15T14:46:36.243

在隐式内联中，内联成员函数是在类定义中定义的。不使用关键字 inline

# arduino - 如何使用 Arduino UNO 和按钮使电路上的 LED 闪烁？

> ID：12428315
> 
> 赞同：3
> 
> 时间：2012-09-14T16:16:24.710
> 
> 标签：arduino, led

```
 /*
  Button

 Turns on and off a light emitting diode(LED) connected to digital  
 pin 13, when pressing a pushbutton attached to pin 2\. 

 The circuit:
 * LED attached from pin 13 to ground 
 * pushbutton attached to pin 2 from +5V
 * 10K resistor attached to pin 2 from ground

 * Note: on most Arduinos there is already an LED on the board
 attached to pin 13.

 created 2005
 by DojoDave <http://www.0j0.org>
 modified 30 Aug 2011
 by Tom Igoe

 This example code is in the public domain.

 http://www.arduino.cc/en/Tutorial/Button
 */

// set pin numbers:
const int buttonPin = 2;     // the number of the pushbutton pin
const int led =  11;      // the number of the LED pin

// variables will change:
int buttonState = 0;         // variable for reading the pushbutton status
int buttonHistory = 0;        //Counting variable for button being pressed

void setup() {
  // initialize the LED pin as an output:
  pinMode(led, OUTPUT);      
  // initialize the pushbutton pin as an input:
  pinMode(buttonPin, INPUT);     
}

void loop(){
  // read the state of the pushbutton value:
  buttonState = digitalRead(buttonPin);
  if (buttonState == HIGH){
    buttonState++;
  }

  // check if the pushbutton is pressed.
  // if it is, the buttonState is HIGH:
    if (buttonHistory >= 0 && buttonState >= 0) {  
      // turn LED on:;
      int x = x + (.1*255);
      analogWrite(led, x);  

    }
    else if (buttonState == LOW){
      analogWrite(led, 0);
    }

    if (buttonState == 11){
      buttonState = 0;
    }
    buttonHistory = buttonState;
} 
```

上面的一些代码是从 Arduino 网站复制的，但我对其进行了编辑。

以上是我的代码。我的目标是在非焊接面包板上制作一个带有电阻的 LED，以便在我按下该面包板上的按钮时点亮。一切都已连接好，我可以让 LED 亮起，但当我按下按钮时就不行了。我希望每次按下按钮时 LED 都会变亮 10%，然后当它达到最大亮度时，在下一次按下时关闭。我的问题是，现在，LED 一直亮着，按下按钮不会做任何事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T16:38:29.280

您必须将[LED](http://en.wikipedia.org/wiki/Light-emitting_diode)连接到 Arduino 的[PWM](http://en.wikipedia.org/wiki/Pulse-width_modulation)输出之一。

PWM 输出可以设置为 0 到 255 之间的值，这意味着将设置电流到该输出的值与该值成比例的时间，其余时间将处于 0 V。

在 Arduino 的官方网站上查看以下示例以[使 LED 褪色](http://arduino.cc/en/Tutorial/Fading)。

您还应该使用[函数 map](http://arduino.cc/en/Reference/map)，因为它可以简化您的代码映射值。

至于你的代码，你可以试试这个（我还没有编译它，所以请原谅任何错误）：

```
// Read the state of the pushbutton value, and update the fade LED value:
buttonState = digitalRead(buttonPin);
if (buttonState == HIGH){
    // buttonState++; Probably this was the main bug in your code.
    buttonHistory++;
}

// We are cycling buttonHistory, not buttonState
if (buttonHistory == 11){
    buttonHistory = 0;
}

//if (buttonHistory >= 0 && buttonState >= 0) {
  // Turn LED on at desired intensity:;
  int x = map(buttonHistory, 0, 10, 0, 255); // Similar to doing x=.1*255*buttonHistory
  analogWrite(led, x);

//}
// REDUNDANT:
//else if (buttonState == LOW){
//  analogWrite(led, 0);
//} 
```

您还应该考虑`delay()`在周期之间添加，否则您会太快地更新 LED 的强度而无法注意到它（您会调用`digitalRead(buttonPin);`太多次太快）。'analogWrite()' 之后可以是一个好地方（感谢@mike 的建议）：

```
analogWrite(led, x);
delay(500); 
```

# macos - 如何使用 Mac 开发人员 ID 签署 Qt 应用程序？

> ID：12428318
> 
> 赞同：2
> 
> 时间：2012-09-14T16:16:34.877
> 
> 标签：macos, code-signing, osx-mountain-lion, qt4.7, osx-gatekeeper

我有我的第一个跨平台应用程序准备发布，使用 Qt 4.7.4 开发，使用 Qt Creator（不是 Xcode）。我以为我已经准备好了一切：我有一个可以运行`macdeployqt`并生成 .dmg 的脚本，效果很好。我不打算将此应用程序放在 Mac App Store 中。用户只需从我们的网站下载 .dmg。

但是，在 Mac OS X 10.8 Mountain Lion 上，如果我没有与我的应用关联的开发者 ID，Gatekeeper 的默认设置会给我的用户造成混淆。

我用谷歌搜索了很多，对我需要做什么感到很困惑。我以前从未对代码签名做过任何事情，而且很少使用 Mac 的钥匙串。获取已完成的 Qt 应用程序并使其与开发人员 ID 相关联的步骤是什么，因此 Gatekeeper 在其默认设置下会对我的 dmg 感到满意而不会使我的用户感到困惑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-30T13:19:25.373

您需要三个步骤： 1\. 签署包本身 2\. 签署包内的 .dylib 二进制文件 3\. 签署 Qt 框架（主要是包内的 Qt* 等所有内容）

所有三个步骤中使用的命令是：

```
codesign --force --verify --verbose --sign 'YOUR IDENTITY HERE' HelloWorld.app 
```

其他文件（.dylibs 和 Qt 框架）的相似之处见[man](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/codesign.1.html#//apple_ref/doc/man/1/codesign) codesign以获得详细解释。您应该已经生成了一个证书并将其包含在您的 Keychan 中。如果您不知道从哪里获得证书，那么……那是另一个话题。

[编辑：在此处](http://successfulsoftware.net/2012/08/30/how-to-sign-your-mac-os-x-app-for-gatekeeper/)添加了更详细的文章。

# javascript - Chrome javascript控制台行为奇怪

> ID：12428322
> 
> 赞同：0
> 
> 时间：2012-09-14T16:16:47.470
> 
> 标签：javascript, jquery, google-chrome, google-chrome-devtools

运行此代码在 Chrome javascript 控制台中**交替**显示`<div id="c"></div>`和*扩展。* `HTMLDivElement`

```
$(function() {
    console.log( $("#c")[0] );
});

<div id="c"></div> 
```

~~如果我运行`alert()`而不是`console.log()`，它总是返回 [object HTMLDivElement]。~~

并不是说它让我很不安，但是如果输入没有改变，这种输出不应该有点恒定吗？那么这是Chrome控制台如何呈现对象的某种错误还是什么？

顺便说一句，我无法通过 jsfiddle 重现该问题。我的 Chrome 是 21.0.1180.89 版和 jQuery - 1.6.4 版。

* * *

**编辑：**示例：我刷新页面，控制台显示`<div id="c"></div>`. 然后我再次刷新页面，控制台现在显示可扩展`HTMLDivElement`等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:20:48.733

console.log has the ability to show you the object. alert shows strings, numbers, primitive types, you pass an object and alert will say that is an object. because the tostring() of object returns [object HTMLDivElement] in your case.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:19:27.320

In Chrome console the `$` is already a reference for `document.getElementById()`, so try to use `jQuery` instead of `$`

```
jQuery(function() {
    console.log( jQuery("#c")[0] );
}); 
```

This should solve the issue, giving a uniform output. And as others answered, the alert is just applying a toString() method (since alert function is expecting to output a string).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:25:05.873

JavaScript 警报向您显示对象的 toString() 结果，因为它不能显示字符串以外的任何内容。控制台能够为您提供对象的交互式表示。

# class - 用不同类型的当前元素和左/右列表泛化 Zipper 上的方法

> ID：12428324
> 
> 赞同：1
> 
> 时间：2012-09-14T16:16:49.263
> 
> 标签：class, haskell, zipper

我正在玩弄拉链，其中当前元素可以具有与左右列表不同的类型：

```
data Z a b = Z ([a], b, [a]) 
```

`moveLeft`可以使用和浏览拉链`moveRight`：

```
moveLeft  :: (b -> a -> a) -> (a -> b -> b) -> Z a b -> Z a b
moveLeft listF currentF (Z (x:xs, c, ys)) = Z (xs, g x c, ((f c x):ys))

moveRight :: (b -> a -> a) -> (a -> b -> b) -> Z a b -> Z a b
moveRight listF currentF (Z (xs, c, y:ys)) = Z (((f c y):xs), g y c, ys) 
```

在这里，`listF`将列表元素和当前元素转换为左侧或右侧的列表元素。`currentF`将当前元素和列表元素转换为当前元素。

如果当前类型和列表类型相等，则移动很简单：

```
moveLeftSameType :: Z a a -> Z a a
moveLeftSameType = moveLeft const const 
```

一切都按预期工作，很好！

我现在想做的是概括上述想法，这样只需为给定的（比如, ）实现`listF`and`currentF`函数，并自动做正确的事情。这样做的正确方法是什么？`Z a b``a :: Char``b :: Int``moveLeft``moveRight`

*评论*

我试图实现这样的类：

```
class CPos a where
    listF :: c -> d -> d
    currentF :: d -> c -> c
    moveLeft :: a -> a
    moveRight :: a -> a 
```

where`moveLeft/Right`是根据`listF`and实现的`currentF`，但这失败了

```
The class method `listF' mentions none of the type variables of the class CPos a 
```

*备注 2*

我一般不喜欢上述想法的一点是允许任意函数`listF`并且`currentF`无法保证

```
moveLeft . moveRight = id 
```

（如果拉链在列表中，则在边框上无论如何都不存在）。执行此操作的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:28:40.793

这是一个解决方案。

```
class CPos a b where
    listF :: b -> a -> a
    currentF :: a -> b -> b
    moveLeft :: Z a b -> Z a b
    moveLeft (Z (x:xs, c, ys)) = Z (xs, currentF x c, ((listF c x):ys))
    moveRight :: Z a b -> Z a b
    moveRight (Z (xs, c, y:ys)) = Z (((listF c y):xs), currentF y c, ys) 
```

我不认为你可以强制执行`moveLeft . moveRight = id`。我的意思是不能保证两个函数相等。您能做的最好的事情就是编写`quickcheck`测试用例来保证相同。

# java - Playframework Images.resize() 不自动旋转图片

> ID：12428326
> 
> 赞同：0
> 
> 时间：2012-09-14T16:16:53.100
> 
> 标签：java, playframework, blob, playframework-1.x

我正在使用 Play Framework 1.2.4。并`Blob Images.resize(File originalImage, File to, int w, int h)`调整图片大小。

当图片为纵向（高度大于宽度）时，输出会自动旋转，我该如何防止这种行为？

**以下是示例：**

原图：

![调整大小前的原始图像](../Images/dc2409077f67d1a677cc56249074b25c.png)

调整大小的图像旋转：

![在此处输入图像描述](../Images/e8461c88a3026da1acfc291649ad4df1.png)

我感谢任何建议或意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:50:49.957

奇怪的。也许图像上有 Exif 数据（说是旋转显示）。这种情况经常发生在手机照片上。风景图片也会发生同样的事情吗？

我使用这个库：[http](http://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/) ://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/它也不能避免 Exif 旋转问题。还有其他关于如何处理的帖子：[如何根据方向元数据旋转 JPEG 图像？](https://stackoverflow.com/questions/5905868/am-i-making-this-too-complicated-image-rotation)

# c# - 数据绑定一个可观察的字符串集合

> ID：12428331
> 
> 赞同：1
> 
> 时间：2012-09-14T16:16:58.967
> 
> 标签：c#, xaml, windows-8, windows-runtime, .net-4.5

我有以下课程：

```
public class MyClass
{
    public ObservableCollection<string> MyList { get; set; }
    public string MyListTitle { get; set; }
... 
```

我将其填充如下：

```
MyClass myClass = new MyClass("Data"); // Populates title

myClass.MyList.Add("Test data 1");
myClass.MyList.Add("Test data 2");

myListView.DataContext = MyClass.MyList; 
```

最后，这是 XAML：

```
<ListView Visibility="Visible" x:Name="myListView" Height="Auto">
    <ScrollViewer x:Name="contentScrollView">
        <TextBlock x:Name="DataItem" Text="{Binding}" />                                
    </ScrollViewer>
</ListView> 
```

结果（和问题）是我在列表视图中显示了一次类名，而不是上面的两个条目。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T16:23:56.363

您首先需要将`ItemsSource`属性设置`ListView`为您的`ObservableCollection`

```
myListView.ItemsSource = myClass.MyList; 
```

此外，您需要使用[DataTemplate](http://msdn.microsoft.com/en-us/library/system.windows.datatemplate.aspx)来显示实际项目：

```
<ListView.ItemTemplate>
 <DataTemplate>
   <TextBlock x:Name="DataItem" Text="{Binding}" /> 
 </DataTemplate>
</ListView.ItemTemplate> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:19:58.797

You're binding the TextBlock that's why you receive the .ToString() of the list. What you need to bind is the [ItemsSource](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemssource.aspx) of your list, that way the ListView will bind its items with the ones inside your list.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:32:55.510

它应该是

```
<ListView x:Name="myListView" Height="Auto" ItemsSource="{Binding MyList}">            
        <ListView.ItemTemplate>
            <DataTemplate>
                <TextBlock x:Name="DataItem" Text="{Binding}" />
            </DataTemplate>
        </ListView.ItemTemplate>            
    </ListView> 
```

和

```
MyClass myClass = new MyClass();

        myClass.MyList = new ObservableCollection<string>();
        myClass.MyList.Add("Test data 1");
        myClass.MyList.Add("Test data 2");

        this.DataContext = myClass; 
```

和

```
public class MyClass
{
    public ObservableCollection<string> MyList { get; set; }
    public string MyListTitle { get; set; }

    public MyClass()
    {

    }
} 
```

结果

![在此处输入图像描述](../Images/d327f9e48d11a5777d6660b49ff9ee4d.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T16:22:05.360

可能是这个

```
myListView.DataContext = MyClass.MyList; 
```

将成为

```
myListView.DataContext = myClass.MyList; //note the case of myClass 
```

# c# - System.Linq.Expressions.Expression 用于 .OrderBy 函数

> ID：12428335
> 
> 赞同：4
> 
> 时间：2012-09-14T16:17:39.497
> 
> 标签：c#, asp.net, linq, generics, expression

我的代码中有一个重复的行部分。

您将看到下面的 lambda 表达式重复 4 次

```
x => x.GetValue<string>("City")).ThenByDescending(x => HelperFunctions.strToTZDateTime(x.GetValue<string>("EventStartStr"), x.GetValue<string[]>("EventTimeZone")[0].ToString()) 
```

代码示例：

```
//SORT DATA
    switch (SortDetails)
    {
        case ("Date"):
        default:
            if (SortOrder == "ASC")
            {
                _allEvents = _allEvents.OrderBy(x => HelperFunctions.strToTZDateTime(x.GetValue<string>("EventStartStr"), x.GetValue<string[]>("EventTimeZone")[0].ToString()));
            }
            else
            {
                _allEvents = _allEvents.OrderByDescending(x => HelperFunctions.strToTZDateTime(x.GetValue<string>("EventStartStr"), x.GetValue<string[]>("EventTimeZone")[0].ToString()));
            }
            break;
        case ("Location"):
            if (SortOrder == "ASC")
            {
                _allEvents = _allEvents.OrderBy(x => x.GetValue<string>("Country")).ThenBy(x => x.GetValue<string>("ProvinceState")).ThenBy(x => x.GetValue<string>("City")).ThenBy(x => HelperFunctions.strToTZDateTime(x.GetValue<string>("EventStartStr"), x.GetValue<string[]>("EventTimeZone")[0].ToString()));
            }
            else
            {
                _allEvents = _allEvents.OrderByDescending(x => x.GetValue<string>("Country")).ThenByDescending(x => x.GetValue<string>("ProvinceState")).ThenByDescending(x => x.GetValue<string>("City")).ThenByDescending(x => HelperFunctions.strToTZDateTime(x.GetValue<string>("EventStartStr"), x.GetValue<string[]>("EventTimeZone")[0].ToString()));
            }
            break;
    } 
```

我想把第一行做成我可以直接放入 OrderBy 的东西。

就像是 ：

```
System.Linq.Expressions.Expression<Func<DynamicContent, DateTime>> sortLambda = x => HelperFunctions.strToTZDateTime(x.GetValue<string>("EventStartStr"), x.GetValue<string[]>("EventTimeZone")[0].ToString()); 
```

进入 ：

```
allEvents = _allEvents.OrderBy(sortLambda); 
```

不幸的是，这似乎效果不佳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T09:22:09.293

这个控制台应用程序应该可以解决您的问题。sortLamda 可以是任何类型，希望能回答您关于动态内容的问题。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Linq.Expressions;

internal class BoringEvent
{
    public string EventStartStr { get; set; }
    public string EventTimeZone { get; set; }
    public string ProvinceState { get; set; }
    public string City { get; set; }
    public string Country { get; set; }
}

internal enum SortedBy
{
    Ascending = 0,
    Descending
}

class ExpressionsTest
{
    internal static List<BoringEvent> _allEvents = new List<BoringEvent>();
    internal static class HelperFunctions
    {
        public static DateTime strToTZDateTime(string startDate, 
            string timeZone)
        {
            //I'm too lazy to figure out dates by time zone.
            //Your function already has the logic, so why bother.
            //Let's assume the time zone is equal in this test case
            return DateTime.Parse(startDate);
        }
    }

    internal static void Main()
    {

        _allEvents.Add(new BoringEvent {
            EventStartStr = "12/31/1999", 
            //let's party like it's 1999 - (yawn) I'm stuck at this event :< 
            EventTimeZone = "en-us", 
            City = "Philadelphia", 
            ProvinceState = "Pennsylvania",
            Country = "United States of America"});
        _allEvents.Add(new BoringEvent
        {
            EventStartStr = "01/01/1970",
            EventTimeZone = "en-us",
            City = "New York",
            ProvinceState = "New York",
            Country = "United States of America"
        });
        IEnumerable<BoringEvent> sortedEvents = null;
        //sort by date
        Console.WriteLine("Sorting Events by Ascending date...");
        Expression<Func<BoringEvent, DateTime>> sortLamba = evt => HelperFunctions.strToTZDateTime(evt.EventStartStr, evt.EventTimeZone);
        sortedEvents = _allEvents.SortEvents(SortedBy.Ascending, sortLamba);
        Print(sortedEvents);
        //sort by country, then state, then city, then date
        Console.WriteLine("Sorting Events Desc by Country, then ProvinceState, then City, then Date");
        Expression<Func<BoringEvent, object>>[] sortLamba2 = new Expression<Func<BoringEvent, object>>[] 
        {
            evt => evt.Country,
            evt => evt.ProvinceState,
            evt => evt.City,
            evt => HelperFunctions.strToTZDateTime(evt.EventStartStr, evt.EventTimeZone)
        };
        sortedEvents = _allEvents.SortEvents(SortedBy.Descending, sortLamba2);   
        Print(sortedEvents);

        Console.Read();
    }

    private static void Print(IEnumerable<BoringEvent> events)
    {
        for(int i = 0; i < events.Count(); i++)
        {
            BoringEvent evt = events.ElementAt(i);
            Console.WriteLine("Event: {0}", i.ToString());
            Console.WriteLine("\tEventStartStr: {0}", evt.EventStartStr);
            Console.WriteLine("\tEventTimeZone: {0}", evt.EventTimeZone);
            Console.WriteLine("\tCity: {0}", evt.City);
            Console.WriteLine("\tProvinceState: {0}", evt.ProvinceState);
            Console.WriteLine("\tCountry: {0}", evt.Country);
        }
    }
}

internal static class EventExtensions
{

    public static IEnumerable<TResult> SortEvents<TResult, T>(
        this IEnumerable<TResult> events, 
        SortedBy sortByType,
        params Expression<Func<TResult, T>>[] expressions)
    {
        IEnumerable<TResult> retVal = null;
        switch(sortByType)
        {
            case SortedBy.Ascending:
                retVal = EventExtensions.SortEventsAsc(events, expressions);
                break;
            case SortedBy.Descending:
                retVal = EventExtensions.SortEventsDesc(events, expressions);
                break;
            default:
                throw new InvalidOperationException(
                    string.Format("The SortedBy enumeration does not contain a case for the value of '{0}'.", 
                    Enum.GetName(typeof(SortedBy), sortByType)));
        }
        return retVal;
    }

    public static IEnumerable<TResult> SortEventsAsc<TResult, T>(
        this IEnumerable<TResult> events, 
        params Expression<Func<TResult, T>>[] expressions)
    {
        IOrderedEnumerable<TResult> sorted = null;
        for(int i = 0; i < expressions.Count(); i++)
        {
            Expression<Func<TResult, T>> exp = 
                (Expression<Func<TResult, T>>)expressions[i];
            Func<TResult, T> deleg = exp.Compile();
            if(i == 0)
            {
                sorted = events.OrderBy(evt => deleg.Invoke(evt));
            }
            else
            {
                sorted = sorted.ThenBy(evt => deleg.Invoke(evt));
            }
        }
        return sorted;
    }

    public static IEnumerable<TResult> SortEventsDesc<TResult, T>(
        this IEnumerable<TResult> events,
        params Expression<Func<TResult, T>>[] expressions)
    {
        IOrderedEnumerable<TResult> sorted = null;
        for (int i = 0; i < expressions.Count(); i++)
        {
            Expression<Func<TResult, T>> exp = 
                (Expression<Func<TResult, T>>)expressions[i];
            Func<TResult, T> deleg = exp.Compile();
            if (i == 0)
            {
                sorted = events.OrderByDescending(evt => deleg.Invoke(evt));
            }
            else
            {
                sorted = sorted.ThenByDescending(evt => deleg.Invoke(evt));
            }
        }
        return sorted;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:24:35.597

我相信该`OrderBy`方法需要一个`Func<T1,T2>`参数，所以你可以这样做......

```
var func = x => HelperFunctions.strToTZDateTime(x.GetValue<string>("EventStartStr"), x.GetValue<string[]>("EventTimeZone")[0].ToString()); 
```

然后`func`传入`_allEvents = _allEvents.OrderBy(func);`

# wpf - 如何构建一个有 5 列和 10 行的网格

> ID：12428339
> 
> 赞同：1
> 
> 时间：2012-09-14T16:17:46.350
> 
> 标签：wpf, xaml

我有一个有 5 列和 10 行的网格，在每列中，单击任意数字时的值应该是 0-9，我必须获得单击单元格的值。建造这个的最好方法是什么？

![在此处输入图像描述](../Images/2a18906874d8dcb451fce40ca7efd54f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:36:05.380

有很多方法可以做到这一点，如果不了解更多的要求，很难说哪一个是最好的。

一种方法是将鼠标单击侦听器附加到 Grid，并在处理程序中计算单击了哪个单元格。

```
Grid grid = e.Source as Grid;
Point clickedPoint = e.GetPosition(Grid.RowProperty);
int rowClicked = (int)Math.Floor(clickedPoint.Y / grid.RowDefinitions.Count); 
```

这对性能有好处，因为只有一个事件侦听器——但您必须确保放置在 Grid 顶部的任何元素都允许点击事件冒泡（也就是说，如果它们实现了点击侦听器，它们应该使用`e.Handled = false`）。

* * *

另一种方法是，如果网格单元格中有 UI 元素，则将单击侦听器附加到网格中的每个元素，并用于`clickedElement.GetValue(Grid.RowProperty)`获取行号。

* * *

**编辑**您可以使用如下代码隐藏创建一个简单的 5x10 网格：

```
 const int columns=5, rows=10;
        for (int i = 0; i < columns; i++)
        {
            grid.ColumnDefinitions.Add(new ColumnDefinition());
            for (int j = 0; j < rows; j++)
            {
                if (i==0) grid.RowDefinitions.Add(new RowDefinition());
                var content = new TextBlock() { Text = j.ToString() };
                Grid.SetColumn(content, i);
                Grid.SetRow(content, j);
                grid.Children.Add(content);
            }
        } 
```

# java - java struts 全局异常处理

> ID：12428341
> 
> 赞同：0
> 
> 时间：2012-09-14T16:17:58.020
> 
> 标签：java, exception-handling, struts2

我正在尝试在 struts.xml 文件中实现全局异常处理。我的 struts.xml 文件是这样设置的：

```
<struts>
      <constant ..... />
           <include ......./>
</struts> 
```

我应该如何在这个文件中嵌套全局异常映射和全局结果元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:10:04.190

在[S2](http://struts.apache.org/2.3.3/docs/exception-handling.html)文档中，答案是：

```
<global-exception-mappings>
    <exception-mapping exception="org.apache.struts.register.exceptions.SecurityBreachException" result="securityerror" />
       <exception-mapping exception="java.lang.Exception" result="error" />
</global-exception-mappings>

<global-results>
        <result name="securityerror">/securityerror.jsp</result>
         <result name="error">/error.jsp</result>
</global-results> 
```

# c - 需要帮助在 Borland C++ 3.0 上分配远指针

> ID：12428345
> 
> 赞同：9
> 
> 时间：2012-09-14T16:18:33.617
> 
> 标签：c, memory, pointers, dos

我正在编写一个 DOS 游戏框架，以更好地学习 C 语言，并且对在旧硬件上编程（尤其是在我长大的系统上）产生普遍兴趣。

我正在尝试实现双缓冲系统，但在将远指针分配给 320*200 数组时遇到问题。

起初我尝试使用 malloc，但发现它只能分配 64kb 以下。我读到您需要使用farmalloc（malloc返回NULL）并且它分配正确。但是，当 _fmemset 或 _fmemcpy 运行时....整个系统冻结。

```
backBuffer = (unsigned char far*) farmalloc(64000); 
```

什么时候交换我使用的缓冲区

```
_fmemcpy(VGA, backBuffer, 64000); 
```

程序正在使用小内存模型。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-14T17:36:38.433

很有趣的帖子，我也很喜欢旧硬件。

*   **您是否尝试过在中型或大型模型中编译以检查代码是否正确运行？**

*   **您确定指向 VGA 显存的指针已正确初始化吗？**

我记得在那些日子里，使用内存副本来交换屏幕缓冲区非常缓慢，更不用说您必须等待垂直回溯期才能开始复制内存。（我有一个基本的 VGA 卡，所以也许你的硬件更好，延迟是可以接受的）。

如果您有兴趣，我强烈建议您阅读 Michael Abrash 的[Mode-X](http://www.phatcode.net/res/224/files/html/ch47/47-01.html#Heading1)专栏。

Mode-X 及其衍生物是由 Michael Abrash 首次记录的替代图形模式。基本上，它们是对 256 色 13H 模式的破解，您可以通过调整 VGA 卡中的一些寄存器来激活该模式。

一旦激活，有两个很大的优势：

1.  四页显存
2.  方形像素（在 320x240 的原始 ModeX 中），（绘制的圆圈看起来像一个圆圈，而不是椭圆）

**实现双甚至三缓冲区是轻而易举的事，因为您可以直接写入非活动缓冲区并激活它，只需更改 vga 卡中的寄存器，根本不需要 memcopy！**（还是需要等待垂直回扫，否则会出现难看的闪烁）

缺点是这种模式更难编程，基本上，模式-X 现在单个内存地址映射到四个连续像素，因此，单个像素写入实际上会一次更改四个像素。（这对于多边形填充程序来说是一个很好的加速！）。

如果要更改单个像素，则必须在绘制像素之前设置一个“像素掩码”（也是 VGA 卡寄存器），指定四个像素中的哪一个会受到内存写入的影响。

如果天真地完成，这会很慢，因为绘制的每个像素都需要设置掩码。通常我们直观地倾向于从左到右，从上到下（因为这正是视频内存在 VGA 模式 13H 上的映射方式），但我们 Mode-X 程序员了解到“旋转范例”要快得多，即，我们从上到下、从左到右绘制东西。

为什么？因为这允许我们为绘制的每一列只修改一次像素掩码！这是一些伪代码：

**天真、直观的编程**

```
pixelptr = start of screen memory
foreach row
   foreach column
      adjust pixel mask
      write pixel value
      pixelptr+= 1      // advance pointer to next pixel to the left
   next
next 
```

**轮换编程模式**

[Edit1：添加了必须将指针移动到下一列顶部的缺失步骤]

[Edit2：更正，我添加 320 以前进到下一行，实际上这应该除以 4，因为视频内存地址的连续增量将映射到前一个右侧的下一个四个像素组，四个-像素组]

```
for each column
   pixelptr = start of screen memory + current column index
   adjust pixel mask       // same mask applies to every pixel in the same column!
   for each row
      write pixel value
      pixelptr += (320 / 4)  // advance pointer to next pixel, to the bottom
   next
next 
```

所有涉及的步骤和注册地址在我提供的 Michael Abrash 专栏的链接中都有详细说明。这是古老的东西，但我打赌你会发现它很迷人！

干杯!

# c++ - 使用 InterlockedIncrement64 的引用计数对象的复制构造函数的原子性

> ID：12428349
> 
> 赞同：0
> 
> 时间：2012-09-14T16:18:44.853
> 
> 标签：c++, copy-constructor, atomic, interlocked-increment

我正在努力思考如何确保对象引用计数是线程安全的。

```
class MyObject{
  //Other implementation details
private:
  mutable volatile LONGLONG * m_count;
  IData * m_data;
}; 
```

假设有必要的类声明，只是保持简单。这里是拷贝构造函数和析构函数的实现。

```
MyObject::MyObject(const MyObject& rhs) : m_count(rhs.m_count), m_data(rhs.m_data){
    InterlockedIncrement64(m_count);
}

MyObject::~MyObject(){
    if(InterlockedDecrement64(m_count) == 0)
    delete m_data;
} 
```

这个线程安全吗？如何看到复制构造函数的 intilization 列表，原子与否？这还重要吗？我应该在初始化列表中设置计数的递增值（这可能吗）？

就目前而言，这已经足够好了。我认为它是，否则，我怎么能进入`thread1`复制和`thread2`同时销毁的场景`count == 1`。线程之间必须进行握手，这意味着 thread1 必须在 thread2 的对象超出范围之前完全复制对象，对吗？

在阅读了其中一些回复后，我回去做了一些研究。Boost 非常相似地实现了它们的 shared_ptr。这是析构函数调用。

```
void release() // nothrow
{
    if( BOOST_INTERLOCKED_DECREMENT( &use_count_ ) == 0 )
    {
        dispose();
        weak_release();
    }
} 
```

有些人建议在 boost 文档中明确指出分配不是线程安全的。我同意和不同意。我认为在我的情况下我不同意。我只需要threadA和threadB之间的握手。我认为某些回复中描述的某些问题在这里并不适用（尽管它们是我没有完全考虑过的令人大开眼界的回复）。

示例 ThreadA atach(SharedObject); //通过值传递的共享对象，计数递增等

ThreadB //接受对象，将其添加到共享对象列表中。ThreadB 位于一个计时器上，该计时器向所有 SharedObjects 通知一个事件。在通知之前，列表的副本由关键部分保护。CS被释放，副本被通知。

ThreadA 分离（SharedObject）；//从对象列表中删除共享对象

现在，同时 ThreadB 正在对 SharedOjbect 进行单选，并且在 ThreadA 分离所述共享对象之前已经制作了列表的副本。一切都好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:47:10.807

从技术上讲，它应该是安全的。

为什么？因为为了复制一个对象，源需要有一个“引用”，所以它不会在复制过程中消失。此外，没有人正在访问当前正在构建的对象。

析构函数也是安全的，因为无论如何都没有引用。

不过，您可能需要重新考虑复制引用计数。这些引用实际上并不存在。每个参考原件的人都必须以某种方式减少副本的引用计数，前提是它在复制之前获得了原始参考。副本应该像新对象一样开始，引用计数为 1。

编辑：同样，如果你正在实现一个赋值运算符（就像一个现有对象的副本），目标对象的引用计数应该保持原样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:02:18.603

构造函数不安全，因为初始化列表不是原子的（我在标准中没有找到对此的任何引用，但无论如何它都很难实现）。

因此，如果另一个线程将删除当前线程当前复制的对象-就在初始化列表执行和`InterlockedIncrement()`执行之间-您将收到损坏的（已删除的`m_data`）`m_data`和`m_count`. 这至少会导致`m_data`.

放置`InterlockedIncrement`到初始化器列表将无济于事，因为线程切换可能发生在 ctor 调用之后但在`m_count`初始化之前。

我不确定是否可以在没有外部锁（互斥锁或临界区）的情况下使其线程安全。您至少可以检查 ctor 中的计数器并在它为零时抛出异常/创建“无效”对象，但这不是好的设计，我不推荐它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T18:52:53.070

只要调用代码确保通过引用传递的对象在此函数执行期间不被破坏，则此代码是安全的。这对于任何需要引用的函数都是一样的，你必须非常努力才能不这样做。

析构函数是安全的，因为原子减量保证在一个且只有一个线程中为零。如果是，则必须是所有其他线程都已经完成了对该对象的使用并且已经调用了它自己的递减操作。

这假设您的联锁操作都有完整的障碍。

> 当count == 1时，我怎么能进入thread1正在复制而thread2同时销毁的场景。线程之间必须进行握手，这意味着thread1必须在thread2的对象超出范围之前完全复制对象正确？

你不能，只要每个线程都有自己对对象的引用。只要 thread1 对对象有自己的引用，就不能在 thread1 复制时销毁该对象。Thread1 不需要在 thread2 的引用消失之前复制，因为除非你有一个对它的引用，否则你永远不会触摸一个对象。

单个引用的线程安全性较弱，不应在不同线程中同时访问。如果两个线程想要访问同一个对象，它们都应该有自己的引用。将对象引用到其他代码（可能在另一个线程中）时，请遵循以下操作序列：

1.  有自己的参考。

2.  从您自己的参考中创建其他代码的参考。

3.  现在您可以销毁您的参考资料或放弃其他参考资料。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-14T20:21:02.657

您的复制构造函数不安全，也不能保证安全。

但是如果你从不使用 new/delete，你可以安全地使用你的类，而只使用自动创建和销毁的对象（按范围）。

# python - 如何使用 Python 检测鼠标侧键

> ID：12428351
> 
> 赞同：1
> 
> 时间：2012-09-14T16:18:54.523
> 
> 标签：python, pyhook

我一直在使用 pyhook 和`message`点击事件的属性，但它似乎只能检测到三个标准按钮。其他人甚至没有到达处理程序。

有没有办法检测鼠标可能有的额外按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:24:22.057

[从WH_MOUSE_LL](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644986%28v=vs.85%29.aspx)的文档中：

```
wParam [in]
Type: WPARAM 
```

鼠标消息的标识符。此参数可以是以下消息之一：WM_LBUTTONDOWN、WM_LBUTTONUP、WM_MOUSEMOVE、WM_MOUSEWHEEL、WM_MOUSEHWHEEL、WM_RBUTTONDOWN 或 WM_RBUTTONUP。

由于 pyhook 使用 WH_MOUSE_LL 钩子，它似乎仅限于这三个按钮。

按照[这个答案](https://stackoverflow.com/a/166144/1110381)，您可以使用 pywin32 并跟踪[WM_XBUTTONDOWN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646245%28v=vs.85%29.aspx)消息，据我了解，该消息应该被鼠标按钮 4 和 5 触发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-07T18:43:09.700

WH_MOUSE_LL 确实挂钩 XButtons 并且 PyHook 的 dll 将其传递给 python，但 python 端的 HookManager 忽略它们。但是，您可以跳过 HookManager，直接使用 cpyHook 接口。

此示例在按下鼠标左键时将 xbutton 事件打印到控制台，并在按下鼠标左键时退出：

```
from pyHook import cpyHook, HookConstants
import pythoncom
import ctypes
user32 = ctypes.windll.user32

XBUTTON1 = 0x0001
XBUTTON2 = 0x0002

wm = { 0x020B: "WM_XBUTTONDOWN", 0x020C: "WM_XBUTTONUP", 0x0201: "WM_LBUTTONDOWN", }

def mouse_handler(msg, x, y, data, flags, time, hwnd, window_name):
    name = wm.get(msg, None)
    if name:
        xb = data >> 16  # high word indicates which xbutton
        print(name, xb & XBUTTON1, xb & XBUTTON2)
        if name == "WM_LBUTTONDOWN":
            user32.PostQuitMessage(0)
    return True  # True = pass the event to other handlers

try:
    cpyHook.cSetHook(HookConstants.WH_MOUSE_LL, mouse_handler)
    pythoncom.PumpMessages() # returns on WM_QUIT
finally:
    cpyHook.cUnhook(HookConstants.WH_MOUSE_LL) 
```

# php - 需要将两个字段中的用户 ID 与另一个表中的名称匹配

> ID：12428354
> 
> 赞同：0
> 
> 时间：2012-09-14T16:19:07.783
> 
> 标签：php, join, matching, names

我正在为我的游戏服务器开发一些东西并制作自定义网站禁令。

我有一个禁止表（禁止时间、原因、禁止玩家、禁止管理员等） 禁止玩家和禁止管理员字段都使用存储在另一个表中的玩家 ID。

我知道如何加入表格，但我不知道如何区分被禁止的玩家和管理员，表格基本上是这样的：

信息表：

```
some info field| more info | more info| player_id | creator_id

info info      | info info | info info|         1 |          2
info info      | info info | info info|         3 |          2
info info      | info info | info info|         5 |          4 
```

球员表：

```
id  | name

1   | john
2   | steve
3   | sally
4   | bob
5   | jack 
```

玩家 id 是被封禁的玩家，创建者是管理员，所有名称，无论是管理员还是玩家，都存储在玩家表中。我想要的是有一个页面显示被禁止的玩家、被禁止的原因、禁止管理员和时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:22:04.893

您可以尝试：

```
SELECT
  info1,
  info2,
  p1.name AS player_name,
  p2.name AS admin_name
FROM more_infos mi
JOIN players p1 ON p1.id = mi.player_id
JOIN players p2 ON p2.id = mi.creator_id; 
```

# 请参阅带有演示的[Sql Fiddle 。](http://sqlfiddle.com/#!2/4e45e/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:28:18.430

您需要加入玩家表两次 - 一次用于被禁止的用户（玩家），一次用于禁止的创建者（管理员），如下所示：

```
SELECT info.*, player.name, admin.name
FROM info
JOIN players player ON player.id = info.player_id
JOIN players admin ON admin.id = info.creator_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:28:38.057

```
SELECT j1.name banned_player, j2.name admin
FROM info_table it
JOIN players j1 ON j1.id = it.player_id
JOIN players j2 ON j2.id = it.creator_id 
```

试一试。

# c# - AppHarbor pre-compilation error

> ID：12428357
> 
> 赞同：5
> 
> 时间：2012-09-14T16:19:10.777
> 
> 标签：c#, asp.net, appharbor

While deploying to AppHarbor, AppHarbor gave me the following compile output:

```
Microsoft (R) ASP.NET Compilation Tool version 4.0.30319.17929
Utility to precompile an ASP.NET application
Copyright (C) Microsoft Corporation. All rights reserved.

D:\temp\cprt3dr0.2g3\output\_PublishedWebsites\WebMatrixWebsite\gnsystem\gnsystem\web.config(24): error ASPCONFIG: It is an error to use a section registered as allowDefinition='MachineToApplication' beyond application level.  This error can be caused by a virtual directory not being configured as an application in IIS.

[ConfigurationErrorsException]: It is an error to use a section registered as allowDefinition='MachineToApplication' beyond application level.  This error can be caused by a virtual directory not being configured as an application in IIS. (D:\temp\cprt3dr0.2g3\output\_PublishedWebsites\WebMatrixWebsite\gnsystem\gnsystem\web.config line 24)
   at System.Configuration.ConfigurationSchemaErrors.ThrowIfErrors(Boolean ignoreLocal)
   at System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject)
   at System.Configuration.BaseConfigurationRecord.GetSection(String configKey)
   at System.Web.Configuration.RuntimeConfig.GetSectionObject(String sectionName)
   at System.Web.Configuration.RuntimeConfig.GetSection(String sectionName, Type type, ResultsIndex index)
   at System.Web.Configuration.RuntimeConfig.get_Compilation()
   at MTConfigUtil.GetCompilationConfig(String vpath)
   at System.Web.Compilation.WebDirectoryBatchCompiler..ctor(VirtualDirectory vdir)
   at System.Web.Compilation.BuildManager.BatchCompileWebDirectoryInternal(VirtualDirectory vdir, Boolean ignoreErrors)
   at System.Web.Compilation.BuildManager.BatchCompileWebDirectory(VirtualDirectory vdir, VirtualPath virtualDir, Boolean ignoreErrors)
   at System.Web.Compilation.BuildManager.PrecompileWebDirectoriesRecursive(VirtualDirectory vdir, Boolean topLevel)
   at System.Web.Compilation.BuildManager.PrecompileWebDirectoriesRecursive(VirtualDirectory vdir, Boolean topLevel)
   at System.Web.Compilation.BuildManager.PrecompileWebDirectoriesRecursive(VirtualDirectory vdir, Boolean topLevel)
   at System.Web.Compilation.BuildManager.PrecompileWebDirectoriesRecursive(VirtualDirectory vdir, Boolean topLevel)
   at System.Web.Compilation.BuildManager.PrecompileAppInternal(VirtualPath startingVirtualDir, IEnumerable`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManager.PrecompileApp(VirtualPath startingVirtualDir, IEnumerable`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManager.PrecompileApp(ClientBuildManagerCallback callback, IEnumerable`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManagerHost.PrecompileApp(ClientBuildManagerCallback callback, List`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManagerHost.PrecompileApp(ClientBuildManagerCallback callback, List`1 excludedVirtualPaths)
   at System.Web.Compilation.ClientBuildManager.PrecompileApplication(ClientBuildManagerCallback callback, Boolean forceCleanBuild)
   at System.Web.Compilation.ClientBuildManager.PrecompileApplication(ClientBuildManagerCallback callback)
   at System.Web.Compilation.Precompiler.Main(String[] args)

Website precompilation failed with exit code 1\. Precompilation can optionally be disabled in application settings 
```

After searching in the internet, I found a few solutions pointing me over to clean my solution and to configure my app folder as a virtual folder within IIS.

I did the first (and it didn't work) but I have no idea how to do the second from within AppHarbor, any suggestions?

**Edit1**: [Web.Config](https://gist.github.com/3739343)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T15:47:29.663

您可以在应用程序设置中禁用视图预编译。这应该可以让你摆脱这个问题。

但是我建议你检查你的代码，因为最终在使用时，会再次抛出这个异常，我推荐一些像[elmha](http://nuget.org/packages/elmah)这样的跟踪器来帮助你详细找到问题。您的 webconfig 错误在那里是钢铁般的

# ruby - Recursively drilling down the Nokogiri Tree

> ID：12428360
> 
> 赞同：2
> 
> 时间：2012-09-14T16:19:24.070
> 
> 标签：ruby, nokogiri, drilldown

I want to drill down the tree, and store all the levels:

```
search_q = Regex.new("Some search regex here")
#something like: page.search('body').first.children.select {|x| x.text[search_q]}.first.children.select {|x| x.text[search_q]}.first......ad infinitum. 
```

I've done a hack:

```
arbitrarily_long_number = 100
drill = []
(0..arbitrarily_long_number).collect do |n|
  begin
    drill << eval("page.search('body')"+".first.children.select {|x| x.text[search_q]}" * n)
  rescue
    break
  end
end 
```

The problem is that this drills only through the "first" selection. Is there a way to make it drill through every node? I'm thinking of some sort of inject function, but I still haven't wrapped my head around it. Any help would be appreciated.

Output:

```
pp drill[-4]
puts
pp drill[-3]
puts
pp drill[-2]
#=>[#(Element:0x3fc2324522b4 {
   name = "u",
   children = [
     #(Element:0x3fc232060b60 {
       name = "span",
       attributes = [
         #(Attr:0x3fc2320603e0 {
           name = "style",
           value = "font-size: large;"
           })],
       children = [ #(Text "Ingredients:")]
       })]
   })]

[#(Element:0x3fc232060b60 {
   name = "span",
   attributes = [
     #(Attr:0x3fc2320603e0 { name = "style", value = "font-size: large;" })],
   children = [ #(Text "Ingredients:")]
   })]

[#(Text "Ingredients:")] 
```

Notes: I'm using the mechanize gem, which leverages off of Nokogiri. [http://mechanize.rubyforge.org/Mechanize/Page.html#method-i-search](http://mechanize.rubyforge.org/Mechanize/Page.html#method-i-search) http://nokogiri.org/Nokogiri/XML/Node.html#method-i-search

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T00:25:08.160

对我来说，这听起来像你想要遍历：

```
doc.traverse do |node|
  drill << node
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:38:45.697

你的问题不清楚。

如果，通过

> 我想向下钻取树，并存储所有级别：

你的意思是你想遍历所有节点，告诉 Nokogiri 这样做。

```
require 'nokogiri'

doc = Nokogiri::XML(<<EOT)
<a>
  <b>
    <c>1</c>
  </b>
</a>
EOT

doc.search('*').each do |n|
  puts n.name
end 
```

将其粘贴到 IRB 并获取输出：

```
irb(main):011:0* doc.search('*').each do |n|
irb(main):012:1*   puts n.name
irb(main):013:1> end
a
b
c 
```

我使用了 XML，而您使用的是 HTML，但这无关紧要。您必须更改`doc`以`page`适应 Mechanize 的方式，但这很容易。

# html - 如何使用 chrome 检查 CSS 元素？

> ID：12428364
> 
> 赞同：6
> 
> 时间：2012-09-14T16:19:31.183
> 
> 标签：html, css, google-chrome-devtools

我想弄清楚如何使用 Chrome 检查元素。现在我知道如何检查元素，但如何检查按钮的功能，例如*悬停*和*活动*。

我正在尝试检查页面左上角的 Youtube 登录按钮。我得到了悬停属性，但是如何检查链接和活动状态属性？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-14T16:23:02.710

当您检查元素时，在样式选项卡中，有一个“切换元素状态”按钮。单击它以应用各种伪状态：

![](../Images/edf6330db16181d543437034359cf716.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T16:20:27.987

只需右键单击页面上的任意位置，然后从菜单中选择“检查元素”。Chrome 有一个用于调试的图形工具（就像在 Firebug 中一样），因此您可以调试 JavaScript 或查看 CSS（您甚至可以临时更改 CSS）

有关详细信息，请参阅[https://developers.google.com/chrome-developer-tools/](https://developers.google.com/chrome-developer-tools/)

# android - Application has unfortunately has stopped error

> ID：12428365
> 
> 赞同：0
> 
> 时间：2012-09-14T16:19:43.477
> 
> 标签：android, forceclose

Application has unfortunately has stopped error. I am new to android and i am using eclipse. I am getting this error when had a back button on the app. I have kept the button named back (All the buttons are distinguished with unique id)in many pages but all the back buttons must redirect to the same page and there i am getting the error. Please provide me a solution.

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" 
android:background="@drawable/memo">

 <Button
    android:id="@+id/btnm1"
    android:layout_centerInParent="true"
    android:layout_marginTop="70dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
      android:textSize="45dp"
    android:layout_alignParentTop="true"
    android:text="Create memo" />

<Button
    android:id="@+id/btnm2"
            android:layout_centerInParent="true"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/btnm1"
    android:text="Edit memo" 
      android:textSize="45dp"/>

     <Button
    android:id="@+id/btnm3"
            android:layout_centerInParent="true"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/btnm2"
    android:text="Delete memo" 
      android:textSize="45dp"/>

  <TextView
    android:id="@+id/tvm1"
    android:textColor="#C73F17"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:text="Memo"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textSize="50dp" />

    <Button
    android:id="@+id/backmemo"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/tvm1"
    android:layout_below="@+id/btnm3"
    android:layout_marginLeft="24dp"
    android:layout_marginTop="56dp"
    android:text="Back" />

 </RelativeLayout> 
```

//JAVA CODE

```
package dlp.android.digichronicle;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity  implements View.OnClickListener{
     Button         btn1,btn2,btn21,btn22,btn23,btn24,btn25,btnm1,btnm2,btnm3,btntk1,btntk2,btntk3,btnrm1,btnrm 2,btnrm3;
Button btne1,btne2,btne3,backmemo,backtask,backremind,backevent;
TextView tv1,tv31;  

      @Override
     public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      FirstPage();
        }

     public void FirstPage(){
    setContentView(R.layout.activity_main);
    btn1=(Button)findViewById(R.id.btn1);
    btn1.setOnClickListener(this);
    btn2=(Button)findViewById(R.id.btn2);
    btn2.setOnClickListener(this);

      dia();//dialogue box  
     }

     public void ThirdPage(){

      }

         public void dia(){
    Context context = MainActivity.this;
      AlertDialog.Builder ad = new AlertDialog.Builder(context);
      ad.setTitle("EVENT");
      ad.setMessage("Event goes here");
      ad.setPositiveButton("Done",
      new OnClickListener() {
      public void onClick(DialogInterface dialog,
      int arg1) { }
      });
      ad.setCancelable(true);
      ad.show();

        }
          public void onClick(View v){

    if(v==btn1)
        SecondPg();         
        if(v==btn2)
        {

         }
        if(v==btn21)
        {
            memo();

         }
        if(v==btn22)
        {
            task();

         }
        if(v==btn23)
        {
            event();

         }
        if(v==btn24)
        {
            reminder();
         }
        if(v==btn25)
        {
            //ThirdPage();
         }
        if(v==backmemo)
        {
            //SecondPg();
         }
        if(v==backtask)
        {
            //SecondPg();
         }
        if(v==backremind)
        {
            //SecondPg();
         }
        if(v==backevent)
        {
            SecondPg();
         }
            }
         public void SecondPg(){
  setContentView(R.layout.second);

  tv1=(TextView)findViewById(R.id.tv1);
  btn21=(Button)findViewById(R.id.btn21);
btn21.setOnClickListener(this);
btn22=(Button)findViewById(R.id.btn22);
btn22.setOnClickListener(this);
btn23=(Button)findViewById(R.id.btn23);
btn23.setOnClickListener(this);
btn24=(Button)findViewById(R.id.btn24);
btn24.setOnClickListener(this);
btn25=(Button)findViewById(R.id.btn25);
btn25.setOnClickListener(this);
//    back_tas=(Button)findViewById(R.id.back_tas);
    //  back_tas.setOnClickListener(this);
        backevent=(Button)findViewById(R.id.backevent);
        backevent.setOnClickListener(this);
        //back_mem=(Button)findViewById(R.id.back_mem);
        //back_mem.setOnClickListener(this);
        //back_rem=(Button)findViewById(R.id.back_rem);
        //back_rem.setOnClickListener(this);

}    

        public void memo(){
setContentView(R.layout.memo);
btnm1=(Button)findViewById(R.id.btnm1);
btnm1.setOnClickListener(this);
btnm2=(Button)findViewById(R.id.btnm2);
btnm2.setOnClickListener(this);
btnm3=(Button)findViewById(R.id.btnm3);
btnm3.setOnClickListener(this);

     }
        public void task(){
setContentView(R.layout.tasks);
btntk1=(Button)findViewById(R.id.btntk1);
btntk1.setOnClickListener(this);
btntk2=(Button)findViewById(R.id.btntk2);
btntk2.setOnClickListener(this);
btntk3=(Button)findViewById(R.id.btntk3);
btntk3.setOnClickListener(this);

      }
        public void reminder(){
setContentView(R.layout.reminder);
btnrm1=(Button)findViewById(R.id.btnrm1);
btnrm1.setOnClickListener(this);
btnrm2=(Button)findViewById(R.id.btnrm2);
btnrm2.setOnClickListener(this);
btnrm3=(Button)findViewById(R.id.btnrm3);
btnrm3.setOnClickListener(this);

      }
        public void event(){
setContentView(R.layout.events);
btne1=(Button)findViewById(R.id.btne1);
btne1.setOnClickListener(this);
btne2=(Button)findViewById(R.id.btne2);
btne2.setOnClickListener(this);
btne3=(Button)findViewById(R.id.btne3);
btne3.setOnClickListener(this);

        }
            @Override
        public boolean onCreateOptionsMenu(Menu menu) {
      getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
         }
        } 
```

## Here is the log cat

```
09-14 21:35:07.086: W/dalvikvm(708): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
   09-14 21:35:07.107: E/AndroidRuntime(708): FATAL EXCEPTION: main
     09-14 21:35:07.107: E/AndroidRuntime(708): java.lang.NullPointerException
    09-14 21:35:07.107: E/AndroidRuntime(708):  at  dlp.android.digichronicle.MainActivity.SecondPg(MainActivity.java:121)
     09-14 21:35:07.107: E/AndroidRuntime(708):     at dlp.android.digichronicle.MainActivity.onClick(MainActivity.java:59)
        09-14 21:35:07.107: E/AndroidRuntime(708):  at android.view.View.performClick(View.java:3511)
       09-14 21:35:07.107: E/AndroidRuntime(708):   at android.view.View$PerformClick.run(View.java:14105)
    09-14 21:35:07.107: E/AndroidRuntime(708):  at android.os.Handler.handleCallback(Handler.java:605)
     09-14 21:35:07.107: E/AndroidRuntime(708):     at              android.os.Handler.dispatchMessage(Handler.java:92)
      09-14 21:35:07.107: E/AndroidRuntime(708):    at android.os.Looper.loop(Looper.java:137)
     09-14 21:35:07.107: E/AndroidRuntime(708):     at android.app.ActivityThread.main(ActivityThread.java:4424)
        09-14 21:35:07.107: E/AndroidRuntime(708):  at java.lang.reflect.Method.invokeNative(Native Method)
          09-14 21:35:07.107: E/AndroidRuntime(708):    at java.lang.reflect.Method.invoke(Method.java:511)
      09-14 21:35:07.107: E/AndroidRuntime(708):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
      09-14 21:35:07.107: E/AndroidRuntime(708):    at              com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
       09-14 21:35:07.107: E/AndroidRuntime(708):   at dalvik.system.NativeStart.main(Native             Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T20:21:22.693

我现在可以告诉你，你的实际问题是你`setContentView`
在你的主要活动中做了两次，这是行不通的，因为你不能`setContentView`在同一个活动中调用两次。

```
public void SecondPg(){
    setContentView(R.layout.second); 
```

在 android 中，您不能在这样的页面之间切换，您实际上需要另一个将被调用并使用第二个布局的活动！空指针是因为它找不到该`R.id`按钮，因为它在您设置的第一个内容视图上不存在。阅读教程：[Android Intents - 教程](http://www.vogella.com/articles/AndroidIntent/article.html)

也看看这个关于如何使用意图的问题：[Best way to display multiple setContentView in Android](https://stackoverflow.com/questions/5048867/best-way-to-display-multiple-setcontentview-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:43:40.577

单击 logcat 中 Null Pointer Exception 错误下方的两行以访问代码中的错误行。有关更多信息，请查看此内容。 [什么是 NullPointerException，我该如何解决？](https://stackoverflow.com/questions/218384/what-is-a-null-pointer-exception)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:29:30.360

**阅读您的堆栈跟踪！**它清楚地列出了潜伏在 MainActivity.java 第 121 行中的 Null Pointer Exception 的罪魁祸首，这是在 MainActivity.java 第 59 行中处理单击的结果。

**编辑：**看起来你尝试了`findViewById()`，`R.id.tv1`但你的布局没有这样的元素。但是它使用`R.id.tvm1`。而且您似乎习惯于在布局（或此复制和粘贴代码）之间共享您的神秘 ID，因此其他一些布局使用`R.id.tv1`，因此没有编译器错误。

# javascript - having problems returning a string in a javascript function

> ID：12428366
> 
> 赞同：0
> 
> 时间：2012-09-14T16:19:44.507
> 
> 标签：javascript, string, function, return

I having trouble returning the string in this function. For starters I'm a beginner who just started learn javascript a week ago, sorry in advance if I word things wrong. I was told to declare a variable named timeStr to equal the value returned from the showDate() function as well as mapNum to the getMap() function. Both the showDateTime() and getMap() function are in a file that I'm accessing called datetime.js. I would just like some input on where I made the mistake and how to correct it, thanks.

```
<script src="datetime.js" type="text/javascript"></script>
<script type="text/javascript">
function test(){
/*
   timeStr is a text string containing the current date and time
   mapNum is the number of the map to display in the planisphere
/*
var timeStr = showDateTime();
var mapNum = getMap();
}
</script> 
```

UPDATE: The datetime.js is below:

```
/*
   New Perspectives on JavaScript, 2nd Edition
   Tutorial 1
   Case Problem 1

   Function List:
   showDate
      Used to return a text string containing the current date and time.
   getMap
      Used to the determine the current sky map number to display with the online        planisphere

*/

function showDateTime() {
   var thisDate = new Date();
   var thisWDay=thisDate.getDay();
   var thisDay=thisDate.getDate();
   var thisMonth=thisDate.getMonth();
   var thisYear=thisDate.getFullYear();
   var mName = new Array("January", "February", "March", "April", "May", 
       "June", "July", "August", "September", "October","November", "December");
   var hours=thisDate.getHours();
   var minutes=thisDate.getMinutes();
   ampm = hours >=12 ? " pm" : " am";
   hours = hours > 12 ? hours-12 : hours;
   minutes = minutes < 10 ? "0"+minutes : minutes;
   return mName[thisMonth]+" "+thisDay+", "+thisYear + ", " + hours + ":" + minutes + ampm;
}

function getMap() {
   thisTime = new Date();
   hour = thisTime.getHours();
   month = thisTime.getMonth();
   mapNumber = (month*2+hour)%24;
   return mapNumber;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:21:19.213

You've commented everything out.

Change

```
/*
   timeStr is a text string containing the current date and time
   mapNum is the number of the map to display in the planisphere
/* 
```

to

```
/*
   timeStr is a text string containing the current date and time
   mapNum is the number of the map to display in the planisphere
*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:21:45.423

As you can probably see by the syntax highlighting, you haven't terminated your comment correctly.

`/*` begins a multi-line comment and `*/` ends it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:21:47.570

Your comment should end with `*/` and not `/*` If you look at the syntax highlighting in your question you can see it's all greyed out.

# java - MVC - 视图可以观察对象吗？

> ID：12428371
> 
> 赞同：2
> 
> 时间：2012-09-14T16:20:16.417
> 
> 标签：java, model-view-controller, observable

我试图在使用 Observable 和 Observer 时更好地理解 MVC 结构，我试图通过实现一个比较文件的程序来做到这一点。我希望我的视图显示文件列表和一些统计数据。如何使用不同的数据更新视图？

例如，如果统计信息发生变化，我想将 Statistics 对象发送到视图，以便它可以更新它的显示。但同时，如果文件列表发生变化，我想将 ArrayList 发送到视图，以便它可以更新它的显示。我是否对两者使用相同的更新方法？如果是这样，那么我是否让我的视图查看 instanceof 是什么并相应地显示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:33:44.433

Swing 框架是 MVC 如何工作的一个很好的例子。每个状态更改都会触发一种事件，并且想要了解这些更改的对象实现侦听器（又名观察者）。

因此，总而言之，您应该创建一个名为 StatisticsListener 的接口，如下所示：

```
public interface StatisticsListener {
     public void statisticsChanged(StatisticsEvent evt);
} 
```

使用事件 StatisticsEvent：

```
public class StatisticsEvent {
    private final Statistics changedStatistics;

    public StatisticsEvent(Statistics changedStatistics){
         this.changedStatistics = changedStatistics;
    }

    public Statistics getChangedStatistics(){
         return this.changedStatistics;
    }
} 
```

...在您处理统计信息的课程中，您触发事件：

```
public class ClassThatHandlesStatistics {
    private final List<StatisticsListener> listeners = new CopyOnWriteArrayList<StatisticsListener>();

    public void doSomething(){
         Statistics changed ... //do your logic
         fireStatisticsChanged(new StatisticsEvent(changed));
    }

    protected void fireStatisticsChanged(StatisticsEvent evt){
        for (StatisticsListener listener : listeners){
             listener.statisticsChanged(evt);
        }
    }
} 
```

像这样的东西;-)

# objective-c - NSObject init 方法有什么作用吗？

> ID：12428372
> 
> 赞同：5
> 
> 时间：2012-09-14T16:20:16.723
> 
> 标签：objective-c, initialization, nsobject

`self = [super init];`在继承 NSObject 时编写自定义初始化方法是否有意义？我知道在子类化任何其他类时这是必要的，因为它可能具有自定义初始化，但是 NSObject init 方法有什么作用吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T16:23:06.313

对象在初始化之前还不能使用。`init`类中定义的方法`NSObject`没有初始化；它只是返回自我。

所以基本上你不一定要调用`[super init]`子`NSObject`类，但我仍然会推荐它。这只是一个更好的设计。如果您更改超类，它仍然可以工作。

来源：[NSObject 类参考](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/init)。

# visual-studio-2010 - Changing TFS Admin Account Password

> ID：12428373
> 
> 赞同：1
> 
> 时间：2012-09-14T16:20:22.547
> 
> 标签：visual-studio-2010

I have been asked to change the password of our TFS Admin account. This is NOT one of the accounts that runs any of the services. This is the account that has admin level privelages in TFS and can do anything in TFS.

Is there anything I should be aware of when doing this? Are there any negative side effects or concerns to watch out for?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:22:55.593

不，如果这不是服务帐户，应该不会有任何问题。

# c# - 关于改进以下XslCompiledTransform类使用的思考

> ID：12428375
> 
> 赞同：0
> 
> 时间：2012-09-14T16:20:28.327
> 
> 标签：c#, xml, xslt

我非常感谢对以下实施的投入。目标是：生成一个 XElement，尽可能避免文件系统读/写。

```
private XElement ProduceApiXml(KeyValuePair<string, ConfigScriptOutput> kvp)
{
    XElement returnValue = null;
    // load xsl file
    XslCompiledTransform ct = new XslCompiledTransform();
    string xslFile = Path.Combine(_assemblyDir, ConfigurationManager.AppSettings["ConfigOutputXslFile"]);
    ct.Load(xslFile);
    XmlReader xmlToTransform = XmlReader.Create(new StringReader(kvp.Value.ScriptStdOut));
    StringBuilder sb = new StringBuilder();
    StringWriter sw = new StringWriter(sb);
    XmlWriter xmlTransformed = new XmlTextWriter(sw);
    ct.Transform(xmlToTransform, xmlTransformed);

    returnValue = XElement.Parse(sb.ToString());
    return returnValue;
} 
```

这是我第一次使用这个 XslCompiledTransform 类，我想我可以改进它。我真正关心的是我是否应该使用除 StringBuilder -> StringWriter -> XmlWriter 构造之外的东西来到达我想去的地方？似乎有很多对象是为了完成手头的任务而构建的——这确实有效。现在，工作赢了，但我想让它变得更好。

我真的很感谢那些有经验的人对我在这里所做的事情进行建设性的评论。代码审查，如果你愿意？

在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:34:04.710

如果要填充 XElement，请使用

```
XDocument result = new XDocument();
using (XmlWriter xw = result.CreateWriter())
{
  ct.Transform(xmlToTransform, xw);
}
returnValue = result.Root; 
```

无需使用 StringWriter 也无需使用旧版 XmlTextWriter，转换可以直接填充 XContainer。

我还将 XmlReader 和 StringReader 的使用包装到`using`块中。

# firefox - 继续访问此网站（不推荐） Firefox 上的错误

> ID：12428376
> 
> 赞同：1
> 
> 时间：2012-09-14T16:20:34.693
> 
> 标签：firefox, ssl, browser, ssl-certificate

我最近购买了一个带有 256 位加密的 comodo ssl 证书，作为我朋友的建议，他在他的服务器中使用该证书，并按照 google exc 的说明将其安装到我的服务器上。

之后，我将所有带有 http 的链接更改为 https，这解决了 Chrome、IE 和 Safari 中继续访问此网站（不推荐）的问题。

然而，虽然在我的 Firefox 中看起来还不错，但我注意到在我朋友的 Firefox 浏览器中，问题仍然存在，如果他们不选择 OK，所有的 css 文件 exc 都消失了（我认为这是因为没有加载css 文件 exc 因为浏览器认为它很危险）无论如何，但他们的 chrome、safari 和 ie 一切都很好。

在那之后，我用 browsershots.org 检查了所有的 firefox 版本，它也没有向我显示任何错误或继续到这个网站错误除外。

之后，我问过我的托管服务提供商为什么会发生这种情况，他们回答说这是一个正常的过程，等待 10-15 天就可以了。但我不确定他们说的是不是真的。

PS：我什至认为这对任何浏览器都不是问题，但是Firefox可以认为看到那里的http，这可能是原因吗？

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

如果你能帮我解决这个问题，我会很高兴

谢谢

完整留言：

" 本网站的安全证书有问题。本网站提供的安全证书不是由受信任的证书颁发机构颁发的。

安全证书问题可能表明试图欺骗您或拦截您发送到服务器的数据。我们建议您关闭此网页，不要继续访问此网站。"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T20:54:12.370

> 本网站的安全证书有问题。本网站提供的安全证书并非由受信任的证书颁发机构颁发。
> 
> 安全证书问题可能表明试图欺骗您或拦截您发送到服务器的数据。我们建议您关闭此网页，不要继续访问此网站。

这与不良链接或混合内容无关，而是与证书本身有关。

您可以使用[Qualys SSL Labs 的 SSL 测试](https://www.ssllabs.com/ssltest/)来测试您的网站，这通常比其他的更全面。

假设您安装的证书确实是正确的（您可以在“添加例外...”和“查看...”中检查以查看证书详细信息，它们确实是您在证书中看到的） ，我想到了几个可能的原因：

*   浏览器无法识别您使用的 CA。这不太可能，因为 Comodo 很常见。
*   您在服务器上安装的证书链顺序不正确和/或没有所有中间 CA 证书（如果有）。
*   这个特定的浏览器使用另一个证书访问了一个具有此名称的站点，并提出了一个特定的例外。这可能与基于 CA 的验证相冲突。以防万一，进入选项 -> 高级 -> 查看证书 -> 服务器，并检查服务器是否不在列表中。（您还可以检查您使用的 CA 是否在“权威”列表中，但很可能是。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:25:13.907

1.  CSS 项目等是如何在 HTML 中编码的？它是指向 CSS 的完全路径链接还是无域？

    ```
    <link rel="stylesheet" type="text/css" href="http://cdn.sstatic.net/stackoverflow/all.css?v=2dd53f4bb112"> 
    ```

    以上是带有协议的完全域CSS，即定义了HTTP

    ```
    <link rel="stylesheet" type="text/css" href="/all.css?v=2dd53f4bb112"> 
    ```

    如果域保持一致，则与上述相同。

2.  检查您和您朋友的 Firefox 版本。它可能是一个过时的 Firefox，它不支持您朋友浏览器上的最新 SSL（关于应该告诉您版本信息的帮助）。

    尝试更新他以匹配您的，然后重试。

# mysql - 依靠多个连接表

> ID：12428380
> 
> 赞同：3
> 
> 时间：2012-09-14T16:20:56.847
> 
> 标签：mysql, sql, database

我有以下表格：

```
Players
- id
- name

Games
- id
- game_type_id
- season_id

Goals
- player_id
- game_id

Assists
- player_id
- game_id 
```

我一直在努力尝试构建一个查询/视图，该查询/视图将为我提供每个赛季和游戏类型的球员目标和助攻数。对于每个球员来说，重要的是要针对每个赛季和比赛类型列出，无论他们是否有进球/助攻。

该查询将用于创建视图。可以在一个查询中完成吗？

更新：这是一个带有一些生产示例数据的[SQL Fiddle 。](http://sqlfiddle.com/#!2/8312c)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:37:35.173

```
SELECT
  players.id,
  players.name,
  games.season_id,
  games.game_type_id,
  SUM(COALESCE(assists.rows, 0))             AS assists,
  SUM(COALESCE(goals.rows,   0))             AS goals
FROM
  players
CROSS JOIN
  games
LEFT JOIN
  (SELECT game_id, player_id, COUNT(*) AS rows FROM assists GROUP BY game_id, player_id) AS assists
    ON assists.game_id = games.game_id
LEFT JOIN
  (SELECT game_id, player_id, COUNT(*) AS rows FROM goals   GROUP BY game_id, player_id) AS assists
    ON goals.game_id   = games.game_id
GROUP BY
  players.id,
  players.name,
  games.season_id,
  games.game_type_id 
```

但是如果你有一张`Seasons`桌子和一张`GameType`桌子，它可能会提高性能。

```
SELECT
  players.id,
  players.name,
  seasons.id,
  game_types.id,
  SUM(COALESCE(assists.rows, 0))             AS assists,
  SUM(COALESCE(goals.rows,   0))             AS goals
FROM
  players
CROSS JOIN
  seasons
CROSS JOIN
  game_types
LEFT JOIN
  games
    ON  games.season_id = seasons.id
    AND games.game_type = game_types.id
LEFT JOIN
  (SELECT game_id, player_id, COUNT(*) AS rows FROM assists GROUP BY game_id, player_id) AS assists
    ON assists.game_id = games.game_id
LEFT JOIN
  (SELECT game_id, player_id, COUNT(*) AS rows FROM goals   GROUP BY game_id, player_id) AS assists
    ON goals.game_id   = games.game_id
GROUP BY
  players.id,
  players.name,
  seasons.id,
  game_types.id 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T16:57:32.933

**更新**

```
SELECT
    players.id,
    players.name,
    games.season_id,
    games.game_type_id,
    sum(CASE WHEN g.goals IS NULL THEN 0 ELSE g.goals END) AS goals,
    sum(CASE WHEN a.assists IS NULL THEN 0 ELSE a.assists END) AS assists
FROM players
CROSS JOIN games
LEFT JOIN (
  SELECT
    game_id, player_id,
    count(*) AS goals
  FROM goals
  GROUP BY
    game_id, player_id
) g ON
    g.player_id = players.id
    AND g.game_id = games.id
LEFT JOIN (
  SELECT
    game_id, player_id,
    count(*) AS assists
  FROM assists
  GROUP BY
    game_id, player_id
) a ON
    a.player_id = players.id
    AND a.game_id = games.id
GROUP BY
    players.id,
    players.name,
    games.season_id,
    games.game_type_id 
```

这不是很短的版本，但现在应该是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T19:51:50.990

试试这个：

```
select p.id,
  p.name,
  gm.season_id,
  gm.game_type_id,
  sum(gl.goalcount),
  sum(a.AssistCount)
from players p
left join
(
  select game_id, player_id, count(*) GoalCount
  from goals
  group by game_id, player_id
) gl
  on p.id = gl.player_id
left join
(
  select game_id, player_id, count(*) AssistCount
  from assists
  group by game_id, player_id
) a
  on p.id = a.player_id
left join games gm
  on gl.game_id = gm.id
  and a.game_id = gm.id
where season_id is not null
group by p.id,
  p.name,
  gm.season_id,
  gm.game_type_id 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/8312c/34)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T18:07:57.670

太棒了，我没有想到交叉连接，我想出了：

从玩家中选择 player.id、games.game_type_id、games.season_id、gc、ac

left join (select count(id) as c, player_id, game_id from goal group by player_id, game_id) as g on g.player_id = player.id

left join (select count(id) as c, player_id, game_id from assistants group by player_id, game_id) as a on a.player_id = player.id

右加入games.id = g.game_id和games.id = a.game_id上​​的游戏按players.id、games.game_type_id、games.season_id分组；

# intellij-idea - 有没有办法以编程方式闯入 IntelliJ 调试器？

> ID：12428382
> 
> 赞同：1
> 
> 时间：2012-09-14T16:20:59.280
> 
> 标签：intellij-idea

我通过“运行”按钮运行我的 java 应用程序，而不是“调试”。

但是，如果满足某些条件，我想闯入调试器。

我不想通过“调试”按钮使用条件断点运行它，因为这个特定的条件断点将被测试数千次，大大降低了整体执行速度。

我可以有一个带有断点的 if 语句，但是，我注意到“调试”配置通常比“运行”配置慢得多。

本质上，我正在寻找`Debugger.Launch()`.NET 的等价物。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:44:19.140

在**运行**模式下，JVM 在没有调试选项的情况下启动，并且不接受来自调试器的连接，因此无法强制调试未在**调试**模式下启动的 JVM。

可以选择使用**远程调试。****只有在需要时，您才可以使用远程调试**配置连接到 VM 。但是当所有的断点都被静音时，它应该与本地调试配置没有什么不同。当您想调试时，只需取消静音断点。至于性能，[请查看相应的FAQ](http://devnet.jetbrains.net/docs/DOC-23)。

# css - 在 compass config.rb 中指定单个 scss 文件

> ID：12428383
> 
> 赞同：6
> 
> 时间：2012-09-14T16:20:59.103
> 
> 标签：css, sass, compass-sass, web-deployment, gruntjs

我正在开发一个 HTML5 应用程序的部署过程。我正在使用指南针和 SCSS 进行样式设置，并且我的项目目录的根目录中有一个 config.rb 来配置指南针。我有一个 app.scss 文件，顶部有一些导入，以便以正确的顺序导入其他文件。

```
@import "definitions";
@import "common";

// global stuff
@import "modal";

// tabs
@import "login";
@import "summary";
@import "profile";
// etc..... 
```

虽然我无法在 config.rb 中指定 app.scss 文件，但它只有一个**sass_dir**选项，它会导致 compass 尝试编译每个文件。这会中断，例如，login.scss 不会导入 definitions.scss 并且如果引用了那里的变量则会中断。app.scss 需要是唯一编译的文件，因为只有它知道所有其他文件

这可能吗？我也无法指定命令行参数，因为最终这一切都将通过 grunt 和 grunt-compass 插件完成，所以我需要一切都在 config.rb

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-14T16:25:14.687

不是100％确定这是问题..但是..

我假设您在编译时正在查看目录。如果是这样，您不想编译的文件应以下划线开头。

例如...

**_myFile.scss**

# java - Java - 从同一个包中获取文件

> ID：12428394
> 
> 赞同：13
> 
> 时间：2012-09-14T16:21:56.907
> 
> 标签：java, file, package

如果我想从与班级同一个包中的“Words.txt”中读取，我该怎么做？这样做只会`Scanner = new Scanner(new File("Words.txt"));`返回错误。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-14T16:25:21.823

```
InputStream is = MyClass.class.getResourceAsStream("Words.txt");
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T16:24:49.367

`.class`假设文本文件与, 而不是`.java`你可以做的文件在同一目录中

```
Scanner scanner = new Scanner(getClass().getResourceAsStream("Words.txt")); 
```

您所拥有的将在当前工作目录中查找该文件。在构建程序时，这通常是程序的根目录。当您将它作为独立程序运行时，它通常是程序启动的目录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T16:26:10.850

```
Scanner = new Scanner(new File("/path/to/Words.txt")); 
```

File() 构造函数中的参数，是相对于运行 VM 的系统的路径，它不依赖于类的包。

如果您的 words.txt 是与您的战争一起打包的资源，您可以在这里看到：[从类路径中的任何位置加载资源](https://stackoverflow.com/questions/3294196/load-resource-from-anywhere-in-classpath)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T16:28:29.240

```
Scanner scanner = new Scanner(getClass().getResourceAsInputStream("Words.txt"));

String s = new String();

while(scanner.hasNextLine()){

        s = s + scanner.nextLine();

 } 
```

# javascript - Android vs Iphone vs Safari/Chrome/FF 上的像素舍入

> ID：12428401
> 
> 赞同：3
> 
> 时间：2012-09-14T16:22:30.660
> 
> 标签：javascript, android, css, rendering

我正在为客户开发一个移动网站，但我的幻灯片方法存在问题，如下所示：

*   一个 100% 宽度的包装容器，溢出：隐藏，位置：相对

*   此容器内的 ul 宽度为 (#children*100)%, position:relative

*   宽度为 (100/#li)% 的可变数量的 lis，向左浮动，每个包含宽度为：100% 的图像

*   对于每次迭代，ul 的 'left' 属性减少 100%

这种方法在桌面浏览器和移动 safari 上效果很好，但是 android 浏览器对浮动百分比的处理很差，渲染它们不正确。我无法确定，但似乎当我将 100/6 = 16.66666667% 的宽度应用于 li 时，它被渲染为 16%，即使当我通过 javascript 查询该元素的宽度时它返回正常的截断16.6667% 宽度。结果是，随着幻灯片的每次迭代，图像变得越来越偏向左侧，因为它们没有在包装容器中占据正确的空间量。

有趣的是，当我将元素的数量减少到一个可以整除 100 的数字时，比如 100/5 = 20%，这个问题就完全消失了。

我已经查看了有关像素舍入的先前线程，但我认为这不是问题所在。据我所知，当像素的计算有余数并且浏览器必须将结果四舍五入到最近的像素时，就会发生像素舍入，这似乎是浏览器不了解小数百分比的问题。

有没有其他人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:11:08.050

许多浏览器不能正确处理百分比的小数：

[http://www.sitepoint.com/forums/showthread.php?547308-CSS-percentage-width-roundoff](http://www.sitepoint.com/forums/showthread.php?547308-CSS-percentage-width-roundoff)

# c# - ReSharper 中是否有一个选项可以不将对象初始化程序放在多行上？

> ID：12428402
> 
> 赞同：10
> 
> 时间：2012-09-14T16:22:34.270
> 
> 标签：c#, resharper

每次我输入一个对象初始值设定项作为参数时，如下所示：

```
SomeFunc(new { Id = id }) 
```

然后输入分号，ReSharper 会按照配置格式化我刚刚输入的内容。但是，我在 ReSharper 中找不到一个选项来使它不会将我的代码变成这样：

```
SomeFunc(new {
  Id = id
}); 
```

我确实确认它实际上是 ReSharper 进行格式化。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-16T10:30:21.210

如果您想阻止 ReSharper 格式化您的对象初始化程序（这样您就可以自己决定如何格式化它们），我认为这些设置的组合将完成这项工作。

`Keep existing line breaks`：`[Checked]`

`Place simple array, object and collection on single line`：`[Checked]`

`Wrap object and collection initializer`：`'Simple wrap'`

`Wrap long lines`：`[Unchecked]`

当然，这些设置可能并不适合每个人的情况，但我相信您可以根据自己的需要进行调整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T19:07:12.773

看起来您需要在部分中设置`Wrap object and collection initializer`选项。`Chop if long``Code Editing -> C# -> Formatting Style -> Line Breaks and Wrapping`

# android - 让 SOAP Web 服务与 REST API 交互？

> ID：12428403
> 
> 赞同：0
> 
> 时间：2012-09-14T16:22:48.283
> 
> 标签：android, web-services, rest, soap, google-api

我只是在学习什么是 Web 服务以及如何使用它，如果这是一个愚蠢的问题，请耐心等待。

我正在制作一个 Android 应用程序，并将尝试使用服务帐户在[Google Play Android Developer API (REST)](https://developers.google.com/android-publisher/getting_started)和[我的 Web 服务 (SOAP)](http://iphone.e-imo.com/IMOTPWS.asmx?op=Search)之间进行服务器到服务器交互。这是一个问题吗？我需要知道什么才能开始使用这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:27:35.683

一般来说，SOAP 和 REST 就像中文和英文一样。他们是如此的不同，他们之间无法相互交谈，而无需在他们之间进行翻译。虽然他们都可以做 XML，但它根本不一样。

# ruby-on-rails - 在 ActiveRecord 中创建外键约束

> ID：12428414
> 
> 赞同：14
> 
> 时间：2012-09-14T16:24:08.450
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, foreign-keys, ruby-on-rails-3.2

如何在 ActiveRecord 中创建外键？我的模型中有以下内容：

```
class Student < ActiveRecord::Base
  attr_accessible :name, :level_id
  belongs_to :level
end

class Level < ActiveRecord::Base
  attr_accessible :number
  has_many :students
end 
```

但是 schema.rb 和开发 sqlite3 数据库没有任何迹象表明外键约束是使用 level_id 字段设置的。除了 ActiveRecord 或 Rails 之外，这是我必须手动执行的操作吗？我错过了一步吗？

使用 Rails 3.2.8

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-14T16:41:43.840

您不需要 ActiveRecord 的外键约束来正确映射关系。您可以使用[验证](http://guides.rubyonrails.org/active_record_validations_callbacks.html#validations-overview)让 Rails 应用程序确保数据完整性。

Rails 迁移不提供创建外键的助手。您可以为迁移中的约束创建自己的 SQL 或使用[Foreigner Gem](https://github.com/matthuhiggins/foreigner)。Foreigner 将提供帮助方法来在迁移中创建约束：

```
add_foreign_key(:students, :levels) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-01-02T21:51:13.447

如果您有 rails >= 4.2 并使用`mysql`、`mysql2`或`postgresql`适配器，那么您可以`add_foreign_key`在迁移中使用该方法，如下所示：

```
# add a foreign key to `articles.author_id` referencing `authors.id`
add_foreign_key :articles, :authors 
```

[API 参考](http://edgeapi.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-add_foreign_key)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-10T18:55:07.023

这是内置在 Rails 中的，你不需要 Foreigner。请参阅此处的第 3.6 节外键：http: [//edgeguides.rubyonrails.org/active_record_migrations.html](http://edgeguides.rubyonrails.org/active_record_migrations.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-14T16:43:14.230

在模型中添加`belong_to`和`has_many`行使 Rails 知道它们之间的关系并生成辅助方法，但不会在数据库级别创建 FK。为此，您需要创建并运行迁移：

```
rails g migration add_level_id_to_students level_id:integer 
```

然后 rake db:migrate

如果要生成带有外键部分的模型，可以使用`references`快捷方式： `rails g model Student name:string level:references`

查看[Rails 指南](http://guides.rubyonrails.org/migrations.html)以获取更多信息！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-10T20:20:33.540

```
 $ rails generate migration AddStudentRefToLevels student:references 
```

这应该是这样的

```
class AddStudentRefToLevels < ActiveRecord::Migration
  def change
    add_reference :levels, :student, index: true
  end
end 
```

取自这里[http://guides.rubyonrails.org/migrations.html#creating-a-migration](http://guides.rubyonrails.org/migrations.html#creating-a-migration)

# mysql - phpmyadmin 优化表读取超时

> ID：12428415
> 
> 赞同：0
> 
> 时间：2012-09-14T16:24:13.847
> 
> 标签：mysql, optimization, phpmyadmin

一张表有 15000 行，**空间使用情况**如下：

```
Type     |   Usage
Data     |   437.4 KiB
Index    |   157.0 KiB
Overhead |   7,000 B (this is in red)
Effective|   587.6 KiB
Total    |   594.4 KiB 
```

当我单击**优化表**时，它会在大约 10 分钟后显示读取超时。有什么想法可以摆脱这种困境吗？

```
ERROR

The requested URL could not be retrieved

The following error was encountered while trying to retrieve the URL: Myaddress/phpmyadmin/sql.php?

Read Timeout

The system returned: [No Error]

A Timeout occurred while waiting to read data from the network. The network or server may be down or congested. Please retry your request. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:48:15.570

我必须做的不是使用像 PHPMYADMIN 这样的 Web 界面，而是我必须下载**MySQL Workbench**并在查询中使用这些命令行：

```
use databasename;
check table tablename;
repair table tablename;
optimize table tablename;

CTRL+SHIFT+ENTER 
```

# jqgrid - 我可以在 navGrid 部分的哪个位置调整添加对话框的宽度

> ID：12428419
> 
> 赞同：1
> 
> 时间：2012-09-14T16:24:23.710
> 
> 标签：jqgrid

我的 jqGrid navGrid 部分有以下内容：

```
$("#loginList").jqGrid('navGrid', "#pager", { edit: false, add: true, del: false },
    {},{}       
); 
```

我不确定我会在哪里为添加对话框的宽度设置一个值。我试过：

```
$("#loginList").jqGrid('navGrid', "#pager", {width: 300},  { edit: false, add: true, del: false },
    {},{}       
); 
```

但这并没有解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:43:35.603

我相信你的参数可能有问题。定义导航网格时，[参数](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3anavigator#how_to_use)如下：

```
jQuery("#grid_id").jqGrid('navGrid','#gridpager',{parameters},prmEdit, prmAdd, prmDel, prmSearch, prmView); 
```

由于您要为“添加”对话框指定参数，因此您需要将宽度选项定义为`prmAdd`参数的一部分。

```
jQuery("#grid_id").jqGrid('navGrid','#gridpager',{parameters},prmEdit, { width: 300 }, prmDel, prmSearch, prmView); 
```

# jmeter - 尝试解码参数值 JMeter 中的 % 字符失败并出现 IllegalArgumentException: URLDecoder: Illegal hex characters in escape(%) 模式

> ID：12428421
> 
> 赞同：1
> 
> 时间：2012-09-14T16:24:36.310
> 
> 标签：jmeter, urlencode, percent-encoding

使用 Apache JMeter 2.7，我的 POST 请求的消息正文 (JSON) 包含一个密码字段，格式为`asdf%xy3dsfsfsf`. JMeter 试图解释`%xy`为百分比编码字符并抛出此异常。

> 未捕获的异常 java.lang.IllegalArgumentException：URLDecoder：转义（％）模式中的非法十六进制字符 - 对于输入字符串：“xy”。有关详细信息，请参阅日志文件。

我无法使用反斜杠转义该字符，`asdf\%xy3dsfsfsf`因为它会作为错误密码进入 Web 服务。

请就如何解决此问题提出建议。

更新：该问题在构建 2578 中得到解决。 [https://builds.apache.org/job/JMeter-trunk/2578/](https://builds.apache.org/job/JMeter-trunk/2578/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T09:12:16.907

您可以尝试检查参数选项卡中参数上的编码复选框，因为您的值包含特殊字符**%**。

来自关于**使用请求发送参数的**参考：

*   [http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Request](http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Request)

> 此外，您可以指定每个参数是否应进行 URL 编码。如果您不确定这意味着什么，最好选择它。如果您的值包含 & 或空格或问号等字符，则通常需要编码。

也可以看看：

*   [http://www.blooberry.com/indexdot/html/topics/urlencoding.htm#whatwhy](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm#whatwhy)

最后，您能否确认在查看结果树中单击 HTTP 请求时出现异常，我已经提出了一个错误来改进此行为，该问题已得到修复：

*   [https://issues.apache.org/bugzilla/show_bug.cgi?id=53874](https://issues.apache.org/bugzilla/show_bug.cgi?id=53874)

也许您可以尝试现在可用的夜间构建并提供一些反馈，请参阅此处的使用说明：

*   [http://jmeter.apache.org/nightly.html](http://jmeter.apache.org/nightly.html)

问候

菲利普·M。

# visual-studio-2010 - 我将如何使用 LINQ 执行以下逻辑

> ID：12428422
> 
> 赞同：0
> 
> 时间：2012-09-14T16:24:40.443
> 
> 标签：visual-studio-2010, linq, c#-4.0, lambda, logic

我有一个包含日期时间项目列表的对象。我有另一个具有属性的列表

我想选择对象中的列表中的日期时间项目，前提是它与另一个列表中的项目之一匹配。我能够得到这些项目，但我不知道如何基本上写“如果当前项目与此列表中的任何项目匹配”。

到目前为止的 LINQ 就像

```
from item in ObjectWithList.DateList
from compareItem in OtherDateTimeList
where item = //Here is there I run into trouble, how would I loop through the compareitems? 
```

谢谢

**编辑** 我需要在此 LINQ 中完成此操作，因为这只是整个 LINQ 的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:28:28.470

```
ObjectWithList.DateList.Intersect(OtherDateTimeList) 
```

**编辑**

如果必须是 Linq 查询，并且您不想使用 Intersect，请尝试以下操作：

```
var mix = from f in ObjectWithList.DateList
          join s in OtherDateTimeList on f equals s
          select f; 
```

或者

```
var mix = from f in ObjectWithList.DateList
          from s in OtherDateTimeList 
          where f == s
          select f; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:28:44.493

您可以使用[Intersect](http://msdn.microsoft.com/en-us/library/bb460136.aspx)标准查询运算符：

```
var items = ObjectWithList.DateList.Intersect(OtherDateTimeList) 
```

# c++ - 使用 DLL 函数时的访问冲突异常

> ID：12428423
> 
> 赞同：0
> 
> 时间：2012-09-14T16:24:45.147
> 
> 标签：c++, dll

作为 C++ 练习的一部分，我创建了一个简单的 DLL，但在调用 DLL 函数时出现访问冲突异常。这是DLL的头文件（我怀疑CPP在这里有用）：

```
#pragma once

namespace MathFuncs
{
class MyMathFuncs
{
public:
    // Returns a + b
    static __declspec(dllexport) double Add(double a, double b);

    // Returns a - b
    static __declspec(dllexport) double Subtract(double a, double b);

    // Returns a * b
    static __declspec(dllexport) double Multiply(double a, double b);

    // Returns a / b
    // Throws DivideByZeroException if b is 0
    static __declspec(dllexport) double Divide(double a, double b);
};
} 
```

这是我的主要内容：

```
#include <iostream>
#include "windows.h"

using namespace std;

int main(void)
{
    double (__cdecl *MYPROC)(double,double);
    /* get handle to dll */
    HINSTANCE hGetProcIDDLL = LoadLibrary("DLLExample.dll"); 
if(hGetProcIDDLL == NULL)
    throw;
   /* get pointer to the function in the dll*/
    FARPROC lpfnGetProcessID = GetProcAddress(hGetProcIDDLL,"Add"); 
    if(lpfnGetProcessID)
        throw;
    MYPROC = (double (__cdecl *)(double,double))lpfnGetProcessID;
    if(MYPROC)
        throw;

    double x = MYPROC(5.5,5);

    return 0;
} 
```

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:43:05.363

你的问题出在这里：

```
FARPROC lpfnGetProcessID = GetProcAddress(hGetProcIDDLL,"Add"); 
if(lpfnGetProcessID)  // <-- error!
    throw;
MYPROC = (double (__cdecl *)(double,double))lpfnGetProcessID;
if(MYPROC)  // <-- error!
    throw;

double x = MYPROC(5.5,5); 
```

如果`lpfnGetProcessId`有地址，则抛出异常。如果没有，您稍后会尝试调用它（繁荣！）。

你会想要装饰你的函数，`extern "C"`以确保它们被导出为用户友好的名称。这意味着他们不能在一个类中：

```
namespace MathFuncs
{
   extern "C" __declspec(dllexport) double Add(double, double);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T16:33:11.563

如果没有 DLL 的代码，只能推测，并且您选择的命名似乎在中途发生了变化，但看起来您正在执行以下操作：

1）加载dll并在失败时抛出异常......好的。2）在dll中找到一个似乎将两个值相加的函数——但是如果成功了，你会抛出异常吗？由于您没有抛出异常，因此返回了 NULL，因此您无法找到该函数。3）调用函数——它是NULL，所以你会在这里失败。

我怀疑问题在于您没有考虑 C++ 名称修饰。您可以在对 GetProcAddress() 的调用中更改函数名称以正确解释它，或者您可以声明该函数`extern "C"`以删除重整。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T16:28:48.663

您确定该方法`MathFuncs::MyMathFuncs::Add()`实际上是作为简单的“添加”导出的，就像在您的`GetProcAddress`调用中一样？

我怀疑涉及某种形式的 C++ 名称*修改*。

您可能希望从命令行使用**DUMPBIN /EXPORTS**来查看实际导出的方法名称。

*此外，如果*返回值`GetProcAddress`不是（请参阅您的测试），则该函数成功：您为什么？ *`NULL``if``throw`*

 *另请注意，如果您调整类头文件以在导出和导入中都使用它，则使用 DLL 会更简单，例如

```
#if defined(MATHFUNCS_EXPORT) // Inside DLL implementation
#define MATHFUNCS_API __declspec(dllexport)
#else   // Outside DLL
#define MATHFUNCS_API __declspec(dllimport)
#endif  // MATHFUNCS_EXPORT

class MyMathFuncs
{
public:

  static MATHFUNCS_API double Add(double a, double b);
  ...
}; 
```

这样，客户端可以只`#include`使用您的头文件（并与相应的 .lib 文件链接），而无需使用`LoadLibrary`/ `GetProcAddress`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-03T13:57:10.180

我认为[使用 DLL 函数时的访问冲突异常](https://stackoverflow.com/questions/12428423/access-violation-exception-when-using-a-dll-function/12428696#12428696)是正确的答案，但它有点难以解释 - 我看到的问题是：

1.  检查是向后的 - 如果我们未能获得函数指针，我们继续，并且只有在我们成功获得函数指针时才抛出。

2.  成员函数应该可以很好地导出，因为函数是静态的，但我们无法获得函数指针，因为 DLL 没有导出名为“Add”的函数 - 实际名称将被破坏，可以在 .map 文件中找到，如果生成。

3.  由于我们没有找到函数指针，因此我们将 NULL 转换为函数指针类型并尝试调用它，所以这就是我们遇到访问冲突的地方。

代码应该是：

```
FARPROC lpfnGetProcessID = GetProcAddress(hGetProcIDDLL,"**MangledAddFunctionName - see .map file**");
if(lpfnGetProcessID == NULL)
    throw;
MYPROC = (double (__cdecl *)(double,double))lpfnGetProcessID;
if(MYPROC == NULL)
    throw;

double x = MYPROC(5.5,5); 
```*

# css - 防止滚动条显示在元素顶部

> ID：12428429
> 
> 赞同：0
> 
> 时间：2012-09-14T16:25:06.653
> 
> 标签：css, scroll, overflow

我有一个设置为滚动的元素和它上面的一些图层。滚动条显示了可滚动元素前面的所有元素。

它看起来像这样：

![滚动条出现在顶部](../Images/b0b8eabd9287fc1575dc908fac7e467e.png)

这是在使用 Chrome 21.0.1180.89 的 Mac OSX Mountain Lion 上。有什么我可以做的，或者这是 Mac 滚动的“功能”吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:46:50.173

在没有看到您的代码的情况下，我的第一反应是设置

```
overflow: hidden; 
```

在你的容器上。

# jquery - Jquery 触摸滑动事件/没有 jQuery mobile

> ID：12428433
> 
> 赞同：4
> 
> 时间：2012-09-14T16:25:17.090
> 
> 标签：jquery, swipe, jquery-events, touch-event, hammer.js

我一直在寻找一个好的 jQuery 库，它允许我将触摸事件附加到 DOM 元素，尤其是滑动/点击。

我试过hammer.js，在文档中它告诉它有滑动效果，但是当我尝试附加它时`$('.element').on('swipe', function(){ //do smth });`它不起作用。

我可以通过使用它的 'dragend' 事件来模拟滑动，但不好的是，有时它有效，有时无效。

为了更具体地了解我想要实现的目标 - 检查您手机上的 twitter 网站，并尝试在您的时间线/提要中向左/向右滑动一条推文，它应该会显示一些用于“回复”/“转推”/“的操作按钮最喜欢的'。

谁能给我一个代码示例或一个库，其中包含有关如何实现此目的的良好文档？

PS：我不能在这个项目上使用 jQuery mobile。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:37:36.923

我无法为您提供图书馆帮助，但我可以复制/粘贴用于使用 JQuery 进行滑动的内容。此示例仅适用于上下滑动，但很容易适应其他手势。

这是插件部分：

```
;(function($) { 
  $.fn.tactile = function(swipe) {
    return this.each(function() {
      var $this = $(document),
      isTouching = false,
      debut;                                // means start in french

      $this.on('touchstart', debutGeste);       

      function debutGeste() {               // means start of gesture
        if (event.touches.length == 1) {
          debut = event.touches[0].pageY;
          isTouching = true;
          $this.on('touchmove', geste);
        }
      }

      function finGeste() {                 // means end of gesture
        $this.off('touchmove');
        isTouching = false;
        debut = null;
      } 

      function geste() {                   // geste means gesture
        if(isTouching) {
          var actuel = event.touches[0].pageY,
          delta = debut - actuel;

          if (Math.abs(delta) >= 30) {     // this '30' is the length of the swipe
            if (delta > 0) {
              swipe.up();
            } else {
              swipe.down();
            }                       
            finGeste();
          }
        }
        event.preventDefault(); 
      }
    });
  };
})(jQuery); 
```

这是使用部分：

```
$(document).tactile({   
  up: function() { }, 
  down: function() { }
}); 
```

我不能保证这是正确的方法，这也不是好的代码，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:34:34.700

你不能使用 jQuery 手机？可以使用煎茶触摸吗？[http://dev.sencha.com/deploy/touch/examples/production/kitchensink/#demo/touchevents](http://dev.sencha.com/deploy/touch/examples/production/kitchensink/#demo/touchevents)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-18T21:49:56.073

如果您使用的是 Hammer.js 的 jQuery 版本，那不应该是：

$('.element').hammer().on('swipe', function(){ //do smth });

我认为您需要 Hammer 对象来处理 jQuery 特定事件。根据我的阅读，Hammer 不会将它们作为普通的自定义 jQuery 事件注入。

# asp.net - IIS 7 多站点绑定：浏览器打开到错误的位置

> ID：12428434
> 
> 赞同：0
> 
> 时间：2012-09-14T16:25:20.123
> 
> 标签：asp.net, binding, iis-7, a-records, multiple-sites

我有一个托管两个站点的 2008 R2 IIS 服务器。一个网站在浏览时可以正常工作。它默认为 wwwroot。任何浏览 www.example.com 或 example.com 的人都会转到该站点的正确页面。一切正常。

第二个站点应该默认为 asp.net 应用程序所在的子文件夹 wwwroot\update。任何浏览 update.example.com 的人都应该访问此站点。绑定不起作用。它使用 wwwroot 中的默认文档和配置文件，而不是 wwwroot\update 下的那些。为什么？

我已验证站点 1 指向 C:\inetpub\wwwroot，其他指向 C:\inetpub\wwwroot\update。第二个站点甚至将 wwwroot 视为存在的东西是没有任何意义的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:28:08.517

我认为您需要在 IIS 中设置一个新站点，而不是添加`update.example.com`到绑定中。这将允许您将 update.example.com 绑定指向服务器上的单独目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:05:50.360

您是否将相同的端口和 IP 地址绑定到两个站点？如果是这样，您应该为每个站点添加一个主机标头。www.example.com 到第一个，update.example.com 到第二个。这仅在它们是 http 站点时才有效。

# regex - 为什么我在 Windows 中运行的 perl 程序在我的 mac 上的山狮中无法运行？

> ID：12428436
> 
> 赞同：2
> 
> 时间：2012-09-14T16:25:32.503
> 
> 标签：regex, windows, macos, perl

我编写了一个读取一些数据的 perl 程序（数据是包含由下划线分隔的字母数字字符的名称，例如 SDF_233），我在使用时读取了该数据

```
use strict;
use warnings;
use LWP::Simple;

my $file = "names.txt";
open(DATA,$file);
my @lines=<DATA>;
close DATA;

foreach my $line (@lines) {
my $name = $line; 
my $otherdata;  ...some more code...

print $name . "," . $otherdata;} 
```

我打印`$name`以便可以将其用作参考，以在与原始列表进行比较时仔细检查程序是否已遍历每个名​​称。

问：这适用于 windows - 我在我的 Mac 上尝试过同样的事情，但它不起作用。我没有得到 的输出`$name`，但`$otherdata`确实打印了 - 这是为什么呢？下划线与此有关吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:54:36.427

你的代码肯定有`chomp`你没有显示的。如果是这样，问题是您的数据文件是为 Windows 格式化的。具体来说，它的行以 CR LF 终止。在 Windows 上，它会自动更改为 LF，稍后您可以使用`chomp`. 在您的 Mac 上，不会发生这种转换，因此您将 CR 留在后面。您的代码输出

```
name\r,otherdata 
```

您的终端显示为

```
,otherdata 
```

解决方案是修复您的输入文件

```
dos2unix names.txt 
```

或改变

```
while (my $line = <DATA>) {
   chomp($line);
   ...
} 
```

到

```
while (my $line = <DATA>) {
   $line =~ s/\s+\z//;
   ...
} 
```

PS - 你不应该使用一个名为 DATA 的句柄。Perl 已经创建了一个命名的，所以它是混乱的。

PS -`s/[\r\n]+\z//`如果您处于必须保留尾随空格的奇怪情况，请使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:29:53.550

像所有其他人一样，我假设您遇到了行尾问题。如果这是我的脚本，我会诊断它的方式是……</p>

```
use strict;
use warnings;
use LWP::Simple;
use Data::Dumper; # My favorite debugging tool

my $file = "names.txt";
open(DATA,$file);
my @lines=<DATA>;
close DATA;
print Dumper(\@lines);

foreach my $line (@lines) {
    my $name = chomp $line; 
    print Dumper(\$name, \$line);
    my $otherdata;  

    #...some more code...

    print Dumper(\$otherdata);
    print $name . "," . $otherdata;
} 
```

# asp.net - 在尝试保存在 cookie 中之前，哪些信息应该被视为关键信息？

> ID：12428438
> 
> 赞同：0
> 
> 时间：2012-09-14T16:25:45.047
> 
> 标签：asp.net, .net, cookies, browser

在我的站点中，我使用基于 cookie 的身份验证系统，在该系统中，我将用户名和密码等登录凭据保存在浏览器 cookie 中。这是一个不好的做法吗？如果是这样，这怎么会对安全构成威胁？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:32:28.737

这绝对是一个不好的做法。您永远不应将敏感信息保存在 cookie 中。此信息可以在用户的​​机器上以纯文本形式访问，并且可以更改并发送回带有错误数据的应用程序。您应该始终将其存储在服务器上，无论是在会话变量中，还是永久存储在数据库中。

您应该避免任何对您的应用程序正常运行敏感或关键的事情。您可以存储一些内容以改善用户体验，例如布局、颜色、上次查看的页面等。您还可以存储用户名以提供“记住我”类型的登录，只要您通过密码在提交时进行身份验证。

# node.js - 在 async.auto (NodeJs) 中绑定 Mongoose 模型保存方法

> ID：12428439
> 
> 赞同：3
> 
> 时间：2012-09-14T16:25:54.287
> 
> 标签：node.js, asynchronous, coffeescript, mongoose

现在我正在使用 mongoose 3.1.1 和 async 0.1.22。但是，当我尝试将 Mongoose 模型实例保存在`async.auto`其中时，它就停止了工作。

请参阅以下示例并自行尝试：

```
mongoose = require 'mongoose'
async = require 'async'
Schema = mongoose.Schema
ObjectId = Schema.ObjectId

mongoose.connect "mongodb://localhost:27017/async-test"

SmthSchema = new Schema
  data : type: String

mongoose.model 'Smth', SmthSchema
Smth = mongoose.model 'Smth'

test1 = (next) ->
  console.log '  test 1'
  smth = new Smth data: 'some data'

  async.auto
    first: (callback) ->
      smth.save callback
    second: ['first', (callback) ->
      console.log '  it works!'
      callback()]
    next

test2 = (next) ->
  console.log '  test 2'
  smth = new Smth data: 'some data'

  async.series [
    smth.save.bind smth
    (callback) ->
      console.log '  it works!'
      callback()
  ], next

test3 = (next) ->
  console.log '  test 3'
  context =
    save: (callback) -> callback null

  async.auto
    first: context.save.bind context
    second: ['first', (callback) ->
      console.log '  it works!'
      callback()]
    next

test4 = (next) ->
  console.log '  test 4'
  smth = new Smth data: 'some data'

  async.auto
    first: smth.save.bind smth
    second: ['first', (callback) ->
      console.log '  it works!'
      callback()]
    next

console.log 'running all tests'
async.series [test1, test2, test3, test4], (err) ->
  console.log err || 'all works!' 
```

结果输出：

```
running all tests
  test 1
  it works!
  test 2
  it works!
  test 3
  it works!
  test 4 
```

`smth.save.bind smth`将保存函数绑定到它要保存的对象。`async.series`它在and中效果很好`async.parallel`，但在`async.auto`.

`async.auto`将对象保存到数据库，但它会丢失回调并且处理停止。但是有人知道**为什么会这样吗？**

最奇怪的是，我从来没有遇到过任何问题，无论是在内部绑定任何东西，`async.auto`还是在任何其他上下文中绑定`Mongoose`保存方法。

我已经查看了`async`代码，但我仍然不知道出了什么问题。现在我打算在github上写一个关于它的问题。

**添加了 20.09.12：**我用`save`函数替换了`validate`函数，一切都很好：

```
running all tests
  test 1
  it works!
  test 2
  it works!
  test 3
  it works!
  test 4
  it works!
all works! 
```

`save`所以这个问题与猫鼬功能密切相关。

`async.auto`当它与 Mongoose 方法一起使用时，它看起来像是在某处中断`save`。但我不明白在哪里以及为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T03:58:58.310

## 编辑

想通了：如果你使用@dpatti 的分支，它就可以工作。我猜@caolan 还没有合并它（已经 6 个月左右）。我在我们的 Node.js 框架[Sails](http://sailsjs.com)中使用异步，所以我会密切关注这个，所以如果它被合并，我会在这里发布。

### 解决方案

在您的 package.json 中，将您的异步依赖项更改为如下所示：

```
"async": "git://github.com/dpatti/async.git#safe-auto" 
```

然后做一个`npm install`，你应该很高兴。

* * *

与 Sequelize 的 save() 组合时遇到同样的问题。我认为这是一个函数上下文问题——希望对您有所帮助！

我正在研究一个中断的基本示例，当我有更多信息时我会报告。如果看起来它实际上是异步中的问题，我将在 github 中提出问题并在此处链接到它。

我也在 async 0.1.22（和 Sequelize 1.5.0-beta-2，以防万一）使用原始 javascript（不喝咖啡）

# outlook - iCal 订阅的 Outlook 刷新间隔 (webcal://)

> ID：12428445
> 
> 赞同：15
> 
> 时间：2012-09-14T16:26:19.990
> 
> 标签：outlook, icalendar, webcal

当 Outlook 2007 和 2010 订阅 Internet 日历（通过`webcal://`指向 iCalendar 或 vCalendar 文件的链接）时，它们多久自动更新一次？有没有办法在下载的文件或 Outlook 首选项中进行配置？我知道该文件可以指定最小刷新间隔（通过该`X-PUBLISHED-TTL`字段），但我没有看到明确指定推荐间隔的方法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-09-30T18:45:33.347

对于 Outlook 2013，如果您点击发送/接收，也会同步日历。要调整该间隔，请转到“文件”>“选项”>“高级”，然后向下滚动以查找“发送/接收”。在那里可以找到调整自动发送/接收间隔的选项。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-17T08:00:42.883

Outlook 依靠自定义属性 X-PUBLISHED-TTL 来设置下载频率，但除非在您订阅的文件中设置，否则无法在 Outlook 中强制更新频率（也无法在谷歌日历中）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-07-19T05:24:05.470

随着许多日历被集成到云中，这些设置（X-PUBLISHED-TTL 和 REFRESH-INTERVAL）**不再适用**于 Google 日历和许多较新版本的 Outlook。我自己测试过这个。

如果您考虑一下，Google 和 Outlook 可能会故意忽略任何指定的刷新率以防止 DNS 攻击。基本上，由于系统中有数百万个集成日历，有些人可以每秒设置一次刷新率，如果他们遵守这些设置，可能会导致服务器崩溃。因此，他们很可能会随时刷新。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-05-04T13:39:28.653

我有 Outlook 2017。在“发送/接收”下，您可以选择“发送/接收组”，然后为 Internet 日历定义一个具有唯一同步时间的新组。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-28T04:29:39.437

（我 2014 年 3 月的回答不再有效。）

要诱使 Outlook 刷新 Internet 日历，请转到

文件:: 帐户设置:: 帐户设置（按钮）:: 互联网日历（选项卡）

然后选择您要刷新的日历，单击“更改...”，在说明中添加一个空格（或删除一个空格），然后单击“确定”。

您的日历现在应该已刷新。

# c++ - Linux C++ 将 Boost 编译到我的程序中

> ID：12428455
> 
> 赞同：1
> 
> 时间：2012-09-14T16:27:10.007
> 
> 标签：c++, gcc, boost

我环顾了谷歌和 StackOverflow，但似乎无法提出正确的问题来获得有用的答案。

我有一个在 Ubuntu 10.04 上编译的应用程序和 Boost::serialization 库中的链接。当我试图在另一台机器上运行我的代码时，它不会运行说它找不到 Boost 库......

如何更改我的 gcc/g++ 编译参数以告诉编译器在我的可执行文件中包含 Boost 库？也就是说，我如何编译以获得完全可传输的程序？

如果这样做，是否需要更改 C++ 中的任何内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T12:35:09.083

所以我的同事找到了这个页面：[http ://ubuntuforums.org/showthread.php?t=491455](http://ubuntuforums.org/showthread.php?t=491455)

从中，他发现我们必须使用这些标志：-Wl,-Bstatic -lboost_serialization -Wl,-Bdynamic

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:32:27.197

您确定您使用静态链接来编译您的应用程序吗？

# jquery - 可扩展的内容 div 和后台功能

> ID：12428459
> 
> 赞同：0
> 
> 时间：2012-09-14T16:27:22.783
> 
> 标签：jquery, background-image, footer, sticky-footer, expandable

我是网页设计/开发的新手，有几个问题。

首先，我有兴趣找到一种使页面内的内容可扩展的方法，但不确定它会如何影响设置为背景的图像以及其他内容（导航、其他各种 div我要使其可扩展的 div）。我一直在阅读一些用于可扩展 div 的 jQuery 脚本，并且还研究了“粘性页脚”，但对整个过程和过程仍然有些困惑。我为我镇上的一些公司做设计，并使用我在 Photoshop 中制作的各种背景，其中很多只是基本的渐变风格背景。

无论如何，只是从网络老手到初学者寻找一些答案/建议。

谢谢，埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T19:01:57.717

我在这里在黑暗中拍摄，所以要友好。创建`DIV`元素然后将它们的类从`hidden`to更改为`showable`或类似的东西对您有用吗？

你看 jQuery 是完全正确的。起初我觉得这很奇怪，但现在我喜欢它。

# java - System.out.println(4 | 3)

> ID：12428461
> 
> 赞同：1
> 
> 时间：2012-09-14T16:27:24.773
> 
> 标签：java

```
System.out.println(4 | 3); 
```

输出为 7。它最多可以添加 3 个数字，但这是如何工作的？语法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T16:28:57.367

那是因为`|`是[按位或](http://en.wikipedia.org/wiki/Bitwise_operation#OR)

```
100    4
011    3
---
111    7 
```

所以结果是 7。

如果您想了解有关按位运算符的更多详细信息，请阅读：[按位和位移运算符](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-14T16:29:42.063

二进制或

```
 3 = 011
  4 = 100
  ----------
3|4 = 111 = 7 
```

这并不总是意味着添加

```
 2 = 10
  2 = 10
2|2 = 10 = 2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T16:29:25.777

它正在执行二进制 OR 操作

```
0100    - this is a 4
0011    - this is a 3
 |
0111    - result is 7 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-14T16:29:31.720

你想做什么？你*正在*做的是一个二进制或两个数字：

```
0b011 
 ||
0b100
 ==
0b111 -> 7. 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-14T16:30:22.670

```
System.out.println(4 | 3); 
```

它是一个按位或运算符。解释 -

```
4->100
3->011
   ----
   111 ->7 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-14T16:56:42.940

```
 3 =  0011
 4 =  0100
 |_____|
    |
    V
   0111 
    |
    V
    7 
```

# java - 在 GridView 中单击图像时，如何显示图像的完整大小？

> ID：12428464
> 
> 赞同：0
> 
> 时间：2012-09-14T16:27:30.240
> 
> 标签：java, android, gridview

我在互联网上看到了这个示例，我需要做的只是添加一个代码，说明在 Gridview 中单击图片后如何显示图像的完整尺寸。任何想法？

```
public class MainActivity extends Activity {

    ImageAdapter myImageAdapter;

   @Override
   public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    GridView gridview = (GridView) findViewById(R.id.gridview);
    myImageAdapter = new ImageAdapter(this);
    gridview.setAdapter(myImageAdapter);

    String ExternalStorageDirectoryPath = Environment
      .getExternalStorageDirectory()
      .getAbsolutePath();

    String targetPath = ExternalStorageDirectoryPath + "/test/";

    Toast.makeText(getApplicationContext(), targetPath, Toast.LENGTH_LONG).show();
    File targetDirector = new File(targetPath);

    File[] files = targetDirector.listFiles();
    for (File file : files){
     myImageAdapter.add(file.getAbsolutePath());
    } 
} 
```

我认为这是适配器类。

```
public class ImageAdapter extends BaseAdapter {

 private Context mContext;
 ArrayList<String> itemList = new ArrayList<String>();

 public ImageAdapter(Context c) {
  mContext = c; 
 }

 void add(String path){
  itemList.add(path); 
 }

@Override
public int getCount() {
return itemList.size();
}

@Override
public Object getItem(int arg0) {
 // TODO Auto-generated method stub
return null;
}

@Override
public long getItemId(int position) {
// TODO Auto-generated method stub
return 0;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
ImageView imageView;
     if (convertView == null) {  // if it's not recycled, initialize some attributes
         imageView = new ImageView(mContext);
         imageView.setLayoutParams(new GridView.LayoutParams(220, 220));
         imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
         imageView.setPadding(8, 8, 8, 8);
     } else {
         imageView = (ImageView) convertView;
     }

     Bitmap bm = decodeSampledBitmapFromUri(itemList.get(position), 220, 220);

     imageView.setImageBitmap(bm);
     return imageView;
     }

     public Bitmap decodeSampledBitmapFromUri(String path, int reqWidth, int reqHeight) {

     Bitmap bm = null;
    // First decode with inJustDecodeBounds=true to check dimensions
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeFile(path, options);

    // Calculate inSampleSize
     options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    bm = BitmapFactory.decodeFile(path, options); 

    return bm;   
    }

    public int calculateInSampleSize(

    BitmapFactory.Options options, int reqWidth, int reqHeight) {
    // Raw height and width of image
    final int height = options.outHeight;
    final int width = options.outWidth;
    int inSampleSize = 1;

    if (height > reqHeight || width > reqWidth) {
    if (width > height) {
    inSampleSize = Math.round((float)height / (float)reqHeight);    
    } else {
    inSampleSize = Math.round((float)width / (float)reqWidth);    
    }   
    }

    return inSampleSize;    
   }

   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:07:45.340

向您的 GridView 添加单击侦听器。从那里您必须打开第二个显示完整尺寸图像的活动。

```
gridview.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        String path = mAdapter.getItem(position);
        Intent i = new Intent(AndroidTestActivity.this, DetailActivity.class);
        i.putExtra("path", path);
        startActivity(i);
    }
}); 
```

或者您使用 Android 的内置功能：
[Launching Intent.ACTION_VIEW intent not working on saved image file](https://stackoverflow.com/questions/2954594/launching-intent-action-view-intent-not-working-on-saved-image-file)

# css - 导航栏边框问题

> ID：12428470
> 
> 赞同：1
> 
> 时间：2012-09-14T16:27:54.030
> 
> 标签：css, border

我正在开发一个新主页，尽量避免使用图像，并且导航栏上的边框有一点问题。我真的想不出一种方法来让边界的两侧通过填充相互链接。目前双方没有接触，所以它看起来不连续。我可能遗漏了一些明显的东西，但我想不出办法来认识他们。有人有想法么？

我能想到解决这个问题的唯一方法是在每个 li 元素上使用类，但我想知道是否有可选的方法。

这是一个小提琴供您检查：

[http://jsfiddle.net/WZF4M/](http://jsfiddle.net/WZF4M/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:39:01.263

您可能想在 li 样式中使用以下内容？虽然进行了调整；未在所有浏览器中测试。

```
li{
    display: inline;
    margin-right: -5px; /*Add this*/
    padding: 11px 12px 11px 12px;
    border: solid 1px #c1c1c1;
} 
```

选项2：-

一个更优雅的解决方案就在 SO。

[如何删除内联块产生的额外边距空间？](https://stackoverflow.com/questions/1801589/how-do-i-remove-extra-margin-space-generated-by-inline-blocks)

为此，您可能必须更改您的 html。

```
<ul>
    <li>Test</li><li>Apple</li><li>Cat</li><li>Dog</li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:36:44.650

试试这个**[jsFiddle 示例](http://jsfiddle.net/j08691/WZF4M/4/)**。我将列表项向左浮动，而不是内联显示它们。这消除了它们之间的差距。然后我将列表本身相对定位并稍微向上移动。

CSS：

```
ul{
    float: right;
    position:relative;
    top:-14px;
}
li{
    float:left;
    padding: 11px 12px 11px 12px;
    border: solid 1px #c1c1c1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:37:01.500

要使这种感觉更加连续，您可以做的就是仅在菜单中`border-right`的元素上使用。`li`

[http://jsfiddle.net/WZF4M/3/](http://jsfiddle.net/WZF4M/3/)

我已经更新了你的小提琴。

让我知道这是否是您想要的。

# ios - 在 iOS 5.1 上的 OpenGL ES 应用程序中，他们真的使用他们声明的顶点数组吗？

> ID：12428473
> 
> 赞同：1
> 
> 时间：2012-09-14T16:28:00.187
> 
> 标签：ios, xcode, opengl-es, vertex-buffer, vertex-array

在您获得的股票 OpenGL ES 应用程序中（当您在 XCode 中创建新的“OpenGL 游戏”时），在`setupGL`函数中，有：

```
glEnable(GL_DEPTH_TEST);

//glGenVertexArraysOES( 1, &_vertexArray ) ; // va's are not being used!
//glBindVertexArrayOES( _vertexArray ) ;     // we comment these out
// to no ill effect -- are these calls extraneous?

glGenBuffers( 1, &_vertexBuffer ) ;
glBindBuffer( GL_ARRAY_BUFFER, _vertexBuffer ) ;
glBufferData( GL_ARRAY_BUFFER, sizeof(gCubeVertexData), gCubeVertexData, GL_STATIC_DRAW ) ;

glEnableVertexAttribArray(GLKVertexAttribPosition);
glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(0));
glEnableVertexAttribArray(GLKVertexAttribNormal);
glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(12));

//glBindVertexArrayOES(0); 
```

但是，似乎没有使用顶点数组（据我所知，顶点数组保留在客户端内存中，而顶点缓冲区则停在 OpenGL 服务器内存中）。

如果您注释掉这些`glBindVertexArrayOES`命令，代码似乎完全一样。

`glBindVertexArrayOES`此 xCode 示例中的调用是否无关紧要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:10:46.897

您将顶点数组与*顶点数组对象*混淆（术语令人困惑）。

此声明：“（据我所知，顶点数组保留在客户端内存中，而顶点缓冲区停放在 OpenGL 服务器内存中）”适用于客户端顶点数组。当您想将顶点缓冲区保持在本地时，这些用于代替“顶点缓冲区对象”，从而为 glDrawElements/gl*Pointer 提供原始内存指针。

*另一方面，*顶点数组对象是一个 OpenGL 构造，它包含绘制对象所需的所有指针。*任何名称中带有“VertexArray”的 OpenGL 函数都适用于“顶点数组对象”，而不是客户端顶点数组。*

 *您可以在此处阅读有关 VAO 的更多信息：

[http://www.opengl.org/wiki/Vertex_Specification#Vertex_Array_Object](http://www.opengl.org/wiki/Vertex_Specification#Vertex_Array_Object)*

# .net - XmlDocument.LoadXml() 挂了几分钟

> ID：12428478
> 
> 赞同：2
> 
> 时间：2012-09-14T16:28:19.270
> 
> 标签：.net, xml, vb.net, xmldocument

我有一个从 HTTP 请求解析 XML 响应的例程，我使用 XmlDocument.LoadXml 来帮助执行此操作。我指望这种方法在错误的 XML 上引发异常并在成功时返回加载的 XmlDocument 对象。

我没想到的是它在加载文档时会挂起几分钟。当我在测试环境中运行此代码时，它 100% 的时间会挂起几分钟。对我来说，这看起来像是 .NET 中的一些错误......

```
 Dim tstring As String = ""

    tstring &= "" & vbCrLf
    tstring &= "" & vbCrLf
    tstring &= "<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">" & vbCrLf
    tstring &= "" & vbCrLf
    tstring &= "<html> xmlns=""http://www.w3.org/1999/xhtml"" >" & vbCrLf
    tstring &= "<head><title>" & vbCrLf
    tstring &= "    Error" & vbCrLf
    tstring &= "</title></head>" & vbCrLf
    tstring &= "<body>" & vbCrLf
    tstring &= "</body>" & vbCrLf
    tstring &= "</html>" & vbCrLf

    Dim MyXmlDoc As New XmlDocument
    MyXmlDoc.LoadXml(tstring) 
```

文档中可以删除以防止其挂起的特定行是：

```
 tstring &= "<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">" & vbCrLf 
```

如果我看到它，我是否必须在字符串中搜索“<！DOCTYPE html”而不调用 LoadXml()？我对此的担忧是在这个方法中还有什么其他问题在等着我？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T17:01:57.810

loadxml 调用正在解析 doctype 以进行验证，因此它必须获取该 url - 在这种情况下很慢。您可以[直接](http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd)在浏览器中进行测试。

另一个问题[提供了一种解决方法](https://stackoverflow.com/a/4462151/931049)- 引用：

> 在 .NET 4.0 XmlTextReader 中有一个名为 DtdProcessing 的属性。当设置为 DtdProcessing.Ignore 时，它​​应该禁用 DTD 处理。

和

> doc.XmlResolver = null;

对于 .NET 3.5 应该可以工作。

# casting - openCL 中的显式转换

> ID：12428479
> 
> 赞同：0
> 
> 时间：2012-09-14T16:28:21.533
> 
> 标签：casting, opencl

我在将 float8 var 转换为 double8 以用于 openCL 中的 sincos 函数时遇到问题。所以我尝试了以下方法：

```
float8 a,b,c;

a = convert_float8(sin(convert_double8(a))); // worked
a = convert_float8(sincos(convert_double8(b),convert_double8(&c))); // failed 
```

它会抛出一个openCL错误，说无法构建程序。起初我认为 sincos 不接受 double8 类型，但如果我只是传入一个 double8 var，它也可以工作，但是当我尝试将 float8 转换为 double8 时，它会像上面的代码一样失败。

```
float8 a;
double8 b,c;

a = convert_float8(sincos((b),(&c))); //worked 
```

有谁知道为什么/如何正确投射它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:04:37.167

在您的第一个代码示例中，`&c`是 type `float8*`，即它是指向一个`float8`值的内存地址。您不能使用`convert_double`将此地址转换为指向的指针`double8`（`sincos`在此上下文中，这是它的第二个参数所期望的）。我想不出任何合理的方式来解决这个问题。

您必须显式创建正确类型的临时变量：

```
float8 a,b,c;
double8 c_double;
a = convert_float8(sincos(convert_double8(b), &c_double));
c = convert_float8(c_double); 
```

# java - EL 中的异或 (XOR)

> ID：12428482
> 
> 赞同：4
> 
> 时间：2012-09-14T16:28:30.880
> 
> 标签：java, jsp, jstl, el

有没有办法做一个独家或在EL？我有两个变量。我想检查一次是否只有一个是空的。我知道我可以通过执行以下操作手动执行此操作，但我想知道是否有 EL 关键字？

```
<c:if test="${(!empty var1 and empty var2) or (empty var1 and !empty var2}>
    ----Do something here.. 
</c:if> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T16:35:37.907

[EL 没有 XOR 运算符](http://docs.oracle.com/javaee/6/tutorial/doc/bnaik.html)，但由于两个表达式都已经返回布尔值，只需将它们比较`!=`。

```
<c:if test="${empty var1 != empty var2}">
    ----Do something here.. 
</c:if> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:34:56.727

Boolean XOR 与“不等于”相同，因此请使用：

```
<c:if test="${(empty var1) != (empty var2)}>
    ----Do something here.. 
</c:if> 
```

[在此处找不到 XOR 运算符](http://bellsouthpwp.net/b/i/billsigg/jstl-quick-reference.pdf)。

# workflow - 与工作流相关的一项 Alfresco Activiti

> ID：12428487
> 
> 赞同：2
> 
> 时间：2012-09-14T16:28:44.890
> 
> 标签：workflow, alfresco, activiti

我想将与工作流关联的文件数量限制为一个文件并强制关联。我一直在尝试覆盖我自己的工作流模型上的 bpm_package 属性并更改 share-config-custom.xml 文件中的字段属性，但没有成功。我也无法在网上找到任何文档。有可能这样做吗？如何？谢谢

# php - exec 在窗口服务器 2008 php 上不起作用

> ID：12428488
> 
> 赞同：3
> 
> 时间：2012-09-14T16:28:46.270
> 
> 标签：php, windows, exec

我在下面有一个命令，如果我通过 php 文件运行它`http://localhost/myfile.php`

它将输出 cmd 但不会生成 input_file.txt。

```
$cmd = "ffmpeg.exe -i C:\\ep-convert\\To_the_Beautiful_You_9.264 2> input_file.txt";
exec($cmd);
echo $cmd; 
```

但是，如果我在屏幕上复制命令输出

```
ffmpeg.exe -i C:\ep-convert\To_the_Beautiful_You_9.264 2> input_file.txt 
```

我将它粘贴到控制台中，它的工作。

问题是如果我运行其他 exe 文件，如 mencoder 或 mplayer 等。显示输出，但是特别是这个 ffmpeg.exe 似乎没有与我的 exec() 一起运行

可能出了什么问题以及如何让 exec 使用上面的 cmd 工作。

我正在运行窗口服务器 2008

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-21T14:56:37.453

这很可能是文件权限问题。您可以从控制台运行此命令，因为您以管理员身份运行控制台。IIS 有不同的用户帐户。默认情况下限制访问其他文件。您必须向该用户授予特定目录的权限。您可以简单地右键单击文件夹，然后单击属性。转到安全选项卡并编辑权限。

# jquery - Opera 开发工具报告 JQuery 1.8.0 (min script) 错误：“Unhandled DOMException: SYNTAX_ERR”

> ID：12428490
> 
> 赞同：3
> 
> 时间：2012-09-14T16:28:48.460
> 
> 标签：jquery, opera, domexception

我在 Opera 12 的蜻蜓开发工具的网页上间歇性地看到此错误“Unhandled DOMException: SYNTAX_ERR”。它来自页面加载时缩小的 JQuery 脚本（下面的链接有更详细的信息）。仅在 JQuery 1.8.0 版本中发生。我下载的副本和 GoogleApis 托管版本都会发生这种情况。**[Opera 论坛说这是一个 JQuery 错误](http://my.opera.com/community/forums/topic.dml?id=1513672)**，因为它也发生在 Chrome 开发人员工具中，并且在**[JQuery 论坛上它已被关闭，因为它不是问题](http://bugs.jquery.com/ticket/12422)**。

我阅读了上述帖子和其他一些帖子，但想知道我的页面在加载此错误的时间是否对我的页面有任何功能影响.?.? 看起来不像，但我不能肯定地说，我也想知道是否有任何快速修复我可以应用来防止它（与配置浏览器开发工具以显示/隐藏这些实例无关）？

我问第一个问题是因为要遵循两个不同的代码路径，似乎行为可能会根据您是否使用该功能而改变。免责声明：我没有通过那个 Jquery 脚本阅读，但上面的论坛说这是导致 DOMException 的这一行，我不知道那是什么。

```
try {
    matches.call( div, "[test!='']:sizzle" );  <---------- This line
    rbuggyMatches.push( Expr.match.PSEUDO );
} catch ( e ) {} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T15:57:10.117

看起来这只是开发人员工具的错误**正如** jQuery 跟踪器中的最后一条评论所说：

> 默认情况下，12.50 不再停止处理异常。

刚刚检查了 jQuery 1.8.1 / Opera 12.50 (build 1583)。Opera 12.50 不会因为这个错误而停止。你可以自己检查。

# android - Android getPixel from Bitmap 随机开始返回黑色

> ID：12428493
> 
> 赞同：1
> 
> 时间：2012-09-14T16:29:05.520
> 
> 标签：android, bitmap, opengl-es-2.0, getpixel

我正在使用 opengl es 2.0 为 android 开发游戏，我使用高度图位图来创建地形。这行得通。

在游戏过程中，我有代表游戏中实体的类，这些实体在它们的实例中存储它们的 (x,y) 位置。为了获得 z 值，我使用了一种查询高度图位图的方法。

这是方法：

```
public float zAt(float pos[]){
    float xPos = pos[0] + terrainWidth/2;
    float yPos = height-(pos[1] + terrainHeight/2);

    int bitMapWidth = zMap.getWidth();
    int bitMapHeight = zMap.getHeight();

    int pixelX= (int) (((bitMapWidth-1)  * xPos) / terrainWidth);
    int pixelY = (int) (((bitMapHeight-1) * yPos) / terrainHeight);

    if(pixelX < 0 || pixelX >= bitMapWidth || pixelY < 0 || pixelY >= bitMapHeight)
        return 0;
    else{
        System.out.println("DEBUG! >> "+"("+pixelX+","+pixelY+"):"+zMap.getPixel(pixelX, pixelY)+" <<");
        float toReturn = ((zMap.getPixel(pixelX, pixelY) & 0xFF)-(255f/2f))/zDiv;

        return toReturn;
    }
} 
```

当游戏开始时，一切都很好。但是在一些游戏循环之后，我注意到我在游戏中的对象总是停留在 z=0 中。我去检查 zAt 方法，将 println 扔在那里，我验证了事实上，在一段时间后（每次运行游戏时这个时间都不同），zMap.getPixel 开始返回 0。

这是一个奇怪的问题，因为我在游戏过程中没有改变我的位图。

有时它甚至会闪烁一下，即 getPixel 返回 0，然后返回正确的值，然后再次返回 0……大多数时候最终总是返回 0。

这就是我加载位图的方式：

```
 final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inScaled = false;

    Bitmap terrainBitmap = BitmapFactory.decodeResource(this.getResources(), R.drawable.heightmap, options); 
```

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T17:57:45.387

如果 pixelX 或 pixelY 值大于位图的相应尺寸，则返回 0。在进入此代码部分之前验证 pixelX 和 pixelY 值：

```
if(pixelX < 0 || pixelX >= bitMapWidth || pixelY < 0 || pixelY >= bitMapHeight)
    return 0; 
```

# java - 为数字和单词设置 unicode 的正则表达式

> ID：12428495
> 
> 赞同：2
> 
> 时间：2012-09-14T16:29:09.273
> 
> 标签：java, regex

我有这句话：“我11:00有20根香蕉，我要21-00”。

我需要为它设置一个unicode。"\u200e" 是数字的换行，"\u200f" 是单词的换行。

结果应该是：

"\u200f 我在 \u200f\u200e11:00\u200e\u200f 点有 \u200f\u200e20\u200e\u200f 香蕉，我想要 \u200f\u200e21-00\u200e"

如何在 java 中的字符串上执行此操作？

**更新**

我的句子是希伯来语句子。“היום יום שלישי 20:00 בערב”

预期结果：“\u200fהיום יום שלישי \u200f\u200e20:00\u200e\u200fבערב\u200f”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:37:08.287

您可以进行多次替换。

```
String s = "I have 20 bananas at 11:00 o'clock, and I want 21-00";
s = s.replaceAll("([ ',\\p{Alpha}]+)", "<$1>");
s = s.replaceAll("([-:\\d]+)", "{$1}");
System.out.println(s); 
```

印刷

```
<I have >{20}< bananas at >{11:00}< o'clock, and I want >{21-00} 
```

为了便于阅读，我使用了不同的符号，但您可以使用 unicode 字符。应该接受所有字符集中的`\\p{Alpha}`字母。

# sql - 无法让简单的 PostgreSQL 插入工作

> ID：12428496
> 
> 赞同：105
> 
> 时间：2012-09-14T16:29:13.733
> 
> 标签：sql, postgresql, string-constant

我正在尝试在 postgres 表中进行简单的插入，但我收到一个错误，即我尝试插入的值被解释为列名

```
INSERT INTO "imageTagBusinessMainCategory"
(id, businessMainCategory)
VALUES
(DEFAULT, "auto dealer") 
```

其中 id 设置为主键，自动递增，不为空。这些是我在 phpPgAdmin 中设置表格时勾选的框。

我收到了这个错误：

```
ERROR: ERROR: column "auto dealer" does not exist
Query = INSERT
INTO "imageTagBusinessMainCategory"
(id, businessMainCategory)
VALUES
(DEFAULT,
"auto dealer") 
```

我已经将我的表名放在双引号中，正如我在[这里](https://stackoverflow.com/a/695312/1252748)读到的那样。

并且习惯于`DEFAULT`按照我在[这里](http://archives.postgresql.org/pgsql-novice/2009-11/msg00103.php)读到的那样自动增加 id 。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-09-14T16:32:41.667

改为使用`'auto dealer'`。PostgreSQL 解释`"`为标识符`'`的引号，以及字符串的引号。

还：

*   如果这是一个新项目，请不要使用混合大小写表；这是后来沮丧的根源。不能在 SQL 语句中使用任何大小写，您必须同时引用标识符名称并正确区分大小写。

*   无需指定`id`/ `DEFAULT`，您是在要求它执行它已经完成的操作。我还没有遇到要求您包含`columnName`/`DEFAULT`如果您希望它在列中放置默认值的 DBMS，所以我认为这个额外的 KV 对不会让以后阅读您的代码的任何人更清楚正在发生的事情.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-14T16:33:43.230

```
INSERT INTO "imageTagBusinessMainCategory"
("businessMainCategory")
VALUES
('auto dealer') 
```

编辑：在列名周围添加双引号

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-21T06:48:03.763

Postgres、Oracle 等希望列名在大小写混合时用引号引起来。因此，要么为你的表格列创建一个全部小写或全部大写的约定，要么按照 David Faber 的建议使用引号

```
INSERT INTO "imageTagBusinessMainCategory"
("businessMainCategory")
VALUES
('auto dealer') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-07T14:57:06.423

在我的情况下，我不得不将列名从 camelCase 更改`'isAdmin'`为 snake_case `'is_admin'`。

# c++ - GL 上下文销毁

> ID：12428497
> 
> 赞同：1
> 
> 时间：2012-09-14T16:29:16.603
> 
> 标签：c++, windows, opengl

我成功创建了 GL 渲染上下文（我检查了所有 WinApi 函数的返回值）。当我尝试使用以下代码破坏上下文时，它失败了：

```
 bool success = ::wglMakeCurrent ( 0, 0 ); // false
    success = ::wglDeleteContext ( glRenderingContext_ ); // false 
```

上述所有内容都发生在一个线程中。怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:08:59.477

在进行此调用之前，您是否销毁了保存设备和呈现上下文的窗口？在销毁窗口之前，您应该关闭渲染上下文。

# svn - 颠覆配置

> ID：12428503
> 
> 赞同：1
> 
> 时间：2012-09-14T16:29:35.943
> 
> 标签：svn, subversive

我已经从 Collabnet 下载了 subversion 服务器和客户端 RPM，并安装了它。它被解压到 opt/CollabNet_Subversion 目录中。

但是当我尝试运行 `/bin/svn`一条消息“这不是工作副本”时会显示。我正在尝试仅查找文档，但它似乎很差。

我必须做某事或运行脚本来配置它吗？

我是 Subversion 的新手。感谢您的帮助！

PS：系统：Linux Suse 11.2 SVersion：1.7.6-1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:36:09.707

“这不是工作副本”就是这个意思。您需要先将存储库“签出”到工作副本中，然后才能对其执行 SVN 操作。SVN 可以判断它是一个工作副本，因为`.svn`它里面有文件夹。

有关详细信息，请参阅：[创建工作副本](http://svnbook.red-bean.com/en/1.7/svn.tour.initial.html)

> 大多数时候，您将通过签出项目来开始使用 Subversion 存储库。从存储库中检出目录会在本地计算机上创建该目录的工作副本。除非另有说明，否则此副本包含在 Subversion 存储库中找到的目录及其子目录的最新（即最近创建或修改）版本。

我发现网上的文档非常好。好好阅读一下[带有 Subversion 的版本控制，](http://svnbook.red-bean.com/en/1.7/index.html)看看之后你是否还有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T17:03:25.130

为了使用 Subversion（或任何版本控制软件），您必须：

*   创建一个存放您的文件的存储库。（您使用该`svnadmin create`命令来执行此操作。）
*   在**另一个**目录中，您从存储库签出到*工作目录*。您`svn checkout`为此使用命令）。
*   你在你的*工作目录中做你的工作*
*   完成工作后，您可以将更改*提交*或*签入到存储库中。*（您`svn commit`为此使用命令）。

要创建存储库，请查看[Subversion 在线手册](http://svnbook.red-bean.com/en/1.7/index.html)的[第 5 章](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.create.html)。然后，通过[第 1](http://svnbook.red-bean.com/en/1.7/svn.basic.html)章和[第 2 章](http://svnbook.red-bean.com/en/1.7/svn.tour.html)来基本了解 Subversion（和版本控制）是如何工作的，并使用您创建的存储库来帮助您学习如何使用 Subversion。

这会给你一个你需要的一般理解。一旦你掌握了基础知识，你就可以阅读本书的其余部分。

# ruby-on-rails - Devise for Rails 支持授权吗？

> ID：12428504
> 
> 赞同：1
> 
> 时间：2012-09-14T16:29:35.977
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, authorization, ruby-on-rails-3.2

我已经为 Rails 3.2.8 应用程序实现了设计。非常简单，似乎工作正常。但是文档建议为管理员角色创建一个带有电子邮件/密码的完整单独的表。我需要我们系统中的管理员也被视为用户，他们只是拥有额外的权限。设计是否对此有所帮助，或者是否有很好的授权扩展？或者我是否希望在用户模型中创建一个额外的角色模型或字段来处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:10:57.660

如果您的要求很简单，您可以在用户表中添加一个名为“is_admin”的布尔列，并在每次需要额外权限时对其进行检查。

如需系统解决方案，请查看[ryanb](https://github.com/ryanb/cancan)（Railscasts 作者）的 Cancan

# asp.net - 将子文件夹名称添加到默认命名空间时如何修复 Visual Studio 2008？

> ID：12428509
> 
> 赞同：2
> 
> 时间：2012-09-14T16:29:54.430
> 
> 标签：asp.net, .net, visual-studio-2008, c#-4.0, resharper

我在工作中遇到问题，当我在文件夹下创建网页文件 (.aspx.cs) 时，我的 Visual Studio 2008 已开始将子文件夹名称添加到我的默认命名空间。例如，如果我的项目名称是 ProjectX，并且我有一个名为 Subfolder1 的子文件夹，那么当我添加一个新网页“Home.aspx.cs”时，命名空间将变为“ProjectX.Subfolder1”：

```
namespace ProjectX.Subfolder1
{
    public class Home 
```

我不确定这是否是默认行为，但是当我的同事做同样的事情时，她说命名空间不包括 Subfolder1：

```
namespace ProjectX
{
    public class Home 
```

我怀疑导致这种行为的唯一原因是我在我的电脑上安装了 Resharper 而她没有。我认为 Resharper 很有帮助，但它可能会更改我的项目文件并弄乱我的项目。请告知我如何解决这个问题。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:38:31.427

您可以尝试使用命名空间模板

[http://msdn.microsoft.com/en-us/library/eehb4faa%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/eehb4faa%28VS.80%29.aspx)

或在解决方案资源管理器中选择文件夹，然后选择属性。设置命名空间提供者 = False

# android - 从 Restful Web 服务获取字节数组文件到 android

> ID：12428510
> 
> 赞同：3
> 
> 时间：2012-09-14T16:30:00.513
> 
> 标签：android, file, rest, bytearray, firebird

我是新来的，如果我不能很好地表达自己或我的英语，我想先找借口！

事实上，我正在开发一个项目，该项目应该从 Firebird 数据库中获取字节数组并在 android 上表示它们。所以我决定使用一个带有从数据库中获取这些数据的方法的**restful webservice，**然后使用android客户端来检索它们。

我怎样才能将这些字节写入文本文件，然后使用 android 客户端获取它！

Web 服务上的方法如下所示：

```
 @GET
    @Path("daten/{id}")
    @Produces("text/plain")
  *// Instead of byte[] I wanted to return a file because this doesn't work*
    public byte[] getDaten(@PathParam("id") String id){
      Tbpatereignis res= (Tbpatereignis) em.createQuery("select erg from Tbpatereignis as erg where erg.vcereignis= :ekgtyp and erg.vcpatsur.vcsurrogat= :id ").setParameter("ekgtyp", "UREKG").setParameter("id", id).getResultList().get(0);

      return res.getBldivers();
    } 
```

然后我怎样才能从一个安静的网络服务中检索这个文件并稍后在 android 上使用它？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T08:30:43.223

你应该使用@Produces("application/octet-stream") 而不是@Produces("text/plain")。在 android 客户端中，您可以使用 httpclient 或 URLConnection 发出 http 请求。

URLConnection 从服务器获取图像的示例代码：

```
URL url = new URL(urlStr);
URLConnection connection = url.openConnection();
Bitmap bmp=BitmapFactory.decodeStream(connection.getInputStream()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-12T07:36:09.040

您可以使用 MediaType.APPLICATION_OCTET_STREAM 直接从数据库中获取字节数组。

在服务器（端点）端：

```
@GET
  @Path("fetch-image")
  @Produces(MediaType.APPLICATION_OCTET_STREAM)
  public Response getImageArray(
    @HeaderParam(IMAGE_ID) String image_id) {

    // return image requested as byte array
    return Response.ok(MyDBFunctions.fetchImage(image_id), MediaType.APPLICATION_OCTET_STREAM);
  } 
```

在 Android（消费者）方面：

```
public <T> T getImage(Class<T> responseType, String image_id) throws ClientErrorException {
        Client client = ClientBuilder.newClient());
        WebTarget webTarget = client.target(BASE_URI).path("fetch-image");

        // return image as byte array
        return webTarget.request(MediaType.APPLICATION_OCTET_STREAM)
                .header(IMAGE_ID, image_id)
                .get(responseType);
    } 
```

最后，加载图像：

```
Response resp = data.getImage(Response.class, image_id);
                if (resp.getStatus() == HTTP_STATUS_OK) {
                    // load image from server
                    image = resp.readEntity(byte[].class);
                }
                resp.close(); 
```

# android - 在 .APK 上设置密码

> ID：12428516
> 
> 赞同：0
> 
> 时间：2012-09-14T16:30:23.710
> 
> 标签：android, installation, apk

有没有办法设置“权限” | 提示用户输入密码以安装 .apk 的任何其他方法

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:32:51.463

不，那里没有。

保护您的应用程序的最佳方法是在您的应用程序中实施身份验证系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T16:33:02.167

1.  下载安卓源代码，修改为在安装前要求输入密码。您可以根据应用程序的签名过滤应用程序，并仅在安装与特定签名匹配的应用程序时才要求输入密码。
2.  妥协一点，当你的应用程序运行时要求输入密码，就像 Facebook 要求你登录一样。

# http - 保护 HTTP 请求不被篡改

> ID：12428520
> 
> 赞同：3
> 
> 时间：2012-09-14T16:30:40.513
> 
> 标签：http, request

我正在为我的网络应用程序和 iPhone 应用程序使用公共 API。我的应用程序对数据库执行基本的 CRUD 操作。

由于 API 的客户端密钥在 HTTP 请求标头中发送，因此恶意用户很容易转储该密钥并篡改最初传递给请求的数据（例如使用 Tamper Data Firefox 插件）

所以这是我的一个简单问题：受到保护的最佳实践是什么？在将数据发送到数据库之前，如何以编程方式检测不同的作弊案例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T10:14:09.283

SSL 不会达到目的。HTTP/HTTPS 请求在发送到服务器之前可以被篡改。最好的方法是在生成 HTTP 请求之前对数据进行加密。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:36:40.757

为您的网络服务提供服务，`HTTPS`而不是`HTTP`阻止任何人在网络上嗅探您的密钥。

# visual-studio-2010 - Perforce 出现“文件不在客户端根目录下”错误消息

> ID：12428521
> 
> 赞同：11
> 
> 时间：2012-09-14T16:30:53.390
> 
> 标签：visual-studio-2010, version-control, perforce

我正在通过 VS2010 添加一个项目来执行，但我不断收到`'file' not under client's root`项目中所有文件的此错误。我似乎无法弄清楚这一点。

这是我正在做的事情：

1）打开尚未执行的VS2010项目。

2）我选择将solotion添加到perforce（从文件>源代码控制>添加解决方案菜单）。

3) 我选择了一个新的工作区。它带来了工作区的属性。根文件夹默认为 c:\Users\My.Name。我将其更改为我的项目所在的文件夹。我还更改了视图，使其指向说 depot\main\new_project。

它似乎已经添加了项目，但是当我签入文件时它就不起作用了！它为所有`'file not under client's root'`.

我也直接去perforce查看对应工作区的设置。在仪表板中显示错误：

```
P4V is having trouble translating the location "c:\Users\user.Name\Documents\Code\My_Project" to a valid workspace location. To filter using this location, drag the folder from the workspace tree to the workspace folder field or include the depot location in your workspace view. 
```

有人可以给我任何指示，为什么这不起作用？

**更新** 我的工作区映射是这个

```
Client:  omega
Owner:   User.Name
Root:    C:\Users\User.Name\Documents\Visual Studio 2010\Projects\Omega
LineEnd: local
View:
         //depot/main/omega/...     //omega/... 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-25T18:15:28.840

If you get this error while the "Pending" Tab is open, the following could be your problem! You may not be seeing your entire filter (ie. some of the filter may be out of view). Mouse over your Window Pane Border underneath the filter until your cursor changes so that you can expand the Filter Window Pane. There is a filter that could be there that says, "Files that match any of the following file paths:" Make sure that you don't have a file path selected that is incorrect. Either remove the filter or choose "Current depor or workspace tree selection".

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T06:06:17.007

What I believe is that you have a different path for your client and your code is in different path. From you P4V error I see that the path is:

```
c:\Users\user.Name\Documents\Code\My_Project 
```

But your client root path is:

```
C:\Users\User.Name\Documents\Visual Studio 2010\Projects\Omega 
```

In above scenario, the path only upto "C:\Users\User.Name\Documents" is common, after that your client root and your project root differs. If you want to check in code from your My_Project folder, change the client root to point to that. You can do so on command line by

```
p4 client <client name> 
```

Or change it in Workspace view of P4V.

Also, make sure to use "" around your path since it has folder name with space.

Hope this helps.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-30T21:30:53.053

One 'oops' mistake you can make is to have the wrong workspace selected in Visual Studio 2012\. Just did that and spent a few minutes scratching my head.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-08T19:12:41.153

This exact problem was related to my "PENDING VIEW". It had a search filter set for the default workspace at the time, and any time I switched to a different workspace it would show the error dialog.

The deal was I had changed the workspace name, and the filter was no longer valid.

I cleared the filter (in the pending view) and the error disappeared.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T20:10:52.277

我猜 Perforce 在你的路径中存在空格问题。试着在它周围加上引号。

来自[http://www.perforce.com/perforce/doc.current/manuals/p4guide/03_using.html](http://www.perforce.com/perforce/doc.current/manuals/p4guide/03_using.html)：

> Spaces in filenames, pathnames, and identifiers Use quotation marks to enclose files or directories that contain spaces. For example: "//depot/dev/main/docs/manuals/recommended configuration.doc" If you specify spaces in names for other Perforce objects, such as branch names, client names, label names, and so on, the spaces are automatically converted to underscores by the Perforce server.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-09T14:51:39.560

I had similar error message showing during project build. What helped was deleting .suo file and reloading the project as described in [How does Visual Studio's source control integration work with Perforce?](https://stackoverflow.com/questions/261525/how-does-visual-studios-source-control-integration-work-with-perforce)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-09T09:02:26.907

Check the path specified in the client Root. If this is not a valid path then you encounter this error

```
Root:   /a/b/c/d 
```

If this is not a valid root you end up getting the following error

```
Path '/a/b/c/d/...' is not under client's root '/a/b/c/d' 
```

Just correct the path pointed to by Root and you should be fine

# android - 新的智能手机应用程序概念：使用推送通知、短信、电子邮件或其他？

> ID：12428522
> 
> 赞同：0
> 
> 时间：2012-09-14T16:30:52.947
> 
> 标签：android, iphone, blackberry, notifications, push

我正在寻找为 iOS、Blackberry 和 Android 构建智能手机应用程序。应用程序必须能够发送和接收紧急警报（用响亮的声音阅读消息）。我需要能够让用户选择或指定一个声音文件，因为它必须足够响亮才能在晚上叫醒人们。

我搜索了推送通知 SDK，发现没有适合上述所有平台并且允许选择收件人（不仅仅是广播）的东西。也大多数依靠网站来发送推送通知。我需要从应用程序内发送警报。

发送的消息最好是文本，但也可以是语音......因此，Push-to-Talk SDK 可以工作，只要它们与上述所有设备平台兼容，并且在收到它时可以播放响亮的声音然后用户去收听录制的语音信息。

人们建议使用什么：推送通知、短信、电子邮件或其他？？？任何地方都有用于此的 SDK 吗？示例代码？教程？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:33:08.567

任何可以建立 HTTPS 连接的应用程序都可以触发 BlackBerry Push 服务（我使用 Perl 脚本），但您需要有一些看起来像 Web 服务器的东西来支持注册/取消注册协议。不必是完整的服务器，但它确实需要回复获取请求。不使用后端服务器的问题在于注册是一个 24/7 的异步活动，因此您的应用程序必须面向 Internet 并且始终处于运行状态。Web 服务器和 CGI​​ 脚本是一种非常成熟且易于理解的方法。

在 BlackBerry 上，您将想要传递的数据推送到应用程序，然后该应用程序负责采取适当的措施，例如播放响亮的声音。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T18:15:44.293

对于 Android，您可以使用 Google Cloud Messaging (GCM)，对于 Apple 设备，您可以使用 Apple Push Notifications (APN)。这两项服务都将允许您在注册后定位单个设备。GCM 和 APN 相比更易于使用和部署，但是这两个平台的模式非常相似：

1.  向提供商（Google 或 Apple）注册您的应用程序。
2.  在您的应用程序中包含一个密钥。
3.  使用密钥向提供者注册特定设备，接收唯一的设备令牌。
4.  将此令牌与识别信息一起存储在您的 Web 服务中。
5.  在进行推送通知时，您将通知、您的 app-id/key 和设备令牌发送给提供者，然后消息将被发送。
6.  设备收到通知；对于 Apple，它可以在屏幕上显示通知和/或更新应用程序上的徽章。但是，我不记得这些通知是否可以静音。对于谷歌，该应用程序启动并接收来自 Android 的特殊消息，并且可以用它做任何你喜欢的事情——包括调整音量和播放超响亮的警报。

FWIW，黑莓有黑莓推送服务，但我没有为此开发，因为它与我的客户无关。微软有 Azure，它允许类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:50:15.050

推送通知就是为此而设计的。它在 Android 中称为 GCM（以前是 C2DM）。您肯定需要一个后端服务器来发送推送。请注意，推送通常包含非常少的数据，因此应用程序需要“通常”进行后端服务器调用以获取数据。例如，如果用户需要在其父母所在的地方收到火灾通知，则用户将为父母所在的组注册来自后端服务器的推送。这方面的业务逻辑将保存在后端服务器中。推送将通过紧急警报 ID 发送给用户。该应用程序将通过推送被唤醒，并立即向后端服务器询问该 ID 的数据。数据可以是语音文件，应用程序可以在手机允许的最大音量下播放。

如果这是您正在寻找的系统，您可以给我发消息，我可以为您提供一些指导。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T19:54:37.880

特别是对于 iOS，Apple Push Notifications 不会让您为每个单独的推送发送特定的声音消息，也不会强制用户为该通知打开声音。

有些人通过将自己设置为音乐播放应用程序，然后在需要声音之前播放静音，构建了整晚运行的闹钟应用程序（通常是不允许的）。这是一个非常黑客。

# c# - MonoTouch 播放系统声音

> ID：12428523
> 
> 赞同：1
> 
> 时间：2012-09-14T16:30:54.197
> 
> 标签：c#, ios, xamarin.ios, audiotoolbox, system-sounds

当我的警报对话框出现时，我想播放哔声。出现推送通知时如何播放声音？我需要的代码类似于这些链接：

[http://iosdeveloperzone.com/2011/05/23/snippet-playing-a-system-sound/](http://iosdeveloperzone.com/2011/05/23/snippet-playing-a-system-sound/)

我在任何地方都找不到这个 API：

AudioServicesPlaySystemSound

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:18:25.860

在 MonoTouch 中，这个函数被命名为`MonoTouch.AudioToolbox.SystemSound.PlaySystemSound`.

这是一个有关如何从文件播放声音的[示例。](https://stackoverflow.com/q/9905008/220643)

# php - 带有数据库的 DatePicker - 更改日期的颜色

> ID：12428530
> 
> 赞同：0
> 
> 时间：2012-09-14T16:32:11.220
> 
> 标签：php, jquery, database, jquery-ui, datepicker

我有一个包含新闻的数据库（日期 - 描述 - 链接 - 等等..）我想将每个日期的 CSS 更改为 DatePicker 以帮助用户知道哪个日期有新闻。

这是我的代码，我实现了一个过滤器。只需要将 CSS 更改为那些天已加载到我的数据库中。

```
<script>
$(function() {
$(“#datepicker”).datepicker({
changeMonth: true,
changeYear: true,

beforeShowDay: // need help here! 

onSelect: function(selectedDate) {
var mydate;
fecha = $(“#datepicker”).attr(“value”);
$.ajax({
type: “GET”,
url: “news.php”,
data: ‘datepicker=’+mydate,
success: function(data) {
$(‘#result’).html(data);
}
});
}

});
});
</script> 
```

我想我可以用一个函数来做到这一点：`beforeShowDay`，但我不知道怎么做，我正在学习 jQuery，直到现在我在网上冲浪都没有运气。

也许我需要一个数组来从我的数据库中调用数据，这里是我的脚本：

```
<?php

$Host = "localhost";
$User = "root";
$Password = "";
$Base = "mydatabase";

$Link = mysql_connect($Host, $User, $Password) or die("error");

$db = mysql_select_db($Base) or die("Ha fallado la seleccion de la base de datos");

$return_arr = array();

$fetch = mysql_query("SELECT id, mydate, text FROM news"); 

while ($row = mysql_fetch_array($fetch, MYSQL_ASSOC)) {
    $row_array['id'] = $row['id'];
    $row_array['mydate'] = $row['mydate'];
    $row_array['text'] = $row['text'];

    array_push($return_arr,$row_array);
}

echo json_encode($return_arr);
?> 
```

但我现在不知道如何将它调用到我的 DatePicker 中。

希望有人可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T06:00:34.887

我不知道确切的代码，但这可能会有所帮助

首先，您应该找到将日期保存到数据库中的格式。

如果它像 30-1-1970 比你应该过滤

利用

```
$date=date in database;
$newdate=explode("-",$date);

$row['date']=$newdate[0];
$row['month']=$newdate[1];
$row['year']=$newdate[2]; 
```

//将此数据发送到javaacript

```
$.ajax({
type: “GET”,
url: “news.php”,
data: ‘datepicker=’+mydate,
success: function(data) {
var newdata=$.parseJSON[data];

//use a loop foreach (datepicker.date as date)
// if keyexixts(newdata);
// $(this).css("whatever you want");

// this is not a exact loop you should do something like that
//change all css using a ajax call
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T06:17:18.390

你在轨道上，但我认为在这种情况下 ajax 有点矫枉过正。您可以直接在 javascript 中定义数组（因为 json_encode 将输出一个 javascrip 数组），然后在 beforeShowDay 上使用数据来格式化每一天。您失去了动态更新的能力（您必须完全重新加载页面才能更新日期选择器数据）。然后在 beforeShowDay 上，[根据文档返回一个包含 3 个值的数组](http://jqueryui.com/demos/datepicker/#event-beforeShowDay)

像这样的东西：

```
<script type="text/javascript">
var daysData = <?= json_encode($news) ?>; // here you convert your array from PHP to JS
$(function() {
    $('#your_date_picker').datepicker({
        showButtonPanel: true,
        dateFormat: 'dd/mm/yy',
        numberOfMonths: 3,
        regional: 'es',
        onSelect: function(dateText, inst) {
            var url = '<?=$url_to_go?>/';
            $(location).attr('href', url + dateText); // I use the select event to do a redirect
        },
        beforeShowDay: function(date) { // date is the day you are formatting, on a DateTime JS object
            //alert( date.getFullYear() + '-' + date.getMonth() + '-' + date.getDay() );
            var year = date.getFullYear();
            // JS returns months from 0 to 11
            var month = date.getMonth() + 1;
            var day = date.getDate();
            var daySettings = new Array(); // day settings are the settings for the DatePicker plugin to apply to that day's cell // default settings
            daySettings[0] = true; // show the day
            daySettings[1] = 'day_green'; // default css class
            daySettings[2] = ''; // default tooltip
            if(typeof daysData[year] != 'undefined'){
                if(typeof daysData[year][month] != 'undefined'){
                    if(typeof daysData[year][month][day] != 'undefined'){
                        dayData = daysData[year][month][day];
                        //alert( year + '-' + month + '-' + day + '-' + dayType);
                        if (dayData['news'] == true){
                            daySettings[1] = 'day_red';
                        }
                    }
                }
            }
            return daySettings;
        }
    });</script> 
```

在 PHP 端，在输出 JS 之前，您必须将数组格式化为如下形式：

```
while($row = mysql_fetch_array($fetch, MYSQL_ASSOC)){
    $news[$row['year']][$row['month']][$row['day']] = array('news' => 1);
} 
```

您可能也可以通过连接来做这样的事情（其中数组键是整个日期，而不是指向另一个数组的数组键）。

# sql-server-2008 - 带范围的 IIF 表达式

> ID：12428531
> 
> 赞同：0
> 
> 时间：2012-09-14T16:32:12.340
> 
> 标签：sql-server-2008, scope, ssrs-2008, iif

我正在`SSRS 2008 R2`使用`SQL 2008`. 我有一份报告列出了客户使用服务的日期。我已按客户名称分组，详细信息部分是日期。我正在尝试检查特定客户的日期是否重复（已输入两次）。为此，我使用了 IIF 语句。

```
=IIF(Fields!SvcDate.Value,"table1_ClientName"=Previous(Fields!SvcDate.Value,"table1_ClientName", "Khaki", "White")) 
```

如果我在没有范围的情况下运行此表达式，它会正确地为字段着色，但当然，“上一个”部分意味着如果直接在上面的另一个客户端具有相同的日期，则该表达式认为这是“上一个”日期和我得到了背景颜色。所以我需要确保颜色和“以前的”标准仅限于每个客户。上面的表达式给出了一个错误，表明该语句没有 False 部分。所以我在想我的括号错了，但我不知道如何纠正它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T06:52:31.433

```
=iif(Fields!SvcDate.Value = previous(Fields!SvcDate.Value),"Khaki","White") 
```

让我知道“table1_ClientName”是否是数据集名称，并且是要求，我会修改。

# c - 在 DNS 应答中检测 CNAME

> ID：12428537
> 
> 赞同：2
> 
> 时间：2012-09-14T16:32:34.590
> 
> 标签：c, dns, network-programming

我正在尝试创建一个解析 DNS 回复的客户端。

检查 CNAME 记录类型的正确位置是什么？似乎当我对 www.google.com DNS 查找进行wireshark 捕获时，回复会在 picasa.google.com 上进行查找，该回复有一条 CNAME 记录，该记录具有 picasa.l.google.com 名称，因此弄乱了我解析 A 记录类型的代码。

是否有任何示例代码讨论如何在同一回复中解析 CNAME 和 A 记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T11:44:48.673

如果您正在寻找开源实现，我已经使用并扩展了域名中继恶魔[dnrd](http://dnrd.sourceforge.net/)

[使用文件dns.c](http://dnrd.svn.sourceforge.net/viewvc/dnrd/trunk/dnrd/src/dns.c?revision=250&view=markup)中的精确解析代码

寻找 api snprintf_cname

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:04:21.227

好的，如果你想要一个例子，你可以去：

[http://www.binarytides.com/dns-query-code-in-c-with-linux-sockets/](http://www.binarytides.com/dns-query-code-in-c-with-linux-sockets/)

在此代码中，您可以首先设置查询类型（qinfo->qtype）...

在解析自己的响应之后；）

祝你好运...

# mysql - MySQL检查字段是否为空然后运行查询

> ID：12428542
> 
> 赞同：0
> 
> 时间：2012-09-14T16:32:52.793
> 
> 标签：mysql

我正在尝试设置一个 if/else 语句，它将检查一个字段是否为空，然后运行一个插入查询，如果它不为空，它将运行一个更新查询。我知道如果我单独运行这两个查询都是正确的，它们将起作用，但是当我将它们放在我的 if/else 语句中时，它只会在我手动输入 mysql 中的一行时执行更新查询。基本上我可以运行更新查询但不能运行插入。

```
if(!empty($_REQUEST['htype'])){
    $sql = "INSERT INTO fetss.ocs_extended(ocsID, hwTYPE)
        VALUES('" .(int)$_POST['id'] ."', '". $db->quote($_REQUEST['changeTypeID']) ."')";
} else
{
    $sql = "UPDATE fetss.ocs_extended SET hwTYPE = '".$db->quote($_REQUEST['changeTypeID'])."' WHERE ocsID IN (".join(",",$checkedHW).")";
}
    $db->query($sql); 
```

html 代码（我正在使用 smarty，所​​以我将值设置为硬件类型，并在 td 标签中显示该值：

```
<td><input type="hidden" name="htype" value="{$systems[s].hwtype}">{$systems[s].hwtype}  </td> 
```

我也尝试使用 INSERT INTO ON DUPLICATE 等，但它不起作用所以我想我会尝试一个简单的 if/else 语句

任何帮助将不胜感激 ：）

编辑这是我的重复键查询：

```
$sql = "INSERT INTO fetss.ocs_extended(ocsID, hwTYPE)
                                        VALUES('" .(int)$_POST['id'] ."', '". $db->quote($_REQUEST['changeTypeID']) ."')
                                        ON DUPLICATE KEY UPDATE hwTYPE = '".$db->quote($_REQUEST['changeTypeID'])."'"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:47:21.983

如果数据库中没有行，更新将失败...

返回到 ON DUPLICATE KEY。这就是你所追求的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:04:39.857

也许你可以利用 MySQL 的[`REPLACE`](http://dev.mysql.com/doc/refman/5.0/en/replace.html)语法：

```
$sql = "REPLACE INTO fetss.ocs_extended (ocsID, hwTYPE) VALUES ('" .(int)$_POST['id'] ."', '". $db->quote($_REQUEST['changeTypeID']) ."')"; 
```

它就像一个`INSERT INTO`语句一样工作，但是，如果存在您要“替换”的主键，它将删除现有的并插入新的。这可以节省您的 if/else 语句并在单个语句中处理它。

如果设置了，我不确定你的`$checkedHW`变量中有什么`$_REQUEST['htype']`，所以这可能适合也可能不适合你的需要。说到这一点，您检查是否`$_REQUEST['htype']`已设置但从未在您显示的代码中使用它 - 这是有意的吗？

# javascript - javascript函数vs jquery命名空间函数，有什么区别？

> ID：12428544
> 
> 赞同：0
> 
> 时间：2012-09-14T16:32:57.347
> 
> 标签：javascript, jquery

怎么会像下面这样的javascript函数......

```
function stars() {
var mOpacity = $('#area').css('opacity');
if (mOpacity = 1) {

$('#title').find('.stars').animate({"marginTop":"-170px",opacity:1}, 3000)
.animate({opacity: 0}, 400)
.animate({"marginTop":"60px",opacity:0},0, stars);
  }
}
stars(); 
```

...当我尝试做这样的事情时破坏了我的浏览器....

```
$.stars = function() {
var mOpacity = $('#area').css('opacity');
if (mOpacity = 1) {

$('#title').find('.stars').animate({"marginTop":"-170px",opacity:1}, 3000)
.animate({opacity: 0}, 400)
.animate({"marginTop":"60px",opacity:0},0, $.stars());
  }
}
$.stars(); 
```

两种函数风格之间的教训是什么？

谢谢

**好的，根据大家的反馈来查看更多代码，这是我的 .js 文件中代码的完整说明...**

```
function mIntro() {

/********PRE-GAME ANIMATION*********/
$('#area').css({'opacity':0}).delay(1000).animate({opacity:1},300);
$('#title').find('.age').css({'opacity':0}).delay(2000).animate({opacity:1}, 3000);

function stars() {
var mOpacity = $('#area').css('opacity');
if (mOpacity = 1) {

$('#title').find('.stars').animate({"marginTop":"-170px",opacity:1}, 3000)
.animate({opacity: 0}, 400)
.animate({"marginTop":"60px",opacity:0},0, stars);
  } 
}
stars();
}

$(function() {
  mIntro();
}); 
```

我已将 jquery 连接到此 .js 页面，但我只是不明白为什么要在传统的 javascript 函数中插入星号而不是在 jquery 命名空间函数中灵活使用。我敢打赌它与重新调用星星的动画标签有关，但我不确定......

谢谢或任何建议！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:37:53.477

您无意中在第二个片段中调用了它：

```
.animate(..., $.stars()); 
```

您应该以相同的方式对其进行编码：传递函数，而不是调用它的结果：

```
Function:             stars      $.stars
Result of calling:    stars()    $.stars() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:40:00.503

不同之处在于您的第一个示例直接包含在 window 对象中，而第二个示例包含在 jQuery ($) 对象中（注意 $ 对象随后包含在 window 对象中）。至于为什么当你尝试使用 jQuery 命名空间时它会中断，我不能说没有看到你所有的代码，但是 $ 可能没有定义。

# javascript - 使用 signalR 将数组传递给服务器

> ID：12428548
> 
> 赞同：7
> 
> 时间：2012-09-14T16:33:17.440
> 
> 标签：javascript, jquery, signalr, signalr-hub

如何使用 SignalR 将 javascript 中的字符串数组传递给服务器？

我在 javascript 中有一个数组，并希望将其用作集线器的函数

```
var selected = new Array();
$('#checkboxes input:checked').each(function () {
    selected.push($("input").attr('name'));
}); 
```

函数应该采用什么类型的参数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-14T17:53:30.990

hub 函数可以接受一个字符串数组、一个字符串列表等。

这是一个示例集线器：

```
public class myHub : Hub
{
    public void receiveList(List<String> mylist) 
    {
        mylist.Add("z");
        Caller.returnList(mylist);
    }
} 
```

这是一个与集线器一起使用的示例 JS 片段：

```
var myHub = $.connection.myHub,
    myArray = ['a','b','c'];

myHub.client.returnList = function(val) {
    alert(val); // Should echo an array of 'a', 'b', 'c', 'z'
}

$.connection.hub.start(function() {
    myHub.server.receiveList(myArray);
}); 
```

# objective-c - 向应用商店添加新版本

> ID：12428549
> 
> 赞同：1
> 
> 时间：2012-09-14T16:33:18.767
> 
> 标签：objective-c, xcode, app-store

最近我的应用`formwork inspector`进入了应用商店。 [http://itunes.apple.com/us/app/formwork-inspector/id558300132?ls=1&mt=8](http://itunes.apple.com/us/app/formwork-inspector/id558300132?ls=1&mt=8) 现在我想添加它的新版本，即 1.1，这意味着我将不得不再次上传二进制文件. 添加二进制文件后，我的二进制文件是否会像第一次一样重新审核，一旦 1.1 版本可用，它会取代 1.0 还是 1.0 之后仍然可以在应用商店中使用？我不希望它可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:41:41.580

您将在 iTunes Connect 中为 1.1 创建一个新版本，然后上传新的 1.1 二进制文件。然后它将像 1.0 一样通过审核。经批准后，它将取代 1.0，并且 1.0 将不再可从应用商店获得。

# objective-c - 自定义 UITableViewCell 中的多个 UITextField

> ID：12428550
> 
> 赞同：2
> 
> 时间：2012-09-14T16:33:20.800
> 
> 标签：objective-c, uitableview, custom-cell, becomefirstresponder

我有一个 UITableView，它有 2 个不同的 customcell 定义。一个是单个 UITextField，另一个是 4 个 UITextField

userInteractionEnabled 手动设置为启用单元格级触摸导航，并且我在 didSelectRowAtIndexPath 中处理 UI 交互到相关单元格的第一响应者

当我只使用一个自定义单元格 (EditableCustomCell) 和一个 UITextField (editableTextField) 时，这一切都很好，但现在我有一个自定义单元格 (LatLonCustomCell) 和 4 个 UITextFields（度、分、秒、笛卡尔），我无法确定哪个字段有被触摸以设置 becomeFirstResponder

（目前我在调试期间默认使用第一个名为 degree 的文本字段）

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{      
  [prevField resignFirstResponder];
  prevField.userInteractionEnabled = NO;

  if(indexPath.section == kFirstSection && (indexPath.row == kLatitudeRow || indexPath.row == kLongitudeRow)) {
    LatLonCustomCell *customCell = (LatLonCustomCell *)[MyTableView cellForRowAtIndexPath:indexPath];
    currField = customCell.degrees; // need to set correct field here
  } else {
    EditableCustomCell *customCell = (EditableCustomCell *)[MyTableView cellForRowAtIndexPath:indexPath];
    currField = customCell.editableTextField;
  }

  currFieldIndexPath = [NSIndexPath indexPathForRow:indexPath.row inSection:indexPath.section];
  currField.userInteractionEnabled = YES;
  [currField becomeFirstResponder]; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T12:42:10.987

好的，所以对于那些遇到相同或相似问题的人，我终于取得了突破

我决定在调用 didSelectRowAtIndexPath 之前需要捕获触摸的 X/Y 坐标。这样我就可以通过检查触摸文本字段的“边界”来确定触摸发生在哪个 UITextField

经过一些随机搜索，我发现在视图控制器中捕获任何触摸事件的非常简单的方法（因为 touchesBegan 只发生在自定义覆盖的 UITableViewCell 类中，我不知道如何将它传递回链 Cell > TableView > Scroll View >控制器）

通过将其添加到 viewDidLoad 方法：

```
UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTapGesture:)];
tapGesture.numberOfTapsRequired = 1;
// Pass the tap through to the UITableView
tapGesture.cancelsTouchesInView = NO;
[self.view addGestureRecognizer:tapGesture]; 
```

这会捕获所有的触摸，调用`handleTapGesture`方法

然后在这个方法中，它只是检查触摸是否在 tableview 的边界内的情况，如果是，确定触摸点的 indexPath，然后检查所需对象的边界，下面是一个简化版本我想出什么

```
-(void)handleTapGesture:(UITapGestureRecognizer *)tapGesture {

  CGPoint tapLoc = [tapGesture locationInView:self.tableView];

  if([MyTableView indexPathForRowAtPoint:tapLoc]) {
    // Tap still handled by the UITableView delegate method

    NSIndexPath *indexPath = [MyTableView indexPathForRowAtPoint:tapLoc];

    if(indexPath.section == 0 && (indexPath.row == kLatitudeRow || indexPath.row == kLongitudeRow)) {
      LatLonCustomCell *customCell = (LatLonCustomCell *)[MyTableView cellForRowAtIndexPath:indexPath];
      UIScrollView *scrollView = (UIScrollView *)self.view;
      CGRect rc;

      // Degrees
      rc = [customCell.degrees convertRect:[customCell.degrees bounds] toView:scrollView];

      if (tapLoc.x >= rc.origin.x && tapLoc.y >= rc.origin.y && tapLoc.x <= (rc.origin.x + rc.size.width) && tapLoc.y <= (rc.origin.y + rc.size.height)) {
        NSLog(@"touch within bounds for DEGREES");
        touchField = customCell.degrees;
      }

// Repeat for other textfields here ....

.... 
```

在我的代码中，我将字段保存在 touchField 中，就像在 didSelectRowAtIndexPath 代码中一样，我已经在处理 prevField/currField 值以控制启用/禁用`userInteractionEnabled`并将 currField 设置为`becomeFirstReponder`

希望这对某人有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:00:08.530

过去，当我需要检查文本框是否被触摸时，我检查了 YourTextField.text.length 是否 > 0。如果是，您可以设置 becomeFirstResponder。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T03:22:11.143

你有没有想过使用 NSNotificationCenter 来请求 UITextFieldTextDidBeginEditingNotification 的通知？

在 viewDidLoad

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(textFieldBeganEditing) 
                                             name:UITextFieldTextDidBeginEditingNotification object:nil]; 
```

然后像

```
-(void) textFieldBegainEditing: (NSNotification*) notification {
  // [notification object] will be the UITextField
  // do what you need to do with it (resign, become first responder)
} 
```

# java - 使用 .jar 删除文件

> ID：12428551
> 
> 赞同：1
> 
> 时间：2012-09-14T16:33:38.503
> 
> 标签：java, file, jar, delete-file

我有一个名为 install.jar 的 .jar 文件，它将各种文件类型复制到 %appdata%/folder/abc/

我需要的是一种删除文件的方法，无论是使用相同的 jar 还是新的，所以我可以重置应用程序以进行更新。我查看了 SO 和 google，但没有找到答案。

如果java不允许你删除文件夹，我需要一种方法来删除文件夹内的所有文件，或者至少重命名文件夹。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:36:31.510

```
// Deletes all files and subdirectories under dir.
// Returns true if all deletions were successful.
// If a deletion fails, the method stops attempting to delete and returns false.
public static boolean deleteDir(File dir) {
    if (dir.isDirectory()) {
        String[] children = dir.list();
        for (int i = 0; i < children.length; i++) {
            boolean success = deleteDir(new File(dir, children[i]));
            if (!success) {
                return false;
            }
        }
    }

    // The directory is now empty so delete it
    return dir.delete();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:39:54.400

您可以在此链接中找到一些有用的信息。这是以前问过的。

访问 <[有没有一种快速的方法可以从 Jar/war 中删除文件，而无需提取 jar 并重新创建它？](https://stackoverflow.com/questions/4520822/is-there-a-quick-way-to-delete-a-file-from-a-jar-war-without-having-to-extract)>

# python - 功能制作

> ID：12428560
> 
> 赞同：4
> 
> 时间：2012-09-14T16:34:04.520
> 
> 标签：python, functional-programming

嗨，我是函数式编程的新手。我所做的是

```
>>> g=lambda x:x*2
>>> f=g
>>> g=lambda x:f(f(x))
>>> g(9)
36 
```

现在，它不是`g`作为非终止递归函数创建的 -`g(x)`被转换为一个新函数，它给出了 result `g(g(x))`。

```
>>> f=g
>>> g=lambda x:f(f(x))
>>> f(8)
RuntimeError: maximum recursion depth exceeded 
```

根据 g(x) 的第一个定义，我希望`g`被转换成一个给出结果的函数。`g(g(g(x)))`为什么不呢？是否有可能以这种方式创建一个导致`g(g(g(...(g(x))....)))`一定次数迭代的新函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T16:37:51.510

当你`f = g`第二次这样做时， f 变为`lambda x: f(x)`。闭包是按名称创建的，而不是按值创建的。

* * *

借助辅助函数，这变得很容易：

```
def compose(f, g):
    return lambda x: f(g(x))

square = lambda x:x*2
g = square
for i in xrange(4):
    g = compose(g, square) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T16:50:20.597

在 python 中，变量是映射到值的名称，而不是值本身（一切都是引用）。此外，您可以将 lambda 视为存储可以评估的文本。下面将说明

```
a = 2
f = lambda x: a*x
f(2) # This gives 4
a = 3
f(2) # This gives 6 
```

这应该清楚为什么你会得到无限递归。

在回答你关于递归的问题时，这里有一个小技巧可以做

```
g = lambda x, n: n > 0 and g(x, n-1)**2 or x 
```

那么`g(2,3)`将是`(((2)^2)^2)^2 = 256`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T16:57:59.187

这

```
g=lambda x:x*2
f=g
g=lambda x:f(x) 
```

相当于：

```
f=lambda x:x*2
g=lambda x:f(x) 
```

当您调用 时`g`，您会得到`f`在全局（或封闭）范围内定义的任何内容。

你期待的是这样的：

```
f=lambda x:x*2
g=lambda x, f=f:f(x) 
```

`lambda` *这会在计算表达式*时捕获外部范围内的 f值。

# android - Android Intent 响应不一致

> ID：12428561
> 
> 赞同：0
> 
> 时间：2012-09-14T16:34:11.233
> 
> 标签：android, android-intent

我有一个注册接收图像的应用程序。我可以打开图库或相机，选择一张图片，然后在我的 onResume 中获得 ACTION_SEND 意图，一切都很棒。如果我使用后退按钮，我可以返回图库或返回主屏幕并选择不同的应用程序来发送图像，这也可以。

但是，如果我使用 Home 按钮，那么下次应用程序由图像 Intent 启动时，当它进入 onResume 时，我会得到一个没有图像的 MAIN Intent。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:26:11.017

你应该压倒一切`onNewIntent()`，而不仅仅是等待`onResume()`。如果您的活动被带回前台以不同于`Intent`创建它的活动，`onNewIntent()`则应该调用它来为您提供`Intent`. 但是，`getIntent()` *不会改变*，并且会更旧一些`Intent`，无论用于触发活动的创建。

# python - 如何在python中打印没有ASCII字符的字符串？

> ID：12428562
> 
> 赞同：2
> 
> 时间：2012-09-14T16:34:10.207
> 
> 标签：python, django

我有以下字符串：

```
teststring= "&sect" 
```

当我在 Django 中用 python 打印它时，我不断得到一个奇怪的符号。如何使它消除字符串到 ASCII 符号的转换并将其视为文字字符串“§”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:36:00.343

您的浏览器将`&sect`值解释为`&sect;`，节字符：§

您需要转义与符号`&amp;sect`以防止这种情况发生：

```
teststring = "&amp;sect" 
```

Django 模板可以使用[转义过滤器](https://docs.djangoproject.com/en/stable/ref/templates/builtins/#escape)为您进行转义，或者您可以使用以下[`cgi.escape()`功能](http://docs.python.org/library/cgi.html#cgi.escape)：

```
teststring = cgi.escape("&sect") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:36:12.850

在模板中使用 django 的[转义过滤器。](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#escape)就像是：

```
<b>check out my string: {{ teststring|escape }}</b> 
```

或者打开[自动转义](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#autoescape)。

# php - PHP“在非对象上调用成员函数 execute()”

> ID：12428563
> 
> 赞同：1
> 
> 时间：2012-09-14T16:34:12.483
> 
> 标签：php, mysql, mysqli

我目前有一个非常奇怪的问题。我的网站上有这段代码：

```
// Load the menu links from the database
$result = $dbc->prepare('SELECT id, linktext, visible, sort FROM content ORDER BY sort');
var_dump($result);
$result->execute();
$result->bind_result($id, $menu_linktext, $menu_visible, $menu_sort);
while ($row = $result->fetch()) {
// If the link is visible create the link
if ($menu_visible == '1') {
    $menu_linktext_ = str_replace(' ','_',$menu_linktext);
    echo "<li><a href='?page=$menu_linktext_'>$menu_linktext</a></li>";
}
} 
```

var_dump 返回 bool(false)。这意味着以某种方式与数据库没有连接，但在同一页面上我有完全相同的代码并且它没有问题。

# c# - 将枚举值传递给函数

> ID：12428564
> 
> 赞同：2
> 
> 时间：2012-09-14T16:34:13.850
> 
> 标签：c#, enums, enumerators

假设我有一个以整数作为参数的函数。我希望能够使用枚举列表来保持整数值的组织。

例如，理想情况下，我希望能够定义这些（伪代码）：

```
public enum days
{
    monday,
    tuesday,
    etc...
}

public enum months
{
    january,
    february,
    etc...
}

int doSomething(enum x)
{
    return x + 1;
} 
```

然后能够使用以下任一枚举列表调用该函数：

```
int a = doSomething(days.monday);
int y = doSomething(months.february); 
```

这显然不会按原样工作，因为 doSomething 需要仅使用其中一个枚举（即几天或几个月）来定义。我知道几个选项。一种是简单地转换为 int：

```
int a = doSomething((int)days.monday);
int y = doSomething((int)months.february); 
```

唯一的问题是这个函数在我的代码中被调用了很多地方，并且不得不一直将“（int）”放在所有地方是很笨拙的（将这些 int 值组合成枚举的主要动机之一首先是使代码更具可读性）。

另一种选择是完全避免枚举，而是将值捆绑到容器类中，例如：

```
static class Days
{
    static int x = 0;

    static int monday = x++;
    static int tuesday = x++;
} 
```

同样，这会起作用，但是当我有很多这些容器类要定义时，这似乎非常麻烦。

答案很可能是没有更简单的方法，我需要成为一个成年人并接受其中一种选择。但我想我会在承诺之前对此进行全面检查。有第三种选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:37:12.963

你的问题是什么？

```
public enum Days : short
{
    Monday = 1,
    Tuesday = 2,
    ...
}

DoSomething(Days.Monday);

void DoSomething(Days day)
{
    Days nextDay = day + 1;
} 
```

还要注意[已经内置的枚举 System.DayOfWeek](http://msdn.microsoft.com/en-us/library/system.dayofweek.aspx)。

* * *

我得到了 OP 的观点，但是 C# 还不支持这点：

```
void DoSomething<T>(T e) where T : enum
{
    T next  = e + 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:18:55.333

```
public enum days : int 
{ monday, tuesday,

}

public enum months :int
{ january, february, march,

}

public  int doSomething(int z)
{
  return z + 1;
} 
```

// 你的调用方法 int c = ee.doSomething((int)testenums.months.march); int c = ee.doSomething((int)testenums.day.February);

工作代码，因为你总是传递枚举并且它是 int 类型，你只需要解析和发送这个代码就可以完美地工作..让我知道

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:47:38.757

你可以重载你的方法，如果你真的只想要 int 值，也许是这样的？

```
int dosomething(enum x)
{return dosomething((int)x)}
int dosomething(int x)
{return x+1} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-19T11:44:27.347

我在这上面花了“一点”时间，因为遇到了同样的问题（解决方案）。所以这是我的解决方案，在（.NET 4）Windows 窗体上运行良好：

```
VB:NET

           Private Function DoSomething(Of TEnum As {IComparable, IConvertible, IFormattable})(ByVal valueEnum As TEnum) As Int32

              Dim i As Int32 = CInt(Convert.ChangeType(valueEnum, valueEnum.GetTypeCode()))
              //Do something with int
              i += 1
              Return i

           End Function

    C#

        private int DoSomething<TEnum>(TEnum valueEnum) where TEnum: IComparable, IConvertible, IFormattable 
                    {
                        int i = 0;
                        i = (int)Convert.ChangeType(valueEnum, valueEnum.GetTypeCode());
                        i++;
                        return i;
                    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T16:58:17.827

或者，如果您不想更改所有现有枚举：

```
 public static int DoSomething(Enum x) 
    {
        int xInt = (int)Convert.ChangeType(x, x.GetTypeCode());
        DoSomething(xInt);
    } 
```

如此处所述：[enums-returning-int-value](https://stackoverflow.com/questions/943398/enums-returning-int-value)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-14T16:37:15.927

是的，你可以这样做

```
public enum days : int
{
    monday,
    tuesday,
    ...
} 
```

星期一自动变为 0，星期二变为 1，依此类推

```
public enum months : int
{
    january,
    february,
    ...
} 
```

几个月都一样

```
int doSomething(Enum x)
{
    return (int)x + 1;
} 
```

并将其称为

```
int a = doSomething(days.monday); 
```

或称其为

```
int a = doSomething(months.january); 
```

现在`days.monday equals 0`和之后方法`a`变为1。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-14T16:37:24.777

有什么问题[`System.DateTime`](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)吗？

这将是最实用的类型。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-14T17:16:52.627

您是否尝试通过参数重载函数：

```
int DoSomething(Enum1 value)
int DoSomething(Enum2 value) 
```

# numpy - 了解 Numpy 内部结构以进行分析

> ID：12428566
> 
> 赞同：4
> 
> 时间：2012-09-14T16:34:18.100
> 
> 标签：numpy, profiling

分析一段 numpy 代码表明我大部分时间都花在这两个函数上

```
numpy/matrixlib/defmatrix.py.__getitem__:301
numpy/matrixlib/defmatrix.py.__array_finalize__:279 
```

这是 Numpy 的源代码：

*   [https://github.com/numpy/numpy/blob/master/numpy/matrixlib/defmatrix.py#L301](https://github.com/numpy/numpy/blob/master/numpy/matrixlib/defmatrix.py#L301)
*   [https://github.com/numpy/numpy/blob/master/numpy/matrixlib/defmatrix.py#L279](https://github.com/numpy/numpy/blob/master/numpy/matrixlib/defmatrix.py#L279)

**问题一：**

`__getitem__`似乎每次我使用类似的东西时都会被调用，如果不是整数而是切片`my_array[arg]`，它会变得更加昂贵。`arg`有什么方法可以加快对数组切片的调用？

例如在

```
for i in range(idx): res[i] = my_array[i:i+10].mean() 
```

**问题2：**

究竟什么时候`__array_finalize__`被调用，如何通过减少对该函数的调用次数来加快速度？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-14T17:21:29.497

您不能尽可能多地使用矩阵，而只能使用 2d numpy 数组。我通常只在短时间内使用矩阵来利用乘法语法（但是随着在数组上添加 .dot 方法，我发现我这样做的次数越来越少）。

但是，对于您的问题：

1）真的没有捷径，`__getitem__`除非defmatrix覆盖`__getslice__`它可以做但还没有。.item 和 .itemset 方法针对整数获取和设置进行了优化（并返回 Python 对象而不是 NumPy 的数组标量）

2)`__array_finalize__`在创建数组对象（或子类）时调用。它是从 C 函数调用的，每个数组创建都会通过该函数进行调用。 [https://github.com/numpy/numpy/blob/master/numpy/core/src/multiarray/ctors.c#L1003](https://github.com/numpy/numpy/blob/master/numpy/core/src/multiarray/ctors.c#L1003)

对于纯粹在 Python 中定义的子类，它从 C 回调到 Python 解释器，这有开销。如果矩阵类是内置类型（例如，基于 Cython 的 cdef 类），则调用可以避免 Python 解释器开销。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T17:43:37.010

**问题一：**

由于数组切片有时可能需要底层数据结构的副本（在内存中保存指向数据的指针），因此它们可能非常昂贵。如果您在上面的示例中确实遇到了瓶颈，您可以通过实际迭代 i 到 i+10 个元素并手动创建均值来执行均值运算。对于某些操作，这不会带来任何性能改进，但避免创建新的数据结构通常会加快进程。

另一个注意事项，如果您没有在 numpy 中使用本机类型，则操作 numpy 数组会导致非常大的性能损失。假设您的数组具有 dtype=float64 并且您的本机机器浮点大小为 float32 - 这将花费大量额外的计算能力 numpy 并且整体性能会下降。有时这很好，您只需为维护数据类型而努力。其他时候，float 或 int 在内部存储的类型是任意的。在这些情况下，请尝试使用 dtype=float 而不是 dtype=float64。Numpy 应该默认为您的本机类型。通过进行此更改，我在 numpy 密集型算法上获得了 3 倍以上的加速。

**问题2：**

`__array_finalize__` "is called whenever the system internally allocates a new array from obj, where obj is a subclass (subtype) of the (big)ndarray" according to [SciPy](http://www.scipy.org/Subclasses). Thus this is a result described in the first question. When you slice and make a new array, you have to finalize that array by either making structural copies or wrapping the original structure. This operation takes time. Avoiding slices will save on this operation, though for multidimensional data it may be impossible to completely avoid calls to `__array_finalize__`.

# android - 使用样式构造 ImageView 导致宽度和高度为 0

> ID：12428569
> 
> 赞同：2
> 
> 时间：2012-09-14T16:34:28.193
> 
> 标签：android, styles, imageview

我创建了两种样式，称为 bullet_normal 和 bullet_active。我将这些项目符号的实例作为 ImageViews 添加到 LinearLayout。当我像这样将它们添加到 XML 中时，一切正常：

```
<LinearLayout android:id="@+id/bar_bullets"
    android:layout_width="wrap_content" android:layout_height="@dimen/gsbar_height"
    android:layout_centerVertical="true" android:layout_centerHorizontal="true"
    android:layout_margin="0dp" android:padding="3dp">
    <ImageView style="@style/bullet_normal"></ImageView>
    <ImageView style="@style/bullet_active"></ImageView>
</LinearLayout> 
```

但我需要能够以编程方式将这些添加到 LinearLayout 中。我正在尝试这样：

```
 ImageView normal = new ImageView(this.getContext(), null, R.style.bullet_normal)
    ,       active =  new ImageView(this.getContext(), null, R.style.bullet_active);
    bulletContainer.addView(active);
    bulletContainer.addView(normal); 
```

但这总是会导致 ImageViews 的宽度和高度等于 0。两种样式的代码都与此类似：

```
 <style name="bullet_normal">
       <item name="android:layout_width">10dip</item>
       <item name="android:layout_height">10dip</item>
       <item name="android:src">@drawable/gsbar_bullet</item>
       <item name="android:layout_margin">6dip</item>
       <item name="android:background">#000000</item>
   </style> 
```

并且drawables看起来像：

```
<shape android:shape="oval"  xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/gsbar_bullet" />
    <stroke android:width="1dp" android:color="@color/gsbar_bullet_border" />
</shape> 
```

我是否需要更改我的 bullet_normal 和 bullet_active 样式，还是我错误地构建了 ImageViews？

提前致谢！

# javascript - 如何使用 angular.js 在 DOM 中移动视图？

> ID：12428570
> 
> 赞同：4
> 
> 时间：2012-09-14T16:34:29.450
> 
> 标签：javascript, angularjs

如何使用 Angular js 将元素移动到 DOM 中的不同位置？

我有一个这样的元素列表

```
<ul id="list" ng-controller="ListController">
    <li ng-controller="ItemController"><div>content</div></li>
    <li ng-controller="ItemController"><div>content</div></li>
    <li ng-controller="ItemController"><div>content</div></li>
    <li ng-controller="ItemController">
        <div>content</div>
        <div id="overlay"></div>
    </li>
</ul> 
```

我要完成的是将#overlay 在列表中从一个位置移动到另一个位置，而不必在我标记为隐藏/未隐藏的每个项目中都有隐藏的重复项。

如果这是 jquery 我可以做这样的事情：

```
$("#overlay").appendTo("#list li:first-child"); 
```

有没有等效的方法可以在角度上做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-14T19:34:01.297

感谢您的澄清，我可以理解您有一个项目清单。您希望能够在此列表中选择一个项目（滑动但可能还有其他事件），然后为所选项目显示一个额外的 DOM 元素 (div)。如果另一个项目被选中，它应该被取消选择 - 这样只有一个项目应该显示一个额外的 div。

如果上述理解是正确的，那么您可以使用简单的 ng-repeat 和 ng-show 指令来解决这个问题，如下所示：

```
<ul ng-controller="ListController">
    <li ng-repeat="item in items">
        <div ng-click="open(item)">{{item.content}}</div>
        <div ng-show="isOpen(item)">overlay: tweet, share, pin</div>
    </li>
</ul> 
```

控制器中的代码将在哪里（仅显示它的一个片段）：

```
$scope.open = function(item){
    if ($scope.isOpen(item)){
        $scope.opened = undefined;
    } else {
        $scope.opened = item;
    }        
};

$scope.isOpen = function(item){
    return $scope.opened === item;
}; 
```

这是完整的 jsFiddle：http: [//jsfiddle.net/pkozlowski_opensource/65Cxv/7/](http://jsfiddle.net/pkozlowski_opensource/65Cxv/7/)

如果您担心 DOM 元素过多，您可以使用 ng-switch 指令实现相同的效果：

```
<ul ng-controller="ListController">
    <li ng-repeat="item in items">
        <div ng-click="open(item)">{{item.content}}</div>
        <ng-switch on="isOpen(item)">
            <div ng-switch-when="true">overlay: tweet, share, pin</div>
        </ng-switch>        
    </li>
</ul> 
```

这是 jsFiddle：http: [//jsfiddle.net/pkozlowski_opensource/bBtH3/2/](http://jsfiddle.net/pkozlowski_opensource/bBtH3/2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T02:40:44.537

作为读者（我）的练习，我想尝试使用自定义指令来完成此操作。这是我想出的（经过多次失败的尝试）：

```
<ul ng-controller="ListController">
    <li ng-repeat="item in items">
        <div singleton-overlay>{{item.content}}</div>
    </li>
</ul> 
```

需要服务来存储当前具有覆盖的元素（如果有）。（我决定不为此使用控制器，因为我认为“服务+指令”会比“控制器+指令”更可重用。）

```
service('singletonOverlayService', function() {
    this.overlayElement = undefined;
}) 
```

和指令：

```
directive('singletonOverlay', function(singletonOverlayService) {
    return {
        link: function(scope, element, attrs) {
            element.bind('click', moveOrToggleOverlay);

            function moveOrToggleOverlay() {
                if (singletonOverlayService.overlayElement === element) {
                    angular.element(element.children()).remove();
                    singletonOverlayService.overlayElement = undefined;
                } else {
                    if (singletonOverlayService.overlayElement != undefined) {
                        // this is a bit odd... modifying DOM elsewhere
                        angular.element(singletonOverlayService.overlayElement.children()).remove();
                    }
                    element.append('<div>overlay: tweet, share, pin</div>')
                    singletonOverlayService.overlayElement = element; 
```

jsFiddle：http: [//jsfiddle.net/mrajcok/ya4De/](http://jsfiddle.net/mrajcok/ya4De/)

我认为这个实现有点不合常规，不过……该指令不仅修改了与它自己的元素相关联的 DOM，而且还可能修改了与当前具有覆盖的元素相关联的 DOM。

我尝试在作用域上设置 $watches 并让单例存储和修改作用域对象，但是当我从 moveOrToggleOverlay 函数内部更改作用域时，我无法触发 $watches。

# php - wordpress 标签存档，使用自定义帖子类型排序

> ID：12428572
> 
> 赞同：1
> 
> 时间：2012-09-14T16:34:34.477
> 
> 标签：php, wordpress, sorting, filter

我将此代码添加到 funtions.php

```
function tc_tag_for_cpt($query) {
  if(is_tag() && empty( $query->query_vars['suppress_filters'] ) && !is_admin()) {
    $post_type = get_query_var('post_type');
    $post_type = ($post_type) ?  $post_type : array('resources','post','page');     //,'nav_menu_item'
    $query->set('post_type',$post_type);
    return $query;
  }
}
add_filter( 'posts_orderby', 'sort_query_by_post_type', 10, 2 );
function sort_query_by_post_type( $sortby, $thequery ) {
    if(is_tag() && empty( $query->query_vars['suppress_filters'] ) && !is_admin()) {
        $thequery->set('orderby','post_type');
        if ( !empty($thequery->query_vars['post_type']) && isset($thequery->query_vars['orderby']) && $thequery->query_vars['orderby'] == 'post_type' )
            $sortby = "find_in_set(post_type, '" . implode( ',', $thequery->query_vars['post_type'] ) . "')";
    }
    return $sortby;
} 
```

它应该在按帖子类型排序的标签存档上显示结果（资源是自定义帖子类型）。它会这样做，但屏幕顶部会出现一条错误消息：

“警告：implode() [function.implode]：第 279 行 /home/csleh3/public_html/sandbox/wp-content/themes/aodmarketing/functions.php 中传递的参数无效”

这是“内爆”线。

我的目标是让标签存档上的结果按帖子类型而不是日期或标题对列表进行排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:59:32.470

`$thequery->query_vars['post_type']`将返回特定的 post_type 作为字符串，如`post`. 你不能把它内爆。

您应该能够删除有关尝试内爆它的部分：

```
$sortby = "find_in_set(post_type, '" . $thequery->query_vars['post_type'] . "')"; 
```

# java - 将程序作为 jar 文件运行

> ID：12428574
> 
> 赞同：2
> 
> 时间：2012-09-14T16:34:44.897
> 
> 标签：java, jar

我在 Windows 7 64 位上运行的**Java SE 版本 7**中有 Java GUI 应用程序。当我尝试单击 jar 文件运行它时，弹出窗口说“**找不到主类或加载它：...** ”。当我以这种方式通过命令行运行相同的 jar 文件时：**java -jar app.jar' 它工作正常**。如果您尝试以这种方式运行它：**'java app.jar' 它会抛出相同的错误**。在 Eclipse IDE 上它工作正常。jar 文件已由 Eclipse IDE 创建为 Running jar 文件。我用简单的 GUI 又创建了一个项目。它和上面的例子有同样的问题。可能是什么问题？我的目标是在您单击 jar 文件后运行该应用程序。最好的祝福

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T17:21:27.217

听起来在您的系统上，`.jar`扩展已注册为使用 Java6 运行，而您的应用程序需要 Java7。

在命令行上键入以下命令以了解`.jar`扩展是如何注册的：

```
assoc .jar 
```

它将显示如下内容：

```
.jar=jarfile 
```

（注意：在您的系统上，它可能是不同的类型名称。后面的任何内容`=`都是您需要使用的类型名称）

现在您需要使用以下命令找出与 typename 关联的命令`jarfile`：

```
ftype jarfile 
```

在我的系统上显示：

```
jarfile="C:\Programme\Java\jre7\bin\javaw.exe" -jar "%1" %* 
```

如果这**不**指向 Java7 安装，您需要更改它，例如通过`ftype`命令或通过控制面板。

您还可以使用控制面板中的“Java”小程序来切换默认的 Java VM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:24:37.003

您需要在 Meta-INF 文件夹下创建一个清单文件。如果那里已经有一个，请添加该行

```
main-class: [class name].class 
```

并尝试一下（不确定冒号后是否应该有一个空格）

# crc - 多个小型 CRC 校验还是单个大型 CRC 校验？

> ID：12428575
> 
> 赞同：1
> 
> 时间：2012-09-14T16:34:47.127
> 
> 标签：crc, error-detection, crc16

假设我有 L = 1024 位来保护使用 16 个额外位的 CRC 校验。我可以选择使用 16 CRC-1（单奇偶校验）或 CRC-16 校验。就错误检测能力而言，哪个选项更好？

对于 16 CRC-1，如果任何 CRC-1 失败，我们的错误将被声明。换句话说，要通过 CRC 校验，所有的 CRC-1 校验都应该通过；否则，将声明错误。

多CRC-1系统实现如下。1024 位分为 16 组，每组 64 位，每个 16 位组附加一个奇偶校验位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T23:25:27.283

CRC-16 会好很多。您的 16 个 CRC-1 可以检测 16 个错误，但前提是每个错误恰好恰好落在自己的块中。如果 16 个错误中的任何一个在同一个块中配对，它们将相互抵消并且不会被检测到。

另一方面，例如，CRC-16 将检测 16 位内突发中发生的 1 到 16 个一位错误。

# c# - ReSharper 中是否有不删除我放在命名空间和类定义之间的空行的选项？

> ID：12428579
> 
> 赞同：9
> 
> 时间：2012-09-14T16:34:59.450
> 
> 标签：c#, resharper

每次我让 ReSharper 格式化我的代码时，它都会删除我在命名空间和类声明之间放置的空行。

由此：

```
namespace Test {

  public class Test { 
```

对此：

```
namespace Test {
  public class Test { 
```

它对两者的右大括号处的空行做同样的事情。我所有的“空白行”设置都设置为 1，除了单行字段。

有没有我错过的选项？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2016-06-28T15:26:34.243

这实际上是现在的一种选择（截至 2016 年 6 月）。去`ReSharper | Options -> Code Editing | C# | Formatting style | Other`检查`Line feed at end of file`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-06-29T10:09:20.483

视觉工作室菜单：`ReSharper > Options...`

在搜索框中输入“文件末尾的换行符”：

[![锐器 2018.1.2](../Images/454c5ce37169a13a51758edc5720bb02.png)](https://i.stack.imgur.com/OI33S.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-30T17:51:38.643

Fsck，比我早10分钟。好吧，无论如何我都会回答。坏消息是这是一个长期的功能请求[http://youtrack.jetbrains.com/issue/RSRP-74903](http://youtrack.jetbrains.com/issue/RSRP-74903)

好消息是它将在明天的 7.1 EAP 版本中修复。将有新的选择`ReSharper | Options -> Code Editing | C# | Formatting style | Blank Lines`：

1.  `Remove blank lines after "{" and before "}" in declarations`（将其关闭以防止 ReSharper 删除空白行）和
2.  `Around namespace`和`Around type`（将其设置为非零值以强制 ReSharper 添加空行）。

# ruby-on-rails - ActiveRecord 模型名称的约定

> ID：12428584
> 
> 赞同：2
> 
> 时间：2012-09-14T16:35:14.833
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, naming-conventions, naming

Rails 中模型的命名约定是什么？如果我的模型是关于飞行汽车的，以下哪个类名最合适？

```
class FlyingCar < ActiveRecord::Base
  attr_accessible :model, :max_speed
end

class Flying_Car < ActiveRecord::Base
  attr_accessible :model, :max_speed
end

class Flying_car < ActiveRecord::Base
  attr_accessible :model, :max_speed
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T16:37:12.947

FlyingCar 是 Ruby 约定。当 ActiveRecord 试图发挥它的魔力时，这一点变得更加重要。您可以通过多种方式覆盖此行为，但使用 FlyingCar 是 ActiveRecord 所期望的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T20:19:14.120

您的模型类名称必须是 PascalCase (FlyingCar)**并且**必须是单数。

对于控制器类，它是 PascalCase，复数，**并**以 Controller 结尾（例如：FlyingCarsController）

# plugins - 如何在 Jenkins 中使用 ANSIcolor 插件？

> ID：12428585
> 
> 赞同：47
> 
> 时间：2012-09-14T16:35:14.510
> 
> 标签：plugins, jenkins, ansi-colors

我已经为 Jenkins 安装了 ANSI-color 插件。在作业中，我使用默认配置文件“xterm”激活了该插件。

从批处理文件（Windows 平台）打印到日志时，我无法弄清楚如何为控制台日志的输出着色。

上的文档

[https://wiki.jenkins-ci.org/display/JENKINS/AnsiColor+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/AnsiColor+Plugin)

没有帮助。没有示例如何实际进行彩色打印。

我尝试了几种不同的回显/打印命令，但我无法让颜色起作用。

任何提示表示赞赏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-10T16:52:04.973

ANSI-color 插件将您的控制台输出转换为 HTML。如果您的输出包含 ansi 转义序列，那么它将这些特殊字符序列转换为（彩色）HTML。您只能通过“ANSI 颜色映射”配置映射。

示例：
**\x1b[31m**将 html 颜色转换为红色

看起来您的程序没有使用转义序列。但是，如果您编写了自己的软件或脚本，则可以使用这些 Escape 序列。

第一个示例 BASH：

```
echo -e "\033[31mRed\033[0m" 
```

第二个例子 BASH：

```
printf "\033[31mRed\033[0m" 
```

如果需要，必须在 printf 中添加换行符：

```
printf "\033[31mRed\033[0m\n" 
```

更多转义序列：
英语： [http](http://en.wikipedia.org/wiki/ANSI_escape_code)
://en.wikipedia.org/wiki/ANSI_escape_code 德语： [http://de.wikipedia.org/wiki/Escape-Sequenz](http://de.wikipedia.org/wiki/Escape-Sequenz)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-21T16:08:33.173

这里有更多关于 Jenkins-ANSIcolor 插件的文档： [https ://github.com/dblock/jenkins-ansicolor-plugin](https://github.com/dblock/jenkins-ansicolor-plugin)

我没有看到颜色，因为我使用的是“高强度”颜色（在 90 年代范围内）并且这些不受支持。必须坚持 30 年代的颜色

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-12-16T02:23:40.790

1.  仔细检查软件是否真的在输出 ANSI 颜色。例如，运行此 echo 的 bash 脚本将在安装了 AnsiColor 插件的情况下产生颜色，但它会在没有插件的情况下在控制台输出中产生混乱的转义序列。

在 BASH 中：

```
echo -e '\033[35mPurple!\033[0m' 
```

2.  检查您的项目配置，检查“构建环境”并确保选中“颜色 ANSI 控制台输出”。

3.  如果找不到“构建环境”部分，请转到管理插件以仔细检查是否确实安装了正确的插件。
    （我最近安装了“Ansible”插件而不是“AnsiColor”......）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-04-28T16:50:23.597

Jenkins 控制台输出是您可以花费大量时间尝试找出问题所在（或者可能是正确的？）的地方。

AnsiColor 插件让您有机会为单色 Jenkins 控制台输出着色。

分步指南

1.  安装 AnsiColor 插件 在 Build Environment 部分检查 Color ANSI Console OutputJenkins -
2.  颜色 ANSI 控制台输出 -[应该看起来像](https://i.stack.imgur.com/lBpci.png)

3.  TesterFenster Inside Execute shell 步骤添加如下内容：

```
set +x

info() {

echo "\033[1;33m[Info]    \033[0m $1"

}

error() {

echo "\033[1;31m[Error]   \033[0m $1"

}

success() {

echo "\033[1;32m[Success] \033[0m $1"

}

info "This is information message"

error "Houston we have a problem"

success "Great!!!"

echo "Foreground colors"

echo "\033[31m Red \033[0m"

echo "\033[32m Green \033[0m"

echo "\033[33m Yellow \033[0m"

echo "\033[34m Blue \033[0m"
siz
echo "\033[35m Magneta \033[0m"

echo "\033[36m Cyan \033[0m"

echo "Background colors"

echo "\033[41m Red \033[0m"

echo "\033[42m Green \033[0m"

echo "\033[43m Yellow \033[0m"

echo "\033[44m Blue \033[0m"

echo "\033[45m Magneta \033[0m"

echo "\033[46m Cyan \033[0m"

echo "Different combinations"

echo "\033[1;31m Red \033[0m"

echo "\033[1;4;37;42m Green \033[0m"

echo "\033[1;43m Yellow \033[0m"

set -x
```

你应该看到 [你的输出](https://i.stack.imgur.com/Ymugr.png)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-21T09:39:23.093

这仅适用于 Jenkins 控制台，而不适用于输出到控制台输出的实际脚本

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-24T08:40:43.140

OP 明确询问在 Windows 上使用 AnsiColor Jenkins 插件，所以这是我的答案：

**cmd.exe 不是终端模拟器**

正如@ocodo 所写，`cmd.exe`（由 Jenkins 触发）不是终端模拟器，因此默认情况下它不支持批处理命令的 ANSI 输出。所以这在 Windows 上是不支持的。

这些测试在 Jenkins 中使用 Windows Batch 构建步骤不成功：

```
echo \e[33m hello \e[0m
echo \033[33m hello \033[0m
echo \x1b[33m hello \x1b[0m
echo \27[33m hello \27[0m
echo \[33m hello \[0m
echo ←[33m hello ←[0m 
```

最后一行：要在 Firefox 测试框表单中注入 ESC 字符，请按 alt+27，这也是大多数编辑器中的转义序列。更多信息在这里：[http](http://www.robvanderwoude.com/ansi.php#AnsiColor) ://www.robvanderwoude.com/ansi.php#AnsiColor和[https://groups.google.com/forum/#!topic/jenkinsci-users/0OcjlZQfqrk](https://groups.google.com/forum/#!topic/jenkinsci-users/0OcjlZQfqrk)

**解决方案：使用 Python print 进行文本着色**

使用 Python 进行控制台输出的构建作业对 AnsiColor 没有任何问题，因此如果 Python 在您的环境中可用，控制台输出由脚本生成，您可以从那里注入 ANSI 代码。以下是我如何解决它以使其丰富多彩。

*   像这样创建一个帮助脚本`util/ansiGreen.py`：

```
#!/usr/bin/env python
print("\033[32m"); 
```

*   在全局构建配置级别注册为 env var：

```
set ansiGreen=python %cdRootPath%util\ansiGreen.py 
```

*   将其添加到您的脚本中：

```
call make-some-tests.bat
if %errorlevel% gtr 0 (
    %ansiRed%
    echo [ERROR] You screwed up trunk!
    %ansiOff%
) 
```

如您所见，`%ansiOff%`还需要以着色结束（它只是`"\033[0m"`通过python打印）。否则之后的所有内容都`%ansiRed%`将显示为*红色*。

此脚本在 Jenkins 从站上运行。直接在 Jenkins 批量构建步骤中设置和获取环境是另一个挑战。

这有点难看，但经过大量研究后，它似乎是使 AnsiColor 从 Windows Jenkins 从站返回到 Windows Jenkins 主站的最佳解决方法。

# iphone - 在 iOS 上无需用户输入即可发送大量电子邮件的最佳方式？

> ID：12428586
> 
> 赞同：0
> 
> 时间：2012-09-14T16:35:25.807
> 
> 标签：iphone, ios, email, smtp

首先，让我解决这个问题，并说这不是垃圾邮件应用程序。我正在编写一个应用程序，允许用户通过电子邮件轻松地与多个朋友共享文件。

现在，我正在 [`SKPSMTPMessage`](http://code.google.com/p/skpsmtpmessage/)根据用户的请求向收件人列表发送电子邮件。它有效，但我想知道这里是否没有更好的解决方案。例如，如果最好将`smtp`信息和附件发送到我的服务器，然后从那里进行发送，以避免在设备上重复上传附件。

我也在考虑如何处理没有可用连接的情况（确定连接错误与其他类型的错误，并保留失败的消息以供以后重试）。

任何有关构建此服务的最佳方式的建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T16:35:06.707

为了自定义发送电子邮件的用户体验，如果您希望该用户成为发送电子邮件的人，您需要访问他们的电子邮件详细信息、IMAP、POP 等。

我使用的解决方案是让发件人地址成为我控制的电子邮件，并使用第三方电子邮件提供商，例如：SendGrid、PostMark、Mandrill 并插入他们的 api 以发送电子邮件。

# javascript - 编码不佳的 JQuery：命名依赖项

> ID：12428590
> 
> 赞同：0
> 
> 时间：2012-09-14T16:35:50.887
> 
> 标签：javascript, jquery, html, tabs

我在一个页面上有几个标签有这个标记

```
<div id="holiday-details-nav">
                <ul>
                    <li><a class="holidaydetails-description" title="Overview" href="#tab-holidaydetails-overview">Overview</a></li>
                    <li><a class="holidaydetails-included" title="Rooms" href="#tab-holidaydetails-rooms">Rooms</a></li>
                    <li><a class="holidaydetails-itinerary" title="Rates" href="#tab-holidaydetails-rates">Rates</a></li>  
                    <li><a class="holidaydetails-accommodation" title="Information" href="#tab-holidaydetails-information">Information</a></li>                         
                    <li><a class="holidaydetails-reviews" title="Reviews" href="#tab-holidaydetails-reviews">Reviews</a></li>
                </ul>
            </div> 
```

这些选项卡中内容的隐藏和显示由一些 JQuery 代码控制，因此开始

```
$(document).ready(function () {
    // Hide all tabs apart from the overview
    $('#holiday-details-tabs div:#tab-holidaydetails-rooms').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-rates').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-information').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-reviews').hide();
    ... 
```

问题是，如果我添加、删除或重命名选项卡（就像我刚刚所做的那样），那么我必须更改所有这些代码。我想要的是添加、重命名或删除任意数量的选项卡，但不必修改此 JQuery 代码。

我并不是真的要找人为我编写解决方案，而是想开始讨论可用于避免这种命名依赖的工具、技术等。

**编辑**

单击选项卡时，我也有一点丑陋。

```
$('#holiday-details-nav ul li a').click(function () {
    // Remove active class from all links
    $('#holiday-details-nav ul li').removeClass('active');
    //Set clicked link class to active
    $(this).parent().addClass('active');
    // Set variable currentTab to value of href attribute of clicked link
    var currentTab = $(this).attr('href');
    // Hide all tabs
    $('#holidaydetails-description-imagecontainer').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-overview').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-rooms').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-rates').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-information').hide();
    $('#holiday-details-tabs div:#tab-holidaydetails-reviews').hide();

    $('#holiday-details-bottom').show();
    $('#holiday-details-left-booknow').show();

    // Show div with id equal to variable currentTab
    $(currentTab).show();

    $('#holidaydetails-description-imagecontainer').show();

    return false;
}); 
```

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:37:29.890

您可以为每个*除*概述之外的所有 CSS分配一个*通用*的CSS 类，然后使用 jQuery 类选择器将它们全部隐藏。例如：`tab``li`

 *```
<div id="holiday-details-nav">
  <ul>
    <li><a class="holidaydetails-description" title="Overview" href="#tab-holidaydetails-overview">Overview</a></li>
    <li><a class="tab holidaydetails-included" title="Rooms" href="#tab-holidaydetails-rooms">Rooms</a></li>
    <li><a class="tab holidaydetails-itinerary" title="Rates" href="#tab-holidaydetails-rates">Rates</a></li>  
    <li><a class="tab holidaydetails-accommodation" title="Information" href="#tab-holidaydetails-information">Information</a></li>                         
    <li><a class="tab holidaydetails-reviews" title="Reviews" href="#tab-holidaydetails-reviews">Reviews</a></li>
  </ul>
</div> 
```

然后，隐藏除概述之外的每个选项卡：

```
$("holiday-details-nav .tab").hide(); 
```

或者反过来，即添加一个特定的类到概览中，并隐藏所有其他选项卡：

```
<div id="holiday-details-nav">
  <ul>
    <li><a class="overview holidaydetails-description" title="Overview" href="#tab-holidaydetails-overview">Overview</a></li>
    <li><a class="holidaydetails-included" title="Rooms" href="#tab-holidaydetails-rooms">Rooms</a></li>
    <li><a class="holidaydetails-itinerary" title="Rates" href="#tab-holidaydetails-rates">Rates</a></li>  
    <li><a class="holidaydetails-accommodation" title="Information" href="#tab-holidaydetails-information">Information</a></li>                         
    <li><a class="holidaydetails-reviews" title="Reviews" href="#tab-holidaydetails-reviews">Reviews</a></li>
  </ul>
</div> 
```

然后，要隐藏，选择所有选项卡，并使用以下命令排除概览`.not()`：

```
$("#holiday-details-nav a").not(".overview").hide(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:03:50.193

在处理选项卡时，尤其是在您拥有的设置中（其中`href`属性具有与其相关的 div 的 id），您不需要硬编码任何内容、使用`title`属性或使用任何额外的类。看这个：

[http://jsfiddle.net/FAM2s/2/](http://jsfiddle.net/FAM2s/2/)

它所做的就是找到所有选项卡的详细 div 并将它们全部隐藏，然后只显示与刚刚单击的内容相关的一个。

只要您`href`为链接设置正确的属性，并使用这些 id 设置相应的 div，它就会起作用，无论您何时添加/删除多少个选项卡。*

# java - 我可以使用什么来检索用户在我的应用中的图像上标记的区域？

> ID：12428596
> 
> 赞同：0
> 
> 时间：2012-09-14T16:36:15.133
> 
> 标签：java, android

我的应用程序为用户拍照，我希望用户在图像上标记他们的眼睛、嘴巴和耳朵的位置。耳朵只是一个点，但嘴巴是整个嘴巴区域的选择

我已经完成了拍照部分，但是我该如何继续允许用户突出显示他的嘴巴区域然后获取这些像素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:42:48.923

[http://developer.android.com/guide/topics/ui/ui-events.html](http://developer.android.com/guide/topics/ui/ui-events.html)提供了有关使用触摸事件的详细信息，您需要了解和实施这些信息。

# javascript - 切换自定义复选框时如何单击最近的锚点

> ID：12428598
> 
> 赞同：0
> 
> 时间：2012-09-14T16:36:22.727
> 
> 标签：javascript, jquery

![使用自定义复选框进行分面搜索](../Images/a1d820ab24d2eb2f144ef018199fa568.png)

HTML

```
<li class="leaf">

  // The span is my custom checkbox that wraps around the default checkbox.     
  <span class="checkbox facetapi-checkbox checked">

    // The span above replaces the default checkbox below, which you'll notice has a display:none; I don't want both checkboxes showing.
    <input type="checkbox" class="facetapi-checkbox" checked="true" style="display: none; ">

  </span>

  // This is the anchor tag that I need to click when my custom checkbox is checked.
  // It's outside of my custom checkbox span, but shares the same parent.  
  <a href="/part-finder/field_rep_catalog/heater-1527" rel="nofollow" class="facetapi-active facetapi-checkbox-processed" style="display: none; ">(-) 
     <span class="element-invisible">Remove Support filter</span>
  </a>

</li> 
```

这是用于用我的自定义复选框替换默认复选框的 jQuery：

```
//Checkbox Image Replacement 
$('.faceted_search_column input[type=checkbox]').each(function() {
  var span = $('<span class="' + $(this).attr('type') + ' ' + $(this).attr('class') + '"></span>').click(doCheck).mousedown(doDown).mouseup(doUp);
  if ($(this).is(':checked')) {
    span.addClass('checked');
  }
  $(this).wrap(span).hide();
});

// You'll notice that when this function is run, I've attempted to use .closest() to find the nearest anchor and then do a .triggerHandler('click') to click that anchor it finds. This obviously didn't work. Should I use .parent() to move back in the DOM?
function doCheck() {
  if ($(this).hasClass('checked')) {
    // This was my attempt to click the anchor when doCheck function is run.
    $(this).closest('a.facetapi-checkbox-processed').triggerHandler('click');
    $(this).removeClass('checked');
    $(this).children().prop("checked", false);
  } else {
    $(this).parents('a.facetapi-checkbox-processed').triggerHandler('click');
    $(this).addClass('checked');
    $(this).children().prop("checked", true);
  }
}

function doDown() {
  $(this).addClass('clicked');
}

function doUp() {
  $(this).removeClass('clicked');
} 
```

当用户切换复选框时，你们推荐什么作为触发锚点点击的最有效方法？这是一个多面搜索锚，所以我需要选中或取消选中才能触发相同的锚标记。

提前感谢那些花时间帮助我的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:40:41.750

您需要替换以下行：

```
$(this).closest('a.facetapi-checkbox-processed').triggerHandler('click'); 
```

对于这个：

```
$(this).siblings('a.facetapi-checkbox-processed').triggerHandler('click'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:42:05.987

Closest 仅查看元素的直接祖先。您可以结合使用最接近（'li'）和查找（'a'）来实现您的目标。

```
 $(this).closest('li').find('a.facetapi-checkbox-processed').click(); 
```

TriggerHandler 不会冒泡 dom 树，因此它仅尝试触发 Anchor 上的单击，没有绑定到 Anchor 标签的触发器。使用 trigger('click') 或简单地 .click() 将事件传播到跨度上的事件处理程序，或更改查找以直接查找跨度。

# c# - 哪个类需要实现INotifyDataErrorInfo？

> ID：12428599
> 
> 赞同：2
> 
> 时间：2012-09-14T16:36:25.680
> 
> 标签：c#, data-binding, silverlight-5.0, inotifydataerrorinfo

在绑定的情况下，例如

```
<TextBox Text={Binding Path=SomeItem.AnotherItem.Property} /> 
```

哪些类需要实现 INotifyDataErrorInfo：

1.  数据上下文
2.  某项
3.  另一个项目
4.  这些的一些组合

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:10:46.450

```
AnotherItem 
```

`INotifyDataErrorInfo`必须由拥有绑定属性的对象实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:29:40.443

如果您使用的是 MVVM 模式，则 INotifyDataErrorInfo 通常由视图模型实现。这个视图模型通常就是你的视图的数据上下文。

# firebase - 验证清除通知的方法

> ID：12428600
> 
> 赞同：1
> 
> 时间：2012-09-14T16:36:29.207
> 
> 标签：firebase

您能否验证我使用 Firebase 管理用户通知系统的方法？

基本上我想拥有用户特定的频道以及更通用的频道来保存通知。如果用户之前没有查看这些通知，这些通知将出现在 Intranet 上。

作为服务器端操作的想法将使用 REST API 为特定用户或向所有人广播更新 Firebase 端点。我可以轻松地将特定用户消息标记为已读，因此不会再次显示它们，这是我正在努力解决的一般广播。

我可以在一般广播中添加一个标志（用户 ID）以指示其已读取，但我担心性能，因为客户端必须检查历史广播消息中是否存在此标志。我可以添加一个用户 ID 来创建一个应该更快的新端点。
例如 /notification/general/ - 包含消息，这会触发客户端，然后检查 /users/USERID/MessageID 是否存在，如果它不显示消息并创建此端点。

有什么我遗漏的东西还是最好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T21:22:20.517

消息总是按顺序消费吗？如果是这样，您可以让每个客户端记住它在每个公共频道中读取的最后一条消息的 ID。然后，您可以在队列上使用“startAt”将其限制为仅接收新消息。

如果它们没有按顺序使用，那么您将需要某种方式来存储有关哪些已读取和哪些未读取的数据。也许您可以将每条消息发送到每个人的个人队列，然后让每个用户删除已读消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:07:07.593

既然已经有单独的用户消息，为什么不单独将广播发送给每个人（想想电子邮件），而不是尝试存储一个副本并找出谁阅读了它。

为了减少批量，您可以单独存储消息内容，并将 id 简单地存储在用户的队列中。然后，在查看它们时，您可以为每个用户标记它们，而不会增加任何复杂性。

100k 的用户每天收到 100 条消息，包括广播，使用标准的 Firebase ID（大约 20 个字符），每年有 210,000,000 个字符（即，对于数据库来说没有任何意义，可能仍然远远少于存储消息正文），假设它们永不过期并被删除。

# php - 从linux bash执行php时的自动加载器

> ID：12428607
> 
> 赞同：0
> 
> 时间：2012-09-14T16:36:52.990
> 
> 标签：php, spl-autoloader

我目前正在使用自动视频转换进行某种上传。目前，我正在上传完成后通过 php shell 命令执行 php 脚本，因此用户不必等到转换完成。像这样：

```
protected function _runConversionScript() {
    if (!exec("php -f '" . $this->_conversionScript . "' > /dev/null &"))
        return true;

    return false;
} 
```

现在在我的转换脚本文件中，我正在使用另一个类“UploadFunctions”中的函数来更新数据库中的状态（如启动、转换、完成......）。问题在于，这个 UploadFunctions 类继承自另一个类“Controller”，例如建立数据库连接。目前我正在使用 spl_autoloader 在特定目录中搜​​索所需文件（例如 controller.php），但由于转换脚本与整个自动加载器内容脱节，它无法识别 Controller 类并引发致命的 php 错误。以下是转换脚本中的一些代码：

```
require_once('uploadfunctions.php');

$upload_func = new UploadFunctions();

// we want to make sure we only process videos that haven't already
// been or are being processed
$where = array(
    'status' => 'queued'
);
$videos = $upload_func->getVideos($where);

foreach ($videos as $video) {

    // update database to show that these videos are being processed
    $update = array(
        'id' => $video['id'],
        'status' => 'started'
    );
    // execute update
    $upload_func->updateVideo($update);
......... 
```

我这样做是完全错误的还是有更好的方法来做到这一点？如果您需要更多代码或信息，请告诉我！非常感谢

这是我的 spl_autoload 代码：

```
<?php
spl_autoload_register('autoloader');

function autoloader($class_name) {
        $class_name = strtolower($class_name);

        $pos = strpos($class_name ,'twig');

        if($pos !== false){
            return false;
        }

        $possibilities = array(
            '..'.DIRECTORY_SEPARATOR.'globals'.DIRECTORY_SEPARATOR.$class_name.'.php',
            'controller'.DIRECTORY_SEPARATOR.$class_name.'.php',
            '..'.DIRECTORY_SEPARATOR.'libs'.DIRECTORY_SEPARATOR.$class_name.'.php',
            'local'.DIRECTORY_SEPARATOR.$class_name.'.php'
        );

        foreach ($possibilities as $file) {

            if(class_exists($class_name) != true) {
                if (file_exists($file)) {

                    include_once($file);
                }
            }
        }
    }
?> 
```

我将我的项目划分为代表功能的子文件夹，例如上传、我的帐户和图库.. 在每个子文件夹中还有 2 个其他文件夹：控制器和本地。控制器是控制这部分的类（例如上传），本地是我放置需要的本地类的文件夹。控制器类从位于子项目文件夹中的 index.php 中调用。“libs”和“global”只是项目范围的类，如数据库、用户等。这是我的文件夹结构的示例：

**www/index.php** // 主站点

**www/upload/index.php** // 调用控制器进行上传并初始化 spl_autoload

**www/upload/controller/indexcontroller.php** // 上传功能

**www/upload/local/processVideo.php** // 这是转换脚本。

我对 spl_autoload 函数相当陌生。在我看来，如果我的脚本正在调用 spl_autoload ，则不会调用：**"php -f processVideo.php"**，不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:03:47.527

PHP 相对路径是根据调用 PHP 二进制文件的路径计算得出的。

我建议你使用`__DIR__`常量来避免这种行为

[http://php.net/manual/en/language.constants.predefined.php](http://php.net/manual/en/language.constants.predefined.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T19:52:51.657

我实际上能够解决这个问题。我必须在转换脚本中包含 spl_autoload_register 函数，以便它能够找到文件。这是一个问题，因为转换脚本没有构建到我的框架中，因此它无法从框架自动加载器加载类。

# objective-c - 为了符合 MVC，我应该如何在 Cocoa 应用程序中进行数据库调用？

> ID：12428608
> 
> 赞同：1
> 
> 时间：2012-09-14T16:36:59.413
> 
> 标签：objective-c, cocoa, postgresql

我正在开发一个基于 Cocoa 的应用程序，它将在用户事务的过程中多次调用 Postgres 数据库（使用 PGSQLKit）。该应用程序是一种信息亭。

我想知道的是在整个应用程序中进行数据库调用的正确方法。本着 MVC 的精神，我知道我应该为从数据库返回的数据创建对象（我打算这样做），然后使用这些对象。我需要澄清的地方是我应该放置我的数据库调用的地方。

基本上它归结为我有这些问题：
- 为了与数据库交互，我应该创建一个单独的数据库控制器类来进行数据库调用吗？我觉得直接从视图控制器进行数据库调用是不合适的。
-假设我创建了一个数据库控制器，我的视图控制器是否应该触发数据库控制器类并以这种方式进行数据库调用？
-当应用程序加载时，我是否应该通过数据库控制器连接到数据，并在用户事务完成时关闭它？我将在整个交易过程中打几个电话，所以我认为我不应该每次都关闭连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T21:19:15.467

> - 为了与数据库交互，我应该创建一个单独的数据库控制器类来进行数据库调用吗？我觉得直接从视图控制器进行数据库调用是不合适的。

正确的。在某些情况下，您甚至可能在数据库控制器之上还有另一层模型对象。大多数应用程序不应该关心数据是否存储在 Postgres 数据库中，而不是其他方式。

> -假设我创建了一个数据库控制器，我的视图控制器是否应该触发数据库控制器类并以这种方式进行数据库调用？

一般是的。您的视图控制器将观察模型并在需要数据时告诉模型。该模型将让观察者（包括视图控制器，尽管模型不关心他们是谁）知道相关数据何时可用或发生变化。

> -当应用程序加载时，我是否应该通过数据库控制器连接到数据，并在用户事务完成时关闭它？我将在整个交易过程中打几个电话，所以我认为我不应该每次都关闭连接。

这是数据库控制器的内部细节。通常这种对象会保持长期的连接。通常，该连接是在模型第一次被要求从数据库中获取它需要的数据时建立的，而不是“在应用程序启动时”。

# ios - 模仿iOS iTunes商店中的横向和纵向组合滚动

> ID：12428615
> 
> 赞同：1
> 
> 时间：2012-09-14T16:37:13.307
> 
> 标签：ios, uitableview, user-interface

我正在尝试创建一个类似于新 iTunes 商店中的屏幕：

![苹果 iTunes 应用截图](../Images/1892e2437e5cc7c6c36757a8713a2987.png)

也就是说，一个可以水平和垂直滚动的网格。

我尝试的第一种方法涉及创建一个`UITableView`（用于垂直行），并且在每个`UITableViewCell`中创建一个旋转 90 度的`UITableView`另一个。`UITableView`

这似乎在视觉上有效，但我无法垂直滚动。我相信子视图表中的手势识别器阻止了父表视图中的手势识别器接收触摸事件。

基本上，行水平滚动而不是垂直滚动。

我当时想到的下一个方法是`UISrollView`为每一行创建 s 但我想知道是否有什么我错过了？

过去有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:00:06.673

我做了一些类似于你在表格视图中使用表格视图所做的事情，我将旋转 90° 的表格视图改为父视图。我想当在另一个表视图中检测到滚动时，我还必须关闭一个表视图的滚动，反之亦然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T17:46:56.553

如果您尝试将目标定位在 iOS 6.0 以下，排除使用 UICollectionView，我会尝试使用 GMGridView：

[https://github.com/gmoledina/GMGridView](https://github.com/gmoledina/GMGridView)

它非常完整并且具有许多功能。它还具有水平分页支持，可以实现您正在寻找的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T17:10:11.683

你应该看看[UICollectionView](https://developer.apple.com/videos/wwdc/2012/?id=205)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-15T08:55:20.147

从未尝试过构建类似的东西，但是......想法：

一个表格视图，n 个单元格，每个单元格都嵌入一个可以包含 n 个子视图的滚动视图。

# html - 在 Chrome 中相对定位的元素后 选择不可访问的元素

> ID：12428618
> 
> 赞同：0
> 
> 时间：2012-09-14T16:37:23.897
> 
> 标签：html, css, firefox, google-chrome, cross-browser

我在 Chrome (v21.0.1180.89) 中看到了奇怪的行为，但在 FireFox 中运行良好。这是HTML：

```
<div style="position:relative;text-align:right;width:500px;height:100px;">
    <img src="http://placehold.it/500x100"></img>
    <img src="http://placehold.it/100x100"></img>
    <div>foo</div>
</div>
<div style="height:50px;">bar</div>
<select>
    <option value="1">One xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</option>
    <option value="2">Two</option>
    <option value="3">Three</option>
</select> 
```

仅在 Chrome 中，当您单击它时，选择无法获得焦点（但您可以通过标签选择它）。

如果你将'bar' div 的高度增加到 100px，这样选择就会出现在 100x100 的图像下方，那么你可以点击它。

这是预期的并且 Chrome 的行为正确，还是 FF 只是更宽容？

这是[jsfiddle](http://jsfiddle.net/awilliams47/xjuae/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:42:13.337

您的`div`元素扩展为重叠`select`元素，使用：

```
pointer-events: none; 
```

在你的 CSS 中`div`进行反击。

JSFiddle：http: [//jsfiddle.net/xjuae/3/](http://jsfiddle.net/xjuae/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:42:26.380

[http://jsfiddle.net/xjuae/2/](http://jsfiddle.net/xjuae/2/)

z 指数：-1

上部 div 在选择的顶部展开。这是意外的行为，但这是一个修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:44:29.520

如果您删除`position:relative`顶部 div 一切都很好。

**[jsFiddle 示例](http://jsfiddle.net/j08691/xjuae/5/)**

# c# - 如何将方法和该方法使用的字典组合起来进行查找？

> ID：12428622
> 
> 赞同：0
> 
> 时间：2012-09-14T16:37:28.667
> 
> 标签：c#

> **可能重复：**
> [在 C# 中创建常量字典](https://stackoverflow.com/questions/268084/creating-a-constant-dictionary-in-c-sharp)

我目前有：

```
 public string GetRefStat(int pk) {
        return RefStat[pk];
    }
    private readonly Dictionary<int, int> RefStat =
    new Dictionary<int, int> 
    {
        {1,2},
        {2,3},
        {3,5} 
    }; 
```

这有效，但我使用 RefStat 字典的唯一时间是 GetRefStat 调用它时。

有没有办法可以将方法和字典结合起来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:42:52.557

是的，您可以在类型的构造函数中初始化字典。然后，您可以将方法更改`GetRefStat`为属性。所以元代码可能看起来像这样

```
class Foo
{
    public Dictionary<int, int> RefStat {get;private set;}

    Foo()
    {
        RefStat = new Dictionary<int, int> 
        {
            {1,2},
            {2,3},
            {3,5} 
        };
    }
} 
```

和用法

```
Foo f = new Foo();
var item = f.RefStat[0] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:44:29.907

好吧，您可以制作一个扩展方法，然后所有字典都可以使用该功能。我将假设这`GetRefStat`不仅仅是使用键从字典中获取值：

```
public static class DictionaryExtensions
{
    public static TValue GetRefStat<TKey, TValue>(this Dictionary<TKey, TValue> dictionary, TKey key) 
    {
        return dictionary[key];
    }
} 
```

然后所有字典都可以这样称呼它：

```
var dictionary = new Dictionary<int, int> 
    {
        {1,2},
        {2,3},
        {3,5} 
    };
var value = dictionary.GetRefStat(2) 
```

如果这本字典是一堆常量，那么这个答案就过分了。只需使用`if/else`or `switch`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:45:08.943

像这样的东西？

```
 public string GetRefStat(int pk) 
{ 
    return new Dictionary<int, int>   
    {  
        {1,2},  
        {2,3},  
        {3,5}   
    }[pk]; 
} 
```

# cocos2d-iphone - 游戏中心关闭排行榜时禁用cocos2d点击

> ID：12428623
> 
> 赞同：0
> 
> 时间：2012-09-14T16:37:29.580
> 
> 标签：cocos2d-iphone, game-center

我显示了游戏中心排行榜，但是当我点击完成按钮时，排行榜关闭。但我无法点击屏幕上的任何按钮。

这是我的代码：

```
- (void)leaderboardViewControllerDidFinish:(GKLeaderboardViewController *)viewController
{
    CCLOG(@"leaderboardViewControllerDidFinish %@", viewController);
    [viewController dismissModalViewControllerAnimated:YES];
    [viewController.view removeFromSuperview];
    [viewController release];
    [[CCDirector sharedDirector] resume];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:55:00.937

使用此代码。

Cocos2D 2.0

```
-(void) leaderboardViewControllerDidFinish:(GKLeaderboardViewController *)viewController
{
    AppController *app = (AppController*) [[UIApplication sharedApplication] delegate];
    [app.navController dismissModalViewControllerAnimated:YES];
} 
```

Cocos2D 1.0

```
-(void) leaderboardViewControllerDidFinish:(GKLeaderboardViewController *)viewController
{
    AppDelegate* app = (AppDelegate*)[[UIApplication sharedApplication] delegate];
    [app.viewController dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:46:12.590

我正在使用 cocos2D 1.0

很抱歉，您提供的代码不起作用。

我解决了这个问题。我只评论一行。我失去了排行榜的关闭动画，但它的工作。

```
- (void)leaderboardViewControllerDidFinish:(GKLeaderboardViewController *)viewController
{
    CCLOG(@"leaderboardViewControllerDidFinish %@", viewController);
    [viewController.view removeFromSuperview];
    [viewController release];    
    [[CCDirector sharedDirector] resume];
} 
```

# ruby - Resque 中的字符编码问题

> ID：12428626
> 
> 赞同：0
> 
> 时间：2012-09-14T16:37:42.857
> 
> 标签：ruby, character-encoding, resque

我有一系列需要处理的 JSON 消息，并且在字符编码方面遇到了一些问题。我从 RabbitMQ 队列中检索此消息，如下所示：

```
@data = []
@queue.pop do |metadata, payload|
  parsed_message = JSON.parse(payload)
  @data << parsed_message
end 
```

然后我使用 Resque 处理它们并将它们排入队列，如下所示：

```
Resque.enqueue(Worker, @data) 
```

当我运行工人时，它会引发此错误：

```
** [16:06:13 2012-09-14] 5375: Error reserving job: #<Encoding::InvalidByteSequenceError: "\xC3" on US-ASCII>
** [16:06:13 2012-09-14] 5375: /usr/local/lib/ruby/1.9.1/json/common.rb:148:in `encode'
/usr/local/lib/ruby/1.9.1/json/common.rb:148:in `initialize'
/usr/local/lib/ruby/1.9.1/json/common.rb:148:in `new'
/usr/local/lib/ruby/1.9.1/json/common.rb:148:in `parse'
/usr/local/lib/ruby/gems/1.9.1/gems/multi_json-1.3.6/lib/multi_json/adapters/json_common.rb:7:in `load'
/usr/local/lib/ruby/gems/1.9.1/gems/multi_json-1.3.6/lib/multi_json.rb:93:in `load'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/helpers.rb:38:in `decode'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque.rb:149:in `pop'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/job.rb:100:in `reserve'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque.rb:303:in `reserve'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/worker.rb:209:in `block in reserve'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/worker.rb:207:in `each'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/worker.rb:207:in `reserve'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/worker.rb:136:in `block in work'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/worker.rb:133:in `loop'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/worker.rb:133:in `work'
/usr/local/lib/ruby/gems/1.9.1/gems/resque-1.22.0/lib/resque/tasks.rb:36:in `block (2 levels) in <top (required)>'
/usr/local/lib/ruby/1.9.1/rake/task.rb:205:in `call'
/usr/local/lib/ruby/1.9.1/rake/task.rb:205:in `block in execute'
/usr/local/lib/ruby/1.9.1/rake/task.rb:200:in `each'
/usr/local/lib/ruby/1.9.1/rake/task.rb:200:in `execute'
/usr/local/lib/ruby/1.9.1/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/usr/local/lib/ruby/1.9.1/rake/task.rb:151:in `invoke_with_call_chain'
/usr/local/lib/ruby/1.9.1/rake/task.rb:144:in `invoke'
/usr/local/lib/ruby/1.9.1/rake/application.rb:116:in `invoke_task'
/usr/local/lib/ruby/1.9.1/rake/application.rb:94:in `block (2 levels) in top_level'
/usr/local/lib/ruby/1.9.1/rake/application.rb:94:in `each'
/usr/local/lib/ruby/1.9.1/rake/application.rb:94:in `block in top_level'
/usr/local/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'
/usr/local/lib/ruby/1.9.1/rake/application.rb:88:in `top_level'
/usr/local/lib/ruby/1.9.1/rake/application.rb:66:in `block in run'
/usr/local/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'
/usr/local/lib/ruby/1.9.1/rake/application.rb:63:in `run'
/usr/local/bin/rake:32:in `<main>'
rake aborted! 
```

我已将工作人员的执行函数中的所有代码包装在开始/救援块中，以尝试捕获异常但无济于事，这使我认为它来自 Resque 内部的某个地方。

我尝试使用原始数据将 Resque 工作人员排队，然后在工作人员内部将其解析为 JSON 并设置 UTF-8 编码：

```
raw_data.each do |msg|
  msg = msg.encode("UTF-8", :invalid => :replace, :undef => :replace, :replace => "")                        
  parsed_msg = JSON.parse(msg) rescue nil                                                                     
  next if parsed_msg.nil?                                                                                     
  parsed_data << parsed_msg                                                                                   
 end 
```

我仍然得到同样的错误。它并不总是同一个字符，如果我没记错的话，有时它是 \xC2 或 \xD8

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:48:20.843

文件编码是否可能不正确？

尝试插入：

```
# encoding: UTF-8 
```

在相关 ruby​​ 源文件的顶部。这是 Ruby 1.9 中最令人讨厌的事情之一。

# ruby-on-rails - 在哪里设置环境变量，以便它们可以从 `config/initializer/*.rb` 中读取？

> ID：12428632
> 
> 赞同：2
> 
> 时间：2012-09-14T16:38:22.967
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, environment-variables

我有我所有的环境变量`config/initializers/app_environment_variables.rb`，这个设置到目前为止一直在工作，除了现在我需要使用和中的变量`config/environments.rb`，`config/environments/*.rb`这似乎是之前执行的`config/initializer/*.rb`。

我发现[这个](http://www.sekuda.com/rails_initialization_and_configuration_order)页面显示“配置顺序”如下，

1.  配置/预初始化器.rb
2.  配置/环境.rb
3.  配置/环境/#{RAILS_ENV}.rb
4.  插件初始化
5.  宝石初始化
6.  配置/初始化程序/*.rb
7.  ...

但该信息来自 2009 年，而我在`Rails 3.1`. [我希望在“初始化](http://guides.rubyonrails.org/initialization.html)”或“[配置](http://guides.rubyonrails.org/configuring.html)”指南中看到此类信息，但要么我无法找到该信息，要么它不存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-24T20:26:48.887

我在一个新的“演示”应用程序（ ）中添加`puts "--- #{__FILE__}"`了以下每个文件的顶部：`rails new demo`

```
config.ru
config/application.rb
config/boot.rb
config/environment.rb
config/environments/development.rb
config/initializers/hello.rb 
```

然后我简单地用 启动应用程序`rails server`，并得到以下输出（`....`为了简洁起见）：

```
--- /Volumes/..../initialization-order/demo/config/boot.rb
--- /Volumes/..../initialization-order/demo/config/application.rb
=> Booting WEBrick
=> Rails 3.2.13 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
--- /Volumes/..../initialization-order/demo/config.ru
--- /Volumes/..../initialization-order/demo/config/environment.rb
--- /Volumes/..../initialization-order/demo/config/environments/development.rb
--- /Volumes/..../initialization-order/demo/config/initializers/hello.rb
[2013-05-16 15:05:59] INFO  WEBrick 1.3.1
[2013-05-16 15:05:59] INFO  ruby 1.9.3 (2013-02-22) [x86_64-darwin12.3.0]
[2013-05-16 15:05:59] INFO  WEBrick::HTTPServer#start: pid=91029 port=3000
^C[2013-05-16 15:06:25] INFO  going to shutdown ...
[2013-05-16 15:06:25] INFO  WEBrick::HTTPServer#start done.
Exiting 
```

因此初始化顺序如下：

```
/config/boot.rb
/config/application.rb
/config.ru
/config/environment.rb
/config/environments/development.rb
/config/initializers/hello.rb 
```

因此，如果您希望在之前`config/environments/*.rb`（和之前`/config/initializers/*.rb`）加载您的环境变量，那么[请阅读接下来](https://stackoverflow.com/a/11765775/664833)的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T18:02:14.317

我建议使用[工头](https://github.com/ddollar/foreman)和`.env`文件来设置环境变量。

1.  创建一个`.env.sample`进入源代码管理的文件
2.  创建自己的`.env`文件，并添加`.env`到`.gitignore`
3.  使用`foreman start`而不是`rails s`
4.  享受美妙（默认为端口 5000）。

**.env.sample**

```
AWS_ACCESS_ID=YOUR_ACCESSKEY_GOES_HERE
ETC_ETC=ETC ETC ETC 
```

好处：

*   您不会将敏感信息提交给源代码控制。
*   它们确实将是环境变量，在任何代码运行之前设置。

# regex - 从一系列输入生成正则表达式

> ID：12428635
> 
> 赞同：3
> 
> 时间：2012-09-14T16:38:29.670
> 
> 标签：regex

是否有可能从一系列输入中生成正则表达式？

我不确定这是否可能。因此我在这里发布这个问题。

是否有任何工具或网站可以做到这一点？

更多更新：说我输入像

*   www.google.com
*   google.com
*   [http://www.google.com](http://www.google.com)

它应该以某种方式给我一个正则表达式 dat 接受这种类型的输入......这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:32:25.813

对于您的 URL 示例，这是我刚刚在 C# 中拼凑的内容。我想它会帮助你。

```
 //   Input "pattern" should consist of a string with ONLY the following tags:
    //   <protocol>  <web>  <website>  <DomainExtension>  <RestOfPath>
    //   Ex) GenerateRegexFor("<protocol><web><webite><domainextension>") will match http://www.google.com
    public string GenerateRegexFor(string pattern)
    {
        string regex = ProcessNextPart(pattern, "");
        return regex;
    }

    public string ProcessNextPart(string pattern, string regex)
    {
        pattern = pattern.ToLower();
        if (pattern.ToLower().StartsWith("<protocol>"))
        {
            regex += @"[a-zA-Z]+://";
            pattern = pattern.Replace("<protocol>", "");
        }
        else if (pattern.ToLower().StartsWith("<web>"))
        {
            regex += @"www\d?"; //\d? in case of www2
            pattern = pattern = pattern.Replace("<web>", "");
        }
        else if (pattern.ToLower().StartsWith("<website>"))
        {
            regex += @"([a-zA-Z0-9\-]*\.)+";
            pattern = pattern.Replace("<website>", "");
        }
        else if (pattern.ToLower().StartsWith("<domainextension>"))
        {
            regex += "[a-zA-Z]{2,}";
            pattern = pattern.Replace("<domainextension>", "");
        }
        else if (pattern.ToLower().StartsWith("<restofpath>"))
        {
            regex += @"(/[a-zA-Z0-9\-]*)*(\.[a-zA-Z]*/?)?";
            pattern = pattern.Replace("<restofpath>", "");
        }
        if (pattern.Length > 0 && pattern != "")
            return ProcessNextPart(pattern, regex);
        return regex;
    } 
```

根据您想要匹配的 URL 样式，我认为这应该匹配几乎所有内容。如果有与 URL 相似但不是 URL 的文本，您可能希望使其更加挑剔。

你会这样使用它：

```
//to match something like "www.google.com/images/whatever"
//            \
//             \                 |www||.google.||----com------||/images/whatever
//              \                  |     |             |              |
//              \/                 V     V             V              V           
string regex = GenerateRegexFor("<web><website><domainextension><restofpath>");
 //to match something like "http://www.google.com/images/whatever"
string regex = GenerateRegexFor("<protocol><web><website><domainextension><restofpath>"); 
```

您可以按任何顺序使用这些标签中的任何一个（尽管其中一些没有多大意义）。也可以随意在此基础上进行构建。您可以添加任意数量的标签来表示任意数量的模式。

哦，还有 +1 让我在工作中做点事情。

# ruby-on-rails - 你如何找到一个月中的星期几？

> ID：12428638
> 
> 赞同：5
> 
> 时间：2012-09-14T16:38:30.627
> 
> 标签：ruby-on-rails, ruby

我似乎无法理解可能是一个简单的问题..

假设我有日期..

```
Fri, 14 Sep 2012 18:37:50 +0200 
```

我如何知道这个日期是本月的哪一周？是第1个，第2个..？第三？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-14T19:24:53.837

为什么要使用图书馆？Ruby 默认有它：

```
Week number:
The week 1 of YYYY starts with a Sunday or Monday (according to %U
  or %W).  The days in the year before the first week are in week 0.
    %U - Week number of the year.  The week starts with Sunday.  (00..53)
    %W - Week number of the year.  The week starts with Monday.  (00..53)

> Time.zone.parse("2012-01-01").strftime("%U")
=> "01" 
```

因此，鉴于我们可以找到给定日期在一年中的星期几，我们可以做一些数学运算来确定它发生在一个月中的星期几。

```
> week_of_year_for_first_of_month = Time.zone.parse("2012-07-01").strftime("%U").to_i
> week_of_target_date = Time.zone.parse("2012-07-14").strftime("%U").to_i
> week_occurs_in = week_of_target_date - week_of_year_for_first_of_month + 1
> week_occurs_in # => 2 
```

或者一个方法：

```
def week_of_month_for_date(date)
  my_date = Time.zone.parse(date)
  week_of_target_date = my_date.strftime("%U").to_i
  week_of_beginning_of_month = my_date.beginning_of_month.strftime("%U").to_i
  week_of_target_date - week_of_beginning_of_month + 1
end

> week_of_month_for_date("2012-07-14") # => 2 
> week_of_month_for_date("2012-07-15") # => 3 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-14T16:45:57.380

sachin87 有一个用于确定此类事情的[库。](https://github.com/sachin87/week-of-month)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T19:00:58.687

请注意，这取决于您如何计算周数。假设 6 月 1 日是星期六。你认为 6 月 2 日是哪一周？这可能是第二周，或者如果您认为可数周至少包含 4 天，则可能是第一周。

或者，鉴于 6 月 2 日是星期日，那么该星期日的周数是多少？毫无疑问，这是第一个星期日。如果这就是你的意思，那么它实际上很简单。日期 1 到 7 始终是该月的第一个 [工作日名称]。日期 8-14 始终排在第二位。等等。你所要做的就是建立一个哈希，它可以在任何月份工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-27T23:58:32.173

week_of_month [gem](https://github.com/sachin87/week-of-month)看起来可能有点矫枉过正。该实现使用了大量的数组拆分和`Array.include?`检查。

相反，这里有一个模块，您可以混入`Date`并`Time`获得所需的行为。

```
require "active_support/core_ext/date"
require "active_support/core_ext/time"

module WeekCalculator
  def week_of_year(mondays = false)
    # Use %U for weeks starting on Sunday
    # Use %W for weeks starting on Monday
    strftime(mondays ? "%W" : "%U").to_i + 1
  end

  def week_of_month(mondays = false)
    week_of_year(mondays) - beginning_of_month.week_of_year(mondays) + 1
  end
end

class Date
  include WeekCalculator
end

class Time
  include WeekCalculator
end 
```

* * *

```
Date.new(2014, 1, 1).week_of_year            # => 1
Date.new(2014, 1, 1).week_of_month           # => 1
Date.new(2014, 7, 1).week_of_year            # => 27
Date.new(2014, 7, 1).week_of_month           # => 1

Date.new(2014, 7, 27).week_of_year           # => 31
Date.new(2014, 7, 27).week_of_month          # => 5
Date.new(2014, 7, 27).week_of_year(:monday)  # => 30
Date.new(2014, 7, 27).week_of_month(:monday) # => 4 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-19T20:29:31.243

我被挑战回答“2017 年 6 月 30 日是 2017年 6 月的**第 n 个**星期五”。

我通过构建一个包含截至目标日期的所有日期名称（星期一、星期二等）的数组来解决这个问题，并计算匹配的数量。

```
target_date = Date.new(2017, 6, 30)
(1..target_date.day).select do |day_of_month|
  Date.new(target_date.year, target_date.month, day_of_month).strftime('%A') == target_date.strftime('%A')
end.length 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-20T04:15:24.973

试试这个，找到 a_date 的星期（考虑第一周是 1，一周的第一天是星期一）：

```
week = (((a_date.mday + Date.new(a_date.year, a_date.month, 1).wday - 1) / 7) + 1) 
```

# javascript - 自定义谷歌地图：

> ID：12428645
> 
> 赞同：1
> 
> 时间：2012-09-14T16:38:56.710
> 
> 标签：javascript, objective-c, ios, google-maps

我对这个项目的目标是能够在我的 iphone 应用程序中实现自定义对象以与谷歌地图进行交互。前任。一个命令按钮来执行 X 事件。

我的问题是：最好在 html 文件中使用 javascript 来满足我的需要，然后将其托管在我的 Web 服务器上并通过在我的应用程序中使用 UIWebView 调用它。

或者如果可能的话，使用 iOS MapKit 框架对其进行自定义？

任何信息，建议将不胜感激。谢谢你。

# wordpress - CloudFront CDN（无 GZip）与 Web 服务器/本地对于所有 CSS/JS

> ID：12428647
> 
> 赞同：3
> 
> 时间：2012-09-14T16:38:58.733
> 
> 标签：wordpress, optimization, cdn, amazon-cloudfront, pagespeed

我目前正在对我们即将部署的 WordPress 网站进行一些优化。我们正在使用 w3 Total Cache 对网站进行优化。我最近为 CDN 注册了 CloudFront，我觉得这肯定有帮助，但我们正在失去使用它的 css/js 文件的 gzip 压缩。

我想看看是否有人对处理此问题的好方法有任何意见。目前我正在托管来自网络服务器的所有 js/css，它似乎提供了更好的性能（使用 PageSpeed Insights add on Google Chrome）

这更像是一个最佳实践问题，可以帮助我对这种情况有所了解。

有人有什么建议吗？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T08:06:46.410

您可以预先 gzip 压缩 JavaScript 和 CSS 文件，使用`application/x-gzip`HTTP 标头将它们上传到 S3，然后让 CloudFront 提供它们。

如果您将流程自动化作为构建/部署工作流程的一部分，那么维护起来非常容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:15:36.520

在花了一些时间测试之后，我发现我们工作流程的最佳方式是在服务器上使用 css / js 资产 gzip，而不是从云端提供服务。

在服务器端提供压缩文件似乎比从云端提供非压缩文件要快得多。

如果我们不经常编辑 css/js，我觉得 @Ryan Parman 的建议非常有意义。我想有一些方法可以在编辑后创建一个脚本来同步 css/js，但是对于当前项目，我上面建议的工作就像一个魅力，而且速度很快！

# java - Android 内存管理从原生 JNI 调用 Java 类并声明数据（用于图像转换）

> ID：12428653
> 
> 赞同：0
> 
> 时间：2012-09-14T16:39:32.217
> 
> 标签：java, android, java-native-interface, jnienv

我正在为希望解压缩数据块的 Android 编写本机代码。我正在从本机 JNI 函数调用 Java 方法。这个 Java 方法调用 BitmapFactory，然后尝试分配一些内存：

```
int[] pixels = new int[width * height]; 
```

当程序似乎崩溃或停止或其他情况时，给我**“spin on suspend”**，然后在 VM 关闭之前在 logcat 中喷出很多东西。

只是为了在深入了解细节之前给出大图，我试图将压缩图像的字节数组转换为`width*height*bpp`未压缩的图像以返回给本机代码。我正在尝试使用 Android Java BitmapFactory 进行似乎可以正常工作的解压缩。压缩的字节块是之前加载到本机代码中的 JPG 或 PNG 图像（在我的系统中无法从磁盘读取）。

序列有点复杂，我不确定什么是相关的，所以我会全部说出来： `class MyRenderer implements GLSurfaceView.Renderer`方法`onSurfaceCreated`调用原生`init()`，它在`MyRenderer` 类中定义：

```
static {System.loadLibrary("glprog");
}
public native void init(int dummy_variable); 
```

在本机代码中，这是调用的函数：

```
JNIEXPORT void JNICALL Java_com_pitransviewersingleimageres_MyRenderer_init(JNIEnv * env, jobject obj,  jint dummy_variable) {
glprog_init(dummy_variable);
} 
```

然后调用另一个本机函数`char glprog_init(int dummy_variable)`，该函数本身调用本机 wrapper_uncompress_image_by_os(overlay_compressed_data,overlay_compressed_data_len,... 这是本机函数：

```
char wrapper_uncompress_image_by_os(unsigned char *compressed_data, int compressed_len,                     //input compressed data
                                char *data_name_string, char *suffix,                                   //name and type
                                int slot_num)  {
jstring jnamestring = (*preset_env)->NewStringUTF(preset_env,data_name_string);
jstring jsuffix = (*preset_env)->NewStringUTF(preset_env,suffix);
//create byte[] and copy data in
jbyteArray retArray = (*preset_env)->NewByteArray(preset_env, compressed_len);
if(retArray==NULL) {__android_log_write(ANDROID_LOG_INFO, "NATIVE","ERROR wrapper_uncompress_image_by_os: calling NewByteArray()");return-1;}
jbyte *javaptr = (*preset_env)->GetPrimitiveArrayCritical(preset_env, (jarray)retArray, 0);
if(javaptr==NULL) {__android_log_write(ANDROID_LOG_INFO, "NATIVE","ERROR wrapper_uncompress_image_by_os: calling GetPrimitiveArrayCritical()");return-1;}
memcpy(javaptr,compressed_data,compressed_len); 
(*preset_env)->ReleasePrimitiveArrayCritical(preset_env, retArray, javaptr, 0);

if((preset_javaobject!=NULL)&&(preset_method_id_convertimagefromnative!=NULL))
   {
   jthrowable exception;
   //call java function
   (*preset_env)->CallVoidMethod(preset_env,     preset_javaobject,preset_method_id_convertimagefromnative, 
                             retArray,compressed_len,
                             jnamestring,jsuffix,slot_num); 
```

它调用了与native`convertImageFromNative()`相同的 Java 类中的方法。 `MyRenderer``init()`

```
 public void convertImageFromNative(final byte[] data, int data_len, final String data_name_string, final String suffix, final int slot_num) {
    //writeFile(data,data_name_string);
    Bitmap bitmapqq=bytes2bitmap(data); 
```

}

到目前为止，这似乎有效，如果我取消注释`writeFile()`它会将所有数据正常写入我的 SD 卡。我有问题是在里面`bytes2bitmap()`。

可以在“常规”Java 中调用该类`bytes2bitmap()`，但是当从本机调用的 this 调用时，它会在该`int[] pixels = new int[width * height];`行崩溃。

所以最后这里是导致崩溃的代码：

```
Bitmap bytes2bitmap(byte[] bytes) {
    Log.d("startup", "Entered MyRenderer.bytes2bitmap()");
    BitmapFactory.Options opt = new BitmapFactory.Options(); 
    opt.inDither = true; 
    opt.inPreferredConfig = Bitmap.Config.ARGB_8888; 
    Bitmap bitmap=BitmapFactory.decodeByteArray(bytes, 0, bytes.length, opt);
    if(bitmap==null) Log.d("running", "ERROR: GLESActivity.java: BitmapFactory() returns null");
    int width = bitmap.getWidth(); 
    int height = bitmap.getHeight(); 
    bytes=null;   //not sure if I should be freeing memory here, but it seems to work
    int[] pixels = new int[width * height];    //crash happens here
    //crashes before doing the following
    bitmap.getPixels(pixels, 0, width, 0, 0, width, height); 
    pixels=null;
    return bitmap;
} 
```

我还没有完成将未压缩的数据正确地传递回本机代码的部分，但我认为我应该首先解决这个问题。

我可以在本机代码中创建一个`int[]`数组来传递，问题是我不知道未压缩的图像大小。

在此先感谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T19:04:18.347

我解决了我的问题，这是我没有显示的代码中的错误。

问题出`(*preset_env)->CallVoidMethod(preset_env, preset_javaobject,preset_method_id_convertimagefromnative,`在本机代码中的调用中。变量 preset_env、_javaobject、_method_id_ 设置不正确。我在启动时将它们设置一次，以便以后使用本机函数 _setupnative2java() 重新使用。我的项目中有三个课程。我的错误是从我的第一个 Activity 类调用 _setupnative2java()，而不是实际包含 java 方法 bytes2bitmap() 的 MyRenderer 类。在调试过程中，我将这个函数的另一个副本放在第一个同名的 Activity 类中。所以它有点工作，但它的指针是错误的。奇怪的是，对 MyRenderer 的修改和 logcat 调用会起作用。

我实际上确实从 MyRenderer 类中调用了它，但是从带有 instancename.MyRenderer.setupnative2java 的启动 Activity 类中调用它。但也许因为它是从另一个类调用的，所以它没有获取 MyRenderer 的指针。另外，我不确定 MyRenderer 到底是如何“初始化”的。如果您为此花费了脑力，我深表歉意。

```
void Java_com_pitransviewersingleimageres_MyRenderer_setupnative2java(JNIEnv* env, jobject,javaThis, jint unused_variable) 
    {
    jthrowable exception;
    jclass class_id;
    preset_env=env;
    preset_javaobject=javaThis;
    class_id = (*env)->GetObjectClass(env, javaThis);
    if(class_id!=NULL)
       {
       preset_method_id_convertimagefromnative = (*env)->GetMethodID(env, class_id, "convertImageFromNative", "([BILjava/lang/String;Ljava/lang/String;I)V");  
       }
... 
```

# class - 如何在python中使用带有'for-in'的对象？

> ID：12428655
> 
> 赞同：0
> 
> 时间：2012-09-14T16:39:39.800
> 
> 标签：class, python-2.7, iteration

我写了一个矢量类，我希望能够写出类似的东西

```
x = Vector([1,2,3])
for i in x:
    #do stuff 
```

有没有像 __ add __ 这样的特殊方法可以定义来做这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:51:00.563

您要定义`__iter__`：

```
>>> class Vector(object):
...     def __init__(self, vec):
...         self.data = vec[:]
...     def __iter__(self):
...         for i in self.data:
...             yield i
... 
>>> x = Vector([1,2,3])
>>> x
<__main__.Vector object at 0xb728210c>
>>> for i in x:
...     print i
... 
1
2
3 
```

或者在这种情况下，你可以逃脱

```
>>> class Vector(object):
...     def __init__(self, vec):
...         self.data = vec[:]
...     def __iter__(self):
...         return iter(self.data)
... 
>>> Vector([1,2,3])
<__main__.Vector object at 0x914722c>
>>> list(Vector([1,2,3]))
[1, 2, 3]
>>> 
```

等等。

# java - 模拟生成随机值的私有方法的建议

> ID：12428657
> 
> 赞同：2
> 
> 时间：2012-09-14T16:39:43.570
> 
> 标签：java, hibernate, easymock

在 DocInfoServiceImpl 中，我有以下方法，我正在尝试使用 easymock 进行模拟。但我不清楚如何返回使用随机 uuid 值（相关性和 docfamily）创建并从私有方法返回的 docInfo 对象？

```
public void saveDocInfo(String docId)
        {
            **DocInfo docInfo = createDocInfo(docId);**
            LOG.debug("Attempting to persist the doc info object for docId [" + docId + "]");
            docInfoDao.save(docInfo);
            LOG.debug("Persisted the doc info object for docId [" + docId + "]");
        }

        private DocInfo createDocInfo(String docId)
        {
            final DocInfo docInfo = new DocInfo();
            docInfo.setId(docId);
            docInfo.setDocFamilyUuid(UUIDGenerator.getInstance().getUuidAsString());
            docInfo.setCorrelationId(UUIDGenerator.getInstance().getUuidAsString());
            return docInfo;
        } 
```

在我正在使用的测试中，mockDocInfoDao.save 在第 3 行的服务的 saveDocInfo 中被调用。

```
void testSave()
    {
        def String docId = 'I19292800fe1911e0a849005056932b99'
        mockDocInfoDao.save(expectedDocInfo)
        replay(mockDocInfoDao)

        docInfoServiceImpl.saveDocInfo(docId)

        verify(mockDocInfoDao)
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T15:45:44.143

我在您的代码中看到的最大缺陷是使用静态方法。它确实加强了测试任务（请参阅此视频[http://www.youtube.com/watch?v=XcT4yYu_TTs](http://www.youtube.com/watch?v=XcT4yYu_TTs)）。

你能以某种方式更新 UUIDGenerator 类吗？也许您可以使用调用此 UUIDGenerator 的实例方法创建一个适配器类？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:57:01.130

私有方法并不意味着要进行测试，因为它们可能会发生变化。

使用 EasyMock，您将检查 saveDocInfo 中是否至少调用了一次保存。所以你可以实例化 DocInfo 并将它传递给 testSave()

```
 void testSave()     {
     def String docId = 'I19292800fe1911e0a849005056932b99'
     mockDocInfoDao.save(new DocInfo())
     replay(mockDocInfoDao)

     docInfoServiceImpl.saveDocInfo(docId)

     verify(mockDocInfoDao)
 } 
```

# amazon-web-services - 自动处理退回和投诉通知的 Amazon SES 通知

> ID：12428664
> 
> 赞同：12
> 
> 时间：2012-09-14T16:40:31.267
> 
> 标签：amazon-web-services, email, notifications, email-bounces

我们使用 AWS SES 发送邮件。Amazon SES 通过[电子邮件或 AWS SNS](http://sesblog.amazon.com/post/TxJE1JNZ6T9JXK/Handling-Bounces-and-Complaints)发送退回和投诉通知。我们希望自动处理退回和投诉通知（来自电子邮件或 AWS SNS）以提取电子邮件 ID，以便可以从原始列表中删除这些电子邮件。

一种自动化方法是将这些通知发送到 AWS SNS 中的主题，然后使用 AWS SQS 订阅该主题，最后读取 AWS SQS 中的消息。SNS 支持通过以下协议订阅 - HTTP/HTTPS/EMail/EMail(JSON)/SMS/SQS。这是可行的，但我发现它对于自动处理退回和投诉通知的简单任务来说太麻烦了。

有什么优雅的方法可以解决这个问题吗？

* * *

我在亚马逊上找到了[一篇博客文章](http://sesblog.amazon.com/post/TxJE1JNZ6T9JXK/Handling-Bounces-and-Complaints)，其中包含 C# 中的代码。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T22:47:33.627

我发现使用 HTTP 端点直接订阅 SNS 是最直接的方法。您实际上只需要编写几行代码。这是我的 Django 示例：

```
def process(request):
    json = request.raw_post_data              
    js = simplejson.loads(json)
    info = simplejson.loads(js["Message"])
    type = info["notificationType"]           # "Complaint" or "Bounce"
    email = info["mail"]["destination"][0]

    # do whatever you want with the email 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-21T22:08:41.297

通过试验，我想出了一个错误——它适用于 Django，但对我来说做得不错。

首先是模型，然后是请求处理程序......

```
class ComplaintType:
    ABUSE = 'abuse'
    AUTH_FAILURE = 'auth-failure'
    FRAUD = 'fraud'
    NOT_SPAM = 'not-spam'
    OTHER = 'other'
    VIRUS = 'virus'

COMPLAINT_FEEDBACK_TYPE_CHOICES = [
    [ComplaintType.ABUSE, _('Unsolicited email or some other kind of email abuse')],
    [ComplaintType.AUTH_FAILURE, _('Unsolicited email or some other kind of email abuse')],
    [ComplaintType.FRAUD, _('Some kind of fraud or phishing activity')],
    [ComplaintType.NOT_SPAM, _('Entity providing the report does not consider the message to be spam')],
    [ComplaintType.OTHER, _('Feedback does not fit into any other registered type')],
    [ComplaintType.VIRUS, _('A virus was found in the originating message')]
]

class SES_Complaint(models.Model):
    subject = models.CharField(max_length=255)
    message = models.TextField()
    email_address = models.EmailField(db_index=True)
    user_agent = models.CharField(max_length=255)
    complaint_feedback_type = models.CharField(max_length=255, choices=COMPLAINT_FEEDBACK_TYPE_CHOICES)
    arrival_date = models.DateTimeField()
    timestamp = models.DateTimeField()
    feedback_id = models.CharField(max_length=255)

    created = models.DateTimeField(auto_now_add=True)
    modified = models.DateTimeField(auto_now=True)

    class Meta:
        verbose_name = 'SES Complaint'
        verbose_name_plural = 'SES Complaints'

    def get_reason(self):
        return self.get_complaint_feedback_type_display()

class BounceType:
    UNDETERMINED = 'Undetermined'
    PERMANENT = 'Permanent'
    TRANSIENT = 'Transient'

class BounceSubType:
    UNDETERMINED = 'Undetermined'
    GENERAL = 'General'
    NO_EMAIL = 'NoEmail'
    SUPPRESSED = 'Suppressed'
    MAILBOX_FULL = 'MailboxFull'
    MESSAGE_TOO_LARGE = 'MessageToolarge'
    CONTENT_REJECTED = 'ContentRejected'
    ATTACHMENT_REJECTED = 'AttachmentRejected'

BOUNCE_TYPE_CHOICES = [
    [BounceType.UNDETERMINED, _('Unable to determine a specific bounce reason')],
    [BounceType.PERMANENT, _('Unable to successfully send')],
    [BounceType.TRANSIENT, _('All retry attempts have been exhausted')],
]

BOUNCE_SUB_TYPE_CHOICES = [
    [BounceSubType.UNDETERMINED, _('Unable to determine a specific bounce reason')],
    [BounceSubType.GENERAL, _('General bounce. You may be able to successfully retry sending to that recipient in the future.')],
    [BounceSubType.NO_EMAIL, _('Permanent hard bounce. The target email address does not exist.')],
    [BounceSubType.SUPPRESSED, _('Address has a recent history of bouncing as invalid.')],
    [BounceSubType.MAILBOX_FULL, _('Mailbox full')],
    [BounceSubType.MESSAGE_TOO_LARGE, _('Message too large')],
    [BounceSubType.CONTENT_REJECTED, _('Content rejected')],
    [BounceSubType.ATTACHMENT_REJECTED, _('Attachment rejected')]
]

class SES_Bounce(models.Model):
    subject = models.CharField(max_length=255)
    message = models.TextField()
    bounce_type = models.CharField(max_length=255, choices=BOUNCE_TYPE_CHOICES)
    bounce_sub_type = models.CharField(max_length=255, choices=BOUNCE_SUB_TYPE_CHOICES)
    timestamp = models.DateTimeField()
    feedback_id = models.CharField(max_length=255)
    status = models.CharField(max_length=255)
    action = models.CharField(max_length=255)
    diagnostic_code = models.CharField(max_length=255)
    email_address = models.EmailField(db_index=True)

    created = models.DateTimeField(auto_now_add=True)
    modified = models.DateTimeField(auto_now=True, db_index=True)

    class Meta:
        verbose_name = 'SES Bounce'
        verbose_name_plural = 'SES Bounces'

    def get_reason(self):
        return '%s - %s' % (self.get_bounce_type_display(), self.get_bounce_sub_type_display()) 
```

这是请求处理程序：

```
@csrf_exempt
def aws_sns(request):
    logger.debug('Incoming SNS')

    if request.method == 'POST':

        logger.debug('Incoming SNS is POST')

        sns_message_type = request.META.get('HTTP_X_AMZ_SNS_MESSAGE_TYPE', None)

        if sns_message_type is not None:

            logger.debug('Incoming SNS - %s', sns_message_type)

            json_body = request.body
            json_body = json_body.replace('\n', '')
            js = loads(json_body)

            if sns_message_type == "SubscriptionConfirmation":

                subscribe_url = js["SubscribeURL"]
                logger.debug('Incoming subscription - %s', subscribe_url)
                urllib.urlopen(subscribe_url)

            elif sns_message_type == "Notification":

                message = js.get("Message", None)
                message = message.replace('\n', '')
                message = loads(message)

                notification_type = message.get("notificationType", None)

                if notification_type == 'AmazonSnsSubscriptionSucceeded':
                    logger.debug('Subscription succeeded')

                elif notification_type == 'Bounce':

                    logger.debug('Incoming bounce')

                    bounce = message['bounce']
                    bounce_type = bounce['bounceType']
                    bounce_sub_type = bounce['bounceSubType']
                    timestamp = bounce['timestamp']
                    feedback_id = bounce['feedbackId']

                    bounce_recipients = bounce['bouncedRecipients']

                    for recipient in bounce_recipients:
                        status = recipient.get('status')
                        action = recipient.get('action')
                        #diagnostic_code = recipient['diagnosticCode']
                        email_address = recipient['emailAddress']

                        SES_Bounce.objects.filter(email_address=email_address).delete()

                        SES_Bounce.objects.create(
                            message=message,
                            bounce_type=bounce_type,
                            bounce_sub_type=bounce_sub_type,
                            timestamp=timestamp,
                            feedback_id=feedback_id,
                            status=status,
                            action=action,
                            #diagnostic_code=diagnostic_code,
                            email_address=email_address
                        )

                elif notification_type == 'Complaint':

                    logger.debug('Incoming complaint')

                    complaint = message['complaint']

                    user_agent = complaint.get('userAgent')
                    complaint_feedback_type = complaint.get('complaintFeedbackType')
                    arrival_date = complaint.get('arrivalDate')

                    timestamp = complaint['timestamp']
                    feedback_id = complaint['feedbackId']
                    recipients = complaint['complainedRecipients']

                    for recipient in recipients:
                        email_address = recipient['emailAddress']

                        SES_Complaint.objects.filter(email_address=email_address).delete()

                        SES_Complaint.objects.create(
                            #subject=subject,
                            message=message,
                            email_address=email_address,
                            user_agent=user_agent,
                            complaint_feedback_type=complaint_feedback_type,
                            arrival_date=arrival_date,
                            timestamp=timestamp,
                            feedback_id=feedback_id
                        )

                else:
                    logger.exception('Incoming Notification SNS is not supported: %s', notification_type)

            return HttpResponse()
        else:
            logger.exception('Incoming SNS did not have the right header')

            for key, value in request.META.items():
                logger.debug('Key: %s - %s', key, value)

    else:
        logger.exception('Incoming SNS was not a POST')

    return HttpResponseBadRequest() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T15:04:04.453

我认为你描述的方式可能是最优雅的方式。您已经在 SNS 和 SQS 中拥有非常合适的服务，这些服务与大多数主要语言的 SDK 相关联，让您可以轻松地做您需要的事情。最困难的部分是编写代码来更新/删除邮件列表中的记录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-06T16:19:15.063

最近，我能够通过 SNS 使用 HTTP 端点来完成这项工作。我使用 python/django 来使用通知。在使用通知之前，您必须先处理订阅消息；您可以在 SNS 文档中阅读有关订阅的信息。

我想如果您有一个较小的应用程序，它不会发送很多电子邮件；http端点应该可以正常工作。此代码要求您创建通知模型。

```
#process an amazon sns http endpoint notification for amazon ses bounces and complaints
@csrf_exempt
def process_ses_notification(request):

    if request.POST:

        json_body = request.body
        #remove this control character(throws an error) thats present inside the test subscription confirmation
        js = loads(json_body.replace('\n', ''))

        if js["Type"] == "SubscriptionConfirmation":

             subscribe_url = js["SubscribeURL"]
             urllib.urlopen(subscribe_url)
             return HttpResponse(status=200)

    elif js["Type"] == "Notification":

        #process message from amazon sns
        arg_info = loads(js["Message"]) # may need to use loads(js["Message"]) after testing with amazon
        arg_notification_type = arg_info["notificationType"]

        if arg_notification_type == 'Bounce':
            #required bounce object fields
            arg_emails=arg_info["bounce"]["bouncedRecipients"]
            arg_notification_subtype=arg_info["bounce"]["bounceType"]
            arg_feedback_id=arg_info["bounce"]["feedbackId"]
            arg_date_recorded=arg_info["bounce"]["timestamp"]
        elif arg_notification_type == 'Complaint':
            #required complaint object fields
            arg_emails=arg_info["complaint"]["complainedRecipients"]
            arg_feedback_id=arg_info["complaint"]["feedbackId"]
            arg_date_recorded=arg_info["complaint"]["timestamp"]
            #check if feedback type is inside optional field name
            if "complaintFeedbackType" in arg_info["complaint"]:
                arg_notification_subtype=arg_info["complaint"]["complaintFeedbackType"]
            else:
                arg_notification_subtype=""
        else:
            HttpResponse(status=400)

        #save notifications for multiple emails
        for arg_email in arg_emails:
            notification = SES_Notification(info=json_body, notification_type=arg_notification_type, 
                                            email=arg_email["emailAddress"], notification_subtype=arg_notification_subtype, 
                                            date_recorded=arg_date_recorded, feedback_id=arg_feedback_id)
            notification.save()
        return HttpResponse(status=200)

return HttpResponse(status=400) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-24T13:33:44.020

上面的所有答案都很棒，但只是一个小而重要的补充：

您首先需要验证请求是否来自 amazon sns：（如[验证 Amazon SNS 消息的签名中](http://docs.aws.amazon.com/sns/latest/dg/SendMessageToHttp.verify.signature.html)所述）

对于验证签名的python代码 - 一个很好的例子是[here](https://gist.github.com/amertkara/e294562759ff2755486e)

# sql-server-2008 - 从 SQL varbinary 字段计算大小（以兆字节为单位）

> ID：12428670
> 
> 赞同：31
> 
> 时间：2012-09-14T16:40:51.950
> 
> 标签：sql-server-2008

我们有一个将文件存储为 varbinary(MAX) 的 db 表。当我们运行以下脚本时：

```
SELECT SUM(LEN(Content)) FROM dbo.File 
```

结果是：

> 35398663

我想把这个数字转换成兆字节？这可能吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-09-14T16:44:41.310

用于[`DATALENGTH`](http://sqlfiddle.com/#!18/6df92/291)检索字节数，然后进行转换，如下所示：

[SQL小提琴](http://sqlfiddle.com/#!18/6df92/291)

**MS SQL Server 2017 架构设置**：

```
CREATE TABLE supportContacts 
    (
     id int identity primary key, 
     type varchar(20), 
     details varchar(30)
    );

INSERT INTO supportContacts
(type, details)
VALUES
('Email', 'admin@sqlfiddle.com'),
('Twitter', '@sqlfiddle'); 
```

**查询 1**：

```
select *, gigabytes / 1024.0 as terabytes
from (
  select *, megabytes / 1024.0 as gigabytes
  from (
    select *, kilobytes / 1024.0 as megabytes
    from (
      select *, bytes / 1024.0 as kilobytes
      from (
        select sum(datalength(details)) as bytes
        from supportContacts       
      ) a
    ) b  
  ) c
) d 
```

**[结果](http://sqlfiddle.com/#!18/6df92/291/0)**：

```
| bytes | kilobytes |     megabytes |      gigabytes |         terabytes |
|-------|-----------|---------------|----------------|-------------------|
|    29 |   0.02832 | 0.00002765625 | 2.700805664e-8 | 2.63750553125e-11 | 
```

# ruby-on-rails - 使用 Chef/Vagrant 在虚拟机上部署 Rails 应用程序时出错

> ID：12428673
> 
> 赞同：0
> 
> 时间：2012-09-14T16:41:09.763
> 
> 标签：ruby-on-rails, chef-infra, vagrant

当我尝试使用 Vagrant/Chef 为 Rails 应用程序设置开发环境时遇到错误。该错误来自 opscode 提供的应用程序说明书，但我无法弄清楚。我假设我缺少配置设置，但文档非常稀疏。错误和相关文件的完整详细信息如下。

我收到的错误日志：

```
.
.
.
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: execute[passenger_module] ran successfully
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing template[/etc/apache2/mods-available/passenger.load] action create (passenger_apache2::mod_rails line 28)
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing template[/etc/apache2/mods-available/passenger.conf] action create (passenger_apache2::mod_rails line 37)
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing execute[a2enmod passenger] action run (passenger_apache2::mod_rails line 38)
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing directory[/vagrant/rails] action create (/vagrant/cookbooks/application/providers/default.rb line 75)
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: directory[/vagrant/rails] owner changed to 998
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: directory[/vagrant/rails] group changed to 33
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: directory[/vagrant/rails] mode changed to 755
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing directory[/vagrant/rails/shared] action create (/vagrant/cookbooks/application/providers/default.rb line 82)
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: directory[/vagrant/rails/shared] owner changed to 998
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: directory[/vagrant/rails/shared] group changed to 33
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: directory[/vagrant/rails/shared] mode changed to 755
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing ruby_block[basic-rails before_deploy] action create (/vagrant/cookbooks/application/providers/default.rb line 107)
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing application_ruby_rails[basic-rails] action before_deploy (basic-rails::default line 109)
[Fri, 14 Sep 2012 16:25:13 +0000] INFO: Processing application_ruby_passenger_apache2[basic-rails] action before_deploy (basic-rails::default line 109)
[Fri, 14 Sep 2012 16:25:13 +0000] ERROR: application_ruby_passenger_apache2[basic-rails] (basic-rails::default line 109) has had an error
[Fri, 14 Sep 2012 16:25:13 +0000] ERROR: ruby_block[basic-rails before_deploy] (/vagrant/cookbooks/application/providers/default.rb line 107) has had an error
[Fri, 14 Sep 2012 16:25:13 +0000] ERROR: ruby_block[basic-rails before_deploy] (/vagrant/cookbooks/application/providers/default.rb:107:in `before_deploy') had an error:
ruby_block[basic-rails before_deploy] (/vagrant/cookbooks/application/providers/default.rb line 107) had an error: Chef::Exceptions::ValidationFailed: application_ruby_passenger_apache2[basic-rails] (basic-rails::default line 109) had an error: Chef::Exceptions::ValidationFailed: Option cookbook must be a kind of String!  You passed :"basic-rails". 
```

我的**Cheffile**的内容- 图书馆员用来检索食谱：

```
#!/usr/bin/env ruby
#^syntax detection

site 'http://community.opscode.com/api/v1'

#Provided Cookbooks

#cookbook 'apt', 
#  git: 'https://github.com/fnichol/chef-apt'
cookbook 'apt'
cookbook 'git', 
  git: 'https://github.com/fnichol/chef-git.git'
cookbook 'build-essential'
cookbook 'rvm', 
  git: 'git://github.com/fnichol/chef-rvm.git', ref: 'v0.9.0'
cookbook 'application',
  git: 'https://github.com/opscode-cookbooks/application'
cookbook 'application_ruby',
  git: 'https://github.com/opscode-cookbooks/application_ruby'
#Custom cookbook
cookbook 'basic-rails',
  path: '~/.chef/cookbooks/basic-rails' 
```

**Vagrantfile**的内容：

```
# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant::Config.run do |config|
  config.vm.box = "precise64"
  config.vm.box_url = "http://files.vagrantup.com/precise64.box"
  config.vm.customize ["modifyvm", :id, "--memory", 1024]
  #config.vm.network :hostonly, "33.33.33.10"

  config.vm.provision :chef_solo do |chef|
    chef.cookbooks_path = ["cookbooks"]
    chef.add_recipe "apt"
    chef.add_recipe "git"
    chef.add_recipe "build-essential"
    chef.add_recipe "rvm::vagrant"
    chef.add_recipe "rvm::system"
    chef.add_recipe "basic-rails" #Once this included I get the error
  end
end 
```

basic-rails 食谱本质上是您使用 create 命令获得的标准食谱，对两个文件进行了修改：

**元数据.rb**

```
depends "application"
depends "application_ruby"
maintainer       "Noone"
maintainer_email "YOUR_EMAIL"
license          "All rights reserved"
description      "Installs/Configures basic-rails"
long_description IO.read(File.join(File.dirname(__FILE__), 'README.md'))
version          "0.1.0" 
```

**默认.rb**

```
user "www-user" do
  system true
  shell "/bin/false"
end
group "www-data" do
  action :modify
  members "www-user"
  append true
end

application "basic-rails" do
  path "/vagrant/rails"
  owner "www-user"
  group "www-data"

  repository #Insert a git repository here containing a rails app, I'm using a private one
  revision "production"

  rails do
    # Rails-specific configuration
    name "basic-rails"
  end

  passenger_apache2 do
    # Passenger-specific configuration
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T11:41:43.860

更新到 Chef 10.14 解决了该问题。

# android - 使用 ping 列出本地网络上的设备

> ID：12428675
> 
> 赞同：7
> 
> 时间：2012-09-14T16:41:14.870
> 
> 标签：android, networking, local, ping

我正在尝试创建一个列出本地网络上所有连接设备的函数。我所做的是将地址空间 xxx0 到 xxx255 的任何地址 ping 通，但它似乎无法正常工作。谁能以某种方式解释或扩展我的代码？我确实收到了电话 (10.0.0.17) 和默认网关 (10.0.0.138) 的回复。后者甚至不应该存在（事实上我不知道默认网关是什么但忽略它）。我错过了这台计算机的 IP。

```
public ArrayList<InetAddress> getConnectedDevices(String YourPhoneIPAddress) {
    ArrayList<InetAddress> ret = new ArrayList<InetAddress>();

    LoopCurrentIP = 0;

    //        String IPAddress = "";
    String[] myIPArray = YourPhoneIPAddress.split("\\.");
    InetAddress currentPingAddr;

    for (int i = 0; i <= 255; i++) {
        try {

            // build the next IP address
            currentPingAddr = InetAddress.getByName(myIPArray[0] + "." +
                    myIPArray[1] + "." +
                    myIPArray[2] + "." +
                    Integer.toString(LoopCurrentIP));

            // 50ms Timeout for the "ping"
            if (currentPingAddr.isReachable(50)) {
                if(currentPingAddr.getHostAddress() != YourPhoneIPAddress){
                    ret.add(currentPingAddr);

                }
            }
        } catch (UnknownHostException ex) {
        } catch (IOException ex) {
        }

        LoopCurrentIP++;
    }
    return ret;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-14T17:33:03.020

这是稍微修改过的循环，应该可以解决问题（或者至少对我有用）；

```
try {
    NetworkInterface iFace = NetworkInterface
            .getByInetAddress(InetAddress.getByName(YourIPAddress));

    for (int i = 0; i <= 255; i++) {

        // build the next IP address
        String addr = YourIPAddress;
        addr = addr.substring(0, addr.lastIndexOf('.') + 1) + i;
        InetAddress pingAddr = InetAddress.getByName(addr);

        // 50ms Timeout for the "ping"
        if (pingAddr.isReachable(iFace, 200, 50)) {
            Log.d("PING", pingAddr.getHostAddress());
        }
    }
} catch (UnknownHostException ex) {
} catch (IOException ex) {
} 
```

# visual-studio-2010 - .datasource 文件

> ID：12428678
> 
> 赞同：2
> 
> 时间：2012-09-14T16:41:55.630
> 
> 标签：visual-studio-2010

当我注意到 Visual Studio 创建了一个 .datasource 文件时，我正要检查一些代码。我的问题是这些文件是什么，应该签入吗？

谢谢。

萨钦

# scala - scala 编译器在哪里存储 AST？

> ID：12428689
> 
> 赞同：7
> 
> 时间：2012-09-14T16:42:39.697
> 
> 标签：scala

编译器代码库非常大，我不能一下子把它全部包起来:)

目前，我只想在“typer”阶段之后获得 AST。有没有办法做到这一点？

我按以下方式运行编译器：

```
val settings = new Settings
settings.classpath.value = ...
val compiler = new Global(settings, new ConsoleReporter(settings))
new compiler.Run() {
  override def stopPhase(name: String) = name == "superaccessors"
} compileSources files 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T19:47:14.240

使用`-Xprint:typer`（在 typer 之后转储树）和`-Yshow-trees-compact`（以原始 AST 格式转储树）。如果您还使用`-Yshow-trees-stringified`，则 AST 将另外转储为伪 Scala 代码（注意：最后两个选项需要 2.10.0）。

```
C:\Projects\Kepler\sandbox @ ticket/6356>cat Test.scala
class C {
  def x = 2
}

C:\Projects\Kepler\sandbox @ ticket/6356>scalac -Xprint:typer -Yshow-trees-compact -Yshow-trees-stringified Test.scala
[[syntax trees at end of typer]]// Scala source: Test.scala
package <empty> {
  class C extends scala.AnyRef {
    def <init>(): C = {
      C.super.<init>();
      ()
    };
    def x: Int = 2
  }
}
PackageDef(
  Ident(<empty>), 
  List(
    ClassDef(Modifiers(), newTypeName("C"), List(), 
      Template(List(Select(Ident(scala), newTypeName("AnyRef"))), emptyValDef, 
      List(
        DefDef(Modifiers(), nme.CONSTRUCTOR, List(), List(List()), TypeTree(), Block(List(Apply(Select(Super(This(newTypeName("C")), tpnme.EMPTY), nme.CONSTRUCTOR), List())), Literal(Constant(())))), 
        DefDef(Modifiers(), newTermName("x"), List(), List(), TypeTree(), Literal(Constant(2)))))))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T07:03:48.403

> 编译器代码库非常大，我不能一下子把它全部包起来:)

除了所有重要的 typer 之外，Scala 编译器的大多数阶段都在以下位置进行了详细描述：

[http://lampwww.epfl.ch/~magarcia/ScalaCompilerCornerReloaded/](http://lampwww.epfl.ch/~magarcia/ScalaCompilerCornerReloaded/)

# jquery - 多选选项

> ID：12428698
> 
> 赞同：1
> 
> 时间：2012-09-14T16:43:11.293
> 
> 标签：jquery, select

我正在尝试在下面的 select multiple by there value 中选择项目。代码如下：

```
<select id="genre" name="genre" multiple="multiple" size="9">
    <option value="1">Action</option>
    <option value="2">Adult</option>
    <option value="3">Adventure</option>
    <option value="4">Comedy</option>
    <option value="5">Drama</option>
</select> 
```

我可以选择一两个选项，但问题是所选选项的数量来自用户，我将其更改为如下内容：（`1,2,4` *按值）*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:50:37.290

很难确定您要查找的内容，但是由于您要选择多个项目并将其标记为 jquery ...

```
$('#genre').val([1,2,4]).each(function () {
    $(this).attr('selected', 'selected'); 
```

});​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:49:08.960

您可以通过将一组值传递给[`.val()`](http://api.jquery.com/val/#val2)函数来选择多个选项：

```
$("#genre").val([1,2,4]); 
```

如果您有一个逗号分隔的字符串而不是数组，则只需使用 , 将其转换为数组`split()`，然后将其传递给`.val()`：

```
$("#genre").val("1,2,4".split(",")); 
```

从文档：

> **[`.val( value )`](http://api.jquery.com/val/#val2)**
> 
> **`value`****- 与每个匹配元素的值**相对应 的文本字符串或字符串数**​​组，**以设置为选中/选中。

# objective-c - CoreData：获取父母的孩子

> ID：12428701
> 
> 赞同：1
> 
> 时间：2012-09-14T16:43:14.213
> 
> 标签：objective-c, ios, core-data

我有一个包含许多一对多关系的父级的 CoreData 模型。只有一个 MenuList，但每个子菜单包含许多条目。

```
MenuList
-------
WineMenu (one-to many relationship)
BeerMenu (one-to many relationship)
FoodMenu (one-to many relationship) 
```

是否可以直接从父级访问子级菜单？

我正在获取这样的 MenuList：

```
NSArray *theMenuList = [managedObjectContext executeFetchRequest:fetchRequest error:&error]; 
```

MenuList 中只有一个对象。我无法做到这一点：

```
theMenuList.wineMenu.wineName 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:14:18.870

好吧，如果您确定您的数据库中始终只有一个 MenuList 实例，您可以简单地从返回的数组中获取一个对象并使用它。

```
NSArray *menuLists = [managedObjectContext executeFetchRequest:fetchRequest error:&error];
MenuList *theMenuList = [menuLists lastObject];
NSLog(@"Wine name: %@", theMenuList.wineMenu.wineName); 
```

# wpf - 为什么在 VS2010 中 WPF 应用程序会重复所有警告两次，我该如何停止？

> ID：12428705
> 
> 赞同：1
> 
> 时间：2012-09-14T16:43:36.337
> 
> 标签：wpf, visual-studio-2010, xaml

在 VS2010 中创建一个新的 WPF 应用程序。在 MainWindow.cs 中声明一个未使用的局部变量以生成编译器警告，如下所示：

```
namespace WpfApplication4
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            int i = 0;
        }
    }
} 
```

构建应用程序。输出将如下所示：

```
------ Rebuild All started: Project: WpfApplication4, Configuration: Debug x86 ------
D:\_UserData\Development\Workspaces\DotnetTesting\WpfApplication4\WpfApplication4\MainWindow.xaml.cs(25,8): warning CS0219: The variable 'i' is assigned but its value is never used

Compile complete -- 0 errors, 1 warnings
  WpfApplication4 -> D:\_UserData\Development\Workspaces\DotnetTesting\WpfApplication4\WpfApplication4\bin\Debug\WpfApplication4.exe
========== Rebuild All: 1 succeeded, 0 failed, 0 skipped ========== 
```

请注意，只有一次提到未使用的变量“i”。现在在 MainWindow.xaml 中添加对本地命名空间的引用，如下所示：

```
<Window x:Class="WpfApplication4.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication4"
    Title="MainWindow" Height="350" Width="525">
    <Grid>

    </Grid>
</Window> 
```

现在重建，输出如下所示：

```
------ Rebuild All started: Project: WpfApplication4, Configuration: Debug x86 ------
D:\_UserData\Development\Workspaces\DotnetTesting\WpfApplication4\WpfApplication4\MainWindow.xaml.cs(25,14): warning CS0219: The variable 'i' is assigned but its value is never used

Compile complete -- 0 errors, 1 warnings
MainWindow.xaml.cs(25,14): warning CS0219: The variable 'i' is assigned but its value is never used
  WpfApplication4 -> D:\_UserData\Development\Workspaces\DotnetTesting\WpfApplication4\WpfApplication4\bin\Debug\WpfApplication4.exe
========== Rebuild All: 1 succeeded, 0 failed, 0 skipped ========== 
```

请注意，现在有两次提到未使用的变量“i”。

为什么会这样，我该如何阻止它发生？

编辑

我已经想出了如何让它停止。只需添加本地程序集的名称以及命名空间，如下所示：

```
<Window x:Class="WpfApplication4.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication4;assembly=WpfApplication4"
    Title="MainWindow" Height="350" Width="525">
    <Grid>

    </Grid>
</Window> 
```

不幸的是，这不是一个解决方案，因为在 WPF exe 中引用本地程序集中的命名空间时，您不允许在命名空间声明中提供程序集的名称。这将构建，但是如果您尝试在本地程序集中引用一个类型，如果指定了程序集名称，它将失败。使用 xmlns:local="clr-namespace:WpfApplication4;assembly=" 语法会返回双重警告。

PS 为什么投反对票？不加评论的否决投票是蹩脚的，如果你不告诉我你不喜欢这个问题，我应该如何改进这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T16:35:50.457

这是因为这是MS不会修复的VS2010中的错误。

[https://connect.microsoft.com/VisualStudio/feedback/details/763045/adding-a-xaml-namespace-reference-to- contains-assembly-corrupts-build-output](https://connect.microsoft.com/VisualStudio/feedback/details/763045/adding-a-xaml-namespace-reference-to-containing-assembly-corrupts-build-output)

# java - 可以从 Matlab 中引用 Java 类源文件吗？

> ID：12428710
> 
> 赞同：0
> 
> 时间：2012-09-14T16:43:57.330
> 
> 标签：java, matlab, compiler-construction, compilation

当我们提到`.jar`档案时，版本可能会出现问题。

但是是否可以引用要由 Matlab 编译的源文件？

存在这样的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:12:18.550

试试在 matlab 命令窗口中输入 !javac 它看起来和你在系统控制台中使用的一样

# iphone - 有没有办法在未提交 Ad-Hoc 分发的设备上测试 iOS 应用程序？

> ID：12428714
> 
> 赞同：2
> 
> 时间：2012-09-14T16:44:09.983
> 
> 标签：iphone, ios, xcode, app-store, ad-hoc-distribution

在我的理学硕士项目中创建了我的第一个 iOS 应用程序后，我现在需要将它（连同我的报告一起）发送给考官（基本上将它上传到大学的网站（通过 Moodle））。

但是，我不可能知道考官是*谁，也不知道**他们*的iPhone的*任何*信息

 *所以我无法提交我的应用程序以进行 Ad-Hoc 分发，因为我不知道要包含哪些设备！

是否有其他方法（除了找到考官并询问他们所有必要的细节）？

还是我基本上必须自己在自己的设备上演示该应用程序（由于我自己拥有 iOS 开发人员权限，因此当前安装了该应用程序）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:53:23.043

看起来你很好地掌握了这里的选项：

1.  使用您自己的开发设备并亲自演示或借出设备。
2.  收集他们的 UDID 以供临时使用（您可以使用 TestFlight 或 HockeyApp 让他们和您更轻松地完成此过程）。

（如果您支付更多的钱并证明您是一家企业，那么有一个“企业”证书可以满足您的大部分需求，因此在这种情况下它并不是一个真正的选择）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:49:34.390

在我无法亲自演示或无法获得需要演示的人员的设备 ID 的情况下，我使用 Quicktime 屏幕截图来捕捉我在模拟器中演示设备的过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T18:47:15.400

在这里再次为 TestFlight 投票。基本上流程是

*   获取测试人员的电子邮件地址
*   向他们发送 TF 邀请
*   受邀者响应，提供他们的设备 ID
*   您将设备 ID 添加到您的配置文件中，构建应用程序并将其上传到 TF
*   TF 通过电子邮件将安装链接发送给您的测试用户。

这不是一个完全理想的解决方案，因为它仍然需要您获取有关审查员的一些信息 - 但如果您的大学正在接受 iOS 应用程序作为理学硕士项目，我认为您可以合理地争辩说他们需要与您会面过程。*

# html - CSS不能在不同的机器上工作

> ID：12428719
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:44:16.437
> 
> 标签：html, css

有时回来，我开发了一个小型 Web 应用程序来学习 CSS 和 Ajax。当我在谷歌应用引擎上部署它时，在我的机器上它看起来像预期的那样。但是，当我在其他计算机上访问它时，对齐、按钮样式、表格定位一切看起来都很奇怪。在 IE 上，问题很严重，没有任何工作正常。现在我到目前为止所做的：

1.  我已将 Mayers reset.css 包括在内，认为这可能对我有所帮助。但我不知道如何有效地使用它？我有我的 style.css 文件，我在 reset.css 之后包含在每个网页中。我没有更改 reset.css 中的任何内容
2.  早些时候，我使用 'px' 进行 div 和元素定位。现在，将所有内容更改为使用百分号，但仍然没有运气。

让我知道你们是否需要我的代码。它很大，这就是为什么不在这里提供的原因。`这是您可以检查的[应用程序链接](http://myentrancetest.appspot.com/)，但我敢打赌，它在我的笔记本电脑中看起来要好得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:20:36.650

首先，在开发网页时尽量遵循一些标准：

[http://validator.w3.org/check?uri=http%3A%2F%2Fmyentrancetest.appspot.com%2F&charset=%28detect+automatically%29&doctype=Inline&group=0](http://validator.w3.org/check?uri=http%3A%2F%2Fmyentrancetest.appspot.com%2F&charset=%28detect+automatically%29&doctype=Inline&group=0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:52:30.707

首先，我建议你声明 HTML DOCTYPE：

[http://en.wikipedia.org/wiki/Document_Type_Declaration](http://en.wikipedia.org/wiki/Document_Type_Declaration)

它决定了浏览器用来呈现页面的布局模式......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:56:49.157

从快速的源代码视图中，我发现了这一点；

```
#login_hr{
  position: absolute;
  width: 400%;
  color: #4F32F0;
} 
```

为什么是 400%？我认为它正在将您的页面延伸到外面。将其更改为 100%。试试看。

# chef-infra - 确定 IP 地址是公共的还是私有的以用于厨师食谱

> ID：12428721
> 
> 赞同：1
> 
> 时间：2012-09-14T16:44:20.183
> 
> 标签：chef-infra, opensolaris, recipe, smartos

我正在使用 Chef 自动部署各种 SmartOS 区域。我试图找出确定网络接口是否具有公共或私有地址并跟踪它的正确方法。对于通用 Apache Listen 和 NameVirtualHost 指令，以下内容就足够了：

```
ips = []
links = %x{dladm show-vnic -o link | grep -v LINK}.strip.split("\n")
links.each do |link|
  ips << %x{ifconfig #{link} | grep inet | awk '{ print $2 }'}.strip
end 
```

对于 ipfilter 规则，我需要有两类不同的规则。应用于公共接口然后将不同的集合应用于私有接口的规则。我应该通过 json 配置文件将所有接口传递给厨师，而不是在食谱中弄清楚吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T13:54:23.950

ohai 在运行时生成属性数据。

特别是您可能感兴趣

`$ sudo ohai network/interfaces`

和相关的

`node["network"]["interfaces"]`

您仍然必须拒绝 RFC1918 inet4 地址并检查链接范围是全局的 inet6

# sql - 列名或提供的值的数量与表定义不匹配

> ID：12428725
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:44:29.200
> 
> 标签：sql, sql-server-2008

我有 2 个表。UniversityReg 和登录。当大学注册到系统时，一般详细信息转到 UniversityReg 表，登录详细信息转到登录表。使用范围标识它需要最后一个 id。但是上面提到的错误显示。

大学注册表

```
[UniversityId] [int] IDENTITY(1,1) NOT NULL,
[Username] [varchar](50) NULL,
[Password] [varchar](50) NULL,
[UniversityName] [varchar](50) NULL,
[GovernmentRegNo] [varchar](50) NULL,
[Country] [varchar](50) NULL,
[CreatedBy] [varchar](50) NULL,
[ShortCode] [varchar](50) NULL, 
```

登录表

```
[LoginID] [int] NOT NULL,
[UserName] [nvarchar](50) NOT NULL,
[Password] [nvarchar](50) NOT NULL,
[ShortCode] [nvarchar](50) NULL 
```

SupporterReg 表

```
[SupporterId] [int] NOT NULL,
[SupporterName] [varchar](50) NULL,
[University] [varchar](50) NULL,
[ContactNo] [varchar](50) NULL,
[Email] [varchar](50) NULL,
[StudentLocation] [varchar](50) NULL,
[ImagePath] [varchar](50) NULL,
[ShortCode] [varchar](50) NULL, 
```

要插入数据，我使用以下存储过程，

```
 CREATE PROCEDURE [dbo].[UniversityReg_SP]
    (
@Username varchar(50),
@Password varchar(50),
@UniversityName varchar(50) ,
@GovernmentRegNo varchar(50) ,
@Country varchar(50) ,
@CreatedBy varchar(50)

    )
AS
DECLARE @LoginID int
INSERT INTO UniversityReg   values(@UniversityName,@GovernmentRegNo,@Country,@CreatedBy,'UNI')

SET @LoginID = SCOPE_IDENTITY();

INSERT INTO Login values(@LoginID,@Username,@Password,'UNI')

RETURN 
```

错误是什么？我看不到任何表格错误...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:49:51.913

您插入 UniversityReg 的值太少。

注意这种类型的插入被认为是不好的做法 - 考虑指定您要插入的列，例如

代替：

```
insert into table values(x,y,z) 
```

做：

```
insert into table (col1,col2,col3) values(x,y,z) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:50:19.693

您必须使用代码：

```
INSERT INTO UniversityReg(UniversityName,GovernmentRegNo,Country,CreatedBy,ShortCode)
values(@UniversityName,@GovernmentRegNo,@Country,@CreatedBy,'UNI') 
```

表`UniversityReg`有 7 列，但在您的插入中有 5 列。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-13T19:09:55.987

```
 private void btninsert_Click(object sender, EventArgs e)
    {
        try
        {
            con.Open();
            cmd = new SqlCommand("insert into Empinfo values ('" + textBox1.Text + "''" + textBox2.Text + "''" + textBox3.Text + "''" + textBox4.Text + "')", con);

            cmd.ExecuteNonQuery();
            MessageBox.Show("Insert the record");
            cmd.Dispose();
        }
        catch(Exception e1)
            {
                MessageBox.Show("e1");
            }
            finally
        {

        con.Close();

    }
    } 
```

# java - 如何使用 JAXB 编组有时包含 XML 内容有时不包含的字符串？

> ID：12428727
> 
> 赞同：4
> 
> 时间：2012-09-14T16:44:29.233
> 
> 标签：java, serialization, jaxb

考虑这个例子 -

我有一个名为 Report 的类，它有一个 Message 类型的字段。Message 类有一个名为“body”的字段，它是一个字符串。“body”可以是任何字符串，**但有时它包含格式正确的 XML 内容**。如何确保当“正文”包含 XML 内容时，序列化采用 XML 结构的形式，而不是它目前给出的形式？

这是带有输出的代码 -

**报告**类

```
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

@XmlRootElement(name = "Report")
@XmlType(propOrder = { "message"})
public class Report
{
    private Message message;
    public Message getMessage() { return message; }
    public void setMessage(Message m) { message = m; }
} 
```

**消息**类

```
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlType;

@XmlType(propOrder = { "body" })
public class Message
{
    private String body;
    public String getBody() { return body; }
    @XmlElement
    public void setBody(String body) { this.body = body; }
} 
```

主要的

```
import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;

public class SerializationTest
{
    public static void main(String args[]) throws Exception
    {
       JAXBContext jaxbContext = JAXBContext.newInstance(Report.class);
       Marshaller jaxbMarshaller = jaxbContext.createMarshaller();
       jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

       Report report = new Report();
       Message message = new Message();

       message.setBody("Sample report message.");
       report.setMessage(message);
       jaxbMarshaller.marshal(report, System.out);

       message.setBody("<rootTag><body>All systems online.</body></rootTag>");
       report.setMessage(message);
       jaxbMarshaller.marshal(report, System.out);
    }
} 
```

输出如下 -

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Report>
    <message>
        <body>Sample report message.</body>
    </message>
</Report>
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Report>
    <message>
        <body>&lt;rootTag&gt;&lt;body&gt;All systems online.&lt;/body&gt;&lt;/rootTag&gt;</body>
    </message>
</Report> 
```

正如您在上面的输出中看到的，对于“body”的第二个实例，产生的序列化

```
 <body>&lt;rootTag&gt;&lt;body&gt;All systems online.&lt;/body&gt;&lt;/rootTag&gt;</body> 
```

代替

```
<body><rootTag><body>All systems online.</body></rootTag></body> 
```

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T17:22:40.240

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

这个用例是使用注解映射`@XmlAnyElement`并指定一个`DOMHandler`. 使用 JAXB RI 执行此操作时似乎存在错误，但以下用例适用于 EclipseLink JAXB (MOXy)。

**BodyDomHandler**

默认情况下，JAXB 实现会将未映射的内容表示为 DOM 节点。您可以利用 a`DomHandler`来替代 DOM 的表示形式，在这种情况下，我们将 DOM 表示为`String`.

```
import java.io.*;
import javax.xml.bind.ValidationEventHandler;
import javax.xml.bind.annotation.DomHandler;
import javax.xml.transform.Source;
import javax.xml.transform.stream.*;

public class BodyDomHandler implements DomHandler<String, StreamResult> {

    private static final String BODY_START_TAG = "<body>";
    private static final String BODY_END_TAG = "</body>";

    private StringWriter xmlWriter = new StringWriter();

    public StreamResult createUnmarshaller(ValidationEventHandler errorHandler) {
        return new StreamResult(xmlWriter);
    }

    public String getElement(StreamResult rt) {
        String xml = rt.getWriter().toString();
        int beginIndex = xml.indexOf(BODY_START_TAG) + BODY_START_TAG.length();
        int endIndex = xml.indexOf(BODY_END_TAG);
        return xml.substring(beginIndex, endIndex);
    }

    public Source marshal(String n, ValidationEventHandler errorHandler) {
        try {
            String xml = BODY_START_TAG + n.trim() + BODY_END_TAG;
            StringReader xmlReader = new StringReader(xml);
            return new StreamSource(xmlReader);
        } catch(Exception e) {
            throw new RuntimeException(e);
        }
    }

} 
```

**信息**

下面是如何`@XmlAnyElement`在类上指定注释`Message`。

```
import javax.xml.bind.annotation.XmlAnyElement;
import javax.xml.bind.annotation.XmlType;

@XmlType(propOrder = { "body" })
public class Message
{
    private String body;
    public String getBody() { return body; }
    @XmlAnyElement(BodyDomHandler.class)
    public void setBody(String body) { this.body = body; }
} 
```

**输出**

以下是运行您的输出`SerialziationTest`：

```
<?xml version="1.0" encoding="UTF-8"?>
<Report>
   <message>
      <body>Sample report message.</body>
   </message>
</Report>
<?xml version="1.0" encoding="UTF-8"?>
<Report>
   <message>
      <body>
         <rootTag>
            <body>All systems online.</body>
         </rootTag>
      </body>
   </message>
</Report> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2011/04/xmlanyelement-and-non-dom-properties.html](http://blog.bdoughan.com/2011/04/xmlanyelement-and-non-dom-properties.html)
*   [http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)

**注意 - JAXB RI 中的错误**

JAXB 参考实现中似乎存在一个错误，示例代码将导致堆栈跟踪，如下所示：

```
Exception in thread "main" javax.xml.bind.MarshalException
 - with linked exception:
[com.sun.istack.internal.SAXException2: unable to marshal type "java.lang.String" as an element because it is missing an @XmlRootElement annotation]
    at com.sun.xml.internal.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:317)
    at com.sun.xml.internal.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:243)
    at javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:75)
    at forum12428727.SerializationTest.main(SerializationTest.java:20)
Caused by: com.sun.istack.internal.SAXException2: unable to marshal type "java.lang.String" as an element because it is missing an @XmlRootElement annotation
    at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.reportError(XMLSerializer.java:216)
    at com.sun.xml.internal.bind.v2.runtime.LeafBeanInfoImpl.serializeRoot(LeafBeanInfoImpl.java:126)
    at com.sun.xml.internal.bind.v2.runtime.property.SingleReferenceNodeProperty.serializeBody(SingleReferenceNodeProperty.java:100)
    at com.sun.xml.internal.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:306)
    at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:664)
    at com.sun.xml.internal.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:141)
    at com.sun.xml.internal.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:306)
    at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.childAsSoleContent(XMLSerializer.java:561)
    at com.sun.xml.internal.bind.v2.runtime.ClassBeanInfoImpl.serializeRoot(ClassBeanInfoImpl.java:290)
    at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.childAsRoot(XMLSerializer.java:462)
    at com.sun.xml.internal.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:314)
    ... 3 more 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-07T08:47:00.270

如果它仅用于编组，并且忽略 < 和 >，我们可以使用以下内容：

```
marshaller.setProperty("com.sun.xml.bind.marshaller.CharacterEscapeHandler",
                new CharacterEscapeHandler() {
                    @Override
                    public void escape(char[] ac, int i, int j, boolean flag,
                            Writer writer) throws IOException {
                        writer.write(ac, i, j);
                    }
                }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-29T07:04:58.613

3 种不同的解决方案 1)、2) 3)，如下：

1）以下帖子是您的解决方案 Loresh 的描述：

[http://anna-safronova.livejournal.com/2524.html?thread=9180](http://anna-safronova.livejournal.com/2524.html?thread=9180)

这仍然缺少限制细节。

*   使用嵌入的 html，我们需要一个`<![CDATA`块

*   JAXB 的依赖

com.sun.xml.bind.marshaller.CharacterEscapeHandler

需要 import jaxb-impl 进行编译 / 并且可能需要执行，例如

```
<groupId>com.sun.xml.bind</groupId>
<artifactId>jaxb-impl</artifactId>  
 <version>2.2.4</version> 
```

*   限制：此解决方案是特定于容器的，可能由于类加载策略而无法运行。

2）另一种类似的做法是JDK的rt.jar依赖

com.sun.xml.internal.bind.CharacterEscapeHandler

[http://theopentutorials.com/tutorials/java/jaxb/jaxb-marshalling-and-unmarshalling-cdata-block/](http://theopentutorials.com/tutorials/java/jaxb/jaxb-marshalling-and-unmarshalling-cdata-block/)

对目标 JDK 的相同限制/依赖，并且需要对 Eclipse/Maven 进行一些调整（不好的选择/我的意见）

3) 最后，在 Reg Whitton 的另一篇文章中找到了最佳解决方案：

[https://stackoverflow.com/a/12637295/560410](https://stackoverflow.com/a/12637295/560410)

这是详细的收据：

[http://javacoalface.blogspot.co.uk/2012/09/outputting-cdata-sections-with-jaxb.html](http://javacoalface.blogspot.co.uk/2012/09/outputting-cdata-sections-with-jaxb.html)

非常适合我！

# http-headers - Cloudbees 内容类型无法正常工作

> ID：12428733
> 
> 赞同：1
> 
> 时间：2012-09-14T16:44:57.347
> 
> 标签：http-headers, playframework-1.x, cloudbees

我注意到，在某些情况下，当我使用不同的 SEO 工具时，我页面上的文本会显示为一大堆随机字符。我相信这一定是由于字符集设置不正确。我想确保使用了正确的字符集，并且某些网站没有正确读取它的事实让我认为 http 标头存在问题。

我检查了我在 Cloudbees 上托管的所有网站的标题，并且 Content-Type 标题值始终为“text/html; charset=utf-8;charset=utf-8”。我不确定是否具有双重价值会导致问题。

这会是 Ingnx 配置的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T12:29:31.047

是否有特定的应用程序可以显示这一点？我在各种应用程序 URL 上尝试了 curl -I 并没有看到这个。

编辑：我在其他 play 1.x 战争部署的应用程序中看到了这一点——即使循环中没有 nginx。

这是 play1 的一个错误：[https](https://bugs.launchpad.net/play/+bug/337472) ://bugs.launchpad.net/play/+bug/337472但它看起来应该已经在一段时间前修复了。

Play2 现在可以在 CloudBees 上使用，顺便说一句。

# nsis - nsis - 卸载不会删除开始菜单上的程序文件夹

> ID：12428738
> 
> 赞同：2
> 
> 时间：2012-09-14T16:45:17.050
> 
> 标签：nsis

卸载不会删除我项目的所有开始菜单文件夹：s 仅删除桌面中的快捷方式。

```
Delete "$SMPROGRAMS\Advanlab\Uninstall.lnk"
Delete "$SMPROGRAMS\Advanlab\Website.lnk"
Delete "$SMPROGRAMS\Advanlab\Advanlab.lnk"
Delete "$DESKTOP\Advanlab.lnk" 
```

pastebin 中的所有代码：http: [//pastebin.com/h5TURSPx](http://pastebin.com/h5TURSPx)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:55:26.630

您需要使用`requestexecutionlevel`禁用 NT6 兼容性的东西：[http ://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista](http://nsis.sourceforge.net/Shortcuts_removal_fails_on_Windows_Vista)

# ruby - 使用 facebook omniauth 时遇到问题

> ID：12428740
> 
> 赞同：0
> 
> 时间：2012-09-14T16:45:37.190
> 
> 标签：ruby, facebook, sinatra

我正在尝试使用 facebook 进行身份验证我有一个 sinatra 应用程序可以在 twitter 上正常工作。

应用程序.rb

```
use OmniAuth::Builder do
provider :twitter, 'xxx', 'yyy'
provider :facebook, 'xxx', 'yyy', :redirect_uri => 'http://localhost:9393/auth/facebook'
end 
```

我在我的视图中引用了 facebook 链接，例如，

```
 %a{:href=>"/auth/twitter"} Sign In To Twitter
     %a{:href=>"/auth/facebook"} Sign In To Facebook 
```

我被退回

[https://graph.facebook.com/oauth/authorize?response_type=code&client_id=268504329935589&redirect_uri=http%3A%2F%2F0.0.0.0%3A9393%2Fauth%2Ffacebook%2Fcallback&state=a88cbf5f83b2faeac173f23138440cddf6&scopee=](https://graph.facebook.com/oauth/authorize?response_type=code&client_id=268504329935589&redirect_uri=http%3A%2F%2F0.0.0.0%3A9393%2Fauth%2Ffacebook%2Fcallback&state=a88cbf5f83b2faeac173f23138440cddf48cd5faf0039fe6&scope=email)

看起来像

```
{
"error": {
  "message": "Invalid redirect_uri: Given URL is not allowed by the Application      configuration.",
  "type": "OAuthException",
  "code": 191
   }
} 
```

据我所知，我的设置看起来是正确的。存在许多关于此问题与 facebook 和应用程序注册 url 相关的帖子。

在 facebook 上，这个应用程序被注册为

```
Site URL
http://localhost:9393/
Site Domain
http://localhost:9393/ 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:58:15.693

我真的找到了答案

`App Domains: localhost/` 和 `Website with Facebook Login: http://localhost:9393/?`

本地主机上`/?`（网站 w fb 登录）是重要的细节

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:20:49.753

尝试应用程序域：`http://localhost/`

它在 Rails 中为我工作

```
Site URL:    http://localhost:3000/

App Domains: http://localhost/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T23:34:09.307

我通常在 facebook 中注册一个开发应用程序并将 redirect_uri 添加到我的主机文件中。通常是这样的：

```
127.0.0.1 dev.mycoolapp.com 
```

# javascript - Metro Javascript 应用程序的 WACK 测试失败

> ID：12428743
> 
> 赞同：0
> 
> 时间：2012-09-14T16:46:08.920
> 
> 标签：javascript, windows-8, microsoft-metro

该应用程序运行良好。但是当我运行 WACK 工具时，它会失败并给出以下错误。

> FAILED Bytecode generation Error Found：字节码生成测试检测到以下错误：此包已部署用于开发或创作模式。卸载软件包并重新正常安装。

现在我不知道有多少次我尝试在发布模式下卸载并重新安装应用程序，并进行任何我认为可能有效的更改。但是没有用。

所以我还是创建了一个包。创建包后，打包工具给了我运行app证书的机会。当我运行它时，我收到以下错误。

![错误截图](../Images/628c8fc1c4954b26beb5d442c788c7c3.png)

我需要先解决这两个问题，然后才能继续前进。有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T16:02:58.783

从[论坛](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/45cf901e-c522-4484-94db-4d701a7d5dd2)：

您可能正在针对直接从 Visual Studio 运行应用程序时部署的应用程序版本运行 Cert Kit（即：“为开发或创作模式而部署”）。

1) 从本地机器上卸载应用程序

2) 确保您将 Visual Studio 中的配置下拉菜单设置为发布

3）通过“Store”菜单创建部署包。右键单击项目，然后Store -> Create App Package。

4) 按照向导中的步骤进行操作。当您到达终点时，它会询问您是否要运行 Windows App Cert Kit。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T16:44:04.710

我有人看到过这个错误。在这种情况下，这意味着 WACK 发现了一个 .html、.js 或 .css 文件（或多个）未保存为“Unicode（带签名的 UTF-8）-代码页 65001”。要以这种方式保存，请在 Visual Studio 中打开文件，执行文件另存为，选择“使用编码保存...”（从保存按钮下拉），然后选择正确的编码。您可能需要检查每个文件以确保它们被正确编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:26:21.980

好的，想通了应用程序认证工具的处理。今天又跑了一次，这次我收到了一条具体的消息……它说

> 应用程序错误：未检测到应用程序 App 的应用程序挂起。这可能是因为您的应用程序未能正确挂起。请考虑重新运行测试，避免在测试运行时与应用程序交互。

好吧，我没有实现“暂停”逻辑。我现在把它放进去，它通过了。不知道是什么导致它显示特定的错误消息，但我今天早上收到了 Windows 更新。

WACK 仍然是一个问题。如果我发现更多，会更新。

# java - Java GUI - 嵌套面板

> ID：12428744
> 
> 赞同：4
> 
> 时间：2012-09-14T16:46:16.410
> 
> 标签：java, swing, jpanel

我正在尝试制作一个表单，该表单接受用户输入的名字和姓氏，并结合两者打印欢迎消息。我想将输入的内容组合到一个网格面板中，然后将“Go”按钮和在另一个面板中显示消息的文本字段组合在一起，并在一个框架内使用 BorderLayout 将它们嵌套在一起。

通用布局：

（在 3x2 网格中）

```
First Name: __________________________  
Last Name:  __________________________  
Age:        _______________ 
```

“GO BUTTON” “欢迎 Mark Summers”

教授希望将所有内容都放在一个 .java 文件中，这是我的问题。我通常会将这些东西分开然后扩展类并且没有问题。我要做的是将输入和输出面板保存在我的构造函数下，然后在我的主目录下，创建

```
JFrame frame = new JFrame(); 
```

进而

```
add(new CalebBreckonHW3(320,120)); 
```

从而在我的 700x700 JFrame“框架”内放置一个 320x120 面板。尽管我无法从静态上下文中引用非静态方法 add(java.awt.Component)，但我收到一条错误消息。我无法将 main 设置为非静态，否则会出错。

我现在正在通过任何人都可以指出我正确的方向来向其中添加代码吗？

```
import java.awt.*;
import javax.swing.*;

public class CalebBreckonHW3 extends JFrame {
    private JButton jbtGreet = new JButton("Greet Me");
    private JLabel firstOprLbl = new JLabel("First name");
    private JLabel lastOprLbl = new JLabel("Last name");
    private JLabel ageOprLbl = new JLabel("Age");
    private JTextField jtfFirst = new JTextField(10);
    private JTextField jtfLast = new JTextField(15);
    private JTextField jtfAge = new JTextField(3);
    // I'll get to the action events after I get this down
    private JTextField jtfGreet = new JTextField("Welcome firstname, lastname");

    public CalebBreckonHW3(int height, int width) {
        setLayout(new BorderLayout());
        setSize(height, width);
        JPanel inputPanel = new JPanel();
        inputPanel.setLayout(new GridLayout(3,2,0,5));
        jtfGreet.setEditable(false);
        inputPanel.add(firstOprLbl);
        inputPanel.add(jtfFirst);
        inputPanel.add(lastOprLbl);
        inputPanel.add(jtfLast);
        inputPanel.add(ageOprLbl);
        inputPanel.add(jtfAge);
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame();
        frame.setTitle("Greeting App");
        frame.setSize(700,700);
        frame.setLocationRelativeTo(null);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);

        add(new CalebBreckonHW3(320,120));
    }
} 
```

编辑：在我的 add 语句前面添加框架消除了静态错误，但它给了我一个错误“将窗口添加到容器”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T17:00:32.897

问题是您`extend`是`JFrame`班级中的班级，但是您在班级中发起了自己的班级，`JFrame`也`main()`不能打电话`add()`，因为您在 main 中，`static`而`add()`在被调用之前需要创建一个实例，请参阅我对您的问题的评论，但是，您应该不扩展 a`JFrame`而是做：

```
public class CalebBreckonHW3  {

    public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
        JFrame frame = new JFrame();
        frame.setTitle("Greeting App");
       // frame.setSize(700,700); //not recommened
        frame.setLocationRelativeTo(null);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

         JPanel panel=new JPanel(/*set layout if needed*/); 
         //panel.add(new JButton("Hello")); //add components to panel

        frame.getContentPane().add(panel);//why did you add your JFrame again???? so I guess you'd wanna add a JPanel or something with the components you need.

        frame.pack();
        frame.setVisible(true);
       }

    });
 }
...
} 
```

还总是创建一个 EDT（所有 UI 组件都放置在其上的事件`SwingUtilities.invokeLater();`调度`JFrame`线程`getContentPane().add();`）另一件事，你为什么将你的 Jframe 添加到你的 Jframe 中？如您所见，我展示了一个添加`JPanel`

编辑：

你让你`JFrame`的一个全局变量，然后你可以使用`frame.setLayout()`等。

但是，如果您希望当前代码正常工作，请执行以下操作：

```
public class CalebBreckonHW3  extends JFrame{

    public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
        new CalebBreckonHW3().createandShowUI();
       }

    });
 }
 private void createAndShowUI() {
        setTitle("Greeting App");
        //setSize(700,700); //not recommened
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

         JPanel panel=new JPanel(/*set layout if needed*/); 
         //panel.add(new JButton("Hello")); //add components to panel

        getContentPane().add(panel);//why did you add your JFrame again???? so I guess you'd wanna add a JPanel or something with the components you need.

        pack();//this will override setsize and use LayoutManager
        setVisible(true);     
 }
...
} 
```

`JFrame`但不建议扩展 a

# python - arcgis联合python错误

> ID：12428746
> 
> 赞同：3
> 
> 时间：2012-09-14T16:46:26.067
> 
> 标签：python, union, analysis, loops, arcgis

尝试遍历多个空间范围以创建 4 个不同层的 17 个并集。

我正在运行 ArcGIS Desktop 10.0、ArcInfo（高级）。

```
Gridnums = range(1,18)
for i in Gridnums:
    #vis6class = ws + "/" + "TVvis6class_G" + str(i)
    inList = arcpy.ListFeatureClasses("*ProcGrid_"+str(i), "")
    print "inList: " + str(inList)
    arcpy.Union_analysis([InList], ws + "/" + "TVvis6class_G" + str(i))
    print "Union completed for Grid " + str(i)
    arcpy.AddField_management(vis6class, "Object", "TEXT", 10)
    arcpy.AddField_management(vis6class, "Revert", "SHORT")
    rows = arcpy.UpdateCursor(vis6class)
    for row in rows:
        row.Revert = 0
        if row.Road == 1:
            row.Object = Road
            rows.updateRow(row)
        elif row.Water == 1:
            row.Object = Water
            rows.updateRow(row)
        elif row.Building == 1:
            row.Object = Building
            rows.updateRow(row)
        else:
            row.Object = row.Landcover
            rows.updateRow(row) 
```

错误代码（不是很有帮助）：

> inList: [u'Road_ProcGrid_1', u'FPs_S_ProcGrid_1', u'er_di_ProcGrid_1', u'TV_v_ProcGrid_1']
> 
> 回溯（最后一次调用）：文件“E:\Projects\TV\01_Python\LandCover\LC_2_Vector_Tile_6class_091312.py”，第 48 行，在 arcpy.Union_analysis([InList], ws + "/" + "TVvis6class_G" + str( i)) 文件“C:\Program Files\ArcGIS\Desktop10.0\arcpy\arcpy\analysis.py”，第 483 行，Union raise e RuntimeError: Object: Error in execution tool

我知道这是关于 ArcGIS 的编程论坛，但我也在 esri 论坛上发过帖子，有很多意见，但反馈很少。如果我为特定范围手动选择每个数据集，则该工具本身会运行，因此问题必须出在编码中。

感谢您的任何想法。

富有的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:13:29.330

您将 [InList] 作为输入，而不仅仅是没有引号的 'inList'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T09:45:00.937

根据[ArcGIS 在线帮助](http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//00080000000s000000)`Union_analysis`，当您传递字符串时，该函数需要一个类作为第二个参数。尝试传递一个对象。

# php - 具有数组名称的多个输入

> ID：12428747
> 
> 赞同：1
> 
> 时间：2012-09-14T16:46:31.147
> 
> 标签：php, html

我有一个包含 5 个输入字段的表单。每个字段都有一个数组名称，因为有可能一次创建多个记录。

**例子：**

```
<input type="text" name="name[]" />
<input type="text" name="surname[]" />
<input type="text" name="address[]" />
<input type="text" name="phone[]" />
<input type="text" name="age[]" /> 
```

我的问题是如何用 php 管理多个名称数组？我知道如何使用单个数组（多个复选框选中的情况）来做到这一点，但我被困在这里。

```
$all[] = $_POST["name"];
$all[] = $_POST["surname"];
$all[] = $_POST["address"];
$all[] = $_POST["phone"];
$all[] = $_POST["age"];
???

foreach {....??? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:49:22.843

每个输入都有一个索引，通过将所有值相乘，同一组中的所有字段都将具有相同的数组索引：

```
foreach($_POST['name'] as $num => $one){

    echo $_POST['name'][$num]; // or $one
    echo $_POST['surname'][$num];
    echo $_POST['address'][$num];
    echo $_POST['phone'][$num];
    echo $_POST['age'][$num];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:48:59.510

你可以这样做：

```
$all = $_POST["name"];
foreach($all as $val) {
    //Do whatever with $val
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:53:39.060

在这种情况下，最好使用这样的多维数组：

```
$all['name'] = $_POST['name'];
$all['surname'] = $_POST['surname'];
$all['address'] = $_POST['address'];
$all['phone'] = $_POST['phone'];
$all['age'] = $_POST['age'];

//1st processing option
foreach ($all as $key => $dataList) {
    //some code
    foreach ($dataList as $data) {
        //some code
    }
}

//2nd processing option
foreach ($all['name'] as $data) {
    //some code
}
//repeat for each of 'name, surname, address, phone, age' 
```

# jquery - window.scroll 函数冻结 Firefox

> ID：12428754
> 
> 赞同：5
> 
> 时间：2012-09-14T16:46:49.597
> 
> 标签：jquery, firefox, scroll, freeze

我正在处理一个带有固定菜单的页面，该菜单在用户从顶部滚动一定距离后拾取，并且当他们向下滚动页面时，菜单中的不同链接被赋予一个改变颜色的类。所有这一切似乎在 Chrome 和 Safari 中运行良好，但在 Firefox 中，页面冻结在顶部。我想知道它是否不断地循环一些代码......基本上冻结了窗口。

这是我的代码。

```
$.localScroll({
    onBefore: function() {
        $('body').data('scroll-executing', true);

    },
    onAfter: function() {
        $('body').data('scroll-executing', false);
        $(window).trigger("scroll");
    }
});

$(window).scroll(function () {
    if ($(this).scrollTop() > 259) {
        $('.nav').addClass("f-nav");
    } else {
        $('.nav').removeClass("f-nav");
    }
});

$(window).scroll(function() { 
    if ($('body').data('scroll-executing')) {
        return;
    }
    // find the a with class 'active' and remove it
    $("a").removeClass('active');
    // get the amount the window has scrolled
    var scroll = $(window).scrollTop();
    // add the 'active' class to the correct #nav based on the scroll amount

    if (scroll > 2150) {
        $("#nav_3").removeClass('active');
        $("#nav_5").attr('class', 'active');
        setHash("contact");

    } else if (scroll > 1300) {
        $("#nav_2").removeClass('active');
        $("#nav_3").attr('class', 'active');
        setHash("portfolio");

    } else if (scroll > 400) {
        $("#nav_2").attr('class', 'active');
        setHash("about");

    } else if (scroll <= 380) { //when I remove this section, the problem goes away.
        $("#nav_1").attr('class', 'active');
        setHash("home");
    }

}); 
```

我忘了添加 setHash 定义。这里是。

```
setHash = function(hash) {
    var scrollmem = $('body').scrollTop();
    window.location.hash = hash;
    $('html,body').scrollTop(scrollmem);
} 
```

我还注意到 CPU 上升到 100%，我似乎不知道为什么。

问题出在以 else if (scroll <= 380) 开头的代码的第三部分。我通过消除过程弄清楚了这一点。任何人都可以看到它循环或做一些永远不会结束的事情......或者解释为什么 Firefox 在页面顶部冻结？

我对所有这些都是新手......我在过去几天刚刚拿起 jquery，我基本上一直在谷歌搜索并调整代码以使其适合我的需要。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:07:31.237

在滚动事件上执行太多代码是多余的，在每次滚动时，浏览器都会触发滚动事件数百次，您可以考虑使用具有类似`throttle`or方法的库`debounce`。

[http://documentcloud.github.com/underscore/#throttle](http://documentcloud.github.com/underscore/#throttle)

> **将处理程序附加到窗口滚动事件是一个非常非常糟糕的主意。**根据浏览器的不同，滚动事件可能会触发很多，并且将代码放入滚动回调中会减慢滚动页面的任何尝试（不是一个好主意）。因此，滚动处理程序中的任何性能下降只会使整体滚动性能更加复杂。相反，最好使用某种形式的计时器每 X 毫秒检查一次，或者附加一个滚动事件，并且只在延迟后（或者甚至在给定数量的执行之后 - 然后延迟）运行您的代码。 [http://ejohn.org/blog/learning-from-twitter/](http://ejohn.org/blog/learning-from-twitter/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:24:34.330

基本上你在滚动事件中执行了太多。正如@undefined 所说，浏览器调用它的次数比你想象的要多得多。一些技巧：

当在一个将被多次调用的函数中时，已经创建了你的 jQuery 对象。这样，每次调用该函数时，它都不会重新创建相同的 jQuery 对象。

```
var nav2 = $("#nav_2");
$(window).scroll(function() {
   ...
   nav2.removeClass('active');
   ...
}); 
```

同样，当一遍又一遍地调用时，添加和删除类会消耗大量的处理周期——尤其是当您访问整个类的元素时，例如在`$('.nav').addClass("f-nav");`.

相反，仅当类不存在时才尝试添加/删除它们。就像是：

```
var alreadyAdded = false;
var alreadyRemoved = false;
$(window).scroll(function () {
    if ($(this).scrollTop() > 259) {
      if(!alreadyAdded){
        $('.nav').addClass("f-nav");
        alreadyAdded = true;
        alreadyRemoved = false;
      }
    } else if(!alreadyRemoved) {
        $('.nav').removeClass("f-nav");
        alreadyAdded = false;
        alreadyRemoved = true;
    }
}); 
```

尽管如此，它仍然可能会缓慢滚动，所有这些代码都附加到滚动事件。也许还有另一种方法可以获得相同的效果。如果 Firefox 冻结，我只能想象这在 IE 中一定有多慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T21:19:49.460

除了其他问题，`$('body').scrollTop()`在 Firefox 中总是会返回 0。`setHash()`运行时`$('html,body').scrollTop(scrollmem);}`，它会跳转到屏幕顶部，看起来就像用户第一次加载页面时卡在屏幕顶部一样。`$(window).scrollTop()`，结合节流，将解决这个问题。

# mysql - CREATE TABLE 中的 1064 错误 ... TYPE=MYISAM

> ID：12428755
> 
> 赞同：32
> 
> 时间：2012-09-14T16:46:52.977
> 
> 标签：mysql, syntax

这是我的错误（如果您需要更多信息，请询问）- 错误 SQL 查询：

```
CREATE TABLE dave_bannedwords(

id INT( 11 ) NOT NULL AUTO_INCREMENT ,
word VARCHAR( 60 ) NOT NULL DEFAULT  '',
PRIMARY KEY ( id ) ,
KEY id( id )
) TYPE = MYISAM ; 
```

MySQL 说：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 6 行的 'TYPE=MyISAM' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-14T16:51:07.383

如[`CREATE TABLE`语法](http://dev.mysql.com/doc/en/create-table.html)中所述：

> **注意**
> 旧`TYPE`选项与`ENGINE`. `TYPE`在 MySQL 4.0 中已弃用并在 MySQL 5.5 中删除。*升级到 MySQL 5.5 或更高版本时，必须将依赖的现有应用程序转换`TYPE`为使用`ENGINE`。*

因此，您想要：

```
CREATE TABLE dave_bannedwords(
  id   INT(11)     NOT NULL AUTO_INCREMENT,
  word VARCHAR(60) NOT NULL DEFAULT '',
  PRIMARY KEY (id),
  KEY id(id) -- this is superfluous in the presence of your PK, ergo unnecessary
) ENGINE = MyISAM ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-10T16:19:23.063

**`CREATE TABLE .. TYPE=""`关于SQL 转储文件中语法的补充说明**

TLDR：如果您仍然`CREATE TABLE ... TYPE="..."`在由第三方工具生成的 SQL 转储文件中获得语句，那肯定表明您的服务器配置为使用默认`sqlmode`的`MYSQL40`or `MYSQL323`。

**很长的故事**

正如其他人所说，该`TYPE`论点`CREATE TABLE`在 MySQL 中已被弃用了很长时间。`mysqldump`正确使用该`ENGINE`参数，除非您明确要求它生成向后兼容的转储（例如在最高 5.7`--compatible=mysql40`的版本中使用）。`mysqldump`

但是，许多外部 SQL 转储工具（例如，那些集成在 MySQL 客户端中的工具，如 phpmyadmin、Navicat 和 DBVisualizer，以及外部自动备份服务（如 iControlWP）使用的工具）并没有特别意识到这一变化，而是依赖于为每个表提供表创建语句的`SHOW CREATE TABLE ...`命令（并且明确表示：这实际上是一件好事）。但是，如果变量设置为or `SHOW CREATE TABLE`，实际上会产生过时的语法，包括参数。`TYPE``sqlmode``MYSQL40``MYSQL323`

因此，如果您仍然`CREATE TABLE ... TYPE="..."`在第三方工具生成的 SQL 转储文件中获得语句，则很可能表明您的服务器配置为使用默认`sqlmode`的`MYSQL40`or `MYSQL323`。

这些`sqlmode`s 基本上配置 MySQL 以保留一些向后兼容的行为，并且默认使用它们在几年前被广泛推荐。然而，如果没有这些模式，您仍然有任何无法正常工作的代码是极不可能的。无论如何，`MYSQL40`和`MYSQL323`其他几个类似`sqlmode`的 s 本身已被弃用，并且在 MySQL 8.0 及更高版本中不受支持。

如果您的服务器仍然配置有这些`sqlmode`s，并且您担心如果更改这些旧程序可能会失败，那么一种可能性是通过在连接后立即`sqlmode`执行来为该程序设置本地。`SET SESSION sql_mode = 'MYSQL40';`请注意，这仅应被视为临时补丁，在 MySQL 8.0 及更高版本中不起作用。

不涉及重写 SQL 查询的更面向未来的解决方案是确定需要启用哪些兼容性功能，并且仅启用那些，基于每个程序（如前所述）。默认值`sqlmode`（即，在服务器的配置中）最好不要设置（它将使用当前版本的官方 MySQL 默认值）。`sqlmode`（从 MySQL 5.7 开始）的完整列表在此处描述： [https](https://dev.mysql.com/doc/refman/5.7/en/sql-mode.html) ://dev.mysql.com/doc/refman/5.7/en/sql-mode.html 。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-08-14T05:38:56.603

```
CREATE TABLE `admnih` (
  `id` int(255) NOT NULL auto_increment,
  `asim` varchar(255) NOT NULL default '',
  `brid` varchar(255) NOT NULL default '',
  `rwtbah` int(1) NOT NULL default '0',
  `esmmwkeh` varchar(255) NOT NULL default '',
  `mrwr` varchar(255) NOT NULL default '',
  `tid` int(255) NOT NULL default '0',
  `alksmfialdlil` int(255) NOT NULL default '0',
  `tariktsjil` varchar(255) NOT NULL default '',
  `aimwke` varchar(255) NOT NULL default '',
  `twkie` text NOT NULL,
  `rwtbahkasah` int(255) NOT NULL default '0',
  PRIMARY KEY  (`id`)
) TYPE=MyISAM AUTO_INCREMENT=2 ; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2017-01-30T06:59:43.890

```
SELECT Email, COUNT(*)
FROM user_log    
WHILE Email IS NOT NULL    
GROUP BY Email    
HAVING COUNT(*) > 1    
ORDER BY UpdateDate DESC 
```

> MySQL 说：文档 #1064 - 你的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 36 行的 'TYPE=MyISAM' 附近使用正确的语法

* * *

以下哪个更正：

```
CREATE TABLE users_online (
  ip varchar(15) NOT NULL default '',
  time int(11) default NULL,
  PRIMARY KEY  (ip),
  UNIQUE KEY id (ip),
  KEY id_2 (ip)
  TYPE=MyISAM;
)
#                           
# Data untuk tabel `users_online`
#

INSERT INTO users_online VALUES ('127.0.0.1', 1158666872); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-06-12T22:08:10.997

试试下面的查询

```
CREATE TABLE card_types (
  card_type_id int(11) NOT NULL auto_increment,
  name varchar(50) NOT NULL default '',
  PRIMARY KEY  (card_type_id),
) ENGINE = MyISAM ; 
```

# entity-framework - TFS 中不包含实体框架 5 POCO？

> ID：12428757
> 
> 赞同：14
> 
> 时间：2012-09-14T16:47:15.867
> 
> 标签：entity-framework

我正在处理我们最近升级到 Entity Framework 5 的项目。升级后，我创建了一个新的 .edmx 模型并将所有实体移至新模型。

据我所知，Entity Framework 5 运行 POCO 对象。我遇到的问题是 POCO 对象似乎没有包含在源代码管理中。如果新开发人员打开解决方案，它不包含任何生成的 POCO 对象。为了解决这个问题，我们可以右键单击“MyModel.Context.tt”和“MyModel.tt”，然后单击“运行自定义工具”来生成 POCO 对象。那么有没有办法在 tfs 中包含 POCO 对象，这样我们就不必在新开发人员打开解决方案时生成它们？

更新

因此，我尝试了一些人的建议并使用“包含在项目中”，但是如果我在 Visual Studio 中查看包含模型的文件夹，并且显示所有文件选项，则没有显示任何类。但是，如果我用 Windows 资源管理器查看该文件夹，它会显示所有文件......给了什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-02T13:41:33.297

除了上面Saml的回答......

对于 Visual Studio 2012，为了添加您的 POCO，请执行以下操作；

1.  使用 View>Team Explorer 打开 Team Explorer 窗口
2.  您将看到一个快捷方式列表……我的工作、待更改等等；
3.  在“Pending Changes”下是一个指向“Source Control Explorer”的链接
4.  单击此链接，打开源代码管理资源管理器窗口
5.  通过您的解决方案导航到包含您的 edmx 文件的项目
6.  “源位置”上方将是一个工具栏
7.  左起第四个图标是“将项目添加到文件夹”
8.  单击此图标将弹出“添加到源代码管理”对话框，显示此项目中**当前不在**源代码管理下的所有文件。
9.  选择您现在希望在源代码管理下包含的所有文件
10.  按下一步，然后完成

现在再次签入您的解决方案，现在应该包含您的 POCO。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T18:16:35.153

首先打开团队资源管理器窗口：

*   看法
*   团队资源管理器

然后展开您的项目并双击“源代码管理”。

在源代码管理资源管理器窗口中，浏览到 POCO 文件应位于的文件夹，右键单击资源管理器窗口或目录，然后选择“将项目添加到文件夹”（或类似的东西......我已经几个月了我用过 TFS）

最后选择自动生成的文件并包含它们。别忘了签到！

需要注意的是，当将自动生成的文件包含到 TFS 中时，如果您尝试重新生成这些文件，将来可能会出现问题。您最终可能会遇到只读访问问题。这可以通过手动签出文件以解锁它们来解决。签出后，重新生成您心中的内容！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-30T17:06:49.367

这有点晚了，但我遇到了同样的问题。

我无法将丢失的文件添加到 TFS。我没有尝试添加每个文件，而是能够在解决方案资源管理器中右键单击 EDMX 文件，然后单击“运行自定义工具”，然后再次右键单击 EDMX 文件并单击“添加到源代码管理”。这添加了所有丢失的文件，我能够签入它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-02T22:25:45.357

事实证明，这是 Visual Studio 2012 的一个错误，模型位于子文件夹中。更新到 SP1 和离开时的问题。

# java - 声明两个字段 volatile 就足够了吗？

> ID：12428758
> 
> 赞同：4
> 
> 时间：2012-09-14T16:47:18.077
> 
> 标签：java, java-me, concurrency, volatile, java-memory-model

我现在正在编写一个**Java ME**应用程序。据我所知，它使用**旧的**Java 内存模型，因为它的功能仅限于 Java 1.3。该模型提供的关于 volatile 关键字的唯一保证是所有读取和写入都直接通过主内存而不是缓存。

考虑以下代码：

```
class BillHelper {
    volatile HttpConnection con;
    volatile InputStream in;

    // Called from thread A
    BillResponse makeBill(BillRequest request) throws BillException {
        // open http connection
        // extract request data from method parameter
        // prepare all needed headers
        // flush headers
        // open input stream, parse response
    }

    // Called from thread B
    void cancelBillRequest() {
        if (in != null) {            
            try {
               in.close();
            } catch (IOException ignored) {}
        }

        if (con != null) {  
            try {
               con.close();
            } catch (IOException ignored) {}
        }
    }
} 
```

从不同的线程调用方法。方法`makeBill()`写入`volatile`变量，方法`cancelBillRequest()`从该字段读取。

声明两个字段`volatile` **就足够**了吗？您对 volatile**读写重新排序**有什么看法？我的代码*安全*吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:08:38.720

不要依赖 volatile 做任何事情。旧的内存模型被打破了，这就是为什么有一个新的。

使用对象同步对字段的访问。这是保证写/读安全的唯一方法。（即 Object obj = new Object(); 并在每个方法中： synchronized (obj) {} ）

# haxe - 创建 Haxe 外部，返回类型

> ID：12428761
> 
> 赞同：3
> 
> 时间：2012-09-14T16:47:22.953
> 
> 标签：haxe, kineticjs

我正在尝试为 Haxe 制作 KineticJS 的外部。而且我正在制作“转换”课程，但我缺少一些部分，所以我认为这里有人可以提供帮助。

```
extern class Transform {
    public function new();
    public function translate(x:Float, y:Float):Void;
    public function scale(sx:Float, sy:Float):Void;
    public function rotate(rad:Float):Void;

    /**
     * Returns the translation
     * @returns {Object} 2D point(x, y)
     */
    getTranslation: function() {
        return {
            x: this.m[4],
            y: this.m[5]
        };
    },

    public function multiply(matrix:Transform):Void;
    public function invert():Void;

    /**
     * return matrix
     */
    getMatrix: function() {
        return this.m;
    }
} 
```

所以，如你所见，我不见了`getTranslation`，并且`getMatrix`. 这是因为我不确定他们的返回类型应该是什么。这里有什么帮助吗？

对于那些想知道的人，该`m`变量定义如下：

```
Kinetic.Transform = function() {
    this.m = [1, 0, 0, 1, 0, 0];
} 
```

非常感谢！

-P

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T17:41:38.140

鉴于`m`正在存储一个矩阵，它应该是一个`Array<Float>`.

getTranslation 的返回类型是一个[结构体](http://haxe.org/manual/struct)。

所以最后的功能应该是：

```
public function getMatrix():Array<Float>;

public function getTranslation():{ x:Float, y:Float }; 
```

# c# - ObjectDisposedException 调用 Form 的 Invoke 时，它 尚未被处置

> ID：12428764
> 
> 赞同：4
> 
> 时间：2012-09-14T16:47:44.247
> 
> 标签：c#, winforms, invoke

我们在尚未处理的表单上收到`ObjectDisposedException`from 调用。`Invoke`这是一些演示问题的示例代码：

```
public partial class Form2 : Form
{
    void Form2_Load(object sender, EventArgs e)
    {
        // Start a task that does an Invoke on this control
        Task.Factory.StartNew(TaskWork); 

        // Sleep here long enough to allow the task that does the Invoke 
        // to execute to the point where it has:
        // a. Posted the message and 
        // b. is waiting 
        Thread.Sleep(500);

        // Cause ShowDialog to return by setting the DialogResult
        DialogResult = DialogResult.OK;
    }

    void TaskWork()
    {
        // This call doesn't return, but instead throws an ObjectDisposedException
        this.Invoke((MethodInvoker)(() => MessageBox.Show("Invoke succeeded")));
    }
} 
```

这是我从不关闭的 Form1（主窗体）的调用代码：

```
public partial class Form1 : Form
{
    Form2 m_form2 = new Form2();

    void Form1_Load(object sender, EventArgs e)
    {
        // Call ShowDialog, but don't dispose it.
        m_form2.ShowDialog();

        // Cause the finalizers to run.  This causes an AggregateException to be thrown
        // due to the unhandled ObjectDisposedException from the Task.
        GC.Collect(); 
    }
} 
```

我们深入研究了 Microsoft 源代码，发现异常是在调用 DestroyHandle 期间创建的（如下）。在完成时，ShowDialog 正在调用 DestroyHandle。

来自 source.NET\4\DEVDIV_TFS\Dev10\Releases\RTMRel\ndp\fx\src\WinForms\Managed\System\WinForms\Control.cs\1305376\Control.cs：

```
protected virtual void DestroyHandle() {
    // ...
        // If we're not recreating the handle, then any items in the thread callback list will
        // be orphaned.  An orphaned item is bad, because it will cause the thread to never 
        // wake up.  So, we put exceptions into all these items and wake up all threads. 
        // If we are recreating the handle, then we're fine because recreation will re-post
        // the thread callback message to the new handle for us. 
        //
        if (!RecreatingHandle) {
            if (threadCallbackList != null) {
                lock (threadCallbackList) { 
                    Exception ex = new System.ObjectDisposedException(GetType().Name);

                    while (threadCallbackList.Count > 0) { 
                        ThreadMethodEntry entry = (ThreadMethodEntry)threadCallbackList.Dequeue();
                        entry.exception = ex; 
                        entry.Complete();
                    }
                }
            } 
        }
    // ...
} 
```

# 问题：

1.  为什么 ShowDialog 会破坏句柄（当我可能重新使用此表单时）？

2.  为什么我得到一个 ObjectDisposedException - 它非常具有误导性（因为它没有被处理）。就好像代码期望只有在对象被释放时才会销毁句柄（这是我所期望的）。

3.  这应该有效吗？也就是说，是否应该允许我在 ShowDialog 之后调用控件？

# 笔记：

1.  再做一次`.ShowDialog()`会导致创建一个新句柄。

2.  如果在`.ShowDialog()`我尝试执行操作之后`Invoke`，我会收到一个 InvalidOperationException，指出“在创建窗口句柄之前，不能在控件上调用 Invoke 或 BeginInvoke。”

3.  如果在完成后`.ShowDialog()`我访问该`Handle`属性，然后执行一个`Invoke`，它将成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T18:15:27.543

> 为什么 ShowDialog 会破坏句柄（当我可能重新使用此表单时）？

销毁本机窗口并使其消失。此后，Handle 属性将为 IntPtr.Zero。

> 为什么我得到一个 ObjectDisposedException - 它非常具有误导性（因为它没有被处理）。

是的，在对话的情况下会产生误导。编写代码是为了处理使用 Show() 显示的表单的更常见情况。一旦本机窗口被销毁，它就会沿着挂起的调用队列工作并将它们标记为完成。并将它们的“最后一个异常引发”状态设置为 ObjectDisposedException（参考源代码段中的 entry.exception）。它明确地这样做是为了防止任何调用的代码在本机窗口消失的情况下运行，这样的代码通常会因 ODE 而死。它只是跳枪并提早提出异常。您可能会争辩说 InvalidOperationException 更合适，但他们选择了 ODE。

> 这应该有效吗？也就是说，是否应该允许我在 ShowDialog 之后调用控件？

不，那行不通。需要 Handle 属性的值来确定调用哪个线程。但是 ShowDialog() 返回后是 IntPtr.Zero 。

您在这里遇到了一个极端情况，但一般策略必须始终是确保在允许表单关闭之前线程已完成或终止。有关[此答案](https://stackoverflow.com/questions/1731384/how-to-stop-backgroundworker-on-forms-closing-event/1732361#1732361)的更多信息。

# heroku - 为什么任务调度程序不工作但手动运行 rake

> ID：12428765
> 
> 赞同：1
> 
> 时间：2012-09-14T16:47:56.610
> 
> 标签：heroku, rake, scheduler

我有一个在 heroku 上运行的应用程序，我需要每小时运行一次名为 get_instagram_photos 的 rake 任务。我正在抓取 instagram，然后将信息添加到数据库中。如果我在终端中手动运行以下任务，则任务效果很好。

```
$> heroku run rake get_instagram_photos 
```

我正在使用 heroku 实现的新调度程序插件。我添加了 get_instagram_photos 作为我想每小时运行一次的任务之一。仪表板似乎告诉我它每小时运行一次，但是我没有看到任何数据被添加到数据库中。我 100% 确定任务有效，只是当我允许调度程序运行它时，似乎有些不对劲。

我应该如何开始解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T17:26:11.553

您实际上需要将`rake get_instagram_photos`（看起来您忘记了`rake`）添加到您的调度程序插件中。

您可以在调度程序文档中找到更多信息：[https ://devcenter.heroku.com/articles/scheduler](https://devcenter.heroku.com/articles/scheduler)

# version-control - 如何在 CVS 中同时对 Mercurial 存储库的子目录进行版本控制？

> ID：12428770
> 
> 赞同：0
> 
> 时间：2012-09-14T16:48:29.340
> 
> 标签：version-control, mercurial, automation, cvs, version-control-migration

如何在 CVS 存储库中同时将 Mercurial 存储库的子目录作为子目录进行版本控制？

我需要这个的原因是，使用 Mercurial 控制的私有项目版本有一个代码和资源子目录，这些代码和资源恰好对使用 CVS 版本控制的全局多人项目有用。我想在 Mercurial 存储库中继续开发，但是当它提交时，我希望它也传播到 CVS 存储库。有时其他人会通过 CVS 提交到此目录，我也希望能够将这些修订版添加到我的 Mercurial 存储库中。这个问题有什么好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T04:41:10.407

将两个存储库放在一起，相关的 SO 问题：[Mercurial 和 SVN 在同一个工作目录中并排？](https://stackoverflow.com/questions/6549777/mercurial-and-svn-side-by-side-in-same-working-directory). 因此，在 mercurial 文件夹中拥有 svn 文件夹应该不是问题。记得将`.svn/`repo 添加到`.hgignore`.

在提交另一个时传播一个可能更复杂。最简单的方法是分别提交/拉取/同步到两者。同步 svn 文件夹后，下次提交 hg 时，prev 更改将传播到 hg。反之亦然。由于一个 repo 在另一个 repo 中，因此看到每个 repo 的变化反映在另一个 repo 中应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:26:35.460

我们为我工作的一家公司的包含目录执行此操作。我们最终做的是迫使每个人都致力于 CVS 回购。然后我编写了一个 cron 作业，它将 CVS 存储库中所做的任何更改提交到相关的 Mercurial 存储库中。Mercurial 存储库包含一整棵树（不仅仅是包含目录）这一事实使我们的案例变得复杂。如果我要再做一次，我会将包含目录设为一个单独的存储库。

# .net - WPF 数据网格和动态列宽

> ID：12428774
> 
> 赞同：12
> 
> 时间：2012-09-14T16:48:44.510
> 
> 标签：.net, wpf, datagrid, resize

我们有一个自定义的 DataGrid 控件，它动态生成由 XML 结构确定的列。

在创建每一列时，我们给它一个星号单位类型，因为我们要确保 DataGrid 中永远不会有任何水平滚动。

```
 DataGridTextColumn column = new DataGridTextColumn();
            column.Width = new DataGridLength(entity.DisplaySize, DataGridLengthUnitType.Star); 
```

但是，我们注意到，当 DataGrid 被渲染时，它会以赋予列的最小尺寸进行渲染，然后一旦 DataGrid 完全渲染，它会调整列的大小以适当地适应 DataGrid。这会导致闪烁效果。

有没有人有任何可能的解决方案？也许如何在后台渲染 DataGrid，然后在列完成后显示？还是有其他想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T21:26:53.943

不幸的是，这是正常行为。它与控件的呈现方式有关。在 WPF 中，您有一层又一层的控件，而 DataGrid 在完成呈现之前无法知道哪些类型的控件。

因此，第一个布局传递创建了控件，但随后必须通过第二个传递来测量这些控件的大小。一旦它知道控件有多大，它就可以开始调整列的大小。

DataGrid 是 WPF 的高度可配置和动态布局系统不起作用的场景的一个很好的例子。要获得您习惯的那种性能，您需要使用非 WPF 网格，它能够更好地预测其自身的层次结构，从而执行这些类型的测量，而无需预渲染所有内容。WPF 中存在此类控件，但您必须找到它们。

这是来自 xceed 的一个：http://xceed.com/Grid_WPF_Intro.html?gclid= [CNKE8rOBtrICFQfonAodHQ8AEA](http://xceed.com/Grid_WPF_Intro.html?gclid=CNKE8rOBtrICFQfonAodHQ8AEA)

这是 Telerik 的一个：[http ://www.telerik.com/products/wpf/gridview.aspx](http://www.telerik.com/products/wpf/gridview.aspx)

（由于需要平衡灵活性和性能，以及现代数据网格中预期的大量功能，这个控件长期以来一直被认为是控件开发的顶峰。好的数据网格非常难以构建。在 Excel 中，Microsoft 构建了一个整个应用程序基本上围绕着一个美化的数据网格。所有这些都是说，你可能不会免费找到你要找的东西。）

看到这个问题：[WPF DataGrid Vs Windows Forms DataGridView](https://stackoverflow.com/questions/4613394/wpf-datagrid-vs-windows-forms-datagridview)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T20:59:58.633

我不认为你会在后台渲染。它的布局方式有两个通道。

[布局系统](http://msdn.microsoft.com/en-us/library/ms745058%28v=vs.100%29.aspx)

在按钮是 ListItem 的按钮单击时，我会遇到这种情况。该按钮会导致上面的某些内容发生更改，并且会更改按钮的位置，以便在同一位置有另一个按钮。为错误的按钮处理单击事件。当我尝试将代码分解为可以在 SO 上发布的简单内容时，它可以工作。

在 DataGrid 上，我处理它的方式是 ListView GridView 并计算每列的宽度。

# c# - 为什么 C# 编译的正则表达式比等效的字符串方法更快？

> ID：12428776
> 
> 赞同：18
> 
> 时间：2012-09-14T16:48:50.750
> 
> 标签：c#, .net, regex, string, performance

每次我必须对字符串进行简单的包含或替换操作时，我正在搜索的术语是一个固定值，我发现如果我获取样本输入并对其进行一些分析，使用编译的正则表达式是几乎* 总是比使用 String 类中的等效方法快。

我试过比较各种方法（`hs`是要搜索的“干草堆”，`ndl`是要搜索的“针”，`repl`是替换值。`regex`总是使用`RegexOptions.Compiled`选项创建）：

*   `hs.Replace( ndl, repl )`对比`regex.Replace( hs, repl )`
*   `hs.Contains( ndl )`对比`regex.IsMatch( hs )`

我发现很多讨论都集中在*这*两种技术中哪一种更快（[1](https://stackoverflow.com/questions/3186285/c-sharp-which-is-faster-string-contains-or-regex-ismatch)、[2](https://stackoverflow.com/questions/3601465/string-split-vs-regex-split)、[3](https://stackoverflow.com/questions/9380062/is-using-a-regular-expression-faster-than-indexof)和其他许多技术），但这些讨论似乎总是集中在：

1.  对简单操作使用字符串版本，对复杂操作使用正则表达式（从原始性能的角度来看，这甚至不一定是一个好主意），或者
2.  运行测试并比较两者（对于等效测试，正则表达式版本似乎总是表现更好）。

我不明白这怎么可能是这种情况：正则表达式引擎如何比等效字符串版本更快地比较任何两个字符串的子字符串匹配？这似乎适用于非常小或非常大的搜索空间，或小或大的搜索词，或者搜索词是否出现在搜索空间的早期或晚期。

那么，**为什么**正则表达式更快呢？

* * *

* 事实上，我设法证明字符串版本比编译的正则表达式更快的**唯一情况是在搜索空字符串时！**任何其他情况，从单个字符串到非常长的字符串，编译的正则表达式比等效的字符串方法处理得更快。

* * *

**更新：**添加了一个子句来阐明我正在查看在编译时已知搜索词的情况。对于动态或一次性操作，编译正则表达式的开销往往会使结果偏向于字符串方法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-14T17:06:03.833

> 我不明白这怎么可能是这种情况：正则表达式引擎如何比等效字符串版本更快地比较任何两个字符串的子字符串匹配？

我可以想到两个原因：

1.  正则表达式使用一些智能算法，如[Boyer Moore](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm) (O(M/N))，而简单的字符串操作只是将针与大海捞针中的每个位置进行比较 (O(N*M))。
2.  他们并没有真正做同样的事情。例如，一个可能进行文化不变匹配，而另一个进行文化相关匹配，这可能会产生性能差异。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-14T17:06:04.083

正如基类库团队[所写](http://blogs.msdn.com/b/bclteam/archive/2004/11/12/256783.aspx)：

> 在 [RegexOptions.Compiled 的情况下]，我们首先进行解析为操作码的工作。然后我们还做更多的工作来使用 Reflection.Emit 将这些操作码转换为实际的 IL。可以想象，这种模式以增加的启动时间换取更快的运行时间：实际上，编译需要大约一个数量级的时间才能启动，但运行时性能提高了 30%。

但是，您忽略了一件重要的事情：**Pattern is fixed**。请注意，情况并非总是如此。您无法在运行时更改它！在某些情况下，灵活性会下降超过 30% 的性能增益。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T20:10:45.567

根据我自己的经验，每当我使用简单的字符串操作对正则表达式解决方案与自定义解析器进行基准测试时，正则表达式解决方案都会慢一些。那是因为他们经常遭受回溯的困扰。

但出于好奇，我写了一个小测试，看看你所说的在最简单的例子中是否属实。

这是我的测试...

```
 private static Regex RegexSearch = new Regex("Audi A4", RegexOptions.Compiled);

    static void Main(string[] args)
    {            
        // warm up the JIT compiler
        FoundWithRegexIsMatch();
        FoundWithStringContains();
        FoundWithStringIndexOf();
        // done warming up

        int iterations = 100;
        var sw = new Stopwatch();

        sw.Restart();
        for (int i = 0; i < iterations; i++)
        {
            FoundWithRegexIsMatch();
        }
        sw.Stop();
        Console.WriteLine("Regex.IsMatch: " + sw.ElapsedMilliseconds + " ms");

        sw.Restart();
        for (int i = 0; i < iterations; i++)
        {
            FoundWithStringIndexOf();
        }
        sw.Stop();
        Console.WriteLine("String.IndexOf: " + sw.ElapsedMilliseconds + " ms");

        sw.Restart();
        for (int i = 0; i < iterations; i++)
        {
            FoundWithStringContains();
        }
        sw.Stop();
        Console.WriteLine("String.Contains: " + sw.ElapsedMilliseconds + " ms");
    }

    private static bool FoundWithStringContains()
    {
        return Resource2.csv.Contains("Audi A4");
    }

    private static bool FoundWithStringIndexOf()
    {
        return Resource2.csv.IndexOf("Audi A4") >= 0;
    }

    private static bool FoundWithRegexIsMatch()
    {
        return RegexSearch.IsMatch(Resource2.csv);
    } 
```

我正在针对我拥有的大约 1.2 MB 的 CSV 文件进行测试。结果如下：

*   正则表达式.IsMatch：172 毫秒
*   String.IndexOf：172 毫秒
*   字符串。包含：185 毫秒

确实你是对的。当你没有在正则表达式中做任何花哨的事情时，正则表达式比`String.Contains`操作快一点。但是，我发现[String.Contains 中存在一点点开销，](https://stackoverflow.com/questions/498686/net-is-string-contains-faster-than-string-indexof)并且调用`String.IndexOf`速度更快，并且实际上匹配`Regex.IsMatch`到毫秒的时间。

这些相同的时间是可疑的。我想知道在编译过程中是否确定这实际上不需要通过正则表达式引擎（因为我上面使用的模式中没有特定于正则表达式的指令）。相反，它可以被简化，以便`Regex.IsMatch`从 kernel32.dll 对 FindNLSString 进行相同的调用`IndexOf`。这只是一个猜测。

# ruby-on-rails - Bootstrap 2.1.1 + Heroku + IE = 部分编译的资产

> ID：12428780
> 
> 赞同：1
> 
> 时间：2012-09-14T16:49:02.290
> 
> 标签：ruby-on-rails, internet-explorer, twitter-bootstrap, ruby-on-rails-3.2, asset-pipeline

我已经坚持了 2 天了，所以我认为是时候提出一个 SO 问题了。

[我最近通过Sass-Twitter-Bootstrap](https://github.com/jlong/sass-twitter-bootstrap)在我的 Rails 应用程序中将我的 Bootstrap 从 2.0.4 升级到 2.1.0\. 在当地，一切看起来都很好。我在这里和那里做了一些小修改，但没有发现严重的问题。所以，我推送到 Heroku，编译资产，并在 Chrome 和 Firefox 中加载网站。太好了，完美，一切看起来都很好。直到我在IE9中测试。IE9 加载了似乎是部分编译的 application.css。当我在 Chrome 中查看 application.css 时，它看起来很棒，但 IE 在随机点处将其截断。在资产编译期间，我没有收到任何错误，所以这似乎是 IE 对最终编译的 application.css 的一些问题，因为它似乎总是在 Bootstrap CSS 中的随机点停止 CSS 的呈现。例如，如果我在 IE 的开发者工具中查看 application.css，它声称 CSS 在 Bootstrap Sass 模型组件（application.css. scss 那时还有很多 scss 文件要导入）。Chrome 的开发者工具会显示整个编译后的 CSS 文件，如果我在 IE 中直接导航到 application.css 文件，它也会下载整个 CSS 文件。

我已经验证升级到 Bootstrap 2.1.1 存在一些问题，就好像我回滚到升级之前一样，在所有浏览器中一切正常。我尝试切换到[bootstrap-sass](https://github.com/thomas-mcdonald/bootstrap-sass) gem，希望它能神奇地解决问题。它没。如果我删除了在 IE（modals.css.scss 文件）中 application.css 似乎停止渲染的 Bootstrap 组件，它只会在 bootstrap.scss 文件中的下一个 CSS 组件处停止其渲染。对于我拉出的每个 SCSS 组件，这个过程似乎都在继续，因此几乎不可能查明会奇怪地导致此问题的 CSS 的确切行。IE 似乎只是想放弃在特定点呈现 CSS。

我会提供一些配置，但我不确定此时真正要提供什么，所以请随时提出任何要求。任何输入或指导将不胜感激，因为我现在不知道该尝试什么……而且这种情况很少发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-05T16:40:08.040

我在使用基础 gem 的 Rails 项目中遇到了同样的问题。所以我想它与某种限制有关，只有 Internet Explorer 处理才能看到这个问题以获取更多信息[Internet Explorer 的 CSS 规则限制我使用这个 gem](https://stackoverflow.com/questions/9906794/internet-explorers-css-rules-limits) [https://github.com/zweilove/css_splitter](https://github.com/zweilove/css_splitter) 解决了我的问题

# javascript - 孙子窗口中的Javascript更新表单元素

> ID：12428781
> 
> 赞同：0
> 
> 时间：2012-09-14T16:49:03.537
> 
> 标签：javascript, forms, frames

我知道如何通过 javascript 编辑表单，所以使用类似的东西。

```
document.formname.fieldname.value 
```

但是我现在有另一个问题，我有一个框架，里面包含另一个框架。

所以第一个是A＆B（行），然后B里面是C＆D。我需要更新并在D中提交一个表格。我将如何选择它以在我的javascript中使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:53:36.993

如果它在您的第一帧中，您可以执行以下操作：

```
window.frames[0].document.formname.fieldname.value 
```

# c# - 通过 HTML 将图像从 asp.net 导出到 excel

> ID：12428783
> 
> 赞同：1
> 
> 时间：2012-09-14T16:49:18.203
> 
> 标签：c#, asp.net, html, vb.net, excel

我一直在尝试将包含其他数据的图表导出到 Excel 文件。我更愿意将其导出为 excel 格式的 HTML 文件，因为现有报告已经以这种方式生成。

我试过简单地链接图像，但这依赖于在线图像才能在 Excel 中显示。我还尝试将图像导出为嵌入式数据 URI，但 excel 不解析它（文件在浏览器中显示良好）。我在想用图像压缩工作表应该可以工作，但这会使事情变得复杂，并且需要用户在打开报告时执行额外的步骤。

有更好的方法还是我不走运？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:58:07.777

Dude 使用 microsoft office excel 中提供的 vba 宏工具进行代码开发和导出或导入各种关闭的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T10:50:28.750

你应该使用

Response.ContentType = "应用程序/zip";

ZipFile zip = new ZipFile(Response.OutputStream);

zip.AddStringAsFile(FileIO.OptimizeHtml(htmlWrite.InnerWriter.ToString()), filename.xls", "");

zip.Save();

# android - 在应用程序中嵌入 FTP 服务器

> ID：12428786
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:49:24.800
> 
> 标签：android, ftp, ftp-server

我想通过 Android 应用程序运行 FTP 服务器，是否有可用的开源 FTP 服务器，以便我可以在我的应用程序中使用它们。根据用户设置的设置，FTP 服务器将作为服务运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:58:26.450

[Colorado FTP](http://cftp.coldcore.com/) - Java 中的开源 FTP 服务器。第一个来自 Google 的“Java 中的开源 ftp 服务器”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-27T12:17:52.757

还有busybox ftpd（可用时）。我希望我在 3 天前就知道 :(

```
 /system/bin/busybox --install -s /system/xbin
    /system/xbin/tcpsvd -E 0.0.0.0 21 /system/xbin/ftpd /data/ourFolder/ -w 
```

# c# - 如何将数据集绑定到从下拉框的第二个索引开始的下拉框？

> ID：12428797
> 
> 赞同：0
> 
> 时间：2012-09-14T16:50:08.397
> 
> 标签：c#, asp.net, drop-down-menu, dataset

这是我的代码。有用。唯一的问题是当我将数据集绑定到其数据源时，下拉框的第一个索引被清除（“选择源数据库”）。

我想绑定数据集并包含第一个索引“选择源数据库”。

我怎样才能修改我的代码来完成这个？

```
protected void ddlServer_SelectedIndexChanged(object sender, EventArgs e)
{
    ddlSourceDatabases.Items.Clear();
    ddlSourceDatabases.Items.Add("Select Source Database");

    lbxSourceTables.Items.Clear();

    if (ddlSourceServers.SelectedIndex != 0)
    {
       try
       {
           ddlSourceDatabases.DataSource = Database.GetDatabases(ddlSourceServers.Text);
           ddlSourceDatabases.DataTextField = "name";
           ddlSourceDatabases.DataValueField = "name";
           ddlSourceDatabases.DataBind();
        }
        catch (Exception)
        {               
        }
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:52:35.520

在数据绑定到第一个位置后插入您的项目：

```
//...
ddlSourceDatabases.DataBind();
ddlSourceDatabases.Items.Insert(0, "Select Source Database");
//... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:53:03.513

我已经修改了你的代码，现在它应该可以工作了

```
protected void ddlServer_SelectedIndexChanged(object sender, EventArgs e)
 {
ddlSourceDatabases.Items.Clear();
lbxSourceTables.Items.Clear();

if (ddlSourceServers.SelectedIndex != 0)
{
   try
   {
       ddlSourceDatabases.DataSource = Database.GetDatabases(ddlSourceServers.Text);
       ddlSourceDatabases.DataTextField = "name";
       ddlSourceDatabases.DataValueField = "name";
       ddlSourceDatabases.DataBind();

      ddlSourceDatabases.Items.Add("Select Source Database");

    }
    catch (Exception)
    {               
    }
 }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T16:53:15.107

将“选择源数据库”作为新项目添加到您的数据源作为 DataTextField 和 null 作为 DataValueField。那会解决它。当您将数据绑定到数据源时，任何其他值都将被删除，并且只会显示来自您的数据源的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T16:53:21.017

与您之前添加的内容无关（在您的情况下是“选择源数据库”字符串），当您手动设置数据源时，您将替换之前添加的所有项目。所以在设置它的数据上下文之前添加项目（到零索引或第一个位置）使用`dlSourceDatabases.Items.Insert(0, "Select Source Database")`

# algorithm - 如何发现“A*”（A STAR）算法？

> ID：12428806
> 
> 赞同：-1
> 
> 时间：2012-09-14T16:51:01.517
> 
> 标签：algorithm, design-patterns, greedy

我的直觉和假设是，只要我们不能使用贪婪，那么 A* 将是要走的路，但我不是 100% 确定。我需要更多关于如何识别和发现 A* 算法的示例和模式。

有人可以给出一些特殊的极端情况，当你第一次看到它时，你就知道这不会是贪婪的，或者它必须是 A* 甚至不用费心去尝试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T17:25:41.133

通常，术语[**贪婪**](http://en.wikipedia.org/wiki/Greedy_algorithm)用于描述不[回溯](http://en.wikipedia.org/wiki/Backtracking)的算法。这些算法通过最大化启发式（通常是相当“本地”的）做出选择，然后永远不会重新访问该选择。将贪心算法想象成一个人挑选一个蛋糕然后马上吃掉它，而不是把它放在一边并调查另一个蛋糕是否更好。

相比之下，[**A***](http://en.wikipedia.org/wiki/A%2a)是一种回溯算法：它探索选择，可能在一定深度，但随后能够放弃这些选择并尝试其他可能性。

因此，如果您的问题有“死胡同”（局部最大值），无法进一步解决问题，那么贪心算法很可能不适合。但这并不一定意味着 A* 及其变体是您唯一的选择。还有许多其他类型的搜索算法使用不同的技术来摆脱死胡同：[模拟退火](http://en.wikipedia.org/wiki/Simulated_annealing)、[蒙特卡洛树搜索](http://en.wikipedia.org/wiki/Computer_Go#Monte-Carlo_methods)、[禁忌搜索](http://en.wikipedia.org/wiki/Tabu_search)、[粒子群优化](http://en.wikipedia.org/wiki/Particle_swarm_optimization)......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T17:06:29.043

贪心算法失败的典型案例是在目标附近死胡同的走廊情况。如果您对到目标的距离有启发式算法，那么贪心算法将沿着走廊走下去，因为这些位置离目标更近。例如，

```
_ _ _ _ _ _ _ _ _ _
| . S . . . . | G |
| . _ _ _ _ _ | . |
| . . . . . . . . |
| _ _ _ _ _ _ _ _ | 
```

请注意，代理必须“远离”目标 (G) 才能从起点 (S) 到达目标，这不是贪心算法所建议的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T22:27:47.627

A* 是单源单目的地最短路径算法。

当您可以将手头的问题作为最短距离问题提出时，您可以使用它，并且您可以找到不会高估的启发式方法（例如使用欧几里得距离）。

# java - 使用 JMeter TCP Sampler 是否可以使用响应的第一个字节来确定消息长度

> ID：12428807
> 
> 赞同：2
> 
> 时间：2012-09-14T16:51:03.843
> 
> 标签：java, tcp, inputstream, jmeter, protocol-buffers

我需要一些帮助来使用消息的第一个字节来识别响应的长度。

目前使用 JMeter 发送一些 TCP 请求，但不幸的是它无法确定消息的结束，所以它挂起。

通信协议是 Google Protobufs（协议缓冲区）并且没有确定消息结束的指示器。

以下是Jmeter所拥有的。如果有人能告诉我如何在此基础上进行构建，我将不胜感激，这样我就可以使用响应的第一个字节来测量消息的长度。

JMETER - 读取方法。

```
public String read(InputStream is) throws ReadException {
    ByteArrayOutputStream w = new ByteArrayOutputStream();
    try {
        byte[] buffer = new byte[127];
        int x = 0;
        while ((x = is.read(buffer)) > -1) {
            w.write(buffer, 0, x);
            if (useEolByte && (buffer[x - 1] == eolByte)) {
                break;
            }
                }
        IOUtils.closeQuietly(w); // For completeness
        final String hexString = JOrphanUtils.baToHexString(w.toByteArray());
        if(log.isDebugEnabled()) {
            log.debug("Read: " + w.size() + "\n" + hexString);
        }
        return hexString;
    } catch (IOException e) {
            throw new ReadException("", e, JOrphanUtils.baToHexString(w.toByteArray()));
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T19:24:16.547

先读这个：

*   [如何检测协议缓冲区消息何时被完全接收？](https://stackoverflow.com/questions/586819/how-to-detect-when-a-protocol-buffer-message-is-fully-received)

然后，如果您要发送一些指示行尾的自定义字符，请在协议中尝试在 jmeter.properties 中取消注释：

*   tcp.eolByte=

如果您在消息开始时发送长度，请使用：

*   [LengthPrefixedBinaryTCPClientImpl](http://jmeter.apache.org/usermanual/component_reference.html#TCP_Sampler)

如果这对您来说还不够，那么编写一个扩展[AbstractTCPClient](http://jmeter.apache.org/api/org/apache/jmeter/protocol/tcp/sampler/AbstractTCPClient.html)的新 ClientImpl 。

问候

菲利普·M

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:11:27.570

在这种情况下，长度包含在响应的第一个字节中，解决方案是编写一个自定义的 LengthPrefixedBinaryTCPClientImpl 灵感来自

*   [LengthPrefixedBinaryTCPClientImpl](http://jmeter.apache.org/usermanual/component_reference.html#TCP_Sampler)

使用以下读取方法：

```
public String read(InputStream is) throws ReadException {
    ByteArrayOutputStream w = new ByteArrayOutputStream();
    try {
        int mLen = readUnsignedInt(is);
        for (int i = 0; i < mLen ; i++) {
            int nByte= is.read();
            w.write(nByte);
        }  // carry on 
```

……

确定消息的长度。（记住小端和大端）

```
public static int readUnsignedInt(InputStream in) throws IOException {
    int b = in.read();
    int i = b & 0x7F;
    for (int shift = 7; (b & 0x80) != 0; shift += 7) {
        b = in.read();
        i |= (b & 0x7FL) << shift;
    }
    return i;
} 
```

然后将该类打包为 JAR 并放入：

*   /lib/ext

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:16:15.080

不读取输入流中内容的大小是不可能的。

# android - 位图大小超出 VM 预算的 Android 动画崩溃

> ID：12428809
> 
> 赞同：0
> 
> 时间：2012-09-14T16:51:10.377
> 
> 标签：android

我有一个 25 帧的动画，压缩的 jpeg 格式，总共不到 2mb。

```
<?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" android:oneshot="true">

    <item android:drawable="@drawable/y1" android:duration="50" />
    <item android:drawable="@drawable/y2" android:duration="50" />
     ...

    <item android:drawable="@drawable/mouse" android:duration="50" />

</animation-list> 
```

然而当我尝试演奏它时

```
 iv.setBackgroundResource( R.anim.yawn );
    AnimationDrawable anim = (AnimationDrawable)iv.getBackground();
    anim.start(); 
```

它因位图大小超过 VM 预算而崩溃。

有什么想法我能做什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T20:43:35.917

如果只是减少“占空比”怎么办......一旦我在处理图像时出现OutOfMemory错误，但是像......这样的Somethibg帮助了我......代码在上面......

```
 private void unbindDrawables(View view) {
 if (view.getBackground() != null) {
 view.getBackground().setCallback(null);
 }
 if (view instanceof ViewGroup) {
     for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++) {
     unbindDrawables(((ViewGroup) view).getChildAt(i));
     }
 ((ViewGroup) view).removeAllViews();
 } 
```

}

# audio - 音频处理硬件平台

> ID：12428812
> 
> 赞同：2
> 
> 时间：2012-09-14T16:51:29.690
> 
> 标签：audio, hardware, arduino, microcontroller

我想构建某种音频处理单元。我会将一些麦克风连接到它（例如手机中的麦克风，而不是歌手的大麦克风）。我在阅读 Android 中的原始音频数据方面有一些经验，这是我可以处理的抽象级别。一切变得更低级别的东西对我来说有点毛茸茸。（这里的原始意味着我从缓冲区中读取整数。）

是否有硬件平台可以让我轻松连接麦克风并读取原始音频数据？我想通过 USB 将它连接到计算机以传输原始音频数据。我认为进一步的处理将在计算机上进行，例如[傅立叶变换](http://en.wikipedia.org/wiki/Discrete_Fourier_transform)等。

我听说过 Arduino，它是否提供了一个很好的抽象级别？我可以改用什么平台？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T15:42:13.277

Arduino（至少是 8 位板）的问题在于它们没有任何类型的 DAC，因此您无能为力。此外，计算能力不足以进行实时音频处理，除非你想做某种老式音乐，比如在旧游戏系统中。

全新的 Arduino Due 可以改变这种情况，包括 32 位 ARM 处理器。在这里，您有一些 DAC，计算能力应该足以进行一些不错的音频处理。不方便的是这块板子真的很新，开发工具还不稳定。认为大多数 Arduino 板都带有 AVR 微控制器，而这个 Arduino Due 具有 ARM 处理器。架构完全不同。

我想向您推荐一些板子。如果你想做一些音频处理，我认为最好有一块带有插孔连接器（输入/输出）、SD 卡（读取一些音频文件）的板，也许还有一个屏幕来进行某种可视化（即图形条) 带有音频信号。

*   第一个选择：树莓派。它是便宜的开放硬件（尽可能多地......因为 ARM 制造商用专利保护他们的芯片），并且社区做了很多项目。我认为它就像 Arduino，但具有非常强大的架构。

*   mikroElektronika 有一些不错的[多媒体板](http://www.mikroe.com/mikromedia/pic32/ "多媒体板")。他们提供了多个版本（即 AVR、PIC、ARM，...），因此您可以选择您喜欢的任何架构，但外围设备都是相同的（声音芯片、TFT、WIFI...）。他们还提供编译器、库和文档。这不是一家很大的公司，所以我认为他们关心客户，你会得到很好的技术支持。

如果您不喜欢其中任何一个，我可以提出其他一些替代方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T16:57:56.380

没有理由为此使用 Arduino，标准 PC 声卡就可以了！你所要求的正是它是如何工作的。您可以捕获音频，并从缓冲区中读取采样值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:04:38.900

一些用于 PC 的新耳机包括麦克风，通过 USB 连接，这意味着您连接到 PC 的每个耳机本身就是一种声音。

# excel - QFE_Richmond 到底是什么意思？

> ID：12428816
> 
> 赞同：4
> 
> 时间：2012-09-14T16:51:59.567
> 
> 标签：excel, terminology

我正在为使用 RefEdit 控件的 Excel 开发 VBA 加载项。
我的一位测试人员指出，他在选择单元格时无法使用键盘快捷键。我在这里找到了解决这个问题的方法：http: [//support.microsoft.com/kb/291110](http://support.microsoft.com/kb/291110)在 .microsoft.com的 Excel 部分
中将魔法值设置为 1 。这个解决方案效果很好。`QFE_Richmond``HKEY_CURRENT_USER`

我的问题是*为什么*？
“QFE_Richmond”变量的意义是什么？它从哪里来的？为什么你需要这个不起眼的标志来修复一个至少在 Excel 2010 中持续存在并且至少可以追溯到 2003 年的简单故障？这个标志还有其他作用吗？
自动为我的加载项的用户进行此更改是否安全，即使它会全局影响他们的 Excel 设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T19:57:52.660

显而易见的答案似乎是他们要么忘记在每个版本中应用它，要么他们认为它不够重要而无法设为默认，因为它处于被视为错误或可用性偏好的边界，因为它有一个简单的解决方法（即使用 GUI 而不是快捷方式）。我不认为应用修补程序会伤害任何东西——如果是这样的话，他们不会让它可用。

将 QFE_Richmond 注册表项更改为 1 是为了启用修补程序。

[http://support.microsoft.com/?kbid=291110](http://support.microsoft.com/?kbid=291110)

“通常，修补程序是针对特定的客户情况制作的，可能不会分发到客户组织之外。”

此外，RefEdit 控件似乎还有其他选择： [http](http://peltiertech.com/WordPress/refedit-control-alternative/) ://peltiertech.com/WordPress/refedit-control-alternative/ 推荐使用它是因为它存在兼容性问题： http: [//peltiertech.com/WordPress/unspecified-painfully -frustrating-error/](http://peltiertech.com/WordPress/unspecified-painfully-frustrating-error/) 因此，您可能会认为 MS 在 RefEdit 功能的质量控制方面存在一些差距。

祝你好运。

**编辑/添加：**

顺便一提，

QFE 代表快速修复工程

# django - 从一个视图呈现多个表单

> ID：12428818
> 
> 赞同：0
> 
> 时间：2012-09-14T16:52:25.400
> 
> 标签：django, django-forms, django-templates, django-views

我正在创建一些接口来协助基本任务，例如从数据库中批量添加和删除对象。我希望为管理员/用户提供预览。例如，将删除的所有对象的列表。所以这个过程（从用户的角度来看）是这样的

1.  启动流程
2.  预览效果
3.  确认开始实际流程
4.  坐下来，放松一下，等待完成邮件。

以下哪种方法是良好的编程习惯？

*   每个阶段都有单独的视图，并在每个无错误的发布请求时重定向到下一个。

*   整个操作的单个视图，它使用会话变量中的一些数据来跟踪进度。（目前正在使用）

*   使用 django 的向导表单方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:02:34.393

从阅读您的要求看来，django 的表单向导会更好，因为它更容易

*   在您可能需要的表单/步骤之间传递数据
*   在这些步骤中来回切换再次变得更容易，不需要太多手工代码来管理状态。

如果您对向导不太满意，最好使用多个视图。在这种情况下，您可能需要使用`request.session`在视图之间传递数据。

# php - mysql查询的时间戳

> ID：12428819
> 
> 赞同：-2
> 
> 时间：2012-09-14T16:52:27.467
> 
> 标签：php

我有一个搜索引擎，它从 mysql 数据库中获取链接和标题，并将它们循环到与用户输入相匹配的页面中。它本质上是一个查询，我想知道如何创建一个标记来计算 a）返回的行数和 b）查询返回结果所需的时间。有任何想法吗？

例如，如果我输入“谷歌”，搜索引擎会返回“谷歌”的结果，但是，在结果上方，我希望它显示查询花费了多长时间，大约 4 位小数和多少行正在显示。

```
 $query = " SELECT * FROM scan WHERE "; 

$terms = array_map('mysql_real_escape_string', $terms);
$i = 0; 
foreach ($terms as $each) {
      if ($i++ !== 0){
            $query .= " AND "; 
      }
      $query .= "keywords LIKE '%{$each}%'";
}
// Don't append the ORDER BY until after the loop
$query .= "ORDER BY rank";

$query = mysql_query($query) or die('MySQL Query Error: ' . mysql_error( $connect ));
$numrows = mysql_num_rows($query);
if ($numrows > 0) {
        if ($k == "Paralympics 2012" ) {
                    echo "<h1> Paralympic Event: Archery  </h1>";
                }
                 if ($k == "paralympics 2012") {
                 echo "<h1> Paralympic Event: Archery </h1>";

            }
      while ($row = mysql_fetch_assoc($query)) {
            $id = $row['id'];
            $title = $row['title'];
            $description = $row['description'];
            $keywords = $row['keywords'];
            $link = $row['link'];
            $rank = $row['rank']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:56:59.437

您将`microtime()`执行查询之前和`microtime()`执行查询之后的两者相减，然后您就有了执行查询所需的时间（以微秒为单位）。

# matlab - 如何在 MATLAB 的 txt 文件中显示列表中的随机单词？

> ID：12428822
> 
> 赞同：0
> 
> 时间：2012-09-14T16:52:30.697
> 
> 标签：matlab, psychtoolbox

如果有人可以帮助解决这个问题，那就太好了。

我在 .txt 文件的单列中有一个单词列表，并希望使用**Matlab Psychtoolbox**`DrawFormattedText`以随机顺序（不替换）呈现它们。

 **目前我收到此错误：

```
Error using cast
Unsupported class for conversion.

Error in DrawFormattedText (line 282)
        curstring = cast(curstring, stringclass); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T12:43:18.620

我对心理工具箱没有经验，但你描述的任务似乎很简单。

这是我将如何处理它：

*   尝试通过在当前目录中找到文件来导入文件，右键单击它并选择“导入数据”

希望您的数据结构良好，否则您可能需要更有创意。

*   您现在将获得一个变量，例如“data”，一个 Nx1 元胞数组

*   现在您可以通过以下方式随机绘制： p = randperm(1:N)

如果您想显示 100 个单词，只需执行以下操作：

```
for i = 1:100
data(p(i))
end 
```**

# c# - 如何创建我的 c 尖锐对象以匹配我的 RestSharp XML 响应？

> ID：12428824
> 
> 赞同：0
> 
> 时间：2012-09-14T16:52:36.510
> 
> 标签：c#, xml, object, restsharp

我刚开始使用 RestSharp 并且使用 NextFlix API 已经能够成功地创建我的 Oauth 令牌并从 NetFlix 请求数据。但由于某种原因，我似乎无法创建我的对象以正确匹配返回的 XML。

我的代码：

```
 var client2 = new RestClient("http://api-public.netflix.com")
        {
            Authenticator = OAuth1Authenticator.ForProtectedResource(MyOauth.ConsumerKey, MyOauth.ConsumerSecret, MyOauth.OauthToken, MyOauth.OauthTokenSecret)
        };

        var request = new RestRequest("/catalog/titles/autocomplete");
        request.AddParameter("term", "star wars");
        var searchResults = client2.Execute<CatalogList>(request); 
```

我尝试的对象创建：

```
 [XmlRoot("autocomplete")]
    public class CatalogList
    {
        public List<AutoCompleteItem> Titles { get; set; }
    }

    [XmlRoot("autocomplete_item")]
    public class AutoCompleteItem
    {
        [XmlElement("title short")]
        public string Title { get; set; }

        [XmlElement("short")]
        public string ShortName { get; set; }
    } 
```

serachresults 返回 20 个标题，我的 List 有 20 个条目，但是 AutoCompleteItem 始终为空。我已经更改了元素名称、属性等，但从未得到正确的组合。

返回的 XML 如下所示：

```
<?xml version="1.0" standalone="yes" ?> 
<autocomplete>
<url_template>http://api-public.netflix.com/catalog/titles/autocomplete?{-join|&|term}   </url_template> 
<autocomplete_item>
<title short="Star Wars: Episode II: Attack of the Clones" /> 
</autocomplete_item> 
```

我在这里想念什么？

谢谢，

杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:06:47.290

```
[XmlRoot("autocomplete")]
public class AutocompleteList
{
    [XmlElement("url_template")]
    public string UrlTemplate { get; set; }

    [XmlElement("autocomplete_item")]
    public List<AutocompleteItem> Items { get; set; }
}

public class AutocompleteItem
{
    [XmlElement("title")]
    public Title ItemTitle { get; set; }
}

public class Title
{
    [XmlAttribute("short")]
    public string Short { get; set; }
} 
```

内部`Title`类型是捕获 XML 属性所必需的`short=`。

```
string xml = @"<?xml version=""1.0"" standalone=""yes"" ?>
<autocomplete>
    <url_template>http://api-public.netflix.com/catalog/titles/autocomplete?{-join|&amp;|term}</url_template>
    <autocomplete_item>
        <title short=""Star Wars: Episode II: Attack of the Clones"" />
    </autocomplete_item>
</autocomplete>";

var reader = new StringReader(xml);
var ser = new XmlSerializer(typeof(AutocompleteList));

var result = (AutocompleteList) ser.Deserialize(reader); 
```

这会产生与

```
var result = new AutocompleteList
{
    UrlTemplate = "http://api-public.netflix.com/catalog/titles/autocomplete?{-join|&|term}",
    Items = new List<AutocompleteItem>
    {
        new AutocompleteItem
        {
            ItemTitle = new Title
            {
                Short = "Star Wars: Episode II: Attack of the Clones",
            }
        },
    },
} 
```

# ruby-on-rails-3 - Guard 在 PostGIS 上工作时出错

> ID：12428826
> 
> 赞同：1
> 
> 时间：2012-09-14T16:52:49.273
> 
> 标签：ruby-on-rails-3, postgis, guard

我根据以下教程使用我的 Rails 应用程序设置了 PostGIS：[http ://www.daniel-azuma.com/blog/archives/69](http://www.daniel-azuma.com/blog/archives/69)

当我尝试使用 Guard 运行测试时，出现以下错误： `Exception encountered: #<ActiveRecord::StatementInvalid: PG::Error: ERROR: must be owner of relation spatial_ref_sys: ALTER TABLE "spatial_ref_sys" ENABLE TRIGGER ALL>`

我已将 postgis 模式的所有者更改为我的“普通”数据库用户。我还在测试中使用数据库清理器。

完整的回溯如下：

> /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rack-mini-profiler-0.1.18/lib/patches/sql_patches.rb:155:in `exec' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rack-mini-profiler-0.1.18/lib/patches/sql_patches.rb:155:in`async_exec ' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/active_record/connection_adapters/postgresql_adapter.rb:654:in`block in execute' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/active_record/connection_adapters/abstract_adapter.rb:280:in`块日志'/Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activesupport-3.2.7/lib/active_support/notifications/instrumenter.rb:20:in `instrument' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/active_record/connection_adapters/abstract_adapter.rb:275:in`log ' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/active_record/connection_adapters/postgresql_adapter.rb:653:in`execute' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/active_record/connection_adapters/postgresql_adapter.rb:530:in`确保在 disable_referential_integrity'/Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/active_record/connection_adapters/postgresql_adapter.rb:530 中：在`disable_referential_integrity' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/database_cleaner-0.8.0/lib/database_cleaner/active_record/truncation.rb:132:in`干净'/Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/database_cleaner-0.8.0/lib/database_cleaner/base.rb:39:in`clean_with' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/database_cleaner-0.8.0/lib/database_cleaner/configuration.rb:62:in`块clean_with' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/database_cleaner-0.8.0/lib/database_cleaner/configuration.rb:62:in `each' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/database_cleaner-0.8.0/lib/database_cleaner/configuration.rb:62:in`clean_with' /用户/OyoKooN/Projects/sos_medecins/spec/spec_helper.rb:50:in `block (3 levels) in <top (required)>' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/hooks.rb:23:in`instance_eval' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core -2.11.1/lib/rspec/core/hooks.rb:23:in`run' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/hooks.rb:72:in`阻止运行'/Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/hooks.rb： 72：`each' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/hooks.rb:72:in`运行中'/Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/hooks.rb :424:in `run_hook' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/command_line.rb:27:in`block in run' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/记者.rb：34：`report' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rspec-core-2.11.1/lib/rspec/core/command_line.rb:25:in`运行中'/Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/test_framework/rspec .rb:11:in `run_tests' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/run_strategy/forking.rb:13:in`block in run' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/forker。 rb:21:in `block in initialize' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/forker.rb:18:in`fork' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/forker.rb:18 ：在`initialize' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/run_strategy/forking.rb:9:in`新的'/Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/run_strategy/forking.rb:9:in `run' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/spork-1.0.0rc3/lib/spork/server.rb:48:in`run ' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1548:in `perform_without_block' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1508:in`perform' /Users/OyoKooN/.rbenv/versions/1.9.3- p194/lib/ruby/1.9.1/drb/drb.rb:1586:in `block (2 levels) in main_loop' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb:1582:in`loop' /Users/OyoKooN/.rbenv/versions/1.9.3-p194/lib/ruby/1.9.1/drb/drb.rb :1582:in `block in main_loop'

谢谢。

# c# - 从另一个类文件访问 C# 表单文本框

> ID：12428829
> 
> 赞同：0
> 
> 时间：2012-09-14T16:53:08.740
> 
> 标签：c#, forms, file, class, controls

我想从另一个类文件（例如chartscopier.cs）访问Form1 元素，但我无法从chartcopier.cs 更改textbox1 文本。

我怎样才能做到这一点？

这是我的代码：

**Form1.cs**

```
namespace TEST
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            var CopyCharts = new System.Threading.Timer(chartscopier.CopyGraph, null, 0, 60000);
        }
    }
} 
```

**海图复印机.cs**

```
namespace TEST
{
    class chartscopier
    {
        //var Timer = new Timer(CopyGraph, null, 0, 60000);
        public static void CopyGraph(object data)
        {
            Stopwatch strTimer = new Stopwatch();
            WebClient WC = new WebClient();
            IConfigSource BaseConfig = new IniConfigSource(@"D:\NEWROBOT\CONFIG.ini");
            string LogDir = BaseConfig.Configs["GENERAL"].Get("Log Dir");
            string ImgDir = BaseConfig.Configs["GENERAL"].Get("IMG Dir");
            string[] Clients = BaseConfig.Configs["CLIENTS"].GetKeys();
            foreach (string Client in Clients)
            {
                strTimer.Start();
                //Console.WriteLine(Client);
                IConfigSource ClientConfig = new IniConfigSource(@"D:\NEWROBOT\" + Client + ".ini");
                string[] Services = ClientConfig.Configs["SERVICES"].GetKeys();
                foreach (string Service in Services)
                {
                    string url = BaseConfig.Configs["CLIENTS"].Get(Client);
                    string param = ClientConfig.Configs["SERVICES"].Get(Service);
                    string html = WC.DownloadString(url + param);

                    // Cargar doc en HPACK
                    HtmlDocument doc = new HtmlDocument();
                    doc.LoadHtml(html);

                    // LINQ para generar imagenes
                    var img = doc.DocumentNode.SelectSingleNode("//img[1]");
                    var src = img.Attributes["src"].Value;
                    string uIMG = url + src;
                    WC.DownloadFile(uIMG, @ImgDir + Client + "\\" + Service + ".png");
                }
                strTimer.Stop();
                TimeSpan ts = strTimer.Elapsed;
                string elapsedTime = String.Format("{0:00}:{1:00}:{2:00}.{3:00}", ts.Hours, ts.Minutes, ts.Seconds, ts.Milliseconds / 10);
                strTimer.Reset();
                // WANT TO WRITE HERE Form1.TextBox1.text = "RunTime " + elapsedTime;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:19:44.830

我认为，更好的方法是通过事件来处理。

创建一个类来表示您要传递的数据。

```
public class ChartCopyProgressEventArgs : EventArgs
{
  public TimeSpan ElapsedTime { get; set; }
  //you can add more prop.s here
} 
```

在“chartscopier”中创建一个事件来报告进度。

```
class chartscopier
{
 public static event EventHandler<ChartCopyProgressEventArgs> Changed;
 public static void CopyGraph(object data)
 {
 ...
 if (Changed != null)
 {
   var args = new ChartCopyProgressEventArgs();
   args.ElapsedTime = elapsedTime;
   Changed(null, args);
 }
 }
} 
```

然后在 Form1 中，为该事件创建一个处理程序。

```
public Form1()
{
 InitializeComponent();
 chartscopier.Changed += UpdateStatus;
 ...
}

private void UpdateStatus(object sender, ChartCopyProgressEventArgs e)
{ 
    var ts = e.ElapsedTime;
    var elapsedTime = String.Format("{0:00}:{1:00}:{2:00}.{3:00}", ts.Hours, ts.Minutes, ts.Seconds, ts.Milliseconds / 10);
    var str = "RunTime " + elapsedTime;

    if (TextBox1.InvokeRequired) {
        TextBox1.Invoke(() => {TextBox1.text = str;});
    } else {
         TextBox1.text = str;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:59:28.717

您需要将表单传递给该函数，以便您可以访问它，然后在表单上编写一个公共函数来修改/获取文本框。确保这两个函数正在检查是否需要调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:00:09.210

您需要将要`chartscopier.CopyGraph`直接操作的引用传递给该方法，以便它可以在范围内。你的`CopyGraph(object data)`签名应该更像`CopyGraph(object data, TextBox aTextBox)`

然后您可以从 Form1 的实例中调用它，例如

```
chartscopier.CopyGraph(data,this.textBox1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T17:05:23.250

此示例将向您展示如何从其他类访问表单元素：

```
public partial class Form1 : Form
    {       
        private void button1_Click(object sender, EventArgs e)
        {
            FormCopier fc = new FormCopier();
            fc.PopulateTest(this.textBox1);
        }
    } 
```

而在其他班级..

```
class FormCopier
{
    public void PopulateTest(TextBox t)
    {
        t.Text = "Demo";
        t.Refresh();
    }
} 
```

# java - 在java中存储信息

> ID：12428835
> 
> 赞同：0
> 
> 时间：2012-09-14T16:53:26.053
> 
> 标签：java, map, arraylist, set

我想存储信息，字符串用户名，字符串密码和字符串登录类型。

尝试登录时，我想查找用户名是否存在，然后验证密码并返回 loginType。

存储这个的最佳集合类型是什么？

我需要做的是 --> 当我尝试添加详细信息时，我首先必须检查用户名是否已经存在。如果没有匹配，我的详细信息将保存，如果用户名已经存在，数据将不会保存。

我也需要搜索。我希望能够找到用户名。然后验证我是否有密码匹配并返回类型

这些项目的顺序无关紧要。

存储这个的最佳集合类型是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:54:32.190

不是收藏；我会创建一个名为 Credentials 的对象：

```
package security;

public class Credentials {
    private final String username;
    private final String password; 
    private final String type;

    public Credentials(String u, String p, String t) {
        this.username = u;
        this.password = p;
        this.type = t;    
    }
}

// you add the rest. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:01:51.507

无论您指定什么，最初都不需要集合；你需要的是把你的数据建模成一个对象。

我会推荐`@duffymo`一个类中有 3 个成员的示例：

```
public class Credentials {

    private String userName;
    private String password;
    private String loginType;
} 
```

# android - 如何获取 Activity 的窗口宽度和高度？

> ID：12428838
> 
> 赞同：3
> 
> 时间：2012-09-14T16:53:39.463
> 
> 标签：android, android-layout

我有一个 ListFragment，它在 onActivityCreated() 方法中添加了 2 个视图——一个 MapView 通用视图（持久标头）。我希望 ListView 在纵向模式下显示在 MapView 和标题下方，在 MapView 右侧和横向模式下显示在标题下方。我还希望 MapView 的高度（纵向）和宽度（横向）是可用窗口大小的百分比（减去操作栏、状态栏和导航栏——如果设备上存在的话）。为此，我相信我需要获取窗口大小并计算所有 3 个视图的适当高度、宽度和布局边距。我已经尝试过类似问题中推荐的一些方法，但解决方案总是返回设备的高度/宽度，而不是 Activity 的窗口大小。

有任何想法吗。提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-14T17:21:39.093

```
DisplayMetrics metrics = context.getResources().getDisplayMetrics();
int width = metrics.widthPixels;
int height = metrics.heightPixels; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-14T18:05:00.143

对于缩放，您可以通过执行以下操作来实现：

```
DisplayMetrics metrics = context.getResources().getDisplayMetrics();
LayoutParams params = new LayoutParams(metrics.widthPixels * desiredWidthPercentage, metrics.heightPixels * desiredHeightPercentage); 
```

然后将参数应用于您想要的视图。

对于不同的方向，我建议在 layout 和 layout-land 文件夹中使用不同的布局，或者动态添加如下规则：

```
params.addRule(RelativeLayout.Above, ViewId); 
```

要查看规则的所有关键字，请参阅：http: [//developer.android.com/reference/android/widget/RelativeLayout.html](http://developer.android.com/reference/android/widget/RelativeLayout.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-25T19:47:37.460

我能够通过使用 ViewTreeObserver 来解决这个问题。

```
ViewTreeObserver vtObserver = view.getViewTreeObserver();
vtObserver.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
    @Override
    public void onGlobalLayout() {
        // check if the view's height and/or width > 0
        // don't forget to remove the listener when done using removeOnGlobalLayoutListener
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T17:17:44.270

我不确定这里的答案是获取屏幕尺寸，而是使用适当的纵向和横向布局，使用权重属性在不同视图之间分配屏幕空间。

我相信您可以拥有一个可以托管其他片段布局的容器布局。

您可以看到一些在布局 xml 文件中使用片段的简单示例。

[http://android-er.blogspot.com/2011/12/simple-exercise-of-fragment-inflate.html](http://android-er.blogspot.com/2011/12/simple-exercise-of-fragment-inflate.html)

和这里

[http://portabledroid.wordpress.com/2011/04/19/programmatic-and-layout-fragments/](http://portabledroid.wordpress.com/2011/04/19/programmatic-and-layout-fragments/)

此外，有关为不同屏幕尺寸提供布局的提示，请参阅此链接：http: [//developer.android.com/guide/topics/resources/providing-resources.html](http://developer.android.com/guide/topics/resources/providing-resources.html)

我希望这能为您指明正确的方向。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-14T18:30:58.420

就像其他人建议的那样，我会为每个方向使用不同的布局，并以不同的方式处理它：

```
if(getResources().getBoolean(R.bool.is_land)){
   //Set up mapview on the side
} else{
   //Add header to listfragment
} 
```

在 res/values-land 中使用布尔值

# regex - 如何在 Perl 正则表达式中使用 /r 标志？

> ID：12428846
> 
> 赞同：6
> 
> 时间：2012-09-14T16:54:21.543
> 
> 标签：regex, perl

Perl 文档指出：

```
e  Evaluate 'replacement' as an expression
r  Return substitution and leave the original string untouched. 
```

是可用于替换模式的标志。当我将`r`标志传递给我的替换模式时，它被解释为语法错误。我正在运行 Perl 5.8.8。我的 Perl 版本是否可能不支持它？另外，有人可以提供一个如何使用标志以及如何调用新创建的替换的工作示例吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-14T16:57:17.500

那么，也许您应该阅读 5.8.8 的文档？/r 已添加到 5.14！

在 5.8.8 中，您可以执行相当于

```
s/foo/bar/r 
```

和

```
do { (my $s = $_ ) =~ s/foo/bar/; $s } 
```

* * *

s///r 的示例用法：

```
print "abba" =~ s/b/!/rg;         # Prints a!!a

my $new = $old =~ s/this/that/r;  # Leaves $old intact.

my $trimmed = $val =~ s/^\s+//r =~ s/\s+\z//r;
my $trimmed = (($val =~ s/^\s+//r) =~ s/\s+\z//r);  # Same as previous 
```

# python-3.x - Blender 游戏引擎数据持久化和导入

> ID：12428854
> 
> 赞同：1
> 
> 时间：2012-09-14T16:55:06.283
> 
> 标签：python-3.x, blender

我在 Blender 的编辑器中为 Blender 游戏引擎创建了一些脚本。我正在使用 Burster 插件来显示混合文件（关于插件的更多信息在[这里](http://geta3d.com/index.php?option=com_content&view=frontpage&Itemid=17)）

因为我了解到一旦 burster 插件在线显示 .blend 文件，就无法读取或写入文件，所以我已经搜索了另一种保存数据的解决方案。我一直在 Blender 游戏引擎中填充 globalDict。

这已经（除非我在这里遗漏了一些东西......疲劳和所有）允许数据持久化，因为数据是从脚本内部手动加载的。我这样做是因为脚本似乎从一次打开混合文件通过 Burster 持续到下一次。

**所以，关于我的问题：**

1.  使用上述设置（Blender -> Burster）是否有更好的方法来进行数据持久化？

2.  如果不是（或者即使是这样），我想知道 Blender 在哪里存储您在 Blender 中创建、编辑和保存的 python 脚本。

任何建议或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T20:55:55.757

这实际上完全取决于您想要获得什么样的“持久性”。

如果您想要在游戏期间保留数据，则必须使用 logic.globalDict，因为这是唯一跨场景持续存在的结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T04:11:27.247

您可以在游戏对象中设置属性。

```
 import bge

    def main():
        cont = bge.logic.getCurrentController()
        own = cont.owner
        x = 2
        own["x"] == x

    main() 
```

现在访问它。

```
 import bge

    def main():
        scene = GameLogic.getCurrentScene()
        cont = bge.logic.getCurrentController()
        own = cont.owner

        obj = scene.objects["obj"]

        x = obj["x"]
    main() 
```

Blender 将其文件存储在 .blend 文件中。我不知道没有搅拌机就可以访问它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-02T19:38:38.093

根据设计，Burster 插件无法将持久数据保存到用户的计算机上。在我向他们展示了一些非常严重的安全问题之后，Burster 的作者做出了这个必要的限制（并且还关闭了自动游戏启动）。

您可以在此处阅读 Burster 可以做什么和不可以做什么的完整详细信息：http://geta3d.com/index.php?option=com_content&view=article&id=20&Itemid= [23](http://geta3d.com/index.php?option=com_content&view=article&id=20&Itemid=23)

对 cookie 的支持（允许将游戏状态保存到浏览器）是一项计划中的功能，但我不确定 Burster 的开发是否仍在进行中。

# java - 注解不是从接口方法继承的

> ID：12428858
> 
> 赞同：14
> 
> 时间：2012-09-14T16:55:26.230
> 
> 标签：java, annotations

我有一个带注释方法的接口。注释标有`@Inherited`，所以我希望实现者继承它。但是，事实并非如此：

代码：

```
import java.lang.annotation.Inherited;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.reflect.Method;
import java.util.Arrays;

public class Example {

    public static void main(String[] args) throws SecurityException, NoSuchMethodException {
        TestInterface obj = new TestInterface() {
            @Override
            public void m() {}
        };

        printMethodAnnotations(TestInterface.class.getMethod("m"));
        printMethodAnnotations(obj.getClass().getMethod("m"));
    }

    private static void printMethodAnnotations(Method m) {
        System.out.println(m + ": " + Arrays.toString(m.getAnnotations()));
    }
}

interface TestInterface {
    @TestAnnotation
    public void m();
}

@Retention(RetentionPolicy.RUNTIME)
@Inherited
@interface TestAnnotation {} 
```

上面的代码打印：

> 公共抽象 void annotations.TestInterface.m(): [@annotations.TestAnnotation()]
> 
> public void annotations.Example$1.m(): []

`obj.m()`所以问题是`@TestAnnotation`尽管它实现了一个标记为`@TestAnnotation`is的方法，但为什么没有`@Inherited`呢？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-14T17:00:28.783

来自的[javadocs](http://docs.oracle.com/javase/6/docs/api/java/lang/annotation/Inherited.html)`java.lang.annotation.Inherited`：

> 请注意，如果注释类型用于注释类以外的任何内容，则此元注释类型无效。另请注意，此元注释仅导致注释从超类继承；已实现接口上的注释无效。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-09-14T17:00:41.270

来自[@Inherited](http://docs.oracle.com/javase/6/docs/api/java/lang/annotation/Inherited.html) javadoc：

> 请注意，如果注释类型用于注释类以外的任何内容，则此元注释类型无效。另请注意，此元注释仅导致注释从超类继承；已实现接口上的注释无效。`

总之，它不适用于方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-31T15:22:28.870

或者，您可以使用反射来获取相同的信息。该方法`printMethodAnnotations`可以重写为：

```
private static void printMethodAnnotations(Method m) {
    Class<?> methodDeclaredKlass = m.getDeclaringClass();
    List<Class<?>> interfases = org.apache.commons.lang3.ClassUtils.getAllInterfaces(methodDeclaredKlass);
    List<Annotation> annotations = new ArrayList<>();
    annotations.addAll(Arrays.asList(m.getAnnotations()));
    for (Class<?> interfase : interfases) {
        for (Method interfaseMethod : interfase.getMethods()) {
            if (areMethodsEqual(interfaseMethod, m)) {
                annotations.addAll(Arrays.asList(interfaseMethod.getAnnotations()));
                continue;
            }
        }
    }
    System.out.println(m + "*: " + annotations);
}

private static boolean areMethodsEqual(Method m1, Method m2) {
    // return type, Modifiers are not required to check, if they are not appropriate match then it will be a compile
    // time error. This needs enhancements for Generic types parameter ?
    return m1.getName().equals(m2.getName()) && Arrays.equals(m1.getParameterTypes(), m2.getParameterTypes());
} 
```

# android - 如何使用存储在本地主机或服务器上的图像制作活动背景？

> ID：12428864
> 
> 赞同：0
> 
> 时间：2012-09-14T16:56:19.740
> 
> 标签：android, android-layout, android-intent, android-emulator

我在我的项目中遇到了一个问题，我正在尝试制作存储在服务器上或存储在带有图像文件夹的 xml 中的图像的背景。我这样做是因为我的应用程序中的图像覆盖了大约 15 mb 的数据，所以我想通过将我的图像放在本地主机上（而不是可绘制文件夹）然后通过解析来自 xml 的数据来减少这个空间，我想让它成为背景我的活动。请有人告诉我如何通过具有图像链接的 XML 解析来自服务器的数据，这样该图像链接可用于设置为活动的背景...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:18:45.710

至于实际从 url 设置背景，你可以试试这个人的建议：

[LinearLayout 背景和图片来自网络](https://stackoverflow.com/questions/10229255/linearlayout-background-and-images-from-web)

您也可以尝试将 Activity 的背景设置为 WebView，然后为 WebView 提供您要加载的 url。我认为这需要一个 RelativeLayout（或可能是 FrameLayout），以使 z 轴分层成为可能。

至于解析 XML，您可以使用 XMLPullParser 或 SAXParser。我不确定您对 XML 的真正要求是什么，所以如果您澄清您的问题（或添加示例 XML 文件？）我可以提供更多信息。

# excel - 刷新表格后保持excel表格格式

> ID：12428867
> 
> 赞同：0
> 
> 时间：2012-09-14T16:56:34.803
> 
> 标签：excel, vba

我有使用 sproc 刷新 Excel 表的 VBA 代码

```
With ActiveWorkbook.Connections("Connection").OLEDBConnection
Values = QueryStr 
.CommandText = Values
End With 
```

刷新完成后，我需要应用一些格式（通过 VBA 代码），问题是代码在不等待刷新结束的情况下执行，因此 VBA 宏失败，有没有办法告诉宏等到刷新完成？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:46:18.907

尝试将 BackgroundQuery 属性设置为 False。

代码：

```
With ActiveWorkbook.Connections("Connection").OLEDBConnection
    .BackgroundQuery = False '- Change here
    Values = QueryStr
    .CommandText = Values
End With 
```

如果我没记错的话..这将阻止更新在后台运行，因此必须在其余代码执行之前完成。

# linux - 完成压缩 IP 标头的 Xmit

> ID：12428869
> 
> 赞同：2
> 
> 时间：2012-09-14T16:56:38.437
> 
> 标签：linux, network-programming, linux-kernel, network-protocols

我正在将 IP 标头压缩协议实现为可加载的内核模块，该模块采用 IPv4 标头并将其压缩为更小的标头（我们称之为“iphc”标头）。

为此，对于传出数据包，我使用`NF_IP_POST_ROUTING`netfilter 钩子在路由决策完成后抓取数据包。然后，我想用 IPHC 标头（压缩 IP）替换 IP 标头，将 ethertype 更改为其他类型，将其发送到堆栈（到以太网）并发送出去。从我所看到的情况来看，当我在`NF_IP_POST_ROUTING`挂钩处截获数据包时，尚未添加 MAC 标头。

我有几个问题：

1.  鉴于我正在替换 IP 标头，这会影响以太网查找 MAC 硬件地址的能力吗？我在函数中看到`ip_finish_output2()`，他们使用 skbuff 中的 dst 值（使用`skb_dst()`函数）来搜索邻居表中的 ARP 条目。如果我只是用 IPHC 标头交换 IP 标头并更改协议，那么 ARP 查找会失败吗？我认为我没有触及 skbuff 中的“dst”字段。

2.  我只需用 IPHC 标头替换 IP 标头、更改 Ethertype 并将其发送回堆栈就足够了吗？还是我应该自己直接传输而不将其返回到 ip_finish_output2

出于某种原因，如果我执行 #2，我的代码就会崩溃。下面是我在钩入 NF_IP_POST_ROUTING netfilter 钩子（传入 skb）后尝试做的一个示例：

```
struct iphc *my_hdr;

/* stripping the IPv4 header from skbuff */
skb_pull(skb, sizeof (struct iphdr));

/* adding my header skb */
skb_push(skb, IPHC_HDR_SIZE);

/* reset network header */
skb_reset_network_header(skb);

my_hdr = (struct iphc *)skb;

my_hdr->field1 = 1;
my_hdr->field2 = 2;

/* change ethertype */
skb->protocol = __constant_htons(ETH_P_IPHC);

return NF_ACCEPT; 
```

我在这里错过了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T06:43:54.100

如果不知道 skb->data 当前指向的位置，就不能使用 skb_pull() 和 skb_push()。

当数据包在 NF_IP_POST_ROUTING 被截获时，很可能 skb->data 指向帧的开头，这也是 MAC 头的开头。

因此，在进行任何 skb_push() 操作之前，您应该先使用 skb_pull() 拉出 MAC 标头，然后再拉出 IP 标头。然后将数据 (MAC+IPHDR) 压缩为 (MAC+IPHC)，然后 skb_push() 完全组合 (MAC+IPHC) - 或者您可以先推送 IPHC，然后再推送 MAC。

有关这些 skb 函数的详细信息，请参阅 skbuff.h，有关 skb 的优秀教程可以在[这里](http://vger.kernel.org/~davem/skb_data.html)找到。

# tsql - 使用 CTE 以及开始和结束日期时间避免日期时间间隔的间隙

> ID：12428873
> 
> 赞同：0
> 
> 时间：2012-09-14T16:56:53.790
> 
> 标签：tsql, date, common-table-expression, overlapping

出于某种原因，我看到使用此查询的时间间隔存在差距。仅使用基本数据时，我就可以使用它。但是，当加入我的表并指定 WHERE 子句时，我看到我的时间间隔有间隙。我还需要将 S.SessionEndTime 合并到我的间隔中，以查找与 ResponseTime 和 SessionEndTime 之间的给定 1 分钟间隔重叠的记录计数。

这是我正在使用的查询。通过使用派生表，我在 1 分钟间隔内基于 COUNT 获得每小时 MAX。

```
 DECLARE @start_date     DATETIME
DECLARE @end_date       DATETIME
DECLARE @interval TIME

SET @start_date = '08/01/2012'
SET @end_date = '08/01/2012 12:00:00'
SET @interval = '00:01:00.00';

    WITH TimeWindowsCTE AS 
    ( 
        SELECT 
            @start_date AS WindowStart, @start_date + @interval AS WindowEnd 
        UNION ALL 
        SELECT 
            SW.WindowStart + @Interval, SW.WindowEnd + @interval 
        FROM 
            TimeWindowsCTE AS SW 
        WHERE 
            SW.WindowEnd < @end_date 
    ) 
    SELECT 
        DATEADD(hour, DATEDIFF(hour, CONVERT(datetime, '19000101', 112), t1.WindowStart), CONVERT(datetime, '19000101', 112)) WindowStart, 
        MAX([Sessions]) [Sessions]
    FROM 
    (
        SELECT 
            SW.WindowStart, COUNT(*) [Sessions] 
        FROM 
            TimeWindowsCTE AS SW 
            LEFT OUTER JOIN SessionDetails AS S ON SW.WindowStart <= S.ResponseTime and S.ResponseTime < SW.WindowEnd
            --I need to introduce the S.SessionEndTime into the JOIN so I can count the number of records that 
            --fall within the interval
            LEFT OUTER JOIN VoipDetails V on S.SessionIdTime = V.SessionIdTime and S.SessionIdSeq = V.SessionIdSeq                      
            WHERE V.ToGatewayId IS NOT NULL
        GROUP BY 
            SW.WindowStart
    ) t1
    GROUP BY 
        DATEADD(hour, DATEDIFF(hour, CONVERT(datetime, '19000101', 112), t1.WindowStart), CONVERT(datetime, '19000101', 112))
    ORDER BY 
        DATEADD(hour, DATEDIFF(hour, CONVERT(datetime, '19000101', 112), t1.WindowStart), CONVERT(datetime, '19000101', 112))
    OPTION (maxrecursion 0) 
```

这是我得到的输出

```
日期会议
2012-08-01 00:00:00.000 5
2012-08-01 01:00:00.000 3
2012-08-01 02:00:00.000 2
2012-08-01 03:00:00.000 2
2012-08-01 05:00:00.000 1
2012-08-01 06:00:00.000 2
2012-08-01 07:00:00.000 3
2012-08-01 08:00:00.000 2
2012-08-01 09:00:00.000 2
2012-08-01 10:00:00.000 1

```

在 04:00:00 期间我需要一个 0。我想要完成的是确定在该给定小时内发生了多少并发会话，而不是在一小时的顶部有多少会话。这就是重叠发挥作用的地方。如果在上午 8 点 56 分开始通话并在上午 9 点 26 分结束，则应该在上午 8 点钟至少有 1 个通话，在上午 9 点钟至少有 1 个通话。然后根据一天中每小时的并发会话数，我找到给定日期的 MAX，然后在我的报告中使用它。

这是数据的基本结构：

```
插入@Sessions ( SessionIdSeq, ResponseTime, SessionEndTime ) 值
    (1, '20120901 00:00:00', '20120901 05:59:59' ), -- 单个会话中的几个小时。
    (1, '20120901 01:01:00', '20120901 01:01:30' ), -- 各种重叠...
    (1, '20120901 01:02:00', '20120901 01:03:30' ), -- ... 一个小时内的会话。
    (1, '20120901 00:00:05.077', '20120901 00:04:02.280'),
    (1, '20120901 00:00:14.687', '20120901 00:06:05.947'),
    (1, '20120901 00:00:17.857', '20120901 00:07:34.757'),
    (1, '20120901 00:00:25.843', '20120901 00:07:38.720'),
    (1, '20120901 00:00:29.427', '20120901 00:01:58.180'),
    (1, '20120901 00:00:31.853', '20120901 00:05:10.733'),
    (1, '20120901 00:00:40.693', '20120901 00:00:44.237'),
    (1, '20120901 00:00:58.773', '20120901 00:06:14.667'),
    (1, '20120901 00:00:59.457', '20120901 00:01:01.310'),
    (1, '20120901 00:01:16.390', '20120901 00:11:18.383')

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T23:31:48.883

Okay, lacking a clarification here is some TSQL that computes both: - the total number of sessions active in each hour and - the maximum number of concurrent sessions active in each hour.

**EDIT**: The sample data from the updated question has been used, the output of the last query which shows concurrent sessions now includes the session ids, and a bug in the prior optimization was corrected which *greatly* improves performance.

**NB**: These queries work best when the `SessionId` values vary from row to row. Using a value of `1` for all rows will cause disappointing results. Hence the `IDENTITY` property on the `SessionId` column.

```
-- Parameters.
declare @Start as DateTime = '20120901 00:00:00'
declare @End as DateTime = '20120901 12:00:00'
declare @Interval as Time = '01:00:00.00' -- One hour.
select @Start as [Start], @End as [End], @Interval as [Interval]

-- Sample data.
declare @Sessions as Table ( SessionId Int Identity, SessionStart DateTime, SessionEnd DateTime )
insert into @Sessions ( SessionStart, SessionEnd ) values
  ( '20120901 00:00:00', '20120901 05:59:59' ), -- Several hours in a single session.
  ( '20120901 01:01:00', '20120901 01:01:30' ), -- An assortment of overlapping ... 
  ( '20120901 01:02:00', '20120901 01:03:30' ), -- ... sessions during a single hour. 
  ( '20120901 00:00:05.077', '20120901 00:04:02.280' ),
  ( '20120901 00:00:14.687', '20120901 00:06:05.947' ),
  ( '20120901 00:00:17.857', '20120901 00:07:34.757' ),
  ( '20120901 00:00:25.843', '20120901 00:07:38.720' ),
  ( '20120901 00:00:29.427', '20120901 00:01:58.180' ),
  ( '20120901 00:00:31.853', '20120901 00:05:10.733' ),
  ( '20120901 00:00:40.693', '20120901 00:00:44.237' ),
  ( '20120901 00:00:58.773', '20120901 00:06:14.667' ),
  ( '20120901 00:00:59.457', '20120901 00:01:01.310' ),
  ( '20120901 00:01:16.390', '20120901 00:11:18.383' )
select * from @Sessions 

-- Summary of sessions active at any time during each hour. 
; with SampleWindows as ( 
  select @Start as WindowStart, @Start + @Interval as WindowEnd 
  union all 
  select SW.WindowStart + @Interval, SW.WindowEnd + @Interval 
    from SampleWindows as SW 
    where SW.WindowEnd < @End 
  ) 
  select SW.WindowStart, Count( S.SessionStart ) as [Sessions] 
    from SampleWindows as SW left outer join 
      @Sessions as S on SW.WindowStart <= S.SessionEnd and S.SessionStart < SW.WindowEnd 
    group by SW.WindowStart 

-- Summary of maximum concurrent sessions active during each hour. 
; with SampleWindows as ( 
  select 1 as SampleWindowId, @Start as WindowStart, @Start + @Interval as WindowEnd 
  union all 
  select SW.SampleWindowId + 1, SW.WindowStart + @Interval, SW.WindowEnd + @Interval 
    from SampleWindows as SW 
    where SW.WindowEnd < @End 
  ), 
  ActiveSessionsDuringWindow as ( 
  select SW.SampleWindowId, SW.WindowStart, SW.WindowEnd, S.SessionId, S.SessionStart, S.SessionEnd, 
    -- A "pane" is the more restrictive of the window and the session start/end times. 
    case when SW.WindowStart <= S.SessionStart then S.SessionStart else SW.WindowStart end as PaneStart, 
    case when SW.WindowEnd >= S.SessionEnd then S.SessionEnd else SW.WindowEnd end as PaneEnd
    from SampleWindows as SW left outer join 
      @Sessions as S on SW.WindowStart <= S.SessionEnd and S.SessionStart < SW.WindowEnd 
  ), 
  ConcurrentSearch as ( 
  select SampleWindowId, WindowStart, WindowEnd, SessionId, SessionStart, SessionEnd, PaneStart, PaneEnd, 
    Cast( '|' + Right( Replicate( '0', 3 ) + Cast( SessionId as VarChar(4) ), 4 ) + '|' as VarChar(1024) ) as SessionIds, 
    Cast( case when SessionId is NULL then 0 else 1 end as Int ) as Sessions 
    from ActiveSessionsDuringWindow 
  union all 
  select CS.SampleWindowId, CS.WindowStart, CS.WindowEnd, ASDW.SessionId, CS.SessionStart, CS.SessionEnd, 
    case when CS.PaneStart <= ASDW.PaneStart then ASDW.PaneStart else CS.PaneStart end as PaneStart, 
    case when CS.PaneEnd >= ASDW.PaneEnd then ASDW.PaneEnd else CS.PaneEnd end as PaneEnd, 
    Cast( CS.SessionIds + Right( Replicate( '0', 3 ) + Cast( ASDW.SessionId as VarChar(4) ), 4 ) + '|' as VarChar(1024) ), 
    CS.Sessions + 1 
    from ConcurrentSearch as CS inner join 
      ActiveSessionsDuringWindow as ASDW on ASDW.SampleWindowId = CS.SampleWindowId and 
        -- We haven't visited this session along this path. 
        CS.SessionId < ASDW.SessionId and -- EDIT: Reduce the size of the search tree. 
        CharIndex( '|' + Right( Replicate( '0', 3 ) + Cast( ASDW.SessionId as VarChar(4) ), 4 ) + '|', CS.SessionIds ) = 0 and 
        -- The session's pane overlaps the concurrent search pane. 
        CS.PaneStart <= ASDW.PaneEnd and ASDW.PaneStart <= CS.PaneEnd 
  )
  select WindowStart, Max( Sessions ) as Sessions,
    ( select top 1 SessionIds from ConcurrentSearch where Sessions = Max( CS.Sessions ) ) as SessionIds
    from ConcurrentSearch as CS
    group by WindowStart 
```

Following is a variation on the last query which does not use row id values from the `@Sessions` table. Instead it uses `Row_Number()` to assign suitable values for the duration of the query. This also changes the assumption that the `SessionId` values do not exceed four digits to an assumption that there are not more than 9,999 sessions active within any given hour.

```
-- Summary of maximum concurrent sessions active during each hour.
; with SampleWindows as (  
  select 1 as SampleWindowId, @Start as WindowStart, @Start + @Interval as WindowEnd  
  union all  
  select SW.SampleWindowId + 1, SW.WindowStart + @Interval, SW.WindowEnd + @Interval  
    from SampleWindows as SW  
    where SW.WindowEnd < @End  
  ),  
  ActiveSessionsDuringWindow as (  
  select SW.SampleWindowId, SW.WindowStart, SW.WindowEnd, S.SessionStart, S.SessionEnd,  
    -- A "pane" is the more restrictive of the window and the session start/end times.  
    case when SW.WindowStart <= S.SessionStart then S.SessionStart else SW.WindowStart end as PaneStart,  
    case when SW.WindowEnd >= S.SessionEnd then S.SessionEnd else SW.WindowEnd end as PaneEnd,
    Row_Number() over ( partition by SW.SampleWindowId order by S.SessionStart ) as SampleId
    from SampleWindows as SW left outer join  
      @Sessions as S on SW.WindowStart <= S.SessionEnd and S.SessionStart < SW.WindowEnd  
  ),  
  ConcurrentSearch as (  
  select SampleWindowId, WindowStart, WindowEnd, SampleId, SessionStart, SessionEnd, PaneStart, PaneEnd,  
    Cast( '|' + Right( Replicate( '0', 3 ) + Cast( SampleId as VarChar(4) ), 4 ) + '|' as VarChar(1024) ) as SampleIds,  
    Cast( case when SampleId is NULL then 0 else 1 end as Int ) as Sessions  
    from ActiveSessionsDuringWindow  
  union all  
  select CS.SampleWindowId, CS.WindowStart, CS.WindowEnd, ASDW.SampleId, CS.SessionStart, CS.SessionEnd,  
    case when CS.PaneStart <= ASDW.PaneStart then ASDW.PaneStart else CS.PaneStart end as PaneStart,  
    case when CS.PaneEnd >= ASDW.PaneEnd then ASDW.PaneEnd else CS.PaneEnd end as PaneEnd,  
    Cast( CS.SampleIds + Right( Replicate( '0', 3 ) + Cast( ASDW.SampleId as VarChar(4) ), 4 ) + '|' as VarChar(1024) ),  
    CS.Sessions + 1  
    from ConcurrentSearch as CS inner join  
      ActiveSessionsDuringWindow as ASDW on ASDW.SampleWindowId = CS.SampleWindowId and  
        -- We haven't visited this session along this path.  
        CS.SampleId < ASDW.SampleId and -- EDIT: Reduce the size of the search tree.  
        CharIndex( '|' + Right( Replicate( '0', 3 ) + Cast( ASDW.SampleId as VarChar(4) ), 4 ) + '|', CS.SampleIds ) = 0 and  
        -- The session's pane overlaps the concurrent search pane.  
        CS.PaneStart <= ASDW.PaneEnd and ASDW.PaneStart <= CS.PaneEnd  
  ) 
  select WindowStart, Max( Sessions ) as Sessions
    from ConcurrentSearch as CS 
    group by WindowStart 
```

This should be easy to modify to run against an existing table. A single index on `SessionStart` ascending, `SessionEnd` ascending should improve performance.

# javascript - Brightcove 在 HTML 中获取/显示当前视频标题和描述

> ID：12428878
> 
> 赞同：0
> 
> 时间：2012-09-14T16:57:28.327
> 
> 标签：javascript, brightcove

有人可以帮我如何在 HTML 中获取 Brigtcove 当前的视频标题和描述吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:32:06.390

Brightcove 提供了许多关于如何访问其 API 的示例。您可以直接从他们的示例中获取代码，输入您的读取令牌，使用视频 ID 查询他们的媒体 API，并检索带有标题和描述的对象。从那里，您可以访问对象并输出标题和描述。

这是 Brightcove 的媒体 API 的对象参考。您特别寻找的属性称为“名称”和“longDescription”：http: [//support.brightcove.com/en/docs/javascript-media-api-examples](http://support.brightcove.com/en/docs/javascript-media-api-examples)

我强烈推荐他们的“入门”指南。您可以在此处访问代码示例：http: [//support.brightcove.com/en/docs/getting-started-media-api](http://support.brightcove.com/en/docs/getting-started-media-api)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T10:29:35.177

您可以使用[智能播放器 API](http://support.brightcove.com/en/docs/using-smart-player-api)。[getCurrentVideo()](http://docs.brightcove.com/en/smart-player-api/symbols/brightcove.api.modules.VideoPlayerModule.html#getCurrentVideo)方法返回有关当前加载的视频的信息。

例如

```
videoplayer.getCurrentVideo(function (video) {
  document.getElementById('title').innerHTML = video.displayName;
  document.getElementById('description').innerHTML = video.shortDescription;
}); 
```

# c++ - 来自 QT QWidget 的 X11 小部件

> ID：12428879
> 
> 赞同：1
> 
> 时间：2012-09-14T16:57:31.120
> 
> 标签：c++, linux, qt, x11

是否可以从 QT QWidget 中提取 X11/Xt Widget。我知道 QWidget 上有一个 WinId() 函数，它给了我一个 Window 但我需要一个 Widget 对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:07:24.403

我根本不相信 Qt 使用 Xt 小部件，所以您的问题的答案是否定的。

（`Xt`在目录中找到的源文件中搜索`src/gui/kernel`显示没有命中。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T22:18:04.223

不，Qt/X11 直接使用 X11（好吧，使用 xlib/xcb，没有 Xt）并且没有“X11 小部件”之类的东西。如果你想在你的 Xlib 应用程序中包含 Qt 小部件，你可以使用[Xembed](http://standards.freedesktop.org/xembed-spec/xembed-spec-latest.html)（或者只是重新定义外部 qt 应用程序）

# java - 如何发送、接收和存储对外部方法的引用

> ID：12428881
> 
> 赞同：0
> 
> 时间：2012-09-14T16:57:42.930
> 
> 标签：java, android

在自定义类中，我试图执行通过参数从外部给出的函数。

对我来说重要的是不必存储对父类等的任何引用，只存储要调用的方法/函数。

我尝试发送一个方法作为参数，但它不起作用。

```
class A
    // var to store reference to external method
    private Method myMethodReference;  // (says error: never used)

    // the setter to store the reference to the external method
    public void setMethodReference(Method someMethod)
    {
        myMethodReference = someMethod;
    }

    public boolean someFunctionWithinMyClass()
    {
        // call the external method via my reference
        myMethodReference();  // (says error: The method myMethodReference() is undefined)
    } 
```

* * *

此外，当我尝试从外部类设置对方法的引用时，它不起作用：

```
class B

    public void someFunction() { Log.i("la", "la" };

    instanceOfClassA.setMethodReference(someFunction); // (says error: variable someFunction not found) 
```

* * *

因此，即使传递引用也不起作用，因为 Eclipse 假定 someFunction 是一个不在范围内的变量。

我希望这能更好地解释它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:00:23.500

```
private Method  onClick; 
```

**上面**这行将产生一个错误....

您应该以这种方式创建或声明一个方法...

```
public onClick(){

} 
```

**或者**

`public abstract onClick();`

现在....你`onClick()` **没有实现** `onClick()`就打电话了，**这导致了错误。**

# c - 拼字游戏点计数器

> ID：12428884
> 
> 赞同：1
> 
> 时间：2012-09-14T16:57:49.233
> 
> 标签：c

我正在开发一个生成 7 个字母的拼字游戏程序，然后允许用户输入单词并查看它们是否有效以及点值是多少。一旦我开始做这些价值观，我就开始遇到问题。

我正在像这样调用函数 wordvalue，并希望将结果存储到 value 中。用户词存储在用户词[8]中。

```
int value = wordvalue(userword[8]); 
```

这是我的代码，用于找出数组单元格中的字母，然后添加。我不确定它有什么问题，但在这一步每次都会崩溃。

```
int wordvalue (char userword[8]){

    int m;
    int currentvalue = 0;

    for (m=0; m < 8; m++){

        switch (userword[m]){

        case 'A':
        case 'E':
        case 'I':
        case 'L':
        case 'N':
        case 'O':
        case 'R':
        case 'S':
        case 'T':
        case 'U':
            currentvalue = currentvalue + 1;
            break;
        case 'D':
        case 'G':
            currentvalue = currentvalue + 2;
            break;
        case 'B':
        case 'C':
        case 'M':
        case 'P':
            currentvalue = currentvalue + 3;
            break;
        case 'F':
        case 'H':
        case 'V':
        case 'W':
        case 'Y':
            currentvalue = currentvalue + 4;
            break;
        case 'K':
            currentvalue = currentvalue + 5;
            break;
        case 'J':
        case 'X':
            currentvalue = currentvalue + 8;
            break;
        case 'Q':
        case 'Z':
            currentvalue = currentvalue + 10;
            break;

        }

    }

    //printf("%d", currentvalue);
    return currentvalue;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:59:55.570

```
int value = wordvalue(userword[8]); 
```

这个调用看起来不对。

假设`userword`是一个数组，`char`您正在传递一个预期`char`指向的指针。`char`

你可能想做：

```
int value = wordvalue(userword); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T17:49:09.163

我知道您已经接受了答案，但我想向您展示一种避免写冗长`switch`陈述的方法。

该`values[]`数组包含字母表中每个字母的拼字游戏值。然后该`letterValue()`函数使用字母的 ASCII 值 - 'A' 对`values[]`数组进行索引以获取字母值。`values[0] is for 'A'`和`values[25] is for 'Z'`。

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>

/* prototypes */
int wordvalue (char *userword);
int letterValue( char letter );

int values[] = { 1,3,3,2,1,4,2,4,1,8,5,1,3,1,1,3,10,1,1,1,1,4,4,8,4,10 };

int letterValue( char letter )
{
    return( values[toupper((int)letter) - 'A'] );  
} 

int wordvalue(char *userword)
{
    int m;
    int currentvalue = 0;

    for (m=0; m < strlen(userword); m++)
    {
        currentvalue += letterValue( userword[m]);
    }
    return currentvalue;
}

int main()
{
    char word[] = "Progress";

    printf("Value of %s is %d\n", word, wordvalue(word));
    return( 0 );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T17:17:53.683

如果`userword`是一个已经初始化的字符串，你必须像这样将它传递给你的函数`wordvalue(userword)`：

你所拥有的是`int value = wordvalue(char userword[8])`.

我看到的一个问题是您`userword`在函数参数中声明这是一个由 8 个字符组成的数组。

通过这样做，您实际上是在传递`userword`to的第 8 个元素`wordvalue`。由于您刚刚初始化了这个数组，所以 的值`userword[8]`是未知的，并且您的程序将表现出未定义的行为。

你需要初始化你的数组，并给它赋值：

```
int wordvalue(char *userword);         //function declaration

int main(void)
{
    char userword[8] = "foobarrr";         //declare 8 char array holding an 8 character string
    int value = wordvalue(userword);       //call the function
    printf("%d", value);                   //print function output
    return 0;
}

/*function prototype here*/ 
```

# php - PHP Eclipse 实时文件编辑或 FTP

> ID：12428895
> 
> 赞同：7
> 
> 时间：2012-09-14T16:58:22.200
> 
> 标签：php, eclipse, ftp

我被分配到一个需要编写整个网站的项目。但我想在实时环境中工作。我最喜欢的 IDE 是 PHP Eclipse，我想知道他们是否有任何插件可以在其中编辑任何文件，并且更改将直接上传到实时服务器上？

我想实时工作，在 PHP Eclipse 上真的可以吗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T17:01:51.680

当然，您可以为此使用[远程系统资源管理器](http://help.eclipse.org/galileo/topic/org.eclipse.rse.doc.user/gettingstarted/g1installing.html)。只需安装和浏览远程 FTP 存储库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T17:02:13.580

查看远程系统资源管理器。

它将允许您通过 SSH 编辑文件。我相信您也可以使用 FTP，但出于安全原因，我不推荐使用 FTP。

# .htaccess - htaccess 301 具有更复杂的重定向

> ID：12428900
> 
> 赞同：1
> 
> 时间：2012-09-14T16:58:39.040
> 
> 标签：.htaccess

我有一个客户域，其中有数千个页面正在移动到一个新域。.html 的命名约定已经改变，我知道 htaccess 可以以某种方式处理这个问题。

这是一个例子：

旧网站： http: [//oldsite.com/west-virginia/new-cumberland-wv-index.html](http://oldsite.com/west-virginia/new-cumberland-wv-index.html)

新网站： http: [//newsite.com/west-virginia/computer-support-new-cumberland-wv-index.html](http://newsite.com/west-virginia/computer-support-new-cumberland-wv-index.html)

我还有一些问题，比如 newcumberland 被重命名为 new-cumberland

这超出了我目前的理解。我会很感激一点帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:03:56.687

看起来您可能需要根据具体情况执行此操作，除非您可以找到这些更改的明确模式。重定向本身看起来像这样：

```
RedirectMatch 301 ^/([^/]+)/([^/]+)\.html$ /$1/computer-support-$2.html 
```

第一个`([^/]+)`匹配状态，第二个`([^/]+)`匹配 html 文件的名称。此重定向只是`computer-support-`在 html 文件前面添加一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T04:17:27.603

非常感谢您为我指明了正确的方向！这是最终的实现：

```
Options +FollowSymLinks -MultiViews
RewriteEngine on
RewriteCond %{HTTP_HOST} ^oldsite.com$ [NC]
RewriteRule ^([^/]+)/(computer-repair-in-)(.+)-index\.html$ http://newsite.com/$1/computer-support-$3-index.html [QSA,R=301] 
```

# python - 我不断得到 Nonetype 但我认为我不应该是？

> ID：12428901
> 
> 赞同：0
> 
> 时间：2012-09-14T16:58:55.700
> 
> 标签：python, flask-sqlalchemy

我将 sqlalchemy-flask 用于我的项目以及 json 模块。

我有两个要从中提取数据的课程。

这两种数据类型是 Ints 和 List（我通过使用 type 确定了这一点）。当我尝试将 int 附加到列表时，我得到 None。怎么了？

```
def update_retweet_count(TWEET, TWEET_has_retweet):

    if type(json.loads(TWEET_has_retweet.js_rt)) != list:
        list_of_retweets = list([0])
    else:
        list_of_retweets = list(json.loads(TWEET_has_retweet.js_rt))

    new_rtc = int(TWEET.tmp_rt_count)

    x = list_of_retweets.append(new_rtc)
    print x 
```

当我在 X 上方运行时，没有。

4 小时后，我在下面尝试这个，它有效！

```
def update_retweet_count(TWEET, TWEET_has_retweet):
    if type(json.loads(TWEET_has_retweet.js_rt)) != list:
        list_of_retweets = list([0])
    else:
        list_of_retweets = list(json.loads(TWEET_has_retweet.js_rt))

    lst =[]

    new_rtc = int(TWEET.tmp_rt_count)

    [lst.append(y) for y in list_of_retweets]

    lst.append(new_rtc)

    print lst 
```

为什么第一个代码不起作用？

谢谢！

费尔南多

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:00:22.760

`list.append`总是返回`None`：它改变了列表*。*你做：

```
x = list_of_retweets.append(new_rtc)
print x 
```

在第一个示例中，并且：

```
lst.append(new_rtc)
print lst 
```

在第二个（正确）示例中。

# jquery-ui - jQuery可拖动的div位置

> ID：12428903
> 
> 赞同：-2
> 
> 时间：2012-09-14T16:59:14.723
> 
> 标签：jquery-ui, jquery-ui-draggable

工作样本：http: [//jsfiddle.net/murano55/bSPeC/2/](http://jsfiddle.net/murano55/bSPeC/2/)

为什么第二个 div (2 .BOX) 左侧位置错误？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:08:41.460

[http://jsfiddle.net/bSPeC/10/](http://jsfiddle.net/bSPeC/10/)

不要在事件`ui.position.`内部使用，而是使用`drag``$(this).position().`

您需要自己减去`#container`边框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:10:34.633

你需要你 offset() 而不是 position

[http://jsfiddle.net/bSPeC/14/](http://jsfiddle.net/bSPeC/14/)

# php - Ajax 端点应该如何响应非 ajax 请求？

> ID：12428905
> 
> 赞同：3
> 
> 时间：2012-09-14T16:59:28.867
> 
> 标签：php, ajax, codeigniter, jquery

我正在编写后端以响应 ajax 查询。我正在使用 Codeigniter，我的控制器由一堆这些功能组成。

```
public function name_change()
{
    if($this->input->is_ajax_request())
    {
        //Grab the Inputs
        //Do something
        //Respond
    }
    else
    {

    }           
} 
```

我唯一的问题是我应该如何处理不是 Ajax 请求的情况？没有理由让非 ajax 请求访问这些控制器功能。我能想到的选项是。

*   发送无响应
*   抛出一个错误页面（我假设我会使用状态码 200 或 403）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T17:15:30.323

黄金法则是永远不要相信用户输入

因此，无论数据是否来自 ajax 请求 - 或者只是发送到函数 - 您的控制器都应该假定它已被污染并进行全面验证、用户身份验证等。

因此，如果有人在没有 ajax 请求（有意或无意）的情况下最终到达该控制器并不重要 - 所以如果他们提交的数据是有效的，让它通过。

如果不是 - 只需向客户抛出一个有用的错误消息（特别是如果他们不小心到达那里）。

# model-view-controller - 加载 MVC 站点

> ID：12428910
> 
> 赞同：1
> 
> 时间：2012-09-14T17:00:02.270
> 
> 标签：model-view-controller, publishing

您好，我急需帮助。我刚刚创建了一个在 Visual Web Developer 2010 中制作的 MVC 站点，并且每次在不同的 Web 主机上我都会得到 --Index of /- 而不是正确加载站点。就好像服务器或浏览器正在寻找一个“索引”文件，而不是通过 MVC 文件夹路由到正确的启动页面。我已经完成了我认为我应该做的所有事情，将我所有的 dll '系统' 文件带到'bin' 文件夹以及其他所有内容，包括获取具有 MVC 支持服务器的 Web 主机，但我仍然不断得到'索引/' 和文件夹而不是站点。任何人都可以帮忙吗？我真的在一个地方。我已经在这个网站上工作了几个月，我需要让它运行起来。

谢谢，罗伯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T19:07:25.983

看起来您的默认路线没有设置，或者设置指向一个不存在的地方。您的默认路由将在 default.asax.cs 页面中（MVC4 是 App_Start/RouteConfig.cs），看起来像这样：

```
routes.MapRoute(
        "Default", // Route name
        "",        // URL with parameters
        new { controller = "Home", action = "Index"}  // Parameter defaults
    ); 
```

所以默认操作是 Home/Index。如果您想重定向到不同的默认页面，您可以更改此设置。

# c++ - 对结构数组使用构造函数

> ID：12428911
> 
> 赞同：0
> 
> 时间：2012-09-14T17:00:02.477
> 
> 标签：c++, arrays, constructor, structure

我想创建一个结构数组。该结构使用如下所示的构造函数：

```
struct struct_seedinfo {
    struct_seedinfo(const mxArray *prhs[ ],const int seed_id){  
        mxArray *mat_coords, *mat_defvectorinit, *mat_corrcoef, *mat_roi_id;

        mat_coords = mxGetField(prhs[1],seed_id,"coords");
        coords = mxGetPr(mat_coords);

        mat_defvectorinit = mxGetField(prhs[1],seed_id,"defvectorinit");
        defvectorinit = mxGetPr(mat_defvectorinit);

        mat_corrcoef = mxGetField(prhs[1],seed_id,"corrcoef");
        corrcoef = *(mxGetPr(mat_corrcoef));

        mat_roi_id = mxGetField(prhs[1],seed_id,"roi_id");
        roi_id = *(mxGetPr(mat_roi_id));
    }
    double *coords;
    double *defvectorinit;
    double corrcoef;
    double roi_id;
    static int num_seeds;
}; 
```

如何创建此结构的任意大小的数组？我需要为其分配内存，但似乎我需要在不调用构造函数的情况下分配内存，然后稍后在 forloop 中调用构造函数。有没有一种好的或首选的方法来做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:03:58.063

你可以做到`std::vector<struct_seedinfo>`。这将创建一个数组，并在需要时自动增加大小。

您还需要重载复制构造函数和复制赋值运算符，以便您的结构能够在向量中使用。你也需要一个析构函数。这被称为[C++ 中的三法则](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T17:45:45.897

好吧，由于大小保持不变，您可以使用以下解决方案： *这假设您可以定义默认构造函数。

首先在你的类中声明一个默认构造函数。

```
struct_seedinfo(){
//If you want to initlaize something.
} 
```

比你可以使用以下来创建你的数组：

```
 struct_seedinfo * arr = new struct_seedinfo[size_of_array]; 
```

然后您需要为每个空间进行特定的构建：

```
arr[i] = struct_seedinfo(//arguments); 
```

如果你非常需要一个数组，我也认为向量解决方案更好。

# python - PyQt4：在 QTabWidget 中设置标签栏的大小

> ID：12428917
> 
> 赞同：0
> 
> 时间：2012-09-14T17:00:13.583
> 
> 标签：python, qt, height, pyqt4, tabbar

您将如何更改 QTabWidget 中标签栏的高度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:10:10.727

您应该创建一个自定义`QTabBar`并覆盖其`tabSizeHint`方法。然后将自定义设置`QTabBar`为您`QTabWidget`使用该`QTabWidget.setTabBar`方法的栏。

我认为以下（未经测试的）代码可以帮助您：

```
class TabBar(QTabBar):

   def tabSizeHint(self, index):
       width = QTabBar.tabSizeHint(self, index).width()
       return QSize(width, your_wanted_height) 
```

[您可以在此处](http://www.diotavelli.net/PyQtWiki/Customising%20tab%20bars)找到其他自定义示例。

# ios - UITableView 不会显示浮动部分标题

> ID：12428918
> 
> 赞同：2
> 
> 时间：2012-09-14T17:00:18.077
> 
> 标签：ios, iphone, xcode, uitableview

在我的应用程序中，我遇到了一些奇怪的问题`UITableView`。基本上我的表格视图由两个部分组成，每个部分有 10 行。我无法让它显示带有部分标题的浮动部分标题（例如，“音乐”应用程序显示字母表中每个字母的部分）。我用一些完全相同的单元格填充了 tableView 以对其进行测试，但表格视图不会显示浮动部分标题，这是我唯一可以看到部分标题的地方（顺便说一下“Anno 1”和“Anno 2”是我需要显示的标题）是右边的栏（有没有隐藏这个索引栏？）。

任何人都可以帮助我让表格视图显示部分标题吗？它不应该自动显示它们还是我必须设置任何属性才能获得它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T17:05:33.190

你的餐桌风格“朴素”吗？标题不会浮动在“分组”样式上。只是一个猜测。

还想知道您是使用自定义节标题视图还是仅设置节标题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T01:10:10.487

我刚刚解决了问题！我对数据源方法搞砸了。基本上问题是我认为设置部分标题的方法是：

*   (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView

这个方法是指快速滚动的右栏！用于设置章节标题的正确方法是：

*   (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section

在这里，您返回作为参数传递的特定部分的标题。

此外，如果您不覆盖我列出的第一种方法，tableview 将不会显示快速滚动条，这在我正在处理的情况下可能很有用。

# entity-framework-4.1 - [SqlException（0x80131904）：字符串或二进制数据将被截断抛出

> ID：12428921
> 
> 赞同：1
> 
> 时间：2012-09-14T17:00:24.363
> 
> 标签：entity-framework-4.1

我收到一个非常模糊的错误。我有以下代码：

```
var skey = ev.EntityKey;
var id = skey.EntityKeyValues[0];
int eventid = (int)id.Value; 
```

第二行 var id=skey.EntityKeyValues[0] 抛出以下异常：

[SqlException (0x80131904)：字符串或二进制数据将被截断。该语句已终止。]

麻烦的是，EntityKeyValues[0] 是获取新插入记录的主键值并将其传递给方法的代码。

这是一个字符串，但我不明白为什么它应该特别大。

# matlab - 连续2年绘制数据

> ID：12428923
> 
> 赞同：0
> 
> 时间：2012-09-14T17:00:30.147
> 
> 标签：matlab, plot

我有以下代码用于生成以一年中的日期延长两年的数据图：

```
time = datenum('2008-04-17 02:00'):datenum('2009-11-24 12:27');
dateV = datevec(time);
for i = 1:length(time);
    DOY(i) = time(i) - datenum(dateV(i,1),0,0);
end
data = rand(length(time),1);
plot(time,data);
set(gca,'XTick',floor(time(1:50:end))','XTickLabel',floor(DOY(1:50:end))) 
```

有人可以建议一种方法来确保 xaxis 上的刻度适用于 10 的倍数，即 110、160 等。

添加部分：

```
DateTime=datestr(datenum('2007-01-01 00:00','yyyy-mm-dd HH:MM'):1/24:...
    datenum('2011-12-31 23:00','yyyy-mm-dd HH:MM'),...
    'yyyy-mm-dd HH:MM');
time = datenum(DateTime,'yyyy-mm-dd HH:MM');

dateV = datevec(time);
for i = 1:length(time);
    DOY(i) = time(i) - datenum(dateV(i,1),0,0);
end
data = rand(length(time),1);
plot(time,data);

mydays = ~mod(floor(DOY),40);  %true for days that are multiples of 10
set(gca,'XTick',floor(time(mydays))','XTickLabel',floor(DOY(mydays))) 

Error using set
Values must be monotonically increasing 
```

这可以通过移除地板来解决，即

```
set(gca,'XTick',time(mydays),'XTickLabel',floor(DOY(mydays))) 
```

但它会生成粗体标签，这是为什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T17:53:57.567

`mod`您可以使用该函数生成 N 的倍数的天数索引。此函数返回一个数字除以 N 后的余数。

```
 mydays = ~mod(floor(DOY),10);  %true for days that are multiples of 10
 data = rand(length(time),1);
 plot(time,data);
 set(gca,'XTick',time(mydays),'XTickLabel',floor(DOY(mydays))) 
```

在您的情况下，每个 10 的倍数会导致 x 轴上的标签过多，因此可以尝试 40 的倍数，这会产生以下结果：![图片](../Images/1369fc883b66e41d1c4bc43dbd139b51.png).

最后，如果您想更改轴标签使其不再是粗体，您可以使用：

```
set(gca, 'FontWeight', 'normal'); 
```

或者类似地你可以改变它的大小和字体：

```
set(gca, 'FontSize', 14, 'FontName', 'Calibri') 
```

编辑：更正了先前代码中的错字，并添加了关于更改标签字体的注释

# c# - 从 VTable 调用结构中的非托管函数

> ID：12428926
> 
> 赞同：5
> 
> 时间：2012-09-14T17:00:33.703
> 
> 标签：c#, .net, unmanaged, vtable

是否可以从 C# 调用函数到结构中的非托管函数（通过 VTable）。

例如，我正在挂接一个应用程序，并且我正在为（应用程序的）每个类重新创建结构。

```
public struct SomeStruct {
   [FieldOffset(0x00)]
   public IntPtr * VTable;

   [FieldOffset(0x10)]
   public uint SomeValue;
} 
```

然后，我通常会这样做：

```
var * data = (SomeStruct*)(Address); 
```

我希望通过以下任一方式从结构的 VTable 调用一个函数

```
Invoke<delegate>(data->VTable[0x3C])(delegateArguments) 
```

或者

```
var eax = Invoke<Func<uint,uint>(data->VTable[0x3C])(arg1,arg2) 
```

此外，这是否可以有效地完成（因为这些 vtable 函数可以被多次调用）？

也许通过反射发射？

据我所知，编组必须在我每次调用`Invoke<>`func 时创建委托函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:13:39.510

鉴于虚拟方法表包含指向函数的指针，假设您知道偏移量（看起来确实如此），您可以[`IntPtr`](http://msdn.microsoft.com/en-us/library/system.intptr.aspx)通过调用[Marshal 类](http://msdn.microsoft.com/en-us/library/asx0thw2)上的[`ReadIntPtr`方法](http://msdn.microsoft.com/en-us/library/d0y7w59b)来获取指针值，如下所示：

```
IntPtr ptr = Marshal.ReadIntPtr(data.VTable, 0x3C); 
```

然后你可以调用[类](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.aspx)上的[`GetDelegateForFunctionPointer`方法](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getdelegateforfunctionpointer.aspx)来获取适当类型的委托，如下所示：[`Marshal`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.aspx)

```
// Assuming a signature of f(int, int) returning int
Func<int, int, int> func = (Func<int, int, int>)
    Marshal.GetDelegateForFunctionPointer(ptr, typeof(Func<int, int, int>)); 
```

然后，您可以根据需要调用委托。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T18:35:14.153

好吧，我找到了一个可能的解决方案：

我创建了一个通用 Invoke 方法，该方法创建并缓存所有委托以供将来使用

```
 public void Select(uint target)
        {
            fixed (void* pThis = &this)
            {
                Generic.Invoke<Action<uint, uint>>(this.VTable[0xC0], CallingConvention.ThisCall)
                    ((uint)pThis, target);
            }
        }

        [FieldOffset(0x00)]
        public uint* VTable; 
```

缓存：

```
 public static T Invoke<T>(uint addr, CallingConvention conv) where T : class
        {
          var type = typeof(T);
            if (!cache.Contains(type))
                cache.Set<T>(type, NativeHelper.GetDelegateForFunctionPointer<T>(addr, conv));

            return cache.Get<T>(type);
        } 
```

以及创建函数的函数（适用于通用 Func/Action）

```
public static T GetDelegateForFunctionPointer<T>(uint ptr, CallingConvention conv)
        where T : class
        {

            var delegateType = typeof(T);
            var method = delegateType.GetMethod("Invoke");
            var returnType = method.ReturnType;
            var paramTypes =
                method
                .GetParameters()
                .Select((x) => x.ParameterType)
                .ToArray();
            var invoke = new DynamicMethod("Invoke", returnType, paramTypes, typeof(Delegate));
            var il = invoke.GetILGenerator();
            for (int i = 0; i < paramTypes.Length; i++)
                il.Emit(OpCodes.Ldarg, i);
                il.Emit(OpCodes.Ldc_I4, ptr);

            il.EmitCalli(OpCodes.Calli, conv, returnType, paramTypes);
            il.Emit(OpCodes.Ret);
            return invoke.CreateDelegate(delegateType) as T;
        } 
```

# apache-poi - Excel biff5 到 biff8 的转换

> ID：12428931
> 
> 赞同：5
> 
> 时间：2012-09-14T17:00:54.143
> 
> 标签：apache-poi, xls

我的系统使用 Apache-POI 来管理一些 xls 文件。现在我有近 300 个 xls 文件，但它们似乎是旧格式，所以我得到了这个例外：

> 提供的电子表格似乎是 Excel 5.0/7.0 (BIFF5) 格式。POI 仅支持 BIFF8 格式（来自 Excel 版本 97/2000/XP/2003）

有没有办法处理或自动将所有这些文件转换为 biff8 格式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-31T08:46:25.340

将其转换为 OOXLS 格式，POI 支持 BIFF8 和更新的 OOXLS。下载官方微软转换器包：

[http://www.microsoft.com/en-us/download/details.aspx?id=3](http://www.microsoft.com/en-us/download/details.aspx?id=3)

通过运行转换文件`excelcnv.exe -oice <input file> <output file>`。您可以尝试直接从您的代码作为外部程序运行它，或者创建一些批处理文件。社交 msdn 上的**mrdivo**有一个很好的[解释](http://social.msdn.microsoft.com/Forums/office/en-US/8becabda-0014-4e06-8354-5f576bf46595/convert-bulk-using-ofcexe "这里")。

**编辑**

自 2018 年 6 月 21 日起，上述从 microsoft.com 下载的内容不再可用。但是，`excelcnv.exe`它是某些 Microsoft Office 安装的标准部分。已确认与 Office 2014 和 Office 2016 以及可能的其他版本一起部署。可以在以下位置找到：

```
C:\Program Files (x86)\Microsoft Office\root\Office16` (or `Office14`). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T15:26:08.803

似乎 apache-POI 无法处理 BIFF5 格式。

您应该尝试改用 Java Excel API：http: [//jexcelapi.sourceforge.net/](http://jexcelapi.sourceforge.net/)

# c++ - Negamax 实现似乎不适用于井字游戏

> ID：12428932
> 
> 赞同：3
> 
> 时间：2012-09-14T17:00:56.813
> 
> 标签：c++, algorithm, tic-tac-toe, minimax

我已经实现了 Negamax，因为它可以在[wikipedia](http://en.wikipedia.org/wiki/Negamax)上找到，其中包括 alpha/beta 修剪。

然而，它似乎有利于失败的举动，据我所知，这是一个无效的结果。

游戏是井字游戏，我已经抽象了大部分游戏玩法，因此应该很容易在算法中发现错误。

```
#include <list>
#include <climits>
#include <iostream>

//#define DEBUG 1

using namespace std;

struct Move {
    int row, col;

    Move(int row, int col) : row(row), col(col) { }
    Move(const Move& m) { row = m.row; col = m.col; }
};

struct Board {
    char player;
    char opponent;
    char board[3][3];

    Board() { }

    void read(istream& stream) {
        stream >> player;
        opponent = player == 'X' ? 'O' : 'X';

        for(int row = 0; row < 3; row++) {
            for(int col = 0; col < 3; col++) {
                char playa;

                stream >> playa;
                board[row][col] = playa == '_' ? 0 : playa == player ? 1 : -1;
            }
        }
    }

    void print(ostream& stream) {
        for(int row = 0; row < 3; row++) {
            for(int col = 0; col < 3; col++) {
                switch(board[row][col]) {
                    case -1:
                        stream << opponent;
                        break;

                    case 0:
                        stream << '_';
                        break;

                    case 1:
                        stream << player;
                        break;

                }
            }
            stream << endl;
        }
    }

    void do_move(const Move& move, int player) {
        board[move.row][move.col] = player;
    }

    void undo_move(const Move& move) {
        board[move.row][move.col] = 0;
    }

    bool isWon() {
        if (board[0][0] != 0) {
            if (board[0][0] == board[0][1] &&
                    board[0][1] == board[0][2])
                return true;

            if (board[0][0] == board[1][0] &&
                    board[1][0] == board[2][0])
                return true;
        }

        if (board[2][2] != 0) {
            if (board[2][0] == board[2][1] &&
                    board[2][1] == board[2][2])
                return true;

            if (board[0][2] == board[1][2] &&
                    board[1][2] == board[2][2])
                return true;
        }

        if (board[1][1] != 0) {
            if (board[0][1] == board[1][1] &&
                    board[1][1] == board[2][1])
                return true;

            if (board[1][0] == board[1][1] &&
                    board[1][1] == board[1][2])
                return true;

            if (board[0][0] == board[1][1] &&
                    board[1][1] == board[2][2])
                return true;

            if (board[0][2] == board [1][1] &&
                    board[1][1] == board[2][0])
                return true;
        }

        return false;
    }

    list<Move> getMoves() {
        list<Move> moveList;

        for(int row = 0; row < 3; row++)
            for(int col = 0; col < 3; col++)
                if (board[row][col] == 0)
                    moveList.push_back(Move(row, col));

        return moveList;
    }
};

ostream& operator<< (ostream& stream, Board& board) {
    board.print(stream);
    return stream;
}

istream& operator>> (istream& stream, Board& board) {
    board.read(stream);
    return stream;
}

int evaluate(Board& board) {
    int score = board.isWon() ? 100 : 0;

    for(int row = 0; row < 3; row++)
        for(int col = 0; col < 3; col++)
            if (board.board[row][col] == 0)
                score += 1;

    return score;
}

int negamax(Board& board, int depth, int player, int alpha, int beta) {
    if (board.isWon() || depth <= 0) {
#if DEBUG > 1
        cout << "Found winner board at depth " << depth << endl;
        cout << board << endl;
#endif
        return player * evaluate(board);
    }

    list<Move> allMoves = board.getMoves();

    if (allMoves.size() == 0)
        return player * evaluate(board);

    for(list<Move>::iterator it = allMoves.begin(); it != allMoves.end(); it++) {
        board.do_move(*it, -player);
        int val = -negamax(board, depth - 1, -player, -beta, -alpha);
        board.undo_move(*it);

        if (val >= beta)
            return val;

        if (val > alpha)
            alpha = val;
    }

    return alpha;
}

void nextMove(Board& board) {
    list<Move> allMoves = board.getMoves();
    Move* bestMove = NULL;
    int bestScore = INT_MIN;

    for(list<Move>::iterator it = allMoves.begin(); it != allMoves.end(); it++) {
        board.do_move(*it, 1);
        int score = -negamax(board, 100, 1, INT_MIN + 1, INT_MAX);
        board.undo_move(*it);

#if DEBUG
        cout << it->row << ' ' << it->col << " = " << score << endl;
#endif

        if (score > bestScore) {
            bestMove = &*it;
            bestScore = score;
        }
    }

    if (!bestMove)
        return;

    cout << bestMove->row << ' ' << bestMove->col << endl;

#if DEBUG
    board.do_move(*bestMove, 1);
    cout << board;
#endif

}

int main() {
    Board board;

    cin >> board;
#if DEBUG
    cout << "Starting board:" << endl;
    cout << board;
#endif

    nextMove(board);
    return 0;
} 
```

给出这个输入：

```
O
X__
___
___ 
```

算法选择将棋子放置在 0、1 处，造成一定的损失，对这个陷阱执行此操作（没有任何事情可以赢得或以平局告终）：

```
XO_
X__
___ 
```

我很确定游戏实现是正确的，但算法也应该是正确的。

**编辑：**更新`evaluate`和`nextMove`.

**EDIT2：**修复了第一个问题，但似乎仍然存在错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:52:36.940

您的`evaluate`函数计算空位，并且不识别获胜板。

**编辑：**
还有一个相对较小的问题`nextMove`。该行应该是

```
int score = -negamax(board, 0, -1, INT_MIN + 1, INT_MAX); 
```

修复它（和`evaluate`），代码选择正确的移动。

**编辑：**

这修复了它：

```
if (board.isWon() || depth <= 0) {
#if DEBUG > 1
  cout << "Found winner board at depth " << depth << endl;
  cout << board << endl;
#endif
  return -100;                                                      
} 
```

几乎所有这些问题都源于对`score`. 是从的角度来看的`player`。如果`negamax`正在评估玩家1的位置，而玩家1无法获胜，则分数应该较低（例如-100）；如果`negamax`正在评估玩家-1的位置，而玩家-1无法获胜，则分数应该较低（例如-100）。如果`evaluate()`不能区分玩家，那么返回一个分数`player * evaluate(board)`是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:31:21.043

使用播放器似乎有些有趣。

您的顶层循环调用“board.do_move(*it, 1);” 然后用 player=1 调用 negamax。

然后 negamax 将调用“board.do_move(*it, player);”，所以看起来第一个玩家有效地得到了 2 个动作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T17:52:43.603

`isWon`对于玩家的胜利或失败返回 true。那是帮不上忙的。

# android - 何时使用 Google“应用程序许可”？

> ID：12428934
> 
> 赞同：1
> 
> 时间：2012-09-14T17:01:01.893
> 
> 标签：android, google-play

我们什么时候应该使用 Google Play 的服务 Application Licensing？

这是针对 Android 上破解应用程序的新机制吗？

我应该什么时候推荐我的客户使用这项服务？我已阅读[教程](http://developer.android.com/guide/google/play/licensing/index.html)，但它没有回答我的疑问。

我一开始以为这只是多媒体销售应用程序的一种机制，但现在我发现我错了。

如果有人使用过这项服务，请告诉我你为什么使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T19:36:06.227

> 我们什么时候应该使用 Google Play 的服务 Application Licensing？

当您有一个您担心会被盗版、未经您许可出售/修改的应用程序时。

> 这是针对 Android 上破解应用程序的新机制吗？

这个系统本身已经被破解了。应用程序许可使用[LVL](http://developer.android.com/guide/google/play/licensing/overview.html)库。[AntiLVL](http://androidcracking.blogspot.com/p/antilvl_01.html)可以破解它。

除了您[自己的身份验证方法](http://developer.android.com/guide/google/play/licensing/adding-licensing.html)（Cntrl+F 用于“自定义策略指南”）之外，最好实现此功能。

# css - 如何去除边距

> ID：12428939
> 
> 赞同：1
> 
> 时间：2012-09-14T17:01:42.130
> 
> 标签：css, jsf, primefaces

`<p:layoutUnit>`是否可以在我下面提到的代码中删除所有四个边的所有边距？

```
 <p:layout style="max-width: 80%;height: 700px" fullPage="false">
            <p:layoutUnit position="north" size="100" style="border: 0px">
                <div align="right">
                    <p:selectOneMenu id="city">  
                        <f:selectItem itemLabel="Select City" itemValue="" />  />  
                    </p:selectOneMenu>                                             
                </div>
                <h:graphicImage alt="DiscountBox.in" value="/images/discountbox_logo.jpg" /> 
            </p:layoutUnit>

            <p:layoutUnit position="west" size="20%" style="border: 0px">
                <p:panel header="Categories">  
                    <p:menu style="border: 0px">
                        <p:submenu>
                            <p:menuitem value="Demo" url="http://www.primefaces.org/showcase-labs/ui/home.jsf" />
                            <p:separator />
                            <p:menuitem value="Documentation" url="http://www.primefaces.org/documentation.html" />
                            <p:separator />
                            <p:menuitem value="Forum" url="http://forum.primefaces.org/" />
                            <p:separator />
                            <p:menuitem value="Themes" url="http://www.primefaces.org/themes.html" />
                        </p:submenu>                          
                    </p:menu>                        
                </p:panel>
            </p:layoutUnit>

            <p:layoutUnit position="center" style="border: 0px">
                <p:panel header="Search">  
                </p:panel>  
                <p:panel header="Search">  
                </p:panel>                      
            </p:layoutUnit>

            <p:layoutUnit position="south" size="100" style="border: 0px">
                Footer
            </p:layoutUnit>                
        </p:layout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T04:06:35.167

把这个放在你的页面上：

```
<head>
    <style type="text/css">
        .ui-layout, .ui-layout-doc, .ui-layout-unit, .ui-layout-wrap, .ui-layout-bd, .ui-layout-hd{
             border: none;
        }
    </style>
</head> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-27T00:16:20.157

`p:layoutunit`被调用中有一个属性`gutter`

```
<p:layoutUnit position="north" size="80" gutter="0"> 
```

# objective-c - 在 UITextView 中显示图像

> ID：12428945
> 
> 赞同：2
> 
> 时间：2012-09-14T17:02:05.750
> 
> 标签：objective-c, ios, uitextview

我有一个静态屏幕，我想显示文本内容，包括 UITextView 中的图像，但是当我拖动 ImageView 时，它位于 TextView 的顶部，我想要 textview 中的图像，以防我想一起滚动它。提前致谢.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T17:12:41.767

`UITextView`用于显示文本内容。如果您想将文本与图像混合使用，最常见的解决方案是使用[`UIWebView`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html), 预定义一个简单的 HTML 模板，然后将文本和图像引用插入到模板中。

这是一个解释如何使用'方法的答案的[链接](https://stackoverflow.com/a/1926975/335858)。`UIWebView``loadHTMLString:`

# c# - 如何将查询字符串转换为 json 字符串？

> ID：12428947
> 
> 赞同：16
> 
> 时间：2012-09-14T17:02:13.847
> 
> 标签：c#, .net, json

使用服务器端 C#，如何将查询字符串转换为键和值的 JSON 字符串？例如，我想转换

```
"ID=951357852456&FNAME=Jaime&LNAME=Lopez" 
```

到

```
{ "ID":"951357852456" , "FNAME":"Jaime" , "LNAME":"Lopez" } 
```

我知道如何手动解析和格式化，但是在开始这条路之前，我想我会问，因为可能有一个库做得更好。谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-14T17:11:34.930

这给出了你想要的完全相同的 json

```
var dict = HttpUtility.ParseQueryString("ID=951357852456&FNAME=Jaime&LNAME=Lopez");
var json = new JavaScriptSerializer().Serialize(
                    dict.AllKeys.ToDictionary(k => k, k => dict[k])
           ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-09-29T09:50:31.633

也可以使用

```
var collection = HttpUtility.ParseQueryString(query);
Newtonsoft.Json.JsonConvert.SerializeObject(collection.AllKeys.ToDictionary(y => y, y => collection[y])); 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-14T17:07:16.797

您可以使用 jQuery 来执行此操作：[jQuery.Param](http://api.jquery.com/jQuery.param/)。

# .net - 从目录中读取文件然后读取同一文件的特定行c#

> ID：12428950
> 
> 赞同：-3
> 
> 时间：2012-09-14T17:02:31.460
> 
> 标签：.net

我的问题是我正在读取一个目录然后我按名称过滤文件，但在这个目录中还有其他名称不同的文件，我想要做的是输入这个不同名称的文件并读取第 6 行，如果此行与其他同名文件的名称匹配，则将此文件保存到数组中以供以后处理。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T19:01:28.233

这应该是阅读特定行的最简单方法。

```
string dir = "C:\\\\someFile.txt";
int LineNo = 1; //Pick a line
string ChosenLine = File.ReadAllLines(dir)[lineNo]; 
```

如果要对文件夹中的每个文件执行此操作，请使用 for 或 foreach。

```
void someMethod()
{
    string folderToScan = "C:\\\\someFolder\\";
    foreach(string dir in Directory.GetDirectories(folderToScan).ToList())
    {
        if(isExtention(dir,".txt"))
        {
            int LineNo = 1; //Pick a line
            string ChosenLine = File.ReadAllLines(dir)[lineNo];
        }
    }
}

bool isExtention(string f, string extention)
{
    return f != null && f.EndsWith(extention, StringComparison.Ordinal);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:12:08.693

尝试这个：

```
String dir = @"C:\Temp";
String pattern = "*.txt";
var foundFiles = new List<String>();

foreach (String filePath in Directory.EnumerateFiles(dir, pattern))
{
    foreach (String filePath2 in Directory.EnumerateFiles(dir, pattern))
    {
         if (filePath != filePath2 &&
             File.ReadLines(filePath2).ElementAtOrDefault(5) == Path.GetFileName(filePath))
             foundFiles.Add(filePath);
    }
} 
```

注意：完全未经测试并且没有 IDE 编写，但无论如何它可能会有所帮助。

# java - JPA Criteria Query distinct

> ID：12428955
> 
> 赞同：28
> 
> 时间：2012-09-14T17:03:10.350
> 
> 标签：java, jpa, criteria-api

我正在尝试编写一个不同的条件查询，使用：

```
CriteriaBuilder builder = em.getCriteriaBuilder();
CriteriaQuery<RuleVar> query = builder.createQuery(RuleVar.class);
Root<RuleVar> ruleVariableRoot = query.from(RuleVar.class);
query.select(ruleVariableRoot.get("foo").<String>get("foo")).distinct(true); 
```

基于 CriteriaQuery.select() 的 javadoc 中的示例

```
CriteriaQuery<String> q = cb.createQuery(String.class);
 Root<Order> order = q.from(Order.class);
 q.select(order.get("shippingAddress").<String>get("state")); 
```

但是，这给了我一个错误：

```
The method select(Selection<? extends RuleVar>) in the type CriteriaQuery<RuleVar> is not applicable for the arguments (Path<String>) 
```

有人可以指出我做错了什么吗？或者如何从路径中获取选择对象？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-09-14T17:23:07.593

我知道了。问题是我的 CriteraQuery 需要是字符串类型。这有效：

```
CriteriaBuilder builder = em.getCriteriaBuilder();
CriteriaQuery<String> query = builder.createQuery(String.class);
Root<RuleVar> ruleVariableRoot = query.from(RuleVar.class);
query.select(ruleVariableRoot.get(RuleVar_.varType)).distinct(true); 
```

# php - 如何使用 php 和 mysql 存储多个列表？

> ID：12428960
> 
> 赞同：-1
> 
> 时间：2012-09-14T17:03:40.400
> 
> 标签：php, mysql, list, database-design

我想允许用户创建多个列表，无论是他们最喜欢的项目还是其他什么，到目前为止，这就是我想出的。

我有四张桌子

表 1 保存用户 ID 和信息

表 2 保存项目 ID 和信息

表 3 保存列表 ID 和信息

表三将举行

user_id，list_id，item_id

所以基本上我有两个问题，1.这是理想的表设置吗？

2.如何从用户创建的列表中插入每个项目，foreach 会这样做吗？或者有没有办法mysql允许多次插入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:07:26.777

3张桌子怎么样：

表 1 - 用户 ID 和信息

表 2 - 项目 ID 和信息、用户 ID

表3-list id和info，item id（考虑到item id是用来引用这个表的）

多个插入示例：

```
INSERT INTO USERS
  (user_id, fname, lname)
VALUES
  (100, 'First Name 1', 'Last Name 1'),
  (101, 'First Name 2', 'Last Name 2'),
  (102, 'First Name 3', 'Last Name 3'); 
```

# android - 有人可以访问有根手机上的私人目录吗？

> ID：12428962
> 
> 赞同：0
> 
> 时间：2012-09-14T17:03:44.467
> 
> 标签：android, private, rooted-device

有人可以访问系统私有目录中我的应用商店的数据库文件和/或其他文件吗？

我认为这可以在有根手机上完成，但我不确定。

我试图弄清楚将一些敏感数据存储到数据库中以及将其他一些文件存储在私有目录中的安全性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:09:15.533

是的。任何拥有根设备的人都可以访问任何应用程序的内部存储。甚至其他第三方应用程序也可以访问它，因此用户不是唯一的威胁。可能的解决方案是使用加密和预定义的密钥对值系统。例如，如果您的应用程序具有应用程序货币，则不是存储原始货币数字，而是存储基于等式的数字。就像`number = ((currency *2)+1)/10`数字是你存储在存储中的一样，货币是用户的货币。那样的话，除非有人知道你的应用程序的内部算法，否则他们不能轻易地修改它以使其受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:12:07.093

一些应用程序可以，但用户应该明确地给他们root preveleges。

# c# - NHibernate - MYSQL - 远程数据库服务器连接字符串问题

> ID：12428967
> 
> 赞同：-1
> 
> 时间：2012-09-14T17:03:55.770
> 
> 标签：c#, mysql, nhibernate

我有一个 C#.Net windows 应用程序。

MYSQL 安装在服务器上的位置说 11.90.109.19

而 C#.Net windows 应用程序正在另一台计算机上运行。

我正在使用 Spring.Net 和 NHibernate

使用 Spring.Net 文件配置的 Nhibernate 连接字符串

```
<db:provider id="DbProvider" provider="SqlServer-2.0"
    connectionString="Server=tcp:(local),3306;Database=vault14092012;Trusted_Connection=False;User ID=root;Password=root"/> 
```

但是是给出以下错误

![在此处输入图像描述](../Images/731a482c664735064beec6789255b701.png)

需要紧急帮助。下面的连接字符串工作正常

```
<db:provider id="DbProvider"
                   provider="SqlServer-2.0"
                   connectionString="server=localhost;Database=vault14092012;User ID=root;Password=root"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:22:31.477

这不是 NHibernate 例外。似乎您的连接字符串中有不受支持的关键字。您应该粘贴整个错误消息而不是屏幕截图。

从前几个可见字母（tr）来看，我会说问题是`Trusted_Connection=false`部分原因。看起来MySQL不支持它。

在这里您可以找到有关 MySQL 连接字符串的更多信息：[http ://connectionstrings.com/mysql](http://connectionstrings.com/mysql)

您是否尝试过这样的事情：

```
<db:provider 
    id="DbProvider"
    provider="SqlServer-2.0"
    connectionString="server=11.90.109.19;Port=3306;Database=vault14092012;User ID=root;Password=root"/> 
```

# css - 防止 JavaScript 更改页面样式

> ID：12428979
> 
> 赞同：1
> 
> 时间：2012-09-14T17:04:41.893
> 
> 标签：css, dojo, media

我是使用 javascript 和 CSS 媒体查询的新手，想知道这里是否可行。

我有一个网页，上面有一个脚本。我有一个使用媒体查询的 CSS 文件。当媒体查询 css 正在运行时，我不希望脚本能够更改 css。我希望脚本仍然可以工作，因为它正在填充菜单。我只是不希望它改变位置或背景颜色或任何其他样式。有没有办法禁止脚本从 css 文件或 html 文件更改 css？（我不想编辑脚本）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:17:04.890

不可能的。JavaScript 可以在页面加载后更改页面上的任何内容。不过，您可以禁用 JavaScript。=))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T12:17:48.743

您可以考虑使用[`matchMedia`](http://msdn.microsoft.com/en-us/library/windows/apps/hh453838.aspx)来确定当前正在使用的媒体查询。如果特定的媒体查询有效，您只需跳过 JavaScript 说明。否则，您将像往常一样继续修改 UI。

使用 matchMedia，您还可以订阅媒体查询更改，以便从您的 JavaScript 中做出适当的响应。考虑在 MDN 上查看[使用来自代码的媒体查询。](https://developer.mozilla.org/en-US/docs/DOM/Using_media_queries_from_code)

这个选项主要在[最新的浏览器](http://caniuse.com/matchmedia)中可用，但你也可以为旧的浏览器[填充它。](https://github.com/paulirish/matchMedia.js/)

# c#-4.0 - DirectorySearcher.Filter 查询活动目录以返回本周即将发生的事件

> ID：12428980
> 
> 赞同：0
> 
> 时间：2012-09-14T17:04:47.557
> 
> 标签：c#-4.0, sharepoint-2010, ldap, ldap-query

我正在尝试获取所有属于本周的生日和纪念日。我正在使用`Directory Searcher`和`LDAP`。我是新手`LDAP`，我正在使用以下代码：

```
 string _path = "LDAP:";
            System.DirectoryServices.DirectoryEntry entry = new System.DirectoryServices.DirectoryEntry(_path);
            DirectorySearcher ds = new DirectorySearcher(entry);

            string month = DateTime.Now.Month.ToString();

            string day = DateTime.Today.Day + numDays.ToString();

             ds.Filter = "(&(objectClass=user)(description=" + month + "\\" + day +"))";
             SortOption option = new SortOption("description", System.DirectoryServices.SortDirection.Ascending);
             ds.Sort = option;
             DataSet dSet = new DataSet();
             DataTable dTable = new DataTable("Events");
             dTable.Columns.Add("birthday");
             foreach (System.DirectoryServices.SearchResult resEvent in ds.FindAll())
             {
                 System.DirectoryServices.DirectoryEntry de1 = resEvent.GetDirectoryEntry();
                 DataRow dRow = dTable.NewRow();
                 if (de1.Properties["description"].Value != null)
                 {
                     dRow["birthday"] = de1.Properties["description"].Value.ToString();

                     dTable.Rows.Add(dRow);

                 }
             }

             dSet.Tables.Add(dTable);
             return dSet; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T00:13:35.083

您的事件是否存储在用户的描述属性下？

没有太多关于您的属性值的详细信息。

您正在尝试使用我无权访问的用户 c#，但是通过 LDAP 查询，这有效： (&(objectClass=user)(description=09/15*))

-吉姆

# iphone - Xcode 如何将 UITableView 单元链接到新的视图控制器

> ID：12428983
> 
> 赞同：4
> 
> 时间：2012-09-14T17:04:52.563
> 
> 标签：iphone, xcode, xcode4, uitableview

我目前已经开发了一个基于选项卡的应用程序。第一个选项卡是在 TableView 结构中显示颜色样本或图像的装饰。当前，当您推送图像或颜色样本时，会弹出一个警报，说明您推送了哪个表格单元格。相反，我想将每个表格单元格图像或颜色样本链接到一个新的视图控制器，以显示该图像或颜色样本的更大图像。模态也可以

![在此处输入图像描述](../Images/c3056aa8d49dfc7dfed567926d67f9d0.png)

![在此处输入图像描述](../Images/723e3fd1d3a04e8a38a67349046d522e.png)

```
#import "TableViewsViewController.h"

@implementation TableViewsViewController

#pragma mark -
#pragma mark Synthesizers

@synthesize table;
@synthesize sitesArray;
@synthesize imagesArray;

#pragma mark -
#pragma mark View lifecycle

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {

// Load up the sitesArray with a dummy array : sites
NSArray *sites = [[NSArray alloc] initWithObjects:@"a", @"b", @"c", @"d", @"e", @"f", @"g", @"h", nil];
self.sitesArray = sites;
[sites release];

UIImage *active = [UIImage imageNamed:@"a.png"];
UIImage *ae = [UIImage imageNamed:@"b.png"];
UIImage *audio = [UIImage imageNamed:@"c.png"];
UIImage *mobile = [UIImage imageNamed:@"d.png"];
UIImage *net = [UIImage imageNamed:@"e.png"];
UIImage *photo = [UIImage imageNamed:@"f.png"];
UIImage *psd = [UIImage imageNamed:@"g.png"];
UIImage *vector = [UIImage imageNamed:@"h.png"];

NSArray *images = [[NSArray alloc] initWithObjects: active, ae, audio, mobile, net, photo, psd, vector, nil];
self.imagesArray = images;
[images release];

[super viewDidLoad];
}

#pragma mark -
#pragma mark Table View datasource methods

// Required Methods

// Return the number of rows in a section
-(NSInteger) tableView:(UITableView *)table numberOfRowsInSection:(NSInteger)section
{
return [sitesArray count];
}

// Returns cell to render for each row
-(UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"CellIdentifier";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];
}

// Configure cell

NSUInteger row = [indexPath row];

// Sets the text for the cell
//cell.textLabel.text = [sitesArray objectAtIndex:row];

// Sets the imageview for the cell
cell.imageView.image = [imagesArray objectAtIndex:row];

// Sets the accessory for the cell
cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

// Sets the detailtext for the cell (subtitle)
//cell.detailTextLabel.text = [NSString stringWithFormat:@"This is row: %i", row + 1];

return cell;
}

// Optional

// Returns the number of section in a table view
-(NSInteger) numberOfSectionsInTableView:(UITableView *)tableView
{
return 1;
}

#pragma mark -
#pragma mark Table View delegate methods

// Return the height for each cell
-(CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
return 78;
}

// Sets the title for header in the tableview
-(NSString *) tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
return @"Decors";
}

// Sets the title for footer
-(NSString *) tableView:(UITableView *)tableView titleForFooterInSection:(NSInteger)section
{
return @"Decors";
}

// Sets the indentation for rows
-(NSInteger) tableView:(UITableView *)tableView indentationLevelForRowAtIndexPath:(NSIndexPath *)indexPath
 {
return 0;
}

// This method is run when the user taps the row in the tableview
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Tapped row!" 
                                          message:[NSString stringWithFormat:@"You tapped: %@", [sitesArray objectAtIndex:indexPath.row]]
                                          delegate:nil 
                                          cancelButtonTitle:@"Yes, I did!" 
                                          otherButtonTitles:nil];
[alert show];
[alert release];
[tableView deselectRowAtIndexPath:indexPath animated:YES];
}

#pragma mark -
#pragma mark Memory management

- (void)didReceiveMemoryWarning {
NSLog(@"Memory Warning!");
[super didReceiveMemoryWarning];
}

- (void)viewDidUnload {
self.table = nil;
self.sitesArray = nil;
self.imagesArray = nil;
[super viewDidUnload];
}

- (void)dealloc {
[table release];
[sitesArray release];
[imagesArray release];
[super dealloc];
}

@end 
```

警报所在的部分

```
// This method is run when the user taps the row in the tableview
-(void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Tapped row!" 
                                          message:[NSString stringWithFormat:@"You tapped: %@", [sitesArray objectAtIndex:indexPath.row]]
                                          delegate:nil 
                                          cancelButtonTitle:@"Yes, I did!" 
                                          otherButtonTitles:nil];
[alert show];
[alert release];
[tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T17:14:56.910

在`didSelectRowAtIndexPath`你可以只初始化另一个视图控制器并呈现。如果您愿意，您可以展示它，`self.navigationController`以便有一个后退按钮。在这里，我以模态方式展示它：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // Deselect row
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

    // Declare the view controller
    UIViewController *anotherVC = nil;

    // Determine the row/section on the tapped cell
    switch (indexPath.section) {
        case 0:
            switch (indexPath.row) {
                case 0: {
                    // initialize and allocate a specific view controller for section 0 row 0
                    anotherVC = [[ViewControllerForRowZeroSectionZero alloc] init];
                    break;
                }
                case 1: {
                    // initialize and allocate a specific view controller for section 0 row 1
                    anotherVC = [[ViewControllerForRowOneSectionZero alloc] init];
                    break;
                }
            }
            break;
        case 1: {
            // initialize and allocate a specific view controller for section 1 ALL rows
            anotherVC = [[ViewControllerForAllRowsSectionOne alloc] init];
            break;
        }
    }

    // Get cell textLabel string to use in new view controller title
    NSString *cellTitleText = [[[tableView cellForRowAtIndexPath:indexPath] textLabel] text];

    // Get object at the tapped cell index from table data source array to display in title
    id tappedObj = [sitesArray objectAtIndex:indexPath.row];

    // Set title indicating what row/section was tapped
    [anotherVC setTitle:[NSString stringWithFormat:@"You tapped section: %d - row: %d - Cell Text: %@ - Sites: %@", indexPath.section, indexPath.row, cellTitleText, tappedObj]];

    // present it modally (not necessary, but sometimes looks better then pushing it onto the stack - depending on your App)
    [anotherVC setModalPresentationStyle:UIModalPresentationFormSheet];

    // Have the transition do a horizontal flip - my personal fav
    [anotherVC setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];

    // The method `presentModalViewController:animated:` is depreciated in iOS 6 so use `presentViewController:animated:completion:` instead.
    [self.navigationController presentViewController:anotherVC animated:YES completion:NULL];

    // We are done with the view controller.  It is retained by self.navigationController so we can release it (if not using ARC)
    [anotherVC release], anotherVC = nil;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:10:42.200

你已经成功了 90%！在`didSelectRowAtIndexPath`中，而不是发出警报，而是实例化并设置要显示和调用其视图的视图控制器`presentViewController:animated:`。

看我的书：[http ://www.aeth.com/iOSBook/ch19.html#_presented_view_controller](http://www.apeth.com/iOSBook/ch19.html#_presented_view_controller)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T18:26:01.890

你在使用故事板吗？如果是这样，您可以构建一个 segue，将其设置为 Modal 或 Push。从 TableView 指向目标 ViewController 然后在 segue 的检查器中用标识符命名它。然后在 didSelectRowAtIndexPath 中，调用 performSegue: withIdentifier 你还可以根据在 prepareForSegue 中选择的单元格设置目标 ViewController。

希望能帮助到你。

# c# - DISTINCT() 和 ORDERBY 问题

> ID：12428985
> 
> 赞同：29
> 
> 时间：2012-09-14T17:05:01.367
> 
> 标签：c#, .net, linq, linq-to-sql

我正在学习 LINQ-to-SQL，一切都很顺利，直到发生了一些奇怪的事情：

我试图做一个例子`distinct`，所以，使用 Northwind 数据库，我编写了以下查询：

```
var query = 
    from o in db.Orders
    orderby o.CustomerID
    select new
    {
        o.CustomerID
    }; 
```

如果我打印 LINQ-to-SQL 为存储在其中的查询生成的 SQL，`query`它看起来像这样：

```
SELECT [t0].[CustomerID]
FROM [dbo].[Orders] AS [t0]
ORDER BY [t0].[CustomerID] 
```

因此，像往常一样，查询将按字母顺序排列的表中的所有`CustomerID`for each 。`Order``Orders`

但！如果我使用这样的`Distinct()`方法：

```
var query = (
    from o in db.Orders
    orderby o.CustomerID
    select new
    {
        o.CustomerID
    }).Distinct(); 
```

查询带来了`Distinct`子句的预期结果，但是`CustomerID`尽管我写了 s 没有排序`orderby o.CustomerID`！

第二个 LINQ 查询的 SQL 查询如下：

```
SELECT DISTINCT [t0].[CustomerID]
FROM [dbo].[Orders] AS [t0] 
```

正如我们所见，**`ORDER BY`缺少该子句。这是为什么？

为什么`ORDER BY`我使用该`Distinct()`方法时该子句会消失？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-09-14T17:13:43.433

来自[Queryable.Distinct 文档](http://msdn.microsoft.com/en-us/library/bb348456)；

> 预期的行为是它返回源中唯一项的无序序列。

换句话说，现有的 IQueryable 具有的任何订单在您使用`Distinct()`它时都会丢失。

您想要的可能更像是这样，在 Distinct() 完成*后的 OrderBy() ；*

```
var query = (from o in db.Orders
             select new
             {
                 o.CustomerID
             }).Distinct().OrderBy(x => x.CustomerID); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-14T17:13:33.550

尝试重新排列成员以将 OrderBy 放在 Distinct 之后。您必须恢复到方法链接：

```
db.Orders.Select(o=>o.CustomerId).Distinct().OrderBy(id=>id); 
```

无论如何，这将是在 Enumerable Linq 中设置查询的更有效方法，因为 OrderBy 将只对唯一项目而不是对所有项目进行操作。此外，根据[MSDN](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)， Enumerable.Distinct 无论如何都不能保证元素的返回顺序，因此在重复数据删除之前排序是没有意义的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T17:13:34.587

由于使用distinct，返回列表的顺序无法保证。LinqToSql 足够聪明，可以识别这一点，因此它会忽略它。

如果您在 Distinct 之后下订单，一切都会如您所愿。

```
var query = (from o in db.Orders
             select new
             {
                 o.CustomerID
             }).Distinct().OrderBy(o => o.CustomerID); 
```

或者

```
var query = db.Orders.Select(o => o.CustomerID).Distinct().OrderBy(o => o.CustomerID); 
```

请参阅这篇文章以获得澄清：

[http://programminglinq.com/blogs/marcorusso/archive/2008/07/20/use-of-distinct-and-orderby-in-linq.aspx](https://web.archive.org/web/20130318205025/http://programminglinq.com/blogs/marcorusso/archive/2008/07/20/use-of-distinct-and-orderby-in-linq.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-14T12:39:34.813

您可以使用以下结构模拟 ORDERBY 和 DISTINCT：

```
var distinctItems = employees.GroupBy(x => x.EmpID).OrderBy(x => x).Select(y => y.First()); 
```

# mongodb - 使用 MongoDB 进行构面搜索

> ID：12428989
> 
> 赞同：14
> 
> 时间：2012-09-14T17:05:23.553
> 
> 标签：mongodb, faceted-search

我正在考虑在我的下一个项目中使用 MongoDB。此应用程序的核心要求之一是提供分面搜索。有没有人尝试过使用 MongoDB 来实现构面搜索？

我有一个具有各种属性的产品模型，如尺寸、颜色、品牌等。在搜索产品时，这个 Rails 应用程序应该在侧边栏上显示构面过滤器。构面过滤器将如下所示：

```
Size:
XXS (34)
XS (22)
S (23)
M (37)
L (19)
XL (29)

Color:
Black (32)
Blue (87)
Green (14)
Red (21)
White (43)

Brand:
Brand 1 (43)
Brand 2 (27) 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-15T07:56:16.690

我认为使用 Apache Solr 或 ElasticSearch 可以获得更大的灵活性和性能，但是使用[Aggregation Framework](http://www.mongodb.org/display/DOCS/Aggregation+Framework)支持这一点。

使用 MongoDB 的主要问题是您必须查询 N 次：首先获取匹配结果，然后每组一次；在使用全文搜索引擎时，您可以在一个查询中获得所有信息。

**例子**

```
//'tags' filter simulates the search
//this query gets the products
db.products.find({tags: {$all: ["tag1", "tag2"]}})

//this query gets the size facet
db.products.aggregate(
    {$match: {tags: {$all: ["tag1", "tag2"]}}}, 
    {$group: {_id: "$size"}, count: {$sum:1}}, 
    {$sort: {count:-1}}
)

//this query gets the color facet
db.products.aggregate(
    {$match: {tags: {$all: ["tag1", "tag2"]}}}, 
    {$group: {_id: "$color"}, count: {$sum:1}}, 
    {$sort: {count:-1}}
)

//this query gets the brand facet
db.products.aggregate(
    {$match: {tags: {$all: ["tag1", "tag2"]}}}, 
    {$group: {_id: "$brand"}, count: {$sum:1}}, 
    {$sort: {count:-1}}
) 
```

一旦用户使用构面过滤搜索，您必须添加此过滤器来查询谓词和匹配谓词，如下所示。

```
//user clicks on "Brand 1" facet
db.products.find({tags: {$all: ["tag1", "tag2"]}, brand: "Brand 1"})

db.products.aggregate(
    {$match: {tags: {$all: ["tag1", "tag2"]}}, brand: "Brand 1"}, 
    {$group: {_id: "$size"}, count: {$sum:1}}, 
    {$sort: {count:-1}}
)

db.products.aggregate(
    {$match: {tags: {$all: ["tag1", "tag2"]}}, brand: "Brand 1"}, 
    {$group: {_id: "$color"}, count: {$sum:1}}, 
    {$sort: {count:-1}}
)

db.products.aggregate(
    {$match: {tags: {$all: ["tag1", "tag2"]}}, brand: "Brand 1"}, 
    {$group: {_id: "$brand"}, count: {$sum:1}}, 
    {$sort: {count:-1}}
) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-12-24T04:15:10.197

Mongodb 3.4 引入[分面搜索](https://docs.mongodb.com/v3.4/reference/operator/aggregation/facet/)

> $facet 阶段允许您创建多面聚合，在单个聚合阶段中跨多个维度或方面表征数据。多面聚合提供多种过滤器和分类来指导数据浏览和分析。
> 
> 输入文档只传递到 $facet 阶段一次。

现在，您不需要查询 N 次来检索 N 个组上的聚合。

> $facet 在同一组输入文档上启用各种聚合，而无需多次检索输入文档。

OP 用例的示例查询类似于

```
db.products.aggregate( [
  {
    $facet: {
      "categorizedByColor": [
        { $match: { color: { $exists: 1 } } },
        {
          $bucket: {
            groupBy: "$color",
            default: "Other",
            output: {
              "count": { $sum: 1 }
            }
          }
        }
      ],
      "categorizedBySize": [
        { $match: { size: { $exists: 1 } } },
        {
          $bucket: {
            groupBy: "$size",
            default: "Other",
            output: {
              "count": { $sum: 1 }
            }
          }
        }
      ],
      "categorizedByBrand": [
        { $match: { brand: { $exists: 1 } } },
        {
          $bucket: {
            groupBy: "$brand",
            default: "Other",
            output: {
              "count": { $sum: 1 }
            }
          }
        }
      ]
    }
  }
]) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T21:10:44.430

使用 MongoDB 进行更高级搜索的一个流行选项是将[ElasticSearch](http://www.elasticsearch.org/)与社区支持的[MongoDB River Plugin](https://github.com/richardwilly98/elasticsearch-river-mongodb)结合使用。MongoDB River 插件将来自 MongoDB 的文档流馈送到 ElasticSearch 中以进行索引。

ElasticSearch 是一个基于[Apache Lucene](http://lucene.apache.org/core/)的分布式搜索引擎，具有基于 http 的 RESTful JSON 接口。有一个[Facet Search API](http://www.elasticsearch.org/guide/reference/api/search/facets/)和许多其他高级功能，例如[Percolate](http://www.elasticsearch.org/guide/reference/api/percolate.html)和[“More like this”](http://www.elasticsearch.org/guide/reference/api/more-like-this.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-15T15:41:21.797

您可以进行查询，问题是它是否快。即类似的东西：

```
find( { size:'S', color:'Blue', Brand:{$in:[...]} } ) 
```

问题是性能如何。产品中还没有任何用于分面搜索的特殊功能。未来可能会有一些类似交叉路口的查询计划，这些计划很好，但那是待定/未来。

*   如果您的属性是预定义的集合，并且您知道它们是什么，则可以在每个属性上创建一个索引。当前实现中将仅使用其中一个索引，因此这将有所帮助，但仅能帮助您到目前为止：如果数据集中等大小，则可能没问题。

*   您可以使用可能复合两个或多个属性的复合索引。如果你有少量的属性，这可能会很好。索引不需要使用所有变量查询，但在上面的一个中，对三个中任意两个的复合索引可能比对单个项目的索引执行得更好。

*   如果您没有太多 sku 蛮力将起作用；例如，如果您是 1MM skues，则在 ram 中进行表扫描可能足够快。在这种情况下，我将制作一个仅包含方面值的表格，并使其尽可能小，并将完整的 sku 文档保存在单独的集合中。例如：

    facets_collection: {sz:1,brand:123,clr:'b',_id:} ...

如果刻面维度的数量不是太高，您可以改为制作一个高度复合索引的 facit 维度，并且无需额外工作即可获得与上述相同的索引。

如果您创建退出一些索引，最好不要创建太多以至于它们不再适合 ram。

鉴于查询运行，这是一个性能问题，可能只是使用 mongo，如果它不够快，则使用 solr。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-16T14:56:20.327

多面解决方案（基于计数）取决于您的应用程序设计。

```
db.product.insert(
{
 tags :[ 'color:green','size:M']

}
) 
```

但是，如果能够以上述格式提供数据，其中分面及其值连接在一起以形成一致的标签，则使用以下查询

```
db.productcolon.aggregate(
   [
      { $unwind : "$tags" },
      {
        $group : {
          _id : '$tags',
          count: { $sum: 1 }
        }
      }
   ]
) 
```

请参阅下面的结果输出

```
{ 
    "_id" : "color:green", 
    "count" : NumberInt(1)
}
{ 
    "_id" : "color:red", 
    "count" : NumberInt(1)
}
{ 
    "_id" : "size:M", 
    "count" : NumberInt(3)
}
{ 
    "_id" : "color:yellow", 
    "count" : NumberInt(1)
}
{ 
    "_id" : "height:5", 
    "count" : NumberInt(1)
} 
```

除了这一步之外，您的应用程序服务器可以在发送回客户端之前进行颜色/尺寸分组。

注意 - 组合 facet 及其值的方法为您提供了聚合的所有 facet 值，您可以避免 - “使用 MongoDB 的主要问题是您必须查询它 N 次：首先获取匹配结果，然后每组一次；同时使用全文搜索引擎，一次查询即可获得所有信息。” 见加西亚的回答

# php - php转换日期格式

> ID：12428999
> 
> 赞同：0
> 
> 时间：2012-09-14T17:06:08.607
> 
> 标签：php, date, timestamp

> **可能重复：**
> [使用 php 从时间戳获取时间和日期](https://stackoverflow.com/questions/9970584/getting-time-and-date-from-timestamp-with-php)

我正在尝试转换此日期格式：

```
09/14/2012 10:11 
```

转换为其他标准时间戳格式：

```
2012-09-14 09:44:54 
```

最有效的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T17:08:48.293

您可以使用 PHP 的[`date`](http://php.net/date)和[`strtotime`](http://php.net/strtotime)函数：

```
$date = '09/14/2012 10:11';
$formatted = date('Y-m-d H:i:s', strtotime($date)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T17:09:31.107

您可以使用[DateTime](http://es.php.net/manual/en/class.datetime.php)对象

```
$date = DateTime($myDate); 
```

[或使用createFromFormat](http://es.php.net/manual/en/datetime.createfromformat.php)的自定义输入格式

```
$date = DateTime::createFromFormat('d/m/y H:i:s', $myDate); 
```

[格式](http://es.php.net/manual/en/datetime.format.php)将使您的输出

```
$result = $date->format('Y-m-d H:i:s'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T17:09:00.423

```
date('Y-m-d H:i:s', strtotime('09/14/2012 10:11')); 
```

虽然很难改变时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T17:09:35.167

将 first 转换为 timestamp with`strtotime`并将 timestamp 转换为 date with `date`。

```
$outputDate = date( 'Y-m-d H:i:s', strtotime( $inputDate )); 
```