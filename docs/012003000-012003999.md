# StackOverflow 问答 12003000-12003999

# javascript - 对数组进行排序时删除重复项

> ID：12003005
> 
> 赞同：1
> 
> 时间：2012-08-17T09:14:54.467
> 
> 标签：javascript, arrays, sorting

我有一个包含我需要排序的对象的数组，并根据每个数组项的 3 个特定值删除重复项。目前我正在使用两个循环（非嵌套）：1 进行排序，另一个用于删除项目。有没有办法在排序或类似的东西时删除重复项？对于 1000 个项目，以下代码非常慢，我想知道是否有更快的方法：

```
var list = [
    {a: "Somename", b: "b", c: 10},
    {a: "Anothername", b: "a", c: 12},
    // and so on
];
function sortList(list) {
    // Sort the list based on the 3 specific values
    list = list.sort(function(a,b) {
        a.a = a.a.toLowerCase();
        b.a = b.a.toLowerCase();
        if (a.a < b.a) return -1;
        if (a.a > b.a) return 1;

        a.b = a.b.toLowerCase();
        b.b = b.b.toLowerCase();
        if (a.b < b.b) return -1;
        if (a.b > b.b) return 1;

        if (a.c < b.c) return -1;
        if (a.c > b.c) return 1;

        return 0;
    });

    // Loop through removing duplicates
    for (var a,b,i=list.length-1; i > 0; i--) {
        a = list[i];
        a.a = a.a.toLowerCase();
        a.b = a.b.toLowerCase();

        b = list[i-1];
        b.a = b.a.toLowerCase();
        b.b = b.b.toLowerCase();

        if (a.a===b.a && a.b===b.b && a.c===b.c) list.splice(i-1,1);
    }

    return list;
}
list = sortList(list); 
```

请不要使用 jQuery 答案，或建议使用其他库的答案。导入一个库来做这么简单的事情似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:52:21.330

搜索了一圈之后，我想出了自己的答案。它仍然使用两个循环，但这比排序然后删除重复项要快得多，并且比在排序时跟踪重复项更一致。基本上，我遍历数组，使用我想要排序/删除重复项的属性值（'key'）的串联将每个项目保存在一个对象中。如果密钥已经存储，我知道它是重复的，可以继续下一个。否则，我将项目添加到新数组中。删除重复项后，我对数组进行排序并返回它：

```
function sortList(list){
    // Since the 3 properties I'm sorting by can be converted to string I can loop
    // through the specified array, creating 'keys' by concating those property values
    // and adding those 'keys' to a temporary object. If the 'key' is present in the
    // temporary object, I know it's a duplicate in the array and can ignore it.
    // Otherwise I know it's not a duplicate and add it to a new array
    for (var a=0,b=list.length,item,key="",dupObj={},nList=[]; a<b; a++) {
        item=list[a];
        key=item.a.toLowerCase()+"_"+item.b.toLowerCase()+"_"+item.c;
        if(!dupObj[key]) {
            dupObj[key]=true;
            nList.push(item);
        }
    }

    // Now that we have an array without duplicates we can sort the array:
    nList.sort(function(a,b) {
        if ((a.a = a.a.toLowerCase()) < (b.a = b.a.toLowerCase()) return -1;
        if (a.a > b.a) return 1;

        if ((a.b = a.b.toLowerCase()) < (b.b = b.b.toLowerCase())) return -1;
        if (a.b > b.b) return 1;

        if (a.c < b.c) return -1;
        if (a.c > b.c) return 1;

        return 0;
    });

    // return the new list
    return nList;
}
var list = [
    {a: "Somename", b: "b", c: 10},
    {a: "Anothername", b: "a", c: 12},
    // and so on
];
list = sortList(list); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:38:57.427

不要`splice`在第二个循环中使用，只需将唯一值放入新数组中。因此，在每次迭代而不是`splice`ing 现有数组时，您只需将值附加到新数组；`push`比 快得多`splice`。例如：

```
var newList = [];
if (list) {
    newList.push(list[0];
    for (var a,b,i=1; i < list.length; i++) {
        a = list[i];
        a.a = a.a.toLowerCase();
        a.b = a.b.toLowerCase();

        b = list[i-1];
        b.a = b.a.toLowerCase();
        b.b = b.b.toLowerCase();

        if (a.a!==b.a || a.b!==b.b && a.c!==b.c) {
            newList.push(a);
        }
    }
} 
```

# php - 用 PHP 反汇编标签块上的 HTML 代码

> ID：12003009
> 
> 赞同：-6
> 
> 时间：2012-08-17T09:15:22.113
> 
> 标签：php

> **可能重复：**
> [如何使用 PHP 解析和处理 HTML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-with-php)

我有 HTML 代码，我需要获取第一个 DIV 块

```
<div class="right-catalog-item"><b>Accessories 1</b></div> 
```

在我需要从第一个 DIV 块获取后，获取内部 DIV 块

```
<div style="margin-left: 10px;"> 
```

从此代码：

```
<div class="right-catalog-item"><b>Accessories 1</b></div>
<div style="margin-left: 10px;">
    <div class="right-catalog-item"><a href="/catalog/type/25/">item 1</a></div>
    <div class="right-catalog-item"><a href="/catalog/type/10/">item 2</a></div>
    <div class="right-catalog-item"><a href="/catalog/type/60/">item 3</a></div>
</div>
<div class="right-catalog-item"><a href="/catalog/type/2/"><b>Accessories 1</b></a>
</div>
<div class="right-catalog-item"><a href="/catalog/type/1/"><b>Accessories 1</b></a></div>
<div class="right-catalog-item"><a href="/catalog/type/27/"><b>Accessories 1</b></a></div>
<div class="right-catalog-item"><a href="/catalog/type/19/"><b>Accessories 1</b></a></div>
<div class="right-catalog-item"><a href="/catalog/type/5/"><b>Accessories 1</b></a></div>
<div class="right-catalog-item"><a href="/catalog/type/4/"><b>Accessories 1</b></a></div>
<div class="right-catalog-item"><a href="/catalog/type/70/"><b>Accessories 1</b></a></div>
<div class="right-catalog-item"><a href="/catalog/type/12/"><b>Accessories 1</b></a></div> 
```

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-08-17T09:27:56.423

如果你已经知道 Jquery 你可以使用 PHP Query ：

[http://code.google.com/p/phpquery/](http://code.google.com/p/phpquery/)

您还可以在那里找到足够的文档。

# python - 包中的 Windows 上的 Python 多进程

> ID：12003010
> 
> 赞同：2
> 
> 时间：2012-08-17T09:15:27.687
> 
> 标签：python, multiprocess

我正在尝试在 Windows 上使用多进程，但遇到了无限循环错误。现在我知道这可以通过在标准 python 脚本中使用**name** == " **main " 来解决。**我的问题是我正在打包脚本，所以**名称**等于“testmultiprocess”（包名称）。

我在[github](https://github.com/niallm90/testmultiprocess)上创建了一个小项目来演示我的问题，因为它需要多个文件和一个安装。

谢谢，尼尔

编辑：

测试.py：

```
from multiprocessing import Process, Queue

def testFunction():
    print "testFunction"

def main():
    print __name__
    p = Process(target=testFunction)
    p.start()
    p.join() 
```

**打印的名称**总是“testmultiprocessing”，因为它是包名称

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T18:50:31.447

我设法通过修补在运行我的包的 python 目录中创建的脚本来解决这个问题。

**C:\Python27\Scripts\testmultiprocess-script.py**

从：

```
sys.exit(
    load_entry_point(.....)
) 
```

到：

```
if __name__ == '__main__':
 sys.exit(
     load_ 
```

# mysql - 用公共列缝合两个 mysql 表

> ID：12003013
> 
> 赞同：2
> 
> 时间：2012-08-17T09:15:34.360
> 
> 标签：mysql

我有两张这样的桌子，

表格1 ：

```
+-------------+--------+--------+--------+
| contract_id | price1 | price2 | price3 |
+-------------+--------+--------+--------+
|           1 |     23 |     45 |     56 |
|           1 |     22 |     21 |    453 |
|           1 |     45 |    564 |    456 |
|           4 |     22 |     21 |    453 |
|           5 |     45 |    564 |    456 |
+-------------+--------+--------+--------+ 
```

和表2，

```
+-------------+--------+---------+
| contract_id | owner  | address |
+-------------+--------+---------+
|           1 | Me     | Madras  |
|           1 | father | Chennai |
+-------------+--------+---------+ 
```

我想将两个表拼接在一起，结果看起来像，

```
+-------------+--------+--------+--------+--------+---------+
| contract_id | price1 | price2 | price3 | owner  | address |
+-------------+--------+--------+--------+--------+---------+
|           1 |     23 |     45 |     56 | Me     | Madras  |
|           1 |     22 |     21 |    453 | father | Chennai |
|           1 |     45 |    564 |    456 | NULL   | NULL    |
|           4 |     22 |     21 |    453 | NULL   | NULL    |
|           5 |     45 |    564 |    456 | NULL   | NULL    |
+-------------+--------+--------+--------+--------+---------+ 
```

目前我正在手动迭代第二个表并更新第一个表中的相应行以实现这一点。我想出的其他方法是进行外部联接并清理重复的行。有没有更好的方法来获得结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:35:47.967

这应该可以完美地工作。首先，我计算两个表的排名，然后使用`LEFT JOIN`基于排名的这两个表连接，这样输出中不会有任何重复，因为它是一对一的映射。

试试这个查询：

```
SELECT 
    a.contract_id, a.price1, a.price2, a.price3, b.owner, b.address
FROM 
    (SELECT 
         contract_id, price1, price2, price3, (@rank := @rank + 1) AS rank
     FROM 
         table1, (SELECT @rank := 0) tmp) a
LEFT JOIN 
    (SELECT 
         contract_id, owner, address, (@rank := @rank + 1) AS rank
     FROM 
         table2, (SELECT @rank := 0) tmp) b ON a.rank = b.rank
ORDER BY 
    a.rank ASC; 
```

**编辑更准确的查询**：您需要为匹配的contract_ids创建嵌套排名：

```
SELECT 
    a.c_id, a.price1, a.price2, a.price3, b.owner, b.address
FROM 
    (SELECT 
         @var_rank := IF(contract_id <> @var_id_prev,1, @var_rank+1) AS vrank,
         @var_id_prev := contract_id AS c_id,
         price1, price2, price3, @rank := (@rank + 1) AS rnk
     FROM 
         table1, (SELECT @var_id_prev := 0) tmp
     ORDER BY 
         contract_id) a
LEFT JOIN 
    (SELECT 
         @var_rank := IF(contract_id <> @var_id_prev,  1, 
         @var_rank+1) AS vrank,
         @var_id_prev := contract_id AS c_id,
         owner, address, @rank := @rank + 1 AS rnk
     FROM 
         table2, (SELECT @var_id_prev := 0) tmp
     ORDER BY 
         contract_id) b ON a.c_id = b.c_id AND a.vrank = b.vrank
ORDER BY 
    a.c_id, a.vrank ASC; 
```

[**SQL FIDDLE 演示在这里**](http://sqlfiddle.com/#!2/fd4a6/41)

但更好的方法是放在`auto id`两个表上并在连接条件下使用它。

通过这样做，表被规范化，它将节省在计算排名时在内存中创建临时表的额外开销。它还将通过在这些连接列上使用索引来加速查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:17:11.133

[我们必须通过它的Row_Number](https://stackoverflow.com/questions/1895110/row-number-in-mysql/1895127#1895127)加入这两个表。

尝试这个：

```
SELECT a.contract_id, a.price1, a.price2, a.price3, b.owner, b.address
FROM (SELECT contract_id, price1, price2, price3, (@rank := @rank + 1) AS rank
      FROM t1, (SELECT @rank := 0) tmp
     )a
LEFT JOIN 
     (SELECT contract_id, owner, address, (@rank1 := @rank1 + 1) AS rank
      FROM t2, (SELECT @rank1 := 0) tmp
     )b
ON a.rank = b.rank
AND a.contract_id = b.contract_id
ORDER BY a.rank ASC; 
```

# [*看到这个 SQLFiddle*](http://sqlfiddle.com/#!2/b058d/2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:56:34.880

您需要显示这两个表之间的关系，而不是使查询复杂化。规范化第一张表，使用[外键](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)交叉引用相关数据。我会这样做：

![在此处输入图像描述](../Images/e9440297128e09ab3fd0a06150f30f63.png)

查询如下所示：

```
SELECT table1.contract_id, table1.price1, table1.price2, table1.price3, table2.name, table2.address
FROM table1
LEFT JOIN table2 ON table1.owner_id = table2.id; 
```

# ffmpeg - 将 UDP 输入通过管道传输到 FFMPEG

> ID：12003014
> 
> 赞同：3
> 
> 时间：2012-08-17T09:15:36.990
> 
> 标签：ffmpeg, udp, rtp

摄像机通过本地端口上的 UDP 将视频数据作为 RTP 发送给我。

ffmpeg 是否支持将输入（H.264 有效负载）自动转换为 MP4 ？

怎么做 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T08:35:48.723

这应该有效：

```
ffmpeg -i udp://localhost:1234 -vcodec copy output.mp4 
```

或尝试：

```
ffmpeg -i rtp://localhost:1234 -vcodec copy output.mp4 
```

将 1234 替换为您的端口。我假设输入已经在 H.264 中，如果没有，请删除 -vcodec 副本。

# xmpp - Mac OS/Ubuntu 的团队聊天（带有语音、历史记录和机器人等）

> ID：12003015
> 
> 赞同：0
> 
> 时间：2012-08-17T09:15:38.583
> 
> 标签：xmpp, chat, skype, voice, collaboration

我们是小型 webdev 团队（目前是 7 到 15 名成员）。

我们要创业，需要带有语音选项、日志选项（新用户可以在 Skype 群聊中查看历史记录）和机器人的群组文本聊天。

目前我们使用 Skype 群聊（适合群文本和语音聊天，也允许查看历史记录）。但我不知道如何创建 Skype 机器人（我的意思是信息机器人——关于 Mercurial Bitbucket 提交、关于新团队论坛消息、支持@邮箱的新电子邮件、看板任务板上的新问题等）

所以我的问题是如何创建 Skype 机器人，或者我们应该切换到（例如）Jabber（请提供有关服务器的更多信息，我们可以为此使用 GoogleTalk 还是需要安装另一台服务器，以及关于客户端（最适合 Mac OS和Ubuntu））。

我知道[http://www.voip-info.org/wiki/view/Open+Source+VOIP+Software](http://www.voip-info.org/wiki/view/Open+Source+VOIP+Software)但不确定我们需要选择什么。理想情况下只安装客户端（如 Skype）并节省服务器部分管理时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T09:19:32.853

对于 Skype 机器人，也许这可以满足您的需求：

[https://github.com/opensourcehacker/sevabot](https://github.com/opensourcehacker/sevabot)

免责声明：我是 50% 的作者，所以如果您在评论中添加它们，我可以回答更详细的问题。然而，HTTP + 脚本接口应该提供几乎所有你可以想象的开箱即用的东西。

# ruby-on-rails - 修改新 Rails 应用的骨架

> ID：12003016
> 
> 赞同：0
> 
> 时间：2012-08-17T09:15:43.050
> 
> 标签：ruby-on-rails

我已经为我的 Rails 应用程序设置了一个项目框架，我想让这个框架成为新创建的应用程序的默认项目框架。

一种方法是修改 Rails 的项目模板文件（如果有的话，我不确定）。这（如果可能的话）将在每次 Rails 更新时被覆盖。

有没有人有更好的想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:06:38.357

您可以创建自己的[应用程序模板](http://edgeguides.rubyonrails.org/rails_application_templates.html)。

这可以传递给`rails new`命令：

```
rails new app_name -m your_template 
```

`your_template`文件系统路径或 URL在哪里。

要将其设为默认值，请创建一个`~/.railsrc`文件并添加

```
-m your_template 
```

# javascript - Angular.js 框架的附加 js 文件有什么用？

> ID：12003019
> 
> 赞同：22
> 
> 时间：2012-08-17T09:15:49.947
> 
> 标签：javascript, angularjs

我正在尝试[angular.js](http://www.angularjs.org/)，但我对应该导入的 javascript 文件的数量感到困惑。在 1.0.1 版本中，有许多附加文件，例如：

*   角引导-1.0.1.js
*   angular-loader-1.0.1.js
*   角度资源-1.0.1.js
*   角清理-1.0.1.js

自然，我打开了这些文件，试图了解它们的功能。例如， angular-loader 有一条评论说：

```
Interface for configuring angular {@link angular.module modules}. 
```

对我来说，这听起来像是一个重要的模块，但我的简单应用没有它也能正常工作......

我要全部导入吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-17T14:13:07.687

免责声明：这是我的想法。我不是核心开发人员。

AngularJS 有基本的 ng 模块（angular-1.0.1.js）和一些附加模块。如果你看一下[api文档](http://docs.angularjs.org/api/)你会看到左侧的目录被分成了几个块：ng模块、ngMock模块、ngCookies模块等。

angular-bootstrap-1.0.1.js 似乎是下拉和选项卡的类似引导的实现。我认为它们主要用于[angularjs.org](http://angularjs.org/)。但任何人都可以使用（感谢 MIT 许可证）。

angular-cookies-1.0.1.js 是[ngCookies 模块](http://docs.angularjs.org/api/ngCookies)，它提供两种服务：[$cookies](http://docs.angularjs.org/api/ngCookies.$cookies)和[$cookieStore](http://docs.angularjs.org/api/ngCookies.$cookieStore)。

据我了解，angular-loader-1.0.1.js 应该有助于在外部环境中设置角度（确保加载所有必需的模块等）。

angular-resource-1.0.1.js 是提供[$resource 服务的](http://docs.angularjs.org/api/ngResource.$resource)[ngResource 模块](http://docs.angularjs.org/api/ngResource)。

angular-sanitize-1.0.1.js 是[ngSanitize 模块](http://docs.angularjs.org/api/ngSanitize)，提供[ngBindHtml 指令](http://docs.angularjs.org/api/ngSanitize.directive:ngBindHtml)、[linky 过滤器](http://docs.angularjs.org/api/ngSanitize.filter:linky)和[$sanitize 服务](http://docs.angularjs.org/api/ngSanitize.$sanitize)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-11T20:37:17.663

这是您问题的官方答案[http://docs.angularjs.org/misc/downloading](http://docs.angularjs.org/misc/downloading)

# blackberry - 如何在持久存储黑莓中存储字符串值

> ID：12003020
> 
> 赞同：-5
> 
> 时间：2012-08-17T09:15:51.103
> 
> 标签：blackberry, persistent-storage

如何利用 Blackberry 的持久存储来存储字符串？

喜欢：

```
String str = "5"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:25:28.763

尝试这个：

```
public static PersistentObject persistentObject;`
public static final long KEY = 0x9df9f961bc6d6daL;
public static Hashtable persistentHashtable; 
```

***“用户名”是用于标识值的字段。***

以下代码将检索存储的电子邮件地址。

```
persistentObject = PersistentStore.getPersistentObject(KEY);
if (persistentObject.getContents() == null) {
        persistentHashtable = new Hashtable();
        persistentObject.setContents(persistentHashtable);
    } else {
        persistentHashtable = (Hashtable) persistentObject.getContents();
    }

    if (persistentHashtable.containsKey("username")
            ) {

        String temp= persistentHashtable.get("username"));
    } 
```

***要将值插入持久存储，请使用以下代码：***

```
persistentHashtable.put("username", str); 
```

# ruby-on-rails - 从 Rails 中的控制器覆盖 Omniauth 密钥/秘密组合

> ID：12003022
> 
> 赞同：0
> 
> 时间：2012-08-17T09:15:58.100
> 
> 标签：ruby-on-rails, facebook, twitter, omniauth, linkedin

我在 rails 中有一个 Omniauth 设置，在 config/initializers 中有一个常规的 omniauth.rb 配置文件，例如：

```
 provider :twitter, :setup => lambda { |env|
      twitter_key = keychain.key "twitter"
      twitter_secret = keychain.secret "twitter"

      Rails.application.config.twitter_key = twitter_key
      Rails.application.config.twitter_secret = twitter_secret
      env['omniauth.strategy'].options[:consumer_key] = twitter_key
      env['omniauth.strategy'].options[:consumer_secret] = twitter_secret} 
```

这很好用，但我希望能够用与我的应用程序中的控制器不同的密钥/秘密组合来覆盖这个密钥/秘密组合。我该怎么做呢？

我一直在寻找很长一段时间没有成功。希望这足够具体。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T15:05:19.070

在您的 omniauth.rb 上，执行以下操作：

```
Rails.application.config.middleware.use OmniAuth::Builder do
  provider :twitter,:setup => true
end 
```

然后在您的控制器上，您必须定义以下内容：

```
def setup
 request.env['omniauth.strategy'].options[:consumer_key] = @site.twitter_key
 request.env['omniauth.strategy'].options[:consumer_secret] = @site.twitter_secret
 render :text => "Setup complete.", :status => 404
end 
```

当然，你必须在你的 routes.rb 中添加相关的路由。

```
 #Twitter Omniauth routes
  match '/auth/twitter/callback' => 'session#authorize_callback'
  match '/auth/twitter/setup' => 'session#setup' 
```

祝你好运

问候。伊万。

# c++ - 具有 std::atomic 成员变量的类的复制构造函数/赋值运算符出错

> ID：12003024
> 
> 赞同：27
> 
> 时间：2012-08-17T09:15:59.037
> 
> 标签：c++, multithreading, c++11, atomic

我有一个像下面这样的课程。

```
#include <atomic>

static const long  myValue = 0;

class Sequence
{

public:

    Sequence(long initial_value = myValue) : value_(initial_value) {}

private:

     std::atomic<long> value_;
};

int main()
{
         Sequence firstSequence;
         Sequence secondSequence = firstSequence;
         return 0;
} 
```

我收到这样的编译错误，

```
test.cpp:21:36: error: use of deleted function ‘Sequence::Sequence(const Sequence&)’
test.cpp:5:7: error: ‘Sequence::Sequence(const Sequence&)’ is implicitly deleted because the default definition would be ill-formed:
test.cpp:5:7: error: use of deleted function ‘std::atomic<long int>::atomic(const std::atomic<long int>&)’ 
```

在这种情况下，默认的复制构造函数和赋值操作符是否不起作用？

PS：我使用的是 gcc 版本 4.6.3

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-17T09:24:59.523

您不能使用标准复制构造函数复制原子，因为所有加载和存储都必须显式发生。您必须编写自己的复制构造`Sequence`函数来对表单进行一些初始化`value_(rhs.value_.load())`（可能使用更宽松的内存排序）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-17T09:27:23.570

Atomic 已删除 copy-ctor。因此，您班级中的复制/移动角色将被删除。

n3337 12.8/11

> 隐式声明的复制/移动构造函数是其类的内联公共成员。如果 X 具有以下属性，则类 X 的默认复制/移动构造函数被定义为已删除 (8.4.3)：
> 
> **— 类类型 M（或其数组）的非静态数据成员，因为重载决议 (13.3) 应用于 M 的相应构造函数，导致模棱两可或函数被删除或无法从默认构造函数，**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-17T09:22:11.803

因为没有`std::atomic<long int>::atomic(const std::atomic<long int>&)`函数，所以编译器无法为`Sequence`类创建默认的复制构造函数。如果您需要该类的复制构造函数（如果您想`Sequence secondSequence = firstSequence;`工作就这样做），那么您需要编写一个。

标准要求此行为：

> 下面列出了原子整数和地址类型。这些类型应具有标准布局。它们应该有一个普通的默认构造函数、一个 constexpr 显式值构造函数、**一个已删除的复制构造函数**、一个已删除的复制赋值运算符和一个普通的析构函数。这些类型应支持聚合初始化语法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-22T20:45:22.377

我猜想在标准中删除复制构造函数的选择有两个原因：

*   通常需要一个加载/存储对。当您不控制 std::atomic 的调用者时，有什么方法可以强制执行此操作？

*   如果您使用的 std::atomic<> 类型是 is_lock_free() 为假的类型（即，该大小整数类型的实现中需要互斥锁），您会怎么做？您对互斥锁初始化使用什么复制语义？最终被隐式复制的互斥体需要重新初始化，因为它可能在锁定状态下被不幸地复制。我猜想 std::mutex 也因此有一个已删除的复制构造函数，这也将要求推到了 std::atomic 中。

# url - Cakephp 路由并按 id 显示数据

> ID：12003028
> 
> 赞同：0
> 
> 时间：2012-08-17T09:16:14.933
> 
> 标签：url, cakephp, routing, routes

我对蛋糕的路由有所了解，但是在显示差异表中的数据时遇到了麻烦。意见。

我有一个带有 news_type_id 标记的文章的新闻表。我将每个路由设置为显示调用 requestAction 的视图并按特定的 news_type id 列出新闻文章。

```
//--index of news articles with news_type_id = 1
/section1/

//--index of news articles with news_type_id = 2 etc
/section2/ 
```

我的路线设置如下：

```
Router::connect('/section1', array('controller' => 'pages', 'action' => 'display', 'section1')); 
```

但问题是我一尝试：

```
Router::connect('/section1', array('controller' => 'pages', 'action' => 'display', 'section1'));
Router::connect('/section2', array('controller' => 'pages', 'action' => 'display', 'section2')); 
```

...当然，动作路线回到顶部路线（第 1 节）。

有人可以向我指出显而易见的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:25:32.243

我会尝试 ：

```
Router::connect('/section1', array('controller' => 'pages', 'action' => 'display', array('mysection'=>'section1')));
Router::connect('/section2', array('controller' => 'pages', 'action' => 'display', array('mysection'=>'section2'))); 
```

在操作中我会得到 mysection 作为参数

希望这可以帮助

问候

# ruby-on-rails - 如何按最后一个 ID 字符搜索？

> ID：12003031
> 
> 赞同：1
> 
> 时间：2012-08-17T09:16:21.060
> 
> 标签：ruby-on-rails, postgresql

我正在使用 Rails 2.3.8 和 PostgreSQL 9.0 进行开发。我想通过 ID 中的最后几个字符进行搜索。

当我发布 id '123' 并返回最后 3 个字符包含 '123' 的记录时，如 '100123'、'200123'、'300123' 等。

如何按ID中的最后一个字符搜索记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:36:09.527

尝试

```
SELECT * FROM USERS WHERE CAST(id AS TEXT) LIKE '%123' 
```

参考[这个](https://stackoverflow.com/questions/1684291/sql-like-condition-to-check-for-integer)

# c# - 如何从 FileUpload 控件获取/读取文件名？

> ID：12003033
> 
> 赞同：0
> 
> 时间：2012-08-17T09:16:25.230
> 
> 标签：c#, asp.net

当单击 borwse 按钮​​并选择文件时，如何从 FileUpload 控件获取或读取文件名。例如，当单击浏览按钮时，我可以从计算机中的任何位置浏览文件，例如在 C://video/al.avi 中选择视频文件名 al.avi。那么我如何获取和读取视频的名称并将其显示在标签控件中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:19:28.650

当您回发到服务器时，您将获得文件中的数据以及 FileUpload 控件中的文件名。

```
var fileName = FileUpload1.PostedFile.FileName; 
```

这将为您提供文件名部分“al.avi”。您可以在标签中显示它。

这是一个[FileUpload 示例](http://msdn.microsoft.com/en-us/library/aa479405.aspx)，可帮助您入门。

# c++ - 使用复合数据结构计算最近点

> ID：12003038
> 
> 赞同：2
> 
> 时间：2012-08-17T09:17:07.327
> 
> 标签：c++, algorithm, computational-geometry

我正在阅读 Robert Sedwick Algorithms 的 C++ 书籍。以下是书中关于复合数据结构的示例。

问题陈述：给定“d”，我们想知道单位正方形中一组 N 个点中有多少对可以通过长度小于“d”的直线连接。

下面的程序使用逻辑将单位正方形划分为一个网格，并维护一个二维链表数组，每个网格正方形对应一个链表。选择的网格要足够精细，以使距离“d”内的所有点要么在同一个网格正方形中，要么在相邻的网格正方形中。

我的问题是

> 1.  为什么作者在 malloc2d(G+2, G+2) 中分配 G+2 ？
> 2.  在 gridinsert 函数中，为什么作者执行以下语句 int X = x*G+1; 整数 Y = y*G+1; ?
> 3.  在 for 循环中，为什​​么我们将 i 初始化为 X-1 并将 j 初始化为 Y-1？
> 4.  在代码中，我们在同一网格正方形或相邻网格正方形中维护距离 d 内的点？

请求您帮助理解以下程序的简单示例。

```
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <math.h>
using namespace std;

float randFloat() {
    return 1.0*rand()/RAND_MAX;
}

struct myPoint {
    float x;
    float y;
};

float myDistance(myPoint a, myPoint b) {
    float dx = a.x - b.x, dy = a.y - b.y;
    return sqrt(dx*dx + dy*dy);
}

struct node {
    myPoint p; node *next; 
    node(myPoint pt, node* t) {
        p = pt; next = t;
    }
};

typedef node *link;
static link **grid = NULL; 

link **malloc2d(int r, int c) {
    link **t = new link*[r];
    for (int i = 0; i < r; i++) {
      t[i] = new link[c];
    }
    return t;
 }

static int G, cnt = 0; 
static float d;

void gridinsert(float x, float y) {
    int X = x*G+1;
    int Y = y*G+1;
    myPoint p;
    p.x = x; p.y = y;
    link s, t = new node(p, grid[X][Y]);
    for (int i = X-1; i <= X+1; i++)
      for (int j = Y-1; j <= Y+1; j++)
        for (s = grid[i][j]; s != 0; s = s->next)
           if (myDistance(s->p, t->p) < d) cnt++; 

    grid[X][Y] = t;
 }

int main(int argc, char *argv[]) { 

    int i; 
    int N = 10;
    d = 0.25;
    G = 1/d;

    grid = malloc2d(G+2, G+2);
    for (i = 0; i < G+2; i++)
        for (int j = 0; j < G+2; j++)
            grid[i][j] = 0;

    for (i = 0; i < N; i++)
        gridinsert(randFloat(), randFloat());

    cout << cnt << " pairs within " << d << endl;

   return 0;
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T10:59:17.020

1.  这个想法是检查网格的所有相邻单元格。但是边界单元格没有相邻单元格。因此，为了避免棘手的边界检查，我们将网格扩展了 2 个额外的单元格 - 在第一个单元格之前和最后一个单元格之后。这些单元格是“虚拟的”，永远不会包含任何点——它们只是为了简化算法并为边界单元格提供相邻点。

2.  (X,Y) - 网格中包含该点的单元格的坐标（索引）。根据第 1 页，我们必须从单元格 (1,1) 开始放置点，而不是 (0,0)。(0,0) 和任何其他边界点都是虚拟的。

3.  因为我们检查网格的所有相邻单元格。(X,Y) 的相邻单元格是 (X-1,Y-1), (X, Y-1), (X+1, Y-1) 等到 (X+1,Y+1)。这就是为什么我们有从 X-1 到 X+1 和 Y-1 到 Y+1 的循环。

4.  我们不维护它们，只是检查任何输入点与现有集合并`cnt`在每次匹配距离时递增计数器。问题条件不需要保留此类对的列表。如果您需要保留点列表，您应该修改`gridinsert()`并例如放置`(s->p, t->p)`到循环内的某个容器而不是 increment `cnt++`。

# linux - 为什么不运行cron？

> ID：12003039
> 
> 赞同：1
> 
> 时间：2012-08-17T09:17:10.180
> 
> 标签：linux, cron

我想在我的 debian 系统中创建一个 cron 任务。

我这样做

```
sudo crontab -e 
```

并添加一行

```
10 17 * * * /home/userdir/cron/meiwei-slide-shoot.sh 
```

我在 17:00 执行此操作，并希望脚本在 17:10 运行。但它不起作用。

我已经尝试过脚本。它运作良好。但为什么不由 cron 运行呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:19:27.453

我会

1.  检查这些文件权限以确保脚本可以由 cron 用户执行
2.  将 stdout / stderr 记录到文件中以捕获任何错误，例如`script.sh >/tmp/cron.log 2>&1`

`cron`进程在非常精简的环境中运行，您可能遇到了执行权限问题，或者您依赖的环境变量不可用。对于它的价值，我每次设置`cron`工作时总是要经历几次迭代。

[这个 AskUbuntu 问题](https://askubuntu.com/questions/117978/script-doesnt-run-via-crontab-but-works-fine-standalone)还包含一些有用的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:20:07.357

您是否检查过该文件是否可执行？

您是否添加了如下行：

```
touch /tmp/proof_that_i_am_running 
```

到脚本顶部以检查它是否正在启动，并且由于其他原因而退出，例如不完整的环境设置？

您是否收到`cron`包含输出/错误的邮件？

您是否检查了`cron`假脱机目录（例如`/var/spool/cron/crontabs`）以确保已创建条目？

您可能会错过很多事情，这只是常见的事情，但这是一个好的开始。

* * *

一个好的测试是添加：

```
* * * * * date >>/tmp/crondates 2>&1 
```

到您`crontab`并观看以查看该文件是否出现。

# javascript - 对象优化中的参考

> ID：12003041
> 
> 赞同：0
> 
> 时间：2012-08-17T09:17:12.270
> 
> 标签：javascript, optimization, object, reference

我们对使用对象时的最佳实践有一些争论。我们中的一些人使用以下方式获取对象属性值：

```
object[a][b][...][z] 
```

其他人声称，如果您使用以下代码一次

```
var ref=object[a][b][...][z] 
```

然后在您需要更快的特定对象值时随时使用“ref”变量。

有谁知道在第二种情况下是否有优化？例如，如果您需要循环穿过大对象：

```
//with reference
for(var a in object){

    for(var b in object[a]){

        ...

            var ref=object[a][b][...][y];

            for(var z in object[a][b][...][z]){

                if(ref){
                    ....
                }
            }
        ...
    }
}

//without reference
for(var a in object){

    for(var b in object[a]){

        ...

            for(var z in object[a][b][...][z]){

                if(object[a][b][...][y]){
                    ....
                }
            }
        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T11:55:28.337

'ref' 版本可以节省您的对象查找，因此它应该更快。

jsperf 测试证实了这一点：http: [//jsperf.com/ref-or-no-ref](http://jsperf.com/ref-or-no-ref)

# c++ - OpenCV 和 ROS：cvMAT 中的空指针错误

> ID：12003050
> 
> 赞同：-5
> 
> 时间：2012-08-17T09:17:41.433
> 
> 标签：c++, opencv, ros

我正在使用以下内容来检测两个彩色对象的位置、方向。除非相机无法对这两个物体（黄色和蓝色）中的任何一个进行精细处理，或者当我将手放在相机前时，否则一切正常。它抛出以下错误：

OpenCV 错误：cvGetMat 中的空指针（传递了空数组指针），文件 /tmp/buildd/libopencv-2.3.1+svn6514+branch23/modules/core/src/array.cpp，第 2382 行终止在抛出一个实例后调用'cv::Exception' what(): /tmp/buildd/libopencv-2.3.1+svn6514+branch23/modules/core/src/array.cpp:2382: error: (-27) NULL 数组指针传入函数cvGetMat

如果有人可以帮助我解决此错误，我将不胜感激。

谢谢你

 `````
#include <ros/ros.h>
#include <opencv/cv.h>
#include <opencv/highgui.h>

#include <iostream>
#include <fstream>
#include <stdio.h>
#include <stdlib.h>

#include <math.h>

#include <geometry_msgs/Twist.h>

#define MAX_CONTOUR_LEVELS 5 //This will be used when displaying contours
#define PI 3.14159265
using namespace cv;
using namespace std;
// Class Definition
class color_control {
public:
    void mainLoop1();
    void mainLoop2();
    double R_X, R_Y; /* red center of gravity x,y in the frame normalized from -1.0 to 1.0 */
    int C_C;
    double setSpeed( double, double );
    void do_some_magic( IplImage* , int , int , int , int );

    color_control()
    {
      // node creation in root-namespace 
      ros::NodeHandle m_nodeHandle("/");

      m_commandPublisher = m_nodeHandle.advertise<geometry_msgs::Twist> ("cmd_vel", 20);
    }

    ~color_control()
    {
      cvDestroyWindow("result");
    }

protected:

    ros::NodeHandle m_nodeHandle;

    // Publisher und Membervariable für die Fahrbefehle
    ros::Publisher m_commandPublisher;
    geometry_msgs::Twist m_roombaCommand;

};

int abort_error_handler(int status, char const* func_name, char const* err_msg, char const* file_name, int line, void*) {
cout << "ERROR: in " << func_name << "(" << file_name << ":" << line << ") Message: " << err_msg << endl;
abort();
}

IplImage* GetThresholdedImage1(IplImage* img)
{
    IplImage* imgHSV = cvCreateImage(cvGetSize(img), 8, 3);
    cvCvtColor(img, imgHSV, CV_BGR2HSV);
    IplImage* imgThreshed1=cvCreateImage(cvGetSize(img),8,1);
    //cvInRangeS(imgHSV, cvScalar(20, 100, 100), cvScalar(30, 255, 255), imgYellow);
    cvInRangeS(imgHSV, cvScalar(22, 100, 100), cvScalar(32, 255, 255), imgThreshed1);
    cvReleaseImage(&imgHSV);
    //cvAdd(imgYellow,imgGreen,imgThreshed);
    //if (imgThreshed1 != NULL)
            return imgThreshed1;
    //cvShowImage( "result", imgThreshed1 );
}

IplImage* GetThresholdedImage2(IplImage* img)
{
    IplImage* imgHSV = cvCreateImage(cvGetSize(img), 8, 3);
    cvCvtColor(img, imgHSV, CV_BGR2HSV);
    IplImage* imgThreshed2=cvCreateImage(cvGetSize(img),8,1);
    //cvInRangeS(imgHSV, cvScalar(20, 100, 100), cvScalar(30, 255, 255), imgYellow);
    cvInRangeS(imgHSV, cvScalar(100,100,100^3),cvScalar(120,255,255^3), imgThreshed2);
    cvReleaseImage(&imgHSV);
    //cvAdd(imgYellow,imgGreen,imgThreshed);
    //if (imgThreshed2 == NULL)
            return imgThreshed2;

}

// find the largest contour (by area) from a sequence of contours and return a
// pointer to that item in the sequence

CvSeq* findLargestContour(CvSeq* contours){

  CvSeq* current_contour = contours;
  double largestArea = 0;
  CvSeq* largest_contour = NULL;

  // check we at least have some contours

  if (contours == NULL){return NULL;}

  // for each contour compare it to current largest area on
  // record and remember the contour with the largest area
  // (note the use of fabs() for the cvContourArea() function)

  while (current_contour != NULL){

      double area = fabs(cvContourArea(current_contour));

      if(area > largestArea){
          largestArea = area;
          largest_contour = current_contour;
      }

      current_contour = current_contour->h_next;
  }

  // return pointer to largest

  return largest_contour;

}

// normalize center of color to propulsion command
double color_control::setSpeed( double center, double width ){

  double normedCenter = (12.0*center/width) - 6.0;
    //ROS_INFO("normed center: %f", normedCenter);
  double retval = 0.0;

  if ( fabs( normedCenter ) > 1.0 ){
      retval = (trunc( normedCenter )/10.0 );
  }
  return retval;

}

//
// comments R 4 mollycoddles, guess what i'm doing!
// 
// Please help me ! I need someone writing comments. Thanx
//
void color_control::do_some_magic( IplImage* img, int red, int green, int blue, int tolerance) {

    int radius = 20 ;

    int width = img->width;
    int height = img->height;
    int channels = img->nChannels;
    int step = img->widthStep;

    unsigned char redP = 0, greenP = 0, blueP = 0;
    double S_x = 0.0 ;
    double S_y = 0.0 ;
    int red_difference, green_difference, blue_difference = 255;

    C_C = 0 ;

    for(int y=0;y<height;y++) {
        for(int x=0;x<width;x++) {
          blueP = img->imageData[y*step+x*channels+0] ;
          greenP = img->imageData[y*step+x*channels+1] ;
          redP = img->imageData[y*step+x*channels+2] ;

      red_difference = fabs(red - (int)redP);
      green_difference = fabs(green - (int)greenP);
      blue_difference = fabs(blue - (int)blueP);

      if ( (red_difference + green_difference + blue_difference) < tolerance ) {
         C_C++ ;
         S_x += x;
         S_y += y;

         //ROS_INFO( "Difference to target color: %i", (red_difference + green_difference + blue_difference) );
        }

        }
     }

    S_x = S_x / (C_C) ;
    S_y = S_y / (C_C) ;

    R_X = setSpeed( S_x, img->width );
    R_Y = setSpeed( S_y, img->height );

    // for monitoring, draw a circle and display the respective picture
    CvPoint center;
    center.x = S_x;
    center.y = S_y;
    cvCircle( img, center, radius, CV_RGB( 255 - red, 255 - green, 255 - blue ) , 3, 8, 0 );
    cvShowImage( "result", img );
}

// Main Loop
void color_control::mainLoop1() {
    // determines the number of frames per second
    ros::Rate loop_rate(20);
     int radius ;
    CvCapture* capture = 0;
    //IplImage *frame, *frame_copy = 0;
    IplImage* imgScribble=NULL;
    // open the camera
    capture = cvCaptureFromCAM( 0 );
    cvSetCaptureProperty(capture,CV_CAP_PROP_FRAME_HEIGHT, 640);
    cvSetCaptureProperty(capture,CV_CAP_PROP_FRAME_WIDTH, 480);
    //capture = cvCaptureFromCAM( 1 );
    //cvRedirectError(abort_error_handler);

    // loop stops, e.g. if the node recieves a kill signal
    while (m_nodeHandle.ok())
    {
        IplImage* frame=0;
                    frame=cvQueryFrame(capture);

                    if(!frame)
                                break;
//                  if(imgScribble == NULL)
//                  {
//                      imgScribble=cvCreateImage(cvGetSize(frame),8,1);
//                  }

                    IplImage* imgYellowThresh = GetThresholdedImage1(frame);
                    IplImage* imgGreenThresh = GetThresholdedImage2(frame);

            //CvMemStorage and CvSeq are structures used for dynamic data collection. CvMemStorage contains pointers to the actual
            //allocated memory, but CvSeq is used to access this data. Here, it will hold the list of image contours.
            CvMemStorage *storage = cvCreateMemStorage(0);
            CvSeq *contours = 0;

            //Once we have a binary image, we can look for contours in it. cvFindContours will scan through the image and store connected contours in "sorage".
            //"contours" will point to the first contour detected. CV_RETR_TREE means that the function will create a contour hierarchy. Each contour will contain
            //a pointer to contours that are contained inside it (holes). CV_CHAIN_APPROX_NONE means that all the contours points will be stored. Finally, an offset
            //value can be specified, but we set it to (0,0).
            cvFindContours(imgYellowThresh, storage, &contours, sizeof(CvContour), CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE, cvPoint(0,0));

            //This function will display contours on top of an image. We can specify different colours depending on whether the contour in a hole or not.
            CvSeq* largest_contour = NULL;
            largest_contour = findLargestContour(contours);

                //cvDrawContours(imgYellowThresh, largest_contour, CV_RGB(255,255,255), CV_RGB(0,255,0), MAX_CONTOUR_LEVELS, 3, CV_AA, cvPoint(0,0));
if(largest_contour!=NULL) {
                cvDrawContours(imgYellowThresh, largest_contour, CV_RGB(255,255,255), CV_RGB(0,255,0), 0, 2, 8, cvPoint(0,0));

}

            static int posX_Yellow=0;
            static int posY_Yellow=0;

            //int lastX=posX;
            //int lastY=posY;

           CvMoments moments1,cenmoments1;
           double M00, M01, M10;

           cvMoments(largest_contour,&moments1);
           M00 = cvGetSpatialMoment(&moments1,0,0);
           M10 = cvGetSpatialMoment(&moments1,1,0);
           M01 = cvGetSpatialMoment(&moments1,0,1);
           posX_Yellow = (int)(M10/M00);
           posY_Yellow = (int)(M01/M00);

          double theta = 0.5 * atan(
                    (2 * cvGetCentralMoment(&moments1, 1, 1)) /
                    (cvGetCentralMoment(&moments1, 2, 0) -  cvGetCentralMoment(&moments1, 0, 2)));
                theta = (theta / PI) * 180;

                // fit an ellipse (and draw it)

                if (largest_contour->total >= 6) // can only do an ellipse fit
                                                 // if we have > 6 points
                {
                    CvBox2D box = cvFitEllipse2(largest_contour);
                    if ((box.size.width < imgYellowThresh->width) &&  (box.size.height < imgYellowThresh->height))
                    {
                        // get the angle of the ellipse correct (taking into account MS Windows
                        // seems to draw ellipses differently

                        box.angle =  270 - box.angle;
                        #ifndef WIN32
                            if( imgYellowThresh->origin ) {
                                box.angle = - box.angle;
                            }
                        #endif
                        cvEllipseBox(imgYellowThresh, box, CV_RGB(255, 255 ,255), 3, 8, 0 );
                    }
                }
              CvFont font;
              cvInitFont(&font, CV_FONT_HERSHEY_PLAIN, 1, 1 , 0, 2, 8 );

            #ifdef WIN32
                int height_offset = 20;
            #else
                int height_offset = 5;
            #endif
                char outputString[255];

                sprintf(outputString, "angle: %.10f", theta);
                cvPutText(imgYellowThresh, outputString,
                    cvPoint(10,imgYellowThresh->height - height_offset), &font, CV_RGB(255, 255,255));

                              CvMemStorage *storageG = cvCreateMemStorage(0);

    CvSeq *contoursG = 0;

        //Once we have a binary image, we can look for contours in it. cvFindContours will scan through the image and store connected contours in "sorage".
        //"contours" will point to the first contour detected. CV_RETR_TREE means that the function will create a contour hierarchy. Each contour will contain
        //a pointer to contours that are contained inside it (holes). CV_CHAIN_APPROX_NONE means that all the contours points will be stored. Finally, an offset
        //value can be specified, but we set it to (0,0).
        cvFindContours(imgGreenThresh, storageG, &contoursG, sizeof(CvContour), CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE, cvPoint(0,0));

        //This function will display contours on top of an image. We can specify different colours depending on whether the contour in a hole or not.
        CvSeq* largest_contourG = NULL;
        largest_contourG = findLargestContour(contoursG);

if(largest_contourG!=NULL) {
            //cvDrawContours(imgYellowThresh, largest_contour, CV_RGB(255,255,255), CV_RGB(0,255,0), MAX_CONTOUR_LEVELS, 3, CV_AA, cvPoint(0,0));

            cvDrawContours(imgGreenThresh, largest_contourG, CV_RGB(255,255,255), CV_RGB(0,255,0), 0, 2, 8, cvPoint(0,0));
}
        //cvShowImage( "result2", imgGreenThresh );
    CvMoments moments2;
                               double M00g, M01g, M10g;

                               cvMoments(largest_contourG,&moments2);
                               M00g = cvGetSpatialMoment(&moments2,0,0);
                               M10g = cvGetSpatialMoment(&moments2,1,0);
                               M01g = cvGetSpatialMoment(&moments2,0,1);
                               static int posX_Green=0;
                                        static int posY_Green=0;
                                posX_Green = (int)(M10g/M00g);
                               posY_Green = (int)(M01g/M00g);

                               //printf("%d\n",M00g);
   //ROS_INFO("position (%d,%d)\n",posX_Yellow,posY_Yellow);
   //ROS_INFO("position (%d,%d)\n",posX_Green,posY_Green);

            //do_some_magic( frame , 0, 0, 0, 100);

//          if(lastX>0 && lastY>0 && posX>0 && posY>0)
//                  {
//                      cvLine(imgScribble,cvPoint(posX,posY),cvPoint(lastX,lastY),cvScalar(0,255,255), 5);
//                  }
//          cvAdd(frame,imgScribble,frame);
            cv::Point centerY(posX_Yellow,posY_Yellow);
            //centerY.x = posX_Yellow;
            //centerY.y = posY_Yellow;
            //radius = sqrt(areaY/3.14);
            cvCircle( frame, centerY, 10, CV_RGB( 255, 255, 255) , 3, 8, 0 );

            cv::Point centerG(posX_Green,posY_Green);
            //centerG.x = posX_Green;
            //centerG.y = posY_Green;
            cv::Point diff = centerY - centerG;
            //radius = sqrt(areaG/3.14);
            cvCircle( frame, centerG, 10, CV_RGB( 255, 255, 255) , 3, 8, 0 );
            //float angle = atan2(centerY,centerX);
            int slope = ((diff.y)/(diff.x));
            int len = cv::sqrt(diff.x*diff.x + diff.y*diff.y);
            double newdist = (len / 2000000);
            cvLine(frame, centerY, centerG, CV_RGB( 255, 255, 255), 5,8,0);
            //cvCircle( frame, diff, 10, CV_RGB( 255, 255, 255) , 3, 8, 0 );
            //ROS_INFO("angle :  %d\n",theta);
            //ROS_INFO("len: %d    slope: %d\n",len,slope);
            //printf("len: %f\n", slope);
            cvShowImage( "result", frame );
            cvShowImage( "result1", imgYellowThresh );
            cvShowImage( "result2", imgGreenThresh );

            if( cvWaitKey( 10 ) >= 0 )
                                    break;

         //ROS_INFO( "C_C: %d", C_C );

         // set driving direction and velocity
//       if (len > 50 || slope > 0)
//        {
//          m_roombaCommand.linear.x = 0.1;
//          m_roombaCommand.angular.z = 0.0;
//        } else {
//          m_roombaCommand.linear.x = 0.0;
//          m_roombaCommand.angular.z = 0.1;
//        }

         //
//      ROS_INFO("Forward: %f - Turning: %f", m_roombaCommand.linear.x, m_roombaCommand.angular.z);
//
//      // send the driving command to the roomba
        //m_commandPublisher.publish(m_roombaCommand);

    // spinOnce is doing the loop exactly once
    ros::spinOnce();
            //cvReleaseCapture( &capture );

    // sleep stops the process for approx ~50ms, to keep the timing for the looprate
    loop_rate.sleep();

    }

    //cvReleaseImage( &frame_copy );

}

int main(int argc, char** argv) {
    //sleep(10);
    // Initialize
    ros::init(argc, argv, "color_control");

    ros::NodeHandle n;
    color_control f_g;
    f_g.mainLoop1();
    //color_control g_g;
    //g_g.mainLoop2();
    ros::spin();
    //cvRedirectError(abort_error_handler);
    return 0;

        //cvNamedWindow("Video");
        //cvNamedWindow("thresh");
    } 
````  `* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:51:40.877

当您调用时，`findlargestContour`您检查`NULL`调用时的返回值`cvDrawContours`。但是，您也可以在此之后使用返回的值，而无需检查`NULL`.

`NULL`简单的解决方案是在使用返回值之前添加更多检查。``

# c# - C# DataGridView 自动添加一个 _Extra_ 行

> ID：12003052
> 
> 赞同：4
> 
> 时间：2012-08-17T09:17:46.710
> 
> 标签：c#, datagridview, rows, extra

[Microsoft Visual Studio 2008，Windows 7 专业版 64]

我有一个扩展*DataGridView的**C#*类：

 *```
public class DataGridViewTest : DataGridView 
```

此类以编程方式设置*列*数和*行*数。

我有一个创建*DataGridViewTest*实例并将其添加到*GroupBox的**Form*应用程序。

 ***DataGridViewTest*为*列*数和*行*数定义静态成员：

```
private static int NUM_COLUMNS = 2;
private static int NUM_ROWS = 2; 
```

这是设置所有内容的代码：

```
public DataGridViewTest()
{
    for (int i = 0; i < NUM_COLUMNS; i++)
    {
        DataGridViewTextBoxColumn column = new DataGridViewTextBoxColumn();
        column.Name = "Column " + i.ToString();
        this.Columns.Add(column);
    }

    for (int i = 0; i < NUM_ROWS; i++)
    {
        DataGridViewRow row = new DataGridViewRow();
        Rows.Add(row);
    }
} 
```

如您所见 _NUM_ROWS_ 设置为*2*。

但是，当应用程序运行时，*DataGridViewTest*会 显示一个包含*3*行而不是*2*行的数据网格。（类似地，将 NUM_ROWS 设置为*0会创建一个包含**1*行的数据网格。）

为什么要添加这个*额外的*行？

这是一个屏幕截图：

![DataGridView 额外行](../Images/ebc6054080fdcbd9de48a3aa6fb20b34.png)

谢谢！

简

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T09:22:53.940

第三行用于添加新行。设置属性如下：

> `DataGridView.AllowUserToAddRows = false`***

# pthreads - AIX 是互斥量信号量吗？

> ID：12003056
> 
> 赞同：1
> 
> 时间：2012-08-17T09:18:13.527
> 
> 标签：pthreads, mutex, semaphore, aix

第一个问题： ipcs -s 是否会显示有关正在使用的 pthread 互斥锁的任何信息？

我询问是否在 AIX 信号量之上实现了 pthread 互斥锁，反之亦然。

有人发现了一些信号量（使用 ipcs）并表示它可能在我们的库中。但是我们不使用 semxxx 而是使用 pthread 互斥锁。

互斥锁不共享，所以我假设它们与进程一起死亡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:00:32.763

他们是分开的。Pthreads 是一个用户空间库，而不是像 SysV 风格的信号量那样的内核子系统。所有 pthread 概念都是该进程的本地概念。Pthread 本身可以映射到内核线程，但锁定概念是分开的。

# c# - 以美国格式返回日期

> ID：12003068
> 
> 赞同：0
> 
> 时间：2012-08-17T09:18:51.820
> 
> 标签：c#, asp.net, globalization

我想以美国格式返回这个短日期，我的应用程序的当前文化是`en-GB`，但我希望它是`en-US`.

这是我到目前为止的代码：

```
DateTime.Now.AddYears(-2).ToShortDateString(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:24:07.457

您需要确保使用正确的文化格式字符串来实现这一点。

直接从文化中获取这种格式的一种方法是：

```
CultureInfo.GetCultureInfo("en-US").DateTimeFormat.ShortDatePattern 
```

对我来说，这会返回`M/d/yyyy`。

```
var usShortDatePattern = 
             CultureInfo.GetCultureInfo("en-US").DateTimeFormat.ShortDatePattern;
DateTime.Now.AddYears(-2).ToString(usShortDatePattern); 
```

这样做的好处是，如果用户`en-US`在其控制面板（区域和语言）中覆盖了短日期模式，他们将获得所需的格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T09:21:40.027

取自[文档](http://msdn.microsoft.com/de-de/library/system.datetime.toshortdatestring.aspx)：

```
DateTime.Now.AddYears(-2).ToString("d", new CultureInfo("en-US")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T09:21:02.793

使用`.ToString()`扩展方法并输入格式：

```
DateTime.Now.AddYears(-2).ToString("M/d/yyyy"); 
```

此处记录了自定义日期格式选项：

[http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T09:23:36.620

```
var culture = new CultureInfo("en-us");
string formatedDate = DateTime
    .Now
    .AddYears(-2)
    .ToString(culture.DateTimeFormat.ShortDatePattern, culture); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T09:35:35.017

“我想应用 en-US 短日期模式”：

```
DateTime.Now.AddYears(-2).ToString("d", CultureInfo.GetCultureInfo("en-US")); 
```

“我想应用 M/d/yyyy 模式，无论 .NET 是否认为这是 en-US 的短模式：

```
DateTime.Now.AddYears(-2).ToString(@"M\/d\/yyyy", CultureInfo.InvariantCulture) 
```

（结果与上面相同，但如果您认为“美国格式”实际上是 MM/dd/yyyy，这也用于美国，那么这就是您想要的方法，但使用`@"MM\/dd\/yyyy"`而不是`@"M\/d\/yyyy"`.

最后，“我想找出用于另一个呼叫的 en-US 短日期模式：

```
CultureInfo.GetCultureInfo("en-US").DateTimeFormat.ShortDatePattern 
```

# android - Android：带有 ListView 和 GridView 的操作栏

> ID：12003070
> 
> 赞同：0
> 
> 时间：2012-08-17T09:19:04.143
> 
> 标签：android, listview, gridview, android-actionbar

我正在尝试开发一个带有三个选项卡的操作栏。在第一个选项卡中，我想要一个带有图像的网格视图，而在其他两个选项卡中，我想要一个列表视图。我怎样才能做到这一点？互联网上有代码示例吗？（我没找到）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:47:55.487

> 首先，您需要创建具有三个选项卡的 TabBar 应用程序，然后在选项卡上查看列表和网格视图。

所以我已经创建了一些教程来做到这一点。

首先创建三个选项卡：

检查此选项卡栏：[Android 中的 TabWidget](http://www.rdcworld-android.blogspot.in/2011/11/tabwidget-in-android-advance.html)

对于列表视图：[Android 中的 ListView](http://www.rdcworld-android.blogspot.in/2011/08/list-view-in-android-basic.html)

对于网格视图：[带有图像的网格视图演示](http://www.rdcworld-android.blogspot.in/2011/09/grid-view-demo-with-images.html)

以下是如何在 Android 中创建选项卡的代码

**ActivityTabWidget.java**

```
package com.rdc;  

import android.app.TabActivity;  
import android.content.Intent;  
import android.os.Bundle;  
import android.view.LayoutInflater;  
import android.widget.TabHost;  

public class ActivityTabWidget extends TabActivity {  
 private TabHost mTabHost = null;  
 private Intent ihome, imusic, iabout;  

 @Override  
 public void onCreate(Bundle savedInstanceState) {  
  super.onCreate(savedInstanceState);  
  setContentView(R.layout.main);  

  //create tab host to add tabs  
  mTabHost = getTabHost();  

  LayoutInflater.from(this).inflate(R.layout.main,  
    mTabHost.getTabContentView(), true);  

  // create intents to load another page on Tabs  
  ihome = new Intent(ActivityTabWidget.this, ActivityHome.class);  
  imusic = new Intent(ActivityTabWidget.this, ActivityMusic.class);  
  iabout= new Intent(ActivityTabWidget.this,ActivityAboutMe.class);  

  // create tabs and add to TabHost  

  mTabHost.addTab(mTabHost.newTabSpec("tab1")  
    .setIndicator(" Home ")  
    .setContent(ihome));  

  mTabHost.addTab(mTabHost.newTabSpec("tab3")  
    .setIndicator(" Music ")  
    .setContent(imusic));  

  mTabHost.addTab(mTabHost.newTabSpec("tab3")  
    .setIndicator(" About Me ")  
    .setContent(iabout));  

  // set default selected tab  
  mTabHost.setCurrentTab(0);  

 }  
} 
```

然后你需要创建三个活动

1.  ActivityHome.class
2.  ActivityMusic.class
3.  ActivityAboutMe.class

所以输出会是这样的..

![在此处输入图像描述](../Images/a7dd18d4781c154f349662902a3b88f1.png)

# objective-c - 滚动背景 cocos2d box2d

> ID：12003072
> 
> 赞同：1
> 
> 时间：2012-08-17T09:19:05.790
> 
> 标签：objective-c, performance, cocos2d-iphone, box2d, parallax

我正在使用 cocos2d 和 box2d 开发一个无尽的水平滚动 iPhone 游戏。

我的英雄必须跳过与我的英雄精灵在同一层上添加的障碍物（运动学 box2d 身体）。

我的问题是视差背景和障碍物的速度不同。看起来它们是有联系的。我找不到解决此问题的解决方案。我试图找到相同的速度......但没有运气。赌注是将障碍作为孩子添加到视差层，但它不起作用。

谢谢

苏丹（抱歉英语不好）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:24:06.603

创建一个单独的 CCLayer 类用于使用 box2D 移动对象并将该层添加到视差层。

这是我的一个 cocos2D，基于视差的游戏：[SUBVERSION SOURCE LINK](https://subversion.assembla.com/svn/angryguru/)

# linux - 虚拟内核内存布局：负值

> ID：12003076
> 
> 赞同：0
> 
> 时间：2012-08-17T09:19:26.243
> 
> 标签：linux, memory, omap

我正在将 omap3-board 的驱动程序移植到 3.5 内核。当我开始板时，我看到它：

```
Memory: 256MB = 256MB total
Memory: 253564k/253564k available, 8580k reserved, 3226106074K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xc04a78ea - 0xc0573f24   (   0 kB)
    vmalloc : 0xc0573f24 - 0xc0573f2c   (5276 MB)
    lowmem  : 0xc0573fbc - 0xc0573f30   (-1068285412 MB)
    modules : 0xc03d93e4 - 0xc04a7927   (-65536 MB)
      .text : 0xffff1000 - 0x00000004   (-1048576 kB)
      .init : 0xfffe0000 - 0x00000380   (-796917760 kB)
      .data : 0xff000000 - 0x000002e8   (-1073741824 kB)
       .bss : 0xd0000000 - 0x00000100   (-1090519040 kB)
SLUB: Genslabs=11, HWalign=64, Order=0--1068023944, MinObjects=-1068023968, CPUs=-1071855052, Nodes=-1071855184 
```

为什么记忆的价值如此之大和消极？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:25:55.530

您可能正在使用带符号的 32 位数据类型处理无符号的 32 位值。使用无符号 32 位数据类型或 64 位数据类型。

实际上，您甚至可能在 32 位数据类型中操作 64 位值，这很难说。我建议使用 64 位数据类型。

# ruby-on-rails - 如何抽象在许多控制器之间共享的通用代码

> ID：12003080
> 
> 赞同：2
> 
> 时间：2012-08-17T09:19:33.067
> 
> 标签：ruby-on-rails

在我的应用程序中，我有一个用户模型/控制器。一个用户可以拥有多个视频、图像和博客项目。用户，并且项目可以有评论。所以我有以下控制器

*   用户
*   用户/评论
*   用户/图片
*   用户/图片/评论
*   用户/视频
*   用户/视频/评论
*   用户/博客
*   用户/博客/评论

问题是，所有的注释控制器几乎都是一样的，而且代码变得难以管理。现在我想指定一个中心位置，例如一个应用程序级别的 CommentsController，它具有从子控制器调用的方法。

最好的方法是什么？

例如，以下代码将如何处理此类更改：

```
class User::Picture::CommentsController < ApplicationController
  def delete_all
    @user = User.find(params[:user_id])
    @picture = @user.pictures.find(params[:picture_id])

    if @picture.has_access(current_user)
      @picture.comments.destroy_all

      redirect_to :back, :notice=>t(:actionsuccesful)
    else
      redirect_to :back, :alert=>t(:accessdenied)
    end
  end
end 
```

@user && @picture 初始化在不同的方法（destroy、delete_all、create、index）中是相同的。可以将它们移动到特定于子控制器的 before_filter 中吗？然后，delete_all 会在 CommentsController 中实现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:26:30.177

如果代码是通用的，有两个选择：

1) 包含共享方法的模块

例子：

```
module CommentsActions
  # actions, methods
end

class User::Picture::CommentsController <ApplicationController
  include CommentsActions
  #your additional actions
end 
```

2) 从一个控制器子类化注释控制器

例子：

```
class CommentsController < ApplicationController
  # actions, methods, filters etc...
end

class User::Picture::CommentsController < CommentsController
  #your additional actions
end 
```

# iphone - SDWebImage 在设备上不起作用

> ID：12003081
> 
> 赞同：1
> 
> 时间：2012-08-17T09:19:33.980
> 
> 标签：iphone, device, sdwebimage

大家好，我已经集成了 SDWebImage 用于从 Facebook 加载图像。在模拟器上一切正常，但是当我尝试在设备上运行时出现错误：

```
B'dayReminderPlus[415:307] -[UIImageView setImageWithURL:placeholderImage:]: unrecognized selector sent to instance 0x4f7d310

2012-08-17 14:45:15.301 B'dayReminderPlus[415:307] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIImageView setImageWithURL:placeholderImage:]: unrecognized selector sent to instance 0x4f7d310'

*** Call stack at first throw: 
```

(

```
0   CoreFoundation                      0x3759dc7b __exceptionPreprocess + 114
1   libobjc.A.dylib                     0x32d9bee8 objc_exception_throw + 40
2   CoreFoundation                      0x3759f3e3 -[NSObject(NSObject) doesNotRecognizeSelector:] + 98
3   CoreFoundation                      0x37544467 ___forwarding___ + 506
4   CoreFoundation                      0x37544220 _CF_forwarding_prep_0 + 48
5   B'dayReminderPlus                   0x000213e9 -[DLFirstScreenViewController tableView:cellForRowAtIndexPath:] + 5012
6   UIKit                               0x359600a0 -[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:withIndexPath:] + 668
7   UIKit                               0x3595fdcc -[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:] + 52
8   UIKit                               0x3595db84 -[UITableView(_UITableViewPrivate) _updateVisibleCellsNow:] + 1308
9   UIKit                               0x3595c838 -[UITableView layoutSubviews] + 208
10  UIKit                               0x358ec70c -[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 40
11  CoreFoundation                      0x37538f79 -[NSObject(NSObject) performSelector:withObject:] + 24
12  QuartzCore                          0x33d9a130 -[CALayer layoutSublayers] + 184
13  QuartzCore                          0x33d99db8 CALayerLayoutIfNeeded + 200
14  QuartzCore                          0x33d917c0 _ZN2CA7Context18commit_transactionEPNS_11TransactionE + 268
15  QuartzCore                          0x33d91518 _ZN2CA11Transaction6commitEv + 284
16  QuartzCore                          0x33dc3c28 _ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv + 88
17  CoreFoundation                      0x3752a80f __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 18
18  CoreFoundation                      0x3752a63d __CFRunLoopDoObservers + 500
19  CoreFoundation                      0x3752199d __CFRunLoopRun + 940
20  CoreFoundation                      0x3752150b CFRunLoopRunSpecific + 226
21  CoreFoundation                      0x37521419 CFRunLoopRunInMode + 60
22  GraphicsServices                    0x33e76d24 GSEventRunModal + 196
23  UIKit                               0x3591d57c -[UIApplication _run] + 588
24  UIKit                               0x3591a558 UIApplicationMain + 972
25  B'dayReminderPlus                   0x00002703 main + 106
26  B'dayReminderPlus                   0x00002694 start + 40 
```

)

```
terminate called after throwing an instance of ‘NSException’ 
```

这次崩溃即将发生：`[cell.contactImageView setImageWithURL:[NSURL URLWithString:[[contactList objectAtIndex:indexPath.row] objectForKey:PICTURE_KEY]]placeholderImage:[UIImage imageNamed:@"placeholder.png"]];`

我不清楚为什么在模拟器上运行 APP 时会发生这种崩溃。任何帮助，将不胜感激。提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-02T04:28:50.287

在设备上运行时我也遇到了这个问题。我忘记在“其他链接器标志”设置中添加“-Objc”标志。

> 添加链接器标志
> 
> 打开“Build Settings”选项卡，在“Linking”部分，找到“Other Linker Flags”设置并添加“-ObjC”标志：

# ldap - 将用户从 LDAP 导入 Liferay

> ID：12003090
> 
> 赞同：2
> 
> 时间：2012-08-17T09:19:58.947
> 
> 标签：ldap, liferay

所以，我使用 Liferay 6.1 CE，LDAP 服务器与我的所有用户和组。我想做的是将用户及其组从 LDAP 导入 Liferay。我使用以下参数在 Liferay 的控制面板中进行了配置：

## 用户

身份验证搜索过滤器：(uid=@screen_name@) 导入搜索过滤器：(objectClass=inetOrgPerson) 映射（屏幕名称--> uid，密码--> 用户密码，电子邮件地址--> 电子邮件，全名--> cn，姓氏--> sn, uuid --> uid) ...“测试 LDAP 用户”给了我一个结果，所以到目前为止我的配置是正确的！

小组的下一步：

## 团体

导入搜索过滤器： (objectClass=posixGroup) ... 用于映射（组名 --> cn ，用户 --> memberUid）

现在，当我尝试使用来自 LDAP 的凭据登录 Liferay 时，它不起作用……有什么办法解决这个问题吗？

感谢和问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-30T06:56:00.037

您可以尝试添加

```
users.screen.name.validator=com.liferay.portal.security.auth.LiberalScreenNameValidator 
```

在您的 portal-ext.properties 文件中。这允许 liferay 更好地处理用户名中的下划线和数字。

# regex - 匹配键并替换匹配键的值

> ID：12003093
> 
> 赞同：-3
> 
> 时间：2012-08-17T09:20:12.443
> 
> 标签：regex, perl, hash

测试.txt

```
name     a  b  c  d
car      1  2  0  7
tram     7  8  9  5
bus_db   1  6  3  8
cari
busi_db 
```

输出.txt

```
name     a  b  c  d
car      1  2  0  7
tram     7  8  9  5
bus_db   1  6  3  8
cari     1  2  0  7
busi_db  1  6  3  8 
```

我有一个文件，如 TEST.txt 所示，其中很少有没有值的键。我想匹配没有值的键并放置匹配的键的相同值。示例输出如图所示。

编辑：我尝试了一个更长的过程来分隔不同文件中带有和不带有值的键，然后将这些文件与额外的“i”进行比较并附加值。使用此过程我没有得到所需的输出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T12:42:05.163

该程序似乎可以满足您的要求。它期望源数据文件作为命令行上的参数

```
use strict;
use warnings;

<>;

my %data;
my @keys;

while (<>) {
  my ($key, @values) = split;
  if (@values) {
    $data{$key} = \@values;
    push @keys, $key;
  }
  else {
    (my $newkey = $key) =~ s/i(?![a-z])//i;
    my $values = $data{$newkey};
    $data{$key} = [ @$values ];
    push @keys, $key;
  }
}

my $format = "%-7s%3s%3s%3s%3s\n";
printf $format, qw/ name a  b  c  d /;
for my $key (@keys) {
  printf $format, $key, @{ $data{$key} };
} 
```

**输出**

```
name     a  b  c  d
car      1  2  0  7
tram     7  8  9  5
bus_db   1  6  3  8
cari     1  2  0  7
busi_db  1  6  3  8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:29:25.240

这是一个解决方案。这假定空键都以“i”或“i_db”结尾，并且必须删除 i 才能获得填充键。如果不是这样，则`$other_key =~ s/i(?=(_db)?$)//g;`必须更改该行以匹配您要查找的任何内容。另外，我已经把文件 I/O 留给你做。

```
use strict; use warnings;

my $header = <DATA>;
#throw away the first field name, as it will be used as the hash key
my (undef,@fields) = (split /\s+/, $header);
my %hash;

#read in the file.
while (<DATA>)
{
    my @row = split /\s+/;
    for (0..$#fields)
    {
        $hash{$row[0]}{$fields[$_]} = $row[$_+1];
    } 
}

#find cases that don't have data and fill them in.
foreach my $line (keys %hash)
{
    foreach (keys %{$hash{$line}})
    {
        unless (defined $hash{$line}{$_})
        {
            my $other_key = $line;
            #Uses a lookahead assertion to match but not delete "_db"
            $other_key =~ s/i(?=(_db)?$)//g;
            if (defined $hash{$other_key}{$_})
            {
                $hash{$line}{$_} = $hash{$other_key}{$_}
            }
        }
    }
}

#Print the output.
print $header;
foreach (keys %hash)
{
    #Uses a hash slice to get all of the values at once.
    print join (" ",$_, @{$hash{$_}}{@fields})."\n";    
}

__END__
name     a  b  c  d
car      1  2  0  7
tram     7  8  9  5
bus_db   1  6  3  8
cari
busi_db 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T13:59:06.310

让我们首先将数据导入 Perl。您将打开该文件，并将其读入第一个空格的散列拆分中。我不在乎将`a`, `b`,`c`或拆分`d`为单独的数据，因为它在程序中没有任何区别：

```
 use strict;
 use warnings;
 use autodie;

 open INPUT, "<", "TEST.txt";
 my %array;
 while my $line (<INPUT>) {
    chomp $line;
    my ($key, $data) = split /\s+/, $line, 2;
    $array{$key} = $value;
 } 
```

这将为我们提供以下信息：

```
$array{car} = "1   2   0   7";
$array{tram} = "7   8   9   5";
$array{bus_db} = "1   6   3   8";
$array{cari} = "";
$array{busi_db} = ""; 
```

现在，你***还没有***解释过：你怎么知道一个空数组成员是否*匹配*一个非空数组成员。我怎么知道`cari` *match* `car`和`busi_db` *matches* `bus_db`？它是`i`附加到末尾，但在可能的`db`后缀之前？我们应该知道他们的其他事情吗？

一旦你弄清楚了，让它们匹配就很简单了：

```
$array{busi_db} = $array{bus_db}; 
```

然后，将它们打印出来很简单。

```
 # Go through array and make "null" members match
 while my $key (sort keys %array) {
    if (not $array{$key}) { #Ah! a null array member!
        $matching_key = find_matching_key($key);
        $array{$key} = $array{$matching_key};
    }
 }

# Print them out
while my $key (sort keys %array) {
    print "$key = $array{$key}\n";
}

sub find_matching_key {
   # Here be dragons....
} 
```

问题是那个`find_matching_key`子程序。您弄清楚是什么使两个单独的键匹配，并填写详细信息。

顺便说一句，根据您的示例数据，空成员位于非空成员之后。如果这始终为真条件，则无需将*读取*循环与*合并*循环分开。不幸的是，你没有说这是否属实。

你也没有指定我是否必须按照读取的顺序打印数组。我可以保留一个键列表，并按顺序排列它们。我没有，因为它会使逻辑复杂化，你没有指定它。

* * *

请注意您的问题的低排名，以及人们将其标记为关闭的事实。这是因为您基本上说：*“我有这个问题，为我解决它”*。您也没有为解决方案提供足够的详细信息。正如我所说，您谈到了*匹配键*，但没有具体说明您的意思。

# plone - Ploneinfo（如在 phpinfo 中）

> ID：12003094
> 
> 赞同：1
> 
> 时间：2012-08-17T09:20:13.690
> 
> 标签：plone

在Plone（v 4.x）中创建“页面”的最简单（但不是很hackish-unPlonish）的方法是什么，它将显示一些Plone内部信息？我想生成一个页面文档，它将`dir()`（或任何我自己的函数）结果粘贴到`<pre/>`或类似的东西上。直截了当..我的意思是，无需创建 Plone 产品或直接修改服务器文件 - 只需使用 ZMI ..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T14:20:26.593

你想安装 plone.app.debugtoolbar

[http://pypi.python.org/pypi/plone.app.debugtoolbar/](http://pypi.python.org/pypi/plone.app.debugtoolbar/)

这使您可以访问有关当前上下文对象、请求数据等的最重要信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T14:31:52.253

Products.DocFinderTab 在 ZMI 中添加了一个“Doc”选项卡，允许您探索当前对象及其方法。如果您使用统一安装程序安装并使用“开发”配置，则它已经加载。

Products.Clouseau 可能仍然适用于最近的 Plone，尽管它已经老化。它为您提供了一个 AJAX 界面来从 Plone 中探索上下文。

最后，要探索请求对象，您可以添加：

```
<div tal:replace="structure request" /> 
```

到一个模板。这将允许您检查所有 HTTP 和表单变量以及请求中存储的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:05:41.853

转到 ZMI，添加“脚本（Python）”，并定义您的函数 dir() 并打印结果如下：

```
print dir()
return printed 
```

# vba - 使用 vba 在 Excel 中对形状进行分组和命名

> ID：12003100
> 
> 赞同：5
> 
> 时间：2012-08-17T09:20:42.897
> 
> 标签：vba, excel, shapes

在 Excel vba 中，我正在使用 vba 在 excel 中创建两个形状。一个箭头，我命名为“aro”+ i，和一个文本框，我命名为“text”+ i，其中 i 是表示照片编号的数字。

因此，假设照片 3 我将创建箭头“aro3”和文本框“text3”。

然后我想将它们分组并重命名该组“arotext”+ i，在这种情况下为“arotext3”。

到目前为止，我一直在像这样进行分组和重命名：

```
targetSheet.shapes.Range(Array(Arrow.Name, textBox.Name)).Select
Selection.group
Selection.Name = "AroTxt" & Number 
```

它在一个子中工作得很好，但现在我想把它变成一个函数并返回命名组，所以我尝试了这样的事情：

```
Dim arrowBoxGroup as Object
set arrowBoxGroup = targetSheet.shapes.Range(Array(Arrow.Name, textBox.Name))
arrowBoxGroup.group
arrowBoxGroup.Name = "AroTxt" & Number 
```

当我创建一个与已经创建的同名的新组时，我遇到了问题。因此，如果我创建第二个“aro3”和“text3”，然后尝试将它们分组并将组重命名为“arotext3”，我会收到错误消息，因为已经存在同名的组。

我不明白的是，当我使用引用选择的方法执行此操作时，如果我愿意，我可以用相同的名称重命名每个组并且不会出错。为什么在引用 Selection 对象时它可以工作，但在尝试使用分配的对象时却失败了？

更新：

由于有人问，我到目前为止的代码如下。箭头和文本框是指向用户使用表单任意定义的方向的箭头和文本框。

然后，这会在目标工作表上以正确的角度创建一个箭头，并在箭头的末尾放置一个带有指定数字（也通过表单）的文本框，以便它有效地形成一个标注。我知道有标注，但它们不符合我的要求，所以我必须自己制作。

我必须对文本框和箭头进行分组，因为 1）它们属于一起，2）我使用组的名称作为参考来跟踪已​​经放置了哪些标注，3）用户必须将标注放置在正确的位置上嵌入在工作表中的地图。

到目前为止，我已经设法通过将返回值设为 GroupObject 来将其变成一个函数。但这仍然依赖于 Sheet.Shapes.range().Select，在我看来这是一种非常糟糕的做法。我正在寻找一种不依赖于选择对象的方法。

而且我想了解为什么这在使用选择时有效，但在使用强类型变量来保存对象时失败。

```
 Public Function MakeArrow(ByVal No As Integer, ByVal angle As Double, ByVal size As ArrowSize, ByVal ArrowX As Double, ByVal ArrowY As Double, ByVal TargetInternalAngle As Double, ByRef targetSheet As Worksheet) As GroupObject

    Dim Number As String
    Dim fontSize As Integer
    Dim textboxwidth As Integer
    Dim textboxheight As Integer
    Dim arrowScale As Double
    Dim X1 As Double
    Dim Y1 As Double
    Dim X2 As Double
    Dim Y2 As Double
    Dim xBox As Double
    Dim yBox As Double
    Dim testRange As Range
    Dim arrow As Shape
    Dim textBox As Shape
'    Dim arrowTextbox As ShapeRange
'    Dim arrowTextboxGroup As Variant

    Select Case size
        Case ArrowSize.normal
            fontSize = fontSizeNormal
            arrowScale = arrowScaleNormal
        Case ArrowSize.small
            fontSize = fontSizeSmall
            arrowScale = arrowScaleSmall
        Case ArrowSize.smaller
            fontSize = fontSizeSmaller
            arrowScale = arrowScaleSmaller
    End Select
    arrowScale = baseArrowLength * arrowScale

    'Estimate required text box width
    Number = Trim(CStr(No))
    Set testRange = shtTextWidth.Range("A1")
    testRange.value = Number
    testRange.Font.Name = "ＭＳ Ｐ明朝"
    testRange.Font.size = fontSize
    shtTextWidth.Columns(testRange.Column).EntireColumn.AutoFit
    shtTextWidth.Columns(testRange.row).EntireRow.AutoFit
    textboxwidth = testRange.Width * 0.8
    textboxheight = testRange.Height * 0.9
    testRange.Clear

    'Make arrow
    X1 = ArrowX
    Y1 = ArrowY
    X2 = X1 + arrowScale * Cos(angle)
    Y2 = Y1 - arrowScale * Sin(angle)
    Set arrow = AddArrow(X1, Y1, X2, Y2, Number, targetSheet)

    'Make text box
    Set textBox = Addtextbox(angle, Number, fontSize, X2, Y2, textboxwidth, textboxheight, TargetInternalAngle, targetSheet)

    'Group arrow and test box
    targetSheet.shapes.Range(Array(arrow.Name, textBox.Name)).group.Select
    Selection.Name = "AroTxt" & Number

    Set MakeArrow = Selection

'    Set arrowTextbox = targetSheet.shapes.Range(Array(arrow.Name, textBox.Name))
'    Set arrowTextboxGroup = arrowTextbox.group
'    arrowTextboxGroup.Name = "AroTxt" & Number
'
'    Set MakeArrow = arrowTextboxGroup

End Function

Private Function AddArrow(ByVal StartX As Double, ByVal StartY As Double, ByVal EndX As Double, ByVal EndY As Double, ByVal Number As String, ByRef targetSheet As Worksheet) As Shape

    Set AddArrow = targetSheet.shapes.AddLine(StartX, StartY, EndX, EndY)
    With AddArrow
        .Name = "Aro" & Number
        With .Line
            .BeginArrowheadStyle = msoArrowheadTriangle
            .BeginArrowheadLength = msoArrowheadLengthMedium
            .BeginArrowheadWidth = msoArrowheadWidthMedium
            .ForeColor.RGB = RGB(0, 0, 255)
        End With
    End With

End Function

Private Function Addtextbox(ByVal angle As Double, ByVal Number As String, ByVal fontSize As Integer, ByVal arrowEndX As Double, ByVal arrowEndY As Double, ByVal Width As Integer, ByVal Height As Integer, ByVal LimitAngle As Double, ByRef targetSheet As Worksheet) As Shape

    Dim xBox, yBox As Integer
    Dim PI As Double
    Dim horizontalAlignment As eTextBoxHorizontalAlignment
    Dim verticalAlignment As eTextBoxVerticalAlignment

    PI = 4 * Atn(1)

    If LimitAngle = 0 Then
        LimitAngle = PI / 4
    End If

    Select Case angle
        'Right
        Case 0 To LimitAngle, 2 * PI - LimitAngle To 2 * PI
            xBox = arrowEndX
            yBox = arrowEndY - Height / 2
            horizontalAlignment = eTextBoxHorizontalAlignment.left
            verticalAlignment = eTextBoxVerticalAlignment.Center
        'Top
        Case LimitAngle To PI - LimitAngle
            xBox = arrowEndX - Width / 2
            yBox = arrowEndY - Height
            horizontalAlignment = eTextBoxHorizontalAlignment.Middle
            verticalAlignment = eTextBoxVerticalAlignment.Bottom
        'Left
        Case PI - LimitAngle To PI + LimitAngle
            xBox = arrowEndX - Width
            yBox = arrowEndY - Height / 2
            horizontalAlignment = eTextBoxHorizontalAlignment.Right
            verticalAlignment = eTextBoxVerticalAlignment.Center
        'Bottom
        Case PI + LimitAngle To 2 * PI - LimitAngle
            xBox = arrowEndX - Width / 2
            yBox = arrowEndY
            horizontalAlignment = eTextBoxHorizontalAlignment.Middle
            verticalAlignment = eTextBoxVerticalAlignment.top
    End Select

    Set Addtextbox = targetSheet.shapes.Addtextbox(msoTextOrientationHorizontal, xBox, yBox, Width, Height)
    With Addtextbox
        .Name = "Txt" & Number
        With .TextFrame
            .AutoMargins = False
            .AutoSize = False
            .MarginLeft = 0#
            .MarginRight = 0#
            .MarginTop = 0#
            .MarginBottom = 0#
            Select Case verticalAlignment
                Case eTextBoxVerticalAlignment.Bottom
                    .verticalAlignment = xlVAlignBottom
                Case eTextBoxVerticalAlignment.Center
                    .verticalAlignment = xlVAlignCenter
                Case eTextBoxVerticalAlignment.top
                    .verticalAlignment = xlVAlignTop
            End Select
            Select Case horizontalAlignment
                Case eTextBoxHorizontalAlignment.left
                    .horizontalAlignment = xlHAlignLeft
                Case eTextBoxHorizontalAlignment.Middle
                    .horizontalAlignment = xlHAlignCenter
                Case eTextBoxHorizontalAlignment.Right
                    .horizontalAlignment = xlHAlignRight
            End Select
            With .Characters
                .Text = Number
                With .Font
                    .Name = "ＭＳ Ｐ明朝"
                    .FontStyle = "標準"
                    .size = fontSize
                    .Strikethrough = False
                    .Superscript = False
                    .Subscript = False
                    .OutlineFont = False
                    .Shadow = False
                    .Underline = xlUnderlineStyleNone
                    .ColorIndex = xlAutomatic
                End With
            End With
        End With
        .Fill.Visible = msoFalse
        .Fill.Solid
        .Fill.Transparency = 1#
        With .Line
            .Weight = 0.75
            .DashStyle = msoLineSolid
            .style = msoLineSingle
            .Transparency = 0#
            .Visible = msoFalse
        End With
    End With

End Function 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T00:35:30.733

Range.Group 返回一个值。你可以试试：

```
Set arrowBoxRange = targetSheet.shapes.Range(Array(Arrow.Name, textBox.Name))
Set arrowBoxGroup = arrowBoxRange.Group
arrowBoxGroup.Name = "AroTxt" & Number 
```

我怀疑当前的选择会像您早期工作中的以下内容一样更新：

```
Set Selection = Selection.Group  'it's as if this is done for you when you create the group. 
```

这导致了差异。

仅供参考，我使用的是 Excel 2010，无法复制基于 Selection 的原始代码片段（我在执行“Selection.Name =”时出错，这使得对象不支持属性。）

好的，我可以让它工作：

```
Selection.Group.Select
Selection.Name = "AroTxt" 
```

当然，就像我建议的其他片段一样，这会重新分配组的返回值，以便 Selection.Group 和 Selection.Name 中的 Selection 引用不同的对象，我认为这就是你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T12:48:52.180

这是因为您现在手动将新组存储为对象，所以出现了此错误。您可能无法对您创建的多个***“AroTxt”和 Number实例执行任何操作。***由于 excel 无法确定您指的是哪个组。

Excel 不应该允许这样做，但它并不总是警告这已经发生，但如果您尝试选择具有重复名称的组，则会出错。

即使不是这种情况，使用重复的变量名也不是一个好习惯。将额外的箭头和文本框添加到组中不是更好吗？

因此，要解决您的问题，您必须在保存之前检查该组是否已经存在。如果存在，则可能将其删除或添加到组中。

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T14:21:41.163

**编辑：**正如它似乎总是发生的那样，在我单击提交后错误开始弹出。我会多做一些修改，但会回应@royka，想知道您是否真的需要为多个形状赋予相同的名称。

下面的代码似乎可以满足您的需求（创建形状，给它们命名然后分组）。在分组功能中，我将“AroText”编号保持不变，只是为了看看是否会发生错误（它没有发生）。看起来这两个形状具有相同的名称，但它们的区别在于它们的`Shape.ID`. 据我所知，如果您说`ActiveSheet.Shapes("My Group").Select`，它将选择具有最低 ID 的名称的元素（至于为什么它允许您将两个事物命名为相同的名称，不知道 :) ）。

这不是您“为什么”问题的答案（我无法复制错误），但这有望为您提供一种“如何”的方法。

```
Sub SOTest()

Dim Arrow As Shape
Dim TextBox As Shape
Dim i as Integer
Dim Grouper As Variant
Dim ws As Worksheet

Set ws = ActiveSheet

' Make two shapes and group, naming the group the same in both cases
For i = 1 To 2
  ' Create arrow with name "Aro" & i
  Set Arrow = ws.Shapes.AddShape(msoShapeRightArrow, 10, 50, 30, 30)
  Arrow.Name = "Aro" & i

  ' Create text box with name "Text" & i
  Set TextBox = ws.Shapes.AddTextbox(msoTextOrientationHorizontal, 50, 50, 40, 40)
  TextBox.Name = "Text" & i

  ' Use a group function to rename the shapes
  Set Grouper = CreateGroup(ws, Arrow, TextBox, i)

  ' See the identical names but differing IDs
  Debug.Print "Name: " & Grouper.Name & " | ID: " & Grouper.ID
Next

End Sub

Function CreateGroup(ws As Worksheet, Arrow As Shape, TextBox As Shape, Number As Integer) As Variant

Dim arrowBoxGroup As Variant

' Group the provided shapes and change the name
Set arrowBoxGroup = ws.Shapes.Range(Array(Arrow.Name, TextBox.Name)).Group
arrowBoxGroup.Name = "AroTxt" & Number

' Return the grouped object
Set CreateGroup = arrowBoxGroup

End Function 
```

# file-upload - 具有拖放支持和预览功能的 OpenLaszlo 图像上传组件

> ID：12003102
> 
> 赞同：2
> 
> 时间：2012-08-17T09:20:45.673
> 
> 标签：file-upload, drag-and-drop, flash, dhtml, openlaszlo

我还没有看到任何适用于 OpenLaszlo 的好的文件上传组件。是否有文件上传组件的开源版本，它支持 DHTML 和 Adob​​e AIR 的拖放，以及两个运行时的预览功能？

从技术上讲，可以支持以下功能：

*   适用于所有桌面浏览器的 DHTML 拖放文件上传[http://caniuse.com/#feat=dragndrop](http://caniuse.com/#feat=dragndrop)
*   以 DHTML 格式预览 Webkit 浏览器和 Firefox 以及所有使用 SWF 运行时的浏览器的图像
*   对 Adob​​e Air 应用程序的拖放支持

也许有人有一个现有的组件可以开源，并由社区维护或改进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T17:21:21.447

目前无法在 OpenLaszlo 应用程序的 DHTML（又名 HTML5）模式下进行文件上传，因为不幸的是，在该运行时无法将表单类型设置为 enctype=multipart/form-data。

但是，您可以通过访问低级 Flash API 使用 OpenLaszlo 应用程序的 SWF(Flash) 模式执行文件上传。如何做到这一点并不明显，所以我不久前自己编写了一个类来做到这一点，它将在 OpenLaszlo 的 (Flash) SWF8、SWF9 和 SWF10 模式下工作。

我从未尝试将 OpenLaszlo 应用程序编译到 AIR，但我相信 Flash Upload 也可能适用于这种情况。

这是我的课程，请随意使用：

（代码也可以在这里找到：http: [//forum.openlaszlo.org/showthread.php?](http://forum.openlaszlo.org/showthread.php?t=14566&highlight=fileReference) t=14566&highlight=fileReference ）

```
<library>

<switch>

  <when property="$as3"><!-- SWF9/SWF10 -->

    <!---
    CLASS: <fileuploadhelper>
    EXTENDS: <node> (lz.node)

    DESCRIPTION:

    This is the ActionScript3 (AS3) (SWF9/SWF8) version of the Flash file
    upload object.

    This allows users to upload files when compiled to a Flash Version that
    uses ActionScript3 such as Flash 9 or Flash 10.
    -->
    <class name="fileuploadhelper" extends="node">

      <!---
      @param string uploadurl: (optional) default upload url to use if none
                               passed to this.upload()
      -->
      <attribute name="uploadurl" type="string" />

      <!-- @keywords private -->
      <!--- @param flash.net.FileReference file_reference: Flash file reference object -->
      <attribute name="file_reference" type="expression" value="null" />

      <!-- Imports Required for SWF9/SWF10 -->

      <passthrough>
        import flash.net.FileReference;
        import flash.events.Event;
        import flash.events.ProgressEvent;
        import flash.events.IOErrorEvent;
        import flash.events.SecurityErrorEvent;
        import flash.net.URLRequest;
      </passthrough>

      <!-- *** METHODS *** -->

      <handler name="oninit">
      <![CDATA[

        #passthrough  {
           this.file_reference = new FileReference();

           file_reference.addEventListener(Event.SELECT,this.onSelect);
           file_reference.addEventListener(Event.COMPLETE, this.onComplete);
           file_reference.addEventListener(ProgressEvent.PROGRESS, this.progressHandler);
           file_reference.addEventListener(IOErrorEvent.IO_ERROR, this.ioErrorHandler);
           file_reference.addEventListener(SecurityErrorEvent.SECURITY_ERROR, this.securityErrorHandler);

        }#

      ]]>
      </handler>

      <!---
      Displays file browsing window and allows the user to select a file (or
      cancel to close the window).
      -->
      <method name="browse">
      <![CDATA[

        #passthrough  {
           file_reference.browse();
        }#

      ]]>
      </method>

      <!---
      Return name of selected file

      @returns string: the filename of the selected file
      -->
      <method name="getName">
        return this.file_reference.name;
      </method>

      <!--- @keywords private -->
      <!---
      @param string submit_url: SWF9/10 #passthrough{...} requires URL to be
                                referenced in an attribute rather than a
                                locally defined OpenLaszlo variable or
                                a compilation error occurs.
      -->
      <attribute name="submit_url" type="string" />

      <!---
      Uploads the currently selected file.

      @param string strURL: (optional) If defined upload the file to this
                            URL, otherwise upload to this.uploadurl

                            Note: required if this.uploadurl is not defined.
      -->
      <method name="upload" args="strURL = false">
      <![CDATA[

        if (strURL === false)
          var strURL = this.uploadurl; // workaround for SWF9/10 compatibility

        this.setAttribute('submit_url', strURL);

        #passthrough  {
           var request:URLRequest = new URLRequest(submit_url);
           file_reference.upload(request);
        }#

      ]]>
      </method>

      <!-- * ABSTRACT handlers: Override to do something useful in instance * -->

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when user selects a file.

      @param flash.events.Event ev: the select event
      -->
      <method name="onSelect" args="ev=null">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onSelect(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when progress event is captured.

      @param {anything} objDummy: SWF8 requires file_reference object here, does nothing in SWF9/10
      @param number bytesLoaded: the number of bytes of the file uploaded
      @param number bytesTotal: the number of total bytes of the file to be uploaded
      -->
      <method name="onProgress" args="objDummy, bytesLoaded, bytesTotal">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onProgress(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when a file upload is complete.

      @param flash.events.Event ev: the complete event
      -->
      <method name="onComplete" args="ev=null">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onComplete(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when the file upload fails.

      @param flash.events.IOErrorEvent/flash.events.securityErrorEvent ev: the Flash Error Event
      -->
      <method name="onError" args="ev=null">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onError(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

      <!-- * Internal Private Handlers * -->

      <!--- @keywords private -->
      <!---
      This will pass the progress values to method this.onProgress()

      @param flash.events.ProgressEvent ev: the Flash Progress Event
      -->
      <method name="progressHandler" args="ev=null">
        this.onProgress(false, ev.bytesLoaded, ev.bytesTotal);
      </method>

      <!--- @keywords private -->
      <!---
      This will catch an ioError and call method this.onError()

      @param flash.events.IOErrorEvent ev: the Flash Error Event
      -->
      <method name="ioErrorHandler" args="ev=null">
        if ($debug) Debug.error('as3 (SWF9/10): fileuploadhelper.ioErrorHandler(): ERROR: ioError detected, could not upload file.');
        this.onError(ev);
      </method>

      <!--- @keywords private -->
      <!---
      This will catch a securityError and call method this.onError()

      @param flash.events.securityErrorEvent ev: the Flash Error Event
      -->
      <method name="securityErrorHandler" args="ev=null">
        if ($debug) Debug.error('as3 (SWF9/10): fileuploadhelper.securityErrorHandler(): ERROR: securityError detected. Are you sure you are uploading to same domian as this application is being served from?');
        this.onError(ev);
      </method>

    </class>

  </when>

  <when property="$as2"><!-- SWF8 -->

    <!---
    CLASS: <fileuploadhelper>
    EXTENDS: <node> (lz.node)

    DESCRIPTION:

    This is the ActionScript2(AS2) (SWF8) version of the Flash file
    upload object.

    This allows users to upload files when compiled to a Flash Version that
    uses ActionScript2 such as Flash 8
    -->
    <class name="fileuploadhelper" extends="node">

      <!---
      @param string uploadurl: (optional) default upload url to use if none
                               passed to this.upload()
      -->
      <attribute name="uploadurl" />

      <!--- @keywords private -->
      <!--- @param flash.net.FileReference file_reference: Flash file reference object -->
      <attribute name="file_reference" />

      <!-- *** METHODS *** -->

      <handler name="oninit" args="invoker">
        fr = new flash.net.FileReference();
        this.setAttribute('file_reference', fr);
        fr.addListener(invoker);
      </handler>

      <!-- *** METHODS *** -->

      <!---
      Displays file browsing window and allows the user to select a file (or
      cancel to close the window).
      -->
      <method name="browse">
        this.file_reference.browse();
      </method>

      <!---
      Return name of selected file

      @returns string: the filename of the selected file
      -->
      <method name="getName">
        return this.file_reference.name;
      </method>

      <!---
      Uploads the currently selected file.

      @param string strURL: (optional) If defined upload the file to this
                            URL, otherwise upload to this.uploadurl

                            Note: required if this.uploadurl is not defined.
      -->
      <method name="upload" args="strURL">

        if (strURL == null)
          var strURL = this.uploadurl;

        this.file_reference.upload(strURL);

      </method>

      <!-- * ABSTRACT HANDLERS * -->

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when user selects a file.

      @param flash.events.Event ev: the select event
      -->
      <method name="onSelect" args="ev=null">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onSelect(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when progress event is captured.

      @param flash.net.fileReference fr: file_reference object here
      @param number bytesLoaded: the number of bytes of the file uploaded
      @param number bytesTotal: the number of total bytes of the file to be uploaded
      -->
      <method name="onProgress" args="fr, bytesLoaded, bytesTotal">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onProgress(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when a file upload is complete.

      @param flash.events.Event fr: the file_reference object
      -->
      <method name="onComplete" args="fr=null">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onComplete(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

      <!--- @keywords abstract -->
      <!---
      ABSTRACT METHOD: OVERRIDE IN YOUR APPLICATION TO DO SOMETHING USEFUL

      Called when the file upload fails.

      @param flash.events.Event fr: the file_reference object
      -->
      <method name="onError" args="fr=null">
        if ($debug) Debug.info('as3 (SWF9/10): fileuploadhelper.onError(): WARNING: This is an abstract method that should be overridden in your application to do something useful...');
      </method>

    </class>

  </when>

</switch>

</library> 
```

注意：这类似于 HTML 表单，您将文件上传到后端的接收脚本（可能是 PHP、ASP 等），该脚本将处理文件并将其存储在某处，网上有很多教程关于如何做到这一点，所以我没有包括它。至于拖放和预览，您必须自己在 OpenLaszlo 中编写一个相当复杂的应用程序才能执行此操作，我建议您查看[教程](http://www.openlaszlo.org/node/409#Laszlo10)和[OpenLaszlo 文档](http://www.openlaszlo.org/documentation)以了解如何执行此操作。

# javascript - 资源解释为脚本，但使用 MIME 类型 text/plain 传输 - 用于本地文件

> ID：12003107
> 
> 赞同：97
> 
> 时间：2012-08-17T09:21:13.113
> 
> 标签：javascript, html, google-chrome, mime-types

包含本地脚本文件时，我在 Google Chrome 中收到“资源解释为脚本但使用 MIME 类型文本/纯文本传输”警告。

我知道从服务器或通过 ajax 加载文件时会出现问题，这通常取决于设置了错误的标头。

奇怪的是，即使它是从本地文件夹运行的，我也会收到此警告：`file:///C:/test/foo.html`

这只发生在具有最基本 html 的 Chrome 中：

```
<!DOCTYPE html>
    <html>
    <head>
        <script type="text/javascript" src="bar.js"></script>
    </head>
    <body>
    </body>
</html> 
```

bar.js 也很简单：

```
function hello() {} 
```

我试过添加一个元标记：

```
<meta http-equiv="content-script-type" content="text/javascript"> 
```

并用其他文档类型进行了测试，但似乎没有任何帮助。

这显然不是一个真正的问题，因为脚本仍然可以正常工作，但我正在处理一个大型项目，目前包含大约 150 个脚本。因此，很难看到它们之间何时发生实际警告。

当我在本地或远程服务器上运行文件时，一切正常。

关于为什么 chrome 让我烦恼的任何想法？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2012-08-21T14:47:46.820

我想到了！

Visual Studio 安装程序必须已将错误行添加到注册表。

打开`regedit`并查看此注册表项：

![在此处输入图像描述](../Images/23816ee9f2fd288645fec31d9a1c673c.png)

看到那把钥匙了吗？内容类型键？**将其值从 text/plain 更改为 text/javascript。**

终于铬可以再次轻松呼吸。

我应该注意的是，在 Windows 7 上默认情况下既不存在 Content Type 也不存在 PercievedType，因此您可能可以安全地删除它们，但您需要做的最低限度是编辑。

无论如何，我希望这也能为您解决问题！

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-06-24T19:50:44.710

我尝试使用此方法解决此问题，但它对我不起作用。

我的问题是 IIS 管理器在 HTTP 功能中没有 MIME 类型。

我可以通过启用静态上下文来打开它...

--> 控制面板

--> 程序

--> 打开或关闭 Windows 功能

--> 互联网信息服务

--> 万维网服务

--> 常见的 HTTP 特性

**--> [X] 静态内容。**

在此之后，MIME 类型出现了，一切又开始工作了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-26T11:11:16.340

接受的答案是一个很好的答案！但是，只是为那些遇到像我这样的问题的人发布答案，他们有时使用部门/大学计算机，我无权更改 regedit 中的任何键值。

改变

`<script type="text/javascript" src="main.js"></script>`

到

`<script src="main.js"></script>`

虽然错误信息仍然存在，但页面加载正确。

# c# - 如何指定 Streamwriter 路径位置

> ID：12003110
> 
> 赞同：-1
> 
> 时间：2012-08-17T09:21:15.343
> 
> 标签：c#, c#-4.0

我想使用 StreamWriter 将文本写入文件。但文件名应该是当前日期名称。这是我的编码。有人可以告诉我如何指定文件创建路径吗？

代码编辑：在这里我想创建一个 .txt 文件，但在这里没有创建文件。

```
public void WriteToFile( string name, string source, int dest, string messageIn, string operatorNew)
{
   string directory = ResolveUrl("~/DesktopModules/SMSFunction/SMSText");
   string filename = String.Format("{0:yyyy-MM-dd}__{1}", DateTime.Now,name);
   string path = Path.Combine(directory, filename);

   if (!File.Exists(filename))
   {

       using (StreamWriter str = File.CreateText(path))
       {
           str.WriteLine("msisdn: " + source);
           str.WriteLine("shortcode : " + dest);
           str.WriteLine("Message : " + messageIn);
           str.WriteLine("Operator :" + operatorNew);
           str.Flush();

       }
   }
   else if (File.Exists(filename))
   {

       using (var str = new StreamWriter(filename)) 

       {
           str.WriteLine("msisdn: " + source);
           str.WriteLine("shortcode : " + dest);
           str.WriteLine("Message : " + messageIn);
           str.WriteLine("Operator :" + operatorNew);
           str.Flush();
       }

   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T11:45:22.383

您需要进行以下更改

1.`ResolveUrl`替换为`Server.MapPath`

```
string directory = Server.MapPath("~/DesktopModules/SMSFunction/SMSText"); 
```

2.添加文件扩展名`.txt`，如下图

```
string filename = String.Format("{0:yyyy-MM-dd}__{1}.txt", DateTime.Now,name); 
```

3.当你检查文件是否存在时，提供文件的路径，而不是文件名

```
File.Exists(path); 
```

4.block下`else if`，这里也提供路径，而不是文件名

```
var str = new StreamWriter(path)); 
```

将所有代码放在一起看起来像，

```
 string directory = Server.MapPath("~/DesktopModules/SMSFunction/SMSText");
 string filename = String.Format("{0:yyyy-MM-dd}__{1}.txt", DateTime.Now, name);
 string path = Path.Combine(directory, filename);

    if (!File.Exists(path))
    {
        using (StreamWriter str = File.CreateText(path))
        {
            str.WriteLine("msisdn: " + source);
            str.WriteLine("shortcode : " + dest);
            str.WriteLine("Message : " + messageIn);
            str.WriteLine("Operator :" + operatorNew);
            str.Flush();
        }
    }
    else if (File.Exists(path))
    {
        using (var str = new StreamWriter(path))
        {
            str.WriteLine("msisdn: " + source);
            str.WriteLine("shortcode : " + dest);
            str.WriteLine("Message : " + messageIn);
            str.WriteLine("Operator :" + operatorNew);
            str.Flush();
     } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T09:31:28.937

`File.Create`回报`FileStream`，你需要`StreamWriter`。您必须使用接受的构造函数`Stream`：

```
using (var str = new StreamWriter(File.CreateText(path))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T11:34:20.553

简化，使用 FileStream 创建或覆盖您的文件（见下文），具体取决于您可能希望将[FileMode](http://msdn.microsoft.com/en-us/library/system.io.filemode.aspx)更改为其他内容（附加？）

```
public void WriteToFile(string name, string source, int dest, string messageIn, string operatorNew)
{
    string directory = ResolveUrl("~/DesktopModules/SMSFunction/SMSText");
    string filename = String.Format("{0:yyyy-MM-dd}__{1}", DateTime.Now,name);
    string path = Path.Combine(directory, filename);

    using (FileStream fs = new FileStream(path, FileMode.Create))
    {
        using (StreamWriter str = new StreamWriter(fs))
        {
            str.WriteLine("msisdn: " + source);
            str.WriteLine("shortcode : " + dest);
            str.WriteLine("Message : " + messageIn);
            str.WriteLine("Operator :" + operatorNew);
            str.Flush();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-24T19:21:38.320

假设您的控制台应用程序项目名称是 DataPrep。现在您可以通过创建一个名为 db.json 的新文件来写入数据目录位置

```
string filePath = Path.GetFullPath(Path.Combine(Environment.CurrentDirectory, @"..\..\..\")) + @"Data\db.json";
            if (!File.Exists(filePath))
            {
                using (StreamWriter _streamWriter = File.CreateText(filePath))
                {
                    _streamWriter.Write(resultAll);
                    _streamWriter.Flush();
                }
            }
            else if (File.Exists(filePath))
            {
                using (var _streamWriter = new StreamWriter(filePath))
                {
                    _streamWriter.Write(resultAll);
                    _streamWriter.Flush();
                }

            } 
```

# jquery-ui - Yii Clistview 内的手风琴 - 不工作

> ID：12003113
> 
> 赞同：1
> 
> 时间：2012-08-17T09:21:26.343
> 
> 标签：jquery-ui, jquery, yii

我在使用 ajax 手风琴停止工作的页面加载时使用 Yii 框架组件 CLISTVIEW

我试过跟随，但没有用

```
$(".items").on('load',function(){
$(this).accordion(); 
```

});

**当我在**表单加载中更改事件类型以***单击***它开始工作。在这里调用的正确事件类型是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:25:33.027

Accordion 插件需要这样的内容：

```
<h3>Section 1</h3>
<div>
    <p>Content section 1</p>
</div>
<h3>Section 2</h3>
<div>
    <p>Content section 2</p>
</div> 
```

但是，如果我了解您的情况，您就会有这样的代码：

```
<body>
    <div class="items">
        <h3>Section 1</h3>
        <div>
            <p>Content section 1</p>
        </div>
    </div>
    <div class="items">
        <h3>Section 2</h3>
        <div>
            <p>Content section 2</p>
        </div>
    </div>
</body> 
```

使用此脚本，我首先 .wrapAll .items 元素，然后根据手风琴插件的需要重写元素：

```
 <script>
        $(function() {
            $('.items').wrapAll($('<div>').attr('id','accordion'));
            $.each($('.items'),function(){
                $(this).remove();
                $('#accordion').append($(this).html());
            });
            $('#accordion').accordion();
        });
    </script> 
```

HTML 将是：

```
<div id="accordion">
    <h3>Section 1</h3>
    <div>
       <p>Content section 1</p>
    </div>
    <h3>Section 2</h3>
    <div>
        <p>Content section 2</p>
    </div>
</div> 
```

手风琴会很好用。

# javascript - How to control input values?

> ID：12003114
> 
> 赞同：0
> 
> 时间：2012-08-17T09:21:25.540
> 
> 标签：javascript, jquery, ajax, html

I use 2 same inputs at search form. I want to control data typing. For example, user enter time or price in any interval. Second value must be larger than first. **How to make user can not enter larger value to second field?**

For date:

```
@Html.TextBox( "date1", string.Empty, new { @class = "dateClass", type_datepicker = "true", @id = "datepicker" } )
@Html.TextBox( "date2", string.Empty, new { @class = "dateClass", type_datepicker = "true", @id = "datepicker2" } ) 
```

and for price:

```
@Html.TextBox( "price1", string.Empty, new { @class = "priceClass" } )
@Html.TextBox( "price2", string.Empty, new { @class = "priceClass" } ) 
```

*date1* and *date2* are string, *price1* and *price2* are double. Sorry for my bad english..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:00:31.237

You need to tweak this so it matches whatever your backend code is returning back

You have a few options here, you can either validate when the user submits the form or when the user stops typing. At submit is pretty straight forward

```
if ($('#second').val() > $('#first').val()){
      return false;
   } 
```

For comparing dates, [check this out](https://stackoverflow.com/questions/492994/compare-2-dates-with-javascript)

Or you can do it when user stops typing, thanks to [this great answer](https://stackoverflow.com/questions/4220126/run-javascript-function-when-user-finishes-typing-instead-of-on-key-up) you can do this

```
$(document).ready(function(){
var typingTimer;                //timer identifier
var doneTypingInterval = 1000;  //time in ms, 1 second for example

 //on keyup, start the countdown
$('#second').keyup(function(){
    typingTimer = setTimeout(doneTyping, doneTypingInterval);
 });

 //on keydown, clear the countdown
    $('#second').keydown(function(){
    clearTimeout(typingTimer);
  });

 //user is "finished typing," do something
  function doneTyping () {
     if ($('#second').val() > $('#first').val()){
      alert('cannot do that');        //take whatever action you need here
   }
  }
}); 
```

Also, for datepickers, if you are using [jQuery UI datepicker](http://jqueryui.com/demos/datepicker/), there is an option to specify disabling certain date ranges, so you can use that to disable anything earlier than the value of the first datepicker (but again all that is just client side checks, if this is crucial to your application you will have to do back-end checks as well in C# or whatever language you are using)

# css - CSS '你没有颜色设置 [...]' 警告

> ID：12003115
> 
> 赞同：3
> 
> 时间：2012-08-17T09:21:27.467
> 
> 标签：css, colors, warnings, w3c

这个警告应该是直截了当的，但我不知道出了什么问题。

W3C 验证器的确切警告消息是：`You have no color set (or color is set to transparent) but you have set a background-color. Make sure that cascading of colors keeps the text reasonably legible.`

这是发生警告的CSS：

```
body {
    background-image: url('./img/bg1.jpg');
    background-position: center top;
    background-repeat: no-repeat;
    color: #ffffff;
    background-color: #007e29; /* <-- This is the line where the warning occurs */
} 
```

根据 W3C 文档和一些谷歌搜索，很明显，对于每个元素，都`background-color`必须有`color`属性。但这就是我在做什么？该`color`属性设置为白色和`background-color`深绿色。

那么上面的 CSS 有什么问题呢？我确定我在这里遗漏了一些东西......在此先感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T11:24:34.647

发布的 CSS 代码不会引起这样的警告。如果没有完整的示例，就无法分析为什么 CSS Validator 似乎会警告错误的行。

无论如何，当人们对这个警告感到困惑时，原因是他们已经`body`为内部元素设置了例如背景和内容颜色，并且只有其中一个属性。人们经常假设内部的任何元素都`body`从 继承颜色`body`，但这并不一定会在其他样式表参与时发生。这就是 CSS Validator 对这种情况发出警告的原因。这只是一个潜在的问题，不会经常发生，但仍然存在风险。

# c# - 如何在网络上的类库中获取运行路径？

> ID：12003121
> 
> 赞同：1
> 
> 时间：2012-08-17T09:21:59.107
> 
> 标签：c#, asp.net, .net, xml

我有一个名为“fAgent.dll”的类库，我在两个应用程序中使用这个 dll 文件。一个应用程序是桌面应用程序，另一个是网络应用程序。此 dll 文件必须读取 bin 文件或 xml 文件。我可以像这样在桌面上打开 bin 文件：

```
FileStream fs = new FileStream(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\MyApp\\ConnSettings.bin", FileMode.Open); 
```

如果 dll 找不到 bin 文件，它会尝试读取这样的 xml 文件：

```
XmlDocument doc = new XmlDocument();
var path = (new System.Uri(System.Reflection.Assembly.GetExecutingAssembly().CodeBase)).AbsolutePath;
doc.Load(path + "\fCns.xml"); 
```

在 FileNotFoundException 上，它尝试以下代码：

```
XmlDocument doc = new XmlDocument();
System.Reflection.Assembly asm = System.Reflection.Assembly.GetAssembly(typeof(fAgent.Tools));
string asmPath = asm.CodeBase;
doc.Load(asmPath.Replace("fAgent.DLL", "fCns.xml")); 
```

xml 文件和 dll 文件在同一个文件夹中。它可以在桌面上运行，但不能在网络上运行。我必须在不使用 Mappath 功能的情况下获取网络上的“~/bin”文件夹。我怎样才能做到这一点？

感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:35:11.297

使用[HttpRuntime.BinDirectory](http://msdn.microsoft.com/en-us/library/system.web.httpruntime.bindirectory.aspx)属性甚至更好 - 将文件放入`App_Data`文件夹而不是 bin 中，就像您将修改 bin 文件夹中的文件一样，应用程序将重新启动

```
var filePath = System.IO.Path.Combine(HttpRuntime.BinDirectory, "ConnSettings.bin"); 
```

# php - Yii cookie 记住密码

> ID：12003124
> 
> 赞同：2
> 
> 时间：2012-08-17T09:22:03.323
> 
> 标签：php, cookies, yii

我在动作登录中创建 cookie 身份验证，但在另一个控制器或另一个动作中，我调用它，但它只是回显用户名，没有别的。

例如：

```
class LoginController extends Controller
{
    public function actionIndex()
    {  
       if (isset($_POST['UserLogin'])) {
            $username = $_POST['UserLogin']['email'];
            $password = $_POST['UserLogin']['password'];
            $dataLogin = Users::model()->findByAttributes(array('email'=>$username, 'password'=>md5($password), 'role'=>1, 'status'=>1));
            if($dataLogin == NULL) {
               Yii::app()->user->setFlash('login_mess',Yii::t('app','Invalid email or password!'));
               $this->redirect($_SERVER['HTTP_REFERER']);
            }
            else{

                Yii::app()->session['Authentication'] = $dataLogin;

                $cookies = new CHttpCookie('authentication', $dataLogin);
                $cookies->expire = time() + 7*24*60*60;
                Yii::app()->request->cookies['authentication'] = $cookies;

                $this->redirect('/profile');
            }
       }
    }
    public function actionLogout()
    {
       echo "<pre>";
        print_r(Yii::app()->request->cookies['authentication']);die;
        echo "</pre>";
        Yii::app()->session['Authentication'] = null;
        $this->redirect('/');
    }
} 
```

在 actionLogout 我尝试打印该 cookie：

```
CHttpCookie Object
(
    [name] => authentication
    [value] => Bàn Chân Trần
    [domain] => 
    [expire] => 0
    [path] => /
    [secure] => 
    [httpOnly] => 
    [_e:CComponent:private] => 
    [_m:CComponent:private] => 
) 
```

但我希望：

```
CHttpCookie Object
(
    [name] => authentication
    [value] => Users Object
        (
            ....

            [_new:CActiveRecord:private] => 
            [_attributes:CActiveRecord:private] => Array
                (
                    [id] => 4
                    [name] => Bàn Chân Trần
                    [email] => hongquan156@gmail.com
                    [phone_code] => +44
                    [phone] => 0988888888
                    [country] => 2
                    [language] => vi
                    [password] => 
                    [role] => 1
                    [device_token] => 
                    [active_key] => 9D9T7n1oWlFiRy1EJ3ULDVlBDtw4VQWT
                    [status] => 1
                    [token] => 
                    [payment] => 0
                    [created] => 
                )

            [_related:CActiveRecord:private] => Array
                (
                )

            [_c:CActiveRecord:private] => 
            [_pk:CActiveRecord:private] => 4
            [_alias:CActiveRecord:private] => t
            [_errors:CModel:private] => Array
                (
                )

            [_validators:CModel:private] => 
            [_scenario:CModel:private] => update
            [_e:CComponent:private] => 
            [_m:CComponent:private] => 
        )

    [domain] => 
    [expire] => 1345801074
    [path] => /
    [secure] => 
    [httpOnly] => 
    [_e:CComponent:private] => 
    [_m:CComponent:private] => 
) 
```

我该如何解决这个问题...谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:00:01.580

由于您要将对象存储到 cookie，因此必须在将其存储到 cookie 之前对其进行序列化，并在检索到它之后对其进行反序列化：

```
$cookies = new CHttpCookie('authentication', serialize($dataLogin));

print_r(unserialize(Yii::app()->request->cookies['authentication']));die; 
```

# sql - Oracle <> , != , ^= 运算符

> ID：12003127
> 
> 赞同：11
> 
> 时间：2012-08-17T09:22:16.937
> 
> 标签：sql, database, performance, oracle, query-optimization

我想知道这些运营商的区别，主要是他们的性能差异。

我看过[SQL 中 <> 和 != 之间的区别](https://stackoverflow.com/questions/5856439/difference-between-and-in-sql)，它没有与性能相关的信息。

然后我在[dba-oracle.com](http://www.dba-oracle.com/t_not_equal_operator.htm)上找到了这个，它表明在 10.2 以后的性能可能会大不相同。

我想知道为什么？那么`!=`总是表现更好`<>`吗？

注意：我们的测试和实时系统显示的性能，从 更改为`<>`对`!=`查询返回的时间有很大影响。我在这里问为什么会发生这种情况，而不是它们是否相同。我从语义上知道它们是，但实际上它们是不同的。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-20T12:44:41.860

我已经测试了 Oracle 中不等于运算符的不同语法的性能。我试图消除对测试的所有外部影响。

我正在使用 11.2.0.3 数据库。没有连接其他会话，并且在开始测试之前重新启动了数据库。

使用单个表和主键序列创建了模式

```
CREATE TABLE loadtest.load_test (
  id NUMBER NOT NULL,
  a VARCHAR2(1) NOT NULL,
  n NUMBER(2) NOT NULL,
  t TIMESTAMP NOT NULL
);

CREATE SEQUENCE loadtest.load_test_seq
START WITH 0
MINVALUE 0; 
```

该表已编入索引以提高查询性能。

```
ALTER TABLE loadtest.load_test
ADD CONSTRAINT pk_load_test
PRIMARY KEY (id)
USING INDEX;

CREATE INDEX loadtest.load_test_i1
ON loadtest.load_test (a, n); 
```

使用序列将一千万行添加到表中，`SYSDATE`时间戳和随机数据通过 DBMS_RANDOM (AZ) 和 (0-99) 用于其他两个字段。

```
SELECT COUNT(*) FROM load_test;

COUNT(*)
----------
10000000

1 row selected. 
```

分析模式以提供良好的统计数据。

```
EXEC DBMS_STATS.GATHER_SCHEMA_STATS(ownname => 'LOADTEST', estimate_percent => NULL, cascade => TRUE); 
```

三个简单的查询是：-

```
SELECT a, COUNT(*) FROM load_test WHERE n <> 5 GROUP BY a ORDER BY a;

SELECT a, COUNT(*) FROM load_test WHERE n != 5 GROUP BY a ORDER BY a;

SELECT a, COUNT(*) FROM load_test WHERE n ^= 5 GROUP BY a ORDER BY a; 
```

除了不等于运算符的语法（不仅是 <> 和 != ，还有 ^= ）之外，它们完全相同

首先，每个查询都在不收集结果的情况下运行，以消除缓存的影响。

下一次计时和自动跟踪已打开，以收集查询的实际运行时间和执行计划。

```
SET TIMING ON

SET AUTOTRACE TRACE 
```

现在查询依次运行。首先是<>

```
> SELECT a, COUNT(*) FROM load_test WHERE n <> 5 GROUP BY a ORDER BY a;

26 rows selected.

Elapsed: 00:00:02.12

Execution Plan
----------------------------------------------------------
Plan hash value: 2978325580

--------------------------------------------------------------------------------------
| Id  | Operation             | Name         | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT      |              |    26 |   130 |  6626   (9)| 00:01:20 |
|   1 |  SORT GROUP BY        |              |    26 |   130 |  6626   (9)| 00:01:20 |
|*  2 |   INDEX FAST FULL SCAN| LOAD_TEST_I1 |  9898K|    47M|  6132   (2)| 00:01:14 |
--------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("N"<>5)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
      22376  consistent gets
      22353  physical reads
          0  redo size
        751  bytes sent via SQL*Net to client
        459  bytes received via SQL*Net from client
          3  SQL*Net roundtrips to/from client
          1  sorts (memory)
          0  sorts (disk)
         26  rows processed 
```

下一个！=

```
> SELECT a, COUNT(*) FROM load_test WHERE n != 5 GROUP BY a ORDER BY a;

26 rows selected.

Elapsed: 00:00:02.13

Execution Plan
----------------------------------------------------------
Plan hash value: 2978325580

--------------------------------------------------------------------------------------
| Id  | Operation             | Name         | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT      |              |    26 |   130 |  6626   (9)| 00:01:20 |
|   1 |  SORT GROUP BY        |              |    26 |   130 |  6626   (9)| 00:01:20 |
|*  2 |   INDEX FAST FULL SCAN| LOAD_TEST_I1 |  9898K|    47M|  6132   (2)| 00:01:14 |
--------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("N"<>5)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
      22376  consistent gets
      22353  physical reads
          0  redo size
        751  bytes sent via SQL*Net to client
        459  bytes received via SQL*Net from client
          3  SQL*Net roundtrips to/from client
          1  sorts (memory)
          0  sorts (disk)
         26  rows processed 
```

最后^=

```
> SELECT a, COUNT(*) FROM load_test WHERE n ^= 5 GROUP BY a ORDER BY a;

26 rows selected.

Elapsed: 00:00:02.10

Execution Plan
----------------------------------------------------------
Plan hash value: 2978325580

--------------------------------------------------------------------------------------
| Id  | Operation             | Name         | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT      |              |    26 |   130 |  6626   (9)| 00:01:20 |
|   1 |  SORT GROUP BY        |              |    26 |   130 |  6626   (9)| 00:01:20 |
|*  2 |   INDEX FAST FULL SCAN| LOAD_TEST_I1 |  9898K|    47M|  6132   (2)| 00:01:14 |
--------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("N"<>5)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
      22376  consistent gets
      22353  physical reads
          0  redo size
        751  bytes sent via SQL*Net to client
        459  bytes received via SQL*Net from client
          3  SQL*Net roundtrips to/from client
          1  sorts (memory)
          0  sorts (disk)
         26  rows processed 
```

三个查询的执行计划相同，时间分别为 2.12、2.13 和 2.10 秒。

应该注意的是，无论查询中使用哪种语法，执行计划总是显示 <>

对每个运算符语法重复测试十次。这些是时间：-

```
<>

2.09
2.13
2.12
2.10
2.07
2.09
2.10
2.13
2.13
2.10

!=

2.09
2.10
2.12
2.10
2.15
2.10
2.12
2.10
2.10
2.12

^=

2.09
2.16
2.10
2.09
2.07
2.16
2.12
2.12
2.09
2.07 
```

虽然有百分之几秒的一些差异，但并不重要。三种语法选择中的每一种的结果都是相同的。

语法选择被解析、优化并在同一时间以同样的努力返回。因此，在这个测试中使用一个比另一个没有明显的好处。

“Ah BC”，您说，“在我的测试中，我相信存在真正的差异，否则您无法证明这一点”。

是的，我说，这是完全正确的。您尚未显示您的测试、查询、数据或结果。所以我对你的结果无话可说。我已经证明，在所有其他条件相同的情况下，使用哪种语法并不重要。

“那为什么我在测试中发现那个更好呢？”

好问题。有几种可能性：-

1.  您的测试存在缺陷（您没有消除外部因素 - 其他工作负载、缓存等您没有提供我们可以做出明智决定的信息）
2.  您的查询是一个特例（给我看查询，我们可以讨论它）。
3.  您的数据是一种特殊情况（也许 - 但如何 - 我们也没有看到）。
4.  还有一些其他的外部影响。

我通过一个记录在案且可重复的过程表明，使用一种语法优于另一种语法并没有什么好处。我相信 <> != 和 ^= 是同义词。

如果你相信否则没问题，那么

a）展示一个我可以自己尝试的记录示例

和

b) 使用您认为最好的语法。如果我是正确的并且没有区别，那没关系。如果你是正确的，那么很酷，你只需很少的工作就能得到改进。

“但伯勒森说这更好，我比你、法鲁特、刘易斯、凯特和所有其他流浪汉更信任他。”

他说这样更好吗？我不这么认为。他没有提供任何明确的示例、测试或结果，但只链接到有人说 != 更好，然后引用了他们的一些帖子。

秀不说。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-08-17T13:28:27.880

您参考了 Burleson 网站上的文章。您是否点击了指向 Oracle-L 存档的链接？您是否阅读过其他回复 Burleson 引用的电子邮件的电子邮件？

我不认为你这样做了，否则你不会问这个问题。`!=` 因为和之间没有根本区别`<>`。最初的观察几乎可以肯定是数据库中的环境条件造成的侥幸。[阅读Jonathan Lewis](http://www.freelists.org/post/oracle-l/Performance-Difference-Between-and,1)和[Stephane Faroult](http://www.freelists.org/post/oracle-l/Performance-Difference-Between-and,3)的回复以了解更多信息。

* * *

> “尊重不是程序员必须具备的，是任何人都应该具备的基本态度”

在一定程度上。当我们在街上遇到陌生人时，我们当然应该礼貌并尊重他们。

但是，如果那个陌生人希望我以特定的方式设计我的数据库应用程序以“提高性能”，那么他们应该有一个令人信服的解释和一些防弹的测试用例来支持它。来自某个随机个体的孤立轶事是不够的。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-08-17T13:49:35.817

[文章](http://www.dba-oracle.com/t_not_equal_operator.htm)的作者虽然是书籍作者和一些有用信息的提供者，但在准确性方面并没有很好的声誉。在这种情况下，这篇文章只是提到了一个人在著名的 Oracle 邮件列表上的[观察。](http://www.freelists.org/post/oracle-l/Performance-Difference-Between-and)如果您阅读回复，您会看到帖子的假设受到质疑，但没有准确性假设。以下是一些摘录：

> 尝试通过解释计划（或自动跟踪）运行您的查询，看看它说了什么......据此，“！=”被认为与“<>”相同......乔纳森刘易斯

Jonathan Lewis 是 Oracle 社区中一位备受尊敬的专家。

> 只是出于好奇......查询优化器是否为两个查询生成不同的执行计划？问候，克里斯

.

> 可能是绑定变量偷看？写 != 而不是 <> 的某些效果是强制重新解析。如果在第一次执行时 :id 的值不同，并且如果您在 claws_doc_id 上有直方图，则可能是一个原因。如果你告诉我 claws_doc_id 是主键，那么我会问你计数的目的是什么，特别是当 EXISTS 子句中的查询与外部查询不相关并且无论 :id 是什么都会返回相同的结果时. 看起来像一个轮询查询。围绕它的代码一定很有趣。
> 
> 斯蒂芬·法鲁特

.

> 我很确定词法解析将！= 转换为 <> 或 <> 转换为！=，但我不确定这是否会影响 sql 文本是否与存储的大纲匹配。

.

> 解释计划看起来一样吗？一样的费用？

以下回复来自原始海报。

> 乔纳森，谢谢你的回答。我们确实对这两个版本的声明做了一个解释计划，它们是相同的，这就是令人费解的地方。根据文档，不等于的两种形式是相同的（以及 ^= 和另一种我无法输入的形式），所以对我来说为什么性能上有任何差异是没有意义的。
> 
> 斯科特·迦南

.

> 不是一个包罗万象的小测试，但它至少出现在 10.1.0.2 中，它被缩减为一个“<>”（注意每个计划的过滤线）

.

> 你有存储大纲吗？存储大纲进行*精确*（文字）匹配，因此如果您有一个存储大纲，例如带有“！=”的 SQL，而没有一个用于带有“<>”的 SQL（反之亦然），则存储大纲可能是使用提示？（不过，想想看，如果执行存储大纲，您的 EXPLAIN PLAN 应该会显示提示？）

.

> 您是否尝试过超越仅解释和自动跟踪并运行完整的 10046 级别 12 跟踪以查看较慢版本在哪里花费时间？这可能会对该主题有所了解，另外 - 请务必验证 10046 跟踪文件（不是使用 EXPLAIN= 选项生成的文件）和 v$sqlplan 中的解释计划完全相同。自动跟踪和解释的一些“功能”可能会导致它无法为您提供准确的解释计划。
> 
> 问候，布兰登

.

> 这种现象完全可以重现吗？
> 
> 您是否检查了计划的 filter_predicates 和 access_predicates，或者只是结构。我不希望有任何区别，但是如果您不走运，谓词顺序的更改可能会导致 CPU 使用率发生显着变化。
> 
> 如果没有区别，则启用行源统计（alter session set "_rowsource_execution_statistics"=true）并运行查询，然后从 V$sql_plan 中获取执行计划并加入 v$sql_plan_statistics 以查看是否有关于 last_starts 的数字, last_XXX_buffer_gets, last_disk_reads, last_elapsed_time 为您提供时间去向的线索。
> 
> 如果您使用的是 10gR2，则可以使用 /*+gather_plan_statistics */ 提示来代替“alter session”。
> 
> 问候乔纳森·刘易斯

在这一点上，线程死了，我们看不到原始海报的更多帖子，这让我相信，要么是 OP 发现了他们所做的不正确的假设，要么没有进行进一步的调查。

我还要指出，如果您执行解释计划或自动跟踪，您会看到比较始终显示为`<>`.

这是一些测试代码。如果您愿意，可以增加循环迭代的次数。您可能会看到一方或另一方获得更高的数字，具体取决于服务器活动上的其他活动，但绝不会看到一个操作员始终比另一个更好。

```
DROP TABLE t1;
DROP TABLE t2;
CREATE TABLE t1 AS (SELECT level c1 FROM dual CONNECT BY level <=144000);
CREATE TABLE t2 AS (SELECT level c1 FROM dual CONNECT BY level <=144000);

SET SERVEROUTPUT ON FORMAT WRAPPED

DECLARE
   vStart  Date;
   vTotalA Number(10) := 0;
   vTotalB Number(10) := 0;
   vResult Number(10);
BEGIN   
   For vLoop In 1..10 Loop
      vStart := sysdate;
      For vLoop2 In 1..2000 Loop
         SELECT count(*) INTO vResult FROM t1 WHERE t1.c1 = 777 AND EXISTS
            (SELECT 1 FROM t2 WHERE t2.c1 <> 0);
      End Loop;
      vTotalA := vTotalA + ((sysdate - vStart)*24*60*60);

      vStart := sysdate;
      For vLoop2 In 1..2000 Loop
         SELECT count(*) INTO vResult FROM t1 WHERE t1.c1 = 777 AND EXISTS
            (SELECT 1 FROM t2 WHERE t2.c1 != 0);
      End Loop;
      vTotalB := vTotalB + ((sysdate - vStart)*24*60*60);

      DBMS_Output.Put_Line('Total <>: ' || RPAD(vTotalA,8) || '!=: ' || vTotalB);
      vTotalA := 0;
      vTotalB := 0;
   End Loop;

END; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-17T09:32:22.317

程序员将使用`!=`

DBA 将使用`<>`

如果有不同的执行计划，则可能是查询缓存或每种表示法的统计信息存在差异。但我真的不这么认为。

编辑：

我上面的意思。在复杂的数据库中可能会有一些奇怪的副作用。我不太了解 oracle，但我认为 SQL Server 2008 R2 中有一个查询编译缓存。如果查询被编译为新查询，则数据库优化器会根据当前统计信息计算新的执行计划。如果统计数据发生了变化，它将导致另一个，可能是一个更糟糕的计划。

# iphone - 在iphone中显示中文日期

> ID：12003133
> 
> 赞同：0
> 
> 时间：2012-08-17T09:23:09.883
> 
> 标签：iphone, ios, nsdate, nsdateformatter, nslocale

如何用中文显示当前日期。我收到英文日期，但我需要在 iphone 中以中文显示。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-17T09:42:27.583

获取日期编号，将英文单词替换为中文...

# reload - Trigger.io 重新加载频道没有活跃用户

> ID：12003135
> 
> 赞同：2
> 
> 时间：2012-08-17T09:23:15.220
> 
> 标签：reload, trigger.io

我正在尝试在我的应用程序上测试 Trigger.io 重新加载功能，并创建了一个新流，但这些频道中的任何一个都没有活跃用户。

是否需要在应用程序中添加代码来为用户订阅重新加载流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T23:31:35.387

目前报告的用户号码有 15 分钟的延迟。

但是，如果您刚刚在测试设备上安装了某个版本的应用程序或在模拟器中运行它，即使流中出现的用户数仍然为 0，您也可以立即重新加载它。

您确实需要在应用程序中使用[forge.reload.switchStream](http://current-docs.trigger.io/modules/reload.html#switchstream)方法将用户置于正确的流中。或者您可以使用已经存在的“默认”流来重新加载所有用户，而无需在您的应用中添加任何额外的代码。

# java - 通用 DAO 和嵌套属性支持

> ID：12003143
> 
> 赞同：1
> 
> 时间：2012-08-17T09:23:42.470
> 
> 标签：java, hibernate, genericdao, hibernate-generic-dao

我正在尝试通过 DAO 对象执行数据库访问，并且遇到了需要查询另一个实体中的字段的情况。

考虑通过外键在实体 A 中连接的两个实体（实体 A 和实体 B）`EntityA.idEntityB`。

我有`GenericDao<EntityA> daoA`并且我正在尝试获取与 EntityB 的确定字段匹配的所有结果：`idEntityB.fieldOfB`所有结果都在 dao 的相同*查找*方法中。

可能吗？如果是这样，一些方向会很好。谢谢

**编辑**

我的代码示例：

### 实体

```
public class EntityA {
    @JoinColumn(name = "id_entity_b", referencedColumnName = "id")
    @ManyToOne(optional = false, fetch = FetchType.EAGER)
    private EntityB idEntityB;
    // getter+setter...
}

public class EntityB {
    // ...
    private String fieldOfB;
    // getter+setter...
} 
```

### DAO 访问

```
GenericDao<EntityA> daoA = // ...

Set<Criterion> filter = new HashSet<Criterion>();
filter.add(Restrictions.eq("idEntityB.fieldOfB"));

List<EntityA> list = dao.findByFilter(filter); 
```

错误消息类似于“*无法解析属性 idEntityB.fieldOfB* ”

**编辑 2**

我能够找到我想做的事情。尽管我的 API 略有不同，但我相信这对于在自己项目的早期阶段遇到此问题的任何人都有帮助。

[http://code.google.com/p/hibernate-generic-dao/](http://code.google.com/p/hibernate-generic-dao/)

> 该框架具有强大而灵活的搜索功能。这是通过将搜索对象传递给通用和通用 DAO 上的搜索方法来使用的。

此项目完全支持具有嵌套属性的搜索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T19:26:18.847

这是我的通用标准过滤方法。

根据 bean 约定的属性具有以下形式`foo.bar.name`。
使用 Criteria API，可以从给定的过滤映射构建树，并且可以添加限制。我在测试期间观察到的一个特殊情况是，对标识符属性进行过滤不需要新的子标准，因为该属性已经被获取。

```
/**
 * Creates a detached criteria from the given Type and given map of filters.
 * 
 * @param type Target type the Criteria is build for.
 * @param identifierPropertyName If provided (not null) the identifier
 *            property name can be identified for the given type to simplify
 *            the queries if the identifier property is the only property
 *            used on the parent no subqueries are needed.
 * @param filters
 * 
 * @see #createTree(Set, String)
 * @see #addRestrictions(DetachedCriteria, TreeNode)
 * 
 * @return
 */
public static DetachedCriteria createDetachedCriteria(final Class<?> type, final String identifierPropertyName,
    final Map<String, Criterion> filters)
{
    final DetachedCriteria criteria = DetachedCriteria.forClass(type);

    // add restrictions using tree
    final TreeNode<Entry<String, Criterion>> rootNode = HibernateUtils2.createTree(filters.entrySet(),
        identifierPropertyName);

    final Iterator<TreeNode<Entry<String, Criterion>>> it = rootNode.getChildren().iterator();

    while (it.hasNext())
        HibernateUtils.addRestrictions(criteria, it.next());

    return criteria;
}

/**
 * Creates a Tree from the given Set using a fictional root TreeNode.
 * 
 * @param <T>
 * 
 * @param filters
 * @param identifierPropertyName Property name which is merged with its
 *            parent property. Example: <b>user.id</b> is treated as single
 *            property.
 * @return
 */
public static <T extends Object> TreeNode<Entry<String, T>> createTree(final Set<Entry<String, T>> filters,
    final String identifierPropertyName)
{

    final Iterator<Entry<String, Object>> it = filters.iterator();

    /*
     * create key property tree for Entity properties
     */
    final TreeNode<Entry<String, Object>> rootNode = new TreeNode<Entry<String, Object>>(
        new SimpleEntry<String, Object>("root", null));

    while (it.hasNext())
    {
        final Entry<String, Object> entry = it.next();
        // foo.bar.name
        final String key = entry.getKey();

        String[] props;

        /*
         * check if we have a nested hierarchy
         */
        if (key.contains("."))
        {
            props = key.split("\\.");
            // check for identifier since identifier property name does not
            // need new subcriteria
            if (!StringUtils.isBlank(identifierPropertyName))
            {
                int propsTempLength = props.length - 1;
                if (props[propsTempLength].equals(identifierPropertyName))
                {
                    props = Arrays.copyOf(props, propsTempLength);
                    propsTempLength--;
                    props[propsTempLength] = props[propsTempLength] + "." + identifierPropertyName;
                }
            }

            // check for "this" identifier of beginning, which needs to be
            // added for projections because of hibernate not recognizing it
            if (props.length > 1 && props[0].equals("this"))
            {
                props[0] = "this." + props[1];

                props = ArrayUtils.remove(props, 1);
            }
        }
        else
            props = new String[]
            {
                key
            };

        TreeNode<Entry<String, Object>> currNode = rootNode;

        // create nested criteria
        for (int i = 0; i < props.length; i++)
        {
            Object valueAdd;

            // only leaf needs value
            if (i != props.length - 1)
                valueAdd = null;
            else
                valueAdd = entry.getValue();

            final TreeNode<Entry<String, Object>> childTempNode = new TreeNode<Entry<String, Object>>(
                new SimpleEntry<String, Object>(props[i], valueAdd));

            // try to get the real node
            TreeNode<Entry<String, Object>> childNode = currNode.getChild(childTempNode.getElement());
            // check if we already have a unique node
            if (childNode == null)
            {
                childNode = childTempNode;
                // add new child to set if its a new node
                currNode.addChild(childNode);
            }

            currNode = childNode;
        }
    }

    return rootNode;
}

/**
 * Recursively adds the given Restriction's wrapped in the given TreeNode to
 * the Criteria.
 * 
 * @param criteria
 * @param treeNode
 */
public static void addRestrictions(final DetachedCriteria criteria,
    final TreeNode<Entry<String, Criterion>> treeNode)
{
    // if we have a leaf simply add restriction
    if (treeNode.getChildren().size() == 0)
        criteria.add(treeNode.getElement().getValue());
    else
    {
        // create new sub Criteria and iterate children's
        final DetachedCriteria subCriteria = criteria.createCriteria(treeNode.getElement().getKey());

        final Iterator<TreeNode<Entry<String, Criterion>>> it = treeNode.getChildren().iterator();

        while (it.hasNext())
            HibernateUtils.addRestrictions(subCriteria, it.next());
    }
}

/*
 * Utility classes
 */

/**
 * Generic TreeNode implementation with a Set to hold its children to only allow
 * unique children's.
 */
public class TreeNode<T>
{
    private final T element;

    private final Set<TreeNode<T>> childrens;

    public TreeNode(final T element)
    {
        if (element == null)
            throw new IllegalArgumentException("Element cannot be null");

        this.element = element;

        this.childrens = new HashSet<TreeNode<T>>();
    }

    public void addChildren(final TreeNode<T> children)
    {
        this.childrens.add(children);
    }

    /**
     * Retrieves the children which equals the given one.
     * 
     * @param children
     * @return If no children equals the given one returns null.
     */
    public TreeNode<T> getChildren(final TreeNode<T> children)
    {
        final Iterator<TreeNode<T>> it = this.childrens.iterator();

        TreeNode<T> next = null;

        while (it.hasNext())
        {
            next = it.next();
            if (next.equals(children))
                return next;
        }

        return null;
    }

    public T getElement()
    {
        return this.element;
    }

    public Set<TreeNode<T>> getChildrens()
    {
        return this.childrens;
    }

    /**
     * Checks if the element of this instance equals the one of the given
     * Object.
     */
    @Override
    public boolean equals(final Object obj)
    {
        if (this == obj)
            return true;

        if (obj != null && obj instanceof TreeNode)
        {
            final TreeNode<?> treeNode = (TreeNode<?>) obj;

            return this.element.equals(treeNode.element);
        }
        else
            return false;
    }

    @Override
    public int hashCode()
    {
        int hash = 1;
        hash = hash * 17 + this.element.hashCode();
        return hash;
    }
} 
```

希望这对您有所帮助。或者看看你提到的通用 dao 项目。我知道这个项目并检查了它，但从未下载过。

使用这种方法，可以非常简单地创建查询，如下所示：

```
Map<String, Object> filters = new HashMap<String, Object>();
filters.put("foo.bar.name", Restrictions.like("name", "peter"));
filters.put("foo.test.id", Restrictions.eq("id", 2));

List<Class> data = HibernateUtils.createDetachedCriteria(Class, "get identifier from sessionFactory", filters).getExecutableCriteria(session).list(); 
```

*这种将属性名称作为键添加到 Restrictions 中的奇怪方法与 Restrictions 没有属性名称的 getter 和 setter 的事实有关。*

**自定义过滤**

我的真实应用程序使用类似的代码，不仅限于`Criterion`类。对于我的 Web 层，我创建了与 Restrictions api 等效的自定义过滤器，但客户端不再需要休眠 jar。

**编辑**

不支持跨非实体（如组件和复合 ID）的通用过滤。`ClassMetadata`它可以在无需反思的情况下轻松扩展以支持它们。如果需要代码，我可以提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T11:48:42.483

看看这个例子：http: [//viralpatel.net/blogs/hibernate-one-to-one-mapping-tutorial-using-annotation/](http://viralpatel.net/blogs/hibernate-one-to-one-mapping-tutorial-using-annotation/)

您需要将实体之间的关系声明为

```
public class EntityA {
    @JoinColumn(name = "id_entity_b")
    @ManyToOne(optional = false, fetch = FetchType.EAGER)
    private EntityB idEntityB;
    // getter+setter... and the rest
} 
```

而不是`Integer`使用`EntityB`.

[这就是 Hibernate 提供的ORM](https://en.wikipedia.org/wiki/Object_relational_mapping)的要点：您不需要使用键，而是使用对象。将此表示转换为带有键的关系映射是 Hibernate 的 ORM 层的工作。

# clojure - Noir 中的内容协商

> ID：12003145
> 
> 赞同：1
> 
> 时间：2012-08-17T09:23:47.903
> 
> 标签：clojure, noir

[在Noir](http://webnoir.org/)框架中进行内容协商的首选方式是什么？

我知道这个[clj-conneg](https://github.com/rnewman/clj-conneg)，但我想知道 Noir 中是否已经包含类似的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T12:46:56.257

因为 Noir 是建立在 Ring 之上的，所以像[ring-middleware-format](https://github.com/ngrunwald/ring-middleware-format)这样的中间件可能是要走的路。

# html - WebKit 中的 HTML5 进度标签不起作用？

> ID：12003147
> 
> 赞同：0
> 
> 时间：2012-08-17T09:23:57.633
> 
> 标签：html, safari, webview, progress

我需要在（html5）网页中显示操作系统原生进度条。我在以下 html 文件中有进度标签

<进度值="22" max="100" />

它在 Safari 6.0 OSX Lion 10.7.4 中运行良好，但在 WebKit 的 WebView 中却不行。页面的其余部分显示良好，但没有进度条。任何人都知道为什么会这样？我认为 WebKit 和 Safari 实际上是相同的，但似乎并非如此。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:30:17.330

你见过[CanIUse#Progress](http://caniuse.com/#feat=progressmeter)吗？

* * *

这适用于 Firefox 14、Chrome 21 和 Safari 等。

```
<progress value="22" max="100" /> 
```

但是从 CanIUse 中可以看出，android 浏览器还不支持进度元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-17T05:13:03.297

我认为进度标签需要关闭。请试试这个

```
<progress value="22" max="100"></progress> 
```

它可以帮助你

# javascript - Metro 风格应用程序中未出现后退按钮

> ID：12003155
> 
> 赞同：2
> 
> 时间：2012-08-17T09:24:25.667
> 
> 标签：javascript, html, windows-8, microsoft-metro, winjs

我已按照 MSDN 上的教程进行操作。html/javascript Metro 风格应用的默认后退按钮不会出现在任何地方。

然后我创建了新项目（网格应用程序、空白应用程序、导航应用程序），即使它是在代码中定义的，它也不会显示。但是，从 Windows 应用商店安装的其他应用程序都显示返回按钮。

其他人对后退按钮有这个问题吗？

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>homePage</title>

    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0.RC/css/ui-light.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0.RC/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0.RC/js/ui.js"></script>

    <link href="/css/default.css" rel="stylesheet" />
    <link href="/pages/home/home.css" rel="stylesheet" />
    <script src="/pages/home/home.js"></script>
</head>
<body>
    <!-- The content that will be loaded and displayed. -->
    <div class="fragment homepage">
        <header aria-label="Header content" role="banner">
            <button class="win-backbutton" aria-label="Back" disabled></button>
            <h1 class="titlearea win-type-ellipsis">
                <span class="pagetitle">Dude!</span>
            </h1>
        </header>
        <section aria-label="Main content" role="main">
            <p>Content goes here.</p>
        </section>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T19:08:57.633

也许你已经尝试过了，但 HTML 本身是不够的。模板添加的按钮需要 JavaScript 才能启用后退按钮。

默认情况下，按钮会添加`disabled`属性集，但如果脚本确定有要导航回的内容，则会删除该属性。

例如，这里是 Grid 应用程序模板（在 /js/navigator.js 中）的相关部分：

```
 // This function updates application controls once a navigation
        // has completed.
        navigated: function () {
            // Do application specific on-navigated work here
            var backButton = this.pageElement.querySelector("header[role=banner] .win-backbutton");
            if (backButton) {
                backButton.onclick = function () { nav.back(); };

                if (nav.canGoBack) {
                    backButton.removeAttribute("disabled");
                } else {
                    backButton.setAttribute("disabled", "disabled");
                }
            }
        }, 
```

您可以看到它按类查找后退按钮`.win-backbutton`，如果`nav.canGoBack`为真，则通过删除禁用来启用后退按钮。:)

# php - Mysql事务和锁定

> ID：12003167
> 
> 赞同：1
> 
> 时间：2012-08-17T09:25:47.467
> 
> 标签：php, mysql, transactions, locking, adodb

我正在测试 MySql 中的事务。我创建了两个表：

```
CREATE TABLE `testtransaction1` (
  `a` bigint(20) DEFAULT NULL,
  `b` bigint(20) DEFAULT NULL
) ENGINE=InnoDB;

CREATE TABLE `testtransaction2` (
  `a` bigint(20) DEFAULT NULL,
  `b` bigint(20) DEFAULT NULL
) ENGINE=InnoDB; 
```

之后我运行脚本：

```
$conn->StartTrans ();
try {
    $conn->Execute("insert into testtransaction1(a) values (1),(2)");

    sleep(5);

    $conn->Execute("insert into testtransaction2 select * from testtransaction1 where b is null");

    $conn->Execute("update testtransaction1 set b=100 where b is null");
    echo "Ran insert into testtransaction2 select * from testtransaction1 where b is null";
    $out=$conn->CompleteTrans ($autoComplete=true);

    var_dump($out);
} catch ( Exception $e ) {
} 
```

所以，我正在做的是在几秒钟的间隙内运行相同的脚本两次。测试事务是否锁定了表。

我看到的是只有第一笔交易完成，第二笔交易失败。

请让我知道为什么会这样。。

# xml - 具有属性的 Xpath decendant-or-self

> ID：12003168
> 
> 赞同：0
> 
> 时间：2012-08-17T09:25:51.833
> 
> 标签：xml, xpath, count

> **可能重复：**
> [xpath 表达式中的属性和 count()](https://stackoverflow.com/questions/11988929/attributes-and-count-in-xpath-expression)

跟随 xml -

```
 <a m="1">
    <b n="1" o="2">
      <c p="3">3</c>
      <d/>
    </b>
    <b n="1" o="2">
      <c p="3">3</c>
      <d q="3">
        <e r="2">2</e>
      </d>
      <f s="1"/>
    </b>
  </a> 
```

为什么`count(/*/*//@*) = 9` 呢？

有人可以计算按顺序检索到的所有节点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T13:14:17.373

> 为什么`count(/*/*//@*)`= 9

**因为**

```
/*/*//@* 
```

选择作为 XML 文档顶部元素的子元素或 XML 文档顶部元素的子元素的后代的任何元素的所有任何属性。

选择的属性是 XML 文档中的所有属性，除了`m`顶部元素的唯一属性：`n`, `o`, `p`, `n`, `o`, `p`, `q`, `r`, `s`。

上面的计数是9。

# objective-c - 释放对象的 Malloc 错误校验和不正确

> ID：12003169
> 
> 赞同：0
> 
> 时间：2012-08-17T09:25:53.273
> 
> 标签：objective-c, macos, malloc

我已经编写了一个objective-c wifi库和围绕它的ac包装器，以使用corewlan框架从我的c++代码中调用。我已经设置了计时器，并且在计时器到期时我调用了库的scanwifi函数，它提供了所有wifi网络的详细信息.程序通过给释放对象的malloc错误不正确的校验和而不断崩溃。崩溃不一致，一直出现随机的地方。我尝试了guard malloc 来查找内存错误，让程序运行了10多个小时但它没有崩溃。一旦我删除了警卫 malloc 并执行了程序并繁荣，就发生了崩溃。谁能告诉方法来捕捉这个内存错误谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T10:58:09.087

内存管理错误可能特别难以追踪；没有看到代码很难说。

您提到了 GuardMalloc——您是否尝试过启用其他[诊断](http://developer.apple.com/library/mac/#recipes/xcode_help-scheme_editor/Articles/SchemeDiagnostics.html)？

*   涂
*   保护边缘
*   守卫马洛克
*   僵尸对象

这可以通过使您的代码更可预测地崩溃来帮助调试——希望更接近错误的根源。

（在 Xcode 4.4.1 中，这些是通过“Product”->“Edit scheme”->“Run”->“Diagnostics”设置的。）

# php - 如何在使用 CakePHP 1.3 的文件上传期间过滤多个 MimeType 以进行验证？

> ID：12003177
> 
> 赞同：0
> 
> 时间：2012-08-17T09:26:31.083
> 
> 标签：php, validation, cakephp, cakephp-1.3, mime-types

我有一个文件上传功能，我想允许图像和文档并禁止其他文件，只检查扩展名听起来是个坏主意。

我拥有的代码片段是：

```
var $actsAs = array(
    'MeioUpload' => array(
        'file' => array(
            'dir' => 'uploads{DS}{ModelName}',
            'fields' => array(
                'filesize' => 'size',
                'mimetype' => array('image/jpeg', 'image/pjpeg', 'image/gif',
                'image/png', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'application/vnd.openxmlformats-officedocument.wordprocessingml.template',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                'application/vnd.openxmlformats-officedocument.presentationml.presentation','application/pdf'),
                'message' => 'Please upload a valid document file'
            ),
            'allowed_mime' => array('image/jpeg', 'image/pjpeg', 'image/gif',
                'image/png', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'application/vnd.openxmlformats-officedocument.wordprocessingml.template',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                'application/vnd.openxmlformats-officedocument.presentationml.presentation','application/pdf'),
            'allowed_ext' => array(' .docx',' .jpg',' .jpeg',' .png',' .gif',' .doc',' .xls',' .xlsx',' .pdf'),
            'validations' => array(
                'MaxSize' => array(
                    'check' => false,
                ),
            ),
            'message' => 'Invalid File. Please upload only document or images'
        ),
    ),
); 
```

如何分配 mimetypes 以允许：.txt、.doc、.docx、.xls、.xlsx、.pdf、.png、.jpg、.gif、.jpeg

MEIOUPLOAD 调整会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T06:57:25.603

尝试了几个位置，最后求助于核心 PHP 功能。MeioUpload 不支持检查多种 mime 类型。希望未来版本中可能会出现增强功能。

```
 $allowMime = array('image/jpeg', 'image/pjpeg', 'image/gif',
                                'image/png', 'application/msword','application/vnd.ms-office','application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                                'application/vnd.openxmlformats-officedocument.wordprocessingml.template',
                                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                                'application/vnd.openxmlformats-officedocument.presentationml.presentation','application/pdf');
                $file_info = new finfo(FILEINFO_MIME);
                $filename = $attachments[$file_name];
                $data = explode(";",$file_info->file($filename));
                $mime = $data[0];
                if(in_array($mime, $allowMime))
                {
 //Your code here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:01:59.193

您可以使用[Mime 类型模型验证](http://book.cakephp.org/2.0/en/models/data-validation.html#Validation%3a%3amimeType)。这是代码：

```
This rule checks for valid mimeType

<?php
   public $validate = array('image' => array(
                      'rule' => array('mimeType', array('image/gif')),
                      'message' => 'Invalid mime type.'
                                    ),
                            ); 
```

# php - PHP - 使用 Sessions 临时保存 ajax 应用程序的变量

> ID：12003178
> 
> 赞同：0
> 
> 时间：2012-08-17T09:26:35.147
> 
> 标签：php, ajax, session

我想知道以下是否是一个好主意，或者在性能方面会适得其反：

Ajax 应用程序，例如页面浏览器需要一些存储在数据库中的语言和配置值。所以每次用户使用这个应用程序时，在 ajax-script 中，mysql-query 都会一次又一次地获取变量。考虑到页面浏览器的情况，可能有 10 个或更多请求（返回和转发、返回、转发等），也就是 10 个数据库选择，而实际上只需要一次。

我的想法是，为了第一次保护会话数组中的配置变量，请求 ajax-app。如果 session-array 存在，mysql-query 不会再次完成。如果用户调用另一个常规页面，这些会话数组将再次被删除。

现在我不太确定，什么会消耗更多的服务器资源，以上述方式使用会话临时保存变量，或者每次只使用 mysql-query 来获取变量，用户点击 ajax-app。

提前感谢，杰登

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:36:56.857

如果您处理大量数据，您可以考虑使用 Cookies 来代替 session 来获取服务器资源，这些资源将存储在用户的本地浏览器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:30:00.230

我敢打赌会话会更有效，但最好的方法是测试和测量不同的执行时间。

# google-apps-script - “Leider ist ein Serverfehler aufgetreten。Warten Sie eine Weile und versuchen Sie es später erneut。” （英文：服务器错误，稍后再试）

> ID：12003186
> 
> 赞同：-1
> 
> 时间：2012-08-17T09:26:56.347
> 
> 标签：google-apps-script

当我尝试运行部署为网络应用程序的 Google 应用程序脚本时，我不断收到此错误。昨天使用相同的代码运行良好。

那会是什么？等待有用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:23:47.643

> 那会是什么？

GAS团队经常更改代码，例如，`DatePicker`小部件没有`setName`方法，只有`setId`这个ID用作处理程序参数。最近他们介绍了`setName`方法和代码被破坏了。[这](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1658)是有关此更改的已提交问题。我假设你有类似的情况。

> 等待有用吗？

不，我不确定代码是否会再次开始工作......但谁知道......我建议您在调试器下启动脚本，找到问题行并尝试修复或编写一种解决方法。

# javascript - 将数据注入异步回调（使用 node.js）

> ID：12003192
> 
> 赞同：1
> 
> 时间：2012-08-17T09:27:43.907
> 
> 标签：javascript, node.js, asynchronous, callback, coffeescript

我正在努力思考如何使异步编程工作。

在我当前的用例中，我的函数可能每秒被调用多次，并且它们具有依赖于多个变量的回调，这些变量可能在它们之间发生变化。

一个简化的例子：（为简洁起见使用coffeescript）

```
doSomething = (requestor, thing, action, callback) ->
  thing.takeAction action, (result) ->
    # actually a lot of times this nests down even further
    requestor.report result
    callback result 
```

如果在 thing.takeAction 返回其结果之前使用不同的数据多次调用 doSomething，*我认为我不能依赖请求者和回调仍然是我需要的相同的东西。正确的？*

**为了避免这种情况，我需要以某种方式将请求者和回调注入到 takeAction 的回调中。这有可能吗？**

我想到了做类似的事情

```
doSomething = (requestor, thing, action, callback) ->
  thing.takeAction action, (result, _requestor = requestor, _callback = callback) ->
    _requestor.report result
    _callback result 
```

但这当然只是一个 CoffeeScript hack，根本不起作用。

* * *

顺便说一句，我试图使用 caolan/async 模块来帮助我解决这个问题，但事实仍然是，我在回调中经常需要比 async 提供的变量更多的变量。像：

```
doSomething = function(requestor, thing, action, callback) {
  // this might not need a waterfall, but imagine it would have nested further

  async.waterfall(
  [
    function(next) {
      thing.takeAction(action, function(result) {
        // How can I know that action is still the same?
        next(null, result);
      });
    }, 
    function(result, next) {
      requestor.report(result); // requestor still the same?
      next(null, result);
    }
  ],

  function(err, result) {
    callback(result); // callback still the same?
  });
} 
```

它仍然给我留下同样的问题。那么我该怎么做呢？

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:54:12.193

您需要将`action`对象内容与`action`值本身分开。也就是说，内存中有一些对象，`action`在这个特定的上下文中被名称引用。

例如，

```
function test(action) {
    alert("Test1: " + action.value);
    setTimeout(function () { alert("Test2: " + action.value); }, 1000);
}

var action = { value: 1; };
test(action);
action = { value: 2 };
alert("Action value outside: " + action.value); 
```

将警告“Test1: 1”、“Action value outside: 2”和“Test1: 1”。但是，一旦您替换`action = { value: 2 };`为`action.value = 2`，最后一个警报将更改为“Test1：2”。

因此，如果您的问题是操作对象的某些字段在外部发生了更改，只需将其克隆到您的 doSomething 的第一行。如果您的问题是对对象的引用在外部发生了更改，您不必担心，它不会`doSomething`以任何方式影响您。

此外，对 doSomething 的后续调用不会“覆盖”回调中 action 参数的值，因为它在特定调用中被关闭：en.wikipedia.org/wiki/Closure_(computer_science)

例如，

```
function test(action) {
    alert("Test1: " + action.value);
    setTimeout(function () { alert("Test2: " + action.value); }, 1000);
}

var action = { value: 1; };
test(action);
action = { value: 2 };
test(action); 
```

将提醒“Test1: 1”、“Test1: 2”、“Test2: 1”和“Test2: 2”（不是“Test1: 1”、“Test1: 2”、“Test2: 2”和“Test2: 2”正如你似乎害怕的那样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T11:23:03.193

我不确定使用 CS 是否真的对这个例子有帮助，让我用普通的 JS 来说明：

```
var doSomething = function (requestor, thing, action, callback) {
    thing.takeAction(action, function (result) {
        requestor.report(result);
        callback(result);
    });
};

// Following is completely safe:
doSomething(r1, t1, a1, c1); 
doSomething(r2, t2, a2, c2); 
doSomething(r3, t3, a3, c3); 
```

每次调用 doSomething 时，都会创建新的函数范围。所以在内部，创建并传递给 takeAction 的函数可以访问最初调用 doSomething 的参数（对 doSomething 的另一个调用不会改变这一点！）。这就是 JavaScript 中作用域的工作方式

# vim - Vim: Vimscript 调用 netrw 命令

> ID：12003195
> 
> 赞同：0
> 
> 时间：2012-08-17T09:27:50.793
> 
> 标签：vim, netrw

[这是这个问题](https://stackoverflow.com/questions/12002401/vim-detect-whether-im-in-netrw/)的后续（但一个独特的问题），我将在此重申以完成。

我有一个 Vim 映射来开始搜索（带有 ack.vim 插件的 ack-grep）从当前目录的目录中查找模式（因此是 :pwd 之后的结果）。当我查看缓冲区时，此映射有效。

我想在 netrw 中使用相同的映射。但是，我想将当前目录 (:pwd) 更改为 netrw 显示的目录，因此搜索将从我正在查看的目录开始。我知道我可以用 netrw c 命令做到这一点。如何`c`从函数中发出命令？

我试过了：

```
function! StartAckSearch()
    " If we're in netrw change the current directory to the directory we're
    " viewing
    if &ft ==# 'netrw'
        echo 'in netrw'
        c                                                                                                                                                                                                        
    endif
endfunction
nnoremap <Leader>a :call StartAckSearch()<CR> 
```

和：

我试过了：

```
function! StartAckSearch()
    " If we're in netrw change the current directory to the directory we're
    " viewing
    if &ft ==# 'netrw'
        echo 'in netrw'
        execute 'c'                                                                                                                                                                                                        
    endif
endfunction
nnoremap <Leader>a :call StartAckSearch()<CR> 
```

但它们都不起作用。

**问题** 如何使用 Vimscript 调用 netrw 命令？（如果我的问题可以改写更清楚，请继续）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:31:37.393

我想你可以用`norm c`它来调用它。

另一种方法是`exe 'norm c'`

# android - 在 Google Code 上获取整个项目

> ID：12003200
> 
> 赞同：1
> 
> 时间：2012-08-17T09:28:30.807
> 
> 标签：android, google-code

我对此真的很陌生，我不知道如何做到这一点：你如何从[这个项目](http://code.google.com/p/andenginelivewallpaperextensionexample/source/browse/#hg/src/org/anddev/wallpaper/live/cigarette)中获取整个源代码？

请告诉我，因为我找不到下载按钮。我去下载选项卡，它不在那里。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:31:50.933

单击菜单中“来源”选项卡下的“结帐”链接。

在那里，您将获得一个可以在 shell 中执行的 Mercurial 命令：

```
hg clone https://code.google.com/p/andenginelivewallpaperextensionexample/ 
```

### 也可以看看：

*   [Mercurial 初学者指南](http://mercurial.selenic.com/wiki/BeginnersGuides)
*   [我在哪里可以找到一个好的 Eclipse Mercurial 插件？](https://stackoverflow.com/questions/1629058/mercurial-eclipse-plugin)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:32:43.337

单击*源*选项卡

以下是可用于下载项目源代码的完整命令：

```
hg clone https://code.google.com/p/andenginelivewallpaperextensionexample/ 
```

hg 是 Mercurial 附带的工具，您需要`Mercurial`获取该存储库。

# mysql - mysql日期格式dd/mm/yyyy？

> ID：12003205
> 
> 赞同：1
> 
> 时间：2012-08-17T09:29:20.933
> 
> 标签：mysql

有谁知道如何以 dd-mm-yyyy 格式将日期插入列（日期类型）？

我正在使用日历，它选择像dd-mm-yyyy这样的日子，但由于默认使用mysql的格式（yyyy-mm-dd），它无法插入。

问题是，我需要比较日历插入的日期和使用 current_date 函数自动插入的日期。基本上我有列 DoR (date_of_registration) 和 Status。我已经制作了日期类型的 DoR 和 varchar() 的状态。在状态中，我使用日历插入日期。因此，无论如何我已经比较了它，但它给出了奇怪的结果。我想它没有正确比较。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T09:34:41.953

像这样将日历的输出转换为日期格式

```
$cal_date=17-08-2012;
$date=date('Y-m-d',strtotime($cal_date));
echo $date; //gives date as 2012-08-17 
```

现在您可以将此日期插入`mysql`并进行比较

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:33:59.500

```
select str_to_date('31-12-2012', '%d-%m-%Y') 
```

见[STR_TO_DATE](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:32:10.257

您只需要这两个功能：

[`STR_TO_DATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)

和

[`DATE_FORMAT()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T09:32:20.090

请始终将日期存储为 MySQL 中的 DATE 类型。如果您需要以其他形式选择它，请使用正确的字符串函数[DATE_FORMAT](http://dev.mysql.com/doc/refman/5.6/en/date-and-time-functions.html)！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T09:42:02.970

您不需要将数据库插入为 dd-mm-yyyy。您必须使用日期格式。如果你在 php 中编写代码，你可以解析你想要的每种类型的日期

选择数据库的日期时间。`date("Y-m-d H:i:s");`并在您想要回显不同格式的日期时插入日期数据，例如

```
echo date('d-m-Y', strtotime('2012-08-17 19:00:00')); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-29T10:38:10.723

> 还有另一种存储日期的方法，如果您选择

```
`<input type="date" name="bdate" />
` 
```

> 然后它直接将日期以yyyy-MM-DD格式存储到数据库中。这里我的文本字段格式是 dd-mm-yyyy。在这里，您不必使用转换字符串`strtotime()`

# javascript - 为用户应用程序托管 javascript 文件是否安全？

> ID：12003209
> 
> 赞同：0
> 
> 时间：2012-08-17T09:29:35.467
> 
> 标签：javascript, security, open-source, code-injection

我们有在线网站（应用程序）。我们让开发人员/开源社区可以使用 javascript 代码轻松地嵌入插件/应用程序。

我们想知道，我们应该将文件托管在我们的域和服务器上，还是应该让开发人员在其中托管自己的文件并在站点中包含这些文件。

您认为哪种方法可以安全使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:32:07.763

在您的域上的页面中允许任意 JavaScript 是危险的。无论托管在哪里，它都可以完全访问您网站上的数据（访问页面的用户可以使用）。

如果您自己托管它，您可以在发布之前对其进行审核（手动或自动）。

如果您允许第三方托管它，他们可以随时更改它。

# jquery - 在 Internet Explorer 8 上加载 wordpress 网站时出错

> ID：12003211
> 
> 赞同：0
> 
> 时间：2012-08-17T09:29:37.470
> 
> 标签：jquery, wordpress, internet-explorer-8

我的网站 - [http://www.myhomecare.ie](http://www.myhomecare.ie) - 是使用与 IE 8 和 9 兼容的[Sterling 主题](http://themeforest.net/item/sterling-responsive-wordpress-theme/2320578)的 Wordpress 安装。当我在 IE 8 浏览器中测试它时，一切运行良好且看起来不错，但它突然启动抛出错误并在 IE 中垂直而不是水平显示菜单。

我联系了主题制造商提供的支持，但他们报告说它在他们的 IE 浏览器中看起来不错。

以为它可能只是我的电脑，我在办公室的其他电脑上试了一下，却发现问题出现在所有工作电脑上的 IE 8 上。我们确实在大型网络上工作，因此网络管理员可能以不同的方式配置 IE 设置，但如果我们的客户正在查看这样的网站，我仍然需要摆脱这个错误。

当我在 IE 8 中加载站点时，我确实在屏幕底部收到一条错误消息，其中显示以下问题：

```
Webpage error details

User Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2; Tablet PC 2.0)
Timestamp: Fri, 17 Aug 2012 09:23:02 UTC

Message: 'jQuery' is undefined
Line: 1
Char: 1
Code: 0
URI: http://myhomecare.ie/wp-content/themes/Sterling/framework/js/IE.js

Message: Expected identifier, string or number
Line: 398
Char: 5
Code: 0
URI: http://myhomecare.ie/wp-content/themes/Sterling/framework/js/custom-main.js?ver=2.0

Message: Expected identifier, string or number
Line: 195
Char: 4
Code: 0
URI: http://myhomecare.ie/ 
```

我不是 jquery 专家，但我确实有一些 html 和 css 知识。我需要一些帮助来了解该错误消息有什么问题。我已经尝试删除我放入主题的自定义代码并禁用最近的插件，但它没有任何区别。我很困惑为什么问题不在所有 IE 8 浏览器中。如果有人对下一步的故障排除有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:32:25.970

第一个错误是引用了一个 javascript 文件，该文件在您`<head>`使用条件代码中加载，指定 IE 版本小于或等于版本 8。

```
<!--[if lte IE 8]>
<script type="text/javascript" src="http://myhomecare.ie/wp-content/themes/Sterling/framework/js/IE.js"></script>
<![endif]--> 
```

问题是在您的标头中调用了此代码，而在页脚中调用了 jQuery。jQuery 需要在依赖脚本之前先加载，这就是错误说它未定义的原因。

将上面给出的代码块移动到其他脚本包含的页脚下方，然后从那里获取。

注意：即使 IE8 有相同的“未定义”错误，它在我的版本上显示正常，但 IE7 不是。

编辑*

好的，我们从那里拿走它。下一个错误，在第 398 行；

[http://myhomecare.ie/wp-content/themes/Sterling/framework/js/custom-main.js?ver=2.0](http://myhomecare.ie/wp-content/themes/Sterling/framework/js/custom-main.js?ver=2.0)

被抛出是因为在这个代码块中最后一个同位素参数后面有一个逗号；

```
jQuery('#iso-wrap').isotope({
    animationOptions: {
     duration: 750,
     easing: 'linear',
     queue: false,
     }
}); 
```

去掉假字后面的逗号。

这也将清除与第二个错误相关的最后一个错误。

根据您的 IE 版本，这是您提到的网络管理员的问题，这里没有人知道它们是如何设置的。

编辑 2

好的，根据您的最新评论，这与以前的问题完全相同，滑块参数末尾有一个逗号；

在您的页脚中，您有；

```
jQuery(document).ready(function(){
jQuery('#slides').slides({
      preload: false,
      //preloadImage: 'http://files.truethemes.net/themes/sterling-wp/ajax-loader.gif',
      autoHeight: true,
      effect: 'fade',
      slideSpeed: 500,
      play: 4000,
      randomize: false,
      hoverPause: true,
  }); 
```

});

去掉最后一个 true 之后的逗号。

# php - php: in_array() 与阿拉伯语

> ID：12003215
> 
> 赞同：3
> 
> 时间：2012-08-17T09:29:47.907
> 
> 标签：php, arrays, arabic

我正在使用`in_array`带有阿拉伯语的函数... `in_array ('من', $words)`在 $words 真正包含的地方给出了 true `من`。

but `in_array('من', $stopWords)`is given false 虽然它包含 من 这个词...

```
print_r($stopWords); 
```

给：

> 数组（ [0] => من ）

和`print_r($words);`

给：

> 数组（ [0] => من ）

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T11:05:24.197

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T11:19:10.087

$stopWords[0] 是 'من'，在 من 之前有一个空格。所以因为我必须处理真实的文本文件并将其反射到 $stopWords，我不能修改它.. 而不是那个.. 我正在使用 mb_strpos 来捕捉单词 'من' 在任何元素中的任何出现数组 $stopWords.. 就是这样...问题解决了..

# python - Celery 任务计划（确保一个任务一次只执行一个）

> ID：12003221
> 
> 赞同：28
> 
> 时间：2012-08-17T09:30:16.997
> 
> 标签：python, django, celery

我有一个任务，有点像这样：

```
@task()
def async_work(info):
    ... 
```

在任何时候，我都可以用一些信息调用 async_work。出于某种原因，我需要确保一次只运行一个 async_work，其他调用请求必须等待。

所以我想出了以下代码：

```
is_locked = False    
@task()
def async_work(info):
    while is_locked:
        pass
    is_locked = True
    ...
    is_locked = False 
```

但是它说访问局部变量是无效的......如何解决它？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-17T09:34:56.967

访问局部变量是无效的，因为您可以让多个 celery worker 运行任务。这些工人甚至可能在不同的主机上。`is_locked`所以，基本上，有多少 Celery 工作人员正在运行你的`async_work`任务，就有多少变量实例。因此，即使您的代码不会引发任何错误，您也不会获得预期的效果。

为了实现您的目标，您需要将 Celery 配置为仅运行一名工作人员。由于任何工作人员都可以在任何给定时间处理单个任务，因此您可以获得所需的内容。

**编辑：**

根据[工人指南>并发](http://celery.readthedocs.org/en/latest/userguide/workers.html#concurrency)：

> 默认情况下，多处理用于执行任务的并发执行，但您也可以使用 Eventlet。可以使用`--concurrency`参数更改工作进程/线程的数量，默认为机器上可用的 CPU 数量。

因此，您需要像这样运行工人：

```
$ celery worker --concurrency=1 
```

**编辑2：**

令人惊讶的是，还有另一种解决方案，而且它甚至在官方文档中，请参阅[确保任务一次只执行一个](http://celery.readthedocs.org/en/latest/tutorials/task-cookbook.html#ensuring-a-task-is-only-executed-one-at-a-time)文章。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2019-02-11T08:00:04.273

您可能不想`concurrency=1`为您的 celery 工人使用 - 您希望同时处理您的任务。相反，您可以使用某种锁定机制。*只要确保缓存的超时时间大于完成任务的时间。*

# 雷迪斯

```
import redis
from contextlib import contextmanager

redis_client = redis.Redis(host='localhost', port=6378)

@contextmanager
def redis_lock(lock_name):
    """Yield 1 if specified lock_name is not already set in redis. Otherwise returns 0.

    Enables sort of lock functionality.
    """
    status = redis_client.set(lock_name, 'lock', nx=True)
    try:
        yield status
    finally:
        redis_client.delete(lock_name)

@task()
def async_work(info):
    with redis_lock('my_lock_name') as acquired:
        do_some_work() 
```

# 内存缓存

[受celery 文档](https://celery.readthedocs.io/en/latest/tutorials/task-cookbook.html#ensuring-a-task-is-only-executed-one-at-a-time)启发的示例

```
from contextlib import contextmanager
from django.core.cache import cache

@contextmanager
def memcache_lock(lock_name):
    status = cache.add(lock_name, 'lock')
    try:
        yield status
    finally:
        cache.delete(lock_name)

@task()
def async_work(info):
    with memcache_lock('my_lock_name') as acquired:
        do_some_work() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-12T09:28:56.123

我已经实现了一个装饰器来处理这个问题。它基于确保从官方 Celery 文档[中一次只执行一个任务。](https://celery.readthedocs.io/en/latest/tutorials/task-cookbook.html#ensuring-a-task-is-only-executed-one-at-a-time)

它使用函数的名称及其 args 和 kwargs 创建一个 lock_id，它在 Django 的缓存层中设置/获取（我只用 Memcached 测试过，但它也应该适用于 Redis）。如果 lock_id 已经在缓存中设置，它会将任务放回队列并退出。

```
CACHE_LOCK_EXPIRE = 30

def no_simultaneous_execution(f):
    """
    Decorator that prevents a task form being executed with the
    same *args and **kwargs more than one at a time.
    """
    @functools.wraps(f)
    def wrapper(self, *args, **kwargs):
        # Create lock_id used as cache key
        lock_id = '{}-{}-{}'.format(self.name, args, kwargs)

        # Timeout with a small diff, so we'll leave the lock delete
        # to the cache if it's close to being auto-removed/expired
        timeout_at = monotonic() + CACHE_LOCK_EXPIRE - 3

        # Try to acquire a lock, or put task back on queue
        lock_acquired = cache.add(lock_id, True, CACHE_LOCK_EXPIRE)
        if not lock_acquired:
            self.apply_async(args=args, kwargs=kwargs, countdown=3)
            return

        try:
            f(self, *args, **kwargs)
        finally:
            # Release the lock
            if monotonic() < timeout_at:
                cache.delete(lock_id)
    return wrapper 
```

然后，您可以将其作为第一个装饰器应用于任何任务：

```
@shared_task(bind=True, base=MyTask)
@no_simultaneous_execution
def sometask(self, some_arg):
  ... 
```

# jquery - 数据表日期排序dd/mm/yyyy问题

> ID：12003222
> 
> 赞同：95
> 
> 时间：2012-08-17T09:30:17.500
> 
> 标签：jquery, datatables, date-sorting

我正在使用一个名为[datatables的 Jquery 插件](http://www.datatables.net/index)

它太棒了，但是我无法根据 dd/mm/yyyy 格式正确排序日期。

我查看了他们的支持格式，但这些修复似乎都不起作用。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2012-08-17T09:42:31.113

## 2020 年更新：HTML 解决方案

由于 HTML 5 已经如此发达，几乎所有主流浏览器都支持它。所以现在更简洁的方法是使用[HTML5 数据属性](https://datatables.net/examples/advanced_init/html5-data-attributes.html) *（maxx777 提供了一个 PHP 解决方案，我使用的是简单的 HTML）*。对于我们场景中的非数字数据，我们可以使用`data-sort`或`data-order`属性并为其分配一个可排序的值。

**HTML**

```
<td data-sort='YYYYMMDD'>DD/MM/YYYY</td> 
```

这是[有效的HTML解决方案](http://live.datatables.net/tomumagu/1/edit?output)

## jQuery 解决方案

这是[工作 jQuery 解决方案](http://live.datatables.net/rosucola/1/edit?output)。

```
jQuery.extend( jQuery.fn.dataTableExt.oSort, {
"date-uk-pre": function ( a ) {
    var ukDatea = a.split('/');
    return (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
},

"date-uk-asc": function ( a, b ) {
    return ((a < b) ? -1 : ((a > b) ? 1 : 0));
},

"date-uk-desc": function ( a, b ) {
    return ((a < b) ? 1 : ((a > b) ? -1 : 0));
}
} ); 
```

将上述代码添加到脚本中，并将 Date 值 with `{ "sType": "date-uk" }`和其他的特定列设置为 null，见下文：

```
$(document).ready(function() {
    $('#example').dataTable( {
        "aoColumns": [
            null,
            null,
            null,
            null,
            { "sType": "date-uk" },
            null
        ]
    });
    }); 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2014-08-20T13:22:56.230

## 日期排序 - 带有隐藏元素

将日期转换为格式*YYYYMMDD*并添加到实际值 ( *DD/MM/YYYY* ) 中`<td>`，将其包装在一个元素中，为元素设置样式`display:none;`。现在日期排序将像正常排序一样工作。这同样适用于日期时间排序。

HTML

```
<table id="data-table">
   <tr>
     <td><span>YYYYMMDD</span>DD/MM/YYYY</td>
   </tr>
</table> 
```

CSS

```
#data-table span {
    display:none; 
} 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2015-12-02T08:46:38.123

我知道这是一个老问题，答案也老了。最近我遇到了一种简单而干净的日期排序方式。它可以通过 HTML5`data-order`属性到`<td>`元素来完成。

这是我在 PHP 中所做的：

```
<?php
$newdate = date('d M Y', $myDateTime); // Format in which I want to display
$dateOrder = date('Y-m-d', $myDateTime); // Sort Order
?>

<td data-order="<?php echo $dateOrder; ?>" >
<?php echo $newdate; ?>
</td> 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-11-15T23:40:16.937

试试[这个](https://datatables.net/blog/2014-12-18)插件。

如此处所述[，](https://datatables.net/blog/2014-12-18#Operation)您需要包含[Moment.js](http://momentjs.com/)和 datatable-moment 插件，然后只需声明您使用的日期格式。该插件将自动检测您的日期列并按应有的方式对其进行排序。有关 moment.js 格式的说明，请查看[此处](http://momentjs.com/docs/#/displaying/)。

例子：

```
$(document).ready(function() {
    $.fn.dataTable.moment('DD/MM/YYYY HH:mm');
    $('#example').DataTable();
}); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2019-06-17T09:40:39.183

这种方式对我有用。

```
<td data-order="@item.CreatedOn.ToString("MMddyyyyHHmmss")">
    @item.CreatedOn.ToString("dd-MM-yyyy hh:mm tt")
</td> 
```

属性中的此日期格式`data-order`应采用 DataTable 支持的此格式。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-06-21T05:52:13.207

如果您不想使用momentum.js 或任何其他日期格式，您可以在日期值中添加以毫秒为单位的日期格式，以便按照毫秒进行排序。并隐藏毫秒日期格式。

**示例代码：**

```
var date = new Date();
var millisecond = Date.parse(date); 
```

**HTML**

```
<td>'<span style="display: none;">' + millisecond + "</span>" + date + </td> 
```

就是这样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-06-12T12:57:19.113

另一种解决方案： [https ://datatables.net/blog/2014-12-18](https://datatables.net/blog/2014-12-18)

带有 2 个 JavaScript 库：

1.  cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js
2.  cdn.datatables.net/plug-ins/1.10.15/sorting/datetime-moment.js

那么只有这个：

```
$(document).ready(function() {
   $.fn.dataTable.moment( 'DD/MM/YYYY' );
   $('#example').DataTable(); 
}); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-04-17T05:46:11.320

您可以使用 php.ini 解决此问题。

```
$mydate = strtotime($startdate);
$newformat = date('d-m-Y',$mydate);
echo '<tr>';
echo '  <td data-sort="'. $mydate .'">'.$newformat .'</td>'; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-06-25T06:01:08.577

虽然这个问题有很多答案，但我认为数据排序仅在“YYYYMMDD”中需要排序时才有效，并且在有小时/分钟时不起作用。使用数据排序时过滤器无法正常工作，至少我在尝试使用 React JS 时遇到了这个问题。

我认为最好的解决方案是使用数据顺序，因为可以动态提供值以用于排序目的，并且在显示时格式可以不同。该解决方案功能强大，适用于任何日期格式，包括“DD/MM/YYYY HH:M”。

例如：

```
<td data-order={obj.plainDateTime}>{this.formattedDisplayDate(obj.plainDateTime) }</td> 
```

我从这里找到了这个解决方案 -[如何按 DataTables 中的隐藏列排序？](https://stackoverflow.com/questions/38079208/how-do-i-sort-by-a-hidden-column-in-datatables/38079753)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-06-25T20:10:59.183

我试过这个并为我工作。

[https://github.com/sedovsek/DataTables-EU-date-Plug-In](https://github.com/sedovsek/DataTables-EU-date-Plug-In)

我使用了格式模式`.ToString("dd/MM/yyyy");`，然后在我的 jQuery.Datatable 中工作正常。

jQ 下面

```
oTable = $('#grid').dataTable({
    "sPaginationType": "full_numbers",
    "aoColumns": [
        { "sType": "eu_date" },
        null
    ]
});
}); 
```

您有日期的列，您应该像上面的代码一样使用 sType 定义。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-08-28T13:51:40.963

在 php 或 js 中只需传递一个数组并使用正交，例如：

```
$var[0][0] = "like as u wish, 30/12/2015 or something else";
$var[0][1] = strtotime($your_date_variable); 
```

并且，在数据表中......

```
$('#data-table-contas_pagar').dataTable({
    "columnDefs": [
        {"targets":[0],"data": [0],"render": {"_": [0],"sort": [1]}}
    ]
}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-06-21T09:38:23.427

如果您必须处理已经格式化的日期，Zaheer Ahmed 的解决方案可以正常工作。

我对此解决方案有疑问，因为我必须管理美国格式的日期。

我通过这个微小的变化想通了：

```
function parseDate(a) {
    var ukDatea = a.split('/');
    return (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
}

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "date-uk-pre": function ( a ) {
        return parseDate(a);
    },

    "date-uk-asc": function ( a, b ) {
        a = parseDate(a);
        b = parseDate(b);
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    },

    "date-uk-desc": function ( a, b ) {
        a = parseDate(a);
        b = parseDate(b);
        return ((a < b) ? 1 : ((a > b) ? -1 : 0));
    }
}); 
```

其次是您的“aoColumns”定义。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-11-03T20:33:37.460

这个解决方案是完全错误的。您不能仅将日期的每个组成部分相加就将日期转换为数字。例如，如果您使用以下日期尝试此逻辑，您会发现它不会正确匹配：

2014 年 1 月 20 日 = 2035 年 2014 年 2 月 15 日 = 2031 年

女巫约会在先，升序？1月20日？不按照这个逻辑：P

**执行 parsedate 方法的正确**方法是将字符串转换为有效的日期时间，然后使用 getTime 函数正确排序表。

```
var day = a.split('/')[0]
var month = a.split('/')[1]
var year = a.split('/')[2]

var date = new Date(month + "/" + day + "/" + year)
return date.getTime() 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-08-14T13:29:17.843

我想指出，当**通过 Ajax**使用来自服务器的数据时，解决方案非常简单，但可能不会立即显而易见。

返回排序顺序数组时，Datatables 将发送（在 中`$_POST`）一个 2 元素数组，该数组***相当于***：

```
$_POST['order'][0] =array('column'=>'SortColumnName', 'dir'=>'asc'); 
// 2nd element is either 'asc' or 'desc' 
```

因此，您可以以任何您想要的格式显示日期；只需让您的服务器仅根据`sortColumnName`.

例如，在 PHP（使用 MySQL）中，我使用以下内容：

```
 if (isset($_POST['order'])) {
          switch ($_POST['order'][0]['column']) {
               case 0:// sort by Primary Key
                    $order = 'pkItemid';
                    break;
               case 1:// Sort by reference number
                    $order = 'refNo';
                    break;
               case 2://Date Started
                    $order = 'dOpen';
                    break;
               default :
                    $order = 'pkItemid';
          }
          $orderdir = ($_POST['order'][0]['dir'] === 'desc') ? 'desc' : 'asc';
     } 
```

请注意，由于没有将`$_POST`传递给`$order`or `$orderdir`，因此不可能进行跨脚本攻击。

现在，只需附加到 MySQL 查询：

```
$sql ="SELECT pkItemid, refNo, DATE_FORMAT(dOpen,'%b %e, %Y') AS dateStarted
       FROM tblReference 
       ORDER BY $order $orderdir;"; 
```

运行查询，并仅将`dateStarted`值返回到 json 中的 Datatables。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-08-24T06:14:05.527

使用这个片段！

```
$(document).ready(function() {
 $.fn.dataTable.moment = function ( format, locale ) {
    var types = $.fn.dataTable.ext.type;

    // Add type detection
    types.detect.unshift( function ( d ) {
        return moment( d, format, locale, true ).isValid() ?
            'moment-'+format :
            null;
    } );

    // Add sorting method - use an integer for the sorting
    types.order[ 'moment-'+format+'-pre' ] = function ( d ) {
        return moment( d, format, locale, true ).unix();
    };
};

$.fn.dataTable.moment('DD/MM/YYYY');

$('#example').DataTable();
}); 
```

当 js 适用于所有日期和时间格式时，请在初始化数据表之前添加此剪辑器，就像我之前所做的那样。

还记得加载[http://momentjs.com/](http://momentjs.com/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-03T14:22:51.630

我也有同样的问题。

我在 2017 年 3 月 21 日在 td 中使用 span，通过这样做，数据表将其视为字符串并且排序不起作用。

我在 td 中删除了 span，它得到了修复。喜欢，2017 年 3 月 21 日

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-06-28T09:47:47.427

我在其余通话中使用过

**日期变量是：创建**

```
var call = $.ajax({
            url: "../_api/Web/Lists/GetByTitle('NewUser')/items?$filter=(Created%20ge%20datetime'"+FromDate+"')%20and%20(Created%20le%20datetime'"+ToDate+"' and Title eq '"+epf+"' )&$top=5000",
            type: "GET",
            dataType: "json",
            headers: {
                Accept: "application/json;odata=verbose"
            }

            });

  call.done(function (data,textStatus, jqXHR){
        $('#example').dataTable({
            "bDestroy": true,
            "bProcessing": true,
            "aaData": data.d.results,
            "aLengthMenu" : [
             [50,100],
             [50,100]
            ],
             dom: 'Bfrtip',
            buttons: [
                'copy', 'csv', 'excel'
            ],

            "aoColumnDefs": [{ "bVisible": false  }],
            "aoColumns": [
                { "mData": "ID" },
                { "mData": "Title" },
                { "mData": "EmployeeName" },
                { "mData": "Department1" },
                { "mData": "ServicingAt" },
                { "mData": "TestField" }, 
                { "mData": "BranchCode" },   
                { "mData": "Created" ,"render": function (data, type, row) {
        data = moment(data).format('DD MMM YYYY');
        return data;
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-08-01T11:00:52.423

解决这个问题的最简单方法

像这样修改你的设计

```
//Add this data order attribute to td
<td data-order="@item.CreatedOn.ToUnixTimeStamp()">
                                    @item.CreatedOn
                                </td>

               Add create this Date Time helper function
// #region Region 
 public static long ToUnixTimeStamp(this DateTime dateTime) {
 TimeSpan timeSpan = (dateTime - new DateTime(1970, 1, 1, 0, 0, 0));
     return (long)timeSpan.TotalSeconds;
     } 
     #endregion
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-01-16T02:52:03.793

似乎对我有用的是

将使用从我的数据库中的选择查询获取的完整日期时间对象推送到数据集中，该对象将按数据表格式“2018-01-05 08:45:56”绘制

然后

```
 $('#Table').DataTable({
        data: dataset,
        deferRender: 200,
        destroy: true,
        scrollY: false,
        scrollCollapse: true,
        scroller: true,
        "order": [[2, "desc"]],
        'columnDefs': [
            {
                'targets': 2,
                'createdCell':  function (td, cellData, rowData, row, col) {                        
                    var datestamp = new Date(cellData);
                    $(td).html(datestamp.getUTCDate() + '-' + (datestamp.getMonth()+1) + '-' + datestamp.getFullYear());
                }
            }
        ],
        "initComplete": function(settings, json) {
            $($.fn.dataTable.tables(true)).DataTable()
                .columns.adjust();               
        }
    }); 
```

行排序正确，然后我在行中得到我想要的 html

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-02-22T14:41:58.423

我发现在这种情况下最简单的排序方法是在 JS 中添加“aaSorting”选项。

例如：

```
$(document).ready(function() {
    $('#contacts-table').dataTable({
        "aaSorting": [0, 'desc']
}); 
```

这里的问题是，此示例将排序来自第一列的条目，如 STRING，而不是日期。如果源代码允许您将日期格式从 dd/mm/yyyy 更改为 yyyy/mm/dd “aaSorting” 将正常为您工作。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-07-13T13:36:12.667

像这样使用标签`data-order`上的属性（ **Ruby Example**）：`<td>`

 **```
 <td data order='<%=rentroll.decorate.date%>'><%=rentroll.decorate.date%></td> 
```

您的装饰器功能将是：

```
 def date
    object.date&.strftime("%d/%m/%Y")
    end 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-08-10T13:11:48.517

如果您从数据库中获取日期并为每一行执行一个 for 循环并将其附加到一个字符串以在 javascript 中使用以自动填充数据表，则它需要看起来像这样。请注意，在使用隐藏跨度技巧时，您需要考虑日期的单个数字，例如如果它是第 6 小时，则需要在它之前添加一个零，否则跨度技巧在排序中不起作用.. 示例代码：

```
 DateTime getDate2 = Convert.ToDateTime(row["date"]);
 var hour = getDate2.Hour.ToString();
 if (hour.Length == 1)
 {
 hour = "0" + hour;
 }
 var minutes = getDate2.Minute.ToString();
 if (minutes.Length == 1)
 {
 minutes = "0" + minutes;
 }
 var year = getDate2.Year.ToString();
 var month = getDate2.Month.ToString();
 if (month.Length == 1)
 {
 month = "0" + month;
 }
 var day = getDate2.Day.ToString();
 if (day.Length == 1)
 {
 day = "0" + day;
 }
 var dateForSorting = year + month + day + hour + minutes; 
 dataFromDatabase.Append("<span style=\u0022display:none;\u0022>" + dateForSorting +
 </span>"); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-10-22T09:54:25.563

试试这个：

```
"aoColumns": [
        null,
        null,
        null,
        null,
        {"sType": "date"},  //  "sType": "date" TO SPECIFY SORTING IS APPLICABLE ON DATE
        null
      ] 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-10-23T07:11:32.557

对于要订购的列，请保留“sType”：“date-uk”，例如：-`"data": "OrderDate", "sType": "date-uk"` 在 ajax 中完成 Datatable 脚本后，保留以下代码

```
 jQuery.extend(jQuery.fn.dataTableExt.oSort, {
            "date-uk-pre": function (a) {
                var ukDatea = a.split('/');
                return (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
            },

            "date-uk-asc": function (a, b) {
                return ((a < b) ? -1 : ((a > b) ? 1 : 0));
            },

            "date-uk-desc": function (a, b) {
                return ((a < b) ? 1 : ((a > b) ? -1 : 0));
            }
        }); 
```

然后您将以这种格式获得日期为**22-10-2018**

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-11-08T10:50:48.267

问题来源是日期时间格式。

错误样本：“MM-dd-yyyy H:mm”、“MM-dd-yyyy”

正确示例：“MM-dd-yyyy HH:mm”

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-01-10T08:58:56.123

最简单的方法是在列的每个 TD 标签的日期之前添加一个隐藏的时间戳，例如：

```
<td class="sorting_1">
    <span class="d-none">1547022615</span>09/01/2019  09:30
</td> 
```

使用默认字符串排序，时间戳将按照您想要的方式对列进行排序，并且在浏览器中呈现时不会显示。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-10-15T11:00:50.070

任何与 UTC 格式或其他人苦苦挣扎的人都可以阅读此内容

假设您有这种格式的日期

> 2019 年 10 月 15 日星期二 08:41:35 GMT+0000 (UTC)

首先我们可以使用 moment 将其转换为毫秒

例如，就我而言，我使用的是 HandleBar.js。所以我创建了一个 Helper 函数以使其更简单

```
hbs.registerHelper('dateformat', function (datetime) {
return moment(datetime).valueOf(); }) 
```

要不然

就这样转换

```
moment("Tue Oct 15 2019 08:41:35 GMT+0000 (UTC)").valueOf(); 
```

完成后，只需将这些值传递给您的表

现在这里的诀窍是同时传递它们并以毫秒为单位隐藏一个并以 UTC 格式显示一个

```
<td >
<span class="hideThisDate">{{DATA IN MILLISECONDS}}</span> 
{{YOUR DATE IN NORMAL FORMAT}}</td> 
```

现在只需通过 CSS 以毫秒为单位隐藏

```
.hideThisDate {
 display:none;
 } 
```

你应该很高兴去！

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-03-25T23:24:11.483

I got the same issue while working with Doctrine. My datas was correctly sorted from the database with `orderBy('p.updatedAt', 'DESC')`, but when DataTable process them the final result was completly different.

The esiest way I found to resolve this is to add a hidden column timestamp in my table then order by this column when ordering by date. Full [functional example](http://live.datatables.net/fozokika/8/edit?js,console,output) here.

```
<table>
  <thead>
    <th>Some column<th>
    <th>Visible date<th>
    <th>Timestamp<th>
  </thead>

  <tbody>
    <td>Example with Twig</td>
    <td>{{ product.updatedAt ? time_diff(product.updatedAt) : '' }}</td>
    <td>{{ product.updatedAt ? product.updatedAt.getTimestamp() : '' }}</td>
  </tbody>
</table> 
```

```
$(document).ready(function() {
  let dateColumn = 1;
  let timestampColumn = 2;
  let currentColumn = timestampColumn;
  let currentDirection = "desc";

  let table = $("#dataTable").DataTable({
    "order": [
        [ timestampColumn, "desc" ],
        // If you want to keep the default order from database
        // just set "order": [] so DataTable wont define other order
    ],
    "columnDefs": [
      {
        "targets": [ timestampColumn ],
        "visible": false, // Hide the timestamp column
      },
    ]
  });

  /**
   * @var e: Events
   * @var settings: DataTable settings
   * @var ordArr: Current order used by DataTable
   *      example: [{"src":8,"col":8,"dir":"asc","index":0,"type":"string"}]
   */
  table.on("order.dt", function (e, settings, ordArr) {
    currentColumn = ordArr[0].col;
    currentDirection = ordArr[0].dir;

    if(currentColumn === dateColumn) {
      table.order([timestampColumn, currentDirection]).draw();

      // Without this line you'll get an unexpected behaviour
      table.order([dateColumn, currentDirection]); 
    }
  })
}); 
```**

# windows-phone-7 - 带参数的多个对象的事件处理程序，事件中的参数相同

> ID：12003227
> 
> 赞同：1
> 
> 时间：2012-08-17T09:30:49.070
> 
> 标签：windows-phone-7, c#-4.0

我目前正在开发 Windows phone 7 的应用程序我正在尝试获取多个 rss 提要并将每个提要显示在不同的列表框中

我创建了一个名为的自定义类

```
public class RssFeed
    {
        public string Title { get; set; }

        public string Url { get; set; }

        public ListBox MyListBox { get; set; }
    } 
```

我创建了一个 RssFeed 列表，我正在尝试执行以下操作

```
 foreach (RssFeed item in items)
            {
                WebClient webClient = new WebClient();
                webClient.DownloadStringCompleted += new DownloadStringCompletedEventHandler((sender, e) => this.webClient_DownloadStringCompleted(sender, e, item.MyListBox));
                webClient.DownloadStringAsync(new System.Uri(item.Url));    
            } 
```

我有活动

```
private void webClient_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e,ListBox listBox) 
```

问题是参数 listBox 对于所有事件都是相同的，这是我创建事件处理程序时的最后一个 ListBox

例如：我有列表项，其中第一项具有等于 ListBox1 的 MyListBox 第二项具有等于 ListBox2 的 MyListBox

将始终使用参数 ListBox2 调用事件 webClient_DownloadStringCompleted

我该怎么做才能为参数获取不同的值。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T15:11:04.360

您以错误的方式使用局部变量“项目”。由于将在代码实际运行时（在 foreach 循环结束很久之后）计算 Lambda 表达式，因此 item 变量将始终指向集合中的最后一个元素。

解决方案：

```
foreach (RssFeed item in items)
        {
            var localItem = item;
            WebClient webClient = new WebClient();
            webClient.DownloadStringCompleted += new DownloadStringCompletedEventHandler((sender, e) => this.webClient_DownloadStringCompleted(sender, e, localItem.MyListBox));
            webClient.DownloadStringAsync(new System.Uri(localItem.Url));    
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T15:15:21.833

访问修改后的关闭问题。

将您的代码更新为：

```
foreach (RssFeed item in items)
{
    var itemCopy = item;
    WebClient webClient = new WebClient();
    webClient.DownloadStringCompleted += new DownloadStringCompletedEventHandler((sender, e) => this.webClient_DownloadStringCompleted(sender, e, itemCopy.MyListBox));
    webClient.DownloadStringAsync(new System.Uri(itemCopy.Url));    
} 
```

# mysql - activerecord/mysql 将我的 latin1 数据保存为 utf8

> ID：12003228
> 
> 赞同：0
> 
> 时间：2012-08-17T09:30:54.363
> 
> 标签：mysql, ruby, activerecord, encoding

在我的数据库配置中，我有：

```
 adapter: mysql
  database: xxx
  username: xxx
  password: xxx
  host: localhost
  encoding: 'latin1' 
```

我的表定义有：`DEFAULT CHARSET=latin1`

我把它放在我的文件的顶部：

```
# encoding: iso-8859-1 
```

然而，当我保存我的记录并再次加载它时，latin1 数据已经神秘地转换为 utf8。有人可以建议我缺少的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T14:23:16.970

列的编码呢？您必须将连接、表、列和程序编码/字符集设置为相同，以使您的代码正常工作。

# iphone - iOS - resize UITableView height programmatically

> ID：12003229
> 
> 赞同：2
> 
> 时间：2012-08-17T09:30:54.887
> 
> 标签：iphone, ios, uitableview, resize, frame

I'm having a problem trying to programmatically resize the height of a `UITableView` hosted within a `UIViewController`, using iOS5 and Storyboards. The VC displays a master/detail record style with the `UITableView` displaying the detail records. Depending on the type of master record shown, a set of buttons may be needed at the foot of the screen. If the buttons are not needed then I want the `UITableView` to extend it's height to take advantage of the space available. I'm using the following code :

```
CGRect tableFrame = [tableListView frame];
if (blnApprovalRec == YES)
    tableFrame.size.height = 127;
else
    tableFrame.size.height = 170;
[tableListView setFrame:tableFrame]; 
```

This code is called whenever the master record changes, including when the screen first loads in `viewDidLoad`. The problem is that when the VC loads, the `UITableView` doesn't paint using the size specified - it just paints with the default size from IB. Once the user changes the master record so the table is reloaded then everything works fine and the size changes as required. I've tried forcing a repaint using `setNeedsDisplay`, `setNeedsLayout` and `reloadData` but none of these worked.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-17T09:49:19.103

> The problem is that when the VC loads, the UITableView doesn't paint using the size specified

This happens, when table view is loaded, but it's UI is not getting refreshed. Please verify if you have forcefully called in viewDidLoad or viewWillAppear.

Hopefully your this code is in seperate method:

```
CGRect tableFrame = [tableListView frame];
if (blnApprovalRec == YES)
   tableFrame.size.height = 127; 
else
   tableFrame.size.height = 170; 
[tableListView setFrame:tableFrame]; 
```

When the view appear initially, you may have the default selected value from master record. You can set that value/instance in calling function in viewWillAppear.

Can you show method name and code for, how you are calling above snippets of code forcefully?

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-25T09:10:06.027

You can resize UITableView programmatically but you need to create UITableView programmatically too. Don't use Storyboard.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-17T02:46:33.773

I had the same issue, just needed to move the code from

```
 - (void) viewDidLoad 
```

to

```
 - (void)viewDidAppear:(BOOL)animated 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-17T09:37:27.100

This is tricky, its hard to resize things like this dynamically.

i would try "setNeedsLayout" And "setNeedsDisplay" for your table, and your screen to force a redraw.

Other than that, I would storyboard it to the minimum size and use code to expand it.

Generally apple doesn't like us doing this, your buttons should be drawn over the top of the view inside another view, if thats possible.

Sorry I can't be more precise but I have solved all these issues by mucking around and with hacks, and giving up on resizing things and doing re-designs. Please let me know how you go though :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T09:38:25.430

Make sure you are setting the frame after the table has loaded.

Which method do you call that code in?

# emacs - 如何使用 elisp 将十六进制字符串转换为 ASCII？

> ID：12003231
> 
> 赞同：7
> 
> 时间：2012-08-17T09:31:12.027
> 
> 标签：emacs, elisp

今天我收到了一封以十六进制字节字符串形式的电子邮件回复：

```
"686170707920333974682068617665206120676f6f64206f6e6521" 
```

而且我正在考虑将字符串转换为ASCII等价物的最有效的干净方法。我会添加我对这个问题的答案，但我觉得它没有它本来可以的那么优雅。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-17T14:24:46.383

这是一个迭代解决方案

```
(defun decode-hex-string (hex-string)
  (let ((res nil))
    (dotimes (i (/ (length hex-string) 2) (apply #'concat (reverse res)))
      (let ((hex-byte (substring hex-string (* 2 i) (* 2 (+ i 1)))))
        (push (format "%c" (string-to-number hex-byte 16)) res))))) 
```

还有一个 using `loop`，如果你想避免副作用操作（你可能需要`(require 'cl)`为了使用这个）：

```
(defun decode-hex-string (hex-string)
  (apply #'concat 
     (loop for i from 0 to (- (/ (length hex-string) 2) 1) 
           for hex-byte = (substring hex-string (* 2 i) (* 2 (+ i 1)))
           collect (format "%c" (string-to-number hex-byte 16))))) 
```

一般来说，在 Elisp 和 Common Lisp 中最好避免递归；您的堆栈将因足够大的输入而崩溃，并且两种语言都不能保证尾递归（您没有使用，但仍然如此）。在 Scheme 中，情况就不同了。

顺便说一句，39 日快乐。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-16T16:57:04.917

对于那些来这里寻找...

详细说明 Inaiimathi 的答案，这里是用解码的六进制替换所选区域的代码：

```
(defun decode-hex-string (hex-string)
  (apply #'concat 
         (loop for i from 0 to (- (/ (length hex-string) 2) 1) 
               for hex-byte = (substring hex-string (* 2 i) (* 2 (+ i 1)))
               collect (format "%c" (string-to-number hex-byte 16)))))

(defun hex-decode-region (start end) 
  "Decode a hex string in the selected region."
  (interactive "r")
  (save-excursion
    (let* ((decoded-text 
            (decode-hex-string 
             (buffer-substring start end))))
      (delete-region start end)
      (insert decoded-text))))

  (provide 'decode-hex-string)
  (provide 'hex-decode-region) 
```

将其保存在文件中，然后 Mx 加载文件。或者放在 ~/emacs.d 上，或者其他什么。然后选择具有 hexa 内容和 Mx hex-decode-region 的区域。享受！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-18T05:13:27.360

如果您使用 Magnar Sveen 的[`dash.el`](https://github.com/magnars/dash.el)列表 API（并且应该），请尝试：

```
(concat (--map (string-to-number (concat it) 16) (-partition 2 (string-to-list "686170707920333974682068617665206120676f6f64206f6e6521")))) 
```

该解决方案使用 Emacs 函数[`string-to-number`](https://www.gnu.org/software/emacs/manual/html_node/elisp/String-Conversion.html#index-string_002dto_002dnumber-263)，`string-to-list`and [`concat`](https://www.gnu.org/software/emacs/manual/html_node/elisp/Creating-Strings.html#index-concat-241)，and`dash.el`函数[`-partition`](https://github.com/magnars/dash.el#-partition-n-list)和照应版本[`-map`](https://github.com/magnars/dash.el#-map-fn-list)。好处`concat`是它不仅连接字符串，还连接字符列表或向量。我们可以使用[`->>`](https://github.com/magnars/dash.el#--x-form-rest-more)线程宏重写此代码。它采用第一个参数的结果，然后将其应用于第二个、第三个等参数，就像[Unix pipe](http://en.wikipedia.org/wiki/Pipeline_%28Unix%29)一样。

```
(->> (string-to-list "686170707920333974682068617665206120676f6f64206f6e6521")
  (-partition 2)
  (--map (string-to-number (concat it) 16))
  concat) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-10T09:16:01.853

在构建 Inaimathi 和 Shrein 提供的答案时，我还添加了一个编码函数。这是字符串和区域参数的编码和解码的实现：

```
;; ASCII-HEX converion
(defun my/hex-decode-string (hex-string)
  (let ((res nil))
    (dotimes (i (/ (length hex-string) 2) (apply #'concat (reverse res)))
      (let ((hex-byte (substring hex-string (* 2 i) (* 2 (+ i 1)))))
        (push (format "%c" (string-to-number hex-byte 16)) res)))))

(defun my/hex-encode-string (ascii-string)
  (let ((res nil))
    (dotimes (i (length ascii-string) (apply #'concat (reverse res)))
      (let ((ascii-char (substring ascii-string i  (+ i 1))))
        (push (format "%x" (string-to-char ascii-char)) res)))))

(defun my/hex-decode-region (start end) 
  "Decode a hex string in the selected region."
  (interactive "r")
  (save-excursion
    (let* ((decoded-text 
            (my/hex-decode-string
             (buffer-substring start end))))
      (delete-region start end)
      (insert decoded-text))))

(defun my/hex-encode-region (start end) 
  "Encode a hex string in the selected region."
  (interactive "r")
  (save-excursion
    (let* ((encoded-text 
            (my/hex-encode-string
             (buffer-substring start end))))
      (delete-region start end)
      (insert encoded-text)))) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-20T13:51:43.687

这是我的。我也不是说这特别地道或优雅。也许有点老派。

```
(defun hex-string-decode (str)
  "Decode STR of the form \"4153434949\" to corresponding \"ASCII\"."
  (let (decoded sub)
    (while (> (length str) 0)
      (setq sub (substring str 0 2)
            decoded (cons (string-to-number sub 16) decoded)
            str (substring str 2) ) )
    (when (not (zerop (length str))) (error "residue %s" str))
    (mapconcat #'char-to-string (nreverse decoded) "") ) ) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-01-06T23:59:55.390

起初我没有看到它必须是 Elisp 的要求，所以我以交互方式完成了它，下面的代码遵循我的交互过程。

```
 (defun decode-hex-string (hex-string)
      (with-temp-buffer
        (insert-char 32 (/ (length hex-string) 2))
        (beginning-of-buffer)
        (hexl-mode)        
        (hexl-insert-hex-string hex-string 1)
        (hexl-mode-exit)
        (buffer-string))) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-17T09:34:50.857

这是我想出的解决方案，让我觉得有点难看：

```
(defun decode-hex-string(string)
  "Decode a hex string into ASCII"
  (let* ((hex-byte (substring string 0 2))
     (rest (substring string 2))
     (rest-as-string (if (> (length rest) 2)
                 (decode-hex-string rest)
               "")))
    (format "%c%s" (string-to-number hex-byte 16) rest-as-string))) 
```

# java - 更改 Tomcat/Coyote 上的反斜杠行为

> ID：12003232
> 
> 赞同：4
> 
> 时间：2012-08-17T09:31:21.993
> 
> 标签：java, tomcat

我在 tomcat 服务器上托管了一系列 REST 服务，其中许多可以使用反斜杠 \ 作为实体 ID 的一部分，如`http://server/entitype/id\of\the\entitythatcan/have/forwardslashes/too`

现在我发现的tomcat没有提供改变这两种默认行为的方法，要么在URL上找到反斜杠时返回错误，要么用正斜杠替换\。请参阅[http://www.docjar.com/html/api/org/apache/coyote/tomcat5/CoyoteAdapter.java.html](http://www.docjar.com/html/api/org/apache/coyote/tomcat5/CoyoteAdapter.java.html)第 735 行

有没有希望在不必定制tomcat的情况下改变这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T02:01:03.133

查看`org.apache.catalina.connector. CoyoteAdapter.ALLOW_BACKSLASH`Tomcat 的[系统属性参考](http://tomcat.apache.org/tomcat-7.0-doc/config/systemprops.html)中的系统属性（请注意，该参考适用于 Tomcat 7：如果您使用 TC6，则必须查看 TC6 的文档以查看这是否是一个选项）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T16:02:59.717

不可能，我很久以前就停止了，并建议其他人找到自己的解决方法。

# scrapy - 如何在scrapy中设置TCP连接超时？

> ID：12003233
> 
> 赞同：5
> 
> 时间：2012-08-17T09:31:25.263
> 
> 标签：scrapy

爬慢网站时，老是报错：TCP connection timed out: 10060。我猜这可能是爬虫尝试与服务器建立TCP连接，而默认连接超时太低的时候。

我知道可以在scrapy中设置下载超时，但是我发现没有办法设置连接超时。有人有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-14T08:14:41.030

DOWNLOAD_TIMEOUT 可以在你的scrapy项目的settings.py中设置

[http://doc.scrapy.org/en/latest/topics/settings.html#download-timeout](http://doc.scrapy.org/en/latest/topics/settings.html#download-timeout)

# c# - VS 2010函数的参数信息不断消失

> ID：12003234
> 
> 赞同：0
> 
> 时间：2012-08-17T09:31:26.970
> 
> 标签：c#, visual-studio-2010, parameters

我的VS2010一直关闭参数信息，我的意思是告诉你函数签名的工具提示。如果我在半小时内在文本编辑器 --> C# --> 常规 --> 参数信息中打开它，我将其关闭。在我淹没在 VS2010 文档中之前，也许有人会告诉我这种特殊行为的原因？任何人？

# svnant - 带有 --no-auth-cache 选项的 svnant

> ID：12003236
> 
> 赞同：2
> 
> 时间：2012-08-17T09:31:29.973
> 
> 标签：svnant

使用 svnant 时有没有办法使用 svn 全局命令行选项？
示例选项：['--no-auth-cache'](http://svnbook.red-bean.com/en/1.6/svn-book.html#svn.tour.initial.disabling-password-caching)
我们使用 javahl 作为 svn lib。
[svnant 文档](http://subclipse.tigris.org/svnant/svn.html)没有提到这样的选项

# jquery - jQuery 上下文菜单打开对话框

> ID：12003241
> 
> 赞同：1
> 
> 时间：2012-08-17T09:31:51.867
> 
> 标签：jquery, dialog, contextmenu

它适用于带有链接的 A Href (a href="www.google.com")，但不适用于哈希 # 例如 (a href="#")。我想要做的是在单击包含# href 的上下文菜单项之一时打开 jquery 对话框。仅供参考，使用不带 jquery 上下文菜单的标准链接无论是否使用 # 都可以正常工作。

我的代码：

```
<ul id="myMenu" class="contextMenu">
    <li><a href="#" id='cmsharefolder_link' class='sharefolder_link'>
        <img src='../style/images/sharefolders.png' title='Share' />
        Share
        </a>
    </li>
    <li><a href="#" class="move_link" >
        <img src="../style/images/move.png" title="Move Folder"/>
        Move</a>
    </li>

</ul> 
```

jQuery上下文菜单：

```
 $(document).ready( function() {

        // Show menu when #myDiv is clicked
        $("#list TR").contextMenu({
            menu: 'myMenu'
        },

        function(action, el, pos) {
            $(el).attr('id').trigger('click');
        }

        );

    }); 
```

# 对话框：

```
 $(function(){
        // Dialog for moving file / folder      
        $('.move').dialog({ autoOpen: false, width: 600, modal: true });

        // Dialog for moving file / folder link
        $('.move_link').click(function(){ $('.move').dialog('open'); return false; });  

        // Dialog for moving file / folder      
        $('.sharefolder').dialog({ autoOpen: false, width: 600, modal: true });

        // Dialog for share folder link
        $('.sharefolder_link').click(function(){ $('.sharefolder').dialog('open'); sharedfolder(); return false; });                
    }); 
```

答案在 kannix 使用动作参数的评论中（例如退出）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:40:35.117

也许你可以试试

```
href="javascript:void(0)" 
```

# php - Yii - ajax 加载的表单元素的用户端验证

> ID：12003247
> 
> 赞同：3
> 
> 时间：2012-08-17T09:32:00.070
> 
> 标签：php, jquery, validation, yii

我在静态表单中使用 Yii 用户端验证，它很棒。但我不知道如何为 ajax 加载的元素添加验证器。

我有简单的表单小部件，我想通过 AJAX 将更多的输入字段加载到其中（这对于小型 jQuery 脚本没有问题）。但我不知道如何为加载的元素添加 Yii javascript 验证器 - 我的意思是自动创建的 JS 验证器，例如：

```
<script type="text/javascript">
/*<![CDATA[*/
jQuery(function($) {
$('#newsletter-form-footer').yiiactiveform({'validateOnSubmit':true,'validateOnChange':false,'afterValidate':Form.handleByAjax,'attributes':[{'id':'NewsletterForm_emailaddress','inputID':'NewsletterForm_emailaddress','errorID':'NewsletterForm_emailaddress_em_','model':'NewsletterForm','name':'emailaddress','enableAjaxValidation':false,'clientValidation':function(value, messages, attribute) {

if($.trim(value)=='') {
    messages.push("  VALIDATOR_REQUIRED");
}

if($.trim(value)!='' && !value.match(/^[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/)) {
    messages.push("  VALIDATOR_EMAIL");
}

}}]});
});
/*]]>*/
</script> 
```

有什么方法可以添加或删除该验证器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:00:57.023

这有点棘手......如果你想使用 yiiactiveform 来做，你必须：

1.  将字段添加到验证中，或
2.  从验证中删除字段

我的建议是：

1.  创建你自己的 JavaScript 验证函数（你可能想在这里复制 yii 的验证代码）

    ```
    $('#newsletter-form-footer').submit(function() {
            return MyValidator.validate();
    }); 
    ```

2.  当您将字段加载到表单中时

    ```
    //You have to get rulesORoptions
    // along with fieldName from your ajax request.
    MyValidator.add(fieldName, rulesORoptions); 
    ```

3.  当您从表单中删除字段时

    ```
    MyValidator.remove(fieldName); 
    ```

4.  MyValidator 代码在这里...

    ```
    var MyValidator = {
            fields: {},

            add: function(fieldName, rulesORoptions) {
                    this.fields[fieldName] = rulesORoptions;
            },
            remove: function(fieldName) {
                    delete this.fields[fieldName];
            },

            validate: function() {
                    var success = true;
                    for(var fieldName in this.fields) {
                            for(var rule in this.fields[fieldName]) {

                                    if( eval('MyValidator.'+rule+'($("#'+fieldName+'").val())') == false ) {
                                            $("#'+fieldName+'_em_").html("validation failed (some error text, rulesORoptions may contain error text )");
                                            success = false;
                                    }
                            }
                    }

                    return success;
            },

            /* Validation methods are here, 
               copy the javascript validation code from Yii
            */
            email: function(value) {
                    if($.trim(value)!='' && !value.match(/^[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/)) {
                            return false;
                    }

                    return true;
            },
            required: function(value) {
                    if($.trim(value)=='') {
                            return false;
                    }

                    return true;
            },
            number: function(value) {
                    if(/*copy yii validation code */) {
                            return false;
                    }

                    return true;
            },
            .....
            .....
    }; 
    ```

# machine-learning - 如何结合不同的 NLP 特征进行机器学习？

> ID：12003250
> 
> 赞同：4
> 
> 时间：2012-08-17T09:32:07.837
> 
> 标签：machine-learning, nlp, similarity, knn, feature-selection

我正在尝试使用不同的 NLP 功能进行一些 KNN 学习。例如，我想使用词袋和本地 POS 标签。

另外，我对如何计算单个特征的相似度有一些想法。就像使用计数的余弦相似度（对于词袋向量），或者可能使用汉明距离作为 POS 标签。

但是，我不知道如何将两者结合起来。该地区的人通常如何做到这一点？有人可以帮我吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T11:25:04.410

我会使用这两个特征的简单线性组合。因此，您使用余弦相似度和 POS 标签的汉明距离单独比较词袋向量，然后取两个结果的平均值。因此，如果余弦比较和汉明距离得出以下排名：

```
rank score    cosine    Hamming
-------------------------------
1             red       blue
2             blue      yellow
3             yellow    orange
4             orange    red 
```

然后最终排名（给定排名分数，您当然可以更改为，例如，如果您想更加强调排名较高的标签，则为指数规模）将如下（分数越低越好）：

```
label    total score
--------------------
blue     3
red      5
yellow   5
orange   7 
```

所以输出标签是`blue`. 在这种情况下，线性组合将 50% 的权重放在余弦相似度输出上，将 50% 的权重放在汉明距离输出上。您可以使用不同的权重（例如，70% 余弦、30% 汉明）执行测试，以找到两种测量之间的最佳平衡。

# symfony - 从控制台运行 symfony 操作

> ID：12003253
> 
> 赞同：0
> 
> 时间：2012-08-17T09:32:20.073
> 
> 标签：symfony, console, action, bundle

我的 symfony 2 控制器中有两个动作。`CrawlerBundle:Index:index`, `CrawlerBundle:Index:update`. 我需要从控制台运行索引操作。我怎样才能？我认为它始于 `php app\console ...`

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:36:03.477

将您在这些操作中执行的操作移动到[服务](http://symfony.com/doc/master/book/service_container.html)中，并从您的控制器和您将创建[的自定义命令中调用它。](http://symfony.com/doc/master/cookbook/console/console_command.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T10:37:44.713

使用[PhaxBundle](https://github.com/alcalyn/phax-bundle)。

通过仅将控制器声明为服务，您可以使用以下命令调用您的操作：

```
$ php app/console phax:action controller action -p param1:value1 -p param2:value2 
```

有一个使用 cron 删除旧评论的示例：

```
$ php app/console phax:action comment deleteOldComments -p date:2013-06-05
Old comments have been deleted: 18
$ 
```

# testing - 测试 CSHTML 页面

> ID：12003256
> 
> 赞同：0
> 
> 时间：2012-08-17T09:32:33.880
> 
> 标签：testing, razor, tdd, bdd, gui-testing

我想知道人们是否测试他们基于 MVC .NET 的 Web 服务的 gui 部分。我用过 Watin / Specflow。我对此有两个主要担忧：

1.  这些测试不仅仅是 gui。它们是系统检查。他们测试数据库和业务逻辑。对 gui 的任何重大更改都意味着必须重新编写这些测试。这里的 gui 也取决于后端的工作方式。
2.  进行的测试非常缓慢。如果这些测试需要时间，前端设计人员/编码人员就无法以 TDD 方式工作。

有没有办法单独测试 cshtml 模板？例如，传入一个假的 ViewBag，看看 cshtml 的输出是否使用了正确的值等。它们运行的​​速度有多快？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:35:47.137

> 有没有办法单独测试 cshtml 模板？例如传入一个假的 ViewBag，并查看 cshtml 的输出是否使用正确的值等。

是的，你可以看看[`RazorEngine`](http://razorengine.codeplex.com/)。

> 他们会跑多快？

去测量。但可以肯定的是，它比对实际部署的应用程序的完整 HTTP 请求要快。

# http - 应用程序池标识 503 错误

> ID：12003257
> 
> 赞同：2
> 
> 时间：2012-08-17T09:32:33.867
> 
> 标签：http, iis, webserver, application-pool

今天早上，我尝试在具有 IIS 7.5 的本地 PC 上加载我的所有网站，但我立即收到 HTTP 503 错误。

HTTPerr 日志说：2012-08-17 08:43:26 127.0.0.1 49326 127.0.0.1 80 HTTP/1.1 GET / 503 3 AppOffline web80

所以我的应用程序池没有启动。我尝试在 IIS 中重新启动应用程序池，但仍然出现错误。当我查看应用程序池时，我发现它已停止。所以我查看事件查看器：

错误：WAS：应用程序池“web80”由于服务于该应用程序池的进程中的一系列故障而被自动禁用。

警告：WAS：Windows 进程激活服务未能为应用程序池“web80”创建工作进程。数据字段包含错误号。

环顾网络和 stackoverflow，问题似乎是由应用程序池标识为 apppoolidentity 引起的。我将其更改为本地系统，并且可以正常工作。

但是，为什么这会突然停止工作呢？我已经阅读了您需要提供权限的另一个解决方案

C:\Windows\System32\config\Schema 但我没有 Schema 文件夹。这可能是原因吗？

我真的只想知道如何让应用程序池重用 apppoolidentity，或者我在哪里可以尝试一下？我可以尝试重新安装 iis，但如果我能找出导致这种情况的原因，我将来可能会阻止它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T14:32:18.410

我最近才遇到这个。在我的场景中，我在“自定义帐户”设置下将应用程序池标识设置为我的 Active Directory 帐户。最近我更新了我的密码，所以我只是相应地重置了“自定义帐户”的密码，我能够重新加载我的应用程序。 ![应用程序池设置 - 使用“自定义帐户”设置身份](../Images/c303b9e013cc3e452b53c1de1bc35983.png)

# objective-c - struct [Objective-c] 中的结构数组

> ID：12003258
> 
> 赞同：0
> 
> 时间：2012-08-17T09:32:34.813
> 
> 标签：objective-c, ios, c, arrays, struct

假设我有这些：

```
typedef id Title;

typedef struct{
    Title title;
    int pages;
}Book; 
```

到目前为止，代码还可以。但问题就在这里：

```
typedef struct{
   int shelfNumber;
   Book book;   //How can I make this an array of Book?
}Shelf; 
```

就像我在代码中的注释中所说的那样，我想将 Book 作为数组，以便它可以容纳许多书籍。这甚至可能吗？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:35:06.377

```
typedef struct{
    int shelfNumber;
    Book book[10];   // Fixed number of book: 10
 }Shelf; 
```

或者

```
typedef struct{
    int shelfNumber;
    Book *book;     // Variable number of book
 }Shelf; 
```

在后一种情况下，您将不得不使用`malloc`来分配数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:09:08.667

请注意，您可以使用[灵活的数组成员](http://www.delorie.com/gnu/docs/gcc/gcc_42.html)来实现此效果：

```
typedef struct {
    int shelfNumber;
    size_t nbooks;
    Book book[];
} Shelf; 
```

这是一个优雅的用例，因为您可以简单地使用静态数组，但是如果您需要分配一个`Shelf`size 的对象`sz`，您只需要做一个`malloc`：

```
Shelf *mkShelf(int num, size_t sz) {
    Shelf *s = malloc(sizeof(Shelf) + sz * sizeof(Book));
    if (!s) return NULL;
    *s = (Shelf){ num, sz };
    return s;
} 
```

我上面使用的复合文字和灵活的数组成员是 C99 特性，所以如果你使用 VC++ 编程，它可能不可用。

# xml - 为什么我不能使用 XPath 来查询所需的节点？

> ID：12003259
> 
> 赞同：0
> 
> 时间：2012-08-17T09:32:38.360
> 
> 标签：xml, xpath, xml-parsing

这是 XML：

```
<VDWSDirectoriesResult xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://tempuri.org/">
<Success>true</Success>
<TotalResult>6</TotalResult>
<PageResult>6</PageResult>
<Summary/>
<DirectoriesResult>...</DirectoriesResult>
</VDWSDirectoriesResult> 
```

我想获取`Success`节点，我尝试了`/VDWSDirectoriesResult/Success`or `Success`，但我仍然无法获取`Success`节点的值...我做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:37:24.457

您的根节点声明了一个默认命名空间：

```
xmlns="http://tempuri.org/" 
```

这意味着，如果您只是在 XPath 表达式中`<Success>`编写，您的节点实际上是在该名称空间中，而不是在 XPath 假定的匿名名称空间中。`Success`

根据您使用的 XPath 库，将有一些方法可以将命名空间前缀映射到命名空间 URI `http://tempuri.org/`，然后您可以在 XPath 表达式中使用它。

例如，假设您将命名空间前缀映射`tmp`到该 URI，您的 XPath 应为：

```
/tmp:VDWSDirectoriesResult/tmp:Success 
```

# android - 从辅助模块获取应用程序上下文

> ID：12003260
> 
> 赞同：3
> 
> 时间：2012-08-17T09:32:39.233
> 
> 标签：android, android-context

我正在开发一个项目，该项目具有一个主要模块（这里我有活动和控制器..）和一些辅助模块，其中我有一些日历和其他实现。

在主模块中，我有一个应用程序单例类，我在其中存储应用程序上下文，并且可以从主模块中的任何地方静态获取应用程序上下文。

问题是如何在辅助模块中创建另一个应用程序类？目前我在主模块和我想要应用程序上下文的模块之间使用循环依赖关系，我不太喜欢使用这种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-10T13:36:13.647

@David Wasser 写道：

> 为什么二级模块中的代码不能调用 MainApp.getInstance() 来获取应用上下文？显然，辅助模块依赖于主模块，所以我看不出这是一个循环依赖。
> 
> 如果没有，则将单例应用程序上下文从主模块传递给辅助模块（作为方法调用中的参数或作为辅助模块中组件的构造函数中的参数。那么辅助模块中将没有代码模块调用`MainApp.getInstance()`. 在任何情况下，您都不能拥有**另一个应用程序类**，因为只有一个应用程序类。

# json - 如何在 gxt3 中使用单个 json 对象填充商店

> ID：12003263
> 
> 赞同：0
> 
> 时间：2012-08-17T09:33:00.067
> 
> 标签：json, extjs, gxt

我正在使用 Sencha GXT3 应用程序作为 html 界面。从 REST 服务以 json 格式检索数据。我究竟如何用单个对象填充存储以供读取以及以后操作和保存？

这不是关于对象列表，而是我想要加载到商店中的特定单个 json 映射。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:32:03.940

对于商店，您基本上有两个选择列表或树。正确的？[GXT 3 商店 api](http://dev.sencha.com/deploy/gxt-3.0.0/javadoc/gxt/com/sencha/gxt/data/shared/Store.html)

你说这不是一个列表，所以你看到他们的[json 树示例的 src](http://www.sencha.com/examples/#ExamplePlace%3aasyncjsontree)

对于单个对象，我个人使用列表。我的意思是它是一个大小为 1 的列表。[json 列表示例](http://www.sencha.com/examples/#ExamplePlace%3ajsongrid)

在这两个示例中， [json 树示例](http://www.sencha.com/examples/#ExamplePlace%3aasyncjsontree)更容易理解，因为我认为它没有使用网格。也有树网格示例，但我没有立即看到 json。

这是针对第 3 版的。我认为您没有理由从 2 开始，因为 3 与本机 gwt 更相似，并且您可以混合使用 2 和三个代码（请参阅他们的教程），直到您将所有内容移植到较新的版本. 只是说...

# c# - 使用标记的 GridView 行号（仅限）

> ID：12003265
> 
> 赞同：3
> 
> 时间：2012-08-17T09:33:05.737
> 
> 标签：c#, asp.net, .net, gridview

我需要在网格视图中显示行号。使用 BoundField 或 TemplateField 显示行号的最佳方法是什么？

注意：这需要仅使用标记来完成（没有后面的代码）。

注意：排序时，行号不要按顺序排列，第一行应该按照内容往下。

我已经提到了以下内容：

1.  [http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/2eead3e3-5cc2-40f7-a91c-8f7942d5329c/](http://social.msdn.microsoft.com/forums/en-US/winformsdatacontrols/thread/2eead3e3-5cc2-40f7-a91c-8f7942d5329c/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-17T09:42:29.233

```
<asp:TemplateField HeaderText="#" >
     <ItemTemplate>
     <%# Container.DataItemIndex + 1 %>
     </ItemTemplate>
</asp:TemplateField> 
```

顺便说一句，您提到的文章中提出了这个解决方案。为什么你不喜欢它并在这里问？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T09:49:37.667

最好的地方是使用模板字段

> ```
> <asp:TemplateField HeaderText="Row Number">
>   <ItemTemplate>
>     <%# Container.DataItemIndex + 1 %>
>   </ItemTemplate>
> </asp:TemplateField> 
> ```

一个例子[http://www.devcurry.com/2010/01/add-row-number-to-gridview.html](http://www.devcurry.com/2010/01/add-row-number-to-gridview.html)

BoundField 将指定 DataSource 字段的值显示为文本。TemplateField 允许混合 html 或使用 web 控件。

请参阅以下说明以确认差异。 [http://forums.asp.net/t/1804988.aspx/1](http://forums.asp.net/t/1804988.aspx/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:39:52.673

网格视图呈现为 html 表。如果您不想在后面的代码中计算行号，则应使用 JQuery。

```
var rowCount = $('#myTable tr').length; 
```

你应该用 rowCount 值填充表格页脚。

# android - 如何启用 GPS 自动接听电话

> ID：12003267
> 
> 赞同：0
> 
> 时间：2012-08-17T09:33:09.713
> 
> 标签：android, calllog

> **可能重复：**
> [像 Tasker 一样以编程方式启用 GPS](https://stackoverflow.com/questions/4721449/enable-gps-programatically-like-tasker)

我有一个用于拨打和接听联系人电话的代码，但是如何启用 GPS 自动接听电话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:39:54.837

没有看这个[现有的问题](https://stackoverflow.com/q/4721449/940096)

```
private void turnGPSOn(){
    String provider = Settings.Secure.getString(getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);

    if(!provider.contains("gps")){ //if gps is disabled
        final Intent poke = new Intent();
        poke.setClassName("com.android.settings", "com.android.settings.widget.SettingsAppWidgetProvider"); 
        poke.addCategory(Intent.CATEGORY_ALTERNATIVE);
        poke.setData(Uri.parse("3")); 
        sendBroadcast(poke);
    }
}

private void turnGPSOff(){
    String provider = Settings.Secure.getString(getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);

    if(provider.contains("gps")){ //if gps is enabled
        final Intent poke = new Intent();
        poke.setClassName("com.android.settings", "com.android.settings.widget.SettingsAppWidgetProvider");
        poke.addCategory(Intent.CATEGORY_ALTERNATIVE);
        poke.setData(Uri.parse("3")); 
        sendBroadcast(poke);
    }
} 
```

# android - 聚焦edittext时如何显示qwerty键盘

> ID：12003268
> 
> 赞同：0
> 
> 时间：2012-08-17T09:33:11.887
> 
> 标签：android, android-edittext, android-softkeyboard, textinput

聚焦edittext时如何显示qwerty键盘？目前这个键盘正在打开： ![在此处输入图像描述](../Images/9ad84e47127adcbbdb5c69ae268b8e13.png)

但我想打开这种类型的键盘：

![在此处输入图像描述](../Images/f4360303c8c727ebfc452a644baf0211.png)

**在设置和三星设备中设置手机键盘时会发生这种情况**

我的布局.xml：

```
<com.text.view.DashedEditText
    android:id="@+id/editText"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:textSize="20dip"
    android:inputType="text" /> 
```

怎么做？提前致谢。

# dynamics-crm - 在 crm 2011 中运行 windows 应用程序

> ID：12003270
> 
> 赞同：0
> 
> 时间：2012-08-17T09:33:16.167
> 
> 标签：dynamics-crm, dynamics-crm-2011

我开发了一个 Windows 应用程序，它从网站中提取所需的数据并将数据存储在 crm 中。现在我在功能区上添加了一个按钮，我想从中调用 windows 应用程序。我可以使用下面的代码来做到这一点

```
function resume()
{

var _Object=new ActiveXObject( "WScript.Shell" ) ;
_Object.Run("C:\\ResumeGrab\\ResumeGrab.exe" );
} 
```

我现在面临的问题是，该按钮仅在本地系统中有效。我想使用 crm 从任何系统运行此应用程序。我尝试在服务器中复制 .exe 文件并尝试运行它，但是当我尝试它仅在服务器中运行而不在任何系统中运行时。如何使此应用程序在多个系统中运行，而无需单击 crm 2011 中功能区上的按钮将 .exe 文件复制到本地系统中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:17:24.177

Unfortunately your client machines will need the `.exe`. I worked on a project where the employees of the company had to be able to run an application when a button on the ribbon was clicked and this is how we went about it.

So just an extra deployment step! Copy `.exe` to `c:\ResumeGrab` on client machines.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T13:15:24.283

只要每个人都可以访问它，我认为将它放在网络共享上会比尝试将它部署到每台客户端机器更容易一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T11:32:07.767

在这种情况下，我曾多次使用“[网络部署](http://msdn.microsoft.com/en-us/library/dd465337.aspx)”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T11:27:47.170

您不能将其重新开发为 Web 服务并通过单击按钮调用服务吗？

# c# - 如何处理返回列表

> ID：12003272
> 
> 赞同：0
> 
> 时间：2012-08-17T09:33:25.373
> 
> 标签：c#

我想知道我应该如何处理从另一个类返回列表的引用？我想从调用方法中选择列表的内容？

我用数字填充列表然后返回列表的引用的简化方法

```
public List<int> Shuffle()
{
    code....
    return nameOfList;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:35:00.310

这可以。

一旦调用代码中的引用超出范围，该列表将被正确处理。

要使用该列表，您需要做的就是：

```
List<int> myList = otherObject.Shuffle(); 
```

您需要在您的方法中创建列表：

```
public List<int> Shuffle()
{
    List<int> nameOfList = new List<int>();
    code....
    return nameOfList;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:36:25.640

您必须创建列表，填充并返回它，或者您可以将它作为参数传递并填充它。

**选项 A**

```
public List<int> Shuffle()
{
    nameOfList = new List<int>();
    code....
    return nameOfList;
} 
```

**选项 B**

```
Call:
Shuffle(ref myList);

Implementation:
public List<int> Shuffle(ref List<int> myList) 
{
    // work on myList
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:35:19.510

List 是一种引用类型，因此即使您在调用的方法中实例化列表，也将始终返回引用。

# mysql - MySQL CONCAT 地址转换成用逗号分隔的字符串

> ID：12003276
> 
> 赞同：1
> 
> 时间：2012-08-17T09:33:47.690
> 
> 标签：mysql

有什么方法可以缩短/更轻松地阅读以下 SQL 来连接字符串。

```
SELECT
   CONCAT(       
    IF(location_address1 != '',
       CONCAT(location_address1, ", "),
       ""
    ),
    IF(location_address2 != '',
       CONCAT(location_address2, ", "),
       ""
    ),
    IF(location_town != '',
       CONCAT(location_town, ", "),
       ""
    ),
    IF(location_region != '',
       CONCAT(location_region, ", "),
       ""
    ),
    IF(location_postcode != '',
       CONCAT(location_postcode, ", "),
       ""
    ),
    c.country_name
   )      
FROM
   countries c      
WHERE
   c.country_id = locations.country_id LIMIT 1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:42:27.043

[CONCAT_WS()](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_concat-ws)不会跳过空字符串。但是，它会跳过分隔符参数之后的任何 NULL 值。

[NULLIF(expr1,expr2)](http://dev.mysql.com/doc/refman/5.6/en/control-flow-functions.html#function_nullif) 如果 expr1 = expr2 为真，则返回 NULL，否则返回 expr1。

所以您的查询可能是：

```
SELECT 
  CONCAT_WS(', ', 
       NULLIF(location_address1, ''),
       NULLIF(location_address2, ''),
       NULLIF(location_town, ''), 
       NULLIF(location_region, ''), 
       NULLIF(location_postcode, ''), 
       NULLIF(country_name, '')
  ) AS address
FROM
   countries c      
WHERE
   c.country_id = locations.country_id LIMIT 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T07:18:50.583

根据@Xdazz

此修剪版本：

```
SELECT 
  CONCAT_WS(', ', 
       NULLIF(Trim(location_address1), ''),
       NULLIF(Trim(location_address2), ''),
       NULLIF(Trim(location_town), ''), 
       NULLIF(Trim(location_region), ''), 
       NULLIF(Trim(location_postcode), ''), 
       NULLIF(Trim(country_name), '')
  ) AS address
FROM
   countries c      
WHERE
   c.country_id = locations.country_id LIMIT 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T09:42:27.993

您可以在 MySQL 中使用[CONCAT_WS函数：](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws)

```
SELECT CONCAT_WS(',',IF(location_address1 = '', NULL, location_address1),
                     IF(location_address2 = '', NULL, location_address2),
                     IF(location_town = '', NULL, location_town),
                     IF(location_region = '', NULL, location_region),
                     IF(location_postcode = '', NULL, location_postcode),
                     c.country_name)  AS str
FROM countries c
WHERE c.country_id = locations.country_id
LIMIT 1; 
```

甚至@Cyber​​Dem0n 建议的简单方法：

```
SELECT CONCAT_WS(',',NULLIF(location_address1,''),
                     NULLIF(location_address2,''),
                     NULLIF(location_town,''),
                     NULLIF(location_region,''),
                     NULLIF(location_postcode,''),
                     c.country_name)  AS str
FROM countries c
WHERE c.country_id = locations.country_id
LIMIT 1; 
```

`NULL`但是，如果您可以存储值而不是值，那将是更好的方法`blank`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T09:48:02.310

```
SELECT
   REPLACE(CONCAT(IF(location_address1 != '',
       CONCAT(location_address1, ", "),location_address2,", ",location_town, ", ",location_region,", " , location_postcode , ", " ,c.country_name ),',,',',')    
FROM
   countries c      
WHERE
   c.country_id = locations.country_id LIMIT 1 
```

我没有检查语法，但我的想法是不要检查每个是否为空或空，为什么不总是与“，”连接，然后将所有“，”替换为“，”。

# fonts - 将 fonts.com 服务与 javascript 一起使用时延迟 6 秒

> ID：12003277
> 
> 赞同：0
> 
> 时间：2012-08-17T09:33:57.613
> 
> 标签：fonts, font-face, webfonts

我想在我的网站上嵌入 3 种 Helvetica Neue。唯一合法的方法是使用 fonts.com，因为 Linotype 可以使用它们。所以基本上我注册并使用了他们的免费计划。这里唯一的问题是我只能使用他们的 javascript 选项，这就是为什么这是免费计划的原因。我可以使用超过 3k 的字体，但是使用它们提供的 javascript 代码会使您的文本加载延迟大约 6 秒，这很烦人。唯一的方法是升级到标准计划并使用他们的非 JavaScript 选项，但我必须每年支付 110 美元，这对于我只想使用 3 种字体的事实来说是很多的。所以我的问题是我不能只购买这 3 种字体并以任何我想要的方式嵌入吗？fonts.com 中的购买选项不适用于网络使用。或者如果我从他们那里购买了 3 种 Helvetica，我可以使用 font-face 将它们嵌入我的网站吗？

谁能建议在我的网站上使用 3 种 Helvetica Neue 的解决方案？我可以购买它们，但我必须确保我可以在我的网站上使用它们。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T15:04:28.260

我们的 JavaScript 引入的延迟通常在很大程度上是 FOUT 控制方法确保在项目中的字体准备好之前不显示使用该字体的文本。

您可以做的一件事是确保您的项目仅包含您正在使用的字体。例如，如果您只使用这三种字体，请确保它们是您项目中仅有的三种字体。

[如果您要使用“需要支持？”](http://www.fonts.com/secure/support)发送支持票 [形成](http://www.fonts.com/secure/support)并参考这篇文章，我很高兴与您进一步合作。在您的工单中，包含指向您正在使用字体的页面的链接或您帐户中的电子邮件地址以及您正在使用的项目会很有帮助。

最后，我们目前还在评估添加一些高级选项，这些选项将允许对 JavaScript 实现的行为方式进行一些控制。

# c - Float 数据类型及其赋值背后的概念

> ID：12003279
> 
> 赞同：-1
> 
> 时间：2012-08-17T09:34:06.790
> 
> 标签：c, floating-point, type-conversion

请解释一下这两条代码背后的输出/概念。

```
float x;
x=(float)3.3==3.3;
printf("%f",x); 
```

上面的输出是 0.000000

```
float x;
x=(float)3.5==3.5;
printf("%f",x); 
```

上面的输出是 1.000000

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:10:51.427

在 C 源文本中，数字“3.3”代表与数字 3.3 非常接近的 double 类型的值。好的编译器会将“3.3”转换为最接近 3.3 的 double 类型的值，即 3.29999999999999982236431605997495353221893310546875，但 C 标准并不要求这样做。

该表达式`(float) 3.3`将此 double 转换为 float，从而生成最接近 double 的 float 类型的值。该值为 3.2999999523162841796875。

然后表达式`(float) 3.3 == 3.3`将浮点值与双精度值进行比较。（这会将浮点数隐式转换为双精度数，但在此转换过程中值不会改变。）由于值不相等，因此比较的结果为 0。

由于 3.5 可以精确地表示为双精度数，因此数字“3.5”正好产生值 3.5。这也可以精确地表示为浮点数，因此将其转换为浮点数会产生 3.5。然后比较这两个值产生 1。

（这个答案假设 IEEE 754 浮点，这很常见。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:40:55.070

`3.3`不能完全用二进制浮点表示（它包含一个重复的小数部分）。将`double`文字转换`3.3`为`float`和转换回以`double`进行比较会`3.3`丢失精度，因此比较是不相等的。

对于 IEEE 64 位`double`和 32 位`float`：

*   字面`3.3`量表示为`0x1.a666666666666p+1`
*   文字`3.3f`表示为`0x1.a66666p+1`，所以`(float) 3.3`将是相同的
*   提升回双倍，我们得到`0x1.a666660000000p+1`，这显然不等于`3.3`。

`3.5`另一方面，`float`和`double`(as `0x1.cp+1`) 都可以精确表示，所以比较是相等的。

比较结果为`1`(for equal) 或`0`(for unequal)，并且您将比较结果打印为浮点数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:40:13.440

`3.3`is not a `float`but a `double`：您正在比较具有不同精度的数字。

# javascript - Javascript代码在chrome和firefox上给出错误

> ID：12003280
> 
> 赞同：0
> 
> 时间：2012-08-17T09:34:07.430
> 
> 标签：javascript, web-services, firefox, google-chrome, soap

我在代码中使用以下行来使用 javascript 使用 Web 服务

```
var ns = (wsdl.documentElement.attributes["targetNamespace"] + "" == "undefined") ? wsdl.documentElement.attributes.getNamedItem("targetNamespace").nodeValue : wsdl.documentElement.attributes["targetNamespace"].value; 
```

上面的 javascript 代码在 IE 和 safari 上运行良好，但在 chrome 和 firefox 上却在控制台上抛出错误：

```
XMLHttpRequest cannot load http://192.168.50.141:4323/HelloWorld.asmx?wsdl. Origin null is not allowed by Access-Control-Allow-Origin.
Uncaught TypeError: Cannot read property 'documentElement' of null 
```

请帮忙

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:38:25.347

如果您使用命令行运行 chrome

喜欢

```
chrome.exe --disable-web-security 
```

这是我在开发时使用的

# struts - 在表单名称 X 下创建 X 的 bean 的异常

> ID：12003282
> 
> 赞同：1
> 
> 时间：2012-08-17T09:34:16.717
> 
> 标签：struts

不久前，我使用 Struts 1.3 开发了一个小项目。上次我测试它运行良好。现在，我试图再次运行它（完全相同的代码），但我遇到了以下问题：

`javax.servlet.jsp.JspException: Exception creating bean of class test.form.SendFileForm under form name SendFileForm`

我尝试在 Tomcat 6 和 Tomcat 7 上都运行它，但没有运气。

这是 SendFileForm 类。

```
public class SendFileForm extends ActionForm{

private static final long serialVersionUID = 1L;
private static Log log = LogFactory.getLog(SendFileForm.class);

private FormFile uploadFile;

@Override
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {
    log.info("=> SendFileForm - validate - enter");
    log.info("=< SendFileForm - validate - exit");
    return super.validate(mapping, request);
}   
public FormFile getUploadFile() {
    return uploadFile;
}

public void setUploadFile(FormFile uploadFile) {
    this.uploadFile = uploadFile;
}

} 
```

我不知道为什么会出现这个问题，但是如果您需要有关其他课程的更多详细信息，请发表评论，我会提供。

**注1：**另一个答案指出，可能有类似的东西`SendFileForm SendFileForm = new SendFileForm()`显然是错误的。我没有这样的东西。

# cakephp - CakePHP2.1 find('all') 在返回数组中找不到 ModelName

> ID：12003283
> 
> 赞同：0
> 
> 时间：2012-08-17T09:34:26.013
> 
> 标签：cakephp

我在 cakePHP 中进行了以下查询：`$this->{ModelName}->find('all')` ，它返回了一个这样的数组：

```
Array
(
    [0] => Array
        (
            [0] => Array  // ModelName
                (
                    [id] => 83
                    [field1] => value1
                    [field2] => value2
                    [field3] => value3
                )
        )
    [1] => Array
        (
           ...
        )
) 
```

而不是应该是这样的正确显示：

```
Array
(
    [{ModelName}] => Array
        (
            [0] => Array  // ModelName
                (
                    [id] => 83
                    [field1] => value1
                    [field2] => value2
                    [field3] => value3
                )
        )
    [{ModelName}] => Array
        (
           ...
        )
) 
```

CakePhp 版本是 2.1

**A:不要使用PDO_MYSQL-1.0.2.tgz，请使用--with-pdo-mysql。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:27:36.780

你能检查你的服务器是否满足 cakephp 的最低要求吗？

> # 要求
> 
> *   HTTP 服务器。例如：阿帕奇。mod_rewrite 是首选，但绝不是必需的。*   PHP 5.2.8 或更高版本。
> 
> 从技术上讲，不需要数据库引擎，但我们认为大多数应用程序都会使用一个。CakePHP 支持多种数据库存储引擎：
> 
> *   MySQL（4 或更高）*   PostgreSQL*   微软 SQL 服务器*   SQLite*注意*：内置驱动都需要 PDO。您应该确保安装了正确的 PDO 扩展。

[http://book.cakephp.org/2.0/en/installation.html#Requirements](http://book.cakephp.org/2.0/en/installation.html#Requirements)

您可以在 php 的内置函数中检查您当前的版本`phpinfo()`。只需将其写在任何页面中。还要检查你的 php.ini 文件，看看你正在使用的数据库的 pdo 扩展是否安装正确

# scala - Scala - Scalaz unMkIdentity nullPointerException

> ID：12003284
> 
> 赞同：1
> 
> 时间：2012-08-17T09:34:27.457
> 
> 标签：scala, nullpointerexception, scalaz

我定义了以下类

```
private sealed trait Action2[-T1, +R] extends Function1[T1, R] {
   def printResults()
}

private abstract class BaseAction[T1, R] extends Action2[T1, R]{
  protected var result: R = null

  override final def apply(values: T1) : R = {
    result = evaluate(values)
    result
  }

  override final def printResults() {
    if(result == null)
      print("The results have not been evaluated!")
    else
      printLazyResults(result)
  }

  protected[this] def printLazyResults(results: R)
  protected[this] def evaluate(values: T1) : R
} 
```

我有这个类的实现，每当我尝试实例化给定的实现时，方法：

```
 implicit def unMkIdentity[A](x: Identity[A]): A = x.value 
```

抛出空指针异常。我首先不明白为什么调用它（我导入 scalaz 和 Scalaz）以及为什么它从属性结果中获取空值......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T13:48:08.483

通常，您会遇到以下定义的麻烦`class X[R] { var r: R = null }`：

```
scala> class X[R] { var r: R = null }
<console>:7: error: type mismatch;
 found   : Null(null)
 required: A
       class X[R] { var r: R = null } 
```

在这种情况下，发生了一些奇怪的事情，允许您的代码编译：编译器看到它有一个隐含`Identity[R] => R`的 in `unMkIdentity`，因此它将 解释`null`为的实例`Identity[R]`并尝试进行转换，这当然不起作用。

这不是预期的行为——这只是周围有很多隐含的奇怪的小后果。

在任何情况下，您都不应该编写`var r: R = null`来初始化成员变量——您应该始终使用`var r: R = _`，它会选择一个适当的默认值。[有关详细信息，请参阅语言规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)的第 4.2 节（“变量声明和定义”）。

# spring - Spring 3 和 JUnit 4（自动装配）

> ID：12003289
> 
> 赞同：1
> 
> 时间：2012-08-17T09:34:47.147
> 
> 标签：spring, junit4, autowired

我是 Spring MVC 和 JUnit 的新手。基本上我想自动装配服务类，这个类应该在spring上下文中加载。

服务

```
    @服务
    公共类 FundService {
        @自动连线
        FundDAO

        /**
         * @返回
         */
        公共列表 getFundDetails(String productId) {

            return fundDAO.getFundDetails(productId);
        }   
    }

```

应用程序上下文

```
<beans>

    <mvc:annotation-driven />

    <context:component-scan base-package="com.test.*" />
</beans> 
```

Junit类

```
    @RunWith(SpringJUnit4ClassRunner.class)
    @ContextConfiguration(locations={"classpath*:/WEB-INF/application-context.xml"})
    公共类 CompensationServiceTest {

        @自动连线
        私人基金服务基金服务；

        @测试
        公共无效验证GetCompensationList（）
        {
            System.out.println(fundService == null);
        }
    }

```

在执行测试时，我得到以下异常跟踪

```
    org.springframework.beans.factory.BeanCreationException：创建名为“com.test.admin.service.CompensationServiceTest”的bean时出错：注入自动装配的依赖项失败；嵌套异常是 org.springframework.beans.factory.BeanCreationException：无法自动装配字段：私有 com.test.admin.service.FundService com.test.admin.service.CompensationServiceTest.fundService；嵌套异常是 org.springframework.beans.factory.NoSuchBeanDefinitionException：没有为依赖项找到类型为 [com.test.admin.service.FundService] 的匹配 bean：预计至少有 1 个 bean 有资格作为此依赖项的自动装配候选者。依赖注解：{@org.springframework.beans.factory.annotation.Autowired(required=true)}
        在 org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues（AutowiredAnnotationBeanPostProcessor.java:286）
        在 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1064)
        在 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireBeanProperties(AbstractAutowireCapableBeanFactory.java:374)
        在 org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:110)
        在 org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)
        在 org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:333)
        在 org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:220)
        在 org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:301)
        在 org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
        在 org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:303)
        在 org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:240)
        在 org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
        在 org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
        在 org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
        在 org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
        在 org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
        在 org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
        在 org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
        在 org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
        在 org.junit.runners.ParentRunner.run(ParentRunner.java:236)
        在 org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:180)
        在 org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)
        在 org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
        在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
        在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
        在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
        在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
    引起：org.springframework.beans.factory.BeanCreationException：无法自动装配字段：private com.test.admin.service.FundService com.test.admin.service.CompensationServiceTest.fundService；嵌套异常是 org.springframework.beans.factory.NoSuchBeanDefinitionException：没有为依赖项找到类型为 [com.test.admin.service.FundService] 的匹配 bean：预计至少有 1 个 bean 有资格作为此依赖项的自动装配候选者。依赖注解：{@org.springframework.beans.factory.annotation.Autowired(required=true)}
        在 org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:507)
        在 org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:84)
        在 org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues（AutowiredAnnotationBeanPostProcessor.java:283）
        ... 26 更多
    原因：org.springframework.beans.factory.NoSuchBeanDefinitionException：没有为依赖项找到类型为 [com.test.admin.service.FundService] 的匹配 bean：预计至少有 1 个 bean 有资格作为此依赖项的自动装配候选者。依赖注解：{@org.springframework.beans.factory.annotation.Autowired(required=true)}
        在 org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException（DefaultListableBeanFactory.java:903）
        在 org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:772)
        在 org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:686)
        在 org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
        ... 28 更多

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T12:28:45.450

首先，`WEB-INF`文件夹不应该在类路径中；它应该在项目的文件系统中。因此，如果您使用 Maven 项目结构，该文件夹将相对于您的项目的根目录（即`src/main/webapp/WEB-INF`）。在这种情况下，您需要将该文件夹中的 XML 配置文件声明为文件系统资源，如下所示：

`@ContextConfiguration("file:src/main/webapp/WEB-INF/application-context.xml")`

其次，如果这是一个测试配置文件，则不应将其存储在`WEB-INF`. 相反，您应该将其存储在类路径中。遵循 Maven 项目结构，这将是`src/test/resources/application-context.xml`，在这种情况下，您将在测试中使用以下声明：

`@ContextConfiguration("/application-context.xml")`

或者

`@ContextConfiguration("classpath:application-context.xml")`

...无论您喜欢哪个，但请注意它们是等效的。

问候和感谢，

山姆

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-27T21:00:51.990

有两种选择：

如果你使用`@Autowire`它意味着你正在为你的测试创建一个应用程序上下文，那么有几个步骤可以实现这一点；我不想告诉你怎么做，而是告诉你正确的方法。

由于您在谈论*单元测试*，这意味着您正在测试的类是隔离的，并且注入的依赖项必须是模拟，下一个示例：

班上：

```
@RestController
@RequestMapping(value = "/")
public class CatalogRest {

    @Autowired
    private CatalogService catalogService;

    @Autowired
    private LoggedUser loggedUser;

    @RequestMapping(value = GET_VIEW_TYPE, method = POST)
    public ResponseEntity<List<ViewType>> getViewType() {

        List<ViewType> viewTypes = catalogService.getViewType(loggedUser.getUserId());
        return new ResponseEntity<List<ViewType>>(viewTypes, HttpStatus.OK);

    } 
```

现在测试：

```
 @RunWith(MockitoJUnitRunner.class)
public class CatalogRestTest {

    @InjectMocks
    private CatalogRest subject;

    @Mock
    private CatalogService catalogService;

    @Mock
    private LoggedUser loggedUser;

    @Before
    public void init() {
        MockitoAnnotations.initMocks(this);
    }

    @Test
    public void classAndItsMethodsHaveRequiredAnnotations() throws Exception {
        assertTrue(subject.getClass().isAnnotationPresent(RestController.class));
        assertTrue(subject.getClass().isAnnotationPresent(RequestMapping.class));

        Method getViewTypeMethod = subject.getClass().getMethod("getViewType");
        getViewTypeMethod.isAnnotationPresent(RequestMapping.class);
    }

    @Test
    public void getViewType_whenInvoked_returnsAListOfViewTypes() throws Exception {
        List<ViewType> viewTypes = Arrays.asList(new ViewType());

        when(loggedUser.getUserId()).thenReturn("fake user");
        when(catalogService.getViewType(eq("fake user"))).thenReturn(viewTypes);

        ResponseEntity<List<ViewType>> result = subject.getViewType();

        assertNotNull(result);
        assertNotNull(result.getBody());
        assertTrue(result.getBody().size() == 1);

        verify(catalogService, times(1)).getViewType(eq("fake user"));
    } 
```

不要尝试使用 spring 进行单元测试，它只应该用于`integration testing`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:40:42.933

您必须使用“@Component”注释限定服务类才能在组件扫描期间被选中，对吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-08T07:05:58.870

您可以在进行 bean 配置的地方发布代码吗？这里的问题是 Spring 试图找到一个具体的类来连接

```
@Autowired
private FundService fundService; 
```

您需要指定 Spring 应该在您的配置中注入的 bean。例如，在 XML 中执行此操作时，您会说：

```
<beans>

    <mvc:annotation-driven />
    <context:component-scan base-package="com.test.*" />

    <!-- Assuming FundServiceImpl is a class that implement FundService -->
    <bean id="fundService" class="com.test.admin.service.FundServiceImpl"/> 
</beans> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-16T15:16:12.977

就我而言，我有嵌套的分类/参数化测试：

**前**

```
@RunWith(Enclosed.class)
@ContextConfiguration(classes = {TestX.class})
public class SimpleTest {

...
@RunWith(Parameterized.class)
public static class SimpleCheckAddTest{
.....
}

@RunWith(Parameterized.class)
public static class SimpleCheckRemoveTest{
.....
}

} 
```

并得到：<.....Unsatisfied dependency express through field......> 异常之类的。

**后**

```
@RunWith(Enclosed.class)
public class SimpleTest {

...
@RunWith(Parameterized.class)
@ContextConfiguration(classes = {TestX.class})
public static class SimpleCheckAddTest{
.....
}

@RunWith(Parameterized.class)
@ContextConfiguration(classes = {TestX.class})
public static class SimpleCheckRemoveTest{
.....
}

} 
```

# azure - 运行 Azure 数据同步时出现同步失败错误

> ID：12003291
> 
> 赞同：0
> 
> 时间：2012-08-17T09:34:53.767
> 
> 标签：azure, azure-sql-database, data-synchronization, azure-data-sync

首先设置 azure 数据同步，它运行正常，也做了一段时间的适当同步。

但是运行一个多小时后，我得到了如下错误。

> 同步失败，出现异常“应用批处理文件 C:\Users\xxx\AppData\Local\Temp\xxx\xxx.batch 时发生意外错误。有关详细信息，请参阅内部异常。内部异常：索引超出范围数组。

是因为我的客户我的 Sql 服务器吗？我正在使用 SQL Server 2008 R2。

提前太赫兹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T05:59:19.477

最近更新了数据同步服务。您可能想在这里下载最新的代理：http: [//www.microsoft.com/en-us/download/details.aspx?id=27693](http://www.microsoft.com/en-us/download/details.aspx?id=27693)

# javascript - 用 Javascript 替换图像和图像标题/替代文本

> ID：12003292
> 
> 赞同：3
> 
> 时间：2012-08-17T09:34:54.147
> 
> 标签：javascript, html, image

我目前有以下代码在单击缩略图时替换大图像：

Javascript：

```
 img1 = new Image();
    img1.src = '{$smarty.const.dir_images}/l_{$this_page.image1}';
    img2 = new Image();
    img2.src = '{$smarty.const.dir_images}/l_{$this_page.image2}'; 
```

缩略图 HTML：

```
 <a href="javascript:document['mainimage'].src = img1.src; javascript:void(0);"><img src="{$smarty.const.dir_images}/t_{$this_page.image1}" title="" alt=""/></a>
    <a href="javascript:document['mainimage'].src = img2.src; javascript:void(0);"><img src="{$smarty.const.dir_images}/t_{$this_page.image2}" title="" alt=""/></a> 
```

大图 HTML：

```
 <img id="mainimage" name="mainimage" src="{$smarty.const.dir_images}/l_{$this_page.image1}" title="{$this_page.image1text}" alt="{$this_page.image1text}" /> 
```

我想要做的不仅是在单击缩略图时更改大图像源，而且还要更改 alt 和标题标签。

提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-17T10:00:22.253

尝试使用这种方式：

JavaScript

```
img1.alt="Image alt";
img1.title="Image title"; 
```

缩略图 HTML：

```
<a href="javascript:document['mainimage'].src = img1.src;document['mainimage'].alt = img1.alt; document['mainimage'].title = img1.title; javascript:void(0);"><img src="{$smarty.const.dir_images}/t_{$this_page.image1}" title="" alt=""/></a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T09:45:12.713

使用 setAttribute ：

```
document.getElementById("mainimage").setAttribute("alt", "My new Alt"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:23:08.813

没有 jquery，您可以通过从父级中删除元素来替换元素，然后添加新元素

```
 <script type="text/javascript">
        function replaceImage(img , num){
            var parentNode = img.parentNode;
            parentNode.removeChild(img);
            parentNode.innerHTML += '<img id="mainimage" name="mainimage" src="{$smarty.const.dir_images}/l_{$this_page.image' + num + '}" title="{$this_page.image' + num + 'text}" alt="{$this_page.image' + num + 'text}" />'
        }
    </script>
    <img src="{$smarty.const.dir_images}/t_{$this_page.image1}" title="" alt="" onclick="replaceImage(this ,1)"/>
    <img src="{$smarty.const.dir_images}/t_{$this_page.image2}" title="" alt="" onclick="replaceImage(this ,2)"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T09:40:48.680

你的意思是这个（jQuery方式）

```
img1.attr('alt','this is alt');
img1.attr('title', 'this is title'); 
```

# php - Facebook Connect - 错误 310 (net::ERR_TOO_MANY_REDIRECTS)：重定向过多

> ID：12003299
> 
> 赞同：2
> 
> 时间：2012-08-17T09:35:12.433
> 
> 标签：php, facebook

尝试注销 facebook connect 时出现此错误

> 错误 310 (net::ERR_TOO_MANY_REDIRECTS)：重定向太多。

```
function facebook_logout(){

        $user = $_SESSION[ 'facebook_userid' ];

        $facebook = new Facebook( array(

            'appId'  => APP_ID,
            'secret' => APP_SECRET,

        ) );

        $_SESSION[ 'facebook_userid' ] = "";
        $_SESSION[ 'logged' ] = FALSE;
        $url = $facebook->getLogoutUrl();

        header( "Location: $url" );

}

facebook_logout(); 
```

# java - Android Edittext的起始值不能是我数组上的第一个Item（Edittext Spinner）

> ID：12003300
> 
> 赞同：1
> 
> 时间：2012-08-17T09:35:16.037
> 
> 标签：java, android, spinner

这一定是一个我可能再次忽略的简单问题。这是我的问题我的 string.xml 上有一个字符串数组

```
<string-array name="country_array">
    <item>Alabama</item>
    <item>Florida</item>
    <item>Los Angeles</item>
    <item>Virginia</item>
    <item>California</item>
    <item>Texas</item>
    <item>Hawaii</item>
    <item>Miami</item>
    <item>New Jersey</item>
    <item>Boston</item>
    <item>Philadelphia</item>
    <item>VaChina</item>
 </string-array> 
```

所以现在我正在调用我的主要活动并将其放在我的微调器上

```
selectedCountry = (EditText) findViewById(R.id.etCity);
    //get the spinner from resource
    Spinner spinner = (Spinner) findViewById(R.id.spinnerCountry);

    //then defining ArrayAdapter using country_array
    ArrayAdapter<CharSequence> adapter =ArrayAdapter.createFromResource(this, R.array.country_array,
            android.R.layout.simple_spinner_item);
    //set the appearance of widget items that show when open the widget
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    //set the adapter to spinner
    spinner.setAdapter(adapter);
    //set the action listener
    spinner.setOnItemSelectedListener(listener); 
```

现在在我的微调器的 onclicklistener 上，这是我的代码

```
View.OnClickListener selectCountry = new View.OnClickListener() {
         public void onClick(View v) {
             Spinner spinner = (Spinner) findViewById(R.id.spinnerCountry);
             spinner.performClick();
         }  
    };

    private OnItemSelectedListener listener =new OnItemSelectedListener() {
        //do what ever you want to do when item selected
        public void onItemSelected(AdapterView<?> parent, View view, int pos,
                long id) {
            //i get the item using selected item position and set it into selectedCountry
            selectedCountry.setText(parent.getItemAtPosition(pos).toString());          
        }

        public void onNothingSelected(AdapterView<?> parent) {

        }

    }; 
```

一切正常，直到我发现我的 selectedCountry 文本是我数组中的第一项。无论如何我可以在我的edittext上添加一个默认值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:44:52.763

请在您的字符串数组中添加“选择国家”作为第一项。

喜欢

```
<string-array name="country_array">
    <item>Select Country</item>
    <item>Alabama</item>
    <item>Florida</item>
    <item>Los Angeles</item>
    <item>Virginia</item>
    <item>California</item>
    <item>Texas</item>
    <item>Hawaii</item>
    <item>Miami</item>
    <item>New Jersey</item>
    <item>Boston</item>
    <item>Philadelphia</item>
    <item>VaChina</item>
 </string-array> 
```

然后

在 onItemSelected() 中添加以下代码

```
public void onItemSelected(AdapterView<?> adapterView, View view,int position, long arg3) 
{
    if(!spinner.getSelectedItem().toString().equalsIgnoreCase("Select Country"))
    {
          selectedCountry.setText(spinner.getSelectedItem().toString());  
    }
} 
```

# algorithm - 用于缩小的双三次插值

> ID：12003306
> 
> 赞同：2
> 
> 时间：2012-08-17T09:35:41.703
> 
> 标签：algorithm, interpolation

似乎双三次插值仅适用于高档。我已经尝试过这些功能：http: [//jsperf.com/pixel-interpolation/4](http://jsperf.com/pixel-interpolation/4)和 [http://www.reddit.com/r/javascript/comments/jxa8x/bicubic_interpolation/](http://www.reddit.com/r/javascript/comments/jxa8x/bicubic_interpolation/)

我还尝试了 Gernot Hoffmann 的“图像扭曲插值”一书中的双三次插值算法。

但是使用上述方法缩小后的所有图像看起来都像是被近邻插值的。

也许我错了？

我还注意到，在 Photoshop 中，双三次插值有两个单独的选项：Bicubic Smoother（用于高档）和 Bicubic Sharper（用于缩减）。

那么也许有人知道用于缩小比例的双三次插值算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T01:47:47.943

我刚刚写了一个双三次插值算法......我工作得很好。在运行它之前，根据您的图像更改一些值；

**行列**

```
#define ROW 218     //change 218 to your image's horizantol pixels 
#define COLUMN 329` //change 329 to your image's vertical pixels 
```

**ZOOM_RATE & ZOOM_NUM**

ZOOM_RATE 是您的图像调整大小的速率，如果您想复制它然后将其设为“2”

ZOOM_NUM=1/ZOOM_RATE -> ZOOM_NUM 在 ZOOM_RATE 上等于 1

**图像的名称和扩展名**

在**int main()**函数中更改

```
readPpm("irfan.ppm");    //change irfan to your image's name 
```

这是源代码：（这个代码也有双线性插值，所以你可以比较你的结果）

```
#include <stdio.h>
#include <stdlib.h>
#include <iostream>
#include <fstream>
#include <string.h>
#include <string>
#include <sstream>
#include <string.h>
#include <vector>
#include <math.h>

using namespace std;
#define ROW 218
#define COLUMN 329
#define ZOOM_RATE 2
#define ZOOM_NUM 1/2

struct POINT {   // Declare POINT structure
   int x;   // Define members x and y
   int y;
   int renk;
} ;    // Variable spot has
                        // values x = 20, y = 40

typedef struct POINT coordinate;     // Variable there has POINT type

int int_arr[ROW][COLUMN*3];
int int_arr_simple[ROW][COLUMN];
int zoom_photo[(int)(ROW*ZOOM_RATE)][(int)(COLUMN*ZOOM_RATE)];
int zoom_photo_bicubic[(int)(ROW*ZOOM_RATE)][(int)(COLUMN*ZOOM_RATE)];
string filetype;
string comment;
string size;
string colorrange;

int line_find(int ,int,int,int,float);
void save2Ppm(string filename,int pixel[ROW][COLUMN*3],int size);
void save2Pgm(string filename,int pixel[ROW][COLUMN],int size);
void save2Pgm_zoom(string filename,int pixel[ROW*ZOOM_RATE][COLUMN*ZOOM_RATE],int size);
void readPpm(string);
void zooming();
void zooming_bilinear();
void zooming_bicubic();
int bicubic_function(float x_cor,float y_cor);

void save2Pgm_zoom(string filename,int pixel[ROW*ZOOM_RATE][COLUMN*ZOOM_RATE],int size){
    ofstream Picture;
    Picture.open(filename);
    Picture<<"P2\n#"<<filename<<"\n"<<(int)(COLUMN*ZOOM_RATE)<<" "<<(int)(ROW*ZOOM_RATE)<<"\n"<<size<<"\n";    

    for(int i=0 ; i<ROW*ZOOM_RATE ; i++)
    {
        for(int j=0; j<COLUMN*ZOOM_RATE; j++){
            Picture<<pixel[i][j]<<" ";
        }
    }
    Picture.close();
}
void zooming(){
    for(int i=0;i<ROW*ZOOM_RATE;i++){
        for(int j=0;j<COLUMN*ZOOM_RATE;j++){
            zoom_photo[i][j]=int_arr_simple[i*ZOOM_NUM][j*ZOOM_NUM];
        }
    }   
}
void save2Pgm(string filename,int pixel[ROW][COLUMN],int size){
    ofstream Picture;
    Picture.open(filename);
    Picture<<"P2\n#"<<filename<<"\n"<<COLUMN<<" "<<ROW<<"\n"<<size<<"\n";    

    for(int i=0 ; i<ROW ; i++)
    {
        for(int j=0; j<COLUMN; j++){
            Picture<<pixel[i][j]<<" ";
        }
    }
    Picture.close();
}
void save2Ppm(string filename,int pixel[ROW][COLUMN*3],int size){
    ofstream Picture;
    Picture.open(filename);
    Picture<<"P3\n#"<<filename<<"\n"<<COLUMN<<" "<<ROW<<"\n"<<size<<"\n";    

    for(int i=0 ; i<ROW ; i++)
    {
        for(int j=0; j<COLUMN*3; j++){
            Picture<<pixel[i][j]<<" ";
        }
    }
    Picture.close();
}
void readPpm(string filename){
    ifstream Picture(filename);
    //Picture.open(filename);
    char take[10000];

    if(!Picture)
        printf("FILE NOT OPEN!!!!!!\n");
    else
    {
        Picture.getline( take, 10000 ); 
        for(int i = 0; take[i] != 0; i++)
            filetype += take[i];
        Picture.getline( take, 10000 );
        for(int i = 0; take[i] != 0; i++)
            comment += take[i];
        Picture.getline( take, 10000 );
        for(int i = 0; take[i] != 0; i++)
            size += take[i];
        Picture.getline( take, 10000 ); 
        for(int i = 0; take[i] != 0; i++)
            colorrange += take[i];

        Picture.getline( take, 10000 ,' ');
        int_arr[0][0]=atoi(take);
        for(int i=1,j=0,t=0;i<ROW*COLUMN*3;i++){    
            Picture.getline( take, 10000 ,' ');
            t=i%(COLUMN*3);
            if(i%(COLUMN*3)==0)
                j++;
            int_arr[j][t]=atoi(take);
            int_arr_simple[j][t/3]=int_arr[j][t];
        }
        Picture.close();
    }
}
void zooming_bilinear(){
    double x,y;
    double result_x,result_y,result;
    double x_1,x1;
    double y_1,y1;
    for(int i=0;i<ROW*ZOOM_RATE;i++){
        for(int j=0;j<COLUMN*ZOOM_RATE;j++){
            y=(double)ZOOM_NUM*i;
            x=(double)ZOOM_NUM*j;

            x_1 = (int)x;       y_1 = (int)y;
            x1  = (int)(x+1);    y1 = (int)(y+1);

            result_x=(double)(x1-x)*int_arr_simple[(int)y_1][(int)x_1]/(double)(x1-x_1) + (double)(x-x_1)*int_arr_simple[(int)y_1][(int)x1]/(double)(x1-x_1);
            result_y=(double)(x1-x)*int_arr_simple[(int)y1][(int)x_1] /(double)(x1-x_1) + (double)(x-x_1)*int_arr_simple[(int)y1][(int)x_1]/(double)(x1-x_1);
            result=(double)(y1-y)*result_x/(double)(y1-y_1)                   + (double)(y-y_1)*result_y /(double)(y1-y_1   );

            zoom_photo[i][j]=result;
        }
    }   

}
void zooming_bicubic(){
    double x,y;
    double result_x,result_y,result;
    double x_1,x1;
    double y_1,y1;

    //zoom 16 pixel arasında olduğu için verileri atmaya 2,2 den başlıyor   ve 2 birim önce bitiyor...
    for(int i=1;i<ROW*ZOOM_RATE-1;i++){
        for(int j=1;j<COLUMN*ZOOM_RATE-1;j++){
            zoom_photo_bicubic[i][j]=bicubic_function((float)ZOOM_NUM*j,(float)ZOOM_NUM*i);
        }
    }   
}
int bicubic_function(float x_cor,float y_cor){//bicubic yöntemle renk döndürmek için kullanılan fonksiyon
    coordinate nokta[4][4];
    int result;//en sonunda rengi döndüren variable
    nokta[0][0].x=(int)y_cor-1;             nokta[0][0].y=(int)x_cor-1;
    nokta[0][1].x=(int)y_cor-1;             nokta[0][1].y=(int)x_cor;
    nokta[0][2].x=(int)y_cor-1;             nokta[0][2].y=(int)x_cor+1;
    nokta[0][3].x=(int)y_cor-1;             nokta[0][3].y=(int)x_cor+2;
    nokta[1][0].x=(int)y_cor;               nokta[1][0].y=(int)x_cor-1;
    nokta[1][1].x=(int)y_cor;               nokta[1][1].y=(int)x_cor;
    nokta[1][2].x=(int)y_cor;               nokta[1][2].y=(int)x_cor+1;
    nokta[1][3].x=(int)y_cor;               nokta[1][3].y=(int)x_cor+2;
    nokta[2][0].x=(int)y_cor+1;             nokta[2][0].y=(int)x_cor-1;
    nokta[2][1].x=(int)y_cor+1;             nokta[2][1].y=(int)x_cor;
    nokta[2][2].x=(int)y_cor+1;             nokta[2][2].y=(int)x_cor+1;
    nokta[2][3].x=(int)y_cor+1;             nokta[2][3].y=(int)x_cor+2;
    nokta[3][0].x=(int)y_cor+2;             nokta[3][0].y=(int)x_cor-1;
    nokta[3][1].x=(int)y_cor+2;             nokta[3][1].y=(int)x_cor;
    nokta[3][2].x=(int)y_cor+2;             nokta[3][2].y=(int)x_cor+1;
    nokta[3][3].x=(int)y_cor+2;             nokta[3][3].y=(int)x_cor+2;

    float xline_1,xline_2,xline_3,xline_4;

    int P00,P01,P02,P03;
    P00=int_arr_simple[nokta[0][0].x][nokta[0][0].y-1];
    P01=int_arr_simple[nokta[0][1].x][nokta[0][1].y-1];
    P02=int_arr_simple[nokta[0][2].x][nokta[0][2].y-1];
    P03=int_arr_simple[nokta[0][3].x][nokta[0][3].y-1];

    int P10,P11,P12,P13;
    P10=int_arr_simple[nokta[1][0].x][nokta[1][0].y-1];
    P11=int_arr_simple[nokta[1][1].x][nokta[1][1].y-1];
    P12=int_arr_simple[nokta[1][2].x][nokta[1][2].y-1];
    P13=int_arr_simple[nokta[1][3].x][nokta[1][3].y-1];

    int P20,P21,P22,P23;
    P20=int_arr_simple[nokta[2][0].x][nokta[2][0].y-1];
    P21=int_arr_simple[nokta[2][1].x][nokta[2][1].y-1];
    P22=int_arr_simple[nokta[2][2].x][nokta[2][2].y-1];
    P23=int_arr_simple[nokta[2][3].x][nokta[2][3].y-1];

    int P30,P31,P32,P33;
    P30=int_arr_simple[nokta[3][0].x][nokta[3][0].y-1];
    P31=int_arr_simple[nokta[3][1].x][nokta[3][1].y-1];
    P32=int_arr_simple[nokta[3][2].x][nokta[3][2].y-1];
    P33=int_arr_simple[nokta[3][3].x][nokta[3][3].y-1];

                    xline_1=line_find(P00,P01,P02,P03, x_cor-(int)x_cor);
                    xline_2=line_find(P10,P11,P12,P13, x_cor-(int)x_cor);
                    xline_3=line_find(P20,P21,P22,P23, x_cor-(int)x_cor);
                    xline_4=line_find(P30,P31,P32,P33, x_cor-(int)x_cor);
      result=line_find(xline_1,xline_2,xline_3,xline_4,y_cor-(int)y_cor);

    return result;

}
int line_find(int P0,int P1,int P2,int P3, float x) {   // bir denklemin "rengini" çevirmek için kullanılır....
    float A,B,C,D,result;
    A=(float)(-(float)1/2)*(float)P0 + ((float)3/2)*(float)P1       + (-(float)3/2)*(float)P2 + ((float)1/2)*(float)P3   ;
    B=(float)P0     + (-(float)5/2)*(float)P1       + (2)*(float)P2 + (-(float)1/2)*(float)P3           ;
    C=(-(float)1/2)*(float)P0   + ((float)1/2)*(float)P2                                        ;
    D=(float)P1                                                     ;
    result=A*x*x*x + B*x*x + C*x + D ;
    return result;
}
int main (){
    readPpm("irfan.ppm");
    save2Ppm("ppm",int_arr,255);
    save2Pgm("pgm",int_arr_simple,255);
    zooming_bilinear();
    save2Pgm_zoom("zoom_bilinear",zoom_photo,255);
    zooming_bicubic();
    save2Pgm_zoom("zoom_bicubic",zoom_photo_bicubic,255);
    return 0;
} 
```

# javascript - 带有 .txt 输出的富文本编辑器

> ID：12003315
> 
> 赞同：2
> 
> 时间：2012-08-17T09:36:13.903
> 
> 标签：javascript, jquery, html

有人知道带有另存为.txt 选项的富文本编辑器吗？
谢谢

编辑：澄清：我正在为我的网站寻找一个富文本框，而不是为我的计算机寻找一个程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T13:09:11.743

您可以使用任何文本编辑器，例如 TinyMCE 或 CKEditor，并使用 PHP 的[`strip_tags()`](http://php.net/manual/en/function.strip-tags.php)功能。

在剥离标签之前，您可以发出一些`str_replace()`调用来将`<br />`s 和`</p><p>`s 转换为`\n`s。

如果你想*变得时髦*，你可以在这样的脚本中添加很多东西，比如替换`<hr />`为`----------------`或类似的东西。但在基本层面上，以上应该就足够了。

# javascript - Javascript IN 运算符的问题

> ID：12003316
> 
> 赞同：0
> 
> 时间：2012-08-17T09:36:15.967
> 
> 标签：javascript

`IN`关于javascript中的运算符，我有一个小问题。

正如我们所知，这[简化了冗余逻辑 OR](http://www.dzone.com/snippets/using-javascripts-operator)。

我有以下声明：

```
if(value==="abc" || value==="cde" || value==="efg" || ...){
 ...
} 
```

我可以使用

```
if(value in { "abc":1, "cde":1, "efg":1, ... }){
  ...
} 
```

我将其作为示例编写，但 Google Chrome 控制台出现错误：

```
Uncaught SyntaxError: Unexpected token : 
```

我的错在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:45:07.163

为了避免在您的应用程序某处`Object.prototype`被修改时出现错误，您应该使用：

```
if(({ "abc":1, "cde":1, "efg":1, ... }).hasOwnProperty(value)){
  ...
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-17T09:45:05.443

简单地说，你可以像这样使用。

```
var foo = "bar";

if ( foo in { bar:1, foobar:1, foo:1 } ) {
  alert("yes")
} else {
  alert("No")
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T09:46:19.983

你的编码应该是...

```
if(value in { abc:1, cde:1, efg:1}){
        //...
        } 
```

# java - 在 jboss 7 上部署 java EE 应用程序

> ID：12003321
> 
> 赞同：1
> 
> 时间：2012-08-17T09:36:52.090
> 
> 标签：java, jakarta-ee, ant, jboss

我有一个 java EE 应用程序，它包含 web 模块和实体模块。我使用 netbeans、glassfish 和 javadb 创建了该应用程序。我想将此应用程序部署到 jboss 7。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:47:58.343

首先，您需要在 WEB-INF/jboss-web.xml 文件中添加以下内容；

```
 <jboss-web>
      <context-root>/mywebapp</context-root>
      <virtual-host>example.com</virtual-host>
    </jboss-web> 
```

然后您登录到管理控制台，转到 Deployments > Manage Deployments。在 Deployments 屏幕中，单击 Add Content 并上传您的 war 文件。因此，请参阅[本文](https://support.eapps.com/index.php?/Knowledgebase/Article/View/420#deployment_examples_using_jboss_7_in_standalone_mode)以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:44:56.620

将您的部署工件粘贴到：

```
JBOSS_HOME/standalone/deployments 
```

我建议使用安装了 JBoss Tools 插件的 Eclipse Indigo，以便在 JBoss AS 上进行开发。您可以通过 Eclipse Marketplace 轻松找到它们。

这是一个[很好的视频](http://www.youtube.com/watch?v=OuFaYYQVJP0)，描述了如何在 JBoss AS 7.x 上部署您的应用程序。它描述了 5 种方法来做到这一点。

# jquery - 通过 History API 使用后退和前进按钮

> ID：12003323
> 
> 赞同：8
> 
> 时间：2012-08-17T09:36:56.327
> 
> 标签：jquery, ajax, history.js

我有以下测试应用程序： http: [//dev.driz.co.uk/ajax/](http://dev.driz.co.uk/ajax/)

您可以单击链接以使用 jQuery AJAX 在其他页面中加载，并且有两种类型，globalTabs 和 localTabs 将内容加载到不同的面板中。注意：每个页面实际上是整个页面，但我们只使用 jQuery find 方法获取我们想要的内容。

为了增强这一点，我使用了 HTML5 History API（History.js for cross-browser）。

标题和网址更改得很好，历史堆栈被成功推送，当我使用后退和前进按钮时，网址和标题确实恢复了。

现在复杂的部分是从以前的状态加载回内容，更复杂的是加载正确的类型，例如全局或本地 ajax。为了实现这一点，我想我需要将数据和类型都传递给推送状态，以便它可以再次用于 popstate ......

谁能帮我指出正确的方向？我已经完成了所有第一部分的工作，只是将 ajax 类型传递给 pushState，然后通过 popstate 更改重新使用它。

**为了改进这一点，我将其重写如下，以显示我传递类型和数据的计划：**

**注意：大写的 History 是因为我使用 History.js**

```
var App = {

    init: function() {

        $(document).ready(function() {

            $('.globalTabs li a').live('click', function (e) {
                e.preventDefault(); 
                App.globalLoad( $(this).attr('href') );
            }); 

            $('.localTabs li a').live('click', function (e) {
                e.preventDefault();
                App.localLoad( $(this).attr('href') );
            });

        });

        window.addEventListener('popstate', function(event) {

            // Load correct content and call correct ajax request...

        });

    },

    localLoad: function ( url ) {

        $.ajax({
            url: url,
            success: function (responseHtml) {
                $('.localContent').html($(responseHtml).find('#localHtml'));

                $data = { $(responseHtml).find('#localHtml'), 'local'};

                History.pushState($data, $(responseHtml).filter('title').text(), url);
            }
        });

    },

    globalLoad: function ( url ) {

        $.ajax({
            url: url,
            success: function (responseHtml) {
                $('.mainContent').html($(responseHtml).find('#globalHtml'));

                $data = { $(responseHtml).find('#globalHtml'), 'global'};

                History.pushState($data, $(responseHtml).filter('title').text(), url);
            }
        });

    }

};

App.init(); 
```

**更新：为了澄清这个问题，这是我寻求帮助的两个问题。**

1.) 获取处理 ajax 请求的后退和前进按钮，以便它们将正确的数据加载回内容区域。

2.) 将内容加载到**正确**的区域，同时使用 pushState 方法传递内容，以便它知道它是全局 div 还是本地 div 请求。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-25T07:45:26.990

数据对象是错误的，这就是你遇到这个问题的原因。对象由键值对定义：

```
object = {key:'value'};
$data = { text:$(responseHtml).find('#globalHtml'), type:'global', url:'the_url'}; 
```

不是

```
$data = { $(responseHtml).find('#globalHtml'), 'global'}; 
```

使用对象定义，您将使用 History.getState() 取回数据

```
History.Adapter.bind(window,'statechange',function(){
    var data = History.getState().data;
    if(data){
        var html = data.text;
        var type = data.type;
        var type = data.url;
        if(html && type){
            if(type == 'global'){
                // just change html
                $('.mainContent').html(html);
                // call the App object's function
                if(url) App.localLoad(url);
            }else{
                $('.localContent').html(html);
            }
        }
    }
}) 
```

笔记：

*   当 statechange 事件被触发时，如果存在任何数据，它将触发 ajax 调用
*   模拟ajax调用而不只是改变标题，我认为这将涵盖它

编辑

*   数据对象实际上取自 History.getState().data 而不是 History.getState()
*   向存储的对象添加了另一个参数以保留 url
*   使用 url 和类型，您可以调用与 onClick 事件中相同的函数

问题：

> 未捕获的 TypeError：将循环结构转换为 JSON

一个对象在某处引用自己；因此消息“循环结构”。这意味着您正在尝试对具有自身引用的对象进行字符串化，这通常发生在 DOM 元素中。你真的应该考虑改变

```
$data = { $(responseHtml).find('#localHtml'), 'local'}; 
```

至：

```
$data = { html:$(responseHtml).find('#localHtml').html(), type:'local'}; 
```

注意对象的键（html 和类型）和 html 函数调用 (.html())，这样您就不会发送不必要的数据，只发送 html。如果您需要在将其作为 DOM 对象加载时使用 html 数据，请使用以下命令：

```
var DOM_Element_loaded = $('<div>').html(html_loaded); 
```

现在您可以使用 DOM_Element_loaded 在加载的 html 中搜索/操作数据，而无需将其附加到正文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T19:24:16.133

***注意**：这实际上更像是评论而不是答案，但是您可以通过答案响应获得更好的语法突出显示。*

这就是我遇到这个问题时所做的。如果我没记错的话，这可以防止双重请求问题。

```
window.onpopstate = function(event) {
  if (event.state && event.state.initialHref) {
    // make an AJAX request
    // URL for AJAX request is event.state.initialHref
  }
} 
```

当我使用`history.pushState()`/`history.replaceState()`时，我`initialHref`在对象中为第一个参数定义一个属性。我为此值使用绝对 URL，而不是相对 URL。

# c - Microsoft 的 fopen 提交模式标志在 Windows 7 上是否损坏？

> ID：12003324
> 
> 赞同：3
> 
> 时间：2012-08-17T09:36:57.823
> 
> 标签：c, windows-7, file-io, commit, fopen

我为我们公司的产品编写引擎，这些产品旨在在我们的客户信息亭上运行。这包括将文件写入磁盘的代码。

我们无法控制客户对硬件或操作系统的选择，并且我们第一次获得了可以使用的 Windows 7 Embedded。突然之间，如果刷新后立即断电，我们的安全写入就会开始失败。

尽管包含 commode.obj 会导致 fflush 提交，即使在 Win7 上，我也一直更喜欢在 Windows 上使用 MS 特定的提交模式标志（“c”）（Linux 版本使用完全不同的方法），因为正如我所写库而不是产品，我永远无法确定 commode.obj 是否真的被包含在内，所以我不能抛出错误。

```
FILE* p_f = fopen("foo.dat", "wbc");
fwrite(p_important_stuff, 1, size, p_f);
fflush(p_f); 
```

所以我的问题是：提交模式标志在 Win7 上是否被破坏，如果是这样，有没有办法可以*保证*commode.obj 被包含在内，或者是否有其他方法可以更改全局提交标志的状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:43:51.573

除了 C 文件接口暴露的问题之外，很可能还有其他问题。我正在考虑延迟写入的操作系统和文件系统决策以及 HDD 缓存，这可以解释您看到的行为。

除此之外，您应该能够始终`commode.obj`通过将库链接为 DLL 而不是静态库来简单地包含 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-18T08:37:19.707

我们还遇到了包含 commode.obj 对我们不起作用的问题。

`fflush(...)`我们没有使用，而是不使用`_flushall()`参数。

更多信息在他的存档知识库文章[https://jeffpar.github.io/kbarchive/kb/066/Q66052/](https://jeffpar.github.io/kbarchive/kb/066/Q66052/)

# c# - 无法下载html页面源

> ID：12003325
> 
> 赞同：0
> 
> 时间：2012-08-17T09:37:05.477
> 
> 标签：c#, webclient, web-scraping

```
using (var client = new WebClient())
        {
          client.DownloadFile(new Uri(@"http://www.bilyoner.com/iddaa/iddaa-liste"),path);

        }
    } 
```

我正在尝试下载 html 源代码，但我收到“底层连接已关闭：连接已意外关闭。” 例外。我尝试了不同的 url ，效果很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:56:44.280

接受压缩流就可以了。

```
HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create("http://www.bilyoner.com/iddaa/iddaa-liste");
req.UserAgent = "MOZILLA/5.0 (WINDOWS NT 6.1; WOW64) APPLEWEBKIT/537.1 (KHTML, LIKE GECKO) CHROME/21.0.1180.75 SAFARI/537.1";
req.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
req.Headers.Add("Accept-Encoding", "gzip,deflate");

GZipStream zip = new GZipStream(req.GetResponse().GetResponseStream(),
                                                      CompressionMode.Decompress);
var reader = new StreamReader(zip);
var page = reader.ReadToEnd(); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-17T09:43:23.183

参考所使用的​​编程语言在这里会有所帮助。
你确定@in

```
new Uri(@"http://www.bilyoner.com/iddaa/iddaa-liste") 
```

是正确的？
对于开发期间的调试，创建对所有连接的引用总是有用的。IE

```
myConnection =  new Uri(@"http://www.bilyoner.com/iddaa/iddaa-liste");
client.DownloadFile(myConnection, path); 
```

# c# - 如何检测到 ScrollViewer 项目的末尾（Windows 8）？

> ID：12003326
> 
> 赞同：4
> 
> 时间：2012-08-17T09:37:09.763
> 
> 标签：c#, xaml, windows-8, scrollviewer

当用户在使用 .xaml 和 C# 后置代码的 Windows 8“Metro UI”应用程序中滚动到 ScrollViewer 的末尾时，我需要做一些工作。或者，ScrollViewer 启用了捕捉点，因此检测“捕捉”事件也可以工作。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T08:59:15.980

您可以将 ListView 绑定到实现[ISupportIncrementalLoading](http://msdn.microsoft.com/en-us/library/windows/apps/Hh701916)的集合。

当有空位要填充时，额外的项目将自动加载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T10:52:55.593

也许这会有所帮助： http: [//mikaelkoskinen.net/winrt-xaml-automatically-scrolling-listview-to-bottom-and-detecting-when-listview-is-scrolled](http://mikaelkoskinen.net/winrt-xaml-automatically-scrolling-listview-to-bottom-and-detecting-when-listview-is-scrolled)

我不确定从快照模式返回时它是否有效，尚未尝试过。

干杯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T10:58:45.577

也许这会有所帮助 -[在 Windows 手机中滚动到达末尾时将项目添加到列表框？](https://stackoverflow.com/questions/10930533/add-items-to-listbox-when-scroll-reaches-the-end-in-windows-phone)

不完全是 Windows 8，但仍然是 XAML。

# c# - 屏幕键盘操作地铁

> ID：12003328
> 
> 赞同：1
> 
> 时间：2012-08-17T09:37:20.770
> 
> 标签：c#, microsoft-metro

我遇到了一个有趣但艰难的（就我而言）问题。我需要 Windows Metro 风格的应用程序来调用为某些特定文本框激活数字布局的键盘。经过一些研究，我发现甚至很难通过请求而不是谈论这种布局操作来显示/隐藏该键盘。所以我的问题是如何在 Windows Metro 中激活屏幕键盘的特定布局（如数字或表情布局）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T11:06:25.287

这篇文章可能无法为您的问题提供完整答案，但要激活文本框的数字键盘，您可以使用以下代码

```
TextBox.InputScope = new InputScope
            {
                Names =
                {
                    new InputScopeName(InputScopeNameValue.Number)
                }
            }; 
```

# javascript - 没有 window.location 的 Facebook 选项卡更改 url

> ID：12003329
> 
> 赞同：0
> 
> 时间：2012-08-17T09:37:21.963
> 
> 标签：javascript, facebook, facebook-javascript-sdk, facebook-apps

我的另一个问题。我正在构建一个 facebook 标签。要从一个页面更改为另一个页面，我正在使用 AJAX 调用，因此没有完成页面刷新。因为页面没有重新加载，所以 url 没有改变，但我还是想在 url 的末尾添加类似“#you-are-now-here”的东西，这在外面的普通网站中是可能的Facebook。有谁知道如何做到这一点？

例子：

原文网址：[https ://www.facebook.com/pagename/app_appid](https://www.facebook.com/pagename/app_appid)

我想要的网址：[https ://www.facebook.com/pagename/app_appid#you-are-now-here](https://www.facebook.com/pagename/app_appid#you-are-now-here)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:17:23.630

You should investigate the [HTML5 History API](http://diveintohtml5.info/history.html). In particular you probably want to be making use of [`history.pushState`](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history#Adding_and_modifying_history_entries).

# android - levelhelper中的“是子弹”

> ID：12003330
> 
> 赞同：0
> 
> 时间：2012-08-17T09:37:22.673
> 
> 标签：android, cocos2d-iphone, box2d-iphone

什么是 levelhelper 中使用的“子弹”属性？还有，在愤怒的小鸟这样的游戏中，小鸟在春天重装上阵……如何保持计数？以及如果我使用 levelhelper 制作类似愤怒的小鸟的游戏，如何在春天重新加载子弹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T14:13:21.077

来自 box2d 手册[http://www.box2d.org/manual.html](http://www.box2d.org/manual.html)

> **子弹**
> 
> 游戏模拟通常会生成一系列以某种帧速率播放的图像。这称为离散模拟。在离散模拟中，刚体可以在一个时间步长内大量移动。如果物理引擎不考虑大运动，您可能会看到一些对象错误地相互穿过。这种效应称为隧道效应。
> 
> 默认情况下，Box2D 使用连续碰撞检测 (CCD) 来防止动态物体穿过静态物体。这是通过将形状从旧位置扫到新位置来完成的。引擎在扫描期间寻找新的碰撞并计算这些碰撞的碰撞时间 (TOI)。物体被移动到它们的第一个 TOI，然后在剩余的时间步长内停止。
> 
> 通常动态物体之间不使用CCD。这样做是为了保持性能合理。在某些游戏场景中，您需要动态物体才能使用 CCD。例如，您可能想在一堆动态砖块上发射高速子弹。如果没有 CCD，子弹可能会穿过砖块。
> 
> Box2D 中快速移动的物体可以被标记为子弹。Bullets 将对静态和动态物体执行 CCD。你应该根据你的游戏设计决定哪些身体应该是子弹。如果您决定将身体视为子弹，请使用以下设置。
> 
> `bodyDef.bullet = true;`
> 
> 子弹标志只影响动态物体。
> 
> Box2D 顺序执行连续碰撞，因此子弹可能会错过快速移动的物体。

# javascript - Openlayers 之上的动力学层

> ID：12003333
> 
> 赞同：0
> 
> 时间：2012-08-17T09:37:30.327
> 
> 标签：javascript, dom-events, openlayers, kineticjs

我通过互联网上的各种脚本和渲染算法开发了 OpenStreetMaps 的画布可视化。最重要的是，我有一个 Kinetic Stage，它可以绘制无法通过 Openlayers 的功能绘制的自定义对象。

Openlayers 提供了许多我想使用的功能，因此我正在尝试切换到这个框架。我目前坚持事件传播，因为我不知道如何将事件传播到 Openlayers。

***索引.html***

```
<div id="canvasdiv">
  <div id="KineticDiv"> </div>
  <div id="OLMapDiv"> </div>
</div> 
```

***样式.css***

```
#KineticDiv {
  position: absolute;
  z-index: 1000;
}
#OLMapDiv {
  position: absolute;
  width: 1000px;
  height: 600px;
  z-index: 0;
} 
```

***ol.js***

```
function OpenLayersMap(divname) {
  var osmLayer = new OpenLayers.Layer.OSM("Open Street Maps",
    ["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png",
     "http://b.tile.openstreetmap.org/${z}/${x}/${y}.png",
     "http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"]);
                                        ]);
  var gmLayer = new OpenLayers.Layer.Google("Google Maps");
  var proj = new OpenLayers.Projection("EPSG:4326");

  OpenLayers.ImgPath = "/static/img/";

  this.map = new OpenLayers.Map({
    div: divname,
    allOverlays: false,
    theme: null,
    controls: [
      new OpenLayers.Control.Attribution(),
      new OpenLayers.Control.Navigation(),
      new OpenLayers.Control.LayerSwitcher(),
      new OpenLayers.Control.PanZoomBar(),
      new OpenLayers.Control.ScaleLine(),
      new OpenLayers.Control.MousePosition({
        displayProjection: proj
      }),
      new OpenLayers.Control.KeyboardDefaults()
      ]
  });
  this.map.addLayers([osmLayer, gmLayer]);
  this.map.setCenter(
    new OpenLayers.LonLat(8.56, 50).transform(proj, this.map.getProjectionObject()), 10
  );
}

OpenLayersMap.prototype = {
  constructor: OpenLayersMap
} 
```

***main.js***

```
function main() {
  var self = this;
  this.olmap = new OpenLayersMap("OLMapDiv");
  this.kinetic = new KineticStage("KineticDiv");

  $("div#canvasdiv").bind("mouseout", function(event){
// TODO self.olmap.mouseOut(event);
  }).bind("mouseup", function(event){
// TODO self.olmap.mouseUp(event);
  }).bind("mousedown", function(event){
// TODO self.olmap.mouseDown(event);
  }).bind("mousewheel", function(event, delta){
// TODO self.olmap.mouseWheel(event, delta);
  }).bind("touchmove", function(event){
// TODO self.olmap.touchMove(event);
  }).bind("touchstart", function(event){
// TODO self.olmap.touchStart(event);
  }).bind("touchend", function(event){
// TODO self.olmap.touchEnd(event);
  });
} 
```

由于 Kinetic Stage 的 z-index 较高，该事件在此处被识别。仅当命中 Kinetic Shape 时事件传播才会停止！

Openlayers 中是否有任何合适的方法可以接受事件？（我找到了OpenLayers.Events.triggerEvent，但没有成功）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T07:23:42.403

我想出了一个几乎令人满意的解决方案。只有少数事件必须由用户处理。将 TODO 替换为

```
self.olmap.map.events.handleBrowserEvent(event); 
```

启用地图上的拖放功能。这是一个如何处理*鼠标滚轮*事件的示例：

```
// main.js
$("div#canvasdiv").bind("mousewheel", function(event, delta){
   self.olmap.zoom(event, delta);
})

// ol.js
zoom : function(event, delta) {
    if(this.zoomExpireTime && this.zoomExpireTime == 0) {
        this.zoomExpireTime = event.timeStamp - 1;
    }
    if(this.zoomExpireTime < event.timeStamp) {
        this.map.zoomTo(this.map.getZoom() + delta);
        this.zoomExpireTime = event.timeStamp + 500;
    }
} 
```

不能使用 OpenLayers 的控件，因为它们只对*单击*事件作出反应，而不对 mousedown 事件作出反应。我试图将 mousedown 事件转换为单击事件，但随后拖放不再起作用。因此，我做了一个解决方法，它只将控件提升到顶部，如下所示：

```
var z = parseInt($("div#KineticDiv").css("z-index")) + 100;
$("div[id=OpenLayers\\.Control\\.LayerSwitcher_8]").css("z-index", z);
$("div[id=OpenLayers\\.Control\\.LayerSwitcher_8]").appendTo($("div#canvasdiv"));
$("div[id=OpenLayers\\.Control\\.PanZoomBar_9]").css("z-index", z);
$("div[id=OpenLayers\\.Control\\.PanZoomBar_9]").appendTo($("div#canvasdiv")); 
```

所以这是我的第一个临时解决方案，但我认为有改进它的潜力......

# iphone - AFNetworking 无法下载大文件

> ID：12003335
> 
> 赞同：1
> 
> 时间：2012-08-17T09:37:36.457
> 
> 标签：iphone, ios, afnetworking

我目前正在尝试使用 AFNetworking 下载一些文件，对于相对较小的文件，这似乎可行，但我正在尝试更大的文件（17MB），它似乎只是崩溃而没有任何错误。

该网址链接到一个本地文件：[http://test.local/wp-content/uploads/2012/07/test.pdf](http://test.local/wp-content/uploads/2012/07/test.pdf)（我在模拟器中运行它，所以这是可以访问的）

我得到的唯一输出是在进度块中

> 进度：0.009022

当我检查文件系统时，文件似乎在那里，但只有几 kb。

这是 AFNetworking 的一个已知错误，还是我只是做错了什么。

```
- (void)downloadIssue:(Issue *)issue
{
    NSString *fileName = [issue.pdf lastPathComponent];

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *filePath = [documentsDirectory stringByAppendingPathComponent:fileName];

    NSURL *url = [NSURL URLWithString:issue.pdf];
    AFHTTPClient *httpClient = [[[AFHTTPClient alloc] initWithBaseURL:url] autorelease];
    NSURLRequest *request = [httpClient requestWithMethod:@"GET" path:issue.pdf parameters:nil];

    AFURLConnectionOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
operation.outputStream = [NSOutputStream outputStreamToFileAtPath:filePath append:NO];

    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
        NSLog(@"PDF DOWNLOAD COMPLETE");

        issue.pdf_location = filePath;

        // send out a notification with the issue
        [[NSNotificationCenter defaultCenter] postNotificationName:@"PDF_DOWNLOAD_COMPLETE" object:nil userInfo:[NSDictionary dictionaryWithObject:issue forKey:@"issue"]];
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"PDF DOWNLOAD FAILED");

    // send out a notification with the issue
    [[NSNotificationCenter defaultCenter] postNotificationName:@"PDF_DOWNLOAD_FAILED" object:nil userInfo:[NSDictionary dictionaryWithObject:issue forKey:@"issue"]];
    }];

    [operation setDownloadProgressBlock:^(NSInteger bytesRead, long long totalBytesRead, long long totalBytesExpectedToRead) {
        float progress = (float)totalBytesRead / totalBytesExpectedToRead;

        NSLog(@"progress: %f", progress);

        [[NSNotificationCenter defaultCenter] postNotificationName:@"PDF_DOWNLOAD_PROGRESS" object:nil userInfo:[NSDictionary dictionaryWithObjectsAndKeys: issue, @"issue", progress, @"progress", nil]];
    }];

    [_queue addOperation:operation];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:10:57.717

我以前有过和你问题类似的经历。尝试解决这个问题，花了将近两周的时间。

你也有同样的问题。所以我很高兴终于见到你:)

这是解决方案。

如果在 downloadProgress 块中直接更新 UI，有时会出现未知错误。因为模棱两可，但我认为主线程崩溃。所以，downloadProgress 块只更新变量，使用变量执行定时器更新 UI。

```
//At the same time download
myTimer = [NSTimer timerWithTimeInterval:0.1f target:self selector:@selector(updateProgress:) userInfo:nil repeats:YES];
[[NSRunLoop currentRunLoop] addTimer:processTimer forMode:NSRunLoopCommonModes];

[operation setDownloadProgressBlock:^(NSInteger bytesRead, long long totalBytesRead, long long totalBytesExpectedToRead)
{
    //global ivar
    _progress = (float)totalBytesRead / totalBytesExpectedToRead;
}];

- (void)updateProgress:(NSTimer *)timer
{
    myProgressView.progress = _progress;
    if(fabs(1.f-_progress)<0.01f)
    {
        [timer invalidate];
    }
} 
```

# oracle - Tridion CMS & Oracle: ORA-01000: 超过最大打开游标

> ID：12003337
> 
> 赞同：5
> 
> 时间：2012-08-17T09:37:40.887
> 
> 标签：oracle, tridion, ora-01000

希望有人可以在这里帮助我。

我们使用 Tridon CMS 来管理托管在 jBoss 和 Apache 上的网站。

我们已经使用 SDL Tridion 5.3 5 年了，突然我们遇到了它背后的 Oracle 数据库的错误。我们的大部分内容作为来自文件系统的普通 jsp 页面提供，但我们有一些组件通过调用 Tridion 的 Java API 提供服务，该 API 从 Oracle 数据库返回一个 html 片段。
最近我们注意到其中一些 html 片段没有被提供，并且在检查服务器日志文件时我们发现 Oracle 错误*ORA-01000: maximum open cursors exceeded*正在生成。
我们的最大光标设置为 300，因此我们将其增加到 350 以查看是否有帮助，但没有。
监视活动的 Oracle 会话，我们可以看到许多会话已达到最大游标，因此我们重新启动了应用服务器。这似乎有所帮助，但只是暂时的。达到最大游标阈值的会话数再次逐渐增加。昨天下午重启后不久，大约有 30 个最大游标的会话，今天早上是 150 个。

显然，最近发生了一些变化，导致了这种情况，但我们不确定是什么。Oracle 数据库不是我们通常可以访问的东西，当然也不是我们直接更改的东西——所有日常数据库操作都是通过 Tridion API 发生的。就 Tridion 开发和发布而言，我们没有做任何不寻常的事情，因此与我们过去几年在那里所做的没有什么不同。我们网站的流量目前相对较低（过去明显更高），所以我们很确定那里没有问题。

我刚刚被告知可能会或可能不会连接的一件事 - 在问题出现之前不久，我们的一个内部防火墙发生故障，但我们想不出一种方法可能会导致我们看到的问题。除了防火墙故障转移，我们找不到应用服务器和数据库之间连接的任何其他更改。

有人对我们可以在哪里寻找解决方案有任何建议吗？我们刚刚向 SDL 开了一张支持票，但目前他们和我们一样困惑。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T13:22:03.113

我们过去在使用 IBM WebSphere 时遇到过类似的问题。在我们的场景中，问题的根本原因是由于防火墙的超时时间低于 AppServer 连接清理超时时间，导致空闲或陈旧连接的防火墙超时，并丢弃了应用程序服务器和 DB 之间的连接。

首先检查一下并确保这不是根本原因可能是值得的，因为我们花了很多时间分析应用程序日志和 Tridion api 等，所以我们花了一段时间才弄清楚这一点。我假设 jBoss 有类似的像 WebSphere 这样的设置。

我们实施的解决方案是`Unused Timeout`在防火墙上设置低于超时设置。这使 WebSphere Application Server 可以在防火墙丢弃未使用的连接之前清理它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T10:09:31.273

我不确定 SDL Tridion R5.3，但在 2011 SP1 中存在一个已知问题，即当未明确关闭 ResultSets 时，使用 JNDI（我相信与 WebSphere 结合）会使游标保持打开状态。

解决方案很简单，正如 Oracle 文档所述，增加允许的游标数量，或者如果您一直遇到您所说的问题，您可能会考虑不使用 JNDI。如果可能，您可以检查自己的代码以正确关闭 ResultSets（根据 JavaDoc for ResultSet:: 这不是必需的，尽管这似乎仅在不使用 JNDI 时才是正确的；使用 JNDI 时似乎会留下游标打开）。

# ios - iOS在数组中获取选定联系人的电子邮件地址

> ID：12003338
> 
> 赞同：2
> 
> 时间：2012-08-17T09:37:45.647
> 
> 标签：ios, abaddressbook, abpeoplepickerview

我要做的是向用户显示人员选择器，让他选择他想要的所有联系人，最后将所有这些联系人的电子邮件地址放在一个数组中。最好的办法是只向用户显示带有电子邮件的联系人。

到目前为止，我唯一能做的就是向人员选择器提供以下代码：

```
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
     picker.peoplePickerDelegate = self;
     [self presentModalViewController:picker animated:YES]; 
```

然后我尝试使用此代码获取所选联系人的电子邮件：

```
- (BOOL)peoplePickerNavigationController: (ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person {

ABMultiValueRef multi = ABRecordCopyValue(person, kABPersonEmailProperty);
[email addObject:(__bridge NSString*)ABMultiValueCopyValueAtIndex(multi, 0)];
[self dismissModalViewControllerAnimated:YES];

return YES;
} 
```

但是一旦我选择了一个联系人，选择器就会消失，所以我不知道如何继续。此外，当我选择一个联系人时，我会在控制台中得到这个：

```
"Unbalanced calls to begin/end appearance transitions for 
<ABMembersViewController: 0xa1618c0>." 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T20:57:22.743

我不确定你是否解决了你的问题，但如果其他人发现这篇文章也许会对他们有所帮助。我从 ABPeoplePickerNavigationController 收到电子邮件所做的是删除

```
[self dismissModalViewControllerAnimated:YES]; 
```

从

```
- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person; 
```

然后我用它来获取电子邮件并关闭控制器

```
- (BOOL)peoplePickerNavigationController(ABPeoplePickerNavigationController*)peoplePicker
  shouldContinueAfterSelectingPerson:(ABRecordRef)person
                            property:(ABPropertyID)property
                          identifier:(ABMultiValueIdentifier)identifier
{
    if (kABPersonEmailProperty == property)
    {
        ABMultiValueRef multi = ABRecordCopyValue(person, kABPersonEmailProperty);
        NSString *email = (__bridge NSString *)ABMultiValueCopyValueAtIndex(multi, 0);
        NSLog(@"email: %@", email);
        [self dismissModalViewControllerAnimated:YES];
        return NO;
    }
    return YES;
} 
```

它允许用户选择特定的电子邮件并关闭控制器而不会出现任何错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-11T16:19:59.400

据我所知，这实际上不会给您选择的电子邮件地址。如果联系人有“家庭”和“工作”电子邮件，那么`ABMultiValueCopyValueAtIndex(multi, 0)`只会给您“家庭”电子邮件。

您需要从标识符中获取所选电子邮件的索引。

```
- (BOOL)peoplePickerNavigationController:
(ABPeoplePickerNavigationController *)peoplePicker
      shouldContinueAfterSelectingPerson:(ABRecordRef)person
                                property:(ABPropertyID)property
                              identifier:(ABMultiValueIdentifier)identifier
{
    if (property == kABPersonEmailProperty) {
        ABMultiValueRef emails = ABRecordCopyValue(person, property);
        CFIndex ix = ABMultiValueGetIndexForIdentifier(emails, identifier);
        CFStringRef email = ABMultiValueCopyValueAtIndex(emails, ix);

        [self dismissViewControllerAnimated:YES completion:nil];

        [self callMethodWithEmailString:(__bridge NSString *)(email)];
        if (email) CFRelease(email);
        if (emails) CFRelease(emails);
    }

    return NO;
} 
```

相关问题：

*   [如何使用 ABPeoplePicker 获取电子邮件？](https://stackoverflow.com/questions/6736796/how-to-get-an-email-using-abpeoplepicker?rq=1)
*   [如何从 ABPeoplePicker 获取用户选择的电子邮件地址？](https://stackoverflow.com/questions/21147087/how-do-i-obtain-a-user-selected-email-address-from-abpeoplepicker?rq=1)

# php - Zend Gdata 如何检索 youtube 播放列表视频并从播放列表中排除已删除和私有

> ID：12003340
> 
> 赞同：0
> 
> 时间：2012-08-17T09:37:51.410
> 
> 标签：php, zend-framework, youtube, youtube-api

我使用 Zend_Gdata_YouTube(); 从频道中检索播放列表，但其中一些包含已删除或私人视频。当我将提要传递给

```
 new Zend_Paginator(new Lib_Paginator_Adapter_YoutubePlaylist($playlistData[$playlistParam]['feedUrl'])); 
```

它还计算已删除和私人视频，这就是出现 0 元素页面的原因。如何按隐私/存在创建查询或过滤结果？

```
$paginator = new Zend_Paginator(new Lib_Paginator_Adapter_YoutubePlaylist($playlistData[$playlistParam]['feedUrl']));
$videos = $yt->getPlaylistVideoFeed($playlistData[$playlistParam]['feedUrl']); 
```

谢谢。

更新 ：

```
$username = $this->config->youtube->username;
        $yt = new Zend_Gdata_YouTube();
        $yt->setMajorProtocolVersion(2);

    $playlistData = array();
    $playlistData['uploads'] = array(
        'title' => 'Uploads'
    );
    $playlists = $yt->getPlaylistListFeed($username);
    foreach ($playlists as $playlist) {
        $playlistId = $this->getPlaylistId($playlist->id);
        $playlistData[$playlistId] = array(
            'title' => $playlist->title->text,
            'feedUrl' => $playlist->getPlaylistVideoFeedUrl()
        );
    }

    $playlistParam = $this->getRequest()->getParam('playlist');
    if (!$playlistParam) {
        $playlistParam = 'uploads';
    }

    if ($playlistParam != 'uploads') {
        $paginator = new Zend_Paginator(new Lib_Paginator_Adapter_YoutubePlaylist($playlistData[$playlistParam]['feedUrl']));
        $videos = $yt->getPlaylistVideoFeed($playlistData[$playlistParam]['feedUrl']);
    } else {
        $paginator = new Zend_Paginator(new Lib_Paginator_Adapter_YoutubeUser($username));
        $videos = $yt->getUserUploads($username);
    }

    $data = array();
    foreach ($videos as $video) {
        $thumbnails = $video->getVideoThumbnails();
        $data[] = array(
            'id' => $this->getVideoId($video->getVideoWatchPageUrl()),
            'thumb' => $thumbnails[0]['url'],
            'title' => $video->getVideoTitle(),
            'published' => $video->getPublished()->getText(),
            'description' => $video->getVideoDescription()
        );
        break;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:32:51.480

您希望根据[yt:state](https://developers.google.com/youtube/2.0/reference#YouTube_elements_reference)的存在进行查询，如果状态标签存在，则文件由于某种原因受到限制。您还可以在[ZF gData](http://framework.zend.com/manual/en/zend.gdata.introduction.html#zend.gdata.introduction.services)和查看`Zend_Gdata_YouTube_Extension_State`. 您没有包含足够多的代码，我无法就如何调整代码提供更多建议。

祝你好运！ **[编辑]** 最好的猜测是添加一个 videoQuery 代替 getPlaylistFeed() 或作为 getPlaylistFeed() 的一部分：

```
$query = new Zend_Gdata_YouTube_VideoQuery();
$query->setParam('state', 0);//you may need to query for all of your videos this way. 
```

抱歉，我帮不上忙，但这个 api 看起来像一团糟。

# jquery - 使用 jQuery 过滤页面中包含的用户控件的 Gridview

> ID：12003341
> 
> 赞同：1
> 
> 时间：2012-08-17T09:37:52.433
> 
> 标签：jquery, asp.net, .net

我已将我的用户控件 (my.ascx) 放在网页 (1.aspx) 上。my.ascx 包含 gridview、搜索文本框和搜索按钮。我需要根据在搜索按钮单击事件中在搜索文本框中输入的文本在 gridview 中显示行。这就是我所做的。

在 1.aspx 中：

```
<script type="text/javascript" src="Scripts/jquery-1.4.1.min.js"></script>
<script type="text/javascript" language="javascript">
$(document).ready(function() {
$('#lblNoRecords').css('display','none');

$('#btnSubmit').click(function(e)
{
    // Hide No records to display label.
    $('#lblNoRecords').css('display','none'); 
    //Hide all the rows.
    $("#GridView1 tr:has(td)").hide(); 

    var iCounter = 0;
    //Get the search box value
    var sSearchTerm = $('#txtSearch').val(); 

    //if nothing is entered then show all the rows.
    if(sSearchTerm.length == 0) 
    {
      $("#GridView1 tr:has(td)").show(); 
      return false;
    }
    //Iterate through all the td.
    $("#GridView1 tr:has(td)").children().each(function() 
    {
        var cellText = $(this).text().toLowerCase();
        //Check if data matches
        if(cellText.indexOf(sSearchTerm.toLowerCase()) >= 0) 
        {    
            $(this).parent().show();
            iCounter++;
            return true;
        } 
    });
    if(iCounter == 0)
    {
        $('#lblNoRecords').css('display','');
    }
    e.preventDefault();
})
})
</script> 
```

在 my.ascx 中：

```
<asp:TextBox ID="txtSearch" runat="server" ClientIDMode="Static"
                meta:resourcekey="txtSearchResource1"></asp:TextBox>

<asp:Button ID="btnSubmit"  runat="server" ClientIDMode="Static" CssClass ="ButtonNormal" Text="Search" 
                meta:resourcekey="btnSubmitResource1" /> 

<asp:Label ID="lblNoRecords" runat="server" ClientIDMode="Static" 
                meta:resourcekey="lblNoRecordsResource1"></asp:Label>
<gridview ..........
...... 
```

但是当我点击 btnSubmit 时没有任何反应。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T10:39:24.363

尝试从以下位置替换 Gridview ID 的 jQuery 选择器实例：

```
 $("#GridView1 tr:has(td)") 
```

至

```
 $("#<%= GridView1.ClientID %> tr:has(td)") 
```

# http - 通过端口发送数据

> ID：12003343
> 
> 赞同：0
> 
> 时间：2012-08-17T09:38:17.840
> 
> 标签：http, post, web, get, port

我的要求是知道在网络交互时从我的计算机发送的请求。更具体地说，当我与网络中的不同服务通信时，我们共享数据。我需要知道交易中使用的数据。

你能告诉我任何可以帮助我做同样事情的应用程序的名称吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:43:28.923

我认为您正在寻找 WireShark：

[http://www.wireshark.org/](http://www.wireshark.org/)

它捕获通过选择以太网设备的所有数据，这可能很多，但它还提供过滤几乎任何东西以减少噪音的能力。

# mysql - Rails group_by 总量

> ID：12003344
> 
> 赞同：0
> 
> 时间：2012-08-17T09:38:19.813
> 
> 标签：mysql, ruby-on-rails, group-by

我正在使用 Rails 和 MySql，目前，我的数据在视图中显示如下：

```
Customer A, 5
Customer B, 3
Customer C, 2
Customer A, 2
Customer B, 4 
```

我希望它显示如下：

```
Customer A, 7
Customer B, 7
Customer C, 2 
```

目前我的 .html.erb 视图如下所示：

```
<% @licenses.each do |l| %>
<tr>
    <td><%= l.customer.companyname %></td>
    <td><%= l.customer.licensecontact %></td>
    <td><%= l.amount %></td>
    </td>
</tr>
<% end %> 
```

我很确定在`@licenses.each`我不确定什么之后我需要添加一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:41:34.843

根据您提供的很少信息，我认为您必须使用 Group BY

```
SELECT customer, SUM(quantity) AS quantity FROM orders GROUP BY customer 
```

使用 Rails 3

```
Order.select("customer, SUM(quantity) AS quantity").group("customer") 
```

使用 Rails 2 #这也适用于 Rails 3

```
Order.find(:all, :select => "customer, SUM(quantity) AS quantity", :group => "customer") 
```

已编辑

您必须通过以下方式获取记录

```
@licenses = License.find_by_sql("SELECT c.companyname, c.licensecontact, SUM(l.amount) 
                                  FROM licenses l 
                                  LEFT JOIN customers c ON c.id=l.customer_id
                                  GROUP BY c.companyname, c.licensecontact") 
```

将您的视图更改为关注

```
<% @licenses.each do |l| %>
<tr>
    <td><%= l.companyname %></td>
    <td><%= l.licensecontact %></td>
    <td><%= l.amount %></td>
    </td>
</tr>
<% end %> 
```

# android - 为什么我不能使用 runOnUiThread() 来更新适配器？

> ID：12003351
> 
> 赞同：1
> 
> 时间：2012-08-17T09:39:15.350
> 
> 标签：android, multithreading, user-interface, runnable

我有一个适配器和一个微调器视图，该视图设置为将适配器用于其条目。我正在从 /assets/ 文件夹中的所有文件列表中向适配器添加项目，我发现此任务需要很长时间（对于 1.5Ghz 手机上的 2 个文件列表，甚至大约需要 2 秒！）。然后我想使用一个工作线程来收集我的列表，而不是阻塞 UI 线程。这是我的代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.settings);

    adapter = new ArrayAdapter<String>(SettingsActivity.this, android.R.layout.simple_spinner_item, fontsName);       
    Spinner fontsSpinner = (Spinner) findViewById(R.id.settings_font_spinner);
    fontsSpinner.setAdapter(adapter);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);         

    // The thread to gather font names from /assets/fonts/
    thread =  new Thread(){  
        @Override  
        public void run(){  
            try {
                String[] fileList = getAssets().list("fonts");
                if (fileList != null)
                    for (int i=0; i<fileList.length; i++) {
                        adapter.add(fileList[i]);               
                    }
            } catch (IOException e) {
            }                   
            runOnUiThread(new Runnable(){
                @Override
                public void run() {
                    adapter.notifyDataSetChanged();
                }
            });
        }  
    };        
    thread.start(); 

} 
```

但它会导致错误和崩溃：

```
08-17 13:54:01.017: E/AndroidRuntime(17929): android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. 
```

我是否正确使用了 runOnUiThread()？！有趣的是，这段代码在不使用任何线程时可以完美运行，但它会阻塞 UI（这很痛苦）。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T09:49:29.010

正如 zapl 提到的，`adapter.add(Object)`必须从 UI 线程调用。

您应该使用 Android 的[AsyncTask 类](http://developer.android.com/reference/android/os/AsyncTask.html)而不是 Thread 对象。例如，您可以在 AsyncTask 的`doInBackground(Params...)`方法中从文件中加载数据并更新该`onPostExecute(Result)`方法中的列表视图。

此外，您不需要`notifyDataSetChanged()`显式调用；调用`adapter.add(Object)`将通知 ListView 适配器已更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:59:15.107

代替

```
 for (int i=0; i<fileList.length; i++) {
                    adapter.add(fileList[i]);               
                } 
```

请改用以下内容（假设`fontsName`是`ArrayList<String>`）：

```
 for (int i=0; i<fileList.length; i++) {
                    fontsName.add(fileList[i]);               
                } 
```

这个想法是更新适配器中的基础数据（这可以在不同的线程上完成），然后通知适配器来自 UI 线程的更改（`notifyDataSetChanged()`就像你所做的那样使用）。

# php - 是否可以使用 Openpyxl 并行创建多个 excel 文件，同时 optimize_write 设置为 True？

> ID：12003353
> 
> 赞同：1
> 
> 时间：2012-08-17T09:39:34.790
> 
> 标签：php, python, thrift, openpyxl

为了克服 PHPExcel 的内存限制，我们使用 Python 的 openpyxl 库来生成 Excel 文件，并使用 thrift 从 PHP 发送要保存在 Excel 文件中的数据。

现在我们已经在一个对象数组中创建了几个客户端，并尝试在 python 端一次生成多个 excel 文件。当我们将 optimize_write 设置为 False 时，我们可以这样做，但当优化写入标志设置为 True 时，我们不能这样做。

```
 $ob[$X][$Y] = new PhpPythonExcel();
    $ob[$X][$Y]->client->openExcel(True); //openExcel method sets optimized_write flag to True of False.
    ...
    //write something to the files.
    ...
    $ob[$X][$Y]->client->saveFile($fileName); 
```

是否有可能这样做，或者任何可用的黑客攻击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T06:10:55.503

是的，这是可能的，并且不需要破解。[通过对优化编写器](http://pythonhosted.org/openpyxl/optimized.html#optimized-writer)例程稍作修改，这可以很容易地测试：

```
from openpyxl import Workbook

library = []
sheets = []
for x in range(5):
    wb = Workbook(optimized_write = True)
    library.append(wb)
    sheets.append(wb.create_sheet())

for irow in xrange(100):
    for idx, ws in enumerate(sheets):
        # + idx so they are all different
        ws.append(['%d' % (i + idx) for i in xrange(200)])

for idx, wb in enumerate(library):
    wb.save('new_big_file_{}.xlsx'.format(idx)) # don't forget to save ! 
```

# css - IE 7 上未显示 CSS 样式

> ID：12003358
> 
> 赞同：-10
> 
> 时间：2012-08-17T09:39:59.197
> 
> 标签：css, xhtml

我最近将 PSD 转换为网站。该网站在 Firefox 和 Chrome 中运行良好。但是当我在IE7中测试它时，它不起作用。没有一种样式应用于网站。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:12:35.203

查看代码源，是否包含正确的css文件。

并检查您是否添加了文档类型。

给我链接，将检查它并让您知道问题和解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:28:38.943

某些样式在 IE 中无法正常工作，添加以下代码并尝试（应在标签前添加）

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd"> 
```

# javascript - 如何将我的自定义 Timepicker 链接到我的 asp.net？

> ID：12003360
> 
> 赞同：0
> 
> 时间：2012-08-17T09:40:06.210
> 
> 标签：javascript, asp.net, html

我已经制作了一个自定义时间选择器，但我已经在 html 页面中制作了它

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>

    <script type="text/javascript">
//here goes my script
 </script>
    <title></title>
</head>
<body>
//here are my form and div's
</body>
</html> 
```

现在我想在我的 asp.net 页面中使用它，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:43:02.067

使用 asp.net 用户控件而不是 html 页面。 [http://msdn.microsoft.com/en-us/library/fb3w5b53.aspx](http://msdn.microsoft.com/en-us/library/fb3w5b53.aspx)

您可以通过这种方式将其包含在您的页面中： [http ://weblogs.asp.net/scottgu/archive/2006/11/26/tip-trick-how-to-register-user-controls-and-custom-controls-in -web-config.aspx](http://weblogs.asp.net/scottgu/archive/2006/11/26/tip-trick-how-to-register-user-controls-and-custom-controls-in-web-config.aspx)

# performance - 分析ORACLE EXPLAIN PLAN

> ID：12003363
> 
> 赞同：1
> 
> 时间：2012-08-17T09:40:21.240
> 
> 标签：performance, oracle, query-optimization, explain, sql-execution-plan

浏览器在生成 jasper 报告 [PDF 格式] 时被挂起，该报告运行一个查询，其解释计划如下。

请帮助分析查询，此查询是否花费了太多时间？在生成此报告时，我们还注意到线程卡住了。

![报表查询的说明计划](../Images/f042186730592b1f1176a253bc03378d.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T13:06:48.957

是 EXPLAIN PLAN 是优化器对查询将如何运行的*明智猜测*，包括需要多长时间。优化器将这种猜测建立在许多事情上，包括关于数据量和系统特性的统计数据。

这些猜测通常都不错，尤其是在 Oracle 的更高版本中。但它们仍然可能会被淘汰，尤其是在您的统计数据过时、数据分布有偏差或由于环境系统条件而导致的情况下。

在您的特定情况下，优化器猜测您的查询返回一行：这听起来对吗？如果不是，您的统计数据不准确，需要刷新。

至于时间，优化器猜测您的查询将需要 45 秒才能运行。是不是太长了？只有你能说？

请记住，数据库调优是一门复杂的科学。它需要很多详细的信息。人们通过调整运行缓慢的查询来打造整个职业生涯。Web 应用程序中的调优更加复杂，因为架构或糟糕的编码可能会引入瓶颈。很难获得整个系统性能的概况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-26T13:36:03.047

同意 APC。我也对预期的时间（45 秒）感到惊讶。另外，解释计划是 CBO 的“预期计划”。有时，“实际”与“预期”在实际执行后会有所不同。

因此，最好也检查实际计划。以下可用于获取实际计划：

1) 使用 dbms_xplan

```
explain plan for <SELECT ...>
select * from table(dbms_xplan.display);            --estimated plan
select * from table(dbms_xplan.display_cursor);     --actual plan 
```

2) 触发“10046 跟踪”和 TKPROF

```
alter session set tracefile_identifier = 'something-unique'
alter session set sql_trace = true;
alter session set events '10046 trace name context forever, level 8'; 
```

# qt - 在边缘自动隐藏窗口？

> ID：12003364
> 
> 赞同：1
> 
> 时间：2012-08-17T09:40:21.967
> 
> 标签：qt, qt4.8

有没有关于如何实现自动隐藏窗口的指南，当它被放置在屏幕边缘时，它会折叠成一小块小部件

当鼠标悬停在那个小部件上时，它会延伸到原始小部件（这可以通过 Qt 动画框架完成，这里不是问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:01:51.193

您可以检查您的光标和/或小部件位置是否在 N 像素边框中，然后使用信号槽设置。自定义信号可能是计时器经过的事件。

[Qt - 确定绝对小部件和光标位置](https://stackoverflow.com/questions/4450595/qt-determine-absolute-widget-and-cursor-position)

[http://doc.qt.io/qt-4.8/application-windows.html#window-geometry](http://doc.qt.io/qt-4.8/application-windows.html#window-geometry)

请注意，多屏幕设置可能无法按预期运行，这取决于它们是将您的真实屏幕融合到一个屏幕上，还是将它们视为单独的屏幕。

# c# - 如何在 MVC3 的视图文件中使用多 FOR 循环？

> ID：12003365
> 
> 赞同：1
> 
> 时间：2012-08-17T09:40:33.773
> 
> 标签：c#, asp.net-mvc-3, razor

尝试使用多个 FOR 循环（for in for）时遇到问题。错误信息是：

> **解析器错误消息：** for 块缺少结束“}”字符。确保此块中的所有“{”字符都有一个匹配的“}”字符，并且没有一个“}”字符被解释为标记。

这是我的代码，问题来自第一个 for :( 。

```
<table width="100%" border="1">
@for (int q = 0; q < quanList.Count; q++) {     
    <tr>
        <td>@quanList[q]</td>

        @for (int s = 0; s < sizeList.Count; s++) {         
            <td><input type="text" name="txtval" style="width:80px" /></td>
        }
    </tr>
}   
</table> 
```

非常感谢您的任何建议和想法。

我想显示一个具有动态行和列的表，从控制器创建了两个列表并通过 ViewBag 解析以查看：

```
@{
List<string> sizeList = (List<string>)ViewBag.SizeList;
List<string> quanList = (List<string>)ViewBag.QuanList; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:05:44.537

```
<table width="100%" border="1">
@{List<int> quanList = new List<int>();
  List<int> sizeList = new List<int>();
}
for (int q = 0; q < quanList.Count(); q++) {
<tr>
    <td>@quanList[q]
    </td>
    for (int s = 0; s < sizeList.Count(); s++){
    <td>
        <input type="text" name="txtval_@q_@s" style="width: 80px" />
    </td>
    }
</tr>
} }
</table> 
```

试试这个 ：

尝试将其重命名`@q` `@s`为其他名称。如果你把它们混在一起，MVC 就会把它们当作一个普通`@`的例子`example@example.com`。

```
{int textFieldName = "txtval_" + q +
        "_" + s;
        <td>
            <input type="text" name="@textFieldName" style="width: 80px" />
        </td>
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:11:22.677

尝试将输入名称更改为以下内容：

```
<input type="text" name="txtval_@(q)_@(s)" style="width:80px" /> 
```

那些额外的括号应该可以解决它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T10:14:38.257

您需要`@`使用 double 转义符号`@`：

```
<td><input type="text" name="txtval_@@q_@@s" style="width:80px" /></td> 
```

或者，如果您需要 q 和 s 值，则可以包含括号：

```
<td><input type="text" name="txtval_@(q)_@(s)" style="width:80px" /></td> 
```

# javascript - jquery ajaxComplete() 没有 dom 对象

> ID：12003368
> 
> 赞同：0
> 
> 时间：2012-08-17T09:40:37.323
> 
> 标签：javascript, jquery

我正在使用 ajax（通过 jquery）与数据库交换数据。由于 .ajaxcomplete 函数始终基于带有选择器的 jquery 对象，有没有其他方法可以检查此显式 ajax 请求是否成功？.ajax 不属于任何特定的 dom 对象，例如 div 等。我想在纯 Javascript 文件中使用 Ajax。在这一刻没有与特定的 html 页面相关联。$(document).ajaxComplete() 有效，但不是我想要的

```
this.replot=function(){ 
    $(this).ajaxComplete(function() {alert('hallo');});   //here is my prob
    var that=this;
    var anfrage='anfrage= SELECT '+ this.xvaluecol+', '+this.y1valuecol+ ' FROM '+ this.tablename+ ' WHERE '+this.xvaluecol+' <=\'2010-11-06 15:00:00\' AND '+this.xvaluecol+' >=\'2010-11-06 07:00:00\'';
    $.ajax({
        url : 'getdata.php',
        dataType : 'json',
        data: anfrage,
        type : 'post',
        success : function(json) {
            if(String(json[0][0]).search('error')==-1)
            {
                that.data1=json;
                that.xaxismin=json[0][0];
                that.xaxismax=json[json.length-1][0];
                that.yaxsismin=parseInt(that.find_min(json));
                that.yaxismax=parseInt(that.find_max(json));
                console.log(json);
                console.log("yaxismin="+that.yaxismin);
                console.log("yaxismax="+that.yaxismax);
                //c=new Date((that.xaxismin));
                //c.setMinutes(c.getMinutes()+1441+60);
                //(c.toLocaleString());
                that.update();
                $.jqplot(that.divid,[that.data1,that.data2],that.options).replot();
            }
            else
            {
                alert('Plot nicht moeglich Fehlercode: '+json[0][1]);
            }
        }
    })
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:56:04.607

我倾向于使用`ajaxStop`over `ajaxComplete`。虽然不确定所有差异，但我认为它是相似的。

您绑定`ajaxComplete`到的元素并不重要。以下两段代码的作用完全相同：

```
$("#some_element").ajaxComplete(function () {
    alert($(this).html());
}); 
```

相对

```
$(document).ajaxComplete(function () {
    alert($("#some_element").html());
}); 
```

所以我认为你的问题可以通过使用来解决`$(document)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:52:29.893

定义 ajax 调用时，您可以指定“完成”回调。在所有 ajax 调用和成功/错误回调之后调用此回调。

```
$.ajax({
    complete: function(){ alert('hello'); }
}); 
```

从 jQuery 1.5 开始，$.ajax 还返回一个 promise 对象。如果您使用的是更高版本的 jQuery，您也可以这样做：

```
var jqXhr = $.ajax({ ... your code }).always(function(){ alert('hello'); });
//Or
jqXhr.always(function(){ alert('hello'); }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:17:12.813

You can set global event handlers for ajax requests in jQuery. You can add a dynamic property (say 'id') and identify a particular request.

```
$.ajaxSetup({
    success: function(data, textStatus, jqXHR) {
        console.log(jqXHR.id + " success");
    },
    error: function(jqXHR, textStatus, errorThrown) {
        console.log(jqXHR.id + " failed");
    },
    complete: function(jqXHR, textStatus, errorThrown) {
        console.log(jqXHR.id + " completed");
    }
});

$.ajax({
    url: "/"
}).id = "request1";

$.ajax({
    url: "/"
}).id = "request2";

$.ajax({
    url: "sdddqwdqwdqwd.com"
}).id = "request3"; 
```

demo : [http://jsfiddle.net/diode/3fX8b/](http://jsfiddle.net/diode/3fX8b/)

# php - cakephp 保存到具有 actas => requester 另一个模型的表中

> ID：12003371
> 
> 赞同：0
> 
> 时间：2012-08-17T09:40:42.090
> 
> 标签：php, cakephp, acl, actas

我有一个有许多客户、组、用户、产品、部门等的 crm。每个遗嘱的形式都不同（取决于客户的规格）。所以为每个表单烘焙不同的视图是不可能的，所以我创建了一组控制器模型和视图，通过它们我可以动态地创建表单（如 joomla 中的 rs 表单）。这些控制器将动态获取表单，当提交表单时，它将导入必须保存数据的模型，然后将其插入到表单控制器中，编辑也具有相同的逻辑。我能够创建并插入数据进入不同的表。问题是当我尝试插入用户和组等表时出现错误。原因是两个表中都有一个 actas=>requestor。

如果我尝试从各自的控制器插入用户或组，一切正常。但是当我将用户或组（具有 actas>requestor 的模型）导入表单然后尝试插入时，它不起作用。

如果我尝试删除 actas=>requestor，则表单会正确插入用户和组，但不会填充 aro。

关于如何解决这个问题的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T10:32:44.730

我终于明白了……嗯

```
app::import 
```

不是做我所拥有的事情的最佳方法，而不是使用 app:import 我尝试使用这个

```
eClassRegistry::init("modelname"); 
```

api.cakephp.org/class/class-registry#method-ClassRegistryinit

它现在可以正常工作，并且 aros 正在正常构建

# android - 使用蓝牙打印机从安卓应用打印数据

> ID：12003376
> 
> 赞同：2
> 
> 时间：2012-08-17T09:40:55.170
> 
> 标签：android, printing, bluetooth

我正在为餐厅开发一个 android 应用程序。我想从我的应用程序订购后打印账单。我正在使用蓝牙打印机进行打印任务。任何有使用蓝牙打印机打印数据的经验的人，请提供一些合适的例子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T09:53:51.407

是的，我有相同应用的经验。您需要将`StreamConnection`class 与`InputStream`and`OutputStream`类一起使用。

首先，您需要使用蓝牙地址与蓝牙打印机建立连接，然后您需要使用`OutputStream`类发送字符进行打印。

在打印机端，当它将获取字符时，它将直接开始打印。

```
private StreamConnection bConn = null; 
private DataOutputStream dos = null; 

 try
 {
    bConn = (StreamConnection) Connector.open(PrinterURL);
    dos = (DataOutputStream)bConn.openDataOutputStream();
    dos.writeUTF("\r\n");
    dos.writeUTF("===============================");dos.writeUTF("\r\n");
    dos.writeUTF("          GSECL Bill"); dos.writeUTF("\r\n");
    dos.writeUTF("===============================");dos.writeUTF("\r\n");
  }
  catch ( Exception e ) { System.out.println "Server Error: " + e.toString() );

finally
{
    try
        { 
        dos.close();
    bConn.close();
    }
    catch ( Exception e ) { }
    } 
```

# jquery - 仅将事件添加到正文一次

> ID：12003379
> 
> 赞同：0
> 
> 时间：2012-08-17T09:41:11.457
> 
> 标签：jquery

我正在尝试更改后续行以仅添加一次处理程序

```
$('body').on('click.collapse.data-api', '[data-toggle=collapse]', function ( e ) {
}) 
```

我的想法是在第一次添加绑定后为元素添加一个属性，并在添加绑定之前检查元素是否具有该属性。

设置属性很简单：

```
$('body').find('[data-toggle=collapse]').attr('data-loaded',"true"); 
```

但是更改选择器以检查是否未设置属性是困难的部分。

我试过类似的东西：

```
$('body').on('click.collapse.data-api', '[data-toggle=collapse] :not([data-loaded])',function ( e ) {
}) 
```

但它不起作用......

任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:51:08.880

我只是胡乱猜测？

```
$('body').on('click', '.collapse.data-api[data-toggle="collapse"]', function(e) {
    if (!$(e.target).data('loaded')) $(e.target).attr('data-loaded', true);
});​ 
```

[**小提琴**](http://jsfiddle.net/ukBnP/)

# android - Android：从处理程序访问活动

> ID：12003381
> 
> 赞同：0
> 
> 时间：2012-08-17T09:41:24.110
> 
> 标签：android

我有以下处理程序：

```
public class SiteListener implements OnItemClickListener{
    @Override
    public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {
    }
} 
```

我希望能够调用以下内容：

```
myActivity.getSupportFragmentManager()
            .beginTransaction()
            .add(R.id.site_info, siteInfoFragment)
            .commit(); 
```

如何从 SiteListener 访问活动？有没有办法使用`adapterView`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T09:52:17.920

将对活动的引用传递给`SiteListener`创建它时。

**编辑添加代码示例：**

```
public class SiteListener implements OnItemClickListener{
    private MyActivity myActivity;

    public SiteListener(MyActivity myActivity) {
        this.myActivity = myActivity;
    }

    @Override
    public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {
        myActivity.getSupportFragmentManager()
            .beginTransaction()
            .add(R.id.site_info, siteInfoFragment)
            .commit();

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:46:24.100

您可以`FragmentActivity`使用`view`来获取`FragmentActivity`.

```
FragmentActivity activity = ((FragmentActivity)view.getContext());
activity.getSupportFragmentManager()
            .beginTransaction()
            .add(R.id.site_info, siteInfoFragment)
            .commit(); 
```

# javascript - javascript将变量传递给函数内部的函数

> ID：12003382
> 
> 赞同：0
> 
> 时间：2012-08-17T09:41:24.983
> 
> 标签：javascript, jquery

我在获取显示以下内容的“名称”值时遇到问题：

```
 for (var name in array) {
        var hoverIn = function() {
                  alert(name);
        };

        var hoverOut = function() {
        };

        thing.hover(hoverIn, hoverOut);

   } 
```

我得到的是一个带有最后一个 name 值的警报窗口。显然我做错了什么，我怀疑这是一个简单的修复。任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T09:43:53.870

这是闭包问题，`name`在迭代是最后一个`name`之后`array`，并且在迭代发生时不会立即执行悬停回调，因此当实际执行悬停函数时，`name`将始终是最后一个`array`。

您需要使用 IEFE（立即执行的函数表达式）：

```
 for (var name in array) {
        // pass in name to the anonymous function, and immediately
        // executes it to retain name when the particular iteration happens
        var hoverIn = (function(name) {
             return function() {
                  alert(name);
             }
        })(name); // if you notice, the pattern is (function(name) {})(name) 
                  // the first () creates an anonymous function, the (name) 
                  // executes it, effectively passing name to the anon fn

        var hoverOut = (function(name) {
            // same pattern if you need to re-use name inside here, otherwise just
            // function() { } should suffice
        })(name);

        thing.hover(hoverIn, hoverOut);

   } 
```

为了避免重复`(function() { })()`（老实说看着很累），您还可以，正如@pimvdb 指出的那样，将整个主体包裹在一个闭包中：

```
 for (var name in array) {
        (function(name) {
           var hoverIn = function() {
               alert(name);
           }

           var hoverOut = function() {
           }

           thing.hover(hoverIn, hoverOut);
        })(name); // closure of for loop body

   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:43:34.563

在循环中添加一个变量

```
var thisName = name; 
```

然后在你的函数中使用它

```
alert(thisName); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:03:29.473

你有两种方法来处理这个问题。

首先要知道的是作用域只发生在函数级别，而不是在 javascript 的循环中。如果您从外部源在函数中设置变量并且不立即执行它，则该变量将在循环过程中更改。

您可以通过关闭其他变量来解决此问题：

```
var names = ["john","paul","george","ringo"];
var store = {};

//this function receives the data as a parameter
//so it will be a safe copy.

function createFunc(name){
     //just return a function that will alert the name.
    return function(){
       alert(name);
    }
}
for (var i in names) {

        var hoverIn = createFunc(names[i]);

        store[names[i]]=hoverIn;

}
store["john"](); 
```

另一种方法是创建一个在循环中立即执行的匿名函数：

```
var names = ["john","paul","george","ringo"];
var store = {};

for (var i in names) {
   //the function receives the i as a parameter
   //and executes, so n is a safe copy of i
  (function(n){

    var hoverIn = function(){
        alert(names[n]);
    }

    store[names[n]]=hoverIn;

  })(i);

}
store["john"](); 
```

一切都是与关闭有关的问题。查看维基百科了解更多信息。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-17T09:43:22.953

您应该创建闭包：

```
 for (var name in array) {
        var hoverIn = (function() {
              return function() {
                  alert(name);
              };
        }());

        var hoverOut = function() {
        };

        thing.hover(hoverIn, hoverOut);
   } 
```

# iphone - 匹配某些预定义的模式是否存在于从相机捕获的图像中，如果然后找到它们的坐标

> ID：12003383
> 
> 赞同：0
> 
> 时间：2012-08-17T09:41:29.143
> 
> 标签：iphone, objective-c, image-processing, uiimage, pattern-matching

> **可能重复：**
> [使用opencv或其他技术识别出现在图像ios四个角上的黑色图案](https://stackoverflow.com/questions/11913911/recognize-black-patterns-appearing-on-the-four-corners-of-the-image-ios-using-op)

我想创建一个像 shotnote 应用程序这样的应用程序（基本上是它的相机功能）。它是一个页面扫描应用程序，用于扫描特殊类型的纸张。

[http://itunes.apple.com/us/app/shot-note/id411332997?mt=8](http://itunes.apple.com/us/app/shot-note/id411332997?mt=8)

参考前两张截图

您可以在以下视频中查看我正在搜索的功能：-

[http://www.youtube.com/watch?v=8F_1iu4pDkQ](http://www.youtube.com/watch?v=8F_1iu4pDkQ)

在我的应用程序中

纸张背景为白色，图案为黑色。

我想要的是当我从相机拍摄图像时，它应该与图案（图像或图像）匹配，如果拍摄的图像中存在图案，那么图像应该像这样被裁剪，以便图案出现在角落的图像。

基本上我需要检测图案是否存在，然后我需要它们的坐标，以便我可以相应地裁剪图像。

您可以假设为矩形或 L 形的图案。

从过去的两周开始，我一直在为此冲浪，但仍在为此苦苦挣扎。

请提供一些示例代码或一些我应该遵循的建议。

任何建议将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T13:48:17.400

如果您知道模式总是不失真的（即原始图像中没有或很少透视）模板匹配，例如使用标准化互相关就可以了。

# regex - 正则表达式的更正

> ID：12003384
> 
> 赞同：0
> 
> 时间：2012-08-17T09:41:30.453
> 
> 标签：regex, string

我有一个字符串，其中包含单词的组合以及在某些地方`\r\n`和`\n`某些地方。这是一个示例：

```
\r\nThis is an\nexample\nand I need\na\nsolution\r\nr\nOK\r\n 
```

现在我只需要在其中匹配`This is an\nexample\nand I need\na\nsolution`这`\n`是
我尝试过的表达式

```
\r\n([\s\w]+)\r\n 
```

这将读取完整的字符串。请更正

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:10:51.880

您不希望`\r`匹配的句子中有 s 吗？您可以使用否定匹配：

```
\r\n([^\r]+)\r\n 
```

我相信 using`\s`将同时匹配`\r`和`\n`作为间距字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:55:39.553

尝试使用非贪婪量词`?`：

```
\r\n([\s\w]+?)\r\n 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:56:45.180

多行惰性匹配应该起作用：

```
/\r\n(.+?)\r\n/m 
```

# javascript - 简单的 Javascript 文本编辑器或一组函数

> ID：12003386
> 
> 赞同：1
> 
> 时间：2012-08-17T09:41:38.703
> 
> 标签：javascript, jquery, text-editor

我需要一个简单的 javascript（可能带有 jQ​​uery）文本/html 编辑器。我做了很多搜索并找到了大量的插件，但是对于我正在寻找的东西来说，它们中的大多数都太“完整”了。

实际上，我想要的只是一组功能，而不是复杂的 UI 或花哨的工具栏。这些功能基本上是，

*   将字体系列更改为有限的预定义集之一（应该有可能在容器上同时具有多个字体）
*   更改字体大小
*   更改字体颜色
*   更改格式样式（粗体、斜体、下划线等）

你会推荐什么？我应该编写自己的插件吗？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T09:55:14.297

[Aloha](http://www.aloha-editor.org/)是所见即所得在线编辑器中最好的。他们也有很好的[维基](http://www.aloha-editor.org/guides/develop_aloha.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T10:18:07.997

所有网络编辑器的工作都非常简单，并且依赖于浏览器功能。

`contenteditable="true"` 您可以通过在元素上设置属性并调用：`$('#edit').designMode = "on";`在页面加载后使HTML 页面的任何字段可编辑

您可以更改选择的字体

```
document.execCommand("fontname", false, "Courier New"); 
```

大小与

```
document.execCommand("fontsize", false, "20"); 
```

颜色与

```
document.execCommand("ForeColor", false, "green"); 
```

粗体、斜体：

```
document.execCommand("bold", false);
document.execCommand("italic", false); 
```

这是我创建的示例测试页面（遗憾的是，它仅适用于 FF，因为在其他浏览器中，当您单击按钮时，他会失去对文本的选择）

```
 <!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset=utf-8>
        <title>HTML5 Demo: ContentEditable</title>
        <script src="jquery.js"></script>
    </head>
    <body onLoad="onload()">
        <h2>Go ahead, edit away!</h2>
        <div id="editarea"></div>
        <!-- 'contenteditable="true"' need so the user can select the element and edit it's text-->
        <section contenteditable="true">
            <p>
                Here's a typical paragraph element
            </p>
            <div contenteditable="true">
                <p>
                    hallo welt
                </p>
            </div>
            <ol>
                <li>
                    and now a list
                </li>
            </ol>
        </section>
    </body>
    <script>
        function onload() {
            // needed for the resize boxes in IE
            document.designMode = "on"
            $('#editarea').append($('<button>').html("fontname").click(function() {
                document.execCommand("fontname", false, "Courier New");
            }));
            $('#editarea').append($('<button>').html("fontsize").click(function() {
                document.execCommand("fontsize", false, "20");
            }));
            $('#editarea').append($('<button>').html("changeSize").click(function() {
                document.execCommand("ForeColor", false, "green");
            }));
            $('#editarea').append($('<button>').html("bold").click(function() {
                document.execCommand("bold", false);
            }));
            $('#editarea').append($('<button>').html("italic").click(function() {
                document.execCommand("italic", false);
            }));
        }
    </script>
</html> 
```

PS 如果你需要更多，你应该看看[Aloha](http://aloha-editor.org/)编辑器

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T09:48:15.747

[TinyMCE](http://www.tinymce.com/)是一个很棒的！您可以准确地指定要向用户提供的内容，并且非常容易实现。

它非常“完整”，但是如果您指定要提供的内容（如果您愿意，可以将主题更改为更简洁的主题），您可以获得一个非常简约的 gui。

这是一个很好的解决方案，胜过编写自己的恕我直言。

[这是一个示例](http://www.tinymce.com/tryit/listbox_splitbutton.php)，它展示了一个比完整版简单得多的 gui，只是为了展示他们系统的灵活性。您可以将其雕刻成您的确切规格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T09:44:18.563

extjs 有一个非常好的曾经，但框架相当臃肿。

否则，请检查 jquery 插件，我确定有堆。extjs 仍然是我的最爱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-01T05:41:08.507

您可以编写自己的或使用插件。这是我的基本想法。

HTML：

```
<div id="editor" contenteditable="true">Lorem Ipsum is simply dummy text</div>
<button id="make-bold">Make bold</button> 
```

JS：

```
document.getElementById('make-bold').addEventListener('click', function(event){
    event.preventDefault();

    var selection = window.getSelection();
    var range = selection.getRangeAt(0).cloneRange();
    var tag = document.createElement('strong');

    range.surroundContents(tag);
    selection.addRange(range);
}); 
```

现场演示 - [https://jsfiddle.net/im4aLL/Lyusxq3p/](https://jsfiddle.net/im4aLL/Lyusxq3p/)

我由此提出了基本想法，并最终制作了一些我在未来项目中使用的东西。

我从上面的概念制作了 EasyEditor - [https://github.com/im4aLL/easyeditor 。](https://github.com/im4aLL/easyeditor)还有很多事情要做。就像何时包装一个节点一样，您需要检查该选择是否已与其他节点或同一节点包装在一起。还有很多功能需要你去克服。

或者你可以试试我为像你这样需要完全灵活的解决方案以将其与另一个应用程序集成的人制作的轻量级插件。

### 这是使用 EasyEditor 的演示和文档

*   演示：[http ://habibhadi.com/lab/easyeditor/](http://habibhadi.com/lab/easyeditor/)
*   示例：[http ://habibhadi.com/lab/easyeditor/examples.html](http://habibhadi.com/lab/easyeditor/examples.html)
*   文档：[http ://habibhadi.com/lab/easyeditor/documentation.html](http://habibhadi.com/lab/easyeditor/documentation.html)

### 用法

[http://habibhadi.com/lab/easyeditor/default-example.html](http://habibhadi.com/lab/easyeditor/default-example.html)

# gdb - 如何使用 lldb 查找函数的内存地址？

> ID：12003392
> 
> 赞同：10
> 
> 时间：2012-08-17T09:42:07.143
> 
> 标签：gdb, lldb

在GDB中，我可以使用“info line func_name”得到func_name的内存地址，然后使用“set $PC=memory_address”开始调试这个函数。我如何在 lldb 中做同样的事情？提前致谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-23T10:46:35.333

lldb 中的命令是“图像查找”。我认为最近将“信息功能”<->“图像查找”的示例添加到 lldb/gdb 命令页面 - [http://lldb.llvm.org/lldb-gdb.html](http://lldb.llvm.org/lldb-gdb.html)

例如

```
(lldb) im loo -n puts
1 match found in /usr/lib/system/libsystem_c.dylib:
        Address: libsystem_c.dylib[0x0000000000011d9a] (libsystem_c.dylib.__TEXT.__text + 69850)
        Summary: libsystem_c.dylib`puts
(lldb) 
```

虽然这仅向您显示 libsystem_c.dylib 中的偏移量 (0x11d9a) - 要查看实际加载地址，您需要使用“-v”选项进行图像查找，该选项将显示放​​置覆盖的地址范围。或者您可以更直接地使用 lldb 中的反勾号符号来执行此操作，

```
(lldb) reg read pc
     rip = 0x0000000100000f2b  a.out`main + 11 at a.c:3
(lldb) reg write pc `(void(*)())puts`
(lldb) reg read pc
     rip = 0x00007fff99ce1d9a  libsystem_c.dylib`puts 
```

好的，我不得不转换 puts() 因为 lldb 在这里需要一个函数原型 - 不是超级方便，但如果它是你自己不需要的函数之一：

```
(lldb) reg write pc `main`
(lldb) reg read pc
     rip = 0x0000000100000f20  a.out`main at a.c:2 
```

# iphone - 增加 Lines UITextView 之间的空间

> ID：12003393
> 
> 赞同：2
> 
> 时间：2012-08-17T09:42:13.760
> 
> 标签：iphone, objective-c, ios

我们如何增加 UITextView 中两行之间的空间。我搜索了相关主题，他们正在其中创建自己的字体。我也试过了。它不工作。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    org_txtvw_rect = CGRectMake(self.text_view.frame.origin.x, 
                                self.text_view.frame.origin.y, 
                                self.text_view.frame.size.width, 
                                self.text_view.frame.size.height);

    [text_view.text sizeWithFont:[UIFont systemFontOfSize:14]
                   constrainedToSize:CGSizeMake(100, MAX_HEIGHT)
                       lineBreakMode:UILineBreakModeWordWrap];
} 
```

我做错什么了吗？

我们可以将此属性用于行距吗？

```
text_view.font.lineHeight 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:57:56.007

您不能直接更改行距`UITextView`。尝试使用 Core Text 来绘制文本。使用Core Text意味着你需要做很多工作，看看[https://github.com/mattt/TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:57:32.460

systemFontSize 默认为 Helvetica。目前没有可用于行间距的 api。但是您可以为您的应用程序选择不同的字体，例如 Didot、Garamond。如果您想使用 iOS 中没有的任何其他字体，则可以将该字体的 ttf 文件添加到资源包中。

# php - 使用 php preg 查找 url 并将其替换为第二个 url

> ID：12003395
> 
> 赞同：0
> 
> 时间：2012-08-17T09:42:18.237
> 
> 标签：php

我有大量的网页存储在 MySQL 数据库中。

这些页面中的大多数至少包含一个（有时是两个）这样的条目......

```
<a href="http://first-url-which-always-ends-with-a-slash/">
  <img src="http://second-different-url-which-always-ends-with.jpg" />
</a> 
```

我想设置一个小 php 循环来遍历所有条目，用该条目的第二个 url 的副本替换第一个 url。

我如何使用 preg 来：

1.  从图像标签中找到第二个 url
2.  将 a 标签中的第一个 url 替换为第二个 url 的副本

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:51:07.540

看到这个网址

[PHP预匹配/替换？](https://stackoverflow.com/questions/5195337/php-preg-match-replace)

另见：- [http://php.net/manual/en/function.preg-replace.php](http://php.net/manual/en/function.preg-replace.php)

```
$qp = qp($html);
foreach ($qp->find("img") as $img) {
    $img->attr("title", $img->attr("alt"));
}
print $qp->writeHTML(); 
```

尽管在这种简单的情况下诉诸正则表达式可能是可行的：

```
preg_replace('#(<img\s[^>]*)(\balt=)("[^"]+")#', '$1$2$3 title=$3', $h); 
```

（使用 preg_replace_callback 来确保不存在 title= 属性会更有意义。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:41:14.213

您可以执行以下操作：

```
$dom = new DOMDocument('1.0', 'UTF-8');
$dom->formatOutput = true;
$source = "<a href=\"http://first-url-which-always-ends-with-a-slash/\">
  <img src=\"http://second-different-url-which-always-ends-with.jpg\" />
</a>";
$dom->loadHTML($source);
$tags = $dom->getElementsByTagName('a');

foreach ($tags as $tag) {
  $atag = $tag->getAttribute('href');  
  $imgTag = $dom->getElementsByTagName('img');
  foreach ($imgTag as $img) {        
    $img->setAttribute('src', $atag);
    echo $img->getAttribute('src');
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T11:15:22.137

感谢您的建议，我可以看到它们比使用 Preg 更好。

即便如此，我终于像这样解决了我自己的问题......

```
$result = mysql_query($select);
while ($frow = mysql_fetch_array($result)) {
    $page_content = $frow['page_content'];

    preg_match("#<img\s+src\s*=\s*([\"']+http://[^\"']*\.jpg[\"']+)#i", $page_content, $matches1);
    print_r($matches1);
    $imageURL = $matches1[1] ; 

    preg_match("#<a\s+(?:[^\"'>]+|\"[^\"]*\"|'[^']*')*href\s*=\s(\"http://[^\"]+/\"|'http://[^']+/')#i", $page_content, $matches2);
    print_r( $matches2 );  
    $linkURL = $matches2[1] ;

    $finalpage=str_replace($linkURL, $imageURL, $page_content) ;
} 
```

# r - MongoDB 中的查询

> ID：12003402
> 
> 赞同：7
> 
> 时间：2012-08-17T09:42:31.443
> 
> 标签：r, mongodb, rmongodb

我正在尝试使用`rmongodb`从 MongoDB 数据库中获取信息以在 R 中进行进一步处理。但是，我很难真正开始。这个有效：

```
cursor <- mongo.find(mongo, "people", query=list(last.name="Smith", first.name="John"),
                 fields=list(address=1L, age=1L))
while (mongo.cursor.next(cursor)){
  print(mongo.cursor.value(cursor))} 
```

现在，如果我想找到名字是“John”、“Bob”或“Catherine”的人怎么办？我试过`query=list(last.name="Smith", first.name=c(John, Bob, Catherine))`了，但这没有成功。替换也不起作用`=`。`%`

另一个问题是数据库内容是嵌套的，这意味着我有子树、子子树等。例如，对于条目，`first.name="John", last.name="Smith"`我可能有子条目`address, age, occupation`，如每年我都会有一个条目，如“失业”、“文员”、“企业家”）。那么，如果我想找到所有 40 岁且在 2010 年失业的名字为“John”的人怎么办？查询会是什么样子？

编辑作为对 Stennie 的回复：这是我的数据库结构和我正在尝试执行的查询的示例。想象一所大学的校友被细分为小组（例如“非常优秀的学生”、“优秀的学生”等）。然后，每个组都包含已分配到该组的人员列表及其详细信息。

```
(0){..}
   _id  : (Object ID) class id
   groupname: (string) unique name for this group (e.g. "beststudents")
   members[11]
       (0){..}
           persid : (integer) 1
           firstname: (string)
           surname: (string)
           age: (integer)
           occupation: (string)
       (1){..}
           persid : (integer) 2
           firstname: (string)
           surname: (string)
           age: (integer)
           occupation: (string)
#      and so on until (10){..}
(1){..}
   _id  : (Object ID) class id
   groupname: (string) unique name for this group
   members[3]
       (0){..}
           persid : (integer) 1
           firstname: (string)
           surname: (string)
           age: (integer)
           occupation: (string)
#      and so on until (2){..}
# and many more 
```

现在让我们假设我对名为“最好的学生”和“好学生”的组感兴趣，并希望将每个组的每个成员的“姓氏”和“职业”作为 R 对象，以便做一些情节，统计数据或其他什么。也许我还想改进这个请求，只接收那些年龄小于 40 岁的成员。现在在阅读了 Stennie 的回复后，我这样尝试：

```
cursor <- mongo.find(mongo, "test.people",
          list(groupname=list('$in'=c("beststudents", "goodstudents")),
               members.age=list('$lt'=40) # I haven't tried this with my DB, so I hope this line is right
               ),
          fields=list(members.surname=1L, members.occupation=1L)
        )
count <- mongo.count(mongo, "test.people",
          list(groupname=list('$in'=c("beststudents", "goodstudents")),
               members.age=list('$lt'=40)
               )
        )
surnames <- vector("character", count)
occupations <- vector("character", count)
i <- 1
while (mongo.cursor.next(cursor)) {
  b <- mongo.cursor.value(cursor)
  surnames[i] <- mongo.bson.value(b, "members.surname")
  occupations[i] <- mongo.bson.value(b, "members.occupation")
  i <- i + 1
}
df <- as.data.frame(list(surnames=surnames, occupations=occupations)) 
```

运行后没有错误消息，但我得到一个空数据框。这段代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T13:32:27.397

> 现在，如果我想找到名字是“John”、“Bob”或“Catherine”的人怎么办？

您可以为此使用[`$in`运算符](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24in)：

```
cursor <- mongo.find(mongo, "test.people",
   list(last.name="Smith", 
        first.name=list('$in'=c('John','Bob','Catherine'))
   )
) 
```

值得阅读 MongoDB [Advanced Queries](http://www.mongodb.org/display/DOCS/Advanced+Queries)页面以及[Dot Notation (Reaching Into Objects)](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29)。

> 另一个问题是数据库内容是嵌套的，这意味着我有子树、子子树等。

数据结构听起来可能难以操作；将需要一个文档的实际示例来尝试说明查询。

> 那么，如果我想找到所有 40 岁且在 2010 年失业的名字为“John”的人怎么办？查询会是什么样子？

对数据结构做一些假设，下面是一个简单的“and”查询示例：

```
cursor <- mongo.find(mongo, "test.people",
    list(
        first.name='John',
        fy2012.job='unemployed',
        age = 40
    )
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T12:18:05.697

这不是一个真正的答案，因为我自己仍在努力解决某些方面的问题，但这可能有助于您入门： [Running advanced MongoDB queries in R with rmongodb](https://stackoverflow.com/questions/10798707/running-advanced-mongodb-queries-in-r-with-rmongodb)

此外，请检查 rmongodb 页面附带的示例应用程序。也就是说，可以在 github 包中访问： [https ://github.com/gerald-lindsly/rmongodb/blob/master/rmongodb/demo/teachers_aid.R](https://github.com/gerald-lindsly/rmongodb/blob/master/rmongodb/demo/teachers_aid.R)

# cursor - Android SQLite游标循环两次

> ID：12003404
> 
> 赞同：1
> 
> 时间：2012-08-17T09:42:39.180
> 
> 标签：cursor, android-sqlite

尽管我知道 cursor.getCount() 中只返回一个值，但我遇到了 android 游标循环两次的问题。

我在 DBAdapter 中使用以下内容：

```
public Cursor getAllSubDetailsFromObsTable() {
Cursor c = mDb
        .rawQuery(
                "SELECT DISTINCT sub.sub_id, sub.complete, mobileobs.date, mobileobs.location, mobileobs.grid_ref, "
                        + "mobileobs.time, mobileobs.protocol_id, mobileobs.endtime FROM sub, mobileobs "
                        + "WHERE sub.sub_id = mobileobs.sub_id",
                null);
return c;
} 
```

然后我在我的工人阶级中称之为：

```
db.open();
Cursor c = db.getAllSubDetailsFromObsTable();
while (c.moveToNext()) {
        String sub_id = c.getString(0);
        //Rest of real code <snipped>
        myArrayList.add(sub_id);
}
c.close();
db.close(); 
```

但是，当我查看 myArrayList 的内容时，它有两个相同的 sub_id 值。我尝试过使用 c.moveToFirst() 等等等等，但是即使 c.getCount() = 1，我仍然在 arrayList 中得到两个值！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T16:33:07.853

终于搞定了。它与类变量和方法变量有关。我有一个由 onCreate 中的方法填充的类变量，该方法也在 onResume 中调用。解决方案是将变量移动到方法中。愚蠢的错误，容易修复，很难（对我来说）找到。

# mysql - 在 Codeigniter 中添加 mysql 表之间的关系

> ID：12003409
> 
> 赞同：0
> 
> 时间：2012-08-17T09:43:00.927
> 
> 标签：mysql, codeigniter, foreign-keys, foreign-key-relationship

我正在使用 Codeigniter 并想在**帖子**和**评论**表之间添加关系。

**帖子：**

```
CREATE TABLE IF NOT EXISTS `posts` (
`post_id` int(5) unsigned NOT NULL AUTO_INCREMENT,
`title` varchar(100) COLLATE utf8_persian_ci NOT NULL,
`slug` varchar(100) COLLATE utf8_persian_ci NOT NULL,
`content` text COLLATE utf8_persian_ci NOT NULL,
`time` varchar(10) COLLATE utf8_persian_ci NOT NULL,
`num_of_comments` int(3) NOT NULL,
`cat` varchar(20) COLLATE utf8_persian_ci NOT NULL,
`tags` varchar(100) COLLATE utf8_persian_ci NOT NULL,
PRIMARY KEY (`post_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_persian_ci AUTO_INCREMENT=15 ; 
```

**注释：**

```
CREATE TABLE IF NOT EXISTS `comments` (
`id` int(3) NOT NULL AUTO_INCREMENT,
`content` text COLLATE utf8_persian_ci NOT NULL,
`date` varchar(100) COLLATE utf8_persian_ci NOT NULL,
`time` varchar(100) COLLATE utf8_persian_ci NOT NULL,
`name` varchar(20) COLLATE utf8_persian_ci NOT NULL,
`email` varchar(30) COLLATE utf8_persian_ci NOT NULL,
`image` varchar(20) COLLATE utf8_persian_ci NOT NULL,
`ip` varchar(16) COLLATE utf8_persian_ci NOT NULL,
`submit` int(1) NOT NULL,
`reply` text COLLATE utf8_persian_ci NOT NULL,
`reply_date` varchar(100) COLLATE utf8_persian_ci NOT NULL,
`reply_time` varchar(100) COLLATE utf8_persian_ci NOT NULL,
`post_id` int(5) unsigned NOT NULL,
PRIMARY KEY (`id`),
KEY `post_id` (`post_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_persian_ci AUTO_INCREMENT=26 ; 
```

但它会打印此错误：

```
SQL query:

ALTER TABLE  `comments` ADD FOREIGN KEY (  `post_id` ) REFERENCES  `codeig`.`posts` (

`post_id`
) ON DELETE CASCADE ON UPDATE CASCADE ;

MySQL said: 

#1452 - Cannot add or update a child row: a foreign key constraint fails (`codeig`.     <result 2 when explaining filename '#sql-fc8_dd'>, CONSTRAINT `#sql-fc8_dd_ibfk_1` FOREIGN  KEY (`post_id`) REFERENCES `posts` (`post_id`) ON DELETE CASCADE ON UPDATE CASCADE) 
```

我根本不知道在说什么。
请帮忙...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T09:52:52.313

你在哪里写的这个查询？或者这是由codeigniter生成的？在任何 sql 管理工具中试试这个：

```
ALTER TABLE comments ADD FOREIGN KEY (post_id) REFERENCES posts(post_id) ON DELETE CASCADE ON UPDATE CASCADE ; 
```

您不需要 codeig 部分，我假设那是数据库名称。

# python - 在 Google Contacts API v3 中为联系人指定自定义字段

> ID：12003422
> 
> 赞同：0
> 
> 时间：2012-08-17T09:44:04.397
> 
> 标签：python, google-contacts-api

如何在使用 API 创建/更新联系人（也检索它）时指定自定义字段？我正在使用 Python API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T05:32:33.067

```
import gdata.contacts.data

new_contact = gdata.contacts.data.ContactEntry()

# Set the contact's name.
new_contact.name = gdata.data.Name(
    given_name=gdata.data.GivenName(text='Elizabeth'),
    family_name=gdata.data.FamilyName(text='Bennet'),
    full_name=gdata.data.FullName(text='Elizabeth Bennet')
)

# Set user defined fields
new_contact.user_defined_field.append(
    gdata.contacts.data.UserDefinedField(
        key='Field Name',
        value='Field Value'
    )
) 
```

# javascript - 在 Ext 存储中加载 JSON，缺少关联

> ID：12003423
> 
> 赞同：0
> 
> 时间：2012-08-17T09:44:05.480
> 
> 标签：javascript, json, extjs, extjs4.1

我正在使用分机 4.1。我在加载带有关联的 json 数据时遇到了一些问题。平面数据完美加载，只有“hasMany”不起作用。（如果加载那里无处可寻）。如果加载了一条记录，我希望能够获得参加者的 2 个商店和文档的 1 个商店。

我还可以将 JSON 格式更改为更好的格式（如果您有建议，请告诉我！）

我有[这个 json 数据](https://gist.github.com/3377256)。

这是我的第一个模型：

```
Ext.define('App.model.package.LabVisit', {
    extend: 'Ext.data.Model',
    requires: [
        'App.model.package.Attendee',
        'App.model.package.Document'
    ],
    idProperty: 'labVisitID',

    fields: [
        {
            mapping: 'lab_visit_id',
            name: 'labVisitID',
            type: 'int'
        },
        {
            mapping: 'lab_id',
            name: 'labID',
            type: 'int'
        },
        ... some more irrelevant...
        {
            mapping: 'comments',
            name: 'comments'
        },
        {
            name: 'upddate'
        }
    ],
    hasMany: [
        /* edit: added foreignKey (also tried with: lab_visit_id) */
        { model: 'package.Attendee', name: 'attendeeLabList', associationKey:'attendee_lab', foreignKey: 'labVisitId' },
        { model: 'package.Attendee', name: 'attendeeEmpList', associationKey:'attendee_emp', foreignKey: 'labVisitId' }
        { model: 'package.Document', name: 'document', associationKey:'document' },
    ]

}); 
```

我有以下与会者模型：

```
Ext.define('App.model.package.Attendee', {
    extend: 'Ext.data.Model',

    fields: [
        /* edit: added this field */
        {
            mapping: 'lab_visit_id',
            name: 'labVisitId'
        },
        {
            mapping: 'attendee_id',
            name: 'AttendeeID'
        },
        {
            mapping: 'first_name',
            name: 'firstName'
        },
        {
            mapping: 'last_name',
            name: 'lastName'
        },
        {
            name: 'email'
        }
    ]
}); 
```

以下文档模型：

```
Ext.define('App.model.package.Document', {
    extend: 'Ext.data.Model',

    fields: [
        {
            mapping: 'document_id',
            name: 'docID'
        },
        {
            mapping: 'document_name',
            name: 'docName'
        },
        {
            mapping: 'document_mimetype',
            name: 'mimeType'
        },
        {
            name: 'uploadID'
        }
    ]
}); 
```

最后是我的商店：

```
Ext.define('App.store.package.LabVisit', {
    extend: 'Ext.data.JsonStore',
    requires: [
        'App.model.package.LabVisit'
    ],

    constructor: function(cfg) {
        var me = this;
        cfg = cfg || {};

        me.callParent([Ext.merge({
            storeId: 'labVisitStore',
            model: 'App.model.package.LabVisit',
            remoteSort: true,
            proxy: {
                type: 'ajax',
                api: {
                    read: API_URLS.getVisitList //url to the json
                },
                reader: {
                    type: 'json',
                    root: 'rows'
                }
            }
        }, cfg)]);
    }
}); 
```

***编辑：*** 我在模型中添加了外键并将其添加到`hasMany`

还是没有区别。这是我的输出：

![店里的第一张唱片](../Images/ff269b9445d5af51246a802e0985425c.png)

我也觉得很奇怪：如果它坏了，我期待一个例外。而且总是有两家神秘的商店，但我不知道为什么或目的是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T09:35:34.813

问题出在这部分：

```
hasMany: [
    { model: 'package.Attendee', name: 'attendeeLabList', associationKey:'attendee_lab' },
    { model: 'package.Attendee', name: 'attendeeEmpList', associationKey:'attendee_emp' },
    { model: 'package.Document', name: 'document', associationKey:'document' },
] 
```

@Izhaki 帮了我很多忙。谢谢！尤其是小提琴。我从那里开始，开始用我的代码一块一块地切换代码。直到我看到模型是问题所在。

模型应该这样定义： `App.model.package.Attendee`

我认为如果模型未被识别/不存在/未提供，框架不会显示显着错误/警告，这很遗憾......但是，嗯，它现在可以工作了。

# iphone - xcode中是否有像treeview这样的控件？如果可能的话，给我一个例子

> ID：12003424
> 
> 赞同：4
> 
> 时间：2012-08-17T09:44:14.930
> 
> 标签：iphone, ios, ipad, ios4, ios-simulator

有没有像treeview这样的控件，那么请给我它的演示代码以及如何设计树结构 - 例如父节点，根节点等。

```
Parent1
      Root 1
      Root 2
      Root 3
Parent2
      Root 1
      Root 2
      Root 3 
```

我想要所有节点附近的复选框，

这可以在 iPad 应用程序中轻松显示吗？

请帮我。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:51:01.003

您必须按照我的评论推出自己的解决方案。只是为了向您指出根据您的要求存在的相同开源控件，有[这个](https://github.com/serverdensity/ios-SDNestedTable). 您可能希望使用它并根据您的要求对其进行调整，而不是从头开始。

# django - Django 简单验证码：找不到表

> ID：12003427
> 
> 赞同：2
> 
> 时间：2012-08-17T09:44:46.833
> 
> 标签：django, django-forms, captcha

在我的本地开发机器上，我已经成功安装了 django-simple-captcha。但是，当我在生产服务器上运行它时，找不到该表，导致`TemplateSyntaxError`.

> 渲染时捕获DatabaseError：没有这样的表：captcha_captchastore

我使用 sqlite3 作为数据库引擎，并且已经`python manage.py syncdb`使用以下 SQL 语句运行并检查了创建的表：

> sqlite> 从 sqlite_master 中选择名称，其中 type = 'table';
> auth_permission
> auth_group_permissions
> auth_group
> auth_user_user_permissions
> auth_user_groups
> auth_user
> auth_message
> django_content_type
> django_session
> django_site
> django_admin_log
> captcha_captchastore

但是，即使所有其他表都工作得很好，`captcha_captchastore`也找不到。此故障的可能原因是什么以及如何解决？

* * *

其他发现：
当我在生产机器上运行 Django 开发服务器并检查一切正常时。显然这与我运行 Django 的方式有关。我目前通过 fastcgi 设置了 nginx 和 Django。启动命令如下：

```
python manage.py runfcgi host=127.0.0.1 port=8081 --settings=settings 
```

这对查找数据库有何影响？应该是路径问题。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-20T13:54:53.440

当您处于模板环境或另一个应用程序的范围内时，我无法找出数据库路径是如何构建的，但设置绝对路径名可以解决问题。

# r - 引用 R 数据框中的列

> ID：12003429
> 
> 赞同：1
> 
> 时间：2012-08-17T09:44:51.567
> 
> 标签：r, function, reference, dataframe

我无法按名称引用数据框中的列。我的函数从提取不存在 NA 的行开始：

```
prepare <- function(dataframe, attr1,attr2){
subset_na_still_there <- dataframe[!is.na(attr1) & !is.na(attr2),]
subset_na_still_there2 <- subset(dataframe, !is.na(attr1) & !is.na(attr2))
### someother code goes here
} 
```

但是，返回的子集仍然包含 NA。我没有错误。这是一个[相关的问题](https://stackoverflow.com/questions/2641653/pass-a-data-frame-column-name-to-a-function)

编辑：选择列，然后按数字引用它们就可以了：

```
prepare <- function(dataframe, attr1,attr2){
subset_cols <- dataframe[,c(attr1, attr2)]
subset_gone <- subset_cols[!is.na(subset_cols[,1]) & !is.na(subset_cols[,2]),]
} 
```

为什么第一个版本不能按预期工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:26:09.903

这个怎么样：

```
prepare <- function(x, attr1, attr2){
  x[!is.na(x[attr1]) & !is.na(x[attr2]),]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:57:31.080

```
df <- data.frame(att1=c(1,NA,NA,10),att2=c(NA,1,2,3),val=c("a","z","e","r"))

df
  att1 att2 val
1    1   NA   a
2   NA    1   z
3   NA    2   e
4   10    3   r

test <- function(df,att1,att2){
df_no_na <- df[!is.na(att1) & !is.na(att2),]
df_no_na
}

test(df,df$att1,df$att2)
  att1 att2 val
4   10    3   r 
```

这对我有用。你确定NA的？是`is.na(df$att1)`回报`TRUE`吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T09:49:30.377

与其创建自己的函数，不如尝试`subset`：

```
subset(mydata, !is.na(attr1) & !is.na(attr2)) 
```

如果您想删除*任何*字段中带有 NA 的行，请尝试

```
na.omit(mydata) 
```

# java - Hibernate 查询语法异常：org.hibernate.hql.ast.QuerySyntaxException：意外令牌

> ID：12003430
> 
> 赞同：6
> 
> 时间：2012-08-17T09:44:52.060
> 
> 标签：java, hibernate

我有一个查询，我在哪里加入两个表 ROuteMaster 和 RouteHalts。当我执行内部连接时，我得到了

```
org.hibernate.hql.ast.QuerySyntaxException: unexpected token: on near line 1, 

column 169 [SELECT  rm.id , rm.routeCode , rm.startPlaceId , rm.endPlaceId , 
rm.active, rm.linkedRoute FROM com.oprs.pojo.routes.RouteMaster rm  INNER JOIN 
RouteHalts rh  on rm.id = rh.routeId  WHERE  rh.placeId = :PlaceId  
ORDER BY  rm.id  ASC] 
```

我搜索了该网站，发现了类似的问题及其响应。提到的问题是

```
Hibernate: org.hibernate.hql.ast.QuerySyntaxException: unexpected token 
```

我在 RouteHalts 中有 RouteMaster 的多对一映射，我在 RouteHalts 中为 RouteMaster 定义了 getter 和 setter 方法

```
<many-to-one name="RouteMaster" class="com.oprs.pojo.routes.RouteMaster" 
                    fetch="join"
            foreign-key="id" column="ROUTE_ID" insert="false"
            update="false" lazy="false" /> 
```

但仍然得到同样的错误。请有人指导我。

映射文件

```
<hibernate-mapping package="com.oprs.pojo.routes">
    <!-- Hibernate mapping for RouteMaster table -->
    <class name="RouteMaster" table="OPRS_ROUTE_MASTER">
        <id name="id" column="ROUTE_ID" type="java.lang.Long">
            <generator class="assigned" />
        </id>
        <property name="startPlaceId" column="START_PLACE_ID"/>
        <property name="endPlaceId" column="END_PLACE_ID"/>
        <property name="routeCode" column="ROUTE_CODE"/>
        <property name="routeName" column="ROUTE_NAME"/>
        <property name="active" column="IS_ACTIVE"/>
        <property name="linkedRoute" column="LINKED_ROUTE"/>
        <property name="returnRouteId" column="RET_ROUTE_ID"/>
        <!-- Auditor Information -->
        <component name="auditor" class="com.oprs.pojo.base.Auditor">
            <property name="createdBy" column="CREATED_BY" />
            <property name="createdDate" column="CREATED_DATE" />
            <property name="modifiedBy" column="MODIFIED_BY" />
            <property name="modifiedDate" column="MODIFIED_DATE" />
        </component>
        <many-to-one  name="RouteHalts" class="com.oprs.pojo.routes.RouteHalts" fetch="join"
            foreign-key="routeId" column="ROUTE_ID" insert="false"
            update="false" lazy="false" />
    </class>

    <!-- Hibernate mapping for RouteHalts table -->
    <class name="RouteHalts" table="OPRS_ROUTE_HALTS">
        <id name="id" column="HALTS_ID" type="java.lang.Long">
            <generator class="assigned" />
        </id>
        <property name="routeId" column="ROUTE_ID"/>
        <property name="placeId" column="PLACE_ID"/>
        <property name="seqNo" column="SEQ_NO"/>
        <property name="distanceKM" column="DISTANCE_KM"/>
        <property name="border" column="IS_BORDER"/>
        <property name="tolls" column="NO_OF_TOLLS"/>       
        <!-- Auditor Information -->
        <component name="auditor" class="com.oprs.pojo.base.Auditor">
            <property name="createdBy" column="CREATED_BY" />
            <property name="createdDate" column="CREATED_DATE" />
            <property name="modifiedBy" column="MODIFIED_BY" />
            <property name="modifiedDate" column="MODIFIED_DATE" />
        </component>
    </class>

POJO of Route Master 
```

公共类 RouteMaster 扩展 Persistent {

```
private static final long serialVersionUID = -5710336066048392949L;

private Long startPlaceId;
private Long endPlaceId;
private Long returnRouteId;
private String startPlaceCode;
private String endPlaceCode;
private String startPlaceName;
private String endPlaceName;
private String routeCode;
private String routeName;
private String active;
private Auditor auditor;
private boolean revervseRoute;
private String linkedRoute = AppConstants.N;
private Map<Double, RouteHalts> haltsMap;
private RouteHalts routeHalts;

public RouteHalts getRouteHalts() {
    return routeHalts;
}

public void setRouteHalts(RouteHalts routeHalts) {
    this.routeHalts = routeHalts;
}

public Long getStartPlaceId() {
    return startPlaceId;
}

public void setStartPlaceId(Long startPlaceId) {
    this.startPlaceId = startPlaceId;
}

public Long getEndPlaceId() {
    return endPlaceId;
}

public void setEndPlaceId(Long endPlaceId) {
    this.endPlaceId = endPlaceId;
}

public String getStartPlaceCode() {
return startPlaceCode;
}

public void setStartPlaceCode(String startPlaceCode) {
this.startPlaceCode = startPlaceCode;
}

public String getEndPlaceCode() {
return endPlaceCode;
}

public void setEndPlaceCode(String endPlaceCode) {
this.endPlaceCode = endPlaceCode;
}

public Long getReturnRouteId() {
    return returnRouteId;
}

public void setReturnRouteId(Long returnRouteId) {
    this.returnRouteId = returnRouteId;
}

public String getRouteCode() {
return routeCode;
}

public void setRouteCode(String routeCode) {
this.routeCode = routeCode;
}

public Auditor getAuditor() {
return auditor;
}

public void setAuditor(Auditor auditor) {
this.auditor = auditor;
}

public String getStartPlaceName() {
    return startPlaceName;
}

public void setStartPlaceName(String startPlaceName) {
    this.startPlaceName = startPlaceName;
}

public String getEndPlaceName() {
    return endPlaceName;
}

public void setEndPlaceName(String endPlaceName) {
    this.endPlaceName = endPlaceName;
}

public String getActive() {
    return active;
}

public void setActive(String active) {
    this.active = active;
}

public Map<Double, RouteHalts> getHaltsMap() {
    return haltsMap;
}

public void setHaltsMap(Map<Double, RouteHalts> haltsMap) {
    this.haltsMap = haltsMap;
}

public boolean isRevervseRoute() {
    return revervseRoute;
}

public void setRevervseRoute(boolean revervseRoute) {
    this.revervseRoute = revervseRoute;
}

public String getLinkedRoute() {
    return linkedRoute;
}

public void setLinkedRoute(String linkedRoute) {
    this.linkedRoute = linkedRoute;
}

public String getRouteName() {
    return routeName;
}

public void setRouteName(String routeName) {
    this.routeName = routeName;
} 
```

}

```
POJO of RouteHalts 
```

公共类 RouteHalts 扩展 Persistent {

```
private static final long serialVersionUID = -1491637903595290895L;
private Long placeId;
private Long routeId;
private String placeCode;
private Double seqNo;
private Double distanceKM;
private boolean border;
private Auditor auditor;

private String placeName;
private String stateCode;
private String stopType;
private String departureTime;
private Integer tolls;
private String platformNo;
private Long stopTypeId;
private Integer linkSequenceNo;
private String actualTime;
private int arrivalDay;

public String getStateCode() {
    return stateCode;
}

public void setStateCode(String stateCode) {
    this.stateCode = stateCode;
}

public Long getRouteId() {
    return routeId;
}

public void setRouteId(Long routeId) {
    this.routeId = routeId;
}

public Long getPlaceId() {
    return placeId;
}

public void setPlaceId(Long placeId) {
    this.placeId = placeId;
}

public String getPlaceCode() {
return placeCode;
}

public void setPlaceCode(String placeCode) {
this.placeCode = placeCode;
}

public Double getDistanceKM() {
return distanceKM;
}

public void setDistanceKM(Double distanceKM) {
this.distanceKM = distanceKM;
}

public boolean isBorder() {
    return border;
}

public void setBorder(boolean border) {
    this.border = border;
}

public Auditor getAuditor() {
return auditor;
}

public void setAuditor(Auditor auditor) {
this.auditor = auditor;
}

public String getPlaceName() {
    return placeName;
}

public void setPlaceName(String placeName) {
    this.placeName = placeName;
}

public Double getSeqNo() {
    return seqNo;
}

public void setSeqNo(Double seqNo) {
    this.seqNo = seqNo;
}

public String getStopType() {
    return stopType;
}

public void setStopType(String stopType) {
    this.stopType = stopType;
}

public String getDepartureTime() {
    return departureTime;
}

public void setDepartureTime(String departureTime) {
    this.departureTime = departureTime;
}

public Integer getTolls() {
    return tolls;
}

public void setTolls(Integer tolls) {
    this.tolls = tolls;
}

public String getPlatformNo() {
    return platformNo;
}

public void setPlatformNo(String platformNo) {
    this.platformNo = platformNo;
}

public Long getStopTypeId() {
    return stopTypeId;
}

public void setStopTypeId(Long stopTypeId) {
    this.stopTypeId = stopTypeId;
}

public Integer getLinkSequenceNo() {
    return linkSequenceNo;
}

public void setLinkSequenceNo(Integer linkSequenceNo) {
    this.linkSequenceNo = linkSequenceNo;
}

public int getArrivalDay() {
    return arrivalDay;
}

public void setArrivalDay(int arrivalDay) {
    this.arrivalDay = arrivalDay;
}

public String getActualTime() {
    return actualTime;
}

public void setActualTime(String actualTime) {
    this.actualTime = actualTime;
} 
```

}

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T09:52:21.483

您不应该在 HQL 中使用显式的“JOIN ON”。相反，您可以在 HQL 中使用隐式连接：

```
SELECT  rm.id , rm.routeCode , rm.startPlaceId , rm.endPlaceId , rm.active , rm.linkedRoute 
FROM com.abhibus.oprs.pojo.routes.RouteMaster rm  
INNER JOIN rm.routeHalts rh WHERE  rh.placeId = :PlaceId  ORDER BY  rm.id  ASC 
```

或者您可以使用 Theta 样式来编写连接：

```
SELECT  rm.id , rm.routeCode , rm.startPlaceId , rm.endPlaceId , rm.active , rm.linkedRoute 
FROM com.abhibus.oprs.pojo.routes.RouteMaster rm, RouteHalts rh
WHERE rm.id = rh.routeId AND rh.placeId = :PlaceId  ORDER BY  rm.id  ASC 
```

您也可以将查询作为本机 SQL 查询执行，而不是 HQL 查询。为此，您应该使用

```
session.createSQLQuery(queryText); 
```

代替

```
session.createQuery(queryText); 
```

顺便说一句，在您的情况下，最好获取整个实体，而不是单独的字段（列）？为此，您可以使用：

```
select rm from ... 
```

这将返回`List<RouteMaster>`insted 的`List<Object[]>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:58:31.553

像这样更改您的查询；

```
SELECT rm.id, rm.routeCode, rm.startPlaceId, rm.endPlaceId, rm.active, rm.linkedRoute 
FROM RouteMaster rm 
   INNER JOIN rm.routeHalts AS rh ON rm.id = rh.routeId 
WHERE rh.placeId = :PlaceId 
ORDER BY rm.id ASC 
```

# android - Google Play 使用统计：手机应用 VS 网站

> ID：12003432
> 
> 赞同：3
> 
> 时间：2012-08-17T09:44:54.360
> 
> 标签：android, google-play

我正在考虑聘请平面设计师为我的应用程序创建高分辨率 (1 024 x 500) “促销”图像。

根据我的经验（浏览其他应用程序），我注意到这种图像仅在 Google Play 商店的网络版本中以全尺寸显示。

为了更好地了解投资回报率，我真的很想知道**通过 Google Play 网站**（与通过常规 Android 移动应用程序相比）获得的应用程序下载百分比。

*   这个数字是公开的吗？
*   您是否设法通过跟踪您自己的应用程序的下载来源来获得一些统计数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:19:02.803

根据我的经验（下载量为 300 000 次的应用程序），只有不到 5% 的下载量来自 Google Play 网站。我不了解公众人物，我通过跟踪 Google Play 安装引荐来源获得了这些数据（utm_source=google 是 Google Play 网站）。这并没有给我一个确切的计数，因为有些安装没有推荐人，但它有助于获得一个大致的想法。

当然，对我的应用有效的东西可能对你不适用。我想说，越多的人可以使用关键字从 Google 搜索中找到您的 Google Play 页面，您从该网页下载的次数就越多。大多数人直接从他们的设备浏览应用商店。

# javascript - phonegap Android中的pdf查看器

> ID：12003441
> 
> 赞同：10
> 
> 时间：2012-08-17T09:45:33.107
> 
> 标签：javascript, android, html, cordova

我正在寻找使用Phonegap 2.0 的Android pdf 查看器。我尝试了适用于 iOS 但不适用于 Android 的 childbrowser 插件。我试过这个[http://www.giovesoft.com/2011/08/download-and-open-pdf-with-phonegap.html](http://www.giovesoft.com/2011/08/download-and-open-pdf-with-phonegap.html)但这也不起作用，我收到错误消息，例如 PhoneGap is not defined at file and无法调用未定义的方法“showPdf”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T09:54:12.897

你可以使用 pdf.js ：

> pdf.js 是一个 HTML5 技术实验，它探索构建一个忠实高效的可移植文档格式 (PDF) 渲染器，无需原生代码帮助。

[https://github.com/mozilla/pdf.js](https://github.com/mozilla/pdf.js)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T12:27:13.807

我已经回答了一个类似的问题（请参阅[Open PDF with PhoneGap in Android](https://stackoverflow.com/questions/13394507/open-pdf-with-phonegap-in-android/13397400)），但在这里也会这样做。按照建议将 ChildBrowser 插件与 Google Docs 结合使用，如下所示：

```
onclick='window.plugins.childBrowser.showWebPage(encodeURI("http://docs.google.com/viewer?url=' + pdfLink + '")); 
```

这对我来说很好，我已经在 Android 2.1 到 4.1 中对其进行了测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-15T08:39:28.887

在 Android 中，您可以使用 Android Intents 查看 pdf。这将向您显示手机中可用的所有 pdf 查看器。您可以选择任何并查看pdf

例如：

```
private void showPdfAndroid(String url) throws IOException {
    Intent intent = new Intent();
    intent.setAction(android.content.Intent.ACTION_VIEW);
    File file = new File(url);

    String extension = url.substring(url.lastIndexOf(".")+1);
    String type = "";

    if (extension.toLowerCase().equals("pdf")) {
        type = "application/pdf";
        Log.d("application/pdf", "application/pdf");
    } 

    intent.setDataAndType(Uri.fromFile(file), type);
    cordova.getActivity().startActivity(intent);

    Log.d("FileViewerPlugin", "View complete in" + url);

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T12:23:23.617

我尝试使用的 childbrowser 插件无法在 android phonegap 中打开 pdf。但是，它适用于 iOS。插件查询的另一个解决方案可能是使用 Open With 插件。这个插件有一个缺点，它不能在应用程序本身中打开 pdf。您可以使用下载器插件下载文件，然后尝试使用 childbrowser 插件来访问此 pdf，我认为这应该是解决方案

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-06T07:32:22.377

子浏览器不支持在 android 中查看 pdf。最好在 android 中使用 Google 文档查看器。在[另一个堆栈溢出问题](https://stackoverflow.com/questions/16795172/phonegap-inappbrowser-display-pdf-2-7-0)中，您将得到完整的答案

# java - Java硬编码开关与哈希图

> ID：12003447
> 
> 赞同：14
> 
> 时间：2012-08-17T09:46:27.300
> 
> 标签：java, performance, hashmap

一些 Message 类能够根据标签号返回标签名称

由于这个类被实例化了很多次，我有点不愿意为每个实例创建一个 HashMap：

```
public class Message {
  private HashMap<Integer,String> tagMap;

  public Message() {
    this.tagMap = new HashMap<Integer,String>();
    this.tagMap.put( 1, "tag1Name");
    this.tagMap.put( 2, "tag2Name");
    this.tagMap.put( 3, "tag3Name");
  }

  public String getTagName( int tagNumber) {
    return this.tagMap.get( tagNumber);
  }
} 
```

支持硬编码：

```
public class Message {
  public Message() {
  }

  public String getTagName( int tagNumber) {
    switch( tagNumber) {
      case 1: return "tag1Name";
      case 2: return "tag2Name";
      case 3: return "tag3Name";
      default return null;
    }
  }
} 
```

当您将所有内容（内存，性能，GC，...）混合在一起时，

**是否有任何理由坚持使用 HashMap？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T09:54:28.557

`MAP`在静态块中初始化。

而且由于您将创建许多 Message 对象。您应该编写这样的代码

```
public class Message {

  private static HashMap tagMap;

  static {
     tagMap = new HashMap();
     tagMap.put( 1, "tag1Name");
     tagMap.put( 2, "tag2Name");
     tagMap.put( 3, "tag3Name");
  }

  public Message() {

  }

  public String getTagName( int tagNumber) {
    return tagMap.get( tagNumber);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:06:02.597

Map 可以用作命令模式，其中键代表条件，值代表要执行的命令，唯一的缺点是对象在使用之前创建，所以如果你有大量这样的条件，那么你可以选择 map else`switch`总是优雅的方法，如果你条件很少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:50:51.177

取决于你需要什么。例如，如果您曾经需要使用 a 获取所有标签名称以进行显示，那么您`Map`将得到回报。此外，如果您用 a 替换，`TreeMap`您可以对它们进行排序。
如果您没有这样的需求，那么使用 a`Map`将是一种开销，并且您的方法或 an`Enum`会更有效（尽管您的可读性低于 5-10-20 选项的`case`选项）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T09:55:00.940

为什么不将 getTagName 方法设为静态并从属性文件中延迟加载呢？

```
public static String getTagName(int tagNumber) {
    if tagsByID == null) {
        // load tags from properties
    }
    return tagsByID.get(tagNumber);
} 
```

无需重新编译即可轻松测试和配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T09:58:50.343

如果您的所有标记值在区间内都是连续的，`[1..n]`那么您可以使用数组或者可以`ArrayList`直接访问这些值。

```
public class Message {
    private ArrayList<String> tags;

    public Message() {
        this.tags =  = new ArrayList<String>();
        this.tags.add("Unknown");
        this.tags.add("tag1Name");
        this.tags.add("tag2Name");
        this.tags.add("tag3Name");
    }

    public String getTagName(int tagNumber) {
        return this.tags.get(tagNumber);
    }
} 
```

用数组替代。

```
public class Message {
    private static final String[] tags = {
        "N/A",
        "tag1Name",
        "tag2Name",
        "tag3Name",
        null,
        null,
        "tag6Name",
    };

    public Message() {
    }

    public String getTagName(int tagNumber) {
        if (tagNumber < 0 || tagNumber > tags.length) {
            throw new IllegalArgumentException();
        return tags[tagNumber];
    }
} 
```

# java - 在不同服务器上的 Web 应用程序之间实现 SSO，而不更改现有应用程序

> ID：12003451
> 
> 赞同：0
> 
> 时间：2012-08-17T09:46:47.960
> 
> 标签：java, tomcat, single-sign-on

我们已经创建了 2 个 JAVA Web 应用程序 A 和 B，并在两台服务器上使用 TOMCAT 将其托管在两台不同的服务器上。这些应用程序已经移至生产环境，我们无法进行任何重大更改或将其移至单个服务器，因为它不在我们的控制范围内。

身份验证是通过许多其他应用程序也使用的通用 LDAP 服务器完成的。

现在，客户希望我们创建一个新的应用程序 C，一旦登录，最终用户应该能够访问上述 2 个应用程序 A 和 B（通过链接），而无需重新登录（SSO）。

请建议如何实施。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T20:36:28.093

CAS 似乎是解决这个问题的正确方法，但我看不出你能做些什么来避免接触任何东西。

您至少必须接触一些配置文件。看看： - [Spring Security 和 CAS 集成](https://stackoverflow.com/questions/9834710/spring-security-and-cas-integration)

问候

# javascript - 用其内容替换父元素

> ID：12003458
> 
> 赞同：9
> 
> 时间：2012-08-17T09:47:10.253
> 
> 标签：javascript, dom

我正在尝试做与此问题类似/相同的事情： [如何在 JavaScript 中仅删除父元素而不是其子元素？](https://stackoverflow.com/questions/170004/how-to-remove-only-the-parent-element-and-not-its-child-elements-in-javascript)

```
<div>
    This is some text here
    <h2>This is more text</h2>
</div> 
```

我想要的只是删除 H2 标签。结果应该是：

```
<div>
    This is some text here
    This is more text
</div> 
```

假设我已经有了 H2 元素：

```
if (parentElement.nodeName.toLowerCase() == "h2") {
    //now what? I basically want to this: $.replaceWith(parentElement.innerText)
    //just without jQuery
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-08-13T05:04:51.503

# 使用现代 JS！

```
const h2 = document.querySelector('h2');
h2.replaceWith(h2.firstChild); 
```

要替换为所有孩子，请使用：

```
h2.replaceWith(...h2.childNodes); // or h2.children, if you don't want textNodes 
```

[developer.mozilla.org](https://developer.mozilla.org/en-US/docs/Web/API/ChildNode/replaceWith)

[我可以使用](https://caniuse.com/#feat=dom-manip-convenience)- 94% 2020 年 4 月

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-17T09:57:58.357

假设变量`h2`准确地引用了`h2`您想要操作的元素，我的第一个想法是：

```
var h2 = document.getElementsByTagName('h2')[0],
    textnode = h2.firstChild;

h2.parentNode.insertBefore(textnode,h2.nextSibling);
h2.parentNode.removeChild(h2);​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Pm3aM/4/)。

为了使它稍微干燥一点，函数方法可以是：

```
function unwrapH2(el) {
    if (!el) {
        return false;
    }
    else {
        var textnode = el.firstChild,
            elParent = el.parentNode;

        elParent.insertBefore(textnode, h2.nextSibling);
        elParent.removeChild(h2);
    }
}

var h2 = document.getElementsByTagName('h2')[0];

unwrapH2(h2); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Pm3aM/3/)。

根据 Felix Kling 的评论（如下）调整了上述内容，并使用`replaceChild()`：

```
function unwrapH2(el) {
    if (!el) {
        return false;
    }
    else {
        var textnode = el.firstChild,
            elParent = el.parentNode;
        elParent.replaceChild(textnode,el);
    }
}

var h2 = document.getElementsByTagName('h2')[0];

unwrapH2(h2); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Pm3aM/5/)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T09:52:00.220

首先，开始使用 jQuery。它使您的生活更轻松。

在 jQuery 中，执行以下操作：

```
var h2html = $('div h2').html();
$('div h2').remove();
$('div').append(h2html); 
```

* * *

**编辑：**

以上仅适用于 1`div`和 1`h2`元素，这是 div 中的最后一个元素。这只是一个简单的例子。下面是让你的生活更轻松的代码：

```
$('div h2').each(function (x, y) {
    $(this).replaceWith($(this).html());
});​ 
```

# wpf - 防止从 UserControl 继承

> ID：12003459
> 
> 赞同：0
> 
> 时间：2012-08-17T09:47:11.393
> 
> 标签：wpf, xaml, user-controls

我有一个 wormControl 类，它应该从 MyUserControl 继承，但是在构建解决方案时，wormControl 是从 UserControl 继承的。无论如何，我希望它继承自 MyUserControl。如何实施？

这是我的 UserControl 的 XAML 文件：

```
<UserControl
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:System="clr-namespace:System;assembly=mscorlib"
mc:Ignorable="d"
x:Class="FishGameAnimations.wormControl"
d:DesignWidth="575" d:DesignHeight="339">
/* ...other stuff... */
</UserControl> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:00:14.017

正如所说，您的基本控件必须没有 XAML。您的所有设计都应该从后面的代码构建。查看 Rafal 提供的链接。如何为控件设置基类的示例

```
<Controls:MyUserControl x:Class="Termo.Win.Controls.ChildControl"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:Controls="clr-namespace:Namespace.MyUserControl"> 
```

# yii - 获取缓存表中保存记录的 Yii DB Cache id

> ID：12003462
> 
> 赞同：2
> 
> 时间：2012-08-17T09:47:24.150
> 
> 标签：yii

我有一个这样的查询：

```
$record=books::model()->cache(10000)->find('id=:id',array(":id"=>$id)); 
```

Yii 使用 CDbCache 将结果保存在缓存表中

```
id     expire      value 
--     ------      ------ 
```

我的问题是：

> 如何在yii缓存表中获取缓存记录的id-这个id是yii生成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:02:58.640

没有公开的方法来获取缓存 ID，因为它包含了很多变量，如果你真的想要，你可以，但在 Yii 的深处它真的很黑暗。

根据评论回答：

您始终可以在记录中设置最后缓存时间，然后您可以使用它来计算剩余时间。但这不会在页面跨度上持续存在，因为您的缓存会导致您不会再次读取它。所以你的选择是：

*   手动进行缓存，并将时间存储在要用于计算的对象上
*   或者存储会话中提取的每个 ID 的时间，并使用它来计算它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-12T08:24:37.757

要回答这个问题。顺便提一下 Yii 代码的编写方式，你无法获取 YII 内部生成的 Cache 的 ID/Key。如果您查看源代码

> [https://github.com/yiisoft/yii/blob/1.1.16/framework/db/CDbCommand.php](https://github.com/yiisoft/yii/blob/1.1.16/framework/db/CDbCommand.php) 方法**查询内部**

您会意识到**cacheKey**生成是一件复杂的事情。而且这个cacheKey会被MD5进一步Hash

> 参考：[http ://www.yiiframework.com/doc/api/1.1/CCache#generateUniqueKey-detail](http://www.yiiframework.com/doc/api/1.1/CCache#generateUniqueKey-detail)

如果你使用 'cache' 作为 QueryBuilder 的一部分，那么我们通过提供 Expire Duration 和 Dependency Query 赋予 Yii 管理这个缓存的权力。

如果您想要控制/控制过期时间并想要拥有 ID，那么唯一的方法是按照用户 [Paystey](https://stackoverflow.com/users/737033/paystey)的建议手动设置 CacheID，如下所示：

```
$dbResult = Yii::app()->cache->get('YOUR-KNOWN-KEY');
if($dbResult === false){
    $dbResult = YOUR-QUERY;
    Yii::app()->cache->set('YOUR-KNOWN-KEY, $dbResult);
} 
```

# sql-server - SQL - 如何返回没有倍数的结果

> ID：12003468
> 
> 赞同：0
> 
> 时间：2012-08-17T09:47:47.173
> 
> 标签：sql-server, business-objects

我正在尝试编写一个业务对象报告，以显示在选定日期未返回时间表的人员列表，但我不知道如何停止 SQL 查询为个人返回多个条目。

我的 Staff_Table 包含 2 列 - 员工编号和姓名 我的 Timesheet_Table 包含员工编号和 Week_Ending_Date 等。

我可以轻松地编写一个语句来返回所有输入了 Week_Ending_Date 为例如 10/08/2012 的时间表的用户。但是，如果我尝试返回所有没有填写 2012 年 8 月 10 日时间表的人的列表，我会在表格中选取没有该日期的每个时间表，例如，如果一个人有提交了 100 个时间表，其中只有 1 个是 10/08/2012，结果将显示他 99 次。我需要的是 Staff_Table 上尚未在该日期提交的每个人的固定列表，仅显示一次。

我尝试了一个不存在的联合，但要么我做错了，要么就是不合适。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:57:18.913

您应该首先选择所有未输入时间表的员工编号。然后，使用 NOT IN 过滤列表。

```
DECLARE @Week_Ending_Date DATETIME = '2012-08-10'
DECLARE @Staff TABLE
(
    EmployeeNo INT NOT NULL,
    EmployeeName NVARCHAR(100) NOT NULL
)
DECLARE @TimeSheet TABLE
(
    EmployeeNo INT NOT NULL,
    Week_Ending_Date DATETIME
)

INSERT INTO @Staff (EmployeeNo, EmployeeName)
VALUES (1, 'Alan'), (2, 'Peter')

INSERT INTO @TimeSheet (EmployeeNo, Week_Ending_Date)
VALUES (1, '2012-08-10'), (1, '2012-08-17'), (2, '2012-08-03')

SELECT
    S.EmployeeName
FROM
    @Staff S
WHERE
    EmployeeNo NOT IN (SELECT EmployeeNo FROM @TimeSheet WHERE Week_Ending_Date = @Week_Ending_Date) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:49:49.630

尝试将 DISTINCT 添加到您的查询中

IE

```
SELECT DISTINCT ... 
```

您的查询应该类似于

```
SELECT * 
FROM Staff
WHERE NOT EXISTS 
(
    Select EmployeeNo 
    from Timesheet 
    where WeekEndingDate='2012-08-10'     
    and TimeSheet.EmployeeNo  = Staff.EmployeeNo 
) 
```

或者

```
SELECT * 
FROM Staff
WHERE EmployeeNo NOT IN 
(
    Select EmployeeNo 
    from Timesheet 
    where WeekEndingDate='2012-08-10'
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T09:53:55.933

您可以使用`not exists`子句查找未提交特定时间表的员工：

```
select  *
from    Staff s
where   not exists
        (
        select  *
        from    Timesheet t
        where   t.EmployeeNo =  s.EmployeeNo
                and t.Week_Ending_Date = '2012-08-19'
        ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T09:55:34.093

您不能只选择所有尚未提交时间表的员工并按他们的姓名对结果进行分组吗？

```
select Name
from Staff_Table
left join Timesheet_Table on Staff_Table.[Employee No] = Timesheet_Table.[Employee No] and  Timesheet_Table.Week_Ending_Date = '10 August 2012'
having Timesheet_Table.Week_Ending_Date is null
group by Name, Timesheet_Table.Week_Ending_Date 
```

我还没有测试过这个，但是这些方面的东西。

# c# - 从命令行覆盖目标框架

> ID：12003475
> 
> 赞同：22
> 
> 时间：2012-08-17T09:48:14.147
> 
> 标签：c#, msbuild

我想从命令行构建一个`c#`项目（.csproj），`msbuild`并希望以 .Net2.0 运行时为目标。

我看到项目 xml 文件有`2 tags`兴趣

```
<Project ToolsVersion="4.0" ... 
```

和

```
<TargetFrameworkVersion>v2.0</TargetFrameworkVersion> 
```

我想知道如果

*   ToolsVersion 4.0 能否为 .Net2.0 运行时生成兼容代码？
*   我可以通过命令行覆盖项目文件中的目标框架标签吗（`/ToolsVersion`命令行开关是否实现了这一点？

我特别想通过命令行来实现这一点，而不是修改项目文件。

目前我正在做这样的事情

```
msbuild myproj.csproj /p:Configuration=Release 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-17T10:01:18.303

您需要 msbuild 的命令行参数才能使其工作：

```
msbuild.exe MyProj.proj /p:TargetFrameworkVersion=v2.0;Configuration=Release /tv:3.5 
```

因此覆盖 proj 文件中的值以及 ToolsVersion。

要找出使用的默认 msbuild 版本，请启动 Visual Studio 命令提示符（位于开始菜单 > Microsoft Visual Studio 2010 > Visual Studio 工具中）并键入 msbuild。输出的第一行将保存您的 BuidEngineversion：

> Microsoft (R) Build Engine 版本 4.0.30319.1

来自 msdn 文档：

> MSBuild 使用一组任务、目标和工具来构建应用程序。通常，MSBuild 工具集包括一个 microsoft.common.tasks 文件、一个 microsoft.common.targets 文件以及 csc.exe 和 vbc.exe 等编译器。大多数工具集可用于将应用程序编译到多个版本的 .NET Framework 和多个系统平台

您还可以检查 Environment vars 以获取安装的框架版本： `set F`从 Visual Studio 命令提示符给我这个结果：

> Framework35Version=v3.5
> FrameworkDir=c:\Windows\Microsoft.NET\Framework\
> FrameworkDIR32=c:\Windows\Microsoft.NET\Framework\
> FrameworkVersion=v4.0.30319
> FrameworkVersion32=v4.0.30319

[工具集说明](http://msdn.microsoft.com/en-us/library/bb397428)
[ToolSetVersion](http://msdn.microsoft.com/en-us/library/bb383796)

# ruby-on-rails - 如何在控制器操作中同时渲染模板和 JS 文件

> ID：12003477
> 
> 赞同：0
> 
> 时间：2012-08-17T09:48:16.110
> 
> 标签：ruby-on-rails

我有一个场景，在编辑操作中，我需要渲染 edit.html.erb 以及触发 edit.js.erb 文件。现在我有

```
 def edit
    @page_id = params[:id]
    respond_to do |format|
    format.html
    format.js
    end
  end 
```

但只有视图在渲染，但我的 edit.js.erb 仍然没有触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:55:12.283

用js响应并在下面编写代码：

编辑.js.erb

```
$('body').html('<%=j render "edit" %>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T09:58:14.640

你对它所做的事情的印象是错误的。

如果您希望 javascript 运行，那么您的 edit.html.erb 文件需要包含：

```
<%= javascript_include_tag "jsfilename" %> 
```

并将您的 javascript 存储在 public/javascripts/jsfilename 或类似位置（public/assets/javascripts/

对 format.html、format.js 的响应用于请求该格式的视图。

例如。如果我浏览到 edit.html，它会显示 html.erb 视图，如果我浏览到 edit.js，它会显示 js.erb 视图。该功能使您可以请求不同文件格式的相同内容，而不是向您的网页添加 javascript 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T11:19:19.197

使用这两种分析器，您都可以使其正常工作，但您不遵循约定。edit.js 用于 Ajax 调用。

您似乎在做的是使用部分来构建您的页面。那么你真的应该遵循命名约定（以_开头的文件名）以便其他程序员清楚。

其次，您始终需要确保您的网站可以在没有 javascript 的情况下运行，因此您的编辑页面永远不需要任何 Javascript 才能运行。javascript 是对改善用户体验的补充（例如使用 ajax 进行编辑而无需页面刷新）。

总结： - 将“必需的”javascript 代码移至您的 edit.html.erb。- 如果 Ajax 被激活，只使用 edit.js.coffee 来处理现有网页的更新，使用来自 edit.html.erb 的尽可能多的 js。- 将共享代码的其余部分放入部分中，例如 _niceedit.js.coffee 并使用 'render :partial=>' 渲染它...

遵循约定，它将在以后和使用测试服务等时为您提供帮助。

# scala - 玩迁移替代品

> ID：12003480
> 
> 赞同：8
> 
> 时间：2012-08-17T09:48:40.783
> 
> 标签：scala, playframework, migration, squeryl

我即将开始一个将使用 Play 的新项目！Scala 2 框架，可能使用 Squeryl 作为 ORM（但如果及时准备好，Slick 也可以）。

现在，玩！具有使用迁移升级数据库的功能。不幸的是，这些迁移是用 SQL 编写的。这不仅带来不便（我希望能够在 Scala 中编写迁移），而且有两个问题

*   首先，我需要自己编写迁移。我习惯了[South](http://south.aeracode.org/)，它能够通过查看我的模型的当前和以前的定义来推断模式迁移；
*   其次，处理数据迁移会非常麻烦。可能需要以编程方式更改数据，而这在纯 SQL 中甚至是不可行的。

所以，我正在寻找替代方案。我无法为任何可以自动生成模式迁移的 Scala ORM 找到任何迁移工具，有吗？

我能找到的最好的工具是[Scala 迁移](http://code.google.com/p/scala-migrations/)。有没有办法让Play！自动使用它来代替自己的迁移工具？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T13:51:17.703

另一种选择是[Flyway](http://flywaydb.org/)，但它不会解决您的集成问题。

为此，您可以像使用标准 Play 一样实现插件！进化，您可以使用[Global 对象](http://www.playframework.org/documentation/2.0.2/ScalaGlobal)在应用程序启动时开始迁移。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-17T10:11:49.870

Play2 中的 Evolutions 是作为[插件](http://www.playframework.org/documentation/api/2.0.2/scala/index.html#play.api.Plugin)实现的。您可以检查它的[实现](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/play/api/db/evolutions/Evolutions.scala)并按照相同的方式推出您自己的实现。据我所知，没有一种简单的方法可以将实现换成另一个。

另一个可能值得一看的工具是[Liquibase](http://www.liquibase.org)。它是用 Java 实现的，所以应该很容易从 Scala 中使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-17T13:45:57.550

我推荐[liquibase](http://www.liquibase.org/)。Liquibase 是一个开源的、独立于数据库的库，用于跟踪、管理和应用数据库更改。它建立在一个简单的前提之上：所有数据库更改都以人类可读但可跟踪的形式存储并签入源代码控制。Liquibase 可用于 Java 和 Scala。Liquibase 的优点在于您可以使用 XML、SQL 或两者的组合来满足您的数据库迁移需求。它易于设置和使用，并且具有非常广泛的文档。

# refactoring - 接口中方法的重复实现。重构

> ID：12003481
> 
> 赞同：0
> 
> 时间：2012-08-17T09:48:49.387
> 
> 标签：refactoring, abstract-class, subclass, superclass

只是经过一点帮助！

我正在重构一些代码，想知道是否可以创建抽象类方法的多个实现。

比如说，在我的一个子类中，我有一个输入属性，因此我有 setInput 和 getInput，但是，在我的另一个子类中，我有两个输入属性，因此 setInput1、setInput2 和 getInput1 和 getInput2 它们都有相同的实现代码。有没有办法在我的抽象类中重构它？

谢谢！

我正在使用 Java。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:55:07.507

与其根据参数的数量使用两个不同的接口，不如考虑使用具有默认值的参数。目前尚不清楚您使用的是什么语言，但大多数语言都支持类似这样的伪代码：

setInput(var input1, var input2 = NULL)

# facebook - Graph API 资源管理器中的 FQL 查询未返回配置文件中的所有数据

> ID：12003482
> 
> 赞同：0
> 
> 时间：2012-08-17T09:49:06.197
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我为我的 Facebook 应用程序创建了一个测试用户，并填写了姓名、头像、音乐、电视、电影、书籍、活动和兴趣等字段。该信息在那里，我可以在配置文件中查看它，但由于某些原因，尽管指定了看似正确的权限，但当我以用户身份登录时，即使通过 Grap API 资源管理器也无法访问此信息。

当我转到 Graph API 资源管理器时，转到 FQL 选项卡并启动以下查询，我只得到某些字段：

```
SELECT name,pic_big,music,tv,movies,books,email FROM user WHERE uid = me() 
```

回应是：

```
{
  "data": [
    {
      "name": "Aisha Bibi",
      "pic_big": "http://profile.ak.fbcdn.net/hprofile-ak-snc4/274348_100004159483336_574477135_n.jpg",
      "music": "",
      "tv": "",
      "movies": "",
      "books": "",
      "email": "aisha_gjmodrm_bibi@tfbnw.net"
    }
  ]
} 
```

我通过选择以下用户数据权限为该请求生成了访问令牌： `email, user_activities, user_education_history, user_interests`.

谁能告诉我为什么它无法为用户检索信息，即使它存在于配置文件中，我已经详细说明了正确的权限（？）并且我在访问 Graph API 浏览器工具时以他们的身份登录？

先谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:25:07.737

很抱歉 - 我似乎没有足够清楚地阅读文档。为了访问用户的音乐和电影等，您需要获得`user_likes`许可。我希望这对某人有帮助！

# perl - perl 文件读取、截断

> ID：12003486
> 
> 赞同：-2
> 
> 时间：2012-08-17T09:49:14.293
> 
> 标签：perl, file, fseek

我正在尝试修改配置文件。

我首先将它读入`@buffer`，这取决于正则表达式匹配。修改后的缓冲区被写回到磁盘上，以防文件变小，截断完成。

不幸的是，这不起作用，它已经崩溃了`fseek`，但据我所知，我对 fseek 的使用符合 perl doc。

```
open (my $file, "+<", "somefilethatexists.txt");
flock ($file, LOCK_EX);
foreach my $line (<$file>) {
    if ($line =~ m/(something)*/) {
        push (@buffer, $line);
    }
}
print "A\n";
seek($file,0,0); #seek to the beginning, we read some data already

print "B\n"; # never appears

write($file, join('\n',@buffer)); #write new data
truncate($file, tell($file)); #get rid of everything beyond the just written data
flock($file, LOCK_UN);
close ($file); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T12:49:26.757

`perlopentut`说这个关于[混合读取和写入](http://perldoc.perl.org/perlopentut.html#Mixing-Reads-and-Writes)

> ...在更新文件时...您可能不想使用这种方法进行更新。

你应该使用[`Tie::File`](https://metacpan.org/module/Tie%3a%3aFile)这个。它在同一个文件句柄上打开文件进行读取和写入，并允许您将文件视为行数组

```
use strict;
use warnings;

use Tie::File;

tie my @file, 'Tie::File', 'somefilethatexists.txt' or die $!;

for (my $i = 0; $i < @file; ) {
  if (m/(something)*/) {
    $i++;
  }
  else {
    splice @file, $i, 1;
  }
}

untie @file; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T09:53:33.140

也许你可以试试这个：

```
$^I = '.bak';
@ARGV = 'somefilethatexists.txt';
while (<>) {
    if (/(something)*/) {
        print;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T10:28:44.380

`fseek()`您的,`fwrite()`和`ftruncate()`函数在哪里定义？Perl 没有这些功能。您应该使用`seek()`, `print()`(或`syswrite()`) 和`truncate()`. 如果您使用我们一无所知的功能，我们将无法真正帮助您。

您也不需要（并且可能不希望）显式调用来解锁文件或调用关闭文件。一旦您的`$file`变量超出范围，文件句柄将被关闭并解锁。

# asp.net - GridView中文本框的RegularExpressionValidator不起作用

> ID：12003490
> 
> 赞同：1
> 
> 时间：2012-08-17T09:49:22.937
> 
> 标签：asp.net, regex, gridview, requiredfieldvalidator

我有 GridView：

```
<asp:GridView ID="MyGridView" runat="server" ShowFooter="true"
                                AutoGenerateColumns="False" Visible="True">
<Columns>
<asp:BoundField DataField="id" ItemStyle-HorizontalAlign="center"/>
<asp:BoundField DataField="fullName"  />
<asp:TemplateField HeaderText="situation>">
<ItemTemplate>
  <asp:DropDownList ID="dl_situation" runat="server">
   </asp:DropDownList>
</ItemTemplate>
</asp:TemplateField>

<asp:TemplateField>
 <ItemTemplate>
         <asp:TextBox ID="tbNr" runat="server"></asp:TextBox>
</ItemTemplate>
</asp:TemplateField>  
<asp:TemplateField HeaderText="Data">
<ItemTemplate>
 <asp:TextBox ID="tbDate" runat="server"></asp:TextBox>
 </asp:RequiredFieldValidator>
 </ItemTemplate>
</asp:TemplateField>     
</Columns>
</asp:GridView> 
```

它工作正常，但是当我为 id="tbDate" 的文本框添加 RegularrExpressionValidator 时，mygrid 不起作用此正则表达式必须接受格式为“dd.MM.yyyy”的日期时间

```
 <asp:GridView ID="MyGridView" runat="server" ShowFooter="true"
                                AutoGenerateColumns="False" Visible="True">
<Columns>
<asp:BoundField DataField="id" ItemStyle-HorizontalAlign="center"/>
<asp:BoundField DataField="fullName"  />
<asp:TemplateField HeaderText="situation>">
<ItemTemplate>
  <asp:DropDownList ID="dl_situation" runat="server">
   </asp:DropDownList>
</ItemTemplate>
</asp:TemplateField>

<asp:TemplateField>
 <ItemTemplate>
         <asp:TextBox ID="tbNr" runat="server"></asp:TextBox>
</ItemTemplate>
</asp:TemplateField>  
<asp:TemplateField HeaderText="Data">
<ItemTemplate>
 <asp:TextBox ID="tbDate" runat="server"></asp:TextBox>
 <asp:RegularExpressionValidator ID="RegularCert" runat="server" 
      ControlToValidate="tbDate" ErrorMessage="Incorect Data" 
 ValidationExpression=
"(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)[0-9]{2}" 
      Display="Dynamic"></asp:RegularExpressionValidator>
     <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
      ErrorMessage="*" ControlToValidate="tbDate">
   </asp:RequiredFieldValidator>
 </ItemTemplate>
</asp:TemplateField>     
</Columns>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:03:20.220

我认为您在 ControlToValidate 属性中输入了“tbData”而不是“tbDate”

```
<asp:RegularExpressionValidator ID="RegularCert" runat="server" 
  ControlToValidate="tbDate" ErrorMessage="Incorect Data"   ValidationExpression= "(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)[0-9]{2}" 
  Display="Dynamic"></asp:RegularExpressionValidator> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T13:10:08.233

我改成for ，`ClientIDMode`开始工作`Predictable``TextBox``RegularExpressionValidator``RequiredFieldValidator`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T10:06:27.360

更改`ControlToValidate="tbData"`为`ControlToValidate="tbDate"`_`<asp:RegularExpressionValidator`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T10:01:52.563

您是否尝试过将其放置在`<asp:RegularExpressionValidator ...>`内部， `<ItemTemplate>`
`<asp:TextBox ID="tbDate" runat="server"></asp:TextBox>`
`</ItemTemplate>` 如果它未能通过正则表达式验证，您还需要指示一些要显示的文本

实际上哈莉所说的很可能是答案哈

# php - 如何将输出作为文件提供而不将其保存在服务器上

> ID：12003495
> 
> 赞同：4
> 
> 时间：2012-08-17T09:49:32.767
> 
> 标签：php, csv, export-to-csv

我`fputcsv()`通过在服务器上创建一个文件，填充它，然后在下一页链接到它，使用 PHP 从 MySQL 数据库中提供一些记录。

这很有效，而且很棒，但由于这可能是敏感数据，我不希望在为（可能）一次性下载创建文件时在服务器上挂起一堆文件。

所以我想知道的是：有没有一种方法可以创建此文件并提供下载服务，而无需在服务器上实际写入永久文件？

例如，我可以创建一个逗号分隔的字符串，而不是`fputcsv()`在输出缓冲区中使用并提供正确的标题吗？

显而易见的举动是删除文件，但我需要等到客户端先下载它，这样就很难决定何时执行。

欢迎任何建议

编码：

```
$fp = fopen($filename, 'w');
fputcsv($fp, array("Last Name", "First Name"));
foreach ($result as $fields) 
{
    fputcsv($fp, $fields);
}
fclose($fp); 
```

[http://php.net/manual/en/function.fputcsv.php](http://php.net/manual/en/function.fputcsv.php)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-20T00:14:40.660

fputcsv() 是一个很棒的小函数，所以我不会放弃它。

相反，我建议您使用 PHP 的内置[I/O Wrappers](http://php.net/manual/en/wrappers.php.php)

例如，您可以这样做以逐行“流式传输”您的 CSV 数据（取决于各种输出缓冲区，但这是另一回事）：

```
<?php
header('Content-type: text/csv; charset=UTF-8');
header('Content-disposition: attachment; filename=report.csv');
$fp = fopen('php://output','w');
foreach($arrays as $array) fputcsv($fp, $array); 
```

这很好用，但如果出现问题，您的用户将无法下载。

因此，如果您没有太多数据，您可以只写入内存中的流，只需交换`php://output`并`php://memory`移动内容：

```
<?php
$fp = fopen('php://memory','rw');

// our generateData() function might throw an exception, in which case 
// we want to fail gracefully, not send the user a broken/incomplete csv.
try {
    while($row = generateData()) fputcsv($fp, $row);
}catch(\Exception $e){
    // display a nice page to your user and exit/return
}

// SUCCESS! - so now we have CSV data in memory.  Almost like we'd spooled it to a file
//            on disk, but we didn't touch the disk.

//rewind our file handle
rewind($fp);

//send output
header('Content-type: text/csv; charset=UTF-8');
header('Content-disposition: attachment; filename=report.csv');
stream_get_contents($fp); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T09:51:34.997

而不是这样，为什么不让您的页面回显[csv mime 类型](http://webdesign.about.com/od/multimedia/a/mime-types-by-content-type.htm)，然后将文件回显给用户？

它很有魅力，永远不会创建文件并将其作为一次性文件传递给客户。

像这样的东西：

```
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=file.csv");
header("Pragma: no-cache");
header("Expires: 0");

echo "col1,col2";
for($i=0; $i<25;$i++)
{
    echo "key :".$i.", ".($i*$i)."\r\n";
} 
```

您应该能够按原样测试它并查看它是如何工作的。

增加的好处是大多数用户将被引导下载文件而不是打开它，因此用户甚至不会离开页面（大部分时间）。

# javascript - 当我获取它时，jQuery 减去 css 属性值

> ID：12003505
> 
> 赞同：0
> 
> 时间：2012-08-17T09:50:13.313
> 
> 标签：javascript, jquery, html, css

我在这里面临一个非常不合逻辑和奇怪的问题。

我在一个单独的 CSS 文件中定义了宽度、高度和其他属性。现在我在运行时对这些值进行操作以使我的应用程序动态化。

但是当我使用 获取这个值时`jQuery`，它会从该值中减去一两个。

例如，在 中定义的元素的宽度`CSS`是 450px，现在当我在`jQuery`使用中获取它时

```
$('.programeSectionBox').width(); 
```

它会给我449px。高度和边距参数也会发生这种情况。

有人可以告诉我这里发生了什么，我`struct`在这个问题上很糟糕。

* * *

感谢所有的答复。我已经检查了 outerWidth() 解决方案，但它不起作用，给出了同样的问题。

实际上我正在为三星智能电视创建一个应用程序，他们提供两种分辨率 960x540 和 1280x720。对于 960x540，一切都很好，但是当谈到 1280x720 时，问题就出现了，我已经提到过。

在我的应用程序中，我为这两种分辨率使用了一个 javascript 文件和两个不同的 CSS 文件，应用程序检查它在哪个电视分辨率上工作，然后加载相应的 CSS。我无法对 JavaScript 文件中的值进行硬编码，因为我想让它保持动态，如果我对值进行硬编码，它显然适用于一种分辨率。

因此，如果有人有任何其他解决方案，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T09:57:23.250

尝试使用 outerWidth ，看看是否适合您：

```
jQuery("#myElement").outerWidth(); 
```

更多关于外宽：

[http://api.jquery.com/outerWidth/](http://api.jquery.com/outerWidth/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:03:34.267

由于这发生在几个计算值（不仅是宽度/高度）上，我猜**你的浏览器是 zoomed**。在您的情况下，它可能会缩小一步，因为您似乎获得的值低于您通过 CSS 设置的值。

在这里试试这个例子：http: [//jsfiddle.net/zsygt/](http://jsfiddle.net/zsygt/)

当浏览器缩放重置为默认值（100%）时，它应该打印`448`. 但是当我在 Chrome 中放大一步时，它会打印`449`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:54:48.533

只需使用`parseInt`您获得的价值即可。

之后，您将获得整数值，然后您可以对其执行任何操作。

```
console.log(​parseInt('445px')​​);​ 
```

**[小提琴](http://jsfiddle.net/UPwGH/)**

# android - 可以在android中的edittext旁边添加语音操作按钮吗

> ID：12003507
> 
> 赞同：7
> 
> 时间：2012-08-17T09:50:28.910
> 
> 标签：android

我们可以在旁边有一个谷歌语音操作按钮`edittext`，所以每当用户想在edittext中输入一些东西时，他只需点击按钮，说话并进入`edittext`. 我们可以做这样的事情，而不是用户必须点击`edittext`打开软键盘选择语音操作按钮，然后说出打印到`edittext`.

期待你的答复。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T10:03:33.453

把这个

```
 Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,
            RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
    intent.putExtra(RecognizerIntent.EXTRA_PROMPT, "Voice recognition Demo...");
    startActivityForResult(intent, REQUEST_CODE); 
```

进入您的 onClick() 并让 onActivityResult() 填写结果。

# css - WebKit 和 Mozilla 中的 -ms-clear 等价物是什么？

> ID：12003508
> 
> 赞同：4
> 
> 时间：2012-08-17T09:50:31.797
> 
> 标签：css, html, webkit, mozilla, textinput

如此处所示：http: [//msdn.microsoft.com/library/windows/apps/Hh465498](http://msdn.microsoft.com/library/windows/apps/Hh465498)

Mozilla 和 Webkit 有相同的选项吗？文本输入上的清除按钮适用于触摸屏应用程序。我不想要任何 JavaScript 变通办法，简单的 CSS 修复会非常有帮助。

我已经知道这可以通过 JavaScript 实现，但是 IE 10 有一个用于显示清除按钮的内置解决方案，我想知道是否有其他浏览器有类似的选项？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T10:16:29.463

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-11T22:49:18.300

正在寻找同样的问题，所以我制作了一个 jQuery 插件（[TextClear](http://plugins.jquery.com/textClear/)）来提供相同的功能：
这里是下载[链接](http://exexzian.github.io/TextClear/)

* * *

以及这背后的技巧：

*   在输入文本字段上设置背景图像并将其定位到右上角，例如

> ```
> {
>   background-image: url('imagesUrl');
>   background-repeat: no-repeat;
>   background-position: right center;
>   background-size: 10% 90%;
>   padding-right: 1%;
> } 
> ```

*   然后通过映射其位置来处理其上的点击事件（您也可以查看源代码以了解详细逻辑）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T10:49:15.273

您实际上无法使用 css 执行此操作。

但是你可以使用 jQuery，而且它很简单。你要做的就是这个...

HTML 代码：

```
<form id="myform" method="post">
<input type.... />
<input type.... />
<input type.... />
<input type="button" id="clear" name="clear" />
</form> 
```

jQuery代码：

```
$("#clear").click(function(){
     $("#myform").reset();
}); 
```

这将起作用..但是表单标签是必要的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-20T12:07:32.287

YU NO 喜欢 Javascript 吗？看看 jQuery 使这个过程变得多么简单：

**标记**

```
<form>
    <input type="text">
    <button>X</button>
</form> 
```

**jQuery**

```
$("form").on("click", "button", function() {
    $("input").val("");
    return false;
});​​​​​ 
```

[http://jsfiddle.net/QyE92/](http://jsfiddle.net/QyE92/)

使用 CSS，您可以设置按钮的样式并将其放置在适当的位置，以几乎完全模仿 Metro 界面中的“x”。

# .htaccess - 根据子域将资源移动到不同的域

> ID：12003512
> 
> 赞同：-1
> 
> 时间：2012-08-17T09:50:42.987
> 
> 标签：.htaccess, mod-rewrite

几家公司正在共享资源（wiki、论坛、商店......），现在他们喜欢为此使用一个服务器证书。

网址如下所示：

```
company1.domain1.com or www.company1.domain1.com
company2.domain2.com or www.company2.domain2.com 
company3.domain3.com or www.company3.domain3.com 
```

新的指向相同`newdomain.com/company1`的主机。

我最终想要实现的是：

```
newdomain.com/company1
newdomain.com/company2
newdomain.com/company3 
```

在浏览器中，当有人输入`www.company2.domain2.com`URL 时，您应该会看到`http://newdomain.com/company2`（不带`www`）

我需要两个例子。一个正是我描述的这个东西。第二个是同样的事情，但在我想看到的 URL 的末尾`https://newdomain.com/company2`（不带`www`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:06:13.003

在您的 , , 等文档根目录中的 htaccess 文件中`domain1.com`，`domain2.com`添加`domain3.com`：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?([^.]+)\.[^.]+\.com$ [NC]
RewriteRule ^(.*)$ http://newdomain.com/%2/$1 [L,R=301] 
```

这将重定向`http://www.mycompany.somedomain.com/path/to/file.txt`到`http://newdomain.com/mycompany/path/to/file.txt`

# spring - 是否可以覆盖 Spring 命名空间处理程序？

> ID：12003520
> 
> 赞同：2
> 
> 时间：2012-08-17T09:51:14.170
> 
> 标签：spring, spring-mvc

SpringMVC 带有一个由（不出所料）“MvcNamespaceHandler”处理的“mvc”命名空间，定义如下：

```
public class MvcNamespaceHandler extends NamespaceHandlerSupport {

public void init() {
    registerBeanDefinitionParser("annotation-driven", new AnnotationDrivenBeanDefinitionParser());
    registerBeanDefinitionParser("default-servlet-handler", new DefaultServletHandlerBeanDefinitionParser());
    registerBeanDefinitionParser("interceptors", new InterceptorsBeanDefinitionParser());       
    registerBeanDefinitionParser("resources", new ResourcesBeanDefinitionParser());
    registerBeanDefinitionParser("view-controller", new ViewControllerBeanDefinitionParser());
} 
```

}

我想修改命名空间的行为，以便 mvc:resources 元素由自定义 ResourcesBeanDefinitionParser 处理（在我的情况下，替换 ResourcesHttpRequestHandler，由 bean 定义解析器创建，具有自定义实现）。

我想知道是否有可能在不经历创建全新命名空间的麻烦的情况下做到这一点（如此处所述[http://static.springsource.org/spring/docs/2.0.x/reference/extensible-xml .html](http://static.springsource.org/spring/docs/2.0.x/reference/extensible-xml.html)）。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:54:53.357

您可以创建一个自定义命名空间来注册不同的 ResourceHttpRequestHandler，但正如您所说，这绝对是一项很好的工作。

更好的方法可能是简单地在配置中显式定义 bean，ResourcesBeanDefinition 本质上是这样做的：

```
<bean name="resourceHandler" class="org.springframework.web.servlet.resource.ResourceHttpRequestHandler">
    <property name="locations">
        <list>
            <value>/resources/</value>
    </property>
</bean>

<bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="urlMap">
        <map>
            <entry key="/resources/**" value-ref="resourceHandler"/>
        </map>
    </property>
</bean> 
```

您可以在此处简单地将 resourceHandler 替换为您的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T21:18:19.633

我今天遇到了同样的问题（但对于上下文命名空间处理程序）。我以一种骇人听闻的方式完成了它。

`spring.handlers`在您的文件夹中创建一个名为的`META-INF`文件并放置一个覆盖默认模式的声明。在你的情况下，是这样的：

```
http\://www.springframework.org/schema/mvc=org.springframework.web.servlet.config.MvcNamespaceHandler 
```

为了

```
http\://www.springframework.org/schema/mvc=YOURBEANPATH. 
```

也许您需要`spring.handlers`在 jar 中声明文件，其名称以大于“s”的字母开头（在我的情况下是“t”），因为 spring 将按`spring.handlers`找到的顺序合并定义。

有关调试信息，请查看`DefaultNamespaceHandlerResolver#getHandlerMappings`.

# android - 如何将请求代码传递给 onSearchRequested，如 startForActivityResult？

> ID：12003522
> 
> 赞同：1
> 
> 时间：2012-08-17T09:51:28.633
> 
> 标签：android, android-activity

我想将请求代码传递给可搜索的活动，例如`startActivityForResult`. 但是`onSearchRequested`又`startSearch`不能通过它。在下面的示例中，我假设在按下菜单图标后，搜索对话框将显示在窗口顶部，我将发送请求代码和查询到可搜索的活动。

```
private static final int SEARCH_REQUEST_CODE = 100;

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode != RESULT_OK) {
        return;
    }

    switch (requestCode) {
    case SEARCH_REQUEST_CODE:
        // Something to do after finishing the searchable activity

    }
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    Intent intent;
    switch (item.getItemId()) {
    // ...

    case 2:
        onSearchRequested(); // I want to pass SEARCH_REQUEST_CODE here!
        return true;

    // ...
    }
} 
```

我已阅读 API 指南 ( [https://developer.android.com/guide/topics/search/search-dialog.html](https://developer.android.com/guide/topics/search/search-dialog.html) ) 中的搜索接口教程和 API 参考。但是，我不知道如何做到这一点。

# android - 如何在 Android 上为 EditText 设置 MultiLine 和 imeOptions="actionDone"？

> ID：12003525
> 
> 赞同：4
> 
> 时间：2012-08-17T09:51:40.923
> 
> 标签：android, android-softkeyboard

如何同时设置这些选项：

*   `android:minLines="3"`
*   `android:inputType="textMultiLine"`
*   `android:imeOptions="actionDone"`

好像我一放`android:inputType="textMultiLine"`，键盘就自动把*OK*键换成了*Enter 键*。有谁知道是否可以同时拥有两个密钥？

注意：这个[答案](https://stackoverflow.com/questions/2986387/multi-line-edittext-with-done-action-button)不是我想要的。我想要两把钥匙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-09-29T12:56:42.067

嗨，我也面临同样的问题，最后我得到了解决方案。

改变

```
android:inputType="textMultiLine" 
```

至

```
android:inputType="text" 
```

和

在 .java 文件中使用 id 访问 EditText

```
editText.setHorizontallyScrolling(false);

editText.setMaxLines(3); 
```

现在在 editText 上实现 OnEditorAction。

```
 editText.setOnEditorActionListener(new TextView.OnEditorActionListener() {
        @Override
        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
            if (actionId == 4) { //actionId 4 for actionDone And 6 for actionSend

                //perform action what you want

                return true;
            } else
                return false;
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T12:23:04.977

唯一可以保证的是 Android 会将`inputType`and传递`imeOptions`给 IME。IME 对它们的处理取决于实现。在某些 IME*可能*决定在多行模式下有足够的屏幕空间来显示两个键的情况下，不应依赖该行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-27T13:12:39.100

如果您创建 EditText 的子类并插入此函数，它应该可以解决您的问题。

这个问题在[https://stackoverflow.com/a/5037488/7403656](https://stackoverflow.com/a/5037488/7403656)得到了回答，但是我做了一些改动，从 xml 中获取了 imeOption，而不是仅仅将其设置为 Done 选项。

```
@Override
public InputConnection onCreateInputConnection(EditorInfo outAttrs) {
    InputConnection connection = super.onCreateInputConnection(outAttrs);
    int imeOptions = getImeOptions();
    int imeActions = outAttrs.imeOptions & EditorInfo.IME_MASK_ACTION;
    if ((imeActions & imeOptions) != 0) {
        // clear the existing action
        outAttrs.imeOptions ^= imeActions;
        // set the DONE action
        outAttrs.imeOptions |= imeOptions;
    }
    if ((outAttrs.imeOptions & EditorInfo.IME_FLAG_NO_ENTER_ACTION) != 0) {
        outAttrs.imeOptions &= ~EditorInfo.IME_FLAG_NO_ENTER_ACTION;
    }
    return connection;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-14T21:24:46.497

在这里为类似问题写了一个答案：[https](https://stackoverflow.com/a/42236407/7550472) ://stackoverflow.com/a/42236407/7550472事实证明，这对我来说是一种可取之处，因为没有其他任何方法。为了更容易访问，我也将代码粘贴到这里给像我这样的懒人；）。

*在您的 Java 代码中：*

```
////////////Code to Hide SoftKeyboard on Enter (DONE) Press///////////////
editText.setRawInputType(InputType.TYPE_CLASS_TEXT|InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD|InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS);
editText.setImeActionLabel("DONE",EditorInfo.IME_ACTION_DONE);              //Set Return Carriage as "DONE"
editText.setImeOptions(EditorInfo.IME_ACTION_DONE);

editText.setOnEditorActionListener(new TextView.OnEditorActionListener() {
    @Override
    public boolean onEditorAction(TextView v, int actionId, KeyEvent event) 
    {
                if (event == null) {
                    if (actionId == EditorInfo.IME_ACTION_DONE) {
                        // Capture soft enters in a singleLine EditText that is the last EditText
                        // This one is useful for the new list case, when there are no existing ListItems
                        EditText.clearFocus();
                        InputMethodManager inputMethodManager = (InputMethodManager)  getActivity().getSystemService(Activity.INPUT_METHOD_SERVICE);
                        inputMethodManager.hideSoftInputFromWindow(getActivity().getCurrentFocus().getWindowToken(), 0);
                    }

                    else if (actionId == EditorInfo.IME_ACTION_NEXT) {
                        // Capture soft enters in other singleLine EditTexts
                    } else if (actionId == EditorInfo.IME_ACTION_GO) {
                    } else {
                        // Let the system handle all other null KeyEvents
                        return false;
                    }
                } 
        else if (actionId == EditorInfo.IME_NULL) {
                    // Capture most soft enters in multi-line EditTexts and all hard enters;
                    // They supply a zero actionId and a valid keyEvent rather than
                    // a non-zero actionId and a null event like the previous cases.
                    if (event.getAction() == KeyEvent.ACTION_DOWN) {
                        // We capture the event when the key is first pressed.
                    } else {
                        // We consume the event when the key is released.
                        return true;
                    }
                } 
        else {
                    // We let the system handle it when the listener is triggered by something that
                    // wasn't an enter.
                    return false;
                }
                return true;
        }
}); 
```

XML中`minLines`定义的属性将保持不变，而其他两个属性则不需要，因为它在 Java 代码中处理。

# java - JButton 中的图像未显示

> ID：12003532
> 
> 赞同：4
> 
> 时间：2012-08-17T09:52:27.010
> 
> 标签：java, swing, package, imageicon

有人可以看看这段代码并告诉我我做错了什么吗？图像根本没有显示。它们在同一个包中。

谢谢

```
 public class MWindow31Pic extends JFrame implements ActionListener{
       private JPanel contPane = (JPanel) this.getContentPane();
       private JButton button = new JButton(new ImageIcon("open.jpg"));
       boolean clicked = false;

    public MWindow31Pic(String title){
      super(title);
      this.build();
    }

    public void actionPerformed(ActionEvent event){
       if (! clicked) {
          button.setIcon(new ImageIcon("close.jpg"));
          //button.setText("You clicked ME!!!!"); 
          clicked = true;
       }
       else{
          button.setIcon(new ImageIcon("open.jpg"));
          //button.setText("Click Me"); 
          clicked = false;
       }
    }

    public void build(){
        // adding JComponents
        contPane.add(button);
        button.addActionListener(this);

       // JFrame settings    
       this.setResizable(false);
       this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
       this.setLocationRelativeTo(null);
       this.setSize(240,188);
       this.setVisible(true);
    }
   } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:57:00.753

您应该像这样创建 ImageIcon：

```
new ImageIcon ( MWindow31Pic.class.getResource ( "close.jpg" ) ) 
```

因为用你的方式：

```
new ImageIcon ( "close.jpg" ) 
```

图像应该在应用程序工作目录中，而不是在调用类包中。

您可能还想将图像移动到单独的文件夹中：

```
new ImageIcon ( MWindow31Pic.class.getResource ( "images/close.jpg" ) ) 
```

# facebook - Facebook 上的“喜欢/不喜欢”事件点击

> ID：12003534
> 
> 赞同：3
> 
> 时间：2012-08-17T09:52:28.300
> 
> 标签：facebook, facebook-like

只有当人们喜欢我的 Facebook 页面时，我才会尝试在我的网站上显示内容。不幸的是，我无法让它工作......我使用 edge.create 和 edge.remove 但即使我“喜欢”页面，它也会通过“edge.remove”函数而不是“edge.create”函数...

这是我的代码：

```
<!DOCTYPE html>

<html lang="fr" xmlns:fb="http://ogp.me/ns/fb#">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">     
        <meta name="DC.Language" content="fr" />
        <meta name="DC.Creator" content="Noomia" />
        <meta name="keywords" content="" />
        <meta name="description" content="" />          
    <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <link rel="stylesheet" type="text/css" href="./css/screen.css" media="screen" />
    <link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>

    <script src="./js/scripts.js" type="text/javascript" charset="utf-8"></script>
    <title>Concours LTBR</title>  

</head>

<body>
    <div id="fb-root"></div>
    <script>
    window.fbAsyncInit = function() {
        FB.init({
          appId      : '118439091595657', // App ID
          channelUrl : 'http://cedriccharles.be-webdesigners.com/concoursLTBR/index.html', // Channel File
          status     : true, // check login status
          cookie     : true, // enable cookies to allow the server to access the session
          xfbml      : true  // parse XFBML
        });

        FB.Event.subscribe('edge.create', function(href) {
            alert('Like');
         });
        FB.Event.subscribe('edge.remove', function(href) {
            alert('Unlike');    
        });
    };
    // Load the SDK Asynchronously
      (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement('script'); js.id = id; js.async = true;
         js.src = "//connect.facebook.net/fr_FR/all.js";
         ref.parentNode.insertBefore(js, ref);
       }(document));
</script>

    <div id="main">
    <fb:like href="https://www.facebook.com/pages/Noomia-studio/100473956669259" send="false" width="960" show_faces="true"></fb:like>
    </div>
</body> 
```

# java - Java：通过我的程序清除 NetBeans 控制台

> ID：12003539
> 
> 赞同：1
> 
> 时间：2012-08-17T09:52:53.703
> 
> 标签：java, netbeans, command-line

我想清除 NetBeans 控制台的控制台输出。我们可以使用`Ctrl`+手动清除它`L`。

是否可以在 Java 中以编程方式执行此操作？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-11-17T08:32:28.593

我认为这不是那么简单。

Netbeans 控制台并不是真正的完整系统控制台。

我会看到一个合适的选项——比如使用 Netbeans RPC 绑定获取控制台引用，但您的应用程序需要作为 Netbeans 插件或捆绑包运行。（所以 - 不要那样做，保持简单）

对于快捷方式（解决方法） - 您可以尝试使用 java.awt.Robot 类发送 keyRelease 事件（Ctrl+L），同时在控制台中获得焦点（有效地将 Ctrl+L 事件发送到焦点组件）

# grails - Grails 导出插件不适用于 namedQuery

> ID：12003542
> 
> 赞同：1
> 
> 时间：2012-08-17T09:53:03.700
> 
> 标签：grails, groovy, export, grails-plugin

我目前正在研究 grails 导出插件。如果我只做简单的 list()，插件就可以工作。但是如果我将它与命名查询相关联，它就不再起作用了。这是代码的一部分。：

```
def buildReport(){
  if(params?.format && params.format != "html"){ 
    response.contentType = ConfigurationHolder.config.grails.mime.types[params.format]
    response.setHeader("Content-disposition", "attachment; filename=report.${params.extension}")

    exportService.export(params.format, response.outputStream,Building.selectStatus(params.q).list(params), [:], [:])
  }
} 
```

上面的代码不起作用。它抛出此错误：无法在空对象上调用方法 getSuperclass()。Stacktrace 如下：消息：无法在空对象上调用方法 getSuperclass()

任何人都可以帮忙吗？谢谢。

更新：我的 list.gsp 中有这个：

```
 <g:form action="list" controller="building">
    <g:select id="user" name="q" from="${myapp.Construction.list()}" optionKey="id" required="" value="${constructionId?.id}" class="many-to-one" />
    <g:submitButton name="Execute"/>
    </g:form> 
```

如果我提交该表单，它将列出或显示具有相同建筑 ID 的建筑物。该代码的某处是：

```
 <export:formats
formats="['csv', 'excel', 'ods', 'pdf', 'rtf', 'xml']" action="buildReport"/> 
```

该代码将调用 buildReport。但不幸的是调用buildReport时select的q或params.q为null。

顺便说一句，所有这些代码都在一个 gsp 文件中，并且在提交表单时会显示相同的 gsp。

* * *

好吧，我想我知道为什么它不起作用了。这是因为 params.q 的

```
 Building.selectStatus(params.q) 
```

实际上是空的！我不知道为什么它为空。我的 list.gsp 中有这个来传递参数：

```
 <g:textField name="q" value="${params.q ?: ''}" /> 
```

那么 gsp 中应该包含什么来传递参数？因为在这里，我才发现它是空的。

顺便说一句，在调用 buildReport 之前，文本字段有一个用户将输入的值。

# c# - 如何以编程方式添加内容查询 WebPart 并使用 SPSiteDataquery？

> ID：12003546
> 
> 赞同：0
> 
> 时间：2012-08-17T09:53:08.987
> 
> 标签：c#, sharepoint, cqwp, spsitedataquery

这是当前的情况。

我有一个名为：XXX 的中心站点。

我有许多子站点以年份名称命名：2012、2011、2010 等。

在中心站点，我有一个名为受益人的列表。

在 ALL year 站点中，我有一个名为 Request 的列表，这些列表中的每一个都有一个指向中央站点中受益人列表的查找列。

我需要在中心站点中创建一个 webpart 来显示受益人在所有子站点中的所有请求。（年网站）。我想知道 contentquery webpart 是否会完成这项工作，因为我认为我将不得不使用 spsitedataquery 而不是使用 spquery。

这是我到目前为止的代码。

```
/// <summary>
        /// Update dashboard beneficieries.
        /// </summary>
        /// <param name="currentUnsafeWeb"></param>
        private void UpdateDashboardBeneficiaries(SPWeb currentUnsafeWeb)
        {
            Logger.LogDebug("NLSubsidiesSiteConfigSubsidyCentralEventReceiver", "UpdateDashboardBeneficiaries(SPWeb currentUnsafeWeb)", "BEGIN");

            SPFile page = null;
            try
            {
                page = currentUnsafeWeb.GetFile("beneficiaries.aspx");
                page.CheckOut();

                //Add Content Query WebPart or something else to show all request in all yearsubsites that are related to the beneficiaries list.

                page.CheckIn(string.Empty);

            }
            catch (Exception)
            {
                if (page != null) page.UndoCheckOut();
                throw;
            }

            Logger.LogDebug("NLSubsidiesSiteConfigSubsidyCentralEventReceiver", "ConfigureDashboardBeneficiaries(SPWeb currentWeb)", "END");
         } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T12:39:15.023

这篇文章为我指明了正确的方向。

[http://msdn.microsoft.com/en-us/library/aa981241.aspx](http://msdn.microsoft.com/en-us/library/aa981241.aspx)

# google-maps - 根据您执行的国家/地区，GoogleMapApi 会降低精度

> ID：12003547
> 
> 赞同：2
> 
> 时间：2012-08-17T09:53:13.310
> 
> 标签：google-maps, google-maps-api-3, geolocation

我正在使用[http://code.google.com/p/php-google-map-api/](http://code.google.com/p/php-google-map-api/)。我做了一个应用程序来获取不同街道名称的纬度和经度。但是当我从国外执行这个脚本时，这种精度就会丢失，我无法对所有街道进行地理定位。

我认为 Google 会根据您所在的国家/地区保留不同的索引。如何更改我的 API 的国家（或地区）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:06:17.867

有一次我们进行了移动网络开发实验。我们使用*GoogleMaps*作为基本地理定位工具，用于映射/定位和测量基站特性。结果，我们很快就遇到了麻烦。

我们需要相当精确的数据（*最大偏差约 5 米*），您怎么看？这条长**2 公里**的街道（*经过实验以要求的精度测量*）在*GoogleMaps*中计算为**1.7 公里**。

 *此外，地图上显示的大多数斑块（*地面照片*）以不同的方式相互重叠。实际上，这取决于国家和拍摄精度，因为有些国家更详细，有些则不是（*非常不*）。

说到街道，这个偏差相当大，可以说是精确的。*在任何情况下，谷歌地图*都不应被视为精确的地理定位工具，尤其是在需要高精度时（*街道水平已经高于正常精度*）。

所以，我建议你不要太认真地考虑这些数据。否则， *GoogleMaps*对我们所有人来说都是一个非常好的安全漏洞。想象一下，您有**核弹**或**导弹**，并且您已经知道将其精确到几米的位置，位于撒哈拉沙漠中部的某个地方。这个给你 ...*

# android - RoboGuice 2.0 中的注入字段为空

> ID：12003549
> 
> 赞同：3
> 
> 时间：2012-08-17T09:53:29.650
> 
> 标签：android, dependency-injection, roboguice

我是 Roboguice 的新手，我想在我的新 Android 应用程序中使用它。

我有一个扩展 RoboActivity 的测试活动。

```
public class MainActivity extends RoboActivity {
    @Inject 
    private TestService testService;

    ....        
} 
```

这是我的 TestService 类：

```
public class TestService {

    @Inject
    private TestDao testDao;

    @Inject 
    protected static Provider<Context> contextProvider;

    public TestService(){
        Log.d("TEST_SERVICE", "Constructor test");
    }

    public Test getById(Integer id) throws Exception{
        return testDao.queryForId(id);
    }
} 
```

我希望 @Injected 内部的注释字段和注入的 Class 将被注入！

TestService 由 MainActivity 注入。但是 TestDao 是空的，也是我的 contextProvider！

我还定义了一个 roboguice.xml 文件，它定义了我的 IoCModule 类：

```
public class IoCModule extends AbstractModule{
    @Override
    protected void configure() {
        bind(TestDao.class).to(TestDaoOrm.class);
    }
} 
```

我不知道为什么内部的@Inject 不起作用！！

谢谢你的任何建议！！

谢谢马可

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T13:38:31.357

我已经解决了我的模块定义

```
requestStaticInjection( TestDaoOrm.class ); 
```

# jquery - 当相同元素存在于不同ns中时，xml解析中的问题，使用jquery

> ID：12003552
> 
> 赞同：1
> 
> 时间：2012-08-17T09:53:38.317
> 
> 标签：jquery, xml-parsing, jquery-xml

xml内容是：

```
<?xml version="1.0"?>
<rss version="2.0" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:yt="http://gdata.youtube.com/schemas/2007" xmlns:atom="http://www.w3.org/2005/Atom">
   <channel>
      <title>Some Title.</title>
      <description>Pipes Output</description>
      <link>http://pipes.yahoo.com/pipes/pipe.info</link>
      <atom:link rel="next" href="http://pipes.yahoo.com/pipes/pipe.run"/>
      <pubDate>Fri, 17 Aug 2012 07:25:28 +0000</pubDate>
      <generator>http://pipes.yahoo.com/pipes</generator>
      <item>
         <title>Title 1</title>
         <link>http://feedproxy.google.com</link>
         <description>there is no description for this</description>
         <guid isPermaLink="false">http://wordpress.com</guid>
         <pubDate>Thu, 16 Aug 2012 16:47:41 +0000</pubDate>
         <media:content medium="image" url="">
            <media:title type="html">some media</media:title>
         </media:content>
         <media:content medium="image" url="">
            <media:title type="html">Image</media:title>
         </media:content>
         <media:content medium="image" url="">
            <media:title type="html">Image</media:title>
         </media:content>
         <media:content medium="image" url="">
            <media:title type="html">Image</media:title>
         </media:content>
         <category>News</category>
      </item>        
      <item>
         <title>title 3</title>
         <link>http://google.com</link>
         <description>some description</description>
         <author>Self</author>
         <guid isPermaLink="false"></guid>
         <pubDate>Wed, 15 Aug 2012 17:43:32 +0000</pubDate>
         <enclosure type=""/>
      </item>

   </channel>
</rss> 
```

正如所观察到的，有些项目有`<media:content>`元素，有些没有

Jquery解析xml如下：

```
function loadNews()
{
    var entries = [];
    var selectedEntry = "";
    $loadMore = $('#btn_loadmore');
    $loadMore.hide();
    var RSS = "news.xml";                       
//$.get(RSS, {}, function(res, code) {
    $.ajax(
    {
        type: "POST",
        url: "news.xml",                               
        dataType: "xml",
        async: false,
        success: function(res){
        var xml = $(res);
        var items = xml.find("item");
        $.each(items, function(i, v) {
        entry = {
           title:$(v).find("\\:title, title").text(),
           link:$(v).find("link").text().replace(/\/+$/, ""),
           description:$.trim($(v).find("description").text())
    };
     entries.push(entry);
    });

    var s = '';
    for(i=0;i<10;i++)
    {
        console.log(i + "--------------------------");
        if(i>=entries.length)
        break;
        alert(entries[i].title);
        console.log(entries[i].description);
        console.log(entries[i].link);
    }
    }
    });                                                
} 
```

**问题：**

在 Firefox 中，上面的代码工作正常。然而，在 Safari 中，媒体标签内的文本也会附加在标题中

Firefox 中的输出：`Title 1`

Safari 中的输出：`Title 1some mediaImageImageImage`

**编辑：**我如何告诉选择器不要选择`<media:title>`但只`<title>`

我确实通过了这篇[文章](https://stackoverflow.com/questions/853740/jquery-xml-parsing-with-namespaces)，但没有任何帮助。

我错过了什么？

*我正在使用**jquery 1.7.1**，问题与 jquery 1.6.**** 相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T11:52:19.830

用来`find('[nodeName="title"]').text()`代替`find("\\:title, title").text()`

但这适用于 jquery 1.6，我想用 jquery 1.7.1 实现相同的效果

# javascript - XHR 如何防止验证非 XML 文件？

> ID：12003554
> 
> 赞同：1
> 
> 时间：2012-08-17T09:53:42.153
> 
> 标签：javascript, csv, xmlhttprequest

我正在使用 XHR 加载 CSV 文件。当然，顾名思义，它必须用于加载 XML，但您知道，没有其他东西可以真正加载其他类型的文件。发生的情况是它试图验证它收到的结果，而这不是必需的。也许它认为它一定是 XML，或者它可能对 CSV 应该是什么样子有一些内部（错误/任意）知识——无论如何，它会引发以下格式的错误：

> 错误：格式不正确 源文件：file:///~~~/docs/quiz.csv 行：1，列：1 源代码：צמתים,ארץ הגידול,שטח הגידול,אופן הגידול,קטיף/ בציר / אי שאריות,תהליכי עיבוד ושימור,אריזה,הפצת מזון,שווק/פרסום

实际上没有 CSV 标准或类似的东西，但即便如此，我相信 Firefox 正在尝试验证它，就好像它是 XML 一样（不管服务器发送不同的 mime 类型等）这不会影响功能，加载成功完成，但打印到控制台的错误仍然困扰着我。那么，有没有办法取消该验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:58:32.070

您可以使用

```
XMLHttpRequest().overrideMimeType() 
```

强制浏览器以您的方式处理数据。

[MDN 文档](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#overrideMimeType)

# amazon-ec2 - EC2 bitnami ruby stack 极慢

> ID：12003559
> 
> 赞同：0
> 
> 时间：2012-08-17T09:54:00.893
> 
> 标签：amazon-ec2

我在微型实例上的 bitnami RubyStack 3.2.7-0（rails 3.2，ruby 1.9.3）上运行单个 rails 应用程序。

该应用程序非常简单，用户可以登录、上传一些文件、更改他们的帐户设置，仅此而已。

我担心的是最简单的操作需要很长时间才能响应，例如登录需要大约两分钟才能响应（它所要做的就是从数据库中获取相应的用户并验证密码）。

涉及发送电子邮件（例如忘记密码）的用例需要更长的时间，但我想这是因为连接到 gmail 的 smtp 服务器需要一些时间（这就是我用来发送电子邮件的方法）。

任何想法为什么它这么慢？我应该升级实例的大小吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:04:55.437

尝试将 1.9.3 与 falcon 的补丁一起使用：1\. 加快加载时间 2\. 减少哈希内存（两者都在此处总结[https://gist.github.com/1688857?utm_source=rubyweekly&utm_medium=email](https://gist.github.com/1688857?utm_source=rubyweekly&utm_medium=email)） 3\. 反向移植来自 ruby​​ 2.0 的垃圾收集器[https://gist.github.com/1687289](https://gist.github.com/1687289)

# ruby-on-rails-3 - 阻止机器人使用会话

> ID：12003560
> 
> 赞同：2
> 
> 时间：2012-08-17T09:54:01.550
> 
> 标签：ruby-on-rails-3, search, bots

我正在开发一个网站并使用 Heroku 进行托管。我在他们的开发计划中，允许我使用他们的免费数据库，但最多只能使用 10,000 行。在两天没有接触该站点后，我震惊地看到 Heroku 的电子邮件警报说我的数据库中已达到 7,400 行。经过一些研究，我意识到搜索机器人正在创建会话。有没有办法阻止这种情况？我已经尝试了这篇文章中的解决方案，但它似乎不起作用：

[如何禁用 Web 爬虫的 Rails 会话？](https://stackoverflow.com/questions/9987797/how-to-disable-rails-sessions-for-web-crawlers)

我正在使用导轨 3.2.2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:37:09.173

正如这个问题（[在 Rails 3 中设置会话超时](https://stackoverflow.com/questions/5860950/setting-session-timeout-in-rails-3)）中所见，您可以实现会话的自动到期并在会话到期时删除数据库行。如果您保持会话到期时间较短并不断删除数据库行，我想您不会达到您的 Heroku 限制。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-17T10:22:32.180

为什么要将会话存储在数据库中？我建议您查找正在执行此操作的服务器/站点设置并将其禁用。在大多数情况下，将会话存储在数据库中是没有意义的，而且**绝对**不会在开发站点上。

# php - 表格 Joomla 菜单

> ID：12003562
> 
> 赞同：0
> 
> 时间：2012-08-17T09:54:04.513
> 
> 标签：php, joomla

我正在尝试将使用 UL-LI 在 Joomla 中创建的默认菜单转换为表格菜单，即 table-tr-td-a，任何有关如何扩展默认行为的帮助。

对不起，如果这听起来很菜鸟，但我是 Joomla 的一员！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T12:33:23.263

为此，您需要通过转到 ftp 中的 modules/mod_menu/tmpl/default.php 来编辑 ftp 中的 default.php 文件。您会看到它们与 ul、li 等元素相呼应。你只需要用表格代码替换这些。

或者，您可以从[JED](http://extensions.joomla.org/)下载具有表结构的内容。然而，大多数人发现 ul/li 元素要好得多，因此您可能会遇到困难。

在旁注中，表比 ul,li 等菜单元素慢得多，所以我真的不建议这样做。但不管你的船是什么！

# google-plus - 谷歌加分享按钮后回调

> ID：12003567
> 
> 赞同：4
> 
> 时间：2012-08-17T09:54:28.923
> 
> 标签：google-plus

我正在我的应用程序中实现 google plus。我想在用户共享消息后实现回调函数。请让我知道点击google plus中的分享按钮后是否可以实现回调。

在此先感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T13:15:52.500

实际上，通过设置共享标签属性或在调用 gapi.plus.render 时设置参数，有两种可能的回调可用。*onstartinteraction*指定的函数在分享气泡弹出时调用，*onendinteraction*指定的函数在气泡关闭时调用。

有关详细信息，请参阅[https://developers.google.com/+/plugins/share/#sharetag-parameters](https://developers.google.com/+/plugins/share/#sharetag-parameters)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-02T16:07:04.267

Google+ 分享按钮不支持回调。有一个[开放的功能请求](https://code.google.com/p/google-plus-platform/issues/detail?id=232)来添加此功能。给它加星标以表示您的兴趣，但请不要添加“+1”和“我也是！” 注释。

# php - 我怎样才能只允许我的表格中的请求

> ID：12003569
> 
> 赞同：0
> 
> 时间：2012-08-17T09:54:33.650
> 
> 标签：php, forms, security, cross-domain

我在服务器上有一个表单，并且 php 处理它，在另一台服务器上，此配置无法更改。我收到很多垃圾邮件，并试图修复它。由于跨域，SESSION 无法工作，因此没有令牌也没有验证码，$_SERVER["HTTP_REFERER"] 不可靠。我正在考虑实施一个每天更改一次的加密密钥，但我认为它是有限的。有更好的主意吗？

加密密钥示例：

```
$key = "string".date("d"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:00:24.890

您不需要会话即可使用 CAPTCHA。存在多种 CAPTCHA。即使是以下内容也可能会阻止 99% 的垃圾邮件程序：

```
<form action="...">
<input type="hidden" name="thequestion1" value="23">
<input type="hidden" name="thequestion2" value="-">
<input type="hidden" name="thequestion3" value="5">
How much is 23-5?
<input type="text" name="theanswer">
<input type="submit">
</form> 
```

大多数垃圾邮件机器人看起来只是输入字段和提交按钮。

我敢打赌，这种 CAPTCHA 会阻止大多数垃圾邮件。

PS：一定要安全地评估服务器上的question1、thequest2、thequest3的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:06:05.797

许多机器人不运行 javascript，因此您可以在表单中注入任意字段：

```
<form id="douchebag" action="http://yourotherserver.com/process.php" method="post">
<input type="text" name="name" />
.. bunch of other inputs
</form> 
```

然后你的js：

```
var bugSpray = document.createElement('input');
bugSpray.setAttribute('type', 'hidden');
bugSpray.setAttribute('name', 'aa');
bugSpray.value = 'bb';
document.getElementById('douchebag').appendChild(bugSpray); 
```

然后在你的`process.php`

```
if(empty($_POST['aa']) || $_POST['aa'] != 'bb') // bot 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T10:18:43.390

我之前使用的一种技术类似于@SiGanteng 建议的技术，但您可以更改现有字段的名称属性，而不是添加新字段，以删除或添加前缀。

```
<script>
var inputs = document.getElementById('myform').getElementsByTagname('input');
for(i=0; i<inputs.length; i++) {
    inputs[i].name = "antispam_" + inputs[i].name;
}
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T10:00:00.693

例如，您可以在服务器上添加一个新资源，该资源会生成一个密钥并将其存储在数据库中。加载网页时，您从服务器请求新密钥并将其插入`hidden`表单字段。

然后，当发出请求时，检查该字段的值并查看数据库中是否有相应的键。如果不是，则丢弃该请求。

当然，机器人仍然有可能绕过它（通过请求密钥），但这会更难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T14:33:32.450

另一种方法是使用简单的检查，获取两个文本输入并将它们连接起来，制作一个 md5 并通过 POST 发送。在另一台服务器上检查这个和瞧。

# class - 如何在 Visual C++ 2008 Managed 中创建具有一个或多个函数的类模块

> ID：12003570
> 
> 赞同：1
> 
> 时间：2012-08-17T09:54:38.707
> 
> 标签：class, function, visual-c++, clr, managed

我是 Visual C++ 的绝对新手，因此我不得不问你，如何在我的托管 C++ 项目（Visual Studio 2008）中创建一个具有一个或多个函数的托管类模块（新类）？例如，如果按下按钮，我将如何调用该类的方法。我无法理解关于它的非常复杂的教程，并且大多数教程都提到了非托管代码或旧版本的 Visual Studio。我自己的尝试完全失败了，只产生了错误，因为我没有找到关于如何将新类文件添加到我的 Visual C++ 托管项目的正确选项。如果我选择一个新的“CLR 组件类”，我会收到一条警告消息，告诉我有关组件填充我屏幕右窗格的信息。如果我选择一个新的“CLR Windows Form Class”，它什么也不会发生，没有扩展名为“.class”的文件 将被添加，或者我不知道新添加的文件。我只需要一个非常基本的类文件，其中包含一个公共函数，我可以从项目的任何位置调用它。

我已经有一个非常大的 main() cpp 文件（main.cpp），里面有很多功能。大约有一千个或更多的功能，因此很难搜索或滚动。现在我想将这 1000 个函数中的一些放在我当前项目中的第二个 cpp 文件中（在 Visual Basic 6 中，它在 CSharp 中被简单地称为“新模块”，它被称为“新类文件”）。问题是，例如，一旦我将它们从 main.cpp 移到 module1.cpp 中，我就无法在 Visual C++ 中调用这些函数。

这就是我不想要的：

*   一个DLL
*   第二个项目
*   添加对某物的引用（在项目/引用中）
*   双重声明

我知道有一种方法可以只创建一个简单的类，然后创建这个类的一个新对象来使用它的方法。这就是我想要的。Google 中的示例对我不起作用，因为它们适用于早期版本的 Visual Studio，并且与我的版本不兼容。从这个例子中我知道我想要什么，但我没有在 Visual Studio 2008 中实现它的知识。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T05:40:32.653

我将再次尝试发布有关如何将类文件添加到 VS2008 WinForm 项目的分步说明。**在完成列表之前，我再次没有意识到编号项目在这里并不总是干净利落。我能够修复除一个数字之外的所有数字，所以这应该很好 - David W**

1.  这些步骤假设在 VS2008 中启动一个简单的项目，包括一个带有默认表单和一个按钮控件的 WinForms 应用程序，如下所示： ![演示项目的起点。](../Images/9a12451beed1f94d1c19bf9f820d4bfc.png)
2.  要向该项目添加新类，请右键单击“DemoWinFormApp”，选择“添加”，然后选择“类...”，如下所示： ![添加班级](../Images/e4e33e40277d1fa3907991f1156cc5a6.png)
3.  在“添加类”对话框的“名称”字段中为类命名，DemoNewClass，然后单击“添加”按钮： ![添加新的类名](../Images/733b60c4362b728e1fd620556b8995e3.png)
4.  Visual Studio 将向您的项目添加两个文件：DemoNewClass.h（用于定义的头文件）和 DemoNewClass.cpp（用于头中定义的函数的实际 C++ 实现）。添加后，Visual Studio 编辑器会激活头文件，但会显示以下内容： ![添加头文件后的编辑器消息](../Images/b918aa3bdabe2651c1005d53962aac56.png) 单击“单击此处切换到代码视图”链接以打开源代码编辑器。
5.  编辑器现在显示 DemoNewClass.h 头文件的源代码。该文件包括来自主应用程序 DemoWinFormApp 的命名空间的自动声明，并且还包含“public:”区域中的两个默认构造函数，我们将不涉及它们。我们将在第二个构造函数定义之后立即向 DemoNewClass 添加一个新的公共静态方法。

6.  我们将添加一个*静态*方法——一个不需要实例化宿主类的方法——在字符串周围加上星号。该方法将被称为“装饰字符串”

7.  在第二个构造函数之后，添加如下所示的声明并以蓝色突出显示： ![新函数声明](../Images/5f3fd4086a42d6f230dee612f3011472.png)

8.  有了声明，我们现在必须添加实现。在解决方案资源管理器中，双击“DemoNewClass.cpp”以编辑文件： ![编辑实现文件](../Images/7f17cd8aae791d0887ee577da62f61b2.png)

9.  编辑器窗口打开，文件只有两行 - 两个*包含*指令指示编译器将引用的文件作为当前源的一部分引入。DemoNewClass.h 中提供的声明是默认提供的。

10.  将 DecorateString 方法的实现添加到 .cpp 文件中，如下所示： ![在此处输入图像描述](../Images/6036f7c741591c1d63403fc3f944e893.png) 这样就完成了新类的定义、DecorateString 声明以及为 DecorateString 方法提供实现。现在剩下的就是允许 WinForms 应用程序从主窗体引用类和方法。

11.  在解决方案资源管理器中，双击 DemoWinFormApp 项目的“头文件”列表中的“Form1.h”文件，在编辑器中打开 Form1。（按钮已经添加，添加按钮的步骤留给读者）： ![在此处输入图像描述](../Images/02b1459e4f3c2eef73c241f134479f49.png)

12.  为了演示新的类方法，我们将单击按钮显示一个由我们的 DecorateString 方法通过 MessageBox 类修改的字符串。首先，我们必须通过向 Form1.h 头文件顶部的新类的头提供一个包含指令来使表单知道我们的新类。右键单击设计器中的表单，然后单击“查看代码..”以调出源代码编辑器 ![在此处输入图像描述](../Images/76621c809f07fb4ba1d62c5f89560e06.png)

13.  为了使类及其方法可用于表单，我们必须在 Form1.cpp 实现源文件的顶部附近为类的头文件 DemoNewClass.h 提供*包含指令：*![包含指令](../Images/a4344472fdb79e3fbba99cc4e1962722.png)

14.  在解决方案资源管理器中，双击“Form1.h”以使用 Form1 打开表单设计器。或者，如果文件仍然在编辑器中打开，您可以通过单击标记为“Form1.h [Design]”的编辑器选项卡打开设计器

15.  我们将从绑定到表单上的“button1”按钮的事件处理程序中调用我们的新类方法。Visual Studio 通过在设计器中双击“button1”来提供默认处理程序： ![按钮单击处理程序](../Images/a962d2f9fbdc21c81ddbfd094497ec01.png)

16.  键入代码以调用 MessageBox::Show 方法，将由 DemoNewClass::DecorateString 方法修改的字符串作为参数传递，如下所示 - 注意 Intellisense 是如何一路感知我们的新类的： ![在此处输入图像描述](../Images/968afe01d2d94c976a462a2b577cc2c6.png)
17.  这是完成的事件处理程序/类方法调用： ![完整的方法调用](../Images/bba71894d30e476e613ebe05abae96bf.png)
18.  从 Visual Studio 的“构建”菜单中，选择“构建解决方案”（或按 F6）。这将编译解决方案并显示可能已检测到的任何语法错误。所提供的示例可以干净地编译和构建。

![构建解决方案...](../Images/c1f0ca87f30c1603ad5942adea627047.png)

![在此处输入图像描述](../Images/44e2566ab700e4729d604471a4768aeb.png) 20\. 构建成功后，剩下的就是测试应用程序。按 F5 运行应用程序并显示测试表单：

![在此处输入图像描述](../Images/785e753ec4398fdc0d7a8c27b012f5f9.png)

21.  单击“button1”运行处理程序，并查看修饰字符串：

![在此处输入图像描述](../Images/7e6045d2462eb02f49530723575da8e7.png)

传递的参数“foo”成功传递给新类的DecorateString方法，并返回给MessageBox方法显示。新的类方法声明和表单引用现已完成。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T18:45:19.330

**注意：为了确保代码块和编号步骤的格式正确，我与 MarkDown 编辑器进行了相当大的角力，但由于某种原因，一些元素仍然存在潜在的错误。我将尝试在以后的帖子中修复。目前，我选择至少以某种形式为您发布所要求的信息。

使用 Visual Studio 2008 作为基准工具，请执行以下步骤：

1.  选择“文件->新建项目”
2.  从“新建项目”对话框的“项目类型”列表中，在“其他语言”下的“Visual C++”下，单击“CLR”。
3.  从“Visual Studio 已安装模板”列表中，单击“类库”
4.  在“新建项目”对话框下半部分的名称框中，为您的项目提供一个名称。例如，使用“SampleCPPAssembly”
5.  Visual Studio 2008 将创建一个“shell”类和命名以匹配项目的头文件，例如 SampleCPPAssembly.h 和 SampleCPPAssembly.cpp
6.  打开“SampleCPPAssembly.h”
7.  将类的名称更改为“public ref class SampleClass”
8.  在打开的花括号内，添加一个文本行，上面写着“public:”。这定义了包含类的公共方法的部分。
9.  在“public:”声明下，插入以下内容：

```
   static String ^ DecorateString(String ^ foo); 

```

*   10\. 保存文件。11\. 通过在解决方案资源管理器中双击打开“SampleCPPAssembly.cpp”。
12\. 在“命名空间 SampleCPPAssembly”之后的花括号内，插入以下内容：

```
    String ^ SampleClass::DecorateString(String ^ foo){
        return gcnew String("*"+foo+"*");
    } 

```

*   13\. 保存文件。14\. 从构建菜单中，选择“构建解决方案”。
15\. 如果项目确实构建成功，请重新检查步骤 1-12 是否有任何可能的错误。

这样就完成了 C++ CLR 程序集的构建。我们现在努力创建一个简单的控制台应用程序来练习该方法。

1.  在同一解决方案的“解决方案资源管理器”中，右键单击，然后选择“添加->新建项目”
2.  在“其他语言”条目下的“Visual C++”下的“添加新项目”对话框中，选择“CLR”
3.  从“Visual Studio 安装的模板”中选择“CLR 控制台应用程序”。
4.  在“添加新项目”对话框底部附近的“名称”框中，键入“ConsumeSampleAssembly”
5.  单击确定。
6.  在“解决方案资源管理器”中，右键单击“ConsumeSampleAssembly”项目，然后选择“属性”。
7.  在“属性页”对话框中，单击“通用属性”标题下方的“框架和引用”条目。
8.  在对话框中间，单击“添加新引用...”按钮。
9.  从“添加引用”对话框中，单击以选择“项目”选项卡。
10.  从项目列表中，单击以选择“SampleCPPAssembly”
11.  单击“确定”关闭“添加引用”对话框。
12.  单击“确定”关闭“属性页”对话框。
13.  在新创建的“ConsumeSampleAssembly”项目下的“Source Files”文件夹下，双击“ConsumeSampleAssembly.cpp”源文件。
14.  在“使用命名空间系统；”的正下方，添加以下行：

```
    using namespace SampleCPPAssembly; 

```

*   15\. 删除“int main(...)”后面的大括号之间的现有代码。（不要*删除*花括号。16\. 将花括号内的内容替换为以下内容：

```
   Console::WriteLine(SampleClass::DecorateString(L"Hello"));
    return 0; 

```

*   17\. 保存源文件。18\. 在编辑器中，就在左边界内，沿着包含“return 0;”的源代码行，单击以设置断点。这会导致调试器在应用程序运行时在此处停止，并允许您查看应用程序的结果。如果没有断点，应用程序将启动和完成太快而无法观察。
*   19\. 在解决方案资源管理器中，右键单击“ConsumeSampleAssembly”项目，然后选择“设置为启动项目”。19\. 按 F5 编译并运行工程。*   20\. 你应该看到一个控制台窗口，输出“ *Hello* ”。

简介：您创建了一个包含单个方法 DecorateString 的 C++ CLR 程序集，该方法接受一个字符串作为参数并返回由星号包围的字符串。然后，您创建了一个简单的 C++ CLR 控制台应用程序，添加了对新程序集的项目引用，然后从“main(..)”方法调用了 DecorateString 方法，其值为“Hello”，该方法由该方法修改以“ *Hello* ”的形式返回。这表明您的 CLR 控制台应用程序正在成功调用 C++ CLR 程序集。

希望这可以帮助！

# c# - 在 Datagridview 上过滤

> ID：12003571
> 
> 赞同：1
> 
> 时间：2012-08-17T09:54:45.823
> 
> 标签：c#, ms-access, datagridview, datagridviewcheckboxcell

我正在根据访问数据库中的复选框（是/否）进行 Datagridview 过滤。

我的代码---------------------------

```
{
    OleDbConnection baglanti = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Users\Burak YEŞİLYURT\Desktop\secret.accdb");
    OleDbCommand komutcu;
    OleDbDataAdapter adpt;
    DataSet ds;
    public Form1()
    {
        InitializeComponent();
        baglanti.Open();
        komutcu = new OleDbCommand("SELECT * FROM todo", baglanti);
        adpt = new OleDbDataAdapter(komutcu);
        ds = new DataSet();
        adpt.Fill(ds);
        dataGridView1.DataSource = ds.Tables[0];
        adpt.RowUpdated += adpt_RowUpdated;
        this.dataGridView1.Columns["id"].Visible = false;
        this.dataGridView1.Columns["zaman"].Visible = false;

        this.dataGridView1.Columns["todo"].AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill;
    }

    private void Form1_Load(object sender, EventArgs e)
    {

        baglanti.Open();
        komutcu = new OleDbCommand("SELECT * FROM todo", baglanti);
        adpt = new OleDbDataAdapter(komutcu);
        ds = new DataSet();
        adpt.Fill(ds);
        dataGridView1.DataSource = ds.Tables[0]; 

    }
    public void adpt_RowUpdated(object sender, OleDbRowUpdatedEventArgs e)
    {
        if (e.RecordsAffected == 0)
        {
            e.Row.RowError = "Tutarlılık ihlali: UpdateCommand, beklenen 1 kaydın 0 kaydını etkiledi.";

            // Hatalı satır üzerinde işlem yapılmadan es geçiliyor.
            e.Status = UpdateStatus.SkipCurrentRow;
        }
    }

    private void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)
    {
        OleDbCommandBuilder komut = new OleDbCommandBuilder(adpt);
        DataSet yeni = new DataSet();
        yeni = ds.GetChanges(DataRowState.Modified | DataRowState.Added);

        adpt.Update(yeni.Tables[0]);
    }

    private void only_cntr_CheckStateChanged(object sender, EventArgs e)
    {
        ds.Tables["todo"].DefaultView.RowFilter = "state = 'true'"; //// Error this line
    } 
```

当我调试时，我收到此错误“对象引用未设置为对象的实例。” 我在哪里失踪？任何帮助我都会很高兴。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:31:36.590

当然，您的意思是`"state = true"`或`"state =-1"`不能将布尔值设置为文本值。

# php - 未能将 PHP 更新发布到 MySQL

> ID：12003574
> 
> 赞同：0
> 
> 时间：2012-08-17T09:54:54.237
> 
> 标签：php, mysql, session, sql-update

我有一个按钮，如果我单击它，我试图到达哪里，它会根据当前登录的用户（会话）将表 users 中的列“gorg”更新为给予者。每次单击按钮时，我都会得到

```
Access denied for user 'root'@'localhost' (using password: NO) 
```

这是 php 页面的顶部（顺便说一句，我 100% 肯定我的数据库连接信息是正确的）

```
<?php
session_start();
include('src/sql_handler.php'); //this is where my DB Connection info is located
include('src/facebook_handler_core.php');
if(isset($_POST['submitgiver'])) {
    $query = "UPDATE users SET gorg='giver' WHERE email='".mysql_real_escape_string($_SESSION['email'])."'";
    $result = mysql_query($query) or die(mysql_error());

}

{
  if(isset($_SESSION['gorg'])=="Giver")
  {
    header('Location: picktreetype.php');
  }
  else if(isset($_SESSION['gorg'])=="Gatherer")
  {
    header('Location: gatherermap.php');
  }

}

?> 
```

现在对于 html

```
<form method="post" action="<?php echo $PHP_SELF;?>">

<input type="submit" class="button orange" name="submitgiver" value="Giver">

</form> 
```

更新：

这是 SQL_HANDLER

```
<?php

class MySQL_Con {

    private $host = 'localhost',

            $user = 'fruitfo1_admin',

            $pass = 'password',

            $db = 'fruitfo1_fruitforest',

            $_CON;

    function MySQL_Con() {

        $this->_CON = mysql_connect($this->host, $this->user, $this->pass);

        if(!$this->_CON)

            die(mysql_error());

        else {

            $select_db = mysql_select_db($this->db);

            if(!$select_db)

                die('Error Connecting To Database'.mysql_error());

        }

    }

    function End_Con() {

        mysql_close($this->_CON);

    }

}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:58:52.563

显然您的连接设置不包括密码。请发布`sql_handler`（带有混淆密码）以便能够进一步调试。

如果您 100% 肯定这是正确的，正如您所说，您可以尝试将 sql 句柄显式传递给`mysql_query`.

另一个注意事项，`mysql_*`已弃用，您真的应该考虑切换到`mysqli`or 或`PDO`.

此外，将`root`用户用于任何类型的 Web 应用程序都是禁止的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:45:54.653

您的数据库没有密码。尝试这个

```
 private $host = 'localhost',

        $user = 'fruitfo1_admin',

        $pass = '',

        $db = 'fruitfo1_fruitforest',

        $_CON; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T11:09:40.050

我发现了我的问题，它确实与我认为的问题有关。这是我更新的代码

```
if(isset($_POST['submitgiver'])) {
$mysql_hostname = "localhost";
$mysql_user = "fruitfo1_admin";
$mysql_password = "password";
$mysql_database = "fruitfo1_fruitforest";
$bd = mysql_connect($mysql_hostname, $mysql_user, $mysql_password) or die("Could not connect database");
mysql_select_db($mysql_database, $bd) or die("Could not select database");
$query = "UPDATE users SET gorg='giver' WHERE email='".mysql_real_escape_string($_SESSION['email'])."'";
$result = mysql_query($query) or die(mysql_error());
} 
```

基本上，试图 POST 的 IF 语句没有链接回我的处理程序，所以我放置了来自处理程序的 SAME db 连接并将其传递到 if isset 语句中，它起作用了！

# workflow-foundation - WF 规则 - 链接索引器

> ID：12003576
> 
> 赞同：1
> 
> 时间：2012-08-17T09:55:03.947
> 
> 标签：workflow-foundation, chaining, rule, indexer

实体-属性模式用于我们的应用程序结构（即）属性以键值对表示并通过索引器访问。

计划使用工作流规则引擎来配置此结构中的规则。但是在任何地方都找不到链接机制应用程序示例。如果使用索引器属性，需要知道如何在规则中应用链接？

问候，

玛尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T11:53:04.800

因此，您可以做的是在`Priority`将规则添加到之前设置规则，`RuleSet`以便 WF 可以正确地对规则进行排序。您将需要创建自己的`RuleSet`以使这更容易，下面是您可能想要做的事情的示例。

```
public class MyRuleSet
{
    // this is the WF rule set
    private RuleSet ruleSet = new RuleSet();

    private const int maxRuleSetSize = 1000;

    public void AddRule(Rule rule)
    {
        rule.Priority = maxRuleSetSize - (this.ruleSet.Rules.Count + 1);
        this.ruleSet.Rules.Add(rule);
    }
} 
```

然后，当您准备好执行规则时，您需要`RuleSet`使用新规则来构建规则`RuleSet`，以便按照添加的顺序执行它们。

```
var ruleSet = new MyRuleSet();
ruleSet.AddRule(new Rule1());
ruleSet.AddRule(new Rule2());
... 
```

然后你需要执行那个`RuleSet`.

# c# - WCF REST 服务：允许跨域访问

> ID：12003583
> 
> 赞同：1
> 
> 时间：2012-08-17T09:55:24.903
> 
> 标签：c#, wcf, rest

我在一个天蓝色的 Web 角色中托管一个 RESTful WCF 服务。该服务将由 jQuery 使用。

如何允许跨域访问此服务？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-17T15:34:53.293

我知道这是一个老问题，但我刚刚遇到了一个类似的问题，并认为以下内容可能会帮助遇到这个问题的人。在 Visual Studio 中，添加一个名为`clientaccesspolicy.xml`Web Role 项目的新 xml 文件，其中包含以下内容：

```
<?xml version="1.0" encoding="utf-8" ?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="SOAPAction">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

要限制访问，请将 编辑`<domain uri="*"/>`为您需要的任何内容。

# android - keyboard disappears while orientation change to landscape mode

> ID：12003584
> 
> 赞同：0
> 
> 时间：2012-08-17T09:55:26.507
> 
> 标签：android, android-edittext, android-softkeyboard

I am enabling orientation change in `focusChangeListener` of an `edittext` in my app.

It is working fine, but the issue is if the user flips the keyboard to landscape mode keyboard disappears.

It will come up only if user tap on `edittext` again or change orientation to portrait mode.

I need to display keyboard in landscape mode without touching the `edittext`.

Please help me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:26:53.930

Generally, its a bad idea to mess with the default IME behavior because there are devices out there with hardware keyboards.

Now, that you have been warned, listen for the orientation change and if the keyboard was visible before the change and there is no hardware keyboard on the device, show the keyboard manually.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T11:04:59.180

Try using `android:configChanges="orientation"` into your manifest class.

```
 <activity
        android:name=".classname"
        android:configChanges="keyboardHidden|orientation"

         > 
```

if works then accept it.

# html - 我们可以使用 wxWidget 将网页保存到磁盘上吗

> ID：12003588
> 
> 赞同：0
> 
> 时间：2012-08-17T09:55:51.190
> 
> 标签：html, download, wxwidgets

我正在使用带有系统调用（c ++）的wget将网页从互联网保存到程序中的HD。现在我想使用 wxWidget 来做同样的事情。无论如何我可以做到这一点并且仍然具有 wget 的通用行为吗？（即我给一个pdf文件的链接n然后保存一个pdf文件）

我找到了这个链接[http://wiki.wxwidgets.org/Download_a_file_from_internet](http://wiki.wxwidgets.org/Download_a_file_from_internet)

但我不知道如何根据输入的 url 将 wxString 转换为 pdf/mp3 文件。

任何人都可以帮忙吗？第一次做开源项目，刚刚遇到这个wxWidget

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T13:14:12.993

如果您对使用带有系统调用的 wget 感到满意，那么为什么不继续这样做呢？

wxWidgets 是一个 GUI 框架，包含许多额外的便利功能。你不必使用它们。您仍然可以使用您熟悉的任何 C++ 功能、实用程序和包。

这是[Windows 版 Wget的链接](http://gnuwin32.sourceforge.net/packages/wget.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:32:13.293

您可以使用[wxHTTP](http://docs.wxwidgets.org/2.9.4/classwx_h_t_t_p.html)（如此处所述[）](http://forums.wxwidgets.org/viewtopic.php?p=122403&sid=4b5a179d47c78ebd0be224c4f0f3c8fa#p122403)或使用 wxURL 和[GetInputStream()](http://docs.wxwidgets.org/2.9.4/classwx_u_r_l.html#a6974f1d2c13a6ef721e2b93c84e5e376)

# mongodb - Symfony 2 DoctrineMongoDBBundle 生成奇怪的查询

> ID：12003591
> 
> 赞同：1
> 
> 时间：2012-08-17T09:56:15.897
> 
> 标签：mongodb, symfony, doctrine-odm

我正在使用 DoctrineMongoDBBundle 并想要获取一些记录。在我的存储库类中，我有代码：

```
return $this->createQueryBuilder()->field('categories.data')
    ->equals($categoryId)->getQuery()->execute(); 
```

在探查器的日志中，它生成绝对有效的查询：

```
db.recipe.find({ "categories.data": 16 }).sort([ ]); 
```

当我通过控制台客户端运行此查询时，它会返回记录。**但是存储库类什么都没有。**

我的服务器日志如下所示：

```
query test_database.recipe query: { $query: { categories.data: "2" }, $orderby: {} } ntoreturn:0 keyUpdates:0 nreturned:0 reslen:20 0ms 
```

但是如果我运行普通的 PHP 脚本来获取相同的数据：

```
<?php 
$mongo = new Mongo();
$col = $mongo->test_database->recipe;

foreach ($col->find(array("categories.data" => 2)) as $r) {
  print_r($r);
} 
```

我得到了结果，服务器的日志如下所示：

```
query test_database.recipe query: { categories.data: 2 } ntoreturn:0 keyUpdates:0 nreturned:1 reslen:1037 0ms 
```

所以区别是：

> 查询 test_database.recipe 查询：{ **$query:** { categories.data: "2" }, **$orderby** : {} } ntoreturn:0 keyUpdates:0 nreturned:0 **reslen** :20 0ms
> 
> 查询 test_database.recipe 查询：{ categories.data: 2 } ntoreturn:0 keyUpdates:0 nreturned **:1** reslen:1037 0ms[/quote]

检查了 MongoDB 2.1.1 和 1.8.1，**deps**文件：

```
[symfony]
    git=http://github.com/symfony/symfony.git
    version=origin/2.0

[doctrine-common]
    git=http://github.com/doctrine/common.git
    version=2.2.2

[doctrine-dbal]
    git=http://github.com/doctrine/dbal.git
    version=2.1.7

[doctrine]
    git=http://github.com/doctrine/doctrine2.git
    version=2.1.7

[doctrine-mongodb-odm]
    git=http://github.com/doctrine/mongodb-odm.git

[DoctrineMongoDBBundle]
    git=http://github.com/doctrine/DoctrineMongoDBBundle.git
    target=/bundles/Symfony/Bundle/DoctrineMongoDBBundle
    version=origin/2.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T15:54:56.873

根据您共享的此日志：

> 查询 test_database.recipe 查询：{ $query: { categories.data: "2" }, $orderby: {} } ntoreturn:0 keyUpdates:0 nreturned:0 reslen:20 0ms
> 
> 查询 test_database.recipe 查询：{ categories.data：2 } ntoreturn：0 keyUpdates：0 nreturned：1 reslen：1037 0ms

您`"2"`在第一个查询中匹配字符串，但在第二个查询中匹配整数`2`。这些在 MongoDB 中是不等价的。考虑：

```
$ mongo
MongoDB shell version: 2.0.7
connecting to: test
> db.foo.drop()
false
> db.foo.insert({x:1})
> db.foo.find({x:"1"})
> db.foo.find({x:1})
{ "_id" : ObjectId("502fb9f5b6b1fd9f6ea794a4"), "x" : 1 } 
```

在查询生成器中使用它之前，您是否尝试过强制转换`$categoryId`为整数？

# php - 在 codeigniter 网站的任何地方显示一个模块

> ID：12003600
> 
> 赞同：0
> 
> 时间：2012-08-17T09:56:53.750
> 
> 标签：php, codeigniter

我对 codeigniter 非常陌生，并且在音频购物车网站上工作。

我在我的项目中实现了一个音频播放列表，并创建了一个名为 **playlist**的不同模块。[为页面播放列表](http://webcartz.stagetesting.com/playlist)创建了路线，一切正常。我使用了 HMVC codeigniter，因此每个模块都有不同的文件夹。

我的播放列表基本上是一个歌曲列表，用户可以选择和播放任何歌曲。

```
 Modules-
    ---Playlist
       --Controllers
         --playlist.php (my front controller)           
       --Models 
         --playlistmodel.php (model)  
       --Views
         index.php (view for showing playlist) 
```

现在根据新的规范，这个播放列表可以放在网站的任何地方。它应该工作。我不知道这怎么可行？我应该创建助手吗？

请帮忙 。

直播网址：[http ://webcartz.stagetesting.com/playlist](http://webcartz.stagetesting.com/playlist)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:58:47.650

看到这个网址：--

[如何使用 CodeIgniter 在 HMVC 上的模块文件夹外加载模块？](https://stackoverflow.com/questions/11256372/how-to-load-a-module-outside-modules-folder-on-hmvc-with-codeigniter)

那么你也可以这样做

```
<?php echo Modules::run('../bar/bar/index'); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T11:09:07.870

也许你应该创建一个库

> 当我们使用术语“库”时，我们通常指的是位于库目录中并在本用户指南的类参考中描述的类。但是，在这种情况下，我们将改为描述如何在 application/libraries 目录中创建自己的库，以保持本地资源和全局框架资源之间的分离。
> 
> 作为一个额外的好处，如果您只需要向现有库添加一些功能，CodeIgniter 允许您的库扩展本机类。或者你甚至可以通过在你的应用程序/库文件夹中放置相同名称的版本来替换本机库。

[http://codeigniter.com/user_guide/general/creating_libraries.html](http://codeigniter.com/user_guide/general/creating_libraries.html)

像这样的东西

```
class Playlistlib {

public function __construct($params)
{
    $CI =& get_instance(); // so you'd use $CI instead of $this to ref to CI object
    // Do something with $params
}

public function get_playlist($params)
{
    // Do something with $params
}

}

$params = array('id' => 15, 'limit' => 5);

$this->load->library('Playlistlib', $params); 
```

# eclipse - Eclipse SWT 浏览器和 Firebug lite？

> ID：12003602
> 
> 赞同：4
> 
> 时间：2012-08-17T09:56:59.060
> 
> 标签：eclipse, debugging, swt

有没有办法在 Eclipse SWT 浏览器中使用 Firebug lite“书签”功能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T13:27:33.577

取决于您的 SWT 浏览器使用的系统浏览器。对于 Win7 和 IE8，你可以有这样的东西：

## 输出

![在此处输入图像描述](../Images/0d6de7c9f6eea5da4ace0db3f568f5b6.png)

## 代码

```
import org.eclipse.swt.SWT;
import org.eclipse.swt.browser.Browser;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

public class FirebugLite 
{
    public static void main(String[] args) {
        new FirebugLite().start();
    }

    public void start()
    {
        Display display = new Display();
        Shell shell = new Shell(display);
        shell.setLayout(new GridLayout(1, false));
        GridData gridData = new GridData(SWT.FILL, SWT.FILL, true, true);
        gridData.widthHint = SWT.DEFAULT;
        gridData.heightHint = SWT.DEFAULT;
        shell.setLayoutData(gridData);
        shell.setText("Firebug Lite for SWT ;)");

        final Browser browser = new Browser(shell, SWT.NONE);
        GridData gridData2 = new GridData(SWT.FILL, SWT.FILL, true, true);
        gridData2.widthHint = SWT.DEFAULT;
        gridData2.heightHint = SWT.DEFAULT;
        browser.setLayoutData(gridData2);

        Button button = new Button(shell, SWT.PUSH);
        button.setLayoutData(new GridData(SWT.CENTER, SWT.CENTER, false,    false));
        button.setText("Install");
        button.addSelectionListener(new SelectionAdapter() {
            public void widgetSelected(SelectionEvent e) {
                browser.setUrl("javascript:(function(F,i,r,e,b,u,g,L,I,T,E){if(F.getElementById(b))return;E=F[i+'NS']&&F.documentElement.namespaceURI;E=E?F[i+'NS'](E,'script'):F[i]('script');E[r]('id',b);E[r]('src',I+g+T);E[r](b,u);(F[e]('head')[0]||F[e]('body')[0]).appendChild(E);E=new%20Image;E[r]('src',I+L);})(document,'createElement','setAttribute','getElementsByTagName','FirebugLite','4','firebug-lite.js','releases/lite/latest/skin/xp/sprite.png','https://getfirebug.com/','#startOpened');");
            }
        });

        browser.setUrl("http://stackoverflow.com/questions/12003602/eclipse-swt-browser-and-firebug-lite");

        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
        display.dispose();
    }
} 
```

***`Note >>`***我已经使用了`setUrl()`API。你可以试试，`execute()`但我不确定它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T12:36:11.867

我无法在 Linux 上运行。出现异常网页：“无法显示 URL”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-29T10:22:44.573

我稍微调整了 Favonius 的解决方案。在我的例子中，我们希望看到 iframe 内部。我修改了 setUrl 以在最后一个 iframe 中加载 firebug。就我而言，它做了我们想要的。

```
browser.setUrl("javascript: function lastIframeDocument(curr){while(curr.getElementsByTagName('iframe')[0]!=null){curr=curr.getElementsByTagName('iframe')[0].contentWindow.document;}return curr;}(function(F,i,r,e,b,u,g,L,I,T,E){if(F.getElementById(b))return;E=F[i+'NS']&&F.documentElement.namespaceURI;E=E?F[i+'NS'](E,'script'):F[i]('script');E[r]('id',b);E[r]('src',I+g+T);E[r](b,u);(F[e]('head')[0]||F[e]('body')[0]).appendChild(E);E=new%20Image;E[r]('src',I+L);})(lastIframeDocument(document),'createElement','setAttribute','getElementsByTagName','FirebugLite','4','firebug-lite.js','releases/lite/latest/skin/xp/sprite.png','https://getfirebug.com/','#startOpened');"); 
```

# php - 在 PHP 页面中使用 jQuery 变量

> ID：12003605
> 
> 赞同：0
> 
> 时间：2012-08-17T09:57:02.360
> 
> 标签：php, jquery, ajax

我正在使用 jQuery Ajax 在 MySql DB 中存储一些值

到目前为止，我将 start_time 作为 datetime 对象传递，例如

```
Wed Aug 15 2012 14:00:00 GMT+0530 (IST) 
```

我在我的 php 页面上得到了这个值，比如

```
1345019400 
```

在我的数据库中，我想存储该值

```
2012-8-17 20:45 
```

所以 $_POST['start_time'] 这个值看起来像一个整数（我不确定）

我的问题是如何处理该整数值，以便它可以存储在我的数据库中

```
2012-8-17 20:45 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T09:59:43.593

“整数”是时间戳！使用 PHP [DateTime::format](http://www.php.net/manual/en/datetime.format.php)函数对其进行格式化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:00:03.320

你得到时间戳，所以你必须使用`date`函数对其进行转换：

```
<?php
    $date = date('YYYY-mm-dd hh:ii', $_POST['start_time']);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:00:51.130

这是一个时间戳。看看 PHP 日期函数来格式化它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T10:01:14.203

```
$bla=1345019400;

$date=date('Y-m-d H:i',$bla);
echo $date; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T10:01:25.793

您的 php 需要在插入之前将其格式化为 mysql 日期格式（假设您的列上的数据类型是 DATETIME）

查看 php 处理日期的方式。

此外，如果您在日期转换时遇到问题，请将其全部转换为 javascript 和 php 之间的 Epoch 字符串，然后在插入之前将其转换。

让我知道这是否有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-17T10:08:15.700

```
date("M-d-Y g:i", $date); 
```

阅读函数 date() 的文档

# c++ - SPOJ PRIME1 : TLE

> ID：12003616
> 
> 赞同：2
> 
> 时间：2012-08-17T09:58:02.923
> 
> 标签：c++, algorithm, primes, sieve-of-eratosthenes, sieve

我尝试为此[问题]实现分段筛算法：http://www.spoj.pl/problems/PRIME1/，如下所示：

```
#include <iostream>
#include <string>
#include <set>
#include<math.h>
#include<vector>
#include<cstdlib>
#include<cstdio>
#include<cstring>
#include<cstdio>
#define MAX 32000 // sqrt of the upper range
using namespace std;
int base[MAX];  // 0 indicates prime

vector<int> pv;   // vector of primes

int mod (int a, int b)
{
   if(b < 0)
     return mod(-a, -b);   
   int ret = a % b;
   if(ret < 0)
     ret+=b;
   return ret;
}
void sieve(){

     for(int i = 2 ; i * i < MAX ; i++ )
        if(!base[i])
           for(int j = i * i ; j <  MAX ; j += i )
                 base[j] = 1;

     for(int i = 2 ; i < MAX ; i++ )
         if(!base[i]) pv.push_back(i);

}
int fd_p(int p ,int a ,int b){  // find the first number in the range [a,b] which is divisible by prime p

/*  while(1){

        if(a % p == 0 && a !=p) break;
    a++;
    }
    return a;
*/  

    if(a != p){
        return (a + mod(-a,p)) ;

    }
    else{
     return (a + p);
    }

}
void seg_sieve(int a , int b){

    if(b < 2 ){ 
        cout << "" ;
    return;
    }
    if(a < 2){
      a = 2; 
    }
    int i,j;
    int seg_size  = b - a + 1;
    int*is_prime = new int[seg_size];
    memset(is_prime,0,seg_size*sizeof(int));

    vector<int> :: iterator p ;

    for(p = pv.begin(); p!=pv.end(); p++){
       int x = fd_p(*p,a,b);  

       for(i = x; i <= b; i += *p )
           is_prime[i - a] = 1;
      }

for(i=0; i < b - a + 1; i++)
    if(!is_prime[i])
        printf("%u\n", i + a);

 delete []is_prime ;
}

int main()
{
     sieve();
     int a,b,T;
     scanf("%d",&T);

     while(T--){
     scanf("%d%d",&a,&b);
     seg_sieve(a,b);
     printf("\n");   
     }
//     cout<<endl;
//     system("PAUSE");
     return 0;
} 
```

尽管如此，我还是得到了 TLE .. 我不明白还需要什么其他优化。请帮助..

编辑1：只是试图在恒定时间内实现 fd_p() ... [失败] .. plz 如果你能帮助我解决这个错误..

编辑 2：问题已解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T11:36:54.413

您可以获得区间 [a,b] 中的第一个数字，该数字在恒定时间内可被 p 整除。尝试这样做，我认为你应该很高兴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T13:07:27.993

多年前我已经解决了这个问题。假设 nm <= 100000 你只需要计算 1 和 sqrt(1000000000) < 40000 之间的所有素数。然后手动测试 n 和 m 之间的每个数字。这会很好

```
 program prime1;
  Var
   t:longint;
   m,n:longint;
   i,j,k:longint;
   prime:array of longint;
   bool:boolean;
begin
 SetLength(prime,1);
 prime[0]:=2;
 for i:=3 to 40000
  do begin
   j:=0; bool:=true;
   while (prime[j]*prime[j]<= i ) do begin
     if (i mod prime[j] = 0) then begin
      bool:=false;
      break;
     end;
     inc(j);
   end;
   if (bool) then begin
    SetLength(prime,length(prime)+1);
    prime[length(prime)-1]:=i;
   end;
 end;
 readln(t);
 for k:=1 to t do begin
  readln(m,n);
  for i:=m to n do begin
   if (i=1) then continue;
   j:=0; bool:=true;
   while (prime[j]*prime[j]<= i ) do begin
     if (i mod prime[j] = 0) then begin
      bool:=false;
      break;
     end;
     inc(j);
   end;
   if (bool) then
     writeln(i);
  end;
  writeln;
 end;
end. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T17:58:56.773

您已经完成了最后一步的改进。*只处理赔率。*

我们知道这`2`是素数，而且我们知道没有偶数（除了 2）是素数。所以没有必要检查它们。

奇数素数的埃拉托色尼筛是**P** = {3,5, ...} \ **U** {{ *p ²* , *p ² + 2p* , ...} | p 中的**p** }。实施这将足以让你通过：

*   特别对待`2`，作为一个单独的案例。使用正常大小一半的数组，其中 offset 处的数组条目`i`表示一个奇数值`ao + 2*i`，其中`ao = a|1`不低于 的最小奇数`a`。这意味着***2p***的增量值对应于数组中偏移量中***p的增量。***
*   `p`如果，则偏移筛阵列中等于或大于的素数的起始奇数倍`p*p`是。筛阵列中对应的偏移量为。`m = p*p >= ao ? p*p : ((ao+p-1)/p)*p; m = m&1 ? m : m+p;``p <= sqrt_b``(m-ao)/2`

作为旁注，您的命名令人困惑：`is_prime`实际上是`is_composite`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T19:07:05.420

问题是你的 fd_p 函数太慢了，增加 a 直到你找到一个好的值来启动你的筛子肯定会超时，因为 a 可以在 10 亿的范围内。

你有正确的想法。

有关工作代码的更易于理解的解释，请参阅此博客文章：

[http://www.swageroo.com/wordpress/spoj-problem-2-prime-generator-prime1/](http://www.swageroo.com/wordpress/spoj-problem-2-prime-generator-prime1/)

# visual-studio - 本地数据库 VS 2010 Windows Phone

> ID：12003617
> 
> 赞同：-2
> 
> 时间：2012-08-17T09:58:06.260
> 
> 标签：visual-studio, windows-phone-7

如何在 Visual Studio 2010 for Windows Phone 中创建本地数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:05:43.927

网上有很多关于如何做到这一点的链接。他们之中有一些是：

[Windows Phone 的本地数据库概述](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202860%28v=vs.92%29.aspx)

[如何：为 Windows Phone 创建基本的本地数据库应用程序](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202876%28v=vs.92%29.aspx)

[WindowsPhoneGeek 上的 Windows Phone Mango Local Database(SQL CE) 教程](http://windowsphonegeek.com/tips/Windows-Phone-Mango-Local-Database%28SQL-CE%29-Introduction)

# jquery - 使用容器移动 jquery div

> ID：12003620
> 
> 赞同：1
> 
> 时间：2012-08-17T09:58:19.960
> 
> 标签：jquery, html, css

当我在做一个游戏项目时，我遇到了 jquery 滑块面板的小问题。当滑块位于游戏容器 div 上方时。因为我不想这样。意味着当我单击打开滑块按钮时，它应该将整个 div 移到它下面。表示滑块面板 div 位于另一个容器 div 上。任何人都可以建议我。请参阅此链接以更好地理解问题。[http://www.toonkaboom.com/](http://www.toonkaboom.com/)（请单击顶部滑块面板查看问题。）

问候， phphunger。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:09:33.737

这是因为您的#toppanel 滑块元素是绝对定位的，它不会影响其他元素，因为它不是流程的一部分。

用内联样式包装它的 div 的原因是什么？如果可能，摆脱它并删除 position: absolute; #toppanel 上的 CSS 的属性。

这将执行您的操作，但是它现在会在您滑动之前影响其下方的那些元素，因此您可能希望为下一个 div 赋予负的 margin-top 值以将其移回之前的位置。

# ruby-on-rails - 如何在 Rails 中为 has_many - has_and_belongs_to_many 关系创建评级系统

> ID：12003623
> 
> 赞同：0
> 
> 时间：2012-08-17T09:58:40.747
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, has-and-belongs-to-many, rating-system

我有一个应用程序，其中：

`User has_many Openings`

`Opening belongs to User & has_and_belongs_to_many Categories`

`Category has_and_belongs_to_many Openings`

我正在尝试创建一个评分系统，在该系统中，用户对每个类别的每个开口进行评分，并且正在努力查看我在哪里需要哪些关系。有人可以帮我指出正确的方向吗？

基本上我希望评级属于 opening_category 关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:04:14.870

而不是使用 has_and_belongs_to_many 关联，你想要 has_many through 关系

因此，您创建了一个新模型

```
class OpeningCategory
  belongs_to :opening
  belongs_to :category
end 
```

然后你可以使用Opening has_many :categories, :through => :opening_categories 和Category has_many :openings, :through => :opening_categories。

您的评分可以使用 OpeningCategory 完成，无论是平均评分列，还是 :belongs_to :opening_categories 的单独评分模型。

# perl - 将图标添加到 Perl/GTK 应用程序

> ID：12003624
> 
> 赞同：0
> 
> 时间：2012-08-17T09:58:42.347
> 
> 标签：perl, gtk, icons

我用 perl/Gtk 写了一个小应用程序，现在我想给它添加一个图标。我有一个 jpg 文件。该应用程序非常基本，当然使用 Gtk2::Window 对象。

我被认为使用[Image::Base::Gtk2::Gdk::Pixbuf](https://metacpan.org/module/Image%3a%3aBase%3a%3aGtk2%3a%3aGdk%3a%3aPixbuf)但 Gtk2::Window->set_default_icon 只想要一个 Gtk2::Gdk::Pixbuf 对象，我还没有设法创建一个（如果有人可以给我看看）。我在使用 perl-5.14.2 的 debian 上。

多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T12:43:07.790

哦，明白了！

```
use Image::Base::Gtk2::Gdk::Pixbuf;
my $navIco = Gtk2::Gdk::Pixbuf->new_from_file("./mltwb.png");  `   
$window->set_default_icon($navIco);` 
```

只需要阅读文档。谢谢各位！

# c# - 我在 C# 中使用流式阅读器时遇到问题

> ID：12003633
> 
> 赞同：0
> 
> 时间：2012-08-17T09:59:25.437
> 
> 标签：c#

我在使用流式阅读器时遇到了一点麻烦。

我正在从文件对话框打开电子邮件，这些电子邮件被放置在列表框中。电子邮件中的每个字母都在一行中，如下图所示。

我希望电子邮件在一条线上，有人可以帮助我吗，这让我很头疼。

```
private void button2_Click(object sender, EventArgs e)
{
    OpenFileDialog ofg = new OpenFileDialog();
    ofg.Filter = "Text Files|*.txt";
    if (ofg.ShowDialog() == System.Windows.Forms.DialogResult.OK)
    {
        var fileName = ofg.FileName;

        StreamReader sr = new StreamReader(File.OpenRead(fileName));
        var line = sr.ReadToEnd();        

        foreach (var l in line)
            listBox1.Items.Add(l.ToString());

        sr.Dispose();
    }
} 
```

![这里的例子](../Images/2dfe371022200ddf332937d08c1af893.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:03:11.137

```
 var lines = File.ReadAllLines( fileName );

        foreach (var l in lines )
        {
            listBox1.Items.Add( l );
        } 
```

假设你有

```
 email1@email1.com
        email2@email2.com 
```

在您的文件中（这是我从您的描述中了解到的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:04:12.597

用这个：

```
string line;
while((line = reader.ReadLine()) != null)
    listBox1.Items.Add(line); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:05:16.400

使用它如下：

> ```
> using (StreamReader sr = new StreamReader(File.OpenRead(fileName)))
> {
>       string line;
> 
>       while ((line = sr.ReadLine()) != null) 
>       {
>           listBox1.Items.Add(line.ToString()); 
>       }
> } 
> ```

这会读取文件中的所有行并将其逐行添加到列表框中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T10:05:41.880

字符串包含字符，因此在行`foreach (var l ...)`中遍历字符。你应该用你的 foreach 替换

```
foreach( var email in line.Split(' ')) 
```

如果您的电子邮件用空格分隔。另一种方法是文件。[ReadAllLines](http://www.google.ru/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CFMQFjAA&url=http://msdn.microsoft.com/ru-ru/library/system.io.file.readalllines.aspx&ei=VRcuUN2wIYTmtQbLvoHIBw&usg=AFQjCNHa9hxf4WoDNnX9lbiQMF8NIPioqQ&sig2=nRc_yYv19n3Lv8BI-Dr0eQ&cad=rjt)，以防您文件中的电子邮件位于不同的行...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T10:07:03.257

```
using (StreamReader sr = new StreamReader(File.OpenRead(fileName))) 
{
   while (sr.Peek() >= 0) 
   {
      listBox1.Items.Add(sr.ReadLine());
   }
} 
```

参考：http: [//msdn.microsoft.com/en-us/library/system.io.streamreader.readline](http://msdn.microsoft.com/en-us/library/system.io.streamreader.readline)

# facebook - Facebook API 获取朋友的朋友

> ID：12003634
> 
> 赞同：0
> 
> 时间：2012-08-17T09:59:31.607
> 
> 标签：facebook, facebook-graph-api

美好的一天，我们正在构建一个需要用户朋友朋友信息的应用程序。例如：John 登录应用，他有 100 个朋友，这 100 个朋友每个也有 100 个朋友，等于 10,000 人，应用程序需要获取这 10,000 人的头像和基本信息等信息。我们知道这在 Facebook 的旧 API 中是可能的，现在发生了什么？如果当前的 API 没有这个功能，我们是否可以只为我们的服务器获得对这个特定功能的独占访问权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T14:23:56.753

不，您只能访问有关您的应用程序用户及其朋友的（非公开）数据（取决于他们的隐私设置） - 没有授予访问朋友的朋友或其私人数据的权限。

# sql - 删除 VS DB 部署脚本对服务器名称的依赖

> ID：12003635
> 
> 赞同：2
> 
> 时间：2012-08-17T09:59:41.223
> 
> 标签：sql, visual-studio, deployment, dbproj

当我将 dbproj 部署到 SQL 脚本并尝试在另一台计算机上运行它时，出现错误：

> 构建脚本 SOMENAME 中的服务器名称与目标服务器 ANOTHERNAME 的名称不匹配。验证您的数据库项目设置是否正确以及您的构建脚本是否是最新的。

脚本中生成了这样的行：

```
IF (@@servername != 'MYNAME')
BEGIN
    RAISERROR(N'The server name in the build script %s does not match the name of the target server %s. Verify whether your database project settings are correct and whether your build script is up to date.', 16, 127,N'MYNAME',@@servername) WITH NOWAIT
    RETURN
END 
```

有什么方法可以让 SQL 部署脚本在任何服务器上运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T09:59:41.223

我找到了一个解决方案：我只需要去`Project Properties -> Deploy -> Edit Deployment Configuration File`并取消选中`GenerateDeployStateChecks`复选框。之后，我的服务器名称的任何提及都会在部署脚本中消失。

# facebook-javascript-sdk - 从 facebook graph api 中提取数据

> ID：12003640
> 
> 赞同：1
> 
> 时间：2012-08-17T09:59:52.393
> 
> 标签：facebook-javascript-sdk, facebook-opengraph

从以下图形 api url，

```
$graphURL = "https://graph.facebook.com/me/news.reads&access_token=$access_token?" .
//"callback=''&" .
"date_format=U&" . 
"limit=5"; 
```

我得到以下格式的数组结果：

```
{"data":[{"id":"10151079746224166",
"from":{"name":"Nicholas Billionea","id":"666859165"},
"start_time":1344853875,
"end_time":1344853875,
"publish_time":1344853875,
"application":{"name":"Muzikki","namespace":"muzikki","id":"354957834546710"},
"data":{"article":{"id":"10150987952714331",
"url":"http:\/\/muzikki.com\/articles\/headlines\/mustapha-qtac-become-ambassadors-for-gui\/",
"type":"article",
"title":"Mustapha, Q-Tac become ambassadors for Guiness campaign in kenya"}},
"type":"news.reads",
"no_feed_story":false,
"likes":{"count":0,"can_like":true,"user_likes":false},
"comments":{"count":0,"can_comment":true}}, 
```

...如何从这个 multidim 数组中提取文章标题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T10:55:06.137

将输出解析为 json。

```
$d = json_decode($data,true); // Here $data is the output returned from facebook API
print_r($d['data'][0]['data']['article']); 
```

输出将是：

```
Array
(
    [id] => 10150987952714331
    [url] => http://muzikki.com/articles/headlines/mustapha-qtac-become-ambassadors-for-gui/
    [type] => article
    [title] => Mustapha, Q-Tac become ambassadors for Guiness campaign in kenya
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T14:22:16.440

将其解析为 JSON 并像使用任何其他数组一样提取您需要的字段

# jquery - 表格单元格内具有动态内容和表格行高对齐的 Div

> ID：12003641
> 
> 赞同：2
> 
> 时间：2012-08-17T09:59:57.300
> 
> 标签：jquery, html, css

我需要将 div 放在表格单元格中。div 和单元格高度应始终根据 div 的动态内容对齐。

如果在其中插入文本，则 div 高度会增加，但其他 div 的高度保持不变： ![插入的文本](../Images/10b8ee169a4428c66c758457f3e7005d.png)

**示例：http:** [//jsfiddle.net/BWYQg/](http://jsfiddle.net/BWYQg/)

作为解决方法，我使用 js 扩展剩余 div 的高度（增加 div min-height），但如果在插入后清除内容，我会看到下图： ![删除的文本](../Images/9d0103782e9b27faf0fef19b0e4699b1.png)

**示例：http:** [//jsfiddle.net/BWYQg/1/](http://jsfiddle.net/BWYQg/1/)

所以问题是如何让 td 和 div 的高度总是根据 div 的内容对齐？

**UPD：** div 的内容应该是可编辑的 ( `<div contenteditable>`)，因此在输入文本后 div 的高度会增加。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T11:36:58.830

参见等高函数。[http://www.catswhocode.com/blog/8-awesome-jquery-tips-and-tricks](http://www.catswhocode.com/blog/8-awesome-jquery-tips-and-tricks)希望有帮助。

```
function equalHeight(group) {
    tallest = 0;
    group.each(function() {
        thisHeight = $(this).height();
        if(thisHeight > tallest) {
            tallest = thisHeight;
        }
    });
    group.height(tallest);
}

$(document).ready(function() {
    equalHeight($(".recent-article"));
    equalHeight($(".footer-col"));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:07:22.800

我可能会推荐使用 jQuery 等高类型的插件，例如这个：

您只需将相同的类添加到每个 DIV 并在调用插件时引用它。

[http://www.cssnewbie.com/download/jquery.equalheights.js](http://www.cssnewbie.com/download/jquery.equalheights.js)

因此，您需要从上面的页面下载等高 JS 文件，并在调用 jQuery 之后将其包含在您的网页中。

然后你像这样调用脚本：

```
$(document).ready(function() {

    $('.myDiv').equalHeights();

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:13:05.710

您始终可以从具有内容的元素中获取 .height() 并将其设置为动态的其他元素。例如：

```
var $tdContentHeight = $('tr td .has-content').height();
$('tr').find('td .has-no-content').each(function() { $(this).height($tdContentHeight)}) 
```

此外，您可以比较高度并始终选择最高高度并将它们分配给 tr 中的所有其他元素。

**再次更新小提琴。在这里检查：**

[http://jsfiddle.net/BWYQg/31/](http://jsfiddle.net/BWYQg/31/)

# mysql - 在单个 MySQL 语句中计算多个百分比

> ID：12003645
> 
> 赞同：1
> 
> 时间：2012-08-17T10:00:03.610
> 
> 标签：mysql, sql, mysql-error-1064

我是复杂 SQL 语句的新手，需要帮助。我已经设法显示了一半的结果集并努力剩余。

所需结果：

```
PSU |  pregnancy number| pregnancy percentage | % of live birth out of the pregnancy number.
1   |          2       |          67%         |         40%
2   |          1       |          33%         |         80% 
```

使用下面编写的 sql，我设法获得了前 3 列。

第 2 列和第 3 列需要 where 语句`fieldname = 'Q111'`。而第 4 列需要带有 where 语句的百分比`fieldname = 'Q112`。如何将不同的 where 语句组合在一起。

```
SELECT sms_psu.name1 AS PSU,
       woman_data.answertext  AS NumberOfPreg,
       Count(woman_data.answertext) / (SELECT Count(woman_data.answertext)
                                       FROM   woman_data
                                              INNER JOIN sms_household
                                                      ON woman_data.prim_key =
                                                         ms_household.hhid
                                              INNER JOIN sms_psu
                                                      ON sms_psu.psu =
                                                         sms_household.psu
                                       WHERE  sms_psu.state = 19
                                              AND sms_psu.district = 1
                                              AND sms_psu.psu = 2
                                              AND fieldname = 'Q139') AS
       totalcpuntpreg
FROM   woman_data
       INNER JOIN sms_household
               ON woman_data.prim_key = sms_household.hhid
       INNER JOIN sms_psu
               ON sms_psu.psu = sms_household.psu
WHERE  sms_psu.state = 19
       AND sms_psu.district = 1
       AND sms_psu.psu = 2
       AND fieldname = 'Q111'
GROUP  BY woman_data.answertext,
          sms_household.psu 
```

* * *

戈登，你的建议对我帮助很大。我相应地更新了我的查询。我现在写的问题是我为 Q112 增加了一行

电源 | 妊娠数| 怀孕百分比| 妊娠数中活产的百分比。
1 | 2 | 67% | 40%
2 | 1 | 33% | 80%
2 | 1 | 0% | 20%（第 112 季度的第三行是额外的）

但是我在分组时不需要 Q112 条目。我可以在 case 语句和 main where 语句中分别使用 group by 吗？我尝试将“有”与 group by 一起使用，但得到了预期的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T10:27:44.233

也许是这样的：

```
SELECT sms_psu.name1 AS PSU,
       woman_data.answertext  AS NumberOfPreg,
       SUM(fieldname = 'Q111') / SUM(fieldname = 'Q139') AS pregnancyPercentage,
       SUM(fieldname = 'Q112') / SUM(fieldname = 'Q139') AS liveBirthPercentage
FROM   woman_data
       INNER JOIN sms_household
               ON woman_data.prim_key = sms_household.hhid
       INNER JOIN sms_psu
               ON sms_psu.psu = sms_household.psu
WHERE  sms_psu.state = 19
       AND sms_psu.district = 1
       AND sms_psu.psu = 2
GROUP  BY woman_data.answertext,
          sms_household.psu  
HAVING SUM(fieldname = 'Q111') > 0 
```

该查询首先检索具有所有`fieldname`值的行，并将它们与以前相同的分组。计数时，仅根据需要计算特定`fieldname`条目（使用`SUM(condition)`技巧）。为了确保输出仅包含具有 的行的组，添加`fieldname = 'Q111'`了`SUM(fieldname = 'Q111') > 0`条件（作为 HAVING 子句）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T13:27:02.717

您的问题的答案是：CASE 声明。

这个想法是扩展外部 WHERE 子句以包含您关心的所有行。然后，在 SELECT 子句中使用 CASE 语句在单个变量的基础上过滤行。

我试图把它放在一起：

```
SELECT sms_psu.name1 AS PSU,
       woman_data.answertext AS NumberOfPreg,
       Count(case when sms_psu.state = 19 AND sms_psu.district = 1 AND sms_psu.psu = 2 AND fieldname = 'Q111'
                  then woman_data.answertext
             end) /
       (SELECT Count(woman_data.answertext)
        FROM woman_data INNER JOIN
              sms_household
              ON woman_data.prim_key = ms_household.hhid INNER JOIN
              sms_psu
              ON sms_psu.psu = sms_household.psu
        WHERE  sms_psu.state = 19 AND sms_psu.district = 1 AND sms_psu.psu = 2 AND
               fieldname = 'Q139'
       ) AS totalcpuntpreg,
       Count(case when sms_psu.state = 19 AND sms_psu.district = 1 AND sms_psu.psu = 2 AND fieldname = 'Q112'
                  then woman_data.answertext
             end) /
       (SELECT Count(woman_data.answertext)
        FROM woman_data INNER JOIN
              sms_household
              ON woman_data.prim_key = ms_household.hhid INNER JOIN
              sms_psu
              ON sms_psu.psu = sms_household.psu
        WHERE  sms_psu.state = 19 AND sms_psu.district = 1 AND sms_psu.psu = 2 AND
               fieldname = 'Q139'
       ) AS totalcpuntpreg

FROM woman_data INNER JOIN
     sms_household
     ON woman_data.prim_key = sms_household.hhid INNER JOIN
     sms_psu
     ON sms_psu.psu = sms_household.psu
WHERE sms_psu.state = 19 AND sms_psu.district = 1 AND sms_psu.psu = 2 AND
      fieldname in ('Q111', 'Q112')
GROUP BY woman_data.answertext
        sms_household.psu 
```

但是，我可能错过了一些细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T12:29:03.890

正如您所提到的，您的查询很复杂。不熟悉您的架构的人很难理解它。因此，我将为汇总多个项目的查询提供一般性建议。

使用一个体面的客户端程序，让您保存查询文本。如果它还可以漂亮地打印（格式化）您的查询文本，那将很有帮助。

分别开发和测试每个汇总查询。确保每一个都单独生成您需要的正确摘要结果。

然后，将这些查询与报告键（我相信在您的情况下为 PSU）连接在一起，以便生成多个摘要结果。确保它正在工作。

将查询名称和版本号放在 SELECT 语句之后的注释中：例如，

```
SELECT /* pregnancy outcomes 1.1 */
       sms_psu.name1 AS PSU,
       woman_data.answertext AS NumberOfPreg, etc. 
```

这将让您使用 MySQL`SHOW FULL PROCESSLIST`来确定正在运行的确切查询。

最后，如果结果查询（由许多嵌套的子查询组成）对于您的应用程序的要求来说太慢，请对其进行优化。

如果您遵循这些步骤，我相信您的下一步就是开发您的`% live birth`摘要查询。

# c++ - main.cpp|15|错误：从 'const char*' 到 'char' 的无效转换 [-fpermissive]| 制作游戏时出错

> ID：12003654
> 
> 赞同：0
> 
> 时间：2012-08-17T10:00:32.707
> 
> 标签：c++, codeblocks

我正在制作一个rpg。当我输入代码（如下所示）时，我收到此错误。我究竟做错了什么？

main.cpp|15|错误：从 'const char*' 到 'char' 的无效转换 [-fpermissive]|

```
#include <iostream>
#include <stdio.h>
#include <string>
#include <windows.h>

using namespace std;

int mainLoop()
{
    char arr[4] = {'x', 'x', 'x', 'x'};
    int pp = 1;
    bool end = false;
    string inp;

    arr[pp] = "S";

    while(end == false)
    {
        cout << arr << endl;
        cout << ">>: " << endl;
        cin >> inp;

        if(inp == "move")
        {
            pp++;
        }

    }
}

int main()
{
    mainLoop();

    return 0;
} 
```

编辑：

谢谢！但现在我将旧的 pp（玩家位置）保留为 S。我尝试制作一个新变量 ppold 并将其更改为 pp-1 到 x，但没有任何反应。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T10:01:52.080

```
arr[pp] = "S";  //incorrect 
```

应该

```
arr[pp] = 'S';  //correct 
```

`"S"`is的类型`char[2]`不能转换`char`为 的类型`arr[pp]`。但是类型`'S'`是`char`与`arr[pp]`（`char`也是）类型匹配的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T10:06:26.243

`"S"`（双引号）表示它是一个空终止的字符串，它是`{'S', '\0'}`在展开时。

`'S'`（单引号）表示它是一个 char 字符，它是`{'S'}`在展开时。

arr[X] 在您的示例中是字符数组中的一个字符（将其视为单引号表达式，如 'a'）

您不能分配`{'S', '\0'}`给`{'a'}`。

[这](https://stackoverflow.com/questions/3683602/single-quotes-vs-double-quotes-in-c)是有关情况的更多信息。

# javascript - 在每个 AJAX 请求中发送用户详细信息（会话令牌）（Sencha Touch 2）

> ID：12003655
> 
> 赞同：5
> 
> 时间：2012-08-17T10:00:36.540
> 
> 标签：javascript, extjs, sencha-touch-2

我正在使用特定于用户的数据集构建 Sencha Touch 2 应用程序。

### 应用架构：

Sencha Touch App <=====> 带有 REST 服务的 Java 服务器后端（许多 AJAX 请求 =)）

我实际上拥有的是：

*   使用用户名/密码登录用户

    > 应用程序被初始化，登录表单开始发挥作用。将表单作为 AJAX 请求提交后，服务器后端检查用户数据并调用客户端回调函数。

我想做的是：

*   回调函数应该
    1.  使用 sessiontoken 创建一个 cookie*或*
    2.  将 sessiontoken 存储在本地存储（[http://docs.sencha.com/touch/2-0/#!/api/Ext.data.proxy.LocalStorage](http://docs.sencha.com/touch/2-0/#!/api/Ext.data.proxy.LocalStorage)）*或*
    3.  将 sessiontoken 存储在 js 变量中

好的，应该问题不大。

**但我怎样才能实现以下目标：**

大多数数据是*特定于一个用户*的，如果需要，应该由 REST 服务返回（通过单击导航，...）。我如何在每个 AJAX 请求中发送 sessiontoken（见上文） - 以便服务器可以提供合适的数据集（假设令牌有效）？

***在 AJAX 请求中发送 cookie***

我已经读过如果 url 在同一个空间上，cookie 会自动添加到请求中，对吗？Java 服务器位于同一个域 (localhost:8080) 但 cookie 不可用 - 而不是像“app.json”这样的 url 上的请求。我认为跨域请求真的是特定于域的吗？

***在 AJAX 请求中发送参数***

因为 cookie 不是 avi，所以我考虑了“手动”向 ajax 请求添加参数的可能性。该应用程序将包含许多 AJAX 请求，这就是我不想手动添加令牌的原因 - 我试图覆盖*Ext.Ajax*的请求功能但我失败了；-(:

```
(function() {
    var originalRequest = Ext.data.Connection.prototype.request;

    Ext.override(Ext.data.Connection, {
        request : function(options) {
            alert("Do sth... like add params");
            return originalRequest.apply(this, options);
        }
    });
})(); 
```

错误：

> 未捕获的错误：[ERROR][Ext.data.Connection#request] 未指定 URL

我也尝试添加一个监听器

```
Ext.Ajax.add({
    listeners : {
        beforerequest :  function( conn, options, eOpts ){
           alert("Do sth... like add params");
        }
     }
}); 
```

错误：

> 未捕获的类型错误：对象 [对象对象] 没有方法“添加”

关于如何添加令牌的任何想法？

或者有什么更好的方法来处理这些案件？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T11:28:30.617

最后我成功使用了：

```
function addAjaxInterceptor(context)
{
   Ext.Ajax.on('beforerequest', function(conn, options, eOptions)
   {
      // add the param to options...
   }, context);
} 
```

从应用程序执行 (=> addAjaxInterceptor(this))。

但我认为以下解决方案更适合我的情况：

```
Ext.Ajax._defaultHeaders = {
    // params as json
}; 
```

（因为 Ext.Ajax 是一个单例对象，我不会更改每个请求的参数）

# ios - 如何使用 UIWebView 在 iPhone 应用中显示网站？

> ID：12003656
> 
> 赞同：0
> 
> 时间：2012-08-17T10:00:37.917
> 
> 标签：ios, app-store

我正在使用 UIWebView 在我的应用程序中打开一个链接，并将其提交给 AppStore 导致被拒绝，原因是审查指南 2.12 说

> 2.12：不是很有用的应用程序，只是作为应用程序捆绑的网站，或者不提供任何持久的娱乐价值的应用程序可能会被拒绝

是不是因为我用 UIWebView 打开了一个网站。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:09:56.840

`UIWebView`用于打开网站。但是您的应用程序必须具有某些更多功能。

仅包含`UIWebView`打开网站的应用程序没有用，因为您可以直接在 Safari 中打开网站，然后`Actionsheet`从底部栏打开并点击**添加到主屏幕**选项。它将与您尝试在 Appstore 上上传的应用程序相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T10:08:21.050

这不是因为你用 UIWebView 打开了一个网站，而可能是因为你的应用只这样做了。您的应用程序必须做更多的事情。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T11:08:39.583

据我所知，您没有提供任何有用的信息，即您的应用程序没有什么特别之处

# php - php + 脸书。获取访问令牌返回：验证验证码时出错

> ID：12003658
> 
> 赞同：0
> 
> 时间：2012-08-17T10:00:41.907
> 
> 标签：php, facebook, facebook-graph-api

将用户重定向到登录对话框后

```
$url = "https://graph.facebook.com/oauth/authorize?client_id=$appid&scope=&" .
"redirect_uri=$process_url"; 
```

其中 $process_uri 是表单的 urlencoded url `https://my.domain.com/process.php?param1=value1&param2=value2`。用户返回后，`https://my.domain.com/process.php`我对 curl 请求（已尝试先使用`file_get_contents`）：

```
$url = "https://graph.facebook.com/oauth/access_token?client_id=" .
"$appid&redirect_uri=$current_url&client_secret=$secret" .
"&code={$_REQUEST['code']}"; 
```

我得到`{ "error": { "message": "Error validating verification code.", "type": "OAuthException", "code": 100 } }`。

谷歌搜索后，我意识到可能导致问题的主要原因是`redirect_uri`curl 请求错误。`redirect_uri`问题是： curl 请求中应该包含什么？`https://my.domain.com/`? 或者`https://my.domain.com/process.php`？或者`https://my.domain.com/process.php?param1=value1&param2=value2`？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:40:17.427

当您将当前 URL 作为 redirect_uri 提交到[https://graph.facebook.com/oauth/access_token](https://graph.facebook.com/oauth/access_token)端点时，请删除 code 参数。

# javascript - Javascript 日期差异

> ID：12003660
> 
> 赞同：8
> 
> 时间：2012-08-17T10:00:43.877
> 
> 标签：javascript, date, datediff

我遇到了 DateDiff 函数的问题。我试图找出两个日期/时间之间的差异。我已经阅读了这篇文章（[What's the best way to calculate date Difference in Javascript](https://stackoverflow.com/questions/327429/whats-the-best-way-to-calculate-date-difference-in-javascript)）并且我还查看了本教程（[http://www.javascriptkit.com/javatutors/datedifference.shtml](http://www.javascriptkit.com/javatutors/datedifference.shtml)），但我似乎无法理解.

这是我试图开始工作但没有成功的原因。有人可以告诉我我在做什么以及如何简化它。似乎有点过度编码...？

```
//Set the two dates
var currentTime = new Date();
var month = currentTime.getMonth() + 1;
var day = currentTime.getDate();
var year = currentTime.getFullYear();
var currDate = month + "/" + day + "/" + year;
var iniremDate = "8/10/2012";

//Show the dates subtracted
document.write('DateDiff is: ' + currDate - iniremDate);

//Try this function...
function DateDiff(date1, date2) {
    return date1.getTime() - date2.getTime();
}

//Print the results of DateDiff
document.write (DateDiff(iniremDate, currDate); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-17T10:22:15.300

好的，对于那些想要一个工作示例的人来说，这里是一个简单的 DateDiff ex，它以负值（日期已经过去）或正值（日期即将到来）告诉日期差异。

编辑：我更新了这个脚本，所以它会为你做一些工作，并将结果转换为在这种情况下为 -10，这意味着日期已经过去。为 currDate 和 iniPastedDate 输入您自己的日期，您应该一切顺利！

```
//Set the two dates
var currentTime   = new Date()
var currDate      = currentTime.getMonth() + 1 + "/" + currentTime.getDate() + "/" + currentTime.getFullYear() //Todays Date - implement your own date here.
var iniPastedDate = "8/7/2012" //PassedDate - Implement your own date here.

//currDate = 8/17/12 and iniPastedDate = 8/7/12

function DateDiff(date1, date2) {
    var datediff = date1.getTime() - date2.getTime(); //store the getTime diff - or +
    return (datediff / (24*60*60*1000)); //Convert values to -/+ days and return value      
}

//Write out the returning value should be using this example equal -10 which means 
//it has passed by ten days. If its positive the date is coming +10\.    
document.write (DateDiff(new Date(iniPastedDate),new Date(currDate))); //Print the results... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-17T10:03:15.333

你的第一次尝试是先加法，然后是减法。无论如何，您都不能减去字符串，因此产生`NaN`.

第二次尝试没有关闭`)`。除此之外，您正在调用`getTime`字符串。你需要使用`new Date(...).getTime()`. 请注意，减去日期时，您会以毫秒为单位获得结果。您可以通过取出全天/小时/等来格式化它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-21T07:13:02.733

```
function setDateWeek(setDay){
    var d = new Date();
    d.setDate(d.getDate() - setDay); // <-- add this
    var curr_date = d.getDate();
    var curr_month = d.getMonth() + 1;
    var curr_year = d.getFullYear();
    return curr_date + "-" + curr_month + "-" + curr_year;
}

setDateWeek(1); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-09-02T07:39:32.677

无需包含 JQuery 或任何其他第三方库。

在标题标签中指定您的输入日期格式。

HTML：

```
< script type="text/javascript" src="http://services.iperfect.net/js/IP_generalLib.js"> 
```

使用javascript函数：

```
IP_dateDiff(strDate1,strDate2,strDateFormat,debug[true/false])

alert(IP_dateDiff('11-12-2014','12-12-2014','DD-MM-YYYY',false)); 
```

IP_dateDiff 函数将返回天数。

# python - GStreamer 如何从流中提取视频帧？

> ID：12003663
> 
> 赞同：3
> 
> 时间：2012-08-17T10:00:54.890
> 
> 标签：python, video-streaming, gstreamer

这是用于从服务器捕获流式视频的 python 代码。但我需要编写一个函数来从流中提取一帧。这将是一个按钮。单击它会显示当前帧。我没有想法。谁能帮我这个？？？

```
 self.player = gst.Pipeline("player")
    self.source = gst.element_factory_make("uridecodebin", "video-source")
    #self.source = gst.element_factory_make("playbin2", "video-source")
    sink = gst.element_factory_make("xvimagesink", "video-output")
    colorspace = gst.element_factory_make("ffmpegcolorspace")
    scale = gst.element_factory_make("videoscale")

    self.source.set_property("uri",\
    "http://10.10.25.4:12345/webcam.flv")

    caps = gst.Caps("video/x-raw-yuv, width=640, height=480, framerate=20/1")
    myfilter = gst.element_factory_make("capsfilter", "myfilter")
    myfilter.set_property("caps", caps)  # ################

    clr_sink = colorspace.get_pad("sink")
    self.source.connect("pad-added", self.on_pad_added, clr_sink)

    self.player.add(self.source, colorspace, scale, myfilter, sink)
    gst.element_link_many(colorspace, scale, myfilter, sink)

    self.bus = self.player.get_bus()
    self.bus.add_signal_watch()
    self.bus.connect('message', self.__on_message)

    self.player.set_state(gst.STATE_PLAYING) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T21:20:01.503

如果可以使用 playbin2，则可以使用“convert-frame”动作信号。否则查看实现和重用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-22T17:35:56.197

you want to use the `imagefreeze` element. something like:

```
#!/usr/bin/python

import pygst
pygst.require("0.10")
import gst

player = gst.Pipeline("player")
source = gst.element_factory_make("videotestsrc", "testsource")
effect = gst.element_factory_make("clockoverlay", "clock")
freeze = gst.element_factory_make("imagefreeze", "freeze")
colorspace = gst.element_factory_make("ffmpegcolorspace", "colorspace")
sink = gst.element_factory_make("ximagesink", "imagesink")

player.add(source, effect, freeze, colorspace, sink)
gst.element_link_many(source, effect, freeze, colorspace, sink)
player.set_state(gst.STATE_PLAYING)

while True:
  inp = raw_input("Press enter:")
  player.set_state(gst.STATE_READY)
  player.set_state(gst.STATE_PLAYING) 
```

whenever you hit "enter" in the console a new screenshot will be taken (from the videotest with clockoverlay) and displayed.

# sql-server-2008 - SQL组合两个查询后得到不同的结果

> ID：12003666
> 
> 赞同：0
> 
> 时间：2012-08-17T10:01:03.547
> 
> 标签：sql-server-2008

我有两个问题。 `First:`我正在尝试将两个查询合并为一个以放入存储过程以进行报告制作。他们是

查询 1

```
SELECT T0.Name AS Period, SUM(ISNULL(T2.LineTotal, 0)) AS CurrentDebtors, MAX(T1.DocRate) AS ExchangeRate,
SUM(CASE WHEN DATEDIFF(day, T1.DocDate, T1.DocDueDate) > 30
THEN T2.LineTotal END) AS NonCurrentDebtors 
FROM OFPR T0 LEFT OUTER JOIN OINV T1 ON T0.AbsEntry = T1.FinncPriod 
INNER JOIN INV1 T2 ON T1.DocEntry = T2.DocEntry WHERE YEAR(T1.DocDate) = @Year
GROUP BY T0.Name 
ORDER BY T0.Name 
```

查询 2

```
SELECT T0.Name AS Period, SUM(T1.DocTotal) AS TurnoverMonth
FROM dbo.OFPR T0 LEFT OUTER JOIN dbo.ORCT T1 ON T0.AbsEntry = T1.FinncPriod
WHERE YEAR(T1.DocDate) =  @Year
GROUP BY T0.Name
ORDER BY T0.Name 
```

我将它们组合成这样：

```
SELECT T0.Name AS Period, SUM(ISNULL(T2.LineTotal, 0)) AS CurrentDebtors, MAX(T1.DocRate) AS ExchangeRate,
SUM(CASE WHEN DATEDIFF(day, T1.DocDate, T1.DocDueDate) > 30
THEN T2.LineTotal END) AS NonCurrentDebtors , SUM(ISNULL(T3.DocTotal, 0)) AS TurnoverMonth
FROM OFPR T0 LEFT OUTER JOIN OINV T1 ON T0.AbsEntry = T1.FinncPriod 
INNER JOIN INV1 T2 ON T1.DocEntry = T2.DocEntry 
JOIN ORCT T3 ON T0.AbsEntry = T3.FinncPriod
WHERE YEAR(T1.DocDate) = @Year
GROUP BY T0.Name 
ORDER BY T0.Name 
```

问题是，虽然上面单独的 2 个查询的结果是正确的，但上面的组合查询返回的值不正确，数量非常大。如何正确地将两者结合起来？ `Second:`如果数据非常大，查询1也需要一些时间来执行，有什么方法可以提高效率吗？使用 Microsoft SQL Server 2008

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:49:26.800

由于连接的性质，如果您尝试同时聚合两个或多个表，则必然会得到重复的聚合。通过 TO 连接时，T2 和 T3 之间可能存在 n:m 关系。要解决这个问题，您可以使用 cte 或派生表 - 此重写使用 T3 的派生表来准确检索每个 TO.AbsEntry 的一行，从而消除重复。

```
SELECT T0.Name AS Period, 
       SUM(T2.LineTotal) AS CurrentDebtors, 
       MAX(T1.DocRate) AS ExchangeRate,
       SUM(CASE WHEN DATEDIFF(day, T1.DocDate, T1.DocDueDate) > 30
                THEN T2.LineTotal 
           END) AS NonCurrentDebtors, 
       T3.TurnoverMonth
  FROM OFPR T0 
 INNER JOIN OINV T1
    ON T0.AbsEntry = T1.FinncPriod 
 INNER JOIN INV1 T2 
    ON T1.DocEntry = T2.DocEntry
 INNER JOIN 
 (
    SELECT ORCT.FinncPriod, 
           SUM(ORCT.DocTotal) AS TurnoverMonth
      FROM ORCT
     WHERE YEAR(ORCT.DocDate) = @Year
     GROUP BY ORCT.FinncPriod
 )  T3 
    ON T0.AbsEntry = T3.FinncPriod
 WHERE YEAR(T1.DocDate) = @Year
 GROUP BY T0.Name, T3.TurnoverMonth
 ORDER BY T0.Name 
```

另一种可能是您需要按年份过滤 ORCT 表，这在组合查询中被省略了。出于性能原因，您可能会考虑将该过滤器扩展到日期范围测试，以允许 Sql Server 在 DocPeriod 上使用索引：

```
where DocDate >= convert(datetime, convert(varchar(20), @year) + '0101')
  and DocDate < dateadd (year, 1, 
                         convert(datetime, convert(varchar(20), @year) + '0101')) 
```

请注意，我已将 TurnoverMonth 添加到分组依据。这不会改变任何东西，因为每个 T3 将精确一行。

我还从 sum 中删除了 isnull() 测试，因为无论如何都会从 sum() 中删除 null 值。如果您想用零替换最终的空结果，请在 isnull() 中包含 sum()。

编辑：忘了提到我已将左连接更改为内连接，因为 T1 上的条件将连接的含义更改为内连接（除了为空/不为空之外，缺失的行不能被任何匹配）。如果您确实需要外连接，请将条件移至 ON 子句。

# mysql - 在单个查询中获取总计数和条件计数

> ID：12003671
> 
> 赞同：-6
> 
> 时间：2012-08-17T10:01:24.467
> 
> 标签：mysql

我在 MYSQL 数据库中有一个名为 apps 的表。

```
身份来源
1脸书
2 克
3台
4 脸书
5曲
6脸书

```

我想要一个查询，它会给我总计数和`fb`计数

```
总数来源
6 3

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:07:19.643

要`fb`在表中计数，请尝试以下操作：（使用`SUM`）

```
SELECT COUNT(*) totalcount,
SUM(source='fb') source 
FROM table1 
```

另一种方法：（使用`COUNT`）

```
SELECT COUNT(*) totalcount,
COUNT(CASE WHEN source = 'fb' THEN 0 END) source 
FROM table1; 
```

要计算表中的所有来源，请尝试以下操作：

```
SELECT COUNT(id) totalcount,
COUNT(DISTINCT source) source 
FROM table1 
```

# [*看到这个 SQLFiddle*](http://sqlfiddle.com/#!2/cb633/22)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:08:06.983

```
select sum(source='fb') as fb_count, 
       count(*) as totalcount
from your_table 
```

[SQLFiddle](http://sqlfiddle.com/#!2/ff99b/2)

# php - 如何在 twig 中显示来自 Unix 时间戳的格式化日期？

> ID：12003673
> 
> 赞同：21
> 
> 时间：2012-08-17T10:01:26.107
> 
> 标签：php, symfony, filter, twig, unix-timestamp

我想通过对 Unix 时间戳应用过滤器来在 twig 中显示格式化的日期。树枝中有这样的功能吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-17T10:28:56.233

有一个过滤器叫做[**`date`**](http://twig.sensiolabs.org/doc/filters/date.html).

在以下示例中`mydate`等于`1286199900`：

```
{{ mydate|date }}           <!-- October 4, 2010 13:45 -->
{{ mydate|date('d/m/Y') }}  <!-- 04/10/2010 --> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-22T08:13:00.937

如果您只是将其除以 1000，则可能会出现如下错误 `Failed to parse time string (1384361503.5) at position 7`

我会为其添加圆形功能

`{% set timestamp = (rating.ratingDate / 1000)|round(0, 'floor') %} {{timestamp|date('d. M Y')}}`

我知道我在扮演考古学家，但它可能对某人有所帮助。

# c# - 访问分组 gridView 中标题模板的元素

> ID：12003687
> 
> 赞同：0
> 
> 时间：2012-08-17T10:02:12.050
> 
> 标签：c#, xaml, windows-8, windows-runtime

对于 C#/XAML 中的 Windows 8 应用程序，我希望能够知道我在分组网格视图的标题模板中拥有的按钮的位置（X 和 Y）：

这是简单的 Xaml 代码：

```
 <GridView  x:Name="PicturesGridView" SelectionMode="None"     
 ItemsSource="{Binding Source={StaticResource cvs1}}" IsItemClickEnabled="True"
ItemTemplate="{StaticResource CustomTileItem}" ItemClick="ItemView_ItemClick"  IsSwipeEnabled="True"> 

            <GridView.ItemsPanel>
            <ItemsPanelTemplate>
    <VirtualizingStackPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
        </local:MyGridView.ItemsPanel>
        <local:MyGridView.GroupStyle>
            <GroupStyle x:Name="MyGroupStyle">
                <GroupStyle.HeaderTemplate >
                    <DataTemplate x:Name="MyDataTemplate">
                        <Button x:Name="HeaderButton" Click="Button_Click_1" Content="{Binding Key}" Foreground="Black" Background="White" FontSize="30" Margin="0,0,0,-10" ></Button>
                    </DataTemplate>
                </GroupStyle.HeaderTemplate>
                <GroupStyle.Panel>
                    <ItemsPanelTemplate>
  <VariableSizedWrapGrid ItemWidth="75" ItemHeight="150" Orientation="Vertical" Margin="0,0,80,0" MaximumRowsOrColumns="3"/>
                    </ItemsPanelTemplate>
                </GroupStyle.Panel>
            </GroupStyle>
        <GridView.GroupStyle>
    <GridView> 
```

通过执行以下操作，我成功访问了标题模板中的 Button：

```
 var template = element.FindName("PicturesGridView") as MyGridView;
            var group = template.GroupStyle[0] as GroupStyle;
            var buttonHeader = group.HeaderTemplate.LoadContent() as Button; 
```

但是我无法区分模板的每个按钮。我想要一组代表我的数据及其位置的物理按钮。

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T14:39:18.540

WinRT Tookit 可以满足您的需求...查看[http://winrtxamltoolkit.codeplex.com/downloads/get/467926](http://winrtxamltoolkit.codeplex.com/downloads/get/467926)并查看 VisualTreeHelperExtensions。

使用扩展方法 GetDescendantsOfType 您可以编写如下代码：

var 按钮 = PicturesGridView.GetDescendantsOfType().ToArray();

现在，这将为您提供 PicturesGridView 中的所有按钮，因此如果您的项目模板也包含按钮，那么您也会得到这些。您可以在 Header 模板中的按钮上设置 Tag 属性，以便您可以轻松地从其他按钮中识别它们。

# c++ - 将数组映射回现有的特征矩阵

> ID：12003692
> 
> 赞同：8
> 
> 时间：2012-08-17T10:02:29.430
> 
> 标签：c++, c, eigen, eigenvector, eigenvalue

我想将一个双精度数组映射到现有的 MatrixXd 结构。到目前为止，我已经设法将 Eigen 矩阵映射到一个简单的数组，但我找不到返回的方法。

```
void foo(MatrixXd matrix, int n){

 double arrayd = new double[n*n];
 // map the input matrix to an array
 Map<MatrixXd>(arrayd, n, n) = matrix;  

  //do something with the array 
             .......
// map array back to the existing matrix

} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-17T14:33:37.317

我不确定你想要什么，但我会尽力解释。

您在代码中混合了双精度和浮点数（MatrixXf 是一个矩阵，其中每个条目都是浮点数）。我暂时假设这是无意的，并且您想在任何地方使用 double ；如果这真的是您的意图，请参见下文。

该指令`Map<MatrixXd>(arrayd, n, n) = matrix`复制`matrix`into的条目`arrayd`。相当于循环

```
for (int i = 0; i < n; ++i)
   for (int j = 0; j < n; ++j)
      arrayd[i + j*n] = matrix(i, j); 
```

要复制`arrayd`into的条目`matrix`，您将使用反向赋值：`matrix = Map<MatrixXd>(arrayd, n, n)`。

但是，通常以下技术更有用：

```
void foo(MatrixXd matrix, int n) {
   double* arrayd = matrix.data();
   // do something with the array 
} 
```

现在 arrayd 指向矩阵中的条目，您可以将其作为任何 C++ 数组进行处理。`matrix`数据在和之间共享`arrayd`，因此您不必在最后复制任何内容。顺便说一句，您不需要传递`n`给函数`foo()`，因为它存储在矩阵中；使用 matrix.rows() 和 matrix.cols() 来查询它的值。

如果您确实想将 MatrixXf 复制到双精度数组，则需要显式包含强制转换。Eigen 中的语法是：`Map<MatrixXd>(arrayd, n, n) = matrix.cast<double>()`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-06-11T08:57:12.803

您不需要执行任何反向操作。

使用 Eigen::Map 时，您将原始数组映射到 Eigen 类。这意味着您现在可以使用 Eighen 函数读取或写入它。

如果您修改映射数组，则更改已经存在。您可以简单地访问原始数组。

```
float buffer[16]; //a raw array of float

//let's map the array using an Eigen matrix
Eigen::Map<Eigen::Matrix4f> eigenMatrix(buffer); 

//do something on the matrix
eigenMatrix = Eigen::Matrix4f::Identity();

//now buffer will contain the following values
//buffer = [1 0 0 0  0 1 0 0  0 0 1 0  0 0 0 1] 
```

# java - 获取上个月的第一个和最后一个日期

> ID：12003706
> 
> 赞同：16
> 
> 时间：2012-08-17T10:03:23.780
> 
> 标签：java, date, datetime, calendar

> **可能重复：**
> [如何获取上个月的第一个日期和最后一个日期？（爪哇）](https://stackoverflow.com/questions/10828398/how-to-get-the-first-date-and-last-date-of-the-previous-month-java)

在java中，如何获取上个月的第一个和最后一个日期？

如果我没记错，下面的代码是获取上个月的最后一个日期。

```
Calendar aCalendar = Calendar.getInstance();
aCalendar.set(Calendar.DAY_OF_MONTH, -1);    
aCalendar.add(Calendar.DAY_OF_MONTH, -1) ;
System.out.println(new Timestamp(aCalendar.getTime().getTime())); 
```

如果我错了，请纠正我。

谢谢你。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-17T10:06:11.557

采用[`getActualMaximum()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html#getActualMaximum%28int%29)

```
Calendar aCalendar = Calendar.getInstance();
// add -1 month to current month
aCalendar.add(Calendar.MONTH, -1);
// set DATE to 1, so first date of previous month
aCalendar.set(Calendar.DATE, 1);

Date firstDateOfPreviousMonth = aCalendar.getTime();

// set actual maximum date of previous month
aCalendar.set(Calendar.DATE,     aCalendar.getActualMaximum(Calendar.DAY_OF_MONTH));
//read it
Date lastDateOfPreviousMonth = aCalendar.getTime(); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-17T11:03:08.397

```
Calendar aCalendar = Calendar.getInstance();
aCalendar.set(Calendar.DATE, 1);
aCalendar.add(Calendar.DAY_OF_MONTH, -1);
Date lastDateOfPreviousMonth = aCalendar.getTime();
aCalendar.set(Calendar.DATE, 1);
Date firstDateOfPreviousMonth = aCalendar.getTime(); 
```

# android - 如何在 ListView 底部显示布局

> ID：12003712
> 
> 赞同：0
> 
> 时间：2012-08-17T10:03:42.293
> 
> 标签：android, android-layout

我有一个如下的布局 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="top"
    android:maxWidth="71dip"
    android:src="@drawable/logo_top" >
</ImageView>

<ImageView
    android:id="@+id/imageView2"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="top"
    android:adjustViewBounds="false"
    android:clickable="true"
    android:maxHeight="70dip"
    android:src="@drawable/registeration_title" >
</ImageView>

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="" >
</TextView>

<RelativeLayout
    android:id="@+id/relativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:id="@+id/linearframe"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <FrameLayout
            android:id="@+id/informationFrame"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical|center_horizontal" >

            <ImageView
                android:id="@+id/imageView3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="bottom"
                android:src="@drawable/registeration_info1" />

            <TextView
                android:id="@+id/IDNumberTextView"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="bottom"
                android:layout_marginBottom="7dip"
                android:layout_marginLeft="26dip"
                android:text="TextView"
                android:textColor="@drawable/textgreen" />

            <TextView
                android:id="@+id/EnableDateTextView"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="bottom"
                android:layout_marginBottom="7dip"
                android:layout_marginLeft="140dip"
                android:text="TextView"
                android:textColor="@drawable/textgreen" />
        </FrameLayout>
    </LinearLayout>

    <TextView
        android:id="@+id/textView2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/linearframe"
        android:text=" " />

    <ImageView
        android:id="@+id/imageView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/textView2"
        android:layout_centerHorizontal="true"
        android:src="@drawable/buy_in_60" />

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_alignLeft="@id/imageView5"
        android:layout_alignRight="@id/imageView5"
        android:layout_below="@id/imageView5" >

    </ListView>

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=" " />

    <FrameLayout
        android:id="@+id/frameLayout2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/listView1"
        android:layout_centerHorizontal="true"
        android:layout_marginLeft="79dp" >

        <ImageView
            android:id="@+id/imageView4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/registeration_info2" />

        <TextView
            android:id="@+id/VersionTextView"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="48dip"
            android:text="Version: 1.0"
            android:textColor="@drawable/darkgreen" />
    </FrameLayout>

    <TextView
        android:id="@+id/RevisionTextView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/frameLayout2"
        android:layout_centerHorizontal="true"
        android:layout_marginLeft="79dp"
        android:text="Revision: 16"
        android:textColor="@drawable/darkgreen" />

</RelativeLayout> 
```

xml中ListView下面的一些布局会在屏幕上消失

我试图将 ListView 和 ListView 下面的其他布局放入 scrollView

但是ListView会缩小，看起来太小了，所以我去掉了ScrollView，

我应该怎么做才能让它们出现在没有 ScrollView 的屏幕上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:19:02.410

你需要`Weight`像这样设置你的布局..

就像你可以设置 ListView 权重 = 0.80 和底部视图 = 0.20 确保父线性布局权重总和 = 1。

您可以看到这是我的 xml 文件，具有列表视图（80% 屏幕）和 Google Ads 底部栏布局（几乎 20% 屏幕）。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:weightSum="1">
    <LinearLayout
        android:id="@+id/layVrt"
        android:layout_width="match_parent"
        android:orientation="vertical"
        android:layout_height="wrap_content"
        android:layout_weight="0.72"
        android:weightSum="1">
        <ListView
            android:layout_width="match_parent"
            android:id="@+id/listViewGame"
            android:textFilterEnabled="true"
            android:layout_height="350dp"
            android:layout_weight="0.73"></ListView>
    </LinearLayout>
    <LinearLayout
        android:orientation="vertical"
        android:gravity="center"
        android:layout_width="match_parent"
        android:layout_weight="0.20"
        android:layout_marginTop="5dp"
        android:background="@drawable/rounded_corners_white"
        android:paddingLeft="3dp"
        android:paddingRight="3dp"
        android:layout_height="50dp"
        android:layout_marginBottom="3dp"
        android:id="@+id/layoutAdMobList">

    </LinearLayout>

</LinearLayout> 
```

所以这将是输出..

![在此处输入图像描述](../Images/5ed5ca597ce12e6cd24774518c8613bb.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T15:34:17.967

或者你可以尝试这样的事情：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:id="@+id/list"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_above="@+id/bottom_bar" >
    </ListView>

    <LinearLayout
        android:id="@+id/bottom_bar"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:background="@drawable/bottom_bar"
        android:gravity="center_vertical"
        android:orientation="horizontal" >

        <ToggleButton
            android:id="@+id/slider_btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="5dp"
            android:layout_weight="1"
            android:background="@drawable/bottom_toggle_button" />

        <ToggleButton
            android:id="@+id/list_btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="5dp"
            android:layout_weight="1"
            android:background="@drawable/bottom_left_button" />

        <ToggleButton
            android:id="@+id/map_btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:background="@drawable/bottom_right_button" />
    </LinearLayout>

</RelativeLayout> 
```

将所有内容放在 RelativeLayout 中并在 ListView 上使用 android:layout_above="@+id/bottom_bar"

# ruby-on-rails - 线程安全的 Rails 控制器操作 - 设置实例变量？

> ID：12003714
> 
> 赞同：13
> 
> 时间：2012-08-17T10:04:01.867
> 
> 标签：ruby-on-rails, thread-safety

我必须编写一个线程化的 Rails 应用程序，因为我在 Neo4j.rb 上运行它，它在 Rails 进程中嵌入了一个 Neo4j 图形数据库，因此我必须为来自同一进程的多个请求提供服务。是的，如果连接到 Neo4j 数据库像 SQL 数据库一样工作，那就太酷了，但事实并非如此，所以我将不再抱怨，直接使用它。

我非常担心编写并发代码的影响（我应该这样做），并且只需要一些关于如何处理常见场景的建议 - 控制器在会话哈希中设置实例变量或变量，然后是一些东西发生。考虑以下粗略代码来说明我的意思：

```
# THIS IS NOT REAL PRODUCTION CODE
# I don't do this in real life, it is just to help me ask my question, I
# know about one-way hashing, etc.!

class SessionsController
  def create
    user = User.find_by_email_and_password(params[:email], params[:password])
    raise 'auth error' unless user
    session[:current_user_id] = user.id
    redirect_to :controller => 'current_user', :action => 'show'
  end
end

class CurrentUserController
  def show
    @current_user = User.find(session[:current_user_id])
    render :action => :show # .html.erb file that uses @current_user
  end
end 
```

问题：这段代码中是否有任何竞争条件？

在 SessionsController 中，`session`散列和`params`散列是线程本地的吗？假设同一个浏览器会话使用不同的凭据向 /sessions#create 发出多个请求（借用 Rails 路由语法），那么登录的用户应该是`session[:current_user_id] = user.id`最后到达该行的请求吗？或者我应该在控制器动作周围加上一个互斥锁？

在 CurrentUserController 中，如果两个不同会话的请求同时触发 show 操作，两者是否会设置相同的 @current_user 变量？即第一个请求在处理 .html.erb 文件时会发现它的@current_user 实例变量突然被第二个线程更改了吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-17T10:25:30.017

每个请求都会获得一个[新的控制器实例](http://guides.rubyonrails.org/action_controller_overview.html#methods-and-actions)。因此，控制器实例变量是线程安全的。`params`并且`session`还由控制器实例变量（或请求对象本身）支持，因此也是安全的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T10:36:56.350

了解线程之间共享的内容和不共享的内容很重要。

现在回到你的具体例子。两个请求同时命中`CurrentUserController#show`，因此它们由两个并发线程处理。这里的关键是每个线程都有自己的实例`CurrentUserController`，所以有两个`@current_user`变量不会干扰。所以周围没有竞争条件`@current_user`。

竞争条件的一个例子是：

```
class ApplicationController < ActionController::Base
  before_each :set_current_user
  cattr_accessor :current_user

  def set_current_user
    self.class.current_user = User.find_by_id(session[:current_user_id])
  end
end

# model
class LogMessage < ActiveRecord::Base
  belongs_to :user

  def self.log_action(attrs)
    log_message = new(attrs)
    log_message.user = ApplicationController.current_user
    log_message.save
  end
end 
```

更一般地说，由于 GIL（全局解释器锁），在 MRI ruby​​ 中使用线程的好处是相当有限的。有些实现不受 GIL (jruby) 的约束。

# c# - 一个非常大的数字的日志

> ID：12003719
> 
> 赞同：4
> 
> 时间：2012-08-17T10:04:29.540
> 
> 标签：c#, .net, biginteger, logarithm

我正在处理 BigInteger 类，其中的数字按 2 的顺序提高到 10,000,000 次方。

BigInteger Log 函数现在是我算法中最昂贵的函数，我正在拼命寻找替代方法。

由于我只需要日志的组成部分，我遇到了[这个答案](https://stackoverflow.com/a/8233113/938668)，它在速度方面看起来很棒，但由于某种原因我没有得到准确的值。我不关心小数部分，但我确实需要得到一个准确的整数部分，无论该值是下限还是上限，只要我知道哪个。

这是我实现的功能：

```
public static double LogBase2 (System.Numerics.BigInteger number)
{
    return (LogBase2(number.ToByteArray()));
}

public static double LogBase2 (byte [] bytes)
{
    // Corrected based on [ronalchn's] answer.
    return (System.Math.Log(bytes [bytes.Length - 1], 2) + ((bytes.Length - 1) * 8));
} 
```

除了极端情况外，这些值现在非常准确。值 7 到 7.99999、15 到 15.9999、23 到 23.9999 31 到 31.9999 等返回 -Infinity。这些数字似乎围绕字节边界旋转。知道这里发生了什么吗？

例子：

```
LogBase2(                    1081210289) = 30.009999999993600 != 30.000000000000000
LogBase2(                    1088730701) = 30.019999999613300 != 30.000000000000000
LogBase2(                    2132649894) = 30.989999999389400 != 30.988684686772200
LogBase2(                    2147483648) = 31.000000000000000 != -Infinity
LogBase2(                    2162420578) = 31.009999999993600 != -Infinity
LogBase2(                    4235837212) = 31.979999999984800 != -Infinity
LogBase2(                    4265299789) = 31.989999999727700 != -Infinity
LogBase2(                    4294967296) = 32.000000000000000 != 32.000000000000000
LogBase2(                    4324841156) = 32.009999999993600 != 32.000000000000000
LogBase2(                  545958373094) = 38.989999999997200 != 38.988684686772200
LogBase2(                  549755813887) = 38.999999999997400 != 38.988684686772200
LogBase2(                  553579667970) = 39.009999999998800 != -Infinity
LogBase2(                  557430119061) = 39.019999999998900 != -Infinity
LogBase2(                  561307352157) = 39.029999999998300 != -Infinity
LogBase2(                  565211553542) = 39.039999999997900 != -Infinity
LogBase2(                  569142910795) = 39.049999999997200 != -Infinity
LogBase2(                 1084374326282) = 39.979999999998100 != -Infinity
LogBase2(                 1091916746189) = 39.989999999998500 != -Infinity
LogBase2(                 1099511627775) = 39.999999999998700 != -Infinity 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T10:09:33.527

试试这个：

```
public static int LogBase2(byte[] bytes)
{
    if (bytes[bytes.Length - 1] >= 128) return -1; // -ve bigint (invalid - cannot take log of -ve number)
    int log = 0;
    while ((bytes[bytes.Length - 1]>>log)>0) log++;
    return log + bytes.Length*8-9;
} 
```

最高有效字节为 0 的原因是因为 BigInteger 是有符号整数。当高位字节的最高有效位为 1 时，附加一个字节以表示正整数的符号位 0。

也从使用 System.Math.Log 函数改变，因为如果你只想要四舍五入的值，使用位运算要快得多。

* * *

如果您有 Microsoft Solver Foundation（在[http://msdn.microsoft.com/en-us/devlabs/hh145003.aspx](http://msdn.microsoft.com/en-us/devlabs/hh145003.aspx)下载），那么您可以使用 BitCount() 函数：

```
public static double LogBase2(Microsoft.SolverFoundation.Common.BigInteger number)
{
    return number.BitCount;
} 
```

* * *

或者您可以使用 java 库。添加对 vjslib 库的引用（在 .NET 选项卡中找到 - 这是 java 库的 J# 实现）。

您现在可以在代码中添加“使用 java.math”。

java.math.BigInteger 有一个 bitLength() 函数

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T11:04:01.417

```
BigInteger bi = new BigInteger(128);   
int log =  bi.Log2();

public static class BigIntegerExtensions
{
    static int[] PreCalc = new int[] { 8, 7, 6, 6, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
    public static int Log2(this BigInteger bi)
    {
        byte[] buf = bi.ToByteArray();
        int len = buf.Length;
        return len * 8 - PreCalc[buf[len - 1]] - 1;
    }
} 
```

# python - django/python：从字典中获取值时出错

> ID：12003721
> 
> 赞同：1
> 
> 时间：2012-08-17T10:04:41.203
> 
> 标签：python, django, dictionary, dotcloud, openshift

我在 dotcloud 和 redhat openshift 上托管了 python/django 代码。为了处理不同的用户，我使用令牌并将其保存在字典中。但是当我从 dict 获取值时，它有时会抛出一个错误（键值错误）。

```
import threading

thread_queue = {}

def download(request):
    dl_val = request.POST["input1"]
    client_token = str(request.POST["pagecookie"])
        # save client token as keys and thread object as value in dictionary
    thread_queue[client_token] = DownloadThread(dl_val,client_token)
    thread_queue[client_token].start()
    return render_to_response("progress.html",
              { "dl_val" : dl_val, "token" :      client_token }) 
```

下面的代码通过 javascript xmlhttprequest 以 1 秒的间隔执行到服务器。它将检查另一个线程内的变量并将值返回给用户页面。

```
def downloadProgress(request, token):
        # sometimes i use this for check the content of dict
    #resp = HttpResponse("thread_queue = "+str(thread_queue))
    #return resp
    prog, total = thread_queue[str(token)].getValue() # problematic line !
    if prog == 0:
                # prevent division by zero
        return HttpResponse("0")
    percent = float(prog) / float(total)
    percent = round(percent*100, 2)
    if percent >= 100:
        try:
            f_name = thread_queue[token].getFileName()[1]
        except:
            downloadProgress(request,token)
        resp = HttpResponse('<a href="http://'+request.META['HTTP_HOST']+
                            '/dl/'+token+'/">'+f_name+'</a><br />')
        return resp
    else:
        return HttpResponse(str(percent)) 
```

经过几天的测试，它有时会返回：

```
thread_queue = {} 
```

它有时会成功：

```
thread_queue = {'wFVdMDF9a2qSQCAXi7za': , 'EVukb7QdNdDgCf2ZtVSw': , 'C7pkqYRvRadTfEce5j2b': , '2xPFhR6wm9bs9BEQNfdd': } 
```

当我通过manage.py runserver在本地运行django并使用google chrome访问它时，我从来没有得到这个结果，但是当我将它上传到dotcloud或openshift时，它总是会出现上述问题。我的问题 ：

*   我怎么解决这个问题 ？
*   dotcloud 和 openshift 是否限制了它们的 python cpu 使用？
*   或者是python字典里面的问题？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T12:06:57.087

dotCloud 默认有 4 个工作进程用于 python 服务。当您在本地运行开发服务器时，您只运行一个进程。就像@martijn 所说，您的问题与您的 dict 不会在这些进程之间共享这一事实有关。

要解决此问题，您可以使用 redis 或 memcached 之类的东西来存储此信息。如果您需要更长期的存储解决方案，那么使用数据库可能更适合。

dotCloud 不限制 CPU 使用率，CPU 在同一台主机上共享，允许突发，但最终每个人都有相同数量的 CPU。

查看您的代码，您应该在访问它之前检查以确保 dict 中有一个值，或者至少用 try except 块包围代码，以处理数据不存在的情况。

```
str_token = str(token)
if str_token in thread_queue:
   prog, total = thread_queue[str_token].getValue() # problematic line !
else:
   # value isn't there, do something else 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T10:12:00.547

大概 dotcloud 和 openshift 运行您的代码的多个进程；字典不会在这些进程之间共享。

请注意，这也意味着额外的进程也无法访问您的额外胎面。

请改用外部数据库获取此类信息。对于像这样长时间运行的异步作业，您还需要在单独的工作进程中运行它们。例如，查看 Celery 以获得用于异步作业处理的一体化解决方案。

# iphone - 如何在 UIAlertView 中放置用户 ID 和密码的 uitextfield？

> ID：12003723
> 
> 赞同：0
> 
> 时间：2012-08-17T10:05:01.023
> 
> 标签：iphone, objective-c

我正在创建一个应用程序，我需要在 UIAlertView 中为用户登录创建两个 UITextField 或 TextBox 用于用户 ID 和密码。我尝试了一些方法，但在这里创建的文本字段变得非常大，几乎覆盖了整个警报视图。请有人帮助我如何在警报视图中组织文本字段和标签等。我需要喜欢 - 标签“用户 ID”和“密码”应该有一个小的文本字段。那么该怎么做呢？请帮我。提前谢谢。

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"User Login" message:@"Please Enter the Following \n\n\n\n\n\n\n" delegate:self cancelButtonTitle:@"Close" otherButtonTitles:@"Sign In", nil];

UILabel *lblUserName = [[UILabel alloc] initWithFrame:CGRectMake(20, 70, 85, 21)];
lblUserName.tag =2;
//lblUserName.backgroundColor = [UIColor darkGrayColor];
lblUserName.font = [UIFont systemFontOfSize:15.0];
lblUserName.text = @"User Name:";
lblUserName.textColor=[UIColor whiteColor]; 

//[lblUserName setFont:[UIFont fontWithName:@"TimesNewRomanPS-boldMT" size:8]];
lblUserName.backgroundColor = [UIColor clearColor]; 
[alert addSubview:lblUserName];

UITextField *txtUserName;

//if(txtUserName==nil)
 txtUserName = [[UITextField alloc] initWithFrame:CGRectMake(89, 50, 160, 30)];

txtUserName.tag = 3;
txtUserName.borderStyle = UITextBorderStyleBezel;
txtUserName.textColor = [UIColor whiteColor];
txtUserName.font = [UIFont systemFontOfSize:12.0];
txtUserName.placeholder = @"User ID";
[alert addSubview:txtUserName]; 

alert.tag=3;
[alert show];
[alert release]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:06:54.967

从 iOS5 开始，UIAlertView 支持使用警报样式 UIAlertViewStyleLoginAndPasswordInput 的登录屏幕。

[UIAlertView 类参考](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIAlertView_Class/UIAlertView/UIAlertView.html#//apple_ref/occ/cl/UIAlertView)中的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:58:35.457

```
 UIAlertView *alert =[UIAlertView alloc] init];
 alert.delegate =self //make sure to add the UIAertViewDelegate in the .h file
 alert.alertViewStyle =UIAlertViewStyleLoginAndPasswordInput;
 alert.message =@"Please login";
 [alert show];
 [alert release]; 
```

然后在 clickedButtonAtIndex 委托方法中：

```
{
   UITextField *username = [alertView textFieldAtIndex:0];
   UITextfield *password = [alertView textFieldAtIndex:1];
   NSLog(@"Username %"@  password %"@,username.text, password.text);
} 
```

# tmux - 在 tmux 中按前缀键时给出提示

> ID：12003726
> 
> 赞同：37
> 
> 时间：2012-08-17T10:05:19.087
> 
> 标签：tmux

当我按下前缀键时，`Ctrl-b`tmux 并没有提示我它已被按下。

有时我不记得我是否已经按下它。

当我按下前缀键时，我可以设置一个提示，如突出显示/更改颜色或在状态栏中显示一些特殊符号以显示我吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-09T08:11:30.707

*tmux*的开发版本已经支持这个，所以下一个版本（1.8？）应该也支持它。

有两个更改可以组合在一起，以在您的状态行中指示是否已按下前缀键：

*   您可以在“状态”选项的值中包含扩展的“格式”替换。这些替换首先在*tmux* 1.6 中可用，但它们以前不能在状态选项中使用。
*   添加了`client_prefix`格式替换。

您可以在默认值之前添加一个（条件）突出显示`<Prefix>`的字符串，`status-right`如下所示：

```
set -g status-right ' #{?client_prefix,#[reverse]<Prefix>#[noreverse] ,}"#{=21:pane_title}" %H:%M %d-%b-%y' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-08T14:04:27.277

还有一个名为[tmux-prefix-highlight](https://github.com/tmux-plugins/tmux-prefix-highlight)的 Tmux 插件可以做到这一点。
它添加了一个新关键字，`#{prefix_highlight}`用于定义 tmux 状态栏的字符串，如下所示：

```
set -g status-right '#{prefix_highlight} | %a %Y-%m-%d %H:%M' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-05T17:07:45.810

我为此创建了插件。它也指示复制模式，易于定制并且具有良好的开箱即用体验。

[https://github.com/dominikduda/tmux_mode_indicator](https://github.com/dominikduda/tmux_mode_indicator)

正如自述文件所说：

> 指示正常/插入/前缀/复制模式的插件。

它添加了一个新关键字 #{tmux_mode_indicator} 以在定义 tmux 状态栏的字符串中使用。像这样：

```
set -g status-right "#{tmux_mode_indicator}" 
```

# php - 为什么explode() 不起作用？

> ID：12003728
> 
> 赞同：-3
> 
> 时间：2012-08-17T10:05:19.897
> 
> 标签：php

我正在使用下面的代码部分，无法使explode() 函数工作。

```
$a="E:\xampp\htdocs\magento162\media\catalog\product\c\o\colorch091001-black-2.jpg";
$b=explode("\",$a);
print_r($b); 
```

为什么上面的代码没有输出。IDE提供了一个错误提示，但我不知道在哪里。

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-17T10:07:28.060

最有可能的是，您必须将反斜杠“\”转义为双反斜杠“\\”，in`$a`和 in `("\"...`which 都变为`explode("\\", $a);`

甚至 StackOverflow 的语法高亮也会告诉你有一个错误 :) （看到你`print_r`的红色？） :)

```
$a="E:\\xampp\\htdocs\\magento162\\media\\catalog\\product\\c\\o\\colorch091001-black-2.jpg";
$b=explode("\\",$a); 
```

**编辑：**我将进一步解释：在双引号字符串`"...."`中，反斜杠用于转义一些特殊字符，如：

\n = 换行符，

\t = 制表符，

\" = 双引号，顺便说一下，由于字符串未“完成”，因此会产生语法错误，并且解析器将`,$a);`其余部分视为字符串的延续...，

所以在某些情况下`\`，它本身并不是一个“真正的”字符，因此需要输入两次才能表示一个“真正的”反斜杠。（这意味着，正如另一位用户 [@xdazz] 所说，您可以使用单引号字符串`'...'`来避免转义）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T10:07:50.837

你需要逃避`\`.

```
$b=explode("\\",$a); 
```

你最好使用单引号`$a`，或者如果字符串包含一些特殊的字符，比如`\n`将被视为换行代码。

```
$a='E:\xampp\htdocs\magento162\media\catalog\product\c\o\colorch091001-black-2.jpg'; 
```

# iphone - 提高 iPhone 加速度计计算步数的准确性

> ID：12003733
> 
> 赞同：0
> 
> 时间：2012-08-17T10:05:34.383
> 
> 标签：iphone, objective-c, navigation

我目前正在使用以下代码来计算用户在我的室内导航应用程序中执行的步数。当我将手机放在胸前，屏幕朝上时，它可以很好地计算我走的步数。但常见的操作，如在屏幕上点击或在地图注册步骤中平移也很重要。这非常令人沮丧，因为在平面图中跟踪我的运动将变得非常不准确。有谁知道在这种情况下如何提高跟踪的准确性？任何意见将不胜感激！为了更好地了解我想要做什么，你们可以在[http://www.youtube.com/watch?v=wMgIa44mJXY](http://www.youtube.com/watch?v=wMgIa44mJXY)查看类似的 Android 应用程序。谢谢！

```
-(void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {

float xx = acceleration.x;
float yy = acceleration.y;
float zz = acceleration.z;

float dot = (px * xx) + (py * yy) + (pz * zz);
float a = ABS(sqrt(px * px + py * py + pz * pz));
float b = ABS(sqrt(xx * xx + yy * yy + zz * zz));

dot /= (a * b);
if (dot <= 0.9989) {
    if (!isSleeping) {
        isSleeping = YES;
        [self performSelector:@selector(wakeUp) withObject:nil afterDelay:0.3];
        numSteps += 1;
    }
}  
px = xx; py = yy; pz = zz;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T12:18:26.233

来自加速度计的数据基本上是三维矢量信号的一维（时间）非均匀采样。弄清楚如何*计算步数*的最佳方法是编写一个应用程序来记录和存储一段时间内的样本，然后将数据导出到 Wolfram 的 Mathematica 等数学应用程序进行分析和可视化。请记住，采样是非均匀的，您可能希望也可能不希望将其转换为均匀采样的数字信号。

然后，您可以尝试不同的信号处理算法，看看哪种效果最好。

有可能，一旦您知道加速度计数据中*步进*的基本形状，您就可以通过简单的卷积来识别它们。

# javascript - 在rails中动态选择项目

> ID：12003734
> 
> 赞同：1
> 
> 时间：2012-08-17T10:05:39.007
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3

我正在尝试使用 rails 和 jquery 在这里进行动态选择。代码如下

```
<div class = "line_items">  

<%- calc = Hash[Item.all.map{|p| [p.id, p.quantity]}].to_json %>

<div class = "item"><%= f.collection_select :item_id,Item.all,:id,:title, :prompt => "Select a Item", input_html: {data:{calc: calc} %></div>

   <div class ="quantity"> <%= f.text_field :quantity %></div>
/*rest  of code*/
</div> 
```

视图的javascript如下

```
jQuery(document).ready(function(){
    jQuery('.item').bind('change',function() {
    var selectElement = jQuery(this);
    var  itemSelected = jQuery('.item:selected').val();
    var wrapperDivElement = selectElement.parent(".line_items");
    var quantity= eval(selectElement.data("calc"))[itemSelected];
    jQuery(".quantity", wrapperDivElement).val(quantity);
  });
}); 
```

当我更改项目时，我 `eval(selectElement.data("calc"))[itemSelected] is undefined`在萤火虫中收到以下错误。谁能指出我哪里出错了？还有任何更好的方法来获得数量。我觉得我正在做的方法很粗糙。任何指导都会有所帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T10:01:44.763

```
jQuery(document).ready(function(){
    jQuery('.item select').bind('change',function() {
    var selectElement = jQuery(this);
    var  itemSelected = selectElement.val();
    var wrapperDivElement = selectElement.parents(".line_items");
    var quantity= eval(selectElement.data("calc"))[itemSelected];
    jQuery(".quantity input", wrapperDivElement).val(quantity);
  });
}); 
```

我猜 itemSelected 的值没有被检测到，因此错误。上面重新定义的代码应该可以工作。但我强烈敦促您不要获取这样的数据。最好进行 json 调用或 ajax 调用以从控制器获取相关数据。并在代码中`parents`使用:)`parent`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T11:09:22.083

我认为您将按索引的引用和按 ID 的引用混淆了。我不是 Javascript 向导，但你用 . 然后您在更改事件中获得“val”值。那包含一个整数，但那不是索引。

然后您在 Javascript 中请求具有索引 val 的项目，而不是具有值 val 的项目。也许 javascript 无法区分它们，因为两者都需要一个 Int ...

就是这一行：

```
var quantity= eval(selectElement.data("calc"))[itemSelected]; 
```

# django - django @login_required 超级用户的装饰器

> ID：12003736
> 
> 赞同：102
> 
> 时间：2012-08-17T10:05:39.857
> 
> 标签：django, django-views

django 中是否有类似于@login_required 的装饰器，它也可以测试用户是否是超级用户？

谢谢

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2012-08-17T10:09:56.930

使用[`user_passes_test`](https://docs.djangoproject.com/en/dev/topics/auth/default/#django.contrib.auth.decorators.user_passes_test)装饰器：

```
from django.contrib.auth.decorators import user_passes_test

@user_passes_test(lambda u: u.is_superuser)
def my_view(request):
    ... 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2015-11-05T22:22:08.727

如果**员工成员**足够，并且您**不需要**检查用户是否为超级用户，则可以使用`@staff_member_required`装饰器：

```
from django.contrib.admin.views.decorators import staff_member_required

@staff_member_required
def my_view(request):
    ... 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-09-20T09:27:20.920

如果您想拥有与@staff_member_required 类似的功能，您可以轻松编写自己的装饰器。以@staff_member 为例，我们可以这样做：

```
from django.contrib.auth import REDIRECT_FIELD_NAME
from django.contrib.admin.views.decorators import user_passes_test

def superuser_required(view_func=None, redirect_field_name=REDIRECT_FIELD_NAME,
                   login_url='account_login_url'):
    """
    Decorator for views that checks that the user is logged in and is a
    superuser, redirecting to the login page if necessary.
    """
    actual_decorator = user_passes_test(
        lambda u: u.is_active and u.is_superuser,
        login_url=login_url,
        redirect_field_name=redirect_field_name
    )
    if view_func:
        return actual_decorator(view_func)
    return actual_decorator 
```

这个例子是一个修改过的staff_member_required，只是在lambda里改了一个check。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-03-02T09:49:18.583

对于基于类的视图，创建一个可重用的装饰器：

```
from django.contrib.auth.mixins import UserPassesTestMixin
from django.views.generic import View

def superuser_required():
    def wrapper(wrapped):
        class WrappedClass(UserPassesTestMixin, wrapped):
            def test_func(self):
                return self.request.user.is_superuser

        return WrappedClass
    return wrapper

@superuser_required()
class MyClassBasedView(View):
    def get(self, request):
        # ... 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-01-06T15:57:13.497

我推荐使用 Mixins，例如：

```
from django.contrib.auth.mixins import UserPassesTestMixin

class SuperUserCheck(UserPassesTestMixin, View):
    def test_func(self):
        return self.request.user.is_superuser 
```

然后你可以添加`SuperUserCheck`到`View`类：

```
class MyView(SuperUserCheck, View): 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-03-14T14:38:33.257

如果您有您的用户个人资料，您可以简单地执行此操作

```
@login_required
@user_passes_test(lambda u: True if u.profile.role==2 else False )
def add_listing(request):
    #... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-02T18:22:22.573

要在基于类的视图上要求超级用户而不编写新代码：

```
from django.utils.decorators import method_decorator
from django.contrib.auth.decorators import user_passes_test

@method_decorator(user_passes_test(lambda u: u.is_superuser), name='dispatch')
class AdminCreateUserView(LoginRequiredMixin, FormView):
    ...
    ...
    ... 
```

# matlab - 如何检索局部变量？

> ID：12003739
> 
> 赞同：4
> 
> 时间：2012-08-17T10:05:42.610
> 
> 标签：matlab

是否可以从我在 matlab 中运行的程序函数中检索局部变量？即我想从代码中检索一个变量，该变量未出现在输出中。

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T10:15:05.900

下面描述了添加到函数本身以使变量在本地范围之外可用的代码。当您无法更改功能时，从外部当然无需更改范围（这是有意的，正确的行为！！）。

肮脏的方式：

*   [全局变量](http://www.mathworks.nl/help/techdoc/ref/global.html)

    ```
    global t
    t=2.468; 
    ```

*   对于标量、字符串、简单值：使用[evalin](http://www.mathworks.nl/help/techdoc/ref/evalin.html)分配给基础工作区中的变量：

    ```
    t=2.468;
    evalin('base', ['var_in_base=' num2str(t) ';']); 
    ```

*   任何其他变量，使用[assignin](http://www.mathworks.nl/help/techdoc/ref/assignin.html)：

    ```
    A=magic(20);
    assignin('base','A',A); 
    ```

合适的方式：

*   [在调试](http://www.mathworks.nl/help/techdoc/matlab_prog/f10-60570.html)期间检查它们
*   如果您真的希望它们在本地范围之外，请将它们添加为输出变量！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:14:19.827

看看[声明函数](http://www.mathworks.de/help/techdoc/ref/function.html)。如果将局部变量作为返回值返回，则可以访问它们。如果不这样做，则无法从外部访问它们。

所以在

```
function [mean,stdev] = stat(x)
n = length(x);
mean = sum(x)/n;
stdev = sqrt(sum((x-mean).^2/n)); 
```

您可以访问 mean 和 stdev，但无法访问 n。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-17T10:17:24.760

I don't know matlab at all, but from programmer's logic that seems improper and impossible without hacking the code. That being said, through Google I saw this:

> When you call a script from a function, the script uses the function workspace. Like local functions, nested functions have their own workspaces. However, these workspaces are unique in two significant ways: Nested functions can access and modify variables in the workspaces of the functions that contain them. All of the variables in nested functions or the functions that contain them must be explicitly defined. That is, you cannot call a function or script that assigns values to variables unless those variables already exist in the function workspace.

[Base and Function Workspace](http://www.mathworks.com/help/techdoc/matlab_prog/f0-38052.html)

Not sure if this helps you at all, but it may clarify some points

# java - 使用正则表达式在Java中选择具有特定字符的HTML正文中的句子

> ID：12003743
> 
> 赞同：0
> 
> 时间：2012-08-17T10:05:46.793
> 
> 标签：java, regex, html-parsing, text-processing

我有一个 html 页面。我只想在句子/文本末尾带有问号的标签中提取文本。我使用：

```
<.+?>(.+?)<.+?> 
```

获取标签内的文本。但这有两个问题：1-我不想要的所有嵌套标签也被提取了。（我只想要纯文本）2-我只想在末尾有问号的标签中获取那些文本.

我不知道该怎么做。有人可以帮我（用Java）。PS：我的html页面格式错误，因此，使用JSoup等工具不是一个选择。这就是为什么我只使用正则表达式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:13:47.197

如果您有无限嵌套，则检测嵌套和不匹配是困难的或不可能的，但您可以试试这个：

```
<(.+?)>(.+?\?)</$1> 
```

它匹配再次关闭且仅在末尾带有问号的标签。

见[红字](http://rubular.com/r/xUiaMEXL2Q)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T14:59:49.010

你有充分的理由使用正则表达式吗？

你可以自己分析你的html代码。也许它更快......如果你没有任何标签，这是一个小解决`<mytag?>`方案`</mytag?>`

```
 final LinkedList<String> chunks = new LinkedList<String>();

    final String text = "<i>italic</i><mytag?>text</mytag?><href>anchor</href> <mySecondTag?>word</mySecondTag?>";

    String rest = text;
    int pos;
    while ( (pos = rest.indexOf("?>") )!=-1)
    {
        final int endTag = rest.indexOf("<", pos);
        chunks.add(rest.substring(pos+2, endTag));
        rest = rest.substring(rest.indexOf(">", endTag+1)+1);
    }

    System.out.println(chunks); 
```

# cocoa - curl - 无法连接到主机

> ID：12003746
> 
> 赞同：0
> 
> 时间：2012-08-17T10:06:06.033
> 
> 标签：cocoa, curl

我在我的 Cocoa 应用程序中使用 curl 与服务器通信。它可以正常工作一段时间。但是有时当它尝试使用 curl 与服务器通信时，它会给出响应：“无法连接到主机”。当我收到此错误时，我的应用程序会在 30 秒后尝试与服务器连接。有时它连接到服务器，但有时它会不断给出相同的错误，直到我重新启动我的应用程序。重新启动我的应用程序后，它工作正常。
有没有人有任何想法来解决这个问题？

# java - java 7 中的 DirectoryStream 和 DirectoryStream.filter 有什么区别？

> ID：12003747
> 
> 赞同：0
> 
> 时间：2012-08-17T10:06:08.607
> 
> 标签：java, java-7

顾名思义，过滤是唯一的区别，或者还有其他什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:43:35.710

**DirectoryStream** --> 当您想要处理目录的内容（例如，它包含的文件）时，此静态接口会很有用。

**DirectoryStream.Filter** -->此接口仅列出大于给定千字节数的文件，也用于确定是否应接受路径对象。

# javascript - 使用PhoneGap在Android中禁用菜单按钮

> ID：12003757
> 
> 赞同：3
> 
> 时间：2012-08-17T10:06:48.593
> 
> 标签：javascript, cordova

我正在使用 PhoneGap 和 jQuery Mobile 构建我的第一个移动应用程序，但遇到了一个小问题。

我一直在 Android 上测试它，包括物理设备和模拟器。由于这个应用程序非常简单并且没有太多设置方式，我想禁用菜单按钮。

现在，我从[PhoneGap 文档](http://docs.phonegap.com/en/2.0.0/cordova_events_events.md.html#menubutton)中得到的印象是，您需要为 menubutton 事件添加一个事件侦听器以覆盖默认行为，并使用 preventDefault 来停止发生默认操作。尽我所能，我似乎无法让它工作。我为它编写的代码在[JSFiddle](http://jsfiddle.net/MattBD/ZEYVN/3/)上。

这可能吗？如果是这样，知道我哪里出错了吗？

编辑：真的应该提到版本-我使用的是PhoneGap 2.0。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T22:30:15.533

我有同样的问题。似乎是 PhoneGap 2.0 中的新默认设置。

在 src 文件夹下的 .java 文件中（MainActivity.java 似乎是默认文件名），注释掉 onCreateOptionsMenu 函数。

# ios - 使用 glDrawArray 绘图

> ID：12003758
> 
> 赞同：2
> 
> 时间：2012-08-17T10:06:50.463
> 
> 标签：ios, opengl-es, cocos2d-iphone

在`draw`我的`CCLayer`. 我正在画一些线条并`CGPoints`存储在`std::vector`. 我已经使用 ccDrawLine 成功绘制了线条。但是，使用时`glDrawArray`，什么都没有显示。我已经包含了结果的屏幕截图。正如您在使用 ccDrawnLine 时所看到的，它正确地绘制了线条。有任何想法吗？

[更新] 我使用的是 Cocos2d v2.0，默认情况下它使用 OpenGLES 2.0。

```
//openGLES
#include <OpenGLES/EAGL.h>
#include <OpenGLES/ES2/gl.h>
#include <OpenGLES/ES2/glext.h>

- (void) draw {
    glLineWidth( 3.0f );

    //begin and clear
    [renderTexture beginWithClear:waveform4F.r g:waveform4F.g b:waveform4F.b a:waveform4F.a];
    vector<CGPoint> vertices = bufferQueue.front();

    if (WaveformStyleLined) {
        for (int i = 1; i < vertices.size(); i++)
            ccDrawLine(vertices[i - 1], vertices[i]);
    } else {
        ccGLEnableVertexAttribs( kCCVertexAttribFlag_Position );
        kmGLPushMatrix();

        glVertexAttribPointer(kCCVertexAttrib_Position, 2, GL_FLOAT, GL_FALSE, sizeof(CGPoint), &vertices[0]);
        glDrawArrays(GL_LINES, sizeof(CGPoint), vertices.size());

        kmGLPopMatrix();
    }

    bufferQueue.pop();
    [renderTexture end];
} 
```

![使用 ccDrawLine](../Images/9722faf87ad60ee414cf5114521d8d89.png)

![使用 glDrawArrays](../Images/be7f7cd0146d93f0c9b3df2394c8d3a2.png)

以下是 my 中的一些`CGPoint`s `vertices`：

```
2012-08-18 08:57:49.750 vertices[1]:NSPoint: {1, 48.09375}
2012-08-18 08:57:49.751 vertices[2]:NSPoint: {2, 47.996094}
2012-08-18 08:57:49.752 vertices[3]:NSPoint: {3, 48.046875}
2012-08-18 08:57:49.753 vertices[4]:NSPoint: {4, 48.214844}
2012-08-18 08:57:49.754 vertices[5]:NSPoint: {5, 48.152344}
2012-08-18 08:57:49.755 vertices[6]:NSPoint: {6, 48.035156}
2012-08-18 08:57:49.755 vertices[7]:NSPoint: {7, 48.078125}
2012-08-18 08:57:49.756 vertices[8]:NSPoint: {8, 48.144531}
2012-08-18 08:57:49.757 vertices[9]:NSPoint: {9, 48.0625}
2012-08-18 08:57:49.757 vertices[10]:NSPoint: {10, 48.242188} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T08:20:57.780

我最终使用了`ccDrawPoly`，其中内部使用`glDrawArray`并实现了与 ccDrawLine 完全相同的输出，但速度要快得多，因为我不是逐点检索。但是，我仍然很好奇如何使用纯 OpenGL 代码来做到这一点。任何帮助或指导将不胜感激。

```
if (WaveformStyleLined) {
    for (int i = 1; i < vertices.size(); i++)
        ccDrawLine(vertices[i - 1], vertices[i]);

} else {
    ccDrawPoly(&vertices[0], vertices.size(), false);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T09:24:10.283

通过添加像 DrummerB 这样的着色器，线条开始出现。我从 Cocos2d 复制了相同的着色器代码，它就像一个魅力。

```
//openGLES
#include <OpenGLES/EAGL.h>
#include <OpenGLES/ES2/gl.h>
#include <OpenGLES/ES2/glext.h>

static BOOL initialized = NO;
static CCGLProgram *shader_ = nil;
static int colorLocation_ = -1;
static ccColor4F color_ = {1,1,1,1};
static int pointSizeLocation_ = -1;
static void lazy_init( void )
{
    if( ! initialized ) {

    //
    // Position and 1 color passed as a uniform (to similate glColor4ub )
    //
        shader_ = [[CCShaderCache sharedShaderCache] programForKey:kCCShader_Position_uColor];

        colorLocation_ = glGetUniformLocation( shader_->program_, "u_color");
        pointSizeLocation_ = glGetUniformLocation( shader_->program_, "u_pointSize");

        initialized = YES;
    }
}

- (void) draw {
    glLineWidth( 3.0f );

    //begin and clear
    [renderTexture beginWithClear:waveform4F.r g:waveform4F.g b:waveform4F.b a:waveform4F.a];
    vector<CGPoint> vertices = bufferQueue.front();

    if (WaveformStyleLined) {

        ccDrawPoly(&vertices[0], vertices.size(), false);

    } else {

        lazy_init();

        [shader_ use];
        [shader_ setUniformForModelViewProjectionMatrix];
        [shader_ setUniformLocation:colorLocation_ with4fv:(GLfloat*) &color_.r count:1];

        ccGLEnableVertexAttribs( kCCVertexAttribFlag_Position );

        glVertexAttribPointer(kCCVertexAttrib_Position, 2, GL_FLOAT, GL_FALSE, 0, &vertices[0]);
        glDrawArrays(GL_LINE_STRIP, 0, vertices.size());
    }

    bufferQueue.pop();
    [renderTexture end];
} 
```

# sql - 获取除最后一行之外的最后 n 行的查询

> ID：12003762
> 
> 赞同：4
> 
> 时间：2012-08-17T10:07:13.347
> 
> 标签：sql, sql-server, tsql

我有一张有 400 行的表。我想选择最后 6 行，不包括最后一行。

使用以下代码，我得到最后 6 行，但我不希望最后（第 400 行）存在

```
SELECT * 
FROM ImagesInfo 
WHERE Image_Id IN 
     (    SELECT TOP 6 Image_Id 
          FROM ImagesInfo 
          ORDER BY Image_Id DESC ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:11:29.900

使用`ROW_NUMBER()`语法

```
SELECT * 
from
(
   SELECT *, ROW_NUMBER() over (ORDER By Image_ID) rn
   FROM yourtable 
) v
WHERE rn between x and y 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T10:15:32.237

```
SELECT top 6 *
FROM 
     (    SELECT TOP 7 *
          FROM ImagesInfo 
          ORDER BY Image_Id DESC 
     ) t
ORDER BY Image_Id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-04T21:22:04.367

看看**偏移量**

`SELECT First Name + ' ' + Last Name FROM Employees ORDER BY First Name OFFSET 10 ROWS FETCH NEXT 5 ROWS ONLY;`

[微软 SQL Server 网站]

[http://technet.microsoft.com/en-us/library/gg699618.aspx](http://technet.microsoft.com/en-us/library/gg699618.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T10:20:47.623

```
select top 6 * from image_info 
where image_id not in(select max(image_id) from image_info)
order by image_id desc 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T10:10:14.717

关于什么：

```
SELECT * FROM ImagesInfo
WHERE Image_Id IN (SELECT TOP 6 Image_Id FROM ImagesInfo ORDER BY Image_Id DESC) AND
      Image_Id <> (SELECT TOP 1 Image_Id FROM ImagesInfo ORDER BY Image_Id DESC) 
```

或者

```
SELECT * FROM ImagesInfo
WHERE Image_Id IN (SELECT TOP 6 Image_Id FROM ImagesInfo ORDER BY Image_Id DESC) AND
      Image_Id <> (SELECT MAX(Image_Id) FROM ImagesInfo) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-17T10:10:26.227

如果我理解正确（我不确定）那么你应该能够做到：

```
SELECT * 
FROM ImagesInfo 
WHERE Image_Id IN 
     (    SELECT TOP 7 Image_Id 
          FROM ImagesInfo 
          ORDER BY Image_Id DESC )
     and Image_Id not IN
     (    SELECT TOP 1 Image_ID
          FROM ImagesInfo
          ORDER BY Image_Id DESC ) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-17T10:11:38.673

尝试这个：

您只需从结果集中消除最大记录

```
 SELECT * 
FROM ImagesInfo 
WHERE Image_Id IN 
     (    SELECT TOP 6 Image_Id 
          FROM ImagesInfo 
          where Image_Id<> (select MAX(Image_Id) from ImagesInfo )
          ORDER BY Image_Id DESC ) 
```

**或者**

如果您使用的是**sql server 2005 或更高**版本：您可以使用[ROW_NUMBER()](http://msdn.microsoft.com/en-us/library/ms186734.aspx)和 CTE

```
with cte as(          
 SELECT *,
        ROW_NUMBER() over (order by Image_Id desc) as row_num 
 FROM ImagesInfo)           
 select * from cte where row_num between 2 and 7 
```

# html - 当所有孩子都相同时应用样式

> ID：12003765
> 
> 赞同：2
> 
> 时间：2012-08-17T10:07:19.770
> 
> 标签：html, css, css-selectors, pseudo-class

我有一个罕见的需求：

只有当我有`<ol>`孩子并且没有更多标签时，我才需要样式“list-style：none”。

例如，在这种情况下，我将应用样式：

```
<div>
  <ol><li>1</li></ol>
  <ol><li>2</li></ol>
</div> 
```

在彼此中，我将禁用该样式：

```
 <div>
  <p>
  <ol><li>1</li></ol>
</div> 
```

什么是最好的方法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:51:21.567

This is not possible with pure CSS. You'll have to either modify the HTML to add classes manually, or use a script to determine if there are only `ol` elements inside and no other types of children, then apply the class or the style.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:16:43.567

试试这个。

```
div ol:only-of-type {
    list-style: none;
} 
```

任何只有一个 li 元素的列表现在都应该没有列表样式。

仅与 IE9+ 兼容（以及所有其他）

来源： http: [//net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/](http://net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/)

演示：http: [//jsfiddle.net/RGnJW/](http://jsfiddle.net/RGnJW/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T10:19:49.910

您可以使用以下 CSS：

```
ol li {
    list-style: none;
} 
```

# java - netty的紧密连接

> ID：12003773
> 
> 赞同：1
> 
> 时间：2012-08-17T10:07:50.663
> 
> 标签：java, netty

我有一个使用 的项目，`Netty`但存在一些问题：

如果`connection`闲置一段时间，是否`connection`会自行关闭？如果它自己关闭，我该如何设置关闭时间？

有5个线程，他们发送100个数据。他们使用相同的频道，例如

```
 /** release connect*/
    public void closeConnect(ChannelFuture writeFuture){
    if(writeFuture != null){
        writeFuture.awaitUninterruptibly();
    }
    future.getChannel().close();
    future.getChannel().getCloseFuture().awaitUninterruptibly();
    client.releaseExternalResources();
    }

    //write data
    ChannelFuture future = Channels.write(data);
    closeConnect(future); 
```

上面的代码将产生一个`closeChannelexception`. 我的问题是：*如何避免异常？*

此外，当我`ReadTimeoutHandler`在客户端使用并设置`timeout`= 5s，并使线程休眠 6s 时，就会`ReadTimeoutException`发生。当我调用`e.getChannel().close()`时，它还会创建一个`closeChannelException`. 如何自己处理异常或无异常关闭连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:17:32.960

You could catch `ReadTimeoutException` if the API throws it and then call your `closeConnect(...)`.

Seems to me though, that the channel is already closed; so either just ignore `CloseChannelException` or handle it if it affects the program state.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:08:21.057

试试这个方法：

/** 释放连接*/

```
public void closeConnect(ChannelFuture writeFuture){
if(writeFuture != null){
    writeFuture.awaitUninterruptibly();
}
future.getChannel().getCloseFuture().awaitUninterruptibly();
future.getChannel().close().awaitUninterruptibly();
client.releaseExternalResources();
}

//write data
ChannelFuture future = Channels.write(data);
closeConnect(future); 
```

尝试先关闭 channelFuture，然后再关闭自己的频道。

# c# - 在 C# 程序中嵌入带有值的静态表

> ID：12003784
> 
> 赞同：2
> 
> 时间：2012-08-17T10:08:30.783
> 
> 标签：c#, .net, lookup-tables

我有一个*C# 程序并想在我的程序中使用嵌入式（静态/常量）查找表。该表有 3 列：名称、值、信息和应用程序。200 行包含静态数据。

由于某些原因，我不想使用数据库表。使用表的方法被调用得非常频繁，所以对表的访问也经常而且应该很快。

我的第一个想法是，使用**嵌入式资源**，因为它有 3 列，但问题是，无法通过 ResourceSet 条目访问评论列。

你怎么看，哪些选择是有意义的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:22:11.780

如果您的数据永远不会改变。最快的方法是将它们添加到代码中，否则您可以将它们添加为 csv 格式的嵌入式资源，然后将它们加载到结构/类的静态列表中。

例如：

```
public class MyData{

    public static List<MyData> Items;

    static MyData(){
        Items=new List<MyData>();
        // load items to the list
    }

    public string Name {get;set;}
    public string Value {get;set;}
    public string Info {get;set;}
} 
```

然后，您可以随时使用`MyData.Items`

# api - “保存到foursquare”场地ID？

> ID：12003786
> 
> 赞同：0
> 
> 时间：2012-08-17T10:08:50.207
> 
> 标签：api, foursquare

我注意到即使我打印了从 API 获得的所有信息，“保存到foursquare”也会丢失场地。是否可以将场地 ID 添加到 vcard 部分以确保“保存到foursquare”按钮指向正确的场地？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:26:42.833

是的，请参阅[https://developer.foursquare.com/overview/widgets](https://developer.foursquare.com/overview/widgets)了解有关如何配置保存到foursquare 按钮的详细信息

# c#-4.0 - 设置嵌套母版页的母版

> ID：12003788
> 
> 赞同：1
> 
> 时间：2012-08-17T10:08:56.217
> 
> 标签：c#-4.0, webforms

好的，我有一个母版页和一个继承该母版的嵌套母版页。

所有页面都实现嵌套母版页：

```
MasterPage
     --> NestedMaster
            --> Page1
            --> Page2
            --> etc. 
```

所以我需要动态设置**顶级**母版页。2 个站点在页眉和仅页眉中具有完全不同的布局。

如何在代码中控制它？查看事件层次结构，但这只是说您只能在**页面级别**设置母版页，我有数千页！**这不切实际**。

*我只想在NestedMaster*页面级别和该级别进行一次更改。这可以做到吗？

我试过了：

```
protected override void OnInit(EventArgs e)
{
    this.MasterPageFile = getMasterPath();
    base.OnInit(e);
} 
```

但我只是得到：

> “MasterPageFile”属性只能在“Page_PreInit”事件中或之前设置。

母版页没有`PreInit`事件，烦人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:27:49.260

做了更多的谷歌搜索后，我意识到这是不可能的，因为基类是`Page`，这是第一个被调用的东西，因此你可以指定 PreInit 的唯一地方。上帝我讨厌网络表单。

也就是说，我认为我已经从[http://odetocode.com/Articles/450.aspx](http://odetocode.com/Articles/450.aspx)获得了解决方案。基本上生成一个自定义 HTTPModule：

```
using System;
using System.Web;
using System.Web.UI;

public class MasterPageModule : IHttpModule
{  
    public void Init(HttpApplication context)
    {
        context.PreRequestHandlerExecute += new EventHandler(context_PreRequestHandlerExecute);
    }

    void context_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        Page page = HttpContext.Current.CurrentHandler as Page;
        if (page != null)
        {
            page.PreInit +=new EventHandler(page_PreInit);
        }
    }

    void page_PreInit(object sender, EventArgs e)
    {
        Page page = sender as Page;
        if (page != null)
        {
            page.MasterPageFile = "~/Master1.master";
        }
    }

    public void Dispose()
    {
    }
} 
```

# django - 我的日志中的这些 CONNECT 消息是什么？

> ID：12003789
> 
> 赞同：7
> 
> 时间：2012-08-17T10:08:57.210
> 
> 标签：django, http

我正在玩一个免费的 AWS EC2 实例和 django。

我不小心让我的开发服务器在一夜之间运行（在端口 8080 上）。今天早上，连接日志显示了一些这样的消息：

```
# Me
[16/Aug/2012 19:16:09] "GET /static/img/banner-1.jpg HTTP/1.1" 200 68263
[16/Aug/2012 19:16:09] "GET /static/img/footer.png HTTP/1.1" 200 4261
[16/Aug/2012 19:16:09] "GET /static/img/favicon.ico HTTP/1.1" 200 1150
# Not me
[17/Aug/2012 01:33:59] "GET http://www.baidu.com/ HTTP/1.1" 404 1717
[17/Aug/2012 04:13:29] "GET http://www.google.com/search?hl=en&tbs=qdr:d&prmd=imvns&filter=0&lr=&as_epq=%KEYWORD% HTTP/1.1" 404 1815
[17/Aug/2012 04:13:30] "CONNECT www.google.com:443 HTTP/1.0" 404 1784 
```

这些信息是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-17T13:01:04.963

端口 8080 经常用于 http 代理服务器。一些发现您的开发服务器的机器人尝试将其用作普通代理（前两个`GET`命令），然后用作 https 的透明代理（通过发送启动，`HTTP CONNECT`并解释了它连接到 google 端口 443 的原因）。它正在测试您的服务器是否是开放代理，因为开放代理可用于各种邪恶目的。

# c# - Azure 下载大文件的 GetSharedAccessSignature

> ID：12003790
> 
> 赞同：1
> 
> 时间：2012-08-17T10:09:01.273
> 
> 标签：c#, asp.net, azure, download, azure-storage

通过一个网页，我想让用户下载存储在 Azure 云存储上的（非常大的）文件。我使用 GetSharedAccessSignature 来允许用户下载它（注意：Container 是受保护的，不能公开阅读）。我使用以下代码：

```
// get the file blob
// CloudBlockBlob blob set previously and check (it exists)

        string sas = blob.GetSharedAccessSignature(
            new SharedAccessPolicy() { 
                Permissions = SharedAccessPermissions.Read,
                SharedAccessStartTime = DateTime.Now.AddMinutes(-5),
                SharedAccessExpiryTime = DateTime.Now.AddMinutes(54) 
            });

        Response.Redirect(blob.Attributes.Uri.AbsoluteUri + sas); 
```

除非下载时间超过 1 小时（正如我所说，通过不太好的互联网连接下载非常大的文件...），否则此方法有效。如果下载需要更长的时间，则会发生超时，并且下载会在共享访问过期时间过后停止。

我该如何解决这个问题？

亲切的问候，罗比德萨特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:54:13.707

从代码看来，您实际上是在让浏览器进行下载。在这种情况下，我相信选择是让共享访问签名有效期更长。

另一个想法是让您的代码读取 blob 的块，然后传输这些块。这样，如果需要，您可以创建一个新的 SAS URI，并在 SAS URI 超时已过期且 blob 尚未完全下载时使用它。

看看下面的示例代码。基本上在这个示例中，我有一个 200 MB 的 blob。在循环中，我的代码读取 1 MB 的 blob 块并将该块向下发送。

```
 protected void ButtonDownload_Click(object sender, EventArgs e)
    {
        var blobUri = "http://127.0.0.1:10000/devstoreaccount1/abc/test2.vhd?sr=b&st=2012-08-17T10%3A29%3A46Z&se=2012-08-17T11%3A29%3A46Z&sp=r&sig=dn7cnFhP1xAPIq0gH6klc4nifqgk7jfOgb0hV5Koi4g%3D";
        CloudBlockBlob blockBlob = new CloudBlockBlob(blobUri);
        var blobSize = 200 * 1024 * 1024;
        int blockSize = 1024 * 1024;
        Response.Clear();
        Response.ContentType = "APPLICATION/OCTET-STREAM";
        System.String disHeader = "Attachment; Filename=\"" + blockBlob.Name + "\"";
        Response.AppendHeader("Content-Disposition", disHeader);
        for (long offset = 0; offset < blobSize; offset += blockSize)
        {
            using (var blobStream = blockBlob.OpenRead())
            {
                if ((offset + blockSize) > blobSize)
                    blockSize = (int)(blobSize - offset);
                byte[] buffer = new byte[blockSize];
                blobStream.Read(buffer, 0, buffer.Length);
                Response.BinaryWrite(buffer);
                Response.Flush();
            }
        }
        Response.End();
    } 
```

希望这可以帮助。

# php - mkdir 权限被拒绝

> ID：12003794
> 
> 赞同：5
> 
> 时间：2012-08-17T10:09:10.463
> 
> 标签：php, apache, debian, mkdir

我用来`mkdir()`在我的服务器上创建一个目录：

```
// $var_name is equal to an md5() hash
$path = "/var/www/publish/" . $var_name;
if(mkdir($path)) {
  echo "success";
} else {
  echo "error";
} 
```

由于权限被拒绝，这将产生错误。通过做在我的服务器上查找`ls -lh`

```
drwxr-xr-x  2 root     root   4.0K Aug 17 09:05   publish 
```

但如果 my`$path`等于`$path = "/var/www/" . $var_name;`它将创建我期望的文件夹。这里似乎有什么问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T10:12:12.247

`/var/www/publish`文件夹的权限错误。您需要确保 apache 用户具有创建目录所需的权限。

您可以在其中创建目录，`/var/www/`因为它具有不同的权限。

检查 httpd 进程正在运行的用户的名称以及`chown -R user:group /var/www/publish`该用户/组的名称。在 debian 上，这似乎是 www-data/www-data，因此您需要运行以下命令`chown -R www-data:www-data /var/www/publish`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T10:14:06.297

当将 mkdir() 与 PHP 一起使用时，它由 apache 用户（ubuntu 上的 www-data）执行，您可以使用 chown 在 /var/www 上设置相同的发布权限

在 ubuntu 上：

```
chown www-data.www-data /var/www/publish 
```

问候

咪咪

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:29:31.157

修复发布文件夹的权限（由 root 拥有！）。一种**不安全**的方式：`chmod 777 /var/www/publish`

最好运行 suphp 并将发布文件夹的所有者更改为您的 php 用户（+w 权限）。

# javascript - `$xml = $( xmlDoc )` 有什么作用？

> ID：12003796
> 
> 赞同：3
> 
> 时间：2012-08-17T10:09:18.090
> 
> 标签：javascript, jquery, parsexml

在 javascript / jQuery 中，此[页面](http://api.jquery.com/jQuery.parseXML/)上的示例包含以下我难以理解的代码；

```
var xml = "<rss version='2.0'><channel><title>RSS Title</title></channel></rss>",
    xmlDoc = $.parseXML( xml ),
    $xml = $( xmlDoc ),
    $title = $xml.find( "title" ); 
```

特别是第3行；

```
$xml = $( xmlDoc ) 
```

那有什么作用？这种形式的语法是否有一个我可以通过 Google 搜索到的名称？

此外，在上面的代码中，他们似乎使用了为包含带有美元符号的 jQuery 对象的变量添加前缀的约定。`xmlDoc`但如果是这样的话，那么第二行中的变量不应该是`$xmlDoc`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T10:11:04.123

它基于上面指定的 xml 创建一个 jQuery 对象，使您能够在其上使用 jQuery 的方法来查找节点并操作它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:12:15.937

`$`变量开头的符号纯粹是为了命名约定（jquery 对象）。这是一种提醒您此变量是 jquery 对象的方式，因此可以具有诸如`find()`在其上调用的功能。

`$.parseXML( xml )`不创建 jQuery 对象，它只是使用 jQuery 来解析 XML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:12:07.027

就是用一个普通的对象来构造一个jQuery对象。通过这样做，您可以在其上使用 jQuery 方法。

# android - 安卓振动器不工作

> ID：12003797
> 
> 赞同：0
> 
> 时间：2012-08-17T10:09:26.733
> 
> 标签：android, android-layout

我正在编写一个`Vibrator`不起作用的测试应用程序。我正在使用**Nexus S**运行此代码。

```
public class MainActivity extends Activity {
Button button;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    button = (Button) findViewById(R.id.click_vibrate);
    button.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
             Log.d("me", "onClick");
             Vibrator vibrator = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);
             if(vibrator.hasVibrator()){
                 vibrator.vibrate(300);
                 Log.d("me","has Vibrator");
             }
        }
    });

}
} 
```

我得到的日志为

```
D/me      ( 1552): onClick
D/me      ( 1552): has Vibrator 
```

但相同的代码适用于 android 2.3.6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:19:09.817

尝试这个：

```
Vibrator vibrator = (Vibrator) MainAcitivty.this.getSystemService(Context.VIBRATOR_SERVICE); 
```

# zend-framework - 未找到“Zend_Log”类 - Magento 的 SSH -reindexall

> ID：12003804
> 
> 赞同：0
> 
> 时间：2012-08-17T10:09:49.493
> 
> 标签：zend-framework, shell, magento

就在最近，Magento 后台无法重新索引目录 URL 重写，Magento 产生了非常有用的错误“重新索引过程出现问题”。所以我尝试使用 php ./shell/indexer.php -reindexall 通过 SSH 重新索引并收到以下内容...

警告：包含（Zend/Log.php）：无法打开流：第 93 行的 /home/reprebat/public_html/lib/Varien/Autoload.php 中没有这样的文件或目录

警告：include()：无法在第 93 行的 /home/reprebat/public_html/lib/Varien/Autoload.php 中打开 'Zend/Log.php' 以包含 (include_path='"." ')

致命错误：在第 247 行的 /home/reprebat/public_html/app/code/core/Mage/Core/functions.php 中找不到类“Zend_Log”

这些文件/行中的任何一个似乎都没有任何异常——只是默认的 Magento 文件版本。

我不知道何时发生此问题或触发此错误 - 与我在网上发现的大多数其他类似问题不同，它通常似乎与方法名称不正确的 3rd 方扩展有关......但我们的错误甚至没有指定诸如此类的任何东西——或者任何对我特别有用的东西。

我想没有人可以建议这可能表明什么？非常感谢任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T11:21:20.210

我最终设法解决了这个问题......

.htaccess 文件包括以下内容：-

```
<IfModule mod_php5.c>
php_value include_path "." 
```

通过注释掉，如下所示，这纠正了问题并允许索引器再次成功运行......

```
<IfModule mod_php5.c>
#php_value include_path "." 
```

在这个阶段，我没有意识到任何潜在的影响，尽管考虑到 Magento 1.6.2 文件中提供的默认 .htaccess 不包括这个，我的印象是很少会出现故障或中断。我会用任何新闻更新这个答案。

# python - 线程安全和容错文件写入

> ID：12003805
> 
> 赞同：9
> 
> 时间：2012-08-17T10:09:55.733
> 
> 标签：python, file, thread-safety

我有一个长时间运行的进程，它在一个文件中写入了很多东西。结果应该是全部或全部，所以我正在写入一个临时文件并将其重命名为最后的真实名称。目前，我的代码是这样的：

```
filename = 'whatever'
tmpname = 'whatever' + str(time.time())

with open(tmpname, 'wb') as fp:
    fp.write(stuff)
    fp.write(more stuff)

if os.path.exists(filename):
    os.unlink(filename)
os.rename(tmpname, filename) 
```

我对此不满意有几个原因：

*   如果发生异常，它不会正确清理
*   它忽略了并发问题
*   它不可重复使用（我需要在程序的不同位置使用它）

任何建议如何改进我的代码？有图书馆可以帮助我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-17T14:40:14.153

你可以使用 Python 的`tempfile`模块给你一个临时文件名。它可以以线程安全的方式创建一个临时文件，而不是使用`time.time()`如果同时在多个线程中使用可能返回相同名称的临时文件。

正如对您问题的评论中所建议的那样，这可以与上下文管理器的使用相结合。`tempfile.py`通过查看 Python源代码，您可以了解如何实现您想要做的事情。

下面的代码片段可能会做你想做的事。它使用从`tempfile`.

*   临时文件的创建是线程安全的。
*   成功完成后重命名文件是原子的，至少在 Linux 上是这样。和之间没有单独的检查`os.path.exists()`，`os.rename()`这可能会引入竞争条件。对于 Linux 上的原子重命名，源和目标必须位于同一文件系统上，这就是此代码将临时文件与目标文件放在同一目录中的原因。
*   对于大多数用途，`RenamedTemporaryFile`该类的行为应该像 a `NamedTemporaryFile`，除非使用上下文管理器关闭它，文件被重命名。

样本：

```
import tempfile
import os

class RenamedTemporaryFile(object):
    """
    A temporary file object which will be renamed to the specified
    path on exit.
    """
    def __init__(self, final_path, **kwargs):
        tmpfile_dir = kwargs.pop('dir', None)

        # Put temporary file in the same directory as the location for the
        # final file so that an atomic move into place can occur.

        if tmpfile_dir is None:
            tmpfile_dir = os.path.dirname(final_path)

        self.tmpfile = tempfile.NamedTemporaryFile(dir=tmpfile_dir, **kwargs)
        self.final_path = final_path

    def __getattr__(self, attr):
        """
        Delegate attribute access to the underlying temporary file object.
        """
        return getattr(self.tmpfile, attr)

    def __enter__(self):
        self.tmpfile.__enter__()
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        if exc_type is None:
            self.tmpfile.delete = False
            result = self.tmpfile.__exit__(exc_type, exc_val, exc_tb)
            os.rename(self.tmpfile.name, self.final_path)
        else:
            result = self.tmpfile.__exit__(exc_type, exc_val, exc_tb)

        return result 
```

然后你可以像这样使用它：

```
with RenamedTemporaryFile('whatever') as f:
    f.write('stuff') 
```

在写入过程中，内容转到一个临时文件，退出时文件被重命名。这段代码可能需要一些调整，但总体思路应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-17T20:34:03.243

可靠地将全部或全部写入文件：

```
import os
from contextlib import contextmanager
from tempfile   import NamedTemporaryFile

if not hasattr(os, 'replace'):
    os.replace = os.rename #NOTE: it won't work for existing files on Windows

@contextmanager
def FaultTolerantFile(name):
    dirpath, filename = os.path.split(name)
    # use the same dir for os.rename() to work
    with NamedTemporaryFile(dir=dirpath, prefix=filename, suffix='.tmp') as f:
        yield f
        f.flush()   # libc -> OS
        os.fsync(f) # OS -> disc (note: on OSX it is not enough)
        f.delete = False # don't delete tmp file if `replace()` fails
        f.close()
        os.replace(f.name, name) 
```

另请参阅[没有 fsync() 的 rename() 是否安全？](https://stackoverflow.com/questions/7433057/is-rename-without-fsync-safe)（[@Mihai Stan](https://stackoverflow.com/a/12008004/4279)提到）

### 用法

```
with FaultTolerantFile('very_important_file') as file:
    file.write('either all ')
    file.write('or nothing is written') 
```

要实现缺失[`os.replace()`](http://docs.python.org/dev/library/os#os.replace)，您可以在 Windows 上调用[`MoveFileExW(src, dst, MOVEFILE_REPLACE_EXISTING)`](http://hg.python.org/cpython/file/4610ac42130e/Modules/posixmodule.c#l3982)（通过 win32file 或 ctypes 模块）。

如果有多个线程，您可以`queue.put(data)`从不同的线程调用并在专用线程中写入文件：

```
 for data in iter(queue.get, None):
     file.write(data) 
```

`queue.put(None)`打破循环。

作为替代方案，您可以使用锁（线程、多处理、文件锁）来同步访问：

```
def write(self, data):
    with self.lock:
        self.file.write(data) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-17T14:47:16.840

该`with`构造对于在退出时进行清理很有用，但对于您想要的提交/回滚系统却没有。可以为此使用try **/except/else块。**

您还应该使用标准方法来创建临时文件名，例如使用**tempfile**模块。

并记得[在重命名之前进行 fsync](https://stackoverflow.com/questions/7433057/is-rename-without-fsync-safe)

以下是修改后的完整代码：

```
import time, os, tempfile

def begin_file(filepath):
    (filedir, filename) = os.path.split(filepath)
    tmpfilepath = tempfile.mktemp(prefix=filename+'_', dir=filedir)
    return open(os.path.join(filedir, tmpfilepath), 'wb') 

def commit_file(f):
    tmppath = f.name
    (filedir, tmpname) = os.path.split(tmppath)
    origpath = os.path.join(filedir,tmpname.split('_')[0])

    os.fsync(f.fileno())
    f.close()

    if os.path.exists(origpath):
        os.unlink(origpath)
    os.rename(tmppath, origpath)

def rollback_file(f):
    tmppath = f.name
    f.close()
    os.unlink(tmppath)

fp = begin_file('whatever')
try:
    fp.write('stuff')
except:
    rollback_file(fp)
    raise
else:
    commit_file(fp) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T10:31:37.460

您可以在写入文件时使用[lockfile 模块锁定文件。](http://packages.python.org/lockfile/lockfile.html)任何后续锁定它的尝试都会阻塞，直到前一个进程/线程的锁被释放。

```
from lockfile import FileLock
with FileLock(filename):
    #open your file here.... 
```

这样，您可以避免并发问题，并且在发生异常时不必清理任何剩余文件。

# java - 415 RESTful Web 服务中不支持的媒体类型

> ID：12003811
> 
> 赞同：0
> 
> 时间：2012-08-17T10:10:06.667
> 
> 标签：java, rest

我编写了一个返回单词列表的 RESTful Web 服务。Word 类被注释为根元素。

我在休息客户端上对此进行了测试，它生成了 415 Unsupported MediaType。任何人都可以帮助其他必须做的事情才能使其发挥作用。

```
@POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    @Path("getCategoryWordListFromJSON")
    public List<Word> getLearnWordListByCategory(JSONObject jsonObject) {
        List<Word> wordList = new ArrayList<Word>();
        try {
            String category = (String) jsonObject.get("category");
            LOGGER.log(Level.INFO, category);
            LearnWordListDao wordListDao = new LearnWordListDaoImpl();
            wordList.addAll(wordListDao.getCategoryListFor(category));
        } catch (JSONException e) {
            LOGGER.log(Level.INFO, e.getMessage());
        }
        return wordList;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T13:18:59.743

HiAllwyn,

There are many ways of returning of the List. Here it will not able to parse into the List object as provided in your code. Please try this.... it works.... :)

```
@POST
@Produces({MediaType.APPLICATION_JSON,MediaType.APPLICATION_XML})
@Consumes(MediaType.APPLICATION_JSON)
@Path("getCategoryWordListFromJSON")
public Response getLearnWordListByCategory(JSONObject jsonObject) {
    List<Word> wordList = new ArrayList<Word>();
    try {
        String category = (String) jsonObject.get("category");
        LOGGER.log(Level.INFO, category);
        LearnWordListDao wordListDao = new LearnWordListDaoImpl();
        wordList.addAll(wordListDao.getCategoryListFor(category));
    } catch (JSONException e) {
        LOGGER.log(Level.INFO, e.getMessage());
    }

final GenericEntity<List<Word>> entity = new GenericEntity<List<Word>>(wordList) { };
       return Response.ok().entity(entity).build();

} 
```

# visual-studio-2010 - 保持相关窗口（例如 XML Schema Explorer）打开

> ID：12003812
> 
> 赞同：4
> 
> 时间：2012-08-17T10:10:07.833
> 
> 标签：visual-studio-2010, visual-studio

在 VS 2010（或更高版本）中，当您更改活动文件时，有没有办法让依赖窗口（或您称之为仅在打开某种类型的文件时才打开的窗口）不关闭？可能有插件吗？

我正在将 XML 模式中的属性写到一个类中，并且每次移动到代码文件时都关闭 XML 模式浏览​​器非常烦人，即使模式设计器在另一个屏幕上可见（但不是活动的文件）。

# eclipse - 如何使用终端在 Ubuntu 12.04 上安装最新版本的 Eclipse Classic？

> ID：12003815
> 
> 赞同：9
> 
> 时间：2012-08-17T10:10:22.193
> 
> 标签：eclipse, ubuntu, installation, terminal, ubuntu-12.04

请问如何使用终端在 Ubuntu 12.04 上安装最新的 Eclipse Classic (4.2)？如果您能一步一步指导我，我将不胜感激。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-05-20T07:48:05.017

**步骤 1 »**安装 java JDK 或 JRE

```
sudo apt-get install openjdk-7-jdk 
```

**第 2 步 »**从此处下载最新副本 [http://www.eclipse.org/downloads/?osType=linux](http://www.eclipse.org/downloads/?osType=linux)

**步骤 3 »**将下载的包移动到 /opt 目录

```
sudo mv eclipse-SDK-4.2.2-linux-gtk.tar.gz /opt 
```

**第 4 步 »**解压缩包

```
sudo tar -xvf /opt/eclipse-SDK-4.2.2-linux-gtk.tar.gz -C /opt 
```

**第 5 步 »**在**/usr/share/applications/**中创建一个新的桌面文件***eclipse.desktop***并添加以下行。

 **```
[Desktop Entry]
Name=Eclipse 
Type=Application
Exec=/opt/eclipse/eclipse
Terminal=false
Icon=/opt/eclipse/icon.xpm
Comment=Integrated Development Environment
NoDisplay=false
Categories=Development;IDE
Name[en]=eclipse.desktop 
```

**第 6 步 »**只需将此**eclipse.desktop**文件拖到启动器。

检查此链接：[在 ubuntu 12.04 中安装 eclipse](http://www.krizna.com/ubuntu/install-eclipse-in-ubuntu-12-04/ "在 ubuntu 12.04 中安装 eclipse")

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-17T10:25:27.133

有关分步说明，请参阅[此处](http://blog.brunobraga.net/eclipse-42-in-ubuntu-1204)的此博客文章。

该过程已逐步记录在案，并且作者在评论中包含了一个脚本-

```
#!/bin/sh

ECLIPSE=/usr/lib/eclipse/eclipse

inject_update_site(){
if [ ! -e "$1" ] ; then
echo "W: Cannot find $1" 2>&1
return 1
fi
cat - >>"$1" <<EOF
repositories/http\:__download.eclipse.org_releases_indigo/enabled=true
repositories/http\:__download.eclipse.org_releases_indigo/isSystem=false
repositories/http\:__download.eclipse.org_releases_indigo/nickname=Indigo Update Site
repositories/http\:__download.eclipse.org_releases_indigo/uri=http\://download.eclipse.org/releases/indigo/
EOF

}

if [ ! -d ~/.eclipse/ ] ; then
$ECLIPSE -clean -initialize || exit $?
artifact=$(find ~/.eclipse \
-regex .*/profileRegistry/.*/org.eclipse.equinox.p2.artifact.repository.prefs)
metadata=$(find ~/.eclipse \
-regex .*/profileRegistry/.*/org.eclipse.equinox.p2.metadata.repository.prefs)
if [ -z "$artifact" ] || [ -z "$metadata" ]; then
echo "W: Cannot inject update-sites, cannot find the correct config." 2>&1
else
( inject_update_site "$artifact" && \
inject_update_site "$metadata" && \
echo "I: Injected update sites" ) || echo "W: Could not inject update sites." 2>&1
fi
fi

exec $ECLIPSE "$@" 
```

哪个有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T14:28:05.387

确保在执行 tar 命令之前 cd 到 /opt 文件夹。如果您不这样做，那么 tar 命令将在您当前的目录中创建 eclipse 目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-03T01:02:55.010

安装 java JDK 或 JRE 后运行以下命令，它将为您安装 eclipse，

sudo apt-get install eclipse**

# iphone - 在 Tabbar 应用程序中添加导航栏

> ID：12003816
> 
> 赞同：-6
> 
> 时间：2012-08-17T10:10:25.500
> 
> 标签：iphone, objective-c, ios, ios-simulator

> **可能重复：**
> [带有导航控制器的标签栏应用程序](https://stackoverflow.com/questions/369128/tab-bar-application-with-navigation-controller)

我的 Xcode 版本是 4.3.2。我想在基于标签栏的应用程序中添加导航栏。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:23:37.660

在您的`applicationDidFinishLaunching`方法中，您可以看到类似

```
FirstViewController *firstViewController = [[FirstViewController alloc] initWithNibName:@"FirstViewController" bundle:nil];
.
.
.   

self.tabBarController = [[UITabBarController alloc] init];
self.tabBarController.viewControllers = [NSArray arrayWithObjects:firstViewController, secondViewController, nil]; 
```

将对象添加`FirstViewController`到`UINavigationController`对象如下

```
UINavigationController *firstNavController = [[UINavigationController alloc] initWithRootViewController:firstViewController];
.
.
.
//And in the tabbarController array add the navigationController Object instaed if FirstViewControllerObject
 self.tabBarController.viewControllers = [NSArray arrayWithObjects:firstNavController, secondViewController, nil]; 
```

它完成了。现在您`FirstViewController`将被视为 navigationController 并且它将具有导航栏。

**编辑**

如果您只想要导航栏，那么您可以将其插入`xib`或添加`UINavigationBar`为子视图`self.view`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T10:18:07.120

例如，您可以使用情节提要来制作它。

![ss](../Images/99edd5c86786606365eedb21b513ea1e.png)

# css - IE7-显示：内联提交按钮在选择输入扩展时不会更改位置

> ID：12003818
> 
> 赞同：3
> 
> 时间：2012-08-17T10:10:27.193
> 
> 标签：css, internet-explorer-7, position

我有一个根据其内容（PHP 的动态内容）扩展的选择框。提交按钮的位置在 IE7 中保持固定，但如图所示。

![IE7位置问题](../Images/c707fc54e9acc235b4f1bf6c80831bac.png)

我尝试添加缩放：1，并应用位置：相对于两个选择框和提交按钮无济于事。

在 Firebug 中，如果我取消选择并重新选择任何 css 选项，它会正确重新定位。有没有人有任何修复的想法？

HTML -

```
<div class="filter">
            <form name="input" action="#" method="post" title="Submit">
                <span class="purple">Filter photography by:</span>

                <select id="search_type" name="brand_filter">
                    <option value="0">No filter</option>
                    <option value="1" <?= ($this->session->userdata('selected_brand_filter') == 1) ? 'selected="selected"' : ''?>>Brand</option>
                    <option value="2" <?= ($this->session->userdata('selected_brand_filter') == 2) ? 'selected="selected"' : ''?>>Hotel/Location</option>
                    <option value="3" <?= ($this->session->userdata('selected_brand_filter') == 3) ? 'selected="selected"' : ''?>>Region</option>
                    <option value="4" <?= ($this->session->userdata('selected_brand_filter') == 4) ? 'selected="selected"' : ''?>>Event</option>
                </select>
                <select id="search_category" name="category_filter">
                    <option value="0">Nothing selected</option>
                    <? if(!empty($category_filter)): ?>
                            <? foreach($category_filter as $catg): ?>
                                    <option value="<?=$catg->id?>" <?= ($this->session->userdata('selected_category_filter') == $catg->id) ? 'selected="selected"' : ''?>><?= $catg->name ?></option>
                            <? endforeach ?>
                    <? endif ?>
                </select>
                <input type="submit" value="" id="filter-submit"/>
            </form>
        </div> 
```

CSS -

```
#filter-submit{
width:20px;
height:20px;
background: url('../images/filter_submit.jpg') no-repeat;
border:none;
cursor:pointer;
vertical-align:middle; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:14:30.310

你还支持IE7？我也感受到你的痛苦。

我认为最好的办法是将它放在一个表格或一系列 div 标签中。

我在 IE 中发现的另一件事是调整父容器中的内容，例如为周围的 div 设置宽度可能会起作用。有时，提交按钮之类的指定宽度需要所有父对象中的指定宽度。（奇怪我知道）

抱歉，它太模糊了，我通过反复试验解决了所有这些问题，并且只是对 IE 发誓，因为它不像其他浏览器那样符合 Web 标准。

将您的组件放入单独的 div 或表格列中肯定会解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T11:07:11.067

好的，所以我通过设置一个短计时器并动态更改 CSS 属性找到了 JS/JQuery 解决方法。它不漂亮但似乎有效，除非其他人有更好的建议

```
$(document).ready(function() {        
    $('#search_type').change(function(){
        filtertimer = setTimeout('timeout_trigger()', 100);
    });
});

function timeout_trigger(){
    $('#filter-submit').css({'display':'block'});
    $('#filter-submit').css({'display':'inline'});
    clearTimeout(filtertimer);
} 
```

# python - python：将方法导出为关闭对象的函数

> ID：12003820
> 
> 赞同：2
> 
> 时间：2012-08-17T10:10:38.287
> 
> 标签：python, lambda, closures, partial, functools

在 python 中，我想将对象方法导出为普通函数。该对象将被关闭。如下所示：

```
from functools import partial

class A(object):
    def __init__(self,a):
        self.a = a

    def m(self,b):
        return self.a+b

    def exportm(self):
        return lambda b,self=self: self.m(b)
        #return partial(self.m,self=self)

f = A(10).exportm()

print f(5) 
```

这很好用，可以按预期打印 15。但是，如果我将 return-lambda-line 替换为注释行，它将失败并出现以下错误：

```
TypeError: m() got multiple values for keyword argument 'self' 
```

我知道使用 functools 比使用 lambda 表达式更干净。所以我想知道如何使用functools中的部分或其他工具来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T10:17:51.993

`self.m`已经绑定了，所以没有必要传递`self=self`给它。简单地返回`self.m`。如需更多参数，请使用`partial(self.m, ...)`：

```
class A(object):
    def __init__(self, a):
        self.a = a

    def m(self, b, c):
        return self.a + b + c

    def exportm(self):
        return partial(self.m, 300)

f = A(10).exportm()
print f(5) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:22:19.410

遵循[KISS原则](http://en.wikipedia.org/wiki/KISS_principle)。没有必要使用让你的代码看起来更专业的东西。正如 thg435 已经说过`return self.m`的那样。

你的代码越简洁，理解它就越容易，无论是你自己，当你阅读你的代码时，比如一个月，还是其他开发人员。

# netbeans - 项目的后台扫描减慢 Netbeans 7.2

> ID：12003822
> 
> 赞同：5
> 
> 时间：2012-08-17T10:10:49.677
> 
> 标签：netbeans, netbeans-7

我有最新的 Java 和 JDK。我有一个 PHP 项目（CodeIgniter）。当我在 NetBeans 7.2 中打开它时，我无法摆脱“项目的后台扫描”。这是什么？我怎样才能加速它？我怎样才能禁用它？

**[当前解决方案]**当您在 NetBeans 中打开一个新项目时，这种情况只会发生一次。后来“项目的背景扫描”工作 10-15 秒。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T12:21:43.940

我找到了一个解决方案，但是它有一些缺点。使用***按需扫描****插件*。重新启动 Netbeans 后，默认情况下应禁用后台扫描。使用*更新中心*安装方法，并在安装后禁用存储库（否则您可能最终会错误地安装不稳定的更新）。

**缺点**：索引可能已经过时，这使得使用 Netbeans 不太舒服（*如插件页面所述*）。

[按需扫描 - 下载和安装说明](http://wiki.netbeans.org/ScanOnDemand)

**编辑：**错误仍然存​​在，但是使用以下内容会使性能下降成为一个较小的问题。将此字符串添加到`netbeans_default_options`您的**netbeans.conf**：

```
-J-XX:+UseConcMarkSweepGC -J-XX:+CMSClassUnloadingEnabled -J-XX:+CMSPermGenSweepingEnabled 
```

在 Win7、64b 机器、NB 7.2、JDK 1.703 上为我工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-04T08:21:03.873

转到源文件夹并删除“nbproject”文件夹。但这不允许项目在 NetBeans 中显示，无论如何这是最好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-09T18:01:27.280

对于具有大量文件的项目，后台扫描可能需要很长时间。与其花费宝贵的时间让 netbeans 停止扫描您的文件，不如将一些文件移到项目的根目录之外。这样netbeans就不会看到它们，因此不会扫描它们:)

此外，为了进一步简化 netbeans 的后台扫描，如果您使用 git 等版本控制，您可能希望告诉 netbeans*忽略（右键单击 > Git > 忽略）某些目录。*这样，netbeans 就不会检查这些目录上的外部更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-27T09:17:01.030

即使使用@Mateng 推荐的netbeans_default_options，我已经使用过，Netbeans 7.2.1 及更高版本（至少到 Netbeans 8 版本）（没有尝试早期版本）在“大”项目上变得*非常*慢，因为很长背景扫描。代码完成在 10 秒内完成，等等。

因此，我仔细查看了日志，发现有很多与[“代码缓存”](https://stackoverflow.com/questions/7513185/what-is-reservedcodecachesize)耗尽相关的警告。

所以，我使用增加了代码缓存大小

```
-J-XX:ReservedCodeCacheSize=<big value> 
```

所有的缓慢都消失了。

希望这可以帮助 ！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-07T13:08:17.853

您可能只想在工具 > 选项 > 杂项 > 文件中通过取消勾选“启用源的自动扫描”来禁用它，就像[在这个答案中](https://stackoverflow.com/a/18077173/785897)提到的那样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-28T18:18:05.210

这是多年前的一个非常古老的问题，但我还没有在这里看到这个修复。

[https://www.samundra.com.np/solved-netbeans-long-running-project-scan/1246/1246](https://www.samundra.com.np/solved-netbeans-long-running-project-scan/1246/1246)

这将引导您向 netbeans 配置文件添加命令。您将需要具有管理员权限才能更改配置文件，因此您可能需要弄清楚如何在 win 10、8、7 或 vista 中实现这一点......可以在这里找到（它被隐藏得更深一点最近。）您可以在此处获取执行此操作的说明：

[https://www.howtogeek.com/howto/windows-vista/enable-the-hidden-administrator-account-on-windows-vista/](https://www.howtogeek.com/howto/windows-vista/enable-the-hidden-administrator-account-on-windows-vista/)

阅读 www.samundra.com.np 链接，看看您是否想尝试这个解决方案。我试过了，它似乎显着加快了扫描速度......没有禁用扫描（提到的解决方案，可能不稳定）......并且没有使用禁用补丁（也提到，也可能不稳定。）

到目前为止，它对我来说效果很好，并且不是上面提到的常见解决方案之一。不确定我的资源中是否有任何递归链接，例如页面提到的，但是，这仍然显着加快了扫描速度。所以，看看这是否是你想尝试的方法。如果您也想查看，可以在此处找到参与错误报告的人员。它涉及一个挂起的递归侦听器，并且没有完全一起行动，所以......您正在添加一个配置行来禁用侦听器。

[https://bz.apache.org/netbeans/show_bug.cgi?id=207214](https://bz.apache.org/netbeans/show_bug.cgi?id=207214)

确保在正确的位置添加该行。对我来说，它位于 netbeans_default_options 旁边的 loooong 行的末尾。确保将行放在结尾引号内。

看看这是否是您想尝试的东西，而不是这个问题中提到的其他修复。干杯。这种挂起肯定会很烦人！我在 netbeans 版本中做到了这一点。11.2

# sql-server - Sybase 在执行计划中是否有索引查找操作（如 SQL Server）？

> ID：12003825
> 
> 赞同：2
> 
> 时间：2012-08-17T10:10:55.657
> 
> 标签：sql-server, sap-ase, seek, non-clustered-index

我是试图优化 Sybase 查询的 SQL Server 开发人员。我正在尝试寻找非聚集索引，但它一直在进行扫描，只是想确认在 Sybase 中是否可以“寻找”如果是，如何实现非聚集索引寻找？

我有一个如下查询（* 实际上是大约 32 列）

SELECT t.* FROM dbo.g1_positions t WHERE t.source_date = (select max(source_date) from g1_positions)

我在表上有 3 个非聚集索引（无聚集索引），如下所示

1.  列 entity_id、bgnref、retnum、source_date 上名为 primary_key 的索引
2.  列 entity_id、source_date 上名为 idx_entdte 的索引
3.  bgnref、source_date 列上名为 idx_bgndte 的索引

内部查询（计算最大值对 idx_entdte 进行索引扫描），外部索引默认执行表扫描，如果我强制索引它执行索引扫描和一些额外的事情，由“使用 I/O 大小 2 KB 的数据”描述页。使用 MRU 缓冲区替换策略的数据页。”

我的猜测是这相当于我们在 SQL Server 中的“查找”。强制索引后，我看不到性能提升，我只是想知道我能做些什么来提高性能。

我无法对表进行任何更改，例如创建/删除/修改索引。

只是为了让您了解 SQL Server 工作中的查找。

假设我们有包含 4 条记录的 Employee 表。

![在此处输入图像描述](../Images/c74cd29da2756dd892d8555debc619b1.png)

如果查询在 Emp_id 上使用非集群索引，它将到达叶节点并获取实际数据将使用指针来读取堆上的实际数据（行）。这个使用指针的过程称为 LookUp

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:14:03.683

**这是可能的！**

如果它不使用它应该是因为表扫描更好。那可能是因为统计数据关闭了！[也更新它们。](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.commands/html/commands/commands93.htm)

如果需要，您可以强制使用索引，有关更多信息，请查看[此示例](http://www.rocket99.com/techref/sybase8685.html)。

# git - 如何防止 git push 除非我在那个分支上签出，否则不会推动？

> ID：12003826
> 
> 赞同：9
> 
> 时间：2012-08-17T10:10:56.147
> 
> 标签：git

我遇到的问题是我的手指会自动键入`git push origin master`. 如果我正在工作`new-branch`并且打算输入`git push origin new-branch`并且有未推送的更改，`master`它们将被意外推送。有什么方法可以防止这种情况，以便我只能推入和推出当前分支？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-17T10:22:49.287

`git push`如果没有给出 refspec，`push.default`您可以使用`git-config`. 根据您的情况提供三种模式：

> ,和模式适用于那些想要在完成工作后推出单个分支的人`simple`，即使其他分支尚未准备好推出。`current``upstream`

请注意，此设置仅在没有给出 refspec 时生效，即在`git push`没有进一步参数的情况下运行。`git push origin master`仍然会推`master`到`origin`.

根据经验，您应该始终创建单独的工作分支，并且永远不要将中间结果提交到您的主分支。[`git flow`](https://github.com/nvie/gitflow)简化了这个工作流程。

从[文档](http://git-scm.com/docs/git-config)中：

> **`push.default`**
> 
> 定义`git push`如果在命令行上没有给出 refspec，在远程没有配置 refspec，并且命令行上给出的任何选项都没有暗示 refspec 时应该采取的操作。可能的值为：
> 
> *   `nothing`- 不要推任何东西。
>     
>     
> *   `matching`- 将所有具有相同名称的分支推入两端。这适用于那些将所有分支准备成可发布的形状，然后用一个命令将它们推出的人。它不适合推送到由多个用户共享的存储库，因为如果其他用户更新了分支，本地停滞的分支将尝试非快进推送。+ 这是目前的默认值，但 Git 2.0 会将默认值更改为`simple`.
>     
>     
> *   `upstream`- 将当前分支推送到其上游分支（`tracking`这是不推荐使用的同义词）。这样，将更新与由、making和symmetric`git push`合并的远程引用相同的远程引用。有关如何配置上游分支的信息，请参阅“branch..merge”。`git pull``push``pull`
>     
>     
> *   `simple`-like `upstream`，但如果上游分支的名称与本地分支不同，则拒绝推送。这是最安全的选择，非常适合初学者。它将成为 Git 2.0 中的默认设置。
>     
>     
> *   `current`- 将当前分支推送到同名分支。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-17T12:31:24.617

您想将 git 升级到 1.7.11 或更高版本，并使用“简单”push.default：

```
o    simple - like upstream, but refuses to push if the upstream branch's name is different from the local one. This is the safest option and is
     well-suited for beginners. It will become the default in Git 2.0. 
```

这将准确地防止您的问题。请注意，它也将成为 Git 2.0 中的默认选项。您可以通过以下方式启用它：

```
git config push.default simple 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-17T10:18:59.793

您可以创建一个别名，例如`gitpushcurrent`，指向`git push origin $(git branch | grep "*" | sed "s/* //")`.

然后重新训练您的手指以自动键入`gitpushcurrent`而不是`git push origin master`. 因此，您无需考虑当前分支是什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T10:42:17.703

我用了几天的 Git，但是，顺便说一下，你可以：

1.  注意你用键盘输入的内容。Git 功能强大，而且，如果您的手指训练有素，可以自动输入任何内容，您可能会造成很大的损失，例如删除您的工作分支，或者在您不想要的时候合并分支。始终要小心。

2.  为您的命令使用[别名](https://git.wiki.kernel.org/index.php/Aliases)。它们非常强大，可以节省您的时间，防止您制作您并不真正想要的东西。

3.  阅读一些有趣且有用的主题，例如[这个](https://stackoverflow.com/questions/527833/how-to-configure-git-to-avoid-accidental-git-push)SO question 或[这个](https://serverfault.com/questions/274728/git-prevent-push-to-master)关于 ServerFault 的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-21T19:06:31.720

git -g config push.default 当前

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-02T20:02:21.883

[这个问题与“确认 git push 命令](https://stackoverflow.com/questions/6839853/confirmation-of-git-push-command)”非常相似

而且，我也将在这里提出[相同的解决方案。](https://stackoverflow.com/a/26168583/767680)

您所需要的只是将提交预挂钩到受保护的分支（如“master”）中。

[这个关于“如何防止推送到大师”的](http://dev.ghost.org/prevent-master-push/)博客应该可以帮助你。

PS：需要 GIT 版本 1.8.2 或更高版本。

# php - fpdi tcpdf 层级管理？

> ID：12003829
> 
> 赞同：3
> 
> 时间：2012-08-17T10:11:21.747
> 
> 标签：php, tcpdf, fpdi

我使用 FPDI 和 TCPDF 库通过绘制透明矩形来编辑现有的 pdf 文件。

```
$pdf = new FPDI(); 
$pagecount = $pdf->setSourceFile('my.pdf'); 
$unserialized = unserialize($questionaire['cordinates']); 
for ($page_counter = 1; $page_counter <= $pagecount; $page_counter++) {
    $tplidx = $pdf->ImportPage($page_counter);
    $s = $pdf->getTemplatesize($tplidx);
    $pdf->AddPage($s['h'] > $s['w'] ? 'P' : 'L', array($s['w'], $s['h']));
    $pdf->useTemplate($tplidx, 0, 0, 0, 0, true);

    for ($i = 0; $i < sizeof($unserialized); $i++) {
        $selection = (object)$unserialized[$i];
        if ($page_counter == $selection->current_frame) {
            switch ($selection->type) {
                case "Rect":
                    $pdf->SetAlpha(0.3);
                    $color = int2rgb($selection->select_color);
                    $pdf->Rect(($selection->left), ($selection->top), ($selection->width), ($selection->height), 'F', NULL, $color);
                            break;
                    case "Comment":
                        break;
            }
        }
    }
} 
```

**问题是**：
矩形覆盖文本，因此在读取输出 pdf 文件时无法选择它。TCPDF 中有层方法，但我只能用它对元素进行分组并管理它们的可见性。
一些 pdf 文件还包含文本元素，其他包含图像 - 页面快照。

**问题：**
是否可以将导入页面的流设置为顶层并绘制矩形作为下层，或作为背景？
如何识别导入的 pdf 包含文本元素或图像？

# php - 连接消息接收和消息发送脚本

> ID：12003833
> 
> 赞同：1
> 
> 时间：2012-08-17T10:11:35.173
> 
> 标签：php, sockets

我开发了一个类似聊天的应用程序，我的服务器应该用 PHP 编写，客户端应该是被动的，只是监听数据。

现在我想从两个脚本开始：send.php 和 server.php

send.php 提供 REST API 以通过 GET 接口向另一个客户端发送消息。

server.php 应该是一个接受来自客户端的连接的 TCP 服务器，以便通过套接字发送数据，目前基于[http://php.net/manual/en/sockets.examples.php](http://php.net/manual/en/sockets.examples.php)，所以现在只有客户端连接到他，他发回一些测试字符串。

我的问题是我应该以某种方式连接 send.php 和 server.php 以便当通过 send.php server.php 推送消息时实际上会发送它。

我怎么做？

我想一个选择是将推送的消息存储在服务器存储中并检查 server.php 中的新消息，但我担心它太耗费资源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T05:49:21.560

**解决方案 1。**

我以我最初建议的方式解决了我的问题，这意味着我使 server.php 处于活动状态，因此它每秒检查一次新信息：

```
function getNewMessages()
{
    $arrOfMessages = array();
    $selectQuery = "SELECT * FROM messages WHERE unread=1";
    $result = mysql_query($selectQuery);
    return $arrOfMessages;
}

if(count($newMessages) > 0)
{ ... } 
```

意识到每秒执行一次 SELECT 并不是一件容易的事。

**解决方案 2。**

我猜另一种方法是这样的：

*   server.php 接受有关客户端 IP 的数据并将其绑定到用户会话；
*   将其存储在数据库中；send.php 打开与客户端的新连接并向其发送消息。

这样，消息将在发送者客户端通过 REST 接口“发送”后立即发送到客户端，不会在任何地方运行检查循环。您甚至可以让您的 server.php（顺便说一句，此解决方案中的标题会产生误导）通过 REST 接口接受 IP，因此不需要额外的 TCP/UDP 连接。

**解决方案 3。**

如今，许多客户端（如 iOS）都有推送通知系统，如果客户端每天收到的消息不多，最好的方法是通过推送通知来传递它们。这样您就不必拥有低级网络连接，REST 接口就足够了。

# php - 将 url 中的 JSON 转换为字符串

> ID：12003838
> 
> 赞同：-2
> 
> 时间：2012-08-17T10:11:58.177
> 
> 标签：php, json, string, echo

[http://api-public.addthis.com/url/shares.json?url=http://google.com](http://api-public.addthis.com/url/shares.json?url=http://google.com)

我需要将共享数量作为 php 字符串获取。（回声）

有什么简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:14:39.197

```
$ret = json_decode(file_get_contents('http://api-public.addthis.com/url/shares.json?url=http://google.com'), true);
echo $ret['shares']; 
```

# sql-server-2008 - 将美国时间更改为意大利时间

> ID：12003844
> 
> 赞同：0
> 
> 时间：2012-08-17T10:12:11.397
> 
> 标签：sql-server-2008

我有一个问题，我的数据库服务器在美国，而我的用户在意大利。当它插入我的网站时，显示的是美国时间。我必须使用 getdate() 函数从数据库中检索日期。所以我将美国时间更改为意大利时间到我的数据库中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:17:55.260

根据[CAST 和 CONVERT 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/ms187928.aspx)，转换样式没有。105 代表意大利 - 所以试试：

```
SELECT CONVERT(VARCHAR(50), GETDATE(), 105) 
```

但是在您的 SQL Server 数据库表中，它始终存储为`DATETIME`（我希望！），并且`DATETIME`没有任何*格式*或与之相关的任何内容 - 它只是一个 8 字节的数值。所以你绝对不应该对**存储**数据做任何事情——只有当你**显示它**（使用 a`SELECT`或其他东西）时，你必须确保以正确的格式输出它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:15:32.393

日期格式与数据库[Collat​​ion](http://msdn.microsoft.com/en-us/library/ms144260%28v=sql.105%29.aspx)相关。

设置数据库后更改排序规则并非易事。

以下是[MSDN](http://technet.microsoft.com/en-us/library/ms179254%28SQL.100%29.aspx)的说明：

> ```
> Make sure you have all the information or scripts needed to re-create your user databases and all the objects in them.
> 
> Export all your data using a tool such as the bcp Utility. For more information, see Importing and Exporting Bulk Data.
> 
> Drop all the user databases.
> 
> Rebuild the master database specifying the new collation in the SQLCOLLATION property of the setup command. For example:
> 
> Setup /QUIET /ACTION=REBUILDDATABASE /INSTANCENAME=InstanceName 
> /SQLSYSADMINACCOUNTS=accounts /[ SAPWD= StrongPassword ] 
> /SQLCOLLATION=CollationName
> 
> For more information, see Rebuilding System Databases.
> 
> Create all the databases and all the objects in them.
> 
> Import all your data. 
> ```

否则，您需要将日期从数据库中取出后转换为所需的格式。如果您可能会显示多种日期格式，那么无论如何您都需要这样做。这通常在应用层而不是 SQL 中完成。

# iphone - Objective-C - 传递多个参数

> ID：12003848
> 
> 赞同：0
> 
> 时间：2012-08-17T10:12:25.757
> 
> 标签：iphone, objective-c, cocoa-touch

所以到目前为止，我只会通过按钮标签传递我需要的任何参数。但是，现在我已经将标签用于其他用途，因此当您选择按钮时，我需要能够将另一个字符串和带有标签的计时器值传递给 void 或某种动作。

这是我当前用于将按钮标签传递给操作的按钮代码（下）

```
[mybtn addTarget:self action:@selector(action:) forControlEvents:UIControlEventTouchUpInside]; 
```

这是我传递给它的空白或动作。

```
-(void)action:(UIButton*)btn{
NSLog(@"%d", [btn tag]);
} 
```

那么有没有一种方法可以将按钮标签（如字符串）传递给动作？所以我可以有这样的东西。

```
-(void)action:(UIButton*)btn :myString{
NSLog(@"%d %@", [btn tag], myString);
} 
```

**编辑：** 所以现在多亏了这个建议，我的 void 看起来像这样

```
-(void)actionWithButton:(UIButton *)btn andString:(NSString *)myString{
NSLog(@"%d %@", [btn tag], myString);
} 
```

但我仍然不知道如何在按钮的@selector 部分传递 myString 参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:48:50.537

您可以将 UILable 作为子视图添加到该按钮，例如

```
 UILabel *lblValue = [[UILabel alloc]initWithFrame:CGRectMake(0,0,0,0)];
 lblValue.tag=2;
 lblValue.text = myString;
 [objInputButton addSubview:lblValue]; 
```

然后你在你的 Action 方法中得到你的字符串，如下所示

```
 -(void)action:(UIButton*)btn
     {
     for(UILabel *lable in [btn subViews])
         {
              if([lable tag]==2)
                   {
                         //get your string from lable
                   }
         }
     } 
```

**编辑：-** 我的这个答案是在我开始我的职业生涯时发布的，即使它完成了工作，它也是传递数据的不好方式，所以，最好遵循我发布的其他答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T11:16:14.503

[本文档](https://developer.apple.com/library/mac/#documentation/General/Conceptual/Devpedia-CocoaApp/TargetAction.html)是您了解如何将操作发布到目标的良好开端。

你可以看到目标选择器只能是三个不同的：

```
- (IBAction)action;
- (IBAction)action:(id)sender;
- (IBAction)action:(id)sender forEvent:(UIEvent *)event; 
```

你不能接收任何其他类型的参数，因为你只是一个接收者，**你不会调用这些方法**。

我很确定为什么在调用它们时要“通过”（您的意思是：接收）任何字符串。用户交互指示**何时**让它们被调用以及在调用这些方法中的任何一个时，您必须拥有足以响应用户请求的所有数据。一个简单的用户点击不会创建任何您需要接收的额外字符串，但您会获得有关触摸事件的信息。

我强烈建议您找到有关*MVC 工作原理*的好教程。

* * *

`NSInteger`但是，您可以通过 的`tag`属性发布一个简单的值`UIButton`，当您创建它时，`UIButton`您可以设置`tag`它，并且您可以在执行其中一种方法时读取它`tag`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:18:52.437

你应该这样做：

```
-(void)actionWithButton:(UIButton *)button andString:(NSString *)myString{
    //code
} 
```

我建议你阅读 Objective-c 的基本介绍（[苹果开发者库](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/ObjectiveC/Introduction/introObjectiveC.html)非常好！或者如果你想要一本书，我强烈推荐[Stephen Kochan 的书](https://rads.stackoverflow.com/amzn/click/com/0321811909)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T10:21:29.420

如果 UIButton 的类型是自定义的，则可以有一个带有文本的图像。然后按钮的*titleLabel*属性可以用于文本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-09T08:48:14.670

如果您唯一的要求是在事件（touchupinside）分派时从按钮中检索一些标签以外的信息，那么您可以子类化 UIButton，然后分配您想要与按钮一起使用的任何信息，以便您以后可以获取它。

可能你可以像下面这样使用

```
-(void)action:(CustomButton*)btn{
      NSLog(@"%d %@", [btn tag], btn.value); // assuming CustomButton is a derived class of UIButton
} 
```

# jsf-2 - 丰富：pickList 在添加/删除操作后失去其排序顺序

> ID：12003849
> 
> 赞同：1
> 
> 时间：2012-08-17T10:12:32.020
> 
> 标签：jsf-2, richfaces

我将 Richfaces 4.2.2 与 JSF2 一起使用，并具有以下选项列表代码：

```
<rich:pickList id="internationalTransactionCountriesPicklist"
    value="#{currentRuleItem.ruleControls.GeographicControl.selectedValues}"
    sourceCaption="#{msg.AvailableCountries}"
    targetCaption="#{msg.SelectedCountries}"
    addText="#{msg.picklistSelectItemButtonLabel}"
    addAllText="#{msg.picklistSelectAllItemButtonLabel}"
    removeText="#{msg.picklistDeselectItemButtonLabel}"
    removeAllText="#{msg.picklistDeselectAllItemButtonLabel}"
    listHeight="150px"
    disabled="#{userSettings.userIsReadOnly}"
    readonly="#{userSettings.userIsReadOnly}">
    <f:ajax event="additems" render="@this"  execute="@this" />
    <f:ajax event="removeitems" render="@this" execute="@this" />
    <f:selectItems value="#{controls.fullCountryList}" 
        var="country" itemValue="#{country.countryCode}"
        itemLabel="#{country.displayName}" itemLabelEscaped="true" />                   
</rich:pickList> 
```

*controls.fullCountryList*是自定义国家对象的列表。自定义国家类实现了 Comparable 接口。

当我将源列表中的项目添加到目标列表中，然后从目标列表中删除该项目时，会出现问题。

当它被添加回源列表时，它会被放在源列表的底部（未在源列表中按最初的字母顺序排序）。

有谁知道解决这个问题的任何方法？

[这里](https://issues.jboss.org/browse/RF-4308?focusedCommentId=12712163#comment-12712163)有一个针对 RF3 的错误

谢谢

# jquery - jQuery假碰撞检测

> ID：12003850
> 
> 赞同：0
> 
> 时间：2012-08-17T10:12:32.067
> 
> 标签：jquery, html, collision-detection

好的，所以我有一个奇怪的情况。

在一个网站上，我被要求添加页脚永远不应与侧导航重叠的功能。有时这会发生在较小的分辨率上（但不会小到改变媒体查询。）

所以我尝试了 jQuery 元素碰撞检测，但这在固定位置元素上似乎是不可能的。所以现在我在想可能有一种方法可以获取文档高度、页脚高度和导航高度。使用 .scroll()（或 .scrollTo()，我不确定）检测我在文档中的位置，当页脚顶部到达导航底部时，更改导航的位置。

但现在我被困在如何实际编码这个：D

那么如何让 jQuery 比较高度并根据此计算我在文档中的位置？

值得注意的是，不幸的是我不能编辑太多的网站布局。

[这是我的小提琴](http://jsfiddle.net/Kyle_Sevenoaks/645tC/7/)。

这[是实时站点](http://www.lebara.no/kundeservice/)（如果您更改分辨率并向下滚动，您可以看到重叠。）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:28:29.050

给你！[工作脚本](http://jsfiddle.net/645tC/15/)非常简单。但是这个想法只有在页脚具有绝对位置并且菜单固定时才有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:15:34.370

也许这样的事情可能是一个起点：[http](http://ryanfait.com/sticky-footer/) ://ryanfait.com/sticky-footer/ 它只是 html 和 css。

# scala - Scala - 元组类型推断失败？

> ID：12003854
> 
> 赞同：3
> 
> 时间：2012-08-17T10:12:37.700
> 
> 标签：scala, tuples, type-inference

> **可能重复：**
> [将元组添加到集合中不起作用](https://stackoverflow.com/questions/11825765/adding-a-tuple-to-a-set-does-not-work)

我有这个代码：

```
class A

var buffer = Buffer[(A, Int)]() 
```

然后，某处：

```
val a = new A
buffer += (a, 0) // error 
```

当我必须通过时`a`，类型推断器无法`(a, 0)`告诉我通过：`A``(A, Int)`

```
scala> def make {
     | val a = new A
     | buffer += (a, 0)
     | }
<console>:11: error: type mismatch;
 found   : A
 required: (A, Int)
       buffer += (a, 0)
              ^ 
```

但是，如果我这样做：

```
val a = new A
val tuple = (a, 0)
buffer += tuple 
```

错误消失了。这是某种错误还是我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T10:22:14.723

编译器不知道您是指 buffer.+=(a,0) 还是 buffer += Tuple2(a,0) 。

可能的解决方案：

```
buffer += Tuple2(a, 0)

buffer += Pair(a, 0) // Pair is an alias for Tuple2

buffer += ((a, 0))

buffer += a -> 0 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T10:22:53.637

可能编译器的信息有些误导。关键是它`buffer += (a, 0)`被取消了`buffer.+=(a, 0)`，就像你可以看到对两个参数函数的调用一样`+=`。您需要的是单个参数函数，因此要解决您的问题，只需将元组放在额外的大括号中，如下所示：

```
 buffer += ((a, 0)) 
```

或使用如下糖对语法：

```
 buffer += (a -> 0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T13:39:10.190

请记住，+= 只是最后的函数调用。函数“+=”具有以下签名：

```
abstract def +=(elem: A): Buffer.this.type 
```

因此编译器将解释以下内容，就好像您将两个参数传递给 "+=" 函数，而不是传递一个元组给它。

```
buffer += (a, 0) // error 
```

解决方案是有一个嵌套括号，从而使编译器清楚您正在传递一个元组：

```
scala> buffer += ((new A(), 0))
res2: scala.collection.mutable.Buffer[(A, Int)] = ArrayBuffer((A@16fe464e,0), (A@6774c043,0)) 
```

# android - 安卓。在我的应用中显示和更改网页内容

> ID：12003856
> 
> 赞同：0
> 
> 时间：2012-08-17T10:12:44.707
> 
> 标签：android

是否可以在我的应用程序中打开网页并更改网页内容？删除/添加/修改它的内容？用 Java 做类似于浏览器扩展的东西，但用应用程序完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:20:30.760

在 android Webviews 中，您可以调用 javascript 函数。

```
webView.loadUrl("javascript:testEcho('Hello World!')"); 
```

如果网页是您的，您可以添加特定于应用程序的功能，这些功能将在 web 视图中调用。

如果您正在谈论更改任何网页的内容。我不确定，但我认为唯一的方法是在内部加载文件，进行修改并显示您更改的本地 url。

# php - mysql 服务器在 PDO 中消失了

> ID：12003857
> 
> 赞同：2
> 
> 时间：2012-08-17T10:12:58.870
> 
> 标签：php, mysql, pdo, ping, reconnect

我正在运行我的 php 脚本并遇到间歇性问题：

PHP 致命错误：未捕获的异常 'PDOException' 带有消息'SQLSTATE [HY000]：一般错误：2013 查询期间丢失与 MySQL 服务器的连接'

如果出现此类错误，是否可以在 PDO 中 ping mysql？

我只是想在您的通知中提到这一点，即我的 PDO 连接不是持久的。我正在循环连接 PDO。我想每次新连接都会循环打开。如果是这样，那么为什么 mysql 会失去连接？或者，如果 PDO 连接已经存在，那么它可能会提供现有的 pdo 对象。但是如果发生这样的错误，它应该尝试重新连接并给出新的连接而不是错误。

任何可能的解决方案来避免错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-16T11:17:55.450

就我而言，PDO 采用单个连接，如果循环大小很大，则连接超时。所以，我增加了所有cli的PDO连接超时。

```
$this->connection = new PDO($this->dsn, $this->username, $this->password);
//Increase the session time out for all cli's
if(php_sapi_name() == 'cli'){
      $query = $this->connection->prepare("set session wait_timeout=10000,interactive_timeout=10000,net_read_timeout=10000");
      $query->execute();
} 
```

问题现已解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:39:15.467

我建议在 try..catch 块中运行数据库查询，如下所示：

```
try {
    $dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass);
    // Do something here
} catch (PDOException $e) {
    print "Error!: " . $e->getMessage();
    die();
} 
```

# php - 提交表单后刷新div？

> ID：12003861
> 
> 赞同：0
> 
> 时间：2012-08-17T10:13:12.450
> 
> 标签：php, jquery, mysql, forms, refresh

我有一个表格，其中包含从数据库中的数据中提取的结果（库存产品数量）。用户可以使用带有 2 个按钮（一个用于添加，一个用于减去）的表单来添加和减去库存。结果在同一页的同一张表中。

我希望看到的是提交后立即更新的结果。

因此，我使用以下代码：

```
 $(function() {       //run when the document's ready, elements are loaded
  $("form").submit(function() {
    $("#resultaten").load(location.href + " #resultaten > *");
  });
}); 
```

整个表在 id 'resultaten' 中。当我有一张图片并使用以下代码时，它确实有效（但仅在用户点击图片后，而不是在提交时）

```
$(function() {       //run when the document's ready, elements are loaded
  $("#image").click(function() {
    $("#resultaten").load(location.href + " #resultaten > *");
  });
}); 
```

有没有人知道如何使这项工作？

我的完整 HTML：

```
$con = mysql_connect("localhost","xx","xx");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("aantal", $con);

$result = mysql_query("SELECT * FROM voorraad");

echo "<div id='resultaten'><table border='1'>
<tr>
<th>Product</th>
<th>Aantal</th>
<th>Aantal erbij/eraf</th>
<th>Erbij</th>
<th>Eraf</th>
</tr>";

while($row = mysql_fetch_array($result))
  {
  echo "<form name='form' method='post'><tr>";
  echo "<td>" . $row['product'] . "</td>";
  echo "<td class='aantal-" . $row['stock'] . "'>" . $row['stock'] . "</td>";
  echo "<td><input type='text' name='aantal'></td>";
  echo "<td><input class='vernieuwknop' type='submit' name='add' value='+'></td>";
  echo "<td><input class='vernieuwknop' type='submit' name='subtract' value='-'></td>";
  echo "<td><input style='display: none;' type='text' name='idtje' value='" . $row['id'] . "'></td>";
  echo "</tr></form>";
  }
echo "</table></div>";

if(isset($_POST['add'])){
    $add=$_POST['aantal'];
    $idtje=$_POST['idtje'];
    $query="update voorraad set stock=stock+$add where id=$idtje";
    mysql_query($query) or die("Cannot update");
}
if(isset($_POST['subtract'])){
    $subtract=$_POST['aantal'];
    $idtje=$_POST['idtje'];
    $query="update voorraad set stock=stock-$subtract where id=$idtje";
    mysql_query($query) or die("Cannot update");
}

mysql_close($con); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:23:28.687

正如您所说，当您单击图像时，它会重新加载`div`正确但不是表单的提交事件。问题 - 您的页面必须在提交表单后刷新。`return false`如果是这种情况，那么您必须通过在函数末尾放置来禁用默认表单提交。

```
 $("#image").click(function() {
    $("#resultaten").load(location.href + " #resultaten > *");
    return false;
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:24:04.190

您应该考虑将 PHP 代码放在单独的 php 文件中，以便可以从您所在的任何页面调用它并显示在 DIV 中。

您可以在修改发生后使用innerHTML，而不是使用加载

因此，在您对库存进行更改后，重新运行查询以显示更新的信息。

**AJAX**

```
var stockDisplay = document.getElementById('stockDiv');
stockDisplay.innerHTML = queryResult; 
```

`queryResult`要插入 DIV 的格式化 HTML在哪里。

但是，如果您要显示的是大量 HTML，那么这将不合适，但是如果它像您发布的内容一样简单，那么它将很好地工作，并且它将在不重新加载页面的情况下更新 DIV。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:28:24.777

就像*codef0rmer*说的那样，您正在使用刷新页面的提交功能。

submit(function()) - 刷新页面，除非你把 return false;

click(function()) - 不刷新页面

您可以使用单击功能进行提交，而不是手动提交和处理输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T12:40:51.963

你也可以尝试这样的事情。

抱歉，我还没有真正完成或测试它，但它应该让你走上正确的轨道

**索引.PHP**

```
<HTML>
<BODY>

Some content here

<div id='resultaten'>
<?PHP
$con = mysql_connect("localhost","xx","xx");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("aantal", $con);

$result = mysql_query("SELECT * FROM voorraad");

echo "<table border='1'>
<tr>
<th>Product</th>
<th>Aantal</th>
<th>Aantal erbij/eraf</th>
<th>Erbij</th>
<th>Eraf</th>
</tr>";

while($row = mysql_fetch_array($result))
  {
    echo "<form name='form' method='post'><tr>
    <td>".$row['product']."</td>
    <td class='aantal-".$row['stock']."'>".$row['stock']."</td>
    <td><input type='text' name='aantal'></td>
    <td><input class='vernieuwknop' type='button' name='add' value='+'  onclick=\"addFunc('".$row['id']."')\"></td>
    <td><input class='vernieuwknop' type='button' name='subtract' value='-'  onclick=\"subFunc('".$row['id']".')\"></td>
    </tr></form>";
  }
echo "</table>";

mysql_close($con);
?>
</div>

More Content if you want....

<script type="text/javascript">

function addFunc(rowID) {
    $.ajax({
    type: "GET",
    url: "update.php?add=+?idtje="+ rowID ,
    success: function(html) {
    if(html){       
        $("#resultaten").innerHTML=html;
        }
    }
    });
}

function subFunc(rowID) {
    $.ajax({
    type: "GET",
    url: "update.php?subtract=-?idtje="+ rowID ,
    success: function(html) {
    if(html){       
        $("#resultaten").innerHTML=html;
        }
    }
    });
}

</script>

</BODY>
</HTML> 
```

**更新.PHP**

```
<?PHP
$con = mysql_connect("localhost","xx","xx");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("aantal", $con);

if(isset($_POST['add'])){
    $add=$_POST['aantal'];
    $idtje=$_POST['idtje'];
    $query="update voorraad set stock=stock+$add where id=$idtje";
    mysql_query($query) or die("Cannot update");
}
if(isset($_POST['subtract'])){
    $subtract=$_POST['aantal'];
    $idtje=$_POST['idtje'];
    $query="update voorraad set stock=stock-$subtract where id=$idtje";
    mysql_query($query) or die("Cannot update");
}    

$result = mysql_query("SELECT * FROM voorraad");

echo "<table border='1'>
<tr>
<th>Product</th>
<th>Aantal</th>
<th>Aantal erbij/eraf</th>
<th>Erbij</th>
<th>Eraf</th>
</tr>";

while($row = mysql_fetch_array($result))
  {
    echo "<form name='form' method='post'><tr>
    <td>".$row['product']."</td>
    <td class='aantal-".$row['stock']."'>" .$row['stock']."</td>
    <td><input type='text' name='aantal'></td>
    <td><input class='vernieuwknop' type='button' name='add' value='+'  onclick=\"addFunc('".$row['id']."')\"></td>
    <td><input class='vernieuwknop' type='button' name='subtract' value='-'  onclick=\"subFunc('".$row['id']".')\"></td>
    </tr></form>";
  }
echo "</table>";

mysql_close($con);
?> 
```

# c# - 你如何知道你的 c# 应用程序正在使用哪个 dll？

> ID：12003863
> 
> 赞同：1
> 
> 时间：2012-08-17T10:13:21.633
> 
> 标签：c#, dll, .net-assembly

我有一个使用 .dll 的应用程序，该应用程序在位置 x 中充满了 gui 应用程序代码。它曾经有 1 个按钮，但现在有 2 个。

当我启动我的应用程序时，我希望看到一个带有 2 个按钮的 gui，但是我看到一个带有 1 个按钮的 gui。我已经重建了我的 gui .dll，但它神奇地使用了某个地方的旧版本。如果我尝试调试我的代码，它会说我使用的代码版本与 .dll 中的不同

我的问题是，“我怎样才能找到它在哪里寻找 .dll 以及为什么它会使用旧版本，因为我只有 1 个地方可以将 .dll 编译到？”

还想说明我引用了它，它是正确的版本，其中有 2 个按钮。但是当我运行它时使用的是另一个版本？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:17:37.733

If you are using Visual Studio open the Modules window, Debug->Windows->Modules (Ctrl-D+M) and this will list all loaded assemblies.

You can also at run time use AppDomain.CurrentDomain.GetAssemblies() and walk the list looking at each Assembly.CodeBase.

If all else fails you can also use ProcessMonitor from sysinternals [http://technet.microsoft.com/en-us/sysinternals/bb896645](http://technet.microsoft.com/en-us/sysinternals/bb896645) and watch which dlls are loaded by your process, but you'll be filtering out tons of output.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:19:14.787

如果您正在调试，您可以打开**Modules**窗口（**Debug** > **Windows** > **Modules**）。这将向您显示加载到您的进程中的所有可执行文件，包括名称和完整路径。然后，您应该能够确定从何处加载了过期的 DLL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:16:19.957

您可以尝试在命名空间中使用[反射](http://www.codeproject.com/Articles/17269/Reflection-in-C-Tutorial)`System.Reflection`：

```
var assembly = Assembly.Load("your-assembly-name"); 
```

然后检查`assembly`对象的版本信息。

# android - 如何在android中保持标签状态

> ID：12003869
> 
> 赞同：0
> 
> 时间：2012-08-17T10:13:43.783
> 
> 标签：android

我有两个包含两个不同内容的选项卡。

*   Tab1->视频流
*   Tab2->列表视图。

单击一个`listview`项目时，我将转到详细信息页面`activity`。按下后退时，它将移回`listview`井中。但在后台，正在播放视频（Tab1 内容）。如何阻止这种情况？

我的代码：

...

```
public void onCreate(Bundle savedInstanceState) {
        // sets the Bundle
        super.onCreate(savedInstanceState);
        // sets the context
        setContentView(R.layout.videostream);
        myVideoView = (VideoView) findViewById(R.id.vview);
        mProgress = new ProgressDialog(this);

        PlayVideo();

    }

    private void PlayVideo() {
        try {

            mProgress = ProgressDialog.show(VideoActivity.this, "",
                    "Buffering video...", true);
            mProgress.setCancelable(true);

            myVideoView.setVideoURI(Uri.parse(vSource));
            myVideoView.setMediaController(new MediaController(this));
            myVideoView.requestFocus();
            myVideoView.setOnPreparedListener(new OnPreparedListener() {

                public void onPrepared(MediaPlayer mp) {
                    mProgress.dismiss();
                    myVideoView.start();
                }
            });

         } catch (Exception e) {

            mProgress.dismiss();
            System.out.println("Video Play Error :" + e.toString());
            finish();

        }

    }

    public void onSaveInstanceState(Bundle outState) {

        mStartTime = myVideoView.getCurrentPosition();
        outState.putInt("restartTime", mStartTime);
        super.onSaveInstanceState(outState);
    }

    @Override
    public void onRestoreInstanceState(Bundle savedInstanceState) {
        super.onRestoreInstanceState(savedInstanceState);
        myInt = savedInstanceState.getInt("restartTime");
        myVideoView.seekTo(myInt);

        myVideoView.start();

    }

    @Override
    public void onConfigurationChanged(Configuration newConfig) {

        super.onConfigurationChanged(newConfig);

       // 2 means landscape and 1 means portait mode
       if (newConfig.orientation == 2) {
           mProgress.dismiss();

       }

    }
    @Override
    public void onPause() {
        super.onPause();

        myVideoView.stopPlayback();

    }
    @Override
      public void onResume() {
            super.onResume();

            PlayVideo();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:22:17.953

在列表的 onItemClickListener 中暂停视频并在 onResume() 中恢复

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T12:23:30.087

桑杰，你可以做一件事，你有两个选项卡。一个包含视频，另一个包含列表视图，当你从一个选项卡移动到另一个选项卡时，你的第一个活动进入 onPause，当你回来时，第一个活动将是 onresume。所以，我认为你必须在 onResume() 中播放视频并在 onPause() 中停止它。

如果它有效，请告诉我。

# java - 变量名与哈希函数有什么关系？

> ID：12003871
> 
> 赞同：2
> 
> 时间：2012-08-17T10:13:46.983
> 
> 标签：java, hash, hashtable, hash-function

[来自 MIT recitation](http://courses.csail.mit.edu/6.006/spring11/rec/rec05.pdf)的良好散列函数的属性：

1.  （大约）满足简单统一散列的假设：每个键都有可能散列到 m 个槽中的任何一个。
2.  散列函数不应该偏向于特定的槽不会将相似的键散列到同一个槽（例如编译器的符号表不应该将变量 i 和 j 散列到同一个槽，因为它们经常结合使用）
3.  计算速度很快，应该有 O(1) 运行时间
4.  是确定性的。对于给定的 k，h(k) 应该始终返回相同的值

有人可以进一步解释第 2 点。变量名与散列函数有什么关系？

**编辑**：我使用 Java。因此，如果答案包含使用 java 语义的解释，那对我来说没问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:17:53.973

由于哈希表通常用于构建编译器用来查找符号信息（例如变量名和函数名）的查找表，因此使用编译器场景来解释 #2 的要点。

作者取了一对在同一个程序中很常见的变量名`i`和`j`，并说表示这些变量名称的字符串`"i"`和`"j"`，不应该散列到同一个槽中。这是有道理的，因为解决哈希冲突是查找过程中对速度影响最大的部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T10:15:35.947

要点建议编译器使用[称为符号表的东西](http://en.wikipedia.org/wiki/Symbol_table)，它是从变量名称到有关该变量的信息的映射，实现为哈希表。

许多编译器都是如此。

# iphone - 闪屏后立即显示 modalVIewController

> ID：12003872
> 
> 赞同：0
> 
> 时间：2012-08-17T10:13:49.540
> 
> 标签：iphone

使用 iOS 5。目的是在初始屏幕视图上放置一个按钮，这是无法完成的，因为 Default.png 是静态图像，所以我正在做的是在第一个 Viewcontroller 出现时显示一个 modalViewController。这恰好是由 TabController 托管的 ViewController。问题是，一旦 Splash 屏幕消失并显示 SplashViewController（具有相同的图像但处于活动状态），用户就可以简要地看到下面的视图。

我正在使用 presentModalViewController 来显示活动的初始视图。有什么办法可以摆脱这个故障，我在底层 viewcontroller 的 viewWillAppear 方法中调用 presentModalViewController 。我认为我需要以某种方式比这更早地显示活动的初始屏幕

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T13:33:06.440

是的，你可以做到——我的应用程序正是这样做的。我所做的是在“didFinishLaunchingWithOptions:”中，我首先在 UIImageView 中添加了相同的启动图像作为窗口的子视图：

```
UIImageView *launchView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Default.png"]];
UIImageView *normalView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:<shorter version of launch image, allowing space for activity bar]];

[window addSubview:launchView];
if(isMember) {
    [window addSubview:normalView];
    normalView.alpha = 0; 

    [UIView animateWithDuration:0.25 animations:^
        {
            launchView.alpha    = 0;
            normalView.alpha    = 1; 
        }
        completion:^(BOOL finished)
        {
            [launchView removeFromSuperview];
        } ];
}

[window makeKeyAndVisible]; 
```

然后添加tabbarcontroller，即带有一个rootViewController的导航控制器。您可以将 viewController 和 modalController backgroundColor 设置为 clearColor - 您将不得不玩弄这个。

# java - 频繁修改的 Java（并发）HashMap 性能

> ID：12003875
> 
> 赞同：3
> 
> 时间：2012-08-17T10:14:00.663
> 
> 标签：java, map

我使用 ConcurrentHashMap（键：字符串，值：自定义对象）作为我的数据结构之一。该地图包含大约 300,000 个对象，并且会经常更新（每分钟大约 20,000 个放置和 20,000 个删除）。

看来，整个程序在大约 1 小时后变慢了。有人可以告诉我 ConcurrentHashMap 是否是为频繁修改而设计的，或者是否有更适合我要求的替代方案？

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:38:36.933

我已经`ConcurrentHashMap`在生产中使用了许多作者/读者@> 100,000 读/写每分钟。我们让系统运行了好几天，但我从未遇到过由于`ConcurrentHashMap`.

如果您的代码在一小时后变慢，我首先怀疑是由于内存泄漏导致的 GC 开销。如果我是你，我会将 jvisualvm 连接到你的应用程序。并监视内存/ CPU 使用情况并从那里开始。

# ruby-on-rails - Heroku：rails：获取“没有要加载的文件-URI（LoadError）”

> ID：12003878
> 
> 赞同：1
> 
> 时间：2012-08-17T10:14:17.450
> 
> 标签：ruby-on-rails, ruby, heroku

刚开始将 heroku 与 rails 应用程序一起使用，但我无法启动 rails 应用程序。

Heroku 上的 Ruby 版本...

$ heroku 运行“ruby -v”

```
Running `ruby -v` attached to terminal... up, run.1
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux] 
```

$ heroku ps

```
=== web: `bundle exec thin start -R config.ru -e $RAILS_ENV -p $PORT`
web.1: crashed for 6m 
```

$ heroku 日志

```
2012-08-17T10:06:49+00:00 heroku[web.1]: State changed from crashed to starting
2012-08-17T10:06:52+00:00 heroku[web.1]: Starting process with command `bundle exec thin start -R config.ru -e production -p 31657`
2012-08-17T10:06:54+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-08-17T10:06:54+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-08-17T10:06:56+00:00 app[web.1]: Connecting to database specified by DATABASE_URL
2012-08-17T10:06:57+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:317:in `rescue in depend_on': No such file to load -- URI (LoadError)
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:312:in `depend_on'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:225:in `require_dependency'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:438:in `block in eager_load!'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:438:in `each'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:436:in `each'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:436:in `eager_load!'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/initializable.rb:30:in `instance_exec'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/initializable.rb:30:in `run'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/initializable.rb:55:in `block in run_initializers'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/initializable.rb:54:in `each'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/config/environment.rb:5:in `<top (required)>'
2012-08-17T10:06:57+00:00 app[web.1]:   from config.ru:3:in `require'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/initializable.rb:54:in `run_initializers'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:136:in `initialize!'
2012-08-17T10:06:57+00:00 app[web.1]:   from config.ru:3:in `block in <main>'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
2012-08-17T10:06:57+00:00 app[web.1]:   from config.ru:1:in `new'
2012-08-17T10:06:57+00:00 app[web.1]:   from config.ru:1:in `<main>'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:181:in `load_rackup_config'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/rack/adapter/loader.rb:33:in `eval'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:185:in `run_command'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:71:in `start'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/rack/adapter/loader.rb:33:in `load'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:151:in `run!'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/bin/thin:6:in `<top (required)>'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:23:in `load'
2012-08-17T10:06:57+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:23:in `<main>'
2012-08-17T10:06:58+00:00 heroku[web.1]: Process exited with status 1
2012-08-17T10:06:58+00:00 heroku[web.1]: State changed from starting to crashed
2012-08-17T10:07:00+00:00 heroku[router]: Error H10 (App crashed) -> GET boiling-bayou-5291.herokuapp.com/ dyno= queue= wait= service= status=503 bytes=
2012-08-17T10:07:00+00:00 heroku[router]: Error H10 (App crashed) -> GET boiling-bayou-5291.herokuapp.com/favicon.ico dyno= queue= wait= service= status=503 bytes= 
```

罪魁祸首似乎如下：

```
2012-08-17T10:06:57+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:317:in `rescue in depend_on': No such file to load -- URI (LoadError) 
```

显然，加载“URI”模块存在问题。

问题是缺少什么？而且heroku报告的ruby版本是1.9.3，那为什么在上面的日志中我看到“1.9.1”。这是问题的一部分吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-07T11:18:25.640

作为记录，Mac OS X 文件系统默认不区分大小写，而 Linux 文件系统则区分大小写。因此`URI`和`uri`在 Mac 上是相同的，而`require 'URI'`在 Linux 上会失败，因为您要查找的文件称为`uri`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T18:11:10.990

发现问题...

我在我的代码中使用了 require 'URI' ...如果我将其更改为 require 'uri' 它适用于heroku。

需要明确的是，require 'URI' 正在我的本地开发环境中工作。

# c# - 在 ASP.NET 中创建后退按钮

> ID：12003879
> 
> 赞同：4
> 
> 时间：2012-08-17T10:14:18.007
> 
> 标签：c#, asp.net, .net, asp.net-1.1

我有一个旧应用程序，其中包含许多网络表单。在每一`aspx`页上都有一个指定的后退按钮，它将用户带到上一页。所有按钮都将 javascript`onclick`事件设置为`history.back()`.

在其中`aspx`一页上，后退按钮根本不起作用。我们决定使用一个服务器端按钮来完成同样的事情。按钮的 onclick 事件具有将用户带到上一页的必要代码。

首先我通过以下方式创建了onclick事件，但是后退按钮根本不起作用。当我进入调试模式时，我发现该`prevPage`变量保存的是当前页面 URL，而不是前一页面 URL。

```
private void btnBack_Click(object sender, System.EventArgs e)
{
    string prevPage = Request.UrlReferrer.ToString();
    Response.Redirect(prevPage);
} 
```

然后我将其更改`prevPage`为静态变量，并将其值定义为在`if(!IsPostBack)`块内设置。现在后退按钮工作正常。

```
static string prevPage = string.Empty;
private void Page_Load(object sender, System.EventArgs e)
{
    if(!IsPostBack)
    {
        prevPage = Request.UrlReferrer.ToString();
    }
}

private void btnBack_Click()
{
    Response.Redirect(prevPage);
} 
```

我不明白为什么第一次尝试行不通，为什么第二次尝试行不通。

我有一种感觉，这可以解释这个特定页面是否还有其他事情也不会让`history.back()`or`history.go(-1)`工作。

您能否对此提供一些见解？

编辑：我使用的是 IE8。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:19:33.367

第一次尝试不起作用，因为当您单击按钮时，回发已经发生，因此引荐来源网址是来自按钮的网址（您所在的页面）。

在我看来，我不会向服务器发送请求以将页面推回一个级别，这是一个不必要的请求，因为它可以在客户端更快地实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T10:35:29.690

伙计，不要使用静态变量来存储以前的 URL。它将在所有会话之间共享，如果您的页面可以从不同的地方实现，用户会感到困惑。如果你想跟踪最后一页，`Session`是你最好的朋友。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-28T13:55:29.760

```
JavaScript:window.history.go(-2);return false; 
```

这就是您所需要的，将其放入 onclientclick 或简单地放入锚标记中。您需要单击两次，因为第一次单击将带您进入确认提交页面。

# java - 在正则表达式中自定义边界字符

> ID：12003881
> 
> 赞同：0
> 
> 时间：2012-08-17T10:14:22.803
> 
> 标签：java, regex, word-boundary

我发现它`\b`用于捕获正则表达式中的边界字符。

就像正则表达式`\bnull\b`和输入一样，`,null,`它会捕获`null`，输入`.null.`也会捕获`null`

我想告诉`\b`它应该只捕获`,null,`输入的空值，而不应该考虑`-null-` `.null.`等的空值

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:21:24.113

**编辑：**由于您在上面的评论中添加了信息，因此更新了我的答案。在提问时，请尽量提供所有必要的信息以了解问题。

要匹配 中的空值`null,raheel,email`，`raheel,email,null`并且`,null,`不匹配`null`除逗号以外的任何其他相邻字符，您可以使用：

```
(?:^|,)null(?:,|$) 
```

[在这里](http://regexr.com?31s5t)亲自看看。

**另一个更新：**又是新信息...

要同时匹配 中的空值`null,null,null`，您可以使用：

```
(?<=,|^)null(?=,|$) 
```

[在这里](http://regexr.com?31s60)亲自看看。

# html - 选择框文本在 Firefox 中处于顶部

> ID：12003882
> 
> 赞同：0
> 
> 时间：2012-08-17T10:14:22.953
> 
> 标签：html, css, firefox, google-chrome

我在下面有一个 HTML 代码。

```
<div style="height:300px; width:300px; background:#000 ">
 <div style="padding:30px">
   <select id="keywordsearch" class="upperslect">
       <option value="1">ABC</option>
       <option value="2" >Def</option>
       <option value="3" selected="selected">Select Box</option>
       <option value="4">GGGG</option>  
    </select>
  </div>
 </div> 
```

下面的CSS是

```
.upperslect 
{ 
    font-family:Tahoma; 
    color:#6C6C6C;
    border: none; 
    background:#FFFFFF; 
    font-family:Arial; 
    font-size:12px; 
    width:155px; 
    height:26px;
    margin:0px;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

 } 
```

但是我在所有两个浏览器（Mozilla，Chrome）上都得到了奇怪的输出。请参阅下面的图片。

![在此处输入图像描述](../Images/cade4edd79a6f374a1f772d08d6ffa5f.png) 铬图片

![在此处输入图像描述](../Images/a134b87557d4812b4bc24506e8b02c29.png) Mozilla 火狐图片

谁能告诉我如何解决这个问题。镀铬图片实际上是正确的。我也尝试过填充，但填充选择框数组正在下降。

除此之外，我试图在选择框上放置背景图像，但我无法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:25:43.773

选择上的一些填充并调整选择高度以补偿填充应该可以解决问题：

[http://jsfiddle.net/pYg8v/](http://jsfiddle.net/pYg8v/)

# jquery - 从 onBefore 内部更改偏移量 - LocalScroll jQuery 插件

> ID：12003886
> 
> 赞同：1
> 
> 时间：2012-08-17T10:14:36.987
> 
> 标签：jquery, offset, scrollto

我正在使用 Ariel Flesler 的 localScroll 插件，一切正常。不过我有一个问题。我不知道如何从 onBefore 中更改偏移参数。

例如

```
$('#menu').localScroll({

    hash: true,
    offset: {
        top: -60,
        left: 0
    },
    onBefore: function(e, anchor, $target) {
        if (something) {
            offset.top = -100;
        }
    }

});​ 
```

如果有人可以提供帮助，我将不胜感激：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T15:24:39.063

该`onBefore`设置可用于`this.someSetting`将值返回给设置。

[Ariel Flesler：jQuery.LocalScroll](http://flesler.blogspot.com/2007/10/jquerylocalscroll-10.html)

考虑到这一点，您可以执行以下操作：

```
$('#htmlObject').localScroll({
     onBefore: function(){
          if(something){
               this.offset = someNumber;
          }
     }
}); 
```

因此，您已经拥有的解决方案几乎可以工作，您只需将您的替换`offset.top`为`this.offset`，您应该会看到您正在寻找的结果。

# sql - 使用 not in 语句将更新查询转换为 linq

> ID：12003889
> 
> 赞同：-1
> 
> 时间：2012-08-17T10:14:50.623
> 
> 标签：sql, linq

我的sql语句是

```
update Gallery set IsPublished = 0 where GalleryId not in ('1','2'); 
```

如何将其转换为 linq

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:17:54.043

您不能在 linq 查询中进行更新。您的 SELECT 查询可能类似于：

```
List<int> ids = new List<int>() { 1, 2 }; // Assuming integers here
var galleriesToUpdate = context.Gallery
    .Where(g => !ids.contains(g.GalleryId)).ToList(); 
```

然后更新它们

```
foreach(var gallery in galleriesToUpdate) {
    gallery.IsPublished = 0;
} 
```

然后使用上下文保存它们。

```
context.SubmitChanges(); 
```

# php - 不能在 mysqli_stmt 对象上使用 call_user_func_array

> ID：12003890
> 
> 赞同：3
> 
> 时间：2012-08-17T10:14:50.977
> 
> 标签：php, mysqli

我正在为 MySQLi 编写一个包装类。在那里，我正在编写一个函数来接受可以调用的查询和可变数量的参数**`mysqli_stmt::bind_param`**。这是代码：

```
<?php
    class DbHelper {
        ....
        public function Execute($query, $params){
            $this->open(); # Opens a connection to the database using MySQLi API
            $stmt = $this->mysqli->prepare($query);
            try{
                $result = call_user_func_array(array($stmt, 'bind_param'), $params);
            }
            catch(Exception $ex){
                # Handle Exception
            }
        }
        ....
    }
?> 
```

这是我调用该函数的方式：

```
<?php
    $db = new DbHelper();
    $params = array('i', $stateID);
    $result = $db->Execute('SELECT * FROM mst_cities WHERE State_ID = ?', $params);    
?> 
```

当我运行代码时，我收到如下警告：
`Warning: Parameter 2 to mysqli_stmt::bind_param() expected to be a reference, value given in......`

我应该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:21:15.307

从[文档](http://php.net/manual/en/mysqli-stmt.bind-param.php)：

> **注意**：
> 
> 将 mysqli_stmt_bind_param() 与 call_user_func_array() 一起使用时必须小心。请注意，mysqli_stmt_bind_param() 需要通过引用传递参数，而 call_user_func_array() 可以接受可以表示引用或值的变量列表作为参数。

评论中有一些解决方法，例如[看到这个](http://www.php.net/manual/en/mysqli-stmt.bind-param.php#100879)：

```
call_user_func_array(array($stmt, 'bind_param'), refValues($params));

function refValues($arr)
{
    if (strnatcmp(phpversion(),'5.3') >= 0) //Reference is required for PHP 5.3+
    {
        $refs = array();
        foreach($arr as $key => $value)
            $refs[$key] = &$arr[$key];
        return $refs;
    }
    return $arr;
} 
```

# apache - .htaccess 和 google pagespeed 中的 mod_deflate

> ID：12003891
> 
> 赞同：3
> 
> 时间：2012-08-17T10:14:54.707
> 
> 标签：apache, .htaccess, pagespeed, http-compression, mod-deflate

我有一个带有 centos 6 的 linode 服务器，因为它不支持 mod_gzip，我正在使用 mod_deflate。

这是我在 .htacess 中的代码

```
<IfModule mod_deflate.c>
  <FilesMatch "\\.(js|css|html|htm|php|xml)$">
    SetOutputFilter DEFLATE
  </FilesMatch>
</IfModule> 
```

当我使用[http://www.whatsmyip.org/http-compression-test/](http://www.whatsmyip.org/http-compression-test/)进行测试时，它说“我的网站已压缩”，但是当我在 chrome 中使用 pagespeed 时，它仍然建议“启用压缩”

怎么了？我的 .htaccess 代码有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-07-13T12:44:08.673

我以这种方式使用了放气模式：

```
<IfModule mod_deflate.c>
# Compress HTML, CSS, JavaScript, Text, XML and fonts
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
AddOutputFilterByType DEFLATE application/x-font
AddOutputFilterByType DEFLATE application/x-font-opentype
AddOutputFilterByType DEFLATE application/x-font-otf
AddOutputFilterByType DEFLATE application/x-font-truetype
AddOutputFilterByType DEFLATE application/x-font-ttf
AddOutputFilterByType DEFLATE application/x-javascript
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE font/opentype
AddOutputFilterByType DEFLATE font/otf
AddOutputFilterByType DEFLATE font/ttf
AddOutputFilterByType DEFLATE image/svg+xml
AddOutputFilterByType DEFLATE image/x-icon
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/javascript
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/xml
</IfModule> 
```

它对我来说非常有效。我的网站的页面速度是：桌面版：91 移动版：83

我用于我的网站的参考资料：

1.  [http://www.quickregisterseo.com/improve-google-page-speed-score-wordpress-without-plugins/](http://www.quickregisterseo.com/improve-google-page-speed-score-wordpress-without-plugins/)
2.  [https://dzone.com/articles/steps-improve-your-pagespeed-insight-score](https://dzone.com/articles/steps-improve-your-pagespeed-insight-score)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-12T10:45:33.573

我有同样的问题。Chrome 中的 pagespeed 似乎有时会给出错误的结果。如果您真的想确定，我建议使用[http://webpagetest.org](http://webpagetest.org)或[http://gtmetrix.com 。](http://gtmetrix.com)你应该总是在不同的网站上测试这些东西，不要仅仅依赖一两个测试。某些网站或工具会给出错误的结果。

# android - 是否有任何公式可以根据进程的 cpu 使用情况来查找电池使用情况？

> ID：12003895
> 
> 赞同：2
> 
> 时间：2012-08-17T10:15:02.373
> 
> 标签：android, cpu-usage

在我的应用程序中，我想计算一个进程处理 CPU 周期所消耗的电池。是否有任何公式可以计算执行 CPU 周期的进程使用的电池

# .net - 走视觉树是不好的做法吗？

> ID：12003896
> 
> 赞同：4
> 
> 时间：2012-08-17T10:15:04.383
> 
> 标签：.net, wpf, visual-tree

最近我看到一些关于走可视化树是不好的做法的评论（[例如这里](https://stackoverflow.com/a/11970616/773118)），但我还没有看到或找到为什么这是不好的做法的原因。

在我正在做的一个项目中，有相当多的树木行走，所以我想知道我是否应该费心将所有这些更改为其他东西，或者就让它保持原样。

所以，我想我的主要问题是视觉树行走是否真的是不好的做法，更重要的是，如果是，*为什么*？

另外，在哪里（如果有的话？）可以在视觉树上行走吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:21:25.567

1.  遍历可视化树通常相当于打破 WPF“自然”机制提供的抽象，手动强制框架应该自己做的事情（通过 XAML 声明、数据绑定等）。简单地说，这是一个 hack。有时它表明人们不确定如何正确使用 WPF。（顺便说一句，这确实很难使用）。

2.  您无法始终真正知道可视化树是否完整；WPF 可能尚未生成所有控件（例如，在填充包含许多项目的列表时）。为了解决这个问题，你需要实现安全措施、处理`LayoutUpdated`事件等，这使得你的代码过于复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:28:44.853

我首先要说的是，你会在这个问题上得到各种各样的意见。

在您链接到的示例中，我会说在这种情况下可视化树步行器是错误的解决方案 - WPF 通常最好与某种 MVVM 或类似 MVP 的模式一起使用，这意味着数据绑定，如果您绑定到适当的结构，你可以消除很多你可能用视觉树行走所做的事情。

我只倾向于将它用于“特殊效果”，因为它是。我工作的大型内部 WPF 应用程序有一些可视化的树遍历代码，它以可重用的方式向几个`ItemControl`s 添加了一些方便的行为（使用类型参数很有趣，可以使一个工作正常进行）。

我们还在一些附加属性的实现中遍历可视化树，这些附加属性是系统的一部分，用于控制是否允许特定用户操作 UI 的某些部分。这是因为无论底层数据是什么，这个系统都必须转换可视化树——用户权限是一个跨领域的问题，底层数据不应该在每一步都担心。

基本上我们只是为了对 UI 本身做一些事情——不能以更方便的方式完成的 UI 行为（老实说，大多数其他方式在大多数情况下更方便），或者实际上基于可视化树调整在 UI 绑定的数据中无法方便地表达的某些因素。如果是关于操作数据，我们总是在后端数据结构或 ViewModel 中进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:30:10.017

这取决于你为什么要走视觉树。有很多机制可以使您的视图自动化，并且在大多数情况下，它们足以完成甚至非常复杂的控制。

在我多年使用 wpf 的工作中，我仅在创建一些无法以其他方式完成的非标准行为（或者我没有找到其他方法来完成它们）时才使用可视化树行走。我认为行走视觉树是一种与其他工具一样的工具，例如反射。很高兴知道它，它有它的应用和缺点。

# c# - 无法在已经运行的表单中得到结果。为什么？它打开了另一种形式的结果。

> ID：12003898
> 
> 赞同：0
> 
> 时间：2012-08-17T10:15:08.510
> 
> 标签：c#, winforms

我有 A 和 B 表格。

当我运行时，A 表单将通过单击开始按钮显示 datagridview 中的所有值。在同一个表单中，有一个 labellink。一旦我单击 labelink B 表单，将显示组合框和一个按钮。

现在我选择一个选项并单击我想在 A Form 的 datagridview 中查看值的按钮。

我的问题是当我在 B 表单中选择选项时，结果应该出现在已经打开的 A 表单中，但是在我的情况下，它将打开另一个新的 A 表单并显示结果。我不想再次打开 A 表单并处理结果。

我怎样才能做到这一点？实现它的简单解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:18:33.850

将 FormA 的实例传递给 FormB

```
public class FormB{

   public FormB(FormA formA){
    this.FormA=formA;
  }

  private void UpdateFormA(){
    formA.SetResult(...);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:32:12.497

使用 MVC 架构，控制器“知道”哪些表单是打开的。这样，表单 B 告诉控制器显示表单 A，控制器决定一个表单 A 已经打开，并建议表单 A 更新自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:44:24.440

正如 AISki 建议的那样，使用 MVC，否则使用事件和委托。从 FORM B 触发事件并在 FORM A 中订阅它。

# mysql - 根据另一个表中的值选择一个表中缺少的值

> ID：12003901
> 
> 赞同：2
> 
> 时间：2012-08-17T10:15:32.413
> 
> 标签：mysql, sql, join

我正在使用 mysql 并且有 2 个表

表格1

```
id
324
325
328
350
420
650
850
950 
```

表2

```
id    mapping_id
324   1
325   2
328   3
350   4
420   5
650   1
850   2 
```

我想为表一中的 id 生成所有 DISTINCT 字段 mapping_ids 的列表。例如，id 850 的 mapping_id 为 2，因此缺少 1、3、4、5，而 id 950 甚至不在表 2 中，因此缺少 1、2、3、4、5。这应该给我一个 1,2,3,4,5 的不同列表。

我尝试了各种 LEFT JOIN 查询，但无法获得所需的结果。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:59:21.310

您可以`id - mapping`使用`cross join`. 子`not in`查询可以确定矩阵的哪些部分是空的：

```
select  *
from    table1 t1
cross join
        (
        select  distinct mapping_id
        from    table2
        ) mappings
where   not exists
        (
        select  *
        from    table2 t2
        where   t2.id = t1.id
                and t2.mapping_id = mappings.mapping_id
        ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:18:17.747

```
select t1.id, t2.mapping_id
from table1 t1, table2 t2
MINUS
select t2.id, t2.mapping_id
from table1 t1
inner join table2 t2 on t1.id = t2.id 
```

# c# - 将代码分解为可管理的块

> ID：12003907
> 
> 赞同：2
> 
> 时间：2012-08-17T10:15:53.287
> 
> 标签：c#, winforms

我有一个用 C# 编写的 Windows 窗体应用程序，其中一个窗体包含大量代码。我已经大量使用类来将表单代码保持在最低限度，但是由于表单有许多标签页和数百个控件和数据网格等，所以表单本身的代码仍然很丰富。

有没有办法将此代码分解为更易于管理和更小的项目，也许每个标签页的解决方案中有一个项目，同时将所有代码保持在同一范围内？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:27:40.300

如果您在不过多移动代码的情况下寻求更好的可读性和维护性，您可以使用：

```
#region Tab 1
#region Variables
#endregion
#region Properties
#endregion
#region Methods
#endregion
 #endregion 
```

这将允许您在更改某个选项卡时最小化您不感兴趣的部分代码。它并不完美，但它可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T10:25:31.757

如果您正在寻找重构代码及其框架，那么您必须了解[SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)原则。一篇很好的文章是*[SOLID Software Development, One Step at Time](http://www.code-magazine.com/article.aspx?quickid=1001061&page=3)*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T10:21:51.393

您可以使用[Partial Classes](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)将代码拆分为几个 cs 文件，但我真的没有看到太多好处，唯一的解决方案是进行完全重构并将与 UI 无关的代码删除到单独的类中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T10:29:00.293

你基本上需要[重构](http://en.wikipedia.org/wiki/Code_refactoring). 这是经典[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)应用程序的常见问题，因此您必须自律并决定如何整理。这不会是即时修复。

查找[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller) / [MVP](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter)，甚至[MVVM](http://en.wikipedia.org/wiki/Model_View_ViewModel)并了解其他人如何分解他们的代码。从那里您可以引入适合您的分层架构。

然而，你并不孤单。Visual Studio 中甚至更好的[ReSharper](http://en.wikipedia.org/wiki/ReSharper)中的重构工具可以自动执行大量复制粘贴周期，消除错误并自动保持变量名称等同步。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-17T10:17:36.027

属于用户控件表示层的代码可以放入扩展控件的类中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-17T10:19:01.760

从每个选项卡中提取代码并创建一个用户控件来包含每个选项卡的代码。（您甚至可以从 TabPage 继承并将这些添加到 init 的表单中）

然后可以将用户控件添加到每个选项卡中，并应显着减少代码。

网格等也可以转换为用户控件，公开其他控件访问所需的最少方法和属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-17T10:19:45.410

如果您一遍又一遍地定义表单控件，只需在其他选项卡上创建它们的新实例。

创建 getter 和 setter 来访问它。

但实际上，为表单控件提供大量代码并没有问题，这正是我认为的方式。[我认为 Visual Studio 应该使用Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)为您生成所有这些？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-17T12:26:37.910

我个人对地区有疑问。它有时会抛出编辑器，您需要关闭并重新打开文件以重置它（我正在使用[SharpDevelop中的](http://en.wikipedia.org/wiki/SharpDevelop)[Boo](http://en.wikipedia.org/wiki/Boo_%28programming_language%29)，它可能特定于此），因此对于带有选项卡的大型表单，我倾向于使用部分类。

你可以在 Visual Studio/SharpDevelop 文件资源管理器中做的一个巧妙的技巧是将部分类的文件拖到类的主文件上，这样它们都嵌套在 MainForm 下（在`.designer`and`.resx`文件旁边），这样可以让事情更整洁。

# python - 带有预加载模型数据的 Django 表单

> ID：12003908
> 
> 赞同：0
> 
> 时间：2012-08-17T10:15:55.563
> 
> 标签：python, django, forms, orm, model

我有一个用 django 处理的大表格。我的模型如下

```
class MerchantContact(models.Model):
    merchant = models.OneToOneField(MerchantProfile, related_name="merchant_contact")

    ContactUsAddressLine1 =models.CharField(max_length=16)
    ContactUsAddressLine2 =models.CharField(max_length=16)
    ContactUsAddressCity =models.CharField(max_length=16)
    ContactUsAddressState =models.CharField(max_length=4)
    ContactUsAddressZip=models.CharField(max_length=16)
    ContactUsPhone=models.CharField(max_length=16)
    ContactUsAddressFax=models.CharField(max_length=16)
    ContactUsEmail=models.CharField(max_length=64)
    ContactUsBusinessHours=models.CharField(max_length=256) 
```

我使用以下逻辑来填充表单

```
def merchantAccountInfo(request):
    #check if data is already there or not
    usr=UserProfile.objects.get(user_id=request.user.id)
    merchant=MerchantProfile.objects.get(user_id=usr.id)
    try:
        mc=MerchantContact.objects.get(merchant_id=merchant.id)
        formdata=MerchantContactForm(
                        {'id':mc.id,
                         'ContactUsAddressLine1':mc.ContactUsAddressLine1,
                        'ContactUsAddressLine2':mc.ContactUsAddressLine2,
                        'ContactUsAddressCity':mc.ContactUsAddressCity,
                        'ContactUsAddressState':mc.ContactUsAddressState,
                        'ContactUsAddressZip':mc.ContactUsAddressZip,
                        'ContactUsPhone':mc.ContactUsPhone,
                        'ContactUsAddressFax':mc.ContactUsAddressFax,
                        'ContactUsEmail':mc.ContactUsEmail,
                        'ContactUsBusinessHours':mc.ContactUsBusinessHours
                        }
        )

    except MerchantContact.DoesNotExist:
        formdata=MerchantContactForm()
    return render_to_response('account_info.html',locals(),context_instance=RequestContext(request)) 
```

上面的代码运行良好，但我担心表单可能太大，有 30 多个字段。内联传递每个字段将是太乏味的方式..

还有其他节省时间和代码行的替代方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T10:19:31.517

您可以使用`instance`参数来实例化表单，该表单会将初始数据从该对象放入表单中，而不是提供属性的字典。

喜欢：

`formdata=MerchantContactForm(instance=mc)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T02:05:09.003

是的，您需要阅读有关 ModelForms 的文档。他们根据模型的数据构建表格。如果您想为模型安装额外的样式或小部件，那么您可以执行类似于在管理员中添加 RTE 的操作，我相信。只需转到您的版本的官方文档并查阅 modelforms 文档即可。这是从模型生成表单的最快方法。您甚至可以设置 css 属性等。

# wcf - Monodevelop：使用本地 WSDL 添加 Web 引用时出现 InvalidCastException

> ID：12003909
> 
> 赞同：0
> 
> 时间：2012-08-17T10:16:02.787
> 
> 标签：wcf, monodevelop

我正在尝试使用本地 WSDL/XSD 文件添加 Web 参考。

不幸的是，每当我尝试时，都会出现以下异常：

![在此处输入图像描述](../Images/bd4ed33196fee032a0ad339fb6650fed.png)

难道我做错了什么？
它适用于在线网络服务。

这是完整的例外：

```
System.InvalidCastException: Cannot cast from source type to destination type.
  at System.Xml.Serialization.XmlSchemaImporter.CollectAttributeUsesNonOverlap (System.Xml.Schema.XmlSchemaObjectCollection src, System.Xml.Serialization.ClassMap map) [0x00000] in <filename unknown>:0 
  at System.Xml.Serialization.XmlSchemaImporter.ImportAttributes (System.Xml.XmlQualifiedName typeQName, System.Xml.Serialization.ClassMap cmap, System.Xml.Schema.XmlSchemaObjectCollection atts, System.Xml.Schema.XmlSchemaAnyAttribute anyat, System.Xml.Serialization.CodeIdentifiers classIds) [0x00000] in <filename unknown>:0 
  at System.Xml.Serialization.XmlSchemaImporter.ImportMembersMappingComposite (System.Xml.Schema.XmlSchemaComplexType stype, System.Xml.XmlQualifiedName refer) [0x00000] in <filename unknown>:0 
  at System.Xml.Serialization.XmlSchemaImporter.ImportMembersMapping (System.Xml.XmlQualifiedName name) [0x00000] in <filename unknown>:0 
  at System.ServiceModel.Description.XmlSerializerMessageContractImporterInternal.ImportPartsBySchemaElement (System.Xml.XmlQualifiedName qname, System.Collections.Generic.List`1 parts, System.Web.Services.Description.Message msg, System.Web.Services.Description.MessagePart msgPart) [0x00000] in <filename unknown>:0 
  at System.ServiceModel.Description.MessageContractImporterInternal.resolveMessage (System.Web.Services.Description.Message msg, System.ServiceModel.Description.MessageBodyDescription body, System.Collections.Generic.List`1 parts) [0x00000] in <filename unknown>:0 
  at System.ServiceModel.Description.MessageContractImporterInternal.DoImportContract () [0x00000] in <filename unknown>:0 
  at System.ServiceModel.Description.MessageContractImporterInternal.ImportContract (System.ServiceModel.Description.WsdlImporter importer, System.ServiceModel.Description.WsdlContractConversionContext context) [0x00000] in <filename unknown>:0 
  at System.ServiceModel.Description.XmlSerializerMessageContractImporter.System.ServiceModel.Description.IWsdlImportExtension.ImportContract (System.ServiceModel.Description.WsdlImporter importer, System.ServiceModel.Description.WsdlContractConversionContext context) [0x00000] in <filename unknown>:0 
  at System.ServiceModel.Description.WsdlImporter.ImportContract (System.Web.Services.Description.PortType wsdlPortType) [0x00000] in <filename unknown>:0 
  at System.ServiceModel.Description.WsdlImporter.ImportAllContracts () [0x00000] in <filename unknown>:0 
  at MonoDevelop.WebReferences.WCF.WebServiceDiscoveryResultWCF.CreateProxyFile (MonoDevelop.Projects.DotNetProject dotNetProject, FilePath basePath, System.String proxyNamespace, System.String referenceName) [0x00000] in <filename unknown>:0 
  at MonoDevelop.WebReferences.WebServiceDiscoveryResult.GenerateFiles (MonoDevelop.Projects.DotNetProject project, System.String namspace, System.String referenceName) [0x00000] in <filename unknown>:0 
  at MonoDevelop.WebReferences.Commands.WebReferenceCommandHandler.NewWebReference () [0x00000] in <filename unknown>:0 
```

`Windows Communication Foundation (WCF)`和的错误相同`.NET 2.0 Web Services`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T03:22:58.933

`bugzilla.xamarin.com`在（使用“类库”/“WCF”）提交错误报告并包含您尝试导入的 WSDL。

通过查看该堆栈跟踪，Mono 的 WSDL 导入器由于某种原因不喜欢您的导入。

# lotus-notes - Lotus Notes DXL Notesbitmap 转 GIF

> ID：12003916
> 
> 赞同：0
> 
> 时间：2012-08-17T10:16:30.630
> 
> 标签：lotus-notes

我正在使用读取 Filedata 并将其转换为 base64 字节 [] 并创建 gif 图像的 dxl 逻辑将 Lotus Notes 文档库内联图像转换为 gif 图像。转换对所有示例都运行良好，但几天前我们遇到了带有 notesbitmap 标记的示例文件，在阅读了几个论坛之后，有人提到

“对于 DXL 导出中的问题图像，它们会导致输出中的元素，还是 ? 如果是后者，我相信它们实际上是图像引用而不是实际图像；notesbitmap 数据不是 gif，而是包含Notes 特定格式的二进制标头和 URL。”

但是我在哪里可以找到特定注释中的 URL，因为当我解码第二个数据时，它给了我垃圾结果而不是 url。

我还尝试在转换之前将 ConvertNotesBitmapToGif .net 属性设置为 true。

请在以下链接中找到示例 DXL： http: [//www.page-monitor.com/Downloads/Exported2.xml](http://www.page-monitor.com/Downloads/Exported2.xml)

细节：

xP8gAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAU1RHNjI2NTeVACYAAAAAAAAAAAAAAAAAAAAAAAAAAAA0wF/ AAAAAAAAAAAAAAAAAA==

是标题信息，即图像名称

底部下方的文件数据应提供 URL（根据 Lotus Notes 论坛）

任何帮助将不胜感激！

感谢和问候哈西娜

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T10:42:53.800

来自[http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_NOTESBITMAP_ELEMENT_XML.html](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_NOTESBITMAP_ELEMENT_XML.html)

> 笔记位图元素
> 
> 表示专有的 Notes 位图图像。存储在 NSF 文件中的图像由 base64 内容组成，它是表示位图的一系列 CD（复合数据）记录。

因此，如果你运行

```
xP8gAAEAAQAAAAgAAAAAAAAAAAAAAAAAU1RHNjI2NTeVACYAAAAAAAAAAAAAAAAAAAAAAAAA0wF/ AAAAAAAAAAAAAAAAAA== 
```

通过base64解码器，你得到

```
`Äÿ ������������������STG62657�&amp;�������������������Ó������������� 
```

你会在 DXL 的下方找到“STG62657”

```
<item name="$FILE" summary="true" sign="true" seal="true">
<object>
<file hosttype="cdstorage" compression="none" flags="storedindoc" encoding="none" name="STG62657" size="2332"> 
```

你可以解码....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T12:10:59.280

base64 编码数据的第一个字节 (0xC4) 指的​​是

```
#define SIG_CD_STORAGELINK      (196 | WORDRECORDLENGTH) 
```

在您的情况下，它是一个参考，但它也可以是图像数据本身。所以检查数据前缀总是一个好主意。

存储链接格式是这样的：

```
#define STORAGE_LINK_TYPE_OBJECT        1
#define STORAGE_LINK_TYPE_NOTE          2
#define STORAGE_LINK_TYPE_URL_CONVERTED 3
#define STORAGE_LINK_TYPE_URL_MIME      4
#define STORAGE_LINK_TYPE_MIME_PART     5
#define STORAGE_LINK_TYPE_MIME_OBJECT   6

#define STORAGE_LINK_LOAD_DEFERRED  1
#define STORAGE_LINK_LOAD_ON_DEMAND 2

/*  Structure for externally stored objects */
typedef struct {
    WSIG Header;
    WORD StorageType;           /* Type of object (Object, Note, URL, etc.) */
    WORD LoadType;              /* How to load (deferred, on demand, etc.) */
    WORD Flags;                 /* Currently not used */
    WORD DataLength;            /* Length of data following */
    WORD Reserved[6];           /* Currently not used */
                                /* Storage data follows... */
} CDSTORAGELINK; 
```

图像数据可能“按原样”（但采用 base64 编码）或压缩后出现在文档中。例如，通过 LZ1 压缩，图像数据被组织成块。如果对于特定的块，压缩可以节省空间 - 它被压缩，如果压缩后产生的数据大小增加（对于 GIF 等已经压缩的数据类型，这是正常情况） - 块被存储而不是压缩。

如果您不了解上述说明，则压缩和未压缩块的偶尔交换可能会令人困惑：正确启动的数据在某些时候会变成垃圾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-30T21:07:23.330

使用 DXL，您可以为包含位图图像的 $File 项提取“文件数据”。文件数据是 Base64 编码的，因此需要对其进行解码以获得二进制数据。

Bitmap 数据的结构如下： 1\. WORD - 块数 2\. 每个块一个或多个 WORD，每个块的长度 3\. WORD - TYPE_COMPOSITE 标志

标题之后是位图的 CD 记录。通常，CD 记录是： - 图形 - 位图标题 - 一个或多个位图段 - 位图颜色表 - 位图模式表

您可以做的是删除直到 TYPE_COMPOSITE 标志的所有字节（但保留 TYPE_COMPOSITE 标志字节）并将二进制数据写入文件。

然后使用 NotesRichTextItem 的 AppendRTFile 方法，您可以将图像导入富文本项。

有关执行此操作的更多详细信息以及解析二进制数据的示例代理，请访问我们的网站： [https ://www.agecom.com.au/support/agecomkb.nsf/0/58cbf10f0ab723c9ca25803e006c7de8](https://www.agecom.com.au/support/agecomkb.nsf/0/58cbf10f0ab723c9ca25803e006c7de8)

# c - how to store index in disk blocks consistently

> ID：12003923
> 
> 赞同：1
> 
> 时间：2012-08-17T10:17:02.927
> 
> 标签：c, database, database-design

I am building a database engine in C for Linux and I need to implement indexing. Consider a simple double linked list index like this:

```
struct node_t {
   void *prev;
   void *next;
   long  data;
}; 
```

For permanent storage I have to convert this structure in disk blocks, like for example:

```
struct node_on_disk_t {
    size_t prev_disk_block;
    short  prev_disk_offset;
    size_t next_disk_block;
    short  next_disk_offset;
    long   data;
}; 
```

Now, when I insert a record, one entry must be added to the index too. If the index is only few elements I can store it on 1 disk block consistently because the write() of 1 block is atomic. However if the list fills entirely the first block, another block must be added on insert and pointers must be updated on both blocks. But the problem is, only 1 block can be written atomically. So, my question is how to store this kind of structure consistently?

Can this be done without transaction log? Because I could store the description of the operation on another disk block first (sort of transaction log), update the pointers of the index and then remove the description of the operation, but this would have to be done in 3 write()s , too slow

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T11:04:16.263

有两种常见的策略：

1.  事务日志
2.  写时复制

后者的工作原理是始终将新的和更改的数据复制到新扇区，并在设置新映像后，使用一个原子扇区写入将其链接。

不幸的是，我不明白这如何适用于双向链表。对于单链表，它可以工作。

# sql - 给整数字段添加前缀

> ID：12003924
> 
> 赞同：0
> 
> 时间：2012-08-17T10:17:03.687
> 
> 标签：sql, sql-server

在我的数据库中的一个表中，我有一个包含每个客户的 ID（整数）的表。

不同的客户来自不同的国家，我想在他们的“ID”前加上两个字符。

假设我有一个 ID 为 12345 的客户。

如何将前缀“EN”添加到该客户编号？

我知道我可以对变量进行 CAST() ，但是对于通过查询获取的字段，此过程是否相同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:20:05.113

您只需连接字符

```
SELECT 'EN' + Cast(id as varchar(10))
FROM yourTable 
```

然后，如果您想进行更新：

```
UPDATE yourTable
SET yourfield = 'EN' + Cast(id as varchar(10)) 
```

如果您有表格中的国家/地区列表：

```
SELECT left(country, 2) + cast(id as varchar(10))
FROM yourTable 
```

或者

```
UPDATE yourTable
SET yourfield = left(country, 2) + Cast(id as varchar(10)) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/11146/1)

# ruby-on-rails - Mongoid 数据类型检索

> ID：12003948
> 
> 赞同：0
> 
> 时间：2012-08-17T10:18:14.607
> 
> 标签：ruby-on-rails, mongoid

是否可以快速检索给定 Mongoid 字段的数据类型？

类似于：FieldName.type？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:46:46.477

我想，这不仅仅是 mongo 特定的。您可以使用以下代码来检索字段的字段类型，而与下面的数据库无关。

```
User.first.name.class
=> String

User.first.up_votes.class
=> Fixnum 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:52:13.140

我仍在使用 mongoid 2.4，所以我不确定这是否也适用于 3.0：

```
User.fields["field_name"].options[:type] 
```

# c# - 在 C# 中生成连续的正弦/余弦波形

> ID：12003949
> 
> 赞同：-6
> 
> 时间：2012-08-17T10:18:15.830
> 
> 标签：c#, waveform

嘿朋友我正在尝试在 C# 中生成一个连续的正弦波形，我只能生成一个周期，但我希望波形是连续生成的。

这是我的代码..

```
public partial class Form1 : Form
{

    public Form1()
    {
        InitializeComponent();
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        float x0 = 100f;
        float y0 = 100f;
        PointF[] points = new PointF[200];

        for (int j = 0; j < 200; j++)
        {
            points[j] = new PointF();
            points[j].X = x0 + j;
            points[j].Y = y0 - (float)(Math.Sin((2 * Math.PI * j) / 200) * (200 / (2 * Math.PI)));
        }

        using (Pen p = new Pen(Color.Blue))
        {
            p.EndCap = LineCap.ArrowAnchor;

            //Draw X-coordinate
            e.Graphics.DrawLine(p, x0, y0, x0 + 250, y0);

           //Draw Y-coordinate
           e.Graphics.DrawLine(p, x0, y0 + 80, x0, y0 - 80);
        }

        e.Graphics.DrawString("0", SystemFonts.DefaultFont, Brushes.Blue, x0, y0 );
        e.Graphics.DrawString("p", SystemFonts.DefaultFont, Brushes.Blue, x0 + 100, y0);
        e.Graphics.DrawString("2p", SystemFonts.DefaultFont, Brushes.Blue, x0 + 200, y0);

        e.Graphics.SmoothingMode = SmoothingMode.AntiAlias;
        e.Graphics.DrawLines(Pens.Blue, points);
        base.OnPaint(e);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T11:10:15.653

只需将稍后将生成的代码放在 wave 上即可。并增加 X 轴以将其向右或向左移动。

# sql - SQL Oracle：用单词替换空结果

> ID：12003957
> 
> 赞同：3
> 
> 时间：2012-08-17T10:18:38.890
> 
> 标签：sql, oracle, select, case

我正在研究这个问题好几天。我有一个**oracle**数据库。问题必须在**一个查询**中解决。No Function, Pocedure, ... 我要进行选择。当他有结果时，发布它们。否则应该有“空结果”。

```
select case 
when count(*) = 0    
then 'no Entry'   
else MAX(Member)--all Members should be here 
END as Member 
from tableMember 
where Membergroup = 'testgroup'; 
```

问题是 Oracle 想要一个由 else 提供的 Agregat 函数。因此，如果结果不是“无条目”，我只会得到一个值。我需要所有的价值观。

欢迎所有能帮助我的人，让我快乐。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T10:33:52.933

不知道你想达到什么目标，也许这个

```
 select member from tablemember where Membergroup = 'testgroup'
union 
 select  'no Entry' 
 from dual 
 where NOT EXISTS ( select member from tablemember where membergroup = 'testgroup')
; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T10:26:29.457

不需要两个聚合查询，你只需要检查是否`max(member)`为空。我会这样做是为了弄清楚发生了什么。

```
select case when max_member is null then 'no entry' else max_member end as member
  from ( select max(member) as max_member
           from tablemember
          where membergroup = 'testgroup'
                ) 
```

但是，如果您想返回所有成员，您可以执行以下操作：

```
select member
  from tablemember
 where membergroup = 'testgroup'
 union all
select 'no entry'
  from dual
 where not exists ( select 1 from tablemember where membergroup = 'testgroup') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T12:50:50.320

如果您`RIGHT JOIN`使用空集的查询进行查询，您将始终获得一行，并且如果您的查询返回数据，则将获得所有行。这比 a`UNION`或`UNION ALL`使用 a更便宜（更快），`NOT EXISTS`因为它不需要对数据进行多次扫描。

```
SELECT nvl(a.member,b.member) member
   FROM (SELECT member FROM tablemember WHERE membergroup='????') a
   RIGHT JOIN (SELECT 'no Entry' member FROM dual) b ON 1=1; 
```

*测试环境：*

```
DROP TABLE tablemember;
CREATE TABLE tablemember AS
   (
      SELECT TO_CHAR(level) member
         , DECODE(mod(level, 5), 0, 'testgroup', 'othergroup') membergroup
      FROM dual CONNECT BY level <= 50
   ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T05:25:35.247

您可以使用一些聚合函数和 NVL 来实现您的目标：

SELECT MIN('VALUE 1') AS p1, MIN('VALUE 2') AS p2 FROM DUAL WHERE 1=0

此查询的结果是：NULL，NULL

接下来，用所需的字符串替换空值：

```
SELECT 
    NVL(MIN('1'), 'empty  value 1') AS p1, 
    NVL(MIN('STRING VALUE'), 'empty value 2')  AS p2,
    NVL(MIN((select 'subquery result' from dual)), 'empty subquery result') as p3
FROM 
    DUAL 
WHERE 
    1=0 
```

**但是**，您不能在字段中混合数字和字符串。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-08-17T11:23:12.353

试试这个：

```
DECLARE C INTEGER;

SELECT COUNT(*) INTO C FROM tableMember WHERE Membergroup = 'testgroup';

IF C > 0

THEN

    SELECT * FROM tableMember;

ELSE

    SELECT 'No results!' FROM tableMember;

END IF; 
```

# php - 数组转换

> ID：12003962
> 
> 赞同：-3
> 
> 时间：2012-08-17T10:18:59.367
> 
> 标签：php, arrays, cakephp, cakephp-2.1

我怎样才能制作这个数组：

```
Array
(
    [Qualifications] => Array
        (
            [name] => Array
                (
                    [0] => 1
                    [1] => 2
                )

            [description] => Array
                (
                    [0] => 1
                    [1] => 2
                )
) 
```

看起来像这个数组？

```
Array
(
   [Qualifications] => Array
        (
            Array [0] =>
                (
                    [name]=> 1
                    [description] => 1
                )

            Array [1]
                (
                    [name] => 2
                    [descrition] => 2
                )
       )
) 
```

它是通过带有 jquery 的表单字段生成的，然后发送回我的服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T15:42:57.307

我会做这样的事情：

```
/**
 * @param array $bar bar is the qualification array containing (0=>'name' => array(), description => array()
 * @return array
 */
function foo(array $bar = array()){
    $finalArray = array();

    foreach($bar as $key => $value){
        foreach($value as $innerKey => $innerValue){
             $finalArray[$innerKey][$key] = $innerValue;
        }
    }
    return $finalArray;
} 
```

所以你通过内部数组（什么是资格），你所要做的就是在最后把它放回资格。

编辑：没有功能：

```
$baseArray = array(Qualifications => array('name' => array(1,2), 'description' => array(1,2)));    

$bar = $baseArray['Qualifications'];

$transformedArray = array();
foreach($bar as $key => $value){
        foreach($value as $innerKey => $innerValue){
             $transformedArray [$innerKey][$key] = $innerValue;
        }
    }
$theArrayYouWant = array('Qualification' => $transformedArray); 
```

# javascript - 加载css文件并覆盖前一个

> ID：12003964
> 
> 赞同：1
> 
> 时间：2012-08-17T10:19:00.353
> 
> 标签：javascript, html, css, html5-canvas

我想在 javascript 中加载 css 属性。

我有两个画布，我在 head 标签中加载了一个 css 文件。

我想在选择某个选项时这样做，画布的 css 会发生变化。如果它是简单的 css，它可以通过“canvas.style.csstext”来完成，但我正在应用变换来倾斜元素，所以它在“canvas.style.csstext”中不起作用。

那我该怎么做！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T10:46:16.103

好的，我将在此处发布作为答案，以便其他人可以看到。

有多种方法，例如注入`link`元素或 use `document.styleSheets[0].insertRule`，但在您的情况下，更好的解决方案是将两个`CSS`文件包含在 header 中，使用不同的选择器，并`canvas.className`在需要时修改。

插图：

```
<link href="main.css" /> <!--canvas{border:...}-->
<link href="alternate.css" /> <!--canvas.alter{border:...}-->
<!--...-->
<canvas id="needToAlter"></canvas>
<button onclick="document.getElementById('needToAlter').className+=' alter';">Alter</button> 
```

# perl - 如何在perl中查找给定日期的上一个日期

> ID：12003967
> 
> 赞同：1
> 
> 时间：2012-08-17T10:19:04.733
> 
> 标签：perl, date, datetime

如何在 perl 中查找给定日期的前一个日期为 8 月 17 日。我可以使用下面的代码在 perl 中获取当前日期。有人可以帮我找到给定日期的前一个日期吗？

```
Given date as : Aug 17
Required Date as : Aug 16
#Reverting the Date for the respective TimeZone
my $timezone='london';
my ($dt, $Curr_Bus_Date,$Curr_day);
$dt = DateTime->now(time_zone => $timezone);
$Curr_mon=$dt->strftime('%b');
$Curr_date=$dt->strftime('%d');
$Curr_date=~s/^0/ /;
$Curr_dt="$Curr_mon $Curr_date ";
print "The curr date is $Curr_dt \n"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T10:33:02.463

DateTime 类有一个`subtract()`方法。它有[明确的记录](https://metacpan.org/module/DateTime#Math-Methods)。

```
$ perl -MDateTime -E'say DateTime->now->subtract(days => 1)'
2012-08-16T10:31:25 
```

您也可以使用 Perl 的标准（从 5.10 开始）Time::Piece 和 Time::Seconds 类来实现。

```
$ perl -MTime::Piece -MTime::Seconds -E'$t = localtime; $t -= ONE_DAY; say $t'Thu Aug 16 11:37:37 2012 
```

使用这两种方法，您应该记住，从当前日期减去一天并不总是能让您回到前一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:23:00.950

您可以使用以下`Add_Delta_Days`方法：

```
use Date::Calc qw(Add_Delta_Days);
($year, $month, $day) = Add_Delta_Days(2012,8,17,-1); 
```

问候，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T10:26:17.547

您是否考虑过[Date::Manip](http://search.cpan.org/~sbeck/Date-Manip-6.32/lib/Date/Manip.pod)及其[日期计算工具](http://search.cpan.org/~sbeck/Date-Manip-6.32/lib/Date/Manip/Examples.pod#TO_ADD_AN_AMOUNT_OF_TIME_TO_A_DATE)？

我真的会检查 CPAN 以获得这些常用的功能。那里有很多成熟的强大模块。

# iphone - iPhone 中的 Http 请求/响应 API

> ID：12003970
> 
> 赞同：1
> 
> 时间：2012-08-17T10:19:21.970
> 
> 标签：iphone, objective-c, ios, cocoa-touch, nsurlconnection

在 iPhone 应用程序中是否所有的网络操作都只使用`NSURLConnections`?? 我正在使用 NSURLConnections 及其委托方法`ConnectiondidReceiveResponse`等`ConnectiondidFinishLoading`来下载文件。

我的问题是`NSURLConnection`API 是否仅在 Http 请求/响应的 cocoa-touch 中可用？有没有其他可用的API？？

我们`NSURLConnection`也可以使用上传文件吗？

我想有很多问题，但我真的很困惑。请帮帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:27:32.477

我也觉得用 上传文件很困难`NSURLConnection`。最后，我使用`AFNetworking`库。它工作得很好。

```
NSURL *url = [NSURL URLWithString:@"http://api-base-url.com"];
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];
NSData *imageData = UIImageJPEGRepresentation([UIImage imageNamed:@"avatar.jpg"], 0.5);
NSMutableURLRequest *request = [httpClient multipartFormRequestWithMethod:@"POST" path:@"/upload" parameters:nil constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
    [formData appendPartWithFileData:imageData name:@"avatar" fileName:@"avatar.jpg" mimeType:@"image/jpeg"];
}];

AFHTTPRequestOperation *operation = [[[AFHTTPRequestOperation alloc] initWithRequest:request] autorelease];
[operation start]; 
```

您可以在以下地址找到图书馆页面。

[https://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

此外，还有管理 Objective-C 库的 CocoaPods。我正在尝试使用它。

[https://github.com/CocoaPods/CocoaPods/](https://github.com/CocoaPods/CocoaPods/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T11:32:57.153

你也可以试试 MKNetworkKit 框架： [MKNetworkKit](https://github.com/MugunthKumar/MKNetworkKit)

易于使用，效果非常好！

# java - 有没有办法在 Eclipse 中自动生成包装器？

> ID：12003971
> 
> 赞同：22
> 
> 时间：2012-08-17T10:19:30.403
> 
> 标签：java, wrapper

我必须创建几个代理，以添加例如日志记录。像这样的东西：

```
interface IMath {
    public int add(a, b);
}

class Math implements IMath {
    public int add(a, b) { return a + b; }
}

class MathWithLogs implements IMath {
    private IMath realMath;
    public int add(a, b) {
        Log.d("tag", "valueable info");
        return realMath.add(a, b);
    }
} 
```

只要这些接口不是 20 种方法，一切都很好，我必须在其中添加一些东西。

我的问题是，有没有办法用一些 Eclipse 插件自动生成包装类？

或者，除非另有说明（如@Override），否则也许有一种方法可以使用注释来调用来自 realMath 的方法？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-17T10:29:53.327

右键单击任何源文件 (.java) 并导航到`source -> Override/Implement Methods/Generate Delegate Methods.`

第一个将粘贴即时界面的所有方法的主体。第二个将对对象的所有层次结构执行相同的操作（我猜，不确定）。希望这可以帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-17T10:22:32.937

是的，有一个名为“Generate Delegate Methods”的源代码生成器，它可以完全满足您的需求。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-05-19T21:19:17.200

在阅读了其他答案后，我花了一段时间才弄清楚该怎么做。解决方案是：

1.  创建实现所需接口的（最初为空的）包装类。确保在创建类时取消选中“继承的抽象方法”。
2.  在您的新包装类中（由于缺少接口实现，此时将显示错误），创建一个类型等于所需接口的字段。
3.  右键单击刚刚创建的字段并选择 Source -> Generate Delegate Methods。
4.  检查您要创建的方法，然后单击确定。
5.  最后，为该字段添加一个单参数构造函数或一个 setter 方法（它不会作为此过程的一部分自动生成）。

# javascript - 如何通过 JQuery ajaxSend 事件覆盖成功函数

> ID：12003978
> 
> 赞同：6
> 
> 时间：2012-08-17T10:19:48.993
> 
> 标签：javascript, ajax, jquery

我试图在 ajaxsend 事件上覆盖成功函数，但它在这里不起作用是代码：

```
 $(document).ajaxSend(function(event,xhr,options){
        console.log('ajaxSend');
        var tempSuccess = options.success;
        options.success = function(data, textStatus, jqXHR){
            console.log('start');
            tempSuccess(data, textStatus, jqXHR);
            console.log('end');
        }; xhr.success = options.success;}); 
```

在 AJAX 上，我确实在控制台中看到了“ajax”，但成功后我看不到开始和结束调试消息。

我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T17:50:53.797

你试图完成的事情不能用`ajaxSend`. 问题是它显然适用于原始对象和对象`ajaxSend`的副本，因此修改不会产生任何影响。您可以使用以下代码轻松测试它：`xhr``options`

```
$(document).ajaxSend(function(event, xhr, options){
    delete options.success;
    console.log(options.success);   // undefined
});
$.ajax({
    url: "test.html",
    success: function() { console.log("this will be printed nevertheless"); }
}); 
```

所以你不能`ajaxSend`用来覆盖成功回调。相反，您将不得不“破解”jQuery 的 AJAX 函数：

```
// closure to prevent global access to this stuff
(function(){
    // creates a new callback function that also executes the original callback
    var SuccessCallback = function(origCallback){
        return function(data, textStatus, jqXHR) {
            console.log("start");
            if (typeof origCallback === "function") {
                origCallback(data, textStatus, jqXHR);
            }
            console.log("end");
        };
    };

    // store the original AJAX function in a variable before overwriting it
    var jqAjax = $.ajax;
    $.ajax = function(settings){
        // override the callback function, then execute the original AJAX function
        settings.success = new SuccessCallback(settings.success);
        jqAjax(settings);
    };
})(); 
```

现在您可以`$.ajax`像往常一样简单地使用：

```
$.ajax({
    url: "test.html",
    success: function() {
        console.log("will be printed between 'start' and 'end'");
    }
}); 
```

据我所知，任何 jQuery 的 AJAX 函数（例如`$.get()`或`.load()`）在内部使用`$.ajax`，所以这应该适用于通过 jQuery 完成的每个 AJAX 请求（虽然我还没有测试过......）。

* * *

通过破解`XMLHttpRequest.prototype`. 请注意，以下内容在 IE 中不起作用，它`ActiveXObject`使用`XMLHttpRequest`.

```
(function(){
    // overwrite the "send" method, but keep the original implementation in a variable
    var origSend = XMLHttpRequest.prototype.send;
    XMLHttpRequest.prototype.send = function(data){
        // check if onreadystatechange property is set (which is used for callbacks)
        if (typeof this.onreadystatechange === "function") {
            // overwrite callback function
            var origOnreadystatechange = this.onreadystatechange;
            this.onreadystatechange = function(){
                if (this.readyState === 4) {
                    console.log("start");
                }
                origOnreadystatechange();
                if (this.readyState === 4) {
                    console.log("end");
                }
            };
        }
        // execute the original "send" method
        origSend.call(this, data);
    };
})(); 
```

用法（就像通常的 XMLHttpRequest 一样）：

```
var xhr = new XMLHttpRequest();
xhr.open("POST", "test.html", true);
xhr.onreadystatechange = function(){
    if (xhr.readyState === 4) {
        console.log("will be printed between 'start' and 'end'");
    }
};
xhr.send(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-24T09:21:17.567

因为在 ajaxSend 之前使用了 option.success。当它被使用时，它被添加到延迟对象中。

之后，你改变option.success，什么都不会发生。

因此，您必须在使用之前对其进行更改。过程是：

```
$.ajaxPrefilter -- $.fn.ajaxStart(if needed) -- option.beforeSend -- 
USE option.success and option.error and option.complete -- 
$.ajaxTransport -- $.fn.ajaxSend -- send the actual request -- 
option.dataFilter --  fire the success/error callbacks -- 
$.fn.ajaxSuccess/$.fn.ajaxError -- fire the complete callbacks --  
$.fn.ajaxComplete -- $.fn.ajaxStop(if needed) 
```

因此，您可以更改“$.ajaxPrefilter”或“option.beforeSend”中的 option.success。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-17T17:01:56.600

您可以使用闭包来完成您所需要的：

```
function closure(handler) {
    return function(ev, xhr, options) {
        console.log("start");
        handler(ev, xhr, options);
        console.log("stop");
    }
}

$(document).ajaxSend(closure(function(ev, xhr, options) {
    console.log("hello");
})); 
```

# android - 从android上的json中的http响应获取希伯来语字符

> ID：12003979
> 
> 赞同：1
> 
> 时间：2012-08-17T10:20:02.203
> 
> 标签：android, json, encoding

我正在做一个项目，我需要从我的应用引擎服务器获取一些包含希伯来字符的数据（数据以 json 格式发送）。

**在服务器端：**

```
resp.setHeader("Content-Type", "application/json; charset=UTF-8");
PrintWriter out = resp.getWriter();
out.print(responeData.toString()); 
```

当我调试服务器时，我看到响应数据似乎很好（意思是，它显示了我的希伯来语字符。

**在客户端（安卓）：**

执行此代码后，我得到的结果数据是 ??? 而是希伯来字符。我尝试了所有不同的编码，例如'windows-1255'、'iso-8859-8' 有谁知道问题出在哪里？谢谢！

```
// Create new default http client
    HttpClient client = new DefaultHttpClient();
    HttpConnectionParams.setConnectionTimeout(client.getParams(), 10000); // Timeout Limit
    HttpConnectionParams.setSoTimeout(client.getParams(), 10000);
    HttpResponse response;
    HttpPost post = new HttpPost(serviceURL);

    try {
        StringEntity se = new StringEntity(requestPayload.toString());
        post.addHeader(CustomHeader.TASK_NAME.getHeaderName(), taskName);
        se.setContentType(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
        post.setEntity(se);

        // Execute the request
        response = client.execute(post);

        // Get the response status code
        StatusLine statusLine = response.getStatusLine();
        int statusCode = statusLine.getStatusCode();

        if (statusCode == 200) { // Ok
            if (response != null) { // Checking response
                InputStream in = response.getEntity().getContent(); // Get the data in the entity
                retreturnVal = HttpCaller.readContentFromIS(in);
            }
        }
    } catch (Exception e) {
        Log.e("Error in connectivity layer, stacktrace: ", e.toString());
        return null;
    }

    public static String readContentFromIS(InputStream in) throws IOException {
    BufferedReader reader = new BufferedReader(
            new InputStreamReader(in, "UTF-8"), 8);
    StringBuffer sb = new StringBuffer();
    String line = "";
    while ((line = reader.readLine()) != null) {
        sb.append(line + "\n");
    }
    return sb.toString();       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T01:36:23.200

假设您在服务器上使用 a `ServletResponse`，而不是调用

```
resp.setHeader("Content-Type", "application/json; charset=UTF-8"); 
```

你应该打电话

```
resp.setContentType("application/json; charset=UTF-8"); 
```

这应该具有将调用中使用的编码更改`getWriter()`为 UTF-8 的效果。我不认为打电话`setHeader`有同样的副作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T17:54:43.793

我有同样的问题，但我做到了

```
 StringEntity se = new StringEntity(requestPayload.toString(), "UTF-8"); 
```

代替

```
 StringEntity se = new StringEntity(requestPayload.toString()); 
```

它对我来说很好，这是另一种解决方案。

# javascript - JS/HTML5 等距游戏引擎，类似“simcity”

> ID：12003982
> 
> 赞同：3
> 
> 时间：2012-08-17T10:20:16.767
> 
> 标签：javascript, html, html5-canvas, game-engine, isometric

我需要选择一个游戏引擎/库来启动一个“simcity”项目，比如针对浏览器+facebook的游戏。到目前为止，我发现了两个看起来很有前途的引擎（示例不会导致渲染伪影）：

[http://www.isogenicengine.com/](http://www.isogenicengine.com/)（付费） [http://libcanvas.github.com/](http://libcanvas.github.com/)（开源测试版）

任何人都可以使用这些或其他等距游戏（回合制）引擎。或者我应该重新发明轮子:)

提前致谢！

# macos - 与 qtkitserver 通信失败：连接无效

> ID：12003985
> 
> 赞同：5
> 
> 时间：2012-08-17T10:20:30.480
> 
> 标签：macos, quicktime

在 Mountain Lion（全新安装，而不是从 10.6 或 10.7 升级）中，我在尝试创建 QTMovie 时遇到了这个问题，但有以下例外：

```
2012-08-17 15:34:49.434 DemoApp[15995:303] Failed to communicate with qtkitserver:      
Connection invalid
2012-08-17 15:34:49.434 DemoApp [15995:303] Failed to initializeServer(), returned 5
2012-08-17 15:34:55.614 DemoApp [15995:303] Error -  Error Domain=NSOSStatusErrorDomain   Code=-2012 
 "The movie contains an invalid data reference." (invalidDataRef) 
 UserInfo=0x108ae9ca0 {NSLocalizedDescription=The movie contains an invalid data reference.} 
```

我的代码如下：

```
 NSError *error = nil;

        movie = [QTMovie movieWithURL:mediaURL error:&error];

        NSLog(@"Error -  %@", error); 
```

但是“电影”对象为零。谁可以帮我这个事。

提前致谢，

# c# - 将 HTTP 发布到 ashx 时，.net 4.5 Callcontext 中的重大变化？

> ID：12003988
> 
> 赞同：2
> 
> 时间：2012-08-17T10:20:42.650
> 
> 标签：c#, asp.net

我刚刚安装了 .Net 4.5，并注意到当我尝试从 CallContext 中检索项目时，仍然在 .Net 4 下运行的现有 Web 应用程序失败，而在安装工作正常并且已经完成之前最后一年。

在应用程序的 AuthenticateRequest 事件中，我们使用用户的身份来加载更多关于用户的安全信息。然后将其添加到 CallContext 以供以后使用。

例如

```
 protected void Application_AuthenticateRequest(object sender, EventArgs e)
    {
        if (HttpContext.Current.User != null && HttpContext.Current.User.Identity.IsAuthenticated)
        { 
             // set someValue 
            CallContext.SetData(ContextIdentifier, someValue);
        }
    } 
```

callcontext 中的值在生命周期的后期被检索。例如 CallContext.GetData(ContextIdentifier)

但是，当从 http“POST”请求中请求 .ashx 时，该值现在为 null，但在“GET”请求中，该值是正确的。

我找不到记录的原因为什么突然改变了，或者这是否是现在的设计以及为什么它会影响现有的 .Net 4 应用程序？

我明显的解决方法是将数据也放在 HTTPContext 上，但不了解我不确定使用 CallContext 是否会在其他地方引起问题的原因！

任何帮助/理解将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T19:37:18.440

[http://forum.springframework.net/showthread.php?572-CallContext-vs-ThreadStatic-vs-HttpContext](http://forum.springframework.net/showthread.php?572-CallContext-vs-ThreadStatic-vs-HttpContext)

看起来这是处理调用上下文的 http 管道，但由于改进，我现在只能看到它

# php - 如何将变量合并到数组中，同时保留变量名作为键

> ID：12003992
> 
> 赞同：6
> 
> 时间：2012-08-17T10:21:14.987
> 
> 标签：php, arrays

我有一个数组：

```
$countries = array( 
 "af" => "Afghanistan",
 "ax" => "Åland Islands",
 "al" => "Albania",
 "dz" => "Algeria"
); 
```

和一些变量：

```
$as = "American Samoa";
$ad = "Andorra"; 
```

如何将变量组合到数组中，同时保持变量名作为数组中的键？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T10:24:28.093

您可以使用[`compact`](http://php.net/manual/en/function.compact.php)从变量中创建一个数组，然后简单地[将两个数组](http://php.net/manual/en/language.operators.array.php)相加：

```
$countries += compact('as', 'ad'); 
```

**[看到它在行动](http://ideone.com/fdI6S)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:27:32.557

```
foreach(array('as','ad') as $name){
  $countries[$name] = $$name;
} 
```

# java - 以下代码中将 Big Decimal 初始化为 -99 的含义

> ID：12003993
> 
> 赞同：2
> 
> 时间：2012-08-17T10:21:20.090
> 
> 标签：java, hashtable

我知道哈希表不允许空键......但是下面的代码是如何工作的。

在下面的代码中将 Big Decimal 初始化为 -99 的作用是什么。

```
private static final BigDecimal NO_REGION = new BigDecimal (-99);

public List getAllParameters (BigDecimal region, String key) {
    List values = null;
    if (region==null) {
        region = NO_REGION;
    }
    Hashtable paramCache = (Hashtable)CacheManager.getInstance().get(ParameterCodeConstants.PARAMETER_CACHE);
    if (paramCache.containsKey(region)) {
        values = (List) ((Hashtable)paramCache.get(region)).get(key); 
    }

    return values;
} 
```

纠结了好久还是不明白。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T10:26:00.403

这是[*空对象模式*](http://en.wikipedia.org/wiki/Null_Object_pattern)的一个实现：一个特殊的对象 ,被指定在不允许“真实”s 的情况下`BigDecimal(-99)`扮演角色。`null``null`

唯一的要求是空对象必须不同于所有“常规”对象。这样，下次程序需要查找没有区域的条目时，它需要做的就是`NO_REGION`按键查找。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T10:23:26.940

区域由哈希表（键）中的 BigDecimal 标识 - 如果未提供区域（空），则使用默认值 -99。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T11:32:00.997

对我来说，它看起来就像糟糕的代码——如果这么短的代码让你“挣扎了很长时间”，那通常是最好的指标。

稍微清理一下，它可能会更有意义：

```
private static Hashtable paramCache = (Hashtable)CacheManager.getInstance().get(ParameterCodeConstants.PARAMETER_CACHE);

public List getAllParameters (BigDecimal region, String key) {
    List values = null;
    if (region != null && paramCache.containsKey(region)) {
        Hashtable regionMap = (Hashtable) paramCache.get(region); 
        values = (List) regionMap.get(key); 
    }
    return values;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T10:25:42.147

似乎哈希表的编写者使用 NO_REGION 作为没有区域的值的键。所以，读者也在做同样的事情。