# StackOverflow 问答 000792000-000792999

# silverlight - Silverlight 可以执行以下操作吗？

> ID：792002
> 
> 赞同：3
> 
> 时间：2009-04-27T01:40:33.697
> 
> 标签：silverlight, image-manipulation

我可以在 silverlight 页面/应用程序中执行以下操作吗？（注意：silverlight 应用程序将嵌入 ASP.NET MVC 网站页面）：-

1.  显示来自资源的图像：例如。www.someDomain.com/image.png
2.  要显示的图像的 URL 被*传递到*控件中（即它不是硬编码的，而是 .. 说 .. 通过用户在页面上输入到文本框）。
3.  调整图像大小。
4.  向图像添加图层。图层可能是..我不知道..一些基本文本或其他图像或图标
5.  更改图层字体的字体或字体大小。
6.  通过 HTTP-POST 将修改后的图像“保存”到另一个 url。因此，如果我调整了图像大小或添加了一些文本层，这些都将呈现为单个位图（png/jpg/whatever），然后将其作为二进制发布到 url。（即多部分/表单数据）

### 笔记：

我之前[问过这个问题，](https://stackoverflow.com/questions/636806/can-a-client-flash-swf-file-do-the-following/637857)但那是针对 Flash (flv/swf) 的。我现在对这是否可以在 Silverlight 中完成感兴趣。

### 更新的问题

另外，创建这些 Silverlight 应用程序需要什么软件？VS2008？表情融合？我知道你可以使用记事本..但我对此很陌生，我需要一些所见即所得的应用程序，我希望。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T02:16:04.500

是的，它可以，但它具有与 flash 类似的跨域限制。您需要在远程服务器上放置一个 crossdomain.xml 或 clientaccesspolicy.xml 以允许 silverlight 与它们通信。[这里](http://msdn.microsoft.com/en-us/library/cc645032(VS.95).aspx)有一篇 ms 文章，提供了有关使用 silverlight 与其他服务器通信的限制的更多信息。

一旦你有了图像，你就可以在客户端使用普通的 .net 库来操作它。

所以你可以加载它

```
Bitmap bitmap = new Bitmap(<some stream>);
Graphics g = Graphics.FromImage(bitmap); 
```

然后你可以用任何你想要的方式玩它。

```
g.DrawString("Silverlight image", 
    new Font("times", 32), 
    SystemBrushes.WindowText, 0, 0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T03:12:55.643

Writable Bitmap API Silverlight 3 听起来很符合您的要求。您可以使用标准 Silverlight 控件（例如 TextBlock 和 Image）来放置图像和图层，然后使用 API 对该布局进行“屏幕截图”以上传到服务器。

希望这可以帮助。

# .net - 异步方法的目的是什么？（。网）

> ID：792006
> 
> 赞同：1
> 
> 时间：2009-04-27T01:42:27.310
> 
> 标签：.net, asynchronous

在 ASP.NET 中，我们使用异步方法，因为线程池具有有限的插槽，并且通过使用异步方法，您可以在方法出站时释放线程池插槽，从而增加服务器在相同时间间隔内可以处理的请求数量.

我猜想在其他类型的应用程序（即 Windows 窗体）中，线程限制要高得多。在这种情况下，当您同时拥有两个版本（同步和异步）时，异步方法的目的是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T01:48:36.657

您可以在 ASP.NET 配置中增加工作线程池，我发现它对多核机器和 IIS 6 有很大帮助。从我对 IIS 7 所做的很少来看，它似乎可以更好地管理线程而不需要调整。

更直接的问题是为什么要同时使用两者……您可以异步一个工作单元，以便从池中释放一个线程以开始另一个工作单元，而无需等待另一个线程完成。这使该应用程序可以一次将更多工作并行化。

无论如何，您的所有 aspx 请求都在工作线程中执行，但是如果您异步请求的块，它可以执行部分​​请求并将线程返回到池中，而不是一次执行请求中的所有内容。

这很难掌握，所以要小心。:)

[http://www.guidanceshare.com/wiki/ASP.NET_2.0_Performance_Guidelines_-_Threading](http://www.guidanceshare.com/wiki/ASP.NET_2.0_Performance_Guidelines_-_Threading)

在 ASP 之外，对于 Windows 窗体，没有“无限”线程池之类的东西。当您启动的线程多于 box/os 可以处理的线程时，您将频繁地开始上下文切换，以至于您将违背线程的目的。我会进一步阅读该主题，因为它是一个非常大且高级的主题。

[http://en.wikipedia.org/wiki/Thread_(computer_science)](http://en.wikipedia.org/wiki/Thread_(computer_science))

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T03:43:57.643

异步方法的目的是提供响应速度更快的应用程序。如果您在同一个线程上运行所有任务，则每次您的线程必须执行长时间运行的同步操作时，应用程序似乎都会停止，因为您的线程正在等待操作完成，因此无法执行任何其他操作。为了解决这个问题，您可以分叉这些任务以使用异步调用分隔线程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T01:58:22.623

基本上，让线程无所事事地等待是一种浪费。这不是线程池有限或你能做到多大的问题。让每个线程都发挥最大容量是一种普遍的愿望。当一个线程可以做其他有用的事情时，让一个线程等待网络调用或很长一段时间的 I/O 是没有意义的。这种愿望在可扩展性、性能和吞吐量等概念中被量化，但这不一定是最终目标。最终目标是将稀缺资源（处理器）用于尽可能多的任务。一个有趣的对立面是并行化的概念。目标是在您拥有大量资源且不一定有那么多任务时正确分配任务。

# nhibernate - NHibernate 集合和移动对象

> ID：792009
> 
> 赞同：6
> 
> 时间：2009-04-27T01:43:56.263
> 
> 标签：nhibernate, collections

我刚刚遇到了 NHibernate 的一个主要问题。我有 2 个对象，每个对象都有一组东西。我需要将一个东西从对象 A 的集合移动到对象 B 的集合。我收到有关已删除对象的错误，因为我相信 NHibernate 在需要保留它时会尝试从对象 A 的集合中删除它对于对象 B。从数据库的角度来看，这只是将“父”属性更新为新对象（对象 B）的问题。但是对于这些收藏品，我真的不确定该怎么做...

在 NHibernate 中是否有一个众所周知的过程可以将对象从一个集合移动到另一个集合？

提前感谢您的帮助。

问候，

埃里克。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T21:15:41.903

我假设您在由对象 A 和 B 表示的类的映射中使用 Cascade，即 A 和 B 都是某个类 X 的实例，并且 X 的映射在包含要成为的对象的集合上包含一个级联属性转移。

鉴于这一假设，这可能会有所帮助。

如果您希望能够将对象从一个集合转移到另一个集合，您需要考虑被移动的东西是否应该具有独立于两个集合的存在。

如果传输对象没有自行保存，则在执行传输时会遇到问题，因为会话已经知道传输的对象。

我能想到的出路有两种。两者中更好的可能是将传输对象视为一个独立的对象，它自己保存到数据库中（即，在对象与集合的映射中不依赖级联）。从概念上讲，这是有道理的，因为如果您可以将它从一个集合转移到另一个集合，这意味着它以某种方式独立于具有集合的两个对象。这确实意味着您最终可能会成为孤儿。

如果您想在映射中坚持使用级联，那么您需要在与添加到对象 B 不同的事务中从对象 A 中删除。我怀疑这不是您想要做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T20:55:09.490

您是否尝试过使用映射

> 级联=“所有删除孤儿”

# python - 无法在 os x terminal.app 上的 python 中解码 utf-8 字符串

> ID：792017
> 
> 赞同：4
> 
> 时间：2009-04-27T01:47:47.237
> 
> 标签：python, macos, unicode, terminal

我将 terminal.app 设置为接受 utf-8 并且在 bash 中我可以输入 unicode 字符，复制并粘贴它们，但是如果我启动 python shell 我不能，如果我尝试解码 unicode 我会收到错误：

```
>>> wtf = u'\xe4\xf6\xfc'.decode()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-2: ordinal not in range(128)
>>> wtf = u'\xe4\xf6\xfc'.decode('utf-8')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/encodings/utf_8.py", line 16, in decode
    return codecs.utf_8_decode(input, errors, True)
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-2: ordinal not in range(128) 
```

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-27T03:12:20.450

我认为到处都存在编码/解码混乱。你从一个 unicode 对象开始：

```
u'\xe4\xf6\xfc' 
```

这是一个 unicode 对象，三个字符是“äöü”的 unicode 代码点。如果你想把它们变成 Utf-8，你必须对它们进行**编码**：

```
>>> u'\xe4\xf6\xfc'.encode('utf-8')
'\xc3\xa4\xc3\xb6\xc3\xbc' 
```

生成的六个字符是“äöü”的 Utf-8 表示。

如果调用`decode(...)`，则尝试将字符解释为仍需要转换为 unicode 的某种编码。因为它已经是 Unicode，所以这不起作用。您的第一次调用尝试将 Ascii 转换为 Unicode，第二次调用尝试将 Utf-8 转换为 Unicode。由于`u'\xe4\xf6\xfc'`既不是有效的 Ascii 也不是有效的 Utf-8，这些转换尝试失败。

进一步的混淆可能来自`'\xe4\xf6\xfc'`“äöü”的Latin1 / ISO-8859-1编码这一事实。如果您编写一个普通的 python 字符串（没有将其标记为 unicode 的前导“u”），您可以将其转换为 unicode 对象`decode('latin1')`：

```
>>> '\xe4\xf6\xfc'.decode('latin1')
u'\xe4\xf6\xfc' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T01:58:48.287

我认为你有向后编码和解码。您将 Unicode 编码为字节流，并将字节流解码为 Unicode。

```
Python 2.6.1 (r261:67515, Dec  6 2008, 16:42:21) 
[GCC 4.0.1 (Apple Computer, Inc. build 5370)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> wtf = u'\xe4\xf6\xfc'
>>> wtf
u'\xe4\xf6\xfc'
>>> print wtf
äöü
>>> wtf.encode('UTF-8')
'\xc3\xa4\xc3\xb6\xc3\xbc'
>>> print '\xc3\xa4\xc3\xb6\xc3\xbc'.decode('utf-8')
äöü 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T02:14:56.360

```
>>> wtf = '\xe4\xf6\xfc'
>>> wtf
'\xe4\xf6\xfc'
>>> print wtf
���
>>> print wtf.decode("latin-1")
äöü
>>> wtf_unicode = unicode(wtf.decode("latin-1"))
>>> wtf_unicode
u'\xe4\xf6\xfc'
>>> print wtf_unicode
äöü 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T02:13:28.173

介绍性教程的[Unicode 字符串](http://docs.python.org/tutorial/introduction.html#unicode-strings)部分很好地解释了它：

> 为了使用特定编码将 Unicode 字符串转换为 8 位字符串，Unicode 对象提供了一个 encode() 方法，该方法接受一个参数，即编码的名称。编码的小写名称是首选。
> 
> ```
> >>> u"äöü".encode('utf-8')
> '\xc3\xa4\xc3\xb6\xc3\xbc' 
> ```

# java - 如何使用 Java 执行系统命令 (linux/bsd)

> ID：792024
> 
> 赞同：41
> 
> 时间：2009-04-27T01:50:52.563
> 
> 标签：java, output-redirect

我试图廉价并`uname -a`在 Java 中执行本地系统命令 ()。我正在寻找从中获取输出`uname`并将其存储在字符串中。这样做的最佳方法是什么？当前代码：

```
public class lame {

    public static void main(String args[]) {
        try {
            Process p = Runtime.getRuntime().exec("uname -a");
            p.waitFor();
            BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream()));
            String line=reader.readLine();

            while (line != null) {    
                System.out.println(line);
                line = reader.readLine();
            }

        }
        catch(IOException e1) {}
        catch(InterruptedException e2) {}

        System.out.println("finished.");
    }
} 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-27T02:01:33.460

你的方式离我可能会做的不远：

```
Runtime r = Runtime.getRuntime();
Process p = r.exec("uname -a");
p.waitFor();
BufferedReader b = new BufferedReader(new InputStreamReader(p.getInputStream()));
String line = "";

while ((line = b.readLine()) != null) {
  System.out.println(line);
}

b.close(); 
```

当然，处理您关心的任何异常。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-27T02:06:55.223

这是最好的方法。您也可以使用具有可变参数构造函数的[ProcessBuilder](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)，因此您可以节省一两行代码

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T02:03:45.917

你在做什么看起来不错。如果您的命令仅返回单个字符串，则不需要 while 循环，只需将 reader.readLine() 值存储在单个 String 变量中。

此外，您可能应该对这些异常做点什么，而不是仅仅吞下它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-20T05:58:08.737

我知道这已经很老了，但仍然......

在这里阅读文章： [http](http://www.javaworld.com/article/2071275/core-java/when-runtime-exec---won-t.html)
://www.javaworld.com/article/2071275/core-java/when-runtime-exec---won-t.html 我的理解是您应该首先阅读输出和错误流您执行的命令，然后才是`waitFor`您的进程的返回值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-07T01:31:44.123

我知道这个问题很老了，但我只是想添加一些可能对某些人有用的信息。

如果您只想从 java 代码运行 uname 命令，最好使用 System 类来获取有关系统的信息。

它不仅会消除运行终端命令的依赖性，而且还可以独立于操作系统工作。

系统类可以给你以下信息

> 键：值
> 
> --> os.version : 操作系统版本
> --> os.name : 操作系统名称
> 
> --> os.arch : 操作系统架构
> 
> --> java.compiler : 您正在使用的编译器的名称
> 
> --> java.ext.dirs : 扩展目录路径
> 
> --> java.library.path : 加载时搜索库的路径
> 
> --> user.dir : 用户当前工作目录
> 
> --> user.name : 用户的账户名
> 
> --> java.vm.version : JVM 实现版本
> 
> --> java.vm.name : JVM 实现名称
> 
> --> java.home : Java安装目录
> 
> --> java.runtime.version : JVM 版本

（来源 - [https://www.geeksforgeeks.org/getproperty-and-getproperties-methods-of-system-class-in-java/](https://www.geeksforgeeks.org/getproperty-and-getproperties-methods-of-system-class-in-java/)）

例如：如果我正在运行基于 Linux 的系统，比如 Ubuntu，以下命令将为我提供有关它的信息。

```
System.getProperty("os.name"); 
```

# iphone - 如何取消 UIWebView 中的文本字段编辑？

> ID：792035
> 
> 赞同：3
> 
> 时间：2009-04-27T01:57:08.867
> 
> 标签：iphone, cocoa-touch

我正在开发一个带有嵌入式 UIWebView 的应用程序。

用户可以在 Web 视图的文本字段中输入位置，但也会努力使用核心位置来发现当前位置。

如果核心位置提供了准确的答案并且用户当前正在编辑位置，我想取消编辑并以编程方式填充位置字段。这是基于这样的假设，即用户在绝大多数时间都希望使用他们当前的位置，并且如果他们正在编辑该字段，他们宁愿它是自动填充的，而不是必须完成输入他们的位置。

我的问题是，如何取消 UIWebView 中的编辑？如果它是一个普通的文本输入字段，我会强制它退出第一响应者并且键盘会消失，但我不知道如何使用 UIWebView 来做到这一点。将 resignFirstResponder 发送到 Web 视图不会这样做。

有什么可以在 web 视图上使用 Javascript 和 stringByEvaluatingJavaScriptFromString: 来完成的吗？还有其他方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-11-25T18:09:09.480

只需使用 [webView endEditing:YES];

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-24T18:04:23.193

```
[webView stringByEvaluatingJavaScriptFromString:@"document.activeElement.blur();"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T03:17:27.677

最好的选择是 Javascript 方法，查看表单字段的焦点值，看看是否可以让它失去焦点。

看起来您可能想要的是：

```
window.blur(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T07:04:13.830

所以诀窍是使用'blur()'，但只能在选定的字段上，而不是整个窗口。

如果 'self' 是 UIWebView 的子类，则以下代码片段可以解决问题：

```
[self stringByEvaluatingJavaScriptFromString:@"document.getElementsByName('textField')[0].blur();"]; 
```

# flash - ActionScript 3.0，动态滚动条

> ID：792036
> 
> 赞同：1
> 
> 时间：2009-04-27T01:57:31.097
> 
> 标签：flash, actionscript-3

我正在尝试为我正在使用 Flash (ActionScript 3) 处理的项目创建一些动态滚动条。

不久前我在 AS2 中写过滚动条，但我似乎无法为 AS3 整理出我脑海中的所有内容。

基本上，我正在寻找与[http://tutorials.parseidon.com/code-script/actionscript/flash-scrollbar/](http://tutorials.parseidon.com/code-script/actionscript/flash-scrollbar/)中的教程完全相同的教程，但 AS3 除外。

有谁知道我在哪里可以找到一个？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T01:14:17.837

最好的（也是最简单的）滚动条教程之一是由 GotoAndLearn.com 的 Lee Brimelow 提供的两部分视频教程。它们还将为您提供 AS3 中 OOP 的良好基础。

[面向对象的滚动条：第 1 部分](http://www.gotoandlearn.com/play?id=71)

[面向对象的滚动条：第 2 部分](http://www.gotoandlearn.com/play?id=72)

这应该符合您的需要，因为它基于滚动影片剪辑。因此，只要您将所有动态内容加载到容器 mc 中，并在更改内容时更新滚动条，您就应该离开了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:32:01.520

对于任何研究此问题的人：

我最终发现非常适合我的滚动条是：

[http://blog.voq.jp/2007/09/scrolling_component_likes_ipho.html](http://blog.voq.jp/2007/09/scrolling_component_likes_ipho.html)

它有一个 iPhone 风格的滚动条，而且很容易实现。[此外，它是根据 APL ( http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0) )获得许可的，所以我也很高兴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T02:34:29.900

有什么理由不能使用已经编写的现有 10,000 个 AS3 滚动条之一？我认为这是最好不要重新发明轮子的情况之一。我讨厌没有 100% 正确实现的 flash 滚动条，我希望每个人都使用写得好的滚动条。PS：可换肤滚动条组件甚至包含在 flash 和 flex 中，因此您不必看很远就能找到它们。

# c++ - fstream 替换文件的一部分

> ID：792040
> 
> 赞同：1
> 
> 时间：2009-04-27T01:58:36.133
> 
> 标签：c++, io, fstream

当我做

```
fstream someFile("something.dat", ios::binary|ios::out);
someFile.seekp(someLocation, ios::beg);
someFile.write(someData, 100); 
```

它似乎用这 100 个字节替换整个文件，而不是只替换适当的 100 个字节，就好像我指定了 ios::trunc。有没有一种可移植的方式让它不截断文件？

**编辑：**添加 ios::in 似乎可以解决问题，为什么需要这样做，这是标准行为吗？

**编辑#2：**我不想附加到现有文件。我需要替换 100 个字节，而其余部分不受影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T02:11:31.720

AFAIR ios::out 仅指定文件用于输出，而 ios:binary 仅指定文件为二进制文件。流的默认行为是创建一个新文件并覆盖旧文件。如果要修改现有文件，必须使用 ios::app 标志打开文件。

ATM 我无法检查我的参考资料，所以一定要仔细检查，但我相信这是准确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T02:16:10.630

如果要在文件末尾写入，则需要附加标志 ios::app。

要在文件中间任意位置执行此操作，您需要找到正确的位置。您可以通过打开文件输入和输出来执行此操作，但如果我是您，我会创建一个临时文件，将输入复制到标记，写入新数据，将其余数据复制到 EOF，关闭文件并替换以前的文件带有临时文件的版本。这称为“主文件更新”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T13:29:26.783

由于文件已经存在，以“读+写”模式打开它，然后执行 seekp。我认为它会起作用。

```
fstream someFile("something.dat", ios::binary|ios::out|ios::in);
someFile.seekp(someLocation, ios::beg);
someFile.write(someData, 100); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T02:12:25.100

ios:in 掩码告诉文件指针指向文件开头的位置，以便它可以从头开始读取。但是，您可能希望使用 fseek 将文件指针设置在文件的开头。

# c# - 什么是在两个图像之间转换的最有效方法（如 Mac 壁纸更改）

> ID：792050
> 
> 赞同：1
> 
> 时间：2009-04-27T02:02:38.650
> 
> 标签：c#, algorithm, image-processing

我正在开发墙纸应用程序。用户指定的壁纸每隔几分钟更换一次。

我想要的功能是在淡出旧图像的同时淡入新图像。如果每 X 分钟更换一次壁纸，任何拥有 Mac 的人都可能会看到我想要的行为。

我目前关于如何处理的想法是拍摄两张图像并将一张放在另一张上并改变不透明度。以 90% 开始旧图像，以 10% 开始新图像。然后我会将旧图像减少 10% 直到它为 0%，同时将新图像增加 10% 直到 90%。然后我会将壁纸设置为新图像。

为了让它看起来像一个平滑的过渡，我会在开始这个过程之前创建过渡壁纸，而不是实时进行。

我的问题是，有没有更有效的方法来做到这一点？

我可以考虑一些优化，例如以较低质量保存过渡图像。

关于可以使这比我描述的更有效的方法的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T02:29:51.097

听起来像是一个权衡的问题。

这取决于重点：

*   渲染速度
*   资源使用

渲染速度将是一个问题，即混合图像的过程需要多长时间才能渲染到屏幕可绘制的图像。如果混合过程花费的时间太长（因为与常规的不透明绘图操作相比，透明效果可能需要很长时间），那么预渲染过渡可能是一个好方法。

当然，预渲染意味着在内存或磁盘存储中将有多个图像必须保留。这意味着将需要更多资源来临时存储过渡效果。如果资源稀缺，那么即时进行过渡可能更可取。此外，如果图像在磁盘上，由于主内存之外数据的 I/O 速度较慢，性能将会受到影响。

关于“以较低质量保存过渡图像”的问题-“较低质量”是什么意思？你的意思是压缩图像？或者，你的意思是有更小的图像？我可以看到每种方法的一些优点和缺点。

*   **压缩图像**

    *   **优点：**每张图片消耗的内存量会更少。这将需要更少的磁盘空间或内存空间。
    *   **缺点：**图像的解压需要处理。解压缩的图像在被绘制到屏幕之前会占用内存中的额外空间。如果使用 JPEG 等有损压缩，则可能会出现压缩伪影。
*   **使用较小的图像**

    *   **优点：**同样，每张图像使用的内存量会更少。
    *   **缺点：**将图像拉伸到屏幕尺寸的过程需要一些处理能力。同样，需要额外的内存来生成拉伸的图像。

最后，有一点需要考虑——**实时渲染过渡真的不够快吗？**

实际上可能会证明渲染不会花费太长时间，而这可能都是[过早的优化](http://en.wikipedia.org/wiki/Optimization_(computer_science)#When_to_optimize)。

在没有任何优化的情况下制作原型可能值得一试，看看是否真的有必要预渲染过渡。分析流程的每个步骤以查看需要时间的内容[。](http://en.wikipedia.org/wiki/Profiling_(software))

如果动态渲染的性能不令人满意，请权衡每种预渲染方法的优点和缺点，然后选择一个看起来效果最好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T02:28:59.757

预渲染过渡的每个混合帧将占用大量磁盘空间（以及潜在的带宽）。最好简单地加载两个图像并使用显卡实时进行混合。如果你必须直接使用 openGL 之类的东西，你可能只需要创建两个矩形，将图像设置为纹理，并改变 alpha 值。大多数系统都有更简单的 2d api，可以让你很容易地做到这一点。（例如，OS X 上的 CoreAnimation，它会随着时间的推移自动改变透明度并充分利用硬件加速。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T02:33:45.830

如果由显卡处理，动态渲染应该足够快，特别是如果它是具有不同不透明度的相同纹理（很多图形渲染时间通常是将纹理加载到卡上，有没有想过游戏加载屏幕实际上在做什么？ )

# cocoa - 如何将图像导出到文件夹？

> ID：792056
> 
> 赞同：0
> 
> 时间：2009-04-27T02:07:39.560
> 
> 标签：cocoa

现在我想将我的项目中的图像导出到一个文件夹，我认为这是 NSBundle 和 NSFileManager 的问题，但我不知道如何处理它？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T02:27:06.377

```
[[someImage TIFFRepresentation] writeToFile:@"path/to/file.tiff" atomically:NO]; 
```

将 NSImage 导出为 tiff 文件，尽管您的问题有点模糊

# sql - 如何使用 SQL 设置 Access 2003 字段的默认值？

> ID：792059
> 
> 赞同：3
> 
> 时间：2009-04-27T02:08:20.667
> 
> 标签：sql, database, ms-access

如何在 MS Access 中使用 SQL 设置字段的默认值？

我试过了，但出现语法错误：

```
CREATE TABLE HELLO
( MUN INTEGER  NOT NULL,
ADD   CHAR(50) DEFAULT'16 asd ST.'
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T10:54:06.190

和关键字仅在 ACE/Jet 引擎的 ANSI-92 查询模式中受支持`DEFAULT`（`CHAR`然后仅在 SQL DDL 中）。正如 Jose Basilio 指出的那样，`ADD`是一个保留字，必须使用方括号进行转义。`DEFAULT`此外，您需要在单词及其子句之间留一个空格（如 Jose 所示）。

如果您在 MS Access 界面中的 Query 对象中执行 SQL，则需要将默认（ANSI-89 查询模式）更改为 ANSI-92 查询模式。请参阅：[关于 ANSI SQL 查询模式](http://office.microsoft.com/en-us/access/HP030704831033.aspx)。

如果您正在以编程方式创建表，例如您正在使用 DAO，那么请尝试使用`CurrentProject.Connection.Execute`“Sql 转到此处”，其中`CurrentProject.Connection`ADO 经典或其他 OLE DB 连接到您的数据源。

PS当然你希望你的专栏是`HELLO.Mum`:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T02:52:39.030

ADD 这个词是一个关键字。尝试这个：

```
CREATE TABLE HELLO
( 
    MUN INTEGER  NOT NULL,
    [ADD] CHAR(50) DEFAULT '16 asd ST.'
) 
```

# sql - 为什么 SQL 语句在“有限”的情况下需要这么长时间？

> ID：792060
> 
> 赞同：1
> 
> 时间：2009-04-27T02:09:08.463
> 
> 标签：sql, postgresql

考虑以下 pgSQL 语句：

```
SELECT DISTINCT some_field 
  FROM some_table 
  WHERE some_field LIKE 'text%' 
  LIMIT 10; 
```

还要考虑一下， some_table 包含几百万条记录，并且 some_field 有一个 b-tree 索引。

为什么查询需要这么长时间才能执行（几分钟）？我的意思是，为什么它不循环创建结果集，一旦得到 10 个，就返回结果？无论您是否包含“LIMIT 10”，执行时间看起来都是一样的。

这是正确的还是我错过了什么？我能做些什么来让它返回前 10 个结果并“搞定”其余的？

更新：如果你放弃不同的，结果几乎是瞬间返回的。但是，我确实知道，许多 some_table 记录已经相当独特，而且当我在没有明确声明的情况下运行查询时，前 10 个结果实际上是唯一的。我还消除了 where 子句（将其作为一个因素消除）。所以，我最初的问题仍然存在，为什么它不是在找到 10 个匹配项后立即终止？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T02:13:22.230

你有一个不同的。这意味着要找到 10 个不同的行，必须扫描与谓词匹配的所有行，直到找到 10 个*不同*的 some_fields。

根据您的索引，查询优化器可能会决定扫描所有行是执行此操作的最佳方式。

10 个不同的行可以代表 10 个，一百万个，无限的非不同行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T02:45:27.237

您可以发布在查询上运行 EXPLAIN 的结果吗？这将揭示 Postgres 执行查询的过程，通常是诊断查询性能问题的第一步。

在将第一行返回给 LIMIT 运算符之前，它可能正在排序或构造整个行集的哈希表以消除不明确的记录。引擎应该能够读取一小部分记录，一次返回一个新的不同记录，直到 LIMIT 子句满足其 10 个配额，这是有道理的，但可能没有实现该操作的操作符。

some_field 是唯一的吗？如果不是，则在定位不同的记录方面将毫无用处。如果是，则不需要 DISTINCT 子句，因为该索引已经保证每行在 some_field 上都是唯一的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T02:44:37.770

任何时候有一个涉及聚合的操作，并且“DISTINCT”肯定是合格的，优化器会在考虑下一步之前进行聚合。聚合意味着扫描整个表（在您的情况下涉及排序，除非有索引）。

但最有可能破坏交易的是您正在对列上的操作进行分组，而不是简单的列值。一旦您对某种列转换进行操作，优化器通常会忽略许多可能的操作。知道“LIKE 'text%'”和“='text'”的顺序对于分组目的是相同的，这很可能不够聪明。

请记住，您正在对列上的操作进行聚合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T02:45:21.620

桌子有多大？你的表上有索引吗？检查您的查询执行计划以确定它是在执行表扫描、索引扫描还是索引查找。如果它正在执行表扫描，那么您很可能没有任何索引。

尝试在您过滤的字段和/或您选择的字段上放置索引。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-27T02:12:22.107

我怀疑这是因为你没有 ORDER BY。如果没有订购，您可能需要浏览大量记录才能获得 10 条符合您标准的记录。

# c# - 如何让 linq 准确生成我想要的 sql？

> ID：792094
> 
> 赞同：6
> 
> 时间：2009-04-27T02:33:50.947
> 
> 标签：c#, sql, linq

编写一些复杂的 SQL 集处理代码来解决各种领域模型问题是我的第二天性。但是，趋势是不再接触 SQL。 **是否有一些模式参考或转换工具可以帮助将各种 SQL 模式转换为 Linq 语法？**

我会查找编写如下代码的方法：（这有一个子查询）：

```
SELECT * FROM orders X WHERE
(SELECT COUNT(*) FROM orders Y
WHERE Y.totalOrder > X.totalOrder) < 6 
```

（获取副作用最高的前五名总订单）

**或者，您如何知道 Linq 在不使用调试器的情况下作为单个语句执行？** 我知道您需要遵循枚举，但我假设只是在某处查找模式。

这来自 MSDN 站点，这是他们进行 SQL 差异的示例。我可能错了，但我认为这不会在服务器上使用集合处理（我认为它在本地拉两个集合然后取差，这将非常低效）。我可能错了，这可能是该参考文献中的一种模式。

SQL差异示例：

```
var differenceQuery =
(from cust in db.Customers
select cust.Country)
.Except
    (from emp in db.Employees
    select emp.Country); 
```

谢谢

## - 更新：

-- [Microsoft 的 C# 中的 101 个 Linq 示例](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)是一种更接近的以模式构造 linq 以生成所需 SQL 的方法。当我找到它们时，我会发布更多。我真的在寻找将 SQL 转换为 Linq 的方法（模式或转换工具）。

## -- 更新（来自 Microsoft 在 Linq 中的差异模式的 sql）：

```
SELECT DISTINCT [t0].[field] AS [Field_Name]
FROM [left_table] AS [t0]
WHERE NOT (EXISTS(
SELECT NULL AS [EMPTY]
FROM [right_table] AS [t1]
WHERE [t0].[field] = [t1].[field]
)) 
```

那是我们想要的，而不是我所期望的。所以，这是要记住的一种模式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T08:40:32.983

如果您有手写 SQL，则可以使用 ExecuteQuery，将“行”类的类型指定为函数模板参数：

```
var myList = DataContext.ExecuteQuery<MyRow>(
    "select * from myview"); 
```

“行”类将列公开为公共属性。例如：

```
public class MyRow {
    public int Id { get; set; }
    public string Name { get; set; }
    ....
} 
```

您可以使用更多信息来装饰列：

```
public class MyRow {
    ....
    [Column(Storage="NameColumn", DbType="VarChar(50)")]
    public string Name { get; set; }
    ....
} 
```

以我的经验 linq to sql 不会生成很好的 SQL 代码，而且它生成的代码对于大型数据库来说会崩溃。linq to sql 做得非常好的是将存储过程暴露给您的客户端。例如：

```
var result = DataContext.MyProcedure(a,b,c); 
```

这允许您将 SQL 存储在数据库中，同时具有易于使用、自动生成的 .NET 包装器的优点。

要查看正在使用的确切 SQL，您可以使用 SQL Server Profiler 工具：

[http://msdn.microsoft.com/en-us/library/ms187929.aspx](http://msdn.microsoft.com/en-us/library/ms187929.aspx)

Linq-to-Sql 调试可视化工具：

[http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx)

或者您可以编写自定义代码来记录查询：

[http://goneale.wordpress.com/2008/12/31/log-linq-2-sql-query-execution-to-consoledebug-window/](http://goneale.wordpress.com/2008/12/31/log-linq-2-sql-query-execution-to-consoledebug-window/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T09:03:45.520

这就是为什么首先创建[Linq Pad的原因。](http://www.linqpad.net/):) 它使您可以轻松查看输出是什么。查询的结果是什么等等。最好的是它是免费的。也许不是您问题的答案，但我相信它可以帮助您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T02:46:47.390

如果您确切地知道您想要的 sql，那么您应该使用[ExecuteQuery](http://msdn.microsoft.com/en-us/library/bb361109.aspx)。

我可以想象几种方法来翻译您显示的查询，但如果您担心“除外”可能不会被翻译。

1.  测试一下。如果它以您想要的方式工作，那就太好了，否则：
2.  用您知道会翻译的项目重写它，例如：

    db.Customers.Where(c => !db.Employees.Any(e => c.Country == e.Country));

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T06:55:02.613

如果您担心生成的 TSQL，那么我建议将查询形式化为存储过程或 UDF，并通过数据上下文访问它们。UDF 方法具有稍好的元数据和可组合性（与存储过程相比）——例如，您可以向 UDF 查询添加`Where`/ `Skip`/`Take`等并让它在数据库中运行（但上次我检查时，只有 LINQ-to-SQL（不是实体框架）支持 UDF 使用）。

您也可以使用[`ExecuteQuery`](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executequery.aspx)，但让数据库拥有固定查询有好处。

重新查找 TSQL 执行了什么...使用 LINQ-to-SQL 您可以将任何`TextWriter`（例如，`Console.Out`）分配给[`DataContext.Log`](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.log.aspx).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T15:31:53.247

我相信最好的方法是使用存储过程。在这种情况下，您可以完全控制 SQL。

# iphone - 将 RSA 密钥导入 iPhone 钥匙串？

> ID：792097
> 
> 赞同：8
> 
> 时间：2009-04-27T02:34:56.157
> 
> 标签：iphone, objective-c, security, cryptography, rsa

我有几个 NSString 对象，它们代表一个 RSA 公私密钥对（不是由 SecKeyCreatePair 生成，而是由外部加密库生成）。如何从这些 NSString 对象创建 SecKeyRef 对象（SecKeyDecrypt/Encrypt 方法所需的对象）？

我需要先将它们导入钥匙串吗？如果是这样，怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-20T04:58:02.357

所以在iOS中，钥匙串是沙盒的，AFAIK。这意味着您放入钥匙串的任何内容都只能由您的应用程序和您的应用程序访问，除非您另有说明。您必须在项目设置的**功能**下启用*钥匙串共享。*

 **现在已经不碍事了，您当然可以导入数据。由于它们是`NSString`对象，因此您首先必须将其转换为`NSData`对象才能正确导入它们。最有可能的是，它们是用 Base64 编码的，所以你必须反过来：

```
NSData *decodedData = [[NSData alloc] initWithBase64EncodedString:base64String options:0]; 
```

现在已经完成了，您可以使用此方法将您的密钥保存到钥匙串并获取 SecKeyRef：

```
/**
 * key: the data you're importing
 * keySize: the length of the key (512, 1024, 2048)
 * isPrivate: is this a private key or public key?
 */
- (SecKeyRef)saveKeyToKeychain:(NSData *)key keySize:(NSUInteger)keySize private:(BOOL)isPrivate {
    OSStatus sanityCheck = noErr;
    NSData *tag;
    id keyClass;

    if (isPrivate) {
        tag = privateTag;
        keyClass = (__bridge id) kSecAttrKeyClassPrivate;
    }
    else {
        tag = publicTag;
        keyClass = (__bridge id) kSecAttrKeyClassPublic;
    }

    NSDictionary *saveDict = @{
            (__bridge id) kSecClass : (__bridge id) kSecClassKey,
            (__bridge id) kSecAttrKeyType : (__bridge id) kSecAttrKeyTypeRSA,
            (__bridge id) kSecAttrApplicationTag : tag,
            (__bridge id) kSecAttrKeyClass : keyClass,
            (__bridge id) kSecValueData : key,
            (__bridge id) kSecAttrKeySizeInBits : [NSNumber numberWithUnsignedInteger:keySize],
            (__bridge id) kSecAttrEffectiveKeySize : [NSNumber numberWithUnsignedInteger:keySize],
            (__bridge id) kSecAttrCanDerive : (__bridge id) kCFBooleanFalse,
            (__bridge id) kSecAttrCanEncrypt : (__bridge id) kCFBooleanTrue,
            (__bridge id) kSecAttrCanDecrypt : (__bridge id) kCFBooleanFalse,
            (__bridge id) kSecAttrCanVerify : (__bridge id) kCFBooleanTrue,
            (__bridge id) kSecAttrCanSign : (__bridge id) kCFBooleanFalse,
            (__bridge id) kSecAttrCanWrap : (__bridge id) kCFBooleanTrue,
            (__bridge id) kSecAttrCanUnwrap : (__bridge id) kCFBooleanFalse
    };

    SecKeyRef savedKeyRef = NULL;
    sanityCheck = SecItemAdd((__bridge CFDictionaryRef) saveDict, (CFTypeRef *)&savedKeyRef);
    if (sanityCheck != errSecSuccess) {
        LOGGING_FACILITY1(sanityCheck != noErr, @"Problem saving the key to keychain, OSStatus == %d.", sanityCheck);
    }

    return savedKeyRef;
} 
```

稍后，如果您想从钥匙串中检索 SecKeyRef，您可以使用以下命令：

```
- (SecKeyRef)getKeyRef:(BOOL)isPrivate {
    OSStatus sanityCheck = noErr;
    NSData *tag;
    id keyClass;
    if (isPrivate) {
        if (privateKeyRef != NULL) {
            // already exists in memory, return
            return privateKeyRef;
        }
        tag = privateTag;
        keyClass = (__bridge id) kSecAttrKeyClassPrivate;
    }
    else {
        if (publicKeyRef != NULL) {
            // already exists in memory, return
            return publicKeyRef;
        }
        tag = publicTag;
        keyClass = (__bridge id) kSecAttrKeyClassPublic;
    }

    NSDictionary *queryDict = @{
            (__bridge id) kSecClass : (__bridge id) kSecClassKey,
            (__bridge id) kSecAttrKeyType : (__bridge id) kSecAttrKeyTypeRSA,
            (__bridge id) kSecAttrApplicationTag : tag,
            (__bridge id) kSecAttrKeyClass : keyClass,
            (__bridge id) kSecReturnRef : (__bridge id) kCFBooleanTrue
    };

    SecKeyRef keyReference = NULL;
    sanityCheck = SecItemCopyMatching((__bridge CFDictionaryRef) queryDict, (CFTypeRef *) &keyReference);
    if (sanityCheck != errSecSuccess) {
        NSLog(@"Error trying to retrieve key from server. isPrivate: %d. sanityCheck: %li", isPrivate, sanityCheck);
    }

    if (isPrivate) {
        privateKeyRef = keyReference;
    }
    else {
        publicKeyRef = keyReference;
    }
    return keyReference;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-02T14:03:16.763

编辑：使用下面的方法，我们能够导入大小为 4096 的密钥。任何大于此大小的 RSA 密钥大小似乎都会被钥匙串拒绝。我们恢复了成功状态，但我们没有得到对密钥的引用。

只是关于导入 RSA 私钥/公钥的简短说明。就我而言，我需要导入由 OpenSSL 生成的私钥。

就将其放入钥匙串而言，[该项目完成了我想要的大部分工作。](https://github.com/kuapay/iOS-Certificate--Key--and-Trust-Sample-Project)如您所见，它只有一个密钥数据，您将密钥数据推入其中，密钥链从密钥中计算出块大小等。Keychain 支持 ASN.1 编码的密钥。

当您将密钥导出到文件时，它很可能是 PEM 文件。PEM 文件只是一个 base64 编码的 DER 结构。DER 结构是一种通用结构，但在 OpenSSL 的情况下，它通常是 ASN.1 编码的私钥或公钥。

[ASN.1 结构在这里](http://etherhack.co.uk/asymmetric/docs/rsa_key_breakdown.html)显示得很好。请在尝试修改之前阅读并理解如何阅读 ASN.1 结构，否则导入其他大小的密钥将失败。

我显然没有足够的“声誉”来发布超过 2 个链接。因此，对于以下示例，请粘贴 base64 信息（除了 --- BEGIN * KEY --- 和 ---END * KEY --- 之外的所有信息：lapo.it/asn1js。

如果您查看我链接的 iOS 项目，您会看到它们包含示例键。将私钥粘贴到 ASN.1 解码器中。您会注意到您有一个 SEQUENCE 标记，后跟几个 INTEGER 值。

现在粘贴公钥。您会注意到公钥与私钥有两条相同的信息。模数和指数。在私钥中，这是第二个和第三个 INTEGER 值。它的顶部也有一些信息。它有 2 个额外的 SEQUENCE、一个 OBJECT ID、NULL 和 BIT STRING 标签。

您还会在项目中注意到他调用了一个特殊函数来处理该公钥。它所做的是剥离所有标题信息，直到它到达最里面的 SEQUENCE 标记。那时，他将其视为私钥，并可以将其放入钥匙串中。

为什么要为一个而不是另一个？查看页眉和页脚文本。私钥说 --- BEGIN RSA PRIVATE KEY ---，公钥说 --- BEGIN PUBLIC KEY ---。您将在公钥中看到的对象 ID 是：1.2.840.113549.1.1.1。这是一个 ID，它是一个静态标签，将包含的密钥标识为 RSA 类型的密钥。

由于私钥在前导码中有 RSA，因此假定它是 RSA 密钥，并且不需要标头 ASN.1 信息来识别密钥。公钥只是一个通用密钥，因此需要一个标头来标识它是什么类型的密钥。

Keychain 不会使用此 ASN.1 标头导入 RSA 密钥。您需要将其一直剥离到最后一个 SEQUENCE。这时你可以把它放到keychain中，keychain就可以推导出块大小和其他关键属性。

因此，如果 BEGIN RSA PRIVATE KEY 存在，则无需进行剥离。如果是-- BEGIN PRIVATE KEY ---，您需要在将其放入钥匙串之前剥离这些初始标头。

就我而言，我还需要公钥。一旦我们成功地将私钥放入其中，我们就无法找到从钥匙串中获取它的方法（我们可能只是错过了一些东西），所以我们实际上从私钥创建了一个 ASN.1 公钥并将其导入到 keycahin 中。

在私钥中（在 ASN.1 标头剥离之后），您将有一个 SEQUENCE 标记，后跟 3 个 INTEGER 标记（这之后还有更多的 INTEGERS，但我们只关心前 3 个）。

第一个是 VERSION 标签。第二个是模数，第三个是公共指数。

查看公钥（在 ASN.1 标头剥离之后）您会看到 SEQUENCE 后跟 2 个 INTEGERS。你猜对了，这是来自私钥的模数和公共指数。

所以你需要做的就是：

1.  从私钥中获取模数和公共指数
2.  在缓冲区中创建一个 SEQUENCE 标记并将其长度设置为 [模数长度] + [指数长度]。（将这些字节写入缓冲区时，您很可能需要反转字节的字节序。我至少做了。）
3.  添加从私钥中获取的模数数据
4.  添加从私钥中获取的指数数据

这就是从导入的私钥创建公钥所需要做的一切。似乎没有太多信息可用于导入您未在设备上生成的 RSA 密钥，而且我听说设备上生成的密钥不包含这些 ASN.1 标头，但我从未尝试过. 我们的密钥非常大，并且需要很长时间才能生成设备。我发现的唯一选择是使用 OpenSSL，您必须在其中为 iOS 编译自己的。我宁愿尽可能使用安全框架。

我对 iOS 开发还是比较陌生，我敢肯定有人知道一个简单的函数，它可以完成我找不到的所有这些，我看了。在有更简单的 API 可用于处理密钥之前，这似乎工作正常。

One final note: The private key included with the project had a tag of BIT STRING, but the one I import from an OpenSSL generated private key had the tag OCTET STRING.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-10T21:55:16.603

答案是`SecItemAdd`使用正确的标志来调用。请参阅：[http ://hg.mozilla.org/services/fx-home/file/tip/Sources/NetworkAndStorage/CryptoUtils.m#l931](http://hg.mozilla.org/services/fx-home/file/tip/Sources/NetworkAndStorage/CryptoUtils.m#l931)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T20:09:36.517

[我从MYcrypto library](http://mooseyard.com/projects/MYCrypto/Documentation/html/index.html)中挖出了这段代码（BSD 许可证）。它似乎做你想做的事。

```
 SecKeyRef importKey(NSData *data, 
                    SecExternalItemType type,
                    SecKeychainRef keychain,
                    SecKeyImportExportParameters *params) {
    SecExternalFormat inputFormat = (type==kSecItemTypeSessionKey) ?kSecFormatRawKey :kSecFormatUnknown;
    CFArrayRef items = NULL;

    params->version = SEC_KEY_IMPORT_EXPORT_PARAMS_VERSION;
    params->flags |= kSecKeyImportOnlyOne;
    params->keyAttributes |= CSSM_KEYATTR_EXTRACTABLE;
    if (keychain) {
        params->keyAttributes |= CSSM_KEYATTR_PERMANENT;
        if (type==kSecItemTypeSessionKey)
            params->keyUsage = CSSM_KEYUSE_ENCRYPT | CSSM_KEYUSE_DECRYPT;
        else if (type==kSecItemTypePublicKey)
            params->keyUsage = CSSM_KEYUSE_ENCRYPT | CSSM_KEYUSE_VERIFY | CSSM_KEYUSE_WRAP;
        else if (type==kSecItemTypePrivateKey)
            params->keyUsage = CSSM_KEYUSE_DECRYPT | CSSM_KEYUSE_SIGN;
    }
    if (!check(SecKeychainItemImport((CFDataRef)data, NULL, &inputFormat, &type,
                                     0, params, keychain, &items),
               @"SecKeychainItemImport"))
        return nil;
    if (!items || CFArrayGetCount(items) != 1)
        return nil;
    SecKeyRef key = (SecKeyRef)CFRetain(CFArrayGetValueAtIndex(items,0));
    CFRelease(items);
    return key; // caller must CFRelease
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-24T00:54:31.247

我不确定[这个 Apple 开发者论坛线程](https://devforums.apple.com/message/34539#34539)中的代码是否有效，但这似乎是对您问题的直接回答。

# javascript - 是否有 HTML/JavaScript 画布元素的测试套件？

> ID：792099
> 
> 赞同：2
> 
> 时间：2009-04-27T02:35:39.727
> 
> 标签：javascript, unit-testing, canvas

我正在为画布界面开发一个备用后端。我开始设置测试用例，然后我想到可能已经有一组测试，但谷歌并没有出现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T03:45:24.147

[http://philip.html5.org/tests/canvas/suite/tests/](http://philip.html5.org/tests/canvas/suite/tests/)

# build - 如何确定 SunStudio 中的项目目录和其他环境变量？

> ID：792106
> 
> 赞同：0
> 
> 时间：2009-04-27T02:41:53.627
> 
> 标签：build, makefile, sunstudio

我目前正在尝试将后期构建步骤添加到 SunStudio 项目的构建/制作文件中，但要继续，我需要知道项目的目录。问题是 ${PWD} 不返回当前目录，我找不到任何环境变量，如 ${PROJECTDIR} 或其他。

实际上，以一种更全面的方式，我的问题是我找不到任何关于 SunStudio 在构建项目时设置的环境变量的文档，因此任何包含该信息的答案都会更好。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T05:12:27.570

我终于想出了一个解决办法。我在我的 makefile 的预构建目标中放置了一个“env”命令，如下所示：

```
.build-pre:
     env 
```

这揭示了 SunStudio 用于构建 (=>dmake) 项目的所有环境变量，因此我了解到项目目录设置在**${DMAKE_PWD}**变量中。

# asp.net - 使用插入在日期时间字段上引发异常

> ID：792116
> 
> 赞同：0
> 
> 时间：2009-04-27T02:47:11.383
> 
> 标签：asp.net, exception, datetime, subsonic, insert

尝试使用 Insert CLass 执行插入注释时，出现以下异常：

将 char 数据类型转换为 datetime 数据类型会导致 datetime 值超出范围。

我正在使用以下全球化设置：

```
<globalization uiCulture="en-AU" culture="en-AU"/> 
```

我的日期格式是：“dd/mm/YYYY”

我可以使用以下方法解决异常：

```
ci.Date.HasValue?ci.Date.Value.ToString("yyyy-MM-dd HH:mm:ss"):null 
```

但这很难看，因为……我能做些什么让亚音速选择我的全球化设置吗？

谢谢

路易斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T14:17:51.900

路易斯，您应该发布一些代码，以便我们可以清楚地看到您正在尝试做什么，但我想我知道这个问题。

如果您传入 Subsonic 无法识别的数据类型，例如 DateTime?（与 Date 相对），则 subsonic 将调用对象的 ToString() 方法并将其 DataType 设置为字符串，这将导致您在上面提到的问题. 您应该能够只传递 ci.Date.Value 而无需调用您自己的 ToString("format") 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T03:50:30.717

您使用的是 SQLServer 2008“日期”列吗？

我在这种情况下看到了同样的问题，在我的情况下，这是因为 SQL Server“日期”类型的 Subsonic 类属性被设置为“字符串”。

请参阅[SQL Server 2008 日期的 Subsonic 2.2 生成的属性](https://stackoverflow.com/questions/784716/subsonic-2-2-generated-property-for-sql-server-2008-date)

如果您能确认这一点，我将不胜感激，我将在 Subsonic 项目问题列表中发布问题。

# iphone - CGColorGetComponents() 返回什么？

> ID：792119
> 
> 赞同：8
> 
> 时间：2009-04-27T02:48:28.463
> 
> 标签：iphone, cocoa-touch, core-graphics, uicolor, cgcolor

```
CGFloat* colors = CGColorGetComponents(hsbaColor.CGColor); 
```

这会返回一个浮点数还是一个浮点数数组？看起来星号是创建数组的简写。那是对的吗？

当我在 HSB UIColor 对象的 CGColor 属性上调用此函数时，它会将值转换为 RGB 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T09:55:42.727

> ```
> CGFloat* colors = CGColorGetComponents(hsbaColor.CGColor); 
> ```
> 
> 这会返回一个浮点数还是一个浮点数数组？看起来星号是创建数组的简写。那是对的吗？

有点。

`CGFloat *colors`声明一个变量，该变量包含一个指向至少一个 CGFloat 的指针。`CGColorGetComponents`返回一个指向多个 CGFloat 的指针，一个接一个 - 一个 C 数组。您获取该指针并将其分配给（将指针放入）`colors`变量。

声明变量不会*创建*数组。事实上，两者都没有`CGColorGetComponents`。无论创建了 CGColor 对象，都创建了数组并将其存储在对象中；`CGColorGetComponents`让您拥有指向该存储的指针。

声明`CGFloat *colors`变量只会创建一个位置——变量——来存储指向一个或多个 CGFloats 的指针。变量中的东西是指针，指针处的东西是数组。

如果这仍然不清楚，请参阅[您需要了解的关于 C 中指针的所有信息](http://boredzo.org/pointers)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T02:58:49.263

是的，它返回一个数组`CGFloats`。具体来说，它返回“与指定颜色相关的颜色分量（包括 alpha）的强度值数组”。

返回的颜色分量取决于传递`CGColorRef`使用的颜色空间。

更多信息可以在[CGColor 文档](https://developer.apple.com/library/ios/documentation/graphicsimaging/Reference/CGColor/Reference/reference.html#//apple_ref/c/func/CGColorGetComponents)中找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T02:57:58.173

来自[苹果](http://developer.apple.com/documentation/graphicsimaging/reference/CGColor/Reference/reference.html)：

它返回与 Quartz 颜色相关的颜色分量（包括 alpha）的值。与指定颜色关联的颜色分量（包括 alpha）的强度值数组。数组的大小比颜色的颜色空间的分量数大一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-01T04:09:47.333

要获得我使用的 RGB 组件：

```
// Get UIColor's RGB normalized components (0..1)
CGFloat red, green, blue, alpha;
[color getRed:&red green:&green blue:&blue alpha:&alpha];

// Convert RGB components to 8-bit values (0..255)
int r = (int)(red * 255.0);
int g = (int)(green * 255.0);
int b = (int)(blue * 255.0);
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-11T05:11:25.993

这是一个如何正确将 CGColorRef 转换为 NSColor`myColorRef`的示例`myNSColor`：

```
NSColorSpace *cp = [[NSColorSpace alloc] initWithCGColorSpace:CGColorGetColorSpace(myColorRef)];
const CGFloat *components = CGColorGetComponents(myColorRef);
size_t componentCount = CGColorGetNumberOfComponents(myColorRef);
NSColor* myNSColor = [NSColor colorWithColorSpace:cp components:components count:componentCount]; 
```

# iphone - 还设置了哪些其他语言/IDE，例如 iPhone/Xcode？

> ID：792128
> 
> 赞同：0
> 
> 时间：2009-04-27T02:57:09.877
> 
> 标签：iphone, xcode, model-view-controller, ide

知道这个问题与编程并不完全相关，但我认为这个论坛是最好的提问场所。所以，带着问题被拉出来的风险，这里......

设置了哪些其他语言/IDE 以及带有 Xcode 和 Interface Builder 的 iPhone？Apple 使用一种设计模式并且使用得非常好——MVC。IB没有任何代码。这都是 UI，并且强制执行该模式。相比之下，.NET 和 Visual Studio 在分离 UI 和代码方面失败得很惨。即使是带有 Blend 的 XAML 也不会变得更好。

有没有其他人（语言/IDE）和苹果一样做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T03:18:18.203

我还没有找到一个真正接近的。您可能想尝试查看来自 Trolltech的[Qt 。](http://qt.nokia.com/)我喜欢他们以前版本的 Designer 工具，[Creator](http://doc.qt.nokia.com/qtcreator-1.1/index.html)看起来很有前途。

# winapi - 使用 SendMessage 模拟用户鼠标点击

> ID：792130
> 
> 赞同：1
> 
> 时间：2009-04-27T02:58:27.160
> 
> 标签：winapi, mouse, automated-tests, user-input, user32

我需要使用 SendMessage 来模拟目标程序中的用户点击，因为 SendMessage 会阻塞，直到它触发的事件完成处理。这样做的原因是，这种阻止提供了检测是否有任何对话框因单击而打开的机会。我目前的问题是，虽然我可以在打开模型对话框的模拟表单中的按钮上连续使用 WM_LBUTTONDOWN 和 WM_LBUTTONUP 消息进行点击工作，但我无法让它在标准 Windows 应用程序中的菜单和菜单项上工作（记事本）。任何有助于以一种可行的方式执行对菜单项的点击的帮助都会受到赞赏。我已经可以检测到它是否是一个菜单项，只需要能够使用 SendMessage 来模拟点击它并阻止它。

干杯

罗斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T07:07:20.383

不幸的是，这个关于[win32 钩子](http://msdn.microsoft.com/en-us/library/ms997537.aspx)的页面说

> 模拟鼠标和键盘输入 (WH_JOURNALPLAYBACK)。Hooks 提供了唯一可靠的方法来模拟这些活动。如果您尝试通过发送或发布消息来模拟这些事件，Windows 内部不会更新键盘或鼠标状态，这可能会导致意外行为。如果使用挂钩来回放键盘或鼠标事件，则这些事件的处理方式与真实的键盘或鼠标事件完全一样。

所以看起来你可能不得不求助于某种类似于宏记录器的功能来进行自动化测试，方法是使用`WH_JOURNALRECORD`and `WH_JOURNALPLAYBACK`?

# content-management-system - 数据中心的 Amazon S3 替代方案？

> ID：792134
> 
> 赞同：22
> 
> 时间：2009-04-27T03:02:13.453
> 
> 标签：content-management-system, jakarta-ee, amazon-s3, cdn

我正在寻找一种类似于 Amazon S3 的服务，一种用于存储和检索任意数据（和元数据）的简单服务，但它在您自己的数据中心本地运行。严格来说，我不确定您是否将其称为 CDN 或轻量级 CMS。

它必须是水平可扩展的（存储和带宽）和容错。它还必须支持带有可插入身份验证和授权系统的 REST，最好也支持 WS。对于更方便的集成和可扩展性，使用 Java EE 构建的东西会更可取，但这只是个人喜好，并不是必需的。

建议？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-07T18:06:14.850

以下是我遇到的一些值得进一步研究的开源解决方案：

1.  [Apache Sling](http://incubator.apache.org/sling/site/index.html)（基于 JCR 的 CMS（[JSR170](http://jcp.org/en/jsr/detail?id=170)，[JSR283](http://jcp.org/en/jsr/detail?id=283)），RESTful 接口）。
2.  [Apache Hadoop](http://hadoop.apache.org/)（基于 Java 的分布式数据存储，map reduce 功能）。
3.  [HBase](http://hadoop.apache.org/hbase)（建立在 Hadoop 之上，提供类似 Google Bigtable 的功能）。
4.  [CouchDB](http://couchdb.apache.org/)（基于 Erlang 的键/值数据库，具有 Map/Reduce 功能，RESTful 接口）。
5.  [Dynomite](http://github.com/cliffmoon/dynomite/tree/master)（基于 Erlang，Amazon [dynamo](http://www.allthingsdistributed.com/2007/10/amazons_dynamo.html)克隆）。
6.  [Voldemort](http://project-voldemort.com/)（分布式键值存储系统）。
7.  [Cassandra](http://incubator.apache.org/cassandra)（高度可扩展、最终一致、分布式、结构化的键值对存储）。
8.  [MongoDB](http://www.mongodb.org/)（高度可扩展、基于 JSON 文档的存储）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-08T17:47:40.230

Walrus 项目（大部分与 s3 api 兼容）。. .

[http://open.eucalyptus.com/wiki/EucalyptusStorage_v1.4](http://open.eucalyptus.com/wiki/EucalyptusStorage_v1.4)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T03:18:25.583

[Park place](http://github.com/why/parkplace/tree/master)是 Ruby 中的 S3 克隆。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-05-07T18:09:53.827

除了 Park Place，目前对抗 S3 的唯一其他大玩家是 Nirvanix。 [涅槃](http://www.nirvanix.com/)

# c# - 我可以在 Visual Studio 2008 中从 C# 项目构建 2 个或更多 dll 吗？

> ID：792136
> 
> 赞同：0
> 
> 时间：2009-04-27T03:04:15.680
> 
> 标签：c#, .net, visual-studio, dll, build-process

因为我正在使用 Silverlight 和 C# 创建 RIA 框架。所以我需要使用Silverlight的丰富功能，比如动态加载。但我发现 Visual Studio 会将所有类库（相同命名空间或不同命名空间）合并到一个 dll 中。

你有什么想法从 C# 项目构建 2 个或更多 dll 吗？我只是为 1 个子页面创建 1 个项目。因此，如果我的解决方案中有 100 个子页面，我将为这个没有意义的解决方案创建 100 多个项目。

**谢谢**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T03:37:48.530

只需在您的解决方案中创建其他项目即可获得不同的程序集 (dll)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T03:40:15.827

您不能从一个项目中生成多个 dll。创建数百个项目是不切实际的——每个班级一个。

那么为什么不只创建一个 dll 并动态加载它呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-27T19:07:59.367

一个 VS 项目可以编译一个二进制文件。可能没有办法解决这个问题。

有许多项目在解决方案中，您有什么问题？这还不错。

*   你对版本的混乱更少
*   当其他人在处理另一个 dll 时，您可以处理一个 dll
*   您可以停用不想使用的项目
*   编译更快，因为没有修改的项目不需要再次编译

我在工作中有一个这样的案例（解决方案中有很多项目）。你会习惯的。

# c++ - 是否有 C++ 的语法解析器（类似于 python 的 yapps）？

> ID：792145
> 
> 赞同：2
> 
> 时间：2009-04-27T03:17:04.727
> 
> 标签：c++, parsing, grammar

我正在编写一种非常接近伪代码的实验性语言，目的是为了好玩并了解更多关于 C++ 的知识。问题之一是我需要解析一些语法，而我寻找一个好的 C++ 语法解析器的搜索没有成功（我找不到任何东西）。我想要完成的是：

```
set a to 4 
```

我希望解析器返回一个包含类似于以下内容的地图：

```
command = "set"
var = "a"
value = 4 
```

基于我给它的一套规则。

如果我找不到任何有用的东西，我最终将不得不自己动手，但我想尽可能地避免重新发明轮子。

那么，这里有没有人知道生成 C++ 代码的好/健全的语法解析器？如果能被广泛使用就更好了。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T03:25:21.603

检查是否可以使用[Boost::Spirit 。](http://www.boost.org/doc/libs/1_38_0/libs/spirit/classic/index.html)Spirit 框架使目标语法能够专门用 C++ 编写。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T04:07:24.280

[Lex 和 Yacc / Flex 和 Bison](http://dinosaur.compilertools.net/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T03:55:34.260

您可以使用[yacc](http://en.wikipedia.org/wiki/Yacc)（使用[flex](http://en.wikipedia.org/wiki/Flex_lexical_analyser)作为分词器）。快速搜索会产生[这个页面](http://tldp.org/HOWTO/Lex-YACC-HOWTO-5.html)来执行 yacc 的 C++ 使用，它是用 C 实现的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T04:09:02.590

你应该看看[ANTLR](http://antlr.org/)。它可以为多种语言生成，包括（我相信）C++。[更仔细地查看文档，有一个 C 目标；目前尚不清楚是否有 C++ 目标，但 C 目标很容易与 C++ 一起使用。] 我还是老派，倾向于使用 yacc（或野牛），但那是因为我是熟悉它而不是因为它仍然是最好的（尽管它仍然很好）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T19:10:21.050

自己动手就像一开始就写语法一样简单！这是学习解析、收集更深入的编程语言知识的好方法，最重要的是它很有趣。该方法称为[递归下降](http://en.wikipedia.org/wiki/Recursive_descent_parser)。它通常比解析器生成器更简单、更优雅，而且你再也不需要找到 Yacc 端口/fork[了](http://compilers.iecc.com/crenshaw/)

否则，Lex 和 Yacc 是传统工具，而 Boost::Spirit 是特定于 C++ 且更现代的。我会推荐 Boost::Spirit，因为它有助于巩固你的编程中的 C++ 范式。

# c++ - std::vector 与 C++ 中的原始数组有多相似？

> ID：792152
> 
> 赞同：2
> 
> 时间：2009-04-27T03:21:44.670
> 
> 标签：c++, arrays, logic

我正在写一个刽子手游戏。我的逻辑和我的游戏逻辑都失败了。字符猜测（人们猜测的字母）没有被添加到向量guessArray 的正确内存槽中。假设该词是用户输入的词。

如果guessArray 是原始数组，我认为这会起作用。是否有某种原因这不适用于矢量？

```
//assume that attempts is num of attempts left
void coutWord(int attempts, std::string word, char guess)
{
std::vector<char> guessArray(word.length());

//this is supposed to add the guess to the correct area of guessArray;
//It's not. 

for (int i = 0; i < word.length(); i++) {
    if (guess == word[i]) {
        guessArray[i] = guess;
        std::cout << " " << guessArray[i] << " ";
        continue;
    }

    std::cout << " _ ";
}

std::cout << std::endl << std::endl;
} 
```

编辑：我使用此代码的目标是在同一个 for 循环中找出所有未猜测的空格和猜测的空格。我只需要“记住”以前的猜测，以便得到正确的输出。给定单词=“苹果酱”：

```
Input: a
a _ _ _ _ _ a _ _ _
Input: p
a p p _ _ _ a _ _ _ 
```

等等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T03:23:27.177

向量可以用下标表示法索引`[]`，并且它存储在连续的内存中。它是一个 STL 容器，因此与数组一样，您可以拥有任何类型的容器。

矢量会自动调整大小。数组是“静态”大小的，不能轻易调整大小（调用 realloc 的手动函数除外。）您可以使用 push_back 函数来处理此问题，也可以提前 .reserve() 内存来保存关于重新分配。

数组不跟踪它自己的大小，而向量具有可以检查这一点的函数。

如果您不确定向量的大小，请继续使用 .push_back() 添加项目以处理自动调整大小的问题。如果您通过 resize() 保留一块内存然后对其进行索引，则它更容易用作数组，但您会失去将其用作动态大小的对象的一些语法优势。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T04:12:10.837

除了使用向量或数组之外，您的代码中还存在基本的逻辑缺陷。

您在这里尝试执行两项任务：

*   更新猜测数组
*   输出猜测数组

当您尝试在一个功能中完成两项任务时，很容易混淆。我对您的建议是将这些放入单独的函数中。

这是一个基本的代码结构（使用您可以实现的功能）：

```
int attempts = 0;
std::vector<char> guessArray(word.length());
while( (attempts > maxAttemps) && (!HasFoundWord(guessArray) )
{
   char guess = InputGuess();
   UpdateResults(guessArray, guess, word);
   OutputGuess(guessArray);
   ++attempts;
} 
```

UpdateResults 将具有如下函数签名：

```
void UpdateResults(std::vector<char>& guessArray, char guess, const std::string& word) 
```

分离出功能块后，您会发现问题更容易解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T04:05:48.060

对编辑的回答：

guessArray 向量是在函数中本地创建的，因此，先前插入向量中的内容将无法用于下一次尝试。您需要通过引用传递向量并为每次尝试更新向量。

```
void coutWord(std::vector<char>& guessArray, int attempts, std::string word, char guess) 
```

伪代码：

```
void coutWord(std::vector<char>& guessArray, int attempts, std::string word, char guess)
{

    for (int i = 0; i < word.length(); i++) 
    {
        if (guess == word[i]) 
        {
            //its current guess
            //insert and display as well
            guessArray[i] = guess;
           std::cout << " " << guessArray[i] << " ";

        }
        //Check if the previous attempt has already inserted the char ( previous guess)
        else if(guessArray[i] != 0)
        {
            //display previous guess too
            std::cout << " " << guessArray[i] << " ";

        }
        else
        {   //not yet guessed
            std::cout << " _ ";
        }
    }

    std::cout << std::endl << std::endl;
} 
```

在外面定义向量：

```
std::vector<char> guessArray(word.length());

    coutWord(guessArray, 1, word, 'a'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T05:03:53.630

我很惊讶还没有人提到它，但 std::vector 不是数组。它是一个调整大小的连续元素容器，可用于许多与数组相同的目的。如果您想要一个包装数组（并且有很多原因），您应该查看[boost::array](http://www.boost.org/doc/libs/1_38_0/doc/html/array.html)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-27T03:24:25.413

您应该使用 push_back() 函数。有关详细信息，请参阅[cpprefererence.com](http://www.cppreference.com/wiki/stl/vector/start) 。

此外，您不能简单地用 C 样式数组替换guessArray，因为您需要使用编译时已知的常量明确指定其大小，例如

```
int guessArray[25]; 
```

# haskell - GHC 是否能够尾调用优化 IO 操作？

> ID：792154
> 
> 赞同：8
> 
> 时间：2009-04-27T03:22:28.897
> 
> 标签：haskell, io, tail-recursion

GHC会默认对以下函数进行尾调用优化吗？唯一奇怪的是它递归地定义了一个 IO 操作，但我不明白为什么这不能成为 TCO。

```
import Control.Concurrent.MVar

consume :: MVar a -> [a] -> IO ()
consume _ [] = return ()
consume store (x:xs) = do putMVar store x
                          consume store xs 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-27T04:34:39.627

由于您的代码相当于

```
consume store (x:xs) = putMVar store >> consume store xs 
```

呼叫实际上并没有发生在尾部位置。但是如果你运行`ghc -O`并打开优化器，该`-ddump-simpl`选项会显示 GHC 的中间代码的输出，它确实优化成一个尾递归函数，它会编译成一个循环。

所以答案是默认情况下 GHC 不会对此进行优化；你需要这个`-O`选项。

（使用 GHC 版本 6.10.1 进行的实验。）

# facebook - acegi + 脸书 / 我的空间 / 谷歌

> ID：792157
> 
> 赞同：1
> 
> 时间：2009-04-27T03:23:36.803
> 
> 标签：facebook, spring-security, myspace

我的应用程序使用 acegi 作为安全性。

有没有我可以连接 acegi 的 facebook connect/google/myspace 插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T18:55:40.227

Take a look at the Grails ACEGI tutorial, specifically [this page](http://www.grails.org/AcegiSecurity+Plugin+-+Customizing+with+SecurityConfig)

There are settings for OpenID, Facebook Connect, LDAP, NTLM, Kerberos, etc. right out of the proverbial box.

# c# - 何时关闭 WCF 客户端？

> ID：792160
> 
> 赞同：19
> 
> 时间：2009-04-27T03:24:19.610
> 
> 标签：c#, wcf, silverlight

我已将 WCF 服务的客户端代理实例放入 App 类的属性中，以便可以从应用程序中的任何位置获取它。

我没有关闭客户端，而是在应用程序期间保持打开状态。造成这种情况的主要原因是，如果我按照 WCF 服务 mex 页面中的 // 注释（如果您将浏览器指向 WCF 服务 url，您会得到该页面），它会显示 // 始终关闭客户端。客户端.关闭（）；

这很好，除非我在调用 client.SomeAsync() 方法之后立即调用 client.Close() ，那么它会在结果返回之前被关闭。我应该把 close 放入 Completed() 方法吗？或者我应该忘记关闭它，因为一旦它关闭，我必须创建一个新的客户端代理实例（如果是这种情况，最好不要将它存储在 App.property 中。

谢谢，斯蒂芬

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T03:40:24.157

您应该按照建议关闭它。是的，如果您使用的是异步方法，那么您必须在调用完成后关闭它。

创建（打开）和关闭客户端是 WCF 客户端的规范。持续创建和关闭新客户不会造成明显的性能损失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T03:57:25.113

最好在您的 Completed 方法的 finally{} 中显式关闭它。无论出于何种原因，如果客户端保持连接，您将开始阻止其他客户端调用。根据 HTTP RFC：

> 定义于 1999 年 (RFC 2616) “使用持久连接的客户端应该限制他们维护到给定服务器的同时连接的数量。单用户客户端不应与任何服务器或代理保持超过 2 个连接。一个代理应该使用最多 2*N 个连接到另一个服务器或代理，其中 N 是同时活跃的用户数。这些指南旨在改善 HTTP 响应时间并避免拥塞。” 由于开发人员正在使用 AJAX 或类似 AJAX 的请求来更新网页，因此越来越多地讨论了 http 限制。

如果您没有关闭连接，则很可能会开始阻塞。我当然假设这是 HttpBinding。

# iphone - iPhone/Xcode：不同的项目目标可以有不同的包标识符吗？

> ID：792170
> 
> 赞同：15
> 
> 时间：2009-04-27T03:30:48.890
> 
> 标签：iphone, xcode

我有点困惑这是如何工作的 - 这是我的理解：

*   目标的配置文件链接到特定的应用 ID
*   目标的捆绑标识符位于**Target info\Properies\Identifier下**

但是... bundle ID 也位于 Info.plist 中。似乎如果您在**Info.plist 中**更改捆绑 ID ，Xcode 会在**Target info\Properties\Identifier**中自动更改它，反之亦然。

那么哪个优先呢？**目标 info\Properties\Identifier**包ID 还是**Info.plist**包 ID？

我问的原因是因为我想为我的应用程序提供两个版本——一个免费的广告支持版本和一个付费版本，我想用两个不同的目标来实现这一点。由于它们将是 App Store 中的两个不同的应用程序，我的理解是它们需要两个不同的应用程序 ID（而且我不想使用应用程序 ID 走*路线，App Store 上关于它如何工作的描述让我脑损伤）。

如果我这样做，我是否需要为每个目标提供两个不同的 Info.plist，或者我可以使用相同的 Info.plist，而只是让不同的目标使用不同的开发/分发配置文件？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-27T23:51:31.937

没有优先级，属性对话框只是作为您查看 Info.plist 的另一种方式。

要在目标之间共享 plist 但具有不同的标识符，请确保为两个目标启用了“在 Info.plist 文件中扩展构建设置”选项。然后，对于每个目标，在目标设置中为您的捆绑包 ID 创建一个新的用户创建变量（例如，APPLICATION_BUNDLE_IDENTIFIER，请参见此处：[https](https://stackoverflow.com/a/18472235/308315) ://stackoverflow.com/a/18472235/308315 ）并将其设置为正确的值为那个目标。在您的 plist 中，为捆绑 ID 输入以下内容：

```
<key>CFBundleIdentifier</key>
<string>$(APPLICATION_BUNDLE_IDENTIFIER)</string> 
```

该变量将在每个目标的构建时进行评估，因此每个目标都将获得正确的包 ID。

# c# - 如何清理双重链接的多对多关系？

> ID：792171
> 
> 赞同：1
> 
> 时间：2009-04-27T03:31:16.363
> 
> 标签：c#, many-to-many

首先，我不确定标题是否准确地描述了我所指的内容，因此请随时就如何称呼它发表评论，或者如果您有代表，请自行重命名。

例如，假设我有 2 个课程，书籍和图书馆。图书馆包含一个属性，该属性是它拥有的所有书籍的列表。一本书有一个属性，它是它所属的所有库的列表。

在书上，我有一个 RemoveFromLibrary 方法，可以从它的库列表中删除一个库。我也希望用同样的方法来清理另一端，即图书馆拥有的图书列表。另一端也是如此，Library 上的 RemoveBook 方法也清理了该 Book 的包含它的库列表。

首先，这有意义吗？调用代码不必担心清理并且不必调用 2 个方法来执行一个逻辑操作，这对我来说似乎很方便。我的意思是从一个列表中删除但从另一个列表中删除是没有意义的。同时，可以说这使它们耦合得太紧了，但我想如果它成为一个问题我会重构以解耦。

就实现这一点而言，我不确定的是，如果我只是调用普通的公共方法，那么我最终会得到每个方法调用另一个方法的无限循环。我可以创建一个不清理的单独的内部属性（在 C# 中工作），但感觉就像我用一种只能从另一个方法调用的方法乱扔 API。或者，我可以将底层集合公开为内部集合，这会更好一些，但它似乎仍然不理想。有没有更好的解决方案，或者我只需要使用这两个中的一个，或者确保调用代码本身进行清理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T03:48:37.757

也许这会奏效。在调用`remove`另一个类的方法之前，检查它的对象列表（例如书籍）是否仍然包含想要删除的对象。

**顺便说一句**，这只是伪代码（可能无法编译）

```
class Book
{
    Library[] libraries;

    void RemoveFromLibrary(Library lib)
    {
        libraries.remove(lib);
        if (IsInLibrary(lib) && lib.HasBook(this)) // prevents call-loop
            lib.RemoveBook(this);
    }

    bool IsInLibrary(Library lib)
    {
        return libraries.Contain(lib);
    }
}

class Library
{
    Book[] books;

    void RemoveBook(Book bk)
    {
        books.remove(bk);
        if (HasBook(bk) && bk.IsInLibrary(this)) // prevents call-loop
            bk.RemoveLibrary(this);
    }

    bool HasBook(Book bk)
    {
        return books.Contain(bk);
    }
} 
```

**编辑**：根据评论修复了代码......我在写它的时候很困：P

# asp.net - asp.net：如何以编程方式而不是复制/粘贴更好地加载详细信息视图字段

> ID：792172
> 
> 赞同：0
> 
> 时间：2009-04-27T03:32:18.170
> 
> 标签：asp.net, detailsview

对于每个查找表，我都有以下代码。到目前为止，我正在为每个下拉列表控件进行复制/粘贴。但我认为有更好的方法来做到这一点。我应该能够指定、、、 `DataTextField`控件`DataValueField`名称等。当然，我将不得不在数据库端手动添加与配置相关的数据库值，例如查找表以及存储过程中的其他更改。但是在`.aspx`页面或`.cs`页面上，必须有比复制/粘贴更好的方法。

```
</asp:TemplateField> 
 <asp:TemplateField HeaderText="Your Ethnicity">
    <EditItemTemplate>
        <asp:DropDownList ID="ddlEthnicity" runat="server" 
            DataSourceid="ddlDAEthnicity"
            DataTextField="Ethnicity" DataValueField="EthnicityID"
            SelectedValue='<%#Bind("EthnicityID") %>'>
        </asp:DropDownList>
    </EditItemTemplate>
    <ItemTemplate >
        <asp:Label Runat="server" Text='<%# Bind("Ethnicity") %>' 
            ID="lblEthnicity">
        </asp:Label>
    </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:20:35.660

要从数据库驱动下拉控件中的内容，您可以根据您的体系结构使用许多不同的 DataSource 绑定它们。

这是一个简单的示例（将列表框更改为下拉列表）：

```
 <asp:SqlDataSource
      id="SqlDataSource1"
      runat="server"
      DataSourceMode="DataReader"
      ConnectionString="<%$ ConnectionStrings:MyNorthwind%>"
      SelectCommand="SELECT LastName FROM Employees">
  </asp:SqlDataSource>

  <asp:ListBox
      id="ListBox1"
      runat="server"
      DataTextField="LastName"
      DataSourceID="SqlDataSource1">
  </asp:ListBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T03:53:38.260

我认为自定义控件应该可以帮助您解决这个问题。

# asp.net - asp.net 如何以编程方式将项目添加到详细信息视图

> ID：792178
> 
> 赞同：0
> 
> 时间：2009-04-27T03:36:28.037
> 
> 标签：asp.net, detailsview

对于每个查找表，我都有以下代码。到目前为止，我正在为每个下拉列表控件进行复制/粘贴。但我认为有更好的方法来做到这一点。我应该能够指定 DataTextField、DataValueField、控件名称等。当然，我必须在数据库端手动添加与配置相关的数据库值，例如查找表以及存储过程中的其他更改。但是在 aspx 页面或 .cs 页面上，必须有更好的方法，然后复制/粘贴..

```
<asp:TemplateField HeaderText="Your Ethnicity">
<EditItemTemplate>
<asp:DropDownList ID="ddlEthnicity" runat="server" 
DataSourceid="ddlDAEthnicity"
DataTextField="Ethnicity" DataValueField="EthnicityID"
SelectedValue='<%#Bind("EthnicityID") %>'
>
</asp:DropDownList>
</EditItemTemplate>
<ItemTemplate >
<asp:Label Runat="server" Text='<%# Bind("Ethnicity") %>' 
ID="lblEthnicity">
</asp:Label>
</ItemTemplate>
</asp:TemplateField> 
```

请让我知道，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T10:32:04.603

挂钩到项目创建或数据绑定事件，执行 IF else 循环以在详细视图模板中查找 DDL，然后以编程方式将其挂钩到您选择的数据源并将所选值设置为详细视图的键数据项。

希望这可以帮助。

# mysql - 用于开发的便携式 mysql

> ID：792184
> 
> 赞同：2
> 
> 时间：2009-04-27T03:41:56.447
> 
> 标签：mysql

我一直在我的桌面上开发一个使用 MySQL 的应用程序。但是，我一直往返于不同的地方，我想在我的笔记本电脑上进行开发。

有没有一种方法可以在不打开桌面并远程连接的情况下继续开发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T04:16:39.047

你为什么不尝试使用 XAMPP 呢？我认为他们有它的便携版本。这样，您只需复制整个 XAMPP 文件夹即可随身携带。我认为他们存储了整个内容，包括其中的数据库文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T04:16:13.633

这取决于你真正想要做什么。

如果您只关心表结构，那么您的构建过程可能已经有一些 .sql 文件可以执行以设置新数据库。只需在您的笔记本电脑上安装 MySQL，并从相同的 .sql 文件进行设置。如果您的构建过程在某些文件中没有完整的数据库模式（当然是版本控制），那是第一步。此时，您可以在断开连接时更改数据库架构，只需比较这些 .sql 文件即可查看发生了什么变化。

如果您只关心在离线时将模式 + 数据从桌面获取到笔记本电脑，请在笔记本电脑上安装 MySQL，然后按照任何标准备份/恢复过程，备份桌面并在笔记本电脑上恢复。然后在您的笔记本电脑上的每个会话中，您都将获得来自桌面的最新数据和模式。如果您在笔记本电脑上更改架构或添加您关心的数据，则可以逆转该过程。

如果您打算在笔记本电脑和台式机之间同步数据和结构，您可能会考虑设置复制。两台 MySQL 服务器都会保留日志，当它们相互联系时，它们会处理日志以协调差异。

而且，如果您不想在笔记本电脑上安装和维护数据库的第二个实例，您可能需要考虑抽象数据库层。大多数语言都绑定了内存数据库，如 SQLite 或 Hypersonic 等。如果您没有对数据库做极其复杂的事情，这会导致大量供应商特定的黑客攻击，那么支持其中一个内存数据库应该很容易，只是为了在笔记本电脑上进行一些开发并拥有一个可用的数据库。即使您正在做复杂的事情，如果您使用的是框架，它们中的许多都支持开箱即用的内存数据库，只要有一些可用于演示和示例代码的东西。

因此，这实际上取决于您需要什么——从完全双向自动同步到一些手动的临时同步，再到只需要一个数据库，任何可供程序运行的数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T03:51:24.410

你不能在你的笔记本电脑上安装 MySQL 吗？

显然，如果桌面未打开，您将无法连接到桌面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T04:07:36.837

我在*上网本*上运行 MySQL（和 pg） 。大约 100 万行以下的表没有问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T04:11:32.710

您可以尝试将 Apache、MySQL 和 PHP 合二为一的 WAMP 服务器

# android - 为什么触摸事件会破坏我的 Android 帧率？

> ID：792185
> 
> 赞同：15
> 
> 时间：2009-04-27T03:42:20.767
> 
> 标签：android, touch, polling, frame-rate

我正在为 Android 开发游戏。它发生了很多事情，但运行得相当顺利。也就是说，当然，直到用户触摸屏幕。

当他们触摸它时，大约每十毫秒`onTouchEvent`调用一次（使用`action = ACTION_MOVE`,`x = 0`和），这似乎是一个相当高的优先级，因为它完全消除了帧速率。`y = 0`一旦触摸结束，帧速率就会恢复到其良好状态。

我试过了

*   像往常`onTouchEvent`一样处理游戏输入
*   立即`onTouchEvent`返回_`true`
*   根本没有`onTouchEvent`实施

该问题在所有三种情况下都存在。

有没有人遇到过这个？有没有办法降低`ACTION_MOVE`事件的生成率，或者确保它们仅在实际移动时生成，或者使用仅获取当前触摸位置的轮询方法？或者甚至只是一种完全禁用它的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-27T17:43:53.397

[阅读](http://groups.google.com/group/android-developers/browse_thread/thread/39eea4d7f6e6dfca)此线程。基本上你想要让事件线程休眠，否则系统会发送很多你需要处理的事件（在 x,y 和压力之间总是有一些运动发生）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-01T14:32:36.627

> 我一直在努力关注你们一直在谈论的一切，但我必须承认，在尝试了几种实施你们建议的方法之后，我仍然无法取得任何积极的结果。你们中的一个可以提供一些示例代码吗？具体来说，我想知道如何让主/ UI 线程进入睡眠状态。如果它适用于我的游戏，那么知道如何建立一个像 Jon 实现的投票模型也会很高兴。

这是我的代码的样子。在 UI 线程上：

```
public boolean onTouchEvent(MotionEvent event) {
    // Store event somewhere the game thread can see it:
    // ...

    synchronized (someObject) {
        try {
            someObject.wait(1000L);
        } catch (InterruptedException e) {
        }
    }

    return true;
} 
```

在游戏线程上：

```
void myGame() {
    while (!stopping) {
        // ...

        // Get a touch event:
        synchronized (someObject) {
            someObject.notify();
        }
        Thread.yield();

        // ...
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T13:09:00.780

也许是一个有点明显的解决方案，但是......您是否尝试过仅处理其中的 1/10？如果您在 UI 线程上每 10 毫秒触发一次处理，那可能会减慢帧速率，是的。那么，如果您只是累积一个计数器，并且仅在超过某个最小阈值时才进行任何处理呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-14T19:20:56.100

If you want a solution without having to deal with synchronizing threads I can recommend using the Handler interface to send the event and relevant data using a Message/Bundle to the game rendering thread. The sleep workaround hinted here still applies.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-24T14:19:40.293

Generally events comes with a timestamp property so it's easy to compute and throttle event rate.

```
if (currentEventTimestamp - lastEventTimestamp > 500) { 

    lastEventTimestamp = currentEventTimestamp;

    // do something 

}
```

# c# - 自动评论文件中的所有公共成员

> ID：792190
> 
> 赞同：1
> 
> 时间：2009-04-27T03:49:29.737
> 
> 标签：c#, xml, visual-studio, xml-comments

我已将警告作为错误打开，现在我需要对我所有的公共方法进行 XML 注释。

只是为了让我的程序编译，我现在只想放置占位符。

无论如何，是否可以自动将 XML 注释添加到类或文件中的所有公共成员。

我看到了 ghost doc，它为您提供了很好的自动生成的 XML 注释，但它看起来仍然一次只处理一个成员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T03:58:53.927

[您可以使用/nowarn](http://msdn.microsoft.com/en-us/library/7f28x9z3(VS.80).aspx)关闭缺少评论的特定警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T03:54:04.513

关闭 Xml 注释，直到您完成添加它们。

或者您可以编写一个应用程序来为您生成它们。或者使用代码片段。

# asp.net - 为什么在 FireFox 中禁用时链接按钮不灰显？

> ID：792194
> 
> 赞同：9
> 
> 时间：2009-04-27T03:51:21.603
> 
> 标签：asp.net, firefox, render, linkbutton

为什么当我在按钮上设置 enabled=false 时，它​​在 Firefox 中无法正确呈现？而不是灰色的链接它仍然是蓝色的。

[更新]

ASP.net 已经删除了链接上的此类标签，因此唯一需要做的就是将链接变灰。换句话说，CSS 样式更改不是功能更改。

以下有效解决了禁用按钮在 Firefox 和 google chrome 中未显示为灰色的问题。我将它放入我的样式表中，现在我的所有链接按钮都正确呈现。

a[禁用]{
颜色：灰色！重要；文字装饰：无！重要；}

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-09-03T12:22:09.023

```
a[disabled]
{
   color:Grey; text-decoration:none;
} 
```

为我工作，谢谢...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T04:09:58.143

从[W3Scholl 开始](http://www.w3schools.com/tags/tag_a.asp)，“启用”属性不是 XHTML 4 的标准属性（它是 Microsoft 标准。）。您应该从超链接中删除 href 属性或使用我的以下代码

```
// cancel click event.
LinkButton1.Attributes["OnClick"] = "return false;";
// set css to display same disabled link in all browser
LinkButton1.CssClass = "LinkButton_Disabled"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-26T15:58:48.330

当您禁用按钮时，它会向按钮添加“aspNetDisabled”类。所以你可以轻松地用你想要的任何东西设置“aspNetDisabled”类。

```
 .aspNetDisabled {
        color: black;
        background-color: #e3e3e3;
        text-decoration: none;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-13T15:40:30.810

在 C# 中，我发现扩展对于创建跨浏览器解决方案最有帮助。

```
public static class Extensions
{
    public static void Disable(this HtmlAnchor obj)
    {
        obj.Attributes.Remove("href");
        obj.Attributes.Add("disabled", "true");
        obj.Style.Add("color", "gray");
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-27T14:25:12.903

下面的解决方案适用于非链接按钮，但也适用于链接。

```
var obj = document.getElementById('buttonId'');
getLabel = function(elem){
if (elem.id && elem.id=="label") {
elem.id = "disabledLabel";
}
};            
Dom.getElementsBy(getLabel ,'td', obj); 
```

这会将按钮显示为禁用或灰显。

# linux - GNU链接器：替代--version-script在命令行列出导出的符号？

> ID：792195
> 
> 赞同：9
> 
> 时间：2009-04-27T03:51:22.383
> 
> 标签：linux, linker, symbols

在具有 GNU 工具链的 Linux 上，我知道如何使用版本脚本 (gcc -Wl,--version-script=symbols.map) 控制从共享库中导出的符号，但我想在命令行上列出导出的符号反而。IOW，我想要相当于

```
link /EXPORT:foo 
```

来自 MS 工具链。是否可以 ？

编辑：

我的问题可能不是很清楚：如果我有一个库 libfoo.so，并且我只想导出库 foo1 和 foo2，我可以创建一个版本脚本 foo.linux，如下所示

```
libfoo.so
{
global:
    foo1;
    foo2;
local:
    *;
} 
```

做

```
gcc -shared foo.c -Wl,--version-script=foo.linux -o libfoo.so -soname libfoo.so 
```

我希望能够做这样的事情：

```
gcc -shared foo.c -Wl,--export-symbol=foo1 -Wl,--export-symbol=foo2 -o libfoo.so -soname libfoo.so 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-12T10:50:52.783

我不确定您是否可以按照自己的意愿执行此操作。一种方法是使用您提到的链接器版本脚本。另一种方法是`__attribute__ ((visibility("default")))`为您想要导出的任何内容添加源代码并编译所有内容`-fvisibility=hidden`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-01-26T11:27:21.943

我可能迟到了八年，但是是的，你实际上可以做你想做的事。

使用 Bash[进程替换](http://tldp.org/LDP/abs/html/process-sub.html)：

```
gcc -shared foo.c -Wl,--version-script=<(echo "{global:foo1;foo2;local:*;};") -o libfoo.so -soname libfoo.so 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-27T15:55:29.787

readelf 和 objdump 有很多选择。怎么样：

```
readelf --symbols --use-dynamic $yourlib.so 
```

# sqlite2 - SQLITE 2 文档

> ID：792197
> 
> 赞同：2
> 
> 时间：2009-04-27T03:53:35.217
> 
> 标签：sqlite2

我正在尝试查找 SQLite2 的在线文档。我输入的项目使用SQLite2，我通常使用SQlite3。我做了一个谷歌搜索，并没有找到太多。

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T04:27:59.643

sqlite 文档在此处有针对第 2 版 API 的特定部分： [http ://www.sqlite.org/docs.html](http://www.sqlite.org/docs.html)

还有一节描述了从 V2 到 V3 的重大变化。

# sml - 如何在 SML 中打印类型信息？

> ID：792203
> 
> 赞同：1
> 
> 时间：2009-04-27T03:58:02.790
> 
> 标签：sml, smlnj

在 SML 中执行命令后，返回“it”，其中包含命令返回的数据和类型。例如：

```
false;  
val it = false : bool 
```

假设我在这样的程序中有一个绑定：

```
 val argsToOutput = (map (fn (Absyn.var_exp(n)) => 
                               (lookupReference env n)) exps) 
```

有没有办法以与“it”的打印方式类似的方式打印“argsToOutput”的值和数据类型（在程序中间）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T02:14:54.093

你可以这样做：

```
 val argsToOutput = (map (fn (Absyn.var_exp(n)) => 
                               (lookupReference env n)) exps)
 ...
 in
   (print (argsToOutput); 2 )
 end 
```

而不是 2 你有你的让身体的价值。奇怪的是打印会在 argsToOutput 上出错，但它会给你在预期类型是字符串的地方找到的类型。

当我不得不打印出数据类型的值时，我创建了一个 tostring() 函数来获取数据类型，并将其转换为字符串。它需要一些工作，因为它有一些嵌套的数据类型，但之后非常有价值，因为它适用于该类型的所有 var。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T17:05:37.580

> 有没有办法打印“argsToOutput”的值和数据类型（在程序中间）

不。它在顶层工作，因为编译器保留了编译阶段的类型。它不适用于从函数体中提取的任意表达式。但是，如果您有幸拥有一个其值与函数无关的表达式，您可以将其拉出并`val`在顶层编写一个绑定并得到您想要的：

```
- val thing = hd [1, 2, 3];
val thing = 1 : int 
```

这是一个很差的安慰，因为它涵盖了一些感兴趣的案例。

我想您可能想搜索其他常见问题的答案：

1.  如何让我的 ML 程序进行类型检查？
2.  如何确定类型良好的 ML 程序中子表达式的类型？
3.  在 ML 程序中，如何打印值以进行调试？

（答案很丑。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T08:36:01.107

SML 是静态类型的，因此程序中任何值的类型在编译时都是静态已知的。当你想“打印出来”时，我不确定你想要什么。

也许你无法通过自己查看代码来弄清楚某物的类型是什么。当您在解释器的顶层定义一个值时，无论是直接还是使用加载文件`use "whatever.sml";`，解释器都会告诉您为该值推断的类型。

或者，如果您有一段代码，您可以在此处发布它（以及它所依赖的任何代码），我们可以帮助您确定其中的特定值具有什么类型。

如果你想确保一个特定的值是某种类型，你可以使用类型保护：`(expression : type)`是一样的东西`expression`，除了在类型检查期间它会确保那个表达式是那个类型。

如果你想在运行时以某种方式获取类型信息，我认为你不能，而且你不应该这样做，因为它在编译时就已经知道了。

# c++ - 以编程方式压缩和修复数据库

> ID：792209
> 
> 赞同：1
> 
> 时间：2009-04-27T04:06:22.380
> 
> 标签：c++, ms-access, compact-database

如何从 C++ 中调用 Access 的压缩和修复数据库实用程序？我已经在使用 ADO 和 ADOX，因此使用其中任何一个的解决方案都会很方便。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T04:25:08.527

类似于：

[如何以编程方式修复（不仅仅是压缩）Access .mdb 文件？](https://stackoverflow.com/questions/141810/how-can-i-programmatically-repair-not-merely-compact-an-access-mdb-file)

您可以使用`COM`访问`JRO.JetEngine`对象来执行此操作。[CodeProject](http://www.codeproject.com/KB/database/mdbcompact_latebind.aspx)的 C# 中有一个示例，转换为 C++ 应该不会太难。

更新：感谢@le dorfier，这是[一篇](http://support.microsoft.com/kb/230501)带有 C++ 示例的文章。

# c# - 将 ListBox_SelectedItem 保存到 file.txt

> ID：792213
> 
> 赞同：1
> 
> 时间：2009-04-27T04:07:53.500
> 
> 标签：c#, .net, winforms

大家好，我希望将我的音乐播放器播放的歌曲的年表保存在 file.txt 中。我试过这个代码片段但不起作用：

```
 StreamWriter sw = new StreamWriter(@"c:\Media PlayList\List.txt");

   private void listBox1_SelectedIndexChanged(object sender, EventArgs e)

    {
        wmp.URL = Convert.ToString(listBox1.SelectedItem);

foreach (object o in listBox1.SelectedItems) 

         {
               sw.WriteLine(DateTime.Now + " - " + o.ToString());          
         }
    } 
```

我如何存储歌曲：

```
private List<string> GetFolder(string Folder)
    {

        string filena;
        DirectoryInfo dir = new DirectoryInfo(Folder);
        FileInfo[] files = dir.GetFiles("*.mp3", SearchOption.AllDirectories);

        List<string> str = new List<string>();

        foreach (FileInfo file in files)
        {
            str.Add(file.FullName);    }
    }

private void Form2_Load(object sender, EventArgs e)
    {

       List<string> uno = GetFolder(@"D:\\Music\\");
        listBox1.DataSource = uno;
        listBox1.DisplayMember = "uno"; } 
```

每次音乐播放器更改歌曲时，我都需要文件“List.txt”由 listbox.SelectedItem 更新，但我无法用我的代码更新“List.txt”。我哪里错了？感谢您的关注。

很好的问候

编辑：我更新了我的代码片段，希望它会很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T04:31:16.330

如果*更新*文件失败，您可能希望在构造函数中设置附加参数，例如：

```
StreamWriter sw = new StreamWriter(@"c:\Media PlayList\List.txt", true); 
```

如果它未能触发 SelectedIndexChanged 事件，请更新问题以反映...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T08:18:05.567

private void listBox1_SelectedIndexChanged（对象发送者，EventArgs e）

```
{
    wmp.URL = Convert.ToString(listBox1.SelectedItem);

    foreach (object o in listBox1.SelectedItems) 
           sw.WriteLine(DateTime.Now + " - " + o.ToString());          
   sw.close();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T16:11:17.300

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Windows.Forms;

namespace WindowsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            listBox1.DataSource = GetFolder("D:\\Music\\");
        }

        private static List<string> GetFolder(string folder)
        {
            List<string> FileList = new List<string>();
            foreach (FileInfo file in new DirectoryInfo(folder).GetFiles("*.mp3", SearchOption.AllDirectories))
                FileList.Add(file.FullName);
            return FileList;
        }

        private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            StreamWriter sw = new StreamWriter("c:\\Media PlayList\\List.txt", true);
            wmp.URL = Convert.ToString(listBox1.SelectedItem);
            foreach (object o in listBox1.SelectedItems)
                sw.WriteLine(DateTime.Now + " - " + o);
            sw.Close();
        }
    }
} 
```

上面的代码将为您完成工作。笔记：

*   如果要追加到文件，则应在创建 StreamWriter 时将 true 作为第二个参数传递。
*   将数据写入文件后，应显式关闭 StreamWriter，否则文件将为空。
*   关闭文件后，您将无法再对其进行写入。如果你愿意，你可以重新打开它。

# c++ - 带有发布和调试版本的简单 makefile - 最佳实践

> ID：792217
> 
> 赞同：23
> 
> 时间：2009-04-27T04:11:14.457
> 
> 标签：c++, makefile, g++

我是makefile的新手。我从“使用 GNU make 管理项目”一书中学习了 makefile 创建和其他相关概念。makefile 现在已经准备好了，我需要确保我创建的文件是好的。这是生成文件

```
#Main makefile which does the build

#makedepend flags
DFLAGS = 

#Compiler flags
#if mode variable is empty, setting debug build mode
ifeq ($(mode),release)
   CFLAGS = -Wall
else
   mode = debug
   CFLAGS = -g -Wall
endif

CC = g++
PROG = fooexe

#each module will append the source files to here
SRC := main.cpp

#including the description
include bar/module.mk
include foo/module.mk

OBJ := $(patsubst %.cpp, %.o, $(filter %.cpp,$(SRC)))

.PHONY:all
all: information fooexe

information:
ifneq ($(mode),release)
ifneq ($(mode),debug)
    @echo "Invalid build mode." 
    @echo "Please use 'make mode=release' or 'make mode=debug'"
    @exit 1
endif
endif
    @echo "Building on "$(mode)" mode"
    @echo ".........................."

#linking the program
fooexe: $(OBJ)
    $(CC) -o $(PROG) $(OBJ)

%.o:%.cpp
    $(CC) $(CFLAGS) -c $< -o $@

depend:
    makedepend -- $(DFLAGS) -- $(SRC)

.PHONY:clean
clean:
    find . -name "*.o" | xargs rm -vf
    rm -vf fooexe 
```

**问题**

1.  上面给出的 makefile 可以很好地与发布和调试版本一起使用。但它的格式是否正确？或者你看到其中有什么缺陷吗？
2.  当使用*make*调用时，上面的 makefile 默认会调试构建。对于发布版本，*make mode=release*是必需的。这是正确的方法吗？
3.  提供给 g++ 的调试和发布编译器标志是否正确？对于调试，我使用*-g -Wall*和发布，只是*-Wall*。这是正确的吗？

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T05:19:07.587

1.  这是一种合理的格式。它专门与 GNU Make 相关联，但如果您选择在每个平台上使用 GNU Make，这将是一个相对较小的问题。
    *   如果存在缺陷，您最终可能会链接在调试模式下构建的目标文件以创建最终构建。
    *   有些人可能会争辩说 'mode=release' 选项是非标准的。他们是对的，但我知道没有标准的替代方案。您只需要知道您的约定可能不适合所有人（但它不必 - 它只需要适合您和您的用户）。
2.  默认构建调试版本可能是明智的 - 并且比默认构建发布版本更明智。
3.  删除`-g`发布版本的标志并不会自动出错，但如果您的代码曾经产生核心转储，如果程序文件包含调试信息，则更容易制作核心转储的头部或尾部。调试信息的主要成本是程序文件中不需要加载到系统内存中的额外部分——运行时成本很小。
    *   您应该考虑是否在其中包含优化标志。使用 GCC 工具集，您可以同时使用`-g`和`-O`. 调试优化的代码更难，但它会给你（通常是显着的）性能优势。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-27T06:43:32.720

我建议以下模式：

```
for debugger: -O0 -g -Wall
for development and internal release: -O2 -g -Wall
for release outside the company: -O2 -Wall 
```

理由：

*   在“生产模式”下开发和测试代码非常重要。您会发现在某些情况下，由于代码中的错误，在优化模式下没有优化的代码会崩溃。（相信我这种情况经常发生）——所以使用`-O2`
*   在大多数情况下，即使使用优化的代码，您仍然可以很好地调试，所以添加`-g`. 但是，如果在这种模式下很难找到错误，您可以编译为调试器`-O0`
*   只有当您在代码中包含调试信息时遇到问题，您才应该删除`-g`. 在生产环境中使用代码是个好主意`-g`，因为如果发生崩溃，您可以获得更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-30T17:47:18.370

我会接受 Artyom 关于标志的建议并使用`-O`.

我的主要建议是使默认模式“发布”。您公司以外的任何用户都不会知道您的`make mode=release`约定，其中 99.99% 的人会希望它为发布而构建。

我喜欢你`-Wall`在所有模式下的表现。如果你想变得非常迂腐……`-Wall -std=c++98 -pedantic -Wextra -Wconversion`是一个好的开始。-std=c++98 如果您与 g++ 结婚，则可能没有必要，但如果您对可移植性有任何幻想，您会想要的。

# tortoisesvn - 乌龟 tsvn:logminsize 帮助

> ID：792219
> 
> 赞同：1
> 
> 时间：2009-04-27T04:11:37.093
> 
> 标签：tortoisesvn

我希望我的团队将至少 x # 个字符输入到 Tortoise 的提交评论中。有一个钩子可以做到这一点吗？我想我需要使用一个名为 tsvn:logminsize 的属性，但我不知道如何为所有存储库全局添加该属性，以便团队中的任何人在签入任何项目的任何代码时都需要输入 x 字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T04:24:19.713

您可以将其添加到 SVN 中的 precommit 挂钩（Tortoise 只是 SVN 的 GUI 客户端，因此必须在您的 SVN 服务器本身中执行此操作）。

1.  在您的存储库目录下，您将找到 hooks/pre-commit.tmpl。
2.  编辑此文件并将其保存为预提交并使其成为可执行文件
3.  检查文件中的注释长度，如果它没有至少 x# 个字符，则返回一个非零值。

请注意，预提交文件可以是任何语言（python、shell 脚本等）。

更多细节在这里[- http://oss.segetech.com/bugz-svn-wiki/pre-commit](http://oss.segetech.com/bugz-svn-wiki/pre-commit)

# haskell - Haskell 图像处理库？

> ID：792221
> 
> 赞同：30
> 
> 时间：2009-04-27T04:12:33.067
> 
> 标签：haskell, image-processing

有人推荐一个好的 Haskell 图像处理包吗？你为什么喜欢它？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-29T15:31:13.743

Hackage 中至少有两个解码器：[stb-image](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/stb-image)（JPEG、PNG、TGA、BMP、PSD 解码器的部分实现，具有非常简单的 API）和[pngload](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/pngload)（用于 PNG 图像的纯 Haskell 加载器）。

否则，您可以将 Haskell 绑定用于现有库，例如[hsmagick](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/hsmagick)或[gd](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/gd)。

还有[Codec-Image-DevIL](http://hackage.haskell.org/package/Codec-Image-DevIL)是 Haskell 与 DevIL 库的绑定。它允许将图像加载到 Haskell 数组中或将数组写入图像。没有别的，但对于读/写它支持大量的图像格式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T04:25:21.303

[我发现netpbm](http://netpbm.sourceforge.net/)格式和工具有很多值得我喜欢的地方：简单、简单和简单。Real World Haskell book 中有一些[关于 netpbm](http://books.google.com/books?id=nh0okI1a1sQC&pg=PA235&lpg=PA235&dq=haskell+netpbm&source=bl&ots=sXVEw3iQdN&sig=IsjDWWNDBnI1mNXsFcUQ_cDtgPE&hl=en&ei=CDP1Sf_GAZjCMa3R6c8P&sa=X&oi=book_result&ct=result&resnum=4)的讨论，并且他们有一些源代码。由于我没有这本书，我不知道他们是否给了一个完整的图书馆。

# c# - C#读取文件内容并查找字符串

> ID：792228
> 
> 赞同：1
> 
> 时间：2009-04-27T04:17:50.213
> 
> 标签：c#, file

我对 C# 真的很陌生。我需要在某个目录下打开一堆代码文件并获取包含一些匹配字符串的特定行。这是一个简单的问题，我可以使用流阅读器逐个打开文件，然后逐行解析它们。我想知道是否有更有效的方法来做同样的事情。就像我的印象一样，流式阅读器和逐行阅读将是繁重的操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T05:37:05.017

已经有一些关于如何获取文件行的​​好帖子，所以我想我会添加一些关于效率的内容。有几个人提到了 File.ReadAllLines() 方法。从效率的角度来看，这种方法是有问题的，因为它会一次将整个文件读入内存。此外，它使用数组作为存储，需要连续的内存。如果文件足够大，这将导致问题。

读取文件的更有效方法是重复使用 StreamReader.ReadLine 方法。它将一次返回一行，您只需将您关心的行保留在内存中。将其转换为延迟评估迭代器也相对容易。

```
public static IEnumerable<string> ReadLinesEnumerable(string path) {
  using ( var reader = new StreamReader(path) ) {
    var line = reader.ReadLine();
    while ( line != null ) {
      yield return line;
      line = reader.ReadLine();
    }
  }
} 
```

在 LINQ 方面。您可以使用 LINQ 来匹配 ReadAllLines 和 ReadLinesEnumerable 方法，因为它们都返回可枚举的数据类型。例如

```
var query = from line in ReadLinesEnumerable(@"c:\some\path\file.txt")
            where Regex.IsMatch(line, @"^(\d)+.*$")
            select line; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T04:22:17.583

File.ReadAllLines() 将为您提供一个包含文件中每一行的数组。如果您能够在文件中途停止阅读，这可能会做更多的工作。如果没有，它可能会为您节省一些 IO 时间（更少的单个 IO 调用，但这只是一个猜测）。

如果您真的很担心，请使用分析器或编写基准测试。否则，使用任何最容易阅读的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T04:21:34.260

如果您需要检查文件的全部内容，那么您将需要阅读每一行。`ReadLine()`是一种很好的方法。

您可以一次读取整个文件内容，使用`StreamReader.ReadToEnd()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T04:28:18.270

ReadToEnd() 方法在 LoC（代码行）方面确实很有效，但如果您担心性能，您可能需要小心它，因为它基本上将整个文件内容加载到内存（字符串）。如果文件大小很大，您肯定会在性能上受到打击。

# java - ROUND_HALF_EVEN 在一系列计算中重复应用时，为什么以及如何最小化累积误差？

> ID：792237
> 
> 赞同：9
> 
> 时间：2009-04-27T04:25:08.247
> 
> 标签：java, rounding

有人告诉我 ROUND_HALF_EVEN 是财务数据计算的首选舍入模式。我很想知道这种舍入模式为什么以及如何减少 javadoc BigDecimal 1.4.2 中所述的累积误差。谢谢，院长

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T04:58:09.790

来自[维基百科](http://en.wikipedia.org/wiki/Rounding#Round-to-even_method)：

> 尽管习惯将数字 4.5 向上舍入到 5，但实际上 4.5 与 5 的距离并不比它与 4 的距离更近（距离两者的距离为 0.5）。在处理趋势很重要的大量科学或统计数据时，传统的平均四舍五入会使数据略微向上偏差。在大量数据上，或者当在数字信号处理中执行许多后续舍入操作时，舍入到偶数规则倾向于减少总舍入误差，（平均）相等部分的数字舍入作为舍入下。这通常会减少结果的向上偏差。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T06:31:47.053

我的印象与其他两个答案相同，即当应用于随机数时，round-half-even 同样可能向上或向下舍入，因此在大量数据中，由于舍入而没有预期的偏移。但据我所知，round-half-even 本身并没有什么特别之处。我认为，round-half-odd （将 n.5 舍入到最接近的奇数）将具有相同的属性。与随机舍入策略相同，ien5 以 50% 的概率随机向上或向下舍入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T05:34:34.257

澄清一下，如果数字的非小数部分是奇数 (5.5 -> 6)，则“四舍五入”将 0.5 向上舍入，如果非小数部分为偶数 (4.5 -> 4)，则将其向下舍入 —即，到最接近的偶数。

所以 4.5 -> 4、5.5 -> 6、6.5 -> 6 等等。

对于一组真正随机的十进制数，这种类型的舍入不会显着地向上或向下倾斜总数。因此，它在金融应用中作为一种“公平”的舍入系统而受到青睐。

# sql-server - 为什么 SQL Server 2008 在长事务 INSERT 上阻止 SELECT？

> ID：792242
> 
> 赞同：17
> 
> 时间：2009-04-27T04:28:55.710
> 
> 标签：sql-server, sql-server-2008

我们正在尝试创建一个只接受定期插入的新记录的事务表。

这个简单的表需要我们随着时间的推移不断地向它添加新记录。该表中的交易量预计会非常高，并且可能会定期批量导入交易（>1000），这可能需要几秒钟才能完成。

然后，我们根据这些数据执行一组选择语句，将不同的列分组以返回所需的值。

从我们最初的测试中，我们发现了一个与 SQL Server 相关的瓶颈，它在 INSERTS 事务的中间阻塞了我们的 SELECT。

下面是一个简单的示例，可以运行它来说明问题。

-- 简单的数据库表

```
create table LOCK_TEST (
LOCK_TEST_ID int identity ,
AMOUNT int); 
```

-- 在 1 个查询窗口中运行

```
begin tran
insert into LOCK_TEST (AMOUNT) values (1);
WAITFOR DELAY '00:00:15' ---- 15 Second Delay
insert into LOCK_TEST (AMOUNT) values (1);
commit 
```

-- 在查询 2 中并行运行

```
select SUM(AMOUNT)
from LOCK_TEST; 
```

我希望查询 2 立即返回，在查询 1 完成之前返回 0，然后显示 2。我们永远不想看到从第二个查询返回的 1。

我们看到的答案与 select 语句中的 WITH (NOLOCK) 相关。但这违反了交易边界，返回的信息可能是财务性质的，我们不希望在查询中看到任何未提交的细节。

我的问题似乎在 INSERT 方面......
**为什么 INSERT 会阻止 SELECT 语句，即使它没有修改任何现有数据？**

**加分问题：** 这是 SQL Server 的“功能”，还是我们也会在其他数据库风格中找到它？

**更新** 我现在有时间找到一个本地 oracle 数据库并运行相同的简单测试。正如我所料，这次测试通过了。

即我可以随心所欲地运行查询，它会返回 null 直到第一个事务提交，然后返回 2。

**有没有办法让 SQL Server 像这样工作？还是我们需要迁移到 Oracle？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T12:41:30.177

这种锁定行为是 SQL Server 的一个特性。在 2005 及更高版本中，您可以使用[行级版本控制](http://msdn.microsoft.com/en-us/library/tcbchxcb(VS.80).aspx)（这是 Oracle 默认使用的）来实现相同的结果并且不会阻止您的选择。这给 tempdb 带来了额外的压力，因为 tempdb 维护行级别的版本控制，因此请确保您适应这一点。要使 SQL 以您希望的方式运行，请运行以下命令：

```
ALTER DATABASE MyDatabase
SET ALLOW_SNAPSHOT_ISOLATION ON

ALTER DATABASE MyDatabase
SET READ_COMMITTED_SNAPSHOT ON 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T04:37:42.413

这在 SQL Server 和 Sybase 中是完全标准的行为（至少）。

数据更改（插入、更新、删除）需要[独占锁](http://msdn.microsoft.com/en-us/library/ms175519.aspx)。这会导致读者被阻止：

> 使用排他（X）锁，没有其他事务可以修改数据；只有使用 NOLOCK 提示或读取未提交的隔离级别才能进行读取操作。

在 SQL Server 2005 及更高版本中，他们引入了快照隔离（也称为行版本控制）。来自 MS BOL：[了解基于行版本控制的隔离级别](http://msdn.microsoft.com/en-us/library/ms189050.aspx)。这意味着读者有最新提交的数据，但是如果你想写回，比如说，你可能会发现数据是错误的，因为它在阻塞事务中发生了变化。

现在，这就是为什么最佳实践是保持交易简短。例如，仅在 BEGIN/COMMIT 之间处理您需要的内容，不要从触发器发送电子邮件等。

编辑：

像这样的锁定在 SQL Server 中一直发生。但是，锁定时间过长会变成阻塞，从而降低性能。显然，太长是主观的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T04:44:52.380

这也存在于 MySQL 中。这是它背后的逻辑：如果您对某些数据执行 SELECT，您希望它对最新数据集进行操作。这就是 INSERT 导致表级锁定的原因（除非引擎能够像 innodb 那样执行行级锁定）。有一些方法可以禁用这种行为，以便您可以进行“脏读”，但它们都是特定于软件（甚至是数据库引擎）的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-19T14:19:53.910

我也遇到了这个问题。经过调查，似乎不是数据本身被锁定，而是由于插入而被修改的聚集索引。由于聚集索引驻留在数据页上，因此关联的数据行也被锁定。

# asp.net - 我可以获得样式表来检测页面元素上的自定义标签吗？

> ID：792244
> 
> 赞同：1
> 
> 时间：2009-04-27T04:30:17.423
> 
> 标签：asp.net, css

我可以获得样式表来检测页面元素上的自定义标签吗？

我想在 stylehseet 中添加一些功能，可以检测到链接按钮上的 disabled="disabled" 属性并将其变灰。

[更新]

很棒的建议。这有效地解决了在 Firefox 和 google chrome 中未显示为灰色的禁用按钮。以下是我放入样式表的内容，现在我的所有链接按钮都正确呈现。

```
a[disabled]{  
  color:Grey !important;
 text-decoration:none !important;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T04:43:38.403

我认为您的意思是自定义属性？对此的 CSS 规则将是（假设您的按钮是一个`input`元素）：

```
input[disabled="disabled"] {
    /* ... */
} 
```

但是，这在 IE6 中不起作用。您最好的选择可能是为按钮添加一个类（例如`class="button-disabled"`），然后像这样设置它的样式：

```
input.button-disabled {
    /* ... */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T04:43:23.023

我很确定您可以执行以下操作（这里我假设您的“链接按钮”元素是“输入”元素）：

```
input[disabled="disabled"] {
    // Styling
} 
```

史蒂夫

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T04:46:57.553

您*可以*使用 css 选择器来做到这一点，但它在某些浏览器中不起作用。此外，无论如何我都不建议这样做。为什么不向链接按钮添加一个**禁用**的类？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T04:48:02.653

您可以使用 CSS2 选择器（如果浏览器支持它）来显示基于标签属性的样式。但是当我在 IE8 中使用“禁用”属性时，我发现了一些问题。默认情况下，IE8 显示标签被灰色禁用（样式表无法更改）。

从以下代码中，FF3 显示绿色超链接。但IE8显示灰色超链接。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd" >
<html>
<head>

<title>Ask a Question - Stack Overflow</title>
<style>
a[disabled="true"]
{
    color:Green !important;
}
</style>
</head>

<body>
 <a href="www.microsoft.com" disabled="true">Microsoft Site</a>
</body>
</html> 
```

# java - 在鼠标事件上添加 Java GUI 组件

> ID：792245
> 
> 赞同：0
> 
> 时间：2009-04-27T04:31:05.533
> 
> 标签：java, user-interface, dynamic

嘿堆栈溢出的人，

我一直在尝试使代码正常工作，我可以在其中双击 a 中的一个项目，它会从属于该类别的项目的所有对象名称从头开始在 Frame 上的不同位置`JList`创建一个新的（这是无用的信息，我`JList`猜测）。但问题是，当我双击列表中的项目时，它会运行代码以将组件添加到其中，`JFrame`但它从未出现过，这是因为我在运行时间后使用鼠标事件构建它吗？ ?

我的桂课是：

```
public class MediaGUI extends JFrame 
```

并且添加代码发生在这里

```
 _mediaList.addMouseListener(new MouseAdapter() {
        public void mouseClicked(MouseEvent event) {
            if (event.getClickCount() == 2) {
                CreateObjectPane(_mediaList.getSelectedValue().toString(););
            }
        }
    }); 
```

这里是构建代码，这个方法属于MediaGUI，所以这个。指的是一个`JFrame`

```
 private void CreateObjectPane(String category)
 {
     /*=======================================================================
     * Create ther list on Objects that belong to each category
     * Also a scroll bar for the list
     *=======================================================================*/
    String objects[] = _mediaHandler.GetObjects(category);
    _mediaList = new JList(objects);
    _mediaList.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
    _mediaList.setLayoutOrientation(_mediaList.VERTICAL);
    _mediaList.setVisibleRowCount(-1);

    _mediaScrollPane = new JScrollPane(_mediaList);
    _mediaScrollPane.setPreferredSize(new Dimension(100,100));
    _mediaScrollPane.setAlignmentX(CENTER_ALIGNMENT);

    _mediaPanel = new JPanel();
    _mediaPanel.setLayout(new BoxLayout(_mediaPanel, BoxLayout.PAGE_AXIS));
    _mediaLabel = new JLabel("Media Objects");
    _mediaLabel.setLabelFor(_mediaList);

    _mediaPanel.add(_mediaLabel);
    _mediaPanel.add(Box.createRigidArea(new Dimension(0, 15)));
    _mediaPanel.add(_mediaScrollPane);
    _mediaPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));

    this.add(_mediaPanel, BorderLayout.CENTER);
} 
```

您可以提供的任何帮助都会很棒，如果需要更多解释，我很乐意要求

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T06:11:30.737

从[文档](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/Container.html#add(java.awt.Component,%20java.lang.Object))中：

```
Note: If a component has been added to a container that has been displayed, 
validate must be called on that container to display the new component. 
If multiple components are being added, you can improve efficiency by 
calling validate only once, after all the components have been added. 
```

其他一些提示：

*   将 CreateObjectPane 重命名为 createObjectPane
*   您使用的是什么 LayoutManager？尝试使用它，因为大多数时候新组件不会出现在您期望的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T07:28:19.663

我需要在新创建的组件的容器上调用 revalidate() 方法。

# visual-studio - Visual Studio 2008 在构建后事件之后会发生什么事件？

> ID：792247
> 
> 赞同：1
> 
> 时间：2009-04-27T04:32:33.143
> 
> 标签：visual-studio, silverlight, msbuild, build-process

我只是创建一个包含 3 个项目的解决方案。

*按构建顺序排序*

1.  **ASP.NET Web 应用程序项目的 /ClientBin 中包含的**Silverlight 应用程序****

***   **Windows 窗体应用程序**，用于在 Visual Studio 传递构建（构建后事件）时优化 /ClientBin 中的所有 xap。

    *   **在 /ClientBin 中显示 Silverlight 应用程序的**ASP.NET Web 应用程序****** 

 ****当我成功构建 ASP.NET Web 应用程序时，Web 应用程序项目中的 ClientBin 目录包含 3 个 Xap 文件。之后`VS.net`触发执行 Windows 窗体应用程序的构建后命令事件。Windows 窗体从 3 个 Xap 文件中优化所有 Xap 和远程 2 个 Xap 文件。

最后，Vs.net 将 Silverlight 应用程序项目中的 3 个 Xap 文件再次复制到 ClientBin 目录。为什么？在构建后事件之后，我找不到任何有关复制 Xap 文件的日志（通过使用 MSBuild 项目构建输出详细程度：诊断）

```
Target "PostBuildEvent" in file "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets":
  Task "Exec"
    Command:
    **T:\myProject\Higgs\Higgs\Higgs.Utils.WinApp\bin\Higgs.Utils.WinApp.exe mode=OptimizeXap clientbindir=T:\myProject\Higgs\Higgs\Higgs.Web.UI\ClientBin\ mainxapfilename=Higgs.Silverlight.UI**
  Done executing task "Exec".
Done building target "PostBuildEvent" in project "Higgs.Web.UI.csproj".
Target "CoreBuild" in file "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets":
  Task "CallTarget" skipped, due to false condition; ('$(UnloadProjectsOnCompletion)'=='true') was evaluated as ('false'=='true').
  Task "CallTarget" skipped, due to false condition; ('$(UnloadProjectsOnCompletion)'=='true') was evaluated as ('false'=='true').
  Task "CallTarget" skipped, due to false condition; ('$(UnloadProjectsOnCompletion)'=='true') was evaluated as ('false'=='true').
Done building target "CoreBuild" in project "Higgs.Web.UI.csproj".
Target "AfterBuild" in file "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets":
Done building target "AfterBuild" in project "Higgs.Web.UI.csproj".
Target "Build" in file "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets":
  Building target "Build" completely.
  No input files were specified.
Done building target "Build" in project "Higgs.Web.UI.csproj".
Target "AfterRebuild" in file "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets":
Done building target "AfterRebuild" in project "Higgs.Web.UI.csproj".
Target "Rebuild" in file "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets":
  Building target "Rebuild" completely.
  No input files were specified.
Done building target "Rebuild" in project "Higgs.Web.UI.csproj".

Done building project "Higgs.Web.UI.csproj". 
```

**更新**

我通过构建 Windows 窗体应用程序更新了构建顺序。构建 Web 应用程序后。接下来，我使用 Windows Dorm 应用程序构建后事件来执行其 EXE。一切正常。但我不喜欢这个解决方案，因为这对我来说是非常奇怪的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T08:31:41.507

我假设这些项目相互引用？所以：

*   ASP.NET Web 应用程序至少引用了 SilverLight 应用程序。
*   Win Forms App 引用 Silverlight 应用程序。

Visual Studio 会自动将依赖文件复制到项目层次结构中，除非您告诉它不要这样做。所以 Visual Studio 将采取的步骤是：

1.  构建 SilverLight App，并将其输出复制到 Forms App 和 Web App
2.  运行 SilverLight 应用程序项目的“构建”选项卡中定义的任何构建后事件。
3.  构建 Win Forms 应用程序，如果它被其他任何东西引用，请适当地复制输出。
4.  运行 Win Forms App 项目的“构建”选项卡中定义的任何构建后事件。
5.  构建 Web 应用程序
6.  运行 Web 应用项目的“构建”选项卡中定义的任何构建后事件。
7.  运行通过 MSBuild 定义的任何“构建后”事件。

基本上，大多数相关动作发生*在*构建后事件之前：

```
Task "FindUnderPath"
  Comparison path is "D:\Projects\PublicSites\WebTest".
  Path [...]
  [...]
Done executing task "FindUnderPath".
Task "FindUnderPath"
  Comparison path is "bin\".
  Path [...]
  [...]
Done executing task "FindUnderPath".
Task "FindUnderPath"
  Comparison path is "obj\Debug\".
  Path [...]
  [...]
Done executing task "FindUnderPath".
Task "RemoveDuplicates"
Done executing task "RemoveDuplicates".
Done building target "_CleanGetCurrentAndPriorFileWrites" in project
  "WebTest.csproj".
Target "IncrementalClean" in file 
  "c:\WINDOWS\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets":
Task "FindUnderPath"
  Comparison path is "bin\".
Done executing task "FindUnderPath".
Task "FindUnderPath"
  Comparison path is "obj\Debug\".
Done executing task "FindUnderPath".
Task "Delete"
Done executing task "Delete".
Task "RemoveDuplicates"
Done executing task "RemoveDuplicates".
Task "WriteLinesToFile"
Done executing task "WriteLinesToFile".
Done building target "IncrementalClean" in project 
  "WebTest.csproj". 
```

然后 build 和 AfterBuild 事件发生。

我的猜测是 VS 注意到 SilverLight 应用程序的输出与其下的版本不同，因此去获取一个新副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T12:35:01.080

这并不能完全解决您的情况，但仅供参考， PostBuildEvent 似乎是构建过程的最后一步；您可以通过检查了解有关订购的更多信息

c:\Windows\Microsoft.NET\Framework\v2.0.50727\Microsoft.Common.targets

它显示了 msbuild 逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T07:51:48.543

我不知道你到底有什么问题，但如果你的项目有任何依赖，你应该命令它们正确构建。

# git - DVCS 如何帮助科学编程？

> ID：792249
> 
> 赞同：12
> 
> 时间：2009-04-27T04:35:29.627
> 
> 标签：git, dvcs, scientific-computing

我正在做一些初步工作，以调查 DVCS（如 Git、Hg、Bazar 之类）如何在科学编程过程中提供帮助，尤其是对研究生而言。我认为我在这方面处于非常有利的位置，因为我已经编程了好几年，目前正在开始一个自然科学的硕士课程。目标是在一两个月内对此进行简短的介绍。

在我看来，除了源代码控制的明显优势外，DVCS 目前还为研究生的日常生活提供了以下改进：

1.  分枝：

    这是最大的。从观察 DVCS 实践可以清楚地看出，廉价分支主要鼓励新功能的实验。科学编程就是实验。可以创建不同的分支来调整参数或算法。这一点尤其重要，因为大多数科学代码在他们的一生中都没有看到过一次重构（大多数研究生甚至不知道它是什么），所以去不同分支的能力会给典型的疯狂带来一些方法。快速提交也可能意味着使用提交评论作为实验室笔记本的替代品。计算结果可以标记为特定的提交哈希码，以进行可重复的研究。

2.  推送到服务器：

    由于现在大多数科学代码都在某种集群上运行，因此 DVCS 可以用作某种更高级的 Rsync，许多人已经在使用它来将“生产”代码推送到 HPC 集群。这与分支相结合，无需离开即可轻松运行多个版本的代码

3.  论文合作：

    需要我多说？拥有多个作者的论文的运行方式与小型开源项目完全一样。当作者都用 LaTex 写作时，论文上的协作应该是自然而然的，如果写作是用 Word 之类的东西完成的，则会带来额外的复杂性。这是提交评论可能发挥更大作用的地方。

我的问题是，您认为 DVCS 可以为科学程序员做出什么贡献？我在社区中看到很多关于转向源代码控制的讨论，但大多数人仍在研究 Subversion。从我粗略的笔记来看，听起来 DVCS 应该是新研究生的完美工作流程范例。我的想法有问题吗？或者科学编码只是落后太多，甚至没有*听说过*DVCS 工具？

* * *

有关的：

*   [在科学环境中编程的实践](https://stackoverflow.com/questions/38239/practices-for-programming-in-a-scientific-environment)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T14:58:52.000

培训是一个真正的问题。我认识不少粒子物理学家（拥有大型编程项目的大科学），他们对源代码控制的总知识是如何运行`cvs checkout`、`cvs update`和`cvs commit`.

是的，CVS。我认识一位软件组负责人，因为这些人，他推迟了向 Subversion 的迁移。

在下一级技能中，他们还知道`diff`and`stat`命令以及如何指定分支或标签，但可能会避免创建或合并分支。

如果您计划引入 DVCS，请计划一个强化的、持续的培训和支持计划。科学家（或至少物理学家）通常很少接受计算机科学方面的正式培训，并且可能只有最模糊的软件过程概念。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T05:56:09.977

关于你的主要观点：

*   “DVCS 的明显优势”：值得重申的是，特别是在学术环境中，可能有严格的 IT 规则*不允许*外部连接，DVCS 允许使用**本地**存储库。这意味着您不必“连接”到一个中央存储库即可访问项目的完整历史记录，这可能是 DVCS 对科学程序员的主要贡献。

但这也意味着您必须制定某种政策，以允许任何给定的工作“聚集在一起”并合并到一个存储库中，这并不意味着只有一个“中央”库：可以想象几个中央存储库对于几个大项目。尽管如此，这仍需要*管理*（不可低估）。

由于您的主要第一点，“整合”过程可能非常困难：

*   分支：学生需要**[仔细分支](https://stackoverflow.com/questions/216212/how-do-you-maintain-development-code-and-production-code/216228#216228)**（因为它很容易）。我看到了名为“toto”、“Monday”、“myName”、...的分支的份额：一旦发布到另一个（更中心的）repo，我们应该如何处理这些？如果要合并 20 多个分支以最终确定一个通用代码，那么该过程可能会很快变得容易出错。

对您的其他观点的快速评论：

*   部署（您称之为“推送到服务器”）：是的 DVCS 可用于某种部署，但这意味着您已经组织了您的存储库以包含某种**[“发布组件”](https://stackoverflow.com/questions/220918/what-to-do-when-your-build-process-craps-on-your-version-controlant-question/220949#220949)**（您要推送的文件集）服务器）并且您已经对它们进行了版本控制。发布管理包括许多其他无法在 DVCS 中全部记住的步骤，例如去变量化过程，在该过程中，您将配置文件中的变量替换为适合目标服务器的实际值（端口号、本地路径……） . 您可以尝试通过分支直接管理那些配置文件，但根据我的经验，它很快就会变得太复杂而无法遵循。

*   协作：这不是 DVCS 保留的。（VCS 也提供它们）。请注意，对于某些格式（Word 文档），它们的内部修订系统可能更有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T04:49:20.577

用于科学编程的 DVCS 的一个大问题是二进制数据。通常情况下，科学编程需要输入/输出巨大的文件，并且在我所知道的每个 DVCS（bzr、hg、git）上都会很快扼杀性能。这是目前 svn 更好的一个领域。

我认为 DVCS 对论文也很有用，但这意味着你的合作者也知道 DVCS。

# c# - 在不同页面上上传文件

> ID：792252
> 
> 赞同：1
> 
> 时间：2009-04-27T04:37:41.383
> 
> 标签：c#, asp.net, file-upload

我被困在不同页面上传文件。在一个页面上，我打开一个弹出窗口，要求用户浏览并选择文件，在关闭选项时，弹出窗口关闭，然后我想从主页上传文件，而不是从弹出。我怎样才能做到这一点？我正在使用以下代码来获取上传的文件：

```
HttpFileCollection uploads = HttpContext.Current.Request.Files; 
```

如何从主页访问此值，我`HttpFilecollection`在弹出窗口中使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T05:21:24.790

如果您考虑一下，您的问题实际上并不是如何从不同的页面上传文件。它是*“如何在 ASP.NET 中将值从一个页面传递到另一个页面？”*

好消息是，网上有一百万篇文章解释了如何做到这一点：

一个。[跨页回传](http://msdn.microsoft.com/en-us/library/ms178139.aspx)

湾。[如何在 ASP.NET 页面之间传递值 (MSDN)](http://msdn.microsoft.com/en-us/library/6c3yckfw.aspx)

C。[Steve C. Orr 关于传递值的另一篇文章](http://steveorr.net/faq/PassValues.aspx)。

您需要传递的值是`HttpFileCollection`从弹出页面到父页面的值。然后你可以遍历`HttpPostedFile`集合中的每一个并`Save`根据你的逻辑调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T09:30:38.637

在 JavaScript 中，window 有一个名为“opener”的属性，它指的是父窗口。

因此，您可以调用**window.opener**从弹出窗口访问父窗口并执行您想要实现的任何操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T04:36:23.123

要使用 JavaScript 执行此操作，您可以使用[document.createElement](https://developer.mozilla.org/en/document.createElement)方法。

要使用 ASP.NET 执行此操作，请使用[HtmlTableRow](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmltablerow(VS.80).aspx)类，并将行动态添加到您的表中。

我推荐[JavaScript](http://www.dustindiaz.com/add-and-remove-html-elements-dynamically-with-javascript/)方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T10:17:42.003

根据我的经验，我真的很喜欢 Telerik 上传控件，它提供了很多东西，例如验证、文件大小、允许的扩展名等。但是如果你想要实时进度，最好使用银灯或基于闪光灯的上传控件，telerik 提供那。

这里有一些关于使用 flash + ASP.Net 实现它的链接

*   [http://mattberseth.com/blog/2008/07/aspnet_file_upload_with_realti_1.html](http://mattberseth.com/blog/2008/07/aspnet_file_upload_with_realti_1.html)

*   [http://algorithmist.wordpress.com/2007/10/19/flex-file-upload-with-aspnet/](http://algorithmist.wordpress.com/2007/10/19/flex-file-upload-with-aspnet/)

*   [http://shang-liang.com/blog/flash-upload-file-with-aspnet/](http://shang-liang.com/blog/flash-upload-file-with-aspnet/)

*   [http://www.codeproject.com/KB/aspnet/FlashUpload.aspx](http://www.codeproject.com/KB/aspnet/FlashUpload.aspx)

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T07:21:50.367

这是不可能的。

上传必须由上传控件所在的页面完成。您不能将信息传输到另一个窗口并让它进行上传。

当上传被发送到服务器时，您必须立即处理它。上传的文件只存在于该请求的文件集合中，如果您在处理该请求时不注意文件数据，它就消失了。

因此，如果您在弹出窗口中有上传控件，则弹出窗口必须进行上传。您必须在弹出页面发布时处理上传的文件，但您当然可以在响应中放置一些有关上传文件的信息，当弹出窗口自行关闭时，弹出窗口可以发送到主页。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T07:43:34.510

问题是出于安全原因，您无法设置 input type="file" 元素的值。您不希望恶意网站尝试上传您的 C:\whateverfiletheywant.dat

因此，您必须在弹出窗口中上传到临时上​​传目录，并通过 javascript (window.opener) 将用户上传的文件名发送到主表单

我已经做过很多次了。

如果我必须在弹出窗口中上传某些内容，则类似于我所做的事情。

```
List<string> filesUploaded = new List<string>();
foreach (HttpPostedFile file in HttpContext.Current.Request.Files)
{
    if (file.ContentLength <= 0)
        continue;

    string filename = String.Format("{0}.jpg",Regex.Replace(Guid.NewGuid().ToString(), "[^A-Za-z0-9]*", String.Empty));
    file.SaveAs(Path.Combine(Server.MapPath("/upload/temp/"), filename));
    filesUploaded.Add(filename);
}
Response.Write(String.Format("<{0}>window.opener.FilesUploaded([{1}]);</{0}>","script", String.Join(",",filesUploaded.ToArray()).TrimEnd(new char[]{','}))); 
```

*note ... asp 不喜欢你的 c# 代码中的脚本标签，所以这就是脚本关键字在 String.Format 中的原因

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T05:10:01.400

您可以尝试使用[跨页回发](http://msdn.microsoft.com/en-us/library/ms178139.aspx)，这是 ASP.NET 2.0 中的新功能

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T11:17:19.027

嗨，您可以使用将文件名传递给父窗口

**opener.SomeFunction**

并将文件名作为数组作为参数传递给函数。

希望这可以帮助

# java - 如何将多个 png 图像转换为单个 tiff 文件

> ID：792255
> 
> 赞同：2
> 
> 时间：2009-04-27T04:39:16.090
> 
> 标签：java, image, png, tiff

我有几个 png 格式的图像的字节数组。我必须将其转换为 tiff 文件，然后转换为相应的字节数组。此 tiff 文件将包含多个图像。

我已经搜索了很多，但我没有成功。问题是。我只需要在java中做到这一点！:) 任何人都可以就我的问题提供一些见解吗？

我不会从 ImageMagick 等中受益，因为我有一个处理此转换的服务器组件，然后将其作为 tiff 保存在后端。客户端给了我一个字节数组，它将转换为 png 图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-09-14T07:59:06.610

下面是解决方案。

```
import javax.imageio.ImageIO;
import javax.imageio.ImageWriter;
import javax.imageio.IIOImage;
import javax.imageio.ImageWriteParam;
import javax.imageio.stream.ImageOutputStream;
import java.awt.image.BufferedImage;
import java.io.*;
import java.util.Iterator;

/**
 * 
 * 
 * This class is used to convert the multiple images in to single multi-pages tiff image file.
 *
 */
public class MultiPageTiffGenerator {

 private static String compressionType="JPEG";

 public static boolean generateMultiPageTiff(String dirName,String outputFileName) throws Exception{
  boolean generated=false;
  ImageOutputStream ios=null;
  ImageWriter writer=null;
  try {
   // verify the directory for the image files
   File dir = new File(dirName);
   if(null!=dir && !dir.isDirectory()){
    throw new FileNotFoundException("No directory exists with the given name"+dirName);
   }
   // verify the images files exist

   File[] files = dir.listFiles();
   if(null == files || files.length == 0){
    throw new FileNotFoundException("No image files to process");

   }else{
    // Create the output file on the disk
    File file = new File(dirName+outputFileName+".tif");
    ios = ImageIO.createImageOutputStream(file);

    // Get the appropriate Tiff Image Writer
    Iterator <ImageWriter> writers=ImageIO.getImageWritersByFormatName("tiff");
    if(null== writers || ! writers.hasNext()){
     throw new Exception("Appropriate Tiff writer not found");
    }

    writer = ImageIO.getImageWritersByFormatName("tiff").next();
    writer.setOutput(ios);
    // Set the compression parameters for Tiff image
    ImageWriteParam param = writer.getDefaultWriteParam();
    //param.setCompressionMode(ImageWriteParam.MODE_EXPLICIT); 
    //param.setCompressionType(compressionType); 
    //param.setCompressionQuality(0.9F);

    // Loop through all image files and write them to output tiff image
    for (int i = 0; i < files.length; i++) {
     InputStream fis=null;
     int dotIndex= files[i].getName().lastIndexOf('.');
     dotIndex=dotIndex>0?dotIndex:files[i].getName().length();
     String fileName = files[i].getName().substring(0,dotIndex);
     if(!fileName.equalsIgnoreCase(outputFileName)){
      try{

       fis = new BufferedInputStream(new FileInputStream(files[i]));
       BufferedImage image = ImageIO.read(fis);
       IIOImage img = new IIOImage(image, null, null);
       if (i == 0) {
        writer.write(null, img, param);
       }
       else {
        writer.writeInsert(-1, img, param);
       }
       image.flush();
      }finally{
       if(null!=fis){
        fis.close();
       }
      }
     }

    }
    ios.flush();
    generated=true;

   }

  }catch(FileNotFoundException ex){
   generated=false;
  }catch(IOException ex){
   generated=false;
  }catch(Exception ex){
   generated=false;
  }finally{
   if(null!=ios)
    ios.close();
   if(null!=writer)
    writer.dispose();
  }
  return generated;
 }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T07:40:50.973

[JMagick](http://www.jmagick.org/)库是 ImageMagick 的Java**接口**，很可能是您想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T04:48:27.660

您是否尝试以编程方式执行此操作？您可能想查看 ImageMagick ( [http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php) )

如果您正在编写某种类型的 shell 脚本（bash、批处理），您可以调用`convert`命令（这是该包的一部分。）否则，ImageMagick 的所有功能都可以通过您自己的库（C、perl 等）获得可以尝试与您的程序链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T04:53:41.033

我使用 ghostscript 创建多页 PDF 文件，您也许可以做类似的事情。我的特定应用程序有许多 JPG 文件，我将这些文件传递给 Windows 上的 ghostscript 命令行调用，以创建多页 PDF。

如果我这样做，我会先将 png 文件写入磁盘。接下来使用ghostscript创建一个多页ps文件，将所有PNG文件作为输入，并输出到一个单一的PostScript文档。最后，使用 ps2tif 之类的东西进行最终转换。您可以通过以编程方式编写批处理脚本或让您的应用程序直接调用命令行应用程序来自动化该过程。

这在 Unix/Linux 环境中可能是最容易做到的，但在 Win32 上使用相同的工具是可行的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T14:47:41.637

您应该使用 JAI（Java Imaging API）。它能够读取/写入PNG，至少能够读取TIFF（也应该支持写入）。

[http://java.sun.com/products/java-media/jai/iio.html](http://java.sun.com/products/java-media/jai/iio.html)

如果不支持编写，请使用 Lizard 的 Java 的 Tiff 库 ( [http://www.lizardworks.com/libs.html](http://www.lizardworks.com/libs.html) )

在此线程中，您可以找到如何将多个文件合并到一个 TIFF 中。海报在更改 TIFF 元数据时遇到问题，但这不会影响您的问题。 [http://forums.java.net/jive/thread.jspa?messageID=244190&tstart=0](http://forums.java.net/jive/thread.jspa?messageID=244190&tstart=0)

# video - 将插件集成到moodle中

> ID：792256
> 
> 赞同：2
> 
> 时间：2009-04-27T04:40:10.240
> 
> 标签：video, moodle, plugins

我正在尝试将视频插件集成到moodle中。但我尝试将插件复制到 /mod/ 目录。但是，我们的模块仍然没有包含在 Moodle 的通知中。

我们咨询了 MOODLE 网站以寻求帮助，“ [http://docs.moodle.org/en/Installing_contributed_modules_or_plugins](http://docs.moodle.org/en/Installing_contributed_modules_or_plugins) ”并按照说明进行操作：1）访问您的本地 Moodle 网站[http://localhost:8888/moodle19/](http://localhost:8888/moodle19/)，

2）转到站点管理，3）转到通知，4）滚动到页面底部，5）单击“继续”。

但事实是，我们的模块既没有出现在通知下，也没有继续出现......有人可以让我知道问题可能是什么，因为我没有出现错误......另外请帮我解决这个问题。等待有效的解决方案............

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T05:38:12.003

模块目录的名称是什么？我不确定是否仍然如此，但 Moodle 仅用于处理全部小写的模块目录。如果那不是问题，您可以发布您的 mod 目录结构（您的 mod 根目录下的结构）吗？

# php - 如何从数据库中获取数据的详细信息？

> ID：792258
> 
> 赞同：1
> 
> 时间：2009-04-27T04:40:59.380
> 
> 标签：php, mysql

其实我很困惑给这个问题的标题。我有这样的条件。`limit`当我们使用like从数据库获取记录时，`select * from table_name limit 0,5`我们从 0 到 5 获取数据，当我们使用时，我们`limit 5,10`从 5 获取 10 条记录......是否可以使用 php.ini 显示该记录的特定索引。

谢谢..............

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T04:44:48.153

您使用 LIMIT 不正确。限制是开始，长度。执行 LIMIT 5, 5，您将获得 5 条记录，从 5 (5-9) 开始。

干杯，
埃里克

编辑：也请参阅[MySQL 文档](http://dev.mysql.com/doc/refman/6.0/en/select.html)。它当然有用！

另一个编辑：自从我回答以来，这个问题已经被编辑过，所以我会再次回答。您似乎想获取要返回的行的索引，所以这里有一个 SQL 语句来获取它：

```
set @myStart = 5;
set @myLimit = 10;
set @i = @myStart - 1; 
select id, @i:=@i+1 as myrow from mytable limit @myStart, @myLimit 
```

注意：我从[这里](http://forums.mysql.com/read.php?20,192721,192729#msg-192729)获取了这个解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T04:58:31.193

如果我正确阅读了您的问题，则您正在尝试显示索引以及从数据库中检索到的每条记录。我会在用于显示记录的循环中使用计数器来执行此操作。

在循环之前将计数器设置为偏移量，然后在进行时将其递增。如果这只是显示一个计数器的问题，那真的很容易。在以后的工作中使用该索引只会稍微复杂一些，尽管并不多。

# java - 为什么 String 的 format(Object... args) 被定义为静态方法？

> ID：792259
> 
> 赞同：27
> 
> 时间：2009-04-27T04:43:19.000
> 
> 标签：java, string, format, printf

我想知道为什么**Java** 5 及更高版本使用 String 类中的静态方法提供了一个 printf 样式的格式化程序，如下所示：

```
public static String format(String format, Object... args) 
```

代替

```
public String format(Object... args) 
```

这样我们就可以写`"%02d".format(5)`get`05`而不是`String.format("%02d", 5)`.

我想如果我可以修改 String 类，我可以添加这个：

```
public String format(Object... args) {
    return format(this, args)
} 
```

得到相同的结果。

我发现在 C# 中，也使用静态方法而不是实例方法。

我想知道他们为什么决定这样做，但我没有做出解释。实例方法`trim`并`substring`返回一个新的字符串实例，所以他们应该对`format`.

此外，该`DateFormat`课程还使用了这个：

```
public final String format(Date date) 
```

用于格式化日期。因此，如果我们将 DateFormat 的实例视为格式化程序，则 String 的实例也可以用作格式化程序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T04:50:18.263

也许`"%02d".format(5)`似乎暗示`format`正在调用该方法的对象是格式字符串。

在这种情况下，格式字符串恰好也是 a `String`，因此更进一步，*人们可能会争辩说所有`String`s 都是格式字符串*。

可能可以通过说`String`类中的静态方法可用于格式化字符串来避免这种情况，而不是`String`一般地对所有 s 进行一些隐式声明。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-27T06:54:14.957

虽然我不是 Java 的设计者，但我可以告诉你一个将其设为静态的明确原因。

Java 5 出现了许多特性，但有两个值得注意的是：

*   执行“导入静态”命令的能力，允许在类中轻松使用静态方法，而无需列出其类名。
*   一种轻松执行 printfs 的静态实用程序方法。

虽然`"bla: %d".format("foo"),`通过将方法设为静态可以说您可以以对习惯使用`printf()`.

```
import static java.lang.String.format;

public class Demo {

   public void Test() {

      //Do some stuff

      format("Hey, this is easy to read!");

   }
 } 
```

这就是为什么！通过使用静态导入，printfs 看起来几乎和 C 中的一样。太棒了！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T04:46:49.067

主要原因可能是Java的设计者不想在String的接口上添加太多东西。使其成为成员函数意味着将其放在字符串上。请记住，非静态方法必须在 String 对象上。

第二个原因是静态格式与 C 的 printf 保持相似，看起来像 printf(FORMAT, ARG1, ARG2...)

另一个原因是格式重载：有一个版本将语言环境作为第一个参数（在字符串之前），因此在字符串对象上执行此操作会很棘手。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-27T04:57:12.163

"%02d".format(5) 看起来像 "%02d" 使用格式 5 而不是相反的格式。大多数字符串也不适合作为格式（“hello world”.format(5)？），因此该方法应该为大多数字符串对象抛出异常。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T05:08:25.473

答案由 Format 方法负责。

至少对我来说，说“格式字符串输入到格式方法”比说“格式对格式字符串进行操作”更合乎逻辑和直观。就是这样，因为我们“通常”将设计时已知的格式字符串传递给 Format。相反，对于 Trim，我们“通常”传递在设计时其值未知的变量字符串。

所以，将格式方法设为静态，让代码阅读更直观。看看下面的（C#）。

```
answer = String.Format("This is format string : {0}", someValue); 
//More readable to me

answer = "This is format string : {0}".Format(someValue); 
```

编辑：即使我使用了 C# 示例代码，它也适用于 Java。我获得了使用 C# 语法的 -ve 投票！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-17T11:28:52.490

我真的认为`format`必须是 String 的实例方法，所以也这样做

*   Python：

    ```
    2.6：打印“%s”%（“你好”）
    ```

    ```
    3.0：打印（“{0}”.format（“你好”））
    ```

*   斯卡拉：

    ```
    2.7.6: println("%s".format("你好"))
    ```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T20:40:29.853

调用 strfmt.format(objects) 而不是 String.format(strfmt, objects)

*   是面向对象的调用，而不是对静态助手的调用。
*   它的打字时间更短。
*   它更简单，因为它少了一个参数。
*   它更容易与代码完成一起使用。如果您从格式字符串开始并点击 . 您将 format() 作为 IDE 中的一个选项。
*   String.format(strfmt, objects) 可能被意外称为 strfmt.format(text, objects) ，它不会做它看起来做的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T06:31:02.890

我认为 Java 没有强制要求任何类似于其他任何东西的结构，即使是 C++。任何采用的东西都必须如此，因为开发人员接受它。此外，诸如“他们使它类似于其他东西”之类的论点并不能解释为什么他们不只是制作实例方法版本，而是使用原始包装器来做到这一点（除了实例 toString() 方法之外，它们还有静态版本）。

这就是我的想法：

在正常情况下，两种形式是等价的，但假设我们有类似的东西：

```
String invalidFormat = "%invalid"; // or something else that is invalid 
```

然后我们调用：

```
String.format(invalidFormat, anything);
// "anything" is indeed anything.... 
```

无效的成为参数，Java 通过抛出 IllegalArgumentException 的实例来澄清这一点（即使在 Formatter 的情况下，也有很多种）。

但是，在类似的情况下：

```
invalidFormat.format(anything); 
```

无效的不再是论据。现在的问题在于它被调用的实例，因此可能更好地描述为“无效状态”（而不是 Java 的“IllegalStateException”，它具有完全不同的用法）。但是因为字符串是不可变的，所以这个所谓的“状态”永远不会改变，所以它作为一种格式总是保持无效，即使它是一个有效的简单字符串。

将其与 java.lang.Long 进行比较。两个版本的 toString 都不会抛出任何异常，所以它们都是等价的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T04:49:56.237

可能表明它是为了方便而存在的“实用程序”函数，但它实际上并不是字符串的内在函数。也就是说，String`"%02d"`是一种表示格式的方式，但它实际上并不进行任何格式化。

该方法的存在是为了方便地格式化字符串，但[Formatter](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Formatter.html)（执行实际格式化）也可以格式化其他类型的对象（日期等）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-27T05:10:15.813

仅仅因为这个调用让人想起 C 的`sprintf`函数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-27T05:37:52.317

可能是因为 String 是不可变的，因此此方法必须创建并返回 String 实例的新实例。如果该方法未声明为静态的，您可能希望它修改调用它的 String 实例。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-03-12T07:06:28.823

```
answer = String.Format("This is format string : {0}", someValue); 
//More readable to me

answer = "This is format string : {0}".Format(someValue); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-10-13T02:07:48.837

只是糟糕的设计。蟒蛇发现它很痛苦。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-04-27T04:58:15.327

在 C# 中，[字符串是不可变的](http://msdn.microsoft.com/en-us/library/362314fe.aspx)。我认为这在 Java 中也是如此（对此不是 100% 确定）。因此，您不会通过对其调用格式方法来更改字符串，而只是返回带有格式的新字符串。这使它成为类级方法而不是实例级方法，因此它是静态的。您可以使用扩展函数在 C# 中添加实例级外观，但这只是静态函数之上的语法糖。

# asp.net - 带有 MVC 成员资格 (OpenID) 控制器的 ASP MVC 空引用异常

> ID：792267
> 
> 赞同：1
> 
> 时间：2009-04-27T04:46:39.317
> 
> 标签：asp.net, asp.net-mvc, asp.net-membership

我要提前道歉。我是 ASP.NET 和 MVC 的新手，还没有深入了解内部结构和操作流程。我正在尝试将[ASP.NET MVC Membershp Starter](http://mvcmembership.codeplex.com) Kit 集成到我正在开发的站点中以获得 OpenID 支持。

我已经解决了几个问题，但我不知道从哪里开始寻找我不断得到的空引用异常。这是流程：

1.  用户点击页面上的“登录”
2.  MVC MembershipAdministrationController 被正确触发。它检测到当前没有登录用户，因此使用登录表单 (Login.aspx) 进行响应。
3.  呈现此表单时引发空引用异常。具体来说，引发异常的部分是：

    ```
    <% using(Html.Form( "OpenID", "Login" )){ %>
      <fieldset class="MvcMembership">
        <legend>Login</legend>
        <div><label for="openid_identifier">OpenID Url:</label> <% =Html.TextBox( "openid_identifier" )%></div>
        <div><% =Html.SubmitButton( "submit", "Login", new { onclick = "return starterKit_mvc_membership_validateOpenIdLogin();" } )%></div>
      </fieldset>
    <% } %> 
    ```

对 Html.Form ("OpenID", "Login") 的调用是引发异常的调用。这是调用堆栈：

```
System.Web.HttpUnhandledException: Exception of type 'System.Web.HttpUnhandledException' was thrown. ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()
   at System.Web.Routing.ParsedRoute.Bind(RouteValueDictionary currentValues, RouteValueDictionary values, RouteValueDictionary defaultValues, RouteValueDictionary constraints)
   at System.Web.Routing.Route.GetVirtualPath(RequestContext requestContext, RouteValueDictionary values)
   at System.Web.Routing.RouteCollection.GetVirtualPath(RequestContext requestContext, RouteValueDictionary values)
   at Microsoft.Web.Mvc.FormExtensions.Form(HtmlHelper helper, String controllerName, String actionName, FormMethod method, IDictionary`2 htmlAttributes)
   at Microsoft.Web.Mvc.FormExtensions.Form(HtmlHelper helper, String controllerName, String actionName)
   at ASP.views_openid_login_aspx.__RenderopenIdLoginContent(HtmlTextWriter __w, Control parameterContainer) in d:\Data\Personal\purplemartin.tv\mvc\MvcMembership\Views\OpenID\Login.aspx:line 15
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)
   at System.Web.UI.Control.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)
   at ASP.views_shared_site_master.__Render__control1(HtmlTextWriter __w, Control parameterContainer) in d:\Data\Personal\purplemartin.tv\mvc\MvcMembership\Views\Shared\Site.Master:line 46
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)
   at System.Web.UI.Control.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)
   at System.Web.UI.Page.Render(HtmlTextWriter writer)
   at System.Web.Mvc.ViewPage.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   --- End of inner exception stack trace ---
   at System.Web.UI.Page.HandleError(Exception e)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at ASP.views_openid_login_aspx.ProcessRequest(HttpContext context) in c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\cada2385\9a6742fc\App_Web_zl9plrr2.1.cs:line 0
   at System.Web.Mvc.ViewPage.RenderView(ViewContext viewContext)
   at System.Web.Mvc.WebFormView.RenderViewPage(ViewContext context, ViewPage page)
   at System.Web.Mvc.WebFormView.Render(ViewContext viewContext, TextWriter writer)
   at System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<InvokeActionResultWithFilters>b__e()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
   at System.Web.Mvc.Controller.ExecuteCore()
   at System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)
   at System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext)
   at System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext)
   at System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext)
   at System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

根据要求，控制器如下所示：

```
 [HandleError( ExceptionType = typeof(OpenIdException) )]
    [HandleError( ExceptionType = typeof(System.Net.WebException) )]
    public virtual ActionResult Login( string openid_identifier )
    {
        //### set page title & declare variables
        ViewData["Title"] = "Login via OpenID";
        var errors = new List<string>();
        var rememberMe = false;
        var openid = new OpenIdRelyingParty();

        //### stage 1: display login form to user
        if( openid.Response == null && Request.HttpMethod != "POST" )
            return View(); 
```

显然，这不是完整的控制器，但这是第一次执行的所有内容（当呈现登录表单时）。第一次`openid.Response`为空，请求方法为`"POST"`.

我从哪里开始寻找问题？看起来它可能与路由有关，但我不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T13:47:57.310

由于我对这个问题的回应很少，我开始寻找将 OpenID 集成到 ASP.NET MVC 中的替代方案。我发现[RPXLib是](http://code.google.com/p/rpxlib/)[RPXNow](https://rpxnow.com/)的一个不错的 .NET 和 MVC 包装器。这是来自多个供应商的用于 OpenID 登录的 Web 服务方法。

这不是一个完美的解决方案，因为我必须编写 openid 凭据和本地配置文件之间的映射代码，但这足以满足我的需求。

我仍然有兴趣解决`Html.Form("controller", "action")`引发空引用异常的原始问题。我尝试使用具有相同结果的通用版本：`Html.Form<Controller>(c => c.Action())`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T10:02:08.870

您使用的是 ASP.NET MVC v1.0（不是 Preview、Beta 或 RC）吗？v1.0似乎没有Html.Form，只有Hrml.BeginForm。如果您查看 ASP.NET MVC v1.0 源代码，则在 System.Web.Mvc.Html.FormExtensions 类中没有 Form 方法，而只有 BeginForm

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T09:20:33.170

如果一切都失败了，您仍然可以下载[ASP.NET MVC 源代码](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=11833)，将其连接到您的项目并进行调试。这需要更多的努力，但它确实有助于弄清楚引擎盖下出了什么问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T17:51:15.987

西蒙，你的意思是'System.Web.Mvc.Html.FormExtensions'，而不是'Microsoft.Web.Mvc.FormExtensions'？有 'Microsoft.Web.Mvc.FormExtensions' 类 ( [http://aspnet.codeplex.com/SourceControl/changeset/view/22929#266407](http://aspnet.codeplex.com/SourceControl/changeset/view/22929#266407) ) 但没有 Form 方法。也许您使用的是旧版本的 Microsoft.Web.Mvc.dll ？在 Reflector 中打开您的 Microsoft.Web.Mvc.dll - 在我的机器上 Microsoft.Web.Mvc.dll 的版本为 1.0.0.0，有 4 种方法：

```
public static MvcForm BeginForm<TController>(this HtmlHelper helper, Expression<Action<TController>> action) where TController: Controller;
public static MvcForm BeginForm<TController>(this HtmlHelper helper, Expression<Action<TController>> action, FormMethod method) where TController: Controller;
public static MvcForm BeginForm<TController>(this HtmlHelper helper, Expression<Action<TController>> action, FormMethod method, IDictionary<string, object> htmlAttributes) where TController: Controller;
public static MvcForm BeginForm<TController>(this HtmlHelper helper, Expression<Action<TController>> action, FormMethod method, object htmlAttributes) where TController: Controller; 
```

声明类型：Microsoft.Web.Mvc.FormExtensions

程序集：Microsoft.Web.Mvc，版本=1.0.0.0

***更新：***

我已经下载了[ASP.Net MVC Membership Starter Kit Preview 5 (0.5)](http://mvcmembership.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=16809#DownloadId=42584)。bin 文件夹中的 Microsoft.Web.Mvc.dll 具有 1.0.0.0 版本，但它比 ASP.NET MVC v1.0 的 Microsoft.Web.Mvc.dll 旧。[您可以在那里](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471#DownloadId=61773)下载最新版本的 Microsoft.Web.Mvc.dll 。

# c# - ASP.NET 中的动态表单生成

> ID：792278
> 
> 赞同：8
> 
> 时间：2009-04-27T04:54:04.870
> 
> 标签：c#, asp.net, html, dynamic-data

我想从 ASP.NET 中的数据库动态生成表单，最好的方法是什么？我可以使用任何内置功能吗？

我将有数据库表来表示面板及其名称，然后对于每个面板，它包含不同的字段及其类型（组合、文本框等）。

请指教，谢谢。

注意：我必须使用 Telerik Ajax 控件来生成表单

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-27T04:56:59.417

看看[动态数据](http://www.asp.net/dynamicdata/)。

我最近发现了它，它已经为我节省了*很多*时间。

*更新：*

道歉 - 重读了这个问题，我认为这不是你所追求的。

如果要根据数据库中的记录动态生成表单，则可能必须编写自己的引擎。

不过有几点建议：

*   我会考虑使用反射来加载控件而不是大型案例语句。这样，您只需包含新程序集就可以动态添加不同的控件类型。您不必编写新代码。
*   确保包含一种方法来控制数据库中的显示顺序。我注意到您希望为每个控件面板使用不同的表格。由于显示顺序问题，我建议不要这样做。如果您有一个包含面板列表的表格和一个包含数据项列表的表格 + 对面板的外键引用，您将能够在页面上以可预测和可控的方式对它们进行排序。

*更新：有关反射的更多信息*

简而言之，反射是您在运行时发现程序集的详细信息。在这种情况下，我建议使用反射来根据数据库中的信息加载控件。

因此，如果您的数据库中有类似于以下内容的记录：

```
FieldName    DataType         DisplayControl                       DisplayProperty
----------------------------------------------------------------------------------
FirstName    System.String    System.Web.UI.WebControls.TextBox    Text 
```

您可以使用如下代码在页面上生成控件（请注意，它未经测试）：

```
// after getting the "PageItem" database records into a "pageItems" array
foreach (PageItem p in pageItems)
{
    // get the type and properties
    Type controlType = System.Type.GetType(p.DisplayControl)
    PropertyInfo[] controlPropertiesArray = controlType.GetProperties();

    // create the object
    object control = Activator.CreateInstance(controlType);

    // look for matching property
    foreach (PropertyInfo controlProperty in controlPropertiesArray)
    {
        if (controlPropertiesArray.Name == p.DisplayProperty)
        {
            // set the Control's property
            controlProperty.SetValue(control, "data for this item", null);
        }
    }

    // then generate the control on the page using LoadControl (sorry, lacking time to look that up) 
```

有一个非常好的页面概述了如何在[此处](http://msdn.microsoft.com/en-us/library/aa478957.aspx)执行此操作。它看起来几乎就是你所追求的。

# c# - WinForms 程序员的 WPF 是什么？

> ID：792279
> 
> 赞同：11
> 
> 时间：2009-04-27T04:54:21.687
> 
> 标签：c#, .net, wpf, winforms

什么是 WinForms 程序员的 WPF？

WinForms 的提炼是向表单添加控件，并添加事件处理程序。这简单易行，允许您快速制作功能性 GUI。

另一方面，WPF 是 XAML (?) + Code (?)，这似乎是一种更复杂的方式来缓慢地制作更漂亮的 UI。

关于 WPF 方面有很多现有的 SO 问题，但我正在寻找关于如何理解它的两句话。我应该只专注于学习 XAML 吗？还是通过直接访问类和编写代码（如 Winforms）来编写真正的 WPF？

另外，像我这样的 WinForms 程序员会从使用 WPF 中看到什么实际好处？3D 图形、文本的任意缩放以及应用程序的自定义“皮肤”都不是有效的答案。WPF 提供什么用于跟踪运输订单的应用程序。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T05:30:40.150

WPF 带来

*   **声明式 UI 编程**：UI (XAML) 的呈现或外观已与代码（.cs 等）分离，因此 XAML 可以由擅长此类事情的人（图形设计师）独立创建。然后，他们将完成的外观提交给只编写代码以使其工作的开发人员。（更简单的东西可以直接在 XAML 中再次处理）旨在为您提供更大的并行性和良好的 UX（相对于开发人员认可的 UI）
*   **数据绑定**：再次声明式的倾向。您声明式指定此 UI 控件呈现的模型属性，WPF 负责将数据拉入控件并更新修改后的内容以及更改通知。
*   改进**的复合控制模型**- 您现在可以在任何东西中嵌入几乎任何东西，所以现在想象力没有界限。
*   数据模板、控制模板等 - 再次将 UI 与代码分离。这些 XAML 模板指定（**一次**）数据结构或 UI 控件在用户眼中的外观。
*   **更擅长 X**：当然，MS 在许多其他方面进行了改进，例如渲染（比 GDI 更新更少）、缩放（分辨率独立性）、透明度、布局（非绝对）、文本渲染、动画和视频支持、改进的事件模型、等。全部
*   **样式、触发器**：使用一体式样式（再次是 XAML）更容易在全局范围内应用统一的外观。触发器是在某些事件发生时执行的代码块，例如“此控件的文本已更改......所以现在将其前景属性更新为蓝色以表示“已修改”。简单的事情可以直接在 XAML 中完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T01:54:34.757

在过去的 4 年里，我几乎只在 WinForms 中工作，并且已经开始将 WPF 用于工作中的几个小项目。学习曲线陡峭。但是一旦你习惯了它，它是非常值得的。

WPF 不仅仅是像蒙皮或动画这样的视觉效果。即使对于跟踪运输订单的基本应用程序，您也可以利用 WPF。WinForms 的控件只带您到此为止。如果您想显示稍微自定义的 UI，您通常需要使用 GDI 在控件中进行自定义绘制，这很快就会成为一场噩梦。在 WPF 中，通过数据模板自定义任何东西都是微不足道的。您可以轻松自定义列表框元素，向列表视图列或标题添加控件等。WPF 允许您通过其强大的布局系统控制复杂的 UI 布局。我也很惊讶在 WPF 中只需要很少的代码来完成我以前在 WinForms 中所做的事情，因此这意味着更少的错误和更容易维护应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T05:02:24.193

我想一种看待它的方法是考虑 HTML + CSS 网页。我们有 HTML，这很棒，除了所有东西都混杂在一起。人们意识到，使用 CSS，您可以将文档的*结构*与其*表示*分离。XAML 做同样的事情，或者至少允许并鼓励这样做。

至于实际好处，请浏览 MSDN 示例。我倾向于认为 WPF 更适合所谓的“富媒体”，具有更复杂的元素。您跟踪运输订单的应用程序示例不是一个好的应用程序，特别是因为其中许多系统仍在基于 DOS 的界面中运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T05:01:27.987

Visual Studio 2008 包含一个 WPF 设计器。

这个视频可能很有趣：[在 Visual Studio 2008 中创建 C# WPF 应用程序](http://windowsclient.net/learn/video.aspx?v=6889)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T05:03:58.590

WPF 应用程序的 XAML 部分模糊地替代了 WinForms 中的 WinForm.Designer.cs 文件。

WPF 模型对 UI 和单个控件进行了更好的设计，修复了 WinForms 的许多缺点，并指导您（希望）更好地进行关注点分离设计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T05:16:24.473

WPF 应该是每个 WinForms 程序员的梦想：它不是在程序上做每件小事，而是让您说出控件是什么、放置它们的位置、它们的外观，以及在某种程度上甚至它们在 XAML 中的行为方式，同时让您自定义“背后的代码”中的行为。哦，由于 XAML 的声明性，设计器现在可以为您做更多的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T08:02:31.423

一开始我发现 XAML 也有点复杂，但是一旦我习惯了它，我发现它非常简单（一旦你知道了基本的控件）。关于它的最好的事情之一是数据绑定。

通常，当我编写 WPF 应用程序时，我会将它用于 UI 上的几乎所有内容。将控件绑定到视图模型的命令和属性可以将演示与设计完全分开，我的代码隐藏中通常没有一行代码。这使我的 ViewModel/业务逻辑对象易于测试，并且完全独立于任何可视化表示，而可视化表示又可以轻松替换。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-05T06:24:35.620

在这里，我试图以非常简单的天真术语回答初学者/winforms 开发人员面临的一些 WPF 问题以及我开始使用 WPF 时遇到的一些问题。互联网上有很多文章和教程提供了足够的知识，但是很难找到非常简单的问题的答案。我试图在这里解决它。

**什么是 WPF？**

随着扩展的进行，Windows Presentation Foundation；它是一个用于构建 Windows 应用程序的“演示”系统。如果您是 Winforms 开发人员，您会发现 WPF 的主要区别在于设计器的外观。与 winform 不同，设计器代码不是 C# 代码，而是 XAML 代码。

**为什么是 WPF？**

嗯，WPF 优于 winforms 的主要原因是 WPF 提供了丰富的 UI。除此之外，WPF 还提供了许多其他好处，它在互联网上的许多教程中更清楚地提供。它是一个基于矢量的渲染引擎。如果仅比较 winform 应用程序和 WPF 应用程序的 UI，外观和感觉方面的差异将非常明显。

**什么是 MVVM？**

MVVM 是一种模式，在开发应用程序时进行调整。它被扩展为“模型视图视图模型”，基本上在构建项目时，我们有一个模型文件夹，所有模型文件（.cs）都将放在该文件夹下，在视图模型文件夹下，所有视图模型文件（.cs）将是放置在视图文件夹下，所有视图文件（.xaml）都将被放置。如果使用 MVVM，那么后面不会有任何代码，这意味着 .xaml.cs 文件除了自动创建的方法之外没有任何代码。

**模型**：模型具有支持视图模型的业务逻辑部分，其数据最终将呈现在视图中。

**ViewModel**：每个视图都有一个视图模型。Viewmodel 将实现 INotifyPropertyChanged 接口，并具有绑定到相应视图的所有属性。视图模型没有加载任何业务逻辑，责任在于模型。

**视图**：视图不过是设计窗口的 xaml 文件。XAML 是一种标记语言。在 WPF 中，与 winform 不同，每个控件都将与预定义或用户定义的依赖属性绑定。

**为什么选择 MVVM？**

每当在 WPF 中开发应用程序时，MVVM 都会派上用场。使用 MVVM 的最大优势之一是它可以进行独立于 UI 的单元测试，因为在单元测试期间没有代码背后，不需要与 UI 相关的对象，因此 100% 的代码覆盖率是可能的。在单元测试中，用户可以传递“命令”（在 wpf 中查找命令）来测试特定的用例。

**使用 WPF 时使用 MVVM 是强制要求还是绝对必要？**

我会说不，在使用 WPF 时不一定要使用 MVVM，但这取决于要求。必须研究 MVVM 提供的优势，然后决定是否使用它。MVVM 在开发的最初几天增加了复杂性，但最终它带来了好处。如果完整的应用程序是winforms，而WPF中只开发了一个小模块而不是一个小功能，那么就没有必要遵循MVVM，可以愉快地拥有代码并获得丰富的UI体验。我再重复一遍，这完全取决于需求的类型。

**我可以有多个视图模型到一个视图/多个视图到一个视图模型吗？**

这是一个我在任何 .net 社区都没有得到明确答案的问题。首先，我们看到使用 MVVM 的主要目的是实现 100% 的代码覆盖率，这表明我们将独立测试每个视图模型，因此测试了一个完整的表单。考虑到这一点，最好采用一种视图一种视图模型的方法。如果有必要，我们总是可以通过使用 MVVM Light messenger 或任何其他促进它的方式在视图模型之间进行通信。

**视图模型和模型有什么区别？**

这是初学者总是会问的一个问题，因为他们发现两者之间没有太大区别。区别在于：- 模型只不过是一个具有修改数据的数据方法的类，它将在视图模型中使用并最终绑定到视图。ViewModel 仅具有将绑定到视图的属性。在 get 或 set 方法中，可以调用模型中的方法来获取数据。同样，此模型适用于此特定视图模型。现在您可以决定是否真的需要模型类，如果没有繁重的业务逻辑，那么您可以避免使用模型类并将其放置在视图模型中，但更清洁的方法是使用模型类。

**在 MVVM 中，我可以跳过视图模型或视图模型类吗？**

再次取决于前面提到的需求，如果没有繁重的业务逻辑，那么您可以避免使用模型类并将其放置在视图模型中，但更简洁的方法是使用模型类。

# php - PHP 和源代码控制：在哪里放置单元测试等？

> ID：792281
> 
> 赞同：1
> 
> 时间：2009-04-27T04:55:38.733
> 
> 标签：php, unit-testing, version-control, bazaar

我正在使用 Bazaar 进行版本控制，对此我很满意。在 Bazaar 中，源代码控制中的每个树/项目都称为“分支”。

目前，我有一个用于实际应用程序的“主”分支和一个“开发”分支，其中包含单元测试以及用户手册等内容。这样，应用程序及其相关测试都是版本化的，但是分别地。

但是，我怀疑我这样做的方式不是最好的方式。例如，如果我要从那个“主”分支创建发布分支，那么这些发布分支将与单元测试不同步，除非我以相同的方式分支它们。

目前，为了创建应用程序的快照，我只是从该主分支导出所有文件并将它们压缩，因为该分支的树中没有任何内容不属于将发送给客户端的应用程序的一部分。

有什么更好的方法来做我正在做的事情？单元测试是否应该进入与应用程序相同的“主”分支，如果是这样，有什么方便的方法可以轻松创建“快照”，即相当于“每日构建”，仅包含将分发的文件应用程序？

*谢谢大家的答案。很难决定接受谁的回答。我采用的解决方案是将测试放在主树的“测试”子目录中；如果我不想分发测试，我可以稍后轻松地将其删除。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T05:01:05.633

你肯定希望你的单元测试和代码尽可能地接近。我们遵循的过程是这样的：

```
libs/Core/Login.php
libs/Core/Process.php
libs/Core/t/LoginTest.php
libs/Core/t/ProcessTest.php 
```

基本上，为代码的每个部分创建一个单元测试模块，并将其与实际代码分开，将其保存在子目录中。然后进行一些检查，找到所有单元测试代码并在投入生产之前运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T05:03:44.707

我会将主要代码和测试放在一个分支中，然后在打包之前删除您认为多余的任何内容。

我认为让您的测试与主要开发工作不同步的风险将抵消编写脚本所需的努力，该脚本将在交付给客户之前清除您不希望包含的文件。仅仅因为 Bazaar 允许许多简单的分支并不意味着你想让你的测试离代码太远。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T05:51:00.340

As mentioned by others, tests belong to a specific branch. If one of your code branches is slightly different, it's tests should also probably match that..

# c# - 使用 nHibernate 序列化 DetachedCriteria

> ID：792289
> 
> 赞同：3
> 
> 时间：2009-04-27T05:00:30.127
> 
> 标签：c#, nhibernate, serialization

我正在尝试序列化 DetachedCriteria，以便可以将其保存在数据库中并在以后重用相同的标准。当我运行下面的代码时，我得到“NHibernate.Criterion.DetachedCriteria 无法序列化，因为它没有无参数构造函数”。

```
DetachedCriteria criteria1 = DetachedCriteria.For<SecurityObjectDTO>("so")
    .Add(Expression.Eq("ObjectCode", "1234"));

XmlSerializer s = new XmlSerializer(typeof(DetachedCriteria));
TextWriter writer = new StringWriter();
s.Serialize(writer, criteria1);
writer.Close(); 
```

有什么好方法可以序列化 DetachedCriteria 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-09T16:18:07.007

我以前遇到过类似的事情。我的第一个想法是子类化`DetachedCriteria`，这样你就可以自己提供一个默认构造函数。但是，在深入研究`DetachedCriteria`课程之后，我认为这行不通。原因是`CriteriaImpl`内部使用的类`DetachedCriteria`也缺少默认构造函数。

查看 XmlSerializer，如果您的对象没有默认构造函数，它看起来不会起作用。

但是，我遇到了这篇文章：

[如何序列化 NHibernate DetachedCriteria 对象？](https://stackoverflow.com/questions/1245985/how-do-i-serialize-an-nhibernate-detachedcriteria-object)

基于此，这可能有效（但是我没有测试过）：

```
// Convert the DetachedCriteria to a byte array
MemoryStream ms = new MemoryStream();
IFormatter formatter = new BinaryFormatter();
formatter.Serialize(ms, detachedCriteria);

// Serialize the byte array
XmlSerializer s = new XmlSerializer(typeof(byte[]));
TextWriter writer = new StringWriter();
s.Serialize(writer, ms.Buffer);
writer.Close(); 
```

# sql - 如何在 SQL 中获取字符串的第一个字符？

> ID：792294
> 
> 赞同：321
> 
> 时间：2009-04-27T05:02:48.170
> 
> 标签：sql, sql-server, sql-server-2005

我有一个长度为 6 的 SQL 列。现在只想取该列的第一个字符。SQL中是否有任何字符串函数可以做到这一点？

* * *

## 回答 #1

> 赞同：522
> 
> 时间：2009-04-27T05:07:21.140

`LEFT(colName, 1)`也会这样做，也。它相当于`SUBSTRING(colName, 1, 1)`.

我喜欢`LEFT`，因为我觉得它更干净一些，但实际上，这两种方式都没有区别。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-04-27T14:37:29.007

我更喜欢：

```
SUBSTRING (my_column, 1, 1) 
```

因为它是标准 SQL-92 语法，因此更便携。

* * *

严格来说，标准版是

```
SUBSTRING (my_column FROM 1 FOR 1) 
```

关键是，从一个转换到另一个，因此转换为任何类似的供应商变体，都是微不足道的。

ps 直到最近才向我指出，标准 SQL 中的函数是故意相反的，通过使用不是传统的 commalist 的参数列表，以便使它们易于识别为来自标准！

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-27T05:08:58.687

`SUBSTRING ( MyColumn, 1 , 1 )`对于第一个字符和`SUBSTRING ( MyColumn, 1 , 2 )`前两个字符。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-11-19T19:56:58.543

```
SELECT SUBSTR(thatColumn, 1, 1) As NewColumn from student 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-07-19T07:56:39.860

通过以下方式很容易实现

```
DECLARE @SomeString NVARCHAR(20) = 'This is some string'
DECLARE @Result NVARCHAR(20) 
```

任何一个

```
SET @Result = SUBSTRING(@SomeString, 2, 3)
SELECT @Result 
```

`@Result = his`

或者

```
SET @Result = LEFT(@SomeString, 6)
SELECT @Result 
```

`@Result = This i`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-03-07T14:07:49.790

如果在 Sql 字符串中搜索字符串的第一个字符

```
SELECT CHARINDEX('char', 'my char')

=> return 4 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-19T06:40:33.570

输入

```
STRMIDDLENAME
--------------
Aravind Chaterjee
Shivakumar
Robin Van Parsee

SELECT STRMIDDLENAME, 
CASE WHEN INSTR(STRMIDDLENAME,' ',1,2) != 0 THEN SUBSTR(STRMIDDLENAME,1,1) || SUBSTR(STRMIDDLENAME,INSTR(STRMIDDLENAME,' ',1,1)+1,1)||
SUBSTR(STRMIDDLENAME,INSTR(STRMIDDLENAME,' ',1,2)+1,1)
WHEN INSTR(STRMIDDLENAME,' ',1,1) != 0 THEN SUBSTR(STRMIDDLENAME,1,1) || SUBSTR(STRMIDDLENAME,INSTR(STRMIDDLENAME,' ',1,1)+1,1)
ELSE SUBSTR(STRMIDDLENAME,1,1)
END AS FIRSTLETTERS
FROM Dual;

OUTPUT
STRMIDDLENAME                    FIRSTLETTERS
---------                        -----------------
Aravind Chaterjee                AC           
Shivakumar                       S
Robin Van Parsee                 RVP 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-04-20T12:18:51.680

选择所选字段中的前两个字符`Left(string,Number of Char in int)`

```
SELECT LEFT(FName, 2) AS FirstName FROM dbo.NameMaster 
```

# c# - WCF Silverlight HTTP 和 HTTPS

> ID：792299
> 
> 赞同：2
> 
> 时间：2009-04-27T05:05:01.880
> 
> 标签：c#, silverlight, wcf

我有一个 Silverlight 应用程序，我想从 https 或 http 调用它。我已经让它与一个或另一个一起工作，但在使它与两者一起工作时遇到问题（使用单个 web.config）

我在 silverlight.net 论坛上找到了一个帖子，显示了他们是如何做到的，但它对我不起作用。[http://silverlight.net/forums/t/13275.aspx](http://silverlight.net/forums/t/13275.aspx)（标为答案的帖子）

我错过了什么吗？

如果我浏览到服务的 https url，它会给我 mex 描述页面，但是如果我浏览到我得到的服务的 http 站点；

“找不到与具有绑定 BasicHttpBinding 的端点的方案 https 匹配的基地址。注册的基地址方案是 [http]。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T06:04:56.890

如果您甚至无法通过 http 看到服务，那么这就解释了 Silverlight 无法连接到 http 服务的原因。

确保在您的服务中定义了 HTTP 和 HTTPS 端点。如果可能，为您的服务发布 .config 文件可能会有所帮助。

这是一个相关的 SO 问题[，服务可以有多个端点吗？](https://stackoverflow.com/questions/46283/can-a-service-have-multiple-endpoints)

如果您可以通过浏览器看到 http 和 https 的服务描述，那么您可以尝试让 Silverlight 连接到任一服务。

# search - 个人知识库文件的搜索索引工具

> ID：792303
> 
> 赞同：1
> 
> 时间：2009-04-27T05:08:18.610
> 
> 标签：search, information-retrieval

我有大量的基本文本、rtf、html、pdf 和 chm 文件存储在 USB 密钥中作为个人知识库。

到目前为止，为了检索信息，我使用了标准的文件搜索工具（Windows 搜索、grep 等）。然而如今，由于数据量庞大，蛮力搜索可能需要几分钟时间。PDF 和 CHM 也更难搜索。

因此，我正在寻找一种在这种情况下运行良好的文本索引工具。我想避免对 RDBMS（即 SQL Server、MySQL）的依赖，因为我会在许多不同的计算机上使用它并且不希望安装麻烦。便携式工具将是理想的。在某些机器上，我也经常无法访问互联网。

提供一个简单的 GUI 允许查询输入和快速访问结果的东西会很棒。

我考虑过自己写这篇文章，但是我现在有时间做更多的工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T05:11:30.740

[Google 桌面](http://desktop.google.com/)会为您建立索引，[Windows 桌面搜索](http://www.microsoft.com/windows/products/winfamily/desktopsearch/default.mspx)（在 Windows 中）也是如此。 [Beagle](http://beagle-project.org/Main_Page)是一款出色的 Linux 搜索工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T05:58:14.200

如果您喜欢修补匠，我会使用 Lucene - 纯 Java 版本或获取[https://lucene.apache.org/](https://lucene.apache.org/)的副本。
这是一个全文索引器和搜索库，非常适合运行 USB。

# python - 导航可调用迭代器

> ID：792304
> 
> 赞同：4
> 
> 时间：2009-04-27T05:08:21.653
> 
> 标签：python

我想使用正则表达式从一些聊天日志中提取信息。被解析的字符串的格式是`03:22:32 PM <b>blcArmadillo</b>`. 我使用 python type() 命令发现变量 messages 是一个可调用迭代器。我的问题是如何最有效地浏览可调用迭代器？它们是否像您可以只使用索引的数组？我能找到“提取”数据的唯一方法是遍历返回的值并将它们添加到列表中，如下面的代码片段所示。

```
times = []
messages = re.compile(r'(?P<time>..:..:.. ..).*?<b>(?P<usrname>.*?):</b>').finditer(search)

for result in messages:
    times.append(result.group('time')) 
```

有没有更好更有效的方法来做到这一点？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T05:19:33.623

迭代器只是一个带有 next 方法的对象。每次调用它时，它都会返回集合中的下一项。如果您需要访问任意索引，则几乎必须将其转换为列表。而不是这个：

```
for result in messages:
    times.append(result.group('time')) 
```

你可以这样说：

```
times = [result.group('time') for result in messages] 
```

这几乎是同样的事情。但是，我应该警告您，对大型结果集执行此操作会非常慢并且会占用大量内存。因此，如果您不需要随机访问，则不应这样做。如果不受信任的用户输入的数据将决定显示多少结果，您可能还希望限制他们可以输入的内容数量。

**编辑**：我刚刚注意到我之前的答案与您发布的片段不太一样，所以我已经更新了它。

# sql - 列中出现次数最多的 TSQL 返回 Guid

> ID：792310
> 
> 赞同：0
> 
> 时间：2009-04-27T05:11:21.927
> 
> 标签：sql, tsql

如果我有一个包含两列的表，例如名称和 ID，其中 ID 是 GUID，我如何从第 2 列返回出现次数最多的 Guid 值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T05:15:36.223

未经测试：

```
SELECT TOP 1 ID, COUNT(*) AS CountOfRows
FROM UnknownTable
GROUP BY ID
ORDER BY CountOfRows DESC 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T05:13:27.490

```
SELECT TOP 1 ID, COUNT(ID) AS count
FROM IDTable
GROUP BY ID
ORDER BY count DESC 
```

# mysql - Plesk 上的单个 MySQL 数据库用户名

> ID：792313
> 
> 赞同：-1
> 
> 时间：2009-04-27T05:12:48.583
> 
> 标签：mysql, plesk

我的系统管理员让我使用 Plesk 在服务器上工作，这要求我为我创建的每个 MySQL 数据库拥有一个唯一的用户名/密码。这很烦人，有人知道如何创建通用用户名登录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T05:21:25.630

**2014 年 1 月 10 日更新**Plesk 11.5 具有以下功能： ![在此处输入图像描述](https://i.stack.imgur.com/NW5vH.png)

这可能很烦人，但这是为了更好的安全性。通用用户名和登录名可能更容易记住但不安全。如果您的系统管理员已经完成，那么它是有原因的。

请通常允许您分别创建用户名和数据库。所以你可以为多个数据库使用相同的用户名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:06:29.070

使用[GRANT](http://dev.mysql.com/doc/refman/5.1/en/grant.html)语法，您可以让单个 MySQL 用户帐户访问任意数量的数据库，如果您愿意，可以使用相同的密码。

```
GRANT ALL ON mydb.* TO 'user'@'localhost' IDENTIFIED BY 'password';
GRANT ALL ON mydbtwo.* TO 'user'@'localhost' IDENTIFIED BY 'password'; 
```

如果您想创建一个始终可以访问所有数据库的用户，非常类似于 root 用户，您可以使用如下语法：

```
GRANT ALL ON *.* TO 'someuser'@'somehost' IDENTIFIED BY 'password'; 
```

不建议跨项目共享相同的用户名和密码，但您绝对可以这样做。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-03T18:18:29.067

除了通过 GRANT ALL 实际授予用户权限外，您还需要向`db_users`Plesk 数据库中的表添加一条记录。使用 shell 查看所有数据库，我发现 plesk 数据库名为`psa`. 查找 accountid from`accounts`和 dbid from`data_bases`

```
INSERT into db_users VALUES('','username','accountid','dbid'); 
```

# linq - 如何在列表中查找重复项 快速，并更新原始集合

> ID：792333
> 
> 赞同：5
> 
> 时间：2009-04-27T05:29:35.190
> 
> 标签：linq, generics, sorting

首先让我说我已经阅读了这些问题：[1](https://stackoverflow.com/questions/223400/checking-for-duplicates-in-a-complex-object-using-linq-or-lamda-expression) & [2](https://stackoverflow.com/questions/454601/how-to-count-duplicates-in-list-with-linq)，并且我知道我可以编写代码来查找列表中的重复项，但我的问题是我想更新原始列表而不仅仅是查询和打印重复项.

我知道我无法更新查询返回的集合，因为它不是视图，而是匿名类型`IEnumerable<T>`。

我希望能够在我的列表中找到重复项，并标记我创建的名为的属性，该属性`State`稍后将在应用程序中使用。

有没有人遇到过这个问题，你能指出我正确的方向吗？

ps 我使用 ATM 的方法是冒泡排序类型的循环，逐项遍历列表并比较关键字段。显然这不是最快的方法。

编辑：

为了将列表中的项目视为“重复”，必须匹配三个字段。我们称它们为 Field1、Field2 和 Field3

我在比较这些字段的基类上有一个重载的 Equals() 方法。

我在我的`MarkDuplicates()`方法中跳过一个对象的唯一一次是对象状态是否为`UNKNOWN`or `ERROR`，否则我测试它。

如果您需要更多详细信息，请告诉我。

再次感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T05:46:31.343

我认为最简单的方法是从编写一个扩展方法开始，该方法在对象列表中查找重复项。由于您是对象，因此可以使用 .Equals() 在最常见的集合中进行比较。

```
public static IEnumerable<T> FindDuplicates<T>(this IEnumerable<T> enumerable) {
  var hashset = new HashSet<T>();
  foreach ( var cur in enumerable ) { 
    if ( !hashset.Add(cur) ) {
      yield return cur;
    }
  }
} 
```

现在应该很容易更新您的收藏以查找重复项。例如

```
List<SomeType> list = GetTheList();
list
  .FindDuplicates()
  .ToList()
  .ForEach(x => x.State = "DUPLICATE"); 
```

如果您已经在代码中定义了 ForEach 扩展方法，则可以避免使用 .ToList。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T05:34:30.403

您的对象具有某种状态属性。您可能会根据另一个属性或一组属性来查找重复项。为什么不：

```
List<obj> keys = new List<object>();

foreach (MyObject obj in myList)
{
    if (keys.Contains(obj.keyProperty))
        obj.state = "something indicating a duplicate here";
    else
        keys.add(obj.keyProperty)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T05:51:32.250

```
IEnumerable<T> oldList;
IEnumerable<T> list;

foreach (var n in oldList.Intersect(list))
   n.State = "Duplicate"; 
```

编辑：我需要 lrn2read。此代码适用于 2 个列表。我的错。

# php - 如何防止 PHP 的 DOMDocument 编码 html 实体？

> ID：792345
> 
> 赞同：8
> 
> 时间：2009-04-27T05:38:57.943
> 
> 标签：php, anchor, href, domdocument, createtextnode

我有一个使用 PHP 的 DOMDocument 替换字符串中锚点的 href 属性的函数。这是一个片段：

```
$doc        = new DOMDocument('1.0', 'UTF-8');
$doc->loadHTML($text);
$anchors    = $doc->getElementsByTagName('a');

foreach($anchors as $a) {
    $a->setAttribute('href', 'http://google.com');
}

return $doc->saveHTML(); 
```

问题是 loadHTML($text) 在 doctype、html、body 等标签中包围了 $text。我尝试通过这样做而不是 loadHTML() 来解决这个问题：

```
$doc        = new DOMDocument('1.0', 'UTF-8');
$node       = $doc->createTextNode($text);
$doc->appendChild($node);
... 
```

不幸的是，这对所有实体（包括锚）进行了编码。有谁知道如何关闭这个？我已经彻底查看了文档并尝试破解它，但无法弄清楚。

谢谢！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T19:18:16.430

> $text 是带有占位符锚标记的翻译字符串

如果这些占位符具有严格的、明确定义的格式，则简单的[preg_replace](http://de.php.net/preg_replace)或[preg_replace_callback](http://de.php.net/preg_replace)可能会解决问题。
我一般不建议用正则表达式摆弄 html 文档，但对于一个定义明确的小子集，它们是合适的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T09:35:52.587

XML 只有[很少的预定义实体](http://www.w3.org/TR/2006/REC-xml11-20060816/#sec-predefined-ent)。您所有的 html 实体都在其他地方定义。当您使用 loadhtml() 时，这些实体定义会自动加载，而使用 loadxml()（或根本没有 load()）则不会。
createTextNode() 完全符合其名称的含义。您作为值传递的所有内容都被视为文本内容，而不是标记。即，如果您将具有特殊含义的内容传递给标记（<、>、...），它的编码方式是解析器可以将文本与实际标记（<、>、...）区分开来

$text 是从哪里来的？您不能在实际的 html 文档中进行替换吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T17:54:43.183

我最终以一种脆弱的方式破解了这个，改变了：

```
return $doc->saveHTML(); 
```

进入：

```
$text       = $doc->saveHTML();
return mb_substr($text, 122, -19); 
```

这消除了所有不必要的垃圾，改变了这一点：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" 
"http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body><p>
You can <a href="http://www.google.com">click here</a> to visit Google.</p>
</body></html> 
```

进入这个：

```
You can <a href="http://www.google.com">click here</a> to visit Google. 
```

任何人都可以找出更好的东西吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-27T21:52:43.393

好的，这是我最终得到的最终解决方案。决定接受 VolkerK 的建议。

```
public static function ReplaceAnchors($text, array $attributeSets)
{
    $expression = '/(<a)([\s\w\d:\/=_&\[\]\+%".?])*(>)/';

    if (empty($attributeSets) || !is_array($attributeSets)) {
        // no attributes to set. Set href="#".
        return preg_replace($expression, '$1 href="#"$3', $text);
    }

    $attributeStrs  = array();
    foreach ($attributeSets as $attributeKeyVal) {
        // loop thru attributes and set the anchor
        $attributePairs = array();
        foreach ($attributeKeyVal as $name => $value) {
            if (!is_string($value) && !is_int($value)) {
                continue; // skip
            }

            $name               = htmlspecialchars($name);
            $value              = htmlspecialchars($value);
            $attributePairs[]   = "$name=\"$value\"";
        }
        $attributeStrs[]    = implode(' ', $attributePairs);
    }

    $i      = -1;
    $pieces = preg_split($expression, $text);
    foreach ($pieces as &$piece) {
        if ($i === -1) {
            // skip the first token
            ++$i;
            continue;
        }

        // figure out which attribute string to use
        if (isset($attributeStrs[$i])) {
            // pick the parallel attribute string
            $attributeStr   = $attributeStrs[$i];
        } else {
            // pick the last attribute string if we don't have enough
            $attributeStr   = $attributeStrs[count($attributeStrs) - 1];
        }

        // build a opening new anchor for this token.
        $piece  = '<a '.$attributeStr.'>'.preg_replace($expression, '$1 href="#"$3', $piece);
        ++$i;
    }

    return implode('', $pieces); 
```

这允许人们使用一组不同的锚属性调用该函数。

# apache-flex - 像 Flex 中的通知一样咆哮

> ID：792347
> 
> 赞同：2
> 
> 时间：2009-04-27T05:40:20.530
> 
> 标签：apache-flex, actionscript-3, growl, notice

有没有人听说过在 flex 应用程序中实现这种效果的库？

否则它只是一个带有一些蒙皮、褪色效果和计时器的简单面板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-13T20:34:50.097

我为 Web 应用程序编写了一个 Flex 4 通知框架。你可以在这里查看[http://www.blog.tylerchesley.org/2009/08/08/bark-growl-like-notifications-for-flex/](http://www.blog.tylerchesley.org/2009/08/08/bark-growl-like-notifications-for-flex/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T12:05:38.140

这个[flex 组件](http://lukesh.wordpress.com/2009/04/04/rawr-flexgrowl-component-available/)对于类似通知的 flex 咆哮看起来不错

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T22:19:10.660

如果您想在 AS3 中的 Mac 上获得真正的 Growl 通知，请查看[as3growl](http://code.google.com/p/as3growl/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T12:41:45.010

我自己没有尝试过，但是有一个 as3 库可以做你想做的事情，叫做[as3notificationlib](http://code.google.com/p/as3notificationlib/)。它应该在 Windows 上为您提供系统托盘“弹出窗口”，并像 Mac OS X 上的通知一样咆哮，不知道它在 Linux 上做了什么。

# visual-studio - C# 2008 Express：此版本的应用程序不支持项目类型 (.csproj)

> ID：792351
> 
> 赞同：5
> 
> 时间：2009-04-27T05:41:37.220
> 
> 标签：visual-studio

我一直在尝试浏览[CodePlex](http://www.codeplex.com/)上的一些项目，以了解其他人如何设计他们的应用程序。尝试在 C# 2008 Express 中打开这些项目时遇到了一些麻烦。当我打开解决方案或 csproj 文件时，我遇到了以下错误消息：

> 无法打开“Foo.csproj”，因为此版本的应用程序不支持其项目类型 (.csproj)。
> 
> 要打开它，请使用支持此类项目的版本。

当我打开自己创建的项目时不会发生这种情况。当外部项目采用该格式时，它们甚至会从 2005 年自动转换，但在尝试打开转换后的文件时会卡住。

这是对 Express 版本的限制，还是我可以做些什么来解决这个问题？

我尝试用谷歌搜索，但我发现的结果没有什么帮助。

谢谢！

**更新：**
@JaredPar 询问了我打开时遇到困难的具体项目。
众所周知的“压倒骆驼的稻草”被称为[Continuum](http://continuum.codeplex.com/)，但我在 CodePlex 上的其他项目以及 Paint.NET 源代码中也遇到了困难。

我已经尝试卸载并重新安装，但问题仍然存在。

@brianpeiris 要求我的安装规格：

**Visual Studio**
Microsoft Visual Studio 2008
版本 9.0.30729.1 SP
Microsoft .NET Framework
版本 3.5 SP1

安装版：C# Express

Microsoft Visual C# 2008 91910-152-0000061-60196
Microsoft Visual C# 2008 Express Edition SP1 的修补程序 - ENU (KB945282) KB945282
Microsoft Visual C# 2008 Express Edition SP1 的修补程序 - ENU (KB946040) KB946040
Microsoft Visual C# 2008 Express 的修补程序带有 SP1 的版本 - ENU (KB946308) KB946308 带有 SP1
的 Microsoft Visual C# 2008 速成版的
修补程序 - ENU (KB947540) KB947540 带有 SP1 的 Microsoft Visual C# 2008 速成版的修补程序 - ENU (KB947789) KB947789

**系统**
系统：
Microsoft Windows XP
Professional
Version 2002
Service Pack 2

**计算机**
AMD Turion(tm) 64 X2 Mobile
Technology TL-50
1.60 GHz，1.75 GB RAM
物理地址扩展

另外，我应该注意我已经尝试重新安装 VS，但没有成功。我还安装了 Web Developer Express，虽然我可以从那里打开并运行该项目，但 C# 仍然令人沮丧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T01:56:34.333

Continuum 项目的代码库并不太大。尝试在 Visual C# Express 中创建一个新项目并手动导入代码。在成功构建之前，您可能还必须添加一些引用。

**编辑：**

我刚刚用 Continuum 项目做到了这一点。

# 这是我的过程：

*   下载并解压 Continuum-1.1.1-Source.zip
*   删除 Continuum.sln 和 Continuum.csproj
*   在 Visual C# Express 中创建一个名为 Continuum 的新 Windows 窗体项目
*   删除默认的 Form1.cs 和 Program.cs 文件以及“Properties”文件夹下的所有文件
*   将新项目和解决方案保存在先前提取的“Continuum”文件夹中
*   在解决方案资源管理器中启用“显示所有文件”
*   包括除“bin”、“obj”和“ComplidBinary”文件夹之外的所有文件和文件夹
    *   不要忘记包含“属性”文件夹下的所有文件
*   添加对 ZedGraph.dll 的引用（位于“zedgraph_dll_v5.1.5”文件夹下）
*   建造和享受

**进一步编辑：**

这是未编辑的 Continuum sln 和 csproj 文件与我使用上述过程创建的文件相比的 Unix 差异。（我已手动合并文件以找出真正的差异。）（忽略语法突出显示。）

## Continuum_original.csproj 与 Continuum_new.csproj

```
6c6
    <ProductVersion>9.0.21022</ProductVersion>
---
    <ProductVersion>9.0.30729</ProductVersion>
8c8
    <ProjectGuid>{FD0F9C26-38BF-473F-8FD4-FDB1C7BEA600}</ProjectGuid>
---
    <ProjectGuid>{E3E4FFA5-0EC3-4F94-B842-33C7A49B7FF5}</ProjectGuid>
13c13
    <TargetFrameworkVersion>v2.0</TargetFrameworkVersion>
---
    <TargetFrameworkVersion>v3.5</TargetFrameworkVersion>
37a38,46
    <Reference Include="System.Core">
      <RequiredTargetFramework>3.5</RequiredTargetFramework>
    </Reference>
    <Reference Include="System.Xml.Linq">
      <RequiredTargetFramework>3.5</RequiredTargetFramework>
    </Reference>
    <Reference Include="System.Data.DataSetExtensions">
      <RequiredTargetFramework>3.5</RequiredTargetFramework>
    </Reference>
225c234
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
---
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" /> 
```

## Continuum_original.sln 与 Continuum_new.sln

```
3,4c3,4
# Visual Studio 2008
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Continuum", "Continuum.csproj", "{FD0F9C26-38BF-473F-8FD4-FDB1C7BEA600}"
---
# Visual C# Express 2008
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Continuum", "Continuum.csproj", "{E3E4FFA5-0EC3-4F94-B842-33C7A49B7FF5}"
12,15c12,15
        {FD0F9C26-38BF-473F-8FD4-FDB1C7BEA600}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
        {FD0F9C26-38BF-473F-8FD4-FDB1C7BEA600}.Debug|Any CPU.Build.0 = Debug|Any CPU
        {FD0F9C26-38BF-473F-8FD4-FDB1C7BEA600}.Release|Any CPU.ActiveCfg = Release|Any CPU
        {FD0F9C26-38BF-473F-8FD4-FDB1C7BEA600}.Release|Any CPU.Build.0 = Release|Any CPU
---
        {E3E4FFA5-0EC3-4F94-B842-33C7A49B7FF5}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
        {E3E4FFA5-0EC3-4F94-B842-33C7A49B7FF5}.Debug|Any CPU.Build.0 = Debug|Any CPU
        {E3E4FFA5-0EC3-4F94-B842-33C7A49B7FF5}.Release|Any CPU.ActiveCfg = Release|Any CPU
        {E3E4FFA5-0EC3-4F94-B842-33C7A49B7FF5}.Release|Any CPU.Build.0 = Release|Any CPU 
```

**您会注意到文件没有显着不同**，并且正如此答案的评论中所述，我实际上*可以*打开、编译和运行未经编辑的 Continuum 1.1.1 项目！看来问题可能出在提问者的特定设置上。

## 以下是我的软件和操作系统版本信息：

> Microsoft Visual Studio 2008 版本 9.0.30729.1 SP Microsoft .NET Framework 版本 3.5 SP1
> 
> 安装版：C# Express
> 
> Microsoft Visual C# 2008
> 91910-152-0000061-60588 Microsoft Visual C# 2008
> 
> 带有 SP1 的 Microsoft Visual C# 2008 Express Edition 的修补程序 - ENU (KB945282) KB945282 有关详细信息，请访问 [http://support.microsoft.com/kb/945282](http://support.microsoft.com/kb/945282)。
> 
> 带有 SP1 的 Microsoft Visual C# 2008 Express Edition 的修补程序 - ENU (KB946040) KB946040 有关详细信息，请访问 [http://support.microsoft.com/kb/946040](http://support.microsoft.com/kb/946040)。
> 
> 带有 SP1 的 Microsoft Visual C# 2008 Express Edition 的修补程序 - ENU (KB946308) KB946308 有关详细信息，请访问 [http://support.microsoft.com/kb/946308](http://support.microsoft.com/kb/946308)。
> 
> 带有 SP1 的 Microsoft Visual C# 2008 Express Edition 的修补程序 - ENU (KB947540) KB947540 有关详细信息，请访问 [http://support.microsoft.com/kb/947540](http://support.microsoft.com/kb/947540)。
> 
> 带有 SP1 的 Microsoft Visual C# 2008 Express Edition 的修补程序 - ENU (KB947789) KB947789 有关详细信息，请访问 [http://support.microsoft.com/kb/947789](http://support.microsoft.com/kb/947789)。
> 
> 操作系统名称 Microsoft Windows Vista 版本 6.0.6001 Service Pack 1 Build 6001

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T05:48:58.153

尝试使用文本编辑器打开您的 .csproj -文件并删除具有 GUID 的 ProjectType 元素 - 它通常是第一个 PropertyGroup 下的第一个条目。

[资源](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework/topic49512.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T05:55:20.323

您是否正在尝试加载 VSTS 单元测试项目？Visual Studio 的 Express 版本不支持 VSTS 单元测试项目，并且会导致此类警告。如果您只想查看源代码但无法加载测试，您可以稍微编辑项目文件并加载项目。

**编辑**

澄清我说的是 VSTS 测试单元测试项目与其他类型的单元测试项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T01:00:50.847

似乎您的 VS 版本不喜欢创建 .csproj 的 VS 版本。

您可以尝试将您自己创建的 .csproj 中的标头复制到不起作用的文件中。如果您用 C# 编写一个为您执行此操作的程序，则可以加分。

一个问题：如果文件是用 VS 2005 创建的，您可能需要修改标题以使其看起来仍然是由 VS 2005 创建的，以便您的 VS 安全地转换它。我建议在网上搜索一个用 VS 2005 制作的 .csproj，并使用其中的标题。

尝试下载并重新安装 Visual C# Express 2008。您可能安装了错误的副本。从官方网站下载它，用一个简单的谷歌。

你有正确的 .NET 框架吗？最新版本是 3.5。如果您的版本较低，可能会导致 VS 拒绝加载它。即使您将标头更改为 2.0 或更低版本，应用程序也可能无法构建，因为它是使用更高版本的 .NET 构建的。

如果一切都失败了，请尝试安装 Visual C# 2005。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-28T18:48:00.580

我在安装 Visual Studio 的 DB2 插件后遇到了这个问题（无法打开，因为此版本的应用程序不支持其项目类型（.csproj）。），我按照以下步骤解决了它。单击开始 > 所有程序 > Visual Studio 2008 > Visual Studio 工具 > 单击 Visual Studio 2008 命令提示符。键入以下命令并按回车键。

devenv.exe /resetskippkgs

执行此命令应该可以解决您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-04T09:14:23.887

可能这会有所帮助...

1.  转到 Visual Studios 命令提示符。
2.  键入 devenv.exe /resetskipkgs

它现在应该运行旧项目。

SkipLoading 标记的存在会禁用 VSPackage 的加载；清除标记会重新启用 VSPackage 的加载。

上述命令清除所有 SkipLoading 标签。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T01:29:07.520

根据项目的不同，您可能需要安装许多更新，例如 silverlight、mvc..visual studio c# express 2008 sp1。（在某些情况下，第三方框架会创建这些自定义项目模板。）可能只有测试项目专业版的visual studio就懂了。我发现最好的方法是使用Sharp Develop来打开和处理这些项目。SharpDevelop 不会抱怨项目文件，在大多数情况下，如果您有正确的 dll，您也可以构建项目。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T02:06:52.217

尝试使用文本编辑器打开您的项目并将 <ProductVersion > 的内容替换为您自己的项目文件创建的版本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-06T01:59:26.570

@brianpeiris*几乎*拥有它：

Visual Studio/C# Express 2008 RTM 是**9.0.21022.8 版本**，而 Visual Studio/C# Express 2008 SP1 是**9.0.30729.1 版本**。

尝试升级到[带有 SP1 的 Microsoft Visual Studio 2008 Express Editions](http://www.microsoft.com/downloads/details.aspx?FamilyId=F3FBB04E-92C2-4701-B4BA-92E26E408569&displaylang=en)。您可能还想阅读[带有 SP1 的 Visual Studio Express 常见问题解答](http://social.msdn.microsoft.com/forums/en-US/Vsexpressinstall/thread/aba48c0d-715b-4c15-a5c7-b1de4c8c68a7/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-06T04:35:22.513

警告：这完全是一个 hack，*但是*：您可以编辑 .csproj 文件并注释掉 <ProjectTypeGuids>，如下所示：

```
<-- <ProjectTypeGuids>{6D335F3A-9D43-41b4-9D22-F6F17C4BE596};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids> --> 
```

也就是说，仅将这些注释掉可能会代替您打开项目时遇到的麻烦，而不是编译它。更好的方法是搜索该行的指南。例如，如果您在谷歌上搜索上述项目类型指南，您将能够确定该项目使用[XNA](http://en.wikipedia.org/wiki/Microsoft_XNA)，然后您可以为 C# 2008 Express 下载它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-19T07:46:50.647

转到开始 > 所有程序 > Visual Studio 2008 > Visual Studio 工具 > 单击 Visual Studio 2008 命令提示符。键入以下命令并按回车键。

devenv.exe /resetskippkgs

它打开 Visual Studio 2008 IDE，最后一切正常。

# c++ - qt 设计器的自定义小部件插件是不可见的

> ID：792355
> 
> 赞同：0
> 
> 时间：2009-04-27T05:48:53.567
> 
> 标签：c++, qt, designer

我尝试按照此（[http://doc.trolltech.com/4.3/designer-creating-custom-widgets.html](http://doc.trolltech.com/4.3/designer-creating-custom-widgets.html)）教程为 QT Designer 创建一个自定义小部件插件，并且取得了一定的成功。基本上，我可以将我的新小部件放在 Designer 中，但它不会绘制（我得到一个空方块而不是我尝试在我的 paintEvent 方法中绘制的任何东西，我从一些自定义代码开始，但恢复到从教程中复制粘贴时那没有用）。

在放置自定义小部件时，我的系统日志会填满：

> full_path/Designer：CGAffineTransformInvert：奇异矩阵。

有什么建议么？

我已经构建了 qt sdk 附带的示例插件，没有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:20:27.723

没有来源，很难帮助你。此外，我更喜欢 Qt 4.4——它更可靠、更快。

这里有一些常见问题/提示：

*   您的 DLL / .so 文件不在 /plugins/designer/ 中
*   你有一个错误的 paint() 方法
*   您的应用或库缺少一些库

可以发一下你的画法吗？

乔，克里斯

# sql - sql查询中的最大计数2

> ID：792357
> 
> 赞同：0
> 
> 时间：2009-04-27T05:49:17.780
> 
> 标签：sql, oracle10g

这是指我之前提出的问题，并得到了一个非常快速的答案（[在 sql 查询中的最大计数](https://stackoverflow.com/questions/751156/max-count-together-in-an-sql-query)）。问题集是相似的，但是上一个问题中的解决方案将迫使我在循环中访问数据库，这将导致性能问题。所以我现在拥有的是，经过一些加入后：

```
 id | description
     0 | bla
     0 | blub
     0 | bla
     1 | blablub
     1 | bla
   ... | ... 
```

如您所见，现在 id 不再是主键。我想要的是为结果集中的每个 id 获取最常用的描述。它应该看起来像这样：

```
 id | most_popular_description | times_the_desc_appeared_for_an_id
  0 |                      bla |                                 2
  1 |                  blablub |                                 1
... |                      ... |                               ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T05:58:50.393

这应该可以解决问题。

```
select id, description, COUNT(description)
from mytable
group by id, description
order by 3 desc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T06:42:51.973

如果您只想要最受欢迎的商品，那么我相信这应该会为您提供您正在寻找的结果集。还有其他方法可以做到这一点，但[stats_mode](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions154.htm)是获得组中“最普遍”值的最简单方法（即模式）。

```
SELECT t.id,
       t.description AS most_popular_description,
       COUNT(*) AS times_the_desc_appeared_for_an_id
FROM mytable t INNER JOIN (
  SELECT id, stats_mode(description) AS desc FROM mytable GROUP BY id
) a ON t.id = a.id AND t.description = a.desc
GROUP BY t.id, t.description; 
```

请注意，嵌套查询（内联视图）是必要的，因为您还需要计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T15:44:57.703

我认为您可以使用 dense_rank() 分析函数来获取每个组集的前 N ​​个。

像这样的东西：

```
select id, description, times_the_desc_appeared_for_an_id
from
(
  select id, description, count(description) times_the_desc_appeared_for_an_id
  dense_rank() over (partition by id, description order by count(description) desc) position
  from mytable
  group by id, description
)
where
  position <= 3
order by id, times_the_desc_appeared_for_an_id; 
```

# java - 我的显示链接有问题

> ID：792358
> 
> 赞同：1
> 
> 时间：2009-04-27T05:49:41.867
> 
> 标签：java, struts2

该链接未指向 1.jsp 此代码无法正常工作

```
<display:column property="in" sortable="true" href="1.jsp" paramid="1.jsp"/> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T06:31:41.360

单击此链接不会转到 1.html，而是转到 1.jsp，因为您已定义 href="1.jsp"。

您已定义 paramid="1.html" 但 paramId 采用您要发送到 href url 的参数名称

即如果你想要 1.jsp?paramName=paramValue 那么你将定义 paramId="paramName"

再次阅读 display:column 文档以更好地理解它。

# java - 对象是否封装了数据，即使是同一类的其他实例也不能访问数据？

> ID：792361
> 
> 赞同：7
> 
> 时间：2009-04-27T05:55:01.760
> 
> 标签：java, encapsulation, conceptual

在 Java 中，

对象是否封装了数据，即使是同一类的其他实例也不能访问数据？仅在使用关键字“private”时？Java 中的“访问器方法”是什么 - 像 getName() 这样的方法？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T06:04:06.793

我不倾向于从一个*对象*可以访问另一个对象的角度来考虑它，而是认为哪些*代码*可以访问对象中的哪些数据。

在 Java（和 C#，顺便说一句）中，类中的代码可以访问同一类的任何对象的私有成员。然后你就有了包/程序集访问和公共访问。

棘手的是受保护的访问，这是*对子类中代码的一种*访问——但它取决于目标对象：只有当它是与位置相同类型的实例时，才允许访问对象的受保护成员代码或某个子类——即使它是由父类*公开的。*例如，假设您有：

```
class Parent
{
    protected int x;
}

class Child1 extends Parent
class Child2 extends Parent
class Grandchild extends Child1 
```

然后在`Child1`代码中，您只能访问`Parent.x`已知（在编译时）是`Child1`or实例的对象`Grandchild`。例如，您不能使用`new Parent().x`or `new Child2().x`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T05:58:30.300

不，甚至可以从其他实例（在同一类的方法中）访问私有字段。

但是，即使在同一个实例中，也不能从子类访问它们。

您提供 getter 方法以允许“外部”代码访问您类中的字段。由于您可以自行决定提供哪些 getter、使它们可见的程度以及它们的实现方式，因此您可以对谁可以访问数据以及如何访问数据进行大量控制。

请注意，如果有一个字段，则实际上并不需要一个`name`字段`getName`：这完全取决于该数据来自的 getter 的实现。

即使 getter（或 setter）只是包装了一个私有字段，拥有这些 setter 和 getter 也是一种很好的风格（而不是允许直接访问字段）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T05:59:17.320

getName() 应该返回名称（无论是字段还是其他一些“事物”）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T06:12:55.977

即使一个字段/方法是“私有的”，它仍然可以通过反射访问/调用，除非您安装了一个不允许这样做的自定义安全管理器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T08:35:49.203

封装的思想是允许不同单元的实现自由变化。尽管我们谈论的是对象，但对于封装，我们实际上是指一个代码单元。在基于类的语言中，代码单元通常是 [外部] 类。

在同一个类中没有访问权限的情况下，二进制操作（例如 equals）也会变得愚蠢。所以私有意味着对[外部]类私有，而不是对同一实例中的同一类私有。

访问器方法通常表明除了简单的值对象（仅限 getter）之外的任何东西的设计都不好。对象应该有行为，而不仅仅是一个愚蠢的数据集合。将使用 getter 的外部代码移动到对对象有意义的方法。认真对待，99% 的时间 getter 只返回一个字段值。如果要添加 getter 和 setter，则将字段设为私有的价值相对较小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T08:55:33.103

> Java 中的“访问器方法”是什么 - 像 getName() 这样的方法？

是的 -`getFoo()`并且`setFoo()`是命名的“属性”的访问器方法`foo`- 这是[JavaBeans](http://java.sun.com/javase/technologies/desktop/javabeans/faq/index.html)规范的一部分。这些优先于公共字段的原因是它们允许您只有一个 getter（使属性只读），进行额外的簿记（如计算派生字段）和验证设置值（例如，当值是时抛出[PropertyVetoException](http://java.sun.com/javase/6/docs/api/java/beans/PropertyVetoException.html)不能接受的）。

整个东西最初打算与允许您以图形方式配置和组合 JavaBean 以“构建应用程序”的 GUI 工具一起使用。事实证明，这在很大程度上是一个白日梦，但 JavaBeans 和属性的概念已经证明对常规编码很有用并变得广泛传播。

许多人误解了这个概念，并认为“封装”只是意味着为私有属性编写 setter 和 getter，而不是将它们公开 - 然后理所当然地认为这是愚蠢的。*封装意味着根本*不暴露类的内部工作，除非以严格控制的方式。在良好的 OO 设计中，一个类中不应该有太多的 get 方法和很少的 set 方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T09:45:30.130

*对象是否封装了数据，即使是同一类的其他实例也不能访问数据？*

当然，如果您不使用静态成员。

[从此链接](http://java.sun.com/docs/books/tutorial/java/javaOO/classvars.html)中提取：

*有时，您希望拥有所有对象共有的变量。这是通过静态修饰符完成的。声明中带有 static 修饰符的字段称为静态字段或类变量*

# sql - 类似于 TOP 10 的查询以选择中间记录？

> ID：792362
> 
> 赞同：2
> 
> 时间：2009-04-27T05:55:03.147
> 
> 标签：sql, sql-server, sql-server-2005

我有 100 条记录，我可以在其中使用查询中的“TOP 10”选择前 10 名。同样有什么能拿到第20到30的记录吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T06:00:45.567

由于您使用的是 SQL Server 2005，因此您可以使用“新”ROW_NUMBER() 函数。这将为您提供第 11 到 20 行：

```
SELECT  Description, Date
FROM     (SELECT  ROW_NUMBER() OVER (ORDER BY Date DESC)
             AS Row, Description, Date FROM LOG)
            AS LogWithRowNumbers
WHERE  Row >= 11 AND Row <= 20 
```

如果您有很多记录，则在内部 SELECT 子句中使用 TOP X 可能会加快速度，因为如果您只想获取记录 11 到 20，则返回 1000 条记录是没有用的：

```
SELECT  Description, Date
FROM     (SELECT TOP 20 ROW_NUMBER() OVER (ORDER BY Date DESC)
             AS Row, Description, Date FROM LOG)
            AS LogWithRowNumbers
WHERE  Row >= 11 AND Row <= 20 
```

[来源](http://www.davidhayden.com/blog/dave/archive/2005/12/30/2652.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T06:06:39.640

您应该使用 ROWNUMBER() 来获取结果集的记录数并在 where cause 中对其进行过滤。

```
SELECT * FROM   (SELECT ROW_NUMBER() OVER(ORDER BY name) AS
rownum, name , age FROM Table) AS Table1
WHERE rownum >= 2 AND rownum <= 5

----------------------------
rownum     | name |   age   |
----------------------------
   2     |John    |   25    | 
   3     |Adam    |   23    | 
   4     |Tom     |   19    |
   5     |Jame    |   22    |
---------------------------- 
```

# java - 访问映射网络驱动器时出现问题

> ID：792376
> 
> 赞同：2
> 
> 时间：2009-04-27T06:00:15.430
> 
> 标签：java, web-applications, weblogic, vmware

我们在访问映射网络驱动器上的内容时遇到问题。

我们有一个 web 应用程序在 (Windows 2000 NT) 上的 weblogic 8.1 上运行。

该应用程序从映射的网络驱动器中检索图像并显示。

现在我们将我们的应用程序移动到托管在 Weblogic 10.3 上的虚拟机 (Windows 2003 SP1) 上。

但是在这个新设置中，即使网络驱动器已映射并在机器上可用，应用程序也无法访问它。

在虚拟机上映射网络驱动器是否有任何特定设置？

有什么帮助吗？对此真的很震惊。

提前致谢。

贾尼。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T06:03:58.710

建议您通过确保 Web 应用程序进程具有访问网络共享的必要权限来开始故障排除。

也许您需要将运行 Web 应用程序的帐户更改为 Windows 域用户？也许该应用程序现在以 LOCALSYSTEM 运行（仅具有本地权限）。

如果您无法在域用户帐户下运行 Web 应用程序，您可以尝试通过身份验证：在 Web 应用程序服务器上创建一个本地用户，使用与可以访问网络共享的帐户完全相同的用户名和密码。在此本地帐户下运行应用程序。

**编辑：**

如果 Web 应用程序配置为使用驱动器映射连接到网络共享，请尝试改用 UNC 路径。例如更改`m:\directory`为`\\server\share\directory`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T07:59:45.627

另一个问题 - 除了需要让您的服务使用域帐户之外 - 并非 Windows 服务器上的所有应用程序都看到相同的网络驱动器映射集。如果您登录服务器并手动设置驱动器映射，您的网络应用程序可能不会注意到它。

这种行为的原因是 Windows 服务器上的驱动器映射是在每个会话的基础上完成的。Windows 为服务器进程分配一个或多个会话 ID，并为每个交互式登录分配一个不同的会话 ID。

最安全的方法是：

*   在代码中建立驱动器映射。我对 Weblogic 一无所知，但您需要找到相当于 Windows [WNetAddConnection2](http://msdn.microsoft.com/en-us/library/aa385413(VS.85).aspx)调用的内容。
*   或者，切换到使用 UNC 路径名，从而避免驱动器映射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T06:10:44.263

映射网络驱动器的过程对于虚拟机和物理机是相同的。我怀疑您遇到的问题更多与将您的应用程序从 Windows 2k/WebLogic 8.1 移植到 Windows 2k3/WebLogic 10.3 有关。虚拟部分可能与它无关。如需更多帮助，我们需要了解有关您看到的错误以及如何配置应用程序以查找您的资源的更多详细信息。

# html - 如何使我的页面与 IE 兼容？

> ID：792377
> 
> 赞同：1
> 
> 时间：2009-04-27T06:00:41.060
> 
> 标签：html, css, internet-explorer

我正在使用 Django 构建一个网站，我的模板使用 CSS 并使用 firefox 在本地对其进行测试，但是当我正要向我的朋友“展示它”时，我在 IE 上运行它并且该死的网站都坏了！标题都搞砸了，似乎什么都没有，空间都搞砸了！这不好。

是不是少了什么东西！像一些标题声明？DOCTYPE 什么的？

注意：我从互联网上的某个站点获取了正在使用的 css，当我在 IE 上运行该站点时，一切看起来都不错！

帮助

这是有问题的 css，使用这个 css 的**h1**部分正在破坏，有什么线索吗？

```
div#header
{
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 10px;
  text-align: left;
  width: 780px;
  height: 102px;
  background: url(/site_media/header_background.gif) no-repeat top left;
}

div#header h1
{
  padding: 30px;
  font-family: Verdana, sans-serif;
  font-size: 17px;
  font-weight: bold;
  color: #c8c8c8;
  letter-spacing: -1px;
}

div#header h1 strong
{
  color: #999;
  width: 810px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T06:10:24.453

首先，确保您使用的文档类型声明不会触发[Quirks Mode](http://en.wikipedia.org/wiki/Quirks_mode)。我建议使用[HTML 4.01 Strict 或 XHTML 1.0 Strict](http://www.w3.org/QA/2002/04/valid-dtd-list.html)。

其次，确保您的站点根据[W3C 验证器进行验证](http://validator.w3.org/)。

最后，发布有问题的网站，或错误的片段，以便我们为您提供进一步的建议。您可能需要专门针对 IE（版本）的[条件 CSS 。](http://www.quirksmode.org/css/condcom.html)

**编辑：**现在看到您的更新，您能否发布您认为“损坏”的屏幕截图，您能否确保该页面未**使用**该过渡文档类型并且它已验证。随附的 HTML 也会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T06:23:16.653

尝试使用 reset.css 文件进行更“快乐”的交叉浏览。[**您可以从Eric Meyer 的网站上**](http://meyerweb.com/eric/tools/css/reset/)查看有关 reset.css 的详细信息。还有另一个由 yahoo 的开发人员开发的 reset.css 文件。但是两个reset.css的结果是一样的。您可以尝试其中任何一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T06:29:59.897

然后，一旦您的网站在 IE7 上满意，您可能需要面对 IE6 仍然存在的所有*其他*问题。IE6 仍然在大约 15% 的 PC 上运行，所以你必须决定你想要做什么......

哦，别忘了您的 Safari、Chrome 和 FF2 测试。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T06:06:42.340

这一次对您没有帮助，但是下次您“从头开始”开发站点时，请尝试每天至少在 IE 中测试该站点一次。这样你就不会在最后得到这种惊喜。

如果您想要更准确的答案，请发布 URL，有人会指出为什么它在 IE 和 Firefox 中看起来不同

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T06:09:43.440

你没有错过任何东西。欢迎来到 IE...

大多数问题很可能是由 IE 的渲染引擎中的错误引起的。这些链接可能会有所帮助：

*   [IE 的 10 大 CSS 问题](http://archive.webstandards.org/css/winie/)
*   [IE 框模型错误](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)
*   [位置就是一切 - 详细解释现代浏览器错误](http://www.positioniseverything.net/)

您可以使用HTML 中的[条件注释](http://www.quirksmode.org/css/condcom.html)来包含 IE 样式表的替代版本。

史蒂夫

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T07:41:37.603

对于 doctype，主要目的是让浏览器退出 quirksmode。

你可以用他们的

```
<!DOCTYPE XHTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
```

甚至只是

```
<!doctype> 
```

这是 HTML5 文档类型，并且更简单:) [虽然如果您使用 w3c 验证器检查您的代码，它会给出不同的错误。]

最让你感到困惑的是填充：

div#header h1 { 填充：30px; ...

IE 有一个，呃，与其他浏览器不同的盒子模型，首先展示它的是边框和填充。（在 IE 中，宽度包括填充，在其他浏览器中不包括）

要解决这个问题，您可以使用 IE 条件或[hacks](http://ajaxian.com/archives/css-browser-hacks)为 IE 提供自己的样式，或者您可以使用嵌套的 div 和边距，它们的处理方式更加一致。您还可以使用[Dean Edwards IE7](http://dean.edwards.name/IE7/)或类似的工具来使用 Javascript 修复它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T06:10:10.320

这是我用来确定适当样式表的 PHP 函数：

```
 function stylesheet() {
    $ua    = $_SERVER["HTTP_USER_AGENT"];
    $iepos = strpos($ua,"MSIE");
    if ($iepos) {
        $vers = substr($ua,$iepos+5,1);
        if ($vers >= 8) return "style.css";
        else return "iestyle.css";
        }
    else return "style.css";
    } 
```

我遇到了一个非常奇怪的问题，我需要 IE8 成为“好”版本，所以大多数人可能会改变......

```
if ($vers >= 8) 
```

至...

```
if ($vers >= 7) 
```

然后我只需要代替普通的 CSS 链接：

```
<?php echo "<link rel=\"stylesheet\" href=\"".stylesheet()."\" />"; ?> 
```

祝你好运。

# c# - C# 在程序启动时实例化/初始化对象

> ID：792381
> 
> 赞同：4
> 
> 时间：2009-04-27T06:03:53.080
> 
> 标签：c#, reflection, static, startup

我是一名最近在 C# 中工作的 C/C++ 程序员，我正在尝试做一些我遇到麻烦的花哨的初始化工作。

我能想到的最好和最简单的例子是我想创建一个“Eager”单例——它在程序启动时立即创建，但我不需要进入程序的主要功能并说“单例”。 Instance()”作为第一件事。我阅读了静态实例化，看起来必须在实例化静态对象之前调用或创建它，所以我尝试创建一个实例化对象的静态变量，但这不起作用。（我找不到任何关于何时实例化/初始化静态变量的文档）。

任何指针？

谢谢！

编辑：经过一些额外的研究，我想我可以通过使用反射的单个代码块来完成我正在寻找的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T06:11:23.640

仅当您第一次引用包含构造函数的类时才会调用静态构造函数。因此，当您希望初始化代码在程序启动时运行时，您必须在启动代码中显式引用包含构造函数的类（`Main`例如方法）。

# java - 如何在Java中读取小于-128的负字节值

> ID：792386
> 
> 赞同：5
> 
> 时间：2009-04-27T06:05:41.937
> 
> 标签：java, types, core, xmodem

我正在使用串行端口从另一个系统读取数据。我正在读取 133 字节的数据包。第二个字节是包号，第三个字节是包号的负值。

问题是该类型`byte`的范围是 -128 到 127。当我尝试读取 -129（超出字节范围）时，它会将值设为 127。

我应该怎么做才能得到-129？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T06:28:13.817

您必须确定您期望字节值具有的范围。例如，如果您期望范围为 -129 到 126，则可以使用。

```
int min = 129;
int i = ((b + min) & 0xFF) - min; 
```

顺便说一句，您的值不能超过 256。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T06:12:00.097

你得到 127 因为一个字节只有 8 位，所以这个值是环绕的。-129 不适合 java 字节。如果您想在给定变量中拟合 -129，则至少必须修改程序以使用短裤。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T07:48:18.040

我不得不在这里猜测一下，因为我不知道协议。

也许这两个值都应该在协议中被视为无符号（正）字节，您可以稍后将它们转换为整数。

```
// 0-255
int plus = (int)(plusByte & 0xFF);

// -255 - 0
int minus = 0 - (int)(minusByte & 0xFF); 
```

它与[美国专利 6313763 有关](http://www.google.com/patents?id=bSkIAAAAEBAJ&dq=United+States+Patent+6313763)吗？但由于数据包的长度是固定的，我不明白。

不可能在一个字节中存储比范围 256 更大的数字。也许你误解了协议，它的 int 的高位和低位存储在两个字节中？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T11:00:46.300

小于 -128 的值不适合有符号字节。您需要阅读短文等。

# python - 找到最短的子串

> ID：792394
> 
> 赞同：3
> 
> 时间：2009-04-27T06:08:16.500
> 
> 标签：python, substring

我编写了一个代码来从字符串中查找子字符串。它打印所有子字符串。但我想要一个长度为 2 到 6 的子字符串并打印最小长度的子字符串。请帮我

程序：

```
import re
p=re.compile('S(.+?)N')
s='ASDFANSAAAAAFGNDASMPRKYN'
s1=p.findall(s)
print s1 
```

输出：

```
['DFA', 'AAAAAFG', 'MPRKY'] 
```

期望的输出：

```
'DFA'  length=3 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T06:24:32.530

如果您已经拥有该列表，则可以将[min](http://docs.python.org/library/functions.html#min)函数与[len](http://docs.python.org/library/functions.html#len)函数一起用作第二个参数。

```
>>> s1 = ['DFA', 'AAAAAFG', 'MPRKY']
>>> min(s1, key=len)
'DFA' 
```

**编辑：**
如果两个长度相同，您可以进一步扩展它以生成一个包含所有相同长度元素的列表：

```
>>> s2 = ['foo', 'bar', 'baz', 'spam', 'eggs', 'knight']
>>> s2_min_len = len(min(s2, key=len))
>>> [e for e in s2 if len(e) is s2_min_len]
['foo', 'bar', 'baz'] 
```

当只有 1 个“最短”元素时，上述内容也应该有效。

**编辑2：**为了完整起见，至少根据我的简单测试，计算最短元素的长度并在列表理解中使用它应该更快。以上更新。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T06:13:47.330

正则表达式`'S(.{2,6}?)N'`只会为您提供长度为 2 - 6 个字符的匹配项。

要返回最短匹配子字符串，请使用`sorted(s1, key=len)[0]`.

完整示例：

```
import re
p=re.compile('S(.{2,6}?)N')
s='ASDFANSAAAAAFGNDASMPRKYNSAAN'
s1=p.findall(s)
if s1:
    print sorted(s1, key=len)[0]
    print min(s1, key=len) # as suggested by Nick Presta 
```

这通过`findall`按长度对返回的列表进行排序，然后返回排序列表中的第一项来工作。

编辑：尼克普雷斯塔的回答更优雅，我不知道`min`也可以`key`争论......

# struts - 在struts中进行多行更新的好方法是什么（使用struts live）？

> ID：792404
> 
> 赞同：0
> 
> 时间：2009-04-27T06:12:00.550
> 
> 标签：struts, pojo, multirow

不使用 DynaForm 和它的亲戚。

我想使用 POJO 数据传输对象，例如 Person：

```
public class Person {
   private Long id;
   private String firstName;
   private String lastName;
   // ... getters / setters for the fields
} 
```

在 struts 实景表单中，我们将拥有：

```
public class PersonUpdateForm extends SLActionForm {
   String organization;
   Person[] persons; // all the people will be changed to this organization; they're names and so forth can be updated at the same time (stupid, but a client might desire this)

   // getters / setters + index setters / getters for persons

} 
```

相应的 html:text 标记在 JSP 中会是什么样子以允许这样做？如果我切换到 List Persons 字段并使用延迟加载列表（在 commons-collections 中），那将如何改变thingsg？

在 struts-1.2(.9?) 中似乎没有很好的方法来做到这一点

非常感谢所有帮助！！！如果您需要更多上下文，请告诉我，我可以提供一些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T07:33:45.033

好吧，我相信我已经想通了！诀窍是让您的索引 getter 每次由 BeanUtils 的 populate 方法调用 getPersons() 方法时创建一个元素。代码已经完成，但我得到了一个积极的结果。现在是 3:30，我已经坚持了一段时间。似乎没有人知道答案，这让我想用鳟鱼打他们的头。至于我自己的无知……只能怪他们！

```
public List<Person> getPersons() {
   persons.add(new Person()); // BeanUtils needs to know the list is large enough
   return persons;
} 
```

当然，也要添加索引的 getter 和 setter。

我记得我实际上是如何做到这一点的。您必须将上述人员列表预初始化为您希望传输的最大大小。这是因为首先将 List 转换为数组，然后在数组的每个元素上设置属性，最后使用 setPersons(...) 设置回 List。因此，使用延迟加载 List 实现或类似方法（例如上面显示的）将不适用于 struts live。以下是您需要更详细地执行的操作：

```
private List<Person> persons = new ArrayList<Person>(MAX_PEOPLE);
public MyConstructor() { for(int i = 0; i < MAX_PEOPLE; i++) persons.add(new Person()); }

public List<Person> getPeopleSubmitted() {
    List<Person> copy = new ArrayList<Person>();
    for(Person p : persons) {
        if(p.getId() != null) copy.add(p); 
        // id will be set for the submitted elements;
        // the others will have a null id
    }
    return copy; // only the submitted persons returned - not the blank templates
} 
```

这基本上就是你必须做的！但真正的问题是 - 谁在使用 struts live 了？！

# django - Django：如何从模板中识别调用视图？

> ID：792410
> 
> 赞同：42
> 
> 时间：2009-04-27T06:17:29.660
> 
> 标签：django

**简洁版本：**

是否有一种简单的内置方法来识别 Django 模板中的调用视图，而无需传递额外的上下文变量？

**长（原始）版本：**

我的一个 Django 应用程序有几个不同的视图，每个视图都有自己命名的 URL 模式，它们都呈现相同的模板。有非常少量的模板代码需要根据被调用的视图进行更改，太小以至于不值得为每个视图设置单独的模板的开销，所以理想情况下我需要找到一种方法来识别模板中的调用视图.

我尝试设置视图以传递额外的上下文变量（例如“view_name”）来识别调用视图，并且我也尝试使用`{% ifequal request.path "/some/path/" %}`比较，但这些解决方案都不是特别优雅。有没有更好的方法来从模板中识别调用视图？有没有办法访问视图的名称或 URL 模式的名称？

* * *

**更新 1：**关于这只是我误解 MVC 的评论，我理解 MVC，但[Django 并不是真正的 MVC 框架](http://docs.djangoproject.com/en/dev/faq/general/#django-appears-to-be-a-mvc-framework-but-you-call-the-controller-the-view-and-the-view-the-template-how-come-you-don-t-use-the-standard-names)。我相信我的应用程序的设置方式与 Django 对 MVC 的看法是一致的：视图描述了呈现*哪些*数据，模板描述*了*数据的呈现方式。碰巧我有许多准备不同数据的视图，但它们都使用相同的模板，因为所有视图的数据都以相同的方式呈现。我只是在寻找一种简单的方法来从模板中识别调用视图（如果存在）。

**更新 2：**感谢所有答案。我认为这个问题被过度思考了——正如我原来的问题中提到的那样，我已经考虑并尝试了所有建议的解决方案——所以我现在将它提炼成一个“简短版本”，现在位于问题的顶部. 现在看来，如果有人只是简单地发布“不”，那将是最正确的答案:)

**更新 3：** Carl Meyer 发布了“不” :) 再次感谢大家。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-01-10T11:24:14.847

从 Django 1.5 开始，`url_name`可以使用：

```
request.resolver_match.url_name 
```

在此之前，您可以为此使用中间件：

```
from django.core.urlresolvers import resolve

class ViewNameMiddleware(object):  
    def process_view(self, request, view_func, view_args, view_kwargs):
        url_name = resolve(request.path).url_name
        request.url_name = url_name 
```

然后在 MIDDLEWARE_CLASSES 中添加它，在模板中我有这个：

```
{% if request.url_name == "url_name" %} ... {% endif %} 
```

考虑到 RequestContext(request) 总是传递给渲染函数。我更喜欢使用 url_name 作为 url，但可以使用 resolve().app_name 和 resolve().func.name，但这不适用于装饰器 - 而是返回装饰器函数名称。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-27T15:11:58.160

不，这将是一个坏主意。从模板中直接引用视图函数名称会在视图层和模板层之间引入过紧的耦合。

这里一个更好的解决方案是 Django 的模板继承系统。定义一个公共父模板，在每个视图的版本中需要更改的（小）区域块。然后定义每个视图的模板以从父级扩展并适当地定义该块。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-07-01T00:32:56.833

如果你的命名在你的 urls.py 和 views.py 中是一致的，它应该是，那么这将返回视图名称：

```
{{ request.resolver_match.url_name }} 
```

当你在模板中调用它时，一定要给它应用一些上下文。例如，我在这里使用它从我的详细视图中删除删除按钮，但在我的更新视图中，删除按钮仍然会出现！

```
{% if request.resolver_match.url_name != 'employee_detail' %} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-17T13:57:27.277

从 Django 1.5 开始，您可以通过[request.resolver_match访问](https://docs.djangoproject.com/en/1.9/ref/request-response/#django.http.HttpRequest.resolver_match)[ResolverMatch](https://docs.djangoproject.com/en/1.9/ref/urlresolvers/#django.core.urlresolvers.ResolverMatch)的实例。

ResolverMatch 为您提供解析的 url 名称、命名空间等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T06:30:25.370

一个简单的解决方案是：

```
def view1(req):
   viewname = "view1"
   and pass this viewname to the template context   

def view2(req):
   viewname = "view2"
   and pass this viewname to the template context 
```

在模板中访问视图名称为

```
{{viewname}} 
```

你也可以在比较中使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T06:42:21.490

这听起来像是您可以设置的通用视图的完美示例。

请参阅以下资源：

*   [Django Book - 第 11 章：通用视图](http://www.djangobook.com/en/2.0/chapter11/)
*   [Django Docs - 教程：第 4 章](https://docs.djangoproject.com/en/1.4/intro/tutorial04/#use-generic-views-less-code-is-better)
*   [Django Docs - 通用视图](https://docs.djangoproject.com/en/1.4/ref/generic-views/#ref-generic-views)

这些链接应该可以帮助您相应地简化视图和模板。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-31T18:28:59.740

我正在为一个帮助页面系统工作，我希望每个视图都对应于我的 cms 中的一个帮助页面，如果没有为该视图定义帮助页面，则会显示一个默认页面。我偶然发现了[这个博客](http://blog.isotoma.com/2009/12/getting-the-name-of-the-current-view-in-a-django-template/)，他们使用模板上下文处理器和一些 python 检查魔法来推断视图名称并用它填充上下文。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-12-17T05:01:41.597

如果您使用基于类的视图，您很可能有一个`view`可以访问的变量。

您可以使用其中的几种方法来确定已调用哪个视图或正在呈现哪个模板。

例如

```
{% if view.template_name == 'foo.html' %}
# do something
{% else %}
# other thing
{% endif %} 
```

另一种选择是取出您需要更改的模板片段并将其制成片段，然后`{% include 'my_snippet.html' with button_type = 'bold' %}`在模板中使用，将任意值发送到片段，以便它可以确定要显示的内容/如何设置自己的样式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-02T07:16:54.073

大多数通用视图——如果不是全部的话——都继承[`ContextMixin`](https://docs.djangoproject.com/en/1.9/ref/class-based-views/mixins-simple/#contextmixin)了一个`view`指向 View 实例的上下文变量。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-27T06:39:27.160

为什么不尝试设置会话 cookie，然后从模板中读取 cookie。

在您的意见上设置 cookie

```
def view1(request):
 ...
#set cookie
 request.session["param"]="view1"

def view2(request):
  request.session["param"]="view2"

then in your ONE template check something like..

{% ifequal request.session.param "view1" %}
   ... do stuff related to view1
{% endifequal %}

{% ifequal request.session.param "view2" %}
  ... do stuff related to "view2"
{% endifequal %} 
```

加思

# c# - 无法将“System.Data.Linq.DataQuery`1[System.Int32]”类型的对象转换为“System.IConvertible”类型

> ID：792412
> 
> 赞同：11
> 
> 时间：2009-04-27T06:18:22.593
> 
> 标签：c#, linq, linq-to-sql

我正在尝试将数据插入到有 2 个表的数据库中

产品
(ProductID): 1
(IDNumber) : 200900110
(ProductName) : Pepsi

Order
(OrderID): 1 (Auto Increment by 1)
(ProductID):1
(Date): 1/1/2009

代码是这样的：

```
var db = new ProductOrder();
var idNum = from p in db.Product
            where p.IDNumber == 200900110 
            select p.ProductID; 

var order = new Order();
            order.productID = Convert.ToInt32(idNum);
            order.Date = DateTime.Now;
db.Order.InsertOnSubmit(nTime);
db.SubmitChanges(); 
```

运行后它给了我这样的错误：

> 无法将“System.Data.Linq.DataQuery`1[System.Int32]”类型的对象转换为“System.IConvertible”类型

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-27T06:22:47.870

您的查询：

```
from p in db.Product
where p.IDNumber == 200900110
select p.ProductID 
```

不返回单个结果，而是返回结果列表。在您的情况下，这将是一个包含单个产品 ID 的列表。您应该将其修改为：

```
(from p in db.Product
 where p.IDNumber == 200900110
 select p.ProductID).Single() 
```

如果您在调试器中运行代码并将鼠标悬停在`idNum`变量上，您会看到它是一个`DataQuery`实例。

# visual-c++-6 - 有人使用视觉辅助吗？VA如何获取源代码内容？

> ID：792415
> 
> 赞同：1
> 
> 时间：2009-04-27T06:21:09.870
> 
> 标签：visual-c++-6, visual-assist

我在 VC6 中使用 Visual Assist，它似乎是一个强大的工具。作为一名程序员，我对实现感到好奇。我想知道VA如何获取源代码内容？似乎 VA 知道我的代码文件的每一行，即使它被修改并且没有保存到文件中。

我研究了一段时间的插件开发，VC6的插件接口没有提供这种接口来获取当前的代码内容，尤其是当源文件被修改而不保存时。

我猜 VA 使用了一些技巧来做到这一点，但它是什么？子类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-30T03:48:07.917

我猜他们使用某种“挂钩”技术来监控源内容的变化。例如`SetWindowLong`/`SetWindowsHookEx`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-21T14:51:48.513

肯定 VA 是作为一个 Visual Studio 插件实现的，我想它可以访问某种 Visual Studio API，我想这会暴露代码编辑器内容等内容。

有关更多信息，请参阅此链接：http: [//www.microsoft.com/downloads/details.aspx? FamilyId=59EC6EC3-4273-48A3-BA25-DC925A45584D&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=59EC6EC3-4273-48A3-BA25-DC925A45584D&displaylang=en)

hth

# networking - 将 Virtual PC 2007 添加到主机网络

> ID：792431
> 
> 赞同：6
> 
> 时间：2009-04-27T06:34:26.703
> 
> 标签：networking, virtual-pc

我正在使用带有 Windows xp Pro 作为来宾的 Virtual PC 2007。是否可以将虚拟 PC 添加到来宾 PC 的网络和来宾 PC 的域中？我启用了 NAT 共享网络，但只允许来宾访问互联网.. 谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T07:12:22.713

当您将访客添加到主机的物理适配器时，这应该不是问题：

在 VM 的设置中，转到网络，而不是“共享网络 (NAT)”，选择连接到主机上网络的 NIC（例如“Realtek RTL8116 Gigabit Ethernet”，或任何您的 NIC；这是等效的到 VMWare 的桥接模式）。这样，来宾将在您的网络上显示为一台真实的计算机，并且将像网络上的一个物理盒子一样工作。

IIRC，MS VPC 绕过主机上的默认 Windows 防火墙，因此只有来宾的防火墙适用；对于其他固件产品，您可能需要启用类似“允许不发往此主机的数据包”之类的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T10:35:46.700

只是添加到上面的答案 -

**1.**

> 在本地连接属性内部 - 未安装 VM 网络服务驱动程序，否则 NIC 选项不会出现在虚拟机网络适配器配置中。
> 
> 我重新安装了 Virtual PC，出现了**Virtual Machine Network Driver**条目。

**2.**

> 另一个有用的资源-

[http://blogs.msdn.com/virtual_pc_guy/archive/2007/01/15/fixing-broken-virtual-networking.aspx](http://blogs.msdn.com/virtual_pc_guy/archive/2007/01/15/fixing-broken-virtual-networking.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T06:40:11.883

只要您可以从虚拟计算机连接到域控制器，这应该不是问题。

如果您知道域控制器的 IP 地址，请尝试 ping 它。然后尝试使用计算机名称 ping 它，以查看名称解析是否正常工作。使用控制面板加入域时会发生什么 | 系统。您是否收到错误消息？

我没有使用过 Virtual PC，只有 Linux 上的 VMWare 工作站，所以我不知道 Virtual PC 上的网络设置如何。在 VMWare 上，您可以在虚拟机的桥接网络和 NAT 网络之间进行选择。我已经能够使用这两种网络设置将 Windows 来宾计算机设置为 Windows 域的成员。

# mainframe - 比较两个文件并将其写入“匹配”和“不匹配”文件

> ID：792432
> 
> 赞同：5
> 
> 时间：2009-04-27T06:34:50.697
> 
> 标签：mainframe, syncsort, dfsort, easytrieve

我有两个输入文件，每个文件的长度为 5200 字节。一个七字节的密钥用于比较两个文件，如果有匹配项，则需要将其写入“匹配”文件，但在写入匹配文件时，我需要`infile1`来自`infile2`.

如果没有匹配，则写入`no match`文件。

有可能做到`sort`吗？我知道使用 COBOL 程序可以轻松完成，但只想知道`SORT/ICETOOL/Easytrieve Plus (EZTPA00)`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-11T12:24:43.447

由于有 12,200 人查看了这个问题，但没有得到答案：

DFSORT 和 SyncSort 是主要的大型机排序产品。它们的控制卡有很多相似之处，也有一些不同之处。

```
JOINKEYS FILE=F1,FIELDS=(key1startpos,7,A)              
JOINKEYS FILE=F2,FIELDS=(key2startpos,7,A)              
JOIN UNPAIRED,F1,F2
REFORMAT FIELDS=(F1:1,5200,F2:1,5200)                         
SORT FIELDS=COPY 
```

一个“JOINKEYS”由三个任务组成。子任务 1 是第一个 JOINKEYS。子任务 2 是第二个 JOINKEYS。主要任务紧随其后，是处理连接数据的地方。在上面的示例中，它是一个简单的 COPY 操作。连接的数据将被简单地写入 SORTOUT。

JOIN 语句定义了与匹配的记录一样，未配对的 F1 和 F2 记录将呈现给主任务。

REFORMAT 语句定义将呈现给主任务的记录。假设 F2 需要三个字段，一个更有效的示例是：

```
 REFORMAT FIELDS=(F1:1,5200,F2:1,10,30,1,5100,100) 
```

F2 上的每个字段都定义有起始位置和长度。

然后由 Main 任务处理的记录长 5311 字节，F2 中的字段可以被 5201,10,5211,1,5212,100 引用，F1 记录为 1,5200。

实现相同目的的更好方法是使用 JNF2CNTL 减小 F2 的大小。

```
//JNF2CNTL DD *
  INREC BUILD=(207,1,10,30,1,5100,100) 
```

SyncSort 的某些安装不支持 JNF2CNTL，即使支持（从 Syncsort MFX for z/OS 版本 1.4.1.0 起），SyncSort 也没有记录。对于 1.3.2 或 1.4.0 的用户，可从 SyncSort 获得更新以提供 JNFnCNTL 支持。

应该注意的是，JOINKEYS 默认对数据进行排序，带有选项 EQUALS。如果 JOINKEYS 文件的数据已经按顺序排列，则应指定 SORTED。如果不需要序列检查，也可以指定 DFSORT NOSEQCHK。

```
 JOINKEYS FILE=F1,FIELDS=(key1startpos,7,A),SORTED,NOSEQCHK 
```

虽然请求很奇怪，但由于无法确定源文件，所有不匹配的记录都将转到单独的输出文件。

使用 DFSORT，有一个匹配标记，用 ? 指定 在改革：

```
 REFORMAT FIELDS=(F1:1,5200,F2:1,10,30,1,5100,100,?) 
```

这将 REFORMAT 记录的长度增加了一个字节。这 ？可以在 REFORMAT 记录的任何地方指定，不需要指定。这 ？由 DFSORT 解析为： B，来自两个文件的数据；1，来自F1的无与伦比的记录；2，来自F2的无与伦比的记录。

SyncSort 没有匹配标记。REFORMAT 记录中是否存在数据必须由值确定。在不能包含特定值的两个输入记录上选择一个字节（例如，在一个数字中，决定一个非数字值）。然后将该值指定为 REFORMAT 上的 FILL 字符。

```
 REFORMAT FIELDS=(F1:1,5200,F2:1,10,30,1,5100,100),FILL=C'$' 
```

如果 F1 的位置 1 不能自然有“$”，而 F2 的位置 20 也不能，那么这两个位置可以用来确定匹配的结果。如有必要，可以测试整个记录，但会占用更多 CPU 时间。

明显的要求是将 F1 或 F2 中的所有不匹配记录写入一个文件。这将需要一个 REFORMAT 语句，其中包含两个完整的记录：

DFSORT，输出不匹配的记录：

```
 REFORMAT FIELDS=(F1:1,5200,F2:1,5200,?)

  OUTFIL FNAMES=NOMATCH,INCLUDE=(10401,1,SS,EQ,C'1,2'),
        IFTHEN=(WHEN=(10401,1,CH,EQ,C'1'),
                    BUILD=(1,5200)),
        IFTHEN=(WHEN=NONE,
                    BUILD=(5201,5200)) 
```

SyncSort，输出不匹配的记录：

```
 REFORMAT FIELDS=(F1:1,5200,F2:1,5200),FILL=C'$'

  OUTFIL FNAMES=NOMATCH,INCLUDE=(1,1,CH,EQ,C'$',
                          OR,5220,1,CH,EQ,C'$'),
        IFTHEN=(WHEN=(1,1,CH,EQ,C'$'),
                    BUILD=(1,5200)),
        IFTHEN=(WHEN=NONE,
                    BUILD=(5201,5200)) 
```

SyncSort 的编码也适用于 DFSORT。

写出匹配的记录很容易。

```
 OUTFIL FNAMES=MATCH,SAVE 
```

SAVE 确保所有不是由另一个 OUTFIL 写入的记录都将写入这里。

需要进行一些重新格式化，主要是从 F1 输出数据，但要从 F2 中选择一些字段。这适用于 DFSORT 或 SyncSort：

```
 OUTFIL FNAMES=MATCH,SAVE,
     BUILD=(1,50,10300,100,51,212,5201,10,263,8,5230,1,271,4929) 
```

具有任意开始和长度的整个事情是：

DFSORT

```
 JOINKEYS FILE=F1,FIELDS=(1,7,A)              
  JOINKEYS FILE=F2,FIELDS=(20,7,A)    

  JOIN UNPAIRED,F1,F2

  REFORMAT FIELDS=(F1:1,5200,F2:1,5200,?)                         

  SORT FIELDS=COPY    

  OUTFIL FNAMES=NOMATCH,INCLUDE=(10401,1,SS,EQ,C'1,2'),
        IFTHEN=(WHEN=(10401,1,CH,EQ,C'1'),
                    BUILD=(1,5200)),
        IFTHEN=(WHEN=NONE,
                    BUILD=(5201,5200))

  OUTFIL FNAMES=MATCH,SAVE,
     BUILD=(1,50,10300,100,51,212,5201,10,263,8,5230,1,271,4929) 
```

同步排序

```
 JOINKEYS FILE=F1,FIELDS=(1,7,A)              
  JOINKEYS FILE=F2,FIELDS=(20,7,A)              

  JOIN UNPAIRED,F1,F2

  REFORMAT FIELDS=(F1:1,5200,F2:1,5200),FILL=C'$'                         

  SORT FIELDS=COPY    

  OUTFIL FNAMES=NOMATCH,INCLUDE=(1,1,CH,EQ,C'$',
                          OR,5220,1,CH,EQ,C'$'),
        IFTHEN=(WHEN=(1,1,CH,EQ,C'$'),
                    BUILD=(1,5200)),
        IFTHEN=(WHEN=NONE,
                    BUILD=(5201,5200))

  OUTFIL FNAMES=MATCH,SAVE,
     BUILD=(1,50,10300,100,51,212,5201,10,263,8,5230,1,271,4929) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T06:42:13.753

大约 2 年前我使用过 JCL，所以无法为您编写代码，但这是我的想法；

1.  有2个步骤
2.  第一步将有 ICETOOl，您可以在其中将匹配的记录写入匹配的文件。
3.  其次，您可以使用 SORT/ICETOOl 或仅通过文件操作来编写不匹配的文件。

我再次为没有代码的解决方案道歉，但我已经 2 岁以上失去了联系

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-01T08:11:01.787

虽然这个问题很久以前就发布了，但我希望回答，因为它可能对其他人有所帮助。这可以通过`JOINKEYS`一个步骤轻松完成。这是伪代码：

*   编码`JOINKEYS PAIRED(implicit)`并通过重新格式化归档来获取这两个记录。如果任何一个文件都不匹配，则附加/前缀一些特殊字符说`'$'`
*   通过 IFTHEN for 比较`'$'`，如果存在则它没有配对记录，它将被写入未配对文件并保留到配对文件。

如果有任何问题，请务必回来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T08:50:00.697

```
//STEP01   EXEC SORT90MB                        
//SORTJNF1 DD DSN=INPUTFILE1,   
//            DISP=SHR                          
//SORTJNF2 DD DSN=INPUTFILE2,   
//            DISP=SHR                          
//SORTOUT  DD DSN=MISMATCH_OUTPUT_FILE, 
//            DISP=(,CATLG,DELETE),             
//            UNIT=TAPE,                        
//            DCB=(RECFM=FB,BLKSIZE=0),         
//            DSORG=PS                          
//SYSOUT   DD SYSOUT=*                          
//SYSIN    DD *                                 
  JOINKEYS FILE=F1,FIELDS=(1,79,A)              
  JOINKEYS FILE=F2,FIELDS=(1,79,A)              
  JOIN UNPAIRED,F1,ONLY                         
  SORT FIELDS=COPY                              
/* 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-21T13:30:50.737

在 Eztrieve 中，这真的很简单，下面是一个如何编写代码的示例：

```
//STEP01   EXEC PGM=EZTPA00                                        
//FILEA    DD DSN=FILEA,DISP=SHR   
//FILEB    DD DSN=FILEB,DISP=SHR
//FILEC    DD DSN=FILEC.DIF,    
//            DISP=(NEW,CATLG,DELETE),                             
//            SPACE=(CYL,(100,50),RLSE),                           
//            UNIT=PRMDA,                                          
//            DCB=(RECFM=FB,LRECL=5200,BLKSIZE=0)                  
//SYSOUT   DD SYSOUT=*                                             
//SRTMSG   DD SYSOUT=*                                             
//SYSPRINT DD SYSOUT=*                                             
//SYSIN    DD *                                                    
 FILE FILEA                                                        
   FA-KEY       1   7 A                                         
   FA-REC1      8  10 A
   FA-REC2     18   5 A

 FILE FILEB                                                        
   FB-KEY       1   7 A                                         
   FB-REC1      8  10 A                                         
   FB-REC2     18   5 A                                         

 FILE FILEC                                                        

 FILE FILED                                                        
   FD-KEY       1   7 A                                         
   FD-REC1      8  10 A                                         
   FD-REC2     18   5 A                                         

 JOB INPUT (FILEA KEY FA-KEY FILEB KEY FB-KEY)                     
   IF MATCHED            
      FD-KEY   =  FB-KEY                                      
      FD-REC1  =  FA-REC1
      FD-REC2  =  FB-REC2
      PUT FILED
   ELSE
      IF FILEA
         PUT FILEC FROM FILEA                                         
      ELSE
         PUT FILEC FROM FILEB
      END-IF                                         
   END-IF                                                          
/* 
```

# javascript - 我尝试了 serialize() 但似乎不起作用？我究竟做错了什么？

> ID：792437
> 
> 赞同：0
> 
> 时间：2009-04-27T06:36:54.827
> 
> 标签：javascript, jquery

我做了这个但没有工作

```
if(error.join()!="")
{
    $("#sub_error").fadeTo(200,0.1,function()
    {
        $("#sub_error").html(error.join("<br/><br/>")).append('<br/>
         <input type="button" name="err_ok" id="err_ok" value="ok">')
         .addClass('subboxerror').fadeTo(900,1);
     bindEvents();
    });

    function bindEvents() 
    {
        $("#err_ok").click(function() 
        {
            $("#sub_error").fadeTo(1000,0);
        });
    }
}
else
{
    $("#frm_sub")
     .removeClass().addClass('messagebox')
     .text('Submitting...').fadeIn("slow");

    $.post("register_user.php",
    { 
        $('#frm1').serialize() 
    } , 
    function(data)
    {
        alert(data);
    });
});
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T06:39:18.283

尝试：

```
$.post("register_user.php", $('#theForm').serialize(), function(data) { //... 
```

编辑：

您**不**应该将返回值包裹`('#frm1').serialize()`在花括号中。serialize 的返回值是一个字符串， post() 调用将直接传递给服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T06:41:07.750

如果您的输入元素来自表单，那么您可以使用[serialize](http://docs.jquery.com/Ajax/serialize)方法。

# asp.net-mvc - 我可以在 Ajax.ActionLink 中使用 OnSuccess 事件传递参数吗

> ID：792441
> 
> 赞同：39
> 
> 时间：2009-04-27T06:40:40.620
> 
> 标签：asp.net-mvc

当我使用：

```
new AjaxOptions
{
  UpdateTargetId = "VoteCount" + indx,
  OnSuccess = "AnimateVoteMessage"
} 
```

一切正常...但我正在尝试使用自动分配的 ID 为列表中的项目设置动画。因为我希望这些中的每一个都可以从我的 javascript 中寻址，所以我相信我需要将一个参数传递给我的 javascript。但是当我使用：

```
new AjaxOptions
{ 
  UpdateTargetId = "VoteCount" + indx,
  OnSuccess = "AnimateVoteMessage(2)"
} 
```

我得到一个“ Sys.ArgumentUndefinedException: Value cannot be undefined”。例外。好吧，当使用 MicrosoftMvcAjax.js 的调试版本时，我明白了。使用压缩版本时，我收到“Microsoft JScript 运行时错误：'b' 为空或不是对象”

`OnSuccess`所以我的问题是，我可以使用 a 的事件将参数传递给我的 javascript 函数`ActionLink`吗？

这是正确的方法吗？我如何让一个 javascript 函数能够在我的页面上的 10 个项目（在我的情况下是多个 DIV 的 ID）上运行？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-03-02T17:31:57.227

有一个更好的方法可以做到这一点 - 使用 OnSuccess 调用可以预期传递的内置参数

内置参数（到目前为止我发现的那些）是数据、状态和 xhr

data = 你从 action 方法返回的任何东西

status = 如果成功，此状态只是一个显示“成功”的字符串

xhr = 指向一堆我不会讨论的 javascript 内容的对象...

所以你会像这样定义你的javascript（你可以省略你不需要的参数——因为我们想要的只是我们从动作中返回的数据，我们只需要数据参数）

```
function myOnSuccessFunction (data)
{
   ..do stuff here with the passed in data...
} 
```

就像我之前说的，数据是 ActionResult 可能返回的任何 JSON，所以如果你的控制器操作方法看起来像这样......

```
public ActionResult MyServerAction(Guid modelId)
{
   MyModel mod = new MyModel(modelId);

   mod.DoStuff();

   return Json(mod, JsonRequestBehavior.AllowGet);
} 
```

你会像这样设置你的动作链接......

```
@Ajax.ActionLink("Do Stuff", "MyServerAction", new { modelId = Model.Id }, new     AjaxOptions { OnSuccess = "mySuccessScript(data);", OnFailure = "myFailureScript();", Confirm = "Are you sure you want to do stuff on the server?" }) 
```

这将创建一个确认消息框，询问您是否要实际调用该操作-在提示上单击“是”将调用对控制器的调用-当调用返回时-数据参数将包含您在您的返回的任何内容的 JSON 对象动作方法。十分简单！

可是等等！如果我想传递另一个自定义参数怎么办？！简单的！只需将您的论点添加到列表的前面...

而不是这个...

```
function myOnSuccessFunction (data)
{
   ..do stuff here with the passed in data...
} 
```

这样做（如果您愿意，可以有多个自定义参数，只需根据需要继续添加它们）...

```
function myOnSuccessFunction (myCustomArg, data)
{
   ..do stuff here with the passed in data and custom args...
} 
```

然后在您的设置中 - 只需通过 ActionLink 定义中的一些客户端脚本获取参数...即

```
@Ajax.ActionLink("DoStuff", "MyServerAction", new { modelId = Model.Id }, new AjaxOptions { OnSuccess = "mySuccessScript(myClientSideArg, data);", OnFailure = "myFailureScript();", Confirm = "Are you sure you want to do stuff on the server?" }) 
```

请注意，OnSuccess 参数中的“myClientSideArg”可以来自您需要的任何地方 - 只需将此文本替换为您需要的内容。

希望有帮助！

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-07-07T21:39:27.883

或者......对我有用的有点不同的语法：

```
OnSuccess = "( function() { MyFunction(arg1,arg2); } )" 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-05-07T23:04:55.240

你可以简单地做到这一点

剃刀：

```
... OnSuccess = "AnimateVoteMessage('" + YourParameter + "')" 
```

请注意单引号！

JavaScript：

```
function AnimateVoteMessage(YourParameter){
    alert(YourParameter);
} 
```

享受，

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-08-14T08:10:33.207

有一个更好的方法，我相信这就是微软的意图：将 AjaxOptions.OnSuccess 设置为函数指针，即只是函数的名称，没有参数。MVC 会自动发送参数。下面是一个例子。

JScript 参数：

```
public class ObjectForJScript
{
    List<int> Ids { get; set; }
} 
```

脚本功能：

```
function onFormSuccess(foobar){
    alert(foobar);
    alert(foobar.Ids);
    alert(foobar.Ids[0]);   
} 
```

查看代码：

```
@using (Ajax.BeginForm("ControllerAction", "ControllerName", 
    new AjaxOptions
        {
            OnSuccess = "onFormSuccess" //see, just the name of our function
        }))
{
    @Html.Hidden("test", 2)
} 
```

控制器代码：

```
public JsonResult ControllerAction(int test)
{
    var returnObject = new ObjectForJScript
        {
            Ids = new List<int>{test}
        };

    return Json(returnObject);
} 
```

请注意，JScript 函数中的参数名称无关紧要，即使控制器如此命名，您也不​​必将其称为“returnObject”。

另请注意，Json() 方便地将我们的 List 转换为 JScript 数组。只要 C# 对象的方法可以转换为 Json，您就可以像我所做的那样在 JScript 中调用它们。

最后，控制器不必返回 JsonResult，它可以是 ActionResult（但通常最好让控制器动作只做一件事）。

上面的示例将警告两个对象（Json 和它包含的数组对象），然后是 2。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-25T12:58:48.710

试试这个 - 它对我有用：

```
OnSuccess = "new Function('MyFunction(" + myParameter + ")')" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-28T12:52:35.507

用这个：

```
OnSuccess = "function(){yourfunction(" + productcode + ");}" 
```

或者

```
OnSuccess = "function(){yourfunction(this, " + productcode + ");}" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T20:28:59.490

我也遇到了这个问题......并没有找到解决它的方法！我做了一个解决方法（这不是很好，但现在解决了......也许直到有人在这里发布解决方案）......我所做的是在 TargetId div 和 OnSuccess 中放置一个隐藏字段我调用了一个 js 方法来检索隐藏字段中的值 <- 这可能发生在您的 AnimateVoteMessage 方法中...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-31T21:04:26.587

请参阅[http://www.codeproject.com/KB/ajax/Parameters-OnSuccess.aspx](http://www.codeproject.com/KB/ajax/Parameters-OnSuccess.aspx)

基本上：

```
function yourCallBack(arg1,arg2) {
        return function(result) { // Your old function
            alert(arg1);  // param will be accessible here
            alert(arg2);  // param will be accessible here
            alert(result);// result = the response returned from Ajax
        }        
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-17T05:59:14.640

简单地说，在 AjaxOptions 中，使用以下内容：

```
OnSuccess = "onSuccessFunction(data, 'Arg1');" 
```

然后在您的函数中，您将获得新值：

```
function onSuccessFunction(result, myNewArg) {
   //Prints Arg1
   Console.Write(myNewArg)
} 
```

# .net - .NET ClickOnce 部署和更新版本后调用的错误程序集

> ID：792447
> 
> 赞同：5
> 
> 时间：2009-04-27T06:43:00.897
> 
> 标签：.net, clickonce, smartclient

我有一个 ClickOnce 应用程序 (app1)，它从另一个解决方案 (app2) 调用 DLL 文件。我最近在一个客户处更新了这个应用程序，发生了一件奇怪的事情。

他得到了 app1 的新版本（发布版本在*控制面板*/*添加或删除程序*中是正确的），并且应用程序版本在应用程序中手动检查是正确的。但是从引用的解决方案 (app2) 调用的 DLL 文件仍然是旧的。

我们删除了所有文件`C:\Documents and Settings\username\Local Settings\Apps\2.0`并重新安装。这次没有问题，调用了正确的 DLL 文件。

值得一提的是，新版本中的版本号完全不同，因为我们在从 Visual Studio 2005 升级到 Visual Studio 2008 时对此进行了更改。旧/新发布版本：1.0.0.6 / 1.9.1.6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-27T06:11:48.297

这似乎是 .NET Framework 3.5 SP1 中的一个错误。

[http://support.microsoft.com/default.aspx/kb/971052](http://support.microsoft.com/default.aspx/kb/971052)

我通过以下方式修复了它：

1.  从命令提示符清除 .NET 在线缓存：“rundll32 dfshim CleanOnlineAppCache”</li>
2.  卸载所有可能引用相同问题程序集的 .NET 应用程序。
3.  重新安装所有应用程序。

# actionscript-3 - 想要使用自定义调度事件发送参数

> ID：792451
> 
> 赞同：6
> 
> 时间：2009-04-27T06:45:26.647
> 
> 标签：actionscript-3

我正在创建一个库。这是一个例子

```
[Event (name="eventAction", type="something")]
            public function create_new_customer(phone_number:String):void
    {
         -------------;
                     ----;
                     ------------;
          rpc.addEventListener(Event.COMPLETE, onCreate_returns);
    }

    private function onCreate_returns(evt:Event):void
    {
         var ob:Object = evt.target.getResponse();
         dispatchEvent(new something("eventAction"));
    } 
```

我在应用程序端有这个事件的监听器。因此，当我手动调度事件时，我希望将“ob”作为参数发送。怎么做？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-27T07:31:12.323

您需要创建一个具有额外属性的自定义事件类来传递数据。在您的情况下，您可以使用类似的类

```
public class YourEvent extends Event
{
    public static const SOMETHING_HAPPENED: String = "somethingHappend";

    public var data: Object;

    public function YourEvent(type:String, data: Object, bubbles:Boolean=false, cancelable:Boolean=false)
    {
        super(type, bubbles, cancelable);

        this.data = data;
    }

    override public function clone():Event
    {
        return new YourEvent (type, data, bubbles, cancelable);
    }

} 
```

那么当你派遣你做：

```
dispatchEvent(new YourEvent(YourEvent.SOMETHING_HAPPENED, ob)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-29T22:58:12.177

在 AS3 中，您可以使用 DataEvent：

前任：

调度事件（新数据事件（类型：字符串[，气泡：布尔=假，可取消：布尔=假，数据：字符串]）；

我展示了 DataEvent 采用的参数，而不是示例数据。

我希望这有帮助。

最好的问候，RA。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T07:27:51.240

让您的自定义事件携带此`ob`对象。将其传递给自定义事件的 ctor，瞧！

# mfc - 基于 MFC 容器的应用程序

> ID：792453
> 
> 赞同：0
> 
> 时间：2009-04-27T06:47:34.753
> 
> 标签：mfc

我有一个完全准备好的基于 Doc-View 架构的项目。但现在我想将它转换为基于容器的应用程序，为现有项目提供 OLE 支持。如果有人知道如何转换，请尽快回复。我只需要一种无需将现有代码复制粘贴到基于新容器的应用程序的方法-我尝试过-即使在设置更改后也无法正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T07:55:47.833

[这里](http://msdn.microsoft.com/en-us/library/ms177529.aspx)有一个很好的例子。基本上，您的所有 CDocument 派生类现在都必须从 COLEDocument 派生，并且您需要在 WinApp.InitInstance 中添加一些额外的代码。

如果您发布您尝试过的代码，您可能会得到有关问题所在的更详细的响应。

# parsing - 解析类 C 定义字符串的最有效方法？

> ID：792454
> 
> 赞同：5
> 
> 时间：2009-04-27T06:48:05.453
> 
> 标签：parsing, yacc, flex-lexer

我有一组用类 C 语言编写的函数定义，其中一些附加关键字可以放在一些参数之前（例如，与“无符号”或“寄存器”相同），我需要分析这些行以及一些函数存根并从中生成实际的 C 代码。

*   Flex/Yacc 是最合适的方法，这对吗？

*   如果我对分析器/解析器的经验为零，它是否会比使用正则表达式编写 Shell 或 Python 脚本慢（我想，如果附加关键字的数量变得更大并且它们的效果会相当不同，这可能会变得很痛苦） （虽然我知道 LALR 是如何工作的）？

*   Lex/Yacc 上是否有涵盖类似问题的好材料？我能找到的所有论文都使用相同的“玩具”计算器的原始示例。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T06:51:13.667

[ANTLR](http://www.antlr.org/)是常用的（与 Lex\Yacc 一样）。

> ANTLR，另一种语言识别工具，是一种语言工具，它提供了一个框架，用于从包含各种目标语言动作的语法描述构建识别器、解释器、编译器和翻译器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T08:47:03.420

还有[Lemon Parser](http://www.hwaci.com/sw/lemon/)，它的语法限制较少。不利的一面是你嫁给了柠檬，当你发现一些限制很糟糕时，将解析器的语法重写为其他东西。好的一面是它真的很容易使用..而且是独立的。您可以将其放在树中，而不必担心检查其他人的存在。

[SQLite3](http://www.sqlite.org/)使用它，其他几个流行的项目也是如此。我不是说使用它，因为 SQLite 确实如此，但如果时间允许，也许可以尝试一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-06T01:57:13.310

实际上，这取决于您的语言有多复杂以及它是否真的接近 C...

尽管如此，即使对于正则表达式，您也可以将 lex 作为第一步......

我会选择 lex + menhir 和 o'caml....

但是任何 flex/yacc 组合都可以。

常规野牛（yacc 的 gnu 实现）的主要问题源于 C 类型。你必须描述你的整个树（以及所有操作函数）......使用 o'caml 会更容易......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T08:38:39.323

这完全取决于您对“有效”的定义。如果您拥有世界上所有的时间，最快的解析器将是一个手写的拉解析器。它们需要很长时间来调试和开发，但今天，在运行时性能方面，没有解析器生成器能胜过手写代码。

如果您想要可以在一周左右的时间内解析有效 C 的东西，请使用解析器生成器。代码将足够快，并且大多数解析器生成器都带有 C 语法，您可以将其用作起点（避免 90% 的常见错误）。

请注意，正则表达式不适合解析递归结构。这种方法既比使用生成器慢，又比手写拉解析器更容易出错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-24T11:30:13.067

对于您想做的事情，我们的[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit)可能是一个非常有效的解决方案。

DMS 专门设计用于支持您正在讨论的类型的客户分析器/代码生成器。它为定义任意语言解析器/分析器提供了非常强大的工具（在 30 多种真实语言上进行了测试，包括 C、C++、Java、C# 和 COBOL 的几种完整方言）。

DMS 自动构建 AST（因此您无需做任何事情，只需获得正确的语法即可拥有可用的 AST），能够构建您指定的模式导向检查的自定义分析，可以构建新的 C 特定代表您要生成的代码的 AST，并将它们作为可编译的 C 源文本输出。用于 DMS 的 C 的预先存在的定义可能会弯曲以涵盖您的类 C 语言。

# algorithm - 如何在保留总和的同时将浮点数舍入为整数？

> ID：792460
> 
> 赞同：63
> 
> 时间：2009-04-27T06:53:15.880
> 
> 标签：algorithm, language-agnostic, rounding

假设我有一个浮点数数组，按排序（假设升序）顺序，其总和已知为 integer `N`。我想将这些数字“四舍五入”为整数，同时保持它们的总和不变。换句话说，我正在寻找一种将浮点数数组（调用它 `fn`）转换为整数数组（调用它`in`）的算法，这样：

1.  两个数组的长度相同
2.  整数数组的总和是`N`
3.  每个浮点数`fn[i]`与其对应的整数之间`in[i]`的差小于 1（如果确实必须，则等于 1）
4.  鉴于浮点数按排序顺序 ( `fn[i] <= fn[i+1]`)，整数也将按排序顺序 ( `in[i] <= in[i+1]`)

鉴于满足这四个条件，最小化舍入方差 ( `sum((in[i] - fn[i])^2)`) 的算法是可取的，但这并不是什么大问题。

例子：

```
[0.02, 0.03, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14]
    => [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
[0.1, 0.3, 0.4, 0.4, 0.8]
    => [0, 0, 0, 1, 1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
    => [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
[0.4, 0.4, 0.4, 0.4, 9.2, 9.2]
    => [0, 0, 1, 1, 9, 9] 更可取
    => [0, 0, 0, 0, 10, 10] 是可以接受的
[0.5, 0.5, 11]
    => [0, 1, 11] 很好
    => [0, 0, 12] 在技术上是不允许的，但我会在紧要关头接受它

```

要回答评论中提出的一些很好的问题：

*   两个数组中都允许重复元素（尽管我也有兴趣了解仅在浮点数组不包含重复时才有效的算法）
*   没有单一的正确答案 - 对于给定的浮点输入数组，通常有多个整数数组满足四个条件。
*   我想到的应用程序是 - 这有点奇怪 - 在马里奥赛车游戏中将积分分配给顶级选手 ;-) 我自己从未真正玩过这款游戏，但在观看其他人时，我注意到有 24 分分布在前 4 名完成者，我想知道如何根据完成时间分配积分（因此，如果某人以较大的领先优势完成比赛，他们将获得更大的积分份额）。游戏将总点数作为整数进行跟踪，因此需要这种四舍五入。

* * *

对于好奇的人，这是我用来确定哪些算法有效[的测试脚本。](http://static.ellipsix.net/ext-tmp/roundingtest.py)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-27T07:06:50.573

您可以尝试的一种选择是“级联舍入”。

对于此算法，您需要跟踪两个运行总计：到目前为止的浮点数之一和迄今为止的整数之一。要获得下一个整数，请将下一个 fp 数添加到运行总数中，四舍五入运行总数，然后从四舍五入的运行总数中减去整数运行总数：-

```
number  running total   integer integer running total
   1.3       1.3          1           1
   1.7       3.0          2           3
   1.9       4.9          2           5
   2.2       8.1          3           8
   2.8      10.9          3          11
   3.1      14.0          3          14 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-27T07:17:01.157

这是一种应该完成任务的算法。与其他算法的主要区别在于，这个算法总是以正确的顺序对数字进行四舍五入。**最小化舍入误差。**

该语言是一些可能源自 JavaScript 或 Lua 的伪语言。应该说明点。请注意基于一个的索引（对于循环，x 到 y 更好。：p）

```
// Temp array with same length as fn.
tempArr = Array(fn.length)

// Calculate the expected sum.
arraySum = sum(fn)

lowerSum = 0
-- Populate temp array.
for i = 1 to fn.lengthf
    tempArr[i] = { result: floor(fn[i]),              // Lower bound
                   difference: fn[i] - floor(fn[i]),  // Roundoff error
                   index: i }                         // Original index

    // Calculate the lower sum
    lowerSum = lowerSum + tempArr[i].result
end for

// Sort the temp array on the roundoff error
sort(tempArr, "difference")

// Now arraySum - lowerSum gives us the difference between sums of these
// arrays. tempArr is ordered in such a way that the numbers closest to the
// next one are at the top.
difference = arraySum - lowerSum

// Add 1 to those most likely to round up to the next number so that
// the difference is nullified.
for i = (tempArr.length - difference + 1) to tempArr.length
    tempArr.result = tempArr.result + 1
end for

// Optionally sort the array based on the original index.
array(sort, "index") 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-27T07:05:23.680

一种非常简单的方法是把所有的小数部分加起来。根据您的问题的定义，该数字必须是整数。从最大的数字开始均匀分配该整数。然后给第二大的数字...等等，直到你用完要分发的东西。

**请注意**，这是伪代码......并且可能会在索引中偏离一个......它已经很晚了，我很困。

```
float accumulator = 0;

for (i = 0; i < num_elements; i++)  /* assumes 0 based array */
{
   accumulator += (fn[i] - floor(fn[i])); 
   fn[i] =  (fn[i] - floor(fn[i]);
}

i = num_elements;

while ((accumulator > 0) && (i>=0))
{
    fn[i-1] += 1;   /* assumes 0 based array */
    accumulator -= 1;
    i--;
} 
```

**更新：**还有其他方法可以根据对每个值执行多少截断来分配累积值。这需要保留一个单独的列表，称为 loss[i] = fn[i] - floor(fn[i])。然后，您可以重复 fn[i] 列表并重复给最大损失项 1（之后将 loss[i] 设置为 0）。它很复杂，但我想它有效。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T07:28:45.497

怎么样：

```
a) start: array is [0.1, 0.2, 0.4, 0.5, 0.8], N=3, presuming it's sorted
b) round them all the usual way: array is [0 0 0 1 1]
c) get the sum of the new array and subtract it from N to get the remainder.
d) while remainder>0, iterate through elements, going from the last one
   - check if the new value would break rule 3.
   - if not, add 1
e) in case that remainder<0, iterate from first one to the last one
   - check if the new value would break rule 3.
   - if not, subtract 1 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T07:11:59.953

基本上你要做的是在四舍五入后将剩菜分配给最有可能的候选人。

1.  像往常一样对浮点数进行舍入，但要跟踪从舍入和相关索引到`fn`and的增量`in`。
2.  按增量对第二个数组进行排序。
3.  虽然`sum(in) < N`，从最大的负增量向前工作，增加舍入值（确保您仍然满足规则＃3）。
4.  或者， while `sum(in) > N`，从最大的正增量向后工作，减少舍入值（确保您仍然满足规则 #3）。

例子：

```
[0.02, 0.03, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14] N=1

1\. [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] sum=0
和 [[-0.02, 0], [-0.03, 1], [-0.05, 2], [-0.06, 3], [-0.07, 4], [-0.08, 5],
     [-0.09, 6], [-0.1, 7], [-0.11, 8], [-0.12, 9], [-0.13, 10], [-0.14, 11]]

2.排序会反转数组

3\. 从最大的负余数开始计算，得到 [-0.14, 11]。
增加 `in[11]` 得到 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1] sum=1
完毕。
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T07:03:51.657

你可以试试这样的东西吗？

```
in [i] = fn [i] - int (fn [i]);
fn_res [i] = fn [i] - in [i]; 
```

fn_res → 是结果分数。（我认为这是基本的......），我们错过了什么吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T07:08:09.120

嗯，4是痛点。否则，您可以执行诸如“通常向下取整并累积剩余部分；当累加器 >= 1 时向上取整”之类的操作。（编辑：实际上，只要您交换他们的位置，那可能仍然可以？）

可能有一种方法可以通过线性规划来做到这一点？（这是数学“编程”，而不是计算机编程——你需要一些数学来找到可行的解决方案，尽管你可能会跳过通常的“优化”部分）。

作为线性规划的一个例子 - 对于例子 [1.3, 1.7, 1.9, 2.2, 2.8, 3.1] 你可以有规则：

```
1 <= i < 2
1 <= j < 2
1 <= k < 2
2 <= l < 3
3 <= m < 4
i <= j <= k <= l <= m
i + j + k + l + m = 13 
```

然后应用一些线性/矩阵代数；-p 提示：有一些产品可以基于“Simplex”算法之类的东西来完成上述操作。普通的大学饲料，也是（我在大学为我的期末项目写了一个）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-27T07:26:42.677

在我看来，问题在于没有指定排序算法。或者更像 - 无论它是否稳定。

考虑以下浮点数组：

[ 0.2 0.2 0.2 0.2 0.2 ]

总和为 1。那么整数数组应该是：

[ 0 0 0 0 1 ]

但是，如果排序算法不稳定，它可以将“1”排序到数组中的其他位置......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T07:26:34.393

使总的差异小于 1，并检查以进行排序。有些人喜欢，

```
while(i < sizeof(fn) / sizeof(float)) {
    res += fn[i] - floor(fn[i]);
    if (res >= 1) {
        res--;
        in[i] = ceil(fn[i]);
    }
    else
        in[i] = floor(fn[i]);
    if (in[i-1] > in[i])
        swap(in[i-1], in[i++]);
} 
```

（这是纸质代码，所以我没有检查有效性。）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-11T21:58:32.023

在@mikko-rantanen 的代码的python 和numpy 实现下面。我花了一点时间把这些放在一起，所以这可能对未来的谷歌人有所帮助，尽管这个话题已经很老了。

```
import numpy as np
from math import floor

original_array = np.array([1.2, 1.5, 1.4, 1.3, 1.7, 1.9])

# Calculate length of original array
# Need to substract 1, as indecies start at 0, but product of dimensions
# results in a count starting at 1
array_len = original_array.size - 1 # Index starts at 0, but product at 1

# Calculate expected sum of original values (must be integer)
expected_sum = np.sum(original_array)

# Collect values for temporary array population
array_list = []
lower_sum = 0
for i, j in enumerate(np.nditer(original_array)):
    array_list.append([i, floor(j), j - floor(j)]) # Original index, lower bound, roundoff error
# Calculate the lower sum of values
lower_sum += floor(j)

# Populate temporary array
temp_array = np.array(array_list)

# Sort temporary array based on roundoff error
temp_array = temp_array[temp_array[:,2].argsort()]

# Calculate difference between expected sum and the lower sum
# This is the number of integers that need to be rounded up from the lower sum
# The sort order (roundoff error) ensures that the value closest to be
# rounded up is at the bottom of the array
difference = int(expected_sum - lower_sum)

# Add one to the number most likely to round up to eliminate the difference
temp_array_len, _ = temp_array.shape
for i in xrange(temp_array_len - difference, temp_array_len):
    temp_array[i,1] += 1

# Re-sort the array based on original index
temp_array = temp_array[temp_array[:,0].argsort()]

# Return array to one-dimensional format of original array
array_list = []
for i in xrange(temp_array_len):
    array_list.append(int(temp_array[i,1]))
new_array = np.array(array_list) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-17T08:44:33.930

计算`sum of floor`和`sum of numbers`。四舍五入`sum of numbers`，减去`sum of floor`，不同的是我们需要修补多少天花板（我们需要多少`+1`）。将数组按照上限与数字的差异从小到大进行排序。

对于`diff`时间（`diff`是我们需要修补多少天花板），我们将结果设置为`ceiling of number`。其他人将结果设置为`floor of numbers`。

```
public class Float_Ceil_or_Floor {

public static int[] getNearlyArrayWithSameSum(double[] numbers) {

    NumWithDiff[] numWithDiffs = new NumWithDiff[numbers.length];
    double sum = 0.0;
    int floorSum = 0;
    for (int i = 0; i < numbers.length; i++) {
        int floor = (int)numbers[i];
        int ceil = floor;
        if (floor < numbers[i]) ceil++; // check if a number like 4.0 has same floor and ceiling
        floorSum += floor;
        sum += numbers[i];
        numWithDiffs[i] = new NumWithDiff(ceil,floor, ceil - numbers[i]);
    }

    // sort array by its diffWithCeil
    Arrays.sort(numWithDiffs, (a,b)->{
        if(a.diffWithCeil < b.diffWithCeil)  return -1;
        else return 1;
    });

    int roundSum = (int) Math.round(sum);
    int diff = roundSum - floorSum;
    int[] res = new int[numbers.length];

    for (int i = 0; i < numWithDiffs.length; i++) {
        if(diff > 0 && numWithDiffs[i].floor != numWithDiffs[i].ceil){
            res[i] = numWithDiffs[i].ceil;
            diff--;
        } else {
            res[i] = numWithDiffs[i].floor;
        }
    }
    return res;
}
public static void main(String[] args) {
    double[] arr = { 1.2, 3.7, 100, 4.8 };
    int[] res = getNearlyArrayWithSameSum(arr);
    for (int i : res) System.out.print(i + " ");

} 
```

}

```
class NumWithDiff {
    int ceil;
    int floor;
    double diffWithCeil;
    public NumWithDiff(int c, int f, double d) {
        this.ceil = c;
        this.floor = f;
        this.diffWithCeil = d;
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-28T13:18:03.093

在不最小化方差的情况下，这是一个微不足道的：

1.  从左到右对值进行排序。
2.  全部向下舍入到下一个整数。
3.  让这些整数的总和为 K。将 NK 最右边的值增加 1。
4.  恢复原来的秩序。

这显然满足您的条件 1.-4。或者，您可以四舍五入到最接近的整数，并增加已向下舍入的 NK。您可以通过原始值和舍入值之间的差异贪婪地做到这一点，但每次舍入值只能从右向左增加，以保持排序顺序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-02-01T10:03:01.027

如果您可以在改善方差的同时接受总数的微小变化，这将在概率上保留 python 中的总数：

```
import math
import random
integer_list = [int(x) + int(random.random() <= math.modf(x)[0]) for x in my_list] 
```

为了解释它，将所有数字向下舍入并以等于小数部分的概率加一，即十分之一`0.1`将变为`1`，其余的将变为`0`

这适用于将大量小数人转换为 1 人或 0 人的统计数据

# java - Java：填充两个向量并对它们进行排序

> ID：792461
> 
> 赞同：0
> 
> 时间：2009-04-27T06:53:30.747
> 
> 标签：java, vector, comparator

如何填充两个向量并将它们相互组合（索引或类中的对象类型）。我想如果我使用索引来组合它们，那么排序可以用 Collections.sort 处理，否则我必须创建一个比较器。

我们必须按照 Java 1.4 约定进行编码。

让你的想象更轻松；它是一个具有排序向量（行）和内容向量（所有列）的网格。它们需要填充到向量中并进行排序。

上下文：我有一个 GridBagLayout，其中包含以奇怪的顺序排列的所有组件。我需要循环浏览所有组件并以正确的网格顺序（gridx，gridy）填充它们。对于那个解决方案，我考虑了两个向量，一个定义行并指向包含它的 cols 的向量。要么在填充向量时解决排序问题，要么我必须在第二步对其进行排序。我猜对于 java 4，除了包含一个对象的两个向量之外没有其他方法，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T08:30:19.157

OO 解决方案是将两个向量中的对象包装在某种东西中，以实现比较并保留指向真实对象的指针。这样，您可以对彼此独立的两个向量进行排序，并使用包装器来获取真实对象。

这就是“装饰者”设计模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T07:03:12.610

如果我理解，请告诉我。作为输入，您将获得两个向量。第一个是引用第二个向量中索引的行号的有序列表。第二个向量是一些东西的列表。您想要一个包含与第二个向量相同的对象的向量，但按第一个向量中描述的顺序排序。

假设这就是你想要做的，这就是我的做法：

```
public class ThisHadBetterNotBeAHomeworkAssignmentYoungMan {

    public Vector orderContent(Vector indices, Vector content) {
       Object[] orderedStuff = new Object[content.size()];
       for( int i=0; i < indices.size(); i++ ) {
          orderedStuff[i] = content.get(((Integer)indices[i]).intVal());
       }
       return new Vector(orderedStuff);
    }
} 
```

//请注意，这是非常粗略的代码，我既没有执行它，也没有费心检查你是否可以将一组东西作为构造函数传递给 Vector，但你明白了。

//另请注意，我不确定您要问的确切内容，并且可能完全错误。

# asp.net - 自定义验证器

> ID：792469
> 
> 赞同：-3
> 
> 时间：2009-04-27T07:03:11.860
> 
> 标签：asp.net, vb.net, validation

我想使用验证器以这样的方式比较 2 个文本框，

如果 V 在文本框 1 中，则表示用户必须在文本框 2 中键入任何前缀 V 的数字（V00001 到 V00050）。除了 V 之外，如果他们键入任何其他字母，则表示必须显示错误消息。

就像如果 C 在 TextBox 1 中意味着用户必须在 TextBox2 中键入 C00001。（或从 C00001 到 C00050 的任何数字） iF S 在文本框 1 中意味着，用户必须键入 S00001（S00001 到 S00050）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:12:52.607

使用此方法：

```
// C#
public static bool IsValid(string textBox1Text, string textBox2Text)
{
    return new System.Text.RegularExpressions.Regex(@"^" + textBox1Text + "000[0-4][0-9]$").IsMatch(textBox2Text) || string.Equals(textBox2Text, textBox1Text + "00050");
}

' VB
Public Shared Function IsValid(ByVal textBox1Text As String, ByVal textBox2Text As String) As Boolean
    Return New System.Text.RegularExpressions.Regex("^" + textBox1Text + "000[0-4][0-9]$").IsMatch(textBox2Text) OrElse String.Equals(textBox2Text, textBox1Text + "00050")
End Function 
```

# regex - 匹配引号中的文本（新手）

> ID：792474
> 
> 赞同：6
> 
> 时间：2009-04-27T07:05:55.287
> 
> 标签：regex, shell, pattern-matching

我完全迷失在 shell 编程中，主要是因为我使用的每个站点都提供了不同的工具来进行模式匹配。所以我的问题是使用什么工具在管道流中进行简单的模式匹配。

上下文：我有 named.conf 文件，我需要一个简单文件中的所有区域名称以进行进一步处理。所以我做~$ cat named.local | grep zone 并在这里完全迷失。我的输出是 'zone "domain.tld" {' 形式的约一百个换行符，我需要双引号中的文本。

感谢您展示了一种方法。

Ĵ

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-27T07:18:12.603

我认为您正在寻找的是`sed`……它是一个**流**式**编辑**器，可让您逐行进行替换。

正如您所解释的那样，命令 `cat named.local | grep zone' 给你一个有点像这样的输出：

```
zone "domain1.tld" {
zone "domain2.tld" {
zone "domain3.tld" {
zone "domain4.tld" { 
```

我猜你希望输出是这样的，因为你说你需要双引号中的文本：

```
"domain1.tld"
"domain2.tld"
"domain3.tld"
"domain4.tld" 
```

因此，实际上，从每一行中，我们只需要双引号之间的文本（包括双引号本身。）

我不确定您是否熟悉[正则表达式](http://www.regular-expressions.info/)，但对于任何编写 shell 脚本的人来说，它们都是非常宝贵的工具。例如，正则表达式`/.o.e/`将匹配任何第 2 个字母为小写字母`o`且第 4个字母为 的单词的行`e`。这将匹配包含诸如“ `zone`”、“ `tone`”甚至“ `I am tone-deaf.`”之类的单词的字符串

诀窍是使用`.`（点）字符来表示“任何字母”。还有一些其他特殊字符，例如`*`表示“将前一个字符重复 0 次或更多次”。因此，正则表达式 like`a*`将匹配“ `a`”、“ `aaaaaaa`”或空字符串：“”

因此，您可以使用以下方式匹配引号内的字符串：`/".*"/`

还有一件事你会知道`sed`（通过评论，你已经知道了！） - 它允许*回溯*。一旦你告诉它如何识别一个词，你就可以让它使用那个词作为替换的一部分。例如，假设您想翻转此列表：

```
Billy "The Kid" Smith
Jimmy "The Fish" Stuart
Chuck "The Man" Norris 
```

进入这个列表：

```
The Kid
The Fish
The Man 
```

首先，您将在引号内查找字符串。我们已经看到了，它是`/".*"/`。

接下来，我们要使用引号内的内容。我们可以使用括号对其进行*分组：*`/"(.*)"/`

如果我们想用带下划线的引号替换文本，我们会做一个 replace: `s/"(.*)"/_/`，这将给我们留下：

```
Billy _ Smith
Jimmy _ Stuart
Chuck _ Norris 
```

但我们有回溯！这将让我们回忆一下括号内的内容，使用符号`\1`. 因此，如果我们现在这样做：`s/"(.*)"/\1/`我们将得到：

```
Billy The Kid Smith
Jimmy The Fish Stuart
Chuck The Man Norris 
```

因为引号不在括号中，所以它们不是`\1`!

为了只将内容留在双引号内，我们需要匹配整行。为此，我们有`^`（意思是“行首”）和`$`（意思是“行尾”。）

所以现在如果我们使用`s/^.*"(.*)".*$/\1/`，我们会得到：

```
The Kid
The Fish
The Man 
```

为什么？`s/^.*"(.*)".*$/\1/`让我们从左到右阅读正则表达式：

*   `s/`- 开始一个**替换**正则表达式
*   `^`- 寻找行首。从那里开始。
*   `.*`- 继续，阅读每个字符，直到...
*   `"`- ...直到你到达双引号。
*   `(`- 开始一组我们可能希望稍后回溯时回忆的角色。
*   `.*`- 继续，阅读每个字符，直到...
*   `)`- （pssst！关闭组！）
*   `"`- ...直到你到达双引号。
*   `.*`- 继续，阅读每个字符，直到...
*   `$`- 线的尽头！

*   `/`- 使用之后的内容来替换您匹配的内容

*   `\1`- 粘贴匹配的第一组（括号中的内容）的内容。
*   `/`- 正则表达式结束

用简单的英语：“阅读整行，复制双引号之间的文本。然后用双引号之间的内容替换整行。”

您甚至可以在替换文本周围添加双引号`s/^.*"(.*)".*$/"\1"/`，因此我们将得到：

```
"The Kid"
"The Fish"
"The Man" 
```

这可以用于`sed`将行替换为引号中的内容：

```
sed -e "s/^.*\"\(.*\)\".*$/\"\1\"/" 
```

（这只是外壳转义以处理双引号和斜杠等。）

所以整个命令将类似于：

```
cat named.local | grep zone | sed -e "s/^.*\"\(.*\)\".*$/\"\1\"/" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T11:28:58.070

好吧，还没有人提到`cut`，所以，为了证明有很多方法可以用 shell 做某事：

```
% grep '^zone' /etc/bind/named.conf  | cut -d' ' -f2
"gennic.net"
"generic-nic.net"
"dyn.generic-nic.net"
"langtag.net" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T07:27:48.603

1.

```
zoul@naima:etc$ cat named.conf | grep zone
zone "." IN {
zone "localhost" IN {
    file "localhost.zone";
zone "0.0.127.in-addr.arpa" IN { 
```

2.

```
zoul@naima:etc$ cat named.conf | grep ^zone
zone "." IN {
zone "localhost" IN {
zone "0.0.127.in-addr.arpa" IN { 
```

3.

```
zoul@naima:etc$ cat named.conf | grep ^zone | sed 's/.*"\([^"]*\)".*/\1/'
.
localhost
0.0.127.in-addr.arpa 
```

正则表达式是`.*"\([^"]*\)".*`，它匹配：

1.  任意数量的任意字符：`.*`
    *   报价：`"`
    *   以后开始记住：`\(`
    *   除引号外的任何字符：`[^"]*`
    *   结束组要记住：`\)`
    *   结束语：`"`
    *   和任意数量的字符：`.*`

调用`sed`时，语法为`'s/what_to_match/what_to_replace_it_with/'`. 单引号可以防止您的正则表达式被`bash`. 当您使用括号“记住”正则表达式中的某些内容时，您可以将其召回为`\1`等`\2`。摆弄一会儿。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T07:24:15.150

你应该看看[awk](http://en.wikipedia.org/wiki/AWK)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T15:41:01.710

只要有人指出 sed/awk，我就会指出 grep 是多余的。

```
sed -ne '/^zone/{s/.*"\([^"]*\)".*/\1/;p}' /etc/bind/named.conf 
```

这为您提供了不带引号的内容（将引号移动到括号内以保留它们）。在 awk 中，使用引号更简单：

```
awk '/^zone/{print $2}' /etc/bind/named.conf 
```

我尽量避免使用管道（但不是更多）。记住，[不要管 cat](http://unixfoo.blogspot.com/2007/11/dont-pipe-cat.html)。这不是必需的。而且，只要 awk 和 sed 复制 grep 的工作，也不要使用管道 grep。至少，不会变成 sed 或 awk。

就个人而言，我可能会使用 perl。但那是因为我可能已经完成了你在 perl 中所做的任何其他事情，使它成为一个小细节（并且能够同时将整个文件和正则表达式对所有内容进行 slurp，忽略 \n's 将是一个奖励我不控制 /etc/bind，例如在共享虚拟主机上）。但是，如果我要在 shell 中执行此操作，则上述两种方法中的一种将是我处理它的方式。

# ruby-on-rails - 如何始终在 Rails 中设置帐户范围的值？

> ID：792475
> 
> 赞同：4
> 
> 时间：2009-04-27T07:06:25.660
> 
> 标签：ruby-on-rails, scope, account, user-accounts

我正在开发一个多用户、多帐户应用程序，其中 1 个帐户可以有 n 个用户。每个用户只能从其帐户访问信息，这一点非常重要。我的方法是为数据库中的每个模型添加一个 account_id，然后在每个控制器中添加一个过滤器以仅选择具有当前 account_id 的对象。我将使用授权插件。

这种方法是个好主意吗？

什么是最好的方法来始终为每个创建的对象设置 account_id 而无需编写

```
object.account = @current_account 
```

在每个 CREATE 动作中？也许是过滤器？

此外，我不确定为选择选项实施过滤器的最佳方法。我需要一个类似一般条件的东西：无论 SQL 语句中出现什么其他内容，总有一个“WHERE account_id = XY”。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T07:16:38.583

这类似于 User.has_many :emails 场景。您不希望用户通过更改 URL 中的 ID 来查看其他人的电子邮件，因此您可以这样做：

```
@emails = current_user.emails 
```

在您的情况下，您可能可以执行以下操作：

```
class ApplicationController < ActionController::Base
  def current_account
    @current_account ||= current_user && current_user.account
  end
end

# In an imagined ProjectsController
@projects = current_account.projects
@project = current_account.projects.find(params[:id]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T07:59:05.440

我知道，我知道，如果您在模型中访问会话变量或实例变量，那么您不了解 MVC 模式并且“应该回到 PHP”。但是，如果您像我们一样拥有很多控制器和操作，但您并不总是想编写 @current_account.object.do_something（不是很干），这仍然非常有用。

我找到的解决方案非常简单：

第 1 步：将您的 current_account 添加到 Thread.current，例如

```
class ApplicationController < ActionController::Base
  before_filter :get_current_account      

  protected
   def get_current_account
     # somehow get the current account, depends on your approach
     Thread.current[:account] = @account
   end
end 
```

第 2 步：为所有模型添加 current_account 方法

```
 #/lib/ar_current_account.rb
   ActiveRecord::Base.class_eval do
     def self.current_account
      Thread.current[:account]
     end
   end 
```

第 3 步：瞧，在您的模型中，您可以执行以下操作：

```
class MyModel < ActiveRecord::Base

  belongs_to :account

  # Set the default values
  def initialize(params = nil) 
    super
      self.account_id ||= current_account.id
  end

end 
```

您还可以使用 active_record 中的 before_validation 回调之类的东西，然后通过验证确保始终设置帐户。

如果您总是想将 current_user 添加到每个创建的对象，则可以使用相同的方法。

你怎么看？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T08:30:17.580

要回答您的第二个问题，请查看[`default_scope`](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002258)Rails 2.3 中的新功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-11T11:45:54.693

我知道您不想一直为您的帐户范围而烦恼。老实说，这是一个痛苦的**。

要添加一点魔力并无缝完成此范围界定，请查看以下 gem

[http://gemcutter.org/gems/account_scopper](http://gemcutter.org/gems/account_scopper)

希望这可以帮助，

-- 塞巴斯蒂安·格罗斯让 - ZenCocoon

# java - Java 到 JSP。如何？

> ID：792479
> 
> 赞同：1
> 
> 时间：2009-04-27T07:09:03.220
> 
> 标签：java, jsp

我编写了一个当前作为桌面应用程序运行的 java 程序，

它根据控制台的要求准确地返回所有结果。我现在面临着将这个应用程序转换为 Web 应用程序 (JSP) 的挑战。

目前，我的项目的代码在用户/工作区中（因为我正在使用 eclipse）

我的tomcat已经安装在c:/server/tomcat..

我基本上是一个 .net 开发人员，并且对 Java Web 开发有一些了解。有人可以指导我如何将我当前的项目转换为 Web 应用程序吗？

如何将项目包含在 jsp 文件中的用户/工作区中？以前没有做过，所以它像地狱一样令人困惑。

如果您能指出正确的方向，或者甚至提供一些链接以便我可以将其用作指针，那将是最有帮助的

提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T07:50:26.380

我建议不要再使用 JSP 技术，除非你必须（-> 客户要求它）。

相反，获取 GWT 或 Grails。两者都附带了在 Eclipse 中从头开始设置项目的工具，该项目可以编译并且可以通过按下按钮来运行。此外，这两种技术都比 JSP 先进得多，作为 .Net 开发人员，您会发现它们更易于理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T08:08:40.020

如果您只想在 html 页面中显示输出，那么最简单的方法仍然是使用 jsp。

您可以按照 kgiannakakis[回答中的说明进行操作](https://stackoverflow.com/questions/792479/java-to-jsp/792532#792532)

如果您的类已经返回了一个具有良好输出的字符串，那么您需要的一切都可以做到这一点。

```
<%
MyClass = new MyClass();

%>

<pre>  <%-- pure html, preformatted --%>
<%= myClass.formattedStuff();    %>
</pre> 
```

不过，没有花哨的 html 格式。只是一个文本转储。

您可以使用 for 循环和 if 子句等等，因为 <% %> 之间的所有内容都是正常的 java。

如果您需要更多功能，您可能根本不应该使用 jsp。（而且绝对不使用 JSTL，如果您不打算开始为大企业编写 Web 应用程序的职业，那将完全是浪费时间。

也许GWT :-) 它几乎是java。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T07:36:12.797

我建议阅读 JSP 教程。这并不难。为了让您快速入门，这些是必需的步骤：

*   创建一个 Web 应用程序。最好使用 Eclipse 或 Netbeans 之类的 IDE 来执行此操作。一个快速而肮脏的解决方案是在Tomcat中的webapps/ROOT下创建jsp
*   jsp 就像一个带有一些特殊标签的 html 文件，允许它运行 java 代码。

这是包含类或包的方式：

```
<%@ page language="java" import="mypackage.MyClass" %> 
```

您将 Java 代码放在 <% %> 中。您实际上可以将所有的 java 代码放在那里。

*   将控制台应用程序中的 System.out.println 替换为以下标记：

mymessage 将直接打印在 html 源中。

*   最后启动Tomcat并指向你的jsp文件。

对于初学者，我建议从 Eclipse 或 Netbeans 教程开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T07:42:56.600

将项目转换为 Web 项目的技术部分相当简单。您可以使用 eclipse 简单地创建一个新的静态或动态 Web 项目并将您的代码复制到该项目的源目录中。谷歌它，你就在那里。下一步可能是了解您的应用程序是如何部署的，以及如何配置它。请记住，您在此处切换架构。Web 应用程序是在带有一些规则的 servlet 容器中执行的客户端服务器应用程序，除非您需要做的只是将一些文本打印到浏览器中。

我建议你从这里开始阅读：http: [//java.sun.com/j2ee/tutorial/1_3-fcs/doc/Servlets.html#99975](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/Servlets.html#99975) [http://java.sun.com/j2ee/tutorial/1_3-fcs /doc/JSIntro.html](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/JSPIntro.html)

第一个链接指的是 Servlet，我首先指出 Servlets 的原因是 JSP 实际上是 servlet，而且 servlet 更容易开始。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T08:18:50.040

试试这个，[http://simple.souther.us](http://simple.souther.us)它有一切让你开始。

# javascript - 内联函数和其他方法的范围

> ID：792485
> 
> 赞同：1
> 
> 时间：2009-04-27T07:14:17.153
> 
> 标签：javascript, scope, inline

如何使 myFunction 对 .ready() 事件中的内联函数可见？

```
$(document).ready(function() {
  ...stuffs...
  myFunction(par1, par2, anotherFucntion_callback);
 }
);

function anotherFunction_callback(data) {
 ..stuffs..
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T07:28:25.047

您使用函数的实际名称，即`myFunction_callback`代替`myFunction`or `anotherFucntion_callback`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T07:43:25.680

我没完全听懂你的问题。你的意思是你想传递“myFunction_callback(data)”作为你的最后一个参数：

```
myFunction(par1, par2, anotherFunction_callback); 
```

，包括那个“数据”参数？

在那种情况下，解决方案是相当标准的，在那个之前写下这个：

```
var temp = function() { anotherFunction_callback(data) }; 
```

另一种语法是：

```
function temp() { myFunction_callback(data) };
// even though this looks just like a free function,
// you still define it inside the ready(function())
// that's why I call it "alternative". They are equivalent. 
```

通常，如果您想将带有 1 个或多个参数的函数传递给另一个函数，则使用该格式。在这里，我们基本上创建了一个新的无参数函数来调用另一个函数。新函数可以访问“数据”变量。它被称为“闭包”，您可能想了解更多。当然，如果回调不需要参数，你可以使用原来的函数名。

我希望这有帮助。

ps：您甚至可以内联函数声明，使其匿名，如下所示： myFunction(par1, par2, function() { myFunction_callback(data) }); 请注意，

```
$(document).ready(function() {}); 
```

看起来差不多就是这样。

# c# - WCF：使用 Duplex 跨同一 WCF 服务的多个实例进行通知

> ID：792492
> 
> 赞同：0
> 
> 时间：2009-04-27T07:17:38.050
> 
> 标签：c#, wcf, web-services, duplex

在应用程序 (WPF) 的多个实例之间共享 WCF 服务（**类）的****单个实例`SoapClient`**的最佳方法是什么？

我需要这样做，因为我需要启用带有回调的双工通信，所以我需要向服务“注册应用程序”，以便使用该应用程序的其他用户在新用户登录时会收到通知。

* * *

*顺便说一句，以下内容被删除，因为我已经确认要使通知起作用，注册者需要注册到同一个 wcf 服务实例......因此现在我需要一种方法来共享这个实例*

~~我目前正在开发一个应用程序，每当有人登录该应用程序时，我需要某种方式来通知当前正在使用该应用程序的用户。~~

我尝试过使用 WCF Duplex 的东西，但我无法让它工作......我认为它背后的原因是因为通知和订阅需要发生在 WCF 服务的同一个实例上。

但是由于这个应用程序将部署在多个用户的电脑上，我不能只共享这个 wcf 服务的一个实例是吗？（或者我可以吗？）

有没有办法为所有用户共享一个 wcf 服务的公共实例 (the `SoapClient`)？还是我以错误的方式解决这个问题？

目前我正在通过一个公共属性通过一个类库访问 WCF 服务，该公共属性在每次访问它时都会发送一个新的 wcf 服务实例，我认为这就是为什么通知不适用于多个实例的原因应用程序。

* * *

以下是客户端应用程序（wpf 应用程序）用于访问服务方法的方法（在类库中）：

```
public static MusicRepo_DBAccess_ServiceClient GetService(object instanceContext)
{
    return new MusicRepo_DBAccess_ServiceClient(new InstanceContext(instanceContext), dualBinding, endpointAddress);  
}

public static MusicRepo_DBAccess_ServiceClient GetService()
{
    return new MusicRepo_DBAccess_ServiceClient(new InstanceContext(new WSGateway()), dualBinding, endpointAddress);
} 
```

然后，在主应用程序窗口中，我从上述`this`作为 instanceContext 参数传入的重载方法中获取一个新实例，并`Open`等待通知，但是当另一个用户从应用程序的另一个实例登录时，我永远不会收到通知。

这就是我在服务登录方法中通知注册商（摘录）的方式：

```
if (!_callbackList.Contains(newUser))
{
     _callbackList.Add(newUser);
 }
 _callbackList.ForEach(c => c.NotifyNewUserOnline(loggedInUser)); 
```

 ~~* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T11:11:24.797

解决方案很简单。我只需要更改`InstanceContextMode`为`Single`：

```
[ServiceBehavior(
        InstanceContextMode = InstanceContextMode.Single)] 
```

# java - 在“桶”中组织文件

> ID：792493
> 
> 赞同：1
> 
> 时间：2009-04-27T07:17:47.223
> 
> 标签：java, file-io, java-io

我的问题是这样的：

我编写了一个客户端 HTTP 缓存，我需要以某种方式将 HTTP 有效负载存储在文件系统中。我不想用不必要的文件弄乱文件系统。

我写了这个类：

```
/*
 * 版权所有 (c) 2008，The Codehaus。版权所有。
 *
 * 根据 Apache 许可证 2.0 版（“许可证”）获得许可；
 * 除非遵守许可，否则您不得使用此文件。
 * 您可以在以下网址获取许可证的副本
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * 除非适用法律要求或书面同意，否则软件
 *根据许可分发是在“原样”基础上分发的，
 * 不提供任何明示或暗示的保证或条件。
 * 请参阅许可证以了解特定语言的管理权限和
 * 许可证下的限制。
 *
 */

包 org.codehaus.httpcache4j.cache；

导入 org.apache.commons.lang.Validate；
导入 org.apache.commons.io.filefilter.AndFileFilter；
导入 org.apache.commons.io.filefilter.DirectoryFileFilter；
导入 org.apache.commons.io.filefilter.RegexFileFilter；

导入 org.codehaus.httpcache4j.u​​til.DeletingFileFilter；

导入java.io.File；
导入 java.io.FileFilter；
导入 java.io.Serializable；
导入 java.util.ArrayList；
导入 java.util.Arrays；
导入 java.util.Collections；
导入 java.util.List；

/**
 * 这个类是内部的，不应该被客户端使用。
 *
 * 负责创建和维护文件生成的“池”。

 * 文件在被访问时被提升，因此我们可以确定哪些文件可以删除。

 * 已知问题：这需要与存储引擎的大小同步。

 * 如果缓存中有很多项目时生成的代数太少，则可能
 * 当您尝试访问它们时会丢失一些文件。
 *
 * Despot 的注释：我正在研究另一种存储文件的方式，所以这个类可能会在某个时候消失，
 * 或更改为其他形式。
 *
 */
类 FileGenerationManager 实现 Serializable{
    私有静态最终长序列版本UID = -1558644426181861334L；

    私有最终文件基目录；
    私人最终 int generationSize;
    私人最终 int numberOfGenerations;
    private final FileFilter generationFilter;

    公共 FileGenerationManager（最终文件 baseDirectory，最终 int numberOfGenerations）{
        这（baseDirectory，numberOfGenerations，100）；
    }

    公共 FileGenerationManager（最终文件 baseDirectory，最终 int numberOfGenerations，最终 int generationSize）{
        Validate.isTrue(numberOfGenerations > 0, "你不能创建 0 代");
        Validate.notNull(baseDirectory, "你可能没有一个空的基本目录");
        if (!baseDirectory.exists()) {
            Validate.isTrue(baseDirectory.mkdirs(), "无法创建基本目录：" + baseDirectory);
        }
        this.baseDirectory = baseDirectory;
        this.generationSize = generationSize;
        this.numberOfGenerations = numberOfGenerations;
        generationFilter = new AndFileFilter(DirectoryFileFilter.DIRECTORY, new RegexFileFilter("[0-9]*"));
        getGenerations();
    }

    /**
     * 在基本目录中创建几代目录。
     *
     * @return 创建的世代。
     */
    //TODO: 这个重吗？
    //TODO: 当我们错过 getFile() 时，也许我们应该这样做？
    公共同步列表 getGenerations() {
        最终列表世代 = new ArrayList();
        //处理现有的世代...
        文件[] 目录 = baseDirectory.listFiles(generationFilter);
        如果（目录.长度> 0）{
            对于（文件目录：目录）{
                generation.add(new Generation(baseDirectory, Integer.parseInt(directory.getName())));
            }
        }
        别的 {
            generation.add(new Generation(baseDirectory, 1));
        }
        Collections.sort(世代);
        一代 currentGeneration = generation.get(0);
        if (currentGeneration.getGenerationDirectory().list().length > generationSize) {
            generation.add(0, new Generation(baseDirectory, currentGeneration.getSequence() + 1));
            removeLastGeneration(世代);
        }
        而 (generations.size() > numberOfGenerations) {
            removeLastGeneration(世代);
        }
        返回 Collections.unmodifiableList(generations);
    }

    私人无效removeLastGeneration（列表世代）{
        if (generations.size() > numberOfGenerations) {
            一代一代=generations.remove(generations.size() - 1);
            代.删除（）；
        }
    }

    /**
     * 返回最近创建的一代
     *
     * @return 具有最高序列号的世代
     */
    同步生成 getCurrentGeneration() {
        返回 getGenerations().get(0);
    }

    公共同步文件getFile（字符串文件名）{
        文件目标 = new File(getCurrentGeneration().getGenerationDirectory(), fileName);
        for (世代: getGenerations()) {
            候选文件 = new File(generation.getGenerationDirectory(), fileName);
            if (candidate.exists()) {
                if (!target.equals(candidate)) {
                    //因为; http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4017593
                    目标.删除（）；
                    if (!candidate.renameTo(target)) {
                        返回候选人；
                    }
                    别的 {
                        休息;
                    }
                }
            }
        }
        返回目标；
    }

    静态类生成实现 Comparable {
        私有文件生成目录；
        私有 int 序列；

        public Generation(final File baseDir, final int generationNumber) {
            Validate.notNull(baseDir, "生成目录不能为空");
            文件 genFile = new File(baseDir, String.valueOf(generationNumber));
            genFile.mkdirs();
            this.generationDirectory = genFile;
            this.sequence = generationNumber;
        }

        公共同步无效删除（）{
            File[] undeleteableFiles = generationDirectory.listFiles(new DeletingFileFilter());
            if (undeleteableFiles == null || undeleteableFiles.length == 0) {
                generationDirectory.delete();
            }
            别的 {
                System.err.println("无法删除这些文件：" + Arrays.toString(undeleteableFiles));
            }
        }

        公共文件getGenerationDirectory（）{
            返回生成目录；
        }

        公共 int getSequence() {
            返回序列；
        }

        public int compareTo（一代）{
            return 1 - (sequence - generation.sequence);
        }
    }

}

```

问题是有时文件没有移动到正确的文件夹，我可能会泄漏文件描述符。

您对如何改善这一点有什么建议吗？

这可能有标准解决方案吗？不分语言？

这也很慢，欢迎提高速度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T22:20:54.277

您的性能问题（可能还有错误）可能是由于在标记世代时过度使用文件系统，而不是将此信息存储在内存中造成的。文件系统访问比内存访问要昂贵得多——特别是**File.listFiles() 或 File.list() 可能非常慢。** 如果您有数千个文件，预计在使用 NTFS 的 Windows 系统上执行它需要**几秒钟而不是几毫秒。**

如果可能，应将所有世代信息作为对象存储和更新为同步集合中的对象。如果您只是使用文件系统来实际存储、检索和删除缓存的数据文件，您可以将所有缓存文件放在一个目录中，然后随意调用它们（只需给文件一个数字或随机名称）。

如果分代缓存信息需要持久且安全地防止应用程序突然关闭，您可以使用序列化集合并定期将其写入磁盘（例如，每 30 秒一次，并在应用程序关闭时再次写入）。由于它只是一个缓存，因此您可以检查应用程序启动并删除没有真实文件的缓存条目并删除没有缓存条目的文件。

或者，您可能会考虑使用嵌入式数据库来存储整个缓存。H2 或 HSQLDB 是纯 Java，非常快速和轻量级，并且支持内存数据库和更快的嵌入式模式。这将使您可以存储更多的缓存对象，并且可能会更快，因为 DBMS 可能会在 RAM 中缓存经常使用的项目。

# flash - AS3 - 输出什么对象有键盘焦点？

> ID：792495
> 
> 赞同：2
> 
> 时间：2009-04-27T07:18:17.283
> 
> 标签：flash, actionscript-3, keyboard, focus

我在使用 AS3 和键盘焦点时遇到问题，我想知道是否有可以使用的变量或函数来输出屏幕上当前具有键盘焦点的对象的名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T08:12:13.940

您可以通过 FocusManager 来完成。然后您可以简单地调用 getFocus 函数。我整理了一个快速示例，它每秒显示当前焦点，尽管它确实毫无意义，但它向您展示了它是如何工作的：

```
import fl.managers.FocusManager;
var focus:FocusManager = new FocusManager(this);

function traceFocus():void
{
    trace(focus.getFocus())
}

setInterval(traceFocus,1000); 
```

只需将此代码放在根目录中，然后将一些输入框放在舞台上，它应该可以工作。另外，查看[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/managers/FocusManager.html "Adobe 文档")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-20T17:39:25.720

这也有效：

```
if (stage.focus) { trace (stage.focus.name); } 
```

请注意，如果您使用 TextInput 组件并在用户单击它时期望它的名称，您实际上将获得 TextInput 的子 TextField 的实例名称（它将具有像*instance88*这样的任意名称），因此您应该使用**stage.focus.parent.name**以获取 TextInput 本身的正确实例名称。

# php - 如何在不显示代码的情况下调用js

> ID：792496
> 
> 赞同：0
> 
> 时间：2009-04-27T07:20:19.043
> 
> 标签：php, javascript, apache, analytics

我想知道，我想在一些网站中植入一个 JS 跟踪代码（分析）来跟踪他们的流量。但是我不希望人们在查看网站的源代码时能够看到我在那里嵌入了 JS 跟踪代码。

是否可以？也许通过使用 Apache/PHP 技巧？

谢谢，

罗伊。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T07:24:25.820

不，这是不可能的，因为浏览器要执行任何代码，至少其中一些代码必须最初是可见的，即使该代码随后要检索跟踪代码本身。

此外，所有现代 Web 开发人员工具都提供对任何已加载代码的访问，因此任何人都可以使用这些代码查看您尝试离散加载的任何内容。

更重要的问题是你为什么要隐藏你正在跟踪的人？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T07:26:49.807

*使用 Javascript*绝对不可能。Javascript 始终在用户浏览器的上下文中运行，因此它始终意味着用户将有权查看脚本。你可以混淆它，或者在 JS 代码上尝试一些类似于防盗链的技巧，但使用 Firebug 等简单工具仍然可以相对容易地弄清楚代码的作用。

但是，您可以在没有 JavaScript 的情况下跟踪您的流量。Analytics 使用 JavaScript 来实现可移植性，因为它访问的某些数据只能通过 JavaScript 访问。但是，还有更多不需要 JavaScript 的被动方式来跟踪您的流量，例如任何[日志分析器](http://en.wikipedia.org/wiki/Web_log_analysis_software)，如[AWstats](http://awstats.sourceforge.net/)。您只是没有获得 Analytics 的一些很酷的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T07:26:25.190

这是不可能的，但您可以将您的脚本文件命名为“mouseover.js”之类的纯名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T07:26:43.707

这是不可能的：JS 代码必须由 Web 浏览器运行，这意味着——无论你尝试如何放置它——它必须能够被浏览器读取，因此任何检查页面的人都必须能够读取它。

您可以尝试混淆 JS，但这不会阻止任何决心查看正在发生的事情的人。

你*可以*问问自己，有多少人会检查你是否在跟踪他们——我没想到会这样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T15:03:09.303

从技术上讲，您无法隐藏代码...但是您可以对其进行打乱，因此任何人都无法阅读。我使用Dan Benjamin 的[http://hivelogic.com/enkoder/form](http://hivelogic.com/enkoder/form)在我的页面上抓取了一些 JS（在这种情况下，我扰乱了我的电子邮件地址）。它打乱它，以便浏览器可以执行它，但它不是人类可读的......

然后你可以像我在这个脚本[http://www.jamischarles.com/css_js/email_encoder.js](http://www.jamischarles.com/css_js/email_encoder.js)中那样把它作为一个函数来调用。试试看。

# asp.net - 数据导出到 Excel 错误

> ID：792500
> 
> 赞同：1
> 
> 时间：2009-04-27T07:21:19.773
> 
> 标签：asp.net

您好我正在尝试将数据从 GridView 导出到 excel 工作表，但出现此错误。

RegisterForEventValidation 只能在 Render() 期间调用；

这是我的代码

```
 Dim attachment As String
        attachment = "attachment; filename=Contacts.xls"
        Response.ClearContent()
        Response.AddHeader("content-disposition", attachment)
        Response.ContentType = "application/ms-excel"
        Dim myStringWriter As New IO.StringWriter
        Dim myhtmlStringWriter As New HtmlTextWriter(myStringWriter)
        GridView1.RenderControl(myhtmlStringWriter)
        Response.Write(myStringWriter.ToString)
        Response.End() 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T08:26:18.807

您可以在 web.config 文件中执行此操作，但在这种情况下，所有页面的 eventValidation 都将关闭。

或者您可以在 Page 指令中执行此操作，该指令将关闭单个页面的验证。

# jndi - 关于 Active Directory 中的组组成员身份的 JNDI 帮助

> ID：792512
> 
> 赞同：0
> 
> 时间：2009-04-27T07:27:06.360
> 
> 标签：jndi

我正在尝试使用 JNDI 程序将组添加到 Active Directory 中的不同组。这样做时，我收到以下错误

> [LDAP：错误代码 53 - 00002142：SvcErr：DSID-031A0FC0，问题 5003 (WILL_NOT_PERFORM)，数据 0

我正在使用的代码片段如下

1.  设置组属性

```
Attributes attrs = new BasicAttributes(true);
attrs.put("objectClass","group")
attrs.put("description","A test group"); 
```

2.  将组添加到不同的组

```
try{
    ModificationItem member[] = new ModificationItem[1];
    member[0]= new ModificationItem(DirContext.ADD_ATTRIBUTE, new BasicAttribute("member", groupDN)); 

```
ctx.modifyAttributes(grpDN,member);
 System.out.println("Added group to group: " + grpDN); 
```

}catch (NamingException e) {
    System.err.println("Problem adding group to group: " + e);
    } 
```

我可以使用几乎相同类型的代码（如下）将用户添加到组中。

1.  设置用户属性

```
// Create attributes to be associated with the new user
Attributes attrs = new BasicAttributes(true); 
attrs.put("objectClass","user");
attrs.put("samAccountName","Perry");
attrs.put("cn","Perry");

attrs.put("givenName","Perry");
attrs.put("sn","Perry");
attrs.put("displayName","Perry Peterson");
attrs.put("description","Research Engineer");

int UF_ACCOUNTDISABLE = 0x0002;
int UF_PASSWD_NOTREQD = 0x0020;
int UF_PASSWD_CANT_CHANGE = 0x0040;
int UF_NORMAL_ACCOUNT = 0x0200;
int UF_DONT_EXPIRE_PASSWD = 0x10000;
int UF_PASSWORD_EXPIRED = 0x800000;

attrs.put("userAccountControl",Integer.toString(UF_NORMAL_ACCOUNT + UF_PASSWD_NOTREQD + UF_PASSWORD_EXPIRED+ UF_ACCOUNTDISABLE)); 
```

2.  将用户添加到组

```
try{
    ModificationItem member[] = new ModificationItem[1];
    member[0]= new ModificationItem(DirContext.ADD_ATTRIBUTE, new BasicAttribute("member", userDN)); 

```
ctx.modifyAttributes(groupDN,member);
System.out.println("Added user to group: " + groupName);
}catch (NamingException e){
    System.err.println("Problem adding user to group: " + e); 
```

} 
```

有没有人知道我在这里做错了什么，或者是否有任何必须为组设置的属性，就像在用户的情况下一样。我的 JNDI 客户端和服务器之间有 SSL 连接，并且我能够成功重置用户密码（如果没有 SSL，这将是不可能的）

我怀疑这是因为我之前创建的组没有正确创建

问候

佩里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T15:21:00.150

发生这种情况是因为默认情况下将组创建为安全组，并且无法将组添加到组（如果是安全组）

如果您想拥有嵌套组，请将组创建为通用分布，然后只有您能够将组添加到组

此行为适用于 Active Directory。我不知道其他目录。

# svn - svn的绊脚石

> ID：792520
> 
> 赞同：1
> 
> 时间：2009-04-27T07:29:29.817
> 
> 标签：svn

我在使用 svn 时遇到了一些问题。这是一个列表

*   在某个时间点，我的所有命令（如 svn commit、svn add 等）都有效，但我做了一些事情，如果不以 root 用户 (sudo) 身份运行它们，它们都不会工作。哪些具体操作会导致此问题，以及如何解决？
*   我的其他网站自己创建了一个图像文件夹，结果它的用户：组变成了 www-data:www-data。当我尝试将此文件夹添加到版本控制时，我认为 svn 无法在图像中创建子目录 .svn，因此它输出图像文件夹的所有子路径都已锁定，我需要运行清理。清理也失败了。它还开始显示带有“〜”（波浪号）的图像目录，暗示它在某个时候被版本化，但发生了一些事情。我修复了“无法提交直到中断锁”和“无法中断锁”循环问题，如下所示：
    *   从通向图像文件夹的每个目录中删除 .svn/lock 文件
    *   将图像目录移动到主文件夹，并提交“已删除图像”
    *   复制回图像文件夹并执行“svn add”

但我想知道在上述两种情况下我应该怎么做。我怀疑在案例 1 中，问题与混乱的文件夹权限有关，但我不知道具体是什么以及如何解决它。我怀疑我可以对没有设置适当所有者/组的文件夹采取以下步骤之一：

*   尝试做'sudo add folder_with_different_user_and_group'
*   将 user:group 更改为默认值，添加文件并提交。但不知何故，我想以某种方式恢复这些变化，使其在未来发挥作用。可能会更改权限但不更改 .svn 文件夹的所有者：组？

在上述每种情况下使用 svn 的最佳方法是什么，以及在发生这种情况时如何成功打破锁等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T08:12:43.067

似乎您至少有 2 个不同的用户在**更新**同一个工作副本：

*   www-data:www-data（网络用户）
*   你自己的用户

那是个问题。您可以对所有 svn 操作使用 root（即 sudo）——它不干净，但可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T08:03:17.177

您的第一个问题是文件系统权限问题，而不是 svn 问题。如果您以 root 身份运行 svn 命令，很可能您的许多文件和目录最终将归 root 所有。跑步

```
chown -R desiredusername . 
```

作为工作副本根目录中的 root 应该可以解决问题（请注意，您必须将真实用户名替换为“desiredusername”）。尽量避免以 root 身份工作，你会避免很多这样的问题。:)

至于第二个问题，如果它是一个包含运行时数据的目录，比如你的 Web 应用程序存储的东西，我会质疑你是否真的想要对其进行版本控制。我敢打赌你不会，所以最好让 svn 完全忽略该目录。你可以通过运行来做到这一点

```
svn propset svn:ignore imagedirectoryname . 
```

在父目录中。同样，用实际名称替换“imagedirectoryname”。另请注意，如果您在父目录中已经有其他被忽略的资源，使用 svn propset 会覆盖它们，所以您要运行

```
svn propedit svn:ignore . 
```

反而。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T08:05:58.043

您描述的是权限问题，而不是 SVN 问题。我建议了解 Unix 文件权限及其含义，例如[这里](http://www.dartmouth.edu/~rc/help/faq/permissions.html)。

如果您的文件是由 Web 服务器创建的，那么您可能会遇到将 Apache 配置为以“www-data”或其他方式运行的问题。在这种情况下，将用户（运行 SVN 命令）添加到 Apache 用来编写文件的组中可能更简单。

# qt - 有没有办法让 drawText() 更新 QPicture 的边界矩形？

> ID：792521
> 
> 赞同：1
> 
> 时间：2009-04-27T07:29:38.973
> 
> 标签：qt, pyqt

在 a 上绘图`QPicture`应该更新它的边界矩形。像这样：

```
>>> picture = QPicture()
>>> painter = QPainter(picture)
>>> picture.boundingRect()
QRect(0,0,0,0)
>>> painter.drawRect(20,20,50,50)
>>> picture.boundingRect()
QRect(20,20,50,50) 
```

但是，如果我在其上绘制文本，则边界矩形不会更新：

```
>>> picture = QPicture()
>>> painter = QPainter(picture)
>>> picture.boundingRect()
QRect(0,0,0,0)
>>> painter.drawText(10,10, "Hello, World!")
>>> picture.boundingRect()
QRect(0,0,0,0) 
```

显然，它不会更新边界矩形。

有没有办法让它代表绘制的文本，还是我必须手动完成？（不是太难，但我希望Qt可以在这里帮助我。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T12:51:02.023

看看这些重载方法，您必须在 text 参数之后指定 Bounding Rectangle（这显然与第一个参数位置的矩形不同）：

> 根据指定的标志在提供的矩形内绘制给定的文本。boundingRect（如果不为空）设置为边界矩形应该是什么，以便包含整个文本。

[QPainter.drawText (1)](https://doc.qt.io/qt-4.8/qpainter.html#drawText-11) , [QPainter.drawText (2)](https://doc.qt.io/qt-4.8/qpainter.html#drawText-13)

**更新：**

如果你想提前为 drawText() 方法生成一个边界矩形，你只需调用 QPainter 上的 boundingRect() 方法，它会执行以下操作：

> 返回文本的边界矩形，当它使用当前设置的 font() 绘制在具有指定标志的给定矩形内时，它将出现；即，该函数告诉您当给定相同的参数时，drawText() 函数将在哪里绘制。
> 
> 如果文本不适合使用指定标志的给定矩形，则该函数返回所需的矩形。

[QPainter.boundingRect](https://doc.qt.io/qt-4.8/qpainter.html#boundingRect)

我使用 QRectF 输出链接到 BoundingRect，但该信息也适用于其他版本。

所以基本上，将 QPainter.boundingRect() 的结果传递给 QPainter.drawText() 方法的 boundingRect 参数（第二个 QRect 参数）。

**更新 2：**

我为自己如此该死的密集道歉。我忘记了 drawText 在 PyQt 中的工作方式与在 Qt 中不同。边界矩形由 drawText 函数返回（不像 Qt 那样传入），此外，您必须在获得返回给您的边界矩形之前指定对齐标志。（我什至根据 Aaron Digulla 的评论将 p.end() 包括在内）：

```
pic = Qt.QPicture()
p = QtGui.QPainter(pic)
brect = p.drawText(10,10,200,200, QtCore.Qt.AlignCenter, "blah")
p.end()
print brect
print pic.boundingRect() 
```

这是输出：

> PyQt4.QtCore.QRect(100, 103, 20, 14)
> 
> PyQt4.QtCore.QRect(0, 0, 0, 0)

因此，您似乎必须自己设置边界矩形，尽管在传入标志时，至少它会由 drawText() 方法的输出返回给您。

这似乎不是理想的行为，您必须自己设置边界矩形。我希望其他人有你正在寻找的答案，但我怀疑你可能想报告这个错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T07:43:00.673

绘画不会改变 Qt 中某些东西的大小。主要原因是这样的：

*   组件必须自己绘制
*   油漆触发调整大小
*   调整大小触发绘画 -> 无限循环

所以调整大小必须在布局阶段进行。之后，界限不应改变。

要解决您的问题，请使用 QFontMetric 计算出在构建图片期间或接近构建图片时您的文本将有多大，然后相应地调整其大小。

[编辑] 嗯 ...在请求边界矩形之前尝试调用 end() 。如果可行，则您发现了一个错误（在添加元素时看不到边界矩形不应该存在的原因......）

# php - 使用 PHP 进行 htaccess 身份验证

> ID：792522
> 
> 赞同：1
> 
> 时间：2009-04-27T07:31:02.357
> 
> 标签：php, security, .htaccess

在我正在处理的当前网站上，我有一个供用户下载的文件目录，如果有一些安全方法而不是晦涩难懂，那就太好了；）

我想知道是否有任何方法可以通过 PHP 向 htaccess 提供登录信息，就好像用户正在输入它一样。

或者，如果有人知道使用 PHP 保护用户下载的更好方法，那也是可以接受的。我所有的谷歌搜索都出现了“只使用 htaccess”，这并没有真正的帮助，因为从非精明用户的角度来看，他们每次使用该网站时都必须登录两次。

我最好的猜测是只使用 PHP 将文件存储在 web 根目录之上，然后将它们临时复制到 web 可访问文件夹，但这似乎效率很低，我想不出任何方法在下载完成后删除它们.

注意：我不拥有正在运行的服务器，也没有 ssh 访问权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T07:40:15.423

如果文件不是太大（Gb），您可以随时使用[readfile](http://it2.php.net/manual/en/function.readfile.php)进行文件下载。在这种模式下，您可以检查用户之前的身份验证，如果可以，则将文件内容输出给用户，否则将他发送到登录页面。

使用这种方法，您可以将文件放在受保护的（使用 .htaccess）目录中，这样您就可以确保未经身份验证的任何人都无法访问它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T07:50:51.123

我想我要么将它们存储在 web 根目录之外的文件夹中，要么将它们存储在受 .htaccess 保护的文件夹中，然后使用 php 脚本检查用户是否已登录并允许下载请求的文件。如果他是，那么只需[将文件传递](http://it2.php.net/manual/en/function.fpassthru.php)给用户。

来自 php.net 链接页面的示例：

> Example #1 对二进制文件使用 fpassthru()
> 
> ```
> <?php
> 
> // open the file in a binary mode
> $name = './img/ok.png';
> $fp = fopen($name, 'rb');
> 
> // send the right headers
> header("Content-Type: image/png");
> header("Content-Length: " . filesize($name));
> 
> // dump the picture and stop the script
> fpassthru($fp);
> exit;
> 
> ?> 
> ```

* * *

其他人评论说必须报告正确的内容类型，这是真的。通常，根据我自己的经验，我已经知道它，或者可以很容易地使用文件扩展名。否则，您可以随时尝试查看[finfo_file](http://it2.php.net/manual/en/function.finfo-file.php)。在那个页面上，还有一些关于你可以做什么的评论，特别是对于图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T07:55:47.570

您应该使用 php 脚本来控制访问。在 webroot 之外或在 webroot 内部创建一个带有 .htaccess 的目录，您可以在其中放置下载文件。

网站根目录外更好。

如果这些文件位于内部，您必须确保没有人可以访问这些文件。

然后从梨类库中获取。http_download 类。

使用这个类有很多优点。

*   范围（部分下载和恢复）
*   基本缓存能力
*   基本节流机制
*   即时 gzip 压缩
*   通过 Archive_Tar 和 Archive_Zip 交付即时生成的档案
*   无需在发送前读取所有数据即可发送 PgSQL LOB

您不应该使用 readfile 或任何转发文件指针，因为您必须自己设置标头并且不支持 http“范围”。

对于访问限制，您可以使用会话管理器、密码、框架、论坛等。

[梨 - http_download http://pear.php.net/package/HTTP_Download](http://pear.php.net/package/HTTP_Download)

您需要复制 url，因为 SO 将其编码为 url 编码的字符串（这是正确的），但 PEAR-homepage 不喜欢这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T07:34:29.897

为什么要重新发明轮子？看看[File Thingy](http://www.solitude.dk/filethingie/)，它很容易安装和定制。如果不出意外，您可以研究源代码以了解如何执行身份验证步骤。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T07:40:39.463

1.  在我看来，您可以使用 MySQL 来存储上传的文件，而不是将它们存储在文件中，这样会更好、更安全。以谷歌“MySQL 上传 php”为例。
2.  您可以使用 PHP 脚本从您的用户表中创建 htaccess 文件，每次用户访问该文件夹时，非常麻烦。

我认为第一个选项更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T05:47:48.010

使用`X-SendFile`！有适用于 Apache、Lighty 和 Nginx 的扩展，所以很有可能有一个适用于您的网络服务器。

安装扩展后，您可以使用 PHP 脚本对用户进行身份验证，然后添加标题：

```
header('X-SendFile','/path/to/file'); 
```

当您的 PHP 脚本完成后，它将触发网络服务器为您流式传输文件。如果您将 PHP 与 FastCGI 一起使用，这将特别有效，因为它可以释放 PHP 进程以进行其他工作。

翻转

# web-services - SOAP 与 HTTP

> ID：792524
> 
> 赞同：15
> 
> 时间：2009-04-27T07:33:31.460
> 
> 标签：web-services, http, soap, protocols

我读过 Web 服务是通过 SOAP over HTTP 传输的。**那么SOAP**和**HTTP**之间有什么区别，如果它们都是通信协议呢？

有什么区别还是 HTTP 只是 SOAP 使用的绑定？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-27T08:34:44.403

有两个与 Web 服务相关的主要协议。

*   1、**传输协议**——例如HTTP（常用）、TCP、UDP

*   2、**消息传递协议**——例如 SOAP、XML、JSON 或二进制编码的消息

一般来说，

*   **消息传递协议**负责以共同商定的格式交换消息。
*   **传输协议**负责传递消息以及它应该如何通信。

一个真实的例子：HTTP 就像电话通信，SOAP 就像英语。

您通过 SOAP 消息中的 HTTP 调用 Web 服务，例如通过手机呼叫您的朋友并用英语交谈。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-27T07:38:28.033

它不是网络服务传输的。相反，消息以 SOAP 格式传输。

SOAP 作为交换结构化信息的协议规范，几乎可以使用任何传输协议（HTTP 是最广泛使用的，RPC 和 SMTP 也可以使用）。

长话短说，您无法比较 HTTP 和 SOAP，因为它们是两个正交的东西。参见[维基百科](http://en.wikipedia.org/wiki/SOAP)的介绍。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-27T07:39:02.680

Web 服务不需要使用 SOAP 来实现，而且 SOAP 实际上也不需要通过 HTTP 传输（尽管这种情况很少见）。HTTP 是 Web 的底层协议，而 SOAP 是使用 XML 作为 RPC 调用信封的一种方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T07:39:16.173

Http 或 Https 是基于 SOAP 运行的协议。

SOAP（简单对象访问协议）用于服务器之间的数据交换。

肥皂的客户端系统只是连接以从主服务器获取数据的其他服务器。

soap的其他选项是RPC（远程过程调用）

[http://en.wikipedia.org/wiki/SOAP](http://en.wikipedia.org/wiki/SOAP)

# c# - C#：如何实现和使用 NotNull 和 CanBeNull 属性

> ID：792531
> 
> 赞同：40
> 
> 时间：2009-04-27T07:35:59.007
> 
> 标签：c#, attributes, null

我想让程序员和我自己知道一个方法不想要`null`，如果你还是发送`null`给它，结果不会很漂亮。

[Lokad Shared Libraries](http://abdullin.com/shared-libraries/)的命名空间中有 a`NotNullAttribute`和 a 。`CanBeNullAttribute``Lokad.Quality`

但这是如何工作的？我查看了这两个属性的源代码，它看起来像这样：

```
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Parameter |
                AttributeTargets.Property | AttributeTargets.Delegate |
                AttributeTargets.Field, AllowMultiple = false, Inherited = true)]
[NoCodeCoverage]
public sealed class NotNullAttribute : Attribute
{
}

[AttributeUsage(AttributeTargets.Method | AttributeTargets.Parameter |
                AttributeTargets.Property | AttributeTargets.Delegate |
                AttributeTargets.Field, AllowMultiple = false, Inherited = true)]
[NoCodeCoverage]
public sealed class CanBeNullAttribute : Attribute
{
} 
```

两个空类继承自`Attribute`. 它们是如何使用的？您是否必须查找 xml-documentation 并知道它在那里？因为我尝试制作自己的属性副本并使用 Lokad 版本，但是当我尝试直接发送空值时，我没有收到任何消息。既不是来自 ReSharper 也不是来自 VS。实际上，我有点期待。但是它们是如何使用的呢？如果我尝试在其中发送 null 的内容，我能否以某种方式让 VS 为我生成警告？还是只是在某种测试框架中使用？或者？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-27T07:42:58.067

在中期，“代码合同”（4.0 中）将是对此的更好回答。它们现在可用（具有[学术](http://research.microsoft.com/en-us/projects/contracts/)或[商业](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)许可证），但将更多地集成在 VS2010 中。这可以提供静态分析和运行时支持。

（编辑）示例：

```
Contract.RequiresAlways( x != null ); 
```

就这么简单......代码契约引擎在 IL 级别工作，因此它可以分析它并在构建期间或运行时从调用代码中抛出警告/错误。为了向后兼容，如果你有现有的验证代码，你可以告诉它健全性检查在哪里结束，剩下的就交给它了：

```
if ( x == null ) throw new ArgumentNullException("x");
Contract.EndContractBlock(); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-27T07:43:18.100

这可以通过[AOP](http://en.wikipedia.org/wiki/Aspect_oriented_programming)来完成，其中 Advice 在运行时验证方法参数是否为空以及是否允许空值。有关 AOP，请参阅[PostSharp](http://www.postsharp.org/)和[Spring.NET](http://springframework.net/)。

至于 ReSharper，请参阅[Annotated Framework](http://www.jetbrains.com/resharper/features/code_analysis.html#Annotated_Framework)：

> 我们分析了很大一部分 .NET Framework 类库以及 NUnit Framework，并使用 JetBrains.Annotations 命名空间中的一组自定义属性通过外部 XML 文件对其进行了注释，具体而言：
> 
> *   StringFormatMethodAttribute（用于将格式字符串作为参数的方法）
> *   InvokerParameterNameAttribute（对于带有字符串文字参数的方法，应该匹配调用者参数之一）
> *   AssertionMethodAttribute（用于断言方法）
> *   AssertionConditionAttribute（用于断言方法的条件参数）
> *   TerminatesProgramAttribute（用于终止控制流的方法）
> *   CanBeNullAttribute（对于可以为空的值）
> *   NotNullAttribute（对于不能为空的值）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-10-31T14:28:21.680

这些注释适用于 ReSharper，并从 JetBrains.Annotations 命名空间复制。框架可以将它们放在自己的命名空间中，但是，ReSharper 不会自动获取这些注释 - 您需要在选项对话框中告诉 ReSharper 使用自定义命名空间。一旦您选择了新的命名空间，ReSharper 的分析将获取属性并为您提供突出显示和警告。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-01T17:38:37.623

正如[Anton Gogolev](https://stackoverflow.com/users/60188/anton-gogolev)所指出的，可以使用 PostSharp 创建属性。（请注意，CodeContract 在方法体内使用静态方法调用）

2013 年 2 月更新：PostSharp 的新 3.0 版本（目前处于测试阶段）将支持 [验证参数、字段和属性](http://www.sharpcrafters.com/blog/post/Validating-parameters-field-and-properties-in-PostSharp-3.aspx)

1) 文章[validate-parameters-using-attributes](http://dpatrickcaldwell.blogspot.com.au/2009/03/validate-parameters-using-attributes.html)实现了

> 公共类 NotEmpty : ParameterAttribute
> 
> 公共类 NotNull : ParameterAttribute
> 
> [AttributeUsage(AttributeTargets.Parameter)]
> 
> 公共抽象类 ParameterAttribute : 属性
> 
> {
> 
> ```
> public abstract void CheckParameter(ParameterInfo parameter, object value); 
> ```
> 
> }

它还需要具有方法边界方面的方法属性来处理参数属性。

2）在文章的评论中，有指向[非常相似](http://code.google.com/p/postsharp-user-plugins/wiki/DesignByContract)的 NonNull/NonEmpty    实现的链接

> [return: NonNull] public SomeObject SomeMethod([NonNull] AnotherObject param1)

源代码位于 [谷歌代码 Torch/DesignByContract](http://postsharp-user-plugins.googlecode.com/svn/trunk/1.5/Torch/DesignByContract.Weaver/)

3）另一个更复杂的例子在 [http://badecho.com/2011/11/validating-method-parameters-with-postsharp/中描述](http://badecho.com/2011/11/validating-method-parameters-with-postsharp/)       

# sharepoint - 如何处理 SharePoint 异常？

> ID：792541
> 
> 赞同：2
> 
> 时间：2009-04-27T07:41:49.973
> 
> 标签：sharepoint, exception, exception-handling, moss, wss

我是 SharePoint 新手，所以我想我需要如何处理异常？当我编写自定义代码时，我是否必须检查它们，或者如果它们被抛出，它们会自动被记录并且不会破坏应用程序？

如果没有，那么我该如何记录它们？

谢谢！

编辑：我应该如何记录这些异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T17:16:27.860

使用它写入日志：http: [//msdn.microsoft.com/en-us/library/aa979522.aspx](http://msdn.microsoft.com/en-us/library/aa979522.aspx)

除非您处理异常，否则应用程序很可能会中断。某些错误（例如在事件接收器中生成的错误）不会“破坏”应用程序（终止事件接收器除外）。除非您更改了中央管理中的设置，否则这些以及所有其他未捕获的错误将最终出现在日志中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T08:03:45.973

异常的一般规则是您应该只捕获您知道如何正确处理自己的异常 - 我不知道 sharepoint 是否记录未处理的异常本身，但我认为它将未处理的异常转换为各种 Web 服务中的适当 SOAP 异常，所以可以肯定的是，您不会使整个应用程序崩溃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T18:12:08.507

我们允许所有异常冒泡并使用自定义 HTTP 模块来处理所有异常。从这里，我们记录到 ULS 日志和跟踪日志。这主要来自[SharePoint MVP Chris O'brien 的代码](http://msmvps.com/blogs/cobrien/archive/2008/10/28/sample-code-from-my-top-wcm-tips-presentation.aspx)

如果我们认为可以为异常添加额外的价值，我们只会捕获异常，然后重新抛出错误，允许 http 模块接收它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T16:17:49.250

我将假设您使用的是 SharePoint 对象模型，而不是它的 Web 服务，因为您没有说明哪个，并且通常使用对象模型，因为它提供了更多功能。

SharePoint 使用自己的自定义[SPException](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spexception.aspx)类以及几个标准的 .NET 异常类来引发异常。不幸的是，SDK 文档没有提到哪些方法会抛出异常以及何时可能发生这种情况。您自己的经验和[Reflector](http://www.red-gate.com/products/reflector/)最适合学习这一点。

在第一次学习时，您可能会经常引发异常，并且很难知道何时以及为什么会发生这种情况。SPException 抛出的那些通常有有用的消息，但是 SharePoint 也抛出的标准 .NET 异常（例如 ArgumentOutOfRangeException）提供的细节很少。因此，为了帮助调试，保持方法简短和重点是一个好主意，这样很容易找到可能发生异常的原因。你只需要检查它们是否有充分的理由让它们冒泡，除非你可以重新抛出并添加更多细节（[由 Peter 建议](https://stackoverflow.com/questions/792541/how-do-i-handle-sharepoint-exceptions/794607#794607)）是确保正确性和保持代码清洁的好方法。

SharePoint 通常不会自动记录异常。有时您会在[ULS（又名跟踪日志）文件](http://msdn.microsoft.com/en-us/library/aa979590.aspx)中找到它们，但通常在记录时，它们不会提供比您自己可以捕获的异常更多的信息。如这里已经提到的，有很多选项可以设置您自己的日志记录。您还可以在[SharePoint Dev Wiki](http://sharepointdevwiki.com/display/public/SharePoint+Development+with+Logging+framework)上找到一个很棒的列表。

# actionscript-3 - 使加载的图像可拖动动作脚本3

> ID：792543
> 
> 赞同：0
> 
> 时间：2009-04-27T07:42:52.250
> 
> 标签：actionscript-3, image, drag-and-drop, draggable, loader

我想使用 Loader 将图像加载到舞台，然后我想让它可拖动。加载是通过从 tilelist 中选择来完成的，如下所示，但我不知道在 AS3 中拖放，有人可以帮助我吗？我想让它尽可能简单。

这是我加载图像的代码：

```
var charge1:Loader = new Loader();
addChild(charge1);
this.addChildAt(charge1, getChildIndex(bg));
charge1.x = 280;
charge1.y = 270;

...

function setCharge1(e:Event):void{
    trace(e.target.selectedItem.source);

    this.charge1.load(new URLRequest(e.target.selectedItem.source));    
    this.charge1.contentLoaderInfo.addEventListener(Event.COMPLETE,onComplete);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T08:22:43.463

yuku 走的是正确的路线，但你想要做的是获取 loaderInfo 的内容，这实际上是加载的剪辑。像

```
private function onComplete(event : Event) : void
{
  var loadedClip : MovieClip = LoaderInfo(event.target).content;

  loadedClip.addEventListener(MouseEvent.MOUSE_DOWN, function(event : MouseEvent) 
  {
    loadedClip.startDrag();
  });

  stage.addEventListener(MouseEvent.MOUSE_UP, function(event : MouseEvent) 
  {
      loadedClip.stopDrag();
  });

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-03T14:57:34.693

这对我来说是最简单的方法...

```
/* Load Image */

var myLoader:Loader = new Loader(); 
imageContainer.addChild(myLoader); 
var url:URLRequest = new URLRequest("photo.jpg"); 
myLoader.load(url);

/* Drag and Drop */

imageContainer.addEventListener(MouseEvent.MOUSE_DOWN, pickUp);
function pickUp(event:MouseEvent):void
{
imageContainer.startDrag();
}
stage.addEventListener(MouseEvent.MOUSE_UP, dopIt);

function dopIt(event:MouseEvent):void
{
imageContainer.stopDrag();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T13:22:10.763

使用以下代码：

```
this.addEventListener(MouseEvent.MOUSE_DOWN, dragMovie);
this.addEventListener(MouseEvent.MOUSE_UP, dropMovie);
this.buttonMode = true;
private function dragMovie(event:MouseEvent):void
{
  this.startDrag();
}

private function dropMovie(event:MouseEvent):void
{
  this.stopDrag();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T08:01:32.970

Loader 是 Sprite 的子类，因此您可以使用 startDrag 和 stopDrag 方法。

例如：

```
charge1.addEventListener("mouseDown", function() {
    charge1.startDrag();
});

stage.addEventListener("mouseUp", function() {
    charge1.stopDrag();
}); 
```

# c# - 如何使用 winforms 从 web 下载显示 C# 下载进度的图像？

> ID：792544
> 
> 赞同：8
> 
> 时间：2009-04-27T07:42:54.090
> 
> 标签：c#, winforms, image, httpwebrequest

我以这种方式使用 WebRequest 从 URL 异步下载图像：

```
public void Download(string url)
{   
  byte[] buffer = new byte[0x1000];
  WebRequest request = HttpWebRequest.Create(url);
  request.Method = "GET";
  request.ContentType = "image/gif";

  request.BeginGetResponse(result =>
  {
    WebRequest webRequest = result.AsyncState as WebRequest;

    WebResponse response = webRequest.EndGetResponse(result);
    ReadState readState = new ReadState()
    {
      Response = response.GetResponseStream(),
      AccumulatedResponse = new MemoryStream(),
      Buffer = buffer,
    };

    readState.Response.BeginRead(buffer, 0,
      readState.Buffer.Length, ReadCallback, readState);
  }, request);
}

public void ReadCallback(IAsyncResult result)
{
  ReadState readState = result.AsyncState as ReadState;
  int bytesRead = readState.Response.EndRead(result);
  if(bytesRead > 0)
  {
    readState.AccumulatedResponse.BeginWrite(readState.Buffer, 0, bytesRead, writeResult =>
    {
      readState.AccumulatedResponse.EndWrite(writeResult);
      readState.Response.BeginRead(readState.Buffer, 0, readState.Buffer.Length, ReadCallback, readState);
    }, null);
  }
  else
  {
    readState.AccumulatedResponse.Flush();
    readState.Response.Close();
    pictureBox1.Image = Image.FromStream(readState.AccumulatedResponse);
  }
}

public class ReadState
{
  public Stream Response { get; set; }
  public Stream AccumulatedResponse { get; set; }
  public byte[] Buffer { get; set; }
} 
```

它工作正常，但我想像浏览器一样显示下载进度，而不是仅在完成时显示。

如果我做

```
pictureBox1.Image = Image.FromStream(readState.AccumulatedResponse); 
```

在它完成之前我得到一个图片无效的异常，即使它有一些数据。反正有显示部分数据吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T07:48:05.823

JPEG 有一种特殊的编码模式，称为“渐进式 JPEG”，在这种模式下，数据以渐进式更高细节的多通道压缩。Windows 7 对此具有[内置支持](http://msdn.microsoft.com/en-us/library/dd408863(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-06T10:31:02.113

> 我想像浏览器一样显示下载进度，而不是仅在完成时显示。

你有两个选择：

1.  使用[`WebClient.DownloadDataAsync`](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloaddataasync.aspx). 这将引发进度事件，[`DownloadProgressChanged`](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloadprogresschanged.aspx)并通过事件提供数据何时可用的最终通知[`DownloadDataCompleted`](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloaddatacompleted.aspx)。那时，您可以将图像分配给`PictureBox`.

2.  如果您正在下载图像以最终显示在[`PictureBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.aspx)控件中，那么使用[`PictureBox.LoadAsync`](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.loadasync.aspx). [`LoadProgressChanged`](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.loadprogresschanged.aspx)这也将通过其事件并最终[`LoadCompleted`](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.loadcompleted.aspx)在完成时提供进度更新。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-06T22:47:04.277

PictureBox 控件有问题，而不是部分下载有问题。

一个 hack 是使用 WebBrowserControl，因为 IE 能够显示部分图像。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-27T07:47:36.280

当您开始请求时，检查[WebResponse.ContentLength](http://msdn.microsoft.com/en-us/library/system.net.webresponse.contentlength.aspx)属性，它应该为您提供预期的总字节数。然后跟踪在 ReadCallback 方法中读取的总字节数。其余的应该是显而易见的。:)

[编辑] 哎呀，我重新阅读了这个问题，这不是你想要的。不过，我仍然保留它，以防有人从中受益。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T07:49:34.730

我认为您不会使用 .NET 框架的内置方法来管理它，因为它们会首先读取完整图像然后显示它。您将需要找到一些其他支持显示部分下载图像的库或自己编写解析器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-06T23:35:04.163

您可能可以这样做，但是，这需要一些有关 gif 文件结构的额外知识。[Wotsit.org](http://www.wotsit.org/list.asp?al=G)有几个指向 gif 结构文档的链接，可以帮助您入门。

一般的方法是获取您的总累积数据，然后从最后开始搜索，直到找到块终止符的结尾。最后一个有效块和流末尾之间的数据只是部分完整，必须被视为垃圾数据。您要删除它，并将文件尾随块添加到流中。然后，您应该能够将此编辑后的流加载到 PictureBox 中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T00:56:10.870

您可以在定期调用的异步 Web 下载请求上使用一个事件，并允许您直接更新 ProgressBar 控件。这是我如何使用此事件的示例：

```
 delegate void SetProgressDelegate(int percentComplete);
    /// <summary>
    /// A thread-safe method for updating the file download progress bar.
    /// </summary>
    /// <param name="bytesReceived"></param>
    /// <param name="totalBytes"></param>
    void SetDownloadProgress(int percentComplete)
    {
        if (this.InvokeRequired)
        {
            SetProgressDelegate d = new SetProgressDelegate(SetDownloadProgress);
            this.Invoke(d, new object[] { percentComplete });
        }
        else
        {
            this.progressFileDownload.Value = percentComplete;
        }
    }
    /// <summary>
    /// Event handler to update the progress bar during file download.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    void web_DownloadProgressChanged(object sender, DownloadProgressChangedEventArgs e)
    {
        SetDownloadProgress(e.ProgressPercentage);
    } 
```

以下是我连接事件并开始下载的方式：

```
 WebClient web = new WebClient();
            web.DownloadFileCompleted += new AsyncCompletedEventHandler(web_DownloadFileCompleted);
            web.DownloadProgressChanged += new DownloadProgressChangedEventHandler(web_DownloadProgressChanged);
            web.DownloadFileAsync(sourceUri, destinationFileName); 
```

您的解决方案将文件直接读取到内存中，而我的解决方案将其保存到磁盘上的文件中，因此此解决方案可能适合您，也可能不适合您。如果显示进度指示对您很重要，则此方法确实有效，您始终可以下载到临时文件，然后在完成后将该文件加载到图像控件中。

# java - 如何设计一个可以是两种类型之一的对象？

> ID：792557
> 
> 赞同：1
> 
> 时间：2009-04-27T07:49:28.113
> 
> 标签：java, oop

我正在阅读 HTTP POST，HTTP 请求的主体可以是 JSON 或 XML。现在我已将阅读委托给一个特殊的实用程序类。

```
interface HttpUtils
{
    BodyWrapper parseBody( HttpServletRequest req );
}

interface BodyWrapper
{
    boolean isXML();  // 1
    boolean isJSON(); // 2
    String body();    // 3
} 
```

*   我讨厌 BodyWrapper 有方法 (1 & 2) 来识别它的类型。也许我应该使用继承。如果我这样做，我需要做一个 instanceof 来找出 HttpUtils.parseBody(..) 返回的内容
*   理想情况下，我还希望 body() 方法返回 JSONObject 或 DOM 节点。我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T08:18:53.833

不要向您的对象询问信息，然后根据他们告诉您的内容做出决定。让你的对象为你工作。也就是说，不要这样做：

```
if (body.isXML()) {
  // do XML stuff
}
else if (body.isJSON()) {
  // do JSON stuff
} 
```

这是一个令人头疼的维护问题。而是做这样的事情（BodyWrapper 实现将使用[抽象工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)或类似方法创建）

```
public interface BodyWrapper {
   Object doStuff();
}

public class DOMBodyWrapper implements BodyWrapper {
   public Object doStuff() {
   }
}

public class JSONBodyWrapper implements BodyWrapper {
   public Object doStuff() {
      // do something and return a success/failure result. I've
      // deliberately not defined what this object is....
   }
} 
```

进而：

```
// get the body via a factory or similar
body.doStuff(); 
```

这样，某些东西会创建适当的`BodyWrapper`实现，然后您无需询问它是什么类型，而是使用它。请注意，BodyWrapper 不会返回不同类型的内部结构，因为它（可能是抽象基类）正在为您完成工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T07:52:59.247

首先，`HttpUtils`是通用名称的方法。我会去`HttpRequestParser`什么的。您还需要一个工厂，它将根据请求的内容类型（`XmlRequestParser`或`JsonRequestParser`）创建适当的实现。

就解析而言，我建议将 XML 和 JSON 解析为一些任意的内部表示 (IR)，这样堆栈中较高的代码就不会关心这些细节。IR 可以是 XML 文档或某些对象图。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T07:56:36.163

到底是`BodyWrapper`为了什么？不应该`parseBody`只返回反序列化的对象吗？这可能是一个模型对象，也可能只是一袋值（字典/地图/哈希表）。

因此，`parseBody`需要检查 POST 的类型，然后反序列化。你期待什么数据？结果应该是代表您希望客户端以某种方式发布的实际*数据的类型，无论它是**如何*发布的（jason / xml）`java`

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T07:53:29.773

JSONObject 和 DOM 节点彼此无关，继承方面。这意味着为了重载返回类型，它必须返回`object`。这是一种令人讨厌的代码气味，因为您可能必须使用自省来找出返回的内容。通常在这种情况下，您应该在对象（身体）上使用虚拟方法，该方法能够根据实际情况以正确的方式作用于身体。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T09:19:12.267

只是为了给您更多思考的余地，访问者模式的一种变体，其中数据类型与交互无关，*可以*在这里为您提供帮助。

但老实说，在这种特殊情况下，根据您的实际用例，它也可能被证明是矫枉过正。

这是一些伪代码：

```
interface BodyTypesVisitor
{
   void visit( DOMNode domNode );
   void visit( JSONObject jsonObject );
}

interface BodyWrapper
{
    void accept( BodyTypesVisitor );
}

interface HttpUtils
{
    BodyWrapper parseBody( HttpServletRequest req );
}

class DOMVisitor implements BodyTypesVisitor
{
   void visit( DOMNode domNode ) { /* do something useful with domNode */ }
   void visit( JSONObject jsonObject ) { /* ignore */ }
}

class DOMBody implements BodyWrapper
{
    ...

    void accept( BodyTypesVisitor visitor )
    { visitor.visit( this->domNode ); }

    private DOMNode domNode;
}

...
// Process DOM
BodyWrapper wrapper = <some HttpUtils implementation that creates a DOMBody>
DOMVisitor visitor = new DOMVisitor();

wrapper.accept(visitor); 
```

如果您想要以几种不同的方式处理一组独特且相对静态的“数据类型”，则访问者模式通常很有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T07:57:48.907

在这个级别上，抽象似乎很困难。您如何处理作为正文返回的 JSONObject 或 DOM？通常更容易更进一步。是否可以将两者转换为相同的 Java 结构？根据内容类型，创建正文解析器的 JSOn 或 DOM 实现，并在处理正文的代码中使用解析器创建的结果 java 结构。如果需要（创建正确的答案格式），您可以从答案中获取原始内容类型（getMimeType() 或类似的东西）。

# linux - 如何克隆 OpenLDAP 数据库

> ID：792563
> 
> 赞同：41
> 
> 时间：2009-04-27T07:51:55.923
> 
> 标签：linux, ldap, redhat, openldap

我知道这更像是一个 serverfault 问题而不是一个 stackoverflow 问题，但是由于 serverfault 还没有启动，所以我开始了：

我应该将应用程序从一台 redhat 服务器移动到另一台服务器，并且在不了解应用程序的内部工作原理的情况下，我如何将 OpenLDAP 数据库从一台机器移动到另一台机器，以及模式和所有内容。

我需要复制哪些文件？我相信设置是相当标准的。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2010-05-25T05:08:34.453

[SourceRebels](https://stackoverflow.com/users/27507/sourcerebels)回答的问题在于，`slapcat(8)`不能保证数据是为`ldapadd(1)`/排序的`ldapmodify(1)`。从手册页：

```
此工具生成的 LDIF 适合与 slapadd(8) 一起使用。
由于条目是按数据库顺序排列的，而不是优先顺序，它们
如果不先重新排序，则无法使用 ldapadd(1) 加载。

```

加上使用一个工具，使用后端文件转储数据库，然后使用一个通过ldap协议加载ldif的工具，不是很一致。

我建议使用`slapcat(8)`/ `slapadd(8)` **OR** `ldapsearch(1)` /的组合`ldapmodify(1)`。我更喜欢后者，因为它不需要 shell 访问 ldap 服务器或移动文件。

例如，从 dc=master,dc=com 下的主服务器转储数据库并将其加载到备份服务器中

```
$ ldapsearch -Wx -D "cn=admin_master,dc=master,dc=com" -b "dc=master,dc=com" -H ldap://my.master.host -LLL > ldap_dump-20100525-1。 ldif
$ ldapadd -Wx -D "cn=admin_backup,dc=backup,dc=com" -H ldap://my.backup.host -f ldap_dump-20100525-1.ldif

```

上面的 -W 标志提示输入 ldap admin_master 密码，但是由于我们将输出重定向到一个文件，您不会看到提示 - 只是一个空行。继续并输入您的 ldap admin_master 密码，它就会起作用。在运行 ldapadd 之前，需要删除输出文件的第一行（输入 LDAP 密码：）。

最后一个提示是打开（添加）标志`ldapadd(1)`的硬链接。`ldapmodify(1)``-a`

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-07-23T01:41:53.173

ldapsearch 和 ldapadd 不一定是克隆 LDAP 数据库的最佳工具。slapcat 和 slapadd 是更好的选择。

使用 slapcat 导出数据库：

```
slapcat > ldif 
```

使用 slapadd 导入数据库（确保 LDAP 服务器已停止）：

```
slapadd -l ldif 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-27T09:36:43.177

一些约会：

*   将您的个性化模式和对象类定义保存在您的新服务器上。您可以在 slapd.conf 中查找包含的文件以获取它，例如（这是我的 slapd.conf 的一部分）：

    包括 /etc/ldap/schema/core.schema

*   在新的 openLDAP 安装中包含您的个性化模式和对象类。

*   使用[slapcat](http://www.openldap.org/software/man.cgi?query=slapcat&apropos=0&sektion=0&manpath=OpenLDAP+2.0-Release&format=html)命令将完整的 LDAP 树导出到单个/各种[ldif](http://en.wikipedia.org/wiki/LDAP_Data_Interchange_Format)文件。

*   使用[ldapadd](http://www.openldap.org/software/man.cgi?query=ldapadd&apropos=0&sektion=0&manpath=OpenLDAP+2.0-Release&format=html)将 ldif 文件导入到新的 LDAP 安装中。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-19T13:12:27.043

我更喜欢通过协议复制数据库：

首先确保您在两台服务器上具有相同的架构。

- 使用 ldapsearch 转储数据库：
ldapsearch -LLL -Wx -D "cn=admin,dc=domain" -b "dc=domain" > domain.ldif

- 并在新服务器中导入：
ldapmodify -Wx -D "cn=admin,dc=domain" -a -f domain.ldif

单行：
ldapsearch -LLL -Wx -D "cn=admin,dc=domain" -b "dc=domain" | ldapmodify -w pass -x -D "cn=admin,dc=domain" -a

通过使用 bin/ldap* 命令，您直接与服务器对话，而使用 bin/slap* 命令，您正在处理后端文件

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-30T13:23:52.873

（没有足够的声誉来写评论......）

Ldapsearch 打开与 LDAP 服务器的连接。Slapcat 直接访问数据库，这意味着不评估 ACL、时间和大小限制以及 LDAP 连接的其他副产品，因此不会更改数据。（马特·布彻，“掌握 OpenLDAP”）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-06-09T15:33:46.740

谢谢，维什。像魅力一样工作！我编辑了命令：

```
ldapsearch -z max -LLL -Wx -D "cn=Manager,dc=domain,dc=fr" -b "dc=domain,dc=fr" >/tmp/save.ldif

ldapmodify -c -Wx -D "cn=Manager,dc=domain,dc=fr" -a -f /tmp/save.ldif 
```

只需添加`-z max`以避免大小限制，`-c`即使目标域已经存在（我的情况）也可以继续。

# java - 如何从 TimePrimitive 转换为 int？

> ID：792564
> 
> 赞同：1
> 
> 时间：2009-04-27T07:52:23.303
> 
> 标签：java

我有一些数据值（TimePrimitive 类型），我需要将其写入文件，但方法 out.write() 仅将参数作为 int，因此我需要找到一种方法将我的值转换为 int

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:04:33.077

我认为这是错误的做法。如果要将对象写入文件，则需要使用 ObjectOutputStream 写入文件：

```
FileOutputStream fos = new FileOutputStream("t.tmp");
ObjectOutputStream oos = new ObjectOutputStream(fos);
oos.writeInt(12345);
oos.writeObject("Today");
oos.writeObject(new Date());
    oos.writeObject(myTimePrimitive);
oos.close(); 
```

正常的 out.write(int) 用于将一个简单的字节写入流，它会被 ObjectOutputStream 类隐式使用。

您可以使用 ObjectInputStream 读回您的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T08:14:35.683

您是否尝试过 getValue() 方法？

顺便说一句，您使用的是什么平台，Javascript 本身没有 TimePrimitive 类型，您确定这不是 Java 吗？

# c# - Windows Mobile App 不会运行超过一次

> ID：792571
> 
> 赞同：1
> 
> 时间：2009-04-27T07:55:55.323
> 
> 标签：c#, windows-mobile

我无法让我为 Windows Mobile 6.0 编写的应用程序在我的智能手机上运行多次。

我将它构建到 .cab 中，它第一次安装并运行良好，但如果我关闭应用程序并尝试再次启动它，除非我重新启动手机，否则它将无法运行。

我在关闭应用程序后检查了任务管理器，它没有显示出来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T07:59:46.233

您确定您正在正确关闭您的应用程序吗？我建议使用进程管理器来查看您的应用程序是否仍在后台运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T08:51:07.187

我的问题是当应用程序从其他表单之一退出时没有处理关闭主表单。例如：应用程序以加载计算器开始，用户从计算器表单加载单位转换表单，应用程序隐藏计算器。用户然后关闭单位表格，计算器仍在运行。

当用户尝试从其他表单之一关闭应用程序时，我错过的只是在我的主表单中处理 OnClosed 事件。

# smtp - 寻找 SMTP 服务器

> ID：792574
> 
> 赞同：-2
> 
> 时间：2009-04-27T07:58:53.677
> 
> 标签：smtp, email

我的网站托管在 Mediatemple，但发送邮件的 IP 地址被列入黑名单，因此不会传递 Hotmail 邮件。因此，我想使用另一个 SMTP 服务器。有人有建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T08:00:43.923

联系您的托管服务提供商并投诉。通常使用网络托管，公司会将 100 个域放在 1 个 IP 地址上（并不罕见）。如果该 IP 地址进入[spamhaus.org](http://www.spamhaus.org/)黑名单，那么您将陷入困境。

投诉。让他们给你自己的 IP 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T08:00:15.063

与编程无关。但是使用你的 ISP 的 smtp 服务器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T08:03:17.287

确实抱怨，因为如果您经营合法的 bisnuis（我猜您是女巫），您有权从托管 trought php（或其他形式）的您发送邮件

# css - CSS，自动调整 div 大小？

> ID：792583
> 
> 赞同：6
> 
> 时间：2009-04-27T08:00:53.487
> 
> 标签：css, html

我正在尝试使用 css 设计布局，我有一个主容器（div）和两个内部容器（div_upper 和 div_lower）。假设我想调整 div_upper 的大小，而 div_lower 会自动调整自己的大小，并且两个 div 仍然适合主容器。我确定这可以在 javascript 中完成，但是否有任何 CSS 来完成此操作？如果是这样，我会很高兴。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-10-21T15:22:05.243

另一种解决方案：

使用此类获取自动垂直高度 -

```
.getAutoHeight {
   position: relative;
   overflow: auto; /* edit by thobens: overflow: hidden seems to be better, as (at least) IE 8 shows always a disabled scrollbar with overflow: auto */
}

<div class="getAutoHeight ">
    any content<br />
    any content<br />
    any content<br />
    any content<br />
</div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T08:09:16.740

也许[A List Apart](http://www.alistapart.com)网站上的[这篇博](http://www.alistapart.com/articles/conflictingabsolutepositions)文会帮助您朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-26T15:30:23.543

CSS3 `resize`：

```
.thisDiv {resize:both;} 
```

# c# - 如何在 WPF XAML 中将 ControlTemplate Enabled 属性绑定到不透明度

> ID：792584
> 
> 赞同：3
> 
> 时间：2009-04-27T08:01:10.550
> 
> 标签：c#, wpf, xaml, controltemplate, opacity

在 XAML 内部的 WPF 中，如何扩展 ControlTemplate 以便当应用于按钮并且按钮被禁用时，它会在禁用时淡入 0.5 不透明度，一旦启用就会淡入 1.0 不透明度。

当父母被禁用时，这种视觉效果也应该起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T08:12:27.640

为此，您不需要 ControlTemplate。您可以仅使用样式来完成此操作。以下按钮样式适用于所有按钮。当 IsEnabled 为真时，它将 Opacity 设置为 0.5，并在触发条件不再适用时自动将其返回为 1。如果您在样式中应用 ControlTemplate，则可以将此触发器添加到该样式中。由于 IsEnabled 是继承的，因此在禁用父级时它也有效。

```
<Window.Resources>
    <Style TargetType="{x:Type Button}">
        <Style.Triggers>
            <Trigger Property="Control.IsEnabled" Value="false">
                <Setter Property="Control.Opacity" Value="0.5" />
            </Trigger>
        </Style.Triggers>
    </Style>
</Window.Resources> 
```

或者您是否特别需要 ControlTemplate 解决方案？

**更新**

我不认为 TemplateBinding 支持 Converter，因此如果您想在 ControlTemplate 中执行此操作，您需要在逻辑树中使用足够高的以下 Binding 语句。

```
Opacity={Binding Path=IsEnabled, 
         RelativeSource={RelativeSource TemplatedParent}, 
         Converter={StaticResource BoolToDoubleConverter}} 
```

其中 BoolToDoubleConverter 是一个 IValueConverter，它返回 1 表示真，0.5 表示假。如果您可以使用样式，我仍然会推荐样式方法。我相信要简单得多。

# jquery - jQuery 无法在 iPhone 上加载

> ID：792585
> 
> 赞同：11
> 
> 时间：2009-04-27T08:01:14.593
> 
> 标签：jquery, iphone, uiwebview, webkit

我正在尝试使用 UIWebView 来显示内容，并使用 jQuery 来操作该内容，但我无法加载 jQuery。这是我设置 UIWebView、设置 baseURL 和加载内容（本地包中的 HTML 文件）的代码：

```
UIWebView *view = [[UIWebView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]];

NSString *path = [[NSBundle mainBundle] bundlePath];
NSURL *baseURL = [NSURL fileURLWithPath:path];

NSData *htmlData = [[NSData alloc] initWithContentsOfURL: [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"index" ofType:@"html"]]];
NSString *htmlString = [[NSString alloc] initWithData:htmlData encoding:NSUTF8StringEncoding];
[view loadHTMLString:htmlString baseURL:baseURL]; 
```

内容加载得很好，我已经通过将图像添加到包并在 HTML 中引用它来确认 baseURL 是正确的，并且它可以工作。在我的 Macbook jQuery 上的 Safari 中使用相同的 HTML 加载也很好，并且按预期工作。

我已经尝试过使用压缩的 jquery-1.3.2.min.js 和开发的 jquery-1.3.2.js，但都没有骰子。

有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-28T08:38:28.567

呸！埃贝克！

结果当我将 jquery javascript 源复制到项目中时，它被复制到目标的“编译源”中，这当然会引发错误。我从“编译源”中删除了它，但没有将其添加回“复制捆绑资源”。

/me 反复拍打额头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T08:37:28.390

您是否尝试将 .html 和 .js 文件复制到应用程序的文档文件夹，并将 UIWebView 指向该本地文件夹？

# python - SQLAlchemy - 映射器配置和声明性基础

> ID：792588
> 
> 赞同：2
> 
> 时间：2009-04-27T08:02:23.433
> 
> 标签：python, sqlalchemy

我正在编写一个多媒体存档数据库后端，我想使用连接表继承。我正在使用带有声明性扩展的 SQLAlchemy 的 Python。保存媒体记录的表如下：

```
_Base = declarative_base()

class Record(_Base):
    __tablename__ = 'records'

    item_id = Column(String(M_ITEM_ID), ForeignKey('items.id'))
    storage_id = Column(String(M_STORAGE_ID), ForeignKey('storages.id'))
    id = Column(String(M_RECORD_ID), primary_key=True)
    uri = Column(String(M_RECORD_URI))
    type = Column(String(M_RECORD_TYPE))
    name = Column(String(M_RECORD_NAME)) 
```

该列`type`是一个鉴别器。现在我想`A`从类中定义子类 udioRecord `Record`，但我不知道如何**使用声明性语法**设置多态映射器。我正在寻找以下代码的等效项（来自 SQLAlchemy 文档）：

```
mapper(Record, records, polymorphic_on=records.c.type, polymorphic_identity='record')
mapper(AudioRecord, audiorecords, inherits=Record, polymorphic_identity='audio_record') 
```

如何将`polymorphic_on`,`polymorphic_identity`和`inherits`关键字传递给声明性扩展创建的映射器？

谢谢简

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T19:28:44.227

我终于在手册中找到了答案。

[http://www.sqlalchemy.org/docs/05/reference/ext/declarative.html#joined-table-inheritance](http://www.sqlalchemy.org/docs/05/reference/ext/declarative.html#joined-table-inheritance)

# nhibernate - 在 NHibernate 中使用 hql

> ID：792597
> 
> 赞同：2
> 
> 时间：2009-04-27T08:06:52.520
> 
> 标签：nhibernate, hql

我有两张桌子：

```
-- Table: medibv.btdbn

-- DROP TABLE medibv.btdbn;

CREATE TABLE medibv.btdbn
(
  mabn varchar(8) NOT NULL,
  hoten text,
  ngaysinh timestamp,
  namsinh varchar(4),
  phai numeric(1) DEFAULT 0,
  mann varchar(2),
  madantoc varchar(2),
  sonha varchar(15),
  thon text,
  cholam text,
  matt varchar(3),
  maqu varchar(5),
  maphuongxa varchar(7),
  userid numeric(5) DEFAULT 0,
  ngayud timestamp DEFAULT now(),
  hotenkdau text,
  nam text,
  image bytea,
  barcode bytea,
  CONSTRAINT pk_btdbn PRIMARY KEY (mabn) USING INDEX TABLESPACE medi_index,
  CONSTRAINT fk_btdbn_btddt FOREIGN KEY (madantoc)
      REFERENCES medibv.btddt (madantoc) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL,
  CONSTRAINT fk_btdbn_btdnn_bv FOREIGN KEY (mann)
      REFERENCES medibv.btdnn_bv (mann) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL,
  CONSTRAINT fk_btdbn_btdpxa FOREIGN KEY (maphuongxa)
      REFERENCES medibv.btdpxa (maphuongxa) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL,
  CONSTRAINT fk_btdbn_btdquan FOREIGN KEY (maqu)
      REFERENCES medibv.btdquan (maqu) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL,
  CONSTRAINT fk_btdbn_btdtt FOREIGN KEY (matt)
      REFERENCES medibv.btdtt (matt) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL
) 
WITH OIDS;
ALTER TABLE medibv.btdbn OWNER TO medisoft; 
```

和

```
-- Table: medibv.benhandt

-- DROP TABLE medibv.benhandt;

CREATE TABLE medibv.benhandt
(
  mabn varchar(8),
  mavaovien numeric(18) DEFAULT 0,
  maql numeric(18) NOT NULL DEFAULT 0,
  makp varchar(2),
  ngay timestamp,
  dentu numeric(1) DEFAULT 0,
  nhantu numeric(1) DEFAULT 0,
  lanthu numeric(3) DEFAULT 0,
  madoituong numeric(2) DEFAULT 0,
  chandoan text,
  maicd varchar(9),
  mabs varchar(4),
  sovaovien varchar(10),
  loaiba numeric(3) DEFAULT 0,
  userid numeric(5) DEFAULT 0,
  ngayud timestamp DEFAULT now(),
  cschandoan text,
  CONSTRAINT pk_benahndt PRIMARY KEY (maql),
  CONSTRAINT fk_benhandt_btdkp_bv FOREIGN KEY (makp)
      REFERENCES medibv.btdkp_bv (makp) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL,
  CONSTRAINT fk_benhandt_doituong FOREIGN KEY (madoituong)
      REFERENCES medibv.doituong (madoituong) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE SET NULL
) 
WITH OIDS;
ALTER TABLE medibv.benhandt OWNER TO medisoft; 
```

我将 NHibernate 与 C# 一起使用，并创建了两个类：`Btdbn`和`Benhandt`

我想在`Ilist`下面得到一个类似的 sql：

```
hql= "select tdbn.mabn, badt.mavaovien " +
    "from btdbn tdbn " +
    "     inner join benhandt badt on tdbn.mabn = badt.mabn"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T08:24:35.910

HQL 适用于类，而不适用于表。因此，您必须编写一个 HQL 查询，在其中查询映射到这两个表的类。如果您想通过 hql 查询返回无法由您的类之一（由 NHibernate 映射的实体类）表示的数据，那么您必须创建一个 DTO 类。此类具有将包含查询检索到的值的属性。为了能够做到这一点，您必须“导入”该类。

然后，您可以执行以下操作：

```
select new MyDTO(tdbn.mabn, badt.mava) from btdn tdbn inner join tdbn.mabn 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-24T21:02:29.970

Medisoft 这个名字引起了我的注意。我没有使用 HCL 的经验，但我想我会提到检查[Advantage Database 开发人员站点](http://devzone.advantagedatabase.com/dz/content.aspx?Key=17&SearchKeyWords=importing&tab=0)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-25T08:53:00.757

HQL 支持查询投影，因此您可以在不使用 DTO 的情况下编写查询：

```
var q = session.CreateQuery("select p.Name, p.TaxCode from Publisher p")
                    .List(); 
```

如果你想使用 DTO，你必须告诉 NH 在哪里可以找到 DTO 类。只需将导入元素添加到您的映射中：

```
<import class="ConsoleApplication2.PublisherDto" /> 
```

# .net - .NET 远程处理和 Delphi win32

> ID：792598
> 
> 赞同：3
> 
> 时间：2009-04-27T08:07:22.907
> 
> 标签：.net, delphi, winapi, remoting, ipc

是否可以（并且可行）将 .NET Remoting 接口与 Delphi win32 应用程序一起使用？

我需要 .NET 应用程序和 Delphi win32 应用程序之间的通信，因此 .NET 远程处理对于管道的另一端来说是本机的。

对于没有第三方库的两端，是否有任何其他解决方案，尽可能接近原生？应用程序将在单独的 Windows 机器上运行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T09:18:35.047

因为它们运行在不同的机器上，你应该使用网络通信。SOAP 是一种通用的通信格式，可以轻松地为 .Net 和 Delphi win32 制作。但是 SOAP = XML = 慢。

对于我的公司，我们使用 RemObjects SDK 远程处理框架： [http ://www.remobjectssdk.com/](http://www.remobjectssdk.com/)

制作界面非常容易，为 .Net/Delphi/Php/c++/whatever 生成代码，也支持 SOAP，但我们使用二进制格式来提高速度（！）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T08:10:58.937

Delphi win23 和.Net 都对COM 对象有很好的支持。这是一个值得一试的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T08:27:28.460

从非.NET Delphi exe 中使用远程处理会非常痛苦。如果不知道 .NET 应用程序正在运行，那么 COM 互操作将是最简单的答案，因为有用于 COM 激活等的进程。存在不同机器的事实使事情变得复杂，但 DCOM 存在并且可以工作（我没有t 使用 .NET 和 Delphi 端点对其进行了测试）。

如果已知 .NET 应用程序*正在*运行（可能作为服务），您可以考虑一系列替代方案：

*   插座
*   http（可能是 POX over http，`HttpListener`在 .NET 服务器上使用）
*   `ServiceHost`SOAP（可能在 .NET 端使用 WCF ）
*   基于文件（大概是网络共享）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-15T21:17:38.697

我发现最近关于这个主题的文章有一个解决方案：http: [//www.codeproject.com/Articles/852750/NET-and-Delphi-Inter-Process-Communication-via-Nam](http://www.codeproject.com/Articles/852750/NET-and-Delphi-Inter-Process-Communication-via-Nam)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-21T17:57:12.153

到目前为止，对我来说与任何平台进行通信的最佳方式是通过 Sockets。现在，如果它是内部的，我更喜欢 PIPES 或 MAPPED 内存。

# .net - .NET 运行时是否在内部映射到 win32 函数调用？

> ID：792603
> 
> 赞同：11
> 
> 时间：2009-04-27T08:09:07.803
> 
> 标签：.net, c, winapi, runtime

换句话说，.NET 框架最终会在某处调用以完成其工作吗？或者微软是否在他们的 .NET 框架中完全重新创建了 win32 库的所有功能。

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-27T08:13:27.107

这是一种混合。显然，诸如 winforms 之类的东西主要是围绕 Win32 功能（或两者兼而有之）的包装，但 WPF 的管理要好得多（就实际控制代码而言；在幕后，正如 Mash 所指出的，它可能使用 DirectX 作为渲染）。同样，文件/网络访问之类的东西（必然）是操作系统对象的包装器，非托管锁对象也是如此`Mutex`- 但许多其他东西是 100% 托管的。

所以这不是一个简单的答案。

（编辑）另外 - 请记住，“.NET”是一个非常模糊的术语；Compact Framework、Micro Framework、Silverlight 等可能有不同的非 win32 实现。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T08:12:19.370

.NET 应用程序只是另一个 Win32 进程，所以没有什么神奇之处，显然它将使用下划线操作系统。甚至 .NET 库也在很大程度上使用 Win32。

例子：

*   内存管理是在内部为托管代码处理的，但对于进程本身，它的处理方式与任何其他 Win32 进程一样。

*   当前托管的线程也被实现为操作系统线程。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-27T08:51:46.670

**更新：**意识到我回答了错误的问题（你说的是运行时而不是类库）......哦，无论如何我都会保持下面的胡言乱语！

这取决于图书馆的一部分：

*   System.Xml 库**不**使用 MSXML
*   System.Reflection 不会，因为它都是基于 IL 的
*   System.Text 做和不做。有一些对字符串操作的“快速”调用
*   System.Text.RegularExpressions 不像 XML 命名空间一样，它都是使用 RegexRunner 内部类自定义的。
*   System.Diagnostics 使用 kernel32.dll 调用，例如 CreateProcess
*   System.IO 命名空间也确实 pinvoke
*   System.Threading 使用内部方法调用，最终（在 CLR 内部）调用 winapi 方法
*   System.Windows.Forms 是一个混合体，但最终使用 GDI
*   System.Net (NetworkStream) 使用 ws2_32.dll 例如 WSARecv(..)

那只是摆弄反射器。显然，作为 COM 服务器，Microsoft CLR 也严重依赖 win32。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-27T08:11:06.363

在某些情况下（可能是大多数情况？我没有反映整个框架）.NET 框架调用 win32。大多数控件只是带有一些新功能的 win32 控件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-27T08:14:29.710

是的，它在内部调用了 win32 函数。例如 File 类中的 OpenRead 方法包含：

```
 return new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.Read); 
```

它最终会调用：

```
 SafeFileHandle handle = CreateFile(lpFileName, dwDesiredAccess, dwShareMode, securityAttrs, dwCreationDisposition, dwFlagsAndAttributes, hTemplateFile); 
```

这是一个win32原生函数，在方法的深处。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-27T11:05:10.797

[Mono](http://mono-project.com/Main_Page)是 .net 运行时的实现，它当然不会映射到 win32 函数调用（至少在 linux 上）

我猜您的问题是指 Microsoft 实现的 .net 运行时。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T08:31:31.680

它确实像所有 Windows 应用程序一样调用 .NET API。但它不仅仅是一个简单的包装器或映射，它更准确地描述为一种抽象。

# git - 'receive-pack': 没有为 './.git' 启用服务

> ID：792611
> 
> 赞同：54
> 
> 时间：2009-04-27T08:12:32.333
> 
> 标签：git

（已经解决了，我正在为下一个人写这个）

我在一台计算机上运行 git daemon 并尝试与另一台计算机同步。

在计算机 A 上，我运行：

```
git daemon --reuseaddr --base-path=. --export-all --verbose 
```

在计算机 B 上，我运行：

```
git clone git://computerA/.git source # worked
cd source
git pull # worked
git push # failed with "fatal: The remote end hung up unexpectedly" 
```

在计算机 A 上，守护程序输出为：

```
[5596] Connection from 127.0.0.1:2476
[5596] Extended attributes (16 bytes) exist <host=localhost>
[5596] Request receive-pack for '/.git'
[5596] 'receive-pack': service not enabled for './.git'
[5444] [5596] Disconnected (with error) 
```

我要发布我找到的灵魂。如果您有更完整的答案，请继续添加。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-04-27T08:15:28.223

只需运行

```
git daemon --reuseaddr --base-path=. --export-all --verbose --enable=receive-pack 
```

（在计算机 A 上，而不是原始`git daemon`命令），并且推送有效。

请注意，您必须然后运行

```
git reset --hard 
```

在计算机 A 上使其“看到”计算机 B 的更改。

### 后期脚本

进行硬重置的问题在于它会覆盖您在计算机 A 上所做的任何本地更改。

最终我意识到拥有一个没有任何文件的单独存储库（一个[裸克隆](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html#setting-up-a-public-repository)）会更有意义，然后让计算机 B 推送到它，计算机 A 从中提取。这样，它可以双向工作并以平滑的方式合并所有更改。您甚至可以拥有两个裸克隆，每台计算机上一个，并在它们之间进行推拉。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-08-22T16:15:52.033

我遇到了这个错误，但对于那些使用 git-http-backend 的人来说，解决方案似乎有所不同。（git push/pull/clone over http 而不是 ssh 或 git）

这必须在远程服务器上完成，最好在创建时完成。 **（如果 repo 已经存在/正在使用，最后一行可以独立运行）**

```
$ mkdir eddies  # MAKE folder for repo
$ chown -R eddie:websrv eddies/  #ensure apache (webserver) can access it
$ cd eddies/
$ git --bare init --shared
Initialized empty shared Git repository in /var/git/eddies/
$ ls
branches  config  description  HEAD  hooks  info  objects  refs
$ git config --file config http.receivepack true 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-05-31T10:44:23.563

我对 git reset --hard 有一些问题，所以这是我的替代解决方案。

在本地克隆仓库上创建一个分支

```
git checkout -b my_new_branch 
```

在远程源 repo 上启用`receive-pack`服务

```
git daemon --reuseaddr --base-path=. --export-all --verbose --enable=receive-pack 
```

将新分支推送到远程源

```
git push origin my_new_branch 
```

将 origin 上的新分支与

```
git merge my_new_branch 
```

# css - 查找未应用的 CSS 规则

> ID：792623
> 
> 赞同：8
> 
> 时间：2009-04-27T08:18:15.800
> 
> 标签：css

我有一个很大的 CSS 样式表（大约 6500 行）。有什么方法可以确定哪些规则不适用于给定页面（firefox 插件、web util 或其他东西）？

谢谢！

PD：使用 Firebug 我可以找到适用的规则，但找不到不适用的规则。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-27T08:20:24.203

Firefox，添加扩展 Dust-Me 选择器。它就是这样做的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T15:04:22.017

在 FireFox 插件、Firebug 中，被其他规则覆盖的 CSS 规则被划掉。

# wpf - 在代码隐藏中测试 ListBox 的滚动条可见性

> ID：792624
> 
> 赞同：5
> 
> 时间：2009-04-27T08:18:17.593
> 
> 标签：wpf, listbox, scrollbar, visibility, code-behind

如何检查列表框的垂直滚动条在代码隐藏中是否可见？

我有一个带有 x:Name="listOfItems" 的列表框，它的底层 ScrollViewer 的 VerticalScrollbarVisibility 设置为自动。

设置ListBox的ItemsSource属性后，想检查verticalScrollbar是否可见，但不知道要检查哪个属性，也不知道如何深入到listbox的scrollviewer元素。

有什么建议么

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T08:56:06.537

您可以按此处所述找到 Listbox 的 ScrollViewer：[WPF - Animate ListBox.ScrollViewer.Horizo​​ntalOffset?](https://stackoverflow.com/questions/665719/wpf-animate-listbox-scrollviewer-horizontaloffset/665798#665798)

然后你可以使用 ComputedVerticalScrollBarVisibility 属性来检查滚动条是否可见：

```
ScrollViewer sv = FindVisualChild<ScrollViewer>(listOfItems);
Visibility scrollbarVisibility = sv.ComputedVerticalScrollBarVisibility; 
```

# apache-flex - 暂停时 Netstream 缓冲区长度为零。如何防止这种情况？

> ID：792625
> 
> 赞同：0
> 
> 时间：2009-04-27T08:18:46.343
> 
> 标签：apache-flex, flash, actionscript-3, flash-media-server, netstream

我正在使用 Flex 3 和 FMS3 并发送视频流。我希望用户能够暂停流，然后恢复它。为此，我使用了方法 pause() 和 resume()。问题是，当我调用 pause() 时，bufferLength 被释放并等于零。因此，当我恢复时，NetStream 需要重新开始缓冲，这意味着我从暂停的那一刻开始丢失所有视频，直到我按下恢复。暂停和恢复的意图似乎很重要。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T11:00:55.960

请参阅我的另一个问题。

[创建服务器端 DVR 应用程序，以便能够在 FMS 中录制 DVR](https://stackoverflow.com/questions/805897/create-server-side-dvr-application-to-be-able-to-record-dvr-in-fms)

如果可能，请关闭这个。

问候尼古拉斯

# python - Python 是适合这个钉子的锤子吗？（构建脚本）

> ID：792629
> 
> 赞同：18
> 
> 时间：2009-04-27T08:19:11.553
> 
> 标签：python, build-process, build-automation

目前我正在使用 Windows 批处理文件来构建我的软件。它执行诸如运行 MSBuild、复制文件、创建 ZIP 文件、运行一些测试（包括 subversion 修订号等）之类的操作。

但问题是，批处理文件是邪恶的。所以我想换个更好的东西。我打算用 Python 重新创建我的构建脚本。这是一个明智的选择吗？那么所有这些构建系统呢，比如 Ant、SCons、Maven、Rake 等。使用其中任何一个是更好的选择吗？

注意：我不打算替换我的 Visual Studio 解决方案/项目文件。我只想编写创建我的软件版本所需的所有其他内容。

**编辑：**我有充分的理由远离批处理，这不是我的问题所在。我想知道（例如）SCons 通过普通的 Python 脚本给了我什么。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-27T08:32:34.657

对于使用 Python 编写脚本的工具，我碰巧认为[Paver](http://www.blueskyonmars.com/projects/paver/)是一个比 SCons 更易于管理和更灵活的构建自动化程序。与 SCons 不同，Paver 专为管理和分发软件项目的大量非编译程序任务而设计。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-27T08:35:01.377

批处理文件并不邪恶——它们实际上已经从 command.com 的脑死亡时代走了很长一段路。如今，命令语言可以非常富有表现力，只需要您付出一些努力来学习它。

除非您的构建脚本存在您无法修复的实际*问题*（如果是这种情况，那么您应该问这个问题，而不是一些空洞的“什么是最好的替代品？”:-)，我的方法会坚持你所拥有的。

一种模糊的邪恶感不会成为我浪费精力“修复”未损坏的东西的理由。除非改变有明显的优势（“减少邪恶”并不是我认为的明显优势），否则这将是浪费精力。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-27T08:28:34.603

当您提到 Python 和 SCons 时，我会说选择 SCons。毕竟是 Python。是的，以上任何一个都比手动构建脚本更好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T08:24:20.497

我已经看到用于在其他地方构建版本的 python 脚本，所以它不会很糟糕。实际上，我个人使用 perl 脚本来自动化发布构建。我想任何脚本语言都可以轻松地自动化该过程。如果它很容易做到（并且可能比批处理脚本更好），为什么不试试呢？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-27T12:29:26.787

我建议将 NAnt 用于您的构建脚本而不是 python。我这样做的原因是：

*   它已经定义了任务，您需要做的就是编写 XML 并将其指向正确的位置。如果您与不了解 python 的人一起工作，XML 可能比学习一门新语言更可怕。
*   NAnt 设计用于在 windows .Net 环境中工作，因此它已经可以执行 MSBuild 和 NUnit 任务。
*   如果您已经在使用 C# 编写代码，如果您需要扩展 NAnt 来执行新任务，那么您不会在项目组合中添加另一种语言。
*   您可以连接到[Cruise Control .Net](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)（用于持续构建）。我认为这是您使用 NAnt 的主要原因。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-27T12:50:56.470

为什么要使用 python？如果您的构建脚本没有损坏，请不要修复它。如果您在更新它以处理项目的新添加时遇到问题，那么您可能需要考虑重写它。尽管 NANT 或 MSBuild 之类的工具可以完成这项工作，但我不会使用 Python。除非您有很多现有工具无法处理的模糊要求，否则我认为使用通用的 purpis 编程语言来做工具已经编写好的事情没有意义。其次，如果您被公共汽车撞到或中了乐透怎么办？如果您决定编写所有脚本，我会使用 powershell 或其他一些 Microsoft 特定技术，因为您已经与 Microsoft 结了婚。如果你离开，会有足够的 Python 程序员来维护构建脚本吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-27T13:31:40.820

我强烈建议看看[waf](http://code.google.com/p/waf/)。这就是你想要的：“一个基于 Python 的框架，用于配置、编译和安装应用程序”

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-27T08:29:02.140

鉴于此，我个人会使用脚本作为最后的手段

*   通过一些工作，您可以让 MSBuild 为您完成所有这些事情，方法是使用其他组件对其进行扩展
*   [有像NANT](http://nant.sourceforge.net/)这样的MSBuild 的第三方等价物可以做同样的事情
*   有像[FinalBuilder](http://www.finalbuilder.com/)这样的完整工具也可以做同样的事情，并且更容易配置和扩展

但是，如果我不得不走脚本路线，我会使用 Powershell 有几个原因：

*   完全访问文件系统
*   您可以轻松访问 .NET 对象
*   您可以轻松访问 COM 对象

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-27T08:40:17.760

您可以为已安装的 Microsoft nmake 工具创建自定义 makefile。使用这样的工具（SCons、Maven 等属于同一类别）比常规脚本提供的更多。

主要好处是跟踪文件之间的依赖关系以及更改的时间戳。例如，您可以使您的 .zip 文件依赖于其他一些文件，因此 .zip 只有在其中一些文件同时发生更改时才会重新打包。就像源代码及其编译形式一样。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-27T08:41:21.470

Python 非常便携。SCons 经过现场测试且可靠。鉴于您所知道的（根据您的解释），为什么还要问这个问题？

如果您维护某些东西，不仅仅是让它构建，还在于向用户解释为什么它不能构建，这可以在帮助用户自助的同时为您节省大量非常令人沮丧的问题。

除非您进入嵌入式/研究领域，否则我想不出缺少 Python 的现代生产操作系统。

所以，我回答说，你回答了你自己的问题:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-27T12:50:41.853

这取决于您的软件使用什么技术。如果您正在构建 C++ 程序，我可能会说毫无疑问地使用 scons（除非您有 scons 无法满足的奇怪要求）。另一方面，请考虑构建 C# 的说明： [CSharpBuilder](http://www.scons.org/wiki/CsharpBuilder)。

> 我想知道（例如）SCons 通过普通的 Python 脚本给了我什么。

将 scons 视为更多的库而不是程序。它为您提供的代码可以避免您在没有它的情况下必须处理的大量单调乏味的事情。在我看来，vanilla Python 不是任何类型的 shell 脚本的最佳选择（不是它做不到）。

> 但问题是，批处理文件是邪恶的。

最后，如果将批处理文件用于不适合处理的项目，则它们是邪恶的。对于一两个文件项目，批处理文件就可以了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-30T15:27:21.990

> 它执行诸如运行 MSBuild、复制文件、创建 ZIP 文件、运行一些测试（包括 subversion 修订号等）之类的操作。

MSBuild 和 PowerShell 可以通过相当简洁的代码轻松完成所有这些工作。然后，您将坚持使用经理倾向于喜欢的纯 M$ 产品。否则，我建议您不仅可以考虑 Rake 的大型社区，还可以研究它。它有一个很好的语法和铁红宝石支持（irake）。

老实说，除了您提到的最后一项任务之外，仅在 MSBuild 中就可以***轻松完成所有任务。***我建议在去其他地方之前学习你拥有的工具。

查看[http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/)了解 MSBuild 的一些不错的附加组件

# java - 秘密握手反模式

> ID：792632
> 
> 赞同：9
> 
> 时间：2009-04-27T08:21:30.487
> 
> 标签：java, anti-patterns

我刚刚遇到了一个我以前见过的模式，并想得到关于它的意见。有问题的代码涉及这样的接口：

```
public interface MyCrazyAnalyzer {
    public void setOptions(AnalyzerOptions options);
    public void setText(String text);
    public void initialize();
    public int getOccurances(String query);
} 
```

预期的用法是这样的：

```
MyCrazyAnalyzer crazy = AnalyzerFactory.getAnalyzer();
crazy.setOptions(true);
crazy.initialize();
Map<String, Integer> results = new HashMap<String, Integer>();
for(String item : items) {
    crazy.setText(item);
    results.put(item, crazy.getOccurances);
} 
```

其中有一些原因。setText(...) 和 getOc​​curances(...) 之所以存在，是因为在对数据进行相同的昂贵分析之后，您可能想要执行多个查询，但这可以重构为结果类。

为什么我认为这很糟糕：实现以接口未明确指示的方式存储状态。我还看到过类似的事情，涉及需要调用“prepareResult”，然后是“getResult”的接口。现在，我可以想到使用其中一些功能的精心设计的代码。Hadoop Mapper 接口扩展了 JobConfigurable 和 Closeable，但我看到了很大的不同，因为它是一个使用用户代码实现这些接口的框架，而不是一个可以有多个实现的服务。我认为与包含必须调用的“关闭”方法相关的任何事情都是合理的，因为没有任何其他合理的方法可以做到这一点。在某些情况下，例如 JDBC，这是抽象泄漏的结果，但在我想到的两段代码中，它

我的问题是：

1.  每个人都同意这是一个设计不佳的界面吗？
2.  这是描述的反模式吗？
3.  这种初始化是否属于接口？
4.  这对我来说似乎是错误的，因为我偏爱函数式风格和不变性吗？

如果这很常见以至于值得命名，我建议对接口使用“秘密握手”反模式，当接口本身不是有状态的（如集合）时，它会强制您以特定顺序调用多个方法。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-27T09:18:07.870

是的，这是一种反模式：[顺序耦合](http://en.wikipedia.org/wiki/Sequential_coupling)。

我将重构为`Options`- 传递给工厂，并`Results`从`analyseText()`方法返回。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T08:35:47.503

1.  我希望看到 AnalyzerFactory 通过必要的参数并自行构建；否则，它到底在做什么？
2.  不确定它是否有名字，但它似乎应该:)
3.  是的，有时在你的接口中使用 setter 并期望类调用它们是很方便的（并且是正确的抽象级别）。我建议这样做**需要**大量记录该事实。
4.  不是真的，不。对不变性的偏好当然是一件好事，基于 setter/bean 的设计有时也可能是“正确”的选择，但是您给出的示例太过分了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T08:36:30.687

我不确定它是否是一种描述的反模式，但我完全同意这是一个设计不佳的界面。它给错误留下了太多的机会，并且至少违反了一个关键原则：让你的 API 难以被滥用。

除了滥用之外，如果多个线程使用同一个实例，此 API 还可能导致难以调试的错误。

[Joshua Bloch](http://en.wikipedia.org/wiki/Joshua_Bloch)实际上对 API 设计进行了出色的[演示](http://www.infoq.com/presentations/effective-api-design)（36 分 16 秒和 40 分 30 秒），他将此作为设计不佳的 API 的特征之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T09:11:41.270

我看不出这里有什么不好的。`setText()`准备舞台；之后，您有一个或多个调用`getOccurances()`. 由于`setText()`太贵了，我想不出任何其他方法来做到这一点。

`getOccurances(text, query)`将以巨大的性能成本修复“秘密握手”。您可以尝试缓存文本`getOccurances()`并仅在文本更改时更新您的内部缓存，但这开始看起来越来越像是对某些 OO 原则的牺牲。如果一条规则没有意义，那就不要应用它。软件开发人员有头脑是有原因的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-23T23:44:51.303

一种可能的解决方案 - 使用 Fluent chaning。这避免了包含需要按特定顺序调用的方法的类。这很像构建器模式，它确保您不会读取仍在填充中间的对象。

# java - 如何在java中做演员（erlang）？

> ID：792638
> 
> 赞同：5
> 
> 时间：2009-04-27T08:25:15.690
> 
> 标签：java, erlang, concurrency, actor

我在 Java 中从事金融应用程序的工作，并且获得正确的并发性是很痛苦的。Erlang 和演员模型应该非常适合大规模并发应用程序，但我不知道如何在 Java 中做到这一点。我知道有 Jetlang、FunctionalJava、kilim 等库，但它们通常不会超出简单的示例。

假设我需要处理三个或四个不同的事件，例如从市场数据馈送、订单/交易馈送中计算一些数字以及“输出”这些数据的一些衍生产品。大多数情况下，这些事件或数据流需要按顺序处理（至少相对于某些键的顺序...例如，特定交易品种的所有订单都必须按顺序处理，但与尊重不相关的符号）

我用改变状态的方法创建了一个普通的 Java 对象。我没有让这些方法直接改变状态，而是将它们的参数（通过将它们转换为命令对象）放入一个 fifo 队列（erlang 的邮箱），以及一个处理该队列的 react() 方法。这样，所有更新都必须经过一个队列，并且 react() 方法一次只能访问一个更新。从理论上讲，这应该让我无需在此方法上锁定或同步。

然而，这个队列基本上是一个生产者/消费者队列，这意味着它是一个阻塞队列。阻塞对可扩展性非常不利。此外，拥有一个队列意味着我的所有更新命令对象（不同类型的）都以一些过于通用的超类型（如 Object）从队列中出来，我必须将它们转换回正确的类型并让 react() 处理它们.

一旦这个演员化的对象产生一个输出，被另一个这样的对象消费，我就会经历同样的过程。换句话说，我已经将编程模型从面向对象（使用返回结果的方法）更改为某种持续传递噩梦，在这种噩梦中我的所有方法都变为异步。

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-06-25T10:30:45.140

最近[，akka](http://akka.io)为 Scala 提供了一个基于 Erlang 的 actor 框架。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T08:28:35.167

使用最近出现的优秀 Actors 库之一。[Alex Miller 为Javaworld on Actors](http://www.javaworld.com/javaworld/jw-02-2009/jw-02-actor-concurrency1.html)写了一篇很好的两部分。

我个人也挺喜欢[演员公会的](http://actorsguildframework.org/tutorial.xhtml)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T08:55:21.140

您可能还想研究 Scala 的参与者（您可以将它们视为一种 Java 库），例如：[忙碌的 Java 开发人员的 Scala 指南：深入了解 Scala 并发性](http://www.ibm.com/developerworks/java/library/j-scala04109.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-27T01:45:02.953

您可能还想看看[esper](http://esper.codehaus.org/)，它不像前面提到的参与者框架那么低级，更像是您在参与者框架之上构建的通用事件处理系统。非常成熟、完整，我认为是为金融交易中的复杂事件处理而开发的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-31T00:14:25.307

您可以考虑另一种选择，即**Netty**和**LMAX Disruptor**，它们都是用纯 Java 编写的。**Netty**是一个异步事件驱动的网络应用程序框架，用于快速开发可维护的高性能协议服务器和客户端。

# [![在此处输入图像描述](https://i.stack.imgur.com/iPkfF.png)](https://i.stack.imgur.com/iPkfF.png)

**什么是破坏者？**

LMAX旨在成为世界上最快的交易平台。显然，为了实现这一点，我们需要做一些特别的事情来使用我们的 Java 平台实现非常低的延迟和高吞吐量。性能测试表明，使用队列在系统的各个阶段之间传递数据会引入延迟，因此我们专注于优化这一领域。

Disruptor 是我们研究和测试的结果。我们发现 CPU 级别的缓存未命中和需要内核仲裁的锁都非常昂贵，因此我们创建了一个框架，它对其运行的硬件具有“机械同理心”，并且是无锁的......

（这取自[https://lmax-exchange.github.io/disruptor/](https://lmax-exchange.github.io/disruptor/)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-30T23:51:41.970

Kontraktor 是一个为 java 8 设计的新演员库。[https://github.com/RuedigerMoeller/kontraktor](https://github.com/RuedigerMoeller/kontraktor)

# mysql - 编写逻辑将数据存储在Mysql中以存储文件的元数据

> ID：792640
> 
> 赞同：-1
> 
> 时间：2009-04-27T08:26:02.940
> 
> 标签：mysql, stored-procedures, logic

让我解释一下场景：我需要获取文件的所有元数据，即标题、作者、主题.. 和自定义属性。（自定义属性不是固定的，它们不是固定的，可以是任意数字）。

现在要存储这个结构，我设计了一个类似的数据库：MainTable：FileID，FileName，Title，Author，Subject

并存储自定义属性（因为数字和名称不固定）

（存储自定义属性名称）表 AttrType：AttrID、AttrName、AttrType（字符串或数字）

（存储客户属性值）和表 AttrValues：FileID、AttrId、AttrValue。

现在我得到了所有的文件元写入文件，我需要编写一些逻辑，以便我可以将正确的数据放入正确的表中。我完全被卡住了，不知道从哪里以及如何开始。有没有人可以帮助我。

我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T08:57:14.037

您需要使用某种编程语言的外部程序来执行这些操作。数据库是用来存储数据的，而不是像 Java、Python 或 C 这样的通用编程语言。

# c# - 如何从 C# 获取 Word 文档的文件名？

> ID：792649
> 
> 赞同：6
> 
> 时间：2009-04-27T08:28:44.400
> 
> 标签：c#, .net, ms-word, vsto

我正在开发一个 MS Word 插件 (VSTO)。我的想法是我处理一个 Word 文档并将其发送到某个地方。

我有我需要的所有代码，除了一件事：有没有一种方法可以获得我正在处理的 Word 文档的文件名？（假设已经保存）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-27T08:47:26.807

**代码隐藏 .cs 文件中的this.FullName**属性应该为您提供当前文档的完整路径。

这是我的 QuickWatch 窗口中的确切查询。

```
((Microsoft.Office.Tools.Word.Document)(this)).FullName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-02T02:14:41.147

以上对我不起作用，但这确实

```
Document vstoDocument = Globals.Factory.GetVstoObject(this.Application.ActiveDocument);
string name = vstoDocument.Name
MessageBox.Show(name); 
```

# jquery - 使 Firebug 输出错误持续存在

> ID：792652
> 
> 赞同：1
> 
> 时间：2009-04-27T08:29:02.560
> 
> 标签：jquery, firefox, firebug

我的 JavaScript 中有一些错误，它应该打开一个包含图像的对话框（有效），然后在该图像上调用 JQZoom 插件（无效）。我认为 Firebug 会向控制台输出一些错误。我的代码应该拦截超文本链接的点击，然后返回`false`以防止浏览器移动到另一个页面。但是，由于 JQZoom 调用失败，它永远不会到达`return false`，导致页面切换，然后我看不到有什么错误。

那么有什么方法可以使 Firebug 输出错误持续存在吗？或者我可以在某处找到最新的错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T17:51:24.330

如果在错误发生之间有页面加载，理论上您可以在 Firefox 错误控制台（工具 | 错误控制台）中找到错误。我说理论上是因为最近我看到了没有在那里报告的实例，但我没有缩小这些实例的范围。

从那里，我通常设置断点来帮助调试脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T08:43:51.730

我不知道有什么方法可以按照您的要求进行操作，但是您可以尝试使用 FireBug 调试您的 javascript 代码。只需在执行代码之前放置一些断点，然后单步执行它们

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-27T08:54:19.083

我设法通过`setTimeout`在图像上调用 JQZoom 来“解决”这个问题。这样浏览器就可以`return false`在失败之前到达。Firebug 说有一个错误，但我在控制台中找不到任何东西......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-27T08:58:42.690

您可以从您的代码[登录到 Firefox/Firebug 控制台。](http://getfirebug.com/console.html)

[编辑] 这里的想法是您将有关对象状态的信息转储到控制台和/或在可疑代码周围放置一个 try/catch 块并将异常记录到控制台。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-27T09:58:39.943

在紧要关头，您可以使用权限升级：

netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");

和[文件 I/O](https://developer.mozilla.org/en/Code_snippets/File_I%2f%2fO)：

# c# - Winforms UserControl 显示具有反转颜色的矩形

> ID：792658
> 
> 赞同：0
> 
> 时间：2009-04-27T08:32:34.190
> 
> 标签：c#, .net, winforms, .net-2.0, c#-2.0

在 Winforms 应用程序（C#2、FX2.0、VC2008）中，我使用面板派生控件来显示自定义控件。控件是垂直排列的，并且通常在面板的可见区域中非常适合。

我画了一个小草图：

[小组 http://www.ericschaefer.org/Panel.png](http://www.ericschaefer.org/Panel.png)

有时（通常在面板内滚动后）矩形区域的颜色似乎反转（草图中的绿色部分）。这些区域的大小是随机的，但似乎总是在面板的右边缘。正如您在草图中看到的，面板滚动条的箭头按钮也被反转了，但拇指滑块和滚动区域没有。

倒色是指黑色变成白色，白色变成黑色，蓝色变成棕色，等等......

我没主意了。

*   这可能是由我的应用程序引起的吗？
*   甚至可以绘制滚动条箭头按钮吗？
*   有任何想法吗？

**编辑**：“[截图](http://www.ericschaefer.org/Foto119.jpg)”

**编辑**：我错了小组。它过去是一个面板，但现在是一个用户控件。像这样：

```
public class MyPanel : UserControl
{
    public MyPanel()
    {
        DoubleBuffered = true;
        BorderStyle = BorderStyle.Fixed3D;
        BackColor = Color.DarkBlue;
        VScroll = true;
        HScroll = false;
        AutoScroll = true;
        AutoScrollMargin = new Size( 0, 4 );
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:27:13.747

你在使用 System.Windows.Forms.Panel 吗？当您说面板派生控制时，您是什么意思？

如果您使用的是 System.Windows.Forms.Panel，那么这看起来像是自定义控件而不是面板的问题。

如果可能的话，您能否提供有关自定义控件的更多信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T10:46:31.933

从您的照片看来，某些内容已突出显示，但边框与任何可见控件都不匹配。

您是否有一个隐藏在其余部分后面的控件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T14:05:26.960

**解决了：** 显然这是触摸屏驱动程序的故障。我现在可以重现该行为。如果您通过触摸屏单击任何滚动条上的“向下滚动”按钮并按住它一段时间，当您松开它时它会继续滚动（按钮保持按下状态）。之后你可以随意点击，滚动条左侧总会有“反色”。任何应用程序都会发生这种情况（explorer.exe！）。现在它变得更好了：通常在 Windows 中，如果您拖动滚动条拇指按钮，如果您按住鼠标按钮，您可能会偏离滚动条。但是，如果您漂移得太远，按钮将弹回其原始位置（您开始拖动的位置）。尝试一下！反转颜色的矩形与您可以在没有按钮弹回的情况下漂移的区域一样宽。我什至不试图理解这一点。我们为触摸屏安装了更新的驱动程序，即使在您释放“向下滚动”按钮并且问题消失后，它也不会继续滚动。我的血压恢复正常，但我猜所有的白发可能都没有变黑......无论如何，谢谢......

# c# - GC.SuppressFinalize 有保证吗？

> ID：792660
> 
> 赞同：6
> 
> 时间：2009-04-27T08:33:11.333
> 
> 标签：c#, garbage-collection

我在实践中的观察是，[`GC.SuppressFinalize`](http://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize.aspx)并不总是抑制对终结器的调用。尽管如此，终结器可能会被调用。因此，我想知道是否`GC.SuppressFinalize`具有*请求*的性质而不是系统的*保证*？

* * *

**更多信息**

如果需要，以下信息可能有助于为问题提供更多背景信息。

文档摘要[`GC.SuppressFinalize`](http://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize.aspx)确实说明这是一个请求：

> 请求系统不调用指定对象的终结器。

我想知道这是对这个词的随意使用还是真的打算描述运行时行为。

我在[Schnell](http://code.google.com/p/schnell/)`SingletonScope`项目中的以下课程中观察到了这一点，该课程基于[Ian Griffiths 的原始想法，](http://www.interact-sw.co.uk/iangblog/2004/04/26/yetmoretimedlocking)但更通用。这个想法是在调试构建中检测该方法是否被调用。如果没有，终结器最终会启动，并且可以发出警告。如果被调用，那么*应该*防止终结器触发。不幸的是，警告似乎无论如何都会触发，但不是以一种确定性的方式。也就是说，它们不会在每次运行时都开火。`Dispose``Dispose``GC.SuppressFinalize`

 *```
#region License, Terms and Author(s)
//
// Schnell - Wiki widgets
// Copyright (c) 2007 Atif Aziz. All rights reserved.
//
//  Author(s):
//      Atif Aziz, http://www.raboof.com
//
// This library is free software; you can redistribute it and/or modify it 
// under the terms of the GNU Lesser General Public License as published by 
// the Free Software Foundation; either version 2.1 of the License, or (at 
// your option) any later version.
//
// This library is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or 
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public 
// License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with this library; if not, write to the Free Software Foundation, 
// Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA 
//
#endregion

namespace WikiPad
{
    #region Imports

    using System;
    using System.Diagnostics;

    #endregion

    //
    // NOTE: To use SingletonScope and ISingletonScopeHelper with value 
    // types, use Nullable<T>. For example, if the type of value to scope
    // is ThreadPriority then use ISingletonScopeHelper<ThreadPriority?>
    // and SingletonScope<ThreadPriority?>.
    //

    //
    // In debug builds, this type is defined as a class so a finalizer
    // can be used to detect an undisposed scope.
    //

    /// <summary>
    /// Designed to change a singleton and scope that change. After exiting
    /// the scope, the singleton is restored to its value prior to entering
    /// the scope.
    /// </summary>

    #if !DEBUG
    internal struct SingletonScope<T, H> 
    #else
    internal sealed class SingletonScope<T, H> 
    #endif
        : IDisposable 
        where H : ISingletonScopeHelper<T>, new()
    {
        private T _old;

        public SingletonScope(T temp)
        {
            _old = Helper.Install(temp);
        }

        private static H Helper
        {
            get { return new H(); }
        }

        public void Dispose()
        {
            //
            // First, transfer fields to stack then nuke the fields.
            //

            var old = _old;
            _old = default(T);

            //
            // Shazam! Restore the old value.
            //

            Helper.Restore(old);

            #if DEBUG
            GC.SuppressFinalize(this); // Only when defined as a class!
            #endif
        }

        #if DEBUG

        //
        // This finalizer is used to detect an undisposed scope. This will
        // only indicate that the scope was not disposed but (unfortunately)
        // not which one and where since GC will probably collect much later
        // than it should have been disposed.
        //

        ~SingletonScope()
        {
            Debug.Fail("Scope for " + typeof(T).FullName + " not disposed!");
        }

        #endif
    }
} 
```

* * *

[http://gist.github.com/102424](http://gist.github.com/102424)上提供了一个完整的工作示例，其中包含编译说明，但请注意，到目前为止，该问题无法确定地重现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T08:48:55.273

*您可能*会看到一个奇怪的现象，即使实例方法仍在运行，终结器仍然可以运行，只要该实例方法以后不使用任何变量即可。因此，在您的示例代码中，该`Dispose`方法在第一行之后不使用任何实例变量。然后可以最终确定该实例，即使`Dispose`它仍在运行。

`GC.KeepAlive(this)`如果您在方法的末尾插入一个调用`Dispose`，您*可能会*发现问题消失了。

Chris Brumme 有一篇关于这个的[博客文章](http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx)，我认为还有其他的……

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T09:14:04.760

我一直使用这种设计模式来实现 IDisposable 接口。（这是微软建议的）对我来说 GC.SuppressFinalize 总是具有保证的性质！

```
using System;
using System.ComponentModel;

//The following example demonstrates how to use the GC.SuppressFinalize method in a resource class to prevent the clean-up code for the object from being called twice.

public class DisposeExample
{
    // A class that implements IDisposable.
    // By implementing IDisposable, you are announcing that 
    // instances of this type allocate scarce resources.
    public class MyResource : IDisposable
    {
        // Pointer to an external unmanaged resource.
        private IntPtr handle;
        // Other managed resource this class uses.
        private readonly Component component = new Component();
        // Track whether Dispose has been called.
        private bool disposed;

        // The class constructor.
        public MyResource(IntPtr handle)
        {
            this.handle = handle;
        }

        // Implement IDisposable.
        // Do not make this method virtual.
        // A derived class should not be able to override this method.
        public void Dispose()
        {
            Dispose(true);
            // This object will be cleaned up by the Dispose method.
            // Therefore, you should call GC.SupressFinalize to
            // take this object off the finalization queue 
            // and prevent finalization code for this object
            // from executing a second time.
            GC.SuppressFinalize(this);
        }

        // Dispose(bool disposing) executes in two distinct scenarios.
        // If disposing equals true, the method has been called directly
        // or indirectly by a user's code. Managed and unmanaged resources
        // can be disposed.
        // If disposing equals false, the method has been called by the 
        // runtime from inside the finalizer and you should not reference 
        // other objects. Only unmanaged resources can be disposed.
        private void Dispose(bool disposing)
        {
            // Check to see if Dispose has already been called.
            if (!disposed)
            {
                // If disposing equals true, dispose all managed 
                // and unmanaged resources.
                if (disposing)
                {
                    // Dispose managed resources.
                    component.Dispose();
                }

                // Call the appropriate methods to clean up 
                // unmanaged resources here.
                // If disposing is false, 
                // only the following code is executed.
                CloseHandle(handle);
                handle = IntPtr.Zero;
            }
            disposed = true;
        }

        // Use interop to call the method necessary  
        // to clean up the unmanaged resource.
        [System.Runtime.InteropServices.DllImport("Kernel32")]
        private extern static Boolean CloseHandle(IntPtr handle);

        // Use C# destructor syntax for finalization code.
        // This destructor will run only if the Dispose method 
        // does not get called.
        // It gives your base class the opportunity to finalize.
        // Do not provide destructors in types derived from this class.
        ~MyResource()
        {
            // Do not re-create Dispose clean-up code here.
            // Calling Dispose(false) is optimal in terms of
            // readability and maintainability.
            Dispose(false);
        }
    }

    public static void Main()
    {
        // Insert code here to create
        // and use a MyResource object.
    }
} 
```

来源： [MSDN：GC.SuppressFinalize 方法](http://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-16T04:02:43.747

我在终结器中抛出了一个 InvalidOperationException ，这样可以很容易地找到没有正确处理的类型。在调用 GC.SuppressFinalize 的地方调用 Dispose() 时，我从来没有遇到异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T08:39:18.387

我已经多次使用完全相同的模式并且 GC.SupressFinalize 似乎总是有效。

请记住，对 GC.ReRegisterForFinalize 的调用将导致对象重新注册以进行终结。

每当我使用上述技术时，我总是确保在对象构造期间包含完整的堆栈跟踪，以便我可以追踪分配未处置对象的方法。

例如。在构造函数中使用

```
StackFrame frame = new StackFrame(1); 
```

并在终结器期间在您的调试消息中报告。

另外，我注意到您的 GC.SupressFinalize 不在 finally 子句中，如果在处置期间抛出异常，您的对象终结器将不会被抑制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-16T03:30:24.827

当一个具有用户定义终结器的对象被构​​造时，运行时必须保持对它的内部引用，因此当它在用户代码中变得不可访问时，它仍然可以在运行时的终结线程中调用终结器。考虑到调用终结器时时间很重要，如果用户请求禁止对象，则将对象保留在队列中是没有意义的。在我的测试 CLI 实现中，我在具有用户定义终结器的对象的标头中保留了一个 SuppressFinalizer 标志。如果当终结器线程到达队列中的该对象时标志为真，则将跳过终结器调用。我没有从队列中删除对象，所以我可以保持对`GC.SuppressFinalize()`O(1) 而不是 O( *N* ) 的调用，其中*N*是分配的可终结对象的数量（我以后可能会将此策略更改为延迟删除策略）。

# java - 用于 XML-> 对象模型的松弛器或 JAXB？

> ID：792661
> 
> 赞同：2
> 
> 时间：2009-04-27T08:33:58.850
> 
> 标签：java, xml, relaxng, relaxer

我想从我的 XML 定义中生成一个 AST，以便以后用于代码生成。

XML 模式是用 Relax NG 编写的，因为它看起来比 XSD 和 DTD（松散的假设）更简洁、更现代。我特别喜欢简洁的语法，它使用起来感觉更自然，并且比 XML 更具可读性。

有没有人使用过 Relaxer，或者任何其他使用 RelaxNG 模式的代码生成器（最好是紧凑的模式）？它们是否与 JAXB 和 Castor 一样好，还是我牺牲了一些我以后需要的功能？

经过一些进一步的研究，事实证明 JAXB 已经内置了对 RelaxNG 的支持，包括 XML 和紧凑样式。那么这一定是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-12T15:49:30.900

我发现使用 JAXB 直接从 RelaxNG 模式创建类并没有提供非常易读的类，但是如果我使用[http://www.thaiopensource.com/relaxng/trang.html](http://www.thaiopensource.com/relaxng/trang.html)将 RelaxNG 转换为 XSD，然后使用 JAXB 从 XSD 生成类结果非常好。

# javascript - Javascript/Silverlight 代理双重加载延迟

> ID：792668
> 
> 赞同：1
> 
> 时间：2009-04-27T08:37:21.587
> 
> 标签：javascript, silverlight, silverlight-2.0

我正在创建一个 Silverlight 应用程序，该应用程序将受到大量 javascript 的攻击。

为了启用 JS 交互，我创建了以下 SL 类：

```
[ScriptableType]
public class JavaScriptProxy
{
    private string _version;

    // provided for testing SL-JS integration
    [ScriptableMember]
    public void SmokeTest() { HtmlPage.Window.Alert("Hello world!"); }
} 
```

并将其加载到主 SL 应用程序的构造函数中：

```
public App()
{
    this.Startup += this.onStartup;
    this.Exit += this.Application_Exit;
    this.UnhandledException += this.Application_UnhandledException;

    InitializeComponent();

    // register javascript bridge proxy
    // (must register in constructor so proxy is available immediatly)
    HtmlPage.RegisterScriptableObject("JsProxy", new JavaScriptProxy());
} 
```

但是，由于这是一个 Javascript 繁重的应用程序，它必须可以通过 javascript 本身加载。

即一些东西：

```
// called on body.onLoad
function init() {

    var proxy;

    var el = document.getElementById("target_canvas");

    Silverlight.createObject(..., el, "agApp" ..., {

        onLoad: function() {
            proxy = agApp.Content.JsProxy;

            // ***this line is ok***
            proxy.SmokeTest();
        }

    });        

    // ***this line fails (of course)***
    proxy.SmokeTest();

} 
```

但是，这会引发错误，因为`agApp.Content.JsProxy`在触发 Silverlight onLoad 事件之前不完全可用，因此 JsProxy 字段不可用。

如何在创建 Silverlight 实例时*立即启用对 JsProxy 类的访问？*有些事情伴随着 while(_mutex); 可能是个坏主意。

我不得不这样做，因为在 Silverlight 应用程序实例的创建上将建立另一层抽象，因此该函数必须一次同步加载所有 SL 内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T03:31:53.510

这是因为 Silverlight 和 JavaScript 在单独的线程上运行。即使您已请求浏览器加载所述 Silverlight 控件，它也不会等待 Silverlight 完成加载，然后继续执行下一行。

您只能在 Silverlight 实例化它之后访问 JS 代理，因此您可以等待 OnLoad 事件触发（但这只会在整个 Silverlight.xap 完全加载后触发），或者在 RegisterScriptableObject 触发一个名为 onYourJSProxyNameLoaded 的 JavaScript 方法之后() 这将使您重新与所需的工作流程保持一致。

HTH。

- Scott Barnes / Rich Platforms 产品经理 / Microsoft。

# sql-server - 通过 Sql Server 2005 中的游标更新视图（使用而不是触发器）时的性能问题

> ID：792673
> 
> 赞同：2
> 
> 时间：2009-04-27T08:39:31.037
> 
> 标签：sql-server, sql-server-2005

我`V`在数据库中有一个视图，在该视图上定义了更新三个表`D1`的更新触发器，并且在数据库中。这三个表包含 0.75、6.0 和 450 万条记录。Sql Server 版本是 9.0.3042，开发者版。`U``T1``T2``T3``D2`

当我对上述视图执行以下更新语句时，它会在一秒钟内准备好：

```
UPDATE V
SET cust_task_id = 11975628
WHERE custno = '0319607' 
```

但是，当我发出以下批次时，需要 1 分 12 秒才能完成：

```
DECLARE CURSOR c
FOR SELECT custno, cust_task_id FROM V WHERE custno = '0319607'
FOR UPDATE OF cust_task_id

OPEN c
    FETCH NEXT FROM c

    UPDATE V
    SET cust_task_id = 11975628
    WHERE CURRENT OF c    
CLOSE c
DEALLOCATE c 
```

当我在 2000 版本的 Sql Server（8.0.2039，标准版）上使用相同的数据库（关于记录的定义和数量）和相同的更新语句时，两个批次都在一秒钟内返回！

当您查看两个版本的 Sql Server 上的游标批次的查询计划时，您会看到 2005 计划对表使用索引扫描`T1`，`T2`而`T3`2000 计划使用索引查找。所以这解释了性能上的差异。

我已经尝试`sp_updatestats`过 2005 年的数据库，但这并没有帮助。

有谁知道如何让 2005 游标批处理执行它应该如何执行？

提前感谢您抽出宝贵时间调查此事。

问候，

莱克斯·维贝克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T08:54:39.673

为了解决您的直接问题，不久前我们在 SQL 2000 中遇到了一个类似的问题，游标使用的数据源本身在游标循环期间被修改（在这种情况下，您从 V 中选择并更新 V）。从内存中（最好对此进行确认）游标的数据源已更新或重新生成，以使数据源与所做的更改保持同步。

我们的解决方案是首先将您的数据选择到临时表或表变量中，并将其用作光标的源。当然，您需要修改 SQL 代码以使用 ID 或其他唯一标识符进行更新，但我假设您在系统中有这些限制。

当然，听起来您的解决方案总体上确实有一些优化空间，例如游标通常不是首选方法 - 但您可能会发现上述方法可以使您达到可接受的性能水平，至少目前是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T08:51:52.007

您是否对 2000 版本与 2005 版本的架构进行了比较。

如果 2005 版本正在扫描而不是搜索，听起来您可能缺少用于创建 VIEW 的连接列之一上的索引

# sharepoint - 在网站集之间移动 Sharepoint Wiki

> ID：792678
> 
> 赞同：1
> 
> 时间：2009-04-27T08:41:15.730
> 
> 标签：sharepoint, sharepoint-2007, moss, wiki

我有两个共享点网站集。现在我有一个 Wiki，我想把它移到第二个。我创建了一个模板并将其导入新模板。我现在遇到的问题是链接。Wiki 链接指向旧位置。

有没有人可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:10:41.537

SharePoint Wiki 系统的问题在于它在保存时间将 Wiki 样式链接 [[link]] 解析为指向 Wiki 页面列表中页面的绝对链接。我认为您将需要编写一些代码来循环并更新您的 Wiki 页面中的文本。使用 WSS 对象模型来查找和更新代表 Wiki 页面的每个列表项。

您还可以查看[www.sharepointproducts.com](http://www.sharepointproducts.com)，您可以在其中下载免费版本的工具（SharePoint 的 CopyMove），该工具还可以跨网站集移动 Wiki 页面。但是，它不会更新 Wiki 页面上的链接。但它是我的工具 - 所以我会考虑是否添加对此的支持。这不是我第一次听说这个问题。

# c++ - html解析的正则表达式怎么写？

> ID：792679
> 
> 赞同：2
> 
> 时间：2009-04-27T08:41:21.283
> 
> 标签：c++, html, regex, boost, html-content-extraction

我正在尝试为我的 html 解析器编写一个正则表达式。

我想将 html 标签与包含一个或多个标签的给定属性（例如`<div>`with ）匹配。正则表达式应该匹配整个标签（从到）。我似乎总是遇到“内存耗尽”错误——我的程序可能会将它可以找到的每个标签都当作匹配的标签。`class="tab news selected"``<a href>``<div>``</div>`

我正在使用 boost 正则表达式库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T08:46:58.570

你可能应该看看[这个问题](https://stackoverflow.com/questions/590747/using-regular-expressions-to-parse-html-why-not)。正则表达式和 HTML。要点是使用正则表达式解析 HTML 绝不是理想的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T08:53:23.483

正如其他人所说，尽可能不要使用正则表达式。如果您的代码实际上是 XHTML（即它也是格式良好的 XML），那么我可以推荐[Xerces](http://xerces.apache.org/xerces-c/)和[Expat](http://expat.sourceforge.net/) XML 解析器，它们比正则表达式对您的工作要好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T20:26:52.943

您可能还会发现这些问题很有帮助：

[您能否提供一些示例说明为什么使用正则表达式难以解析 XML 和 HTML？](https://stackoverflow.com/questions/701166/can-you-provide-some-examples-of-why-it-is-hard-to-parse-xml-and-html-with-a-rege)

[你能提供一个用你最喜欢的解析器解析 HTML 的例子吗？](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T13:08:14.730

也许正则表达式不是最好的解决方案，但我已经在使用五个不同的库，并且在定位`<a href>`标签和关键字方面，boost 做得很好。

我正在使用这些正则表达式：

`/<a[^\n]*/searched attribute/[^\n]*>[^\n]*</a>/`用于定位`<a href>`标签和：

`/<a[^\n]*href[[^\n]*>/searched keyword/</a>/`用于定位链接

（顺便说一句，它可以做得更好吗？-我很讨厌正则表达式；））

我现在需要的是定位包含`<a href>`'s 的标签，我认为正则表达式会做得很好——也许我需要像 piotr 所说的那样编写自己的解析函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T10:44:35.540

像 flex 那样做：匹配 <div> 与不区分大小写的匹配，并将解析器置于“div 匹配”状态，继续处理输入直到 </div> 并重置状态。

这需要两个正则表达式和一个状态变量。

SGML 标记的有效字符为 [A-Za-z_:]

所以： /<[A-Za-z_:]+>/ 匹配一个标签。

# matlab - 紧凑的 MATLAB 矩阵索引符号

> ID：792683
> 
> 赞同：8
> 
> 时间：2009-04-27T08:44:01.213
> 
> 标签：matlab, indexing, matrix, notation

我有一个 n×k 大小的矩阵，每行包含 k 个数字。我想将这些 k 数字用作 k 维矩阵的索引。在 MATLAB 中是否有任何紧凑的方法，或者我必须使用 for 循环？

这就是我想要做的（在 MATLAB 伪代码中），但是以更 MATLAB 的方式：

```
for row=1:1:n
    finalTable(row) = kDimensionalMatrix(indexmatrix(row, 1),...
          indexmatrix(row, 2),...,indexmatrix(row, k))
end 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-27T13:44:36.810

如果您想避免使用 for 循环，这可能是最干净的方法：

```
indexCell = num2cell(indexmatrix, 1);
linearIndexMatrix = sub2ind(size(kDimensionalMatrix), indexCell{:});
finalTable = kDimensionalMatrix(linearIndexMatrix); 
```

第一行使用 将 的每一列`indexmatrix`放入元胞数组的单独元胞中[`num2cell`](https://www.mathworks.com/help/matlab/ref/num2cell.html)。这允许我们将所有`k`列作为[逗号分隔的列表](https://www.mathworks.com/help/matlab/matlab_prog/comma-separated-lists.html)传递给[`sub2ind`](https://www.mathworks.com/help/matlab/ref/sub2ind.html)，该函数将*下标索引*（行、列等）转换为*线性索引*（每个矩阵元素从 1 编号到矩阵）。最后一行使用这些线性索引来替换你的 for 循环。可以在[这里](http://www.mathworks.com/company/newsletters/digest/sept01/matrix.html)找到关于矩阵索引（下标、线性和逻辑）的一个很好的讨论。`N``N`

## 还有一些值得深思的...

许多 MATLAB 用户（包括我自己）已经习惯了回避 for 循环以支持矢量化解决方案的趋势。但是，较新版本的 MATLAB 处理循环的效率更高。正如另一个 SO question 的[答案](https://stackoverflow.com/a/831964/52738)中所讨论的，使用 for 循环有时会导致比使用矢量化解决方案更快地运行代码。

我当然不是说你不应该再尝试向量化你的代码，只是每个问题都是独一无二的。矢量化*通常*会更有效，但并非*总是*如此。对于您的问题，for 循环与矢量化代码的执行速度可能取决于值的大小`n`和`k`大小。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T09:09:06.347

要将向量的元素`indexmatrix(row, :)`视为单独的下标，您需要将元素视为元胞数组。所以，你可以做这样的事情

```
subsCell = num2cell( indexmatrix( row, : ) );
finalTable( row ) = kDimensionalMatrix( subsCell{:} ); 
```

不幸的是，要将 subsCell 扩展为逗号分隔列表，您确实需要两个单独的行。但是，此代码独立于`k`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T16:10:42.947

以hacky方式将您的子索引转换为线性索引

```
ksz = size(kDimensionalMatrix);
cksz = cumprod([ 1 ksz(1:end-1)] );
lidx = ( indexmatrix - 1 ) * cksz' + 1; #'
% lindx is now (n)x1 linear indices into kDimensionalMatrix, one index per row of indexmatrix
% access all n values:
selectedValues = kDimensionalMatrix( lindx ); 
```

干杯!

# javascript - javascript中的小时格式

> ID：792691
> 
> 赞同：6
> 
> 时间：2009-04-27T08:48:24.433
> 
> 标签：javascript

在我的 javascript iam 中使用 GetHour 和 GetMinutes 函数。例如：当前时间是 2:03。如果在这种情况下我使用 GetHour()，它返回 2。相反我需要 02。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T08:52:19.010

```
var hour = GetHour() < 10 ? '0' + GetHour() : GetHour(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T11:47:31.073

```
var d,h
d = new Date()
h = (h = d.getHours()) < 10 ? '0' + h : h 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T21:56:18.843

显而易见的答案是使用 IF 语句......

```
var dat = new Date();
var hr = dat.getHour();

if(hr < 10) {
  hr = "0" + hr;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-14T23:10:03.640

你总是可以做

```
var time = new Date();

('0' + time.getDate()).slice(-2) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T08:52:43.500

没有任何功能。使用以下命令添加前导 0：

```
var date = new Date();
var hours = new String(date.getHours());

if (hours.length == 1)
{
  hours = "0" + hours;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T08:57:27.560

[这里](http://www.javascripttoolbox.com/lib/date/)有一个 javascript 库，它看起来可以很好地处理各种日期转换，包括格式化日期，以便月份始终为两位数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T09:56:57.870

如果您使用[Prototype](http://www.prototypejs.org)框架，则有一种[`toPaddedString`](http://www.prototypejs.org/api/number#method-topaddedstring)方法可以做到这一点。

```
a = 2;
a.toPaddedString(2)
// results in "02" 
```

# php - 改变用户输入的正则表达式

> ID：792695
> 
> 赞同：0
> 
> 时间：2009-04-27T08:49:05.320
> 
> 标签：php, sql, regex, search

我正在搜索我的数据库。如果用户输入例如。“foo bar” 我想显示同时具有“foo”和“bar”的行。

我的 SQL 语法如下所示： SELECT * FROM t1 WHERE MATCH (t1.foo_desc, t2.bar_desc) AGAINST ('+foo* +bar*')

如何使用 PHP 中的正则表达式将用户输入“foo bar”更改为“+foo* +bar*”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T08:55:12.170

```
$match = '+' . implode('* +', explode(' ', $input)) . '*'; 
```

这假设输入不是空字符串；

编辑：正如@Bart S 指出的那样， str_replace （或 mb_str_replace 如果你正在处理多字节字符）会更简单......

```
$match = '+' . str_replace(' ', '* +', $input) . '*'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T08:55:28.673

您应该使用`\b`and`\B`来识别单词/非单词边界，从而插入您的 +/*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T08:59:52.657

首先，修剪用户输入并删除任何奇怪的东西（标点符号、引号，基本上所有内容`"\W"`，当然除了空白）。

然后，替换：

```
(?<=\w)\b 
```

和

```
"*" 
```

和：

```
\b(?=\w) 
```

和

```
"+" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T21:29:45.710

对于那些对 MATCH...AGAINST 语法感兴趣的人如果您以前没有使用过这篇文章，那么[这篇文章](http://www.devarticles.com/c/a/MySQL/Getting-Started-With-MySQLs-Full-Text-Search-Capabilities/)是一个不错的起点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T21:39:59.117

我会使用正则表达式将两个单词之间的空格替换为`* +`：

```
'+' . preg_replace('/\s+/', '* +', trim($input)) . '*' 
```

**编辑基本上，这是**[Tomalak 所说](https://stackoverflow.com/questions/792695/regular-expression-to-change-user-input/792737#792737)   的一个实现，`\s`而不是`\W`.

# ruby-on-rails - 路由中的模块名称范围

> ID：792700
> 
> 赞同：0
> 
> 时间：2009-04-27T08:51:56.047
> 
> 标签：ruby-on-rails, ruby, module

我有一个包含多个模块的 Intranet 应用程序，我希望它们在路由时分开。例如：

```
 http://intranet/calendar/...
 http://intranet/site_admin/...
 http://intranet/tasks/... 
```

每个模块可以有多个或单个控制器。如何编写这样的路线？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T09:34:01.700

您可以尝试使用命名空间：

```
map.namespace :calendar do |calendar|
  calendar.resources :first_controller
  calendar.resources :second_controller
end 
```

等等。人们经常将应用程序的管理部分放在管理名称空间中（看[这里](https://stackoverflow.com/questions/119197/the-rails-way-namespaces)）。尝试谷歌“rails 命名空间”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T08:10:05.043

此外，如果您可能想升级到最新版本，即 Rails 2.3。并将这些模块构建为单独的“引擎”。[http://railscasts.com/episodes/149-rails-engines](http://railscasts.com/episodes/149-rails-engines)

# sql-server-2008 - SQL Server 2008 - 最佳备份解决方案

> ID：792703
> 
> 赞同：1
> 
> 时间：2009-04-27T08:52:20.663
> 
> 标签：sql-server-2008, backup

我正在生产服务器上设置 SQL Server 2008 服务器，哪种方式最适合备份这些数据？我应该使用复制然后备份该服务器吗？我应该只使用一个简单的命令行脚本并导出数据吗？我应该使用哪种复制方法？

服务器将会很负载，所以我需要一个有效的方法。

我可以访问多台可以使用的计算机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T08:56:26.020

*一个非常简单但很好的解决方案是在本地使用sqlcmd*（以前称为*osql* ）运行完整备份，然后通过网络将 BAK 文件复制到 NAS 或其他存储。它在网络/磁盘使用方面不是最佳的，但它非常安全，因为每个备份都是独立的，并且考虑到该过程非常简单，它也非常强大。

此外，这甚至适用于 Express 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T09:26:02.050

“最佳”备份解决方案取决于您的恢复标准。

如果您需要在发生故障时立即访问数据，那么三服务器数据库镜像方案（实时、镜像和见证）似乎很适合 - 尽管您的应用程序可能需要调整以使用自动故障转移。“日志传送”可能会产生类似的结果（尽管没有自动故障转移，也不需要见证人）。

但是，如果在恢复时间中有一些回旋余地，那么定期对数据库进行计划备份（例如，通过 SQL 代理）及其事务日志将允许您进行时间点恢复。备份的频率取决于数据库大小、数据更新的频率以及在发生完全故障时您愿意回滚数据库的程度（除非您可以从故障服务器中提取事务日志备份，否则只能恢复到最新的备份）

如果您希望在用户错误之后简单地回滚到已知良好状态，您可以将数据库快照用作轻量级“备份”场景 - 但在服务器故障的情况下这些是无用的。它们几乎是即时创建的，并且仅在数据更改时才占用空间 - 但会产生轻微的性能开销。

当然，这些不是唯一的备份解决方案，它们也不是相互排斥的——只是想到的那些。

# c# - 为什么用两个数字来得到一个布尔值？

> ID：792708
> 
> 赞同：9
> 
> 时间：2009-04-27T08:54:22.780
> 
> 标签：c#, vb.net, digital

我正在开发一个基于 Velleman k8055 板的小型硬件接口项目。

示例代码来自 VB.Net，我将其重写为 C#，主要是为了有机会逐步了解代码并理解这一切。

有一件事让我感到困惑：

在一个阶段，他们读取所有数字输入，然后根据读取的数字输入（以整数返回）的答案设置一个复选框，然后他们将其与一个数字相加：

```
i = ReadAllDigital
cbi(1).Checked = (i And 1)
cbi(2).Checked = (i And 2) \ 2
cbi(3).Checked = (i And 4) \ 4
cbi(4).Checked = (i And 8) \ 8
cbi(5).Checked = (i And 16) \ 16 
```

我有一段时间没有做过数字系统了，我理解他们想要做什么，但是它对两个数字有什么影响？0以上的一切不等于真吗？

你会如何把它翻译成 C#？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-27T08:57:51.040

这是[按位与](http://msdn.microsoft.com/en-us/library/sbf85k1c%28VS.71%29.aspx)，而不是逻辑与。

其中每一个基本上确定是否`i`设置了单个位，例如：

```
5 AND 4 = 4
5 AND 2 = 0
5 AND 1 = 1 
```

（因为 5 = 二进制 101，而 4、2 和 1 分别是二进制 100、010 和 001 的十进制值。）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-27T08:58:27.217

我认为您必须将其翻译为：

```
i & 1 == 1

i & 2 == 2

i & 4 == 4 
```

等等...这是使用按位与运算符。

当您使用按位 AND 运算符时，此运算符将比较两个给定值的二进制表示，并返回一个二进制值，其中仅设置了那些位，这些位也在两个操作数中设置。

例如，当您这样做时：

2 & 2

它会这样做：

```
0010 & 0010 
```

这将导致：

```
 0010
 0010
&----
 0010 
```

然后，如果将此结果与 2 (0010) 进行比较，它当然会返回 true。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T09:15:23.883

只是补充一下：它被称为位掩码 [http://en.wikipedia.org/wiki/Mask_(computing)](http://en.wikipedia.org/wiki/Mask_(computing))

布尔值只需要 1 位。在大多数编程语言的实现中，布尔值需要不止一个位。在PC中这不会造成很大的浪费，但是嵌入式系统通常具有非常有限的内存空间，因此浪费确实很大。**为了节省空间**，布尔值被打包在一起，这样一个布尔变量只占用 1 位。

您可以将其视为执行**数组索引操作**之类的操作，其中一个字节（= 8 位）变成了一个由 8 个布尔变量组成的数组，所以也许这就是您的答案：使用一个布尔数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T08:58:18.090

用二进制考虑这个，例如

```
10101010

AND

00000010 
```

产量`00000010`

即不为零。现在如果第一个值是

```
10101000 
```

你会得到

```
00000000 
```

即零。

请注意进一步的划分，以将所有内容减少到 1 或 0。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T08:59:00.333

*(i and 16) / 16*提取第 5 位的值（1 或 0）。

```
1xxxx and 16 = 16 / 16 = 1
0xxxx and 16 = 0 / 16 = 0 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T08:59:49.723

[And](http://msdn.microsoft.com/en-us/library/sdbcfyzh(VS.71).aspx)运算符执行“...对两个数值表达式的按位连接”，映射到 '|' 在 C# 中。'` 是一个[整数除法](http://msdn.microsoft.com/en-us/library/2hxce09y.aspx)，在 C# 中等效的是`/`，前提是两个操作数都是整数类型。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T09:05:37.450

常数是[掩码](http://en.wikipedia.org/wiki/Mask_%28computing%29)（以二进制形式考虑它们）。所以代码所做的是对字节和掩码应用[按位与](http://en.wikipedia.org/wiki/Bitwise_operation#AND)运算符并除以数字，以获得位。

例如：

```
xxxxxxxx & 00000100 = 00000x000
if x == 1
    00000x00 / 00000100 = 000000001
else if x == 0
    00000x00 / 00000100 = 000000000 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-27T09:06:23.907

如前所述，这是按位与，而不是逻辑与。我确实看到这在我之前已经说过很多次了，但是 IMO 的解释并不那么容易理解。

我喜欢这样想：

写下彼此的二进制数（这里我在做 5 和 1）：

```
101
001 
```

现在我们需要将其转换为二进制数，其中第一个数字中的所有 1，也就是第二个数字中的所有 1 都被转移，即 - 在这种情况下：

```
001 
```

在这种情况下，我们看到它给出了与第二个数字相同的数字，其中此操作（在 VB 中）返回 true。让我们看看其他示例（使用 5 as i）：

（5和2）

```
101
010
----
000 
```

（错误的）

（5和4）

```
101
100
---
100 
```

（真的）

（5和8）

```
0101
1000
----
0000 
```

（错误的）

（5 和 16）

```
00101
10000
-----
00000 
```

（错误的）

编辑：显然我错过了问题的全部要点 - 这是对 C# 的翻译：

```
cbi[1].Checked = i & 1 == 1;
cbi[2].Checked = i & 2 == 2;
cbi[3].Checked = i & 4 == 4;
cbi[4].Checked = i & 8 == 8;
cbi[5].Checked = i & 16 == 16; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-27T09:28:55.350

在 C# 中，使用[BitArray 类](http://msdn.microsoft.com/en-us/library/system.collections.bitarray(VS.71).aspx)直接索引各个位。

要设置单个位*i*很简单：

```
b |= 1 << i; 
```

要重置单个位*i*有点尴尬：

```
b &= ~(1 << i); 
```

请注意，位运算符和移位运算符都倾向于将`int`可能意外需要转换的所有内容都提升到。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-27T19:37:38.660

我更喜欢在位旋转时使用十六进制表示法（例如 0x10 而不是 16）。当您增加位深度时，它更有意义，因为 0x20000 比 131072 更好。

# python - 早于 2.6 的 Python 版本中的字符串格式

> ID：792721
> 
> 赞同：35
> 
> 时间：2009-04-27T08:57:14.957
> 
> 标签：python, format

当我在 Python 2.5.2 中运行以下代码时：

```
for x in range(1, 11):
    print '{0:2d} {1:3d} {2:4d}'.format(x, x*x, x*x*x) 
```

我得到：

```
Traceback (most recent call last):
  File "<pyshell#9>", line 2, in <module>
    print '{0:2d} {1:3d} {2:4d}'.format(x, x*x, x*x*x)
AttributeError: 'str' object has no attribute 'format' 
```

我不明白这个问题。

从`dir('hello')`那里没有`format`属性。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-27T09:04:05.003

该`str.format`方法[在 Python 3.0 中引入，并向后移植](http://docs.python.org/3.0/whatsnew/2.6.html#pep-3101-advanced-string-formatting)到 Python 2.6 及更高版本。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-04-27T09:12:12.113

您的示例代码似乎是为 Python 2.6 或更高版本编写的，其中引入[了该`str.format`方法](https://docs.python.org/3/whatsnew/2.6.html#pep-3101-advanced-string-formatting)。

对于低于 2.6 的 Python 版本，使用[% 运算符](http://docs.python.org/library/stdtypes.html#string-formatting)将一系列值插入到格式字符串中：

```
for x in range(1, 11):
    print '%2d %3d %4d' % (x, x*x, x*x*x) 
```

* * *

您还应该知道，此运算符可以从映射中按*名称*进行插值，而不仅仅是位置参数：

```
>>> "%(foo)s %(bar)d" % {'bar': 42, 'foo': "spam", 'baz': None}
'spam 42' 
```

结合内置的 vars() 函数将命名空间的属性作为映射返回这一事实，这非常方便：

```
>>> bar = 42
>>> foo = "spam"
>>> baz = None
>>> "%(foo)s %(bar)d" % vars()
'spam 42' 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-27T09:01:14.883

我相信这是 Python 3.0 的一个特性，尽管它在 2.6 版中。但是，如果您有低于该版本的 Python，则该类型的字符串格式将不起作用。

如果您尝试打印一般格式化的字符串，请通过`%`运算符使用 Python 的 printf 样式语法。例如：

```
print '%.2f' % some_var 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-27T09:00:48.957

你使用哪个 Python 版本？

**编辑** 对于 Python 2.5，使用`"x = %s" % (x)`（用于打印字符串）

如果要打印其他类型，[请参见此处](http://docs.python.org/library/stdtypes.html#string-formatting)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-02-04T17:16:01.010

*尽管现有答案描述了原因并指出了修复的方向，但它们都没有真正提供解决问题的解决方案。*

您有两种选择来解决问题。首先是升级到支持[格式字符串构造](http://docs.python.org/library/string.html#string-formatting)的 Python 2.6 或更高版本。

第二个选项是使用[带有 % 运算符的旧字符串格式](http://docs.python.org/library/stdtypes.html#string-formatting-operations)。您提供的等效代码如下。

```
for x in range(1,11):
  print '%2d %3d %4d' % (x, x*x, x*x*x) 
```

这段代码在 Python 2.5 中产生的输出与您的示例代码在 Python 2.6 及更高版本中产生的输出完全相同。

# sharepoint - 停用 SharePoint 功能的最佳实践

> ID：792724
> 
> 赞同：3
> 
> 时间：2009-04-27T08:57:48.700
> 
> 标签：sharepoint, moss

我有一个自定义 SharePoint 解决方案，它需要特定网站 (SPWeb) 上的多个列表实例。现在其中一些列表是通用的，例如“页面”文档库，而其他列表是高度特定的自定义列表。

我的问题是应该在功能停用时清理哪些（如果有的话）定制方面。我的直觉是应该留下可能被多种解决方案使用的通用列表，但应该清理更具体的定制。有没有人对这种类型的场景有任何经验和/或建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T10:50:23.157

很难想出一个严格的规则，因为这取决于你的具体解决方案，但是我会从这样的开始：

停用时，功能应删除在功能激活期间创建的任何工件：

1.  不是由最终用户创建的，并且最终用户无法合理预期会保留
2.  任何其他功能都不需要，或者导致它支持的更广泛的解决方案失败
3.  不禁止稍后重新激活该功能。

在我目前正在进行的项目中，我们创建了一个新的例外来防止功能停用。我们发现，在许多情况下，功能的激活是一条单行道。这主要是因为解决方案通常由许多功能组成，禁用一个功能会导致整个解决方案出现故障。

通常，一个站点只是为了托管该功能而存在，禁用该功能然后就没有为该站点留下任何用途。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-20T15:38:54.650

再加上丹尼尔...

如果另一个特性依赖于这个特性，它们应该通过特性[依赖一起激活和停用](http://msdn.microsoft.com/en-us/library/ee231535.aspx)

# c# - S#arp 架构

> ID：792733
> 
> 赞同：5
> 
> 时间：2009-04-27T08:59:37.027
> 
> 标签：c#, asp.net, s#arp-architecture

有人可以分享他们对 s#arp 架构的经验。我们决定为该项目遵循 mvp 模式。这样可以吗？项目规模中等。我们将遵循 tdd 和 ddd。

任何人都可以解释如何使用这种架构意味着解释层。我们没有足够的时间浏览整个文档。如果有人用小例子来解释粒子。

请帮帮我！！！

谢谢， 米林德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T14:47:32.383

[S#arp Architecture](http://code.google.com/p/sharp-architecture/)项目主页链接到一个活跃的[讨论组](http://groups.google.com/group/sharp-architecture)。我建议您浏览群消息并在那里提出任何问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T15:04:13.560

[S#arp 架构](http://code.google.com/p/sharp-architecture/)将ASP.NET MVC 与其他框架和工具（如

*   [NHibernate](http://www.nhibernate.org/) 2.0.1
*   NHibernate.Validator
*   [流畅的NHibernate](http://fluentnhibernate.org/)和
*   [温莎城堡](http://www.castleproject.org/container/index.html)(IoC)。

它还利用 Visual Studio 的[T4 模板引擎](http://msdn2.microsoft.com/en-us/library/bb126445.aspx)来创建视图脚手架。所以你也可以问问自己是否愿意在你的项目中使用这些工具、库和框架。

坦率地说，如果您没有时间阅读 S#arp 文档，那么在此基础上构建项目可能不是一个好主意。也可以说 S#arp 架构并没有向您隐藏上述每个库和框架的复杂性，因此您还必须准备好研究其中的每一个。

S#arp 文档和随附的示例应用程序很好地解释了不同层的目的和结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:46:46.190

S#arp Architecture 是其他一些简洁工具的巧妙组合，但您**确实**需要花时间阅读文档和一些示例。如果你不学习，你花在阅读和学习上的时间比你花在重构和修复 bug 上的时间要少得多。

# c# - 为什么这段代码没有 unsafe 关键字也能工作？

> ID：792735
> 
> 赞同：19
> 
> 时间：2009-04-27T08:59:47.133
> 
> 标签：c#, .net, unsafe

在[回答](https://stackoverflow.com/questions/791498/how-to-steal-private-data-in-net/791506#791506)他自己[有争议的问题](https://stackoverflow.com/questions/791498/how-to-steal-private-data-in-net/)时，[Mash](https://stackoverflow.com/users/33854/mash)已经说明您不需要“不安全”关键字来直接读取和写入任何 .NET 对象实例的字节。您可以声明以下类型：

```
 [StructLayout(LayoutKind.Explicit)]
   struct MemoryAccess
   {

      [FieldOffset(0)]
      public object Object;

      [FieldOffset(0)]
      public TopBytes Bytes;
   }

   class TopBytes
   {
      public byte b0;
      public byte b1;
      public byte b2;
      public byte b3;
      public byte b4;
      public byte b5;
      public byte b6;
      public byte b7;
      public byte b8;
      public byte b9;
      public byte b10;
      public byte b11;
      public byte b12;
      public byte b13;
      public byte b14;
      public byte b15;
   } 
```

然后你可以做一些事情，比如改变一个“不可变”的字符串。以下代码在我的机器上打印“bar”：

```
 string foo = "foo";
 MemoryAccess mem = new MemoryAccess();
 mem.Object = foo;
 mem.Bytes.b8 = (byte)'b';
 mem.Bytes.b10 = (byte)'a';
 mem.Bytes.b12 = (byte)'r';
 Console.WriteLine(foo); 
```

您还可以通过使用相同技术破坏对象引用来触发[AccessViolationException](http://msdn.microsoft.com/en-us/library/system.accessviolationexception.aspx)。

问题：我认为（在纯托管 C# 代码中）[不安全](http://msdn.microsoft.com/en-us/library/chfa2zb8(VS.71).aspx)关键字是执行此类操作所必需的。为什么这里不需要？**这是否意味着纯托管的“安全”代码根本不安全？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T09:04:40.900

好吧，这很讨厌......使用工会的危险。这可能有效，但不是一个好主意 - 我想我会将它与反射（你可以做大部分事情）进行比较。我很想看看这是否适用于受限访问环境 - 如果是这样，它可能代表一个更大的问题......

* * *

我刚刚在没有“完全信任”标志的情况下对其进行了测试，运行时拒绝了它：

> 无法从程序集“ConsoleApplication4，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”加载类型“MemoryAccess”，因为对象在偏移量 0 处重叠并且程序集必须是可验证的。

要拥有这个标志，你已经需要高度信任——所以你已经可以做更多令人讨厌的事情了。字符串的情况稍有不同，因为它们不是普通的 .NET 对象——但还有其他改变它们的方法的例子——不过，“联合”方法是一种有趣的方法。对于另一种hacky方式（有足够的信任）：

```
string orig = "abc   ", copy = orig;
typeof(string).GetMethod("AppendInPlace",
    BindingFlags.NonPublic | BindingFlags.Instance,
    null, new Type[] { typeof(string), typeof(int) }, null)
    .Invoke(orig, new object[] { "def", 3 });
Console.WriteLine(copy); // note we didn't touch "copy", so we have
                         // mutated the same reference 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T09:40:04.027

哎呀，我糊涂`unsafe`了`fixed`。这是一个更正的版本：

示例代码不需要使用`unsafe`关键字标记的原因是它不包含*指针*（请参阅下面的引用以了解为什么这被认为是不安全的）。您说得很对：“安全”最好称为“运行时友好”。有关此主题的更多信息，请参阅 Don Box 和 Chris Sells *Essential .NET*

引用 MSDN，

> 在公共语言运行时 (CLR) 中，不安全的代码被称为无法验证的代码。C# 中的不安全代码不一定是危险的；它只是 CLR 无法验证其安全性的代码。因此，如果 CLR 位于完全受信任的程序集中，则 CLR 只会执行不安全的代码。如果您使用不安全的代码，您有责任确保您的代码不会引入安全风险或指针错误。

fixed 和 unsafe 之间的区别在于，fixed 阻止 CLR 在内存中移动东西，以便运行时之外的东西可以安全地访问它们，而 unsafe 则完全相反：而 CLR 可以保证正确解析dotnet 引用，它不能为指针这样做。您可能还记得各种关于引用如何不是指针的微软人，这就是为什么他们对细微的区别如此大惊小怪的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T09:07:00.363

您仍然选择退出“托管”位。有一个基本的假设是，如果你能做到这一点，那么你就知道你在做什么。

# regex - 需要有关 Apache htaccess 重定向规则的帮助

> ID：792739
> 
> 赞同：1
> 
> 时间：2009-04-27T09:01:10.017
> 
> 标签：regex, apache, .htaccess, mod-rewrite

我需要从路径重定向

```
 /articles/20090425-swine-flu-kills.html 
```

至

```
 /2009/04/swine-flu-kills.html 
```

在原始路径中，文章后面的数字是 yyyymmdd 格式的日期。这将在新路径中转换为“/yyyy/mm/”。

我想需要一些正则表达式，但我不确定如何。非常感谢帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:09:00.887

尝试这个：

```
RewriteRule ^articles/(\d{4})(\d\d)\d\d-(.*)$ /$1/$2/$3 
```

这匹配：

*   `^articles/`: 以“articles/”开头的字符串
*   `(\d{4})`: 4 位数为 1 美元（年份）
*   `(\d\d)`: 2 位数为 2 美元（月份）
*   `\d\d-`：2位数字和破折号（编辑：错过了领先的破折号）
*   `(.*)$`: 将 URL 的其余部分转换为 $3

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T09:18:40.473

```
RewriteRule ^articles/(\d{4})(\d\d)\d\d\-(.+)$ /$1/$2/$3 
```

会是更好的解决方案。

# java - 使用 Weblogic 10.3 记录 JPA SQL

> ID：792741
> 
> 赞同：4
> 
> 时间：2009-04-27T09:02:18.017
> 
> 标签：java, logging, oracle10g, weblogic, openjpa

通过查看 Open JPA 网站，我发现我可以使用以下命令记录生成的 SQL：

```
<property name="openjpa.Log" value="DefaultLevel=WARN, Runtime=INFO, Tool=INFO"/> 
```

如果我尝试将上述属性添加到我的 persistence.xml 中，我会从 weblogic 收到以下警告：

```
<Warning> <J2EE> <BEA-160202> <You have specified a ope
njpa.Log setting in your configuration for persistence unit services.ear#services-ejb.jar#exp#exp. This setting will be ignored, and all log messages
will be sent to the WebLogic logging subsystem. Trace-level logging is controlle
d by the various JPA-specific debug settings in config.xml, or via the WebLogic
console.> 
```

任何人都知道控制台中的选项是什么，或者我如何编辑我的 config.xml 以输出 SQL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-02T14:03:03.427

来自[OTN 讨论论坛](http://forums.oracle.com/forums/thread.jspa?threadID=762974&tstart=0)的步骤如下：

> *   登录到 weblogic 控制台
> *   锁定和编辑会话
> *   单击环境 | 服务器
> *   选择您要监控/调试的服务器
> *   单击调试选项卡
> *   展开 weblogic 树并选择 JPA 节点
> *   单击启用按钮
> *   激活更改。

这可能取决于您拥有的 WLS 版本。我了解到，如果您下载了[较新版本的 OpenJPA](https://issues.apache.org/jira/browse/OPENJPA-384)并将其与 WLS 一起使用，则会出现一些问题。

撇开 WebLogic 问题不谈，您发布的配置字符串看起来有点不对劲。您是否打算使用这样的东西（在 SQL=TRACE 中添加）：

```
<property name="openjpa.Log" 
                value="DefaultLevel=WARN, Runtime=INFO, Tool=INFO, SQL=TRACE"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-23T15:35:27.020

对于 Weblogic 10.3.3，还有一些步骤：

*   登录到 weblogic 控制台
*   锁定和编辑会话
*   单击环境 | 服务器
*   选择您要监控/调试的服务器
*   单击 Debug 选项卡，展开 weblogic 树并选择 JPA 节点
*   单击启用按钮
*   激活页面底部的更改
*   现在单击日志记录选项卡
*   在页面底部，单击高级
*   在**Message destination(s)**面板下，将**Severity Level**从**Standard Out**更改为*Debug*
*   保存更改并重新启动服务器

# c - 2 C 枚举问题

> ID：792742
> 
> 赞同：0
> 
> 时间：2009-04-27T09:03:24.460
> 
> 标签：c, enums, typedef

**第1部分**

在 C 中，像这样声明枚举有什么区别：

```
typedef enum{VAL1, VAL2,} firstEnum; 
```

像这样：

```
enum secondEnum{Val1, Val2,}; 
```

除了使用 secondEnum 时，您还必须编写：

```
enum secondEnum...; 
```

**第2部分**

另外，我认为以下是等价的是否正确：

```
enum{Val1, Val2,} enum1; 
```

和

```
enum thirdEnum{Val1, Val2,}
enum thirdEnum enum1; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T09:15:31.123

在第 1 部分中，显然存在差异 - 首先您声明`firstEnum`为`typedef`（匿名）枚举类型的 a，而在第二部分中声明为枚举类型`secondEnum`的标记，并且不涉及 typedef。正如您所指出的，为了便于使用，建议使用第一个。

在第 2 部分中，两者并不等价——第一个声明了一个匿名枚举类型并定义`enum1`为该类型。第二个声明了一个命名的枚举类型，然后声明`enum1`为该类型。意义在于您可以在代码的其他部分使用命名类型，而首先您不能在其他任何地方使用它，因此您可能不得不使用整数值作为枚举类型值的别名。

# c# - 如何在 Windows Mobile 上检测电子邮件的标题？

> ID：792747
> 
> 赞同：0
> 
> 时间：2009-04-27T09:04:08.590
> 
> 标签：c#, email, windows-mobile

当他收到带有特定声音的特定电子邮件时，我想通知用户。所以我需要检测电子邮件的标题。

我可以在框架 2.0 中使用 MailMessage，但 Windows Mobile 上的紧凑框架不支持此类。关于我可以使用哪个课程的任何建议？还是不可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:05:24.427

另一种选择是使用[POP3](http://en.wikipedia.org/wiki/Pop3)。

使用普通的套接字连接并连接到您用户的邮件帐户（通常是端口 110）。然后，您可以执行一些 POP3 命令，例如检索部分消息的 TOP。例如：

**示例 1 - 仅返回标题：**

```
TOP 1 0
+OK Top of message follows
--- all message headers --- 
```

**示例 2 - 返回标题和正文的前 10 行：**

```
TOP 1 10
+OK Top of message follows
--- all message headers ---

--- first 10 lines of body --- 
```

当您收到相同的内容时，您可以解析单词的文本：“主题：”，它是标题的一部分。

[这是一个包含一些基本POP3 命令](http://www.electrictoolbox.com/article/networking/pop3-commands/)的网页。无论如何，通过使用 Google，您可以找到很多关于 POP3 的有用信息。

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:59:51.430

您可以使用 IMapiAdviseSink 拦截电子邮件

[http://blogs.msdn.com/hegenderfer/archive/2009/04/28/intercepting-mail-using-imapiadvisesink.aspx](http://blogs.msdn.com/hegenderfer/archive/2009/04/28/intercepting-mail-using-imapiadvisesink.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T10:02:53.740

有 Microsoft.WindowsMo​​bile.PocketOutlook 命名空间，但我相信它不允许您阅读邮件。可能您需要使用[MAPI](http://msdn.microsoft.com/en-us/library/bb415647.aspx)。请参阅此[博客](http://blogs.msdn.com/windowsmobile/archive/2007/03/21/getting-started-with-mapi.aspx)以了解入门。涉及大量非托管代码。

# c# - c#用变量选择类属性？

> ID：792752
> 
> 赞同：1
> 
> 时间：2009-04-27T09:05:51.490
> 
> 标签：c#, .net, reflection

我正在向我们现有的（但已损坏的）系统之一添加功能。它从 Web 服务中获取一个 XML 文件，对其进行解析，然后在将其打包回我们的数据库之前执行一些操作。

以前的开发人员（现在已经离开）给我留下了这个小宝石：

[http://dl.getdropbox.com/u/109069/wut.GIF](http://dl.getdropbox.com/u/109069/wut.GIF)

我想知道是否有办法解决这个问题？

我可以遍历每个节点并按其名称分配给 wo 对象吗？

像这样的东西（伪代码）：

```
 foreach XmlNode xn in WorkorderNodeTree
        {
            //find out the property name of the current node
            //match to the property in the workorder class
            //set the value equal

            wo.<xn.name> = xn.innertext

        } 
```

现在我发现唯一接近的是这个（来自互联网）：

```
 foreach (XmlNode xl in myXML)
    {

        object o = Assembly.GetExecutingAssembly().CreateInstance("Workorder", true);
        Type t = xl.Name.GetType();
        PropertyInfo pi = t.GetProperty(xl.Name);
        pi.SetValue(o, xl.InnerText, null);

    } 
```

但它在 o 上返回空引用异常。我有点困惑，有什么建议吗？

我想这样做，我需要使用反射或泛型，但我以前从未接触过这些东西 - 任何人都可以建议任何可能指向正确方向或至少尝试解释反射的东西吗？

非常感谢大家，为这篇长得可怕的帖子道歉！

编辑：

谢谢， 非常感谢 Fredrik 和 Rytmis——你们俩都是我单调的办公环境中的白衣骑士。Rytmis 的代码编辑已经解决了这个问题，但我在这个小时左右学到了很多东西——谢谢大家，真的很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:11:00.603

[在BLToolkit](http://bltoolkit.com/Doc/Mapping/MapToJson.htm)中尝试[AutoMapper](http://www.codeplex.com/AutoMapper)或自定义映射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T09:29:57.903

我认为您的代码可能需要一些调整。

```
foreach (XmlNode xl in myXML)
{
    object o = Assembly.GetExecutingAssembly().CreateInstance("Workorder", true);
    Type t = xl.Name.GetType();
    PropertyInfo pi = t.GetProperty(xl.Name);
    pi.SetValue(o, xl.InnerText, null);
} 
```

这会为您设置的每个属性创建一个新的 WorkOrder 实例，并尝试反映 Name.GetType() 中的 PropertyInfo，它实际上是 typeof(String)，而不是 typeof(WorkOrder)，就像您希望的那样. 反而：

```
WorkOrder w = new WorkOrder();
Type t = typeof(WorkOrder);
foreach (XmlNode xl in myXML)
{
    PropertyInfo pi = t.GetProperty(xl.Name);
    pi.SetValue(w, xl.InnerText, null);
} 
```

[编辑] 您可能还想指定一些绑定标志：

```
 PropertyInfo pi = t.GetProperty(xl.Name, BindingFlags.Instance | BindingFlags.Public | BindingFlags.IgnoreCase); 
```

这可能需要也可能不需要。我永远记不起默认值是什么。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T09:55:06.847

让 xml 序列化 (System.Xml.Serialization.XmlSerializer) 为您完成工作怎么样？根据 xml，您可以简单地使用 Deserialize 方法，该方法返回从 xml 数据初始化的 WorkOrder 对象。如果你得到的 xml 没有直接映射到 WorkOrder，你可以尝试使用 WorkOrder 上的各种 Xml 属性来分类，以更好地控制 WorkOrder 序列化的方式。您还可以查看更快、更灵活的 DataContractSerializer，但您对序列化的控制不如使用 XmlSerialization 那么多。

您还可以考虑向 WorkOrder 类 FromXml 添加一个静态方法，该方法接受 xml 并返回 WorkOrder 对象。在内部，您可以使用反序列化，或者您甚至可以简单地在开关中初始化属性，而不会弄乱反射。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T10:10:18.183

叫我傻先生，但你为什么不改变 WorkOrder 构造函数来接受一个`XmlNode`参数，把所有丑陋的赋值都铲进去，然后像这样调用它：

```
WorkOrder wo = new WorkOrder(xmlnode); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T09:10:15.113

请尝试使用以下代码来创建 Workorder 实例：

```
Workorder o = Activator.CreateInstance<Workorder>(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T09:14:58.690

正如弗雷德里克所说，

```
Workorder o = Activator.CreateInstance<Workorder>(); 
```

将修复空引用。用于复制属性的其余代码是正确的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T10:31:36.960

您不应该使用反射、使用现有的 .Net 序列化或保留（丑陋但有效）静态代码。

除了字符串之外的其他类型呢？如果xml格式不匹配怎么办？

# c - C 枚举中的最后一个逗号是必需的吗？

> ID：792753
> 
> 赞同：25
> 
> 时间：2009-04-27T09:06:06.340
> 
> 标签：c, syntax, enums

C 枚举声明中是否需要最后一个逗号？

即逗号后面是`VAL3`必需的吗？

```
enum { Val1, Val2, Val3, } someEnum; 
```

将其放入/取出是否有任何副作用

谢谢

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-27T09:09:55.130

这不是必需的。C99部分`6.7.2.2`将语法列出为：

```
enum-specifier:
    enum identifieropt { enumerator-list }
    enum identifieropt { enumerator-list , }
    enum identifier
enumerator-list:
    enumerator
    enumerator-list , enumerator
enumerator:
    enumeration-constant
    enumeration-constant = constant-expression 
```

请注意 的前两种形式`enum-specifier`，一种带有尾随逗号，另一种没有。

我看到使用它的一个优点是：

```
enum {
    Val1,
    Val2,
    Val3,
} someEnum; 
```

其中，如果您想添加（例如）`Val4`and `Val5`，您只需复制并粘贴该`Val3`行，而不必担心调整逗号。

还可以简化自动代码生成器，以便它们不必对最终值进行特殊处理。他们可以只输出每个值，后跟逗号。

这可以比作常见的 SQL：

```
select fld1, fld2 from tbl where 1=1 and fld1 > 8 
```

在这种情况下，`where 1=1`只有这样，您不必`where`在第一个子句`and`之前和每个后续子句之前放置一个。您可以只依靠`where`已经存在的事实，并仅`and`用于您添加的所有内容。

有些人可能认为这很懒惰，他们是对的，但这不一定是坏事:-)

任何体面的 DBMS 查询优化器都应该能够在访问数据库表之前去除类似的常量子句。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-27T12:21:38.583

就像其他人说的那样，逗号不是必需的。但它在 C99 中是新的（在 C89 中是不允许的），并且在下一版本的 C++ 中也将被允许。

另一个基本原理是区分“长度”枚举器和普通枚举器：

```
enum Items {
    A,
    B,
    C,
    LENGTH
}; 
```

现在，您可以将枚举中的最后一项应用到您的编码准则中，但如果它是“长度”项，则不是 - 它只是告诉有多少项。

它还有助于自动生成项目（使用宏/预处理器），就像其他答案解释的那样。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-27T12:32:39.197

在标准 C89 中，最后一个逗号是不允许的。句号。

这是允许它的常见扩展；特别是，它得到了 GCC 的支持，但标准明确禁止它。

在标准 C99 中，为了与数组和结构初始化程序对称，最后一个逗号是允许的，这总是允许在最后一项上使用尾随逗号。

> 6.7.2.2 枚举说明符
> 
> 句法
> 
> ```
>  enum-specifier:
>             enum identifieropt { enumerator-list }
>             enum identifieropt { enumerator-list , }
>             enum identifier 
> ```

允许尾随逗号的主要优点是它允许更容易地机器生成（C 源代码）代码 - 您不必为初始化器列表中的最后一个（或者，也许是第一个）项目编写特殊情况代码。因此，像 Yacc 和 Lex 这样的程序，仅举两个例子，可以稍微简单一些。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T09:10:18.543

不，这不是必需的。原因是，如果您不需要担心逗号是否存在，它可以更容易地剪切和粘贴代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-04T16:20:46.003

定义或数组初始值设定项`,`中的尾随是可选的，但非常有用，尤其是在跨越多行的列表中。`enum`由于对称性的原因，自 C99 起允许使用，因为它为每个项目的所有行提供相同的结构：

```
enum DAY {
    MON = 1,
    TUE,
    WED,
    THU,
    FRI,
    SAT,
    SUN,
}; 
```

它使使用脚本生成数组内容变得更加容易，并避免了向数组添加额外元素但忘记添加逗号可能会被忽视的容易出错的情况：

```
const char *osnames[] = {
    "CP/M",
    "MS/DOS",
    "Windows"
} 
```

添加额外项目：

```
const char *osnames[] = {
    "CP/M",
    "MS/DOS",
    "Windows"
    "Linux",
    "OS/X"
}; 
```

注意列表中间缺少的逗号：编译器将第三个字符串解析为，`"WindowsLinux"`并且该错误不会产生语法错误。

使用每行的尾随`,`，在不修改其他行的情况下添加和删除项目要容易得多。如果像本例中那样有条件地编译行，则更加有用：

```
const char *osnames[] = {
    "CP/M",
    "MS/DOS",
    "Windows",
#ifdef __UNIX__
    "Linux",
    "OS/X",
#endif
}; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-27T09:08:03.090

不，这不是必需的 - 事实上我会说有它有不好的风格。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-27T09:13:00.660

如前所述，它不是必需的。支持尾随逗号的原因是它（假设项目按一行排列）它允许您使用剪切/粘贴或拖放方便地重新排列枚举中项目的顺序，它还允许您注释掉最后一项而不产生语法错误。省略尾随逗号是合法的，但会失去这些代码维护优势。

我忘记了，但尼克是完全正确的。我也利用了带有编译器指令的尾随逗号。没有它，条件代码会更加混乱和难以阅读。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-27T09:17:02.443

如果说您使用宏，它是可选且有用的，例如

```
#ifdef _FLAG
    #define OPTS opt_four, opt_five,
#else
    #define OPTS // none
#endif
enum {
  opt_one,
  opt_two,
  opt_three,
  OPTS
}; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-11-06T19:10:42.727

最后一个尾随逗号不是必需的。

我更喜欢尾随逗号有两个原因：

1.  清理[git 差异](https://gist.github.com/skrulcik/75963d0fe85f1109c3a12decefd2ce69/revisions "更具可读性")。
2.  `dd`使用基于行的命令（例如 Vim 的）在编辑器中轻松编辑。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-27T09:07:45.977

不，它不是必需的，为了代码清晰应该省略。它的存在/不存在没有影响。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-12-29T07:35:47.520

其他答案提到了它，但我只想强调在符合标准的 C89 和 C++ 中不允许使用尾随逗号，这使得它成为旧的或不常见的编译器的可移植性问题。这是一个有用的链接，解释了这个和许多其他 C/C++ 问题：[http ://david.tribble.com/text/cdiffs.htm#C99-enum-decl](http://david.tribble.com/text/cdiffs.htm#C99-enum-decl)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-27T09:24:14.830

它不是必需的，事实上如果你添加一个编译器会抱怨。例如 Visual Studio 6。
逗号的一种用途是使用 c 宏创建枚举。

```
#define ELEMENT(x) x,

enum MyElements {
  ELEMENT(a)
  ELEMENT(b)
  ELEMENT(c)
}; 
```

如果您需要对元素做几件事并且只想定义一次，则此模式很有用。有关这方面的更完整示例，您可以查看[libiconv](http://www.gnu.org/software/libiconv/)和 iconv 实用程序的代码。

# mobile - 用于注册的短信 (SMS) 验证

> ID：792755
> 
> 赞同：12
> 
> 时间：2009-04-27T09:06:17.073
> 
> 标签：mobile, language-agnostic, sms, registration, privacy

我看到了一个令人不安的趋势，即网站开始要求通过短信 (SMS) 向手机发送验证。Gmail 和 Facebook 就是其中的两个。我想知道的是：

1.  现在开始需要手机而不是电子邮件是个好主意吗？
2.  我如何在我自己的网站上做到这一点？

**编辑**

以下是我针对该主题的一些新问题，以回应答案：

1.  我看到你们中的大多数人都说短信注册没问题。但是那些没有手机的人呢？为什么可以免费提供您的手机信息？
2.  那些大提供商真的为每条消息付费给网关服务吗？难道不能用正确的短信软件设置服务器，或者至少直接购买订阅而不是找中间人吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T09:19:50.707

大多数 SMS Gateway 服务都有某种 API。HTTP 接口似乎是常态。

只需确保您注册了一项允许接收消息的服务，因为并非所有人都这样做。他们需要做更多的工作，因为他们必须将某种数据发回给您。

一些服务也提供发送回执，让您查看接收者是否收到了短信。

下面是一些例子。

*   [Esendex API 文档](http://www.esendex.co.uk/Services/SMS-API/)
*   [本地文本](http://www.txtlocal.co.uk/sms-gateway.php)

关于第一个问题，我认为基恩指挥官的建议是合理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T09:12:06.467

如果您想限制虚假帐户的数量，这是一个好主意。我看到它在挪威的当地报纸上被大量使用。我想这会让人们在他们的论坛上发布无用的废话之前三思而后行。

但是你真的那么讨厌你的用户吗？Gmail 和 Facebook 现在已经足够大，人们会接受跳过一些障碍来使用该服务，但你需要一些真正有趣的东西来让用户接受这种不便。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-12T22:53:24.257

SMS是我无法使用App Engine（）的原因。

第一个问题是有些人没有手机。我几乎可以在不验证单元格的情况下完全使用 Facebook，但使用 CAPTCHA 来完成某些操作。因此，CAPTCHA 是不错的选择之一。

我个人认为，手机的东西属于手机，不应该出现在网络上。如果世界上每个论坛管理员和新手 PHP 开发人员都使用 SMS 验证并且有人入侵（破解）他们的数据库怎么办？你相信一个小论坛吗？反欺诈措施是否需要如此迫切？

如果您的网站非常大且很受欢迎，那么获得 SMS 验证可能会很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T20:44:54.770

作为 CS Networks 支持团队的成员。我会给你一些答案。

1.  人们使用他们的手机作为验证媒介，因此服务提供商可以确定注册会员不是机器人或其他东西。
2.  是的，它是真实的。大型提供商为 SMS 网关服务付费。是的，有可能拥有这样的基础设施，但建议您拥有一支长期从事这项业务的团队。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T14:02:18.107

使用短信作为身份验证方式的一个主要原因是您将帐户链接到手机，这有效地大大减少了伪造用户帐户的机会。

要实施此功能，您需要与覆盖您客户所在国家（和运营商）的 SMS 网关签署协议。

大多数 SMS 网关可以很容易地集成到您的软件中，并且通常可以让您访问您需要的所有移动运营商。

如果您可以使用 API，我不建议使用电子邮件到短信网关，因为这些通常比使用适当的 API 发送消息的响应速度慢，您将获得与短信网关本身的实时连接，而不是电子邮件服务器门前。

SMS 网关提供商的示例：

PSWinCom - www.pswin.com（注：我受雇于这家公司。）

Clickatell - www.clickatell.com

HSL - [http://www.hslsms.com/](http://www.hslsms.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T09:17:37.840

**回答第一个问题：**我能想到的导致 Gmail 和 Facebook 追随这一趋势的一个原因是虚假帐户的出现。现在，有免费的 use-n-throw 电子邮件可用，例如 www.10minutemail.com，它会为您提供 10 分钟的电子邮件地址。因此，用户可以使用这样的电子邮件地址并在站点中创建一个新帐户。

但是在“短信”注册的情况下，我不知道有任何这样的使用-n-throw 服务提供商。所以每个人都需要提供自己的号码进行注册。这导致合法用户注册。

**回答第二个问题：**这取决于您使用的是哪种语言。此外，您*可能*需要一个 SMS 网关来实现这一点。

* * *

由于您不关心语言，请尝试寻找通过计算机或您的网络服务器发送短信的短信网关。一些手机网络提供商提供电子邮件服务以向手机发送短信。例如，您要向“xyz”网络提供商的 +910123456789 发送短信，您只需在电子邮件正文中发送短信，收件人地址为 +910123456789@xyzmail.com

'xyzmail' 部分的邮件地址会根据网络供应商而改变。加上这个选项没有被发现是可靠的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-07T00:56:24.520

查看 TeleSign.com

他们提供电话验证解决方案，您可以将其实施到您的网站中

电话验证是一种显着减少欺诈和垃圾邮件的方法

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-29T17:45:09.203

这里有一个双向的信任问题。如果您是可以发送垃圾邮件的服务提供商，您可以相信您的用户是人并且他们的电子邮件地址是合法的。这可能是不合理的。或者您可以强制您的用户相信您会安全地处理他们的手机号码信息。许多用户会觉得这是不合理的。

还有一些人没有手机（我恰好是其中之一）。网络上的大多数讨论都不是很重要，但如果你想促进对任何重要事情的讨论，将讨论限制在拥有手机并知道如何接收短信的人范围内，你的讨论就会局限于人们的观点。有钱又有技术。如果您提供的是电子邮件等重要服务，那么发短信的要求会设置进入障碍并削弱网络的民主化力量。这相当于将垃圾邮件问题的成本分摊给弱势群体。对我来说，这是不可接受的。不过，同样，如果您的网站只是空洞的流行文化或营销活动，就像大多数人一样，谁在乎，那就继续吧。

# linux - 在我的服务器上运行其他人代码（沙箱）的安全方式？

> ID：792764
> 
> 赞同：22
> 
> 时间：2009-04-27T09:09:13.993
> 
> 标签：linux, security, virtualization, sandbox

我想制作一个在本地运行其他人代码的 Web 服务。自然，我想限制他们的代码访问某个“沙盒”目录，这样他们就无法连接到我服务器的其他部分（数据库、主网络服务器等）

最好的方法是什么？

**运行 VMware/Virtualbox：**

*   + 我想它是最安全的。即使有人设法“破解”，他们也只会破解来宾机器

*   + 可以限制进程使用的 CPU 和内存

*   + 易于设置 - 只需创建虚拟机

*   - 更难将沙盒目录从主机“连接”到来宾

*   - 浪费额外的内存和 CPU 来管理 VM

**运行特权用户：**

*   + 不浪费额外资源

*   + 沙盒目录只是一个普通目录

*   ? 不能限制CPU和内存？

*   ? 不知道够不够安全

**还有什么办法吗？**

运行 Fedora Core 8 的服务器，用 Java 和 C++ 编写的“其他”代码

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-10T18:40:37.523

要限制 CPU 和内存，您需要为进程组设置限制（POSIX 资源限制仅适用于单个进程）。您可以使用 cgroups 执行此操作。

例如，通过挂载内存 cgroups 文件系统来限制内存：

`# mount cgroup -t cgroup -o memory /cgroups/memory`

然后，为每个组创建一个新的子目录，例如

```
# mkdir /cgroups/memory/my-users 
```

将您想要约束的进程（此处为 PID“1234”的进程）放入此组：

```
# cd /cgroups/memory/my-users
# echo 1234 >> tasks 
```

设置组的总内存限制：

`# echo 1000000 > memory.limit_in_bytes`

如果组中的进程派生出子进程，它们也将在组中。

上述组设置了常驻内存限制（即受约束的进程将开始交换而不是使用更多内存）。其他 cgroup 可以让您限制其他事情，例如 CPU 时间。

您可以将您的服务器进程放入组中（以便整个系统及其所有用户都在限制范围内）或让服务器将每个新会话放入一个新组中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-27T14:48:17.080

[`chroot`](http://en.wikipedia.org/wiki/chroot), [jail](http://www.jmcresearch.com/projects/jail/) , [container](http://lxc.sf.net) , [VServer](http://linux-vserver.org) / [OpenVZ](http://openvz.org) /etc.，通常比以非特权用户身份运行更安全，但比完整的操作系统虚拟化更轻量级。

此外，对于 Java，您可能信任 JVM 的内置沙箱，对于编译 C++，[NaCl](http://code.google.com/p/nativeclient/)声称能够沙箱 x86 代码。

但正如 Checkers 的回答所说，过去几乎所有“沙盒”都被证明有可能造成恶意破坏，我预计未来会不断发现（并希望修复）更多漏洞。你*真的*想运行不受信任的代码吗？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-28T03:19:07.850

阅读 codepad.org/about 页面可能会给你一些很酷的想法。

[http://codepad.org/about](http://codepad.org/about)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T09:25:43.797

查看`ulimit`和朋友们了解限制弱势用户对机器执行 DOS 能力的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T09:43:03.317

1.  在非特权用户下运行仍然允许本地攻击者[利用漏洞来提升特权](http://it.slashdot.org/article.pl?sid=08/02/10/2011257)。
2.  允许在 VM 中执行代码也可能是不安全的；[正如最近的VMWare 漏洞报告](http://www.publicsafety.gc.ca/prg/em/ccirc/2009/av09-017-eng.aspx)所示，攻击者可以访问主机系统。

在我看来，从安全的角度来看，首先允许在您的系统上运行本机代码并不是一个好主意。也许你应该重新考虑让他们运行*原生*代码，这肯定会降低风险。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-10T19:17:37.900

尝试学习一些关于为 SELinux 设置策略的知识。如果您正在运行 Red Hat 机器，那么您就可以使用了，因为他们将它打包到了默认发行版中。

如果您知道代码不应访问的内容，这将很有用。或者你可以做相反的事情，只授予对某些事情的访问权限。

但是，这些政策很复杂，并且可能需要比您希望提出的更多的时间投资。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-11T10:34:17.263

使用[Ideone API](http://ideone.com/api/) - 最简单的方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-01-15T06:45:14.790

尝试使用 lxc 作为 apache 服务器的容器

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-10T18:51:24.337

不确定你想在这件事上付出多少努力，但你能像 VPS 网络主机那样运行 Xen 吗？

[http://www.xen.org/](http://www.xen.org/)

这将允许对他们的一小部分服务器进行完全的 root 访问，而不会损害其他用户或基本系统。

# sql - 为菜单/列表排序邮政编码

> ID：792771
> 
> 赞同：1
> 
> 时间：2009-04-27T09:11:21.413
> 
> 标签：sql, sorting, postal-code

我需要对英国邮政编码列表进行排序。

有没有简单的方法来做到这一点？

英国邮政编码由字母和数字组成：

有关格式的完整信息，请参阅： [http ://en.wikipedia.org/wiki/UK_postcodes](http://en.wikipedia.org/wiki/UK_postcodes)

但我的问题是这种简单的 alpha 排序不起作用，因为每个代码都以 1 个或两个字母开头，然后紧跟一个数字，最多两位数，然后是空格，另一个数字，然后是一个字母。例如 LS1 1AA 或 ls28 1AA，还有另一种情况，一旦第一部分中的数字超过 99，则继续 9A 等。

Alpha 排序导致 10 紧跟在 1 之后：

```
...
LS1 9ZZ
LS10 1AA
...
LS2 
```

我正在考虑创建一个 SQL 函数来将可打印的邮政编码转换为可排序的邮政编码，例如“LS1 9ZZ”将变为“LS01 9ZZ”，然后在 order by 子句中使用此函数。

有没有人做过这个或类似的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T11:53:59.883

您需要将此视为标记化问题，因此 SW1A 1AA 应标记化为：

*   西南
*   1
*   一种
*   1AA

（尽管如果你愿意，你可以把向内的部分分解成 1 和 AA）

和 G12 8QT 应标记为：

*   G
*   12
*   （空字符串）
*   8QT

一旦您将邮政编码分解为这些组成部分，那么排序应该很容易。GIR 0AA 邮政编码有一个例外，但您可以硬编码该邮政编码的测试

*编辑：关于标记化的更多想法*

对于示例邮政编码 SW1A 1AA，SW 是邮政编码区，1A 是邮政编码区（我们将其分成两部分进行排序），1 是邮政编码扇区，AA 是单位邮政编码。

[这些是有效的邮政编码格式（来源：Royal Mail PAF 用户指南第 8 页 -本页](http://www.royalmail.com/portal/rm/content3?mediaId=56000705&catId=400085)底部的链接）：

AN NAA
AAN NAA
ANN NAA
ANA NAA
AAA NAA（仅适用于 GIR 0AA 代码）
AANN NAA
AANA NAA

所以一个粗略的算法将是（假设我们想要分离部门和单位邮政编码）：

*   代码 = GIR 0AA？标记为 GI/R/ /0/AA（将 R 视为区简化事情）
*   代码 5 个字母长，例如 G1 3AF？标记为 G/1/ /3/AF
*   代码 6 个字母长，第 3 个字符是字母，例如 W1P 1HQ？标记为 W/1/P/1/HQ
*   代码 6 个字母长，第二个字符是一个字母，例如 CR2 6XH？标记为 CR/2/ /6/XH
*   代码 7 个字母长，第 4 个字符是一个字母，例如 EC1A 1BB？标记为 EC/1/A/1/BB
*   否则，例如 TW14 2ZZ，标记为 TW/14/ /2/ZZ

如果目的是显示邮政编码列表供用户选择，那么我会采用 Neil Butterworth 的建议，即在数据库中存储邮政编码的“可排序”版本。创建可排序版本的最简单方法是将所有条目填充为九个字符：

*   该区域的两个字符（如果更短，则为右填充）
*   两个代表区号（如果较短，则左填充）
*   一份用于区信（如果丢失，请填写）
*   空间
*   一个用于该部门
*   两个为单位

GIR 0AA 又是一个小例外。如果你用空格填充，那么排序顺序应该是正确的。使用 # 表示空格的示例：

*   W1#1AA => W##1##1AA
*   WC1#1AA => WC#1##1AA
*   W10#1AA => W#10##1AA
*   W1W#1AA => W##1W#1AA
*   GIR#0AA => GI#R##0AA
*   WC10#1AA => WC10##1AA
*   WC1W#1AA => WC#1W#1AA

如果区域太短，您需要右填充：左填充会产生错误的排序顺序。所有单字母区域 - B、E、G、L、M、N、S、W - 将在所有双字母区域 - AB、AL、...、ZE 之前排序 - 如果您使用左填充

需要保留区号，以确保自然的 W1、W2、...、W9、W10 顺序保持不变

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T20:56:36.633

我知道这已经晚了几年，但我也刚刚遇到过这个问题。我已经设法用以下代码克服了它，所以我想我会在搜索互联网时分享，但找不到任何东西！

```
mysql_query("SELECT SUBSTRING_INDEX(postcode,' ',1) as p1, SUBSTRING_INDEX(postcode,' ',-1) as p2 from `table` ORDER BY LENGTH(p1), p1, p2 ASC"); 
```

此代码将采用完整的英国邮政编码并将其拆分为 2。

然后它将按邮政编码的第一部分排序，然后是第二部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T09:14:57.597

我很想将规范化的邮政编码与真实的邮政编码一起存储在数据库中——这样你只做一次字符串操作，你可以使用索引来帮助你进行排序。

# parsing - 搜索关键字的字符串：关于“故障函数”的问题

> ID：792785
> 
> 赞同：2
> 
> 时间：2009-04-27T09:15:33.680
> 
> 标签：parsing, compiler-construction

我有一个关于“编译器：原理、技术和工具”又名 DragonBook 的故障功能描述的问题

首先，报价：

> 为了快速处理文本字符串并在这些字符串中搜索关键字，为关键字 b [1] b [2] ...b [n]定义一个失败函数 f (s) .. . 目标是 b [1] b [2] .. - b [f(s)是 b] [1] ...b s的最长专有前缀，也是 b [1] ... b [s][的]后缀。f (s) 很重要的原因是，如果我们尝试匹配 b [l] b [2] ..b [n的文本字符串][[[[[，并且我们已经匹配了第一个 s 位置，但是我们随后失败了（即文本字符串的下一个位置不包含 b [s+l]），那么 f (s) 是 b [1] ..b [n]的最长前缀可能会匹配到我们所在位置的文本字符串。当然，文本字符串的下一个字符必须是 b [f(s)+1]，否则我们仍然有问题，必须考虑一个更短的前缀，即 b [f(f(s))]。]]]]]

那么问题来了：
1\. 如果我们已经将 s 位置与文本匹配，为什么 f (s) 是匹配字符串的 b [1] ..b [n的]*最长*前缀？我认为 s - 是最长的前缀。 2\. 文本字符串的下一个字符必须是 b [f(s)+1]，为什么？我们在这个位置不匹配，char 是什么有关系吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T09:33:49.487

f(s) 是该位置上可能匹配整个关键字的最长前缀。这个想法不是从一开始就尝试将关键字与文本匹配，而是找到关键字出现的位置。

考虑在文本“aaaabaa”中搜索单词“aaaba”。匹配在前三个 a 之后失败，但没有必要从第二个 'a' 重试，因为我们知道如果下一个字母是 'b'（它是），我们可能在那里匹配。

# wpf - 如何强制 ListBox 重新加载 ListBoxItems 的属性

> ID：792787
> 
> 赞同：2
> 
> 时间：2009-04-27T09:16:46.300
> 
> 标签：wpf, data-binding, listbox

有什么办法，如何强制 ObservableCollection 触发 CollectionChanged？

我有一个 ObservableCollection 对象`ListBox`项目源，所以每次我向集合添加/删除项目时，ListBox 都会相应地更改，但是当我更改集合中某些对象的属性时，ListBox 仍然呈现旧值。

即使我确实修改了一些属性，然后将对象添加/删除到集合中，也没有任何反应，我仍然看到旧值。

有没有其他方法可以做到这一点？我找到了接口INotifyPropertyChanged，但我不知道如何使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T09:44:42.580

我同意马特上面的评论。下面是一小段代码来展示如何实现 INotifyPropertyChanged。

===========
代码隐藏
===========

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Data;
using System.Windows.Documents;

namespace WpfApplication1
{   
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        Nicknames names;

        public Window1()
        {
            InitializeComponent();
            this.addButton.Click += addButton_Click;
            this.names = new Nicknames();
            dockPanel.DataContext = this.names;
        }

        void addButton_Click(object sender, RoutedEventArgs e)
        {
            this.names.Add(new Nickname(myName.Text, myNick.Text));
        }
}
public class Nicknames : System.Collections.ObjectModel.ObservableCollection<Nickname> { }

public class Nickname : System.ComponentModel.INotifyPropertyChanged
{
    public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged;
    void Notify(string propName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new System.ComponentModel.PropertyChangedEventArgs(propName));
        }
    }

    string name;
    public string Name
    {
        get { return name; }
        set
        {
            name = value;
            Notify("Name");
        }
    }
    string nick;
    public string Nick
    {
        get { return nick; }
        set
        {
            nick = value;
            Notify("Nick");
        }
    }
    public Nickname() : this("name", "nick") { }
    public Nickname(string name, string nick)
    {
        this.name = name;
        this.nick = nick;
    }

    public override string ToString()
    {
        return Name.ToString() + " " + Nick.ToString();
    }
  }
} 
```

XAML

```
<Window x:Class="WpfApplication1.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Grid>
    <DockPanel x:Name="dockPanel">
        <TextBlock DockPanel.Dock="Top">
        <TextBlock VerticalAlignment="Center">Name: </TextBlock>
        <TextBox Text="{Binding Path=Name}" Name="myName" />
        <TextBlock VerticalAlignment="Center">Nick: </TextBlock>
        <TextBox Text="{Binding Path=Nick}" Name="myNick" />
        </TextBlock>
        <Button DockPanel.Dock="Bottom" x:Name="addButton">Add</Button>
        <ListBox ItemsSource="{Binding}" IsSynchronizedWithCurrentItem="True" />
    </DockPanel>
</Grid> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T09:32:48.193

修改集合中项目的属性不会在集合本身上触发 NotifyCollectionChanged - 毕竟它没有更改集合。

使用 INotifyPropertyChanged，您走在了正确的轨道上。您需要在列表包含的类上实现该接口。因此，如果您的集合是`ObservableCollection<Foo>`，请确保您的 Foo 类实现 INotifyPropertyChanged。

# c# - XmlConvert 和可为空的结果？

> ID：792789
> 
> 赞同：1
> 
> 时间：2009-04-27T09:17:10.680
> 
> 标签：c#, .net, nullable, xmlconvert

在我的项目中，我收到一个 XmlElement，我必须将其中的一些属性解析回一个类。

为了映射这些，我使用 XmlConvert 类。但是源是 XML，通常有空节点或不可读的节点。与其抛出一堆错误，我想将一个 NULL 返回存储在我的班级中。

我开始制作一个 XmlConvertExtentions 类，它按照以下精神做事：

```
public static class XmlConvertExtentions
{
    public static int? ToNullableInt32 (this XmlConvert c, string s){
        try{ return XmlConvert.ToInt32(s); }
        catch{ return null; }
    }
} 
```

我坚信我不是第一个需要这种功能的开发人员，我想知道我是否没有发明另一个轮子。
此外，我觉得我正在发明一个非常丑陋的轮子。try catch 感觉很糟糕。有没有更好的办法？

**--EDIT--**
现在我也注意到它甚至不起作用：P
我认为这是因为你不能扩展静态类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:28:45.973

如果节点为空或为空，那么是`s`什么？

怎么样：

```
if(string.IsNullOrEmpty(s)) return null;
return XmlConvert.ToInt32(s); 
```

另请注意，LINQ-to-XML 对这些转换有更优雅的处理（通过强制转换）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T09:26:33.687

我不知道在您的情况/情况下是否可能，但是您是否已经使用 XML 序列化类，并通过 XmlSerializer 类将 XML 反序列化为您的自定义类的实例，而不是手动完成所有操作？

# c# - 无法在 C# 中正确获取命令行参数

> ID：792798
> 
> 赞同：3
> 
> 时间：2009-04-27T09:21:01.327
> 
> 标签：c#, command-line

在 c#.Net 中，我无法正确获取命令行参数。如果我给出以下命令，它会出现问题：

```
myProgram.exe "c:\inputfolder\" "d:\output.txt" 
```

由于 args[] 数组中的反斜杠字符（我认为它充当转义字符），我只得到一个参数而不是两个如果我没有反斜杠就可以正常工作：

```
myProgram.exe "c:\inputfolder" "d:\output.txt" 
```

或不带双引号：

```
myProgram.exe c:\inputfolder\ "d:\output.txt" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T09:24:15.720

我从未遇到过这样的问题，但如果您想通过自己使用 System.Environment.CommandLine 来解析命令行来获取它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T09:22:40.620

这是一个众所周知的解析问题，除了将整个命令行作为单个字符串并自己解析之外，您无能为力。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T09:45:34.170

反斜杠正在转义 shell 中的引号字符。您必须使用额外的反斜杠：

```
myProgram.exe "c:\inputfolder\\" "d:\output.txt" 
```

您可以使用以下简短的示例程序来测试命令行解析：

```
using System;

class Program
{
    static void Main(string[] args)
    {
        for (int i = 0; i < args.Length; i++)
        {
            Console.WriteLine(string.Format("Argument {0}: {1}", i, args[i]));
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-19T16:35:58.080

如果其他人试图在命令行 args 中查找有关双引号的官方文档，我能找到的最接近的是 c++，它似乎直接适用：http: [//msdn.microsoft.com/en-us/library/17w5ykft .aspx](http://msdn.microsoft.com/en-us/library/17w5ykft.aspx)

# silverlight - Silverlight2 中的浏览器不可用

> ID：792803
> 
> 赞同：1
> 
> 时间：2009-04-27T09:24:21.350
> 
> 标签：silverlight, silverlight-2.0

如何使用 Silverlight 2 构建独立应用程序。

1.我知道 Silverlight 3 具有构建此类应用程序的浏览器功能。但它处于测试阶段，我等不及了。
2\. 我还查看了 Desklighter ( [http://www.blendables.com/labs/Desklighter/Default.aspx](http://www.blendables.com/labs/Desklighter/Default.aspx) )，它有助于从 xap 文件构建可执行文件。但它需要 .Net Framework 才能运行，这超出了目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:30:50.477

只需构建一个 winform 应用程序并托管 iexplore ocx ，将 ocx 指向一个包含 silverlight 应用程序的 html 页面。tamir khasons 博客[http://khason.net/blog/stand-alone-multiplatform-silverlight-application/](http://khason.net/blog/stand-alone-multiplatform-silverlight-application/)上有一个 dotnet 示例， 但它可以用任何语言实现

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T12:42:01.387

出色地！如果您想实现该特定目的，我同意丹尼尔的解决方案..现在关于@James，是的，它会破坏目的，然后尝试用c ++开发主机...

# web-services - IIS 中默认网站的 IP 地址“自动”更改

> ID：792804
> 
> 赞同：3
> 
> 时间：2009-04-27T09:24:44.500
> 
> 标签：web-services, iis, iis-6

我在我们的一台服务器上遇到了一个非常奇怪的 IIS 问题。有时它似乎将 IP 地址从 (All Unassigned) 更改为 127.0.0.1，导致使用我们的 Web 服务的所有内容都失败。IIS 是否在某处记录配置更改？有没有人有类似的经历？很多人都可以访问这个服务器，所以尽管他们声称他们没有接触过它，但我怀疑这里有人为干预，我只需要一种方法来追踪它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:37:24.173

我不知道为什么会发生这种情况，但我提出了一些解决方法：

*   创建一个具有相同参数的新网站并禁用（停止）旧网站。看看它是否仍然发生
*   分配一个固定的（本地）IP 地址而不是“全部未分配”，看看会发生什么。

是否有第三方 IIS 组件/ISAPI 扩展可能会干扰您的设置？

您还可以检查[MetaBase.xml](http://technet.microsoft.com/en-us/library/cc779862.aspx) (IIS 6) 文件（或 Windows Server 2000 的 IIS 5 -C:\WINNT\system32\inetsrv 中的 MetaBase.bin）的时间戳以查看它何时被操作。

这是一篇有趣的文章：[在 IIS 6.0 中启用元数据库审核（带有 Service Pack 1 的 Windows 2003）](http://www.adopenstatic.com/faq/IISMetabaseAuditing.aspx)。

# asp.net - 使用带有 LIKE 运算符的 Linq to Sql 对象数据源过滤 Gridview 结果

> ID：792805
> 
> 赞同：1
> 
> 时间：2009-04-27T09:25:01.817
> 
> 标签：asp.net, linq-to-sql, .net-3.5, gridview

我有一个绑定到 LINQ to Sql 数据源的 gridview。我想使用 LIKE 运算符过滤网格视图中的结果。即我有一个用于搜索用户名的文本框，我想选择所有用户名，如[文本框值]。

下面是我的代码：

```
<h1>Manage Users</h1> 
```

搜索用户用户名：

```
<asp:GridView ID="GridView2" runat="server" AllowPaging="True" 
    AllowSorting="True" AutoGenerateColumns="False" DataSourceID="LinqDataSource1">
    <Columns>
        <asp:BoundField DataField="UserName" HeaderText="User Name" ReadOnly="True" 
            SortExpression="UserName" />
        <asp:BoundField DataField="FullName" HeaderText="Full Name" ReadOnly="True" 
            SortExpression="FullName" />
        <asp:BoundField DataField="Email" HeaderText="Email" ReadOnly="True" 
            SortExpression="Email" />
       <asp:BoundField DataField="LastLoginDate" HeaderText="Last Login" ReadOnly="True" 
            SortExpression="LastLoginDate" DataFormatString="{0:dd MMMM yyyy}"/>
       <asp:HyperLinkField Text="Edit" DataNavigateUrlFields="UserId" DataNavigateUrlFormatString="~/Pages/UsersMaintenance/CreateEditUser.aspx?UserId={0}" />
    </Columns>
</asp:GridView>
<asp:LinqDataSource ID="LinqDataSource1" runat="server" 
    ContextTypeName="AirProducts.BusinessLogic.AirProductsDataContext" 

    Select="new (UserId,UserName, Details.FullName,Membership.Email,Membership.LastLoginDate)" 
    TableName="Users" Where="UserName == @UserName" >
    <WhereParameters>
        <asp:ControlParameter ControlID="txtUsername" Name="UserName" 
            PropertyName="Text" Type="String" />
    </WhereParameters>
</asp:LinqDataSource> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T09:37:14.440

用调用LINQ 表达式的**Where**子句中的**String.Contains**方法替换等号运算符：

 **```
<asp:LinqDataSource ID="LinqDataSource1" runat="server" 
    ContextTypeName="AirProducts.BusinessLogic.AirProductsDataContext" 

        Select="new (UserId,UserName, Details.FullName,Membership.Email,Membership.LastLoginDate)" 
        TableName="Users" Where="UserName.Contains(@UserName)" >
        <WhereParameters>
                <asp:ControlParameter ControlID="txtUsername" Name="UserName" 
                        PropertyName="Text" Type="String" />
        </WhereParameters>
</asp:LinqDataSource> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T14:17:06.843

您可以获得您的要求的信息，请参阅此链接 [www.delicious.com/sridharnetha](http://delicious.com/sridharnetha)

```
protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
 {
  if (e.CommandName.Equals("AddNew"))
  {
   TextBox txtNewName=(TextBox)GridView1.FooterRow.FindControl("txtNewName"); 
   DropDownList cmbNewGender = (DropDownList)GridView1.FooterRow.FindControl("cmbNewGender"); 
   TextBox txtNewCity = (TextBox)GridView1.FooterRow.FindControl("txtNewCity"); 
   TextBox txtNewState = (TextBox)GridView1.FooterRow.FindControl("txtNewState"); 
   DropDownList cmbNewType = (DropDownList)GridView1.FooterRow.FindControl("cmbNewType");

   customer.Insert(txtNewName.Text, cmbNewGender.SelectedValue, txtNewCity.Text, txtNewState.Text, cmbNewType.SelectedValue) ; 
   FillCustomerInGrid();
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T07:41:14.263

我无法让它在 LinqDataSource 的标记中工作，但能够在此处捕获它，此外，我还获得了智能感知支持。

```
protected void LinqDataSource1_Selecting(object sender, LinqDataSourceSelectEventArgs e)
{
    AirProductsDataContext db = new AirProductsDataContext();
    e.Result = from v in db.Users orderby v.UserName ascending
               where v.UserName.Contains(txtUsername.Text)
               select new {v.UserId,v.UserName, v.UserDetail.FullName,v.Membership.Email,v.Membership.LastLoginDate};
} 
```

# java - 如何提高客户端-服务器架构应用程序的性能？

> ID：792807
> 
> 赞同：2
> 
> 时间：2009-04-27T09:25:34.810
> 
> 标签：java, performance, client-server, rmi

我们有一个基于客户端-服务器架构的产品。有关使用的技术堆栈的一些详细信息。

*   客户端 - Java Swing
*   服务器 - RMI
*   Java 数据库 - 甲骨文

客户端位于世界各地，但 java 服务器和 oracle 数据库位于瑞典的同一台机器上。因此，存在很多网络延迟。位于遥远位置的客户端性能很差。该应用程序用于处理大小超过 50MB 的文件。通常，每个操作需要大约 1000 多个网络调用。

根据您的经验，您如何解决这个问题并提高性能？

编辑：回答几个问题

1.  文件包含需要处理和更新到数据库的实际业务数据，不能部分发送。
2.  一些网络调用可以批处理，但需要对代码进行重大重构。这是 2001 年编写的一个非常古老的应用程序。应用程序的设计是这样的，服务器保存所有服务，它们可以跨代码重用，业务逻辑写在客户端。因此，此业务逻辑多次调用服务器，因此是天文数字。

-斯内哈尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T09:28:47.220

**减少往返次数**

单次操作 1000 次往返是一个天文数字。你不可能看到这些数字。

尽管 50MB 文件仍然存在问题。在这种情况下，您要么需要找到一种方法来提高传输效率（仅在两个相似文件之间传输增量？），要么使用某种缓存。

WAN 流量正在扼杀您的应用程序，听起来您需要进行重大重构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T11:54:05.717

通过网络发送大文件和大量请求会花费大量时间。时期。即使您可以升级到千兆以太网，该协议仍然要求您的客户端在两个连续的网络数据包之间空闲几毫秒（以便其他主机也有机会交谈）。

但是千兆以太网是不可行的，因为客户端很远（可能通过互联网连接）。

因此，唯一可行的方法是将业务代码移近服务器。最简单的解决方案是将客户端安装在与服务器相同的 LAN 中的小盒子上，并使用 VNC 或类似协议远程访问它们。

下一个层次是将客户端分为业务层和显示层。把业务层变成服务，在客户端安装显示层。通过这种方式，数据仅在（快速）Intranet 上被推送。当结果准备好显示时，客户端只获得结果（少量数据）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T09:32:59.677

-如果还没有的话，使服务器无状态

- 考虑更轻的远程协议，例如 Hessian

-延迟可能是您的瓶颈，考虑在客户端中使用缓存并读取更大的数据块，1000 次往返是巨大的负载。

- 考虑重构客户端，使其能够在本地工作并在后台同步

- 使用分析器查看应用程序花费最多的时间并对其进行优化

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T09:37:25.453

您是否对操作的不同部分的相对时间消耗进行了任何测量？在您测量单个过程需要多长时间之前，我不会碰任何东西。

我*怀疑*延迟问题是关键。但在查看任何解决方案之前，我会先测量和确定这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T09:41:18.377

也许最好的办法是更好地了解基础设施的工作原理

1.  为什么文件这么大？
2.  是否必须发送整个文件，或者您是否可以只发送所需的部分进行处理
3.  这些网络调用是什么？它们都是必需的吗？如果是这样，可以将这些调用批处理为一个调用吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T10:26:26.303

不确定，但看起来您在 50 MB 文件中有一些数据要验证/处理并存储在数据库中。这是正确的吗？

为什么客户端可以简单地将文件传递给服务器，服务器执行验证/处理任务并存储在数据库中？这将没有网络调用，除了将文件数据传递给服务器。

另一种可能性是，如果您可以在一个调用中组合多个操作，即会话外观模式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T10:34:46.703

Steve Souders 的“高性能网站：前端工程师必备知识”是一本非常好的书。见[这里](http://www.amazon.co.uk/High-Performance-Web-Sites-Essential/dp/0596529309/ref=sr_1_1?ie=UTF8&s=books&qid=1240828425&sr=8-1)。

史蒂夫的网站在[这里](http://stevesouders.com/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-27T14:49:39.930

我建议尽可能多地使这个过程异步。客户是否需要对处理进行实时响应？如果没有，您可以转向 MOM（面向消息的中间件）概念，并将 JMS 队列/主题放置在客户端和服务器之间。

客户端可以将要处理的记录发布到服务器正在监视的队列中。处理完成后，服务器会将结果放入客户端正在侦听的回复队列中。这将强制进行重构，但假设您的代码是松散耦合的，它不应该是非常具有侵入性的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-27T19:56:05.090

要么以主要方式重构代码，要么重写整个应用程序。如果您的经理说添加进度条需要很长时间，以便用户认为它走得更快。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-27T09:39:44.573

每个操作需要 1000 个请求是很多的！这将杀死任何服务器。这通常是无法通过添加更多硬件或添加更多带宽来解决的问题。这是一个设计问题。无论如何，我会安装一个分析器以查看服务器状态（内存消耗、cpu 等）。看看 lambda 探针 ( [http://www.lambdaprobe.org](http://www.lambdaprobe.org) )

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-27T19:41:55.173

RMI 是一个非常昂贵的协议。我会考虑更换它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-10T11:48:31.470

如果你不能改变协议，至少改变有效载荷：

1）这听起来像一个封闭的系统。如果是，则不需要使用通用的 Serializable 协议。切换到 Externalizable 并写入捕获对象状态以进行电汇所需的最少数据。

2) 压缩从服务器发送到客户端的数据。除了 (1) 中的对象状态之外，您还应该减少在网络上移动的数据块（“文件”）。

除此之外（这显然取决于系统）您应该探索前向缓存节点。在许多应用程序中，都有一种域实体访问模式。如果存在可以利用的地理访问模式，您应该能够轻松地创建新的代理节点，这些代理节点是远程服务器的客户端，然后充当附近 (rmi) 客户端的 (rmi) 服务器。

# linq - 强制执行 IQueryable？

> ID：792814
> 
> 赞同：17
> 
> 时间：2009-04-27T09:28:50.980
> 
> 标签：linq, iqueryable, delayed-execution

我有一个我想在 IQueryable 上执行的“没有转换为 SQL”的方法，有没有办法强制 IQueryable 执行而不必将它存储在某个中间类中？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-27T09:39:35.073

问题是您希望您的方法在本地执行而不是在数据库中执行吗？如果是这样，`AsEnumerable`是你的朋友。这是一个非常简单的方法，例如：

```
public IEnumerable<T> AsEnumerable(IEnumerable<T> source)
{
    return source;
} 
```

重要的是它使结果的编译时类型`IEnumerable<T>`而不是`IQueryable<T>`，这意味着您之后调用的任何 LINQ 查询运算符都将是 LINQ to Objects 而不是 LINQ to SQL。

例如：

```
var query = context.Employees
                   // Filtering performed in SQL
                   .Where(emp => emp.IsFullTime)
                   .AsEnumerable()
                   // Projection performed locally; ComputeSalary has no
                   // SQL equivalent
                   .Select(emp => new { Employee = emp,
                                        Salary = ComputeSalary(emp) }); 
```

您可以`ToList`按照其他地方的建议进行调用，但是如果您正在执行过滤并且真的不需要内存中的*完整*`AsEnumerable`列表，那么调用和过滤*该*结果将比首先加载所有内容更有效。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-27T09:31:29.743

```
List<Employees> myEmployees =  myqueryable.ToList(); 
```

然后你可以在那个列表上做你的 linq 东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T09:33:40.737

当您编写了一个 LinqToSql 不知道如何转换为 SQL 的查询（这也是它所说的）时，您会收到该消息。

我不确定我是否完全得到您的要求，但据我所知，您有以下选择：

1.  重写您的查询，以便 LinqToSql 可以翻译它
2.  在 Sql Server 上执行尽可能多的查询，然后在内存中执行其余的（使用 linq to objects）
3.  坐下来哭

假设我们排除 #3，让我们看看其他 2 个示例。

1.  重写它——为了解决这个问题，我们需要你的 linq 查询。

2.  在这里，您从初始查询中取出无法翻译的部分，然后在您的 Iqueryable 调用 ToList 上，然后在该列表上应用查询的其余部分。

并且您可以执行查询而无需存储它吗？好吧，并非如此，您总是可以遍历结果，因此不要将其存储在变量中，但显然查询的结果需要存储在某个地方。

# python - 如何避免由 Tkinter、visual 和 ipython 引起的 Gdk-ERROR？

> ID：792816
> 
> 赞同：1
> 
> 时间：2009-04-27T09:29:12.807
> 
> 标签：python, tkinter

当我关闭 tk-window instance 时，以下几行会导致 ipython 崩溃`a`。

```
import visual, Tkinter
a = Tkinter.Tk()
a.update()
display = visual.display(title = "Hallo")
display.exit = 0
visual.sphere() 
```

如果我先关闭视觉显示，整个终端就会崩溃。我在 kubuntu 8.10 上运行一切。这是一个错误还是我做错了什么？如果这是一个错误：有没有聪明的方法来避免它？

干杯，菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:15:50.277

您是否尝试过使用`-gthread -tk`命令行开关启动 ipython？

来自`ipython --help`：

```
       -gthread、-qthread、-q4thread、-wthread、-pylab

              只能给出其中之一，并且只能作为
              传递给 IPython 的第一个选项（它不会在任何
              其他职位）。它们为 GTK、QT 提供线程支持
              和 WXWidgets 工具包，以及 matplotlib 库。

              使用前四个选项中的任何一个，IPython 开始运行
              图形工具包操作的单独线程，这样
              您可以从内部打开和控制图形元素
              IPython 命令行，无阻塞。四个都提供
              基本相同的功能，分别用于 GTK、QT3、
              QT4 和 WXWidgets（通过它们的 Python 接口）。

              请注意，使用 -wthread，您还可以使用 -wxversion
              请求使用特定版本的 wx 的选项。这个
              要求您安装了“wxversion”Python 模块，
              这是最近的 wxPython 发行版的一部分。

              如果给出 -pylab，IPython 会加载对 mat- 的特殊支持
              plotlib 库（http://matplotlib.sourceforge.net），允许
              其任何后端的交互式使用，如
              用户的 .matplotlibrc 文件。它会自动激活 GTK、QT
              如果选择 matplotlib 后端，则为 IPyhton 或 WX 线程
              需要它。它还将 %run 命令修改为正确
              执行（不阻塞）任何基于 matplotlib 的脚本
              最后调用 show()。

       -tk -g/q/q4/wthread 选项和 -pylab（如果 matplotlib 是
              配置为使用 GTK、QT 或 WX），通常会阻止 Tk
              图形界面。这意味着当 GTK、QT 或 WX
              线程处于活动状态，任何打开 Tk GUI 的尝试都会导致
              一个死窗口，并可能导致 Python 解释器
              碰撞。额外的选项 -tk 可用于解决此问题
              问题。它只能作为第二个选项在任何
              以上（-gthread、-qthread、q4thread、-wthread 或 -pylab）。

              如果给出 -tk，IPython 将尝试协调 Tk 线程
              与 GTK、QT 或 WX。然而，这可能不可靠，并且
              您必须在您的平台和 Python 配置上进行测试
              确定它是否适合您。Debian 用户有
              报告成功，显然是由于 Debian 构建
              所有 Tcl、Tk、Tkinter 和 Python 都支持 pthreads。在下面
              其他 Linux 环境（如 Fedora Core 2/3），此选项
              导致 Python 解释器随机崩溃和锁定。
              在其他操作系统（Mac OSX 和 Windows）下，您需要
              尝试找出答案，因为目前没有用户报告
              可用的。

              不幸的是，IPython 无法在运行时确定-
              -tk 是否可靠工作的时间，所以你需要
              在依靠它进行常规工作之前做一些实验。

```

# xml - 最新版本的 XML 未在 Firefox 中加载，但在 IE 中可以正常工作

> ID：792821
> 
> 赞同：1
> 
> 时间：2009-04-27T09:31:08.353
> 
> 标签：xml, firefox, actionscript-2

我正在使用 AS2。我在我的电影中加载了一个 XML 文件。不知何故，XML 文件被加载。现在。如果我更改 XML 文件，最新的 XML 文件不会出现在 FireFox 中，而最新的 XML 文件会出现在 IE 中。谁能告诉问题是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T07:27:20.583

Clear your cache?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-01T13:47:51.683

更进一步，您需要确保这种情况在未来不会出现 - 即在您这次清除缓存之后......

有几种方法：

1.  使用附加到文件位置的“cache-buster”字符串 - 例如

    ```
    ./data.xml?nocache=010920091407
    ```

    您使用 Date 对象动态生成 nocache 的值。这没问题，但意味着 XML*永远不会*被缓存，因为每次加载 flash 时，nocache 值都会改变。
2.  动态生成 XML 内容 - 即调用

    ```
    ./data.php
    ```

    与上述相同的问题：内容永远不会被缓存，而是在*每次*页面视图时重新加载
3.  **更好：** “自动版本控制”

    1.  使用 PHP 更改文件的路径，以便

        ```
        ./data.xml
        ```

        变成

        ```
        ./data.010920091407.xml
        ```

        其中 010920091407 是文件的 filemtime 值（即上次更新的时间）
    2.  嵌入时通过 flashvars 将此值传递给您的 Flash 应用程序。
    3.  使用 mod_rewrite 规则（例如在 .htaccess 文件中）转换具有此命名约定的文件的路径：

        ```
        RewriteRule ^(.+)\.(.+[0-9])\.(js|css|swf|xml)$$1.$3
        ```

        剥去

        ```
        .010920091407
        ```

        并返回文件

        ```
        ./data.xml
        ```

        但*浏览器*认为它正在加载一个新文件。现在，您可以保证用户每次更改文件时都会加载文件的新版本，但如果没有，则从缓存中加载。（你会看到，在这里我已经告诉它对我通常需要保证更新的任何文件执行此操作：*.js、*.css 和 *.swf）（显然这是假设一个LAMP服务器，但是任何栈下原理都是一样的）

更新：一个有用的教程可以在这里找到：http:
[//particletree.com/notebook/automatically-version-your-css-and-javascript-files/](http://particletree.com/notebook/automatically-version-your-css-and-javascript-files/)
更深入的一个在这里：
[http://www.ejeliot .com/blog/125](http://www.ejeliot.com/blog/125)

# java - 垃圾回收的“孤岛”

> ID：792831
> 
> 赞同：55
> 
> 时间：2009-04-27T09:33:56.773
> 
> 标签：java, garbage-collection

谁能解释一下垃圾收集**隔离岛的概念？**

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-04-27T09:43:34.707

对象 A 引用对象 B。对象 B 引用对象 A。对象 A 和对象 B 均未被任何其他对象引用。那是一个与世隔绝的孤岛。

基本上，隔离岛是一组相互引用的对象，但它们不被应用程序中的任何活动对象引用。严格来说，即使是单个未引用的对象也是一个孤立的孤岛。

**从评论编辑：**

```
class A {
   B myB; 
} 
class B { 
   A myA; 
} 

/* later */  
A a = new A(); 
B b = new B();  
a.b = b; 
b.a = a; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-27T09:36:46.313

这是对这个术语的一个[很好的解释](http://www.xyzws.com/Javafaq/what-is-islands-of-isolation-in-garbage-collection/42)。摘抄：

> *   “如果一个对象 obj1 被垃圾回收，但另一个对象 obj2 包含对它的引用，那么 obj2 也有资格进行垃圾回收”
> *   “如果对象 obj2 可以访问符合垃圾回收条件的对象 obj1，那么 obj2 也符合垃圾回收条件”
> 
> 这被称为“孤立岛”。“隔离岛”描述了一个或多个对象没有来自应用程序的活动部分的对它们的引用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-27T11:46:08.327

**要记住的是，只有在直接或间接地从GC 根对象**（线程、当前局部变量、静态变量等）引用对象时，才会收集对象。如果两个（或更多）对象相互引用，但没有从根引用，那么它们就有资格进行垃圾回收。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-02-28T12:29:15.297

事实上，如果你理解了垃圾回收的标记和清除的概念，你也会更好地理解孤岛：

*   该算法从GC根源开始：主线程、主方法中的局部变量、主类的静态变量。
*   该算法遍历所有对象引用，从 GC 根开始，并将找到的每个对象标记为活动的。
*   所有未被标记对象占用的堆内存都会被回收。它被简单地标记为空闲，基本上清除了未使用的对象。
*   如果两个或多个对象相互引用，但它们没有被与任何根链接的对象引用，则它们在孤立岛中，并且也被扫过。

# macos - 如何在 Mac OS X 中隐藏或禁用菜单项

> ID：792833
> 
> 赞同：2
> 
> 时间：2009-04-27T09:34:16.130
> 
> 标签：macos, menu

我可以从 CreateNibReference 函数中获取菜单句柄，但我不知道如何在 Mac OS X 中使用句柄隐藏或禁用菜单项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T09:53:12.793

听起来您正在使用碳菜单管理器。在这种情况下，如果你有一个`MenuRef`实例，你调用`DisableMenuItem()`，传递菜单项的索引，来禁用一个菜单项：

```
DisableMenuItem(menuRef, itemIndex); 
```

正如预期的那样，`EnableMenuItem()`再次调用以启用该项目。

据我所知，没有办法用碳菜单管理器“隐藏”菜单项。我能想到的最接近的事情是删除一个菜单项，在这种情况下你会使用`DeleteMenuItem()`：

```
DeleteMenuItem(menuRef, itemIndex); 
```

有关如何使用这些功能的更多详细信息，请参阅 Apple 的[菜单管理器文档。](http://developer.apple.com/documentation/Carbon/reference/Menu_Manager/Reference/reference.html)

此外，作为旁注，对于大多数应用程序，通常建议使用 Cocoa 而不是 Carbon。Apple 正在明显淘汰 Carbon，不久之后 Apple 可能会完全弃用它。

# .htaccess - 在 .htaccess 中使用 mod_rewrite 时出现 500 内部错误

> ID：792835
> 
> 赞同：1
> 
> 时间：2009-04-27T09:35:33.727
> 
> 标签：.htaccess, mod-rewrite

我不知道为什么，但是每次我对 .htaccess 文件中的 RewriteRule 使用复杂的模式时，我都会收到 500 内部错误。我当前的 .htaccess 文件的全部内容是：

```
RewriteEngine on
RewriteRule ^ups/sections/([A-Za-z]{3})/([A-Za-z0-9_-+\.]+)/?$ /dl.php?loct=sec&sec=$1&file=$2 [R=302] 
```

我只尝试了“RewriteEngine on”并且没有错误。我尝试了一些非常简单的方法，例如：“RewriteRule ^ups/?$ /xyz [R]”，效果很好。我尝试过使用和不使用 Symlinks 选项。我试过在模式的开头有和没有斜线，在替换的开头有和没有斜线。

似乎每当我使用“复杂”的正则表达式时，它都不起作用。

注意：我不拥有这台服务器，也无法更改 apache 配置文件。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:38:49.163

尝试将其更改为

```
RewriteRule ^ups/sections/([A-Za-z]{3})/([A-Za-z0-9_+.-]+)/?$ /dl.php?loct=sec&sec=$1&file=$2 [R=302] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T11:36:57.367

解释你的错误：在字符类中，破折号（`-`）总是描述两个字符之间的范围。除了它出现在字符类的开头或结尾。但是您从`_`to的范围`+`是无效的，因为`_`(0x5F) 的位置高于`+`(0x2B)。

# asp.net - .NET 网站与 GAC 中的参考 - 如何部署？

> ID：792841
> 
> 赞同：1
> 
> 时间：2009-04-27T09:36:26.657
> 
> 标签：asp.net

我认为很容易回答的快速问题。

我有一个 .net 网站，其中引用了 GAC 中的 dll。

当我构建它并部署到在 GAC 中没有相同 DLL 引用的另一台服务器（生产中）时，我怎样才能获得 dll？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:41:15.600

如果这是您在网站上复制的手动过程，则必须单独复制 GAC dll 并将其安装在生产服务器上。

您可以使用 GacUtil.exe（位于 Visual Studio/SDK/bin 文件夹中）执行此操作，也可以使用控制面板下的 Admin Tools.NET Framework 2.0 配置 MMC 管理单元。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T19:34:40.477

不要使用 GAC ！！！gac不好。任何其他应用程序最终都可能更改其中的 DLL，如果您没有引用确切的版本，您的应用程序将会更改。

# c# - 我必须在我的 WPF 数据绑定中进行哪些更改才能让 Listbox 显示项目？

> ID：792845
> 
> 赞同：1
> 
> 时间：2009-04-27T09:36:59.200
> 
> 标签：c#, wpf, data-binding, listbox

我在一个示例中找到了这个 XAML：

```
<Window x:Class="TestDataTemplate123.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TestDataTemplate123"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <local:Customer x:Key="customers"/>
    </Window.Resources>
    <StackPanel>
        <TextBlock Text="Customers:"/>
        <ListBox ItemsSource="{Binding Source={StaticResource customers}}"/>
    </StackPanel>
</Window> 
```

**我正在尝试创建后面的代码，但以下代码不起作用**（它显示一个空集（我期待一个单词列表`TestDataTemplate123.Customer`）。

**窗口1.cs**

```
using System.Collections.ObjectModel;
using System.Windows;

namespace TestDataTemplate123
{
    public partial class Window1 : Window
    {
        public static ObservableCollection<Customer> Customers()
        {
            return Customer.GetAllCustomers();
        }

        public Window1()
        {
            InitializeComponent();
        }
    }
} 
```

**客户.cs：**

```
using System.Collections.ObjectModel;

namespace TestDataTemplate123
{
    public class Customer
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public int Age { get; set; }

        public static ObservableCollection<Customer> GetAllCustomers()
        {
            ObservableCollection<Customer> customers = new ObservableCollection<Customer>();
            customers.Add(new Customer() {FirstName = "Jim", LastName = "Smith", Age = 23});
            customers.Add(new Customer() {FirstName = "John", LastName = "Jones", Age = 22});
            customers.Add(new Customer() {FirstName = "Jay", LastName = "Anders", Age = 21});
            return customers;
        }
    }
} 
```

我尝试了许多不同的 xmlns:local、x:Key、StaticResource、DataContext 组合，但我得到了各种错误或一个空的 ListBox。

我必须改变什么，以便它只列出来，`TestDataTemplate123.Customer`以便我可以继续制作我的 DataTemplate？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T09:44:03.080

您的 XAML 让您将列表中的项目绑定到客户的单个实例。您需要绑定到客户列表。

由于您在代码隐藏中完成大部分工作，因此我将`<local:Customer />`放弃 XAML 中的声明以及 ItemsSource 属性，并将其设置在您的代码中：

```
public Window1()
{
    InitializeComponent();
    listBox1.ItemsSource = Customer.GetAllCustomers();
} 
```

请注意，我已经给 ListBox 起了一个名字，所以我可以从后面的代码中引用它。这样做：

```
<ListBox x:Name="listBox1" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T10:03:20.460

您需要创建一个 DataSourceProvider 派生[ObjectDataprovider](http://msdn.microsoft.com/en-us/library/system.windows.data.objectdataprovider.aspx)，它返回要显示的对象列表

```
<Window.Resources>
  <ObjectDataProvider x:Key="Customers" 
       ObjectType="{x:Type local:Customer}" 
       MethodName="GetAllCustomers" />
</Window.Resources>
...
<ListBox DataContext="{StaticResouce Customers}" ItemsSource="{Binding}" ... /> 
```

# asp.net - How2：在 HttpModule 中挂钩什么事件以将 js 链接放入 head 元素

> ID：792851
> 
> 赞同：1
> 
> 时间：2009-04-27T09:38:21.253
> 
> 标签：asp.net, ihttpmodule

我想让 HttpModule 从一些简单的配置数据中注入 javascripts、css 链接到 HEAD 元素。我不确定我应该挂钩哪个事件？

目前我使用
- context.PreRequestHandlerExecute 动态更改母版页
- Context.BeginRequest 用于 SEO 优化

[HTTPModule 事件执行顺序](https://stackoverflow.com/questions/441421/httpmodule-event-execution-order)有一些帮助吗？

感谢您的任何提示。干杯，X。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T12:46:14.877

```
using System;
using System.Web;
using System.Web.UI;

namespace YourNamespace
{
    public class YourModule : IHttpModule
    {
        public void Init(HttpApplication context)
        {
            context.PreRequestHandlerExecute += Application_PreRequestHandlerExecute;
        }

        private void Application_PreRequestHandlerExecute(object sender, EventArgs e)
        {
            Page page = HttpContext.Current.CurrentHandler as Page;
            if (page != null)
            {
                string script = "/js/jquery.1.3.2.min.js";
                if (page.Header != null)
                {
                    string scriptTag = String.Format("<script language=\"javascript\" type=\"text/javascript\" src=\"{0}\"></script>\n", script);
                    page.Header.Controls.Add(new LiteralControl(scriptTag));
                }
                else if (!page.ClientScript.IsClientScriptIncludeRegistered(page.GetType(), script))
                    page.ClientScript.RegisterClientScriptInclude(page.GetType(), script, script);
            }
        }

        public void Dispose() { }
    }
} 
```

ASP.Net 生命周期：http: [//msdn.microsoft.com/en-us/library/ms178473.aspx](http://msdn.microsoft.com/en-us/library/ms178473.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T21:33:41.883

以下是我如何在没有 HttpModule 的情况下实现你正在做的事情。我不喜欢 httpmodule 的想法，因为如果我忘记注册它并且它没有运行，我的应用程序将无法运行，这将是一个不明显的错误。该页面绝对需要包含 JS，因此我决定将其放在项目的基 Page 类中。

我是在几年前实现的，希望能够包含的不仅仅是脚本，它还支持 css、元标记等。我忘记了为什么我使用 Page.Header.Controls.Add 而不仅仅是 Page.ClientScript.RegisterClientScriptInclude但这是有原因的。

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.UI;

namespace YourNamespace
{
    public class HeaderIncludesManager
    {
        private List<string> m_IncludedFiles = new List<string>();

        public void IncludeScript(string s)
        {
            IncludeScript(s, null);
        }

        public bool IsIncluded(string file)
        {
            return (m_IncludedFiles.Find(s => s.Equals(file, StringComparison.InvariantCultureIgnoreCase)) != null);
        }

        public void IncludeScript(string script, string condition)
        {
            Page page = HttpContext.Current.CurrentHandler as Page;
            if (!IsIncluded(script) || page == null)
                return;

            string scriptFile = string.Format("/{0}/{1}?v={2}", MyConfig.JSDir, script, MyConfig.BuildNumber);
            if (page.Header != null)
            {
                string scriptTag = String.Format("<script language=\"javascript\" type=\"text/javascript\" src=\"{0}\"></script>\n", scriptFile);
                if (!String.IsNullOrEmpty(condition))
                    scriptTag = String.Format("<!--[{0}]><script language=\"javascript\" type=\"text/javascript\" src=\"{1}\"></script><![endif]-->\n", condition, scriptFile);

                page.Header.Controls.Add(new LiteralControl(scriptTag));
                m_IncludedFiles.Add(script);
            }
            else if (!page.ClientScript.IsClientScriptIncludeRegistered(GetType(), scriptFile))
            {
                page.ClientScript.RegisterClientScriptInclude(GetType(), scriptFile, scriptFile);
                m_IncludedFiles.Add(script);
            }
        }

        public void IncludeCss(string css)
        {
            Page page = HttpContext.Current.CurrentHandler as Page;
            if (!IsIncluded(css) || page == null)
                return;

            string cssfile = string.Format("/{0}/{1}?v={2}", MyConfig.CssDir, css, MyConfig.BuildNumber);
            if (page.Header != null)
            {
                ((Page)HttpContext.Current.CurrentHandler).Header.Controls.Add(new LiteralControl(String.Format("<link href=\"{0}\" rel=\"stylesheet\" type=\"text/css\" />\n", cssfile)));                    
                m_IncludedFiles.Add(css);
            }
        }

        public void IncludeJQuery()
        {
            IncludeScript("jquery-1.2.3.min.js");
        }

        public void IncludeJQueryUI()
        {
            IncludeJQuery();
            IncludeScript("jquery.ui.1.0.min.js");
            IncludeCss("jquery-theme.css");
        }

        public void IncludeFlotScripts()
        {
            IncludeJQuery();
            IncludeScript("flot/jquery.flot.js");
            IncludeScript("flot/excanvas.pack.js", "if IE");
        }
    }

    public class MyPage : Page
    {
        public HeaderIncludesManager HeaderIncludes = new HeaderIncludesManager();
    }

    public class MyControl : UserControl
    {
        public new MyPage Page
        {
            get
            {
                return (MyPage)base.Page;
            }
        }
    }

    public class SomeControlThatNeedsScripts : MyControl
    {
        protected override void OnLoad(EventArgs e)
        {
            Page.HeaderIncludes.IncludeJQueryUI();
            base.OnLoad(e);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T12:32:15.987

HttpHandler 将是此类功能的更好选择。这是一个结合 css 和 javascript 文件的示例；它不完全是您正在寻找的东西，但应该让您朝着正确的方向前进：http: [//www.codeproject.com/KB/aspnet/HttpCombine.aspx](http://www.codeproject.com/KB/aspnet/HttpCombine.aspx)

# asp.net - 用户是否已经登录？

> ID：792853
> 
> 赞同：0
> 
> 时间：2009-04-27T09:38:38.070
> 
> 标签：asp.net, login

我想知道如何实现“如果用户已经登录或未登录”的场景？即我有一个应用程序，它最初将你重定向到 Login.aspx，然后重定向到 Home.aspx。我正在显示一个类似欢迎“用户名”的消息。现在，如果用户没有注销并关闭浏览器并下次访问该站点他应该直接被重定向到 Home.aspx。如何实现这个。这是否可以在 VS2008 中检查（关闭浏览器并再次运行应用程序）？如果你们想要更多信息，请告诉我。

Eoin 询问的更多信息：

登录机制非常简单。我有一个注册用户的页面（值将进入数据库。）我使用了简单的 txt 框，没有登录控制。登录页面与 DB 中的值匹配并让用户登录。登录后，用户使用 (FormsAuthentication.RedirectFromLoginPage(TextBox1.Text, false)) 重定向到 Home.aspx，我可以使用 User 获取用户名。身份.名称。让我知道更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T09:43:51.537

您使用的是 .NET Membership Provider 吗？

听上去，你想实现一个“记住这个用户”的功能。您可以通过实现基于 cookie 的登录来做到这一点，该登录将登录令牌存储在客户端浏览器中，因此当他们返回站点时，他们会自动重新登录。

但是您确实需要提供更多关于到目前为止您的登录机制是如何实现的信息。

# database - Sharepoint 数据库和表格

> ID：792857
> 
> 赞同：1
> 
> 时间：2009-04-27T09:39:00.300
> 
> 标签：database, sharepoint

我在我们的 SharePoint 门户上创建了一个名为“技术”的多选列。最近，我在更改列值时错误地单击了删除按钮，现在我想以原始形式恢复系统。我重新创建了包含所有选项的列，问题是所有文档都具有与之相关的技术价值。我现在的任务是将技术名称附加到每个文档中。

我想知道我可以去哪个数据库表中的信息并添加正确的值，以便它显示在列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T11:00:04.380

你不能通过数据库真正做到这一点，你最好创建一个 powershell 脚本来运行文档，添加正确的值。

否则，您将不得不“在数据表中编辑”以快速更新值。

# asp.net - 如何在 .Net 中将 javascript 连接到我的 CustomValidator 控件

> ID：792858
> 
> 赞同：0
> 
> 时间：2009-04-27T09:39:27.617
> 
> 标签：asp.net, javascript, custom-validators

我创建了一个 CustomValidator 控件

```
public class MyValidator :CustomValidator, IScriptControl {} 
```

并且还创建了等效的客户端脚本。服务器验证工作正常，但是如何连接我的客户端脚本？

呈现的 javascript 看起来像

```
var MyValidator1 = document.all ? document.all["MyValidator1"] : document.getElementById("MyValidator1");
MyValidator1.controltovalidate = "MyField";
MyValidator1.errormessage = "error";
MyValidator1.evaluationfunction = "MyValidatorEvaluateIsValid"; 
```

如何覆盖生成的 javascript 来设置评估函数的值？例如

```
MyValidator1.evaluationfunction = "MyCustomJavascriptFunction"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:33:46.037

您可以像这样设置基类的 ClientValidationFunction 属性 -

```
base.ClientValidationFunction = "MyCustomJavascriptFunction"; 
```

所以，它会像这样渲染它 -

```
MyValidator1.evaluationfunction = "MyCustomJavascriptFunction"; 
```

您也可以通过设置相同的属性从控件中执行此操作。

编辑：你可以做

```
document.getElementById("<%= ValidatorId %>").evaluationfunction = "MyCustomJavascriptFunction"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:56:39.410

我自己回答了这个问题，因为另一个答案并没有完全达到我想要的效果。我最终使用了。

```
public class MyValidator : BaseValidator, IScriptControl  {

  protected override void AddAttributesToRender(HtmlTextWriter writer) {
    base.AddAttributesToRender(writer);
    Page.ClientScript.RegisterExpandoAttribute(this.ClientID, "evaluationfunction", "MyJavascriptFunction");
  }

} 
```

这将导致控件生成：

```
MyValidator1.evaluationfunction = "MyJavascriptFunction"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-11T00:14:16.197

实际上更容易使用 asp:CustomValidator 的 ClientValidationFunction 属性，如下所示。确保不要指定 ControlToValidate 属性。

```
<asp:CustomValidator ClientValidationFunction="MyCustomJSFunction" Text="Required" ForeColor="Red"></asp:CustomValidator>

function MyCustomJSFunction(validator, args) {
    args.IsValid = my condition;
} 
```

# windows - 应用程序如何加载没有名称的 DLL？

> ID：792867
> 
> 赞同：1
> 
> 时间：2009-04-27T09:41:22.697
> 
> 标签：windows, debugging, reverse-engineering, disassembly

我已经反汇编了一个调用 DLL 库中的函数的 VB6 应用程序，但是在反汇编中我找不到对 DLL 的任何引用。调用代码如何加载这个 DLL？它是动态链接的，因为我可以观察到删除和替换 DLL 的效果。

我使用的是 IDA Pro Free，调用应用程序是一个 VB6 应用程序，而 DLL 是一个普通的 Win32 DLL，我怀疑它是使用 C 或 C++ 创建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T12:48:39.033

*“找不到任何参考资料*”是什么意思？你没有看到 dll 名称的字符串？你没有看到调用 dll 的代码吗？
您可以在 dll 中放置一个断点，然后查看通向 VB6 应用程序的调用堆栈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T17:44:27.380

如果它是一个 COM DLL，它可能会通过 GUID 而不是名称来查找它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T17:42:09.723

[在PE Explorer](http://www.heaventools.com/PE_Explorer_Exports_Viewer.htm)中打开您的应用程序，它将显示所有链接的 DLL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T17:49:40.877

您是否也搜索过 DLL 名称的 Unicode 版本？加载 DLL 的应用程序可能使用宽字符构建。

# c# - 如何从 Windows 服务映射网络驱动器？

> ID：792868
> 
> 赞同：3
> 
> 时间：2009-04-27T09:41:45.660
> 
> 标签：c#, windows-services, network-drive

我正在尝试从 Windows 服务映射网络驱动器，我使用批处理文件执行以下命令

```
NET USE U: \\192.168.55.6\folder password 
```

在服务构造函数或 onstart 事件中执行批处理文件时，驱动器未映射？

```
 Process process = new Process();
        process.StartInfo.FileName = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location) + "\\MAP.BAT";
        process.StartInfo.CreateNoWindow = false;
        process.Start(); 
```

如何从 Windows 服务映射网络驱动器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-12-08T13:02:03.593

这可以使用对 Windows 脚本宿主对象模型的引用来实现。

**添加对Windows 脚本宿主对象模型**的 COM 引用，该模型将条目 IWshRuntimeLibrary 添加到引用部分。现在您可以使用以下代码来映射驱动器。

```
using IWshRuntimeLibrary;

IWshNetwork_Class network = new IWshNetwork_Class();
network.MapNetworkDrive("k:",@"\\192.168.20.35\MyShare", Type.Missing, "user1", "password1"); 
```

您可以使用以下代码取消映射或删除映射。

```
network.RemoveNetworkDrive("k:"); 
```

我在[这里记录了详细的步骤](http://techisolutions.blogspot.com/2011/12/map-network-drive-using-c-vbnet-code.html "这里")

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T09:03:04.717

[通过使用映射网络驱动器 (API)](http://www.codeproject.com/KB/system/mapnetdrive.aspx)映射网络驱动器解决了所有问题。我在服务的 OnStart 事件时映射所需的驱动器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T10:58:26.647

最好只调用正确的 API 函数，而不是调用批处理文件来调用另一个可执行文件。您正在寻找的功能是[`DefineDosDevice()`](http://msdn.microsoft.com/en-us/library/aa363904%28VS.85%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T05:47:36.713

有两个问题：

1.  映射仅用于用户会话，这意味着您实际上不能将映射驱动器用于服务。您将需要使用[unc](/questions/tagged/unc "显示标记为“unc”的问题")路径。
2.  第二个问题是服务（使用本地系统帐户）无法访问网络，或者更具体地说，无法访问所需的资源。要解决此问题，您需要： 授予运行该服务的“计算机”对该文件夹的特定访问权限，或者，将服务设置为使用有权访问该资源的网络 (DOMAIN) 帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T09:45:50.410

我认为服务无法映射网络驱动器，除非它们具有正确的“与桌面交互”？

尝试在“网络服务”帐户下运行服务，而不是“本地系统”？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T09:58:23.127

您是否在属于密码的用户帐户下运行服务？该`MAP USE`命令将使用当前用户，除非您通过 /USER:anotheruser

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T13:00:04.063

据我所知，映射驱动器仅在用户会话期间映射。如果您的 Windows 服务在启动时运行，或者不是用户会话的一部分，则驱动器映射将丢失。

这可能是真的，也可能不是真的，但值得研究一下——我记得大约 7 年前的类似情况。

# sql-server - 如何发送邮件以便在 SqlServer 中执行特定作业时

> ID：792869
> 
> 赞同：0
> 
> 时间：2009-04-27T09:42:26.033
> 
> 标签：sql-server, sql-server-2005

我正在创建一个执行以下 SQL 语句的作业。

```
select * from emp where sal > 5000 
```

它计划在每天下午 3 点执行。

现在我的问题是：
如何配置邮件或警报，以便在作业执行时我必须接收邮件或警报指示查询已成功执行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T09:47:02.247

您可以为作业添加成功和失败（或两者）通知。然后，您将其分配给具有电子邮件、寻呼机等联系人的操作员。

例子：

[如何：通知操作员作业状态 (SQL Server Management Studio)](http://msdn.microsoft.com/en-us/library/ms191130.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T10:23:54.280

我会使用**SQL Server 代理**来发送电子邮件。

您可以通过创建一个存储过程来实现它，然后在作业中运行它。 [使用 SMTP 在 SQL Server 中发送自动作业电子邮件通知](http://www.howtogeek.com/howto/database/sending-automated-job-email-notifications-in-sql-server-with-smtp/)

还有微软关于如何在 2005 年进行的 链接。 [MSDN 2005 Link](http://msdn.microsoft.com/en-us/library/ms191130(SQL.90).aspx)

这是在 2005 年设置 SQL Server Mail 的另一个链接，您可能会发现它很有用。 [数据库电子邮件](http://www.sql-server-performance.com/articles/dba/email_functionality_p1.aspx)

# sql - 哪个 SQL 查询更好，MATCH AGAINST 还是 LIKE？

> ID：792875
> 
> 赞同：70
> 
> 时间：2009-04-27T09:44:22.487
> 
> 标签：sql, mysql, database, search

要在数据库中搜索在任何列“foo_desc”和“bar_desc”中同时具有关键字“foo”和“bar”的行，我会执行以下操作：

```
SELECT * 
FROM t1 
WHERE MATCH (t1.foo_desc, t2.bar_desc) AGAINST ('+foo* +bar*' IN BOOLEAN MODE) 
```

或者

```
SELECT * 
FROM t1 
WHERE (CONCAT(t1.foo_desc, t2.bar_desc) LIKE '%foo%') AND (CONCAT(t1.foo_desc, t2.bar_desc) LIKE '%bar%') 
```

我预计最后一个查询的缺点是性能。

好处是 LIKE 查询找到了 MATCH AGAINST 没有的 'xxfoo'。

哪个是首选还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-04-27T09:46:46.587

## 更新

自`MySQL 5.6`及以后，`InnoDB`表支持`Match... Against`.

* * *

第一个**要**好得多。在**MyISAM**表上，它将对这些列使用全文索引。另一个将进行全表扫描，对每一行进行连接，然后进行比较。

`LIKE`仅当您针对以下情况进行操作时才有效：

*   一列（不是函数的结果，除非您的特定数据库供应商支持功能索引——例如 Oracle——并且您正在使用它们）；
*   列的开始（即`LIKE 'blah%'`相对于`LIKE '%blah%'`）；和
*   被索引的列。

如果其中任何一个条件不成立，SQL 引擎执行查询的唯一方法就是执行全表扫描。这可以在大约 10-20000 行下使用。除此之外，它很快变得无法使用。

**注意：** MySQL 上 MATCH 的一个问题是它似乎只匹配整个单词，因此搜索 'bla' 不会匹配值为 'blah' 的列，但搜索 'bla*' 会。

# asp.net-mvc - 在 MVC 中模拟 RouteTable.Routes.GetVirtualPath

> ID：792883
> 
> 赞同：3
> 
> 时间：2009-04-27T09:46:25.977
> 
> 标签：asp.net-mvc, rhino-mocks

我有一个带有调用方法的分页控制器

```
RouteTable.Routes.GetVirtualPath(this.viewContext.RequestContext, valueDictionary) 
```

我正在尝试使用 Rhino 模拟测试此方法，但我不确定如何模拟 GetVirtualPath 以返回 null 以外的路由。我在嘲笑 RequestContext 但我不确定哪些方法/属性需要被存根。

通过适当地对 mockRequestContext 进行存根，GetVirtualPath 是否应该返回一个非空路径，如果是这样，需要对什么进行存根才能使其工作？

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T09:57:21.117

不知道我是否理解你的问题，但它看起来像这样：

```
IRouteTable routeTableMock = RhinoMocks.CreateMock<IRouteTable>();

// assuming that IRouteTable.Routes is of type IRoutes.
IRoutes routes = RhinoMocks.CreateMock<IRoutes>();

// return the routes with the mock
routeTableMock.Stub(x => x.Routes).Return(routes);

// setup the mock for GetVirtualPath
routes.Stub(
  x => x.GetVirtualPath(
    Arg<RequestContext>.Is.Anything, 
    Arg<IDictionary>.Is.Anything)
  .Return(/* whatever */); 
```

如果这不是您想要的，您必须更多地介绍您的课程以及您想要测试的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-08T00:49:46.103

如果您不需要完整的虚拟路径，而只需要它生成的 URL，则可以改用：

```
new UrlHelper(ControllerContext.RequestContext).RouteUrl(routeValueDictionary) 
```

...并模拟出 ControllerContext：

```
var mockHttpContext = new Mock<HttpContextBase>();

var controllerContext
    = new ControllerContext(
        mockHttpContext.Object,
        new RouteData(), 
        new Mock<ControllerBase>().Object);

var myController = new MyController { ControllerContext = controllerContext }; 
```

我遇到了这个确切的问题，但这似乎已经解决了。

# php - 基于 Vim 语法的 php 折叠

> ID：792886
> 
> 赞同：10
> 
> 时间：2009-04-27T09:47:57.113
> 
> 标签：php, vim, syntax, folding

我已经下载了 php.vim 文件，其中包含基于 PHP 的语法信息。它应该能够提供基于语法的折叠，但由于某种原因我不能让它工作。

我已经设置`:let g:php_folding 2`，`:set foldmethod=syntax`但无济于事。我很确定文件在正确的位置并且被 vim 读取，因为我可以做到`:let g:php_sql_query=1`。

该`php.vim`文件位于`~/.vim/syntax/php.vim`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-25T21:50:15.653

:syntax enable (或 :syntax on) 工作，因为这两个选项也打开文件类型检测。必须在折叠或突出显示工作之前检测文件类型。

如果您使用 PHP 进行开发，您可能希望将这三行添加到您的 .vimrc

```
set nocompatible          " Because filetype detection doesn't work well in compatible mode
filetype plugin indent on " Turns on filetype detection, filetype plugins, and filetype indenting all of which add nice extra features to whatever language you're using
syntax enable             " Turns on filetype detection if not already on, and then applies filetype-specific highlighting. 
```

然后你可以把你的`let g:php_folding=2`和`set foldmethod=syntax`放在你的`~/.vim/after/ftplugin/php.vim`文件中。

这将使您的 .vimrc 文件保持干净，帮助组织所有设置，并且 foldmethod=syntax 只会影响 php 文件（如果要将语法设置为所有文件类型的默认折叠方法，请将该行保留在 .vimrc 文件中）

有关更多详细信息，请阅读以下帮助文件：

> :help 文件类型
> :help usr_05.txt
> :help usr_43.txt

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T07:23:37.147

我找到了[phpfolding.vim](http://www.vim.org/scripts/script.php?script_id=1623)，它非常易于使用。

1.  把 phpfolding.vim 放到*$HOME/.vim/plugin/*

2.  添加键盘映射

    `map <F5> <Esc>:EnableFastPHPFolds<Cr>`

    `map <F6> <Esc>:EnablePHPFolds<Cr>`

    `map <F7> <Esc>:DisablePHPFolds<Cr>`

好好享受！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T12:45:42.833

显然我的 VIM 没有运行 :syntax enable。

执行 :syntax enable 解决了问题，但我还在 .vimrc 上添加了 :syntax

# java - 在 MANIFEST 文件中使用外部 Bundle-Localization 路径

> ID：792887
> 
> 赞同：3
> 
> 时间：2009-04-27T09:50:13.143
> 
> 标签：java, eclipse, plugins, properties, runtime

MANIFEST.MF 文件包含一个条目，用于定义在运行时加载哪些 *.properties 文件。这些条目定义名称和相应的属性文件，用于翻译以前缀“%”开头的插件字符串，如“%plugin.name”

```
Bundle-Localization: plugin 
```

plugin.properties 比包含一行

```
%plugin.name=Runtime Plugin 
```

属性文件也可以命名为 application.properties，而不是我必须定义

```
Bundle-Localization: application 
```

当属性文件位于插件子目录“属性”中时，我可以定义

```
Bundle-Localization: properties/application 
```

* * *

**我的问题：** 我可以在插件之外定义一个捆绑本地化路径，比如

```
Bundle-Localization: ../properties/application 
```

看起来，正在搜索属性文件路径的 ManifestLocalization 对象确实要求 ZipFile 提供路径。并且 ZipPath 不支持此功能。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T01:54:48.590

不，您不能定义插件外部的路径。尽管除了捆绑之外还考虑了片段。

通常，捆绑包不绑定到磁盘上的位置，因此您无法真正定义像 ../properties 这样的路径应该解析到的位置。例如，考虑使用 `BundleContext#installBundle(String location, InputStream input)`. location 参数是捆绑包的标识，没有与之相关的语义。从输入流中读取包的内容。那么捆绑之外的路径意味着什么？

# visual-studio-2008 - Resharper 4.5 破坏了我的配色方案

> ID：792891
> 
> 赞同：6
> 
> 时间：2009-04-27T09:55:41.477
> 
> 标签：visual-studio-2008, resharper, themes, colors

我不确定这里到底出了什么问题，但 ReSharper 4.5 RTM 似乎窃取了我的 Visual Studio 颜色主题。我通常使用[Fredrik Kalseth 的 wicked theme](http://www.frickinsweet.com/tools/Theme.mvc.aspx)，并且从 2.0 版开始我就一直在使用 ReSharper。这种情况以前从未发生过——即使在使用 4.5 Beta 时也没有。我的方案完好无损，没有受到有害干扰 - 实际上，ReSharper 进行了正常的突出显示，这实际上是非常值得称赞的！但这一次，在构建我的新机器时，结果如下所示：

![深色意味着浅色主题](https://i.stack.imgur.com/gjf8i.jpg)

是的，我知道 ReShaper 颜色可以在 Tools->Font and Colors 下进行配置，但首先，我不想这样做，其次，我想了解为什么现在才发生这种情况，以前从未发生过。

当我卸载 ReSharper 时，颜色恢复正常。我曾尝试删除主题和 resharper 并以不同的顺序重新安装，但无济于事。我在打开一个代码文件的情况下应用主题，并看到它们过去的正确颜色的短暂闪烁，然后 ReSharper 接管。

我已经尝试过[Ryan 和 Joel 的 AWESOME 主题生成器](http://www.frickinsweet.com/tools/Theme.mvc.aspx)，但我看到导入后应用正确颜色的相同短暂闪烁，然后蹩脚的颜色再次叠加。我说它们只有在黑暗主题的背景下才糟糕，在浅色主题上它们看起来还不错。

我只是想知道如何吃蛋糕并像一直以来一样吃它。我必须强调，在我使用它的整个过程中（至少 6 个月），主题和 resharper 一直完美地协同工作，它只发生在我的新机器上 - 我的旧机器看起来和工作正常。哦 - 我有 ReSharper 的完全许可版本 - 不是试用版。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-27T10:00:10.670

打开 Visual Studio 转到 Resharper > 选项... > 代码检查 > 设置

取消勾选“颜色标识符”。按确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T09:57:48.853

尝试进入工具-> 字体和颜色，什么都不做，然后单击确定。它为我认识的一些人解决了这样的问题。我认为它使 VS 重新应用存储的颜色设置。

# javascript - jQuery：按钮的事件

> ID：792896
> 
> 赞同：0
> 
> 时间：2009-04-27T09:57:27.590
> 
> 标签：javascript, jquery

我是 jQuery 的新手并且喜欢它

任何人都可以给我一个小的 jQuery 代码片段，以在单击按钮（带有 id btnSave ）时显示警报/Div 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:01:32.837

你应该这样做：

```
$('#btnSave').click( function() {
  $('#alert').show();
})
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div id='alert'>ALERT!</div>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T10:06:46.070

```
$(function() {
  $("#btnSave").click(function() {
    alert("Alert");
  });
}); 
```

或者

```
<div id="alert">
<p>Some alert.</p>
<input type="button" id="ok" value="OK">
</div> 
```

和：

```
$(function() {
  $("#btnSave").click(function() {
    $("#alert").show();
  });
  $("#ok").click(function() {
    $("#alert").hide();
  });
}); 
```

**注意：**我实际上不会那样做。相反，我会使用现有的插件，如[jQuery UI dialog](http://docs.jquery.com/UI/Dialog)。

# php - is_file 或 file_exists 在 PHP

> ID：792899
> 
> 赞同：128
> 
> 时间：2009-04-27T09:57:58.727
> 
> 标签：php, file, exists

我需要检查文件是否在指定位置（$path.$file_name）的 HDD 上。

[`is_file()`](http://www.php.net/manual/en/function.is-file.php)和函数之间有什么区别，[`file_exists()`](http://www.php.net/manual/en/function.file-exists.php)在 PHP 中使用哪个更好/更快？

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2009-04-27T10:00:55.473

`is_file()``false`如果给定的路径指向一个目录，将返回。如果给定的路径指向一个有效的文件*或*目录，`file_exists()`将返回。因此，这完全取决于您的需求。如果您想*具体*了解它是否是文件，请使用. 否则，使用.`true`**`is_file()``file_exists()`**

 *** * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-05-09T13:07:58.080

`is_file()`是最快的，但最近的基准测试表明这`file_exists()`对我来说要快一些。所以我想这取决于服务器。

我的测试基准：

```
benchmark('is_file');
benchmark('file_exists');
benchmark('is_readable');

function benchmark($funcName) {
    $numCycles = 10000;
    $time_start = microtime(true);
    for ($i = 0; $i < $numCycles; $i++) {
        clearstatcache();
        $funcName('path/to/file.php'); // or 'path/to/file.php' instead of __FILE__
    }
    $time_end = microtime(true);
    $time = $time_end - $time_start;
    echo "$funcName x $numCycles $time seconds <br>\n";
} 
```

编辑：@Tivie 感谢您的评论。将周期数从 1000 更改为 10k。结果是：

1.  当文件*存在时*：

    is_file x 10000 1.5651218891144 秒

    文件存在 x 10000 1.5016479492188 秒

    is_readable x 10000 3.7882499694824 秒

2.  当文件*不存在*时：

    is_file x 10000 0.23920488357544 秒

    文件存在 x 10000 0.22103786468506 秒

    is_readable x 10000 0.21929788589478 秒

编辑：移动 clearstatcache(); 循环内。谢谢 CJ 丹尼斯。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-03-18T20:56:43.473

两者都不。

如果文件可以读取，is_file() 返回 true。

如果文件是目录，file_exists() 可以返回 true。

请注意，在某些边缘情况下，当 is_file() 由于权限或边缘情况文件系统问题而导致 is_file() 无法确定其是否为“常规文件”时，file_exists() 返回 true。

速度在这里无关紧要，因为它们不一样，它们会根据情况交换速度位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-07-27T08:45:13.440

我知道这篇文章很旧，但这些功能之间的区别不仅在于它们的行为。如果使用 is_file() 来检查大文件是否存在，超过 2 行。你会感到惊讶。文件不存在。:( 但是，如果您使用 file_exists() 检查，那就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-14T10:52:56.077

`is_file`如果与反斜杠一起使用会更快：`\is_file`. 在这种情况下，PHP 将提供 opcache 优化，也`file_exists`不会。

# php - 是否可以使用 PHP 创建 Windows 快捷方式？

> ID：792905
> 
> 赞同：5
> 
> 时间：2009-04-27T10:00:10.453
> 
> 标签：php, windows

我正在编写一个脚本来整理分布在我的硬盘上的一堆媒体，到目前为止它在家里（在我的 Mac 上）工作得很好，因为我在目录中使用符号链接来给人一种印象，一切都组织在一个位置，而实际数据分布在 4 个驱动器上。

不幸的是，我必须在工作中使用 Windows，当然直到 PHP 5.3 才支持符号链接（我认为这需要 Vista，因为那是命令行工具“mklink”首次出现的时候）。

作为一种解决方法，我考虑创建一个快捷方式，但我找不到这样做的方法。是否有可能，或者有没有我没有考虑过的更好的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T10:24:35.560

感谢上面的回答，我发现你确实可以从 php 调用 COM，这是我的 symlink() 替换的初稿：

```
if (! function_exists('symlink')) {
    function symlink($target, $link) {
        if (! substr($link, -4, '.lnk'))
            $link .= '.lnk';

        $shell = new COM('WScript.Shell');
        $shortcut = $shell->createshortcut($link);
        $shortcut->targetpath = $target;
        $shortcut->save();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T10:05:43.793

在 Vista 之前支持连接点（类似于 UNIX 符号链接）。

您需要`linkd`Windows 资源工具包中的工具（免费下载）。

快捷方式只是文件。您可以使用 COM WScript API 创建快捷方式文件。示例代码使用 Python 执行此操作。如果存在允许您进行 COM 互操作的 PHP 库，您应该能够执行类似的操作。

```
import win32com.client
import winshell

userDesktop = winshell.desktop()
shell = win32com.client.Dispatch('WScript.Shell')

shortcut = shell.CreateShortCut(userDesktop + '\\Zimbra Webmail.lnk')
shortcut.Targetpath = r'C:\Program Files\Mozilla Firefox\firefox.exe'
shortcut.Arguments = 'http://mysite.com/auth/preauth.php'
shortcut.WorkingDirectory = r'C:\Program Files\Mozilla Firefox'
shortcut.save() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-24T12:18:29.097

作为记录，NTFS 上的连接点确实仅用于目录。我在使用 linkd.exe 创建虚拟文件系统方面取得了巨大成功，但有几点需要注意：

*   您不能在卷之间进行链接（即尝试在 C: 中创建指向 D: 中的位置的链接将不起作用）
*   取消链接似乎偶尔会删除目的地的数据。在删除链接之前备份/移动数据！
*   在通过网络共享数据作为挂载卷时，连接点会遇到同样的问题——有时它们根本无法远程工作。无论您如何配置目标链接，它们似乎也随机（即有时）从源文件夹继承一些共享权限。

为有关创建 .lnk 文件的有用帖子干杯，这正是我所追求的……

# c# - 为 mp3 播放器制作均衡器

> ID：792907
> 
> 赞同：1
> 
> 时间：2009-04-27T10:00:23.540
> 
> 标签：c#, multimedia, equalizer

我想为我制作的mp3播放器做一个均衡器，但我不知道哪种方法是最简单的方法。我在我的播放器中使用 mci。请帮我！！！谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T11:08:01.490

musicdsp.org的[“过滤器”部分](http://www.musicdsp.org/archive.php?classid=3)应该是一个很好的起点。我已经在几个不同的地方看到了 3 频段 eq 的端口。

# c# - 什么是私有接口？

> ID：792908
> 
> 赞同：51
> 
> 时间：2009-04-27T10:00:39.873
> 
> 标签：c#

在不久前的一次 .NET 职位面试中，面试官问我“你会使用私有接口做什么？”。

我问他他的意思是隐式接口实现与显式接口实现之间的区别，他回答不是。

所以我想知道：

1.  他是什么意思？
2.  您将使用私有接口做什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-27T10:08:20.417

一个接口可以在另一个类中是私有的

```
public class MyClass
{
    private interface IFoo
    {
        int MyProp { get; }
    }

    private class Foo : IFoo
    {
        public int MyProp { get; set; }
    }

    public static void Main(string[] args)
    {
        IFoo foo = new Foo();
        return foo.MyProp;
    }
} 
```

就实用性而言，它只是向其他代码隐藏，即使在同一个程序集中，该接口也存在。在我看来，它的实用性并不是很高。

[显式接口实现](http://msdn.microsoft.com/en-us/library/aa288461(VS.71).aspx)是另一回事，有一些非常有用的案例（尤其是在使用泛型和较旧的非泛型接口时），但我不会将其称为“私有接口”，也不会说该术语通常以这种方式使用。

结合使用这两种技术，您可以：

```
public class MyClass
{
    private interface IFoo
    {
        int MyProp { get; }
    }

    public class Foo : IFoo
    {
        int IFoo.MyProp { get; set; }
    }

    public static void Main(string[] args)
    {
        IFoo foo = new Foo();
        return foo.MyProp;
    }
}

public class HiddenFromMe
{
    public static void Main(string[] args)
    {
        MyClass.Foo foo = new MyClass.Foo();
        return foo.MyProp; // fails to compile
    }
} 
```

这允许您以某种方式公开嵌套类，同时允许父类在它们上调用外部世界无法调用的方法。这是一个潜在有用的案例，但我不希望经常使用。当然，它在面试中的使用有点像面试官正在使用的边界案例，因为他们已经看过它并且虽然它很“有趣”

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-27T10:05:27.837

从[这个链接](https://web.archive.org/web/20111016070748/http://en.csharp-online.net/Common_Type_System%E2%80%94Private_Interface_Inheritance)。

> **私有接口继承**
> 
> 从历史上看，语言允许私有继承。在 C++ 中，您可以从一个类型继承而不与该类型在多态上兼容。这只是重用实现的一种便捷方式。在 CTS 中，您不能进行私有实现继承。但是你可以使用私有接口继承。
> 
> 私有接口继承实际上只是一种从类型的公共 API 中隐藏方法的方法。它们被编译成私有方法，但实际上可以通过类型的接口映射访问。换句话说，它们只能通过类型为定义方法的接口的引用来调用。一个例子将使这更容易理解：
> 
> ```
> class PrivateImplementer : IFoo
> {
>    void IFoo.Foo()
>    {
>        Console.WriteLine("PrivateImplementer::IFoo.Foo");
>    }
> } 
> ```
> 
> 在这种情况下，`PrivateImplementer`公知实施`IFoo`. 因此，一个实例可以被多态地视为 的一个实例`IFoo`。但是除非您确实将其视为`IFoo`. 此代码演示了这一点：
> 
> ```
> PrivateImplementer p = new PrivateImplementer();
> p.Foo(); // This line will fail to compile
> IFoo f = p;
> f.Foo(); 
> ```
> 
> 您可以选择接口的各个方法来私下实现。例如，如果`PrivateImplementer`实现`IFooBar`了，它可能会选择私下实现 Foo，但使用普通语法公开实现 Bar。
> 
> 实际上，使用私有实现的常见情况并不多。该`System.Collections.Generic`库使用这种方法秘密实现所有遗留 System.Collections 弱类型接口。这使得向后兼容性“正常工作”，例如将 的实例传递`List<T>`给期望 an 的方法`IList`可以正常工作。在这个具体的例子中，把新类型的 API 弄得乱七八糟是很可惜的（弱类型互操作需要很多方法）。

如果他想知道你知道什么，“不”是一个相当糟糕的答案。听起来像是一个只想展示他们知道多少的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-15T13:15:48.297

ShuggyCoUk 给出了很好的答案，但有这样的评论

> 这是一个潜在有用的案例，但我不希望经常使用。当然，它在面试中的使用有点像面试官正在使用的边界案例，因为他们已经看过它并且虽然它很“有趣”

我，必须说，这绝对不是聪明的面试官才有的能力。

这是[具有继承和统一支持的全状态机 (FSM) 实现](https://stackoverflow.com/a/37238655/6334867)，这是私有/受保护接口使用的一个很好的例子。

这是对问题的答案[什么是 C# 中的朋友等价物？](https://stackoverflow.com/questions/204739/what-is-the-c-sharp-equivalent-of-friend?answertab=votes#tab-top)[为什么 C# 不提供 C++ 风格的“朋友”关键字](https://stackoverflow.com/questions/203616/why-does-c-sharp-not-provide-the-c-style-friend-keyword/37238655#37238655)？事实上，关于你的问题也是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T12:30:41.073

我搜索了一下，发现[这篇](http://accu.org/index.php/journals/580)文章解释了如何使用私有接口为不同的客户端提供不同的接口。这是 C++ 的故事。

我认为这不能应用于 C#，因为 IMO 可以通过显式接口和将主机转换为适当接口的客户端来实现相同的效果。

也许其他人可以看到我在那里错过的东西......

我还在[MSDN](http://msdn.microsoft.com/en-us/library/ms182313(VS.80).aspx)上找到了这个：

> 接口方法具有公共可访问性，不能由实现类型更改。内部接口创建一个不打算在定义接口的程序集之外实现的协定。使用 virtual 修饰符实现内部接口方法的公共类型允许该方法被程序集外部的派生类型覆盖。如果定义程序集中的第二种类型调用该方法并期望一个仅限内部的协定，则当执行外部程序集中的重写方法时，行为可能会受到影响。这会产生安全漏洞。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T10:12:17.880

就像内部类（也是私有的）一样，您可以在现有类中使用私有接口。

# c# - 我的蜘蛛服务总是意外停止？

> ID：792916
> 
> 赞同：1
> 
> 时间：2009-04-27T10:03:38.260
> 
> 标签：c#, service

我有一项服务可以搜索我们的网站以获取大量数据。这需要大约 3 天（猜测因为它还没有成功运行整个方式！）在 5 个不同的线程上获取数据并将其放入数据库中。如果 WebClient.DownloadData 失败，则该错误会记录在数据库中并被忽略，但在昨天凌晨 3 点左右，服务在大约 2000 个失败的 Web 请求后停止。它们返回远程服务器 521 异常或操作超时。我也有一个意外的异常捕获，但它没有进入那里！我已经尝试修复这个错误好几个星期了，但是要让错误发生是一个漫长的过程！有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T10:34:24.660

我想你需要给我们更多的细节，还有一些代码片段，

我认为，根据您的描述，您有两个问题 - 一，网络请求开始失败并出现 521 错误，二，您的服务停止。

鉴于服务在大量 Web 请求失败后停止，我会查看某种资源耗尽 - 您是否内存不足？文件句柄？线程？还有什么？当 Web 请求失败时，您的应用程序会做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T12:58:26.873

对我来说听起来有点像内存泄漏，或者调用堆栈太深了，蜘蛛只是耗尽了资源。我遇到了这样的问题，即使用 SVD 构建非常大的多维数组来关联搜索词。

# sql - 仅在已发布的 ASP.NET 网站上出现“无法从指定的表中删除”错误

> ID：792918
> 
> 赞同：2
> 
> 时间：2009-04-27T10:04:13.563
> 
> 标签：sql, ms-access, asp.net-2.0

我写了一个简单的删除查询

```
delete from mails 
```

当我执行时，我没有遇到任何问题并且查询运行正常，但是当我发布网站时，我收到一条错误消息：

> “无法从指定的表中删除”

可能是什么问题？

放置在 IIS 中时出现此错误，但是当我通过 Visual Studio 在本地驱动器中运行它时，我没有收到此错误...请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:14:07.470

我怀疑发布网站会影响数据库代码的功能。您是否能够从数据库中获取数据，或者发布后没有数据库代码工作？

您是否尝试过关注此链接？我不确定它是否能解决您的问题，但值得一试！

[http://bytes.com/groups/asp/658763-could-not-delete-specified-tables](http://bytes.com/groups/asp/658763-could-not-delete-specified-tables)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T23:52:11.373

由于锁定文件 (.ldb)，用户必须对 Access 数据库所在目录具有读、写和删除权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T10:06:31.967

数据库是否具有正确的权限设置？您是否确认您能够连接到数据库？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T10:25:34.370

我会检查该数据源的 ConnectionString。检查文件是否在您指向的目录中可用。还要检查网络服务帐户是否有权更改该文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-06T11:54:19.737

好的，所以我们在 IIS 托管的 WCF 服务上遇到了这些确切的症状。

我们特别需要的是赋予 IIS 用户`IIS_IUSR`对包含数据库的父文件夹的修改和写入访问权限。在我们的案例中，它并没有默认拥有这些权利。

# xml - 你如何保护 Linq To Xml 中的空引用异常？

> ID：792919
> 
> 赞同：12
> 
> 时间：2009-04-27T10:04:28.023
> 
> 标签：xml, linq, exception-handling, linq-to-xml

```
<?xml version="1.0" encoding="utf-8" ?>
<pages> 
  <page id="56">
    <img id="teaser" src="img/teaser_company.png"></img>
  </page>  
</pages> 
```

我有一个 xml 文件，它为 cms 中的页面定义了额外的资源。使用 LinqToXml 查询此文件时，防止空引用异常的最佳方法是什么？

```
var page = (from tabElement in extensionsDoc.Descendants("page")
where tabElement.Attribute("id").Value == tabId.ToString()
select tabElement).SingleOrDefault(); 
```

如果页面元素没有名为“id”的属性，则此代码可能会触发空引用异常。我必须使用 try catch 块还是有办法处理这个？例如，如果页面元素没有名为“id”的属性，则为页面对象返回 null。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-27T10:11:21.567

编辑：这显然是很久以前写的 - 这些天我肯定会按照伊戈尔的回答与演员一起去。

最简单的方法是：

```
var page = (from tabElement in extensionsDoc.Descendants("page")
            let idAttribute = tabElement.Attribute("id")
            where idAttribute != null 
                  && idAttribute.Value == tabId.ToString()
            select tabElement).SingleOrDefault(); 
```

或者，您可以编写一个扩展方法`XElement`：

```
public static string AttributeValueOrDefault(this XElement element,
                                             string attributeName)
{
    XAttribute attr = element.Attribute(attributeName);
    return attr == null ? null : attr.Value;
} 
```

然后使用：

```
var page = (from element in extensionsDoc.Descendants("page")
            where element.AttributeValueOrDefault("id") == tabId.ToString()
            select element).SingleOrDefault(); 
```

或者使用点表示法：

```
var page = extensionsDoc.Descendants("page")
             .Where(x => x.AttributeValueOrDefault("id") == tabId.ToString())
             .SingleOrDefault(); 
```

`tabId.ToString()`（顺便说一句，事先调用一次而不是每次迭代都是有意义的。）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-01-25T04:34:27.173

在 .NET 4 LINQ to XML 中提供了一种方法来做到这一点，它是通过使用[显式强制转换](http://msdn.microsoft.com/en-us/library/bb339184.aspx)：

```
var page = (
  from tabElement in extensionsDoc.Descendants("page")
    where (string)tabElement.Attribute("id") == tabId.ToString()
    select tabElement
).SingleOrDefault(); 
```

如果该属性不存在，则结果将简单地为空。

除了显式`string`运算符之外，还有大多数原始类型及其可为 Nullable 的版本。这意味着您可以`AttributeOrDefault`使用这种语法：

```
//<element theAttr="12" />
int theAttr = (int?)doc.Element("element").Attribute("missingAttr") ?? 0; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-23T03:34:12.527

我以前也见过其他人也使用直接转换为字符串；我不知道它是否比 Jon 建议的效率更高或更低，但我非常喜欢这种语法。

```
var page = extensionsDoc.Descendants("page")
             .Where(x => (string)x.Attribute("id") == tabId.ToString())
             .SingleOrDefault(); 
```

如果我的想法有问题，任何人都可以随意解决；我对 LINQ 很陌生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-09T22:08:21.520

我倾向于使用 XPath 表达式，否则代码会因为大量的空检查而变得混乱。对于您的示例：

```
var query = string.Format("page[@id='{0}']", tabId.ToString());
var page = extensionsDoc.XPathSelectElement(query); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-28T16:03:25.817

我将使用映射 XML 元素的类实体。并调用一个检查空值的方法。我在我的代码中使用了这个方法，效果很好。希望能帮助到你。

这是一个示例代码，可根据您的需要进行调整：

```
private void Method1(...) {
    ...

    var pages = from tabElement in extensionsDoc.Descendants("page")
    where tabElement.Attribute("id").Value == tabId.ToString()
    select new Page {
                imgSrc = Method2(tabElement)
            };

    // pages variable is a List<Page> object
    ...
}

private void Method2(XElement element) {
    XElement img = element.Element("img");

    if (img != null) {
        ...
        // TODO return the imgSrc
        return "";
    }

    // return null or ""
    return null;
} 
```

然后页面类定义：

```
class Page
{
    public string imgSrc { get; set; }
} 
```

# android - 如何使用 Android 缓存视图并避免每次都调用 onCreate

> ID：792923
> 
> 赞同：6
> 
> 时间：2009-04-27T10:06:11.220
> 
> 标签：android, oncreate

我有一个让我很烦的问题。

对于 Android，我有一个应用程序，它似乎在`onCreate`每次创建活动的新实例时都在调用，因为这个活动是另一个活动的儿子，它在结束其对一条数据的角色时完成自己。

每次的调用`onCreate`似乎都是重新解析 XML 以创建视图并将侦听器重新附加/重新创建到代码等等。那么有没有一种方法可以缓存每次调用的活动，如果我们点击移动设备中的后退按钮而不会看到它？这就像将它真正隐藏起来（无法通过后退按钮访问）并且仅在必要时才销毁。

提前谢谢大家:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T16:22:49.360

Android 将处理大多数适用的视图和活动缓存，您不必担心。我强烈警告不要使用 alexkipar 的方法。这是非常幼稚的，只会降低性能，并造成内存泄漏和错误行为。

如果您觉得 Activity 的创建过于频繁，我建议您确保正确使用和理解 Activity 生命周期。与每个系统一样，Android 在效率和可重用性之间取得平衡，并且总是需要做出权衡。

您提到的一个常见误解涉及解析 XML。用于视图的 XML 不是作为纯 XML 存储的，而是为了提高效率而以编译的形式存储的。您不必担心这一点，相信系统正在努力使事情变得尽可能高效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T14:01:47.423

如果它被调用，则意味着您的进程已完成执行或被系统杀死。

`onCreate`每次您的活动开始时都会被调用。这就是[Activity 生命周期](http://developer.android.com/images/activity_lifecycle.png)的工作方式，在那里你无能为力。

如果您希望您的进程保留在内存中，那么您应该考虑将其实现为[Service](http://developer.android.com/reference/android/app/Service.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T06:49:06.413

您不能阻止 onCreate 在每次创建 Activity 时被调用，因为这是事情的工作方式。

您的问题更多是架构问题：您有一个经常使用的功能，但您将整个繁重的活动奉献给它。

如果您正在寻找速度和响应能力，答案可以是[ViewFlipper](http://developer.android.com/guide/samples/ApiDemos/src/com/example/android/apis/view/Animation2.html)。您定义了一个独特的活动，当您使用您的功能时，您只需更改视图。你的整个应用程序在一开始就被加载，然后它会留在内存中，直到 Dalvik 需要一些。您可以在开源应用程序[astrid](http://code.google.com/p/android-astrid/)的代码中找到一个非常复杂的示例。

# python - 我可以在 python 中编写我的应用程序，然后从 C 中运行它们吗？

> ID：792924
> 
> 赞同：0
> 
> 时间：2009-04-27T10:06:25.743
> 
> 标签：python, c, interop

我需要编写一个客户端-服务器应用程序。我想用python写，因为我对它很熟悉，但是我想知道python代码是否可以从C运行。我计划有两个C项目，一个包含服务器代码，一个包含服务器代码包含客户端代码。

是否可以评估 python 代码并运行它？还有另一种方法吗？

最重要的是，python 代码必须从 C 中运行，并且它的行为必须与在 python 解释器下运行时完全一样。我现在问这个，因为我不想浪费时间编写 python 代码只是为了以后发现我无法实现这个。作为旁注，我只打算使用基本的 Python 模块（socket、select 等）。

编辑：也许这个编辑是为了。我之前没有在 C 中嵌入 python，我不知道会是什么行为。问题是，服务器将有一个选择循环，因此将“永远”运行。C会让我这样做吗？

EDIT2：这就是我需要这样做的原因。在学校，一位老师要求我们用 C 语言做一个非常复杂的客户端-服务器应用程序。我打算作弊，用 python 编写代码并将其嵌入到 C 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T10:08:37.967

这是一个很好的教程，可以做到这一点[http://www.linuxjournal.com/article/8497](http://www.linuxjournal.com/article/8497)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T10:12:57.410

它被称为嵌入 Python——它在 Python 文档中得到了很好的介绍。请参阅[https://docs.python.org/extending/embedding.html](https://docs.python.org/extending/embedding.html)

看看[我如何在 C++ 中使用 python 库？](https://stackoverflow.com/questions/297112/how-do-i-use-python-libraries-in-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T10:12:28.130

是的，您可以通过在程序中嵌入解释器来从 C 运行 Python 代码。您可以将部分 C 代码公开给 Python，并从 Python 调用公开的 C 代码，就好像它们是普通的 Python 函数一样。

Python 文档中的[嵌入](http://docs.python.org/extending/embedding.html)部分是一个好的开始。另请查看cobbal[链接到的文章。](https://stackoverflow.com/questions/792924/can-i-write-my-apps-in-python-and-then-run-them-from-c/792935#792935)

# html - 如何摆脱 IE 中文本区域的垂直滚动条？

> ID：792927
> 
> 赞同：13
> 
> 时间：2009-04-27T10:06:37.647
> 
> 标签：html, css, textarea, scrollbar

在 IE 的 textarea 中有一个令人讨厌的右侧非活动滚动条，在 FF 中，textarea 是干净的。如何在 IE 中也让它变得干净？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-27T11:08:41.817

快速实验表明 IE6 和 IE8（目前无法测试 7）都支持溢出的 auto 值。因此，要使滚动条在必要时出现，但在不需要时隐藏，添加以下样式规则：

```
textarea { overflow: auto; } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T10:13:03.993

使用溢出：自动样式仅在需要时应用滚动条

```
textarea { overflow: auto; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-05T20:55:27.890

最初降落在这里，但建议的财产

```
textarea { overflow: auto; } 
```

对我不起作用，所以我检查了一个[类似的 SO question](https://stackoverflow.com/q/1210078/1000257 "如何在 IE8 中禁用 textareas 的默认滚动条？")并得到了一个很好[的答案](https://stackoverflow.com/a/1210102/1000257)

```
textarea { overflow-y: auto; } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-10T04:20:29.663

我们还可以使用删除 textarea 中的禁用滚动条。

```
textarea {
    overflow-y:auto;
} 
```

# c# - 当结构没有标识时，这意味着什么？

> ID：792936
> 
> 赞同：2
> 
> 时间：2009-04-27T10:09:03.070
> 
> 标签：c#

我在这里阅读了几个关于结构的线程（一个关于可变结构），并且我一直在阅读关于结构应该如何没有身份的内容。

结构中缺少身份到底是什么？我猜它就像一个数字，例如 5，没有上下文（5 什么？）。而客户将是期待服务的人，因此存在身份。我的想法正确吗？

我知道技术差异以及结构如何是线程安全的（只要它们不能被改变，但我仍然可以编写方法来改变状态），每次传递给方法时它们都有新的副本，等等......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T10:15:23.647

这意味着您拥有的关于结构的唯一数据是值是存储 - 一个“5”和另一个“5”之间没有区别。将此与一个类进行比较：

```
Person person1 = new Person("Jon");
Person person2 = new Person("Jon");
Person person3 = person2; 
```

现在`person1`并且`person2`有对不同对象的引用，尽管它们都包含相同的数据。`person2`并且`person3`两者都指代*相同*的对象。对于结构，这种区别不存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T10:14:50.277

struct 是一个值类型，所以它只是代表一个值。Id 仅对创建对它的引用有用，在这种情况下，最好成为一个类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T10:16:33.690

我猜你或多或少受到[Evans 的书的](https://rads.stackoverflow.com/amzn/click/com/0321125215)影响，他在书中区分了 Entity 和 Value 对象。

# .net - 在多个服务器上同步内容

> ID：792937
> 
> 赞同：1
> 
> 时间：2009-04-27T10:09:18.903
> 
> 标签：.net, windows, iis

我们有一个站点，它位于两个负载平衡的应用程序服务器（Win 2K3）上，其中包括一个 C#/ASP.NET 应用程序和一堆每天都在变化的静态内容。

我的问题是，保持静态内容同步的最佳方式是什么。在 Win2K8 中，我们可以将两台服务器都指向一个共享目录，但在 Win2K3 中则不行。

Site Server 中曾经有一些不错的功能可以做到这一点，但现在没有了。

理想情况下，该解决方案应该便宜且快速，并且不涉及重新测试整个应用程序（否则我们只需升级到 2K8）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T10:47:37.453

robocopy 实际上是一个非常好的解决方案，我们也用它来同步服务器上的静态内容。您可以安排它以适合您的任何时间间隔运行。

我们用于同步用户驱动的静态内容的另一件事是获取一个用于上传所有静态内容的中央 IP，并且 [在负载平衡环境中] 的所有服务器都为任何静态内容引用该中央 IP。使用这种方法，我们不必复制内容，使我们免于同步目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T10:28:06.673

您是否考虑过使用作为 Windows 资源工具包一部分的 robocopy。

这是维基百科的[链接](http://en.wikipedia.org/wiki/Robocopy)，其中包含更多示例说明。

也试试这个[链接](http://www.cyberciti.biz/tips/how-do-i-sync-data-between-two-load-balanced-windows-2003-servers.html)。

HTH。

# sharepoint - 计时器作业功能的范围

> ID：792938
> 
> 赞同：8
> 
> 时间：2009-04-27T10:09:22.710
> 
> 标签：sharepoint, moss, sharepoint-2007, timer-jobs

我是第一次写一个计时器作业。我正在关注可以通过谷歌搜索获得的示例作为我的参考。

在许多此类文章中，我遇到了被激活到站点集合级别或站点级别的计时器作业功能。

我觉得这很奇怪，因为特定 Web 应用程序只能有一个计时器作业实例。

不应该将所有计时器作业功能都限定为 Web 应用程序吗？

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T10:35:59.167

这完全取决于您的情况。到目前为止，我编写的计时器作业的范围是 Web 应用程序（只需修改您的 feature.xml）。但是，根据您的计时器作业的用途，从用户的角度来看，将其设置为 web 或站点范围可能是有意义的。您只需要让您的功能接收器知道在 Activated 等通知处理程序中传递的“父级”——它将是激活该功能的 SPWeb、SPSite 或 SPWebApplication——并且您可以节省自己的写作时间一个配置界面，只是为了让用户设置你的计时器作业应该使用哪些网站，哪些不应该使用。从技术上讲，您是正确的：它们始终在 Web 应用程序级别上运行。但由于他们经常处理与网站或网站相关的内容，

# c# - 正则表达式：匹配没有 > 或空格的短语

> ID：792944
> 
> 赞同：1
> 
> 时间：2009-04-27T10:11:04.407
> 
> 标签：c#, html, regex

我正在使用正则表达式解析一些 html，并且我想匹配以没有任何 html 标记的单词开头的行，同时还要删除空格。使用 c# regex 我的第一个模式是：

```
pattern = @"^\s*([^<])"; 
```

它试图抓取所有空白，然后捕获任何非“<”字符。不幸的是，如果该行在第一个 '<' 之前都是空白，这将返回 '<' 之前的最后一个空白字符。我希望这让比赛失败。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T10:16:31.570

不要使用正则表达式来解析 HTML。这是一个非常糟糕的主意，充其量，您的代码将是不稳定的。无论您的语言/平台是什么，您都将拥有一个功能齐全的 HTML 解析器。就用那个。

正则表达式无法正确处理转义、实体使用等所有情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T10:27:09.903

很快问了这个问题，刚刚解决了这个问题：

模式 = @"^\s*((?!\s)[^<]+)";

感谢您对 regex 和 html 的反馈，我会在未来记住它。我正在编写一个实用程序来制作几页多语言（即：为硬编码文本添加 asp:literals 等），我认为正则表达式足以达到此目的，但如果有更好的工具，请告诉我（网络的东西是'不是我的地区...）。

# jquery - 如何在页面加载时禁用 jquery 中的 show()？

> ID：792951
> 
> 赞同：1
> 
> 时间：2009-04-27T10:13:01.797
> 
> 标签：jquery

我想`show()` `"<div id="test">write text here</div"`点击而不是页面加载。

```
$(document).ready(function() {

  $("#click_test").stop(function(event) {
    event.preventDefault();
    $("#test").slideup();
  });

  $("#click_test").click(function(event) {
    event.preventDefault();
    $("#test").toggle();
  });

});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<a href="#" id="click_test">Click Here</a>
<div id="test">write text here</div>
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T10:18:18.413

添加 `$("#test").hide();` 你的javascript：

```
 <script type="text/javascript">
    $(document).ready(function(){
        $("#test").hide();

        $("#click_test").stop(function(event){
            event.preventDefault();
            $("#test").slideup();
        });

        $("#click_test").click(function(event){
            event.preventDefault();
            $("#test").toggle();
        });

    });
  </script> 
```

或者在您的 html 中：

```
<div id="test" style="display:none">write text here</div> 
```

给出相同的结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T10:19:09.690

最好的解决方案（恕我直言）是从一开始就隐藏它，而不是用 Javascript 来做。

至于链接，只需返回 false 以阻止浏览器转到 href。如果您希望链接切换 div，则将 show() 替换为 toggle()。您当然可以使用任何其他 jQuery 效果（例如幻灯片或淡入淡出）。

```
<style type="text/css">
#test { display: none; }
</style>
<script type="text/javascript">
$(function() {
  $("#click_text").click(function() {
    $("#test").show();
    return false;
  });
});
</script>
<a href="#" id="click_test">Click Here</a>
<div id="test">write text here</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T10:51:37.397

你应该使用：

```
<div id="test" style="display:none">write text here</div> 
```

注意：在这种情况下，对于禁用了 javascript 的浏览器，该 div 将保持隐藏状态。
如果您希望这些浏览器看到 div，请改用：

```
$(function() {
    $("#test").hide();
}); 
```

# java - 为什么理解 Java 中引用类型和原始类型之间的区别很重要？

> ID：792965
> 
> 赞同：0
> 
> 时间：2009-04-27T10:17:00.273
> 
> 标签：java, types

我正在关注 Java 中的一系列问题，如果不先了解其中的区别，这些问题就无法正确理解。

例如：

*   将参数传递给方法
*   确切地说，在变量声明上使用“final”会施加什么限制。
*   == 是什么意思

还有吗？

**编辑：**这个问题对人们来说似乎没有意义。其背后的动机是，我作为初学者学习 Java 的经验是，例如：

```
int i = 1; 
```

和

```
Set<Thing> set = new Set<Thing>(); 
```

*不明显*。_ 现在我知道，一旦你拿起了 Java，你就会认为它是理所当然的，不会去想它，但我坚持认为这是初学者很难解决的问题，尤其是如果他们没有编程背景的话。我认为这是在教授 Java 时经常需要解决的问题。

**编辑：**还是不行。随意关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T10:51:29.113

我认为最重要的一点是要了解 Java 中的引用不包含对象本身，而只包含实际对象本身的地址（或指针或任何你想调用的东西）。因此，至关重要的是要了解您始终拥有两件事：

1.  **引用**（存储在变量中）
2.  **对象**（不能存储在变量中 - 仅由引用引用）

如果你理解了这个关键概念，那么像 == 这样的东西就很容易理解了，因为现在你知道你只是在比较引用而不是对象。

总结：在教授如何使用对象之前，先解释一下对象和它的引用之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T11:04:03.233

我认为您的问题是 - 如果您要向某人解释 Java 功能，那么为了更好地解释，您需要将其与其他功能进行比较。

例如，

== VS .equals()

这样我觉得——

*   静态与非静态
*   接口与类
*   同步与非同步

这是你要找的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T12:54:21.080

我同意 Benedikt Eger 的观点，即引用和对象之间的关系是需要理解的最重要的概念。

对于您的问题列表：“=”运算符有时会引起人们的困惑，因为对于初学者来说，它似乎是“复制”原语但“共享”对象。这在 Java 中比在 C++ 中的问题要小得多，因为“=”**永远不会**复制对象（Java 不会将对象放入堆栈）。但是，我已经看到“=”使初学者绊倒，尤其是当他们认为“=”会创建数组的重复副本时。

# javascript - 样式输入文件和自动提交

> ID：792971
> 
> 赞同：5
> 
> 时间：2009-04-27T10:19:00.843
> 
> 标签：javascript, jquery, css

我试图有一个用户单击的单个文本链接，它会询问用户他/她想要上传哪个文件，然后自动将其发布到表单。我怎样才能达到同样的效果？我知道我必须设置我的文件输入的样式，但是如何让它在文件选择时自动发布？

非常感谢你

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-27T15:29:01.427

在页面中嵌入 javascript 是[不好的做法](http://www.smashingmagazine.com/2008/09/16/jquery-examples-and-best-practices/)。

使用选择器将提交添加到项目。这也使您能够按照您的要求将功能添加到基本链接。

**HTML**

```
<form id="myForm">
    <a id="uploadLink" href="#">Upload file</a>
</form> 
```

**jQuery**

```
$(document).ready(function() {
    $("#uploadLink").click(function() {
        $("#myForm").submit();
    }
}); 
```

## 附加资源

这是[jQuery 表单插件](http://malsup.com/jquery/form/)的链接。

还有一个[用于 jQuery 的多文件上传插件](http://jquery-multifile-plugin.googlecode.com/svn/trunk/index.html)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-27T10:24:03.470

您可以调用表单的提交方法。它会将您的页面提交到服务器，您可以在请求的 Files 集合中获取文件。

您必须在“file”元素的“onchange”事件上调用表单的 submit() 方法。

```
<input type="file" onchange="formname.submit();" id="f" /> 
```

编辑：[试试这个。](http://www.shauninman.com/archive/2007/09/10/styling_file_inputs_with_css_and_the_dom)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T13:55:17.667

好的，jQuery 可能并不总是答案，但我目前正在滥用它 - 主要用于选择器和实时内容 - 无论如何使用 jQuery，您的问题的最佳解决方案如下：

```
$('input[type:"file"]').live('change',function(){
    $(this).parents('form').submit();
}); 
```

这基本上使任何输入类型文件自动提交它的父表单 - 有点矫枉过正，您可以通过将输入类型文件选择器更改为您选择的类来轻松限制这一点。

你也可以通过不使用 live 来使它更轻（我这样做是因为我动态使用它）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-03T18:02:31.253

使用 JQuery 1.7+ 版本：

```
 //wait for an file input to change anywhere in the document
    $(document).on('change', 'input[type="file"]', function () { 
        $(this).parents('form').submit(); //then submit its parent form
    }); 
```

# java - 保存到数据库之前如何在 JSP 中转义 html？

> ID：792974
> 
> 赞同：2
> 
> 时间：2009-04-27T10:21:09.013
> 
> 标签：java, database, jsp, escaping

我目前正在学习 JSP 和 Java，并写了一个（非常）简单的留言簿来开始使用 JSP。但我想确保没有人可以使用 CSS，所以我需要先剥离 HTML 代码，然后再将其保存到我的 mySQL 数据库中。我已经在这里搜索并找到了“

```
 PreparedStatement pStmt = conn.prepareStatement("INSERT INTO test VALUES (ID, ?, ?)");

  pStmt.setString(1, request.getParameter("sender"));
  pStmt.setString(2, request.getParameter("text"));
  pStmt.executeUpdate(); 
```

那么这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T10:28:04.100

简短的回答：看看[org.apache.commons.lang.StringEscapeUtils.escapeHtml()](http://commons.apache.org/lang/api/org/apache/commons/lang/StringEscapeUtils.html#escapeHtml(java.lang.String))。

更详细的答案：转义 HTML 是演示代码的工作，而不是数据库代码。如果出于某种原因，您想在非 Web 环境（例如经典 GUI）中的某个时间点显示数据怎么办？您将不得不对整个事物进行转义，否则它将显示全部垃圾。

只需按原样保存数据，并确保在显示*之前逃避**从*用户那里获得的所有内容（好吧，也许不是存储为数字的数字，但你明白了）。

 *如果你使用 AJAX，你可以更进一步，只在 JavaScript 中转义你的字符串（或使用 innerText）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T10:27:36.910

通常的做法是相反的。我们保存 , 中的任何内容`textarea`，并在显示时使用标签`escapeXML`的属性。`<c:out>`这样所有的 CSS、HTML 标签都将被视为简单的文本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-24T18:15:30.563

您还可以使用 JSTL 函数：fn:escapeXml()。

```
 <%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
 ...   
 <input type="hidden" name="htmlCode" value="${fn:escapeXml(htmlCode)}"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T10:25:36.227

出于安全目的，您需要对 HTML 进行转义，例如防止跨站点脚本攻击 (XSS)。

在 Google/Stack Overflow 上搜索跨站点脚本以获取更多详细信息。

将有几个开源的 Servet 过滤器可以为你做这件事。

例如看[这里](http://weblogs.java.net/blog/gmurray71/archive/2006/09/preventing_cros.html)的解释

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-24T03:07:46.830

您还可以使用 JSTL 核心库。

c:out 默认开启了 escapeXml。

例子：

```
<c:out value="${tp.title}" />

<c:out value="${product.listPrice}" escapeXml="false" /> //if you want turn off 
```

这种方法让您可以按照其他人的建议在表示层中进行转义。

# c# - 如何将 XML 读入与其 xsd 匹配的类/类

> ID：792976
> 
> 赞同：14
> 
> 时间：2009-04-27T10:21:46.377
> 
> 标签：c#, .net, xml, xsd, xsd.exe

所以我有一个 XSD 和一个以相同格式提供的 Web 服务。

现在我可以继续将 xml 读入文档，从类中创建我的对象等......但我在想，必须有一些更简单的方法来做到这一点。

我对吗？;)

*   [雅虎地图 GeocodeResponse XSD](http://api.local.yahoo.com/MapsService/V1/GeocodeResponse.xsd)
*   [Yahoo Maps GeocodeResponse 示例](http://local.yahooapis.com/MapsService/V1/geocode?appid=YD-9G7bey8_JXxQP6rxl.fBFGgCdNjoDMACQA--&street=One%20Microsoft%20way1&city=redmond&state=washington "雅虎地理编码响应")

 `````
<ResultSet xsi:schemaLocation="urn:yahoo:maps http://api.local.yahoo.com/MapsService/V1/GeocodeResponse.xsd">
 <Result precision="address">
  <Latitude>47.643727</Latitude>
  <Longitude>-122.130474</Longitude>
  <Address>1 Microsoft Way, #Way1</Address>
  <City>Redmond</City>
  <State>WA</State>
  <Zip>98052-6399</Zip>
  <Country>US</Country>
 </Result>
</ResultSet> 
````  `下面是使用[xsd.exe自动生成的类（实际上是两个）](https://stackoverflow.com/questions/87621/how-do-i-map-xml-to-c-objects)

[![类图](https://i.stack.imgur.com/KeUAz.png)](https://i.stack.imgur.com/KeUAz.png)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-27T10:50:12.423

您可以使用[XmlSerializer将 XML 文本反序列化为](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer_methods.aspx)**xsd.exe**生成的类的实例。
XmlSerializer 将使用放置在生成的类上的**元数据属性**在 XML 元素和对象之间来回映射。

```
string xmlSource = "<ResultSet><Result precision=\"address\"><Latitude>47.643727</Latitude></Result></ResultSet>";

XmlSerializer serializer = new XmlSerializer(typeof(ResultSet));
ResultSet output;

using (StringReader reader = new StringReader(xmlSource))
{
    output = (ResultSet)serializer.Deserialize(reader);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T10:23:49.273

您可以从 XSD 创建一个 Typed DataSet，然后用 XML 填充其中一个对象。这是很常见的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T09:42:01.377

Liquid XML Studio 中的[XSD 代码生成器](http://www.liquid-technologies.com/XmlStudio/Xml-Data-Binder.aspx)在从 XML 模式创建高度兼容的 c# 或 vb.net 代码方面做得很好。然后，此代码可用于调用或实现 Web 服务。

如果您实现 Web 服务，那么您可以控制使用 XmlSchemaProvider 和 IXmlSerializable 生成的 WSDL，请参阅[控制您的 WSDL](http://xml-tricks-and-tips.blogspot.com/2009/01/take-control-of-your-wsdl.html)

# c# - TransactionScope 超时怪异与 TransactionScopeOption.RequiresNew

> ID：792977
> 
> 赞同：3
> 
> 时间：2009-04-27T10:22:00.307
> 
> 标签：c#, transactionscope

这里发生了一些非常奇怪的事情。

我刚刚在我正在调试的一些遗留代码周围添加了一个事务范围，以确保我正在做的摆弄不会被提交。

这工作了两次，然后说：

```
"The transaction manager has disabled its support for remote/network transactions." 
```

在工作/非工作之间没有任何代码更改或重建（字面意思是连续 3 个 F5 [网络应用程序]）。这是连接到删除数据库服务器的本地代码。

因此，不同项目中完全独立的代码会超时。如果我从此代码中删除 transactionScopes，它运行良好，但在它们到位时它会超时。我已经尝试过我的本地 SQL 服务器和远程服务器，它们都在事务范围内超时。

这到底是怎么回事？

编辑：我发现将我的 TransactionScopes 更改为：

```
using (var scope = new TransactionScope(TransactionScopeOption.RequiresNew)) 
```

至

```
using (var scope = new TransactionScope()) 
```

防止问题：s

这是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-03T14:37:13.277

和...之间的不同：

```
using (var scope = new TransactionScope(TransactionScopeOption.RequiresNew)) 
```

和

```
using (var scope = new TransactionScope()) 
```

是第二个重用现有（环境）事务，而第一个在旧事务中创建新事务。

事务中的这个事务需要分布式事务协调器。

那么您的错误有三个可能的原因：

*   MSDTC 未运行
*   您的数据库位于另一台计算机上，并且 Windows 配置为不允许来自网络的事务。
*   您的数据库位于另一台计算机上，并且 SQL 服务器配置为不允许来自网络的事务

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T12:18:05.083

我相信当错误发生时，框架正试图将原来的“轻量级”（即 DBMS）事务提升为“分布式”事务。管理分布式事务的 MSDTC（分布式事务协调器）服务要么未运行，要么无法工作。

这通常发生在一个逻辑事务跨越两个（或多个）数据库连接时。当然，在您的情况下，（显然）只有一个 DBMS 连接。我猜测通过强制一个新的、独立的事务范围，你也强制框架使用分布式事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-01T17:24:18.050

老问题，但我有同样的问题，所以这里有简单的信息来解决许多问题。

如果您可以更改 from`TransactionScopeOption.RequiresNew`以`TransactionScopeOption.Required` **检查您是否真的需要显式嵌套事务的行为并考虑通过阅读**[此 MSDN 文章](https://msdn.microsoft.com/en-us/library/ms172152%28v=vs.90%29.aspx#Y1642)显式设置事务范围的类型。可能您的问题是具有锁定资源的新事务的数量，这就是问题“奇怪”的原因。

此外，您应该检查以下信息：

**[默认事务范围被认为是有害的](http://blogs.msdn.com/b/dbrowne/archive/2010/05/21/using-new-transactionscope-considered-harmful.aspx)**

```
using (var scope = new TransactionScope(TransactionScopeOption.RequiresNew)) 
```

默认情况下，您设置：

1.  IsolationLevel as Serializable（考虑使用`IsolationLevel.ReadCommitted`）
2.  TimeOut 到一分钟（考虑使用`TransactionManager.MaximumTimeout`）

使用这两个选项，`TransactionScopeOption.RequiresNew`您应该会遇到死锁。

这里是新代码：

```
new TransactionScope(TransactionScopeOption.Required, 
    new TransactionOptions 
    {
        IsolationLevel = IsolationLevel.ReadCommitted,
        Timeout = TransactionManager.MaximumTimeout
    }
) 
```

# c# - jQuery 选项卡回发

> ID：792994
> 
> 赞同：1
> 
> 时间：2009-04-27T10:31:22.080
> 
> 标签：c#, asp.net, javascript, jquery, user-interface

我正在使用带有 asp.net 的 jQuery 远程选项卡来加载我的 .aspx 页面。问题是，如果假设我有一个名为“Parent.aspx”的主页，其中包含 jQuery 选项卡和通过加载的子页面“Page1.aspx”远程选项卡进入“Parent.aspx”。当我单击 Page1.aspx 上的服务器端按钮时，整个窗口重定向到 Page1.aspx。我希望它保留在 Paernt.aspx 本身上。

我的代码：

```
$(function() {
  $('#divEmployee').tabs(1, { remote: true });
}); 
```

我应该为此添加一些东西，以实现上述功能

请帮忙。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T15:08:26.920

[直接来自jQuery Tabs](http://docs.jquery.com/UI/Tabs "jQuery 选项卡")文档的 how to 部分。

在当前选项卡中打开链接而不是离开页面

```
$('#example').tabs({
    load: function(event, ui) {
        $('a', ui.panel).click(function() {
            $(ui.panel).load(this.href);
            return false;
        });
    }
}); 
```

# .net - .NET 中分离项目/DLL 的优缺点？其中有多少是太多了？

> ID：792995
> 
> 赞同：9
> 
> 时间：2009-04-27T10:31:22.890
> 
> 标签：.net, dll, projects-and-solutions

这个问题涉及一些其他相关的问题，我只是把每一个问题都扔在上面，随意回答一个或多个。

*   分离 Projects/DLL 有什么好处？
*   分离 Projects/DLL 的缺点是什么？
*   如果我为每个可共享资源创建一个新的解决方案/DLL，会不会有很多项目？
*   在过多的项目（如 40 多个）之后，这会对 IDE 性能（VS.NET 2008）产生一些不良影响吗？

我问这个问题是因为我有这么多不同类的大解决方案，因为现在我需要分离一些接口，它都分崩离析（**循环依赖**问题），现在我需要创建多个 DLL，我只想这次一定要以正确的方式进行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T11:41:07.810

关于论点的范围，这个问题的答案可能很长，我认为首先最好关注什么是 choiches 以及需要在多个程序集中分离**项目**的原因，一般来说，这可能是一般设计和分层和/或清理项目结构。

**1.分离Solutions/DLL有什么好处？**

分离解决方案和组件的优势通常与设计方法、代码重用和层组织有关，如上所述，分离解决方案有助于共享对象/组件并在层之间分配责任，促进多目标和可插拔解决方案（参见例如各种存储目标程序集（数据库、文件等））、可测试性

**2\. 分离Solutions/DLL有什么缺点？**

正如其他人在我之前所说的那样，主要缺点首先是复杂性（管理，维护），然后是性能（但这是另一个讨论，说起来并不容易）

**3\. 如果我为每个可共享的资源创建一个新的解决方案/DLL 会不会有很多解决方案？**

这取决于，首先我认为这可能取决于设计选择

**4\. 在解决方案过多（如 40+）之后，这会对 IDE 性能（VS.NET 2008）产生一些不良影响吗？**

我不太确定 VS2008 IDE 中的性能下降，但可以肯定的是，管理 60 多个项目的单个解决方案可能会影响性能，而不是管理 60 个项目的单个解决方案，例如每个有 20 个项目的 4 个解决方案。必须清楚的是，VS IDE 性能可能会下降即使在仅从单个或双项目解决方案中打开例如 35 个文件之后..

最后，我认为我要记住的重要一点是，最好“构建”它真正需要的东西，而不是陷入过度设计，所以当事情变得太复杂而无法管理（对于许多项目）时，它会更好停下来想“一切顺利？”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T12:03:16.053

## 好处

*   目的明确。
*   能够替换一个 dll 并让应用程序的其余部分像以前一样工作。
*   可重用性（尽管这确实经常被高估*）。

## 缺点

*   工作困难（仅在 7 个项目之间切换可能会很痛苦）。
*   可能出现新类型的依赖问题（项目 A 可以引用项目 B，反之亦然，但不能同时引用两者）
*   需要部署大量 DLL。

* * *

一般来说，我建议使用至少一个 DLL（将业务逻辑与 UI 分开），如果您的应用程序版本不同，可能不需要所有这些代码，则建议使用更多。

* * *

*我们经常让自己相信我们会重用那个美妙的 Order 类。我们可能不会。领域模型只是倾向于不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T10:39:16.303

许多 dll 的主要缺点是：

*   复杂性（要管理和部署的 dll 的绝对数量）
*   “融合”的性能（可以使用 ILMerge 降低）

优点是更多的分离 - 但实际上您可以在单个（或几个）dll 中实现相同（或相似）的分离。

* * *

关于循环依赖的问题 - 你也许应该看看“依赖注入”和“控制反转”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T10:37:17.790

一般来说，只要代码中存在逻辑上的依赖关系分离，就应该进行分离。例如，如果您正在构建一套相关的小型应用程序，它们都依赖于一个共同的核心，那么拥有一个包含核心类的库并为每个此类应用程序一个库是有意义的。这是一个反映这种分离的简单依赖图：

```
 +------------> Core <------------+
         |               ^                |
         |               |                |
   Level Builder         |           Game Server
         ^               |
         |               |
         +-----------Game Client 
```

最后，.NET 除了通过条件编译外，没有很好的方法来获得纯测试代码依赖项，因此将各种测试放在单独的库中也是一个好主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T11:38:45.600

我一直在与您的问题相反 - 太多的 dll 和依赖项。

我不知道答案，但这里有一些问题可能会给你一些有用的指示。

[在 C# 中构建大型 winforms 应用程序的项目和依赖项](https://stackoverflow.com/questions/152053/structuring-projects-dependencies-of-large-winforms-applications-in-c)
[在 Visual Studio 中卸载项目时，您如何处理引用？](https://stackoverflow.com/questions/177338/what-do-you-do-about-references-when-unloading-a-project-in-visual-studio)

请注意，您可以在同一个 dll 中拥有不同的名称空间（相反，您可以将名称空间分布在多个 dll 上）。

对于我的解决方案-with-lots-of-projects，我目前有一个设置，其中我有一个名为“WorkingSetOnly”的自定义构建配置（单击调试/发布组合并选择配置管理器），我可以在其中选择编译或不编译运行中的每个项目——这使得运行更快，但保留了智能感知、goto 定义等。我还使用解决方案文件夹将项目组织成两个“桶”——WorkingSet 和其他，尽管我还没有找到链接两者的方法（配置和文件夹）自动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T11:52:06.690

循环依赖问题意味着：

```
[Lib1]

[Project1]
  [ClassA]

[Project2]
  [ClassB] 
```

如果 ClassA 和 ClassB 相互引用，则应将它们拉出到 Lib1 并让 Project1 和 Project2 引用 Lib1，因为不这样做很难保持 Project1 和 2 同步。

这并不意味着疯狂，我相信 IDE 性能不会是一个大问题。如果您有 40 多个项目，则存在设计问题。

# javascript - 从 XSL 文件调用 Javascript

> ID：792997
> 
> 赞同：1
> 
> 时间：2009-04-27T10:32:00.500
> 
> 标签：javascript

我有一个 XML 文件......

```
<ROOT>
      <MYNODES>
           <MYNODE>A</MYNODE>
           <MYNODE>B</MYNODE>
           <MYNODE>C</MYNODE>
           <MYNODE>D</MYNODE>
      </MYNODES> 
      <DOCS>
           <DOC>1</DOC>
           <DOC>2</DOC>
           <DOC>3</DOC>
      </DOC> 
      <PICS>
           <PIC>a.jpeg</PIC>
           <PIC>b.jpeg</PIC>
           <PIC>c.jpeg</PIC>
           <PIC>d.jpeg</PIC>
           <PIC>e.jpeg</PIC>
          </PICS>
  </ROOT> 
```

并遵循 XSLT 文件.....

```
<?xml version="1.0"?>

<xsl:stylesheet xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">

<xsl:output method="xml" version="1.0" doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN" doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"/>

<xsl:template match="/ROOT">
    <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
        <head>
            <title>JINI  <xsl:value-of select="/ROOT/MYNODES/MYNODE/." /> </title>
        <link rel="stylesheet" type="text/css" href="jini.css" />
        <script language="JavaScript" src="commonHead.js" type="text/javascript" />
        </head>
    <body>

<table style="font-size:11px" border="5" bgcolor="#FFFFFF" width="99%" align="center" cellpadding="5">
<tr>
<td>
<xsl:attribute  name="bgcolor"> #FFAAAA </xsl:attribute> <xsl:attribute  name="onMouseover" >displayColor(event, 'blue') </xsl:attribute> <xsl:attribute  name="onMouseout"> backToOriginal(event, 'yellow') </xsl:attribute> AA</td>
<td>BB </td>
</tr>
</table>
</body>
</html>
</xsl:stylesheet> 
```

但是我的 displayColor 在浏览器中不起作用......任何线索......如何在 XSL 文件中调用 java 脚本文件的外部函数......

我的 Javascript 文件是

```
 /***********************************************
   * Highlight Table Cells Script- © Dynamic Drive DHTML code library (www.dynamicdrive.com)
   * Visit http://www.dynamicDrive.com for hundreds of DHTML scripts
   * This notice must stay intact for legal use
   ***********************************************/

   // Specify the default location for flying widget
   var xpos = -10;
   var ypos = 20;

   //Specify highlight behavior. "TD" to highlight table cells, "TR" to highlight the entire row:
   var highlightbehavior="TD"

   var ns6=document.getElementById&&!document.all
   var ie=document.all

   function displayColor(event, color){
     /* Popup is integrated within changeto */
     changeto(event, color,0,"");
   }

   function displayColorAndInfos(event, color, line){
     /* Popup is integrated within changeto */
     changeto(event, color,1,line);
   }

   function backToOriginal(event, color) {
     /* Killlink is integrated within changeback */
     changeback(event, color);
   }

   function changeto(e,highlightcolor,flag,line){
   source=ie? event.srcElement : e.target
   if (source.tagName=="TABLE")
   return
   while(source.tagName!=highlightbehavior && source.tagName!="HTML")
   source=ns6? source.parentNode : source.parentElement
   if (source.style.backgroundColor!=highlightcolor&&source.id!="ignore"){
      source.style.backgroundColor=highlightcolor
      if (flag==1) {
    poplink(line,-500,5);
    }
      }
   }

   function contains_ns6(master, slave) { //check if slave is contained by master
   while (slave.parentNode)
   if ((slave = slave.parentNode) == master)
   return true;
   return false;
   }

   function changeback(e,originalcolor){
   if (ie&&(event.fromElement.contains(event.toElement)||source.contains(event.toElement)||source.id=="ignore")||source.tagName=="TABLE")
   return
   else if (ns6&&(contains_ns6(source, e.relatedTarget)||source.id=="ignore"))
   return
   if (ie&&event.toElement!=source||ns6&&e.relatedTarget!=source) {
      source.style.backgroundColor=originalcolor
      killlink();
      }
   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T10:34:58.513

您尚未关闭`<script>`标签 - 您需要：

```
<script src="commonHead.js" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T11:09:34.217

您发布的 XML 和 XSLT 存在一些不一致之处。

请尝试以下操作（**请注意脚本标记内插入的空白，以避免节点被 XSLT 引擎折叠**）：

### XSLT：

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">

  <xsl:output method="html" version="1.0" doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN" doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"/>

  <xsl:template match="/ROOT">

    <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
      <head>
        <title>
          JINI <xsl:value-of select="/ROOT/MYNODES/MYNODE/." />
        </title>
        <link rel="stylesheet" type="text/css" href="jini.css" />
        <script src="commonHead.js" type="text/javascript" >
            <xsl:text> </xsl:text>
        </script>
      </head>
      <body>
        <table style="font-size:11px" border="5" bgcolor="#FFFFFF" width="99%" align="center" cellpadding="5">
          <tr>
            <td bgcolor="#FFAAAA" onMouseover="displayColor(event, 'blue');" onMouseout="backToOriginal(event, 'yellow');">
              AA
            </td>
            <td>BB </td>
          </tr>
        </table>
      </body>
    </html>
  </xsl:template>
</xsl:stylesheet> 
```

### XML 输入文件：

```
<?xml version="1.0" encoding="utf-8"?>
<ROOT>
  <MYNODES>
    <MYNODE>A</MYNODE>
    <MYNODE>B</MYNODE>
    <MYNODE>C</MYNODE>
    <MYNODE>D</MYNODE>
  </MYNODES>
  <DOCS>
    <DOC>1</DOC>
    <DOC>2</DOC>
    <DOC>3</DOC>
  </DOCS>
  <PICS>
    <PIC>a.jpeg</PIC>
    <PIC>b.jpeg</PIC>
    <PIC>c.jpeg</PIC>
    <PIC>d.jpeg</PIC>
    <PIC>e.jpeg</PIC>
  </PICS>
</ROOT> 
```

由于您没有提供 JavaScript 代码，因此无法查看脚本中是否存在问题。否则，上述输入/XSLT 应该一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T10:47:18.407

您还没有关闭`<ROOT>`XML 文件中的标记：

```
<ROOT>
  <MYNODES>
       <MYNODE>A</MYNODE>
       <MYNODE>B</MYNODE>
       <MYNODE>C</MYNODE>
       <MYNODE>D</MYNODE>
  </MYNODES> 
  <DOCS>
       <DOC>1</DOC>
       <DOC>2</DOC>
       <DOC>3</DOC>
  </DOC> 
  <PICS>
       <PIC>a.jpeg</PIC>
       <PIC>b.jpeg</PIC>
       <PIC>c.jpeg</PIC>
       <PIC>d.jpeg</PIC>
       <PIC>e.jpeg</PIC>
  </PICS>
</ROOT> 
```

# .net - 使用ajax处理www-authentication请求？

> ID：792999
> 
> 赞同：5
> 
> 时间：2009-04-27T10:32:34.527
> 
> 标签：.net, ajax, authentication

是否可以使用 AJAX 将凭据传递给请求 www-authentication 的网络服务器？

我想登录到使用 .NET Bsic www-authentication 的网站，并使用 ajax 传递凭据。使用浏览器访问服务器时，浏览器会通过身份验证/登录窗口提示用户。

html 标头包含以下内容：

```
WWW-Authenticate: Basic
realm="hosting.xp"
MicrosoftSharePointTeamServices: 6.0.2.6568
X-Powered-By: ASP.NET 
```

我想通过从 ajax 对象调用它来访问“幕后”网站，但我不确定如何处理请求身份验证的 http 标头。

我希望 ajax 调用导致特定用户登录（cookie 集），以便用户稍后可以访问该站点并“已经”登录。

这可以按照我在这里描述的方式完成吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T19:20:16.720

您可以像这样在 URL 中传递用户名和密码：

[http://username:password@example.com/secure](http://username:password@example.com/secure)

这是一个使用 jQuery 的例子：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $('a.logMeIn').click(function(){
        $.get('http://username:password@example.com/secure', null, function(response) {
            alert(response);
        });
    });
});

</script>

<a href="#" class="logMeIn">Log me in!</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:09:37.163

使用 http-authentication 不需要 cookie，凭据由浏览器保存，或者在您的初始请求的情况下，由您的 javascript 状态保存。``*******~~******