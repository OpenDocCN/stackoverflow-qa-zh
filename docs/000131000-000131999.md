# StackOverflow 问答 000131000-000131999

# sql - 列出所有具有 2 列子行重复的行的 SQL 查询是什么？

> ID：131014
> 
> 赞同：4
> 
> 时间：2008-09-25T01:33:57.090
> 
> 标签：sql, database, platform-agnostic

我有一个包含冗余数据的表，我正在尝试识别所有具有重复子行的行（因为没有更好的词）。通过子行，我的意思是考虑`COL1`并且`COL2`只考虑。

所以假设我有这样的事情：

```
 COL1   COL2   COL3
 ---------------------
 aa     111    blah_x
 aa     111    blah_j
 aa     112    blah_m
 ab     111    blah_s
 bb     112    blah_d
 bb     112    blah_d
 cc     112    blah_w
 cc     113    blah_p 
```

我需要一个返回这个的 SQL 查询：

```
 COL1   COL2   COL3
 ---------------------
 aa     111    blah_x
 aa     111    blah_j
 bb     112    blah_d
 bb     112    blah_d 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T01:40:43.843

这对你有用吗？

```
select t.* from table t
left join ( select col1, col2, count(*) as count from table group by col1, col2 ) c on t.col1=c.col1 and t.col2=c.col2
where c.count > 1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T01:40:02.833

使用您列出的数据，您的查询是不可能的。第 5 行和第 6 行的数据本身并没有区别。

假设您的表名为“quux”，如果您从以下内容开始：

```
SELECT a.COL1, a.COL2, a.COL3 
FROM quux a, quux b
WHERE a.COL1 = b.COL1 AND a.COL2 = b.COL2 AND a.COL3 <> b.COL3
ORDER BY a.COL1, a.COL2 
```

你最终会得到这个答案：

```
 COL1   COL2   COL3
 ---------------------
 aa     111    blah_x
 aa     111    blah_j 
```

这是因为第 5 行和第 6 行的 COL3 值相同。任何同时返回第 5 行和第 6 行的查询也将返回此数据集中所有行的重复项。

另一方面，如果你有一个主键 (ID)，那么你可以使用这个查询来代替：

```
SELECT a.COL1, a.COL2, a.COL3
FROM quux a, quux b
WHERE a.COL1 = b.COL1 AND a.COL2 = b.COL2 AND a.ID <> b.ID
ORDER BY a.COL1, a.COL2 
```

*[编辑以简化 WHERE 子句]*

你会得到你想要的结果：

```
COL1   COL2   COL3
---------------------
aa     111    blah_x
aa     111    blah_j
bb     112    blah_d
bb     112    blah_d 
```

我刚刚在 SQL Server 2000 上对此进行了测试，但是您应该在任何现代 SQL 数据库上看到相同的结果。

**[blorgbeard](https://stackoverflow.com/users/369/blorgbeard)证明我[错了](https://stackoverflow.com/questions/131014/whats-the-sql-query-to-list-all-rows-that-have-2-column-sub-rows-as-duplicates#131036)——对他有好处！**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T01:35:57.350

像这样加入自己：

```
SELECT a.col3, b.col3, a.col1, a.col2 
FROM tablename a, tablename b
WHERE a.col1 = b.col1 AND a.col2 = b.col2 AND a.col3 != b.col3 
```

如果您使用的是 postgresql，则可以使用 oid 使其返回较少重复的结果，如下所示：

```
SELECT a.col3, b.col3, a.col1, a.col2 
FROM tablename a, tablename b
WHERE a.col1 = b.col1 AND a.col2 = b.col2 AND a.col3 != b.col3
  AND a.oid < b.oid 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T01:37:40.123

没有方便的数据库来测试这个，但我认为它应该可以工作......

```
select
  *
from
  theTable
where
  col1 in
    (
    select
      col1
    from
      theTable
    group by
      col1||col2
    having
      count(col1||col2) > 1
    ) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T01:38:39.060

我天真的尝试是

```
select a.*, b.* from table a, table b where a.col1 = b.col1 and a.col2 = b.col2 and a.col3 != b.col3; 
```

但这将返回所有行两次。我不确定您如何将其限制为仅退回一次。也许如果有一个主键，你可以添加“and a.pkey < b.pkey”。

就像我说的那样，这并不优雅，可能有更好的方法来做到这一点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-25T01:43:11.530

像这样的东西应该工作：

```
SELECT a.COL1, a.COL2, a.COL3
FROM YourTable a
JOIN YourTable b ON b.COL1 = a.COL1 AND b.COL2 = a.COL2 AND b.COL3 <> a.COL3 
```

通常，JOIN 子句应包括您认为属于“重复”的每一列（在本例中为 COL1 和 COL2），以及至少一列（或尽可能多的列）以消除行连接到它自己（在这种情况下是 COL3）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T01:48:08.460

这与自连接非常相似，只是它没有重复项。

```
select COL1,COL2,COL3
from theTable a
where exists (select 'x'
              from theTable b
              where a.col1=b.col1
              and   a.col2=b.col2
              and   a.col3<>b.col3)
order by col1,col2,col3 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-01T04:46:39.937

以下是查找重复项的方法。使用您的数据在 oracle 10g 中进行了测试。

select * from tst where (col1, col2) in (select col1, col2 from tst group by col1, col2 with count(*) > 1)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T02:43:10.263

选择 COL1、COL2、COL3

从表

按 COL1、COL2、COL3 分组

计数（*）> 1

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T03:27:28.783

忘记连接——使用分析函数：

```
select col1, col2, col3
from
(
select col1, col2, col3, count(*) over (partition by col1, col2) rows_per_col1_col2
from table
)
where rows_per_col1_col2 > 1 
```

# php - 保护 PHP 共享主机上的数据库和会话数据

> ID：131017
> 
> 赞同：7
> 
> 时间：2008-09-25T01:35:41.190
> 
> 标签：php, security, apache, session, shared-hosting

我使用`SQLite`存储在`filesystem`.

这在功能上很好，而且维护成本低。但是，现在它需要在共享主机上运行。

共享主机上的所有 Web 应用程序都以同一个用户身份运行，因此我的用户的会话数据以及数据库、代码等都是易受攻击的。

`DBMS`许多人建议在这种`MySQL`情况下存储会话。所以起初我以为我会这样做，并将`SQLite`数据`MySQL`也移动到其中。但后来我意识到`MySQL`Web 应用程序用户需要读取凭据，所以我又回到了原点。

我认为最好的解决方案是`PHP`作为 a使用，`CGI`以便每个 Web 应用程序以不同的用户身份运行。这听起来不错，但我的主机不这样做，它使用`mod_php`. 从管理员的角度来看，启用此功能是否有任何缺点？（性能、向后兼容性等）？如果没有，那么我会要求他们启用此功能。

否则，在这种情况下，我能做些什么来保护我的数据库和会话数据吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T01:52:30.633

只要您的代码以共享 Web 用户身份运行，存储在服务器上的任何内容都会受到攻击。任何其他用户都可以编写 PHP 脚本来检查服务器上的任何可读文件，包括您的数据和 PHP 代码。

如果您的托管服务提供商允许，在不同用户下作为 CGI 作为 PHP 运行会有所帮助，但我预计性能会受到重大影响，因为每个请求都需要创建一个新进程。（您可以将 FCGI 视为性能更好的替代方案。）

另一种方法是根据用户提供的内容设置 cookie，并使用它来加密会话数据。例如，当用户登录时，获取他们的用户名、密码（由他们提供）和当前时间的哈希，用哈希加密会话数据，设置包含哈希的 cookie。在下一个请求中，您将取回 cookie，然后您可以使用它来解密会话数据。但是请注意，这只会保护当前会话数据；您的用户表、其他数据和代码仍然容易受到攻击。

在这种情况下，考虑到共享主机提供的安全性降低，您需要决定是否可以接受共享主机的低成本折衷。这将取决于您的应用程序，而且您最好接受风险，而不是试图提出一种复杂（甚至可能不是非常有效）的方法来增加安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T01:56:10.610

我不认为安全是全部或全部。您可以采取一些步骤。仅授予 web db 用户所需的权限。将密码存储为哈希。使用 openid 登录，以便用户通过 SSL 提供他们的凭据。

cgi 上的 PHP 可能会更慢，一些主机可能根本不想支持多个环境。

出于某种原因，您可能需要坚持使用您的主机，但通常有很多可用的，这是一个很好的提醒人们比较功能和安全性以及成本。我注意到许多公司开始提供虚拟机托管——在将您的代码与其他用户隔离方面几乎专用的服务器级安全性——在我看来是合理的成本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T01:58:13.647

如果您意识到与您共享服务器的站点的数据的隐私和安全性，则共享主机无法运行网站。您的 Web 应用程序可以访问的任何内容对其他人来说都是公平的游戏；他们可以访问它只是时间问题（假设他们确实有动力对您这样做）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T02:05:23.880

“你可以将你的数据库连接变量放在 web 根目录下的文件中。这至少可以保护它免受 web 访问。如果你也打算使用基于文件的会话，你可以在用户目录中设置会话路径和再次在网络根目录之外。”

我没有帐户，所以我不能对此投反对票。但严重的是，它甚至与问题无关。

呵呵，你把东西存储在 webroot 之外。这适用于任何托管方案，并不特定于共享托管。我们这里不是在谈论保护外人。我们正在谈论保护同一台机器上的其他应用程序。

对于 OP，我认为 PHP 作为 CGI 是最安全的解决方案，正如您自己已经建议的那样。但正如其他人所说，这会对性能造成影响。

您可能会看到将会话和数据库移动到 MySQL 并使用 safe_mode 和/或 open_basedir。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T08:17:17.993

我会通过更改基础设施而不是代码来解决问题。考虑升级到 VPS 服务器。现在你可以很便宜地买到它们。我已经看到 VPS 的起步价为 10 美元/月。

# java - Java 迁移

> ID：131020
> 
> 赞同：86
> 
> 时间：2008-09-25T01:37:22.590
> 
> 标签：java, ruby-on-rails, migration

我同时使用 ruby​​ on rails 和 Java。当我在做一个 Rails 项目时，我真的很喜欢使用迁移。所以我想知道是否有类似 Java 工具的迁移？如果没有这样的工具，使用迁移作为控制 Java 项目使用的数据库的工具是个好主意吗？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2010-10-05T19:35:04.103

对于之间的功能**比较**

*   飞路
*   Liquibase
*   c5-db-迁移
*   数据库部署
*   米巴蒂斯
*   迁移数据库
*   迁移4j
*   数据库维护
*   自动补丁

看看[http://flywaydb.org](http://flywaydb.org)

这应该是您和其他任何**人为工作选择正确工具的良好开端**

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-08-26T19:58:41.400

[Liquibase](http://www.liquibase.org/)是该领域中另一个值得一试的项目。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-25T01:39:50.367

[Grails](http://grails.org/)有一个[dbmigrate](http://code.google.com/p/dbmigrate/wiki/Grails)实用程序，它仿照 Rails 中的一个。由于它是在 Groovy 中实现的，因此您应该能够在任何 Java 项目中使用它。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-25T07:09:49.887

我使用 Hibernate 的 SchemaUpdate 来执行与迁移相同的功能。它实际上比迁移更容易，因为每次启动应用程序时，它都会检查数据库结构并将其与映射同步，因此没有额外的 rake:db:migrate 步骤，并且您的应用程序永远不会与正在运行的数据库不同步反对。Hibernate 映射文件并不比 Rails 迁移复杂，因此即使您没有在应用程序中使用 Hibernate，也可以利用它。缺点是它不像回滚、向下迁移、运行 DML 语句那样灵活。正如评论中所指出的，它也不会删除表或列。作为 Hibernate 初始化过程的一部分，我运行了一个单独的方法来手动执行这些操作。

我不明白为什么你不能使用 Rails 迁移——只要你不介意安装堆栈（Ruby、Rake、Rails），你就不必接触你的应用程序。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-28T14:35:32.237

Java 的类似 Rails 的迁移也有两个独立的实现：

[1) 来自碳五](http://www.carbonfive.com/community/archives/2008/02/introducing_jav.html)的基于 Maven 的迁移

2) [Hashrocket](http://www.jroller.com/obie/entry/migrator_activerecord_migrations_in_java)中基于 Ant 的任务（我个人最喜欢的）

尽管这些包是专门为 Maven 和 Ant 编写的，但通过一些工作，您可以使它们适应任何东西。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-02-06T22:56:29.853

我在研究同一个问题时遇到了这篇文章。我还没有得出关于最佳工具或方法的任何结论，但是到目前为止，我遇到的一个在其他答案中没有提到的工具是[dbdeploy](http://dbdeploy.com/)。我有兴趣阅读这些工具的任何比较。

其他一些相关资源：Martin Fowler 和 Pramod Sadalage 关于[进化数据库设计](http://martinfowler.com/articles/evodb.html)的一些陈旧的帖子，以及由 Sadalage 和 Scot Ambler 撰写的《[重构数据库：进化数据库设计》一书。](http://www.ambysoft.com/books/refactoringDatabases.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-12-28T20:47:09.417

[Migrate4j](http://migrate4j.sourceforge.net/)似乎是一个候选者，但该项目看起来还不够成熟，无法用于生产。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-10-13T16:02:47.127

还有[DbMaintain](http://www.dbmaintain.org/overview.html)，它最初是在 Unitils 内部开发[的](http://www.unitils.org/)，但现在是一个专用项目。我们目前正在使用它并且非常满意（这并不意味着没有任何好的替代品）。我在我的[数据库+迁移](http://www.delicious.com/pthivent/database+migration)书签中列出了更多（重点是支持 Maven 的工具）。

# ruby-on-rails - backgroundrb 定时任务结束

> ID：131021
> 
> 赞同：2
> 
> 时间：2008-09-25T01:37:26.613
> 
> 标签：ruby-on-rails, ruby, backgroundrb

我有一个 backroundrb 计划任务，需要很长时间才能运行。但是，似乎该过程仅在 2.5 分钟后就结束了。

我的 background.yml 文件：

```
:schedules:
  :named_worker:
    :task_name:
      :trigger_args: 0 0 12 * * * *
      :data: input_data 
```

进程运行时，我在服务器上的活动为零。（这意味着我是服务器上唯一一个看着日志文件做他们的事情直到进程突然停止的人。）

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T06:51:51.913

这里没有太多信息可以让我们深入了解问题。因为 backgroundrb 在后台运行，所以很难监控/调试。

以下是我使用的一些想法：

1.  编写一个单元测试来测试工作代码本身并确保那里没有问题
2.  在代码中的多个点放置“puts”语句，这样您至少可以在工作程序运行时看到一些响应。
3.  将整个工作人员包装在 begin..rescue..end 块中，以便您可以捕获可能发生的任何错误并缩短流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T22:14:28.013

谢谢安德鲁。这些调试技巧有所帮助。尤其是 begin..rescue..end 块。

尽管如此，调试仍然很痛苦。最后不是BackgroundRB在2.5分钟后缩短。建立的网络连接未正确关闭。一旦找到并关闭它，一切都会很好。

# functional-programming - 列出方案的理解库？

> ID：131023
> 
> 赞同：10
> 
> 时间：2008-09-25T01:38:06.753
> 
> 标签：functional-programming, lisp, scheme, common-lisp, list-comprehension

我知道有一个用于通用 lisp ( [incf-cl](http://superadditive.com/projects/incf-cl/) ) 的列表理解库，我知道它们在各种其他功能性（和一些非功能性）语言（F#、Erlang、Haskell 和 C#）中都受到原生支持 - 有没有Scheme的列表理解库？

incf-cl 在 CL 中作为一个使用宏的库来实现——难道不能使用相同的技术为 Scheme 创建一个吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T03:00:47.583

*   [Swindle](http://docs.plt-scheme.org/swindle/index.html)主要是一个 CLOS 模拟器库，但它也有列表推导。我用过它们，它们很方便，但我使用的版本有缺陷且不完整。（我只需要通用函数。）
*   但是，您可能需要[SRFI-42](http://srfi.schemers.org/srfi-42/srfi-42.html)。我没有使用过它，但它的错误必须比 Swindle 列表推导少。

我不知道您使用的是哪种方案。[PLT Scheme](http://www.plt-scheme.org)捆绑了 Swindle 和 SRFI-42。不过，两者都应该是跨方案兼容的。

如果您使用 PLT Scheme，这里是 SRFI-42 的[手册页](http://docs.plt-scheme.org/srfi/srfi-42.html)。你说`(require srfi/42)`得到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T13:27:42.803

您可以将[LINQ 用于 R6RS 方案](https://ironscheme.svn.codeplex.com/svn/IronScheme/IronSchemeConsole/ironscheme/linq.ss)（尽管它可以在“旧”实现下运行）。

# winapi - 以编程方式修改/检测本地安全策略

> ID：131025
> 
> 赞同：4
> 
> 时间：2008-09-25T01:38:27.687
> 
> 标签：winapi, visual-c++, mfc, local-security-policy

是否可以至少执行以下操作之一：

1) 检测本地安全策略的设置（帐户：限制本地帐户使用空白密码只能登录控制台）

2）修改该设置

使用 Win32/MFC？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T02:20:36.057

我以前一直走这条路，结果是：

[http://groups.google.com/group/microsoft.public.platformsdk.security/browse_thread/thread/63d884134958cce7?pli=1](http://groups.google.com/group/microsoft.public.platformsdk.security/browse_thread/thread/63d884134958cce7?pli=1)

我能够使用 advapi32.dll 中的 Lsa* 函数配置用户权限分配，但永远无法弄清楚如何配置安全选项。

不过，这可能会有所帮助：

[http://www.windowsdevcenter.com/pub/a/windows/2005/03/15/local_security_policies.html](http://www.windowsdevcenter.com/pub/a/windows/2005/03/15/local_security_policies.html) [http://support.microsoft.com/default.aspx?scid=214752](http://support.microsoft.com/default.aspx?scid=214752)

您可以自定义模板，然后从您的代码中运行 regsvr32 %windir%\system32\scecli.dll。

不优雅，但可能是一种方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T02:51:16.547

好吧，我想我知道如何做第一部分（检测这个设置）。它实际上位于注册表中：

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa 
```

键为“LimitBlankPasswordUse”，如果为 1 则为 Enabled，否则为 Disabled。

所以，如果我需要告诉用户修改它，阅读它至少会告诉我。我怀疑我可以改变它虽然......

# apache-flex - 在actionscript / Flex中将字符串转换为uint

> ID：131040
> 
> 赞同：3
> 
> 时间：2008-09-25T01:41:49.630
> 
> 标签：apache-flex, actionscript-3, actionscript

我正在创建一个组件并希望像许多 flex 控件一样公开一个颜色属性，假设我有这样的简单组件，我们称之为 foo_label：

```
 <mx:Canvas>
    <mx:Script>
        [Bindable] public var color:uint;
    </mx:Script>
    <mx:Label text="foobar" color="{color}" />
</mx:Canvas> 

```

然后将组件添加到另一个 mxml 文件中，类似于：

```
 <foo:foo_label color="red" /> 

```

当我编译编译器抱怨：无法从文本“红色”解析类型 uint 的值。但是，如果我使用普通标签，我可以做到

```
<mx:Label text="foobar" color="red">
```

没有任何问题，并且颜色属性仍然是 uint 类型。

我的问题是如何公开公共属性以便控制组件文本的颜色？为什么我可以使用字符串“red”作为 mx 控件的 uint 字段，但在自定义组件中似乎不能这样做，我需要做一些特别的事情吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T08:13:52.573

颜色不是一种属性，它是一种风格。您需要像这样定义样式：

```
[Style(name="labelColor", type="uint", format="Color" )] 
```

（如果直接在 MXML 中定义，请将其括在标记中）。然后您需要添加一些 ActionScript 来处理此样式并将其应用于您需要的任何控件，请参阅[http://livedocs.adobe.com/flex/3/html/help.html?content=skinstyle_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=skinstyle_1.html)了解更多信息信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-03T05:17:57.217

这是我的两个实用程序功能：

```
 public static function convertUintToString( color:uint ):String {  
            return color.toString(16);  
    }  

    public static function convertStringToUint(value:String, mask:String):uint {  
            var colorString:String = "0x" + value;  
            var colorUint:uint = mx.core.Singleton.getInstance("mx.styles::IStyleManager2").getColorName( colorString );  

            return colorUint;  
    } 
```

# wiki - 向 mediawiki 添加报价框最简单的方法是什么？

> ID：131049
> 
> 赞同：33
> 
> 时间：2008-09-25T01:45:15.330
> 
> 标签：wiki, mediawiki, quotes

我在我的服务器上安装了 mediawiki 作为我的个人知识库。有时我会从 Web 复制一些东西并粘贴到我的 wiki - 例如来自某人博客的提示和技巧。如何使复制的内容出现在带边框的框中？

例如，这篇博文末尾的方框看起来很漂亮：
[http ://blog.dreamhost.com/2008/03/21/good-reminiscing-friday/](http://blog.dreamhost.com/2008/03/21/good-reminiscing-friday/)

我可以使用 pre 标签，但 pre 标签中的段落不会自动换行。有什么想法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-09-25T07:19:28.617

我在我的 wiki 中制作了一个名为 Template:quote 的模板，其中包含以下内容：

```
<div style="background-color: #ddf5eb; border-style: dotted;">
{{{1}}}
</div> 
```

然后我可以在页面中使用模板，例如，

> {{quote|一个小测试}}

效果很好 - 谢谢！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-25T06:47:16.837

```
<blockquote style="background-color: lightgrey; border: solid thin grey;">
Det er jeg som kjenner hemmeligheten din. Ikke et pip, gutten min.
</blockquote> 
```

块引用比 div 更好，因为它们“解释”文本实际上是块引用，而不是“只是一些文本”。此外，块引用很可能会正确缩进，实际上看起来像块引用。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-09-12T14:03:41.390

要结合这两个最有效的答案，您应该使用一个本身使用[blockquote的](http://www.htmlquick.com/reference/tags/blockquote.html)[MediaWiki 模板](http://www.mediawiki.org/wiki/Help%3aTemplates)。

模板内容：

```
<blockquote style="color: lightgrey; border: solid thin gray;">
    {{{1}}}
</blockquote> 
```

在您的 WIKI 页面上的用法（假设您将模板命名为“quote”）：

```
{{ quote | The text you want to quote }} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T03:26:24.510

Mediawiki 支持 div 标签。将 div 标签与一些样式结合起来：

```
<div style="background-color: cyan; border-style: dashed;">
A bunch of text that will wrap.
</div> 
```

您可以使用任何您想要的 css 属性，但这应该可以帮助您入门。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-20T16:30:49.437

我使用来自@steve k 的代码将浅灰色更改为黑色并在边框和文本之间添加填充。我发现浅灰色几乎看不见，文字直接靠近边框。

```
<blockquote style="
 color: black;
 border: solid thin gray;
 padding-top: 10px;
 padding-right: 10px;
 padding-bottom: 10px;
 padding-left: 10px;
 ">
{{{1}}}
</blockquote> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-30T21:14:17.497

您可以`index.php?title=MediaWiki:Common.css`为此目的使用 page 并为`<blockquote/>`那里的元素设置 CSS 样式：

```
blockquote {
    background-color: #ddf5eb; 
    border-style: dotted;
} 
```

以类似的方式，您可以`<pre/>`设置对代码片段等有用的样式，以便包装内容：

```
pre {
    white-space: pre-wrap;
    white-space: -moz-pre-wrap; 
    white-space: -pre-wrap; 
    white-space: -o-pre-wrap; 
    word-wrap: break-word;
} 
```

对于更长的代码片段，您可能需要使用`<syntaxhighlight/>`（或`<source/>`）附带[SyntaxHighlight 扩展](https://www.mediawiki.org/wiki/Extension:SyntaxHighlight)的元素。你也可以[`style`](https://www.mediawiki.org/wiki/Extension:SyntaxHighlight#style)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-05T02:03:52.503

在 pre 标签中设置一个宽度，它将换行。

```
<pre width="80%"> 
```

# actionscript-3 - 在 Actionscript 3 中实现单例模式类的最佳方法是什么？

> ID：131050
> 
> 赞同：4
> 
> 时间：2008-09-25T01:45:52.723
> 
> 标签：actionscript-3, design-patterns, oop, singleton

由于 AS3 不允许私有构造函数，因此构造单例并保证构造函数不是通过“new”显式创建的唯一方法似乎是传递单个参数并检查它。

我听过两个建议，一个是检查调用者并确保它是静态 getInstance()，另一个是在同一个包命名空间中有一个私有/内部类。

传递给构造函数的私有对象似乎更可取，但看起来您不能在同一个包中拥有私有类。这是真的？更重要的是，这是实现单例的最佳方式吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T11:57:55.843

对 enobrev 的回答稍作调整，就是将实例作为吸气剂。有人会说这更优雅。此外，如果您在调用 getInstance 之前调用构造函数，则 enobrev 的答案不会强制执行 Singleton。这可能并不完美，但我已经对此进行了测试并且它有效。（在“Advanced ActionScrpt3 with Design Patterns”一书中肯定还有另一种好方法）。

```
package {
    public class Singleton {

    private static var _instance:Singleton;

    public function Singleton(enforcer:SingletonEnforcer) {
        if( !enforcer) 
        {
                throw new Error( "Singleton and can only be accessed through Singleton.getInstance()" ); 
        }
    }

    public static function get instance():Singleton
    {
        if(!Singleton._instance)
        {
            Singleton._instance = new Singleton(new SingletonEnforcer());
        }

        return Singleton._instance;
    }
}

}
class SingletonEnforcer{} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T07:47:51.573

我已经使用了一段时间，我相信我最初是从所有地方的维基百科中获得的。

```
package {
    public final class Singleton {
        private static var instance:Singleton = new Singleton();

        public function Singleton() {
            if( Singleton.instance ) {
                throw new Error( "Singleton and can only be accessed through Singleton.getInstance()" ); 
            }
        }

        public static function getInstance():Singleton {                
            return Singleton.instance;
        }
    }
} 
```

[这是该问题的有趣摘要](http://life.neophi.com/danielr/2006/10/singleton_pattern_in_as3.html)，它导致了类似的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T03:16:09.077

Cairngorm 使用的模式（可能不是最好的）是在构造函数被第二次调用时在构造函数中抛出运行时异常。例如：

```
public class Foo {
  private static var instance : Foo;

  public Foo() {
    if( instance != null ) { 
      throw new Exception ("Singleton constructor called");
    }
    instance = this;
  }

  public static getInstance() : Foo {
    if( instance == null ) {
      instance = new Foo();
    }
    return instance;
  }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T03:30:55.623

您可以像这样获得私人课程：

```
package some.pack
{
  public class Foo
  {
    public Foo(f : CheckFoo)
    {
      if (f == null) throw new Exception(...);
    }
  }

  static private inst : Foo;
  static public getInstance() : Foo
  {
     if (inst == null)
         inst = new Foo(new CheckFoo());
     return inst;
  }
}

class CheckFoo
{
} 
```

# vb.net - 对象引用未设置为对象实例

> ID：131053
> 
> 赞同：2
> 
> 时间：2008-09-25T01:46:40.397
> 
> 标签：vb.net

**我在VB .Net**中遇到错误

 **> 对象引用未设置为对象的实例。

你能告诉我这个错误的原因是什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T01:47:36.230

对象在使用前尚未初始化。

在代码文件类型的顶部：

```
Option Strict On
Option Explicit On 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-07-13T14:57:36.593

让我们解构错误消息。

“对象引用”是指您在代码中使用的引用对象的变量。对象变量可能已由您声明，或者您可能只是使用在另一个对象中声明的变量。

“对象实例”表示对象是空白的（或者在 VB 中说“ **Nothing** ”）。当您处理对象变量时，您必须在引用它之前创建该对象的**实例**。

“未设置为”意味着您尝试访问一个对象，但其中没有任何内容可供计算机访问。

如果您创建一个变量，例如

```
Dim aPerson as PersonClass 
```

你所做的只是告诉编译器 aPerson 将代表一个人，而不是***什么***人。

您可以使用“新建”关键字创建对象的空白副本。例如

```
Dim aPerson as New PersonClass 
```

如果您希望能够通过以下方式测试对象是否“无”

```
If aPerson Is Nothing Then
    aPerson = New PersonClass
End If 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-25T02:32:52.970

sef，如果问题出在数据库返回结果上，我认为是在这种情况下：

```
 dsData = getSQLData(conn,sql, blah,blah....)
   dt = dsData.Tables(0)  'Perhaps the obj ref not set is occurring here 
```

要解决这个问题：

```
 dsData = getSQLData(conn,sql, blah,blah....)
   If dsData.Tables.Count = 0 Then Exit Sub
   dt = dsData.Tables(0)  'Perhaps the obj ref not set is occurring here 
```

**编辑**：添加代码格式化标签...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T02:03:47.830

通常，在 .NET 运行时，每当取消引用未分配或已分配值的变量`Nothing`（在 VB.Net 中，`null`在 C# 中）时，就会发生这种情况。

`Option Strict On`并将`Option Explicit On`帮助检测可能发生这种情况的实例，但有可能从另一个函数调用中获取 null/Nothing：

```
Dim someString As String = someFunctionReturningString();
If ( someString Is Nothing ) Then
   Sysm.Console.WriteLine(someString.Length); // will throw the NullReferenceException
End If 
```

[NullReferenceException](http://msdn.microsoft.com/en-us/library/system.nullreferenceexception.aspx#Mtps_DropDownFilterText)是“对象引用未设置为对象实例”的来源。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T02:34:01.017

如果您认为当数据库查询没有返回数据时会发生这种情况，那么也许您应该在对其进行操作之前测试结果？

```
Dim result As String = SqlCommand.ExecuteScalar()   'just for scope'
If result Is Nothing OrElse IsDBNull(result) Then
    'no result!'
End If 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T02:24:03.677

您可以在应用程序中放置日志记录机制，以便隔离错误的原因。Exception 对象具有 StackTrace 属性，该属性是一个描述调用堆栈内容的字符串，最近的方法调用首先出现。通过查看它，您将获得有关可能导致异常的原因的更多详细信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T02:38:25.983

使用数据库时，当您尝试从不存在的字段或行中获取值时，可能会出现此错误。即，如果您正在使用数据集并且您使用：

```
Dim objDt as DataTable = objDs.Tables("tablename") 
```

如果数据集中不存在表名，则会得到对象“引用未设置为对象实例”。数据集中的行或字段也是如此。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-23T11:30:49.873

好吧，错误正在解释自己。由于您没有提供任何代码示例，我们只能在您的代码中的某处说，您正在为某些任务使用 Null 对象。我在下面的代码示例中遇到了同样的错误。

```
Dim cmd As IDbCommand
cmd.Parameters.Clear() 
```

如您所见，我将清除 Null 对象。为此，我收到错误

> “你调用的对象是空的”

在您的代码中检查您的代码中的此类代码。由于您没有给出代码示例，我们无法突出显示代码:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-22T06:47:39.650

如果您有一个类属性和多个构造函数，则必须在所有构造函数中初始化该属性。

# sql - 从列表中为每个帐户 ID 获取一行，第 2 部分

> ID：131056
> 
> 赞同：3
> 
> 时间：2008-09-25T01:47:41.317
> 
> 标签：sql, mysql, database

不知道如何询问 SO 的后续行动，但这是参考之前的问题： [Fetch one row per account id from list](https://stackoverflow.com/questions/94930/fetch-one-row-per-account-id-from-list)

我正在使用的查询是：

```
SELECT *
FROM scores s1
WHERE accountid NOT IN (SELECT accountid FROM scores s2 WHERE s1.score < s2.score)
ORDER BY score DESC 
```

这会选择最高分，并将结果限制为每个 accountid 一行；他们的最高分。

最后一个障碍是，此查询将返回多行记录的帐户 ID，这些帐户 ID 多次出现最高分。因此，如果 accountid 17 的得分为 40、75、30、75，则查询将返回得分均为 75 的两行。

任何人都可以修改此查询（或提供更好的查询）来解决这种情况，并真正将其限制为每个帐户 ID 一行吗？

再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T01:52:37.450

```
select accountid, max(score) from scores group by accountid; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T07:16:42.117

如果您只对 accountid 和 score 感兴趣，那么您可以使用上面 Paul 给出的简单 GROUP BY 查询。

```
SELECT accountid, MAX(score) 
FROM scores 
GROUP BY accountid; 
```

如果您需要分数表中的其他属性，则可以使用如下查询从行中获取其他属性：

```
SELECT s1.*
FROM scores AS s1
  LEFT OUTER JOIN scores AS s2 ON (s1.accountid = s2.accountid 
    AND s1.score < s2.score)
WHERE s2.accountid IS NULL; 
```

但这仍然会给出多行，在您的示例中，给定的 accountid 有两个与其最大值匹配的分数。要将结果集进一步减少到单行，例如具有最新游戏日期的行，请尝试以下操作：

```
SELECT s1.*
FROM scores AS s1
  LEFT OUTER JOIN scores AS s2 ON (s1.accountid = s2.accountid 
    AND s1.score < s2.score)
  LEFT OUTER JOIN scores AS s3 ON (s1.accountid = s3.accountid 
    AND s1.score = s3.score AND s1.gamedate < s3.gamedate) 
WHERE s2.accountid IS NULL
    AND s3.accountid IS NULL; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T03:23:53.503

如果您的 RDBMS 支持它们，那么分析函数将是一个很好的方法，特别是如果您需要行的所有列。

```
select ...
from   (
   select accountid,
          score,
          ...
          row_number() over 
               (partition by accountid
                    order by score desc) score_rank
   from   scores)
where score_rank = 1; 
```

在您描述的情况下，返回的行是不确定的，但是您可以轻松地修改分析函数，例如通过对 (score desc, test_date desc) 进行排序以获得两个匹配的高分中较新的一个。

其他基于等级的分析函数将达到类似的目的。

如果您不介意重复，那么以下方法可能比您当前的方法更有效：

```
select ...
from   (
   select accountid,
          score,
          ...
          max(score) over (partition by accountid) max_score
   from   scores)
where score = max_score; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T01:50:52.197

如果要选择列的子集，则可以使用 DISTINCT 关键字过滤结果。

```
SELECT DISTINCT UserID, score
FROM scores s1
WHERE accountid NOT IN (SELECT accountid FROM scores s2 WHERE s1.score < s2.score)
ORDER BY score DESC 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T01:52:05.220

您的数据库是否支持不同的？如从 y 中选择不同的 x？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T11:54:44.867

此解决方案适用于 MS SQL，为您提供整行。

```
SELECT *
FROM scores
WHERE scoreid in
(
  SELECT max(scoreid)
  FROM scores as s2
    JOIN
  (
    SELECT max(score) as maxscore, accountid
    FROM scores s1
    GROUP BY accountid
  ) sub ON s2.score =  sub.maxscore AND s2.accountid = s1.accountid
  GROUP BY s2.score, s2.accountid
) 
```

# model-view-controller - 花哨的 MVC URL 会影响缓存的完成方式吗？

> ID：131061
> 
> 赞同：0
> 
> 时间：2008-09-25T01:51:38.047
> 
> 标签：model-view-controller, browser, caching

在阅读有关[清除 JS 文件缓存的问题的一些答案时，有人指出了](https://stackoverflow.com/questions/118884/what-is-an-elegant-way-to-force-browsers-to-reload-cached-cssjs-files)[http 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.9)的这一部分。它基本上说 URLS 包含一个？除非给出特定的到期日期，否则不应从缓存中提取。在 MVC 网站（RoR、ASP.Net MVC 等）中很常见的不存在查询字符串的 URL 如何被缓存，并且与更传统的基于查询字符串的 url 的行为有何不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T12:55:55.577

AFAIK 浏览器方面没有区别，因为 Firefox 和 IE 都会（错误地）缓存来自带有查询字符串的 url 的响应，就像它们缓存来自没有查询字符串的 url 的响应一样。在 Safari 的情况下，它尊重规范并且不缓存带有查询字符串的 url。HTTP 代理往往与他们认为可缓存的内容有点不一致。

正确设置标题是值得的，值得研究[ETags](http://en.wikipedia.org/wiki/HTTP_ETag)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T01:55:17.240

我相信您使用 OutputCache 属性（在您的控制器方法上）管理 ASP.NET MVC 中的缓存。

# iphone - iPhone viewWillAppear 未触发

> ID：131062
> 
> 赞同：118
> 
> 时间：2008-09-25T01:52:00.993
> 
> 标签：iphone, ios, cocoa-touch

我已经阅读了很多关于人们在`viewWillAppear`没有正确创建视图层次结构时*遇到*问题的帖子。我的问题是我无法弄清楚这意味着什么。

如果我在该控制器上创建`RootViewController`并调用`addSubView`，我希望添加的视图能够连接到`viewWillAppear`事件。

有没有人有一个复杂的编程视图层次结构的例子，它成功地接收`viewWillAppear`了每个级别的事件？

苹果的文档状态：

> 警告：如果属于视图控制器的视图直接添加到视图层次结构中，视图控制器将不会收到此消息。如果您将视图插入或添加到视图层次结构中，并且它具有视图控制器，则应直接向关联的视图控制器发送此消息。未能向视图控制器发送此消息将阻止显示任何关联的动画。

问题是他们没有描述如何做到这一点。“直接”是什么意思？您如何“间接”添加视图？

我对 Cocoa 和 iPhone 还很陌生，所以如果除了基本的 Hello World 废话之外，还有来自 Apple 的有用示例，那就太好了。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-17T04:35:39.453

如果您使用导航控制器并设置其委托，则不会调用 view{Will,Did}{Appear,Disappear} 方法。

您需要改用导航控制器委托方法：

```
navigationController:willShowViewController:animated:
navigationController:didShowViewController:animated: 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-28T01:20:27.820

我遇到了同样的问题。只需`viewWillAppear`在将其添加为子视图之前向您的视图控制器发送一条消息。（有一个 BOOL 参数告诉视图控制器它是否被动画显示。）

```
[myViewController viewWillAppear:NO]; 
```

查看节拍器示例中的 RootViewController.m。

（我实际上发现 Apple 的示例项目很棒。除了 HelloWorld 之外还有很多；）

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-12-22T10:38:50.490

我终于找到了一个可行的解决方案！

[UINavigationControllerDelegate](http://www.idev101.com/code/User_Interface/UINavigationController/viewWillAppear.html)

我认为它的要点是将导航控件的委托设置为它所在的视图控制器，并实现`UINavigationControllerDelegate`它是两种方法。杰出的！我很兴奋，我终于找到了解决方案！

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-06-14T13:54:42.150

感谢 iOS 13。

> `ViewWillDisappear`, `ViewDidDisappear`,`ViewWillAppear`并且 `ViewDidAppear`不会在 iOS 13 上的演示视图控制器上被调用，该控制器使用不覆盖整个屏幕的新模式演示。

学分将[归于 Arek Holko](https://twitter.com/arekholko/status/1137756105050918912)。他真的拯救了我的一天。

[![在此处输入图像描述](https://i.stack.imgur.com/I1mH3.jpg)](https://i.stack.imgur.com/I1mH3.jpg)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-01-13T14:46:52.903

我只是有同样的问题。在我的应用程序中，我有 2 个导航控制器并在每个控制器中推送相同的视图控制器在一种情况下工作，而不是在另一种情况下工作。我的意思是，当在第一个中推送完全相同的视图控制器时`UINavigationController`，`viewWillAppear`会调用但在第二个导航控制器中推送时不会调用。

然后我遇到了这篇文章[UINavigationController 应该调用 viewWillAppear/viewWillDisappear 方法](http://discussions.apple.com/thread.jspa?threadID=1529769&tstart=0)

并意识到我的第二个导航控制器确实重新定义了`viewWillAppear`. 筛选代码显示我没有打电话

```
[super viewWillAppear:animated]; 
```

我添加了它并且它有效！

文档说：

> 如果你重写了这个方法，你必须在你的实现中调用 super 。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-25T19:24:01.590

我一直在使用导航控制器。当我想下降到另一个级别的数据或显示我的自定义视图时，我使用以下内容：

```
[self.navigationController pushViewController:<view> animated:<BOOL>]; 
```

当我这样做时，我确实得到了`viewWillAppear`触发功能。我想这符合“间接”的条件，因为我`addSubView`自己没有调用实际方法。我不知道这是否 100% 适用于您的应用程序，因为我无法判断您是否使用导航控制器，但也许它会提供线索。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-07-26T17:10:55.653

首先，标签栏应该在根级别，即添加到窗口中，如Apple文档中所述。这是正确行为的关键。

其次，您*可以*使用`UITabBarDelegate`/`UINavigationBarDelegate`手动转发通知，但我发现要让整个视图调用层次结构正常工作，我所要做的就是手动调用

```
[tabBarController viewWillAppear:NO];
[tabBarController viewDidAppear:NO]; 
```

和

```
[navBarController viewWillAppear:NO];
[navBarController viewDidAppear:NO]; 
```

.. 在相应控制器上设置视图控制器之前仅一次（分配后）。从那时起，它在其子视图控制器上正确地调用了这些方法。

我的层次结构是这样的：

```
window
    UITabBarController (subclass of)
        UIViewController (subclass of) // <-- manually calls [navController viewWill/DidAppear
            UINavigationController (subclass of)
                UIViewController (subclass of) // <-- still receives viewWill/Did..etc all the way down from a tab switch at the top of the chain without needing to use ANY delegate methods 
```

只需第一次在选项卡/导航控制器上调用上述方法即可确保正确转发所有事件。它阻止了我需要从`UINavigationBarDelegate`/`UITabBarControllerDelegate`方法手动调用它们。

旁注：奇怪的是，当它不起作用时，私有方法

```
- (void)transitionFromViewController:(UIViewController*)aFromViewController toViewController:(UIViewController*)aToViewController 
```

..您可以从工作实现的调用堆栈中看到，通常调用`viewWill/Did..`方法，但直到我执行上述操作（即使它被调用）才调用。

我认为它`UITabBarController`处于窗口级别非常重要，并且文件似乎支持这一点。

希望这很清楚（ish），很高兴回答进一步的问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-11-22T03:21:13.770

通过调用“直接”添加视图`[view addSubview:subview]`。通过交换子视图的选项卡栏或导航栏等方法“间接”添加视图。

任何时候你打电话`[view addSubview:subviewController.view]`，你都应该打电话`[subviewController viewWillAppear:NO]`（或者是，视你的情况而定）。

当我为游戏中的子屏幕实现自己的自定义根视图管理系统时，我遇到了这个问题。手动添加对 viewWillAppear 的调用解决了我的问题。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-12-04T20:53:42.580

由于没有答案被接受并且人们（就像我一样）登陆这里，我给出了我的变化。虽然我不确定这是最初的问题。当导航控制器作为子视图添加到另一个视图时，您必须自己调用 viewWillAppear/Dissappear 等方法，如下所示：

```
- (void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    [subNavCntlr viewWillAppear:animated];
}

- (void) viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];

    [subNavCntlr viewWillDisappear:animated];
} 
```

只是为了使示例完整。此代码出现在我的 ViewController 中，我在其中创建导航控制器并将其添加到放置在视图上的视图中。

```
- (void)viewDidLoad {

    // This is the root View Controller
    rootTable *rootTableController = [[rootTable alloc]
                 initWithStyle:UITableViewStyleGrouped];

    subNavCntlr = [[UINavigationController alloc]   
                  initWithRootViewController:rootTableController];

    [rootTableController release];

    subNavCntlr.view.frame = subNavContainer.bounds;

    [subNavContainer addSubview:subNavCntlr.view];

    [super viewDidLoad];
} 
```

.h 看起来像这样

```
@interface navTestViewController : UIViewController <UINavigationControllerDelegate> {
    IBOutlet UIView *subNavContainer;
    UINavigationController *subNavCntlr;
}

@end 
```

在 nib 文件中，我有视图，在此视图下方，我有一个标签，一个图像和一个容器（另一个视图），我将控制器放入其中。这是它的外观。我不得不打乱一些东西，因为这是为客户工作的。

![替代文字](https://i.stack.imgur.com/CZ2Vw.png)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-07-28T16:47:06.977

正确的方法是使用 UIViewController 包含 API。

```
- (void)viewDidLoad {
     [super viewDidLoad];
     // Do any additional setup after loading the view.
     UIViewController *viewController = ...;
     [self addChildViewController:viewController];
     [self.view addSubview:viewController.view];
     [viewController didMoveToParentViewController:self];
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-12-05T14:05:07.733

一个非常常见的错误如下。您有一个视图，`UIView* a`和另一个视图，`UIView* b`。您将 b 添加到 a 作为子视图。如果你尝试在 b 中调用 viewWillAppear，它永远不会被触发，因为它是 a 的子视图

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-06-22T07:57:17.090

我将此代码用于推送和弹出视图控制器：

推：

```
[self.navigationController pushViewController:detaiViewController animated:YES];
[detailNewsViewController viewWillAppear:YES]; 
```

流行音乐：

```
[[self.navigationController popViewControllerAnimated:YES] viewWillAppear:YES]; 
```

..它对我来说很好。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-10-16T14:49:55.727

iOS 13 将我的应用程序放在了此处。如果您注意到从 iOS 13 开始的行为变化，只需在推送之前设置以下内容：

```
yourVC.modalPresentationStyle = UIModalPresentationFullScreen; 
```

您可能还需要在属性检查器的 .storyboard 中设置它（将 Presentation 设置为 Full Screen）。

这将使您的应用程序的行为与之前的 iOS 版本一样。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-07T15:51:46.657

I'm not 100% sure on this, but I think that adding a view to the view hierarchy directly means calling `-addSubview:` on the view controller's view (e.g., `[viewController.view addSubview:anotherViewController.view]`) instead of pushing a new view controller onto the navigation controller's stack.

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-11-23T13:36:12.533

```
[self.navigationController setDelegate:self]; 
```

将委托设置为根视图控制器。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-06-15T15:50:25.783

我认为他们“直接”的意思是通过与 xcode“导航应用程序”模板相同的方式连接事物，它将 UINavigationController 设置为应用程序 UIWindow 的唯一子视图。

使用该模板是我能够在 UINavigationController 中的这些控制器的推送/弹出时在对象 ViewControllers 上调用 Will/Did/Appear/Disappear 方法的唯一方法。这里的答案中没有其他解决方案对我有用，包括在 RootController 中实现它们并将它们传递给（子）NavigationController。这些功能（将/已/出现/消失）仅在显示/隐藏顶级 VC、我的“登录”和导航 VC，而不是导航控制器中的子 VC 时在我的 RootController 中调用，所以我没有机会将它们“传递给”导航 VC。

我最终使用 UINavigationController 的委托功能来查找在我的应用程序中需要后续功能的特定转换，并且可以正常工作，但它需要更多的工作才能让消失和出现功能“模拟”。

同样，在今天将我的头撞到这个问题几个小时之后，让它工作也是一个原则问题。任何使用自定义 RootController 和子导航 VC 的工作代码片段将不胜感激。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-11-19T20:18:26.057

万一这对任何人都有帮助。我有一个类似的问题，我`ViewWillAppear`没有在`UITableViewController`. 在玩了很多之后，我意识到问题`UINavigationController`在于控制我`UITableView`的不在根视图上。一旦我解决了这个问题，它现在就像一个冠军一样工作。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-05-25T06:05:42.133

我认为添加子视图并不一定意味着视图会出现，因此不会自动调用类的方法

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-09-21T18:18:19.980

我自己也遇到了这个问题，我花了 3 个完整小时（其中 2 个谷歌搜索）来解决它。

原来有帮助的是简单地**从设备/模拟器中删除应用程序，清理然后再次运行**。

希望有帮助

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-12-20T06:03:55.793

对于斯威夫特。首先在 viewWillAppear 中创建协议来调用你想调用的东西

```
protocol MyViewWillAppearProtocol{func myViewWillAppear()} 
```

二、创建类

```
class ForceUpdateOnViewAppear: NSObject, UINavigationControllerDelegate {
func navigationController(_ navigationController: UINavigationController, willShow viewController: UIViewController, animated: Bool){
    if let updatedCntllr: MyViewWillAppearProtocol = viewController as? MyViewWillAppearProtocol{
        updatedCntllr.myViewWillAppear()
    }
} 
```

}

第三，使 ForceUpdateOnViewAppear 的实例成为有权访问 Navigation Controller 并且只要 Navigation Controller 存在就存在的适当类的成员。例如，它可能是导航控制器的根视图控制器或创建或呈现它的类。然后尽早将 ForceUpdateOnViewAppear 的实例分配给 Navigation Controller 委托属性。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-10-23T08:23:35.610

就我而言，问题在于自定义过渡动画。设置时`modalPresentationStyle = .custom` `viewWillAppear`未调用

在自定义过渡动画类中需要调用方法： `beginAppearanceTransition`和`endAppearanceTransition`

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-04-15T07:01:37.203

我的问题是 viewWillAppear 在从 segue 展开时没有被调用。答案是在视图控制器的展开序列中调用 viewWillAppear(true)

@IBAction func unwind(for unwindSegue: UIStoryboardSegue, ViewController laterVC: Any) {

```
 viewWillAppear(true)
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-02-21T10:31:15.317

我创建了一个类来解决这个问题。只需将其设置为导航控制器的委托，并在视图控制器中实现简单的一两个方法 - 当视图即将显示或已通过 NavigationController 显示时将被调用

[这是显示代码的 GIST](https://gist.github.com/greggjaskiewicz/70f4a37cf6abc51423c9ecbb0033d6c7)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-01-29T19:25:52.403

就我而言，这只是 ios 12.1 模拟器上的一个奇怪错误。在真机上启动后消失。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-02-21T10:52:17.690

ViewWillAppear 是 UIViewController 类的重写方法，因此添加子视图不会调用 viewWillAppear，但是当您从 viewController 呈现、push、pop、show、setFront 或 popToRootViewController 时，将调用呈现的 viewController 的 viewWillAppear。

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2011-11-16T19:35:51.517

我不确定这与我解决的问题相同。
在某些情况下，方法不会以正常方式执行，例如“[self methodOne]”。

尝试

```
- (void)viewWillAppear:(BOOL)animated
{
    [self performSelector:@selector(methodOne) 
           withObject:nil afterDelay:0];
} 
```

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2011-09-17T11:05:02.700

任何时候都应该只有 1 个 UIViewController 处于活动状态。您想要操作的任何子视图都应该正是那个 - subVIEWS - 即 UIView。

我使用一种简单的技术来管理我的视图层次结构，并且自从我开始以这种方式做事以来还没有遇到问题。有2个关键点：

*   应该使用单个 UIViewController 来管理应用程序的“屏幕价值”
*   使用 UINavigationController 更改视图

“屏幕的价值”是什么意思？故意有点模糊，但通常它是您应用程序的一个功能或部分。如果您有几个屏幕具有相同的背景图像但不同的覆盖/弹出窗口等，那应该是 1 个视图控制器和几个子视图。你永远不应该发现自己在使用 2 个视图控制器。请注意，如果您希望屏幕的某些区域显示在多个视图控制器中，您仍然可以在一个视图控制器中实例化 UIView 并将其添加为另一个视图控制器的子视图。

至于 UINavigationController - 这是你最好的朋友！关闭导航栏并将动画指定为 NO，您就有了一种按需切换屏幕的绝佳方式。如果视图控制器在层次结构中，您可以推送和弹出视图控制器，或者您可以准备视图控制器数组（包括包含单个 VC 的数组）并使用 setViewControllers 将其设置为视图堆栈。这使您可以完全自由地更改 VC，同时获得在 Apple 预期模型中工作和正确触发所有事件等的所有优势。

每次启动应用程序时，我都会这样做：

*   从基于窗口的应用程序开始
*   添加一个 UINavigationController 作为窗口的 rootViewController
*   添加任何我想要我的第一个 UIViewController 作为导航控制器的 rootViewController

（注意从基于窗口开始只是个人喜好 - 我喜欢自己构建东西，所以我确切地知道它们是如何构建的。它应该与基于视图的模板一起工作）

所有事件都正确触发，基本上生活是美好的。然后，您可以将所有时间都花在编写应用程序的重要部分上，而不是试图手动修改视图层次结构。

# javascript - 在 JavaScript 中，是否有以毫秒为单位的一致分辨率的时间来源？

> ID：131068
> 
> 赞同：5
> 
> 时间：2008-09-25T01:53:41.800
> 
> 标签：javascript, timer

JavaScript 中的 Date 对象在函数的分辨率（以毫秒为单位）方面执行不同的机器到机器和浏览器到浏览器。我发现大多数机器在 IE 上的分辨率约为 16 毫秒，而 Chrome 或 Firefox 的分辨率可能高达 1 毫秒。

JavaScript 或 IE 是否有其他功能可以提供更好的时间分辨率？我正在尝试以毫秒为单位捕获和记录`keyDown`时间`keyUp`，并且需要它在 +/- 10 毫秒或更短的范围内。

要查看这方面的说明，请查看此页面的“新日期（）的分辨率”部分。有一个带有测试按钮的表格，以毫秒为单位评估当前机器/浏览器的 JavaScript 时间分辨率。有趣的是，Chrome 经常获得 1ms 的分辨率。

[http://www.merlyn.demon.co.uk/js-dates.htm#OV](http://www.merlyn.demon.co.uk/js-dates.htm#OV)

我的任务是寻找一种 JavaScript 日期时间方法，该方法将在浏览器中提供低于 10 毫秒的分辨率。替换或改进 Date() 的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T03:05:56.043

由于您提到 Internet Explorer，我假设您在 Windows 上工作。您获得的 15 毫秒分辨率可能与 Windows 系统计时器分辨率有关。

我还注意到通过在 Windows 上运行 Java 程序，系统计时器的分辨率约为 16 毫秒左右。（使用`System.currentTimeMillis()`方法。）

我进行了相当多的搜索以查看是否可以在 Windows 中找到有关系统计时器分辨率的任何信息，并且能够从 TechNet找到到[Inside Windows NT High Resolution Timers的链接。](http://technet.microsoft.com/en-us/sysinternals/bb897569.aspx)它提到了一点关于Windows系统计时器的分辨率：

> Windows NT 的所有定时器支持都基于一个系统时钟中断，默认情况下以 10 毫秒的粒度运行。因此，这是标准 Windows 计时器的分辨率。

（我假设 Windows XP 和 Vista 仍然有相同的计时器，认为它是 NT 的后代。）

除非 Firefox 和 Chrome 实现了自己的高分辨率计时器，否则我相信您能够从 Windows 平台上的浏览器获得的最佳分辨率将是 10 毫秒左右。

虽然与这个问题无关，但我也确实在 MSDN 上找到了一篇关于 Windows 上的高分辨率计时器的文章：[mplement a Continuously Updating, High-Resolution Time Provider for Windows](http://msdn.microsoft.com/en-us/magazine/cc163996.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T03:52:48.410

台式机上的高分辨率计时仍然是一个开放的话题。

当今流行的操作系统只为您提供 10 毫秒的粒度，因为这是它们的时钟定时器中断的频率。例如，您还可以在 Linux 手册页中找到 10 ms。浏览器只会暴露操作系统提供的计时器，增加了浏览器内部的开销。

也就是说，可以实现更高的粒度。但是所有这些技术都是特定于硬件设置的，您不能期望它们在不久的将来会通过 JavaScript 公开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T02:53:23.420

AFAIK，毫秒和 JavaScript 一样好。这是[Date 对象的 Mozilla.org 文档](http://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Date)。那里没有任何东西表明分辨率更高。

# mysql - 使用 mysqldump 转储和加载 MySQL InnoDB 数据库的最快方法是什么？

> ID：131085
> 
> 赞同：13
> 
> 时间：2008-09-25T01:58:22.740
> 
> 标签：mysql, database, backup, innodb

我想使用 mysqldump 和 MySQL 5.1 创建一个包含大约 40 个 InnoDB 表和大约 1.5GB 数据的数据库副本。

什么是可以最快转储和加载数据的最佳参数（即：--single-transaction）？

同样，将数据加载到第二个数据库时，是否更快：

1) 将结果直接传送到第二个 MySQL 服务器实例并使用 --compress 选项

或者

2）从一个文本文件中加载它（即：mysql < mysql_dump.sql）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-12-08T02:17:34.610

## 快速转储静默数据库：

对 mysqldump 使用“-T”选项会在指定目录中生成大量 .sql 和 .txt 文件。转储大型表比使用 INSERT 语句的单个 .sql 文件快约 50%（减少 1/3 的挂钟时间）。

此外，如果您可以并行加载多个表并使多个核心饱和，则在恢复时会有巨大的好处。在 8 核机器上，除了“-T”提供的效率改进之外，恢复转储的挂钟时间可能相差 8 倍。因为“-T”会导致每个表存储在一个单独的文件中，所以并行加载它们比拆分一个庞大的 .sql 文件更容易。

将上述策略发挥到极致，可以创建一个脚本来并行广泛地转储数据库。嗯，这正是 Maakit mk-parallel-dump（参见[http://www.maatkit.org/doc/mk-parallel-dump.html](http://www.maatkit.org/doc/mk-parallel-dump.html)）和 mk-parallel-restore 工具的内容；对底层 mysqldump 程序进行多次调用的 perl 脚本。但是，当我尝试使用这些时，我很难在没有重复密钥错误的情况下完成还原，而这些错误在原版转储中不会发生，因此请记住，您的里程可能会有所不同。

## 从 LIVE 数据库转储数据（无服务中断）：

--single-transaction 开关对于转储实时数据库而无需停顿它或转储从数据库而无需停止从属数据库非常有用。

遗憾的是，-T 与 --single-transaction 不兼容，所以你只能得到一个。

通常，进行转储比恢复它要快得多。仍然有一个工具可以获取传入的整体转储文件并将其分成多个部分以并行加载。据我所知，这样的工具还不存在。

* * *

## 通过网络传输转储通常是一个胜利

要侦听一台主机上的传入转储，请运行：

```
nc -l 7878 > mysql-dump.sql 
```

然后在您的数据库主机上，运行

```
mysqldump $OPTS | nc myhost.mydomain.com 7878 
```

这减少了主机上磁盘轴的争用，将转储写入磁盘稍微加快了转储速度（假设网络速度足以跟上，对于同一数据中心中的两台主机来说这是一个相当安全的假设）。另外，如果您正在构建一个新的从站，这可以节省完成后必须传输转储文件的步骤。

注意事项 - 显然，您需要有足够的网络带宽才能让事情变得难以忍受，如果 TCP 会话中断，您必须从头开始，但对于大多数转储，这不是主要问题。

* * *

最后，我想澄清一点常见的困惑。

尽管您在 mysqldump 示例和教程中经常看到这些标志，但它们是多余的，因为它们默认打开：

*   `--opt`
*   `--add-drop-table`
*   `--add-locks`
*   `--create-options`
*   `--disable-keys`
*   `--extended-insert`
*   `--lock-tables`
*   `--quick`
*   `--set-charset`.

来自[http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)：

> --opt 的使用与指定 --add-drop-table、--add-locks、--create-options、--disable-keys、--extended-insert、--lock-tables、-- 相同快速和--set-charset。--opt 代表的所有选项也默认打开，因为 --opt 默认打开。

在这些行为中，“--quick”是最重要的行为之一（在传输第一行之前跳过在 mysqld 中缓存整个结果集），并且可以与“mysql”一起使用（默认情况下不会打开 --quick）显着加快返回大型结果集的查询（例如转储大表的所有行）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T02:10:17.597

将其直接通过管道传输到另一个实例，以避免磁盘开销。除非您在慢速网络上运行，否则不要打扰`--compress`，因为在快速 LAN 或环回上，网络开销无关紧要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T12:53:05.383

[我认为如果您尝试数据库复制](https://stackoverflow.com/questions/46545/how-do-i-do-backups-in-mysql#86079)而不是使用 mysqldump，它会更快并节省磁盘空间。我个人使用[sqlyog enterprise](http://www.webyog.com/en/downloads.php)来完成我真正繁重的工作，但还有许多[其他工具](https://stackoverflow.com/questions/40902/looking-for-mysql-ide#41381)可以提供相同的服务。当然，除非您只想使用 mysqldump。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-08T22:02:17.513

对于 innodb， --order-by-primary --extended-insert 通常是最好的组合。如果你的每一个最后一点性能和目标框有许多 CPU 内核，你可能想要拆分生成的转储文件并在多个线程中进行并行插入，最多为 innodb_thread_concurrency/2。

此外，将目标上的 innodb_buffer_pool_size 调整到您可以承受的最大值，并将 innodb_log_file_size 增加到 128 或 256 MB（注意这一点，您需要在重新启动 mysql 守护程序之前删除旧的日志文件，否则它不会重新启动）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-08T22:18:13.497

使用 Maatkit 的 mk-parallel-dump 工具。

至少那可能会更快。我会更信任mysqldump。

你多久做一次？这真的是应用程序性能问题吗？也许您应该设计一种不需要转储整个数据（复制？）

另一方面，1.5G 是一个很小的数据库，所以它可能不会有太大问题。

# svn - 将 svn 项目直接签入生产站点存在多大的安全风险？

> ID：131089
> 
> 赞同：4
> 
> 时间：2008-09-25T02:00:46.340
> 
> 标签：svn

并不是说我在做那样的事情，但我有点感兴趣这样的做法有多糟糕。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T02:13:12.893

我不一定对所涉及的安全风险发表评论，但它可能会让您处于未经审查/未经过充分测试的代码最终进入生产环境的境地。如果您正在考虑使用 svn 作为将源代码分发到不同环境（开发、测试、生产等）的方法，我建议您采用以下方法：

让树的一部分保持稳定（很可能是树枝），并让它成为该树枝的看门人的责任。所有对“稳定”的提交都必须通过它们，并且他们将负责确保在未经验证的情况下不会进入任何内容。如果没有人愿意做很长时间，这个职位可以每周或每月轮换一次。

此外，如果您只想定期从 subversion 到生产环境进行临时转储，则可以使用“svn export”命令。

最后，如果您需要做的只是结帐以设置生产环境，我猜这是 Web 开发。如果是这种情况，请确保运行 Web 服务器的用户对存储颠覆元数据的“.svn”目录没有读取权限。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T02:14:48.583

只要您的服务器禁止从网络访问所有 .svn 目录，就没有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T02:17:36.347

我根本不认为这是一种安全风险或不好的做法。这非常方便，当然我可能会在未来的项目中这样做。

例如，Capistrano（一种 Rails 自动化部署解决方案）是围绕将您的代码从 SVN 检出到生产服务器上而构建的。

您可以做一些愚蠢的事情，这可能会使其成为一种不好的做法，但它们都很容易缓解。例如：

1.  在没有密码保护的情况下将您的 svn 存储库暴露给网络 - 不要这样做！

2.  使用 http 而不是 https 公开您的 svn 存储库，因此嗅探您的流量的人可以获取您的密码 - 同样，不要这样做！只需通过 https 运行它。

3.  使用具有 svn 读/写访问权限的帐户检查您的代码。就我个人而言，我不会担心最后一步，就好像他们危及你的生产服务器你有更大的问题，你可以轻松地回滚他们可能尝试提交给 svn 的任何更改。如果你非常偏执，你可以创建一个只读的 svn 帐户用于生产结帐。

4.  检查你的主干到生产环境——如果你使用不稳定的主干运行，这只是一个问题，你可以只检查你的稳定分支/标签以进行部署。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T03:40:17.020

已经有一些很好的答案。但让我尝试以某种方式量化风险。

假设*2 个月前*，木马的风险小到可以接受。随之而来的是[Kaminsky 的 DNS](http://www.doxpara.com/)攻击，并且特洛伊木马的风险刚刚从理论上的主动攻击上升到“脚本小子”领域的某种东西。这是因为大多数公共颠覆项目要么使用 http，要么使用 https，它们不使用具有完整证书链的证书。然后，对手需要做的就是毒害 DNS 并克隆 SVN 服务器，并使用自己的木马。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T02:07:10.147

好吧，如果您要检查的这段代码是基线（稳定），我认为这不是什么大问题。

但是您当然应该标记代码，以便以后知道您放在那里的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T02:08:11.377

可能比来自测试服务器的副本更安全，至少您确定您获得了所有文件的正确版本并且所有文件都被复制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T02:11:15.783

如果我们谈论的是应用程序稳定性（或代码），那么在部署过程中总是存在风险。

但除此之外，如果您可以使用 https 而不是 http，那么安全风险是什么。或者你甚至使用 SSH 网关。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T02:23:40.263

这是我的做法：

## 假设：

*   单个根文件夹 ( *projectroot* )下的项目
*   版本控制下的所有文件

## 脚步

1 确保有“新”生产版本的标签
2 签出或导出该标签到文件夹*projectroot* .new
3 停止服务
4 重命名*projectroot* .old << *projectroot* << *projectroot* .new
5 重新启动服务
6 如果需要后退，反向步骤 4

## 推理

这是为了使实际的实现和回退步骤尽可能简单。您*可以*简单地使用 svn 开关，但是回退时的任何问题都可能使您的系统损坏。

显然这是最简单的情况——没有数据迁移，没有未版本化的配置文件，等等；但我认为关键是建立一个复制树然后交换给你一个干净清晰的切换和回退。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T03:29:49.807

我不一定喜欢直接签出存储库以进行部署的想法。具体来说，您是否需要将每个文件（如测试用例）部署到生产环境中？另外，您将来会生成任何代码吗？拥有一个构建要部署的发行版的构建系统可能会更好。

但是，代替任何这些决定，请确保记下正在同步的存储库的修订。这样，同步是可重现的，如果生产中出现无法重现的错误，您可以将本地存储库同步回与生产一致的状态。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-05T14:34:49.697

我发现使用 SVN 非常方便和可靠。我们制定了保持主干稳定并在分支中进行非关键更改的政策，这些更改随后在发布日期前不久合并到主干中。

它使发布就像为较小/不太复杂的项目执行“svn up”一样简单。简化部署使非开发人员（系统管理员、待命支持等）更容易在相关开发人员不可用的情况下快速恢复有问题的更改。如果新版本出现问题，只需回滚到最后一个已知的稳定副本即可。

我唯一真正关心的是 SVN 元数据的可见性。确保您已将 Web 服务器设置为拒绝访问 .svn 目录（以及其中包含的所有文件）。您可以使用 svn export 或删除 SVN 元数据作为发布过程的一部分： find 。-name .svn -print0 | xargs -0 rm -rf

您不希望有人浏览 www.example.com/.svn/entries 会泄露您的源代码存储库、用户名和文件。如果你做了诸如“passwords.conf”之类的愚蠢的事情，这对用户来说可能是可读的（取决于服务器配置），这尤其糟糕，当然，这并不是 SVN 的错。正如其他答案中提到的，您也不想使用 HTTP。

简而言之，只要您的元数据和 SVN 存储库是安全的，那么我认为没有缺点，只有好处。

# ssl - 带有自签名证书的 OpenID Over SSL

> ID：131091
> 
> 赞同：8
> 
> 时间：2008-09-25T02:01:14.683
> 
> 标签：ssl, openid, ssl-certificate

我在我的个人服务器上设置了自己的开放 ID 提供程序，并在我的 apache 配置文件中添加了到 https 的重定向。当不使用安全连接时（当我禁用重定向时）我可以正常登录，但使用重定向我无法登录并显示以下错误消息：

基础连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。

我猜这是因为我使用的是自签名证书。

谁能确认自签名证书是否是问题所在？如果没有，有人知道问题是什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T02:16:01.497

为您的 OpenID URL 使用 SSL 的主要好处是它为依赖方提供了一种机制来发现 DNS 是否已被篡改。依赖方无法判断带有自签名证书的 OpenID URL 是否已被盗用。

在提供商的端点 URL 上使用 SSL 还有其他好处（更容易建立关联，不会窃听扩展数据），如果您使用自签名证书，这些好处仍然存在，但我认为这些是次要的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-27T05:20:10.257

OpenID 以重定向透明的方式设计。只要通过 GET 或 POST 在每次重定向时保留必要的键/值对，一切都会正常运行。

与不使用自签名证书的消费者实现兼容性的最简单解决方案是使用非加密端点，该端点将消息重定向`checkid_immediate`和`checkid_setup`消息到加密端点。

在您的服务器代码中执行此操作比使用 Web 服务器重定向更容易，因为前者可以更轻松地处理 POST 请求，同时还可以将代码保持在一起。此外，您可以使用相同的端点来处理所有 OpenID 操作，无论是否应该通过 SSL 提供服务，只要进行了适当的检查。

例如，在 PHP 中，重定向可以很简单：

```
// Redirect OpenID authentication requests to https:// of same URL
// Assuming valid OpenID operation over GET
if (!isset($_SERVER['HTTPS']) &&
        ($_GET['openid_mode'] == 'checkid_immediate' ||
         $_GET['openid_mode'] == 'checkid_setup'))
    http_redirect("https://{$_SERVER['HTTP_HOST']}{$_SERVER['REQUEST_URI']}"); 
```

由于该`openid.return_to`值是针对普通 HTTP 端点生成的，因此就消费者而言，它仅处理未加密的服务器。假设 OpenID 2.0 使用会话和随机数进行正确操作，那么在消费者和您的服务器之间传递的任何信息都不应泄露可利用的信息。您的浏览器和 OpenID 服务器之间可利用的操作（密码窥探或会话 cookie 劫持）是通过加密通道完成的。

除了阻止窃听者外，通过 SSL 执行身份验证操作还允许您使用`secure`HTTP cookie 标志。`checkid_immediate`如果您希望允许，这会为操作增加另一层保护。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T15:30:41.463

（免责声明：我是 OpenID 的新手，所以我在这里可能是错的。） Open ID Consumer（例如 StackOverflow）和 Open ID Provider（您的服务器）之间的通信不需要 HTTPS——它可以像很好，就像在普通 HTTP 上一样安全。您需要做的是将您的服务器配置为仅在显示您的登录页面时才切换到 HTTPS。在这种情况下，只有您的浏览器需要关注自签名证书。您可以将证书导入您的 PC，一切都将与威瑞信颁发的证书一样安全。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T02:07:20.503

听起来像。您的 OpenID 服务器的客户端不信任根证书颁发机构。

# c# - 从 ASP.Net HTTPHandler - Page.Response 对象写入 cookie？

> ID：131110
> 
> 赞同：2
> 
> 时间：2008-09-25T02:09:35.117
> 
> 标签：c#, asp.net, cookies, asp.net-1.1

我正在创建一个 HTTP 处理程序，它侦听对特定文件类型的调用，并相应地处理它。我的 HTTP 处理程序侦听 .bcn 文件，然后将 cookie 写入用户的计算机并发回图像......这将用于广告横幅，以便将用户标记为看到横幅，然后我们可以提供特别优惠当他们稍后访问我们的网站时。

我遇到的问题是访问 Page 对象...当然 HTTPHandler 实际上不是页面，并且由于 Response 对象位于 Page 对象中，因此我无法访问它来编写 cookie。

有没有办法解决这个问题，还是我需要恢复到只使用标准的 aspx 页面来做到这一点？

谢谢堆..格雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T02:16:53.697

您可以从从 IHttpHandler 传递给 ProcessRequest 方法的 HttpContext 对象访问 Response 对象。这与 Page.Response 公开的对象相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T02:19:46.403

IHttpHandler 中定义的 ProcessRequest() 方法被传递了一个 HttpContext 引用。此 HttpContext 对象将具有一个名为 Response 和 Request 的属性，您可以使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T02:22:45.367

啊，是的...谢谢堆cKramer :)

工作代码是：

```
HttpContext.Current.Response.Cookies.Add(cookie); 
```

# api - 是否应该记录 API 的所有公共方法？

> ID：131115
> 
> 赞同：9
> 
> 时间：2008-09-25T02:10:21.403
> 
> 标签：api, coding-style, comments

在编写“库”类型类时，最好总是在 java 中编写标记文档（即 javadoc）还是假设代码可以是“自记录”的？例如，给定以下方法存根：

```
/**
 * Copies all readable bytes from the provided input stream to the provided output
 * stream.  The output stream will be flushed, but neither stream will be closed.
 *
 * @param inStream an InputStream from which to read bytes.
 * @param outStream an OutputStream to which to copy the read bytes.
 * @throws IOException if there are any errors reading or writing.
 */
public void copyStream(InputStream inStream, OutputStream outStream) throws IOException {
    // copy the stream
} 
```

javadoc 似乎是不言而喻的，如果功能发生变化，只需要更新噪音。但是关于冲洗而不关闭流的句子可能很有价值。

因此，在编写库时，最好：

a) 总是记录
b) 记录任何不明显的东西
c) 从不记录（代码应该自己说话！）

我通常使用 b)，我自己（因为代码可以是自记录的，否则）...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-25T02:12:18.993

a) 始终记录。

这将允许您使用自动化工具来生成基于 Web 的、基于纸张的等文档，这对于并不总是在他们面前的源代码的用户来说可能是无价的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T02:21:50.423

这就是我通常会附和“我小时候双向上坡”的口头禅，即只有当你的老板要求你记录时才记录......最近我改变了我的态度。我认为当你在处理一个开源项目、一个通常被调用的库或者提前知道其他人必须与你提供的接口密切合作时，提供每个公共​​方法的完整文档是*至关重要*的.

文档有助于编写可维护的代码，但是，就像任何事情一样，当您应该致力于添加功能并让单元测试通过时，您可以过度使用它并花时间编写评论、POD 和 wiki。这在[敏捷宣言](http://en.wikipedia.org/wiki/Agile_software_development#Principles_behind_agile_methods_.E2.80.94_The_Agile_Manifesto)中得到了解决（即：面对面的交流比文档更好，等等接口方法的阶梯）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T02:37:23.757

特别是对于 API，确实应该记录每个公共方法（和字段）。此外，该方法的文档应该足够清晰和信息丰富，以使可用信息不会产生歧义。

API 的一个很好的例子是[Java API 规范](http://java.sun.com/javase/6/docs/api/)。从文档的标题中可以看出它是一个*规范*。我认为文档应该足够彻底，可以将其视为规范。

在大多数情况下，我认为 Java API 规范是一个很好的例子，但是，我注意到有些部分没有很好的文档和/或信息。以[`DropTarget`](http://java.sun.com/javase/6/docs/api/java/awt/dnd/DropTarget.html)班级为例。它有一个名为 的方法[`clearAutoscroll()`](http://java.sun.com/javase/6/docs/api/java/awt/dnd/DropTarget.html#clearAutoscroll())，该方法的 javadoc 是：

> **`clearAutoscroll`**
> 
> `protected void clearAutoscroll()`
> 
> ```
> clear autoscrolling 
> ```

没有什么比这样无信息的 API 文档更令人沮丧的了。最糟糕的是，提供的信息甚至不是一句话！确保为所有公共领域和方法提供的文档提供了足够的信息，以使图书馆的用户最终不会被激怒而不是被告知。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T02:31:59.040

一个）

正如其他人所提到的，您可以生成文档并有助于维护。

此外，Intellisense 受益于告诉方法/属性做什么/是什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T02:48:18.597

所以，我的观点是，如果你正在开发一个 API 供其他人使用，应该清楚每个方法、属性等的意图。

我应该能够看一个方法并知道：

*   它返回什么，如果有的话，如果该返回值是在一个特定的单位（英尺，米，度等），那么它应该是清楚的。用户必须猜测您的方法是返回摄氏度还是华氏度还是开尔文。
*   它需要什么参数以及它们所在的单位（如果有的话）
*   方法的目的以及这些参数和返回值的范围，如果有意义的话
*   其他任何对读者来说不明显的东西

作为许多 API 的用户，我见过好的、坏的和丑陋的。作为许多人的作者，我很早就吸取了教训，即在提供接口时不够清晰和具体，尤其是当我不得不使用几年前编写的库并且必须深入研究代码以确定我的确切内容时写的时候在想。

我不认为你需要过分关注文档并认为精心挑选的方法、参数名称等对可读性有很大帮助。但是当你编写一个方法时，只需要几秒钟——也许最多一分钟——来记录它。我看不出有什么令人信服的理由不让公共界面清晰明了，并在需要的地方记录下来。也许如果它是一个“一次性”图书馆......但我不会写太多这些。

只是我的两分钱。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T02:11:43.193

我想说的是，当一个迟钝的人正在审查或修改您的代码时，没有什么可以解释的，即使没有文档，您也认为它非常清楚。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T02:13:37.073

我选择 a，纯粹是因为当我研究一个类时，我喜欢查看记录在案的公共方法（在 javadoc 或类似中）。它使一些事情变得更加清晰。但各有各的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T02:25:53.300

一个）

如果它是一种方法，那么总会有一些重要的小细节，例如您提供的有关刷新和关闭流的细节。例如，方法“String getFileExtension(String filename)”似乎不需要文档，但如果“filename”没有扩展名怎么办？该答案应记录在案。

如果它是一个类型，它应该提到它与之协作的其他类型，以及它是如何做到的。这有助于用户以您想要的方式浏览文档，而不仅仅是在没有任何方向的情况下浏览文档。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T02:35:14.120

一个）

预先完整文档的另一个好处是有助于防止方法行为随着时间的推移而发生变化。在示例中，您引用了有关刷新而不关闭流的句子可能很有价值-我想说这种详细程度是该方法的用户需要知道的基本语义。如果这没有记录在案，那么 API 的后续实现可能不会执行刷新，这可能会导致该方法的用户出现不可预测的结果。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-25T05:02:01.537

任何可公开访问的内容，无论是方法、字段、常量还是您拥有的东西，都应记录到用户或开发人员（这是一个包容性或顺便说一句）将能够在几年后出现并拥有所有内容的程度他们需要使用文档化对象的信息。记录使用的先决条件、目的、抛出的任何东西以及使用后的变化。

明确而具体，不要留下任何猜测。如果您愿意，请向与您的项目无关的人展示您正在记录的内容的声明，并询问他们是否缺少任何内容。做笔记，并确保他们的担忧被覆盖。

Tout le monde 说代码应该是足够好的文档，但这是一个神话。不是每个人都能看到代码，或者意识到你在其中使用了哪些巧妙的技巧。因此，记录其他人可能看到的所有内容，甚至是他们不会看到的内容。几年后，您的用户、开发人员和您自己都会感谢您。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T14:29:46.850

始终记录。

对您来说显而易见的事情对其他人可能并不明显，尤其是当他们从不同的角度看待情况时（非编码人员、初学者、不熟悉您的语言结构的用户）

也是为了文档的完整性。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-29T00:16:43.910

对不起鹦鹉，但总是记录。

始终记录，甚至是您的私人功能。我已经忘记了好几次我所知道的一切。但一开始我评论了一切，所以至少这很容易再次弄清楚。当我创建一些小型库时，我记录了我所在团队的所有功能，而没有我做的一些笔记，内部工作将完全无法破译。

我编写了非常复杂的代码，以至于我的队友都无法理解。没有人认为它草率或不雅，但在详细解释（需要几个小时）之前，没有人能遵循逻辑。在我在纸上写过一次之后，这对我来说似乎是显而易见的答案，但在这一点上，我的逻辑对其他人来说是陌生的。

所以我扫描了论文，记录了我的所有功能，列出了所有需要的输入格式，并写了一份关于应用程序应该如何完成其​​任务的附加文档。3 年多来我辞掉了更多的工作，当他们需要特定的东西时（最近一次是 6 个月前），我仍然会谈论那个软件。它不到一个 Kloc（1000 行代码），但它仍然足够复杂，足以在 2 年半后提出问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T02:15:19.317

*每个*公共方法都应记录在案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-11T07:34:47.583

b) 记录所有不明显或有疑问的内容。在这种情况下：

```
/** Copies all readable bytes from inStream to outStream. outStream will be flushed, 
 *  but neither stream will be closed.
 */ 
```

您已经写过 inStream 是一个 InputStream，并且您不必指定它要在自己的注释中读取字节，因为您已经在函数的注释中这样做了

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-11T07:46:14.547

仅记录您希望人们能够使用并有效使用的方法。

# sql-server - 您多久更新一次 SQL Server 2000 中的统计信息？

> ID：131116
> 
> 赞同：4
> 
> 时间：2008-09-25T02:10:49.887
> 
> 标签：sql-server, tsql

我想知道更新统计数据之前是否对您有所帮助，您怎么知道要更新它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T02:30:38.233

```
exec sp_updatestats 
```

是的，如果您发现查询没有达到应有的效果，更新统计信息会非常有用。这可以通过检查查询计划并注意何时执行表扫描或索引扫描而不是索引查找来证明。所有这些都假定您已正确设置索引。

还有[UPDATE STATISTICS](http://doc.ddart.net/mssql/sql70/ua-uz_4.htm)命令，但我个人从未使用过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T02:30:57.063

将统计信息更新添加到维护计划（如在企业管理器定义的维护计划中）是很常见的。这样它就会按计划进行——每天、每周等等。

SQL Server 2000 使用统计信息来做出有关查询执行的正确决策，因此它们肯定会有所帮助。

最好同时重建索引（DBCC DBREINDEX 和 DBCC INDEXDEFRAG）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T07:49:24.783

If you rebuild indexes, then the statistics for those indexes are automatically rebuilt. If your timeframes allow, then running UPDATE STATISTICS of part of a maintenance plan is a good idea, as frequently as nightly (if your indexes are being rebuilt less frequently than that).

SQL Server: To determine if out of date statistics are the cause of a query performing poorly, turn on 'Query->Display Estimated Execution plan' (CTRL-L) in Management Studio and run the query. Open another window, paste in the same query and turn on 'Query->Display ActualExecution plan' (CTRL-M) in Management Studio and re-run the query. If the execution plans are different then statistics are most likely out of date.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T07:42:14.567

发生以下事件后需要更新统计信息：
- 记录被插入到您的表中
- 记录被从您的表中删除
- 记录在您的表中被更新

如果您有一个包含数百万条记录的大型数据库，每天有大量写入，您可能应该确定一个非高峰时间来安排索引更新。

此外，您需要考虑您的流量类型。如果表中有很多（数百万）条记录，并且具有许多外键依赖项，并且写入读取的比例较大，您可能需要考虑关闭自动统计重新计算（注意：此功能将在未来版本中删除SQL Server，但对于 SQL Server 2000，你应该没问题）。这告诉引擎不要重新计算每个 INSERT、DELETE 或 UPDATE 的统计信息，并使这些操作的性能更高。

索引不是笑话。它们是高性能数据库的核心和灵魂。

# interface-design - 什么是好的系统接口规范模板？

> ID：131117
> 
> 赞同：1
> 
> 时间：2008-09-25T02:10:57.390
> 
> 标签：interface-design

客户有许多不同的系统，他们计划将它们链接在一起，并要求提供一组系统接口规范，这些规范将记录用于连接不同部分的数据和协议。

接口是在进程之间而不是在用户之间。

对于我们可以用来记录系统接口的模板有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T09:02:44.967

这本书可能有您正在寻找的那种指导：[企业集成模式：设计、构建和部署消息传递解决方案](https://rads.stackoverflow.com/amzn/click/com/0321200683)

# vba - 如何在 Excel VBA 中获取包含工作表名称但不包括工作簿名称的范围地址？

> ID：131121
> 
> 赞同：40
> 
> 时间：2008-09-25T02:11:34.690
> 
> 标签：vba, excel

如果我有一个 Range 对象——例如，假设它指的`A1`是工作表上名为`Book1`. 所以我知道打电话`Address()` 会给我一个简单的本地参考：`$A$1`. 我知道它也可以被称为`Address(External:=True)`获取参考，包括工作簿名称和工作表名称：`[Book1]Sheet1!$A$1`.

我想要的是获得一个包含工作表名称的地址，而不是书名。我真的不想打电话`Address(External:=True)`并尝试用字符串函数自己删除工作簿名称。我可以在范围内拨打电话`Sheet1!$A$1`吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-09-25T02:23:32.290

我能想到的唯一方法是将工作表名称与单元格引用连接起来，如下所示：

```
Dim cell As Range
Dim cellAddress As String
Set cell = ThisWorkbook.Worksheets(1).Cells(1, 1)
cellAddress = cell.Parent.Name & "!" & cell.Address(External:=False) 
```

编辑：

将最后一行修改为：

```
cellAddress = "'" & cell.Parent.Name & "'!" & cell.Address(External:=False) 
```

如果您希望它在工作表名称中有空格或其他有趣字符的情况下也能正常工作。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-07-30T18:43:56.083

```
Split(cell.address(External:=True), "]")(1) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T02:36:11.323

本是对的。我也想不出任何办法来做到这一点。我建议使用 Ben 推荐的方法或以下方法来去除 Workbook 名称。

```
Dim cell As Range
Dim address As String
Set cell = Worksheets(1).Cells.Range("A1")
address = cell.address(External:=True)
address = Right(address, Len(address) - InStr(1, address, "]")) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-12T13:08:47.293

工作表`Address()`功能正是这样做的。由于无法通过 获得`Application.WorksheetFunction`，因此我想出了使用该`Evaluate()`方法的解决方案。

这个解决方案让 Excel 处理工作表名称中的空格和其他有趣的字符，这比以前的答案有一个很好的优势。

例子：

```
Evaluate("ADDRESS(" & rng.Row & "," & rng.Column & ",1,1,""" & _
    rng.Worksheet.Name & """)") 
```

准确返回“Sheet1!$A$1”，其中一个`Range`对象命名`rng`为 Sheet1 工作表中的 A1 单元格。

此解决方案仅返回范围的第一个单元格的地址，而不是整个范围的地址（“Sheet1！$A$1”与“Sheet1！$A$1:$B$2”）。所以我在自定义函数中使用它：

```
Public Function AddressEx(rng As Range) As String

    Dim strTmp As String

    strTmp = Evaluate("ADDRESS(" & rng.Row & "," & _
        rng.Column & ",1,1,""" & rng.Worksheet.Name & """)")

    If (rng.Count > 1) Then

        strTmp = strTmp & ":" & rng.Cells(rng.Count) _
            .Address(RowAbsolute:=True, ColumnAbsolute:=True)

    End If

    AddressEx = strTmp

End Function 
```

Address() 工作表函数的完整文档可在 Office 网站上找到：https: [//support.office.com/en-us/article/ADDRESS-function-D0C26C0D-3991-446B-8DE4-AB46431D4F89](https://support.office.com/en-us/article/ADDRESS-function-D0C26C0D-3991-446B-8DE4-AB46431D4F89)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-09T00:02:03.810

我发现以下内容在我创建的用户定义函数中对我有用。我将单元格区域引用和工作表名称连接为字符串，然后在 Evaluate 语句中使用（我在 Sumproduct 上使用 Evaluate）。

例如：

```
Function SumRange(RangeName as range)   

Dim strCellRef, strSheetName, strRngName As String

strCellRef = RangeName.Address                 
strSheetName = RangeName.Worksheet.Name & "!" 
strRngName = strSheetName & strCellRef 
```

然后在其余代码中引用 strRngName。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-19T13:29:42.220

您可能需要编写代码来处理具有多个区域的范围，这样做：

```
Public Function GetAddressWithSheetname(Range As Range, Optional blnBuildAddressForNamedRangeValue As Boolean = False) As String

    Const Seperator As String = ","

    Dim WorksheetName As String
    Dim TheAddress As String
    Dim Areas As Areas
    Dim Area As Range

    WorksheetName = "'" & Range.Worksheet.Name & "'"

    For Each Area In Range.Areas
'           ='Sheet 1'!$H$8:$H$15,'Sheet 1'!$C$12:$J$12
        TheAddress = TheAddress & WorksheetName & "!" & Area.Address(External:=False) & Seperator

    Next Area

    GetAddressWithSheetname = Left(TheAddress, Len(TheAddress) - Len(Seperator))

    If blnBuildAddressForNamedRangeValue Then
        GetAddressWithSheetname = "=" & GetAddressWithSheetname
    End If

End Function 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-13T07:12:02.020

```
rngYourRange.Address(,,,TRUE) 
```

显示外部地址、完整地址

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-07-07T00:05:28.933

为什么不只返回带有 **地址 = cell.Worksheet.Name**的工作表名称， 然后您可以像这样将地址连接回来 **address = cell.Worksheet.Name & "!" & 单元格.地址**

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-03-25T11:48:57.807

```
Dim rg As Range
Set rg = Range("A1:E10")
Dim i As Integer
For i = 1 To rg.Rows.Count

    For j = 1 To rg.Columns.Count
    rg.Cells(i, j).Value = rg.Cells(i, j).Address(False, False)

    Next
Next 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-01-13T05:33:21.077

对于困惑的老我来说，一个范围

.Address(False, False, , True)

seems to give in format TheSheet!B4:K9

If it does not why the criteria .. avoid Str functons

will probably only take less a millisecond and use 153 already used electrons

about 0.3 Microsec

RaAdd=mid(RaAdd,instr(raadd,"]") +1)

or

'about 1.7 microsec

RaAdd= split(radd,"]")(1)

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-03-27T04:58:40.717

[2009-04-21 编辑]

*    正如 Micah 指出的那样，这仅在您命名了该
    特定范围时才有效（因此。命名任何人？）是的，哎呀！*

[/编辑]

我知道聚会有点晚了，但如果其他人在谷歌搜索中发现了这个（就像我刚刚做的那样），你也可以尝试以下方法：

```
Dim cell as Range
Dim address as String
Set cell = Sheet1.Range("A1")
address = cell.Name 
```

这应该返回完整的地址，例如“=Sheet1!$A$1”。

假设您不想要等号，您可以使用 Replace 函数将其删除：

```
address = Replace(address, "=", "") 
```

# windows - 在 DLL 中使用 cpu 特定功能有哪些标准技术？

> ID：131128
> 
> 赞同：4
> 
> 时间：2008-09-25T02:12:59.883
> 
> 标签：windows, optimization, dll

简短版本：我想知道在 DLL 中利用 CPU 特定指令是否可能，以及如何最好？

稍长的版本：当从微软下载（32 位）DLL 时，似乎一种尺寸适合所有处理器。

这是否意味着它们严格按照最低公分母（即操作系统支持的最低平台）构建？或者是否有一些技术用于在 DLL 中导出单个接口，但在幕后利用 CPU 特定代码来获得最佳性能？如果是这样，它是如何完成的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T02:42:49.843

我不知道任何*标准*技术，但如果我不得不做这样的事情，我会在 DllMain() 函数中编写一些代码来检测 CPU 类型并使用指向每个 CPU 优化版本的函数指针填充跳转表功能。

当 CPU 类型未知时，还需要一个最小公分母函数。

您可以在此处的注册表中找到当前 CPU 信息：

```
HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\CentralProcessor 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T02:41:54.243

该 DLL 预计可以在每台运行 WIN32 的计算机上运行，​​因此您通常只能使用 i386 指令集。没有公开特定指令集的功能/代码的官方方法。您必须手动透明地进行操作。

使用的技术基本上如下： - 在运行时确定 CPU 特性，如 MMX、SSE - 如果它们存在，则使用它们，如果不存在，则准备好后备代码

因为您不能让编译器针对 i386 以外的任何东西进行优化，所以您必须使用内联汇编器中的特定指令集编写代码。我不知道是否有用于此的高级语言工具包。确定 CPU 功能很简单，但也可能需要在汇编程序中完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T03:02:12.777

获得 SSE/SSE2 优化的一种简单方法是仅使用`/arch`MSVC 的参数。我不会担心回退——除非你有一个非常小众的应用程序，否则没有理由支持低于此的任何内容。

[http://msdn.microsoft.com/en-us/library/7t5yh4fd.aspx](http://msdn.microsoft.com/en-us/library/7t5yh4fd.aspx)

我相信 gcc/g++ 有等效的标志。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T04:33:33.820

您从 Microsoft 下载的 DLL 是针对通用 x86 架构的，原因很简单，因为它必须在所有大量机器上工作。

直到 Visual Studio 6.0 的时间框架（我不知道它是否已经改变），Microsoft 习惯于优化其 DLL 的大小而不是速度。这是因为 DLL 整体大小的减小提供了比编译器可以生成的任何其他优化更高的性能提升。这是因为与不让 CPU 等待内存的速度相比，微优化带来的速度提升明显较低。真正的速度改进来自于减少 I/O 或改进基本算法。

只有少数运行在程序核心的关键循环可以从微优化中受益，这仅仅是因为它们被调用的次数很多。只有大约 5-10% 的代码可能属于这一类。您可以放心，Microsoft 软件工程师已经在汇编程序中对此类关键循环进行了某种程度的优化，并且不会留下太多内容供编译器查找。（我知道它期待太多，但我希望他们这样做）

正如您所看到的，增加的 DLL 代码只有一些缺点，其中包括针对不同体系结构调整的其他代码版本，而这些代码中的大部分很少使用/绝不是消耗大部分 CPU 周期的关键代码的一部分.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T11:01:27.537

英特尔的 ICC 可以针对不同的架构编译代码两次。这样，你就可以吃蛋糕了。（好的，你得到两个蛋糕 - 你的 DLL 会更大）。甚至 MSVC2005 也可以在非常特殊的情况下做到这一点（例如 memcpy() 可以使用 SSE4）

有很多方法可以在不同版本之间切换。加载一个 DLL，因为加载过程需要来自它的函数。函数名称被转换为地址。一种解决方案是让此查找不仅取决于函数名称，还取决于处理器特性。另一种方法是使用名称到地址函数在中间步骤中使用指针表这一事实。您可以切换出整个表。或者你甚至可以在关键函数中建立一个分支；所以 foo() 在更快的时候调用 foo__sse4 。

# java - 使用 MySQL 4.1.x + Connector/J 流式传输大型结果集

> ID：131139
> 
> 赞同：1
> 
> 时间：2008-09-25T02:17:25.520
> 
> 标签：java, mysql

我正在尝试让大量结果集流式传输并且没有运气。[MySQL 文档](https://dev.mysql.com/doc/connector-j/5.1/en/connector-j-reference-implementation-notes.html)对于这是否应该起作用有些不清楚。例如：

> 当使用早于 3.2.1 的 JDBC 驱动程序版本并连接到早于 5.0.3 的服务器版本时，`setFetchSize()` 方法没有任何作用，除了如上所述切换结果集流。

我正在使用 MySQL 4.1.19 和 Connector/J 5.1.6。我的代码基本上是：

```
stmt = conn.createStatement(java.sql.ResultSet.TYPE_FORWARD_ONLY, java.sql.ResultSet.CONCUR_READ_ONLY);
stmt.setFetchSize(Integer.MIN_VALUE);
stmt.executeQuery(“select * from huge_table”); 
```

MySQL 4.1.x 是否可以流式传输结果集？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T05:03:51.860

您正在寻找的内容在 MySQL 术语中称为“无缓冲查询”，但快速搜索似乎表明：

*   MySQL 仅从 5.0 版本开始支持
*   JDBC 不支持

# oracle - 用于数据库对象代码生成的资源

> ID：131142
> 
> 赞同：5
> 
> 时间：2008-09-25T02:18:31.477
> 
> 标签：oracle, resources, code-generation, data-access

我正在做一个项目，我需要生成一系列类来表示/访问数据库中的数据。第三方项目（例如休眠或亚音速）不是一种选择。我是这个主题领域的新手，所以我正在寻找有关该主题的信息。该项目位于 .net 中，我正在使用 MyGeneration。我主要是在寻找信息。

**对于数据访问的代码生成主题，您最好的资源是什么？**

请一次只发布一个链接，并在发布前寻找您的资源。如果你找到你的资源，请投票而不是发布它。. （我对代表不感兴趣，只是信息）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T02:23:29.903

你在使用.NET吗？试试我[的世代](http://www.mygenerationsoftware.com/portal/default.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T02:23:51.213

[代码史密斯](http://www.codesmithtools.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T03:40:45.320

ORAPig 为 Oracle 包生成 Python 接口。一个 Postgresql 模块正在开发中。

[http://code.google.com/p/orapig](http://code.google.com/p/orapig)

# sql - Oracle 通过 Select 从多个表中插入，其中一个表可能没有一行

> ID：131164
> 
> 赞同：13
> 
> 时间：2008-09-25T02:27:12.360
> 
> 标签：sql, oracle, select, insert

我有许多代码值表，其中包含一个代码和一个带有 Long id 的描述。

我现在想为引用许多代码的帐户类型创建一个条目，所以我有这样的东西：

```
insert into account_type_standard (account_type_Standard_id,
tax_status_id, recipient_id)
( select account_type_standard_seq.nextval,
ts.tax_status_id, r.recipient_id
from tax_status ts, recipient r
where ts.tax_status_code = ?
and r.recipient_code = ?) 
```

如果为它们各自的代码找到匹配项，这将从 tax_status 和收件人表中检索适当的值。不幸的是，recipient_code 可以为空，因此 ? 替换值可以为空。当然，隐式连接不会返回一行，因此不会将一行插入到我的表中。

我试过在 ? 在 r.recipient_id 上。

我试图在 r.recipient_code = 上强制外部连接？通过添加 (+)，但它不是显式连接，因此 Oracle 仍然没有添加另一行。

有人知道这样做的方法吗？

我显然可以修改语句，以便我在外部查找接收者 ID，并有一个 ? 而不是 r.recipient_id，并且根本不从收件人表中选择，但我更愿意在 1 个 SQL 语句中完成所有这些操作。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-25T02:35:51.467

在这种情况下，外部联接不会“按预期”工作，因为您已明确告诉 Oracle，如果该表上的条件匹配，您只需要数据。在这种情况下，外部连接将变得无用。

一种解决方法

```
INSERT INTO account_type_standard 
  (account_type_Standard_id, tax_status_id, recipient_id) 
VALUES( 
  (SELECT account_type_standard_seq.nextval FROM DUAL),
  (SELECT tax_status_id FROM tax_status WHERE tax_status_code = ?), 
  (SELECT recipient_id FROM recipient WHERE recipient_code = ?)
) 
```

[编辑] 如果您希望子选择中有多个行，您可以将 ROWNUM=1 添加到每个 where 子句或使用聚合，例如 MAX 或 MIN。当然，这可能不是所有情况的最佳解决方案。

[编辑] 根据评论，

```
 (SELECT account_type_standard_seq.nextval FROM DUAL), 
```

可以只是

```
 account_type_standard_seq.nextval, 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-26T10:42:40.833

Oglester 解决方案的略微简化版本（该序列不需要从 DUAL 中进行选择：

```
INSERT INTO account_type_standard   
  (account_type_Standard_id, tax_status_id, recipient_id) 
VALUES(   
  account_type_standard_seq.nextval,
  (SELECT tax_status_id FROM tax_status WHERE tax_status_code = ?),
  (SELECT recipient_id FROM recipient WHERE recipient_code = ?)
) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T05:05:08.860

我不清楚 ts.tax_status_code 是主键还是备用键。与收件人代码相同。知道这将很有用。

您可以使用 OR 来处理绑定变量为 null 的可能性，如下所示。您会将相同的东西绑定到前两个绑定变量。

如果您关心性能，您最好检查您打算绑定的值是否为空，然后发出不同的 SQL 语句以避免 OR。

```
insert into account_type_standard 
(account_type_Standard_id, tax_status_id, recipient_id)
(
select 
   account_type_standard_seq.nextval,
   ts.tax_status_id, 
   r.recipient_id
from tax_status ts, recipient r
where (ts.tax_status_code = ? OR (ts.tax_status_code IS NULL and ? IS NULL))
and (r.recipient_code = ? OR (r.recipient_code IS NULL and ? IS NULL)) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T11:22:15.833

尝试：

```
insert into account_type_standard (account_type_Standard_id, tax_status_id, recipient_id)
select account_type_standard_seq.nextval,
       ts.tax_status_id, 
       ( select r.recipient_id
         from recipient r
         where r.recipient_code = ?
       )
from tax_status ts
where ts.tax_status_code = ? 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-28T09:00:30.577

```
insert into account_type_standard (account_type_Standard_id, tax_status_id, recipient_id)
select account_type_standard_seq.nextval,
   ts.tax_status_id, 
   ( select r.recipient_id
     from recipient r
     where r.recipient_code = ?
   )
from tax_status ts
where ts.tax_status_code = ? 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-05-20T08:38:50.083

```
insert into received_messages(id, content, status)
    values (RECEIVED_MESSAGES_SEQ.NEXT_VAL, empty_blob(), ''); 
```

# computer-science - 进化算法：最优再增殖分解

> ID：131165
> 
> 赞同：9
> 
> 时间：2008-09-25T02:29:04.603
> 
> 标签：computer-science, artificial-intelligence, genetic-algorithm, genetic-programming, evolutionary-algorithm

它真的在标题中，但对于任何对进化算法感兴趣的人来说，这里有一个细分：

在 EA 中，基本前提是您随机生成一定数量的生物体（实际上只是一组参数），针对某个问题运行它们，然后让表现最好的人存活下来。

然后你用幸存者的杂交种、幸存者的突变以及一定数量的新随机生物重新填充。

这样做几千次，高效的有机体就会出现。

有些人还做一些事情，比如引入多个生物“岛”，它们是允许偶尔杂交的独立种群。

所以，我的问题是：最佳的重新填充百分比是多少？

我一直保持前 10% 的表现，并重新填充 30% 的杂交和 30% 的突变。剩下的 30% 用于新生物。

我也尝试了多岛理论，我也对你的结果感兴趣。

我并没有忘记这正是 EA 可以解决的问题类型。你知道有人在尝试吗？

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T02:37:44.970

我遇到的关于 GA 和 EA 的最佳资源是 John Koza 关于[遗传编程](http://www.genetic-programming.com/)的书籍。他深入探讨了这个主题——编码基因组、随机突变、育种、调整适应度函数的技术。

就我个人而言，我只写了一小部分用于教学目的的模拟器。我发现我如何调整这些百分比与我使用的适应度函数的细节、我引入了多少随机突变以及我尝试进行突变和繁殖的“聪明”程度有关——我发现越少'聪明的'我试图使突变器和交叉逻辑，种群提高其适应度得分的速度越快——我还发现我在突变的概率上过于保守——我的初始运行达到了局部最大值并且有一个很难摆脱他们。

这些都没有给你具体的答案，但我认为没有具体的答案，GA 本质上是不可预测的，调整这些参数可能仍然是一门艺术。当然，您总是可以尝试使用元遗传算法，将这些参数用作染色体，搜索在您正在运行的基本遗传算法中产生更快适应度的设置。

取决于您想要获得的“元”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T02:49:25.893

我最初试图对我认为的有机系统进行建模。最终认为这不好，并且变得更加激进，10% 保留，20% 变异，60% 杂交，10% 随机。

然后我注意到我的前 10% 都大致相同。所以我将随机数增加到 30%。这对一些人有所帮助，但帮助不大。

我确实尝试了多岛、跨代和重新播种，这给出了更好的结果，但仍然非常不令人满意，前 10% 的变化非常小，疯狂的世代数以获得任何结果。大多数情况下，代码学会了如何破解我的健身评估。

获得表现最好的人真的很容易，所以不要担心保留太多他们。杂交有助于减少正面和负面的特征，所以它们很有用，但你真正想要的是很多好的随机繁殖。专注于突变和新随机以引入特征，让杂交和表现最好的人只需跟踪最好的并更慢地改进它们。IE：基于上一代的东西只是找到更好的局部最大值，随机数找到更好的全局最大值。

我仍然相信通过观察自然现象可以找到您问题的最佳答案，例如在最近一篇关于果蝇飞行路径随机性的文章中，因此可能会成功。

可能最好的答案是运行它并对其进行调整，不要害怕对其进行大量调整，人口很强大。确保您实施了一种保存和继续的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T02:39:18.243

这是一个备受争议的（在文学和[Melanie 等人的书籍中](http://mitpress.mit.edu/catalog/item/default.asp?tid=5974&ttype=2)）主题，似乎是非常特定领域的。适用于具有 n 个参数的一种类型的问题几乎不会适用于另一个问题、另一个域或另一个参数集。

因此，正如 TraumaPony 建议的那样，针对您要解决的每个问题自行调整它，或者编写一些东西来为您优化它。您可以做的最好的事情是跟踪您所有的“旋钮旋转”和微调实验，以便您可以绘制出解决方案的地形并了解如何在该空间内快速优化。还可以尝试其他技术，如爬山，这样你就可以有一个可以击败的基线。

@Kyle Burton：在移交给 GA 和 GP 的每一类问题中，交叉率与突变率也在[不断争论。](http://www.springerlink.com/content/kptgd4gr8ffb4ph1/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T02:43:17.343

假设您有一种方法可以量化前 X% 的执行者，我建议您不要使用硬编码阈值来分析性能分布，并将您的截止值设置在性能第一次主要下降的范围内，然后调整你的杂交、突变和新的有机体来填补空白。这样，如果你有一个非常“富有成效”的运行，其中很多变化都成功了，你就不会抛出大量的高绩效者。此外，如果你有一个“非生产性”的运行，你可以废弃更多现有的有机体，以支持更多应该取代它们的新有机体。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T14:48:52.427

通过设置来自亲本染色体的几个基因的突变和交叉，我在增加种群多样性方面取得了一些成功。

这一直有效，直到突变率降至零；因为这样做可能会有周期性的进化压力，你应该尝试确保这些基因具有最低速率。

在实践中，我选择了多染色体基因型。一条染色体编码另一条的生殖功能。较小的“繁殖染色体”具有合理的固定突变率和交叉率。

我发现这将阻止经典的高原和人口趋同。

顺便说一句，我倾向于为每个孩子做交叉和突变。

对于世代相传的 GA，我试图完全避开精英主义，但在来自多个岛屿的人口众多的情况下，我会保留每个岛屿的顶级精英。当岛屿聚集在一起时，精英就可以一起繁殖。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T13:15:40.770

似乎有一些答案建议使用 2nd GA 来确定 1st GA 的最佳参数，而没有提及如何确定 2nd 的最佳参数。我不禁想知道那些建议这种方法的人的宗教信仰......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-11-03T19:36:49.637

正如其他人所提到的，最佳组合将取决于您的特定问题和其他特定问题的因素，例如解决方案空间的大小。

在我们讨论从一代到下一代的进化分解之前，重要的是要考虑每一代的规模。一般来说，我的方法是从相当大的群体（约 100k-500k 个体）开始，这些个体相当多样化，这是 Koza 在他的一些工作中提出的建议。为了从一开始就获得这种多样性，您可以将解决方案空间划分为桶，然后确保至少有一定数量的个体落入每个桶中。（例如，如果您有每个人的树表示，请确保创建相同数量的深度 2、3、...、max_depth）

至于您的实际问题，没有明确的方法来解决它，但根据您的问题，您可能想要强调随机性或淡化它。当你想强调它时，你应该保持较少的个体完整，并引入更多数量的新随机个体。如果您的解决方案空间中有许多局部最大值并且您希望进行更广泛的搜索，您通常希望这样做。

当您获得故障时，需要考虑一些事情......首先，重复（在顶部近亲繁殖中有很多相同或新近相同的个体）。为了减少这种情况，您可能希望在几代人之间扫描您的种群，并用新的随机个体或杂交个体替换重复。

也就是说，我目前的方法是保留前 1%，将前 20% 杂交到新的 20%，将前 40% 杂交到下一个 20%，杂交前 90% 产生下一个 20%，然后随机生成其余的 (39%)。如果有重复，我删除它们并用新的随机个体替换它们。

我不使用突变，因为大量随机个体应该注意在接下来的杂交过程中添加“突变”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T02:32:47.323

你知道你能做什么......你可以编写一个遗传算法来确定最佳分布。

但是，通常我会保留前 12% 和 28% 的杂交品种；其他人各占 30%。

# java - Java 中的 Web 日志分析

> ID：131176
> 
> 赞同：3
> 
> 时间：2008-09-25T02:33:42.283
> 
> 标签：java, file-io, log-analysis

如何在 Java 中读取 Web 服务器日志文件。这个文件一直在更新。如果我打开一个新的 FileInputStream，它会实时读取日志吗？

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T02:46:04.233

下面是一个基于 RandomAccessFile 的解决方案：

[http://www.informit.com/guides/content.aspx?g=java&seqNum=226](http://www.informit.com/guides/content.aspx?g=java&seqNum=226)

# ruby - 从 gem 安装 RMagick 时出错

> ID：131179
> 
> 赞同：0
> 
> 时间：2008-09-25T02:35:10.203
> 
> 标签：ruby, solaris, imagemagick, gem, rmagick

尝试安装 RMagick gem 失败，出现无法找到 ImageMagick 库的错误，即使我确定它们已安装。

gem install rmagick 的相关输出是：

```
checking for InitializeMagick() in -lMagick... no
checking for InitializeMagick() in -lMagickCore... no
checking for InitializeMagick() in -lMagick++... no
Can't install RMagick 2.6.0\. Can't find the ImageMagick library or one of the dependent libraries. Check the mkmf.log file for more detailed information.

*** extconf.rb failed *** 
```

并查看 mkmf.log 显示：

```
have_library: checking for InitializeMagick() in -lMagick... -------------------- no

"/usr/local/bin/gcc -o conftest -I.
-I/usr/local/lib/ruby/1.8/i386-solaris2.10 -I. -I/usr/local/include/ImageMagick  -I/usr/local/include/ImageMagick  conftest.c  -L. - L/usr/local/lib -Wl,-R/usr/local/lib -L/usr/local/lib -L/usr/local/lib -R/usr/local/lib -lfreetype -lz -L/usr/local/lib   -L/usr/local/lib -lMagickCore  -lruby-static - lMagick  -ldl -lcrypt -lm   -lc"
ld: fatal: library -lMagick: not found
ld: fatal: File processing errors. No output written to conftest 
```

这是在带有 ImageMagick 版本 6.4.3 和 RMagick 版本 2.6.0 的 Solaris 10 x86 上

如果我需要向 LDFLAGS 添加一些东西，我不清楚那会是什么。我从源代码安装了 ImageMagick，它应该在通常的地方。IE，

```
# ls -l  /usr/local/lib/ | grep -i magick                      
drwxr-xr-x  5 root root      512 Sep 24 23:09 ImageMagick-6.4.3/
-rw-r--r--  1 root root 10808764 Sep 25 02:09 libMagickCore.a
-rwxr-xr-x  1 root root     1440 Sep 25 02:09 libMagickCore.la*
-rw-r--r--  1 root root  2327072 Sep 25 02:09 libMagickWand.a
-rwxr-xr-x  1 root root     1472 Sep 25 02:09 libMagickWand.la* 
```

ImageMagick-6.4.3/ 没有任何有趣的内容，我找不到任何其他可以指向 gem install 的文件。

任何建议将不胜感激！谷歌搜索并没有太大帮助。

谢谢 -

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T16:30:19.980

问题解决了。

RMagick 无法找到 ImageMagick，因为我忽略了构建共享对象（从原始问题的“ls”中可以看到，没有安装 .so 文件）。解决方案是添加`--with-shared`到我的配置选项中。

然而，这引起了其他问题。最值得注意的是，`make`libiconv 的“未定义符号”消息失败。这是通过将 CFLAGS 设置为指向 libiconv 来解决的：

```
export CFLAGS="-liconv" 
```

最终，我成功的配置命令是：

```
./configure --disable-static --with-modules --without-perl  --with-quantum-depth=8  --with-bzlib=no --with-libiconv 
```

之后`make`，，，，一切顺利`make install`。`gem install rmagick`

谢谢，

R

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-12T09:58:39.127

我在 OpenSuSE 11.4 上遇到了这个问题 - 在安装了一大堆包之后，结果发现 libtool 是缺少的元素......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T02:39:58.647

链接器在标准位置找不到 libMagick。也许您将 ImageMagick 安装在必须通过 LDFLAGS 指定的非标准位置？

# .net - .snk 有什么用？

> ID：131181
> 
> 赞同：163
> 
> 时间：2008-09-25T02:35:21.107
> 
> 标签：.net, strongname, snk

.snk 文件有什么用？我知道它代表**Strongly Named Key**，但是关于它是什么以及它是如何工作的所有解释都超出了我的想象。

关于如何使用强命名密钥及其工作原理是否有任何简单的解释？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2008-09-25T02:42:34.943

.snk 文件用于将[强名称应用于 .NET 程序集](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)。这样一个强大的名字包括

> 一个简单的文本名称、版本号和文化信息（如果提供）——加上一个公钥和一个数字签名。

SNK 包含一个唯一的密钥对 - 一个私钥和公钥，可用于确保您拥有程序集的唯一强名称。当程序集被强命名时，会根据程序集的内容构造一个“哈希”，并使用私钥对哈希进行加密。然后将此签名的哈希与 .snk 中的公钥一起放入程序集中。

稍后，当有人需要验证强命名程序集的完整性时，*他们*构建程序集内容的哈希，并使用程序集的公钥解密程序集附带的哈希 - 如果两个哈希匹配，装配验证通过。

能够以这种方式验证程序集以确保没有人将程序集换成会破坏整个应用程序的恶意程序集，这一点很重要。这就是为什么非强命名程序集不像强命名程序集那样受信任，因此它们不能放在 GAC 中。此外，还有一个信任链——您不能生成引用非强命名程序集的强命名程序集。

文章“[强命名的秘密（存档于 Wayback Machine）](https://web.archive.org/web/20060315170822/http://www.ondotnet.com/pub/a/dotnet/2003/04/28/strongnaming.html) ”。在更详细地解释这些概念方面做得很好。带图片。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-25T02:49:48.593

> 在.Net 世界中，**SNK**文件用于对已编译的二进制文件进行签名。这允许发生一些事情：

1.  您可以在 GAC **（全局程序集缓存）**中注册程序集。基本上这样您就可以从同一台机器上的许多地方引用它，而无需维护多个副本）。
2.  您可以在其他也已签名的二进制文件中使用您的二进制文件（对于已签名的程序集，这是一种奇怪的病毒式行为）。
3.  **无权访问 SNK 文件的第 3 方**不能（轻松）修改您的程序集，至少提供少量安全性。

我不熟悉**BizTalk 服务器**的工作原理，因此我认为我无法清楚地说明它们在该环境中的具体用途。

希望这有点帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-25T02:50:02.507

.snk 文件用于对程序集进行签名，以便能够将它们添加到全局程序集缓存 (GAC)。

.snk 文件包含您的密钥的公共和私有令牌。当您想使用该密钥对某些数据（或二进制文件）进行签名时，将对数据计算校验和，然后使用私有令牌对其进行加密。然后将加密的校验和添加到数据中。任何人都可以使用您的密钥中的公共令牌来解密校验和，并将其与他们计算的校验和进行比较，以验证签名数据没有被篡改。

[您可以在http://en.wikipedia.org/wiki/Public-key_cryptography](http://en.wikipedia.org/wiki/Public-key_cryptography)阅读有关公钥加密的更多信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T02:46:09.397

.snk 文件是由框架实用程序集中的 sn 实用程序生成的“密钥”的持久版本。然后，您可以使用此文件对您的程序集进行“数字签名”。它是一个 2 部分密钥.. 私钥-公钥组合。密钥的公共部分是公开的，即每个人都知道。私有部分只有您（组件/应用程序开发人员）知道，并且打算保持这种方式。

当您签署您的程序集时，它使用您的程序集的私钥和散列值来创建嵌入在您的程序集中的数字签名。此后，任何加载您的程序集的人都会经过验证步骤。公钥用于验证程序集是否真的来自您。您只需要为此的公钥（它也嵌入在程序集清单中的标记化形式中）。如果程序集已被篡改，则哈希值将不同，程序集加载将被中止。这是一种安全机制。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T02:59:38.773

.snk 文件用于确保其他人不能用自己的程序集代替您的程序集。它提供了一对加密/解密密钥。

当使用 .snk 文件对程序集进行签名时，会根据程序集文件计算哈希码值并使用私钥进行加密。然后将该加密的“摘要”与 .snk 文件中的公钥一起附加到程序集上。

然后，当有人收到您的程序集时，他们还可以计算该哈希码值。他们使用公钥解密您计算的密钥并比较计算的值。如果程序集完全被更改，这些值将不同，并且程序集的用户将知道您拥有的程序集不是您提供的程序集。

在 BizTalk Server 的上下文中，构建 BizTalk 解决方案使用的任何自定义程序集的人都需要使用 .snk 文件对程序集进行签名，以便 BizTalk 服务器可以将其加载到 GAC 中并使用它。

# c - 在C中将控制台exe转换为dll

> ID：131196
> 
> 赞同：4
> 
> 时间：2008-09-25T02:40:29.147
> 
> 标签：c, delphi, dll, exe

我有兴趣从另一个 Windows GUI 程序（自然用 Delphi 编写）调用开源控制台应用程序[SoX 。](http://sourceforge.net/projects/sox)我不想处理抓取和隐藏控制台窗口，我只想将应用程序转换为我可以从我的应用程序调用的 DLL。

在我开始走这条路之前，我很好奇我应该做多少工作？我们是在谈论一项重大事业，还是有直接的解决方案？我知道一些 C，但绝不是专家。

我不期待 SoX 的具体细节，一般只是将 EXE 控制台应用程序转换为 DLL。如果有人熟悉 SoX，那就更好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T03:43:29.353

对于通过修改 C 源代码将控制台可执行文件转换为库的特定主题，这取决于命令行应用程序的分解方式。如果它是以这样一种方式编写的，即通过一小组函数甚至更好的函数指针来汇集 I/O，那么显然它将是微不足道的。

如果这一切都是用 printf、scanf 和朋友完成的，那么最好的办法是找到/创建一个包含所有源文件的包含文件，并添加一个将 printf/scanf 和朋友重定向到您自己编写的函数的宏以便适合 DLL 实现。可以从 vsnprintf 构建诸如 printf 之类的东西（使用 n 版本以确保安全），因此您无需重新实现整个 C RTL I/O 子系统。不过没有vsscanf，但是网上有第三方实现。

如果代码使用 fprintf、fscanf 等来启用文件和控制台之间的间接连接，那么您仍然不走运。FILE 结构是不透明的，与 Pascal 文本文件不同，不能实现可移植的文本文件驱动程序。如果您深入研究特定的 C RTL，它可能仍然是可能的，但最好建议您沿着宏路线走并重新实现您自己重命名的 FILE 类型。

最后，“popen()”方法在 Delphi 中是可能的，并且在 Delphi 2009 中使用 TTextReader 和 TTextWriter 类变得更加容易。将这些与包裹在管道上的TFileStream结合起来，在新进程和STARTF_USESTDHANDLES等中指定标准输入、标准输出和标准错误的管道，就可以工作了。如果您不想自己编写，也可以在网络上为 Delphi 提供第三方等价物/示例。[这是一个。](http://www.delphidabbler.com/software?id=consoleapp&mid=3.2)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T02:51:23.673

在 Windows 中，您只需使用 SoX 命令行调用[CreateProcess 。](http://msdn.microsoft.com/en-us/library/ms682425.aspx)我不知道 Win32 的 Delphi 绑定，但我在 Win32 和 C# 中都做过这件事。

现在您知道 CreateProcess 是您想要调用的，谷歌搜索如何从 Delphi 执行此操作应该会为您提供所需的所有代码。

[Delphi 角文章 - 使用 CreateProcess 执行程序](http://www.delphicorner.f9.co.uk/articles/wapi4.htm)

[调用 CreateProcess() 的简单方法](http://www.chami.com/tips/delphi/122096D.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T02:49:21.543

您甚至可能不需要 DLL，您可以使用**popen()**函数来运行控制台应用程序并收集任何输出文本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T03:48:33.397

按照 Indiv 建议的方式运行该过程，并像 Adam 所展示的那样捕获输出。

但是，如果您仍想进行 DLL 转换，这将帮助您开始

1.  为windows配置SOX并编译
2.  使用 C++ 工具创建一个空的 DLL 项目
3.  添加 SOX 文件作为项目的一部分
4.  添加一个名为 DLLMain 的新函数

    BOOL APIENTRY DllMain( HANDLE hModule, DWORD ul_reason_for_call, LPVOID ) {return TRUE;}

5.  添加列出 DLL 中导出的 .DEF 文件（使用项目名称作为文件名） - 向其中添加以下内容

    ```
    LIBRARY      "name.DLL" 
    ```

    出口

    CallOldMain 私人

6.  将 SOX 的 main 重命名为 CallOldMain

7.  编写一个 CUSTOM 函数来记录输出/返回错误等。

8.  在 SOX 应用程序中找到所有 printfs / cout 并将其替换为对上面自定义函数的调用

9.  编译 DLL 后，您现在可以使用 C 主程序期望的相同参数调用函数 CallOldMain。您可以修改此签名以从上面返回错误/输出。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-25T03:01:36.163

免责声明：我对 SoX 一无所知。可能是代码的结构使这变得容易，或者可能更难。无论哪种方式，过程都是相同的：

首先，您要在 SoX 应用程序中找到要调用的函数。控制台应用程序很可能具有解析命令行并调用适当函数的代码。所以首先，找到你想要使用的功能。

接下来，在此站点上查看有关从 C 中导出 DLL 中的函数的信息：[创建和使用 DLL](http://www.flipcode.com/archives/Creating_And_Using_DLLs.shtml)

然后创建一个新的 makefile 或 Visual Studio 项目文件，目标是 DLL，并添加您已修改以导出的 SoX 程序中的源文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T05:00:07.983

你没有提到你的工具链是什么，但是如果你在 Windows 中配置 gcc，你可以使用普通的 config;make;make install 来编译 sox。在此过程中，它将创建一个 dll 文件和控制台应用程序。或者，您可以只指定生成目标以仅生成 dll。这将编译一个仅依赖于 MS C 运行时 dll 的 windows 本机库，您可以在自己的应用程序中使用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T08:47:45.567

您可以执行控制台应用程序并使用管道捕获其输出。您将管道的 une 一侧用作 CreateProcess 的标准输出，然后像普通文件一样从另一侧读取。

您可以在此处查看用 delphi 编写的工作示例：http: [//delphi.about.com/cs/adptips2001/a/bltip0201_2.htm](http://delphi.about.com/cs/adptips2001/a/bltip0201_2.htm)

# delphi - 在主应用程序单元结束后你能捕捉到异常吗？

> ID：131217
> 
> 赞同：4
> 
> 时间：2008-09-25T02:47:48.613
> 
> 标签：delphi, exception

在我们的一个应用程序中，我遇到了一个我似乎无法找到或捕获的异常。

```
...
  Application.CreateForm(TFrmMain, FrmMain);
  outputdebugstring(pansichar('Application Run')); //this is printed
  Application.Run;
  outputdebugstring(pansichar('Application Run After')); //this is printed
end.
<--- The Exception seems to be here 
```

事件日志显示

```
> ODS: Application Run 
> //Various Application Messages 
> ODS: Application Run After
> First Change Exception at $xxxxxxxx.  ...etc 
```

我能想到的只是其中一个单元的最终确定代码。

（德尔福 7）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T02:54:34.620

尝试安装[MadExcept](http://www.madshi.net/) - 它应该会捕获异常并为您提供堆栈跟踪。

当我遇到类似问题时，它帮助了我。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T03:12:57.913

您可以尝试以下两件事：

1) 快速简单的是在最后的“结束”上按“F7”。这将带您进入其他最终确定块。

2) 尝试覆盖 Application.OnException 事件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T03:31:13.750

SysUtils 单元实际上在其初始化部分设置了默认的 ErrorProc 和 exceptProc 过程，并在其终结部分中撤消它们，因此在这种情况下，通常需要确保 SysUtils 是 dpr 中使用子句中的第一个单元，所以然后这将是最后一个完成的。可能足以让您获得一些有关问题所在的有意义的数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T05:41:38.383

终结异常是棘手的。即使您将*SysUtls*放在项目文件的首位，您的应用程序对象也可能已经消失，这意味着您的全局异常处理程序也消失了。 *MadExcept*可能适用于此。

另一种解决方案是在每个单元**完成部分中放置一个****Try** / **except**块，然后在那里处理异常。

 **你的目标是什么？你想抑制异常还是调试它？按照 Zartog 的建议，可以通过**F7逐步调试它。**如果您发现哪个单元在**最终确定**中有异常，那么您可以尝试在调用它的 uses 子句中以不同的顺序放置它。

祝你好运！

# sharepoint - 在 sharepoint 设计器的工作流编辑器中，如何获取工作流发起者用户名？

> ID：131238
> 
> 赞同：6
> 
> 时间：2008-09-25T02:56:51.557
> 
> 标签：sharepoint, workflow, workflow-foundation, sharepoint-designer, workflow-activity

在 Sharepoint 设计器的工作流编辑器中，我希望检索工作流发起者的用户名/名称（即谁启动它或触发了工作流） - 这相对容易使用 3rd 方产品，如 Nintex Workflow 2007（我会使用类似 {Common:Initiator}) - 但我似乎无法找到任何开箱即用的方法来使用共享点设计器和 MOSS 2007 做到这一点。

**更新**

OOTB 看起来并不支持这个相当明显的功能，所以我最终编写了一个自定义活动（如其中一个答案所建议的那样）。我在这里列出了活动代码以供参考，尽管我怀疑博客上可能有一些这样的实例，因为它是一个非常简单的解决方案：

```
public partial class LookupInitiatorInfo : Activity
{
    public static DependencyProperty __ActivationPropertiesProperty =
        DependencyProperty.Register("__ActivationProperties",
        typeof(Microsoft.SharePoint.Workflow.SPWorkflowActivationProperties),
        typeof(LookupInitiatorInfo));

    public static DependencyProperty __ContextProperty =
        DependencyProperty.Register("__Context", typeof (WorkflowContext),
        typeof (LookupInitiatorInfo));

    public static DependencyProperty PropertyValueVariableProperty =
        DependencyProperty.Register("PropertyValueVariable", typeof (string),    
        typeof(LookupInitiatorInfo));

    public static DependencyProperty UserPropertyProperty = 
        DependencyProperty.Register("UserProperty", typeof (string),
        typeof (LookupInitiatorInfo));

    public LookupInitiatorInfo()
    {
        InitializeComponent();
    }

    [Description("ActivationProperties")]
    [ValidationOption(ValidationOption.Required)]
    [Browsable(true)]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
    public Microsoft.SharePoint.Workflow.SPWorkflowActivationProperties __ActivationProperties
    {
        get { return ((Microsoft.SharePoint.Workflow.SPWorkflowActivationProperties)(base.GetValue(__ActivationPropertiesProperty))); }
        set { base.SetValue(__ActivationPropertiesProperty, value); }
    }

    [Description("Context")]
    [ValidationOption(ValidationOption.Required)]
    [Browsable(true)]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
    public WorkflowContext __Context
    {
        get { return ((WorkflowContext)(base.GetValue(__ContextProperty))); }
        set { base.SetValue(__ContextProperty, value); }
    }

    [Description("UserProperty")]
    [ValidationOption(ValidationOption.Required)]
    [Browsable(true)]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
    public string UserProperty
    {
        get { return ((string) (base.GetValue(UserPropertyProperty))); }
        set { base.SetValue(UserPropertyProperty, value); }
    }

    [Description("PropertyValueVariable")]
    [ValidationOption(ValidationOption.Required)]
    [Browsable(true)]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
    public string PropertyValueVariable
    {
        get { return ((string) (base.GetValue(PropertyValueVariableProperty))); }
        set { base.SetValue(PropertyValueVariableProperty, value); }
    }

    protected override ActivityExecutionStatus Execute(ActivityExecutionContext executionContext)
    {
        // value values for the UserProperty (in most cases you
        // would use LoginName or Name)

        //Sid
        //ID
        //LoginName
        //Name
        //IsDomainGroup
        //Email
        //RawSid
        //Notes

        try
        {
            string err = string.Empty;

            if (__ActivationProperties == null)
            {
                err = "__ActivationProperties was null";
            }
            else
            {
                SPUser user = __ActivationProperties.OriginatorUser;

                if (user != null && UserProperty != null)
                {
                    PropertyInfo property = typeof (SPUser).GetProperty(UserProperty);
                    if (property != null)
                    {
                        object value = property.GetValue(user, null);
                        PropertyValueVariable = (value != null) ? value.ToString() : "";
                    }
                    else
                    {
                        err = string.Format("no property found with the name \"{0}\"", UserProperty);
                    }
                }
                else
                {
                    err = "__ActivationProperties.OriginatorUser was null";
                }
            }
            if (!string.IsNullOrEmpty(err))
                Common.LogExceptionToWorkflowHistory(new ArgumentOutOfRangeException(err), executionContext,
                                                     WorkflowInstanceId);
        }
        catch (Exception e)
        {
            Common.LogExceptionToWorkflowHistory(e, executionContext, WorkflowInstanceId);
        }

        return ActivityExecutionStatus.Closed;
    }
} 
```

然后将其与以下 .action xml 文件连接起来：

```
<?xml version="1.0" encoding="utf-8"?>
<WorkflowInfo Language="en-us">
<Actions>
    <Action Name="Lookup initiator user property"
 ClassName="XXX.ActivityLibrary.LookupInitiatorInfo"
 Assembly="XXX.ActivityLibrary, Version=1.0.0.0, Culture=neutral, PublicKeyToken=XXX"
 AppliesTo="all"
 Category="WormaldWorkflow Custom Actions">
        <RuleDesigner Sentence="Lookup initating users property named %1 and store in %2">
            <FieldBind Field="UserProperty" DesignerType="TextArea" Id="1" Text="LoginName" />              
            <FieldBind Field="PropertyValueVariable" DesignerType="ParameterNames" Text="variable" Id="2"/>
        </RuleDesigner>
        <Parameters>
            <Parameter Name="__Context" Type="Microsoft.Sharepoint.WorkflowActions.WorkflowContext, Microsoft.SharePoint.WorkflowActions" Direction="In"/>
            <Parameter Name="__ActivationProperties" Type="Microsoft.SharePoint.Workflow.SPWorkflowActivationProperties, Microsoft.SharePoint" Direction="In"/>
            <Parameter Name="UserProperty" Type="System.String, mscorlib" Direction="In" />
            <Parameter Name="PropertyValueVariable" Type="System.String, mscorlib" Direction="Out" />
        </Parameters>
    </Action>
</Actions>
</WorkflowInfo> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-02-02T16:25:37.140

对于那些通过谷歌搜索本文并现在使用 SharePoint 2010 的用户，SharePoint Designer 中现在支持工作流启动器变量 OOTB。

数据源将是“工作流上下文”，该字段当然是“发起者”，您可以选择将其返回为“显示名称”、“电子邮件”、“登录名”或“用户 ID 号”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T07:46:50.360

我认为这在 SharePoint Designer 中是不可能做到的。您可能可以编写一个自定义操作来获取发起者，但我认为它根本不会通过 SPD 工作流界面公开。

您可能做的最好的事情是获取在列表中创建或修改项目的用户，但这不会处理手动运行工作流的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-19T00:29:49.353

我可以通过仅使用 SPD 来考虑一个简单但不是非常复杂的解决方案。只需在工作流步骤中在辅助列表中创建一个测试项目（可能是一个任务列表，其中存储了 workflowId 和 itemId 属性以供参考），然后在您的工作流中对该列表进行查找以查看谁是该项目的创建者，即value 将是当前的工作流发起者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-13T15:43:49.230

自定义活动解决方案仅在您使用 moss 时才有效，如果您只有 wss 3.0，您可以在工作流程中多放一步并设置包含任何信息的自定义评论字段，这会使最后修改的人更改并变得相同作为工作流发起者，您可以使用 ModifiedBy 字段来做出您需要的任何决定。

# c++ - 为什么使用迭代器而不是数组索引？

> ID：131241
> 
> 赞同：266
> 
> 时间：2008-09-25T02:58:08.823
> 
> 标签：c++, for-loop, stl, iterator, containers

取以下两行代码：

```
for (int i = 0; i < some_vector.size(); i++)
{
    //do stuff
} 
```

还有这个：

```
for (some_iterator = some_vector.begin(); some_iterator != some_vector.end();
    some_iterator++)
{
    //do stuff
} 
```

我被告知第二种方式是首选。为什么会这样？

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2008-09-25T03:10:27.047

只有当 vector.size() 是快速操作时，第一种形式才有效。例如，这对向量是正确的，但对于列表则不然。另外，你打算在循环体内做什么？如果您计划访问元素，如

```
T elem = some_vector[i]; 
```

那么您假设容器已`operator[](std::size_t)`定义。同样，这适用于矢量，但不适用于其他容器。

迭代器的使用使您更接近**容器独立性**。您没有对随机访问能力或快速`size()`操作做出假设，只是容器具有迭代器功能。

您可以使用标准算法进一步增强您的代码。根据您要实现的目标，您可以选择使用`std::for_each()`，`std::transform()`依此类推。通过使用标准算法而不是显式循环，您可以避免重新发明轮子。您的代码可能更高效（如果选择了正确的算法）、正确且可重用。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-09-25T03:35:42.867

它是现代 C++ 灌输过程的一部分。迭代器是迭代大多数容器的唯一方法，因此即使与向量一起使用它也是为了让自己进入正确的心态。说真的，这是我这样做的唯一原因——我认为我从来没有用不同类型的容器替换过向量。

* * *

哇，这在三周后仍然被否决。我想有点半开玩笑是不值得的。

我认为数组索引更具可读性。它与其他语言中使用的语法以及用于老式 C 数组的语法相匹配。它也不太冗长。如果你的编译器好的话，效率应该是一种洗涤，而且几乎没有任何情况下它很重要。

即便如此，我仍然发现自己经常将迭代器与向量一起使用。我相信迭代器是一个重要的概念，所以我会尽可能地推广它。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2008-09-25T03:02:54.537

因为您没有将代码绑定到 some_vector 列表的特定实现。如果你使用数组索引，它必须是某种形式的数组；如果您使用迭代器，您可以在任何列表实现中使用该代码。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-09-25T03:08:40.200

想象 some_vector 是用链表实现的。然后在第 i 个位置请求一个项目需要执行 i 个操作来遍历节点列表。现在，如果你使用迭代器，一般来说，它会尽最大努力尽可能高效（在链表的情况下，它会维护一个指向当前节点的指针并在每次迭代中推进它，只需要一个单次操作）。

所以它提供了两件事：

*   使用抽象：你只是想迭代一些元素，你不关心怎么做
*   表现

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2008-09-25T04:53:04.583

我将在这里成为魔鬼的拥护者，而不是推荐迭代器。主要原因是我从桌面应用程序开发到游戏开发的所有源代码都不需要使用迭代器。一直以来它们都不是必需的，其次是隐藏的假设、代码混乱和使用迭代器进行的调试噩梦，这使它们成为不要在任何需要速度的应用程序中使用它的主要示例。

即使从维护的角度来看，它们也是一团糟。这不是因为他们，而是因为幕后发生的所有混叠。我怎么知道您没有实现自己的虚拟向量或数组列表，这些虚拟向量或数组列表与标准完全不同。我知道现在在运行时是什么类型吗？你是否重载了一个运算符，我没有时间检查你所有的源代码。我什至知道您使用的是什么版本的 STL？

迭代器遇到的下一个问题是抽象泄漏，尽管有许多网站与他们详细讨论了这个问题。

抱歉，我还没有看到迭代器的任何意义。如果他们从您那里抽象出列表或向量，而实际上您应该已经知道要处理的向量或列表，如果您不知道，那么您将为将来的一些出色的调试会话做好准备。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2008-09-25T03:23:12.833

如果要在迭代向量时向向量添加/删除项目，则可能需要使用迭代器。

```
some_iterator = some_vector.begin(); 
while (some_iterator != some_vector.end())
{
    if (/* some condition */)
    {
        some_iterator = some_vector.erase(some_iterator);
        // some_iterator now positioned at the element after the deleted element
    }
    else
    {
        if (/* some other condition */)
        {
            some_iterator = some_vector.insert(some_iterator, some_new_value);
            // some_iterator now positioned at new element
        }
        ++some_iterator;
    }
} 
```

如果您使用索引，则必须在数组中向上/向下移动项目以处理插入和删除。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-09-27T20:05:00.090

## 关注点分离

将迭代代码与循环的“核心”关注点分开是非常好的。这几乎是一个设计决定。

实际上，按索引进行迭代将您与容器的实现联系在一起。向容器询问开始和结束迭代器，使循环代码能够与其他容器类型一起使用。

另外，`std::for_each`顺便说一下，你[告诉集合要做什么，而不是询问](http://www.pragmaticprogrammer.com/articles/tell-dont-ask)它的内部结构

0x 标准将引入闭包，这将使这种方法更易于使用 - 看看例如 Ruby 的表达能力`[1..6].each { |i| print i; }`......

## 表现

但也许一个备受关注的问题是，使用该`for_each`方法产生了使迭代并行化的机会——[英特尔线程块](http://www.threadingbuildingblocks.org/)可以将代码块分布在系统中的处理器数量上！

注意：在发现这个`algorithms`库之后，尤其是`foreach`.，我经历了两三个月的时间，编写了可笑的小“助手”操作符结构，这会让你的开发人员发疯。这段时间之后，我又回到了一种务实的方法——小循环体不再值得`foreach`:)

关于迭代器的必读参考书是[“Extended STL”](http://blog.extendedstl.com/)一书。

GoF 在 Iterator 模式的末尾有一个很小的段落，它谈到了这个品牌的迭代；它被称为“内部迭代器”。也看看[这里](http://gafter.blogspot.com/2007/07/internal-versus-external-iterators.html)。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2008-09-25T03:04:54.920

因为它更面向对象。如果您正在使用您假设的索引进行迭代：

a) 这些对象是有序的
b) 这些对象可以通过索引获得
c) 索引增量将命中每个项目
d) 该索引从零开始

使用迭代器，您是在说“给我一切，以便我可以使用它”而不知道底层实现是什么。（在Java中，存在无法通过索引访问的集合）

此外，使用迭代器，无需担心超出数组范围。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2008-09-25T03:19:21.487

除了所有其他出色的答案...`int`对于您的矢量来说可能不够大。相反，如果您想使用索引，请`size_type`为您的容器使用：

```
for (std::vector<Foo>::size_type i = 0; i < myvector.size(); ++i)
{
    Foo& this_foo = myvector[i];
    // Do stuff with this_foo
} 
```

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2008-09-25T03:24:32.613

迭代器的另一个好处是它们更好地允许您表达（并强制执行）您的 const 偏好。此示例确保您不会在循环过程中更改向量：

```
 for(std::vector<Foo>::const_iterator pos=foos.begin(); pos != foos.end(); ++pos)
{
    // Foo & foo = *pos; // this won't compile
    const Foo & foo = *pos; // this will compile
} 
```

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2008-09-26T11:44:35.730

我可能应该指出你也可以打电话

`std::for_each(some_vector.begin(), some_vector.end(), &do_stuff);`

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2008-09-25T13:36:12.267

STL 迭代器大部分都在那里，因此像排序这样的 STL 算法可以独立于容器。

如果您只想遍历向量中的所有条目，只需使用索引循环样式。

对于大多数人来说，它的输入更少并且更容易解析。如果 C++ 有一个简单的 foreach 循环而不过度使用模板魔法，那就太好了。

```
for( size_t i = 0; i < some_vector.size(); ++i )
{
   T& rT = some_vector[i];
   // now do something with rT
}
' 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-25T03:03:05.410

我认为它对向量没有太大影响。我更喜欢自己使用索引，因为我认为它更具可读性，并且您可以进行随机访问，例如向前跳转 6 个项目或在需要时向后跳转。

我也喜欢像这样引用循环内的项目，所以这个地方没有很多方括号：

```
for(size_t i = 0; i < myvector.size(); i++)
{
    MyClass &item = myvector[i];

    // Do stuff to "item".
} 
```

如果您认为将来可能需要将向量替换为列表，那么使用迭代器可能会很好，而且对于 STL 怪胎来说它看起来也更时尚，但我想不出任何其他原因。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-25T03:20:39.283

第二种形式更准确地代表了您正在做的事情。在您的示例中，您实际上并不关心 i 的值-您想要的只是迭代器中的下一个元素。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-12-16T22:46:17.620

在对这个答案的主题有了更多了解之后，我意识到这有点过于简单化了。这个循环的区别：

```
for (some_iterator = some_vector.begin(); some_iterator != some_vector.end();
    some_iterator++)
{
    //do stuff
} 
```

这个循环：

```
for (int i = 0; i < some_vector.size(); i++)
{
    //do stuff
} 
```

相当小。事实上，以这种方式执行循环的语法似乎在我身上越来越多：

```
while (it != end){
    //do stuff
    ++it;
} 
```

迭代器确实解锁了一些相当强大的声明性功能，当与 STL 算法库结合使用时，您可以做一些非常酷的事情，这些事情超出了数组索引管理的范围。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-05-08T04:47:42.890

索引需要额外的`mul`操作。例如，对于`vector<int> v`，编译器将转换`v[i]`为`&v + sizeof(int) * i`.

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-25T04:25:11.937

在迭代期间，您不需要知道要处理的项目数。您只需要项目和迭代器就可以很好地完成这些事情。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2017-09-11T17:32:20.133

还没有人提到索引的一个优点是，当您附加到类似的连续容器时它们不会变得无效`std::vector`，因此您可以在迭代期间将项目添加到容器中。

使用迭代器也可以做到这一点，但您必须调用`reserve()`，因此需要知道要追加多少项。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-02-21T12:29:15.493

如果您可以访问[C++11](https://en.wikipedia.org/wiki/C%2B%2B11)功能，那么您还可以使用基于[范围的`for`循环](https://en.cppreference.com/w/cpp/language/range-for)来迭代您的向量（或任何其他容器），如下所示：

```
for (auto &item : some_vector)
{
     //do stuff
} 
```

此循环的好处是您可以直接通过`item`变量访问向量的元素，而不会冒弄乱索引或在取消引用迭代器时出错的风险。此外，占位符使[`auto`](https://en.cppreference.com/w/cpp/language/auto)您不必重复容器元素的类型，这使您更接近独立于容器的解决方案。

笔记：

*   如果您需要循环中的元素索引并且`operator[]`容器存在（并且对您来说足够快），那么最好选择第一种方式。
*   基于范围的`for`循环不能用于在容器中添加/删除元素。如果你想这样做，那么最好坚持Brian Matthews 给出的[解决方案。](https://stackoverflow.com/a/131319/2675154)
*   如果您不想更改容器中的元素，则应使用以下关键字`const`：`for (auto const &item : some_vector) { ... }`.

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-25T08:30:47.667

已经有几个优点了。我还有几点补充意见：

1.  假设我们谈论的是 C++ 标准库，“向量”意味着一个随机访问容器，它具有 C 数组的保证（随机访问、连续内存布局等）。如果您说“some_container”，则上述许多答案会更准确（容器独立性等）。

2.  为了消除对编译器优化的任何依赖，您可以将 some_vector.size() 移出索引代码中的循环，如下所示：

    ```
    const size_t numElems = some_vector.size();
    for (size_t i = 0; 我
    ```

3.  始终预增量迭代器并将后增量视为例外情况。

for (some_iterator = some_vector.begin(); some_iterator != some_vector.end(); ++some_iterator){ //做事 }

因此，假设容器和可索引`std::vector<>`容器一样，没有充分的理由优先选择一个，依次通过容器。如果您必须经常引用较旧或较新的元素索引，那么索引版本更合适。

一般来说，使用迭代器是首选，因为算法会使用它们，并且可以通过更改迭代器的类型来控制（并隐式记录）行为。数组位置可以用来代替迭代器，但语法上的差异会很突出。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-07-13T07:27:58.570

我不使用迭代器的原因与我不喜欢 foreach 语句的原因相同。当有多个内部循环时，很难跟踪全局/成员变量，而不必记住所有的局部值和迭代器名称。我发现有用的是在不同场合使用两组索引：

```
for(int i=0;i<anims.size();i++)
  for(int j=0;j<bones.size();j++)
  {
     int animIndex = i;
     int boneIndex = j;

     // in relatively short code I use indices i and j
     ... animation_matrices[i][j] ...

     // in long and complicated code I use indices animIndex and boneIndex
     ... animation_matrices[animIndex][boneIndex] ...

  } 
```

例如，我什至不想将诸如“animation_matrices[i]”之类的东西缩写为一些随机的“anim_matrix”-named-iterator，因为这样您就无法清楚地看到该值来自哪个数组。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-11-15T12:58:07.240

*   如果您喜欢接近金属/不相信他们的实现细节，**请不要使用**迭代器。
*   如果您在开发过程中经常将一种集合类型切换为另一种，请**使用**迭代器。
*   如果您发现难以记住如何迭代不同类型的集合（可能您使用了来自多个不同外部源的多种类型），请**使用**迭代器来统一遍历元素的方式。这适用于说用数组列表切换链表。

真的，仅此而已。平均而言，这并不是说你会获得更多的简洁，如果简洁真的是你的目标，你总是可以依靠宏。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-25T04:58:46.410

比“告诉 CPU 做什么”（命令式）更好的是“告诉库你想要什么”（功能性）。

因此，您应该学习 stl 中存在的算法，而不是使用循环。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-25T06:30:54.053

我总是使用数组索引，因为我的许多应用程序都需要“显示缩略图”之类的东西。所以我写了这样的东西：

```
some_vector[0].left=0;
some_vector[0].top =0;<br>

for (int i = 1; i < some_vector.size(); i++)
{

    some_vector[i].left = some_vector[i-1].width +  some_vector[i-1].left;
    if(i % 6 ==0)
    {
        some_vector[i].top = some_vector[i].top.height + some_vector[i].top;
        some_vector[i].left = 0;
    }

} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-25T11:14:58.830

容器独立性

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2012-07-02T11:04:57.043

两种实现都是正确的，但我更喜欢“for”循环。由于我们决定使用 Vector 而不是任何其他容器，因此使用索引将是最佳选择。使用带有向量的迭代器将失去将对象放在连续内存块中的好处，这有助于简化它们的访问。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-11-27T22:25:43.327

我觉得这里没有一个答案可以解释为什么我喜欢迭代器作为索引容器的一般概念。请注意，我使用迭代器的大部分经验实际上并非来自 C++，而是来自 Python 等高级编程语言。

迭代器接口对函数使用者的要求更少，这允许使用者用它做更多的事情。

如果您只需要能够进行前向迭代，那么开发人员不仅限于使用可索引容器——他们可以使用任何实现`operator++(T&)`,`operator*(T)`和`operator!=(const &T, const &T)`.

```
#include <iostream>
template <class InputIterator>
void printAll(InputIterator& begin, InputIterator& end)
{
    for (auto current = begin; current != end; ++current) {
        std::cout << *current << "\n";
    }
}

// elsewhere...

printAll(myVector.begin(), myVector.end()); 
```

您的算法适用于您需要它的情况 - 迭代向量 - 但它对于您不一定预期的应用程序也很有用：

```
#include <random>

class RandomIterator
{
private:
    std::mt19937 random;
    std::uint_fast32_t current;
    std::uint_fast32_t floor;
    std::uint_fast32_t ceil;

public:
    RandomIterator(
        std::uint_fast32_t floor = 0,
        std::uint_fast32_t ceil = UINT_FAST32_MAX,
        std::uint_fast32_t seed = std::mt19937::default_seed
    ) :
        floor(floor),
        ceil(ceil)
    {
        random.seed(seed);
        ++(*this);
    }

    RandomIterator& operator++()
    {
        current = floor + (random() % (ceil - floor));
    }

    std::uint_fast32_t operator*() const
    {
        return current;
    }

    bool operator!=(const RandomIterator &that) const
    {
        return current != that.current;
    }
};

int main()
{
    // roll a 1d6 until we get a 6 and print the results
    RandomIterator firstRandom(1, 7, std::random_device()());
    RandomIterator secondRandom(6, 7);
    printAll(firstRandom, secondRandom);

    return 0;
} 
```

尝试实现一个与该迭代器类似的方括号运算符将是人为的，而迭代器的实现相对简单。方括号运算符还会对您的类的功能产生影响——您可以索引到任意点——这可能难以实现或效率低下。

迭代器也适合[装饰](https://en.wikipedia.org/wiki/Decorator_pattern)。人们可以编写迭代器，在构造函数中使用迭代器并扩展其功能：

```
template<class InputIterator, typename T>
class FilterIterator
{
private:
    InputIterator internalIterator;

public:
    FilterIterator(const InputIterator &iterator):
        internalIterator(iterator)
    {
    }

    virtual bool condition(T) = 0;

    FilterIterator<InputIterator, T>& operator++()
    {
        do {
            ++(internalIterator);
        } while (!condition(*internalIterator));

        return *this;
    }

    T operator*()
    {
        // Needed for the first result
        if (!condition(*internalIterator))
            ++(*this);
        return *internalIterator;
    }

    virtual bool operator!=(const FilterIterator& that) const
    {
        return internalIterator != that.internalIterator;
    }
};

template <class InputIterator>
class EvenIterator : public FilterIterator<InputIterator, std::uint_fast32_t>
{
public:
    EvenIterator(const InputIterator &internalIterator) :
        FilterIterator<InputIterator, std::uint_fast32_t>(internalIterator)
    {
    }

    bool condition(std::uint_fast32_t n)
    {
        return !(n % 2);
    }
};

int main()
{
    // Rolls a d20 until a 20 is rolled and discards odd rolls
    EvenIterator<RandomIterator> firstRandom(RandomIterator(1, 21, std::random_device()()));
    EvenIterator<RandomIterator> secondRandom(RandomIterator(20, 21));
    printAll(firstRandom, secondRandom);

    return 0;
} 
```

虽然这些玩具可能看起来很普通，但不难想象使用迭代器和迭代器装饰器通过一个简单的接口来做强大的事情——例如，用一个从单个结果构造模型对象的迭代器来装饰数据库结果的只进迭代器. 这些模式使无限集的内存有效迭代成为可能，并且使用我上面写的过滤器，可能对结果进行惰性评估。

C++ 模板的部分强大之处在于您的迭代器接口，当应用于固定长度的 C 数组之类时，[会衰减为简单高效的指针算法](https://en.cppreference.com/w/cpp/iterator/end)，使其成为真正的零成本抽象。

# visual-studio - Visual Studio .NET 调试器的“隐藏的秘密”？

> ID：131263
> 
> 赞同：34
> 
> 时间：2008-09-25T03:06:32.173
> 
> 标签：visual-studio, debugging

尽管我通常不喜欢关于 SO 的讨论/主观帖子，但我真的很欣赏人们放在一起的“隐藏的秘密”帖子集。它们很好地概述了您现在可能会发现的一些经常遗漏的工具。

对于这个问题，我想探索 Visual Studio .NET 调试器。VS.NET 调试器中有哪些您经常使用或最近发现并希望您早就知道的“隐藏的秘密”？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-25T03:14:21.280

我最喜欢的功能之一是断点上可用的[“当命中...”](http://msdn.microsoft.com/en-us/library/232dxah7(VS.80).aspx)选项。您可以打印带有变量值的消息以及许多其他信息，例如：

*   `$ADDRESS`- 当前指令
*   `$CALLER`- 以前的函数名称
*   `$CALLSTACK`- 调用堆栈
*   `$FUNCTION`- 当前函数名称
*   `$PID`- 进程 ID
*   `$PNAME`- 进程名称
*   `$TID`- 线程 ID
*   `$TNAME`- 线程名称

你也可以让它运行一个宏，但我从来没有使用过这个功能。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-25T03:31:55.857

对于 .net 应用程序`System.Diagnostics`有很多有用的调试功能。以`Debugger`班级为例：

```
Debugger.Break(); // Programmatically set a break point
Debugger.Launch(); // Launch the debugger if not already attached
Debugger.IsAttached // Check if the debugger is attached 
```

`System.Diagnostics`也有很多好的属性。我使用的两个是用于更改放入本地窗口的详细信息的调试器显示属性和用于跳过您不关心调试的代码的单步执行属性：

```
// Displays the value of Property1 for any "MyClass" instance in the debugger
[DebuggerDisplay("{Property1}")]
public class MyClass {
    public string Property1 { get; set; }

    [DebuggerStepThrough]
    public void DontStepInto() {
       // An action we don't want to debug
    }
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-06-19T11:59:13.267

您可以在 Watch 窗口中右键单击对象，然后单击 Make Object ID。

它将为该实例分配一个 ID 号，使您可以在复杂的对象图中查看哪些对象引用了同一实例。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-25T03:12:51.970

作为一名 Web 开发人员，大部分时间都在使用与我的前端代码相同的解决方案中的 Web 服务，我发现能够[“附加”到一个进程](http://msdn.microsoft.com/en-us/library/c6wf8e4z.aspx)可以节省大量时间。

在我找到这个隐藏的宝石之前，我总是需要在一些调用 Web 服务方法的前端代码上设置一个断点并单步执行。现在我知道了这个技巧/功能，我可以轻松地在我想要的代码的任何部分设置断点，这节省了我大量的时间和精力。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-25T03:07:21.547

`$exception`在监视窗口中将显示当前正在处理的异常，即使您没有将`Exception`实例分配给命名变量的捕获。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-05-04T06:25:48.787

*   线程窗口，来自 Debug -> Windows -> Threads。您可以冻结和解冻线程，并切换活动线程。这在调试或复制多线程应用程序的问题时非常棒。
*   您可以将黄色的“下一个语句”箭头拖放到另一个地方。当程序恢复时，它将在该语句处恢复执行。您可以将它添加到工具栏中，一个名为 Set Next Statement 的蓝色箭头，但默认情况下不存在。
*   您可以“撤消”您所做的导航，例如滚动、转到另一个文件或跳转到参考。快捷方式是 ctrl--（控制减号）。这样你就可以跳转到一个函数，检查那里的代码，然后不看就回到你原来的位置。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-25T03:11:10.350

[条件断点](http://support.microsoft.com/kb/308469)。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-25T03:15:21.683

您可以将 windbg 扩展加载到 Visual Studio 调试器中并从即时窗口中使用它们。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-25T03:38:35.917

正如在另一篇文章中发布的那样，Sara Ford 正在 VS 调试器上进行当前系列。

她的博客是 VS 技巧的最佳来源：http: [//blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx](http://blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-25T03:13:38.223

这是一种旧的。如果您添加一个监视表达式`err,hr`，那么它将保存 GetLastError() 的结果，格式为 HRESULT（仅限 VC++ 调试器）。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2011-06-14T14:05:32.480

暂停执行时，您可以上下拖动当前行光标（黄色箭头）。

此外，为了在异常暂停期间启用此功能，您必须先在异常详细信息上单击“启用编辑”。

您还可以通过检查以下感兴趣的内容来使 VS 中断已处理的异常：Debug->Exceptions : Throw column

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-25T03:08:43.603

一些有用的快捷键。

*   `F11`进入一个方法。
*   `Shift-F11`跳出一个方法。
*   `F10`跳过一个方法。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-06-19T12:18:05.227

我经常使用的东西：

*   单击菜单项“Debug | Exceptions”（或简称 Ctrl-D、E），您可以在抛出任何异常时启用中断，或者选择在某些异常上不中断。

*   您可以设置调试器以从 MS 服务器下载一些框架源代码和符号，然后单步执行框架代码。（一些库，如 System.ServiceModel，尚不可用）。它在调试下的选项窗口中。请参阅[MSDN 方法](http://msdn.microsoft.com/en-us/library/b8ttk8zy.aspx)。

*   您可以使用 VS.NET 调试器来调试在 IE 中运行的 Javascript。您只需要安装 IE javascript 调试器，并在 IE 的设置中启用 javascript 调试。然后在出现 JS 错误时会弹出“是否要调试”对话框，您可以选择在 VS.NET 中进行调试。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-10-05T17:51:03.300

如果文件属于另一个解决方案（外部文件），您可以在源文件中打开并放置断点。调试器仍然可以命中断点。无需打开另一个 Visual Studio 实例来调试外部文件。有助于调试您获取的 Web 服务。只要所有源代码都是最新的并已编译，这将起作用。

# linux - 如何测量应用程序或进程的实际内存使用情况？

> ID：131303
> 
> 赞同：812
> 
> 时间：2008-09-25T03:19:17.337
> 
> 标签：linux, memory, process

如何测量 Linux 中应用程序或进程的内存使用情况？

来自*[了解 Linux 上的内存使用](http://virtualthreads.blogspot.com/2006/02/understanding-memory-usage-on-linux.html)*的博客文章，`ps`不是用于此意图的准确工具。

> **为什么`ps`是“错误的”**
> 
> 根据您的看法，`ps`不报告进程的实际内存使用情况。**它真正做的是显示如果每个进程是唯一运行的进程，它**会占用多少实际内存。当然，一台典型的 Linux 机器在任何给定时间都有几十个进程在运行，这意味着所报告的 VSZ 和 RSS 数字`ps`几乎肯定是*错误*的。

[（注意：这个问题在[这里](https://stackoverflow.com/q/63166/15161)有非常详细的介绍。）]

* * *

## 回答 #1

> 赞同：404
> 
> 时间：2008-09-25T03:33:27.753

使用`ps`或类似工具，您将只能获得该进程分配的内存页数量。这个数字是正确的，但是：

*   不反映应用程序实际使用的内存量，只反映为其保留的内存量

*   如果页面是共享的，例如通过多个线程或通过使用动态链接库，可能会产生误导

如果您真的想知道您的应用程序实际使用了多少内存，您需要在分析器中运行它。例如，[Valgrind](https://en.wikipedia.org/wiki/Valgrind)可以让您了解所使用的内存量，更重要的是，您可以了解程序中可能存在的内存泄漏。Valgrind 的堆分析器工具称为“massif”：

Massif 是一个堆分析器。它通过定期拍摄程序堆的快照来执行详细的堆分析。它会生成一个图表，显示随时间的堆使用情况，包括有关程序的哪些部分负责最多内存分配的信息。该图由文本或 HTML 文件补充，其中包含用于确定分配最多内存的位置的更多信息。Massif 运行程序的速度比正常速度慢 20 倍。

如[Valgrind 文档](http://valgrind.org/docs/manual/ms-manual.html)中所述，您需要通过 Valgrind 运行程序：

```
valgrind --tool=massif <executable> <arguments> 
```

Massif 写入内存使用快照的转储（例如`massif.out.12345`）。这些提供，(1) 内存使用时间线，(2) 对于每个快照，记录程序内存中的分配位置。分析这些文件的一个很好的图形工具是[massif-visualizer](https://github.com/KDE/massif-visualizer)。但是我发现`ms_print`Valgrind 附带的一个简单的基于文本的工具已经很有帮助了。

要查找内存泄漏，请使用 valgrind 的（默认）`memcheck`工具。

* * *

## 回答 #2

> 赞同：317
> 
> 时间：2010-05-12T04:08:37.917

试试[pmap](http://linux.die.net/man/1/pmap)命令：

```
sudo pmap -x <process pid> 
```

* * *

## 回答 #3

> 赞同：199
> 
> 时间：2008-09-25T03:49:42.410

很难确定，但这里有两个“接近”的东西可以提供帮助。

```
$ ps aux 
```

会给你虚拟大小（VSZ）

您还可以通过转至从*/proc*文件系统获取详细统计信息`/proc/$pid/status`。

最重要的是 VmSize，它应该接近`ps aux`给出的值。

```
/proc/19420$ 猫状态
名称：火狐
状态：S（睡眠）
Tgid：19420
PID：19420
PID: 1
TracerPid: 0
用户ID：1000 1000 1000 1000
吉德：1000 1000 1000 1000
FDS大小：256
组：4 6 20 24 25 29 30 44 46 107 109 115 124 1000
VmPeak：222956 kB
虚拟机大小：212520 KB
VmLck：0 kB
VmHWM：127912 KB
VmRSS：118768 KB
虚拟机数据：170180 kB
VmStk：228 KB
虚拟机：28 kB
虚拟机库：35424 KB
VmPTE：184 KB
主题：8
信号Q：0/16382
签名：0000000000000000
ShdPnd: 0000000000000000
信号块：0000000000000000
签名：0000000020001000
SigCgt: 000000018000442f
CapInh: 0000000000000000
上限：0000000000000000
资本效率：0000000000000000
cpus_allowed: 03
Mems_allowed: 1
自愿_ctxt_switches：63422
非自愿_ctxt_switches：7171

```

* * *

## 回答 #4

> 赞同：143
> 
> 时间：2009-08-06T09:43:38.970

在最新版本的 Linux 中，使用*smaps*子系统。例如，对于 PID 为 1234 的进程：

```
cat /proc/1234/smaps 
```

它会准确地告诉你它当时使用了多少内存。更重要的是，它将内存划分为私有和共享，因此您可以知道您的程序*实例*正在使用多少内存，而不包括程序的多个实例之间共享的内存。

* * *

## 回答 #5

> 赞同：133
> 
> 时间：2008-09-25T13:46:51.307

没有任何简单的方法可以计算这一点。但有些人试图得到一些好的答案：

*   [ps_mem.py](http://www.pixelbeat.org/scripts/ps_mem.py)
*   [GitHub 上的 ps_mem.py](https://raw.github.com/pixelb/ps_mem/master/ps_mem.py)

* * *

## 回答 #6

> 赞同：130
> 
> 时间：2012-12-06T23:10:37.167

使用[**smem**](http://manpages.ubuntu.com/manpages/precise/en/man8/smem.8.html)，它是*[ps](https://en.wikipedia.org/wiki/Ps_(Unix))*的替代方案，它计算每个进程的 USS 和 PSS。你可能想要PSS。

*   **USS** - 独特的套装尺寸。这是该进程独有的非共享内存量（将其视为唯一*内存的**U*）。它不包括共享内存。因此，这将*低于*报告进程使用的内存量，但当您想忽略共享内存时它会很有帮助。

***   **PSS** - 比例集大小。这就是你想要的。它将唯一内存 (USS) 与其共享内存的一部分除以共享该内存的进程数相加。因此，它将为您提供每个进程正在使用多少实际物理内存的准确表示 - 共享内存真正表示为共享。想想*P*代表*物理*内存。** 

 ****这与ps**和其他实用程序报告的 RSS 相比如何：

*   **RSS** - 驻留集大小。这是每个进程使用的共享内存加上非共享内存的数量。如果任何进程共享内存，这将*过度*报告实际使用的内存量，因为相同的共享内存将被多次计算 - 再次出现在共享相同内存的每个其他进程中。因此，它*相当*不可靠，尤其是当高内存进程有很多分叉时——这在服务器中很常见，比如 Apache 或 PHP ( [FastCGI](https://en.wikipedia.org/wiki/FastCGI) /FPM) 进程。

注意：smem 还可以（可选）输出饼图等图形。海事组织你不需要任何这些。如果您只想像使用 一样从命令行使用它`ps -A v`，那么您不需要安装 Python 和 Matplotlib 推荐的依赖项。

* * *

## 回答 #7

> 赞同：122
> 
> 时间：2017-06-23T01:12:17.643

```
ps -eo size,pid,user,command --sort -size | \
    awk '{ hr=$1/1024 ; printf("%13.2f Mb ",hr) } { for ( x=4 ; x<=NF ; x++ ) { printf("%s ",$x) } print "" }' |\
    cut -d "" -f2 | cut -d "-" -f1 
```

以 root 身份使用它，您可以获得每个进程的内存使用情况的清晰输出。

### 输出示例：

```
 0.00 Mb COMMAND
  1288.57 Mb /usr/lib/firefox
   821.68 Mb /usr/lib/chromium/chromium
   762.82 Mb /usr/lib/chromium/chromium
   588.36 Mb /usr/sbin/mysqld
   547.55 Mb /usr/lib/chromium/chromium
   523.92 Mb /usr/lib/tracker/tracker
   476.59 Mb /usr/lib/chromium/chromium
   446.41 Mb /usr/bin/gnome
   421.62 Mb /usr/sbin/libvirtd
   405.11 Mb /usr/lib/chromium/chromium
   302.60 Mb /usr/lib/chromium/chromium
   291.46 Mb /usr/lib/chromium/chromium
   284.56 Mb /usr/lib/chromium/chromium
   238.93 Mb /usr/lib/tracker/tracker
   223.21 Mb /usr/lib/chromium/chromium
   197.99 Mb /usr/lib/chromium/chromium
   194.07 Mb conky
   191.92 Mb /usr/lib/chromium/chromium
   190.72 Mb /usr/bin/mongod
   169.06 Mb /usr/lib/chromium/chromium
   155.11 Mb /usr/bin/gnome
   136.02 Mb /usr/lib/chromium/chromium
   125.98 Mb /usr/lib/chromium/chromium
   103.98 Mb /usr/lib/chromium/chromium
    93.22 Mb /usr/lib/tracker/tracker
    89.21 Mb /usr/lib/gnome
    80.61 Mb /usr/bin/gnome
    77.73 Mb /usr/lib/evolution/evolution
    76.09 Mb /usr/lib/evolution/evolution
    72.21 Mb /usr/lib/gnome
    69.40 Mb /usr/lib/evolution/evolution
    68.84 Mb nautilus
    68.08 Mb zeitgeist
    60.97 Mb /usr/lib/tracker/tracker
    59.65 Mb /usr/lib/evolution/evolution
    57.68 Mb apt
    55.23 Mb /usr/lib/gnome
    53.61 Mb /usr/lib/evolution/evolution
    53.07 Mb /usr/lib/gnome
    52.83 Mb /usr/lib/gnome
    51.02 Mb /usr/lib/udisks2/udisksd
    50.77 Mb /usr/lib/evolution/evolution
    50.53 Mb /usr/lib/gnome
    50.45 Mb /usr/lib/gvfs/gvfs
    50.36 Mb /usr/lib/packagekit/packagekitd
    50.14 Mb /usr/lib/gvfs/gvfs
    48.95 Mb /usr/bin/Xwayland :1024
    46.21 Mb /usr/bin/gnome
    42.43 Mb /usr/bin/zeitgeist
    42.29 Mb /usr/lib/gnome
    41.97 Mb /usr/lib/gnome
    41.64 Mb /usr/lib/gvfs/gvfsd
    41.63 Mb /usr/lib/gvfs/gvfsd
    41.55 Mb /usr/lib/gvfs/gvfsd
    41.48 Mb /usr/lib/gvfs/gvfsd
    39.87 Mb /usr/bin/python /usr/bin/chrome
    37.45 Mb /usr/lib/xorg/Xorg vt2
    36.62 Mb /usr/sbin/NetworkManager
    35.63 Mb /usr/lib/caribou/caribou
    34.79 Mb /usr/lib/tracker/tracker
    33.88 Mb /usr/sbin/ModemManager
    33.77 Mb /usr/lib/gnome
    33.61 Mb /usr/lib/upower/upowerd
    33.53 Mb /usr/sbin/gdm3
    33.37 Mb /usr/lib/gvfs/gvfsd
    33.36 Mb /usr/lib/gvfs/gvfs
    33.23 Mb /usr/lib/gvfs/gvfs
    33.15 Mb /usr/lib/at
    33.15 Mb /usr/lib/at
    30.03 Mb /usr/lib/colord/colord
    29.62 Mb /usr/lib/apt/methods/https
    28.06 Mb /usr/lib/zeitgeist/zeitgeist
    27.29 Mb /usr/lib/policykit
    25.55 Mb /usr/lib/gvfs/gvfs
    25.55 Mb /usr/lib/gvfs/gvfs
    25.23 Mb /usr/lib/accountsservice/accounts
    25.18 Mb /usr/lib/gvfs/gvfsd
    25.15 Mb /usr/lib/gvfs/gvfs
    25.15 Mb /usr/lib/gvfs/gvfs
    25.12 Mb /usr/lib/gvfs/gvfs
    25.10 Mb /usr/lib/gnome
    25.10 Mb /usr/lib/gnome
    25.07 Mb /usr/lib/gvfs/gvfsd
    24.99 Mb /usr/lib/gvfs/gvfs
    23.26 Mb /usr/lib/chromium/chromium
    22.09 Mb /usr/bin/pulseaudio
    19.01 Mb /usr/bin/pulseaudio
    18.62 Mb (sd
    18.46 Mb (sd
    18.30 Mb /sbin/init
    18.17 Mb /usr/sbin/rsyslogd
    17.50 Mb gdm
    17.42 Mb gdm
    17.09 Mb /usr/lib/dconf/dconf
    17.09 Mb /usr/lib/at
    17.06 Mb /usr/lib/gvfs/gvfsd
    16.98 Mb /usr/lib/at
    16.91 Mb /usr/lib/gdm3/gdm
    16.86 Mb /usr/lib/gvfs/gvfsd
    16.86 Mb /usr/lib/gdm3/gdm
    16.85 Mb /usr/lib/dconf/dconf
    16.85 Mb /usr/lib/dconf/dconf
    16.73 Mb /usr/lib/rtkit/rtkit
    16.69 Mb /lib/systemd/systemd
    13.13 Mb /usr/lib/chromium/chromium
    13.13 Mb /usr/lib/chromium/chromium
    10.92 Mb anydesk
     8.54 Mb /sbin/lvmetad
     7.43 Mb /usr/sbin/apache2
     6.82 Mb /usr/sbin/apache2
     6.77 Mb /usr/sbin/apache2
     6.73 Mb /usr/sbin/apache2
     6.66 Mb /usr/sbin/apache2
     6.64 Mb /usr/sbin/apache2
     6.63 Mb /usr/sbin/apache2
     6.62 Mb /usr/sbin/apache2
     6.51 Mb /usr/sbin/apache2
     6.25 Mb /usr/sbin/apache2
     6.22 Mb /usr/sbin/apache2
     3.92 Mb bash
     3.14 Mb bash
     2.97 Mb bash
     2.95 Mb bash
     2.93 Mb bash
     2.91 Mb bash
     2.86 Mb bash
     2.86 Mb bash
     2.86 Mb bash
     2.84 Mb bash
     2.84 Mb bash
     2.45 Mb /lib/systemd/systemd
     2.30 Mb (sd
     2.28 Mb /usr/bin/dbus
     1.84 Mb /usr/bin/dbus
     1.46 Mb ps
     1.21 Mb openvpn hackthebox.ovpn
     1.16 Mb /sbin/dhclient
     1.16 Mb /sbin/dhclient
     1.09 Mb /lib/systemd/systemd
     0.98 Mb /sbin/mount.ntfs /dev/sda3 /media/n0bit4/Data
     0.97 Mb /lib/systemd/systemd
     0.96 Mb /lib/systemd/systemd
     0.89 Mb /usr/sbin/smartd
     0.77 Mb /usr/bin/dbus
     0.76 Mb su
     0.76 Mb su
     0.76 Mb su
     0.76 Mb su
     0.76 Mb su
     0.76 Mb su
     0.75 Mb sudo su
     0.75 Mb sudo su
     0.75 Mb sudo su
     0.75 Mb sudo su
     0.75 Mb sudo su
     0.75 Mb sudo su
     0.74 Mb /usr/bin/dbus
     0.71 Mb /usr/lib/apt/methods/http
     0.68 Mb /bin/bash /usr/bin/mysqld_safe
     0.68 Mb /sbin/wpa_supplicant
     0.66 Mb /usr/bin/dbus
     0.61 Mb /lib/systemd/systemd
     0.54 Mb /usr/bin/dbus
     0.46 Mb /usr/sbin/cron
     0.45 Mb /usr/sbin/irqbalance
     0.43 Mb logger
     0.41 Mb awk { hr=$1/1024 ; printf("%13.2f Mb ",hr) } { for ( x=4 ; x<=NF ; x++ ) { printf("%s ",$x) } print "" }
     0.40 Mb /usr/bin/ssh
     0.34 Mb /usr/lib/chromium/chrome
     0.32 Mb cut
     0.32 Mb cut
     0.00 Mb [kthreadd]
     0.00 Mb [ksoftirqd/0]
     0.00 Mb [kworker/0:0H]
     0.00 Mb [rcu_sched]
     0.00 Mb [rcu_bh]
     0.00 Mb [migration/0]
     0.00 Mb [lru
     0.00 Mb [watchdog/0]
     0.00 Mb [cpuhp/0]
     0.00 Mb [cpuhp/1]
     0.00 Mb [watchdog/1]
     0.00 Mb [migration/1]
     0.00 Mb [ksoftirqd/1]
     0.00 Mb [kworker/1:0H]
     0.00 Mb [cpuhp/2]
     0.00 Mb [watchdog/2]
     0.00 Mb [migration/2]
     0.00 Mb [ksoftirqd/2]
     0.00 Mb [kworker/2:0H]
     0.00 Mb [cpuhp/3]
     0.00 Mb [watchdog/3]
     0.00 Mb [migration/3]
     0.00 Mb [ksoftirqd/3]
     0.00 Mb [kworker/3:0H]
     0.00 Mb [kdevtmpfs]
     0.00 Mb [netns]
     0.00 Mb [khungtaskd]
     0.00 Mb [oom_reaper]
     0.00 Mb [writeback]
     0.00 Mb [kcompactd0]
     0.00 Mb [ksmd]
     0.00 Mb [khugepaged]
     0.00 Mb [crypto]
     0.00 Mb [kintegrityd]
     0.00 Mb [bioset]
     0.00 Mb [kblockd]
     0.00 Mb [devfreq_wq]
     0.00 Mb [watchdogd]
     0.00 Mb [kswapd0]
     0.00 Mb [vmstat]
     0.00 Mb [kthrotld]
     0.00 Mb [ipv6_addrconf]
     0.00 Mb [acpi_thermal_pm]
     0.00 Mb [ata_sff]
     0.00 Mb [scsi_eh_0]
     0.00 Mb [scsi_tmf_0]
     0.00 Mb [scsi_eh_1]
     0.00 Mb [scsi_tmf_1]
     0.00 Mb [scsi_eh_2]
     0.00 Mb [scsi_tmf_2]
     0.00 Mb [scsi_eh_3]
     0.00 Mb [scsi_tmf_3]
     0.00 Mb [scsi_eh_4]
     0.00 Mb [scsi_tmf_4]
     0.00 Mb [scsi_eh_5]
     0.00 Mb [scsi_tmf_5]
     0.00 Mb [bioset]
     0.00 Mb [kworker/1:1H]
     0.00 Mb [kworker/3:1H]
     0.00 Mb [kworker/0:1H]
     0.00 Mb [kdmflush]
     0.00 Mb [bioset]
     0.00 Mb [kdmflush]
     0.00 Mb [bioset]
     0.00 Mb [jbd2/sda5
     0.00 Mb [ext4
     0.00 Mb [kworker/2:1H]
     0.00 Mb [kauditd]
     0.00 Mb [bioset]
     0.00 Mb [drbd
     0.00 Mb [irq/27
     0.00 Mb [i915/signal:0]
     0.00 Mb [i915/signal:1]
     0.00 Mb [i915/signal:2]
     0.00 Mb [ttm_swap]
     0.00 Mb [cfg80211]
     0.00 Mb [kworker/u17:0]
     0.00 Mb [hci0]
     0.00 Mb [hci0]
     0.00 Mb [kworker/u17:1]
     0.00 Mb [iprt
     0.00 Mb [iprt
     0.00 Mb [kworker/1:0]
     0.00 Mb [kworker/3:0]
     0.00 Mb [kworker/0:0]
     0.00 Mb [kworker/2:0]
     0.00 Mb [kworker/u16:0]
     0.00 Mb [kworker/u16:2]
     0.00 Mb [kworker/3:2]
     0.00 Mb [kworker/2:1]
     0.00 Mb [kworker/1:2]
     0.00 Mb [kworker/0:2]
     0.00 Mb [kworker/2:2]
     0.00 Mb [kworker/0:1]
     0.00 Mb [scsi_eh_6]
     0.00 Mb [scsi_tmf_6]
     0.00 Mb [usb
     0.00 Mb [bioset]
     0.00 Mb [kworker/3:1]
     0.00 Mb [kworker/u16:1] 
```

* * *

## 回答 #8

> 赞同：81
> 
> 时间：2015-11-04T21:51:08.933

使用`time`.

不是*Bash*内置`time`的，而是您可以找到的`which time`，例如`/usr/bin/time`。

这是它所涵盖的内容，很简单`ls`：

```
$ /usr/bin/time --verbose ls
(...)
Command being timed: "ls"
User time (seconds): 0.00
System time (seconds): 0.00
Percent of CPU this job got: 0%
Elapsed (wall clock) time (h:mm:ss or m:ss): 0:00.00
Average shared text size (kbytes): 0
Average unshared data size (kbytes): 0
Average stack size (kbytes): 0
Average total size (kbytes): 0
Maximum resident set size (kbytes): 2372
Average resident set size (kbytes): 0
Major (requiring I/O) page faults: 1
Minor (reclaiming a frame) page faults: 121
Voluntary context switches: 2
Involuntary context switches: 9
Swaps: 0
File system inputs: 256
File system outputs: 0
Socket messages sent: 0
Socket messages received: 0
Signals delivered: 0
Page size (bytes): 4096
Exit status: 0 
```

* * *

## 回答 #9

> 赞同：41
> 
> 时间：2009-09-29T09:47:23.367

这是工具和问题的一个很好的总结：[archive.org 链接](http://web.archive.org/web/20110614010958/http://ktown.kde.org/%7Eseli/memory/analysis.html)

我会引用它，以便更多的开发人员真正阅读它。

> 如果要分析整个系统的内存使用情况或彻底分析一个应用程序的内存使用情况（而不仅仅是其堆使用情况），请使用**exmap**。对于整个系统分析，找到具有最高有效使用率的进程，它们在实践中占用最多的内存，找到具有最高可写使用率的进程，它们创建的数据最多（因此可能泄漏或在数据使用方面非常无效）。选择这样的应用程序并在第二个列表视图中分析其映射。有关详细信息，请参阅 exmap 部分。还可以使用**xrestop**检查 X 资源的高使用率，尤其是在 X 服务器的进程占用大量内存的情况下。有关详细信息，请参阅 xrestop 部分。
> 
> 如果您想检测泄漏，请使用**valgrind**或可能**的 kmtrace**。
> 
> 如果您想分析应用程序的堆（malloc 等）使用情况，请在**memprof**或使用**kmtrace**运行它，分析应用程序并搜索函数调用树以获得最大分配。有关更多详细信息，请参阅他们的部分。

* * *

## 回答 #10

> 赞同：40
> 
> 时间：2015-05-18T08:58:38.230

除了答案中列出的解决方案之外，您还可以使用 Linux 命令“top”。它提供了正在运行的系统的动态实时视图，并以百分比的形式提供了整个系统以及每个程序的 CPU 和内存使用情况：

```
top 
```

按程序 PID 过滤：

```
top -p <PID> 
```

按程序名称过滤：

```
top | grep <PROCESS NAME> 
```

“top”还提供了一些字段，例如：

VIRT -- Virtual Image (kb)：任务使用的虚拟内存总量

RES——驻留大小（kb）：任务已使用的非交换物理内存；RES = 代码 + 数据。

DATA - 数据+堆栈大小 (kb)：专用于可执行代码以外的物理内存量，也称为“数据驻留集”大小或 DRS。

SHR -- Shared Mem size (kb)：任务使用的共享内存量。它只是反映可能与其他进程共享的内存。

参考[这里](http://linux.die.net/man/1/top)。

* * *

## 回答 #11

> 赞同：21
> 
> 时间：2008-09-29T02:44:26.503

对此没有单一的答案，因为您无法准确指出进程使用的内存量。Linux 下的大多数进程都使用共享库。

例如，假设您要计算“ls”进程的内存使用量。您是否仅计算可执行文件“ls”使用的内存（如果可以隔离它）？libc 呢？还是运行“ls”所需的所有其他库？

```
linux-gate.so.1 =>  (0x00ccb000)
librt.so.1 => /lib/librt.so.1 (0x06bc7000)
libacl.so.1 => /lib/libacl.so.1 (0x00230000)
libselinux.so.1 => /lib/libselinux.so.1 (0x00162000)
libc.so.6 => /lib/libc.so.6 (0x00b40000)
libpthread.so.0 => /lib/libpthread.so.0 (0x00cb4000)
/lib/ld-linux.so.2 (0x00b1d000)
libattr.so.1 => /lib/libattr.so.1 (0x00229000)
libdl.so.2 => /lib/libdl.so.2 (0x00cae000)
libsepol.so.1 => /lib/libsepol.so.1 (0x0011a000) 
```

您可能会争辩说它们是由其他进程共享的，但是如果没有加载它们，'ls' 就不能在系统上运行。

此外，如果您需要知道进程需要多少内存来进行容量规划，则必须计算每个额外的进程副本使用多少。我认为*/proc/PID/status可能会**一次*为您提供足够的内存使用信息。另一方面，[Valgrind](https://en.wikipedia.org/wiki/Valgrind)将在程序的整个生命周期内为您提供更好的内存使用情况。

* * *

## 回答 #12

> 赞同：18
> 
> 时间：2010-09-08T09:56:21.233

如果您的代码使用 C 或 C++ 编写，您可能可以使用`getrusage()`它返回有关进程的内存和时间使用情况的各种统计信息。

并非所有平台都支持这一点，并且将为内存使用选项返回 0 值。

相反，您可以查看在中创建的虚拟文件`/proc/[pid]/statm`（其中`[pid]`由您的进程 ID 替换。您可以从 中获取此文件`getpid()`）。

这个文件看起来像一个包含 7 个整数的文本文件。您可能对此文件中的第一个（所有内存使用）和第六个（数据内存使用）数字最感兴趣。

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2018-07-17T19:50:57.613

我正在使用[Arch Linux](https://en.wikipedia.org/wiki/Arch_Linux)，有一个很棒的包叫做`ps_mem`：

```
ps_mem -p <pid> 
```

### 示例输出

```
$ ps_mem -S -p $(pgrep firefox)

Private   +   Shared  =  RAM used   Swap used   Program

355.0 MiB +  38.7 MiB = 393.7 MiB    35.9 MiB   firefox
---------------------------------------------
                        393.7 MiB    35.9 MiB
============================================= 
```

* * *

## 回答 #14

> 赞同：14
> 
> 时间：2010-01-04T14:06:06.010

**Valgrind**可以显示详细信息，但它会显着**降低**目标应用程序的速度，并且大多数情况下它会改变应用程序的行为。

**Exmap**是我还不知道的东西，但似乎您需要一个**内核模块**来获取信息，这可能是一个障碍。

关于“内存使用”，我假设每个人都想知道以下内容……在 Linux 中，单个进程可能使用的物理内存量大致可以分为以下几类。

*   **马匿名映射内存**

*   .p 私有

    *   .d 脏 == malloc/mmapped 堆和堆栈分配和写入的内存
    *   .c clean == malloc/mmapped 堆和堆栈内存一旦分配、写入、然后释放，但尚未回收
*   .s 共享

    *   .d 脏 == **malloc/mmaped 堆可以在写入时复制并在进程之间共享**（已编辑）
    *   .c clean == **malloc/mmaped 堆可以在写入时复制并在进程之间共享**（已编辑）
*   **Mn 命名映射内存**

*   .p 私有

    *   .d 脏 == 文件映射写入内存私有
    *   .c clean == 映射程序/库文本私有映射
*   .s 共享

    *   .d 脏 == 文件映射写入内存共享
    *   .c clean == 映射库文本共享映射

Android中包含的名为**showmap**的实用程序非常有用

```
virtual                    shared   shared   private  private
size     RSS      PSS      clean    dirty    clean    dirty    object
-------- -------- -------- -------- -------- -------- -------- ------------------------------
       4        0        0        0        0        0        0 0:00 0                  [vsyscall]
       4        4        0        4        0        0        0                         [vdso]
      88       28       28        0        0        4       24                         [stack]
      12       12       12        0        0        0       12 7909                    /lib/ld-2.11.1.so
      12        4        4        0        0        0        4 89529                   /usr/lib/locale/en_US.utf8/LC_IDENTIFICATION
      28        0        0        0        0        0        0 86661                   /usr/lib/gconv/gconv-modules.cache
       4        0        0        0        0        0        0 87660                   /usr/lib/locale/en_US.utf8/LC_MEASUREMENT
       4        0        0        0        0        0        0 89528                   /usr/lib/locale/en_US.utf8/LC_TELEPHONE
       4        0        0        0        0        0        0 89527                   /usr/lib/locale/en_US.utf8/LC_ADDRESS
       4        0        0        0        0        0        0 87717                   /usr/lib/locale/en_US.utf8/LC_NAME
       4        0        0        0        0        0        0 87873                   /usr/lib/locale/en_US.utf8/LC_PAPER
       4        0        0        0        0        0        0 13879                   /usr/lib/locale/en_US.utf8/LC_MESSAGES/SYS_LC_MESSAGES
       4        0        0        0        0        0        0 89526                   /usr/lib/locale/en_US.utf8/LC_MONETARY
       4        0        0        0        0        0        0 89525                   /usr/lib/locale/en_US.utf8/LC_TIME
       4        0        0        0        0        0        0 11378                   /usr/lib/locale/en_US.utf8/LC_NUMERIC
    1156        8        8        0        0        4        4 11372                   /usr/lib/locale/en_US.utf8/LC_COLLATE
     252        0        0        0        0        0        0 11321                   /usr/lib/locale/en_US.utf8/LC_CTYPE
     128       52        1       52        0        0        0 7909                    /lib/ld-2.11.1.so
    2316       32       11       24        0        0        8 7986                    /lib/libncurses.so.5.7
    2064        8        4        4        0        0        4 7947                    /lib/libdl-2.11.1.so
    3596      472       46      440        0        4       28 7933                    /lib/libc-2.11.1.so
    2084        4        0        4        0        0        0 7995                    /lib/libnss_compat-2.11.1.so
    2152        4        0        4        0        0        0 7993                    /lib/libnsl-2.11.1.so
    2092        0        0        0        0        0        0 8009                    /lib/libnss_nis-2.11.1.so
    2100        0        0        0        0        0        0 7999                    /lib/libnss_files-2.11.1.so
    3752     2736     2736        0        0      864     1872                         [heap]
      24       24       24        0        0        0       24 [anon]
     916      616      131      584        0        0       32                         /bin/bash
-------- -------- -------- -------- -------- -------- -------- ------------------------------
   22816     4004     3005     1116        0      876     2012 TOTAL 
```

* * *

## 回答 #15

> 赞同：14
> 
> 时间：2016-05-02T20:42:43.157

另外三种方法可以尝试：

1.  `ps aux --sort pmem`
    它对输出进行排序`%MEM`。
2.  `ps aux | awk '{print $2, $4, $11}' | sort -k2r | head -n 15`
    它使用管道进行排序。
3.  `top -a`
    它开始顶部排序`%MEM`

*（摘自[这里](http://www.sysadmit.com/2016/05/linux-uso-de-memoria-por-proceso.html)）*

* * *

## 回答 #16

> 赞同：9
> 
> 时间：2011-08-09T17:50:09.323

```
#!/bin/ksh
#
# Returns total memory used by process $1 in kb.
#
# See /proc/NNNN/smaps if you want to do something
# more interesting.
#

IFS=$'\n'

for line in $(</proc/$1/smaps)
do
   [[ $line =~ ^Size:\s+(\S+) ]] && ((kb += ${.sh.match[1]}))
done

print $kb 
```

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2012-10-09T10:20:18.823

我正在使用[htop](https://en.wikipedia.org/wiki/Htop)；这是一个非常好的控制台程序，类似于 Windows[任务管理器](https://en.wikipedia.org/wiki/Windows_Task_Manager)。

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2011-03-07T08:29:30.683

更“真实世界”使用情况的一个很好的测试是打开应用程序，运行`vmstat -s`并检查“活动内存”统计信息。关闭应用程序，等待几秒钟，然后`vmstat -s`再次运行。

然而，应用程序显然正在使用释放的大量活动内存。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2013-03-04T07:59:15.623

下面的命令行将为您提供在 Linux 机器上运行的各种进程使用的总内存，以 MB 为单位：

```
ps -eo size,pid,user,command --sort -size | awk '{ hr=$1/1024 ; printf("%13.2f Mb ",hr) } { for ( x=4 ; x<=NF ; x++ ) { printf("%s ",$x) } print "" }' | awk '{total=total + $1} END {print total}' 
```

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2013-05-08T03:05:07.357

如果进程没有使用太多内存（或者是因为您希望会出现这种情况，或者其他一些命令已经给出了这个初始指示），并且该进程可以承受短时间的停止，您可以尝试使用 gcore 命令。

```
gcore <pid> 
```

检查生成的核心文件的大小，以了解特定进程正在使用多少内存。

如果进程使用数百兆字节或千兆字节，这将不会很好地工作，因为根据 I/O 性能创建核心生成可能需要几秒钟或几分钟。在核心创建过程中，进程会停止（或“冻结”）以防止内存更改。所以要小心。

还要确保生成核心的挂载点有足够的磁盘空间，并且系统不会对在该特定目录中创建的核心文件做出负面反应。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2008-09-25T04:21:57.590

获取[Valgrind](https://en.wikipedia.org/wiki/Valgrind)。让它运行你的程序，它会告诉你很多关于它的内存使用情况。

这仅适用于程序运行一段时间并停止的情况。我不知道 Valgrind 是否可以处理已经运行的进程，或者不应该停止进程，例如守护进程。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2014-08-07T13:35:44.273

注意：**这只有在内存消耗增加时才能 100% 正常工作**

如果您想监视给定进程（或一组已处理的共享通用名称，例如 ）的内存使用情况`google-chrome`，您可以使用我的 bash 脚本：

```
while true; do ps aux | awk ‚{print $5, $11}’ | grep chrome | sort -n > /tmp/a.txt; sleep 1; diff /tmp/{b,a}.txt; mv /tmp/{a,b}.txt; done; 
```

这将不断寻找变化并打印出来。

![在此处输入图像描述](https://i.stack.imgur.com/0g9yT.png)

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2009-08-06T10:45:50.967

如果您想要比使用 Valgrind 进行分析更快的东西并且您的内核较旧并且您不能使用 smaps，那么带有选项的 ps 可以显示进程的驻留集（带有`ps -o rss,command`）可以让您快速合理`_aproximation_`地了解实际数量正在使用非交换内存。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2013-10-21T12:13:24.087

我建议你使用顶部。您可以在[此页面](http://www.atoptool.nl/downloadatop.php)上找到有关它的所有信息。它能够为您的流程提供所有必要的 KPI，还可以捕获到文件中。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2013-06-19T22:13:18.247

查看此 shell 脚本以检查[Linux 中应用程序的内存使用情况](http://www.linoxide.com/linux-shell-script/linux-memory-usage-program/)。

它也[可以在 GitHub 上以及](https://github.com/nixsavy/shell-scripts/blob/master/memstat.sh)[没有 paste 和 bc](https://github.com/asmund1/shell-scripts/blob/master/memstat.sh)的版本中获得。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-09-25T14:02:06.527

在这里再次投票给[Valgrind](https://en.wikipedia.org/wiki/Valgrind)，但我想补充一点，您可以使用像[Alleyoop](http://alleyoop.sourceforge.net/)这样的工具来帮助您解释 Valgrind 生成的结果。

我一直使用这两个工具，并且总是有精益、无泄漏的代码来自豪地展示它；）

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2014-10-02T15:55:19.200

虽然这个问题似乎是关于检查当前正在运行的进程，但我想查看应用程序从头到尾使用的峰值内存。除了[Valgrind](https://en.wikipedia.org/wiki/Valgrind)，您还可以使用[tstime](https://bitbucket.org/gsauthof/tstime)，这要简单得多。它测量“高水位”内存使用情况（RSS 和虚拟）。从[这个答案](https://unix.stackexchange.com/a/18858/15954)。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2020-12-13T15:04:46.050

鉴于一些答案（感谢 thomasrutter），为了获得单个应用程序的实际交换和 RAM，我想出了以下内容，假设我们想知道“firefox”正在使用什么

`sudo smem | awk '/firefox/{swap += $5; pss += $7;} END {print "swap = "swap/1024" PSS = "pss/1024}'`

或者对于 libvirt；

`sudo smem | awk '/libvirt/{swap += $5; pss += $7;} END {print "swap = "swap/1024" PSS = "pss/1024}'`

这将为您提供以 MB 为单位的总数，如下所示；

`swap = 0 PSS = 2096.92`

`swap = 224.75 PSS = 421.455`

在 ubuntu 16.04 到 20.04 上测试。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-01-19T07:55:19.113

*基于对[相关问题](https://stackoverflow.com/questions/14641553/how-to-find-the-memory-consumption-of-a-particular-process-in-linux-for-every-5/29090375#29090375)的回答。*

您可以使用[SNMP](https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol)来获取网络上特定设备中进程的内存和 CPU 使用情况:)

### 要求：

*   运行进程的设备应该已经`snmp`安装并运行
*   `snmp`应配置为接受来自您将运行以下脚本的请求（可以在文件*snmpd.conf*中配置）
*   您应该知道要监控的进程的进程 ID (PID)

### 笔记：

*   ***HOST-RESOURCES-MIB::hrSWRunPerfCPU***是该进程消耗的系统总 CPU 资源的厘秒数。请注意，在多处理器系统上，该值可能会在 1 厘秒的实际（挂钟）时间内增加超过 1 厘秒。

*   ***HOST-RESOURCES-MIB::hrSWRunPerfMem***是分配给该进程的实际系统内存总量。

## 进程监控脚本

```
echo "IP address: "
read ip
echo "Specfiy PID: "
read pid
echo "Interval in seconds: "
read interval

while [ 1 ]
do
    date
    snmpget -v2c -c public $ip HOST-RESOURCES-MIB::hrSWRunPerfCPU.$pid
    snmpget -v2c -c public $ip HOST-RESOURCES-MIB::hrSWRunPerfMem.$pid
    sleep $interval;
done 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2017-02-04T05:41:42.363

/prox/xxx/numa_maps 在那里提供了一些信息：N0=??? N1=？？？。但是这个结果可能会低于实际结果，因为它只计算那些被触摸过的。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-10-21T14:34:27.907

*   最后但同样重要的是，使用[htop](https://linux.die.net/man/1/htop)。

    ```
    sudo apt-get update
    sudo apt-get install htop 
    ```

*   使用以下命令运行 htop。

    ```
    htop 
    ```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2015-03-18T13:07:23.757

使用 Ubuntu 中提供的内置*系统监视器*GUI 工具。

# c# - C# 中的二维数据结构

> ID：131326
> 
> 赞同：2
> 
> 时间：2008-09-25T03:25:35.263
> 
> 标签：c#, data-structures

我正在寻找可以帮助我确定使用 C# 创建二维数据结构的方法的资源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T03:30:51.927

你的意思是多维数组？这很简单：

```
<type>[,] <name> = new <type>[<first dimenison>,<second dimension>]; 
```

这里是 MSDN 参考：

[多维数组 (C#)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/arrays/multidimensional-arrays)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T03:45:28.257

@Traumapony——我实际上会说真正的性能提升是在一个巨大的平面阵列中获得的，但这可能只是我的 C++ 图像处理根源。

这取决于您需要二维结构来做什么。如果它存储的是第二维中每组项目的大小相同的东西，那么您希望使用大型一维数组之类的东西，因为查找时间更快并且数据管理更容易。喜欢：

```
for (y = 0; y < ysize; y++){
   for (x = 0; x < xsize; x++){
      theArray[y*xsize + x] = //some stuff!
   }
} 
```

然后您可以执行通过单个传递忽略相邻像素的操作：

```
totalsize = xsize*ysize;
for (x = 0; x < totalsize; x++){
   theArray[x] = //some stuff!
} 
```

除了在 C# 中，您可能想要实际调用 C++ 库来进行这种处理；C++ 往往会更快，特别是如果您使用 intel 编译器。

如果您的第二维具有多个不同的尺寸，那么我所说的都不适用，您应该查看其他一些解决方案。你真的需要知道你的功能需求是什么才能回答这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T03:45:59.283

根据数据的类型，您可以查看使用直接二维数组：

```
int[][] intGrid; 
```

如果你需要变得棘手，你总是可以采用泛型方法：

```
Dictionary<KeyValuePair<int,int>,string>; 
```

这允许您将复杂类型放入字典的值部分，尽管使索引到元素更加困难。

如果您要存储空间 2d 点数据，System.Drawing 对 2d 空间中的点有很多支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T03:33:38.410

[C# 中的数据结构](https://rads.stackoverflow.com/amzn/click/com/0521670152)

说真的，我并不是要批评这个问题，但是当我用谷歌搜索时，我在搜索的顶部得到了大量有用的结果：

```
data structures c# 
```

如果您对特定数据结构有具体问题，我们可能会有更具体的答案...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T03:38:34.950

为了性能，最好不要使用多维数组（[,]）；相反，使用锯齿状数组。例如：

```
<type>[][] <name> = new <type>[<first dimension>];
for (int i = 0; i < <first dimension>; i++)
{
    <name>[i] = new <type>[<second dimension>];
} 
```

访问：

```
<type> item = <name>[<first index>][<second index>]; 
```

# python - 样式 - 何时序列化 Django 模型实例：信号与模型的保存方法

> ID：131327
> 
> 赞同：1
> 
> 时间：2008-09-25T03:25:52.157
> 
> 标签：python, django

我计划在保存或更新 Django 模型时将其序列化为 XML。（XML 将被导入到 Flash 电影中）。侦听 post_save() 或 pre_save() 信号然后执行序列化更好，还是只在模型的 save() 方法中处理它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T21:49:44.517

如果它是保存模型的核心功能，您将希望它作为保存方法的一部分。但是，如果您已经有一个正常运行的模型并且您想将其扩展用于其他目的，那么信号是您最好的选择，因为它们允许正确解耦模块。

一个很好的例子可能是您想将事件日志记录添加到您的站点，因此您只需侦听表示事件的信号，而不是修改原始站点代码。

post_save() 通常是最好的，因为它意味着模型已经成功保存，使用 pre_save() 并不能保证保存会成功，所以不应该用于任何取决于保存完成的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T03:43:34.860

后保存。这样，新数据（执行序列化的原因）已经在数据库中。它将产生更简洁的代码，只需从数据库中获取，而不必担心添加额外的值。

想到的另一种方法是与数据库并行维护 xml 文件。也就是说，在您的 save() 中将数据添加到数据库和 xml 文件中。如果您正在处理巨大的表，这将有更少的开销。

# cpu - 在基于 Linux 的系统上测量“空闲”CPU 时间的最佳方法是什么

> ID：131335
> 
> 赞同：4
> 
> 时间：2008-09-25T03:29:15.627
> 
> 标签：cpu, performance

对于我们为其开发软件的一些客户，我们需要“保证”一定数量的备用资源（内存、磁盘空间、CPU）。内存和磁盘空间很简单，但 CPU 有点困难。

我们使用的一种技术是创建一个消耗有保证的 CPU 时间的进程（比如每 5 秒消耗 2.5 秒）。我们以最高优先级运行此进程，以确保它运行并消耗所有所需的 CPU 周期。

如果我们的正常应用程序能够以可接受的性能水平运行，并且可以在空闲时间进程也在运行时通过其所有功能测试，那么我们“假设”我们已经履行了对空闲 CPU 时间的承诺。

我确信还有其他技术可以做同样的事情，并且想了解它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T03:42:55.267

所以这可能不是您正在寻找的答案，但是如果您要做的只是确保您的应用程序不超过资源消耗的某些限制并且您在 linux 上运行，您可以自定义 /etc/security/ limits.con（可能是您选择的发行版上的不同文件）以强制限制特定用户并仅在该用户下运行该进程。这当然是假设您对客户的生产环境具有该级别的控制权。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T04:03:18.120

如果我理解正确，您关心的是应用程序是否也在运行，而给定百分比的处理能力不可用。

最无可争议的方法是使用动力不足的硬件进行测试。如果您的设置中的处理器允许您这样做，您可以在线对其进行降频。Linux 内核为您提供了一个简单的界面来执行此操作，请参阅`/sys/devices/system/cpu/cpu0/cpufreq/`. 还有一堆可用的 GUI 应用程序。

如果您的处理器无法在线更改时钟速度，您可以通过艰难的方式来做，并在您的 BIOS 中选择一个较小的倍频器。

我想你应该已经明白了。如果它以 1600 Mhz 而不是 2400 Mhz 运行，则可以保证 33% 的空闲 CPU 时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T03:38:58.710

SAR 是一个标准的 *nix 进程，它收集有关系统资源的操作使用的信息。它还有一个命令行工具，可让您创建各种报告，并且将数据持久保存在数据库中是很常见的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T03:38:05.670

借助多核/处理器系统，您可以利用 Affinity。

# project-management - 您如何组织和跟踪多个（许多）项目

> ID：131337
> 
> 赞同：16
> 
> 时间：2008-09-25T03:29:36.330
> 
> 标签：project-management, projects, project-planning

作为一名承包商、外包商和共享软件作者，我随时都有大约 5-10 个项目在进行。每个项目都有一个待办事项列表，需要与其他外包和员工沟通需求，需要向客户提供状态，需要回答开发人员的问题。

有时它太多了......但后来我意识到我不是很有条理，必须有更好的方法。

你有什么更好的方法？

您如何跟踪多个项目的需求、将工作分配给多个开发人员、获取多个项目的状态并将其提供给多个客户？

你用什么工具？有哪些流程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T03:38:18.460

这听起来可能真的很老技术，但每个项目都有一套不同的记事本。现在，听我说完。

我知道记事本是不可搜索的，它们没有被索引，等等。但是它们会有会议日期和时间（如果你在会议期间一直在做笔记，甚至在电话上），它们具有永不崩溃的能力，并且如果您想知道几年前您做了什么但不记得旧项目文件是否已放入您的新硬盘驱动器，它们是未来的证明。

但最大的原因是 CYA——日志和记事本可以在有人起诉你作为法律文件的情况下使用，特别是如果你对日期很认真的话。它也可能在专利讨论期间起作用，显示提出想法的明确日期和时间。在另一种生活中，我在生物实验室工作，并且电子记录保存，因为它是如此变化无常，由于能够证明你所做的工作是你自己的法律原因，这是不允许的。这种态度已经渗透到我自己的项目笔记中，并帮助跟踪我需要完成的所有事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T03:43:57.637

工具不是答案，除非您已经具备良好使用它们的知识、组织和自律。我强烈推荐[把事情做好](https://rads.stackoverflow.com/amzn/click/com/0142000280)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T05:34:17.637

你应该看看[No Kahuna](http://nokahuna.com) Easy to use；免费和付费版本；积极、响应迅速的开发团队。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T03:31:45.637

我是管理软件项目的 http://trac.edgewall.org/'>trac 的忠实粉丝。它通过集成的 wiki 和源代码控制提供任务和错误管理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T03:38:13.437

我们使用[FogBugz](http://www.fogcreek.com/FogBugz)管理多个项目 (10+) 和客户 (20+) 已超过 4 年。

我们为每个产品制定一个项目，为每个客户制定另一个项目。通过这种方式，我可以控制每个产品的需求以及与每个客户相关的待处理活动。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T03:46:53.540

如果您使用的是 Mac，请尝试[使用 Omniplan 。](http://www.omnigroup.com/applications/omniplan/)我觉得这很有意义。我还发现我最终并没有与界面作斗争，而是专注于使用它来帮助我更好地计划。

编辑：它与[OmniFocus](http://www.omnigroup.com/applications/omnifocus/)配合得很好，不，我不为 Omni Group 工作:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T04:11:04.200

如果您喜欢敏捷方法（或者即使不喜欢），您可以尝试一些敏捷工具。查看[http://www.agile-tools.net/](http://www.agile-tools.net/)进行一些比较。我在工作中使用 xplanner 来协调需求并在多个团队之间进行迭代。它有其怪癖，但通常可以完成工作并允许一些有用的敏捷结构。我相信其他一些人会偏好更成熟的工具。

Trac（正如 Mark Roddy 提到的）也很好，因为它集成了 wiki、任务和缺陷管理，因此如果您还没有这些工具，它可能是一个有趣的工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T03:37:47.807

我应该说我们现在使用 Mantis，但我希望它更好。我希望我可以将它用于面向客户的查询，我可以通过电子邮件打开和分配问题。

[ScrumWorks Pro](http://danube.com/scrumworks/pro)看起来很有前途，但对我来说非常昂贵，有 15 名开发人员。

[AccuNote](http://www.acunote.com/promo/prices)可能是一种选择，但对我来说是新的

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T03:47:53.773

我正在使用[OpenERP](http://www.openerp.com/)的客户支持、项目规划和问题管理部分。拥有您的问题和功能请求，以及在允许您管理客户的同一 CRM 上完成它们所需的任务是一个很大的好处。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T05:13:26.780

我使用 SourceGear Vault 来管理我们所有的软件项目。我们的业务性质很大程度上取决于项目基础——通常我有 5 个活动项目在一段时间内运行。

# vb6 - 奇怪的VB6构建问题（与nlog有关）

> ID：131358
> 
> 赞同：0
> 
> 时间：2008-09-25T03:37:55.810
> 
> 标签：vb6, build, nlog

我认为这与我对 nlog C++ API 的使用有关（我在 nlog 论坛上的问题在[这里](http://www.nabble.com/NLogC-problems-with-VB6-IDE-tt19662300s6167.html)）；我在这里提出这个问题的目的是让更广泛的受众了解我的问题，也许还可以获得一些关于 VB6 IDE 未能在我的特定场景中构建的更一般的想法。

简而言之，我遇到的问题是我无法构建引用非托管 C++ 组件的 VB6 组件，这些组件调用了 nlog 的 C\C++ API（在 NLogC.DLL 中定义）。构建问题不会在编译期间发生，它们是在构建二进制文件时发生的，这向我暗示这是某种链接器类型问题？对如何生成 VB6 二进制文件知之甚少。生成了 VB6 二进制文件，但它在调用后不久就损坏并崩溃。

有没有人对VB6有过类似的经历（不一定与nlog或C++有关）？

编辑：感谢所有对这个相当晦涩的问题的回应。不幸的是，仍然没有进展；我发布后的发现：

1.  “调整”编译选项似乎对解决这个问题没有帮助。
2.  从“空白”VB6 项目添加对启用 nlog 的 C++ 组件的引用不会使其崩溃或导致奇怪的构建问题。所以这不是“原生”VB6 问题，可能是 nlog 与其他引用组件使用的各种组件和 3rd 方库之间的交互问题？
3.  至于 C++ 调用约定：启用 nlog 的 C++ 组件 - 据我所知 - 符合这些约定，并且在 VB6 引用时确实可以正常工作，只要它不进行任何 nlog API 调用。不确定 nlogc.DLL 本身是否兼容 VB6，但我认为这无关紧要，因为 API 调用是从 C++ 组件进行的；VB6 不应该知道或关心 C++ 组件所引用的内容（据我对此的理解......）

编辑2：我还应该注意构建过程中获得的错误消息是：“加载过程中的错误。有关详细信息，请参阅“xxx”。当我打开日志文件时，里面只有：“无法加载控制 xxx”。有趣的是，如果我要再次尝试构建，对该特定控件的所有引用都会从该特定项目中消失，从而导致编译错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T06:47:08.003

通过在我的非托管 C++ 代码中使用 NLog 的 COM 接口 (NLog.ComInterop.DLL) 解决了这个问题。不像 C\C++ API 那样容易，但至少它不会使我的 VB6 组件崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T04:06:41.420

我会尝试调整**Project**、**Properties**菜单、**Compile面板中的一些****Compile**选项，以查看它们是否会产生任何关于出现问题的额外提示。

 ******例如，如果您将可执行文件编译为**p 代码**而不是**本机代码**，它是否仍然在启动时崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T15:07:46.307

运行已编译的二进制文件时会收到什么错误消息？

我怀疑编译器/链接器是问题所在：VB6 项目中的项目引用没有链接到最终的可执行文件中。VB6 中的项目引用实际上是对 COM 类型库的引用（可能嵌入也可能不嵌入 .dll 或其他二进制文件类型）。项目参考主要有两个目的：

1.  IDE 从引用的类型库中提取类型信息，然后将其显示在对象浏览器（以及 Intellisense 下拉菜单中）

2.  在编译时，编译器提取存储在引用库中的类型信息，包括您实例化的每个类的 CLSID，并将此数据嵌入到可执行文件中。这允许您的可执行文件创建包含在您引用的库中的类的实例。

请注意，编译后的二进制文件不链接到引用库中的任何代码，甚至不包含引用库的文件名。最终的可执行文件只包含在运行时实例化 COM 对象所需的 CLSID 和其他类型信息。

问题很可能出在 NLog 上，或者您如何从代码中调用它，而不是 VB6 编译过程中出现问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T21:17:35.903

如果您认为这可能是链接器问题，则应该以同样的方式使其崩溃：

1.  创建一个新的标准项目（任何类型）
2.  添加一个新模块并将“声明”语句复制到其中
3.  编译

如果它没有崩溃，那就是别的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T13:28:32.843

这将有助于准确描述错误或截屏。

要检查的一件事是您构建的 NLogC.DLL 或 C++ DLL 是否定义了正确的调用约定。基本上，除了 STDCALL 调用约定之外，您不能修改 DLL 函数名称或使用任何东西。如果在创建 C++ DLL 时没有考虑到这两件事，那么它将无法与 VB6 一起使用。

[MSDN 关于调用约定的文章。](http://msdn.microsoft.com/en-us/library/dt232c9t(VS.71).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T17:40:28.667

“无法加载控件 xxx”错误可能由 .oca 文件引起，这些文件是从与当前使用的 .ocx 版本不同的版本创建的。如果是这种情况，删除 .oca 文件会有所帮助。

# perl - 将 Perl 部署到无共享集群

> ID：131362
> 
> 赞同：5
> 
> 时间：2008-09-25T03:38:29.177
> 
> 标签：perl, deployment

有人对将 Perl 模块部署到无共享集群的方法有建议吗？

我们目前的方法是非常手动的。

1.  拿下一半集群
2.  将 Perl 模块（CPAN 样式模块）复制到宕机的集群成员
3.  ssh 到每个成员并`perl Makefile.pl; make ; make install`在要安装的每个模块上运行
4.  确认部署
5.  在服务新部署的集群成员，停止服务旧集群成员并重复步骤 2 -> 4

这显然远非最佳，是否有人拥有或知道用于将 Perl 模块部署到无共享集群的良好工具链？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T03:43:05.330

使一个节点脱机，安装 Perl，然后使用它来重新映像其他节点。

至少，这就是我想象的您希望在无共享集群中安装软件的方式。Perl 只是您碰巧安装的应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T03:57:45.230

假设所有机器都是相同的，您应该能够保持一个规范安装，并使用 rsync 或其他东西来保持其他机器的更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T03:46:12.093

过去，我开发了一个 Perl 程序，它使用 Expect 模块（来自 CPAN）基本上自动化您描述的过程，自动 ssh 到每个主机，复制任何必要的文件，并执行安装。不幸的是，这是为客户现场开发的，所以我无法访问要共享的代码。不过，如果您熟悉 Expect，那么设置起来应该不会太难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T03:55:54.020

我们目前有一个进行数据处理的集群 Perl 应用程序。我们还有许多 CPAN 模块和我们开发的软件所依赖的模块。当您说“不共享任何内容”时，我假设您指的是诸如 NFS 挂载之类的东西。

如果机器具有相同的配置，那么您可以将整个应用程序构建到单个目录结构中（例如：/opt/my-app），将其打包，这可能是您唯一需要推送到盒子。

至于将其部署到盒子，您也许可以使用[Capistrano](http://www.capify.org/)。我们开发了一些我们自己的集群实用程序，它们搭载 ssh - 我已经发布了该实用程序的一种形式：[parallel-jobs](http://asymmetrical-view.com/personal/code/perl/parallel-jobs)。它的[自述文件](http://asymmetrical-view.com/personal/code/perl/parallel-jobs.readme)显示了执行多个并行 ssh 命令的示例。扩展该程序以了解您的集群然后能够在集群中执行相同的命令（而不是一系列不同的命令）是一小步。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T09:20:55.580

如果您使用的是 Debian 或 Ubunto 操作系统，您可以打包您的 Perl 模块 - 我已经开源了一些代码来帮助解决这个问题：[Perl module builder](http://code.google.com/p/cpan-debian-package-builder/)它仍然非常粗糙但确实可以工作，并且可以在您自己的代码以及 CPAN 上工作模块，这使得部署更加容易。

还有一个为所有 CPAN 获取 RedHat rpms 的项目，Dave Cross[在 RPM-Land 中发表了一个演讲 Perl，](http://www.slideshare.net/davorg/perl-in-rpmland-presentation "谈这个")这可能是有用的。

如果您在其他没有打包的系统上，那么 rsync 选项（安装在一台机器上，然后[rsync](http://en.wikipedia.org/wiki/Rsync)到其他机器）也应该可以工作，请注意，如果需要，您可以跨 unix 挂载一个 windows 共享和 rsync 到它。

使用像[Puppet](http://reductivelabs.com/projects/puppet/ "木偶")这样的中央管理器使得在集群中创建和维护机器变得更容易管理，从安装代码到管理用户和电子邮件配置。还有一个 Perl 项目正在筹备中，可以做类似的事情，但尚未公开。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T04:49:39.210

[Capistrano](http://www.capify.org/)是一个允许您在一组服务器上运行命令的工具；它非常适合使您的任务变得更加轻松。

[Puppet](http://reductivelabs.com/trac/puppet/wiki/PuppetIntroduction)进一步降低自动化线，但也很复杂，它允许您定义一组服务器，赋予它们角色，然后将代码集推送到订阅特定角色的每台机器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T03:48:30.980

我不确定什么是无共享集群，但如果它使用一些基本的 *nix 系统，如 Fedora、Mandriva 或 Ubuntu。许多 perl 模块是为特定体系结构预编译的。您可以轻松运行这些。

如果这些系统具有相同的架构，您可以像其他人所说的那样将编译的模块从一个系统复制到另一个系统，只需确保您在接收系统上也拥有所有依赖项。

# svn - SVN安装

> ID：131367
> 
> 赞同：7
> 
> 时间：2008-09-25T03:39:04.840
> 
> 标签：svn

我将为我的个人项目安装 SVN。将它安装在备用机器（Win XP）上是否更好，或者如果我将它安装在用于开发的机器（Vista）上，我会不会感到悲伤。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T03:40:50.717

在单独的机器上安装你的存储库可能是一个更好的主意，因为它至少可以让你的源代码在你的开发机器上的硬盘驱动器崩溃中幸存下来。

如果您是 SVN 新手，那么您将无法击败 Red-Bean 和 O'Reilly 提供的免费电子书……在此处查看“带有 Subversion 的版本控制”：http: [//svnbook.red-bean.com /](http://svnbook.red-bean.com/)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T03:50:14.033

一旦你准备好安装，我推荐[VisualSVN Server ...](http://www.visualsvn.com/server/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T03:46:50.390

在“备用”机器上安装真的没有什么意义。它不会消耗任何重要的 CPU 或内存。

将它安装在主系统上的其他充分理由：

*   更快的存储库访问；SVN 的问题不如 CVS 大，但使用本地 repo 的签入、签出等会比网络上的 repo 快得多。
*   更有可能被备份。您正在备份您的开发箱，对吗？对？如果没有，那么有一个很好的理由。通常，您经常使用的盒子比坐在某个角落的盒子更有可能得到备份。
*   更少的功耗，假设“备用”盒子是关闭的。
*   作为一个非常次要的问题，您不必费心使用基于网络的访问，但这实际上并不难。

我认为将它放在单独的盒子上的唯一充分理由是单点故障。如果你的 Vista 盒子踢了钻头桶，那么你就死在水里了。但是，嘿，你在支持它。对？对？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T04:12:07.740

在我看来，你必须将它安装在另一台机器上，最好是一台异地机器，并且可以通过互联网获得。在另一台机器上做这件事有几个好处：

*   你可以对你的开发机器进行任何你喜欢的配置，而不用担心你的 svn 安装
*   存储库充当您代码的备份，因此如果您遇到某种灾难，您可以取回您的代码
*   如果机器可以通过 Internet 访问，您可以在任何机器上的任何位置处理您的代码
*   您可以通过从 SVN 中签出您的代码来轻松地让人们查看您的代码。他们甚至可能会贡献一些代码！
*   至少对我来说，签入代码具有某种意义。我认为如果 repo 在另一台机器上，你会确保你的代码**值得**首先提交。

或许可以看看其中一项免费托管服务，例如 assembla.com。玩得开心！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T03:51:02.003

我目前使用托管的 SVN 服务器，这让我摆脱了所有安装问题。我还有异地备份的好处，所以如果我的办公室着火了，我的源代码将是安全的。

[Dreamhost](http://www.dreamhost.com)即使在最便宜的计划中也托管 SVN，您只需单击一下即可安装，无需 SVN 配置知识。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T04:13:32.027

考虑从 Thoughtworks 获取[Buildix 应用程序服务器](http://buildix.thoughtworks.com/)并在 VM 中运行它。您将获得一个 SVN 服务器以及许多其他好东西，如果您准备好使用它，您可以考虑将它安装在第二个盒子上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T03:41:18.470

为了灵活性（您可以使用不同的系统或购买新机器而不影响存储库）和安全性，我更喜欢它在不同的机器上。通过将其安装在另一台机器上，您消除了在机器死机时丢失一切的机会。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T03:41:38.890

如果它只是用于您的个人项目并且您始终使用同一台机器，只需将其安装在同一台机器上即可。那更简单。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T03:42:34.690

或者，您可以在开发机器上安装存储库，并使用任何文件复制实用程序将其复制到备份机器上。我个人使用 Foldershare ( [http://foldershare.com](http://foldershare.com) ) 来复制我的 repo。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T03:43:08.947

如果您将它安装在远程机器上，您还需要安装服务器服务以在开发环境和存储库之间获取和发送文件。这可以通过 svnserve 守护进程或通过修改像 apache 这样的 httpd 服务器来完成。

如果您在本地机器上设置它，您不需要知道或执行上述任何操作，只需运行安装，然后使用您喜欢的客户端与之交互。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T03:49:23.130

如果您将它安装在同一台机器上，则启动和运行起来非常容易。您不必担心如何连接到存储库，是否要保护连接等。我的意思是简单易行，`svnadmin create c:\repo`.

如果您将其设置在单独的机器上并提前解决连接问题，那么如果您获得一台新的开发机器或其他人开始与您合作，您将节省一些时间。至于备份，确实将存储库放在单独的机器上意味着您在两个地方拥有*一些代码。*但是，您仍然需要对存储库进行备份。否则，当您的存储库出现故障时，您将只拥有已签出的文件版本。历史（这不是版本控制的重点）将永远丢失。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-25T03:58:39.723

如果您自己在 Windows 上安装它，我可以推荐 SlikSVN [http://www.sliksvn.com/en/download/](http://www.sliksvn.com/en/download/)它比配置 apache 容易得多。他们也托管SVN，但我没有他们的经验

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T04:13:45.410

异地托管的 SVN 可能是设置它的最简单方法。CVSDude 实际上免费提供了一个 2mb 的免费存储库。ProjectLocker、CVSDude 和 DreamHost 都提供每月象征性费用（5-20​​ 美元）的付费计划，并为您提供向其他用户开放 SVN 存储库的能力，并提供 trac 和其他一些服务。

如果您想在家中进行设置，并且您有一台备用计算机，并且您觉得可以一直运行，那么这当然是一个更好的选择，它可以为您提供自动备份以及回滚功能。100MB 以太网速度非常快，即使是 Wireless G 也不应该有 SVN 的任何速度问题。

本地 SVN 并没有给你太多，除了回滚，这总比没有好，但仍然不完美。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T08:35:40.213

恕我直言，您可以将其安装在您的机器上以避免维护第二台机器。您还应该在网络驱动器或外部媒体上备份您的存储库，以避免数据丢失。

一旦你把你的数据放在一个安全的地方，你就可以很容易地在任何可用的机器上重新安装 subversion，上面有任何操作系统。

我公司的 Subversion 也安装在 Windows 上，我正在使用[hot-backup.py](http://subversion.tigris.org/tools_contrib.html#backup)，它从调度程序每小时运行一次。

# php - PHP4 有依赖注入框架吗？

> ID：131393
> 
> 赞同：2
> 
> 时间：2008-09-25T03:48:04.507
> 
> 标签：php, dependency-injection, design-patterns, php4

我被困在 PHP 4 服务器上，我想开始将旧的遗留项目迁移到现代设计模式，包括依赖注入。是否有适用于 PHP 4 的依赖注入框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T11:32:43.343

大多数依赖注入框架使用反射来确定依赖关系。由于 PHP4 没有类型提示，因此您不能真正做到这一点。已经使用配置文件进行了实验 - 有时嵌入在代码中的注释中（通常称为注释）。虽然这可行，但我发现它有点笨拙。在我看来，最好使用 PHP 的动态特性来发挥自己的优势，而不是尝试对其应用静态类型的解决方案。您可以通过手工制作的工厂走得很远。例如，请参阅[这篇关于如何的帖子](http://www.sitepoint.com/blogs/2008/02/04/dealing-with-dependencies/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T04:03:22.097

我找到[了这个](http://drip.tigris.org/)（滴滴），但看起来它已经几年没有更新了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T04:01:31.087

我认为依赖注入框架不会真正适用于 PHP，因为它采用了面向对象程序的结构方式。首先，它不像 C# 或 Java，其中二进制文件已经存在，您只需要找到一种方法来实例化该对象并将其注入另一个对象。PHP 必须先加载类文件并解释它们，然后才能使用它们。因此，如果您使用 PHP 有很深的继承层次结构，我认为这不是一个好主意。

鉴于 PHP 是一种脚本语言，最好将其作为一种脚本语言加以利用。这意味着，我只会使用简单的工厂或构建器方法来做类似于依赖注入的事情。我不会使用 DI 框架来负担它，该框架只会添加 PHP 运行时必须为每个 Web 请求处理的内容（除非您进行操作码缓存，但仍然会有 Java 和 .网）。如果我必须更改将注入对象的对象或它们的创建方式，只需编辑包含工厂/构建器方法的脚本就很简单了。无论如何都不需要在那里重新编译。所以我有灵活性，我有一个适合 PHP 做事方式的轻量级架构。

# javascript - 在 JavaScript 中将浮点数转换为整数的最佳方法是什么？

> ID：131406
> 
> 赞同：31
> 
> 时间：2008-09-25T03:53:48.673
> 
> 标签：javascript, variables, types

有几种不同的方法可以在 JavaScript 中将浮点数转换为整数。我的问题是什么方法可以提供最佳性能、最兼容或被认为是最佳实践？

以下是我知道的几种方法：

```
var a = 2.5;
window.parseInt(a); // 2
Math.floor(a);      // 2
a | 0;              // 2 
```

我敢肯定还有其他人在那里。建议？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-25T04:01:02.807

根据[**这个网站**](http://www.jibbering.com/faq/faq_notes/type_convert.html#tcParseIn)：

> parseInt 有时用作将浮点数转换为整数的方法。它非常不适合该任务，因为如果它的参数是数字类型，它将首先转换为字符串，然后解析为数字......
> 
> 对于将数字舍入为整数，首选 Math.round、Math.ceil 和 Math.floor 之一...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-03-15T04:01:25.760

显然，按位加倍不是求底数的最快方法：

```
var x = 2.5;
console.log(~~x); // 2 
```

曾经是这里的一篇文章，但现在得到了 404：http: [//james.padolsey.com/javascript/double-bitwise-not/](http://james.padolsey.com/javascript/double-bitwise-not/)

~~谷歌已将其缓存：`http://74.125.155.132/search?q=cache:wpZnhsbJGt0J:james.padolsey.com/javascript/double-bitwise-not/+double+bitwise+not&cd=1&hl=en&ct=clnk&gl=us`~~

但是 Wayback Machine 拯救了这一天！[http://web.archive.org/web/20100422040551/http://james.padolsey.com/javascript/double-bitwise-not/](http://web.archive.org/web/20100422040551/http://james.padolsey.com/javascript/double-bitwise-not/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-06-15T18:25:17.173

来自 Douglas Crockford 的“Javascript: The Good Parts”：

```
Number.prototype.integer = function () {
    return Math[this < 0 ? 'ceil' : 'floor'](this);
} 
```

这样做你正在为每个 Number 对象添加一个方法。

然后你可以像这样使用它：

```
var x = 1.2, y = -1.2;

x.integer(); // 1
y.integer(); // -1

(-10 / 3).integer(); // -3 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-03-21T13:05:28.657

“最佳”方式*取决于*：

*   舍入模式：对于 具有小数部分的正数和/或负数，您期望/需要哪种[类型的舍入](https://en.wikipedia.org/wiki/Rounding#Rounding_to_integer)（从浮点数到整数） 。 常见示例：

    ```
    浮动 | 截断 | 地板 | 细胞 | 近（半高）
    ------+-------+-------+-------+---------------
    +∞ | +∞ | +∞ | +∞ | +∞  
    +2.75 | +2 | +2 | +3 | +3
    +2.5 | +2 | +2 | +3 | +3
    +2.25 | +2 | +2 | +3 | +2
    +0 | +0 | +0 | +0 | +0
     钠 | 钠 | 钠 | 钠 | 钠
    -0 | -0 | -0 | -0 | -0
    -2.25 | -2 | -3 | -2 | -2
    -2.5 | -2 | -3 | -2 | -2
    -2.75 | -2 | -3 | -2 | -3
    -∞ | -∞ | -∞ | -∞ | -∞  

    ```

    对于浮点到整数的转换，我们*通常*期望**“截断”**
    （又名**“向零舍入”**又名**“远离无穷大”**）。
    实际上，这只是“砍掉”浮点数的小数部分。
    大多数技术和（内部）内置方法都以这种方式运行。
*   输入：您的（浮点）数如何表示：
    *   `String`
        常用基数/基数：10（十进制）
    *   浮点（'内部'）`Number`
*   输出：你想对结果值做什么：
    *   （中间）输出`String`（默认基数 10）（在屏幕上）
    *   对结果值进行进一步计算
*   范围：
    您希望输入/计算结果在什么数值范围内，以及您希望
    在哪个范围内获得相应的“正确”输出。

只有*在*回答了这些考虑之后，我们才能考虑适当的方法和速度！

* * *

根据 ECMAScript 262 规范： javascript 中的*所有*数字（类型`Number`）都表示/存储为：
“ [IEEE 754 Double Precision Floating Point (binary64)](https://en.wikipedia.org/wiki/Double-precision_floating-point_format) ”格式。
因此整数*也*以*相同*的浮点格式表示（作为没有分数的数字）。
^(注意：大多数实现*都尽可能在**内部*使用更有效的（对于速度和内存大小）整数类型！)

由于这种格式存储 1 个符号位、11 个指数位和前 53 个有效位（“尾数”），我们可以说：*只有* -和*之间*的值可以有小数。 换句话说：*所有*可表示的正负值到*（*几乎）（此时格式称为~~一天~~）已经是整数（内部四舍五入，因为没有剩余的位来表示剩余的小数和/或最低有效位整数位）。`Number` *`-2^(52)``+2^(52)`
*`Number` *`2^(52)``2^((2^(11)/2=1024))` ~~`Infinity`~~***

 ***~~还有第一个“陷阱”：
您无法控制`Number`内置字面量/字符串到浮点转换的 -results 的内部舍入模式（舍入模式：IEEE 754-2008“四舍五入到最接近，关系到偶数” ) 和内置算术运算（舍入模式：IEEE 754-2008 “舍入到最近”）。
例如：四舍五入并存储为：四舍五入并存储为：四舍五入并存储为：四舍五入并存储为：四舍五入并存储为：四舍五入并存储为：四舍五入并存储为：四舍五入并存储为：
`2^(52)+0.25 = 4503599627370496.25``4503599627370496`
`2^(52)+0.50 = 4503599627370496.50``4503599627370496`
`2^(52)+0.75 = 4503599627370496.75``4503599627370497`
`2^(52)+1.25 = 4503599627370497.25``4503599627370497`
`2^(52)+1.50 = 4503599627370497.50``4503599627370498`
`2^(52)+1.75 = 4503599627370497.75``4503599627370498`
`2^(52)+2.50 = 4503599627370498.50``4503599627370498`
`2^(52)+3.50 = 4503599627370499.50``4503599627370500`

为了控制四舍五入，您`Number`需要一个小数部分（以及至少一位来表示），否则 ceil/floor/trunc/near 返回您输入的整数。

为了正确地上限/下限/截断最多 x 个有效小数位的数字，我们只关心相应的最低和最高十进制小数值在舍入后是否仍会给我们一个二进制小数值（因此不会上限或下限为下一个整数）。因此，例如，如果您希望“正确”舍入（对于 ceil/floor/ trunc ）*最多1**个*
有效小数位（to比 it is to和比it is to更接近。`x.1 to x.9` **`0.1``1/(2³=8)=0.125``0``0.9``1-1/(2³=8)=0.875``1`**

 ***直到*所有可表示的值都具有不超过第*一个*有效十进制小数位的非零二进制小数（值到）。 2位小数、3位小数、4位小数、5位小数、6位小数、7位小数、8位小数、9位小数、10位小数、11位小数等。`±2^((53-3=50))`*`x.1``x.9`
`±2^((53-6=47))``±2^((53-9=44))``±2^((53-13=40))``±2^((53-16=37))``±2^((53-19=34))``±2^((53-23=30))``±2^((53-26=27))``±2^((53-29=24))``±2^((53-33=20))``±2^((53-36=17))`*

 *javascript 中的**“安全整数”**是一个整数：

*   可以*精确*表示为 IEEE-754 双精度数，并且
*   其 IEEE-754 表示*不能*是对任何其他整数进行四舍五入以适合 IEEE-754 表示的结果
    ^(（即使（作为 2 的精确幂）可以精确表示，但它*不是*安全整数，因为它之前也可能是它被四舍五入以适应最多 53 个最高有效位）。`±2^(53)`*`±(2^(53)+1)`*)

 *这有效地定义了和*之间* 的（安全可表示的）整数的子集范围： `-2^(53)``+2^(53)`

*   from:（含） （从 ES6 开始 作为静态属性提供的常量）`-(2^(53) - 1) = -9007199254740991`
    [`Number.MIN_SAFE_INTEGER`](http://www.ecma-international.org/ecma-262/6.0/#sec-number.min_safe_integer)
*   to: (inclusive) (从 ES6 开始 作为静态属性提供的常量)[这两个新的 ES6 常量的简单 polyfill：]`+(2^(53) - 1) = +9007199254740991`
    [`Number.MAX_SAFE_INTEGER`](http://www.ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)

    ```
    Number.MIN_SAFE_INTEGER || (Number.MIN_SAFE_INTEGER=
      -(Number.MAX_SAFE_INTEGER=9007199254740991) //Math.pow(2,53)-1
    ); 
    ```

从 ES6 开始，还有一个免费的静态方法[`Number.isSafeInteger()`](http://www.ecma-international.org/ecma-262/6.0/#sec-number.issafeinteger)，用于测试传递的值是否为类型`Number`并且是安全整数范围内的整数（返回布尔值`true`或`false`）。
^(注意： 也将返回`false`：`NaN`，`Infinity`并且很明显`String`（即使它代表一个数字）。)
填充*示例*：

```
Number.isSafeInteger || (Number.isSafeInteger = function(value){
  return typeof value === 'number' && 
                value === Math.floor(value) &&
                value  <   9007199254740992 &&
                value  >  -9007199254740992;
}); 
```

* * *

**[ECMAScript 2015 / ES6 提供了一种新的静态方法`Math.trunc()`](http://www.ecma-international.org/ecma-262/6.0/#sec-math.trunc)
来将浮点数截断为整数：**

> 返回数字 x 的整数部分，删除任何小数位。如果 x 已经是整数，则结果为 x。

或者更简单（[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/trunc)）：

> 与其他三种 Math 方法不同：`Math.floor()`,`Math.ceil()`和`Math.round()`，其`Math.trunc()`工作方式非常简单明了：
> 只需截断点及其后面的数字，无论参数是正数还是负数。

我们可以进一步解释（和 polyfill）`Math.trunc()`：

```
Math.trunc || (Math.trunc = function(n){
    return n < 0 ? Math.ceil(n) : Math.floor(n); 
}); 
```

^(请注意，与以下相比，上述 polyfill 的有效负载*可能*会被引擎更好地预先优化：
`Math[n < 0 ? 'ceil' : 'floor'](n);`)

**用法**：`Math.trunc(/* Number or String */)`
**输入**：（整数或浮点）`Number`（但会很乐意尝试将字符串转换为数字）
**输出**：（整数）`Number`（但会很乐意尝试在字符串上下文中将数字转换为字符串）
**范围**：`-2^52`到`+2^52`（超出此范围）我们应该期望“舍入误差”（在某些时候是科学/指数表示法）简单明了，因为我们`Number`在 IEEE 754 中的输入已经失去了小数精度：因为 to 之间`±2^52`的数字`±2^53`已经是*内部舍入*的整数（例如`4503599627370509.5`，内部已经表示为`4503599627370510`）并且超出`±2^53`整数也失去精度（2的幂））。

* * *

**浮点数到整数的转换通过减去一个除法的[余数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Remainder)( `%`) `1`：**

示例：（`result = n-n%1`或`n-=n%1`）
这也应该**截断**浮点数。由于余数运算符的[优先级](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Operator_Precedence)高于减法，我们有效地得到：`(n)-(n%1)`。
对于正数，很容易看出这限制了值：`(2.5) - (0.5) = 2`，
对于负数，这限制了值：（`(-2.5) - (-0.5) = -2`因为`--=+`so `(-2.5) + (0.5) = -2`）。

由于**输入**和**输出**是与 ES6 （或它的 polyfill）相比，`Number`我们*应该*得到*相同的有用范围和输出。*^(注意：我)^(*担心*)^(很难（不确定）可能存在差异：因为我们正在对原始数字（浮点数）和第二个派生数字（分数）进行算术运算（内部使用舍入模式“nearTiesEven”（又名银行家舍入） ) 这似乎会导致复合数字表示和算术舍入错误，因此可能最终返回一个浮点数..)`Math.trunc()`

* * *

***通过（ab-）使用[按位运算](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators)将浮点数转换为整数：***

 *这通过对 a*使用按位运算*在*内部*强制将（浮点）`Number`转换（截断和溢出）转换为有符号的 32 位整数值（二进制补码） （并将结果转换回保持的（浮点）只是整数值）。 *`Number``Number`*

 *同样，**输入**和**输出**是`Number`（以及从字符串输入到数字和数字输出到字符串的无声转换）。

更重要的强硬（通常被遗忘且未解释）：
*根据按位运算和数字的符号*，*有用**范围*****将被*限制***在：
`-2^31`to `+2^31`（like `~~num`or `num|0`or `num>>0`）*或* `0`to `+2^32`（`num>>>0`）之间。

这应该通过以下查找表（包含*所有*“关键”示例）进一步澄清：

```
              n | n>>0 或 n<<0 或 | n>>>0 | n < 0 ? -（-n>>>0）：n>>>0
                            | n|0 或 n^0 或 ~~n | |
                            | 或 n&0xffffffff | |
----------------------------------------+--------------------------------+- ------------+---------------
+4294967298.5 = (+2^32)+2.5 | +2 | +2 | +2
+4294967297.5 = (+2^32)+1.5 | +1 | +1 | +1
+4294967296.5 = (+2^32)+0.5 | 0 | 0 | 0
+4294967296 = (+2^32) | 0 | 0 | 0
+4294967295.5 = (+2^32)-0.5 | -1 | +4294967295 | +4294967295
+4294967294.5 = (+2^32)-1.5 | -2 | +4294967294 | +4294967294
       等等... | 等等... | 等等... | ETC...
+2147483649.5 = (+2^31)+1.5 | -2147483647 | +2147483649 | +2147483649
+2147483648.5 = (+2^31)+0.5 | -2147483648 | +2147483648 | +2147483648
+2147483648 = (+2^31) | -2147483648 | +2147483648 | +2147483648
+2147483647.5 = (+2^31)-0.5 | +2147483647 | +2147483647 | +2147483647
+2147483646.5 = (+2^31)-1.5 | +2147483646 | +2147483646 | +2147483646
       等等... | 等等... | 等等... | ETC...
         +1.5 | +1 | +1 | +1
         +0.5 | 0 | 0 | 0
          0 | 0 | 0 | 0
         -0.5 | 0 | 0 | 0
         -1.5 | -1 | +4294967295 | -1
       等等... | 等等... | 等等... | ETC...
-2147483646.5 = (-2^31)+1.5 | -2147483646 | +2147483650 | -2147483646
-2147483647.5 = (-2^31)+0.5 | -2147483647 | +2147483649 | -2147483647
-2147483648 = (-2^31) | -2147483648 | +2147483648 | -2147483648
-2147483648.5 = (-2^31)-0.5 | -2147483648 | +2147483648 | -2147483648
-2147483649.5 = (-2^31)-1.5 | +2147483647 | +2147483647 | -2147483649
-2147483650.5 = (-2^31)-2.5 | +2147483646 | +2147483646 | -2147483650
       等等... | 等等... | 等等... | ETC...
-4294967294.5 = (-2^32)+1.5 | +2 | +2 | -4294967294
-4294967295.5 = (-2^32)+0.5 | +1 | +1 | -4294967295
-4294967296 = (-2^32) | 0 | 0 | 0
-4294967296.5 = (-2^32)-0.5 | 0 | 0 | 0
-4294967297.5 = (-2^32)-1.5 | -1 | +4294967295 | -1
-4294967298.5 = (-2^32)-2.5 | -2 | +4294967294 | -2

```

^(`0`注 1：最后一列的范围已扩展到`-4294967295`using `(n < 0 ? -(-n>>>0) : n>>>0)`。
注意 2：按位引入了它自己的转换开销（*s*）（严重程度与`Math`实际实现有关，因此按位*可能*更快（通常在较旧的历史浏览器上））。)

* * *

显然，如果您的“浮点”数是 a`String`开头，
`parseInt(/*String*/, /*Radix*/)`则将其解析为 integer 是一个合适的选择`Number`。
`parseInt()`也会*截断*（对于正数和负数）。
该*范围*再次被限制为 IEEE 754 双精度浮点，如上面针对`Math`方法所解释的。

最后，如果您有 a`String`并期望 a`String`作为输出，您还可以截断小数点和小数（与 IEEE 754 双精度浮点 ( `±2^52`) 相比，这也为您提供了更大的精确截断范围）！

* * *

额外：
从上面的信息中，您现在应该拥有所有您需要知道的信息。

例如，如果您希望**从零舍入**（也就是**向无穷大舍**入），您可以修改`Math.trunc()`polyfill，*例如*：

```
Math.intToInf || (Math.intToInf = function(n){
    return n < 0 ? Math.floor(n) : Math.ceil(n); 
}); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-25T08:24:52.593

答案已经给出，但只是为了清楚。

为此使用数学库。圆形、天花板或地板功能。

parseInt 用于将字符串转换为 int，这不是这里需要的

toFixed 用于将浮点数转换为字符串，也不是这里需要的

由于数学函数不会对字符串进行任何转换或从字符串进行任何转换，因此它将比任何其他错误的选择都更快。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-25T04:00:09.377

您可以使用 Number(a).toFixed(0);

甚至只是 a.toFixed(0);

**编辑：**

这是四舍五入到 0 位，与截断略有不同，正如其他人所建议的那样， toFixed 返回一个字符串，而不是原始整数。用于显示目的。

```
var num = 2.7;  // typeof num is "Number"
num.toFixed(0) == "3" 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T04:08:31.883

```
var i = parseInt(n, 10); 
```

如果您不指定基数值 like`'010'`将被视为八进制（因此结果将`8`不是`10`）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-09-07T16:19:15.173

使用位运算符。它可能不是转换为整数的最清晰方法，但它适用于任何类型的数据类型。

假设您的函数接受一个参数`value`，并且该函数以`value`必须始终为整数的方式工作（并且接受 0）。然后以下任何一项将分配`value`为整数：

```
value = ~~(value)
value = value | 0;
value = value & 0xFF;   // one byte; use this if you want to limit the integer to
                        // a predefined number of bits/bytes 
```

最好的部分是它适用于数字字符串（您可能从文本输入中获得的内容等）`~~("123.45") === 123`。任何非数值都会导致`0`，即

```
~~(undefined) === 0
~~(NaN) === 0
~~("ABC") === 0 
```

它确实可以使用十六进制数字作为字符串（带`0x`前缀）

```
~~("0xAF") === 175 
```

我想这涉及到某种类型的强制。我会做一些性能测试来将它们与`parseInt()`and进行比较`Math.floor()`，但我喜欢额外的便利，即不会`Errors`被抛出并获得`0`非数字的 a

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-02-23T05:18:42.727

所以我做了一个基准，`Chrome`当输入已经是一个数字时，最快的是`~~num`and `num|0`, half speed: `Math.floor`，最慢的会在[这里](http://jsperf.com/flooring-benchmark)`parseInt`看到

![基准测试结果](https://i.stack.imgur.com/Lo8Kq.png)

**编辑**：似乎已经有另一个人做了[舍入](http://jsperf.com/truncating-decimals)基准（更多结果）和其他[方法](http://jsperf.com/dsafdgdfsaf/3)：（`num>>0`尽可能快`|0`）和`num - num%1`（有时快）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T04:55:47.823

这个问题似乎是专门询问从浮点数转换为整数的问题。我的理解是这样做的方法是使用`toFixed`. 所以...

```
var myFloat = 2.5;
var myInt = myFloat.toFixed(0); 
```

有谁知道是否`Math.floor()`比性能更高或更低`Number.toFixed()`？

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-25T22:40:02.053

你也可以这样做：

```
var string = '1';
var integer = a * 1; 
```

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2008-09-25T03:56:49.850

parseInt() 可能是最好的一个。`a | 0`没有做你真正想要的（如果 a 是一个未定义或空值，它只是分配 0，这意味着一个空对象或数组通过了测试），并且 Math.floor 通过某种类型的诡计工作（它基本上调用 parseInt()在后台）。

# macros - 学习 Scheme 宏的来源：define-syntax 和 syntax-rules

> ID：131433
> 
> 赞同：10
> 
> 时间：2008-09-25T04:07:21.043
> 
> 标签：macros, lisp, scheme, syntax-rules, define-syntax

我已经阅读了[JRM 的 Syntax-rules Primer](http://www.xs4all.nl/~hipster/lib/scheme/gauche/define-syntax-primer.txt) for the Merely Eccentric，它帮助我理解了语法规则以及它与 common-lisp 的定义宏有何不同。语法规则只是在定义语法中实现语法转换器的一种方式。

我正在寻找两件事，第一是更多示例和语法规则的解释，第二是学习使用定义语法的其他方式的良好资源。你推荐什么资源？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T13:34:28.060

回答你的第二个问题：`syntax-case`是另一种形式进入`define-syntax`. Kent Dybvig 是 的主要支持者`syntax-case`，[他有一个使用它的教程 [PDF]。](http://www.cs.uml.edu/~giam/91.531/Textbooks/RKDybvig.pdf)

我还[阅读了 PLT Scheme 文档](http://docs.plt-scheme.org/guide/syntax-case.html)以`syntax-case`获取更多示例，并了解实施中的变化。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T12:38:51.893

JRM 语法规则入门非常好，但编程语言的第 36 章：应用程序和解释，由 Shriram Krishnamurti [http://www.cs.brown.edu/~sk/Publications/Books/ProgLangs/](http://www.cs.brown.edu/~sk/Publications/Books/ProgLangs/)）也有很好的覆盖编写 Scheme 宏。在过去的 10 年中，该材料已在几篇短文、技术报告等中得到使用和改进，因此这不是一篇“关于 1983 年 Scheme 的 X 实现的事实，不再可访问”的论文。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-29T19:02:48.693

[The Scheme Cookbook](https://web.archive.org/web/20150321052219/http://schemecookbook.org/Cookbook/GettingStartedMacros)中的资源列表是一个很好的起点。如果您喜欢论文，请不要犹豫，访问[readscheme.org](https://web.archive.org/web/20160306064729/http://readscheme.org/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-03T14:42:42.377

[Fear of Macros](https://www.greghendershott.com/fear-of-macros/)是在 Racket 中使用宏的实用指南。它显示了许多使用`define-syntax`. 该材料可能并不完全适用于 Scheme，但您可能会发现一些示例有助于了解可以做什么。

# macos - 使用 AppleScript 隐藏幻灯片中的 Keynote 文本字段

> ID：131435
> 
> 赞同：2
> 
> 时间：2008-09-25T04:09:22.987
> 
> 标签：macos, applescript, automator, keynote

我不是 AppleScript Jedi，我只做了一些简单的事情，但我无法弄清楚这一点并且可以使用一些帮助：

我的妻子在她的艺术史课程中使用幻灯片，并且想在考试中使用相同的幻灯片（没有识别姓名）。而不是创建一个新的演示文稿，我想要一个迭代幻灯片并隐藏文本字段的工具。

浏览 Keynote 字典并没有给我任何关于如何处理这个问题的线索，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T09:53:40.773

AFAIK，使用 Applescript，您只能访问幻灯片的标题和正文框。如果您希望删除的文本始终在这些框中的任何一个中，最简单的解决方案是循环浏览替换该文本的幻灯片，然后保存文档的副本。

```
tell application "Keynote"
    open "/Path/To/Document"

    repeat with currentSlide in slides of first slideshow
        set title of currentSlide to " "
        set body of currentSlide to " "
    end repeat

    save first slideshow in "/Path/To/Document without answers"
end tell 
```

如果文本位于使用文本框工具创建的容器中，我认为您无法使用 Applescript 解决它，但 Keynote 使用基于 XML 的文件格式，因此您可以尝试通过使用您选择的脚本语言编辑 XML 来实现. XML 模式记录在[iWork 编程指南](http://developer.apple.com/documentation/AppleApplications/Conceptual/iWork2-0_XML/index.html "iWork 编程指南")中。

# c - C 程序如何在不终止的情况下生成自身的核心转储？

> ID：131439
> 
> 赞同：32
> 
> 时间：2008-09-25T04:11:05.403
> 
> 标签：c, debugging, coredump

我希望 C 程序在某些情况下生成核心转储。这是一个在生产环境中运行的程序，不容易停止和重新启动以调整其他类型的调试代码。另外，由于它是在生产环境中，我不想调用 abort()。正在调查的问题在非生产环境中不容易复制。我希望程序在检测到某些问题时自行生成核心转储，最好有足够的信息来重命名文件，然后继续。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-09-25T04:56:38.350

```
void create_dump(void)
{
    if(!fork()) {
        // Crash the app in your favorite way here
        *((void*)0) = 42;
    }
} 
```

分叉进程然后让孩子崩溃——它会在你想要的时候给你一个快照

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-10T09:21:29.307

另一种方法可能是使用[Google Coredumper](http://code.google.com/p/google-coredumper/)库。这会产生与 fork+abort 技术类似的结果，但在多线程应用程序中表现更好（在分叉之前暂停所有线程一段时间，以免它们在子进程中造成混乱）。

例子：

```
    #include <google/coredumper.h>
    ...
    WriteCoreDump('core.myprogram');
    /* 继续，我们生成了一个核心文件，
     * 但我们没有崩溃。
     */

```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T04:30:13.610

[Sun在此处](http://docs.oracle.com/cd/E19420-01/820-0436/6nc65np82/index.html)描述了如何在 Solaris、HP-UX、Redhat 和 Windows 上获取核心文件。

Solaris 有 gcore 程序。HP-UX 可能有它。否则使用 gdb 及其 gcore 命令。Windows 有 win-dbg-root\tlist.exe 和 win-dbg-root\adplus.vbs

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-25T04:33:44.070

你真的想要一个核心，还是只是一个堆栈跟踪？如果你想要的只是一个堆栈跟踪，你可以在[这里](http://sourceforge.net/projects/lsstack/)查看开源并尝试从那里集成代码，或者只是从命令行调用它就足够了。

我相信 gdb 项目中的一些代码也可能有用。

您可能想要做的另一个想法是使用 gdb 附加到正在运行的进程。

```
$ gdb /path/to/exec 1234 # 1234 is the pid of the running process 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T04:21:55.017

生成核心转储的源代码位于“gcore”中，它是 gdb 包的一部分。

此外，Sun 有[gcore](http://docs.oracle.com/cd/E23823_01/html/816-5165/gcore-1.html)。

此外，您必须有一个单独的进程运行核心转储，因为当前进程必须暂停。您可以在 gcore 源代码中找到详细信息，或者您可以将您的进程作为目标运行平台的 gcore。

# c++ - GCC 3.4.4 上的 C++ tr1（适用于诺基亚 N810 平板电脑）

> ID：131445
> 
> 赞同：2
> 
> 时间：2008-09-25T04:13:08.657
> 
> 标签：c++, gcc, tr1

如何让 C++ **tr1**成员（尤其是 shared_ptr，但我们希望函数和绑定以及所有其他成员）与**GCC 3.4.4**（用于诺基亚**N810**平板电脑）一起工作。

有人做过吗？尝试过这个？

我们升级到 GCC 4.x 来为这个设备进行交叉编译可能是**不可行**的（但如果你已经这样做了，我们很想知道）。

可能有很多方法，我想避免其他人遇到的死胡同。

我们试图避免引入 boost，因为它可能是相互依赖的（你引入了一个 boost header，你最终会得到 20 个以上），并且保持代码大小对我们很重要。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T06:10:58.063

至少对于来自 boost 的 shared_ptr，依赖项的数量非常少。您也可以使用[bcp](http://www.boost.org/doc/libs/1_36_0/tools/bcp/bcp.html)从 boost 中提取子集，因此您不需要整个 boost 来编译您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T04:19:49.517

你能直接使用[Boost](http://www.boost.org/) ( [Smart Pointers](http://www.boost.org/libs/smart_ptr/) , [Bind](http://www.boost.org/libs/bind/) , [Function](http://www.boost.org/libs/function/) ) 吗？从[GCC changelogs](http://gcc.gnu.org/gcc-4.0/changes.html)中，实际的`std::tr1`东西只能从 4.0 开始。:-(

我知道 Boost 和 之间存在差异`std::tr1`，但希望这些可以令人满意地解决。让我知道它是如何为您工作的。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T04:30:37.307

在另一个主题上，我现在正在`g++-3.4`我的 Ubuntu 笔记本电脑上安装这个包，我将看看我是否可以`libstdc++`从它上面的 Subversion 主干编译。如果是这样，我会告诉你的！（如果没有，我也会告诉你。:-P）

# .net - 强制 ListView 在后台绘制

> ID：131448
> 
> 赞同：1
> 
> 时间：2008-09-25T04:14:00.607
> 
> 标签：.net, listview

我有一个 ListView，有时我需要放入大约 10000 个项目。ListViews 并不能很好地处理这个问题，它们在对项目进行排序并绘制它们时会锁定几秒钟。如果您单独添加项目，则更糟糕的是，锁定了近一分钟。

为了解决这个问题，我想在需要显示它之前尝试填充 ListView，但不幸的是它还有其他想法。它仅在我打开包含 ListView 的面板时才开始绘制，使程序挂起几秒钟。

关于如何消除这种延迟的任何想法？或者是否有另一个相对容易使用的组件更擅长显示大量数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T04:20:39.903

您需要使用[VirtualMode](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.virtualmode.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T04:35:38.463

好。如果您只想在后台加载内容，您可以尝试一个线程来填充 ListView，这将让表单加载。

如果您放置 Application.DoEvents(); ，我认为您不会暂停 当您加载项目时（允许表单重绘和接收事件）。

```
for (int ix=0; ix < 10000; ix ++)
{
 listView1.Items.Add(ix.ToString());
 Application.DoEvents();
} 
```

如果您不了解 VirtualMode，我想我的建议是好的

# python - 我是否必须在 Python 中导致 ValueError

> ID：131449
> 
> 赞同：5
> 
> 时间：2008-09-25T04:14:34.147
> 
> 标签：python, exception, list

我有这个代码：

```
chars = #some list

try:
    indx = chars.index(chars)
except ValueError:
    #doSomething
else:
   #doSomethingElse 
```

我希望能够做到这一点，因为我不喜欢故意导致异常：

```
chars = #some list

indx = chars.index(chars)

if indx == -1:
    #doSomething
else:
   #doSomethingElse 
```

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T04:47:35.690

请注意，后一种方法违背了 EAFP 普遍接受的“ [pythonic”哲学，即“请求宽恕比许可更容易”。](http://en.wikipedia.org/wiki/Python_syntax_and_semantics#Exceptions)，而前者紧随其后。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T04:16:25.653

```
if element in mylist:
    index = mylist.index(element)
    # ... do something
else:
    # ... do something else 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T07:27:39.813

对于您的列表是单字符串序列的特定情况，您可以通过预先将要搜索的列表更改为字符串（例如''.join（chars））来获得所需的内容。

然后，您可以使用 .find() 方法，该方法可以按您的意愿工作。但是，列表或元组没有相应的方法。

另一种可能的选择是改用字典。例如。

```
d = dict((x, loc) for (loc,x) in enumerate(chars))
...
index = d.get(chars_to_find, -1)  # Second argument is default if not found. 
```

如果您在列表中进行大量搜索，这也可能会表现得更好。但是，如果只是在一次性列表上进行一次搜索，那不值得。

# c# - 如何将 .net 属性应用于返回类型

> ID：131456
> 
> 赞同：17
> 
> 时间：2008-09-25T04:19:40.747
> 
> 标签：c#, .net, attributes, return-type

如何将 MarshalAsAttribute 应用于下面代码的返回类型？

```
public ISomething Foo()
{
    return new MyFoo();
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-09-25T04:24:44.713

根据[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)：

```
[return: MarshalAs(<your marshal type>)]
public ISomething Foo()
{
    return new MyFoo();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T04:25:35.307

```
[return:MarshalAs]
public ISomething Foo()
{
    return new MyFoo();
} 
```

# windows - Windows Perl 下的 EWOULDBLOCK 等效 errno

> ID：131473
> 
> 赞同：10
> 
> 时间：2008-09-25T04:26:26.207
> 
> 标签：windows, perl, magic-numbers, errno

G'day Stackoverflowers，

我是 Perl 的[autodie](http://search.cpan.org/perldoc?autodie) pragma 的作者，它改变了 Perl 的内置函数以在失败时抛出异常。它类似于[Fatal](http://search.cpan.org/perldoc?Fatal)，但具有词法范围、可扩展的异常模型、更智能的返回检查以及更好的错误消息。它将`Fatal`在 Perl 的未来版本（临时 5.10.1+）中替换该模块，但目前可以从 Perl 5.8.0 及更高版本的 CPAN 下载。

下一个版本`autodie`将`flock`使用`LOCK_NB`（非阻塞）选项添加对调用的特殊处理。虽然失败的`flock`调用通常会导致 under 的异常，但如果返回的 errno( ) 为，则对using`autodie`的失败调用只会返回 false 。`flock``LOCK_NB``$!``EWOULDBLOCK`

这样做的原因是人们可以继续编写如下代码：

```
use Fcntl qw(:flock);

use autodie;   # All perl built-ins now succeed or die.

open(my $fh, '<', 'some_file.txt');

my $lock = flock($fh, LOCK_EX | LOCK_NB);  # Lock the file if we can.

if ($lock) {
    # Opportuntistically do something with the locked file.
} 
```

`EWOULDBLOCK`在上面的代码中，由于其他人已经锁定了文件`flock`（在我们正在使用不支持文件锁的文件系统或网络文件系统并且网络刚刚死机的情况下，当自动染色`flock`发现我们的 errno 不是时，它会生成一个适当的异常`EWOULDBLOCK`。

这在我的 Unix 风格系统上的开发版本中运行良好，但在 Windows 下却严重失败。看起来虽然 Windows 下的 Perl 支持该`LOCK_NB`选项，但它没有定义`EWOULDBLOCK`. 相反，当发生阻塞时，返回的 errno 是 33（“域错误”）。

显然我可以将它作为一个常量硬编码到`autodie`中，但这不是我想要在这里做的，因为这意味着如果 errno 改变（或已经改变），我会搞砸的。我很想将它与 Windows 等效的`POSIX::EWOULDBLOCK`. 如果你能帮忙，请告诉我。

我特别不想要的答案：

*   建议将其硬编码为常数（或者更糟糕的是，留下一个浮动的幻数）。
*   在 Windows 下根本不支持`LOCK_NB`功能。
*   假设`LOCK_NB`调用的任何失败`flock`都应仅返回 false。
*   我在 p5p 或[perlmonks](http://perlmonks.org/)上提出的建议。我已经知道他们了。
*   解释如何`flock`，或异常，或`Fatal`工作。我已经知道了。亲密无间。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-25T06:58:17.043

在 Win32“本机”Perl 下，请注意 $^E 在 33 处更具描述性，“进程无法访问文件，因为另一个进程锁定了文件的一部分” `ERROR_LOCK_VIOLATION`（可从[Win32::WinError 获得](http://search.cpan.org/dist/Win32-WinError/)）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T07:14:05.773

对于 Windows 特定的错误代码，您要使用`$^E`. 在这种情况下，它是 33：“该进程无法访问该文件，因为另一个进程已锁定文件的一部分”（`ERROR_LOCK_VIOLATION`in `winerror.h`）。

不幸的是，我不认为[Win32::WinError](http://search.cpan.org/dist/Win32-WinError/)是核心。另一方面，如果微软对 Windows 错误代码重新编号，几乎所有编写的 Windows 程序都会停止工作，所以我认为硬编码不会有问题。

# web-services - 使用 .NET 2.0 的 WSE 2.0 Web 服务客户端

> ID：131475
> 
> 赞同：1
> 
> 时间：2008-09-25T04:26:47.987
> 
> 标签：web-services, .net-2.0, wse2.0

从 .NET 2.0 访问 WSE 2.0 Web 服务的最佳方式是什么？使用 VS2005 的 Web 引用不起作用，因为生成的类使用 System.Web.Services 作为它们的基础（而不是 Microsoft.Web.Services2）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T05:00:00.293

我们使用 VS2003 生成和更新 Web 引用，并使用批处理文件将它们复制到 vs2005 和现在的 2008 项目。

# mysql - 防止 Mongrel/Mysql Errno::EPIPE 异常

> ID：131481
> 
> 赞同：0
> 
> 时间：2008-09-25T04:29:39.977
> 
> 标签：mysql, ruby-on-rails, timeout, mongrel

我有一个 Rails 应用程序，我很少提供 XML 服务。这是使用 mongrel 和 mysql 运行的。我发现如果我不使用该应用程序超过几个小时，它就会死机并开始抛出 Errno::EPIPE 错误。似乎mysql连接因不活动或类似情况而超时。

可以使用 'mongrel_rails restart -P /path/to/the/mongrel.pid' 重新启动它……但这并不是真正的解决方案。我的合作者希望应用程序在他工作时就在那里（我很可能不在身边）。

我的问题是：

*   我能做些什么来防止这个问题发生在第一个地方？（例如，不要让我超时！！）。
*   如果做不到这一点，是否可以在某处插入一些代码来自动重新建立 Db 连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T06:10:23.417

这是一个解决方案：

[https://boxpanel.blueboxgrp.com/public/the_vault/index.php/Mongrel_/_MySQL_Timeout](https://boxpanel.blueboxgrp.com/public/the_vault/index.php/Mongrel_/_MySQL_Timeout)

上述解决方案的超时对我来说似乎有点高。您不希望您的数据库超时太低，因为连接可以使用的内存量。如果一个连接是孤立的，你希望它合理地超时（比如不是在一周内。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T16:33:08.960

在其他地方，我也得到了以下建议：

1.  尝试将 **config.active_record.verification_timeout**设置为低于 mysql 连接超时设置的值。

2.  有一个 gem 可以解决这个问题：**mysql_retry_lost_connection**

    ```
     http://rubyforge.org/projects/zventstools/
     "Reconnect to the MySQL server when you hit a lost connection error". 
    ```

# reporting-services - 报告生成报告应花费的最长时间

> ID：131488
> 
> 赞同：0
> 
> 时间：2008-09-25T04:31:55.493
> 
> 标签：reporting-services, reporting, ssrs-2008-r2

我只是想知道报告服务在返回 1MB 数据时生成报告需要多长时间（以分钟为单位）。也许使用视图和表是正确的索引。SSRS 报告和服务器端生成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T16:12:57.553

报告生成时间有两个组成部分： - 数据采集时间 - 渲染时间

那么对于 1 Mb 的数据，我们在谈论多少条记录（行）？报告将有多少页？每页有多少个控件？报告是否使用图表？这些是决定生成时间的因素。

对于**大多数**报告，数据采集时间是最重要的因素。您的报告永远不会比原始数据采集运行得更快。因此，如果您使用 SQL，则生成报告的速度不会快于运行查询所需的时间。我看到查询很快返回超过 1Mb 的数据。我还看到了返回非常少数据的查询，这些查询运行了很长时间。

在渲染方面，有几件事会导致报表运行缓慢。第一个是报告聚合。如果一个报表需要在开始渲染之前接收所有的记录，那么它的性能就会受到影响。特别是，取决于报告工具。对于大型数据集（超过 10,000 条记录），您可以通过在源 (DB) 处进行聚合来显着改进渲染。另一个是图表，它通常涉及大量的渲染开销和聚合。

大多数报告系统允许您内置计时器或日志记录，以帮助您调整报告的性能。最好在报告中构建计时器，它会告诉您报告用于获取数据的时间百分比，以及用于渲染的时间百分比。当你掌握了这些信息，你就会知道应该把精力集中在哪里。

如果您真的想评估报告工具的性能，最好的方法是构建一个可以读取平面文件或通过代码生成数据的报告。换句话说，消除数据库的影响，看看你的报告工具能多快生成页面。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T04:35:27.717

多长时间可以接受？取决于它在做什么，它运行了多少，诸如此类。如果每天或每天运行一次，任何低于 30 秒的时间都可以。如果它每周或每月运行一次，这个数字可能会高得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T04:41:49.713

报告本身通常非常快，如果您看到挂起，您可能需要检查生成数据的查询的执行时间。一个复杂的查询可能需要很长时间，即使它只返回少量数据......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T05:16:49.393

我发现，在使用 BIRT 和其他报告系统时，最好的改进往往是通过将大部分工作卸载到后端的数据库来实现。

换句话说，不要通过网络发送大量数据并在本地对其进行排序或分组。几乎可以肯定，该数据库的 SQL orderby 和 groupby 子句以及优化索引（除其他外）将超越您。

这样，您可以更快地提取所需数据并减少网络流量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-28T20:24:43.830

正如一些人已经说过的那样，这样的一般问题确实无法回答。但是，我写了[Turbo-charge Your Report Speed – General Rules & Guidelines](http://blogs.windwardreports.com/davidt/2010/12/turbo-charge-your-report-speed-general-rules-guidelines.html)（免责声明 - 我是 Windward Reports 的 CTO，SSRS 的竞争对手）。我认为这将帮助您寻找可以做些什么来加快这个过程。

关于细节的所有警告都非常重要，在 3GHz 工作站上，我们通常会看到 7-30 页/秒。请记住，这是 Windward 的数字，而不是 SSRS。

# asp.net - 没有将我的 ASP.NET 2.0 站点移动到 ASP.NET 3.5，我错过了什么？

> ID：131498
> 
> 赞同：5
> 
> 时间：2008-09-25T04:36:12.127
> 
> 标签：asp.net, asp.net-mvc

我有一个使用 ASP.NET 2.0 的 Web 应用程序，我想知道是否应该将其移至 ASP.NET 3.5，特别是...不移至 ASP.NET 3.5 我错过了什么？

我了解缺点，但我不了解优点。

迁移/重写的最大好处是什么？

我会得到速度提升吗？

MVC 是否比我的老式 WebForm 应用程序容易得多？

会不会看起来更酷？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T04:37:43.200

您只会错过对较新的 .NET 3.5 库的访问，以及 LINQ 和 lambda 表达式等很酷的语法。在性能方面，它们的运行方式相同。

顺便说一句，.NET 3.5 还没有包含 ASP.NET MVC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T04:38:43.543

[新的 C# 3.0 编译器功能](http://msdn.microsoft.com/en-us/library/bb383815.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T04:40:35.207

是的，MVC 比您的老式 WebForm 应用程序容易得多。LINQ to SQL 也是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T04:44:10.877

我会说最大的事情是Linq。至少对我们来说是这样，因为我们正在用它完全替换旧的数据层！（慢慢地，但肯定地。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T09:01:20.277

还有其他与 .net2 (monorail, promesh,...) 一起使用的 MVC 框架，因此 mvc 与框架版本无关，它只是一种模式。

但是，我使用并发现有用的新框架功能：

*   LINQ、LINQ2SQL
*   扩展方法
*   WCF 服务
*   WF

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T05:50:37.363

LINQ，伙计。LINQ。在你尝试之前不要敲它。ORM 又好玩了！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T06:01:11.283

LINQ，但不是 LINQ to SQL（我不太喜欢）。LINQ to XML 和 LINQ to Objects 非常棒。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T06:21:16.430

Lambda 表达式 FTW！Linq 的集合扩展方法与 lambda 表达式相结合非常棒。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T06:24:31.430

还没有人提到扩展方法？！？见[http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx](http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx)

以及上面的项目（尤其是 LINQ、Lambda 表达式、对象、集合和属性初始化器等）。

# browser - 您在新网站上针对哪些浏览器和操作系统？

> ID：131508
> 
> 赞同：4
> 
> 时间：2008-09-25T04:42:53.143
> 
> 标签：browser, compatibility

当你在一个新网站上工作时，你的目标是浏览器和操作系统的哪些组合，以及优先级是什么？您是否发现针对一些特定组合（并忽略其余组合）比努力使它们都按预期工作更好？

常用浏览器：

*   火狐（1.5、2、3）
*   Internet Explorer（6、7、8-beta）
*   歌剧
*   铬合金

常用操作系统：

*   视窗（XP、Vista）
*   Mac OSX
*   Linux
*   Unix

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T05:15:56.637

主要是我只是针对浏览器，因为我建立的网站并不真正依赖于任何特定于操作系统的东西。如上所述，YAHOO 的分级浏览器支持指南是确定您应该/可以支持哪些浏览器的良好起点。雅虎的用户界面库 (CSS+JavaScript) 极大地帮助了实现这一目标。

但是在开发网站时，我主要在 Firefox2 上进行，因为它拥有最好的 Web 开发工具（firebug + wed developer toolkit）。然后我还使用 Opera 9.5 测试我的网站，因为它是我浏览的首选*浏览*器。我以前对在任何合理的水平上支持 IE6 都失去了所有希望，所以这些天我只是通知我的用户升级到 IE7，它几乎能够显示类似于 FF2/3+Chrome+Opera 的网站。

FF3 和 Chrome 现在太新了，我倾向于忽略它们，但我必须说：它们太快了！我的 javascript/css 重站点使用它们明显更快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T04:44:45.307

我正在做：

*   火狐 2 及更高版本
*   IE 7 及更高版本
*   Konquo​​rer 或 Safari（或者现在可能是 Chrome）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T04:47:06.453

雅虎的[分级浏览器支持](http://developer.yahoo.com/yui/articles/gbs/)是一个很好的指南：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T04:47:44.707

这取决于你的听众。如果你对技术用户很重视，你可能有 50% 的用户是 Firefox。如果你有很多爸爸妈妈，你可能会有 75-80% 的用户是 IE 6 或 7。你可能需要使用谷歌分析来获得 alhpa/beta，这样你就可以衡量你的受众。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T04:45:12.153

我工作的地方，我们的目标

*   Windows 上的 Firefox 2 和 3
*   Mac 上的 Firefox 2 和 3
*   Windows 和 Mac 上的 Safari
*   IE 6 和 7

我们没有专门针对任何 Linux 浏览器，但如果它们在上面的列表中工作，那么它们很有可能在任何地方都可以工作。我们现在也在 Windows 上针对谷歌的 Chrome 浏览器进行测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T05:12:44.850

本周我刚刚发现，如果您稍微弯曲并弄清楚如何验证您的 HTML，您就更有可能不必关心跨浏览器的东西。

哦，是的，除了Javascript。

我先让它在Firefox中运行，这就是老板使用的。Opera 最后，这就是 Bob 使用的。哈哈，开个玩笑鲍勃。

但即便如此，您也永远不会安全，因为浏览器不兼容的细节以及您询问的 90% 的人无法真正告诉您他们使用的是哪个浏览器这一事实。

```
你能点击帮助和关于吗？（停顿）不是吗？哦，对了，你用的是IE7
```

甚至那个旧待机也不再起作用了。

我的建议是锁定 IE，就像它是一个终端服务器一样，然后尝试浏览您的网站。如果您可以单击所有内容并阅读所有内容，那么您就很清楚了。

如果您使用 sIFR 并且有人打电话告诉您您的徽标是颠倒的，那么是时候优先考虑并再次担心兼容性了，否则 IE 和 FF 就可以了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T16:44:58.490

无目标。对许多人进行测试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T23:48:51.250

在我工作的地方，我们在 Windows 上测试以下内容（按照优先顺序，基于来自谷歌分析的数据）：

1.  即 7
2.  即 6
3.  火狐 3
4.  火狐 2
5.  野生动物园 3

我们不打扰 Opera 或旧版本的浏览器，因为用户的百分比非常小，但是我们尽最大努力将所有内容编码为标准，因此应该不会有任何大问题。

当然，就像 Milhous 所说，这取决于您的特定受众。YMMV。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-26T00:07:33.607

我习惯的标准套件是：

1.  IE6（赢）
2.  IE7（获胜）
3.  火狐 1.5+ (win/mac)
4.  Safari 2+ (win/mac)
5.  Opera 9+ (win/mac)
6.  Chrome（到目前为止，如果它在 win 上清除 Safari 3.0，它似乎也清除了 Chrome）

您也可以笼统地声称支持 IE6/7、Gecko 和 WebKit……它涵盖了此处列出的所有内容，但 Opera 除外，还有一些未列出的内容。*仅仅*测试渲染引擎而不是浏览器版本的具体差异并且对结果感到满意要困难得多。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-28T14:04:00.320

我同意你应该尝试让它全部工作，但如果它是一个新站点，我会认真考虑放弃对 IE6 的支持。从开发的角度来看，如果您不需要支持它，它将为您节省数小时的头发拉扯时间。

您必须根据您的目标受众以及您是否愿意失去一些不愿意（或无法）升级其浏览器的客户来权衡这一点。

# delphi - Delphi 7 抱怨找不到文件

> ID：131516
> 
> 赞同：1
> 
> 时间：2008-09-25T04:45:15.663
> 
> 标签：delphi, makefile, packages

我有一个 BPG 文件，我已对其进行了修改，以用作我们公司自动构建服务器的 make 文件。为了让它工作，我不得不改变

```
用途 * 用途
  unit1 in 'unit1.pas' * unit1
  unit2 in 'unit2.pas' * unit2
   ... * ...

```

在 DPR 文件中让它工作，而编译器没有给我一些关于未找到 unit1.pas 的闲话。这很烦人，因为我想使用 BPG 文件来实际查看项目中的内容，并且每次添加新单元时，它都会将“unitx.pas”中的内容自动插入到我的 DPR 文件中。

我正在运行`make -f [then some options]`，我正在编译的 DPR 与 make 文件不在同一目录中，但我不确定这是否重要。只要`in 'unit1.pas`删除，一切都可以正常编译。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T09:25:06.660

可能是因为IDE中的搜索路径和命令行编译器的搜索路径不一样。如果您更改命令行编译器的 serach 路径，您可能能够使用与 IDE 中完全相同的源代码。

为命令行编译器配置搜索路径的一种方法是在名为 dcc32.cfg 的文件中进行。看一下帮助，IDE-help中有dcc32.cfg的简短描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T04:48:37.277

好吧，这种解决方法对我有用。

```
//{$定义包}
{$ifdef 包}
 用途
  “unit1.pas”中的unit1
  “unit2.pas”中的unit2
   ...
{$else}
 用途
  单元1
  单元2
   ...
{$endif}

```

唯一的问题是每当您添加一个新单元时，delphi 都会删除您`ifdef package`的顶部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T07:27:21.203

每次我必须将条件放入项目文件中时，我都会这样做：

```
program a;

uses
  ACondUnits;

... 
```

```
unit ACondUnits;

interface

uses
{$IFDEF UseD7MM}
  Delphi7MM;
{$ELSE}
  FastMM4;
{$ENDIF}

implementation

end. 
```

也许这个技巧也适用于包。没试过。

# .net - 构造函数变量是否应该直接传递给私有字段或属性？

> ID：131517
> 
> 赞同：3
> 
> 时间：2008-09-25T04:46:15.660
> 
> 标签：.net, oop, resharper

现在这是 .NET，但我确信主体应该适用于所有 OOP 语言，为了简化，我以 .NET 为例：

R# 通常是创建者构造函数并将传入变量传递给私有字段，对我来说，我倾向于将其传递给属性。

关于不同之处以及最佳实践是什么的任何意见？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T05:11:27.877

使用属性是可以的，只要它们不是虚拟的/覆盖的。属性本质上是方法，你不应该在构造函数中调用虚方法，因为可能还没有构造合适的类型。Microsoft 列出了他们自己的[一套指南](http://msdn.microsoft.com/en-us/library/ms229060.aspx)，只需向下滚动到底部即可查看相关指南和说明问题的代码片段（他们使用方法来说明问题，但正如我提到的 .NET 属性本质上是特殊方法）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T04:49:25.373

通过属性设置器传递参数允许您将任何验证代码仅保留在一个位置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T05:03:49.207

我建议将其发送到属性，而不是直接发送到私有字段，尽管您的实际实现将决定确切的条件。例如，有时在使用 Property 时会触发事件，而您不想在构造函数期间触发这些事件。或者您可能出于其他原因想要绕过 Property 逻辑。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T05:51:24.477

小心使用属性设置器。您可能在 setter 中有可能导致意外副作用的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T10:36:10.500

我在构造函数中操作字段。字段真正代表了对象的固有状态，构造函数的工作就是初始化这个内部状态。属性只是为了封装目的，并且是对象状态的公共接口的一部分。

在设置对象的内部状态之前应用于构造函数参数或属性输入值的转换逻辑可能会非常不同。无论如何，如果是这种情况，我曾经使用从属性设置器和构造器调用的显式转换方法，而不是直接在属性设置器上链接构造器。

如果根本没有逻辑，我看不出你为什么要在构造函数中使用属性设置器。

# asp.net - Web.Config 中的 HTTPHandler 标记会破坏 asmx 文件

> ID：131518
> 
> 赞同：2
> 
> 时间：2008-09-25T04:46:45.457
> 
> 标签：asp.net, web-services, configuration, web-config, httphandler

在我的 ASP.Net 1.1 应用程序中，我已将以下内容添加到我的 Web.Config（在 System.Web 标记部分中）：

```
<httpHandlers>
  <add verb="*" path="*.bcn" type="Internet2008.Beacon.BeaconHandler, Internet2008" />
</httpHandlers> 
```

这很好用，并且 HTTPHandler 为 .bcn 类型的文件启动，并完成它的工作。但是由于某种原因，所有 ASMX 文件都停止工作。知道为什么会这样吗？

干杯格雷格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T05:53:48.870

我明白了... CQ 你在正确的轨道上.. 我确实需要再次添加 .asmx 处理程序，但是 .net 1.1 特定的处理程序。最终代码如下：

```
<httpHandlers>
  <add verb="*" path="*.bcn" type="Internet2008.Beacon.BeaconHandler, Internet2008" validate="false" />
  <add verb="*" path="*.asmx" type="System.Web.Services.Protocols.WebServiceHandlerFactory, System.Web.Services, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" validate="false"/>
</httpHandlers> 
```

我希望没有其他文件类型因为这个声明而没有得到正确处理。:|

感谢格雷格的帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T04:50:45.337

听起来它是其中的一个继承的 <clear /> 虽然我不知道我以前是否见过这种行为，您可以将通用处理程序添加回来，让我为您找到代码。

```
<add verb="*" path="*.asmx" type="System.Web.Services.Protocols.WebServiceHandlerFactory, System.Web.Services" validate="false"> 
```

我认为这是正确的元素，试一试。

编辑：这很奇怪，我在这台机器上没有 2003 的副本，所以我无法打开 1.1，但我认为这是正确的声明。您可以尝试添加`validate="false"`到每个元素中，看看是否会有所不同。

# asp.net - 什么会导致 ASPNET AJAX 页面恢复到正常的 ASPX 模式？/ 更新面板坏了

> ID：131535
> 
> 赞同：1
> 
> 时间：2008-09-25T04:53:43.817
> 
> 标签：asp.net, ajax, updatepanel

我正在使用带有非常简单的 UpdatePanel 场景的 VS 2008。但我无法让 UpdatePanel 工作，而且似乎无法找出原因

事实上，我已经恢复到一个非常简单的示例来验证它不是我的代码： [http ://ajax.net-tutorials.com/controls/updatepanel-control/](http://ajax.net-tutorials.com/controls/updatepanel-control/)

在此示例中，我单击任一按钮，两个文本链接都会更新。

我没有收到任何错误，该页面的行为就像一个普通的 ASPX 页面。我需要检查什么。我已经在谷歌上搜索了一个小时，但没有找到我需要的东西。

**编辑：**适用于 Visual Studio Web 服务器，但不适用于 IIS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T05:09:16.527

如果它在本地工作，但在部署到远程服务器时没有，这通常表明您使用的是 ASP.NET 2.0，并且远程服务器上没有安装 ASP.NET AJAX 扩展。

如果它是您拥有管理控制权的服务器，您可以在此处下载安装程序：http: [//www.microsoft.com/downloads/details.aspx?FamilyID=ca9d90fa- e8c9-42e3-aa19-08e2c027f5d6&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=ca9d90fa-e8c9-42e3-aa19-08e2c027f5d6&displaylang=en)

如果是网络主机，请告诉他们一起行动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T11:32:01.760

另一种选择是检查您的 web.config。例如，您可以从 Visual Studio 创建一个新的启用 Ajax 的 ASP.NET 网站。这将生成正确的 web.config。复制现有 web.config 中的所有非 ajax 部分并设置好。这对我有用。

-Edoode

# .net - 您如何获得（.net）表单将恢复到的状态？

> ID：131537
> 
> 赞同：2
> 
> 时间：2008-09-25T04:54:08.967
> 
> 标签：.net, winforms

我有一个 Windows 应用程序，我想保存会话之间的大小、位置和 WindowState。然而，有一个警告。如果关闭时的状态被最小化，那么我想恢复到最后一个可见状态，即如果它在被最小化之前是正常的，或者如果它被最大化则最大化。

是否有属性，检查，调用这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T05:05:26.020

这是关于表单持久性和会话之间保存窗口状态的[示例。](http://www.codeguru.com/csharp/csharp/cs_misc/userinterface/article.php/c6353)

至于在窗口最小化之前保存状态，这是您需要通过“记住”最后两个窗口状态来处理自己的事情，没有属性/事件可以为您做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T05:10:45.633

您可以使用应用程序设置（用户范围），当 Form_Closing 事件在您的表单上触发时，您可以选择如何在使用 Properties.Settings.Default.Save() 保存设置之前修改设置；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T05:26:03.477

您可以在最小化/最大化之前“记住”恢复的位置。

您可以在保存位置之前恢复窗口，这样做的缺点是使您的窗口在关闭前闪烁。

或者您可以通过 InterOp 调用 Win32 函数 GetWindowPlacment，它返回恢复的矩形。

# delphi - 是否期望 Delphi 7 中项目组的所有单元都在一个文件夹中？

> ID：131540
> 
> 赞同：1
> 
> 时间：2008-09-25T04:57:47.677
> 
> 标签：delphi, standards, packages

也许这适用于其他 Delphi（我只使用了 7 个）。我们已经分解了代码，因此我们相当庞大的应用程序中的几乎每个 DLL 都位于不同的文件夹中。

我下载并插入 Delphi 的 99% 的开源内容都已将其所有源代码放入一个文件夹中。

这似乎是 Delphi 的开发人员对其用户的编码实践做出的假设，这可能并不明显。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T06:18:27.267

我不这么认为。事实上，在最近的版本中，他们为项目管理器添加了功能，以便更容易处理代码分布在不同目录中的事实（例如展平目录选项），所以我认为这是可以接受的有多少人组织他们的代码。

我怀疑这更多地与随着时间的推移有机增长的项目有关，以及是否有人花时间整理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T11:13:19.070

我绝对不会将所有资源都放在一个目录中，而是将它们放在有共同点的组中。例如，我相当广泛地使用 subversion externals（参见[http://www.dummzeuch.de/delphi/subversion/english.html](http://www.dummzeuch.de/delphi/subversion/english.html)，关于外部的部分）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T05:51:39.530

我更喜欢将不同的模块托管在不同的文件夹中，然后有一个在不同模块之间共享的单元的公共文件夹，使管理变得容易。例如

myClientServerApp:(parent) 客户端文件夹 :(child) server filder (child) lib - (child)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T00:24:38.477

回到 DELPHI 7，我也将所有文件放在一个文件夹中。小项目很容易，但大项目很难。所以我开始为所有大大小小的DELPHI项目创建一个文件夹结构。一年来，我一直在努力改进这个文件夹结构，每一个新项目我都会做一个小的改进，使它更简单、合乎逻辑、更有条理。这一天，我试图让它的某些部分可以共享给几个项目。它的工作正在进行中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T05:00:48.450

将所有单元放在一个文件夹中似乎可以让您在双重命名的单元中省去头疼的问题。

*   另一方面，在签入和签出版本控制时，将项目保存在不同的文件夹中可能会更方便。*   另一方面，像这样将它们分开并不会促进代码重用。

# search - Vim 中的高级搜索

> ID：131559
> 
> 赞同：7
> 
> 时间：2008-09-25T05:09:07.120
> 
> 标签：search, vim, vi

有没有办法在 Vim 中同时搜索多个字符串？我记得在某处读过它是可能的，但不知何故忘记了这项技术。

例如，我有一个文本文件，我想同时搜索“foo”和“bar”（不一定是单个字符串，可以完全位于不同的行中）。

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-25T05:12:51.493

```
/^joe.*fred.*bill/          : find joe AND fred AND Bill (Joe at start of line)
/fred\|joe                  : Search for FRED OR JOE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T05:17:21.093

实际上，我在发布此内容后不久就找到了答案（是的，我之前做过谷歌但无法找到它。可能只是搜索错误）

正确的解决方案是

/(foo\|bar)

@Paul Betts：必须逃脱管道

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T05:12:30.667

Vim 通过在命令模式下以 '/' 开头来支持正则表达式。

因此，使用“/(foo\|bar)”之类的东西（如前所述）可以解决问题。很高兴知道为什么会这样以及您正在使用什么（正则表达式）。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-09-25T05:10:05.213

```
/(foo|bar) 
```

# sql-server - SQL Server 供应工具

> ID：131566
> 
> 赞同：1
> 
> 时间：2008-09-25T05:11:18.097
> 
> 标签：sql-server, sql-server-2005

在 Server 2008 下运行的 SQL Server 2005 SP2 可以从 SQL Server 2005 Surface Ara 配置中选择“添加新管理员”。这将启动用于 Vista 的 SQL Server 2005 用户供应工具。然后，您可以授予诸如服务器系统管理员角色等权限。

当我这样做时，权限被复制并似乎已保存，但当我返回此工具时，很明显它们尚未保存。还有其他人经历过这个或知道如何“让它坚持”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T12:05:39.590

似乎该工具根本没有验证权限是否已被授予，并且它在每次运行时都授予权限，这对我来说没问题（您可以检查`sysadmin`服务器角色的成员。）

# c# - Linux/C++ 程序员到 C#/Windows 程序员

> ID：131589
> 
> 赞同：14
> 
> 时间：2008-09-25T05:21:13.627
> 
> 标签：c#, c++, windows, linux

我已经在 Linux 上使用 C++ 专门编码了一段时间。在我目前的工作中，它是一家以 C# 为主要语言的 Windows 商店。我重新训练自己使用 Visual Studio 而不是 emacs（主要原因是 VC 中的集成调试器，VC 中的 emacs 模式有帮助），设置 Cygwin（因为我不能没有外壳）并掌握托管语言的绳索。您认为我应该检查哪些工具、书籍、网站（除了 MSDN）或陷阱，以使自己成为更高效的 Windows/C# 编码器？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-25T08:55:22.457

从 C++ 切换到 C# 时要考虑的第一件事是，它们大多共享一些表面语法，但是随着您对 .Net 的深入研究，编程范式的差异会变得越来越大。

在开始编程之前了解 C# 核心编程范例，否则您可能会陷入用 C# 编写 C++ 程序的陷阱，这不是最好的主意。要习惯的最重要的事情是：

*   自动内存管理和垃圾收集，包括处置模式。了解基础知识和陷阱。
*   .Net 中的类、接口、结构和原语是什么，以及它们与 C++ 相比的行为方式。
*   事件、委托、属性、lambda 表达式，所有这些都是来自 C++ 的新概念。
*   .Net 泛型和模板之间的差异。
*   .Net 中的字符串、数组、自定义属性、反射、异常和线程基础，所有这些都在 .Net 中大量使用，您必须了解它们的复杂性才能有效地使用它们。
*   Winforms 和 ASP.Net（可能在 WPF 之后）、组件、控件、数据绑定中的 GUI 编程。.Net GUI 模型。

首先从向您介绍所有这些概念的通用 .Net 书籍开始。我首先推荐一本书，而不是阅读教程和文章，这样你就可以在最后**对 .Net 有一个全面的了解**。互联网上的文章可能无法做到这一点。我读过的最好的通用 .Net 书：

[**专业 C#，第 3 版。**](http://www.wrox.com/WileyCDA/WroxTitle/Professional-C-3rd-Edition.productCd-0764557599.html)作者：Simon Robinson、Christian Nagel、Karli Watson、Jay Glynn、Morgan Skinner、Bill Evjen

![专业 C#，第 3 版，ISBN：978-0-7645-5759-0](https://media.wiley.com/product_data/coverImage/99/07645575/0764557599.jpg)

其次，由于您来自 C++ 背景，并且您习惯于接近金属并以接近硬件工作方式的方式思考（原始内存管理（指针、内存分配等）我只能推荐**一个这本书**将真正**揭开**.Net 是什么以及它的作用：

[**CLR 通过 C#**](http://www.microsoft.com/MSPress/books/6522.aspx)由 Jeffrey Richter

![CLR 通过 C#，第二版 ISBN 9780735621633](https://i.stack.imgur.com/ofTpY.gif)

**这本书对每个 .Net 开发人员来说有多好**，我怎么强调都不过分，尤其是来自 C++ 并且同时是我读过的最好的 .Net 书籍之一。这本书是一种纯粹的阅读乐趣，涵盖的主题来自：

*   .Net 执行模型（从 MSIL 到本机代码）
*   内存管理（.net 运行时和垃圾收集器如何管理内存、堆布局、内存生成、终结、大对象堆）
*   设计类型
*   程序集加载、反射、应用程序域
*   还有很多 ...

这是我可以给任何人在尽可能短的时间内成为专家 C# 开发人员的**最佳建议。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T05:30:17.270

由于您已经知道如何使用 C++ 编程，请查看：

[C# 2.0 的程序员介绍](https://rads.stackoverflow.com/amzn/click/com/1590595017)，作者 Eric Gunnerson 和 Nick Wienholt

语言参考和一般 .net 信息之间的良好平衡。

类似地： [Essential .NET, Volume I: The Common Language Runtime](https://rads.stackoverflow.com/amzn/click/com/0201734117) by Don Box 和 Chris Sells

真正有趣的“幕后”上网本（但为 .net 版本 1 编写，因此可能有点过时）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T07:55:48.967

当我第一次使用 C# 时，我的背景主要是 C/Unix 和 Python，以及一些 java 和尘土飞扬的 2000 年老式 VB6。我在使用 Java 完成的工作中熟悉托管运行时，并且 .Net API 的外观与早期的 MS API 有点相似。

我发现 Troelsen 的[Pro C# 和 .Net 2.0 平台](https://rads.stackoverflow.com/amzn/click/com/1590594193)是一个非常好的 C#/.Net 资源。现在有更新的版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T05:37:59.373

阅读[.Net](http://msdn.microsoft.com/en-us/library/0xy59wtx.aspx)中的垃圾收集。来自 C++ 领域的人们习惯于显式的内存分配和管理。在 C# 中，显式内存管理几乎不存在。

您应该检查的另一个主题是 C# 泛型和 C++ 模板之间的区别。不过，我没有一个很好的链接。

根据您正在开发的产品，您可能不得不求助于从 C# 调用 Win32 API 函数。这是通过 P/Invoke 完成的，因此您可能还想了解一下它。如果您必须实际使用它，[http](http://pinvoke.net) ://pinvoke.net 对于大多数 Win32 API 来说是非常有用的 C# 声明集合。

您可能还想至少学习 COM 的基础知识，因为 C#/.Net 应用程序经常选择/需要重用来自第三方供应商的组件，这些组件通常作为 COM 组件实现。COM 是一个复杂的话题。我最喜欢的关于 COM 和 Essential COM 的书籍是 Don Box 和 Roger rimes 的 Professional DCOM。我会从图书馆借这些，因为你只需要阅读前几章（除非你想深入了解）。

如果您要编写客户端应用程序，则必须对窗口、消息和消息队列有基本的了解。您将为此使用 WPF/XAML 的 Winforms，这两种技术都可以很好地与您隔离细节；但是，为了能够编写好的代码，您需要知道幕后发生了什么。我不确定这会是一本好书，但 MSDN 有很多信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-09T10:40:47.337

查看 petzold 的[dotnet book zero](http://www.charlespetzold.com/dotnet/)。这可能会有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T05:24:11.857

给自己一份[Resharper](http://www.jetbrains.com/resharper/index.html)的副本。它可能是直接编码的最佳生产力工具。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-25T05:40:47.900

不应该是 CLR 的基础吗？使用哪种 .NET 语言不应该是不重要的吗？如果我浏览 .NET 文档，我可以决定是否要查看 VB.Net、C# 或 C++ 中的内容。因此，如果您了解 C++，为什么不应该使用“托管 C++”？

问候弗里德里希

# version-control - Visual Studio 的集成版本控制

> ID：131598
> 
> 赞同：0
> 
> 时间：2008-09-25T05:28:17.463
> 
> 标签：version-control, visual-studio-2005, visual-sourcesafe

您使用哪些版本控制系统来管理使用 Visual Studio (2005) 开发的项目？你会推荐什么，为什么？您发现您的顶级版本控制系统有哪些限制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T05:31:33.993

[多次](https://stackoverflow.com/questions/16073/alternatives-to-visual-sourcesafe-that-integrate-with-visual-studio) [覆盖](https://stackoverflow.com/questions/11857/what-do-you-use-as-a-good-alternative-to-team-system)[_](https://stackoverflow.com/questions/16832/lightweight-source-control)

[搜索按投票排序的“Visual Studio 源代码管理”](https://stackoverflow.com/search?s=visual%20studio%20source%20control&sort=votes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T05:30:54.820

我使用了 SourceGear 的 Vault - 它与 VS 以及 FogBugz 很好地集成在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T05:35:34.530

我们确实需要更多信息来提出好的建议。例如，ClearCase 非常强大，但除非您在一个规模不错的开发工作室，否则它会非常浪费，并且可能会降低整体生产力。

对于个人工作，我喜欢[SVN](http://www.visualsvn.com/ "SVN")，但这主要是个人品味和熟悉它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T05:39:30.400

无论你做什么，*都不要*学习 Git——在你学会它之后，你会意识到其他所有 SCM 都是垃圾，你会讨厌每一分钟都必须使用 Perforce、SVN 或（上帝帮助你）VSS/TFS

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T05:41:57.087

我曾经使用 SourceSafe，但已经切换到 Subversion，再也不会回去了。

我将[TortoiseSVN](http://tortoisesvn.tigris.org/)与[VisualSVN](http://www.visualsvn.com)一起使用。VisualSVN 提供与 Visual Studio 的 IDE 集成，因此感觉很像 SourceSafe。

第一个很大的好处是它在 HTTP 上运行得非常好，所以我可以与分布式团队一起工作。[我用CVSDude](http://www.cvsdude.com)托管我的文件。

其次，您不需要在编辑之前签出文件这一事实是一个巨大的好处，尤其是在处理位于 Visual Studio 项目之外的文件时。

第三，我的源代码实际上感觉很安全。具有讽刺意味的是，SourceSafe 从来没有这样做过......

# asp.net - 如何为 .Net 网站、Windows 服务等创建安装程序？

> ID：131600
> 
> 赞同：4
> 
> 时间：2008-09-25T05:29:44.247
> 
> 标签：asp.net, windows-services, windows-installer, installation

我需要创建一个安装程序来安装以下内容：

1.  ASP.Net 网站
2.  视窗服务
3.  SQL Express（如果未安装且用户没有 SQL Server）
4.  登打士图表
5.  ASP.Net AJAX v.1.0
6.  ReportViewer 控件（适用于 2.0 框架）
7.  检查框架先决条件 (2.0)
8.  配置 IIS 和 app.config（数据连接字符串等）

能够通过 VS 安装项目做到这一点是否现实？或者，我应该查看其他安装工具吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T05:31:27.003

您可以使用[WiX](http://wix.sourceforge.net/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T07:22:36.750

大多数适用于 Windows 的最佳开源工具和程序都是使用[NSIS分发的](http://nsis.sourceforge.net/Docs/)

ASP.Net 网站（没有列表 - stackoverflow 中的错误 - 代码没有格式化，而上面的列表..）

```
CreateDirectory $INSTDIR
SetOutPath $INSTDIR
; HERE UNZIP ACTUALLY THE FILES (ADD *.js files if needed ) 
; PACK ALL THE FILES EXCEPT THOSE WITH FILE EXTENSIONS after the /x
File /r /x *.suo /x *.MDF /x *.exclude /x *.ldf /x *.pl /x *.nsis /x *.cmd "siteFolderName\*.*" 
```

*   [Windows 服务](http://nsis.sourceforge.net/NSIS_Service_Lib)和[这里](http://www.codeproject.com/KB/system/WindowsService.aspx)
*   [SQL Express（如果未安装且用户没有 SQL Server）](https://stackoverflow.com/questions/150223/sql-2005-express-edition-install-new-instance)
*   Dundas Charts - 呼叫静默安装程序
*   ASP.Net AJAX v.1.0 - 调用静默安装程序
*   ReportViewer 控件（适用于 2.0 框架）
*   检查框架先决条件 (2.0) - 检查 NSIS 系统功能
*   配置 IIS 和 app.config（数据连接字符串等） - 我通过在安装程序中预配置文件并在安装时编写这些文件来完成此操作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T18:20:53.470

我用的是 WiX。我把头撞在墙上几天，然后掌握了窍门。如果您以前从未使用过 WiX，那么 WiX 邮件列表是关键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T07:58:18.783

正如我之前的演讲者已经说过的，我也建议您使用[WiX](http://wix.sourceforge.net/)。Visual Studio（直到 2008 版）还具有专有的内置安装程序系统。但我会避免使用它，因为您需要使用完整的 Visual Studio IDE 来编译它。您不能使用命令行构建脚本，因此在使用自动构建服务器时它是无用的。

WiX 为您提供可能需要的所有灵活性。据我所知，微软会将其用作 Visual Studio 2010 中的标准安装工具。

# excel - 为 MS Excel 进行版本控制的最佳方法

> ID：131605
> 
> 赞同：177
> 
> 时间：2008-09-25T05:31:27.143
> 
> 标签：excel, version-control

您在 MS Excel (2003/2007) 中使用了哪些版本控制系统？你会推荐什么，为什么？您发现您的顶级版本控制系统有哪些限制？

从这个角度来看，这里有几个用例：

1.  VBA 模块的版本控制
2.  不止一个人在处理 Excel 电子表格，他们可能正在对同一个工作表进行更改，他们希望将其合并和集成。此工作表可能包含公式、数据、图表等
3.  用户不太懂技术，使用的版本控制系统越少越好
4.  空间限制是一个考虑因素。理想情况下，只保存增量更改而不是整个 Excel 电子表格。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2010-01-05T02:28:20.737

我刚刚设置了一个使用 Bazaar 的电子表格，通过 TortiseBZR 手动签入/签出。鉴于该主题帮助我完成了保存部分，我想在这里发布我的解决方案。

*我的解决方案是创建一个电子表格，在保存时导出所有模块，并在打开时删除并重新导入模块。是的，这可能对转换现有电子表格有潜在危险。*

这允许我通过**Emacs**（是的，emacs）或在 Excel 中本地编辑模块中的宏，并在重大更改后提交我的 BZR 存储库。因为所有模块都是文本文件，所以 BZR 中的标准 diff 样式命令适用于我的源代码，但 Excel 文件本身除外。

我已经为我的 BZR 存储库设置了一个目录 X:\Data\MySheet。在 repo 中有我的每个模块的 MySheet.xls 和一个 .vba 文件（即：Module1Macros）。在我的电子表格中，我添加了一个免于导出/导入周期的模块，称为“VersionControl”。每个要导出和重新导入的模块都必须以“宏”结尾。

**“版本控制”模块的内容：**

```
Sub SaveCodeModules()

'This code Exports all VBA modules
Dim i%, sName$

With ThisWorkbook.VBProject
    For i% = 1 To .VBComponents.Count
        If .VBComponents(i%).CodeModule.CountOfLines > 0 Then
            sName$ = .VBComponents(i%).CodeModule.Name
            .VBComponents(i%).Export "X:\Tools\MyExcelMacros\" & sName$ & ".vba"
        End If
    Next i
End With

End Sub

Sub ImportCodeModules()

With ThisWorkbook.VBProject
    For i% = 1 To .VBComponents.Count

        ModuleName = .VBComponents(i%).CodeModule.Name

        If ModuleName <> "VersionControl" Then
            If Right(ModuleName, 6) = "Macros" Then
                .VBComponents.Remove .VBComponents(ModuleName)
                .VBComponents.Import "X:\Data\MySheet\" & ModuleName & ".vba"
           End If
        End If
    Next i
End With

End Sub 
```

接下来，我们必须为打开/保存设置事件挂钩来运行这些宏。在代码查看器中，右键单击“ThisWorkbook”并选择“查看代码”。您可能必须下拉代码窗口顶部的选择框才能从“（常规）”视图更改为“工作簿”视图。

**“工作簿”视图的内容：**

```
Private Sub Workbook_Open()

ImportCodeModules

End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

SaveCodeModules

End Sub 
```

我将在接下来的几周内适应这个工作流程，如果我有任何问题，我会发布。

感谢分享 VBComponent 代码！

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2010-01-07T15:52:46.910

[TortoiseSVN](http://tortoisesvn.tigris.org/)是一个非常出色的用于 Subversion 版本控制系统的 Windows 客户端。我刚刚发现它具有的一个功能是，当您单击以获取 Excel 文件版本之间的差异时，它将在 Excel 中打开这两个版本并突出显示（以红色显示）已更改的单元格。这是通过[此处](http://tortoisesvn.tigris.org/ds/viewMessage.do?dsForumId=4061&dsMessageId=878721)描述的 vbs 脚本的魔力完成的。

即使不使用 TortoiseSVN，您也会发现这很有用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-04-04T12:06:17.003

让我总结一下您希望进行版本控制的内容以及原因：

1.  什么：

    *   代码 (VBA)
    *   电子表格（公式）
    *   电子表格（值）
    *   图表
    *   ...
2.  为什么：

    *   审核日志
    *   合作
    *   版本比较（“差异”）
    *   合并

正如其他人在此处发布的那样，在现有版本控制系统之上有几个解决方案，例如：

*   吉特
*   水银
*   颠覆
*   市场

如果您唯一关心的是工作簿中的 VBA 代码，那么上面建议的方法 Demosthenex 或 VbaGit ( [https://github.com/brucemcpherson/VbaGit](https://github.com/brucemcpherson/VbaGit) ) 工作得很好，并且实施起来相对简单。优点是您可以依赖经过充分验证的版本控制系统并根据您的需要选择一个（查看[https://help.github.com/articles/what-are-the-differences-between-svn-and -git/](https://help.github.com/articles/what-are-the-differences-between-svn-and-git/)用于 Git 和 Subversion 之间的简要比较）。

如果您不仅担心代码，还担心工作表中的数据（“硬编码”值和公式结果），您可以使用类似的策略：将工作表的内容序列化为某种文本格式（通过 Range.Value）并使用现有的版本控制系统。这是一篇非常好的博客文章：[https ://wiki.ucl.ac.uk/display/~ucftpw2/2013/10/18/Using+git+for+version+control+of+spreadsheet+models+-+part +1+of+3](https://wiki.ucl.ac.uk/display/~ucftpw2/2013/10/18/Using+git+for+version+control+of+spreadsheet+models+-+part+1+of+3)

然而，电子表格比较是一个不平凡的算法问题。周围有一些工具，例如 Microsoft 的电子表格比较 ( [https://support.office.com/en-us/article/Overview-of-Spreadsheet-Compare-13fafa61-62aa-451b-8674-242ce5f2c986)、Exceldiff](https://support.office.com/en-us/article/Overview-of-Spreadsheet-Compare-13fafa61-62aa-451b-8674-242ce5f2c986) ( [http://exceldiff.arstdesign.com/](http://exceldiff.arstdesign.com/)）和 DiffEngineX（[https://www.florencesoft.com/compare-excel-workbooks-differences.html](https://www.florencesoft.com/compare-excel-workbooks-differences.html)）。但将这些比较与 Git 等版本控制系统集成是另一个挑战。

最后，您必须确定适合您需求的工作流程。如需简单、定制的 Git for Excel 工作流程，请查看[https://www.xltrail.com/blog/git-workflow-for-excel](https://www.xltrail.com/blog/git-workflow-for-excel)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-25T05:44:58.343

这取决于您是在谈论数据还是电子表格中包含的代码。虽然我非常不喜欢 Microsoft 的 Visual Sourcesafe 并且通常不会推荐它，但它确实可以轻松地与 Access 和 Excel 集成，并提供模块的源代码控制。

[事实上与 Access 的集成，包括查询、报告和模块作为可以版本化的单独对象]

MSDN 链接在[这里](http://msdn.microsoft.com/en-us/library/aa164816(office.10).aspx)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-25T09:19:09.170

我不知道有什么工具可以很好地做到这一点，但我已经看到了各种本土解决方案。它们的共同点是最小化版本控制下的二进制数据并最大化文本数据以利用传统 scc 系统的强大功能。去做这个：

*   像对待任何其他应用程序一样对待工作簿。分离逻辑、配置和数据。
*   将代码与工作簿分开。
*   以编程方式构建 UI。
*   编写构建脚本来重建工作簿。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-03-07T17:25:10.490

处理@Demosthenex 的工作、@Tmdean 和@Jon Crowell 的宝贵意见！（+1 他们）

**我将模块文件保存在工作簿位置旁边的 git\ dir 中。把它改成你喜欢的。**

**这不会跟踪对工作簿代码的更改。因此，由您来同步它们。**

```
Sub SaveCodeModules()

'This code Exports all VBA modules
Dim i As Integer, name As String

With ThisWorkbook.VBProject
    For i = .VBComponents.count To 1 Step -1
        If .VBComponents(i).Type <> vbext_ct_Document Then
            If .VBComponents(i).CodeModule.CountOfLines > 0 Then
                name = .VBComponents(i).CodeModule.name
                .VBComponents(i).Export Application.ThisWorkbook.Path & _
                                            "\git\" & name & ".vba"
            End If
        End If
    Next i
End With

End Sub

Sub ImportCodeModules()
Dim i As Integer
Dim ModuleName As String

With ThisWorkbook.VBProject
    For i = .VBComponents.count To 1 Step -1

        ModuleName = .VBComponents(i).CodeModule.name

        If ModuleName <> "VersionControl" Then
            If .VBComponents(i).Type <> vbext_ct_Document Then
                .VBComponents.Remove .VBComponents(ModuleName)
                .VBComponents.Import Application.ThisWorkbook.Path & _
                                         "\git\" & ModuleName & ".vba"
            End If
        End If
    Next i
End With

End Sub 
```

然后在工作簿模块中：

```
Private Sub Workbook_Open()

    ImportCodeModules

End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

    SaveCodeModules

End Sub 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-05-08T15:37:54.107

将@Demosthenex 的回答更进一步，如果您还想跟踪 Microsoft Excel 对象和用户窗体中的代码，您必须有点棘手。

首先我改变了我的`SaveCodeModules()`函数来解释我计划导出的不同类型的代码：

```
Sub SaveCodeModules(dir As String)

'This code Exports all VBA modules
Dim moduleName As String
Dim vbaType As Integer

With ThisWorkbook.VBProject
    For i = 1 To .VBComponents.count
        If .VBComponents(i).CodeModule.CountOfLines > 0 Then
            moduleName = .VBComponents(i).CodeModule.Name
            vbaType = .VBComponents(i).Type

            If vbaType = 1 Then
                .VBComponents(i).Export dir & moduleName & ".vba"
            ElseIf vbaType = 3 Then
                .VBComponents(i).Export dir & moduleName & ".frm"
            ElseIf vbaType = 100 Then
                .VBComponents(i).Export dir & moduleName & ".cls"
            End If

        End If
    Next i
End With

End Sub 
```

用户窗体可以像 VBA 代码一样导出和导入。唯一的区别是导出表单时将创建两个文件（您将获得每个用户表单的一个`.frm`和一个`.frx`文件）。其中一个包含您编写的软件，另一个是一个二进制文件，它（我很确定）定义了表单的布局。

Microsoft Excel 对象 (MEO)（意思是`Sheet1`、`Sheet2`等`ThisWorkbook`）可以导出为`.cls`文件。但是，当您想将此代码重新导入您的工作簿时，如果您尝试以与 VBA 模块相同的方式导入它，如果该工作表已存在于工作簿中，您将收到错误消息。

为了解决这个问题，我决定不尝试将 .cls 文件导入 Excel，而是将`.cls`文件作为字符串读入 excel，然后将此字符串粘贴到空的 MEO 中。这是我的 ImportCodeModules：

```
Sub ImportCodeModules(dir As String)

Dim modList(0 To 0) As String
Dim vbaType As Integer

' delete all forms, modules, and code in MEOs
With ThisWorkbook.VBProject
    For Each comp In .VBComponents

        moduleName = comp.CodeModule.Name

        vbaType = .VBComponents(moduleName).Type

        If moduleName <> "DevTools" Then
            If vbaType = 1 Or _
                vbaType = 3 Then

                .VBComponents.Remove .VBComponents(moduleName)

            ElseIf vbaType = 100 Then

                ' we can't simply delete these objects, so instead we empty them
                .VBComponents(moduleName).CodeModule.DeleteLines 1, .VBComponents(moduleName).CodeModule.CountOfLines

            End If
        End If
    Next comp
End With

' make a list of files in the target directory
Set FSO = CreateObject("Scripting.FileSystemObject")
Set dirContents = FSO.getfolder(dir) ' figure out what is in the directory we're importing

' import modules, forms, and MEO code back into workbook
With ThisWorkbook.VBProject
    For Each moduleName In dirContents.Files

        ' I don't want to import the module this script is in
        If moduleName.Name <> "DevTools.vba" Then

            ' if the current code is a module or form
            If Right(moduleName.Name, 4) = ".vba" Or _
                Right(moduleName.Name, 4) = ".frm" Then

                ' just import it normally
                .VBComponents.Import dir & moduleName.Name

            ' if the current code is a microsoft excel object
            ElseIf Right(moduleName.Name, 4) = ".cls" Then
                Dim count As Integer
                Dim fullmoduleString As String
                Open moduleName.Path For Input As #1

                count = 0              ' count which line we're on
                fullmoduleString = ""  ' build the string we want to put into the MEO
                Do Until EOF(1)        ' loop through all the lines in the file

                    Line Input #1, moduleString  ' the current line is moduleString
                    If count > 8 Then            ' skip the junk at the top of the file

                        ' append the current line `to the string we'll insert into the MEO
                        fullmoduleString = fullmoduleString & moduleString & vbNewLine

                    End If
                    count = count + 1
                Loop

                ' insert the lines into the MEO
                .VBComponents(Replace(moduleName.Name, ".cls", "")).CodeModule.InsertLines .VBComponents(Replace(moduleName.Name, ".cls", "")).CodeModule.CountOfLines + 1, fullmoduleString

                Close #1

            End If
        End If

    Next moduleName
End With

End Sub 
```

如果您`dir`对这两个函数的输入感到困惑，那只是您的代码存储库！因此，您可以将这些函数称为：

```
SaveCodeModules "C:\...\YourDirectory\Project\source\"
ImportCodeModules "C:\...\YourDirectory\Project\source\" 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-05-16T08:02:48.253

我使用**git**，今天我将[它 (git-xlsx-textconv)](https://github.com/tokuhirom/git-xlsx-textconv "这个（git-xlsx-textconv）")移植到 Python，因为我的项目基于 Python 代码，并且它与 Excel 文件交互。这至少适用于**.xlsx**文件，但我认为它也适用于**.xls**。[这是](https://gist.github.com/nmz787/c43bc109db915064f188 "这里是")github链接。我写了两个版本，一个是每行单独一行，另一个是每个单元格单独一行（写后者是因为**git diff**默认不喜欢换行，至少在 Windows 上是这样）。

这是我的**.gitconfig**文件（这允许不同的脚本驻留在我的项目的仓库中）：

```
[diff "xlsx"]
    binary = true
    textconv = python `git rev-parse --show-toplevel`/src/util/git-xlsx-textconv.py 
```

如果您希望脚本可用于许多不同的存储库，请使用以下内容：

```
[diff "xlsx"]
    binary = true
    textconv = python C:/Python27/Scripts/git-xlsx-textconv.py 
```

我的**.gitattributes**文件：

```
*.xlsx diff=xlsx 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-25T08:16:05.437

您可以做的一件事是在您的工作簿中包含以下代码段：

```
Sub SaveCodeModules()

'This code Exports all VBA modules
Dim i%, sName$

    With ThisWorkbook.VBProject
        For i% = 1 To .VBComponents.Count
            If .VBComponents(i%).CodeModule.CountOfLines > 0 Then
                sName$ = .VBComponents(i%).CodeModule.Name
                .VBComponents(i%).Export "C:\Code\" & sName$ & ".vba"
            End If
        Next i
    End With
End Sub 
```

我在互联网上找到了这个片段。

之后，您可以使用 Subversion 来维护版本控制。例如，通过使用 Subversion 的命令行界面和 VBA 中的“shell”命令。这样就可以了。我什至想自己做这个:)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-08-09T19:08:15.373

我想推荐一个很棒的开源工具[Rubberduck](http://rubberduckvba.com/)，它内置了 VBA 代码的版本控制。试试吧！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-25T05:55:35.260

如果您正在寻找一个有普通办公室非技术用户的办公室环境，那么 Sharepoint 是一个可行的选择。您可以设置启用版本控制以及签入和签出的文档文件夹。让普通办公室用户更轻松。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-29T04:16:55.860

回应 mattlant 的回复 - 只有在文档库中打开版本控制功能时，sharepoint 才能作为版本控制正常工作。另外请注意，任何通过相对路径调用其他文件的代码都不起作用。最后，当文件保存在 sharepoint 中时，任何指向外部文件的链接都会中断。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-25T05:44:40.560

使用任何标准版本控制工具，如 SVN 或 CVS。限制将取决于目标是什么。除了存储库大小略有增加外，我没有遇到任何问题

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-10-27T22:35:11.150

我也一直在研究这个。似乎最新的 Team Foundation Server 2010 可能具有 Excel 加载项。

这是一个线索：

[http://team-foundation-server.blogspot.com/2009/07/tf84037-there-was-problem-initializing.html](http://team-foundation-server.blogspot.com/2009/07/tf84037-there-was-problem-initializing.html)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-10-12T00:50:53.963

在搜索了年龄并尝试了许多不同的工具之后，我在这里找到了我对 vba 版本控制问题的答案：[https ://stackoverflow.com/a/25984759/2780179](https://stackoverflow.com/a/25984759/2780179)

这是一个简单的 excel 插件，代码可以在[这里找到](https://github.com/hilkoc/vbaDeveloper)

导入后没有重复的模块。只要您保存工作簿，它就会自动导出您的代码，*而无需修改任何现有工作簿*。它带有一个 vba 代码格式化程序。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-04-12T17:00:40.507

实际上，只有少数解决方案可以跟踪和比较宏代码的变化——其中大部分已经在这里命名。我一直在浏览网页，发现了这个值得一提的新工具：

[VBA 宏的 XLTools 版本控制](https://xltools.net/version-control-for-vba-macros/)

*   Excel 工作表和 VBA 模块的版本控制
*   在提交版本之前预览和比较更改
*   非常适合多个用户在同一个文件上的协作工作（跟踪谁更改了什么/何时/评论）
*   逐行比较版本并突出显示代码中的更改
*   适合不精通技术或不精通 Excel 的用户
*   版本历史存储在您自己 PC 上的 Git 存储库中 - 任何版本都可以轻松恢复

[VBA 代码版本并排，更改可视化](http://i.stack.imgur.com/KFiQU.png)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-01-04T14:46:11.080

还有一个名为**Beyond Compare**的程序，它有一个相当不错的 Excel 文件比较。我找到了一个中文截图，简要说明了这一点：

![Beyond Compare - 比较两个excel文件（中文）](https://i.stack.imgur.com/EQw6F.jpg)
[原图来源](http://www.cnblogs.com/HarryHuang/archive/2010/03/08/1680929.html)

[他们的页面](http://www.scootersoftware.com/)上有 30 天的试用期

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-07-06T06:48:22.107

您可能已经尝试在 zip 容器（.xlsx 和 .xslm）中使用 Microsoft 的 Excel XML 进行版本控制，发现 vba 存储在 vbaProject.bin 中（这对版本控制没有用处）。

解决方案很简单。

1.  使用 LibreOffice Calc 打开 excel 文件
2.  在 LibreOffice 中
    1.  文件
    2.  另存为
    3.  另存为类型：ODF 电子表格 (.ods)
3.  关闭 LibreOffice Calc
4.  将新文件的文件扩展名从 .ods 重命名为 .zip
5.  在 GIT 维护的区域中为电子表格创建一个文件夹
6.  将 zip 解压到它的 GIT 文件夹中
7.  致力于 GIT

当您对电子表格的下一个版本重复此操作时，您必须确保使文件夹的文件与 zip 容器中的文件完全匹配（并且不要留下任何已删除的文件）。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-02-18T21:08:24.547

我找到了一个非常简单的解决方案来满足我的需求。我在所有宏的底部添加了一行，`*.txt`每次运行时都会导出一个包含整个宏代码的文件。编码：

```
ActiveWorkbook.VBProject.VBComponents("moduleName").Export"C:\Path\To\Spreadsheet\moduleName.txt" 
```

（在[Tom's Tutorials](https://www.atlaspm.com/toms-tutorials-for-excel/toms-tutorials-for-excel-exporting-vba-module-code-to-a-text-file/)上找到，其中还涵盖了一些设置，您可能需要让它工作。）

因为我总是在处理代码时运行宏，所以我保证 git 会接受这些更改。唯一烦人的部分是，如果我需要签出早期版本，我必须手动将其复制/粘贴`*.txt`到电子表格中。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-09-25T05:45:05.473

这取决于您想要什么级别的集成，我使用了 Subversion/TortoiseSVN，这对于简单的使用来说似乎很好。我还添加了关键字，但似乎存在文件损坏的风险。Subversion中有一个选项可以使关键字替换固定长度，据我所知，如果固定长度是偶数但不是奇数，它将起作用。在任何情况下，您都没有获得任何有用的差异功能，我认为有些商业产品会做“差异”。我确实找到了一些基于将内容转换为纯文本并进行比较的差异，但它不是很好。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2008-09-25T05:52:30.883

它应该适用于大多数 VCS（取决于您可能选择 SVN、CVS、Darcs、TFS 等的其他标准），但它实际上是完整的文件（因为它是二进制格式），这意味着“发生了什么变化”的问题是没那么容易回答。

*如果*人们完成它们，您仍然可以依赖日志消息，但您也可以尝试 Office 2007 中基于 XML 的新格式以获得更多可见性（尽管仍然很难清除大量 XML，加上 AFAIK XML 文件压缩在磁盘上，因此您需要一个预提交挂钩来解压缩它以使文本差异正常工作）。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2012-01-05T06:36:21.760

我使用 VBA 编写了一个版本控制的电子表格。它更适用于工程报告，其中您有多个人在处理物料清单或计划，然后在某个时间点您想要创建一个快照修订，显示上一个修订的添加、删除和更新。

注意：这是一个启用宏的工作簿，您需要登录才能从我的站点下载（您可以使用 OpenID）

所有代码都已解锁。

[Rev 受控电子表格](http://www.run8tech.com/tools.aspx)

# handle - 标准化错误分类和处理

> ID：131609
> 
> 赞同：4
> 
> 时间：2008-09-25T05:32:43.350
> 
> 标签：handle, standardized

我需要标准化我如何“优雅地”分类和处理错误/异常。

我目前使用一个过程，通过该过程将错误报告给传递错误号、严重性代码、位置信息和额外信息字符串的函数。如果错误是致命的并且应用程序应该死掉，则此函数返回布尔值 true，否则返回 false。作为其过程的一部分，除了向用户提供视觉反馈外，该功能还记录到某些严重级别以上的错误。

错误编号索引解释错误类型的字符串数组，例如：“文件访问”、“用户输入”、“线程创建”、“网络访问”等。严重性代码是 0,1 的二进制或， 2 或 4，0=提供信息，1=user_retry，2=cannot_complete，4=cannot_continue。Location-info 是模块和函数，Extra-info 是参数和局部变量值。

我想把它变成一种标准的错误处理方式，我可以把它放在一个库中并在我的所有应用程序中重复使用。我主要在 Linux 上使用 C/C++，但也希望将生成的库与其他语言/平台一起使用。

*   一个想法是扩展错误类型数组以指示给定严重级别的某些默认行为，但这是否应该成为所采取的操作并且不给用户选项？

*   或者：这样的扩展是否应该是用户需要从中选择的选项的子数组？这样做的问题是，这些选项必须是通用的与编程相关的选项，这可能会完全让最终用户感到困惑。

*   或者：每个使用 error-lib 例程的应用程序是否应该传递自己的错误或默认行为数组 - 但这会破坏库的目的......

*   或者：是否应该在每个应用程序中处理严重性级别？

或者：你有什么建议？你如何处理错误？我该如何改进呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T16:02:00.450

您如何处理错误实际上取决于应用程序。Web 应用程序具有与桌面应用程序不同的错误捕获机制，并且两者都与异步消息传递系统有很大不同。

That being said the a common practice in error handling is to handle it at the lowest possible level where it can be dealt with. This usually means the Application Layer or the GUI.

I like the severity levels. Perhaps you can have a pluggable Error-collection library with different error output providers and severity level provider.

Output providers could include things like a logginProvider and IgnoreErrorsProvider. Severity providers would probably be something implemented by each project since severity levels are usually determined by that type of project in which it occurs. (For example, network connection issues are more severe for a banking application than for a contact management system).

# string - 使用 XSLT 1.0 将字符串限制为列入白名单的字符

> ID：131619
> 
> 赞同：0
> 
> 时间：2008-09-25T05:38:16.190
> 
> 标签：string, xslt, whitelist

## 问题

使用 XSLT 1.0，给定一个带有任意字符的字符串，我如何才能取回符合以下规则的字符串。

1.  第一个字符必须是以下之一：az、AZ、冒号或下划线
2.  所有其他字符必须是上述任何字符或 0-9、句点或连字符
3.  如果任何字符不符合上述规则，请用下划线替换

## 背景

在 XSLT 中，我将一些属性转换为元素，但我需要确保该属性不包含任何不能在元素名称中使用的值。我不太关心被转换为名称的属性的完整性，只要它被可预测地转换。我也不需要补偿元素名称中的*每个*有效字符（有一堆）。

我遇到的问题是带有空格的属性，翻译函数可以轻松地将其转换为下划线：

```
translate(@name,' ','_') 
```

但是不久之后我发现了一些使用斜线的属性，所以我现在也必须添加它。这将很快失控。我希望能够定义允许字符的白名单，并用下划线替换任何不允许的字符，但翻译的工作原理是从黑名单中替换。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T09:01:44.360

您*可以*编写一个递归模板来执行此操作，逐个处理字符串中的字符，测试它们并在必要时更改它们。就像是：

```
<xsl:template name="normalizeName">
  <xsl:param name="name" />
  <xsl:param name="isFirst" select="true()" />
  <xsl:if test="$name != ''">
    <xsl:variable name="first" select="substring($name, 1, 1)" />
    <xsl:variable name="rest" select="substring($name, 2)" />
    <xsl:choose>
      <xsl:when test="contains('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:_', $first) or
                      (not($first) and contains('0123456789.-', $first))">
        <xsl:value-of select="$first" />
      </xsl:when>
      <xsl:otherwise>
        <xsl:text>_</xsl:text>
      </xsl:otherwise>
    </xsl:choose>
    <xsl:call-template name="normalizeName">
      <xsl:with-param name="name" select="$rest" />
      <xsl:with-param name="isFirst" select="false()" />
    </xsl:call-template>
  </xsl:if>
</xsl:template> 
```

但是，如果您准备好进行一些黑客攻击，则可以使用更短的方法来执行此操作。首先声明一些变量：

```
<xsl:variable name="underscores"
  select="'_______________________________________________________'" />
<xsl:variable name="initialNameChars"
  select="'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:_'" />
<xsl:variable name="nameChars"
  select="concat($initialNameChars, '0123456789.-')" /> 
```

*现在的技术是通过将名称中所有*合法的字符替换为空来获取名称并识别*不*合法的字符。您可以使用该功能执行此操作。一旦您获得了字符串中出现的一组非法字符，您可以再次使用该函数将它们替换为下划线。这是模板：*`translate()``translate()`*

 *```
<xsl:template name="normalizeName">
  <xsl:param name="name" />
  <xsl:variable name="first" select="substring($name, 1, 1)" />
  <xsl:variable name="rest" select="substring($name, 2)" />
  <xsl:variable name="illegalFirst"
    select="translate($first, $initialNameChars, '')" />
  <xsl:variable name="illegalRest"
    select="translate($rest, $nameChars, '')" />
  <xsl:value-of select="concat(translate($first, $illegalFirst, $underscores),
                               translate($rest, $illegalRest, $underscores))" />
</xsl:template> 
```

唯一需要注意的是，下划线字符串需要足够长，以覆盖单个名称中可能出现的所有非法字符。使它的长度与您可能遇到的最长名称的长度相同就可以解决问题（尽管您可能会逃脱它的长度要短得多）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T06:10:26.660

据我所知，XSLT 1.0 没有为此内置的。XSLT 2.0 允许您[使用 regexes](http://www.xml.com/pub/a/2003/06/04/tr.html)，尽管我确信您非常清楚这一点。

如果您使用 MS 解析器的机会不大，您可以编写可以在 XSLT 中利用的 .NET 扩展库，[几个月前我在这里写过这个。](http://www.nervoustych.com/blog/PermaLink,guid,e5e1b63a-1859-43f0-8672-abe5da8f3237.aspx)

如果您使用像撒克逊这样的东西，我很确定他们也提供了编码您自己的扩展的方法，他们可能确实已经有自己的扩展，但我不熟悉那个引擎。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T22:24:06.600

作为另一种选择，在 XSLT 标准库中有一个可能对您有用的字符串函数。[http://xsltsl.sourceforge.net/string.html#template.str:string-match](http://xsltsl.sourceforge.net/string.html#template.str:string-match)

# exception - 您更喜欢如何组织异常定义？

> ID：131623
> 
> 赞同：8
> 
> 时间：2008-09-25T05:39:48.230
> 
> 标签：exception, language-agnostic

我几乎不好意思问，但我总是在如何组织异常定义上苦苦挣扎。我之前做过的三种方法是：

*   使用每类文件规则。我对此并不感到疯狂，因为它弄乱了我的目录结构和命名空间。我可以将它们组织成子目录并为它们分段命名空间，但我不太喜欢这样，标准库通常不会这样做。
*   将定义放在包含相关类的文件中。我也不喜欢这样，因为异常定义分散在各处，如果没有代码导航工具的帮助，可能很难找到。
*   一个包含命名空间或相关类“包”的所有异常定义的文件。这是上述两者之间的一种折衷，但它可能会留下难以分辨哪些异常“属于”特定类或一组功能的情况。

我真的不喜欢上述任何一种，但是有没有一种我没有接受的最佳实践会更好？

编辑：有趣。从“Programming Microsoft Visual C# 2008: The Language”中，Donis 建议：

> 为了方便和可维护性，将应用程序异常作为一个组部署在单独的程序集中。（第 426 页）

我想知道为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T06:05:34.130

我倾向于将每个文件的异常放置在与生成它们的对象相同的包中，在单个文件中。这是 Java API 和 .Net 库使用的范例，因此大多数人至少熟悉此时的对象组织。

现代 IDE 在跟踪目录中的文件方面做得足够好，因此在同名文件中包含类的好处往往超过拥有更少文件的价值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T06:32:53.970

在 C++ 中，我总是在与抛出它们的类相同的命名空间中定义将用作异常的类，并将它们共同定位在同一个标​​头中。对于将在类之间共享的通用异常，我使用单个标头将它们与其他实用程序函数和类一起分组。

我不相信在这方面有任何一种正确的做事方式。在您的情况下，这对您有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T06:41:23.543

我使用以下方法：

*   单独文件中的异常类：当它是通用的并且可以被多个类抛出时
*   异常类连同抛出它的类：当只有一个这样的类时。这是有道理的，因为异常是该类接口的一部分

后者的一个变体是使异常成为抛出类的成员。我曾经这样做，但发现它很麻烦。

# c# - “无法评估表达式，因为当前方法的代码已优化。”是什么意思？意思是？

> ID：131628
> 
> 赞同：51
> 
> 时间：2008-09-25T05:40:52.317
> 
> 标签：c#, .net, debugging, optimization, compiler-construction

我写了一些带有大量递归的代码，这需要相当多的时间才能完成。每当我“暂停”运行以查看发生了什么时，我都会得到：

> > 无法评估表达式，因为当前方法的代码已优化。

我想我明白这意味着什么。然而，令我困惑的是，在我点击 step 之后，代码不再“优化”，我可以查看我的变量。这是怎么发生的？代码如何在优化代码和非优化代码之间来回翻转？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-12T09:46:40.347

虽然 Debug.Break() 行位于调用堆栈的顶部，但您无法评估表达式。那是因为那条线是优化的。按 F10 移动到下一行 - 有效的代码行 - 手表将工作。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-09-25T06:00:42.050

调试器使用 FuncEval 允许您“查看”变量。FuncEval 要求在托管代码中的 GarbageCollector 安全点停止线程。在 IDE 中手动“暂停”运行会导致所有线程尽快停止。您的高度递归代码往往会停在不安全的地方。因此，调试器无法评估表达式。

按 F10 将移动到下一个功能安全点并启用功能评估。

有关详细信息，请查看[FuncEval 的规则](http://blogs.msdn.com/jmstall/archive/2005/11/15/funceval-rules.aspx)。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-09-25T05:46:43.940

您可能正在尝试在发布模式而不是调试模式下调试您的应用程序，或者您在编译设置中打开了优化。

当使用优化编译代码时，某些变量一旦不再在函数中使用就会被丢弃，这就是您收到该消息的原因。在禁用优化的调试模式下，您不应该收到该错误。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-08-03T15:43:21.233

这让我发疯了。我尝试使用托管和本机代码附加 - 不行。

*这对我有用，我终于能够评估所有表达式：*

*   进入项目/属性
*   选择构建选项卡并单击高级...
*   确保调试信息设置为“完整”（不是 pdb-only）
*   调试您的项目 - 瞧！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-04-26T16:35:30.407

以下对我有用，谢谢@Vin。

我在使用 VS 2015 时遇到了这个问题。我的解决方案：选择了配置（调试）。我通过取消选中`Optimize Code`项目属性下的属性解决了这个问题。

> 项目（右键单击）=> 属性 => 构建（选项卡）=> 取消选中优化代码

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-06T13:39:09.177

确保你没有类似的东西

```
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)] 
```

在你的`AssemblyInfo`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-14T02:34:27.097

寻找具有许多参数的函数调用并尝试减少数字直到调试返回。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T22:11:36.953

微软朋友的朋友发送了这个：http: [//blogs.msdn.com/rmbyers/archive/2008/08/16/Func_2D00_eval-can-fail-while-stopped-in-a-non_2D00_optimized-managed-method-that -push-more-than-256-argument-bytes-.aspx](http://blogs.msdn.com/rmbyers/archive/2008/08/16/Func_2D00_eval-can-fail-while-stopped-in-a-non_2D00_optimized-managed-method-that-pushes-more-than-256-argument-bytes-.aspx)

最可能的问题是您的调用堆栈正在优化，因为您的方法签名太大。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-10T14:44:08.847

有同样的问题，但能够通过关闭调试器中的异常捕获来解决它。单击[Debug][Exceptions]并将异常设置为“User-unhandled”。

通常我会关闭它，但它偶尔会派上用场。我只需要记住在完成后将其关闭。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-05-02T21:42:04.370

我在使用 VS 2010 时遇到了这个问题。我的解决方案配置已选择（调试）。我通过取消选中项目属性下的优化代码属性解决了这个问题。项目（右键单击）=> 属性 => 构建（选项卡）=> 取消选中优化代码

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-13T22:00:50.700

就我而言，我的解决方案中有 2 个项目，并且正在运行一个不是启动项目的项目。当我将其更改为启动项目时，调试再次开始工作。

希望它可以帮助某人。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-28T11:43:38.793

评估：

在 .NET 中，“函数评估 (funceval)”是 CLR 在调试对象在某处停止时注入一些任意调用的能力。Funceval 负责调试器选择的线程来执行请求的方法。一旦 funceval 完成，它会触发一个调试事件。从技术上讲，CLR 已经定义了调试器发出 funceval 的方法。

CLR 只允许在那些处于 GC 安全点（即线程不会阻塞 GC）和功能安全 (FESafe) 点（即 CLR 实际上可以为 funceval 劫持）的线程上启动 funceval。因此，对于 CLR 的可能场景，线程必须是：

1.  在托管代码中停止（并且在 GC 安全点）：这意味着我们不能在本机代码中执行 funceval。由于本机代码不在 CLR 的控制范围内，因此无法设置 funceval。

2.  在第一次机会或未处理的托管异常时停止（并且在 GC 安全点）：即在异常时，尽可能多地检查以确定该异常发生的原因。（例如：调试器可能会尝试评估并查看引发异常的 Message 属性。）

总体而言，在托管代码中停止的常见方法包括在断点、步骤、Debugger.Break 调用、拦截异常或线程启动处停止。这有助于评估方法和表达式。

可能的解决方案：根据评估，如果线程不在FESafe和GCSafe点，CLR将无法劫持线程启动funceval。通常，以下有助于确保 funceval 在预期时启动：

第1步：

确保您没有尝试调试“发布”版本。发布是完全优化的，因此会导致讨论中的错误。通过使用标准工具栏或配置管理器，您可以在调试和发布之间切换。

第2步：

如果您仍然收到错误，则可能会设置 Debug 选项以进行优化。验证并取消选中项目“属性”下的“优化代码”属性：

右键单击项目选择选项“属性”转到“构建”选项卡取消选中“优化代码”复选框</p>

第 3 步：

如果您仍然收到错误，则调试信息模式可能不正确。在“高级构建设置”下验证并将其设置为“完整”：

右键单击项目选择选项“属性”转到“构建”选项卡单击“高级”按钮将“调试信息”设置为“完整”</p>

第4步：

如果您仍然遇到问题，请尝试以下操作：

对解决方案文件进行“清理”然后“重建” 调试时：转到模块窗口（VS 菜单 -> 调试 -> Windows -> 模块）在已加载模块列表中找到您的程序集。检查针对加载的程序集列出的路径是您期望的路径检查文件的修改时间戳以确认程序集实际上已重建检查加载的模块是否已优化

结论：

这不是错误，而是基于某些设置的信息，并且是根据 .NET 运行时的工作方式设计的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-03-20T03:35:01.673

在我的情况下，我处于发布模式，我更改为调试它一切正常

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-11-08T09:07:58.487

我有一个类似的问题，当我在调试模式下构建解决方案并替换执行路径中的 pdb 文件时，它得到了解决。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-09-25T06:30:59.280

我相信你所看到的是优化的结果——有时一个变量会被重用——尤其是那些在堆栈上创建的变量。例如，假设您有一个使用两个（本地）整数的方法。第一个整数在方法的开头声明，并且仅用作循环的计数器。您的第二个整数在循环完成后使用，它存储稍后写入文件的计算结果。在这种情况下，优化器可能决定重用你的第一个整数，保存第二个整数所需的代码。当您尝试尽早查看第二个整数时，您会收到有关“无法评估表达式”的消息。虽然无法说明具体情况，

# html - 在 CSS 中充当 :hover 的内联样式

> ID：131653
> 
> 赞同：112
> 
> 时间：2008-09-25T05:51:40.480
> 
> 标签：html, css

我知道将 CSS 样式直接嵌入到它们影响的 HTML 标记中会破坏 CSS 的大部分用途，但有时它对于调试目的很有用，例如：

```
<p style="font-size: 24px">asdf</p> 
```

嵌入规则的语法是什么：

```
a:hover {text-decoration: underline;} 
```

进入A标签的样式属性？显然不是这个...

```
<a href="foo" style="text-decoration: underline">bar</a> 
```

...因为这将一直适用，而不仅仅是在悬停期间。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-09-25T05:55:13.983

恐怕做不到，伪类选择器不能在线设置，你必须在页面或样式表上做。

我应该提一下，*从技术上讲*，您*应该*能够[根据 CSS 规范](http://www.w3.org/TR/css-style-attr#cascading)来做到这一点，但大多数浏览器不支持它

**编辑：**我刚刚对此进行了快速测试：

```
<a href="test.html" style="{color: blue; background: white} 
            :visited {color: green}
            :hover {background: yellow}
            :visited:hover {color: purple}">Test</a> 
```

它不适用于 IE7、IE8 beta 2、Firefox 或 Chrome。其他人可以在任何其他浏览器中进行测试吗？

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-09-25T05:59:56.123

如果你只是调试，你可能会使用 javascript 来修改 css：

```
<a onmouseover="this.style.textDecoration='underline';" 
    onmouseout="this.style.textDecoration='none';">bar</a> 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2014-08-15T20:45:28.037

一个简单的解决方案：

```
<a href="#" onmouseover="this.style.color='orange';" onmouseout="this.style.color='';">My Link</a> 
```

或者

```
<script>
 /** Change the style **/
 function overStyle(object){
    object.style.color = 'orange';
    // Change some other properties ...
 }

 /** Restores the style **/
 function outStyle(object){
    object.style.color = 'orange';
    // Restore the rest ...
 }
</script>

<a href="#" onmouseover="overStyle(this)" onmouseout="outStyle(this)">My Link</a> 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-25T06:08:41.017

如果是用于调试，只需添加一个用于悬停的 css 类（因为元素可以有多个类）：

```
a.hovertest:hover
{
text-decoration:underline;
}

<a href="http://example.com" class="foo bar hovertest">blah</a> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-14T23:23:56.107

I put together a quick solution for anyone wanting to create hover popups without CSS using the onmouseover and onmouseout behaviors.

[http://jsfiddle.net/Lk9w1mkv/](http://jsfiddle.net/Lk9w1mkv/)

```
<div style="position:relative;width:100px;background:#ddffdd;overflow:hidden;" onmouseover="this.style.overflow='';" onmouseout="this.style.overflow='hidden';">first hover<div style="width:100px;position:absolute;top:5px;left:110px;background:white;border:1px solid gray;">stuff inside</div></div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-26T14:46:44.590

If that `<p>` tag is created from JavaScript, then you do have another option: use JSS to programmatically insert stylesheets into the document head. It does support `'&:hover'`. [https://cssinjs.org/](https://cssinjs.org/)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-25T06:11:49.747

[我认为jQuery](http://jquery.com)也不支持伪选择器，但它确实提供了一种快速的方法来将事件添加到单个页面上的一个、多个或所有类似的控件和标签。

最重要的是，如果需要，您可以链接事件绑定并在一行脚本中完成所有操作。比手动编辑所有 HTML 以打开或关闭它们要容易得多。再说一次，既然你可以在 CSS 中做同样的事情，我不知道它会给你带来什么（除了学习 jQuery）。

# c# - 有哪些使用命名空间的非标准方式？

> ID：131659
> 
> 赞同：-1
> 
> 时间：2008-09-25T05:54:02.317
> 
> 标签：c#, c++, namespaces

我对使用命名空间的前所未有的、酷炫的和深奥的方式很感兴趣。我知道许多高级开发人员通过例如将它们用作对字符串常量的引用来“破解”名称空间。在字符串常量示例中，想法是实现 DRY（DRY = 不要重复自己），您可以将所有字符串保存在一个文件中。

注意：我正在寻找与“通用”语言相关的答案，例如 C#、Ruby、Java 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T09:25:04.947

我经常使用的一种深奥用法是在 C++ 中定义枚举时，尤其是当某个上下文中有多种类型时。这使得在相关上下文中的`Quality::k_high`使用成为可能。`Importance::k_high`枚举还经常包含未知值（通常表示未设置任何值的情况），需要限定这些值以消除常量（例如`k_qualityNone`和`k_importanceNone`）的歧义，而使用命名空间可以避免这种情况。

因此，定义将如下所示：

```
命名空间质量{
   枚举类型 { k_high, k_medium, k_low, k_none };
}

```

和

```
命名空间重要性{
   枚举类型 { k_high, k_medium, k_low, k_none };
}

```

然后，函数和方法将接受一个类型为`Quality::Type`(and `Importance::Type`) 的参数，这是相当具有描述性和美观的。单个枚举常量也有类似的限定，如前所述 ( `Quality::k_low`)。

# java - 如何区分从 HTML 表单提交的 HTTP 请求和从客户端提交的 HTTP 请求？

> ID：131662
> 
> 赞同：0
> 
> 时间：2008-09-25T05:58:22.697
> 
> 标签：java, http

有什么方法（在 Java Servlet 中）可以确定 HTTP POST 或 GET 请求是来自 HTML 表单还是其他提交的结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T06:12:38.700

您可以使用隐藏的表单字段 + cookie 来做到这一点。

您可以做的是设置一个[nonce](http://en.wikipedia.org/wiki/Cryptographic_nonce)，并将其作为表单的隐藏字段。然后，您将其应用于与表单一起发送的 cookie。cookie 应该链接到隐藏字段，并且还应该包含某种随机数。最后，当表单提交时，你可以检查cookie和隐藏字段，看看它们是否正确。如果需要，将其链接到表单原始请求的 IP 地址和用户代理。你甚至可以用一些 Javascript 来增加这一切。首先将隐藏字段设为空白，然后使用一些 ajax 从服务器请求隐藏字段随机数。

这不会是完美的，但这应该会让你达到 80%-90% 的目标。但是，具有良好 HTTP 技能的人仍然可以欺骗它。

然而，它提出了一个问题，为什么要在该级别区分请求？

或者你真的只是想弄清楚用户是否点击了“提交”按钮？（如果是这种情况，那么提交按钮的名称/值对应该在请求实体/查询字符串中......取决于表单方法。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T06:00:20.990

我认为这是不可能的，除非客户端本身正在合作（意味着客户端设置了一些标题）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T06:00:40.130

并不真地。您可以检查用户代理字符串，但可以由调用者设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T06:00:48.930

好吧，您可以查看代理字符串，看看它是来自浏览器还是来自您的客户端应用程序（假设它有自己的代理字符串）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T06:14:32.953

如果您可以控制客户端，则可以附加自定义标头来识别发件人。

一些 javascript 库在生成 XmlHTTPRequests 时已经这样做了，因此您可以处理与标准请求不同的 Ajax 调用。

检查每个传入请求的标头，看看是否有任何可以使用的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T06:16:18.487

使用一些 JavaScript 来设置一些值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T07:04:25.407

您不清楚是要区分合法的不同访问方法，还是要对抗伪造的攻击（即试图看起来像普通用户的机器人或黑客）。

在第一种情况下，keprao 对检查标题有一些很好的建议。在第二种情况下，基本上无法区分请求，尽管机器人可能会受到验证码或身份验证的阻碍。

# windows-vista - Vista 和 ProgramData

> ID：131666
> 
> 赞同：15
> 
> 时间：2008-09-25T06:00:31.410
> 
> 标签：windows-vista, directory, shared, programdata

存储对每个用户都相同但必须对程序可写的程序数据文件的正确位置是什么？MS Windows XP 上的等效位置是什么？我读过 C:\ProgramData 在普通用户安装后不可写。真的吗？如何使用 Platform SDK 以编程方式检索该目录？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-25T06:09:17.270

`SHGetFolderPath()`CSIDL 为`CSIDL_COMMON_APPDATA`.

[在http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx)阅读更多内容

如果需要批处理文件中的路径，也可以使用`%ALLUSERSPROFILE%`环境变量。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-23T23:34:23.710

这里有不同选项的一个很好的总结：http: [//blogs.msdn.com/cjacks/archive/2008/02/05/where-should-i-write-program-data-instead-of-program-files .aspx](http://blogs.msdn.com/cjacks/archive/2008/02/05/where-should-i-write-program-data-instead-of-program-files.aspx)

> 我应该在哪里写程序数据而不是程序文件？
> 
> 一个常见的应用程序代码更新是这样的：“我的应用程序过去常常将文件写入程序文件。感觉就像放置它的好地方一样。它上面已经有我的应用程序的名称，而且因为我的用户是管理员，所以它工作得很好。但是现在我发现这可能不像我曾经想象的那么好，因为使用 UAC，即使管理员在大多数时间都以标准用户权限运行。所以，我应该把我的文件放在哪里？”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T00:17:29.093

实际上[`SHGetFolderPath`](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx)已弃用。

[`SHGetKnownFolderPath`](http://msdn.microsoft.com/en-us/library/bb762188(VS.85).aspx)应改为使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T06:10:52.773

您可以使用：

```
CString strPath;
::SHGetSpecialFolderPath(NULL, strPath.GetBuffer(1024), CSIDL_COMMON_APPDATA, FALSE); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T06:13:44.093

请参阅[Raymond Chen 关于这个特定问题的文章](http://blogs.msdn.com/oldnewthing/archive/2004/11/22/267890.aspx)。

简而言之，您要求的是一个**安全漏洞**。

# apache - 如何使用 Apache 实现速率限制？（每秒请求数）

> ID：131681
> 
> 赞同：90
> 
> 时间：2008-09-25T06:07:10.130
> 
> 标签：apache, apache2, ddos

哪些技术和/或模块可用于在 apache 中实现稳健的速率限制（请求|字节/IP/单位时间）？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-25T06:09:42.997

最好的

*   [mod_evasive](https://github.com/jzdziarski/mod_evasive)（更侧重于减少 DoS 暴露）
*   [mod_cband](http://dembol.org/blog/mod_cband/)（“正常”带宽控制的最佳功能）

其余的

*   [mod_limitipconn](http://dominia.org/djao/limitipconn.html)
*   [mod_bw](http://bwmod.sourceforge.net/)
*   [mod_bwshare](http://www.topology.org/src/bwshare/README.html)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-12-03T16:24:31.157

正如[这篇博](http://johnleach.co.uk/words/1073/rate-limiting-with-apache-and-mod-security)文中所述，似乎可以使用[mod_security](http://www.modsecurity.org/)来实现每秒速率限制。

配置是这样的：

```
SecRuleEngine On

<LocationMatch "^/somepath">
  SecAction initcol:ip=%{REMOTE_ADDR},pass,nolog
  SecAction "phase:5,deprecatevar:ip.somepathcounter=1/1,pass,nolog"
  SecRule IP:SOMEPATHCOUNTER "@gt 60" "phase:2,pause:300,deny,status:509,setenv:RATELIMITED,skip:1,nolog"
  SecAction "phase:2,pass,setvar:ip.somepathcounter=+1,nolog"
  Header always set Retry-After "10" env=RATELIMITED
</LocationMatch>

ErrorDocument 509 "Rate Limit Exceeded" 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-02-13T15:01:09.403

有很多方法，包括 Web 应用程序防火墙，但如果使用 Apache mod，最容易实现。

我喜欢推荐的一个这样的 mod 是[mod_qos](http://opensource.adnovum.ch/mod_qos/)。它是一个免费模块，对某些 DOS、Bruteforce 和 Slowloris 类型的攻击非常有效。这将大大减轻您的服务器负载。

**它非常强大**。

**mod_qos**模块的当前版本实现了控制机制来管理：

*   对位置/资源 (URL) 或虚拟主机的最大并发请求数。

*   带宽限制，例如每秒对 URL 的最大允许请求数或每秒下载的最大/最小千字节数。

*   限制每秒请求事件的数量（特殊请求条件）。

*   在定义的时间段内限制请求事件的数量。
*   它还可以检测非常重要的人 (VIP)，这些人可以在没有限制或限制较少的情况下访问 Web 服务器。
*   通用请求行和标题过滤器以拒绝未经授权的操作。

*   请求正文数据限制和过滤（需要 mod_parp）。

*   限制单个客户端 (IP) 的请求事件数。

*   TCP 连接级别的限制，例如，允许来自单个 IP 源地址的最大连接数或动态保持活动控制。

*   当服务器用完可用的 TCP 连接时，首选已知 IP 地址。

这是您可以使用它的示例配置。有数百种可能的配置可以满足您的需求。有关控件的更多信息，请访问该网站。

```
Sample configuration:
# minimum request rate (bytes/sec at request reading):
QS_SrvRequestRate                                 120

# limits the connections for this virtual host:
QS_SrvMaxConn                                     800

# allows keep-alive support till the server reaches 600 connections:
QS_SrvMaxConnClose                                600

# allows max 50 connections from a single ip address:
QS_SrvMaxConnPerIP                                 50

# disables connection restrictions for certain clients:
QS_SrvMaxConnExcludeIP                    172.18.3.32
QS_SrvMaxConnExcludeIP                    192.168.10. 
```

[http://opensource.adnovum.ch/mod_qos/](http://opensource.adnovum.ch/mod_qos/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-07-16T16:51:51.883

在 Apache 2.4 中，有一个名为[**mod_ratelimit**](http://httpd.apache.org/docs/2.4/mod/mod_ratelimit.html)的新库存模块。为了模拟调制解调器速度，您可以使用[**mod_dialup**](http://httpd.apache.org/docs/2.4/mod/mod_dialup.html)。尽管我不明白为什么您不能对所有内容都使用 mod_ratelimit。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-12-20T15:51:54.550

可悲的是，`mod_evasive`在非 prefork 配置中使用时无法按预期工作（最近的 apache 设置主要是 MPM）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-08-08T11:24:02.303

另一种选择 - mod_qos

配置并不简单 - 但功能强大。

[http://opensource.adnovum.ch/mod_qos/](http://opensource.adnovum.ch/mod_qos/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-09-25T13:11:46.253

取决于你为什么要限制速率。

[如果是为了防止服务器过载，实际上将 NGINX 放在它前面并在那里配置速率限制](https://www.nginx.com/blog/rate-limiting-nginx/)是有意义的。这是有道理的，因为 NGINX 使用的资源要少得多，比如每万个连接只有几 MB。因此，如果服务器被淹没，NGINX 将进行速率限制（使用少量资源）并且只将允许的流量传递给 Apache。

如果您所追求的只是简单，那么请使用 mod_evasive 之类的东西。

像往常一样，如果要防止 DDoS 或 DoS 攻击，请使用 Cloudflare 之类的服务，该服务也具有速率限制。

# c# - 如何以编程方式操作 Windows 桌面图标位置？

> ID：131690
> 
> 赞同：31
> 
> 时间：2008-09-25T06:11:11.993
> 
> 标签：c#, windows, winapi, icons, utility

几年前，我天真地尝试编写一个小应用程序来保存我在战术上放置的桌面图标，因为当某些事件重置它们时，我厌倦了将它们拖回原来的位置。在花费了太多时间未能找到查询方式（更不用说保存和重置图标的桌面位置）之后，我放弃了。

任何人都知道 Windows 将这些信息保存在哪里以及是否有 API 来设置它们？

谢谢，理查德

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-25T06:56:01.513

如果我没记错桌面只是一个 ListView，你必须将[LVM_SETITEMPOSITION](http://msdn.microsoft.com/en-us/library/bb761192(VS.85).aspx)消息发送到桌面的句柄。

我用谷歌搜索了一些 c# 代码，但找不到示例，但我确实找到了以下文章。[Torry: ...获取/设置桌面图标的位置？](http://www.swissdelphicenter.ch/torry/showcode.php?id=1897). 它是 delphi 代码，但我发现它非常易读，并且通过一些 P/Invokes，您将能够将其翻译成 c#。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T11:43:53.287

桌面只是一个 ListView 控件，您可以使用 LVM_SETITEMPOSITION 获取它的句柄并向其发送消息以移动图标。

不过，使用 LVMGETITEMPOS 获取图标位置有点复杂。您必须将指向 POINT 结构的指针作为 LPARAM 传递。如果您尝试这样做，您可能会导致 Explorer 崩溃。问题是您在地址空间中向它传递了一个指针，控件将其解释为资源管理器地址空间中的指针。哎哟!

我使用的解决方案是将 DLL 注入 Explorer 进程并从那里发送消息。然后，您只需要有一种方法可以将职位信息返回到您的流程中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T16:37:08.163

我仍在研究这个问题，一旦我最终得到一些工作，我就会发布结果。我发布这个是因为间接感谢 Davy 的帖子，我还发现了一个经典的 VB 实现：

[使用进程间内存通信随机播放桌面图标](http://www.freevbcode.com/ShowCode.asp?ID=3290)

这可能是我的代码的基础。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T06:16:08.893

我不知道 API，但我知道 Ultramon ( [http://www.realtimesoft.com/ultramon/](http://www.realtimesoft.com/ultramon/) ) 具有保留图标位置的功能（虽然我从未使用它来保留图标位置，但它是必不可少的用于多显示器使用）。最新的 beta 版本在 Vista 上完美运行（除了最初通过 RDP 登录我的机器时有时会出现一两个小故障），当然，在 XP 上没有任何问题。我已经用了四年多了。

我有没有提到它是多显示器使用的最佳实用程序？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-14T18:31:32.083

也许你想要这个？我在《WindowsCoreProgramming 5th》[https://github.com/wang1902568721/WindowsCoreProgramming](https://github.com/wang1902568721/WindowsCoreProgramming)

# java - 是否有可能使 Eclipse p2 配置机制在*本地*运行？

> ID：131704
> 
> 赞同：27
> 
> 时间：2008-09-25T06:21:04.997
> 
> 标签：java, eclipse, provisioning, p2

Eclipse 3.4[.x] - 也称为[Ganymede](http://www.eclipse.org/downloads/packages/) - 带有这种称为**p2**的新供应机制。

“供应”是允许按需发现和更新应用程序某些部分的过程，正如[Sun 网站](http://developers.sun.com/mobility/midp/articles/ota)上的这篇文章中一般解释的那样。

Eclipse 有一个扩展的 [wiki 部分](http://wiki.eclipse.org/Category:Equinox_p2)，其中显示了 p2 的详细信息。具体来说，它在这个 wiki 页面中说 p2 将寻找新组件但是在阅读之后。

我想（但您可以根据自己的经验确认这一点），p2 可以运行文件“file://”协议，这将允许它使用**本地**文件（在您的计算机上或在 UNC 路径 '\server \path')，如此[处所示](http://wiki.eclipse.org/Equinox_p2_PDE_Integration)，但也由文件：

*   [eclipse-SDK-3.4-win32]\eclipse\configuration\.settings\org.eclipse.equinox.p2.artifact.repository.prefs
*   [eclipse-SDK-3.4-win32]\eclipse\configuration\.settings\org.eclipse.equinox.p2.metadata.repository.prefs

p2 机制用于通过[eclipse 3.4 更新站点](http://download.eclipse.org/eclipse/updates/3.4)更新 eclipse 本身，并在这些“.prefs”文件中引用如下行：

> 存储库/文件：_C:_jv_eclipse_eclipse-SDK-3.4-win32_eclipse/url=file:/C:/jv/eclipse/eclipse-SDK-3.4-win32/eclipse/

现在，我如何将该更新站点中存在的 Eclipse 组件复制到本地目录中，并通过上述“.prefs”文件引用这些组件，**以便升级过程完全在本地运行**，而无需访问网络？
我想远程“更新站点”中存在的一些 p2 元数据文件也需要复制和更改。

你对此有什么想法/建议/提示吗？（即关于如何发现、检索和更新完整的 Eclipse 安装所需的完整结构，以便在本地运行该安装）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-02T21:49:08.690

是的，如果您使用 p2.director，您可以指定存储库位置

例如，这是我用来从 Ganymede 存储库的本地副本安装 eclipse (Ganymede) 的脚本片段

```
./eclipse\
      -nosplash -consolelog -debug\
      -vm "${VM}"\
      -application org.eclipse.equinox.p2.director.app.application\
      -metadataRepository file:${SHARED_REPOSITORY_DIR}\
      -artifactRepository file:${SHARED_REPOSITORY_DIR}\
      -installIU "${4-org.eclipse.sdk.ide}"\
      -destination "${3}"\
      -profile "${1}"\
      -profileProperties org.eclipse.update.install.features=true\
      -bundlepool ${SHARED_BUNDLEPOOL_DIR}\
      -p2.os linux\
      -p2.ws gtk\
      -p2.arch "${2}"\
      \
      -vmargs\
        -Xms64m -Xmx1024m -XX:MaxPermSize=256m\
        -Declipse.p2.data.area=${SHARED_P2_DIR} 
```

这里有一些使用 p2 导向器的链接

[http://eclipse.dzone.com/articles/understanding-eclipse-p2-provi](http://eclipse.dzone.com/articles/understanding-eclipse-p2-provi)
[http://wiki.eclipse.org/Equinox_p2_director_application](http://wiki.eclipse.org/Equinox_p2_director_application)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T10:13:33.033

似乎您需要通过网络进行一项更新工作，该工作将反映（下载）您需要的内容。但在那之后它应该能够从本地对等点获取文件。但我想这是你的问题 - 它是否需要网络访问来确定......

# http-headers - ASP.NET 1.1 中的 HttpHeaders

> ID：131715
> 
> 赞同：0
> 
> 时间：2008-09-25T06:27:37.930
> 
> 标签：http-headers, asp.net-1.1

如何阅读页面中发送的响应标头？我希望能够读取标题值并修改其中一些。这是针对 ASP.NET 1.1 应用程序的，但我很想知道它是否可以在任何版本的 ASP.NET 中完成。这样做的原因是有人可能在我检查响应之前添加了他们自己的自定义标题 - 所以我不能盲目清除所有标题并附加我自己的 - 我需要阅读所有标题以便我可以修改只有合适的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T02:36:38.553

HttpContext.Current.Response（它是一个 HTTPResponse），暴露了 ClearHeaders()、AddHeaders() 和 AppendHeaders()。

不像现在在更高版本的 ASP.NET 中那样直接，但应该足以让您修改要修改的标头。

[http://msdn.microsoft.com/en-us/library/system.web.httpresponse_members(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.web.httpresponse_members(VS.71).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T06:28:50.983

AFAIK 它不能在 ASP.NET 1.1 中完成。您无法获取响应标头 - 请求标头可用，但响应标头不可用。我不确定您是否可以在 Java、LAMP 等其他堆栈中执行此操作，但我很想知道...

# winapi - 获取 Windows 上任何用户的 CSIDL_LOCAL_APPDATA 路径

> ID：131716
> 
> 赞同：4
> 
> 时间：2008-09-25T06:28:11.033
> 
> 标签：winapi, visual-c++, mfc, shell32

是否有任何 Win32/MFC API 来获取我想要`CSIDL_LOCAL_APPDATA`的**任何**用户（不仅是当前登录的用户）？假设我有一个“域\用户”形式的用户列表，我想获得他们的路径列表 - 这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T06:35:08.927

您可以获取用户的 SID，然后在 HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList 下查找它并获取 ProfileImagePath 值。

获得此路径后，您可以为您的用户获取 CLSID_LOCAL_APPDATA，将绝对路径转换为您的配置文件的相对路径，然后将该相对路径附加到其他用户配置文件路径。

但是，请记住，这依赖于未记录的注册表项，并且可能会在未来版本的操作系统中中断。（或者，正如 Raymond Chan 所说：“既然你知道该怎么做，让我告诉你为什么不应该这样做……”:-)）

如果您有代表用户的令牌，则可以使用 SHGetFolderPath 或 SHGetKnownFolderPath（在 Vista 及更高版本上）。但是，存在某些安全限制，您应该在 MSDN 上阅读以了解详细信息。

SHGetFolderPath - [http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx) SHGetKnownFolderPath - [http://msdn.microsoft.com/en-us/library/bb762188(VS.85) .aspx](http://msdn.microsoft.com/en-us/library/bb762188(VS.85).aspx)

# php - PHP 中常用的 CRUD 函数

> ID：131718
> 
> 赞同：6
> 
> 时间：2008-09-25T06:28:23.590
> 
> 标签：php, crud

有没有一种简单的方法可以在不使用任何框架的情况下为每个`CRUD (create, retreive, update, delete)`操作编写一个通用函数。`PHP`例如，我希望有一个创建函数，它将表名和字段名作为参数并将数据插入到`mySQL database`. 另一个要求是该函数应该能够支持连接，即如果需要，它应该能够将数据插入到多个表中。

我知道这些任务可以通过使用框架来完成，但由于各种原因 - 在这里解释太长 - 我无法使用它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T07:49:57.247

如果你尝试编写这样的函数，你很快就会发现你刚刚实现了另一个框架。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T06:44:25.877

当然不是，这就是为什么存在这些框架并实现 crud 设施的原因。我首先会尝试说服任何需要实际使用现有框架的人，其次，如果上述情况失败，我会查看其中的一两个并复制实现想法。失败了你可以看看[http://www.phpobjectgenerator.com/](http://www.phpobjectgenerator.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T06:31:30.883

没有任何框架包括没有任何 ORM？否则我建议看看[Doctrine](http://www.doctrine-project.org/)或[Propel](http://propel.phpdb.org/trac/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-25T09:47:10.867

我知道你的感受。

Pork.DbObject 是一个简单的类，您可以从中扩展您的对象。它只需要一个数据库连接类即可工作。

请查看： [www.schizofreend.nl/pork.dbobject/](http://www.schizofreend.nl/pork.dbobject/)

（哦，是的，yuk @ php 对象生成器。*膨胀警报！*谁想在每个类中都有这些自定义函数？？？）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-27T19:57:13.223

不久前，我在 SO 上遇到了这个问题，但当时我最终没有找到任何以轻量级方式做到这一点的东西。

我最终编写了自己的代码，最近我开始开源它（MIT 许可证），以防其他人发现它有用。它在 Github 上，如果它适合您的需要，请随时查看并使用它！

[https://github.com/ArthurD/php-crud-model-class](https://github.com/ArthurD/php-crud-model-class)

希望它能找到一些用处——也希望看到一些改进/贡献，所以请随时提交拉取请求！:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T13:54:00.603

我写了这个东西，它是一种抛光的脚手架。它基本上是一个类，它的构造函数接受要使用的表、一个包含字段名称和类型的数组以及一个操作。基于此操作，对象调用自身的方法。例如：

这是我传递的数组：

```
$data = array(array('name' => 'id', 'type' => 'hidden')
          , array('name' => 'student', 'type' => 'text', 'title' => 'Student')); 
```

然后我调用构造函数：

```
new MyScaffold($table, 'edit', $data, $_GET['id']); 
```

在上述情况下，构造函数调用“编辑”方法，该方法提供了一个显示 $table 数据的表单，但只有我在数组中设置的字段。它使用的记录由 $_GET 方法确定。在此示例中，“学生”字段显示为文本框（因此为“文本”类型）。“标题”只是使用的标签。由于“隐藏”，ID 字段不会显示以供编辑，但可供程序使用。

如果我通过了“删除”而不是“编辑”，它将从 GET 变量中删除记录。如果我只传递一个表名，它将默认为带有编辑、删除和新建按钮的记录列表。

它只是一个包含所有具有大量可定制性的 CRUD 的类。您可以根据需要使其复杂或简单。通过使其成为一个通用类，我可以将其放入任何项目中，并且只需传递指令、表信息和配置信息。对于一个表，我可能不想允许通过脚手架添加新记录，在这种情况下，我可能在参数数组中将“newbutton”设置为 false。

它不是传统意义上的框架。只是一个在内部处理所有事情的独立类。这有一些缺点。关键必须是我所有的表都必须有一个名为“id”的主键，没有这个你可以逃脱，但这会使事情复杂化。另一个是必须准备有关要管理的每个表的大型数组详细信息，但您只需要这样做一次。

有关此想法的教程，请参见[此处](http://www.shadow-fox.net/site/tutorial/39-Creating-A-Scaffold-like-Class-in-PHP-or-An-Automatic-CMS-For-a-Table)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T14:01:52.363

我认为你应该编写自己的函数来实现 CRUD，除非你时间紧迫。它可能是一个独立的框架，但您需要在尖叫框架之前了解框架的功能......了解这些事情也很方便，因为您可以轻松地找到框架上的错误并自己修复它们...... ……

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T07:02:35.770

这是可能的，但我不推荐它。

如果绝对没有办法使用框架，您可以创建一个所有其他模型对象扩展的基类。然后，您可以使基类基于`get_class()`and生成和执行 SQL `get_class_vars()`。

是否可以？是的。
我会推荐它吗？不

# asp.net-mvc - 如何使用 ASP.NET MVC 对网页授权进行单元测试？

> ID：131723
> 
> 赞同：6
> 
> 时间：2008-09-25T06:29:49.890
> 
> 标签：asp.net-mvc, tdd

假设您有一个只能由该个人资料的所有者访问的个人资料页面。此个人资料页面位于：

用户/个人资料/{userID}

现在，我想为了防止其他用户访问此页面，您可以构建 UserController 类的 Profile 函数来检查当前会话的身份：

HttpContext.Current.User.Identity.Name

如果 id 与 url 中的匹配，则继续。否则，您将重定向到某种错误页面。

我的问题是你如何对这样的东西进行单元测试？我猜你需要使用某种依赖注入而不是控制器中的 HttpContext 来进行检查，但我不清楚最好的方法是什么。任何意见将是有益的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T10:51:06.703

您可能可以通过使用假控制器上下文来做到这一点。查看这篇文章：[http ://stephenwalther.com/blog/archive/2008/07/01/asp-net-mvc-tip-12-faking-the-controller-context.aspx](http://stephenwalther.com/blog/archive/2008/07/01/asp-net-mvc-tip-12-faking-the-controller-context.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T14:43:10.113

上面的链接是一个很好的链接。我还要补充一点，您应该使用文章中概述的 Authorize 属性，而不是以编程方式检查 User.Identity.Name 值：

[http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-01T00:56:11.743

我最终选择了 Kazi Manzur 的[博客文章](http://weblogs.asp.net/rashid/archive/2009/04/01/asp-net-mvc-best-practices-part-1.aspx)中显示的“UserNameFilter” 。像魅力一样工作，易于单元测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-01T01:05:07.097

这就是使用假 HttpContext 进行模拟的地方。

# asp.net - 如何更改 Telerik RAD 控件 RADEditor/WYSIWYG 控件中文档管理器的最大上传文件大小？

> ID：131728
> 
> 赞同：0
> 
> 时间：2008-09-25T06:31:36.563
> 
> 标签：asp.net, telerik, dynamic-data, wysiwyg, rad-controls

我正在使用 Telerik RAD Controls RADEditor/WYSIWYG 控件作为动态数据解决方案的一部分。

我希望能够使用此控件的文档管理器上传文件。

但是，这些文件大于最大上传文件大小的默认设置。

谁能指出我正确的方向来解决这个问题？

* * *

感谢 Yaakov Ellis，请查看您的答案 + 我通过评论链接的答案以获得解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T06:50:29.823

[该线程](http://www.telerik.com/community/forums/thread/b311D-ekgdc.aspx)与[Yaakov Ellis 的回答](https://stackoverflow.com/questions/131728/how-do-i-change-the-maximum-upload-file-size-for-the-document-manager-in-a-tele#131737)相结合可能对其他人有所帮助。

但是，我发现了我的问题，将以下代码放在用户控件 FieldTemplate (Dynamic Data) 的代码隐藏中，并结合[Yaakov Ellis 的回答](https://stackoverflow.com/questions/131728/how-do-i-change-the-maximum-upload-file-size-for-the-document-manager-in-a-tele#131737)解决了问题。

```
RadEditor1.DocumentManager.MaxUploadFileSize = 4194304; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T06:36:15.087

Telerik 网站在[此处](http://www.telerik.com/help/aspnet-ajax/upload_uploadinglargefiles.html)有说明。

短版：在 Web.config 中设置 maxRequestLength

```
<system.web>
  <httpRuntime maxRequestLength="102400" executionTimeout= "3600" />
</system.web> 
```

# .net - 有没有办法在 Windows 应用程序中嵌入 Web 控件，该应用程序使用除 Trident (IE) 之外的任何东西呈现？

> ID：131744
> 
> 赞同：0
> 
> 时间：2008-09-25T06:42:34.570
> 
> 标签：.net, web-applications

我听说过一些桌面应用程序现在几乎只是网站的包装器。

在过去，我什至遇到过以这种方式得到最好解决的偶发问题，我可以看到它对当前的应用程序开发非常有用。

但是，我似乎经常遇到的一个问题是 Visual Studio 中的网站显示控件使用[Trident (Internet Explorer)](http://en.wikipedia.org/wiki/Trident_(layout_engine))渲染引擎。这往往是 IE6 渲染，但我不确定更新的机器是否反过来使用 IE7 渲染。

有没有简单的方法可以使用[Gecko (Firefox)](http://en.wikipedia.org/wiki/Gecko_(layout_engine))甚至[Webkit (Safari/Chrome)](http://en.wikipedia.org/wiki/WebKit)进行渲染？

最终，我希望能够轻松插入此依赖项，进而拥有一个（大部分）兼容的框架来开发，并反过来为所有用户提供一致的渲染。

请提及是否有任何许可问题。

也可以随意嘲笑我，因为我知道我在问什么似乎要求“只需插入”互联网浏览器:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T10:09:05.120

我对 Trident 和 Gecko 都有个人经验。TomTom HOME 1.x 托​​管 Trident，作为 ActiveX 控件。已经有一些项目将 COM 接口适配到 Gecko，但它们似乎有些牵强。我们已经尝试嵌入 Gecko，这并不难。最后，我们改变了我们的方法。TomTom HOME 2.x 是一个 XulRunner 应用程序。一个问题是，除了你的 UI 之外，不要试图用 Javascript 编写任何东西。使用 XulRunner，您也可以使用 XPCOM 在 C++ 中完成 JS 可以做的大部分事情。

MPL 下的许可没什么大不了的。您的私有代码只是一个不受 MPL 约束的“插件”。

# collections - 通过 WebDAV 创建集合时，集合的名称应以斜杠结尾

> ID：131754
> 
> 赞同：0
> 
> 时间：2008-09-25T06:46:39.240
> 
> 标签：collections, webdav

我正在使用的 WebDAV 库正在发出此请求

```
MKCOL /集合 HTTP/1.1

```

由于 /collection 存在，Apache 向哪个 Apache 发出 301

```
HTTP/1.1 301
地点：/收藏/

```

而不是一个

```
HTTP/1.1 405 方法不允许

```

规范对此有点含糊（或者可能是我对它的阅读），但是在发布 MKCOL 时，您的集合名称是否应该始终以斜杠结尾（因为它是一个集合）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T07:18:38.913

如您所知，HTTP 代码 301 表示“永久移动”。

Apache 正在优雅地将您重定向到正确的 URL。它无法为您提供 405，因为您提供的 URL 不存在资源。但它也无法创建具有该确切 URL 的资源。它可以做的是使用正确的 URL 创建资源，然后重定向您。

但是要回答您的问题，您应该以“/”结束集合以消除歧义，否则产生的 URI 规范化行为取决于我相信的服务器。我不相信任何 RFC 都强制添加尾部斜杠。

编辑：

MKCOL 可能会在没有尾部斜杠的情况下成功，但请注意报告创建的资源有一个尾部斜杠。

根据 RFC，服务器有一个选项。因为它决定了 URL 规范化过程，只要它不违反规范。

然后，服务器可以尝试规范化您在每次操作中发送的任何 URL，返回大量 3xx 代码。这变得昂贵。或者它可以在开始时纠正您（POST、MKCOL 等），然后失败或重定向。

但关键是它总是会让你知道它喜欢的 URL。

[RFC 2616](http://ietfreport.isoc.org/idref/rfc2616/)中有关 HTTP URL 方案的内容

> 3.2.3 URI比较
> 
> 在比较两个 URI 以确定它们是否匹配时，客户端
> 应该使用区分大小写的字节对整个 URI 进行逐个字节的比较，但以下情况除外：
> 
> ```
>  - A port that is empty or not given is equivalent to the default
>     port for that URI-reference;
> 
>     - Comparisons of host names MUST be case-insensitive;
> 
>     - Comparisons of scheme names MUST be case-insensitive;
> 
>     - An empty abs_path is equivalent to an abs_path of "/". 
> ```
> 
> “保留”和“不安全”集合（参见 RFC 2396 [42]）中的字符以外的字符
> 等同于它们的“%”十六进制十六进制编码。
> 
> 例如，以下三个 URI 是等价的：
> 
> ```
>  http://abc.com:80/~smith/home.html
>   http://ABC.com/%7Esmith/home.html
>   http://ABC.com:/%7esmith/home.html 
> ```

请注意没有提及 abs_path 是如何定义的。根据规范，服务器也不能严格地说忽略你的斜线。因此，发出“MKCOL /collection”并在没有新的“/collection/” URL 的情况下创建常规 2xx 是不正确的。

AFAIK，定义 abs_path 的相关 RFC 未指定尾部斜杠。因此，取决于服务器如何比较和规范这些内容。

# database-design - 在关系数据库中客户端可创建和可修改的 Web 表单的最佳实现是什么？

> ID：131759
> 
> 赞同：7
> 
> 时间：2008-09-25T06:47:37.537
> 
> 标签：database-design, forms, webforms, entity-attribute-value

在我参与的几个 Web 应用程序项目中，客户要求能够创建自己的表单。问题出现在如何存储他们的表单定义，然后如何将用户输入的值存储到这些自定义表单中。

我已经看到它做了两种方式：

1.  假设客户端只定义了多少个字段，以及与这些字段相关联的标签；我们可以得出一个涉及四个表的解决方案。 **`FormDefinition`**, **`FormFieldDefinition`**, **`FormInstances`**, **`FormFieldValues`**. `FormDefinition`客户端对and进行更改`FormFieldDefinition`，Web 应用程序使用该信息呈现 HTML Web 表单，网站访问者（最终用户）将在该表单上提交表单，其中`FormInstances`创建新行并将值保存在`FormFieldValues`桌子。

    > 行中的**`FormDefinition`**定义形式，即`form definition ID = 2, form title = 'Car Registration Form'`。中的行**`FormFieldDefinition`**定义表单中的字段`FormDefinition`，即`field definition ID = 7, field label = 'Car Model', field type = 'varchar(50)'`。Rows in**`FormInstance`**是用户填写的每个表单的一个实例，即`definition id = 2, date_entered = '2008-09-24'`. 中的行**`FormFieldValues`**是用户的条目，即`field definition = 7, value = 'Tiburon'`.

    不幸的是，这意味着其中的值列`FormFieldValues`必须是您的客户可能在 Web 表单中指定的最大可能大小的 char 类型......并且当表单定义更改时，管理旧数据变得不确定。但是用户条目是可查询的（我写了一个[快速查询](http://pastie.org/pastes/275090)，列出了给定表单 id 的用户条目，这类似于[另一个 pivot question](https://stackoverflow.com/questions/24470/sql-server-pivot-examples)）。

2.  使用四个表的替代方法是将表单定义和用户的表单条目序列化为 XML（或 YAML 或类似的东西）并将其存储为文本。好处是表格在数据库中是人类可读的。缺点是解析 XML 会产生更多的应用程序开销，并且从 SQL 的角度来看，数据库的可查询性会大大降低。

我真正的问题是，这个数据库模型叫什么？（所以我可以用谷歌搜索这个问题。）但我会选择一个答案：哪个是更好的实现，或者那里有更好的（或同样好的）实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T18:21:16.917

您所描述的内容通常被称为“实体-属性-值”，有时也被描述为“混合数据和元数据”。也就是说，属性（字段）的名称存储为字符串（数据）。

这会导致一系列复杂的问题，例如确保每个表单实例包含相同的字段集，或确保填写必填字段（相当于传统表中的 NOT NULL）。

您问如何最好地使用关系数据库来做到这一点。在关系数据库中，您应该使用元数据作为元数据。在这种情况下，这意味着为每个表单创建新表，并为表单字段使用列。因此，您的表单定义只是表元数据，一个表单实例是该表中的一行。如果您支持具有多值答案的表单（例如复选框），那么您也需要依赖表。

这可能看起来很昂贵或难以扩展。大概是真的。因此，关系数据库可能不是这项工作的最佳工具。您提到了 XML 或 YAML 的可能性；基本上是某种结构化的文件格式，您可以临时定义。您应该为每个客户的表单定义一个 DTD，以便可以验证收集的每个表单。

**编辑：**如果您真的需要在您的应用程序中使用 EAV 的灵活性，那很好，通常情况下有理由违反规则。请注意它需要的额外工作，并在您的开发计划中进行计划，并在您扩展服务器以处理负载时进行计划。另请参阅我在 StackOverflow 上[关于 EAV](https://stackoverflow.com/questions/192892/performance-of-large-eavopen-schema-systems-on-sql-server#231681)的另一个答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T07:31:42.300

> 这个数据库模型叫什么？

不知道实际上叫什么，但它与动态生成调查中使用的过程相同。如果您寻找任何用于生成调查应用程序的来源，您会发现相同的通用数据库模式以及类似的方法。

还可以查看表单构建器站点，例如[http://wufoo.com/](http://wufoo.com/)或[http://frevvo.com/](http://frevvo.com/)以获取 UI 创意（如果您要使其基于 Web）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T07:45:53.700

还有第三个选项，您可以在其中创建表并在需要时添加列。这取决于创建了多少表格，但数据库可以轻松处理大量表格。因此，如果用户想要添加表格“汽车注册表格”，则添加表格“汽车注册表格”。对于表单上他们想要的每个字段，您可以让他们在一些基本类型之间进行选择，例如日期、整数和文本。选择文本时，它们必须从选择列表中输入最大长度，如果字段应该是VARCHAR或CLOB，则会为您提供信息。

这适用于 SQL Server，您可以在其中轻松添加和删除列。对于 DB2，这可能是个问题，因为没有实现 drop 列。对于 mysql 我不确定。

您仍然需要在两个单独的表中注册您的表单和其中的字段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T20:58:20.120

你可能想要[实体关系模型](http://en.wikipedia.org/wiki/Entity-relationship_model)

There are indeed GUI tools to create schema interactively from such models.

# java - 如何使用 Perl 识别对 Java 类的引用？

> ID：131788
> 
> 赞同：3
> 
> 时间：2008-09-25T06:55:40.233
> 
> 标签：java, perl, parsing

我正在编写一个 Perl 脚本，并且已经到了需要逐行解析 Java 源文件以检查对完全限定 Java 类名的引用的地步。我预先知道我正在寻找的课程；也是正在搜索的源文件的完全限定名称（基于其路径）。

例如，在 com/bob/is/YourUncle.java 文件中查找对 foo.bar.Baz 的所有有效引用。

目前我能想到的需要考虑的情况是：

1.  被解析的文件与搜索类在同一个包中。

    在 foo/bar/Boing.java 中找到 foo.bar.Baz 引用

2.  它应该忽略评论。

    ```
    // this is a comment saying this method returns a foo.bar.Baz or Baz instance 
    // it shouldn't count

    /*   a multiline comment as well
     this shouldn't count
     if I put foo.bar.Baz or Baz in here either */ 
    ```

3.  内联完全限定参考。

    ```
    foo.bar.Baz fb = new foo.bar.Baz(); 
    ```

4.  基于导入语句的引用。

    ```
    import foo.bar.Baz;
    ...
    Baz b = new Baz(); 
    ```

在 Perl 5.8 中最有效的方法是什么？也许是一些花哨的正则表达式？

```
open F, $File::Find::name or die;
# these three things are already known
# $classToFind    looking for references of this class
# $pkgToFind      the package of the class you're finding references of
# $currentPkg     package name of the file being parsed
while(<F>){
  # ... do work here   
}
close F;
# the results are availble here in some form 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T07:15:09.173

正则表达式可能是最好的解决方案，尽管我确实在 CPAN 中找到了您可以使用的以下模块

*   [Java::JVM::Classfile](http://search.cpan.org/~lbrocard/Java-JVM-Classfile-0.20/lib/Java/JVM/Classfile.pm) - 解析编译的类文件并返回有关它们的信息。您必须先编译文件才能使用它。

另外，请记住，使用正则表达式捕获多行注释的所有可能变体可能很棘手。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-25T07:33:14.510

您还需要跳过带引号的字符串（如果您不处理带引号的字符串，您甚至无法正确跳过注释）。

我可能会编写一个相当简单、高效且不完整的标记器，与我在[节点 566467](http://perlmonks.org/?node_id=566467)中编写的非常相似。

基于该代码，我可能只是挖掘寻找`\bimport\b`和`\b\Q$toFind\E\b`匹配的非注释/非字符串块。也许类似于：

```
if( m[
        \G
        (?:
            [^'"/]+
          | /(?![/*])
        )+
    ]xgc
) {
    my $code = substr( $_, $-[0], $+[0] - $-[0] );
    my $imported = 0;
    while( $code =~ /\b(import\s+)?\Q$package\E\b/g ) {
        if( $1 ) {
            ... # Found importing of package
            while( $code =~ /\b\Q$class\E\b/g ) {
                ... # Found mention of imported class
            }
            last;
        }
        ... # Found a package reference
    }
} elsif( m[ \G ' (?: [^'\\]+ | \\. )* ' ]xgc
    ||   m[ \G " (?: [^"\\]+ | \\. )* " ]xgc
) {
    # skip quoted strings
} elsif(  m[\G//.*]g­c  ) {
    # skip C++ comments 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T07:36:18.263

这实际上只是 Baz 的直接 grep（或 /(foo.bar.| )Baz/，如果您担心来自 some.other.Baz 的误报），但忽略评论，不是吗？

如果是这样，我会拼凑一个状态引擎来跟踪您是否在多行评论中。所需的正则表达式没什么特别的。类似于（*未经测试的代码*）：

```
my $in_comment;
my %matches;
my $line_num = 0;
my $full_target = 'foo.bar.Baz';
my $short_target = (split /\./, $full_target)[-1];  # segment after last . (Baz)

while (my $line = <F>) {
    $line_num++;
    if ($in_comment) {
        next unless $line =~ m|\*/|;  # ignore line unless it ends the comment
        $line =~ s|.*\*/||;           # delete everything prior to end of comment
    } elsif ($line =~ m|/\*|) {
        if ($line =~ m|\*/|) {        # catch /* and */ on same line
            $line =~ s|/\*.*\*/||;
        } else {
            $in_comment = 1;
            $line =~ s|/\*.*||;       # clear from start of comment to end of line
        }
    }

    $line =~ s/\\\\.*//;   # remove single-line comments
    $matches{$line_num} = $line if $line =~ /$full_target| $short_target/;
}

for my $key (sort keys %matches) {
    print $key, ': ', $matches{$key}, "\n";
} 
```

它并不完美，嵌套的多行注释或同一行上有多个多行注释可能会弄乱注释的输入/输出状态，但这对于大多数实际情况来说可能已经足够了。

要在没有状态引擎的情况下执行此操作，您需要 slurp 到单个字符串中，删除 / *...* / 注释，并将其拆分回单独的行，然后 grep 那些非//-注释命中。但是您将无法以这种方式在输出中包含行号。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-26T23:39:04.797

这就是我想出的适用于我抛出的所有不同情况的方法。我仍然是 Perl 菜鸟，它可能不是世界上最快的东西，但它应该可以满足我的需要。感谢他们帮助我以不同方式看待它的所有答案。

```
 my $className = 'Baz';
  my $searchPkg = 'foo.bar';
  my @potentialRefs, my @confirmedRefs;
  my $samePkg = 0;
  my $imported = 0;
  my $currentPkg = 'com.bob';
  $currentPkg =~ s/\//\./g;
  if($currentPkg eq $searchPkg){
    $samePkg = 1;  
  }
  my $inMultiLineComment = 0;
  open F, $_ or die;
  my $lineNum = 0;
  while(<F>){
    $lineNum++;
    if($inMultiLineComment){
      if(m|^.*?\*/|){
        s|^.*?\*/||; #get rid of the closing part of the multiline comment we're in
        $inMultiLineComment = 0;
      }else{
        next;
      }
    }
    if(length($_) > 0){
      s|"([^"\\]*(\\.[^"\\]*)*)"||g; #remove strings first since java cannot have multiline string literals
      s|/\*.*?\*/||g;  #remove any multiline comments that start and end on the same line
      s|//.*$||;  #remove the // comments from what's left
      if (m|/\*.*$|){
        $inMultiLineComment = 1 ;#now if you have any occurence of /* then then at least some of the next line is in the multiline comment
        s|/\*.*$||g;
      }
    }else{
      next; #no sense continuing to process a blank string
    }

    if (/^\s*(import )?($searchPkg)?(.*)?\b$className\b/){
      if($imported || $samePkg){
        push(@confirmedRefs, $lineNum);
      }else {
        push(@potentialRefs, $lineNum);
      }
      if($1){
        $imported = 1;
      } elsif($2){
        push(@confirmedRefs, $lineNum);
      }
    }
  }
  close F;      
  if($imported){
    push(@confirmedRefs,@potentialRefs);
  }

  for (@confirmedRefs){
    print "$_\n";
  } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-29T17:31:45.607

如果你有足够的冒险精神，你可以看看[Parse::RecDescent](http://search.cpan.org/dist/Parse-RecDescent/)。

# delphi - 我不能在我继承的这个旧 Delphi 项目中包含版本号。我如何解决它？

> ID：131793
> 
> 赞同：5
> 
> 时间：2008-09-25T06:57:10.980
> 
> 标签：delphi, dof-file

我有一个旧的 Delphi 代码库，我必须维护，很多 DLL，有些比其他的旧。在其中一些 DLL 中，“项目选项”对话框中没有版本信息。添加版本的控件显示为灰色，我什至无法通过手动编辑 .DOF 文件来添加版本号。如何在这些项目中包含版本号？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-25T07:05:36.653

检查项目源位置中是否存在默认 .RES 文件。Delphi 将项目的版本号包含在与 .dpr 文件同名的 .res 文件中。如果 .RES 文件不存在，重新创建它的最简单方法是将 {$R *.RES} 编译器指令添加到 .DPR 文件，紧跟在 uses 子句之后。

```
library foolib;    

uses
    foo in 'foo.pas',
    baz in 'baz.pas';

{$R *.RES}

exports
    foofunc name 'foofunc';

end; 
```

一旦你添加了 {$R *.RES} 编译器指令，Delphi 就会告诉你它已经重新创建了傻瓜.res 资源文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T08:58:15.993

您的 .dpr 文件中似乎`{$R *.RES}`缺少资源指令（或包含在条件定义中），因此 IDE 找不到它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T07:08:37.410

您可以使用 $R 指令在 Delphi 下创建的库中创建和嵌入资源文件。

此[链接](http://msdn.microsoft.com/en-us/library/aa381058(VS.85).aspx)包含与构建 RES 文件相关的信息。Delphi有自己的资源编译器：BRCC32

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T08:08:28.420

我使用构建控制系统 (FinalBuilder)，它能够将版本资源添加到我所有的 DLL 和 EXE 中，它们都是一致的。因此，我可以确信文件集都标有相同的版本。有一些Delphi项目默认是没有版本的，无论如何FB都会为你添加。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-23T00:18:25.937

在 dll 中包含版本信息有点不稳定。如果您指定 lib_suffix，则不会更新版本信息。

# embedded - 适合初学者的简单串行 AVR 编程器

> ID：131801
> 
> 赞同：4
> 
> 时间：2008-09-25T06:59:21.957
> 
> 标签：embedded, avr, circuit

为 AVR atMega 和 atTiny 制作串行（RS232）编程器的便宜又好方法是什么？网上有好几种电路，但哪一种更好呢？

我希望能够使用一些标准工具从 Linux 和 Windows 对我的控制器进行编程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T07:36:23.723

试试 Adafruit Industries 的[串行端口 AVR 编程器 (DASA) 套件](http://www.adafruit.com/index.php?main_page=product_info&cPath=16&products_id=26)。它仅售 7.50 美元，在[Arduino](http://www.arduino.cc/en/Guide/Introduction)社区中非常受欢迎，她在她的个人网站上提供了组装的分步[说明。](http://www.ladyada.net/make/spokepov/makeserialdongle.html)

如果您不想自己构建它，[Sparkfun Electronics](http://www.sparkfun.com/commerce/categories.php?c=1)有几个串行编程器可供您花更多的钱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T07:12:00.427

我以前使用（免费！）[Pony Programmer](http://www.lancos.com/prog.html)软件和加密狗取得了很好的成功。他们提供了硬件原理图，这很简单，而且似乎可以解决问题。

有一段时间没有使用该软件的 linux 版本，但 windows 版本似乎可以完成所需的一切。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T06:24:45.497

如果可以用usb，我真的不认为原来的程序员（[AVR ISP mkII](http://www.atmel.com/dyn/products/tools_card.asp?tool_id=3808)）那么贵，今天的定价大约是34美元。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-26T06:32:55.023

**[http://onlinetps.com/shop/index.php?main_page=product_info&cPath=65&products_id=188](http://onlinetps.com/shop/index.php?main_page=product_info&cPath=65&products_id=188)** 这个串口AVR 编程器是一个兼容PonyProg 和其他编程软件的串口加密狗。它不需要任何外部电源；它从你的目标板上获取能量。加密狗通过标准 DB9 串行端口连接到您的 PC 信息：

这款 Serial Port AVR Programmer 编程器是市场上最便宜的 AVR 编程器。它与伟大的免费 AVR 编程软件 - Pony -Prog 配合使用，您可以随时查看此链接上支持的设备列表，因为它每个月都在增长。

支持的设备

ATMEGA103，ATMEGA161，ATMEGA163，ATMEGA 323，ATMEGA128，ATMEGA8，ATMEGA16，ATMEGA8L，ATMEGA16L，ATMEGA64，ATMEGA32，ATMEGA64L，ATMEGA32L，ATMEGA162，ATMEGA169，ATMEGA165，ATMEGA169，ATMEGA8515，ATMEGA8535，ATMEGA12，ATTINY15，ATTINY26，ATTINY2313，ATTINY13,25,45,85 , 261, 461 还有更多............

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-27T20:35:41.907

您可以使用 bitbang 编程。您所需要的只是 ftdi ft232 芯片和 avr-dude 软件。

[http://easyelectronics.ru/img/readydev/FTDIBBProg/ftbb.JPG](http://easyelectronics.ru/img/readydev/FTDIBBProg/ftbb.JPG)

[http://www.nongnu.org/avrdude/](http://www.nongnu.org/avrdude/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-07T06:16:57.557

[Bus Pirate](http://dangerousprototypes.com/docs/Bus_Pirate)是另一种 USB 选项。它实际上是许多（与串行总线相关的）用途的方便工具。不过，它可能不像专门的程序员那样流畅或快速。

# c++ - unsigned int 与 size_t

> ID：131803
> 
> 赞同：537
> 
> 时间：2008-09-25T07:00:03.843
> 
> 标签：c++, c, size-t

我注意到现代 C 和 C++ 代码似乎在几乎所有地方都使用`size_t`而不是`int`/ ——从 C 字符串函数的参数到 STL。`unsigned int`我很好奇这样做的原因及其带来的好处。

* * *

## 回答 #1

> 赞同：421
> 
> 时间：2008-09-25T07:08:12.997

该`size_t`类型是无符号整数类型，它是`sizeof`运算符（和`offsetof`运算符）的结果，因此保证它足够大以包含系统可以处理的最大对象的大小（例如，8Gb 的静态数组）。

`size_t`类型可能大于、等于或小于，并且您的`unsigned int`编译器可能会对其进行优化以进行假设。

您可以在 C99 标准第 7.17 节中找到更精确的信息，该标准的草案在 Internet 上以[pdf](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)格式提供，或者在 C11 标准第 7.19 节中以[pdf 草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)的形式提供。

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2008-09-25T07:13:02.640

经典 C（Brian Kernighan 和 Dennis Ritchie 在 The C Programming Language，Prentice-Hall，1978 年描述的 C 的早期方言）没有提供`size_t`. 引入 C 标准委员会`size_t`以消除可移植性问题

[在 embedded.com 上详细解释（有一个很好的例子）](http://www.embedded.com/electronics-blogs/programming-pointers/4026076/Why-size-t-matters)

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2010-11-28T03:41:35.613

简而言之，`size_t`它永远不会是负数，并且它可以最大限度地提高性能，因为它的 typedef'd 是无符号整数类型，它足够大 - 但不是太大 - 可以表示目标平台上最大可能对象的大小。

大小永远不应该是负数，并且确实`size_t`是无符号类型。此外，由于`size_t`是无符号的，您可以存储大约是相应有符号类型的两倍大的数字，因为我们可以使用符号位来表示幅度，就像无符号整数中的所有其他位一样。当我们获得更多位时，我们将可以表示的数字范围乘以大约两倍。

所以，你问，为什么不直接使用`unsigned int`? 它可能无法容纳足够大的数字。在`unsigned int`32 位的实现中，它可以表示的最大数字是`4294967295`. 某些处理器，例如 IP16L32，可以复制大于`4294967295`字节的对象。

所以，你问，为什么不使用`unsigned long int`? 它会在某些平台上造成性能损失。标准 C 要求 a`long`至少占用 32 位。IP16L32 平台将每个 32 位长实现为一对 16 位字。这些平台上的几乎所有 32 位运算符都需要两条指令，甚至更多，因为它们使用两个 16 位块中的 32 位。例如，移动一个 32 位的长度通常需要两条机器指令——一条用于移动每个 16 位的块。

使用`size_t`可以避免这种性能损失。根据[这篇精彩的文章](http://www.embedded.com/electronics-blogs/programming-pointers/4026076/Why-size-t-matters)，“Type`size_t`是一个 typedef，它是一些无符号整数类型的别名，通常是`unsigned int`or `unsigned long`，但也可能是`unsigned long long`。每个标准 C 实现都应该选择足够大的无符号整数——但不大于需要的整数——表示目标平台上最大可能对象的大小。”

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2008-09-25T07:31:28.103

size_t 类型是 sizeof 运算符返回的类型。它是一个无符号整数，能够以字节为单位表示主机支持的任何内存范围的大小。它（通常）与 ptrdiff_t 相关，因为 ptrdiff_t 是有符号整数值，因此 sizeof(ptrdiff_t) 和 sizeof(size_t) 相等。

在编写 C 代码时，无论何时处理内存范围，您都应该*始终使用 size_t。*

另一方面， int 类型基本上定义为主机可以用来最有效地执行整数运算的（有符号）整数值的大小。例如，在许多较旧的 PC 类型计算机上，值 sizeof(size_t) 将为 4（字节），但 sizeof(int) 将为 2（字节）。16 位算术比 32 位算术更快，尽管 CPU 可以处理高达 4 GiB 的（逻辑）内存空间。

仅当您关心效率时才使用 int 类型，因为它的实际精度很大程度上取决于编译器选项和机器架构。特别是 C 标准指定了以下不变量： sizeof(char) <= sizeof(short) <= sizeof(int) <= sizeof(long) 对程序员可用的每个精度的实际表示没有其他限制这些原始类型。

注意：这与 Java 中的不同（它实际上指定了每个类型 'char'、'byte'、'short'、'int' 和 'long' 的位精度）。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2008-09-25T07:08:27.147

类型 size_t 必须足够大以存储任何可能对象的大小。Unsigned int 不必满足该条件。

例如在 64 位系统中 int 和 unsigned int 可能是 32 位宽，但 size_t 必须足够大以存储大于 4G 的数字

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-09-24T02:44:37.023

在研究该主题时，glibc 手册 0.02 的这段摘录也可能是相关的：

2.4 版之前的 GCC 的 size_t 类型和版本存在潜在问题。ANSI C 要求 size_t 始终是无符号类型。为了与现有系统的头文件兼容，GCC 在`stddef.h' to be whatever type the system's`sys/types.h' 中定义了 size_t，将其定义为。大多数在 `sys/types.h' 中定义 size_t 的 Unix 系统将其定义为有符号类型。库中的一些代码依赖于 size_t 是一个无符号类型，如果它被签名将无法正常工作。

期望 size_t 为无符号的 GNU C 库代码是正确的。size_t 作为有符号类型的定义是不正确的。我们计划在 2.4 版本中，GCC 将始终将 size_t 定义为无符号类型，而`fixincludes' script will massage the system's`sys/types.h' 则不会与此冲突。

同时，我们通过明确告诉 GCC 在编译 GNU C 库时对 size_t 使用无符号类型来解决这个问题。`configure' 将自动检测 GCC 用于 size_t 的类型，并在必要时安排覆盖它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-19T20:55:04.440

如果我的编译器设置为 32 位，`size_t`那只不过是`unsigned int`. 如果我的编译器设置为 64 位，`size_t`那只不过是`unsigned long long`.

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-09-27T05:21:29.247

size_t 是指针的大小。

所以在 32 位或常见的 ILP32（整数、长整数、指针）模型中 size_t 是 32 位。并且在 64 位或常见的 LP64（长指针）模型中 size_t 是 64 位（整数仍然是 32 位）。

还有其他模型，但这些是 g++ 使用的模型（至少默认情况下）

# sql - 复制表的 SQL 命令

> ID：131805
> 
> 赞同：9
> 
> 时间：2008-09-25T07:00:17.540
> 
> 标签：sql, mysql

将表从一个数据库复制到另一个数据库的 SQL 命令是什么？我正在使用 MySQL，我有两个数据库 x 和 y。假设我在 x 中有一个名为 a 的表，我需要将该表复制到 y 数据库。对不起，如果这个问题太新手。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T07:05:16.777

如果目标表不存在......

```
CREATE TABLE dest_table AS (SELECT * FROM source_table); 
```

如果目标表确实存在

```
INSERT INTO dest_table (SELECT * FROM source_table); 
```

警告：仅在 Oracle 中测试

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-25T07:13:02.953

如果您的两个数据库是分开的，最简单的做法是创建表的转储并将其加载到第二个数据库中。请参阅您的数据库手册以了解如何执行转储。

否则，您可以使用以下语法（对于 MySQL）

```
INSERT INTO database_b.table (SELECT * FROM database_a.table) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T07:12:10.117

由于您的方案涉及两个不同的数据库，因此正确的查询应该是......

INSERT INTO Y..dest_table (SELECT * FROM source_table);

查询假设，您正在使用 X 数据库运行它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T07:05:13.410

如果您只想复制内容，您可能正在寻找`select into`： [http](http://www.w3schools.com/Sql/sql_select_into.asp) ://www.w3schools.com/Sql/sql_select_into.asp 。但是，这不会创建相同的副本，它只会将每一行从一个表复制到另一个表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T15:58:09.057

在命令行

```
mysqldump somedb sometable -u user -p | mysql otherdb -u user -p 
```

然后输入两个密码。

即使它们在不同的主机上也可以使用（只需像往常一样添加 -h 参数），而插入选择则无法做到这一点。

小心不要意外地将管道输入错误的数据库，否则您最终会删除该数据库中的某个表！（转储将以“drop table sometable”开头）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T16:12:37.040

别人建议的insert blah from select 有利于复制mysql下的数据。

如果要复制表结构，可能需要使用**show create table Tablename；**陈述。

# c# - 模拟不是接口的类

> ID：131806
> 
> 赞同：7
> 
> 时间：2008-09-25T07:00:23.060
> 
> 标签：c#, unit-testing, mocking

我一直在用 C# 编写一些从 providerbase 类继承的提供程序。我发现很难编写使用提供程序的测试，因为大多数模拟框架只允许你模拟一个接口。

有没有办法模拟对从提供程序库继承的提供程序的调用？

如果没有，是否有一种模式可以用来实现对提供者的模拟？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-25T07:02:39.890

模拟框架应该能够为您创建一个基于类的模拟对象，只要它有虚拟成员。

您可能还想看看[Typemock](http://www.typemock.com/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T07:27:43.650

我知道 Rhino 模拟也可以模拟类，大多数其他模拟框架也应该没有问题。
事情也要记住：类不能被密封。您需要标记要模拟虚拟的方法，并且该类需要一个没有参数的构造函数，这可以被保护，私有将不起作用。（刚试过这个）

请记住，模拟框架只会创建一个从您的类继承的类并创建该类型的对象。所以构造函数会被调用。这可能会导致您的测试出现意外行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T21:42:37.143

[RhinoMocks](http://ayende.com/projects/rhino-mocks.aspx)或[Moq](http://code.google.com/p/moq/)将为类和接口创建测试替身。该类型必须具有虚拟方法或者是抽象的。Typemock[隔离](http://www.typemock.com/)器解决了这个问题。

我建议您要模拟的对象可能应该是抽象的（[依赖倒置原则](http://en.wikipedia.org/wiki/Dependency_inversion_principle)）。

# ruby - string.unpack 如何在 Ruby 中工作？

> ID：131811
> 
> 赞同：12
> 
> 时间：2008-09-25T07:01:06.367
> 
> 标签：ruby

有人可以解释为什么如何计算以下解包的结果吗？

```
"aaa".unpack('h2H2')               #=> ["16", "61"] 
```

在二进制中，“a”= 0110 0001。我不确定“h2”如何变为 16（0001 0000）或“H2”如何变为 61（0011 1101）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-25T07:13:03.967

不是 16 - 它显示 1，然后是 6。 h 给出每个半字节的十六进制值，所以你得到 0110 (6)，然后是 0001 (1)，这取决于它是你正在查看的高位还是低位。首先使用高半字节，你会得到 61，这是 97 的十六进制 - 'a' 的值

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T07:11:29.057

查看 unpack 上的 Programming Ruby[参考](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-unpack)。这是一个片段：

> 根据格式字符串解码 str（可能包含二进制数据），返回提取的每个值的数组。格式字符串由一系列单字符指令组成，总结在第 379 页的表 22.8 中。每个指令后面可以跟一个数字，表示使用该指令重复的次数。星号 ("*") 将用完所有剩余的元素。指令 sSiIlL 每个都可以后跟一个下划线（“_”），以使用指定类型的底层平台的本机大小；否则，它使用与平台无关的一致大小。格式字符串中的空格被忽略。另请参见第 286 页的 Array#pack。

以及您示例中的相关字符：

> H 从每个字符中提取十六进制半字节（最重要的在前）。
> 
> h 从每个字符中提取十六进制半字节（首先是最不重要的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T07:12:37.510

char 的十六进制代码`a`是 61。

模板`h2`是一个十六进制字符串（低位在前），`H2`与高位在前相同。

另请参阅[perl 文档](http://perldoc.perl.org/functions/pack.html)。

# c# - 你如何计算C#中的累积时间？

> ID：131812
> 
> 赞同：1
> 
> 时间：2008-09-25T07:02:21.230
> 
> 标签：c#, datetime, time

我想计算我保存在数据库中的 2 次之间的时间跨度。所以从字面上看，我想知道这两个值之间的时间长度。

14:10:20 - 10:05:15 = 02:05:05

所以结果是 02:05:05。

我将如何使用 C# 来实现这一点？

14:10:20 是我将其保存在数据库中的格式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T07:04:22.600

将两个时间值读入 TimeSpan 变量，然后`.Subtract()`对较大的 TimeSpan 变量执行 a 以获得 TimeSpan 结果。

例如`TimeSpan difference = t1.Subtract(t2);`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T07:59:29.270

第一步是将存储在数据库中的时间值放入 .NET`DateTime`结构中。

如果将它们作为 SQL-DateTime 值存储在数据库中，则可以直接将它们作为`DateTime`. 它看起来像这样：

```
SQLCommand getTimeCommand = new SQLCommand("SELECT time FROM table", dbConnection);
SQLDataReader myReader = getTimeCommand.ExecuteReader();
while (myReader.Read())
{
    DateTime time = myReader.GetDateTime(0);
}
myReader.Close(); 
```

您的实现可能会有所不同，请参阅 MSDN 库中的 ADO.NET 文档。

如果您已经得到一个表示时间的字符串，您可以`DateTime`使用静态方法将字符串解析为

```
DateTime.Parse 
```

或者

```
DateTime.ParseExact 
```

在您的情况下，您可能需要使用`ParseExact`，它可以提供一个格式字符串来定义如何读取字符串。示例应在 MSDN 库中找到。

.NET 中的持续时间存储在`TimeSpan`结构中。获取日期时间之间的经过时间很容易：

```
DateTime time1, time2; //filled with your timevalues from the db
TimeSpan elapsed = d2 - d1; 
```

`elapsed`现在包含两者之间的时间跨度`DateTimes`。结构有几个成员可以访问`TimeSpan`. 查看 MSDN-Library 以找到您需要的那些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T07:11:35.313

DateTime 对象支持“-”运算符，因此您可以将时间读入此类对象并减去它们。要测试，请查看：

```
DateTime then = DateTime.Now;
Thread.Sleep(500);
DateTime now = DateTime.Now;
TimeSpan time = now - then;
MessageBox.Show(time.ToString()); 
```

# windows - 暂停线程是最优的吗？

> ID：131818
> 
> 赞同：8
> 
> 时间：2008-09-25T07:03:24.753
> 
> 标签：windows, multithreading, delphi, winapi

应用程序有一个辅助线程。这个线程并不意味着一直运行，但主进程可以经常调用它。

所以，我的问题是，就 CPU 性能而言，什么更优化：在不使用线程时挂起线程或保持线程处于活动状态并使用 WaitForSingleObject 函数等待来自主进程的信号？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-25T08:08:16.470

就所使用的 CPU 资源而言，两种解决方案都是相同的 - 挂起的线程和在 WaitForSingleObject 中等待未发出信号的对象的线程都根本没有 CPU 周期。

也就是说，WaitForSingleObject 几乎总是首选的解决方案，因为使用它的代码会更加“自然”——更容易阅读，也更容易正确处理。挂起/恢复线程可能很危险，因为您需要非常小心以确保您知道您正在挂起一个线程，而挂起它不会造成任何伤害（想象挂起一个当前持有互斥锁的线程）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-25T08:01:19.233

我假设 Andrei 不使用 Delphi 编写 .NET，因此 Suspend 不会转换为 System.Threading.Thread.Suspend 而是转换为[SuspendThread](http://msdn.microsoft.com/en-us/library/ms686345(VS.85).aspx) Win32 API。

我强烈建议反对它。如果您在任意时刻暂停线程，那么您不知道会发生什么（例如，您可能会在某些共享资源被阻塞的状态下暂停线程）。但是，如果您已经知道线程处于可挂起状态，那么只需使用 WaitForSingleObject（或任何其他 WaitFor 调用） - 它与挂起线程同样有效，即线程将使用零 CPU 时间，直到它被唤醒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T07:09:10.873

“暂停”是什么意思？WaitForSingleObject 将暂停线程，即它不会消耗任何 CPU，直到信号到达。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T07:11:27.730

如果它是一个工作线程，在外部为其分配了工作单元，那么它肯定应该使用信号对象，因为这将确保它不会不必要地使用 CPU。

如果它也有自己的工作要做，那就另当别论了。我不会从另一个线程挂起线程（如果有两个线程向它交付工作会发生什么？） - 我的基本规则是线程应该根据其他线程的建议来控制自己的生命周期。这将线程本身的所有控制本地化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T12:07:19.667

参见 Delphi 中关于多线程的优秀教程： [多线程教程](http://www.eonclash.com/Tutorials/Multithreading/MartinHarvey1.1/ToC.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-11T09:59:38.067

另一种选择是 Delphi 2009 中引入的 TMonitor，它具有 Wait、Pulse 和 PulseAll 等功能，可在线程无事可做时保持线程不活动，并在它们继续工作时立即通知它们。它是在 Java 中的对象锁之后松散地建模的。就像那里一样，Delphi 对象现在有一个“锁”字段，可用于线程同步。

可以在[http://delphihaven.wordpress.com/2011/05/04/using-tmonitor-1/找到提供线程队列类示例的博客](http://delphihaven.wordpress.com/2011/05/04/using-tmonitor-1/)

不幸的是，TMonitor 实现中有一个错误，似乎在 XE2 中已修复

# jsp - JSP 分页而不检索整个结果集？

> ID：131840
> 
> 赞同：3
> 
> 时间：2008-09-25T07:09:16.550
> 
> 标签：jsp, pagination

我需要显示数据库中的日志条目。当然日志数据是巨大的，所以我必须在几个页面上显示结果，并且**没有**一次获得**所有**日志数据，而是当用户浏览页面时。

我知道[DisplayTag](http://displaytag.sourceforge.net/11/)和[TableTags](http://code.google.com/p/tabletags/)，但在我看来，它们都在应用分页之前获取了所有数据。

在我开始开发我自己的 JSP 标签之前，有谁知道这个问题的第 3 方解决方案？

谢谢，
马吕斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T07:27:04.900

关于 DisplayTag：它确实支持[Value List](http://displaytag.sourceforge.net/11/tut_externalSortAndPage.html)设计模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-24T17:08:41.060

最好的解决方案是[Jmesa](http://code.google.com/p/jmesa)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T07:17:42.740

在您的 JSP 内部并不是真正解决整个问题的好地方。在典型的分层方法中，您将表示（此处为 JSP）与数据访问（您在其中进行查询）分开。

您的 displaytag/jsp 标签应该传递给数据访问层它想要的页面（例如，我需要下一个 30 并且在第 5 页），然后您的数据访问层负责分页查询。

# rotation - 给定边界矩形，如何找到椭圆长轴的旋转角度？

> ID：131847
> 
> 赞同：5
> 
> 时间：2008-09-25T07:11:12.443
> 
> 标签：rotation, ellipse, bounding

我有一个以 (0,0) 为中心的椭圆，边界矩形是 x = [-5,5]，y = [-6,6]。椭圆在 (-5,3)、(-2.5,6)、(2.5,-6) 和 (5,-3) 处与矩形相交

我对椭圆一无所知，但我唯一需要知道的是主轴旋转的角度。

似乎答案必须非常简单，但我只是没有看到它...感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T08:09:13.363

如果 (0, 0) 是中心，那么你的椭圆方程是：

F(x, y) = Ax^2 +By^2 + Cxy + D = 0

对于任何给定的椭圆，并非所有系数 A、B、C 和 D 都是唯一确定的。可以将方程乘以任何非零常数并获得相同椭圆的新方程。

你有 4 个点，给你 4 个方程，但由于这些点是两对对称点，这些方程不会是独立的。你会得到 2 个独立的方程。通过使用椭圆与软管点中的矩形相切（这就是我的理解）这一事实，您可以得到另外两个方程。

所以如果 F(x, y) = Ax^2 +By^2 + Cxy + D 你的条件是：
dF/dx = 0 in points (-2.5,6) and (2.5,-6)
dF/dy = 0 in points点 (-5,3) 和 (5,-3)

这是你得到的四个线性方程

```
F(5, -3) = 5^2 * A + (-3)^2 * B + (-15) * C + D = 0  
F(2.5, -6) = (2.5)^2 * A + (-6)^2 * B + (-15) * C + D = 0  
dF(2.5, -6)/dx = 2*(2.5) * A + (-6) * C = 0  
dF(5, -3)/dy = 2*(-3) * B + 5 * C = 0 
```

稍作清洁后：

```
 25A +  9B - 15C + D = 0 //1
6.25A + 36B - 15C + D = 0 //2
   5A       -  6C     = 0 //3
      -  6B +  5C     = 0 //4 
```

仍然不是所有 4 个方程都是独立的，这是一件好事。该集合是齐次的，如果它们是独立的，您将得到唯一但无用的解 A = 0，B = 0，C = 0，D = 0。

正如我之前所说，系数不是唯一确定的，因此您可以根据需要设置其中一个系数并摆脱一个方程。例如

```
 25A + 9B - 15C = 1 //1
   5A      -  6C = 0 //3
      - 6B +  5C = 0 //4 
```

从中你得到：A = 4/75，B = 1/27，C = 2/45（D当然是-1）

现在，要获得角度，请应用坐标变换：

```
x = ξcos(φ) - ηsin(φ)
y = ξsin(φ) + ηcos(φ) 
```

（我只是忍不住使用这些字母:)）
方程 F(x, y) = 0

```
F(x(ξ, η), y(ξ, η)) = G(ξ, η) =
  A (ξ^2cos^2(φ) + η^2sin^2(φ) - 2ξηcos(φ)sin(φ))
+ B (ξ^2sin^2(φ) + η^2cos^2(φ) + 2ξηcos(φ)sin(φ))
+ C (ξ^2cos(φ)sin(φ) - η^2cos(φ)sin(φ) + ξη(cos^2(φ) - sin^2(φ))) + D 
```

使用这两个身份：

```
2cos(φ)sin(φ) = sin(2φ)
cos^2(φ) - sin^2(φ) = cos(2φ) 
```

您将得到代表 G(ξ, η) 中乘积 ξη 的系数 C' 为：

C' = (BA)sin(2φ) + Ccos(2φ)

现在你的问题是：对于什么角度 φ 系数 C' 消失（等于零）
有不止一个角度 φ 因为有不止一个轴。在主轴 B' > A' 的情况下

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T07:16:39.700

椭圆的梯度与沿椭圆一侧的边界矩形相交的梯度相同。在您的情况下，这是从 (-2.5,6) 到 (5,-3) 的线，即椭圆的顶部。该线的垂直下降为 9，水平运行为 7.5。

所以我们最终得到了下面的直角三角形。

```
(-2.5,6)
  *-----
  |\x
  | \
  |  \
9 |   \
  |    \
  |    x\
  +------* (5,-3)
    7.5 
```

我们正在寻找的角度是 x，这在两个位置都是相同的。

我们可以这样计算：

```
 -1
tan   (9/7.5) 
```

这给了我们一个-50.19度的角度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T08:50:13.657

1.  设置椭圆的角度 = 0
2.  计算4个交点
3.  算出计算出的交点与所需交点之间的误差（即，将 4 个距离相加）。
4.  如果误差太大，请使用割线法或 Newton-Rhapson 计算椭圆的新角度并转到 2。

我使用类似的方法来解决另一个椭圆问题：

[http://successfulsoftware.net/2008/07/18/a-mathematical-digression/](http://successfulsoftware.net/2008/07/18/a-mathematical-digression/)

[http://successfulsoftware.net/2008/08/25/a-mathematical-digression-revisited/](http://successfulsoftware.net/2008/08/25/a-mathematical-digression-revisited/)

也可以看看：

[http://en.wikipedia.org/wiki/Secant_method](http://en.wikipedia.org/wiki/Secant_method)

[http://en.wikipedia.org/wiki/Newton_Rhapson](http://en.wikipedia.org/wiki/Newton_Rhapson)

# java - 在不丢失侦听器的情况下序列化和反序列化对象的最佳方法？

> ID：131866
> 
> 赞同：7
> 
> 时间：2008-09-25T07:14:00.377
> 
> 标签：java, serialization

我有一个注册了侦听器的可序列化对象。当前，侦听器列表存储在对象中为`transient`. 当对象被序列化然后反序列化时，显然不再注册监听器。

一旦对象被反序列化，自动重新注册监听器的最安全和最好的方法是什么？是否有一个很好的设计模式可以帮助到这里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T14:35:22.500

如果实现 readObject()，则可以将瞬态重建为反序列化的一部分。您应该将反序列化视为对象构造（因为它是）。

```
 private void readObject(ObjectInputStream in) 
       throws ClassNotFoundException, IOException {
     // do normal serialization first!
     in.defaultReadObject();

     // put code here that can somehow reconstruct your listeners
     // presumably you have someplace you can look them up
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T07:49:26.720

您可以使用代理对象作为事件的侦听器和广播器，并将真正的侦听器分配给它，然后将其分配为待序列化对象的侦听器。当您对其进行序列化然后对其进行反序列化时，只需将其重新分配为反序列化对象的侦听器即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T07:54:27.517

我将构建一个解耦的事件框架，这意味着事件生产者不会直接绑定到事件消费者。这可能由一个 EventManager、一个 EventProducer 和一个 EventListener 与发布/订阅语义一起工作。

1.  当系统启动（或第一次使用）时，会创建一个 EventManager。
2.  EventListener 注册自己以接收特定类型的事件。
3.  EventProducer 正在生成事件并将它们发布到 EventManager

```
    公共接口事件管理器{
        公共无效postEvent（事件事件）；
        public void addListener(Class eventType, EventListener listener);
    }

    公共接口事件监听器 {
        公共无效句柄事件（事件事件）；
    }

```

这样，当您序列化生产者时，EventManager 仍会维护订阅的侦听器列表。当对象被反序列化时，它仍然可以将事件发布到 EventManager。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-25T09:29:14.390

一般来说，我没有认识到任何有用的模式。但是几个组合就可以了:)。问题是你如何处理反序列化？如果使用标准方式，您可以引入查找机制，该机制将用于定位本地侦听器并将它们重新绑定到新反序列化的实例。如果你有自己的反序列化器，方法会更简单。只需反序列化对象并注册本地侦听器。如果可能，反序列化器可以充当代理侦听器。正如 Panagiotis 所说，引入一些解耦模型也应该会有所帮助。确切的解决方案取决于您的实际需求，但不要忘记[亲吻](http://en.wikipedia.org/wiki/KISS_principle)它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-25T13:40:58.683

使用您的发布者和订阅者都注册的注册表。正如 Korros 所发布的，它在 OSGI 领域被称为白板模式。

# asp.net - ASP.NET Web 应用程序目录结构是否有命名约定？

> ID：131868
> 
> 赞同：0
> 
> 时间：2008-09-25T07:14:35.523
> 
> 标签：asp.net, visual-studio, directory-structure

目前我正在开发一个包含大约七个部分类、几个图标、三个页面和一个 App_Themes 文件夹的站点。我很想知道，是否有比小项目更大的行业标准目录结构？

例如，我想将类保存在单独的文件夹中，图像保存在单独的文件夹中等。我当前的目录结构如下（不准确，这是来自记忆）：

*   (root) 包含代码隐藏和表单
*   /应用程序数据
*   /App_Themes
*   /斌
*   /图片
*   /Models - 我从 MVC 中窃取了名称。这听起来比“类”更合适
*   /FusionCharts - 一个 Flash 图表库

我短暂地使用过 MVC，它看起来像一个不错的目录结构，但是，我使用的是 ASP.NET Ajax。

所以，我想问题是，有没有办法让这个目录结构在你自己看来更有序？请回答您做出决定的原因:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T08:14:58.483

ASP.NET 缺少的唯一“标准”名称是[App_Code](http://www.dotnetjunkies.ddj.com/QuickStartv20/aspnet/doc/pages/code.aspx)。

使用对您和将要维护代码的人有意义的约定。我在 4 年多的 ASP.NET 开发中遇到过这方面的行业标准。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T08:44:27.787

我也遵循您提到的相同结构。我所做的唯一补充是为脚本、CSS 和资源提供了单独的文件夹。据我所知，没有这样的行业标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T08:46:01.887

我喜欢有一个 Content 文件夹，我可以在其中放置 Css、Js 和 Images 文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T08:54:46.280

我喜欢受到 Microsoft 标准的启发，因为我们使用的是 Microsoft 技术。另外**，有一点好的标准总比没有标准好**，特别是如果你在一个更大的团队中工作。

App_Code 当然是标准的，因为它在 ASP.NET 中具有功能，而不仅仅是最佳实践。

我有点喜欢 MVC 标准项目的结构：

*   内容 --*包含带有图像、Css、Javascript 的子目录*
*   控制器*——WebForms 中可能不适用*
*   视图——*也可能在 WebForms 中矫枉过正*

“内容”文件夹可能是关键，因为它是 ASP.NET 项目的最低公分母。因此，如果您同时使用 WebForms 和 MVC，如果您知道在该文件夹中有静态资源，那么您在所有项目中都会有宾至如归的感觉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-24T17:54:15.897

许多 ASP.Net Web 窗体项目也将有一个用于 ASCX 控件的 Controls 文件夹。

对于 css 样式，我们通常使用样式文件夹，图像内容的图像（很明显），js。

您可能有一个架构文件夹、用于 ASHX 处理程序和其他类型的应用程序代码的 App_Code 以及一个 MasterPages 文件夹。

您可能会在 Web 窗体项目中看到一些自动创建的文件夹是 Properties、App_Data、bin、obj、Packages 和 TestResults。

# c# - 实现 C# yield 语句的算法

> ID：131871
> 
> 赞同：32
> 
> 时间：2008-09-25T07:15:28.033
> 
> 标签：c#, algorithm, compiler-construction, iterator, state-machine

我很想自己弄清楚，但我想知道**将带有 yield 语句的函数转换为枚举器的状态机的算法是什么？**例如，C# 是如何做到这一点的：

```
IEnumerator<string> strings(IEnumerable<string> args)
 { IEnumerator<string> enumerator2 = getAnotherEnumerator();     
   foreach(var arg in arg) 
    { enumerator2.MoveNext();
      yield return arg+enumerator.Current;
    } 
 } 
```

进入这个：

```
bool MoveNext()
 { switch (this.state)
    {
        case 0:
            this.state = -1;
            this.enumerator2 = getAnotherEnumerator();
            this.argsEnumerator = this.args.GetEnumerator();
            this.state = 1;
            while (this.argsEnumerator.MoveNext())
            {
                this.arg = this.argsEnumerator.Current;
                this.enumerator2.MoveNext();
                this.current = this.arg + this.enumerator2.Current;
                this.state = 2;
                return true;

              state1:
                this.state = 1;
            }
            this.state = -1;
            if (this.argsEnumerator != null) this.argsEnumerator.Dispose();
            break;

        case 2:
            goto state1;
    }
    return false;
} 
```

当然，根据原始代码，结果可能会完全不同。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-09-25T08:17:04.767

您正在查看的特定代码示例涉及一系列转换。请注意，这是对算法的近似描述。编译器使用的实际名称和它生成的确切代码可能不同。然而，这个想法是一样的。

第一个转换是“foreach”转换，它转换了这段代码：

```
foreach (var x in y)
{
   //body
} 
```

进入这段代码：

```
var enumerator = y.GetEnumerator();
while (enumerator.MoveNext())
{
    var x = enumerator.Current;
    //body
}

if (y != null)
{
    enumerator.Dispose();
} 
```

第二个转换在函数体中找到所有的 yield return 语句，为每个语句分配一个数字（一个状态值），并在 yield 之后创建一个“goto 标签”。

第三个转换将方法体中的所有局部变量和函数参数提升到一个称为闭包的对象中。

鉴于您的示例中的代码，这看起来类似于：

```
 class ClosureEnumerable : IEnumerable<string>
 {
    private IEnumerable<string> args;
    private ClassType originalThis;
    public ClosureEnumerator(ClassType origThis, IEnumerable<string> args)
    {
        this.args = args;
        this.origianlThis = origThis;
    }
    public IEnumerator<string> GetEnumerator()
    {
        return new Closure(origThis, args);
    }
 }

class Closure : IEnumerator<string>
{
    public Closure(ClassType originalThis, IEnumerable<string> args)
    {
        state = 0;
        this.args = args;
        this.originalThis = originalThis;
    }

    private IEnumerable<string> args;
    private IEnumerator<string> enumerator2;
    private IEnumerator<string> argEnumerator;

    //- Here ClassType is the type of the object that contained the method
    //  This may be optimized away if the method does not access any 
    //  class members
    private ClassType originalThis;

    //This holds the state value.
    private int state;
    //The current value to return
    private string currentValue;

    public string Current
    {
        get 
        {
            return currentValue;
        }
    }
} 
```

然后将方法体从原始方法移动到“Closure”内部称为 MoveNext 的方法，该方法返回一个布尔值，并实现 IEnumerable.MoveNext。对任何本地人的任何访问都通过“this”进行路由，对任何类成员的任何访问都通过 this.originalThis 进行路由。

任何“yield return expr”都被翻译成：

```
currentValue = expr;
state = //the state number of the yield statement;
return true; 
```

任何 yield break 语句都被翻译成：

```
state = -1;
return false; 
```

函数末尾有一个“隐式” yield break 语句。然后在过程的开头引入一个 switch 语句，它查看状态号并跳转到相关的标签。

然后将原始方法翻译成如下内容：

```
IEnumerator<string> strings(IEnumerable<string> args)
{
   return new ClosureEnumerable(this,args);
} 
```

方法的状态全部被推入一个对象并且 MoveNext 方法使用 switch 语句/状态变量这一事实允许迭代器表现得好像控制在最后一次“yield return”之后立即被传递回" 下次调用“MoveNext”时声明。

然而，重要的是要指出，C# 编译器使用的转换并不是执行此操作的最佳方式。当尝试将“yield”与递归算法一起使用时，它的性能很差。有一篇很好的论文在这里概述了一种更好的方法：

[http://research.microsoft.com/en-us/projects/specsharp/iterators.pdf](http://research.microsoft.com/en-us/projects/specsharp/iterators.pdf)

如果你还没有读过它，它值得一读。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-07T06:40:51.510

刚刚发现了这个问题——我最近[写了一篇关于它的文章。](http://csharpindepth.com/Articles/Chapter6/IteratorBlockImplementation.aspx)不过，我必须将此处提到的其他链接添加到文章中...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-25T07:20:33.917

Raymond chen 回答了这个问题；[http://blogs.msdn.com/b/oldnewthing/archive/2008/08/12/8849519.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2008/08/12/8849519.aspx)

（编辑指向该系列的第 1 部分，而不是第 4 部分）

# java - java.io.IOException 的可能原因是什么：“文件名、目录名或卷标语法不正确”

> ID：131901
> 
> 赞同：18
> 
> 时间：2008-09-25T07:22:28.593
> 
> 标签：java, exception, file-io

我正在尝试使用以下代码复制文件：

```
File targetFile = new File(targetPath + File.separator + filename);
...
targetFile.createNewFile();
fileInputStream = new FileInputStream(fileToCopy);
fileOutputStream = new FileOutputStream(targetFile);
byte[] buffer = new byte[64*1024];
int i = 0;
while((i = fileInputStream.read(buffer)) != -1) {
    fileOutputStream.write(buffer, 0, i);
} 
```

对于某些用户`targetFile.createNewFile`，此异常的结果：

```
java.io.IOException: The filename, directory name, or volume label syntax is incorrect
    at java.io.WinNTFileSystem.createFileExclusively(Native Method)
    at java.io.File.createNewFile(File.java:850) 
```

文件名和目录名似乎是正确的。甚至在执行复制代码之前检查目录`targetPath`是否存在，文件名如下所示：`AB_timestamp.xml`

用户具有写入权限，`targetPath`并且可以使用操作系统复制文件而不会出现问题。

由于我无法访问机器，这还发生在我自己的机器上，并且无法在我自己的机器上重现该问题，所以我向您寻求有关此异常原因的提示。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2016-02-16T23:20:51.073

当文件名的时间戳带有冒号时，可能会发生这种情况，例如。`myfile_HH:mm:ss.csv` 删除冒号解决了这个问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-25T15:01:04.857

试试这个，因为它更注意调整 targetPath 和文件名之间的路径中的目录分隔符：

```
File targetFile = new File(targetPath, filename); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-04-25T09:56:31.627

我刚刚遇到了同样的问题。我认为这与写访问权限有关。我在尝试写入 c:\ 时遇到错误，但在更改为 D:\ 时一切正常。显然 Java 没有权限写入我的系统驱动器（运行安装在 C 上的 Windows 7 :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-07T12:53:47.527

这是我使用的测试程序

```
import java.io.File;
public class TestWrite {

    public static void main(String[] args) {
        if (args.length!=1) {
            throw new IllegalArgumentException("Expected 1 argument: dir for tmp file");
        }
        try  {
            File.createTempFile("bla",".tmp",new File(args[0]));
        } catch (Exception e) {
            System.out.println("exception:"+e);
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T07:45:53.483

尝试在不同的目录中创建文件 - 例如“C:\”，然后确保您具有对该目录的写入权限。如果可行，则文件的路径名错误。

查看 Exception 中的注释并尝试更改文件路径名中的所有元素。实验。得出结论。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-06-26T10:43:52.093

删除完整路径中文件/文件夹名称中的任何特殊字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T07:28:52.337

您是否检查 targetPath 是一个目录，或者是否存在具有该名称的东西？（我知道您说用户可以从操作系统复制它，但也许他们正在输入其他内容）。

targetPath 是否已经以 File.separator 结尾？

（如果您可以记录并告诉我们在失败案例中 targetPath 和 filename 的值是什么，这会有所帮助）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-25T07:29:51.633

也许问题在于它正在通过网络将文件复制到共享驱动器？我认为当路径类似于 \mypc\myshared 文件夹时，使用 NFS 写入文件时 java 可能会出现问题。

这个问题发生的路径是什么？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T07:30:20.227

尝试添加一些日志以查看文件试图创建的名称和路径，以确保父目录是一个目录。

此外，您还可以查看 Channels 而不是使用循环。;-)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T07:39:07.790

您说“对于某些用户” - 所以它适用于其他用户？这里有什么区别，用户是在不同的机器上运行不同的实例，还是这是为并发用户提供服务的服务器？

如果是后者，我会说这是一个并发错误 - 两个线程检查尝试同时使用 WinNTFileSystem.createFileExclusively(Native Method) 创建文件。

当我查看 OpenJDK 源代码时，createNewFile 和 createFileExclusively 都没有同步，因此您可能必须自己同步这个块。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-25T09:29:00.333

也许该文件已经存在。如果您的时间戳分辨率不够好，可能会出现这种情况。由于您收到的是 IOException，因此可能不是权限问题（在这种情况下您会收到 SecurityException）。

在尝试创建文件并尝试记录发生的情况之前，我会首先检查文件是否存在。

查看[public boolean createNewFile()](http://java.sun.com/javase/6/docs/api/java/io/File.html#createNewFile())以获取有关您正在使用的方法的更多信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-15T09:22:21.170

由于我无法在我自己的机器上重现错误，或者无法使用代码失败的用户机器，我一直等到现在才宣布接受的答案。我将代码更改为以下内容：

```
File parentFolder = new File(targetPath);
... do some checks on parentFolder here ...
File targetFile = new File(parentFolder, filename);
targetFile.createNewFile();
fileInputStream = new FileInputStream(fileToCopy);
fileOutputStream = new FileOutputStream(targetFile);
byte[] buffer = new byte[64*1024];
int i = 0;
while((i = fileInputStream.read(buffer)) != -1) {
    fileOutputStream.write(buffer, 0, i);
} 
```

之后，它适用于报告问题的用户。

因此，Alexanders 的回答似乎起到了作用——尽管我实际上使用的构造函数与他给出的构造函数略有不同，但思路相同。

我还必须说服该用户通过再次运行旧版本并检查它是否仍然失败来帮助我验证代码更改是否修复了错误（而不是他做不同的事情）。

顺便提一句。日志记录已经到位，并且记录的路径似乎没问题 - 抱歉没有提到这一点。我认为这是理所当然的，并发现它不必要地使问题中的代码复杂化。

感谢您提供有用的答案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-11-30T10:50:05.597

当 TOMCAT 主页设置有训练反斜杠时，在 Eclipse 中为我生成了一个非常相似的错误：“... java.io.IOException：文件名、目录名或卷标语法不正确”。

建议的小修改：- [http://www.coderanch.com/t/556633/Tomcat/java-io-IOException-filename-directory](http://www.coderanch.com/t/556633/Tomcat/java-io-IOException-filename-directory) 为我修复了它。

# php - 评估用户代码的安全问题是什么？

> ID：131902
> 
> 赞同：5
> 
> 时间：2008-09-25T07:22:30.823
> 
> 标签：php, security

我想知道实施`PHP evaluator`这样的安全问题有哪些：

```
<?php eval($_POST['codeInput']); %> 
```

这是在`PHP sandbox`对等进行如此消毒的背景下，这`DB input`不是一个大问题。

销毁文件所在服务器的用户是。

我见过`Ruby simulators`，所以我很好奇安全方面所涉及的内容（至少细节模糊）。

* * *

谢谢大家。我什至不确定接受哪个答案，因为它们都很有用。

[欧文的回答](https://stackoverflow.com/questions/131902/what-are-the-security-concerns-of-evaluating-user-code-in-php#131911)总结了我的怀疑（服务器本身会有风险）。

[arin 的回答](https://stackoverflow.com/questions/131902/what-are-the-security-concerns-of-evaluating-user-code-in-php#137019)给出了潜在问题的一个很好的例子。

[Geoff 的回答](https://stackoverflow.com/questions/131902/what-are-the-security-concerns-of-evaluating-user-code-in-php#137167)和[Randy 的回答](https://stackoverflow.com/questions/131902/what-are-the-security-concerns-of-evaluating-user-code-in-php#137118)呼应了您需要编写自己的评估器以实现模拟类型功能的普遍观点。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-25T07:23:51.040

不要那样做。

他们基本上可以访问您可以在 PHP 中执行的任何操作（查看文件系统、获取/设置任何类型的变量、打开与其他机器的连接以插入要运行的代码等...）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-11T11:49:54.160

该`eval()`功能很难消毒，即使您这样做了，也肯定有办法解决它。即使您进行了过滤`exec`，您所需要做的就是以某种方式将字符串粘合`exec`到一个变量中，然后执行`$variable()`. 你需要真正削弱语言才能实现至少某种想象中的安全性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-26T00:04:37.157

`eval()`如果你想要类似的东西，可能会遇到很大的麻烦

```
<?php
   eval("shell_exec(\"rm -rf {$_SERVER['DOCUMENT_ROOT']}\");");
?> 
```

这是一个极端的例子，但那样的话您的网站就会被删除。希望您的权限不会允许，但它有助于说明清理和检查的必要性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-25T07:34:50.717

您可以说很多事情。这些问题**并非特定于 PHP。**

这是简单的答案：

**您的机器（或数据库）的任何输入都需要进行清理。**

您发布的代码片段几乎可以让用户运行他们想要的任何代码，因此它特别危险。

这里有一篇关于代码注入的很好的介绍性文章：

[关于代码注入的维基百科](http://en.wikipedia.org/wiki/Code_injection)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-25T07:42:37.157

如果您允许在您的服务器上运行任意代码，那么它就不再是您的服务器了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-26T00:18:07.247

亲爱的上帝**不**。我什至对标题感到畏缩。允许用户运行任何类型的任意代码就像将服务器交给他们

我知道我上面的人已经说过了。但相信我。有人可以告诉您清理您的输入的次数永远不够。

如果你*真的，真的* 想让用户运行某种代码。通过创建用户可以用来执行此操作的某种伪语言，使命令的子集可供用户使用。A-la bbcode 或 markdown 的工作方式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-26T00:48:34.350

如果您正在寻找构建一个[在线 PHP 解释器](http://www.hping.org/phpinteractive/)，您将需要构建一个实际的[REPL](http://en.wikipedia.org/wiki/REPL)解释器，而不是使用 eval。

否则，永远不要执行任意用户代码。曾经。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-26T00:31:22.193

不要**让**未经过滤的代码在您的服务器上执行，期间。

如果您想创建一个允许交互式演示语言的工具，例如这里看到的工具：http: [//tryruby.hobix.com/](http://tryruby.hobix.com/)我会自己编写语言的子部分。理想情况下，您将使用它向新程序员演示简单的概念，因此如果您正确实现所有功能，这无关紧要。

通过这样做，您可以通过已知可接受输入的**白名单来控制输入。**如果输入不在白名单上，则不会执行。

祝你好运！

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-25T08:20:23.603

正如已经回答的那样，您需要清理您的输入。我想您可以使用某种正则表达式过滤来删除不需要的命令，例如“exec”，基本上每个恶意命令 PHP 必须提供（或可能被利用），这很多。

# linux - 为 NIS 帐户创建本地邮箱

> ID：131915
> 
> 赞同：0
> 
> 时间：2008-09-25T07:24:22.583
> 
> 标签：linux, fedora

为拥有 NIS 帐户但没有任何本地帐户的用户创建本地邮箱的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T12:15:36.563

我通过创建一个与 NIS 中的登录名、UID 和 GID 完全相同的本地帐户解决了这个问题。这样，为用户创建了一个邮箱，并且在具有 NIS 帐户的用户登录后，该邮箱就可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T08:51:05.637

我不确定这是否直接可能。也许您可以使用 Nologin shell 将用户添加为本地用户，这样就可以给 ham 一个带有邮件的帐户？

# c# - 推荐一个好的基于 C#/.NET 的词法分析器

> ID：131920
> 
> 赞同：3
> 
> 时间：2008-09-25T07:25:42.157
> 
> 标签：c#, lexical-analysis

谁能推荐一个好的基于 .NET 的词法分析器，最好用 C# 编写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T07:29:51.150

下载 Visual Studio SDK；它包括一个托管解析器/词法分析器生成器。

（编辑：显然是在我的大学校园里写的：D）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T07:37:57.807

ANTLR 有一个[C# 目标](http://www.antlr.org/wiki/display/ANTLR3/Antlr+3+CSharp+Target)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T07:32:47.227

[gplex](http://plas.fit.qut.edu.au/gplex/)和 cs_lex

# apache - 为什么我的热部署文件有时会消失？（我认为 Apache 吃掉了它们）

> ID：131923
> 
> 赞同：1
> 
> 时间：2008-09-25T07:26:50.487
> 
> 标签：apache, cruisecontrol, hotdeploy

这是我的情况：

*   视窗服务器
*   阿帕奇
*   巡航控制

我的 CruiseControl 部署脚本的最后一步将构建复制到 Apache 的 htdocs 文件夹中，在“演示”文件夹中（我相信这被称为“热部署”？）

一切都很好，花花公子，除了有时（不常见，但它发生得足以让我烦恼），演示文件夹不包含我构建的文件！旧的没有了，新的不在了，就这样消失了。

我的直觉是，如果我在网上有人下载文件时尝试覆盖文件，Apache 只是在下载完成后删除它？我不知道，这没有任何意义。

我到处寻找，甚至找不到任何提示......让我们看看这个 StackOverflow 社区到底有多好！:)

这是我的 ANT 脚本中的“部署”目标：

```
<target name="deploy" depends="revertVersionFile">
    <copy todir="${deploy.dir}">
        <fileset dir="${bin.dir}"/>
    </copy>
    <copy todir="${deploy.dir}">
        <fileset dir="${bin.dir}"/>
    </copy>
    <available file="${deploy.dir}/MockupsLive.swf" property="mockupsFile"/>
    <fail unless="mockupsFile" message="MockupsLive doesn't exist!"/>       
    <available file="${deploy.dir}/skins/sketch/sketch.swf" property="skinFile"/>
    <fail unless="skinFile" message="sketch.swf doesn't exist!"/>       
</target> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T16:02:53.843

我建议在复制新文件之前创建旧文件的备份。用它们被替换时的时间戳命名旧文件。这样做，然后在下次失败时查看目录中的内容很可能会为您提供下一步查找的线索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-25T23:01:15.107

Apache 不会删除目录的内容。脚本中的某些内容正在删除内容是我的猜测。该脚本是否创建任何类型的备份？也许它将内容移动到备份文件夹，然后复制构建。

您可以为该文件夹添加一些安全性以防止其被删除。也许然后某个地方会弹出一个错误，让您了解什么是方便地删除目录。:) 我的猜测是它在脚本中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T14:35:31.757

我认为问题可能出在 CruiseControl 文件中。最有可能发生的事情是 CruiseControl 进程正在某处整理文件，但可能是由于文件锁定（可能由 Apache 锁定），它无法将文件写回该文件夹。

无论哪种方式，由于“部署”似乎是最后一步，之前的步骤可能会清除目录并且部署无法运行，在步骤结束时将您的文件夹留空。

# c# - 如何读取时间值，然后将其插入 TimeSpan 变量

> ID：131944
> 
> 赞同：2
> 
> 时间：2008-09-25T07:29:32.523
> 
> 标签：c#, .net, time, timespan

如何读取时间值，然后将其插入 TimeSpan 变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T07:39:45.790

如果我对您的理解正确，您正在尝试以“08:00”的形式获取一些用户输入并希望将时间存储在时间跨度变量中？

所以..像这样的东西？

```
string input = "08:00";
DateTime time;
if (!DateTime.TryParse(input, out time))
{
    // invalid input
    return;
}

TimeSpan timeSpan = new TimeSpan(time.Hour, time.Minute, time.Second); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T07:35:54.910

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)：TimeSpan 对象表示时间间隔或持续时间，以天数、小时数、分钟数、秒数和秒数的正数或负数来衡量。用于衡量持续时间的最大时间单位是一天。

以下是如何将其初始化为 CurrentTime（以滴答为单位）：

```
TimeSpan ts = new TimeSpan(DateTime.Now.Ticks); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T07:33:20.457

```
TimeSpan span = new TimeSpan(days,hours,minutes,seconds,milliseonds); 
```

或者，如果您的意思是日期时间：

```
DateTime time = new DateTime(year,month,day,minutes,seconds,milliseconds); 
```

所有参数都是整数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T07:34:00.720

也许使用：

```
var span = new TimeSpan(hours, minutes, seconds); 
```

如果您的意思是将两个时间跨度加在一起，请使用：

```
var newSpan = span.Add(new TimeSpan(hours, minutes, seconds)); 
```

有关详细信息，请参阅[msdn](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T07:34:28.143

您不能更改 TimeSpan 的属性。您需要创建一个新实例并在那里传递新值。

# windows - 将剪贴板内容粘贴到命令提示符窗口（Win XP）的键盘快捷键

> ID：131955
> 
> 赞同：305
> 
> 时间：2008-09-25T07:31:36.917
> 
> 标签：windows, keyboard-shortcuts

是否有用于将剪贴板内容粘贴到 Windows XP 上的命令提示符窗口中的键盘快捷键（而不是使用鼠标右键）？

典型的`Shift`+`Insert`似乎在这里不起作用。

* * *

## 回答 #1

> 赞同：428
> 
> 时间：2008-09-25T07:36:07.623

是的。。但是很尴尬。[关联](https://docs.microsoft.com/en-gb/archive/blogs/adioltean/useful-copypaste-trick-in-cmd-exe)

`alt`+ `Space`, `e`, `k`<-- 复制和
`alt`+ `Space`, `e`, `p`<-- 粘贴。

* * *

## 回答 #2

> 赞同：163
> 
> 时间：2008-09-25T13:30:58.130

我个人使用一个小的[AutoHotkey](http://www.autohotkey.com/)脚本来重新映射某些键盘功能，对于我使用的控制台窗口（CMD）：

```
; Redefine only when the active window is a console window 
#IfWinActive ahk_class ConsoleWindowClass

; Close Command Window with Ctrl+w
$^w::
WinGetTitle sTitle
If (InStr(sTitle, "-")=0) { 
    Send EXIT{Enter}
} else {
    Send ^w
}

return 

; Ctrl+up / Down to scroll command window back and forward
^Up::
Send {WheelUp}
return

^Down::
Send {WheelDown}
return

; Paste in command window
^V::
; Spanish menu (Editar->Pegar, I suppose English version is the same, Edit->Paste)
Send !{Space}ep
return

#IfWinActive 
```

* * *

## 回答 #3

> 赞同：137
> 
> 时间：2008-09-25T07:39:01.893

不是真正的编程相关，但我在谷歌上找到[了这个，](http://windowsitpro.com/article/articleid/79505/jsi-tip-7363-how-do-i-copy--paste-between-a-command-prompt-or-ms-dos-program-and-a-windows-program.html)**没有直接的键盘快捷键**，但让它更快一点。

## 要启用或禁用快速编辑模式：

1.  打开 MS-DOS 程序或命令提示符。
2.  右键单击标题栏，然后按属性。
3.  选择选项选项卡。
4.  选中或取消选中快速编辑模式框。
5.  按确定。
6.  在“将属性应用到快捷方式”对话框中，仅当您希望仅更改此窗口的此会话的快速编辑设置时选择将属性应用到当前窗口，或选择修改启动此窗口的快捷方式以更改所有未来调用的快速编辑设置命令提示符或 MS-DOS 程序。

![快速编辑](https://i.stack.imgur.com/viWyn.png)

## 在启用 QuickEdit 时复制文本：

1.  单击并将鼠标指针拖动到所需的文本上。
2.  按 Enter（或右键单击窗口中的任意位置）将文本复制到剪贴板。

## 在启用 QuickEdit 时粘贴文本：

1.  右键单击窗口中的任意位置。

## 在禁用快速编辑时复制文本：

1.  右键单击标题栏，按菜单上的编辑，然后按标记。
2.  将鼠标拖到要复制的文本上。
3.  按 Enter（或右键单击窗口中的任意位置）将文本复制到剪贴板。

## 在禁用快速编辑时粘贴文本：

1.  右键单击标题栏，按菜单上的编辑，然后按粘贴。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2010-03-10T23:34:54.730

谢谢巴勃罗，正是我想要的！但是，如果我可以冒昧地稍微改进一下您的脚本，我建议您将 ^V 宏替换为以下内容：

```
; Use backslash instead of backtick (yes, I am a C++ programmer).
#EscapeChar \

; Paste in command window.
^V::
StringReplace clipboard2, clipboard, \r\n, \n, All
SendInput {Raw}%clipboard2%
return 
```

使用 SendInput 的优点是

*   它不依赖于具有“Alt+Space E P”菜单项的命令提示符系统菜单来进行粘贴（适用于英语和西班牙语，但不适用于所有语言）。
*   它避免了在创建和销毁菜单时出现的令人讨厌的闪烁。

请注意，在 SendInput 命令中包含“{Raw}”很重要，以防剪贴板恰好包含“!”、“+”、“^”或“#”。

请注意，它使用 StringReplace 删除多余的 Windows 回车符。感谢hugov的建议！

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2014-01-20T18:47:30.117

还有[一个很棒的开源工具，叫做 clink](http://mridgers.github.io/clink/)，它扩展了 cmd 的许多功能。其中之一是能够使用 ctrl+v 插入文本。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2015-07-19T21:58:05.890

在 Windows 10 上，您[可以启用`Ctrl`+ `C`和`Ctrl`+ `V`在命令提示符下工作](http://www.howtogeek.com/197749/how-to-power-up-the-windows-10-command-prompt-with-ctrlc-and-ctrlv/)：

![在此处输入图像描述](https://i.stack.imgur.com/U6WkL.png)

![在此处输入图像描述](https://i.stack.imgur.com/hhS0B.png)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-11-04T09:28:31.357

[这](http://dennisbabkin.com/clc/)是一个可以在 Windows 上执行此操作的免费工具。我更喜欢它而不是脚本，因为它很容易设置。它作为一个快速的本机应用程序运行，适用于 XP 及更高版本，具有允许重新映射命令窗口的复制/粘贴/选择键的配置设置：

[![在此处输入图像描述](https://i.stack.imgur.com/MA02D.png)](https://i.stack.imgur.com/MA02D.png)

另外，我认识开发人员。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-05-04T00:19:06.883

感谢 Pablo 提到 AutoHotkey 实用程序。由于我安装了使用`Alt`+的 Launchy，因此`Space`我必须对其进行修改，但要添加`Shift`密钥，如下所示：

```
; Paste in command window
^V::
; Spanish menu (Editar->Pegar, I suppose English version is the same, Edit->Paste)
Send !+{Space}ep
return 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-07-17T06:53:39.637

最简单的方法就是将要粘贴的文本复制到 cmd 并打开 cmd 转到“属性”--->“选项”选项卡---->选中（打勾）“快速编辑模式”并单击“好的” .....现在您可以通过用鼠标**右键单击**来粘贴剪贴板中的任何文本。

谢谢..

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-25T07:37:04.720

这不是真正的快捷方式，而只是快速访问控制菜单：Alt-space EP

如果您可以使用鼠标，请在我尝试时右键单击 cmd 窗口作为粘贴。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-08-26T12:46:35.540

理论上，DOS Prompt 中的应用程序有自己的剪贴板和快捷方式。从 Windows 剪贴板导入文本是“额外的”。但是您可以使用 Alt-Space 打开提示窗口的系统菜单，然后按 E、P 选择编辑、粘贴菜单。但是，MS 可以使用 Win 键提供快捷方式。没有机会在 DOS 应用程序中使用。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-07-13T13:50:48.500

我花了一点时间才弄清楚为什么你的[AutoHotkey](http://www.autohotkey.com)脚本对我不起作用：

```
; Use backslash instead of backtick (yes, I am a C++ programmer).
#EscapeChar \

; Paste in command window.
^V::
StringReplace clipboard2, clipboard, \r\n, \n, All
SendInput {Raw}%clipboard2%
return 
```

事实上，它依赖于击键，因此依赖于键盘布局！因此，当您像我一样不幸只有一个 AZERTY 键盘时，您的建议就是行不通的。更糟糕的是，我发现没有简单的方法来替换 SendInput 方法或扭曲它的环境来解决这个问题。例如 SendInput "1" 只是不发送数字 1。

我必须把每个字符都转换成它的 unicode 才能让它在我的电脑上工作：

```
#EscapeChar \

; Paste in command window.
^V::
StringReplace clipboard2, clipboard, \r\n, \n, All
clipboard3 := ""
Loop {
    if (a_index>strlen(clipboard2))
     break 
    char_asc := Asc(SubStr(clipboard2, a_Index, 1))   
    if (char_asc > 127 and char_asc < 256)
     add_zero := "0"
    else
     add_zero := "" 
    clipboard3 :=  clipboard3  . "{Asc " .  add_zero . char_asc . "}"
}
SendInput %clipboard3%
return 
```

不是很简单...

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-08-26T12:42:37.720

我按照@PabloG的步骤如下

1.  转到[http://www.autohotkey.com/](http://www.autohotkey.com/) - 下载 autohotkey
2.  按照简单的安装步骤
3.  安装后创建新的 *.ahk 文件如下右击桌面 > 新建 > Autohotkey 脚本 > giveAnyFileName.ahk
4.  右键单击此文件>编辑
5.  复制@PabloG 在他的回答中给出的粘贴自动热键脚本
6.  保存并关闭
7.  双击文件运行
8.  现在完成，您应该可以在命令提示符下使用`Ctrl`+进行粘贴`v`

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-10-04T16:52:31.810

如果您使用剪贴板管理器[Ditto](http://ditto-cp.sourceforge.net/index.php)（开源，免费），您可以简单地使用从 Ditto 粘贴的快捷方式，它会为您将剪贴板粘贴到 CMD 中。

[![在此处输入图像描述](https://i.stack.imgur.com/dtApe.gif)](https://i.stack.imgur.com/dtApe.gif)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-25T07:46:07.443

您可以尝试使用[Texter](http://lifehacker.com/software/texter/lifehacker-code-texter-windows-238306.php "发短信")并创建一些不太可能的东西，例如：

./p ，由空格触发并用 %c 替换文本

我刚刚测试了它，它工作正常。唯一的问题是使用罕见的序列，因为 Texter 不能将其限制为 cmd。

可能还有其他这种类型的实用程序可以工作，甚至[AutoHotKey](http://www.autohotkey.com "自动热键")，Texter 建立在它的基础上可以做得更好，但是 Texter 很容易:-)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-08-13T08:10:45.133

更简单的方法是使用 windows powershell 而不是 cmd。它适用于文本器。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-12-29T12:58:03.243

我最近发现命令提示符通过鼠标右键单击支持上下文菜单。您可以在此处找到更多详细信息：[http ://www.askdavetaylor.com/copy_paste_within_microsoft_windows_command_prompt.html](http://www.askdavetaylor.com/copy_paste_within_microsoft_windows_command_prompt.html)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-05-02T12:58:49.630

非常简单的解决方案可能是[Console 2](http://sourceforge.net/projects/console/)，重新定义键，然后就可以了。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-02-27T23:15:49.077

如果您是 Cygwin 用户，您可以将以下内容附加到您的 ~/.bashrc 文件中：

`stty lnext ^q stop undef start undef`

并将以下内容添加到您的 ~/.inputrc 文件中：

```
"\C-v": paste-from-clipboard
"\C-C": copy-to-clipboard 
```

重新启动 Cygwin 终端。

（注意，我使用大写的 C 进行复制，因为 CTRL+c 在大多数控制台上都分配给了 break 功能。根据口味调整。）

[来源](http://www.saltycrane.com/blog/2008/05/how-to-paste-in-cygwin-bash-using-ctrl/)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-05-18T02:03:14.923

而不是“右键单击”....通过键入 Alt/空格键来启动您的会话（一旦您在命令提示符窗口中）。这将打开命令提示符窗口菜单，您将看到熟悉的带下划线的键盘命令快捷方式，就像在 Windows GUI 中一样。

祝你好运！

* * *

## 回答 #21

> 赞同：-4
> 
> 时间：2011-06-02T23:39:34.983

在 VISTA 命令提示下： 单击系统图标 从菜单中选择默认值 在选项组的选项选项卡上，我选择了“快速编辑模式”、“插入模式”和“自动完成” 我认为“快速编辑模式”是什么使它工作。

要在插入点粘贴剪贴板中的任何内容：右键单击。从命令窗口复制 通过按住鼠标左键并将指针拖动到要复制的内容上进行选择 选择后，单击鼠标右键 要粘贴到插入点，再次单击鼠标右键。

# xml - 依赖注入容器有什么好处？

> ID：131975
> 
> 赞同：104
> 
> 时间：2008-09-25T07:37:19.540
> 
> 标签：xml, spring, dependency-injection

我了解依赖注入本身的好处。让我们以 Spring 为例。我也了解其他 Spring 特性的好处，如 AOP、不同类型的助手等。我只是想知道，XML 配置有什么好处，例如：

```
<bean id="Mary" class="foo.bar.Female">
  <property name="age" value="23"/>
</bean>
<bean id="John" class="foo.bar.Male">
  <property name="girlfriend" ref="Mary"/>
</bean> 
```

与普通的旧 java 代码相比，例如：

```
Female mary = new Female();
mary.setAge(23);
Male john = new Male();
john.setGirlfriend(mary); 
```

这更容易调试，编译时间检查，任何只知道java的人都可以理解。那么依赖注入框架的主要目的是什么？（或一段显示其好处的代码。）

* * *

**更新：**
如果

```
IService myService;// ...
public void doSomething() {  
  myService.fetchData();
} 
```

如果有多个，IoC 框架如何猜测我要注入的 myService 的哪个实现？如果给定接口只有一个实现，并且我让 IoC 容器自动决定使用它，那么在出现第二个实现后它将被破坏。而且，如果故意只有一种可能的接口实现，那么您不需要注入它。

看到 IoC 的一小部分配置显示它的好处会非常有趣。我使用 Spring 已经有一段时间了，我无法提供这样的例子。我可以展示单行代码来展示我使用的 hibernate、dwr 和其他框架的好处。

* * *

**更新 2：**
我意识到可以在不重新编译的情况下更改 IoC 配置。这真的是个好主意吗？我可以理解何时有人想要更改数据库凭据而不重新编译 - 他可能不是开发人员。在您的实践中，开发人员以外的其他人多久更改一次 IoC 配置？我认为对于开发人员而言，无需重新编译该特定类而不是更改配置。对于非开发人员，您可能希望让他的生活更轻松并提供一些更简单的配置文件。

* * *

**更新 3：**

> 接口及其具体实现之间映射的外部配置

让它外接有什么好处？您不必将所有代码都放在外部，虽然您绝对可以 - 只需将其放在 ClassName.java.txt 文件中，即时手动读取和编译 - 哇，您避免了重新编译。为什么要避免编译？！

> 您可以节省编码时间，因为您以声明方式提供映射，而不是在程序代码中

我知道有时声明性方法可以节省时间。例如，我只声明一次 bean 属性和 DB 列之间的映射，hibernate 在加载、保存、构建基于 HSQL 的 SQL 等时使用此映射。这就是声明性方法的工作原理。在 Spring 的情况下（在我的示例中），声明有更多的行并且与相应的代码具有相同的表现力。如果有这样的声明比代码短的例子 - 我想看看。

> 控制反转原则允许简单的单元测试，因为您可以用假的实现替换真实的实现（比如用内存中的替换 SQL 数据库）

我确实理解控制反转的好处（我更喜欢将这里讨论的设计模式称为依赖注入，因为 IoC 更通用 - 有多种控制，我们只反转其中一种 - 初始化控制）。我在问为什么有人需要编程语言以外的东西。我绝对可以使用代码用假的实现替换真实的实现。这段代码将表达与配置相同的内容——它只会用假值初始化字段。

```
mary = new FakeFemale(); 
```

我确实了解 DI 的好处。我不明白与配置相同的代码相比，外部 XML 配置有什么好处。我认为不应该避免编译——我每天都在编译，而且我还活着。我认为 DI 的配置是声明性方法的坏例子。如果声明一次并且以不同的方式多次使用，则声明可能很有用 - 例如 hibernate cfg，其中 bean 属性和 DB 列之间的映射用于保存、加载、构建搜索查询等。Spring DI 配置可以很容易地转换为配置代码，就像在这个问题的开头一样，不能吗？而且它仅用于 bean 初始化，不是吗？这意味着声明性方法不会在此处添加任何内容，是吗？

当我声明hibernate映射时，我只是给hibernate一些信息，它基于它工作——我不告诉它做什么。在春天的情况下，我的声明告诉春天到底要做什么——那么为什么要声明它，为什么不直接去做呢？

* * *

**最后更新：**
伙计们，很多答案都在告诉我有关依赖注入的信息，我知道这很好。问题是关于 DI 配置的目的而不是初始化代码 - 我倾向于认为初始化代码更短更清晰。到目前为止，我对我的问题的唯一答案是，当配置更改时，它可以避免重新编译。我想我应该发布另一个问题，因为这对我来说是一个很大的秘密，为什么在这种情况下应该避免编译。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-08T12:20:02.153

对我自己来说，使用 IoC（并利用外部配置）的主要原因之一是围绕以下两个方面：

*   测试
*   生产维护

**测试**

如果您将测试分为 3 个场景（这在大规模开发中是相当正常的）：

1.  单元测试
2.  集成测试
3.  黑盒测试

对于最后两个测试场景（集成和黑盒），您要做的是不重新编译应用程序的任何部分。

如果您的任何测试场景需要您更改配置（即：使用另一个组件来模拟银行集成，或执行性能负载），这可以很容易地处理（这确实属于配置 DI 端的好处）国际奥委会虽然。

此外，如果您的应用程序用于多个站点（具有不同的服务器和组件配置）或在实时环境中具有更改的配置，您可以使用测试的后期阶段来验证应用程序是否能够处理这些更改。

**生产**

作为开发人员，您没有（也不应该）控制生产环境（特别是当您的应用程序分发给多个客户或单独的站点时），这对我来说是同时使用 IoC 和外部配置的真正好处，因为这取决于基础设施/生产支持来调整和调整实时环境，而无需返回给开发人员并通过测试（当他们想要做的只是移动组件时成本更高）。

**概括**

IoC 的外部配置的主要好处来自赋予其他人（非开发人员）配置您的应用程序的权力，根据我的经验，这仅在有限的情况下有用：

*   应用程序被分发到环境不同的多个站点/客户端。
*   对生产环境和设置的开发控制/输入有限。
*   测试场景。

在实践中，我发现即使在开发某些您确实可以控制它将运行的环境的东西时，随着时间的推移，最好让其他人能够更改配置：

*   开发时，您不知道它何时会改变（该应用程序非常有用，您的公司将其出售给其他人）。
*   我不想在每次请求轻微更改时都更改代码，而这些更改可以通过设置和使用良好的配置模型来处理。

*注意：应用程序是指完整的解决方案（不仅仅是可执行文件），因此应用程序运行所需的所有文件*。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-25T08:21:37.907

依赖注入是一种编码风格，其根源在于对象委托通常是比对象继承更有用的设计模式（即对象具有关系比对象是关系更有用）。然而，另一个要素是 DI 工作所必需的，即创建对象接口。结合这两种强大的设计模式，软件工程师很快意识到他们可以创建灵活的松散耦合代码，因此依赖注入的概念诞生了。然而，直到对象反射在某些高级语言中可用时，DI 才真正起飞。反射组件是当今大部分时间的核心

一种语言必须为普通的面向对象编程技术以及对对象接口和对象反射（例如 Java 和 C#）的支持提供良好的支持。虽然您可以在 C++ 系统中使用 DI 模式构建程序，但由于语言本身缺乏反射支持，因此无法支持应用程序服务器和其他 DI 平台，因此限制了 DI 模式的表达能力。

使用 DI 模式构建的系统的优势：

1.  DI 代码更容易重用，因为“依赖”功能被外推到定义良好的接口中，允许将配置由合适的应用程序平台处理的单独对象随意插入其他对象。
2.  DI 代码更容易测试。可以通过构建实现应用程序逻辑预期接口的“模拟”对象，在黑盒中测试对象表达的功能。
3.  DI 代码更灵活。它天生就是松散耦合的代码——到了极点。这允许程序员根据对象在一端的所需接口和在另一端表示的接口来挑选和选择对象的连接方式。
4.  DI 对象的外部 (Xml) 配置意味着其他人可以在不可预见的方向自定义您的代码。
5.  外部配置也是一种关注点分离模式，因为对象初始化和对象相互依赖管理的所有问题都可以由应用服务器处理。
6.  请注意，使用 DI 模式不需要外部配置，对于简单的互连，一个小的构建器对象通常就足够了。两者之间需要权衡灵活性。构建器对象不像外部可见的配置文件那样灵活。DI 系统的开发人员必须权衡灵活性与便利性的优势，注意配置文件中表达的对对象构造的小规模、细粒度控制可能会增加混乱和维护成本。

绝对 DI 代码似乎更麻烦，将所有用于配置对象的 XML 文件注入其他对象的缺点似乎很困难。然而，这是 DI 系统的重点。您将代码对象作为一系列配置设置混合和匹配的能力允许您使用 3rd 方代码构建复杂的系统，而您的代码最少。

问题中提供的示例仅涉及正确分解的 DI 对象库可以提供的表达能力的表面。通过一些实践和大量自律，大多数 DI 从业者发现他们可以构建对应用程序代码具有 100% 测试覆盖率的系统。仅这一点就非同寻常。这不是几百行代码的小型应用程序的 100% 测试覆盖率，而是包含数十万行代码的应用程序的 100% 测试覆盖率。我无法描述提供这种可测试性级别的任何其他设计模式。

你是对的，一个仅仅 10 行代码的应用程序比几个对象加上一系列 XML 配置文件更容易理解。然而，与大多数强大的设计模式一样，随着您继续向系统添加新功能，您会发现收益。

简而言之，基于 DI 的大规模应用程序更易于调试且更易于理解。虽然 Xml 配置没有“编译时检查”，但作者知道的所有应用程序服务如果他们试图将具有不兼容接口的对象注入另一个对象，都会向开发人员提供错误消息。并且大多数提供了涵盖所有已知对象配置的“检查”功能。通过检查要注入的对象 A 是否实现了对象 B 对所有已配置的对象注入所需的接口，可以轻松快速地完成此操作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-25T07:44:53.563

这是一个有点牵强的问题，但我倾向于同意大量的 xml 配置并没有真正带来太多好处。我希望我的应用程序对依赖项尽可能轻，包括庞大的框架。

它们在很多时候简化了代码，但它们也有复杂性的开销，这使得跟踪问题变得相当困难（我亲眼看到了这样的问题，而直接的 Java 处理起来会更舒服）。

我想这在某种程度上取决于风格，以及您对什么感到满意...您是否喜欢使用自己的解决方案并从内而外地了解它，或者依靠现有的解决方案，而这些解决方案在配置不正确时可能会被证明是困难的？ t 刚刚好？这都是一个权衡。

然而，XML 配置是我的一个小烦恼……我不惜一切代价尽量避免它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-15T19:23:08.233

任何时候您可以将代码更改为数据，您就朝着正确的方向迈出了一步。

将任何内容编码为数据意味着您的代码本身更通用且可重用。这也意味着您的数据可以用完全适合它的语言来指定。

此外，可以将 XML 文件读入 GUI 或其他工具，并且可以轻松地进行实用操作。您将如何使用代码示例来做到这一点？

我一直在将大多数人会以代码形式实现的东西分解到数据中，这使得留下的代码更加干净。我发现人们会用代码而不是数据来创建菜单是不可思议的——很明显，由于样板文件，在代码中这样做是完全错误的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-01T02:12:36.563

使用 DI 容器的原因是您不必在代码中预先配置十亿个简单的 getter 和 setter 属性。你真的想用 new X() 硬编码所有这些吗？当然，你可以有一个默认值，但是 DI 容器允许创建单例，这非常容易，并且允许你专注于代码的细节，而不是初始化它的杂项任务。

例如，Spring 允许您实现 InitializingBean 接口并添加 afterPropertiesSet 方法（您也可以指定“init-method”以避免将代码与 Spring 耦合）。这些方法将允许您确保在启动时正确配置类实例中指定为字段的任何接口，然后您不再需要对 getter 和 setter 进行空值检查（假设您确实允许单例保持线程安全）。

此外，使用 DI 容器进行复杂的初始化比自己进行要容易得多。例如，我协助使用 XFire（不是 CeltiXFire，我们只使用 Java 1.4）。该应用程序使用了 Spring，但不幸的是它使用了 XFire 的 services.xml 配置机制。当一个元素集合需要声明它有零个或多个实例而不是一个或多个实例时，我必须重写为这个特定服务提供的一些 XFire 代码。

在其 Spring beans 模式中定义了某些 XFire 默认值。因此，如果我们使用 Spring 来配置服务，则可以使用 bean。相反，我不得不在 services.xml 文件中提供特定类的实例，而不是使用 bean。为此，我需要提供构造函数并设置在 XFire 配置中声明的引用。我需要做的真正改变是重载一个类。

但是，感谢 services.xml 文件，我必须创建四个新类，根据它们在构造函数中的 Spring 配置文件中的默认值设置它们的默认值。如果我们能够使用 Spring 配置，我可以说：

```
<bean id="base" parent="RootXFireBean">
    <property name="secondProperty" ref="secondBean" />
</bean>

<bean id="secondBean" parent="secondaryXFireBean">
    <property name="firstProperty" ref="thirdBean" />
</bean>

<bean id="thirdBean" parent="thirdXFireBean">
    <property name="secondProperty" ref="myNewBean" />
</bean>

<bean id="myNewBean" class="WowItsActuallyTheCodeThatChanged" /> 
```

相反，它看起来更像这样：

```
public class TheFirstPointlessClass extends SomeXFireClass {
    public TheFirstPointlessClass() {
        setFirstProperty(new TheSecondPointlessClass());
        setSecondProperty(new TheThingThatWasHereBefore());
    }
}

public class TheSecondPointlessClass extends YetAnotherXFireClass {
    public TheSecondPointlessClass() {
        setFirstProperty(TheThirdPointlessClass());
    }
}

public class TheThirdPointlessClass extends GeeAnotherXFireClass {
    public TheThirdPointlessClass() {
        setFirstProperty(new AnotherThingThatWasHereBefore());
        setSecondProperty(new WowItsActuallyTheCodeThatChanged());
    }
}

public class WowItsActuallyTheCodeThatChanged extends TheXFireClassIActuallyCareAbout {
    public WowItsActuallyTheCodeThatChanged() {
    }

    public overrideTheMethod(Object[] arguments) {
        //Do overridden stuff
    }
} 
```

所以最终结果是必须将四个额外的、大部分毫无意义的 Java 类添加到代码库中，以实现一个额外的类和一些简单的依赖容器信息所达到的效果。这不是“证明规则的例外”，这是规则......当属性已经在 DI 容器中提供并且您只是更改它们以适应特殊情况时，处理代码中的怪癖要干净得多，这经常发生。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-24T01:35:08.720

我有你的答案

显然，每种方法都需要权衡取舍，但外部化的 XML 配置文件对于企业开发很有用，其中构建系统用于编译代码而不是您的 IDE。使用构建系统，您可能希望将某些值注入您的代码 - 例如构建版本（每次编译时必须手动更新可能会很痛苦）。当您的构建系统从某些版本控制系统中提取代码时，痛苦会更大。在编译时修改简单值将需要您更改文件、提交、编译，然后每次更改都恢复。这些不是您要提交到版本控制中的更改。

关于构建系统和外部配置的其他有用用例：

*   为不同构建的单个代码库注入样式/样式表
*   为您的单个代码库注入不同的动态内容集（或对它们的引用）
*   为不同的构建/客户端注入本地化上下文
*   将 Web 服务 URI 更改为备用服务器（当主服务器出现故障时）

更新：上面所有的例子都是关于不一定需要依赖类的东西。但是您可以轻松构建同时需要复杂对象和自动化的案例 - 例如：

*   想象一下，您有一个系统可以监控您网站的流量。根据并发用户的数量，它打开/关闭日志记录机制。也许当机制关闭时，一个存根对象被放置在它的位置。
*   想象一下，您有一个网络会议系统，根据用户的数量，您希望根据参与者的数量来切换 P2P 的能力

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T07:43:52.053

每次更改配置时都不需要重新编译代码。它将简化程序的部署和维护。例如，您只需在配置文件中进行 1 次更改即可将一个组件与另一个组件交换。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T08:02:59.213

你可以为女朋友插入一个新的实现。因此，无需重新编译代码即可注入新的女性。

```
<bean id="jane" class="foo.bar.HotFemale">
  <property name="age" value="19"/>
</bean>
<bean id="mary" class="foo.bar.Female">
  <property name="age" value="23"/>
</bean>
<bean id="john" class="foo.bar.Male">
  <property name="girlfriend" ref="jane"/>
</bean> 
```

（以上假设 Female 和 HotFemale 实现了相同的 GirlfFriend 接口）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T07:43:34.237

在 .NET 世界中，大多数 IoC 框架都提供 XML 和代码配置。

例如，StructureMap 和 Ninject 使用 fluent 接口来配置容器。您不再受限于使用 XML 配置文件。Spring 也存在于 .NET 中，由于它是他历史上的主要配置接口，因此严重依赖 XML 文件，但仍然可以通过编程方式配置容器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-26T04:01:54.247

易于**将部分配置组合**成最终的完整配置。

例如，在 Web 应用程序中，模型、视图和控制器通常在单独的配置文件中指定。使用声明式的方式，可以加载，例如：

```
 `UI-context.xml
  Model-context.xml
  Controller-context.xml` 
```

`或者加载不同的 UI 和一些额外的控制器：`

```
 ``AlternateUI-context.xml
  Model-context.xml
  Controller-context.xml
  ControllerAdditions-context.xml`` 
```

``在代码中做同样的事情需要一个用于组合部分配置的基础设施。在代码中并非不可能，但使用 IoC 框架肯定更容易做到。``

 ``* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-06-17T22:22:29.517

通常，重要的一点是*谁*在编写程序后更改配置。通过代码中的配置，您隐含地假设更改它的人具有与原始作者相同的技能和对源代码等的访问权限。

在生产系统中，将一些设置子集（例如您的示例中的年龄）提取到 XML 文件并允许例如系统管理员或支持人员更改值而不赋予他们对源代码或其他设置的全部权力 - 或者只是将它们与复杂性隔离开来。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-04-05T21:04:20.220

从 Spring 的角度来看，我可以给你两个答案。

首先，XML 配置不是定义配置的唯一方法。大多数事情都可以使用注释进行配置，而必须使用 XML 完成的事情是配置您无论如何都不会编写的代码，例如您从库中使用的连接池。Spring 3 包括一种使用 Java 定义 DI 配置的方法，类似于您示例中的手动 DI 配置。所以使用 Spring 并不意味着你必须使用基于 XML 的配置文件。

其次，Spring 不仅仅是一个 DI 框架。它具有许多其他功能，包括事务管理和 AOP。Spring XML 配置将所有这些概念混合在一起。通常在同一个配置文件中，我指定 bean 依赖项、事务设置并添加在后台使用 AOP 实际处理的会话范围 bean。我发现 XML 配置提供了一个更好的地方来管理所有这些特性。我还觉得基于注释的配置和 XML 配置比基于 Java 的配置扩展得更好。

But I do see your point and there isn't anything wrong with defining the dependency injection configuration in Java. I normally do that myself in unit tests and when I'm working on a project small enough that I haven't added a DI framework. I don't normally specify configuration in Java because to me that's the kind plumbing code that I'm trying to get away from writing when I chose to use Spring. That's a preference though, it doesn't mean that XML configuration is superior to Java based configuration.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T07:45:13.623

Spring 也有一个属性加载器。我们使用这种方法来设置依赖于环境的变量（例如开发、测试、验收、生产……）。例如，这可能是要收听的队列。

如果没有理由改变属性，也没有理由以这种方式配置它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-25T07:51:11.770

您的案例非常简单，因此不需要像 Spring 这样的 IoC（控制反转）容器。另一方面，当你“编程到接口，而不是实现”（这是 OOP 中的一个很好的做法）时，你可以有这样的代码：

```
IService myService;
// ...
public void doSomething() {
  myService.fetchData();
} 
```

（注意 myService 的类型是 IService ——一个接口，而不是一个具体的实现）。现在让您的 IoC 容器在初始化期间自动提供正确的 IService 具体实例会很方便——当您有许多接口和许多实现时，手动执行此操作可能很麻烦。IoC 容器（依赖注入框架）的主要好处是：

*   接口及其具体实现之间映射的外部配置
*   IoC 容器处理一些棘手的问题，例如解决复杂的依赖关系图、管理组件的生命周期等。
*   您可以节省编码时间，因为您以声明方式提供映射，而不是在程序代码中
*   控制反转原则允许简单的单元测试，因为您可以用假的实现替换真实的实现（比如用内存中的替换 SQL 数据库）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-11-12T15:58:36.710

在 XML 配置文件中进行初始化将简化您与将您的应用程序部署在其计算机上的客户端的调试/调整工作。（因为它不需要重新编译+二进制文件替换）

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2008-09-25T08:54:46.407

最吸引人的原因之一是“[好莱坞原则](http://en.wikipedia.org/wiki/Hollywood_Principle)”：不要打电话给我们，我们会打电话给你。组件本身不需要查找其他组件和服务；相反，它们会自动提供给它。在 Java 中，这意味着不再需要在组件内部进行 JNDI 查找。

单独对组件进行单元测试也容易得多：您无需为其提供所需组件的实际实现，而只需使用（可能是自动生成的）模拟。

# .net - Visual Studio 中的哪个程序可以让我查看 DLL 以查看其 API？

> ID：131985
> 
> 赞同：53
> 
> 时间：2008-09-25T07:43:02.133
> 
> 标签：.net, visual-studio-2008

看问题。我想查看 DLL 库提供的方法和类。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-25T07:43:40.680

这正是对象浏览器的用途。

*   添加对 DLL 的引用。
*   在列表中右键单击它。
*   单击*在对象浏览器中查看*。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-19T11:28:18.607

对于那些来自旧 Visual Studio 6.0 天的人：

**Dependency Walker**是一个不错的免费工具，它以前是 Visual Studio 的一部分。

[http://www.dependencywalker.com/](http://www.dependencywalker.com/)

我还是喜欢。这是一个屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/9s6wS.png)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-05-11T08:45:10.800

*   [ILSpy](http://ilspy.net/)是一个开源工具，它允许您浏览程序集的包和类以及反编译代码。

*   另一个免费工具是[JetBrain 的 dotPeek](https://www.jetbrains.com/decompiler/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-25T08:21:41.040

如果您的机器上没有安装 VS，还有[DLL 导出查看器。](http://www.nirsoft.net/utils/dll_export_viewer.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-25T08:25:32.420

如果 DLL 是 .NET 程序集，您可能需要查看[Reflector](http://www.red-gate.com/products/reflector/index.htm)以获得更详细的视图。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-03-14T22:07:02.007

如果您的下载选项有​​限：在 Visual Studio 中，您可以使用 Visual Studio 开发人员命令提示符。从 windows 菜单 -> 所有程序 -> Visual Studio XX -> Visual Studio 工具 -> 开发人员命令提示符打开它。然后：运行命令：`ildasm`

示例[ildasm](https://docs.microsoft.com/en-us/dotnet/framework/tools/ildasm-exe-il-disassembler)：

```
ildasm c:\MyNetAssembly.dll 
```

如果您有权下载任何程序，您可以使用更好的选择：
[IlSpy](http://ilspy.net/)
[dotPeek](https://www.jetbrains.com/decompiler/)
[.net reflector](https://www.red-gate.com/dynamic/products/dotnet-development/reflector/download)
[JustDecompile](https://www.telerik.com/products/decompiler.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-25T07:46:06.213

Windows SDK（以前称为 Platform SDK）附带了一个依赖跟踪工具，它有一个合理的 GUI 用于查看可执行文件和 DLL 的内部。

还有一些命令行工具可用于查看 dll 的内部，尤其是 dumpbin - 查看 Visual Studio 中的 MSDN 帮助以获取更多信息。您可以从 Visual Studio 开始菜单文件夹中的命令提示符运行这些工具。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T07:58:47.447

在 Visual Studio 之外，您可以使用能够检查 DLL 和 EXE 导入和导出的依赖项工具，它与 shell 集成，非常易于使用。它带有一些 Microsoft SDK。如果你想避免仅仅因为这个而下载和安装 SDK 的麻烦，所有 32b/64b 平台的简单下载链接都可以在[http://www.dependencywalker.com/获得](http://www.dependencywalker.com/)

Microsoft 文档（无需下载）可从 Microsoft [Technet获得](http://technet.microsoft.com/en-us/library/cc738370.aspx)

SysInternals Process Explorer 中也提供了类似的功能 - 最适合检查正在运行的进程。

# dns - 如何获取域的所有子域的列表？

> ID：131989
> 
> 赞同：260
> 
> 时间：2008-09-25T07:43:52.317
> 
> 标签：dns, subdomain, dig, nameservers

我想找出给定域的所有子域。我发现了一个提示，它告诉我使用以下选项挖掘权威名称服务器：

```
dig @ns1.foo.bar some_domain.com axfr 
```

但这永远行不通。有没有人有更好的想法/方法

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2008-09-25T07:51:47.977

提示（使用 axfr）仅在您查询的 NS（在您的示例中为 ns1.foo.bar）配置为允许来自您正在使用的 IP 的 AXFR 请求时才有效；这不太可能，除非您的 IP 被配置为相关域的辅助 IP。

基本上，如果您不允许使用 axfr，则没有简单的方法可以做到这一点。这是故意的，因此唯一的解决方法是通过蛮力（即`dig a.some_domain.com`，`dig b.some_domain.com`...），我不建议这样做，因为它可能被视为拒绝服务攻击。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2010-05-19T13:36:33.050

如果您无法从 DNS 获取此信息（例如您未获得授权），那么另一种选择是使用[Wolfram Alpha](http://www.wolframalpha.com/)。

1.  在搜索框中输入域并运行搜索。（例如[`stackexchange.com`](http://www.wolframalpha.com/input/?i=stackexchange.com)）

[![Wolfram - 主页](https://i.stack.imgur.com/8Edyc.png)](https://i.stack.imgur.com/8Edyc.png)

2.  在顶部的第 3 部分（名为“所有 stackexchange.com 的 Web 统计信息”）单击**子域**

[![Wolfram - 子域按钮](https://i.stack.imgur.com/rQJ99.png)](https://i.stack.imgur.com/rQJ99.png)

3.  在子域部分中单击**更多**

[![Wolfram - 更多子域按钮](https://i.stack.imgur.com/0LkNp.png)](https://i.stack.imgur.com/0LkNp.png)

您将能够在那里看到子域列表。虽然我怀疑它没有显示所有子域。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2011-02-18T17:27:13.083

您可以使用：

```
$ host -l domain.com
```

在引擎盖下，这使用了`AXFR`上面提到的查询。不过，您可能不被允许这样做。在这种情况下，您会收到一条`transfer failed`消息。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2010-02-25T21:34:51.237

1.  `dig somedomain.com soa`
2.  `dig @ns.SOA.com somedomain.com axfr`

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-04-14T11:29:51.223

免费的 robotsex 工具可以让您执行此操作，但它们会让您首先输入域的 ip：

1.  找出IP（有一个很好的ff插件可以做到这一点，但我不能发布链接因为这是我在这里的第一篇文章！）
2.  在robotex上进行ip搜索：[http ://www.robtex.com/ip/](http://www.robtex.com/ip/)
3.  在随后的结果页面中单击您感兴趣的域>
4.  您将被带到一个列出所有子域 + 大量其他信息（例如邮件服务器信息）的页面

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-29T04:57:12.160

只有当您连接到域的 DNS 服务器并且为您的 IP 地址启用了 AXFR 时，您才能执行此操作。这是辅助系统用来从主系统加载区域的机制。在过去，这不受限制，但出于安全考虑，大多数主名称服务器都有一个白名单：辅助名称服务器 + 几个特殊系统。

如果您使用的名称服务器允许这样做，那么您可以使用 dig 或 nslookup。

例如：

```
#nslookup

>ls domain.com 
```

注意：因为 dig 和其他新工具不推荐使用 nslookup，所以某些版本的 nslookup 不支持“ls”，尤其是 Mac OS X 的捆绑版本。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-25T07:50:40.727

在 Windows`nslookup`中，命令是

```
ls -d somedomain.com > outfile.txt 
```

它将子域列表存储在 outfile.txt

这些天很少有域允许这样做

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-25T07:46:29.503

如果 DNS 服务器配置正确，您将无法获取整个域。如果由于某种原因允许从任何主机进行区域传输，则您必须向它发送正确的数据包才能发出该请求。我怀疑这就是您包含的 dig 语句的作用。

# svn - 您如何看待 Subversion 中不同系统上的配置文件部署？

> ID：131993
> 
> 赞同：7
> 
> 时间：2008-09-25T07:45:33.420
> 
> 标签：svn, version-control, configuration

Subversion 是在我们的服务器上更新我们的 Web 应用程序的好方法。通过一个简单的`svn update`所有更改的文件得到......好吧，改变了。

除了无处不在的配置文件，例如`config.php`保存数据库访问配置、服务器路径等，因此在我的本地开发系统和远程服务器上是不同的。

使用该`update`命令，服务器上修改的文件不会被覆盖，但如果我在本地更改文件并提交它，服务器会获取错误的配置文件。

但我也不想设置`svn:ignore`属性，因为配置文件属于项目。

是否有一个 Subversion 机制可以让我轻松处理这些文件？还是解决此问题的唯一方法是在配置文件中进行系统切换，这将确定执行系统并相应地设置配置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T07:47:29.203

为文件创建一个模板（例如config.php-default）并让用户复制模板。她还可以进行比较以查看版本之间的更改，以将这些更改合并到文件的本地部署版本中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-25T08:10:33.237

您可能要考虑这样一个事实，即开发人员不会（而且可能不应该）访问生产机器的用户名/密码。

为了解决这个问题，这种配置应该被认为是“部署细节”，而不是整体应用程序配置。即使您做出这种概念上的区别，您仍然需要处理不同的部署环境，但是，由于您似乎正在处理 PHP，因此我无法评论您的案例的具体细节。

正如 Lars 所提到的，一种可能的 J2EE 解决方案是将此类详细信息存储在 JNDI 下，使完全相同的应用程序二进制文件可部署在任何环境中，让 DBA/管理员为每台机器设置用户名/密码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T07:50:58.120

在我目前正在处理的项目中，我们有 2 个用于数据库模式信息的属性文件——一个用于生产环境，一个用于开发。我们有一个类，它为正在执行的模块加载所有属性，并带有确定要加载哪个文件的逻辑。

由于我们本地的开发环境是 Windows 文件系统，而生产服务器在 UNIX 文件系统上运行，我们的解决方案是确定主机的操作系统并加载正确的文件。

我们将这些直接保存在我们的源代码控制中，以便保留所做更改的历史记录。我认为我们从我们的（内部）客户指责中吸取了关于**疯狂频繁的需求**更改的教训，因为我们需要能够保护过去对文件的任何更改。

这对于我们的情况可能是独一无二的，但我发现这非常有帮助，特别是如果我试图从以前的版本复制测试运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-25T07:59:28.740

一些可能的解决方案：

如果您使用的是 J2EE 应用服务器，您可以通过 JNDI 查找属性，有一些工具可以在服务器上轻松设置和查看它们。

你可以在你的 subversion 服务器中有一个默认的属性文件，但是在服务器上的其他地方（在项目中签入 svn 的部分之外）寻找真正的属性文件，但是你通常会得到依赖于操作系统的路径并且必须记住当您在 svn 文件中添加新属性时，手动更新真实属性文件。

您可以在属性文件中设置属性作为构建的一部分，并将参数传递给构建命令以告诉它要构建哪个服务器环境。这可能会让人觉得有点迂回，您必须记住使用新属性更新构建脚本。但它可以很好地工作 - 如果您设置了一个持续集成服务器，它可以为所有不同的环境构建并为您测试捆绑包。然后你知道你已经准备好了一些部署。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-25T07:59:33.497

我发现最简单的方法是打开机器的主机名。我有一个 .ini 文件，其中包含一个通用部分，它也覆盖了生产、测试​​和开发系统的这个部分。

```
[general]
info=misc
db.password=secret
db.host=localhost

[production : general]
info=only on production system
db.password=secret1

[testing : general]
info=only on test system
db.password=secret2

[dev : general]
info=only on dev system
db.password=secret3 
```

所以 dev:db.password == 'secret3'，但是 dev:db.host == 'localhost'，来自原始的 'general' 组。

“production”、“testing”和“dev”可以是机器主机名，或者它们是配置控制脚本中其他机制设置的别名。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T22:44:25.927

您还可以使您的配置文件域依赖。通过这种方式，您可以为本地机器和生产服务器创建配置。当然，您确实需要构建逻辑来处理此问题。

如果您运行 apache webserver，您可以轻松地将其配置为让每个开发人员在其本地机器上使用他们自己的（子）域，而不仅仅是使用 localhost。这样，每个开发人员都可以使用自己的配置。``*******~~***************