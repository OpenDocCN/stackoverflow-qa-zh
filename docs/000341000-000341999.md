# StackOverflow 问答 000341000-000341999

# java - 随着 API 的发展，处理“int enum”模式与 java 枚举共存的最佳方法是什么？

> ID：341005
> 
> 赞同：5
> 
> 时间：2008-12-04T15:35:49.680
> 
> 标签：java, api, enums

假设您正在维护一个最初在几年前发布的 API（在 java 获得`enum`支持之前），它定义了一个枚举值作为整数的类：

```
public class VitaminType {
 public static final int RETINOL = 0;
 public static final int THIAMIN = 1;
 public static final int RIBOFLAVIN = 2;
} 
```

多年来，API 不断发展并获得了 Java 5 特定的特性（通用接口等）。现在你要添加一个新的枚举：

```
public enum NutrientType {
 AMINO_ACID, SATURATED_FAT, UNSATURATED_FAT, CARBOHYDRATE;
} 
```

“旧式” int-enum 模式没有类型安全性，不可能添加行为或数据等，*但它已发布并正在使用中*。我担心对于 API 的用户来说混合两种枚举风格是不一致的。

我看到了三种可能的方法：

*   放弃并将新的枚举（`NutrientType`在我的虚构示例中）定义为一系列整数，如`VitaminType`类。您获得了一致性，但您没有利用类型安全和其他现代功能。

*   决定忍受已发布 API 中的不一致：保持`VitaminType`原样，并添加`NutrientType`为`enum`. 采用 a`VitaminType`的方法仍被声明为采用 int，采用 a 的方法`NutrientType`被声明为采用 int。

*   弃用`VitaminType`该类并引入一个新的`VitaminType2`枚举。将新定义`NutrientType`为枚举。
    恭喜，在接下来的 2-3 年中，直到您可以杀死已弃用的类型，您将处理每个将 a`VitaminType`作为 int 的方法的弃用版本并添加每个方法的新`foo(VitaminType2 v)`版本。您还需要为每个已弃用`foo(int v)`的方法及其相应的`foo(VitaminType2 v)`方法编写测试，因此您只是增加了 QA 工作量。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T17:09:37.663

API 消费者将 VitaminType 与 NutrientType 混淆的可能性有多大？如果不太可能，那么保持 API 设计的一致性可能会更好，特别是如果用户基础已经建立并且您希望最大限度地减少客户所需的工作/学习增量。如果可能发生混淆，那么 NutrientType 应该可能变成一个*enum*。

这不一定是一夜之间的大规模改变；例如，您可以通过枚举公开旧的 int 值：

```
public enum Vitamin {

    RETINOL(0), THIAMIN(1), RIBOFLAVIN(2);

    private final int intValue;

    Vitamin(int n) {
        intValue = n;
    }

    public int getVitaminType() {
        return intValue;
    }

    public static Vitamin asVitamin(int intValue) {
        for (Vitamin vitamin : Vitamin.values()) {
            if (intValue == vitamin.getVitaminType()) {
                return vitamin;
            }
        }
        throw new IllegalArgumentException();
    }

}

/** Use foo.Vitamin instead */
@Deprecated
public class VitaminType {

    public static final int RETINOL = Vitamin.RETINOL.getVitaminType();
    public static final int THIAMIN = Vitamin.THIAMIN.getVitaminType();
    public static final int RIBOFLAVIN = Vitamin.RIBOFLAVIN.getVitaminType();

} 
```

这允许您更新 API 并让您对何时弃用旧类型以及在内部依赖旧类型的任何代码中安排切换进行一些控制。

需要注意保持文字值与那些可能与旧消费者代码内联的值同步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T15:49:44.237

个人观点是，尝试转换可能不值得。一方面，“public static final int”习语不会很快消失，因为它广泛地散布在 JDK 中。另一方面，跟踪原始整数的使用可能真的很不愉快，因为你的类会编译掉引用，所以你可能不知道你已经破坏了任何东西，直到为时已晚（我的意思是

```
class A
   {
       public static final int MY_CONSTANT=1
   }

   class B
   {
           ....
           i+=A.MY_CONSTANT; 
   } 
```

被编译成

```
i+=1 
```

因此，如果您重写 A，您可能永远不会意识到 B 已损坏，直到您稍后重新编译 B。

这是一个非常有名的习语，把它留在里面可能并不那么糟糕，当然比其他的要好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T15:49:40.743

有传言说，“make”的创建者意识到 Makefile 的语法不好，但觉得无法更改，因为他已经有 10 个用户。

不惜一切代价向后兼容，即使它会伤害您的客户，也是一件坏事。所以不能真正给你一个明确的答案，告诉你在你的情况下该怎么做，但一定要考虑长期给你的用户带来的成本。

还要考虑重构代码核心的方法，将旧的基于整数的枚举保留在外层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T16:00:10.770

等待下一次重大修订，将所有内容更改为 enum 并提供脚本（sed、perl、Java、Groovy 等）来转换现有源代码以使用新语法。

显然，这有两个缺点：

*   没有二进制兼容性。这个有多重要取决于用例，但在新的主要版本的情况下是可以接受的
*   用户必须做一些工作。如果工作足够简单，那么这也是可以接受的。

同时，将新类型添加为枚举并将旧类型保留为整数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T15:56:02.680

如果可能的话，最好的办法是修复已发布的版本。在我看来，一致性将是最好的解决方案，因此您需要进行一些重构。我个人不喜欢被弃用的东西，因为它们会碍事。您也许可以等到更大的版本发布并在此之前使用这些整数，然后重构一个大项目中的所有内容。如果那不可能，您可能会认为自己被 int 困住了，除非您创建某种包装器或其他东西。

如果没有任何帮助，但您仍在改进代码，那么您最终会失去一致性或使用已弃用的版本。无论如何，通常至少在某个时候人们会厌倦旧的东西，如果它失去了它的一致性并从头开始创建新的东西......所以无论如何你都会在未来进行重构。

如果出现问题，客户可能会放弃该项目并购买其他产品。通常，您是否负担得起重构不是客户的问题，他们只是购买对他们合适且可用的东西。所以最后这是一个棘手的问题，需要小心。

# .net - FxCop 自定义规则 - 检查 winform 控件属性

> ID：341017
> 
> 赞同：3
> 
> 时间：2008-12-04T15:37:52.297
> 
> 标签：.net, fxcop

我正在寻找一个检查创建的控件属性的 FxCop 规则示例。

有人见过吗？或者知道如何响应 FxCop SDK 中设置的属性？

富有的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T22:27:11.310

这绝对不难。只需过滤从 Control 继承的类型，然后获取字段列表（如果我没记错的话）。

你最好在[http://str8.to/fxcop-forum](http://str8.to/fxcop-forum)上问这个问题——他们非常活跃，我在那里得到了很大的支持。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T17:50:36.130

我的解决方案是遍历为每个被检查成员提供的指令列表。

如果它的类型是 Microsoft.FxCop.SDK.Method，则 _set 的前缀标识了一个属性集。

我唯一的问题是这不允许我识别保留在设计器默认值的属性。

# .net - WinForms - DataGridView - 未选择单元格

> ID：341018
> 
> 赞同：12
> 
> 时间：2008-12-04T15:38:18.130
> 
> 标签：.net, winforms, datagridview

有没有办法让 DataGridView 没有选择单元格？我注意到即使它失去了 focus() 它也至少有一个活动单元格。是否有另一种模式允许这样做？或其他一些技巧？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T15:44:19.553

DataGridView.CurrentCell 属性可用于清除焦点矩形。

> 可以将此属性（DataGridView.CurrentCell）设置为null来临时移除焦点矩形，但是当控件接收到焦点并且该属性的值为null时，它会自动设置为FirstDisplayedCell属性的值。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentcell.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentcell.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T05:18:21.290

我发现`DataGridView.CurrentCell = null`在尝试获取请求的行为时对我不起作用。

我最终使用的是：

```
 private void dgvMyGrid_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
    {
        if (dgvMyGrid.SelectedRows.Count > 0)
        {
            dgvMyGrid.SelectedRows[0].Selected = false;
        }

        dgvMyGrid.SelectionChanged += dgvMyGrid_SelectionChanged;
    } 
```

它需要在`DataBindingComplete`事件处理程序中。

附加`SelectionChanged`事件处理程序的位置不会影响所需的行为，但我将其留在代码片段中，因为我注意到至少出于我的需要，最好仅在数据绑定之后附加处理程序，这样我就可以避免引发选择更改事件对于每个绑定的项目。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-01-27T21:40:55.777

在选择更改事件上将 DataGridView.CurrentCell 设置为 null 的问题是不会命中以后的事件（如单击）。

对我有用的选项是将选择颜色更改为网格颜色。因此选择将不可见。

```
RowsDefaultCellStyle.SelectionBackColor = BackgroundColor;
RowsDefaultCellStyle.SelectionForeColor = ForeColor; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-10T18:50:48.400

我花了几个小时来找到这个问题的解决方案。做这个：

1.  创建表单项目
2.  添加一个名为“DataGridView1”的 DataGridView
3.  将以下代码添加到您的类 Form1

    ```
    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    Dim dgvRow(17) As DataGridViewRow
    Dim i As Integer
    For i = 0 To dgvRow.Length - 1
        dgvRow(i) = New DataGridViewRow()
        dgvRow(i).Height = 16
        dgvRow(i).Selected = False
        dgvRow(i).ReadOnly = True
        DataGridView1.Rows.Add(dgvRow(i))
        DataGridView1.CurrentRow.Selected = False
    Next
    End Sub 
    ```

重要的代码行是

```
 DataGridView1.CurrentRow.Selected = False 
```

祝你好运！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-27T05:56:58.967

我有类似的问题，我按照这种方式：

1.  由 dataGridView.ClearSelection() 清除的“初始活动单元格”。

2.  清除/忽略事件处理程序“CellMouseClick”事件中的选择。

    ```
    void dataGridView_CellMouseClick(object sender, DataGridViewCellMouseEventArgs e)

    {

        DataGridView dgv = sender as DataGridView;

        dgv.ClearSelection();

    } 
    ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-15T03:16:57.987

我知道这是一个老问题，WinForms 已被取代（但在我们的商店里仍然没有很长时间），所以这仍然与我们相关，我也怀疑其他一些问题。

而不是摆弄选择 or `CurrentCell`，我发现实现简单地更改行选择颜色更适合我们的需要。

此外，我不再需要在失去焦点时跟踪旧的选定单元格，也不必处理在没有焦点时刷新网格（如通过计时器）并且在焦点时无法“恢复”旧选定单元格时的棘手问题被退回。

除了上面已经发布的解决方案之外，我们不能（不想）从`DataGridView`控件继承，而是选择使用组合。下面的代码显示了用于实现该功能的类，然后是有关如何使用它将行为“附加”到 DataGridView 的代码。

```
/// <summary>
/// Responsible for hiding the selection of a DataGridView row when the control loses focus.
/// </summary>
public class DataGridViewHideSelection : IDisposable
{
    private readonly DataGridView _dataGridView;

    private Color _alternatingRowSelectionBackColor = Color.Empty;
    private Color _alternatingRowSelectionForeColor = Color.Empty;
    private Color _rowSelectionBackColor = Color.Empty;
    private Color _rowSelectionForeColor = Color.Empty;

    /// <summary>
    /// Initializes a new instance of the <see cref="DataGridViewHideSelection"/> class.
    /// </summary>
    /// <param name="dataGridView">The data grid view.</param>
    public DataGridViewHideSelection( DataGridView dataGridView )
    {
        if ( dataGridView == null )
            throw new ArgumentNullException( "dataGridView" );

        _dataGridView = dataGridView;
        _dataGridView.Enter += DataGridView_Enter;
        _dataGridView.Leave += DataGridView_Leave;
    }

    /// <summary>
    /// Handles the Enter event of the DataGridView control.
    /// </summary>
    /// <param name="sender">The source of the event.</param>
    /// <param name="e">The <see cref="EventArgs"/> instance containing the event data.</param>
    private void DataGridView_Enter( object sender, EventArgs e )
    {
        // Restore original colour
        if ( _rowSelectionBackColor != Color.Empty )
            _dataGridView.RowsDefaultCellStyle.SelectionBackColor = _rowSelectionBackColor;

        if ( _rowSelectionForeColor != Color.Empty )
            _dataGridView.RowsDefaultCellStyle.SelectionForeColor = _rowSelectionForeColor;

        if ( _alternatingRowSelectionBackColor != Color.Empty )
            _dataGridView.AlternatingRowsDefaultCellStyle.SelectionBackColor = _alternatingRowSelectionBackColor;

        if ( _alternatingRowSelectionForeColor != Color.Empty )
            _dataGridView.AlternatingRowsDefaultCellStyle.SelectionForeColor = _alternatingRowSelectionForeColor;
    }

    /// <summary>
    /// Handles the Leave event of the DataGridView control.
    /// </summary>
    /// <param name="sender">The source of the event.</param>
    /// <param name="e">The <see cref="EventArgs"/> instance containing the event data.</param>
    private void DataGridView_Leave( object sender, EventArgs e )
    {
        // Backup original colour
        _rowSelectionBackColor = _dataGridView.RowsDefaultCellStyle.SelectionBackColor;
        _rowSelectionForeColor = _dataGridView.RowsDefaultCellStyle.SelectionForeColor;
        _alternatingRowSelectionBackColor = _dataGridView.RowsDefaultCellStyle.SelectionBackColor;
        _alternatingRowSelectionForeColor = _dataGridView.RowsDefaultCellStyle.SelectionForeColor;

        // Change to "blend" in
        _dataGridView.RowsDefaultCellStyle.SelectionBackColor = _dataGridView.RowsDefaultCellStyle.BackColor;
        _dataGridView.RowsDefaultCellStyle.SelectionForeColor = _dataGridView.RowsDefaultCellStyle.ForeColor;
        _dataGridView.AlternatingRowsDefaultCellStyle.SelectionBackColor = _dataGridView.AlternatingRowsDefaultCellStyle.BackColor;
        _dataGridView.AlternatingRowsDefaultCellStyle.SelectionForeColor = _dataGridView.AlternatingRowsDefaultCellStyle.ForeColor;
    }

    #region IDisposable implementation (for root base class)

    private bool _disposed;

    /// <summary>
    /// Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.
    /// </summary>
    /// <remarks>
    /// Called by consumers.
    /// </remarks>
    public void Dispose()
    {
        Dispose( true );
        GC.SuppressFinalize( this );
    }

    /// <summary>
    /// Disposes this instance, with an indication whether it is called from managed code or the GC's finalization of this instance.
    /// </summary>
    /// <remarks>
    /// Overridden by inheritors.
    /// </remarks>
    /// <param name="disposingFromManagedCode">if set to <c>true</c> disposing from managed code.</param>
    protected virtual void Dispose( Boolean disposingFromManagedCode )
    {
        if ( _disposed )
            return;

        // Clean up managed resources here
        if ( disposingFromManagedCode )
        {
            if ( _dataGridView != null )
            {
                _dataGridView.Enter -= DataGridView_Enter;
                _dataGridView.Leave -= DataGridView_Leave;
            }
        }

        // Clean up any unmanaged resources here

        // Signal disposal has been done.
        _disposed = true;
    }

    /// <summary>
    /// Finalize an instance of the <see cref="DataGridViewHideSelection"/> class.
    /// </summary>
    ~DataGridViewHideSelection()
    {
        Dispose( false );
    }

    #endregion
}

/// <summary>
/// Extends data grid view capabilities with additional extension methods.
/// </summary>
public static class DataGridViewExtensions
{
    /// <summary>
    /// Attaches the hide selection behaviour to the specified DataGridView instance.
    /// </summary>
    /// <param name="dataGridView">The data grid view.</param>
    /// <returns></returns>
    /// <exception cref="System.ArgumentNullException">dataGridView</exception>
    public static DataGridViewHideSelection AttachHideSelectionBehaviour( this DataGridView dataGridView )
    {
        if ( dataGridView == null )
            throw new ArgumentNullException( "dataGridView" );

        return new DataGridViewHideSelection( dataGridView );
    }
} 
```

**用法：** 使用实例化 DataGridViewHideSelection 类的实例并在不再需要功能时将其丢弃。

```
var hideSelection = new DataGridViewHideSelection( myGridView );

// ...

/// When no longer needed
hideSelection.Dispose(); 
```

或者，您可以使用方便的扩展方法`AttachHideSelectionBehaviour()`让生活更轻松。

```
myDataGrid.AttachHideSelectionBehaviour(); 
```

也许这对其他人有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-04-21T10:36:55.923

使用[DataGridView.ClearSelection()](https://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.clearselection(v=vs.110).aspx)来清除焦点/选择（例如 InitializeComponent、[Control.LostFocus](https://msdn.microsoft.com/en-us/library/system.windows.forms.control.lostfocus(v=vs.110).aspx)和[Form.Load](https://msdn.microsoft.com/en-us/library/system.windows.forms.form.load(v=vs.110).aspx)）。

# java - JSP：创建图形

> ID：341019
> 
> 赞同：0
> 
> 时间：2008-12-04T15:38:32.030
> 
> 标签：java, jsp, graphics, charts, graph

按月创建一些用电量的图形表示的最简单方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T15:43:30.007

最好的方法是使用[JFreeChart](http://www.jfree.org/jfreechart/)从您的数据中生成图像，然后在 jsp 中显示图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T15:41:24.113

对我来说，简单的解决方案是在后端输出数值数组并使用[flot](http://code.google.com/p/flot/)（google javascript 库）显示。您需要做的就是生成一系列点（例如 ([1,0], [2,1.1], [3,1.4],[4, ] ... ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T18:21:39.797

您可以使用[Google Chart API](http://code.google.com/apis/chart/)或 Google Chart API Java 包装器。我写了一个：[charts4j](http://charts4j.googlecode.com/)。

# c# - 如何使用 c# 在 URL 中检索 # 之后的值

> ID：341029
> 
> 赞同：2
> 
> 时间：2008-12-04T15:40:35.393
> 
> 标签：c#, asp.net, ajax

我正在尝试实现 ajax 后退/前进按钮支持，因此在我的 url 中的 # 之后编写变量。我还希望用户能够复制 url，然后链接回它。有谁知道我如何解析 url 并获取我的“查询字符串”，即使它们在 # 后面？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-04T15:48:59.527

散列后的值不会传输到服务器。还有另一个关于那个地方的问题，但我很难找到它。同样，我花了一段时间才找到一个像样的引用来引用，但[这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/Fragment_identifier)有一些确认：

> 片段标识符的功能与 URI 的其余部分不同：即，它的处理完全是客户端，没有服务器的参与。当代理（例如 Web 浏览器）向 Web 服务器请求资源时，代理将 URI 发送到服务器，但不发送片段。

我假设您想在服务器端而不是浏览器端响应它？（鉴于您要在 C# 中执行此操作...）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-04T15:43:05.170

[http://msdn.microsoft.com/en-us/library/system.uri.fragment.aspx](http://msdn.microsoft.com/en-us/library/system.uri.fragment.aspx)

# winforms - 来自 Microsoft Report Viewer 2008 的 DefinitionInvalidException

> ID：341036
> 
> 赞同：0
> 
> 时间：2008-12-04T15:42:30.647
> 
> 标签：winforms, .net-2.0, reportviewer

我的应用程序（winforms .net 2.0 / vs2008）在我的开发机器上运行良好，但在其中一台测试机器上我遇到了这个异常。有没有人遇到过类似的事情？

```
************** 异常文本 **************
Microsoft.Reporting.WinForms.LocalProcessingException：本地报表处理过程中出错。---> Microsoft.Reporting.DefinitionInvalidException：报告“主报告”的定义无效。---> Microsoft.ReportingServices.Diagnostics.Utilities.ServerConfigurationErrorException：报告服务器遇到配置错误。有关详细信息，请参阅报表服务器日志文件。
   在 Microsoft.ReportingServices.Diagnostics.DataProtectionLocal.ProtectData（字节 [] 数据，Int32 dwFlags）
   在 Microsoft.ReportingServices.DataExtensions.DataSourceInfo..ctor（字符串 originalName、字符串扩展、字符串 connectionString、布尔 originalConnectStringExpressionBased、布尔集成安全、字符串提示）
   在 Microsoft.ReportingServices.ReportProcessing.ReportPublishing.ReadDataSource（DataSourceNameValidator dataSourceNames，PublishingContext 上下文）
   在 Microsoft.ReportingServices.ReportProcessing.ReportPublishing.ReadDataSources（PublishingContext 上下文）
   在 Microsoft.ReportingServices.ReportProcessing.ReportPublishing.ReadReport()
   在 Microsoft.ReportingServices.ReportProcessing.ReportPublishing.Phase1（CatalogItemContext reportContext、Byte[] 定义、CreateReportChunk createChunkCallback、CheckSharedDataSource checkDataSourceCallback、String& 描述、String& 语言、DataSourceInfoCollection& 数据源、UserLocationFlags& userReferenceLocation、Boolean& hasExternalImages、Boolean& hasHyperlinks）
   在 Microsoft.ReportingServices.ReportProcessing.ReportPublishing.CreateIntermediateFormat(CatalogItemContext reportContext, Byte[] 定义, CreateReportChunk createChunkCallback, CheckSharedDataSource checkDataSourceCallback, PublishingErrorContext errorContext, AppDomain 编译TempAppDomain, Boolean generateExpressionHostWithRefusedPermissions, String& 描述, String& 语言, ParameterInfoCollection&参数, DataSourceInfoCollection& dataSources, UserLocation&Flags& userReference dataSetsName, Boolean& hasExternalImages, Boolean& hasHyperlinks)
   在 Microsoft.ReportingServices.ReportProcessing.ReportProcessing.CompileReport(CatalogItemContext reportContext, Byte[] reportDefinition, CreateReportChunk createChunkCallback, CheckSharedDataSource checkDataSourceCallback, PublishingErrorContext errorContext, AppDomain compilationTempAppDomain, Boolean generateExpressionHostWithRefusedPermissions, String& reportDescription, String& reportLanguage, ParameterInfoCollection& parameters, DataSourceInfoCollection&dataReferenceLocation, UserArrayListInfoCollection&dataSources, UserArrayList dataSetsName, Boolean& hasExternalImages, Boolean& hasHyperlinks)
   在 Microsoft.ReportingServices.ReportProcessing.ReportProcessing.CreateIntermediateFormat（CatalogItemContext reportContext，Byte[] reportDefinition，CreateReportChunk createChunkCallback，CheckSharedDataSource checkDataSourceCallback，AppDomain 编译TempAppDomain，布尔生成ExpressionHostWithRefusedPermissions）
   在 Microsoft.Reporting.ReportCompiler.CompileReport（CatalogItemContext 上下文，Byte[] reportDefinition，布尔生成ExpressionHostWithRefusedPermissions，ReportSnapshotBase& 快照）
   --- 内部异常堆栈跟踪结束 ---
   在 Microsoft.Reporting.ReportCompiler.CompileReport（CatalogItemContext 上下文，Byte[] reportDefinition，布尔生成ExpressionHostWithRefusedPermissions，ReportSnapshotBase& 快照）
   在 Microsoft.Reporting.StandalonePreviewStore.StoredReport.CompileReport()
   在 Microsoft.Reporting.StandalonePreviewStore.StoredReport.get_Snapshot()
   在 Microsoft.Reporting.StandalonePreviewStore.GetCompiledReport（CatalogItemContext 上下文，布尔重建，ReportSnapshotBase& 快照）
   在 Microsoft.Reporting.LocalService.GetCompiledReport（CatalogItemContext itemContext，布尔重建，ReportSnapshotBase& 快照）
   在 Microsoft.Reporting.LocalService.CompileReport（CatalogItemContext itemContext，布尔重建）
   在 Microsoft.Reporting.WinForms.LocalReport.CompileReport()
   --- 内部异常堆栈跟踪结束 ---
   在 Microsoft.Reporting.WinForms.LocalReport.CompileReport()
   在 Microsoft.Reporting.WinForms.LocalReport.SetParameters（IEnumerable`1 参数）
   在 C:\Data\projects\workdir_cpv\Src\Classes\Helpers\Report.cs:line 112 中的 XXX.Helpers.Report.PrintFavs(List`1 list, String header, String filename)

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T15:53:11.563

我曾经有过类似的事情。您可能需要确保测试机器在 GAC 中安装了 ReportViewer dll。Microsoft 创建了一个[安装程序](http://www.microsoft.com/downloads/details.aspx?familyid=CC96C246-61E5-4D9E-BB5F-416D75A1B9EF&displaylang=en)来简化此操作。

问题：您是否在本地模式下使用 Reporting Services，并在 winforms 中使用报表查看器控件？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T15:57:09.697

用于报表和报表查看器的 vs2008 设计器不向后兼容 2.0。同样，您无法使用 vs2008 设计 2005 报告 - 这可能是您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T16:15:14.310

我的安装程序复制所有必需的 dll

Microsoft.ReportViewer.Common.dll

Microsoft.ReportViewer.ProcessingObjectModel.dll

Microsoft.ReportViewer.Winforms.dll

到 ProgramFiles/myAppname 文件夹。

它在 Vista/XP 上完美运行，但问题在于 Win98。我会尝试在 GAC 上安装这些 dll，也许这是个问题。我试图避免在我的安装程序中运行额外的安装程序。

@keithwarren7：

如果这是真的，那真的很愚蠢。您知道.net 2.0 的任何简单且免费的报告引擎吗？

# .net - .NET 中的 CORBA - (dis) 推荐的库？

> ID：341038
> 
> 赞同：22
> 
> 时间：2008-12-04T15:42:37.403
> 
> 标签：.net, corba

我正在开发一个基于 .NET 的服务器组件，该组件使用各种特定于目标的协议与一组目标（具体而言，股权期权交换）进行通信。我们计划添加的下一个目标使用 CORBA，因此我正在研究可以使用 CORBA 的 .NET 库。

到目前为止，我发现了三种可能性：

*   [IIOP.NET](http://iiop-net.sourceforge.net/)是一个开源项目，看起来很成熟并且相当活跃。
*   [J-Integra Espresso](http://j-integra.intrinsyc.com/products/espresso/)是 Intrinsyc 的 Microsoft <-> Java 互操作性工具套件之一。
*   [VisiBroker for .NET](http://www.borland.com/us/products/visibroker/index.html)（以前称为“Janeva”）是 Borland 的 VisiBroker CORBA 包的一个模块。

有没有人有任何这些经验，好的或坏的？

还有其他选择吗？

我可以通过混合的本地托管 C++/CLI 代码使用基于 C++ 的 CORBA 库之一（[omniORB](http://omniorb.sourceforge.net/)和[TAO](http://www.theaceorb.com/)似乎是前两个，但还有其他），但数据需要进出托管核心服务器在某些时候增加了编组的性能成本，并且在混合代码场景中使用本机 C++ 库往往是相当痛苦的。

更新 - 我们已经开始使用 IIOP.NET，到目前为止它看起来还不错。最新版本 (1.9 sp1) 的性能似乎可以接受，并且 API 相当易于使用。我肯定会按照 Todd Stout 的建议研究[IKVM](http://www.ikvm.net/) - 如果 IIOP.NET 没有成功，这看起来是一个非常有趣的可能性。

更新 #2（2010 年 7 月）——我们在生产环境中使用 IIOP.NET 已有一段时间了，效果很好。IIOP.NET 项目并不完全是我所说的活动项目，但 CORBA 也不是，因此似乎不需要更多的开发。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-26T11:39:48.887

IIOP.NET 是一个很好的开源项目，不幸的是该项目于 2007 年停止。该项目没有太多文档，但它可以工作。

我在 CORBA 和 IIOP.NET 中使用 valuetype 效果很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T11:29:14.890

我们使用 Visibroker C++ 并在其周围放置一个 .NET 包装器。维护是一场噩梦！Janeva 的产品可能还不错，但 Borland 现在似乎对它不太感兴趣。

IIOP.Net 可能是您最好的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T16:55:29.883

您可以使用与[IKVM](http://www.ikvm.net/)一起打包的库。IKVM 将大部分 JSE 运行时提供为一组 .Net 程序集（打包为一组是最近的增强功能）。Sun 的 java ORB 实现包含在这组库中。IKVM 通过将 Open JDK 二进制文件编译成 .Net [CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)来实现这一点。您可以引用适当的库并直接从 .Net 代码调用 Java CORBA API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T16:13:05.547

IONA ORBIX 是我唯一有经验的。

它的工作原理与预期的任何 CORBA 代理一样好，但是价格昂贵。

# sharepoint - CAML 中的“不包含”？

> ID：341039
> 
> 赞同：8
> 
> 时间：2008-12-04T15:42:43.783
> 
> 标签：sharepoint, caml, listitem

在[CAML](http://msdn.microsoft.com/en-us/library/ms462365.aspx)中，我可以使用“包含”元素查询 SharePoint Listitems，但没有可以使用的“不包含”元素。

那么获取不包含字符串的项目的最佳方法是什么？有没有比遍历每个项目更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T16:07:02.970

同样的限制适用于 BeginWith。可悲的是，我不知道有什么好的解决方案。你可以做什么：做一个包含查询，遍历每个项目并获取 ID，然后对“ID NotEqual 1 or ID NotEqual 2 or ID NotEqual 3......”进行另一个大查询，因为 ID 被索引为据我所知，这对数据库的影响应该较小，但它仍然闻起来很糟糕。

对于小列表没关系，对于较大的列表，我会使用 SQL Server Profiler 来查看影响是什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-04T20:42:59.843

> 那么获取不包含字符串的项目的最佳方法是什么？

尝试通过创建相反的值来使用计算列来反映您正在查看的值。

例如，假设列名为**IsCritical**。然后，将该列添加为“是/否”，并将公式添加为

```
=ISNUMBER(FIND("Critical"), [Title]) 
```

然后在您的 CAML 查询中

```
<Query>
<Where>
   <Eq>
     <FieldRef Name='IsCritical'/>
     <Value Type='Boolean'>0</Value>
   </Eq>
</Where>
</Query> 
```

此查询中的 0 有点反映“不是关键”。但是，我不确定与不幸不存在的本地 CAML“不包含”相比，性能可能是什么。

另请参阅[MSDN 上的 CAML 查询架构](http://msdn.microsoft.com/en-us/library/ms467521.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T20:28:30.523

'Contains' 和 'BeginsWith' 的这个问题也困扰着我。我希望在下一版本的 Sharepoint 中，caml 将被扩展为真正的工具，而不仅仅是我们腿上的一块石头。

我这样做的方法是尽可能指定查询，然后过滤与 C# 代码中的条件不匹配的行。有时它非常难看，因为您有时必须处理 100 行才能以 1 个匹配条件的结果结束。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T22:14:34.897

@drax：让我们希望 CAML 消失 - 期间。这绝对是当前 SP 编程最糟糕的方面之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-18T15:38:30.017

TRy 不包括

```
<NotIncludes>
<FieldRef Name='FileLeafRef' />
                                            <Value Type='Text'>stringvalue</Value>
                                        </NotIncludes> 
```

# database - 数据库设计 - 是否应将日期用作主键的一部分

> ID：341055
> 
> 赞同：14
> 
> 时间：2008-12-04T15:47:21.713
> 
> 标签：database, oracle, database-design

将日期字段作为主键的一部分有哪些优点/缺点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-04T15:57:33.783

考虑一个零件库存表——如果您想在每天结束时存储库存水平，那么 part_id 和 date_of_day 上的复合主键就可以了。您可能会选择将其设为唯一键并添加合成主键，特别是如果您有一个或多个表使用外键约束引用它，但除此之外，没问题。

所以它没有任何问题，但就像任何其他方法一样，它可能会被错误地使用，就像帕特里克的例子一样。

编辑：这是要添加的另一条评论。

我想起了我不久前写的关于数据库中的日期值是真的是自然的还是合成的。日期的可读表示为“YYYY-MM-DD”当然是自然的，但在 Oracle 内部，它存储为一个数字，仅代表 Oracle 的特定日期/时间。我们可以随时选择和更改该内部值的表示（以不同的可读格式，或完全不同的日历系统），而内部值不会失去其作为*特定*日期和时间的意义。我认为在此基础上，DATE 数据类型介于自然和合成之间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T16:05:58.993

如果您已经决定使用“自然”主键，那么问题是：日期是否是主键的必要部分 - 优点/缺点无关紧要！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-04T15:51:40.100

我可以将它作为密钥的一部分，但要补充一点，您还应该有一个自动递增的序列号作为 PK 的一部分，并强制将任何日期作为 UTC 写入数据库，下游系统比转换为当地时间。

我工作的一个系统决定，每当触及另一个表时，让 Oracle 触发器写入数据库，并使 sysdate 成为没有序列号的主键的一部分，这将是一个伟大的想法。唯一的问题是，如果您运行的更新查询每秒多次访问该行，它会破坏记录更改的表上的主键。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-04T15:54:42.260

关于使用日期作为主键的一部分，我会问一些问题。

日期是否包括时间部分？这使事情变得棘手，因为时间包括时区和夏令时。这不会更改日期/时间值，但可能会在基于查询的排序或检索值方面产生意外结果。

我非常相信使用代理键（即使用序列列作为主键）而不是自然键（如使用日期）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T16:05:24.517

一如既往..这取决于。

您在 PK 中包含日期/时间列的目的是什么？是否提供有关记录的附加信息而不必实际选择行？

我在这里可以预见的主要问题是显而易见的问题，即您使用 UTC 日期还是本地日期？日期是否会被误解（有人会认为它表示当地时间，而它表示 UTC）？正如其他一些人所建议的那样，这可能会更好地用于代理/复合键？在主键以外的键或索引中使用它可能会更好地提高您的性能。

[旁注] 这种让我想起[（1）COMB](http://www.informit.com/articles/article.aspx?p=25862&seqNum=7)（组合 GUID）背后的理论，尽管这里的想法是为 SQL Server 更好地索引/需要更少索引重建的 PK 创建一个唯一 ID，而不是添加任何有意义的日期/时间值到一行。

(1) [ [http://www.informit.com/articles/article.aspx?p=25862&seqNum=7]](http://www.informit.com/articles/article.aspx?p=25862&seqNum=7])

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-04T15:52:32.530

一个小问题是它不像其他标识符那样优雅

（例如对同事说请你看看记录 475663 比说请你看看 2008-12-04 19:34:02 更容易一些）

不同地区的不同日期格式也存在混淆的风险

（例如 2008 年 3 月 4 日 - 欧洲 2008 年 4 月 3 日，美国 2008 年 3 月 4 日）

（我的偏好总是使用单独的键列）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-04T16:18:08.470

日期是非常好的主键，只要它们作为自然键的一部分有意义。我会在表格中使用日期，例如：

*   holiday_dates（hol_date 日期）
*   employee_salary（employee_id 整数，sal_start_date 日期）

（在上面添加代理employee_salary_id 有什么意义？）

对于某些表，可以使用日期，但其他一些东西作为主键更有意义，例如：

*   hotel_room_booking (booking_reference)

我们本可以使用 (room_no, booking_from_date) 或 (room_no, booking_to_date)，但是参考对于与客户等沟通更有用。我们可能会将这些限制为 UNIQUE 约束，但实际上我们需要更复杂的“无重叠”检查对于这些。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T16:02:45.427

日期作为主键的唯一或第一个组件会导致具有高插入量的表出现性能问题。（表需要经常重新平衡）。

如果每个日期插入一个以上，通常会导致问题。

在大多数情况下，我认为这是一种难闻的气味，并建议不要这样做。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-04T16:06:10.537

这没有什么特别的问题，但正如其他海报所指出的那样，您可能会遇到时区和当地人的问题。此外，您最终可能会使用大量 DATE() 函数来混淆您的 SQL。

如果它像前面提到的一天结束时的库存，您也许可以考虑将一个八字符的文本字段（如“20081202”）作为主键的第二部分。这避免了时区区域设置问题，并且如果需要，很容易转换为实际日期。

请记住，主键有两个功能来唯一标识记录和强制唯一性。代理主键也不行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-09-11T09:31:23.000

可能很难参考。我遇到了 _ID + _Date 作为复合 PK。这个复合键也是另一个表中的引用/FK。

首先，这纯粹是令人困惑的，因为有 _ID 表示非复合键。

其次，对主表的插入是使用 SYSDATE 完成的，需要计算出该 SYSDATE 中的精确时间。**当您引用它时，您需要准确地了解其中的时间。**否则将无法正常工作...

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-04T18:44:19.237

使用日期作为主键的一部分可能会使表上的连接显着变慢。如果需要，我更喜欢代理键，然后是日期的唯一索引。

# wcf - wcf 服务到服务通信和数据合同

> ID：341058
> 
> 赞同：1
> 
> 时间：2008-12-04T15:47:49.093
> 
> 标签：wcf, service, datacontract

我最近参与了开发 WCF 服务，它充当一种多播中继（即接受一些传入数据，进行一些处理，然后将其发送到多个其他外部服务）。该服务（我将其称为“我的服务”）由第二个内部服务提供数据。

此数据将从我的服务中作为 XML 保存在字符串中进行中继。因此我的服务可以简单地接受一个字符串作为方法请求的参数——但这并不理想，因为我们失去了类型安全性。

第二个服务有一个类，它封装了我的服务需要处理的所有信息，并最终中继到外部服务。

第二个服务在它的数据契约中公开了这个类。理想情况下，为了保持类型安全，并且不需要对第二个服务的实现进行大量更改，我应该接受这种类型的类作为我的服务操作的参数。

我在数据合同中说我需要这种类型的类而不复制代码的最佳方式是什么？我可以向第二个类添加服务引用，然后使用在我的数据合同中创建的代理类吗？

我只是无法解决这个问题，即使这似乎是一个微不足道的问题！

为任何帮助欢呼！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T16:32:18.597

如果您试图避免类的重复，请将您的类声明放在它自己的程序集中，并在 WCF 服务的所有各方之间共享该 dll。创建服务引用时，您可以选择共享哪些程序集（假设您使用 VS GUI 服务实用程序）。

使用代理类也可能是一个很好的途径。如果您将主要数据类公开为数据合约，然后创建它的代理，该代理将具有可被其他服务使用的公开类的版本。

# multithreading - 哪种方法更好？让线程休眠一段时间或删除它并稍后重新创建它？

> ID：341059
> 
> 赞同：6
> 
> 时间：2008-12-04T15:48:01.603
> 
> 标签：multithreading, sleep

我们有一个需要每两个小时运行一次的流程。这是一个需要在自己的线程上运行的进程，以免中断正常处理。

当它运行时，它将下载 10 万条记录并根据数据库对其进行验证。运行它的框架有很多管理这个过程的对象。这些对象只需要在进程运行时出现。

什么是更好的标准？

1.  通过让它休眠直到我再次需要它来保持线程处于等待模式。或者，

2.  完成后删除它并在下次需要时创建它？（系统定时器事件。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-04T16:06:24.330

两种解决方案之间没有太大区别。我倾向于更喜欢每次都创建线程的那个。

周围有一个线程**会消耗资源**（至少是内存）。在垃圾收集语言中，可能很容易将一些对象保留在该线程中，从而使用更多内存。如果您没有放置线程，则所有资源都将被释放并在两个小时内可供主进程使用。

当您想停止整个进程时，您的线程可能正在执行或未执行，您需要**干净地中断线程**。总是很难中断一个线程或者知道它是在睡觉还是在工作。你可能有一些比赛条件。按需启动线程可以让您摆脱那些潜在的问题：您知道是否启动了线程，在这种情况下调用`thread_join`会让您等待线程完成。

由于这些原因，**我会选择线程按需解决方案**，即使另一个没有不可克服的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T15:56:52.820

每两个小时启动一个线程非常便宜，所以我会这样做。

但是，如果将来某个时间处理可能花费的时间超过运行间隔，您可能希望保持线程处于活动状态。这样，您将不会创建第二个线程来开始处理记录，而第一个线程仍在运行，可能会损坏数据或处理记录两次。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T15:59:41.080

两者都应该没问题，但我倾向于在验证时间超过预期的情况下保留线程（例如：网络链接速度慢或数据库响应速度慢）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-04T16:06:36.183

当两个小时结束时，你怎么记得开始一个新线程？带计时器？（那是在另一个线程上！）另一个线程休眠到指定时间？关闭线程并根据在其他地方运行的东西重新启动它，如果其他东西在它自己的单独线程上，或者在两个小时结束时等待“创建”工作线程时阻塞主应用程序，那么你没有好处， 不？

让线程休眠...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T15:52:41.923

我同意 Vilx 的观点，这主要是一个品味问题。两种方法都有处理和内存开销，但可能还不够重要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T15:58:04.580

如果您使用的是**Java** ，则可以检查**Timer**类。它允许您在给定的时间安排任务。

此外，如果您需要更多控制，您可以使用石英库。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T15:59:47.587

我想实际上让线程进入睡眠状态是最有效的，结束它并重新创建它会“消耗”一些资源，而让它进入睡眠状态只会填充调度器中的一点空间，而如果需要，它的数据可以由操作系统分页.

但无论如何，这可能不是一个很大的差异，差异可能取决于操作系统的调度程序有多好，等等......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T19:15:58.143

据我所知，这实际上取决于一件事……状态。

如果线程创建了很多在线程运行的下一次迭代期间有用的状态（分配内存），那么我会保留它。这样，如果某些事情自上次运行以来发生了变化，您的流程可以通过仅执行某些操作来优化其运行。

但是，如果进程创建的状态与要完成的工作量相比非常重要，并且您的机器上的资源不足，那么在两次执行之间保持状态可能不值得。如果是这样，那么您应该每次都从头开始重新创建线程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-04T15:50:52.707

我认为这只是品味问题。两者都很好。使用你觉得更容易实现的那个。:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T16:03:01.527

我将创建一次线程，并使用事件/条件变量让它休眠，直到有信号再次唤醒。这样，如果需要更改所需的时间量，您只需更改触发事件的时间，您的代码仍然很干净。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-04T19:25:29.667

我认为这不是很重要，但*最好*的方法是非常依赖于平台的。

.NET System.Threading.Timer 在等待时不会产生任何费用，并且会在池线程上调用您的代码。从理论上讲，这将是您的两个建议中最好的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-04T19:44:40.567

如果您在像 Java 这样的垃圾收集系统上要考虑的另一件重要事情是，任何被睡眠线程强引用的东西都不是垃圾。在这方面，最好杀死空闲线程，并让它们以及它们引用的任何对象得到清理。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-04T20:36:12.817

当然，这一切都取决于。但默认情况下，我会根据需要启动一个单独的进程（不是线程）。

# ms-access - 有什么方法可以让 MS Access 2003 为现有设计和数据集生成一组 DDL、DML 和 DCL 文件？

> ID：341067
> 
> 赞同：6
> 
> 时间：2008-12-04T15:49:50.103
> 
> 标签：ms-access

我有一个现有的数据库，其中包含一些测试数据，我有兴趣将其转换为一组 DDL、DML 和 DCL 文件，以便我可以针对其他数据库系统运行它并创建相同的架构等。数据库是 MS Access 2003。

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T15:58:41.303

刚刚发生在这个问题上......它很旧，但为了将来参考，我写了两个cscripts，它们为您提供来自和Access dbase的DDL和DML，粘贴在下面。仅使用过它与 Access 2003 文件，但可能在 Access 2007+ 上也可以正常工作。

此外，我正在用 Ruby编写一个[数据库传输工具，该工具](https://github.com/ericgj/wineskins)*主要*使用 Access mdb 文件作为源，构建在 Sequel 数据库工具包上。

```
```cscript

' ddl.vbs
' Usage:
'  CScript //Nologo ddl.vbs <input mdb file> > <output>
'
' Outputs DDL statements for tables, indexes, and relations from Access file 
' (.mdb, .accdb) <input file> to stdout.  
' Requires Microsoft Access.
'
' NOTE: Adapted from code from "polite person" + Kevin Chambers - see:
' http://www.mombu.com/microsoft/comp-databases-ms-access/t-exporting-jet-table-metadata-as-text-119667.html
'
' (c) 2012 Eric Gjertsen 
'     ericgj72@gmail.com
'
'Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
'
' The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
'
' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
'
Option Explicit
Dim stdout, fso
Dim strFile
Dim appAccess, db, tbl, idx, rel

Set stdout = WScript.StdOut
Set fso = CreateObject("Scripting.FileSystemObject")

' Parse args
If (WScript.Arguments.Count = 0) then
    MsgBox "Usage: cscript //Nologo ddl.vbs access-file", vbExclamation, "Error"
    Wscript.Quit()
End if
strFile = fso.GetAbsolutePathName(WScript.Arguments(0))

' Open mdb file
Set appAccess = CreateObject("Access.Application")
appAccess.OpenCurrentDatabase strFile
Set db = appAccess.DBEngine(0)(0)

' Iterate over tables
  ' create table statements
For Each tbl In db.TableDefs
  If Not isSystemTable(tbl) And Not isHiddenTable(tbl) Then
    stdout.WriteLine getTableDDL(tbl)
    stdout.WriteBlankLines(1)

    ' Iterate over indexes
      ' create index statements
    For Each idx In tbl.Indexes
      stdout.WriteLine getIndexDDL(tbl, idx)
    Next

    stdout.WriteBlankLines(2)
  End If
Next

' Iterate over relations
  ' alter table add constraint statements
For Each rel In db.Relations
  Set tbl = db.TableDefs(rel.Table)
  If Not isSystemTable(tbl) And Not isHiddenTable(tbl) Then
    stdout.WriteLine getRelationDDL(rel)
    stdout.WriteBlankLines(1)
  End If
Next

Function getTableDDL(tdef)
Const dbBoolean = 1
Const dbByte = 2
Const dbCurrency = 5
Const dbDate = 8
Const dbDouble = 7
Const dbInteger = 3
Const dbLong = 4
Const dbDecimal = 20
Const dbFloat = 17
Const dbMemo = 12
Const dbSingle = 6
Const dbText = 10
Const dbGUID = 15
Const dbAutoIncrField = 16

Dim fld
Dim sql
Dim ln, a

    sql = "CREATE TABLE " & QuoteObjectName(tdef.name) & " ("
    ln = vbCrLf

    For Each fld In tdef.fields
       sql = sql & ln & " " & QuoteObjectName(fld.name) & " "
       Select Case fld.Type
       Case dbBoolean   'Boolean
          a = "BIT"
       Case dbByte   'Byte
          a = "BYTE"
       Case dbCurrency  'Currency
          a = "MONEY"
       Case dbDate 'Date / Time
          a = "DATETIME"
       Case dbDouble    'Double
          a = "DOUBLE"
       Case dbInteger   'Integer
          a = "INTEGER"
       Case dbLong  'Long
          'test if counter, doesn't detect random property if set
          If (fld.Attributes And dbAutoIncrField) Then
             a = "COUNTER"
          Else
             a = "LONG"
          End If
       Case dbDecimal    'Decimal
          a = "DECIMAL"
       Case dbFloat      'Float
          a = "FLOAT"
       Case dbMemo 'Memo
          a = "MEMO"
       Case dbSingle    'Single
          a = "SINGLE"
       Case dbText 'Text
          a = "VARCHAR(" & fld.Size & ")"
       Case dbGUID 'Text
          a = "GUID"
       Case Else
          '>>> raise error
          MsgBox "Field " & tdef.name & "." & fld.name & _
                " of type " & fld.Type & " has been ignored!!!"
       End Select

       sql = sql & a

       If fld.Required Then _
          sql = sql & " NOT NULL "
       If Len(fld.DefaultValue) > 0 Then _
          sql = sql & " DEFAULT " & fld.DefaultValue

       ln = ", " & vbCrLf
    Next

    sql = sql & vbCrLf & ");"
    getTableDDL = sql

End Function

Function getIndexDDL(tdef, idx)
Dim sql, ln, myfld

    If Left(idx.name, 1) = "{" Then
       'ignore, GUID-type indexes - bugger them
    ElseIf idx.Foreign Then
       'this index was created by a relation.  recreating the
       'relation will create this for us, so no need to do it here
    Else
       ln = ""
       sql = "CREATE "
       If idx.Unique Then
           sql = sql & "UNIQUE "
       End If
       sql = sql & "INDEX " & QuoteObjectName(idx.name) & " ON " & _
             QuoteObjectName(tdef.name) & "( "
       For Each myfld In idx.fields
          sql = sql & ln & QuoteObjectName(myfld.name)
          ln = ", "
       Next
       sql = sql & " )"
       If idx.Primary Then
          sql = sql & " WITH PRIMARY"
       ElseIf idx.IgnoreNulls Then
          sql = sql & " WITH IGNORE NULL"
       ElseIf idx.Required Then
          sql = sql & " WITH DISALLOW NULL"
       End If
       sql = sql & ";"
    End If
    getIndexDDL = sql

End Function

' Returns the SQL DDL to add a relation between two tables.
' Oddly, DAO will not accept the ON DELETE or ON UPDATE
' clauses, so the resulting sql must be executed through ADO
Function getRelationDDL(myrel)
Const dbRelationUpdateCascade = 256
Const dbRelationDeleteCascade = 4096
Dim mytdef
Dim myfld
Dim sql, ln

    With myrel
       sql = "ALTER TABLE " & QuoteObjectName(.ForeignTable) & _
             " ADD CONSTRAINT " & QuoteObjectName(.name) & " FOREIGN KEY ( "
       ln = ""
       For Each myfld In .fields 'ie fields of the relation
          sql = sql & ln & QuoteObjectName(myfld.ForeignName)
          ln = ","
       Next
       sql = sql & " ) " & "REFERENCES " & _
             QuoteObjectName(.table) & "( "
       ln = ""
       For Each myfld In .fields
          sql = sql & ln & QuoteObjectName(myfld.name)
          ln = ","
       Next
       sql = sql & " )"
       If (myrel.Attributes And dbRelationUpdateCascade) Then _
             sql = sql & " ON UPDATE CASCADE"
       If (myrel.Attributes And dbRelationDeleteCascade) Then _
             sql = sql & " ON DELETE CASCADE"
       sql = sql & ";"
    End With
    getRelationDDL = sql
End Function

Function isSystemTable(tbl)
Dim nAttrib
Const dbSystemObject = -2147483646
    isSystemTable = False
    nAttrib = tbl.Attributes
    isSystemTable = (nAttrib <> 0 And ((nAttrib And dbSystemObject) <> 0))
End Function

Function isHiddenTable(tbl)
Dim nAttrib
Const dbHiddenObject = 1
    isHiddenTable = False
    nAttrib = tbl.Attributes
    isHiddenTable = (nAttrib <> 0 And ((nAttrib And dbHiddenObject) <> 0))
End Function

Function QuoteObjectName(str)
    QuoteObjectName = "[" & str & "]"
End Function

``` 
```

* * *

```
```cscript

' dump.vbs
' Usage:
'  CScript //Nologo dump.vbs access-file [table] > <output>
'
' Outputs INSERT SQL statements for all data in specified table of Access 
' file (.mdb, .accdb) to stdout. If no table specified, then statements are
' generated for all tables in Access file.
'
' Requires Microsoft Access.
'
' (c) 2012 Eric Gjertsen 
'     ericgj72@gmail.com
'
'Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
'
' The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
'
' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
'

Option Explicit
Dim stdout, stderr, fso
Dim strFile, strTbl
Dim appAccess, db, tbl, rst

Set stdout = WScript.StdOut
Set stderr = WScript.StdErr

Set fso = CreateObject("Scripting.FileSystemObject")

' Parse args
If (WScript.Arguments.Count = 0) then
    MsgBox "Usage: cscript //Nologo dump.vbs access-file [table]", vbExclamation, "Error"
    Wscript.Quit()
End if
strFile = fso.GetAbsolutePathName(WScript.Arguments(0))
strTbl  = ""
If WScript.Arguments.Count = 2 Then
  strTbl = WScript.Arguments(1)
End If

' Open mdb file
Set appAccess = CreateObject("Access.Application")
appAccess.OpenCurrentDatabase strFile
Set db = appAccess.DBEngine(0)(0)

' Iterate over tables
  ' dump records as INSERT INTO statements
For Each tbl In db.TableDefs
  If (Len(strTbl)>0 And UCase(tbl.Name) = UCase(strTbl)) Or _
     (Len(strTbl)=0 And Not isSystemTable(tbl) And Not isHiddenTable(tbl)) Then
    Set rst = tbl.OpenRecordset
    If Not rst.EOF And Not rst.BOF Then
      rst.MoveFirst
      stderr.WriteLine "Dumping table " + tbl.Name
      While Not rst.EOF
        stdout.WriteLine getRecSQL(tbl, rst)
        rst.MoveNext
      Wend
      stdout.WriteBlankLines(1)
    End If
    stdout.WriteBlankLines(1)
  End if
Next

Function getRecSQL(tdef, rst)

  Dim fld, sql
  Dim flds, vals, i

  ReDim flds(tdef.Fields.count - 1)
  ReDim vals(tdef.Fields.count - 1)
  i = -1
  For Each fld In tdef.fields
    i = i + 1
    flds(i) = QuoteObjectName(fld.name)
    vals(i) = serializeValue(rst.Fields(fld.name).Value, fld.Type)
  Next

  sql = "INSERT INTO " & QuoteObjectName(tdef.Name) & " (" & Join(flds,",") & ") " & _
        "VALUES (" & Join(vals,",") & ");"

  getRecSQL = sql

End Function

Function serializeValue( val, fldType )
  Const dbBoolean = 1
  Const dbByte = 2
  Const dbCurrency = 5
  Const dbDate = 8
  Const dbDouble = 7
  Const dbInteger = 3
  Const dbLong = 4
  Const dbDecimal = 20
  Const dbFloat = 17
  Const dbMemo = 12
  Const dbSingle = 6
  Const dbText = 10
  Const dbGUID = 15
  Const dbAutoIncrField = 16

  Dim a, ln
  ln = Chr(13) + Chr(10)

  If IsNull(val) Then 
    a = "Null"
  Else
    Select Case fldType
    Case dbBoolean, dbByte, dbCurrency, dbDouble, dbInteger, dbLong, dbDecimal, dbFloat, dbSingle, dbGUID
      a = CStr(val)
    Case dbDate
      a = "#" & CStr(val) & "#"
    Case dbMemo, dbText
      a = Chr(34) + Replace(Replace(val, Chr(34), Chr(34) + Chr(34)), ln, " ") + Chr(34) 
    Case Else
      '>>> raise error
      a = "Null"
    End Select
  End If

  serializeValue = a

End Function

Function isSystemTable(tbl)
Dim nAttrib
Const dbSystemObject = -2147483646
    isSystemTable = False
    nAttrib = tbl.Attributes
    isSystemTable = (nAttrib <> 0 And ((nAttrib And dbSystemObject) <> 0))
End Function

Function isHiddenTable(tbl)
Dim nAttrib
Const dbHiddenObject = 1
    isHiddenTable = False
    nAttrib = tbl.Attributes
    isHiddenTable = (nAttrib <> 0 And ((nAttrib And dbHiddenObject) <> 0))
End Function

Function QuoteObjectName(str)
    QuoteObjectName = "[" & str & "]"
End Function
``` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T16:13:31.053

1.  如果您的目标数据库是 MS SQL Server，您可以使用升迁向导来移植访问数据库。您可以安装和使用 MS SQL Server Express Edition 并从那里提取 DDL。

2.  MS Visio 2003 Enterprise 有一个数据库逆向工程工具，可以从 Access 数据库中导入对象，然后导出 SQL。（这曾经是 Visio 2000 中的标准，如果您能掌握的话）。

# sql - 仅具有内置函数的 urlencode

> ID：341074
> 
> 赞同：4
> 
> 时间：2008-12-04T15:51:34.717
> 
> 标签：sql, postgresql, urlencode

在不使用 plpgsql 的情况下，我试图在 pgsql SELECT 语句中对给定文本进行 urlencode。

这种方法的问题：

```
select regexp_replace('héllo there','([^A-Za-z0-9])','%' || encode(E'\\1','hex'),'g') 
```

...是编码函数没有传递正则表达式参数，除非有另一种方法可以从实际有效的替换表达式中调用函数。所以我想知道是否有一个替换表达式本身可以将匹配项编码为十六进制值。

可能还有其他功能组合。我认为那里会有一个聪明的正则表达式（这可能仍然是答案），但我很难找到它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T16:38:30.567

```
select regexp_replace(encode('héllo there','hex'),'(..)',E'%\\1','g'); 
```

但是，这不会使字母数字字符易于阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-09T19:08:11.960

这是我编写的一个函数，它使用内置函数处理编码，同时保留 URL 的可读性。

正则表达式匹配以捕获（可选）安全字符和（最多一个）非安全字符对。嵌套选择允许对这些对进行编码和重新组合，返回一个完全编码的字符串。

我已经运行了一个具有各种排列的测试套件（前导/尾随/仅/重复的编码字符，到目前为止它似乎编码正确。

安全的特殊字符是 _ ~ 。- 和 /。我在该列表中包含“/”可能是非标准的，但适合我的用例，其中输入文本可能是路径并且我希望保留它。

```
CREATE OR REPLACE FUNCTION oseberg.encode_uri(input text)
  RETURNS text
  LANGUAGE plpgsql
  IMMUTABLE STRICT
AS $function$
DECLARE
  parsed text;
  safePattern text;
BEGIN
  safePattern = 'a-zA-Z0-9_~/\-\.';
  IF input ~ ('[^' || safePattern || ']') THEN
    SELECT STRING_AGG(fragment, '')
    INTO parsed
    FROM (
      SELECT prefix || encoded AS fragment
      FROM (
        SELECT COALESCE(match[1], '') AS prefix,
               COALESCE('%' || encode(match[2]::bytea, 'hex'), '') AS encoded
        FROM (
          SELECT regexp_matches(
            input,
            '([' || safePattern || ']*)([^' || safePattern || '])?',
            'g') AS match
        ) matches
      ) parsed
    ) fragments;
    RETURN parsed;
  ELSE
    RETURN input;
  END IF;
END;
$function$ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-19T02:29:27.733

这是相当短的版本，它甚至是“纯 SQL”函数，而不是 plpgsql。支持多字节字符（包括 3 和 4 字节表情符号）。

```
create or replace function urlencode(in_str text, OUT _result text) returns text as $$
  select
    string_agg(
      case
        when ol>1 or ch !~ '[0-9a-za-z:/@._?#-]+' 
          then regexp_replace(upper(substring(ch::bytea::text, 3)), '(..)', E'%\\1', 'g')
        else ch
      end,
      ''
    )
  from (
    select ch, octet_length(ch) as ol
    from regexp_split_to_table($1, '') as ch
  ) as s;
$$ language sql immutable strict; 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-12-08T13:29:16.327

您可以使用 CLR 并导入命名空间或使用此链接中显示的函数，这将创建一个执行编码的 T-SQL 函数。

[http://www.sqljunkies.com/WebLog/peter_debetta/archive/2007/03/09/28987.aspx](http://www.sqljunkies.com/WebLog/peter_debetta/archive/2007/03/09/28987.aspx)

# c# - ASP.NET DropDownList AutoPostback 不起作用 - 我错过了什么？

> ID：341080
> 
> 赞同：3
> 
> 时间：2008-12-04T15:52:10.770
> 
> 标签：c#, asp.net, updatepanel, autopostback

当所选项目发生更改时，我试图通过 UpdatePanel 将 DropDownList 获取到 AutoPostBack。对于为什么这不起作用，我会有点疯狂。

有没有人有任何快速的想法？

ASPX 页面：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Always" ChildrenAsTriggers="true" >      
  <ContentTemplate>
    <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True"  onselectedindexchanged="DropDownList1_SelectedIndexChanged">
      <asp:ListItem>item 1</asp:ListItem>
      <asp:ListItem>item 2</asp:ListItem>
    </asp:DropDownList>
  </ContentTemplate>
</asp:UpdatePanel> 
```

代码隐藏（我在字符串赋值上放了一个断点来捕获回发）：

```
protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
  string s = "";
} 
```

**编辑：**

**好的，我现在可以正常工作了。很奇怪。只需重新启动 Visual Studio。这是让我作为开发人员感到害怕的事情；）我想我以前见过类似的情况，VS 在它运行的程序集中“不同步”。**

**仅供参考，我正在运行 VS 2008 Web Developer Express。**

**感谢那些回答。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T16:09:06.600

我能够让它与您发布的内容一起使用。这是我使用的代码......基本上是你所拥有的，但我抛出了一个异常。

```
 <asp:ScriptManager ID="smMain" runat="server" />

    <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Always" ChildrenAsTriggers="true" >      
      <ContentTemplate>
        <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True"  onselectedindexchanged="DropDownList1_SelectedIndexChanged">
          <asp:ListItem>item 1</asp:ListItem>
          <asp:ListItem>item 2</asp:ListItem>
        </asp:DropDownList>
      </ContentTemplate>
    </asp:UpdatePanel>

    protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
    {
        throw new NotImplementedException();
    } 
```

我尝试了很多变化来查看是否有问题，但每次都抛出异常。

您可能想尝试异常路由以查看回发是否正在发生，这不是调试器问题。

*   一个问题可能是 Vista 并且没有以管理员身份运行 Visual Studios。我知道这倾向于不允许调试。

*   也许您正在运行的程序集与代码不匹配？如果您“在浏览器中查看”然后附加调试器，则可能会发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-30T21:50:17.823

UpdatePanel 中的 EnableViewState="true" 肯定会解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T07:25:03.860

我也有同样的问题，奇怪的是我的更新面板在 FireFox 中触发 OnTextChanged 但在 IE 上死了。Restartin VS 2005 解决了这个问题。:O

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-07-17T00:27:31.987

而不是使用 AutoPostBack="true" 将 DropList 设置为更新面板中的触发器。

# mysql - MySQL子选择性能问题？

> ID：341086
> 
> 赞同：0
> 
> 时间：2008-12-04T15:54:39.953
> 
> 标签：mysql, optimization, subquery

我需要有关 MySQL 中子选择性能的建议。由于无法更改的原因，我无法使用 JOIN 创建查询过滤器，我只能在 WHERE 中添加另一个 AND 子句。

什么是性能：

```
select tasks.*
from tasks
where 
  some criteria
  and task.project_id not in (select id from project where project.is_template = 1); 
```

相比：

```
select tasks.*
from tasks, project
where
  some criteria
  and task.project_id = project.id and project.is_template <> 1; 
```

请注意，is_template = 1 的项目数量相对较少，而 is_template <> 1 的项目数量可能很多。

如果我除了过滤之外什么都不能改变，还有其他方法可以在没有子选择的情况下获得相同的结果吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T16:03:13.790

我相信第二种更有效，因为它只需要一次选择，但可以肯定的是，您应该解释每个查询并检查结果。

```
EXPLAIN select tasks.*
from tasks
where 
  some criteria
  and task.project_id not in (select id from project where project.is_template = 1);

EXPLAIN select tasks.*
from tasks, project
where
  some criteria
  and task.project_id = project.id and project.is_template <> 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T16:14:49.723

两者之间有多少差异可能在很大程度上取决于“某些标准”是什么以及它提供的使用索引的机会。但请注意，如果有没有项目的任务，它们在结果方面是不等价的。第二个等价于：

```
select tasks.*
from tasks
where 
  some criteria
  and task.project_id in (select id from project where project.is_template <> 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T16:18:59.873

我认为第一个可能会更好地扩展：

当您进行连接时，mysql 在内部会创建一种临时表，其中包含根据指定的连接条件连接的两个表。您没有给出连接条件，因此它将创建一个临时表，其中列出了针对所有项目的所有任务。我相当确定（但请使用解释工具检查）它在应用任何 where 子句之前会执行此操作。

结果：如果每个有 10 行，它将有 10 * 10 行 = 100。您可以看到随着数字的增加，它会变得越来越大。然后它将 where 应用到这个临时表。

相比之下，子查询仅从每个表中选择相关行。

但除非缩放是一个问题，否则我认为这并不重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T16:19:15.643

避免像 MySQL 版本 < 6.0 中的瘟疫之类的子查询，考虑到它仍处于开发的 alpha 阶段，我怀疑你正在使用 6.0。AFAIK，MySQL 优化器根本不能很好地处理子查询。一些主要的工作已经用于改进 6.0 的优化器，并且子查询现在工作得更好，但这些变化并没有渗透到 5.0 或 5.1 系列中。

# c# - C# 到 VB.Net：为什么转换为 VB 时编译失败？

> ID：341103
> 
> 赞同：7
> 
> 时间：2008-12-04T15:59:36.870
> 
> 标签：c#, vb.net, visual-studio-2008, generics, .net-3.5

我有这个 C# 扩展方法，它将扩展任何*Value*类型为*IList*的字典。当我在 VB.Net 中编写等效代码时，出现以下编译错误：

> *“扩展方法 'Add' 有一些永远无法满足的类型约束”。*

我发现这真的很令人费解，因为在 C# 中可以满足**相同****的**类型约束。

 **所以我的问题是：为什么这在 VB 中不起作用？有没有办法让这些相同的类型约束在 VB 中起作用？我是不是在转换代码时出错了？我希望有人可以对此有所了解，因为我已经在这个问题上摸索了一段时间。:)

*（如果您好奇，扩展方法旨在简化在**单个**键下将多个值添加到字典中（例如一个客户下的多个订单）。但这并不重要，我只关心我的令人费解的行为在 VB 中观察）。*

**这是有效的 C# 版本：**

```
/// <summary>
/// Adds the specified value to the multi value dictionary.
/// </summary>
/// <param name="key">The key of the element to add.</param>
/// <param name="value">The value of the element to add. The value can be null for reference types.</param>
public static void Add<KeyType, ListType, ValueType>(this Dictionary<KeyType, ListType> thisDictionary, 
                                                     KeyType key, ValueType value)
where ListType : IList<ValueType>, new()
{
    //if the dictionary doesn't contain the key, make a new list under the key
    if (!thisDictionary.ContainsKey(key))
    {
        thisDictionary.Add(key, new ListType());
    }

    //add the value to the list at the key index
    thisDictionary[key].Add(value);
} 
```

**这是不编译的VB版本：**

```
''' <summary> 
''' Adds the specified value to the multi value dictionary. 
''' </summary> 
''' <param name="key">The key of the element to add.</param> 
''' <param name="value">The value of the element to add. The value can be null for reference types.</param> 
<System.Runtime.CompilerServices.Extension()> _
Public Sub Add(Of KeyType, ListType As {IList(Of ValueType), New}, ValueType) _
              (ByVal thisDictionary As Dictionary(Of KeyType, ListType), ByVal key As KeyType, ByVal value As ValueType)
    'if the dictionary doesn't contain the key, make a new list under the key 
    If Not thisDictionary.ContainsKey(key) Then
        thisDictionary.Add(key, New ListType())
    End If

    'add the value to the list at the key index 
    thisDictionary(key).Add(value)
End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T18:07:23.133

问题仅在`<System.Runtime.CompilerServices.Extension()>`存在时发生。VB 编译器强加了一个限制，即约束必须可以单独使用第一个参数进行验证。由于扩展方法 ( ) 的第一个参数通过约束`Dictionary(Of KeyType, ListType)`依赖于第三个参数 ( ) ，因此无法在 VB 中编译。`ValueType``IList(Of TValue)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T16:24:28.130

原因在这里解释：http: [//msdn.microsoft.com/en-us/library/bb385206.aspx](http://msdn.microsoft.com/en-us/library/bb385206.aspx)

在这种情况下，VB 编译器可能会更挑剔一些，因为它必须支持可选参数。C# 中没有可选参数（目前）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-23T11:50:46.447

请注意，略有不同是有效的：

```
''' <summary> 
''' Adds the specified value to the multi value dictionary. 
''' </summary> 
''' <param name="key">The key of the element to add.</param> 
''' <param name="value">The value of the element to add. The value can be null for reference types.</param> 
<System.Runtime.CompilerServices.Extension()> _
Public Sub Add(Of KeyType, ListType As {New, IList(Of ValueType)}, ValueType) _
              (ByVal thisDictionary As Dictionary(Of KeyType, IList(Of ValueType)), ByVal key As KeyType, ByVal value As ValueType)
    'if the dictionary doesn't contain the key, make a new list under the key 
    If Not thisDictionary.ContainsKey(key) Then
        thisDictionary.Add(key, New ListType())
    End If

    'add the value to the list at the key index 
    thisDictionary(key).Add(value)
End Sub 
```

您可以拥有`Dictionary`包含`ListType`列表，但必须将其声明为`(Of ..., IList(Of ...))`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T16:21:02.257

我怀疑问题在于您使用 ValueType 作为类型参数之一的名称，这是 .NET 类库 (System.ValueType) 中的实际类型。我可以想象 C# 和 VB.NET 以不同的方式处理这个问题。尝试使用不同的名称，例如 TValue （和 TKey 只是为了保持一致）。

# asp.net-mvc - HttpContext.Cache 与反射：哪个更有效？

> ID：341109
> 
> 赞同：0
> 
> 时间：2008-12-04T16:00:04.793
> 
> 标签：asp.net-mvc

我正在使用反射从控制器和方法中获取授权属性。

因为我需要一遍又一遍地获取这些信息，所以我想知道缓存它是否更快，或者只是继续使用反射来获取它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T22:38:43.450

这个答案来的有点晚，但我最近在一个项目中也有同样的想法，最后使用以下扩展方法 [GetOrCreate](http://www.signumframework.com/DictionaryExtensions.ashx#_GetOrCreate__1)进行缓存，如果你这样做，记得锁定字典。

相反，您可以使用无[锁策略使用](http://www.signumframework.com/Sync.ashx)[ImmutableAVLTree](http://www.signumframework.com/DataStructures-Immutable.ashx)

[最后，这里](http://www.signumframework.com/Reflection.ashx)有一些有用的实用程序可以使用反射

它是一个完整框架的一部分，但如果这是您唯一需要的部分，您可以[复制这段代码。](http://signum.codeplex.com/SourceControl/ListDownloadableCommits.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T17:06:17.530

一般来说，不建议在达到速度时使用反射，但您必须考虑开发真正有效的缓存的时间（线程安全，非常快，它为您提供当前值而不是旧的不一致值）并调试它。

很难判断哪种架构会提供最佳性能，但您可以轻松编写一个小测试，用一小组简单案例对两种不同的场景进行计时。您可能会发现速度完全一样，或者明显不同。无论哪种方式，你都有你的答案。

# javascript - 通过 Excel VBA 调用 javascript 文件 (.js)？

> ID：341112
> 
> 赞同：2
> 
> 时间：2008-12-04T16:00:48.800
> 
> 标签：javascript, vba, excel

如何通过 Excel VBA 调用 javascript 文件 (.js)？

* * *

因此，由于我反对同样的问题，我会尝试向你们提交我的情况。

我正在尝试使用 excel vba 宏从法雷奥的目录中自动提取数据。

我有一份附在法雷奥汽车产品上的参考清单（巨大的清单，超过 300 万件）。我想直接从似乎在 javascript 下运行的目录中导入信息。

我需要的数据是附加到参考的每辆车的列表。

这是网址： http://outcat-cs.tecdoc.net/ows/en/7FA2A0C501BC34CA4BECB04095663CF1.ows_cs2.srv?view= [VIndexFramesetJsp](http://outcat-cs.tecdoc.net/ows/en/7FA2A0C501BC34CA4BECB04095663CF1.ows_cs2.srv?view=VIndexFramesetJsp)

我想访问“直接文章搜索”选项卡，以便直接从 excel 选项卡的单元格复制参考，然后在参考上模拟 clic 以显示“链接车辆部分”，然后复制它们在新的 Excel 工作表中。

我已经使用以下代码成功地使用 html 纯编程网页（oscaro.com）做到了这一点：

```
Set maPageHtml = IE.document
Set Helem = maPageHtml.getElementsByTagName("input")

For i = 0 To Helem.Length - 1 
    If Helem(i).getAttribute("name") = "toFind" Then Helem(i).Value = "819971" '819971 is the valeo reference searched
    If Helem(i).getAttribute("name") = "submit" Then Set Monbouton = Helem(i)
Next

Monbouton.Click 'this does the click on my button Monbouton 
```

但是这种技术不能与 valeo 网站一起使用，因为我无法（或者至少我还不知道如何去做）在使用 javascript 制作页面时选择/单击按钮，因为它没有有按钮的名称、值或 ID。

此外，在单击“直接文章搜索”按钮之前和单击...之后，地址字段中的 url 似乎是相同的。

希望我很清楚，尽管我的英语...

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T20:41:14.457

之前建议的所有方法对我来说听起来都很老套。

[要获得更可靠的解决方案，请通过Windows Script Components](http://msdn.microsoft.com/en-us/library/07zhfkh8(VS.85).aspx)将 Javascript 嵌入到 COM组件中，并像调用任何其他 COM 组件一样调用基于 Javascript 的 COM 组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T16:12:48.713

我认为没有直接的方法可以在 VBA 中运行 JavaScript 代码。

您可以尝试做的是将 JavaScript 代码嵌入 HTML 表单中，您可以在（隐藏的）浏览器控件中打开该表单。然后通过浏览器控件的 DOM 填充表单控件并提交表单。提交会触发您要调用的 JavaScript 函数。

样品（未测试）：

VBA：

```
oIE.Document.frmMain.param1.Value = 5
oIE.Document.frmMain.param2.Value = "6"
oIE.Document.frmMain.submit.click ' this line will call the JavaScript function 
```

HTML：

```
<div id="submit" > <a href="javascript:doAction();">Do Action</a></div>

<script>
function doAction()
{
    // do whatever the code should do
}
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T16:25:19.580

你的意思是通过windows脚本主机？您可以使用 .js 文件的名称对 wscript.exe 进行 shell（使用 shell 命令）。但是这个 javascript 对象模型不会像你在浏览器中得到的那样。如果您告诉我们 javascript 应该做什么，那将会很有帮助。

# ruby-on-rails - Rails 应用程序中的非持久数据

> ID：341116
> 
> 赞同：3
> 
> 时间：2008-12-04T16:02:01.123
> 
> 标签：ruby-on-rails, architecture, model

我正在为 Rails 应用程序创建“分析”页面。分析页面不保留它自己的任何数据（此时它非常原始），但确实利用了我从数据库中获取的指标（通过 ActiveRecord 中内置的聚合表达式）。除了收集和呈现指标之外，我唯一的其他要求是允许用户提供一个日期范围来过滤数据。到目前为止，我一直在使用实例变量等来存储指标信息......随着指标数量的增长以及管理开始和结束过滤日期的需要，我开始认为我应该将这些数据放入它的自己的模型。如果我确实移动了我所有的“数据” 进入模型我应该只使用带有 attr_accessors 的普通对象还是有更合适的基类可以用于非持久数据？我对 MVC 架构足够熟悉，知道我的控制器越来越臃肿，但对 rails 不够熟悉，无法确定在这种情况下我应该如何组织我的数据/逻辑。

任何见解将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T16:12:23.070

听起来您可以使用 Rails 非活动记录模型。有一个很好的 Railscast ：

[http://railscasts.com/episodes/121-non-active-record-model](http://railscasts.com/episodes/121-non-active-record-model)

希望有帮助，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T16:16:18.100

你在正确的轨道上。许多应用程序在应用程序/模型中都有不从 ActiveRecord::Base 继承的类。每当您发现自己在控制器操作中管理大量任意变量时，最好考虑将这些数据抽象为非持久模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T21:59:25.567

这是一个目前没有很好记录的领域，可能是因为 ActiveRecord 的东西更性感？

我经历了同样的过程，发现我的控制器动作变得令人不安，并且充满了逻辑，因为我努力从基于 ActiveRecord 的模型中构建派生数据，而这些模型又开始获得他们并不真正想要或不需要的额外责任.

一旦我得到[与你现在得到的相同的建议](https://stackoverflow.com/questions/26834/how-to-represent-cross-model-information-in-mvc)，整个事情就变得非常简单。

# c++ - 在消息的通知区域中显示 Outlook 图标，而不是在收件箱中

> ID：341117
> 
> 赞同：0
> 
> 时间：2008-12-04T16:02:01.717
> 
> 标签：c++, vba, scripting, outlook

我设置了将一些电子邮件移动到不同文件夹的规则。我希望这仍然在通知区域中显示信封，但规则向导中没有执行此操作的选项。看起来我要么必须让规则“运行脚本”或“执行自定义操作”，要么分别允许 vba 或 c/c++。

其他人有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T20:02:26.520

查看[MailAlert](http://www.bettasoft.net/)，一个完全可以做到这一点的 Outlook 插件。它在 Outlook 2007 中仍然有效（尽管我最近再次安装它后出现了一些不稳定因素，这可能相关也可能不相关）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-26T20:26:38.723

刚刚发布的新版[邮件提醒](http://www.bettasoft.net/mailalert)，将允许您控制通知图标以及弹出提醒和声音提醒。以下是 2.0 中的一些新功能：

*   声音警报 - 为收到的电子邮件播放声音
*   通知区域警报 - 显示通知区域（系统托盘）图标
*   程序警报 - 运行一个程序并可以将来自传入电子邮件的信息传递给该程序
*   静音功能 - 快速抑制所有警报
*   微软 Outlook 2007 支持
*   多显示器支持
*   Unicode Exchange 服务器支持
*   以及更多桌面警报功能：
    *   Aero Glass 样式的警报窗口（在 Windows Vista 上）
    *   能够轻松关闭警报窗口
    *   能够直接从警报窗口的按钮快速打开、回复 [全部] 或转发消息
    *   能够将消息转换为任务、标记消息以进行跟进或将消息移动到另一个文件夹；全部直接来自警报窗口的上下文菜单
    *   能够将警报的默认位置设置为您想要的任何位置
    *   在显示邮件正文预览之前需要单击的隐私选项

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-18T10:12:20.283

您也可以*不*使用规则来实现它，*而是*在代码中执行类似规则的操作。例如：

```
Private Sub Application_NewMailEx(ByVal EntryIDCollection As String)

   Dim mai As Object
   Dim strEntryId

    For Each strEntryId In Split(EntryIDCollection, ",")
        Set mai = Application.Session.GetItemFromID(strEntryId)
        If mai.Parent = "Inbox" Then
            If mai.SenderEmailAddress = "the-email-address-the-rule-applies-to" Then
                mai.Move Application.GetNamespace("MAPI").GetFolderFromID("the-entry-ID-of-the-folder-you-want-to-move-the-message-to")
            End If
        End If
        Set mai = Nothing
    Next
End Sub 
```

如何获取**文件夹ID**（即文件夹的entryID）：

这只是一种手动方式，您可以进行递归过程，但出于简单目的，这很好。例如，我的结构如下：

```
Mailbox - My_Name_Here

     Inbox

          The Subfolder I'm Looking For

     Sent Items

     ... 
```

所以在立即窗口中我输入：

```
? Application.GetNamespace("MAPI").Folders(1) 
```

并增加数量，直到我得到“邮箱 - My_Name_Here”

然后，我输入：

```
? Application.GetNamespace("MAPI").Folders(the_number_of_my_mailbox).Folders(1) 
```

增加数量，直到我得到“收件箱”。

然后：

```
? Application.GetNamespace("MAPI").Folders(the_number_of_my_mailbox).Folders(the_number_of_my_Inbox).Folders(1) 
```

增加数字直到我得到“我正在寻找的子文件夹”

然后：

```
? Application.GetNamespace("MAPI").Folders(the_number_of_my_mailbox).Folders(the_number_of_my_Inbox).Folders(the_number_of_the_subfolder_i_was_looking_for).EntryID 
```

就是这样：我想将消息移动到的文件夹的 entryID。你明白了，我敢肯定:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-20T14:38:19.080

在规则向导的第 1 步中有一个选项“显示桌面警报”。它成功了。此向导可以在编辑具体规则时运行。

# c# - 如何在 C# 注释中引用类的索引器成员

> ID：341118
> 
> 赞同：12
> 
> 时间：2008-12-04T16:02:41.747
> 
> 标签：c#, documentation

为了在 XML 注释/文档中引用类的成员，您必须使用以下标记：

```
<see cref="member"/> 
```

最好[在这里](http://msdn.microsoft.com/en-us/library/acd0tfbe.aspx)解释一下。

**您如何引用*索引器*？**

我的意思是，像这样的成员：

```
internal object this[ int index ] {
    ...
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T16:09:16.757

```
<see cref="P:System.Collections.ArrayList.Item(System.Int32)" /> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T16:38:59.880

```
<see cref="this[int]" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-26T12:09:55.700

我有同样的问题，但有一个**通用**的Dictionary.Item(TKey) 属性。[leppie](https://stackoverflow.com/a/341149/4973073)的回答

> `<see cref="P:System.Collections.ArrayList.Item(System.Int32)" />`

以及[ICR 的附加链接](https://stackoverflow.com/questions/341118/how-to-reference-an-indexer-member-of-a-class-in-c-sharp-comments#comment178872_341149)（不幸的是我找不到“mscorlib.xml”）

> [MSDN：处理 XML 文件（C# 编程指南）](http://msdn.microsoft.com/en-us/library/fsbx0t7x.aspx)

帮了我。

但是[user492238的答案](https://stackoverflow.com/a/6234624/4973073)
（我知道，我应该直接评论他的答案。但由于我是新手，这是我的第一篇文章，请放轻松，因为我的声誉低，不允许发表评论。）

> `<seealso cref="M:My.Namespace.Class1.Get{T}(System.String)"/>`
> `<seealso cref="M:My.Namespace.Class1.Get&lt;T>(System.String)"/>`

只产生纯黑色文本，因此只有秒显示标签符号 <> 作为给定的“硬编码”。

我在 MSDN 页面上找到了将反引号 (`) 用于泛型的解决方案，并在我的 XMLDoc 中获得了对类和属性的完整（“彩色”）引用：

```
 <see cref="P:System.Collections.Generic.Dictionary`2.Item(`0)" /> 
```

```
Dictionary<TKey, TValue>.this[TKey] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-08T09:34:22.103

```
<see cref="ReadOnlyCollection{T}.this[int]" /> 
```

正如[这里](https://stackoverflow.com/a/9792164/806690)建议的那样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-04T04:08:27.737

通常，为了了解如何在您的注释中引用任何成员，请在您的 XML 文档文件中为程序集找到该成员。它是在每次构建时创建的。除了泛型之外，成员引用可以从这里获取：

```
</member>
<member name="P:My.Namespace.Class1.Item(System.String)">
    <summary>
       retrieve a single item of the given name from this instance
    </summary>
    <param name="name">name of the item</param>
    <returns>the item</returns>
</member>
<member name="M:My.Namespace.Class1.Function1(System.Int32[])">
    <summary> 
    ... 
```

不幸的是，通用定义格式似乎在文档文件和 cref 标签之间不兼容。在 XML 文件中，泛型如下所示：

```
<member name="M:My.Namespace.Class1.Get``1(System.String)">
    <summary>
    retrieve an named item of the given type
    </summary>
    <typeparam name="T">the type of the item to retrieve</typeparam>
    ... 
```

该`cref`标签要求它们采用以下格式之一：

```
/// <seealso cref="M:My.Namespace.Class1.Get{T}(System.String)"/>   

/// <seealso cref="M:My.Namespace.Class1.Get&lt;T>(System.String)"/> 
```

# c++ - 在 Unix 环境下隐藏代码中的注释

> ID：341130
> 
> 赞同：3
> 
> 时间：2008-12-04T16:04:55.783
> 
> 标签：c++, editor, comments, folding

我使用典型的 Unix 工具（emacs、vim、gvim、sunstudio 等）在 Unix 环境中工作

我的项目对每种方法都有大量的样板评论。它使文件长达数千行，实际代码只有几百行。我可能有点夸张，但你明白了。我正在寻找一种在查看这些文件时隐藏（而不是删除）所有评论的方法，以便我可以快速浏览代码。仅 C++ 注释 '//'。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T16:15:12.767

这完全取决于您使用的编辑器。在 vim 中，您可以使用以下命令启用折叠：

```
set foldenable 
```

然后，您将能够使用不同的折叠方法，对于主流语言，您可以设置：

```
set foldmethod=syntax 
```

这将启用语法折叠。

有六种折叠方法，我认为最好是阅读

```
help folding 
```

这应该回答一切。

# python - 如何在 Python 脚本中重新启动 Windows XP64 机器？

> ID：341138
> 
> 赞同：4
> 
> 时间：2008-12-04T16:06:52.050
> 
> 标签：python, windows

如何在 Python 脚本中重新启动 Windows XP64 机器？这台机器没有可用的“关闭”或“重启”可执行文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T17:10:04.607

找到了

win32api.InitiateSystemShutdown("localhost", "维护重启", 60, 1, 1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T17:01:18.023

您可以使用 win32api 模块并调用 WinApi 函数。 [code.activestate.com 上的食谱](http://code.activestate.com/recipes/360649/)

# ruby-on-rails - Rails 路由助手（即 mymodel_path(model)）可以在模型中使用吗？

> ID：341143
> 
> 赞同：390
> 
> 时间：2008-12-04T16:07:59.053
> 
> 标签：ruby-on-rails, rails-routing, helpermethods

假设我有一个名为 Thing 的 Rails 模型。Thing 有一个 url 属性，可以**选择**将其设置为 Internet 上某处的 URL。在视图代码中，我需要执行以下操作的逻辑：

```
<% if thing.url.blank? %>
<%= link_to('Text', thing_path(thing)) %>
<% else %>
<%= link_to('Text', thing.url) %>
<% end %> 
```

视图中的这种条件逻辑很丑陋。当然，我可以构建一个辅助函数，它将视图更改为：

```
<%= thing_link('Text', thing) %> 
```

这解决了冗长的问题，但我真的更喜欢模型本身的功能。在这种情况下，视图代码将是：

```
<%= link_to('Text', thing.link) %> 
```

这显然需要模型上的链接方法。以下是它需要包含的内容：

```
def link
  (self.url.blank?) ? thing_path(self) : self.url
end 
```

就问题而言，thing_path() 是模型代码中未定义的方法。我假设可以将一些辅助方法“引入”到模型中，但是如何？路由只在应用程序的控制器和视图层运行是否有真正的原因？我可以想到很多模型代码可能需要处理 URL（与外部系统集成等）的情况。

* * *

## 回答 #1

> 赞同：727
> 
> 时间：2011-03-28T07:56:56.247

在 Rails 3 及更高版本中：

```
Rails.application.routes.url_helpers 
```

例如

```
Rails.application.routes.url_helpers.posts_path
Rails.application.routes.url_helpers.posts_url(:host => "example.com") 
```

* * *

## 回答 #2

> 赞同：190
> 
> 时间：2008-12-04T16:42:11.353

我自己找到了如何做到这一点的答案。在模型代码中，只需输入：

对于 Rails <= 2：

```
include ActionController::UrlWriter 
```

对于 Rails 3：

```
include Rails.application.routes.url_helpers 
```

这会神奇地`thing_path(self)`返回当前事物的 URL，或者`other_model_path(self.association_to_other_model)`返回一些其他 URL。

* * *

## 回答 #3

> 赞同：130
> 
> 时间：2011-08-24T00:24:30.323

您可能还会发现以下方法比包含所有方法更干净：

```
class Thing
  delegate :url_helpers, to: 'Rails.application.routes' 

  def url
    url_helpers.thing_path(self)
  end
end 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-12-04T16:14:47.587

任何与视图中显示的内容有关的逻辑都应该委托给辅助方法，因为模型中的方法严格用于处理数据。

这是您可以执行的操作：

```
# In the helper...

def link_to_thing(text, thing)
  (thing.url?) ? link_to(text, thing_path(thing)) : link_to(text, thing.url)
end

# In the view...

<%= link_to_thing("text", @thing) %> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-02-05T20:59:26.840

我真的很喜欢遵循干净的解决方案。

```
class Router
  include Rails.application.routes.url_helpers

  def self.default_url_options
    ActionMailer::Base.default_url_options
  end
end

router = Router.new
router.posts_url  # http://localhost:3000/posts
router.posts_path # /posts 
```

它来自[http://hawkins.io/2012/03/generating_urls_whenever_and_wherever_you_want/](http://hawkins.io/2012/03/generating_urls_whenever_and_wherever_you_want/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T16:15:08.413

虽然可能有一种方法我会倾向于将这种逻辑排除在模型之外。我同意你不应该把它放在视图中（[让它保持苗条](http://weblog.jamisbuck.org/2006/10/18/skinny-controller-fat-model)），但除非模型将一个 url 作为一条数据返回给控制器，否则路由的东西应该在控制器中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T16:15:28.973

*（编辑：忘记我之前的唠叨......）*

好的，在某些情况下您可能会转到模型或其他一些网址......但我真的不认为这属于模型，视图（或者可能是模型）听起来更合适。

关于路由，据我所知，路由是针对控制器中的操作（通常“神奇地”使用视图），而不是直接针对视图。控制器应该处理所有请求，视图应该呈现结果，模型应该处理数据并将其提供给视图或控制器。我在这里听到很多人谈论到模型的路由（到了我几乎开始相信它的地步），但据我所知：路由转到控制器。当然很多控制器是一个模型的控制器并且经常被称为`<modelname>sController`（例如“UsersController”是模型“User”的控制器）。

如果您发现自己在视图中编写了大量令人讨厌的逻辑，请尝试将逻辑移动到更合适的位置；请求和内部通信逻辑可能属于控制器，数据相关逻辑可能放在模型中（但不包括显示逻辑，包括链接标签等），纯粹与显示相关的逻辑将放在帮助程序中。

# .net - 在实体框架中挂钩对象加载事件？

> ID：341156
> 
> 赞同：3
> 
> 时间：2008-12-04T16:11:43.303
> 
> 标签：.net, entity-framework, ado.net

是否有等效于 LINQ to SQL 的 OnCreated 部分的 EF？

我的几个对象具有 XML 字段，每当从 db 加载对象时我想解析这些字段 - 我想将 XML 数据放入更友好的强类型集合中。我已经将 XML 字段标记为私有并挂钩 SavingChanges 事件以在将项目提交回数据库之前重新构建 XML，但我无法弄清楚在加载对象时如何填充集合。

我曾考虑为我的 XML 字段使用 OnFieldChanged 部分，但只要在 SavingChanges 期间重新构建 XML 字段，它就会再次运行，因此似乎应该有更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-09-19T02:18:12.900

或在 .net 4.0 中使用 ObjectContext.ObjectMaterialized 事件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T16:53:11.550

`OnLoaded`据我所知，没有事件或类似事件。一种解决方法可能是将集合公开为属性并在首次访问时懒惰地创建/解析值：

```
private List<SomeData> _parsedDataCache;
public IList<SomeData> ParsedData {
    get {
        if (_parsedDataCache == null)
            ParseData();
        return _parsedDataCache;
    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2010-07-01T12:44:54.173

您应该创建一个分部类（就像在 LINQ to SQL 中所做的那样）并只使用默认构造函数。

# winapi - 我可以从 DLL 中删除数字签名吗？

> ID：341168
> 
> 赞同：29
> 
> 时间：2008-12-04T16:14:50.177
> 
> 标签：winapi, dll, code-signing

我的安装程序在构建过程中使用代码签名证书构建“签名”DLL。

我注意到，如果我尝试连续构建两次，第二次构建会失败，因为 DLL 已经签名，所以 signcode 阻塞。显然我可以通过在构建中签署 DLL 的副本来解决这个问题，但这个问题引起了我的兴趣：

是否可以“取消签名”DLL，如果没有，为什么不...？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2016-10-21T09:33:13.010

```
signtool remove /s C:\path\to.exe.or.dll 
```

[signtool](https://msdn.microsoft.com/en-us/library/windows/desktop/aa387764(v=vs.85).aspx)在 Windows SDK 中可用，并且必须至少来自 Windows 8 SDK 工具包（版本 6.2.9200.20789）才能`remove`支持该命令。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-06T15:42:31.027

您可以使用此[XDA 论坛帖子](http://forum.xda-developers.com/showthread.php?p=2508061)中的 delcert.exe 。

> 这是一个从 PE 可执行文件（如 *.exe、*.dll、*.mui 等）中剥离（删除）数字签名（Authenticode）的小工具。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-04T04:29:23.953

[使用ImageRemoveCertificate](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680214%28v=vs.85%29.aspx) API从 .dll 文件中删除签名相当容易。

您的标签中没有指定任何语言，但本文展示了如何在 C# 中实现它。[使用 C# 从文件中删除数字签名](http://www.fluxbytes.com/csharp/remove-digital-signature-from-a-file-using-c/)

除此之外，如果您正在寻找一个简单的工具来为您完成工作，您可以使用[FileUnsigner](http://www.fluxbytes.com/software-releases/fileunsigner-v1-0/)。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-03-11T02:34:18.223

另一种可能的选择是切换到[SignTool.exe](http://msdn.microsoft.com/en-us/library/8s9b9yaz%28v=vs.80%29.aspx)。它随[Windows SDK](http://msdn.microsoft.com/en-us/windows/bb980924)一起提供，对已签名的二进制文件进行签名不会产生错误。我在构建过程中使用 signtool.exe 并且没有任何困难，即使已经签署了某些内容。

另外，请查看问题[signcode.exe 和 signtool.exe 之间的主要区别是什么？](https://stackoverflow.com/questions/770711/whats-the-main-difference-between-signcode-exe-and-signtool-exe)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-27T05:14:05.760

当然这是可能的，但不是微不足道的。

尽管保存预签名 DLL 的副本会更容易。

这个数字签名只不过是附加到 PE 文件末尾的一个额外部分。如果需要，您可以编写一个删除签名的程序。

它不像截断文件那么简单；您必须删除文件头中对签名的引用。如果 DLL 有多个签名并且您只想删除一个签名，它可能会变得复杂。

PE 文件的格式在[此处公开记录](http://www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-03-27T14:49:24.163

检查您的构建工具是否支持“重新签名”。这应该替换所有现有的签名。

如果没有，您可以使用[Stud_PE](http://www.cgsoftlabs.ro/studpe.html)删除签名块。在 Stud_PE 中打开 DLL 或 EXE，转到部分选项卡，右键单击数字签名部分并选择“删除部分”。但是，这需要用户交互。该工具的旧版本可能会破坏该文件。

# c# - datetime.parse 并使其以特定格式工作

> ID：341175
> 
> 赞同：155
> 
> 时间：2008-12-04T16:15:40.863
> 
> 标签：c#, asp.net, .net-2.0

我有一个从 XML 文件返回的日期时间，格式为：

> 20080916 11:02

如在

> yyyymm hh:ss

我怎样才能让 datetime.parse 函数来处理这个问题？即解析它而不出错？干杯

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2008-12-04T16:22:01.397

```
DateTime.ParseExact(input,"yyyyMMdd HH:mm",null); 
```

假设您的意思是分钟后是小时，而不是秒 - 您的示例有点令人困惑。

[ParseExact 文档](http://msdn.microsoft.com/en-us/library/system.datetime.parseexact(VS.80).aspx)详细介绍了其他重载，以防您希望解析自动转换为通用时间或类似的东西。

正如[@Joel Coehoorn](https://stackoverflow.com/users/3043/joel-coehoorn)所提到的，还有使用[TryParseExact](http://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact(VS.80).aspx)的选项，它将返回一个指示操作成功或失败的布尔值 - 我仍在使用 .Net 1.1，所以我经常忘记这个。

如果您需要解析其他格式，可以查看[Standard DateTime Format Strings](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-05-22T11:47:02.803

感谢您的提示，我用它来解析我的日期“20071122”，我需要添加 datetimestyles，我没有使用它并且它有效：

```
DateTime dt = DateTime.MinValue;

DateTime.TryParseExact("20071122", "yyyyMMdd", null,System.Globalization.DateTimeStyles.None, out dt); 
```

# svn - 如何将新的文件夹结构合并到 SVN？

> ID：341178
> 
> 赞同：2
> 
> 时间：2008-12-04T16:16:15.137
> 
> 标签：svn, merge

我们有一个项目，供应商为我们生成一些自定义代码，我们生成后端内容。每次他们向我们发送新版本时，我们都会手动将整个文件夹结构合并到我们的存储库中。这对于添加和修改的文件（只需复制/粘贴）很容易，但我必须创建一个批处理脚本来删除所有已删除的文件/文件夹（我使用 diff 工具获取已删除文件的列表，然后制作一个批处理文件）。

我们的 SVN 存储库如下所示：

我们的项目\
--OurBackendCode\
--VendorCode\

我知道我可以先删除我们仓库中供应商目录中的所有文件，然后添加新版本。这很容易，但会在 SVN 日志中留下不需要的“已删除”和“添加”条目（我们在 SVN 中保留其代码副本的全部原因是我们可以轻松访问日志以进行故障排除）。

有没有更简单的方法可以将这些已删除的文件合并到我的仓库中？

编辑：蒂姆正确地指出，如果我们只允许供应商访问我们的 SVN 存储库，他们可以在分支上进行更改。不幸的是，这不是我的决定。我只是一个开发者。另外，我怀疑我们会信任他们（我对 SVN 安全性一无所知）。

第二次编辑：我们最终只是删除了现有的供应商分支并添加了新的供应商代码。但是我提出了让供应商访问我们的 SVN 的想法，并且它带着一些承诺向上浮动 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T16:24:23.060

你为什么不让他们访问你的 SVN 存储库——也许是一个分支，然后你合并到你的？

只允许他们访问他们需要的部分很简单。我真的认为这对你和他们来说是最好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T16:25:02.153

如果您可以让他们 SVN 访问他们需要的文件夹并让他们管理它，那将会容易得多。:-)

噢，蒂姆在我之前点击了帖子！

简化您所做工作的唯一方法是将运行差异的整个过程编写脚本，获取已删除/已删除的文件，并将其输入 svn -delete。然后至少您将有 1 个命令与源文件夹和目标文件夹一起运行。

理想情况下，您只想让远程开发人员访问 SVN，就像 Tim 说的那样，如果您无法锁定文件夹，请给他们一个分支，但您最终仍然会运行合并（使用分支）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T16:26:48.937

在我看来，您在这里想要的是[供应商分支](http://svnbook.red-bean.com/en/1.1/ch07s05.html)，其中供应商代码的每次连续导入都会获得一个新版本。

这样，无需管理删除，您可以使用 Subversion 来区分 1.0 版和 2.0 版等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-19T15:50:58.230

创建一个 verdor 存储库（与您的开发存储库分开），并要求供应商转储自上一个版本交付给您以来的修订。在您的站点上，您可以简单地将其加载回供应商的存储库。简单易行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T16:41:00.063

一位同事提出的一个答案是为新的代码删除创建一个临时分支，然后从该分支到真正的分支进行 SVN 合并（然后删除临时分支）。

# python - 我可以在同一台 Windows 计算机上安装 Python 3.x 和 2.x 吗？

> ID：341184
> 
> 赞同：175
> 
> 时间：2008-12-04T16:18:57.097
> 
> 标签：python, windows, python-3.x, compatibility

我正在运行 Windows，当您在命令行上运行程序时，shell/OS 会根据注册表设置自动运行 Python。如果我在同一台机器上安装 Python 的 2.x 和 3.x 版本，这会中断吗？

我想玩 Python 3，同时仍然能够在同一台机器上运行 2.x 脚本。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-11-08T21:11:48.443

官方的共存解决方案似乎是[Python Launcher for Windows](http://blog.python.org/2011/07/python-launcher-for-windows_11.html)，PEP 397，它包含在[Python 3.3.0](http://www.python.org/download/releases/3.3.0/)中。将发布转储`py.exe`和`pyw.exe`启动器安装到`%SYSTEMROOT%`( `C:\Windows`) 中，然后分别`py`与`pyw`脚本相关联。

为了使用新的启动器（无需手动设置您自己的关联），请启用“注册扩展”选项。我不太清楚为什么，但在我的机器上它把 Py 2.7 作为“默认”（启动器）。

通过直接从命令行调用它们来运行脚本将通过启动器将它们路由并解析shebang（如果存在）。您还可以显式调用启动器并使用开关：`py -3 mypy2script.py`.

各种shebangs似乎都有效

*   `#!C:\Python33\python.exe`
*   `#!python3`
*   `#!/usr/bin/env python3`

以及肆意谩骂

*   `#! notepad.exe`

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2015-08-25T05:15:42.210

这是我的设置：

1.  [使用windows 安装程序](https://www.python.org/downloads/)安装 Python 2.7 和 3.4 。
2.  转到`C:\Python34`（默认安装路径）并将 python.exe 更改为 python3.exe
3.  **编辑** [您的环境变量](https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/sysdm_advancd_environmnt_addchange_variable.mspx?mfr=true)以包含`C:\Python27\;C:\Python27\Scripts\;C:\Python34\;C:\Python34\Scripts\;`

现在在命令行中，您可以使用`python`2.7 和`python3`3.4。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2016-06-29T08:18:41.497

从 3.3 版开始，Python 引入了 Launcher for Windows 实用程序[https://docs.python.org/3/using/windows.html#python-launcher-for-windows](https://docs.python.org/3/using/windows.html#python-launcher-for-windows)。

为了能够使用多个版本的 Python：

1.  安装 Python 2.x（x 是您需要的任何版本）
2.  安装 Python 3.x（x 是您需要的任何版本，也必须有一个版本 3.x >= 3.3）
3.  打开**命令提示符**
4.  键入**py -2.x**以启动 Python 2.x
5.  键入**py -3.x**以启动 Python 3.x

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-12-04T16:29:38.713

你可以同时安装。

你应该在你的脚本前面写下这个：

```
#!/bin/env python2.7 
```

或者，最终……

```
#!/bin/env python3.6 
```

## 更新

我的解决方案与 Unix 完美配合，在[Google](http://news.softpedia.com/news/Your-First-Python-Script-on-Windows-81974.shtml)上快速搜索后，这里是 Windows 解决方案：

```
#!c:/Python/python3_6.exe -u 
```

同样的事情：在你的脚本前面。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-12T18:26:55.780

我正在使用 shell 中的 2.5、2.6 和 3.0 以及以下形式的一行批处理脚本：

```
:: The @ symbol at the start turns off the prompt from displaying the command.
:: The % represents an argument, while the * means all of them.
@c:\programs\pythonX.Y\python.exe %* 
```

命名它们`pythonX.Y.bat`并将它们放在您的 PATH 中的某个位置。将首选次要版本（即最新版本）的文件复制到`pythonX.bat`. （例如`copy python2.6.bat python2.bat`。）然后您可以`python2 file.py`在任何地方使用。

但是，这无助于甚至影响 Windows 文件关联情况。为此，您需要一个启动程序来读取该`#!`行，然后将其与 .py 和 .pyw 文件相关联。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-10-19T08:24:24.150

当您将两者都添加到环境变量时，将会发生冲突，因为这两个可执行文件具有相同的名称：`python.exe`.

只需重命名其中一个。就我而言，我将其重命名为`python3.exe`.

因此，当我运行`python`时，它将执行`python.exe`2.7，当我运行`python3`时，它将执行`python3.exe`3.6

[![在此处输入图像描述](https://i.stack.imgur.com/n1FxR.png)](https://i.stack.imgur.com/n1FxR.png)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-18T01:45:53.130

干得好...

**winpylaunch.py**

```
#
# Looks for a directive in the form: #! C:\Python30\python.exe
# The directive must start with #! and contain ".exe".
# This will be assumed to be the correct python interpreter to
# use to run the script ON WINDOWS. If no interpreter is
# found then the script will be run with 'python.exe'.
# ie: whatever one is found on the path.
# For example, in a script which is saved as utf-8 and which
# runs on Linux and Windows and uses the Python 2.6 interpreter...
#
#    #!/usr/bin/python
#    #!C:\Python26\python.exe
#    # -*- coding: utf-8 -*-
#
# When run on Linux, Linux uses the /usr/bin/python. When run
# on Windows using winpylaunch.py it uses C:\Python26\python.exe.
#
# To set up the association add this to the registry...
#
#    HKEY_CLASSES_ROOT\Python.File\shell\open\command
#    (Default) REG_SZ = "C:\Python30\python.exe" S:\usr\bin\winpylaunch.py "%1" %*
#
# NOTE: winpylaunch.py itself works with either 2.6 and 3.0\. Once
# this entry has been added python files can be run on the
# commandline and the use of winpylaunch.py will be transparent.
#

import subprocess
import sys

USAGE = """
USAGE: winpylaunch.py <script.py> [arg1] [arg2...]
"""

if __name__ == "__main__":
  if len(sys.argv) > 1:
    script = sys.argv[1]
    args   = sys.argv[2:]
    if script.endswith(".py"):
      interpreter = "python.exe" # Default to wherever it is found on the path.
      lines = open(script).readlines()
      for line in lines:
        if line.startswith("#!") and line.find(".exe") != -1:
          interpreter = line[2:].strip()
          break
      process = subprocess.Popen([interpreter] + [script] + args)
      process.wait()
      sys.exit()
  print(USAGE) 
```

我刚刚在阅读这个线程时敲了这个（因为这也是我需要的）。我在 Ubuntu 和 Windows 上都有 Python 2.6.1 和 3.0.1。如果它对您不起作用，请在此处发布修复。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-10-08T11:49:06.790

这是在 Windows 上安装 Python2 和 Python3 的一种简洁的方法。

[https://datascience.com.co/how-to-install-python-2-7-and-3-6-in-windows-10-add-python-path-281e7eae62a](https://datascience.com.co/how-to-install-python-2-7-and-3-6-in-windows-10-add-python-path-281e7eae62a)

**我的情况：**我必须安装 Apache cassandra。我的**D: drive**中已经安装了 Python3 。由于正在进行大量的开发工作，我不想弄乱我的 Python3 安装。而且，我只需要用于 Apache cassandra 的 Python2。

所以我采取了以下步骤：

1.  已下载并安装 Python2。
2.  将 Python2 条目添加到类路径 ( `C:\Python27;C:\Python27\Scripts`)
3.  修改**python.exe**为**python2.exe**（如下图所示）

[![在此处输入图像描述](https://i.stack.imgur.com/vv3ss.png)](https://i.stack.imgur.com/vv3ss.png)

4.  现在我可以同时运行两者。对于 Python 2( `python2 --version`) 和 Python 3 ( `python --version`)。 [![在此处输入图像描述](https://i.stack.imgur.com/PXIkX.png)](https://i.stack.imgur.com/PXIkX.png)

所以，我的 Python3 安装保持不变。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-05-16T19:23:11.197

尝试使用 Anaconda。

使用 Anaconda 环境的概念，假设您需要 Python 3 来学习编程，但您不想通过更新 Python 来消灭您的 Python 2.7 环境。您可以创建并激活一个名为“snakes”（或任何您想要的）的新环境，并安装最新版本的 Python 3，如下所示：

```
conda create --name snakes python=3 
```

它比听起来简单，看看这里的介绍页面：[Anaconda 入门](https://conda.io/projects/conda/en/latest/user-guide/getting-started.html)

然后要处理同时运行版本 2.x 和 3.x 的具体问题，请参阅：

*   [使用 Anaconda 管理 Python 版本](https://conda.io/docs/py2or3.html#id2)
*   [在 Python 2 和 Python 3 环境之间切换](https://docs.anaconda.com/anaconda/user-guide/tasks/switch-environment/)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-12-04T16:29:01.273

据我所知，Python 使用 PATH 变量而不是注册表设置从命令行运行。

因此，如果您指向 PATH 上的正确版本，您将使用它。请记住重新启动命令提示符以使用新的 PATH 设置。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-03T00:57:41.167

Python 安装通常将`.py`,`.pyw`和`.pyc`files 与 Python 解释器相关联。因此，您可以通过在资源管理器中双击它或在命令行窗口中键入其名称来运行 Python 脚本（因此无需键入`python scriptname.py`，就可以了`scriptname.py`）。

如果要手动更改此关联，可以在 Windows 注册表中编辑这些键：

```
HKEY_CLASSES_ROOT\Python.File\shell\open\command
HKEY_CLASSES_ROOT\Python.NoConFile\shell\open\command
HKEY_CLASSES_ROOT\Python.CompiledFile\shell\open\command 
```

## Python 启动器

人们一直在为 Windows 开发 Python 启动器：一个`.py`与`.pyw`文件关联的轻量级程序，它会在第一行查找“shebang”行（类似于 Linux 等），并启动 Python 2.x 或 3.x必需的。有关详细信息，请参阅[“适用于 Windows 的 Python 启动器”](http://blog.python.org/2011/07/python-launcher-for-windows_11.html)博客文章。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-06-20T03:11:11.350

Easy-peasy，在安装两个 python 版本后，添加环境变量的路径；请参阅[![环境变量设置](https://i.stack.imgur.com/gTrFP.png)](https://i.stack.imgur.com/gTrFP.png)。然后转到 python 2 和 python 3 文件夹，并分别将它们重命名为 python2 和 python3 ，如图所示[![这里是python2](https://i.stack.imgur.com/aRyhk.png)](https://i.stack.imgur.com/aRyhk.png)和[![这里是python3](https://i.stack.imgur.com/VbjXF.png)](https://i.stack.imgur.com/VbjXF.png)。现在在 cmd 中键入 python2 或 python3 以使用您所需的版本，请参阅[![这里](https://i.stack.imgur.com/zjQ2P.png)](https://i.stack.imgur.com/zjQ2P.png).

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-01-03T03:10:43.540

### 以下是如何在同一台机器上运行 Python 2 和 3

1.  安装 Python 2.x
2.  安装 Python 3.x
3.  启动 Powershell
4.  键入**Python -2**以启动 Python 2.x
5.  键入**Python -3**以启动 Python 2.x

正如 2011 年 Standalone 首次亮相时所承诺的那样，*Windows*的Python 启动器自 3.3 版开始嵌入到 Python 中：

[适用于 Windows 的 Python 启动器](https://docs.python.org/3/using/windows.html%0A)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-17T16:53:19.377

您应该确保 PATH 环境变量不包含两个 python.exe 文件（添加您当前用于日常运行脚本的那个），或者按照 Kniht 建议的批处理文件进行操作。除此之外，我不明白为什么不这样做。

PS：我安装了 2.6 作为我的**“主要”** python 和 3.0 作为我的**“播放”** python。2.6 包含在**PATH**中。一切正常。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-04T16:33:47.393

我认为有一个选项可以在安装程序中为 .py 文件设置 Windows 文件关联。取消选中它，你应该没问题。

如果没有，您可以轻松地将 .py 文件与以前的版本重新关联。最简单的方法是右键单击 .py 文件，选择“打开方式”/“选择程序”。在出现的对话框中，选择或浏览到您要默认使用的 python 版本，并选中“始终使用此程序打开此类文件”复选框。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-05-17T09:25:03.937

我有同样的问题，我想在大多数工作中使用 python3，但 IDA pro 需要 python2。所以，这就是我所做的。

我首先在用户环境变量中创建了3个变量如下：

1.  PYTHON_ACTIVE ：这最初是空的
2.  HOME_PYTHON27 ：具有安装 Python 2 的文件夹的路径。例如。“;/脚本;”
3.  HOME_PYTHON38 ：与 python 2 类似，此变量包含指向 python 3 文件夹的路径。

现在我添加了

> %PYTHON_ACTIVE%

到 PATH 变量。所以，基本上说这个“PYTHON_ACTIVE”包含的任何东西都是活动的python。我们以编程方式更改“PYTHON_ACTIVE”的包含以切换 python 版本。

这是示例脚本：

```
:: This batch file is used to switch between python 2 and 3.
@ECHO OFF

set /p choice= "Please enter '27' for python 2.7 , '38' for python 3.8 : "

IF %choice%==27 (
setx PYTHON_ACTIVE %HOME_PYTHON27%
)

IF %choice%==38 (
setx PYTHON_ACTIVE %HOME_PYTHON38%
)

PAUSE 
```

该脚本将 python 版本作为输入，并相应地将 HOME_PYTHON27 或 HOME_PYTHON38 复制到 PYTHON_ACTIVE。从而更改全局 Python 版本。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-03-12T09:32:51.443

在我勇敢地同时安装两者之前，我有很多问题。如果我给python，当我想要py2时它会去py3吗？pip/virtualenv 会在 py2/3 下发生吗？

现在看起来很简单。

只是盲目地安装它们。确保你得到正确的类型（x64/x32）。安装时/安装后确保添加到[环境变量](https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/sysdm_advancd_environmnt_addchange_variable.mspx?mfr=true)的路径。

```
[ENVIRONMENT]::SETENVIRONMENTVARIABLE("PATH", "$ENV:PATH;C:\PYTHONx", "USER") 
```

**替换上面命令中的 x 来设置路径。**

然后转到这两个文件夹。

导航

```
python3.6/Scripts/ 
```

并将 pip 重命名为 pip3。

如果 pip3 已经存在，请删除 pip。这将确保 pip 将在**python2**下运行。您可以通过以下方式进行验证：

```
pip --version 
```

如果您想将 pip 与**python3**一起使用，则只需使用

```
pip3 install 
```

您可以类似地对 python 文件和其他文件执行相同的操作。

干杯!

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-04T17:31:33.987

我会假设是这样，我在同一台计算机上并排安装了 Python 2.4、2.5 和 2.6。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-02-07T00:46:31.597

我现在才刚开始使用python。我正在阅读 Zed Shaw 的书“Learn Python the Hard Way”，它需要 python 2.x 版本，但我也在学习需要 python 3.x 的课程

所以这就是我所做的。

1.  下载python 2.7
2.  运行power shell（应该已经安装在windows上）
3.  在 POWERSHELL 中运行 python（如果无法识别，则转到第 4 步）
4.  ***仅当 powershell 在以下情况下无法识别 python 2.7***类型时：

"[ENVIRONMENT]::SETENVIRONMENTVARIABLE("PATH", "$ENV:PATH;C:\PYTHON27", "USER")" （没有外部引号）

5.  现在输入 python 你应该看到它说 python 2.7 blah blah blah

现在适用于 python 3.x

简单，python 3.x 下载附带 python for windows 应用程序。因此，只需将 Python for Windows 应用程序固定到您的任务栏，或创建桌面快捷方式，您就完成了！

为 3.x 打开适用于 Windows 的 Python

为 python 2.x 打开 Powershell

我希望这有帮助！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-06-07T01:37:02.130

嗯..我现在通过在[https://www.python.org/downloads/release/python-365/](https://www.python.org/downloads/release/python-365/)下载适用于 Windows 的 Python 3.6.5并确保安装了启动器来做到这一点。然后，我按照使用 python 2 和 python 3 的说明进行操作。重新启动命令提示符，然后使用`py -2.7`to use Python 2 and `py`or `py -3.6`to use Python 3。您也可以使用`pip2`for Python 2's`pip`和`pip`for Python 3's `pip`。

# .net - 如何修复导致 Java 客户端中出现 UnsupportedMediaException 的 .NET Web 服务超时？

> ID：341190
> 
> 赞同：0
> 
> 时间：2008-12-04T16:19:48.887
> 
> 标签：.net, web-services, exception, wsdl, timeout

我目前有一个 .net SOAP Web 服务，我使用设置的请求超时

```
Server.ScriptTimeout = TIME_OUT; 
```

然后我有java客户端调用所说的web服务。但是，当达到超时时，我得到了这个异常：

```
Exception in thread "Thread-9" com.sun.xml.ws.server.UnsupportedMediaException: Unsupported Content-Type: text/html; charset=utf-8 Supported ones are: [text/xml] 
```

发生的事情是 Web 服务返回一个带有 http 超时代码的 html 错误页面（我认为是 503？），这是我的 Java 代码（使用 WSDLimport 生成）没有预料到的。

现在我可以在客户端捕获错误 UnsupportedMediaException 并尝试将其转换为更有意义的内容，但我更愿意在 Web 服务端发送更具体的超时异常。.net Web 服务中是否有在超时发生时发送更好的异常，或者有任何其他方式可以更好地处理这种情况？

**编辑：**
我正在使用 glassfish 2 发行版中的 WSDLImport。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T15:50:54.327

这是 Sun 的 JAX-WS 堆栈的一个[已知问题](https://jax-ws.dev.java.net/issues/show_bug.cgi?id=566)。

作为参考，HTTP 500 代码实际上意味着服务器存在内部服务器错误。我不确定为什么 .NET 发送它而不是 HTTP 503 服务不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T16:35:50.353

您可以使您的网络服务[异步](http://msdn.microsoft.com/en-us/library/aa480516.aspx)。然后在 BeginMyMethod 中使用超时启动计时器，并在 EndMyMethod 方法中引发自定义异常。它将被包装在 SOAP 异常中并照此发送给客户端。

# visual-studio - 如何设置 Visual Studio 2008 以在 Perl 中编程？

> ID：341191
> 
> 赞同：9
> 
> 时间：2008-12-04T16:19:54.987
> 
> 标签：visual-studio, perl, configuration, ide

我的公司给了我 VS2008 用于 C#/ASP.NET 中的 Web 开发。我也做了很多 Perl 编程，我想开始使用 VS，这样我就可以拥有一个一致的工作环境......但是我很难弄清楚如何去做。

VS 有很多不错的功能，但似乎对它不支持开箱即用的语言充满敌意。是真的还是我只是没有“得到”VS的做事方式？

我通常使用 TextPad 编写 Perl 脚本，而我习惯拥有的功能非常基本。

1.  行号
    *   软线环绕
    *   语法高亮
    *   打开/关闭大括号后自动缩进/缩进
    *   自动缩进到与上一行相同的起点
    *   大括号匹配
    *   从编辑器中运行脚本
    *   在编辑器窗格中捕获脚本输出
    *   dbl-click on error message 跳转到发生错误的行

**如何在VS2008中至少获得上述功能？**

如何获得高级功能，例如：

*   代码折叠
*   智能感知
*   代码完成
*   集成 perldoc
*   VS 风格的调试和代码跟踪
*   即时错误检测
*   ETC

（我在[ASPN mod-perl 邮件列表中看到了一个](http://aspn.activestate.com/ASPN/Mail/Message/perl-mod_perl/3593967)*可能*相关的在线讨论，但不明白这对像我这样的人意味着什么，如果有的话。）

-- 补充 --
我知道其他编辑器和 IDE：vi、perlmode-emacs、Komodo、E、TextMate 等。这个问题与我应该尝试什么*其他编辑器或 IDE**无关。* 虽然我很欣赏你的建议，但我宁愿在“我应该为 Perl 使用什么编辑器”之类的主题中阅读它们，而不是“如何设置 VS 以实现我的目标”

 *-- 补充 -- 在做了一些额外的研究之后，我得出的结论是你不能从这里到达那里。唯一的选择是编写我自己的语言插件。考虑到使某些东西可用的时间承诺，我认为我最好使用不同的编辑器。还是谢谢各位

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T18:07:48.750

我将 VS2008 用于 .NET 的东西，但我完全在 Komodo 上出售用于 Perl 编辑。如果这是您的工作并且喜欢/需要使用调试器，那么完整的 Komodo IDE 是物有所值的，但即使是免费的 Komodo Edit 也是一个了不起的 Perl 编辑器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T18:42:03.873

我同意，我真的很喜欢 Komodo 以及 IDE。它坚固且易于使用。我倾向于大量使用 Vim 而不是 IDE，但这只是个人喜好。

不过看看 Komodo，它值得一看。

问候，

杰夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T19:21:17.320

我听说有 Perl 的 .NET 实现，称为 IronPerl，但除此之外，我认为 Visual Studio 没有任何类型的插件。我建议只使用为 Perl 设计的众多工具之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-25T19:12:44.237

如果你愿意花时间的话， 看起来你可以通过[托管包框架来做到这一点。](http://msdn.microsoft.com/en-us/library/bb166533%28v=VS.90%29.aspx)

您可以通过设置[语法着色来减少所需的工作量](http://msdn.microsoft.com/en-us/library/bb165041%28v=VS.90%29.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-13T22:46:06.570

有一种叫做“Visual Perl”的东西可以与 Visual Studio.net 2002 一起使用，并且需要 Perl 开发工具包工具，但我不知道与 VS.net 2010 有多么兼容。

# c++ - 使用 SDL 和 C++ 的分段错误，尝试 Blit 图像

> ID：341192
> 
> 赞同：1
> 
> 时间：2008-12-04T16:20:35.377
> 
> 标签：c++, sdl

好的 - 我这里有一个有趣的。我正在研究俄罗斯方块克隆（基本上是为了“升级”我的技能）。我试图重构我的代码，让它按照我想要的方式抽象。虽然它以前工作得很好，但现在我在任何图像被 blitted 之前遇到了分割错误。我试过调试它无济于事。

我在[这里](http://www.andrews.edu/~sajo/downloads/Tetris-clone.tar.gz)发布了我的项目的 SVN 工作副本。

这只是一个小项目，比我有更多知识的人和一个好的调试器可能会很快解决。唯一的依赖是[SDL](http://www.libsdl.org)。感谢能够告诉我我做错了什么的人。

编辑：据我所知，我现在拥有的和以前拥有的在逻辑上是相同的，所以我不认为我现在拥有的会导致分段错误。只需在工作副本上运行 svn revert，重新编译，您就可以看到它正在工作......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T19:55:13.447

查看 Surface.cpp 的第 15 到 18 行：

```
 surface = SDL_DisplayFormatAlpha( tempSurface );
    surface = tempSurface;
}
SDL_FreeSurface( tempSurface ); 
```

我认为它是段错误，因为当您稍后使用此表面时，由于这条线，您实际上是在 tempSurface 上操作：

```
surface = tempSurface; 
```

而不是 SDL_DisplayFormatAlpha() 返回的表面。由于您释放了 tempSurface，因此表面现在指向无效内存。要修复，只需删除 else 块中的第二行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T16:53:21.630

我的机器上没有安装 SDL，但是在查看了代码之后。

我在 Output.cpp 文件中注意到了这一点：

```
display = new Surface(); 
```

你什么都不做。这个的构造函数是空的。（表面未初始化）。

然后在 Output::initialize() 你做：

```
display->surface = SDL_SetVideoMode( 800, 600, 32, SDL_HWSURFACE | SDL_DOUBLEBUF ); 
```

这看起来像是 Surface::surface 从未真正初始化过的问题。如果您还没有找到解决方案，当我回到家时，我会深入研究它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-01T04:25:01.667

据我了解，当您尝试操作不再可用的 ponter，或者您尝试更改常量的值时，会发生分段错误。

# sql-server - SQL Server 2008 - 编辑表：位列需要“真”或“假”

> ID：341201
> 
> 赞同：4
> 
> 时间：2008-12-04T16:22:19.647
> 
> 标签：sql-server, sql-server-2008, sql-server-2012

与其说是一个问题，不如说是一个观察......

我只是在我的开发机器上升级到 SQL Server 2008，以期升级我的实时应用程序。我没有预料到任何问题，因为 [我认为] 我通常使用标准 T-SQL，并且可能与 ANSI 标准 SQL 相差不远。到目前为止一切顺利，但我真的被一个非常简单的改变所震撼：

我正在创建一个简单的小型查找表来存储代码列表，并包括一个位列来指示当前的默认代码。但是当我使用新的/修改的“编辑前 200 行”选项，并在位列中输入我的 0 和 1 时，我收到了一个错误：

> '单元格的值无效 - 字符串未被识别为有效的布尔值'

经过一番摸索后，我尝试了 True 和 False - 他们奏效了。

因此，这个新的编辑功能似乎需要输入 4 或 5 个字符，而不是之前的 1 个。

进一步检查，我们仍然可以使用 ' `...where bitval = 1`' 但现在也可以使用 ' `...where bitval = 'true'`'。但是返回的任何结果仍会将这些位列呈现为 0 或 1。

这一切听起来像是倒退了半步。不是世界末日，而是不必要的烦恼。

有人对这个问题有任何见解吗？或者 SQL Server 2008 还有其他新的陷阱吗？

**2012 更新：** 刚刚安装了 SQL Server 2012，我注意到这种行为已被“纠正” - 就像我以前一样，我现在可以使用“编辑前 200 行”直接在行中输入 1/0 而不是 True/False ' 选项。这是一件小事，但我很高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T16:28:58.183

您一直能够使用 'True' 和 'False' 与 BIT 列进行比较...我认为这种“强制”更改是一个很好的选择，明确该字段是 BIT，而不是 INT .

就个人而言，我喜欢 C# 不支持“if (0) ...”我想这只是为了清晰起见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T19:08:04.007

刚刚发现这个（在准备其他东西之后）[内置设计](http://msdn.microsoft.com/en-us/library/ms177603.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-11T05:09:40.187

除了他们搞砸了，只有一半强制执行规则尝试在更新语句中使用 ...=True 并看看会发生什么。要么一路走，要么根本不走。对不起微软，不能给你任何分数

# c# - 我需要 .NET 中继器控件中的隐藏字段。

> ID：341208
> 
> 赞同：2
> 
> 时间：2008-12-04T16:25:20.657
> 
> 标签：c#, asp.net, .net-1.1

问题是这是一个 .NET 1.0 项目，没有隐藏字段控制...

所以这是不可能的：

```
 <asp HiddenField Runat="server" ID="hdn" /> 

```

我隐约记得某种类型的 HtmlHiddenInput 类允许类似的功能......有人知道怎么做吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T16:31:38.317

您可以使用常规输入或创建自定义服务器控件。

```
<input type="hidden" runat="server" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T07:15:12.927

您可以使用`<input type="hidden" Name="HiddenControl" runat="server" />` 和在页面后面的代码中使用以下代码：

`protected System.Web.UI.HtmlControls.HtmlInputHidden HiddenControl;`

您可以为隐藏控件赋值： `HiddenControl.value="Your value";`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T16:29:02.567

只需使用 asp 文本框和 visible=false 属性

# vba - Excel VBA 或 VSTO - 如何循环数据透视表上的字段？

> ID：341221
> 
> 赞同：2
> 
> 时间：2008-12-04T16:31:25.543
> 
> 标签：vba, excel, vsto, pivot-table

这是一些示例 VBA 代码：

```
Sub Macro1()
    Dim pt As PivotTable
    Set pt = ActiveSheet.PivotTables("SomePivotTable")
    'Set colOfFields = pt.PivotFields  
End Sub 
```

第三行不完整/损坏。访问数据透视表中所有字段集合的正确方法是什么？我需要能够遍历它们。实际编码是在 C# VSTO 项目中完成的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T17:45:19.840

这对我有用（Excel 2003 [11.8146.8202] SP2）：

```
Sub Macro1()
    Dim pt As PivotTable
    Dim col As PivotFields
    Dim c As PivotField

    ' Name of the pivot table comes from right clicking on the pivot table,
    ' Table Options..., Name field.
    Set pt = ActiveSheet.PivotTables("PivotTable1")
    Set col = pt.PivotFields
    For Each c In col
        Debug.Print c.Name
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T18:21:58.313

行。[从http://blogs.msdn.com/andreww/archive/2008/07/25/creating-a-pivottable-programmatically.aspx](http://blogs.msdn.com/andreww/archive/2008/07/25/creating-a-pivottable-programmatically.aspx)找到了一些 C# 风格的代码创意

```
// pvtTable is an Excel.PivotTable set earlier in the code
Excel.PivotFields pflds =     
    (Excel.PivotFields)pvtTable.PivotFields(System.Type.Missing);
    foreach (Excel.PivotField pf in pflds)
    {
      //some code here
    } 
```

诀窍是传入 System.Type.Missing 以获取字段的“集合”。

# video - 如何流式传输实时视频

> ID：341223
> 
> 赞同：2
> 
> 时间：2008-12-04T16:32:02.140
> 
> 标签：video, streaming, live-video

我正在寻找能够让我在一个位置设置实时视频源并通过互联网在远程位置观看视频流的解决方案。

目标是提供实时高质量视频培训课程，远程用户可以从他们自己的位置观看。

任何技术都会奏效。高质量是必须的。我最熟悉 C# 和 Microsoft 解决方案。

这是我理解它可能起作用的方式：

**对于提供者**

1.  获取相机（我目前有一个高清摄像机）
2.  将相机插入计算机（如何，视频采集卡？）
3.  使用软件捕捉视频（什么软件？）
4.  使用软件流式传输到客户端（什么软件？）

**对于客户**

5.  使用软件指向视频源（什么软件？）
6.  将电脑插入投影仪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-10T23:05:10.693

我认为你的灵魂是 DaCast，一个直播的自助服务平台。注册帐户后，距离第一次流式传输还有 20 分钟。只要您有网络摄像头，您就可以轻松地在整个互联网上进行直播。您可以将 DaCast 频道页面的链接发送给所有观众，他们可以在任何位置观看流。此外，您可以将代码嵌入到您自己的网站或博客中，然后您的观众也可以观看！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T18:30:30.060

您是否尝试过 Video Lan Client (VLC) 他们能够从摄像机或视频文件流式传输/捕获视频。

[http://www.videolan.org/vlc/](http://www.videolan.org/vlc/)

（新对话框底部有一个用于流式传输/保存选项的复选框）

[http://ashishware.com/Video.shtml](http://ashishware.com/Video.shtml)

# registry - 在远程服务器上运行注册表文件

> ID：341227
> 
> 赞同：0
> 
> 时间：2008-12-04T16:32:26.273
> 
> 标签：registry

为了在本地系统中运行它，我使用 REGEDIT.EXE /S "test.reg"

如何将注册表文件运行到远程注册表。

通过相同的命令或任何其他方式，让我知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T16:55:57.223

您可以使用 psexec 获取远程命令提示符来执行 reg 脚本：

> [http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)

# lucene.net - Lucene.net 中的“查找所有”功能

> ID：341228
> 
> 赞同：0
> 
> 时间：2008-12-04T16:32:57.443
> 
> 标签：lucene.net

我的网页上有两个字段，即：BookAuthor 和 BookDescription。提交时，页面使用给定的搜索条件搜索 lucene 索引。

如果用户没有在两个字段中输入任何内容并提交页面，如何让 Lucene.Net 从我的索引中返回所有书籍，而不管 BookAuthor 和 BookDescription 字段值如何？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-04T13:45:04.570

正确的方法是使用 MatchAllDocsQuery：

[http://lucene.apache.org/java/2_9_4/api/core/org/apache/lucene/search/MatchAllDocsQuery.html](http://lucene.apache.org/java/2_9_4/api/core/org/apache/lucene/search/MatchAllDocsQuery.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-09T11:16:16.140

我不确定这是否是正确的方法，但您可以使用默认值向索引添加另一个不可为空的术语（例如 BookIsPublished），如果用户没有输入搜索词，则返回 BookIsPublished 常量字段上的所有匹配项。

# sql-server - SQL Server 功能等同于 PostgreSQL "in"

> ID：341232
> 
> 赞同：3
> 
> 时间：2008-12-04T16:33:56.410
> 
> 标签：sql-server, postgresql

在 postgres 中，您可以对多个项目进行比较，如下所示：

```
 SELECT 'test' IN ('not','in','here'); 
```

这与执行以下操作相同：

```
 SELECT ('test' = 'not' OR 'test' = 'in' OR 'test' = 'here'); 
```

SQL Server 是否有等效的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T16:48:01.420

它受支持，但您需要将表达式放在接受布尔表达式的地方。例如，在一个`case`语句中：

```
select  case  when 'test' in ('not','in','here')  then 1  else 0  end

----------- 
0

(1 row(s) affected) 
```

或`where`子句：

```
select * from T where C in (1,3,5,7,9) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T16:48:00.143

这应该在所有最新版本的 MSSQL 中给出类似的结果。您还可以编写一个标量函数来缩短一些时间。

```
select case 
        when 'test' IN ('not', 'in', 'here') then 1
            else 0
            end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T16:48:06.303

如果“测试”在比较集中 1 次或多次，这将给出 1，如果不是，则为 0。

```
SELECT CAST(COUNT(*) AS BIT) as IsItHere WHERE 'test' IN('not','in','here') 
```

请注意，强制转换不是绝对必要的，但如果从另一种语言调用它可能会很有用......然后它应该解析为布尔值。

编辑：根据 MSSQL 查询规划器，它的执行速度比 CASE 方法快 4 倍。YMMV。

# autocomplete - 获取文本区域中的光标位置

> ID：341233
> 
> 赞同：8
> 
> 时间：2008-12-04T16:34:42.587
> 
> 标签：autocomplete, textarea, cursor-position

我正在尝试在文本区域中实现自动完成（类似于[http://www.pengoworks.com/workshop/jquery/autocomplete.htm](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)）。

我想要做的是，当用户输入一组特定的字符（比如插入：）时，他们将获得一个 AJAX 填充的 div，其中包含可能的可选匹配项。

在常规文本框中，这当然很简单，但在文本区域中，我需要能够根据光标在屏幕上的正确位置弹出 div。

任何人都可以提供任何方向吗？

谢谢，-M

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T16:45:39.913

您可以使用 document.selection.createRange() 获取插入符号，然后检查它以显示您需要的所有信息（例如位置）。有关更多详细信息，请参阅[这些](http://javascript.nwbox.com/cursor_position/) [示例](http://weblogs.asp.net/skillet/archive/2005/03/24/395838.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T15:59:49.750

```
 function getCursor(nBox){
    var cursorPos = 0;
    if (document.selection){ 
        nBox.focus();
        var tmpRange = document.selection.createRange();
        tmpRange.moveStart('character',-nBox.value.length);
        cursorPos = tmpRange.text.length;
    }
    else{
        if (nBox.selectionStart || nBox.selectionStart == '0'){
            cursorPos = nBox.selectionStart;
        }
    }

    return cursorPos;
}

function detectLine(nBox,lines){
    var cursorPos = getCursor(nBox);
    var z = 0; //Sum of characters in lines
    var lineNumber = 1;
    for (var i=1; i<=lines.length; i++){
        z = sumLines(i)+i; // +i because cursorPos is taking in account endcharacters of each line.
        if (z >= cursorPos){
            lineNumber = i;
            break;
        }
    }

    return lineNumber;

    function sumLines(arrayLevel){
        sumLine = 0;
        for (var k=0; k<arrayLevel; k++){
            sumLine += lines[k].length;
        }
        return sumLine;
    }
}

function detectWord(lineString, area, currentLine, linijeKoda){
    function sumWords(arrayLevel){
        var sumLine = 0;
        for (var k=0; k<arrayLevel; k++){
            sumLine += words[k].length;
        }       
        return sumLine;
    }

    var cursorPos = getCursor(area);
    var sumOfPrevChars =0;
    for (var i=1; i<currentLine; i++){
        sumOfPrevChars += linijeKoda[i].length;
    }

    var cursorLinePos = cursorPos - sumOfPrevChars;

    var words = lineString.split(" ");
    var word;
    var y = 0;

    for(var i=1; i<=words.length; i++){
        y = sumWords(i) + i;
        if(y >= cursorLinePos){
            word = i;
            break;
        }
    }

    return word;
}

var area = document.getElementById("area");
var linijeKoda = area.value.split("\n");
var currentLine = detectLine(area,linijeKoda);
var lineString = linijeKoda[currentLine-1];
var activeWord = detectWord(lineString, area, currentLine, linijeKoda);
var words = lineString.split(" ");
if(words.length > 1){
  var possibleString = words[activeWord-1];
}
else{
  var possibleString = words[0];
} 
```

这样就可以了... :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-09T10:44:18.433

在文本区域中实现自动完成并不是那么容易。我实现了一个执行此操作的 jquery 插件，并且我必须创建 texarea 的克隆来猜测光标在 textarea 内的位置。它的工作，但它并不完美。

你可以在这里查看：http: [//www.amirharel.com/2011/03/07/implementing-autocomplete-jquery-plugin-for-textarea/](http://www.amirharel.com/2011/03/07/implementing-autocomplete-jquery-plugin-for-textarea/)

我希望它有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-06T11:26:01.260

一个丑陋的解决方案：

即：使用 document.selection...

对于ff：在textarea后面使用pre，将光标之前的文本粘贴到其中，在其后放置一个标记html元素（cursorPos），并通过该标记元素获取光标位置

备注： | 代码很丑，抱歉| pre 和 textarea 字体必须相同 | 不透明度用于可视化 | 没有自动完成，这里只有一个光标跟随 div（当您在 textarea 中键入时）（根据您的需要修改它）

```
<html>
<style>
pre.studentCodeColor{
    position:absolute;
    margin:0;
    padding:0;
    border:1px solid blue;
    z-index:2;
}
textarea.studentCode{
    position:relative;
    margin:0;   
    padding:0;
    border:1px solid silver;    
    z-index:3;
    overflow:visible;
    opacity:0.5;
    filter:alpha(opacity=50);
}
</style>

hello world<br/>
how are you<br/>
<pre class="studentCodeColor" id="preBehindMyTextarea">
</pre>
<textarea id="myTextarea" class="studentCode" cols="100" rows="30" onkeyup="document.selection?ieTaKeyUp():taKeyUp();">
</textarea>

<div 
    style="width:100px;height:60px;position:absolute;border:1px solid red;background-color:yellow"
    id="autoCompleteSelector">  
autocomplete contents
</div>

<script>
var myTextarea = document.getElementById('myTextarea');
var preBehindMyTextarea = document.getElementById('preBehindMyTextarea');
var autoCompleteSelector = document.getElementById('autoCompleteSelector');

function ieTaKeyUp(){
    var r = document.selection.createRange();
    autoCompleteSelector.style.top = r.offsetTop;
    autoCompleteSelector.style.left = r.offsetLeft;
}
function taKeyUp(){
    taSelectionStart = myTextarea.selectionStart;   
    preBehindMyTextarea.innerHTML = myTextarea.value.substr(0,taSelectionStart)+'<span id="cursorPos">';
    cp = document.getElementById('cursorPos');
    leftTop = findPos(cp);

    autoCompleteSelector.style.top = leftTop[1];
    autoCompleteSelector.style.left = leftTop[0];
}
function findPos(obj) {
    var curleft = curtop = 0;
    if (obj.offsetParent) {
        do {
            curleft += obj.offsetLeft;
            curtop += obj.offsetTop;
        } while (obj = obj.offsetParent);
    }
    return [curleft,curtop];
}
//myTextarea.selectionStart 
</script>
</html> 
```

# visual-studio - 我可以在 Visual Studio 项目模板中创建“解决方案”级别的项目吗？

> ID：341237
> 
> 赞同：9
> 
> 时间：2008-12-04T16:36:58.277
> 
> 标签：visual-studio, visual-studio-2008, templates

MSDN 上有很多关于创建 Visual Studio 模板的重要信息。我一直在专门研究多项目解决方案（[http://msdn.microsoft.com/en-us/library/ms185308(VS.80,printer).aspx](http://msdn.microsoft.com/en-us/library/ms185308(VS.80,printer).aspx)）

我的模板中的所有东西都在工作（4 个项目 + 2 个解决方案文件夹 - 1 个用于测试，1 个用于我引用的库）。我通过模板添加项目或解决方案文件夹没有问题，但我在尝试添加不在特定项目中的 dll 和其他资源时遇到了困难，它们只是解决方案级别的项目。

以前有没有人处理过这个问题？谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-24T21:42:23.980

一段时间以来，我一直在尝试做同样的事情，但没有找到一种本地方法来做这件事。我目前这样做的方式是拥有一个自定义项目模板，将项目添加到项目中，然后通过与该模板关联的 VS 向导使用约定将文件移动到解决方案级别并将它们从项目级别中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-28T07:13:01.900

这个 hack 可能晚了 10 年，但我想我还是会添加它。它比创建一个 VS 向导来驱动添加解决方案级别项目的操作更简单。

基本上，我将一个虚拟项目添加到名为“_SharedFiles”的多项目解决方案模板中。

在需要链接到任何这些文件的其他项目中，我更新了 [project].csproj 以简单地引用**共享文件**虚拟项目中的文件。

```
<Link Include="..\_SharedFiles\GlobalAssemblyInfo.cs" /> 
```

# c# - C# Lambda 表达式和 NHibernate

> ID：341239
> 
> 赞同：14
> 
> 时间：2008-12-04T16:38:07.463
> 
> 标签：c#, nhibernate, lambda

我是 NHibernate 伟大世界的新手。我使用的是 2.0.1.GA 版本。这是我的问题。我有一个`Cars`包含列`Manufacturer(nvarchar(50))`和主键的表`ID(int)`。我的 .NET 课程是：

```
public class Car
{
    public virtual int ID { get; set; }
    public virtual string Manufacturer { get; set; }
} 
```

现在，如果我想检索梅赛德斯制造的所有汽车，我必须输入以下内容：

```
using (var session = OpenSession())
{
    var cars = session
        .CreateCriteria(typeof(Car))
        .Add(Restrictions.Like("Manufacturer", "Mercedes"))
        .List();
    // ...
} 
```

我不喜欢我需要将属性名称指定为字符串的事实 :( 是否有可能有一些对重构更友好的东西（这只是一个建议）？

```
var ms = session
    .CreateCriteria<Car>()
    .Add(c => c.Manufacturer, Restrictions.Like("Mercedes")
    .List(); 
```

当前版本（2.0.1.GA）或未来版本中的任何东西？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-04T19:33:56.563

就像 Google Ninja 说的，你可以用 NHibernate.Linq 做到这一点。查询将是：

`session.Linq<Car>.Where(c => c.Manufacturer == "Mercedes").ToList()`

如果有人最终来到这里并使用 NH3.0，则语法略有不同（感谢 Michael Mrozek 和 Mike 的建议）：

`session.Query<Car>.Where(c => c.Manufacturer == "Mercedes").ToList()`

我使用了一个与[fluent-nhibernate](http://code.google.com/p/fluent-nhibernate/)捆绑在一起的二进制文件，它适用于 2.0GA（我认为，不确定特定的修订版）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-07T04:30:24.417

如果您还不想使用 Linq to NHibernate，有几个替代方法可以获取强类型 Criteria 查询：

*   [http://bugsquash.blogspot.com/2008/03/strongly-typed-nhibernate-criteria-with.html](http://bugsquash.blogspot.com/2008/03/strongly-typed-nhibernate-criteria-with.html)
*   [http://www.kowitz.net/archive/2008/08/17/what-would-nhibernate-icriteria-look-like-in-.net-3.5.aspx](http://www.kowitz.net/archive/2008/08/17/what-would-nhibernate-icriteria-look-like-in-.net-3.5.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-04T17:14:39.480

您可能可以使用 NHibernate.Linq 做到这一点。它是可用的形式，但距离完成还有一段距离。它目前居住在 nhcontrib 中，获得它的唯一方法是将其从 svn 中拉出[https://nhcontrib.svn.sourceforge.net/svnroot/nhcontrib/trunk/src/NHibernate.Linq/](https://nhcontrib.svn.sourceforge.net/svnroot/nhcontrib/trunk/src/NHibernate.Linq/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T02:41:15.667

看看[这个问题](https://stackoverflow.com/questions/299384/linq-to-nhibernate-project-status-contributing-lead)。有人有同样的担心，据我所知，NHibernate.Linq 还活着。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-28T10:07:20.390

[您可以在此处（博客条目）](http://nhforge.org/blogs/nhibernate/archive/2009/01/07/typesafe-icriteria-using-lambda-expressions.aspx)或[此处（谷歌存储库）](http://code.google.com/p/nhlambdaextensions/)找到您要查找的内容

# wmi - 如何找到通过 WMI 调用安装的视频 Ram 数量？

> ID：341243
> 
> 赞同：1
> 
> 时间：2008-12-04T16:39:44.963
> 
> 标签：wmi

有谁知道如何从 WMI 调用中获取 PC 的 Video Ram？

我见过对 Win32_VideoController 管理对象的 AdapterRAM 属性的调用，但这仅提供系统内存，根本不代表视频 RAM。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-05T00:38:08.587

原来是适配器 RAM 返回，并且由于不幸的巧合，使用了错误的转换并给了系统 RAM ......在两个不同的系统上。感谢您推动我们再次查看。

对于它的价值，在 C# WinForms 应用程序中：

```
int _ram = 0;

ManagementObjectSearcher searcher = new ManagementObjectSearcher("select AdapterRAM from Win32_VideoController");

foreach (ManagementObject mo in searcher.Get())
{
   var ram = mo.Properties["AdapterRAM"].Value as UInt32?;

   if (ram.HasValue)
   {
      _ram = ((int)ram/1048576);
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T16:46:31.470

从“硬件”下[的 Microsoft Technet 脚本中心脚本存储库](http://www.microsoft.com/technet/scriptcenter/scripts/)，然后“视频和显示”，然后“列出视频控制器属性”。

我想你可能需要在 AdapterRAM 和 'VideoMemoryType' 之间解决一些问题

```
On Error Resume Next

strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

Set colItems = objWMIService.ExecQuery _
    ("Select * from Win32_VideoController")

For Each objItem in colItems
    For Each strCapability in objItem.AcceleratorCapabilities
        Wscript.Echo "Accelerator Capability: " & strCapability
    Next
    Wscript.Echo "Adapter Compatibility: " & objItem.AdapterCompatibility
    Wscript.Echo "Adapter DAC Type: " & objItem.AdapterDACType
    Wscript.Echo "Adapter RAM: " & objItem.AdapterRAM
    Wscript.Echo "Availability: " & objItem.Availability
    Wscript.Echo "Color Table Entries: " & objItem.ColorTableEntries
    Wscript.Echo "Current Bits Per Pixel: " & objItem.CurrentBitsPerPixel
    Wscript.Echo "Current Horizontal Resolution: " & _
        objItem.CurrentHorizontalResolution
    Wscript.Echo "Current Number of Colors: " & objItem.CurrentNumberOfColors
    Wscript.Echo "Current Number of Columns: " & objItem.CurrentNumberOfColumns
    Wscript.Echo "Current Number of Rows: " & objItem.CurrentNumberOfRows
    Wscript.Echo "Current Refresh Rate: " & objItem.CurrentRefreshRate
    Wscript.Echo "Current Scan Mode: " & objItem.CurrentScanMode
    Wscript.Echo "Current Vertical Resolution: " & _
        objItem.CurrentVerticalResolution
    Wscript.Echo "Description: " & objItem.Description
    Wscript.Echo "Device ID: " & objItem.DeviceID
    Wscript.Echo "Device Specific Pens: " & objItem.DeviceSpecificPens
    Wscript.Echo "Dither Type: " & objItem.DitherType
    Wscript.Echo "Driver Date: " & objItem.DriverDate
    Wscript.Echo "Driver Version: " & objItem.DriverVersion
    Wscript.Echo "ICM Intent: " & objItem.ICMIntent
    Wscript.Echo "ICM Method: " & objItem.ICMMethod
    Wscript.Echo "INF Filename: " & objItem.InfFilename
    Wscript.Echo "INF Section: " & objItem.InfSection
    Wscript.Echo "Installed Display Drivers: " & _
        objItem.InstalledDisplayDrivers
    Wscript.Echo "Maximum Memory Supported: " & objItem.MaxMemorySupported
    Wscript.Echo "Maximum Number Controlled: " & objItem.MaxNumberControlled
    Wscript.Echo "Maximum Refresh Rate: " & objItem.MaxRefreshRate
    Wscript.Echo "Minimum Refresh Rate: " & objItem.MinRefreshRate
    Wscript.Echo "Monochrome: " & objItem.Monochrome
    Wscript.Echo "Name: " & objItem.Name
    Wscript.Echo "Number of Color Planes: " & objItem.NumberOfColorPlanes
    Wscript.Echo "Number of Video Pages: " & objItem.NumberOfVideoPages
    Wscript.Echo "PNP Device ID: " & objItem.PNPDeviceID
    Wscript.Echo "Reserved System Palette Entries: " & _
        objItem.ReservedSystemPaletteEntries
    Wscript.Echo "Specification Version: " & objItem.SpecificationVersion
    Wscript.Echo "System Palette Entries: " & objItem.SystemPaletteEntries
    Wscript.Echo "Video Architecture: " & objItem.VideoArchitecture
    Wscript.Echo "Video Memory Type: " & objItem.VideoMemoryType
    Wscript.Echo "Video Mode: " & objItem.VideoMode
    Wscript.Echo "Video Mode Description: " & objItem.VideoModeDescription
    Wscript.Echo "Video Processor: " & objItem.VideoProcessor
Next 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T20:25:40.230

```
ManagementObjectSearcher searcher = new ManagementObjectSearcher("select AdapterRAM from 

    Win32_VideoController");

                    foreach (ManagementObject mo in searcher.Get())
                    {                            

                        double MemorySize = Convert.ToDouble(mo.Properties["AdapterRAM"].Value) / 1048576;

                        return MemorySize.ToString();
                    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T16:56:56.723

我们已经走上了 AdapterRAM 属性的路径，但这只是给了我们系统内存，与 Video Ram 无关。还有其他获取视频内存的方法吗？

# biztalk - BizTalk 2006 和 BizTalk 2006 R2

> ID：341248
> 
> 赞同：0
> 
> 时间：2008-12-04T16:41:00.047
> 
> 标签：biztalk, biztalk2006r2, biztalk-2006

如何通过仅查看它们的安装来区分这 2 个版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T17:00:37.933

您可以查看注册表 **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\BizTalk Server\3.0** 并查找**ProductCode_R2**键

顾名思义，我怀疑这是 R2 特有的密钥。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T15:49:53.267

如果您打开 BTSNTSvc.exe 文件的属性（默认位于 C:\Program Files\Microsoft BizTalk Server 2006），请转到版本选项卡并查看产品名称。如果是R2，它会在那里说。如果没有，它只会显示 Microsoft BizTalk Server 2006。

希望有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-16T21:58:56.900

从管理控制台（平台设置 -> 适配器）。如果您可以看到任何 WCF 适配器，则您有 R2...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-16T15:16:24.513

BizTalkMgmtDB 中有一个表 - BizTalkDBVersion。如果值为 v3.6.x 则为 BTS2006R2，否则 v3.5.x 为 BTS2006。

或者您可以使用注册表 - 在 HKLM\SOFTWARE\Microsoft\BizTalk Server\3.0 中，有一个 ProductVersionKey。同样，v3.6.x 的值告诉我们它是 BTS2006R2。

注意：版本号为标准.NET格式 Major.minor.build.revision，build 和 revision 由 SP 和累积更新决定。

# browser - PNG 图像不会在 IE7 或 Firefox 中显示，但在 Opera 中有效

> ID：341250
> 
> 赞同：1
> 
> 时间：2008-12-04T16:41:00.703
> 
> 标签：browser, png

我有一个网络服务，它创建一个 PNG 文件并返回一个链接。然后这个图形被一个网站（ASP.NET）使用。

IE7 和 Firefox 3 无法显示此图像，但在 Opera 9.5 中可以正常工作。

以前有没有人遇到过同样的问题？

编辑：内容类型设置为 image/png。该图像是使用第三方供应商提供的库创建的，该库不向公众提供。

有没有机会检查 png 文件是否符合标准？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T16:44:06.407

原则上，IE7和FF都可以显示PNG图片。看起来您的 PNG 不完全符合这些浏览器的渲染引擎（或标准？）。

如果不知道图像是如何创建的，就很难准确地判断问题出在哪里。您使用的是哪个库？你有示例代码吗？

编辑（阅读 Yuval A 的评论后）：您还可以检查您的 Web 服务器发送的 HTTP 响应是否为 PNG 图像设置了正确的内容类型。浏览器可能需要这样做才能正确显示图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T16:45:57.120

检查您的网络服务如何“返回链接”。它在 HTML 响应中是否正确表示？（即在具有正确**src的****IMG**标签中？）

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-29T20:25:49.227

原来 png 没有使用正确的 dpi 设置渲染。几个月后出现的一个微妙的错误。

# unit-testing - 单元测试如何让你的生活变得更好？

> ID：341251
> 
> 赞同：3
> 
> 时间：2008-12-04T16:41:07.067
> 
> 标签：unit-testing

好吧，老实说，我一生中写过的单元测试可能不超过 10 个。

我正在着手一个新项目，作为唯一的程序员意味着**我应该害怕......非常害怕**。

我可以**伪保证**我的软件可以工作的想法带来了一种快乐感。

当然，我会错过很多我应该测试的案例，但随着时间的推移，我会在这些案例中学习。

**单元测试将帮助我晚上睡得更好**，这对我的健康更有好处。

**我的代码会失败，但至少我会有一个更好的主意**。

**尽管您的团队的其他成员没有赶上潮流**，但单元测试如何让您的生活变得更好（或者有？）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T19:41:08.247

单元测试对我的项目最大的价值是**信心**。有了这种信心，添加一开始没有计划的新功能并拆分代码以更改某些内容或扭转这种情况会容易得多。

**通过测试，我知道**我（或其他任何人！）并没有破坏已经起作用的东西。

**如果没有测试，当您做出重大更改并在下一分钟将它们部署到生产中时，**您是勇敢的（或愚蠢的）。****

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T16:44:40.880

通过单元测试，我减少了在测试阶段报告的“愚蠢错误”的数量。这也让我对自己的代码更有信心。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-04T17:17:41.690

正如 Elie 所说，单元测试是尽早清除“愚蠢”或简单错误的好方法。对我来说，它改变了我对代码的看法；使我的代码可测试使其不那么脆弱和更灵活（例如，depenceny 注入/控制反转对我来说很自然，因为无论如何我都是为了测试目的而做的）。

我个人从一个完整的测试套件中获得的最大好处是即使在我编写复杂代码几个月后也有信心更改它，而不必担心意外破坏某些东西。

我还没有到那里，但是在编写它们时有一些纪律，单元测试也是记录代码的好方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-04T18:50:21.830

好的，因为没有其他人站出来扮演魔鬼的拥护者，我会这样做。

自动化单元测试可以为某些项目带来好处，但也可能存在以下许多问题：

*   它消耗了大量的工程资源。
*   从等式中消除环境和设置问题可能需要很多工时。
*   对于某些项目类型，尤其是 GUI，它的 ROI 较低。
*   它不会捕获很多错误，因为除了最琐碎的程序之外，不可能评估所有执行路径。
*   它不会捕获集成错误。
*   它不会捕获更广泛的系统级错误，例如跨多个单元执行的功能，或性能等非功能领域。
*   测试覆盖和覆盖门可能会成为越来越无用的口头禅
*   它需要一个可持续的过程来确保立即审查和解决测试用例失败。否则，应用程序将与单元测试套件不同步。
*   它具有巨大的机会成本——还有其他活动，例如代码审查，具有同样好的甚至更好的投资回报率。
*   它可能涉及重大的文化变革。

因此，开发人员不应该对单元测试采用教条（是或否）的方法，而是对每个项目进行 ROI 计算。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T16:53:53.983

将单元测试与 TDD 结合使用为我提供了完成手头任务的动力和动力。如果没有编写测试、修复测试、编写测试、修复测试的小进步，我会变得没有动力。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-04T17:24:40.287

当您开始调试时，单元测试也非常有用。如果您的测试失败，那么您几乎可以立即知道错误在哪里。如果它们都运行，那么您就知道错误*不在*哪里（大多数时候）。

单元测试帮助的另一个领域：迁移软件。我发现与没有单元测试的代码相比，准备将单元测试迁移到 Python 3 的 Python 代码要容易得多。

> 当然，我会错过很多我应该测试的案例，但随着时间的推移，我会在这些案例中学习。

这就是测试驱动开发真正闪耀的地方。您不必担心进行适当的测试，因为该问题会事先为您解答。

当然，为了确保我们在同一个页面上，“测试驱动开发”是指编写测试的编码过程，验证测试是否失败，然后编写代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-04T17:31:03.067

对我来说，改变我生活的不仅仅是单元测试，还有测试驱动开发 (TDD)。我在我的博客文章中把它比作宗教体验（我知道，无耻）[我的 TDD 年](http://www.houseofbilz.com/archive/2008/10/23/my-year-with-tdd.aspx)。

进入测试对我来说是一次改变职业的经历。我写的错误更少，我写的代码更易读，我写的代码更有凝聚力，我知道什么时候有问题（通常）等等。我把这一切都归功于测试驱动开发。

试试吧，你喜欢它:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-04T17:42:34.603

自从我在 uni 的第二个*项目（早在 1988 年）以来，我一直是一名 TDD（开发人员）。我不知道这个词当时是否还在使用。

最好的事情是能够改变事物并很快检查你没有破坏其他任何东西。简单的回归测试。

它们也是对象/方法使用的良好文档。

*这直接是因为第一个项目是如何进行的......

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-04T20:31:01.173

现在我培养测试驱动我的代码，**我知道我什么时候完成**了一个功能、一个组件或一个特性。因此我可以**准确地报告进度**。

我知道这不是没有错误的代码，但它的功能足以集成、构建和交付给 QA。我**相信**他们将能够开始测试而不会被分段错误或任何其他愚蠢的问题所阻止。

我还准备了一个环境，以便我可以快速编写一个新测试来**重现**将报告的任何问题，并且我有一个**安全网**来在我修改或修复代码时检测副作用和回归。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-05T00:51:08.387

单元测试给你的最大好处是对你的代码有信心。你知道东西在一定的质量水平上工作，你知道你可以进去改变或重写一些东西，而不会让事情在你不期望的地方失败。验证只是一个测试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-04T16:46:56.773

不能代表所有人，但我开始编写测试是因为一位开发人员编写的测试对我学习系统有很大帮助。

我还发现，在使用新代码库时，测试是验证假设的好方法。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-04T16:50:08.093

单元测试不是灵丹妙药。但它确实有好处，而且非常令人满意。

我发现这意味着我的代码执行得更早了，因为在我编写单元测试之前，在有足够的功能可以在应用程序中试用之前需要进行大量的编码。

当我来重构时，我也非常感谢我的单元测试套件。不久前我重写了一个完整的日期处理模块，如果没有回归测试，我不可能有信心做到这一点。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-04T17:09:33.390

我必须说，我认为 VS 2010 中的改进，例如 Ctrl+Enter（我认为就是这样）可以让您在编写测试（首先）时快速存根类的接口，这将大大提高对我来说更容易。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-04T19:50:57.463

单元测试的优点是多方面的。更具体地说，它如何让我的生活变得更好，嗯，我认为它增加了改变的信心，让我有可能在以后更快地改变代码。从长远来看，它增加了我的生命。

当然，我可以在短时间内告诉它有点痛苦，因为它需要更多时间，但是当你在进行这些测试时自动验证自己时，它很快就会被遗忘。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-04T21:01:00.163

我是单元测试的忠实粉丝，虽然我的测试现在不能提供完整的覆盖……主要是因为我在一个网站上工作，我的大部分代码只是从数据库中获取数据，操作它，然后吐出出来。操作代码通常经过良好测试，但测试数据库代码确实很痛苦。

话虽如此，我可以指出一个案例，单元测试为我节省了数周的工作......

不久前我在做一个小型项目（4-6 个开发人员），经过几个月的工作，我们已经接近完成的状态。此时，负责该产品的人员决定，与其在 GMT 中存储日期（并使用它们生成报告），不如在 EST 中存储所有内容。鉴于该产品旨在处理大量数据/日志并根据时间范围生成有关该数据的信息，因此这是一个相当大的变化。

在接下来的几天里，开发团队介入并改变了一切以处理 EST 时间戳。如果我们没有进行如此广泛的自动化测试，我们会花费数周时间完成的工作，只用了 3 天，让我们能够满足紧迫的时间表。我们能够跳入代码并开始更改我们需要的任何内容；单元测试给了我们勇气，因为我们知道如果我们破坏了某些东西，系统会很快抱怨。直到今天，我仍以那次经历为例说明在自动化测试拯救你之前，你永远无法真正理解自动化测试的好处……而且它确实为我的团队做到了这一点。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-04T16:45:14.890

我目前正在尝试赶上潮流。工作伙伴在编写一行功能代码之前就已经在这样做了。在我通过主程序运行它之前，我仍在编写一个完整的程序，更不用说单元测试了：/

我相信我最终会到达那里。但目前，我的健康状况不佳，因为我花了 90% 的时间在调试 :(

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-04T17:50:34.853

我在 Java 方面做了很多工作，在 Ruby 方面做了一年。

在 Ruby 中，我们使用了广泛的测试 (TDD)。这是绝对需要的。您可以将几乎完整的垃圾写入 Ruby 文件，如果您没有命中特定的代码行，您将永远不会知道，因此您的测试需要接近 100% 的覆盖率。

在 Java 中，我只需要一个简单的成功路径测试——通常在代码运行后就可以丢弃。真正让这成为可能的是静态类型检查、强类型和使用强封装和参数检查等编码模式。实际上，您可以非常接近证明一个小类在没有测试的情况下不能被破坏（没有错误），并且如果设计正确，所有类都应该很小。

另一个兴趣点：在 Ruby 项目中，我们进行了一次重构，花费了我们 2 天的实际代码工作（将主要模型类分成两个类）和 2 周的测试修复。

在某些时候，所有这些测试都是有代价的，它们仍然是你必须维护的代码。

就是说，我发现 TDD 很有趣，而且是开始工作的好方法，即使在 Java 中也是如此，而且我还要重申，我总是至少在几乎所有的方法中都有一些成功路径测试（即使它只是一个快速的主要方法）我写的课。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-04T19:47:12.713

提供足够覆盖率的良好单元测试可以让你晚上睡得更好。

如果您使用断言，您可以发现单元测试遗漏的潜在错误（有时它可能不够好），并且您可以在晚上睡得更好**。**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-06T22:16:50.507

它节省了我的时间，因为当我运行代码 TDD 时，它通常只适用于集成时间，因此无需花费大量时间进行调试。

这也让我有信心与其他声称我创建的 API 存在错误的开发人员进行对话。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-06T23:52:03.980

当你进行一些临界质量的测试时，一个很好的副作用通常是，如果你要引入一个错误，它可能会使一些测试失败，即使这些测试不是直接针对新的、有缺陷的代码你在写。

因此，在您提交之前，您将被警告您即将提交的错误，然后您可以针对它编写测试并立即修复它。

（当然，只有当您的测试不是“只是”非常狭窄的仅测试一件事的测试时，这才是正确的，但我认为情况往往如此。）

# iphone - 如何调整 UITableView 的 tableHeaderView 的大小？

> ID：341256
> 
> 赞同：103
> 
> 时间：2008-12-04T16:43:22.867
> 
> 标签：iphone, cocoa-touch, uitableview

我在调整 tableHeaderView 的大小时遇到​​问题。简单的不行。

1）创建一个UITableView和UIView（100 x 320 px）；

2）将UIView设置为UITableView的tableHeaderView；

3) 构建并运行。一切都好。

现在，我想调整 tableHeaderView 的大小，所以我在 viewDidLoad 中添加了这段代码：

```
self.tableView.autoresizesSubviews = YES;

self.tableView.tableHeaderView = myHeaderView;
self.tableView.tableFooterView = myFooterView;

CGRect newFrame = self.tableView.tableHeaderView.frame;
newFrame.size.height = newFrame.size.height + 100;
self.tableView.tableHeaderView.frame = newFrame; 
```

tableHeaderView 的高度应该显示为 200，但显示为 100。

如果我写：

```
self.tableView.autoresizesSubviews = YES;

CGRect newFrame = myHeaderView.frame;
newFrame.size.height = newFrame.size.height + 100;
myHeaderView.frame = newFrame;

self.tableView.tableHeaderView = myHeaderView;
self.tableView.tableFooterView = myFooterView; 
```

然后它从 200 的高度开始，如我所愿。但我希望能够在运行时修改它。

我也试过这个，但没有成功：

```
self.tableView.autoresizesSubviews = YES;

self.tableView.tableHeaderView = myHeaderView;
self.tableView.tableFooterView = myFooterView;

CGRect newFrame = self.tableView.tableHeaderView.frame;
newFrame.size.height = newFrame.size.height + 100;
self.tableView.tableHeaderView.frame = newFrame;

[self.tableView.tableHeaderView setNeedsLayout];
[self.tableView.tableHeaderView setNeedsDisplay];
[self.tableView setNeedsLayout];
[self.tableView setNeedsDisplay]; 
```

这里的重点是：**我们如何在运行时调整 tableHeaderView 的大小？？？**

有没有人能做到这一点？

谢谢

我

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2009-02-09T01:01:11.097

仅供参考：我已经通过修改 tableHeaderView 并重新设置它来实现这一点。在这种情况下，当 UIWebView 子视图完成加载时，我正在调整 tableHeaderView 的大小。

```
[webView sizeToFit];
CGRect newFrame = headerView.frame;
newFrame.size.height = newFrame.size.height + webView.frame.size.height;
headerView.frame = newFrame;
[self.tableView setTableHeaderView:headerView]; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-02-01T18:42:50.390

**这个答案很旧，显然不适用于 iOS 7 及更高版本。**

我遇到了同样的问题，我也想要动画的变化，所以我为我的标题视图创建了一个 UIView 的子类并添加了这些方法：

```
- (void)adjustTableHeaderHeight:(NSUInteger)newHeight{
    NSUInteger oldHeight = self.frame.size.height;
    NSInteger originChange = oldHeight - newHeight;

    [UIView beginAnimations:nil context:nil];

    [UIView setAnimationDuration:1.0f];
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:context:)];

    self.frame = CGRectMake(self.frame.origin.x, 
                        self.frame.origin.y, 
                        self.frame.size.width, 
                        newHeight);

    for (UIView *view in [(UITableView *)self.superview subviews]) {
        if ([view isKindOfClass:[self class]]) {
            continue;
        }
        view.frame = CGRectMake(view.frame.origin.x, 
                            view.frame.origin.y - originChange, 
                            view.frame.size.width, 
                            view.frame.size.height);
    }

    [UIView commitAnimations];
}

- (void)animationDidStop:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context{
    [(UITableView *)self.superview setTableHeaderView:self];
} 
```

这实质上为 UITableView 的所有子视图设置了动画，这些子视图与调用类的类类型不同。在动画结束时，它会在超级视图（UITableView）上调用 setTableHeaderView——如果没有这个，UITableView 的内容将在用户下次滚动时跳回。到目前为止，我发现的唯一限制是，如果用户在动画发生时尝试滚动 UITableView，则滚动将动画化，就好像标题视图没有调整大小一样（如果动画是快的）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-03-14T17:30:20.400

如果您想有条件地为更改设置动画，您可以执行以下操作：

```
- (void) showHeader:(BOOL)show animated:(BOOL)animated{

    CGRect closedFrame = CGRectMake(0, 0, self.view.frame.size.width, 0);
    CGRect newFrame = show?self.initialFrame:closedFrame;

    if(animated){
        // The UIView animation block handles the animation of our header view
        [UIView beginAnimations:nil context:nil];
        [UIView setAnimationDuration:0.3];
        [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];

        // beginUpdates and endUpdates trigger the animation of our cells
        [self.tableView beginUpdates];
    }

    self.headerView.frame = newFrame;
    [self.tableView setTableHeaderView:self.headerView];

    if(animated){
        [self.tableView endUpdates];
        [UIView commitAnimations];
    }
} 
```

请注意，动画分为两部分：

1.  下方单元格的动画`tableHeaderView`。这是使用`beginUpdates`和`endUpdates`
2.  实际标题视图的动画。这是使用`UIView`动画块完成的。

为了同步这两个动画，`animationCurve`必须将其设置为`UIViewAnimationCurveEaseInOut`，并将持续时间设置为`0.3`，这似乎是 UITableView 用于其动画的内容。

# 更新

我在 gihub 上创建了一个 Xcode 项目，它就是这样做的。查看[besi/ios-quickies](https://github.com/besi/ios-quickies)`ResizeTableHeaderViewAnimated`中的项目

![截屏](https://raw.github.com/besi/ios-quickies/master/ResizeTableHeaderViewAnimated/screenshot.png)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-07T03:40:14.737

I think it should work if you just set the height of myHeaderView like so:

```
CGRect newFrame = myHeaderView.frame;
newFrame.size.height = newFrame.size.height + 100;
myHeaderView.frame = newFrame;

self.tableView.tableHeaderView = myHeaderView; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-09-24T15:57:39.737

在 iOS 7 之前使用上述@garrettmoon 解决方案。
这是基于@garrettmoon 的更新解决方案：

```
- (void)adjustTableHeaderHeight:(NSUInteger)newHeight animated:(BOOL)animated {

    [UIView beginAnimations:nil context:nil];

    [UIView setAnimationDuration:[CATransaction animationDuration]];
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:context:)];

    self.frame = CGRectMake(self.frame.origin.x,
                        self.frame.origin.y,
                        self.frame.size.width,
                        newHeight);

    [(UITableView *)self.superview setTableHeaderView:self];

    [UIView commitAnimations];
}

- (void)animationDidStop:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context{
    [(UITableView *)self.superview setTableHeaderView:self];
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-11-27T00:29:27.097

这在 iOS 7 和 8 上对我有用。此代码在表视图控制器上运行。

```
[UIView animateWithDuration:0.3 animations:^{
    CGRect oldFrame = self.headerView.frame;
    self.headerView.frame = CGRectMake(oldFrame.origin.x, oldFrame.origin.y, oldFrame.size.width, newHeight);
    [self.tableView setTableHeaderView:self.headerView];
}]; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-09-19T21:08:37.357

因为tableHeaderView的setter。

您必须在设置 tableHeaderView 之前设置 UIView 高度。（如果Apple开源这个框架会容易得多......）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-01-23T12:37:23.993

在 iOS 9 及更低版本上，`tableHeaderView`调整大小后不会重新布局。此问题已在 iOS 10 中解决。

要解决此问题，只需使用以下代码即可：

```
self.tableView.tableHeaderView = self.tableView.tableHeaderView; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-11-28T05:57:17.180

**对于 swift 5 测试代码**

```
override func viewDidLayoutSubviews() {
      super.viewDidLayoutSubviews()

        guard let headerView = self.tblProfile.tableHeaderView else {
            return
        }

        let size = headerView.systemLayoutSizeFitting(UIView.layoutFittingCompressedSize)

        if headerView.frame.size.height != size.height {
            headerView.frame.size.height = size.height
            self.tblProfile.tableHeaderView = headerView
            self.tblProfile.layoutIfNeeded()
        }
    } 
```

**注意：**您需要给所有子视图的约束形式顶部、底部、前导、尾随。所以它会得到整个所需的大小。

**参考取自：** [https ://useyourloaf.com/blog/variable-height-table-view-header/](https://useyourloaf.com/blog/variable-height-table-view-header/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-06-06T17:31:47.133

在 iOS 9.x 上，这样做`viewDidLoad`效果很好：

```
var frame = headerView.frame
frame.size.height = 11  // New size
headerView.frame = frame 
```

`headerView`被声明为`@IBOutlet var headerView: UIView!`并连接在故事板上，它被放置在 tableView 的顶部，以用作 tableHeaderView。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-11-21T21:45:20.287

这仅适用于您使用自动布局并设置`translatesAutoresizingMaskIntoConstraints = false`为自定义标题视图时。

最好和最简单的方法是覆盖`intrinsicContentSize`. 内部`UITableView`用于`intrinsicContentSize`决定其页眉/页脚大小。在自定义视图中覆盖`intrinsicContentSize`后，您需要做的如下

1.  配置自定义页眉/页脚视图的布局（子视图）
2.  调用`invalidateIntrinsicContentSize()`
3.  调用`tableView.setNeedsLayout()`和`tableView.layoutIfNeeded()`

然后`UITableView`' 的页眉/页脚将根据需要更新。无需将视图设置为零或重置。

`UITableView.tableHeaderView`对or来说真正有趣的一件事`.tableFooterView`是它`UIStackView`失去了管理它的能力`arrangedSubviews`。如果要`UIStackView`用作 tableHeaderView 或 tableFooterView，则必须将 stackView 嵌入 a`UIView`并覆盖`UIView`'s `intrinsicContentSize`。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-01-20T02:51:26.257

设置标题视图属性的**高度**似乎不起作用，标题视图高度仍然没有按预期改变。`tableView.tableHeaderView``viewDidLoad`

经过多次尝试与这个问题作斗争。我发现，您可以通过调用 `- (void)didMoveToParentViewController:(UIViewController *)parent`方法内部的标题视图创建逻辑来更改高度。

所以示例代码如下所示：

```
- (void)didMoveToParentViewController:(UIViewController *)parent {
    [super didMoveToParentViewController:parent];

    if ( _tableView.tableHeaderView == nil ) {
        UIView *header = [[[UINib nibWithNibName:@"your header view" bundle:nil] instantiateWithOwner:self options:nil] firstObject];

        header.frame = CGRectMake(0, 0, CGRectGetWidth([UIScreen mainScreen].bounds), HeaderViewHeight);

        [_tableView setTableHeaderView:header];
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-06-06T09:19:49.123

如果自定义 headerView 是使用自动布局设计的，并且 headerView 需要在 web-fetch 或类似的惰性任务之后更新。然后在**iOS-Swift**中我这样做了，并使用以下代码更新了我的 headerView：

```
//to reload your cell data
self.tableView.reloadData()
DispatchQueue.main.async {
// this is needed to update a specific tableview's headerview layout on main queue otherwise it's won't update perfectly cause reloaddata() is called
  self.tableView.beginUpdates()
  self.tableView.endUpdates()
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-12-05T16:34:56.333

我发现 UIView 的 initWithFrame 初始化程序没有正确地尊重我传入的矩形。因此，我做了以下完美的工作：

```
 - (id)initWithFrame:(CGRect)aRect {

    CGRect frame = [[UIScreen mainScreen] applicationFrame];

    if ((self = [super initWithFrame:CGRectZero])) {

        // Ugly initialization behavior - initWithFrame will not properly honor the frame we pass
        self.frame = CGRectMake(0, 0, frame.size.width, 200);

        // ...
    }
} 
```

这样做的好处是它可以更好地封装到您的视图代码中。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-09-21T16:11:14.533

我已经实现了表格标题的动画高度变化，以便在点击时扩展到整个屏幕。但是，该代码可以在其他情况下提供帮助：

```
// Swift
@IBAction func tapped(sender: UITapGestureRecognizer) {

    self.tableView.beginUpdates()       // Required to update cells. 

    // Collapse table header to original height
    if isHeaderExpandedToFullScreen {   

        UIView.animateWithDuration(0.5, animations: { () -> Void in
            self.scrollView.frame.size.height = 110   // original height in my case is 110
        })

    }
    // Expand table header to overall screen            
    else {      
        let screenSize = self.view.frame           // "screen" size

        UIView.animateWithDuration(0.5, animations: { () -> Void in
            self.scrollView.frame.size.height = screenSize.height
        })
    }

    self.tableView.endUpdates()  // Required to update cells. 

    isHeaderExpandedToFullScreen= !isHeaderExpandedToFullScreen  // Toggle
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-06-06T12:23:59.827

## UITableView 调整标题 - 带有范围栏的 UISearchBar

我想要 a`UITableView`作为`UISearchBar`表的标题，所以我有一个看起来像这样的层次结构

```
UITableView
  |
  |--> UIView
  |     |--> UISearchBar
  |
  |--> UITableViewCells 
```

### UISearchBarDelegate 方法

如其他地方所述，如果您在更改后不 setTableViewHeader ，则不会发生任何事情。

```
- (BOOL)searchBarShouldBeginEditing:(UISearchBar *)searchBar
{
    searchBar.showsScopeBar = YES;
    [UIView animateWithDuration:0.2f animations:^{
        [searchBar sizeToFit];
        CGFloat height = CGRectGetHeight(searchBar.frame);

        CGRect frame = self.tableView.tableHeaderView.frame;
        frame.size.height = height;
        self.tableHeaderView.frame = frame;
        self.tableView.tableHeaderView = self.tableHeaderView;
    }];

    [searchBar setShowsCancelButton:YES animated:YES];
    return YES;
}

- (BOOL)searchBarShouldEndEditing:(UISearchBar *)searchBar
{
    searchBar.showsScopeBar = NO;
    [UIView animateWithDuration:0.f animations:^{
        [searchBar sizeToFit];

        CGFloat height = CGRectGetHeight(searchBar.frame);

        CGRect frame = self.tableView.tableHeaderView.frame;
        frame.size.height = height;
        self.tableHeaderView.frame = frame;
        self.tableView.tableHeaderView = self.tableHeaderView;
    }];

    [searchBar setShowsCancelButton:NO animated:YES];
    return YES;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-12-30T15:04:13.660

显然，到目前为止，Apple 应该已经为 tableHeaderView 和 tableFooterView 实现了 UITableViewAutomaticDimension ...

使用布局约束，以下内容似乎对我有用：

```
CGSize   s  = [ self  systemLayoutSizeFittingSize : UILayoutFittingCompressedSize ];
CGRect   f  = [ self  frame ];

f.size   = s;

[ self  setFrame : f ]; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-09-27T09:37:22.323

如果您的 tableHeaderView 是内容可调整的 webView，您可以尝试：

```
[self.webView.scrollView addObserver:self forKeyPath:@"contentSize" options:NSKeyValueObservingOptionNew context:nil];

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey,id> *)change context:(void *)context {
    self.webView.height = self.webView.scrollView.contentSize.height;
    self.tableView.tableHeaderView = self.webView;
} 
```

我在 iOS9 和 iOS11 上测试过，运行良好。

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2008-12-05T01:11:23.060

`[self.tableView reloadData]`改变高度后你试过 了吗？

# vba - 使用 VBA 在 Excel 单元格中编写公式

> ID：341258
> 
> 赞同：20
> 
> 时间：2008-12-04T16:43:50.883
> 
> 标签：vba, excel

我正在尝试使用 VBA 将公式写入 Excel 中的单元格。我的问题是，当我`;`在公式中使用分号 ( ) 时，出现错误：

> **`Run-time error 1004`**

我的宏如下：

```
Sub Jours_ouvres()
    Dim Feuille_Document As String
    Feuille_Document = "DOCUMENT"        
    Application.Worksheets(Feuille_Document).Range("F2").Formula = "=SUM(D2;E2)"    
End Sub 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-09T02:54:31.770

您可以尝试使用 FormulaLocal 属性而不是 Formula。然后分号应该起作用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-04T16:47:37.850

在这种情况下使用的正确字符是完整的冒号 ( `:`)，而不是分号 ( `;`)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-09T13:28:53.753

正确的字符（逗号或冒号）取决于目的。

逗号 ( `,`) 将仅对有问题的两个单元格求和。

冒号 ( `:`) 将把范围内的所有单元格与由这两个单元格定义的角相加。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-07-09T13:38:36.437

Treb, Matthieu 的问题是由于在非英语语言中使用 Excel 引起的。在许多语言版本中“;” 是正确的分隔符。甚至函数也会被翻译（SUM 可以是 SOMMA、SUMME 或其他任何内容，具体取决于您使用的语言）。Excel 通常会理解这些差异，如果巴西人打开法语创建的工作簿，他们通常不会有任何问题。但是**VBA**只会说美国英语，所以对于我们这些使用一种（或多种）外国语言的人来说，这可能会让人头疼。你和 CharlesB 都给出了对美国用户来说可以的答案，但 Mikko 理解了真正的问题并给出了正确的答案（这对我来说也是正确的答案 - 我是在意大利为讲德语的人工作的英国人公司）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-04T16:49:10.327

我不知道为什么，但如果你使用

```
(...)Formula = "=SUM(D2,E2)" 
```

(' ***,*** ' 而不是 ' ***;*** ')，它有效。

如果您在 VB 脚本编辑器 (F8) 中单步执行您的子程序，您可以添加`Range("F2").Formula`到监视窗口并从 VB 的角度查看公式。似乎Excel本身显示的公式有时与VB看到的公式不同......

# c# - 最大还是默认？

> ID：341264
> 
> 赞同：194
> 
> 时间：2008-12-04T16:45:03.877
> 
> 标签：c#, .net, linq, linq-to-sql

从可能不返回任何行的 LINQ 查询中获取最大值的最佳方法是什么？如果我只是这样做

```
Dim x = (From y In context.MyTable _
         Where y.MyField = value _
         Select y.MyCounter).Max 
```

当查询没有返回任何行时，我得到一个错误。我可以做

```
Dim x = (From y In context.MyTable _
         Where y.MyField = value _
         Select y.MyCounter _
         Order By MyCounter Descending).FirstOrDefault 
```

但是对于这样一个简单的请求，这感觉有点迟钝。我错过了更好的方法吗？

更新：这是背景故事：我正在尝试从子表中检索下一个资格计数器（旧系统，不要让我开始......）。每个患者的第一个资格行始终为 1，第二个为 2，依此类推（显然这不是子表的主键）。因此，我选择了患者的最大现有计数器值，然后将其加 1 以创建新行。当没有现有的子值时，我需要查询返回 0（因此添加 1 会给我一个计数器值 1）。请注意，我不想依赖子行的原始计数，以防旧应用程序在计数器值中引入间隙（可能）。试图使问题过于笼统，这对我不利。

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-12-04T21:58:28.173

Since `DefaultIfEmpty` isn't implemented in LINQ to SQL, I did a search on the error it returned and found a [fascinating article](http://www.interact-sw.co.uk/iangblog/2007/09/10/linq-aggregates) that deals with null sets in aggregate functions. To summarize what I found, you can get around this limitation by casting to a nullable within your select. My VB is a little rusty, but I **think** it'd go something like this:

```
Dim x = (From y In context.MyTable _
         Where y.MyField = value _
         Select CType(y.MyCounter, Integer?)).Max 
```

Or in C#:

```
var x = (from y in context.MyTable
         where y.MyField == value
         select (int?)y.MyCounter).Max(); 
```

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2010-04-07T14:05:32.243

I just had a similar problem, but I was using LINQ extension methods on a list rather than query syntax. The casting to a Nullable trick works there as well:

```
int max = list.Max(i => (int?)i.MyCounter) ?? 0; 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2008-12-04T18:04:13.733

听起来像一个案例`DefaultIfEmpty`（未经测试的代码如下）：

```
Dim x = (From y In context.MyTable _
         Where y.MyField = value _
         Select y.MyCounter).DefaultIfEmpty.Max 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2008-12-04T22:09:44.610

Think about what you're asking!

The max of {1, 2, 3, -1, -2, -3} is obviously 3\. The max of {2} is obviously 2\. But what is the max of the empty set { }? Obviously that is a meaningless question. The max of the empty set is simply not defined. Attempting to get an answer is a mathematical error. The max of any set must itself be an element in that set. The empty set has no elements, so claiming that some particular number is the max of that set without being in that set is a mathematical contradiction.

Just as it is correct behavior for the computer to throw an exception when the programmer asks it to divide by zero, so it is correct behavior for the computer to throw an exception when the programmer asks it to take the max of the empty set. Division by zero, taking the max of the empty set, wiggering the spacklerorke, and riding the flying unicorn to Neverland are all meaningless, impossible, undefined.

Now, what is it that you *actually* want to do?

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2008-12-04T16:56:19.580

您可以随时添加`Double.MinValue`到序列中。这将确保至少有一个元素，并且`Max`只有当它实际上是最小值时才会返回它。要确定哪个选项更有效（`Concat`或`FirstOrDefault`）`Take(1)`，您应该执行足够的基准测试。

```
double x = context.MyTable
    .Where(y => y.MyField == value)
    .Select(y => y.MyCounter)
    .Concat(new double[]{Double.MinValue})
    .Max(); 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-02-07T09:41:33.960

```
int max = list.Any() ? list.Max(i => i.MyCounter) : 0; 
```

If the list has any elements (ie. not empty), it will take the max of the MyCounter field, else will return 0.

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2015-01-07T17:11:16.073

Since .Net 3.5 you can use DefaultIfEmpty() passing the default value as an argument. Something like one of the followings ways:

```
int max = (from e in context.Table where e.Year == year select e.RecordNumber).DefaultIfEmpty(0).Max();
DateTime maxDate = (from e in context.Table where e.Year == year select e.StartDate ?? DateTime.MinValue).DefaultIfEmpty(DateTime.MinValue).Max(); 
```

The first one is allowed when you query a NOT NULL column and the second one is the way a used it to query a NULLABLE column. If you use DefaultIfEmpty() without arguments the default value will be that defined to the type of your output, as you can see in the [Default Values Table](http://msdn.microsoft.com/en-us/library/83fhsxwc.aspx) .

The resulting SELECT will not be so elegant but it's acceptable.

Hope it helps.

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-12-04T19:10:52.287

I think the issue is what do you want to happen when the query has no results. If this is an exceptional case then I would wrap the query in a try/catch block and handle the exception that the standard query generates. If it's ok to have the query return no results, then you need to figure out what you want the result to be in that case. It may be that @David's answer (or something similar will work). That is, if the MAX will always be positive, then it may be enough to insert a known "bad" value into the list that will only be selected if there are no results. Generally, I would expect a query that is retrieving a maximum to have some data to work on and I would go the try/catch route as otherwise you are always forced to check if the value you obtained is correct or not. I'd rather that the non-exceptional case was just able to use the obtained value.

```
Try
   Dim x = (From y In context.MyTable _
            Where y.MyField = value _
            Select y.MyCounter).Max
   ... continue working with x ...
Catch ex As SqlException
       ... do error processing ...
End Try 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-12-04T18:10:29.837

另一种可能性是分组，类似于您在原始 SQL 中的处理方式：

```
from y in context.MyTable
group y.MyCounter by y.MyField into GrpByMyField
where GrpByMyField.Key == value
select GrpByMyField.Max() 
```

The only thing is (testing again in LINQPad) switching to the VB LINQ flavor gives syntax errors on the grouping clause. I'm sure the conceptual equivalent is easy enough to find, I just don't know how to reflect it in VB.

The generated SQL would be something along the lines of:

```
SELECT [t1].[MaxValue]
FROM (
    SELECT MAX([t0].[MyCounter) AS [MaxValue], [t0].[MyField]
    FROM [MyTable] AS [t0]
    GROUP BY [t0].[MyField]
    ) AS [t1]
WHERE [t1].[MyField] = @p0 
```

The nested SELECT looks icky, like the query execution would retrieve all rows then select the matching one from the retrieved set... the question is whether or not SQL Server optimizes the query into something comparable to applying the where clause to the inner SELECT. I'm looking into that now...

I'm not well-versed in interpreting execution plans in SQL Server, but it looks like when the WHERE clause is on the outer SELECT, the number of actual rows resulting in that step is all rows in the table, versus only the matching rows when the WHERE clause is on the inner SELECT. That said, it looks like only 1% cost is shifted to the following step when all rows are considered, and either way only one row ever comes back from the SQL Server so maybe it's not that big of a difference in the grand scheme of things.

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-07-29T13:20:26.470

litt late, but I had the same concern...

Rephrasing your code from the original post, you want the max of the set S defined by

```
(From y In context.MyTable _
 Where y.MyField = value _
 Select y.MyCounter) 
```

Taking in account your last comment

> Suffice to say that I know I want 0 when there are no records to select from, which definitely has an impact on the eventual solution

I can rephrase your problem as: You want the max of {0 + S}. And it looks like the proposed solution with concat is semantically the right one :-)

```
var max = new[]{0}
          .Concat((From y In context.MyTable _
                   Where y.MyField = value _
                   Select y.MyCounter))
          .Max(); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-05-03T14:06:22.780

Why Not something more direct like:

```
Dim x = context.MyTable.Max(Function(DataItem) DataItem.MyField = Value) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-04T17:26:57.333

一个似乎值得注意的有趣区别是，虽然 FirstOrDefault 和 Take(1) 生成相同的 SQL（无论如何，根据 LINQPad），但 FirstOrDefault 返回一个值——默认值——当没有匹配的行并且 Take(1) 返回时没有结果……至少在 LINQPad 中。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-03-04T16:06:51.583

Just to let everyone out there know that is using Linq to Entities the methods above will not work...

If you try to do something like

```
var max = new[]{0}
      .Concat((From y In context.MyTable _
               Where y.MyField = value _
               Select y.MyCounter))
      .Max(); 
```

It will throw an exception:

> System.NotSupportedException: The LINQ expression node type 'NewArrayInit' is not supported in LINQ to Entities..

I would suggest just doing

```
(From y In context.MyTable _
                   Where y.MyField = value _
                   Select y.MyCounter))
          .OrderByDescending(x=>x).FirstOrDefault()); 
```

And the `FirstOrDefault` will return 0 if your list is empty.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-05T07:13:16.770

```
decimal Max = (decimal?)(context.MyTable.Select(e => e.MyCounter).Max()) ?? 0; 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-10-08T14:20:16.493

I've knocked up a `MaxOrDefault` extension method. There's not much to it but its presence in Intellisense is a useful reminder that `Max` on an empty sequence will cause an exception. Additionally, the method allows the default to be specified if required.

```
 public static TResult MaxOrDefault<TSource, TResult>(this 
    IQueryable<TSource> source, Expression<Func<TSource, TResult?>> selector,
    TResult defaultValue = default (TResult)) where TResult : struct
    {
        return source.Max(selector) ?? defaultValue;
    } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-06-08T17:05:23.217

For Entity Framework and Linq to SQL we can achieve this by defining an extension method which modifies an `Expression` passed to `IQueryable<T>.Max(...)` method:

```
static class Extensions
{
    public static TResult MaxOrDefault<T, TResult>(this IQueryable<T> source, 
                                                   Expression<Func<T, TResult>> selector)
        where TResult : struct
    {
        UnaryExpression castedBody = Expression.Convert(selector.Body, typeof(TResult?));
        Expression<Func<T, TResult?>> lambda = Expression.Lambda<Func<T,TResult?>>(castedBody, selector.Parameters);
        return source.Max(lambda) ?? default(TResult);
    }
} 
```

Usage:

```
int maxId = dbContextInstance.Employees.MaxOrDefault(employee => employee.Id);
// maxId is equal to 0 if there is no records in Employees table 
```

The generated query is identical, it works just like a normal call to `IQueryable<T>.Max(...)` method, but if there is no records it returns a default value of type T instead of throwing an exeption

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2013-07-12T11:17:26.313

I just had a similar problem, my unit tests passed using Max() but failed when run against a live database.

My solution was to separate the query from the logic being performed, not join them in one query.
I needed a solution to work in unit tests using Linq-objects (in Linq-objects Max() works with nulls) and Linq-sql when executing in a live environment.

(I mock the Select() in my tests)

```
var requiredDataQuery = _dataRepo.Select(x => new { x.NullableDate1, .NullableDate2 }); 
var requiredData.ToList();
var maxDate1 = dates.Max(x => x.NullableDate1);
var maxDate2 = dates.Max(x => x.NullableDate2); 
```

Less efficient? Probably.

Do I care, as long as my app doesn't fall over next time? Nope.

# database - 应用程序用户应该是数据库用户吗？

> ID：341271
> 
> 赞同：26
> 
> 时间：2008-12-04T16:46:40.520
> 
> 标签：database, security, authentication

我之前的工作涉及对一个包含大量数据的非常大的数据库进行维护和编程。用户主要通过 Intranet Web 界面查看这些数据。每个用户帐户都不是一个用户帐户表，而是 RDBMS 中真正的一流帐户，这允许他们连接自己的查询工具等，并允许我们通过 RDBMS 本身控制访问使用我们自己的应用程序逻辑。

假设您不在公共 Intranet 上并且与潜在的数百万（潜在恶意）用户打交道，这是一个好的设置吗？还是定义您自己的用户帐户处理方式、您自己的权限、您自己的应用程序安全逻辑，并且只将 RDBMS 帐户分发给有特殊需求的高级用户总是更好？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-04T17:07:22.490

*编辑：我应该澄清一下，尽管 OP 中有任何内容，但即使不存在代码，您所做的是在逻辑上定义应用程序。否则，它只是一个公共数据库，本身就有所有危险。*

也许我会因为这篇文章而被烧死，但**我认为这在安全和设计方面是一种非常危险的反模式**。

用户对象应该由运行它的系统定义。如果您实际上是在另一个应用程序（数据库）中定义它们，您将失去控制。

从设计的角度来看，这是没有意义的，因为如果您想使用任何类型的数据（电子邮件地址、员工编号、MyTheme ...）扩展这些帐户，您将无法扩展 DB 用户无论如何，您都需要构建该用户表。

数据库用户帐户本质上比应用程序定义的帐户中的任何东西都更危险，因为它们不仅可以被数据库和任何经过的 DBA 提升、删除、访问或以其他方式操纵，而且可以被连接到数据库的任何其他东西。您已经公开了一个关键系统元素。

缩放是不可能的。想象一下您将拥有数万或数十万用户的抽象。这不能作为数据库帐户进行管理，但作为表中的记录，它只是数据。“好吧，永远只有 X 用户”这一古老的论点对我来说站不住脚，因为当企业认为它可以为客户或公司增加价值时，我看到非常有限的内部应用程序被公开曝光刚被一个现在需要访问权限的大合作伙伴收购。您*必须*计划合理的可扩展性。

您将无法共享 conn 池，您不会比仅创建少数角色帐户更安全，并且您不一定能够在以下情况下影响大规模更改您需要，或有效地备份。

总而言之，对我来说似乎有许多严重的问题，我想其他更有经验的 SOers 可以列出更多。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-04T21:08:00.773

我不同意使用数据库进行用户访问控制与其他人所说的一样危险。我来自 Oracle Forms Development 领域，这种类型的用户访问控制是常态。就像任何设计决策一样，它有其优点和缺点。

优点之一是我可以从数据库中的单个设置控制每个表的选择/插入/更新/删除权限。在一个系统上，我们有 4 个不同的应用程序（由不同的团队以不同的语言管理）访问相同的数据库表。我们能够声明只有具有 Manager 角色的用户才能在特定表中插入/更新/删除数据。如果我们不通过数据库对其进行管理，那么每个应用程序团队都必须在整个应用程序中正确实现（复制）该逻辑。如果一个应用程序出错了，那么其他应用程序就会受到影响。另外，如果您想更改单个资源的权限，您将需要管理重复的代码。

另一个优点是我们不必担心将用户密码存储在数据库表中（以及随之而来的所有限制）。

我不同意“数据库用户帐户本质上比您的应用程序定义的帐户中的任何东西都更危险”。更改特定于数据库的权限所需的权限通常比更新/删除“PERSONS”表中的单行所需的权限要严格得多。

而且“扩展”不是问题，因为我们将权限分配给 Oracle 角色，然后将角色分配给用户。使用一条 Oracle 语句，我们可以更改数百万用户的权限（并不是说我们有那么多用户）。

应用程序授权不是一个小问题。许多定制解决方案都有黑客可以轻松利用的漏洞。Oracle 等大公司在提供强大的应用程序授权系统方面投入了大量精力和代码。我同意使用 Oracle 安全性并不适用于所有应用程序。但是我不会这么快就将其驳回以支持自定义解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T17:19:49.390

*“每个用户帐户都是 RDBMS 中真正的一流帐户，这允许他们连接自己的查询工具等。”*

如果 RDBMS 包含以下内容，则不是一个好主意：

*   HIPAA 或 Sarbanes-Oxley 或官方保密法（英国）涵盖的任何信息

*   信用卡信息或其他客户信用信息（采购订单、信用额度等）

*   个人信息（ssn、dob 等）

*   竞争、专有或知识产权信息

因为当用户可以使用他们自己的非托管查询工具时，公司无法知道或审核查询的信息或查询结果的发送位置。

哦，@annakata 说了什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-04T17:39:40.037

我觉得一般。在您的传统数据库应用程序中，它们不应该是。出于已经给出的所有原因。在传统的数据库应用程序中，有一个处理所有安全性的业务层，这是因为在与应用程序交互的人与与数据库交互的人之间存在如此紧密的界限。

在这种情况下，通常最好自己管理这些用户和角色。您可以决定需要存储哪些关于它们的信息，以及您记录和审核的内容。最重要的是，您根据纯业务规则而不是数据库规则定义访问。它与他们访问哪些表无关，与他们是否可以*在此处插入业务操作*无关。然而，这些都不是技术问题。这些都是设计问题。如果这是您需要控制的内容，那么您自己管理用户是有意义的。

您描述了一个允许用户直接查询数据库的系统。在这种情况下，为什么不使用数据库帐户。如果您尝试分析用户编写的查询并根据您设计的某些规则审查他们，他们将比您做得更好。对我来说，这听起来像是一个编写和维护的噩梦系统。

不要把事情锁起来，因为你可以。向负责人解释安全隐患是什么，但不要试图阻止人们做事，因为你可以。尤其是当他们习惯于直接访问数据时。

作为开发人员，我们的工作是让人们能够做他们需要做的事情。在你描述的情况下。专门连接数据库，用自己的工具查询。然后我认为除了数据库帐户之外的任何东西要么是不安全的，要么是不必要的限制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T17:08:59.087

我会避免给任何用户数据库访问权限。后来，当这开始引起问题时，取消他们的访问权限变得非常困难。

至少，让他们访问数据库的只读副本，这样他们就不会因查询错误而杀死您的整个公司。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T17:54:28.870

现在很多数据库查询工具都非常先进，仅仅为了添加限制而重新实现世界可能会感到非常耻辱。只要数据库用户权限被正确锁定就可以了。然而在很多情况下你不能这样做，你应该向数据库公开一个高级 API 以在许多表上正确插入对象，而不需要用户进行特定培训，他们应该“只需在该表中添加一个地址，为什么它不起作用？”。

如果他们只想使用数据在 Excel 等中生成报告，那么也许您可以使用像 BIRT 这样的报告前端。

所以基本上：如果用户了解数据库，并且实现适当前端的资源很少，请继续这样做。然而，如果资源确实出现了，可能是时候让人们的需求为他们创建一个更简单、面向任务的前端了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T19:46:22.980

这在某种程度上类似于：[sql server/AD 是否适用于任何事情](https://stackoverflow.com/questions/338535/is-sql-serverwindows-integrated-security-good-for-anything)

我认为将您的安全模型（至少是基本模型）放入数据库本身并不是一个坏主意。您可以在化妆品的应用层添加限制，但无论用户使用哪个帐户访问数据库，无论是基于应用程序还是基于用户，最好将该帐户限制为仅允许用户进行的操作。

我并不代表所有应用程序，但我见过很多应用程序捕获密码就像在记事本中打开代码一样简单，使用包含的 dll 解密配置文件，或查找备份文件（例如 web .config.bak in asp.net），可以从浏览器访问。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T22:40:42.723

*如果 RDBMS 包含以下内容，则不是一个好主意： * HIPAA 或 Sarbanes-Oxley 或 The Official Secrets Act (UK) 涵盖的任何信息 * 信用卡信息或其他客户信用信息（PO、信用额度等） * 个人信息（ssn , dob 等) * 竞争、专有或 IP 信息*

不正确，可以完美地管理数据库用户可以查看哪些数据以及可以修改哪些数据。数据库（至少是 Oracle）还可以审计所有活动，包括选择。拥有数以千计的数据库用户也是完全正常的。

构建良好的安全应用程序更加困难，因为您必须对这种安全性进行编程，数据库提供这种安全性，并且您可以以声明的方式对其进行配置，无需代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-11-11T08:57:29.573

我知道，我正在回复一个非常古老的帖子，但最近在我当前的项目中遇到了同样的情况。我也在考虑类似的问题，“应用程序用户是否是数据库用户？”。这是我分析的：

1.  绝对在数据库上创建大量应用程序用户是没有意义的（如果您的应用程序将被许多用户使用）。
2.  假设您在数据库上创建了 X（大量）用户。您正在为您的数据库打开一个清晰的门户。

让我们为解决方案提供一个场景：

有两种类型的应用程序用户（经理和助理）。两者都需要访问数据库以进行某些事务。

很明显，您将创建两个角色，一个用于数据库中的每种类型（经理和助理）。但是数据库用户如何从应用程序连接。如果您为每个用户创建一个帐户，那么您最终会在数据库上线性创建帐户。

我的建议：

1.  每个角色创建一个数据库帐户。（比方说`Manager_Role_Account`）
2.  让您的应用程序具有将应用程序用户映射到相应角色的业务逻辑。（具有 Manager 角色的用户 Tom 到`Manager_Role_Account`）
3.  `Manager_Role_Account`使用与#2 中识别的角色对应的数据库用户（ ）连接到数据库并执行您的查询。

希望这是有道理的！

更新：正如我所说，我在我的项目中遇到了类似的情况（关于后端的 Postgresql 数据库和前端的 Java Web 应用程序），我发现了一个非常有用的东西，称为**Proxy Authentication**。

这意味着您可以以一个用户身份登录数据库，但基于代理用户限制或扩展您的权限。我发现非常好的链接解释了相同的内容。

1.  对于下面的 Postgresql[选择 PostgreSQL 上金融应用程序的身份验证方法](https://dba.stackexchange.com/questions/25357/choice-of-authentication-approach-for-financial-app-on-postgresql/25400#25400?newreg=1ec2c9b4d9c84760b050a1128dc13098)

    2.  对于 Oracle[代理身份验证](https://docs.oracle.com/cd/B28359_01/java.111/b31224/proxya.htm)

希望这可以帮助！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T17:04:17.923

这取决于（像大多数事情一样）。

拥有多个数据库用户会否定连接池，因为大多数库基于连接字符串和用户帐户处理池。

另一方面，它可能比你或我从头开始做的任何事情都更安全。它将安全性留给操作系统和数据库服务器，我比我自己更信任它们。但是，只有在您努力配置好数据库权限时才会出现这种情况。如果您使用的是一堆具有相同权限的 OS/db 用户，那将无济于事。您仍然会获得审计跟踪，但仅此而已。

综上所述，我不知道让普通用户使用他们自己的工具直接连接到数据库是否会让我感到舒服。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-07T23:01:25.877

我认为值得强调其他答案所涉及的内容：

数据库只能根据数据定义限制。即限制特定表或列的选择/插入/更新/删除。我确信一些数据库可以做一些更聪明的事情，但它们永远无法像应用程序那样实现基于业务规则的限制。如果允许某个用户仅将列更新为某些值（例如 <1000）或仅提高价格，或者更改两列中的任何一列但不能同时更改两者，该怎么办？

我会说，除非你绝对确定除了表/列粒度之外你永远不需要任何东西，这本身就足够了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-24T10:44:54.350

对于您将多个用户的数据存储在同一个表中并且您不希望一个用户能够读取或修改另一个用户的数据的任何应用程序，这不是一个好主意。在这种情况下，您将如何限制访问？

# mysql - 字符集和排序规则到底是什么意思？

> ID：341273
> 
> 赞同：329
> 
> 时间：2008-12-04T16:47:01.703
> 
> 标签：mysql, database, database-design, character-set

我可以阅读*MySQL*文档，而且非常清楚。但是，如何决定使用哪个字符集？整理对哪些数据有影响？

我要求解释这两者以及如何选择它们。

* * *

## 回答 #1

> 赞同：532
> 
> 时间：2008-12-04T17:02:36.510

来自 MySQL[文档](http://dev.mysql.com/doc/refman/5.0/en/charset-general.html)：

> **字符集**是一组符号和编码。**排序**规则是一组用于比较字符集中的字符的规则。让我们通过一个假想字符集的例子来明确区分。
> 
> 假设我们有一个包含四个字母的字母表：“A”、“B”、“a”、“b”。我们给每个字母一个数字：'A' = 0, 'B' = 1, 'a' = 2, 'b' = 3。字母'A'是一个符号，数字0是'A'的编码, 所有四个字母及其编码的组合是一个字符集。
> 
> 现在，假设我们要比较两个字符串值“A”和“B”。最简单的方法是查看编码：0 表示“A”，1 表示“B”。因为 0 小于 1，所以我们说“A”小于“B”。现在，我们刚刚做的是对我们的字符集应用排序规则。排序规则是一组规则（在这种情况下只有一个规则）：“比较编码”。我们将所有可能的排序规则中最简单的称为二进制排序规则。
> 
> 但是如果我们想说小写字母和大写字母是等价的呢？那么我们至少有两条规则：（1）将小写字母'a'和'b'视为等同于'A'和'B'；(2) 然后比较编码。我们称之为不区分大小写的排序规则。它比二进制排序规则复杂一点。
> 
> 在现实生活中，大多数字符集都有许多字符：不仅仅是“A”和“B”，而是整个字母表，有时是多个字母表或具有数千个字符的东方书写系统，以及许多特殊符号和标点符号。同样在现实生活中，大多数排序规则都有许多规则：不仅不区分大小写，而且不区分重音（“重音”是附加到字符上的标记，如德语中的 'ö'）和多字符映射（例如 ' ö' = 'OE' 在两个德语排序规则之一中）。

* * *

## 回答 #2

> 赞同：212
> 
> 时间：2008-12-04T17:06:24.957

[字符编码](http://en.wikipedia.org/wiki/Character_encoding)是一种对字符进行编码以使其适合内存的方法。也就是说，如果字符集是 ISO-8859-15，欧元符号 € 将被编码为 0xa4，而在 UTF-8 中，它将被编码为 0xe282ac。

[排序](http://en.wikipedia.org/wiki/Collation)规则是如何比较字符，在`e é è ê f`latin9`e f é ê è`中，有字母为会是，所有的`e é è ê`都是平等的，然后`f`.

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-12-04T17:42:29.627

字符集是所有书面字形的子集。字符编码指定这些字符如何映射到数值。一些字符编码，如 UTF-8 和 UTF-16，可以对通用字符集中的任何字符进行编码。其他的，如 US-ASCII 或 ISO-8859-1 只能编码一个小子集，因为它们分别使用每个字符 7 位和 8 位。因为许多标准都指定了字符集和字符编码，所以术语“字符集”经常被自由地替换为“字符编码”。

排序规则包含指定如何比较字符以进行排序的规则。排序规则可以是特定于语言环境的：两个字符的正确顺序因语言而异。

选择字符集和排序规则取决于您的应用程序是否国际化。如果不是，您的目标是什么语言环境？

为了选择您想要支持的字符集，您必须考虑您的应用程序。如果您要存储用户提供的输入，则可能很难预见您的软件最终将在哪些语言环境中使用。为了支持所有这些，最好从一开始就支持 UCS (Unicode)。但是，这是有代价的；许多西欧字符现在每个字符需要两个字节的存储空间，而不是一个。

如果您的数据库使用排序规则创建索引，然后使用该索引提供排序结果，则选择正确的排序规则有助于提高性能。但是，由于排序规则通常是特定于语言环境的，如果您需要根据另一个语言环境的规则对结果进行排序，那么该索引将毫无价值。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-03-06T11:58:38.647

我建议使用`utf8mb4_unicode_ci`，它基于 Unicode 标准进行排序和比较，可以在非常广泛的语言中准确排序。

# sql-server - JDBC java驱动程序sql server 2005

> ID：341274
> 
> 赞同：3
> 
> 时间：2008-12-04T16:47:13.107
> 
> 标签：sql-server, performance, jdbc

我们正在将我们的服务器从 SQL Server 2000 升级到 SQL Server 2005。我们目前使用 jtds 驱动程序。

我很想知道人们对可用的不同 jdbc 驱动程序（特别是最新的 Microsoft 驱动程序）的看法，它们在 SQL Server 2005 中的表现以及您集体经验中的任何其他教训。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-29T04:43:13.380

我使用了 MS 提供的驱动程序、jtds 驱动程序以及来自 jnetdirect 的驱动程序。

不幸的是，它们都不是完美的，并且都有自己的错误（当然包括微软自己的）。MS 提供的驱动程序当然比其他供应商更支持最新功能，但我必须说，我很少看到驱动程序之间存在显着的性能差异。

我的建议是确保您的应用程序从某处的属性文件中读取驱动程序名称和连接 URL，以便在遇到问题时可以轻松地在驱动程序之间切换。你以后会很高兴的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T19:07:29.253

我们尝试将 Microsoft JDBC Driver 2.0 与 SQL Server 2005 一起使用。我们遇到的问题是 - 在调用存储过程时，驱动程序正在生成以下 sql 语句 -

```
declare @P1 int
set @P1=1
exec sp_prepexec @P1 output, N'@P0 int', N'EXEC getEmployeeManagers @P0', 50
select @P1 
```

所以存储过程在`sp_prepexec`语句中运行。稍后当您关闭该语句时，`sp_unprepare`将调用该语句。这似乎是 MS 驱动程序的默认行为。这样做的问题是，生成准备好的语句然后关闭它的开销会影响性能。为什么司机不能这样做——

```
exec getEmployeeManagers @P0=50 
```

我们现在正在使用 jTDS 驱动程序，它似乎表现得很好。

# c - 将动态数组传递给 C 中的函数

> ID：341282
> 
> 赞同：6
> 
> 时间：2008-12-04T16:48:08.940
> 
> 标签：c, arrays, function, realloc

我正在尝试创建一个函数，该函数将数组作为参数，向其添加值（必要时增加其大小）并返回项目数。到目前为止，我有：

```
int main(int argc, char** argv) {
    int mSize = 10;
    ent a[mSize];
    int n;
    n = addValues(a,mSize);

    for(i=0;i<n;i++) {
       //Print values from a
    }
}

int addValues(ent *a, int mSize) {
    int size = mSize;

    i = 0;

    while(....) { //Loop to add items to array
        if(i>=size-1) { 
            size = size*2;
            a = realloc(a, (size)*sizeof(ent));
        }
        //Add to array
        i++;
    }
    return i;
} 
```

如果 mSize 足够大以容纳数组的所有潜在元素，则此方法有效，但如果需要调整大小，则会出现分段错误。

我也试过：

```
int main(int argc, char** argv) {
    ...
    ent *a;
    ...
}

int addValues(ent *a, int mSize) {
    ...
    a = calloc(1, sizeof(ent);
    //usual loop
    ...
} 
```

无济于事。

我认为这是因为当我调用 realloc 时，'a' 的副本指向其他地方 - 如何修改它以使 'a' 始终指向相同的位置？

我这样做对吗？有没有更好的方法来处理 C 中的动态结构？我应该实施一个链接列表来处理这些吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-04T16:51:15.597

这里的主要问题是您试图将 realloc 与堆栈分配的数组一起使用。你有：

```
ent a[mSize]; 
```

这是堆栈上的自动分配。如果您想稍后在此使用 realloc()，您将使用 malloc() 在堆上创建数组，如下所示：

```
ent *a = (ent*)malloc(mSize * sizeof(ent)); 
```

这样 malloc 库（以及 realloc() 等）就知道你的数组了。从这点看，您可能会将[C99 可变长度数组](http://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html)与真正的[动态数组](http://en.wikipedia.org/wiki/Dynamic_array)混淆，因此在尝试解决此问题之前，请确保您了解其中的区别。

但是，实际上，如果您正在用 C 编写动态数组，您应该尝试使用 OOP-ish 设计来封装有关您的数组的信息并将其对用户隐藏。您希望将有关数组的信息（例如指针和大小）整合到一个结构中，并将操作（例如分配、添加元素、删除元素、释放等）整合到与您的结构一起使用的特殊函数中。所以你可能有：

```
typedef struct dynarray {
   elt *data;
   int size;
} dynarray; 
```

您可能会定义一些函数来使用 dynarrays：

```
// malloc a dynarray and its data and returns a pointer to the dynarray    
dynarray *dynarray_create();     

// add an element to dynarray and adjust its size if necessary
void dynarray_add_elt(dynarray *arr, elt value);

// return a particular element in the dynarray
elt dynarray_get_elt(dynarray *arr, int index);

// free the dynarray and its data.
void dynarray_free(dynarray *arr); 
```

这样用户就不必确切地记住如何分配东西或数组当前的大小。希望这能让你开始。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T16:50:56.640

尝试对其进行修改，以便传入指向数组指针的指针，即`ent **a`. 然后，您将能够在数组的新位置更新调用者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T16:54:45.073

您正在按值传递数组指针。这意味着：

```
int main(int argc, char** argv) {
    ...
    ent *a; // This...
    ...
}

int addValues(ent *a, int mSize) {
    ...
    a = calloc(1, sizeof(ent); // ...is not the same as this
    //usual loop
    ...
} 
```

所以改变函数中a的`addValues`值不会改变main中a的值。要更改 a in main 的值，您需要将对它的引用传递给`addValues`. 目前， a 的值正在被复制并传递给`addValues`。传递对使用的引用：

```
int addValues (int **a, int mSize) 
```

并称之为：

```
int main(int argc, char** argv) {
    ...
    ent *a; // This...
    ...
    addValues (&a, mSize);
} 
```

在 中`addValues`，像这样访问 a 的元素：

```
(*a)[element] 
```

并像这样重新分配数组：

```
(*a) = calloc (...); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T16:57:31.743

这是使用 OOP 的一个很好的理由。是的，您可以在 C 上执行 OOP，如果操作正确，它甚至看起来不错。

在这个简单的情况下，您不需要继承也不需要多态性，只需要封装和方法概念：

*   定义一个具有长度和数据指针的结构。也许是元素大小。
*   编写对指向该结构的指针进行操作的 getter/setter 函数。
*   'grow' 函数修改结构中的数据指针，但任何结构指针都保持有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T21:03:16.680

如果您将 main 中的变量声明更改为

```
ent *a = NULL; 
```

通过不释放堆栈分配的数组，代码将更像您想象的那样工作。将 a 设置为 NULL 是可行的，因为 realloc 将其视为用户调用了 malloc(size)。请记住，通过此更改， addValue 的原型需要更改为

```
int addValues(ent **a, int mSize) 
```

并且代码需要处理 realloc 失败的情况。例如

```
while(....) { //Loop to add items to array
    tmp = realloc(*a, size*sizeof(ent));
    if (tmp) {
        *a = tmp;
    } else {
        // allocation failed. either free *a or keep *a and
        // return an error
    }
    //Add to array
    i++;
} 
```

如果当前缓冲区需要调整大小以制作原始代码，我希望 realloc 的大多数实现将在内部分配两倍的内存

```
size = size * 2; 
```

不必要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T16:58:25.330

Xahtep 解释了调用者如何处理 realloc() 可能将数组移动到新位置的事实。只要你这样做，你应该没问题。

如果您开始使用大型数组， realloc() 可能会变得昂贵。那时是开始考虑使用其他数据结构的时候了——链表、二叉树等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T17:02:24.933

如前所述，您应该将指针传递给指针以更新指针值。
但我建议重新设计并避免这种技术，在大多数情况下可以而且应该避免。在不知道您到底想要实现什么的情况下，很难提出替代设计，但我 99% 确信它可以通过其他方式实现。正如[Javier](https://stackoverflow.com/questions/341282/passing-a-dynamic-array-in-to-functions-in-c#341317)悲伤的那样——考虑面向对象，你总会得到更好的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-06T00:15:42.747

你真的需要使用C吗？这将是 C++ 的“std::vector”的一个很好的应用，它恰好是一个动态大小的数组（只需一次调用即可轻松调整大小，您不必自己编写和调试）。

# passwords - 为什么银行密码如此脆弱？

> ID：341290
> 
> 赞同：21
> 
> 时间：2008-12-04T16:50:10.230
> 
> 标签：passwords, onlinebanking

*出于兴趣，因为它激怒了我，我想知道这里的某人是否会碰巧为一家银行工作，或者知道这个问题的答案。*

我使用了一些在线银行网站（英国和北美），它们普遍强制执行密码模式`/[\w\d]{6,8}/`有时，也许你可以使用下划线，但你永远不会得到`/.{6,20}/`你得到的（或多或少）几乎所有您会遇到的 !banking 网站。

有人告诉我这与存储空间有关，但数学似乎不支持这一点。假设银行为您的密码记录保留影子表，假设每个帐户平均 10 个，那么密码的允许长度加倍，并且基于 8char 8bit 现有格式的字符集的位宽加倍意味着*额外的*11* 2*8 = 每个账户 176 字节，因此每 1M 账户约 168Mb。假设它是一个支持 100M 帐户的巨型银行 - 仍然只有 16Gb！

不可能这么简单吧？我的数字肯定是离谱的。

或者这里的答案是，银行是银行，他们没有比他们笨拙的恐龙更好的理由。

有谁知道为什么我的 www.random.com/forum 的密码比我的银行密码强的技术原因？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-07-21T11:43:29.347

如果我听说的关于某些银行的故事是真的……

这是因为每当您输入密码时：

*   Web 服务器通过半公里长的串行电缆将其发送到废弃办公室中的旧 386，运行 UI（使用定制的 Borland C 1.0 版本编译），该 UI 由银行经理在 1989 年使用，没有串行接口，因此它必须通过另一个模拟 AT 键盘上的按键的设备。
*   该程序将您的请求，包括您的密码（使用一种太弱而无法再使用但无法在软件中禁用的自定义算法加密）插入到位于另一端的另一个废弃办公室的 NetWare 文件服务器上的 FoxPro 数据库中建筑物（只是因为如果他们试图移动它会掉下来。）
*   回到第一个废弃办公室，另一台旧 386 不断轮询 FoxPro 数据库以获取新记录，检测到此请求并通过更慢的串行电缆（这次是 EBCDIC）将其转发到第三个办公室的另一个盒子，该盒子正在模拟 PDP11 运行维护帐户的实际 COBOL 程序。
*   不幸的是，他们仍然需要*真正的*PDP11，因为它具有用于另一种安全加密算法的自定义微码（他们无法提取或防篡改设备将删除它。） PDP11 无法处理所有已开账户的增加的工作量自 1981 年（他们第一次尝试将其退役但未成功的那一年），所以现在（通过另一层屏幕抓取工具和模拟硬盘）它被欺骗代表主服务器执行部分功能（包括密码验证）。

因此，您的密码只能使用所有这些系统支持的字符集的公共子集，并且只能与所涉及的最短数据库字段一样长。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-12-04T16:54:14.810

我现在实际上在一家银行工作，过去也工作过不少。

发生这种情况的主要原因是，通常最终负责做出这些决定的人不是最终实施这些决定的人。银行的“业务部门”是最终做出这些决策的非技术业务专家。在许多情况下，出于政治或商业原因，技术异议会被否决。但这并不是银行业独有的。它发生在技术考虑通常不是主要问题的任何行业。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-07-21T12:07:51.527

银行主要将在线服务用作遗留系统的接口。您的密码可能正在某个地方的 IBM 大型机处理，用 Cobol 编写，并且密码结构可能是在 70 年代设计的。

此外，由于银行是这样的政治结构，管理层主要看到的是“具体”结果，因此安全等问题直到成为热点问题后才有“主动性”解决。

在我工作的一家银行，生产密码与用户 ID 相同（与使用“root”“root”登录的想法相同）。用户密码可以在线重置为您姓氏的前N个字母+您的SSN后4位的组合，因此任何知道您的姓名和SSN并以您身份登录的用户都可以重置您的密码。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-04T17:03:07.833

可能大多数银行系统都是很久以前开发的，当时 8 个字符的密码被认为是安全的。无论如何，我认为没有人会考虑从银行账户中强制使用密码，8 个字符仍然很多。我敢打赌，所有银行都会在 3 次左右尝试后冻结一个帐户。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-21T11:49:45.073

这是我在 Bugzilla 中登录的一个“错误”，涉及我最近为客户（不是银行，谢天谢地！）建立的网站：

> “似乎用户被迫在他们的密码*中使用 ! 或 _，这对我来说似乎有点奇怪。可以将其更新为只能使用字母数字的 6 - 8 位密码吗？”

*   *实际上，它至少是一个非字母数字字符*

# html - 使用 Flex/AIR HTML 组件访问 HTTPS 网站？

> ID：341292
> 
> 赞同：1
> 
> 时间：2008-12-04T16:50:30.603
> 
> 标签：html, apache-flex, https, air, payment

在 Flex AIR 应用程序中使用 HTML 组件时，是否可以通过 https 访问远程页面？

我正在寻找将信用卡支付集成到 AIR 应用程序中，简单的方法是将用户发送到嵌入应用程序的浏览器中的支付服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T18:01:18.667

是的，根据文档，您可以： [http ://livedocs.adobe.com/flex/3/html/help.html?content=ProgrammingHTMLAndJavaScript_05.html](http://livedocs.adobe.com/flex/3/html/help.html?content=ProgrammingHTMLAndJavaScript_05.html)

尝试使用任何 https 网站：

```
<mx:HTML id="content">
    <mx:location><![CDATA[https://www.fldemo.nsf.gov/]></mx:location>
</mx:HTML> 
```

# visual-c++ - 64位可移植性问题

> ID：341303
> 
> 赞同：1
> 
> 时间：2008-12-04T16:53:33.797
> 
> 标签：visual-c++, 64-bit, size-t

所有这一切都源于我在尝试以下行时戳编译器警告消息（C4267）：

```
const unsigned int nSize = m_vecSomeVec.size(); 
```

`size()`返回一个 size_t，虽然 typedef'd 为 unsigned int，但实际上不是 unsigned int。我认为这与 64 位可移植性问题有关，但是有人可以为我解释一下吗？（我不只是想禁用 64 位警告。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T17:15:58.620

这取决于实施。`std::size_t`例如具有最小所需大小。但是没有上限。为避免此类情况，请始终使用正确的 typedef：

```
const std::vector<T>::size_type nSize = m_vecSomeVec.size(); 
```

那时你将永远安全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T17:04:41.917

当为 64 位平台编译时，`size_t`将是 64 位类型。因此，Visual Studio 会在启用“检测 64 位可移植性问题”时发出有关将`size_t`s分配给 s 的警告。`int`

`size_t`Visual C++通过`__w64`令牌获取这些信息，例如`__w64 unsigned int`.

有关 64 位移植问题的更多信息，请参阅以下链接。 [http://www.viva64.com/en/a/0065/](http://www.viva64.com/en/a/0065/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T17:03:35.150

如果`size_t`是 typedef:ed to `unsigned int`，那么它当然是`unsigned int`, 在您的特定平台上。但是它是抽象的，所以你不能依赖它*总是*一个`unsigned int`，它可能在其他平台上更大。

可能它没有被做得更大，因为这样做会花费太多，例如，其中包含超过 2^32 个项目的向量并不常见。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T17:06:07.297

根据编译器的不同，`int`在 64 位域中可能是 32 位。

# svn - 列出特定用户在 subversion 中更改的所有文件

> ID：341310
> 
> 赞同：68
> 
> 时间：2008-12-04T16:55:40.687
> 
> 标签：svn

是否可以获得特定用户修改/添加/删除的所有文件的列表？

目标是了解用户当天（或日期范围）做了什么。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-04T17:35:57.703

这是一个示例，使用[svn log 命令](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.log.html)和[linux sed 命令](http://www.google.com/search?hl=en&q=linux+sed+command)，用户名 'blankman'：

```
svn log | sed -n '/blankman/,/-----$/ p' 
```

如果您希望通过持续报告获取此信息，那么使用Patrick 提到的[StatSVN 之](http://www.statsvn.org/)类的项目非常有用。如果您使用的是[Maven](http://maven.apache.org/)，则有一个[StatSCM 插件](http://stat-scm.sourceforge.net/)，它将在您的项目站点上生成此信息。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-12-05T11:00:33.190

从 Subversion 1.8 开始，无需担心`grep`,等。[该版本引入](http://subversion.apache.org/docs/release-notes/1.8.html#svn-log-search)[了您可以与](http://subversion.apache.org/docs/release-notes/1.8.html#svn-log-search)[命令](http://subversion.apache.org/docs/release-notes/1.8.html#svn-log-search)一起使用的选项！`sed`[`--search``svn log`](http://subversion.apache.org/docs/release-notes/1.8.html#svn-log-search)

这些选项允许您搜索存储库历史记录：

*   修订的作者（`svn:author`未版本化的属性），
*   日期（`svn:date`未版本化的属性），
*   记录消息文本（`svn:log`未版本化的属性），
*   以及受特定修订影响的路径。

见[SVNBook 1.8 | `svn log`命令行参考](http://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.log.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-08-15T20:58:44.620

Shek 的回答帮助我完成了我需要做的事情，但我发现通过以下调整我得到了更准确的结果：

```
svn log | sed -n '/ | blankman | /,/-----$/ p' 
```

否则，该列表包括其他人所做的仅按名称引用我的提交。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-20T16:29:33.410

为什么不简单地使用乌龟 SVN 呢？

Totoise SVN --> Show Log 在左上角添加您希望查看更改列表的用户 ID

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-05-30T17:25:17.610

这对我有用：

```
svn log  | grep YOUR_USERNAME_HERE | awk '{print $1}' | sed s/r//g | xargs -I $ svn diff --summarize -c $ | sort | uniq 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-04T17:37:15.080

是的。我们将[StatSVN](http://www.statsvn.org/)用于我们的颠覆报告，它所做的报告之一是开发人员提交的。

TortiseSVN 还允许您按日期查看作者的日志消息。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-02-18T09:17:59.147

这是日期范围版本

> svn log -v -r{"2011-01-01 00:00:00"}:{"2011-02-18 00:00:00"}| sed -n '/russenreaktor/,/-----$/ p'

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-08-20T14:49:28.293

我发现这个有用的命令可以查找给定用户修改文件的列表：

```
svn log -v -r{2012-08-01}:HEAD 
| awk '/^r[0-9]+ / {user=$3} /./ {if (user=="username") {print}}'
| grep -E "^   M|^   G|^   A|^   D|^   C|^   U" 
| awk '{print $2}'
| sort | uniq 
```

[以及原始文章](http://www.commandlinefu.com/commands/view/2362/gets-all-files-committed-to-svn-by-a-particular-user-since-a-particular-date)的链接。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-14T13:44:08.787

这是一个小脚本，用于显示某个用户在修订之间更改了哪些文件。

```
#!/bin/bash
# @param $1: Start revision
# @param $2: End revision
# @param $3: User
#
# Example: svn_scapegoat.sh 1000:HEAD jdoe

svn_changed()
{
    svn blame --revision $1:$2 -- $4 | grep -E "^ [0-9]* *${3} "
}

svn diff --revision $1:$2 --summarize | \
cut -c9- | \
while read path
do
    if [ -n "$(svn_changed $1 $2 $3 $path)" ]
    then
        echo "$3 changed $path"
    else
        echo "Someone else changed $path"
    fi
done 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2015-09-02T05:03:23.667

为了查看特定用户在 subversion 中针对特定目录结构更改的所有文件的列表，首先您需要转到该目录结构并在目录面板的右侧右键单击.. 然后转到 Show登录->在最左上角我们得到过滤选项。

此后，通过输入用户名，您可以在底部面板中看到该特定用户更改的所有文件。

# sql - 需要 SQL 帮助 - 如何选择行来执行插入？

> ID：341315
> 
> 赞同：2
> 
> 时间：2008-12-04T16:57:08.767
> 
> 标签：sql, sql-server, tsql

我试图使标题尽可能清晰......这是我的场景：

我有 2 个具有相似架构的表（我们称它们为表 A 和表 B）。我想编写一个存储过程，从表 A 中选择特定的数据列，并将这些数据作为新记录插入到表 B 中。

有人可以指出我的写作方向来进行这样的查询吗？我不确定如何“保留”第一个查询中的值，以便我可以执行插入。

我试图避免进行查询，使用 C# 处理它，然后进行另一个查询...

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T17:00:12.100

```
INSERT INTO B (Col1, Col2) SELECT Col1, Col2 FROM A 
```

你是这个意思吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T17:00:07.030

您可以将其作为来自 C# 的单个查询来执行，如下所示：

```
Insert into tableB (col1, col2, col3) select col1, col2, col3 from tableA where ... 
```

诀窍是列名需要具有相同的顺序和兼容的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T17:02:46.587

使用 SELECT INTO

```
SELECT
    [Col1],
    [COl2]
INTO TableA
FROM TableB 
```

# sql-server - SQL Server Express：用户实例问题

> ID：341325
> 
> 赞同：2
> 
> 时间：2008-12-04T17:00:31.973
> 
> 标签：sql-server, sql-server-2005, sql-server-express

问候——为了自动测试我们的数据库 SPROC，我们一直在用户实例中使用动态创建的数据库。这一直工作得很好——构建服务器，直到最近，所有的开发人员都可以运行测试。但是，当我们尝试连接到用户实例时，我们的一台开发人员机器现在返回以下错误：

> 由于启动用户实例的进程失败，无法生成 SQL Server 的用户实例。连接将被关闭。

这是日志文件的内容：

> 2008-12-04 10:46:29.77 登录
> 错误：15372，严重性：16，状态：1。 2008-12-04 10:46:29.77
> 由于启动失败，登录无法生成 SQL Server 的用户实例用户实例的进程。连接将被关闭。[客户： ]

**到目前为止我为修复它所做的工作**

*   已删除 C:\Documents and Settings[用户名]\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data
*   将 SQL 服务更改为作为“本地系统”而不是“网络服务”运行</li>
*   卸载 SQL Express，删除所有数据目录（例如“MSSQL.1”），然后重新安装 SQL Express

这些“修复”都没有解决问题。它曾经在有问题的机器上工作，我们希望不必重新铺设它。

请帮忙！！！

谢谢 - 乔丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T17:34:56.863

好的，我再次尝试了上述所有修复，然后我重新启动了整个系统，它似乎可以工作。奇怪的！我过去曾重新启动过我的系统，但看起来您必须先应用这些修复程序，然后再重新启动。我想我会尝试将服务切换回作为网络服务登录。

谢谢 - 乔丹

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-14T00:31:57.877

我在我的 azure VM 上发现了同样的问题。然后我打开 SQL Server 配置管理器，打开 SQL Server 网络配置，-Protocols 发现“命名管道”和“TCP/IP”被禁用。我启用了它们，错误消失了。

# asp.net - asp.net - 构建linkedin风格的照片裁剪器

> ID：341327
> 
> 赞同：0
> 
> 时间：2008-12-04T17:00:49.210
> 
> 标签：asp.net, photo-management

在linkedin.com 上，您可以为您的个人资料管理的照片可以从照片中选择一个“区域”进行裁剪并用作您的个人资料图片。

我假设它将原始图片上传到服务器，然后存储左上角的x，y以及宽度和高度。

有谁知道这样的网络示例？理想情况下，该平台是 asp.net 3.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T17:07:05.890

看看这个 - 这可能会有所帮助

[http://www.defusion.org.uk/code/javascript-image-cropper-ui-using-prototype-scriptaculous/](http://www.defusion.org.uk/code/javascript-image-cropper-ui-using-prototype-scriptaculous/)

有一个演示

[http://www.defusion.org.uk/demos/060519/cropper.php](http://www.defusion.org.uk/demos/060519/cropper.php)

# sql - SQL 将值更改为大写或小写

> ID：341338
> 
> 赞同：62
> 
> 时间：2008-12-04T17:02:50.173
> 
> 标签：sql, case, uppercase, lowercase

如何使 sql select 语句中的字段全部大写或小写？

例子：

从人中选择名字

如何让名字总是返回大写，同样总是返回小写？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-12-04T17:07:09.947

```
SELECT UPPER(firstname) FROM Person

SELECT LOWER(firstname) FROM Person 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-04T17:04:06.787

分别为 LCASE 或 UCASE。

例子：

```
SELECT UCASE(MyColumn) AS Upper, LCASE(MyColumn) AS Lower
FROM MyTable 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-04T17:05:18.530

SQL 服务器 2005：

```
print upper('hello');
print lower('HELLO'); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-14T06:55:39.387

您可以使用`LOWER function`和`UPPER function`。像

```
SELECT LOWER('THIS IS TEST STRING') 
```

结果：

```
this is test string 
```

和

```
SELECT UPPER('this is test string') 
```

结果：

```
THIS IS TEST STRING 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-08T03:05:19.173

你可以做：

```
SELECT lower(FIRST NAME) ABC
FROM PERSON 
```

注意：`ABC`如果要更改列的名称，请使用

# c++ - 在 CodeBlocks 中查看语言 (C/C++) 参考/文档

> ID：341345
> 
> 赞同：5
> 
> 时间：2008-12-04T17:05:00.047
> 
> 标签：c++, c, codeblocks

我在 StackOverflow 上的第一个问题...

有人知道通过 CodeBlocks 查看语言的参考/文档手册的方法吗？专门用于 C/C++。

示例：
假设我想查找 strncpy() 的引用。在一个非常古老的 Borland 系统（我们在学校使用的）中，我会写下这个词并在它上单击鼠标中键，从而参考它。如果能以某种方式浏览手册，那就太好了。

我是否完全忽略了这一点（也在搜索谷歌），还是它丢失了？如果它丢失了，在不在线的情况下搜索 C 和/或参考手册的最快方法是什么？

问候！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T22:16:54.377

是的，有可能。不过，我不确定帮助文件本身。

该过程似乎记录[在此处。](http://wiki.codeblocks.org/index.php?title=Using_devhelp_as_a_help_viewer)

从论坛。

回复：F1 - 帮助和功能参考 « 回复 #1 于：2008 年 9 月 15 日，下午 2:07:59 »

如果您安装了帮助插件，您可以通过“设置->环境”设置帮助文件，然后点击左侧列表中的“帮助文件”。按下 F1 时会调用默认文件.. 记录 starmaker Newcomer * 帖子：3

回复：F1 - 帮助和功能参考 « 回复 #2 于：2008 年 9 月 15 日，下午 6:57:29 »

你是对的，但有最新的文档吗？

现在我使用 MSDN 或 cppreference.com 网页。问候，明星制造商

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-13T15:20:23.423

I found the complete answer. Based on your reply EvilTech.

Here's the setup procedure for different systems: [http://wiki.codeblocks.org/index.php?title=Help_plugin](http://wiki.codeblocks.org/index.php?title=Help_plugin)

And here are the help files for C++ compiled from an online source: [http://onnerby.se/~daniel/chm/](http://onnerby.se/~daniel/chm/)

I find it strange though that I couldn't find any other help files for C "out there". I also had problems viewing the .chm files. The list of keywords of the file are shown, but the contents of each keyword does not show. Turns out this is comes from a windows security update. The solution is to right-click on the file -> properties -> click on "unblock".

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T17:28:48.110

（顺便说一句，你的意思是[Code::Blocks](http://en.wikipedia.org/wiki/Codeblocks)）

从来没有使用过，我可以说任何确定的东西，但是您是否尝试过选择该术语并按 F1 键？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T22:48:50.677

为什么不在 Code::Blocks 的论坛中问这个问题？

# c# - 如何像 Table 类那样获取控件集合？

> ID：341347
> 
> 赞同：0
> 
> 时间：2008-12-04T17:05:20.433
> 
> 标签：c#, .net, user-controls

如何获取 UserControl 标签内的控件？

因此，如果这是在页面上：

```
<ME:NewControl ID="tblCustomList" runat="server">
// ... these controls will be used in my UserControl.aspx
</ME:NewControl> 
```

如何访问我的 UserControl 中的这些控件？

例如，Table 类执行以下操作：

```
<asp:Table ID="tblNormal" runat="server">
  <asp:TableRow>
      <asp:TableCell>Thing 1</asp:TableCell>
      <asp:TableCell>Thing 2</asp:TableCell>
  </asp:TableRow>
</asp:Table> 
```

当我这样做时，我收到一条错误消息，提示我的 UserControl“没有名为 'TableRow' 的公共属性：

```
<ME:NewControl ID="tblCustomList" runat="server">
  <asp:TableRow>
      <asp:TableCell>Thing 1</asp:TableCell>
      <asp:TableCell>Thing 2</asp:TableCell>
  </asp:TableRow>
</ME:NewControl> 
```

我发现[这个示例](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.table.createcontrolcollection.aspx)有助于扩展 Table 类，但这并不是我*想要*做的。

我还找到[了关于](http://msdn.microsoft.com/en-us/library/36574bf6.aspx)如何使用模板化控件的描述，我不确定是否可以使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T20:12:36.687

原来我只需要这样的东西：

```
public TableRow DTHeader { get; set; }

protected override void OnInit(EventArgs e)
{
    tblCollection.Rows.Add(DTHeader);
    base.OnInit(e);
} 
```

然后在我的页面上使用它：

```
<ME:NewControl ID="tblCustomList" runat="server">
    <DTHeader>
        <asp:TableCell></asp:TableCell>
        //...
    </DTHeader>
</ME:NewControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T17:18:40.157

我不确定我是否 100% 理解这个问题。

但是，如果您有一个名为 Row 的自定义控件，则可以向主表用户控件添加一个集合。

您可以使用通用列表来执行此操作。这应该使您能够像普通的 aspx 控件一样添加它们。

我这里没有代码示例，但我已经做过很多次了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T18:42:06.027

我不确定我是否理解你的问题。

您可以仅使用 tblCustomList.Controls 访问控件服务器端，然后您可以循环并添加到您的用户控件。但同样，我不确定你在问什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T19:05:41.890

您引用的[示例](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.table.createcontrolcollection.aspx)似乎是您想要完成的。
您是否在后面的代码中添加了以下内容？

```
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Security.Permissions;

namespace Samples.AspNet.CS.Controls
{
    [AspNetHostingPermission(SecurityAction.Demand, 
        Level = AspNetHostingPermissionLevel.Minimal)]
    public sealed class CustomTableCreateControlCollection : Table
    {
        protected override ControlCollection CreateControlCollection()
        {
            // Return a new ControlCollection
            return new ControlCollection(this);
        }
    }
} 
```

# visual-studio - DSL 工具：如何将 DLL 创建为弱命名

> ID：341348
> 
> 赞同：0
> 
> 时间：2008-12-04T17:05:59.967
> 
> 标签：visual-studio, assemblies, dsl, dsl-tools

我有一个 DSL 工具解决方案。

我需要为此项目添加一个弱名称引用。因为 DSL Tools 项目 DLL 是强命名的，所以我不能使用弱命名的 DLL。

我无法使 DLL 具有强名称，因为我无法重新编译它。

我试图通过转到 Dsl 和 DslPackage 项目属性来使我的 DSL 工具项目 DLL 弱命名，并取消选中 Sigining 选项卡中的“签署程序集”选项。

然后我编译它。错误列表给出以下错误

```
"gacutil.exe" exited with code 1 
```

查看 VS2005 输出窗口，我看到 gacutil 正在被调用

```
C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\bin\gacutil.exe -nologo -i "C:\Academy\ResearchAndDevelopment\FrontendGenerator\DslPackage\bin\Debug\vantyx.FEGenerator.DslPackage.dll" 
```

之后，我使用了命令提示符，gacutil.exe 错误显示如下：

```
Z:\>"C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\bin\gacutil.exe" -nologo -i "C:\Academy\ResearchAndDevelopment\FrontendGenerator\DslPackage\bin\Debug\vantyx.FEGenerator.DslPackage.dll"
Failure adding assembly to the cache: Attempt to install an assembly without a strong name 
```

我不知道为什么以及如何调用 gacutil.exe。我查看了项目和解决方案属性，没有配置为调用 gacutil.exe 的选项。我什至查看了“gacutil.exe”的每个文件，但我什么也没找到。

我真正想要的是能够使用我无法进行强命名的弱命名 DLL。因此，我一直试图让我的 DSL 工具 DLL 命名为弱名称，但我做不到。

关于我如何解决这个问题的任何帮助？

非常感谢， Luís Filipe

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T16:04:59.870

除了上面写的答案外，Visual Studio 的所有加载项都必须是强命名的。

可以通过在运行时加载程序集并使用反射来调用方法来解决一些问题。

问候，路易斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T21:17:46.437

使用带有反射的运行时绑定是一个很好的解决方案并且有效。除此之外，我实施的另一个解决方案是启动一个单独的 AppDomain 并让该 AppDomain 加载程序集并运行您想要的任何方法。这种方法的缺点是额外的复杂性和性能。一个人真的必须知道他在做什么，因为他实际上是在 Visual Studio 的进程空间中启动一个单独的 .net 应用程序。好处是，只要小心一点，您就可以一直获得类型安全。

# sharepoint - 调整 Sharepoint URL 字段长度

> ID：341350
> 
> 赞同：8
> 
> 时间：2008-12-04T17:06:12.350
> 
> 标签：sharepoint, wss-3.0

无论如何要更改 Sharepoint 用于存储 URL 的字段的长度。它的默认值为 255，这不足以容纳指向共享点站点内内容的链接。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-12T20:10:14.070

不，这是 SharePoint 中的硬限制。研究内容数据库的架构揭示了限制源自 AllDocs 表中的主键列 DirName 和 LeafName。

我最近在一个项目中也出现了这个问题，因为用户倾向于使用长文件夹名和长文件名创建深层文件夹结构。我们设法通过根据以下准则缩短一些 URL 来解决该问题：

*   首选站点和文档库的短 URL 名称。
*   对于文档库，首先使用您想要的标题作为 URL 创建它们，然后将标题重命名为库的显示名称。
*   避免过长的文件夹名和文件名。
*   避免文档库中的文件夹结构过深，最好多创建几个文档库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T13:03:43.993

在升级时更改 SharePoint 数据类型的长度可能很危险。我建议创建一个具有您期望的属性的新站点列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T11:01:50.713

我相信这是一个 WebDAV 限制。有关详细信息，请参阅[文件名、长度、大小和无效字符限制和建议](http://blogs.msdn.com/joelo/archive/2007/06/27/file-name-length-size-and-invalid-character-restrictions-and-recommendations.aspx)。

但是，我可以看到这是链接到外部内容的潜在问题（尽管希望很少见）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T10:40:09.853

我不知道如何解决这个问题，我遇到了完全相同的问题，我发现了一个对 WSS v3 不起作用的 MOSS 修补程序，它建议增加超链接字段的长度，但与 WSSv3 不兼容。真的很可惜。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T17:10:54.080

您无法更改它，但一种解决方法是在可以缩短 URL 时缩短它们。这是我为此编写的免费在线工具：

[http://qa76.net/shortener](http://qa76.net/shortener)

如果完整的文档名称超过 255 则无济于事！但很多时候，问题在于 SharePoint 制作的视图 URL。这些可以缩短，通常是显着的。

页面上的更多详细信息。

# c++ - 在异常规范中仅使用 std::exception

> ID：341370
> 
> 赞同：3
> 
> 时间：2008-12-04T17:10:06.760
> 
> 标签：c++, exception

似乎人们普遍认为异常规范没有人们想象的那么大。但我想知道仅使用 std::exception 的规范是否是一个很好的折衷方案：

```
void someFunction()
    throw ( std::exception ); 
```

*   它记录了此方法/函数可能引发异常的事实。

*   它将确保只抛出从 std::exception 派生的异常，而不是一些像 std::string 或 int 这样的奇异类。

那么，这会比没有任何规范更好吗？

**更新：**

关于运行时开销：把它想象成断言的使用。无论运行时开销如何，您都在使用断言，对吗？我知道您通常可以在发布版本中禁用它们，因此也许更好的方法是将异常规范包装在宏中，以便您可以在发布版本中禁用它。就像是：

```
#ifdef DEBUG
    #define THROW( exception ) throw ( exception )
#else
    #define THROW( exception )
#endif

void someFunction()
    THROW( std::exception ); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T17:21:43.520

是的，但是当抛出不是从 std::exception 派生的东西时，你期望发生什么？

您希望应用程序终止吗？
没有堆栈展开，没有调用析构函数来整理代码，只是应用程序退出。

Java 和 C++ 异常规范之间的区别在于 Java 在编译时检查规范。另一方面，C++ 在运行时进行所有检查。因此，当您的规范被违反时，已经为时已晚。

即使在 Java 代码中，也有停止使用它们的运动。在项目开始时往往会发生异常规范被严格定义的情况。但是随着代码的增长和变得越来越复杂，规范被淡化为越来越普遍的形式。这是因为随着代码的增长，可能会抛出更多异常，如果无法立即处理它们，则需要将整个调用链的异常规范修改回可以处理的点。（请注意，我不是 Java 专家，但我确实使用成熟的 Java 代码库）。

唯一有价值的异常规范（我认为）是 no throw 规范。这确实有一个有效的应用程序（但您必须将它与 try/catch(...) 块一起使用）。

另请阅读[Herb Sutters 文章](http://www.gotw.ca/gotw/082.htm)：

还有这个关于 SO 的线程：[我应该在 C++ 中使用异常说明符吗？](https://stackoverflow.com/questions/88573/should-i-use-an-exception-specifier-in-c)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T17:48:42.173

异常规范本质上是无用的。Martin York 已经链接到 Herb Sutter 关于它们的帖子，但简而言之，您遇到了以下问题：

1.  它们被 MSVC 忽略，并且
2.  它们的效果与 Java 完全不同。在运行时检查规范，导致性能下降，而没有给您在 Java 中获得的编译时验证。您所说的只是“插入额外的代码，以便在引发异常时检查其类型，然后将其正常抛出，或者改为调用unexpected()。

因此，您所做的只是使捕获可能引发的异常变得更加困难，同时减慢了程序的速度。真的没有多大意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T17:17:20.440

在符合标准的编译器上，添加非空异常规范会在函数周围生成等效的 try/catch 块。尽管可以以没有运行时开销的方式实现这一点，但在某些当前编译器上，您确实会得到开销。

因此，可能会有成本，而您所获得的只是，如果`someFunction`它调用的东西引发了非`std::exception`派生异常，`std::unexpected`则会被调用，而不是调用未处理的异常机制。

所以我想我的答案是“不”:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T08:44:40.833

我通常会这样做：

```
void someFunction() /* throw (std::exception) */; 
```

函数声明中 throw 语句的唯一作用是修改其签名：指向“void x()”的指针和指向“void x() throw y”的指针是两种不同的类型。
通过这种方式，您仍在记录该函数可能会抛出一些东西，并且您没有丢失任何内容，因为 c++ 编译器无论如何都不会强制执行任何约束。

# powershell - 如何创建 powershell 2.0 模块？

> ID：341372
> 
> 赞同：9
> 
> 时间：2008-12-04T17:10:45.977
> 
> 标签：powershell

我听说 powershell 2.0 CTP 有模块，但我找不到太多示例代码或说明。我已经阅读了似乎在线的一些小帮助......

但是当我尝试加载模块时，我只是不断收到“术语'Add-Module'不被识别为cmdlet ...”。

任何帮助将不胜感激！

***编辑***（2010 年 7 月）请注意这个问题基于 powershell 2.0 CTP，因此已经过时一年半了！请参阅 Samuel Jack 的回答以获取有关 powershell 2.0 RTM 的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T15:57:52.927

随着 Win7 的构建，Add-Module 消失了。新的 cmdlet 是 Import-Module。创建模块的最简单方法是将 PS1 文件重命名为 PSM1 文件。从那里你可以做各种各样的事情，包括模块清单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-16T11:57:00.037

我不是 Powershell 专家，但这是我刚刚使用 PowerShell 2.0 RTM 发现的。

假设您要创建一个名为*MyModule*的模块：

1.  确保您已创建文件夹*%My Documents%\WindowsPowershell\Modules*
2.  *在Modules*中创建一个名为*MyModule的文件夹*
3.  将您的代码放在*MyModule*内的文件中，并将文件命名为*MyModule.psm1*
4.  请记住将 Export-ModuleMember 命令用作脚本文件中的最后一件事。`Export-ModuleMember -Function * -Alias *`将导出所有函数和别名
5.  在要使用模块的脚本中，使用命令`Import-Module MyModule`

默认情况下，Powershell 配置为不从文件运行任何类型的脚本，因此您需要更改安全设置。`Set-ExecutionPolicy Unrestricted`如果您不担心需要签名的脚本，它将助您一臂之力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T18:38:34.850

这里有一点信息。 [http://huddledmasses.org/powershell-modules/](http://huddledmasses.org/powershell-modules/)

[http://blogs.msdn.com/mediaandmicrocode/archive/2008/08/10/microcode-all-about-modules-windows-powershell-ctp2.aspx](http://blogs.msdn.com/mediaandmicrocode/archive/2008/08/10/microcode-all-about-modules-windows-powershell-ctp2.aspx)

让我们希望即将到来的 CTP3 有一些关于模块的有用文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T01:52:59.677

模块有望解决一些问题。现在，我们可以使用点源将函数、变量和脚本放入 PowerShell 会话的全局范围内。

问题在于，这可能会使用最终用户可能不想要/不需要的各种全局变量和辅助函数污染您的会话。

模块将允许您作为作者构建脚本，并且仅使模块的最终用户可以使用某些函数/变量。

它们也基本上取代了 PSSnapin 的概念。您可以使用 Add-Module Some.dll 添加包含 cmdlet 的程序集。

真正酷的是所谓的模块清单。这是一个哈希表，基本上指定了各种依赖项以及作者、名称、GUID 标识符和版本号。当用户加载具有模块清单的模块时，它将检查所有依赖项并运行模块作者认为必要的任何脚本。

当 CTP3 发布时，应该有一些像样的文档。

希望有点帮助。

安迪

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T19:50:28.137

Windows PowerShell v2.0：TFM (sapienpress.com) 在其中一章中有信息和示例。它以电子书的形式提供，随着新 CTP 的发布而更新。我还在 ConcentratedTech.com 上发布了有关它们的博客，并且论坛中的 PowerShellCommunity.org 上也对它们进行了讨论。

# jquery - 使用 jQuery 如何通过选择菜单选项提示消息？

> ID：341373
> 
> 赞同：2
> 
> 时间：2008-12-04T17:11:01.467
> 
> 标签：jquery, webforms

当用户在选择菜单中选择特定选项时，我需要提示警报消息。有没有办法使用 jQuery 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T17:19:12.373

假设您的选择的 ID 为 myselect，并且您要检查的值为“myval”

```
$("#myselect").change(function() {
   if($(this).val() == "myval")
    {
       alert('message');
    }
}); 
```

我还没有测试过这个，但这个概念应该是合理的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T17:18:24.340

我最近碰到了[jQuery Confirm Plugin](http://nadiana.com/jquery-confirm-plugin)。它可能是也可能是您正在寻找的东西。

# java - 为什么 AbstractCollection 不实现 equals()？

> ID：341377
> 
> 赞同：7
> 
> 时间：2008-12-04T17:12:33.523
> 
> 标签：java, collections, hashmap

你知道吗 ：

```
Map<Object,Object> m1 = new HashMap<Object, Object>();
Map<Object,Object> m2 = new HashMap<Object, Object>();
System.out.println("m1.equals(m2) = "+m1.equals(m2));
System.out.println("m1.keySet().equals(m2.keySet()) = "
            +m1.keySet().equals(m2.keySet()));
System.out.println("m1.entrySet().equals(m2.entrySet()) = "
            +m1.entrySet().equals(m2.entrySet()));
System.out.println("m1.values().equals(m2.values()) = "
            +m1.values().equals(m2.values())); 
```

将输出：

```
m1.equals(m2) = true
m1.keySet().equals(m2.keySet()) = true
m1.entrySet().equals(m2.entrySet()) = true
m1.values().equals(m2.values()) = false 
```

这是由于`AbstractCollection`（`HashMap$Values`继承自）不覆盖`#equals()`.

你知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T17:29:18.857

根据 s 的约定[`Collection#equals()`](http://java.sun.com/javase/6/docs/api/java/util/Collection.html#equals(java.lang.Object))，s 没有通用的 equals() 方法`Collection`，因此`AbstractCollection`无法提供。

请注意，`HashMap$Values`它既不是 Set 也不是 List，因此是一个难题，并且在某种意义上是它不支持的原因`equals()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T17:28:50.277

AbstractList 和 AbstractSet 都扩展了 AbstractCollection，并且它们的 equals() 方法具有不同的行为，由接口[List](http://java.sun.com/javase/6/docs/api/java/util/List.html#equals(java.lang.Object))和[Set](http://java.sun.com/javase/6/docs/api/java/util/Set.html#equals(java.lang.Object))指定。[Collection](http://java.sun.com/javase/6/docs/api/java/util/Collection.html#equals(java.lang.Object))的界面说：

> 虽然 Collection 接口没有对 Object.equals 的一般约定添加任何规定，但“直接”实现 Collection 接口的程序员（换句话说，创建一个是 Collection 但不是 Set 或 List 的类）必须小心如果他们选择覆盖 Object.equals。

所以 AbstractCollection 绝对不应该重写 equals()。也就是说，我真的不知道为什么 HashMap$Values 不会实现 equals() 本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T17:20:45.660

我不确定这是否是官方原因，但 AbstractCollection 避免对潜在子类添加语义约束。相等的语义由具体的继承数据结构的性质决定，特别是基于你的结构是否有序以及它是否允许重复。

例如，考虑 TreeSet、LinkedList、Bag 等。

顺便说一句，关于您发布的代码，值返回的实际类型是什么？那应该是一个具有具体实现的子类。如果您在运行此代码时地图为空，那么您可能会得到一些不认为两个空集相等的东西。

# language-agnostic - 大型 Web 应用程序的最佳环境

> ID：341378
> 
> 赞同：3
> 
> 时间：2008-12-04T17:12:53.930
> 
> 标签：language-agnostic

我们正在开发一个 Web 应用程序，该应用程序将拥有一个包含超过 5 百万个文档的数据库，所有这些文档都将使用各种语言。该网站计划每月访问量超过 300 万次（希望更多）。

我们需要一个稳定且可扩展的解决方案。

我们现在在带有 PGSQL DB 的 JBoss 应用服务器上使用 Java EE，但我们想知道这是否适合问题或是否有更好的解决方案，因为该项目只是一个开始，更改还可行。

此外，正如我们中的许多人一样，对这类项目没有太多经验，有经验的人的意见将非常有用！

我希望我说清楚了。如果您需要更多信息，请告诉我。
提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T12:40:14.273

您的解决方案的架构设计考虑可能比“平台”的选择更重要。换句话说，您将如何使您的应用程序规模化？您需要存储分布式会话吗？您是否需要实时数据库同步或一些不太最新的东西？您将如何进行请求负载平衡或处理故障转移？业务逻辑是否可以在一组分布式节点/站点或您设想的任何东西上工作。

一旦您的设计符合您的目的，那么选择您的实施平台可能是一个更明智的决定。无论是 java、.net、rails 还是其他无关紧要的东西。他们都有自己的长处和短处，你的团队成员也是如此。利用他们的优势来指导您决策过程的这一部分。不要试图在构建听起来相当严肃的网站的同时学习新技术。

我在一个相当大的分布式电子书交付系统上使用过 JBoss，每天有数万次页面浏览量，而且它从未错过任何一个节拍。同样，就您提到的数字而言，我认为 Stack Overflow 是 ASP.NET 平台功能的一个非常充分的例子。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T18:58:32.763

如果不先征求其他地方的建议，我个人不会负责为团队提供自己的解决方案。和 chaKa 一样。我不会做的是依靠一种帮助来做出最终决定。

您可能需要考虑以下标准：

1.  你有多少时间？什么是发展计划？如果您立即开始，否则您将有时间学习。
2.  你需要框架吗？您是否希望快速交付？你有多少要求？这一切都会影响它是基于框架的解决方案还是从头开始。
3.  你也会支持这个项目吗？有多少人会去做？您还需要知道项目会缓慢增长还是应该快速部署并被遗忘。
4.  你的团队有什么技能？他们擅长什么？
5.  什么会让你兴奋并想要做你最好的实施解决方案？

我相信还有更多需要考虑的...

# python - 装饰器在调用它装饰的函数之前运行？

> ID：341379
> 
> 赞同：13
> 
> 时间：2008-12-04T17:13:32.430
> 
> 标签：python, django, decorator

举个例子：

```
def get_booking(f=None):
    print "Calling get_booking Decorator"
    def wrapper(request, **kwargs):
        booking = _get_booking_from_session(request)
        if booking == None:
            # we don't have a booking in our session.
            return HttpRedirect('/')
        else:
            return f(request=request, booking=booking, **kwargs)
    return wrapper

@get_booking
def do_stuff(request, booking):
    # do stuff here 
```

我遇到的问题是，`@get_booking decorator`甚至在我调用我正在装饰的函数之前就调用了。

启动时输出：

```
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
Calling get_booking Decorator
[26/Oct/2008 19:54:04] "GET /onlinebooking/?id=1,2 HTTP/1.1" 302 0
[26/Oct/2008 19:54:05] "GET /onlinebooking/ HTTP/1.1" 200 2300
[26/Oct/2008 19:54:05] "GET /site-media/css/style.css HTTP/1.1" 200 800
[26/Oct/2008 19:54:05] "GET /site-media/css/jquery-ui-themeroller.css HTTP/1.1" 200 25492 
```

我什至还没有调用此时装饰的函数。

我刚刚开始使用装饰器，所以也许我错过了一些东西。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-04T17:17:27.977

我相信 python 装饰器只是语法糖。

```
@foo
def bar ():
    pass 
```

是一样的

```
def bar ():
    pass
bar = foo(bar) 
```

如您所见，即使没有调用*bar ，也会调用**foo 。*这就是为什么您会看到装饰器函数的输出。你的输出应该包含你应用装饰器的每个函数的一行。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T17:50:05.850

由于您是从装饰器开始的，我认为阅读这些内容会有所帮助，以便您事先了解陷阱和解决方法。

这里有两个关于装饰器的早期讨论的链接。

[Python 装饰器让函数忘记它属于一个类](https://stackoverflow.com/questions/306130/python-decorator-makes-function-forget-that-it-belongs-to-a-class#306277) [functools.wraps 是做什么的？](https://stackoverflow.com/questions/308999/what-does-functoolswraps-do)

此外，第二个链接提到了“functools”一个用于高阶函数的模块，它作用于或返回其他函数。建议使用 functools.wraps ，因为它保留了原始函数的文档字符串（装饰过的）。

另一个问题是为我的项目生成自动文档时方法签名错误。但有一个解决方法： [保留装饰函数的签名](https://stackoverflow.com/questions/147816/preserving-signatures-of-decorated-functions)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T17:18:22.157

一旦定义了装饰函数，就会调用装饰器。它相当于写这样的东西：

```
def __do_stuff(...):
    ...

do_stuff = get_booking(__do_stuff) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T17:20:57.267

python 装饰器是应用于函数以对其进行转换的函数：

```
@my_decorator
def function (): ... 
```

就像这样做：

```
def function():...
function = my_decorator(function) 
```

你想做的是：

```
def get_booking(f=None):
    def wrapper(request, **kwargs):
        print "Calling get_booking Decorator"
        booking = _get_booking_from_session(request)
        if booking == None:
            # we don't have a booking in our session.
            return HttpRedirect('/')
        else:
            return f(request=request, booking=booking, **kwargs)
    return wrapper 
```

# iphone - UITableViewCell 中的 UITextField 及正确使用

> ID：341380
> 
> 赞同：3
> 
> 时间：2008-12-04T17:13:50.683
> 
> 标签：iphone, objective-c, cocoa-touch

我有一个复杂的设置样式表，其中各个单元格代表数据模型类的不同方面。用户可以单击单元格并编辑单个属性，例如说我是否有用户类、姓名、出生日期等。我的问题是，我是否需要为每个唯一单元格创建一个 UITextField 实例？我可以只创建一个 UITableViewCell 的子类，设置一个委托，然后确定它的位置吗？

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T21:04:37.737

我建议创建 UITableViewCell 的子类。您可以纯粹以编程方式执行此操作，或者如果您不喜欢 CGRect（或希望能够拖放您的布局）并结合使用 XIB 和自定义类文件。

然后，子类将包含您需要的 UITextFiled，并且还可以有一个委托或数据源，您可以使用它来将其指向您的数据模型对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T05:05:56.750

最好让您使用的 UITableViewController 充当每个单元格的文本视图委托 - 确保您正在重复使用单元格，并且当您创建或重用它们时，将您的类附加为您通过自定义 UITableViewCell 拥有的 UITextViews 的委托使用访问器访问 UITextViews 的类。

如果将单元格类设置为文本委托，如果用户在键盘向上滚动表格视图单元格时可能会遇到问题。

# winforms - 文档内的 rtftextbox 和超链接/锚点

> ID：341381
> 
> 赞同：0
> 
> 时间：2008-12-04T17:13:58.483
> 
> 标签：winforms, .net-2.0, rtf

几个小时前，我发现使用标准的 .net 2.0 winforms 控件（RichTextBox）显示 *.rtf 文档非常容易。它甚至可以显示图片真的很酷，但对我来说，它缺少一个功能 - 超链接。我准备了 *.rtf 文档，其中包含一些指向文档内段落的超链接。然后我将此文件放入资源中并加载到控件的 rtf 属性，但不幸的是，单击链接不起作用。是否有可能的破解或解决方法来启用超链接？

**编辑：**

我的客户将准备一份简短的文档（假设是一份 *.docx 文件或一份 *.html 文件）。

它将包含几章，我们希望将小目录放在文档的顶部。

预期的行为是用户单击主题并且控件将其内容滚动到文档中的所需位置。

所以也许这不是关于链接，而是关于书签。

* * *

好的，我将尝试描述大部分所需的解决方案。

我的客户将准备一份简短的文档（假设是一份 *.docx 文件或一份 *.html 文件）。

它将包含几章，我们希望将小目录放在文档的顶部。

预期的行为是用户单击主题并且控件将其内容滚动到文档中的所需位置。

所以也许这不是关于链接，而是关于书签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T20:46:43.827

您的链接是如何格式化的，DetectUrl 是真的吗？

从 codeproject -> 仅链接以一种公认的协议开头（http:、file:、mailto:、ftp:、https:、gopher:、nntp:、prospero:、telnet:、news:、wais:、outlook:)被识别并重新格式化。

[http://www.codeproject.com/KB/edit/RichTextBoxLinks.aspx](http://www.codeproject.com/KB/edit/RichTextBoxLinks.aspx)

[http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.detecturls(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.detecturls(VS.80).aspx)

微软文章有一个关于 LinkClicked 事件的示例。

```
private void Link_Clicked (object sender, System.Windows.Forms.LinkClickedEventArgs e)
{
   System.Diagnostics.Process.Start(e.LinkText);
} 
```

# postgresql - 如何将“1 天 01:30:00”等间隔转换为“25:30:00”？

> ID：341384
> 
> 赞同：23
> 
> 时间：2008-12-04T17:16:45.903
> 
> 标签：postgresql, formatting, intervals

我需要添加一些间隔并在 Excel 中使用结果。

自从

```
sum(time.endtime-time.starttime) 
```

将间隔返回为“1 天 01:30:00”，这种格式破坏了我的 Excel 工作表，我认为有像“25:30:00”这样的输出会很好，但在 PostgreSQL 中没有办法做到这一点文档。

这里有人可以帮我吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-06-23T10:01:34.143

由于该主题没有确切的解决方案：

```
=> SELECT date_part('epoch', INTERVAL '1 day 01:30:00') * INTERVAL '1 second' hours;
  hours
-----------
 25:30:00
(1 row) 
```

资料来源：[文档](http://www.postgresql.org/docs/9.3/static/functions-datetime.html)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-04T17:30:53.423

我唯一能想到的（除了解析天数并每次将小时数加 24）是：

```
mat=> select date_part('epoch', '01 day 1:30:00'::interval);
 date_part 
-----------
     91800
(1 row) 
```

它会给你秒数，这对于excel来说可能没问题。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-12-04T17:35:06.163

您可以使用`EXTRACT`将间隔转换为秒。

```
SELECT EXTRACT(EPOCH FROM INTERVAL '5 days 3 hours');
Result: 442800 
```

然后你需要自己做数学（或让 Excel 做）。

请注意，“1 天”不一定等同于“24 小时”——PostgreSQL 处理诸如跨越 DST 转换的间隔之类的事情。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-06-16T19:29:48.090

如果您希望 postgres 为您处理 HH:MM:SS 格式，请以纪元秒为单位获取差异并将其转换为以秒为单位的间隔：

```
SELECT SUM(EXTRACT(EPOCH FROM time.endtime) - EXTRACT(EPOCH FROM time.starttime))
         * INTERVAL '1 SECOND' AS hhmmss 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T17:47:11.643

在标准 SQL 中，您希望将类型表示为 INTERVAL HOUR TO SECOND，但您有一个 INTERVAL DAY TO SECOND 类型的值。您不能使用 CAST 来获得所需的结果吗？在 Informix 中，符号可以是：

```
SUM(time.endtime - time.starttime)::INTERVAL HOUR(3) TO SECOND

CAST(SUM(time.endtime - time.starttime) AS INTERVAL HOUR(3) TO SECOND) 
```

前者是 AFAIK，特定于 Informix 的表示法（或者，至少不是标准的）；我相信后者是 SQL 标准表示法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T23:19:32.953

可以做到，但我相信唯一的方法是通过以下怪物（假设您的时间间隔列名称为“ti”）：

```
select
              to_char(floor(extract(epoch from ti)/3600),'FM00')
    || ':' || to_char(floor(cast(extract(epoch from ti) as integer) % 3600 / 60), 'FM00')
    || ':' || to_char(cast(extract(epoch from ti) as integer) % 60,'FM00')
    as hourstamp
from whatever; 
```

看？我告诉过你这太可怕了:)

认为那会很好

```
select to_char(ti,'HH24:MI:SS') as hourstamp from t 
```

会起作用，但可惜的是，HH24 格式不会“吸收”超过 24 的溢出。以上内容（从内存中重构）来自我曾经编写的一些代码。为了避免得罪那些体质脆弱的人，我将上述恶作剧概括为一个观点......

# include - 为 Makefile 中的标题添加目录

> ID：341387
> 
> 赞同：23
> 
> 时间：2008-12-04T17:17:19.537
> 
> 标签：include, makefile, header

您好我想问您，如果有人知道如何在 Makefile 中为头文件添加目录以避免错误 *.h not found，我尝试过此选项但不起作用：

```
INC_PATH := -I /directory/to/add 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-04T17:18:54.650

至少对于 GNU make，尝试隐式变量`[CFLAGS](http://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html#index-CFLAGS-885)`，如下所示：

```
CFLAGS=-I/directory/to/add 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-04T17:43:21.323

尽管目标最终是影响 CFLAGS 的值（如 @unwind 所建议的那样），但简单地设置 CFLAGS 的值通常不是一个好主意，因为它通常由许多部分组成。您必须了解 makefile 的结构以及使用的宏集。

[*补充*：

Eduardo 问：你能发布宏来做同样的事情吗？

是的，但它们是否有用取决于您的 makefile 的结构。这是我的一个 makefile 中的一个中等复杂的示例。

```
CC        = gcc -g
XFLAGS    = -Wall -Wshadow -Wstrict-prototypes -Wmissing-prototypes \
            -DDEBUG -Wredundant-decls
#CC        = cc -g
#XFLAGS    =
UFLAGS    = # Always overrideable on the command line

DEPEND.mk  = sqlcmd-depend.mk
INSTALL.mk = sqlcmd-install.mk

ESQLC_VERSION = `esqlcver`
OFLAGS    = # -DDEBUG_MALLOC -g
OFLAGS    = -g -DDEBUG -O4
PFLAGS    = -DHAVE_CONFIG_H
OFILES.o  = # rfnmanip.o # malloc.o # strdup.o # memmove.o
VERSION   = -DESQLC_VERSION=${ESQLC_VERSION}
#INC1     = <defined in sqlcmd-depend.mk>
#INC2     = <defined in sqlcmd-depend.mk>
INC3      = /usr/gnu/include
INC4      = ${INFORMIXDIR}/incl/esql
INC5      = . #${INFORMIXDIR}/incl
INCDIRS   = -I${INC3} -I${INC1} -I${INC2} -I${INC4} -I${INC5}
LIBSQLCMD = libsqlcmd.a
STRIP     = #-s
LIBC      = #-lc_s
LIBMALLOC = #-lefence
LIBRDLN   = -lreadline
LIBCURSES = -lcurses
LIBPOSIX4 = -lposix4
LIBG      = #-lg
LIBDIR1   = ${HOME}/lib
LIBDIR2   = /usr/gnu/lib
LIBJL1    = ${LIBDIR1}/libjl.a
LIBJL2    = ${LIBDIR1}/libjlss-${ESQLC_VERSION}.a
LIBTOOLS  = ${LIBJL2} ${LIBJL1}
LDFLAGS   = ${LIBSQLCMD} ${LIBTOOLS} -L${LIBDIR2} ${LIBG} ${LIBMALLOC} \
            ${LIBPOSIX4} ${LIBC} ${STRIP}
CFLAGS    = ${VERSION} ${INCDIRS} ${OFLAGS} ${XFLAGS} ${PFLAGS} ${UFLAGS} 
```

这是我的一个名为`sqlcmd`（在微软创建同名命令之前的十年或更长时间之前选择的名称）的程序的生成文件。我假设该`make`程序具有将 C 代码编译为对象的规则，例如：

```
${CC} ${CFLAGS} -c $*.c 
```

并且从宏 OBJECTS 中列出的一组目标文件链接程序的规则如下所示：

```
${CC} ${CFLAGS} -o $@ ${OBJECTS} ${LDFLAGS} 
```

如您所见，ESQLC_VERSION（使用的 Informix ESQL/C 版本，默认通过运行脚本派生`esqlcver`）有单独可设置的宏，然后是通过 INC1 到 INC5 和 INCFLAGS 的包含目录（可能有很多其中，取决于平台），优化器标志（OFLAGS），额外标志（CFLAGS），用户定义标志（UFLAGS - 我在大多数makefile中使用的习语；它允许用户在`make`命令行上设置UFLAGS和在构建中添加一个额外的标志），以及一堆与库相关的宏。这就是让我的开发 makefile 可以在对我的开发平台（可以是 Linux、Solaris 或 MacOS X）进行调整的情况下进行调整所需要的。对于程序的消费者，有一个`configure`脚本由`autoconf`，所以他们不必担心这些位是否正确。但是，这与该代码具有很强的遗传相似性，包括 UFLAGS 选项。

请注意，许多用于构建 makefile 的系统都有一种设置 CFLAGS 的机制，与此类似 - 简单地分配给 CFLAGS 会撤消系统所做的良好工作。但是您必须了解您的 makefile 才能合理地修改它。

]

# php - 基础php表单帮助（二）

> ID：341393
> 
> 赞同：0
> 
> 时间：2008-12-04T17:18:26.070
> 
> 标签：php, forms

这是我昨天提出的问题的延伸。

我正在尝试制作一个小的 php 计算器，它可以显示如果人们切换到 VoIP，他们可以节省多少电话费，以及他们可以通过每项服务节省多少。

我有一个表格，可以在这里为每月账单吐出正确的金额：

[http://www.nextadvisor.com/voip_services/voip_calculator.php?monthlybill=50&Submit=Submit](http://www.nextadvisor.com/voip_services/voip_calculator.php?monthlybill=50&Submit=Submit)

但现在我需要将其与其他一些数据整合并放入表格中。每个不同服务的价格都在另一个名为“values.php”的文件中。这些值为：

```
 $offer1calcsavings="24.99";
 $offer2calcsavings="20.00";
 $offer3calcsavings="21.95";
 $offer4calcsavings="23.95";
 $offer5calcsavings="19.95";
 $offer6calcsavings="23.97";
 $offer7calcsavings="24.99"; 
```

我希望表的七行中的每一行都有一个从月账单值中减去的 offercalcsavings 值。

php 代码目前如下所示：

```
 <?php $monthlybill = $_GET['monthlybill']; ?>

 Your monthly bill was <?php echo "$monthlybill"; ?>

   <?php
 $monthybill="monthlybill";
   $re=1;
   $offer ='offer'.$re.'name';
 $offername= ${$offer};
   while($offername!=""){
     $offerlo ='offer'.$re.'logo';
     $offerlogo=${$offerlo};
    $offerli ='offer'.$re.'link';
    $offerlink=${$offerli};
$offeran ='offer'.$re.'anchor';
$offeranchor=${$offeran};
$offerst ='offer'.$re.'star1';
$offerstar=${$offerst};
$offerbot='offer'.$re.'bottomline';
$offerbottomline=${$offerbot};
$offerca ='offer'.$re.'calcsavings';
$offercalcsavings=${$offerca};

echo '<tr >
     <td >
 <a href="'.$offerlink.'" target="blank">
 <img src="http://www.nextadvisor.com'.$offerlogo.'" alt="'.$offername.'" />
 </a>
 </td>
<td ><span class="rating_text">Rating:</span>
 <span class="star_rating1">
 <img src="http://www.nextadvisor.com'.$offerstar.'" alt="" />
 </span><br />
  <div style="margin-top:5px; color:#0000FF;">
 <a href="'.$offerlink.'" target="blank">Go to Site</a>
 <span style="margin:0px 7px 0px 7px;">|</span>
 <a href="'.$offeranchor.'">Review</a>
 </div> </td>
<td >'.$offercalcsavings.'</td>

   </tr>';
   $re=$re+1;
   $offer ='offer'.$re.'name';
 $offername= ${$offer};

   }
   ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T17:31:26.090

您可以像这样包含 values.php 文件：

```
include 'path/to/values.php'; 
```

如果您将values.php中的值放在一个数组中，您可以使用 foreach 循环轻松地遍历它们：

```
$values['1calsavings'] = 24.99;
$values['2calsavings'] = 20.00;
etc; 
```

然后在另一个文件中：

```
include 'path/to/values.php';
foreach($values as $name => $amount){
 echo '<some_markup>';
 echo "$name $amount";
 echo '</some_markup>'; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T17:35:44.867

埃加兹。

使用数组！

所以：

```
$offercalcsavings[0] = "24.99";  
$offercalcsavings[1] = "20.00";  
etc. etc. 
```

然后，你真的在​​循环输出：

```
for($i = 0; $i < CONSTANT_THAT_EQUALS_7; $i++) {
    echo "<html bits>";
    echo $offercalcsavings[$i];
    echo $offerlink[$i];
    etc. etc.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T18:00:01.213

> 我希望表的七行中的每一行都有一个从月账单值中减去的 offercalcsavings 值。

你需要在某个地方做数学。大概您会在输出行的 echo 语句之前执行此操作。

```
$offerwithsavings = $monthlybill - $offercalcsavings 
```

然后确保将其包含在您的表格中的某个地方。

```
<td >'.$offerwithsavings.'</td> 
```

这段代码的真正处方是一个数组和 foreach() 循环，但我想我现在让我的答案保持简单。数组和 foreach() 循环非常强大，并且相对快速且易于学习。你最好给他们一些深入的研究。

# process - 知道哪个过程产生了声音

> ID：341397
> 
> 赞同：3
> 
> 时间：2008-12-04T17:19:06.040
> 
> 标签：process, operating-system, audio

我的电脑经常发出“叮”的声音，我无法将它与任何东西联系起来。是否可以以编程方式确定哔声的来源？例如，我可以连接声音驱动程序吗？如果是这样，你能指出一些例子或参考吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T17:51:51.370

Omer，尽管您进行了编辑，但这不是编程问题。

无需编程。随着时间的推移，一个一个地关闭应用程序，直到停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T16:49:12.287

这是什么操作系统？如果您使用的是 Linux，则可以使用该[`lsof(8)`](http://linux.die.net/man/8/lsof)命令查看每个进程打开了哪些文件。如果一个进程正在播放声音，它将打开声音设备文件，因此您可以像这样使用 grep 查找它：

```
lsof | grep -E '/dev/(snd|dsp)' 
```

另一种选择是使用[`fuser(1)`](http://linux.die.net/man/1/fuser)，其工作方式与`lsof`.

# asp.net - 处理 asp.net 页面上的 Web 用户控制错误

> ID：341417
> 
> 赞同：2
> 
> 时间：2008-12-04T17:23:39.213
> 
> 标签：asp.net

您如何处理 Web 用户控制事件？我注意到我的自定义 Web 用户控件有一个事件调用 OnError，但是当我将控件调整为失败时它永远不会触发。该控件基本上是一个自定义的 gridview 控件。我在网上搜索 web 用户控制事件处理，但我没有找到一篇文章来解决我正在寻找的内容。有人可以快速解释一下或指出正确的方向吗？

感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T04:30:27.947

You didn't mention what flavour of ASP.NET, so I'll make the assumption of VB - C# is largely the same with the exception of how the event handler is attached.

The normal pattern you would expect to see is something along these lines:

***User Control "MyUserControl" CodeBehind***

```
Public Event MyEvent(ByVal Sender As Object, ByVal e As EventArgs)

Private Sub SomeMethodThatRaisesMyEvent()
  RaiseEvent MyEvent(Me, New EventArgs)
End Sub 
```

***Page Designer Code***

```
Private WithEvents MyUserControl1 As System.Web.UI.UserControls.MyUserControl 
```

***Page or other Control that wraps MyUserControl instance CodeBehind***

```
Private Sub MyUserControlEventHandler(ByVal Sender As Object, ByVal e As EventArgs) _
  Handles MyUserControl.MyEvent

    Response.Write("My event handled")

End Sub 
```

In some instances, you see something called Event Bubbling which doesn't follow this kind of pattern exactly. But in the basic sense of handling events from a user control to a wrapper control or the page it sits in, that's how you would expect it to work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-06T20:08:15.010

我遇到了一个自定义控件的问题，该控件引发了未触发`Error`事件的异常。因此，我无法从该控件中捕获异常并在 ASP.NET 页面中显示适当的消息。

这就是我所做的。我将自定义控件中的代码包装在一个`try..catch`块中并自己触发`Error`事件，如下所示：

```
// 在自定义控件中
尝试
{
    // 做一些引发异常的事情
}
捕捉（例外前）
{
    OnError(EventArgs.Empty); // 让父 ASP.NET 页面在
        // 错误事件
}
```

`Error`ASP.NET 页面使用如下事件处理异常：

```
<script runat="server">
    void MyCustomControl_Error(object source, EventArgs e)
    {
        MyCustomControl c = source as MyCustomControl;

        if (c != null)
        {
            // Notice that you cannot retrieve the Exception
            // using Server.GetLastError() as it will return null

            Server.ClearError();
            c.Visible = false;

            // All I wanted to do in this case was to hide the control
        }
    }
</script>

<sd:MyCustomControl OnError="MyCustomControl_Error" runat="server" /> 
```

# c - Linux Kernel Programming: "Unable to handle kernel NULL pointer dereference"

> ID：341422
> 
> 赞同：6
> 
> 时间：2008-12-04T17:25:08.820
> 
> 标签：c, linux, kernel, kernel-module

I'm writing a Linux module and getting:

```
Unable to handle kernel NULL pointer dereference 
```

What does it mean?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T17:28:36.113

Sounds like a pointer which currently has the NULL value (zero) is being dereferenced. Assign an address to the pointer before dereferencing it.

e.g.

```
int x = 5;
int * x_ptr = NULL;

x_ptr = &x; // this line may be missing in your code

*x_ptr += 5; //can't dereference x_ptr here if x_ptr is still NULL 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T17:31:46.590

The kernel tries to read from address `0`, which your kernel apparently treats specially (good thing!). As the kernel has no way to just kill itself like we know from user mode applications (those would have received a [Segmentation Fault](http://en.wikipedia.org/wiki/Segmentation_fault)), this error is fatal. It will have probably [panic'ed](http://en.wikipedia.org/wiki/Kernel_panic) and displayed that message to you.

* * *

[http://en.wikipedia.org/wiki/Null_pointer#The_null_pointer](http://en.wikipedia.org/wiki/Null_pointer#The_null_pointer)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-04T18:12:27.273

It means the kernel tried to deference a null pointer. This generates a page fault which can't be handled in the kernel- if it's running a user task (but in kernel space), it generally makes an "Oops" which (uncleanly) kills the current task and may leak kernel resources. If it's in some other context, e.g. an interrupt, it generally causes a kernel panic.

# javascript - Javascript的setTimeout函数没有调用

> ID：341423
> 
> 赞同：5
> 
> 时间：2008-12-04T17:26:22.263
> 
> 标签：javascript, settimeout

setTimeout 函数似乎总是给我带来麻烦。现在我有一个递归函数（通过 setTimeout 调用自身）并更改元素高度。

该函数发送两个参数：要更改的元素和该元素的最大高度。该功能的目的是展开元素，或以恒定的速度“向下滑动”。我知道我可以用 jQuery 解决这个问题，但我正在尝试我自己的函数。

```
function slide_down(element, max_height)
{   
    if(element.clientHeight < max_height)
    {
        var factor = 10;
        var new_height = (element.clientHeight + factor >= max_height) ? max_height : (element.clientHeight + factor);
        element.style.height = new_height + 'px';

        var func_call = 'slide_down(' + element + ', ' + max_height + ');';
        window.setTimeout(func_call, 10);
    }
} 
```

我在最初调用函数时测试了参数。max_height 设置为 20，因为它是元素所需的高度（我从 .scrollHeight 得到这个值）。

当函数完成后，我想让它自己调用，直到 max_height 是元素的高度。我通过这个 setTimeout 调用来做到这一点：

```
var func_call = 'slide_down(' + element + ', ' + max_height + ');';
window.setTimeout(func_call, 10); 
```

它不工作。这确实有效：

```
var func_call = 'alert(1);';
window.setTimeout(func_call, 10); 
```

我也试过把函数调用直接放到setTimeout语句中，还是不行。

请注意，元素的高度确实改变了第一次迭代，该函数永远不会调用自己。所以元素变量设置正确，我使用 alert() 显示 max_height 也是正确的。

```
alert(func_call); 
```

提醒这个：

```
slide_down([object HTMLParagraphElement], 20); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-04T17:36:43.913

当你这样做时：

```
var func_call = 'slide_down(' + element + ', ' + max_height + ');'; 
```

您正在将元素转换为字符串，因此您的超时将如下所示

```
slide_down("[Object]", 100); 
```

这显然行不通。

你应该做的是创建一个闭包——它有点复杂，但基本上你创建了一个函数，旧函数中的局部变量在新函数中仍然可用。

```
function slide_down(element, max_height)
{   
    if(element.clientHeight < max_height)
    {
        var factor = 10;
        var new_height = (element.clientHeight + factor >= max_height) ? max_height : (element.clientHeight + factor);
        element.style.height = new_height + 'px';

        var func = function()
        {
            slide_down(element, max_height);
        }

        window.setTimeout(func, 10);
    }
} 
```

10 也有点短，我建议至少使用 50。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T17:37:55.720

首先，如果你不改变时间段，这个“现在我有一个递归函数（通过 setTimeout 调用自身）”向我尖叫**[setInterval 。](http://www.w3schools.com/jsref/met_win_setinterval.asp)**

其次，这是因为元素引用在字符串 concat 中丢失，因为 element.toString() 将是“[object]”。尝试传入一个您可以重新查找的 id，将引用存储到一个级别，或者（正如我刚刚看到的 matt b 指出的那样）扩展的方法形式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-01T09:18:18.747

编写方法的更微妙的方式（作为 Gregs 答案的扩展）：

```
function slide_down(element, max_height)
{   
    if(element.clientHeight < max_height)
    { return; }

    var factor = 10,
        new_height = element.clientHeight + factor,
        f = arguments.callee;

    if( new_height > max_height )
    { new_height = max_height; }

    element.style.height = new_height + 'px';

    window.setTimeout(function() { f(element, max_height); }, 10);
} 
```

此示例代码的真正优势在于使用`arguments.callee`. 如果您决定重命名它，这样您就不会破坏您的功能。我还简化了`new_height`赋值。旧代码中的问题是您执行了`element.clientHeight + factor`两次，这有点不必要。并不是说在这种情况下它对你的表现有任何明显的影响。但是避免一遍又一遍地计算相同的东西总是好的，而只是存储结果以备后用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T17:34:29.907

我有过类似的经历。当您下次传递元素时，它会在函数调用中转换为字符串，因此当函数运行时，它会尝试查找名为 [object].string 或其他内容的元素，而不是您想要的。

尝试更改您的函数参数以获取元素的 id 并在函数内执行 document.getElementById() 调用的第一件事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T17:40:44.763

您的代码的问题是您无法传递元素参数。

代替：

```
var func_call = 'slide_down(' + element + ', ' + max_height + ');';

window.setTimeout(func_call, 10);

```

尝试使用匿名函数：

```
window.setTimeout(function() {
    slide_down（元素，最大高度）
}, 10);

```

@matt.b：IE 不支持传入 setTimeout 调用的参数（您的方式）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T17:34:37.067

两件事情：

**1.**有另一种调用方式`setTimeout()`，即传递函数和参数，而不是要执行的字符串。事实上，[Gecko DOM 手册指出](https://developer.mozilla.org/en/DOM/window.setTimeout)`setTimeout()`不推荐使用您的调用版本。

代替：

```
var func_call = 'slide_down(' + element + ', ' + max_height + ');';
window.setTimeout(func_call, 10); 
```

试试这个：

```
window.setTimeout(slide_down, 10, element, max_height); 
```

***更新****：正如 RoBorg 提到的，这在 IE 中可能不起作用，所以你不妨忽略它。*

* * *

**2.**我有一种感觉，`setTimeout()`从一个被自己调用的函数中调用`setTimeout()`要么是不允许的，要么是不能正常工作的。我假设您正在链接这样的调用，因为您希望代码重复执行？如果是这样，那[`window.setInterval()`](https://developer.mozilla.org/en/DOM/window.setInterval)就是为了。

# sql-server-2005 - 不支持 ITransactionLocal 接口

> ID：341424
> 
> 赞同：4
> 
> 时间：2008-12-04T17:26:35.320
> 
> 标签：sql-server-2005, oledb

我有一个 .NET 3.5 C# 库，它使用 OleDb 从 Excel 文件中提取数据并在 SQL Server 2005 中的 CLR 表值函数使用的 DataRowCollection 中返回它。

当我在其上使用 SELECT 时，该功能工作正常。但是，如果我想将其输出用作 INSERT INTO 表的源，则会收到以下错误：

System.InvalidOperationException：“Microsoft.Jet.OLEDB.4.0”提供程序不支持 ITransactionLocal 接口。当前提供商无法使用本地交易。System.InvalidOperationException：在 System.Data.OleDb.OleDbConnectionInternal.EnlistTransactionInternal（事务事务，布尔强制自动）在 System.Data.OleDb.OleDbConnection.Open() 在 GetExcelFunction.GetFile(String strFileName) 在 GetExcelFunction.InitMethod(String strFileName)

那么，我该如何解决呢？我是否停止创建事务的连接？如果有怎么办？我在 OleDbConnection 上没有看到任何相关的方法或属性。连接字符串中是否有参数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-06T17:40:36.507

将“;OLE DB Services=-4”添加到连接字符串。

# stl - 如何使用 SGI STL hash_map？

> ID：341429
> 
> 赞同：0
> 
> 时间：2008-12-04T17:27:41.420
> 
> 标签：stl, hashmap, sgi

我正在尝试使用从他们的网站下载的 SGI STL 实现。我想使用 hashmap，因为我必须存储大约 5.000.000 条记录，但这应该很好：我需要能够非常快速地访问它。我试过`stedext::hash_map`了，但速度很慢，因为我无法设置初始大小。顺便说一句，有可能这样做吗？如果我将附加路径添加到我的 MS Visual Studio，我什至无法从 SGI 站点编译示例。我收到一条错误消息：

```
error C2061: syntax error : identifier 'T'. 
```

有没有其他人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-05T18:04:43.403

我承认我自己没有尝试过，但是 VS2008 应该支持 TR1，其中包含：

```
#include <tr1/unordered_map> 
```

它在“功能包”版本中。 [http://www.microsoft.com/downloads/details.aspx?FamilyId=D466226B-8DAB-445F-A7B4-448B326C48E7&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=D466226B-8DAB-445F-A7B4-448B326C48E7&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T17:36:40.667

我已经多次使用它而没有问题，尽管我将它用于 gcc（在 Windows 和 linux 上）而不是 Visual Studio。

对于实际使用，文档在[这里](http://www.sgi.com/tech/stl/hash_map.html)。

您可以指定使用多少*个桶*来保留

```
void resize(size_type n) 
```

关于*标识符 T*的问题，我假设您忘记用实际类型替换名为 T 的模板参数。如果您无法弄清楚，也许可以粘贴您如何使用 hash_map 的代码片段。

文档中的示例：

```
#include <hash_map>
#include <iostream>

struct eqstr
{
  bool operator()(const char* s1, const char* s2) const
  {
    return strcmp(s1, s2) == 0;
  }
};

int main()
{
  std::hash_map<const char*, int, hash<const char*>, eqstr> months;

  months["january"] = 31;
  months["february"] = 28;
  months["march"] = 31;
  months["april"] = 30;
  months["may"] = 31;
  months["june"] = 30;
  months["july"] = 31;
  months["august"] = 31;
  months["september"] = 30;
  months["october"] = 31;
  months["november"] = 30;
  months["december"] = 31;

  std::cout << "september -> " << months["september"] << endl;
  std::cout << "april     -> " << months["april"] << endl;
  std::cout << "june      -> " << months["june"] << endl;
  std::cout << "november  -> " << months["november"] << endl;
} 
```

当然，如果您愿意，可以使用 std::string 代替 char*：

```
std::hash_map<std::string, int, hash<std::string>, eqstr> months; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T15:03:46.793

是的，您只会找到 SGI STL 网站上指示的头文件。正如您所注意到的，链接依赖项仅适用于 .lib 文件，因此无需在其中添加任何内容。

您正在编译 Dan 发布的示例仍然正确吗？您可能需要使用引号而不是括号来指定包含标题。所以用...

```
#include "hash_map" 
```

代替...

```
#include <hash_map> 
```

这可能是编译器如何搜索包含文件的问题。作为附加询问，您使用的是什么版本的 Visual Studio？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T20:27:32.243

这听起来很合理。您的 STL 目录的结构是什么？你是从他们的网站上得到所有的 SGI STL 文件还是只有一个？可能是您缺少一个导致您看到的错误的依赖文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T17:08:34.467

正如我在一个讨论论坛上注意到的关于这个问题的线程中所指出的，SGI STL 实现似乎在很长一段时间内都没有更新。在下载页面上，它甚至提到 2000 年 6 月 8 日是最后一次更新。我怀疑让 SGI STL 实现在 VS 2005/2008 下工作比它的价值更麻烦。

我建议检查一些 STL 替代品...

*   STL 端口 - [http://www.stlport.org/download.html](http://www.stlport.org/download.html)
*   提升 - [http://www.boost.org/](http://www.boost.org/)

两者都定期更新。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T20:39:53.373

我已经下载了这个库的压缩版本，那个压缩包里只有头文件。Linker 下还有另一个选项，它调用附加依赖项，但那里只有 *.lib 文件。我的设置的命令行看起来：

```
/Od /I "C:\SGI" /D "_MBCS" Gm /EHsc /RTC1 /MDd /Fo"Debug\\"/Fd"Debug\vc90.pdb" /W3 /nologo /c /ZI /TP /errorReport:prompt 
```

我不知道它是否更有用....

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T19:28:48.383

当您尝试构建/编译您的项目时，是否还会显示任何其他错误消息？
你提到你...

> 在 SGI STL 所在的项目中添加了一个附加目录。

你能扩展一下吗？有很多地方可以在 Visual Studio 项目设置中添加目录。即添加额外的头文件路径、额外的库路径等。你在哪里添加你的目录？

# wcf - IIS6 中托管的 WCF 服务在生产中获得 404

> ID：341438
> 
> 赞同：6
> 
> 时间：2008-12-04T17:30:37.823
> 
> 标签：wcf, iis-6, load-balancing

我已经构建了一个简单的 WCF 服务并将其部署到 IIS6，我注意到它在我的开发和暂存环境中有效，但在生产环境中无效。每次我尝试点击服务元数据链接时，我都会得到一个 404 页面。

我已经检查了所有我能想到的 IIS 配置，它们是相同的，所以我能想到的唯一区别是生产环境是负载平衡的。

有谁知道在负载均衡器后面运行 WCF 服务有任何问题，我该如何解决？我是不是走错了路，还有另一个我应该研究的常见问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-09T17:35:51.383

您需要在 IIS6 上设置通配符映射。这个[链接](http://peterkellner.net/2008/08/24/urlrewrite-with-aspnet-urlrewriter-wildcard-mapping-iis6-iis7/)似乎是一个很好的分步指南。

尝试阅读 IIS7 上集成管道与经典管道之间的差异

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-23T00:19:06.067

根据 AnthonyWJones 的回答，对我来说 .svc 已经映射到 aspnet_isapi.dll ：

[![在此处输入图像描述](https://i.stack.imgur.com/ZmEB6.jpg)](https://i.stack.imgur.com/ZmEB6.jpg)

[![在此处输入图像描述](https://i.stack.imgur.com/oYSBk.jpg)](https://i.stack.imgur.com/oYSBk.jpg)

我一直得到 404，但日志 (C:\WINDOWS\system32\LogFiles\W3SVC1) 没有任何帮助，我所有的 WCF 设置和 web.config 都是教科书示例。我三次检查了所有权限...

我的问题原来是我在 .Net 4.0 中构建了我的 WCF 服务，在我安装 ASP.net 4.0 之后使用`aspnet_regiis -i -enable`它立即工作：

[![在此处输入图像描述](https://i.stack.imgur.com/6zvBs.png)](https://i.stack.imgur.com/6zvBs.png)

# asp.net - ASP.Net 脚本控件，从 OnClick 和 FireFox 返回 False

> ID：341449
> 
> 赞同：1
> 
> 时间：2008-12-04T17:33:17.977
> 
> 标签：asp.net, javascript, firefox, scriptcontrol

**简短说明：**

我有一个脚本控件，它在脚本文件中处理了单击事件。Click 处理程序弹出确认提示并返回提示的值。

**问题：**

IE 看到返回 False（在确认框中选择了取消）并且没有回发。Firefox 忽略这一点并触发回发。

**解决方案？：**

我读到，如果我以老式方式执行此操作，则需要：

```
onClick="return SomeMethod();" 
```

在标记中。希望有一种方法可以使用脚本控件来做到这一点？

**例子：**

这是我在脚本文件中的内容：

```
//THIS IS THE METHOD CLICK CALLS
handleLnkDeleteButtonClick: function(e)
{
    var confirmed = confirm('This will delete the current Message category and move all messages to the Oprhan cataegory.  Continue?');
    return confirmed;
},

initialize: function()
{
    this._lnkDeleteButton = $get(this._lnkDeleteButtonID);
    this._lnkDeleteButton.idpicker = this;

    //HOOK BEGINS HERE
    this._lnkDeleteButtonClick = Function.createDelegate(this, this.handleLnkDeleteButtonClick);
    $addHandler(this._lnkDeleteButton, "click", this._lnkDeleteButtonClick);
    //END HOOK HERE

    NDI.WebControls.Client.PersonalMessageTypePicker.callBaseMethod(this, 'initialize');
},

dispose: function()
{
    $removeHandler(this._lnkDeleteButton, "click", this._lnkDeleteButtonClick);
    NDI.WebControls.Client.PersonalMessageTypePicker.callBaseMethod(this, 'dispose');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T17:56:22.657

好的，在花了太多时间试图为谷歌正确表达事情之后，我自己解决了这个问题。原来有一种方法可以调用，这样您就不必担心返回真假。

```
handleLnkDeleteButtonClick: function(e)
{
    var confirmed = confirm('This will delete the currery Message category and move all messages to the Oprhan cataegory.  Allow?');
    if (!confirmed)
    {
        e.preventDefault();
    }
}, 
```

因此，我不必返回确认，只需检查它的值并调用 e.preventDefault 方法来阻止点击触发。

# .net - 用于生成正则表达式的最终用户工具

> ID：341455
> 
> 赞同：9
> 
> 时间：2008-12-04T17:35:31.560
> 
> 标签：.net, regex, nlp

我们有一个 SaaS 应用程序要求，允许负责构建 CMS 站点的用户在一个表单中定义多达 10 个自定义字段。作为该字段定义的一部分，我们希望添加一个字段验证选项，我们将其存储（并在运行时应用）为 reg-ex。

是否有任何工具、代码示例或类似工具提供向导式前端来构建 reg-ex。我们希望将控件或代码嵌入到我们的 .NET 站点中，以便从（伪）用户友好的术语（如果可能的话，接近自然语言）生成正则表达式。

例如，字段 1 =（5 个字母数字）后跟（1 到 3 个数字）后跟“-”，后跟 1 个字母

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-08T14:43:56.677

我不知道您可以将任何工具嵌入到您的应用程序中。我开发的 RegexBuddy 确实提供了一个 COM 接口和一个命令行接口，允许您的应用程序向 RegexBuddy 发送正则表达式，并从 RegexBuddy 接收修改后的正则表达式。 [RegexBuddy 的网站](http://www.regexbuddy.com/integration.html)有更多详细信息。

RegexBuddy 显示正则表达式的英语语言分析，并提供“插入标记”菜单，无需记住语法即可轻松构建正则表达式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T17:47:28.790

我真的很喜欢 regexbuddy [http://www.regexbuddy.com/](http://www.regexbuddy.com/)

expresso 真的很好用，会生成c#代码 [http://www.ultrapico.com/Expresso.htm](http://www.ultrapico.com/Expresso.htm)

两者都会向您显示正则表达式的“伪”表示

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T17:47:38.867

快递：

> [http://www.codeproject.com/KB/dotnet/expresso.aspx](http://www.codeproject.com/KB/dotnet/expresso.aspx)

还有一个高级（商业）版本（[http://www.ultrapico.com/Expresso.htm](http://www.ultrapico.com/Expresso.htm)）

# c# - 没有 p/invoke 的长到短路径名

> ID：341458
> 
> 赞同：1
> 
> 时间：2008-12-04T17:36:40.590
> 
> 标签：c#, vb.net, visual-studio-2008, .net-3.5, .net

有谁知道如何在没有 p/invoke 的情况下将 .net 3.5 中的长路径名转换为短路径名？如果必须，我可以使用 p/invoke 来完成，但我不想这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T17:42:33.650

我认为 P/Invoke 是唯一的方法。

# php - 在自定义 X-Cart PHP 页面中编辑包含的内容

> ID：341461
> 
> 赞同：0
> 
> 时间：2008-12-04T17:36:58.780
> 
> 标签：php, x-cart

我的客户主页是[https://www.quakereadykit.com/store/home.php](https://www.quakereadykit.com/store/home.php)

这是以前的设计师给我的，我不知道如何完成更改“欢迎”文本旁边的小照片的简单任务。我在 FF 中使用 Firebug 来尝试剖析页面，但我找不到源。似乎是来自另一个文件的包含。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-12-04T20:07:50.690

也许我遗漏了一些东西，但它似乎是一个名为“kitad.gif”的图像，位于“/images/”目录中（即位于 web 根目录下的名为“images”的文件夹）。

如果找不到嵌入它的代码，则可以通过将具有相同名称和（理想情况下）相同尺寸的新图像上传到同一文件夹中来替换它。

# c++ - BSTR 和 _bstr_t 有什么区别？

> ID：341462
> 
> 赞同：22
> 
> 时间：2008-12-04T17:37:04.787
> 
> 标签：c++, com, smart-pointers

任何人都可以解释上述类型之间的区别和一些示例用法以清楚地解释两者之间的区别吗？

任何帮助将不胜感激！注意：这个问题是从[另一个问题衍生而来的](https://stackoverflow.com/questions/324168/msxml2ixmldomdocument2ptr-getxml-messing-up-my-string)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-05T11:40:36.890

BSTR 是与 COM 一起使用的字符串数据类型。

_bstr_t 是一个像智能指针一样工作的包装类，因此它会在变量被销毁或超出范围时释放分配的内存。_bstr_t 还具有引用计数，每次按值传递 _bstr_t 变量时都会增加（避免不必要的复制），并在不再使用时减少。每当销毁所有引用时，都会释放为字符串分配的内存。

BSTR 的替代品是 CComBSTR。它还管理 BSTR 的内存，但没有引用计数。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-04T17:57:40.063

**BSTR**是一个原始指针，**`_bstr_t`**而是一个封装该指针的类。

**这与char***与**std::string**的区别相同。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-04T17:57:06.663

_bstr_t 包装 BSTR 类型。因此，当您实例化一个 _bstr_t 时，您也在创建 BSTR。_bstr_t 简单地为您包装所有内容，并且对 BSTR 来说有点像“智能 ptr”。

BSTR

[http://msdn.microsoft.com/en-us/library/ms221069.aspx](http://msdn.microsoft.com/en-us/library/ms221069.aspx)

SysAllocString()

[http://msdn.microsoft.com/en-us/library/ms891285.aspx](http://msdn.microsoft.com/en-us/library/ms891285.aspx)

_bstr_t

[https://msdn.microsoft.com/en-us/library/zthfhkd6.aspx](https://msdn.microsoft.com/en-us/library/zthfhkd6.aspx)

# java - JSTL 的替代品有哪些？

> ID：341464
> 
> 赞同：16
> 
> 时间：2008-12-04T17:37:13.663
> 
> 标签：java, model-view-controller, jsp, jstl

有没有 JSTL 的替代品？我在 3 年前工作的一家公司使用 JSTL 和自定义标记库将表示与逻辑分开。前端开发人员使用 EL 来执行复杂的表示逻辑，在 JSP 页面中生成布局，效果很好。也许新技术已经问世。这几天有什么好点的吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-04T18:18:44.687

JSTL 和 EL 是两个不同的概念。

JSTL 只是一个标签库。大多数框架都提供自己的标记库，大致复制了 JSTL 的功能。我大致说一下，因为这些经常误用或忽略 JSP 和 Servlet API 的关键原则。

JSTL 的优势在于它是由 JSP 的作者设计的，对 JSP 和 servlet 有深入的了解。第三方标签库通常是由一些不想 RTFM 并决定“从头开始”并想出“更简单的东西”的人创建的。然而，JSTL 并不打算包揽一切。它可以非常成功地与其他标签库结合使用，包括您自己的自定义标签。

表达式语言是 JSP 的基础。它由容器解释，并且可以在许多情况下使用。它在很大程度上也没有副作用，并且具有简单、易于理解的语法，不允许将大量逻辑填充到表示层中。作为 Java EE 规范的一部分，它还享有广泛的工具支持。例如，当您重命名属性时，许多 IDE 可以重构依赖的 EL 表达式。

Struts2 将 OGNL 介绍给了更广泛的受众。OGNL 是对小脚本邪恶时代的回归。它更强大，因此开发人员乐于滥用它来调用表示层中的任意方法和其他暴行。攻击者也很乐意利用它；它是[基于 Struts2 的应用程序中的常见漏洞来源。](http://struts.apache.org/release/2.3.x/docs/security-bulletins.html)

我从以前使用 WebWork 的多年经验中熟悉 OGNL，而我对 Struts2 最大的失望是未能抛弃这个垃圾。甚至 WebWork 的创始人 Patrick Lightbody[也承认采用是一个错误。*](https://news.ycombinator.com/item?id=6081428)幸运的是，它只能在有限的上下文中使用，例如 OGNL 感知标签（以及其他一些令人惊讶的地方），这与容器本身支持的 EL 不同，并且可以在页面的任何地方使用。

如果您想摆脱 JSP，但不喜欢 JSF 这样的基于组件的方法，您可以查看 Terrence Parr 的[StringTemplate](http://www.stringtemplate.org/)项目。重点是无副作用，这为安全性和可扩展性提供了宝贵的改进。

* QFT：在成功攻击基于 Struts2 的 Apple Developer 网站后，Patrick Lightbody 说：“可悲的是，我对这个相当大的安全漏洞感到有些责任。有几个这样的，它们都植根于这样一个事实：大约 9 年前，我做了一个（错误的）决定，使用 OGNL 作为 WebWork 的表达语言。我这样做是因为它‘强大’，但它开启了各种我从未想过的额外绑定技巧。”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T17:49:43.747

我已经非常成功地使用了[速度](http://velocity.apache.org/)，它作为一种将业务逻辑与表示逻辑分离的简单方法非常有效。而且它很简单，您的普通 Web 开发人员可以理解它。 [Freemarker](http://freemarker.sourceforge.net/)也是很多人喜欢的另一种模板替代品。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T17:50:46.130

JSTL 是一个标签库，包含可在 JSP 页面中使用的逻辑函数。其他此类库也存在，但很可能您想查看整个 jsp/jstl 解决方案的修改方法。

最值得注意的是，我建议您查看：

阿帕奇检票口

带有 facelets 的 JSF

谷歌网络工具包 (GWT)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-05T04:50:55.313

JSTL 鼓励您在 UI 中加入逻辑。尝试使用 Apache Wicket，而不是在 java 中完成逻辑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T18:12:36.180

假设您正在寻找一种使用 MVC 开发应用程序的更简单方法，我强烈建议您查看[Spring Framework](http://www.springframework.org/)。Spring 有自己的标签库，它提供了 JSP 中您应该需要的大部分内容。我在使用 Spring webflow 和 Spring forms 标签库方面取得了巨大的成功。我喜欢将应用程序划分为持久层（使用 Spring 对 Hibernate 的 ORM 支持）、服务层（业务逻辑）和视图层。视图层包括用于验证和操作的 Web 流、JSP 和 POJO。我还在视图层中使用 DWR 进行 AJAX 调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T17:50:58.737

我不会说它们是替代品或替代品，但我认为[Java-Server-Faces](http://jsftutorials.net/)在将表示与逻辑分离方面更进一步......

# windows-vista - 如何在 Vista 控制台应用程序中处理 EndProcess 事件？

> ID：341467
> 
> 赞同：0
> 
> 时间：2008-12-04T17:37:29.183
> 
> 标签：windows-vista, console

我有一个控制台应用程序。在 XP 中，我可以使用`SetConsoleCtrlHandler()`注册一个接收的回调`CTRL_LOGOFF_EVENT`，`CTRL_C_EVENT`以及其他一些。它工作得很好。调用回调时，我可以在从调用返回之前进行清理。问题是，`SetConsoleCtrlHanlder()`Vista 不支持。怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T16:26:02.213

SetConsoleCtrlHandler 在 Vista 上对我来说工作得很好，而且[它的 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms686016(VS.85).aspx)上没有任何迹象表明它不应该。

您是否难以在 Vista 系统上使用相同的代码？如果是这样，您看到什么故障模式/错误代码？

# asp.net - .NET 的变量/Ram 查看器？

> ID：341470
> 
> 赞同：1
> 
> 时间：2008-12-04T17:39:14.967
> 
> 标签：asp.net, com, object

我在 .NET 中使用办公自动化。它留下了 excel.exe 程序。我知道解决方法 - 这完全是关于明确定义变量。一旦定义，我可以正确地取消分配内存，GC 会清理它们。

问题是，我实际上有数千行代码要处理。所以我想知道：.net（或第 3 方）中是否有某种实用程序能够向我显示我仍然为其分配了 ram 的变量列表？如果是这样，我将能够针对这些项目并专门取消分配它们。

谢谢

瑞安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T17:44:58.997

[http://www.automatedqa.com/techpapers/net_allocation_profiler.asp](http://www.automatedqa.com/techpapers/net_allocation_profiler.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T19:32:07.237

为了清楚起见，您需要在通过自动化完成使用 Excel 后显式退出 Excel。如果您不这样做，即使您的变量超出范围并且垃圾收集运行，实例也会继续运行。我相信它 Quit() 的命令：

```
Excel.ApplicationClass excel = new Excel.ApplicationClass();
//do some work with Excel
excel.Quit(); 
```

我建议您使用 try/catch/finally 来执行此操作

```
Excel.ApplicationClass excel = null;

try
{
  excel = new Excel.ApplicationClass();
  //do some Excel work
}
catch(Exception ex)
{
  //log exception
  throw;
}
finally
{
  if(excel != null)
    excel.Quit();
} 
```

# powershell - powershell：如何将get-date格式化为字符串并删除0？

> ID：341471
> 
> 赞同：11
> 
> 时间：2008-12-04T17:39:15.593
> 
> 标签：powershell

当我通过尝试运行 get-date cmdlet 时，我试图消除日期中的任何前导零：

```
$filedate = get-date -uformat "%m-%d-%Y" 
$filedate = $filedate.ToString().Replace("0", "") 
```

这将返回“01-04-2008”

我希望输出为“1-4-2008”

关于另一种方法的任何想法？

提前致谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-04T17:52:10.480

```
$filedate = get-date -format "M-d-yyyy" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T17:43:52.150

$fileDate = $fileDate.ToString("Md-yyyy")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-15T14:22:42.273

使用格式字符串，如：

```
get-date -format yyyy/M/d 
```

或者

get-date.tostring(yyyy/M/d)

# java - 在 Java 中以编程方式创建 W3C DOM 的有效方法是什么？

> ID：341474
> 
> 赞同：5
> 
> 时间：2008-12-04T17:40:10.443
> 
> 标签：java, xml, dom

虽然我知道如何使用 DOM API 以漫长而艰巨的方式构建 DOM，但我想做一些比这更好的事情。有没有一种很好的、​​整洁的方法来构建分层文档，比如说，使用类似于 Hibernate 的 Criteria API 的 API？这样我就可以像这样将调用链接在一起，例如：

```
Document doc = createDocumentSomehow ();
doc.createElement ("root").createElements (
    doc.newElement ("subnode")
        .createElement ("sub-subnode")
            .setText("some element text")
            .addAttribute ("attr-name","attr-value"),
    doc.newElement ("other_subnode")); 
```

理想情况下，这将导致 XML 如下所示：

```
<root>
  <subnode>
    <sub-subnode attr-name = "attr-value">some element text</sub-subnode>
  <other_subnode />
</root> 
```

基本上，我想要 Java 本身不比我生成的文档长近四倍的东西。它存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T17:48:58.303

您肯定想使用`JDom`： http: [//www.jdom.org/docs/apidocs/](http://www.jdom.org/docs/apidocs/)。它可以像您描述的那样使用，因为许多方法返回对`this`. 这是我们的老师向我们展示的一些用于此 XML 文档的代码。没有测试过，但是老师很棒我相信他：

```
<adressbuch aktualisiert="1.4.2008">
    <adresse>
        <vorname> Hugo </vorname>
        <nachname> Meier </nachname>
        <telefon typ="mobil">0160/987654 </telefon>
    </adresse>
</adressbuch> 
```

代码：

```
new Document(
     new Element ("adressbuch")
     .setAttribute("aktualisiert", "1.4.2008")
     .addContent(
         (Element) new Element("adresse")
         .addContent(
                     (Element) new Element("vorname")
                     .addContent("Hugo"))
         .addContent(
                     (Element) new Element("nachname")
                     .addContent("Meier"))
         .addContent(
                     (Element) new Element("telefon")
                     .setAttribute("typ", "mobil")
                     .addContent("0160/987654")))); 
```

从 API 手册来看，他所做的演员阵容似乎不是必需的。也许他只是出于文档目的而这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T17:43:41.840

我强烈推荐 Elliotte Rusty Harold 的[XOM](http://xom.nu/) API。

它与 W3C API 互操作，您可以在 XOM 和 DOM 之间进行转换。API 始终保证结构良好。它是高性能、健壮的，并且遵循一致的设计原则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T18:11:05.043

尝试查看 DOM4J 的[快速入门](http://www.dom4j.org/dom4j-1.6.1/guide.html)指南。它也使获取 XML 变得非常容易。我已经包含了一个相关的片段：

```
import org.dom4j.Document;
import org.dom4j.DocumentHelper;
import org.dom4j.Element;

public class Foo {

    public Document createDocument() {
        Document document = DocumentHelper.createDocument();
        Element root = document.addElement( "root" );

        Element author1 = root.addElement( "author" )
            .addAttribute( "name", "James" )
            .addAttribute( "location", "UK" )
            .addText( "James Strachan" );

        Element author2 = root.addElement( "author" )
            .addAttribute( "name", "Bob" )
            .addAttribute( "location", "US" )
            .addText( "Bob McWhirter" );

        return document;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T18:31:48.933

如果您愿意在您的 Java 应用程序中使用 Groovy，您可以使用[MarkupBuilder 进行敏捷 XML 创建](http://groovy.codehaus.org/Using+MarkupBuilder+for+Agile+XML+creation)。

# .net - 托管 C++ 中的泛型

> ID：341477
> 
> 赞同：3
> 
> 时间：2008-12-04T17:40:58.630
> 
> 标签：.net, generics, .net-2.0, managed-c++

我想在托管 C++ 项目中创建**KeyValuePair的****列表。**这是我正在使用的语法

 **```
List<KeyValuePair<String^, String^>^>^ thing; 
```

但我收到以下错误：

> 错误 C3225：“T”的泛型类型参数不能是“System::Collections::Generic::KeyValuePair ^”，它必须是值类型或引用类型的句柄

我基本上想这样做（C#）

```
List<KeyValuePair<string, string>> thing; 
```

但在托管 C++ 中。哦，在 .Net 2.0 中。有接盘侠吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T18:53:58.110

弄清楚了：

```
List<KeyValuePair<String^, String^>>^ thing; 
```

KeyValuePair 本身不需要是句柄。呃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T19:02:23.070

> KeyValuePair 本身不需要是句柄。呃。

因为它是值类型，而不是引用类型（即`struct`，而不是`class`在 C# 中）。

# perl - 当我使用模块时，如何找到 Perl 加载的文件？

> ID：341484
> 
> 赞同：48
> 
> 时间：2008-12-04T17:42:35.243
> 
> 标签：perl, module

在 Perl 中，当我这样做时`use <module name> <ver>;`，系统会在路径`.pm`中的某处找到库的文件。`@INC`

是否有可靠的方法来实际加载哪个文件？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-12-04T18:11:16.683

是的，[`%INC`](http://perldoc.perl.org/perlvar.html#%25INC)包含加载模块的完整路径。

例子：

```
$ perl -M'Data::Dump qw(pp)' -e 'pp(\%INC)'
{
  "Data/Dump.pm"         => "/usr/share/perl5/Data/Dump.pm",
  "Exporter.pm"          => "/usr/share/perl/5.10/Exporter.pm",
  "List/Util.pm"         => "/usr/lib/perl/5.10/List/Util.pm",
  "Scalar/Util.pm"       => "/usr/lib/perl/5.10/Scalar/Util.pm",
  "XSLoader.pm"          => "/usr/lib/perl/5.10/XSLoader.pm",
  "overload.pm"          => "/usr/share/perl/5.10/overload.pm",
  "strict.pm"            => "/usr/share/perl/5.10/strict.pm",
  "vars.pm"              => "/usr/share/perl/5.10/vars.pm",
  "warnings.pm"          => "/usr/share/perl/5.10/warnings.pm",
  "warnings/register.pm" => "/usr/share/perl/5.10/warnings/register.pm",
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-05T15:15:46.567

如果模块有 pod 文档，并且您可以保证 PATH 中的 perldoc 实用程序属于运行脚本的同一个 perl，那么此命令通常会为您提供找到的实际文件：

```
perldoc -l ModuleName 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-12-29T19:56:48.017

> perl -M'LWP' -e '使用数据::Dumper; 打印转储器 \%INC' | grep LWP

这将列出磁盘上的 LWP 模块位置，并列出在 LWP 中加载的模块。

```
 'LWP.pm' => '/usr/lib/perl5/5.10.0/LWP.pm',
      'LWP/Protocol.pm' => '/usr/lib/perl5/5.10.0/LWP/Protocol.pm',
      'LWP/UserAgent.pm' => '/usr/lib/perl5/5.10.0/LWP/UserAgent.pm', 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-04T21:03:00.330

您想查看变量，该变量记录了它为您使用、或`%INC`加载的库加载的文件名。有关详细信息，请参阅[perlvar](http://perldoc.perl.org/perlvar.html)。`do``require``use`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-04T18:10:56.590

CPAN 中有很多模块可用于查找此信息，最有可能的候选模块是 Module::Find、Module::Which 和 Module::Locate。我可能会选择 Module::Locate:

```
use strict;
use warnings;
use Module::Locate qw/locate/;

my $to_find = "Some::Module";

print "Perl would use: ", scalar locate($to_find), "\n"; 
```

在列表上下文中，locate 根据 @INC 的顺序返回所有找到的 Some::Module 副本。

编辑： [derobert 提出了一个更好的方法](https://stackoverflow.com/questions/341484/which-pm-is-perl-loading#341574)，我没有意识到 %INC 已经有了它......如果您想在加载要从中加载的模块之前知道这个基于模块的解决方案仍然很有用。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-06-09T17:02:41.553

这是一个单行（带有 bash 包装器），用于确定是否安装了模块 - 以及将从何处加载它：

```
#!/bin/bash
perl -M${1} -le "\$mname=\"${1}.pm\";\$mname=~s#::#/#g;print \"$1 INSTALLED AT \$INC{\$mname}\";" 2>/dev/null || echo "${1} NOT INSTALLED" 
```

使用 perl 的模块名称语法调用它：

```
./find_perl_module  Font::Metrics::Courier 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-04T17:53:31.833

根据我的发现，perl 将在路径中的目录中查找：

```
perl -le 'print foreach @INC' 
```

然后它将在标准库中查找，然后在当前目录中查找。

这会给你一个搜索顺序。

我的来源：

[扩展库路径](http://www.perlhowto.com/extending_the_library_path)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T18:22:50.277

[Module::Mapper](http://search.cpan.org/~darnold/Module-Mapper-1.01/lib/Module/Mapper.pod)提供了一种遍历 @INC 树来查找模块的方法：

```
perl -MModule::Mapper -MData::Dumper \
-e 'print Dumper( find_sources( UseINC => 1, Modules => [ @ARGV ] ) )' \
list-of-modules-to-locate 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-16T09:50:58.877

您可以使用 instmodsh 命令：[http](http://perldoc.perl.org/instmodsh.html) ://perldoc.perl.org/instmodsh.html 。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-02-03T10:51:01.200

我使用 shell 脚本 /usr/local/bin/which_perl_module

```
#!/bin/sh

if [ ! $1 ];then echo "Which perl module should I look for?"; exit; fi

echo -n "You are using: "
perldoc -l $1
echo "which I found by looking in:"
perl -MData::Dump=pp -e 'unshift @INC, '$1'; pp(\@INC)' 
```

# .net - 是否需要调用 AsyncOperation.PostOperationCompleted？

> ID：341496
> 
> 赞同：0
> 
> 时间：2008-12-04T17:45:26.563
> 
> 标签：.net, multithreading

我使用`AsyncOperation`该类来避免编写大量“if (control.InvokeRequired) then/else”方法（与其在基于事件的异步模式中的传统角色相反）。在某些情况下，我并不真正关心在工作线程完成时收到通知。因此，我不想`PostOperationCompleted`在 my 上调用该方法`AsyncOperation`，因为它需要我编写一个无操作回调。

我很好奇省略对`PostOperationCompleted`. 该文档表明它结束了操作的生命周期并使进一步的调用无效，它没有明确说明是否存在与此调用相关的至关重要的内部行为。它确实暗示了省略调用可能会产生内部后果，但最后我没有看到任何强烈建议总是调用它。

那么，我应该认为省略调用是不好的做法，还是没什么大不了的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-26T16:08:17.863

欧文，

如果您知道在您的情况下不需要将编组返回到原始调用者线程，那么您应该调用 OperationCompleted。在您的操作与其底层 SynchronizationContext 之间存在一个隐含的简单状态机。如果您知道一旦您的操作停止，它本身就不会成为问题，它不会在您的应用程序的其余部分中使用。虽然这实际上没问题，但从编程的角度来看，它需要考虑以下事项：

1.  首先，具有如何使用此构造的经验的人会期待异步操作的某种类型的完成，因此这会令人困惑 - 您应该在代码中明确这一点。

2.  操作完成的一个关键方面是从终结器列表中删除对象。对于一个或两个实例，这可能不是问题，但是如果这些操作的数量很大，您肯定会受到性能影响，因为您将允许所有这些 AsyncOperation 实例得到提升并且 GC 必须做更多的工作。所以你至少应该调用 OperationCompleted 来避免这种情况。

3.  仅在您确实需要时才调用 Post 版本，因为您再次用尽了资源，这里以提交到线程池的额外作业的名义，稍后涉及上下文切换和作业处理。如果不需要，请避免使用它，尤其是在第 2 点有效的情况下……尽管为了获得良好的实践，最好调用适当的版本。

高温高压

缺口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T13:38:39.183

PostOperationCompleted 的文档指出“AsyncOperation 对象将确保在适用于应用程序模型的线程或上下文上调用您的委托”。如果您的 GUI 线程需要在后台操作完成后执行某些操作，这一点非常重要。我认为这可能是首先使用这个类的最重要原因！

干杯，丹：）

# c# - 从文件中使用 AssemblyInfoTask 设置版本

> ID：341498
> 
> 赞同：2
> 
> 时间：2008-12-04T17:46:40.413
> 
> 标签：c#, msbuild

我对这个 MSBuild 工具完全陌生（并且仍然有些迷茫），但我仍然有一个问题有人可以回答：

我正在尝试通过文件的内容将版本信息自动生成到 AssemblyVersion.cs 文件中。

要设置版本信息，我发现 AssemblyInfoTask 工作得很好 - 但是我如何告诉该任务通过文件的内容来设置主要、次要、构建和修订，然后可以在一系列项目中一起使用？

好奇 - 并感谢任何回复，因为我在这里拉扯我的头发！;-)

你的，弗洛里安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T17:51:54.647

相反，您可以`AssemblyVersion.cs`在不同的项目中使用共享文件 - 如果这适合您的目标。
为此，只需添加一对一`AssemblyVersion.cs`项目，然后在其他项目中选择`Add -> Existing Items...`，选择`AssemblyVersion.cs`文件，然后`Add`单击它旁边的箭头并选择`Add As Link`。

# c# - “此故障的创建者未指定原因”异常

> ID：341512
> 
> 赞同：54
> 
> 时间：2008-12-04T17:49:58.737
> 
> 标签：c#, .net, wcf, faults

我在 WCF 服务中有以下代码，可以根据某些情况引发自定义错误。我收到“此故障的创建者未指定原因”异常。我究竟做错了什么？

```
//source code
if(!DidItPass)
{
    InvalidRoutingCodeFault fault = new InvalidRoutingCodeFault("Invalid Routing Code - No Approval Started");
    throw new FaultException<InvalidRoutingCodeFault>(fault);
}

//operation contract
[OperationContract]
[FaultContract(typeof(InvalidRoutingCodeFault))]
bool MyMethod();

//data contract
[DataContract(Namespace="http://myuri.org/Simple")]
public class InvalidRoutingCodeFault
{
    private string m_ErrorMessage = string.Empty;

    public InvalidRoutingCodeFault(string message)
    {
        this.m_ErrorMessage = message;
    }

    [DataMember]
    public string ErrorMessage
    {
        get { return this.m_ErrorMessage; }
        set { this.m_ErrorMessage = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-04T19:07:09.673

经过一些额外的研究，以下修改后的代码有效：

```
if(!DidItPass)
{    
    InvalidRoutingCodeFault fault = new InvalidRoutingCodeFault("Invalid Routing Code - No Approval Started");    
    throw new FaultException<InvalidRoutingCodeFault>(fault, new FaultReason("Invalid Routing Code - No Approval Started"));
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-10T20:12:35.923

简短的回答是您没有做错任何事，只是错误地读取了结果。

在客户端，当您捕获错误时，捕获的内容是`System.ServiceModel.FaultException<InvalidRoutingCodeFault>`.
您的`InvalidRoutingCodeFault`对象实际上在`.detail`FaultException 的属性中。所以....

// 客户端代码

```
private static void InvokeMyMethod() 
{ 
    ServiceClient service = new MyService.ServiceClient(); 

    try 
    { 
        service.MyMethod(); 
    } 
    catch (System.ServiceModel.FaultException<InvalidRoutingCodeFault> ex) 
    { 
        // This will output the "Message" property of the System.ServiceModel.FaultException
        // 'The creator of this fault did not specify a Reason' if not specified when thrown
        Console.WriteLine("faultException Message: " + ex.Message);    
        // This will output the ErrorMessage property of your InvalidRoutingCodeFault type
        Console.WriteLine("InvalidRoutingCodeFault Message: " + ex.Detail.ErrorMessage);    
    } 
} 
```

FaultException 的 Message 属性是错误页面上显示的内容，因此如果没有像 John Egerton 的帖子中那样填充它，您将看到“此错误的创建者未指定原因”消息。为了方便地填充它，在服务中抛出错误时使用两个参数构造函数，如下所示，从错误类型传递错误消息：

```
InvalidRoutingCodeFault fault = new InvalidRoutingCodeFault("Invalid Routing Code - No Approval Started");                                          
throw new FaultException<InvalidRoutingCodeFault>(fault, new FaultReason(fault.ErrorMessage)); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-28T11:33:46.990

```
serviceDebug includeExceptionDetailInFaults="true" 
```

不是解决方案

以下代码甚至可以使用`serviceDebug includeExceptionDetailInFaults="false"`

```
// data contract 

[DataContract]
public class FormatFault
{
    private string additionalDetails;

    [DataMember]
    public string AdditionalDetails
    {
        get { return additionalDetails; }
        set { additionalDetails = value; }
    }
}

// interface method declaration

    [OperationContract]
    [FaultContract(typeof(FormatFault))]
    void DoWork2();

// service method implementation

    public void DoWork2()
    {
        try
        {
            int i = int.Parse("Abcd");
        }
        catch (FormatException ex)
        {
            FormatFault fault = new FormatFault();
            fault.AdditionalDetails = ex.Message;
            throw new FaultException<FormatFault>(fault);
        }
    }

// client calling code

    private static void InvokeWCF2()
    {
        ServiceClient service = new ServiceClient();

        try
        {
            service.DoWork2();
        }
        catch (FaultException<FormatFault> e)
        {
            // This is a strongly typed try catch instead of the weakly typed where we need to do -- if (e.Code.Name == "Format_Error")
            Console.WriteLine("Handling format exception: " + e.Detail.AdditionalDetails);   
        }
    } 
```

如果不需要，则无需添加故障原因。只要确保 FaultContract 属性正确

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-07-08T09:17:47.723

我使用两个参数构造函数解决了这个问题。

```
// service method implementation

 throw new FaultException<FormatFault>(fault,new FaultReason(fault.CustomFaultMassage)); 
```

CustomFaultMassage 是数据合同的属性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T11:21:37.373

如果没有为方法指定 FaultContract(typeof(className)) 属性，也可能会遇到此异常

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-14T09:39:11.820

如果您不想收到此类异常的通知，请转到 Debug -> Exceptions 并取消选中“Common Language Runtime Exceptions”或特定异常的“User-unhandled”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-18T00:56:41.877

我的代码与 Rashmi 的代码一模一样，并且出现“此故障的创建者......”错误。当我在 VS2010 中调试时发生了这种情况。我找到了这篇文章：

[http://sergecalderara.wordpress.com/2008/11/25/systemservicemodelfaultexception1-was-unhandled-by-user-code/](http://sergecalderara.wordpress.com/2008/11/25/systemservicemodelfaultexception1-was-unhandled-by-user-code/)

这解释了我需要关闭的几个调试选项。问题解决了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T18:12:34.667

您可以在服务器配置中尝试此操作（行为 -> 服务行为 -> 行为）：

```
<serviceDebug includeExceptionDetailInFaults="true" /> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T00:43:55.977

通过使用强类型的 try catch，我能够解决错误“此错误的创建者没有指定原因”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-21T22:50:45.627

在客户端更新服务引用解决了这个问题。同样可以为你工作。

# caching - 您应该在哪一点缓存属性的值？

> ID：341516
> 
> 赞同：1
> 
> 时间：2008-12-04T17:50:44.743
> 
> 标签：caching, properties

我一直想知道何时何地是缓存属性值的最佳时间......其中一些看起来很简单，就像下面的那个......

```
public DateTime FirstRequest {
    get {
        if (this.m_FirstRequest == null) {
            this.m_FirstRequest = DateTime.Now;
        }
        return (DateTime)this.m_FirstRequest;
    }
}
private DateTime? m_FirstRequest; 
```

**但是一些更复杂的情况呢？**

1.  来自数据库的值，但在被选中后仍然为真。
2.  存储在内置缓存中并且可能不时过期的值。
3.  必须首先计算的值？
4.  需要一些时间来初始化的值。0.001 秒、0.1 秒、1 秒、**5 秒**？？？
5.  已设置的值，但可能会出现其他内容并将其设置为 null 以标记应重新填充它。
6.  **？？？**似乎有无限的情况。

**你认为一个属性不能再照顾自己而是需要一些东西来填充它的价值是什么？**

* * *

**[编辑]**

我看到一些建议说我优化得太早了，等等。但我的问题是什么时候优化。缓存所有内容不是我要的，但是当需要缓存时，应该由谁负责？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T18:40:31.787

一般来说，您应该先让代码工作，然后再进行优化，然后只进行分析认为对您有帮助的优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T18:38:13.040

我认为你需要把你的问题反过来，以免你陷入过早优化的陷阱。

### 您认为何时不再需要在每次调用时重新计算属性而是使用某种形式的缓存？

值的缓存是一种优化，因此不应作为规范进行。在某些情况下，使用此优化显然是相关的，但在大多数情况下，您应该通过执行适当的工作来获取值，然后在分析和显示后寻求优化它，从而使该属性每次都能正常工作需要优化。

缓存是或不是一个好主意的一些原因： - 如果值容易频繁更改，请不要缓存 - 如果它永远不会更改并且您负责它永远不会更改，请不要缓存 - 如果您不负责，请不要缓存提供价值，因为您依赖于其他人的实施

支持和反对缓存值的原因还有很多，但对于何时缓存和何时不缓存当然没有硬性规定——每种情况都不同。

### 如果你必须缓存...

假设您已经确定某种形式的缓存是可行的方法，那么执行缓存的方式取决于您要缓存的内容、原因以及向您提供值的方式。

例如，如果它是一个单例对象或您的示例中的时间戳，一个简单的“它设置了吗？” 设置一次值的条件是一种有效的方法（或者在构造期间创建实例）。但是，如果它正在访问数据库并且数据库告诉您它何时更改，您可以基于一个脏标志缓存该值，只要数据库值表明它已更改，该标志就会变脏。当然，如果您没有更改通知，那么您可能必须在每次调用时刷新值，或者在检索之间引入最短等待时间（当然，接受值可能并不总是准确的）。

无论哪种情况，您都应该始终考虑每种方法的优缺点，并考虑引用该值的场景。消费者是否总是需要最新的价值，或者他们可以应对稍微落后的情况？你能控制价值的来源吗？来源是否提供更改通知（或者您可以使其提供此类通知）？来源的可靠性如何？有许多因素会影响您的方法。

### 考虑到你给出的场景......

同样，假设需要缓存。

1.  来自数据库的值，但在被选中后仍然为真。
    如果保证数据库保留该行为，您可以在第一次请求该值时轮询该值，然后将其缓存。如果您不能保证数据库的行为，您可能需要更加小心。

2.  存储在内置缓存中并且可能不时过期的值。
    我会使用脏标志方法，其中缓存不时被标记为脏，以指示缓存的值需要刷新，假设您知道“不时”是什么时候。如果不这样做，请考虑使用一个计时器来定期指示缓存是脏的。

3.  必须首先计算的值？
    我会根据价值来判断这一点。即使您认为需要缓存，编译器也可能已经对其进行了优化。但是，假设需要缓存，如果计算时间很长，那么在构建期间或通过诸如`ISupportInitialize`.

4.  需要一些时间来初始化的值。0.001s、0.1s、1s、5s？？？
    我会让属性对此不进行计算并实现一个指示值何时发生变化的事件（这在值可能发生变化的任何情况下都是一种有用的方法）。一旦初始化完成，事件就会触发，允许消费者获取值。您还应该考虑到这可能不适合房产；相反，请考虑一种异步方法，例如带有回调的方法。

5.  已设置的值，但可能会出现其他内容并将其设置为 null 以标记应重新填充它。
    这只是第 2 点中讨论的脏标志方法的一个特例。

# c++ - 如何在类似 debian 的系统中使用 libapt（或 libept）来列出软件包并获取它们的信息？

> ID：341520
> 
> 赞同：13
> 
> 时间：2008-12-04T17:51:22.947
> 
> 标签：c++, debian, apt, package-managers

有人使用 libapt 或 libept 在类似 debian 的系统中列出软件包并获取有关软件包的信息？

Libapt 根本没有很好的文档记录，我发现很少有关于 libept 的示例和教程。有人可以解释我最好的方法吗

1.  获取 apt-system 中每个包的列表
2.  获取有关单个包的信息（如名称、版本、依赖项、描述等。
3.  获取单个包安装的文件列表

直接使用 apt 内部文件非常简单，但我想使用一个库来尊重 apt 规范。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-05-31T12:33:13.660

在 debian 中有一个名为的包`libapt-pkg-doc`，其中包含一些文档（如 API 参考）。安装后，您可以通过 file:///usr/share/doc/libapt-pkg-doc/html/index.xhtml 访问它。

我只是看了一下 libapt，这是我到目前为止所学到的：

如何列出所有包：

```
#include <apt-pkg/cachefile.h>
#include <apt-pkg/pkgcache.h>

int main() {
    // _config and _system are defined in the libapt header files
    pkgInitConfig(*_config);
    pkgInitSystem(*_config, _system);

    pkgCacheFile cache_file;
    pkgCache* cache = cache_file.GetPkgCache();

    for (pkgCache::PkgIterator package = cache->PkgBegin(); !package.end(); package++) {
        std::cout << package.Name() << std::endl;
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T18:16:17.687

看看 apt-cache(8) 是如何实现的。使用 apt 获取源代码很容易：

```
# apt-get source apt 
```

在源文件`cmdline/apt-cache.cc`中，有一个函数调用`DumpPackage()`，它从缓存中的命名文件中提取信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:57:33.373

如果您使用 perl，还有来自 CPAN 的 DPKG::Parse。

# printing - 将带有嵌入式 HP 打印机代码的文本文件转换为 PostScript

> ID：341521
> 
> 赞同：0
> 
> 时间：2008-12-04T17:51:23.540
> 
> 标签：printing, postscript

我有一个应用程序通过生成带有嵌入式打印机代码的文本文件进行打印，然后基本上只是将文件复制到打印机进行打印。我需要获取该打印文件并将其转换为图像 - 就像打印然后扫描一样。

我的第一个想法是使用附加到文件端口的 postscript 打印机驱动程序设置打印机，然后通过 ghostscript 运行结果以创建 tiff，但它不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T17:56:45.197

打印机代码可能是 PCL。也许[pcl-parser](https://pcl-parser.dev.java.net/)可以作为您自己的工具执行此操作的开始？似乎还有一个名为[PCLXForm](http://www.pclxform.com/)的商业产品。

编辑：还要调查[GhostPCL](http://www.artifex.com/downloads/)。

# web-applications - Java EE Web 应用程序的统计引擎

> ID：341530
> 
> 赞同：2
> 
> 时间：2008-12-04T17:54:03.737
> 
> 标签：web-applications, jakarta-ee, statistics, enterprise-library

我们正在开发一个 Java EE Web 应用程序，营销人员需要我们网站的一些非常详细的统计数据。类似于谷歌分析的东西，收集用户的信息，以及他们在网站上的导航（他们来自哪里，他们点击了什么，他们去哪里等等）。

不能选择依赖分析等第三方服务。

他们还希望将这些信息以图表和内容的形式呈现出来，这并不难，因为一旦收集了数据，它只是关于正确的查询和我们显示它的方式。

不想重新发明轮子，你知道是否有任何 API、框架或其他类型的库可以添加到项目中来实现这个目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T17:58:03.637

1）您可以使用日志分析器来分析 Web 服务器日志 - 使用 Tomcat 您需要安装一个执行此操作的模块，我忘记了名称。

2) 在您的数据库中创建一个名为 user_journey 或类似的表。在里面，您可以记录每次点击的所有相关详细信息。然后在您的根 servlet 或您使用的框架的等效项中，向此表添加一个条目，其中包含您需要的详细信息 - 按 session_id、user_id、page_hit 等进行跟踪。

[3) 创建汇总表，只生成一次月度和年度统计数据]

3）使用BIRT来呈现这些数据库表的分析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T14:13:27.250

查看 Open Symphony Clickstream 它可以提供帮助

# php - 正则表达式：匹配除完整标记之外的任何内容

> ID：341531
> 
> 赞同：1
> 
> 时间：2008-12-04T17:54:12.253
> 
> 标签：php, regex, pcre

我有以下代码片段，我想在其中提取`{foreach}`和`{/foreach}`使用正则表达式之间的代码：

```
{foreach (...)}
Some random HTML content <div class="">aklakdls</div> and some {$/r/template} markup inside.
{/foreach} 
```

我已经有了：

```
{foreach [^}]*} 
```

但在那之后我无法匹配任何东西。有什么办法可以匹配任何东西，但 {/foreach} 作为一个整体令牌？请注意，{foreach}{/foreach} 之间的内容也可以包含“{$”标记。

**编辑**：BaileyP 和 Tomalak 的答案是正确的，但为了简单起见，我选择了 BaileyP 的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T18:21:49.673

我想出了这个

```
/(?:{foreach .*?})(.*?)(?:{\/foreach})/gis 
```

用[RegExr测试](http://gskinner.com/RegExr/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T18:13:43.637

如果您的正则表达式风格不支持非贪婪匹配，则可以使用以下方法，但既然这样做了，我推荐[@BaileyP's answer](https://stackoverflow.com/questions/341531/regular-expression-match-anything-but-full-token#341603)。

```
\{foreach [^}]*\}((?:.(?!\{/foreach\}))*[^{]?) 
```

根据您喜欢的正则表达式，负零宽度前瞻和非捕获组看起来有些不同。

以下是组件：

```
\{foreach [^}]*\} // 几乎不言自明
( // 第一组比赛开始（这就是你要找的）
 (?: // 非捕获组开始
  . // 任何事物...
  (?!\{/foreach\}) // ... 后面没有“{/foreach}”
 )* // 非捕获组结束，尽可能多地重复
 [^{]？// 匹配最后一个字符，除非是“{”
) // 第一组匹配结束，完成

```

# c++ - 是否可以在 C++ 中构建一个没有依赖关系的 DLL？

> ID：341536
> 
> 赞同：6
> 
> 时间：2008-12-04T17:55:36.713
> 
> 标签：c++, dll

我想用我的 C# 应用程序部署一个非常简单的 DLL，但我在 Visual Studio 2008 中构建的任何 DLL 似乎都依赖于“Microsoft.VC90.CRT”。是否可以在没有这种依赖关系的情况下使用 VS2008 构建 DLL？我怎么知道是什么导致了依赖？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T18:05:51.640

我不确定最新的 VC++ 版本，但以前您可以告诉链接器链接到 MSVCRT 运行时库的静态版本，而不是动态 (DLL) 版本。这个选项可能仍然存在。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-04T18:17:59.117

根据[这个 MSDN page](http://msdn.microsoft.com/en-us/library/abx4dbyh.aspx)，静态库仍然可用。转到项目属性、配置属性、C/C++、代码生成、运行时库。

为调试配置选择多线程调试，为发布配置选择多线程。（不确定 VS2008 中的名称是否都相同，但应该是“附近的某个地方”。明天可以更新 VS2008 特定的差异）

此外，正如 wbic16 所建议的，使用依赖遍历器来识别其他静态依赖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T18:29:11.483

如果您绝对确定您对 C 运行时没有任何依赖关系，那么您可以通过在链接器 -> 输入项目选项页面下启用“忽略所有默认库”（/NODEFAULTLIB）标志来避免链接它。您可能还必须禁用基本运行时检查（在 C/C++ -> 代码生成下将“基本运行时检查”设置为默认值），并且您可能还必须删除入口点（将“无入口点”设置为“是 (/ NOENTRY)”在链接器 -> 高级) 下。

也可以看看[http://support.microsoft.com/kb/814472](http://support.microsoft.com/kb/814472)，它有一些关于为 C++ 托管扩展构建 DLL 的好信息。

**编辑：**请注意，在没有 C 运行时的情况下运行也意味着您没有像 malloc() 和 new 这样的简单内存分配函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T17:58:17.537

试试这个工具：http: [//www.dependencywalker.com/](http://www.dependencywalker.com/)。它将让您了解对给定 exe 或 dll 的依赖关系。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T12:18:01.167

通过一些工作，[libCTiny](http://msdn.microsoft.com/en-us/magazine/cc301696.aspx)仍然可以作为默认库的替代品。这种库使 /NODEFAULTLIB 可用。

要回答您的第二个问题，使用 /VERBOSE 链接器开关，链接器将告诉您哪些符号来自哪个库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T15:55:24.100

确保您在发布中构建的所有内容都像在调试中一样频繁，该 dll 与通常不随 windows 一起提供的特殊调试 dll 链接，并且会导致依赖性问题。

# c++ - 在 Windows 上，什么时候应该使用“\\\\?\\”文件名前缀？

> ID：341550
> 
> 赞同：14
> 
> 时间：2008-12-04T17:58:55.427
> 
> 标签：c++, winapi, unicode, filenames, max-path

我遇到了 ac 库，用于打开给定 Unicode 文件名的文件。在打开文件之前，它首先通过添加“\\?\”将文件名转换为路径。[根据这篇 msdn 文章](http://msdn.microsoft.com/en-us/library/aa365247.aspx)，除了增加路径中允许的最大字符数之外，还有什么理由这样做吗？

看起来这些“\\?\”路径需要 Windows API 和标准库的 Unicode 版本。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T18:32:23.253

是的，就是为了这个目的。但是，如果您决定创建超过 MAX_PATH 长度的路径，您可能会遇到兼容性问题。例如，资源管理器 shell 和命令提示符（至少在 XP 上，我不了解 Vista）无法处理超过该长度的路径，并且会返回错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-09T09:20:00.760

此方法的最佳用途可能不是创建新文件，而是管理其他人可能已创建的现有文件。

我管理了一个文件服务器，它通常会使用`path_length > MAX_PATH`. 您会看到，用户将文件视为`H:\myfile.txt`.，但在服务器上它实际上是`H:\users\username\myfile.txt`. 因此，如果用户创建了一个完全包含`MAX_PATH`字符的文件，那么在服务器上它就是`MAX_PATH+len("users\username")`.

（使用 MAX_PATH 字符创建文件并不少见，因为当您在 Internet Explorer 上保存网页时，它使用页面标题作为文件名，这对于某些页面可能很长）。

此外，与 Mac 或 Linux 机器共享驱动器（通过网络或 USB），您会发现自己拥有名称为 con、prn 或 lpt1 的文件。同样，前缀允许您和您的脚本处理这些文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T18:42:25.620

我认为首先要注意的是 "\\?\" 不会使路径成为 UNC 路径。你第二次称它为 UNC*风格*的路径时更准确。但即便如此，相似之处仅来自于开头有两个反斜杠。跟UNC真的没关系。*您必须使用更多*字符才能获得带有“\\?\”前缀的 UNC 路径这一事实支持了这一点。

我认为您有使用该前缀的全部理由。如您引用的文章中所述，它提高了最大长度限制。它仅适用于 Unicode 路径；非 Unicode 路径无法通过使用该前缀来避免限制。

需要注意的一件事是，前缀不允许用于相对路径，仅用于绝对路径。您可能需要仔细检查您的 C 库是否符合该限制。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-19T18:22:57.833

除了允许更长的路径外，“\\?\”前缀还允许您使用文件和目录名称，如“con”和“aux”。通常 Windows 会将它们解释为老式的 DOS 设备。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T18:11:56.120

自 1995 年以来我一直在编写 Windows 代码，虽然我知道这个前缀，但我从未找到任何使用它的理由。增加路径长度`MAX_PATH`似乎是唯一的原因，据我所知，我和我的程序的任何客户都没有这样做过。

# ruby-on-rails - Rails RESTful 控制器和自定义操作后的渲染

> ID：341571
> 
> 赞同：2
> 
> 时间：2008-12-04T18:10:55.730
> 
> 标签：ruby-on-rails, rest, redirect, action, render

如何在 restful 控制器中执行操作而不是重定向后进行渲染。

我有一个带有标准操作的控制器，并且我添加了一个特殊操作，通过#show 页面上的一个表单将数据添加到相关资源中（想想帖子上的评论）。我正在验证表单的输入，并希望在错误时重新呈现显示操作并在成功时重定向到显示操作。

我想渲染以防止用户两次输入他们的信息，但是当我尝试在 flash[:notice] 中渲染显示操作时出现错误时，我收到一条错误消息，指出我没有指定 ID。当我指定一个 ID 时，它会尝试呈现一个尚不存在的新模板。

我认为它应该很简单：

```
def add_comment
  if my_validation?
    save the object
    redirect_to :action => "show", :id => params[:id]
  else
    render :action => "show", :id => params[:id]
  end
end 
```

这不是我的实际代码，只是我刚才作为示例放在一起的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T18:34:16.667

最好的方法是重新渲染 :new

```
def create
  @obj = TheObject.new(params[:object])
  render :action => :new unless @obj.save
end 
```

而在 new.html.erb

```
<% form_for :obj, 
  :url => object_url(@obj), :html => {:method => :post} do |f| %>

  <%= f.text_field :name %>
<% end %> 
```

这样，表单中的输入将预先填充用户输入的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T18:38:21.620

创建一个新的数据对象并添加表单中的值，在重新渲染之前，认为它会起作用。如果您仍然遇到问题，请尝试设置一个布尔值来编辑新行和现有行，或者完全创建两个不同的视图。

我以前做过，但我不太记得是怎么做的。有时当我使用 MVC 模式的典型用法时，它几乎是“自动的”，有时（因为我不得不使用一个古老的古怪数据库）我必须自己编写所有的魔法；有时`.new?`在 ActiveRecord 对象上使用函数（或它被调用的函数），有时我对 ID 使用临时的“魔术值”（通常是字母字符串来表示无效的 id 值。

（如果我犯了一些错误，我深表歉意，我已经有一段时间没有编写 Rails 代码了......）

# visual-studio - Visual Studio 是否有任何附加组件可帮助管理待办事项注释？

> ID：341578
> 
> 赞同：2
> 
> 时间：2008-12-04T18:12:29.737
> 
> 标签：visual-studio, visual-studio-addins

我们的解决方案有很多待办事项注释，但不幸的是，对它们进行排序的唯一方法似乎是通过文件。按项目排序可以让我更好地了解我实际负责的工作。只是想知道是否有任何方法可以做到这一点或任何提供更好功能的加载项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T18:14:45.910

[Resharper 4.0](http://www.jetbrains.com/resharper/index.html)为您完成了这项工作。他们有一个“待办事项浏览器”。使用注释来查找 TODO、Note 和 Bug 注释。

**编辑：** 这是[实际功能](http://www.jetbrains.com/resharper/features/navigation_search.html#To-do_Explorer)的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:04:55.757

我最终只使用了可信任的文件中查找**`todo:`**，可以将其限制为当前项目或用户定义的文件夹集。您的钱包可能会有所不同。

# security - 使用 JBoss 的 Java EE 应用程序的安全性

> ID：341585
> 
> 赞同：0
> 
> 时间：2008-12-04T18:14:31.277
> 
> 标签：security, jboss, jakarta-ee

Java EE Web 应用程序中的基本和明显的安全注意事项和建议是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T20:30:23.187

*   使用 HTTPS
*   使用[Jasypt](http://www.jasypt.org/)来简化一些东西。
*   限制外部访问点。
*   确保没有单点故障。
*   确保通信渠道在需要时得到妥善保护。
*   通过白名单保护对组件的访问（授予访问权限而不是删除访问权限）。
*   确保状态保持在服务器端。
*   测试测试测试测试测试...
*   [随时了解安全漏洞](http://secwatch.org/)。
*   其余的都是关于好的设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T03:31:10.603

不要相信任何不受你控制的东西。这主要的、最重要的方面是：**不要相信您的 POST/GET 处理程序的输入将来自您设计的表单。**

验证所有客户端输入，尤其是在您使用它与 SQL、HQL、其他外部数据源或命令行交互之前。

# database - 当我们可能需要先保存从属数据时该怎么办

> ID：341592
> 
> 赞同：0
> 
> 时间：2008-12-04T18:17:44.033
> 
> 标签：database, database-design

在一对多的关系中，处理数据的最佳方式是什么，因此用户在保存主表数据之前保存从属数据足够灵活。

*   保留主设备的行 ID，以便我可以使用保留的主设备 ID 保存从数据
*   将slave数据保存在临时表中，这样当我们保存主数据时，我们可以“导入”临时表中的数据
*   其他？？

工单/上传多个文件表单中的示例，其中用户可以在发送工单信息之前上传文件：

主桌PK票说明

从表 PK Master_FK 文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T18:35:50.347

你的id是自动生成的吗？

您有多种选择，都可能存在问题。

首先不要定义 FK 关系。现在你如何解释部分状态的记录和那些从未结婚的真实记录？当插入主记录时，您打算如何合并记录？

首先在主表中插入一条记录，其中除了 id 之外所有内容都是空白的。这使得强制所有必填字段默认为用户应用程序，从数据完整性的角度来看，我对此并不感兴趣。

第三个也是最复杂但可能最安全的 - 使用 3 个表。在仅包含主记录 ID 的表中创建主记录，并在打开表单以创建新记录时将其返回给您的应用程序。为原始主表和外键表创建 pk/fk 关系。从原始主表中删除 id 的自动生成，并在插入记录时从新的主表中插入 id。在将记录插入原始 FK 表时也插入新的主表 ID。至少这样，您可以继续在数据库中将所有必填字段标记为必填，但关系是新表和另一个表之间的关系，而不是原始表和另一个表之间的关系。这不会影响查询（只要您有正确的索引），但是如果您删除记录会使事情变得更加复杂，因为如果您不小心，可能会留下一些闲逛。此外，您还必须考虑是否有其他进程（例如从其他来源导入数据）可能会将记录插入到主表中，因为 id 将不再自动生成，因此必须对其进行调整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:33:11.523

In Oracle (maybe others?) you can defer a constraint's validation until COMMIT time.

So you could insert the child rows first. (You'd need the parent key, obviously.)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T18:31:42.787

为什么不能创建主行并将其标记为不完整？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T18:44:44.930

在上传的情况下，您必须为未提交的上传创建临时存储。因此，一旦开始上传，您就可以将所有新文件保存在单独的表中。一旦用户准备好提交票证，您就可以保存票证并从临时表中附加文件。

如果可能的话，您也可以在主表中使用一些固定的 id 创建假记录。然后，您必须确保虚假记录不会出现在其他地方的查询中。

第三，您可以创建存储过程，该过程将为主表生成 id 并增加标识计数器。如果用户中止操作，保留的 id 不会影响任何事情。就像您创建主记录然后删除它一样。您也可以在主表中创建临时记录。

# c++ - 如何在 C++ 中读取系统信息？

> ID：341594
> 
> 赞同：8
> 
> 时间：2008-12-04T18:18:02.097
> 
> 标签：c++, linux, operating-system, system

我正在尝试获取诸如操作系统版本、硬盘空间、可用磁盘空间以及在 C++ 中的 Linux 系统上安装的 RAM 等信息。我知道我可以`system()`用来运行不同的 Linux 命令并捕获它们的输出（这是我目前正在做的），但我想知道是否有更好的方法？我可以使用 C++ 标准库中的某些内容从操作系统获取信息吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T18:26:11.973

如果您通过系统使用 *nix 命令。

然后手动滚动到手册页的底部，它通常会向您显示相关的 C 系统调用。

```
Example:  man uname:
SEE ALSO
       uname(2), getdomainname(2), gethostname(2)

Explanation of numbers:

(1): User UNIX Command
(2): Unix and C system calls
(3): C Library routines
(4): Special file names
(5): File formats
(6): 
(7):
(8): System admin commands 
```

因此，如果您使用的是系统（“uname”）。从手册页中您可以看到还有一个 uname C 系统调用 (uname(2))。因此，您现在可以执行“man 2 uname”来获取有关如何使用 C 系统调用 uname 的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-04T18:24:38.310

C++ 标准库中没有用于这些目的的任何内容。您可以使用的库是`libhal`，它将程序的视图抽象到硬件，从 等中收集各种`/proc`信息`/sys`。[HAL](http://www.freedesktop.org/wiki/Software/hal)，向下滚动，似乎也有一个非官方的 C++ 绑定可用（虽然还没有测试过，而 libhal 也适用于 C++ 程序）。使用该命令`lshal`显示 HAL 可用的所有设备信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T18:52:05.180

如果您不想按照 litb 的建议使用[HAL ，则可以直接从](http://www.freedesktop.org/wiki/Software/hal)[/proc 文件系统](http://www.redhat.com/docs/manuals/linux/RHL-7.2-Manual/ref-guide/ch-proc.html)中读取内容，前提是它在您的系统上。这不是最独立于平台的做事方式，在许多情况下，您需要进行一些解析来分离文件。

我认为 HAL 为您抽象了很多这些细节，但只要知道如果不能使用库，您可以直接从 /proc 读取它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T08:35:41.400

System information is by definition not portable, so there is no standard solution. Your best bet is using a library that does most of the work for you. One such cross platform library (unlike hal, which is currently Linux specific) is [SIGAR API](http://www.hyperic.com/products/sigar.html), which is open source BTW. I've used it in a C++ project without much trouble (the installation is a bit non-standard but can be figured out easily)

# sql-server - 在 Sql Server 2005 中实现最后修改列的最佳方法？

> ID：341602
> 
> 赞同：3
> 
> 时间：2008-12-04T18:21:44.603
> 
> 标签：sql-server

如何在 SQL 中实现最后修改的列？

我知道对于创建日期的列，您只需将默认值设置为`getdate()`. 对于 last-modified 我一直使用触发器，但似乎必须有更好的方法。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T18:26:07.620

触发器是最好的方法，因为这个逻辑与表密切相关，而不是与应用程序相关联。除了更细化的引用完整性之外，这几乎是我能想到的唯一明显正确使用触发器的方法。

但我认为“最后修改”日期无论如何都是一个有缺陷的概念。是什么让“最后更改”的时间戳比之前的时间戳更有价值？您通常需要更完整的审计跟踪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T21:13:37.453

在不使用触发器的情况下执行此操作的唯一其他方法是直接通过权限禁止表上的任何插入/更新/删除，并坚持所有这些操作都是通过负责设置修改日期的存储过程执行的。

管理员可能仍然能够在不使用存储过程的情况下修改数据，但管理员也可以禁用触发器。

如果有很多表需要这种功能，我会更喜欢触发器，因为它可以简化代码。简单、编写良好且索引良好的审计触发器通常不会太邪恶——它们只会在您尝试在触发器中放入太多逻辑时变得糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T18:45:45.007

假设您有一个默认约束，您可以使用关键字 DEFAULT。在插入时，无需指定值，您也可以在此处使用关键字。

无触发器，与“真实”数据在同一写入中完成

```
UPDATE
   table
SET
   blah,
   LastUpdatedDateTime = DEFAULT
WHERE
   foo = bar 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T19:05:01.177

使用触发器来更新最后修改的列是要走的路。几乎工作系统中的每条记录都带有添加和更改时间戳，这对我有很大帮助。将其实现为触发器将让您在有任何更改时标记它，无论它是如何启动的。

触发器的另一个好处是您可以轻松地扩展它以存储审计跟踪，而无需太多麻烦。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T20:00:50.987

只要您这样做，请为 last_updated_by 添加一个字段，并在每次更新记录时更新用户。不如真正的审计表好，但比上次更新的日期好得多。

触发器是您可以用来执行此操作的唯一方法。对于那些说触发器是邪恶的人来说，不，他们不是。到目前为止，它们是维护比简单的默认值或约束更复杂的数据完整性的最佳方式。他们确实需要由真正知道自己在做什么的人编写。但是对于影响数据库设计和完整性的大多数事情都是如此。

# mysql - MySQL 配置文件位置 - redhat linux 服务器

> ID：341608
> 
> 赞同：40
> 
> 时间：2008-12-04T18:23:21.790
> 
> 标签：mysql, linux, redhat

Redhat linux 机器上 MySQL 配置文件的默认位置是什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-12-04T18:28:09.520

刚找到，是/etc/my.cnf

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-04-03T21:26:36.963

The information you want can be found by running

```
mysql --help 
```

or

```
mysqld --help --verbose 
```

I tried this :

```
 mysql --help | grep Default -A 1 
```

And the output:

```
 (Defaults to on; use --skip-auto-rehash to disable.)
  -A, --no-auto-rehash 
--
                      (Defaults to on; use --skip-line-numbers to disable.)
  -L, --skip-line-numbers 
--
                      (Defaults to on; use --skip-column-names to disable.)
  -N, --skip-column-names 
--
                      (Defaults to on; use --skip-reconnect to disable.)
  -s, --silent        Be more silent. Print results with a tab as separator,
--
  --default-auth=name Default authentication client-side plugin to use.
  --binary-mode       By default, ASCII '\0' is disallowed and '\r\n' is
--
Default options are read from the following files in the given order:
/etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-12-26T12:05:43.113

它位于`/etc/mysql/my.cnf`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-10-04T08:56:40.610

他们似乎都是不错的候选人：

```
/etc/my.cnf
/etc/mysql/my.cnf
/var/lib/mysql/my.cnf
... 
```

在许多情况下，您可以简单地使用 ps 检查系统进程列表：

```
server ~ # ps ax | grep '[m]ysqld' 
```

输出

```
10801 ?        Ssl    0:27 /usr/sbin/mysqld --defaults-file=/etc/mysql/my.cnf --basedir=/usr --datadir=/var/lib/mysql --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock 
```

或者

```
which mysqld
/usr/sbin/mysqld 
```

然后

```
/usr/sbin/mysqld --verbose --help | grep -A 1 "Default options"

/etc/mysql/my.cnf ~/.my.cnf /usr/etc/my.cnf 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-16T00:03:20.250

在 RH 系统上，MySQL 配置文件默认位于 /etc/my.cnf 下。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-07-16T13:42:25.517

默认选项按给定顺序从以下文件中读取：

```
/etc/mysql/my.cnf 
/etc/my.cnf 
~/.my.cnf 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-08-26T04:42:51.363

在 docker 容器（基于 centos 的图像）中，它位于

/etc/mysql/my.cnf

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-04-30T15:01:34.707

从'/etc/mysql/my.cnf'的标题：

```
MariaDB programs look for option files in a set of
locations which depend on the deployment platform.
[...] For information about these locations, do:
'my_print_defaults --help' and see what is printed under
"Default options are read from the following files in the given order:"
More information at: http://dev.mysql.com/doc/mysql/en/option-files.html 
```

# actionscript-3 - 在 UML 中实现

> ID：341614
> 
> 赞同：0
> 
> 时间：2008-12-04T18:27:20.673
> 
> 标签：actionscript-3, uml

知道我如何在 UML 中表达“实现”吗？我正在尝试借助这个方便的小模板工具在starUML 中编写一些动作脚本类：http://blog.flashmech.net/2008/09/generate-actionscript-3-with-staruml/ [我](http://blog.flashmech.net/2008/09/generate-actionscript-3-with-staruml/) 想要该工具在类中生成“实现 Iblah”，但不确定要使用什么连接器，聚合？依赖？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T19:54:15.337

继承和实现在 UML 类图中表示为类级别关系。根据关系的类型，您应该在这两者之间进行选择。

我建议你看看这个： [http ://en.wikipedia.org/wiki/Class_diagram#Class_Level_Relationships](http://en.wikipedia.org/wiki/Class_diagram#Class_Level_Relationships)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T18:32:23.363

这是一个应该帮助的starUML教程 -[http://cnx.org/content/m15092/latest/](http://cnx.org/content/m15092/latest/)

# sql-server - T-SQL varchar 比较题

> ID：341619
> 
> 赞同：2
> 
> 时间：2008-12-04T18:30:10.997
> 
> 标签：sql-server, sql-server-2005, tsql

我正在使用 MS Sql 2005。

为什么这会给我正确的结果（返回 169 行）...

```
select
  * 
from 
  [import_Data] 
where 
  [import_Data].name not in 
  (
    select 
      [import_Data].name 
    from 
      [import_Data] 
      inner join [resource] on [import_Data].name = [resource].name
    where 
      [import_Data].ProviderTypeID = 4 
      and [resource].IsDeleted = 0
  )
  and [import_Data].ProviderTypeID = 4 
```

但这不会（返回 0 行）...

```
select 
  * 
from 
  [import_Data] 
where 
  [import_Data].name not in 
  (
    select 
      [resource].name 
    from 
      [resource] 
    where 
      IsDeleted = 0
  ) 
  and [import_Data].ProviderTypeID = 4 
```

`name`列之间的唯一区别是`[resource].name`is`varchar(500)`和`[import_Data].name`is `varchar(300)`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T18:52:58.157

我的猜测是你的资源表中有一个空的 resource.name ，它会抛出所有的比较。为什么空值会导致问题？根据“Guru's Guid to TSQL”，我在解释“ANSI 准则指出，将相等值与 NULL 进行比较的表达式总是返回 NULL。” 因此，列表中的任何 null 都会将整个事情抛诸脑后。

在您的第一个查询中，您的内部联接不包括那些空值。

所以你有三个选择

*   不要使用 NOT IN，使用 NOT EXISTS
*   在 resource.name 上使用 ISNULL 来消除空值
*   通过设置 ANSI_NULLS OFF 来更改空值处理行为。

不存在使用相关子查询的示例（警告空气代码）

```
SELECT *
FROM [import_Data] 
WHERE NOT EXISTS(
        select [resource].name from [resource] where IsDeleted = 0 AND [resource].name = [import_Data].name
    )
  AND [import_Data].ProviderTypeID = 4 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T18:50:38.117

我的猜测是，您面临`IN`运营商和`=`运营商内部工作方式的差异。

这个怎么样：

```
select 
  * 
from 
  [import_Data] 
where 
  not exists 
  (
    select 1 
    from   [resource] 
    where  name = [import_Data].Name and IsDeleted = 0
  ) 
  and [import_Data].ProviderTypeID = 4 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T18:47:57.530

您可能`null`在某处`name`的表格列中有一个。当涉及空值时，和`[resource]`的行为是不同的。`=``not in`

尝试：

```
select * from [resource] where name is null and IsDeleted = 0 
```

缩小范围。

或修复：

```
select * from [import_Data]
where 
  [import_Data].name not in (
    select name from [resource] where IsDeleted = 0 and name is not null
    ) 
  and [import_Data].ProviderTypeID = 4 
```

另请参阅[NOT IN 子句和 NULL 值](https://stackoverflow.com/questions/129077/sql-not-in-constraint-and-null-values)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T18:52:59.827

实际上，问题在于您的 [resource].name 列中似乎有 NULL 值。

当提供的值列表中有 NULL 值时，“NOT IN”t-sql 子句将不起作用。

这是因为您的 where 将解析为：

```
[import_Data].name <> 'Resource1' and [import_Data].name <> 'Resource2' 
and [import_Data].name <> null 
```

当查询引擎解析 [import_Data].name <> null 时，它会返回一个 UNKNOWN 值，并且表达式的计算结果始终为 false。因此，您永远不会得到任何行。

例如，如果您执行，您将始终得到 0 行

```
select * from [import_Data] where [import_Data].name <> null 
```

因此，考虑到这一点，以下查询可能适用于您的情况：

```
select * from [import_Data] 
where [import_Data].name not in (
    select [resource].name from [resource] where IsDeleted = 0 
    and [resource].name is not null
) and [import_Data].ProviderTypeID = 4 
```

# iphone - 使用 iPhone SDK 访问 iPhone 的通话记录

> ID：341622
> 
> 赞同：6
> 
> 时间：2008-12-04T18:31:15.533
> 
> 标签：iphone, cocoa-touch

我正在构建需要来自 iPhone 的通话记录（只读）的一些数据的应用程序。通话记录是一个位于“ */User/Library/CallHistory/call_history.db* ”的sqlite db。我使用越狱设备提取日志。但是，尝试使用*sqlite_open3()*命令打开此位置时出现*SQLITE_ERROR*错误，根据库文档，这意味着“SQL 错误或缺少数据库”。为了调试错误，我使用 NSFileManager 枚举文件夹（'/User/Library/'）。看起来好像它正在返回一组“过滤”的结果，其中排除了“CallHistory”文件夹以及其他几个文件夹。

文件系统使用一系列别名来给人一种传统 OS X 文件结构的错觉，我不知道这些是否对我的结果有影响。

**通话记录仅存在于设备上，而不存在于模拟器**上。我一直无法让它在运行 Fireware 2.1 的第一代 iPhone 上运行。

这是我用来测试输出的一些代码

```
NSDirectoryEnumerator *dirnum = [[NSFileManager defaultManager] enumeratorAtPath: @"/private/var/mobile/Library/"];

while( bar = [dirnum nextObject])
{
    //Uncomment if you don't want to log sub folders
    //[dirnum skipDescendents];

    NSLog(bar);
} 
```

我怀疑 Apple 将阻止访问该目录作为其沙盒策略的一部分，但我现阶段没有证据。但是，我可以毫无问题地访问通讯录，所以我有点困惑。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-04T22:13:44.803

无法从 Cocoa Touch 或其他 iPhone API 访问通话记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T20:58:16.190

请记住，我没有尝试过任何这些。

您的逻辑似乎是，如果您可以访问通讯簿数据库，为什么不能访问通话记录数据库？好吧，通讯簿是通过已发布的 API 公开的——通话记录不是。因此，我认为您也无法访问其 db 文件并不奇怪。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-05T03:57:19.247

您无法使用 SDK 和批准的 API 访问通话记录。这是设计使然。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-12T14:42:18.573

是的，有可能。本教程有效：http: [//iosstuff.wordpress.com/2011/08/19/accessing-iphone-call-history/](http://iosstuff.wordpress.com/2011/08/19/accessing-iphone-call-history/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-05T00:16:26.150

应用程序并不意味着访问其沙箱之外的任何内容。通讯簿数据库是可访问的，因为它是由公共框架访问的。在固件 2.1 之前，应用程序在其沙盒之外确实具有只读访问权限。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-02-18T16:24:03.500

我敢打赌，PhoneView 从 Mac 上的 iphone 备份文件夹中提取数据。sqlite 数据库以可预测的名称存储在那里。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-29T19:46:33.580

使用配置实用程序和 skd，您可以监控何时拨打电话，但看不到谁，我一直试图解决同样的问题，取得了进展，但苹果明确地做到了，所以它的私人信息，至少你打电话给谁，

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-04T18:36:38.673

老实说，你怎么能想象他们会让你访问整个通话记录？一旦你获取它并充分利用这些信息，你如何通过互联网传输它？

# c# - 如何从 HBITMAP 转换为 .NET 的 Bitmap 类？

> ID：341623
> 
> 赞同：1
> 
> 时间：2008-12-04T18:31:17.827
> 
> 标签：c#, c++, pinvoke

我正在使用一些使用该`CreateDIBSection`函数创建位图并返回`HBITMAP`句柄的 C++ 代码。将此信息导入我的 .NET 程序集的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T18:52:41.187

静态方法[Image.FromHbitmap(IntPtr hbitmap)](http://msdn.microsoft.com/en-us/library/k061we7x.aspx)可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T18:47:14.487

您是否尝试过为位图编组字节数组，将其加载到 MemoryStream 中，然后使用该流构造位图类？

# java - 运行 Spring 单元测试的 AOP 问题

> ID：341624
> 
> 赞同：9
> 
> 时间：2008-12-04T18:31:32.647
> 
> 标签：java, spring, transactions, junit, aop

我有一个 Spring Web 应用程序，它被配置为使用 JDK 代理进行 AOP。AOP 注释（例如@Transactional）是在接口上声明的，而不是在实现类上声明的。

应用程序本身运行良好，但是当我运行单元测试时，它似乎试图将 CGLIB 用于 AOP 功能（而不是 JDK 代理）。这会导致测试失败 - 我在下面附加了堆栈跟踪。

我不明白为什么在运行测试时使用 CGLIB，因为 Spring 配置与应用程序运行时的配置基本相同。一个可能显着的区别是测试配置使用[DataSourceTransactionManager](http://static.springframework.org/spring/docs/2.5.0/api/org/springframework/jdbc/datasource/DataSourceTransactionManager.html)而不是 JTA 事务管理器。测试类本身都扩展[AbstractJUnit4SpringContextTests](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/test/context/junit4/AbstractJUnit4SpringContextTests.html)，难道这个类以某种方式硬连线以使用 CGLIB？

```
Caused by: org.springframework.aop.framework.AopConfigException: Could not generate CGLIB subclass of class [class $Proxy25]: Common causes of this problem include using a final class or a non-visible class; nested exception is java.lang.IllegalArgumentException: Cannot subclass final class class $Proxy25
    at org.springframework.aop.framework.Cglib2AopProxy.getProxy(Cglib2AopProxy.java:213)
    at org.springframework.aop.framework.ProxyFactory.getProxy(ProxyFactory.java:110)
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.createProxy(AbstractAutoProxyCreator.java:488)
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.wrapIfNecessary(AbstractAutoProxyCreator.java:363)
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessAfterInitialization(AbstractAutoProxyCreator.java:324)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:361)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1343)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:473)
    ... 79 more
Caused by: java.lang.IllegalArgumentException: Cannot subclass final class class $Proxy25
    at net.sf.cglib.proxy.Enhancer.generateClass(Enhancer.java:446)
    at net.sf.cglib.transform.TransformingClassGenerator.generateClass(TransformingClassGenerator.java:33)
    at net.sf.cglib.core.DefaultGeneratorStrategy.generate(DefaultGeneratorStrategy.java:25)
    at net.sf.cglib.core.AbstractClassGenerator.create(AbstractClassGenerator.java:216)
    at net.sf.cglib.proxy.Enhancer.createHelper(Enhancer.java:377)
    at net.sf.cglib.proxy.Enhancer.create(Enhancer.java:285)
    at org.springframework.aop.framework.Cglib2AopProxy.getProxy(Cglib2AopProxy.java:201)
    ... 86 more 
```

**编辑：其中一位评论员要求我发布 Spring configuration**。我以缩写形式将它包含在下面（即省略了不相关的 bean 和 XML 名称空间）。

**spring-servlet.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans>                 
    <!-- ANNOTATION SUPPORT -->
    <!-- Include basic annotation support -->
    <context:annotation-config/>        

    <!-- CONTROLLERS -->
    <!-- Controllers, force scanning -->
    <context:component-scan base-package="com.onebigplanet.web.controller,com.onebigplanet.web.ws.*"/>  

    <!-- Post-processor for @Aspect annotated beans, which converts them into AOP advice -->
    <bean class="org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator">
        <property name="proxyTargetClass" value="true"/>
    </bean>

    <!-- An @Aspect bean that converts exceptions thrown in POJO service implementation classes to runtime exceptions  -->
    <bean id="permissionAdvisor" class="com.onebigplanet.web.advisor.PermissionAdvisor"/>
    <bean id="businessIntelligenceAdvisor" class="com.onebigplanet.web.advisor.bi.BusinessIntelligenceAdvisor"/>        

    <!-- Finds the controllers and sets an interceptor on each one -->
    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
        <property name="interceptors">
            <list>
                <bean class="com.onebigplanet.web.interceptor.PortalInterceptor"/>              
            </list>
        </property>
    </bean> 

    <!-- METHOD HANDLER ADAPTER --> 
    <!-- Finds mapping of url through annotation on methods of Controller -->
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
        <property name="cacheSeconds" value="0"/>
        <property name="webBindingInitializer">
            <bean class="com.onebigplanet.web.binder.WebBindingInitializer"/>
        </property>
    </bean> 
</beans> 
```

**applicationContext-service.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans> 
    <!-- Declares a bunch of bean post-processors -->
    <context:annotation-config/>

    <context:component-scan base-package="com.onebigplanet.service.impl,com.onebigplanet.dao.impl.mysql" annotation-config="false"/>    

    <!-- Property configurer -->
    <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="/WEB-INF/obp-service.properties" />
    </bean> 

    <!-- Post-processor for @Aspect annotated beans, which converts them into AOP advice -->
    <bean class="org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator"/>

    <!-- An @Aspect bean that converts exceptions thrown in service implementation classes to runtime exceptions  -->
    <bean id="exceptionAdvisor" class="com.onebigplanet.service.advisor.ExceptionAdvisor"/>
    <bean id="cachingAdvisor" class="com.onebigplanet.service.advisor.CacheAdvisor"/>   
    <bean id="businessIntelligenceAffiliateAdvisor" class="com.onebigplanet.service.advisor.BusinessIntelligenceAffiliateAdvisor"/>

    <!-- Writable datasource -->
    <jee:jndi-lookup id="dataSource" jndi-name="java:/ObpDS"/>

    <!-- ReadOnly datasource -->
    <jee:jndi-lookup id="readOnlyDataSource" jndi-name="java:/ObpReadOnlyDS"/>  

    <!-- Map the transaction manager to allow easy lookup of a UserTransaction -->
    <bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager"/>

    <!-- Annotation driven transaction management -->
    <tx:annotation-driven transaction-manager="transactionManager"/>
</beans> 
```

**applicationContext-test.xml**这仅在运行单元测试时包含。它的目的是覆盖在其他配置文件中声明的一些 bean。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans>         
    <!-- Overwrite the property configurer bean such that it reads the test properties file instead -->
    <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="/obp-test.properties"/>
    </bean> 

    <!-- All DAOs should use the test datasource -->
    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="${testDataSource.driverClassName}"/>
        <property name="url" value="${testDataSource.url}"/>
        <property name="username" value="${testDataSource.username}"/>
        <property name="password" value="${testDataSource.password}"/>
    </bean>

    <bean id="readOnlyDataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="${testDataSource.driverClassName}"/>
        <property name="url" value="${testDataSource.url}"/>
        <property name="username" value="${testDataSource.username}"/>
        <property name="password" value="${testDataSource.password}"/>
    </bean>

    <!-- 
        Overwrite the JTA transaction manager bean defined in applicationContent-service.xml with this one because
        the implementation of the former is provided by JBoss
    -->
    <bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource" />
    </bean>
<beans> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-05T21:05:39.043

听起来您引用的是实现类而不是接口。这里有一段更详细的[摘录。](http://books.google.com/books?id=G4jk-NOpF7gC&pg=PA192&lpg=PA192&dq=spring+cglib+jdk+proxy+interface&source=web&ots=PGqNjejNK9&sig=DhXUwccDLSH6AM4mWWb9mnQlfMs&hl=en&sa=X&oi=book_result&resnum=9&ct=result)

Spring 论坛帖子：[“混合 JDK 和 CGLIB 代理”](http://forum.springsource.org/showthread.php?t=62668)

一篇很棒的博文，解释[了 JDK 与 CGLIB 代理的优缺点](http://insufficientinformation.blogspot.com/2007/12/spring-dynamic-proxies-vs-cglib-proxies.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T05:54:27.290

嘿，Jean，CGLib 代理是通过子类化要代理的类来创建的——您正在尝试代理另一个不允许的代理，因为代理本身就是最终类。因此：

`Caused by: java.lang.IllegalArgumentException: Cannot subclass final class class $Proxy25`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-27T01:19:46.510

I don't know if the solution was already shared and I am also sure the original requester must have found a solution, since it is a one year old query. For public interest however let me mention it here. Spring was using CGLIB because of the following declaration.

```
<!-- Post-processor for @Aspect annotated beans, which converts them into AOP advice --> 
<bean class="org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator">
      <property name="proxyTargetClass" value="true"/>
</bean> 
```

The property should be set to false, so that the CGLIB is not triggered instead JDK Dynamic Proxying.

```
<property name="proxyTargetClass" value="false"/> 
```

Hope that helps.

# .net - 如何在运行时在代码中应用动态样式？

> ID：341629
> 
> 赞同：5
> 
> 时间：2008-12-04T18:32:55.173
> 
> 标签：.net, wpf, styling

我需要在代码中应用这样的样式：

```
TextBlock.Style = TryFindResource("MyStyle") as Style; 
```

这将在资源字典更改时动态更新（即在运行时替换皮肤）。换句话说，我需要相当于使用这样的动态资源：

```
<TextBlock Style="{DynamicResource MyStyle}" /> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-04T19:41:19.637

尝试使用[SetResourceReference](http://joshsmithonwpf.wordpress.com/2007/06/29/how-to-set-a-property-to-a-dynamicresource-reference-in-code/)。

```
textBlock.SetResourceReference(TextBlock.StyleProperty, "MyStyle") 
```

# reporting-services - Reporting Services 呈现格式限制

> ID：341633
> 
> 赞同：0
> 
> 时间：2008-12-04T18:34:44.577
> 
> 标签：reporting-services, rendering, format, restriction

有什么方法可以将我在报告管理器中的一份报告的呈现格式限制为 PDF？

谢谢，布里吉特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T19:44:38.133

Wrap the report server call and use [URL access](http://msdn.microsoft.com/en-us/library/ms153586(SQL.90).aspx) (or SOAP etc) to deliver a PDF.

```
http://servername/reportserver?/Sales/YearlySalesSummary&rs:Format=PDF&rs:Command=Render 
```

It's can't be done via Report manager

# sql-server - SQL 报告 - 组内可以有组吗？

> ID：341635
> 
> 赞同：2
> 
> 时间：2008-12-04T18:36:28.800
> 
> 标签：sql-server, reporting-services, reporting

我正在尝试生成一个具有多个分组但不只是将组显示为被分组的单个字段的报告。我认为最好用一个例子来说明：

```
> Date <- Grouped, broken by page   
> Meeting type <- grouped
>       Meeting_Time Meeting_Place Meeting_Title Meeting_Priority
>           Agenda_item_1
>           Agenda_item_2
>           Agenda_item_3
>           Agenda_item_4
>       Meeting_Time Meeting_Place Meeting_Title Meeting_Priority
>           Agenda_item_1
>           Agenda_item_2
>       Meeting_Time Meeting_Place Meeting_Title Meeting_Priority
>           Agenda_item_1
>           Agenda_item_2
>           Agenda_item_3 
```

是否可以这样做，如果可以，报告组件是如何分组的，DataSet 应该是什么样的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T20:02:41.373

我不确定我是否完全跟随你，所以如果我误解了什么，请澄清。

您的数据集分组应该非常灵活。如果您不确定如何处理数据，我建议不要在生成数据集时进行任何分组。

我想您的数据集将具有以下列：

日期、MeetingType、MeetingTime、MeetingPlace、MeetingTitle、MeetingPriority、AgendaItem

为了让它看起来像你有，这是你可以做的：

* * *

1.）向设计器添加一个表格（6 列）
2.）删除页眉和页脚
3.）在日期上添加一个组，在开始时没有页脚和分页符
4.）将日期添加到第一列，合并1-6
5.) 在 MeetingType 上添加一个没有页脚的组
6.) 在第 2 组的第 2 列中添加会议类型并合并 2 - 6
7.) 在没有页脚的会议时间添加一个组（你真的应该有一个 ID
8.) 将 MeetingTime MeetingPlace MeetingTitle MeetingPriority 添加到第 3 组的第 3、4、5、6 列（如果您在此处需要标题，请在上面添加一行，不要使用表标题）
9.) 将 AgendaItem 添加到第 4 列
10.) 合并 4 - 6

* * *

剩下的只是格式化

# grails - Grails 中的 MappedSuperclass 替代方案

> ID：341646
> 
> 赞同：3
> 
> 时间：2008-12-04T18:40:25.750
> 
> 标签：grails, jpa, auditing

在过去的许多项目中，我使用[这种](http://www.nofluffjuststuff.com/blog/scott_leberknight/2008/08/using_a_hibernate_interceptor_to_set_audit_trail_properties.html "使用 Hibernate 拦截器设置审计跟踪属性")JPA / Hibernate 方法向系统添加审计功能。它非常有效且不引人注目。

是否有 Grails @MappedSuperclass 替代方案（在 Java 中编码域模型对象而不是 Groovy）？如何在不为父类创建表的情况下以每个子类的表的方式声明父类？我已经阅读了 GORM 文档（[5.2.3 Inheritance in GORM](https://grails.github.io/grails2-doc/1.2.1/guide/single.html#5.2.3%20Inheritance%20in%20GORM)），但除了每个层次结构表与每个子类表的讨论之外，我没有找到有关如何执行此操作的任何详细信息。

或者，在 Grails 中实现此类审计的推荐方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T21:29:20.150

本质上，它就像声明 as 一样简单`MappedSuperclass`，`abstract`Grails 不会为它创建表。我通过[重新阅读手册](https://grails.github.io/grails2-doc/1.2.1/guide/single.html#5.2.3%20Inheritance%20in%20GORM)意识到：

> GORM 支持从抽象基类和具体的持久 GORM 实体继承。即具体类是持久的，所以抽象类不是。更仔细地阅读是值得的。

例如

```
abstract class Auditable {
    Date dateCreated
    Date lastUpdated
}

class Book extends Auditable {
    String title
    String description
} 
```

只有 book 表将被创建，它会有**`date_created`**和**`last_updated`**列。此外，作为一个额外的好处，`dateCreated`和`lastUpdated`属性由 Grails[自动时间戳。](https://grails.github.io/grails2-doc/1.2.1/guide/single.html#5.5.1%20Events%20and%20Auto%20Timestamping)

# ajax - ASP.NET MVC Ajax.ActionLink 与图像

> ID：341649
> 
> 赞同：73
> 
> 时间：2008-12-04T18:40:43.080
> 
> 标签：ajax, asp.net-mvc, html.actionlink

反正有一个图像作为一个ajax actionlink吗？我只能使用文本让它工作。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-11-01T19:25:35.320

来自 Stephen Walthe，来自他的[联系人管理器项目](http://www.asp.net/mvc/tutorials/older-versions/contact-manager/iteration-1-create-the-application-cs)

```
 public static class ImageActionLinkHelper
{

    public static string ImageActionLink(this AjaxHelper helper, string imageUrl, string altText, string actionName, object routeValues, AjaxOptions ajaxOptions)
    {
        var builder = new TagBuilder("img");
        builder.MergeAttribute("src", imageUrl);
        builder.MergeAttribute("alt", altText);
        var link = helper.ActionLink("[replaceme]", actionName, routeValues, ajaxOptions);
        return link.Replace("[replaceme]", builder.ToString(TagRenderMode.SelfClosing));
    }

} 
```

您现在可以输入您的 aspx 文件：

```
<%= Ajax.ImageActionLink("../../Content/Delete.png", "Delete", "Delete", new { id = item.Id }, new AjaxOptions { Confirm = "Delete contact?", HttpMethod = "Delete", UpdateTargetId = "divContactList" })%> 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-04-23T03:55:41.670

这是我找到的最简单的解决方案：

```
<%= Ajax.ActionLink("[replacethis]", ...).Replace("[replacethis]", "<img src=\"/images/test.gif\" ... />" %> 
```

Replace() 调用用于将*img*标签推送到操作链接中。您只需要使用“[replaceme]”文本（或任何其他安全文本）作为临时占位符来创建链接。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2011-06-01T12:34:40.817

**这是对 Black Horus 答案的 Razor/MVC 3（及更高版本）更新：**

```
using System.Web;
using System.Web.Mvc;
using System.Web.Mvc.Ajax;

public static class ImageActionLinkHelper
{
    public static IHtmlString ImageActionLink(this AjaxHelper helper, string imageUrl, string altText, string actionName, object routeValues, AjaxOptions ajaxOptions, object htmlAttributes = null)
    {
        var builder = new TagBuilder("img");
        builder.MergeAttribute("src", imageUrl);
        builder.MergeAttribute("alt", altText);
        builder.MergeAttributes(new RouteValueDictionary(htmlAttributes));
        var link = helper.ActionLink("[replaceme]", actionName, routeValues, ajaxOptions).ToHtmlString();
        return MvcHtmlString.Create(link.Replace("[replaceme]", builder.ToString(TagRenderMode.SelfClosing)));
    }

} 
```

您现在可以输入您的 .cshtml 文件：

```
@Ajax.ImageActionLink("../../Content/Delete.png", "Delete", "Delete", new { id = item.Id }, new AjaxOptions { Confirm = "Delete contact?", HttpMethod = "Delete", UpdateTargetId = "divContactList" }) 
```

*2013 年 10 月 31 日：更新了一个额外的参数，以允许为图像元素设置额外的 HTML 属性。用法：*

```
@Ajax.ImageActionLink("../../Content/Delete.png", "Delete", "Delete", new { id = item.Id }, new AjaxOptions { Confirm = "Delete contact?", HttpMethod = "Delete", UpdateTargetId = "divContactList" }, new{ style="border: none;" }) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-16T16:50:44.343

另一种解决方案是创建自己的扩展方法：

```
ActionLink<TController>(this HtmlHelper helper, Expression<Action<TController>> action, string linkText, object htmlAttributes, LinkOptions options) 
```

最后一个参数是枚举 LinkOptions

```
[Flags]
public enum LinkOptions
{
    PlainContent = 0,
    EncodeContent = 1,
} 
```

然后您可以按如下方式使用它：

```
Html.ActionLink<Car>(
     c => c.Delete(item.ID), "<span class=\"redC\">X</span>",
     new { Class = "none left" }, 
     LinkOptions.PlainContent) 
```

我将在我的博客上发布此解决方案的完整描述：http: [//fknet.wordpress.com/](http://fknet.wordpress.com/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-29T21:02:24.473

[请参阅http://asp.net/mvc](http://asp.net/mvc)上的第 7 版联系人管理器教程。Stephen Walther 有一个创建图像的 Ajax.ActionLink 的示例。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-04T19:07:12.293

简短的回答是这是不可能的。您的选择是编写自己的扩展方法以获得 ImageActionLink，这并不难。或者给actionLink添加一个属性，用图片标签替换innerhtml。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-07-14T01:58:59.283

**MVC3、Html.ActionImageLink 和 Ajax.ActionImageLink**

感谢您帮助我解决这些问题的所有其他答案。

```
public static MvcHtmlString ActionImageLink(this HtmlHelper helper, string imageUrl, string altText, string actionName, string controller, object routeValues)
{
    var builder = new TagBuilder("img");
    builder.MergeAttribute("src", imageUrl);
    builder.MergeAttribute("alt", altText);
    var link = helper.ActionLink("[replaceme]", actionName, controller, routeValues);
    return new MvcHtmlString(link.ToHtmlString().Replace("[replaceme]", builder.ToString(TagRenderMode.SelfClosing)));
}
public static MvcHtmlString ActionImageLink(this AjaxHelper helper, string imageUrl, string altText, string actionName, string controller, object routeValues, AjaxOptions ajaxOptions)
{
    var builder = new TagBuilder("img");
    builder.MergeAttribute("src", imageUrl);
    builder.MergeAttribute("alt", altText);
    var link = helper.ActionLink("[replaceme]", actionName, controller, routeValues, ajaxOptions);
    return new MvcHtmlString(link.ToHtmlString().Replace("[replaceme]", builder.ToString(TagRenderMode.SelfClosing)));
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-06-17T15:49:15.743

## 一般解决方案：在操作链接中包含您想要的任何 Razor

使用 Razor 模板委托有一个更好的解决方案，它允许以非常自然的方式在操作链接中插入任何 Razor 代码。因此，您可以添加图像或任何其他代码。

这是扩展方法：

```
public static IHtmlString ActionLink<T>(this AjaxHelper ajaxHelper,
    T item, Func<T,HelperResult> template, string action,
    string controller, object routeValues, AjaxOptions options)
{
    string rawContent = template(item).ToHtmlString();
    MvcHtmlString a = ajaxHelper.ActionLink("$$$", action, 
        controller, routeValues, options);
    return MvcHtmlString.Create(a.ToString().Replace("$$$", rawContent));
} 
```

这是如何使用它：

```
@Ajax.ActionLink(car, 
    @<div>
        <h1>@car.Maker</h1>
        <p>@car.Description</p>
        <p>Price: @string.Format("{0:C}",car.Price)</p>
    </div>, ... 
```

这允许使用智能感知编写 Razor，并使用您想要的任何对象作为模板（ViewModel 或任何其他对象，如我示例中的汽车）。您可以使用模板内的任何助手来嵌套图像或您想要的任何元素。

**Resharper 用户注意事项**

如果您在项目中使用 R#，则可以添加[R# 注释](http://www.jetbrains.com/resharper/webhelp/Reference__Code_Annotation_Attributes.html)以改进 Intellisense：

```
public static IHtmlString ActionLink<T>(this AjaxHelper ajaxHelper, T item,
    Func<T, HelperResult> template, 
    [AspMvcAction] string action, [AspMvcController] string controller, 
    object routeValues, AjaxOptions options) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-11T19:08:16.800

每个答案都很好，但我找到了最简单的一个：

```
@Html.ActionLink( " ", "Index", "Countries", null, new
{
        style = "background: url('../../Content/Images/icon.png') no-repeat center right;display:block; height:24px; width:24px;margin-top:-2px;text-decoration:none;"
} ) 
```

请注意，它使用空格 (" ") 作为链接文本。它不适用于空文本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-05T16:14:12.807

> .li_inbox { 背景： url(inbox.png) 无重复；填充左：40px；/*图片背景 40px* / }

* * *

```
<li class="li_inbox" >
          @Ajax.ActionLink("Inbox", "inbox","Home", new {  },
            new AjaxOptions
        {
            UpdateTargetId = "MainContent",
            InsertionMode = InsertionMode.Replace,
            HttpMethod = "GET"
          }) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-16T16:43:43.923

第一个解决方案是使用辅助静态方法**DecodeLinkContent**，如下所示：

```
DecodeLinkContent(Html.ActionLink<Home>(c => c.Delete(item.ID), "<span class=\"redC\">X</span>",new { Class = "none left"})) 
```

DecodeLinkContent 必须找到第一个“>”和最后一个“<”，并且必须用 HttpUtility.Decode(content) 替换内容。

这个解决方案有点小技巧，但我认为这是最简单的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-08T14:44:56.683

使用 Html 数据属性

```
<a data-ajax="true" data-ajax-begin="..." data-ajax-success="..." href="@Url.Action("Delete")">
<i class="halflings-icon remove"></i>
</a> 
```

更换

```
<i class="halflings-icon remove"></i>
```

用自己的形象

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-23T06:33:35.143

尝试这个

```
@Html.Raw(HttpUtility.HtmlDecode(Ajax.ActionLink( "<img src=\"/images/sjt.jpg\" title=\"上一月\" border=\"0\" alt=\"上一月\" />", "CalendarPartial", new { strThisDate = Model.dtCurrentDate.AddMonths(-1).ToString("yyyy-MM-dd") }, new AjaxOptions { @UpdateTargetId = "calendar" }).ToString())) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-12-05T20:21:36.463

[使用Templated Razor Delegates](http://haacked.com/archive/2011/02/27/templated-razor-delegates.aspx)更新 MVC3依赖于[T4Mvc](http://aspnet.codeplex.com/wikipage?title=T4MVC)，但带来了如此多的功能。

*基于此页面上的各种其他答案。*

```
 public static HelperResult WrapInActionLink(this AjaxHelper helper,ActionResult result, Func<object,HelperResult> template,AjaxOptions options)
    {
        var link=helper.ActionLink("[replaceme]",result,options);
        var asString=link.ToString();
        var replaced=asString.Replace("[replaceme]",template(null).ToString());

        return new HelperResult(writer =>
        {
            writer.Write(replaced);
        });
    } 
```

允许：

```
@Ajax.WrapInActionLink(MVC.Deal.Details(deal.ID.Value),@<img alt='Edit deal details' src='@Links.Content.Images.edit_16_gif'/>, new AjaxOptions() { UpdateTargetId="indexDetails" }) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-10-10T17:32:59.870

这里有很好的解决方案，但是如果你想在 actionlink 中拥有更多的图像呢？我就是这样做的：

```
 @using (Ajax.BeginForm("Action", "Controler", ajaxOptions))
     { 
        <button type="submit">
           <img src="image.png" />            
        </button>
     } 
```

缺点是我仍然需要对按钮元素进行一些样式设置，但是您可以将所有想要的 html 放在那里。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-11-09T20:48:47.773

使用此扩展生成带有 glifyphicon 的 ajax 链接：

```
 /// <summary>
    /// Create an Ajax.ActionLink with an associated glyphicon
    /// </summary>
    /// <param name="ajaxHelper"></param>
    /// <param name="linkText"></param>
    /// <param name="actionName"></param>
    /// <param name="controllerName"></param>
    /// <param name="glyphicon"></param>
    /// <param name="ajaxOptions"></param>
    /// <param name="routeValues"></param>
    /// <param name="htmlAttributes"></param>
    /// <returns></returns>
    public static MvcHtmlString ImageActionLink(this AjaxHelper ajaxHelper, string linkText, string actionName, string controllerName, string glyphicon, AjaxOptions ajaxOptions, RouteValueDictionary routeValues = null, object htmlAttributes = null)
    {
        //Example of result:          
        //<a id="btnShow" href="/Customers/ShowArtworks?customerId=1" data-ajax-update="#pnlArtworks" data-ajax-success="jsSuccess"
        //data-ajax-mode="replace" data-ajax-method="POST" data-ajax-failure="jsFailure" data-ajax-confirm="confirm" data-ajax-complete="jsComplete"
        //data-ajax-begin="jsBegin" data-ajax="true">
        //  <i class="glyphicon glyphicon-pencil"></i>
        //  <span>Edit</span>
        //</a>

        var builderI = new TagBuilder("i");
        builderI.MergeAttribute("class", "glyphicon " + glyphicon);
        string iTag = builderI.ToString(TagRenderMode.Normal);

        string spanTag = "";
        if (!string.IsNullOrEmpty(linkText))
        {
            var builderSpan = new TagBuilder("span") { InnerHtml = " " + linkText };
            spanTag = builderSpan.ToString(TagRenderMode.Normal);
        }

        //Create the "a" tag that wraps
        var builderA = new TagBuilder("a");

        var requestContext = HttpContext.Current.Request.RequestContext;
        var uh = new UrlHelper(requestContext);

        builderA.MergeAttribute("href", uh.Action(actionName, controllerName, routeValues));

        builderA.MergeAttributes(HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes));
        builderA.MergeAttributes((ajaxOptions).ToUnobtrusiveHtmlAttributes());

        builderA.InnerHtml = iTag + spanTag;

        return new MvcHtmlString(builderA.ToString(TagRenderMode.Normal));
    } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-05-14T13:36:43.443

我发现最好的解决方案是使用带有 type="image" 的输入标签

```
@using (Ajax.BeginForm( "LoadTest","Home" , new System.Web.Mvc.Ajax.AjaxOptions { UpdateTargetId = "[insert your target tag's id here]" }))
                {
                    <input type="image" class="[css style class here]" src="[insert image link here]">
                } 
```

这很容易而且很快。

我已经将它与干扰 AjaxOptions 的其他控件库结合使用，因此我倾向于输入整个 System.Web.Mvc.Ajax.AjaxOptions 以防万一我最终尝试不同的集合。

**注意：** 我注意到这在 MVC3 中似乎确实存在问题（与 type="image" 有关），但它确实适用于 MVC 4

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-03-16T21:58:19.327

所有都是非常好的解决方案，但如果你不喜欢`replace`在你的解决方案中有一个，你可以试试这个：

```
{
    var url = new UrlHelper(helper.ViewContext.RequestContext);

    // build the <img> tag
    var imgBuilder = new TagBuilder("img");
    imgBuilder.MergeAttribute("src", url.Content(imageUrl));
    imgBuilder.MergeAttribute("alt", altText);
    string imgHtml = imgBuilder.ToString(TagRenderMode.SelfClosing);

    //build the <a> tag
    var anchorBuilder = new TagBuilder("a");
    anchorBuilder.MergeAttribute("href", url.Action(actionName, controller, routeValues));
    anchorBuilder.InnerHtml = imgHtml; // include the <img> tag inside            
    anchorBuilder.MergeAttributes<string, object>(ajaxOptions.ToUnobtrusiveHtmlAttributes());
    string anchorHtml = anchorBuilder.ToString(TagRenderMode.Normal);

    return MvcHtmlString.Create(anchorHtml);
} 
```

此外，就我而言，如果我不使用`url.Content(imageUrl)`，则图像不会显示。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-10-19T08:14:01.253

其他人对我不起作用，因为 .ToHtmlString() 在 MVC 4 中吐出了一个字符串。

下面将一个 id 传递给编辑控件并显示一个编辑图像而不是文本 spag：

```
@MvcHtmlString.Create(Ajax.ActionLink("Spag", "Edit", new { id = item.x0101EmployeeID }, new AjaxOptions() { UpdateTargetId = "selectDiv", InsertionMode = InsertionMode.Replace, HttpMethod = "GET" }).ToHtmlString().Replace("Spag", "<img src=\"" + Url.Content("../../Images/edit.png") + "\" />")) 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2013-03-11T15:15:04.070

```
actionName+"/"+routeValues Proje/ControlName/ActionName/Id

    using System.Web;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;

    namespace MithatCanMvc.AjaxHelpers
{

    public static class ImageActionLinkHelper
    {
        public static IHtmlString ImageActionLink(this AjaxHelper helper, string imageUrl, string altText, string actionName, string routeValues, AjaxOptions ajaxOptions)
        {
            var builder = new TagBuilder("img");
            builder.MergeAttribute("src", imageUrl);
            builder.MergeAttribute("alt", altText);
            var link = helper.ActionLink("[replaceme]", actionName+"/"+routeValues, ajaxOptions).ToHtmlString();
            return MvcHtmlString.Create(link.Replace("[replaceme]", builder.ToString(TagRenderMode.SelfClosing)));

        }

    }

} 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2019-02-26T14:46:47.220

我不知道，这对我来说似乎更容易：

```
 <a href="@Url.Action("index", "home")">
        <img src="~/Images/rocket.png" width="25" height="25" title="Launcher" />
    </a> 
```

# iis - Vista 的 IIS 实例没有 SMTP（解决方案？）

> ID：341651
> 
> 赞同：7
> 
> 时间：2008-12-04T18:42:16.667
> 
> 标签：iis, asp-classic, smtp, windows-vista

目前，我正在开发一个使用经典 ASP 的项目。我的开发机器是 Vista Enterprise。尽管 Vista 确实允许您拥有多个网站（在 XP 中并非没有解决方法），但它已经从 IIS 中删除了 SMTP 服务。

这个问题有标准的解决方法吗？

随着我公司越来越多的 Web 开发人员收到新机器，我担心这个问题会变得更加烦人。（目前我是唯一使用 Vista 的 Web 开发人员）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-11-21T20:55:36.603

我在 serverfault 上找到了更好的建议。 [此线程详细说明](https://serverfault.com/questions/64753/smtp-server-on-windows-7)

[http://smtp4dev.codeplex.com/](http://smtp4dev.codeplex.com/)不错的工具。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T18:54:01.230

您有两种解决方法。您可以将所有邮件定向到您公司的 SMTP 服务器。这通常意味着您的开发机器使用不同的配置（远程 SMTP 与本地），所以我觉得这不太理想。

您还可以在您的开发机器上安装另一个 SMTP 服务器。一种选择是由古老的 Pegasus Mail 制造商提供的免费[Mercury Mail Transport System 。](http://www.pmail.com/overviews/ovw_mercwin.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-15T12:31:20.677

[这与“什么是开发用的好邮件服务器？](https://stackoverflow.com/questions/770098/whats-a-good-mail-server-for-development-use) ”非常相似。

我尝试了 3 件事：

*   使用 SASL (AUTH) 和 OpenSSL (SSL/TLS) 为 Interx/SFU/SUA 构建[的 SUA 社区仓库发送邮件。](http://www.suacommunity.com/warehouse.htm)这很好用，但由于某种原因开始会话很慢。当然，sendmail 的配置尽可能不透明。（UNIX 3.5 的服务和 Unix 应用程序的子系统还附带了一个老式的 sendmail 版本，它没有 AUTH 和 ssl。）
*   [水星邮件服务器](http://www.pmail.com/overviews/ovw_mercury.htm)。设置和管理对我来说感觉迟钝和过时。
*   [邮件服务器](http://hmailserver.com/)。非常光滑。快速设置和直观的配置。我喜欢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-09T18:50:26.573

看看[剪纸](http://papercut.codeplex.com/)。它适用于我在 Windows 7 上的开发环境。

CodePlex 网站上对 Papercut 的描述：

> Papercut 是一个简化的 SMTP 服务器，旨在仅接收消息（而不是发送消息），其顶部有一个 GUI，允许您查看它接收到的消息。它不对地址实施任何限制，它只是接收消息并允许您查看它。它仅在运行时处于活动状态，如果您希望它在后台运行，只需将其最小化到系统托盘即可。当它收到一条新消息时，会出现一个气球消息让您知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-10T21:02:25.517

我使用 SMTP 邮件的内置设置将电子邮件转储到一个目录，如本文所示： [在 Windows 7 上开发时如何使用本地 SMTP 服务器？](https://stackoverflow.com/questions/1120132/how-can-i-use-a-local-smtp-server-when-developing-on-windows-7/2734772#2734772)

# c++ - C++：从“BaseNode*”到“Match*”的无效转换

> ID：341668
> 
> 赞同：2
> 
> 时间：2008-12-04T18:51:07.570
> 
> 标签：c++, inheritance, dynamic-cast

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T18:59:11.717

The problem is that `getParent()` returns a `BaseNode*`, which could be a pointer to any type of `BaseNode` - it might point to an unrelated class that also derives from `BaseNode`. If you're 100% sure that the parent must be of type `Match`, you should cast the parent to a `Match*` first, and then you can call `getPlayer()` on that:

```
Player* Set::getPlayer1() const{
    return dynamic_cast<Match*>(getParent())->getPlayer1();
} 
```

If the parent isn't necessary a `Match`, then `dynamic_cast` might return NULL, so be sure to check for that.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:13:50.863

I think you really need to re-organize your hierarchy and method names... This has nothing to do with your question, but in general it seems hard to fathom why Set inherits from Match. (doesn't a match have sets?)

games are composed of points, sets are composed of games and a match is composed of sets... a point is won by a player.

you should probably structure it more closely to the real world.

just my $.02

EDIT

I'd probably have a Match object that contains a map of sets (map i.e. set one, two three, etc) and the Method Player(int) rather than Player1() and player2(). Also it does not seem necessary to have a method for player in the Set class. A Set would point to a match in which it is being played.

# linux - 通过使用 nice 来减少 CPU 处理时间？

> ID：341682
> 
> 赞同：1
> 
> 时间：2008-12-04T18:56:49.600
> 
> 标签：linux, bash, backup

我的托管服务提供商 (pairNetworks) 对在服务器上运行的脚本有一定的规则。我正在尝试压缩文件以进行备份，并且理想情况下希望使用 bzip2 来利用其令人敬畏的压缩率。但是，当尝试压缩这个 90 MB 的文件时，该过程有时会运行 1.5 分钟以上。资源规则之一是脚本只能执行 30 CPU 秒。

如果我使用 nice 命令来“优化”进程，这是否会破坏总 CPU 处理时间？我可以使用其他命令代替 nice 吗？或者我是否必须使用不需要很长时间的不同压缩实用程序？

谢谢！

* * *

*编辑：这是他们的支持页面所说的：*

*   运行任何需要超过 16MB 内存空间的进程。
*   运行任何需要超过 30 CPU 秒才能完成的程序。

*编辑：我从命令行在 bash 脚本中运行它*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T18:59:54.353

`nice`对您没有帮助 -无论**实际**需要多少秒， **CPU 秒数**仍然相同。

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-04T19:02:08.687

nice 会改变进程的优先级，因此会更快（或更晚）获得它的 CPU 秒数，所以如果规则真的是关于 CPU 秒数的，就像你在问题中所说的那样，nice 根本不会为你服务，它只是在不同的时间被杀。

至于解决方案，您可以尝试将文件分成三个 30 MB 的片段（请参阅 split(1)），您可以在分配的时间内对其进行压缩。然后你解压缩并使用 cat 将各个部分放在一起。根据它是二进制文件还是文本，您可以使用 -l 或 -b 参数进行拆分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T19:06:30.893

您必须找到压缩比和 CPU 消耗之间的折衷方案。bzip2 有 -1 ... -9 选项 - 尝试“调整”它（-1 是最快的）。另一种方法是咨询您的提供商 - 可能会授予您的脚本特殊权限以运行更长时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T19:01:12.650

不，`nice`只会影响您的流程安排方式。简而言之，一个需要 30 CPU 秒的进程总是需要 30 CPU 秒，即使它被抢占了几个小时。

当我用一些繁重的处理加载我机器的所有内核时，我总是会感到兴奋，但它们都很好。我喜欢在网上冲浪时看到 CPU 监视器达到最大值，而没有任何明显的延迟。

# c++ - 您最喜欢 C/C++ 性能分析器/分析器的哪些功能？

> ID：341691
> 
> 赞同：2
> 
> 时间：2008-12-04T19:01:28.017
> 
> 标签：c++, performance, profiler

我正在尝试选择一个性能分析器来使用。我是一名初学者，不知道在性能分析器中寻找什么。最重要的特点是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T19:33:05.067

If you use `valgrind`, I can highly recommend [KCacheGrind](http://kcachegrind.sourceforge.net/html/Home.html) to visualize performance bottlenecks.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T20:25:44.353

我想在探查器中显示以下功能/输出信息。1.) 应该能够显示消耗的总时钟周期以及每个功能。

2.) 如果不是一个，应该说明每个函数所消耗的总时间和花费的时间。

3.）它应该能够告诉一个函数被调用了多少次。

4.) 很高兴知道内存读取、内存写入、缓存未命中、缓存命中。

5.) 每个功能的代码记忆

6.) 使用的数据内存：全局常量、堆栈、堆使用。

=广告

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T19:35:59.973

*   Stability - be able to profile your process for long durations without crashing or running out of memory. its surprising how many commercial profilers fail that.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T19:30:43.793

两个经典答案（假设您在 *nix 世界中）是[valgrind](http://valgrind.org/)和[gprof](http://www.cs.utah.edu/dept/old/texinfo/as/gprof_toc.html)。你想要一些能让你（至少）检查你在每个过程或函数中花费了多少时间的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-01T17:29:40.357

我的偏好是采样分析器而不是检测分析器。探查器应该能够将示例数据映射回源代码，最好是在 GUI 中。我知道的两个最好的例子是：

*   Mac OS X：Shark [developer.apple.com](http://developer.apple.com)
*   Linux：缩放[www.rotateright.com](http://www.rotateright.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T22:02:13.033

Goldenmean 说得对，我要补充一点，行执行计数有时也很方便。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-01T17:18:23.033

您只需要一个带有“暂停”按钮的调试器或 IDE。它不仅是最简单、最便宜的工具，而且根据我的经验，它是最好的。[这是一个完整的解释为什么。注意倒数第二条评论。](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)

编辑，因为我想到了一个更好的答案：

顺便说一句，我在 70 年代学习 AI，一个非常流行的想法是*自动编程*，很多人都试图实现它。（我对它进行了尝试。）这个想法是尝试使具有领域知识结构以及所需功能要求的过程自动化，以生成（和调试）一个可以满足这些要求的程序。这将是关于编程领域的自动推理的一次巡回演出。有一些诱人的演示，但在实际意义上，该领域并没有走得太远。尽管如此，它确实为编程语言贡献了很多想法，比如合约和逻辑验证技术。

为了构建一个理想的分析器，为了优化程序，它会每纳秒获取一个程序状态的样本。无论是在运行中还是稍后（理想，记得吗？）它都会仔细检查每个样本，看看在知道程序执行的原因后，特定纳秒的工作是否实际上是必要的，或者可以以某种方式消除。

这将是数十亿个样本和大量推理，但当然会有大量重复，因为任何浪费成本，比如 10% 的时间，在 10% 的样本上都会很明显。这种浪费可以在不到 10 亿个样本中识别出来。如果事实上，100 个甚至更少的样本可以发现它，只要它们是在时间上随机选择的，或者至少在用户关心的时间间隔内。这是假设目的是找到浪费，以便我们可以摆脱它，而不是非常精确地测量它。

为什么将所有推理能力应用于每个样本会有帮助？好吧，如果程序很小，而且它只是在寻找诸如 O(n^2) 代码之类的东西，那应该不会太难。但是假设程序的状态由一个 20-30 层深的过程堆栈组成，可能不止一次出现一些递归函数调用，可能有一些函数调用外部处理器来执行 IO，可能程序的操作是由表中的一些数据驱动。然后，要确定特定样本是否浪费，需要潜在地检查所有或至少部分状态信息，并使用推理能力来查看它是否真的有必要完成功能要求。

探查器正在寻找的是由于可疑原因而花费的纳秒。要了解它被使用的原因，需要检查堆栈上的每个函数调用站点，以及围绕它的代码，或者至少是其中一些站点。花费纳秒的必要性需要在堆栈上执行的每条语句的必要性的逻辑与。它只需要*一个这样的函数调用站点*对整个样本有一个可疑的理由 有一个可疑的理由。因此，如果整个目的是找出因可疑原因花费的纳秒，那么样本越复杂越好，每个样本的推理能力越强越好。（这就是为什么更大的程序有更多的加速空间——它们有更深的堆栈，因此有更多的调用，因此更有可能出现不合理的调用。）

好吧，那是未来。但是，由于我们不需要大量样本（10 或 20 个非常有用），并且我们已经拥有高度智能的自动编程器（由比萨饼和苏打水驱动），我们现在可以做到这一点。

将其与我们今天称为分析器的工具进行比较。他们中的佼佼者会采集堆栈样本，但他们的输出是什么？测量。“热门路径”。鼠窝图。秀色可餐。从中，即使是人工智能程序员也很容易错过很大的低效率，除了那些输出暴露的那些。 *在你修复了你确实找到的那些之后，你没有找到的那些才是最重要的。*

学习人工智能学到的一件事是，如果人类原则上做不到，不要指望能够对计算机进行编程来做某事。

# bots - 程序化机器人检测

> ID：341695
> 
> 赞同：16
> 
> 时间：2008-12-04T19:03:08.107
> 
> 标签：bots

我需要编写一些代码来分析我们网站上的给定用户是否是机器人。如果是机器人，我们将采取一些具体行动。除了友好的机器人之外，查看用户代理对于任何事情都不会成功，因为您可以在机器人中指定您想要的任何用户代理。我追求不友好机器人的行为。到目前为止，我的各种想法是：

*   如果您没有浏览器 ID
*   如果您没有会话 ID
*   无法写入 cookie

显然，在某些情况下，合法用户看起来像机器人，但这没关系。是否有其他程序化方法来检测机器人，或者检测看起来像机器人的东西？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-04T19:13:53.747

用户代理可以被伪造。验证码已被破解。有效的 cookie 可以通过页面请求发送回您的服务器。Adobe Acrobat Pro 等合法程序可以在一个会话中进入并下载您的网站。用户可以禁用 JavaScript。由于没有“正常”用户行为的标准衡量标准，因此无法将其与机器人区分开来。

换句话说：除非将用户拉入某种形式的交互式聊天并希望他们通过图灵测试，否则无法做到，那么他们也可以成为一个非常好的机器人。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T19:10:08.653

澄清你为什么要排除机器人，以及你对错误分类的容忍度。

也就是说，您是否必须以像对待机器人一样对待真实用户为代价来排除每一个机器人？或者，只要机器人不会对性能产生影响，它们是否可以抓取您的网站？

排除所有机器人的唯一方法是关闭您的网站。恶意用户可以将他们的机器人分发到足够多的机器上，以至于您无法将他们的流量与真实用户区分开来。JavaScript 和 CSS 之类的技巧不会阻止坚定的攻击者。

如果“快乐媒介”令人满意，一个可能有用的技巧是用 CSS 隐藏链接，这样它们在浏览器中对用户不可见，但仍在 HTML 中。遵循这些“毒药”链接之一的任何代理都是机器人。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T19:09:08.423

一个简单的测试是javascript：

```
<script type="text/javascript">
document.write('<img src="/not-a-bot.' + 'php" style="display: none;">');
</script> 
```

not-a-bot.php 可以在会话中添加一些东西来标记用户不是机器人，然后返回一个像素 gif。

URL 被分解以从机器人中伪装它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-05-25T08:51:08.087

这是一个想法：

大多数机器人不下载 css、javascript 和图像。他们只是解析html。

如果您可以在用户会话中跟踪他们是否下载了上述所有内容，例如通过记录尝试的脚本路由所有下载请求，那么您可以快速识别仅下载原始 html 的用户（很少普通用户会这样做）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T19:08:18.597

您说某些用户显示为机器人是可以的，因此，

大多数机器人不运行 javascript。使用 javascript 对将这个 IP 地址标识为 NonBot 的服务器进行类似 Ajax 的调用。将其存储一段时间，以将来自该 IP 的未来连接识别为良好客户端，并防止进一步浪费的 javascript 调用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T20:34:16.800

对于服务器上的每个会话，您可以确定用户是否在任何时候点击或输入速度过快。在给定的重复次数后，将“isRobot”标志设置为 true 并在该会话中节省资源。通常，您不会告诉用户他已被机器人检测到，因为在这种情况下他只会开始一个新会话。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T18:02:31.533

嘿，谢谢大家的回复。我认为一些建议的组合会很好。主要是计算表单填写速度的隐藏表单元素，可能还有“毒链接”的想法。我认为它将涵盖大部分基础。当您谈论机器人时，您不会全部找到它们，因此认为您会......愚蠢的机器人是没有意义的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T19:14:01.017

好吧，这实际上是针对网站的特定页面的。我们不希望机器人提交表单 b/c 它会扰乱跟踪。老实说，友好的机器人、谷歌、雅虎等都不是问题，因为它们通常不会一开始就填写表格。如果我们怀疑某人是机器人，我们可能会向他们展示验证码图像或类似的东西......如果他们通过了，他们就不是机器人并且表单提交......

我听说过诸如将表单放入 Flash 或制作提交 javascript 之类的事情，但我不希望阻止真正的用户使用该网站，直到我怀疑他们是机器人......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-04T19:15:06.147

我认为您检查会话 ID 的想法已经非常有用。

另一个想法：您可以检查是否也下载了嵌入式资源。

不加载图像（例如为了节省时间和带宽）的机器人应该与通常会加载嵌入页面的图像的浏览器区分开来。

然而，这样的检查可能不适合作为实时检查，因为您必须分析某种可能很耗时的服务器日志。

# svn - 向非程序员解释 SVN

> ID：341696
> 
> 赞同：5
> 
> 时间：2008-12-04T19:03:55.080
> 
> 标签：svn, resources, diagram

我与许多新技术支持人员一起工作。有时，他们喜欢修复对我们的开发人员来说可能不是高优先级的小问题。这需要向非程序员教授 SVN 基础知识，我发现这可能会有些棘手。

您发现哪些资源有用？是否有您通常用来教授 SVN 的图表？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T19:58:05.703

当我读到它时，这里有两件事。1 教他们概念，2 教他们如何使用 SVN。

通常保持简单，复杂性会及时处理和使用。

1.  简单地说，SVN 是您正在处理的内容的备份，但巧妙地只保存您所做的更改，而不是您保存到它的每个版本，这样可以保持它很小，并且可以轻松地让您比较随时间变化的变化。

2.  这里无可替代的实践经验，向他们展示如何结帐、更新和签入。我建议您使用 Tortoise SVN，因为学习曲线大大降低。

为了简单起见，我会建立他们自己的分支，他们可以提交，所以他们不需要理解这一点，你只需在后台管理合并。但很快他们就会掌握窍门！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T19:22:44.807

基本上你可以讨论 SVN 可以做什么，它不只是用于代码，而且可以用于一般的任何文档。

不提及代码的示例将很有用：

一位作者写他的书并将其副本放在中心位置。该文档名为 1。当他进行更改时，他将其副本命名为 2。下一个副本将命名为 3，依此类推。只要他可以访问该中心位置，他就可以随时根据需要参考以前的副本。

现在，出版公司为他的书指派了两名校对员。使用 SVN，校对人员能够更正词汇错误并更正它们，并将更正的副本放在中心位置。作者和校对人员也可以获得最新的副本，并且他们可以阅读所做的更改，因为每当放置新副本时，相关人员都可以对已更改的内容发表评论。

如果校对人员发现逻辑和语法错误怎么办？他们不能简单地更改它并将新副本放在中心位置，因为他们不知道作者的意图，这可能是一种独特的写作风格（也就是故意偏离规范的东西）。他们可以使用错误跟踪软件，但这是另一篇文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T19:35:40.257

Showing them the problem version control solves should be the starting point. Either you could make them first do `.bak` files first to see the point.

But if they are sufficiently familiar with **Wikipedia**, it would be definitively better to show them history and how wikipedia protects itself (it would answer some of their curiosity), so that they see it's really usefull in practice. You could install a wiki to make them try.

Only afterwards, put them in from of the 'boring' textual commands of svn...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T21:16:18.773

我最近在将 SVN 介绍给整个 Web 开发团队（包括程序员、界面构建者、图形设计师、内容编辑器、站点管理员和非技术经理）时遇到了这个确切的问题。我四处寻找非技术文档，但最终得到的可用文档很少，所以我决定自己构建。不幸的是，那里的大多数信息都希望用户了解客户端/服务器架构以及“分支”是什么——在我的情况下，我无法假设。您可以在 SlideShare 上查看我的一个迁移前 PowerPoint（“*这东西叫 SVN 是什么？FTW 还是 WTF？* ”）

```
http://www.slideshare.net/secret/wBsLzZb3O7cXCU 
```

真正的关键是要解释 SVN - 其核心 - 实际上只是一种更好的方法来处理复制和粘贴文件。摆脱 default.bak、default2.asp、defaultBackup.asp、defaultMyCopy.asp 等等……是每个人都能理解的。

随着我的用户对源代码控制的概念越来越熟悉，我鼓励人们在我们的内部 WIKI 上提问，以便开发团队（和其他用户）可以帮助他们。

我们还构建了一个自定义 SVN 桌面工具，以一致的方式自动设置他们的本地桌面，以确保公司中的每个人都拥有与其他人相同的设置（c:\projects\projectname），它还更新了他们的本地桌面IIS 安装，让他们可以随时在本地查看网站，而无需手动配置任何东西。

所以 -**提供大量的**帮助-**使用一些幽默**-**让事情变得简单**- 保持标准化 - 提供一种提问的方式 -**提供支持**- 识别您的用户以及他们“继续他们的一天”的需求。如果可能的话，**坐在他们的办公桌前，尽可能多地引导他们完成整个过程，以使每个人都克服障碍**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T19:49:47.310

It can be a good idea to tell them that SVN can be used for other things besides programming. Configuration files, documents, anything basically that you need versioned or even just backed up.

Teach them about the repository, in which all the files and the information about the different versions of the files exist, and about the working copy which are the files that you actually work with.

Start with the simple stuff like checking files out and committing. Committing files is like saying: "I have a new file or a new version of a file". Show them how to keep the files updated with the newest versions.

Maybe then you can start telling them about the trunk, branches and tags, merging and all that jazz. A great resource are the non-programmers who've actually learned something. They can probably use phrases and analogies that are more suitable for other non-programmers.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T19:06:26.073

我只想解释一个场景，即跟踪以前的修订版以及为客户建立一个分支很重要。

那里有更通用的版本控制教程，它们不是特定于 svn 或其他可能有用的。

你不想压倒他们——只要给他们基本的需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T19:07:16.163

我发现 SVN 比 CVS 更容易解释，因为一切似乎都是文件夹（尽管它会使用浅拷贝）。就这样向他们解释。

并且不要详细解释所有内容，而只是在需要知道的基础上告诉他们。如果您开始解释分支和合并，您可能会看到他们的头脑爆炸，或者他们可能会认为只是不值得为进行小改动而付出努力

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T19:09:19.543

以“树干”、“树枝”等命名的*树*比喻怎么样？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-04T19:15:07.410

告诉支持人员 SVN 是源代码服务器，他们所做的更改是客户端更改。他们所做的是更改源代码的客户端副本。它应该发布到 SVN 以存储在那里。与任何其他客户端/服务器应用程序中的方式相同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T22:18:31.957

我发现这篇文章非常适合我们的新开发人员阅读。图表很好，信息也很简单。

[分支与 Subversion 合并](http://www.stevestreeting.com/2008/04/19/branch-merging-with-subversion/)

真正的诀窍是让他们了解分支的重要性，任何人都可以轻松掌握修订控制本身的概念。

# ruby-on-rails - 如何使用 Ruby 处理 UTF-8 电子邮件标头（如主题：）？

> ID：341708
> 
> 赞同：8
> 
> 时间：2008-12-04T19:08:20.403
> 
> 标签：ruby-on-rails, ruby, email, unicode, utf-8

我是一封电子邮件 n00b，但我正在开发一个发送带有 Unicode 字符的 HTML 电子邮件的应用程序（正如我的朋友所说的“享受编码地狱”）。

标`Subject:`头来自用户输入，因此可能包含 Unicode 字符。一些邮件客户端（如 GMail 和 Outlook 2007）对此没有问题，但从我的阅读来看，正确的方法似乎是对标题使用[MIME Encoded-Word 编码](http://en.wikipedia.org/wiki/MIME#Encoded-Word)。

我找不到 Ruby 库来执行此操作。有吗？

此外，是否要添加一个标头，告诉邮件客户端在显示消息时使用 UTF-8？我们正在发送多部分电子邮件，所以我们`Content-Type`是`multipart/mixed`。尤其是 Apple Mail.app 没有使用正确的编码，即使它在各个部分中指定为 UTF-8。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T20:00:49.893

您可以选择使用 Base64 编码执行相同操作：

```
require "base64"

value  = Base64.encode64("Your UTF-8 string")
header = "=?UTF-8?B?" + value + "?=" 
```

请注意标记 Base64 编码有效负载的“B”，而不是标记“Q 编码”有效负载的“Q”。后者可以通过对字符串进行 URL 编码并用“=”替换所有“%”字符来伪造。

通过“伪造”，我的意思是：它会产生一个有效的结果，但可能编码的字符多于必要的字符。该规范允许使用 对每个字符进行编码`"=" + ByteCodeAsHex`，它只会损害原始标题的人类可读性。当没有其他可用的时候， UrlEncode 是`.gsub(/%/, "=")`一个不错的折衷方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-04T20:17:02.777

啊啊！`ActionMailer::Quoting`有`quoted_printable`方法。

所以这就是我所做的：

```
def my_email(foo)
  ...
  @subject = quoted_printable(foo.some_subject_with_accented_chars, 'utf-8')
  ...
end 
```

这样做使 Mail.app 使用 UTF-8 显示电子邮件的其余部分。现在来测试其余的！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-14T13:03:47.933

由于没有一个答案能说明纯 Ruby 的整个消息，所以就在这里。

```
Net::SMTP.start("localhost") do |smtp|
    smtp.open_message_stream opts[:sender_address], opts[:receiver_address] do |f|

        f.puts "Content-type: text/plain; charset=UTF-8"
        f.puts from
        f.puts to
        f.puts subject
        f.puts message
    end
end 
```

在这里，您打开到 localhost 的连接。也可以使用外部 SMTP 服务器，请参阅 net/smtp 的文档。

第一行设置消息中使用的字符集。其余行是单独定义的变量：

from 是形式为 的地址`From: Name here <address@here.fi>`。如果不需要名称，则只能指定地址，例如`From: address@here.fi`.

to 使用相同的语法，但将异常`From:`更改为`To:`.

主题是主题形式：主题在这里。对于 UTF-8，它需要经过 Base64 编码才能正确显示给客户端。

```
subject = "Subject: =?UTF-8?B?" + Base64.strict_encode64(subject) + "?=" 
```

消息是以 UTF-8 编码的纯文本消息，没有任何前缀。net/smtp 将负责形成正确的邮件。

# javascript - Javascript 循环中的事件处理程序 - 需要闭包吗？

> ID：341723
> 
> 赞同：36
> 
> 时间：2008-12-04T19:15:42.340
> 
> 标签：javascript, dom, loops, closures

我正在处理一些我从别人那里接手的 html 和 Javascript 代码。该页面每十秒重新加载一个数据表（通过异步请求），然后使用一些 DOM 代码重新构建该表。有问题的代码如下所示：

```
var blah = xmlres.getElementsByTagName('blah');
for(var i = 0; i < blah.length; i++) {
    var td = document.createElement('td');
    var select = document.createElement('select');
    select.setAttribute("...", "...");
    select.onchange = function() {
        onStatusChanged(select, callid, anotherid);
    };
    td.appendChild(select);
} 
```

然而，当`onchange`为一个元素触发事件`<select>`时，似乎相同的值被传递给表中`onStatusChanged()`每个的方法`<select>`（我已经验证了在循环的每次迭代中，`callid`并被`anotherid`赋予了新的、不同的值）。

我怀疑这是因为我使用`select.onchange = function()`语法设置事件处理程序的性质。如果我理解它是如何正常工作的，那么这个语法将 onchange 事件的闭包设置为一个引用这两个引用的函数，它们最终具有在循环的最后一次迭代中设置的任何值的最终值。`callid`当事件触发时，和引用的`anotherid`值是在最后一次迭代中设置的值，而不是在单个迭代中设置的值。

有没有办法可以复制我传递给的参数的值`onStatusChanged()`？

*我更改了标题以更好地反映问题和接受的答案。*

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-12-04T19:30:47.397

你确实需要在这里实现一个闭包。这*应该*有效（让我知道 - 我没有测试它）

```
var blah = xmlres.getElementsByTagName('blah');
for(var i = 0; i < blah.length; i++) {
    var td = document.createElement('td');
    var select = document.createElement('select');
    select.setAttribute("...", "...");
    select.onchange = function(s,c,a)
    {
        return function()
        {
            onStatusChanged(s,c,a);
        }
    }(select, callid, anotherid);
    td.appendChild(select);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-28T05:50:59.487

只需将 for 循环中的“var”更改为“let”，它就像一个魅力。

参考：[JavaScript For 循环点击事件解决方案#4](https://softauthor.com/javascript-for-loop-click-event-issues-solutions/)

# visual-studio - 使用 NUnit，我需要使用 Visual Studio 中的哪种项目类型来创建我的测试项目？

> ID：341728
> 
> 赞同：16
> 
> 时间：2008-12-04T19:17:56.953
> 
> 标签：visual-studio, nunit

在 Visual Studio 中创建测试项目时，是否只创建 C# 控制台项目类型，然后导入 Nunit？

然后 GUI 会以某种方式连接到这个项目吗？

似乎有大量与 nunit 相关的 .dll，我需要哪些？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-04T19:20:08.837

只需创建一个类库（即 DLL）。您只需要导入 nunit.framework.dll。

是的，nUnit GUI 会加载您的程序集（可以是 DLL 或 .EXE）并找到所有已标记有适当属性的**公共类。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:26:40.663

我建议查看 TestDriven.Net Visual Studio 插件。它允许您直接从 VS 运行测试，因此无需启动 NUnit GUI。

[http://www.testdriven.net/](http://www.testdriven.net/)

# language-agnostic - 建议逻辑以处理基于瓷砖的系统上的自由形式移动

> ID：341734
> 
> 赞同：2
> 
> 时间：2008-12-04T19:20:53.470
> 
> 标签：language-agnostic

我没有这方面的经验，所以我怀疑我的逻辑过于复杂，或者可能不够完整，无法完成我想做的事情。

我有一个基本的基于瓷砖的系统，但想以连续的方式在地形上移动单位。现在，它们正在从一块瓷砖“传送”到另一块瓷砖。

我已经在瓦片系统上设置了很多游戏逻辑，例如寻路、掩体、地形类型等。

我的第一个猜测是它有一个浮点 x/y 偏移从单元的中心和瓷砖的中心，0.0 在中心，1.0 在边缘。这将是一个单元重叠的每个图块。然后我可以通过数学计算出该单元“最多”在哪个图块上，并将该图块用于寻路逻辑。

为了让它变得更好，随着单位的移动，我会让它调整偏移量，以便他逐渐将自己定位在瓷砖线上，而不是进行一堆 90* 转弯来击中路径的瓷砖。然后我可以做一些花哨的东西让他在拐角处优雅地弯曲。

对于诸如武器距离之类的东西，我可以使用 x/y 平铺距离，然后减去 x/y 偏移量以获得简单的路径距离。

将运动与瓷砖分离并仍然能够将单元“链接”到瓷砖的成功方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T20:16:49.720

您的问题并不清楚，但我将使用的方法会有所不同，具体取决于您的游戏是 2D 还是 3D。

对于 2D 游戏，您最好使用像素作为坐标。这样您就可以使用整数来存储它们，从而使事情变得简单明了。您可以通过将其坐标除以图块大小来轻松确定一个单位所在的图块。

对于使用瓷砖的 3D 游戏，只需使用浮点数作为坐标系。如果您是这样考虑武器射程之类的，那么将单位保持在“图块”中可能是最容易的。

无论您使用什么系统，请帮自己一个忙，并将从位置到图块编号的转换放在代码中的**一个**位置。如果你只是因为你当前的瓷砖大小是 100 而到处乱扔 /100 和 *100 ，它最终会回来咬你。仅仅用一个名为 TILE_SIZE 的常量替换“100”可能也不是最好的方法，因为完全有可能在路上的某个地方你会想要为两个坐标系使用不同的原点。

一旦你的单位可以在瓷砖内移动，你的寻路问题就会变得更加复杂。即使您的所有单位大小相同，您也可能需要确保当相邻的瓷砖无法通过时它们不会太靠近边缘。我建议您将所有路径保留在平铺空间中并后处理路径以消除所有不必要的 45 度转弯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:39:20.217

您还可以指定某个整数大小的图块。假设每个图块是 100x100。这样您就可以坚持使用整数而不是浮点数。查找您/玩家所在的图块同样简单，并且仍然基于整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T19:45:26.523

最简单的方法是只使用浮点坐标，然后四舍五入到最接近的整数以获得平方。

```
(3.141592, 2.718282) -> (3, 3) 
```

要获得正方形内的像素位置，只需将坐标的小数部分乘以瓷砖大小，然后四舍五入到最接近的整数：（假设 100x100 瓷砖）

```
(3.141592, 2.718282) -> (0.141592, 0.718282) -> (14, 72) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T19:51:51.457

为什么不让玩家移动到瓷砖上？当他们想从瓷砖 A 移动到瓷砖 B 时，开始向瓷砖的方向移动玩家。当他们在距离图块中心合理的距离内时，就游戏逻辑而言，您可以切换玩家所在的图块。

所以...

玩家开始从图块 A 移动到图块 B。如果对图块 A 造成伤害，大部分（如果不是全部）与图块相关的游戏逻辑（例如效果武器伤害的区域）仍会影响玩家。当玩家到达中间时Tile A 和 Tile B 的中心，将玩家实际的 tile 位置切换到 Tile B。

# mysql - MySQL - 将查询更改为仅在 1 列上不同

> ID：341737
> 
> 赞同：1
> 
> 时间：2008-12-04T19:21:20.440
> 
> 标签：mysql

我有以下查询，除了我希望它表现不同之外。现在它会查找所有重复的行，`url`并按照重复 url 的数量顺序返回。我使用 GROUP_ CONCAT 来分隔所有不同的 screen_name。

但是，可以有多行具有相同的 url 和相同的 screen_name。我如何做到这一点，以便它只检索 screen_name 不同的行。

```
SELECT url, title, GROUP_CONCAT( screen_name ) , COUNT( t_uid )
            FROM `twl_links`
            WHERE twl_uid =3
            AND timestamp >= NOW( ) - INTERVAL 24 HOUR
            GROUP BY (
            url
            )
            ORDER BY COUNT( t_uid ) DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T19:43:08.040

It not clear exactly what you want. Given this data:

```
t_uid    url                    title           screen_name
1        http://google.com/     Google          bob
2        http://google.com/     Google Search   bob
3        http://google.com/     Google          tom 
```

what results are you expecting? If you want:

```
http://www.google.com  '???'  'bob,tom'   2 
```

then you could do a `SELECT DISTINCT` subquery to remove the duplicates (which you'd put in place of `FROM twl_links`).

If you want

```
http://www.google.com  '???'  'bob,tom'   3 
```

then you can do `GROUP_CONCAT(DISTINCT screen_name)` to get that.

Note that in all cases, the title returned is ambiguous (unless there is a N:1 mapping between URL and title; that is unless each URL has only one distinct title)

FYI, it sounds like you have a redundant and hard-to-query data as a result of a lack of normalization.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T20:07:00.817

您可以通过使用这样的子查询来限制它：

```
SELECT t1.url, GROUP_CONCAT( t1.screen_name ) , COUNT( * ) 
FROM (
  SELECT DISTINCT url, screen_name
  FROM mytable
) AS t1
GROUP BY t1.url 
```

它没有给你标题，但由于标题不在 GROUP BY 中，所以我不清楚该字段将返回什么。如果您想要这些 URL 的所有标题，您可以将上述查询与您的表一起加入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T19:27:11.007

您是否尝试过使用 distinct 关键字？

[http://www.tech-recipes.com/rx/1481/ignore-duplicate-entries-in-mysql-select-using-distinct-keyword/](http://www.tech-recipes.com/rx/1481/ignore-duplicate-entries-in-mysql-select-using-distinct-keyword/)

编辑：

这是另一篇文章，展示了可以将 distinct 与 group_concat 一起使用的地方：

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

# c++ - 可以为 NULL 的 C++ 字符串

> ID：341743
> 
> 赞同：7
> 
> 时间：2008-12-04T19:24:07.923
> 
> 标签：c++, string, null

我习惯于在我的 C++ 应用程序中传递这样的字符串：

```
void foo(const std::string& input)
{
  std::cout << input.size() << std::endl;
}

void bar()
{
  foo("stackoverflow");
} 
```

现在我有一个我希望字符串为 NULL 的情况：

```
void baz()
{
  foo("stackoverflow");
  foo(NULL); // very bad with foo implementation above
} 
```

我可以`foo`改为：

```
void foo(const std::string* input)
{
  // TODO: support NULL input
  std::cout << input->size() << std::endl;
} 
```

但是要传递字符串文字或将 a 复制`char*`到该实现，`foo`我需要编写如下内容：

```
void bar()
{
  string input("hi"); // annoying temporary
  foo(&input);
  foo(NULL);  // will work as long as foo handles NULL properly
} 
```

我开始考虑继承`std::string`和添加一个`null`属性，但我不太确定这是一个好主意。也许`const char*`对可以为 NULL 的参数简单地使用字符串会更好，但是如果我想保存字符串（或 NULL）的副本而不必自己管理其内存怎么办？（请参阅[使用 C 样式字符串有哪些缺点？](https://stackoverflow.com/questions/312570/what-are-some-of-the-drawbacks-to-using-c-style-strings)等）

有什么聪明的解决方案吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-04T19:36:14.997

如果您希望类型为空，则将其设为指针。传递字符串指针而不是引用，因为这正是指针可以做的，而引用不能。引用总是指向同一个有效对象。指针可以设置为空，或重新定位以指向另一个对象。因此，如果您需要指针可以做的事情，请使用指针。

或者，使用 boost::optional，它允许以更类型安全的方式指定“此变量可能包含也可能不包含值”。

或者，当然，更改语义，以便您使用空字符串而不是 null，传递一个单独的 bool 参数来指定字符串是否可用，或者重构以便您一开始就不需要它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-04T19:44:15.573

函数重载来救援...

```
void foo( const std::string& input )
{
    std::cout << input << std::endl;

    // do more things ...
}

void foo( const char* input )
{
    if ( input != NULL ) foo( std::string(input) );
} 
```

这将接受 c 样式的 char 数组和 std::strings，如果传入字符串文字或 char 数组，则会在堆栈上产生额外的开销，但允许您将实现保留在一个地方并保持良好的语法.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-04T19:33:00.433

就个人而言，我会更改语义以传递空的 std::strings 而不是 NULL：

```
void foo(const std::string& input)
{
    if (!input.empty())
        std::cout << input.size() << std::endl;
}

void bar()
{
      foo("");
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-04T20:11:18.857

或者，混合前两个答案：

```
void fooImpl( const char* input )
{
    if ( input != NULL )
        std::cout << input << std::endl;
}

void foo( const std::string& input )
{
    fooImpl(input.c_str());    
}

void foo( const char* input )
{
    fooImpl(input);
} 
```

相同的接口，堆栈上没有副本。如果您愿意，您也可以内联 fooImpl。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T19:37:11.487

为什么不重载函数并且不给第二个重载参数呢？然后，两个重载都可以在内部调用一个提供读取逻辑的函数，并且该函数本身会传递一个指向`std::string`.

```
void foo_impl(string const* pstr) { … }

void foo(string const& str) {
    foo_impl(&str);
}

void foo() {
    foo_impl(0);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-05T03:05:32.110

绝对不要继承自`std::string`. 继承是您在 C++ 中可以拥有的最紧密的耦合，并且您只是在寻找可空性，您可以简单地使用`const char*`、 重载或`std::string *`如果您真的想要的话。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T19:28:31.487

如果你只是使用：

```
void foo(const char *xinput)
{
    if (xinput == NULL) {
        // do something exceptional with this
        return;
    }
    std::string input(xinput);
    // remainder of code as usual
} 
```

是的，这确实会导致额外的分配和复制，并且调用该函数有点冗长，因为您需要`.c_str()`在通常情况下使用，但它确实为您提供了您想要的语义。

# javascript - Javascript onchange 在文本区域（Symbian 浏览器）中运行

> ID：341744
> 
> 赞同：0
> 
> 时间：2008-12-04T19:24:17.643
> 
> 标签：javascript, browser, symbian

这可能适用于其他移动操作环境，而不仅仅是 Symbian……但是，问题是当更改文本区域字段时，我想在输入时更新计数。这在大多数浏览器中很容易通过 textarea 标签上的类似内容来实现：

```
onkeyup="document.getElementById('size').innerHTML=this.value.length; 
```

但是，在 Symbian 中，onkeyup 事件似乎不会正常触发（似乎所有输入都被缓冲了）。现在我可以将其替换为：

```
onblur="document.getElementById('size').innerHTML=this.value.length; 
```

...这很好用，但当然只有在失去焦点时才更新 DIV（这总比没有好，但不如在您键入时更新它）。

有没有人专门在 Symbian 上遇到过这样的问题？在任何其他移动浏览器上？有什么想法/解决方案吗？

自从我开始使用 Symbian 以来，我就一直讨厌它——在他们的 API 中有很多这样的怪异之处。我会投票支持任何抱怨 Symbian 的人。;-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T20:09:34.947

在 Symbian 的 WebKit 版本中，键盘事件被彻底搞砸了。处理它们的唯一可靠方法是在文档 [!] 上设置处理程序。现在，我没有在 textarea 有焦点的情况下尝试过，但它肯定适用于更简单的控件。基本上，您使用 onfocus 和 onblur 将特定于控件的事件处理程序与文档关联/解除关联。当然，如果您想以这种方式创建可重用的小部件，那么您将陷入痛苦的海洋:(

OTOH，如果您对 Symbian 的小键盘怪癖感到不满，请查看 Android 迷你 Chrome 中的鼠标事件……这些都在 FUBAR 标题下！

...最大限度...

PS。如果您需要更多帮助：max-at-motovilov-dot-com。您应该可以在 forum.nokia.com 上搜索此问题，但那里的信息并不丰富……这都是反复试验。

# wpf - WindowsFormsHost 控件上的 ContextMenu

> ID：341747
> 
> 赞同：4
> 
> 时间：2008-12-04T19:25:59.700
> 
> 标签：wpf, windowsformshost

因此，我的 WPF 应用程序（托管 Dundas 图表）中有一个 WindowsFormsHost 控件，我想在其上放置一个 ContextMenu。

我可以成功地将 ContextMenu 附加到任何普通的 WPF 控件，但它不适用于 WindowsFormsHost。我怀疑这是因为它在某种程度上是“特殊的”，并且适当的鼠标消息没有到达所需的目的地。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-04T20:15:49.660

回答我自己的问题 - 我通过在我托管的 Windows 控件（Dundas Chart 控件）上捕获 MouseDown 事件然后触发一个新事件来完成这项工作。

新事件的事件处理程序然后执行：

```
graph.ContextMenu.IsOpen = true; 
```

效果很好。

# sql - 带有事务的参数化插入语句引发错误

> ID：341761
> 
> 赞同：1
> 
> 时间：2008-12-04T19:31:10.717
> 
> 标签：sql, asp-classic

我有一个运行良好的参数化插入语句，我需要添加一个选择语句并将其全部包装在事务中，以便获取插入字段之一的数据。我不确定我是否遇到了 ASP/ADO 的限制，或者我是否遇到了语法错误。这是我的代码：

```
set oSQLCommand = Server.CreateObject("ADODB.Command")
with oSQLCommand
   .ActiveConnection = conn
   .CommandType = 1
   .CommandText = "set nocount on " &_
               "begin transaction " &_
                  "declare @docid integer " &_
                  "begin " &_
                     "set @docid = (SELECT MAX(id+1) AS docid FROM draft_main) " &_
                     "INSERT INTO draft_details (id, main_id, blah) " &_
                     "VALUES ( ?, @docid, ?)" &_
                  "end " &_
               "commit"
   .Parameters(0).value = c_id
   .Parameters(1).value = "blah blah"
   .execute
end with
set oSQLCommand = nothing 
```

当我运行该代码时，我收到此错误消息，它在尝试设置 Parameter(0) 的值时触发

```
    适用于 SQL Server 的 Microsoft OLE DB 提供程序 (0x80004005)
    语法错误或访问冲突

```

知道有什么问题吗？

我有丰富的 ASP 和 SQL 经验，但没有存储过程的经验。这段代码是否非常接近存储过程，我应该把它移过来并称之为好？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T19:39:21.030

尝试把 ; 在每个单独的声明之后。例如

```
 .CommandText = "set nocount on; " &_
               "begin transaction; " &_
                  "declare @docid integer; " &_
                  "begin " &_
                     "set @docid = (SELECT MAX(id+1) AS docid FROM draft_main); " &_
                     "INSERT INTO draft_details (id, main_id, blah) " &_
                     "VALUES ( ?, @docid, ?);" &_
                  "end ;" &_
               "commit;" 
```

# dojo - 关闭 Dojo 中的所有模式对话框

> ID：341781
> 
> 赞同：3
> 
> 时间：2008-12-04T19:38:15.930
> 
> 标签：dojo, dialog, modal-dialog

有人知道如何关闭 Dojo 创建的所有模式对话框吗？显然曾经有一个 dojo.popup.closeAll 函数，但是在 Spring JS 附带的最新版本的 Dojo API 中不再可用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T09:47:26.897

没错....该方法不再存在的原因是从 1.0 开始，打开弹出窗口的人负责关闭它。这是我所做的架构更改。

大多数小部件（如菜单）在它们被模糊时进行监控，然后关闭它们的子弹出窗口。因此，您可以通过将焦点切换到文档本身或某个随机节点来获得所需的效果。当然，这是一种解决方法。

账单

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-27T13:17:31.593

这将找到页面中的所有文字对话框并隐藏它们：

```
dijit.registry.filter(function(w){ 
    return w && w.declaredClass == "dijit.Dialog" 
}).forEach(function(w){ 
    w.hide(); 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-05T16:00:53.697

现在看来，唯一有效的方法是跟踪您的对话框并在需要时使用 hide() 将它们全部关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T07:00:55.870

我不知道这是否有用，但我倾向于为每个页面只使用一个对话框（因为它是模态的）。所有对话框的内容都是来自服务器的 xhrGot，我在页面的生命周期内花费了整个 dojo 时间，一次又一次地回收同一个对话框，只是改变了它的属性：它的`href`和它的`title`. 我发现这和有几个对话框一样有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-09T12:55:26.840

道场 >= 1.10：

```
define(['dijit/registry'], ...

registery.toArray().filter(function(w){ 
    return w && w.declaredClass == "dijit.Dialog" 
}).forEach(function(w){ 
    w.hide(); 
}); 
```

# memory - Static memory allocation in Vista results in crash?

> ID：341782
> 
> 赞同：0
> 
> 时间：2008-12-04T19:39:16.147
> 
> 标签：memory, dynamic, windows-vista, static, crash

I'm using Microsoft Visual C++ 2008 Express, and have a pretty annoying problem. It doesn't seem to happen in XP but in Vista I can't find a way around it. Whenever I declare variables non-dynamically, if their combined size exceeds about 30mb, the program will crash immediately at start-up. I know that Vista limits non-Win32 apps to 32mb of memory, but I don't think that's my issue. I'm using the Microsoft compiler, and it happens regardless if it's a win32 console app or a win32 window app. I just declare like...

```
int foo[1000][1000] 
```

...or any combination of variables resulting in a similar size anywhere, and that's good-bye-application. Funny thing is, about 25 % of the times it runs even though this error exists. Am I missing some fundamental programming thingy here? Is static allocation obsolete? Am I going to have to redo the entire application to make use of dynamic allocation?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T20:10:42.243

> 静态分配过时了吗？

你不是在做*静态*分配——你是在做*自动*分配，正如其他人所说，你的堆栈用完了。

在 C++ 中，为数据保留空间的常用方法基本上有以下三种：

1.  在堆栈上 - 这些被称为“自动变量”，它们就是普通的函数局部变量。假设您的“int foo[][]”是 main() 的本地对象，那么这就是它。自动数据受可用堆栈大小的限制，但分配速度*非常快（基本上为零时间）。*

2.  静态 - 这些是函数局部变量或类变量，它们以“静态”一词开头，或者它们是在函数或类范围之外定义的变量。静态数据由编译器保留 没有分配时间开销，但内存是为应用程序的整个运行时保留的。

3.  在堆上 - 这些分配有“new”或“malloc”或某种在内部进行这些调用的机制。分配和释放相比前两个慢，但是你可以有系统给你多少内存，用完可以归还。

这三个有细微的变化 - 例如 alloca 是 1 和 3 的混合体，但这些是基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:44:55.387

There might be a stack size setting you need to set that is defaulting to something small. It has been a long time since I needed to play with those settings.

In the link options most likely

I only have MSDEV 2005 at work, but here is what it says about the stack linker option:

The /STACK option sets the size of the stack in bytes. This option is only for use when building an .exe file.

This option specifies the total stack allocation in virtual memory. The default stack size is 1 MB. The linker rounds up the specified value to the nearest 4 bytes.

EDIT

Unless you are doing your own memory management I can't see why you would allocate this statically. But even in that case I would dynamically allocate memory up front...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T19:46:12.683

The problem is that non-dynamically allocated variables in methods are allocated on the stack, and the maximum stack size is MUCH less than the total available memory. I think it's around 30MB in Windows, yes. What you have done here is, ironically, this very site's namesake. A Stack Overflow.

Edit: According to [http://www.cs.nyu.edu/exact/core/doc/stackOverflow.txt](http://www.cs.nyu.edu/exact/core/doc/stackOverflow.txt) ,Window's maximum stack size is 32MB.

# wpf - 在 MV-VM 中使用 IDataErrorInfo

> ID：341792
> 
> 赞同：12
> 
> 时间：2008-12-04T19:42:16.263
> 
> 标签：wpf, validation, mvvm, idataerrorinfo

如果我的域对象实现了 IDataErrorInfo，并且我正在使用 MV-VM，我如何通过 ViewModel 将错误传播到 View 中？如果我直接绑定到模型，我会在绑定上将“ValidateOnExceptons”和“ValidateOnErrors”属性设置为 true。但是我的 ViewModel 没有实现 IDataErrorInfo。只有我的模型。我该怎么办？

**澄清** 我正在处理在域对象中实现 IDataErrorInfo 的现有代码库。我不能只在我的视图模型中实现 IDataErrorInfo。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-08T15:17:54.640

您可以在 VM 中另外实现 IDataErrorInfo 并将对 VM 的调用路由到相应的域对象。我认为这是不将域对象直接暴露给视图的唯一方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-04T19:55:07.347

如果你使用 MV-VM，ViewModel 应该定义 IDataErrorInfo 接口，而不是模型。

您可以说 IDataErrorInfo 接口仅用于视图，不属于模型，但这是样式问题。

让 ViewModel 实现 IDataErrorInfo 接口并从模型中传播错误将是最简单的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-19T22:07:48.343

关于这个主题有一篇很好的 MSDN 杂志文章，具有模型-视图-视图模型设计模式的 WPF 应用程序：http: [//msdn.microsoft.com/en-us/magazine/dd419663.aspx](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

根据这篇文章，在数据模型和存储库部分 ( [http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090102](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090102) )，您会发现一个简单的实现。Customer 是实体类，ViewModel 从实体获取错误指示符。

您可以使用 ValidationsRule 来检查数据有效性：

```
<TextBox x:Name="title" VerticalAlignment="Top" TextWrapping="Wrap" Grid.Column="1" MinWidth="20">
  <TextBox.Text>
    <Binding Path="Title" UpdateSourceTrigger="LostFocus">
      <Binding.ValidationRules>
        <Validators:StringRangeValidationRule MinimumLength="1" MaximumLength="30" 
                                            ErrorMessage="Address is required and must be less than 30 letters." />
      </Binding.ValidationRules>
    </Binding>
  </TextBox.Text>
</TextBox> 
```

这是验证器样式的示例：

```
<Application.Resources>
  <Style TargetType="{x:Type TextBox}">
  <Setter Property="Validation.ErrorTemplate">
    <Setter.Value>
      <ControlTemplate>
        <DockPanel LastChildFill="True">
          <Image Source="/Images/error.png" Width="25" Height="25" ToolTip="{Binding ElementName=MyAdorner, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}" />
          <TextBlock DockPanel.Dock="Right"
              Foreground="Orange"
              Margin="5" 
              FontSize="12pt"
              Text="{Binding ElementName=MyAdorner, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}">
          </TextBlock>

          <Border BorderBrush="Red" BorderThickness="3">
          <AdornedElementPlaceholder Name="MyAdorner" />
        </Border>
      </DockPanel>
    </ControlTemplate>
  </Setter.Value>
</Setter>
<Style.Triggers>
  <Trigger Property="Validation.HasError" Value="true">
    <Setter Property="ToolTip"
        Value="{Binding RelativeSource={RelativeSource Self}, 
        Path=(Validation.Errors)[0].ErrorContent}"/>
  </Trigger>
</Style.Triggers> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-05T20:18:47.030

**[WPF 应用程序框架 (WAF)](http://waf.codeplex.com)**的**BookLibrary**示例应用程序可能会让您感兴趣。它也在域对象上实现了 IDataErrorInfo 接口，并使用了 MV-VM 模式。

# c# - CheckBoxField in GridView won't bind to a string field in the database

> ID：341807
> 
> 赞同：2
> 
> 时间：2008-12-04T19:47:08.283
> 
> 标签：c#, asp.net, gridview, ado.net

How do I bind a CheckBoxField in my GridView to an underlying db field that is a string. The string is either "1" or "0" but all the same the GridView won't willingly bind to it. What do I do. What is the best way to have a checkbox in the GridView and have it get and set the string in the database (or the underlying datasource).

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T19:51:21.147

This should work:

```
Checked='<%# DataBinder.Eval(Container.DataItem, "MyStringField") = "1" %>' 
```

Normally a checkbox value would be mapped to a bit value in your database so you wouldn't get this issue.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:50:36.873

The CheckBoxField binds to a boolean. You can either convert the string to a boolean in the binding expression, or cast it in the db return.

It would make more sense for the database to store the checkbox state as a bit rather than a string. Then this problem would go away completely.

Of course, if you need to store the third 'grayed' state, that complicates matters slightly, but you could still store the state as an int.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-08T04:30:59.497

我在 VB 工作，我尝试过这样的事情

```
<asp:checkbox runat="server" id="chkCastCool" enabled="false" 
     checked='<%CType(DataBinder.Eval(Container.DataItem,"Cast_Cool").ToString().Replace("Y","True").Replace("N","False"),Boolean)%>'/> 
```

# .net - .NET 2.0 - 标记空格分隔的文本

> ID：341810
> 
> 赞同：1
> 
> 时间：2008-12-04T19:48:59.060
> 
> 标签：.net, .net-2.0, text-parsing

假设你有这样的输出：

```
Word1           Word2   Word3      Word4 
```

单词之间的空格数是任意的。我想把它分解成一个单词数组。

我使用了以下代码：

```
string[] tokens =
         new List<String>(input.Split(' '))
             .FindAll
             (
                 delegate(string token)
                 {
                      return token != String.Empty;
                 }
             ).ToArray(); 
```

效率不高，但做得很好。

你会怎么做？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-04T19:54:14.993

他已经提到了 string.Split()。他缺少的是 StringSplitOptions.RemoveEmptyEntries：

```
string[] tokens = input.Split(new char[] { ' ' },
    StringSplitOptions.RemoveEmptyEntries); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:52:15.793

我将使用正则表达式进行拆分，并使用 "\w+" 作为模式。

# c++ - 是否有适用于 Windows (Visual C) 的 unistd.h 的替代品？

> ID：341817
> 
> 赞同：205
> 
> 时间：2008-12-04T19:51:08.417
> 
> 标签：c++, c, windows, portability, unistd.h

我正在将一个为 Unix 编写的相对简单的控制台程序移植到 Windows 平台（[Visual C++ 8.0](http://en.wikipedia.org/wiki/Visual_C++#32-bit_versions)）。所有源文件都包含“unistd.h”，它不存在。删除它后，我收到有关“srandom”、“random”和“getopt”原型缺失的投诉。我知道我可以替换随机函数，而且我很确定我可以找到/破解一个 getopt 实现。

但我相信其他人也遇到了同样的挑战。我的问题是：Windows 是否有“unistd.h”端口？至少一个包含那些确实具有本机 Windows 实现的功能——我不需要管道或分叉。

**编辑**：

我知道我可以创建自己的“unistd.h”，其中包含我需要的东西的替代品 - 特别是在这种情况下，因为它是一个有限的集合。但由于这似乎是一个常见问题，我想知道是否有人已经为更大的功能子集完成了这项工作。

在工作中无法切换到不同的编译器或环境——我被 Visual Studio 困住了。

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2009-05-05T17:26:50.873

由于我们在互联网上找不到版本，所以让我们从这里开始。
大多数 Windows 端口可能只需要完整 Unix 文件的一个子集。
这是一个起点。请根据需要添加定义。

```
#ifndef _UNISTD_H
#define _UNISTD_H    1

/* This is intended as a drop-in replacement for unistd.h on Windows.
 * Please add functionality as neeeded.
 * https://stackoverflow.com/a/826027/1202830
 */

#include <stdlib.h>
#include <io.h>
#include <getopt.h> /* getopt at: https://gist.github.com/ashelly/7776712 */
#include <process.h> /* for getpid() and the exec..() family */
#include <direct.h> /* for _getcwd() and _chdir() */

#define srandom srand
#define random rand

/* Values for the second argument to access.
   These may be OR'd together.  */
#define R_OK    4       /* Test for read permission.  */
#define W_OK    2       /* Test for write permission.  */
//#define   X_OK    1       /* execute permission - unsupported in windows*/
#define F_OK    0       /* Test for existence.  */

#define access _access
#define dup2 _dup2
#define execve _execve
#define ftruncate _chsize
#define unlink _unlink
#define fileno _fileno
#define getcwd _getcwd
#define chdir _chdir
#define isatty _isatty
#define lseek _lseek
/* read, write, and close are NOT being #defined here, because while there are file handle specific versions for Windows, they probably don't work for sockets. You need to look at your app and consider whether to call e.g. closesocket(). */

#ifdef _WIN64
#define ssize_t __int64
#else
#define ssize_t long
#endif

#define STDIN_FILENO 0
#define STDOUT_FILENO 1
#define STDERR_FILENO 2
/* should be in some equivalent to <sys/types.h> */
typedef __int8            int8_t;
typedef __int16           int16_t; 
typedef __int32           int32_t;
typedef __int64           int64_t;
typedef unsigned __int8   uint8_t;
typedef unsigned __int16  uint16_t;
typedef unsigned __int32  uint32_t;
typedef unsigned __int64  uint64_t;

#endif /* unistd.h  */ 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-11-18T22:56:15.467

尝试包含该`io.h`文件。它似乎是 Visual Studio 的`unistd.h`.

我希望这有帮助。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-12-04T20:29:03.317

我会推荐使用[mingw/msys](https://osdn.net/projects/mingw)作为开发环境。特别是如果您要移植简单的控制台程序。Msys 在 Windows 上实现了一个类 Unix 的 shell，而 mingw 是[GNU 编译器集合 (GCC)](http://gcc.gnu.org/)和其他 GNU 构建工具到 Windows 平台的一个端口。它是一个开源项目，非常适合这项任务。我目前使用它来为 Windows XP 构建实用程序和控制台应用程序，而且它肯定有`unistd.h`您正在寻找的标题。

安装过程可能有点棘手，但我发现最好的起点是*[MSYS](http://www.mingw.org/wiki/msys)*。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-11-23T14:07:40.160

我在尝试为`getpid()`（在 中定义`unistd.h`）寻找 Windows 替代方案时偶然发现了这个线程。事实证明，包含`process.h`可以解决问题。也许这有助于将来找到此线程的人。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-05T00:06:52.113

不，IIRC Windows 上没有[getopt()](http://en.wikipedia.org/wiki/Getopt)。

但是，[Boost具有](http://en.wikipedia.org/wiki/Boost_C++_Libraries)[program_options](http://www.boost.org/doc/libs/1_37_0/doc/html/program_options.html)库...可以正常工作。一开始看起来有点矫枉过正，但它并不可怕，特别是考虑到除了命令行选项之外，它还可以处理在配置文件和环境变量中设置程序选项。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-02-27T18:08:10.173

是的，有：[https ://github.com/robinrowe/libunistd](https://github.com/robinrowe/libunistd)

克隆存储库并添加`path\to\libunistd\unistd`到`INCLUDE`环境变量。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-01-11T09:55:12.883

`unistd.h`在 Windows 上相当于`windows.h`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-09T05:22:01.640

[MinGW 4.x](http://sourceforge.net/projects/mingw/files/)中有 unistd.h `\MinGW\include`，`\MinGW\include\sys`并且 `\MinGW\lib\gcc\mingw32\4.6.2\include\ssp`

这是 Rob Savoye 的 MinGW 版本的代码；由 Earnie Boyd、Danny Smith、Ramiro Polla、Gregory McGarry 和 Keith Marshall 修改：

```
/*
 * unistd.h
 *
 * Standard header file declaring MinGW's POSIX compatibility features.
 *
 * $Id: unistd.h,v c3ebd36f8211 2016/02/16 16:05:39 keithmarshall $
 *
 * Written by Rob Savoye <rob@cygnus.com>
 * Modified by Earnie Boyd <earnie@users.sourceforge.net>
 *   Danny Smith <dannysmith@users.sourceforge.net>
 *   Ramiro Polla <ramiro@lisha.ufsc.br>
 *   Gregory McGarry  <gregorymcgarry@users.sourceforge.net>
 *   Keith Marshall  <keithmarshall@users.sourceforge.net>
 * Copyright (C) 1997, 1999, 2002-2004, 2007-2009, 2014-2016,
 *   MinGW.org Project.
 *
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice, this permission notice, and the following
 * disclaimer shall be included in all copies or substantial portions of
 * the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OF OR OTHER
 * DEALINGS IN THE SOFTWARE.
 *
 */
#ifndef _UNISTD_H
#define _UNISTD_H  1
#pragma GCC system_header

/* All MinGW headers MUST include _mingw.h before anything else,
 * to ensure proper initialization of feature test macros.
 */
#include <_mingw.h>

/* unistd.h maps (roughly) to Microsoft's <io.h>
 * Other headers included by <unistd.h> may be selectively processed;
 * __UNISTD_H_SOURCED__ enables such selective processing.
 */
#define __UNISTD_H_SOURCED__ 1

#include <io.h>
#include <process.h>
#include <getopt.h>

/* These are defined in stdio.h.  POSIX also requires that they
 * are to be consistently defined here; don't guard against prior
 * definitions, as this might conceal inconsistencies.
 */
#define SEEK_SET   0
#define SEEK_CUR   1
#define SEEK_END   2

#if _POSIX_C_SOURCE
/* POSIX process/thread suspension functions; all are supported by a
 * common MinGW API in libmingwex.a, providing for suspension periods
 * ranging from mean values of ~7.5 milliseconds, (see the comments in
 * <time.h>), extending up to a maximum of ~136 years.
 *
 * Note that, whereas POSIX supports early wake-up of any suspended
 * process/thread, in response to a signal, this implementation makes
 * no attempt to emulate this signalling behaviour, (since signals are
 * not well supported by Windows); thus, unless impeded by an invalid
 * argument, this implementation always returns an indication as if
 * the sleeping period ran to completion.
 */
_BEGIN_C_DECLS

__cdecl __MINGW_NOTHROW
int __mingw_sleep( unsigned long, unsigned long );

/* The nanosleep() function provides the most general purpose API for
 * process/thread suspension; it is declared in <time.h>, (where it is
 * accompanied by an in-line implementation), rather than here, and it
 * provides for specification of suspension periods in the range from
 * ~7.5 ms mean, (on WinNT derivatives; ~27.5 ms on Win9x), extending
 * up to ~136 years, (effectively eternity).
 *
 * The usleep() function, and its associated useconds_t type specifier
 * were made obsolete in POSIX.1-2008; declared here, only for backward
 * compatibility, its continued use is not recommended.  (It is limited
 * to specification of suspension periods ranging from ~7.5 ms mean up
 * to a maximum of 999,999 microseconds only).
 */
typedef unsigned long useconds_t __MINGW_ATTRIB_DEPRECATED;
int __cdecl __MINGW_NOTHROW usleep( useconds_t )__MINGW_ATTRIB_DEPRECATED;

#ifndef __NO_INLINE__
__CRT_INLINE __LIBIMPL__(( FUNCTION = usleep ))
int usleep( useconds_t period ){ return __mingw_sleep( 0, 1000 * period ); }
#endif

/* The sleep() function is, perhaps, the most commonly used of all the
 * process/thread suspension APIs; it provides support for specification
 * of suspension periods ranging from 1 second to ~136 years.  (However,
 * POSIX recommends limiting the maximum period to 65535 seconds, to
 * maintain portability to platforms with only 16-bit ints).
 */
unsigned __cdecl __MINGW_NOTHROW sleep( unsigned );

#ifndef __NO_INLINE__
__CRT_INLINE __LIBIMPL__(( FUNCTION = sleep ))
unsigned sleep( unsigned period ){ return __mingw_sleep( period, 0 ); }
#endif

/* POSIX ftruncate() function.
 *
 * Microsoft's _chsize() function is incorrectly described, on MSDN,
 * as a preferred replacement for the POSIX chsize() function.  There
 * never was any such POSIX function; the actual POSIX equivalent is
 * the ftruncate() function.
 */
int __cdecl ftruncate( int, off_t );

#ifndef __NO_INLINE__
__CRT_INLINE __JMPSTUB__(( FUNCTION = ftruncate, REMAPPED = _chsize ))
int ftruncate( int __fd, off_t __length ){ return _chsize( __fd, __length ); }
#endif

_END_C_DECLS

#endif /* _POSIX_C_SOURCE */

#undef __UNISTD_H_SOURCED__
#endif /* ! _UNISTD_H: $RCSfile: unistd.h,v $: end of file */ 
```

该文件需要包含`_mingw.h`，如下：

```
#ifndef __MINGW_H
/*
 * _mingw.h
 *
 * MinGW specific macros included by ALL mingwrt include files; (this file
 * is part of the MinGW32 runtime library package).
 *
 * $Id: _mingw.h.in,v 7daa0459f602 2016/05/03 17:40:54 keithmarshall $
 *
 * Written by Mumit Khan  <khan@xraylith.wisc.edu>
 * Copyright (C) 1999, 2001-2011, 2014-2016, MinGW.org Project
 *
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice (including the next
 * paragraph) shall be included in all copies or substantial portions of the
 * Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 *
 */
#define __MINGW_H

/* In previous versions, __MINGW32_VERSION was expressed as a dotted
 * numeric pair, representing major.minor; unfortunately, this doesn't
 * adapt well to the inclusion of a patch-level component, since the
 * major.minor.patch dotted triplet representation is not valid as a
 * numeric entity.  Thus, for this version, we adopt a representation
 * which encodes the version as a long integer value, expressing:
 *
 *   __MINGW32_VERSION = 1,000,000 * major + 1,000 * minor + patch
 *
 * DO NOT EDIT these package version assignments manually; they are
 * derived from the package version specification within configure.ac,
 * whence they are propagated automatically, at package build time.
 */
#define __MINGW32_VERSION           3022001L
#define __MINGW32_MAJOR_VERSION           3
#define __MINGW32_MINOR_VERSION          22
#define __MINGW32_PATCHLEVEL              1

#if __GNUC__ >= 3 && ! defined __PCC__
#pragma GCC system_header
#endif

#ifndef _MSVCRTVER_H
/* Legacy versions of mingwrt use the macro __MSVCRT_VERSION__ to
 * enable evolving features of different MSVCRT.DLL versions.  This
 * usage is no longer recommended, but the __MSVCRT_VERSION__ macro
 * remains useful when a non-freely distributable MSVCRxx.DLL is to
 * be substituted for MSVCRT.DLL; for such usage, the substitute
 * MSVCRxx.DLL may be identified as specified in...
 */
# include <msvcrtver.h>
#endif

/* A better inference than __MSVCRT_VERSION__, of the capabilities
 * supported by the operating system default MSVCRT.DLL, is provided
 * by the Windows API version identification macros.
 */
#include <w32api.h>

/* The following are defined by the user (or by the compiler), to specify how
 * identifiers are imported from a DLL.  All headers should include this first,
 * and then use __DECLSPEC_SUPPORTED to choose between the old ``__imp__name''
 * style or the __MINGW_IMPORT style for declarations.
 *
 * __DECLSPEC_SUPPORTED            Defined if dllimport attribute is supported.
 * __MINGW_IMPORT                  The attribute definition to specify imported
 *                                 variables/functions.
 * _CRTIMP                         As above.  For MS compatibility.
 *
 * Macros to enable MinGW features which deviate from standard MSVC
 * compatible behaviour; these may be specified directly in user code,
 * activated implicitly, (e.g. by specifying _POSIX_C_SOURCE or such),
 * or by inclusion in __MINGW_FEATURES__:
 *
 * __USE_MINGW_ANSI_STDIO          Select a more ANSI C99 compatible
 *                                 implementation of printf() and friends;
 *                                 (users should not set this directly).
 *
 * Other macros:
 *
 * __int64                         define to be long long.  Using a typedef
 *                                 doesn't work for "unsigned __int64"
 *
 *
 * Manifest definitions for flags to control globbing of the command line
 * during application start up, (before main() is called).  The first pair,
 * when assigned as bit flags within _CRT_glob, select the globbing algorithm
 * to be used; (the MINGW algorithm overrides MSCVRT, if both are specified).
 * Prior to mingwrt-3.21, only the MSVCRT option was supported; this choice
 * may produce different results, depending on which particular version of
 * MSVCRT.DLL is in use; (in recent versions, it seems to have become
 * definitively broken, when globbing within double quotes).
 */
#define __CRT_GLOB_USE_MSVCRT__     0x0001

/* From mingwrt-3.21 onward, this should be the preferred choice; it will
 * produce consistent results, regardless of the MSVCRT.DLL version in use.
 */
#define __CRT_GLOB_USE_MINGW__      0x0002

/* When the __CRT_GLOB_USE_MINGW__ flag is set, within _CRT_glob, the
 * following additional options are also available; they are not enabled
 * by default, but the user may elect to enable any combination of them,
 * by setting _CRT_glob to the boolean sum (i.e. logical OR combination)
 * of __CRT_GLOB_USE_MINGW__ and the desired options.
 *
 *    __CRT_GLOB_USE_SINGLE_QUOTE__ allows use of single (apostrophe)
 *                      quoting characters, analogously to
 *                      POSIX usage, as an alternative to
 *                      double quotes, for collection of
 *                      arguments separated by white space
 *                      into a single logical argument.
 *
 *    __CRT_GLOB_BRACKET_GROUPS__   enable interpretation of bracketed
 *                      character groups as POSIX compatible
 *                      globbing patterns, matching any one
 *                      character which is either included
 *                      in, or excluded from the group.
 *
 *    __CRT_GLOB_CASE_SENSITIVE__   enable case sensitive matching for
 *                      globbing patterns; this is default
 *                      behaviour for POSIX, but because of
 *                      the case insensitive nature of the
 *                      MS-Windows file system, it is more
 *                      appropriate to use case insensitive
 *                      globbing as the MinGW default.
 *
 */
#define __CRT_GLOB_USE_SINGLE_QUOTE__   0x0010
#define __CRT_GLOB_BRACKET_GROUPS__ 0x0020
#define __CRT_GLOB_CASE_SENSITIVE__ 0x0040

/* The MinGW globbing algorithm uses the ASCII DEL control code as a marker
 * for globbing characters which were embedded within quoted arguments; (the
 * quotes are stripped away BEFORE the argument is globbed; the globbing code
 * treats the marked character as immutable, and strips out the DEL markers,
 * before storing the resultant argument).  The DEL code is mapped to this
 * function here; DO NOT change it, without rebuilding the runtime.
 */
#define __CRT_GLOB_ESCAPE_CHAR__    (char)(127)

/* Manifest definitions identifying the flag bits, controlling activation
 * of MinGW features, as specified by the user in __MINGW_FEATURES__.
 */
#define __MINGW_ANSI_STDIO__        0x0000000000000001ULL
/*
 * The following three are not yet formally supported; they are
 * included here, to document anticipated future usage.
 */
#define __MINGW_LC_EXTENSIONS__     0x0000000000000050ULL
#define __MINGW_LC_MESSAGES__       0x0000000000000010ULL
#define __MINGW_LC_ENVVARS__        0x0000000000000040ULL

/* Try to avoid problems with outdated checks for GCC __attribute__ support.
 */
#undef __attribute__

#if defined (__PCC__)
#  undef __DECLSPEC_SUPPORTED
# ifndef __MINGW_IMPORT
#  define __MINGW_IMPORT extern
# endif
# ifndef _CRTIMP
#  define _CRTIMP
# endif
# ifndef __cdecl
#  define __cdecl  _Pragma("cdecl")
# endif
# ifndef __stdcall
#  define __stdcall _Pragma("stdcall")
# endif
# ifndef __int64
#  define __int64 long long
# endif
# ifndef __int32
#  define __int32 long
# endif
# ifndef __int16
#  define __int16 short
# endif
# ifndef __int8
#  define __int8 char
# endif
# ifndef __small
#  define __small char
# endif
# ifndef __hyper
#  define __hyper long long
# endif
# ifndef __volatile__
#  define __volatile__ volatile
# endif
# ifndef __restrict__
#  define __restrict__ restrict
# endif
# define NONAMELESSUNION
#elif defined(__GNUC__)
# ifdef __declspec
#  ifndef __MINGW_IMPORT
   /* Note the extern. This is needed to work around GCC's
      limitations in handling dllimport attribute.  */
#   define __MINGW_IMPORT  extern __attribute__((__dllimport__))
#  endif
#  ifndef _CRTIMP
#   ifdef __USE_CRTIMP
#    define _CRTIMP  __attribute__((dllimport))
#   else
#    define _CRTIMP
#   endif
#  endif
#  define __DECLSPEC_SUPPORTED
# else /* __declspec */
#  undef __DECLSPEC_SUPPORTED
#  undef __MINGW_IMPORT
#  ifndef _CRTIMP
#   define _CRTIMP
#  endif
# endif /* __declspec */
/*
 * The next two defines can cause problems if user code adds the
 * __cdecl attribute like so:
 * void __attribute__ ((__cdecl)) foo(void);
 */
# ifndef __cdecl
#  define __cdecl  __attribute__((__cdecl__))
# endif
# ifndef __stdcall
#  define __stdcall __attribute__((__stdcall__))
# endif
# ifndef __int64
#  define __int64 long long
# endif
# ifndef __int32
#  define __int32 long
# endif
# ifndef __int16
#  define __int16 short
# endif
# ifndef __int8
#  define __int8 char
# endif
# ifndef __small
#  define __small char
# endif
# ifndef __hyper
#  define __hyper long long
# endif
#else /* ! __GNUC__ && ! __PCC__ */
# ifndef __MINGW_IMPORT
#  define __MINGW_IMPORT  __declspec(dllimport)
# endif
# ifndef _CRTIMP
#  define _CRTIMP  __declspec(dllimport)
# endif
# define __DECLSPEC_SUPPORTED
# define __attribute__(x) /* nothing */
#endif

#if defined (__GNUC__) && defined (__GNUC_MINOR__)
#define __MINGW_GNUC_PREREQ(major, minor) \
  (__GNUC__ > (major) \
   || (__GNUC__ == (major) && __GNUC_MINOR__ >= (minor)))
#else
#define __MINGW_GNUC_PREREQ(major, minor)  0
#endif

#ifdef __cplusplus
# define __CRT_INLINE    inline
#else
# if __GNUC_STDC_INLINE__
#  define __CRT_INLINE   extern inline __attribute__((__gnu_inline__))
# else
#  define __CRT_INLINE   extern __inline__
# endif
#endif

# ifdef __GNUC__
  /* A special form of __CRT_INLINE is provided; it will ALWAYS request
   * inlining when possible.  Originally specified as _CRTALIAS, this is
   * now deprecated in favour of __CRT_ALIAS, for syntactic consistency
   * with __CRT_INLINE itself.
   */
#  define  _CRTALIAS   __CRT_INLINE __attribute__((__always_inline__))
#  define __CRT_ALIAS  __CRT_INLINE __attribute__((__always_inline__))
# else
#  define  _CRTALIAS   __CRT_INLINE /* deprecated form */
#  define __CRT_ALIAS  __CRT_INLINE /* preferred form */
# endif
/*
 * Each function which is implemented as a __CRT_ALIAS should also be
 * accompanied by an externally visible interface.  The following pair
 * of macros provide a mechanism for implementing this, either as a stub
 * redirecting to an alternative external function, or by compilation of
 * the normally inlined code into free standing object code; each macro
 * provides a way for us to offer arbitrary hints for use by the build
 * system, while remaining transparent to the compiler.
 */
#define __JMPSTUB__(__BUILD_HINT__)
#define __LIBIMPL__(__BUILD_HINT__)

#ifdef __cplusplus
# define __UNUSED_PARAM(x)
#else
# ifdef __GNUC__
#  define __UNUSED_PARAM(x) x __attribute__((__unused__))
# else
#  define __UNUSED_PARAM(x) x
# endif
#endif

#ifdef __GNUC__
#define __MINGW_ATTRIB_NORETURN __attribute__((__noreturn__))
#define __MINGW_ATTRIB_CONST __attribute__((__const__))
#else
#define __MINGW_ATTRIB_NORETURN
#define __MINGW_ATTRIB_CONST
#endif

#if __MINGW_GNUC_PREREQ (3, 0)
#define __MINGW_ATTRIB_MALLOC __attribute__((__malloc__))
#define __MINGW_ATTRIB_PURE __attribute__((__pure__))
#else
#define __MINGW_ATTRIB_MALLOC
#define __MINGW_ATTRIB_PURE
#endif

/* Attribute `nonnull' was valid as of gcc 3.3\.  We don't use GCC's
   variadiac macro facility, because variadic macros cause syntax
   errors with  --traditional-cpp.  */
#if  __MINGW_GNUC_PREREQ (3, 3)
#define __MINGW_ATTRIB_NONNULL(arg) __attribute__((__nonnull__(arg)))
#else
#define __MINGW_ATTRIB_NONNULL(arg)
#endif /* GNUC >= 3.3 */

#if  __MINGW_GNUC_PREREQ (3, 1)
#define __MINGW_ATTRIB_DEPRECATED __attribute__((__deprecated__))
#else
#define __MINGW_ATTRIB_DEPRECATED
#endif /* GNUC >= 3.1 */

#if  __MINGW_GNUC_PREREQ (3, 3)
#define __MINGW_NOTHROW __attribute__((__nothrow__))
#else
#define __MINGW_NOTHROW
#endif /* GNUC >= 3.3 */

/* TODO: Mark (almost) all CRT functions as __MINGW_NOTHROW.  This will
allow GCC to optimize away some EH unwind code, at least in DW2 case.  */

/* Activation of MinGW specific extended features:
 */
#ifndef __USE_MINGW_ANSI_STDIO
/* Users should not set this directly; rather, define one (or more)
 * of the feature test macros (tabulated below), or specify any of the
 * compiler's command line options, (e.g. -posix, -ansi, or -std=c...),
 * which cause _POSIX_SOURCE, or __STRICT_ANSI__ to be defined.
 *
 * We must check this BEFORE we specifiy any implicit _POSIX_C_SOURCE,
 * otherwise we would always implicitly choose __USE_MINGW_ANSI_STDIO,
 * even if none of these selectors are specified explicitly...
 */
# if   defined __STRICT_ANSI__  ||  defined _ISOC99_SOURCE \
   ||  defined _POSIX_SOURCE    ||  defined _POSIX_C_SOURCE \
   ||  defined _XOPEN_SOURCE    ||  defined _XOPEN_SOURCE_EXTENDED \
   ||  defined _GNU_SOURCE      ||  defined _BSD_SOURCE \
   ||  defined _SVID_SOURCE
   /*
    * but where any of these source code qualifiers are specified,
    * then assume ANSI I/O standards are preferred over Microsoft's...
    */
#  define __USE_MINGW_ANSI_STDIO    1
# else
   /* otherwise use whatever __MINGW_FEATURES__ specifies...
    */
#  define __USE_MINGW_ANSI_STDIO    (__MINGW_FEATURES__ & __MINGW_ANSI_STDIO__)
# endif
#endif

#ifndef _POSIX_C_SOURCE
 /* Users may define this, either directly or indirectly, to explicitly
  * enable a particular level of visibility for the subset of those POSIX
  * features which are supported by MinGW; (notice that this offers no
  * guarantee that any particular POSIX feature will be supported).
  */
# if defined _XOPEN_SOURCE
  /* Specifying this is the preferred method for setting _POSIX_C_SOURCE;
   * (POSIX defines an explicit relationship to _XOPEN_SOURCE).  Note that
   * any such explicit setting will augment the set of features which are
   * available to any compilation unit, even if it seeks to be strictly
   * ANSI-C compliant.
   */
#  if _XOPEN_SOURCE < 500
#   define _POSIX_C_SOURCE  1L      /* POSIX.1-1990 / SUSv1 */

#  elif _XOPEN_SOURCE < 600
#   define _POSIX_C_SOURCE  199506L /* POSIX.1-1996 / SUSv2 */

#  elif _XOPEN_SOURCE < 700
#   define _POSIX_C_SOURCE  200112L /* POSIX.1-2001 / SUSv3 */

#  else
#   define _POSIX_C_SOURCE  200809L /* POSIX.1-2008 / SUSv4 */
#  endif

# elif defined _GNU_SOURCE || defined _BSD_SOURCE || ! defined __STRICT_ANSI__
  /*
   * No explicit level of support has been specified; implicitly grant
   * the most comprehensive level to any compilation unit which requests
   * either GNU or BSD feature support, or does not seek to be strictly
   * ANSI-C compliant.
   */
#  define _POSIX_C_SOURCE  200809L

# elif defined _POSIX_SOURCE
  /* Now formally deprecated by POSIX, some old code may specify this;
   * it will enable a minimal level of POSIX support, in addition to the
   * limited feature set enabled for strict ANSI-C conformity.
   */
#  define _POSIX_C_SOURCE  1L
# endif
#endif

#ifndef _ISOC99_SOURCE
 /* libmingwex.a provides free-standing implementations for many of the
  * functions which were introduced in C99; MinGW headers do not expose
  * prototypes for these, unless this feature test macro is defined, by
  * the user, or implied by other standards...
  */
# if __STDC_VERSION__ >= 199901L || _POSIX_C_SOURCE >= 200112L
#  define _ISOC99_SOURCE  1
# endif
#endif

#if ! defined _MINGW32_SOURCE_EXTENDED && ! defined __STRICT_ANSI__
/*
 * Enable mingw32 extensions by default, except when __STRICT_ANSI__
 * conformity mode has been enabled.
 */
# define _MINGW32_SOURCE_EXTENDED  1
#endif

#endif /* __MINGW_H: $RCSfile: _mingw.h.in,v $: end of file */ 
```

其余的包含应该是您的环境的标准。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-08-06T18:33:00.900

在 c/cpp 文件中键入 stdout 宏并尝试查找 stdout 的定义。然后您将在***corecrt_wstdio.h***中看到stdout 等的实际宏定义

> `#define stdin (__acrt_iob_func(0))` `#define stdout (__acrt_iob_func(1))` `#define stderr (__acrt_iob_func(2))`

那么我认为它应该是相当于windows的POSIX。

rand,srand 分别相当于在 stdlib.h 中声明的 random, srandom

* * *

## 回答 #10

> 赞同：-7
> 
> 时间：2008-12-04T20:40:41.950

创建您自己的 unistd.h 头文件并包含函数原型所需的头文件。

# queue - MS CRM 4 - Get queue that a case assigned to

> ID：341822
> 
> 赞同：0
> 
> 时间：2008-12-04T19:51:56.697
> 
> 标签：queue, dynamics-crm, crm, dynamics-crm-4

I am looking for a solution to my problem. Is there a way to grab the value of the queue that a user assigns a case to on the case form. I would like to add the queue name to a custom attribute for further use during the save. I am using CRM 4 enterprise

Thanks J

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T15:45:44.110

创建一个 ASP.NET 页面，它的 URL 采用票证 ID 和：

1.  显示您想要显示的内容。使用 IFRAME 嵌入
2.  返回 XML。然后，您可以在 Form Onload 事件中使用 JavaScript 解析它并将其分配给一个字段。查看重复检测示例以获取此示例。

ASP.NET 页面是如何得到它的？您需要调用 Web 服务并在队列项目实体中查询具有与您的票证匹配的项目 ID 的队列项目。然后检查队列 id 属性以获取队列。

# html - 用于将 HTML 转换为图像的简单 HTML 布局引擎

> ID：341831
> 
> 赞同：19
> 
> 时间：2008-12-04T19:54:57.753
> 
> 标签：html, image, layout, image-processing, rendering

我需要一个工具来自动将简单的 HTML 转换为图像。我将控制 HTML 输入，它由简单的文本格式标记和可能的图像链接组成——我不需要能够呈现任意 HTML。有没有一种简单的方法可以做到这一点？

我看过 Gecko 和 Webkit 之类的 HTML 布局引擎，但坦率地说，我对它们拥有的选项数量感到不知所措——我不需要完整的 Web 浏览器！是否可以以这种方式使用这些引擎？有人可以引导我朝着正确的方向前进吗？

其他可能性，如 browsershots，依赖于真实浏览器的屏幕截图，但我将在一个可能有很多用户的 Web 服务器上运行这个应用程序，所以性能很重要，我担心这种解决方案无法扩展。

想法？

编辑：抱歉忘记提及我的服务器正在运行 Linux，因此 Windows 解决方案无济于事。:)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-09T18:51:08.640

回答，我自己的问题，我发现了这个有用的工具，它使用 WebKit 来呈现页面，然后将输出捕获为图像甚至 PDF 格式！

[http://cutycapt.sourceforge.net/](http://cutycapt.sourceforge.net/)

这个想法类似于 Jay 提到的 khtml2png，但我更喜欢这个实现。此外，为了将来参考，通过 Xvfb 运行 X 虚拟帧缓冲区并不像我担心的那样占用大量内存。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-03T09:53:24.420

在它有点笨拙和臃肿之前，我已经使用过 CutyCapt - 需要 Qt。

IMO，PhantomJs（一个无头 webkit）是迄今为止最好的解决方案，快速、简单和干净。你可以用它做很多事情。

见[http://phantomjs.org](http://phantomjs.org)

或者看到[这个](http://joekuan.wordpress.com/2012/10/03/phantomjs-the-best-way-to-save-rendered-html-page-into-an-image-file/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-04T20:03:29.060

如果您在 Linux 上运行并且有可用的 KDE 库，您可能会发现这很有用：[**khtml2png**](http://khtml2png.sourceforge.net/)

*khtml2png 是一个用于创建网页截图的命令行程序。它使用 libkhtml（在 KDE 网络浏览器 Konqueror 中使用的库）。在 khtml2png 2.0.5 到 2.5.0 中，ImageMagick 图形转换工具包中的“转换”用于创建各种图像文件格式的输出文件。2.6.0及以后的开发将使用Qt库的内置转换。*

此外，为了跟进 Vilx 的建议，您可以使用**html2ps**将 HTML 转换为 ps 文件，然后使用**gs** (Ghostscript) 将 ps 文件转换为 png 或 jpg。有关一种方法，请参见[http://www.karakas-online.de/myLinuxTips/ps2png.html](http://www.karakas-online.de/myLinuxTips/ps2png.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T20:03:15.707

视窗？如果是，那么 HTMLayout 可能会有所帮助——它是一个免费的渲染引擎，并且它有一个简单的 API——从 C/C++ 中使用它是轻而易举的——将 HTML 转换为 BMP 并不难。

[http://www.terrainformatica.com/htmlayout/](http://www.terrainformatica.com/htmlayout/)

它也是免费的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-28T04:10:36.077

我一直很幸运地使用了多年来在 Ubuntu 中本地可用的`wkhtmltoimage`命令（并且，对于打印输出， ），并且如果我记得的话，它也总是正确且相当快地呈现。`wkhtmltopdf`

[http://wkhtmltopdf.org/](http://wkhtmltopdf.org/)

有几个选项可用，但基本调用如下所示：

```
wkhtmltoimage tmp.html tmp.png 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T19:58:06.653

也许您可以将 HTML 转换为更容易转换为图像的另一种格式？在谷歌中，我发现了一些叫做 html2ps 和 html2pdf 的东西。从 PS 到 EPS 仅一步之遥，并且已经可以渲染为图像。或类似的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T20:05:41.473

您可以使用[PDFCreator](http://sourceforge.net/projects/pdfcreator/)应用程序。此应用程序允许打印多种格式，包括各种图像。它包括一个 ActiveX / com 服务器，可让您相当轻松地自动化该过程。您几乎可以转换任何可以打印的东西。这种方法的一个缺点是，由于它使用打印框架进行转换，您一次只能转换一个文档，所以我不知道它是否适合网站。

# .net - .NET2.0 Remoting - Why Is Registering A ClientChannel Necessary?

> ID：341837
> 
> 赞同：0
> 
> 时间：2008-12-04T19:56:19.043
> 
> 标签：.net, remoting, ipc

I have a client/server application that must use .NET Remoting (not WCF because the project is using Framework 2).

The following code (copied heavily from MSDN) works:

```
 _clientChannel = new IpcClientChannel();

                ChannelServices.RegisterChannel(_clientChannel, false);

                IMyObject myObject= (IMyObject)
                        Activator.GetObject(typeof(IMyObject),
                        "ipc://MyServer/Address");

                if ( myObject.Equals(null) )
                    Console.WriteLine("Error: unable to locate server.");
                else
                    returnString = myObject.SomeMethod();

                ChannelServices.UnregisterChannel(_clientChannel); 
```

But what do these three lines do?

```
 _clientChannel = new IpcClientChannel();

                    ChannelServices.RegisterChannel(_clientChannel, false);

                    ...

                    ChannelServices.UnregisterChannel(_clientChannel); 
```

_clientChannel doesn't get used anywhere afterwards in the working code. The working code also seems to work without those three lines. Can I get rid of them without losing functionality?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T19:55:20.140

该通道用于通信。你通过 Activator 得到的 Object 只是一个代理对象，它隐藏了真正的实现，使用通道进行通信。

有关远程处理的更多信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms973909.aspx)

# iis - 重定向具有相同 IP 地址的多个域

> ID：341844
> 
> 赞同：2
> 
> 时间：2008-12-04T19:58:39.353
> 
> 标签：iis, multiple-domains

我们公司多年来拥有多个域名来保护我们的产品名称。当我们的网站首次设置时，我们将所有这些域名解析到 IP 地址上，直到现在都运行良好。我们用 ASP.NET MVC 重写了网站，现在使用 Recaptcha。Recaptcha 密钥已注册到我们的主域“www.example.com”。我们还有指向相同 IP 地址的其他域，例如“www.examples.com”和“www.ex-ample.com”。当有人从备用域访问我们的站点时，Recaptcha 不起作用，因为密钥没有为该备用域注册。我们希望将来自“www.examples.com”的所有内容重定向到“www.example.com”。

我已经读到您可以在 IIS 中设置站点并使用永久重定向，但是如果域都指向相同的 IP 地址，这会起作用吗？

我们还为 IIS 7 安装了重写模块，因为当我们切换到 MVC 时，我们的很多页面都移动了。是否可以编写规则，如果可以，如何编写？

我们应该使用更好的替代方案吗？

非常感谢任何有助于阐明这一点的帮助。

* * *

我在 IIS 中设置域没有问题，如果域都指向同一个 IP 地址，这会起作用吗？如果我去 www.example.com (192.168.1.1) 会不会最终在 www.examples.com (192.168.1.1) 重定向到 www.example.com 并导致无限循环，因为它们在同一个 IP地址？

* * *

如何在 Windows 2003 DNS 服务器中完成 CNAME？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T20:16:55.133

对于 CNAME 方法，您需要选择一个域名并将其作为主要域名。因此，让 www.example.com 成为首选，并且每个 OTHER 域名都会重定向到这个。然后你可以避免无限循环。

还有一种方法可以在服务器上设置配置，以便浏览器允许多个域查看单个 cookie，在本例中是 www.example.com，然后是 www.examples.com 和 www.ex-ample。 com 尝试阅读 www.example.com 的 recaptha 会话信息，它会起作用。这将允许您在浏览器中仍然有多个 url，并支持共享会话。

就我个人而言，我只是将它们全部重定向到一个域，更容易实现。

这样做：

```
127.0.0.1        A       example.com
www.exmaple.com  CNAME   example.com
examples.com     CNAME   example.com
www.examples.com CNAME   example.com 
```

等等

编辑：是的，我在写这篇文章的时候睡着了。这只是解决方案的一部分，我在下面发布了其余部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T18:20:49.250

好的，在我的 CNAME 解决方案之上，您必须执行以下操作：

IIS 解决方案是在 IIS 管理器中设置 2 个站点：

1.  example.com（在主机头中设置）这是指向正确主目录的实际站点。
2.  所有其他域都将设置在一个“网站”下，并在属性->网站->高级中添加它们的主机头。对于主目录，使其成为 example.com 的重定向 URL。

这种方法的问题是我相信去 www.examples.com/somepage.htm 的请求将被转发到 example.com/。（不会指向 example.com/somepage.htm）

现在您可以在 IIS7（或带有 Isapi_Rewrite 插件的 IIS6）中执行的操作是在重定向网站上设置一个 .htaccess 条目，以将所有流量发送到 example.com 并附加路径和查询字符串信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T18:52:00.793

是的，您可以通过`IIS URL Rewrite`模块完成此操作。

这是一个例子：

```
 <rule name="WWW Redirect" stopProcessing="true">
     <match url=".*" />
     <conditions>
      <add input="{HTTP_HOST}" pattern="^examples.com$" />
     </conditions>
     <action type="Redirect" url="http://www.example.com/{R:0}" redirectType="Permanent" />
    </rule> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-04T20:05:41.803

就在我的脑海中，您可能想在这里查看 DNS CNAME。

另一种可能的解决方案是在 IIS 中设置一个网站，其中包含所有其他域的域别名，并让该网站将用户重定向到您的主域/站点。

# asp.net - 谷歌（搜索引擎）对 asp.net 页面的索引建议

> ID：341847
> 
> 赞同：4
> 
> 时间：2008-12-04T20:00:21.937
> 
> 标签：asp.net, search-engine

我正在为我工​​作的大学开发课程传单系统，传单存储在带有主键 course_code 的数据库中。我希望传单理想地被谷歌索引，假设我在 asp.net 2.0 中开发系统，我将如何实现这一点。

我知道将其编入索引的一部分是在我的情况下为 course_code 的链接中传递变量，这显然也允许为课程传单添加书签，这很好。让 googlebot 最好地拖网系统的具体细节是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T20:10:01.077

查看[Google 的网站管理员工具](http://www.google.com/webmasters/tools/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T20:27:04.163

如果 Google bot 能够通过以下链接抓取您的页面并在您的网站上到处访问，而无需填写任何表格或运行任何 JavaScript，那么您应该很高兴。

（免责声明：虽然我在谷歌工作，但我没有看过爬虫是做什么的，除了公众知识之外我知之甚少。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T20:52:15.657

一件大事是使用 url 重写方案，如果可以的话，可以避免像

[http://www.yoursite.com/default.aspx?course_code=CIS612](http://www.yoursite.com/default.aspx?course_code=CIS612)

但是通过重写，你可以得到类似的东西

[http://www.yoursite.com/courses/CIS612.aspx](http://www.yoursite.com/courses/CIS612.aspx)

这些类型的东西真的很有帮助，因为查询字符串并不是那么完美。

[UrlRewriting.net](http://www.urlrewriting.net)是开始使用重写器的好地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T21:00:18.213

删除 sitemap.xml 文件-它们有很多帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T09:53:02.630

使用 wget 抓取您的网站。

```
wget -r www.example.com 
```

如果 wget 无法访问您的某些 URL，则 Google 不太可能访问它们。

# c# - 小数舍入问题

> ID：341848
> 
> 赞同：5
> 
> 时间：2008-12-04T20:00:31.190
> 
> 标签：c#, types

鉴于 Decimal.MaxValue = 79228162514264337593543950335m

为什么下一行在本地窗口中给我 7922816251426433759354395034M 而不是预期的 7922816251426433759354395033.5m？

小数目标 = Decimal.MaxValue / 10m；

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T20:04:56.577

我怀疑这是一个编译器错误，实际上。

这是一个简短但完整的程序来说明我为什么这么认为：

```
using System;

class Test
{
    static void Main()
    {
        decimal constant = decimal.MaxValue / 10m;
        decimal calculated = decimal.MaxValue;
        calculated /= 10m;

        Console.WriteLine (constant);
        Console.WriteLine (calculated);        
    }
} 
```

输出：

```
7922816251426433759354395034
7922816251426433759354395033.5 
```

我将深入研究规范以查看提供了哪些保证。

编辑：在规范中，第 7.18 节声称：

> 常量表达式的编译时求值使用与非常量表达式的运行时求值相同的规则，除了在运行时求值会引发异常的情况下，编译时求值会导致发生编译时错误。

这显然不是这里的情况。唔。

编辑：我已经向[Microsoft Connect 提交了一个错误](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=386571)。我们会看看它会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T20:06:21.223

我猜是因为您在除以 10 时超出了最大精度值。 [http://en.wikipedia.org/wiki/Arithmetic_precision](http://en.wikipedia.org/wiki/Arithmetic_precision)

# dynamics-crm - 在 Microsoft CRM 4.0 中按帐户显示和使用高级查找产品订阅

> ID：341852
> 
> 赞同：0
> 
> 时间：2008-12-04T20:02:25.850
> 
> 标签：dynamics-crm, dynamics-crm-4

默认情况下，在编辑模式下查看客户时，您可以访问商机、发票和报价，其中包含客户和/或销售部门购买的产品。

我正在尝试确定在哪里存储、显示和使用帐户也订阅的产品。

我可能不理解实现，但似乎应该直接关闭根帐户管理窗口的“产品”选项，该选项将向用户显示该帐户已购买的所有产品。

我们正在尝试将其与我们的生产跟踪系统集成，在该系统中，产品销售可以来自其他不会首先通过 CRM 流动的渠道。此产品订阅不适合商机、报价或发票模型，因为它们是通过公共网站、门户等工具自动购买的确认经常性销售。

通过在 CRM 中启用此跟踪，我们可以使用高级查找功能来促进后续销售和营销工作。

示例：找到订阅模型 A 的每个人，这样我们就可以通知他们新的假日活动，他们可以在所有附加组件上获得 10% 的折扣。

我假设这是一个常见的场景，但是我想更好地了解如何在 Microsoft CRM 的世界中解决这个问题。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T20:50:12.447

关于 CRM，可以创建具有您问题中描述的关系的自定义实体。

因此，在 CRM 中，您可以创建一个名为 Product 的新实体并定义与 Account 的多对一关系。在此过程中，您将能够定义关系行为，例如级联规则。

不建议直接与 CRM 数据库交互，但是您可以通过 Web 服务访问平台相关服务，通过调用此服务上的方法，可以从您的公共网站创建条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-05T01:09:30.127

假设这是一个报告并且不需要交互：

创建一个报告，该报告可以使用 SSRS 在 CRM 中发布以所需的形式显示记录，
并显示在具有适当参数的 IFRAME 中，以过滤开立账户的记录。

就这样！

# asp.net - .NET 的 HTML 消毒剂

> ID：341872
> 
> 赞同：26
> 
> 时间：2008-12-04T20:06:44.623
> 
> 标签：asp.net, .net, html-sanitizing

我正在开始一个使用 asp.net mvc 面向公众的项目。我知道那里有大约 10 亿个 php、python 和 ruby​​ html 消毒剂，但是有没有人指出 .net 中有什么好的东西？你对外面的东西有什么经验？我知道 stackoverflow 是一个在 asp.net 中完成的网站，它允许自由格式的 HTML，它使用什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-09-26T07:43:44.493

### [HtmlSanitizer](http://www.nuget.org/packages/HtmlSanitizer/)

来源：[https ://github.com/mganss/HtmlSanitizer](https://github.com/mganss/HtmlSanitizer)

相当强大的消毒剂。它理解并且可以清理内联样式，但没有可以处理 <style> 块的解析器，因此它会剥离它们。它肯定达到甚至可能超出了微软的 AntiXSS 在被放弃之前所处的水平。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T20:13:49.697

[https://blog.stackoverflow.com/2008/06/safe-html-and-xss/](https://blog.stackoverflow.com/2008/06/safe-html-and-xss/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-29T08:20:21.953

**[HtmlRuleSanitizer](https://github.com/Vereyon/HtmlRuleSanitizer)**

根据您的问题，我有以下建议：

*   您希望允许自由格式的 HTML，因此您需要一个能够指定一组允许的标签、属性和/或 CSS 类的解决方案。
*   通过允许自由格式的 HTML，您可能还必须处理格式错误的 HTML，因为用户会犯错误（有意或无意）。因此，您需要一个基于容错分析器（例如[Html Agility Pack](https://htmlagilitypack.codeplex.com/) ）的解决方案。
*   您将需要采用白名单方法，因为黑名单消毒剂不会保护您免受任何新 HTML 规范的影响。此外，由于 HTML 规范的大小，很难保证黑名单首先涵盖所有情况。

我遇到了同样的问题并构建了 HtmlRuleSanitizer，它是基于 Html Agility Pack 之上的基于白名单规则的 HTML 清理程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-17T23:41:02.520

[这里](http://roberto.open-lab.com/2010/03/04/a-html-sanitizer-for-c/)有ac#版本

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-12-12T04:42:42.640

这是一个由微软构建的。[http://wpl.codeplex.com/](http://wpl.codeplex.com/)

```
var cleanHtml = Sanitizer.GetSafeHtml(unsafeHtml); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-15T08:07:19.847

我们也可以使用

AntiXss.GetSafeHtmlFragments

通过解析 HTML 片段来清理输入，将这个清理器用于富内容，以确保它不包含任何有害脚本并且可以安全地显示在浏览器上。对于文本输入（非富内容）使用 AntiXss.HtmlEncode或任何其他等效的 html 编码器。这里是丰富内容的示例。

```
 string mal = "<IMG NAME = 'myPic' SRC = 'images / myPic.gif' onerror='alert(1)' onerror='alert(1) ><div bottommargin = 150 ondblclick = 'alert('double clicked!')' >< p > Double - click anywhere in the page.</p> </div> ";
                var cleanHtml = Sanitizer.GetSafeHtmlFragment(mal);
                Console.Write(cleanHtml);
                Console.Read(); 
```

**注意：从 nugetpackage manager 下载 AntiXSS 库，并将此命名空间** **Microsoft.Security.Application 包含在源代码中**；

# sql - mysql update 语句的行为会根据用户变量是否存在而有所不同

> ID：341877
> 
> 赞同：1
> 
> 时间：2008-12-04T20:07:52.250
> 
> 标签：sql, mysql, user-variables

我正在重置具有重复或缺失值的排序列，如下所示：

```
set @last='';
set @sort=NULL;
update conf_profile set sort=
    if(
        @last=(@last:=concat(org_id,',',profile_type_id,',',page,',',col)),
        (@sort:=@sort+1),
        (@sort:=0)
    )
order by org_id,profile_type_id,page,col,sort,id; 
```

（遍历所有按多个关键字段排序的行，这些字段分配逐渐递增的值进行排序；每当这些字段中的任何一个发生变化时，从 0 重新开始。）

似乎只有在进行更新之前创建了 @sort 变量时才有效（尽管它的设置无关紧要）。如果没有“set @sort”，所有排序值都设置为 0 或 NULL。

任何想法为什么会这样？MySQL 版本 5.0.51。

更新：为了更详细地解释逻辑：在第一行上，@last=(@last:=...) 将始终为 false，此后当任何关键字段从前一行更改时，它将为 false . （注意没有一个被连接的关键字段是NULL）。当它为假时，我们从 0 (@sort:=0) 重新开始排序计数器，否则，它会递增 (@sort:=@sort+1) 并使用新值。

在更新语句中设置之前，绝不会使用@sort，因此在更新语句之前是否设置或如何设置应该没有区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T20:26:51.260

未设置的用户变量被视为`NULL`您在表达式中引用它。

在 SQL 中，`NULL`+1 返回`NULL`. 如果您在此之前没有设置`@sort`为非`NULL`值，那么无论您评估多少次`UPDATE`，它都会继续存在。一旦你这样做，那么它应该正常增加。 `NULL``@sort:=@sort+1``@sort:=0`

试试这个而不做`UPDATE`：

```
mysql> set @sort := NULL;
mysql> SELECT @sort; -- returns NULL
mysql> set @sort := @sort + 1;
mysql> SELECT @sort; -- returns NULL again
mysql> set @sort := 0;
mysql> set @sort := @sort + 1;
mysql> SELECT @sort; -- returns 1 
```

我猜这只是一个巧合，您在第一次设置后没有重复`@sort:=0`。

**编辑：**以上是正确的，但正如您所指出的，它并不能解释您所看到的行为，因为`@sort`在评估第一行期间逻辑上应该保证设置为 0。

但是，我注意到如果我更改表达式中术语的顺序`IF()`，一切正常，即使在`@sort`我们开始时未设置：

```
set @last='';
-- set @sort=NULL;
update conf_profile set sort=
    if(
        @last!=(@last:=concat(org_id,',',profile_type_id,',',page,',',col)),
        (@sort:=0),
        (@sort:=@sort+1)
    )
order by org_id,profile_type_id,page,col,sort,id; 
```

我不确定我是否理解得很好，无法准确解释为什么会这样，但是关于何时评估用户变量有一些古怪的东西。有关大量示例和详细信息，请参阅此博客：“[高级 MySQL 用户变量技术](http://www.xaprb.com/blog/2006/12/15/advanced-mysql-user-variable-techniques/)”。

# linux - 从 Unix 上的 C 应用程序发送邮件的简单方法

> ID：341891
> 
> 赞同：1
> 
> 时间：2008-12-04T20:13:01.257
> 
> 标签：linux, email, smtp

我正在设计一个系统，在某些时候需要发送电子邮件通知。所以我正在寻找一种简单的方法来做到这一点。一些背景知识：系统将在 Linux 平台上运行，网络上的某处将有一个工作的 SMTP 服务器，运营商将配置其地址、服务器凭据（如果需要）和目标电子邮件地址列表（不，我不工作大量电子邮件系统；-)。需要发送电子邮件的过程可能会用 C 语言编写，但超级性能并不是真正的要求，不会有很多邮件要发送，因此调用一些命令行工具是可以接受的选项。基本上，我过去尝试过类似的任务：

*   以命令行模式调用本地 sendmail。这是一场噩梦，因为需要支持神秘的 sendmail 配置。这是我真正想避免的。
*   直接与 SMTP 服务器端口通信（EHLO 等）。这是一个选项，但对于 2008 年来说有点太低了;-)。
*   使用一些与本地 sendmail 守护进程对话的 MUA，充当邮件中继。这并不好，因为它需要启动和配置本地 sendmail。

所以我需要的基本上是一些 C 语言库或一个简单的命令行 MUA，它应该能够与远程 sendmail 通信（即与我告诉它的 SMTP 服务器通信），**但不需要本地邮件中继**。

欢迎任何想法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T20:15:15.013

mail(1) 或 mailx(1)
此外，由于您有一个本地 MTA，因此您可以将消息直接通过管道传送到 sendmail(8)（尽管它的名称，它是许多 MTA 用于注入邮件的标准接口）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T20:18:20.653

这是一个不错的 SMTP 库，[libESMTP](http://www.stafford.uklinux.net/libesmtp/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T21:10:51.890

Perl 的[Mail::Mailer](http://search.cpan.org/~markov/MailTools-2.04/lib/Mail/Mailer.pod)提供了一种通过本地 MTA 生成邮件的非常简单的方法（来自 perldoc -q mail 的示例）：

```
use Mail::Mailer;

my $mailer = Mail::Mailer->new();
$mailer->open({
    From    => $from_address,
    To      => $to_address,
    Subject => $subject,
}) or die "Can’t open: $!\n";
print $mailer $body;
$mailer->close(); 
```

如果您使用 C，您可以使用 Mail::Mailer 编写脚本包装器，或者直接通过外壳调用 MTA 并将格式化的消息写入其中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T02:26:54.920

对不起，但你要求的是不可能的。为了将邮件发送到另一个系统，您需要某种程序将邮件从一台计算机传输到另一台计算机。根据定义，这样的程序是 MTA。

您不必使用 Sendmail。正如其他海报试图告诉你的那样，你可以使用更轻量级的东西。您所需要的只是可以充当 SMTP 客户端的东西。您甚至可以将功能构建到您的程序中，但您最终还是会得到本质上是 MTA 的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-25T14:02:09.187

你试过[sendEmail](http://caspian.dotconf.net/menu/Software/SendEmail/)吗？

我已经成功使用了一个类似的独立 Win32 命令行邮件代理，名为[Blat](http://www.blat.net/)，并且我也在寻找一个类似的不需要系统支持的 Linux 解决方案。

过去，我使用[ssmtp](http://linux.die.net/man/8/ssmtp)作为 sendmail 的轻量级替代方案，尽管它通常需要系统范围的配置和支持。虽然这对于许多需要正常运行的 MTA 的应用程序很有用，但我知道它不能解决您的具体问题。

# java - 弹簧豆配置

> ID：341897
> 
> 赞同：0
> 
> 时间：2008-12-04T20:15:33.357
> 
> 标签：java, spring, configuration, javabeans

我想指定一个文件系统路径作为 Spring bean 配置的一部分。我知道我可以设置如下路径：

```
<bean id="myBean" class="com.example.BeanImpl">
  <property name="path" value="/WEB-INF/jsp"/>
</bean> 
```

路径 /WEB-INF/jsp 被解释为相对于 Web 应用程序根目录。但是如何指定相对于文件系统根目录的路径，例如 /usr/bin

干杯，唐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T20:24:12.327

使用 file: 谓词，如下所示：

`<property name="path" value="file:c:/somefolder/someotherfolder"/>`

现在我想起来了，它也是关于 bean 期望这条路径是什么的。它是使用路径向浏览器抛出（这使得整个文件：客户端机器上的事物相对）还是使用它以编程方式加载服务器上的文件？

# asp.net - 如何确定 jQuery 中匹配元素的元素类型？

> ID：341900
> 
> 赞同：73
> 
> 时间：2008-12-04T20:16:53.293
> 
> 标签：asp.net, javascript, jquery, html

我正在按 ID 名称匹配 ASP.Net 生成的元素，但我有一些元素可能会根据页面上下文呈现为文本框或标签。我需要弄清楚匹配是文本框还是标签，以便知道是通过 val() 还是通过 html() 获取内容。

```
$("[id$=" + endOfIdToMatch + "]").each(function () {
    //determine whether $(this) is a textbox or label
    //do stuff
}); 
```

我找到了一个不起作用的解决方案，它只是返回“未定义”：

```
$("[id$=" + endOfIdToMatch + "]").each(function () {
    alert($(this).tagName);
}); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2008-12-04T20:24:49.190

一个 jQuery 太多了：

```
$("[id$=" + endOfIdToMatch + "]").each(function () {
    alert(this.tagName);
}); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-07-17T12:02:27.507

Consider this solution without using *each()*:

```
var elements = $("[id$=" + endOfIdToMatch + "]");
var vals = elements.is("input").val();
var htmls = elements.is("label").html();
var contents = vals.concat(htmls); 
```

[Have a look at the documentation for *is*.](http://docs.jquery.com/Traversing/is)

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2010-02-18T20:45:51.763

you could also use something like this:

```
if ($(this).is('input:checkbox')) 
```

replace "this" with whatever instance you need and 'checkbox' with whatever input type you need.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-04T20:24:17.630

我第一次回答了我自己的问题。经过多一点的实验：

```
$("[id$=" + endOfIdToMatch + "]").each(function () {
   alert($(this).attr(tagName));
}); 
```

作品！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-10T15:55:05.353

tagName 多么好的提示。我还想建议使用 tagName.toLowerCase() 因为返回的值取决于文档类型（HTML 或 XML/XHTML）。

请参阅：[http ://reference.sitepoint.com/javascript/Element/tagName](http://reference.sitepoint.com/javascript/Element/tagName)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-07-02T21:37:44.830

in jquery 1.6 use prop()

### Example

```
var el = $('body');

if (el.prop('tagName') === 'BODY') {
    console.log('found body')
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-28T14:36:21.163

This the best way to Get the element type

```
function tgetelementType( elmentid )
{

    var TypeName = $('#' + elmentid).get(0).tagName;
    var TypeName2 = $('#' + elmentid).get(0).type;

    if($('#' + elmentid).get(0).tagName== "INPUT")
    {
       return $('#' + elmentid).get(0).type.toUpperCase()
    }
    else 
    {
        return $('#' + elmentid).get(0).tagName.toUpperCase() ; 
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-27T17:39:37.477

```
$("[id$=" + endOfIdToMatch + "]").each(function(){
    var $this=jQuery(this),ri='';
    switch (this.tagName.toLowerCase()){
        case 'label':
            ri=$this.html();
            break;
        case 'input':
            if($this.attr('type')==='text'){ri=$this.val();}
            break;
        default:
            break;
    }
    return ri;
}) 
```

The question is, what do you intend to do after you've determined the tag name? You could just as easily filter the jquery list using an additional selector combined with .end() to do the same thing:

```
$("[id$=" + endOfIdToMatch + "]")
    .find("input:text")
    .each(function(){
         /* do something with all input:text elements */
    })
    .end()
    .find("label")
    .each(function(){
        /* do something with label elements */
    })
    .end() 
```

This could still be chained if you needed to do further things with this particular collection of elements...just like the example above.

In either case, you'd have to do something with the values while inside the `each()` statements

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-23T00:23:27.270

Yet another solution, arguably more elegant, is to write two separate functions for each element type:

```
$("input#" + id).each(function() { alert(this + " is an input"); });
$("label#" + id).each(function() { alert(this + " is a label"); }); 
```

# .net - 体面的低占用网络服务器？（。网）

> ID：341908
> 
> 赞同：6
> 
> 时间：2008-12-04T20:19:25.097
> 
> 标签：.net, asp.net

我正在寻找一个服务器，它是：

*   轻的，
*   无故障，支持 .NET，
*   在客户端上运行以进行测试，
*   在 Windows 上运行

Cassinni 漏洞太大，IIS 太贵，Apache 很难安装，XSP 是 linux，只有
Visual Web Developer 正在削减它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T20:25:12.730

IIS。那是唯一能够很好地支持 .Net 的服务器。您可以在 Apache 上使用 Mod_Mono，但这可能不如运行 IIS 稳定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T20:25:02.870

[卡西尼](http://www.ultidev.com/products/Cassini/)

**注意：（**来自他们的网站）

*“UltiDev 建议将 UltiDev Cassini Web 服务器作为 Intranet（局域网内）Web 服务器运行。由于 UltiDev Cassini Windows 服务在强大的本地系统下运行，因此如果不使用 HttpVPN，将 UltiDev Cassini 暴露到 Internet 可能是不安全的（ NT AUTHORITY\SYSTEM) 帐户。破坏在 Cassini 下运行的应用程序可能会让攻击者完全控制系统。”*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T20:28:05.393

[XSP](http://www.mono-project.com/ASP.NET) - “用 C# 编写的轻量级和简单的网络服务器”

当然，你会从 apache + mod_mono 获得更好的性能，但这绝对是轻量级的

此外，XSP 在 Windows 上运行：[http ://www.mono-project.com/Mono:Windows](http://www.mono-project.com/Mono:Windows)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T21:24:41.737

Probably not relevant to this discussion but be careful testing / debugging on cassini. Its threading model is different from IIS. I've had problems with security (thread.CurrentPrincipal etc) on cassini that just disappeared when I started debugging against IIS.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T20:23:19.613

[阿帕奇](http://httpd.apache.org/)和[Mod_mono](http://www.mono-project.com/Mod_mono)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-21T18:13:09.233

我工作的公司制造了一个名为[Neokernel Web Server](http://www.neokernel.com)的服务器来满足这些要求；它可以独立使用或嵌入到您的应用程序中并以编程方式启动。该程序集大约为 500KB，因此非常小。这是具有免费评估许可证的商业支持产品。它不是基于 Cassini 源代码，尽管与 IIS 和 Cassini 一样，它使用 ASP.NET 处理管道来处理 ASP.NET 文件。

# java - 无法启动 Camel 1.5.0

> ID：341911
> 
> 赞同：0
> 
> 时间：2008-12-04T20:20:18.903
> 
> 标签：java, spring, jakarta-ee, jms, apache-camel

我正在尝试运行骆驼示例“camel-example-spring-jms”（也在[http://activemq.apache.org/camel/tutorial-jmsremoting.html](http://activemq.apache.org/camel/tutorial-jmsremoting.html)）。但是，当我尝试使用“org.apache.camel.spring.Main”类启动 Camel 时，我收到错误消息

**“配置问题：找不到 XML 模式命名空间的 Spring NamespaceHandler [ [http://activemq.apache.org/schema/core]](http://activemq.apache.org/schema/core]) ”**

[注意：当我使用 Maven 命令 "mvn exec:java -PCamelServer" 时，我能够很好地运行该示例]

有人可以帮助我了解可能导致这种情况的原因。潜在的解决方案提示也不会受到伤害:)

++++++ 错误堆栈 +++++

```
Dec 4, 2008 12:45:01 PM org.apache.camel.util.MainSupport doStart
INFO: Apache Camel 1.5.0 starting
Dec 4, 2008 12:45:01 PM org.springframework.context.support.AbstractApplicationContext prepareRefresh
INFO: Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@1ac3c08: display name [org.springframework.context.support.ClassPathXmlApplicationContext@1ac3c08]; startup date [Thu Dec 04 12:45:01 EST 2008]; root of context hierarchy
Dec 4, 2008 12:45:01 PM org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions
INFO: Loading XML bean definitions from file [C:\dev\camel-example-spring-jms\bin\META-INF\spring\camel-server-aop.xml]
Dec 4, 2008 12:45:02 PM org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions
INFO: Loading XML bean definitions from file [C:\dev\camel-example-spring-jms\bin\META-INF\spring\camel-server.xml]
Dec 4, 2008 12:45:03 PM org.apache.camel.util.MainSupport run
SEVERE: Failed: org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Failed to import bean definitions from relative location [camel-server.xml]
Offending resource: file [C:\dev\camel-example-spring-jms\bin\META-INF\spring\camel-server-aop.xml]; nested exception is org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://activemq.apache.org/schema/core]
Offending resource: file [C:\dev\camel-example-spring-jms\bin\META-INF\spring\camel-server.xml]

org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Failed to import bean definitions from relative location [camel-server.xml]
Offending resource: file [C:\dev\camel-example-spring-jms\bin\META-INF\spring\camel-server-aop.xml]; nested exception is org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://activemq.apache.org/schema/core]
Offending resource: file [C:\dev\camel-example-spring-jms\bin\META-INF\spring\camel-server.xml]

        at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
        at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)
        at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:76)
        at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.importBeanDefinitionResource(DefaultBeanDefinitionDocumentReader.java:201)
        at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseDefaultElement(DefaultBeanDefinitionDocumentReader.java:147)
        at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:132)
        at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:92)
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:507)
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:398)
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:342)
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:310)
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:143)
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:178)
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:149)
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:212)
        at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:113)
        at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:80)
        at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:123)
        at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:423)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:353)
        at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
        at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:93)
        at org.apache.camel.spring.Main.createDefaultApplicationContext(Main.java:189)
        at org.apache.camel.spring.Main.doStart(Main.java:152)
        at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:47)
        at org.apache.camel.util.MainSupport.run(MainSupport.java:121)
        at org.apache.camel.util.MainSupport.run(MainSupport.java:310)
        at org.apache.camel.spring.Main.main(Main.java:72) 
```

++++++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T08:50:05.487

所以它在 maven 下运行良好 - 但如果你运行它就不行了？在你的IDE还是什么的？

如果您使用的是 eclipse / intellij，您可以使用 maven 为 maven 项目创建一个 IDE 项目。

```
mvn eclipse:eclipse 
```

或者

```
mvn idea:idea 
```

如果您正在编写一些 shell 脚本或从命令行运行它，那么您很可能缺少一些 jar；你需要 spring + jaxb + commons-logging + camel-core、camel-spring 和 camel-jms。

获取 maven 类型中依赖项的准确列表

```
mvn dependency:tree 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T19:45:10.997

当 camel-jms 库 .jar 不在您的类路径上时，会导致此特定异常。正如 James 所提到的，确保该库在运行时正确位于您的类路径中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T21:37:06.623

我在使用骆驼时遇到了类似的问题（尽管它是骆驼 1.3）。就我而言，错误是：

```
org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate NamespaceHandler for namespace [http://activemq.apache.org/camel/schema/spring] 
```

我能够通过更改我的 jdk 版本来修复它。我使用的是 jdk 1.5，我升级到 1.6 并解决了我的问题。希望这可以帮助。

莫妮卡

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T09:12:03.677

你用的是哪个版本的JDK1.5？您是否在 Eclipse 和命令行中使用不同的 JDK？

可能是 JAXB 没有正确版本的问题。必须是 JAXB 2.1 或更新版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T16:30:35.880

在 Eclipse 内部和使用外部工具（Maven）时，我都遇到了同样的问题。正如 James 和 Pete 指出的那样，在类路径中添加 camel-jms.jar 解决了我的问题。看起来 camel-core 和 camel-jms 是基本的强制依赖项：

```
<dependency>
  <groupId>org.apache.camel</groupId>
  <artifactId>camel-core</artifactId>
  <version>1.6.0</version>
  <scope>compile</scope>
</dependency>

<dependency>
  <groupId>org.apache.camel</groupId>
  <artifactId>camel-jms</artifactId>
  <version>1.6.0</version>
  <scope>runtime</scope>
</dependency> 
```

# c# - 实施和执行编码标准

> ID：341920
> 
> 赞同：8
> 
> 时间：2008-12-04T20:24:31.360
> 
> 标签：c#, standards, coding-style

我的团队（我是其中最新和最初级的成员）在大约 1 年的时间里从 3 名开发人员增加到 9 名开发人员。我们的主要产品的复杂性增加了，我们即将对 Silverlight 进行为期一年的移植/重写。过去没有强制执行特定的样式/标准。

我向我的老板建议，现在是实施这些标准的好时机。我把[IDesign 的](http://idesign.net/idesign/DesktopDefault.aspx)文件传给了他，他很喜欢这个主意。他有2个顾虑。

1.  这是一个需要吸收的大文件。我的想法是为我们可能遇到的最常见项目开发一个精简的备忘单，并理解 IDesign 标准是“大师”，并且应该查看精简版本中未涵盖的任何内容在“主”文档中。

2.  执行此操作的最佳方法是什么。这不是试图发号施令的问题。这是一个试图让人们习惯于开发特定标准的问题。团队中至少有 2 个人已经发展到现在的非标准几年了。为了解决这个问题，我想看看是否有一个工具可以配置为强制执行这些标准，或者至少在编译时或设计时警告“违反”标准。我找到了 Microsoft 的 StyleCop，但据我所知，它是不可配置的，并且设置为遵循 Microsoft 的标准，与 IDesign 的标准不完全吻合。

任何关于工具或我正在研究的方法的输入将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T21:11:22.777

ReSharper、FxCop/StyleCop（至少有一种为 FxCop 定义自定义规则的方法）、清晰的代码指南和每月审查的组合应该可以为一个由 9 人组成的团队完成工作。如果有人违反规则，您将别无选择，只能使用鞭子:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T20:27:13.413

定期的代码审查将是一个好方法......

我发现开发人员对有关特定标准的面对面讨论反应更好，而不是仅仅将其留给工具。

将工具与代码审查一起使用应该很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-05T12:46:13.390

很难夸大编码标准的重要性。关键是你应该有一个每个人都能快速阅读和理解的一致的代码库。你选择哪一套标准并不重要（只要每个人都注册）——但如果你选择一个被广泛使用的标准，那么更少的开发人员将不得不调整他们的风格。[Microsoft 类库开发人员设计指南](http://msdn.microsoft.com/en-us/library/czefa0ke.aspx)是我最喜欢的（并且对 ReSharper 非常友好[）](http://www.jetbrains.com/resharper/)。

我的一位同事 ( [Howard van Rooijen](http://blogs.conchango.com/howardvanrooijen/default.aspx) ) 和他的开源团队正在[为 ReSharper 开发出色的 StyleCop，](http://www.codeplex.com/StyleCopForReSharper)它通过在您键入时突出显示它们来实时显示样式违规！[最近发布](http://blogs.conchango.com/howardvanrooijen/archive/2008/11/15/stylecop-for-resharper-v0-0-14197-released.aspx)了一个强烈推荐的版本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-24T17:15:34.530

我在目前的公司（多个项目的小型开发人员，每个项目有 1-6 名程序员；我们主要是 C++，但我想答案仍然适用）获得对编码标准的认可的经验笔记：

代码审查**备忘单**是个好主意。为您的组织量身定制（例如容易忽略或出错的内容），并随时更新（每月一次，回来删除以其他方式强制执行的内容）。如果你有一个 wiki，如果可以的话，请为每个点包含指向“为什么”的链接！

**拆分您的评论**。有些提交请求正式审查，有些则没有。我们使用几种类型：

*   *Mini-Design-Doc 评论*，其中一个简短的（通常是 wiki 上的一页或两页）在实施开始之前由小组评论。非常适合及早发现“重新发明轮子”。
*   有指导的*热情评论*，一个或多个同行在提交之前与原作者坐在一起（非常适合传播专业知识，让合作社/实习生跟上进度）。原作者往往比审稿人发现更多的问题。=)
*   正式的提交后*冷评审*，没有指导的人（除了签入评论和任何文档）评审代码。这往往会揭示逻辑或错误处理问题，以及边界错误。

**自动化**和**推送，不要拉取**有用的信息。我们从我们的构建服务器邮寄报告——它通常在每次提交时构建一次（取决于它的繁忙程度）。这些报告可以包括例如当前 Gimpel PC-Lint 运行与上次运行之间的差异。这解决了“信息过多”的问题：您只会得到*您*可能负责的警告/错误以及描述。当信息范围缩小且易于理解时，人们将其用作学习工具。

这一点我怎么强调都不为过：**不要为小事出汗**。（请参阅奇妙的 C++ 编码标准书的第 0 点。）

*   将您的编码标准分成两个或更多部分，一个“必需”和“推荐”部分——让人们可以在闲暇时阅读推荐部分，并保持所需部分较小。
*   在审查时，明确描述现在真正重要的东西，以及不重要​​的东西。例如，对于我们的“热情审查”：括号放置和命名不一致明确地“稍后修复”，因为我们不想使人们在提交前审查之前所做的任何测试无效。逻辑错误是“现在修复，在提交之前”。错误处理不一致或丢失的情况各不相同。如果您要求人们立即修复甚至是微不足道的违规行为，您会感到不满。

最后，**鼓励参与**并随着时间的推移改变你的编码标准**。**（这是 wiki 可以发挥作用的地方。）如果有人有正当理由不遵循标准（要么他们有更好的东西，要么遵循的 PITA 太多），倾听并做出回应。如果人们真的积极地为标准做出贡献并理解标准，而不是仅仅接受标准，你会得到更好的回应。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-04T20:29:00.447

StyleCop 将是一个很大的帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T20:26:40.030

试试 ReSharper，它可以将你的代码格式化为你的风格。甚至可以立即重新格式化整个解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T20:40:04.027

谢谢大家的建议。我很想听听更多。碰巧的是，当我按照[Ilya Ryzhenkov](https://stackoverflow.com/users/18575/ilya-ryzhenkov)的推荐研究 Resharper 时，我碰巧重新下载了 IDesign 标准，该标准以 zip 文件的形式提供，其中包含指向此[博客条目](http://joel.fjorden.se/static.php?page=CodeStyleEnforcer)的链接。好的部分是它默认为我想要使用的标准。[它很便宜（如果你不捐赠，可以免费阅读）而且我很可能是Code-Rush](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)的忠实粉丝！[和 Refactor](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)，所以我已经加载了 DXCore！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-20T22:29:16.193

我刚刚写了一篇关于一起使用 ReSharper 和 StyleCop 的博客，并通过持续集成（使用 NAnt）来执行它。

[http://www.robertbeal.com/archives/47](http://www.robertbeal.com/archives/47)

看看你是怎么想的。它对我们非常有效。如果引入了单个代码违规，目前我会失败构建一些抱怨。虽然我们确实有成千上万的违规行为（主要是在旧的遗留代码中），所以我的回应是清理其中一个，那就是代码应该变得更好而不是更糟。

我收到了一次回复，希特勒的夜间构建失败： [http ://www.youtube.com/watch?v=Azl4nqLn4-Y](http://www.youtube.com/watch?v=Azl4nqLn4-Y)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-24T16:25:23.677

找到比这更短的*东西。*开发人员要记住的东西*太多*了，期望他们记住的不仅仅是一页规则是浪费时间。即使你给他们一张备忘单，除非那是官方的且*唯一*的文件，否则你最终只会让开发人员为其余部分发明自己的风格。

遵循一个简单的约定比不遵循一个大而复杂的文档要好。

顺便说一句，您是否确保从团队中获得适当的帮助？

几乎我见过的所有代码标准都规定了一些愚蠢的东西，比如所有 if 语句必须包含大括号，这会破坏像

```
public bool compare (Object other){
  if(other == null) throw new NullPointerException("You twit, don't give me a null pointer");
  if(!(other instanceof CustomerObject)) throw new UnsupportedArgumentException("Give me the right argument, dammit");
  ... 
```

因为这样的东西现在占用了三行，因此不被写入（或者如果写入，阻止程序员弄清楚该方法在做什么）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T20:32:26.117

如果您的团队有一个持续构建（例如使用[Hudson](http://hudson-ci.org/)），您可以通过使构建失败或在有人提交违反样式准则的更改时使其不稳定来强制执行样式约束。Hudson 有一个[Violations](http://hudson.gotdns.com/wiki/display/HUDSON/Violations)插件，可以与 Checkstyle 和 StyleCop 等工具一起使用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-04T20:42:03.757

在不知道您的配置管理设置是什么样子的情况下，我会说您应该首先寻找与您的版本控制系统集成的工具，以便在代码提交到存储库之前评估代码。我已经使用我们的 SVN 设置完成了此操作，并且也看到它使用 CVS 完成...它在一定程度上是有效的，因为它迫使开发人员提交“正确”代码并保持您的存储库整洁。如果用户没有在提交消息中提供特定信息（即错误编号、项目任务等），则一个简单的示例是拒绝提交。

除了工具之外，您还必须找到一种方法来向开发人员描述编码标准的价值。听起来很简单，但到目前为止，这对我来说是最困难的部分。向开发人员表明，在维护代码库方面，一点点努力可以大有帮助。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-03T14:11:27.780

在我们公司，我们使用 C# 的参考卡。参考卡使用 2 张幻灯片在 Powerpoint 中制作。前页和后页（2 页打印）。每张幻灯片有 3 列（报纸设置）。在每列之间制作 1 厘米的白色以实现折叠。

将公司完整编码指南中最重要的方面放在 2 张幻灯片中（例如，我们有：编码风格、命名空间和解决方案结构、命名约定）。

您选择了 IDesign 的开箱即用编码指南。也许你更容易熟悉 MS 编码风格，但这是你的选择。大多数开发人员都熟悉 MS 指南，因此更容易熟练。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-09-11T20:27:36.537

使用 TFS 和 VS 2010，以及 ac# base，我们这样做：

我们使用未经编辑的 idesign 标准作为我们的纸上代码标准。

我们维护一组代码分析和样式警察定义，我们在零容忍的发布版本上运行这些定义。

我们还维护了一个兼容的 Resharper 根定义，允许开发人员在使用它时快速格式化他们的代码以设置样式。这简化了他们的工作流程，因为他们不再需要等待来自构建时检查的 SA/CA 警告。

我们允许开发人员覆盖根定义。

然后在审查过程中发现并解决这两个层未发现的标准冲突。在评论中找不到的东西在代码维护中找到。

# web-services - 自动查询到谷歌搜索？

> ID：341927
> 
> 赞同：2
> 
> 时间：2008-12-04T20:26:27.597
> 
> 标签：web-services

我查看了 code.google.com，但我没有找到任何地方如何以编程方式对 Google 进行搜索查询并获得结果。您是否碰巧知道这是否可能，使用一些网络服务或任何其他方式？

当然，总是有可能发送搜索查询，获取结果页面的 HTML 内容并解析它，但如果可能的话，我想避免这样的麻烦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T20:44:41.163

[谷歌有着非凡的历史，而且在某种程度上](http://blog.wired.com/monkeybites/2008/04/google-search-a.html)。[其搜索 API 的发展](http://blog.programmableweb.com/2008/04/21/googles-rest-api-for-search/)坎坷第三方也有一些试图[盗用内容的](http://en.wikipedia.org/wiki/Scroogle)尝试。

对您来说，快速了解一下 Google 曾经在哪里以及现在关于其搜索 API 的位置（通过上面的链接）可能是值得的。不同的人对 Google 搜索 API 比个人网络抓取（您似乎想要避免的选项）好多少有不同的看法。

值得*再次强调*的是，谷歌[并不是唯一的游戏](http://www.programmableweb.com/api/yahoo-search)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T20:30:20.787

这可以通过[Google AJAX Search API](http://code.google.com/apis/ajaxsearch/web.html)实现。

# wpf - 有没有办法强制 WrapPanel 在 WPF 中插入“换行符”？

> ID：341933
> 
> 赞同：8
> 
> 时间：2008-12-04T20:27:31.197
> 
> 标签：wpf

如果我将元素插入到换行面板中，并且在下一行溢出之前面板中仍有空间，我是否可以专门将其换行以便后续元素位于下一行？

我正在寻找这样的东西：

```
<WrapPanel>
  <Element/>
  <Element/>

  <NewLine???/>

  <Element/>
  <Element/>
  <Element/>
</WrapPanel> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-04T20:42:17.953

这有效：

```
<WrapPanel>
    <TextBlock>1</TextBlock>
    <TextBlock>2</TextBlock>
    <TextBlock>3</TextBlock>
    <TextBlock>4</TextBlock>

    <TextBlock Width="10000" Height="0" />

    <TextBlock>5</TextBlock>
    <TextBlock>6</TextBlock>
</WrapPanel> 
```

我必须补充一点……这几乎是一个黑客。您可能需要考虑使用 StackPanel，并在其中使用 WrapPanel，其中包含要包装的项目...示例：

```
<StackPanel>
    <WrapPanel>
        <TextBlock>1</TextBlock>
        <TextBlock>2</TextBlock>
        <TextBlock>3</TextBlock>
        <TextBlock>4</TextBlock>
    </WrapPanel>
    <WrapPanel>
        <TextBlock>5</TextBlock>
        <TextBlock>6</TextBlock>
    </WrapPanel>
</StackPanel> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-15T13:52:29.277

来自[https://stackoverflow.com/a/3587172/3797778](https://stackoverflow.com/a/3587172/3797778)

只需添加：

```
<TextBlock Text="&#xD;"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-04T19:07:50.560

可以只向要在新行上的控件添加一个边距：

```
<TextBlock Margin="0,20,0,0">5</TextBlock> 
```

# .net - Castle Windsor：如何在我的配置中连接事件？

> ID：341935
> 
> 赞同：2
> 
> 时间：2008-12-04T20:27:40.963
> 
> 标签：.net, xml, events, castle-windsor

我有这样的事情：

```
public interface IDeviceMonitor {
    int DeviceId { get; }
    event DeviceUpdatedHandler NewValueRecieved;
    void Start();
    void Stop();
}
public class DeviceInactivityDetector {
    ...
    public virtual void DeviceUpdated(IDeviceMonitor device, DeviceUpdatedArgs args) {
        ....
    }
} 
```

目前，在我的应用程序启动文件中

```
var dm = IoC.Container.Resolve<IDeviceMonitor>();
var did = IoC.Container.Resolve<DeviceInactivityDetector>();
dm.NewValueRecieved += new DeviceUpdatedHandler(did.DeviceUpdated); 
```

我想可以通过 xml 使用我的城堡配置文件进行此连接。但是怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T21:15:06.323

使用 EventWiring Facility，您可以使用配置将组件的方法（订阅者）连接到组件的事件（发布者）。

[http://www.castleproject.org/container/facilities/v1rc3/eventwiring/index.html](http://www.castleproject.org/container/facilities/v1rc3/eventwiring/index.html)

```
<configuration>
<facilities>
    <facility 
        id="event.wiring"
        type="Castle.Facilities.EventWiring.EventWiringFacility, Castle.MicroKernel" />
</facilities>

<components>
    <component 
        id="DeviceInactivityDetector" 
        type=" . . ." />

    <component 
        id="IDeviceMonitor" 
        type=". . ." >
        <subscribers>
            <subscriber id="DeviceInactivityDetector" event="NewValueRecieved" handler="DeviceUpdated"/>
        </subscribers>
    </component>
</components> 
```

# asp.net - 识别纯文本 URL

> ID：341942
> 
> 赞同：9
> 
> 时间：2008-12-04T20:29:49.210
> 
> 标签：asp.net, regex, url

这应该很容易，但我不确定如何最好地去做。我有一个 WinForms 应用程序，可以让用户输入长描述。有时，他们会输入 URL，RichTextBox 会识别它们并在显示时使它们可点击。

我正在将应用程序移至网络，但我不确定如何使这些相同的 URL 可点击。是否有一些半自动的方法可以将“ [http://www.google.com](http://www.google.com) ”或“www.google.com”转换为可点击的链接？我必须求助于 RegEx 匹配吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-04T20:34:16.613

这实际上是一个非常困难的问题。您可以使用正则表达式接近，但并不完美。这里有一个非常好的潜在正则表达式模式细分：[http ://www.regexguru.com/2008/11/detecting-urls-in-a-block-of-text/](http://www.regexguru.com/2008/11/detecting-urls-in-a-block-of-text/)

他列出的最后一个似乎对于大多数用途来说已经足够了：

```
\b(?:(?:https?|ftp|file)://|www\.|ftp\.)
  (?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#/%=~_|$?!:,.])*
  (?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[A-Z0-9+&@#/%=~_|$]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T20:49:57.923

谨防。如果您的用户生成的可点击 URL 对其他用户可见，那么您将引入跨站点脚本攻击等新问题。此外，您可能需要清理 URL。例如，URL 中可能有一个 & 符号，但您需要对其进行转义。

所以，实际上有两个步骤。1\. 找到网址。2\. 使网址可点击。

第 2 步可能更难。

另外，要注意括号之类的东西。一些用户乐于在句子中使用他们的 URL，然后以句点结尾。例如，我喜欢[http://www.pie.com](http://www.pie.com.It)。它很好。解决此问题的最佳方法之一就是在用户键入时生成 URL。如果出现问题，他们将能够在提交之前告知。

# apache-flex - Flex List 控件不止一个String？

> ID：341943
> 
> 赞同：1
> 
> 时间：2008-12-04T20:30:09.430
> 
> 标签：apache-flex, actionscript-3, user-interface, list

我有一个列表控件，我想在其中显示一个字符串（很好），但也有一个彩色方块。

想象一下，我有一个“添加播放器”按钮，一个带有颜色选择器的文本输入。我想在列表中查看颜色 + 玩家名称。我怎么能这样做？

```
[Bindable]
public var data:ArrayCollection = new ArrayCollection();  

<mx:List id="eqlist" width="100%" dataProvider="{data}" />

data.addItem(fooTxt.text); 
```

这段代码只会添加文本值，我应该添加一个由彩色画布 + 文本值组成的 hbox 对象吗？

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T22:09:51.177

您必须使用 List itemRenderers。基本上列表项渲染器（ListItemRenderer）不支持每个项目不同的背景颜色（背景颜色只能在列表父项上设置）。

示例（MXML 版本 - 不是我最喜欢的方式，但最简单）：

数据提供者初始化：

```
 var anObject: Object = new Object();
            anObject.label = "my player";
            anObject.backgroundColor = 0xFF0000;
            anObject.color = 0xFFFFFF;
            aData.addItem(anObject);

            anObject = new Object();
            anObject.label = "my player 2";
            anObject.backgroundColor = 0x0000FF;
            anObject.color = 0xAAAAAA;
            aData.addItem(anObject); 
```

列表显示：

```
 <mx:List id="eqlist" width="100%" dataProvider="{aData}" >
        <mx:itemRenderer>
            <mx:Component>
                <mx:Canvas backgroundColor="{data.backgroundColor}"
                    color="{data.color}">
                    <mx:Label text="{data.label}">

                    </mx:Label>
                </mx:Canvas>
            </mx:Component>
        </mx:itemRenderer>
    </mx:List> 
```

# asp.net-mvc - 有哪些值得为体验编码的 Web 应用程序？

> ID：341949
> 
> 赞同：10
> 
> 时间：2008-12-04T20:31:33.123
> 
> 标签：asp.net-mvc, model-view-controller

最近我进入了 web 开发（在 asp.net mvc 中），我正在寻找一些值得编码的 web 应用程序想法，最好是难度越来越大。我的第一个应用程序（我目前正在编写代码）是一个照片库网站

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T20:36:36.640

您可能会充分利用的应用程序是您最想实际使用的应用程序。这样一来，您将有更多的动力来添加功能，考虑可用性等，而不是仅仅为了学习而做一个。

有经验的实施要求很方便：

*   安全性（登录、数据库安全等）
*   国际化（如果你真的很热衷 - 这可能非常棘手！）
*   AJAX
*   数据库访问

如果你能想到一些你可能想要实际*使用*的东西，涵盖其中的大部分，你会学到很多东西。当然，如果您能想到一些尚不存在的东西，那就更好了 - 当您开始有所收获时，您可以找到自己的公司 :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-04T20:40:09.097

**你感兴趣的东西。**如果你不感兴趣，你可能不会完成它。很可能你一遇到障碍就会停下来。但是，如果您对它感兴趣，那么在挑战中坚持下来的几率要高得多。

请记住，您学到的更多是克服重大障碍，而不仅仅是编写大量代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-04T20:32:43.650

一个简单的博客站点（从头开始编码）非常好。数据库交互性，登录以获取评论...最终搜索等 :)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-04T20:39:12.593

编写自己的 CMS。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T20:36:08.013

**博客**是你会经常听到的东西，但如果你想要别的东西，你可以尝试做一个简单的**在线游戏**（不是 Flash ......）我的意思是浏览器在线游戏。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T20:34:21.527

我会说使用领域驱动设计、单元测试、Web 测试和使用 OR 映射器的购物车 :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T20:37:24.907

试着想想你会实际使用的东西，而不是实现一个磨坊应用程序的运行。它将迫使您做出重要的设计和界面决策，并挑战您如何实现自己的想法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T20:45:01.020

也许博客的一个明显前身是留言板。虽然博客可能支持标记、存档、搜索和评论等功能，但讨论板增加了拥有用户的额外元素。这意味着添加身份验证、区分用户类型、跟踪帖子计数、更复杂的搜索功能、用户属性（头像、电子邮件、密码等）以及其他此类功能。不过，离制作博客并没有那么远。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-04T20:58:22.150

我会推荐一个简单的任务列表应用程序。这为您提供了一些选项来使用诸如注释、标签、ajax、重新排序、多个列表等等。在使用多种技术时，您真的可以将其变得简单（只是项目列表）或复杂（[记住牛奶](http://www.rememberthemilk.com)）。

当然也有标准的博客、wiki、cms 选项。正如其他海报所提到的，找到你感兴趣的东西并从那里开始。否则你可能不会坚持下去。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-07T07:56:36.450

博客聚合器对于初学者来说是简单而有趣的，或者某种公共 Web 服务消费应用程序...... Facebook 应用程序？:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-11T01:14:51.330

CMS.

It is interesting. Working with ASP.NET, you need to think about masterpages, content pages, etc, and how to work with those programatically and insert web controls at runtime, etc.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-11T01:35:55.843

经典的网络应用程序是某种多线程套接字服务器。尝试聊天服务器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-04T20:53:41.923

一个简单的联系人数据库是一个很好的入门项目。

# asp.net - gridview 控件中的按钮

> ID：341950
> 
> 赞同：0
> 
> 时间：2008-12-04T20:31:45.167
> 
> 标签：asp.net, visual-studio-2008, gridview, .net-3.5

我有一个显示从数据库返回的数据的 gridview 控件。gridview的datakey属性绑定到DB的ID列

GV 中的每条记录都有 2 个按钮和一个复选框。当单击这些控件中的任何一个时，我想获取单击该控件的行并根据单击的控件执行操作。

我希望我可以使用该`row_command`事件来捕获单击了哪个控件，但这并没有起到作用，除非我遗漏了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T20:33:52.230

您是否分配了按钮`CommandName`和`CommandArgument`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T20:43:43.397

问题也可能在于生命周期事件的错误顺序。您应该尽快将数据重新绑定到网格。尝试将数据绑定移动到`Page_Init`事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T20:45:02.113

代码背后：

```
protected void gvCustomers_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if (e.CommandName.Equals("RowSelected"))
    {
        GridViewRow row = (((e.CommandSource) as Button).NamingContainer) as GridViewRow;
        Label label = row.FindControl("lblFirstName") as Label;

        Response.Write(label.Text);
    }
} 
```

这是 ASPX 视图：

```
<asp:GridView AutoGenerateColumns="false" ID="gvCustomers" runat="server" OnRowCommand="gvCustomers_RowCommand" >

    <Columns>

        <asp:TemplateField>
            <ItemTemplate>

                <asp:Label ID="lblFirstName" runat="server" Text ='<%# Eval("FirstName") %>' />

           </ItemTemplate>
       </asp:TemplateField>

       <asp:TemplateField>
           <ItemTemplate>
               <asp:Button Text="Select" ID="btn1" runat="server" CommandArgument ='<%# Eval("FirstName") %>' CommandName="RowSelected" />
           </ItemTemplate>
       </asp:TemplateField>

    </Columns>

</asp:GridView> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-25T09:24:39.357

```
<asp:GridView ID="gvProduct" runat="server" AutoGenerateColumns="False" DataKeyNames="ID"OnRowCommand="gvProduct_RowCommand" >
    <Columns>
       <asp:TemplateField>
           <ItemTemplate>
               <asp:ImageButton ID="btnEdit" runat="server" CommandName="EditCommand" Text="Edit" />
           </ItemTemplate>                                         
       </asp:TemplateField>
       <asp:BoundField DataField="ProjectNo" HeaderText="ProjectNo" />
       <asp:BoundField DataField="Date" HeaderText="Date" />
       <asp:BoundField DataField="Shift" HeaderText="شیفت" />
    </Columns>         
</asp:GridView> 
```

这是代码：

```
protected void gvProduct_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if (e.CommandName == "EditCommand")
    {
        GridViewRow Row = (GridViewRow)((Control)e.CommandSource).NamingContainer;
        int productID = Convert.ToInt32(gvProduct.DataKeys[Row.RowIndex].Value);

        EditFunction(productID);
    }
} 
```

`EditFunction`是您为选定行设置代码的功能，我在此处将其删除。

你需要这样的东西吗？

# mysql - 合并两个 Django 项目的用户表的最佳方法？

> ID：341952
> 
> 赞同：5
> 
> 时间：2008-12-04T20:32:16.773
> 
> 标签：mysql, django

我在同一台服务器上有两个 Django 项目。第一个是几个月前推出的，此后已经收集了数百个用户帐户。第二个项目将在几天后启动，我们希望第二个项目允许第一个应用程序的用户使用相同的凭据进行身份验证。

起初，我打算简单地将用户表从第一个项目转储到第二个项目，但这不允许同步解决方案（用户在项目 B 上创建帐户，然后无法访问项目 A）。

Django 是否有某种方式可以本地切换数据库名称（因为它们在同一台服务器上）以进行用户身份验证，然后在完成身份验证后返回原始数据库？

如果不是，您认为解决我的问题的最佳方法是什么？另外 - 我们正在使用 MySQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T22:16:17.983

如果你稍等片刻，最终 Django 将获得多数据库支持。

但就目前而言，我认为解决您的问题的最佳方法是在对两个数据库的用户表进行更改后同步两个数据库的用户表。您可以使用信号支持来处理此问题：

```
from django.db import models

def user_post_save(sender, instance, **kwargs):
    ... run script to synchronize tables ...
models.signals.post_save.connect(user_post_save, sender=User) 
```

您将无法使用 ORM ......但是转储源表，然后删除目标并导入它会相对轻松。这肯定会导致时间问题，但交易将主要解决这个问题。如果两个站点互相踩踏是一个问题，我可能会考虑在更新期间在 User 表上设置写锁，并在 User 模型的 save() 方法（或pre_save 信号）在完成保存之前检查锁。这将保证在同步期间不会发送 post_save 信号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T21:34:19.050

这可能会让我开枪；*但是*您可以简单地创建新项目的用户表作为第一个项目的视图：

```
DROP TABLE proj2.users;
CREATE VIEW proj2.users AS SELECT * FROM proj1.users; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T21:14:02.133

Django 目前不支持多个数据库（有一个关于该主题的[wikipage](http://code.djangoproject.com/wiki/MultipleDatabaseSupport)）。

另一种方法是为第二个网站编写自定义[用户身份验证](http://docs.djangoproject.com/en/dev/topics/auth/#other-authentication-sources)模块，该模块将对第一个网站数据库进行 SQL 调用以提供登录。当第一个站点的用户登录到第二个站点时，Django 将在第二个站点中创建一个用户。但这可能会在更改全名和电子邮件地址时出现一些问题，因此它只能用于拥有用户名和密码。此外，您的用户必须在第一个站点上注册才能访问第二个站点，因此您需要更多自定义注册才能在第一个站点上注册。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-28T22:25:28.850

您可以根据需要使用 multidb 应用程序来处理多个数据库

[http://github.com/kron4eg/multidb-django/tree/master](http://github.com/kron4eg/multidb-django/tree/master)

# shell - 哈斯克尔互动

> ID：341953
> 
> 赞同：7
> 
> 时间：2008-12-04T20:32:18.643
> 
> 标签：shell, emacs, ide, haskell, interpreter

我对我的 Haskell 有点生疏了，我希望重新开始。我喜欢 F# 的一件事是与 Visual Studio 集成的 F# Interactive shell：我几乎可以评估任何东西（包括函数和类定义）并将 F# 用作 shell。Haskell 中是否有等价物？当我使用 时`ghci`，我无法评估函数定义。你如何解决这个问题？

我目前的首选设置是使用带有 haskell 模式的 Emacs 并打开交互式 ghi 解释器。但是，有没有办法只评估文件的区域？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T20:47:35.697

你可以使用'let'定义一个函数：

```
$ ghci
Prelude> let double n = n + n
Prelude> double 42
84 
```

另外，我不太推荐这个，因为 (A) 我写了它，并且 (B) 它非常未开发，但是[Halp](http://github.com/darius/halp/)在 Emacs 中很方便——它有点像集成到源代码中的 Haskell 代码的电子表格-代码缓冲区。您可以拥有一组您感兴趣的表达式，并通过一次按键查看它们的所有值如何根据自上次重新评估以来的编辑而变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T09:50:55.393

正如您所观察到的，GHCi 的功能相当有限 --- 简短的函数或表达式在命令行中很容易做到。对于其余部分，我发现自己正在加载模块。困难之一是**Haskell 在使用前没有定义，**因此通常很难从文件中提取有意义的片段。我通常会发现自己定义小模块并加载和重新加载它们。互动体验绝对不如人们想象的那么好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T09:22:05.237

Emacs 的 Haskell 模式提供了与解释器一起工作的功能。因此，如果您想从您编辑的模块中运行某些功能，您可以使用 Cc Cl 将当前模块加载到 ghci（或另一个 haskell 交互式）并切换到交互式缓冲区并在那里执行一些命令

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T20:51:19.620

ghci 提供了一些特殊的语法来做这样的事情。用于`let`函数定义。但是，在[GHC FAQ](http://www.haskell.org/haskellwiki/GHC:FAQ)中指出，复杂功能可能会很棘手，通常首选从文件加载。如果您使用诸如 Emacs 之类的东西，可以轻松集成源文件和 ghci 进程，那么这不是问题，因为您可以通过击键将定义加载到解释器中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T22:41:53.750

使用 O'Caml 和 F#，定义从文件顶部向下进行。但是，在 Haskell 中，文件中前面定义的类型或函数可以引用该文件后面的类型或函数。所以在 Haskell 中，一个模块需要一次编译。交互式循环与一次性编译不兼容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-25T21:37:07.513

Flymake 与 Emacs Haskell Mode 2.8 结合使用效果非常好，您可以立即得到类型检查器的响应。在我看来，这更具交互性。

# c# - 检索 SOAP 密码

> ID：341956
> 
> 赞同：1
> 
> 时间：2008-12-04T20:33:36.723
> 
> 标签：c#, security, soap

我正在使用 WCF 在 C# 中开发 Web 服务，并且我想创建一种自定义的安全处理方式。我找到了这种从发送到 Web 服务的肥皂消息中检索用户名的方法：

```
String username = System.ServiceModel.ServiceSecurityContext.Current.PrimaryIdentity.Name; 
```

我想知道是否有类似的方法可以从 SOAP 消息中检索密码？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T20:56:32.700

根据使用 WS-Security 的哪些位，密码可能不在消息中。可能有密码的哈希值或类似 kerberos 令牌的东西。

除非消息通过安全通道（例如 SSH）传递，否则您不希望消息包含密码。

# c# - 如何在 C# 中的结构上强制使用工厂

> ID：341957
> 
> 赞同：5
> 
> 时间：2008-12-04T20:33:41.450
> 
> 标签：c#, struct, factory

我有 ac# 结构，我需要禁止在其上调用 no args 构造函数。

```
MyStruct a;
/// init a by members   // OK
MyStruct b = MyStruct.Fact(args); // OK, inits by memebers

MyStruct s = new MyStruct(); // can't have that 
```

我这样做主要是为了强制所有成员的显式值，因为没有有效的默认值并且所有成员都必须具有有效值。

在 C++ 中这很容易，添加一个私有构造函数，但 C# 不允许这样做。

有没有办法防止上述情况？

我真的需要强制使用工厂，这样防止所有公共构造函数调用也能正常工作。

* * *

完全披露者：为了避免单声道依赖，c# 应用程序被自动翻译为 D ，其中`new Struct()`产生了一个指针，这对我来说是个麻烦事。然而，尽管如此，这个问题还是相关的，所以请忽略它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-04T20:37:43.220

你不能。根据 C# 中的定义，所有结构都有一个公共的无参数构造函数。（在 CLR 中几乎没有人这样做，但他们总是可以表现得好像他们有一样。）请参阅[这个问题](https://stackoverflow.com/questions/333829)，了解为什么不能在结构上定义自己的无参数构造函数（无论如何在 C# 中）。

事实上，如果您乐于在 IL 中编写值类型，则可以避免这种说法*。*我刚刚检查过，如果您确保您的值类型只有一个无参数构造函数，并将其设为内部，您将无法编写`MyStruct ms = new MyStruct();`但这并不能阻止：

```
MyStruct[] array = new MyStruct[1];
MyStruct ms = array[0]; 
```

它适用于新的限制 - 所以它并没有真正给你买任何东西。这真的很好，因为在 IL 中乱搞会很乱。

你确定你真的想一开始就写一个结构吗？这*几乎*从来都不是一个好主意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T20:38:33.483

你不能。

结构中的所有值都必须在构造时初始化，并且在构造函数之外没有办法这样做。

你到底想通过这样做来完成什么？结构是值类型，因此您将获得用于大多数操作的“新”结构。在结构上强制执行您将使用工厂的各种约束将非常困难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T20:40:44.960

任何人都可以在不调用构造函数的情况下随时创建结构，只要他们有权访问该结构。这样想：

如果您创建一个包含 1000 个元素的对象数组，它们都会被初始化为 null，因此不会调用构造函数。

对于结构，没有 null 之类的东西。如果您创建一个包含 1000 个 DateTime 对象的数组，它们都将初始化为零，即 DateTime.Min。运行时的设计者选择这样做，这样您就可以创建一个结构数组，而无需调用构造函数 N 次——许多人没有意识到存在性能损失。

不过，你的工厂想法是个好主意。它是否满足您创建接口并公开它的需求，但将结构设为私有或内部？这几乎是你将得到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T20:37:12.177

将它放在自己的程序集中，并将没有 args 的 MyStruct() 作为内部（VB 中的朋友）。将 Factory 与 MyStruct() 放在同一个程序集中，但使用 Public 访问器。

现在工厂可以访问无参数的 MyStruct，但是从程序集外部调用的任何东西都必须使用工厂。

编辑：我的错，我没有考虑到这是一个结构。你不能用一个结构来做到这一点，只能用一个类——在这种情况下，我之前的陈述是有效的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-29T15:32:55.890

您可以创建一个结构来检测它是否处于默认初始化状态，然后在这种情况下做一些适当的事情。我离开了工厂，但在常见的简单情况下，构造函数也可能是一个足够的工厂。

这是很多样板代码。既然你使用了 D，你可能会和我一样想，“我希望 C# 有模板混合。”

例子：

```
using System;

namespace CrazyStruct
{
    public struct MyStruct
    {
        private readonly int _height;
        private readonly bool _init; // Will be 'false' using default(MyStruct).

        /// <summary>
        /// Height in centimeters.
        /// </summary>
        public int Height
        {
            get
            {
                if (!_init)
                {
                    // Alternatively, could have the preferred default value set here.
                    // _height = 200; // cm
                    // _heightInit = true;
                    throw new InvalidOperationException("Height has not been initialized.");
                }
                return _height;
            }
            // No set:  immutable-ish.
        }

        private MyStruct(int height)
        {
            _height = height;
            _init = true;
        }

        public static MyStruct Factory(int height)
        {
            return new MyStruct(height);
        }
    }

    static class Program
    {
        static void Main(string[] args)
        {
            MyStruct my = MyStruct.Factory(195);
            Console.WriteLine("My height is {0} cm.", my.Height);
            try
            {
                var array = new MyStruct[1];
                var ms = array[0];
                Console.WriteLine("My height is not {0} cm.", ms.Height);
            }
            catch (Exception ex)
            {
                Console.WriteLine("Caught the expected exception: {0}.", ex);
            }
            Console.ReadKey();
        }
    }
} 
```

# ajax - 像“http://sharethis.com/”这样的小部件是如何进行看似 XSS 调用的

> ID：341966
> 
> 赞同：2
> 
> 时间：2008-12-04T20:35:23.320
> 
> 标签：ajax, xss, exploit

像这样的工具如何使 ajax 样式回调到中心站点？基本上他们给你一个“标签放在你的网站上。所以在这个小部件中，你可以要求向你发送一封电子邮件，以获取你当前所在的页面。我假设这会产生一个 ajax样式回调以分享发送电子邮件的人。但是，如果您的服务器上没有代理，并且浏览器不会将其作为 XSS 漏洞利用来阻止，他们怎么能做到这一点呢？

对此的任何答案将不胜感激，感谢您的帮助。我假设使用 Flickr API 会带来同样的挑战？

标题链接：[http ://sharethis.com/](http://sharethis.com/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T20:45:49.070

他们为您提供了一个脚本以包含在您的站点中。此脚本对 DOM 和您的 cookie 具有完全访问权限。为了让它回调到他们的站点，他们使用了一种称为 JSONP 的技术。您包含的脚本在查询字符串中添加了另一个带有参数的脚本。然后服务器返回 JSON（它只是 JavaScript），并提取数据。

如果您正在构建 mashup，您必须相信这些小部件不会做一些恶意的事情，例如窃取您的 cookie。IE 8 将更好地支持安全 XSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T21:31:14.203

您甚至不需要为此使用 JSON。

您可以使用脚本标记从任何域检索 javascript 代码，因此许多这些小部件只是创建一个脚本节点，响应格式如下：

```
someFunction("Callback Data"); 
```

someFunction 已经是原始小部件源中的现有函数，并将数据转储到您的 DOM 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T21:24:28.523

答案是，由于某种原因，浏览器只阻止 XmlHttpRequests 发送到原始服务器以外的服务器。您可以自由使用具有 SRC 指向任何位置的 <SCRIPT>-tags，这样的脚本标签当然可以动态插入到您的 DOM 中。

# java - 什么是“执行周围”成语？

> ID：341971
> 
> 赞同：157
> 
> 时间：2008-12-04T20:36:37.730
> 
> 标签：java, language-agnostic, design-patterns, idioms

我听说过的这个“Execute Around”成语​​（或类似的）是什么？为什么我可以使用它，为什么我不想使用它？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2008-12-04T20:51:32.460

基本上，在这种模式下，您编写一个方法来做总是需要的事情，例如资源分配和清理，并让调用者传入“我们想要对资源做什么”。例如：

```
public interface InputStreamAction
{
    void useStream(InputStream stream) throws IOException;
}

// Somewhere else    

public void executeWithFile(String filename, InputStreamAction action)
    throws IOException
{
    InputStream stream = new FileInputStream(filename);
    try {
        action.useStream(stream);
    } finally {
        stream.close();
    }
}

// Calling it
executeWithFile("filename.txt", new InputStreamAction()
{
    public void useStream(InputStream stream) throws IOException
    {
        // Code to use the stream goes here
    }
});

// Calling it with Java 8 Lambda Expression:
executeWithFile("filename.txt", s -> System.out.println(s.read()));

// Or with Java 8 Method reference:
executeWithFile("filename.txt", ClassName::methodName); 
```

调用代码不需要担心打开/清理方面 - 它将由`executeWithFile`.

坦率地说，这在 Java 中很痛苦，因为闭包太冗长了，从 Java 8 开始，lambda 表达式可以像在许多其他语言中一样实现（例如 C# lambda 表达式或 Groovy），而这种特殊情况从 Java 7 开始就使用`try-with-resources`和`AutoClosable`流处理。

尽管“分配和清理”是给出的典型示例，但还有很多其他可能的示例——事务处理、日志记录、执行一些具有更多权限的代码等。它基本上有点像[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)，但没有继承。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-12-04T20:55:19.410

当你发现自己不得不做这样的事情时，使用 Execute Around 成语：

```
//... chunk of init/preparation code ...
task A
//... chunk of cleanup/finishing code ...

//... chunk of identical init/preparation code ...
task B
//... chunk of identical cleanup/finishing code ...

//... chunk of identical init/preparation code ...
task C
//... chunk of identical cleanup/finishing code ...

//... and so on.
```

为了避免重复所有这些总是“围绕”实际任务执行的冗余代码，您将创建一个自动处理它的类：

```
//pseudo-code:
class DoTask()
{
    do(task T)
    {
        // .. chunk of prep code
        // execute task T
        // .. chunk of cleanup code
    }
};

DoTask.do(task A)
DoTask.do(task B)
DoTask.do(task C)
```

这个习惯用法将所有复杂的冗余代码移到一个地方，并使您的主程序更具可读性（和可维护性！）

查看[这篇文章](http://brandonbyars.com/blog/articles/2007/06/11/c-execute-around-method)以获取 C# 示例，并查看[本文](http://brandonbyars.com/blog/articles/2007/06/11/c-execute-around-method)以获取 C++ 示例。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-17T01:46:00.503

另请参阅[Code Sandwiches](http://pages.cs.wisc.edu/~liblit/tr-1647/)，它在许多编程语言中调查了这种结构，并提供了一些有趣的研究想法。关于为什么要使用它的具体问题，上面的论文提供了一些具体的例子：

> 每当程序操作共享资源时，就会出现这种情况。用于锁、套接字、文件或数据库连接的 API 可能需要程序显式关闭或释放它先前获取的资源。在没有垃圾收集的语言中，程序员负责在使用前分配内存并在使用后释放内存。通常，各种编程任务要求程序进行更改，在该更改的上下文中操作，然后撤消更改。我们称这种情况为代码三明治。

然后：

> 代码三明治出现在许多编程情况中。几个常见的例子与稀缺资源的获取和释放有关，例如锁、文件描述符或套接字连接。在更一般的情况下，程序状态的任何临时更改都可能需要代码三明治。例如，基于 GUI 的程序可能会暂时忽略用户输入，或者操作系统内核可能会暂时禁用硬件中断。在这些情况下无法恢复早期状态将导致严重的错误。

论文没有探讨为什么*不*使用这个成语，但它确实描述了为什么这个成语在没有语言层面的帮助下很容易出错：

> 有缺陷的代码三明治最常出现在存在异常及其相关的不可见控制流的情况下。事实上，管理代码三明治的特殊语言特性主要出现在支持异常的语言中。
> 
> 然而，异常并不是代码三明治缺陷的唯一原因。*每当对主体*代码进行更改时，可能会出现绕过后续代码的新控制*路径*。在最简单的情况下，维护者只需在三明治的*主体*`return`中添加一条语句即可引入新的缺陷，这可能会导致静默错误。当*正文* 代码很大并且前后*分开很**远*时，这样的错误很难从视觉上检测到。

 **** * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-04T20:55:15.557

[Execute Around 方法](http://c2.com/cgi/wiki?ExecuteAroundMethod)是您将任意代码传递给方法的地方，该方法可以执行设置和/或拆卸代码并在其间执行您的代码。

Java 不是我选择使用的语言。传递闭包（或 lambda 表达式）作为参数更时尚。尽管对象可以说[等同于闭包](http://c2.com/cgi/wiki?ClosuresAndObjectsAreEquivalent)。

在我看来，Execute Around 方法有点像[控制反转](http://c2.com/cgi/wiki?InversionOfControl)（依赖注入），您可以在每次调用该方法时临时更改。

但它也可以被解释为控制耦合的一个例子（通过它的参数告诉方法做什么，在这种情况下是字面意思）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-04T20:56:17.910

我看到您在这里有一个 Java 标记，所以我将使用 Java 作为示例，即使该模式不是特定于平台的。

这个想法是，有时您的代码在运行代码之前和运行代码之后总是涉及相同的样板。一个很好的例子是 JDBC。您总是在运行实际查询和处理结果集之前获取一个连接并创建一个语句（或准备好的语句），然后您总是在结束时执行相同的样板清理——关闭语句和连接。

执行周围的想法是，如果您可以分解样板代码，那就更好了。这样可以节省一些打字时间，但原因更深。这是这里的不重复 (DRY) 原则——您将代码隔离到一个位置，因此如果有错误或者您需要更改它，或者您只是想了解它，它都在一个位置。

不过，这种分解有点棘手的是，您有“之前”和“之后”部分都需要查看的引用。在 JDBC 示例中，这将包括 Connection 和 (Prepared)Statement。因此，为了处理这个问题，您基本上用样板代码“包装”您的目标代码。

您可能熟悉 Java 中的一些常见情况。一种是 servlet 过滤器。另一个是围绕建议的 AOP。第三个是 Spring 中的各种 xxxTemplate 类。在每种情况下，您都有一些包装对象，您的“有趣”代码（例如 JDBC 查询和结果集处理）被注入其中。包装对象执行“之前”部分，调用有趣的代码，然后执行“之后”部分。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-10-17T23:41:22.763

我会像对一个四岁的孩子一样解释：

**示例 1**

圣诞老人要进城了。他的精灵在他背后编写任何他们想要的代码，除非他们改变，否则事情会变得有点重复：

1.  获取包装纸
2.  获得**超级任天堂**。
3.  把它包起来。

或这个：

1.  获取包装纸
2.  买**芭比娃娃**。
3.  把它包起来。

....ad 令人作呕的一百万次与一百万个不同的礼物：注意唯一不同的是第 2 步。如果第 2 步是唯一不同的地方，那么圣诞老人为什么要复制代码，即他为什么要复制步骤1和3一百万次？一百万次礼物意味着他不必要地重复步骤 1 和 3 一百万次。

到处执行有助于解决这个问题。并有助于消除代码。第 1 步和第 3 步基本上是不变的，允许第 2 步是唯一变化的部分。

**示例 #2**

如果你还是不明白，这里有另一个例子：想想三明治：外面的面包总是一样的，但里面的东西会根据你选择的沙子的类型而变化（例如火腿、奶酪、果酱、花生酱等）。面包总是在外面，你不需要为你创造的每一种沙子重复十亿次。

现在，如果您阅读了上面的解释，也许您会发现它更容易理解。我希望这个解释对你有所帮助。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-04T21:33:22.703

这让我想起了[策略设计模式](http://en.wikipedia.org/w/index.php?title=Strategy_pattern&oldid=255021999)。请注意，我指向的链接包含该模式的 Java 代码。

显然，可以通过制作初始化和清理代码并传入一个策略来执行“执行周围”，然后总是将其包装在初始化和清理代码中。

与任何用于减少代码重复的技术一样，在至少有 2 个需要它的情况下使用它，甚至可能是 3 个（这是 YAGNI 原则）。请记住，删除代码重复减少了维护（代码副本减少意味着在每个副本中复制修复所花费的时间更少），但也增加了维护（更多总代码）。因此，这个技巧的代价是您添加了更多代码。

这种技术不仅仅用于初始化和清理。当您想要更轻松地调用您的函数时，它也很有用（例如，您可以在向导中使用它，以便“下一个”和“上一个”按钮不需要巨大的案例语句来决定要做什么去下一页/上一页。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T01:27:22.543

如果你想要时髦的成语，这里是：

```
//-- the target class
class Resource { 
    def open () { // sensitive operation }
    def close () { // sensitive operation }
    //-- target method
    def doWork() { println "working";} }

//-- the execute around code
def static use (closure) {
    def res = new Resource();
    try { 
        res.open();
        closure(res)
    } finally {
        res.close();
    }
}

//-- using the code
Resource.use { res -> res.doWork(); } 
```

# ajax - 通过 http 流式传输二进制数据

> ID：341975
> 
> 赞同：3
> 
> 时间：2008-12-04T20:37:20.180
> 
> 标签：ajax, http, streaming, comet, multipart-mixed-replace

我正在研究将二进制数据流式传输到浏览器中（通过 http）。我正在寻找有关执行此操作的好方法的意见。最终，我将拥有一个实时数据源，并且我想操纵这些数据并在浏览器中（实时）显示它。Firefox 是第一位的，IE 会很好……但我没那么挑剔。我有一个 Firefox 插件，可以满足我的需要，但我更喜欢用 javascript/html 编写的东西，无需用户安装任何插件即可工作。

我一直在研究 multipart/x-mixed-replace MIME/media 类型，它看起来在这个项目中可能很有用，但我想在我花钱之前听听关于更好的方法（如果有的话）的意见沿着这条路走好几个小时。

Flash 可能会完成这项工作，但我还是想避免使用插件。我想要最简单的解决方案（我们不是吗？），最好只使用 javascript/html。

我也一直在研究彗星，看看它能为我做什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T20:55:26.290

这在很大程度上取决于您要对数据做什么。我假设渲染它。

Flash 可能是最简单的解决方案。这是一个足够常见的附加组件，现在几乎每个人都应该拥有它；所以你不会冒很大的不兼容风险。

JavaScript 还没有被认为是一个很好的二进制数据处理平台——因此，该领域并没有太多的发展。我不认为你会为你想要的东西找到很多帮助。特别是当你得到渲染的时候——除非你可以*将*每个二进制文件转换为[画布脚本](http://en.wikipedia.org/wiki/Canvas_(HTML_element))，因为它是 JavaScript 中唯一可用的动态图像。

IE 实际上可能是个例外，因为您可能可以使用一些 ActiveX 对象来为一些文件类型完成此操作。但是，然后您删除了大多数其他浏览器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T02:53:13.680

As for data streaming and socket style connections you might want to take a look at the [APE (Ajax Push Engine) project](http://www.ape-project.org/). It allows you to set up a HTTP proxy that your JavaScript can connect through for true socket connections.

As for what to do with the data when it arrives, I've done a proof of concept showing how you can work with raw PNG data, parse it and render it to the browser. [Check it out.](http://blog.calyptus.eu/seb/2009/05/png-parser-in-javascript/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-14T10:26:12.633

我以前必须用视频（即运动 jpeg）数据来做这件事。

我注意到您刚刚说的是“二进制数据”……这是不是图像数据？它是什么？

如今，multipart/x-mixed-replace 在很多浏览器中都可以正常工作。我认为它甚至可能在更高版本的 IE 中得到支持。它肯定适用于大约 5 年前我必须实现它的所有版本的 Firefox。可能也支持基于 Webkit 的浏览器，包括 Chrome 和 safari。

但是，在我看来，这实际上只适用于基于 LAN 的应用程序。原因是您要发送大量数据。而不是发送连续帧之间的差异（如果是视频），您每次都会发送整个图像。根据用户的数量，这也可能给服务器带来沉重的带宽负担。

因此，虽然 multipart/x-mixed-replace 是迄今为止最容易实现的，但它不一定是最合适的解决方案。同样，它取决于您的原始数据类型。

对于视频，理论上你可以用 javascript 写一些东西来做。事实上，如果你用谷歌搜索 JavaScript 视频播放器，你可以找到一些。我怀疑它们的速度非常快，并且可能会给客户端机器带来沉重的负担。不过，它似乎确实可行。

所以你的选择是：1）内容类型混合替换 2）下载插件本机浏览器插件（最快最有效）基于 Flash 或 silverlight 3）基于 Javascript 的播放器

如果它是您想要的视频 最后一个选项，它处于最前沿的是 4) 基于 HTML5 的视频。 [http://www.html5video.org/](http://www.html5video.org/) 由于标准仍在批准中并且浏览器支持有限，我现在不推荐它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T21:28:37.890

You can use Base64 to convert the binary to text and send that to the browser. With IE you can convert it directly to binary, but I'm not sure if you can do it with Firefox and others. I did see jscripts for Base64 enflate/deflate and a script named base64.js which probably does the conversion as well.

However, you are probably better off converting the binary data into JSON and using AJAX to transfer the data and then processing it as a javascript object in the browser. The web server would be responsible for acquiring the data and converting it to JSON, so you should be able to process the binary regardless of which programming language you are using.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T22:10:22.067

我通常会避免使用 multipart/x-mixed-replace，因为它具有相当粗略的浏览器支持。我知道我的相机的 multipart/x-mixed-replace 在 IE 或更新版本的 Firefox 上不起作用（尽管显然有一个配置可以改变它）。

我认为小型 Flash 应用程序可能是您的最佳选择之一。

# c# - 无法设置 IHTMLEventObj2::fromElement

> ID：341978
> 
> 赞同：33
> 
> 时间：2008-12-04T20:37:58.413
> 
> 标签：c#, javascript, internet-explorer, mshtml

我正在尝试在 Internet Explorer 扩展中生成合成 Javascript 事件，但我无法让 fromElement 属性保持不变。这是我的代码的摘录：

```
MsHtml.IHTMLDocument4 doc4 = ... // the document object
Object o = null;
MsHtml.IHTMLEventObj2 eObj = 
    (MsHtml.IHTMLEventObj2)doc4.CreateEventObject(ref o);

// string that specifies the from element, e.g. "document.getElementById('id1')":
string locator = ... 
object from = doc4.Script.GetType().InvokeMember("eval", 
                                                 BindingFlags.InvokeMethod, 
                                                 null, 
                                                 doc4.Script, 
                                                 new object[] { locator });

// from now holds a ref to an object that implements the IHTMLElement interface
eObj.fromElement = from;
IHTMLElement el = eObj.fromElement;
// el == null 
```

我在这里做错了什么？eObj.fromElement 应该等于 from，但它似乎没有被设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T09:48:57.860

只是在黑暗中狂野射击，但可能是因为您将“空”对象传递给 CreateEventObject 方法吗？如果你改变这个怎么办：

```
Object o = null; 
```

对此：

```
Object o = new Object(); 
```

在你的例子的第 3 行？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:21:40.090

要找到正确的元素，您应该尝试 IHTMLDocument6 中的 getElementById 方法：http: [//msdn.microsoft.com/en-us/library/cc288667](http://msdn.microsoft.com/en-us/library/cc288667)

# windows - 运行不受信任的第三方软件

> ID：341981
> 
> 赞同：3
> 
> 时间：2008-12-04T20:38:50.333
> 
> 标签：windows, security, virtualization

在运行可能存在恶意的第三方可执行文件时保护系统完整性的最佳方法是什么？

我希望允许程序能够在执行期间存储一些信息供自己使用，但不允许访问网络和设备，当然也不允许访问其他用户的数据和整个系统。

一些限制： 1\. 这需要能够在 Windows 上运行。2\. 我不能限制语言（例如“只使用Java”）。3\. 它需要具有原生或接近原生的性能。4\. 理想情况下，它应该能够作为服务在后台运行。

我可以简单地使用受限权限的 Windows 用户吗？会安全吗？

我必须使用虚拟化环境吗？有免费的吗？

其他想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T20:45:25.840

[Sandboxie](http://www.sandboxie.com/)可能是第一个解决方案。很容易。

设置受限帐户也可以。但是您仍然需要注意一些问题，具体取决于您使用的内容。

虚拟机现在也很快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T20:47:29.580

对我来说，使用 Virtual PC 2007 的虚拟机听起来是个不错的方法 - 它已经免费了一段时间，而且我在过去 4-5 年中大量使用它，没有任何问题

[在这里](http://www.microsoft.com/downloads/details.aspx?FamilyId=04D26402-3199-48A3-AFA2-2DC0B40A73B6&displaylang=en)下载

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T20:46:08.647

虽然对于您所获得的内容来说不是一个完美的解决方案，但我有一些我过去使用过的选项。

1.) 使用虚拟环境。我个人更喜欢使用 VMWare 一段时间（189 美元），因为它运行良好且易于使用。这至少将应用程序隔离到一个测试平台中，您可以使用它来评估它，看看它是否有任何不好的地方。

2.）在vista或其他中使用受限帐户，这至少可以防止它访问关键文件，但是，这不是傻瓜！

**编辑**

如果你真的很害怕，我也会支持建议，不要将虚拟机放在你的网络上。***************