# StackOverflow 问答 000142000-000142999

# javascript - 当javascript在元素上调用提交时，jQuery覆盖表单提交不起作用

> ID：142000
> 
> 赞同：34
> 
> 时间：2008-09-26T21:11:51.687
> 
> 标签：javascript, jquery

我有一个带有提交按钮的普通表单和一些绑定到表单提交事件并使用`e.preventDefault()`并运行 AJAX 命令的 jQuery 的页面。这在单击提交按钮时工作正常，但是当单击链接时`onclick='document.formName.submit();'`，AJAX 表单提交事件处理程序不会捕获该事件。任何想法为什么不或如何在不绑定所有 a 元素的情况下使其工作？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-26T21:31:39.580

几个建议：

*   覆盖提交功能来做你的邪恶竞标

```
 var oldSubmit = form.submit;
    form.submit = function() {
        $(form).trigger("submit");
        oldSubmit.call(form, arguments);
    } 
```

*   为什么不绑定到所有 <a> 标签？然后你不必做任何猴子补丁，它可以很简单（假设所有链接都在表单标签内）：

```
 $("form a").click(function() {
        $(this).parents().filter("form").trigger("submit");
    }); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-26T21:16:02.300

如果您使用 jQuery，您应该通过它自己的[事件机制](http://docs.jquery.com/Events)而不是使用“on”属性（onclick 等）附加事件。它还有自己的事件触发方法，恰当地命名为“[触发器](http://docs.jquery.com/Events/trigger#typedata)”，您应该使用它来激活表单提交事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T21:24:26.103

谢谢伊兰

我正在使用这个事件绑定代码

```
this._form.bind('submit', Delegate.create(this, function(e) {
    e.preventDefault();
    this._searchFadeOut();
    this.__onFormSubmit.invoke(this, new ZD.Core.GenericEventArgs(this._dateField.attr('value')));
}); 
```

但是`onclick`HTML 上有遗留代码，我不想更改它，因为链接太多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-12T19:49:43.937

这对我有用：

制作一个虚拟按钮，隐藏名称为 submit 的真实提交，

进而：

```
$("#mySubmit").click(function(){
    $("#submit").trigger("click"); }); 
```

在您的假人上设置一个事件处理程序以触发单击表单提交按钮。让浏览器弄清楚如何提交表单......这样你就不需要`preventDefault`提交表单，这是麻烦开始的地方。

这似乎解决了这个问题。

# c# - 跨线程操作无效：控件从创建它的线程以外的线程访问

> ID：142003
> 
> 赞同：639
> 
> 时间：2008-09-26T21:12:41.917
> 
> 标签：c#, multithreading, winforms, invoke

我有一个场景。（Windows 窗体、C#、.NET）

1.  有一个主窗体承载一些用户控件。
2.  用户控件执行一些繁重的数据操作，因此如果我直接调用该`UserControl_Load`方法，UI 在加载方法执行期间将变得无响应。
3.  为了克服这个问题，我在不同的线程上加载数据（尝试尽可能少地更改现有代码）
4.  我使用了一个后台工作线程，它将加载数据，完成后将通知应用程序它已完成工作。
5.  现在出现了一个真正的问题。所有 UI（主窗体及其子用户控件）都是在主主线程上创建的。在用户控件的 LOAD 方法中，我根据用户控件上的某些控件（如文本框）的值来获取数据。

伪代码如下所示：

**代码 1**

```
UserContrl1_LoadDataMethod()
{
    if (textbox1.text == "MyName") // This gives exception
    {
        //Load data corresponding to "MyName".
        //Populate a globale variable List<string> which will be binded to grid at some later stage.
    }
} 
```

它给出的例外是

> 跨线程操作无效：控件从创建它的线程以外的线程访问。

要了解更多信息，我做了一些谷歌搜索，并提出了一个建议，例如使用以下代码

**代码 2**

```
UserContrl1_LoadDataMethod()
{
    if (InvokeRequired) // Line #1
    {
        this.Invoke(new MethodInvoker(UserContrl1_LoadDataMethod));
        return;
    }

    if (textbox1.text == "MyName") // Now it wont give an exception
    {
    //Load data correspondin to "MyName"
        //Populate a globale variable List<string> which will be binded to grid at some later stage
    }
} 
```

但是但是但是……看来我又回到了原点。应用程序再次变得无响应。这似乎是由于第 1 行 if 条件的执行。加载任务再次由父线程完成，而不是我产生的第三个。

我不知道我认为这是对还是错。我是线程新手。

我该如何解决这个问题以及执行 Line#1 if block 的效果是什么？

**情况是这样的**：我想根据控件的值将数据加载到全局变量中。我不想从子线程更改控件的值。我永远不会从子线程中执行此操作。

所以只有访问该值，以便可以从数据库中获取相应的数据。

* * *

## 回答 #1

> 赞同：468
> 
> 时间：2008-09-26T21:22:30.303

根据[Prera​​k K 的更新评论](https://stackoverflow.com/questions/142003/cross-thread-operation-not-valid-control-accessed-from-a-thread-other-than-the#142108)（已删除）：

> 我想我没有正确提出这个问题。
> 
> 情况是这样的：我想根据控件的值将数据加载到全局变量中。我不想从子线程更改控件的值。我永远不会从子线程中执行此操作。
> 
> 所以只能访问该值，以便可以从数据库中获取相应的数据。

您想要的解决方案应该如下所示：

```
UserContrl1_LOadDataMethod()
{
    string name = "";
    if(textbox1.InvokeRequired)
    {
        textbox1.Invoke(new MethodInvoker(delegate { name = textbox1.text; }));
    }
    if(name == "MyName")
    {
        // do whatever
    }
} 
```

在尝试切换回控件的线程*之前*，请在单独的线程中进行认真的处理。例如：

```
UserContrl1_LOadDataMethod()
{
    if(textbox1.text=="MyName") //<<======Now it wont give exception**
    {
        //Load data correspondin to "MyName"
        //Populate a globale variable List<string> which will be
        //bound to grid at some later stage
        if(InvokeRequired)
        {
            // after we've done all the processing, 
            this.Invoke(new MethodInvoker(delegate {
                // load the control with the appropriate data
            }));
            return;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：204
> 
> 时间：2013-09-26T08:34:20.010

# UI中的线程模型

请阅读UI 应用程序中的*[线程模型](https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/threading-model)*[（此处为旧 VB 链接](https://msdn.microsoft.com/library/ms741870(v=vs.100).aspx)）以了解基本概念。该链接导航到描述 WPF 线程模型的页面。但是，Windows 窗体使用了相同的想法。

## 用户界面线程

*   只有一个线程（UI 线程）允许访问[System.Windows.Forms.Control](http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.aspx)及其子类成员。
*   尝试从不同于 UI 线程的线程访问[System.Windows.Forms.Control的成员将导致跨线程异常。](http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.aspx)
*   由于只有一个线程，所有 UI 操作都作为工作项排入该线程：

![在此处输入图像描述](https://i.stack.imgur.com/6MtB3.png)

*   如果 UI 线程没有工作，那么就有空闲间隙可供非 UI 相关的计算使用。
*   为了使用提到的差距使用[System.Windows.Forms.Control.Invoke](http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx)或[System.Windows.Forms.Control.BeginInvoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)方法：

![在此处输入图像描述](https://i.stack.imgur.com/WQPOJ.png)

## BeginInvoke 和 Invoke 方法

*   被调用的方法的计算开销和事件处理程序方法的计算开销应该很小，因为那里使用了 UI 线程 - 与负责处理用户输入的线程相同。不管这是[System.Windows.Forms.Control.Invoke](http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx)还是[System.Windows.Forms.Control.BeginInvoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)。
*   要执行计算昂贵的操作，请始终使用单独的线程。由于 .NET 2.0 [BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)致力于在 Windows 窗体中执行计算昂贵的操作。[但是，在新的解决方案中，您应该使用此处](https://stackoverflow.com/a/18033198/2042090)描述的 async-await 模式。
*   仅使用[System.Windows.Forms.Control.Invoke](http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx)或[System.Windows.Forms.Control.BeginInvoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)方法来更新用户界面。如果您将它们用于繁重的计算，您的应用程序将阻塞：

![在此处输入图像描述](https://i.stack.imgur.com/UfBqr.png)

### 调用

*   [System.Windows.Forms.Control.Invoke](http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx)导致单独的线程等待调用的方法完成：

![在此处输入图像描述](https://i.stack.imgur.com/XmFJu.png)

### 开始调用

*   [System.Windows.Forms.Control.BeginInvoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)不会导致单独的线程等待调用的方法完成：

![在此处输入图像描述](https://i.stack.imgur.com/8k5kn.png)

## 代码解决方案

阅读有关[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c). 对于 C# 5.0 和 .NET 4.5，推荐的解决方案在[这里](https://stackoverflow.com/a/18033198/2042090)。

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2008-09-26T21:21:09.683

您只想使用`Invoke`或`BeginInvoke`完成更改 UI 所需的最少工作。您的“重”方法应该在另一个线程上执行（例如 via `BackgroundWorker`），然后使用`Control.Invoke`/`Control.BeginInvoke`只是为了更新 UI。这样你的 UI 线程就可以自由地处理 UI 事件等。

有关[WinForms 示例](http://pobox.com/~skeet/csharp/threads/winforms.shtml)，请参阅我的[线程文章](http://pobox.com/~skeet/csharp/threads)- 尽管该文章是在到达现场之前编写的，但恐怕我还没有在这方面对其进行更新。只是稍微简化了回调。`BackgroundWorker``BackgroundWorker`

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2017-10-17T11:55:28.360

我知道现在为时已晚。但是即使在今天，如果您无法访问跨线程控件？这是迄今为止最短的答案：P

```
Invoke(new Action(() =>
                {
                    label1.Text = "WooHoo!!!";
                })); 
```

这就是我从线程访问任何表单控件的方式。

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2009-01-13T02:13:35.057

我遇到过这个问题，`FileSystemWatcher`发现下面的代码解决了这个问题：

`fsw.SynchronizingObject = this`

然后控件使用当前表单对象来处理事件，因此将在同一个线程上。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2016-05-02T13:42:54.123

我发现需要在与表单相关的所有方法中乱扔的检查和调用代码过于冗长且不需要。这是一个简单的扩展方法，可让您完全取消它：

```
public static class Extensions
{
    public static void Invoke<TControlType>(this TControlType control, Action<TControlType> del) 
        where TControlType : Control
        {
            if (control.InvokeRequired)
                control.Invoke(new Action(() => del(control)));
            else
                del(control);
    }
} 
```

然后你可以简单地这样做：

```
textbox1.Invoke(t => t.Text = "A"); 
```

没有更多的混乱 - 简单。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2008-09-26T21:19:43.897

.NET 中的控件通常不是线程安全的。这意味着您不应该从它所在的线程以外的线程访问控件。为了解决这个问题，您需要*调用*控件，这是您的第二个示例正在尝试的。

但是，在您的情况下，您所做的只是将长时间运行的方法传递回主线程。当然，这并不是你真正想要做的。您需要重新考虑一下，以便您在主线程上所做的一切都是在这里和那里设置一个快速属性。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-04-27T05:18:06.263

UI 跨线程问题的最简洁（也是正确）的解决方案是使用 SynchronizationContext，请参阅[Synchronizing calls to UI in a multi-threaded application](http://www.lostechies.com/blogs/gabrielschenker/archive/2009/01/23/synchronizing-calls-to-the-ui-in-a-multi-threaded-application.aspx) article，它很好地解释了它。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2016-05-06T16:49:44.323

按照最简单的（在我看来）方法从另一个线程修改对象：

```
using System.Threading.Tasks;
using System.Threading;

namespace TESTE
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Action<string> DelegateTeste_ModifyText = THREAD_MOD;
            Invoke(DelegateTeste_ModifyText, "MODIFY BY THREAD");
        }

        private void THREAD_MOD(string teste)
        {
            textBox1.Text = teste;
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2016-05-16T01:55:29.513

使用 Async/Await 和回调的新外观。如果您在项目中保留扩展方法，则只需要一行代码。

```
/// <summary>
/// A new way to use Tasks for Asynchronous calls
/// </summary>
public class Example
{
    /// <summary>
    /// No more delegates, background workers etc. just one line of code as shown below
    /// Note it is dependent on the XTask class shown next.
    /// </summary>
    public async void ExampleMethod()
    {
        //Still on GUI/Original Thread here
        //Do your updates before the next line of code
        await XTask.RunAsync(() =>
        {
            //Running an asynchronous task here
            //Cannot update GUI Thread here, but can do lots of work
        });
        //Can update GUI/Original thread on this line
    }
}

/// <summary>
/// A class containing extension methods for the Task class 
/// Put this file in folder named Extensions
/// Use prefix of X for the class it Extends
/// </summary>
public static class XTask
{
    /// <summary>
    /// RunAsync is an extension method that encapsulates the Task.Run using a callback
    /// </summary>
    /// <param name="Code">The caller is called back on the new Task (on a different thread)</param>
    /// <returns></returns>
    public async static Task RunAsync(Action Code)
    {
        await Task.Run(() =>
        {
            Code();
        });
        return;
    }
} 
```

您可以在 Extension 方法中添加其他内容，例如将其包装在 Try/Catch 语句中，允许调用者告诉它在完成后返回什么类型，对调用者的异常回调：

**添加 Try Catch、自动异常记录和回调**

```
 /// <summary>
    /// Run Async
    /// </summary>
    /// <typeparam name="T">The type to return</typeparam>
    /// <param name="Code">The callback to the code</param>
    /// <param name="Error">The handled and logged exception if one occurs</param>
    /// <returns>The type expected as a competed task</returns>

    public async static Task<T> RunAsync<T>(Func<string,T> Code, Action<Exception> Error)
    {
       var done =  await Task<T>.Run(() =>
        {
            T result = default(T);
            try
            {
               result = Code("Code Here");
            }
            catch (Exception ex)
            {
                Console.WriteLine("Unhandled Exception: " + ex.Message);
                Console.WriteLine(ex.StackTrace);
                Error(ex);
            }
            return result;

        });
        return done;
    }
    public async void HowToUse()
    {
       //We now inject the type we want the async routine to return!
       var result =  await RunAsync<bool>((code) => {
           //write code here, all exceptions are logged via the wrapped try catch.
           //return what is needed
           return someBoolValue;
       }, 
       error => {

          //exceptions are already handled but are sent back here for further processing
       });
        if (result)
        {
            //we can now process the result because the code above awaited for the completion before
            //moving to this statement
        }
    } 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2017-05-10T11:02:53.510

这不是解决此错误的推荐方法，但您可以快速抑制它，它会完成工作。对于原型或演示，我更喜欢这个。添加

```
CheckForIllegalCrossThreadCalls = false 
```

在`Form1()`构造函数中。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2008-09-26T21:41:02.053

您需要查看 Backgroundworker 示例： http:
[//msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx) 特别是它如何与 UI 层交互。根据您的帖子，这似乎可以回答您的问题。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2013-09-11T18:29:57.813

在 xamarin stuidio 之外的 Visual Studio winforms 原型项目中编写 iOS-Phone 单点触控应用程序控制器时，我发现需要这样做。我更喜欢在 VS 中编程而不是 xamarin studio，我希望控制器与手机框架完全解耦。这种方式为其他框架（如 Android 和 Windows Phone）实现这一点对于未来的使用会更容易。

我想要一个解决方案，其中 GUI 可以响应事件，而无需处理每次按钮单击背后的跨线程切换代码。基本上让类控制器处理以保持客户端代码简单。你可能在 GUI 上有很多事件，好像你可以在课堂上的一个地方处理它会更干净。我不是多线程专家，如果这有缺陷，请告诉我。

```
public partial class Form1 : Form
{
    private ExampleController.MyController controller;

    public Form1()
    {          
        InitializeComponent();
        controller = new ExampleController.MyController((ISynchronizeInvoke) this);
        controller.Finished += controller_Finished;
    }

    void controller_Finished(string returnValue)
    {
        label1.Text = returnValue; 
    }

    private void button1_Click(object sender, EventArgs e)
    {
        controller.SubmitTask("Do It");
    }
} 
```

GUI 表单不知道控制器正在运行异步任务。

```
public delegate void FinishedTasksHandler(string returnValue);

public class MyController
{
    private ISynchronizeInvoke _syn; 
    public MyController(ISynchronizeInvoke syn) {  _syn = syn; } 
    public event FinishedTasksHandler Finished; 

    public void SubmitTask(string someValue)
    {
        System.Threading.ThreadPool.QueueUserWorkItem(state => submitTask(someValue));
    }

    private void submitTask(string someValue)
    {
        someValue = someValue + " " + DateTime.Now.ToString();
        System.Threading.Thread.Sleep(5000);
//Finished(someValue); This causes cross threading error if called like this.

        if (Finished != null)
        {
            if (_syn.InvokeRequired)
            {
                _syn.Invoke(Finished, new object[] { someValue });
            }
            else
            {
                Finished(someValue);
            }
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2012-05-24T22:49:15.387

如果您正在使用的对象没有，这是另一种方法

```
(InvokeRequired) 
```

如果您正在使用主窗体以外的类中的主窗体，并且使用主窗体中的对象但没有 InvokeRequired，这将很有用

```
delegate void updateMainFormObject(FormObjectType objectWithoutInvoke, string text);

private void updateFormObjectType(FormObjectType objectWithoutInvoke, string text)
{
    MainForm.Invoke(new updateMainFormObject(UpdateObject), objectWithoutInvoke, text);
}

public void UpdateObject(ToolStripStatusLabel objectWithoutInvoke, string text)
{
    objectWithoutInvoke.Text = text;
} 
```

它的工作原理与上面相同，但如果您没有带有 invokerequired 的对象，但可以访问 MainForm，则它是一种不同的方法

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2014-02-05T12:06:47.483

例如从 UI 线程的 Control 中获取文本：

```
Private Delegate Function GetControlTextInvoker(ByVal ctl As Control) As String

Private Function GetControlText(ByVal ctl As Control) As String
    Dim text As String

    If ctl.InvokeRequired Then
        text = CStr(ctl.Invoke(
            New GetControlTextInvoker(AddressOf GetControlText), ctl))
    Else
        text = ctl.Text
    End If

    Return text
End Function 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2014-10-22T11:29:44.887

与先前的答案相同，但添加了一个非常简短的内容，允许使用所有 Control 属性而不会出现跨线程调用异常。

**辅助方法**

```
/// <summary>
/// Helper method to determin if invoke required, if so will rerun method on correct thread.
/// if not do nothing.
/// </summary>
/// <param name="c">Control that might require invoking</param>
/// <param name="a">action to preform on control thread if so.</param>
/// <returns>true if invoke required</returns>
public bool ControlInvokeRequired(Control c, Action a)
{
    if (c.InvokeRequired) c.Invoke(new MethodInvoker(delegate
    {
        a();
    }));
    else return false;

    return true;
} 
```

**示例使用**

```
// usage on textbox
public void UpdateTextBox1(String text)
{
    //Check if invoke requied if so return - as i will be recalled in correct thread
    if (ControlInvokeRequired(textBox1, () => UpdateTextBox1(text))) return;
    textBox1.Text = ellapsed;
}

//Or any control
public void UpdateControl(Color c, String s)
{
    //Check if invoke requied if so return - as i will be recalled in correct thread
    if (ControlInvokeRequired(myControl, () => UpdateControl(c, s))) return;
    myControl.Text = s;
    myControl.BackColor = c;
} 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2017-11-02T22:20:46.623

```
this.Invoke(new MethodInvoker(delegate
            {
                //your code here;
            })); 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2020-05-08T18:44:09.587

解决此问题的简单且可重复使用的方法。

**扩展方法**

```
public static class FormExts
{
    public static void LoadOnUI(this Form frm, Action action)
    {
        if (frm.InvokeRequired) frm.Invoke(action);
        else action.Invoke();
    }
} 
```

**示例使用**

```
private void OnAnyEvent(object sender, EventArgs args)
{
    this.LoadOnUI(() =>
    {
        label1.Text = "";
        button1.Text = "";
    });
} 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2017-03-25T04:50:11.867

[同样的问题：how-to-update-the-gui-from-another-thread-in-c](https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c)

两种方式：

1.  在 e.result 中返回值并使用它在 backgroundWorker_RunWorkerCompleted 事件中设置您的文本框值

2.  声明一些变量以将这些类型的值保存在一个单独的类中（它将作为数据持有者）。创建此类的静态实例，您可以通过任何线程访问它。

例子：

```
public  class data_holder_for_controls
{
    //it will hold value for your label
    public  string status = string.Empty;
}

class Demo
{
    public static  data_holder_for_controls d1 = new data_holder_for_controls();
    static void Main(string[] args)
    {
        ThreadStart ts = new ThreadStart(perform_logic);
        Thread t1 = new Thread(ts);
        t1.Start();
        t1.Join();
        //your_label.Text=d1.status; --- can access it from any thread 
    }

    public static void perform_logic()
    {
        //put some code here in this function
        for (int i = 0; i < 10; i++)
        {
            //statements here
        }
        //set result in status variable
        d1.status = "Task done";
    }
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2019-04-28T20:56:53.587

只需使用这个：

```
this.Invoke((MethodInvoker)delegate
            {
                YourControl.Property= value; // runs thread safe
            }); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-12-17T06:40:25.737

行动 y; //在类中声明

label1.Invoke(y=()=>label1.Text="text");

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2022-02-27T12:38:39.560

我知道我迟到了，但我想有一个简单的解决方案可以解决这个问题。可能，这对其他人有帮助。

您可以编写:`CheckforIllegalCrossThreadCalls`并将其值设置为`False`. 您需要在主页的构造函数中编写它。

参考这个：

[![在此处输入图像描述](https://i.stack.imgur.com/RcZRY.png)](https://i.stack.imgur.com/RcZRY.png)

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2018-04-03T09:04:36.483

跨线程操作有两种选择。

```
Control.InvokeRequired Property 
```

第二个是使用

```
SynchronizationContext Post Method 
```

Control.InvokeRequired 仅在从 Control 类继承的工作控件时有用，而 SynchronizationContext 可以在任何地方使用。一些有用的信息如下链接

[跨线程更新 UI | 。网](http://www.ilmlinks.com/Snippets/cross-thread-update-ui-in-dotnet)

[使用 SynchronizationContext 的跨线程更新 UI | 。网](http://www.ilmlinks.com/Snippets/cross-thread-update-ui-in-dotnet-synchronization-context)

# sql-server - Management Studio 中基于服务器的语法高亮显示

> ID：142005
> 
> 赞同：1
> 
> 时间：2008-09-26T21:13:04.943
> 
> 标签：sql-server

为什么 SQL Server Management Studio 中的某些关键字以蓝色突出显示，而另一些则以灰色突出显示？

为什么 UNION 关键字在连接到 SQL Server 2000 数据库时突出显示为灰色，但在连接到 SQL Server 2005 数据库时突出显示为蓝色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T21:22:53.547

它们是保留字。我们的生产数据库中有一个名为 Order 的表（在我开始之前！），这很烦人。

编辑：

对不起，误会你了。蓝色 = 关键字，灰色 = 运算符。colpurs 的完整列表：http: [//www.informit.com/guides/content.aspx?](http://www.informit.com/guides/content.aspx?g=sqlserver&seqNum=177) g=sqlserver&seqNum=177大约一半。

# sysadmin - 强制 Samba 进程关闭文件

> ID：142007
> 
> 赞同：5
> 
> 时间：2008-09-26T21:13:53.867
> 
> 标签：sysadmin, samba

有没有办法强制 Samba 进程关闭给定文件而不杀死它？

Samba 为每个客户端连接打开一个进程，有时我看到它保存打开文件的时间比需要的长得多。通常我只是杀死该进程，（Windows）客户端将在下次访问共享时重新打开它；但有时它会长时间主动读取其他文件，我只想“杀死”一个文件，而不是整个连接。

编辑：我试过'net rpc file close'，但似乎不起作用。有人知道为什么吗？

编辑：[这](http://www.nabble.com/Fw:-Files-left-open-td5578614.html)是我发现的类似的最好的提及。这似乎是 win32 客户端的问题，微软服务器有一个解决方法；但桑巴没有。我希望该`net rpc file close <fileid>`命令有效，我将继续尝试找出原因。我接受了 LuckyLindy 的回答，即使它没有解决问题，因为这是在这种情况下唯一有用的程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T03:34:28.620

这种情况在我们的系统上经常发生，尤其是从 Win98 机器连接到 Samba 时。我们按照以下步骤来解决它（可能与您的相似）：

*   查看哪台计算机正在使用该文件（即`lsof|grep -i <file_name>`）
*   尝试从有问题的计算机打开该文件，或查看是否有进程隐藏在我们可以关闭的任务管理器中
*   如果运气不好，让用户退出任何重要的网络程序
*   从linux杀死用户的Samba进程（即`kill -9 <pid>`）

我希望有更好的方法！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T07:50:06.430

我正在创建一个新答案，因为我的第一个答案实际上只包含更多问题，而且真的没有太多帮助。

经过一番搜索，我没有找到任何当前 Samba 最新版本的开放错误，请查看[Samba 错误报告](http://samba.org/samba/bugreports.html)网站，并创建一个新错误。这是让某人就如何修复它提出建议并让开发人员查看问题的最简单方法。LuckyLindy 在我之前的回答中留下了一条评论，说这已经是 5 年了，该项目是开源的，是通过报告或提供补丁来修复错误的最佳方式。

我还发现了一个邮件列表条目：[Samba Open files](http://lists.samba.org/archive/samba/2006-July/122981.html)，他们建议添加`posix locking=no`到配置文件中，只要您没有通过 NFS 分发的文件不锁定文件应该没问题，也就是说，如果文件是被锁住。

如果你也想要，你可以编写一个使用 ptrace 并附加到程序的程序，它会遍历并解锁和关闭所有文件。但是，请注意，这可能会使 Samba 处于未知状态，这可能更危险。

我已经提到的解决方法是定期重新启动 samba 作为解决方法。我知道这不是一个解决方案，但它可能会暂时起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T20:21:59.333

这可能在这里得到了回答：[How to close a file descriptor from another process in unix systems](https://stackoverflow.com/questions/323146/how-to-close-a-file-descriptor-from-another-process-in-unix-systems)

猜测一下，“net rpc file close”可能不起作用，因为告诉 Samba 关闭文件的进程间通信最终不会被查看，直到您要关闭的文件被读取完毕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T21:18:31.280

如果 samba 中没有显式选项，则不可能使用标准 unix 接口从外部关闭打开的文件描述符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T22:41:33.887

一般来说，您不能从外部干预进程文件描述符。然而，作为 root，您当然可以这样做，正如您在 1997 年的那篇 phrack 文章中看到的那样：[http](http://www.phrack.org/issues.html?issue=51&id=5#article) ://www.phrack.org/issues.html?issue=51&id=5#article - 我不建议在生产系统虽然...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T11:07:51.330

在这种情况下，更好的问题是为什么？为什么要提前关闭文件？它最终关闭文件的目的是什么？你试图完成什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-28T15:23:37.137

Samba 提供了查看打开文件和关闭它们的命令。

列出所有打开的文件：

net rpc 文件 -U *ADadmin* %*密码*

将*ADadmin*和*密码*替换为 Windows AD 域管理员的凭据。这会为您提供文件 ID、打开文件的用户名、锁定状态和文件名。您经常希望通过 grep 管道来过滤结果。

找到要关闭的文件后，复制其文件 ID 号并使用以下命令：

net rpc 文件关闭*fileid* -U *ADadmin* %*密码*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-05T09:29:22.420

我需要完成这样的事情，以便我可以轻松卸载我碰巧共享的设备。我写了这个快速的 bash 脚本：

```
#!/bin/bash
PIDS_TO_CLOSE=$(smbstatus -L | tail -n-3 | grep "$1" | cut -d' ' -f1 - | sort -u | sed '/^$/$
for PID in $PIDS_TO_CLOSE; do
    kill $PID
done 
```

它需要一个参数，关闭路径：

```
smbclose /media/drive 
```

任何与该参数匹配的路径（通过 grep）都已关闭，因此您应该非常具体地使用它。（只有通过 samba 打开的文件会受到影响。）显然，您需要 root 才能关闭其他用户打开的文件，但它适用于您打开的文件。请注意，与文件的任何其他强制关闭一样，可能会发生数据损坏。只要文件处于非活动状态，就应该没问题。

它非常难看，但对于我的用例（关闭整个挂载点）来说，它工作得很好。

# xml - XPath 可以跨 XML 的两个子树进行外键查找吗？

> ID：142010
> 
> 赞同：4
> 
> 时间：2008-09-26T21:14:21.993
> 
> 标签：xml, xslt, xpath, subtree, xslkey

假设我有以下 XML ......

```
<root>
  <base>
    <tent key="1" color="red"/>
    <tent key="2" color="yellow"/>
    <tent key="3" color="blue"/>
  </base>
  <bucket>
    <tent key="1"/>
    <tent key="3"/>
  </bucket>
</root> 
```

...返回“桶”包含“红色”和“蓝色”的 XPath 是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T21:19:35.683

如果您使用的是 XSLT，我建议您设置一个密钥：

```
<xsl:key name="tents" match="base/tent" use="@key" /> 
```

然后，您可以使用特定的方法获得`<tent>`内部`<base>``key`

```
key('tents', $id) 
```

然后你可以做

```
key('tents', /root/bucket/tent/@key)/@color 
```

或者，如果`$bucket`是特定`<bucket>`元素，

```
key('tents', $bucket/tent/@key)/@color 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T21:21:51.583

我认为这会起作用：

```
/root/base/tent[/root/bucket/tent/@key = @key ]/@color 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T01:31:25.523

这不漂亮。与任何查找一样，您需要使用 current()：

/root/bucket[/root/base/tent[@key = current()/tent/@key]/@color = 'blue' 或 /root/base/tent[@key = current()/tent/@key ]/@color = '红色']

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T21:23:14.050

JeniT 在此处列出了适当的响应/代码。您需要在遍历 XML 文档之前创建密钥，然后针对该密钥执行匹配。

# sql - SSIS推荐的学习材料是什么？

> ID：142015
> 
> 赞同：11
> 
> 时间：2008-09-26T21:15:14.207
> 
> 标签：sql, sql-server, ssis

好的，您不需要成为专家，但如果您碰巧对 SSIS 有很好的工作知识，并且您使用了一些网络上的教程来帮助您到达那里，那么请分享它们。我一直在努力寻找一些可靠的东西（也许是截屏视频），但我很难过。

任何可靠的链接将不胜感激，我将在最后以汇总格式将它们添加到此问题中。谢谢你。

到目前为止，我们有：

[http://blogs.conchango.com/jamiethomson](http://blogs.conchango.com/jamiethomson)

[http://sqlis.com](http://sqlis.com)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-26T21:17:42.217

[http://blogs.conchango.com/jamiethomson](http://blogs.conchango.com/jamiethomson) / 一个非常非常好的起点，

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T09:46:26.160

我会推荐[Marcin Policht 的优秀系列文章](http://www.databasejournal.com/article.php/1503191)

目前大约有 50 篇文章，每篇文章都关注 SSIS 的不同方面，它们非常详细，我发现它们是关于 SSIS 主题的极好信息来源

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-26T21:19:20.497

除了 Cochango（很棒的博客顺便说一句！）之外，另一个很棒的资源是[http://www.sqlis.com/](http://www.sqlis.com/)

我还发现这两本书很有帮助：

[Microsoft SQL Server 2005 集成服务](https://rads.stackoverflow.com/amzn/click/com/0672327813)

[专家 SQL Server 2005 集成服务](https://rads.stackoverflow.com/amzn/click/com/0470134119)

我按照上面列出的顺序阅读它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-26T21:35:01.303

这些链接主要是组件，但它们也有很好的信息资源。

[http://www.sqlbi.com/](http://www.sqlbi.com/) - 一些用于数据仓库 BI 的出色 SSIS 组件 [http://www.konesans.com/products.aspx](http://www.konesans.com/products.aspx) - 一些更有用的组件

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-01T12:10:09.787

当前的 Jamie Thomson 博客位于此处，他继续在此处撰写有关 ETL 的内容：

[http://sqlblog.com/blogs/jamie_thomson/](http://sqlblog.com/blogs/jamie_thomson/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-12T19:34:41.633

SSIS 初学者教程：http: [//msdn.microsoft.com/en-us/library/ms169917.aspx](http://msdn.microsoft.com/en-us/library/ms169917.aspx)

BI Monkey 有一些很好的例子： http: [//www.bimonkey.com/](http://www.bimonkey.com/)

SSIS 团队博客：http: [//blogs.msdn.com/b/mattm/](http://blogs.msdn.com/b/mattm/)

# c++ - C/C++ 结构偏移

> ID：142016
> 
> 赞同：38
> 
> 时间：2008-09-26T21:15:16.373
> 
> 标签：c++, c, oop

我正在寻找一段代码，它可以告诉我结构中字段的偏移量，而无需分配结构的实例。

IE：给定

```
struct mstct {
    int myfield;
    int myfield2;
}; 
```

我可以写：

```
mstct thing;
printf("offset %lu\n", (unsigned long)(&thing.myfield2 - &thing)); 
```

并获取`offset 4`输出。`mstct thing`如果没有该声明/分配一个，我该怎么做？

我知道它`&<struct>`并不总是指向结构的第一个字段的第一个字节，我可以稍后解释。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-09-26T21:16:04.687

标准的 offsetof() 宏（在 stddef.h 中）怎么样？

编辑：对于由于某种原因可能没有可用的 offsetof() 宏的人，您可以使用以下方法获得效果：

```
#define OFFSETOF(type, field)    ((unsigned long) &(((type *) 0)->field)) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-26T21:19:11.793

对，使用`offsetof`宏，它（至少在 GNU CC 中）可用于 C 和 C++ 代码：

```
offsetof(struct mstct, myfield2) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-26T21:19:38.797

printf("偏移量: %d\n", &((mstct*)0)->myfield2);

# asp.net - 经典 ASP 是否仍然是新项目的替代不利其他语言？

> ID：142041
> 
> 赞同：2
> 
> 时间：2008-09-26T21:18:14.963
> 
> 标签：asp.net, asp-classic

有很多网站仍在使用经典的 ASP 而不是 ASP.NET，但这不是问题 - “永远不要更改正在运行的项目”。

问题是它是否仍然是作为新 Web 项目基础的首选，还是值得切换到 ASP.NET？你会推荐一个经典的 ASP 程序员另一种语言来切换吗？自经典 ASP 首次发布以来，它没有一次更新，但许多公司仍在将其用于新项目。当之无愧？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-26T21:32:21.370

虽然我个人永远不会愿意选择创建另一个 ASP 项目而不是 ASP.NET 项目，但这样做的最大原因是“技能集”。我肯定会推荐一个 ASP 开发者来选择 ASP.NET，但是如果有一个“现在”需要的项目，就按照你所知道的去做。然后在你有***另一个***项目之前学习 ASP.NET。:)

ASP.NET 对 ASP 有许多改进，但我们（以前的经典 ASP 开发人员社区）使用经典 ASP 创建了许多优秀的应用程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-26T21:20:54.097

在我看来，与 ASP.NET Webforms 或 ASP.NET MVC 相比，绝对没有理由使用经典 ASP。

**除非**您需要与现有的经典 ASP 应用程序集成，因为有些东西（特别是会话）在应用程序边界之间不兼容，从而导致创造性的变通方法（在您的 localhost 上运行的 Web 服务......糟糕）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-27T05:10:57.353

来自经典的 ASP 背景，我也有同样的问题。3-4 年前，我走上了转向 ASP.NET/VB 的路线。我可以告诉你，从 ASP/VBScript 到 ASP.NET/VB 的交叉几乎没有。实际上，在最初的几个月（更像是第一年！），我对整个 .NET 平台感到非常沮丧，并不断回滚到经典的 ASP。

从长远来看，我最终还是从头开始学习了 ASP.NET/C#。奇怪的是，我觉得 C# 的语法更自然，尽管我的背景是 VBScript！

对于常规的 Web 开发，ASP.NET 就像使用大锤，而一个简单的 ping 锤就可以了。但是，.NET 平台背后的强大功能使其在您的 Web 经常与其他应用程序混在一起的企业环境中发挥着不可估量的作用。

鉴于我现在所知道的，我可能会转向 PHP。不仅编程风格相似，而且 PHP 确实致力于 Web。然而，很容易迷失在 .NET 平台提供的海量信息中。最近，新的 .NET 技术出现的速度可能而且已经变得势不可挡。

直接回答您的问题：如果您停留在 Web 开发领域，那么我建议您在新项目中仔细研究 PHP。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-26T21:48:58.290

我很难推荐在新项目中使用“经典”ASP，但是，与任何新项目一样 - 它应该始终选择最适合工作的工具，而不是使用“工具 X”，只是因为它是：

*   较新
*   更好的
*   “最新消息”

例如，如果“X 公司”（一家拥有 20 名员工的小公司）需要一个新的内部网 Web 应用程序来记录假期/休假请求，而内部网服务器是一个老化的 NT4 机器，那么经典 ASP 将是去。我会建议他们升级到可以处理支持的服务器操作系统（例如 Win2k3）的较新机器，但很可能是他们根本没有预算/需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-27T14:42:45.577

在我看来，对于现有项目，除非您必须进行一些根本性的更改/添加，否则无法切换到另一种语言。重新编程非常耗时，您的客户通常不会为此付费。

毫无疑问，PHP 在我眼中是一种不错的网络语言。但我不会将它用于非常大的项目，因为它没有预编译，这可以很好地加速（*我的经验*）。但是几年前我离开了 PHP-Development，也许现在对此有一些很好的改进。此外，我不会在 IIS 上运行 PHP，也不会在 Windows 服务器上运行 Apache。因此，当您的整个服务器设备基于 Windows 时，您将不得不使用 linux/apache/php 设置新服务器 - 客户不会为您的公司支付更多成本。

我同意大多数答案，没有充分的理由永远使用经典的 asp 来进行新项目，应该制定计划转换到另一种语言。我们目前仍然使用经典的 ASP 编写大多数新项目，因为我们有很多自制的库可以与我们的 CMS 等一起使用，我们必须用 .NET/C# 重写它们。还必须建立一些新的编码约定（*例如，如何制作导航、文件夹结构……*），所以我们正在与 .NET 中的示例项目一起工作，完成后我们只会做一些小的改动到现有项目，直到我们有机会通过客户的另一项任务至少部分赎回重写。

这是一个缓慢的过程，但我相信它迟早必须完成。（而且我也是 .NET-Framework 的忠实粉丝！:-)）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T03:46:26.120

您可能会考虑查看ASP classic 和 ASP.NET 之间的[一些差异。](http://www.beansoftware.com/ASP.NET-Tutorials/Classic-ASP-vs-ASP.NET.aspx)过去必须同时维护这两者，我可以告诉您，在 .NET 与 ASP Classic 中进行开发有很多乐趣。过渡到任何流行的网络语言（PHP、ASP.NET、Ruby、Python）都是值得的，只要意识到 ASP Classic 缺乏的地方。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-26T21:23:32.500

我认为现在是切换到 Asp.net 的时候了。更好的 asp.net 面向对象方式肯定会帮助您减少代码管理的噩梦。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-26T21:30:08.663

对于任何剩余的 ASP 坚持，我实际上建议跳船到 PHP。它更像 ASP 而不是 ASP.NET，而且其中不乏新的工作。

话虽如此，我本人非常喜欢 ASP.NET（MVC 和 WebForms）——但是，我在 7 年前离开了 ASP 开发。;)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-01T03:35:43.943

就像另一张海报提到的那样，员工的技能组合将是决定因素。

如果它是一个经典的 ASP 商店，并且必须尽快完成某些事情（什么不是，对吗？），那么可能很难说服管理层需要 .NET，尤其是在它影响时间线的情况下。这就是为一次性项目添加一些 .NET 页面派上用场的地方，因为它可以让开发团队熟悉该语言并决定何时从 Classic ASP 切换到 .NET。

展望未来，重要的是要记住，虽然 Classic ASP 仍然运行良好，但它不会去任何地方，您不能指望未来对语言/工具的任何更新/更改。

*话虽*如此，根据我的经验，我发现 jQuery/Ajax/DOM 脚本为经典 ASP 页面注入了新的活力，并添加了一些我的客户希望在他们的网站上看到的“花哨/酷”的东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T17:52:54.983

我不会用经典的 asp 编写新的应用程序/网站。为什么？几个原因：

1）MS不再修复经典的asp错误，最终支持将不复存在，它必须这样做。2) .net 在性能方面要快得多 3) .net 有很多有用的扩展（例如 AJAX） 4) 技能集 - 在考虑一项技术时，您必须确保将来可以找到可以轻松维护它的人

.net 已经存在了一段时间并且已经过测试，因此对于新项目来说，切换是安全的（并且推荐）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-26T21:28:35.217

好吧，老实说，我不会...使用 asp .net，您可以利用 .net 框架和面向对象的编程...仅此一项就足以让我使用 asp .net 而不是经典的 asp...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-02T14:24:36.980

我们的团队曾两次被要求显着“升级”一个经典的 ASP 站点，在这两种情况下，这都是一场噩梦，我们在 ASP.Net 中转换/重新编写了它。我知道“不要重写正在工作的东西”的口头禅，但知道我们或其他人将不得不继续维护代码库并看到 ASP 代码的维护是多么*糟糕*，我们决定彻底决裂。

仅出于这个原因，我认为在经典 ASP 中编写任何其他内容都没有什么可推荐的。如果 ASP.Net 不是一个选项，我会选择 PHP 或 Ruby。

# ruby-on-rails - 使用 Rails XMLBuilder 创建 xml-stylesheet PI

> ID：142042
> 
> 赞同：0
> 
> 时间：2008-09-26T21:18:17.443
> 
> 标签：ruby-on-rails, xml, ruby

我想将 xslt 样式表附加到使用 XMLBuilder 构建的 XML 文档中。这是通过看起来像的处理指令完成的

```
<?xml-stylesheet type='text/xsl' href='/stylesheets/style.xslt' ?> 
```

通常，我会使用该`instruct!`方法，但`:xml-stylesheet`它不是有效的 Ruby 符号。

XMLBuilder 为这种情况下的元素使用`tag!`方法提供了解决方案，但我没有看到处理指令的等价物。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-26T21:41:14.063

你这样做：

```
xm.instruct! 'xml-stylesheet', {:href=>'/stylesheets/style.xslt', :type=>'text/xsl'} 
```

只需在之后添加该行

```
xm.instruct! :xml, {:encoding=>"your_encoding_type"} 
```

在您的文档输出代码的其余部分之前，您应该一切顺利。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T21:25:57.690

我不确定这会解决您的问题，因为我不知道指示！该对象的方法，但 :'xml-stylesheet' 是有效的红宝石符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-30T15:04:09.673

如果使用[`atom_feed`](http://api.rubyonrails.org/classes/ActionView/Helpers/AtomFeedHelper.html#method-i-atom_feed)帮助程序，您可以在`instruct`选项中传递它：

```
atom_feed(instruct: {
    'xml-stylesheet' => {type: 'text/xsl', href: 'styles.xml'}
  }) do |feed|
  feed.title "My Atom Feed"
  # entries...
end 
```

结果（仅显示前 3 行）：

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="styles.xml"?>
<feed xml:lang="en-US" xmlns="http://www.w3.org/2005/Atom"> 
```

# xml - xsl:import 或 xsl:include 的相对路径

> ID：142058
> 
> 赞同：6
> 
> 时间：2008-09-26T21:20:35.020
> 
> 标签：xml, xslt, vbscript, client-side

我正在尝试使用 VBScript 对 XML 对象进行 XSLT 转换。
我正在翻译的 XSL 文件包含该`<xsl:import href="script.xsl"/>`指令。如果我使用绝对 URL ( `http://localhost/mysite/script.xsl`)，它可以很好地导入样式表；但是，如果我使用相对路径 ( `script.xsl`)，它会报告“找不到资源”。我需要能够在一组机器之间移植它，所以我需要能够使用相对 URI。有什么建议么？

笔记：

*   VBScript 文件位于`http://localhost/myscript.asp`
*   第一个 XSL 文件位于`http://localhost/mysite/styles.xsl`
*   第二个 XSL 文件位于`http://localhost/mysite/script.xsl`
*   使用相对路径`mysite/script.xsl`也不起作用

附录：

谢谢大家，您的回答。我越深入研究这样做的代码，它就越陌生。`myscript.asp`是一个相当不寻常的代码编译。发生的情况是作为 XML 块 ( )`styles.xsl`包含在 HTML 输出中，然后在客户端使用 VBScript 将该块作为样式表加载。然后使用此样式表转换通过 XMLHTTP 检索的 XML 块。所以问题是客户端的 HTML 的上下文与位置无关。`myscript.asp``<xml src=...>``styles.xsl``script.xsl`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T02:07:58.540

xsl:import、xsl:include 和 document() 函数的当前目录是包含使用它们的转换的目录。因此，您所说的 xsl:import 指令应该可以正常工作。

我唯一能想到的可能会影响这一点：如果您使用相对路径，则文件将直接从文件系统中读取，而如果您使用绝对 URI，则将从 Web 服务器中检索文件。是否有一些安全设置阻止脚本读取此目录中的文件？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T20:36:12.063

@Jon我认为你很接近......但不应该......

```
<xsl:import href="/mysite/script.xsl"/> 
```

...带前导斜线？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T20:56:58.237

我会通过运行[Sysinternals Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)来解决这个问题。运行此工具后，您实际上可以查看脚本尝试打开的文件，即使它们不存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T21:30:32.000

出于相对路径的目的，“当前目录”是否可能是您的 ASP 页面的位置，而不是您的 XSL 文件？换句话说，如果您还没有，您可以尝试：

```
<xsl:import href="mysite/script.xsl"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T05:58:12.533

我经常遇到这个问题，因为我看不到的库正在使用自定义 URI 解析器（或者因为我没有阅读相关文档而不知道。）我不记得这是规范还是不是，但在 Saxon/java 世界中，自定义 URI 解析器首先尝试解析包含/导入语句的 URI 以及 document() 函数。如果它无法解析 URI，默认的 URI 解析器会尝试一下，当 URI 是绝对的时，通常不会错过。

因此，它可能是 ASP 引擎中使用基于应用程序上下文的上下文驱动的 URI 解析器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-22T18:46:58.777

第一次尝试：

我尝试将 script.xsl 包含为另一个 xml 块，并以我能想象到的各种方式更改导入语句，但没有成功。

最终解决方案：

由于包含 script.xsl 的绝对 url 从一开始就有效，我的最终解决方案是使用正确的文档类型将 style.xsl 转换为 style.asp。然后，在这个文件中，我能够检索服务器名称、协议和路径，并使用 asp 将它们回显到导入语句中的正确位置。然后，当这个文件被包含在 mysscript.asp 中时，它就有了正确的服务器绝对 URL。这有点小技巧，但我发现解决这个相当复杂的情况的唯一方法。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-13T13:55:32.587

在加载 JS、图像或 CSS 文件时，您需要一个定义 approot 或 webroot 的变量。

```
 <xsl:import href="{$approot}/somedir/script.xsl"/> 
```

或者如果您在 XML 中有值，

```
 <xsl:import href="{/root/@approot}/somedir/script.xsl"/> 
```

# mysql - 哪个数据库对复制的支持最好

> ID：142068
> 
> 赞同：13
> 
> 时间：2008-09-26T21:22:26.060
> 
> 标签：mysql, sql-server, database, postgresql, replication

我对 MySQL 复制可以做什么有相当好的感觉。我想知道还有哪些其他数据库支持复制，以及它们与 MySQL 和其他数据库相比如何？

我会问的一些问题是：

1.  复制是内置的，还是附加组件/插件？
2.  复制如何工作（高级）？MySQL 提供基于语句的复制（以及 5.1 中的基于行的复制）。我对其他数据库的比较感兴趣。什么是通过电线运送的？更改如何应用于副本？
3.  是否容易检查主从之间的一致性？
4.  让失败的副本与主服务器同步有多容易？
5.  表现？我讨厌 MySQL 复制的一件事是它是单线程的，并且副本通常难以跟上，因为 master 可以并行运行许多更新，但副本必须串行运行它们。其他数据库中是否有类似的陷阱？
6.  任何其他有趣的功能...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-26T22:20:40.023

MySQL 的复制很弱，因为需要牺牲其他功能来获得完整的主/主支持（由于受支持的后端的限制）。

PostgreSQL 的复制很弱，因为只支持内置的主/备用（使用日志传送）；更强大的解决方案（例如 Slony 或 Londiste）需要附加功能。存档日志段通过网络传输，这些记录用于确保独立数据库在不干净的启动时处于工作、一致的状态。这就是我目前正在使用的，我们已经完全自动化了重新同步（以及设置和其他功能）。这些方法都不是完全同步的。自 PostgreSQL 8.5 起将内置更完整的支持。日志传送不允许数据库不同步，因此不需要进程来测试同步状态；使两个数据库重新同步涉及在主服务器上设置备份标志，rsyncing 到从站（数据库仍在运行；这是安全的），并使用备份过程中生成的存档日志取消设置备份标志（并重新启动从站进程）；我的商店有这个过程（与所有其他管理任务一样）自动化。性能不是问题，因为除了做其他工作之外，master 必须在内部重放日志段；因此，从属服务器的负载将始终低于主服务器。

Oracle 的 RAC（它不是正确的复制，因为只有一个存储后端——但是您有多个前端共享负载，并且可以在该共享存储后端本身中构建冗余，所以这里值得一提）是一个多主机方法比其他解决方案更全面，但***非常***昂贵。数据库内容不是“通过网络传送的”；相反，它们被存储到共享后端，所有相关系统都可以访问该后端。因为只有一个后端，所以系统不会不同步。

Continuent 提供了一个第三方解决方案，可以进行完全同步的语句级复制，并支持上述所有三个数据库；但是，他们产品的商业支持版本并不是特别便宜（尽管便宜得多。上次我管理它时，Continuent 的解决方案需要手动干预才能使集群恢复同步。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T13:37:06.790

我对 MS-SQL 2005（发布者）和 SQLEXPRESS（订阅者）与海外合并复制有一些经验。以下是我的评论：

1 - 复制是内置的，还是插件/插件？

内置

2 - 复制如何工作（高级）？

不同的复制方式，从快照（在订阅者级别提供静态数据）到事务复制（每个 INSERT/DELETE/UPDATE 指令在所有服务器上执行）。合并复制仅复制最终更改（在复制期间将立即对同一记录进行连续更新）。

3 - 检查主从之间的一致性是否容易？

我从来没有做过的事...

4 - 让失败的副本与主服务器同步有多容易？

基本的重新同步过程只是双击一个....但是如果您有 4Go 数据要通过 64 Kb 连接重新初始化，除非您对其进行自定义，否则这将是一个漫长的过程。

5 - 性能？

嗯......你当然会在某个地方遇到瓶颈，即连接性能、数据量，或者最后是服务器性能。在我的配置中，用户只写入订阅者，所有订阅者都使用主数据库 = 发布者进行复制。然后，该服务器永远不会被最终用户请求，其 CPU 严格专用于数据复制（到多个服务器）和备份。订阅者专用于客户端和一个复制（发布者），这在最终用户的数据可用性方面给出了非常有趣的结果。发布者和订阅者之间的复制可以一起启动。

6 - 任何其他有趣的功能......

有一些预期，可以在不停止复制过程的情况下继续开发数据库......表（以间接方式），字段和规则可以添加并复制到您的订阅者。

具有主要发布者和多个订阅者的配置可能非常便宜（与其他一些相比......），因为您可以在订阅者端使用免费的 SQLEXPRESS，即使在运行合并或事务复制时也是如此

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T13:43:55.980

试用[Sybase SQL Anywhere](http://www.sybase.com/products/databasemanagement/sqlanywhere)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-23T04:25:35.430

只需添加 SQL Server 的选项（尤其是 SQL 2008，它现在具有更改跟踪功能）。需要考虑的是 Microsoft 的[Sync Framework](http://msdn.microsoft.com/sync/)。那里有一些选择，从基本的中心辐射型架构（如果您有一个单一的中央服务器和有时连接的客户端），一直到点对点同步，这让您能够做更高级的事情与多个“主”数据库同步。

您可能要考虑使用此方法而不是传统复制的原因是您可以从代码中获得更多控制权，例如，您可以在更新/更新、更新/删除、删除/更新、插入/插入冲突的同步过程中获取事件并根据业务逻辑决定如何解决它们，如果需要，将冲突数据的丢失者存储在某个地方以进行手动或自动处理。查看[本指南](http://msdn.microsoft.com/en-us/library/bb902827.aspx)，以帮助您确定不同的复制和/或同步方法的可能性。

对于热心的程序员来说，同步框架足够开放，您可以让客户端通过 WCF 连接到您的 WCF 服务，该服务可以抽象任何后端数据存储（我听说有些人正在尝试使用 Oracle 作为后端）。

我的团队刚刚发布了一个大型项目，该项目涉及多个 SQL Express 数据库，通过 WAN 和 Internet（在某些情况下是慢速拨号连接）同步来自中央 SQL Server 数据库的数据子集，并取得了巨大成功。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-26T21:41:10.647

MS SQL 2005 标准版及更高版本具有出色的复制能力和工具。看一眼：

[http://msdn.microsoft.com/en-us/library/ms151198(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms151198(SQL.90).aspx)

可以说是相当有能力了。您甚至可以将 SQL Server Express 用作只读订阅者。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T19:46:40.880

数据库调用复制有很多不同的东西。并非所有这些实际上都涉及复制，而且那些确实以截然不同的方式工作。一些数据库支持几种不同的类型。

MySQL 支持异步复制，这对于一些事情来说是非常好的。但是，也有弱点。基于语句的复制与大多数（任何？）其他数据库所做的不同，并且并不总是导致预期的行为。仅非生产就绪版本支持基于行的复制（但与其他数据库的做法更一致）。

每个数据库都有自己的复制方式，有些涉及插入其他工具。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T13:30:16.793

有点离题，但您可能想查看 Maatkit 以获取有助于 MySQL 复制的工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T05:23:50.553

所有主要的商业数据库都有不错的复制 - 但有些比其他数据库更不错。IBM Informix Dynamic Server（版本 11 和更高版本）特别好。它实际上有两个系统 - 一个用于高可用性（HDR - 高可用性数据复制），另一个用于分发数据（ER - 企业复制）。Mach 11 功能（RSS - 远程独立辅助和 SDS - 共享磁盘辅助）也非常出色，在 11.50 中更是如此，您可以写入 HDR 对的主要或辅助。

（*完全披露：我在 Informix 软件上工作。*）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-09T14:43:54.593

我自己没有尝试过，但您可能还想研究 OpenBaseSQL，它似乎内置了一些简单易用的复制功能。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-26T21:29:12.347

另一种方法是在虚拟化环境中运行。我认为这篇博客文章中的数据很有趣

[http://chucksblog.typepad.com/chucks_blog/2008/09/enterprise-apps.html](http://chucksblog.typepad.com/chucks_blog/2008/09/enterprise-apps.html)

它来自 EMC 高管，所以显然，它不是独立的，但实验应该是可重现的

这是特定于 Oracle 的数据

[http://oraclestorageguy.typepad.com/oraclestorageguy/2008/09/to-rac-or-not-to-rac-reprise.html](http://oraclestorageguy.typepad.com/oraclestorageguy/2008/09/to-rac-or-not-to-rac-reprise.html)

编辑：如果你运行虚拟化，那么有办法让任何东西复制

[http://chucksblog.typepad.com/chucks_blog/2008/05/vmwares-srm-cha.html](http://chucksblog.typepad.com/chucks_blog/2008/05/vmwares-srm-cha.html)

# editor - Symbian S60 代码编辑器

> ID：142071
> 
> 赞同：1
> 
> 时间：2008-09-26T21:23:03.080
> 
> 标签：editor, s60, codehighlighter

我正在寻找一个可以让我在手机上输入代码的应用程序。我不需要编译什么的，也不需要为手机编程。当一个想法出现在我的脑海中时，这是一件好事。

我是否完全忽略了 Symbian S60v3 手机的简单代码编辑器？

我正在寻找类似于适用于 Windows Mobile的[CEdit的东西。](http://www.logicalsky.com/Product_CEdit.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T22:45:15.753

我在我的[S60v2](http://users.tkk.fi/~lhuovine/mobile/python.html)手机上使用了 pyEdit，看起来它在 v3 下也受支持。

它取决于 python 运行时，所以你需要先安装它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T23:22:54.210

试试[YEdit](http://www.softpedia.com/get/Office-tools/Text-editors/yEdit.shtml)或[LightNotepad](http://handheld.softpedia.com/get/Word-Processing-Text-Tools/Text-Editor/LightNotepad-65432.shtml)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-08T13:40:11.820

尝试`ped-s60`

[http://code.google.com/p/ped-s60/downloads/list](http://code.google.com/p/ped-s60/downloads/list)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-26T21:28:52.160

您可以使用视觉工作室：

[http://wiki.forum.nokia.com/index.php/Using_Visual_Studio_6.0_with_S60_3rd_Edition](http://wiki.forum.nokia.com/index.php/Using_Visual_Studio_6.0_with_S60_3rd_Edition)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-02T08:59:36.967

您可以从[诺基亚](http://www.forum.nokia.com/Resources_and_Information/Tools/IDEs/Carbide/)**免费**下载非常基本的 Carbide C++ 版本

这是建立在eclipse平台上的，非常好。

# button - Scroll Lock 按钮还有用吗？

> ID：142076
> 
> 赞同：13
> 
> 时间：2008-09-26T21:24:39.643
> 
> 标签：button, keyboard, scroll-lock

滚动锁定按钮似乎是对过去美好的绿色终端时代的提醒。有人还在用吗？101键键盘应该变成100键键盘吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-26T21:26:20.387

在 Excel 中，如果打开滚动锁定，则使用箭头键滚动电子表格，而不是更改光标所在的单元格。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-26T21:27:41.430

在许多 KVM 情况下，双击滚动锁定会调出机器选择屏幕。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-26T21:59:07.733

我一直在 Unix 终端上使用它。当我跟踪日志文件时，如果有什么东西引起了我的注意，这非常方便。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-26T21:26:26.207

Microsoft Excel 使用 Scroll Lock 允许您使用箭头键滚动电子表格，而无需更改活动/选定的单元格 - 符合 Scroll Lock 键的[初衷](http://www.straightdope.com/columns/read/2125/whats-the-scroll-lock-key-on-my-computer-for)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-26T21:27:17.123

在 Microsoft Excel 中，Scroll Lock 允许您使用箭头键滚动电子表格，而无需从当前突出显示的单元格中移动活动单元格指针。在另一个电子表格程序 Quattro Pro 中，Scroll Lock 以类似的方式工作，尽管与 Excel 相比，它不可能将活动单元格指针完全滚动到屏幕外。

其他程序使用 Scroll Lock 来实现特殊功能。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-15T13:48:00.057

滚动锁定（至少是它的 LED，无论如何）与 caps lock 和 num lock LED 一起使用，以在对戴尔笔记本电脑上的硬件问题进行故障排除时提供诊断错误代码。这在对可能阻止从屏幕读取诊断消息的显示问题进行故障排除时非常有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-26T21:27:28.623

它看起来大多死了： [http ://en.wikipedia.org/wiki/Scroll_lock](http://en.wikipedia.org/wiki/Scroll_lock)

我不记得我上次使用它是什么时候了...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-26T21:28:59.367

如果你碰巧有一些遗留的 MS-DOS 游戏，它可能会很有用 ;-)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-27T01:02:36.467

Winamp（媒体播放器）的可视化插件之一使用滚动锁定来防止可视化每 x 秒旋转一次可视化

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-27T02:31:48.750

在[Synergy](http://synergy2.sourceforge.net/)中，您可以将鼠标锁定到当前屏幕。当您想与房间另一侧的 PC 共享鼠标时非常有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-26T21:56:41.733

好吧，这是 AutoHotkey...（或其他键盘快捷键管理器）使用的另一个键。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-27T02:22:04.997

由于它连接到 LED，一些聪明的人添加了代码以使其在给定的时间间隔闪烁（例如滚动锁定开/关/开/关），作为新电子邮件消息（或类似消息）的通知

如果您有一台关闭的笔记本电脑（或屏幕正在休眠），这可能会很“酷”……您只需查看指示灯是否在闪烁。

* * *

## 回答 #13

> 赞同：-5
> 
> 时间：2009-05-13T17:57:58.450

我一直在使用它，目的是为了实现它。对于各种各样的事情。

# c# - C# Lambda 表达式或委托作为属性或参数

> ID：142090
> 
> 赞同：7
> 
> 时间：2008-09-26T21:28:41.257
> 
> 标签：c#, lambda

我正在寻找一个 ValidationRule 类来验证实体类型对象的属性。我真的很想设置要检查的属性的名称，然后给类一个委托或 lambda 表达式，当对象运行其 IsValid() 方法时，它将在运行时进行评估。有没有人有这样的片段，或者关于如何将匿名方法作为参数或属性传递的任何想法？

另外，我不确定我是否在解释我要完成的工作，所以如果我不清楚，请提出问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-26T21:35:39.960

实际上，您要使用的是`Func<T,bool>`其中 T 是您要验证的项目的类型。然后你会做这样的事情

```
validator.AddValidation(item => (item.HasEnoughInformation() || item.IsEmpty()); 
```

您可以将它们存储在`List<Func<T,bool>>`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-26T21:32:20.687

```
class ValidationRule {
    public delegate bool Validator();

    private Validator _v;

    public ValidationRule(Validator v) { _v = v; }

    public Validator Validator {
        get { return _v; }
        set { _v = value; }
    }

    public bool IsValid { get { return _v(); } }
}

var alwaysPasses = new ValidationRule(() => true);
var alwaysFails = new ValidationRule(() => false);

var textBoxHasText = new ValidationRule(() => textBox1.Text.Length > 0); 
```

那应该让你开始。但是，实际上，继承在这里更合适。问题很简单，`Validator`它无法访问任何未关闭的状态，这意味着它不像`ValidationRules`包含自己的状态那样可重用。将下面的类与之前的定义进行比较`textBoxHasText`。

```
interface IValidationRule {
    bool IsValid { get; }
}

class BoxHasText : IValidationRule {
    TextBox _c;

    public BoxHasText(TextBox c) { _c = c; }

    public bool IsValid {
        get { return _c.Text.Length > 0; }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-26T21:42:52.890

好吧，简单地说，如果你有一个实体类，并且你想在那个实体上使用 lambda 表达式来确定某些东西是否有效（返回布尔值），你可以使用 Func。

所以，给定一个实体：

```
 class Entity
 {
      public string MyProperty { get; set; }
 } 
```

您可以像这样定义一个 ValidationRule 类：

```
 class ValidationRule<T> where T : Entity
 {
      private Func<T, bool> _rule;

      public ValidationRule(Func<T, bool> rule)
      {
           _rule = rule;
      }

      public bool IsValid(T entity)
      {
           return _rule(entity);
      }
 } 
```

然后你可以像这样使用它：

```
 var myEntity = new Entity() { MyProperty = "Hello World" };
 var rule = new ValidationRule<Entity>(entity => entity.MyProperty == "Hello World");

 var valid = rule.IsValid(myEntity); 
```

当然，这只是一种可能的解决方案。

如果您删除上面的通用约束（“where T : Entity”），您可以使其成为可与任何 POCO 一起使用的通用规则引擎。您不必为所需的每种使用类型派生一个类。因此，如果我想在 TextBox 上使用同一个类，我可以使用以下内容（在删除通用约束之后）：

```
 var rule = new ValidationRule<TextBox>(tb => tb.Text.Length > 0);
 rule.IsValid(myTextBox); 
```

这种方式非常灵活。结合使用 lambda 表达式和泛型是非常强大的。除了接受 Func 或 Action，您还可以接受 Expression> 或 Expression> 并直接访问 express 树以自动调查方法或属性的名称、它是什么类型的表达式等。类不必更改一行代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T21:41:17.700

就像是：

```
class ValidationRule
{
    private Func<bool> validation;

    public ValidationRule(Func<bool> validation)
    {
        this.validation = validation;
    }
    public bool IsValid()
    {
        return validation();
    }
} 
```

将是更多的 C# 3 风格，但编译为与@Frank Krueger 的答案相同的代码。这是你要求的，但感觉不对。实体不能扩展以执行验证有充分的理由吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T14:28:46.427

Would a rule definition syntax like this one work for you?

```
 public static void Valid(Address address, IScope scope)
  {
    scope.Validate(() => address.Street1, StringIs.Limited(10, 256));
    scope.Validate(() => address.Street2, StringIs.Limited(256));
    scope.Validate(() => address.Country, Is.NotDefault);
    scope.Validate(() => address.Zip, StringIs.Limited(10));

    switch (address.Country)
    {
      case Country.USA:
        scope.Validate(() => address.Zip, StringIs.Limited(5, 10));
        break;
      case Country.France:
        break;
      case Country.Russia:
        scope.Validate(() => address.Zip, StringIs.Limited(6, 6));
        break;
      default:
        scope.Validate(() => address.Zip, StringIs.Limited(1, 64));
        break;
    } 
```

Check out [DDD and Rule driven UI Validation in .NET](http://abdullin.com/journal/2009/1/29/ddd-and-rule-driven-ui-validation-in-net.html) for more information

# asp.net - 我可以将 OpenId 与 ASP MembershipProvider 一起使用吗？

> ID：142101
> 
> 赞同：11
> 
> 时间：2008-09-26T21:30:24.777
> 
> 标签：asp.net, asp.net-membership, openid, membership-provider, dotnetopenauth

我有一个 ASP.Net 2.0 网站，目前正在使用自定义 MembershipProvider 和标准登录控件。我想用 DotNetOpenId 中的登录控件替换登录控件。

我覆盖了检查用户名和密码的 ValidateUser，但是在使用 OpenId 时我不需要实现它。

是否可以使用 OpenId 并且我仍然可以使用会员提供程序，以便我仍然可以使用它来访问当前登录的用户？

还是不再需要使用提供者模型的情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-26T21:35:42.503

没有可用的内置提供程序。但是您始终可以实现自己的提供程序。

或者您可以在 codePlex中查看[这个可用的。](http://www.codeplex.com/OpenIDMembership)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T04:26:24.890

[在http://code.google.com/p/dotnet-membership-provider/](http://code.google.com/p/dotnet-membership-provider/)中找到的一个 Web 项目模板 有一个与 dotnetopenid 一起使用的示例成员资格提供程序类，尽管您可能应该在生产中使用它之前对其进行审查。 .. 上次我检查源代码时需要做一些工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-20T15:25:52.260

这是首屈一指的 .NET OpenID 库，由 MSFT 员工 Andrew Arnott 编写：[http ://code.google.com/p/dotnetopenid/](http://code.google.com/p/dotnetopenid/)

不确定与会员资格的整合。

# vbscript - VBScript Excel 格式化 .xlsx 文件

> ID：142110
> 
> 赞同：3
> 
> 时间：2008-09-26T21:31:52.247
> 
> 标签：vbscript

基本上我想知道如何使用 VBScript 为单元格设置中心对齐...

我一直在谷歌上搜索它，似乎找不到任何有帮助的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T21:48:24.860

```
Set excel = CreateObject("Excel.Application")

excel.Workbooks.Add() ' create blank workbook

Set workbook = excel.Workbooks(1)

' set A1 to be centered.
workbook.Sheets(1).Cells(1,1).HorizontalAlignment = -4108 ' xlCenter constant.

workbook.SaveAs("C:\NewFile.xls")

excel.Quit()

set excel = nothing

'If the script errors, it'll give you an orphaned excel process, so be warned. 
```

将其保存为 .vbs 并使用命令提示符或双击运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T21:43:52.547

有很多方法可以选择一个单元格或一系列单元格，但以下方法适用于单个单元格。

```
'Select a Cell Range
Range("D4").Select

'Set the horizontal and vertical alignment
With Selection
    .HorizontalAlignment = xlCenter
    .VerticalAlignment = xlBottom
End With 
```

Horizo​​ntalAlignment 选项是 xlLeft、xlRight 和 xlCenter

# c# - 存储数据的最佳（免费）方式？更新文件系统怎么样？

> ID：142114
> 
> 赞同：4
> 
> 时间：2008-09-26T21:32:37.703
> 
> 标签：c#, extensibility, data-storage

我对如何解决这个问题有一个想法，但我想知道是否有更容易和更可扩展的东西来解决我的问题。

我正在开发的程序有两种基本形式的数据：图像，以及与这些图像相关的信息。与图像相关的信息以前存储在一个极其简单的 JET 数据库（四个表）中，结果证明存储的字段既慢又不完整。我们正在转向数据存储的新实施。考虑到所涉及的数据结构的简单性，我认为数据库是多余的。

每张图像都有自己的信息（捕获参数），将是一组相互关联的图像的一部分（例如，在相同的 30 分钟内拍摄），然后是整个更大组的一部分（拍摄同一个人） ）。现在，我将人员存储在具有唯一标识符的字典中。然后每个人都有一个不同图片组的列表，每个图片组都有一个图片列表。所有这些类都是可序列化的，我只是对字典进行序列化和反序列化。相当简单的东西。图像是分开存储的，因此字典的大小不会变成天文数字。

问题是：当我需要添加新的信息字段时会发生什么？有没有一种简单的方法来设置这些数据结构以考虑未来的潜在修订？过去，我在 C 中处理此问题的方式是创建一个具有大量空字节（至少为 ak）的可序列化结构，以供将来扩展，结构中的一个字节指示版本。然后，当程序读取结构时，它会根据大量的 switch 语句知道要使用哪种反序列化（旧版本可以读取新数据，因为无关数据只会进入被忽略的字段）。

C# 中是否存在这样的方案？就像，如果我有一个类是一组 String 和 Int 对象，然后我将另一个 String 对象添加到结构中，我如何从磁盘反序列化一个对象，然后将字符串添加到它？我是否需要让自己拥有多个版本的数据类，以及一个采用反序列化流并根据存储在基类中的一些版本信息处理反序列化的工厂？还是像 Dictionary 这样的类非常适合存储此类信息，因为它会自动反序列化磁盘上的所有字段，并且如果添加了新字段，我可以捕获异常并用空白字符串和整数替换这些值？

如果我使用字典方法，是否存在与文件读/写以及参数检索时间相关的速度影响？我认为如果一个类中只有字段，那么字段检索是即时的，但在字典中，与该类相关的一些小开销。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T21:39:41.917

[Sqlite](http://www.sqlite.org/)是你想要的。它是一个快速、可嵌入的单文件数据库，绑定了大多数语言。

关于可扩展性，您可以使用默认属性存储模型，然后为将来更改的属性扩展提供单独的表。

一两年后，如果代码仍在使用中，您会很高兴 1）其他开发人员不必学习自定义代码结构来维护代码，2）您可以导出、查看、修改使用标准数据库工具（有用于 sqlite 文件和各种查询工具的 ODBC 驱动程序）的数据，以及 3）您将能够以最少的代码更改扩展到数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T00:28:08.983

只是一点警告，SQLLite、Protocol Buffers、mmap 等……都很好，但你应该对每个实现进行原型设计和测试，并确保你不会遇到相同的性能问题或不同的瓶颈。

简单性可能只是升级到 SQL (Express)（您可能会对性能增益感到惊讶）并修复当前数据库设计中缺少的任何内容。然后，如果性能仍然是一个问题，请开始研究这些其他技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T21:45:08.470

有一个数据库模式，我不记得它的名字，可以处理这种情况。你基本上有两张桌子。一张表存储变量名，另一张表存储变量值。如果要对变量进行分组，则添加第三个表，该表将与变量名称表具有一对多关系。此设置的优点是可以让您不断添加不同的变量，而无需不断更改数据库架构。在与经常改变主意的部门（如市场营销）打交道时，我节省了很多次培根。

唯一的缺点是变量值表需要将实际值存储为字符串列（实际上是 varchar 或 nvarchar）。然后，您必须处理将值转换回其本机表示的麻烦。我目前维护这样的东西。变量表目前大约有 8 亿行。它仍然相当快，因为​​我仍然可以在一秒钟内检索某些值的变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T21:49:45.573

此刻我的大脑被炸了，所以我不确定我是否可以建议支持或反对数据库，但如果您正在寻找与版本无关的序列化，那么至少不检查[Protocol Buffers](http://code.google.com/apis/protocolbuffers/docs/overview.html)将是一个傻瓜。

以下是我所了解的 C#/.NET 实现的快速列表：

*   [protobuf-net](http://code.google.com/p/protobuf-net/)
*   [原型#](http://code.google.com/p/protosharp/)
*   [jskeet 的 dotnet-protobufs](http://github.com/jskeet/dotnet-protobufs/tree/master)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-26T21:50:24.887

我不是 C# 程序员，但我喜欢 mmap() 调用，并且看到有一个项目为 C# 做这样的事情。

见[地图](http://netdev.usr.dico.unimi.it/software/csharp/mmap/index.html)

> 如果为特定应用程序量身定制结构化文件，则其性能非常好，但难以管理且难以重用代码资源。更好的解决方案是类似虚拟内存的实现。
> 
> *   最多可以管理 4 GB 的信息。
> *   空间可以优化为实际数据大小。
> *   所有数据都可以视为一个数组，并通过读/写操作进行访问。
> *   无需构建存储，只需使用和存储。
> *   可以缓存。高度可重用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-26T22:40:06.107

所以使用 sqllite 的原因如下：
1\. 您不需要每次都从磁盘读取/写入整个数据库
2\. 即使您在开始时没有留下足够的占位符，也更容易添加
3\. 更容易根据您想要的任何内容进行搜索
4\. 更容易以超出应用程序设计的方式更改数据

字典方法的问题
1\. 除非你制作了一个智能字典，否则你每次都需要读/写整个数据库（除非你仔细设计数据结构，否则很难保持向后兼容性）
----- a) 如果你没有留下足够的占位符再见
2。似乎您必须对所有照片进行线性搜索才能搜索其中一个捕获属性
3.一张图片可以在多个组中吗？一张图片可以超过一个人吗？两个人可以在同一个组吗？有了字典，这些东西会变得很棘手......

对于数据库表，如果您获得一个新属性，您只需说 Alter Table Picture Add Attribute DataType。然后，只要您不制定规则说属性必须具有值，您仍然可以加载和保存旧版本。同时较新的版本可以使用新的属性。

此外，您不需要将图片保存在数据库中。您可以将图片的路径存储在数据库中。然后当应用程序需要图片时，只需从磁盘文件中加载它。这使数据库大小更小。此外，与加载图像的时间相比，获取磁盘文件的额外寻道时间很可能是微不足道的。

可能你的表应该是
Picture(PictureID, GroupID?, File Path, Capture Parameter 1, Capture Parameter 2, etc..)

如果您想要更大的灵活性，您可以创建一个表 CaptureParameter(PictureID, ParameterName, ParameterValue) ...我建议不要这样做，因为它比将它们放在一个表中效率低得多（更不用说检索/搜索的查询捕获参数会更复杂）。

Person(PersonID, Any Person Attributes like Name/Etc.)
Group(GroupID, Group Name, PersonID?)
PersonGroup?(PersonID, GroupID)
PictureGroup?(GroupID, PictureID)

# unit-testing - 用于比较 NUnit 中的文本文件的单元测试

> ID：142121
> 
> 赞同：5
> 
> 时间：2008-09-26T21:34:05.533
> 
> 标签：unit-testing, nunit, diff, text-files

我有一个类可以处理 2 个 xml 文件并生成一个文本文件。

我想编写一堆单元/集成测试，这些测试可以单独为这个类通过或失败，它们执行以下操作：

1.  对于输入 A 和 B，生成输出。
2.  将生成文件的内容与预期输出的内容进行比较
3.  当实际内容与预期内容不同时，失败并显示一些关于差异的**有用**信息。

下面是该类的原型以及我在单元测试中的第一次尝试。

**有没有我应该用于这种测试的模式，还是人们倾向于编写数以万计的 TestX() 函数？**

**有没有更好的方法来哄骗 NUnit 的文本文件差异？**我应该嵌入文本文件差异算法吗？

* * *

```
class ReportGenerator
{
    string Generate(string inputPathA, string inputPathB)
    {
        //do stuff
    }
} 
```

* * *

```
[TextFixture]
public class ReportGeneratorTests
{
     static Diff(string pathToExpectedResult, string pathToActualResult)
     {
         using (StreamReader rs1 = File.OpenText(pathToExpectedResult))
         {
             using (StreamReader rs2 = File.OpenText(pathToActualResult))
             {
                 string actualContents = rs2.ReadToEnd();
                 string expectedContents = rs1.ReadToEnd();                  

                 //this works, but the output could be a LOT more useful.
                 Assert.AreEqual(expectedContents, actualContents);
             }
         }
     }

     static TestGenerate(string pathToInputA, string pathToInputB, string pathToExpectedResult)
     {
          ReportGenerator obj = new ReportGenerator();
          string pathToResult = obj.Generate(pathToInputA, pathToInputB);
          Diff(pathToExpectedResult, pathToResult);
     }

     [Test]
     public void TestX()
     {
          TestGenerate("x1.xml", "x2.xml", "x-expected.txt");
     }

     [Test]
     public void TestY()
     {
          TestGenerate("y1.xml", "y2.xml", "y-expected.txt");
     }

     //etc...
} 
```

* * *

## 更新

我对测试差异功能不感兴趣。我只是想用它来产生更具可读性的失败。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T22:16:05.963

至于具有不同数据的多个测试，请使用 NUnit RowTest 扩展：

```
using NUnit.Framework.Extensions;

[RowTest]
[Row("x1.xml", "x2.xml", "x-expected.xml")]
[Row("y1.xml", "y2.xml", "y-expected.xml")]
public void TestGenerate(string pathToInputA, string pathToInputB, string pathToExpectedResult)
 {
      ReportGenerator obj = new ReportGenerator();
      string pathToResult = obj.Generate(pathToInputA, pathToInputB);
      Diff(pathToExpectedResult, pathToResult);
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-28T06:28:00.890

您可能要求对“黄金”数据进行测试。我不知道这种测试是否有特定的术语可以在全球范围内接受，但我们就是这样做的。

创建基夹具类。它基本上有“void DoTest(string fileName)”，它将特定文件读入内存，执行抽象转换方法“string Transform(string text)”，然后从同一个地方读取fileName.gold，并将转换后的文本与预期的文本进行比较. 如果内容不同，则抛出异常。抛出的异常包含第一个差异的行号以及预期和实际行的文本。由于文本是稳定的，这通常足以立即发现问题。请务必用“预期：”和“实际：”标记行，否则在查看测试结果时您将永远猜测哪个是哪个。

然后，您将拥有特定的测试装置，在其中实现正确工作的 Transform 方法，然后进行如下所示的测试：

```
[Test] public void TestX() { DoTest("X"); }
[Test] public void TestY() { DoTest("Y"); } 
```

失败测试的名称会立即告诉你什么是坏的。当然，您可以使用行测试对类似的测试进行分组。进行单独的测试在许多情况下也有帮助，例如忽略测试、将测试传达给同事等等。创建一个可以在一秒钟内为您创建测试的代码段并不是什么大问题，您将花费更多时间准备数据。

然后你还需要一些测试数据和你的基本夹具找到它的方法，一定要为项目设置关于它的规则。如果测试失败，将实际输出转储到黄金附近的文件中，如果测试通过则将其删除。这样您就可以在需要时使用差异工具。当没有找到黄金数据时，测试失败并显示适当的消息，但无论如何都会写入实际输出，因此您可以检查它是否正确并将其复制为“黄金”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T21:43:36.117

您可以自己解析两个输入流，而不是调用 .AreEqual，保留行数和列数并比较内容。一旦发现差异，您就可以生成一条消息，例如...

> 第 32 行第 12 列 - 在预期为 'y' 时找到'x'

您可以选择通过显示多行输出来增强它

> 第 32 行第 12 列的差异，显示第一个差异
> A = 这是在**x** st
> B = 这是在**e** sts

请注意，作为一项规则，我通常只会通过我的代码生成您拥有的两个流之一。我会从测试/文本文件中获取另一个，通过眼睛或其他方法验证包含的数据是正确的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T21:44:29.003

我可能会编写一个包含循环的单元测试。在循环内部，我会读取 2 个 xml 文件和一个 diff 文件，然后对 xml 文件进行比较（不将其写入磁盘）并将其与从磁盘读取的 diff 文件进行比较。文件将被编号，例如 a1.xml, b1.xml, diff1.txt ；a2.xml、b2.xml、diff2.txt；a3.xml、b3.xml、diff3.txt 等，当找不到下一个数字时循环停止。

然后，您只需添加新的文本文件即可编写新的测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T05:19:08.957

我可能会使用 XmlReader 遍历文件并比较它们。当我遇到差异时，我会在文件不同的位置显示一个 XPath。

PS：但实际上，我只需将整个文件简单地读取到一个字符串并比较这两个字符串就足够了。对于报告来说，看到测试失败就足够了。然后，当我进行调试时，我通常使用[Araxis Merge](http://www.araxis.com/merge/index.html)对文件进行比较，以查看我到底在哪里遇到了问题。

# asp.net - ASP.NET webforms 和 MVC 之间的主要区别是什么

> ID：142132
> 
> 赞同：10
> 
> 时间：2008-09-26T21:36:02.220
> 
> 标签：asp.net, asp.net-mvc

我知道 MVC 是什么，并且我在网络表单中工作，但我不知道 MVC 会有什么不同。我猜模型背后的代码会有所不同。那么它会像网络表单一样减去背后的代码，而是将它放在控制器中吗？

我看到还有其他相关的帖子，但我没有解决这个问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-26T21:41:55.450

对于初学者，MVC 不使用 <asp:control> 控件，而是优先使用良好的旧标准 <input> 等。因此，您不会像在 ASP 中那样将“事件”附加到在代码隐藏中执行的控件。它依赖于标准的 http POST 来做到这一点。

它不使用 viewstate 对象。

它允许更智能的 url 映射，虽然现在 Routing 命名空间已经被剥离，我想知道它是否可以用于 WebForms？

自动化测试 Web 部件要容易得多。

它允许更轻松地将 UI 逻辑与“后端”组件分离。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-05-27T17:19:08.757

![ASP Net Webforms 和 ASP Net MVC 之间的区别](https://i.stack.imgur.com/INH1z.png)

## 图片说明了一切。

更新：添加原始链接以确保完整性。 [http://forums.asp.net/t/1528396.aspx?MVC+vs+Web+Forms](http://forums.asp.net/t/1528396.aspx?MVC+vs+Web+Forms)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-26T21:41:00.523

[此处](http://www.asp.net/learn/mvc-videos/)的视频教程有助于描述差异。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-28T02:46:53.137

关于你的问题，可以说的太多了。

MVC 允许清晰地分离关注点、可测试性和测试驱动开发 (TDD)。它支持干净的 RESTful URL 并且非常可扩展……这意味着您可以更换查看引擎、路由机制以及许多其他您可能不喜欢开箱即用的东西。

有关其他信息，我建议阅读 Dino Esposito 的博客文章，标题为[An Architectural View of the ASP.NET MVC Framework](http://dotnetslackers.com/articles/aspnet/AnArchitecturalViewOfTheASPNETMVCFramework.aspx)。在这篇文章中，他比较了经典代码隐藏方法与 MVC 之间的许多差异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-29T07:28:24.450

Asp.Net 网络表单：

1.  Asp.Net Web Form 遵循传统的事件驱动开发模型。
2.  Asp.Net Web 窗体具有服务器控件。

Asp.Net MVC 模型：

1.  Asp.Net MVC 是一个轻量级且遵循 MVC（模型、视图和控制器）模式的开发模型。Asp.Net MVC 不支持视图状态。

[看更多..](http://asp-net-by-parijat.blogspot.in/2014/09/difference-between-aspnet-webforms-and.html)

# sql - SQL - 查询以获取服务器的 IP 地址

> ID：142142
> 
> 赞同：108
> 
> 时间：2008-09-26T21:37:16.587
> 
> 标签：sql, sql-server

SQL Server 2005 中是否有可以用来获取服务器 IP 或名称的查询？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2013-02-04T20:59:46.447

```
SELECT  
   CONNECTIONPROPERTY('net_transport') AS net_transport,
   CONNECTIONPROPERTY('protocol_type') AS protocol_type,
   CONNECTIONPROPERTY('auth_scheme') AS auth_scheme,
   CONNECTIONPROPERTY('local_net_address') AS local_net_address,
   CONNECTIONPROPERTY('local_tcp_port') AS local_tcp_port,
   CONNECTIONPROPERTY('client_net_address') AS client_net_address 
```

这里的代码会给你IP地址；

这适用于对 SQL 2008 和更高版本的远程客户端请求。

如果您允许共享内存连接，那么在服务器本身上面运行将为您提供

*   “共享内存”作为“net_transport”的值，以及
*   'local_net_address' 为 NULL，并且
*   ' `<local machine>`' 将显示在 'client_net_address' 中。

'client_net_address' 是发出请求的计算机的地址，而 'local_net_address' 将是 SQL 服务器（因此在共享内存连接上为 NULL），如果他们不能使用服务器的 NetBios，您将提供给某人的地址名称或 FQDN 出于某种原因。

我强烈建议不要使用[这个答案](https://stackoverflow.com/a/142157/578411)。在生产 SQL Server 上启用外壳是一个非常糟糕的主意。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-09-26T21:41:11.973

您可以通过以下方式获取 [hostname]\[instancename]：

```
SELECT @@SERVERNAME; 
```

当您具有主机名\实例名称格式时，仅获取主机名：

```
SELECT LEFT(ltrim(rtrim(@@ServerName)), Charindex('\', ltrim(rtrim(@@ServerName))) -1) 
```

或者正如@GilM 指出的那样：

```
SELECT SERVERPROPERTY('MachineName') 
```

您可以使用以下方法获取实际 IP 地址：

```
create Procedure sp_get_ip_address (@ip varchar(40) out)
as
begin
Declare @ipLine varchar(200)
Declare @pos int
set nocount on
          set @ip = NULL
          Create table #temp (ipLine varchar(200))
          Insert #temp exec master..xp_cmdshell 'ipconfig'
          select @ipLine = ipLine
          from #temp
          where upper (ipLine) like '%IP ADDRESS%'
          if (isnull (@ipLine,'***') != '***')
          begin 
                set @pos = CharIndex (':',@ipLine,1);
                set @ip = rtrim(ltrim(substring (@ipLine , 
               @pos + 1 ,
                len (@ipLine) - @pos)))
           end 
drop table #temp
set nocount off
end 
go

declare @ip varchar(40)
exec sp_get_ip_address @ip out
print @ip 
```

[SQL 脚本的来源](http://www.sqlmag.com/Articles/ArticleID/48303/48303.html?Ad=1)。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-03-08T18:26:16.873

服务器可能有多个它正在侦听的 IP 地址。如果您的连接授予了 VIEW SERVER STATE 服务器权限，则可以运行此查询以获取您已连接到 SQL Server 的地址：

```
SELECT dec.local_net_address
FROM sys.dm_exec_connections AS dec
WHERE dec.session_id = @@SPID; 
```

此解决方案不需要您通过 xp_cmdshell 对操作系统进行外壳处理，这是一种应该在生产服务器上禁用（或至少严格保护）的技术。它可能要求您将 VIEW SERVER STATE 授予适当的登录名，但这比运行 xp_cmdshell 的安全风险要小得多。

GilM 提到的服务器名称技术是首选技术：

```
SELECT SERVERPROPERTY(N'MachineName'); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-11-11T14:32:09.540

大多数通过 t-sql 获取 IP 地址的解决方案都属于这两个阵营：

1.  `ipconfig.exe`通过运行`xp_cmdshell`并解析输出

2.  查询车管所`sys.dm_exec_connections`

我不喜欢选项#1。启用 xp_cmdshell 存在安全缺陷，并且无论如何都涉及大量解析。这很麻烦。选项#2 很优雅。这是一个纯粹的 t-sql 解决方案，我几乎总是喜欢它。以下是选项 #2 的两个示例查询：

```
SELECT c.local_net_address
FROM sys.dm_exec_connections AS c
WHERE c.session_id = @@SPID;

SELECT TOP(1) c.local_net_address
FROM sys.dm_exec_connections AS c
WHERE c.local_net_address IS NOT NULL; 
```

但有时，上述查询都不起作用。如果您通过共享内存连接（登录并在 SQL 主机上运行 SSMS），则查询 #1 将返回 NULL。如果没有使用非共享内存协议的连接，查询 #2 可能不返回任何内容。当连接到新安装的 SQL 实例时，可能会出现这种情况。解决方案？强制通过 TCP/IP 建立连接。为此，请在 SSMS 中创建一个新连接，并将“tcp:”前缀与服务器名称一起使用。然后重新运行任一查询，您将获得 IP 地址。

[![SSMS - 连接到数据库引擎](https://i.stack.imgur.com/UTRSk.png)](https://i.stack.imgur.com/UTRSk.png)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-11-06T19:11:15.233

--试试这个脚本，它可以满足我的需要。重新格式化以阅读它。

```
SELECT  
SERVERPROPERTY('ComputerNamePhysicalNetBios')  as 'Is_Current_Owner'
    ,SERVERPROPERTY('MachineName')  as 'MachineName'
    ,case when @@ServiceName = 
    Right (@@Servername,len(@@ServiceName)) then @@Servername 
      else @@servername +' \ ' + @@Servicename
      end as '@@Servername \ Servicename',  
    CONNECTIONPROPERTY('net_transport') AS net_transport,
    CONNECTIONPROPERTY('local_tcp_port') AS local_tcp_port,
    dec.local_tcp_port,
    CONNECTIONPROPERTY('local_net_address') AS local_net_address,
    dec.local_net_address as 'dec.local_net_address'
    FROM sys.dm_exec_connections AS dec
    WHERE dec.session_id = @@SPID; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-09-26T21:38:29.530

它在[@@SERVERNAME](http://msdn.microsoft.com/en-us/library/ms187944.aspx)变量中；

```
SELECT @@SERVERNAME; 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-08-04T05:10:02.697

您可以使用命令行查询并在 mssql 中执行：

```
exec xp_cmdshell 'ipconfig' 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-26T21:38:06.567

```
select @@servername 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-26T23:49:18.860

在没有 \InstanceName 的情况下获取机器名称的更简单方法是：

```
SELECT SERVERPROPERTY('MachineName') 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-24T14:04:10.710

我知道这是一篇旧文章，但当您想从共享内存连接（例如，从服务器本地在 SSMS 中运行的脚本）检索 IP 地址和 TCP 端口时，这个解决方案可能很有用。关键是使用 OPENROWSET 打开到 SQL Server 的辅助连接，在该连接字符串中指定“tcp:”。其余代码只是构建动态 SQL 以绕过 OPENROWSET 不能将变量作为其参数的限制。

```
DECLARE @ip_address       varchar(15)
DECLARE @tcp_port         int 
DECLARE @connectionstring nvarchar(max) 
DECLARE @parm_definition  nvarchar(max)
DECLARE @command          nvarchar(max)

SET @connectionstring = N'Server=tcp:' + @@SERVERNAME + ';Trusted_Connection=yes;'
SET @parm_definition  = N'@ip_address_OUT varchar(15) OUTPUT
                        , @tcp_port_OUT   int         OUTPUT';

SET @command          = N'SELECT  @ip_address_OUT = a.local_net_address,
                                  @tcp_port_OUT   = a.local_tcp_port
                          FROM OPENROWSET(''SQLNCLI''
                                 , ''' + @connectionstring + '''
                                 , ''SELECT local_net_address
                                          , local_tcp_port
                                     FROM sys.dm_exec_connections
                                     WHERE session_id = @@spid
                                   '') as a'

EXEC SP_executeSQL @command
                 , @parm_definition
                 , @ip_address_OUT = @ip_address OUTPUT
                 , @tcp_port_OUT   = @tcp_port OUTPUT;

SELECT @ip_address, @tcp_port 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-05-11T09:21:14.353

请使用此查询：

```
SELECT CONNECTIONPROPERTY('local_net_address') AS [IP] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-01-16T14:14:37.693

可以使用 host_name() 函数

```
select HOST_NAME() 
```

# actionscript - 动作脚本 2 函数

> ID：142147
> 
> 赞同：1
> 
> 时间：2008-09-26T21:39:00.967
> 
> 标签：actionscript, actionscript-2

我是一位经验丰富的程序员，但刚开始使用 Flash/Actionscript。我正在开发一个项目，由于某些原因需要我使用 Actionscript 2 而不是 3。

当我运行以下命令时（我只是将它放在新 Flash 项目的第一帧中），输出是 3 而不是 1 ？我需要它是1。

为什么'ii'变量的范围在循环之间继续？

```
var fs:Array = new Array();

for (var i = 0; i < 3; i++){

    var ii = i + 1; 
    fs[i] = function(){
        trace(ii);
    }
}

fs[0](); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T10:05:41.153

不幸的是，AS2 不是那种语言。它没有那种封闭。函数在 AS2 中并不完全是一等公民，其结果之一是函数不保留自己的作用域，它必须在调用时与某个作用域相关联（通常与函数所在的作用域相同）本身已定义，除非您使用函数`call`或`apply`方法）。

然后，当函数被执行时，它内部的变量范围就是它碰巧被调用的范围——在你的情况下，是循环之外的范围。这也是您可以执行以下操作的原因：

```
function foo() {
    trace( this.value );
}

objA = { value:"A" };
objB = { value:"B" };

foo.apply( objA ); // A
foo.apply( objB ); // B

objA.foo = foo;
objB.foo = foo;

objA.foo(); // A
objB.foo(); // B 
```

如果你习惯了真正的 OO 语言，那看起来很奇怪，原因是 AS2 最终是一种[原型语言](http://en.wikipedia.org/wiki/Prototype-based_programming)。一切看起来面向对象的东西都只是巧合。;D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T21:54:57.790

不幸的是，Actionscript 2.0 没有强大的范围……尤其是在时间线上。

```
var fs:Array = new Array();

for (var i = 0; i < 3; i++){

    var ii = i + 1;     
    fs[i] = function(){
        trace(ii);
    }
}

fs[0]();
trace("out of scope: " + ii + "... but still works"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T13:41:05.427

我想出了一种解决我自己问题的策略：

```
var fs:Array = new Array();

for (var i = 0; i < 3; i++){    
    var ii = i + 1;   

    f = function(j){
        return function(){
            trace(j);
        };
    };
    fs[i] = f(ii);
}

fs[0](); //1
fs[1](); //2
fs[2](); //3 
```

# java - 如何在 java 的类路径中找到资源？特别是以 .hbm.xml 结尾的东西

> ID：142151
> 
> 赞同：4
> 
> 时间：2008-09-26T21:39:47.080
> 
> 标签：java

如何在 java 的类路径中找到资源？特别是以 .hbm.xml 结尾的东西。

我的目标是获取类路径上以“.hbm.xml”结尾的所有资源的列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-26T21:51:00.327

你必须得到一个[类加载器](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#getContextClassLoader())，并测试它是否是一个 URLClassLoader。如果是这样，请垂头丧气并[获取其 URL](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLClassLoader.html#getURLs())。从那里，将每个作为 JarFile 打开并查看其[条目](http://java.sun.com/j2se/1.5.0/docs/api/java/util/jar/JarFile.html#entries())。对每个条目应用一个[正则表达式](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html)，看看它是否是您感兴趣的。

显然，这并不快。最好给出一个在类路径中查找的名称，可能在每个类路径元素的 META-INF 目录中的标准文件名中列出，类似于[ServiceProvider 工具](http://java.sun.com/j2se/1.3/docs/guide/jar/jar.html#Service%20Provider)使用的技术。请注意，您可以在类路径中[列出所有](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassLoader.html#getResources(java.lang.String))具有给定名称的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-14T18:19:49.527

`findClasses`我们的方法`ClassLoaderUtil`可能是适应您需求的一个很好的起点。

```
public class ClassLoaderUtil {
    /**
     * Recursive method used to find all classes in a given path (directory or zip file url).  Directories
     * are searched recursively.  (zip files are
     * Adapted from http://snippets.dzone.com/posts/show/4831 and extended to support use of JAR files
     *
     * @param path   The base directory or url from which to search.
     * @param packageName The package name for classes found inside the base directory
     * @param regex       an optional class name pattern.  e.g. .*Test
     * @return The classes
     */
    private static TreeSet<String> findClasses(String path, String packageName, Pattern regex) throws Exception {
        TreeSet<String> classes = new TreeSet<String>();
        if (path.startsWith("file:") && path.contains("!")) {
            String[] split = path.split("!");
            URL jar = new URL(split[0]);
            ZipInputStream zip = new ZipInputStream(jar.openStream());
            ZipEntry entry;
            while ((entry = zip.getNextEntry()) != null) {
                if (entry.getName().endsWith(".class")) {
                    String className = entry.getName().replaceAll("[$].*", "").replaceAll("[.]class", "").replace('/', '.');
                    if (className.startsWith(packageName) && (regex == null || regex.matcher(className).matches()))
                        classes.add(className);
                }
            }
        }
        File dir = new File(path);
        if (!dir.exists()) {
            return classes;
        }

        File[] files = dir.listFiles();
        for (File file : files) {
            if (file.isDirectory()) {
                assert !file.getName().contains(".");
                classes.addAll(findClasses(file.getAbsolutePath(), packageName + "." + file.getName(), regex));
            } else if (file.getName().endsWith(".class")) {
                String className = packageName + '.' + file.getName().substring(0, file.getName().length() - 6);
                if (regex == null || regex.matcher(className).matches())
                    classes.add(className);
            }
        }
        return classes;
    }

    public static <T> List<T> instances(Class<? extends T>[] classList) {
        List<T> tList = new LinkedList<T>();
        for(Class<? extends T> tClass : classList) {
            try {
                // Only try to instantiate real classes.
                if(! Modifier.isAbstract(tClass.getModifiers()) && ! Modifier.isInterface(tClass.getModifiers())) {
                    tList.add(tClass.newInstance());
                }
            } catch (Throwable t) {
                throw new RuntimeException(t.getMessage(), t);
            }

        }

        return tList;
    }

    public static Class[] findByPackage(String packageName, Class isAssignableFrom) {
        Class[] clazzes = getClassesInPackage(packageName, null);

        if(isAssignableFrom == null) {
            return clazzes;
        } else {
            List<Class> filteredList = new ArrayList<Class>();
            for(Class clazz : clazzes) {
                if(isAssignableFrom.isAssignableFrom(clazz))
                    filteredList.add(clazz);
            }

            return filteredList.toArray(new Class[0]);
        }
    }

    /**
     * Scans all classes accessible from the context class loader which belong to the given package and subpackages.
     * Adapted from http://snippets.dzone.com/posts/show/4831 and extended to support use of JAR files
     *
     * @param packageName The base package
     * @param regexFilter an optional class name pattern.
     * @return The classes
     */
    public static Class[] getClassesInPackage(String packageName, String regexFilter) {
        Pattern regex = null;
        if (regexFilter != null)
            regex = Pattern.compile(regexFilter);

        try {
            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
            assert classLoader != null;
            String path = packageName.replace('.', '/');
            Enumeration<URL> resources = classLoader.getResources(path);
            List<String> dirs = new ArrayList<String>();
            while (resources.hasMoreElements()) {
                URL resource = resources.nextElement();
                dirs.add(resource.getFile());
            }
            TreeSet<String> classes = new TreeSet<String>();
            for (String directory : dirs) {
                classes.addAll(findClasses(directory, packageName, regex));
            }
            ArrayList<Class> classList = new ArrayList<Class>();
            for (String clazz : classes) {
                classList.add(Class.forName(clazz));
            }
                return classList.toArray(new Class[classes.size()]);
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-26T22:47:43.717

MyClass.class.getClassLoader().getResourceAsStream("Person.hbm.xml") 是查找它的一种方法。

# unit-testing - 我应该模拟哪个对象？

> ID：142179
> 
> 赞同：0
> 
> 时间：2008-09-26T21:46:44.083
> 
> 标签：unit-testing, mocking, repository-pattern

我正在写一个[存储库](http://martinfowler.com/eaaCatalog/repository.html)。获取对象是通过 DAO 完成的。创建和更新对象是通过一个 Request 对象完成的，该对象被赋予一个 RequestHandler 对象（一个[命令模式](http://en.wikipedia.org/wiki/Command_pattern)）。我没有编写 DAO、Request 或 RequestHandler，所以我无法修改它们。

我正在尝试为此存储库编写测试。我已经模拟了 DAO 和 RequestHandler。我的目标是让模拟的 RequestHandler 简单地将新的或更新的对象添加到模拟的 DAO。这将产生我正在与数据库交谈的错觉。这样，我不必为调用此存储库的所有类模拟存储库。

问题是 Request 对象是这个字符串 blob 和各种字母数字代码的 gob。我很确定 XML 也参与其中。这有点乱。另一位开发人员正在编写代码以根据所存储的对象创建 Request 对象。而且由于 RequestHandler 接收请求而不是我存储的对象，因此它无法更新模拟的 DAO。

所以问题是：我是否也要模拟请求，还是应该等到其他人，他有点慢，在我编写测试之前完成他的代码？或者在测试调用存储库的类时搞砸并模拟整个存储库？

顺便说一句，我说的“模拟”不是 NMock 意义上的，而是像用内存中的集合来伪造数据库一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T21:56:51.233

要测试存储库，我建议您对所有较低层对象使用测试替身。

要测试依赖于存储库的类，我建议您对存储库使用测试替身。

在这两种情况下，我的意思是由一些模拟库创建的测试替身（假货适用于测试，存根需要向被测对象返回一些东西，如果你真的需要模拟）。

如果您正在使用内存中的集合创建 DAO 的实现，以便在演示或测试系统中功能性地替换数据库，这与对上层的单元测试不同。我做过类似的事情，这样我就可以向人们提供原型并专注于业务对象而不是物理模型。不过，这不适用于单元测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T16:07:46.147

您可能没有创建 Web 应用程序，但您可以查看使用 Repository 的 NerdDinner 应用程序。这是一个免费的 PDF，它解释了如何使用 ASP.NET MVC 创建应用程序，可以在这里找到：[Professional ASP.NET MVC 2.0](http://www.wrox.com/WileyCDA/Section/id-321793.html)

# .net - 是否有用于 Windows / C# 开发的可嵌入 Webkit 组件？

> ID：142184
> 
> 赞同：75
> 
> 时间：2008-09-26T21:47:57.667
> 
> 标签：.net, com, webkit, gecko

我见过一些包装 Gecko 渲染引擎的 COM 控件（[GeckoFX](http://code.google.com/p/geckofx/)以及 Mozilla 提供的控件 - [mozctlx.dll](https://stackoverflow.com/questions/26147/is-it-possible-to-embed-gecko-or-webkit-in-a-cnet-win-form-just-like-a-webview)）。是否有可以包含在 .NET Winform 应用程序中的 Webkit 包装器？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-12-03T17:05:55.560

*我刚刚为Chromium Embedded Framework*发布了我的*.Net*绑定的**CefSharp**的预 alpha 版本。

 **检查出来并告诉我你的想法：[https](https://github.com/chillitom/CefSharp) ://github.com/chillitom/CefSharp （二进制库和示例可在下载页面中找到）

**更新**：发布了一个新版本，包括将 C# 对象绑定到 DOM 等的能力。

**更新 2**：不再是 alpha，lib 用于现实世界的项目，包括 Windows 版 Facebook Messenger、Rdio 的 Windows 客户端和 Windows 版 Github

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2010-02-09T08:46:11.897

尚未尝试但在 SourceForge 上找到[了 WebKit.NET](http://sourceforge.net/projects/webkitdotnet/)。它已移至[GitHub](https://github.com/webkitdotnet)。

**警告：**不再维护，最后一次提交是从 2013 年初

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-26T22:38:30.557

[Mono 的 GitHub Repository](https://github.com/mono/webkit-sharp)上有一个 WebKit-Sharp 组件。我找不到任何可在网络上查看的文档，我什至不确定它是 WinForms 还是 GTK#（目前无法从此处获取源代码进行检查），但这可能是您最好的选择方式。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-04-09T21:24:40.217

[Berkelium](http://berkelium.org/)是一个用于使 chrome 可嵌入的 C++ 工具。

[AwesomiumDotNet](http://awesomiumdotnet.codeplex.com)是[Berkelium](http://berkelium.org/)和[Awesomium的包装器](http://www.khrona.com/products/awesomium/)

顺便说一句，这里到[Awesomium](http://www.khrona.com/products/awesomium/)的链接似乎更新了。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-08-28T13:59:08.080

> Mono 的 Subversion Server 上有一个 WebKit-Sharp 组件。我找不到任何可在网络上查看的文档，我什至不确定它是 WinForms 还是 GTK#（目前无法从此处获取源代码进行检查），但这可能是您最好的选择方式。

我认为这个组件是 Ubuntu 的 webkit 的 CLI 包装器。所以这个包装器很可能无法在 win32 上运行

尝试检查另一个变体 - 项目[awesomium](http://princeofcode.com/awesomium.php#download) -使用 webkit的谷歌项目“ [Chromium ”的包装器。](http://code.google.com/intl/ru/chromium/)此外，awesomium 还具有诸如应在 WPF 下对 3D 对象进行交互网页等功能

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-09-11T15:11:02.720

OpenWebKitSharp 是 WebKit.NET 0.5 的一个分支，非常先进。详情： [http ://code.google.com/p/open-webkit-sharp/](http://code.google.com/p/open-webkit-sharp/)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-06-06T10:04:15.890

我能够使用 CefSharp （它使用[chromium browser](http://www.chromium.org/Home)）来做到这一点。

这里有几篇文章展示了这一点：

*   [在 O2 中运行 Chrome](http://diniscruz.blogspot.co.uk/2012/05/running-chome-inside-o2.html)
*   [视频：安装和运行 CefSharp（带有 WPF 浏览器的 C# Chrome）](http://diniscruz.blogspot.co.uk/2012/05/video-installing-and-running-cefsharp-c.html)
*   [视频：在 O2 和 VisualStudio 中本机运行 Chrome](http://diniscruz.blogspot.co.uk/2012/05/video-running-chrome-natively-in-o2-and.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-30T13:18:08.280

Qt 4 的 Windows 版本包括用于创建 ActiveX 组件的 WebKit 和类。如果您还没有使用 Qt，它可能不是一个理想的解决方案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-07-22T15:33:00.273

试试这个[http://code.google.com/p/geckofx/](http://code.google.com/p/geckofx/) 希望它不是欺骗或者我认为这个更好 [http://webkitdotnet.sourceforge.net/](http://webkitdotnet.sourceforge.net/)

# visual-studio - 我可以用 VS 2005 安装 Visual Studio 2008 Express 吗？

> ID：142197
> 
> 赞同：2
> 
> 时间：2008-09-26T21:50:50.657
> 
> 标签：visual-studio

我想知道他们是否可以完美地合作......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T21:52:18.717

简单的答案是肯定的——我都安装在我正在回答这个问题的机器上。:=)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T21:53:23.537

是的 VS'08 和 VS'05 安装在同一台机器上时会很好地工作。

现在，如果他们让 VS'08 中的 .NET 2.0 支持使用与 VS'05 相同的解决方案/项目文件版本号，那么您可以轻松地在同一个项目中来回移动 VS 版本而无需修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T21:52:29.997

我都在我的机器上运行，使用 2 周后一切似乎都很好......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T21:54:02.410

是的，他们一起工作得很好。有关详细信息，请参阅[MSDN 上的并排安装 Visual Studio 版本](http://msdn.microsoft.com/en-us/library/ms246609.aspx)。

您可能需要在 VS2008 之前安装 VS2005，否则您的文件关联可能最终无法正常工作。

# configuration - 您将杂项项目设置存储在哪里？

> ID：142204
> 
> 赞同：0
> 
> 时间：2008-09-26T21:52:04.413
> 
> 标签：configuration, asp.net-2.0, load-balancing

有些项目的属性有杂项设置，例如：“AllowPayments”、“ShowSideBar”、“SectionTitle”。确实不一定适合其他对象的东西。

你们如何存储这些值？应用程序设置？平面文件？数据库表？

你如何访问它们？具有属性的静态对象？数据库调用？

如果您处于必须在多个服务器之间同步文件的负载平衡环境中，这些中的任何一个都会改变吗？

**环境** ASP.NET 2.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T21:53:43.833

App.Config，或自定义 xml 配置文件和配置服务。键值对映射使事情变得非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T22:14:23.953

对我来说，这取决于设置的上下文。如果它与数据和域相关，我存储在数据库中，如果它与我存储在 web.config 中的应用程序相关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T21:54:29.133

由于您没有告诉您使用哪个环境：在 .NET 应用程序中，我使用 Visual Studio 中的 ApplicationSettings 系统。这样，您可以在设计器中使用默认值配置设置，并生成用于访问这些值的强类型类。除了默认设置之外，我通常会添加第二个名为 Persistent 的 ApplicationSettings 元素，其中包含用户配置为进入 Settings 对象的任何内容以及我刚刚保存到 Persistent 对象的任何内容（即窗口位置）。

这适用于桌面应用程序。

# c# - .NET 无法使用 Oracle 代理用户连接到 Oracle DB

> ID：142211
> 
> 赞同：0
> 
> 时间：2008-09-26T21:53:05.190
> 
> 标签：c#, oracle, odp.net

我正在针对新架构设置我的网站的测试版本。我正在尝试使用代理连接进行连接，但出现以下错误：

> ORA-28150: 代理未授权作为客户端连接

我的连接字符串具有以下形式：

> 数据源=*实例*；用户 ID=*用户*；代理用户 ID= *prxy_usr* ;代理密码= *prxy_pass* ; 最小池大小 = 0；连接超时 = 30

你知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T22:32:05.957

EddieAwad 的回答是正确的，但这里是运行的具体代码：

> ALTER USER 用户*名*GRANT CONNECT THROUGH *proxyUserName* ;

THROUGH 关键字是我在文档中找不到的部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-26T22:03:20.330

根据[文档](http://download.oracle.com/docs/cd/B28359_01/server.111/b28278/e24280.htm#ORA-28150)：使用 ALTER USER ... GRANT CONNECT 命令授予代理用户代表客户端执行操作的权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T06:08:04.143

这是[ALTER USER 文档](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_4003.htm)。您将在那里找到 CONNECT THROUGH 子句以及一些代理用户示例。

# dynamic-languages - 什么情况下不适合动态语言？

> ID：142223
> 
> 赞同：6
> 
> 时间：2008-09-26T21:54:56.870
> 
> 标签：dynamic-languages

哪些因素表明项目的解决方案不应使用动态语言进行编码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-26T22:00:09.090

程序员熟悉并愿意使用该语言。

你的动态语言可能是我的静态语言。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-26T22:00:16.907

系统级开发是一组关键的软件，通常不应该使用动态语言。（驱动程序，内核级别的东西等）。

基本上任何需要具有每一盎司性能或低级硬件访问权限的东西都应该使用低级语言。

另一个指标是它是否是高度数字运算，例如科学数据数字运算。也就是说，如果它需要快速运行并进行数字运算。

我认为一个共同的主题是处理器密集型问题......在这种情况下，您将很容易看到性能差异，并且您会发现动态语言无法让您有效地使用硬件。

也就是说，如果您正在进行处理器密集型工作并且您不介意性能受到影响，那么您仍然可以使用动态语言。

* * *

更新：

请注意，对于数字运算，我的意思是在科学领域中运行数小时或数天的真正长时间运行的数字运算......在这种情况下，2 倍的性能提升是巨大的......如果它的规模要小得多，那么动态语言仍然可以使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T00:28:44.380

在很大程度上，编程语言是一种风格选择。使用您想使用的语言，您将获得最大的生产力和快乐。如果由于某种原因这是不可能的，那么希望您的最终决定将基于一些有意义的东西，例如您必须运行的平台或真实的经验性能数字，而不是其他人的任意风格选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T23:00:41.423

显卡设备驱动

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T21:57:15.367

速度通常是主要答案。尽管这些天来这已不再是一个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-26T21:57:52.917

当速度至关重要时。动态语言的速度越来越快，但仍无法达到编译语言的性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-26T22:06:07.827

使用动态语言绝对可以实现互操作。（还记得经典的 Visual Basic，它有“延迟绑定”吗？）它需要编译 COM 组件并添加一些额外内容，以帮助调用者按名称调用。

我不认为数字运算必须是静态编译的，通常是你如何解决的问题。Matlab 是一个很好的数字运算示例，它具有非编译语言。然而，Matlab 有一个非常具体的数字和矩阵运行时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-26T22:06:40.353

我相信你应该尽可能选择静态类型的语言。我并不是说 C# 或 Java 具有良好的静态系统，但 C# 正在接近。良好的[类型推断](http://en.wikipedia.org/wiki/Type_inference)是关键，因为它会给您带来动态语言中的好处，同时仍然为您提供静态类型语言的安全性和特性。问题解决了 - 没有更多的火焰战争。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-26T22:49:22.763

嵌入式系统的系统级代码。一个可能的问题是动态语言有时会隐藏单个简单语句的性能影响。

就像说这个 Perl 语句：

```
@contents = <FILE>; 
```

如果 FILE 是几兆字节，那么这是一个消耗资源的语句——你可能会耗尽你的堆，或者导致看门狗超时，或者通常会减慢嵌入式系统的响应。

如果您想“编程更接近金属”，您可能希望使用静态类型和“中级”语言。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-26T22:01:04.487

互操作怎么样？是否可以从 Ruby 或 Python 调用 COM 组件？

# .net - 是否有基于动态语言的 .NET 构建工具？

> ID：142225
> 
> 赞同：6
> 
> 时间：2008-09-26T21:54:59.273
> 
> 标签：.net, build-automation, nant

我可能很快就会在 .NET 中开始一个新项目，并且不希望使用基于 XML 的构建工具，例如 Nant 或 MSBuild。我喜欢 Rake，但我认为拥有基于 .NET 动态语言（例如 Boo）的东西可能会更好，在精神上类似于 gant 或 Java 的 BuildR。.NET 有这样的东西吗？如果没有，你有什么推荐的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T22:26:40.087

总是有[Boo Build System](http://code.google.com/p/boo-build-system/)或简称为“Boobs”（是的，这是一个愚蠢的名字），看起来与 Rake 非常相似。

[Ayende 之前在Introducing the Boobs Build System](http://ayende.com/Blog/archive/2007/09/22/Introducing-Boobs-Boo-Build-System.aspx)中写过这方面的文章，并展示了一个很好的语法示例。

Boo 是用 C# 编写的，并且有一个非常漂亮的编译器，可以在运行时进行修改，以执行各种领域特定语言 (DSL) 技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T00:52:42.153

你真的应该看看[FinalBuilder](http://www.finalbuilder.com/)。去年我对它进行了相当多的评估，并且非常喜欢它，尽管最终我们部署了 TFS2008，因此我们使用 TeamBuild 来获得很多集成优势。但实际上，FinalBuilder 拥有大量预构建的构建活动，对许多环境和工具的强大支持，以及用于设计所有内容的出色 IDE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T19:43:49.130

你可以试试[FluentBuild](http://code.google.com/p/fluent-build)。

为了我的钱，使用 UppercuT（在后端使用 NAnt）是一个最佳解决方案，因为它可以为我做的所有事情，而无需太多工作来设置它。

[http://code.google.com/p/uppercut/](http://code.google.com/p/uppercut/)

这里有一些很好的解释：[Uppercut](http://ferventcoder.com/category/10094.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-27T10:18:56.630

您应该尝试**NUBuild**。

我定期使用它，并且我需要在每次代码更改/发布时构建大约 75 个项目。NUBuild 速度极快，易于设置（您只需执行一次），并通过让您进行“本地构建”，为您提供触手可及的完整构建服务器的强大功能。它还具有许多其他高级特性和功能。您可以在项目站点（在 codeplex 上）找到更多详细信息：

[http://nubuild.codeplex.com/](http://nubuild.codeplex.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T22:01:16.623

我还没有听说过类似的东西，但也许您可以将 Rake 移植到 IronRuby，然后扩展它以了解构建 C#/VB.NET 和运行其他 .NET 工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-26T22:30:49.483

只有在行业标准构建系统不做您需要的事情时，您*才*应该真正使用非行业标准构建系统。是否有一些 Nant/Msbuild 未提供您期望需要的功能？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-05T16:39:46.160

既然你提到它，我刚刚开始使用 IronRuby 并参与当前的项目。因为我不希望我的团队必须安装 MRI，所以我决定使用预先加载了 rake 的 IronRuby 的 xcopy 部署。不确定这是否正是您所追求的，但请查看我关于早期发现的博客文章。

[http://dylandoesdigits.blogspot.com/2009/11/rake-for-net-projects.html](http://dylandoesdigits.blogspot.com/2009/11/rake-for-net-projects.html)

我认为它符合您的要求。.NET 基于动态语言运行时，没有 XML。作为当前 msbuild 尖括号的共同受苦者，我对到目前为止所做的工作很少感到非常满意。

# svn - 在构建中集成外部源

> ID：142237
> 
> 赞同：3
> 
> 时间：2008-09-26T21:57:52.090
> 
> 标签：svn, build, nant

在我工作的地方，我在不同的存储库中有几个项目。每个项目都共享许多我想提取到不同项目中的通用代码。我正在考虑使用以下方案调用该项目：Company.Department.Common 或 Company.Department.Utility。

我为此构建了一个项目，它有一个自动构建脚本（与其他所有项目一样）。

我的问题是我想重构我现有的项目以依赖这个新项目。一种非常基本但不完全是我正在寻找的方法是简单地构建我的实用程序项目，将 DLL 复制到我的消费项目中的我的 lib 文件夹中，然后将该 DLL 与该消费项目一起签入。

我个人觉得这个方法很差。我想参考我的 Utility 项目，并将在构建消费项目之前执行 svn-update 和构建 Utility 项目。

仅供参考，Utlity 项目中的代码类型是 Logging 设施、BDD 单元测试类、IoC 设施和 Common Company.Department 重点类。

希望我的问题不是太含糊，但有了一些答案，我也许可以将注意力集中在我想做的事情上。

最后，这适用于 .Net 项目并使用 NAnt 作为构建脚本，使用 svn 进行代码版本控制。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-26T22:07:52.427

Greg 是对的，因为您可能想要使用 svn:external 功能。我创建了一个关于如何使用 TortoiseSVN 在 Windows 上执行此操作的分步指南。我第一次使用它时发现它很混乱。我创建了指南，以便我可以查找它，因为我不会一直这样做。

[在 Windows 中使用 svn:externals](http://systemwidgets.com/Support/SubversionArticles/SharedRepositoriesusingsvnexternals/tabid/81/Default.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T22:03:17.460

你检查过[svn:externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)功能吗？这允许您使不同的存储库显示为更高级别存储库的子目录。如果我了解您要做什么，这可能会有所帮助。

# language-agnostic - 您将如何存储和查询营业时间？

> ID：142239
> 
> 赞同：5
> 
> 时间：2008-09-26T21:58:15.350
> 
> 标签：language-agnostic, datetime, time, time-management

我们正在构建一个应用程序来存储各种企业的“营业时间”。表示此数据的最简单方法是什么，以便您可以轻松检查项目是否打开？

一些选项：

*   分割出可以标记为“打开/关闭”的块（每 15 分钟一次）。检查涉及查看“打开”位是否设置为所需时间（有点像火车时刻表）。
*   存储时间范围列表（11am-2pm、5-7pm 等）并检查当前时间是否在任何指定范围内（这是我们的大脑在解析上述字符串时所做的事情）。

有没有人有存储和查询时间表信息的经验和任何建议？

（有各种疯狂的极端案例，比如“本月的第一个星期二关闭”，但我们将把它留到另一天）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T22:05:57.313

将每个连续的时间块存储为开始时间和持续时间；这样可以更轻松地检查时间跨日期边界的时间

如果您确定营业时间永远不会跨越日期界限（即永远不会有通宵销售或 72 小时马拉松赛事等），那么开始/结束时间就足够了

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-26T22:06:10.587

最灵活的解决方案可能是使用 bitset 方法。一周有 168 个小时，所以有 672 个 15 分钟的时段。那只是 84 字节的空间，这应该是可以容忍的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-26T23:15:06.523

我会使用这样的表格：

```
BusinessID | weekDay | OpenTime | CloseTime 
---------------------------------------------
     1          1        9           13
     1          2        5           18
     1          3        5           18
     1          4        5           18
     1          5        5           18
     1          6        5           18
     1          7        5           18 
```

在这里，我们有一家营业时间为 5 到 6 点的企业，但周日的营业时间较短。

如果打开的查询将是（psuedo-sql）

```
SELECT @isOpen = CAST
   (SELECT 1 FROM tblHours 
       WHERE BusinessId = @id AND weekDay = @Day 
       AND CONVERT(Currentime to 24 hour) IS BETWEEN(OpenTime,CloseTime)) AS BIT; 
```

如果您需要存储边缘情况，那么只需要有 365 个条目，每天一个……在宏伟的计划中确实没有那么多，在 day 列和 businessId 列上放置一个索引。

不要忘记将企业时区存储在单独的表中（标准化！），并在进行这些比较之前在您的时间和它之间执行转换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T23:09:02.230

我想我个人会选择开始+结束时间，因为它会使一切变得更加灵活。一个很好的问题是：块大小在某个点发生变化的可能性有多大？然后选择最适合您情况的解决方案（如果它可能会改变，我肯定会选择时间跨度）。

您可以将它们存储为时间跨度，并在应用程序中使用段。这样，您就可以使用块轻松输入，同时保持数据存储更改的灵活性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-26T23:31:18.137

为了补充 Johnathan Holland[所说](https://stackoverflow.com/questions/142239/how-would-you-store-and-query-hours-of-operation#142460)的，我将允许同一天有多个条目。

我也将允许十进制时间，或分钟的另一列。

为什么？许多餐馆和一些企业，以及世界各地的许多企业都有午餐和/或下午休息时间。此外，许多餐厅（据我所知，我家附近的 2 家餐厅在奇怪的非 15 增量时间关闭。一家在周日晚上 9:40 关门，一家在凌晨 1:40 关门。

还有假期时间的问题，例如感恩节提前关门的商店，所以你需要有基于日历的覆盖。

也许可以做的是日期/时间打开，日期时间关闭，例如：

```
businessID  | datetime              | type
==========================================
        1     10/1/2008 10:30:00 AM    1
        1     10/1/2008 02:45:00 PM    0
        1     10/1/2008 05:15:00 PM    1
        1     10/2/2008 02:00:00 AM    0
        1     10/2/2008 10:30:00 AM    1 
```

等（类型：1打开，0关闭）

并提前1-2年预先计算未来1或2年的所有日子。请注意，您将只有 3 列：int、日期/时间/位，因此数据消耗应该是最小的。

这也将允许您修改特殊日子的奇数小时的特定日期，因为它们是众所周知的。

它还负责跨越午夜以及 12/24 小时转换。

它也与时区无关。如果您存储开始时间和持续时间，当您计算结束时间时，您的机器是否会给您调整 TZ 的时间？那是你要的吗？更多代码。

至于查询开闭状态：查询有问题的日期时间，

```
select top 1 type from thehours where datetimefield<=somedatetime and businessID = somebusinessid order by datetime desc 
```

然后看“类型”。如果为1，则为打开，如果为0，则为关闭。

PS：我从事零售业 10 年。所以我熟悉小企业的疯狂工作时间问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-19T06:45:50.803

好的，我会为此付出代价。

我需要处理很多事情。

*   快速/高性能查询
*   任何时间增量，晚上 9:01、12:14 等。
*   国际（？） - 不确定这是否是时区的问题，至少在我的情况下，但更精通这里的人可以随意插话
*   打开 - 关闭到第二天（中午开放，凌晨 2:00 关闭）
*   多个时间跨度/天
*   能够覆盖特定日期（节假日等）
*   覆盖重复发生的能力
*   能够查询任何时间点并使业务开放（现在、未来时间、过去时间）
*   能够轻松排除即将关闭的企业的结果（过滤在 30 分钟内关闭的企业，您不想让您的用户成为在食品/饮料行业关闭前 5 分钟出现的那个人）

我喜欢很多提出的方法，我从其中一些方法中借鉴。在我的网站、项目中，无论我需要考虑什么，我都可能拥有数百万家企业，而这里的一些方法对我个人来说似乎并不能很好地扩展。

这是我对算法和结构的建议。

我们必须在全球任何地方、任何时间做出一些具体的假设：一周有 7 天。一天有1440分钟。可能的打开/关闭分钟数的排列是有限的。

不具体但体面的假设：开放/关闭分钟的许多排列将在企业之间共享，从而减少实际存储的总排列。在我的生活中有一段时间，我可以很容易地计算出这种方法的实际可能组合，但如果有人可以提供帮助/认为它会有用，那就太好了。

我建议 3 个表：在您停止阅读之前，请考虑在现实世界中，这些表中的 2 个将足够小且整齐地缓存。这种方法也不适合所有人，因为将 UI 解释为数据模型并在需要时再次返回所需的代码非常复杂。您的里程和需求可能会有所不同。这是对合理的“企业”级解决方案的尝试，无论这意味着什么。

营业时间表

身份证 | 开盘（一天中的分钟）| 关闭（一天中的分钟）

* * *

1 | 360 | 1020（例如：上午 9 点 - 下午 5 点）

2 | 365 | 1021（例如：边缘情况 9:05 AM - 5:01 PM（怪异））

等等

HoursOfOperations 不关心什么日子，只关心打开和关闭和唯一性。每个打开/关闭组合只能有一个条目。现在，根据您的环境，可以缓存整个表，也可以缓存当天的当前时间，等等。无论如何，您不需要为每个操作查询此表。根据您的存储解决方案，我设想此表中的每一列都作为性能索引。随着时间的推移，该表可能具有 INSERT(s) 的指数倒数可能性。实际上，处理这个表应该主要是一个进程内操作（RAM）。

Business2Hours地图

注意：在我的示例中，我将“Day”存储为位标志字段/列。这主要是由于我的需要和 C# 中 LINQ / Flags Enums 的进步。没有什么能阻止您将此扩展到 7 位字段。两种方法在存储逻辑和查询方法上都应该相对相似。

另一个注意事项：我没有进入关于“每个表都需要一个 PK ID 列”的语义论点，请为此查找另一个论坛。

商号 | 营业时间ID | 日（或者，如果您更愿意拆分为：BIT 星期一、BIT 星期二，...）

* * *

1 | 1 | 1111111（此业务每周9-5开放）

2 | 2 | 1111110（此业务开放时间为 9:05 - 5:01 M-Sat（星期一 = 第 1 天）

这很容易查询的原因是我们总是可以很容易地确定我们所追求的 MOTD（一天中的分钟）。如果我想知道明天下午 5 点开放什么，我会获取所有 HoursOfOperations IDS WHERE Close >= 1020。除非我正在寻找时间范围，否则 Open 变得无关紧要。如果您不想显示在接下来的半小时内关闭的商家，只需相应地调整您的传入时间（搜索 5:30 PM (1050)，而不是 5:00 PM (1020)。第二个查询自然是 '用 HoursID IN (1, 2, 3, 4, 5) 等给我所有业务。这可能会引发危险信号，因为这种方法存在局限性。但是，如果有人可以回答上面的实际排列问题，我们可能会能够拉下红旗。考虑到我们一次只需要等式任意一侧的可能排列，

考虑到我们已经缓存了第一个表，这是一个快速的操作。第二个操作是查询这个潜在的大行表，但我们正在搜索非常小的 (SMALLINT) 希望索引列。

现在，您可能会看到代码方面的复杂性。我主要针对我的特定项目中的酒吧，因此可以非常安全地假设我将拥有大量营业时间，例如“11:00 AM - 2:00 AM（第二天）”。这确实是 HoursOfOperations 表和 Business2HoursMap 表中的 2 个条目。例如，从上午 11:00 - 凌晨 2:00 营业的酒吧将有 2 次参考 HoursOfOperations 表 660 - 1440（上午 11:00 - 午夜）和 0 - 120（午夜 - 凌晨 2:00）。这些引用将反映到 Business2HoursMap 表中的实际天数中，在我们的简单案例中作为 2 个条目，1 个条目 = 所有天小时参考 #1，另一个全天参考 #2。希望这是有道理的，这是漫长的一天。

在特殊的日子/假期/任何事情上都可以覆盖。覆盖本质上是基于日期的，而不是基于星期几的。我认为这就是一些方法试图将众所周知的圆形钉子推入方孔的地方。我们需要另一张桌子。

营业时间ID | 商号 | 天 | 月 | 年

1 | 2 | 1 | 1 | 空值

如果您需要“每个第二个星期二，这家公司钓鱼 4 小时”之类的东西，这肯定会变得更加复杂。然而，这将让我们很容易做到的是允许 1 - 覆盖，2 - 合理的重复覆盖。例如，如果 year IS NULL，那么每年元旦这个怪异酒吧的营业时间为上午 9:00 到下午 5:00，与我们上面的数据示例保持一致。即 - 如果设置了年份，则仅适用于 2013 年。如果月份为空，则为每月的第一天。同样，这不会仅通过 NULL 列处理每个调度方案，但理论上，如果需要，您可以通过依赖一长串绝对日期来处理几乎任何事情。

同样，我将在滚动日的基础上缓存此表。我只是无法在单日快照中实际看到该表的行非常大，至少对于我的需要而言。我会首先检查这个表，因为它是一个覆盖，并将保存一个针对存储端更大的 Business2HoursMap 表的查询。

有趣的问题。我真的很惊讶这是我第一次真正需要考虑这个问题。一如既往，非常热衷于我的方法中的不同见解、方法或缺陷。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-26T22:20:53.533

段块更好，只要确保你给用户一个简单的方法来设置它们。单击并拖动很好。

当您越过午夜边界时，任何其他系统（如范围）都会非常烦人。

至于如何存储它们，C++ 位域可能是最好的。在大多数其他语言中，数组可能会更好（浪费了大量空间，但运行速度更快，更容易理解）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-26T23:12:38.527

我现在会考虑一下这些边缘情况，因为它们会告知您是否有基本配置加上覆盖或开放时间的完整静态存储或其他。

有很多例外 - 并且定期（如下雪天，复活节等不规则假期，耶稣受难日），如果预计这是现实的可靠表示（而不是一个好的猜测），你需要很快在架构中解决它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T00:12:04.513

像这样的东西怎么样：

营业时间表

```
Business_id (int)
Start_Time (time)
End_Time (time)
Condition varchar/string
Open bit 
```

'Condition' 是一个 lambda 表达式（'where' 子句的文本）。动态构建查询。因此，对于特定业务，您可以选择所有的开/关时间

```
Let Query1 = select count(open) from store_hours where @t between start_time and end_time and open  = true and business_id = @id and (.. dynamically built expression)

Let Query2 = select count(closed) from store_hours where @t between start_time and end_time and open = false and business_id = @id and (.. dynamically built expression) 
```

所以结束你想要的结果：

```
select cast(Query1 as bit) & ~cast(Query2 as bit) 
```

如果最后一个查询的结果为 1，则商店在时间 t 开放，否则关闭。

现在您只需要一个可以为您生成 where 子句（lambda 表达式）的友好界面。

我能想到的唯一另一个极端情况是，如果一家商店在某个日期从早上 7 点营业到凌晨 2 点，但在下一个日期晚上 11 点关门，会发生什么情况。您的系统也应该能够通过巧妙地划分两天之间的时间来处理这个问题。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-26T22:23:51.327

这里肯定不需要节省内存，但可能需要干净且易于理解的代码。恕我直言，“有点玩弄”不是要走的路。

我们在这里需要一个集合容器，它包含任意数量的唯一项目，并且可以快速轻松地确定一个项目是否是成员。设置需要小心，但在日常使用中，一行简单易懂的代码决定了您是打开还是关闭

概念：从例如周日午夜开始，为每 15 分钟的区块分配索引号。

初始化：在打开时将每 15 分钟块的索引号插入一个集合。（假设您的营业时间少于关闭时间。）

使用：减去有趣的时间，以分钟为单位，减去前一个星期天的午夜，然后除以 15。如果这个数字出现在集合中，那么你是开放的。

# c++ - Explicit code parallelism in c++

> ID：142240
> 
> 赞同：3
> 
> 时间：2008-09-26T21:58:35.677
> 
> 标签：c++, performance, design-patterns

Out of order execution in CPUs means that a CPU can reorder instructions to gain better performance and it means the CPU is having to do some very nifty bookkeeping and such. There are other processor approaches too, such as hyper-threading.

Some fancy compilers understand the (un)interrelatedness of instructions to a limited extent, and will automatically interleave instruction flows (probably over a longer window than the CPU sees) to better utilise the processor. Deliberate compile-time interleaving of floating and integer instructions is another example of this.

Now I have highly-parallel task. And I typically have an ageing single-core x86 processor without hyper-threading.

Is there a straight-forward way to get my the body of my 'for' loop for this highly-parallel task to be interleaved so that two (or more) iterations are being done together? (This is slightly different from 'loop unwinding' as I understand it.)

My task is a 'virtual machine' running through a set of instructions, which I'll really simplify for illustration as:

```
void run(int num) {
  for(int n=0; n<num; n++) {
     vm_t data(n);
     for(int i=0; i<data.len(); i++) {
        data.insn(i).parse();
        data.insn(i).eval();
     }
  }  
}
```

So the execution trail might look like this:

```
data(1) insn(0) parse
data(1) insn(0) eval
data(1) insn(1) parse
...
data(2) insn(1) eval
data(2) insn(2) parse
data(2) insn(2) eval
```

Now, what I'd like is to be able to do two (or more) iterations explicitly in parallel:

```
data(1) insn(0) parse
data(2) insn(0) parse  \ processor can do OOO as these two flow in
data(1) insn(0) eval   /
data(2) insn(0) eval   \ OOO opportunity here too
data(1) insn(1) parse  /
data(2) insn(1) parse
```

I know, from profiling, (e.g. using Callgrind with --simulate-cache=yes), that parsing is about random memory accesses (cache missing) and eval is about doing ops in registers and then writing results back. Each step is several thousand instructions long. So if I can intermingle the two steps for two iterations at once, the processor will hopefully have something to do whilst the cache misses of the parse step are occurring...

Is there some c++ template madness to get this kind of explicit parallelism generated?

Of course I can do the interleaving - and even staggering - myself in code, but it makes for much less readable code. And if I really want unreadable, I can go so far as assembler! But surely there is some pattern for this kind of thing?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T00:05:44.077

Given optimizing compilers and pipelined processors, I would suggest you just write clear, readable code.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-26T22:06:00.260

Your best plan may be to look into [OpenMP](http://openmp.org). It basically allows you to insert "pragmas" into your code which tell the compiler how it can split between processors.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-26T22:09:26.960

Hyperthreading is a much higher-level system than instruction reordering. It makes the processor look like two processors to the operating system, so you'd need to use an actual threading library to take advantage of that. The same thing naturally applies to multicore processors.

If you don't want to use low-level threading libraries and instead want to use a task-based parallel system (and it sounds like that's what you're after) I'd suggest looking at [OpenMP](http://www.openmp.org/) or Intel's [Threading Building Blocks](http://www.threadingbuildingblocks.org/).

TBB is a library, so it can be used with any modern C++ compiler. OpenMP is a set of compiler extensions, so you need a compiler that supports it. GCC/G++ will from verion 4.2 and newer. Recent versions of the Intel and Microsoft compilers also support it. I don't know about any others, though.

EDIT: One other note. Using a system like TBB or OpenMP will scale the processing as much as possible - that is, if you have 100 objects to work on, they'll get split about 50/50 in a two-core system, 25/25/25/25 in a four-core system, etc.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-26T22:10:05.213

Modern processors like the Core 2 have an *enormous* instruction reorder buffer on the order of nearly 100 instructions; even if the compiler is rather dumb the CPU can still make up for it.

The main issue would be if the code used a lot of registers, in which case the register pressure could force the code to be executed in sequence even if theoretically it could be done in parallel.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-26T22:13:20.180

There is no support for parallel execution in the current C++ standard. This will change for the next version of the standard, due out next year or so.

However, I don't see what you are trying to accomplish. Are you referring to one single-core processor, or multiple processors or cores? If you have only one core, you should do whatever gets the fewest cache misses, which means whatever approach uses the smallest memory working set. This would probably be either doing all the parsing followed by all the evaluation, or doing the parsing and evaluation alternately.

If you have two cores, and want to use them efficiently, you're going to have to either use a particularly smart compiler or language extensions. Is there one particular operating system you're developing for, or should this be for multiple systems?

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-26T22:47:13.923

It sounds like you ran into the same problem chip designers face: Executing a single instruction takes a lot of effort, but it involves a bunch of different steps that can be strung together in an [execution pipeline](http://en.wikipedia.org/wiki/Pipeline_(computing)). (It is easier to execute things in parallel when you can build them out of separate blocks of hardware.)

The most obvious way is to split each task into different threads. You might want to create a single thread to execute each instruction to completion, or create one thread for each of your two execution steps and pass data between them. In either case, you'll have to be very careful with how you share data between threads and make sure to handle the case where one instruction affects the result of the following instruction. Even though you only have one core and only one thread can be running at any given time, your operating system should be able to schedule compute-intense threads while other threads are waiting for their cache misses.

(A few hours of your time would probably pay for a single very fast computer, but if you're trying to deploy it widely on cheap hardware it might make sense to consider the problem the way you're looking at it. Regardless, it's an interesting problem to consider.)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-29T22:28:29.277

Take a look at [cilk](http://supertech.csail.mit.edu/cilk/). It's an extension to ANSI C that has some nice constructs for writing parallelized code in C. However, since it's an extension of C, it has very limited compiler support, and can be tricky to work with.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T12:44:45.413

*This answer was written assuming the questions does not contain the part "And I typically have an ageing single-core x86 processor without hyper-threading.". I hope it might help other people who want to parallelize highly-parallel tasks, but target dual/multicore CPUs.*

As already posted in [another answer](https://stackoverflow.com/questions/142240/explicit-code-parallelism-in-c#142277), OpenMP is a portable way how to do this. However my experience is OpenMP overhead is quite high and it is very easy to beat it by rolling a DIY (Do It Youself) implementation. Hopefully OpenMP will improve over time, but as it is now, I would not recommend using it for anything else than prototyping.

Given the nature of your task, What you want to do is most likely a data based parallelism, which in my experience is quite easy - the programming style can be very similar to a single-core code, because you know what other threads are doing, which makes maintaining thread safety a lot easier - an approach which worked for me: avoid dependencies and call only thread safe functions from the loop.

To create a DYI OpenMP parallel loop you need to:

*   as a preparation create a serial for loop template and change your code to use functors to implement the loop bodies. This can be tedious, as you need to pass all references across the functor object
*   create a virtual JobItem interface for the functor, and inherit your functors from this interface
*   create a thread function which is able process individual JobItems objects
*   create a thread pool of the thread using this thread function
*   experiment with various synchronizations primitives to see which works best for you. While semaphore is very easy to use, its overhead is quite significant and if your loop body is very short, you do not want to pay this overhead for each loop iteration. What worked great for me was a combination of manual reset event + atomic (interlocked) counter as a much faster alternative.
*   experiment with various JobItem scheduling strategies. If you have long enough loop, it is better if each thread picks up multiple successive JobItems at a time. This reduces the synchronization overhead and at the same time it makes the threads more cache friendly. You may also want to do this in some dynamic way, reducing the length of the scheduled sequence as you are exhausting your tasks, or letting individual threads to steal items from other thread schedules.

# mysql - 从 MySQL 中的表中选择随机行的最佳方法是什么？

> ID：142242
> 
> 赞同：9
> 
> 时间：2008-09-26T21:58:42.167
> 
> 标签：mysql, random

> **可能重复：**
> [从mysql中的大表中快速选择随机行](https://stackoverflow.com/questions/211329/quick-selection-of-a-random-row-from-a-large-table-in-mysql)

我已经看到使用这样的查询拉取随机行，这对于大型数据集来说效率很低。

```
SELECT id FROM table ORDER BY RANDOM() LIMIT 1 
```

我还看到了其他各种不适用于 MySQL 的特定于 RDBMS 的解决方案。

我能想到的最好的事情是使用两个查询并做这样的事情。

1.  获取表中的行数。MyISAM 表存储行数，因此速度非常快。
2.  计算 0 和 rowcount - 1 之间的随机数。
3.  选择按主键排序的行，LIMIT randnum, 1

这是SQL：

```
SELECT COUNT(*) FROM table;
SELECT id FROM table LIMIT randnum, 1; 
```

有没有人有更好的主意？

# c# - 测试浮点数是否为整数

> ID：142252
> 
> 赞同：20
> 
> 时间：2008-09-26T22:00:38.650
> 
> 标签：c#, floating-point, numerical

此代码有效（C# 3）

```
double d;
if(d == (double)(int)d) ...; 
```

1.  有一个更好的方法吗？
2.  出于无关的原因，我想避免双重演员；除了这个还有什么好的方法吗？（即使它们不是那么好）

*注意：*有几个人指出了（重要的）一点，即 == 在重新调整浮点时经常会出现问题。在这种情况下，我希望值在 0 到几百之间，并且它们应该是整数（非整数是错误），所以如果这些点“不应该”对我来说是个问题。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-26T22:03:10.533

```
d == Math.Floor(d) 
```

换句话说，做同样的事情。

注意：希望您知道在做这种事情时必须非常小心；浮点数/双精度数很容易累积微小的错误，导致精确比较（如这个）无缘无故地失败。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-26T22:10:33.807

我认为这会起作用：

```
if (d % 1 == 0) {
  //...
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-26T22:08:02.767

如果你的双精度是另一个计算的结果，你可能想要这样的东西：

```
d == Math.Floor(d + 0.00001); 
```

这样，如果有轻微的舍入误差，它仍然会匹配。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-26T22:12:27.187

我无法回答问题的特定于 C# 的部分，但我必须指出您可能遗漏了浮点数的一般问题。

一般来说，整数在浮点数上没有很好的定义。出于同样的原因，在浮点数上没有很好地定义相等性。浮点计算通常包括舍入误差和表示误差。

例如，`1.1 + 0.6 != 1.7`。

是的，这就是浮点数的工作方式。

在这里，`1.1 + 0.6 - 1.7 == 2.2204460492503131e-16`。

严格来说，你可以用浮点数做的最接近相等比较的事情是将它们*与选择的精度*进行比较。

如果这还不够，您必须使用十进制数表示、具有内置错误范围的浮点数表示或符号计算。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-26T22:15:32.313

如果您只是要转换它，Mike F / Khoth 的回答很好，但不能完全回答您的问题。如果您要进行实际测试，并且它实际上很重要，我建议您实施一些包含误差范围的方法。

例如，如果您正在考虑金钱并且想要测试美元金额，您可能会说（遵循 Khoth 的模式）：

```
if( Math.abs(d - Math.Floor(d + 0.001)) < 0.001) 
```

换句话说，取值与它的整数表示之差的绝对值，并确保它很小。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-21T22:35:47.180

对于任何固定精度的 FP 数，诸如“x == floor(x)”之类的简单测试在数学上可以保证正常工作。

所有合法的固定精度 FP 编码都表示不同的实数，因此对于每个整数 x，至多有一个与它完全匹配的固定精度 FP 编码。

因此，对于可以以这种方式表示的每个整数 x，我们必然有 x == floor(x)，因为 floor(x) 根据定义返回最大的 FP 数 y，使得 y <= x 并且 y 表示整数；所以 floor(x) 必须返回 x。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-26T22:03:10.457

你不需要额外的（双）在那里。这有效：

```
if (d == (int)d) {
 //...
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-26T22:05:17.063

使用 Math.Truncate()

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-26T22:50:13.557

这将让您选择您正在寻找的精度，加上或减去半个刻度，以考虑浮点漂移。比较也是不可或缺的，这很好。

```
static void Main(string[] args)
{
    const int precision = 10000;

    foreach (var d in new[] { 2, 2.9, 2.001, 1.999, 1.99999999, 2.00000001 })
    {
        if ((int) (d*precision + .5)%precision == 0)
        {
            Console.WriteLine("{0} is an int", d);
        }
    }
} 
```

输出是

```
2 is an int
1.99999999 is an int
2.00000001 is an int 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-26T22:04:20.797

像这样的东西

```
double d = 4.0;
int i = 4;

bool equal = d.CompareTo(i) == 0; // true 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-28T17:05:19.853

你能用这个吗

```
 bool IsInt(double x)
    {
        try
        {
            int y = Int16.Parse(x.ToString());
            return true;
        }
        catch 
        {
            return false;
        }
    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-18T20:32:36.523

为了处理双精度...

```
Math.Abs(d - Math.Floor(d)) <= double.Epsilon 
```

考虑以下情况，其中**小于 double.Epsilon**的值无法比较为零。

```
// number of possible rounds
const int rounds = 1;

// precision causes rounding up to double.Epsilon
double d = double.Epsilon*.75;

// due to the rounding this comparison fails
Console.WriteLine(d == Math.Floor(d));

// this comparison succeeds by accounting for the rounding
Console.WriteLine(Math.Abs(d - Math.Floor(d)) <= rounds*double.Epsilon);

// The difference is double.Epsilon, 4.940656458412465E-324
Console.WriteLine(Math.Abs(d - Math.Floor(d)).ToString("E15")); 
```

# c - 在代码中修改 __FILE__ 和 __LINE__ 以进行引用？

> ID：142261
> 
> 赞同：2
> 
> 时间：2008-09-26T22:03:06.243
> 
> 标签：c, templates, c-preprocessor

有没有办法让 C/C++ 预处理器或模板等对 __FILE__ 和 __LINE__ 以及其他一些外部输入（如内部版本号）进行处理/散列到可以在日志或错误消息中引用的单个短数字中？

（目的是当客户在错误报告中引用它时，能够在需要时将其反转（如果它有损，则为候选列表）。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T22:22:26.773

您将不得不使用一个函数来执行散列并从中创建代码`__LINE__`，`__FILE__`因为 C 预处理器无法执行如此复杂的任务。

[无论如何，您可以从这篇文章](http://www.decompile.com/cpp/faq/file_and_line_error_string.htm)中获得灵感，看看是否有不同的解决方案更适合您的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T22:20:10.943

好吧，如果您自己向用户显示消息（而不是让系统显示崩溃地址或功能），那么没有什么可以阻止您准确显示您想要的内容。

例如：

```
typedef union ErrorCode {
    struct {
        unsigned int file: 15;
        unsigned int line: 12; /* Better than 5 bits, still not great
                                  Thanks commenters!! */
        unsigned int build: 5;
    } bits;
    unsigned int code;
} ErrorCode;

unsigned int buildErrorCodes(const char *file, int line, int build)
{
    ErrorCode code;
    code.bits.line=line   & ((1<<12) - 1);
    code.bits.build=build & ((1<< 5) - 1);
    code.bits.file=some_hash_function(file) & ((1<<15) - 1);

    return code.code;
} 
```

你会用它作为

```
buildErrorCodes(__FILE__, __LINE__, BUILD_CODE) 
```

并以十六进制输出。解码不会太难...

（已编辑 - 评论者是正确的，我一定是疯了，为行号指定 5 位。模 4096，但是，带有错误消息的行不太可能发生冲突。构建的 5 位仍然很好 - 模 32 意味着只有 32 个构建可以突出并且错误仍然发生在同一行。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T22:25:03.757

嗯......你可以使用类似的东西：

```
((*(int*)__FILE__ && 0xFFFF0000) | version << 8 | __LINE__ ) 
```

它不会是完全独特的，但它可能适用于您想要的。可以将这些 OR 更改为 +，这可能对某些事情更有效。

自然，如果您实际上可以创建哈希码，您可能会想要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T22:33:00.383

我在我的一个项目中需要序列值，并通过制作一个专门用于`__LINE__`并`__FILE__`导致 int 的模板以及为它的输入生成（作为编译时输出到标准输出）模板专业化来获得它们，从而导致行号那个模板。这些是第一次通过编译器收集，然后转储到代码文件中，然后再次编译程序。那时，使用模板的每个位置都有不同的编号。

（在 D 中完成，因此在 C++ 中可能无法实现）

```
template Serial(char[] file, int line)
{
    prgams(msg, 
    "template Serial(char[] file : \"~file~"\", int line : "~line.stringof~")"
      "{const int Serial = __LINE__;");
    const int Serial = -1;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T22:35:41.937

一个更简单的解决方案是保留一个全局静态“错误位置”变量。

```
#ifdef DEBUG
#define trace_here(version) printf("[%d]%s:%d {%d}\n", version, __FILE__, __LINE__, errloc++);
#else
#define trace_here(version) printf("{%lu}\n", version<<16|errloc++);
#endif 
```

或者没有 printf.. 每次越过跟踪点时只需增加 errloc。然后，您可以很容易地将值与调试版本吐出的行/编号/版本相关联。

您需要包含版本或内部版本号，因为这些错误位置可能会随着任何版本的变化而改变。

如果您无法重现代码路径，则效果不佳。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T21:04:55.187

__FILE__ 是指向程序常量段的指针。如果你输出它和其他一些常数之间的差异，你应该得到一个独立于任何重定位等的结果：

```
extern const char g_DebugAnchor;
#define FILE_STR_OFFSET (__FILE__ - &g_DebugAnchor) 
```

然后你可以报告它，或者以某种方式将它与行号等结合起来。FILE_STR_OFFSET 的中间位可能是最有趣的。

# browser - 基于 http 请求在 Web 应用程序中检测移动浏览器的标准方法

> ID：142273
> 
> 赞同：59
> 
> 时间：2008-09-26T22:04:23.167
> 
> 标签：browser, mobile, enterprise, web-applications

我们开始为企业电子商务 web 应用程序（基于 Java/Servlet）提供移动浏览器支持。当然有很多决定要做，但在我看来，基石是能够可靠地检测移动浏览器，并相应地决定要返回的内容。是否有一种标准方法可以根据 http 请求（快速）做出此决定，并理想地收集有关发出请求的给定浏览器和设备的更多信息（屏幕大小、html 功能等？）。

我也很感谢那些走这条路的人提供的任何补充信息，这些人已经走上了采用现有大型企业 web 应用程序并从开发方面构建移动浏览器支持的道路。

[编辑] 我当然理解请求标头和有关标准用户代理数据库的信息是一个很大的帮助。对于那些谈论“其他”请求标头属性的人，如果您可以包含类似的标准化名称/值资源，那将是一个很大的帮助。

[编辑] 一些用户提出了解决方案，这些解决方案涉及通过网络调用某些将进行检测的 Web 服务。虽然我确信这可行，但它对于企业电子商务网站来说并不是一个好的解决方案，原因有两个：1）速度。对第三方的每个页面请求都通过网络调用会产生巨大的性能影响。2) 依赖/合法。我们会将我们的网站响应时间和关键功能与他们的服务联系起来，出于法律和风险原因，这很糟糕。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-09-26T22:07:07.670

标准方法不是检查用户代理吗？这是可用于检测移动浏览器[的用户代理数据库。](http://wurfl.sourceforge.net/)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-04T00:13:27.973

@David 的回答提到使用 WURFL——这可能是你最好的选择。但是请注意，成功率通常在 60% 左右（根据我和其他人的经验）。随着运营商不断更改 UA 以及现有设备配置文件的数量（60,000+ ？），没有万无一失的方法可以获取您想要的所有正确数据。

在严重依赖设备数据库之前，请稍加警告。我会尝试通过允许他们更改会话选项来保持用户的选项打开，以防我猜错了。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-09-03T00:13:22.703

您可以使用**[Modernizer](http://www.modernizr.com/)**来检测浏览器功能

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-26T22:17:21.327

虽然您可以通过它的用户代理检测移动浏览器，但 PC 平台上的浏览器大战表明，嗅探用户代理并不是一件好事。

理想情况下，应该根据媒体类型应用特定样式，或者应该根据用户代理以外的标头发送不同的答案 - 例如接受标头，它告诉浏览器喜欢哪种内容.

现在，通过浏览器嗅探编写一个与 iPhone 和 Opera 兼容的网站可能就足够了——但谷歌的 Android 即将到来，在不久的将来，还有许多其他手机将拥有接近 iPhone 的浏览器功能从头开始开发一个不支持这些设备的移动网站将是一种浪费。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-08-25T11:56:40.473

经过几天寻找检测移动设备的正确方法后，我决定保持简单[愚蠢]，我将在我的索引页面上放置一个“移动设备站点”按钮......只需单击一下！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-26T22:11:22.323

[这篇文章](http://dev.opera.com/articles/view/server-side-capability-detection-for-mob/)（及其[后续](http://dev.opera.com/articles/view/server-side-capability-detection-for-mob-1/)文章）看起来不错。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-31T09:13:57.460

[检测移动浏览器](http://detectmobilebrowsers.com/)- 各种编程语言的片段。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-11-02T23:33:55.360

以下轻量级 Apache 配置做得很好，如果他们更喜欢 PC 版本，它会记住用户的偏好

```
<VirtualHost (your-address-binding)>   

  (your-virtual-host-configuration)       

  RewriteEngine On     
  RewriteCond %{QUERY_STRING} !ui=pc
  RewriteCond %{HTTP_COOKIE} !ui=pc
  RewriteCond %{HTTP_USER_AGENT} "^.*(iphone|ipod|ipad|android|symbian|nokia|blackberry| rim |opera mini|opera mobi|windows ce|windows phone|up\.browser|netfront|palm-|palm os|pre\/|palmsource|avantogo|webos|hiptop|iris|kddi|kindle|lg-|lge|mot-|motorola|nintendo ds|nitro|playstation portable|samsung|sanyo|sprint|sonyericsson|symbian).*$" [NC,OR]

  RewriteCond %{HTTP_USER_AGENT} "^(alcatel|audiovox|bird|coral|cricket|docomo|edl|huawei|htc|gt-|lava|lct|lg|lynx|mobile|lenovo|maui|micromax|mot|myphone|nec|nexian|nook|pantech|pg|polaris|ppc|sch|sec|spice|tianyu|ustarcom|utstarcom|videocon|vodafone|winwap|zte).*$" [NC] 

  RewriteRule /(.*) http://bemoko.com/$1 [L]

  RewriteCond %{QUERY_STRING} "ui=pc"
  RewriteRule ^/ - [CO=ui:pc:(your-cookie-domain):86400:/]
  RewriteCond %{QUERY_STRING} "ui=default"
  RewriteRule ^/ - [CO=ui:default:(your-cookie-domain):86400:/]
</VirtualHost> 
```

更多背景信息[@http://bemoko.com/training.team/help/team/pc-to-mobile-redirect](http://bemoko.com/training.team/help/team/pc-to-mobile-redirect)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-30T11:33:38.883

我提出了一个基于 uaprof 和用户代理的免费检测系统： [http](http://www.mobilemultimedia.be) ://www.mobilemultimedia.be UAprof 应该是可用时检测的主键，因为同一个 uaprof 通常有多个用户代理。如果您想自己管理，那么您应该选择 Wurfl，因为您可以下载整个数据库并在本地自行管理。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-10-12T15:50:01.717

当我最近有类似的需求时，我发现[这段代码](http://www.brainhandles.com/techno-thoughts/detecting-mobile-browsers)使用`HTTP_X_WAP_PROFILE`、`HTTP_ACCEPT`和`HTTP_USER_AGENT`来识别浏览器是移动浏览器还是非移动浏览器。它是 PHP，但可以很容易地转换为您需要的任何内容（我在 VBScript 中为经典 ASP 实现了它）。

具有讽刺意味的是，我最终没有使用该代码，因为我们决定为移动和非移动用户提供特定的 URL，但在我测试它时它确实有效......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-26T22:12:18.170

您将从请求标头中获得大部分信息，例如浏览器、设备、接受的语言、接受的格式等。上面提到的用户代理是请求标头的一部分。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-05-24T23:18:47.720

好的，这是一个非常简单的答案——让用户决定怎么样？在您登录到您的应用程序时，提供指向移动网站的链接。在移动站点上，提供“返回主站点”的链接 - 在您的移动设备上尝试 www.fazolis.com - 他们做得很好。

然后，在从浏览器站点到移动站点的链接上，注册他们的“投票”和他们的用户代理。**您**可以建立自己的可靠客户列表，列出需要移动网站的客户。使用这些与这些移动设备的屏幕尺寸规格相结合的方法，您可以构建一些非常好的逻辑以获得令人满意的用户体验。我永远不会在网络资源上发布像这样基本的东西。

哦，在你的“移动网站”上——如果你在语义上写好你的应用程序，那么你应该能够为移动设备和浏览器呈现一个单一的网站，而不必编写两个单独的页面集。只是需要考虑的事情 - 这值得额外的思考和努力以节省以后的时间。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-10-18T13:48:11.320

我在这里看不到它，但我目前正在研究的另一个选项是[www.detectmobilebrowser.com](http://www.detectmobilebrowser.com)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-02-29T13:57:45.070

最简单的方法是创建一个带有与移动浏览器关联的常规标签的数组。至少大多数移动用户代理必须有mobile、mini、nokia、java ME、android、iphone、mobile OS等字样。如果与用户代理匹配，使用php strpos，在页面顶部打印一个移动按钮. 留给用户选择。我喜欢完整的站点，因为我的移动浏览器给了我相同的体验，除了我需要在大多数时候缩放或滚动。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-26T22:11:12.510

您必须使用先前定义的列表检查用户代理字符串，[例如这个](http://www.zytrax.com/tech/web/mobile_ids.html)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-16T23:57:41.340

您可以使用 web 服务来检测手机浏览，例如 phonedetection.com。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-09-15T16:17:39.970

事实是仅仅依靠用户代理不足以检测移动浏览器。

当然，几年前你可以搜索某些字符串并猜测它是诺基亚或其他什么的，但现在有这么多手机，而且有这么多假装它们不是需要更复杂的东西的东西。

[我在链接文本](http://wapl.info)中找到了一个很棒的网站，它基于 MTV 用于所有移动网站的相同解决方案。它非常好，因为它具有独立于设备的标记语言，但更重要的是它们为 isMobileDevice() 提供了 Web 服务调用。

只需查看手册，然后查看“它是如何工作的”。

我一直在为我的客户网站使用它，但还没有找到无法准确检测到的移动浏览器。完全眼瞎！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-09-14T22:03:46.150

刚刚在[移动网络上运行了设备和功能检测，其中](http://wiki.forum.nokia.com/index.php/Device_and_feature_detection_on_the_mobile_web)包含以下内容：

1.  使用设备和功能检测来改善移动网络上的用户体验
2.  设备检测简介
3.  移动网站设计方法
    1.  没做什么
    2.  提供通用的移动网站
    3.  考虑移动和适应性的设计
4.  内容适配和设备分组策略
    1.  设备分组
    2.  内容改编
5.  首先将适应需求降至最低
6.  设备检测的常用方法
    1.  服务器端适配
    2.  客户端适配
    3.  服务器端用户代理 (UA) 和标头查找
    4.  服务端UA字符串结合设备数据库查找
    5.  服务器端用户代理配置文件 (UAProf) 检测
    6.  基于JavaScript技术的检测
    7.  CSS 媒体类型
    8.  CSS 媒体查询
7.  其他最佳实践
    1.  重定向+手动链接
    2.  着陆页+手动链接
8.  可下载的示例页面

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-01-07T08:15:55.883

您可以使用 WURFL API 来检测设备类型

```
http://wurfl.sourceforge.net/wurfl_schema.php 
```

或 [Modernizer](http://modernizr.com/)来检测浏览器功能

# iphone - 如何判断 UIView 是否可见并在屏幕上？

> ID：142282
> 
> 赞同：11
> 
> 时间：2008-09-26T22:07:00.400
> 
> 标签：iphone, objective-c, cocoa-touch

如果我有一个可见的`UIView`（或`UIView`子类），我如何判断它当前是否显示在屏幕上（而不是，例如，在当前不在屏幕的滚动视图的一部分中）？

为了让你更好地理解我的意思，`UITableView`有几种方法可以确定当前可见单元格的集合。我正在寻找一些可以对任何给定的`UIView`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-28T02:35:55.457

还没有尝试过任何这些。但是`CGRectIntersectsRect()`，`-[UIView convertRect:to(from)View]`并且`-[UIScrollView contentOffset]`似乎是您在这里的基本构建块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-26T06:04:20.340

这是我用来检查哪些 UIView 在 UIScrollView 中可见的内容：

```
for(UIView* view in scrollView.subviews) {
    if([view isKindOfClass:[SomeView class]]) {

        // the parent of view of scrollView (which basically matches the application frame)
        CGRect f = self.view.frame; 
        // adjust our frame to match the scroll view's content offset
        f.origin.y = _scrollView.contentOffset.y;

        CGRect r = [self.view convertRect:view.frame toView:self.view];

        if(CGRectIntersectsRect(f, r)) {
            // view is visible
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T23:46:02.730

如果您主要担心释放不在视图层次结构中的对象，则可以测试它是否具有超级视图，如下所示：

```
if (myView.superview){
 //do something with myView because you can assume it is on the screen
}
else {
 //myView is not in the view hierarchy
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T00:15:39.850

我最近不得不检查我的视图是否在屏幕上。这对我有用：

```
CGRect viewFrame = self.view.frame;
CGRect appFrame = [[UIScreen mainScreen] applicationFrame];

// We may have received messages while this tableview is offscreen
if (CGRectIntersectsRect(viewFrame, appFrame)) {
    // Do work here
} 
```

# java - 通过 ObjectOutputStream 发送相同但已修改的对象

> ID：142317
> 
> 赞同：23
> 
> 时间：2008-09-26T22:17:03.497
> 
> 标签：java, io, objectoutputstream

我有以下代码显示我的错误或误解。

我发送了相同的列表，但通过 ObjectOutputStream 进行了修改。一次为 [0]，其他为 [1]。但是当我阅读它时，我得到 [0] 两次。我认为这是因为我通过同一个对象发送并且 ObjectOutputStream 必须以某种方式缓存它们。

这是应有的工作，还是我应该提交错误？

```
导入java.io.*；
导入java.net.*；
导入 java.util.*；

公共类OOS {

    公共静态 void main(String[] args) 抛出异常 {
        线程 t1 = 新线程（新可运行（）{
            公共无效运行（）{
                尝试 {
                    ServerSocket ss = 新的 ServerSocket(12344);
                    套接字 s= ss.accept();

                    ObjectOutputStream oos = new ObjectOutputStream(s.getOutputStream());
                    列表相同 = new ArrayList();
                    相同的.add(0);
                    oos.writeObject（相同）；
                    相同的.clear();
                    相同的.add(1);
                    oos.writeObject（相同）；

                } 捕捉（异常 e）{
                    e.printStackTrace();
                }
            }
        });
        t1.start();

        套接字 s = new Socket("localhost", 12344);
        ObjectInputStream ois = new ObjectInputStream(s.getInputStream());

        // 按预期输出 [0]
        System.out.println(ois.readObject());

        // 输出 [0]，但预期为 [1]
        System.out.println(ois.readObject());
        System.exit(0);
    }
}

```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-26T22:32:27.157

流有一个参考图，所以发送两次的对象不会在另一端给出两个对象，你只会得到一个。并且分别发送两次相同的对象会给您两次相同的实例（每个都有相同的数据 - 这就是您所看到的）。

如果要重置图形，请参阅 reset() 方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-27T01:26:48.233

Max 是正确的，但您也可以使用：

```
public void writeUnshared(Object obj); 
```

请参阅下面的评论以获取警告

# email - gmail 的 random-signatures-from-an-RSS-feed 可以用于真正的动态签名吗？

> ID：142319
> 
> 赞同：1
> 
> 时间：2008-09-26T22:17:12.387
> 
> 标签：email, rss, gmail

这是 gmail 实验室的一项新功能，可让您指定 RSS 提要以从中获取随机引号以附加到您的电子邮件签名中。我想用它来根据我传入的参数、当前时间等以编程方式生成签名。（例如，我有一个 pine 脚本，它附加了从 intrade 的 API 获取的 McCain 和 Obama 获胜的当前概率。见下文。）但似乎 gmail 缓存了您指定的 URL 的内容。有什么方法可以控制它，或者任何人都知道 gmail 多久查看一次 URL？

补充：这是我用来测试的程序。该文件位于[http://kibotzer.com/sigs.php](http://kibotzer.com/sigs.php)。取自这里的无缓存标头想法 - [http://mapki.com/wiki/Dynamic_XML](http://mapki.com/wiki/Dynamic_XML) - 似乎无济于事。

```
<?php

header("Expires: Mon, 26 Jul 1997 05:00:00 GMT"); // Date in the past
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
// HTTP/1.1
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", false);
// HTTP/1.0
header("Pragma: no-cache");
//XML Header
header("content-type:text/xml");
?>

<!DOCTYPE rss PUBLIC "-//Netscape Communications//DTD RSS 0.91//EN" "http://my.netscape.com/publish/formats/rss-0.91.dtd">
<rss version="0.91">
<channel>
<title>Dynamic Signatures</title>
<link>http://kibotzer.com</link>
<description>Blah blah</description>
<language>en-us</language>
<pubDate>26 Sep 2008 02:15:01 -0000</pubDate>
<webMaster>dreeves@kibotzer.com</webMaster>
<managingEditor>dreeves@kibotzer.com (Daniel Reeves)</managingEditor>
<lastBuildDate>26 Sep 2008 02:15:01 -0000</lastBuildDate>

<image>
<title>Kibotzer Logo</title>
<url>http://kibotzer.com/logos/kibo-logo-1.gif</url>
<link>http://kibotzer.com/</link>
<width>120</width>
<height>60</height>
<description>Kibotzer</description>
</image>

<item>
<title>
Dynamic Signature 1 (<?php echo gmdate("H:i:s"); ?>) 
</title>
<link>http://kibotzer.com</link>
<description>This is the description for Signature 1 (<?php echo gmdate("H:i:s"); ?>) </description>
</item>

<item>
<title>
Dynamic Signature 2 (<?php echo gmdate("H:i:s"); ?>) 
</title>
<link>http://kibotzer.com</link>
<description>This is the description for Signature 2 (<?php echo gmdate("H:i:s"); ?>) </description>
</item>

</channel>
</rss> 
```

```
--
http://ai.eecs.umich.edu/people/dreeves - - 搜索：//“丹尼尔·里夫斯”

来自贸易内的最新概率...
  42.1% 麦凯恩成为总统（最后交易时间为周五 18:07）
  57.0% 奥巴马成为总统（最后交易时间周五 18:34）
  2008 年美国经济衰退 17.6%（最后交易时间 16:24 FRI）
  08 年对伊朗进行 16.1% 的公开空袭（最后交易时间为 17:39 FRI）

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T22:21:24.420

你也许可以在客户端做点什么，看看这个随机添加签名的[greasemonkey脚本。](http://userscripts.org/scripts/show/1704)由于它在您的控制之下，而不是谷歌的，您可以控制它是否缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T22:40:54.297

尝试设置[Cache-Control: no-cache](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9)和[Pragma: no-cache](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.32) HTTP 标头。如果 Google 的签名代码符合这些标头中的任何一个，那么您会很幸运。

# windows - 设置我们的新开发服务器 分配多个 IP 地址的最简单方法是什么

> ID：142320
> 
> 赞同：2
> 
> 时间：2008-09-26T22:17:13.463
> 
> 标签：windows, installation

我正在设置我们的新开发服务器，将多个 IP 地址分配给 Windows 2008 服务器网络适配器的最简单方法是什么？

我正在设置我们的开发机器，运行 IIS 7，并希望在 IIS 7 中设置新网站时可以使用 192.168.1.200 - .254 之间的范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T22:49:35.507

```
> netsh interface ipv4 add address "Local Area Connection" 192.168.1.201 255.255.255.0 
```

包裹在 cmd.exe“for”循环中以添加多个 IP。

编辑：（来自 Brian）上面的“本地连接”是一个占位符，请确保您使用系统上的实际网络适配器名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T23:27:13.560

完整的 CMD.EXE 循环：

```
FOR /L %b IN (200,1,254) DO netsh interface ip add address "your_adapter" 192.168.1.%b 255.255.255.0 
```

在上面的代码中，将“your_adapter”替换为实际的接口名称（通常是“Local Area Connection”）。此外，最后的网络掩码是/24 或C 类子网的假设；替换正确的网络掩码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T22:26:11.740

网络连接 -> 局域网连接属性 -> TCP/IP 属性 -> 高级 -> IP 设置 -> 添加按钮。

# web-services - 对于 Live Search SOAP 服务，我应该发布到哪个 URL？

> ID：142326
> 
> 赞同：0
> 
> 时间：2008-09-26T22:19:13.303
> 
> 标签：web-services, soap, search-engine, windows-live

可能我真的很厚。但是，查看使用 SOAP 的实时搜索（MSN 搜索）的 SDK，并没有告诉我服务位于哪个 URL？我可以下载可能封装的 C# 或 VB 的 SDK，但这对我没有帮助（我正在使用 ruby​​）。

[http://search.live.com/developer/](http://search.live.com/developer/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T22:35:51.110

您需要的网址是：[http ://soap.search.live.com/webservices.asmx](http://soap.search.live.com/webservices.asmx)

有关可用于从 WSDL 发现端点的各种工具的附加信息：

如果您有 VS，您可以通过将 Web 服务引用添加到 C# 控制台项目然后打开 app.config 文件并查找`<endpoint>`元素来发现端点。

要为 Live Search Web 服务添加 Web 服务参考，请将向导指向位于[http://soap.search.live.com/webservices.asmx?wsdl](http://soap.search.live.com/webservices.asmx?wsdl)的 WSDL 。

或者，您可以使用 .Net 3.0 中的 svcutil.exe 工具从 WSDL 生成 C# 客户端包装器和 .config 文件。同样，您对`<endpoint>`生成配置感兴趣。

# c++ - C++ 中的高性能计算资源

> ID：142331
> 
> 赞同：17
> 
> 时间：2008-09-26T22:20:51.053
> 
> 标签：c++, performance

我正在寻找详细介绍使用 C++ 进行高性能计算的编程技术的书籍或在线资源。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-26T23:26:34.873

实际上，我听说过的所有 HPC 代码都是用于求解线性方程组或 FFT 的。至少在使用的库中，这里有一些链接可以帮助您开始：

*   [BLAS](http://en.wikipedia.org/wiki/Blas) - 线性代数的标准程序集 - 诸如矩阵乘法之类的东西
*   [LAPACK](http://en.wikipedia.org/wiki/Lapack) - 更高级别线性代数例程的标准集 - 像 LU decomp 之类的东西。
*   [ATLAS](http://en.wikipedia.org/wiki/Automatically_Tuned_Linear_Algebra_Software) - 优化的 BLAS 实施
*   [FFTW](http://en.wikipedia.org/wiki/FFTW) - 优化的 FFT 实现
*   [PBLAS](http://people.scs.fsu.edu/~burkardt/f_src/pblas/pblas.html) - 用于分布式处理器的 BLAS
*   [SCALAPACK](http://people.scs.fsu.edu/~burkardt/f_src/scalapack/scalapack.html) - 分布式 LAPACK 实现
*   [MPI](http://en.wikipedia.org/wiki/Message_Passing_Interface) - 分布式系统的通信库。
*   [PETSc](http://mcs.anl.gov/petsc) - 可扩展的非线性和线性求解器（用户可扩展，与以上接口）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-27T03:44:51.680

即使不是 FOSS，[如果](http://www.intel.com/cd/software/products/asmo-na/eng/302910.htm)您需要执行这些库支持的任何操作（例如：信号处理、图像处理、[矩阵](http://www.intel.com/cd/software/products/asmo-na/eng/307757.htm)数学）。当然，是否可以从中受益取决于您的平台。

（不：我不为英特尔工作，但我是他们的快乐客户。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-27T03:34:05.667

Trilinos库和软件包套件为[HPC](http://trilinos.sandia.gov/)提供了广泛的中间件库，包括稀疏、迭代线性求解器；非线性求解器；特征求解器；ODE & DAE 积分器，包括敏感性分析；优化（侵入性和黑盒）；有限元接口；网状接口；预处理器；等等。所有这些包都是使用相当现代的 C++ 技术设计的（有 Python API 以及一些 C 和 Fortran）。在非常大规模的并行（5000+ CPU）模拟中使用了异常后果（核武器设计）并取得了巨大成功。这些软件包提供了一套比 BLAS 等更高级别的功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-26T22:25:56.750

第一件事可能是阅读[MPI（消息传递接口）](http://www-unix.mcs.anl.gov/mpi/)，它是 HPC 节点互连中的事实标准。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-27T03:36:24.803

尽管已经 14 岁以上，但[Expression Templates](http://ubiety.uwaterloo.ca/~tveldhui/papers/Expression-Templates/exprtmpl.html)的开创性工作仍然被认为是多年来最杰出的 C++ 工作之一。快速、高效、安全……我已经使用了这些技术，它们真的很了不起。

**编辑：** 如果上面的链接仍然断开，这里是[Expression Templates 的替代参考](http://www.ddj.com/cpp/184401627)。这篇 DDJ 文章引用了 Veldhuizen 的原创作品。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-09T20:34:09.313

查看[特征向量/矩阵库](http://eigen.tuxfamily.org/)。api 非常优雅，生成的程序非常快（由于 SSE2 架构的显式矢量化）..

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-26T22:24:17.753

看看[自适应通信环境 (ACE)](http://www.cs.wustl.edu/~schmidt/ACE.html)。它是用于 C++ 中高性能应用程序的模板和对象库。它具有出色的跨平台原语，用于线程、网络等。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T01:23:02.240

无论您写什么，以及您从一开始就为性能设计了多少，很有可能它会从性能调整中受益。通常程序越大，受益越多。[这](http://www.wikihow.com/Optimize-Your-Program%27s-Performance)是一种简单有效的调优方法。它基于“深度采样”，一种在不强调测量的同时提供准确诊断的技术。

您还可以查看[http://en.wikipedia.org/wiki/Performance_analysis#Simple_manual_technique](http://en.wikipedia.org/wiki/Performance_analysis#Simple_manual_technique)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-23T15:36:12.650

高可扩展性 - 构建更大、更快、更可靠的网站。

[http://highscalability.com/](http://highscalability.com/)

并且：

[http://www.ddj.com/hpc-high-performance-computing/](http://www.ddj.com/hpc-high-performance-computing/)

# sql-server - 如何远程调试同一域中的存储过程？

> ID：142339
> 
> 赞同：1
> 
> 时间：2008-09-26T22:22:46.103
> 
> 标签：sql-server, stored-procedures, visual-studio-2005, remote-debugging

从 VS 2005 中成功地远程调试存储过程 (SQL Server 2005) 需要哪些步骤？

客户端和服务器机器都在同一个域中。我从来没有这样做过，所以一步一步的指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T23:42:24.977

好问题！如果我没记错的话，我认为 SQL Management Studio 内部不再可以进行调试（就像在 SQL Server 2000 和 Enterprise Studio 时代一样）。

## 在 Visual Studio 2005 中远程调试 MS SQL 存储过程的说明

1.  启动 Visual Studio（如果您从 Vista**运行，请以管理员**身份运行）
2.  在 Visual Studio 2005 中单击**View->Server Explorer**，您会注意到它会显示一个带有**Data Connections**元素的面板。
3.  右键单击**数据连接**并选择**添加连接**
4.  确保**数据源**设置为**SqlClient**。
5.  填写服务器连接信息，填写您希望调试的存储过程所在的数据库名称。
6.  成功连接后，您会注意到填充了数据库树，它为您提供了表、视图、存储过程、函数等的列表。
7.  展开 **Stored Procedures**，找到您要调试的那个并右键单击它并选择**Step Into Stored Procedure**。
8.  如果存储过程有参数，则会出现一个对话框，您可以指定这些参数是什么。
9.  此时，根据您的防火墙设置和其他设置，系统可能会提示您对防火墙进行修改以允许打开必要的端口。但是，Visual Studio 似乎可以为您处理这个问题。
10.  完成后，Visual Studio 应将您置于存储过程的开头，以便您开始调试！

调试愉快！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T23:14:10.753

SQL 具体

> [http://msdn.microsoft.com/en-us/library/s4sszxst(VS.71).aspx](http://msdn.microsoft.com/en-us/library/s4sszxst(VS.71).aspx)

VS2005 总体来说

> [http://msdn.microsoft.com/en-us/library/y7f5zaaa(VS.71).aspx](http://msdn.microsoft.com/en-us/library/y7f5zaaa(VS.71).aspx)

# .net - 您如何对项目进行版本控制？

> ID：142340
> 
> 赞同：14
> 
> 时间：2008-09-26T22:23:39.500
> 
> 标签：.net, versioning

我了解 Microsoft 在对其产品进行版本控制时使用此模板：Major.Minor.Build.Revision。

当“开发人员”想要表明软件有很大的变化并且不能假设向后兼容性时，就会更改专业。也许代码的主要重写已经完成。

次要数字表示具有向后兼容性目的的显着增强。

内部版本号是一个小的变化，例如重新编译相同的源。

修订版用于修复安全漏洞，应该是完全可互换的。Build 和 Revision 都是可选的。此信息基于[MSDN 版本类](http://msdn.microsoft.com/en-us/library/system.version.aspx)。

你如何对你的项目进行版本控制，为什么要以这种方式对它们进行版本控制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-26T22:27:01.693

我们通常在我工作的地方做 major.minor[.maintenance[.build]]，但每个项目似乎略有不同。

主要/次要与您提到的相同。每次构建服务器运行时，小（错误）修复和构建都会增加维护。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-26T22:58:18.013

我个人喜欢使用一个专注于项目/产品用户可以期望的向后兼容性级别的方案：

1.0之前：

*   0.0.1 = 首次发布
*   0.-.X = 向后兼容更新
*   0.X.0 = 向后不兼容的更新

1.0之后：

*   -.-.X = 更新而不更改界面
*   -.X.0 = 使用向后兼容的接口添加更新
*   X.0.0 = 向后不兼容的更新

将兼容性作为版本号的中心点，让用户，尤其是如果产品是库，更容易判断他们是否可以期待平滑和*安全*的升级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-26T22:29:49.300

我经常看到 Xyz，其中 X 是发布号之后的年份，yz 是一年中的月份。即 201 是 1 月，发布后 2 年。即5月份产品发布时，它的第一个发布号是105。明年2月发布的是202。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-26T22:33:03.817

我们通常根据当前的发布日期 YYYY.MM.DD.* 对项目进行版本控制，并且我们让内部版本号自动生成，例如，如果我们今天有一个版本，它将是 2008.9.26.BUILD。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-26T22:26:55.797

我使用major.minor.point.revision，其中point 是仅修复错误的版本，revision 是存储库版本。这很容易而且效果很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-26T22:29:36.210

我只做Major.minor。由于我是一个开发网络应用程序的单一开发人员（偶尔需要帮助），因此大多数人不会关心我所做的小修复。因此，当我进行一些更改/升级时，我只是在添加新功能和主要版本号时迭代次要版本。否则，就版本号而言，我只是忽略小修复（尽管如果我需要自己参考，我确实有 Subversion 修订号）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-26T22:29:38.783

我从事许多较小的项目，我个人发现这很有用。

PatchNumber.DateMonthYear

这适用于基于 Web 的小型工具，用户可以在其中查看上次更新时间和更新频率。

PatchNumber 是已完成的发布数量，其余的用于向用户显示发布时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-26T23:09:39.937

Major.minor.patch.build 补丁是修补程序或补丁版本。

如果您可以通过 QA 获得并使用 SVN，则可以使用 svn HEAD 修订版作为内部版本号。这样，每个构建都根据源代码控制描述了它的来源以及构建中的内容。这确实意味着您的构建会出现差距（1.0.0.1、1.0.0.34 ....）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-27T01:25:40.030

Major.Minor.BugFix.SVNRevision

例如：3.5.2.31578

*   SVN 修订版为您提供了非常准确的代码发送给客户。您绝对确定该错误修复是否存在。
*   如果您遇到应用程序错误，它还有助于找到正确的 PDB。只需匹配构建服务器上的 SVN 修订版，将 PDB 复制到 EXE 位置，打开调试器，您就会得到崩溃堆栈跟踪。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-26T22:57:06.333

我只有一个号码。第一个版本是`001`. 第二个版本的第三个测试版是`002b3`，依此类推。这只是个人的想法，我目前实际上没有任何“发布”的东西，所以这都是理论。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-27T00:30:00.507

我开始使用与 Ubuntu 类似的伪格式：**Y.MMDD**

这有几个原因：

*   检查版本要求更容易：**if (version < 8.0901)** *die/exit/etc.* **;**
*   它可以在您的构建过程中自动生成

在第二点（红宝石和耙子）：

```
def serial(t)
   t = Time.now.utc if not t.instance_of?(Time)
   t.strftime("%Y").to_i - 2000 + t.strftime("0.%m%d").to_f
end

serial(Time.now)     #=> 8.0926
serial(Time.now.utc) #=> 8.0927 
```

注意：**t.strftime("%Y.%m%d").to_f - 2000**遇到浮点错误：**8.09269999999992**

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-27T01:40:49.060

我曾经喜欢在 80 年代对他们的 Clipper 编译器进行版本控制的 Nantucket 方式：

快船 1984年冬季
快船 1985 年夏季
快船 1985 年冬季
快船 1986 年秋季
快船 1987 年夏季

哦，还有覆盖......

[泪眼婆娑]

# c# - 获取类型的默认构造函数的最有效方法

> ID：142356
> 
> 赞同：75
> 
> 时间：2008-09-26T22:28:07.697
> 
> 标签：c#, .net, reflection

获取 System.Type 的默认构造函数（即没有参数的实例构造函数）的最有效方法是什么？

我正在按照下面的代码行思考一些事情，但似乎应该有一种更简单更有效的方法来做到这一点。

```
Type type = typeof(FooBar)
BindingFlags flags = BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance;
type.GetConstructors(flags)
    .Where(constructor => constructor.GetParameters().Length == 0)
    .First(); 
```

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2008-09-26T22:30:24.260

```
type.GetConstructor(Type.EmptyTypes) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-26T23:08:31.640

如果您确实**需要**ConstructorInfo 对象，请参阅[Curt Hagenlocher 的回答](https://stackoverflow.com/questions/142356/most-efficient-way-to-get-default-constructor-of-a-type#142362)。

另一方面，如果您真的只是想在运行时从 a 创建一个对象`System.Type`，请参阅[`System.Activator.CreateInstance`](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)——它不仅是面向未来的（Activator 处理的细节比 多`ConstructorInfo.Invoke`），它也不**那么**难看。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-09T16:04:06.303

如果您有泛型类型参数，那么 Jeff Bridgman 的答案是最好的。如果你只有一个代表你想要构造的类型的 Type 对象，你可以`Activator.CreateInstance(Type)`像 Alex Lyman 建议的那样使用，但有人告诉我它很慢（虽然我没有亲自分析它）。

但是，如果您发现自己非常频繁地构造这些对象，则使用动态编译的 Linq 表达式有一种更雄辩的方法：

```
using System;
using System.Linq.Expressions;

public static class TypeHelper
{
    public static Func<object> CreateDefaultConstructor(Type type)
    {
        NewExpression newExp = Expression.New(type);

        // Create a new lambda expression with the NewExpression as the body.
        var lambda = Expression.Lambda<Func<object>>(newExp);

        // Compile our new lambda expression.
        return lambda.Compile();
    }
} 
```

只需调用返回给您的代表即可。你应该缓存这个委托，因为不断地重新编译 Linq 表达式可能会很昂贵，但是如果你缓存委托并每次都重用它，它会非常快！我个人使用按类型索引的静态查找字典。当您处理可能只知道类型信息的序列化对象时，此函数会派上用场。

> **注意：如果类型不可构造或没有默认构造函数，这可能会失败！**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-16T19:31:39.080

如果您只想获取默认构造函数来实例化类，并且将类型作为泛型类型参数获取到函数，则可以执行以下操作：

```
T NewItUp<T>() where T : new()
{
   return new T();
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-27T00:33:28.533

你会想试试 FormatterServices.GetUninitializedObject(Type) 这个比 Activator.CreateInstance 好

但是，此方法不会调用对象构造函数，因此如果您在那里设置初始值，这将不起作用检查 MSDN 以了解这件事 [http://msdn.microsoft.com/en-us/library/system.runtime .serialization.formatterservices.getuninitializedobject.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatterservices.getuninitializedobject.aspx)

这里还有另一种方法 [http://www.ozcandegirmenci.com/post/2008/02/Create-object-instances-Faster-than-Reflection.aspx](http://www.ozcandegirmenci.com/post/2008/02/Create-object-instances-Faster-than-Reflection.aspx)

但是，如果对象具有参数化构造函数，则此操作失败

希望这可以帮助

# eclipse - Eclipse 的最佳 JVM 设置是什么？

> ID：142357
> 
> 赞同：315
> 
> 时间：2008-09-26T22:28:19.567
> 
> 标签：eclipse, jvm

您发现运行 Eclipse 的最佳 JVM 设置是什么？

* * *

## 回答 #1

> 赞同：315
> 
> 时间：2010-07-18T13:23:15.617

[又是一年中的那个时候：“eclipse.ini take 3”设置反击！]

# Eclipse Helios 3.6 和 3.6.x 设置

[替代文字 http://www.eclipse.org/home/promotions/friends-helios/helios.png](http://www.eclipse.org/home/promotions/friends-helios/helios.png)

在对[Eclipse Ganymede 3.4.x](https://stackoverflow.com/questions/142357/what-are-the-best-jvm-settings-for-eclipse/144349#144349)和[Eclipse Galileo 3.5.x进行设置后，下面是对 Eclipse Helios 3.6.x 的“优化”](https://stackoverflow.com/questions/142357/what-are-the-best-jvm-settings-for-eclipse/1409590#1409590) **[eclipse.ini](http://wiki.eclipse.org/Eclipse.ini)**设置文件的深入了解：

*   基于**[运行时选项](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/runtime-options.html)**，
*   并使用[7 月 27 日发布](http://java.about.com/b/2010/07/27/java-6-update-21-build-07-released.htm)的**Sun-Oracle JVM 1.6u21 b7** (~~可能涉及一些 Sun 专有选项~~）。

（^(通过“优化”，我的意思是能够在我们糟糕的工作工作站上运行完整的 Eclipse，一些 2002 年的旧 P4，带有 2Go RAM 和 XPSp3。但我也在 Windows7 上测试了这些相同的设置)）

## Eclipse.ini

![替代文字](https://www.eclipse.org/downloads/images/classic2.jpg)

**警告**：对于非 Windows 平台，使用 Sun 专有选项`-XX:MaxPermSize`而不是 Eclipse 专有选项`--launcher.XXMaxPermSize`。
也就是说：**除非**您使用的是最新的**jdk6u21 build 7**。请参阅下面的 Oracle 部分。

```
-data
../../workspace
-showlocation
-showsplash
org.eclipse.platform
--launcher.defaultAction
openFile
-vm
C:/Prog/Java/jdk1.6.0_21/jre/bin/server/jvm.dll
-vmargs
-Dosgi.requiredJavaVersion=1.6
-Declipse.p2.unsignedPolicy=allow
-Xms128m
-Xmx384m
-Xss4m
-XX:PermSize=128m
-XX:MaxPermSize=384m
-XX:CompileThreshold=5
-XX:MaxGCPauseMillis=10
-XX:MaxHeapFreeRatio=70
-XX:+CMSIncrementalPacing
-XX:+UnlockExperimentalVMOptions
-XX:+UseG1GC
-XX:+UseFastAccessorMethods
-Dcom.sun.management.jmxremote
-Dorg.eclipse.equinox.p2.reconciler.dropins.directory=C:/Prog/Java/eclipse_addons 
```

注意：
适应`p2.reconciler.dropins.directory`您选择的外部目录。
看到这个[答案](https://stackoverflow.com/questions/2763843/eclipse-plugins-vs-features-vs-dropins/2763891#2763891)。这个想法是能够独立于任何 Eclipse 安装将新插件放到一个目录中。

以下部分详细介绍了此`eclipse.ini`文件中的内容。

* * *

## 可怕的 Oracle JVM 1.6u21（pre build 7）和 Eclipse 崩溃

[Andrew Niefer](https://stackoverflow.com/users/84728/andrew-niefer)确实提醒了我这种情况，并写了[一篇博客文章](http://aniefer.blogspot.com/2010/07/permgen-problems-and-running-eclipse-on.html)，关于非标准 vm 参数 ( **`-XX:MaxPermSize`**) 并可能导致其他供应商的 vm 根本无法启动。
但是该选项 ( **`--launcher.XXMaxPermSize`**) 的 eclipse 版本不适用于新的 JDK（6u21，除非您使用的是 6u21 build 7，请参见下文）。

这~~最终的~~解决方案在[Eclipse Wiki](http://wiki.eclipse.org/FAQ_How_do_I_run_Eclipse%3F#Oracle.2FSun_VM_1.6.0_21_on_Windows)上，**对于带有 6u21 pre build 7 的 Windows 上的 Helios**：

*   **下载修复的[eclipse_1308.dll](https://bugs.eclipse.org/bugs/attachment.cgi?id=174343)**（2010 年 7 月 16 日）
*   并将其放入

```
(eclipse_home)/plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.1.0.v20100503

```

就是这样。此处无需调整设置（同样，仅适用于具有**6u21 pre build 7的****Windows**上的 Helios ）。 对于非 Windows 平台，您需要恢复为 Sun 专有选项。 **`-XX:MaxPermSize`**

 **该问题基于一个回归：[由于 java.exe 中的 Oracle 更名，JVM 识别失败](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6969236)，并在 Eclipse 上触发了[错误 319514](https://bugs.eclipse.org/bugs/show_bug.cgi?id=319514)。
Andrew 处理了[Bug 320005 - [launcher]`--launcher.XXMaxPermSize: isSunVM`应该为 Oracle 返回 true](https://bugs.eclipse.org/bugs/show_bug.cgi?id=320005)，但这仅适用于 Helios 3.6.1。另一位 Eclipse 提交
[者 Francis Upton](http://dev.eclipse.org/blogs/francis/about/)[对所有情况进行了反思](http://dev.eclipse.org/blogs/francis/2010/07/15/some-thoughts-on-the-java-u21-problem/)。

**更新 u21b7，7 月 27 日**：
**Oracle 已经退回了对下一个 Java 6 版本的更改，并且在 JDK 7 之前不会再次实施**。
如果您使用**[jdk6u21 build 7](http://www.oracle.com/technetwork/java/javase/downloads/index.html)**，则可以恢复为**`--launcher.XXMaxPermSize`**（eclipse 选项）而不是**`-XX:MaxPermSize`**（非标准选项）。[C 启动器 shim 中发生](http://www.infoq.com/news/2010/07/eclipse-java-6u21)
的自动检测仍会查找“ ”字符串，但使用 6u21b7，它现在​​可以工作了 - 再次。[`eclipse.exe`](http://www.infoq.com/news/2010/07/eclipse-java-6u21)`Sun Microsystems`

目前，我仍然保留该`-XX:MaxPermSize`版本（因为我不知道每个人何时会启动 Eclipse*正确*的JDK）。

* * *

## 隐式 `-startup` 和 `--launcher.library`

与之前的设置相反，这些模块的确切路径不再设置，这很方便，因为它可以在不同的 Eclipse 3.6.x 版本之间有所不同：

*   启动：如果未指定，可执行文件将在插件目录中查找`org.eclipse.equinox.launcher`具有最高版本的包。
*   launcher.library：如果未指定，可执行文件在`plugins`目录中查找具有最高版本的适当`org.eclipse.equinox.launcher.[platform]`片段并使用`eclipse_*`内部命名的共享库。

* * *

## 使用JDK6

现在明确需要 JDK6 来启动 Eclipse：

```
-Dosgi.requiredJavaVersion = 1.6 
```

这个[SO question](https://stackoverflow.com/questions/2787055/using-the-android-sdk-on-a-mac-eclipse-is-really-slow-how-can-i-speed-it-up)报告了在 Mac OS 上开发的积极发生率。

* * *

## +UnlockExperimentalVMOptions

以下选项是 Sun JVM 的一些实验选项的一部分。

```
-XX:+UnlockExperimentalVMOptions
-XX:+UseG1GC
-XX:+UseFastAccessorMethods 
```

[在这篇博文](http://ugosan.org/speeding-up-eclipse-a-bit-with-unlockexperimentalvmoptions/)中报告了它们可能会加速 Eclipse。[在此处](http://blogs.oracle.com/watt/resource/jvm-options-list.html)以及官方[Java Hotspot 选项页面](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)
中 查看所有JVM 选项。 注意：默认情况下可能处于活动状态 的那些选项报告的[详细列表。](http://www.md.pp.ru/~eu/jdk6options.html)
`UseFastAccessorMethods`

另请参阅[“更新您的 JVM”](http://translate.googleusercontent.com/translate_c?hl=en&sl=fr&tl=en&u=http://blog.xebia.fr/2010/07/13/revue-de-presse-xebia-167/&rurl=translate.google.com&twu=1&usg=ALkJrhgLW58oZuCouEaFZBTA_u6ZTQwvGA#MettezjourvotreJVM)：

> 提醒一下，G1 是为 JDK 7 做准备的新垃圾收集器，但已在 u17 的版本 6 中使用。

* * *

## 从命令行在 Eclipse 中打开文件

请参阅 Andrew Niefer 的[博客文章](http://aniefer.blogspot.com/2010/05/opening-files-in-eclipse-from-command.html)报告这个新选项：

```
--launcher.defaultAction
openFile 
```

> 这告诉启动器，如果使用仅包含不以“ `-`”开头的参数的命令行调用它，则应将这些参数视为跟在“ `--launcher.openFile`”之后。

```
eclipse myFile.txt 
```

> 当您双击与 Eclipse 关联的文件，或者选择文件并选择“ `Open With`”或“ `Send To`”Eclipse 时，这是启动器将在 Windows 上接收的命令行类型。
> 
> [相对路径](https://bugs.eclipse.org/bugs/show_bug.cgi?id=300532)将首先针对当前工作目录解析，然后针对 eclipse 程序目录解析。

请参阅[错误 301033](https://bugs.eclipse.org/bugs/show_bug.cgi?id=301033)以供参考。最初是[错误 4922](https://bugs.eclipse.org/bugs/show_bug.cgi?id=4922)（2001 年 10 月，9 年后修复）。

* * *

## p2 和未签名的对话框提示

如果您在安装许多插件期间厌倦了这个对话框：

![替代文字](https://aniszczyk.org/wp-content/uploads/2010/05/unsigneddialog.png)

，添加你的`eclipse.ini`：

```
-Declipse.p2.unsignedPolicy=allow 
```

[请参阅Chris Aniszczy](http://aniszczyk.org/about/)的这篇[博](http://aniszczyk.org/2010/05/20/p2-and-the-unsigned-dialog-prompt/)文和[错误报告 235526](https://bugs.eclipse.org/bugs/show_bug.cgi?id=235526)。

> 我确实想说，安全研究支持这样一个事实，即提示越少越好。
> 人们会忽略他们想要完成的事情中突然出现的事情。
> 
> 对于 3.6，我们不应该在流程中间弹出警告——无论我们多么简化，人们都会忽略它们。
> 相反，我们应该收集所有问题，不要*安装*有问题的捆绑包，而是将用户带回到工作流程中他们可以修复的点 - 添加信任，更松散地配置安全策略等。这称为**[“安全”分期'](http://www.eecs.berkeley.edu/~tygar/papers/Safe_staging_for_computer_security.pdf)**。

[---------- http://www.eclipse.org/home/categories/images/wiki.gif](http://www.eclipse.org/home/categories/images/wiki.gif) [替代文本 http://www.eclipse.org/home/categories/images/wiki.gif](http://www.eclipse.org/home/categories/images/wiki.gif) [替代文字 http://www.eclipse.org/home/categories/images/wiki.gif](http://www.eclipse.org/home/categories/images/wiki.gif)

## 其他选项

这些选项不直接在`eclipse.ini`上面，但如果需要可以派上用场。

* * *

### Windows7 上的 `user.home` 问题

当 Eclipse 启动时，它将读取其密钥库文件（保存密码的地方），该文件位于`user.home`.
如果由于某种原因`user.home`无法正确解析为完整路径，则 Eclipse 将不会启动。
最初在[这个 SO question](https://stackoverflow.com/questions/2120160/eclipse-is-not-starting-on-windows-7/2120198#2120198)中提出，如果您遇到这种情况，您需要将密钥库文件重新定义为显式路径（开始时不再需要 user.home 来解决）

添加你的`eclipse.ini`：

```
-eclipse.keyring 
C:\eclipse\keyring.txt 
```

这已由[错误 300577](https://bugs.eclipse.org/bugs/show_bug.cgi?id=300577)跟踪，已在[其他 SO 问题](https://stackoverflow.com/questions/2134338/java-user-home-is-being-set-to-userprofile-and-not-being-resolved)中解决。

* * *

### 调试模式

等等，Eclipse 中有不止一个设置文件。
如果您添加到您`eclipse.ini`的选项：

```
-debug 
```

，您启用[调试模式](http://www.eclipse.org/eclipse/platform-core/documents/3.1/debug.html)，Eclipse 将寻找*另一个*设置文件：`.options`您可以在其中指定一些 OSGI 选项的文件。
当您通过 dropins 文件夹添加新插件时，这非常棒。
在您的 .options 文件中添加以下设置，如本[博文“ **Dropins 诊断**”](http://eclipser-blog.blogspot.com/2010/01/dropins-diagnosis.html)中所述：

```
org.eclipse.equinox.p2.core/debug=true
org.eclipse.equinox.p2.core/reconciler=true 
```

> P2 将通知您在`dropins/`文件夹中找到了哪些捆绑包、生成了哪些请求以及安装计划是什么。也许它不是对实际发生的事情和出了什么问题的详细解释，但它应该为您提供有关从哪里开始的强有力信息：
> 
> *   你的套餐在计划中吗？
> *   是否是安装问题（P2 故障）
> *   或者也许包含您的功能并不是最佳选择？

这来自[Bug 264924 - [reconciler] No diagnostic of dropins questions](https://bugs.eclipse.org/bugs/show_bug.cgi?id=264924)，最终解决了以下问题：

```
Unzip eclipse-SDK-3.5M5-win32.zip to ..../eclipse
Unzip mdt-ocl-SDK-1.3.0M5.zip to ..../eclipse/dropins/mdt-ocl-SDK-1.3.0M5 
```

> 这是一个有问题的配置，因为 OCL 依赖于缺少的 EMF。
> 3.5M5 没有提供此问题的诊断。
> 
> 开始日食。
> 没有明显的问题。错误日志中没有任何内容。
> 
> *   `Help / About / Plugin`细节显示`org.eclipse.ocl.doc`，但不是`org.eclipse.ocl`。
> *   `Help / About / Configuration`details 没有（诊断）提及 `org.eclipse.ocl`.
> *   `Help / Installation / Information Installed Software`没有提及`org.eclipse.ocl`。
> 
> 漂亮的错误标记在哪里？

* * *

### 清单类路径

请参阅此[博客文章](http://lt-rider.blogspot.com/2010/05/jdt-manifest-classpath-classpath.html)：

> *   在 Galileo（又名 Eclipse 3.5）中，JDT 开始解析添加到项目构建路径的库中的清单类路径。无论是直接将库添加到项目的构建路径还是通过类路径容器（例如 JDT 提供的用户库工具或第三方实现的用户库工具），这都有效。
> *   在 Helios 中，此行为已更改为从清单类路径解析中排除类路径容器。

这意味着您的某些项目可能不再在 Helios 中编译。
如果要恢复到 Galileo 行为，请添加：

```
-DresolveReferencedLibrariesForContainers=true 
```

有关参考，请参阅[错误 305037](https://bugs.eclipse.org/bugs/show_bug.cgi?id=305037)、[错误 313965](https://bugs.eclipse.org/bugs/show_bug.cgi?id=313965)和[错误 313890](https://bugs.eclipse.org/bugs/show_bug.cgi?id=313890)。

* * *

### IPV4 堆栈

这个[SO question](https://stackoverflow.com/questions/1500646/eclipse-3-5-unable-to-install-plugins)提到了在不访问插件更新站点时的潜在修复：

```
-Djava.net.preferIPv4Stack=true 
```

此处提及以防万一它对您的配置有所帮助。

* * *

### JVM1.7x64 潜在优化

[本文](http://nerds-central.blogspot.com/2009/09/tuning-jvm-for-unusual-uses-have-some.html)报道：

> 作为记录，到目前为止，我在 1.7 x64 JVM n Windows 的基准测试中发现的最快的选项是：

```
-Xincgc 
-XX:-DontCompileHugeMethods 
-XX:MaxInlineSize=1024  
-XX:FreqInlineSize=1024 
```

> 但我仍在努力...

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2009-09-11T08:01:17.657

# Eclipse Galileo 3.5 和 3.5.1 设置

目前（2009 年 11 月），我正在使用 jdk6 update 17 测试以下配置选项集（使用 Galileo -- eclipse 3.5.x，[**Helios 3.6.x**](https://stackoverflow.com/questions/142357/what-are-the-best-jvm-settings-for-eclipse/3275659#3275659)[的 3.4](https://stackoverflow.com/questions/142357/what-are-the-best-jvm-settings-for-eclipse/144349#144349)或[更高](https://stackoverflow.com/questions/142357/what-are-the-best-jvm-settings-for-eclipse/3275659#3275659)**版本见下文）：（
当然，调整相对路径出现在这个 eclipse.ini 中到您的设置的正确路径）**

 **注意：对于**eclipse3.5**，将`startup`和`launcher.library`行替换为：

```
-startup
plugins/org.eclipse.equinox.launcher_1.0.200.v20090520.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.0.200.v20090519 
```

## eclipse.ini 3.5.1

```
-data
../../workspace
-showlocation
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
384m
-startup
plugins/org.eclipse.equinox.launcher_1.0.201.R35x_v20090715.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.0.200.v20090519
-vm
../../../../program files/Java/jdk1.6.0_17/jre/bin/client/jvm.dll
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Xms128m
-Xmx384m
-Xss4m
-XX:PermSize=128m
-XX:MaxPermSize=384m
-XX:CompileThreshold=5
-XX:MaxGCPauseMillis=10
-XX:MaxHeapFreeRatio=70
-XX:+UseConcMarkSweepGC
-XX:+CMSIncrementalMode
-XX:+CMSIncrementalPacing
-Dcom.sun.management.jmxremote
-Dorg.eclipse.equinox.p2.reconciler.dropins.directory=C:/jv/eclipse/mydropins 
```

另请参阅我[上面的原始答案](https://stackoverflow.com/questions/142357/what-are-the-best-jvm-settings-for-eclipse/144349#144349)以获取更多信息。

## 变更（自 2009 年 7 月起）

*   指的是启动器而不是框架
*   共享插件：`org.eclipse.equinox.p2.reconciler.dropins.directory`选项。
*   Galileo 支持工作空间或 VM 的完全相对路径（避免必须从一个 eclipse 安装修改到另一个，当然，如果您的 JVM 和工作空间保持不变）
    之前，当 eclipse 启动时，这些相对路径不断被重写为绝对路径...
*   您还可以在 eclipse 目录中复制 Java JDK 安装的 JRE 目录

## 注意事项

存在与 JDK 相关的[**忽略断点的错误。**](https://stackoverflow.com/questions/1027002/eclipse-swing-app-breakpoint-hit-only-after-an-uncaught-exception-is-thrown)
一定要使用 JDK6u16 或更新版本来*启动*eclipse（然后您可以定义要*在*eclipse 中编译的任意数量的 JDK：这并不是因为您使用 JDK6 启动 eclipse，所以您必须使用相同的 JDK 进行编译）。

## 最大限度

注意以下用法：

```
--launcher.XXMaxPermSize
384m
-vmargs
-XX:MaxPermSize=128m 
```

如[Eclipse Wiki](http://wiki.eclipse.org/FAQ_How_do_I_increase_the_permgen_size_available_to_Eclipse%3F)中所述，

> Eclipse 3.3 支持启动器的新参数：`--launcher.XXMaxPermSize`.
> 如果正在使用的 VM 是 Sun VM，并且还没有`-XX:MaxPermSize=`VM 参数，则启动器将自动添加`-XX:MaxPermSize=256m`到正在使用的 VM 参数列表中。
> 3.3 启动器只能识别 Windows 上的 Sun VM。

如[本条目所述](http://dev.eclipse.org/newslists/news.eclipse.platform/msg69006.html)：

> 并非所有 vm 都接受`-XX:MaxPermSize`以这种方式传递的参数。识别 sun vm 可能存在（也可能不存在）问题。
> 注意：Eclipse 3.3.1 有[一个错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=203325)，启动器无法检测到 Sun VM，因此没有使用正确的 PermGen 大小。这似乎也是[Mac OS X 3.3.0 上的一个已知错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=195897)。
> **如果您使用这些平台组合中的任何一个，请按上述方式将`-XX`标志添加到`eclipse.ini`。**
> 
> 笔记：
> 
> *   " `384m`" 行转换为`=384m`VM 参数的 " " 部分，如果 VM 在 " " 上区分大小写`m`，则此参数也是如此。
> *   “ `--launcher.`”前缀，这指定参数由启动器本身使用，并被添加到启动器特定的参数中，以避免与应用程序参数的名称冲突。（其他例子是`--launcher.library`, `--launcher.suppressErrors`）
> 
> 该`-vmargs -XX:MaxPermSize=384m`部分是直接传递给 VM 的参数，完全绕过启动器，并且不使用对 VM 供应商的检查。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2008-09-27T20:00:18.573

# Eclipse Ganymede 3.4.2 设置

* * *

有关更多最新设置，请参阅[**上面的 Eclipse Galileo 3.5 设置**](https://stackoverflow.com/questions/142357/what-are-the-best-jvm-settings-for-eclipse/1409590#1409590)。

* * *

## JDK

在我看来，最好的 JVM 设置**总是包括****你能找到的最新的 JDK**（所以现在 jdk1.6.0_b07 到 b16，[除了 b14 和 b15](https://stackoverflow.com/questions/1027002/eclipse-swing-app-breakpoint-hit-only-after-an-uncaught-exception-is-thrown)）

## 日食.ini

即使使用那些相当低的内存设置，我也可以在具有 2Go RAM 的旧 (2002) 桌面上运行大型 Java 项目（以及 Web 服务器）。

```
-showlocation
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256M
-framework
plugins\org.eclipse.osgi_3.4.2.R34x_v20080826-1230.jar
-vm
jdk1.6.0_10\jre\bin\client\jvm.dll
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Xms128m
-Xmx384m
-Xss2m
-XX:PermSize=128m
-XX:MaxPermSize=128m
-XX:MaxGCPauseMillis=10
-XX:MaxHeapFreeRatio=70
-XX:+UseConcMarkSweepGC
-XX:+CMSIncrementalMode
-XX:+CMSIncrementalPacing
-XX:CompileThreshold=5
-Dcom.sun.management.jmxremote 
```

有关新选项的更多详细信息，请参阅[GKelly 的 SO 答案](https://stackoverflow.com/questions/94331/eclipse-memory-use#101995)和[Piotr Gabryanczyk 的博客条目](http://piotrga.wordpress.com/2006/12/12/intellij-and-garbage-collection/)。

## 监控

您还可以考虑启动：

```
C:\[jdk1.6.0_0x path]\bin\jconsole.exe 
```

正如[前面关于内存消耗](https://stackoverflow.com/questions/100161/is-eclipse-34-ganymede-memory-usage-significantly-higher-than-32#101164)的问题所说。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-10-19T13:36:23.067

# Eclipse Indigo 3.7.2 设置（64 位 linux）

在 x86-64 Linux 上运行的**Sun/Oracle java**版本“1.6.0_31”和**Eclipse 3.7的设置：**

```
-nosplash
-vmargs
-Xincgc
-Xss500k
-Dosgi.requiredJavaVersion=1.6
-Xms64m
-Xmx200m
-XX:NewSize=8m
-XX:PermSize=80m
-XX:MaxPermSize=150m
-XX:MaxPermHeapExpansion=10m
-XX:+UseConcMarkSweepGC
-XX:CMSInitiatingOccupancyFraction=70
-XX:+UseCMSInitiatingOccupancyOnly
-XX:+UseParNewGC
-XX:+CMSConcurrentMTEnabled
-XX:ConcGCThreads=2
-XX:ParallelGCThreads=2
-XX:+CMSIncrementalPacing
-XX:CMSIncrementalDutyCycleMin=0
-XX:CMSIncrementalDutyCycle=5
-XX:GCTimeRatio=49
-XX:MaxGCPauseMillis=20
-XX:GCPauseIntervalMillis=1000
-XX:+UseCMSCompactAtFullCollection
-XX:+CMSClassUnloadingEnabled
-XX:+DoEscapeAnalysis
-XX:+UseCompressedOops
-XX:+AggressiveOpts
-XX:+ExplicitGCInvokesConcurrentAndUnloadsClasses 
```

请注意，这仅将 200 MB 用于堆，150 MB 用于非堆。如果您使用大型插件，您可能需要同时增加“-Xmx200m”和“-XX:MaxPermSize=150m”限制。

这些标志的主要优化目标是**在所有情况下最小化延迟，**并作为次要优化目标最小化内存使用量。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-09-27T00:22:17.703

-演出地点

为了更容易让 eclipse 运行两次，并知道你正在处理哪个工作区

Eclipse 3.6 添加了一个首选项选项来指定要显示的内容，这比三个原因`Workspace name (shown in window title)`要好得多：`-showlocation`

1.  您无需重新启动 eclipse 即可生效。
2.  您可以选择一个短代码。
3.  它首先出现在透视图和应用程序名称之前。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-14T03:13:35.010

如果您使用的是 Linux + Sun JDK/JRE **32bits**，请将“-vm”更改为：

```
-vm 
[your_jdk_folder]/jre/lib/i386/client/libjvm.so 
```

如果您使用的是 Linux + Sun JDK/JRE **64bits**，请将“-vm”更改为：

```
-vm
[your_jdk_folder]/jre/lib/amd64/server/libjvm.so 
```

这对我来说在 Ubuntu 8.10 和 9.04 上运行良好

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-07-07T19:58:42.567

如果您要使用 jdk6 update 14，我建议使用 G1 垃圾收集器，这似乎有助于提高性能。

为此，请删除以下设置：

-XX:+UseConcMarkSweepGC
-XX:+CMSIncrementalMode
-XX:+CMSIncrementalPacing

并用这些替换它们：

-XX:+UnlockExperimentalVMOptions
-XX:+UseG1GC

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-12-03T06:20:32.547

您也可以尝试使用[JRockit](http://www.oracle.com/technology/software/products/jrockit/index.html)运行。它是针对服务器优化的 JVM，但许多长时间运行的客户端应用程序，如 IDE，在 JRockit 上运行得非常好。Eclipse 也不例外。JRockit 没有永久空间，因此您不需要配置它。

可以设置一个暂停时间目标（毫秒）以避免长时间 gc 暂停停止 UI。

```
-showsplash
org.eclipse.platform
-vm
 C:\jrmc-3.1.2-1.6.0\bin\javaw.exe 
-vmargs
-XgcPrio:deterministic
-XpauseTarget:20 
```

我通常不会费心设置 -Xmx 和 -Xms 并让 JRockit 在它认为有必要时增长堆。如果您使用 JRockit 启动 Eclipse 应用程序，您还可以使用 JRockit Mission Control 工具套件监控、分析和查找应用程序中的内存泄漏。您从这个[更新站点](http://www.oracle.com/technology/software/products/jrockit/missioncontrol/updates/eclipse-3.3/jrmc/index.html)下载插件。注意，仅适用于 Eclipse 3.3 和 Eclipse 3.4

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-09-23T03:11:19.037

这是我自己在 i7 2630M 16GB RAM 笔记本电脑上运行的 Eclipse 的设置，这个设置已经使用了一周，没有一次崩溃，Eclipse 3.7 运行流畅。

```
-startup
plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.100.v20110502
-product
org.eclipse.epp.package.jee.product
--launcher.defaultAction
openFile
--launcher.XXMaxPermSize
256M
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Xms1024m
-Xmx4096m 
-XX:MaxPermSize=256m 
```

计算：对于 Win 7 x64

*   Xms = 物理内存 / 16
*   Xmx = 物理内存 / 4
*   MaxPermSize = 与默认值相同，即 256m

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-10-15T07:59:01.277

```
-startup
../../../plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar
--launcher.library
../../../plugins/org.eclipse.equinox.launcher.cocoa.macosx_1.1.100.v20110502
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Xms128m
-Xmx512m
-XX:MaxPermSize=256m
-Xdock:icon=../Resources/Eclipse.icns
-XstartOnFirstThread
-Dorg.eclipse.swt.internal.carbon.smallFonts
-Dcom.sun.management.jmxremote
-Declipse.p2.unsignedPolicy=allow 
```

这些设置对我来说就像一种魅力。我正在运行 OS X10.6、Eclipse 3.7 Indigo、JDK1.6.0_24

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-07-18T17:46:55.370

我自己的设置（Java 1.7，修改为 1.6）：

```
-vm
C:/Program Files (x86)/Java/jdk1.7.0/bin
-startup
plugins/org.eclipse.equinox.launcher_1.1.0.v20100507.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.1.100.v20100628
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-server
-Dosgi.requiredJavaVersion=1.7
-Xmn100m
-Xss1m
-XgcPrio:deterministic
-XpauseTarget:20
-XX:PermSize=400M
-XX:MaxPermSize=500M
-XX:CompileThreshold=10
-XX:MaxGCPauseMillis=10
-XX:MaxHeapFreeRatio=70
-XX:+UnlockExperimentalVMOptions
-XX:+DoEscapeAnalysis
-XX:+UseG1GC
-XX:+UseFastAccessorMethods
-XX:+AggressiveOpts
-Xms512m
-Xmx512m 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-27T00:14:53.073

Eclipse 喜欢大量的 RAM。至少使用 -Xmx512M。更多，如果有的话。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-07-28T16:12:59.390

如果您像我一样对当前的 Oracle 1.6 版本有疑问，那么您可能需要更新您的 JDK 或设置

```
-XX:MaxPermSize
```

. 更多信息可在此处获得：http: [//java.dzone.com/articles/latest-java-update-fixes](http://java.dzone.com/articles/latest-java-update-fixes)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-10-07T04:07:50.147

XX:+UseParallelGC 这是最棒的选择！！！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-27T00:21:12.073

-vm
C:\Program Files\Java\jdk1.6.0_07\jre\bin\client\jvm.dll

指定您使用的 java 版本，并使用 dll 而不是启动 javaw 进程

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-26T22:38:43.817

这是我使用的（尽管我将它们放在快捷方式而不是设置文件中）：

eclipse.exe -showlocation -vm "C:\Java\jdk1.6.0_07\bin\javaw.exe" -vmargs -Xms256M -Xmx768M -XX:+UseParallelGC -XX:MaxPermSize=128M

# c++ - 为此获得 boost::shared_ptr

> ID：142391
> 
> 赞同：77
> 
> 时间：2008-09-26T22:42:43.183
> 
> 标签：c++, boost

我`boost:shared_ptr`在我的代码中广泛使用。事实上，在堆上分配的大多数对象都由 a 持有`shared_ptr`。不幸的是，这意味着我不能传入`this`任何需要`shared_ptr`. 考虑这段代码：

```
void bar(boost::shared_ptr<Foo> pFoo)
{
    ...
}

void Foo::someFunction()
{
    bar(this);
} 
```

这里有两个问题。首先，这不会编译，因为 T* 构造函数`shared_ptr`是显式的。其次，如果我强制它构建，`bar(boost::shared_ptr<Foo>(this))`我将创建第二个指向我的对象的共享指针，最终将导致双重删除。

这让我想到了我的问题：是否有任何标准模式可以从其中一个对象的方法内部获取您知道存在的现有共享指针的副本？在这里使用侵入式引用计数是我唯一的选择吗？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-09-26T22:46:57.667

您可以从[enable_shared_from_this](http://www.boost.org/doc/libs/1_36_0/libs/smart_ptr/enable_shared_from_this.html)派生，然后您可以使用“shared_from_this()”而不是“this”来生成指向您自己的 self 对象的共享指针。

链接中的示例：

```
#include <boost/enable_shared_from_this.hpp>

class Y: public boost::enable_shared_from_this<Y>
{
public:

    shared_ptr<Y> f()
    {
        return shared_from_this();
    }
}

int main()
{
    shared_ptr<Y> p(new Y);
    shared_ptr<Y> q = p->f();
    assert(p == q);
    assert(!(p < q || q < p)); // p and q must share ownership
} 
```

当从成员函数生成线程以 boost::bind 到 shared_from_this() 而不是 this 时，这是一个好主意。它将确保对象不被释放。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-27T03:59:49.520

只需为您的函数参数使用原始指针而不是 shared_ptr。智能指针的目的是控制对象的生命周期，但 C++ 范围规则已经保证了对象的生命周期：它的存在时间至少与函数结束的时间一样长。也就是说，调用代码不可能在你的函数返回之前删除对象；因此，只要您不尝试删除函数内的对象，就可以保证“哑”指针的安全性。

唯一需要将 shared_ptr 传递给函数的情况是，当您想要将对象的所有权传递给函数，或者希望函数制作指针的副本时。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-26T22:44:53.443

boost 对此用例有解决方案，请检查[enable_shared_from_this](http://www.boost.org/doc/libs/1_36_0/libs/smart_ptr/enable_shared_from_this.html)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-26T23:07:06.260

您真的在 bar 内制作了更多 pFoo 的共享副本吗？如果您没有在内部做任何疯狂的事情，请执行以下操作：

```
 void bar(Foo &foo)
{
    // ...
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-25T13:08:42.610

使用 C++11 `shared_ptr`，`enable_shared_from_this`现在在标准库中。顾名思义，后者正是针对这种情况的。

[http://en.cppreference.com/w/cpp/memory/shared_ptr](http://en.cppreference.com/w/cpp/memory/shared_ptr)

[http://en.cppreference.com/w/cpp/memory/enable_shared_from_this](http://en.cppreference.com/w/cpp/memory/enable_shared_from_this)

示例基于上面链接中的示例：

```
struct Good: std::enable_shared_from_this<Good>{
    std::shared_ptr<Good> getptr() {
        return shared_from_this();
    }
}; 
```

采用：

```
std::shared_ptr<Good> gp1(new Good);
std::shared_ptr<Good> gp2 = gp1->getptr();
std::cout << "gp2.use_count() = " << gp2.use_count() << '\n'; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-27T00:26:03.887

接受指针的函数想要执行以下两种行为之一：

*   **拥有**传入的对象，并在超出范围时将其删除。在这种情况下，您可以只接受 X* 并立即将 scoped_ptr 包裹在该对象周围（在函数体中）。这将用于接受“this”，或者一般来说，任何堆分配的对象。
*   **共享一个指向**传入对象的指针（不拥有它）。在这种情况下，您根本*不想*使用 scoped_ptr，因为您不想在函数结束时删除该对象。在这种情况下，您理论上想要的是 shared_ptr （我在其他地方看到它称为linked_ptr）。boost 库有[一个 shared_ptr 版本，](http://www.boost.org/doc/libs/1_36_0/libs/smart_ptr/shared_ptr.htm)在 Scott Meyers 的 Effective C++ book（第 3 版中的第 18 项）中也推荐了这个版本。

**编辑：**哎呀，我稍微误读了这个问题，我现在看到这个答案并没有完全解决这个问题。无论如何我都会保留它，以防这可能对任何处理类似代码的人有所帮助。

# automation - 哪个更适合网络测试？录音播放自动化还是编码？

> ID：142398
> 
> 赞同：4
> 
> 时间：2008-09-26T22:45:02.693
> 
> 标签：automation, integration-testing, qa

我正在做一个新项目，我想知道哪种自动化工具最适合使用。我应该录音还是编码？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-22T11:18:52.040

我使用 Selenium 浏览器自动化软件包做了很多工作，我发现记录*重新强化*了现有的应用程序设计，而编码则*使*设计朝着灵活和可维护的方向发展。

具体来说，我发现最好的做法是编写高级脚本，假装您不知道现有的 HTML 标记在说什么。努力保持脚本的可读性。

```
open /
click "Ask a question"
type title, "What does ?SYNTAX ERROR ON 20 mean?"
type body "This is an example question, asked by an automated testing robot."
click "Ask your question" 
```

如果脚本没有运行，请不要更改脚本——更改 HTML。向脚本“告诉您”它需要它们的元素添加 ID 或类或标题。这需要更长的时间，但它可以确保您的脚本是可维护的和明显的，并且它使进一步的脚本更容易。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-26T22:54:21.113

编码要好得多。使用记录播放系统，如果页面的任何方面发生变化，您必须重新记录整个测试套件。通过编码和适当的设计，您可以更改与该区域交互的功能，所有测试都将开始工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-27T00:18:19.740

我会说两者——尽可能多地记录，然后根据需要调整记录的代码以进行测试。当然，这假设您的记录器发出您可以编辑的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-13T19:03:21.450

到目前为止，QTP 是最好的。但请记住——它首先是一个强大的平台。如果您不想维护记录/播放脚本，则需要开发您的自定义框架（选择关键字驱动）或购买 HP BPT。

还有一系列低预算和开源工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T14:38:23.770

它还取决于您要测试的网络应用程序的复杂性。

以不同的方式说它并考虑在办公室工作，也取决于您与开发人员的密切程度。

当您知道您的开发团队支持您时，肯定可以避免花时间寻找您的应用程序的功能和名称。

你的情况是什么？

PS：编码更好；）

# xml - 在 XSLT 1.0 中格式化 24 小时时间的最佳方式是什么？

> ID：142400
> 
> 赞同：2
> 
> 时间：2008-09-26T22:45:47.733
> 
> 标签：xml, xslt, xslt-1.0

我很难找到采用时间格式并轻松确定它是否有效然后使用 XSLT 1.0 生成具有某种格式的结果元素的好方法。

给定以下xml：

```
<root>
    <srcTime>2300</srcTime>
</root> 
```

生成生成的 xml 会很棒：

```
<root>
    <dstTime>23:00</dstTime>
</root> 
```

但是，如果源 xml 包含无效的 24 小时时间格式，则生成的*dstTime*元素应为空白。

例如，当无效的源 xml 如下：

```
<root>
    <srcTime>NOON</srcTime>
</root> 
```

生成的 xml 应该是：

```
<root>
    <dstTime></dstTime>
</root> 
```

问题是，可以编写以产生所需结果的**最佳 XSLT 1.0片段是什么？**希望是保持它非常简单，而不必每次都解析（即，如果可能的话，模式匹配会很甜蜜）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T21:39:46.150

XSLT 1.0 中没有任何正则表达式，所以恐怕无法进行模式匹配。

我不清楚是否`<srcTime>23:00</srcTime>`应该是合法的？如果是，请尝试：

```
<dstTime>
  <xsl:if test="string-length(srcTime) = 4 or
                string-length(srcTime) = 5">
    <xsl:variable name="hour" select="substring(srcTime, 1, 2)" />
    <xsl:if test="$hour >= 0 and 24 > $hour">
      <xsl:variable name="minute">
        <xsl:choose>
          <xsl:when test="string-length(srcTime) = 5 and
                          substring(srcTime, 3, 1) = ':'">
            <xsl:value-of select="substring(srcTime, 4, 2)" />
          </xsl:when>
          <xsl:when test="string-length(srcTime) = 4">
            <xsl:value-of select="substring(srcTime, 3, 2)" />
          </xsl:when>
        </xsl:choose>
      </xsl:variable>
      <xsl:if test="$minute >= 0 and 60 > $minute">
        <xsl:value-of select="concat($hour, ':', $minute)" />
      </xsl:if>
    </xsl:if>
  </xsl:if>
</dstTime> 
```

如果不是，并且只有四位数是合法的，那么：

```
<dstTime>
  <xsl:if test="string-length(srcTime) = 4">
    <xsl:variable name="hour" select="substring(srcTime, 1, 2)" />
    <xsl:if test="$hour >= 0 and 24 > $hour">
      <xsl:variable name="minute" select="substring(srcTime, 3, 2)" />
      <xsl:if test="$minute >= 0 and 60 > $minute">
        <xsl:value-of select="concat($hour, ':', $minute)" />
      </xsl:if>
    </xsl:if>
  </xsl:if>
</dstTime> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-26T22:53:20.663

XSLT 1.0 对日期/时间操作没有任何标准支持。

您必须编写一个简单的解析和格式化函数。这不会很简单，也不会很漂亮。

XSLT 确实是为树转换而设计的。这种文本节点操作最好在 XSLT 之外完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T21:03:44.573

根据使用的实际 xslt 处理器，您可以在自定义扩展功能中执行所需的操作（您必须自己制作）。

[Xalan 对扩展函数](http://xml.apache.org/xalan-j/extensions.html)有很好的支持，您不仅可以用 Java 编写它们，还可以用 JavaScript 或[Apache BSF](http://jakarta.apache.org/bsf/index.html)支持的其他语言编写它们。

Microsoft 的 XSLT 引擎也支持自定义扩展，如[.NET Framework 开发人员指南，扩展 XSLT 样式表中所述](http://msdn.microsoft.com/en-us/library/6datxzsd.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T00:08:24.383

看看： [http](http://www.exslt.org/) ://www.exslt.org/特别是“日期和时间”部分。我还没有深入研究它，但它看起来可能是你正在寻找的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T01:51:37.613

甚至 exslt.org 的 time() 函数在这里也无济于事，因为它希望其输入采用正确的格式（xs:dateTime 或 xs:time）。

这是最好在 XSLT 之外解决的问题。我这样说是作为一个经常使用 XSLT 来完成并非真正为它设计的事情并设法让事情正常工作的人。它*真的*不是为了解析字符串而设计的。

理想的解决方案是修复生成 XML 文档的任何内容，以便它使用专门为此目的方便地建立的国际标准来格式化时间，使用的原则是，如果可以避免这样做，您不应该保留或传输垃圾数据。

但如果这不可能，您应该在将数据传递给 XSLT 之前修复数据，或者在生成转换的输出之后修复它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T21:05:41.777

为了使列表完整，Steve Ball 还提供了 XSLT 标准库的[日期/时间处理模块](http://xsltsl.sourceforge.net/date-time.html)部分。

# java - 如何阻止 Eclipse 3.4 在项目中丢失对 JRE 的引用

> ID：142404
> 
> 赞同：2
> 
> 时间：2008-09-26T22:47:42.097
> 
> 标签：java, eclipse, eclipse-3.4, ganymede

有时在使用 eclipse 时，它​​会丢失对 JRE 的引用。

即它找不到像Object 或Arraylist 这样的类。

一些项目报告了问题，而另一些项目则没有，它们都使用相同的 JRE。

我发现如果您将已安装的 JRE 切换到另一个，然后再切换回您要使用的 JRE，它将再次工作

有没有更好的方法来阻止它这样做？

编辑：重新加载 Eclipse 并不能解决问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T06:11:04.253

项目中的 JRE 引用使用您在 Installed JREs 首选项页面中指定的名称存储。更改名称并破坏引用。只需选择在切换 JRE 时可以重复使用的名称，或者选择工作区默认值作为项目的 JRE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-10T19:21:27.223

我可能对此有一个解决方案。Eclipse 几乎每天都在我的许多 Java 项目中丢失 JRE 引用，并且重新启动或使用 -clean 开始没有帮助。我意识到这显然是某种类加载器问题，所以我所做的是在编辑器中打开每个项目的“.classpath”文件，并手动将 JRE 引用 classpathentry 行移动到文件中的第一个条目，在希望它会在任何其他可能影响其成功加载能力的类之前加载 JRE。

自从这样做以来，问题就没有再次出现。

我认为文件以“。”开头。在默认的 Eclipse 安装中被包资源管理器中的过滤器隐藏，因此您可能需要禁用“.* Resources”过滤器才能打开“.classpath”文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T23:07:11.597

它发生在我身上，但在重新加载 Eclipse 后，一切都继续运行良好！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T23:10:59.497

就个人而言，我会将其归结为 eclipse 中的错误。检查并确保源 zip 与您在 eclipse 中的 JRE 安装一起安装。我知道你的痛苦。Eclipse 很棒，但它仍然有一些小错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T23:11:12.833

我也有过同样的经历。只在Ganymede。总是同一个项目。删除项目（当然不是源）并重新创建项目会暂时修复它。似乎快乐了一两个星期，然后又发生了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T05:06:10.267

在启动 eclipse 时运行 -clean 标志将从 eclipse 中删除临时垃圾并使 eclipse 整体运行得更好。我在这方面取得了不同程度的成功，而且它比重新创建项目或重新安装 Eclipse 更容易实现。试一试，看看会发生什么。

即使这不适用于 3.4，它仍然适用。 [http://www.eclipsezone.com/eclipse/forums/t61566.html](http://www.eclipsezone.com/eclipse/forums/t61566.html)

# ruby-on-rails - 开始对 Ruby Rails 网站进行单元和功能测试的最佳方式是什么？

> ID：142407
> 
> 赞同：11
> 
> 时间：2008-09-26T22:48:34.917
> 
> 标签：ruby-on-rails, ruby, unit-testing

我正在测试一个 Ruby Rails 网站，并想开始进行单元和功能测试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-26T23:58:37.010

[Cucumber](http://github.com/aslakhellesoy/cucumber/wikis)和[RSpec](http://rspec.info/)值得一看。他们鼓励以[行为驱动](http://behaviour-driven.org/)、基于示例的方式进行测试。

RSpec 是一个用于单元级测试的库：

```
describe "hello_world"
  it "should say hello to the world" do
    # RSpec comes with its own mock-object framework built in,
    # though it lets you use others if you prefer
    world = mock("World", :population => 6e9)
    world.should_receive(:hello)
    hello_world(world)
  end
end 
```

它对 Rails 有特殊的支持（例如，它可以单独测试模型、视图和控制器）并且可以替换 Rails 内置的测试机制。

Cucumber（以前称为 RSpec Story Runner）允许您用（相当）简单的英语编写高级验收测试，您可以向客户展示（并同意）客户，然后运行它们：

```
Story: Commenting on articles

  As a visitor to the blog
  I want to post comments on articles
  So that I can have my 15 minutes of fame

  Scenario: Post a new comment

    Given I am viewing an article
    When I add a comment "Me too!"
    And I fill in the CAPTCHA correctly
    Then I should see a comment "Me too!" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-26T23:59:33.030

我的建议是（认真地）绕过内置的 rails 单元/功能测试的东西，直接进入[RSpec](http://www.rspec.info/)。

内置的 rails 东西使用了`Test::Unit`ruby​​ 附带的框架，它或多或少是 JUnit/NUnit/AnyOtherUnit 的直接端口。
我发现这些框架都相当乏味和烦人，导致对编写单元测试普遍冷漠，这显然不是你在这里想要实现的。

RSpec 是一种不同的野兽，它专注于描述你的代码*应*该做什么，而不是断言它*已经做*了什么。它将改变您对测试的看法，并且您将获得更多乐趣。

如果我听起来有点像个狂热分子，那只是因为我真的相信 RSpec 是那么好。我从对单元/功能测试感到恼火和厌倦，变成了它的坚定信徒，这几乎完全是因为 rspec。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-27T10:05:15.167

听起来您已经编写了应用程序，所以我不确定您是否会从使用`RSpec`over中获得丰厚的回报`Test::Unit`。

无论如何，无论您选择哪一个，您都会很快遇到另一个问题：管理固定装置和模拟（即您的测试“数据”）。所以看看[Shouda](http://www.thoughtbot.com/projects/shoulda)和[Factory Girl](http://giantrobots.thoughtbot.com/2008/6/6/waiting-for-a-factory-girl)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T14:23:24.280

您还可以使用 Firefox 插件（例如[http://selenium.openqa.org/ ）测试 Web 界面](http://selenium.openqa.org/)

它将记录点击和文本输入，然后播放并检查页面是否有正确的显示元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-29T14:19:59.420

即使已经编写了应用程序，我还是建议使用 RSpec 而不是 Test::Unit，因为没有应用程序完成过这个简单的事实。您将要添加功能和重构代码。尽早养成正确的测试习惯将有助于减轻这些改变的痛苦

# apache - 使用 Apache 作为代理时禁用错误缓存

> ID：142409
> 
> 赞同：8
> 
> 时间：2008-09-26T22:49:08.300
> 
> 标签：apache, proxy, proxypass

当您使用 Apache 代理（使用 ProxyPass 或 RewriteRule）时，如果目标返回错误（500 系列状态），则 Apache 将在 30 秒内不再代理任何请求。

我知道有一种方法可以通过将该值设置为 0 秒来禁用它，但我不记得如何了。我认为它涉及分号和一些选项，但我似乎无法在 apache.org 上找到该详细信息。

在开发环境中，您希望此值为 0，以便您可以修复错误并立即重新加载页面。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-26T22:57:22.087

您应该使用这样的设置；源[Apache 文档](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypass)

```
ProxyPass /mirror/foo/ http://backend.example.com/ retry=0 
```

# generics - 有没有办法确定 Lua 函数的签名？

> ID：142417
> 
> 赞同：6
> 
> 时间：2008-09-26T22:53:29.773
> 
> 标签：generics, functional-programming, lua

最近，[Lee Baldwin](https://stackoverflow.com/users/5200/lee-baldwin)展示了如何编写一个[通用的可变参数记忆函数](https://stackoverflow.com/questions/129877/how-do-i-write-a-generic-memoize-function#141689)。我认为最好返回一个只需要一个参数的更简单的函数。这是我的虚假尝试：

```
local function memoize(f)
   local cache = {}

   if select('#', ...) == 1 then
      return function (x)
                if cache[x] then
                   return cache[x]
                else
                   local y = f(x)
                   cache[x] = y
                   return y
                end
              end
   else
      return function (...)
                local al = varg_tostring(...)
                if cache[al] then
                   return cache[al]
                else
                   local y = f(...)
                   cache[al] = y
                   return y
                end
             end
   end
end 
```

显然，`select('#', ...)`在这种情况下失败了，无论如何也不会真正做我想做的事。有没有办法告诉内部**memoize** **f**期望多少个参数？

* * *

如果您确定，“不”是一个很好的答案。**使用两个独立的memoize**函数没什么大不了的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-26T22:56:55.707

我想你可以进入调试信息并从源代码中确定这一点，但基本上它是“不”，抱歉。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-14T02:11:12.833

是的，对于 Lua 函数但不是 C 函数。这有点折磨人，有点粗略。

`debug.getlocal`适用于被调用的函数，因此您必须调用有问题的函数。`...`除非调用传递了足够的参数，否则它不会显示任何提示。下面的代码尝试了 20 个参数。

`debug.sethook`“调用”事件提供了在函数运行任何代码之前拦截函数的机会。

该算法适用于 Lua 5.2。旧版本会相似但不一样：

```
assert(_VERSION=="Lua 5.2", "Must be compatible with Lua 5.2") 
```

一个小辅助迭代器（可以内联以提高效率）：

```
local function getlocals(l)
  local i = 0
  local direction = 1
  return function ()
    i = i + direction
    local k,v = debug.getlocal(l,i)
    if (direction == 1 and (k == nil or k.sub(k,1,1) == '(')) then 
      i = -1 
      direction = -1 
      k,v = debug.getlocal(l,i) 
    end
    return k,v
  end
end 
```

返回签名（但可以返回参数计数并使用Varargs，而不是）：

```
local function dumpsig(f)
  assert(type(f) == 'function', 
    "bad argument #1 to 'dumpsig' (function expected)")
  local p = {}
  pcall (function() 
    local oldhook
    local hook = function(event, line)
      for k,v in getlocals(3) do 
        if k == "(*vararg)" then 
          table.insert(p,"...") 
          break
        end 
        table.insert(p,k) end
      debug.sethook(oldhook)
      error('aborting the call')
    end
    oldhook = debug.sethook(hook, "c")
    -- To test for vararg must pass a least one vararg parameter
    f(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
  end)
  return "function("..table.concat(p,",")..")"  
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-26T22:59:06.327

我很确定你不能在 Lua 中做到这一点。

# java - Java：方法中的枚举参数

> ID：142420
> 
> 赞同：30
> 
> 时间：2008-09-26T22:55:02.093
> 
> 标签：java, parameters, methods, enums

我有一个方法可以说：

```
private static String drawCellValue(
    int maxCellLength, String cellValue, String align) { } 
```

如您所见，我有一个名为 align 的参数。在此方法中，我将对值是“左”还是“右”有一些 if 条件。将参数设置为字符串，显然我可以传递任何字符串值。我想知道是否有可能将 Enum 值作为方法参数，如果是，如何？

以防万一有人想到这一点；我考虑过使用布尔值，但我并不喜欢它。首先，如何将 true/false 与 left/right 关联？（好吧，我可以使用注释，但我仍然觉得它很脏）其次，我可能会决定添加一个新值，比如 'justify'，所以如果我有超过 2 个可能的值，布尔类型肯定是不可能使用的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-09-26T22:59:03.113

这应该这样做：

```
private enum Alignment { LEFT, RIGHT };    
String drawCellValue (int maxCellLength, String cellValue, Alignment align){
  if (align == Alignment.LEFT)
  {
    //Process it...
  }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-27T22:00:10.250

使用枚举更酷，您可以使用 switch：

```
switch (align) {
   case LEFT: { 
      // do stuff
      break;
   }
   case RIGHT: {
      // do stuff
      break;
   }
   default: { //added TOP_RIGHT but forgot about it?
      throw new IllegalArgumentException("Can't yet handle " + align);

   }
} 
```

枚举很酷，因为异常的输出将是枚举值的名称，而不是一些任意的 int 值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-04T20:00:46.883

我更喜欢这个。减少if / switch，就这样做。

```
private enum Alignment { LEFT, RIGHT;

void process() {
//Process it...
} 
};    
String drawCellValue (int maxCellLength, String cellValue, Alignment align){
  align.process();
} 
```

当然，也可以是：

```
String process(...) {
//Process it...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T23:02:05.807

当然，您可以使用枚举。会像以下工作吗？

```
enum Alignment {
    LEFT,
    RIGHT
} 
```

私有静态字符串drawCellValue（int maxCellLength，字符串cellValue，对齐对齐）{}

如果您想使用布尔值，您可以将 align 参数重命名为类似 alignLeft。我同意这个实现不是那么干净，但是如果你没有预料到会有很多变化并且这不是一个公共接口，它可能是一个不错的选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T06:34:56.823

您还可以重用 SwingConstants.{LEFT,RIGHT}。它们不是枚举，但它们确实已经存在并在许多地方使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-18T06:49:53.777

我不太确定我会去使用枚举作为一个成熟的类——这是一种面向对象的语言，面向对象的最基本原则之一是一个类应该做一件事并做好。

枚举在成为枚举方面做得很好，而一个类作为一个类做得很好。我有一种感觉，将两者混合起来会给你带来麻烦——例如，你不能将枚举的实例作为参数传递给方法，主要是因为你不能创建枚举的实例。

因此，即使您可能能够 enum.process() 并不意味着您应该这样做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-17T19:27:34.777

您可以在所述参数中使用枚举，如下所示：

```
public enum Alignment { LEFT, RIGHT }
private static String drawCellValue(
int maxCellLength, String cellValue, Alignment align) {} 
```

那么您可以使用 switch 或 if 语句来实际使用所述参数执行某些操作。

```
switch(align) {
case LEFT: //something
case RIGHT: //something
default: //something
}

if(align == Alignment.RIGHT) { /*code*/} 
```

# svn - 用于更改 JIRA/SVN 服务器的 Ldap 密码的应用程序

> ID：142431
> 
> 赞同：3
> 
> 时间：2008-09-26T22:59:44.140
> 
> 标签：svn, ldap, passwords, web-applications

我正在设置一个服务器来提供 JIRA 和 SVN。我想，我将使用 LDAP 来简化身份管理。

所以，在我写之前......有没有一个好的应用程序可以让用户更改他们的 ldap 密码？我想要一些可以让用户使用 ldap 进行身份验证并更新他们的密码的东西。包含用户名、旧密码、新密码和验证的表单就足够了。

我可以自己写，但如果已经有一个很好的应用程序可以处理这个问题，那么这样做似乎很愚蠢......

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-04T10:50:53.887

我想你可以试试[LDAP Self Service Portal](http://rubyforge.org/projects/ossp/)。

我们有同样的需求，但最终使用了我们正在使用的协作环境[Trac的](http://trac.edgewall.org/ "追踪")[Account Manager 插件](http://trac-hacks.org/wiki/AccountManagerPlugin)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T20:20:25.353

谢谢。我崩溃了，写了我自己的。我使用了谷歌网络工具包。这很简单。

# websphere - 如何建立上下文并从 Sun JRE（不是 IBM）调用 WebSphere EJB

> ID：142445
> 
> 赞同：1
> 
> 时间：2008-09-26T23:09:27.503
> 
> 标签：websphere, ejb, java

有没有办法从普通 JRE（如 Sun）调用通过 WebSphere（iiop://host:port/ejbName）提供的 EJB。很多人一直告诉我，这种类型的架构依赖于同质的环境。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T21:02:02.420

是的，这是可能的。你必须创建一个叫做瘦客户端的东西。由于不是容器环境的一部分，它对 JNDI 查找有限制，因此必须使用完全限定名称。

只需在谷歌上搜索“瘦客户端 ibm ejb”。不幸的是，我在这里没有指向相应库（对于 WAS 6）的链接，它们正在工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T11:22:36.040

虽然这是可能的，但我不推荐它，因为您要求在异构环境中使用 RMI-IIOP 遇到麻烦。

我的方法是将 EJB 公开为 Web 服务并在客户端使用。

# winapi - 如何使用 P/Invoke 在 PowerShell 1.0 中调用 Win32 函数？

> ID：142452
> 
> 赞同：4
> 
> 时间：2008-09-26T23:11:33.800
> 
> 标签：winapi, powershell, pinvoke

在许多情况下，从 PowerShell 脚本调用 Win32 函数或其他一些 DLL 会很有用。给定以下函数签名：

```
bool MyFunction( char* buffer, int* bufferSize ) 
```

我听说在 PowerShell CTP 2 中有一些东西可以让这更容易，但我很好奇如何**在 PowerShell 1.0 中最好地做到**这一点。需要调用的函数 ***使用指针***这一事实可能会影响解决方案（但我真的不知道）。

所以问题是编写一个可以调用上面导出的 Win32 函数的 PowerShell 脚本的最佳方法是什么？

**请记住 PowerShell 1.0。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-26T23:48:55.100

要从 Powershell 调用非托管代码，请使用由 Lee Holmes 创建的 Invoke-Win32 函数。你可以在[这里](http://www.leeholmes.com/blog/GetTheOwnerOfAProcessInPowerShellPInvokeAndRefOutParameters.aspx)找到源代码。在那里，您可以看到如何调用具有指针的函数的示例，但更简单的用法是：

```
PS C:\> Invoke-Win32 "msvcrt.dll" ([Int32]) "puts" ([String])  "Test"
Test
0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T23:44:28.777

PowerShell 1.0 中没有任何机制可以直接调用 Win32 API。您当然可以编写一个 C# 或 VB.NET 帮助程序类来为您执行此操作并从 PowerShell 中调用它。

更新：看看——

[http://blogs.msdn.com/powershell/archive/2006/04/25/583236.aspx](http://blogs.msdn.com/powershell/archive/2006/04/25/583236.aspx) [http://www.leeholmes.com/blog/ManagingINIFilesWithPowerShell.aspx](http://www.leeholmes.com/blog/ManagingINIFilesWithPowerShell.aspx)

# web-services - 来自 WebService 的 WMI 调用

> ID：142453
> 
> 赞同：2
> 
> 时间：2008-09-26T23:11:42.163
> 
> 标签：web-services, iis-6, wmi, asmx

因此，我创建了一个与 WMI 命名空间中包含的一组数据交互的 Web 服务。当我在内置开发 Web 服务器中使用 ASP.net 运行它时，它工作正常，并按要求返回数据。但是，当我将它发布到 IIS 6 服务器（win 2003）时，Web 服务不再允许我执行 WMI 方法调用。但是，它确实让我仍然可以从中阅读。

相反，它给了我：

> System.Management.ManagementException: 在 System.Management.ManagementObject.InvokeMethod(String methodName, ManagementBaseObject inParameters, InvokeMethodOptions options) 在 System.Management.ManagementObject.InvokeMethod(String methodName,对象 [] 参数）

我试图解决这个问题（是的，我知道这是一个不好的做法，但我只是想看看它是否会起作用），方法是将“每个人”组添加到该 WMI 命名空间安全设置并给予他们完整的权限（包括执行） . 然后重置IIS。但是我仍然收到此错误。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T00:29:18.607

使用 IIS 作为“正确”用户帐户运行应该可以。

“每个人”组并不意味着“绝对每个人”——它的意思是“每个经过身份验证的用户”。如果您无法进行身份验证，您仍然不是每个人的一部分。如果您要使用需要网络权限的 WMI 资源，那么它仍然会失败。

除此之外，访问 WMI 可能需要默认帐户 IIS 运行时没有的用户权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T18:06:14.437

好吧，从技术上讲，每个人和“经过身份验证的用户”是不同的。

Everone 包括“guest”帐户和“guests”组、null 和匿名连接。每个人*都是*每个人。“经过身份验证的用户”是提供凭据的任何人。有点微妙，但很重要。

如果客人被禁用，那么我相信它们在所有实际用途上都是相同的，尽管每个人都可能包括“空”和“匿名”会话。

# web-applications - What are the main differences between the popular web frameworks?

> ID：142470
> 
> 赞同：12
> 
> 时间：2008-09-26T23:21:18.303
> 
> 标签：web-applications, frameworks, comparison

There are [lots of web application frameworks](http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks) available these days, for pretty much every language out there. In your experience, what are their strengths, weaknesses, and unique features? Assuming the luxury of choice, what factors would lead you to consider one over another other?

I'm most interested in people's direct experience with one or more frameworks, rather than an exhaustive comparison of everything out there. Hopefully the SO community has programmers who have good and bad experiences with things like [Rails](http://www.rubyonrails.org/), [ASP.NET](http://www.asp.net), [Django](http://www.djangoproject.com/), [TurboGears](http://turbogears.org/), or [JSF](http://java.sun.com/javaee/javaserverfaces/). It would also be great to hear if anyone is using one of the less mainstream frameworks like [Seaside](http://www.seaside.st/) or [Weblocks](http://common-lisp.net/project/cl-weblocks/).

Programming language is an obvious difference, but a Java vs Ruby flamewar won't be much fun, and most of these frameworks seem to be at least as much an investment in technology, tools and complexity as their language of choice; so I'm more interested in things like:

*   Development speed and convenience
*   Barriers to entry - both in terms of developer training, and of infrastructure needed
*   Lock-in - how much code could you keep if you had to switch frameworks?
*   Flexibility - does the framework dictate your architecture or design? (Whether that would be a good or bad thing is probably best left to a separate discussion.)
*   Performance, scalability, and stability - obviously depending on the developers!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-27T01:02:48.480

I am going to briefly address each area for three popular Python frameworks. This is only based on my personal experiences and observations.

## Development speed and convenience

For **TurboGears**, **Pylons**, and **Django**, development speed is roughly equal. Being modern frameworks, it's easy to get started on a new site and start throwing together pages. Python is famously fast to develop and debug and I would put any Python framework as having a shorter development time than any other setup I've worked with (including PHP, Perl, Embedded Perl, and C#/ASP.Net).

## Barriers to entry - developer training and infrastructure

If you know Python and are willing to watch a [20 minute video tutorial](http://files.turbogears.org/video/20MinuteWiki2nd.mov), you can create a fairly complete wiki-type site from scratch. Or you can walk through a [social-bookmarking site tutorial](http://aymanh.com/turbogears-tutorial-social-bookmarking-application) in 30 minutes (including installation). These are TurboGears examples but the other two frameworks have nearly identical tutorials as well.

The test/development infrastructure that comes out of the box with these frameworks is generally enough to complete most sites. At any point, you can swap out components to meet your production environment requirements. For example, SQLite is fine for setting up your models and loading test data, but you will want to install MySQL (for example) before going live or storing large amounts of data.

In all cases, the requirements are very low and dictated entirely by your scalability requirements and not any peculiarities of the framework. If you are comfortable with a certain template language or ORM, it will probably plug right in.

## Lock-in

This is a generalized problem across all frameworks. When you select a language, you limit your code-reuse options. When you select a templater, you are again locked in (although that's easier to change, in general, than other things). The same goes for your ORM, database, and so on. There is nothing these frameworks do specifically that will help or hinder lock-in.

## Flexibility

It's all about MVC with these three frameworks. As you said, that's a very different discussion!

## Performance, scalability, and stability

Well, if you write good code, your site will perform well! Again, this is a problem across all frameworks addressed by [different development techniques](http://agilemanifesto.org/principles.html) and is probably way outside the scope of this answer.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T01:46:29.530

Django vs Struts.

**Development speed and convenience.**

Django - up and running in the time required to build the model (in Python), define the Admin mappings (2-3 lines of code per model class) and create HTML templates to work with the default master-detail views.

Struts - have to define a database in SQL, then define ORM mappings in iBatis. Then define, test and build various application components, using action classes and JSP template pages. Oh, and I need to define EJB's to move data from application to JSP's. It's all got to compile and I've got to work through numerous details just to get something that fits the compile rules.

**Barriers to entry** - both in terms of developer training, and of infrastructure needed

Constant across all frameworks and languages. This is pretty much a don't care item. No language or framework is inherently easy to train. All web frameworks have similar infrastructure requirements.

**Lock-in** - how much code could you keep if you had to switch frameworks?

This doesn't make a lot of sense. If you switch from Tomcat to any of the Tomcat derivatives, you can preserve a lot of Java code. Otherwise, you generally don't preserve much code when you switch framework.

**Flexibility** - does the framework dictate your architecture or design? (Whether that would be a good or bad thing is probably best left to a separate discussion.)

Actually, that's not a separate discussion. That's the point. Frameworks dictate your architecture -- and that's a good thing. Indeed, the framework is code you don't have to write, test, debug or support. It's a good thing that your application is confined by the framework to a proven, workable structure.

**Performance, scalability, and stability** - obviously depending on the developers!

Performance is language (not framework). It's design. To an extent, its also implementation configuration.

Scalability is framework (not language). It's design and configuration.

Stability is across the board: OS, language, framework, design, programming, QA and implementation configuration.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T00:13:19.533

This is an incredibly subjective question.. and that's a tag you ought to add to your question. As several comments have already suggested, you've already specified a pretty good guide; what are you actually asking? There's a billion opinions about this sort of thing and definitely no right answer!

Personally, I started using .html, moved onto php, tried ruby (hated it), discovered Python / DJango.. and have been happy ever since. That's a very unique path to take though (probably) so your mileage may vary :)

# windows - WM_GETMINMAXINFO，ptMaxSize 没有任何作用

> ID：142478
> 
> 赞同：1
> 
> 时间：2008-09-26T23:27:41.267
> 
> 标签：windows, winapi

在处理 WM_GETMINMAXINFO 消息时，我尝试通过更改 ptMaxSize 来更改参数 MINMAXINFO 结构。它似乎没有任何效果。当我收到 WM_SIZE 消息时，无论我增加还是减少 WM_GETMINMAXINFO 中的 ptMaxSize，我总是得到相同的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-29T03:33:27.367

确保您在主应用程序的窗口过程中处理**WM_GETMINMAXINFO**消息。

该消息仅在由主框架窗口处理时才有意义，如果该消息由其中一个子窗口过程处理，则该消息将无效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T23:34:45.273

你确定你的窗口最大化了吗？根据[http://msdn.microsoft.com/en-us/library/ms632605(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms632605(VS.85).aspx)， MINMAXINFO::ptMaxSize 控制最大化窗口的最大大小。

如果要控制你的窗口的最大跟踪尺寸（窗口正常时的最大尺寸），需要修改MINMAXINFO::ptMaxTrackSize。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-01T20:20:56.533

窗口必须具有`WS_THICKFRAME`or`WS_CAPTION`样式才能接收`WM_GETMINMAXINFO`。

这基本上就是您需要知道的所有内容。

# c# - 自动生成 .NET 单元测试

> ID：142481
> 
> 赞同：47
> 
> 时间：2008-09-26T23:28:20.953
> 
> 标签：c#, .net, unit-testing, automation, automated-tests

有没有单元测试生成之类的东西？如果是这样的话...

……效果好吗？

...有哪些可用于 .NET 的自动生成解决方案？

...有使用这种技术的例子吗？

...这仅适用于某些类型的应用程序，还是可以用来替代所有手动编写的单元测试？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-09-26T23:31:12.240

看看[Pex](http://research.microsoft.com/Pex/)。它是微软研究项目。从网站：

*Pex 通过基于动态符号执行的自动探索性测试从手写参数化单元测试生成单元测试。*

## 2019 年更新：

如评论中所述，Pex 现在称为[IntelliTest](https://docs.microsoft.com/en-us/visualstudio/test/generate-unit-tests-for-your-code-with-intellitest?view=vs-2019)，是 Visual Studio 企业版的一项功能。它支持以 MSTest、MSTest V2、NUnit 和 xUnit 格式发出测试，并且它是可扩展的，因此您可以将它与其他单元测试框架一起使用。

但请注意以下警告：

*   仅支持面向 .NET Framework 的 C# 代码。
*   不支持 x64 配置。
*   仅在 Visual Studio**企业版中可用**

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-26T23:32:06.887

就 TDD 而言，我相信单元测试生成毫无意义。

您只进行单元测试，以确保您（作为开发人员）在设计和规范方面处于正轨。一旦你开始自动生成测试，它就失去了这个目的。当然，这可能意味着 100% 的代码覆盖率，但这种覆盖率将是毫无意义和空洞的。

自动化单元测试还意味着您的策略是后测试，这与 TDD 的先测试原则相反。同样，TDD 与测试无关。

话虽如此，我相信 MSTest 确实有一个自动单元测试生成工具——我可以在 VS2005 中使用它。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-03-31T16:15:57.847

2017 年更新：

[单元测试样板生成器](https://marketplace.visualstudio.com/items?itemName=RandomEngy.UnitTestBoilerplateGenerator)适用于 VS 2015-2017 并且正在维护中。似乎像宣传的那样工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-11-13T02:30:07.817

我创建了`ErrorUnit`. 它从您的暂停或错误日志中生成`MSTest`或单元测试；到目前为止，模拟类变量、方法参数和 EF 数据访问。请参阅[http://ErrorUnit.com](http://ErrorUnit.com)`NUnit``Visual Studio`

没有单元测试生成器可以做任何事情。单元测试经典地分为三个部分*Arrange*、*Act*和*Assert*；Arrange 部分是单元测试的最大部分，它设置了测试的所有先决条件，模拟测试中将要执行的所有数据，单元测试的*Act*部分通常是一行. 它激活正在测试的代码部分，并传入该数据。最后，测试的*Assert*部分获取*Act*部分的结果并验证它是否符合预期（在确保没有错误时可以是零行）。

单元测试生成器通常只能在单元测试创​​建时执行*Arrange*和*Act*部分；但是，单元测试生成器通常不会编写*Assert*部分，因为只有您知道什么是正确的，什么是不正确的。因此，单元测试的一些手动输入/扩展对于完整性是必要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-26T23:42:34.210

我同意乔恩的观点。某些类型的测试，例如自动模糊测试，肯定会从自动生成中受益。虽然您可以使用单元测试框架的功能来实现这一点，但这并不能实现与良好的单元测试覆盖率相关的目标。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-22T15:23:52.840

[Parasoft .TEST](http://www.parasoft.com)具有测试生成功能。它使用 NUnit 框架进行测试描述和断言评估。

可以通过自动生成场景（构建输入和调用测试方法）和创建基于当前代码库行为的断言来准备回归测试套件。后来，在被测试的代码库发展之后，断言表明回归或者可以很容易地再次记录。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-26T23:39:54.653

我已经使用[NStub](http://code.google.com/p/nstub/)为我的课程进行测试。它运作良好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-28T00:16:26.913

我已经使用工具来生成测试用例。我认为它适用于更高级别的、面向最终用户的测试。这是用户验收测试的一部分，比纯粹的单元测试更重要。

我使用单元测试工具进行验收测试。它运作良好。

请参阅[构建测试用例的工具](http://homepage.mac.com/s_lott/iblog/architecture/C20071019092637/E20080830091128/index.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T11:45:33.573

有一个名为 AgitarOne (www.agitar.com) 的商业产品可以自动生成 JUnit 测试类。
我没有使用过它，所以无法评论它的用处，但如果我现在正在做一个 Java 项目，我会看看它。

我不知道 .net 等价物（Agitar 确实宣布了一个 .net 版本，但 AFAIK 它从未实现）。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2014-12-30T13:53:46.840

我知道这个线程很旧，但为了所有开发人员，有一个名为 nunit 的好库：

[https://marketplace.visualstudio.com/items?itemName=NUnitDevelopers.TestGeneratorNUnitextension](https://marketplace.visualstudio.com/items?itemName=NUnitDevelopers.TestGeneratorNUnitextension)

编辑：请使用 XUNIT（微软支持）：[https ://github.com/xunit/xunit](https://github.com/xunit/xunit)

自动生成的测试： [https ://marketplace.visualstudio.com/items?itemName=YowkoTsai.xUnitnetTestGenerator](https://marketplace.visualstudio.com/items?itemName=YowkoTsai.xUnitnetTestGenerator)

好的开发者

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2008-09-30T11:47:49.013

[Selenium](http://en.wikipedia.org/wiki/Selenium_(software))从网页上的用户命令生成单元测试，非常漂亮。

# java - Eclipse：依赖管理

> ID：142504
> 
> 赞同：7
> 
> 时间：2008-09-26T23:42:30.077
> 
> 标签：java, eclipse, maven-2, eclipse-plugin, dependencies

### 有哪些利用 Eclipse 进行依赖管理的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-26T23:50:58.887

我真的很喜欢[The Maven Integration for Eclipse (m2eclipse, Eclipse m2e)](http://maven.apache.org/eclipse-plugin.html)。我纯粹将它用于依赖管理功能。每次我建立一个项目时，不必出去下载一堆新的新罐子，真是太好了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T23:53:36.153

一个更简单的方法是[Maven Eclipse 插件](http://maven.apache.org/plugins/maven-eclipse-plugin/)（相对于 Eclipse 的 Maven 插件）。它只是一个 maven 插件，根据 pom 的内容生成 .project 和 .classpath 文件，您只需运行即可`mvn eclipse:eclipse`。它使用 Eclipse 中的类路径变量来定位本地 maven 存储库。

我个人大部分时间更喜欢这种方法，因为您可以更好地控制何时完成 maven 插件更新。它也少了一个需要处理的 Eclipse 插件。不过，最新版本的 m2eclipse 插件的 GUI 功能非常好。

m2eclipse 插件还有一个替代品，称为[Q4E](http://code.google.com/p/q4e/)，现在称为[Eclipse IAM](http://www.eclipse.org/iam/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T00:21:25.567

另一种选择是常春藤。Ivy 也有 Eclipse 集成。

可以在这里找到 maven 和 ivy 的比较：http: [//ant.apache.org/ivy/m2comparison.html](http://ant.apache.org/ivy/m2comparison.html)

# database - 您为 BA/PM 提供多少访问权限？

> ID：142507
> 
> 赞同：4
> 
> 时间：2008-09-26T23:43:52.973
> 
> 标签：database

在我工作的地方，我们有点进退两难……我在一个小团队工作，开发一个供内部使用的应用程序。我们最近刚刚收到了该项目的新 PM。她想访问我们的数据库和我们的源代码（存储在 svn 中）。我们以前的 PM 没有看到有必要也不想访问“我们的沙箱”中的任何东西。

话虽如此，给予 PM/BA 的适当访问量是多少？这是否存在某种安全漏洞？如果您同意 PM 应该可以访问其中的一个或两个，那是什么样的访问权限？

我对此进行了一些思考，起初我不想让 PM/BA 在我的沙箱中，但从那以后我就开始思考它会造成什么危害？我不正确吗？

这个结局值得一战吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-26T23:50:12.600

给她访问权限。让她从源代码控制中检查它并像其他人一样跟踪她。如果她改变任何东西，你就会有历史。如果她对实施提出建议，可能会有所帮助。如果她是个恶霸并开始对源代码大肆咆哮……她可能无论如何都会找到一种方法来做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T00:03:45.110

这实际上取决于 PM 对编程的了解程度。我工作的一些 PM 让我觉得完全可以让他们完全访问 SVN、读取和提交权限。其他 PM 我会相信他们具有读取权限，尽管我认为他们在看到代码时不会知道如何处理代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T23:58:06.373

您可能希望授予只读访问权限。由于经理倾向于将一切都掌握在自己手中，他们可能会在他们认为合适的时候更改代码，从而破坏您的审查/测试程序等。如果他们只想查看正在完成的工作/谁，那么授予只读访问权限会让他们满意正在做什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T01:15:22.147

我从来没有听说这被认为是一个问题或安全问题。事实上，在阅读了这个问题之后，**我对你的上一个 PM 在做什么有一些严肃的问题**！无论如何，要接受这样一个事实，即你有一个感兴趣的经理，并至少给她读取权限，这样她就可以检查一下，看看她的开发人员正在处理什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T01:09:27.573

如果她愿意，请授予她完全访问权限。她应该管理您正在开发的项目，并且为了有效地做到这一点，她可能需要能够查看项目的任何部分。

当然，她总是有可能做一些愚蠢或恶意的事情。如果您在流程审核中对任何更改进行了审核，您将能够查明她是否搞砸了任何事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T01:16:05.407

这在很大程度上取决于项目经理对项目的具体职责。她会帮助用户解决使用问题和故障排除吗？帮助测试？有什么理由能够探索数据会帮助她完成工作吗？

我认为对数据库的只读访问和对源的无提交访问不太可能是有害的，如果这让她觉得她更像是团队的一员并让她参与到项目中，那么这就是全部为了最好的。如果你拒绝，她肯定不会对你和她的融洽有任何帮助，而她却越过你的头脑并获得访问权。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T07:05:55.237

为了解决对安全性的担忧，如果您打算授予 PM 任何访问权限，请确保您获得了更高级别经理的批准。如果确实出现任何问题，至少您可以证明您遵守了公司政策（或被更高层的人豁免）。

至于访问权限，PM 没有对代码进行更改的业务，因此请坚持无写访问权限。除非他们实际上是在进行代码审查或需要他们查看代码的事情，否则甚至不需要读取访问权限。

# c - 如何使用预处理器指令检查操作系统？

> ID：142508
> 
> 赞同：257
> 
> 时间：2008-09-26T23:44:00.400
> 
> 标签：c, operating-system, c-preprocessor, conditional-compilation

我需要我的代码根据编译它的操作系统来做不同的事情。我正在寻找这样的东西：

```
#ifdef OSisWindows
// do Windows-specific stuff
#else
// do Unix-specific stuff
#endif 
```

有没有办法做到这一点？有没有更好的方法来做同样的事情？

* * *

## 回答 #1

> 赞同：385
> 
> 时间：2011-11-23T21:21:42.100

操作系统的**[预定义宏](https://sourceforge.net/p/predef/wiki/OperatingSystems/)**站点有一个非常完整的检查列表。以下是其中一些，并带有指向它们所在位置的链接：

## [视窗](http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx)

`_WIN32`   32 位和 64
`_WIN64`   位 仅 64 位
`__CYGWIN__`

## Unix（Linux、*BSD，但不是 Mac OS X）

有关使用此检查的一些陷阱，请参阅此[相关问题](https://stackoverflow.com/questions/7063303/)。

`unix`
`__unix`
`__unix__`

## Mac OS X

`__APPLE__`也用于经典
`__MACH__`

两者都被定义；检查任何一个都应该工作。

## [Linux](http://www.faqs.org/docs/Linux-HOWTO/GCC-HOWTO.html)

`__linux__`
`linux` 过时（不符合 POSIX）
`__linux`过时（不符合 POSIX）

## [自由BSD](http://www.freebsd.org/doc/en/books/porters-handbook/porting-versions.html)

`__FreeBSD__`

## 安卓

`__ANDROID__`

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-03-15T11:12:04.427

在 Windows 上显示 GCC 定义：

```
gcc -dM -E - <NUL: 
```

在 Linux 上：

```
gcc -dM -E - </dev/null 
```

MinGW 中的预定义宏：

```
WIN32 _WIN32 __WIN32 __WIN32__ __MINGW32__ WINNT __WINNT __WINNT__ _X86_ i386 __i386 
```

在 UNIX 上：

```
unix __unix__ __unix 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2017-02-04T12:37:07.633

基于[nadeausoftware](https://web.archive.org/web/20191012035921/http://nadeausoftware.com/articles/2012/01/c_c_tip_how_use_compiler_predefined_macros_detect_operating_system)和[Lambda Fairy 的回答](https://stackoverflow.com/a/8249232/6003870)。

```
#include <stdio.h>

/**
 * Determination a platform of an operation system
 * Fully supported supported only GNU GCC/G++, partially on Clang/LLVM
 */

#if defined(_WIN32)
    #define PLATFORM_NAME "windows" // Windows
#elif defined(_WIN64)
    #define PLATFORM_NAME "windows" // Windows
#elif defined(__CYGWIN__) && !defined(_WIN32)
    #define PLATFORM_NAME "windows" // Windows (Cygwin POSIX under Microsoft Window)
#elif defined(__ANDROID__)
    #define PLATFORM_NAME "android" // Android (implies Linux, so it must come first)
#elif defined(__linux__)
    #define PLATFORM_NAME "linux" // Debian, Ubuntu, Gentoo, Fedora, openSUSE, RedHat, Centos and other
#elif defined(__unix__) || !defined(__APPLE__) && defined(__MACH__)
    #include <sys/param.h>
    #if defined(BSD)
        #define PLATFORM_NAME "bsd" // FreeBSD, NetBSD, OpenBSD, DragonFly BSD
    #endif
#elif defined(__hpux)
    #define PLATFORM_NAME "hp-ux" // HP-UX
#elif defined(_AIX)
    #define PLATFORM_NAME "aix" // IBM AIX
#elif defined(__APPLE__) && defined(__MACH__) // Apple OSX and iOS (Darwin)
    #include <TargetConditionals.h>
    #if TARGET_IPHONE_SIMULATOR == 1
        #define PLATFORM_NAME "ios" // Apple iOS
    #elif TARGET_OS_IPHONE == 1
        #define PLATFORM_NAME "ios" // Apple iOS
    #elif TARGET_OS_MAC == 1
        #define PLATFORM_NAME "osx" // Apple OSX
    #endif
#elif defined(__sun) && defined(__SVR4)
    #define PLATFORM_NAME "solaris" // Oracle Solaris, Open Indiana
#else
    #define PLATFORM_NAME NULL
#endif

// Return a name of platform, if determined, otherwise - an empty string
const char *get_platform_name() {
    return (PLATFORM_NAME == NULL) ? "" : PLATFORM_NAME;
}

int main(int argc, char *argv[]) {
    puts(get_platform_name());
    return 0;
} 
```

用 GCC 测试并发出叮当声：

*   Debian 8
*   视窗 (MinGW)
*   窗口（Cygwin）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-26T23:55:01.310

在大多数情况下，最好检查给定的功能是否存在。例如：函数是否`pipe()`存在。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-26T23:58:19.163

# Microsoft C/C++ 编译器 (MSVC) 预定义宏可在[此处找到](https://docs.microsoft.com/en-us/cpp/preprocessor/predefined-macros?view=vs-2019)

我认为您正在寻找：

> *   `_WIN32`- 当编译目标是 32 位 ARM、64 位 ARM、x86 或 x64 时定义为 1。否则，未定义
> *   `_WIN64`- 当编译目标是 64 位 ARM 或 x64 时定义为 1。否则，未定义。

# gcc 编译器 PreDefined MAcros 可以在[这里找到](https://gcc.gnu.org/onlinedocs/cpp/Predefined-Macros.html)

我认为您正在寻找：

> *   `__GNUC__`
> *   `__GNUC_MINOR__`
> *   `__GNUC_PATCHLEVEL__`

为您预定义的适当编译器做一个谷歌。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-02-21T16:41:27.697

```
#ifdef _WIN32
// do something for windows like include <windows.h>
#elif defined __unix__
// do something for unix like include <unistd.h>
#elif defined __APPLE__
// do something for mac
#endif 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-01-27T14:49:04.870

在 MinGW 上，`_WIN32`定义检查不起作用。这是一个解决方案：

```
#if defined(_WIN32) || defined(__CYGWIN__)
    // Windows (x86 or x64)
    // ...
#elif defined(__linux__)
    // Linux
    // ...
#elif defined(__APPLE__) && defined(__MACH__)
    // Mac OS
    // ...
#elif defined(unix) || defined(__unix__) || defined(__unix)
    // Unix like OS
    // ...
#else
    #error Unknown environment!
#endif 
```

有关更多信息，请查看：[https ://sourceforge.net/p/predef/wiki/OperatingSystems/](https://sourceforge.net/p/predef/wiki/OperatingSystems/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-27T00:08:43.273

没有根据 C 标准设置的标准宏。一些 C 编译器会在某些平台上设置一个（例如，Apple 的修补 GCC 设置一个宏来指示它正在 Apple 系统上编译并用于 Darwin 平台）。您的平台和/或您的 C 编译器也可能会设置一些东西，但没有通用的方法。

就像 hayalci 所说，最好以某种方式在构建过程中设置这些宏。大多数编译器都可以轻松定义宏，而无需修改代码。您可以简单地传递`-D MACRO`给 GCC，即

```
gcc -D Windows
gcc -D UNIX 
```

在您的代码中：

```
#if defined(Windows)
// do some cool Windows stuff
#elif defined(UNIX)
// do some cool Unix stuff
#else
#    error Unsupported operating system
#endif 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-07-30T21:15:55.043

很抱歉外部参考，但我认为它适合您的问题：

[C/C++ 技巧：如何使用编译器预定义的宏来检测操作系统类型](https://web.archive.org/web/20191012035921/http://nadeausoftware.com/articles/2012/01/c_c_tip_how_use_compiler_predefined_macros_detect_operating_system)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-10-25T14:54:36.820

您可以使用[`Boost.Predef`](https://www.boost.org/doc/libs/develop/libs/predef/doc/index.html)其中包含目标平台的各种预定义宏，包括 OS ( `BOOST_OS_*`)。是的 boost 通常被认为是一个 C++ 库，但这个是一个预处理器头文件，也**可以与 C 一起使用！**

> 该库定义了一组编译器、体系结构、操作系统、库和其他版本号，这些信息来自它可以收集的 C、C++、Objective C 和 Objective C++ 预定义宏或在通常可用的头文件中定义的宏。这个库的想法源于扩展 Boost Config 库的提议，以提供比它支持的特性定义更多且一致的信息。以下是该简短提案的编辑版本。

例如

```
#include <boost/predef.h>

#if defined(BOOST_OS_WINDOWS)
#elif defined(BOOST_OS_ANDROID)
#elif defined(BOOST_OS_LINUX)
#elif defined(BOOST_OS_BSD)
#elif defined(BOOST_OS_AIX)
#elif defined(BOOST_OS_HAIKU)
...
#endif 
```

完整列表可在[`BOOST_OS`操作系统宏中找到](https://www.boost.org/doc/libs/develop/libs/predef/doc/index.html#_boost_os_operating_system_macros)

另请参阅[如何从 boost 中获取平台 ID](https://stackoverflow.com/q/46090534/995714)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-26T23:52:50.240

使用`#define OSsymbol`和`#ifdef OSsymbol` 其中 OSsymbol 是`#define`标识目标操作系统的“功能符号”。

通常，您将包含一个定义所选 OS 符号的中央头文件，并使用特定于 OS 的包含和库目录来编译和构建。

您没有指定您的开发环境，但我很确定您的编译器为通用平台和操作系统提供了全局定义。

另见[http://en.wikibooks.org/wiki/C_Programming/Preprocessor](http://en.wikibooks.org/wiki/C_Programming/Preprocessor)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-03-09T03:30:14.487

总结一下，这里有一堆有用的链接。

*   [GCC 通用预定义宏](https://gcc.gnu.org/onlinedocs/cpp/Common-Predefined-Macros.html#Common-Predefined-Macros)
*   [SourceForge 预定义的操作系统](https://sourceforge.net/p/predef/wiki/OperatingSystems/)
*   [MSDN 预定义宏](https://msdn.microsoft.com/en-us/library/b0084kay.aspx)
*   [链接多的 NaudeaSoftware 页面](http://nadeausoftware.com/articles/2012/01/c_c_tip_how_use_compiler_predefined_macros_detect_operating_system)
*   [维基百科！！！](http://en.wikibooks.org/wiki/C_Programming/Preprocessor)
*   [SourceForge 的“标准、编译器、操作系统和硬件架构的预定义编译器宏概述”。](http://predef.sourceforge.net/prestd.html)
*   [FreeBSD 的“差异化操作系统”](https://www.freebsd.org/doc/en/books/porters-handbook/porting-versions.html)
*   [各种预定义宏](https://sourceforge.net/p/predef/wiki/Home/)
*   [`libportable`](https://github.com/aaronryank/libportable)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-10-11T20:05:57.327

我在这里没有找到[俳句](https://www.haiku-os.org "俳句")定义。完整地说，Haiku-os 的定义很简单`__HAIKU__`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-26T23:52:06.607

一些编译器会生成 #defines 来帮助你。阅读编译器文档以确定它们是什么。[MSVC](https://msdn.microsoft.com/en-us/library/b0084kay.aspx)定义了一个`__WIN32__`，[GCC](https://gcc.gnu.org/onlinedocs/gcc/Preprocessor-Options.html)有一些你可以看到`touch foo.h; gcc -dM foo.h`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-01-10T21:44:44.070

您可以在编译时使用**预处理器指令**作为***警告或错误***来检查您根本不需要**运行**这个程序，只需简单地**编译**它。

```
#if defined(_WIN32) || defined(_WIN64) || defined(__WINDOWS__)
    #error Windows_OS
#elif defined(__linux__)
    #error Linux_OS
#elif defined(__APPLE__) && defined(__MACH__)
    #error Mach_OS
#elif defined(unix) || defined(__unix__) || defined(__unix)
    #error Unix_OS
#else
    #error Unknown_OS
#endif

#include <stdio.h>
int main(void)
{
    return 0;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-11-12T17:33:12.947

我编写了一个[小库](https://github.com/abranhe/os.c)来获取您所在的操作系统，它可以使用[clib](https://clibs.org)（C 包管理器）安装，因此将它用作项目的依赖项非常简单。

### 安装

```
$ clib install abranhe/os.c 
```

### 用法

```
#include <stdio.h>
#include "os.h"

int main()
{
    printf("%s\n", operating_system());
    // macOS
    return 0;
} 
```

它返回一个字符串 ( `char*`)，其中包含您正在使用的操作系统的名称，有关此项目的更多信息，请查看[Github 上的文档](https://github.com/abranhe/os.c/blob/master/readme.md#api)。

# web-applications - 帮助编辑远程 Web 应用程序的工具

> ID：142519
> 
> 赞同：0
> 
> 时间：2008-09-26T23:50:25.627
> 
> 标签：web-applications, ftp, remote-debugging, winscp

我通常只能通过 FTP 访问应用程序所在的服务器。

[我现在通常使用的是WinSCP](http://winscp.net/)的“保持远程目录最新”功能。本地副本的文件（至少在理论上）在保存后会立即上传到远程服务器，然后我只需要在浏览器中刷新页面以查看结果（有时会事先清除会话变量）。

撇开 WinSCP 的错误和 FTP 协议缺陷不谈，我觉得这可能有点原始的方法，也许有更好的方法来完成这样的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T23:52:57.523

我也有类似的情况。我曾经使用 Dreamweaver 进行 Web 开发，但已切换到其他没有 Dreamweaver 文件同步功能的工具。

**我最近发现了[BeyondCompare](http://www.scootersoftware.com/)**，这是一个 diff/merge 工具，非常适合比较本地和远程目录树。 **它是高度可配置的，并且还具有同步模式**。非常好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T00:02:28.657

如果您使用[Maven](http://maven.apache.org/)来自动化构建，我建议您使用[Cargo](http://cargo.codehaus.org/)插件将您的应用程序部署到服务器。

如果您不能使用容器的部署器，您仍然可以使用 Maven（需要做更多工作）通过[Wagon](http://maven.apache.org/wagon)使用 SCP、SFTP、FTP 甚至 WebDAV 来部署您的 Web 应用程序。

# database - .dbc --> .csv

> ID：142523
> 
> 赞同：1
> 
> 时间：2008-09-26T23:52:41.223
> 
> 标签：database, csv, foxpro, file-conversion

我有一个将 .dbc 文件转换为 .csv 文件的小实用程序，麻烦的是，在转换的某个地方，某些数据丢失/被破坏/无论如何。我将 a.dbc 输入转换器，它会生成 a.csv。我删除了 a.dbc，然后通过转换器运行 a.csv，然后我返回一个“稍微”不同的 .dbc 文件，然后我开始使用。

有谁知道转换这些文件的更好方法？不丢失信息..

我在 HexCMP 中打开这两个文件（比较两个 hex 文件，向您展示差异），并且文件中的差异完全是随机的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T00:20:29.643

听起来这只不过是一个错误的实用程序。

如果您连续两次将相同的 .dbc 文件转换为 .csv 文件，您会得到完全相同的 .csv 文件吗？如果你运行 .csv 两次，你会得到相同的 .dbc 文件吗？这至少会告诉您错误在转换的哪一侧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T19:02:58.147

您是否有权访问 FoxPro 以直接从 FoxPro 将文件导出为 CSV 而无需使用该实用程序？这将允许您比较从 FoxPro 创建的 CSV 文件与您的实用程序，以尝试缩小问题所在。

# javascript - 突出显示文本区域内的文本

> ID：142527
> 
> 赞同：45
> 
> 时间：2008-09-26T23:54:02.530
> 
> 标签：javascript, textarea

是否可以使用 javascript 突出显示文本区域内的文本？仅更改部分文本区域的背景或*选择*部分文本？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-09-29T14:53:12.800

试试我今天早上写的这段代码，它会突出显示一组定义的单词：

```
<html>
    <head>
        <title></title>
        <!-- Load jQuery -->
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
        <!-- The javascript xontaining the plugin and the code to init the plugin -->
        <script type="text/javascript">
            $(function() {
                // let's init the plugin, that we called "highlight".
                // We will highlight the words "hello" and "world", 
                // and set the input area to a widht and height of 500 and 250 respectively.
                $("#container").highlight({
                    words:  ["hello","world"],
                    width:  500,
                    height: 250
                });
            });

            // the plugin that would do the trick
            (function($){
                $.fn.extend({
                    highlight: function() {
                        // the main class
                        var pluginClass = function() {};
                        // init the class
                        // Bootloader
                        pluginClass.prototype.__init = function (element) {
                            try {
                                this.element = element;
                            } catch (err) {
                                this.error(err);
                            }
                        };
                        // centralized error handler
                        pluginClass.prototype.error = function (e) {
                            // manage error and exceptions here
                            //console.info("error!",e);
                        };
                        // Centralized routing function
                        pluginClass.prototype.execute = function (fn, options) {
                            try {
                                options = $.extend({},options);
                                if (typeof(this[fn]) == "function") {
                                    var output = this[fn].apply(this, [options]);
                                } else {
                                    this.error("undefined_function");
                                }
                            } catch (err) {
                                this.error(err);
                            }
                        };
                        // **********************
                        // Plugin Class starts here
                        // **********************
                        // init the component
                        pluginClass.prototype.init = function (options) {
                            try {
                                // the element's reference ( $("#container") ) is stored into "this.element"
                                var scope                   = this;
                                this.options                = options;

                                // just find the different elements we'll need
                                this.highlighterContainer   = this.element.find('#highlighterContainer');
                                this.inputContainer         = this.element.find('#inputContainer');
                                this.textarea               = this.inputContainer.find('textarea');
                                this.highlighter            = this.highlighterContainer.find('#highlighter');

                                // apply the css
                                this.element.css('position','relative');

                                // place both the highlight container and the textarea container
                                // on the same coordonate to superpose them.
                                this.highlighterContainer.css({
                                    'position':         'absolute',
                                    'left':             '0',
                                    'top':              '0',
                                    'border':           '1px dashed #ff0000',
                                    'width':            this.options.width,
                                    'height':           this.options.height,
                                    'cursor':           'text'
                                });
                                this.inputContainer.css({
                                    'position':         'absolute',
                                    'left':             '0',
                                    'top':              '0',
                                    'border':           '1px solid #000000'
                                });
                                // now let's make sure the highlit div and the textarea will superpose,
                                // by applying the same font size and stuffs.
                                // the highlighter must have a white text so it will be invisible
                                this.highlighter.css({

                                    'padding':          '7px',
                                    'color':            '#eeeeee',
                                    'background-color': '#ffffff',
                                    'margin':           '0px',
                                    'font-size':        '11px',
                                    'font-family':      '"lucida grande",tahoma,verdana,arial,sans-serif'
                                });
                                // the textarea must have a transparent background so we can see the highlight div behind it
                                this.textarea.css({
                                    'background-color': 'transparent',
                                    'padding':          '5px',
                                    'margin':           '0px',
                                    'font-size':        '11px',
                                    'width':            this.options.width,
                                    'height':           this.options.height,
                                    'font-family':      '"lucida grande",tahoma,verdana,arial,sans-serif'
                                });

                                // apply the hooks
                                this.highlighterContainer.bind('click', function() {
                                    scope.textarea.focus();
                                });
                                this.textarea.bind('keyup', function() {
                                    // when we type in the textarea, 
                                    // we want the text to be processed and re-injected into the div behind it.
                                    scope.applyText($(this).val());
                                });
                            } catch (err) {
                                this.error(err);
                            }
                            return true;
                        };
                        pluginClass.prototype.applyText = function (text) {
                            try {
                                var scope                   = this;

                                // parse the text:
                                // replace all the line braks by <br/>, and all the double spaces by the html version &nbsp;
                                text = this.replaceAll(text,'\n','<br/>');
                                text = this.replaceAll(text,'  ','&nbsp;&nbsp;');

                                // replace the words by a highlighted version of the words
                                for (var i=0;i<this.options.words.length;i++) {
                                    text = this.replaceAll(text,this.options.words[i],'<span style="background-color: #D8DFEA;">'+this.options.words[i]+'</span>');
                                }

                                // re-inject the processed text into the div
                                this.highlighter.html(text);

                            } catch (err) {
                                this.error(err);
                            }
                            return true;
                        };
                        // "replace all" function
                        pluginClass.prototype.replaceAll = function(txt, replace, with_this) {
                            return txt.replace(new RegExp(replace, 'g'),with_this);
                        }

                        // don't worry about this part, it's just the required code for the plugin to hadle the methods and stuffs. Not relevant here.
                        //**********************
                        // process
                        var fn;
                        var options;
                        if (arguments.length == 0) {
                            fn = "init";
                            options = {};
                        } else if (arguments.length == 1 && typeof(arguments[0]) == 'object') {
                            fn = "init";
                            options = $.extend({},arguments[0]);
                        } else {
                            fn = arguments[0];
                            options = $.extend({},arguments[1]);
                        }

                        $.each(this, function(idx, item) {
                            // if the component is not yet existing, create it.
                            if ($(item).data('highlightPlugin') == null) {
                                $(item).data('highlightPlugin', new pluginClass());
                                $(item).data('highlightPlugin').__init($(item));
                            }
                            $(item).data('highlightPlugin').execute(fn, options);
                        });
                        return this;
                    }
                });

            })(jQuery);

        </script>
    </head>
    <body>

        <div id="container">
            <div id="highlighterContainer">
                <div id="highlighter">

                </div>
            </div>
            <div id="inputContainer">
                <textarea cols="30" rows="10">

                </textarea>
            </div>
        </div>

    </body>
</html> 
```

这是为另一篇文章写的（http://facebook.stackoverflow.com/questions/7497824/how-to-highlight-friends-name-in-facebook-status-update-box-textarea/7597420#7597420），但它似乎是你正在寻找的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-16T22:07:42.850

我为此编写的简单脚本：[**Jsfiddle**](http://jsfiddle.net/ZbTkJ/)

**选项：**

1.  可选的字符计数器。
2.  突出几个不同颜色的图案。
3.  正则表达式。
4.  将火柴收集到其他容器。
5.  简单的样式：字体颜色和字体、背景、边框半径和线高。
6.  Ctrl+Shift 用于改变方向。

    ```
    //include function like in the fiddle!

    //CREATE ELEMENT:

    create_bind_textarea_highlight({ 
         eleId:"wrap_all_highlighter",
         width:400,
         height:110,
         padding:5, 
         background:'white',
         backgroundControls:'#585858',
         radius:5,
         fontFamilly:'Arial',
         fontSize:13,
         lineHeight:18,
         counterlettres:true,
         counterFont:'red',
         matchpatterns:[["(#[0-9A-Za-z]{0,})","$1"],["(@[0-9A-Za-z]{0,})","$1"]],
         hightlightsColor:['#00d2ff','#FFBF00'],
         objectsCopy:["copy_hashes","copy_at"]
         //PRESS Ctrl + SHIFT for direction swip!
      });

     //HTML EXAMPLE:
     <div id="wrap_all_highlighter" placer='1'></div>
     <div id='copy_hashes'></div><!--Optional-->
     <div id='copy_at'></div><!--Optional--> 
    ```

玩得开心！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T10:19:14.663

上面的改进版本，也适用于 Regex 和更多 TextArea 字段：

```
<html>
    <head>
        <title></title>
    <!-- Load jQuery -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
    <!-- The javascript xontaining the plugin and the code to init the plugin -->
    <script type="text/javascript">
        $(function() {
            // let's init the plugin, that we called "highlight".
            // We will highlight the words "hello" and "world", 
            // and set the input area to a widht and height of 500 and 250 respectively.
            $("#container0").highlight({
                words:  [["hello","hello"],["world","world"],["(\\[b])(.+?)(\\[/b])","$1$2$3"]],
                width:  500,
                height: 125,
        count:0
            });
            $("#container1").highlight({
                words:  [["hello","hello"],["world","world"],["(\\[b])(.+?)(\\[/b])","$1$2$3"]],
                width:  500,
                height: 125,
        count: 1
            });
        });

        // the plugin that would do the trick
        (function($){
            $.fn.extend({
                highlight: function() {
                    // the main class
                    var pluginClass = function() {};
                    // init the class
                    // Bootloader
                    pluginClass.prototype.__init = function (element) {
                        try {
                            this.element = element;
                        } catch (err) {
                            this.error(err);
                        }
                    };
                    // centralized error handler
                    pluginClass.prototype.error = function (e) {
                        // manage error and exceptions here
                        //console.info("error!",e);
                    };
                    // Centralized routing function
                    pluginClass.prototype.execute = function (fn, options) {
                        try {
                            options = $.extend({},options);
                            if (typeof(this[fn]) == "function") {
                                var output = this[fn].apply(this, [options]);
                            } else {
                                this.error("undefined_function");
                            }
                        } catch (err) {
                            this.error(err);
                        }
                    };
                    // **********************
                    // Plugin Class starts here
                    // **********************
                    // init the component
                    pluginClass.prototype.init = function (options) {
                        try {
                            // the element's reference ( $("#container") ) is stored into "this.element"
                            var scope                   = this;
                            this.options                = options;

                            // just find the different elements we'll need

                            this.highlighterContainer   = this.element.find('#highlighterContainer'+this.options.count);
                            this.inputContainer         = this.element.find('#inputContainer'+this.options.count);
                            this.textarea               = this.inputContainer.find('textarea');
                            this.highlighter            = this.highlighterContainer.find('#highlighter'+this.options.count);

                            // apply the css
                            this.element.css({'position':'relative',
                'overflow':'auto',
                'background':'none repeat scroll 0 0 #FFFFFF',
                'height':this.options.height+2,
                'width':this.options.width+19,
                'border':'1px solid'
                });

                            // place both the highlight container and the textarea container
                            // on the same coordonate to superpose them.
                            this.highlighterContainer.css({
                                'position':         'absolute',
                                'left':             '0',
                                'top':              '0',
                                'border':           '1px dashed #ff0000', 
                                'width':            this.options.width,
                                'height':           this.options.height,
                                'cursor':           'text',
                'z-index':      '1'
                            });
                            this.inputContainer.css({
                                'position':         'absolute',
                                'left':             '0',
                                'top':              '0',
                                'border':           '0px solid #000000',
                'z-index':      '2',
                'background':   'none repeat scroll 0 0 transparent'
                            });
                            // now let's make sure the highlit div and the textarea will superpose,
                            // by applying the same font size and stuffs.
                            // the highlighter must have a white text so it will be invisible
            var isWebKit = navigator.userAgent.indexOf("WebKit") > -1,
            isOpera = navigator.userAgent.indexOf("Opera") > -1,
isIE /*@cc_on = true @*/,
isIE6 = isIE && !window.XMLHttpRequest; // Despite the variable name, this means if IE lower than v7

if (isIE || isOpera){
var padding = '6px 5px';
}
else {
var padding = '5px 6px';
}
                           this.highlighter.css({
                                'padding':      padding,
                                'color':            '#eeeeee',
                                'background-color': '#ffffff',
                                'margin':           '0px',
                                'font-size':        '11px' ,
                                'line-height':      '12px' ,
                                'font-family':      '"lucida grande",tahoma,verdana,arial,sans-serif'
                            });

                            // the textarea must have a transparent background so we can see the highlight div behind it
                            this.textarea.css({
                                'background-color': 'transparent',
                                'padding':          '5px',
                                'margin':           '0px',
                                'width':            this.options.width,
                                'height':           this.options.height,
                                'font-size':        '11px',
                                'line-height':      '12px' ,
                                'font-family':      '"lucida grande",tahoma,verdana,arial,sans-serif',
                'overflow':     'hidden',
                                'border':           '0px solid #000000'
                            });

                            // apply the hooks
                            this.highlighterContainer.bind('click', function() {
                                scope.textarea.focus();
                            });
                            this.textarea.bind('keyup', function() {
                                // when we type in the textarea, 
                                // we want the text to be processed and re-injected into the div behind it.
                                scope.applyText($(this).val());
                            });

            scope.applyText(this.textarea.val());

                        } catch (err) {
            this.error(err)
                        }
                        return true;
                    };
                    pluginClass.prototype.applyText = function (text) {
                        try {
                            var scope                   = this;

                            // parse the text:
                            // replace all the line braks by <br/>, and all the double spaces by the html version &nbsp;
                            text = this.replaceAll(text,'\n','<br/>');
                            text = this.replaceAll(text,'  ','&nbsp;&nbsp;');
                            text = this.replaceAll(text,' ','&nbsp;');

                            // replace the words by a highlighted version of the words
                            for (var i=0;i<this.options.words.length;i++) {
                                text = this.replaceAll(text,this.options.words[i][0],'<span style="background-color: #D8DFEA;">'+this.options.words[i][1]+'</span>');
                                //text = this.replaceAll(text,'(\\[b])(.+?)(\\[/b])','<span style="font-weight:bold;background-color: #D8DFEA;">$1$2$3</span>');
                            }

                            // re-inject the processed text into the div
                            this.highlighter.html(text);
            if (this.highlighter[0].clientHeight > this.options.height) {
                // document.getElementById("highlighter0")
                this.textarea[0].style.height=this.highlighter[0].clientHeight +19+"px";
            }
            else {
                this.textarea[0].style.height=this.options.height;
            }

                        } catch (err) {
                            this.error(err);
                        }
                        return true;
                    };
                    // "replace all" function
                    pluginClass.prototype.replaceAll = function(txt, replace, with_this) {
                        return txt.replace(new RegExp(replace, 'g'),with_this);
                    }

                    // don't worry about this part, it's just the required code for the plugin to hadle the methods and stuffs. Not relevant here.
                    //**********************
                    // process
                    var fn;
                    var options;
                    if (arguments.length == 0) {
                        fn = "init";
                        options = {};
                    } else if (arguments.length == 1 && typeof(arguments[0]) == 'object') {
                        fn = "init";
                        options = $.extend({},arguments[0]);
                    } else {
                        fn = arguments[0];
                        options = $.extend({},arguments[1]);
                    }

                    $.each(this, function(idx, item) {
                        // if the component is not yet existing, create it.
                        if ($(item).data('highlightPlugin') == null) {
                            $(item).data('highlightPlugin', new pluginClass());
                            $(item).data('highlightPlugin').__init($(item));
                        }
                        $(item).data('highlightPlugin').execute(fn, options);
                    });
                    return this;
                }
            });

        })(jQuery);

    </script>
</head>
<body>

    <div id="container0">
        <div id="highlighterContainer0">
            <div id="highlighter0"></div>
        </div>
        <div id="inputContainer0">
            <textarea id="text1" cols="30" rows="15">hello world</textarea>
        </div>
    </div>
<h1> haus </h1>
    <div id="container1">
        <div id="highlighterContainer1">
            <div id="highlighter1"></div>
        </div>
        <div id="inputContainer1">
            <textarea cols="30" rows="15">hipp hipp
 hurra, 
 [b]ich hab es jetzt![/b]</textarea>
        </div>
    </div>

</body> 
```

# python - 如何制作跨模块变量？

> ID：142545
> 
> 赞同：125
> 
> 时间：2008-09-26T23:59:47.337
> 
> 标签：python, module, global

该`__debug__`变量很方便，部分原因是它会影响每个模块。如果我想创建另一个以相同方式工作的变量，我该怎么做？

变量（让我们保持原始状态并称其为“foo”）不必是真正的全局变量，因为如果我在一个模块中更改 foo，它会在其他模块中更新。如果我可以在导入其他模块之前设置 foo 然后他们会看到相同的值，我会很好。

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2008-09-27T00:25:00.987

如果您需要一个全局跨模块变量，那么简单的全局模块级变量可能就足够了。

一个.py：

```
var = 1 
```

b.py：

```
import a
print a.var
import c
print a.var 
```

c.py：

```
import a
a.var = 2 
```

测试：

```
$ python b.py
# -> 1 2 
```

实际示例：[Django 的 global_settings.py](https://github.com/django/django/blob/master/django/conf/global_settings.py)（尽管在 Django 应用程序中，设置是通过导入*对象* [`django.conf.settings`](http://docs.djangoproject.com/en/dev/topics/settings/#using-settings-in-python-code)来使用的）。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2008-09-27T00:09:29.200

我不以任何方式、形式或形式认可此解决方案。但是，如果您向`__builtin__`模块添加一个变量，它将可以像来自任何其他模块的全局变量一样被访问`__builtin__`，默认情况下，这就是所有这些模块。

a.py 包含

```
print foo 
```

b.py 包含

```
import __builtin__
__builtin__.foo = 1
import a 
```

结果是打印了“1”。

**编辑：**该`__builtin__`模块可作为本地符号使用`__builtins__`——这就是这两个答案之间存在差异的原因。另请注意，在 python3`__builtin__`中已重命名为。`builtins`

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-09-27T00:15:19.763

定义一个模块（称之为“globalbaz”）并在其中定义变量。所有使用这个“pseudoglobal”的模块都应该导入“globalbaz”模块，并使用“globalbaz.var_name”引用它

无论更改的位置如何，这都有效，您可以在导入之前或之后更改变量。导入的模块将使用最新的值。（我在一个玩具示例中对此进行了测试）

为了澄清，globalbaz.py 看起来像这样：

```
var_name = "my_useful_string" 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-02-22T23:48:03.777

我相信在很多情况下它确实有意义，并且它简化了编程以拥有一些跨多个（紧密耦合）模块已知的全局变量。本着这种精神，我想详细说明一下拥有一个由需要引用它们的模块导入的全局模块的想法。

当只有一个这样的模块时，我将其命名为“g”。在其中，我为我打算视为全局的每个变量分配默认值。在使用其中任何一个的每个模块中，我不使用“from g import var”，因为这只会导致一个局部变量，该变量仅在导入时从 g 初始化。我以 g.var 和“g”的形式进行大多数引用。不断提醒我正在处理其他模块可能访问的变量。

如果这样一个全局变量的值要在模块中的某个函数中频繁使用，那么该函数可以制作一个本地副本：var = g.var。但是，重要的是要意识到对 var 的赋值是本地的，如果没有在赋值中显式引用 g.var 就无法更新全局 g.var。

请注意，您还可以让模块的不同子集共享多个此类全局模块，以使事情得到更严格的控制。我为我的全局模块使用短名称的原因是为了避免因为它们的出现而使代码过于混乱。只需一点经验，它们就变得足够记忆，只需 1 或 2 个字符。

当 x 尚未在 g 中定义时，仍然可以对 gx 进行赋值，然后不同的模块可以访问 gx 但是，即使解释器允许，这种方法也不是那么透明，我确实避免它。由于分配的变量名称中的拼写错误，仍然有可能在 g 中意外创建一个新变量。有时，对 dir(g) 的检查有助于发现此类意外可能出现的任何意外名称。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-07-17T02:22:22.183

您可以将一个模块的全局变量传递给另一个模块：

在模块 A 中：

```
import module_b
my_var=2
module_b.do_something_with_my_globals(globals())
print my_var 
```

在模块 B 中：

```
def do_something_with_my_globals(glob): # glob is simply a dict.
    glob["my_var"]=3 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-27T01:03:43.157

全局变量通常是一个坏主意，但您可以通过分配来做到这一点`__builtins__`：

```
__builtins__.foo = 'something'
print foo 
```

此外，模块本身是您可以从任何模块访问的变量。因此，如果您定义一个名为的模块`my_globals.py`：

```
# my_globals.py
foo = 'something' 
```

然后你也可以在任何地方使用它：

```
import my_globals
print my_globals.foo 
```

使用模块而不是修改`__builtins__`通常是执行此类全局变量的更干净的方法。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-10-12T01:26:37.697

您已经可以使用模块级变量执行此操作。无论从哪个模块导入模块，它们都是相同的。因此，您可以在任何有意义的模块中将变量设置为模块级变量，并从其他模块访问或分配给它。最好调用一个函数来设置变量的值，或者使其成为某个单例对象的属性。这样，如果您最终需要在变量更改时运行一些代码，您可以这样做而不会破坏模块的外部接口。

这通常不是做事的好方法——很少使用全局变量——但我认为这是最干净的方法。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-07-31T03:14:05.813

我想发布一个答案，即存在找不到变量的情况。

循环导入可能会破坏模块行为。

例如：

第一个.py

```
import second
var = 1 
```

第二个.py

```
import first
print(first.var)  # will throw an error because the order of execution happens before var gets declared. 
```

主文件

```
import first 
```

在这个例子中应该很明显，但在大型代码库中，这可能真的很混乱。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-04-14T11:05:51.783

我想知道是否可以通过使用类命名空间而不是全局/模块命名空间来避免使用全局变量的一些缺点（参见例如[http://wiki.c2.com/?GlobalVariablesAreBad](http://wiki.c2.com/?GlobalVariablesAreBad)）来传递变量的值. 下面的代码表明这两种方法本质上是相同的。如下所述，使用类命名空间有一点优势。

以下代码片段还显示了属性或变量可以在全局/模块命名空间和类命名空间中动态创建和删除。

墙.py

```
# Note no definition of global variables

class router:
    """ Empty class """ 
```

我将此模块称为“墙”，因为它用于反弹变量。它将充当临时定义空类“路由器”的全局变量和类范围属性的空间。

源码.py

```
import wall
def sourcefn():
    msg = 'Hello world!'
    wall.msg = msg
    wall.router.msg = msg 
```

此模块导入 wall 并定义一个函数`sourcefn`，该函数定义消息并通过两种不同的机制发出消息，一种通过全局变量，另一种通过路由器函数。请注意，变量`wall.msg`和`wall.router.message`是第一次在其各自的命名空间中定义。

目标.py

```
import wall
def destfn():

    if hasattr(wall, 'msg'):
        print 'global: ' + wall.msg
        del wall.msg
    else:
        print 'global: ' + 'no message'

    if hasattr(wall.router, 'msg'):
        print 'router: ' + wall.router.msg
        del wall.router.msg
    else:
        print 'router: ' + 'no message' 
```

该模块定义了一个函数`destfn`，它使用两种不同的机制来接收源发出的消息。它允许变量“msg”可能不存在。`destfn`变量显示后也会删除。

主文件

```
import source, dest

source.sourcefn()

dest.destfn() # variables deleted after this call
dest.destfn() 
```

该模块依次调用前面定义的函数。第一次调用后的`dest.destfn`变量又不存在了。`wall.msg``wall.router.msg`

该程序的输出是：

全球：世界你好！
路由器：世界你好！
全局：无消息
路由器：无消息

上面的代码片段表明模块/全局和类/类变量机制本质上是相同的。

如果要共享大量变量，可以通过使用几个墙类型模块（例如 wall1、wall2 等）或通过在单个文件中定义多个路由器类型类来管理名称空间污染。后者稍微整洁一些，因此可能代表使用类变量机制的边际优势。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-27T00:08:25.413

这听起来像是在修改`__builtin__`名称空间。去做吧：

```
import __builtin__
__builtin__.foo = 'some-value' 
```

不要`__builtins__`直接使用（注意额外的“s”）——显然这可以是字典或模块。感谢 ΤZΩΤZΙΟΥ 指出这一点，更多可以在[这里](http://groups.google.com/group/comp.lang.python/browse_thread/thread/1907d5e660444c08/69c29c4ec0c4d3ec "这里")找到。

现在`foo`可以在任何地方使用。

我一般不建议这样做，但使用它取决于程序员。

分配给它必须像上面那样完成，只是设置`foo = 'some-other-value'`只会将它设置在当前命名空间中。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-04-15T00:10:57.523

我将它用于我觉得确实缺少的几个内置原始函数。一个例子是 find 函数，它具有与 filter、map、reduce 相同的用法语义。

```
def builtin_find(f, x, d=None):
    for i in x:
        if f(i):
            return i
    return d

import __builtin__
__builtin__.find = builtin_find 
```

一旦运行（例如，通过在入口点附近导入），所有模块都可以使用 find() ，就好像它是内置的一样。

```
find(lambda i: i < 0, [1, 3, 0, -5, -10])  # Yields -5, the first negative. 
```

**注意：**当然，您可以使用 filter 和另一行来测试零长度，或者在一种奇怪的行中使用 reduce，但我总是觉得这很奇怪。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-12-02T15:24:38.653

我可以通过使用字典来实现跨模块的可修改（或**可变）变量：**

```
# in myapp.__init__
Timeouts = {} # cross-modules global mutable variables for testing purpose
Timeouts['WAIT_APP_UP_IN_SECONDS'] = 60

# in myapp.mod1
from myapp import Timeouts

def wait_app_up(project_name, port):
    # wait for app until Timeouts['WAIT_APP_UP_IN_SECONDS']
    # ...

# in myapp.test.test_mod1
from myapp import Timeouts

def test_wait_app_up_fail(self):
    timeout_bak = Timeouts['WAIT_APP_UP_IN_SECONDS']
    Timeouts['WAIT_APP_UP_IN_SECONDS'] = 3
    with self.assertRaises(hlp.TimeoutException) as cm:
        wait_app_up(PROJECT_NAME, PROJECT_PORT)
    self.assertEqual("Timeout while waiting for App to start", str(cm.exception))
    Timeouts['WAIT_JENKINS_UP_TIMEOUT_IN_SECONDS'] = timeout_bak 
```

启动`test_wait_app_up_fail`时，实际超时时间为 3 秒。

# java - 在Tomcat上部署war文件

> ID：142548
> 
> 赞同：18
> 
> 时间：2008-09-27T00:02:14.770
> 
> 标签：java, linux, tomcat, deployment, release-management

有没有办法在 Tomcat 服务器上部署给定的战争文件？我想在不使用 Web 界面的情况下执行此操作。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-27T08:56:37.857

部署 Tomcat webapp 有多种方法：

*   如前所述，进入 $CATALINA_HOME/webapps。
*   使用您的构建脚本通过管理器界面（Tomcat 附带）自动部署。这里有两种方式
    *   对于*Maven*：使用 tomcat 插件。您不需要将它包含在 中`pom.xml`，只需发出目标`mvn tomcat:deploy`，插件包含在 Maven 2 中。这假定[文档](http://mojo.codehaus.org/tomcat-maven-plugin/)中解释了几个默认值，您[可以](http://mojo.codehaus.org/tomcat-maven-plugin/usage.html)在`pom.xml`. 还有其他目标可以让您部署为展开的存档*等*。
    *   对于*蚂蚁*：像这样：

```
    <property name="manager.url" value="http://localhost:8080/manager"/>
    <property name="manager.username" value="manager"/>
    <property name="manager.password" value="foobar"/>
    <!-- 任务定义 -->
    <taskdef name="deploy" classname="org.apache.catalina.ant.DeployTask"/>
    <taskdef name="list" classname="org.apache.catalina.ant.ListTask"/>
    <taskdef name="reload" classname="org.apache.catalina.ant.ReloadTask"/>
    <taskdef name="undeploy" classname="org.apache.catalina.ant.UndeployTask"/>
    <!-- 目标 -->
    <target name="install" depends="compile" description="将应用程序安装到 servlet 容器">
        <部署 url="${manager.url}"
                用户名="${manager.username}"
                密码="${manager.password}"
                path="${app.path}"
                localWar="file://${build.home}"/>
    </目标>
    <target name="list" description="列出 servlet 容器上已安装的应用程序">
        <list url="${manager.url}"
                用户名="${manager.username}"
                密码="${manager.password}"/>
    </目标>
    <target name="reload" depends="compile" description="在 servlet 容器上重新加载应用程序">
        <reload url="${manager.url}"
                用户名="${manager.username}"
                密码="${manager.password}"
                path="${app.path}"/>
    </目标>
    <target name="remove" description="删除 servlet 容器上的应用程序">
        <undeploy url="${manager.url}"
                用户名="${manager.username}"
                密码="${manager.password}"
                path="${app.path}"/>
    </目标>

```

所有这些都需要您拥有 Tomcat 用户配置。它存在`$CATALINA_BASE/conf/tomcat-users.xml`，但是由于您已经知道如何使用 Web 界面，我假设您知道如何配置用户和密码。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-27T00:10:56.793

只需将 war 文件复制到 $TOMCAT_HOME/webapps/ 目录即可。Tomcat 将通过自动分解来部署 war 文件。仅供参考 - 如果您愿意，您可以直接对展开的目录进行更新，这对开发很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T00:05:43.687

您可以编辑 conf/server.xml 并添加一个像这样指向您的战争目录的条目

```
 <Context path="/strutsDisplayTag" 
        reloadable="true" 
        docBase="C:\work\learn\jsp\strutsDisplayTag" 
        workDir="C:\work\learn\jsp\strutsDisplayTag\work" /> 
```

否则，您可以将 .WAR 文件复制到 tomcat 的 webapps 目录。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T00:13:28.253

我们从不使用网络界面，不喜欢它。战争被丢弃在 webapps 和 server.xml 中，根据需要进行编辑。如果您编辑 server.xml，则需要将其退回，但应自动获取 war 文件。我们通常首先删除从战争中扩展的目录，这样就不会混淆组件的来源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T00:37:52.190

Tomcat[客户端部署程序包](http://tomcat.apache.org/tomcat-5.5-doc/deployer-howto.html#Deploying%20using%20the%20Client%20Deployer%20Package)看起来是您需要从命令行部署到远程服务器的内容。从页面：

> 这是一个可用于验证、编译、压缩为 .WAR 并将 Web 应用程序部署到生产或开发 Tomcat 服务器的包。应该注意的是，此功能使用 Tomcat 管理器，因此目标 Tomcat 服务器应该正在运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-03T07:04:15.047

你也可以试试这个名为 tomcat-manager[的用于管理 tomcat 的命令行脚本。](https://github.com/kotfu/tomcat-manager "https://github.com/kotfu/tomcat-manager")它需要 Python，并通过 HTTP 与包含在 tomcat 中的管理器应用程序对话。您可以从 *nix shell 执行以下操作：

```
$ tomcat-manager --user=admin --password=newenglandclamchowder \
> http://localhost:8080/manager/ stop /myapp 
```

和：

```
$ tomcat-manager --user=admin --password=newenglandclamchowder \
> http://localhost:8080/manager deploy /myapp ~/src/myapp/myapp.war 
```

# apache - 您是否必须重新启动apache才能使.htaccess中的重写规则生效？

> ID：142559
> 
> 赞同：101
> 
> 时间：2008-09-27T00:08:04.633
> 
> 标签：apache, .htaccess, mod-rewrite, restart

我已将 .htaccess 文件推送到生产服务器，但它们不起作用。下一步是重新启动，还是我应该检查其他东西。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-09-27T02:25:22.587

更改 .htaccess 不需要**重新**启动。还有什么不对劲的。

确保您的 .htaccess 包含该语句

> 重写引擎开启

这是必需的，即使它也存在于 httpd.conf 中。还要检查 httpd 进程是否可以读取 .htaccess。*检查 error_log -如果*正在使用
它，它将告诉您 .htaccess 中的任何错误。在 .htaccess 中故意设置语法错误是一个很好的检查，以确保文件正在被使用——您应该在同一目录中的任何页面上收到 500 错误。

 *最后，您可以在 httpd.conf 中使用如下命令启用重写日志：

> 重写日志“日志/重写日志”
> 
> RewriteLogLevel 7

这样生成的日志文件将为您提供匹配的重写规则以及如何处理它们的详细信息。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-09-27T00:12:29.397

[否](http://httpd.apache.org/docs/2.2/configuring.html#htaccess)：

> Apache 允许通过放置在 Web 树中的特殊文件对配置进行分散管理。特殊文件通常被称为`.htaccess`，但可以在[AccessFileName](http://httpd.apache.org/docs/2.2/mod/core.html#accessfilename)指令中指定任何名称...由于每个请求都会读取 .htaccess 文件，因此对这些文件所做的更改会立即生效...

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-27T00:31:15.170

来自 apache 文档：最常见的问题是未设置 AllowOverride 以使您的配置指令得到遵守。确保您没有对相关文件范围有效的 AllowOverride None。对此的一个很好的测试是将垃圾放入您的 .htaccess 文件并重新加载。如果未生成服务器错误，则几乎可以肯定 AllowOverride None 有效。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-27T00:28:50.323

仅当您*尚未*将 mod_rewrite 模块添加到 Apache 时。

如果您更改任何 Apache “.conf” 文件，您只需要重新启动 Apache。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-01T17:54:10.547

我有同样的问题，似乎 PiedPiper 关于 AllowOverride 的帖子最有帮助。检查您的 httpd.conf 文件中的“AllowOverride”并确保它设置为 All。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-29T11:09:17.990

如果 .htaccess 不起作用，则不需要重新启动，可能的原因包括。

*   [**AllowOverride**](https://httpd.apache.org/docs/2.4/mod/core.html#allowoverride)可能未设置哪个用户可以在 httpd.conf 中设置，或者可能必须联系服务器管理员。

*   检查 .htaccess 的文件名，它应该是 .htaccess 而不是 htaccess.txt，请参阅[**此处**](https://stackoverflow.com/questions/5004633/how-to-manually-create-a-file-with-a-dot-prefix-in-windows-for-example-htacce)以获取如何创建的指南。

*   尝试使用`Options -Indexes`or`deny all`一种简单的指令来查看它是否有效。

*   如果有重定向规则或类似规则，则每次清除浏览器缓存，如果缓存了先前的重定向，则看起来好像事情不起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T00:27:55.333

你的 .htaccess 中有什么？重写规则？检查 mod_rewrite 是否已安装并启用。

其他的东西？尝试在该目录上将 AllowOverride 设置为“全部”。

# javascript - 寻找关于为什么在打开包含 JavaScript 的 HTML 文件时显示 IE“黄条”的文档

> ID：142573
> 
> 赞同：1
> 
> 时间：2008-09-27T00:11:33.953
> 
> 标签：javascript, security, internet-explorer

我有一个站点，您可以从中下载 HTML 文件。此 HTML 文件包含一个带有隐藏字段的表单，该表单会立即使用 JavaScript 发布回站点。这是一种允许用户将他们在网站上编辑的数据下载到他们自己的机器上的方法。

在某些机器上，当您尝试打开您保存的文件时，您会看到一个 IE“黄条”。IE 中的“黄条”警告 HTML 正在尝试运行 Active X（事实并非如此，只有 JavaScript 在表单上执行 submit()）。但是，如果您通过电子邮件收到完全相同的 HTML 文件，将其保存并打开，则不会出现此问题。（看起来 IE 对您从网站保存的 HTML 文件中可以执行的操作施加了更多限制。）

我的问题是：在哪里可以找到有关此 IE 安全机制的文档，以及如何绕过它？

亚历克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T00:20:35.960

黄色条是因为您的页面正在 IE 的本地计算机安全区域中执行。在不同的机器上，本地机器安全区域的配置方式可能不同，因此您可以在某些机器上看到黄色条，而在其他机器上看不到它。

要了解有关 IE 的 URL 安全区域的更多信息，您可以从此处开始阅读：http: [//msdn.microsoft.com/en-us/library/ms537183.aspx](http://msdn.microsoft.com/en-us/library/ms537183.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T02:09:33.653

在此处查看有关[MOTW 的详细信息 - Mark Of The Web](http://msdn.microsoft.com/en-us/library/ms537628(VS.85).aspx)

如果将此添加到本地提供的页面，IE 将不会显示黄色条。

[http://msdn.microsoft.com/en-us/library/ms537628(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms537628(VS.85).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T00:21:23.417

我不使用任何特定的文档，但是如果您在 Windows 资源管理器中的常规选项卡上打开文件的属性，文件是否被阻止？如果是这样，请单击取消阻止并重试，看看您是否遇到同样的问题。这是从 Internet 下载的文件的典型安全性。

除此之外，恐怕我不知道还有什么建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T00:19:04.683

我不会 100% 遵循您的 JavaScript 提交的内容，但如果您从下载的副本提交回原始站点，则使用 JavaScript 会出现问题，因为所有浏览器都将跨域 JavaScript 视为安全违规。

不允许 JavaScript 读取或写入不在当前域中的任何站点

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T00:31:18.790

正如弗朗西所说，这是因为您处于本地计算机安全上下文中，这允许脚本创建对象并执行可能对您的 PC 造成伤害的代码。例如，您可以创建一个文件系统对象并执行不受信任的页面通常不应该执行的任务，因为它本质上可能是恶意的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T00:54:01.620

您是否尝试将文件名从 yourname.html 更改为 yourname.hta 以查看安全问题是否消失？

有关 HTML 应用程序（.HTA 文件）的更多信息：http: [//msdn.microsoft.com/en-us/library/ms536496%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms536496%28VS.85%29.aspx)

# c++ - 如何恢复 C++ 技能

> ID：142602
> 
> 赞同：9
> 
> 时间：2008-09-27T00:25:31.673
> 
> 标签：c++

我是一名 C++ 开发人员（主要是 ATL/COM 的东西），直到和我们中的许多人一样，我在 2001 年切换到 C#。从那以后我没有做太多的 C++ 编程。

您对如何恢复我的 C++ 技能有任何提示吗？过去几年 C++ 发生了什么变化？是否有涵盖该语言的好书、文章或博客。问题是我能找到的大多数材料要么是针对语言新手，要么是针对具有丰富经验的人。

现在流行哪些 C++ 库？我想我需要阅读 STL，因为我用的不多。还有什么？促进？ATL？WTL？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-27T00:45:46.307

[Boost](http://boost.org) - 虽然它和其他库在当时就已经存在，但它只是在最近才大规模起飞。谷歌也适用于 TR1 和 c++0x 标准。您一定要阅读 STL，因为（恕我直言）它使 C++ 与众不同。

ATL 是一种很好的死技术（不要误会我的意思，我喜欢它并且仍然在一定程度上使用它，但它在 MS 世界中不再流行）。

对于 C++ 开发人员来说，像 QT 这样的东西可能更新颖、更酷，它的优势在于可以让您进入所有新的 Linux 和 Web 开发，这些开发将在未来几年内变得越来越流行。

然而，一旦你开始考虑你可以做的事情，我认为这一切都会很快恢复。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-27T01:15:40.400

我个人发现，当我回到一种我很久没有使用过的语言时，我最需要赶上语法。但是概念和语言的含义在记忆中保持不变。

假设它与您相同，我会说重新查看您记得在学习 C++ 时对您有用的文本是个好主意。我会推荐 Thinking in C++ 以便快速掌握语法。

STL 会非常有用，是的。这是我发现所有成熟的 C++ 程序员普遍赞赏的一件事。了解 Boost 提供的库会很有用。

C++ 世界的变化取决于你最喜欢的编译器决定实现的变化。既然你提到了 ATl/COM，我假设它是 VC++。对 MFC 的更改将支持 Windows 窗体 (2005 vc++) 和符合 Vista 的用户界面和功能区支持 (?) (2008 Vc++)

VC++ 现在支持托管 C++ - 我相信您知道来自 C# 世界的内容 - 2008 也增加了对托管 STL 的支持。

VC++ 正试图更加符合标准，并在该领域取得了一些进展。

他们引入了许多安全功能，这些功能会贬低 strcpy 等旧标准，如果您使用旧 fns，编译器也会发出警告。

VC++2005 还有一个叫做函数属性的东西，它用来描述参数，这样它就可以对你传入的输入做更多的检查，如果发现有问题，它会静态地标记一个警告。Usefuli 会说，尽管我们的商店还没有使用 2005 编译器。

MSDN 有每个版本的重大更改列表。哦，对 Windows 95、Windows 98、Windows Millennium Edition 和 Windows NT 4.0 的支持已从 2005 版 VC++ 中删除。此外，到目前为止您需要的核心库（CRT、ATL、MFC 等）现在支持新的部署模型，这使得它们共享端 sy 端程序集并需要清单。

这个链接应该让你去 - [http://msdn.microsoft.com/en-us/library/y8bt6w34.aspx](http://msdn.microsoft.com/en-us/library/y8bt6w34.aspx)

2008 年增加了更多类似 Tr1 的建议、更优化的编译器、并行编译 (/mp)、对新处理器架构的支持等。我记得其中一个版本也增强了 Open Mp 支持。

再次参考 MSDN - 这就是所有答案的真实来源。

祝你好运。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-27T02:49:15.197

一定要阅读 Scott Meyers 的最新版“Effective C++”。我还推荐 Stephen C. Dewhurst 的“C++ Gotchas: Avoiding Common Problems in Coding and Design”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-27T00:39:01.533

为了提高您的 C++ 技能，如果您仍然可以访问它，我建议您查看一些旧的 C++ 代码。重新审视它有望触发你大脑中那些在切换到 C# 后处于休眠状态的部分:)

对于图书馆来说，STL 很好，然后提升。与您在 2001 年所知道的相比，我认为 ATL/WTL 并没有太多新的东西。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-27T00:42:01.523

刚开始一个项目。您使用的库将取决于您的项目，但您当然应该阅读 STL。如果您很长时间没有使用 C++，您可能需要了解有关模板的更多信息。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-27T03:19:43.173

挑选其中一个 C++ 单元测试框架（我建议[Google C++ 测试框架](http://code.google.com/p/googletest/)，又名。`gtest`）。选择一个可以从头开始的小项目并尝试一些[TDD](https://rads.stackoverflow.com/amzn/click/com/0321146530)。TDD 将鼓励您采取小步骤并反思您的代码。此外，当您构建您的单元测试套件时，它为您提供了一个基础，您可以从中尝试不同的技术。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-27T00:44:07.293

首先，我会说尝试编写可在 Mac 和 Windows 或 Linux 和 Windows 上运行的代码。这将迫使您编写的代码比您可以在 Visual C++ 上使用的 C++ 代码类型更具可移植性 - 当您跨平台时，有很多非常不同的细微之处。

如果可以的话，我建议暂时远离图书馆——首先完善你的 ANSI C++ 游戏。我还建议阅读 C++0x - 下一个标准即将发布，它将帮助您更多地朝着这个方向努力。为此，请复习一下 STL（它背后的概念，而不是太多的实现）和模板。

如果您想尝试 BOOST，请继续，但您通常可以不使用它。我远离它的原因主要是因为模板用于执行所需操作的方式 - 一旦引入新标准，其中很多将变得更加容易。

更新：一旦您对 STL 感到满意并开始需要使用 STL 执行需要大量代码或只是简单棘手的事情，然后前往 BOOST。买一本关于 BOOST 的书，读一读，很好理解。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-27T01:55:00.100

使用 C++ 重写你的一些 C# 东西

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-27T01:01:17.063

取一些旧代码并添加到其中。这不会让你回到最新的 C++ 趋势之上，但它会让你的脚湿透。

在我的工作中，我不得不向 C++ ActiveX 控件添加一些功能，而且我已经很多年没有接触过 C++，也从来没有专业地做过。弄清楚如何再做一次实际上非常酷。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-27T01:35:45.607

我也遇到过类似的情况：2005 年从 C++ 切换到 C#，然后在 2007 年切换回 C++。我不能说 C++ 世界在那两年真的发生了变化。最重要的是恢复我的记忆管理本能，但这只能通过练习来实现。

既然您已经掌握了 C++ 和 .NET，您可能想稍微研究一下 C++ CLI（后期“托管 C++”的新化身）。

至于书籍，请阅读封面上带有“Meyers”和“Sutter”的所有内容。

# c# - C# 中的 TraceRoute 和 Ping

> ID：142614
> 
> 赞同：33
> 
> 时间：2008-09-27T00:29:23.800
> 
> 标签：c#, .net, networking, ping, traceroute

有没有人有 C# 代码方便对目标计算机执行 ping 和跟踪路由？我正在寻找一个纯代码解决方案，而不是我现在正在做的，它是调用 ping.exe 和 tracert.exe 程序并解析输出。我想要更强大的东西。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2010-04-22T04:00:37.910

鉴于我今天必须编写一个 TraceRoute 类，我想我不妨分享一下源代码。

```
using System.Collections.Generic;
using System.Net.NetworkInformation;
using System.Text;
using System.Net;

namespace Answer
{  
  public class TraceRoute
  {
    private const string Data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";

    public static IEnumerable<IPAddress> GetTraceRoute(string hostNameOrAddress)
    {
      return GetTraceRoute(hostNameOrAddress, 1);
    }
    private static IEnumerable<IPAddress> GetTraceRoute(string hostNameOrAddress, int ttl)
    {
      Ping pinger = new Ping();
      PingOptions pingerOptions = new PingOptions(ttl, true);
      int timeout = 10000;
      byte[] buffer = Encoding.ASCII.GetBytes(Data);
      PingReply reply = default(PingReply);

      reply = pinger.Send(hostNameOrAddress, timeout, buffer, pingerOptions);

      List<IPAddress> result = new List<IPAddress>();
      if (reply.Status == IPStatus.Success)
      {
        result.Add(reply.Address);
      }
      else if (reply.Status == IPStatus.TtlExpired || reply.Status == IPStatus.TimedOut)
      {
        //add the currently returned address if an address was found with this TTL
        if (reply.Status == IPStatus.TtlExpired) result.Add(reply.Address);
        //recurse to get the next address...
        IEnumerable<IPAddress> tempResult = default(IEnumerable<IPAddress>);
        tempResult = GetTraceRoute(hostNameOrAddress, ttl + 1);
        result.AddRange(tempResult);
      }
      else
      {
        //failure 
      }

      return result;
    }
  }
} 
```

以及任何想要/需要它的人的 VB 版本

```
Public Class TraceRoute
    Private Const Data As String = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"

    Public Shared Function GetTraceRoute(ByVal hostNameOrAddress As String) As IEnumerable(Of IPAddress)
        Return GetTraceRoute(hostNameOrAddress, 1)
    End Function
    Private Shared Function GetTraceRoute(ByVal hostNameOrAddress As String, ByVal ttl As Integer) As IEnumerable(Of IPAddress)
        Dim pinger As Ping = New Ping
        Dim pingerOptions As PingOptions = New PingOptions(ttl, True)
        Dim timeout As Integer = 10000
        Dim buffer() As Byte = Encoding.ASCII.GetBytes(Data)
        Dim reply As PingReply

        reply = pinger.Send(hostNameOrAddress, timeout, buffer, pingerOptions)

        Dim result As List(Of IPAddress) = New List(Of IPAddress)
        If reply.Status = IPStatus.Success Then
            result.Add(reply.Address)
        ElseIf reply.Status = IPStatus.TtlExpired Then
            'add the currently returned address
            result.Add(reply.Address)
            'recurse to get the next address...
            Dim tempResult As IEnumerable(Of IPAddress)
            tempResult = GetTraceRoute(hostNameOrAddress, ttl + 1)
            result.AddRange(tempResult)
        Else
            'failure 
        End If

        Return result
    End Function
End Class 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-08-08T09:59:05.547

以下是`tracert`迄今为止比其他答案中存在的更好的 C# 实现。

```
public static IEnumerable<IPAddress> GetTraceRoute(string hostname)
{
    // following are similar to the defaults in the "traceroute" unix command.
    const int timeout = 10000;
    const int maxTTL = 30;
    const int bufferSize = 32;

    byte[] buffer = new byte[bufferSize];
    new Random().NextBytes(buffer);

    using (var pinger = new Ping())
    {
        for (int ttl = 1; ttl <= maxTTL; ttl++)
        {
            PingOptions options = new PingOptions(ttl, true);
            PingReply reply = pinger.Send(hostname, timeout, buffer, options);

            // we've found a route at this ttl
            if (reply.Status == IPStatus.Success || reply.Status == IPStatus.TtlExpired)
                yield return reply.Address;

            // if we reach a status other than expired or timed out, we're done searching or there has been an error
            if (reply.Status != IPStatus.TtlExpired && reply.Status != IPStatus.TimedOut)
                break;
        }
    }
} 
```

其他答案中存在的此处修复的陷阱包括：

*   它很懒惰。例如：它正确地使用了 enumerable / 一个迭代器，所以不必计算整个树，你可以通过打破你自己的消费循环在任何时候停止。
*   `maxTTL`已实现，因此该功能不会永远旋转。
*   `bufferSize`与其他 tracert 实现一致的选项。
*   它超级简洁干净。它包含在一个方法中，并且比这里的其他选项短得多。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-27T02:46:38.963

尽管基类库包含[Ping](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)，但 BCL 不包含任何 tracert 功能。

但是，快速搜索会发现两个开源尝试，第一个是 C#，第二个是 C++：

*   [http://www.codeproject.com/KB/IP/tracert.aspx](http://www.codeproject.com/KB/IP/tracert.aspx)
*   [http://www.codeguru.com/Cpp/IN/network/basicnetworkoperations/article.php/c5457/](http://www.codeguru.com/Cpp/I-N/network/basicnetworkoperations/article.php/c5457/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-27T00:33:50.030

关于 ping 部分，请看 MSDN 上的[Ping 类](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-12T13:50:45.183

**Ping**：我们可以使用[`Ping`](https://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping_members(VS.80).aspx).NET Framework 中内置的类。

实例化 a`Ping`并订阅[`PingCompleted`](https://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.pingcompleted(v=vs.80).aspx)事件：

```
Ping pingSender = new Ping();
pingSender.PingCompleted += PingCompletedCallback; 
```

添加代码以配置和操作 ping，例如：

```
string data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
byte[] buffer = Encoding.ASCII.GetBytes(data);
string who = "www.google.com";
AutoResetEvent waiter = new AutoResetEvent(false);
int timeout = 12000;

PingOptions options = new PingOptions(64, true);

pingSender.SendAsync(who, timeout, buffer, options, waiter); 
```

添加一个[`PingCompletedEventHandler`](https://msdn.microsoft.com/en-us/library/system.net.networkinformation.pingcompletedeventhandler(v=vs.80).aspx)：

```
public static void PingCompletedCallback(object sender, PingCompletedEventArgs e)
{
    ... Do stuff here
} 
```

基于[MSDN 示例](https://msdn.microsoft.com/en-us/library/system.net.networkinformation.pingcompletedeventargs(v=vs.80).aspx)的完整工作示例的代码转储：

```
public static void Main(string[] args)
{
    string who = "www.google.com";
    AutoResetEvent waiter = new AutoResetEvent(false);

    Ping pingSender = new Ping();

    // When the PingCompleted event is raised,
    // the PingCompletedCallback method is called.
    pingSender.PingCompleted += PingCompletedCallback;

    // Create a buffer of 32 bytes of data to be transmitted.
    string data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
    byte[] buffer = Encoding.ASCII.GetBytes(data);

    // Wait 12 seconds for a reply.
    int timeout = 12000;

    // Set options for transmission:
    // The data can go through 64 gateways or routers
    // before it is destroyed, and the data packet
    // cannot be fragmented.
    PingOptions options = new PingOptions(64, true);

    Console.WriteLine("Time to live: {0}", options.Ttl);
    Console.WriteLine("Don't fragment: {0}", options.DontFragment);

    // Send the ping asynchronously.
    // Use the waiter as the user token.
    // When the callback completes, it can wake up this thread.
    pingSender.SendAsync(who, timeout, buffer, options, waiter);

    // Prevent this example application from ending.
    // A real application should do something useful
    // when possible.
    waiter.WaitOne();
    Console.WriteLine("Ping example completed.");
}

public static void PingCompletedCallback(object sender, PingCompletedEventArgs e)
{
    // If the operation was canceled, display a message to the user.
    if (e.Cancelled)
    {
        Console.WriteLine("Ping canceled.");

        // Let the main thread resume. 
        // UserToken is the AutoResetEvent object that the main thread 
        // is waiting for.
        ((AutoResetEvent)e.UserState).Set();
    }

    // If an error occurred, display the exception to the user.
    if (e.Error != null)
    {
        Console.WriteLine("Ping failed:");
        Console.WriteLine(e.Error.ToString());

        // Let the main thread resume. 
        ((AutoResetEvent)e.UserState).Set();
    }

    Console.WriteLine($"Roundtrip Time: {e.Reply.RoundtripTime}");

    // Let the main thread resume.
    ((AutoResetEvent)e.UserState).Set();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-21T13:08:01.660

这是我能想到的最有效的方法。如果您喜欢它，请投票，以便其他人受益。

```
 using System;
    using System.Collections.Generic;
    using System.Net.NetworkInformation;

    namespace NetRouteAnalysis
    {
        class Program
        {
            static void Main(string[] args)
            {
                var route = TraceRoute.GetTraceRoute("8.8.8.8")

                foreach (var step in route)
                {
                    Console.WriteLine($"{step.Address,-20} {step.Status,-20} \t{step.RoundtripTime} ms");
                }
            }
        }

        public static class TraceRoute
        {
            public static IEnumerable<PingReply> GetTraceRoute(string hostnameOrIp)
            {
                // Initial variables
                var limit = 1000;
                var buffer = new byte[32];
                var pingOpts = new PingOptions(1, true);
                var ping = new Ping();               

                // Result holder.
                PingReply result = null;

                do
                {
                    result = ping.Send(hostnameOrIp, 4000, buffer, pingOpts);
                    pingOpts = new PingOptions(pingOpts.Ttl + 1, pingOpts.DontFragment);

                    if (result.Status != IPStatus.TimedOut)
                    {
                        yield return result;
                    }
                }
                while (result.Status != IPStatus.Success && pingOpts.Ttl < limit);
            }
        }       
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-08T23:13:49.223

作为对上述 Scotts 代码答案的改进，我发现如果路线在到达目的地之前逐渐变细，那么他的解决方案将不起作用 - 它永远不会返回。至少有部分路线的更好解决方案可能是这个（我已经测试过并且效果很好）。您可以将 for 循环中的“20”更改为更大或更小的值，或者如果您想以其他方式控制迭代次数，请尝试检测它是否花费了太长时间。完全归功于 Scott 的原始代码 - 谢谢。

```
 using System.Collections.Generic;
    using System.Net.NetworkInformation;
    using System.Text;
    using System.Net;

    ...

    public static void TraceRoute(string hostNameOrAddress)
    {
        for (int i = 1; i < 20; i++)
        {
            IPAddress ip = GetTraceRoute(hostNameOrAddress, i);
            if(ip == null)
            {
                break;
            }
            Console.WriteLine(ip.ToString());
        }
    }

    private static IPAddress GetTraceRoute(string hostNameOrAddress, int ttl)
    {
        const string Data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
        Ping pinger = new Ping();
        PingOptions pingerOptions = new PingOptions(ttl, true);
        int timeout = 10000;
        byte[] buffer = Encoding.ASCII.GetBytes(Data);
        PingReply reply = default(PingReply);

        reply = pinger.Send(hostNameOrAddress, timeout, buffer, pingerOptions);

        List<IPAddress> result = new List<IPAddress>();
        if (reply.Status == IPStatus.Success || reply.Status == IPStatus.TtlExpired)
        {
            return reply.Address;
        }
        else
        {
            return null;
        }
    } 
```

# asp.net - ModalPopupExtender OK 按钮单击事件未触发？

> ID：142633
> 
> 赞同：44
> 
> 时间：2008-09-27T00:38:17.853
> 
> 标签：asp.net, asp.net-ajax, updatepanel, modalpopupextender

我在 UpdatePanel 中有一个按钮。该按钮被用作 ModalPopupExtender 的 OK 按钮。由于某种原因，按钮单击事件未触发。有任何想法吗？我错过了什么吗？

```
<asp:updatepanel id="UpdatePanel1" runat="server">
    <ContentTemplate>
        <cc1:ModalPopupExtender ID="ModalDialog" runat="server" 
            TargetControlID="OpenDialogLinkButton"
            PopupControlID="ModalDialogPanel" OkControlID="ModalOKButton"
            BackgroundCssClass="ModalBackground">
        </cc1:ModalPopupExtender>
        <asp:Panel ID="ModalDialogPanel" CssClass="ModalPopup" runat="server">
            ...
            <asp:Button ID="ModalOKButton" runat="server" Text="OK" 
                        onclick="ModalOKButton_Click" />
        </asp:Panel>
    </ContentTemplate>
</asp:updatepanel> 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-07-22T17:23:37.700

象素

```
<ajax:ModalPopupExtender runat="server" ID="modalPop" 
            PopupControlID="pnlpopup" 
            TargetControlID="btnGo"
              BackgroundCssClass="modalBackground"
             DropShadow="true"
             CancelControlID="btnCancel" X="470" Y="300"   />

//Codebehind    
protected void OkButton_Clicked(object sender, EventArgs e)
    {

        modalPop.Hide();
        //Do something in codebehind
    } 
```

**并且不要将 OK 按钮设置为 OkControlID。**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-27T01:00:11.030

用作 ModalPopupExtender 的 OK 或 CANCEL 按钮的按钮似乎不能有单击事件。我通过删除

```
OkControlID="ModalOKButton" 
```

来自 ModalPopupExtender 标记，然后按钮单击触发。我需要找出另一种将数据发送到服务器的方法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-10T12:18:59.923

也可能是按钮需要具有***CausesValidation="false"。***这对我有用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-21T00:00:47.510

我只是在为此寻找解决方案:)

如果您希望该控件触发一个事件，您似乎不能将**OkControlID分配给该控件，只需删除此属性，我就可以让一切恢复正常。**

我的代码（工作）：

```
<asp:Panel ID="pnlResetPanelsView" CssClass="modalPopup" runat="server" Style="display:none;">
    <h2>
        Warning</h2>
    <p>
        Do you really want to reset the panels to the default view?</p>
    <div style="text-align: center;">
        <asp:Button ID="btnResetPanelsViewOK" Width="60" runat="server" Text="Yes" 
            CssClass="buttonSuperOfficeLayout" OnClick="btnResetPanelsViewOK_Click" />&nbsp;
        <asp:Button ID="btnResetPanelsViewCancel" Width="60" runat="server" Text="No" CssClass="buttonSuperOfficeLayout" />
    </div>
</asp:Panel>
<ajax:ModalPopupExtender ID="mpeResetPanelsView" runat="server" TargetControlID="btnResetView"
    PopupControlID="pnlResetPanelsView" BackgroundCssClass="modalBackground" DropShadow="true"
    CancelControlID="btnResetPanelsViewCancel" /> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-02-12T15:49:41.890

将属性“UseSubmitBehavior=false”放入 Button-Control。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-28T11:17:18.990

以前的答案都不适合我。我在 OnOkScript 事件上调用了按钮的回发。

```
<div>
    <cc1:ModalPopupExtender PopupControlID="Panel1" 
         ID="ModalPopupExtender1"
         runat="server" TargetControlID="LinkButton1" OkControlID="Ok" 
         OnOkScript="__doPostBack('Ok','')">
    </cc1:ModalPopupExtender>

    <asp:LinkButton ID="LinkButton1" runat="server">LinkButton</asp:LinkButton> 
</div>        

<asp:Panel ID="Panel1" runat="server">
    <asp:Button ID="Ok" runat="server" Text="Ok" onclick="Ok_Click" />            
</asp:Panel> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-24T18:09:45.023

我经常使用空白标签作为 TargetControlID。前任。`<asp:Label ID="lblghost" runat="server" Text="" />`

我已经看到导致单击事件不触发的两件事：
1.您必须删除 OKControlID（正如其他人所提到的）
2.如果您正在使用字段验证器，您应该在按钮上添加 CausesValidation="false"。

这两种情况对我来说都是一样的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-06-09T01:07:13.857

我找到了一种无需回发即可验证模态弹出窗口的方法。

在 ModalPopupExtender 中，我将 OnOkScript 设置为一个函数，例如 ValidateBeforePostBack()，然后在该函数中，我为我想要的验证组调用 Page_ClientValidate，进行检查，如果失败，保持 modalpopup 显示。如果它通过，我打电话给`__doPostBack`.

```
function ValidateBeforePostBack(){ 
     Page_ClientValidate('MyValidationGroupName'); 
     if (Page_IsValid) { __doPostBack('',''); } 
     else { $find('mpeBehaviourID').show(); } 
} 
```

# c++ - 奇怪的 MSC 8.0 错误：“ESP 的值未在函数调用中正确保存......”

> ID：142644
> 
> 赞同：52
> 
> 时间：2008-09-27T00:45:46.803
> 
> 标签：c++, visual-c++, x86, stack, calling-convention

我们最近尝试将我们的一些 Visual Studio 项目分解为库，并且在一个测试项目中，一切似乎都可以很好地编译和构建，其中一个库项目作为依赖项。但是，尝试运行该应用程序给了我们以下令人讨厌的运行时错误消息：

> 运行时检查失败 #0 - ESP 的值未在函数调用中正确保存。这通常是调用使用不同调用约定声明的函数指针的结果。

我们甚至从未为我们的函数指定调用约定（__cdecl 等），将所有编译器开关保留为默认值。我检查了项目设置对于跨库和测试项目的调用约定是一致的。

更新：我们的一位开发人员将“Basic Runtime Checks”项目设置从“Both (/RTC1, equiv. to /RTCsu)”更改为“Default”，运行时消失了，程序显然运行正常。我完全不相信这一点。这是一个适当的解决方案，还是一个危险的黑客攻击？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-08-26T07:15:13.707

这个调试错误意味着堆栈指针寄存器在函数调用之后没有返回到它的原始值，即函数调用之前的push次数*没有*跟在调用之后相等的*pops*次数。

我知道这有两个原因（都是动态加载的库）。#1 是 VC++ 在错误消息中描述的内容，但我认为这不是导致错误的最常见原因（参见 #2）。

**1）不匹配的调用约定：**

调用者和被调用者在谁将要做什么方面没有适当的协议。例如，如果您正在调用 DLL 函数`_stdcall`，但由于某种原因，您在调用中将其声明为`_cdecl`（VC++ 中的默认值）。如果您在不同的模块等中使用不同的语言，这会发生很多。

您必须检查有问题的函数的声明，并确保它没有被声明两次，而且是不同的。

**2）不匹配的类型：**

调用者和被调用者不是用相同的类型编译的。例如，一个公共标头定义了 API 中的类型并且最近发生了变化，一个模块被重新编译，但另一个没有 - 即某些类型在调用者和被调用者中可能具有不同的大小。

在这种情况下，调用者推送一个大小的参数，但被调用者（如果您使用`_stdcall`被调用者清理堆栈的地方）弹出不同大小的参数。因此，ESP 没有返回到正确的值。

（当然，这些参数以及它们下面的其他参数在被调用函数中似乎是乱码，但有时您可以在没有明显崩溃的情况下幸存下来。）

如果您可以访问所有代码，只需重新编译它。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-07-26T08:07:12.963

**我在其他论坛读到这个**

我遇到了同样的问题，但我只是修复了它。我从以下代码中得到了同样的错误：

```
HMODULE hPowerFunctions = LoadLibrary("Powrprof.dll");
typedef bool (*tSetSuspendStateSig)(BOOL, BOOL, BOOL);

tSetSuspendState SetSuspendState = (tSuspendStateSig)GetProcAddress(hPowerfunctions, "SetSuspendState");

result = SetSuspendState(false, false, false); <---- This line was where the error popped up. 
```

经过一番调查，我将其中一行更改为：

```
typedef bool (WINAPI*tSetSuspendStateSig)(BOOL, BOOL, BOOL); 
```

这解决了这个问题。如果您查看找到 SetSuspendState 的头文件（powrprof.h，SDK 的一部分），您会看到函数原型定义为：

```
BOOLEAN WINAPI SetSuspendState(BOOLEAN, BOOLEAN, BOOLEAN); 
```

所以你们也有类似的问题。当您从 .dll 调用给定函数时，其签名可能已关闭。（在我的情况下，它是缺少 WINAPI 关键字）。

希望对未来的人有所帮助！:-)

干杯。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-27T00:53:57.737

使支票静音不是正确的解决方案。您必须弄清楚您的调用约定出了什么问题。

有很多方法可以在不明确指定的情况下更改函数的调用对流。extern "C" 会这样做，STDMETHODIMP/IFACEMETHODIMP 也会这样做，其他宏也可能会这样做。

我相信如果在 WinDBG ( [http://www.microsoft.com/whdc/devtools/debugging/default.mspx](http://www.microsoft.com/whdc/devtools/debugging/default.mspx) ) 下运行您的程序，运行时应该会在您遇到该问题时中断。您可以查看调用堆栈并找出哪个函数有问题，然后查看它的定义和调用者使用的声明。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-14T14:53:09.767

当代码尝试在不属于预期类型的​​对象上调用函数时，我看到了这个错误。

所以，类层次结构： 有孩子的父母： Child1 和 Child2

```
Child1* pMyChild = 0;
...
pMyChild = pSomeClass->GetTheObj();// This call actually returned a Child2 object
pMyChild->SomeFunction();          // "...value of ESP..." error occurs here 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-17T09:00:34.850

我从 VC++ 程序调用的 AutoIt API 遇到了类似的错误。

```
 typedef long (*AU3_RunFn)(LPCWSTR, LPCWSTR); 
```

但是，当我按照线程前面的建议更改包含 WINAPI 的声明时，问题就消失了。

没有任何错误的代码如下所示：

```
typedef long (WINAPI *AU3_RunFn)(LPCWSTR, LPCWSTR);

AU3_RunFn _AU3_RunFn;
HINSTANCE hInstLibrary = LoadLibrary("AutoItX3.dll");
if (hInstLibrary)
{
  _AU3_RunFn = (AU3_RunFn)GetProcAddress(hInstLibrary, "AU3_WinActivate");
  if (_AU3_RunFn)
     _AU3_RunFn(L"Untitled - Notepad",L"");
  FreeLibrary(hInstLibrary);
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-05-21T06:41:50.507

我在调用 DLL 中的函数时遇到此错误，该 DLL 是使用 2005 年之前版本的 Visual C++ 从较新版本的 VC（2008）编译的。该函数具有以下签名：

```
LONG WINAPI myFunc( time_t, SYSTEMTIME*, BOOL* ); 
```

问题是`time_t`2005 之前的版本中 的大小为 32 位，但自 VS2005 以来为 64 位（定义为`_time64_t`）。函数的调用需要一个 32 位变量，但从 VC >= 2005 调用时会得到一个 64 位变量。由于在使用`WINAPI`调用约定时函数的参数是通过堆栈传递的，这会破坏堆栈并生成上述错误消息 ( “运行时检查失败 #0 ...”）。

要解决此问题，可以

```
#define _USE_32BIT_TIME_T 
```

在包含 DLL 的头文件之前或 - 更好 - 根据 VS 版本更改头文件中函数的签名（2005 之前的版本不知道`_time32_t`！）：

```
#if _MSC_VER >= 1400
LONG WINAPI myFunc( _time32_t, SYSTEMTIME*, BOOL* );
#else
LONG WINAPI myFunc( time_t, SYSTEMTIME*, BOOL* );
#endif 
```

请注意，您当然需要在调用程序中使用`_time32_t`而不是。`time_t`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-03-13T17:45:27.820

值得指出的是，这也可能是 Visual Studio 错误。

我在 VS2017、Win10 x64 上遇到了这个问题。起初它是有道理的，因为我正在做一些奇怪的事情，将其转换为派生类型并将其包装在 lambda 中。但是，我将代码还原为之前的提交，但仍然出现错误，即使它以前不存在。

我尝试重新启动然后重建项目，然后错误消失了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-01-10T19:35:08.887

在将函数移动到 dll 并使用 LoadLibrary 和 GetProcAddress 动态加载 dll 后，我遇到了同样的错误。由于装饰，我已经为 dll 中的函数声明了 extern "C"。所以这也将调用约定更改为 __cdecl。我在加载代码中将函数指针声明为 __stdcall。一旦我在加载代码中将函数指针从 __stdcall 更改为 __cdecl，运行时错误就消失了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-27T00:55:49.900

您是在创建静态库还是 DLL？如果是 DLL，如何定义导出；导入库是如何创建的？

库中函数的原型是否与定义函数的函数声明***完全相同？***

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-27T01:02:43.753

你有任何类型定义的函数原型（例如 int (*fn)(int a, int b) ）

如果你 dom 你可能弄错了原型。

ESP 是调用函数时的错误（你能分辨出调试器中的哪个函数吗？），它的参数不匹配 - 即堆栈已恢复到调用函数时开始的状态。

如果您正在加载需要声明的 C++ 函数 extern C - C 使用 cdecl，C++ 默认使用 stdcall 调用约定 (IIRC)，您也可以获得此信息。在导入的函数原型周围放置一些 extern C 包装器，您可以修复它。

如果您可以在调试器中运行它，您将立即看到该功能。如果没有，您可以设置 DrWtsn32 以创建一个小型转储，您可以将其加载到 windbg 以查看错误发生时的调用堆栈（尽管您需要符号或映射文件来查看函数名称）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-28T18:13:21.770

如果函数是使用不同于它编译成的调用约定调用的，您将收到此错误。

Visual Studio 使用项目选项中标明的默认调用约定设置。检查此值在原始项目设置和新库中是否相同。过于雄心勃勃的开发人员可能会在原始版本中将其设置为 _stdcall/pascal，因为与默认的 cdecl 相比，它减少了代码大小。因此，基本进程将使用此设置，并且新库会获得导致问题的默认 cdecl

既然你说过你不使用任何特殊的调用约定，这似乎是一个很好的可能性。

还要对标头进行比较，以查看进程看到的声明/文件是否与编译库时使用的相同。

ps：让警告消失是BAAD。潜在的错误仍然存​​在。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-27T03:32:34.000

另一种`esp`可能会搞砸的情况是无意的缓冲区溢出，通常是由于错误地使用指针超出了数组的边界。假设你有一些看起来像的 C 函数

```
int a, b[2]; 
```

写到`b[3]`可能会改变`a`，并且任何过去的地方都可能会破坏`esp`堆栈中保存的内容。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-04-17T22:04:27.473

这在访问 COM 对象（Visual Studio 2010）时发生在我身上。我在对 QueryInterface 的调用中传递了另一个接口 A 的 GUID，但随后我将检索到的指针转换为接口 B。这导致对具有完全签名的接口进行函数调用，这说明了堆栈（和 ESP）是弄乱。

传递接口 B 的 GUID 解决了该问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-08-26T16:47:58.040

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-27T00:53:12.387

ESP 是堆栈指针。因此，根据编译器的说法，您的堆栈指针变得混乱了。在没有看到一些代码的情况下，很难说这是如何（或是否）发生的。

重现此代码的最小代码段是多少？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-27T10:40:41.337

如果您在 Windows API 中使用任何回调函数，则必须使用`CALLBACK`和/或声明它们`WINAPI`。这将应用适当的修饰以使编译器生成正确清理堆栈的代码。例如，在 Microsoft 的编译器中，它添加了`__stdcall`.

Windows 一直使用该`__stdcall`约定，因为它会导致（稍微）更小的代码，清理发生在被调用的函数中，而不是在每个调用站点。但是，它与可变参数函数不兼容（因为只有调用者知道他们推送了多少参数）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-05-24T21:16:25.000

这是一个产生该错误的精简 C++ 程序。使用 (Microsoft Visual Studio 2003) 编译会产生上述错误。

```
#include "stdafx.h"
char* blah(char *a){
  char p[1];
  strcat(p, a);
  return (char*)p;
}
int main(){
  std::cout << blah("a");
  std::cin.get();
} 
```

错误：“运行时检查失败 #0 - ESP 的值未在函数调用中正确保存。这通常是调用使用一种调用约定声明的函数而使用另一种调用约定声明的函数指针的结果。”

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-10-30T21:46:01.413

我在工作中遇到了同样的问题。我正在更新一些调用 FARPROC 函数指针的非常旧的代码。如果您不知道，FARPROC 是具有零类型安全性的函数指针。它是 typdef 函数指针的 C 等价物，没有编译器类型检查。例如，假设您有一个带有 3 个参数的函数。您将 FARPROC 指向它，然后使用 4 个参数而不是 3 个参数调用它。额外的参数将额外的垃圾推入堆栈，当它弹出时，ESP 现在与启动时不同。所以我通过删除调用 FARPROC 函数调用的额外参数来解决它。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-03-02T10:12:59.210

不是最好的答案，但我只是从头开始重新编译我的代码（在 VS 中重建），然后问题就消失了。

# database-design - 关系阵营和“现实世界”数据库开发

> ID：142652
> 
> 赞同：6
> 
> 时间：2008-09-27T00:57:30.007
> 
> 标签：database-design, relational-database, relational

自1995 年伊达和达尔文的[《第三宣言》](http://en.wikipedia.org/wiki/The_Third_Manifesto)首次出版以来，已经过去了十多年。

关系学派在当今数据库世界中的位置是什么？是否有任何证据表明 Manifesto 的想法改变了主流软件开发和数据管理实践？他们是否催生了新的数据管理产品？这些产品在商业上是否成功？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-28T04:07:45.313

多年来，我看到很多关于 OOD 应该如何“很快”超越关系数据库的讨论；关系模型是过去的方式；来自庞大安装基础的惯性（嗯……*遗留*）阻碍了 OOD 的进展。“‘足够好’的实现最终出现并成功取代 RDBMS 只是时间问题”。

无论如何，我都不是专家。但是我想了很多次，我开始相信这些观点完全没有抓住重点。

在大多数“现实世界”场景中，最重要的、唯一重要的就是**数据**。

编程技术、工具和语言发生变化；技术不断发展。企业“语音应答系统”风靡一时，然后几乎消失在“网络”的阴影后面。申请来来去去；其中一些很好，一些则不然；有些很关键，有些只是方便；有的持续 3 个月，有的持续 3 年。但归根结底，为所有这些应用程序提供信息的信息是系统的*核心*，必须在时尚的波动中幸存下来。**数据保持不变**。

因此，“系统”的核心必须围绕一个目标发展：保存和保护数据。

想一想：特别是 SQL 数据库为我们提供了一个独立的（大部分）标准化存储库，具有数十年的历史证明记录，并且可以随时使用远未过时的*函数*式语言访问！对于您最有价值的组件来说，这是一个值得信赖的好地方。

任何将优先级放在编程工具、环境或应用程序上，而以将数据保存在模糊存储中为代价的方法——任何将应用程序技术与数据绑定得太紧密的方法，都可能会被淘汰——边。

并不是说我相信世界上的一切都必须进入一个 SQL 表。类似 OOD 的解决方案也有一席之地，而且潜力巨大。但是您需要查看“应用程序”为王，“数据”为次要的地方：游戏、一次性应用程序和工具、保存非关键数据或过去没有长期价值的数据的系统应用程序的预期寿命。

特别是，我认为使用寿命有限（最多几年）的系统是类 OOD 技术的主要候选者。另一方面，当处理任何必须有一天将数据“移交”给其继任者的事情时，我会非常怀疑除了旧的 RDBMS 之外的任何事情。

简而言之，*它从来都不是关于“应用程序”的；它**一直**是关于“数据”的。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-27T16:11:32.117

面向对象的数据库是矛盾的。您尝试创建 OO 数据库的次数越多，您最终进入关系世界的次数就越多。在我看来，它们只是一种炒作。请注意，ORM 不是 OO 数据库。数据集也不是。我以前听过这个论点，所以我说它只是为了让事情清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T01:02:07.483

我们正在看到对象建模在管理数据方面的一些作用。我们有 Linq 和 NHibernate，它们允许我们将数据库中的数据映射到代码中的对象。然而。我认为我们距离真正的面向对象数据库还有很长的路要走。我不确定我们会不会。虽然使用“对象”有其优势，但使用关系数据模型将数据视为集合具有很多优势。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T01:20:36.657

到目前为止，出现的 OODBMS 似乎并没有像某些人希望的那样被广泛采用，原因很简单：OODBMS 只解决 OOP 开发人员的问题，而不是*其他所有人*，包括 DBA、分析师、MIS专业人士，以及大量不是面向对象而是“数据驱动”的开发人员。

话虽如此，大量企业数据仍保留在 RDBMS 中，就像大量企业数据也保留在 COBOL/CICS 驱动的系统中一样。

至于事实，你可以谷歌几个小时来寻找统计数据，但你什么也找不到。您会发现 Oracle 与 MS SQL Server 与 MySQL/PostGre/其他开源 RDBMS 采用统计数据之间的对比，而像 db4o 这样的 OODBMS 在很大程度上被忽略了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T15:39:52.270

In business data processing, the relational model is firmly entrenched, and cannot be removed. It is central and is often highly overused for inappropriate things. Folks will use (abuse) a relational database as a reliable message queue because -- well -- they see every problem as a database problem.

The relational model is the backbone of many (almost all) commercial products for every business process. It's hard to find anything that's not fundamentally relational. Indeed, in many cases, the products are closely aligned with the database. Oracle's Financials, Microsoft's Dynamics accounting, etc.

For the foreseeable future, relational data stores will be the primary storage for business data processing.

Currently, relational databases go without saying. Everyone asks "which database engine" so they can weigh in on the Oracle vs. IBM vs. Microsoft vs. MySQL debate. No one asks "what will the data model be? Object or Relational?"

ORM will continue to make inroads. Object-Oriented programming will continue to grow, leading to more and more ORM. Breaking out of this box is hard -- nearly impossible -- because business IT is focused on stability, not innovation. Their goal is almost always "Keep The Lights On". That means to refuse change until it is forced on them by a vendor going out of business or ending support for a product.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T01:25:29.237

我一直在处理太大的数据集，无法认真考虑将数据呈现为类的经典“对象”模型，其中数据元素包含所有信息和访问/操作它们的方法。

然而，我发现了一个带有 .NET 数据集的简单折衷模型。由于它们“自我缓冲”到磁盘，因此它们非常适合处理可能适合或不适合内存的数据块 - 所以我将它们用于我的“对象集合”。

然后，构成应用程序的“业务”对象的所有类都简单地引用数据集中包含其信息的记录，并且该类的所有方法都简单地从记录集中解析。

适用于将 1 个结果返回到 100 万个结果的查询——并且类模型很容易复制——因为基本​​上所有类内部数据变量都只是记录集上的字段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-28T17:17:42.370

否 唯一显着的变化是最近通过云计算的出现而出现的，在这种情况下，支持者不必以关系方式存储数据。

# apache - .htaccess 中的 DocumentRoot 导致错误

> ID：142653
> 
> 赞同：4
> 
> 时间：2008-09-27T00:57:30.910
> 
> 标签：apache, configuration

我的 .htaccess 文件中有 DocumentRoot /var/www/test 。这导致 apache 服务器给我一个 500 内部服务器错误。

错误日志文件显示：alert] [client 127.0.0.1] /var/www/.htaccess: DocumentRoot not allowed here

AllowOveride All 在我的 conf 文件中设置。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-27T01:00:11.467

[DocumentRoot](http://httpd.apache.org/docs/2.0/mod/core.html#documentroot)指令不能出现在文件`.htaccess`中。而是把它放进去`httpd.conf`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T01:00:57.953

DocumentRoot 应该在您的 VirtualHost 指令中设置，而不是在您的 .htaccess 文件中。

您将 DocumentRoot 放在 .htaccess 文件中的任何具体原因？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T01:01:59.650

您没有提及您的 apache 版本，但 2.0 的文档说 DocumentRoot 仅对虚拟主机或服务器配置有效。根据文档，它不应在 .htacces 中使用

[http://httpd.apache.org/docs/2.0/mod/core.html#documentroot](http://httpd.apache.org/docs/2.0/mod/core.html#documentroot)

# linux - 如何最有效地处理大量文件描述符？

> ID：142677
> 
> 赞同：7
> 
> 时间：2008-09-27T01:12:39.500
> 
> 标签：linux, performance, sockets, optimization

对于处理大量套接字连接的程序（例如 Web 服务、p2p 系统等），似乎有几个选项可用。

1.  生成一个单独的线程来处理每个套接字的 I/O。
2.  使用[select](http://linux.die.net/man/2/select)系统调用将 I/O 多路复用到单个线程中。
3.  使用[poll](http://linux.die.net/man/2/poll)系统调用来多路复用 I/O（替换 select）。
4.  使用[epoll](http://linux.die.net/man/4/epoll)系统调用来避免必须通过用户/系统边界重复发送套接字 fd。
5.  使用 poll API 生成多个 I/O 线程，每个线程多路复用一组相对较小的连接总数。
6.  除了使用 epoll API 为每个独立的 I/O 线程创建单独的 epoll 对象之外，按照 #5。

在多核 CPU 上，我希望 #5 或 #6 具有最佳性能，但我没有任何硬数据支持这一点。搜索网络出现了[这个](http://lse.sourceforge.net/epoll/index.html)页面，描述了作者在上面测试方法#2、#3 和#4 的经验。不幸的是，这个网页似乎有 7 年的历史，没有发现明显的最近更新。

所以我的问题是人们发现这些方法中的哪一种最有效和/或是否有另一种方法比上面列出的任何一种方法更好？对现实生活中的图表、白皮书和/或网络可用文章的引用将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T11:32:17.530

根据我运行大型 IRC 服务器的经验，我们曾经使用 select() 和 poll()（因为 epoll()/kqueue() 不可用）。在大约 700 个并发客户端时，服务器将使用 100% 的 CPU（irc 服务器不是多线程的）。然而，有趣的是，服务器仍然会表现良好。在大约 4,000 个客户端时，服务器将开始滞后。

这样做的原因是，在大约 700 个客户端时，当我们返回 select() 时，将有一个客户端可供处理。for() 循环扫描以找出它将占用大部分 CPU 的客户端。随着我们有更多的客户，我们会开始有越来越多的客户需要在每次调用 select() 时进行处理，因此我们会变得更有效率。

转向 epoll()/kqueue()，类似的规范机器可以轻松处理 10,000 个客户端，其中一些（当然更强大的机器，但按照今天的标准仍然被认为很小的机器）已经拥有 30,000 个客户端而不会破坏流汗。

我在 SIGIO 上看到的实验似乎表明它适用于延迟非常重要的应用程序，其中只有少数活动客户端做很少的个人工作。

我建议在几乎任何情况下都使用 epoll()/kqueue() 而不是 select()/poll()。我没有尝试在线程之间拆分客户端。老实说，我从来没有发现需要在前端客户端处理上进行更多优化工作来证明使用线程进行实验的服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-22T12:45:33.697

在过去的两年里，我一直在研究这个特定的问题（对于 G-WAN 网络服务器，它带有许多基准和图表来揭示这一切）。

在 Linux 下工作得最好的模型是带有一个事件队列的 epoll（对于繁重的处理，还有多个工作线程）。

如果您的处理很少（处理延迟低），那么使用多个线程使用一个线程会更快。

这样做的原因是 epoll 不能在多核 CPU 上扩展（在同一个用户模式应用程序中使用多个并发 epoll 队列进行连接 I/O 只会降低服务器的速度）。

我没有认真看内核中的 epoll 代码（到目前为止我只关注用户模式），但我的猜测是内核中的 epoll 实现被锁削弱了。

这就是为什么使用多个线程很快就会碰壁的原因。

不用说，如果 Linux 想要保持其作为性能最好的内核之一的地位，那么这种糟糕的状态不应该持续下去。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T20:46:47.330

From my experience, you'll have the best perf with #6\.

I also recommend you look into libevent to deal with abstracting some of these details away. At the very least, you'll be able to see some of their benchmark ![benchmark results](https://monkey.org/~provos/libevent/libevent-benchmark2.jpg).

Also, about how many sockets are you talking about? Your approach probably doesn't matter too much until you start getting at least a few hundred sockets.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T16:44:35.937

我广泛使用 epoll()，它表现良好。我通常有数千个套接字处于活动状态，并使用多达 131,072 个套接字进行测试。而 epoll() 总是可以处理它。

我使用多个线程，每个线程都轮询套接字的子集。这使代码复杂化，但充分利用了多核 CPU。

# asp.net - 在 Java 应用程序中调用 Reporting services rdl

> ID：142690
> 
> 赞同：0
> 
> 时间：2008-09-27T01:20:37.827
> 
> 标签：asp.net, reporting-services

我在 SQL 报告服务中开发了我的报告并部署在我的服务器中。我需要在我的 java 应用程序页面中显示报告。我想知道是否有任何控件（如 .net 报表查看器控件）来显示它

谢谢balaweblog

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T03:27:43.747

我不了解控件，但如果您只需要显示报表而不提供太多交互，则可以使用报表服务器 Web 服务并调用它的渲染方法。这将允许您以多种格式执行和返回报告输出。因此，您可以让 java 代码接受参数，然后将这些参数传递给 Render 方法，然后返回显示报告的 pdf 字节数组。

渲染方法... [http://msdn.microsoft.com/en-us/library/aa258532(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa258532(SQL.80).aspx)

报告服务 Web 服务... [http://msdn.microsoft.com/en-us/library/aa274396(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa274396(SQL.80).aspx)

# actionscript-3 - flex中的单元测试

> ID：142692
> 
> 赞同：12
> 
> 时间：2008-09-27T01:21:22.617
> 
> 标签：actionscript-3, unit-testing, testing, actionscript, automated-tests

Flex 是否有任何单元测试解决方案？还是动作脚本 3？

如果有，它们的特点是什么？任何UI测试能力？功能测试？您可以分享任何指针、示例、库或工具吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-27T01:27:31.463

FlexUnit 非常棒 - [http://opensource.adobe.com/wiki/display/flexunit/FlexUnit](http://opensource.adobe.com/wiki/display/flexunit/FlexUnit)

还有 ASUnit - [http://asunit.org](http://asunit.org)

它们都非常相似，并且都从 JUnit 等框架中汲取了很多东西。

FlexMonkey ( [http://code.google.com/p/flexmonkey/](http://code.google.com/p/flexmonkey/) ) 虽然我自己没有使用它，但似乎在做 UI 单元测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-29T17:51:34.403

我可以确认 FlexMonkey 确实做了 UI 单元测试。它提供 UI 交互的记录/回放并生成 FlexUnit 测试用例。

[在http://flexmonkey.googlecode.com](http://flexmonkey.googlecode.com)上查看

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-28T17:56:10.760

我刚刚找到[了 fluint](http://code.google.com/p/fluint/)，它是一个很棒的单元测试库，比 Flexunit 和 ASUnit imho 都好。它处理异步测试非常好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T14:53:18.457

我也会推荐 FlexUnit……你也可以看看[Visual FlexUnit](http://code.google.com/p/visualflexunit/)。
几天前我找到了[RIATest](http://riatest.com/) -Tool，但我还没有尝试过。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-01T19:47:19.957

我推荐[Fluint](http://code.google.com/p/fluint/)仅仅是因为它拥有更活跃的开发人员基础（并且它改进了对测试异步代码的支持）。此外，如果您在模拟/存根之后，还有[asmock](http://asmock.sourceforge.net/)（一个动态模拟框架）和[mock-as3](http://code.google.com/p/mock-as3/)（一个静态模拟框架）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T14:56:37.920

对于异步单元测试，dpUint 非常有用。但是，如果您希望将单元测试与 Maven 构建集成，那么 FlexUnit 是可行的方法。异步测试（例如 Cairngorm 事件）也可以用 FlexUnit 完成，但不如 dpUint 优雅。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-28T19:14:00.193

为 flex 尝试 mockito [http://bitbucket.org/loomis/mockito-flex](http://bitbucket.org/loomis/mockito-flex)

# banking - 如何编写银行账户转账软件？

> ID：142693
> 
> 赞同：17
> 
> 时间：2008-09-27T01:22:26.217
> 
> 标签：banking

您知道那些让您输入您的支票帐号和路由号码的网站，然后他们可以向您的帐户转账和从您的账户转账吗？

这是如何运作的？有什么好的服务或 API 可以做到这一点吗？有什么陷阱吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-27T01:30:24.153

银行确实有用于执行此操作的 API，但只有经过批准的人员/公司才能与这些系统进行交互。因为它实际上涉及转移资金，所以就您如何处理系统上的帐号而言，安全要求非常高。

许多提供此功能以购买商品的网站实际上使用第三方系统来处理将实际资金转移到他们的帐户中。这降低了实现 API 的麻烦，并将安全负担交给了处理汇款的第三方。

如果您真的想建立一个可以接受银行帐号和兑换资金的系统，您应该联系您的银行，看看实施这样一个系统的实际要求是什么。每家银行都有自己的系统，以及关于这些交易成本的自己的费率。

我知道的一些第三方是

*   [莫内里斯](http://www.moneris.com/)
*   [仙人掌](http://www.cactuscommerce.com/home/default_e.asp)
*   [豆流](http://www.beanstream.com/public/index.asp)

我在加拿大，虽然我认为 Moneris 和 Cactus 在美国经营。我认为 Beanstream 没有。同样，您可以与您的银行交谈，他们可能会让您与帮助您进行交易的第三方取得联系。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-27T01:46:59.777

如果您希望能够在不同金融机构的账户之间发起资金转账（使用账户和路由号码），您需要找到提供 ACH 的支付处理公司（[http://en.wikipedia.org/wiki/Automated_Clearing_House](http://en.wikipedia.org/wiki/Automated_Clearing_House) ) 接送服务。通常这些公司是已经可以使用 ACH 的金融机构的子公司。例如。[ACH Direct ( http://www.achdirect.com/](http://www.achdirect.com/) )就是这样一家公司。我不能保证它的服务或可靠性，我只是在这里举例说明你需要搜索什么类型的公司。

当然，从技术上讲，您可以尝试直接连接到 ACH。但是，要做到这一点，您需要在编写软件时遵守 NACHA ( [http://en.wikipedia.org/wiki/NACHA-The_Electronic_Payments_Association ) 的规则和规定，并通过严格的认证。](http://en.wikipedia.org/wiki/NACHA-The_Electronic_Payments_Association)这是一项相当大的投资，因此除非您有数十亿美元的支持，否则我不建议您尝试这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T23:36:22.713

您可以使用 Moneris US eSELECTplus 商家账户执行此操作 - 您只需在您的商家账户上启用自动票据交换所 (ACH)（不幸的是，目前加拿大没有与 ACH 相同的功能）。

以下是 Moneris US PHP API 中借记交易的示例：

```
<?php

require "../mpgClasses.php";

/************************ Request Variables **********************************/

$store_id='monusqa002'; //account credentials
$api_token='qatoken';

/************************ Transaction Object******************************/

$txnArray=array(type=>'us_ach_debit',
            order_id=>'ach-'.date("dmy-G:i:s"),
            cust_id=> 'my cust id',
            amount=>'1.00'
            );

$achTemplate = array(
       sec =>'ppd',
       cust_first_name =>  'Bob',
                 cust_last_name =>  'Smith',
                 cust_address1 => '101 Main St',
                 cust_address2 =>  'Apt 102,
                 cust_city => 'Chicago',
                 cust_state =>  'IL',
                 cust_zip =>'123456',
                 routing_num => '490000018',
                 account_num =>  '23456',
                 check_num => '100',
                 account_type => 'savings'
                );

$mpgAchInfo = new mpgAchInfo ($achTemplate);
$mpgTxn = new mpgTransaction($txnArray);
$mpgTxn->setAchInfo($mpgAchInfo);

$mpgRequest = new mpgRequest($mpgTxn);
$mpgHttpPost = new mpgHttpsPost($store_id,$api_token,$mpgRequest);

/************************ Response Object **********************************/

$mpgResponse=$mpgHttpPost->getMpgResponse();

print("\nCardType = " . $mpgResponse->getCardType());
print("\nTransAmount = " . $mpgResponse->getTransAmount());
print("\nTxnNumber = " . $mpgResponse->getTxnNumber());
print("\nReceiptId = " . $mpgResponse->getReceiptId());
print("\nTransType = " . $mpgResponse->getTransType());
print("\nReferenceNum = " . $mpgResponse->getReferenceNum());
print("\nResponseCode = " . $mpgResponse->getResponseCode());
print("\nMessage = " . $mpgResponse->getMessage());
print("\nAuthCode = " . $mpgResponse->getAuthCode());
print("\nComplete = " . $mpgResponse->getComplete());
print("\nTransDate = " . $mpgResponse->getTransDate());
print("\nTransTime = " . $mpgResponse->getTransTime());
print("\nTicket = " . $mpgResponse->getTicket());
print("\nTimedOut = " . $mpgResponse->getTimedOut());

?> 
```

Moneris USA 的 API 文件和集成指南可在以下位置获得：

[http://developer.moneris.com](http://developer.moneris.com)（需要免费注册）

Moneris 美国 - ACH：

[http://www.monerisusa.com/payment-processing-services/ach-direct-debit.aspx](http://www.monerisusa.com/payment-processing-services/ach-direct-debit.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-01T15:24:32.750

Stripe Connect 允许您通过一个统一的 API 将资金转入银行账户并接受付款。截至 2015 年 12 月，它们提供了更详尽的文档，并且通常似乎比其他答案中提到的大多数公司更受开发人员欢迎。

有关更多信息，请参阅[https://stripe.com/docs/connect](https://stripe.com/docs/connect)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T01:34:36.407

Paypal 有一个相当容易访问的 API，您可以在您的程序中使用它来完成其中的一些工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-22T22:48:23.363

进行 ACH 转账的非常简单的方式 - [https://www.dwolla.com/white-label](https://www.dwolla.com/white-label)

根据您希望应用程序执行的操作，您将需要不同的功能。

如果您想支付（信用）银行账户。这很简单。以下是步骤： 1\. 创建会员 2\. 创建资金来源 3\. 创建转账

如果你想借记和贷记银行账户，它会变得更复杂一些。以下是步骤： 1\. 创建会员 2\. 获得资金来源授权 3\. 创建转账

授权较难的唯一原因是您必须通过 2 存款方式或某种类型的验证流程。使用 Dwolla.js 会更容易 - [https://www.dwolla.com/dwollajs-bank-verification](https://www.dwolla.com/dwollajs-bank-verification)

# winapi - 用于开箱即用 GUI 桌面应用程序编程的高级语言

> ID：142695
> 
> 赞同：14
> 
> 时间：2008-09-27T01:22:37.887
> 
> 标签：winapi, user-interface, desktop-application, dynamic-languages

在我停止使用 C++ 编程并开始从事 Web 创作之后，我被 PHP 的高级构造（如哈希表）或其动态、弱类型所宠坏。我记得 C/C++ 指针的焦虑以及低级 Win32 API 句柄和消息循环的迷宫，这使我无法将 Code::Blocks 之类的环境用于桌面应用程序。我也不太喜欢笨重的静态类型 C#/.NET 环境。还有其他想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-27T01:23:19.757

[wxPython](http://www.wxpython.org/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-27T01:24:31.923

Python 有很棒的[GUI 工具包](http://wiki.python.org/moin/GuiProgramming)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-29T16:00:10.833

德尔福。毫无疑问。

[http://www.codegear.com/delphi](http://www.codegear.com/delphi)

不过，您将不得不忍受强类型。

C# 不是一门糟糕的语言，.Net 框架当然有一些有趣的特性，但是 WinForms 可能会很慢，使其不太适合（至少对我而言）桌面 GUI 应用程序。我也不喜欢高昂的运行时要求。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-27T04:07:31.453

Tcl/tk 是一种老式的解决方案，但您可以使用非常少的代码来启动和运行 gui。运行时可以嵌入，因此您可以在包含代码、运行时和资源文件的单个文件中分发自包含的可执行文件。运行时在 unix/windows/mac 上运行，因此很容易为您需要的任何平台生成二进制文件。然而，许多人发现很难将他们的头脑围绕在 tcl...

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-27T01:29:30.413

我在 Flex 和 WPF (c#) 方面做了很多工作。虽然你不太喜欢 C#。我会说 Flex 非常像 C#，但没有所有强类型代码。我拥有大约 13 年的 PHP 编程经验，我想说转向 flex 应用程序开发（包括 AIR 桌面应用程序）是我所做的最流畅的转变之一。特别是如果您喜欢使用任何类型的 javascript。

无论如何，[Flex](http://www.adobe.com/products/flex/)、[Flex](http://www.adobe.com/products/flex/)、[Flex](http://www.adobe.com/products/flex/) ......哦，是的，还有[AIR](http://www.adobe.com/products/air/) :)

如果您需要更多帮助或更好的细分，请告诉我。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-27T01:27:28.437

如果你想要快速、简单、无痛的开发，或者如果你想回到 C++，我第三个 Pyhon，因为我们中的一些人只是喜欢痛苦，尝试使用 Boost 和 Qt，你会比回到以前更快乐Win32 API 的过去。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T09:59:04.133

您可以将 Lua 与 wxLua 或轻量级 IUP 库一起使用。两者都是便携的。

对于快速/小型原型/丢弃脚本，我还使用 AutoHotkey：该语言对于经验丰富的程序员来说非常糟糕（新手似乎喜欢它......），但它的高级 GUI 易于使用且快速使用。它相当小，可以“编译”为独立的 exe。

# vb.net - 为什么返回字符串的 VB.Net 函数实际上只返回一个字符？

> ID：142697
> 
> 赞同：33
> 
> 时间：2008-09-27T01:24:24.357
> 
> 标签：vb.net, syntax

我正在调用一个返回字符串的函数，但它实际上只返回它应该返回的字符串的第一个字符。

这是一个示例代码，用于重新创建我遇到的问题：

```
Public Function GetSomeStringValue(Value as Integer) As String
    ... Code Goes here
    Return Some_Multicharacter_string
End Function 
```

函数调用如下所示：

```
SomeStringValue = GetSomeStringValue(Value) 
```

为什么这不返回整个字符串？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-06-03T17:09:55.770

> *注意：此答案最初是由 OP Kibbee 作为自我答案编写的。但是，它写在问题的正文中，而不是作为实际的单独答案。由于OP拒绝了包括版主在内的其他用户的重复请求，要求按照网站规则重新发布，所以我自己重新发布。*

在尝试了一百种不同的东西，重构了我的代码，在调试器中多次单步执行代码，甚至让一个同事调查了问题之后，我终于灵机一动，找到了答案。

在重构代码的某个时候，我更改了函数以摆脱 Value 参数，将其保留如下：

```
Public Function GetSomeStringValue() As String
    ... Code Goes here
    Return Some_Multicharacter_String
End Function 
```

但是，我忽略了删除调用函数时传入的参数：

```
SomeStringValue = GetSomeStringValue(Value) 
```

编译器没有抱怨，因为它将我所做的解释为调用不带括号的函数，这是 VB6 时代的遗留功能。然后，Value 参数转换为从函数返回的字符串（又名字符数组）的数组索引。

所以我删除了参数，一切正常：

```
SomeStringValue = GetSomeStringValue() 
```

我发布这个是为了让其他人在遇到问题时/如果他们遇到问题时能够识别出来，并且能够比我更快地解决它。我花了很长时间才解决，我希望我可以节省其他人一些时间。

# visual-studio - .vsprops 文件中的 'Delimiter' 和 'InheritsFromParent' 属性是什么意思？

> ID：142708
> 
> 赞同：8
> 
> 时间：2008-09-27T01:27:41.790
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005

我似乎无法从 Microsoft 找到任何*有用*的文档，说明在Visual Studio 的属性表文件中定义用户宏时如何使用元素中的`Delimiter`和`InheritsFromParent`属性。`UserMacro``.vsprops`

这是示例用法：

```
<UserMacro Name="INCLUDEPATH" Value="$(VCROOT)\Inc"
    InheritsFromParent="TRUE" Delimiter=";"/> 
```

从上面的例子中，我猜*“继承”*实际上意味着*“a）如果定义是非空的，那么附加分隔符，b）附加新定义”*，其中非继承行为将简单地替换任何当前宏定义。有人有确切消息么？更好的是，有没有人有任何关于 Visual Studio`.vsprops`文件和宏的替代文档的建议来源？

注意：这*与*元素的`InheritedPropertySheets`属性不同`VisualStudioPropertySheet`，例如：

```
<VisualStudioPropertySheet ... InheritedPropertySheets=".\my.vsprops"> 
```

在这种情况下，*“继承”*基本上意味着*“包含”*。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-28T05:26:05.780

*[回答我自己的问题]*

`InheritsFromParent`意味着前置。为了验证这一点，我做了一个实验来揭示用户宏在 Visual Studio 2008 中是如何工作的。下面是设置：

*   项目包括使用标签`p.vcproj`的属性表文件`d.vsprops`（“d”表示*派生*） 。`InheritedPropertySheets`
*   `d.vsprops`包括属性表文件`b.vsprops`（'b' 表示*base*。）
*   `p.vcproj`还定义了转储环境的预构建事件。
*   这两个`.vsprops`文件都包含用户宏定义。

**b.vsprops**

```
...
<UserMacro Name="NOENV" Value="B"/>
<UserMacro Name="OVERRIDE" Value="B" PerformEnvironmentSet="true"/>
<UserMacro Name="PREPEND" Value="B" PerformEnvironmentSet="true"/>
... 
```

**d.vsprops**

```
...
<VisualStudioPropertySheet ... InheritedPropertySheets=".\b.vsprops">
<UserMacro Name="ENV" Value="$(NOENV)" PerformEnvironmentSet="true"/>
<UserMacro Name="OVERRIDE" Value="D" PerformEnvironmentSet="true"/>
<UserMacro Name="PREPEND" Value="D" InheritsFromParent="true"
    Delimiter="+" PerformEnvironmentSet="true"/>
... 
```

**p.vcproj**

```
...
<Configuration ... InheritedPropertySheets=".\d.vsprops">
<Tool Name="VCPreBuildEventTool" CommandLine="set | sort"/>
... 
```

**构建输出**

```
...
ENV=B
OVERRIDE=D
PREPEND=D+B
... 
```

根据这些结果，我们可以得出以下结论：

1.  `PerformEnvironmentSet="true"`在用于构建事件的环境中定义用户宏是必需的。证明：`NOENV`构建输出中未显示。
2.  用户宏***总是***从包含的属性表继承而来，不管`PerformEnvironmentSet`或`InheritsFromParent`。证明： in `b.vsprops`,`NOENV`没有设置在环境中， in`d.vsprops`不需要`InheritsFromParent`.
3.  用户宏的简单重新定义***会覆盖***任何先前的定义。证明：`OVERRIDE`设置为`D`尽管它之前被定义为`B`。
4.  重新定义用户宏`InheritsFromParent="true"` ***将***新定义添加到任何先前的定义之前，由指定的`Delimiter`. 证明：`PREPEND`设置为`D+B`(not `D`or `B+D`.)

以下是我发现的一些附加资源，用于解释 Visual Studio`.vsprops`文件和相关主题，它是几年前的，但它仍然很有帮助：

[了解VC项目系统第一部分：文件和工具](http://blogs.msdn.com/josh_/archive/2004/02/03/66965.aspx)

[了解 VC 项目系统第二部分：配置和项目属性页对话框](http://blogs.msdn.com/josh_/archive/2004/02/04/67705.aspx)

[了解VC项目系统第三部分：宏、环境变量和分享](http://blogs.msdn.com/josh_/archive/2004/02/05/68366.aspx)

[了解VC项目系统第四部分：属性和属性继承](http://blogs.msdn.com/josh_/archive/2004/02/09/70335.aspx)

[理解VC项目系统第五部分：构建、工具和依赖](http://blogs.msdn.com/josh_/archive/2004/02/13/72844.aspx)

[了解VC项目系统第六部分：自定义构建步骤和构建事件](http://blogs.msdn.com/josh_/archive/2004/03/02/83035.aspx)

[了解 VC 项目系统第七部分：“makefile”项目和（重新）使用环境](http://blogs.msdn.com/josh_/archive/2004/05/18/134638.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T17:14:50.750

[这里](http://msdn.microsoft.com/en-us/library/a2zdt10t.aspx)有关于这个 UI 版本的文档。许多 XML 文件似乎都没有记录，通常只是给出一个[模式文件](http://msdn.microsoft.com/en-us/library/ak4435es.aspx)。你对它们如何运作的猜测是非常正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-15T12:51:17.580

这不是故事的全部。

*   分隔符不被继承。只有它们分隔的项目列表被继承：相同的用户宏在不同的属性表中可以有不同的分隔符，但只使用最后遇到的分隔符。（我写“最后遇到”是因为在项目级别，我们无法指定分隔符，并且在那里使用的是为该宏指定继承的最后一个属性表）
*   分隔符仅在由单个字符组成时才有效。在某些情况下，长于一个字符的分隔符可能会去掉其第一个和/或最后一个字符，这是错误地尝试“加入”值列表。
*   $(Inherit) 似乎在用户宏中工作。与聚合
    属性一样，它用作
    父值的占位符，并且可以出现多次。当没有找到 $(Inherit) 时，如果设置了继承标志，则在开头隐含。
*   $(NoInherit) 似乎也适用于用户的宏（使 VC 的行为就像未选中复选框一样）。
*   当用于构造属性表的路径时，用户宏（和一些内置函数）似乎可以工作（VC 自己的项目转换器使用该功能）。但是，在这种情况下，用户宏所采用的值并不总是直观的，特别是如果它在其他包含的属性表中重新定义时。
*   In general, what gets "inherited" or concatenated are formulae and not values (ie. you cannot use a user macro to take a snapshot the local value of (say) $(IntDir) in a property sheet and hope to "bubble up" that value through inheritance, because what gets inherited is actually the formula "$(IntDir)", whose value will eventually be resolved at the project/config/file level).
*   A property sheet already loaded is ignored (seem to avoid that the same property sheet has its user macros aggregated twice)
*   Both "/" and "\" appear to work in property sheet paths (and in most places where VS expects a path).
*   A property sheet path starting with "/" (after macros have been resolved) is assumed to be in "./", where '.' is the location of the calling sheet/project). Same if the path does not start with "./", "../" or "drive:/" (dunno about UNC).

# vxworks - 我可以在 VxWorks 中实现协作式多任务系统吗？

> ID：142710
> 
> 赞同：2
> 
> 时间：2008-09-27T01:29:29.600
> 
> 标签：vxworks

使用协作式多任务调度程序来实现遗留嵌入式系统。

该系统基本上按照以下方式工作：

*   任务 A 确实有效
*   任务 A 完成后，它产生处理器。
*   任务 B 获得处理器并开始工作。
*   任务 B 产生
    ...
*   任务 n 产量
*   任务 A 被安排并确实有效

一个大循环队列：A -> B -> C -> ... -> n -> A

我们正在将系统移植到新平台，并希望最大限度地减少系统重新设计。

有没有办法在 vxWorks 中实现这种类型的协作多任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T01:35:20.837

虽然 VxWorks 是基于优先级的操作系统，但可以实现这种类型的协作多任务。

只需将所有任务置于**相同**的优先级。
在您的代码中，您在哪里执行*yield*，只需插入一个 'taskDelay(0);'

请注意，您必须确保禁用内核时间切片 (kernelTimeSlice(0))。

所有具有相同优先级的任务都在一个队列中。当任务产生时，它会被放在队列的末尾。这将实现所描述的算法类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T03:01:21.847

我曾经在一个相对较大的嵌入式产品上工作过。时间片被禁用，当线程想要允许另一个线程运行时，它们会显式地执行 taskDelay。

我必须得出结论：禁用 vxWorks 切片会导致疯狂。避免它，如果它在你的能力范围内。

因为任务完全是非抢占式的（并且中断处理程序只允许将消息排入队列以供常规任务使用），系统已经放弃了对其任何数据结构的任何类型的锁定。如果所有数据结构都是一致的，则预计任务只会将调度程序释放给另一个任务。

随着时间的推移，最初的程序员继续前进，并被新的开发人员取代，以维护和扩展产品。随着它的功能越来越多，整个系统的响应速度越来越慢。当面对一项耗时过长的任务时，新开发人员会采取直接的解决方案：在中间插入 taskDelay。有时这很好，有时却不是...

禁用任务切片有效地使系统中的每个任务都依赖于其他所有任务。如果你有超过三个任务，或者你甚至*认为*你最终可能有超过三个任务，你真的需要构建系统来允许它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T02:30:19.627

这不是特定于 VxWorks，但您描述的系统是循环调度的变体（我假设您使用的是优先级队列，否则它只是循环调度）。

[wiki 文章](http://en.wikipedia.org/wiki/Round-robin_scheduling)提供了一些背景知识，然后您可以从那里开始。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T00:19:58.907

你所描述的本质上是：

```
void scheduler()
{
    while (1)
    {
        int st = microseconds();
        a();
        b();
        c();
        sleep(microseconds() - st);
    }
} 
```

但是，如果您还没有调度程序，那么现在是实施调度程序的好时机。在最简单的情况下，每个入口点既可以从 Task 类多次继承，也可以实现 Task 接口（取决于语言）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-06T11:08:33.067

您可以使所有任务具有相同的优先级并使用任务延迟（0），或者您可以在需要进行非抢占式工作的低优先级任务中使用任务锁定和任务解锁。

# security - 高可靠性/可用性/安全性的编码——我读什么标准？

> ID：142722
> 
> 赞同：12
> 
> 时间：2008-09-27T01:40:45.300
> 
> 标签：security, coding-style, reliability

我听说汽车行业有一种叫做 MISRA C 的东西。

其他高可靠性/可用性/安全性行业的相关标准是什么，例如

*   空间
*   飞机
*   银行/金融
*   汽车
*   医疗的
*   国防/军事
*   ？？？

-亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-27T05:01:34.443

查看戈达德太空飞行中心及其[编码标准](http://software.gsfc.nasa.gov/assetsbytype.cfm?TypeAsset=Standard)。我在自己的代码中采用的 C 标准之一是标头必须是自包含的，并且它们提供了一种简单的方法来强制执行这一点——模块的标头必须是模块中包含的第一个文件，所以如果文件不是独立的，则不会编译。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-27T02:40:12.660

如果您特别询问编码，MISRA 提供了一些避免 C 中常见错误的指南。

然而，好的软件远不止编码。航空工业的软件开发“圣经”是DO-178B。它告诉您在各个设计阶段需要解决哪些问题以及应如何记录答案。这是大量的文书工作，但如果你想让飞机在空中飞行，你希望最薄弱的环节是人（飞行员），而不是软件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-12T23:24:43.290

[对于在Ada](http://en.wikipedia.org/wiki/Ada_(programming_language))中编程高可靠性系统，有：[ISO/IEC TR 15942：“信息技术 - 编程语言 - 在高完整性系统中使用 Ada 编程语言的指南”](http://polaris.dit.upm.es/~ork/documents/adahis.pdf)：

> **介绍**
> 
> 作为一个社会，我们越来越依赖高度完整性的系统：安全系统（例如电传飞行器）、安全系统（保护数字信息）或金融系统（例如自动提款机）。随着这些系统的复杂性增加，对改进技术以生产系统的软件组件的需求也在增加。必须证明这些高完整性系统在运行中是完全可预测的，并且具有它们所需的所有属性。除了使用常规的动态测试之外，这只能通过分析软件来实现。目前，没有一种主流的高级语言可以保证该语言中的所有程序都是可预测和可分析的。因此，对于任何实现语言的选择，控制应用程序使用该语言的方式是必不可少的。Ada 语言 [ARM] 设计有特定的机制来控制语言某些方面的使用。此外，
> 
> 1.  Ada 程序的语义是明确定义的，即使在错误情况下也是如此。具体来说，程序的效果可以从语言定义中预测出来，几乎没有实现依赖或语言特征之间的交互。
>     
>     
> 2.  语言中的强类型可用于减少分析的范围（和成本）以验证关键属性。
>     
>     
> 3.  Ada 语言已成功用于许多高完整性应用程序。这表明经过验证的 Ada 编译器具有此类应用程序所需的质量。
>     
>     
> 4.  可以提供指导以促进语言的使用并鼓励开发工具以进行进一步验证。
>     
>     
> 
> 因此，Ada 非常适合实施高完整性软件，本文档提供了使用 Ada 所需的控制指南，以确保程序是可预测和可分析的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T05:39:23.557

[您可能会发现查看运营商级 Linux](http://www.linuxfoundation.org/en/Carrier_Grade_Linux)的一些要求很有启发性。虽然他们（顾名思义！）指定了 linux 要求，但他们这样做是为了在电信设备的高可用性部分中使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-06T12:49:36.843

FDA 有[软件验证的一般原则、](http://www.fda.gov/RegulatoryInformation/Guidances/ucm126954.htm)医疗器械制造商的[设计控制指南](http://www.fda.gov/MedicalDevices/DeviceRegulationandGuidance/GuidanceDocuments/ucm070627.htm)[、行业指南、FDA 审查员和
医疗器械中现成软件使用的](http://www.fda.gov/MedicalDevices/DeviceRegulationandGuidance/GuidanceDocuments/ucm073778.htm)合规性等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-27T17:36:35.580

NIST 提供了大量相关文档，您可以深入研究并仔细阅读他们的工作 - 但其中有很多，而且都非常冗长，所以我没有具体的文件可以指出。
如果您想更具体地满足您的需求，我可能会缩小范围...

此外，卡内基梅隆大学在可靠性开发过程方面几乎是权威，很容易找到他们的标准，但也很冗长。

此外，特定行业通常有自己的标准，这也取决于国家/地区。比如信用卡行业——PCI-DSS；欧盟银行业 - 巴塞尔协议 II；医疗 - HIPAA（虽然那是相当高的水平）；任何与美国政府相关的东西，各种 NIST 文档；等等

# spring - 您如何访问 bean 的属性以读取 spring xml 配置文件？

> ID：142740
> 
> 赞同：7
> 
> 时间：2008-09-27T01:55:23.003
> 
> 标签：spring

我想在春天做以下事情：

```
<beans>
    ...
    <bean id="bean1" ... />
    <bean id="bean2">
        <property name="propName" value="bean1.foo" />
... 
```

我认为这将访问 bean1 的 getFoo() 方法并调用 bean2 的 setPropName() 方法，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T02:39:28.870

我的理解：

1.  你有一个 bean (bean1) 有一个名为“foo”的属性
2.  您有另一个具有名为“propName”的属性的 bean (bean2)，它也必须具有与 bean1 中相同的“foo”。

为什么不这样做：

```
<beans>
...
<bean id="foo" class="foopackage.foo"/>
<bean id="bean1" class="foopackage.bean1">
  <property name="foo" ref="foo"/>
</bean> 
<bean id="bean2" class="foopackage.bean2">
  <property name="propName" ref="foo"/>
</bean>
....
</beans> 
```

这样做，您的 bean2 不会像您的示例中那样与 bean1 耦合。您可以更改 bean1 和 bean2 而不会相互影响。

如果您**真的**需要进行您建议的注射，您可以使用：

```
<util:property-path id="propName" path="bean1.foo"/> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T02:30:40.563

您需要使用[PropertyPathFactoryBean](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/PropertyPathFactoryBean.html)：

```
    <bean id="bean2" 依赖于="bean1">
        <属性名称="propName">
            <bean class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                <property name="targetBeanName" value="bean1"/>
                <property name="propertyPath" value="foo"/>
            </豆>
        </属性>
    </豆>

```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-27T02:15:37.447

我认为您必须注入 bean1，然后`foo`由于时间问题而手动获取。框架什么时候解析目标bean的值？

您可以创建一个指针 bean 并对其进行配置。

```
class SpringRef {
  private String targetProperty;
  private Object targetBean;

  //getters/setters

  public Object getValue() {
    //resolve the value of the targetProperty on targetBean. 
  }
} 
```

[Common-BeanUtils](http://commons.apache.org/beanutils/)应该会有所帮助。

# java - 在 OCR（光学字符识别）之前，您会推荐什么软件用于图像增强？

> ID：142743
> 
> 赞同：4
> 
> 时间：2008-09-27T01:56:07.977
> 
> 标签：java, .net, image-processing, ocr, image-enhancement

我们目前正在研究在提交给 OCR 之前提高图像质量的方法。我们目前使用的 OCR 引擎是 Nuance (v15) 的 Scansoft API。我们正在研究[领先工具](http://leadtools.com/)，但后来决定寻找其他地方。与 Lead Tools 相关的许可成本太高了。首先，我们正在寻找简单的图像增强功能，例如：去歪斜、去斑点、去除线条、去除打孔、锐化等。我们正在运行 .NET 和 Java 软件的组合，但首选 Java 解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-27T03:31:09.433

Kofax 非常适合进行预处理，但对于您所谈论的清理类型，除非图像真的很糟糕，否则可能会过度杀伤力。除非您的专长是图像处理，否则我建议您与执行图像清理和 OCR 的提供商合作，这样您就可以专注于您实际增加的价值。

我们从 ABBYY ( [ABBY SDK](http://www.abbyy.com/sdk/) ) 获得 OCR 开发套件的许可，发现它在图像处理和 OCR 方面都非常出色。API 非常广泛，示例应用程序、帮助和支持令人印象深刻。我绝对推荐看看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T17:58:05.290

*免责声明：我为 Atalasoft 工作*

我们拥有 .NET 的这些功能和运行时免版税许可。

[http://www.atalasoft.com/products/dotimage/](http://www.atalasoft.com/products/dotimage/)

我们还有 OCR 组件，包括用于 Abbyy、Tesseract 等的 .NET 包装器以及可搜索的 PDF 生成（PDF 中文本顶部的图像）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T02:02:02.720

不确定这是否完全符合你们需要的标准，但也许您应该查看一些[Paint.Net](http://www.getpaint.net/) API。我不知道提取他们的图像处理算法以用于您的项目有多么容易，但我相信他们会做一些您正在寻找的事情。此外，它是一个具有 MIT 许可证的开源项目，因此对于商业用途应该非常友好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T02:06:50.650

在 KOFAX.com 上对 KOFAX VRS 的研究

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T02:21:33.580

也许是 JMagick，它是 ImageMagick 的一个开源 Java 接口。它以薄 Java 本机接口 (JNI) 层的形式实现到 ImageMagick API。它是在 LGPL 下获得许可的，因此在许可方面应该不是问题。

[http://sourceforge.net/projects/jmagick/](http://sourceforge.net/projects/jmagick/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T14:36:10.010

我建议[英特尔](http://www.intel.com/cd/software/products/asmo-na/eng/238658.htm)为其零成本运行时许可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T04:30:00.053

取决于原始图像的数量和质量。托管代码和成像工具包可以工作，但如果您要处理数百万张图像，它并不总是最好的解决方案。对于小批量和紧张的预算，我同意之前的海报，即像***Aforge、Paint.NET***和其他开源计算机视觉库这样的项目可以解决问题。当然，如果结果没有改善，您就只能靠自己了……至少这可以让您以低成本将所需的一切都放在一个应用程序中。

如果您每月要处理数十万张图像，那么我建议您将流程分成更小的工作流程步骤并调整每个步骤，直到每张图像的成本尽可能接近零。您会发现 OCR 结果一开始上升很快，然后比您预期的更快趋于平稳。（我不是 OCR 的忠实粉丝，但它有它的位置）

我使用***Recogniform***的商业 Windows 产品在 OCR 之前使用针对各种图像调整的脚本以批处理模式处理和清理图像。如果图像未通过 QC 或被 OCR 引擎拒绝，则会使用使用***Atalasoft***工具包构建的自定义 .NET 应用程序手动“修复”。批处理一切，只触及失败的部分。

# winapi - 如何让 CreateProcess/CreateProcessW 在路径中执行进程 > MAX_PATH 字符

> ID：142750
> 
> 赞同：3
> 
> 时间：2008-09-27T02:06:29.077
> 
> 标签：winapi, createprocess, max-path

我试图让 CreateProcess 或 CreateProcessW 执行名称 < MAX_PATH 字符但路径大于 MAX_PATH 字符的进程。根据以下文档：[http://msdn.microsoft.com/en-us/library/ms682425.aspx](http://msdn.microsoft.com/en-us/library/ms682425.aspx)，我需要确保 lpApplicationName 不为 NULL，然后 lpCommandLine 最多可以包含 32,768 个字符。

我试过了，但我得到了 ERROR_PATH_NOT_FOUND。

我更改为 CreateProcessW，但仍然出现相同的错误。当我在 lpApplicationName 前面加上 \\?\ 时，如中所述[http://msdn.microsoft.com/en-us/library/aa365247(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365247(VS.85).aspx)在调用 CreateProcessW 时我得到一个不同的错误，让我觉得我更接近一点：ERROR_SXS_CANT_GEN_ACTCTX。

我对 CreateProcessW 的调用是：

`CreateProcessW(w_argv0,arg_string,NULL,NULL,0,NULL,NULL,&si,&ipi);`

w_argv0 在哪里`\\?\<long absolute path>\foo.exe.`

arg_string 包含 "<long absolute path>\foo.exe" foo

si 设置如下：

```
    memset(&si,0,sizeof(si));
    si.cb = sizeof(si);
    si.dwFlags = STARTF_USESHOWWINDOW;
    si.wShowWindow = SW_HIDE;>

```

并且 pi 为空，如下所示：

```
    memset(&pi,0,sizeof(pi));

```

我查看了系统事件日志，每次尝试使用事件 id 59 进行此操作时都会出现一个新条目，源 SideBySide: Generate Activation Context failed for .Manifest。参考错误信息：操作成功完成。

我尝试执行的文件在 < MAX_PATH 字符的路径中运行良好。

澄清一下， <long absolute path> 的任何一个组成部分都不大于 MAX_PATH 个字符。可执行文件本身的名称当然不是，即使最后有 .manifest。但是，整个路径加起来的长度大于 MAX_PATH 个字符。

无论我是否嵌入其清单，我都会收到相同的错误。清单被命名为 foo.exe.manifest，当它没有嵌入时，它与可执行文件位于同一目录中。它包含：

```
<?xml 版本='1.0' 编码='UTF-8' 独立='yes'?>
<程序集 xmlns='urn:schemas-microsoft-com:asm.v1' manifestVersion='1.0'>
  <依赖>
    <依赖程序集>
      <assemblyIdentity type='win32' name='Microsoft.VC80.DebugCRT' version='8.0.50727.762' processorArchitecture='x86' publicKeyToken='1fc8b3b9a1e18e3b' />
    </dependentAssembly>
  </依赖>
</汇编>

```

有谁知道如何让它工作？可能：

*   调用 CreateProcess 或 CreateProcessW 以在路径 > MAX_PATH 字符中执行进程的其他方式

*   我可以在清单文件中做的事情

我在 XP SP2 上使用 Visual Studio 2005 构建并运行本机。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-28T01:16:33.150

嵌入清单并使用 GetShortPathNameW 为我做了。一个或另一个是不够的。

在使用要执行的进程的 \\? 前缀的绝对路径名作为第一个参数调用 CreateProcessW 之前，我检查：

```
wchar_t *w_argv0;
wchar_t *w_short_argv0;

...

if (wcslen(w_argv0) >= MAX_PATH)
{
    num_chars = GetShortPathNameW(w_argv0,NULL,0);
    如果（num_chars == 0）{
        syslog(LOG_ERR,"GetShortPathName(%S) 获取大小失败 (%d)", 
               w_argv0,GetLastError());
        /*
        ** 不妨继续尝试使用长名称
        */
    } 别的 {
        w_short_argv0 = malloc(num_chars * sizeof(wchar_t));
        memset(w_short_argv0,0,num_chars * sizeof(wchar_t));
        if (GetShortPathNameW(w_argv0,w_short_argv0,num_chars) == 0) {
            syslog(LOG_ERR,"GetShortPathName(%S) 失败 (%d)",w_argv0, 
            GetLastError());
            免费（w_short_argv0）；
            w_short_argv0 = NULL；
        } 别的 {
            syslog(LOG_DEBUG,"为 %S 使用短名称 %S",w_short_argv0, 
            w_argv0);
        }
    }
}

```

然后调用 CreateProcessW(w_short_argv0 ? w_short_argv0 : w_argv0...);

记得释放（w_short_argv0）；然后。

这可能无法解决所有情况，但它让我产生了比以前更多的子进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T10:54:29.417

我在 CreateProcess 文档中没有看到任何参考说明 '\\?\' 语法对模块名称有效。“命名文件或目录”页面也没有说明 CreateProcess 支持它，而 CreateFile 等功能链接到“命名文件”页面。

我*确实*看到您不能使用比`MAX_PATH`in更长的模块名称`lpCommandLine`，这表明 CreateProcess 不支持超长文件名。该错误消息还表明在尝试将“.manifest”附加到您的应用程序路径时发生错误（即，长度现在超过了 MAX_PATH）。

GetShortPathName() 在这里可能会有所帮助，尽管它不能保证返回小于 MAX_PATH 的名称（但它确实明确指出 '\\?\' 语法是有效的）。否则，您可以尝试调整`PATH`环境变量并将其传递给`lpEnvironment`. 或者您可以使用 SetCurrentDirectory() 并仅传递可执行文件名称。

# sharepoint - 创建新项目后自动设置列表项权限

> ID：142756
> 
> 赞同：0
> 
> 时间：2008-09-27T02:08:03.267
> 
> 标签：sharepoint, wss

我们有一个 SharePoint 团队网站（WSS 3.0 不是 MOSS），其中包括任务列表以记录与项目相关的每个任务。这是场景。

用户：

*   项目清单
*   主管1
*   团队成员1
*   团队成员2
*   团队成员3

我们如何设置权限设置，以便

*   每个用户（主管和团队成员）都可以看到任何任务。
*   主管可以编辑任何任务
*   团队成员只能编辑他们自己的任务（分配给他们或由他们创建的任务）

如果不对列表中的每个项目使用手动权限设置，我无法使用标准 WSS 权限设置实现预期结果。我想象必须使用某种工作流或触发器来完成自动解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-28T07:53:08.640

**您不需要任何工作流或事件处理程序**（您仍然可以将它们用于您的目的，但如果您有很多项目，它们会降低性能）

转到设置->列表设置单击高级设置

在读取访问中的项目级别权限中选择所有项目，并在编辑访问中的同一位置仅选择他们自己的

并在权限中为列表成员提供贡献者角色

对于主管，你可以给他更高的权限，我认为设计师会工作，或者你可以让他完全控制列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T02:41:45.700

您可以通过转到您的列表来设置权限，单击设置下拉菜单。在权限和管理下，单击“此列表的权限”。单击操作并选择编辑权限。选择要更改权限的用户/组，然后单击操作并选择编辑用户权限。

！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-28T00:01:00.990

创建一个从 SPItemEventReceiver 继承的类并覆盖 ItemAdded 方法，使用 API 在 overriedden 方法中设置您的自定义权限。

[http://blogs.msdn.com/brianwilson/archive/2007/03/05/part-1-event-handlers-everything-you-need-to-know-about-microsoft-office-sharepoint-portal-server-苔藓事件处理程序.aspx](http://blogs.msdn.com/brianwilson/archive/2007/03/05/part-1-event-handlers-everything-you-need-to-know-about-microsoft-office-sharepoint-portal-server-moss-event-handlers.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T02:37:51.887

是的，您必须编写一个在项目创建时运行的事件处理程序或工作流，它会查看这些列值并设置项目级别权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T06:44:04.073

我建议您检查此解决方案： [SharePointBoost 的 SharePoint 列/查看权限（199 美元）](http://www.sharepointreviews.com/component/content/article/51-security/394)

通过这个您可以对所有项目设置您想要的人的只读权限，您的“每个用户（主管和团队成员）都可以看到任何任务”的要求得到了解决！

您还可以为主管设置编辑权限。第二个问题解决了！

正如阿里所说，高级权限>项目级权限可以满足您的最后一个要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-16T03:33:20.783

您似乎需要一个工作流来根据用户角色或 [Assign To] 字段自动分配权限。尝试第三方工具[Permission Workflow](http://www.boostsolutions.com/permissionworkflow.html)，这可能会帮助您解决问题。

# linq-to-entities - LINQ-to-Entities（不是 Linq-to-SQL）中是否有 DataContext？

> ID：142762
> 
> 赞同：7
> 
> 时间：2008-09-27T02:11:48.080
> 
> 标签：linq-to-entities

我最近问了一个[关于跟踪 Linq-to-Entities的问题](https://stackoverflow.com/questions/137712/sql-tracing-linq-to-entities)

我认为其中[一个答案](https://stackoverflow.com/questions/137712/sql-tracing-linq-to-entities#138109)是不正确的，因为它们指的是使用 DataContext。是否有 LINQ-to-Entities 的 DataContext？如果是这样，我该如何得到它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-27T03:21:55.180

**LINQ to Entities 使用 ObjectContext，而不是 DataContext。**

以下是对 EF 的简短描述：

> [LINQ to Entities、ObjectContext 类和实体数据模型](http://msdn.microsoft.com/en-us/library/bb399414.aspx "LINQ 和实体数据模型")
> 
> LINQ to Entities 查询使用*对象服务基础结构*。**ObjectContext**类是作为 CLR 对象**与 EDM 交互**的 主要类。开发者通过 ObjectContext 构造一个 ObjectQuery 实例。通用 ObjectQuery 类表示返回类型实体的实例或集合的查询。ObjectQuery 返回的实体对象由对象上下文跟踪，并且可以使用 SaveChanges 方法进行更新。

它甚至与 LINQ to SQL 中的 DataContext 的工作方式不同。虽然它们确实都管理连接和跟踪更改，但它们在数据结构和关系的建模方式上有所不同。

不过，我会给那个错误答案的发布者一些松懈，因为 LINQ to SQL 确实引用了“实体”，不熟悉 EF 的人很可能仍然认为他们知道你在说什么。

例如：

> [LINQ to SQL 和 DataContext 类](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx "数据上下文类")
> 
> DataContext 是通过数据库连接映射**的所有实体的源。**它**跟踪**您对**所有检索到的实体**所做的更改，并维护一个“身份缓存”，以保证多次检索到的实体使用相同的**对象实例**来表示。

这可能会令人困惑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T03:19:40.880

显然，LinqToEntities 使用[ObjectContext](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.aspx)而不是 DataContext。

有趣的是，对象团队制作了一个 DataContext，而数据团队制作了一个 ObjectContext（以及 DataQuery 与 ObjectQuery 等）。“命名很难！”

* * *

[更新，对于带有 EF4.1 的 .net 4，在使用LinqToEntities](http://msdn.microsoft.com/en-us/library/system.data.entity.dbcontext%28v=vs.103%29.aspx)时，您可能还对DbContext感兴趣。另请[参阅](https://stackoverflow.com/questions/3471455/is-dbcontext-the-same-as-datacontext)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T07:14:48.503

我想您可能指的是 ADO.NET 实体数据模型（.edmx 文件 - 与 .dbml 文件相当）。

在 VS 中可以在**Add Item->ADO.NET Entity Data Model中看到**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T23:08:34.803

这些任意的语法差异有**很多**。例如 SubmitChanges (L2S) 和 SaveChanges (L2E)。但是，这只是两种技术之间差异的一小部分。

# python - 如何在 ubuntu linux 8.04 上将 python 2.5.2 升级到 python 2.6rc2？

> ID：142764
> 
> 赞同：8
> 
> 时间：2008-09-27T02:15:03.703
> 
> 标签：python, linux, ubuntu, installation

我想了解如何将 ubuntu 8.04 提供的默认 python 安装（2.5.2）升级到 python 2.6rc2。我想让 2.6 成为系统上的默认 python 版本，并将安装在 2.5.2 上的所有其他有用的已安装 python 库迁移到 python 2.6rc2。请让我知道如何实现这一目标。

谢谢德克

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-27T02:19:38.233

警告我认为用未发布的 beta 版本替换默认 Python 是一个非常糟糕的主意：

首先，安装2.6rc2。您可以从[Python 网站](http://www.python.org/download/releases/2.6/)下载源代码。标准`./configure && make && sudo make install`安装方式。

接下来，删除`/usr/bin/python`符号链接。不要删除。*_* `/usr/bin/python2.5`使用 .将符号链接添加到 2.6 `ln -s /usr/local/bin/python2.6 /usr/bin/python`。

再一次，我认为这是一个糟糕的主意。几乎可以肯定，有更好的方法来完成您想要完成的任何事情。

* * *

迁移已安装的库是一个更长的过程。查看`/usr/lib/python2.5/site-packages/`和`/usr/local/lib/python2.5/site-packages/`目录。安装到它们的任何库都需要使用 2.6 重新安装。由于您没有使用打包的 Python 版本，因此您不能使用 Ubuntu 的软件包——您必须自己手动升级所有库。它们中的大多数可能都可以安装`sudo easy_install <name>`，但像 PyGTK+ 这样的一些并不那么容易。您必须遵循每个此类库的自定义安装过程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T08:41:01.423

我有同样的问题，显然可以在这里找到预构建的二进制文件：

```
# Python 2.6
deb http://ppa.launchpad.net/doko/ubuntu intrepid main
deb-src http://ppa.launchpad.net/doko/ubuntu intrepid main 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T02:25:18.563

有没有必要？

Ubuntu 通常不打包 RC 版本。在 Jaunty Jackalope 之前，Ubuntu 2.6 将不可用。

但是，如果您坚持需要安装它，那么您将不得不在没有包管理器的情况下这样做。

下载包，解压到一个目录

运行以下命令（等待每个命令完成）

```
./configure
make
sudo make install 
```

在那里，你已经安装了它。

最好先等待它被打包，尤其是因为 Python 用于很多 ubuntu 内部，所以可能会严重破坏你的系统

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T08:10:39.813

更改 Python 的默认版本是不明智的，即在 shell 中键入“python”时会得到什么。但是，您可以安装多个版本的 python。诀窍是确保路径上名为“python”的程序是系统提供的版本。如果你想运行 Python 2.6 的安装，你需要在 shell 中输入 python2.6 来启动它。

下载包并解压，然后运行：

```
./configure
make
sudo make install
ls -l /usr/local/bin 
```

您应该会看到一个 python 和一个 python2.6 文件，它们都是在您运行 make install 当天创建的；删除python文件。然后，当`python`启动标准系统 Python 版本时，`/usr/bin` 将运行，当`python2.6`运行时，您将获得闪亮的新 python 2.6rc2。Python 在启动交互式解释器时显示版本。

# svn - CruiseControl.NET 中的 Project 和 SVN workingDirectory 配置块有什么区别

> ID：142772
> 
> 赞同：3
> 
> 时间：2008-09-27T02:20:55.530
> 
> 标签：svn, installation, cruisecontrol.net

CruiseControl.NET 中的 Project 和 SVN workingDirectory 配置块有什么区别？

我设置了 Subversion，现在我正在使用 CruiseControl.NET 并注意到配置文件中有两个 workingDirectory 块。我浏览了他们的谷歌群组和文档，也许我错过了一些东西，但我没有看到在构建过程中如何使用它们的清晰示例。

下面的部分配置取自他们的项目文件示例页面 [http://confluence.public.thoughtworks.org/display/CCNET/Configuring+the+Server](http://confluence.public.thoughtworks.org/display/CCNET/Configuring+the+Server)

```
<cruisecontrol>
    <queue name="Q1" duplicates="ApplyForceBuildsReplace"/>
    <project name="MyProject" queue="Q1" queuePriority="1">
        <webURL>http://mybuildserver/ccnet/</webURL>
        <workingDirectory>C:\Integration\MyProject\WorkingDirectory</workingDirectory>
        <artifactDirectory>C:\Integration\MyProject\Artifacts</artifactDirectory>
        <modificationDelaySeconds>10</modificationDelaySeconds>

        <triggers>
            <intervalTrigger seconds="60" name="continuous" />
        </triggers>

        <sourcecontrol type="cvs">
            <executable>c:\putty\cvswithplinkrsh.bat</executable>
            <workingDirectory>c:\fromcvs\myrepo</workingDirectory>
            <cvsroot>:ext:mycvsserver:/cvsroot/myrepo</cvsroot>
        </sourcecontrol>
    </project>
</cruisecontrol> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T02:43:11.483

我认为项目工作目录用作 CruiseControl 块中所有命令的根文件夹。因此，如果我有一个带有相关文件夹的 Nant 任务/脚本，它将被附加到这个根文件夹以供实际执行。

> 项目的工作目录（由其他块使用）。相对路径相对于启动 CruiseControl.NET 服务器的目录中名为项目名称的目录。工作目录旨在包含正在集成的项目的签出版本。

SourceControl 工作目录是您的 SVN 或 CVS 在调用时检查文件的地方。例如，这将是您的项目文件夹下的“Src”子目录。

> 源已检出到的文件夹。

引用来源：

*   [http://confluence.public.thoughtworks.org/display/CCNET/Project+Configuration+Block](http://confluence.public.thoughtworks.org/display/CCNET/Project+Configuration+Block)
*   [http://confluence.public.thoughtworks.org/display/CCNET/CVS+Source+Control+Block](http://confluence.public.thoughtworks.org/display/CCNET/CVS+Source+Control+Block)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T02:39:03.460

请参阅[项目配置块](http://confluence.public.thoughtworks.org/display/CCNET/Project+Configuration+Block)和[Subversion 源代码控制块](http://confluence.public.thoughtworks.org/display/CCNET/Subversion+Source+Control+Block)。Project 工作目录用于整个项目，Source Control 工作目录指定源将*检出*到的位置。这可能与您的项目工作目录不同（如果是，可能是子目录）。

# c++ - Visual Studio 2008 Express MFC 支持

> ID：142781
> 
> 赞同：4
> 
> 时间：2008-09-27T02:27:46.340
> 
> 标签：c++, visual-studio-2008, visual-studio-2005, mfc

许多人可能都知道，Visual Studio 2008 的 Express 版本不包括对 MFC 和编译大量 Windows 程序所需的一些其他包的支持。

所以，这是我的问题：

我有完整版的 Visual Studio 2005。我一直在用它来编译我的一个朋友正在做的一个项目，这样我就可以为他测试它并继续跟踪错误和事情。最近，他将该项目升级到 VS 2008，而我没有。所以，我下载了 express 版本，希望我可以简单地用它编译，但不走运，它抱怨标题左右丢失。

在我看来，既然我已经拥有了 VS 2005 的完整版本，那么我肯定至少有一些（可能是较旧的）有问题的文件版本，他的项目需要针对这些文件进行编译。

有没有一种方法可以说服 VS 2008 也在 2005 的目录中查找包含文件和库文件以进行编译？

此外，这是一个坏主意吗？我真的不想出去购买完整的VS 2008，因为我自己永远不会使用它。（目前，2005 年对我来说做得很好，而且我还是更喜欢 GCC。）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T02:45:16.783

您可以直接从命令行使用 VC++ 编译器，或者只是在 Visual Studio 2005 中使用源代码创建一个新项目。除非他使用的是 2008/2008sp1 新版本的 MFC/ATL 中提供的某些功能，否则您应该能够编译项目就好了。

请参阅 Visual Studio 2005 中的（“从现有源创建项目”）。不幸的是，它们没有在 Express Edition 中包含这些库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T22:32:38.537

处理此问题的简单方法是将解决方案和项目文件从源代码控制恢复到其 Visual Studio 2005 状态（您正在使用源代码控制吗？）。此时，只要您的朋友不使用任何 mfc 9 独有的功能，您就可以编译项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T08:34:47.737

使用 Visual Studio 2005 中的 vcvars*.bat 脚本。请参阅VC++ 博客中的[这篇](http://blogs.msdn.com/vcblog/archive/2007/12/30/using-different-toolsets-for-vc-build.aspx)博文了解如何操作。您将使用旧的编译器，但使用 Visual Studio 2008 的构建系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T16:06:52.503

您可以进入 Tools>Options>Projects and Solutions>VC++ 目录并更改 Include、Library 和 Source（可能还有 Reference？）文件夹以使用 VC++ 2005 的文件夹。

我猜你只是用硬编码的 VS 2005 路径替换 $(VCInstallDir) 。在执行此操作之前，我会记录原始值。

**但是，您是否尝试过使用 OLD 2005 sln 和 vcproj 文件？**继续在你的一端使用 2005，在他的一端使用 2008。为每个 IDE 保留两组这些文件。任何问题都将与库不匹配有关——通过将 2008 年的工具与 2005 年的库一起使用，您无法避免这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T15:19:22.527

我要尝试的第一件事是通过修改 .sln 和 .vcproj 文件的版本在 VS 2005 中加载它。在 .vcproj 中将版本从 9.00 更改为 8.00，在 .sln 中将格式版本从 10.00 更改为 9.00。

如果您在项目中没有花哨的东西，那么您很有可能能够像这样使用它。这也将避免必须更新 2 个项目和解决方案文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-14T12:45:45.510

在这个网站上，它展示了如何使用 Visual Studio Express 版本编译 MFC 代码： [链接](http://www.codeproject.com/KB/MFC/MFCinVisualStudioExpress.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T11:13:05.123

只是为了记录，我已经做到了（通过从 IDE 内部修改包含目录和库目录）并且它工作得很好，我有 MFC、ATL，一切。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-14T12:13:06.123

我找到了这个解释。[http://www.codeproject.com/Articles/30439/How-to-compile-MFC-code-in-Visual-C-Express](http://www.codeproject.com/Articles/30439/How-to-compile-MFC-code-in-Visual-C-Express)

# c - 什么是 C 中的“回调”，它们是如何实现的？

> ID：142789
> 
> 赞同：169
> 
> 时间：2008-09-27T02:32:40.993
> 
> 标签：c, callback

从我所做的阅读来看，Core Audio 严重依赖回调（和 C++，但这是另一回事）。

我理解设置一个由另一个函数重复调用以完成任务的函数的概念（有点）。我只是不明白它们是如何设置的以及它们是如何工作的。任何示例将不胜感激。

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2008-09-27T02:46:11.477

C 中没有“回调”——不比任何其他通用编程概念更多。

它们是使用函数指针实现的。这是一个例子：

```
void populate_array(int *array, size_t arraySize, int (*getNextValue)(void))
{
    for (size_t i=0; i<arraySize; i++)
        array[i] = getNextValue();
}

int getNextRandomValue(void)
{
    return rand();
}

int main(void)
{
    int myarray[10];
    populate_array(myarray, 10, getNextRandomValue);
    ...
} 
```

在这里，该`populate_array`函数将函数指针作为其第三个参数，并调用它以获取用于填充数组的值。我们编写了回调`getNextRandomValue`，它返回一个随机值，并将指向它的指针传递给`populate_array`. `populate_array`将调用我们的回调函数 10 次并将返回的值分配给给定数组中的元素。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2008-09-29T01:47:54.017

这是 C 中的回调示例。

假设您想编写一些代码，允许在某些事件发生时调用注册回调。

首先定义用于回调的函数类型：

```
typedef void (*event_cb_t)(const struct event *evt, void *userdata); 
```

现在，定义一个用于注册回调的函数：

```
int event_cb_register(event_cb_t cb, void *userdata); 
```

这是注册回调的代码：

```
static void my_event_cb(const struct event *evt, void *data)
{
    /* do stuff and things with the event */
}

...
   event_cb_register(my_event_cb, &my_custom_data);
... 
```

在事件分派器的内部，回调可能存储在一个看起来像这样的结构中：

```
struct event_cb {
    event_cb_t cb;
    void *data;
}; 
```

这就是执行回调的代码的样子。

```
struct event_cb *callback;

...

/* Get the event_cb that you want to execute */

callback->cb(event, callback->data); 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-11-27T09:11:02.733

一个简单的回调程序。希望它能回答你的问题。

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>
#include "../../common_typedef.h"

typedef void (*call_back) (S32, S32);

void test_call_back(S32 a, S32 b)
{
    printf("In call back function, a:%d \t b:%d \n", a, b);
}

void call_callback_func(call_back back)
{
    S32 a = 5;
    S32 b = 7;

    back(a, b);
}

S32 main(S32 argc, S8 *argv[])
{
    S32 ret = SUCCESS;

    call_back back;

    back = test_call_back;

    call_callback_func(back);

    return ret;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-09-07T01:03:14.170

C 中的回调函数等效于分配以在另一个函数中使用的函数参数/变量。[维基示例](https://en.wikipedia.org/wiki/Callback_%28computer_programming%29)

在下面的代码中，

```
#include <stdio.h>
#include <stdlib.h>

/* The calling function takes a single callback as a parameter. */
void PrintTwoNumbers(int (*numberSource)(void)) {
    printf("%d and %d\n", numberSource(), numberSource());
}

/* A possible callback */
int overNineThousand(void) {
    return (rand() % 1000) + 9001;
}

/* Another possible callback. */
int meaningOfLife(void) {
    return 42;
}

/* Here we call PrintTwoNumbers() with three different callbacks. */
int main(void) {
    PrintTwoNumbers(&rand);
    PrintTwoNumbers(&overNineThousand);
    PrintTwoNumbers(&meaningOfLife);
    return 0;
} 
```

函数调用 PrintTwoNumbers 中的函数 (*numberSource) 是一个在 PrintTwoNumbers 内部“回调”/执行的函数，由代码在运行时指定。

因此，如果你有类似 pthread 函数的东西，你可以从它的实例化分配另一个函数在循环内运行。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-03-02T16:03:37.473

C 中的回调是提供给另一个函数以在另一个函数执行其任务时“回调”的函数。

回调有[两种使用方式](https://en.wikipedia.org/wiki/Callback_(computer_programming))：同步回调和异步回调。同步回调被提供给另一个函数，该函数将执行一些任务，然后在任务完成后返回给调用者。向另一个函数提供异步回调，该函数将启动一个任务，然后在任务可能未完成的情况下返回给调用者。

同步回调通常用于向另一个函数提供委托，另一个函数将任务的某些步骤委托给该函数。此委托的经典示例是来自 C 标准库的函数`bsearch()`和。`qsort()`这两个函数都接受一个回调，该回调在函数提供的任务期间使用，以便正在搜索的数据的类型（在 的情况下`bsearch()`）或排序的数据的类型（在 的情况下）`qsort()`不需要被函数知道用过的。

例如，这是一个`bsearch()`使用不同比较函数、同步回调的小示例程序。通过允许我们将数据比较委托给回调函数，该`bsearch()`函数允许我们在运行时决定我们想要使用哪种比较。这是同步的，因为当`bsearch()`函数返回时，任务就完成了。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct {
    int iValue;
    int kValue;
    char label[6];
} MyData;

int cmpMyData_iValue (MyData *item1, MyData *item2)
{
    if (item1->iValue < item2->iValue) return -1;
    if (item1->iValue > item2->iValue) return 1;
    return 0;
}

int cmpMyData_kValue (MyData *item1, MyData *item2)
{
    if (item1->kValue < item2->kValue) return -1;
    if (item1->kValue > item2->kValue) return 1;
    return 0;
}

int cmpMyData_label (MyData *item1, MyData *item2)
{
    return strcmp (item1->label, item2->label);
}

void bsearch_results (MyData *srch, MyData *found)
{
        if (found) {
            printf ("found - iValue = %d, kValue = %d, label = %s\n", found->iValue, found->kValue, found->label);
        } else {
            printf ("item not found, iValue = %d, kValue = %d, label = %s\n", srch->iValue, srch->kValue, srch->label);
        }
}

int main ()
{
    MyData dataList[256] = {0};

    {
        int i;
        for (i = 0; i < 20; i++) {
            dataList[i].iValue = i + 100;
            dataList[i].kValue = i + 1000;
            sprintf (dataList[i].label, "%2.2d", i + 10);
        }
    }

//  ... some code then we do a search
    {
        MyData srchItem = { 105, 1018, "13"};
        MyData *foundItem = bsearch (&srchItem, dataList, 20, sizeof(MyData), cmpMyData_iValue );

        bsearch_results (&srchItem, foundItem);

        foundItem = bsearch (&srchItem, dataList, 20, sizeof(MyData), cmpMyData_kValue );
        bsearch_results (&srchItem, foundItem);

        foundItem = bsearch (&srchItem, dataList, 20, sizeof(MyData), cmpMyData_label );
        bsearch_results (&srchItem, foundItem);
    }
} 
```

异步回调的不同之处在于，当我们提供回调的被调用函数返回时，任务可能无法完成。这种类型的回调通常与异步 I/O 一起使用，其中启动 I/O 操作，然后在完成时调用回调。

在下面的程序中，我们创建一个套接字来监听 TCP 连接请求，当收到请求时，进行监听的函数然后调用提供的回调函数。可以通过在一个窗口中运行这个简单的应用程序，同时使用`telnet`实用程序或 Web 浏览器尝试在另一个窗口中连接来执行此简单应用程序。

[我从 Microsoft 在https://msdn.microsoft.com/en-us/library/windows/desktop/ms737526(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms737526(v=vs.85).aspx)`accept()`提供的函数示例中提取了大部分 WinSock 代码

此应用程序`listen()`使用端口 8282 在本地主机 127.0.0.1 上启动 a ，因此您可以使用`telnet 127.0.0.1 8282`或`http://127.0.0.1:8282/`。

此示例应用程序是作为带有 Visual Studio 2017 社区版的控制台应用程序创建的，它使用的是 Microsoft WinSock 版本的套接字。对于 Linux 应用程序，WinSock 函数需要替换为 Linux 替代品，而 Windows 线程库将`pthreads`改为使用。

```
#include <stdio.h>
#include <winsock2.h>
#include <stdlib.h>
#include <string.h>

#include <Windows.h>

// Need to link with Ws2_32.lib
#pragma comment(lib, "Ws2_32.lib")

// function for the thread we are going to start up with _beginthreadex().
// this function/thread will create a listen server waiting for a TCP
// connection request to come into the designated port.
// _stdcall modifier required by _beginthreadex().
int _stdcall ioThread(void (*pOutput)())
{
    //----------------------
    // Initialize Winsock.
    WSADATA wsaData;
    int iResult = WSAStartup(MAKEWORD(2, 2), &wsaData);
    if (iResult != NO_ERROR) {
        printf("WSAStartup failed with error: %ld\n", iResult);
        return 1;
    }
    //----------------------
    // Create a SOCKET for listening for
    // incoming connection requests.
    SOCKET ListenSocket;
    ListenSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    if (ListenSocket == INVALID_SOCKET) {
        wprintf(L"socket failed with error: %ld\n", WSAGetLastError());
        WSACleanup();
        return 1;
    }
    //----------------------
    // The sockaddr_in structure specifies the address family,
    // IP address, and port for the socket that is being bound.
    struct sockaddr_in service;
    service.sin_family = AF_INET;
    service.sin_addr.s_addr = inet_addr("127.0.0.1");
    service.sin_port = htons(8282);

    if (bind(ListenSocket, (SOCKADDR *)& service, sizeof(service)) == SOCKET_ERROR) {
        printf("bind failed with error: %ld\n", WSAGetLastError());
        closesocket(ListenSocket);
        WSACleanup();
        return 1;
    }
    //----------------------
    // Listen for incoming connection requests.
    // on the created socket
    if (listen(ListenSocket, 1) == SOCKET_ERROR) {
        printf("listen failed with error: %ld\n", WSAGetLastError());
        closesocket(ListenSocket);
        WSACleanup();
        return 1;
    }
    //----------------------
    // Create a SOCKET for accepting incoming requests.
    SOCKET AcceptSocket;
    printf("Waiting for client to connect...\n");

    //----------------------
    // Accept the connection.
    AcceptSocket = accept(ListenSocket, NULL, NULL);
    if (AcceptSocket == INVALID_SOCKET) {
        printf("accept failed with error: %ld\n", WSAGetLastError());
        closesocket(ListenSocket);
        WSACleanup();
        return 1;
    }
    else
        pOutput ();   // we have a connection request so do the callback

    // No longer need server socket
    closesocket(ListenSocket);

    WSACleanup();
    return 0;
}

// our callback which is invoked whenever a connection is made.
void printOut(void)
{
    printf("connection received.\n");
}

#include <process.h>

int main()
{
     // start up our listen server and provide a callback
    _beginthreadex(NULL, 0, ioThread, printOut, 0, NULL);
    // do other things while waiting for a connection. In this case
    // just sleep for a while.
    Sleep(30000);
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-27T02:36:48.287

C 中的回调通常使用函数指针和关联的数据指针来实现。您将函数`on_event()`和数据指针传递给框架函数`watch_events()`（例如）。当事件发生时，您的函数会使用您的数据和一些特定于事件的数据来调用。

回调也用于 GUI 编程。[GTK+ 教程中有一个关于](http://library.gnome.org/devel/gtk-tutorial/stable/)[信号和回调理论的](http://library.gnome.org/devel/gtk-tutorial/stable/x159.html)精彩部分。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-27T02:41:03.097

这篇[维基百科文章](http://en.wikipedia.org/wiki/Callback_(computer_science))有一个 C 语言示例。

一个很好的例子是，为增强 Apache Web 服务器而编写的新模块通过向 apache 主进程传递函数指针来注册它们，以便回调这些函数来处理网页请求。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-12-04T23:10:23.037

通过示例更容易理解一个想法。到目前为止，关于 C 中回调函数的内容都是很好的答案，但使用该功能的最大好处可能是保持代码干净整洁。

# 例子

下面的 C 代码实现了快速排序。下面代码中最有趣的一行是这一行，我们可以在其中看到回调函数的作用：

```
qsort(arr,N,sizeof(int),compare_s2b); 
```

compare_s2b 是 qsort() 用来调用函数的函数的名称。这使 qsort() 保持整洁（因此更易于维护）。您只需从另一个函数内部按名称调用一个函数（当然，函数原型声明至少必须先于它才能从另一个函数调用）。

# 完整代码

```
#include <stdio.h>
#include <stdlib.h>

int arr[]={56,90,45,1234,12,3,7,18};
//function prototype declaration 

int compare_s2b(const void *a,const void *b);

int compare_b2s(const void *a,const void *b);

//arranges the array number from the smallest to the biggest
int compare_s2b(const void* a, const void* b)
{
    const int* p=(const int*)a;
    const int* q=(const int*)b;

    return *p-*q;
}

//arranges the array number from the biggest to the smallest
int compare_b2s(const void* a, const void* b)
{
    const int* p=(const int*)a;
    const int* q=(const int*)b;

    return *q-*p;
}

int main()
{
    printf("Before sorting\n\n");

    int N=sizeof(arr)/sizeof(int);

    for(int i=0;i<N;i++)
    {
        printf("%d\t",arr[i]);
    }

    printf("\n");

    qsort(arr,N,sizeof(int),compare_s2b);

    printf("\nSorted small to big\n\n");

    for(int j=0;j<N;j++)
    {
        printf("%d\t",arr[j]);
    }

    qsort(arr,N,sizeof(int),compare_b2s);

    printf("\nSorted big to small\n\n");

    for(int j=0;j<N;j++)
    {
        printf("%d\t",arr[j]);
    }

    exit(0);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T02:37:01.093

通常这可以通过使用函数指针来完成，这是一个指向函数内存位置的特殊变量。然后，您可以使用它来调用具有特定参数的函数。所以可能会有一个设置回调函数的函数。这将接受一个函数指针，然后将该地址存储在可以使用的地方。之后，当触发指定的事件时，它将调用该函数。

# c++ - 网络多线程

> ID：142804
> 
> 赞同：4
> 
> 时间：2008-09-27T02:43:26.257
> 
> 标签：c++, multithreading, networking

我正在编写一个在线游戏有两个原因，一个是让自己熟悉实时环境中的服务器/客户端请求（而不是像典型的网络浏览器那样，它不是实时的），并且实际上让我的手在那个区域湿了，所以我可以着手实际设计一个。

任何人，我都是用 C++ 做的，我一直在使用 winsock 来处理我的基本的、基本的网络测试。我显然想使用帧限制器并在某个时候进行 3D 和所有这些，我的主要问题是当我执行 send() 或 receive() 时，程序会在那里闲置并等待响应。即使是最好的互联网连接，这也可能导致 8 fps。

所以对我来说显而易见的解决方案是将网络代码从主进程中取出并在自己的线程中启动它。理想情况下，我会在我的主进程中调用“发送”，它将向网络线程传递一个指向消息的指针，然后定期（每帧）检查网络线程是否已收到回复，或超时，或什么你。在一个完美的世界中，我实际上会同时运行 2 个或更多网络线程，这样我就可以说运行一个聊天窗口并在后台下载一件盔甲，同时仍然允许玩家一次到处跑。

我的大部分问题是这对我来说是新事物。我了解线程的*概念*，但我可以看到一些严重的问题，例如如果两个线程尝试同时读取/写入相同的内存地址会发生什么，等等。我知道已经有方法来处理这种排序的事情，所以我正在寻找有关实施此类事情的最佳方式的建议。基本上，我需要线程 A 能够通过发送数据块启动线程 B 中的进程，轮询线程 B 的状态，然后接收回复，也作为数据块，理想情况下不会发生任何重大崩溃。^_^ 稍后我会担心这些数据实际包含什么以及如何处理丢弃的数据包等，我只需要先让这些发生。

感谢您提供任何帮助/建议。

PS：刚刚想到这个，可能会使问题更简单。有没有办法使用 Windows 事件处理系统对我有利？比如，是否有可能让线程 A 在某处初始化数据，然后在线程 B 中触发一个事件以让它获取数据，反之亦然，让线程 B 告诉线程 A 它已经完成？这可能会解决我的很多问题，因为我真的不需要两个线程都能够同时处理数据，更多的是接力棒。我只是不知道这是否可能在两个不同的线程之间。（我知道一个线程可以为事件处理程序创建自己的消息。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T06:34:58.913

**最简单的事**

对你来说，只需调用 Windows API **QueueUserWorkItem**。您只需指定线程将执行的函数以及传递给它的输入。将自动为您创建一个线程池并在其中执行作业。将在需要时创建新线程。

[http://msdn.microsoft.com/en-us/library/ms684957(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms684957(VS.85).aspx)

**更多控制**

您可以使用另一组 API 进行更详细的控制，这些 API 可以再次为您管理线程池 -

[http://msdn.microsoft.com/en-us/library/ms686980(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms686980(VS.85).aspx)

**自己做**

如果你想控制你的线程创建和池管理的所有方面，你必须自己创建线程，决定它们应该如何结束，创建多少等（beginthreadex 是你应该用来创建线程的 api。如果你使用 MFC 你应该使用 AfxBeginThread 函数）。

**将作业发送到工作线程 - Io 完成端口**

在这种情况下，您还必须担心如何传达您的工作 - 我建议 IoCOmpletionPorts 这样做。这是我目前所知道的为此目的而设计的最具可扩展性的通知机制。它还有一个额外的优势，它是在内核中实现的，因此您可以避免在决定自己处理某些事情时遇到的各种死锁情况。

本文将向您展示如何使用代码示例 -

[http://blogs.msdn.com/larryosterman/archive/2004/03/29/101329.aspx](http://blogs.msdn.com/larryosterman/archive/2004/03/29/101329.aspx)

**回通信 - Windows 消息**

您可以使用 Windows 消息将状态传达回您的父线程，因为它无论如何都在等待消息。使用 PostMessage 函数来执行此操作。（并检查错误）

ps：您也可以将需要发送的数据分配到一个专用指针上，然后工作线程可以在发送后负责将其删除。这样您也可以避免返回指针流量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T05:33:29.513

BlodBath 对非阻塞套接字的建议可能是正确的方法。

如果您试图避免使用多线程方法，那么您可以研究在套接字上设置重叠 I/O 的使用。当您进行传输或接收时，它们不会阻塞，但有额外的好处，让您可以选择在单个事件循环中等待多个事件。当您的传输完成后，您将收到一个事件。（有关详细信息，请参阅[此](http://support.microsoft.com/kb/181611)）

这与多线程方法并非不兼容，因此可以选择稍后改变主意。;-)

关于多线程应用程序的设计。最好的办法是计算出所有你想要提醒的外部活动。例如，到目前为止，在您的问题中，您已经列出了网络传输、网络接收和用户活动。根据您将要处理的并发连接的数量，您可能会发现在概念上每个套接字都有一个线程（假设套接字数量很少）在概念上更简单，其中每个线程负责该套接字的所有处理.

然后你可以按照 RC 的建议在你的线程之间实现某种形式的消息传递系统。安排您的系统，以便在将消息发送到特定线程时也发送事件。然后可以将您的线程发送到睡眠状态，等待其中一个事件。（以及任何其他刺激——如套接字事件、用户事件等）

您非常正确，您需要小心多个线程试图访问同一块内存的情况。互斥量和信号量是在那里使用的东西。

还要注意您的 gui 在多线程方面的限制。可以[在这个问题](https://stackoverflow.com/questions/120636/best-practice-regarding-number-of-threads-in-gui-applications)中找到有关该主题的一些讨论。但简化版是大多数（Windows 就是其中之一）GUI 不允许多个线程同时执行 GUI 操作。要解决这个问题，您可以在应用程序中使用消息泵，通过将自定义消息发送到您的 gui 线程以*使其*执行 gui 操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T02:56:37.317

我建议查看非阻塞套接字以进行快速修复。使用非阻塞套接字 send() 和 recv() 不会阻塞，并且使用 select() 函数可以在每一帧中获取任何等待数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T03:03:54.257

将其视为[生产者-消费者问题](http://en.wikipedia.org/wiki/Producer-consumer_problem)：接收时，您的网络通信线程是生产者，而 UI 线程是消费者。发送时，正好相反。实现一个简单的缓冲区类，它为您提供 push 和 pop 等方法（pop 对于网络线程应该是阻塞的，而对于 UI 线程应该是非阻塞的）。

与其使用 Windows 事件系统，我更喜欢更便携的东西，例如[Boost condition variables](http://www.boost.org/doc/libs/1_36_0/doc/html/thread/synchronization.html#thread.synchronization.condvar_ref)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T04:54:04.383

我不编写游戏代码，但我使用了类似于 pukku 建议的系统。如果您有这样的需要，它非常适合做一些事情，比如让缓冲区优先处理要处理的消息。

我认为它们是每个线程的邮箱。你想发送一个数据包？让 ProcessThread 创建一个带有有效负载的“线程消息”以通过网络传输并将其“发送”到 NetworkThread（即，将其推送到 NetworkThread 的队列/邮箱中并发送 NetworkThread 的条件变量信号，以便他醒来并把它拉下来）。当 NetworkThread 收到响应后，将其打包成一个线程消息，并以同样的方式发送回 ProcessThread。不同之处在于 ProcessThread 不会在条件变量上被阻塞，只是在您想要检查响应时轮询mailbox.empty()。

您可能希望直接推送和弹出，但对于较大的项目，更方便的方法是在 ThreadMsg 基类中实现 toThreadName、fromThreadName 方案，以及线程注册其邮箱的 Post Office。然后邮局有一个 send(ThreadMsg*); 根据 to 和 from 获取/推送消息到适当邮箱的函数。邮箱（缓冲区/队列类）包含 ThreadMsg* = receiveMessage()，基本上将其从底层队列中弹出。

根据你的需要，你可以让 ThreadMsg 包含一个虚函数 process(..)，它可以在派生类中被相应地覆盖，或者只是一个普通的 ThreadMessage 类，它有一个 to、from 成员和一个 getPayload() 函数来取回原始数据并直接在 ProcessThread 中处理。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T07:07:06.047

您可能感兴趣的一些主题：

*   **mutex**：互斥锁允许您仅锁定一个线程对特定资源的访问

*   **semaphore**: A way to determine how many users a certain resource still has (=how many threads are accessing it) and a way for threads to access a resource. A mutex is a special case of a semaphore.

*   **critical section**: a mutex-protected piece of code (street with only one lane) that can only be travelled by one thread at a time.

*   **message queue**: a way of distributing messages in a centralized queue

*   **inter-process communication (IPC)** - a way of threads and processes to communicate with each other through named pipes, shared memory and many other ways (it's more of a concept than a special technique)

All topics in bold print can be easily looked up on a search engine.

# python - Python 有位域类型吗？

> ID：142812
> 
> 赞同：54
> 
> 时间：2008-09-27T02:47:40.397
> 
> 标签：python, bit-fields, bitarray

我需要一个布尔数组的紧凑表示，Python 是否具有内置位域类型，或者我需要找到替代解决方案？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-14T06:02:45.523

如果您主要希望能够命名您的位字段并轻松操作它们，例如使用在通信协议中表示为单个位的标志，那么您可以使用[ctypes](http://docs.python.org/library/ctypes.html)的标准结构和联合功能，如[我如何做在 Python 中正确声明一个 ctype 结构 + 联合？- 堆栈溢出](https://stackoverflow.com/questions/10346375/how-do-i-properly-declare-a-ctype-structure-union-in-python)

例如，要单独处理一个字节的 4 个最低有效位，只需在 LittleEndianStructure 中从最低有效位到最高有效位命名它们。您使用联合来提供对与字节或整数相同的数据的访问，以便您可以将数据移入或移出通信协议。在这种情况下，这是通过`flags.asbyte`字段完成的：

```
import ctypes
c_uint8 = ctypes.c_uint8

class Flags_bits(ctypes.LittleEndianStructure):
    _fields_ = [
            ("logout", c_uint8, 1),
            ("userswitch", c_uint8, 1),
            ("suspend", c_uint8, 1),
            ("idle", c_uint8, 1),
        ]

class Flags(ctypes.Union):
    _fields_ = [("b", Flags_bits),
                ("asbyte", c_uint8)]

flags = Flags()
flags.asbyte = 0xc

print(flags.b.idle)
print(flags.b.suspend)
print(flags.b.userswitch)
print(flags.b.logout) 
```

四位（我在这里打印的最重要的开始，打印时看起来更自然）是1、1、0、0，即二进制的0xc。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-09-27T08:20:43.577

当我最近有类似的需求时，[Bitarray是我找到的最佳答案。](http://pypi.python.org/pypi/bitarray/)它是一个 C 扩展（比纯 Python 的 BitVector 快得多），并将其数据存储在一个实际的位域中（因此它的内存效率是 numpy 布尔数组的八倍，它似乎每个元素使用一个字节。）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-10-15T20:43:54.270

您应该看一下最近达到 2.0 版的[bitstring模块。](https://pypi.python.org/pypi/bitstring/)二进制数据紧凑地存储为字节数组，可以轻松创建、修改和分析。

您可以`BitString`从二进制、八进制、十六进制、整数（大端或小端）、字符串、字节、浮点数、文件等创建对象。

```
a = BitString('0xed44')
b = BitString('0b11010010')
c = BitString(int=100, length=14)
d = BitString('uintle:16=55, 0b110, 0o34')
e = BitString(bytes='hello')
f = pack('<2H, bin:3', 5, 17, '001') 
```

然后，您可以使用简单的函数或切片符号来分析和修改它们 - 无需担心位掩码等。

```
a.prepend('0b110')
if '0b11' in b:
    c.reverse()
g = a.join([b, d, e])
g.replace('0b101', '0x3400ee1')
if g[14]:
    del g[14:17]
else:
    g[55:58] = 'uint:11=33, int:9=-1' 
```

还有一个位位置的概念，因此如果对您有用，您可以将其视为文件或流。属性用于对位数据给出不同的解释。

```
w = g.read(10).uint
x, y, z = g.readlist('int:4, int:4, hex:32')
if g.peek(8) == '0x00':
    g.pos += 10 
```

此外，还支持标准的按位二进制运算符、打包、解包、字节序等。最新版本适用于 Python 2.7 和 3.x，虽然它是纯 Python，但它在内存和速度方面进行了相当好的优化。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-05T15:30:33.933

将您的每个值表示为 2 的幂：

```
testA = 2**0
testB = 2**1
testC = 2**3 
```

然后将值设置为 true：

```
table = table | testB 
```

将值设置为 false：

```
table = table & (~testC) 
```

要测试一个值：

```
bitfield_length = 0xff
if ((table & testB & bitfield_length) != 0):
    print "Field B set" 
```

如果这对您没有意义，请深入研究十六进制表示。这基本上也是您在嵌入式 C 应用程序中跟踪布尔标志的方式（如果您的内存有限）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-27T13:26:06.400

我使用二进制位运算符！、&、|、^、>> 和 <<。它们工作得非常好，直接在底层 C 中实现，通常直接在底层硬件上。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-27T03:03:16.880

BitVector 包可能是您需要的。它没有内置在我的 python 安装中，但很容易在 python 站点上找到。

[当前版本的https://pypi.python.org/pypi/BitVector](https://pypi.python.org/pypi/BitVector)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-27T02:52:13.740

NumPy 有一个[数组接口](http://numpy.scipy.org/array_interface.shtml)模块，您可以使用它来制作位域。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-27T08:41:05.383

如果你的位域很短，你可以使用[struct module](http://docs.python.org/lib/module-struct.html)。[否则，我建议在数组模块](http://docs.python.org/lib/module-array.html)周围使用某种包装器。

此外， ctypes 模块确实包含[bitfields](http://docs.python.org/lib/ctypes-bit-fields-in-structures-unions.html)，但我自己从未使用过它。*买者自负*。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-16T21:01:07.227

如果您想使用整数（或长整数）表示为布尔数组（或整数集），请查看 [http://sourceforge.net/projects/pybitop/files/](http://sourceforge.net/projects/pybitop/files/)

它提供将位域插入/提取到长整数中；找到最重要或最不重要的“1”位；计算所有的 1；位反转；类似的东西在纯 python 中都是可能的，但在 C 中要快得多。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-12-01T14:48:44.820

我需要一个最小的、内存高效的位域，没有外部依赖，这里是：

```
import math

class Bitfield:
    def __init__(self, size):
        self.bytes = bytearray(math.ceil(size / 8))

    def __getitem__(self, idx):
        return self.bytes[idx // 8] >> (idx % 8) & 1

    def __setitem__(self, idx, value):
        mask = 1 << (idx % 8)
        if value:
            self.bytes[idx // 8] |= mask
        else:
            self.bytes[idx // 8] &= ~mask 
```

采用：

```
# if size is not a multiple of 8, actual size will be the next multiple of 8
bf = Bitfield(1000)
bf[432] # 0
bf[432] = 1
bf[432] # 1 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-12-30T21:45:38.393

对于大多数连续位，有[https://pypi.org/project/range_set/](https://pypi.org/project/range_set/)模块，它与 Python 的内置 API 兼容`set`。顾名思义，它将位存储为开始/结束对。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-28T11:24:09.913

我必须处理通信协议中的一些控制字/标志，我的重点是编辑器给我关于标志名称的建议，并用“F3”跳转到标志的定义。下面的代码满足了这些要求（不幸的是，@nealmcb 的 ctypes 解决方案今天不支持 PyCharm 索引器。）。欢迎提出建议：

```
""" The following bit-manipulation methods are written to take a tuple as input, which is provided by the Bitfield class. The construct 
looks weired, however the call to a setBit() looks ok and the editor (PyCharm) suggests all 
possible bit names. I did not find a more elegant solution that calls the setBit()-function and needs 
only one argument.
Example call:
    setBit( STW1.bm01NoOff2() ) """

def setBit(TupleBitField_BitMask):
    # word = word | bit_mask
    TupleBitField_BitMask[0].word = TupleBitField_BitMask[0].word | TupleBitField_BitMask[1]

def isBit(TupleBitField_BitMask):
    # (word & bit_mask) != 0
    return (TupleBitField_BitMask[0].word & TupleBitField_BitMask[1]) !=0

def clrBit(TupleBitField_BitMask):
    #word = word & (~ BitMask)
    TupleBitField_BitMask[0].word = TupleBitField_BitMask[0].word & (~ TupleBitField_BitMask[1])

def toggleBit(TupleBitField_BitMask):
    #word = word ^ BitMask
    TupleBitField_BitMask[0].word = TupleBitField_BitMask[0].word ^ TupleBitField_BitMask[1]

""" Create a Bitfield type for each control word of the application. (e.g. 16bit length). 
Assign a name for each bit in order that the editor (e.g. PyCharm) suggests the names from outside. 
The bits are defined as methods that return the corresponding bit mask in order that the bit masks are read-only
and will not be corrupted by chance.
The return of each "bit"-function is a tuple (handle to bitfield, bit_mask) in order that they can be 
sent as arguments to the single bit manipulation functions (see above): isBit(), setBit(), clrBit(), toggleBit()
The complete word of the Bitfield is accessed from outside by xxx.word.
Examples:
    STW1 = STW1Type(0x1234) # instanciates and inits the bitfield STW1, STW1.word = 0x1234
    setBit(STW1.bm00() )    # set the bit with the name bm00(), e.g. bm00 = bitmask 0x0001
    print("STW1.word =", hex(STW1.word))
"""
class STW1Type():
    # assign names to the bit masks for each bit (these names will be suggested by PyCharm)
    #    tip: copy the application's manual description here
    def __init__(self, word):
        # word = initial value, e.g. 0x0000
        self.word = word

    # define all bits here and copy the description of each bit from the application manual. Then you can jump
    #    to this explanation with "F3"
    #    return the handle to the bitfield and the BitMask of the bit.
    def bm00NoOff1_MeansON(self):
        # 0001 0/1= ON (edge)(pulses can be enabled)
        #        0 = OFF1 (braking with ramp-function generator, then pulse suppression & ready for switching on)
        return self, 0x0001

    def bm01NoOff2(self):
        # 0002  1 = No OFF2 (enable is possible)
        #       0 = OFF2 (immediate pulse suppression and switching on inhibited)
        return self, 0x0002

    def bm02NoOff3(self):
        # 0004  1 = No OFF3 (enable possible)
        #       0 = OFF3 (braking with the OFF3 ramp p1135, then pulse suppression and switching on inhibited)
        return self, 0x0004

    def bm03EnableOperation(self):
        # 0008  1 = Enable operation (pulses can be enabled)
        #       0 = Inhibit operation (suppress pulses)
        return self, 0x0008

    def bm04RampGenEnable(self):
        # 0010  1 = Hochlaufgeber freigeben (the ramp-function generator can be enabled)
        #       0 = Inhibit ramp-function generator (set the ramp-function generator output to zero)
        return self, 0x0010

    def b05RampGenContinue(self):
        # 0020  1 = Continue ramp-function generator
        #       0 = Freeze ramp-function generator (freeze the ramp-function generator output)
        return self, 0x0020

    def b06RampGenEnable(self):
        # 0040  1 = Enable speed setpoint; Drehzahlsollwert freigeben
        #       0 = Inhibit setpoint; Drehzahlsollwert sperren (set the ramp-function generator input to zero)
        return self, 0x0040

    def b07AcknowledgeFaults(self):
        # 0080 0/1= 1\. Acknowledge faults; 1\. Quittieren Störung
        return self, 0x0080

    def b08Reserved(self):
        # 0100 Reserved
        return self, 0x0100

    def b09Reserved(self):
        # 0200 Reserved
        return self, 0x0200

    def b10ControlByPLC(self):
        # 0400  1 = Control by PLC; Führung durch PLC
        return self, 0x0400

    def b11SetpointInversion(self):
        # 0800  1 = Setpoint inversion; Sollwert Invertierung
        return self, 0x0800

    def b12Reserved(self):
        # 1000 Reserved
        return self, 0x1000

    def b13MotorPotiSPRaise(self):
        # 2000 1 = Motorized potentiometer setpoint raise; (Motorpotenziometer Sollwert höher)
        return self, 0x2000

    def b14MotorPotiSPLower(self):
        # 4000 1 = Motorized potentiometer setpoint lower; (Motorpotenziometer Sollwert tiefer)
        return self, 0x4000

    def b15Reserved(self):
        # 8000 Reserved
        return self, 0x8000

""" test the constrution and methods """
STW1 = STW1Type(0xffff)
print("STW1.word                =", hex(STW1.word))

clrBit(STW1.bm00NoOff1_MeansON())
print("STW1.word                =", hex(STW1.word))

STW1.word = 0x1234
print("STW1.word                =", hex(STW1.word))

setBit( STW1.bm00NoOff1_MeansON() )
print("STW1.word                =", hex(STW1.word))

clrBit( STW1.bm00NoOff1_MeansON() )
print("STW1.word                =", hex(STW1.word))

toggleBit(STW1.bm03EnableOperation())
print("STW1.word                =", hex(STW1.word))

toggleBit(STW1.bm03EnableOperation())
print("STW1.word                =", hex(STW1.word))

print("STW1.bm00ON              =", isBit(STW1.bm00NoOff1_MeansON() ) )
print("STW1.bm04                =", isBit(STW1.bm04RampGenEnable()  ) ) 
```

它打印出来：

```
STW1.word                = 0xffff
STW1.word                = 0xfffe
STW1.word                = 0x1234
STW1.word                = 0x1235
STW1.word                = 0x1234
STW1.word                = 0x123c
STW1.word                = 0x1234
STW1.bm00ON              = False
STW1.bm04                = True 
```

# c# - 如何在 C# 中将 12 位整数转换为十六进制字符串？

> ID：142813
> 
> 赞同：1
> 
> 时间：2008-09-27T02:48:15.870
> 
> 标签：c#

我想将 0 到 4096（12 位）之间的数字转换为 C# 中的 3 个字符的十六进制字符串表示形式。

例子：

```
2748 到“ABC”

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T02:52:06.843

尝试

```
2748.ToString("X") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T11:53:48.540

如果您需要 3 个字符并且确定该数字在范围内，请使用：

```
i.ToString("X3") 
```

如果您不确定该数字是否在范围内，这将为您提供 3 位以上的数字。您可以执行以下操作：

```
(i % 0x1000).ToString("X3") 
```

如果需要小写字母，请使用小写“x3”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T02:53:01.583

注意：这假设您使用的是自定义的 12 位表示。如果您只是使用 int/uint，那么 Muxa 的解决方案是最好的。

每四位对应一个十六进制数字。

因此，只需将前四位数字匹配到一个字母，然后 >> 4 输入，然后重复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T02:56:25.790

简单的 C 解决方案可能具有适应性：

```
char hexCharacters[17] = "0123456789ABCDEF";
void toHex(char * outputString, long input)
{
   outputString[0] = hexCharacters[(input >> 8) & 0x0F];
   outputString[1] = hexCharacters[(input >> 4) & 0x0F];
   outputString[2] = hexCharacters[input & 0x0F];
} 
```

您也可以在循环中执行此操作，但这非常简单，并且循环仅对三个转换具有相当高的开销。

不过，我希望 C# 具有某种类型的库函数来处理这类事情。您甚至可以在 C 中使用 sprintf，而且我确信 C# 具有与此功能类似的功能。

-亚当

# xna - 如何开始在 Zune 上进行游戏编程

> ID：142816
> 
> 赞同：6
> 
> 时间：2008-09-27T02:51:22.073
> 
> 标签：xna, zune, xna-3.0

我的 zune 刚刚更新到 3.0（甚至没有意识到他们正在发布新的东西！）并且更新附带了两个游戏，但 Zune 市场没有游戏。

我从哪里开始，Zune 在游戏/应用方面的功能是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-27T03:01:31.860

那么，首先，您必须下载 Microsoft XNA 3.0 CTP。阅读文档，其中将解释这些功能。但是，凭记忆：

*   没有硬件加速的 3d（显然，您可以创建一个软件 3d 引擎，然后将结果渲染为 2d 精灵，但是......不要对性能有太多期望；））
*   没有 XACT，您必须使用新的声音 API

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T17:46:10.810

只是一个更新，但请注意 XNA 3.0 已经[发布](http://www.microsoft.com/downloads/details.aspx?familyid=7d70d6ed-1edd-4852-9883-9a33c0ad8fee&displaylang=en)。它需要一些 Visual Studio 2008 的风格。

我下载了它并立即将“hello world”编码并部署到我的 Zune。好简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T12:18:43.847

您应该查看[Rob Miles](http://www.robmiles.com/xna-book/)的博客。他的网站上有几章他的书。开始的好地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T03:01:45.073

我希望这里的某个人会有更好的资源，但由于这似乎是一个新的开发领域，[这里有一个资源](http://blog.paranoidferret.com/index.php/2008/09/19/zune-game-development-getting-started/)似乎为新手提供了入门的所有步骤（太多假设您已经拥有 Visual Studio 等） .

不过，我真的对更深入地了解这些功能很感兴趣。

-亚当

# c# - 用户控制事件的设计时查看

> ID：142820
> 
> 赞同：15
> 
> 时间：2008-09-27T02:52:10.057
> 
> 标签：c#, winforms, user-controls

我创建了一个从 System.Windows.Forms.UserControl 继承的 WinForms 控件...我在控件上有一些自定义事件，我希望我的控件的使用者能够看到这些事件。在设计期间，我实际上无法让我的事件显示在“属性”窗口的“事件”选项卡中。这意味着分配事件的唯一方法是以编程方式编写

```
myUserControl.MyCustomEvent += new MyUserControl.MyCustomEventHandler(EventHandlerFunction); 
```

我猜这对我来说很好，但是当其他人来使用我的 UserControl 时，他们不会知道这些事件的存在（除非他们阅读了库 doco ......是的）。我知道该事件将使用 Intellisense 显示，但如果它也可以显示在属性窗口中，那就太好了。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-27T02:53:05.640

确保您的活动公开。例如...

```
[Browsable(true)]
public event EventHandler MyCustomEvent; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-12T15:54:01.850

使用委托的解决方案。例如，我用于处理项目添加事件的自定义 ListView：声明您的委托：

```
 public delegate void ItemAddedHandler(object sender, ItemEventArgs e) 
```

然后声明使用委托的事件：

```
 [Browsable(true)]
   public event ItemAddedHandler ItemAdded; 
```

注意：ItemEventArgs 是一个自定义 EventArgs

希望可以帮助你，对我来说很好

# c# - 有没有办法无限期地暂停一个线程？

> ID：142826
> 
> 赞同：34
> 
> 时间：2008-09-27T02:54:38.600
> 
> 标签：c#, .net, multithreading

我在空闲时间一直在开发一个网络爬虫 .NET 应用程序，我想包含的这个应用程序的功能之一是暂停按钮，用于暂停特定线程。

我对多线程比较陌生，我还没有找到一种方法来无限期地暂停当前支持的线程。我不记得确切的类/方法，但我知道有一种方法可以做到这一点，但它已被 .NET 框架标记为已过时。

有没有什么好的通用方法可以无限期地暂停 C# .NET 中的工作线程。

最近我没有太多时间来开发这个应用程序，我最后一次接触它是在 .NET 2.0 框架中。我对 .NET 3.5 框架中存在的任何新功能（如果有的话）持开放态度，但我想知道也适用于 2.0 框架的解决方案，因为这是我在工作中使用的，它会很好知道以防万一。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-09-27T06:54:33.907

永远，永远使用`Thread.Suspend`. 它的主要问题是 99% 的情况下，当您挂起该线程时，您不知道该线程在做什么。如果该线程持有锁，则更容易陷入死锁情况等。请记住，您正在调用的代码可能在幕后获取/释放锁。Win32 也有类似的 API：`SuspendThread`和`ResumeThread`. 以下文档`SuspendThread`很好地总结了 API 的危险：

[http://msdn.microsoft.com/en-us/library/ms686345(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms686345(VS.85).aspx)

> 这个函数主要是为调试器设计的。它不打算用于线程同步。如果调用线程试图获取挂起线程拥有的同步对象，则在拥有同步对象（例如互斥锁或临界区）的线程上调用 SuspendThread 可能会导致死锁。为避免这种情况，应用程序中不是调试器的线程应向其他线程发出信号以暂停自身。目标线程必须设计为监视此信号并做出适当的响应。

无限期挂起线程的正确方法是使用`ManualResetEvent`. 该线程很可能正在循环，执行一些工作。暂停线程的最简单方法是让线程在每次迭代时“检查”事件，如下所示：

```
while (true)
{
    _suspendEvent.WaitOne(Timeout.Infinite);

    // Do some work...
} 
```

您指定无限超时，因此当事件未发出信号时，线程将无限期阻塞，直到事件发出信号，此时线程将从中断处恢复。

您将像这样创建事件：

```
ManualResetEvent _suspendEvent = new ManualResetEvent(true); 
```

该`true`参数告诉事件以信号状态开始。

当您想暂停线程时，请执行以下操作：

```
_suspendEvent.Reset(); 
```

并恢复线程：

```
_suspendEvent.Set(); 
```

您可以使用类似的机制来通知线程退出并等待这两个事件，检测哪个事件已发出信号。

只是为了好玩，我将提供一个完整的示例：

```
public class Worker
{
    ManualResetEvent _shutdownEvent = new ManualResetEvent(false);
    ManualResetEvent _pauseEvent = new ManualResetEvent(true);
    Thread _thread;

    public Worker() { }

    public void Start()
    {
        _thread = new Thread(DoWork);
        _thread.Start();
    }

    public void Pause()
    {
        _pauseEvent.Reset();
    }

    public void Resume()
    {
        _pauseEvent.Set();
    }

    public void Stop()
    {
        // Signal the shutdown event
        _shutdownEvent.Set();

        // Make sure to resume any paused threads
        _pauseEvent.Set();

        // Wait for the thread to exit
        _thread.Join();
    }

    public void DoWork()
    {
        while (true)
        {
            _pauseEvent.WaitOne(Timeout.Infinite);

            if (_shutdownEvent.WaitOne(0))
                break;

            // Do the work here..
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-27T02:59:53.487

C#电子书中的[Threading](http://www.albahari.com/threading/part4.aspx#_Suspending_and_Resuming)总结了Thread.Suspend和Thread.Resume：

> 已弃用的 Suspend 和 Resume 方法有两种模式——危险和无用！

本书推荐使用诸如[AutoResetEvent](http://www.albahari.com/threading/part2.aspx#_AutoResetEvent)或[Monitor.Wait](http://www.albahari.com/threading/part4.aspx#_Wait_and_Pulse)之类的同步构造来执行线程挂起和恢复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-04T10:50:38.267

如果没有同步要求：

`Thread.Sleep(Timeout.Infinite);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T00:23:47.943

我刚刚实现了一个`LoopingThread`循环传递给构造函数的动作的类。它基于布兰农的帖子。我在, 和一个属性中添加了一些其他的东西`WaitForPause()`，它表示在下一次循环之前应该等待的时间。`WaitForStop()``TimeBetween`

我还决定将 while 循环更改为 do-while 循环。这将为我们提供一个连续的`Start()`和的确定性行为`Pause()`。我的意思是确定性，该操作在命令后至少执行一次`Start()`。在 Brannon 的实现中，情况可能并非如此。

*我省略了一些事情的根源。诸如“检查线程是否已经启动”或`IDisposable`模式之类的东西。*

```
public class LoopingThread
{
  private readonly Action _loopedAction;
  private readonly AutoResetEvent _pauseEvent;
  private readonly AutoResetEvent _resumeEvent;
  private readonly AutoResetEvent _stopEvent;
  private readonly AutoResetEvent _waitEvent;

  private readonly Thread _thread;

  public LoopingThread (Action loopedAction)
  {
    _loopedAction = loopedAction;
    _thread = new Thread (Loop);
    _pauseEvent = new AutoResetEvent (false);
    _resumeEvent = new AutoResetEvent (false);
    _stopEvent = new AutoResetEvent (false);
    _waitEvent = new AutoResetEvent (false);
  }

  public void Start ()
  {
    _thread.Start();
  }

  public void Pause (int timeout = 0)
  {
    _pauseEvent.Set();
    _waitEvent.WaitOne (timeout);
  }

  public void Resume ()
  {
    _resumeEvent.Set ();
  }

  public void Stop (int timeout = 0)
  {
    _stopEvent.Set();
    _resumeEvent.Set();
    _thread.Join (timeout);
  }

  public void WaitForPause ()
  {
    Pause (Timeout.Infinite);
  }

  public void WaitForStop ()
  {
    Stop (Timeout.Infinite);
  }

  public int PauseBetween { get; set; }

  private void Loop ()
  {
    do
    {
      _loopedAction ();

      if (_pauseEvent.WaitOne (PauseBetween))
      {
        _waitEvent.Set ();
        _resumeEvent.WaitOne (Timeout.Infinite);
      }
    } while (!_stopEvent.WaitOne (0));
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T10:08:28.357

除了上面的建议，我想补充一点。在某些情况下，使用 BackgroundWorker 可以简化您的代码（尤其是当您使用匿名方法来定义 DoWork 和它的其他事件时）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T02:02:21.450

与其他人所说的一致 - 不要这样做。你真正想做的是“暂停工作”，让你的线程自由漫游。您能否向我们提供有关您要暂停的线程的更多详细信息？如果你没有启动线程，你绝对不应该考虑暂停它——它不是你的。如果它是您的线程，那么我建议您不要暂停它，而是让它坐下来，等待更多的工作去做。布兰农在他的回复中对这个选项有一些很好的建议。或者，让它结束；并在需要时启动一个新的。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-01-12T14:03:43.630

Suspend() 和 Resume() 可能会被贬低，但它们绝不是无用的。例如，如果您有一个线程在修改数据进行长时间的工作，而用户希望停止它，则他单击一个按钮。当然，您需要请求验证，但同时您不希望该线程继续更改数据，如果用户决定他真的想中止。在等待用户单击确认对话框中的“是”或“否”按钮时暂停线程是防止它更改数据的*唯一方法，然后再发出允许它停止的指定中止事件。*事件对于具有一个循环的简单线程可能很好，但是具有复杂处理的复杂线程是另一个问题。当然，Suspend() 绝*不能*用于同步，因为它的用处不适用于此功能。

只是我的观点。

# coding-style - 关于评论代码，您有哪些“硬性规定”？

> ID：142830
> 
> 赞同：10
> 
> 时间：2008-09-27T02:58:29.543
> 
> 标签：coding-style, comments

我已经看过其他问题*，但我仍然对涵盖该主题的方式不满意*。

**我想在代码检查中提取一个精简的列表来检查注释。**

我相信人们会说一些只会互相抵消的话。但是，嘿，也许我们可以为每个营地建立一个清单。对于那些根本不发表评论的人来说，这份名单会很短:)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-27T03:19:22.177

关于评论，我有一个简单的规则：你的代码应该讲述你在做什么的故事；您的评论应该说明您为什么这样做。

这样，我确保任何继承我的代码的人都能够理解代码背后的意图。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-27T03:13:38.337

1.  我用元注释来评论公共或受保护的功能，如果我记得的话，通常会点击私有功能。
2.  我评论为什么存在任何足够复杂的代码块（判断调用）。*为什么*是重要的部分。
3.  如果我编写了我认为不是最佳的代码，我会发表评论，但我将其保留，因为我无法找到更聪明的方法，或者我知道我稍后会进行重构。
4.  我发表评论是为了提醒自己或其他人缺少功能或代码中不存在的即将到来的需求代码（TODO 等）。
5.  我评论以解释与类或代码块相关的复杂业务规则。众所周知，我写了几段以确保下一个人/女孩知道我为什么要写一百行课程。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-27T03:00:26.153

如果评论已过期（与代码不匹配），请将其删除或更新。永远不要留下不准确的评论。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-27T03:01:38.460

> 文档就像性；当它好时，它非常非常好，当它坏时，总比没有好

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-27T03:02:05.743

编写尽可能不言自明的可读代码。每当您必须编写过于复杂而无法一目了然的代码时，请添加注释。还要添加注释来描述您编写的代码背后的业务目的，以便将来更容易维护/重构它。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-27T03:11:04.270

你写的评论可以揭示你的代码质量。无数次我删除了代码中的注释，用更好、更清晰的代码替换它们。为此，我遵循一些反评论规则：

*   如果你的评论仅仅解释了一行代码，你应该让那行代码自己说话，或者把它分解成更简单的组件。
*   如果您的评论解释了函数中的一段代码，那么您可能应该解释一个新函数。

这些实际上是针对两种不同上下文重复的相同规则。

我遵循的其他更正常的规则是：

*   使用动态类型语言时，记录重要函数对其参数的期望，以及调用者对返回值的期望。重要的函数是那些将有非本地调用者的函数。
*   当您的逻辑由另一个组件的行为决定时，最好记录您对该组件的理解和期望是什么。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-27T03:04:30.183

在实现 RFC 或其他协议规范时，用它们对应的规范部分注释状态机/事件处理程序等。确保列出规范的版本或日期，以防以后修订。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-27T03:54:46.960

我通常在编写方法之前对其进行注释。我将为函数中需要执行的每个步骤写一两行注释，然后在注释之间编写代码。当我完成后，代码已经被注释了。

最重要的是，在我写代码*之前*，它已经被注释掉了，所以注释中没有对先前知识的不合理假设；我自己在编写代码时对我的代码一无所知。这意味着它们往往很容易理解，因为它们应该是。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-27T04:17:20.790

没有硬性规则——硬性规则会导致教条，当人们不够聪明而无法独立思考时，他们通常会遵循教条。

我遵循的**准则：**

1/ 注释说明正在做什么，代码说明它是如何完成的——不要重复你的努力。

2/ 注释应该指向代码块，而不是每一行。这包括解释整个文件、整个函数或只是一段复杂代码的注释。

3/ 如果我认为我会在一年后回来并且不理解代码/评论组合，那么我的评论还不够好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-27T03:05:44.127

我写了一篇关于不良评论的完整文章。享受 ：）

[糟糕的评论是如何在你的代码中产生的](http://littletutorials.com/2008/07/30/how-bad-comments-are-born-in-your-code/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-27T06:28:57.900

评论的一个很好的规则：如果你正在阅读代码试图找出一些东西，并且某处的评论会给你答案，*当你知道答案时把它放在那里*。

只花那时间调查*一次*。

最终，*当你写下*你需要留下指导的地方时，你会知道哪些地方足够明显，可以独立存在。在那之前，你会花时间浏览你的代码，试图找出你做某事的原因:)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-27T11:27:23.830

我专注于**为什么**。因为**什么**通常很容易阅读。TODO 也很棒，它们节省了很多时间。

我记录界面（例如文件格式）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-27T03:22:00.813

我记录了一个类中的每个类、每个函数、每个变量。简单的 DocBlocks 是前进的方向。

我通常会为自动化 API 文档编写这些 docblocks，而不是其他任何东西......

例如，我的一个 PHP 类的第一部分

```
/**
 * Class to clean variables
 *
 * @package     Majyk
 * @author      Martin Meredith <martin@sourceguru.net>
 * @licence     GPL (v2 or later)
 * @copyright   Copyright (c) 2008 Martin Meredith <martin@sourceguru.net>
 * @version     0.1
 */
class Majyk_Filter
{
    /**
     * Class Constants for Cleaning Types
     */
    const Integer            = 1;
    const PositiveInteger    = 2;
    const String             = 3;
    const NoHTML             = 4;
    const DBEscapeString     = 5;
    const NotNegativeInteger = 6;

    /**
     * Do the cleaning
     *
     * @param   integer Type of Cleaning (as defined by constants)
     * @param   mixed   Value to be cleaned
     *
     * @return  mixed   Cleaned Variable
     *
     */ 
```

但是，我有时也会记录重要的代码（来自我的 init.php

```
// Register the Auto-Loader
spl_autoload_register("majyk_autoload");

// Add an Exception Handler.
set_exception_handler(array('Majyk_ExceptionHandler', 'handle_exception'));

// Turn Errors into Exceptions
set_error_handler(array('Majyk_ExceptionHandler', 'error_to_exception'), E_ALL);

// Add the generic Auto-Loader to the auto-loader stack
spl_autoload_register("spl_autoload"); 
```

而且，如果它不能自我解释为什么某事以某种方式做某事，我会评论说

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-27T06:31:57.707

我留下评论的唯一有保证的地方：**TODO**部分。跟踪需要返工的东西的最佳位置就在代码中。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-27T06:51:52.853

我在代码的开头创建了一个注释块，列出了程序的用途、创建日期、任何许可证/版权信息（如 GPL）和版本历史。

如果导入的原因不明显，我经常评论我的导入，特别是如果整个程序似乎不需要导入。

我为每个类、方法或函数添加一个文档字符串，描述该块的用途以及我认为必要的任何其他信息。

我通常为相关的部分设置分界线，例如小部件创建、变量等。由于我在我的编程环境中使用 SPE，它会自动突出显示这些部分，使导航更容易。

我在编码时添加 TODO 注释作为提醒。这是提醒自己在验证代码正常工作后重构代码的好方法。

最后，我对可能需要澄清的个别行进行评论，或者在将来为我自己或其他程序员需要一些元数据。

就个人而言，我讨厌查看代码并试图弄清楚它应该做什么。如果有人可以写一个简单的句子来解释它，生活会更轻松。在我的书中，自我记录代码是用词不当。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-01T21:27:25.023

当您检查头文件（或任何您在方法声明之前调用的块）时要检查的一件非常重要的事情是指令和警告很容易发现。

指令是影响客户端的任何“执行”或“不执行”指令：不要从 UI 线程调用、不要在性能关键代码中使用、在 Y 之前调用 X、在使用后释放返回值等。

警告是任何可能令人讨厌的惊喜：剩余的行动项目、已知的假设和限制等。

当您专注于您正在编写和检查的方法时，您会看到一切。当一个程序员在一小时内使用你的方法和其他 30 个方法时，你不能指望彻底阅读。如果你有兴趣，我可以把这方面的研究数据发给你。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-27T03:16:49.937

仅前导码；说明班级的单一职责、任何注释或评论以及更改日志。至于方法，如果任何方法需要大量注释，是时候重构了。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-27T03:24:57.857

当你写评论时，停下来，反思一下，问问自己是否可以改变代码，这样评论就不需要了。您能否更改一些变量、类或方法名称以使事情更清晰？某些`assert`s 或其他错误检查是否会记录您的意图或期望？你能把一些长段代码拆分成明确命名的方法或函数吗？评论通常反映了我们无法清楚地编写（a-hem，代码）。用计算机语言写清楚并不总是那么容易，但需要一些时间来尝试......因为代码永远不会说谎。

PS您在“硬规则”周围使用引号的事实说明了这一点。未强制执行的规则不是“硬规则”，唯一强制执行的规则在代码中。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-27T04:34:03.590

我在一段代码中添加了 1 条评论，总结了我正在做的事情。这有助于寻找特定功能或代码部分的人。

我评论任何乍一看无法弄清楚的复杂算法或过程。

我签署我的代码。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-01T21:21:38.377

在我看来，TODO/TBD/FIXME 等在当前正在处理的代码中是可以的，但是当你看到 5 年内没有被触及的代码并且充满了它们时，你会意识到它是一个漂亮的确保事情得到解决的糟糕方法。简而言之，**评论中的 TODO 注释往往会留在那里**。如果您有需要在某个时候修复的东西，最好使用错误跟踪器。

Hudson（CI 服务器）有一个很棒的插件，它可以扫描 TODO 并记录你的代码中有多少。如果构建的数量过多，您甚至可以设置阈值导致构建被分类为不稳定。

关于评论，我最喜欢的经验法则是：**如果代码和评论不一致，那么两者都可能不正确**

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-11-17T22:06:05.443

我们在这里写了一篇关于评论的文章（实际上，我已经做过几篇了）：http: [//agileinaflash.blogspot.com/2009/04/rules-for-commenting.html](http://agileinaflash.blogspot.com/2009/04/rules-for-commenting.html)

这真的很简单：写注释是为了告诉你代码不能做什么。

这导致了一个简单的过程： - 首先写下您想要的任何评论。- 改进代码，使注释变得多余 - 删除现在多余的注释。- 只提交没有多余注释的代码

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-06-22T20:18:50.530

我正在写一篇 Medium 文章，我将在其中介绍这条规则：当您将更改提交到存储库时，每条评论必须是以下三种类型之一：

*   顶部的许可证标题
*   文档注释（例如，Javadoc），或
*   一条`TODO`评论。

最后一种类型不应该是永久性的。要么事情完成，`TODO`评论被删除，要么我们决定任务没有必要，`TODO`评论被删除。

# python - 在 Windows 资源管理器中拖放到 Python 脚本

> ID：142844
> 
> 赞同：59
> 
> 时间：2008-09-27T03:02:30.033
> 
> 标签：python, windows, drag-and-drop, windows-explorer

我想将我的数据文件拖放到 Python 脚本上，让它处理文件并生成输出。Python 脚本接受数据文件的名称作为命令行参数，但 Windows 资源管理器不允许该脚本成为放置目标。

这项工作是否需要在某处进行某种配置？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-09-27T03:06:25.640

当然。从[一篇名为“Make Python Scripts Droppable in Windows”的无脑技术文章中](http://mindlesstechnology.wordpress.com/2008/03/29/make-python-scripts-droppable-in-windows/)，您可以通过添加注册表项来添加放置处理程序：

> 这是您可以用来执行此操作的注册表导入文件。将以下内容复制到 .reg 文件中并运行它（确保您的 .py 扩展名映射到 Python.File）。
> 
> ```
> Windows Registry Editor Version 5.00
> 
> [HKEY_CLASSES_ROOT\Python.File\shellex\DropHandler]
> @="{60254CA5-953B-11CF-8C96-00AA00B8708C}" 
> ```

这使得 Python 脚本使用与长文件名兼容的 WSH 删除处理程序。要使用短文件名处理程序，请将 GUID 替换为`86C86720-42A0-1069-A2E8-08002B30309D`.

该帖子中的一条评论表明，可以通过使用和类启用删除“无控制台 Python 文件 ( `.pyw`)”或“已编译的 Python 文件 ( )”。`.pyc``Python.NoConFile``Python.CompiledFile`

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-04-20T12:21:36.480

编写一个简单的 shell 脚本 ( `file.bat`)

```
"C:\python27\python.exe" yourprogram.py %* 
```

where`%*`代表您传递给脚本的所有参数。

现在将您的目标文件拖放到`file.bat`图标上。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-08-10T15:04:26.917

使用已安装的 python - 至少 2.6.1 - 您可以将任何文件拖放到 python 脚本上。

```
import sys
droppedFile = sys.argv[1]
print droppedFile 
```

`sys.argv[0]`是脚本本身。`sys.argv[n+1]`是您删除的文件。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-20T02:47:21.920

尝试使用 py2exe。使用 py2exe 将您的 python 脚本转换为 Windows 可执行文件。然后，您应该能够将输入文件拖放到 Windows 资源管理器中的脚本中。您还应该能够在桌面上创建快捷方式并将输入文件拖放到上面。如果您的 python 脚本可以获取文件列表，您应该能够在脚本（或快捷方式）上拖放多个文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-17T22:23:58.620

创建文件的快捷方式。如果默认情况下没有 python 打开 .py 文件，请进入快捷方式的属性并编辑快捷方式的目标以包含您正在使用的 python 版本。例如：

目标：C:\Python26\python.exe <快捷目标路径>

我发布这个是因为我不想编辑注册表并且 .bat 解决方法对我不起作用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-12-03T02:29:16.137

1）。创建 .py
2) 的快捷方式。右键单击-> 属性
3）。将“目标：”与“python”作为前缀，因此它将 .py 作为参数运行到 python 命令
或
1)。创建一个 .bat
2)。python some.py %*

这些快捷方式版本对我来说是最简单的，
否则我会将其转换为 .exe，但宁愿只使用 java 或 c/c++

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-01-24T16:45:42.280

迟到的答案，但此页面上的所有答案都不适合我。
我设法使用以下方法启用/修复拖放到`.py`脚本上：

1.  `HKEY_CLASSES_ROOT\.py`-> 将默认值设置为`Python.File`

2.  `HKEY_CLASSES_ROOT\Python.File\Shell\Open`-> 创建一个`Command`使用默认值调用的键`"C:\Windows\py.exe" "%1" %*`

3.  `CLASSES_ROOT\Applications\py.exe\open\command`-> 如果不存在则创建键并将默认值设置为`"C:\Windows\py.exe" "%1" %*`

4.  `CLASSES_ROOT\Python.File\ShellEx`-> 创建`DropHandler`具有默认值的键`{86C86720-42A0-1069-A2E8-08002B30309D}`

就是这样。通过将文件拖到 python 脚本上来测试它：

```
import sys

args = sys.argv
print(args) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-03T07:59:56.963

对于那些在.py脚本中使用argv但仍然无法拖动文件执行的人，可以通过简单地*使用Python Launcher（带有火箭图标）来解决这个问题*

脚本属性“打开文件”设置为 python.exe，它不知道脚本需要命令行参数“%*”

参考：[https ://bugs.python.org/issue40253](https://bugs.python.org/issue40253)

# java - 使用 Quartz 工作线程拆分 log4j 输出

> ID：142845
> 
> 赞同：4
> 
> 时间：2008-09-27T03:02:57.303
> 
> 标签：java, multithreading, log4j, quartz-scheduler, scheduler

我正在开发一个应用程序，该应用程序由一个基于 Quartz 的整体调度程序和使用 CronTriggers 运行的“CycledJob”组成。该应用程序的目的是根据来源国家/地区处理来自不同电子邮件收件箱的输入。

根据它来自的国家（即美国、英国、法国等），应用程序会触发一个工作线程来运行每个国家的处理周期，因此会有一个英国工作线程，一个用于美国、法国等。将输出格式化为 log4j 时，我使用线程参数，因此它会发出 [ApplicationName_Worker-1]、[ApplicationName_Worker-2] 等。尽我所能，我找不到命名线程的方法，因为它们'重新从 Quartz 的线程池中退出。尽管我可能会扩展 Quartz，但我想制定一个不同的解决方案，而不是弄乱标准库。

问题出在：使用 log4j 时，我希望将所有日志项从美国线程输出到仅限美国的文件，对于每个国家线程也是如此。我不在乎他们是否留在一个统一的 ConsoleAppender 中，FileAppender 拆分就是我在这里所追求的。我已经知道如何指定多个文件附加程序等，我的问题是我无法根据国家/地区进行区分。应用程序中有 20 多个类可以在执行链上，其中很少有我想通过每个方法传递额外的“上下文”参数的知识来负担......我已经考虑过扩展一个策略模式log4j 包装类，但除非我可以让链中的每个类都知道它在哪个线程上来参数化记录器调用，否则这似乎是不可能的。

所以这里有一个问题：什么是建议的方法来允许应用程序中的许多从属类，每个从属类都用于每个不同的线程来处理输入，知道它们在记录时它们在特定国家线程的上下文中？

祝你好运，请提出澄清问题！我希望有人能够帮助我找到一个体面的方法来解决这个问题。欢迎所有建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T18:21:14.677

在每个国家的处理线程的顶部，将国家代码放入 Log4j 的映射诊断上下文 (MDC)。这使用 ThreadLocal 变量，因此您不必显式地在调用堆栈上上下传递国家。然后创建一个查看 MDC 的自定义过滤器，并过滤掉任何不包含当前 appender 国家代码的事件。

在你的`Job`：

```
...
public static final String MDC_COUNTRY = "com.y.foo.Country";
public void execute(JobExecutionContext context)
  /* Just guessing that you have the country in your JobContext. */
  MDC.put(MDC_COUNTRY, context.get(MDC_COUNTRY));
  try {
    /* Perform your job here. */
    ...
  } finally {
    MDC.remove(MDC_COUNTRY);
  }
}
... 
```

编写自定义[过滤器](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/spi/Filter.html)：

```
package com.y.log4j;

import org.apache.log4j.spi.LoggingEvent;

/**
 * This is a general purpose filter. If its "value" property is null, 
 * it requires only that the specified key be set in the MDC. If its 
 * value is not null, it further requires that the value in the MDC 
 * is equal.
 */
public final class ContextFilter extends org.apache.log4j.spi.Filter {

  public int decide(LoggingEvent event) {
    Object ctx = event.getMDC(key);
    if (value == null)
      return (ctx != null) ? NEUTRAL : DENY;
    else
      return value.equals(ctx) ? NEUTRAL : DENY;
  }

  private String key;
  private String value;

  public void setContextKey(String key) { this.key = key; }
  public String getContextKey() { return key; }
  public void setValue(String value) { this.value = value; }
  public String getValue() { return value; }

} 
```

在您的 log4j.xml 中：

```
<appender name="fr" class="org.apache.log4j.FileAppender">
  <param name="file" value="france.log"/>
  ...
  <filter class="com.y.log4j.ContextFilter">
    <param name="key" value="com.y.foo.Country" />
    <param name="value" value="fr" />
  </filter>
</appender> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T03:46:52.797

我希望我能比这更有帮助，但您可能想使用一些过滤器进行调查？也许您的日志记录可以输出国家代码，并且您可以根据它匹配您的过滤器？

StringMatchFilter 应该能够为您匹配它。

无法将以下地址作为链接正常工作，但如果您查看它，它会在使用过滤器的单独文件日志记录中包含一些内容。

[http://mail-archives.apache.org/mod_mbox/logging-log4j-user/200512.mbox/](http://mail-archives.apache.org/mod_mbox/logging-log4j-user/200512.mbox/) <1CC26C83B6E5AA49A9540FAC8D35158B01E2968E@pune.kaleconsultants.com > （只需删除 > 之前的空格）

[http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/spi/Filter.html](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/spi/Filter.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T04:48:59.497

根据我对您要完成的工作的理解，我可能完全不理解，但我会尝试解决方案。听起来您想要为您正在处理电子邮件的每个国家/地区创建一个单独的日志文件。基于这种理解，这是一个可能的解决方案：

1.  在您的 log4j 配置中为您希望单独登录的每个国家/地区设置一个 appender（提供美国示例）：

    log4j.appender.usfile=org.apache.log4j.FileAppender

    log4j.appender.usfile.File=us.log

    log4j.appender.usfile.layout=org.apache.log4j.PatternLayout

    log4j.appender.usfile.layout.ConversionPattern=%m%n

2.  为每个国家/地区创建一个记录器，并将它们中的每一个定向到适当的附加程序（提供美国示例）：

    log4j.logger.my-us-logger=debug,usfile

3.  在您的代码中，根据正在处理电子邮件的国家/地区创建您的 Logger：

    记录器 logger = Logger.getLogger("my-us-logger");

4.  确定如何为后续方法调用完成步骤 3。您可以在每个类/方法中重复第 3 步；或者您可以修改方法签名以接受 Logger 作为输入；或者您可以使用[ThreadLocal](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ThreadLocal.html)在方法之间传递 Logger。

额外信息：如果您不希望将日志语句发送到父记录器（例如 rootLogger），您可以将它们的可加性标志设置为 false（提供美国示例）：

```
log4j.additivity.my-us-logger=false 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T20:45:23.253

当您的工作开始设置 Thread 的名称时，为什么不直接调用 Thread.setName() 呢？如果出现访问问题，配置quartz使用自己的线程池。

# programming-languages - 哪些编程语言支持任意精度算术？

> ID：142855
> 
> 赞同：22
> 
> 时间：2008-09-27T03:07:57.447
> 
> 标签：programming-languages, bigdecimal, arbitrary-precision

哪些编程语言支持任意精度算术，你能举一个简短的例子来说明如何打印任意数量的数字吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-27T03:26:55.310

有些语言内置了这种支持。例如，看看Java中的[java.math.BigDecimal或 Python 中的](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html)[decimal.Decimal](http://www.python.org/doc/current/lib/module-decimal.html)。

其他语言通常有一个库可提供此功能。例如，在 C 中，您可以使用[GMP](http://gmplib.org/)或其他选项。

[本文](http://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic#Arbitrary-precision_software)的“任意精度软件”部分很好地概述了您的选择。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-02T00:18:27.623

数学。

```
N[Pi, 100]

3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068 
```

mathematica 不仅具有任意精度，而且默认情况下它具有无限精度。它将诸如 1/3 之类的东西保留为有理数，甚至包含诸如 Sqrt[2] 之类的表达式，它象征性地维护，直到您要求一个数字近似值，您可以拥有任意数量的小数位。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-27T03:21:31.640

在 Common Lisp 中，

```
(format t "~D~%" (expt 7 77)) 
```

printf 格式的“~D~%”将是“%d\n”。任意精度算术内置于 Common Lisp 中。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-11-12T12:50:48.497

Smalltalk 从一开始就支持任意精度的整数和分数。请注意，gnu Smalltalk 实现确实在后台使用了 GMP。我还在为各种方言（Squeak/Pharo Visualworks 和 Dolphin）开发 ArbitraryPrecisionFloat，请参阅[http://www.squeaksource.com/ArbitraryPrecisionFl.html](http://www.squeaksource.com/ArbitraryPrecisionFl.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-27T03:18:43.817

Python有这样的能力。[这里](http://en.literateprograms.org/Arbitrary-precision_elementary_mathematical_functions_%28Python%29)有一个很好的例子。

来自文章：

```
from math import log as _flog
from decimal import getcontext, Decimal

def log(x):
    if x < 0:
        return Decimal("NaN")
    if x == 0:
        return Decimal("-inf")
    getcontext().prec += 3
    eps = Decimal("10")**(-getcontext().prec+2)
    # A good initial estimate is needed
    r = Decimal(repr(_flog(float(x))))
    while 1:
        r2 = r - 1 + x/exp(r)
        if abs(r2-r) < eps:
            break
        else:
            r = r2
    getcontext().prec -= 3
    return +r 
```

此外，python 快速入门教程讨论了任意精度：[http ://docs.python.org/lib/decimal-tutorial.html](http://docs.python.org/lib/decimal-tutorial.html)

并描述getcontext：

> getcontext() 函数访问当前上下文并允许更改设置。

**编辑：**添加了关于 getcontext 的说明。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-27T03:38:46.233

许多人推荐 Python 的 decimal 模块，但我建议在任何严重的数字用途中使用[mpmath](http://code.google.com/p/mpmath/) over decimal。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-27T10:00:47.033

**COBOL**

```
77 VALUE PIC S9(4)V9(4). 
```

一个带符号的变量，有 4 位小数。

**PL/1**

```
DCL VALUE DEC FIXED (4,4); 
```

:-) 我不记得其他旧的东西了...

开个玩笑，正如我的示例所示，我认为您不应该根据单个功能选择编程语言。几乎*所有*体面的和最近的语言都支持某些专用类中的固定精度。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-10-25T08:09:11.230

在 PHP 中你有 BCMath。您不需要加载任何 dll 或编译任何模块。支持任意大小和精度的数字，以字符串表示

```
<?php

$a = '1.234';
$b = '5';

echo bcadd($a, $b);     // 6
echo bcadd($a, $b, 4);  // 6.2340

?> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-27T04:05:11.007

Scheme（lisp 的一种变体）具有称为“bignum”的功能。有许多好的方案实现可用，包括完整的语言环境和可嵌入的脚本选项。一些我可以保证的

MitScheme（也称为gnu scheme）PLTScheme Chezscheme Guile（也是gnu项目）Scheme 48

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-07-08T19:36:36.113

Ruby 整数和浮点数（从数学上讲：有理数）默认情况下与经典的 CPU 相关限制并不严格相关。在 Ruby 中，如果大小超过经典大小的最大值，整数和浮点数会自动、透明地切换到某些“bignum 类型”。

一个人可能想要使用一些经过合理优化和“完整”的、种类繁多的数学库，它使用“bignums”。这就是 Mathematica 类软件真正发挥其功能的地方。

截至 2011 年，Mathematica 非常昂贵，并且从黑客攻击和重新发布的角度来看受到严重限制，特别是如果想将数学软件作为小型、低价终端、Web 应用程序或开源项目的组件发布。如果只需要进行原始数字运算，不需要可视化，那么存在一种非常可行的替代 Mathematica 和 Maple 的方法。替代方案是 REDUCE 计算机代数系统，它基于 Lisp，开源且成熟（数十年），并且正在积极开发中（2011 年）。与 Mathematica 一样，REDUCE 使用符号计算。

为了对 Mathematica 的认可，我说截至 2011 年，在我看来 Mathematica 在交互式可视化方面是最好的，但我认为从编程的角度来看，即使 Mathematica 是一个开源项目，也有更方便的选择。在我看来，Mahtematica 似乎也有点慢，不适合处理庞大的数据集。在我看来，Mathematica 的利基是理论数学，而不是现实生活中的数字运算。另一方面，Mathematica 的出版商 Wolfram Research 正在托管和维护地球上最高质量的免费数学参考网站之一：[http://mathworld。 wolfram.com/](http://mathworld.wolfram.com/) Mathematica 附带的在线文档系统也非常好。

在谈到速度时，值得一提的是，据说 REDUCE 甚至可以在 Linux 路由器上运行。REDUCE 本身是用 Lisp 编写的，但它带有 2 个自己的、特定的 Lisp 实现。其中一个 Lisps 是用 Java 实现的，另一个是用 C 实现的。至少从数学的角度来看，它们都工作得很好。REDUCE 有 2 种模式：传统的“数学模式”和“程序员模式”，它允许通过自己编写的 REDUCE 语言完全访问所有内部结构：Lisp。

所以，我的观点是，如果看一下编写数学例程所需的工作量，更不用说在 REDUCE 中都成熟的所有符号计算，那么可以节省大量时间（几十年，字面意思）通过在REDUCE中完成大部分数学部分，特别是考虑到它已经过长时间的专业数学家的测试和调试，用于在旧时代的超级计算机上进行符号计算以完成真正的专业任务，并且工作得非常好，真的很快，在现代低端计算机上。它也没有在我身上崩溃，与至少一个我不想在这里命名的商业包不同。

[http://www.reduce-algebra.com/](http://www.reduce-algebra.com/)

为了说明，符号计算在实践中是必不可少的，我举了一个通过矩阵求逆求解线性方程组的例子。要反转矩阵，需要找到行列式。使用 CPU 直接支持的浮点类型进行的舍入可以将理论上具有逆矩阵的矩阵渲染为没有逆矩阵的矩阵。这反过来又引入了一种情况，在大多数情况下，软件可能工作得很好，但如果数据有点“不幸”，那么应用程序就会崩溃，尽管在算法上除了四舍五入之外软件没有任何问题浮点数。

绝对精度有理数确实有一个严重的限制。使用它们执行的计算越多，它们消耗的内存就越多。截至 2011 年，我不知道该问题的任何解决方案，除了小心并跟踪使用数字执行的操作数量，然后将数字四舍五入以节省内存，但必须在一个非常精确的计算阶段，以避免上述问题。如果可能，则应在计算的最后作为最后一次操作进行舍入。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-12-14T18:27:19.593

有几个 Javascript 库可以处理任意精度的算术。
例如，使用我的[big.js](https://github.com/MikeMcl/big.js)库：

```
Big.DP = 20;                      // Decimal Places
var pi = Big(355).div(113)    

console.log( pi.toString() );    // '3.14159292035398230088' 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-28T07:17:09.470

显然 Tcl 也有它们，从 8.5 版开始，由 LibTomMath 提供：

```
http://wiki.tcl.tk/5193
http://www.tcl.tk/cgi-bin/tct/tip/237.html
http://math.libtomcrypt.com/

```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-01-09T07:58:13.897

在 R 中，您可以使用[Rmpfr](https://cran.r-project.org/package=Rmpfr)包：

```
library(Rmpfr)
exp(mpfr(1, 120))
## 1 'mpfr' number of precision  120   bits 
## [1] 2.7182818284590452353602874713526624979 
```

您可以在此处找到小插图：[使用 R 进行任意准确计算：Rmpfr 包](https://cran.r-project.org/web/packages/Rmpfr/vignettes/Rmpfr-pkg.pdf)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-27T03:18:11.727

Java 本机可以使用 BigDecimal 进行 bignum 操作。[GMP](http://gmplib.org/)是使用 C/C++ 的 bignum 的事实上的标准库。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-27T09:47:19.263

如果您想在 .NET 世界中工作，您仍然可以使用 java.math.BigDecimal 类。只需添加对 vjslib 的引用（在框架中），然后您就可以使用 java 类。

最棒的是，它们可以用于任何 .NET 语言。例如在 C# 中：

```
 using java.math;

    namespace MyNamespace
    {
        class Program
        {
            static void Main(string[] args)
            {
                BigDecimal bd = new BigDecimal("12345678901234567890.1234567890123456789");

                Console.WriteLine(bd.ToString());
            }
        }
    } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-10-31T13:13:30.317

（免费）基本程序 x11 basic（[http://x11-basic.sourceforge.net/](http://x11-basic.sourceforge.net/)）对整数具有任意精度。（还有一些有用的命令，例如 nextprime(abcd...pqrs)）

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-04-07T08:33:10.210

IBM 的解释性脚本语言 Rexx 提供了带有数字的自定义精度设置。 [https://www.ibm.com/docs/en/zos/2.1.0?topic=instructions-numeric](https://www.ibm.com/docs/en/zos/2.1.0?topic=instructions-numeric)。该语言在大型机和 pc 操作系统上运行，并具有非常强大的解析和变量处理以及扩展包。Object Rexx 是最新的实现。来自[https://en.wikipedia.org/wiki/Rexx的链接](https://en.wikipedia.org/wiki/Rexx)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-05-07T06:29:22.607

**Haskell**对内置的任意精度算术具有出色的支持，并且使用它是默认行为。在 REPL 中，无需导入或设置：

```
Prelude> 2 ^ 2 ^ 12
1044388881413152506691752710716624382579964249047383780384233483283953907971557456848826811934997558340890106714439262837987573438185793607263236087851365277945956976543709998340361590134383718314428070011855946226376318839397712745672334684344586617496807908705803704071284048740118609114467977783598029006686938976881787785946905630190260940599579453432823469303026696443059025015972399867714215541693835559885291486318237914434496734087811872639496475100189041349008417061675093668333850551032972088269550769983616369411933015213796825837188091833656751221318492846368125550225998300412344784862595674492194617023806505913245610825731835380087608622102834270197698202313169017678006675195485079921636419370285375124784014907159135459982790513399611551794271106831134090584272884279791554849782954323534517065223269061394905987693002122963395687782878948440616007412945674919823050571642377154816321380631045902916136926708342856440730447899971901781465763473223850267253059899795996090799469201774624817718449867455659250178329070473119433165550807568221846571746373296884912819520317457002440926616910874148385078411929804522981857338977648103126085903001302413467189726673216491511131602920781738033436090243804708340403154190336 
```

[（在https://tryhaskell.org/](https://tryhaskell.org/)自己尝试一下）

如果您正在编写存储在文件中的代码并且想要*打印*数字，则必须先将其转换为字符串。该`show`函数就是这样做的。

```
module Test where

main = do
  let x = 2 ^ 2 ^ 12
  let xStr = show x
  putStrLn xStr 
```

（在 code.world 自己试试这个：[https](https://www.code.world/haskell#Pb_gPCQuqY7r77v1IHH_vWg) ://www.code.world/haskell#Pb_gPCQuqY7r77v1IHH_vWg ）

更重要的是，Haskell 的`Num`抽象让您尽可能推迟决定使用什么类型。

```
-- Define a function to make big numbers.  The (inferred) type is generic.
Prelude> superbig n = 2 ^ 2 ^ n

-- We can call this function with different concrete types and get different results.
Prelude> superbig 5 :: Int
4294967296
Prelude> superbig 5 :: Float
4.2949673e9

-- The `Int` type is not arbitrary precision, and we might overflow.
Prelude> superbig 6 :: Int
0

-- `Double` can hold bigger numbers.
Prelude> superbig 6 :: Double
1.8446744073709552e19
Prelude> superbig 9 :: Double
1.3407807929942597e154

-- But it is also not arbitrary precision, and can still overflow.
Prelude> superbig 10 :: Double
Infinity

-- The Integer type is arbitrary-precision though, and can go as big as we have memory for and patience to wait for the result.
Prelude> superbig 12 :: Integer
1044388881413152506691752710716624382579964249047383780384233483283953907971557456848826811934997558340890106714439262837987573438185793607263236087851365277945956976543709998340361590134383718314428070011855946226376318839397712745672334684344586617496807908705803704071284048740118609114467977783598029006686938976881787785946905630190260940599579453432823469303026696443059025015972399867714215541693835559885291486318237914434496734087811872639496475100189041349008417061675093668333850551032972088269550769983616369411933015213796825837188091833656751221318492846368125550225998300412344784862595674492194617023806505913245610825731835380087608622102834270197698202313169017678006675195485079921636419370285375124784014907159135459982790513399611551794271106831134090584272884279791554849782954323534517065223269061394905987693002122963395687782878948440616007412945674919823050571642377154816321380631045902916136926708342856440730447899971901781465763473223850267253059899795996090799469201774624817718449867455659250178329070473119433165550807568221846571746373296884912819520317457002440926616910874148385078411929804522981857338977648103126085903001302413467189726673216491511131602920781738033436090243804708340403154190336

-- If we don't specify a type, Haskell will infer one with arbitrary precision.
Prelude> superbig 12
1044388881413152506691752710716624382579964249047383780384233483283953907971557456848826811934997558340890106714439262837987573438185793607263236087851365277945956976543709998340361590134383718314428070011855946226376318839397712745672334684344586617496807908705803704071284048740118609114467977783598029006686938976881787785946905630190260940599579453432823469303026696443059025015972399867714215541693835559885291486318237914434496734087811872639496475100189041349008417061675093668333850551032972088269550769983616369411933015213796825837188091833656751221318492846368125550225998300412344784862595674492194617023806505913245610825731835380087608622102834270197698202313169017678006675195485079921636419370285375124784014907159135459982790513399611551794271106831134090584272884279791554849782954323534517065223269061394905987693002122963395687782878948440616007412945674919823050571642377154816321380631045902916136926708342856440730447899971901781465763473223850267253059899795996090799469201774624817718449867455659250178329070473119433165550807568221846571746373296884912819520317457002440926616910874148385078411929804522981857338977648103126085903001302413467189726673216491511131602920781738033436090243804708340403154190336 
```

# java - 如何将预先存在的 Java 项目导入 Eclipse 并启动和运行？

> ID：142863
> 
> 赞同：22
> 
> 时间：2008-09-27T03:16:56.050
> 
> 标签：java, eclipse

*对重复引用的评论：为什么在被引用为重复的问题之前几年被问到时会被标记为重复？我也相信问题、细节和回答比引用的问题要好得多。*

我从事 C++ 程序员已经有一段时间了，但我是 Java 新手，也是 Eclipse 新手。我想使用[触摸图“图形布局”代码](http://sourceforge.net/project/showfiles.php?group_id=30469&package_id=23976)来可视化我正在使用的一些数据。

这段代码是这样组织的：

```
./com
./com/touchgraph
./com/touchgraph/graphlayout
./com/touchgraph/graphlayout/Edge.java
./com/touchgraph/graphlayout/GLPanel.java
./com/touchgraph/graphlayout/graphelements
./com/touchgraph/graphlayout/graphelements/GESUtils.java
./com/touchgraph/graphlayout/graphelements/GraphEltSet.java
./com/touchgraph/graphlayout/graphelements/ImmutableGraphEltSet.java
./com/touchgraph/graphlayout/graphelements/Locality.java
./com/touchgraph/graphlayout/graphelements/TGForEachEdge.java
./com/touchgraph/graphlayout/graphelements/TGForEachNode.java
./com/touchgraph/graphlayout/graphelements/TGForEachNodePair.java
./com/touchgraph/graphlayout/graphelements/TGNodeQueue.java
./com/touchgraph/graphlayout/graphelements/VisibleLocality.java
./com/touchgraph/graphlayout/GraphLayoutApplet.java
./com/touchgraph/graphlayout/GraphListener.java
./com/touchgraph/graphlayout/interaction
./com/touchgraph/graphlayout/interaction/DragAddUI.java
./com/touchgraph/graphlayout/interaction/DragMultiselectUI.java
./com/touchgraph/graphlayout/interaction/DragNodeUI.java
./com/touchgraph/graphlayout/interaction/GLEditUI.java
./com/touchgraph/graphlayout/interaction/GLNavigateUI.java
./com/touchgraph/graphlayout/interaction/HVRotateDragUI.java
./com/touchgraph/graphlayout/interaction/HVScroll.java
./com/touchgraph/graphlayout/interaction/HyperScroll.java
./com/touchgraph/graphlayout/interaction/LocalityScroll.java
./com/touchgraph/graphlayout/interaction/RotateScroll.java
./com/touchgraph/graphlayout/interaction/TGAbstractClickUI.java
./com/touchgraph/graphlayout/interaction/TGAbstractDragUI.java
./com/touchgraph/graphlayout/interaction/TGAbstractMouseMotionUI.java
./com/touchgraph/graphlayout/interaction/TGAbstractMousePausedUI.java
./com/touchgraph/graphlayout/interaction/TGSelfDeactivatingUI.java
./com/touchgraph/graphlayout/interaction/TGUIManager.java
./com/touchgraph/graphlayout/interaction/TGUserInterface.java
./com/touchgraph/graphlayout/interaction/ZoomScroll.java
./com/touchgraph/graphlayout/LocalityUtils.java
./com/touchgraph/graphlayout/Node.java
./com/touchgraph/graphlayout/TGAbstractLens.java
./com/touchgraph/graphlayout/TGException.java
./com/touchgraph/graphlayout/TGLayout.java
./com/touchgraph/graphlayout/TGLensSet.java
./com/touchgraph/graphlayout/TGPaintListener.java
./com/touchgraph/graphlayout/TGPanel.java
./com/touchgraph/graphlayout/TGPoint2D.java
./com/touchgraph/graphlayout/TGScrollPane.java
./TG-APACHE-LICENSE.txt
./TGGL ReleaseNotes.txt
./TGGraphLayout.html
./TGGraphLayout.jar 
```

如何在 Eclipse 中添加此项目并使其快速编译和运行？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-27T03:26:41.940

1.  在 Eclipse 中创建一个新的 Java 项目。这将创建一个 src 文件夹（包含您的源文件）。

2.  还要创建一个 lib 文件夹（名称并不重要，但它遵循标准约定）。

3.  `./com/*`将文件夹复制到文件`/src`夹中（您可以只使用操作系统执行此操作，无需进行任何花哨的导入或任何来自 Eclipse GUI 的操作）。

4.  将任何依赖项（`jar`您的项目本身所依赖的文件）复制到`/lib`（请注意，这**不应该**包括`TGGL jar`-*感谢评论者 Mike Deck 指出我对 OPs 帖子的误解！*）

5.  将其他 TGGL 内容复制到根项目文件夹（或其他一些专用于您需要在最终应用中分发的许可证的文件夹）

6.  回到 Eclipse，选择您在步骤 1 中创建的项目，然后按 F5 键（这会刷新 Eclipse 的文件夹树视图，显示实际内容。

7.  该`/src`文件夹的内容将自动编译（类文件放置在 Eclipse 在您创建项目时为您生成的 /bin 文件中）。 **如果您有依赖项**（当前项目中没有，但为了完整起见，我将在此处包含），**编译最初将失败，因为您缺少`jar files`项目类路径中的依赖项。**

8.  最后，`/lib`在 Eclipse 中打开文件夹，`right click`在每个需要`jar file`的地方选择`Build Path->Add`构建路径。

这会将特定的 jar 添加到项目的类路径中。Eclipse 将检测到更改并自动编译之前失败的类，您现在应该有一个 Eclipse 项目，其中包含您的应用程序。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-11-14T19:25:42.610

我认为您必须通过文件->导入向导导入项目：

[http://www.coderanch.com/t/419556/vc/Open-existing-project-Eclipse](http://www.coderanch.com/t/419556/vc/Open-existing-project-Eclipse)

这不是最后一步，但它将开始您的道路。

我也感受到你的痛苦——真的没有任何借口让做一个简单的事情变得如此困难，比如打开一个现有的项目。我真的希望 Eclipse 设计人员专注于使 IDE 更易于使用（尽管我赞赏他们尝试不同方法的努力 - 但请 Eclipse 设计人员，如果您正在倾听，请不要将简单的事情复杂化）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-27T03:25:45.780

这假设您的系统上安装了 Eclipse 和适当的 JDK

1.  打开 Eclipse 并通过指定一个空目录来创建一个新的 Workspace。
2.  通过选择 Window -> Open Perspective ...，确保您在 Java 透视图中，选择 Other...，然后选择 Java
3.  右键单击 Package Explorer 窗格中的任意位置，然后选择 New -> Java Project
4.  在打开的对话框中为项目命名，然后单击“从现有来源创建项目”选项。
5.  在您在步骤 4 中选择的选项下方的文本框中，指向您签出项目的根目录。这应该是包含“com”的目录
6.  单击完成。对于这个特定的项目，您不需要为您的类路径做任何额外的设置，因为它只依赖于作为 Java SE API 一部分的类。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-31T05:55:57.177

在菜单中转到： - 文件 - 导入 - 作为过滤器选择“现有项目到工作区” - 单击下一步 - 浏览到“选择根目录”处的项目目录 - 单击“完成”

# oracle - 从端口 8080 更改 Oracle 端口

> ID：142868
> 
> 赞同：131
> 
> 时间：2008-09-27T03:19:03.003
> 
> 标签：oracle, port

如何从端口 8080 更改 Oracle？我的 Eclipse 使用的是 8080，所以我不能使用它。

* * *

## 回答 #1

> 赞同：250
> 
> 时间：2012-08-07T04:37:55.807

从开始 | 运行打开一个命令窗口。假设您的环境变量设置正确，请从以下内容开始：

```
C:\>sqlplus /nolog
SQL*Plus: Release 10.2.0.1.0 - Production on Tue Aug 26 10:40:44 2008
Copyright (c) 1982, 2005, Oracle.  All rights reserved.

SQL> connect
Enter user-name: system
Enter password: <enter password if will not be visible>
Connected.

SQL> Exec DBMS_XDB.SETHTTPPORT(3010); [Assuming you want to have HTTP going to this port]    
PL/SQL procedure successfully completed.

SQL>quit 
```

然后打开浏览器并使用 3010 端口。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-06-18T07:03:02.463

从[这篇](http://daust.blogspot.com/2006/01/xe-changing-default-http-port.html)博文：

> **XE：更改默认 http 端口**
> 
> Oracle XE 使用 XML DB (XDB) 附带的嵌入式 http 侦听器来处理 http 请求。HTTP 访问的默认端口是 8080。

**编辑：**

将 8080 端口更新到您喜欢的端口（例如 9090）

```
SQL> -- set http port
SQL> begin
 2    dbms_xdb.sethttpport('9090');
 3  end;
 4  / 
```

更改端口后，当我们启动 Oracle 时，它​​将转到端口 8080，我们应该在地址栏中手动键入 new port(9090) 以运行 Oracle XE。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-02-03T12:03:55.637

只需`Run SQL Command Line`以系统管理员身份打开并登录，然后输入以下命令

```
执行 DBMS_XDB.SETHTTPPORT(8181);

```

而已。你已经完成了......

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-11-04T14:05:52.563

`Exec DBMS_XDB.SETHTTPPORT(8181);`以 SYS/SYSTEM 身份执行。将 8181 替换为您要更改的端口。使用 Oracle 10g 对此进行了测试。

来源：[http ://hodentekhelp.blogspot.com/2008/08/my-oracle-10g-xe-is-on-port-8080-can-i.html](http://hodentekhelp.blogspot.com/2008/08/my-oracle-10g-xe-is-on-port-8080-can-i.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-27T03:28:58.130

我假设您正在谈论 Oracle 安装的 Apache 服务器。查找文件 httpd.conf。

在文本编辑器中打开此文件并查找
Listen 8080
或
Listen {ip address}:8080 行

更改端口号并重新启动 Web 服务器或仅重新启动机器。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-28T10:18:07.233

Oracle（数据库）可以使用许多端口。当您安装软件时，它会扫描空闲端口并决定使用哪个端口。

数据库侦听器默认为 1520，但如果 1520 不可用，将使用 1521 或 1522。这可以在 listener.ora 文件中进行调整。

Enterprise Manager，基于 Web 的数据库管理工具默认使用端口 80，但如果 80 不可用，将使用 8080。

有关如何更改企业管理器端口号的详细信息，请参见此处：http: [//download-uk.oracle.com/docs/cd/B14099_19/integrate.1012/b19370/manage_oem.htm#i1012853](http://download-uk.oracle.com/docs/cd/B14099_19/integrate.1012/b19370/manage_oem.htm#i1012853)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T05:58:55.833

有许多运行 Web 服务的 Oracle 组件，因此不清楚您指的是哪个。

例如，独立 OC4J 的网站端口在 j2ee/home/config/default-web-site.xml 文件中配置：

```
<web-site xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:noNamespaceSchemaLocation="http://xmlns.oracle.com/oracleas/schema/web-site-10_0.xsd"
port="8888" display-name="OC4J 10g (10.1.3) Default Web Site"
schema-major-version="10" schema-minor-version="0" > 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-10T15:01:06.723

使用系统管理员用户帐户登录并执行以下 SQL 过程。

```
begin
dbms_xdb.sethttpport('Your Port Number');
end; 
```

然后打开浏览器并访问以下网址

[http://127.0.0.1:YourPortNumber/apex/](http://127.0.0.1:YourPortNumber/apex/)

# c++ - 可以使用 C 预处理器来判断文件是否存在吗？

> ID：142877
> 
> 赞同：77
> 
> 时间：2008-09-27T03:22:29.330
> 
> 标签：c++, include, c-preprocessor

我有一个非常大的代码库（阅读：数千个模块），其中代码在众多项目中共享，这些项目都运行在具有不同 C++ 编译器的不同操作系统上。不用说，维护构建过程可能是一件苦差事。

`#includes`如果只有在当前文件夹中不存在文件的情况下，如果有办法让预处理器忽略某些情况，代码库中有几个地方会大量清理代码。有谁知道实现这一目标的方法？

目前，我们在共享文件中使用了一个`#ifdef`环绕的`#include`，第二个特定于项目的文件 #defines 是否`#include`存在于项目中。这有效，但它很丑。人们在从项目中添加或删除文件时经常忘记正确更新定义。我已经考虑编写一个预构建工具来保持这个文件是最新的，但是如果有一种独立于平台的方式来使用预处理器来做到这一点，我宁愿这样做。有任何想法吗？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2015-10-21T13:03:23.107

# 小更新

一些编译器可能支持`__has_include ( header-name )`.

该扩展已添加到[C++17 标准](https://isocpp.org/files/papers/p0636r0.html)( [P0061R1](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0061r1.html) )。

## 编译器支持

*   铛
*   来自 5.X 的 GCC
*   VS2015 Update 2 中的 Visual Studio (?)

## 示例（来自 clang 网站）：

```
// Note the two possible file name string formats.
#if __has_include("myinclude.h") && __has_include(<stdint.h>)
# include "myinclude.h"
#endif 
```

# 来源

*   [SD-6：SG10 功能测试建议](https://isocpp.org/std/standing-documents/sd-6-sg10-feature-test-recommendations)
*   [Clang 语言扩展](http://clang.llvm.org/docs/LanguageExtensions.html#langext-has-include)

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-09-27T04:34:08.533

为缺少的标题创建一个特殊文件夹，并使该文件夹最后被搜索
*（这是编译器特定的 - “INCLUDES”环境变量中的最后一项，类似的东西）*

然后，如果某些 header1.h 可能丢失，请在该文件夹中创建一个存根

header1.h：

```
#define header1_is_missing 
```

现在你可以随时写

```
#include <header1.h>
#ifdef header1_is_missing

   // there is no header1.h 

#endif 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-09-27T03:47:02.220

通常这是通过使用一个脚本来完成的，该脚本在尝试包含文件时尝试运行预处理器。根据预处理器是否返回错误，脚本会使用适当的#define（或#undef）更新生成的.h 文件。在 bash 中，脚本可能看起来像这样：

```
cat > .test.h <<'EOM'
#include <asdf.h>
EOM
if gcc -E .test.h
 then
  echo '#define HAVE_ASDF_H 1' >> config.h
 else 
  echo '#ifdef HAVE_ASDF_H' >> config.h
  echo '# undef HAVE_ASDF_H' >> config.h
  echo '#endif' >> config.h
 fi 
```

[autoconf](http://www.gnu.org/software/autoconf/)是一个非常全面的框架，用于可移植地处理像这样的可移植性检查（以及成千上万的其他检查）。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-27T03:48:16.147

预处理器本身无法识别文件的存在，但您当然可以使用构建环境来做到这一点。我最熟悉make，它可以让你在你的makefile中做这样的事情：

```
ifdef $(test -f filename && echo "present")
  DEFINE=-DFILENAME_PRESENT
endif 
```

当然，您必须在 VisualStudio 等其他构建环境中找到类似的东西，但我确信它们存在。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-27T04:31:23.050

另一种可能性：在某个目录中填充您希望选择性包含的所有标头的零长度版本。*将 -I 参数作为最后一个*此类选项传递给此目录。

GCC cpp 按顺序搜索其包含目录，如果它在较早的目录中找到头文件，它将使用它。否则，它最终会找到零长度的文件，并且很高兴。

我认为其他 cpp 实现也会按照指定的顺序搜索它们的包含目录。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-27T03:27:29.397

您可以运行一个预构建步骤来生成一个包含文件，该文件包含一个 #defines 列表，这些 #defines 表示当前目录中存在的文件的名称：

```
#define EXISTS_FILE1_C
#define EXISTS_FILE1_H
#define EXISTS_FILE2_C 
```

然后，从您的源代码中包含该文件，然后您的源可以测试`EXISTS_*`定义以查看文件是否存在。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-27T03:54:43.887

据我所知，cpp 没有关于文件存在的指令。

如果您跨平台使用相同的 make，您可能可以在 Makefile 的帮助下完成此操作。您可以检测 Makefile 中是否存在文件：

```
foo.o: foo.c
    if [ -f header1.h ]; then CFLAGS+=-DHEADER1_INC 
```

正如@Greg Hewgill 提到的，你可以让你的#includes 是有条件的：

```
#ifdef HEADER1_INC
#include <header1.h>
#endif 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-09-11T11:59:59.490

与此处和 Internet 上的一些说法相反，Visual Studio 2015 不支持该`__has_include`功能 - 至少根据我的经验。使用更新 3 测试。

谣言可能源于 VS 2017 也被称为“版本 15”；VS 2015 被称为“版本 14”。“Visual Studio 2017 Version 15.3”似乎已经正式引入了对该功能的支持。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-02T11:38:12.487

**我不得不为 Symbian OS 做类似的事情。我就是这样做的：假设您要检查文件“file_strange.h”是否存在，并且您想要包含一些标题或链接到某些库，具体取决于该文件的存在。**

**首先创建一个小批处理文件来检查该文件的存在。**

autoconf 很好，但对于许多小项目来说是过度杀戮。

----------check.bat

```
@echo off

IF EXIST [\epoc32\include\domain\middleware\file_strange] GOTO NEW_API
GOTO OLD_API
GOTO :EOF

:NEW_API
echo.#define NEW_API_SUPPORTED>../inc/file_strange_supported.h
GOTO :EOF

:OLD_API
echo.#define OLD_API_SUPPORTED>../inc/file_strange_supported.h
GOTO :EOF 
```

----------check.bat 结束

**然后我创建了一个 gnumake 文件**

----------checkmedialist.mk

```
do_nothing :
    @rem do_nothing

MAKMAKE : 
        check.bat

BLD : do_nothing

CLEAN : do_nothing

LIB : do_nothing

CLEANLIB : do_nothing

RESOURCE : do_nothing

FREEZE : do_nothing

SAVESPACE : do_nothing

RELEASABLES : do_nothing

FINAL : do_nothing 
```

----------check.mk 结束

**在你的 bld.inf 文件中包含 check.mk 文件，它必须在你的 MMP 文件之前**

```
PRJ_MMPFILES
gnumakefile checkmedialist.mk 
```

**现在在编译时文件`file_strange_supported.h`将设置一个适当的标志。您可以在您的 cpp 文件甚至 mmp 文件中使用此标志，例如在 mmp 中**

```
#include "../inc/file_strange_supported.h"
#ifdef NEW_API_SUPPORTED
LIBRARY newapi.lib
#else
LIBRARY oldapi.lib
#endif 
```

**并在 .cpp**

```
#include "../inc/file_strange_supported.h"
#ifdef NEW_API_SUPPORTED
CStrangeApi* api = Api::NewLC();
#else
// ..
#endif 
```

# .net - 哪种语言更适合通用编程，F# 还是 Haskell？

> ID：142878
> 
> 赞同：5
> 
> 时间：2008-09-27T03:24:37.670
> 
> 标签：.net, haskell, f#

我目前正在学习 Haskell，您更喜欢哪种语言（F# 或 Haskell）来编写通用应用程序？

你认为哪种语言更强大？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-19T16:29:27.890

我更喜欢 Haskell。

Jon Harrop 声称 Haskell 的工具很差，这让我思考了一下，因为我完全不同意这一点。我认为这里的问题部分是开发风格之一。让我们比较一下 F# 和 GHC 的一些与工具相关的特性：

1.  F# 有大量的可视化工具，而 GHC 没有。对我来说，缺乏可视化工具是无关紧要的：我使用 vi、Unix 命令行和高度定制的构建系统。对我在 F# 中的开发风格缺乏支持对我来说非常困难。另一方面，如果您更喜欢在 Visual-Studio 类型的环境下工作，那么您会有完全相反的意见。

2.  我知道 F# 和/或 .NET 有一个非常好的调试器。GHC 只有一个在解释器中运行的有限调试器。多年来我没有使用过调试器（其中大部分是由于使用了测试驱动的开发），当您主要使用纯函数时，如在 Haskell 中，调试器的必要性要小得多。所以对我来说，缺少这个工具是无关紧要的。

3.  图书馆。这主要取决于您需要哪些库，不是吗？如果您需要的库不存在，那么许多好的库也无济于事，并且拥有许多设计不佳的库可能没有那么有用。Haskell 的库肯定比 .NET 少，但它确实有一个合理的选择，而且其中许多的 API 设计质量非常非常高。

我不知道 F# 与本机代码库的接口是什么样的，但由于出色的 FFI，GHC 对此非常有用。我完全用 Haskell 编写了一个 Windows DDE 服务器（是的——不是一行 C，甚至不用处理来自 Windows C 库的回调），它花费的时间要少得多，而且比用 C 或 C++ 做同样的事情要简单得多。如果你需要原生代码接口，Haskell 无疑是​​更好的选择。

内存使用和性能的“不可预测性”是一个很好的观点。如果您知道自己在做什么，Haskell 在我看来实际上是可以合理预测的，但是当您开始时您不会知道自己在做什么，而且您将有很多东西要学。F# 与其他 .NET 语言更相似。

总的来说，这个问题可能更多地归结于平台而不是语言：GHC 生成本机代码的“Unixy 世界”与在 .NET 上运行的 F# 的“Windowsy 世界”之间的巨大差异不是语言问题。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-02T06:44:16.493

我会去哈斯克尔。 [HackageDB](http://hackage.haskell.org/)是专门为该语言编写的大量库集合。在 F# 的情况下，您必须使用大多数未使用函数式语言编写的库，因此它们不会像“优雅”那样使用。但是，当然，这在很大程度上取决于您想要进行多少函数式编程以及您想要使用它的项目的限制。即使是“通用”也不意味着它应该在所有情况下都使用；）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-27T05:26:15.977

我会说 F#，因为您可以访问整个 .Net 框架。然而，这更像是图书馆的事情。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-27T04:47:38.300

这取决于你想做什么：

Haskell 是两者中更纯粹的函数式语言。

F# 更像是一种混合语言，而不是纯粹的函数式语言，但有一组很棒的基类库，您可以使用它们在 Windows 或 Mono 上轻松地完成现代事情。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-05-19T10:01:22.837

我认为 Jon Harrop 出于某种原因对 Haskell 有严重的失望。说它没有在学术界之外使用是不正确的，事实上它在投资银行中被广泛使用，而且远远超过 F# 和 OCaml，这是有充分理由的。如果你想要一份函数式编程的工作，那就学习 Haskell，因为 Haskell 程序员的广告比 F# 或 OCaml 多得多。我确信 F# 会越来越受欢迎，因为它背后有微软，而且它是从零开始的，但目前 Haskell 有明显的领先优势。

大概在 2 或 3 年前，OCaml 在实用函数式语言领域处于领先地位，但从那时起，Haskell 以更多的库、更多的特性、更好的性能和更广泛的商业用途超越了它。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-11T12:54:39.267

您可能会发现 Neil Mitchell 的这篇博文提供了丰富的信息：

[从 Haskell 的角度来看 F#](http://neilmitchell.blogspot.com/2008/12/f-from-haskell-perspective.html)

评论也很有启发性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-30T05:43:04.163

我会说这取决于你为什么要学习它。如果您这样做是为了体验纯函数式语言，请选择 Haskell。但是，如果您肯定要使用该语言的目的不止于此，那么 F# 可能是更好的选择。

# .net - 使用 FedEx API 和 .Net

> ID：142886
> 
> 赞同：0
> 
> 时间：2008-09-27T03:27:46.493
> 
> 标签：.net, fedex

我正在尝试使用 1 个电话从 FedEx 获取所有可用服务的费率列表，并且在处理他们的文档时遇到了困难。任何人都有一些关于你如何与他们交互的代码片段？.Net 代码更可取，但任何东西都比他们的废话代码示例更有帮助！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T03:49:34.773

也许你会在这里看看[http://fedex.com/us/solutions/shipapi/sample_code.html/](http://fedex.com/us/solutions/shipapi/sample_code.html/) 如果你想使用 Web 服务，Visual Studio 让你的生活变得轻松，因为你所要做的就是导入一个Web 引用（或服务引用，因为它被称为 wcf）并使用它。

# asp.net - 默认动态数据 模板中是否需要 PageAction.Details 路由？

> ID：142890
> 
> 赞同：1
> 
> 时间：2008-09-27T03:29:24.523
> 
> 标签：asp.net, routing, dynamic-data

在动态数据 Web 应用程序的默认 Visual Studio 模板中，Global.asax 包含以下两个示例路由。

```
// route #1
routes.Add(new DynamicDataRoute("{table}/ListDetails.aspx") {
    Action = PageAction.List,
    ViewName = "ListDetails",
    Model = model
});

// route #2
routes.Add(new DynamicDataRoute("{table}/ListDetails.aspx") {
    Action = PageAction.Details,
    ViewName = "ListDetails",
    Model = model
}); 
```

它们仅在 Action 属性上有所不同。Global.asax 中的注释表明这两个路由用于配置处理所有 CRUD 行为的单个页面。

为什么路线#2是必要的？它有什么作用吗？ListDetails.aspx 不查看路由的 Action 属性。当我注释掉路线 #2 并且我在 Global.asax 中只有路线 #1 时，似乎一切都运行良好。Route #2 看起来没有使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T14:29:55.637

你是对的，在这种情况下不会使用路线#2。路由 #2 唯一发挥作用的情况是，如果您从路由引擎请求详细信息页面 URL。因为 ListDetails.aspx 页面模板同时处理列表和详细信息视图，所以它从不请求详细信息模板 URL。

# linq - LINQ 按问题分组

> ID：142903
> 
> 赞同：2
> 
> 时间：2008-09-27T03:37:51.727
> 
> 标签：linq

我今天开始玩 Linq，遇到了一个我找不到答案的问题。我正在查询一个包含一些员工记录的简单 SQL Server 数据库。其中一个字段是全名 (cn)。我认为通过在第一个空格处拆分全名来按名字分组会很有趣。我试过了

```
group by person.cn.Split(separators)[0] 
```

但遇到了一个冗长的运行时异常（看起来很像 C++ 模板实例化错误）。

然后我尝试按名字的几个字母进行分组：

```
group by person.cn.Substring(0,5) 
```

这很好用，但不是我想要的。

我想知道两件事：

*   为什么第一个示例看起来如此接近第二个示例时不起作用？
*   知道在幕后是 SQL 的事情，什么是有效地做这种事情的好方法

谢谢，

安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T05:51:33.340

Split 没有翻译成 SQL。

那么，如何在不拆分的情况下进行这种字符串操作呢？像地狱一样作弊（未经测试）：

```
string oneSpace = " ";
string fiftySpace = "                                                  ";

var query = 
  from person in db.Persons
  let lastname = person.cn.Replace(oneSpace, fiftySpace).SubString(0, 50).Trim()
  group person by lastname into g
  select new { Key = g.Key, Count = g.Count }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T14:48:23.300

谢谢大家，我会尝试“替换”技巧，看看它是否运行。我对 LINQ 很感兴趣，但现在看起来有一些隐藏的奥秘，你必须知道你的 LINQ 查询转换成什么才能有效地使用它。

核心问题当然是我不太了解 SQL，所以我将从这里开始。

编辑：

我今天终于尝试了“替换”并且它有效。我什至必须按计数对分组结果进行排序，所以现在我的公司中有一个帕累托名称。不过，它的速度非常慢。选择所有内容并直接在 C# 中进行分桶要快得多。

再次感谢，

安德鲁

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T05:57:07.180

您第一次尝试失败的原因是 LINQ to SQL 使用表达式树将您的查询转换为 SQL。因此，任何不能直接翻译成 SQL 的代码都是一个例外——这包括对 Split 的调用。

# image - 图像识别

> ID：142928
> 
> 赞同：5
> 
> 时间：2008-09-27T03:50:07.377
> 
> 标签：image, image-processing, pixel

我想做一些与计算机成像有关的工作。我正在寻找一种方法来读取数据的单个像素，以编程方式分析它们并更改它们。什么是最好的语言（Python、c++、Java...）？最好的文件格式是什么？

我不想要任何超级花哨的软件/API……我正在寻找最基本的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T03:58:51.863

如果您需要速度（您可能总是想要图像处理的速度），您肯定必须使用原始像素数据。Java 有一些真正的缺点，因为您不能直接访问内存，这使得像素访问与直接访问内存相比非常慢。C++ 绝对是生产使用图像处理的首选语言。但是，例如，您也可以使用 C#，因为它允许在特定区域使用不安全的代码。（看看 bitmapdata 类的 scan0 指针属性。）我已经成功地将 C# 用于图像处理应用程序，它们肯定比它们的 java 对应物快得多。我不会为此目的使用任何脚本语言或 java。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-27T04:35:59.963

**使用Python**等高级语言来操作大型多维或复杂的像素信息数组是非常东方的。有一个名为[PIL（Python Imaging Library](http://www.pythonware.com/products/pil/)）的库非常有用，它可以让您进行一般的过滤器和转换（更改亮度、柔化、去饱和度、裁剪等）以及操作原始像素数据。

它是我迄今为止使用过的[最简单和最简单](http://www.pythonware.com/library/pil/handbook/introduction.htm)的图像库，并且可以扩展为您感兴趣的任何事情（例如，在非常少的代码中进行[边缘检测）。](http://www.asakusuma.com/index.php?act=article&id=20)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-29T16:11:07.987

我学习了人工智能和计算机视觉，因此我非常了解该领域使用的那种工具。

基本上：只要你知道它在幕后是如何工作的，你就可以使用任何你想要的东西。

现在根据您想要实现的目标，您可以使用：

*   C 语言，但是在实现算法时，您将在错误检查和内存管理上浪费大量时间。所以从理论上讲，这是完成这类工作的最快语言，但如果你的算法在计算上不高效（就复杂性而言）或者如果你在错误检查上浪费了太多时间，这显然是不值得的。所以我建议首先用另一种语言实现你的应用程序，然后你总是可以用 C 绑定优化你的代码的一小部分。
*   Octave/MatLab：非常高效的语言，几乎和 C 一样多，你可以做出非常优雅和简洁的算法。如果你喜欢矢量化、矩阵和线性运算，你应该这样做。但是，您将无法使用这种语言开发整个应用程序，它更专注于算法，但是您以后总是可以使用另一种语言开发界面。
*   Python：多合一优雅且易于使用的语言，用于谷歌和 Facebook 等大规模应用程序。你几乎可以用 Python 做任何你想做的事情，任何类型的应用程序。如果您想制作一个完整的应用程序（与客户端交互和所有，而不仅仅是算法），或者如果您想使用现有库快速起草原型，它将完美适应，因为 Python 有大量高质量的库，例如[开放式简历](http://opencv.willowgarage.com/wiki/)。但是，如果您只想制作算法，则最好使用 Octave/MatLab。

被选为解决方案的答案非常偏颇，您应该小心这种过时的评论。

如今，硬件比湿件（人类）便宜，因此，您应该使用能够更快产生结果的语言，即使它以几个 CPU 周期或内存空间为代价。

此外，很多人倾向于认为，只要你用 C/C++ 实现你的软件，你就是在创造速度的圣杯：这不是真的。首先，因为算法的复杂性比你使用的语言更重要（一个糟糕的算法永远不会打败一个更好的算法，即使是用宇宙中最慢的语言实现），其次是因为现在高级语言做了很多事情为您提供缓存和速度优化，这可以使您的程序运行得比在 C/C++ 中更快。

当然，您总是可以在 C/C++ 中完成上述所有操作，但是您愿意浪费多少时间来重新发明轮子？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T04:03:52.040

不仅 C/C++ 会更快，而且您发现的大多数图像处理示例代码也将使用 C 语言，因此更容易合并您找到的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T04:13:15.153

（这可能不适用于只想要基本知识的 OP——但既然提出了速度问题，我确实需要写这个，只是为了记录。）

如果您*真的*需要速度，最好忘记在逐像素级别上工作，而是看看您需要执行的操作是否可以[矢量化](http://en.wikipedia.org/wiki/Vectorization)。例如，对于您的 C/C++ 代码，您可以使用出色的[英特尔 IPP 库](http://www.intel.com/cd/software/products/asmo-na/eng/302910.htm)（不，我不为英特尔工作）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-27T04:14:59.750

如果您正在寻找图像上的数值工作（想想矩阵）并且您进入 Python，请查看[http://www.scipy.org/PyLab](http://www.scipy.org/PyLab) - 这基本上是在 python 中执行 matlab 的能力，我的朋友对此发誓。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T04:44:42.127

这在一定程度上取决于你想要做什么。

如果运行时速度是您的问题，那么 c++ 是最好的方法。

但是，如果开发速度是一个问题，我建议您查看 java.util. 您说您想要对像素进行低级操作，java 将为您完成。但另一件事可能是一个问题是各种文件格式的处理。Java 确实有一些非常好的 API 来处理读取和写入各种图像格式到文件（特别是 java2d 库。您选择忽略更高级别的 API）

如果您确实选择了 c++ 选项（或者想到了 python），我会再次建议使用库来帮助您解决读取和写入文件的启动问题。我以前在[libgd上取得过成功](http://www.libgd.org/Main_Page)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-09T00:26:28.920

你最懂什么语言？对我来说，这是真正的问题。如果您要花费数月和数月的时间来学习一种特定的语言，那么使用 Python 或 Java 并没有真正的优势，只是因为它们（有待证明）的开发速度。我特别精通 C++，例如，我认为对于这个特定的任务，我可以像 Java 程序员一样快速。借助一些好的库（想到 OpenCV），您可以在几行 C++ 代码中创建任何您需要的东西，真的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-22T19:16:12.363

简短回答：C++ 和 OpenCV

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-27T03:51:24.050

简短的回答？我会说 C++，你在处理原始内存块方面比 Python 或 Java 更灵活。

# iphone - 如何为 iPhone 加速度计实现高通滤波器？

> ID：142944
> 
> 赞同：15
> 
> 时间：2008-09-27T03:59:42.080
> 
> 标签：iphone

我记得几天前在示例中的某个地方看到了高通滤波器的代码，但是我现在在任何地方都找不到它！有人能记得我高通滤波器实现代码在哪里吗？

或者更好地发布算法？

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-27T04:12:22.720

[来自 idevkit.com 论坛：](http://idevkit.com/forums/tutorials-code-samples-sdk/171-accelerometer-high-pass-filter-incorrect-apple-code.html)

```
#define kFilteringFactor 0.1
static UIAccelerationValue rollingX=0, rollingY=0, rollingZ=0;

- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {

    // Calculate low pass values

    rollingX = (acceleration.x * kFilteringFactor) + (rollingX * (1.0 - kFilteringFactor));
    rollingY = (acceleration.y * kFilteringFactor) + (rollingY * (1.0 - kFilteringFactor));
    rollingZ = (acceleration.z * kFilteringFactor) + (rollingZ * (1.0 - kFilteringFactor));

    // Subtract the low-pass value from the current value to get a simplified high-pass filter

    float accelX = acceleration.x - rollingX;
    float accelY = acceleration.y - rollingY;
    float accelZ = acceleration.z - rollingZ;

    // Use the acceleration data.

} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-02T03:51:38.563

万一有人想知道，高通滤波器可以在[Accelerometer Graph sample](https://developer.apple.com/library/ios/samplecode/AccelerometerGraph/Introduction/Intro.html)中找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-21T11:06:58.370

这是链接，我也在找这个。这是自适应/非自适应高通和低通滤波器的示例：[Apple iOS Reference Library - AccelerometerGraph Example](https://developer.apple.com/library/ios/samplecode/AccelerometerGraph/Introduction/Intro.html)

# haskell - 如何在现实世界中使用函数式编程？

> ID：142948
> 
> 赞同：103
> 
> 时间：2008-09-27T04:02:25.163
> 
> 标签：haskell, f#, functional-programming

函数式语言很好，因为它们通过消除状态来避免错误，还因为它们可以轻松地为您自动并行化，而不必担心线程数。

不过，作为 Win32 开发人员，我可以将 Haskell 用于我的应用程序的某些 dll 吗？如果我这样做了，是否会自动为我带来真正的优势？如果是这样，是什么给了我这个优势，编译器？

F# 是否会自动为您并行化您跨多个内核和 cpu 编写的函数？你会看到任务管理器中的线程数增加吗？

基本上我的问题是，我怎样才能以实际的方式开始使用 Haskell，如果我这样做，我真的会看到一些好处吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-27T04:41:14.787

看起来这本书 Real World Haskell 正是您正在寻找的。您可以在线免费阅读：

[http://book.realworldhaskell.org/](http://book.realworldhaskell.org/)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-27T04:16:57.530

F# 不包含任何可以将功能传递给不同 CPU 或机器的魔法小精灵。F#/Haskell 和其他函数式编程语言所做的是让您更容易编写可以独立于创建它们的线程或 CPU 进行处理的函数。

我觉得在这里发布我参与的播客的链接不正确，似乎有点不对劲，但在我们与 Matt Podwysocki 交谈的 Herding Code 插曲中，我们问了同样的问题，他给出了一些有趣的答案。在那一集中还有很多与函数式编程相关的好链接。我找到了一个标题为“[为什么函数式编程很重要](http://www.math.chalmers.se/~rjmh/Papers/whyfp.html)”的链接，这可能会为您提供一些答案。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-29T07:10:28.750

这也可能很有趣：“[真实世界函数式编程](http://www.manning.com/petricek/)”

示例在 F# 和 C# 中，但理论相当通用。从我读过的（预发布）来看，这绝对很有趣，但到目前为止，我认为这让我越来越想使用 C#，使用 Parallel Extensions 之类的库。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-12T10:26:42.010

您没有提到，但我假设您使用的是 C++。进入函数式的一种可能简单的方法是通过 C++/CLI 到 F#。C++ 包含“神奇的精灵尘埃”（称为 IJW：It Just Works），允许您调用和调用托管代码。有了这个，调用 F# 代码几乎和从 C# 中一样简单。

我在一个完全用 C/C++ 编写的程序 (FreeSWITCH) 中使用了它。使用单个托管 C++/CLI（使用 /clr 开关），它会神奇地转换为托管代码，然后我可以从那里加载我的 F# 插件并执行它们。为了使部署更加容易，F# 可以静态链接其所有依赖项，因此您无需部署 F# 运行时文件。使 CLR 代码具有吸引力的另一件事是，您可以将托管代码（委托）传递给 C 代码，并且运行时会自动为您生成一个 thunk。

如果您决定采用 Haskell 方式，那么您将寻找的功能是 FFI：Foreign Function Interface。但是，我认为它不会为您提供与 C++/CLI 与 F# 相同级别的集成。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-27T04:10:04.317

我目前正在自己​​学习 Haskell，当你开始学习它时，它似乎并不吸引人，因为学习体验与学习 C# 之类的语言完全不同，这是一个全新的世界，但我注意到我可以编写非常非常复杂的代码几行代码的表达式，当我回顾代码时，它更加简洁，它又小又紧。我非常喜欢它！您确实可以编写比大多数其他语言允许的更小、更易于维护、更复杂的实际程序，我投票支持您学习它！

祝你好运。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-18T00:09:47.793

由于您提到了 Win32 和 DLL，我认为您正在使用非托管代码。在这种情况下，GHC 将非常适合您。去年年底，我在 Windows 下编写了一个 DDE 服务器，使用[FFI](http://www.starling-software.com/en/blog/tsac/2009/01/12.december-surprise-topic-haskell-ffi.html)与 MS DDE 库通信，令人惊讶的是，这是一次非常愉快的体验（尤其是考虑到我是一个 Unix 人）。Haskell 的 FFI 功能强大（甚至支持，例如，从 C 或其他库回调到 Haskell 函数），并且在编写 C 级代码时拥有 Haskell 的类型检查就像梦想成真。

最后一点是 Haskell 的主要优势之一：类型系统令人惊叹。也就是说，它就像任何强大的工具一样；它需要时间和精力来充分利用它。

所以，是的，可以开始在 Haskell 中编写少量代码，链接到您的其余代码（尽管您可能会发现从链接到其他代码的小型 Haskell 程序开始更容易），而且值得花费花费大量时间来学习并尽可能地使用它。你可能会像我一样，在 Haskell 中计划一个与 Windows 代码（在我的例子中是复杂的 Excel 插件）紧密集成的相当大的项目。

# java - 将“/”站点迁移到 Java EE 打包时处理上下文路径引用

> ID：142965
> 
> 赞同：1
> 
> 时间：2008-09-27T04:13:50.703
> 
> 标签：java, servlets, servlet-filters

现有的 Java 站点被设计为在 tomcat 上的“/”下运行，并且有许多对固定绝对路径的特定引用，例如“/dir/dir/page”。

想要将此迁移到 Java EE 打包，站点需要在上下文根下运行，例如“/dir/dir/page”变为“/my-context-root/dir/dir/page”

现在，使用 ServletRequest.getContextPath() 可以轻松地获取上下文根，但这仍然意味着要迁移大量代码库需要进行大量代码更改。这些引用中的大多数都是文字 HTML。

我已经尝试使用 servlet 过滤器对出站 HTML 进行重写，这似乎工作正常。但它确实引入了一些开销，我不认为它是一个永久的解决方案。 （有关 servlet 过滤器方法，请参阅[EnforceContextRootFilter-1.0-src.zip ）。](http://github.com/tardate/sources/tree/master%2FEnforceContextRootFilter-1.0-src.zip?raw=true)

有没有更好的方法来解决这个问题？有什么明显的我失踪了吗？所有评论表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T06:41:44.327

查看相关[问题](https://stackoverflow.com/questions/125359/any-clever-ways-of-handling-the-context-in-a-web-app)

还要考虑[URLRewriteFilter](http://tuckey.org/urlrewrite/)

另一件事（我一直在编辑这个该死的帖子）。如果您使用 JSP（相对于静态 HTML 或其他内容），您还可以创建一个标记文件来用链接（特别是 a、img、表单）替换常见的 html 标记。所以 <a href="/root/path">link</a> 可以变成 <t:a href="/root/path">link</t:a>。然后标签可以为你做翻译。

使用 sed 之类的东西可以轻松地“整体”完成这种更改。

```
sed -e 's/<a/<t:a/g' -e 's/<\/a>/<\/t:a>/g' old/x.jsp > new/x.jsp 
```

表单操作可能比 sed 有点棘手，但你明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T06:17:41.513

apache 世界使用 Redirects(mod_rewrite) 来做同样的事情。

Servlet 世界开始使用过滤器

ruby 世界（或 RoR）做了更多相同的事情，他们称之为路由。

所以，没有办法绕过它（除非你想彻底使用智能正则表达式——它已经过尝试并且效果很好）。

# c# - C#：将 COMP-3 压缩十进制转换为人类可读的值

> ID：142972
> 
> 赞同：6
> 
> 时间：2008-09-27T04:18:48.790
> 
> 标签：c#, .net, ibm-midrange, flat-file, comp-3

我有一系列来自大型机的 ASCII 平面文件，由 C# 应用程序处理。引入了带有压缩十进制 (COMP-3) 字段的新提要，该字段需要转换为数值。

文件正在通过 FTP 传输，使用 ASCII 传输模式。我担心二进制字段可能包含将被解释为非常低的 ASCII 代码或控制字符而不是值的内容 - 或者更糟糕的是，可能会在 FTP 过程中丢失。

更重要的是，这些字段被读取为字符串。我可能可以灵活地解决这部分问题（即某种类型的流），但业务会给我带来阻力。

要求为“从 HEX 转换为 ASCII”，但显然这没有产生正确的值。任何帮助，将不胜感激; 只要您可以解释转换过程的逻辑，它就不需要特定于语言。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T22:56:15.070

我一直在许多板上观看有关将 Comp-3 BCD 数据从“旧”大型机文件转换为 C# 中可用的东西的帖子。首先，我想说的是，我对其中一些帖子收到的回复不太感兴趣——尤其是那些基本上说“你为什么用这些非 C#/C++ 相关的帖子来打扰我们”以及“如果您需要有关某种 COBOL 约定的答案，为什么不去访问一个面向 COBOL 的站点”。对我来说，这完全是废话，因为可能在未来很多年（不幸的是），软件开发人员都需要了解如何处理现实世界中存在的一些遗留问题。所以，即使我在这篇文章中因为以下代码而受到抨击，

首先 - 了解您从像 IBM 这样的传统大型机系统读取的任何文件都将以 EBCDIC 格式向您呈现数据，并且为了将任何数据转换为您可以处理的 C#/C++ 字符串，您是必须使用正确的代码页转换将数据转换为 ASCII 格式。如何处理这个问题的一个很好的例子是：

StreamReader readFile = new StreamReader(path, Encoding.GetEncoding(037); // 037 = EBCDIC 到 ASCII 转换。

这将确保您从此流中读取的任何内容都将被转换为 ASCII 并且可以以字符串格式使用。这包括 COBOL 声明的“区域十进制”（图 9）和“文本”（图 X）字段。但是，当读入 char[] 或 byte[] 数组时，这并不一定会将 COMP-3 字段转换为正确的“二进制”等效项。要做到这一点，您将得到正确翻译的唯一方法（即使使用 UTF-8、UTF-16、默认或其他）代码页，您将希望像这样打开文件：

FileStream fileStream = new FileStream(path, FIleMode.Open, FIleAccess.Read, FileShare.Read);

当然，“FileShare.Read”选项是“可选的”。

当您隔离了要转换为十进制值的字段（然后根据需要转换为 ASCII 字符串）时，您可以使用以下代码 - 这基本上是从您发布的 MicroSoft“UnpackDecimal”帖子中窃取的可以在：

[http://www.microsoft.com/downloads/details.aspx?familyid=0e4bba52-cc52-4d89-8590-cda297ff7fbd&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=0e4bba52-cc52-4d89-8590-cda297ff7fbd&displaylang=en)

我已经分离（我认为）这个逻辑中最重要的部分是什么，并将其合并为两种方法，你可以用你想要的方法来做。出于我的目的，我选择将其保留为返回一个 Decimal 值，然后我可以用我想要的方式进行操作。基本上，该方法称为“解包”，您将一个 byte[] 数组（不超过 12 个字节）和作为 int 的比例传递给它，这是您希望在 Decimal 值中返回的小数位数。我希望这对你有用，对我也有用。

```
 private Decimal Unpack(byte[] inp, int scale)
    {
        long lo = 0;
        long mid = 0;
        long hi = 0;
        bool isNegative;

        // this nybble stores only the sign, not a digit.  
        // "C" hex is positive, "D" hex is negative, and "F" hex is unsigned. 
        switch (nibble(inp, 0))
        {
            case 0x0D:
                isNegative = true;
                break;
            case 0x0F:
            case 0x0C:
                isNegative = false;
                break;
            default:
                throw new Exception("Bad sign nibble");
        }
        long intermediate;
        long carry;
        long digit;
        for (int j = inp.Length * 2 - 1; j > 0; j--)
        {
            // multiply by 10
            intermediate = lo * 10;
            lo = intermediate & 0xffffffff;
            carry = intermediate >> 32;
            intermediate = mid * 10 + carry;
            mid = intermediate & 0xffffffff;
            carry = intermediate >> 32;
            intermediate = hi * 10 + carry;
            hi = intermediate & 0xffffffff;
            carry = intermediate >> 32;
            // By limiting input length to 14, we ensure overflow will never occur

            digit = nibble(inp, j);
            if (digit > 9)
            {
                throw new Exception("Bad digit");
            }
            intermediate = lo + digit;
            lo = intermediate & 0xffffffff;
            carry = intermediate >> 32;
            if (carry > 0)
            {
                intermediate = mid + carry;
                mid = intermediate & 0xffffffff;
                carry = intermediate >> 32;
                if (carry > 0)
                {
                    intermediate = hi + carry;
                    hi = intermediate & 0xffffffff;
                    carry = intermediate >> 32;
                    // carry should never be non-zero. Back up with validation
                }
            }
        }
        return new Decimal((int)lo, (int)mid, (int)hi, isNegative, (byte)scale);
    }

    private int nibble(byte[] inp, int nibbleNo)
    {
        int b = inp[inp.Length - 1 - nibbleNo / 2];
        return (nibbleNo % 2 == 0) ? (b & 0x0000000F) : (b >> 4);
    } 
```

如果您有任何问题，请在此处发布 - 因为我怀疑我会像其他选择发布与当今问题相关的问题的人一样被“激怒”……

谢谢，约翰-长老。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-27T04:56:52.893

首先，您必须消除由 ASCII 传输模式引起的行尾 (EOL) 转换问题。当 BCD 值恰好对应 EOL 字符时，您担心数据损坏是绝对正确的。这个问题最糟糕的方面是它会很少和意外地发生。

最好的解决方案是将传输模式更改为 BIN。这是合适的，因为您传输的数据是二进制的。如果无法使用正确的 FTP 传输模式，您可以在代码中撤消 ASCII 模式损坏。您所要做的就是将 \r\n 对转换回 \n。如果我是你，我会确保这是经过良好测试的。

一旦您处理了 EOL 问题，COMP-3 转换就非常简单了。我能够在 MS 知识库中找到[这篇文章](http://support.microsoft.com/kb/65323)，其中包含 BASIC 中的示例代码。有关此代码的 VB.NET 端口，请参见下文。

由于您正在处理 COMP-3 值，因此您正在阅读的文件格式几乎肯定具有固定的记录大小和固定的字段长度。如果我是你，我会在你进一步研究之前获得文件格式规范。您应该使用 BinaryReader 来处理这些数据。如果有人反对这一点，我会走开。让他们找别人放纵他们的愚蠢。

这是 BASIC 示例代码的 VB.NET 端口。我没有对此进行测试，因为我无权访问 COMP-3 文件。如果这不起作用，我会参考原始 MS 示例代码以获取指导，或参考此问题的其他答案中的参考。

```
Imports Microsoft.VisualBasic

Module Module1

'Sample COMP-3 conversion code
'Adapted from http://support.microsoft.com/kb/65323
'This code has not been tested

Sub Main()

    Dim Digits%(15)       'Holds the digits for each number (max = 16).
    Dim Basiceqv#(1000)   'Holds the Basic equivalent of each COMP-3 number.

    'Added to make code compile
    Dim MyByte As Char, HighPower%, HighNibble%
    Dim LowNibble%, Digit%, E%, Decimal%, FileName$

    'Clear the screen, get the filename and the amount of decimal places
    'desired for each number, and open the file for sequential input:
    FileName$ = InputBox("Enter the COBOL data file name: ")
    Decimal% = InputBox("Enter the number of decimal places desired: ")

    FileOpen(1, FileName$, OpenMode.Binary)

    Do Until EOF(1)   'Loop until the end of the file is reached.
        Input(1, MyByte)
        If MyByte = Chr(0) Then     'Check if byte is 0 (ASC won't work on 0).
            Digits%(HighPower%) = 0       'Make next two digits 0\. Increment
            Digits%(HighPower% + 1) = 0   'the high power to reflect the
            HighPower% = HighPower% + 2   'number of digits in the number
            'plus 1.
        Else
            HighNibble% = Asc(MyByte) \ 16      'Extract the high and low
            LowNibble% = Asc(MyByte) And &HF    'nibbles from the byte. The
            Digits%(HighPower%) = HighNibble%  'high nibble will always be a
            'digit.
            If LowNibble% <= 9 Then                   'If low nibble is a
                'digit, assign it and
                Digits%(HighPower% + 1) = LowNibble%   'increment the high
                HighPower% = HighPower% + 2            'power accordingly.
            Else
                HighPower% = HighPower% + 1 'Low nibble was not a digit but a
                Digit% = 0                  '+ or - signals end of number.

                'Start at the highest power of 10 for the number and multiply
                'each digit by the power of 10 place it occupies.
                For Power% = (HighPower% - 1) To 0 Step -1
                    Basiceqv#(E%) = Basiceqv#(E%) + (Digits%(Digit%) * (10 ^ Power%))
                    Digit% = Digit% + 1
                Next

                'If the sign read was negative, make the number negative.
                If LowNibble% = 13 Then
                    Basiceqv#(E%) = Basiceqv#(E%) - (2 * Basiceqv#(E%))
                End If

                'Give the number the desired amount of decimal places, print
                'the number, increment E% to point to the next number to be
                'converted, and reinitialize the highest power.
                Basiceqv#(E%) = Basiceqv#(E%) / (10 ^ Decimal%)
                Print(Basiceqv#(E%))
                E% = E% + 1
                HighPower% = 0
            End If
        End If
    Loop

    FileClose()   'Close the COBOL data file, and end.
End Sub

End Module 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T19:48:21.557

如果原始数据在 EBCDIC 中，则您的 COMP-3 字段已乱码。FTP 进程已经完成了 COMP-3 字段中字节值的 EBCDIC 到 ASCII 转换，这不是您想要的。要纠正此问题，您可以：

1) 使用 BINARY 模式进行传输，以便获得原始 EBCDIC 数据。然后将 COMP-3 字段转换为数字并将记录上的任何其他 EBCDIC 文本转换为 ASCII。压缩字段将每个数字存储在半字节中，下半字节作为符号（F 为正，其他值，通常为 D 或 E，为负）。在 PIC 999.99 USAGE COMP-3 中存储 123.4 将是 X'01234F'（三个字节），而在同一字段中的 -123 是 X'01230D'。

2) 让发件人将该字段转换为 USAGE IS DISPLAY SIGN IS LEADING（或 TRAILING）数字字段。这会将数字存储为 EBCDIC 数字字符串，符号为单独的负 (-) 或空白字符。在 FTP 传输中，所有数字和符号都正确转换为它们的 ASCII 等价物。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T04:35:32.057

如果我在这里偏离基础，我深表歉意，但也许我将粘贴在这里的这个代码示例可以帮助你。这来自VBRocks...

```
Imports System
Imports System.IO
Imports System.Text
Imports System.Text.Encoding

'4/20/07 submission includes a line spacing addition when a control character is used:
'   The line spacing is calculated off of the 3rd control character.
'
'   Also includes the 4/18 modification of determining end of file.

'4/26/07 submission inclues an addition of 6 to the record length when the 4th control
'   character is an 8\.  This is because these records were being truncated.

'Authored by Gary A. Lima, aka. VBRocks

''' <summary>
''' Translates an EBCDIC file to an ASCII file.
''' </summary>
''' <remarks></remarks>
Public Class EBCDIC_to_ASCII_Translator

#Region " Example"

    Private Sub Example()
        'Set your source file and destination file paths
        Dim sSourcePath As String = "c:\Temp\MyEBCDICFile"
        Dim sDestinationPath As String = "c:\Temp\TranslatedFile.txt"

        Dim trans As New EBCDIC_to_ASCII_Translator()

        'If your EBCDIC file uses Control records to determine the length of a record, then this to True
        trans.UseControlRecord = True

        'If the first record of your EBCDIC file is filler (junk), then set this to True
        trans.IgnoreFirstRecord = True

        'EBCDIC files are written in block lengths, set your block length (Example:  134, 900, Etc.)
        trans.BlockLength = 900

        'This method will actually translate your source file and output it to the specified destination file path
        trans.TranslateFile(sSourcePath, sDestinationPath)

        'Here is a alternate example:
        'No Control record is used
        'trans.UseControlRecord = False

        'Translate the whole file, including the first record
        'trans.IgnoreFirstRecord = False

        'Set the block length
        'trans.BlockLength = 134

        'Translate...
        'trans.TranslateFile(sSourcePath, sDestinationPath)

        '*** Some additional methods that you can use are:

        'Trim off leading characters from left side of string (position 0 to...)
        'trans.LTrim = 15

        'Translate 1 EBCDIC character to an ASCII character
        'Dim strASCIIChar as String = trans.TranslateCharacter("S")

        'Translate an EBCDIC character array to an ASCII string
        'trans.TranslateCharacters(chrEBCDICArray)

        'Translates an EBCDIC string to an ASCII string
        'Dim strASCII As String = trans.TranslateString("EBCDIC String")

    End Sub

#End Region    'Example

    'Translate characters from EBCDIC to ASCII

    Private ASCIIEncoding As Encoding = Encoding.ASCII
    Private EBCDICEncoding As Encoding = Encoding.GetEncoding(37)  'EBCDIC

    'Block Length:  Can be fixed (Ex:  134). 
    Private miBlockLength As Integer = 0
    Private mbUseControlRec As Boolean = True        'If set to False, will return exact block length
    Private mbIgnoreFirstRecord As Boolean = True    'Will Ignore first record if set to true  (First record may be filler)
    Private miLTrim As Integer = 0

    ''' <summary>
    ''' Translates SourceFile from EBCDIC to ASCII.  Writes output to file path specified by DestinationFile parameter.
    ''' Set the BlockLength Property to designate block size to read.
    ''' </summary>
    ''' <param name="SourceFile">Enter the path of the Source File.</param>
    ''' <param name="DestinationFile">Enter the path of the Destination File.</param>
    ''' <remarks></remarks>
    Public Sub TranslateFile(ByVal SourceFile As String, ByVal DestinationFile As String)

        Dim iRecordLength As Integer     'Stores length of a record, not including the length of the Control Record (if used)
        Dim sRecord As String = ""         'Stores the actual record
        Dim iLineSpace As Integer = 1    'LineSpace:  1 for Single Space, 2 for Double Space, 3 for Triple Space...

        Dim iControlPosSix As Byte()      'Stores the 6th character of a Control Record (used to calculate record length)
        Dim iControlRec As Byte()          'Stores the EBCDIC Control Record (First 6 characters of record)
        Dim bEOR As Boolean                'End of Record Flag
        Dim bBOF As Boolean = True      'Beginning of file
        Dim iConsumedChars As Integer = 0     'Stores the number of consumed characters in the current block
        Dim bIgnoreRecord As Boolean = mbIgnoreFirstRecord   'Ignores the first record if set.

        Dim ControlArray(5) As Char         'Stores Control Record (first 6 bytes)
        Dim chrArray As Char()              'Stores characters just after read from file

        Dim sr As New StreamReader(SourceFile, EBCDICEncoding)
        Dim sw As New StreamWriter(DestinationFile)

        'Set the RecordLength to the RecordLength Property (below)
        iRecordLength = miBlockLength

        'Loop through entire file
        Do Until sr.EndOfStream = True

            'If using a Control Record, then check record for valid data.
            If mbUseControlRec = True Then
                'Read the Control Record (first 6 characters of the record)
                sr.ReadBlock(ControlArray, 0, 6)

                'Update the value of consumed (read) characters
                iConsumedChars += ControlArray.Length

                'Get the bytes of the Control Record Array
                iControlRec = EBCDICEncoding.GetBytes(ControlArray)

                'Set the line spacing  (position 3 divided by 64)
                '   (64 decimal = Single Spacing; 128 decimal = Double Spacing)
                iLineSpace = iControlRec(2) / 64

                'Check the Control record for End of File
                'If the Control record has a 8 or 10 in position 1, and a 1 in postion 2, then it is the end of the file
                If (iControlRec(0) = 8 OrElse iControlRec(0) = 10) AndAlso _
                    iControlRec(1) = 1 Then

                    If bBOF = False Then
                        Exit Do

                    Else
                        'The Beginning of file flag is set to true by default, so when the first
                        '   record is encountered, it is bypassed and the bBOF flag is set to False
                        bBOF = False

                    End If    'If bBOF = Fals

                End If    'If (iControlRec(0) = 8 OrElse

                'Set the default value for the End of Record flag to True
                '   If the Control Record has all zeros, then it's True, else False
                bEOR = True

                'If the Control record contains all zeros, bEOR will stay True, else it will be set to False
                For i As Integer = 0 To 5
                    If iControlRec(i) > 0 Then
                        bEOR = False

                        Exit For

                    End If    'If iControlRec(i) > 0

                Next    'For i As Integer = 0 To 5

                If bEOR = False Then
                    'Convert EBCDIC character to ASCII
                    'Multiply the 6th byte by 6 to get record length
                    '   Why multiply by 6?  Because it works.
                    iControlPosSix = EBCDICEncoding.GetBytes(ControlArray(5))

                    'If the 4th position of the control record is an 8, then add 6
                    '    to the record length to pick up remaining characters.
                    If iControlRec(3) = 8 Then
                        iRecordLength = CInt(iControlPosSix(0)) * 6 + 6

                    Else
                        iRecordLength = CInt(iControlPosSix(0)) * 6

                    End If

                    'Add the length of the record to the Consumed Characters counter
                    iConsumedChars += iRecordLength

                Else
                    'If the Control Record had all zeros in it, then it is the end of the Block.

                    'Consume the remainder of the block so we can continue at the beginning of the next block.
                    ReDim chrArray(miBlockLength - iConsumedChars - 1)
                    'ReDim chrArray(iRecordLength - iConsumedChars - 1)

                    'Consume (read) the remaining characters in the block.  
                    '   We are not doing anything with them because they are not actual records.
                    'sr.ReadBlock(chrArray, 0, iRecordLength - iConsumedChars)
                    sr.ReadBlock(chrArray, 0, miBlockLength - iConsumedChars)

                    'Reset the Consumed Characters counter
                    iConsumedChars = 0

                    'Set the Record Length to 0 so it will not be processed below.
                    iRecordLength = 0

                End If    ' If bEOR = False

            End If    'If mbUseControlRec = True

            If iRecordLength > 0 Then
                'Resize our array, dumping previous data.  Because Arrays are Zero (0) based, subtract 1 from the Record length.
                ReDim chrArray(iRecordLength - 1)

                'Read the specfied record length, without the Control Record, because we already consumed (read) it.
                sr.ReadBlock(chrArray, 0, iRecordLength)

                'Copy Character Array to String Array, Converting in the process, then Join the Array to a string
                sRecord = Join(Array.ConvertAll(chrArray, New Converter(Of Char, String)(AddressOf ChrToStr)), "")

                'If the record length was 0, then the Join method may return Nothing
                If IsNothing(sRecord) = False Then

                    If bIgnoreRecord = True Then
                        'Do nothing - bypass record

                        'Reset flag
                        bIgnoreRecord = False

                    Else
                        'Write the line out, LTrimming the specified number of characters.
                        If sRecord.Length >= miLTrim Then
                            sw.WriteLine(sRecord.Remove(0, miLTrim))

                        Else
                            sw.WriteLine(sRecord.Remove(0, sRecord.Length))

                        End If    ' If sRecord.Length >= miLTrim

                        'Write out the number of blank lines specified by the 3rd control character.
                        For i As Integer = 1 To iLineSpace - 1
                            sw.WriteLine("")

                        Next    'For i As Integer = 1 To iLineSpace

                    End If    'If bIgnoreRecord = True

                    'Obviously, if we have read more characters from the file than the designated size of the block,
                    '   then subtract the number of characters we have read into the next block from the block size.
                    If iConsumedChars > miBlockLength Then
                        'If iConsumedChars > iRecordLength Then
                        iConsumedChars = iConsumedChars - miBlockLength
                        'iConsumedChars = iConsumedChars - iRecordLength

                    End If

                End If    'If IsNothing(sRecord) = False

            End If    'If iRecordLength > 0

            'Allow computer to process  (works in a class module, not in a dll)
            'Application.DoEvents()

        Loop

        'Destroy StreamReader (sr)
        sr.Close()
        sr.Dispose()

        'Destroy StreamWriter (sw)
        sw.Close()
        sw.Dispose()

    End Sub

    ''' <summary>
    ''' Translates 1 EBCDIC Character (Char) to an ASCII String
    ''' </summary>
    ''' <param name="chr"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function ChrToStr(ByVal chr As Char) As String
        Dim sReturn As String = ""

        'Convert character into byte
        Dim EBCDICbyte As Byte() = EBCDICEncoding.GetBytes(chr)

        'Convert EBCDIC byte to ASCII byte
        Dim ASCIIByte As Byte() = Encoding.Convert(EBCDICEncoding, ASCIIEncoding, EBCDICbyte)

        sReturn = Encoding.ASCII.GetString(ASCIIByte)

        Return sReturn

    End Function

    ''' <summary>
    ''' Translates an EBCDIC String to an ASCII String
    ''' </summary>
    ''' <param name="sStringToTranslate"></param>
    ''' <returns>String</returns>
    ''' <remarks></remarks>
    Public Function TranslateString(ByVal sStringToTranslate As String) As String
        Dim i As Integer = 0
        Dim sReturn As New System.Text.StringBuilder()

        'Loop through the string and translate each character
        For i = 0 To sStringToTranslate.Length - 1
            sReturn.Append(ChrToStr(sStringToTranslate.Substring(i, 1)))

        Next

        Return sReturn.ToString()

    End Function

    ''' <summary>
    ''' Translates 1 EBCDIC Character (Char) to an ASCII String
    ''' </summary>
    ''' <param name="sCharacterToTranslate"></param>
    ''' <returns>String</returns>
    ''' <remarks></remarks>
    Public Function TranslateCharacter(ByVal sCharacterToTranslate As Char) As String

        Return ChrToStr(sCharacterToTranslate)

    End Function

    ''' <summary>
    ''' Translates an EBCDIC Character (Char) Array to an ASCII String
    ''' </summary>
    ''' <param name="sCharacterArrayToTranslate"></param>
    ''' <returns>String</returns>
    ''' <remarks>Remarks</remarks>
    Public Function TranslateCharacters(ByVal sCharacterArrayToTranslate As Char()) As String
        Dim sReturn As String = ""

        'Copy Character Array to String Array, Converting in the process, then Join the Array to a string
        sReturn = Join(Array.ConvertAll(sCharacterArrayToTranslate, _
                            New Converter(Of Char, String)(AddressOf ChrToStr)), "")

        Return sReturn

    End Function

    ''' <summary>
    ''' Block Length must be set.  You can set the BlockLength for specific block sizes (Ex:  134).
    ''' Set UseControlRecord = False for files with specific block sizes (Default is True)
    ''' </summary>
    ''' <value>0</value>
    ''' <returns>Integer</returns>
    ''' <remarks></remarks>
    Public Property BlockLength() As Integer
        Get
            Return miBlockLength

        End Get
        Set(ByVal value As Integer)
            miBlockLength = value

        End Set
    End Property

    ''' <summary>
    ''' Determines whether a ControlKey is used to calculate RecordLength of valid data
    ''' </summary>
    ''' <value>Default value is True</value>
    ''' <returns>Boolean</returns>
    ''' <remarks></remarks>
    Public Property UseControlRecord() As Boolean
        Get
            Return mbUseControlRec

        End Get
        Set(ByVal value As Boolean)
            mbUseControlRec = value

        End Set
    End Property

    ''' <summary>
    ''' Ignores first record if set (Default is True)
    ''' </summary>
    ''' <value>Default is True</value>
    ''' <returns>Boolean</returns>
    ''' <remarks></remarks>
    Public Property IgnoreFirstRecord() As Boolean
        Get
            Return mbIgnoreFirstRecord

        End Get

        Set(ByVal value As Boolean)
            mbIgnoreFirstRecord = value

        End Set
    End Property

    ''' <summary>
    ''' Trims the left side of every string the specfied number of characters.  Default is 0.
    ''' </summary>
    ''' <value>Default is 0.</value>
    ''' <returns>Integer</returns>
    ''' <remarks></remarks>
    Public Property LTrim() As Integer
        Get
            Return miLTrim

        End Get

        Set(ByVal value As Integer)
            miLTrim = value

        End Set
    End Property

End Class 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-23T13:11:21.527

EBCDIC 翻译的一些有用链接：

转换表 - 检查压缩十进制字段中的一些值很有用： [http ://www.simotime.com/asc2ebc1.htm](http://www.simotime.com/asc2ebc1.htm)

msdn 中的代码页列表：http:
[//msdn.microsoft.com/en-us/library/dd317756 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd317756(VS.85).aspx)

还有一段代码在 C# 中转换字节数组字段：

```
// 500 is the code page for IBM EBCDIC International 
System.Text.Encoding enc = new System.Text.Encoding(500);
string value = enc.GetString(byteArrayField); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-11T04:13:55.847

EBCDIC 或 ASCII 中的压缩字段相同。不要在它们上运行 EBCDIC 到 ASCII 的转换。在 .Net 中将它们转储到一个字节 [] 中。

您使用按位掩码和移位来打包/解包。-- 但按位运算仅适用于 .Net 中的整数类型，因此您需要跳过一些环节！

优秀的 COBOL 或 C 艺术家可以为您指明正确的方向。

找到一个老家伙并支付你的会费（大约三杯啤酒应该这样做）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-05T22:03:23.840

“ASCII 传输类型”会将文件作为常规文本文件传输。因此，当我们以 ASCII 传输类型传输压缩十进制或二进制数据文件时，文件会损坏。“二进制传输类型”将以二进制模式传输数据，将文件作为二进制数据而不是文本数据处理。所以我们必须在这里使用二进制传输类型。参考：[https ://www.codeproject.com/Tips/673240/EBCDIC-to-ASCII-Converter](https://www.codeproject.com/Tips/673240/EBCDIC-to-ASCII-Converter)

文件准备好后，这里是将压缩十进制转换为人类可读十进制的代码。

```
 using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Text;
    using System.Threading.Tasks;

   namespace ConsoleApp2
   {
    class Program
    {
        static void Main(string[] args)
        {
            var path = @"C:\FileName.BIN.dat";
            var templates = new List<Template>
            {
                new Template{StartPos=1,CharLength=4,Type="AlphaNum"},
                new Template{StartPos=5,CharLength=1,Type="AlphaNum"},
                new Template{StartPos=6,CharLength=8,Type="AlphaNum"},
                new Template{StartPos=14,CharLength=1,Type="AlphaNum"},
                new Template{StartPos=46,CharLength=4,Type="Packed",DecimalPlace=2},
                new Template{StartPos=54,CharLength=5,Type="Packed",DecimalPlace=0},
                new Template{StartPos=60,CharLength=4,Type="Packed",DecimalPlace=2},
                new Template{StartPos=64,CharLength=1,Type="AlphaNum"}
            };

            var allBytes = File.ReadAllBytes(path);
            for (int i = 0; i < allBytes.Length; i += 66)
            {
                var IsLastline = (allBytes.Length - i) < 66;
                var lineLength = IsLastline ? 64 : 66;
                byte[] lineBytes = new byte[lineLength];
                Array.Copy(allBytes, i, lineBytes, 0, lineLength);

                var outArray = new string[templates.Count];
                int index = 0;
                foreach (var temp in templates)
                {
                    byte[] amoutBytes = new byte[temp.CharLength];
                    Array.Copy(lineBytes, temp.StartPos - 1, amoutBytes, 0, 
    temp.CharLength);
                    var final = "";
                    if (temp.Type == "Packed")
                    {
                        final = Unpack(amoutBytes, temp.DecimalPlace).ToString();
                    }
                    else
                    {
                        final = ConvertEbcdicString(amoutBytes);
                    }

                    outArray[index] = final;
                    index++;

                }

                Console.WriteLine(string.Join(" ", outArray));

            }

            Console.ReadLine();
        }

        private static string ConvertEbcdicString(byte[] ebcdicBytes)
        {
            if (ebcdicBytes.All(p => p == 0x00 || p == 0xFF))
            {
                //Every byte is either 0x00 or 0xFF (fillers)
                return string.Empty;
            }

            Encoding ebcdicEnc = Encoding.GetEncoding("IBM037");
            string result = ebcdicEnc.GetString(ebcdicBytes); // convert EBCDIC Bytes -> 
    Unicode string
            return result;
        }

        private static Decimal Unpack(byte[] inp, int scale)
        {
            long lo = 0;
            long mid = 0;
            long hi = 0;
            bool isNegative;

            // this nybble stores only the sign, not a digit.  
            // "C" hex is positive, "D" hex is negative, AlphaNumd "F" hex is unsigned. 
            var ff = nibble(inp, 0);
            switch (ff)
            {
                case 0x0D:
                    isNegative = true;
                    break;
                case 0x0F:
                case 0x0C:
                    isNegative = false;
                    break;
                default:
                    throw new Exception("Bad sign nibble");
            }
            long intermediate;
            long carry;
            long digit;
            for (int j = inp.Length * 2 - 1; j > 0; j--)
            {
                // multiply by 10
                intermediate = lo * 10;
                lo = intermediate & 0xffffffff;
                carry = intermediate >> 32;
                intermediate = mid * 10 + carry;
                mid = intermediate & 0xffffffff;
                carry = intermediate >> 32;
                intermediate = hi * 10 + carry;
                hi = intermediate & 0xffffffff;
                carry = intermediate >> 32;
                // By limiting input length to 14, we ensure overflow will never occur

                digit = nibble(inp, j);
                if (digit > 9)
                {
                    throw new Exception("Bad digit");
                }
                intermediate = lo + digit;
                lo = intermediate & 0xffffffff;
                carry = intermediate >> 32;
                if (carry > 0)
                {
                    intermediate = mid + carry;
                    mid = intermediate & 0xffffffff;
                    carry = intermediate >> 32;
                    if (carry > 0)
                    {
                        intermediate = hi + carry;
                        hi = intermediate & 0xffffffff;
                        carry = intermediate >> 32;
                        // carry should never be non-zero. Back up with validation
                    }
                }
            }
            return new Decimal((int)lo, (int)mid, (int)hi, isNegative, (byte)scale);
        }

        private static int nibble(byte[] inp, int nibbleNo)
        {
            int b = inp[inp.Length - 1 - nibbleNo / 2];
            return (nibbleNo % 2 == 0) ? (b & 0x0000000F) : (b >> 4);
        }

        class Template
        {
            public string Name { get; set; }
            public string Type { get; set; }
            public int StartPos { get; set; }
            public int CharLength { get; set; }
            public int DecimalPlace { get; set; }
        }
    }
   } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-11T13:17:37.030

文件必须以二进制形式传输。这是一个更短的方法：

```
using System.Linq;

namespace SomeNamespace
{
    public static class SomeExtensionClass
    {
        /// <summary>
        /// computes the actual decimal value from an IBM "Packed Decimal" 9(x)v9 (COBOL) format
        /// </summary>
        /// <param name="value">byte[]</param>
        /// <param name="precision">byte; decimal places, default 2</param>
        /// <returns>decimal</returns>
        public static decimal FromPackedDecimal(this byte[] value, byte precision = 2)
        {
            if (value.Length < 1)
            {
                throw new System.InvalidOperationException("Cannot unpack empty bytes.");
            }
            double power = System.Math.Pow(10, precision);
            if (power > long.MaxValue)
            {
                throw new System.InvalidOperationException(
                    $"Precision too large for valid calculation: {precision}");
            }
            string hex = System.BitConverter.ToString(value).Replace("-", "");
            var bytes = Enumerable.Range(0, hex.Length)
                     .Select(x => System.Convert.ToByte($"0{hex.Substring(x, 1)}", 16))
                     .ToList();
            long place = 1;
            decimal ret = 0;
            for (int i = bytes.Count - 2; i > -1; i--)
            {
                ret += (bytes[i] * place);
                place *= 10;
            }
            ret /= (long)power;
            return (bytes.Last() & (1 << 7)) != 0 ? ret * -1 : ret;
        }
    }
} 
```

# open-source - 如何处理您的旧应用程序

> ID：142975
> 
> 赞同：11
> 
> 时间：2008-09-27T04:23:44.907
> 
> 标签：open-source

我有许多旧的应用程序，我不太可能做任何进一步的工作，但可能对其他人非常有用（两个例子是数独生成器/求解器和一个易于使用的汇编器/图形仿真器工具）中央处理器）。

有人对我应该如何处理它们有任何想法吗？我已经想到了明显的“开始一个 sourceforge 项目”，但我怀疑如果我不积极维护它，它会很快死去。

我愿意接受任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-27T04:33:08.973

把它们作为公共项目放在[Github](http://www.github.com)上，看看反应如何。你可能对 Github 比对 sourceforge 更感兴趣，因为项目较少，而且我认为更多人喜欢浏览 Github 上的可用项目。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-27T04:54:36.050

一个免费的网站（geocities 等）上传它们并添加一些信息可能是你最好的选择。

找一些不需要维护的东西，你只需上传你想要的文件，加上标题和描述（以便搜索引擎找到它们），然后让你忘记它们。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-27T05:39:47.457

像其他人建议的那样免费发布它们可能是最无私的做法，并且确实有利于为您提供良好的新闻......如果应用程序足够成熟以至于出现严重错误的机会很低，或者如果您如果出现错误，打算实际上仍然支持它。对于这种特定情况，免费提供可能是最好的，虽然不是，可能不在 sourceforge 上，而不是在另一个不受支持的项目上。

您对旧应用程序所做的最重要的事情就是**向它们学习**。做事后分析，写下你做对了什么，你做错了什么，你会做哪些不同的事情。特别重要的是那些让你抓到的东西，有趣的困难错误，或者任何反复引起麻烦的东西。你可能永远不会再写一段类似的代码，但你可能会遇到相同类型的错误 50 次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T04:27:04.777

如果您认为它确实有用，那么创建一个小型网站或为它或其他东西，使用 www.spruz.com 或 .net 让自己成为一个蹩脚的免费网站我不太确定，如果您附加了这些程序。或者，如果您确实想维护它，请创建一个 sourceforge 项目。但如果它没有任何用处，我怀疑它是否真的会被使用。

# visual-c++ - VisualC++ 6.0 中“调试”和“发布”构建配置的不同依赖项设置

> ID：142996
> 
> 赞同：2
> 
> 时间：2008-09-27T04:34:22.637
> 
> 标签：visual-c++, configuration, dependencies, visual-c++-6

我正在使用 VisualC++ 6.0。（而且，是的，我正在使用 Mosaic 浏览器..；）我的 VC++ 项目对“调试”和“发布”构建配置具有不同的依赖项设置。因此，当我从一种配置切换到另一种配置时，我每次都必须手动更改依赖关系。有没有更好的方法来做到这一点？我可以根据每个配置保留我的依赖项设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T20:52:52.390

您正在处理哪个依赖项？

在构建下，有一个用于调试/发布/两者的配置。

如果您可以提供更多详细信息，我可能会提供帮助。*******