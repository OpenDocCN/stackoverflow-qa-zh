# StackOverflow 问答 000340000-000340999

# search - 免费的谷歌词频数据库？

> ID：340001
> 
> 赞同：9
> 
> 时间：2008-12-04T09:20:16.737
> 
> 标签：search, word-frequency

在本周的 Stackoverflow 播客中，Jeff 提到，他在 2004 年编写了一个脚本，该脚本用 110,000 个英文单词查询 Google，并收集了一个包含每个单词的命中数的数据库。他们在 Stackoverflow 上使用它，例如每个问题页面右侧的“相关”列表。

由于今天用类似的脚本创建其中一个会很困难（正如 Joel 提到的，“在 30,000 字时，你会敲门”），我想知道是否有人知道一个更新的、免费的数据库谷歌词频（例如，从那时起肯定发生变化的 IT 词，如 jquery、ruby、azure 等）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T09:26:08.583

一个快速的谷歌搜索（！）出现了一些点击。这个[链接](http://ucrel.lancs.ac.uk/bncfreq/flists.html)看起来很有希望：

但它并不针对 IT 词。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T11:52:04.327

回答这个问题可能已经晚了，但我可以用不同的方式给你建议。而不是从谷歌获得“点击数”来自己计算一些近似值。获取大量文本页面（语料库）并计算其中每个单词的数量。我已经通过维基百科做到了这一点。所有维基页面都有一个转储。您只需要编写一个解析器来提取文本并计算单词。结果是一个超过 110K 单词的列表（至少 2M-3M）。如果您确实需要 Google 搜索结果中的数字，您可以获取一些单词样本并查询 Google，然后对计算值进行一些标准化以匹配 Google 值。我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T15:11:56.850

根据 Google 的说法，每个 IP 每天可以发送 50,000 个查询。我真的不认为在你的朋友之间分享它是非法的..

对于每个 IP 每天的查询，我遇到了类似的问题，但我们用完全不同的方法解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T15:09:19.663

您可以在您的朋友/同事之间拆分列表并使用足够大的超时，这样每个 IP 每天的请求数不会超过 50,000 个，然后合并结果。我不确定这种方法的合法性，但谷歌人使用这种方法“敲门”的可能性非常低。

**注**：根据斯库塔提供的数据编辑

# c++ - JavaScript 和 VBScript 中与 GetObject 等效的 C++ 是什么？

> ID：340003
> 
> 赞同：0
> 
> 时间：2008-12-04T09:21:13.633
> 
> 标签：c++, winapi, com, vbscript, wsh

[JavaScript](http://en.wikipedia.org/wiki/JavaScript)和[VBScript](http://en.wikipedia.org/wiki/VBScript)`GetObject`中的 C++ 等价物是什么？

我发现与我的问题最接近的匹配是：

[http://codewiz51.blogspot.com/2008/06/vb-script-getobject-c-api-cogetobject.html](http://codewiz51.blogspot.com/2008/06/vb-script-getobject-c-api-cogetobject.html)

但是，该示例使用不存在的接口并要求`IUnknown`返回 null。有人有一个有效的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T10:14:45.380

我弄清楚了这个问题。我想访问的对象是

`winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv`

我错误地将 \\ 作为擒纵装置。在 C++ 中，正确的查询是：

`::CoGetObject(L"winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\default:StdRegProv", NULL, IID_IUnknown, (void**)&pUnk);`

谢谢 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T09:33:19.160

您链接到的文章是正确的。您可能提供了错误的接口 ID，或者显示名称可能是错误的。您应该检查`CoGetObject`调用的返回值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T09:45:59.837

如果请求 IUnknown 返回 NULL，则没有该名称的对象。每个 COM 对象都实现 IUnknown。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T09:53:23.317

在进行任何 COM 调用之前，您是否初始化了 COM？

查找 CoInitializeEx。

# xml - 从脚本生成 XML 文件

> ID：340007
> 
> 赞同：0
> 
> 时间：2008-12-04T09:23:09.087
> 
> 标签：xml, performance, vbscript

我最近有一个理由在我们的构建脚本中包含一个 XML 配置文件的创建。我能想到的最直接的方法是将 XML 内容作为字符串硬编码到脚本中，然后简单地创建一个文件并将该 XML 字符串写入文件（适当命名等）。有没有更优雅或更有效的方法来做到这一点？

我要修改的构建脚本是用 VBScript 编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T10:16:32.333

您可以使用 XmlWriter 来避免打印字符串。这将使编写格式良好的 XML 文档变得容易得多。

您可以在此处找到 VBScript 中的免费示例代码

> [http://www.matthewflickinger.com/lab/xmlwriter/](http://www.matthewflickinger.com/lab/xmlwriter/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T09:29:11.993

如果您考虑字符串，请阅读非常重要的内容：[如何在生成 XML 时避免被称为 Bozo](http://hsivonen.iki.fi/producing-xml/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T07:37:08.143

我的最终解决方案：改编了 divo 提到的 XMLWriter（几乎原样使用它，除了一两个更改，因为该脚本将在客户端上运行）。还调整了[此处](http://guruj.net/node/62)的代码以漂亮地打印 XML（以便在输出到文件时可以读取）：

```
Function XMLToString(Nodes)
  dim retStr
  retStr = "<?xml version=""1.0"" encoding=""utf-8"" ?>"
  XMLToString = retStr & vbNewLine & NodesToString(Nodes, 0)
End Function

Function NodesToString(Nodes, Indent)
   Dim xNode
   Dim retStr

   retStr = ""
   For Each xNode In Nodes
      Select Case xNode.nodeType
        Case 1:   ' NODE_ELEMENT
          If xNode.nodeName <> "#document" Then
            ' change DisplayAttrs_(xNode, Indent + 2) to 
            ' DisplayAttrs_(xNode, 0) for inline attributes
            retStr = retStr & VBNewLine & strDup(" ", Indent)  & "<" & xNode.nodeName & AttributesToString(xNode) & ">"
            If xNode.hasChildNodes Then
              retStr = retStr & NodesToString(xNode.childNodes, Indent + 2)
            End If
            retStr = retStr & VBNewLine & strDup(" ", Indent) & "</" & xNode.nodeName & ">"
          Else 
            If xNode.hasChildNodes Then
              retStr = retStr & NodesToString(xNode.childNodes, Indent + 2)
            End If
          End If
        Case 3:   ' NODE_TEXT                       
          retStr = retStr & VBNewLine & strDup(" ", Indent) & xNode.nodeValue
      End Select
   Next

   NodesToString = retStr
End Function

Function AttributesToString(Node)
   Dim xAttr, res

   res = ""
   For Each xAttr In Node.attributes
        res = res & " " & xAttr.name & "=""" & xAttr.value & """"
   Next

   AttributesToString = res
End Function

Function strDup(dup, c)
  Dim res, i

  res = ""
  For i = 1 To c
    res = res & dup
  Next
  strDup = res
End Function 
```

# c# - C# 控制台应用程序都是 16 位的？

> ID：340010
> 
> 赞同：1
> 
> 时间：2008-12-04T09:24:09.087
> 
> 标签：c#, console-application, 16-bit, ntvdm.exe

当我构建一个快速测试控制台应用程序时，我正在阅读有关 NTVDM.exe 的信息，它在抱怨这个 EXE 的朋友机器上崩溃了。

据我了解，所有 DOS cmd 窗口（包括 C# 控制台应用程序）都以 16 位而不是 32 位运行。

这是真的？这是否意味着我所有的工作控制台应用程序后台应用程序都以 16 位运行，而不是充分利用 32 位？

Windows 服务呢？我相信我们将其编写为控制台应用程序，然后使其作为 Windows 服务运行？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T09:29:08.703

任何为 x86 编译的 .NET 应用程序都是 32 位的

C# 控制台应用程序不是在“真正的”dos 中运行 - 它们在 32 位或 64 位环境中运行 - 取决于您的操作系统和 .NET 框架。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T09:33:19.753

> 据我了解，所有 DOS cmd 窗口（包括 C# 控制台应用程序）都以 16 位而不是 32 位运行。
> 
> 这是真的？

一点都不。

您可以在 Windows 下运行 DOS 应用程序，它们是 16 位的，但它们看起来有点像控制台的事实几乎只是巧合。

没有 16 位 .NET 应用程序，应用程序是否为控制台模式与它是 16 位还是 32 位没有区别。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-25T08:28:16.483

MS-DOS 应用程序在 ntvdm 下作为 16 位应用程序运行。

“Windows 控制台”应用程序不是 DOS 应用程序，并且作为本机 Windows 进程运行（EXE 文件的 PE 标头中的位将其标识为控制台应用程序，以便 Windows 可以为应用程序创建/准备 Windows 控制台，如果一个不存在的，例如从 CMD 或 PowerShell 运行控制台应用程序将重新使用已创建的控制台窗口，而在资源管理器中双击 EXE 将为应用程序创建一个新的控制台窗口。）

CMD != DOS

Windows 控制台！= DOS

同样，至少从 Windows 2000 (NT5) 开始，Windows 中就有一个完整的 Windows 控制台 API，如果不是更早的话（尽管可能只有 NT3/4。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T09:30:09.307

.NET 控制台应用程序。（或任何其他 .NET 应用程序）将作为其 JIT 的目标硬件运行。所以对于 x86，它将是 32 位的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T09:33:54.417

> 据我了解，所有 DOS cmd 窗口（包括 C# 控制台应用程序）都以 16 位而不是 32 位运行。

你错了。所有 cmd.exe Windows 都是 32 位或 64 位，具体取决于体系结构。

DOS 大约在十年前与 Windows ME 一起消亡。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T09:33:57.553

我不知道任何能够在 16 位模式下运行的 .NET VM 实现。Microsoft .NET 运行时和 Mono 都只有 32/64 位。我不知道其他较小的，但如果它们可以在 16 位模式下工作，我会感到惊讶。

此外，cmd.exe 以 32 位模式运行，因为 cmd.exe 是 32 位 Windows 应用程序。另一方面，command.com 以 16 位模式运行。

实际上，控制台应用程序远非天生就是 16 位的。这根本不是真的，在 Windows 之前甚至都不是真的，因为 x86 保护模式是 32 位的，所以任何在移植模式下运行的 DOS 游戏或应用程序都是 32 位的。

在 .NET 中，您的 UI 类型（或在 Windows 服务中缺少 UI）不会影响应用程序的字长。默认情况下，.NET 二进制文件是独立于平台的，并且根据主机的 .NET Framework、内核等类型作为 32 位或 64 位应用程序执行。尽管它们也可以直接编译为 64 位。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T09:33:29.003

控制台 exe 没有什么特别之处；它只是一个PE文件。因此，无论控制台、winform exe 还是 windows 服务，它都只会以编译的任何模式运行。

Visual Studio 等永远不会生成 16 位 exe。x86 与 x64 更有趣；-p

可能您的朋友没有安装 .NET 框架（或只有 1.1）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T12:30:01.630

即使在 DOS 下，“.EXE”也可以是 16 位或 32 位（使用适当的编码或 DOS 扩展库）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T01:22:54.550

NTVDM.EXE 是 DOS 仿真器，支持在可以假定 CPU 为 16 位且 DOS 系统调用可用的环境中运行 16 位`.COM`和文件。`.EXE`它与命令提示的唯一关联是文本模式 DOS 程序使用控制台窗口来提供文本模式下的 VGA 屏幕模拟。

如前所述，没有可以在 DOS 下运行的 .NET VM。然而，从 Mono 项目源代码开始并构建一个在 FreeDOS 下运行的项目可能会很有趣......只是为了吓唬你的朋友 ;-)

# mysql - MySQL - 如何在 WHERE x IN ( )

> ID：340020
> 
> 赞同：8
> 
> 时间：2008-12-04T09:28:50.200
> 
> 标签：mysql, indexing, subquery

我正在使用此查询来获取 {clients 的所有员工，其名称以小写“a”开头}：

```
SELECT * FROM employees 
  WHERE client_id IN (SELECT id FROM clients WHERE name LIKE 'a%') 
```

Column`employees.client_id`是一个 int，带有`INDEX client_id (index_id)`. 恕我直言，子查询应该返回一个 id-s 列表，然后在 WHERE 子句中使用。

当我`EXPLAIN`查询时，主查询不使用索引（`type:ALL`）。但是，当我`EXPLAIN` 从子查询（例如`SELECT ... WHERE client_id IN (121,184,501)`）中获取一个列表时，`EXPLAIN`切换到`type:range`，并且该查询的速度提高了 50%。

如何使查询使用子查询返回的数据的索引 - 或者，是否有更有效的方法来检索这些数据？（将 id-list 检索到应用程序服务器，加入它并发送第二个查询在这里更加昂贵）。

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T09:32:48.537

```
SELECT employees.*
FROM   employees, clients
WHERE  employees.client_id = clients.id
AND    clients.name LIKE 'a%'; 
```

应该更快，因为优化器可以选择最有效的计划。在使用子查询以您的方式编写它时，您是在强制它按特定顺序执行这些步骤，而不是让它选择最佳连接顺序。

作为一般规则，应避免子查询，因为它们的性能通常低于连接查询（尽管在某些情况下它们是不可避免的）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-04T09:33:14.980

您是否尝试过使用 a`JOIN`而不是 subselectect 来做到这一点？

```
SELECT employees.* FROM employees, clients WHERE employees.client_id = clients.id  AND clients.name LIKE 'a%'; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-22T02:54:58.713

有关原因的具体解释

```
SELECT * FROM employees WHERE client_id IN (SELECT id FROM clients WHERE name LIKE 'a%') 
```

比

```
SELECT * FROM employees WHERE client_id IN (1,2,3,4) 
```

查看 MySQL 手册的这一部分，特别是第三个点：[http](http://dev.mysql.com/doc/refman/5.0/en/subquery-restrictions.html) ://dev.mysql.com/doc/refman/5.0/en/subquery-restrictions.html 。另外，这个[错误报告](http://bugs.mysql.com/bug.php?id=9090)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T12:12:07.687

值得指出的是，连接性能优于子查询并不适用于每个 DBMS。它确实适用于 MySQL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T13:23:53.533

```
SELECT e.*  
FROM employees e  
WHERE EXISTS (   
  SELECT 1    
  FROM clients c  
  WHERE c.id = e.client_id   
  AND c.name LIKE 'a%'
) 
```

**您可以使用EXISTS**重写查询。在 MySQL 中，它肯定会提高性能。如需更多优化帮助，您可以参考：[MySQL-In-Query-Optimization](http://dev.mysql.com/doc/refman/5.0/en/in-subquery-optimization.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T12:17:16.617

```
select * from X as _x where 
  exists(select * from Y as _y where _y.someField = _x.someField) 
```

应该为您解决问题；）

# forms - Firefox 操作保存的表单数据

> ID：340030
> 
> 赞同：8
> 
> 时间：2008-12-04T09:32:53.280
> 
> 标签：forms, firefox

是否有用于操作和删除已保存表单数据的 Firefox 插件？在浏览器中，只有删除所有数据的选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-17T08:24:49.000

[表单历史控件](https://addons.mozilla.org/en-US/firefox/addon/12021)可以满足您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T09:42:52.887

您可以使用[SQLite Manager](http://code.google.com/p/sqlite-manager/)直接访问表单历史数据库。只需选择配置文件`formhistory.sqlite`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T16:52:40.503

I am using FFv 3.0.4.

Using Tools -> Clear Private Data, invoke a pop-up.

From the pop-up dialog, you can decide what to clear

[] Browsing History [] Download History [] Saved Form and Search History <------ you are interested in this [] Cache [] Cookies [] Offline Saved data [] saved password [] authenticated session

hope this ans your question

# c# - RadioButtonList 使用的最佳设计

> ID：340043
> 
> 赞同：0
> 
> 时间：2008-12-04T09:39:05.280
> 
> 标签：c#, asp.net, radiobuttonlist, correctness

我有一个问题，我想学习解决这个问题的正确方法。

我有一个数据对象

```
class LinkHolder {
    public string Text;
    public string Link;
} 
```

我想向用户展示一个使用 LinkHolder.Text 值作为描述性文本的 RadioButton 列表。然后在回发时，我想做一个

```
Server.Transfer( LinkHolder.Link ) 
```

在相应的链接上。

我不确定最好/最正确的方法是什么。任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T10:14:46.847

您需要在 RadioButtonList 上设置 DataTextField 和 DataValueField。然后应该显示正确的值。

您可以尝试将 selectedItem 转换为 LinkHolder。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T10:01:57.700

你的方法应该有效。我认为您应该在课堂上使用访问器

```
class LinkHolder {
    public string Text { get; set;}
    public string Link { get; set;}
} 
```

将 RadioButtonList 绑定到 f.ex。`List<LinkHolder>`

为什么要使用单选按钮列表，而不是仅将链接列为超链接，而不必使用 Server.Transfer？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T10:08:00.980

类 LinkHolder 只是一个简短的示例。我确实在真正的班级中有访问者。单选按钮是一种设计选择，所以我会选择它们。

`List<LinkHolder>`在我的测试中，当我用作数据源时，它将打印类的名称，而不是文本属性。我不知道如何/是否可以指定 RadioButtonList 应该打印的属性。

这也是我的理解，如果我`List<LinkHolder>`用作数据源，当我请求 SelectedItem 时，我不会得到 LinkHolder 对象。相反，我会得到一个 ListItem。

有什么好的解决方法吗？

# asp.net - EnableViewstate = 真/假

> ID：340046
> 
> 赞同：3
> 
> 时间：2008-12-04T09:39:54.873
> 
> 标签：asp.net

我们为 ASP.net 中的所有服务器控件提供了 enableviewstate 属性。我们知道它会在跨回发的视图状态中拥有成员数据和值

实际的例子是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T12:07:23.187

Viewstate 在 ASP.NET 中的目的确实是跨回发保持状态，其中状态是构成 Web 窗体控件层次结构的控件的属性值。但是有必要区分不同类型的状态。

您在设计时以声明方式分配给控件的任何内容**都不**需要跨回发保留在视图状态中。例如，想象一个具有以下声明性语法的 Label Web 控件：

```
<asp:Label runat="server" Font-Name="Verdana" Text="Hello, World!"></asp:Label> 
```

在实例化阶段构建控件层次结构时，Label 的 Text 属性将设置为“Hello, World!” 并且它的 Font 属性将其 Name 属性设置为 Verdana。由于这些属性是在实例化阶段的每次页面访问中设置的，因此无需在视图状态中保留此信息。

需要存储在视图状态**中**的是对页面状态的任何编程更改。例如，假设除了这个 Label Web 控件之外，页面还包含两个 Button Web 控件，一个 Change Message Button 和一个 Empty Postback 按钮。Change Message Button 有一个 Click 事件处理程序，它将 Label 的 Text 属性分配给“Goodbye, World!”。Empty Postback Button 只会导致回发，但不执行任何代码。更改消息按钮中对标签文本属性的更改需要保存在视图状态中。

简单的控件属性，如标量值、字符串、整数、布尔值等，都遵循上面讨论的模式。但请注意，复杂的属性（例如 Label 的 Font 属性）使用不同的方法。

[您可以在这篇有用的 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms972976.aspx)中找到更多详细信息和示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T09:52:45.487

例如，数据网格控件会将所有数据绑定数据存储在其视图状态中，以便在回发后不会从其源（DB 等）重新加载数据。但是，所有数据都会在视图状态中经过回发，这可能会影响页面的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T10:35:00.113

检查控件的任何示例。要查看效果，请将 enableviewstate 设置为 true/false... 您将看到它的效果

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T09:47:49.240

我不完全理解这个问题，但[这篇文章](http://msdn.microsoft.com/en-us/library/ms972976.aspx)帮助我更好地理解 ViewState - 希望它对你有用......

# c# - Vista - GetForegroundWindow 不返回正确的进程 ID，而是返回父进程 ID

> ID：340049
> 
> 赞同：1
> 
> 时间：2008-12-04T09:41:45.930
> 
> 标签：c#, windows-vista

当我从 c# 调用 GetForegroundWindow 时，我得到的是资源管理器父进程 ID（我从进程资源管理器中看到了这个），而不是前台应用程序的进程 ID。

为什么会这样以及如何获得正确的进程 ID？

马尔科姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T10:55:32.647

API 函数 GetForegroundWindow 为您提供顶部窗口的句柄，而不是进程 ID。那么，您还使用哪些其他函数从您从 GetForegroundWindow 获得的窗口句柄中获取进程 ID？

这将为您提供前景窗口的窗口句柄：

```
 [DllImport("user32", SetLastError = true)]
    public static extern int GetForegroundWindow(); 
```

这将为您提供给定窗口句柄的进程 ID（taskmgr 中的 PID）：

```
 [DllImport("user32", SetLastError = true)]
    public static extern int GetWindowThreadProcessId(int hwnd, ref int lProcessId);

    public static int GetProcessThreadFromWindow(int hwnd) {
        int procid = 0;
        int threadid = GetWindowThreadProcessId(hwnd, ref procid);
        return procid;
    } 
```

如果您回复您的问题，那就太好了，因此它在这个论坛上有一些价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T09:56:04.077

不确定这里发生了什么，但您是否尝试过以管理员身份运行您的应用程序？现在对非管理员应用程序能够在系统的其余部分看到的内容有很多限制。

# c++ - 为 OSI 第 2 层流量生成器寻找 OSS

> ID：340071
> 
> 赞同：1
> 
> 时间：2008-12-04T09:53:05.033
> 
> 标签：c++, c, networking, osi

我正在寻找第 2 层流量生成器 [开源]。

一些OSS使用winpcap或libpcap。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T10:09:32.210

*   [斯卡皮](http://secdev.org/projects/scapy)
*   [比特扭曲](http://bittwist.sourceforge.net)
*   任何来自 perl 的 Net::Pcap、python 或 ruby​​ 的 pcap 接口...

# wcf - 如何：响应式可用 Wcf 双工通信

> ID：340085
> 
> 赞同：2
> 
> 时间：2008-12-04T09:59:32.510
> 
> 标签：wcf, communication, soa, duplex

我正在开发一个使用 WCF 在服务器和客户端之间进行通信的应用程序服务器具有不断变化的服务数量，以及一个主服务，客户端可以查询有关其他服务的信息，然后使用来自主服务的信息订阅他们想要的服务.

主服务向订阅的客户端发送通知，当子服务更改（添加、删除等）时，子服务也每隔几秒发送一次通知。

这听起来像是使用 WCF 回调通道的绝佳机会，但是，它们需要您使用会话。此外，在向客户端发送通知时，当任何客户端不光彩地断开连接时，服务会挂起，试图通知它。即使超时，一段时间后，在此期间没有其他客户端得到通知，这是不可接受的，因为客户端实际上是用于监控子服务后面的应用程序的 GUI。也不能为此使用 MSMQ，因为服务需要立即知道发送操作何时不成功。

我想出的解决方案是使用 http 绑定（发送不成功时立即知道）并在客户端上创建显式回调服务，但这需要我编写很多难看的基础设施代码。

所以，我的问题是：有没有更好的方法来使用 WCF 做到这一点。最好看的选择是回调合同，因为这使我无需手动管理回调服务，只要它在尝试发送到下一个客户端之前不能等待来自一个客户端的确认。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T15:18:38.373

我有一个类似的环境（没有动态服务），并且在客户端通道出现故障时遇到了非常类似的问题。我想出的第一个解决方案是将回调包装在 try/catch 语句中，并在出现问题时删除有问题的客户端，但这有问题并且看起来根本不会扩展。

我最终采用的解决方案是使用委托事件处理程序并使用 BeginInvoke 调用它。如果您还没有查看过[CodeProject：WCF/WPF 聊天应用程序 (Chatters)](http://www.codeproject.com/KB/WCF/WCFWPFChat.aspx)解决方案，我建议您查看一下。

当用户登录时，会创建一个事件处理程序并将其添加到主事件中：

```
public bool Login() 
{
    ...
    _myEventHandler = new ChatEventHandler(MyEventHandler);
    ChatEvent += _myEventHandler;
    ...
} 
```

每当需要广播消息时，都会异步调用事件处理程序：

```
private void BroadcastMessage(ChatEventArgs e)
{
    ChatEventHandler temp = ChatEvent;
    if (temp != null)
    {
        foreach (ChatEventHandler handler in temp.GetInvocationList())
        {
            handler.BeginInvoke(this, e, new AsyncCallback(EndAsync), null);
        }
    }
} 
```

当返回返回时，结果会被处理，如果发生了不好的事情，该通道的事件处理程序将被删除：

```
private void EndAsync(IAsyncResult ar)
{
    ChatEventHandler d = null;
    try
    {
        //get the standard System.Runtime.Remoting.Messaging.AsyncResult,and then
        //cast it to the correct delegate type, and do an end invoke
        System.Runtime.Remoting.Messaging.AsyncResult asres = (System.Runtime.Remoting.Messaging.AsyncResult)ar;
        d = ((ChatEventHandler)asres.AsyncDelegate);
        d.EndInvoke(ar);
    }
    catch(Exception ex)
    {
        ChatEvent -= d;
    }
} 
```

[上面的代码是从Sacha Barber](http://www.codeproject.com/script/Membership/Profiles.aspx?mid=569009)发布的 WCF/WPF 聊天应用程序中修改的（稍微）。

# c# - 让 C# 算法更高效

> ID：340090
> 
> 赞同：2
> 
> 时间：2008-12-04T10:03:49.443
> 
> 标签：c#, algorithm, performance

我有一个 C# 方法，可以将一个数字的值从一个区间投影到一个目标区间。
**例如：**我们有-1000和9000的区间，值为5000；如果我们想将此值投影到 0..100 的区间，我们得到 60。

这是方法：

```
/// <summary>  
/// Projects a value to an interval
/// </summary>
/// <param name="val">The value that needs to be projected</param>  
/// <param name="min">The minimum of the interval the value comes from</param>  
/// <param name="max">The maximum of the interval the value comes from</param>  
/// <param name="intervalTop">The minimum of the interval the value will 
/// be projected to</param>  
/// <param name="intervalBottom">The maximum of the interval the value will 
/// be projected to</param>  
/// <returns>Projected value</returns> 
public decimal ProjectValueToInterval(decimal val,  
                                      decimal min,  
                                      decimal max,  
                                      decimal intervalBottom, 
                                      decimal intervalTop)  
{  
    decimal newMin = Math.Min(0, min);
    decimal valueIntervalSize = Math.Abs(max - newMin);
    decimal targetIntervalSize = Math.Abs(intervalTop - intervalBottom);

    decimal projectionUnit = targetIntervalSize / valueIntervalSize;

    return (val * projectionUnit) + Math.Abs((newMin * projectionUnit));
} 
```

需要为数千个值调用此方法。
我想知道在 C# 中是否有更有效的方法来做到这一点？如果是，您建议进行哪些更改？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T10:13:02.140

只有数千个值？你真的需要进一步优化吗？我无法想象它目前实际上是一个瓶颈。您是否对应用程序进行了分析以检查这是否真的是一个问题？

鉴于该方法是 O(1)，您不会进行通常针对的最激烈的优化——提高复杂性。

话虽如此 - 当你调用它数千次时，是否有任何值保持不变？例如，您是否重复使用相同的最小值和最大值？如果是这样，您可以创建一个类，该类在构造函数中采用这些值并预先计算它所能做的，然后有一个方法采用其余参数。这会稍微改善一些情况，但我会回到我原来的观点——只有在它确实引起问题时才担心这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T10:06:43.837

答案是：不要使用小数进行快速运算。

有什么理由为什么 float 或 double 对你不起作用？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-04T10:29:02.980

只是数学。你“投射”的是范围 AB 和 A'-B' 的标准化，这样：

比率 r = (xA) / (BA) = (yA') / (B'-A')

使用您的条款是：

(val-min) / (max-min) = (returnValue-intervalBottom) / (intervalTop-intervalBottom)

它将 returnValue 解决为：

```
returnValue =  ((intervalTop-intervalBottom) * (val-min) / (max-min)) + intervalBottom 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T10:11:34.483

除了像已经建议的那样不使用 Decimal 之外，您还可以在其他地方清理您的 max/min 值，这样您就不需要到处都需要所有这些 Abs 调用。

我怀疑你需要*重复*做的只有一部分是浮点乘法，然后（或继续）浮点加法。其他一切都可以预先检查和预先计算。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T10:26:58.397

你的代码看起来比它真正需要的更复杂。公式为：

```
intervalTop + (intervalBottom - intervalTop) * (val - min) / (max - min); 
```

这比您的版本简单得多（并且适用于整数类型）。那里没有条件分支（Math.Min 调用）或方法调用。好的，它假设 intervalTop < intervalBottom 和 min < max。如果 intervalTop、intervalBottom、min 和 max 对于一组值是恒定的，那么您可以预先计算 (intervalBottom - intervalTop) 和 (max - min) 并将这些结果用于对函数的所有调用。您可以消除的另一个开销是将函数内联到调用循环中。我不知道 C#（或者更确切地说是 JIT 编译器）对内联方法做了什么，所以这可能已经在幕后发生了。

如果您可以使用整数或浮点数据类型，一种可能的解决方案是使用 SIMD，但这意味着编写本机汇编代码可能会破坏您的要求。

# .net - IronPython 中的代理对象

> ID：340093
> 
> 赞同：1
> 
> 时间：2008-12-04T10:06:01.200
> 
> 标签：.net, python, ironpython

我正在尝试在 IronPython 中创建一个代理对象，它应该动态呈现底层结构。代理本身不应该有任何功能和属性，我试图在运行时捕获所有调用。捕获函数调用很容易，我只需要为我的对象定义**getattr** () 函数，并检查底层是否存在适当的函数，并返回一些类似函数的对象。

我的属性有问题 - 我不知道如何区分调用上下文，我的属性是被称为左值还是右值：

o = myproxy.myproperty #*我需要调用underlying.myproperty_get()*

或者

myproxy.myproperty = o #*我需要调用underlying.myproperty_set(o)*

我查看了 Python 中的特殊函数列表，但没有找到合适的。

我还尝试通过 exec() 和内置 property() 函数的组合在对象中动态创建属性，但我发现 IronPython 1.1.2 缺少整个“新”模块（在 IronPython 2.x 中存在） beta，但我宁愿使用 IP 1.x，因为 .NET 2.0 框架）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T11:03:33.207

在 python 中你想要的通常实现是这样的：

```
class CallProxy(object):
    'this class wraps a callable in an object'
    def __init__(self, fun):
        self.fun = fun

    def __call__(self, *args, **kwargs):
        return self.fun(*args, **kwargs)

class ObjProxy(object):
    ''' a proxy object intercepting attribute access
    '''
    def __init__(self, obj):
        self.__dict__['_ObjProxy__obj'] = obj

    def __getattr__(self, name):
        attr = getattr(self.__obj, name)
        if callable(attr):
            return CallProxy(attr)
        else:
            return attr

    def __setattr__(self, name, value):
        setattr(self.__obj, name, value) 
```

我写了一个测试来证明这符合预期：

```
#keep a list of calls to the TestObj for verification
call_log = list()
class TestObj(object):
    ''' test object on which to prove
        that the proxy implementation is correct
    '''
    def __init__(self):
        #example attribute
        self.a = 1
        self._c = 3

    def b(self):
        'example method'
        call_log.append('b')
        return 2

    def get_c(self):
        call_log.append('get_c')
        return self._c
    def set_c(self, value):
        call_log.append('set_c')
        self._c = value
    c = property(get_c, set_c, 'example property')

def verify(obj, a_val, b_val, c_val):
    'testing of the usual object semantics'
    assert obj.a == a_val
    obj.a = a_val + 1
    assert obj.a == a_val + 1
    assert obj.b() == b_val
    assert call_log[-1] == 'b'
    assert obj.c == c_val
    assert call_log[-1] == 'get_c'
    obj.c = c_val + 1
    assert call_log[-1] == 'set_c'
    assert obj.c == c_val + 1

def test():
    test = TestObj()
    proxy = ObjProxy(test)
    #check validity of the test
    verify(test, 1, 2, 3)
    #check proxy equivalent behavior
    verify(proxy, 2, 2, 4)
    #check that change is in the original object
    verify(test, 3, 2, 5)

if __name__ == '__main__':
    test() 
```

这在 CPython 上执行，没有任何断言抛出异常。IronPython 应该是等价的，否则它会被破坏并且这个测试应该被添加到它的单元测试套件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T12:07:00.520

尝试这个：

```
class Test(object):
    _test = 0

    def test():
        def fget(self):
            return self._test
        def fset(self, value):
            self._test = value
        return locals()
    test = property(**test())

    def greet(self, name):
        print "hello", name

class Proxy(object):
    def __init__(self, obj):
        self._obj = obj

    def __getattribute__(self, key):
        obj = object.__getattribute__(self, "_obj")
        return getattr(obj, key)

    def __setattr__(self, name, value):
        if name == "_obj":
            object.__setattr__(self, name, value)
        else:
            obj = object.__getattribute__(self, "_obj")
            setattr(obj, name, value)

t = Test()
p = Proxy(t)
p.test = 1
assert t.test == p.test
p.greet("world") 
```

# .net-2.0 - 什么是用于 Windows 用户管理的好的 .Net 库？

> ID：340094
> 
> 赞同：0
> 
> 时间：2008-12-04T10:06:18.610
> 
> 标签：.net-2.0, ldap, adsi, user-administration

我们有一个具有员工管理功能的公司内部网。我想开始自动设置新员工，例如为他们创建 Windows 帐户、创建他们的主文件夹、设置共享等。当员工离开公司时，我想自动删除他们的用户。

我一直在努力寻找任何好的参考资料或库来管理使用 .Net 2.0 的用户。

我愿意编写 ADSI 代码甚至 WMI 代码，但需要一些示例代码来启动该过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T07:11:15.217

我在代码项目中发现了以下示例，展示[了如何使用 DirectoryServices 添加新用户](http://www.codeproject.com/KB/dotnet/addnewuser.aspx)：

```
private void AddUser(string strDoamin, string strLogin, string strPwd)
{
  DirectoryEntry obDirEntry = null;
  try
  {
    obDirEntry = new DirectoryEntry("WinNT://" + strDoamin);
    DirectoryEntries entries = obDirEntry.Children;
    DirectoryEntry obUser = entries.Add(strLogin, "User");
    obUser.Properties["FullName"].Add("Amigo");
    object obRet = obUser.Invoke("SetPassword", strPwd);
    obUser.CommitChanges();
  }
  catch (Exception ex)
  {
    Trace.Warn(ex.Message);
  }
} 
```

但是，我在[Safari Books Online](http://safaribooksonline.com/)上注册，发现了一本名为“.NET Developer's Guide to Directory Services Programming”的书——ISBN 10：0-321-35017-0，这是一个真正的突破。国际标准书号 13：978-0-321-35017-6

这本书似乎是为我的困境量身定做的，因为它解释了编程目录服务的所有基础知识，然后给出了添加用户、设置权限等的具体示例。

# asp.net - 你能推荐一个.net模板引擎吗？

> ID：340095
> 
> 赞同：54
> 
> 时间：2008-12-04T10:06:32.760
> 
> 标签：asp.net, templates, viewengine, templating-engine

我正在寻找一个 .net 模板引擎——简单、轻量、稳定且没有太多依赖项的东西。我现在需要的只是创建模板化的纯文本和 html 电子邮件。谁能给我一个好的建议？

如果它有帮助的话——比如 Java 的[Freemarker](http://freemarker.sourceforge.net/)或[Velocity](http://velocity.apache.org/)库。

[更新] 感谢您到目前为止的答案 - 非常感谢。当您使用这些库时，我对推荐或战争故事非常感兴趣。似乎是做出决定而不是依次尝试的最佳方式。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-04T11:15:19.017

这里还有几个：

*   [氨基甲酸酯](http://code.google.com/p/nhaml/)
*   [火花](http://sparkviewengine.com/)
*   [盲文](http://docs.castleproject.org/MonoRail.Brail.ashx)（可[独立](https://github.com/castleproject/MonoRail/blob/master/MR2/src/Castle.MonoRail.Views.Brail/StandaloneBooViewEngine.cs)使用）

关于 NVelocity，它已经被 Castle 的家伙分叉了，它正在[这里开发](https://github.com/castleproject/MonoRail/tree/master/MR2/NVelocity)

对于电子邮件，我需要的不仅仅是 NVelocity。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-14T15:57:02.740

RazorEngine，一个基于微软 Razor 解析引擎的模板引擎。

[https://github.com/Antaris/RazorEngine](https://github.com/Antaris/RazorEngine)

没用过，但我觉得它很有趣，因为如果你有 ASP.NET MVC 背景，你不需要学习新东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-05T07:43:33.610

更完整的清单

*   ASP.Net 内置 WebForm 视图引擎
*   ASP 视图
*   抄网
*   NHaml（Haml 的.Net 端口）
*   火花
*   速度
*   字符串模板.Net

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-02-05T21:18:23.690

我会推荐[CodeSmith Generator](http://www.codesmithtools.com/product/generator)。它是一个基于模板的代码生成器，具有不断更新和活跃的社区。下面是CodeSmith Generator 附带[的模板列表。](http://www.codesmithtools.com/product/generator#templates)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-04T11:37:21.237

来自 anltr.org 的[字符串模板](http://stringtemplate.org/)[也有 C# 版本](http://www.stringtemplate.org/download.html)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-11-05T14:18:55.620

Handlebars、RazorEngine 和 SharpTAL 的一些测试如下：

```
namespace ConsoleApplication4
{
class Program
{
    static void Main(string[] args)
    {

        Stopwatch sw = new Stopwatch();

        //RAZOR
        string razorTemplate = @"@model ConsoleApplication4.Test
                                <h1>@Model.Title</h1>
                                @if(Model.Condition1)
                                {
                                    <span>condition1 is true</span>
                                }
                                <div>
                                    @foreach(var movie in Model.Movies)
                                        {<span>@movie</span>}
                                </div>";

        //burning
        Engine.Razor.RunCompile(razorTemplate, "templateKey", typeof(Test), new Test());
        sw.Start();
        var result1 = Engine.Razor.RunCompile(razorTemplate, "templateKey", typeof(Test), new Test());
        sw.Stop();
        Console.WriteLine("razor : "+sw.Elapsed);

        //SHARPTAL
        string sharpTalTemplate = @"<h1>${Title}</h1>             
                                    <span tal:condition=""Condition1"">condition1 is true</span>                                    

                                         <div tal:repeat='movie Movies'>${movie}</div>";

        var test = new Test();
        var globals = new Dictionary<string, object>
        {
            { "Movies", new List<string> {test.Movies[0],test.Movies[1],test.Movies[2] } },
            { "Condition1", test.Condition1 },
            { "Title", test.Title },
        };

        var tt = new Template(sharpTalTemplate);
        tt.Render(globals);
        sw.Restart();
        var tt2 = new Template(sharpTalTemplate);
        var result2 = tt2.Render(globals);
        sw.Stop();
        Console.WriteLine("sharptal : " + sw.Elapsed);

        //HANDLEBARS
        string handleBarsTemplate = @"<h1>{{Title}}</h1>
                                {{#if Condition1}}                                    
                                    <span>condition1 is true</span>
                                {{/if}}
                                <div>
                                    {{#each Movies}}
                                        <span>{{this}}</span>
                                    {{/each}}                                        
                                </div>";
        var tt3 = Handlebars.Compile(handleBarsTemplate);
        sw.Restart();
        var result3 = tt3(new Test());
        sw.Stop();
        Console.WriteLine("handlebars : " + sw.Elapsed);

        Console.WriteLine("-----------------------------");
        Console.WriteLine(result1);
        Console.WriteLine(result2);
        Console.WriteLine(result3);

        Console.ReadLine();
    }
}

public class Test
{
    public bool Condition1 { get; set; }
    public List<string> Movies { get; set; }
    public string Title { get; set; }

    public Test()
    {
        Condition1 = true;
        Movies = new List<string>() { "Rocky", "The Fifth Element", "Intouchables" };
        Title = "Hi stackoverflow! Below you can find good movie list! Have a good day.";
    }
}

} 
```

和结果：

[![代码结果](https://i.stack.imgur.com/lRstO.png)](https://i.stack.imgur.com/lRstO.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-20T00:24:58.787

我刚刚发布了一个开源项目。它主要针对电子邮件模板，但如果您愿意，可以单独使用解析器。您可以阅读更多详细信息并从我的博客中获取源代码。

[http://thecodedecanter.wordpress.com/2010/07/19/town-crier-an-open-source-e-mail-templating-engine-for-net/](http://thecodedecanter.wordpress.com/2010/07/19/town-crier-an-open-source-e-mail-templating-engine-for-net/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-26T20:56:55.833

我认为 Mustache (http://mustache.github.com/) 也可能符合要求。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-06-03T15:34:05.997

[DotLiquid](http://dotliquidmarkup.org/) 是非常好的 .NET 模板系统。

它源自 Ruby 的 Liquid Markup，要求 .NET Framework 3.5 或更高版本。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-22T02:28:20.607

试试这个：电子邮件模板框架[http://www.bitethebullet.co.uk/Email_Template_Framework.aspx](http://www.bitethebullet.co.uk/Email_Template_Framework.aspx)

它在 ASP.NET 和 WinForms 下运行良好，并且仍在积极开发中。还有非常好的文档，并且很容易在示例中挖掘。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-10-29T00:32:56.053

[XCST（可扩展 C-Sharp 模板）](http://maxtoroq.github.io/XCST/)

```
<ul>
   <c:for-each name='n' in='System.Linq.Enumerable.Range(1, 5)' expand-text='yes'>
      <li>{n}</li>
   </c:for-each>
</ul> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-04T10:11:43.233

你见过 NVelocity，一个 Velocity 的 .NET 端口吗？ [http://nvelocity.sourceforge.net/](http://nvelocity.sourceforge.net/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-04T10:49:19.243

[http://csharp-source.net/open-source/template-engines](http://csharp-source.net/open-source/template-engines)

[http://joel.net/code/dotnet_templates.aspx](http://joel.net/code/dotnet_templates.aspx)

希望这可以帮助！！！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-05-20T03:14:51.957

NVELOCITY，虽然它很旧，但在 2003 年最后一次发布，足够了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-04-04T19:47:14.870

[SharpTAL](http://sharptal.codeplex.com/) - 活跃开发中的独立引擎，没有依赖，快速

# google-app-engine - 在 Google AppEngine 上运行 Mercurial 服务器

> ID：340102
> 
> 赞同：12
> 
> 时间：2008-12-04T10:08:39.713
> 
> 标签：google-app-engine, mercurial

我的意思是像“hg serve”这样的东西，支持 HTTP 推送。

由于 GAE 的只读文件系统，这可能不支持开箱即用。如果您知道任何尝试这样做或分析它将采取什么措施，请分享。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T01:12:18.540

为了关闭。是的，有人这样做了。

[App Engine 上的 Mercurial](http://hg-repos.appspot.com/static/faq.html)

# javascript - 在网页上包含不显眼的信息的最佳方式

> ID：340104
> 
> 赞同：4
> 
> 时间：2008-12-04T10:10:31.940
> 
> 标签：javascript, html, json, google-maps

因此，我编写了一些脚本，在我的页面上设置了 Google 地图。这些脚本包含在`<head>`我的页面中，并使用 jQuery 构建带有从页面上的地址列表生成的标记的地图。

但是，对于 JavaScript 正确放置标记所需的每个地址，我都有一些精确的坐标数据。这不是我希望用户在屏幕上看到的信息，那么将这些数据放入我的文档的“最佳实践”方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T10:19:30.300

我的第一个想法是带有 CSV 或类似数据的隐藏输入。由于数据不是真正的秘密，只是不用于显示。

```
 <input id="coordinates" type="hidden" value="123.2123.123:123,123,321;....." /> 
```

然后用jquery访问它

```
 var myCoordsCSV = $("#coordinates").val(); 
```

编辑：下面的答案提到了 JSON，这将是一个更好的解决方案，结合使用多个隐藏输入，正如另一个答案中指出的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T10:23:29.840

我不建议使用样式来隐藏某些东西，它会出现在没有（或禁用）css 支持的浏览器中，并且看起来很奇怪。

您可以将其存储在 javascript 变量中或添加具有隐藏值的表单（在未使用的表单中以确保其有效）：

```
<form action="#" method="get" id="myHiddenValues">
   <input type="text" name="hiddenval1" id="hiddenval1" value="1234"/>
   <input type="text" name="hiddenval2" id="hiddenval2" value="5678"/>
</form> 
```

您可以从 javascript 读取和更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T10:28:05.197

**Gareth，您可能想在[http://www.json.org/上查看 JSON](http://www.json.org/)**

除了紧凑性的好处之外，它还获得了强大的服务器端支持，如果您将来决定使用 HTTPRequest 动态加载坐标，这样做非常容易，而无需对现有脚本进行太多修改。

JSON — JavaScript Object Notation 是一种有效地序列化 JavaScript 对象的本地方式。

这里有一些例子：http: [//www.json.org/example.html](http://www.json.org/example.html)

您甚至可以将所有地址信息存储在以 JSON 格式记录的 JavaScript 对象数组中，并在屏幕上动态构建列表。这将使您能够在“运行时”以任何您需要的方式轻松地对地址进行排序、过滤和操作。

**另一种方法**是用一个标签来包含每个地址（一个简单的 div 就可以了），并为包含坐标的标签引入一个新属性：

```
<div id="addr1" coordinates="...">
    17 Coldwell Drive<br />
    Blue Mountain<br />
    BA93 1PF<br />
    United Kindom
</div> 
```

然后

```
var myCoordsCSV = $("addr1").coordinates; 
```

如果您愿意，可以将第二种方法与 JSON（存储坐标对象）结合使用，或者为每个坐标添加两个属性或保留逗号分隔列表等。

第二种方法也很好地降级并且对搜索机器人友好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T10:14:35.710

如果信息不应该对用户可见，则不应保留在文档中。例如，数据可以保留在脚本区域中。但是，如果由于各种原因无法做到这一点，您可以使用带有 style="display:none" 的 div 来隐藏信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T10:30:23.307

既然您已经有了 Jquery，为什么不直接对另一个页面/脚本进行 AJAX 调用来获取坐标数据呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T10:55:32.957

想要获取数据的人总是可以看到这些数据。试图隐藏它只会减慢那些不擅长它的人。我的建议是不要使用 XHR，因为这对很多人来说速度很慢，并且总是会增加页面加载时间，你应该尽量减少。使用数组。

```
var myArray = new Array();  
myArray.push([1.000,1.000,"test1"]);  
myArray.push([2.000,2.000,"test2"]);  
myArray.push([3.000,3.000,"test3"]);  
for(i=0;i<myArray.length;i++){  
    yourGoogleMapsAPICall(myArray[i][0],myArray[i][1],myArray[i][2]);  
} 
```

是吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T13:27:49.500

将数据保存在 Javascript 或 JSON 中会忽略不显眼的 Javascript。“不显眼”的关键之一是在不存在 Javascript 时优雅地降级 - 理想情况下，当 CSS 也不存在时。出于这个原因，您**应该**将数据放在文档中，而不是在 Javascript 中，以便用户可以看到它。

此外，您应该将它呈现在一个看起来很干净的表格或 div 结构中，而无需任何 CSS。在这种情况下，表可能是表示此类数据的正确语义结构。您可以为那些有 CSS 但没有 Javascript 的人进一步设置表格样式。然后 Javascript 可以轻松解析数据并将其放入地图中，但如果不支持 Javascript，数据仍将显示。

另一个好处是它很容易被搜索引擎等机器人和任何想要编写第三方混搭的人抓取。（如果您不想共享它，您可能会看到这是一个缺点，但如果有人想要足够的数据，他们无论如何都会从页面中获取它。）对于使用屏幕阅读器的视障用户来说，它也将以简洁的形式出现.

现在您不想让表格默认可见，因此您必须使用 CSS 将其隐藏。但是如果用户有 CSS 但没有 Javascript 怎么办？然后你可能想展示桌子......这就是优雅地贬低的意思。所以你要做的是让表格在 CSS 中可见（即不显式隐藏它），然后运行一些 Javascript 在初始化时隐藏它：

```
document.getElementById("geodata").style.display = "none"; 
```

或一些特定于库的等价物，例如

```
$("geodata").hide() 
```

唯一的问题是，如果您在 document.onload() 中运行它，表格将显示几秒钟。因此，在您输出表格后将其包含在脚本标记中。这是一种可以在 HTML 中包含脚本标记的情况。如果这样做，请*避免*使用特定于库的代码，因为在评估内联脚本时，库可能尚未加载。

现在您已经涵盖了所有情况： - JS 和 CSS - 数据在地图中很好地呈现 - 没有 JS，但 CSS - 数据很好地呈现在表格中 - 没有 JS 和没有 CSS - 数据呈现在原始 HTML 表格中（另一种情况，JS并且很少出现 CSS，如果你愿意，你可以处理它，但有点毫无意义）

您的 Javascript 代码也将是干净的，因为它正在解析一个构造整齐的数据结构。您可以在开发过程中轻松检查表，以查看它是否包含正确的数据以及地图是否正确反映了该数据。

# c# - C# StringBuilder - 如何转义这个字符串：

> ID：340111
> 
> 赞同：0
> 
> 时间：2008-12-04T10:13:49.330
> 
> 标签：c#, stringbuilder

```
<document.write("<SCR"+"IPT TYPE='text/javascript' SRC='"+"http"+(window.location.protocol.indexOf('https:')==0?'s':'')+"://"+gDomain+"/"+gDcsId+"/wtid.js"+"'><\/SCR"+"IPT>"); 
```

我需要转义上面的字符串才能将整个内容添加到 StringBuilder 但到目前为止我必须遗漏一些东西，因为字符串终止不正确......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T10:31:04.863

你应该尝试这样的事情：

```
@"<document.write(""<SCR""+""IPT TYPE='text/javascript' SRC='""+""http""+(window.location.protocol.indexOf('https:')==0?'s':'')+""://""+gDomain+""/""+gDcsId+""/wtid.js""+""'><\/SCR""+""IPT>"");" 
```

当使用 @ 为字符串文字添加前缀时，唯一需要的转义是将 " 字符加倍。

希望这有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T10:32:35.360

```
string x = @"<document.write(""<SCR""+""IPT TYPE=""'text/javascript' SRC='""+""http""+(window.location.protocol.indexOf('https:')==0?'s':'')+""://""+gDomain+""/""+gDcsId+""/wtid.js""+""'><\/SCR""+""IPT>"");"; 
```

@ 前缀使转义更简单。你只需要把每个“变成”。

如果您将 JavaScript 存储在外部文件中，您会发现您的程序更易于维护。我假设您正在使用 StringBuilder 以便您可以将一些常量脚本与一些动态值混合在一起？您可以将它写在一个文件中，但将这样的转义符用于动态值：

```
var fromCSharp = {0}; 
```

Then at runtime, load the JS file and give it to string.Format as the format string, along with values to replace each occurrence of {0}, {1}, etc. You only need to load the format string from the file once and keep it cached.

Also if the values you are inserting into the JavaScript are themselves string literals, you will need to escape them according to the syntax of JavaScript.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T10:22:53.400

我认为您正在混淆什么是`JavaScript`和什么是`C#`。你能告诉我们你想要实现的字符串吗？

例如

`window.location.protocol.indexOf('https:')`是`JavaScript`

但大概

`gDomain`和`gDcsId`

是您`C#`方法中的变量

也许是这样：

```
"<SCRIPT TYPE='text/javascript' SRC='"+"http"+"(window.location.protocol.indexOf('https:')==0?'s':'')"+"://" + gDomain + "/"+ gDcsId+ "/wtid.js"+"'></SCRIPT>") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T10:28:13.903

开头的字符串正是我想要的......（我没有将 JavaScript 与 C# 混合 - 我只需要在 C# StringBuilder 中添加一个字符串，巧合包含一些 JavaScript）

它是我必须使用 StringBuilder 放在页面上的外部脚本（出于各种原因）。

我无法知道对脚本的任何更改是否会使其失败，所以我必须按原样包含它......

它只是整个脚本的 1 行，但我设法正确地逃脱了大多数其他行，并且它们被包含在内...

# relative-path - linux -gcc env 上的相对路径解释

> ID：340115
> 
> 赞同：2
> 
> 时间：2008-12-04T10:14:27.627
> 
> 标签：relative-path

我有一个关于如何在各种环境中解释相对路径的问题。如果我有一个 C 代码要使用 Makefile 和 gcc 在 linux 上编译，并且如果某个源文件有：

```
fopen(“../../xyz.ctl”, ”r”); 
```

这个文件应该放在哪里。或者换句话说，如果我有

```
fopen(“xyz.ctl” , ”r”); 
```

编译器是否会在与以下相同的文件夹中查找 xyz.ctl：-

a.) 具有此语句 fopen 的源文件在哪里？

b.) makefile 在哪里？

c.) linux 可执行文件会在哪里生成？

我知道 MSVC 所有相对路径都来自具有 *.dsw （工作区文件）的文件夹。对于 RVDS 环境，它从生成可执行文件 *.axf 的文件夹开始。

-广告

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T10:37:23.837

您的 Makefile 调用 gcc 来编译包含 fopen() 的代码。fopen() 在你执行新编译的代码时被调用。当您启动程序时，该路径相对于您当前的工作目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T10:35:05.590

任何 Unix 工具编译的代码中的路径都是相对于执行最终可执行文件的路径。

gcc 不会尝试了解您所做的事情，也不会分析您编译到应用程序中的路径。

据我所知，Windows 复制命令是唯一尝试“修复”它所处理的应用程序中的路径的命令。（故事：我在软盘上有一个 VB 应用程序，当我将其复制到 C: 时，文件的校验和已更改。差异显示将应用程序复制到磁盘会将应用程序中的“C:\”替换为“ A:\" 反之亦然）。

# c++ - ::FindWindow 从服务应用程序失败

> ID：340122
> 
> 赞同：4
> 
> 时间：2008-12-04T10:17:21.227
> 
> 标签：c++, windows, winapi, service

从服务应用程序调用 Windows API ::FindWindow 函数失败。GetLastError() 也返回 0（成功？）。这是一些特权\访问权问题吗？你认为这是设计问题，我应该使用另一种 IPC 方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T11:37:50.050

leppie 的权利，Windows 服务通常在与桌面交互时被拒绝。您可以在 XP 和更早版本中绕过它，但在 Vista 及更高版本中无法做到这一点。您最好将桌面和用户交互委托给 GUI 应用程序。有关详细信息，请参阅此[文档](http://www.microsoft.com/whdc/system/vista/services.mspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T01:47:27.663

服务在 Session 0 中运行。在 XP 及更早版本上，第一个登录的用户也在 Session 0 中运行，后续用户在 Session 1 及更高版本中运行。如果该服务设置为“与桌面交互”，则它可以访问在会话 0 中运行的任何用户窗口。但是，从 Vista 开始，用户不再在会话 0 中运行。FindWindow() 仅在调用它的 Session 的上下文中有效，因为不能跨 Session 边界访问窗口。

# c# - IronPython 用于 C# 上的单元测试

> ID：340128
> 
> 赞同：13
> 
> 时间：2008-12-04T10:21:03.807
> 
> 标签：c#, python, unit-testing, ironpython

我们知道 Python 提供了比任何编译语言都高的生产力。我们用 C# 编程，需要用 C# 本身编写单元测试用例。如果我们看到我们为单元测试编写的代码量大约是原始代码的十倍。

用 IronPython 而不是 C# 编写单元测试用例是理想的选择吗？有没有机构做过这样的事？我写了几个测试用例，它们似乎很好。但毛茸茸的尖尖经理不会接受。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T22:28:16.257

Python 非常适合对 C# 代码进行单元测试。我们的应用程序 75% 使用 Python，25% 使用 C#(Python.Net)，我们的单元测试 100% 使用 Python。

我发现在 Python 中使用存根和模拟要容易得多，这可能是使人们能够编写有效的单元测试的最关键的组件之一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T10:36:19.440

Will 的回答很好——您正在为开发人员引入新的要求。

另外，工具支持是什么样的？我自己没有尝试过任何这些，但我想知道：

*   调试失败的单元测试有多容易？
*   从 IDE 运行单元测试有多容易？（例如使用 ReSharper）
*   从连续构建服务器自动化单元测试有多容易？

可能所有这些都很好 - 但您应该检查它们并记录结果。

当然，除了 IronPython 之外，还有其他选项 - [Boo](http://boo.codehaus.org/)是一个相当明显的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T18:57:17.963

Python 是一种比 C# 简洁得多的语言，实际上可能会降低编写单元测试的障碍，因为仍然有很多开发人员通常拒绝进行自动化单元测试。引入并让他们使用像 IronPython 这样的语言，这种语言通常会花费更少的时间来用 C# 编写等效代码，实际上可能会鼓励编写更多的单元测试，这总是一件好事。

另外，通过将 IronPython 用于您的测试代码，您最终可能会为您的项目整体减少代码行数 (LOC)，这意味着您的单元测试更有可能在长期内得到维护，而不是被忽略和/或丢弃。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-05T00:04:30.853

实际上，测试是尝试集成新语言的绝佳机会。像 Python 这样的语言在测试中表现得特别好，这是一个低风险的项目尝试——最坏的情况一点也不差。

就在 Python 中测试另一种语言的经验而言，我已经测试过这样的 C 和 C++ 系统，并且非常出色。我认为这绝对值得一试。

然而，Jon 说的是真的——Python 的工具水平，特别是 IronPython 的水平，远不及 C# 的水平。这对你的影响有多大，你会在你的飞行员中发现。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T10:29:38.407

有一个明显的*缺点*，那就是现在编写代码的每个人都需要精通两种语言，而不仅仅是一种。我很毛茸茸，但不是很尖刻，但我明白为什么经理们可能会持怀疑态度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-08T04:17:27.230

[在发现mbUnit](http://www.mbunit.com/)和[NUnit](http://nunit.net/blogs/?p=60)中的参数化测试后，我最近一直在重新评估我的测试态度。以前，由于测试的简洁性和可发现性，我推荐 Python unittest 作为自动化任何测试的一种方式。

参数化测试允许您使用一系列数据参数自定义测试夹具，因此您的 C# 测试最终可以比 Python 测试更简洁。

```
[TestCase(12, 3, 4)]
[TestCase(12, 2, 6)]
[TestCase(12, 4, 3)]
[TestCase(12, 0, 0, ExpectedException = typeof(System.DivideByZeroException),
      TestName = “DivisionByZeroThrowsExceptionType”)]
[TestCase(12, 0, 0, ExpectedExceptionName = “System.DivideByZeroException”,
      TestName = “DivisionByZeroThrowsNamedException”)]
public void IntegerDivisionWithResultPassedToTest(int n, int d, int q)
{
      Assert.AreEqual(q, n / d);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T23:36:58.303

很有意思。

如果您使用 IronPython 编写所有代码（不仅仅是单元测试）会发生什么？你最终会减少大约 10 倍的代码吗？

也许我也应该学习 IronPython。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T17:41:30.910

我得和威尔和乔恩一起去..

我希望我的测试与我正在测试的代码使用相同的语言；它导致更少的认知上下文切换。但也许我只是不像以前那样头脑灵活了。

*   乔恩

# security - 从 windows server 2008 CA 获取颁发的证书信息

> ID：340129
> 
> 赞同：0
> 
> 时间：2008-12-04T10:21:54.307
> 
> 标签：security, windows-server-2008, certificate-authority

是否可以使用 .net 平台查询 windows server 2008 上的证书存储？我想获取有关此系统颁发的证书的信息。

tnx 格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T11:46:34.977

对于“颁发的证书”，您是指已由此框或此框颁发*的*证书*吗*？

 *无论如何，这样的事情应该让你开始使用证书存储：

```
using System;
using System.Security.Cryptography.X509Certificates;

class CertificateStoreSample
{
    static void Main(string[] args)
    {
        X509Store store = new X509Store(StoreName.Root);

        store.Open(OpenFlags.ReadOnly);

        foreach (X509Certificate certificate in store.Certificates)
        {
            Console.WriteLine(certificate.Subject);
        }

        store.Close();
    }
} 
```

# hosting - 用于早期 Web 应用的虚拟专用服务器托管与 Colo + 自己的服务器

> ID：340136
> 
> 赞同：5
> 
> 时间：2008-12-04T10:24:17.717
> 
> 标签：hosting, vps, web-applications, colocation

我正在开发一个网络应用程序，需要找出托管它的最佳方式。我希望尽量减少“总拥有成本”，但在我的情况下，保持托管成本比人工成本低更重要。

有可能有一天，它会变得非常大（就用户群而言），流量很大，但当然，它一开始会很小。

那么，从低端虚拟专用服务器托管计划开始，扩大服务器切片直到它不再比运行我自己的服务器便宜，然后购买服务器并在托管服务提供商处设置它们，这是否有意义？迁移一切的痛苦，

-或者-

购买自己的服务器，在托管提供商处设置，浪费大部分服务器容量来启动，但显着减少从小到大扩展的痛苦？

有没有人尝试过这两种选择？除了我正在考虑的那些优点和缺点吗？

谢谢。

附录：感谢您的建议，但共享主机帐户可能不会削减它，因为我需要运行持久进程并访问诸如 sendmail 配置文件之类的东西。我正在查看 VPS 或我自己的服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T22:51:43.200

我强烈建议您使用 VPS 帐户。我有一些客户花费了数千美元和无数小时试图获得一个完美的专用托管环境设置，然后从未接近需要它的容量。

使用 VPS，只要您使用您想要坚持的虚拟化技术，在需要时将整个“服务器”迁移/复制到新的专用盒子应该非常容易。

如果您需要 SQL Server，我建议您从共享 SQL Server 开始，而不是购买完整的 SQL Server 许可证或使用 SQL Express。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T10:43:59.737

一开始，您实际上会发现扩展 VPS 解决方案比在物理设备上扩展要容易得多且灵活得多。我个人使用并强烈推荐[Slicehost](http://www.slicehost.com)。您可以即时创建和销毁新切片以测试新想法或制作原型，而您只需为使用的内容付费。您还可以通过升级到更高级别来立即扩展切片；几分钟之内，您的机器就配备了新的 CPU 和内存分配，并且成本按比例分配。

我推荐 Slicehost，因为他们以开发人员为中心，而且真的是一群很棒的人。

一旦你的 VPS 农场变得足够大（这将需要一段时间，相信我，这些 VPS 现在可能非常强大），你将有足够的现金来担心迁移到物理平台。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T10:34:39.350

从小处着手。是的，一些扩展令人头疼，但如果您想完全避免它们，请使用平台即服务（云）服务提供商，而不是自己托管它。

从统计上看，大多数项目都失败了，增加的间接成本不会增加你的机会。即使是非常受欢迎的大型服务也很难赚钱。托管公司主要从客户的梦想与随之而来的现实之间的差距中赚钱。

因此，务实地开始托管/共享，这样您就可以专注于您正在开发的技术，而不是维护一个远程盒子，并随着项目获得用户/客户而提升层级。

不过，我不是根据经验说话，除了梦想不会走得很远。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T10:41:58.837

将域与托管服务提供商分开注册，您可以轻松地将 DNS 条目移动到另一个位置。

使用共享主机，如果它超过共享主机，然后通过使用 VPS / 专用服务器来处理受欢迎程度。

为什么要共享主机：

*   最便宜的*   无需服务器维护

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T10:28:25.417

我会从 serverpronto 之类的公司购买一个专用的盒子，然后当你长大后将它们转移到一个 colo 中，如果做得好，这将是无痛的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T10:29:50.653

这实际上取决于您现在能负担得起的费用以及所涉及的时间表。

如果你现在能负担得起自己的服务器，我会说去买它（但可能租用它 - 不要拥有它）。

但是，如果你不能，或者这将是一场斗争，你需要权衡在虚拟主机计划中你能节省多少，以及这些钱还能为你做什么与迁移的痛苦。

# c# - ActiveRecord/NHibernate：在不感知持久性的上下文中处理惰性集合

> ID：340137
> 
> 赞同：1
> 
> 时间：2008-12-04T10:25:01.820
> 
> 标签：c#, castle-windsor, castle-activerecord

我的 Web 应用程序（MonoRail、Windsor、ActiveRecord）有一个可启动的导入服务和一个或多个可启动的导入阅读器。例如，当一个文件被放到一个目录中时，读取器解析文件，将数据传递给服务，该服务通过存储库更新和/或创建对象。我遇到的问题是这些可启动服务位于请求范围之外（从开始到结束有一个 SessionScope），所以当服务遇到惰性集合时，没有 SessionScope 可以帮助它发挥作用。提示 LazyInitializationException :)。

任何想法如何很好地解决这个问题？也许使用拦截器围绕处理数据的方法创建和处置 SessionScope？为存储库配备执行急切获取的方法？我想让服务不知道 ActiveRecord，因为我的依赖偏执狂说有一天我们可能想要使用不同的持久性机制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T11:30:35.460

你已经回答了：

> 使用拦截器围绕处理数据的方法创建和处置 SessionScope

# .net - 为什么 Visual Studio 无法打开 .csproj 文件？

> ID：340138
> 
> 赞同：18
> 
> 时间：2008-12-04T10:25:15.327
> 
> 标签：.net, visual-studio-2008, xna, xna-3.0

我有一个奇怪的问题，我无法在 Visual Studio 中打开我的 .NET 项目的属性。如果我尝试通过单击解决方案资源管理器中的属性树节点来打开它，我会收到以下消息：

> 没有可用于“....csproj”的编辑器。确保已安装文件类型 (.csproj) 的应用程序。

如果我尝试通过主菜单打开项目属性，则根本没有任何反应。

我已经尝试通过命令行和修复安装重置 Visual Studio 设置，但到目前为止没有任何帮助。

我在 9.0.30729.1 SP 版本中使用 Visual Studio 2008，包括 XNA Game Studio 3.0、ReSharper 4.1 和 Visual SVN 1.5.1。

它发生在我所有的项目中，似乎是一个本地问题，因为我的同事没有这种问题。

非常感谢您的帮助！

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-05T15:20:30.723

正如我在问题中提到的那样，修复安装不起作用。通过使用命令行解决了这个问题

```
devenv /ResetSkipPkgs 
```

但在那之后我不得不重置我的一些 Resharper 设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-01T19:21:46.123

我遇到过同样的问题。尝试运行“devenv /ResetSkipPkgs”，修复安装......没有运气。

我打开了 .csproj 文件（在文本编辑器中），并**在 csproj 文件中查找了所有引用**。显然，我找到了它引用 MVC 1.0 的行（假设 MVC 2.0 将向后兼容，我还没有安装它！？）

我安装了 MVC 1.0，然后繁荣......它工作！

**只需检查 .csproj 文件中的所有引用，并根据需要安装它们。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T11:48:29.043

你有安装 SQL Server 吗？如果是这样，您是否不小心打开了作为 SQL Server 一部分安装的 VS2005 shell 的项目？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T17:44:42.710

在我看来，您需要完全卸载并从头开始重新安装。您可能丢失了某些设置或损坏了某些注册表项。您可以四处寻找直到找到错误的设置，也可以花时间重新安装。

不要进行修复安装。从您的机器中删除 VS（以及您提到的其他程序/实用程序）并进行全新安装。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T15:35:39.960

在记事本中打开 .csproj 并检查 <ProjectTypeGuids> 标签，如果它存在，那么您可能没有安装其中一种项目类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-22T07:01:59.873

如果以上答案都不起作用，您还可以再次启动安装程序，选择“删除或添加功能”，然后在功能列表中添加可用于“Visual C#”的所有“附加语言工具”。例如，在我的情况下，我缺少允许打开 .csproj 所需的“Visual Studio 办公工具”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-28T06:37:27.880

当我从扩展和更新中**卸载扩展**时，我遇到了同样的问题。我尝试了上面提到的所有选项，但没有运气。它显示我每次尝试加载应用程序时**xamarin shell 包都没有正确加载。**

**然后通过使用 Xamarin.VisualStudio_.msi 修复 Xamarin.VisualStudio 解决了该问题`<version>`。**. 通过这个 .csproj 问题将得到解决。

# sql - SQL 'where' 子句中条件的执行顺序

> ID：340139
> 
> 赞同：16
> 
> 时间：2008-12-04T10:26:10.973
> 
> 标签：sql, oracle, where

我的 where 子句中有一组条件，例如

```
WHERE 
d.attribute3 = 'abcd*'  
AND x.STATUS != 'P' 
AND x.STATUS != 'J' 
AND x.STATUS != 'X' 
AND x.STATUS != 'S' 
AND x.STATUS != 'D' 
AND CURRENT_TIMESTAMP - 1 < x.CREATION_TIMESTAMP 
```

这些条件中的哪一个将首先执行？我正在使用甲骨文。

我会在我的执行计划中获得这些详细信息吗？（我无权在此处的数据库中执行此操作，否则我会尝试）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-04T11:40:46.533

您**确定**您“无权”查看执行计划吗？使用 AUTOTRACE 怎么样？

```
SQL> set autotrace on
SQL> select * from emp
  2  join dept on dept.deptno = emp.deptno
  3  where emp.ename like 'K%'
  4  and dept.loc like 'l%'
  5  /

no rows selected

Execution Plan
----------------------------------------------------------

----------------------------------------------------------------------------------
| Id  | Operation                    | Name         | Rows  | Bytes | Cost (%CPU)|
----------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |              |     1 |    62 |     4   (0)|
|   1 |  NESTED LOOPS                |              |     1 |    62 |     4   (0)|
|*  2 |   TABLE ACCESS FULL          | EMP          |     1 |    42 |     3   (0)|
|*  3 |   TABLE ACCESS BY INDEX ROWID| DEPT         |     1 |    20 |     1   (0)|
|*  4 |    INDEX UNIQUE SCAN         | SYS_C0042912 |     1 |       |     0   (0)|
----------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("EMP"."ENAME" LIKE 'K%' AND "EMP"."DEPTNO" IS NOT NULL)
   3 - filter("DEPT"."LOC" LIKE 'l%')
   4 - access("DEPT"."DEPTNO"="EMP"."DEPTNO") 
```

如您所见，这提供了有关如何执行查询的大量细节。它告诉我：

*   条件“emp.ename like 'K%'”将首先应用，在 EMP 的完整扫描中
*   然后将通过 dept.deptno 上的索引选择匹配的 DEPT 记录（通过 NESTED LOOPS 方法）
*   最后将应用过滤器“dept.loc like 'l%'。

这种应用顺序与 WHERE 子句中谓词的排序方式无关，正如我们可以用这个重新排序的查询所示：

```
SQL> select * from emp
  2  join dept on dept.deptno = emp.deptno
  3  where dept.loc like 'l%'
  4  and emp.ename like 'K%';

no rows selected

Execution Plan
----------------------------------------------------------

----------------------------------------------------------------------------------
| Id  | Operation                    | Name         | Rows  | Bytes | Cost (%CPU)|
----------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |              |     1 |    62 |     4   (0)|
|   1 |  NESTED LOOPS                |              |     1 |    62 |     4   (0)|
|*  2 |   TABLE ACCESS FULL          | EMP          |     1 |    42 |     3   (0)|
|*  3 |   TABLE ACCESS BY INDEX ROWID| DEPT         |     1 |    20 |     1   (0)|
|*  4 |    INDEX UNIQUE SCAN         | SYS_C0042912 |     1 |       |     0   (0)|
----------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("EMP"."ENAME" LIKE 'K%' AND "EMP"."DEPTNO" IS NOT NULL)
   3 - filter("DEPT"."LOC" LIKE 'l%')
   4 - access("DEPT"."DEPTNO"="EMP"."DEPTNO") 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-04T10:28:53.107

数据库将决定执行条件的顺序。

通常（但并非总是）它会在可能的情况下首先使用索引。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-04T15:13:28.147

如前所述，查看执行计划将为您提供一些信息。但是，除非您使用计划稳定性功能，否则您不能依赖执行计划始终保持不变。

对于您发布的查询，看起来评估顺序不会以任何方式改变逻辑，所以我猜您正在考虑的是效率。Oracle 优化器很可能会选择一个有效的计划。

如果您想将性能与基本查询进行比较，可以采取一些技巧来鼓励特定的排序。例如，您希望首先执行时间戳条件。你可以这样做：

```
WITH subset AS
  ( SELECT /*+ materialize */
      FROM my_table
      WHERE CURRENT_TIMESTAMP - 1 < x.CREATION_TIMESTAMP
  )
SELECT *
  FROM subset
  WHERE 
  d.attribute3 = 'abcd*'  
  AND x.STATUS != 'P' 
  AND x.STATUS != 'J' 
  AND x.STATUS != 'X' 
  AND x.STATUS != 'S' 
  AND x.STATUS != 'D' 
```

“materialize”提示应该使优化器首先执行内联查询，然后扫描该结果集以查找其他条件。

我不建议您将此作为一般习惯。在大多数情况下，只需编写简单的查询即可获得最佳执行计划。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T15:39:47.550

添加到关于执行计划的其他评论中，在 9i 中引入并在 10g+ 中默认使用的基于 cpu 的成本计算模型下，Oracle 还将评估哪个谓词评估顺序将导致较低的计算成本，即使这不会影响表访问顺序和方法。如果在另一个谓词之前执行一个谓词导致执行的谓词计算较少，则可以应用该优化。

有关详细信息，请参阅本文：[http ://www.oracle.com/technology/pub/articles/lewis_cbo.html](http://www.oracle.com/technology/pub/articles/lewis_cbo.html)

此外，Oracle 甚至不必执行与检查约束或分区定义进行比较表明无论如何都不会返回任何行的谓词。

复杂的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-02T19:40:46.813

最后，关系数据库理论说你**永远不能**依赖查询子句的执行顺序，所以最好不要尝试。正如其他人所说，基于成本的优化器试图选择它认为最好的，但即使查看*解释计划*也不能**保证**使用的实际顺序。解释计划只是告诉你 CBO 的建议，但这还不是 100%。

也许如果你解释你为什么要这样做，有些人可能会提出一个计划？

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-09-24T14:52:41.700

棘手的问题。刚刚面临同样的困境。我需要在查询中提及一个函数。该函数本身会进行另一个查询，因此您了解它通常如何影响性能。但是在大多数情况下，如果其余条件先执行，则不会经常调用该函数。

Well, thought it would be useful to post here another article for topic.

The following quote is copied from **Donald Burleson**'s site ([http://www.dba-oracle.com/t_where_clause.htm](http://www.dba-oracle.com/t_where_clause.htm)) .

> The **ordered_predicates** hint is specified in the Oracle WHERE clause of a query and is used to specify the order in which Boolean predicates should be evaluated.
> 
> In the **absence of ordered_predicates**, Oracle uses the following steps to evaluate the order of SQL predicates:
> 
> *   Subqueries are evaluated before the outer Boolean conditions in the WHERE clause.
>     
>     
> *   All Boolean conditions without built-in functions or subqueries are evaluated in reverse from the order they are found in the WHERE clause, with the last predicate being evaluated first.
>     
>     
> *   Boolean predicates with built-in functions of each predicate are evaluated in increasing order of their estimated evaluation costs.

# windows-installer - 在 vdproj 中作为最后一步重新启动，我该如何添加它？

> ID：340145
> 
> 赞同：2
> 
> 时间：2008-12-04T10:28:15.087
> 
> 标签：windows-installer, vdproj

如何将重启操作添加到 vdproj？

我需要一个[MSI](http://en.wikipedia.org/wiki/Windows_Installer)文件，它会在安装结束时重新启动 PC。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-12T12:24:21.543

这是我基于[saschabeaumont](https://stackoverflow.com/users/592/saschabeaumont)的[回答](https://stackoverflow.com/questions/340145/reboot-as-last-step-in-vdproj-how-can-i-add-it/342926#342926)的解决方案。

每次构建安装程序时自动修改 .msi 以提示重新启动：

1.  在 .vdproj 部署项目文件所在的文件夹中创建一个名为“AddRebootPrompt.vbs”的文件，VB 脚本如下所示。

2.  在 Visual Studio 解决方案资源管理器中找到部署项目，右键单击并转到“属性”。

3.  在 PostBuildEvent 属性中，粘贴以下内容以在构建安装程序项目后运行脚本：

`cscript "$(ProjectDir)AddRebootPrompt.vbs" "$(BuiltOuputPath)"`

**AddRebootPrompt.vbs 内容：**

```
Dim installer, database, view, result
Dim strPathMsi 

If WScript.Arguments.Count <> 1 Then
    WScript.Echo "Usage: cscript AddRebootPrompt.vbs <path to MSI>"
    WScript.Quit -1
End If

strPathMsi = WScript.Arguments(0)

Set installer = CreateObject("WindowsInstaller.Installer")
Set database = installer.OpenDatabase (strPathMsi, 1)
Set view = database.OpenView ("INSERT INTO Property (Property, Value) VALUES ('REBOOT', 'Force')")

WScript.Echo "Adding forced reboot prompt to install sequence."

view.Execute
database.Commit
WScript.Quit 0 
```

如果成功，您将看到“添加强制重启提示以安装序列”。在构建安装程序项目时，在您的构建输出日志窗口中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T04:34:49.670

Just add the "REBOOT" property with the value "Force" which will prompt the user to reboot once setup is complete, or automatically reboot if there is no user interface.

If you cannot do this in the vdjproj then just use Orca to edit the Property table of the MSI once the setup is built.

If you want to force a reboot, you can set REBOOT=Force and REBOOTPROMPT=Suppress so that the user is not prompted.

Alternatively you can use the `ForceReboot` action to reboot during the middle of installation or `ScheduleReboot` to schedule a reboot once the installation is complete. Again either of these actions can be added using Orca if you cannot do so in the vdjproj.

You can do something like this using the following VBS

```
Dim installer, database, view, result
Set installer = CreateObject("WindowsInstaller.Installer")
Set database = installer.OpenDatabase ("setup.msi", 1)
Set view = database.OpenView ("INSERT INTO Property (Property, Value) VALUES ('REBOOT', 'Force')")
view.Execute
database.Commit
Set database = nothing 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T10:40:14.597

如果您需要重新启动，Windows Installer 应该会自动检测到它。如果您因为懒得手动启动服务而想重新启动，则需要找到其他方法（我不知道有什么简单的方法）。

# reporting-services - ReportViewer 客户端打印控件“无法加载客户端打印控件”？

> ID：340151
> 
> 赞同：23
> 
> 时间：2008-12-04T10:29:27.973
> 
> 标签：reporting-services, printing, activex, reportviewer

有没有人遇到过这个问题？

似乎 MS 用自己的更新打破了它：

> 许多人在安装 Microsoft Update 956391 后报告了在报表查看器中使用 ActiveX 打印控件的问题。具体而言，用户在单击报表查看器工具栏中的打印图标时收到错误“无法加载客户端打印控件”。我想解释发生了什么，我们为什么这样做，以及如何解决您或您的客户遇到的问题。

从这里：http: [//blogs.msdn.com/brianhartman/archive/2008/11/05/client-print-fails-to-load-after-microsoft-update-956391.aspx](http://blogs.msdn.com/brianhartman/archive/2008/11/05/client-print-fails-to-load-after-microsoft-update-956391.aspx)

我可以让它再次在 ReportManager 中工作，但在我们的应用程序 ( [RSinteract](http://www.rsinteract.com) ) 中，它引用了 ReportViewer 的 8.0.0.0 版本，无论我做什么，它都无法工作。

我在这里尝试了一切： [http ://www.technologystudio.net/blog/post/Microsoft-Update-KB956391-breaks-Reporting-Services-ReportViewer.aspx](http://www.technologystudio.net/blog/post/Microsoft-Update-KB956391-breaks-Reporting-Services-ReportViewer.aspx)

我想要一个不需要我重建和重新部署到所有客户的修复程序。有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-04T11:59:01.893

找到一个修复：

1.  首先确保从报告管理器中打印（在报告管理器中打开一个报告并从那里打印）。

2.  如果有效，请转到步骤 3，如果您收到相同的错误，则需要在 Report Server 上安装以下补丁。

    *   KB954606 - SQL Server SP2 的安全更新

        [http://www.microsoft.com/downloads/details.aspx?familyid=4603C722-2468-4ADB-B945-2ED0458B8F47&displaylang=en#filelist](http://www.microsoft.com/downloads/details.aspx?familyid=4603C722-2468-4ADB-B945-2ED0458B8F47&displaylang=en#filelist)

    *   报表查看器 2005 SP1

        [http://www.microsoft.com/downloads/details.aspx?familyid=82833F27-081D-4B72-83EF-2836360A904D](http://www.microsoft.com/downloads/details.aspx?familyid=82833F27-081D-4B72-83EF-2836360A904D)

3.  下载并安装以下更新：

    *   KB954607 - SQL Server SP2 的安全更新

        [http://www.microsoft.com/downloads/details.aspx?familyid=5148B887-F323-4ADB-9721-61E1C0CFD213&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=5148B887-F323-4ADB-9721-61E1C0CFD213&displaylang=en)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-12-13T05:23:49.817

无法加载客户端打印控件！
每次，客户想要通过单击报表查看器上的打印按钮来打印报表，他们总是会收到此错误消息。

我花了将近两个星期来解决这个问题。
我的环境是：
- Window Server 2003 Standard Edition R2
- Report Server Version 10.XXX
- 使用 windowXP SP3 的客户端
我的解决方案是：
- 替换 C\Program Files\Microsoft SQL
Server\MSRS10中的 CAP 文件 (RSClientPrint-x86.cab) .MSSQLSERVER\Reporting Services\ReportServer\bin\
- 提取 RSClientPrint-x86.cab 并将其分发给客户端。

听到的是 CAB 文件：[https ://sites.google.com/site/narithsite/Home/RSClientPrint-x86.cab?attredirects=0&d=1](https://sites.google.com/site/narithsite/Home/RSClientPrint-x86.cab?attredirects=0&d=1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T16:26:24.323

以下修复对我有用

Windows Server 2003 64 报告服务 Windows Vista 和 Windows XP

修复 KB967511 和 KB953752

[http://blogs.msdn.com/esecuelesinfronteras/archive/2008/11/10/error-unable-to-load-client-print-control-en-reporting-services.aspx](http://blogs.msdn.com/esecuelesinfronteras/archive/2008/11/10/error-unable-to-load-client-print-control-en-reporting-services.aspx)

[http://support.microsoft.com/kb/967511/es](http://support.microsoft.com/kb/967511/es)

为我工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T23:03:19.760

我在不删除任何补丁的情况下完成了这项工作。上面的补丁也不起作用。最后我所做的是在 IIS 服务器上安装以下补丁并重置/重新启动 IIS 服务器。这不适用于报表管理器应用程序。这适用于使用 VS2008 在 .net3.5 中开发的任何 ASP.NET Web 应用程序 [http://www.microsoft.com/downloads/details.aspx?familyid=6AE0AA19-3E6C-474C-9D57-05B2347456B1&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=6AE0AA19-3E6C-474C-9D57-05B2347456B1&displaylang=en)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T08:51:34.867

我有同样的问题（在几个不同的服务器上）。应用 SP3 和 Report Viewer SP1 对一些服务器有所帮助，允许客户端计算机毫无问题地连接和下载控件。但是，我有一台服务器，即使在应用更新之后，当使用客户端计算机访问报表查看器时，它仍然给我错误。在查看正在发送的确切 URL GET 请求时，我发现可以强制客户端计算机直接连接到报表服务器以下载控件。

用户需要输入以下网址：

[http://reportservername/Reports/Reserved.ReportViewerWebControl.axd?ReportSession=51bjqv45xydgos2wghu5ceza&ControlID=7617dedbf0234f89b80cad8e64431014&Culture=2057&UICulture=9&ReportStack=1&OpType=PrintHtml](http://reportservername/Reports/Reserved.ReportViewerWebControl.axd?ReportSession=51bjqv45xydgos2wghu5ceza&ControlID=7617dedbf0234f89b80cad8e64431014&Culture=2057&UICulture=9&ReportStack=1&OpType=PrintHtml)

这应该会弹出所需的下载/安装提示。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-24T16:00:49.817

我们的服务器环境：Windows Server 2008 x64 上的 SQL2008 x64 SP2 Reporting Services，

客户端 PC 环境：Windows XP SP2 IE6 或更高版本，所有用户都登录到 Active Directory，用户不是本地管理员或超级用户组的成员。

错误：当用户打印报告时出现“无法加载客户端打印控件”错误

适合我们的解决方案：用 SQL 2008 R2 替换 sql 2008 中的以下文件

Program Files\Microsoft SQL Server\MSRS10.MSSQLSERVER\Reporting Services\ReportServer\bin RSClientPrint-x86.cab RSClientPrint-x64.cab RSClientPrint-ia64.cab

一旦您替换了文件，服务器用户就不会出现上述错误，并且他们不需要本地高级用户或管理员权限即可下载 Active X。建议通过 Active Directory GP 将报表服务器 URL 添加为受信任站点（添加到受信任站点）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-11T22:43:10.893

这个修复对我有用：

已安装 Report Viewer 2008 SP1 Redistributable：[http ://www.microsoft.com/downloads/details.aspx?familyid=6aaa74bd-a46e-4478-b4e1-2063d18d2d42](http://www.microsoft.com/downloads/details.aspx?familyid=6aaa74bd-a46e-4478-b4e1-2063d18d2d42)

从这里获取解决方案：http: [//blogs.msdn.com/b/brianhartman/archive/2009/10/13/gdi-updated-again.aspx](http://blogs.msdn.com/b/brianhartman/archive/2009/10/13/gdi-updated-again.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-02-22T08:14:21.417

就我而言，当我收到此消息时，IE 建议我安装 Microsoft 的附加组件。安装后问题解决。

我的软件：
**IE9**，但也适用于较旧的
**SQL SERVER 2008 R2**

# ajax - IE6 是否支持 XMLHttpRequest.abort()？

> ID：340153
> 
> 赞同：3
> 
> 时间：2008-12-04T10:29:42.853
> 
> 标签：ajax, internet-explorer, xmlhttprequest

我是否正确理解 XMLHttpRequest 对象的 abort() 方法仅从 MSIE 7 开始可用？如果是这样，我有什么等效选项可以在 MSIE 6 中中止 XMLHttpRequest 对象超时？

恐怕此时使用 JS 框架来抽象问题不是一种选择:(。我在一个接近生产截止日期的遗留系统上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T10:49:27.837

在 IE6 上，您手动实例化 MSXML HTTPRequest，因此一切都取决于您最终使用的版本。

abort[在 MSXML 3.0 及更高版本中实现](http://msdn.microsoft.com/en-us/library/ms760349(VS.85).aspx)。换句话说，如果您可以实例化此版本或更高版本（而不是 2.0 或 2.6），则可以使用 abort。

据我所知，IE6 应在未指定其他任何内容时使用 MSXML 3.0 ( [http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml- in-internet-explorer.aspx](http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx)似乎证实了这一点），所以它*应该*开箱即用 - 但我现在无法测试这个，因为我无法访问 IE6 机器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T10:33:16.653

我希望使用 jQuery 之类的框架来使用 javascript 执行 http 请求。它们很好地抽象出浏览器的差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T10:50:48.520

请记住，IE 并不真正支持 XMLHttpRequest，但 Microsoft.XMLHTTP 和各种相关的风格，答案是 abort 是否可用，具体取决于我相信的实例化对象。

[这篇](http://www.quirksmode.org/blog/archives/2005/09/xmlhttp_notes_a_1.html)文章和[这篇](http://geekswithblogs.net/lorint/archive/2006/03/07/71625.aspx)文章可能会帮助您解决您遇到的问题。

# user-interface - 针对常见可用性问题的典型 GUI 解决方案的网站？

> ID：340158
> 
> 赞同：1
> 
> 时间：2008-12-04T10:30:45.800
> 
> 标签：user-interface

今天发生了一个讨论，其中包含数据的网格，最终附加了数据，认为主从类型的网格，然后是一个问题，所以我想我会在这里问这个问题，希望有人有答案或一些指示.

如果你有一个问题，你想知道*我应该如何做到这一点，以便用户有宾至如归的感觉，或者知道使用我的 GUI 的方式*，是否有一个网站或其他东西可以让你找到典型的方法做事？

例如，考虑一个网格，您可以在其中选择一堆东西，然后处理它们。

这样的列表可以通过使用复选框或多选来完成。然后有人说“我们需要显示所选行的历史数据”。一个典型的解决方案是原始网格内的子网格，您可以扩展您感兴趣的行吗？它会是一个显示历史数据的弹出对话框吗？

这个问题变得非常笼统，我知道，但是有谁知道任何网站有这样的东西，甚至远程有用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T10:40:11.163

Welie.com的[模式库](http://www.welie.com/patterns/)令人难以置信。它为您提供了常见场景、其背后的理论以及遵循该模式的实时站点示例。

我不是网页设计师，但非常感谢这个网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T11:16:09.843

前几天我发现[了这个网站](http://www.ecommr.com/)，它更多地是其他人如何做事的参考，但可能很有用（尤其是当它建立起来更多时）。

# asp.net-mvc - ASP.NET MVC 的插件架构

> ID：340183
> 
> 赞同：70
> 
> 时间：2008-12-04T10:40:22.210
> 
> 标签：asp.net-mvc

我一直在花一些时间查看 Phil Haack 关于[分组控制器](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)的文章非常有趣。

目前，我正试图弄清楚是否可以使用相同的想法为我正在从事的项目创建插件/模块化架构。

所以我的问题是：是否有可能将 Phil 文章中的领域拆分到多个项目中？

我可以看到名称空间会自行解决，但我担心视图最终会出现在正确的位置。是否可以通过构建规则进行整理？

假设在单个解决方案中可以使用多个项目，那么是否有人对使用单独的解决方案和对一组预定义的接口进行编码的最佳方法有任何想法？从区域移动到插件。

我在插件架构方面有一些经验，但不是大众，所以这方面的任何指导都会很有用。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-04T17:07:09.277

几周前我做了一个概念验证，我将一个完整的组件堆栈：一个模型类、一个控制器类及其关联的视图放入一个 DLL，添加/调整了检索视图的 VirtualPathProvider 类的[一个示例](https://stackoverflow.com/questions/236972/using-virtualpathprovider-to-load-aspnet-mvc-views-from-dlls)，所以他们会适当地解决 DLL 中的问题。

最后，我只是将 DLL 放入一个适当配置的 MVC 应用程序中，它的工作方式就像它从一开始就是 MVC 应用程序的一部分一样。我把它推得更远了，它与这些小型 MVC 插件中的 5 个一起工作得很好。显然，当你到处乱放时，你必须注意你的引用和配置依赖关系，但它确实有效。

该练习的目的是针对我正在为客户构建的基于 MVC 的平台的插件功能。在站点的每个实例中，有一组核心控制器和视图通过更多可选的控制器和视图进行扩充。我们将把这些可选位添加到这些模块化 DLL 插件中。到现在为止还挺好。

我在我的网站上写了我的原型和[ASP.NET MVC 插件的示例解决方案](http://www.wynia.org/wordpress/2008/12/aspnet-mvc-plugins/)的概述。

编辑：4 年过去了，我一直在用插件做很多 ASP.NET MVC 应用程序，不再使用我上面描述的方法。此时，我通过 MEF 运行我的所有插件，并且根本不将控制器放入插件中。相反，我制作了使用路由信息来选择 MEF 插件并将工作交给插件等的通用控制器。只是想我会添加，因为这个答案得到了相当多的打击。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-24T14:35:55.797

我实际上正在开发一个可在 ASP.NET MVC 之上使用的可扩展性框架。我的可扩展性框架基于著名的 Ioc 容器：Structuremap。

我试图实现的用例很简单：创建一个应用程序，它应该具有一些可以为每个客户扩展的基本功能（=多租户）。应该只托管一个应用程序实例，但此实例可以适用于每个客户，而无需对核心网站进行任何更改。

我受到 Ayende Rahien 撰写的关于多租户的文章的启发：http://ayende.com/Blog/archive/2008/08/16/Multi-Tenancy--Approaches-and-Applicability.aspx[另一个](http://ayende.com/Blog/archive/2008/08/16/Multi-Tenancy--Approaches-and-Applicability.aspx) 灵感来源是Eric Evans 关于领域驱动设计的书。我的可扩展性框架基于存储库模式和根聚合的概念。为了能够使用该框架，托管应用程序应该围绕存储库和域对象构建。控制器、存储库或域对象在运行时由 ExtensionFactory 绑定。

插件只是一个组件，其中包含尊重特定命名约定的控制器或存储库或域对象。命名约定很简单，每个类都应以 customerID 为前缀，例如：AdventureworksHomeController。

要扩展应用程序，您将插件程序集复制到应用程序的扩展文件夹中。当用户请求客户根文件夹下的页面时，例如： [http://multitenant-site.com/[customerID]/[controller]/[action]](http://multitenant-site.com/[customerID]/[controller]/[action]) 框架检查是否有该特定客户的插件并实例化自定义插件类，否则它会加载默认值一次。自定义类可以是控制器——存储库或域对象。这种方法可以通过域模型、存储库在所有级别上扩展应用程序，从数据库到 UI。

当您想要扩展某些现有功能时，您可以创建一个插件，该程序集包含核心应用程序的子类。当您必须创建全新的功能时，您可以在插件中添加新的控制器。当请求相应的 url 时，这些控制器将由 MVC 框架加载。如果您想扩展 UI，您可以在扩展文件夹中创建一个新视图，并通过新的或子类控制器引用该视图。要修改现有行为，您可以创建新的存储库或域对象或子类现有的。框架的职责是确定应该为特定客户加载哪个控制器/存储库/域对象。
我建议看看结构图（[http://structuremap.sourceforge.net/Default.htm](http://structuremap.sourceforge.net/Default.htm)) 尤其是在注册表 DSL 功能[http://structuremap.sourceforge.net/RegistryDSL.htm](http://structuremap.sourceforge.net/RegistryDSL.htm)。

这是我在应用程序启动时用来注册所有插件控制器/存储库或域对象的代码：

```
protected void ScanControllersAndRepositoriesFromPath(string path)
        {
            this.Scan(o =>
            {
                o.AssembliesFromPath(path);
                o.AddAllTypesOf<SaasController>().NameBy(type => type.Name.Replace("Controller", ""));
                o.AddAllTypesOf<IRepository>().NameBy(type => type.Name.Replace("Repository", ""));
                o.AddAllTypesOf<IDomainFactory>().NameBy(type => type.Name.Replace("DomainFactory", ""));
            });
        } 
```

我还使用继承自 System.Web.MVC 的 ExtensionFactory。默认控制器工厂。该工厂负责加载扩展对象（控制器/注册表或域对象）。您可以通过在启动时在 Global.asax 文件中注册自己的工厂来插入它们：

```
protected void Application_Start()
        {
            ControllerBuilder.Current.SetControllerFactory(
                new ExtensionControllerFactory()
                );
        } 
```

**这个框架作为一个完全可操作的示例站点可以在以下位置找到：[http](http://code.google.com/p/multimvc/) : //code.google.com/p/multimvc/**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-09T16:38:19.813

因此，我对上面[J Wynia](https://stackoverflow.com/users/1124/j-wynia)的示例进行了一些尝试。非常感谢那个顺便说一句。

我改变了一些东西，以便 VirtualPathProvider 的扩展使用静态构造函数来创建系统中各种 dll 中以 .aspx 结尾的所有可用资源的列表。这很费力，但只有我们只做一次。

这可能完全滥用了 VirtualFiles 的使用方式；-)

你最终得到一个：

私有静态 IDictionary 资源虚拟文件；

字符串是虚拟路径。

下面的代码对 .aspx 文件的命名空间做了一些假设，但它适用于简单的情况。这样做的好处是您不必创建复杂的视图路径，它们是从资源名称创建的。

```
class ResourceVirtualFile : VirtualFile
{
    string path;
    string assemblyName;
    string resourceName;

    public ResourceVirtualFile(
        string virtualPath,
        string AssemblyName,
        string ResourceName)
        : base(virtualPath)
    {
        path = VirtualPathUtility.ToAppRelative(virtualPath);
        assemblyName = AssemblyName;
        resourceName = ResourceName;
    }

    public override Stream Open()
    {
        assemblyName = Path.Combine(HttpRuntime.BinDirectory, assemblyName + ".dll");

        Assembly assembly = Assembly.ReflectionOnlyLoadFrom(assemblyName);
        if (assembly != null)
        {
            Stream resourceStream = assembly.GetManifestResourceStream(resourceName);
            if (resourceStream == null)
                throw new ArgumentException("Cannot find resource: " + resourceName);
            return resourceStream;
        }
        throw new ArgumentException("Cannot find assembly: " + assemblyName);
    }

    //todo: Neaten this up
    private static string CreateVirtualPath(string AssemblyName, string ResourceName)
    {
        string path = ResourceName.Substring(AssemblyName.Length);
        path = path.Replace(".aspx", "").Replace(".", "/");
        return string.Format("~{0}.aspx", path);
    }

    public static IDictionary<string, VirtualFile> FindAllResources()
    {
        Dictionary<string, VirtualFile> files = new Dictionary<string, VirtualFile>();

        //list all of the bin files
        string[] assemblyFilePaths = Directory.GetFiles(HttpRuntime.BinDirectory, "*.dll");
        foreach (string assemblyFilePath in assemblyFilePaths)
        {
            string assemblyName = Path.GetFileNameWithoutExtension(assemblyFilePath);
            Assembly assembly = Assembly.ReflectionOnlyLoadFrom(assemblyFilePath);  

            //go through each one and get all of the resources that end in aspx
            string[] resourceNames = assembly.GetManifestResourceNames();

            foreach (string resourceName in resourceNames)
            {
                if (resourceName.EndsWith(".aspx"))
                {
                    string virtualPath = CreateVirtualPath(assemblyName, resourceName);
                    files.Add(virtualPath, new ResourceVirtualFile(virtualPath, assemblyName, resourceName));
                }
            }
        }

        return files;
    }
} 
```

然后，您可以在扩展的 VirtualPathProvider 中执行以下操作：

```
 private bool IsExtended(string virtualPath)
    {
        String checkPath = VirtualPathUtility.ToAppRelative(virtualPath);
        return resourceVirtualFile.ContainsKey(checkPath);
    }

    public override bool FileExists(string virtualPath)
    {
        return (IsExtended(virtualPath) || base.FileExists(virtualPath));
    }

    public override VirtualFile GetFile(string virtualPath)
    {
        string withTilda = string.Format("~{0}", virtualPath);

        if (resourceVirtualFile.ContainsKey(withTilda))
            return resourceVirtualFile[withTilda];

        return base.GetFile(virtualPath);
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-04T11:48:34.817

我想可以将您的观点留在插件项目中。

这就是我的想法：您需要一个 ViewEngine 来调用插件（可能通过接口）并请求视图（IView）。然后，插件将不通过其 url 实例化视图（就像普通的 ViewEngine 所做的那样 - /Views/Shared/View.asp），而是通过其视图名称）实例化视图），例如通过反射或 DI/IoC 容器）。

插件中视图的返回甚至可能是硬编码的（简单示例如下）：

```
public IView GetView(string viewName)
{
    switch (viewName)
    {
        case "Namespace.View1":
            return new View1();
        case "Namespace.View2":
            return new View2();
        ...
    }
} 
```

...这只是一个想法，但我希望它可以发挥作用，或者只是一个很好的灵感。

# c++ - 使用 GDAL/OGR api 读取矢量数据（shapefile）--如何？

> ID：340185
> 
> 赞同：1
> 
> 时间：2008-12-04T10:40:34.487
> 
> 标签：c++, linux, opengl, gdal

我正在开发一个涉及一些 gis 东西的应用程序。将有一些 .shp 文件被读取并绘制到 opengl 屏幕上。当前的opengl屏幕正在使用从设置的正交投影，`glOrtho()`并且已经使用来自简单文本文件的坐标显示地图。

现在要绘制的地图将从 shapefile 中读取。

我有以下疑问：

1.  如何使用 .shp 文件的 WGS84 投影（从 shapefile 的 .prj 文件读取，WKT 格式）到我现有的 glOrtho 投影中。是否需要进行任何转换？它与 glOrtho() 设置的内容有何不同？基本上如何使用这些信息？

2.  我的应用程序需要以这样一种方式设置，即我可以知道地图上某个点的确切纬度/经度。例如。如果我在 X 城市上徘徊，则可以获取其正确的纬度/经度。我知道这可以通过使用像 GDAL/OGR 这样的开源工具/apis 来完成，但我搞砸了，因为这些 apis 的文档没有进入我的头。我试图找到一些示例 c++ progs 但找不到。

3.  我已经编写了自己的逻辑来从包含点/折线/多边形（使用 C-shapelib）的 shapefile 中读取坐标并绘制在我的 opengl 屏幕上。我在 doc 中找到了一个 OGR 示例代码来读取 POINTS shapefile 但没有POLYGON shapefile。问题是这个应用程序必须非常动态，以便在加载 shapefile 时，它​​应该根据正在读取的 .shp 文件的投影正确设置 opengl 屏幕的投影。例如 WGS84、LCC、EVEREST修改...等。如何从 OGR api 实现这一点？

请就这个问题提供您的意见。我真的很想完成这项工作，但我没有得到正确的开始..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T16:21:59.667

1.  Shapefile 渲染在 OpenGL 中非常简单。您可能需要“shapelib”，这是一个免费的 C 语言 shapefile 解析库（Google it）。点 shapefile 使用 GL_POINTS，线 shapefile 使用 GL_LINES，多边形 shapefile 使用 GL_LINE_LOOP。将边界框坐标设置为 Ortho。

2.  您从 .prj 文件中读取的是投影信息。WGS84 为您提供纬度/经度坐标（球形）。但是您的显示系统是 2D（矩形）。因此，您需要将 3D 球面坐标转换为 2D 矩形坐标（这是投影的含义）。投影类型很多，取决于地球上感兴趣的区域（记住投影会扭曲特征的区域/形状/大小）。投影类型包括 Polyconic、Modified Everest、NAD、UTM 等，

3.  如果您只需要 WGS84，则读取 .sh 文件的边界框坐标并将它们分配给 glOrtho。如果您有任何投影（例如：-UTM），则将边界框坐标转换为投影坐标，然后将新投影的坐标分配给 glOrtho。要将纬度/经度转换为任何投影，您可能需要投影库，如“Projlib”或“GeotransEngine”等。

如需进一步说明，您可以通过 dgplinux@yahoo 与我联系。com

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-24T16:26:55.160

请阅读[OGR API 教程](http://gdal.org/ogr/ogr_apitut.html)，您可以在其中学习如何从 Shapefile 等来源读取矢量数据。接下来，查看[OGR 投影教程](http://gdal.org/ogr/osr_tutorial.html)，您可以在其中了解如何使用从 OGR 源读取的有关投影和空间参考系统的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-07T00:01:24.413

GDAL/OGR 拥有加载矢量文件，然后转换任何坐标所需的一切。我理解您对 GDAL 的失望，因为文档不是最好的。如果您想了解如何使用 API，请查看 GDAL 颠覆树中的 gdalinfo.c 和 ogrinfo.cpp。来源可以在[https://svn.osgeo.org/gdal/trunk/gdal](https://svn.osgeo.org/gdal/trunk/gdal)看到。

如果这没有帮助，我有两个基本示例用于解析矢量信息并进行坐标转换。他们真的很糟糕，但他们可能有助于理解这一点。

[矢量加载](https://github.com/marvins/Code_Sandbox/blob/master/c%2B%2B/gdal/ogr/vector_demo.cpp)

[坐标转换](https://github.com/marvins/Code_Sandbox/tree/master/c%2B%2B/gdal/coordinate_conversion)

最后，如果您不熟悉 GIS 格式，我会考虑阅读[/](http://resources.arcgis.com/en/help/main/10.1/index.html)`Guide Books`下的ArcGIS 介绍`Map Projections`。由于这些指南，我可以与专家竞争，尽管没有制图培训。另一个很好的来源是维基百科。

如有疑问，只需选择一个您想要坚持的 UTM 网格并将 UTM 用作您的坐标系。它使用 X（东）、Y（北）和 Z（海拔）。唯一的关键是选择一个 UTM Grid 并确保所有坐标都使用它作为参考。UTM 很容易测试代码，因为有很多在线指南。您还可以使用 OGR/GDAL 或其他资源找到转换代码。其他投影坐标系是值得的，可能会更好，但我会先看一下。

最后，如果一切都失败了，看看 NGA GeoTrans。这是一个很棒的测试工具。

# compact-framework - 如何在移动设备上获取 WLAN 信息？

> ID：340191
> 
> 赞同：1
> 
> 时间：2008-12-04T10:42:07.947
> 
> 标签：compact-framework, windows-ce, wifi

我想构建一个类似网络扫描仪的东西，以便在我的应用程序中看到我在哪个接入点上以及这个网络有什么参数。

一些有趣的点是 ESSID、信号强度、噪声、信道。

这些属性设备独立还是我必须独立连接每个设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T12:21:26.733

我还没有尝试过，但我相信 OpenNetCF 是你的朋友：

[http://www.opennetcf.com/library/networkinformation/](http://www.opennetcf.com/library/networkinformation/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T15:21:02.157

这与这个问题实际上是同一个问题：[Accessing a list of available Wifi APs, on Windows Mobile](https://stackoverflow.com/questions/322070)

总结起来，答案是您可以 P/Invoke WZC，但这很困难。智能[设备框架](http://www.smartdeviceframework.com)做到了。

# web-services - webservice oneway 和新的 SPSite(myUrl)

> ID：340192
> 
> 赞同：1
> 
> 时间：2008-12-04T10:42:19.693
> 
> 标签：web-services, sharepoint, moss

我对打开 moss 站点的单向 Web 方法有疑问（可能是因为在单向 Web 方法中，上下文为空）

是否可以重写此代码以删除空引用异常？（没有单向属性我没有例外）

```
[SoapDocumentMethod(OneWay = true)]
        [WebMethod(Description = "TestOneWay")]
        public voidTestOneWay(string webUrl)
        {
            using (SPSite site = new SPSite(webUrl))
            {
                 ....
            }
         } 
```

例外是：

```
[2304] Error:Object reference not set to an instance of an object.
[2304] w3wp.exe Error: 0 :
[2304StackTrace:   at System.Web.Hosting.ISAPIWorkerRequestInProc.GetAdditionalServerVar(Int32 index)
[2304]    at System.Web.Hosting.ISAPIWorkerRequestInProc.GetServerVariable(String name)
[2304]    at System.Web.HttpRequest.AddServerVariableToCollection(String name)
[2304]    at System.Web.HttpRequest.FillInServerVariablesCollection()
[2304]    at System.Web.HttpServerVarsCollection.Populate()
[2304]    at System.Web.HttpServerVarsCollection.Get(String name)
[2304]    at System.Collections.Specialized.NameValueCollection.get_Item(String name)
[2304]    at Microsoft.SharePoint.SPGlobal.CreateSPRequestAndSetIdentity(Boolean bNotGlobalAdminCode, String strUrl, Boolean bNotAddToContext, Byte[] UserToken, String userName, Boolean bIgnoreTokenTimeout, Boolean bAsAnonymous)
[2304]    at Microsoft.SharePoint.SPRequestManager.GetContextRequest(SPRequestAuthenticationMode authenticationMode)
[2304]    at Microsoft.SharePoint.Administration.SPFarm.get_RequestNoAuth()
[2304]    at Microsoft.SharePoint.SPSite.CopyUserToken(SPUserToken userToken)
[2304]    at Microsoft.SharePoint.SPSite.SPSiteConstructor(SPFarm farm, Guid applicationId, Guid contentDatabaseId, Guid siteId, SPUrlZone zone, Uri requestUri, String serverRelativeUrl, Boolean hostHeaderIsSiteName, Uri redirectUri, Pairing pairing, SPUserToken userToken)
[2304]    at Microsoft.SharePoint.SPSite..ctor(SPFarm farm, Uri requestUri, Boolean contextSite, SPUserToken userToken)
[2304]    at Microsoft.SharePoint.SPSite..ctor(String requestUrl)
[2304]    at Reply.Moss2EAI.SPHandler.GetAllFlowConfiguration(String webUrl, String flowConList)
[2304]    at Reply.Moss2EAI.EaiMossIntegration.GetMessagesFromEai(String webUrl, String listName, String applicationName) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T10:28:00.577

我找到了解决我的问题的解决方法。创建新的 HttpContext。现在的问题是：这是正确的解决方案还是有我不考虑的影响？

我用来改变上下文的方法是这样的：

```
//Call this before call new SPSite()
 private static void ChangeContext(string webUrl)
        {
            Trace.TraceInformation("ChangeContext");
            HttpContext current = HttpContext.Current;
            HttpRequest request = new HttpRequest("", webUrl, "");
            HttpContext.Current = new HttpContext(request, new HttpResponse(new StringWriter(CultureInfo.CurrentCulture)));
            HttpContext.Current.User = current.User;
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T19:30:08.647

我看到的唯一含义是您实际上正在使用新的 HttpContext。

嗯..duh :)

Anyway, this will have implications if you also have input- and outputfilters set up. For example if you are using WebServiceExtensions (WSE) with your own input and outputfilters. In that case, you should store the data in the HttpContext (that is there in your input- and outputfilters) and use that one. Just so that you use only one httpContext, instead of creating a second one, and to prevent any future errors when extending your software.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-27T11:22:43.310

Use this will work for you:

```
SPWeb web = SPContext.Current.Web 
```

# php - Zend_Validator 问题？

> ID：340194
> 
> 赞同：1
> 
> 时间：2008-12-04T10:43:18.490
> 
> 标签：php, zend-framework

如何使用 Zend 框架验证字母和空格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T16:01:27.863

Zend 框架确实有一个[Zend_Validate_Alpha](http://framework.zend.com/manual/en/zend.validate.set.html#zend.validate.set.alpha)（以及一个[字母数字版本](http://framework.zend.com/manual/en/zend.validate.set.html#zend.validate.set.alnum)）。

通常它不允许空格，但如果你将 a 传递给[Zend_Validate_Alpha](http://framework.zend.com/apidoc/core/Zend_Validate/Zend_Validate_Alpha.html#__construct)`true`类的构造函数， 它将允许空格。与[Zend_Validate_Alnum](http://framework.zend.com/apidoc/core/Zend_Validate/Zend_Validate_Alnum.html#__construct)相同。

例如：

```
$validator = new Zend_Validate_Alpha(true); //will allow whitespace and non number letters 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T11:43:24.843

我认为 Zend_Validate_Regex 最适合这种情况

# scheme - 用于嵌套表达式的方案宏

> ID：340204
> 
> 赞同：5
> 
> 时间：2008-12-04T10:50:14.887
> 
> 标签：scheme, macros, nested, define-syntax

可以用 Scheme 编写一个宏（`define-syntax`例如，使用 ），它将采用如下表达式：

```
(op a b c d e f g h i j) 
```

并将这样的表达式作为输出？

```
(op (op (op (op (op (op (op (op (op a b) c) d) e) f) g) h) i) j) 
```

当然，对于任意长度。给定这样的模板，我想不出办法：

```
(define-syntax op
  (syntax-rules ()
    [(_) 'base-case]
    [(v1 v2 ...) 'nested-case??])) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T11:40:47.687

```
(define bop list)

(define-syntax op
  (syntax-rules ()
    ((op a b) (bop a b))
    ((op a b c ...) (op (bop a b) c ...)))) 
```

例如，`(op 1 2 3 4)`展开`(bop (bop (bop 1 2) 3) 4)`并计算为`(((1 2) 3) 4)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T20:27:26.263

您要应用于参数的函数本身应该是宏的参数。除此之外，我的解决方案是相同的。

```
#!r6rs

(import (rnrs base))

(define-syntax claudiu
  (syntax-rules ()
    ((claudiu fun first second)
     (fun first second))
    ((claudiu fun first second rest ...)
     (claudiu fun (claudiu fun first second) rest ...)))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T18:52:52.137

为了显示答案是如何产生的：

```
(op 1 2 3 4) 
```

这是一个有 4 条语句的操作，所以第二种情况被选择为 a=1, b=2, c=3, ...=4：

```
(op (bop 1 2) 3 4) 
```

这是一个有 3 条语句的操作，所以又是第 2 种情况。a=(bop 1 2), b=3, c=4:

```
(op (bop (bop 1 2) 3) 4) 
```

现在这是一个带有 2 个语句的 bop，所以 a=(bop (bop 1 2) 3), b=4，就完成了。

# language-agnostic - 为功率计生成红色和绿色之间的颜色？

> ID：340209
> 
> 赞同：143
> 
> 时间：2008-12-04T10:56:25.187
> 
> 标签：language-agnostic, graphics, colors, interpolation

我正在编写一个 Java 游戏，并且我想实现一个功率计来衡量你将要拍摄的东西有多难。

我需要编写一个函数，它采用 0 - 100 之间的 int，并且根据该数字的高低，它将返回绿色（功率刻度上的 0）和红色（功率刻度上的 100）之间的颜色。

类似于音量控制的工作方式：
![音量控制](https://i.stack.imgur.com/uErDJ.png)

我需要对颜色的红、绿、蓝分量进行什么操作才能生成介于绿和红之间的颜色？

所以，我可以说，`getColor(80)`它会返回橙色（它的值在 R、G、B 中）或者`getColor(10)`返回更多的绿色/黄色 RGB 值。

我知道我需要为新颜色增加 R、G、B 值的分量，但我不知道随着颜色从绿红转变，具体是什么上升或下降。

* * *

进步：

我最终使用了 HSV/HSB 颜色空间，因为我更喜欢渐变（中间没有深棕色）。

我使用的功能是：

```
public Color getColor(double power)
{
    double H = power * 0.4; // Hue (note 0.4 = Green, see huge chart below)
    double S = 0.9; // Saturation
    double B = 0.9; // Brightness

    return Color.getHSBColor((float)H, (float)S, (float)B);
} 
```

其中“power”是一个介于 0.0 和 1.0 之间的数字。0.0 将返回鲜红色，1.0 将返回鲜绿色。

Java色相图：
![Java 色相图](https://i.stack.imgur.com/QphuU.png)

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-12-04T10:59:23.123

这应该有效 - 只需线性缩放红色和绿色值。假设您的最大红/绿/蓝值为`255`，并且`n`在范围内`0 .. 100`

```
R = (255 * n) / 100
G = (255 * (100 - n)) / 100 
B = 0 
```

*（修正了整数数学，向费鲁西奥致敬）*

另一种方法是使用[HSV 颜色模型](http://www.cs.rit.edu/~ncs/color/t_convert.html)，并以适合您的饱和度和值将色调从`0 degrees`（红色）循环到（绿色）。`120 degrees`这应该会产生更令人愉悦的渐变。

这是每种技术的演示 - 顶部渐变使用 RGB，底部使用 HSV：

![http://i38.tinypic.com/29o0q4k.jpg](https://i.stack.imgur.com/ZkoHs.jpg)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-12-04T11:16:06.210

在我的脑海中，这是 HSV 空间中的绿红色色调过渡，转换为 RGB：

```
blue = 0.0
if 0<=power<0.5:        #first, green stays at 100%, red raises to 100%
    green = 1.0
    red = 2 * power
if 0.5<=power<=1:       #then red stays at 100%, green decays
    red = 1.0
    green = 1.0 - 2 * (power-0.5) 
```

上例中的红色、绿色、蓝色值是百分比，您可能希望将它们乘以 255 以获得最常用的 0-255 范围。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-11-06T10:49:07.727

简短的复制粘贴答案...

**在 Java 标准上：**

```
int getTrafficlightColor(double value){
    return java.awt.Color.HSBtoRGB((float)value/3f, 1f, 1f);
} 
```

**在安卓上：**

```
int getTrafficlightColor(double value){
    return android.graphics.Color.HSVToColor(new float[]{(float)value*120f,1f,1f});
} 
```

注意： value 是一个介于 0 和 1 之间的数字，表示红到绿的状态。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-01-29T13:01:31.333

如果您想要像接受的答案所建议的那样的绿色-黄色-红色表示，那么请看一下这个。

[http://jsfiddle.net/0awncw5u/2/](http://jsfiddle.net/0awncw5u/2/)

```
function percentToRGB(percent) {
    if (percent === 100) {
        percent = 99
    }
    var r, g, b;

    if (percent < 50) {
        // green to yellow
        r = Math.floor(255 * (percent / 50));
        g = 255;

    } else {
        // yellow to red
        r = 255;
        g = Math.floor(255 * ((50 - percent % 50) / 50));
    }
    b = 0;

    return "rgb(" + r + "," + g + "," + b + ")";
}

function render(i) {
    var item = "<li style='background-color:" + percentToRGB(i) + "'>" + i + "</li>";
    $("ul").append(item);
}

function repeat(fn, times) {
    for (var i = 0; i < times; i++) fn(i);
}

repeat(render, 100);
```

```
li {
    font-size:8px;
    height:10px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<ul></ul>
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-04T11:07:45.413

绿色和红色之间的线性插值*几乎*应该可以工作，只是中间会有泥泞的棕色。

最灵活和最好看的解决方案是在某个地方拥有一个具有您想要的确切色带的图像文件。然后在那里查找像素值。这具有您可以将渐变调整到*恰到好处*的灵活性。

如果您仍想从代码中执行此操作，那么最好在左侧的绿色和黄色之间以及右侧的黄色和红色之间进行插值。在RGB空间中，绿色为（R=0，G=255，B=0），黄色为（R=255，G=255，B=0），红色为（R=255，G=0，B=0） ) - 这是假设每个颜色分量从 0 到 255。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-11-05T19:09:01.083

我做了一个小函数，它为您提供百分比值的 rgb 整数值：

```
private int getGreenToRedGradientByValue(int currentValue, int maxValue)
{
    int r = ( (255 * currentValue) / maxValue );
    int g = ( 255 * (maxValue-currentValue) ) / maxValue;
    int b = 0;
    return ((r&0x0ff)<<16)|((g&0x0ff)<<8)|(b&0x0ff);
} 
```

所以如果你的 currentValue 是 50 并且你的 maxValue 是 100，这个函数将返回你需要的颜色，所以如果你用一个百分比值循环这个函数，你的颜色值将从绿色变为红色。抱歉解释不好

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-05-26T08:32:43.540

我会说你想要在 HSV 空间中的线段（中间有一个稍微太亮的黄色）和 RGB 空间中的线段（中间有一个难看的棕色）之间的东西。我会用这个，哪里`power = 0`会给出绿色，`power = 50`会给出一个稍微暗淡的黄色，然后`power = 100`会给出红色。

```
blue = 0;
green = 255 * sqrt( cos ( power * PI / 200 ));
red = 255 * sqrt( sin ( power * PI / 200 )); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-05-14T01:51:31.067

接受的答案甚至没有真正回答这个问题......

# C++

这是我的引擎中的一个简单的 C++ 代码段，它在三种任意颜色之间线性有效地插值：

```
const MATH::FLOAT4 color1(0.0f, 1.0f, 0.0f, 1.0f);  // Green
const MATH::FLOAT4 color2(1.0f, 1.0f, 0.0f, 1.0f);  // Yellow
const MATH::FLOAT4 color3(1.0f, 0.0f, 0.0f, 1.0f);  // Red

MATH::FLOAT4 get_interpolated_color(float interpolation_factor)
{
    const float factor_color1 = std::max(interpolation_factor - 0.5f, 0.0f);
    const float factor_color2 = 0.5f - fabs(0.5f - interpolation_factor);
    const float factor_color3 = std::max(0.5f - interpolation_factor, 0.0f);

    MATH::FLOAT4 color;

    color.x = (color1.x * factor_color1 +
               color2.x * factor_color2 +
               color3.x * factor_color3) * 2.0f;

    color.y = (color1.y * factor_color1 +
               color2.y * factor_color2 +
               color3.y * factor_color3) * 2.0f;

    color.z = (color1.z * factor_color1 +
               color2.z * factor_color2 +
               color3.z * factor_color3) * 2.0f;

    color.w = 1.0f;

    return(color);
} 
```

`interpolation_factor`假定在 范围内`0.0 ... 1.0`。
假设颜色在范围内`0.0 ... 1.0`（例如对于 OpenGL）。

# C＃

这是用 C# 编写的相同函数：

```
private readonly Color mColor1 = Color.FromArgb(255, 0, 255, 0);
private readonly Color mColor2 = Color.FromArgb(255, 255, 255, 0);
private readonly Color mColor3 = Color.FromArgb(255, 255, 0, 0);

private Color GetInterpolatedColor(double interpolationFactor)
{
    double interpolationFactor1 = Math.Max(interpolationFactor - 0.5, 0.0);
    double interpolationFactor2 = 0.5 - Math.Abs(0.5 - interpolationFactor);
    double interpolationFactor3 = Math.Max(0.5 - interpolationFactor, 0.0);

    return (Color.FromArgb(255,
                (byte)((mColor1.R * interpolationFactor1 +
                        mColor2.R * interpolationFactor2 +
                        mColor3.R * interpolationFactor3) * 2.0),

                (byte)((mColor1.G * interpolationFactor1 +
                        mColor2.G * interpolationFactor2 +
                        mColor3.G * interpolationFactor3) * 2.0),

                (byte)((mColor1.B * interpolationFactor1 +
                        mColor2.B * interpolationFactor2 +
                        mColor3.B * interpolationFactor3) * 2.0)));
} 
```

`interpolationFactor`假定在 范围内`0.0 ... 1.0`。
假设颜色在 范围内`0 ... 255`。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-04T11:11:08.480

您需要对颜色分量进行[线性插值](http://en.wikipedia.org/wiki/Linear_interpolation)(LERP)。给定一个起始值**v0**，一个结束值**v1**和所需的**比率**（0.0 和 1.0 之间的标准化浮点数），这是一般的完成方式：

```
v = v0 + ratio * (v1 - v0) 
```

这在比率为 0.0 时给出 v0，在比率为 1.0 时给出 v1，以及其他情况下的所有内容。

您可以在 RGB 组件上执行此操作，也可以使用其他一些配色方案，如 HSV 或 HLS。后两者在视觉上会更令人愉悦，因为它们处理的色调和亮度成分可以更好地映射到我们的色彩感知。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-06-25T19:41:26.767

这是 Swift 和 HSV 规模的复制和粘贴解决方案：

UIColor 初始化程序接受 [0, 1] 中的色调、饱和度和亮度，因此对于 [0, 1] 中的给定**值**，我们有：

```
let hue:        CGFloat = value / 3
let saturation: CGFloat = 1 // Or choose any
let brightness: CGFloat = 1 // Or choose any
let alpha:      CGFloat = 1 // Or choose any

let color = UIColor(hue: hue, saturation: saturation, brightness: brightness, alpha: alpha) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-07-05T14:05:05.143

```
import java.awt.Color;

public class ColorUtils {

    public static Color interpolate(Color start, Color end, float p) {
        float[] startHSB = Color.RGBtoHSB(start.getRed(), start.getGreen(), start.getBlue(), null);
        float[] endHSB = Color.RGBtoHSB(end.getRed(), end.getGreen(), end.getBlue(), null);

        float brightness = (startHSB[2] + endHSB[2]) / 2;
        float saturation = (startHSB[1] + endHSB[1]) / 2;

        float hueMax = 0;
        float hueMin = 0;
        if (startHSB[0] > endHSB[0]) {
            hueMax = startHSB[0];
            hueMin = endHSB[0];
        } else {
            hueMin = startHSB[0];
            hueMax = endHSB[0];
        }

        float hue = ((hueMax - hueMin) * p) + hueMin;

        return Color.getHSBColor(hue, saturation, brightness);
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-10-05T16:07:46.487

在 Python 2.7 中：

```
import colorsys

def get_rgb_from_hue_spectrum(percent, start_hue, end_hue):
    # spectrum is red (0.0), orange, yellow, green, blue, indigo, violet (0.9)
    hue = percent * (end_hue - start_hue) + start_hue
    lightness = 0.5
    saturation = 1
    r, g, b = colorsys.hls_to_rgb(hue, lightness, saturation)
    return r * 255, g * 255, b * 255

# from green to red:
get_rgb_from_hue_spectrum(percent, 0.3, 0.0)

# or red to green:
get_rgb_from_hue_spectrum(percent, 0.0, 0.3) 
```

百分比当然是`value / max_value`。或者，如果您的比例不是从 0 开始，那么`(value - min_value) / (max_value - min_value)`.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-01-24T00:16:21.933

如果您在 CSS（最低版本 2.1）中需要这种渐变（实际上是反向的），您也可以使用 HSL。

假设您在 AngularJs 模板中，值是从 0 到 1 的数字，并且您想要设置元素的样式（背景或文本颜色）...

```
hsl({{ value * 120}}, 50%, 35%) 
```

第一个值：度数（0 红色，120 绿色）第二个值：饱和度（50% 是中性）第三个值：亮度（50% 中性）

一篇不错的文章[在这里](http://vormplus.be/blog/article/using-colors-in-css)

维基百科的理论在[这里](http://en.wikipedia.org/wiki/HSL_and_HSV)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-08-31T09:08:04.693

这是`Objective-C`Simucal 解决方案的版本：

```
- (UIColor*) colorForCurrentLevel:(float)level
{
    double hue = level * 0.4; // Hue (note 0.4 = Green)
    double saturation = 0.9; // Saturation
    double brightness = 0.9; // Brightness

    return [UIColor colorWithHue:hue saturation:saturation brightness:brightness alpha:1.0];
} 
```

其中 level 将是 和 之间的`0.0`值`1.0`。
希望这对某人有帮助！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-02-01T20:21:06.200

**JavaScript**

我正在使用带有条形图的 Google 可视化，并希望条形图根据百分比从绿色变为红色。结果证明这是我找到的最干净的解决方案，并且效果很好。

```
function getGreenToRed(percent){
    r = percent<50 ? 255 : Math.floor(255-(percent*2-100)*255/100);
    g = percent>50 ? 255 : Math.floor((percent*2)*255/100);
    return 'rgb('+r+','+g+',0)';
} 
```

只要确保你的百分比是 50 代表 50% 而*不是*0.50。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-12-09T14:19:55.970

我已经更新了接受的答案，将其拆分为（0,100）范围的前半部分和后半部分，并用最大级别替换 100，以便范围可以变得动态。结果与 HSV 模型完全相同，但仍使用 RGB。关键是让 (255,255,0) 在中间代表黄色。我在接受的答案和另一个 VBA 代码中结合了这个想法，所以在 VBA 中实现它并在 Excel 中使用。我希望逻辑有所帮助，并且可以在其他语言/应用程序中使用。

```
Sub UpdateConditionalFormatting(rng As Range)
    Dim cell As Range
    Dim max As Integer

    max = WorksheetFunction.max(rng)

    For Each cell In rng.Cells

    If cell.Value >= 0 And cell.Value < max / 2 Then
        cell.Interior.Color = RGB(255 * cell.Value / (max / 2), 255, 0)
    ElseIf cell.Value >= max / 2 And cell.Value <= max Then
        cell.Interior.Color = RGB(255, 255 * ((max) - cell.Value) / (max / 2), 0)
    End If

    Next cell
End Sub 
```

干杯，帕夫林

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-04-04T10:41:57.120

VB

```
Public Function GetPercentageColor( _
  ByVal iPercent As Long, Optional _
  ByVal bOpposit As Boolean) As Long
' 0->100% - Green->Yellow->Red
' bOpposit - Red->Yellow->Green

If bOpposit Then iPercent = (100 - iPercent)

Select Case iPercent
Case Is < 1: GetPercentageColor = 65280 ' RGB(0, 255, 0)
Case Is > 99: GetPercentageColor = 255  ' RGB(255, 0, 0)
Case Is < 50: GetPercentageColor = RGB(255 * iPercent / 50, 255, 0)
Case Else: GetPercentageColor = RGB(255, (255 * (100 - iPercent)) / 50, 0)
End Select

End Function 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-02-03T16:12:55.520

自包含示例

```
<html>
<head>
<script>
//--------------------------------------------------------------------------
function gradient(left, mid, right)
{
    var obj = {}

    var lt50 = {"r":(mid.r-left.r)/50.0,
                "g":(mid.g-left.g)/50.0,
                "b":(mid.b-left.b)/50.0}
    var gt50 = {"r":(right.r-mid.r)/50.0,
                "g":(right.g-mid.g)/50.0,
                "b":(right.b-mid.b)/50.0}

    obj.getColor = function(percent) {
        if (percent == 50.0) {
            return mid;
        }
        if (percent < 50.0) {
            return "rgb("+Math.floor(left.r+lt50.r*percent+0.5)+","+
                          Math.floor(left.g+lt50.g*percent+0.5)+","+
                          Math.floor(left.b+lt50.b*percent+0.5)+")";
        }
        var p2 = percent-50.0;
        return "rgb("+Math.floor(mid.r+gt50.r*p2+0.5)+","+
                      Math.floor(mid.g+gt50.g*p2+0.5)+","+
                      Math.floor(mid.b+gt50.b*p2+0.5)+")";
    }

    return obj;
}

//--------------------------------------------------------------------------
var g_gradient = gradient( {"r":255, "g":20, "b":20},  // Left is red
                           {"r":255, "g":255, "b":20}, // Middle is yellow
                           {"r":20, "g":255, "b":20} ); // right is green

//--------------------------------------------------------------------------
function updateColor()
{
    var percent = document.getElementById('idtext').value.length;
    var oscore = document.getElementById('idscore');

    if (percent > 100.0) {
        percent = 100.0;
    }
    if (percent < 0.0) {
        percent = 0.0;
    }
    var col = g_gradient.getColor(percent)
    oscore.style['background-color'] = col;
    oscore.innerHTML = percent + '%';
}

</script>
</head>
<body onLoad="updateColor()">
<input size='100' placeholder='type text here' id='idtext' type="text" oninput="updateColor()" />
<br />
<br />
<div id='idscore' style='text-align:center; width:200px; border-style:solid;
     border-color:black; border-width:1px; height:20px;'> </div>
</body>
</html> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-03-17T08:39:49.347

这将从红色变为黄色，然后变为绿色，
值从 0 到 100 不等

```
-(UIColor*) redToGreenColorWithPosition:(int) value {

    double R, G;
    if (value > 50) {
        R = (255 * (100 - value)/ 50) ;
        G = 255;
    }else {
        R = 255;
        G = (255 * (value*2)) / 100;
    }

    return [UIColor colorWithRed:R/255.0f green:G/255.0f blue:0.0f alpha:1.0f];
} 
```

# database - 在 Delphi 中保存数据的最佳方法是什么

> ID：340213
> 
> 赞同：4
> 
> 时间：2008-12-04T10:58:45.540
> 
> 标签：database, delphi

我在 Delphi 中开发一个包含大量数据的程序，我想知道哪种方法最适合将其保存到文件中。现在我们使用记录和“文件”来保存它，但我认为它应该是更好的方法。我更喜欢一个可以轻松从我们现在使用的系统迁移的系统。

编辑：该应用程序是一种数据库应用程序。用户使用它来管理数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T11:14:00.457

这取决于数据！常用方法是数据库（大量记录的行）、XML（结构化数据存储）、ini 文件（简单数据）或自定义格式（图形图像等）。Delphi 非常适合数据库，有一系列第三方选项允许完全编译的代码，因此对于一般数据，它们可以很好地工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T16:00:22.080

有很多选择。如果您确定您永远不需要超过一个用户，我会选择保存在 XML 中的 ClientDatasets。Dan Miser 写了几篇关于它们的文章，非常好。如果您不确定将来是否需要一个或多个用户，我会选择嵌入式数据库。Firebird 是一个不错的选择。有关详细信息，请参阅[http://www.firebirdsql.org/manual/fbmetasecur-embedded.html](http://www.firebirdsql.org/manual/fbmetasecur-embedded.html)。使用相同的代码，您将来可以制作多用户版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T11:44:07.417

如果它是一种数据库应用程序，将数据存储在数据库中可能是合乎逻辑的选择。

一种替代方法是使用流媒体：

```
procedure TmyThing.PutData(AFile: String);
var
  writer: TWriter;
  stream: TFileStream;
begin
  stream := TFileStream.Create(AFile, fmCreate);
  try
    writer := TWriter.Create(stream, $ff);
    try
      with writer do
      begin
        WriteSignature;         {marker to indicate a Delphi filer object file.}
        WriteListBegin;         {outer list marker}
        WriteFloat(cVersion);   {write the version for future use}
        WriteString(someProperty);
        {... etc. ...}
        WriteListEnd;           {outer list marker}
      end;
    finally
      writer.Free;
    end;
  finally
    stream.Free;
  end;
end; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T15:00:31.963

对于一个简单的应用程序，为什么不使用本地`TClientDataset`？它将允许搜索、排序和使用数据库控件。如果你`midaslib`在你的uses 子句中包含，你也可以在没有任何外部dll 的情况下部署应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-06T04:19:31.533

```
var

 FileStream: TFileStream;

procedure TForm1.Load(Sender: TObject);

Begin

if FileExists ('Thing2.dat') then

      Begin             
      FileStream := TFileStream.Create('Thing2.dat', fmOpenRead);
      FileStream.ReadComponent( {Thing like Edit1} );
      FileStream.Free;
      End;
end; 
```

并加载

```
procedure TForm1.Save(Sender: TObject);

Begin

 FileStream := TFileStream.Create('Thing2.dat', fmcreate);

 FileStream.WriteComponent(  {Thing like Edit1}   );

 FileStream.Free;

end; 
```

这应该有效，因为它对我有用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T12:12:49.183

还取决于保存后您想用它做什么......此时它只是存储“存档”数据吗？或者你想搜索它，在未来某个时间点检索一些数据然后再次保存它（可能已更改），或者你是否将其全部加载，以某种方式对其进行操作，然后再次将其保存回来？

# php - mysql加入问题

> ID：340217
> 
> 赞同：3
> 
> 时间：2008-12-04T11:01:10.530
> 
> 标签：php, mysql, join

我有两个包含以下列的表：

表格1：

```
id, agent_name, ticket_id, category, date_logged 
```

表2：

```
id, agent_name, department, admin_status 
```

我想要实现的是从 table1 中选择代理部门等于 table2 的所有行。

我尝试了一些不同的连接语句，但要么语法错误，要么无法与此表设置一起使用。我是 MySQL 的初学者，从我读过的内容来看，JOIN 是最复杂的！

我考虑过的另一个选择是将“部门”列复制到 table1 中，但这需要在前端进行更多的编码，我试图看看是否可以在不这样做的情况下达到预期的结果。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T11:16:49.700

我不太明白你的问题......只有table2有一个部门，他们唯一的共同点是agent_name。

我确实怀疑您的真正意思是：您想要 Table1 中代理来自某个部门的所有行，这就是您想要的吗？在这种情况下，应该这样做（虽然还没有测试过）：

```
SELECT * FROM Table1 
      INNER JOIN Table2 
      ON Table1.agent_name = Table2.agent_name 
      WHERE Table2.department = 'somespecific value'; 
```

顺便说一句：（受其他人所说的启发）`agent_name`听起来它是一个字符串值，您真的应该考虑使用 table2 中的 id 作为 table1 中的键（我们`agent_id`也许称之为）将它们链接在一起。外键（表之间的链接）应该是真正的唯一 id。该部门也应该是一个 id 键。那么它将是：

```
SELECT * FROM Table1 
      INNER JOIN Table2 
      ON Table1.agent_id = Table2.id 
      WHERE Table2.department = 'somespecific value'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T11:09:06.707

虽然我不能完全理解，你需要什么以及表格是如何相关的，但我会尝试类似的东西：

```
select 
    a.id, a.agent_name, a.ticket_id, 
    a.category, a.date_logged, b.department
from 
    table1 a inner join table2 b on b.agent_name=a.agent_name 
```

目前我假设您需要在 agent_name 上链接表。

顺便说一句，连接是 SQL 范围内最简单的一端 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T11:13:46.853

您可能希望在两个表之间添加一个唯一的关系键，而不是在两个表中都使用代理名称。像这样的东西：

```
Table1: id, agent_id,  ticket_id, category, date_logged
Table2: agent_id, agent_name, department, admin_status 
```

一个 SQL 示例：

```
SELECT t2.agent_name, t1.date_logged FROM table1 t1
INNER JOIN table2 t2 ON t2.agent_id = t1.agent_id 
```

但是，您可能想使用某种外部联接，因此我建议您查看 Internet 上的一些文章。

# asp.net-mvc - 实体框架和 asp.net mvc

> ID：340218
> 
> 赞同：3
> 
> 时间：2008-12-04T11:01:30.293
> 
> 标签：asp.net-mvc, entity-framework

我搜索了一个很好的教程来学习如何以正确的方式使用实体框架。特别是使用 asp.net mvc。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T11:34:23.830

我会向您指出Entity Framework 团队 的这篇相当[长的 (1) 篇文章的方向。](http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx)

他们很好地解释了初始版本 (v1.0) 的缺点，并为他们正在考虑的下一个版本提供了很多想法。

FWIW，我已经做了一点点 ASP MVC，我不确定你是否会喜欢将两者混合。

对于实体框架的 (v1.0) 版本，您确实需要做两件事之一 - 使用“断开连接”的实体集或零售实体集的数据上下文。这两种情况都有缺陷，我相信你会理解的。简而言之..我认为现阶段没有“正确的方式”。至少不使用 ASP MVC。

要开始使用实体框架，您可以查看位于[此处 (2) 的官方 ADO EF 示例。](http://code.msdn.microsoft.com/adonetefx) 恕我直言，最容易上手和开始学习的是基于 WinForms 的示例，但有一些 ASP.net 示例可能会有所帮助。

(1) [ [http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx]](http://blogs.msdn.com/efdesign/archive/2008/11/20/n-tier-improvements-for-entity-framework.aspx])
(2) [ [http://code.msdn. microsoft.com/adonetefx]](http://code.msdn.microsoft.com/adonetefx])

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-07T21:59:48.000

[这](http://blogs.msdn.com/brada/archive/2008/01/29/asp-net-mvc-example-application-over-northwind-with-the-entity-framework.aspx)给出了如何将 EF 与 MVC 框架一起使用的合理示例。我最近也看过这个，我得出与 Rob 相同的结论，这比它更痛苦！尤其是与使用 Linq2Sql 相比。加载实体时与保存实体时没有相同的上下文（通常是不同的操作），会导致编写大量不必要的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-08T05:08:05.960

我们目前正在使用前端的 ASP.NET MVC 开发 EF 4.0 参考实现。[在这里查看](http://dataguidance.codeplex.com/)-我们很想听听您的反馈。

# c# - 从数据表中删除重复项的最佳方法是什么？

> ID：340223
> 
> 赞同：8
> 
> 时间：2008-12-04T11:05:00.943
> 
> 标签：c#, datatable, duplicates

我检查了整个网站并在网上搜索，但无法找到解决此问题的简单方法。

我有一个数据表，它有大约 20 列和 10K 行。我需要根据 4 个关键列删除此数据表中的重复行。.Net 没有这样做的功能吗？最接近我正在寻找的函数是 datatable.DefaultView.ToTable(true, array of columns to display)，但是这个函数在**所有**列上都不同。

如果有人可以帮助我，那就太好了。

编辑：我很抱歉不清楚这一点。此数据表是通过读取 CSV 文件而不是从数据库中创建的。因此，使用 SQL 查询不是一种选择。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-04T11:19:23.393

您可以使用 Linq 到数据集。检查[这个](http://msdn.microsoft.com/en-us/library/bb669119.aspx)。像这样的东西：

```
// Fill the DataSet.
DataSet ds = new DataSet();
ds.Locale = CultureInfo.InvariantCulture;
FillDataSet(ds);

List<DataRow> rows = new List<DataRow>();

DataTable contact = ds.Tables["Contact"];

// Get 100 rows from the Contact table.
IEnumerable<DataRow> query = (from c in contact.AsEnumerable()
                              select c).Take(100);

DataTable contactsTableWith100Rows = query.CopyToDataTable();

// Add 100 rows to the list.
foreach (DataRow row in contactsTableWith100Rows.Rows)
    rows.Add(row);

// Create duplicate rows by adding the same 100 rows to the list.
foreach (DataRow row in contactsTableWith100Rows.Rows)
    rows.Add(row);

DataTable table =
    System.Data.DataTableExtensions.CopyToDataTable<DataRow>(rows);

// Find the unique contacts in the table.
IEnumerable<DataRow> uniqueContacts =
    table.AsEnumerable().Distinct(DataRowComparer.Default);

Console.WriteLine("Unique contacts:");
foreach (DataRow uniqueContact in uniqueContacts)
{
    Console.WriteLine(uniqueContact.Field<Int32>("ContactID"));
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T11:13:34.997

[如何删除重复的行？](https://stackoverflow.com/questions/18932/sql-how-can-i-remove-duplicate-rows). （调整那里的查询以加入您的 4 个关键列）

编辑：根据您的新信息，我相信最简单的方法是实现 IEqualityComparer<T> 并在您的数据行上使用 Distinct 。否则，如果您使用的是 IEnumerable/IList 而不是 DataTable/DataRow，那么肯定可以使用一些 LINQ-to-objects 功夫。

编辑：示例 IEqualityComparer

```
public class MyRowComparer : IEqualityComparer<DataRow>
{

    public bool Equals(DataRow x, DataRow y)
    {
        return (x.Field<int>("ID") == y.Field<int>("ID")) &&
            string.Compare(x.Field<string>("Name"), y.Field<string>("Name"), true) == 0 &&
          ... // extend this to include all your 4 keys...
    }

    public int GetHashCode(DataRow obj)
    {
        return obj.Field<int>("ID").GetHashCode() ^ obj.Field<string>("Name").GetHashCode() etc.
    }
} 
```

你可以像这样使用它：

```
var uniqueRows = myTable.AsEnumerable().Distinct(MyRowComparer); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T11:17:53.617

如果您可以访问 Linq，我认为您应该能够在内存集合中使用内置的组功能并挑选出重复的行

在 Google 上搜索 Linq Group 以获取示例

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-01T11:41:30.947

应该考虑到必须调用 Table.AcceptChanges() 才能完成删除。否则，已删除的行仍存在于 DataTable 中，且 RowState 设置为已删除。并且 Table.Rows.Count 在删除后不会改变。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-09T10:29:03.503

我认为这一定是使用和 代码从**Datatable中删除重复项的最佳方法：**`Linq``moreLinq`

**林克**

```
RemoveDuplicatesRecords(yourDataTable);

private DataTable RemoveDuplicatesRecords(DataTable dt)
{
    var UniqueRows = dt.AsEnumerable().Distinct(DataRowComparer.Default);
    DataTable dt2 = UniqueRows.CopyToDataTable();
    return dt2;
} 
```

* * *

## 更多Linq

```
// Distinctby  column name ID 
var valueDistinctByIdColumn = yourTable.AsEnumerable().DistinctBy(row => new { Id = row["Id"] });
DataTable dtDistinctByIdColumn = valueDistinctByIdColumn.CopyToDataTable(); 
```

注意：`moreLinq`需要添加库。

在**morelinq**中，您可以使用名为 DistinctBy 的函数，您可以在其中指定要查找 Distinct 对象的属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T11:11:30.647

使用查询而不是函数：

```
DELETE FROM table1 AS tb1 INNER JOIN 
(SELECT id, COUNT(id) AS cntr FROM table1 GROUP BY id) AS tb2
ON tb1.id = tb2.id WHERE tb2.cntr > 1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T11:22:37.460

Liggett78 的回答要好得多——尤其是。因为我的有一个错误！更正如下...

```
DELETE TableWithDuplicates
    FROM TableWithDuplicates
        LEFT OUTER JOIN (
            SELECT PK_ID = Min(PK_ID), --Decide your method for deciding which rows to keep
                KeyColumn1,
                KeyColumn2,
                KeyColumn3,
                KeyColumn4
                FROM TableWithDuplicates
                GROUP BY KeyColumn1,
                    KeyColumn2,
                    KeyColumn3,
                    KeyColumn4
            ) AS RowsToKeep
            ON TableWithDuplicates.PK_ID = RowsToKeep.PK_ID
    WHERE RowsToKeep.PK_ID IS NULL 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T11:23:35.680

[在bytes.com](http://bytes.com/groups/net-c/278990-whats-best-way-read-csv-file-c#post1115863)上找到了这个：

> 您可以将 JET 4.0 OLE DB 提供程序与 System.Data.OleDb 命名空间中的类一起使用来访问逗号分隔的文本文件（使用 DataSet/DataTable）。
> 
> 或者，您可以将 Microsoft Text Driver for ODBC 与 System.Data.Odbc 命名空间中的类一起使用，以使用 ODBC 驱动程序访问文件。

正如其他人所建议的那样，这将允许您通过 sql 查询访问您的数据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-04T11:26:11.507

“这个数据表是通过读取 CSV 文件而不是从数据库中创建的。”

因此，对数据库中的四列设置唯一约束，并且在您的设计下重复的插入不会进入。除非它决定失败而不是在发生这种情况时继续，但这肯定可以在您的 CSV 导入脚本中配置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-27T09:31:09.693

这是一个非常简单的代码，不需要 linq 也不需要单独的列来进行过滤。如果一行中的所有列的值都是空的，它将被删除。

* * *

```
 public DataSet duplicateRemoval(DataSet dSet) 
{
    bool flag;
    int ccount = dSet.Tables[0].Columns.Count;
    string[] colst = new string[ccount];
    int p = 0;

    DataSet dsTemp = new DataSet();
    DataTable Tables = new DataTable();
    dsTemp.Tables.Add(Tables);

    for (int i = 0; i < ccount; i++)
    {
        dsTemp.Tables[0].Columns.Add(dSet.Tables[0].Columns[i].ColumnName, System.Type.GetType("System.String"));
    }

    foreach (System.Data.DataRow row in dSet.Tables[0].Rows)
    {
        flag = false;
        p = 0;
        foreach (System.Data.DataColumn col in dSet.Tables[0].Columns)
        {
            colst[p++] = row[col].ToString();
            if (!string.IsNullOrEmpty(row[col].ToString()))
            {  //Display only if any of the data is present in column
                flag = true;
            }
        }
        if (flag == true)
        {
            DataRow myRow = dsTemp.Tables[0].NewRow();
            //Response.Write("<tr style=\"background:#d2d2d2;\">");
            for (int kk = 0; kk < ccount; kk++)
            {
                myRow[kk] = colst[kk];         

                // Response.Write("<td class=\"table-line\" bgcolor=\"#D2D2D2\">" + colst[kk] + "</td>");
            }
            dsTemp.Tables[0].Rows.Add(myRow);
        }
    } return dsTemp;
} 
```

* * *

这甚至可以用于从 Excel 工作表中删除空数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-12-16T07:47:52.090

试试这个

让我们考虑 dtInput 是您的具有重复记录的数据表。

我有一个新的 DataTable dtFinal，我想在其中过滤重复的行。

所以我的代码将如下所示。

```
DataTable dtFinal = dtInput.DefaultView.ToTable(true, 
                           new string[ColumnCount] {"Col1Name","Col2Name","Col3Name",...,"ColnName"}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-03T22:54:03.273

我不热衷于使用上面的 Linq 解决方案，所以我写了这个：

```
/// <summary>
/// Takes a datatable and a column index, and returns a datatable without duplicates
/// </summary>
/// <param name="dt">The datatable containing duplicate records</param>
/// <param name="ComparisonFieldIndex">The column index containing duplicates</param>
/// <returns>A datatable object without duplicated records</returns>
public DataTable duplicateRemoval(DataTable dt, int ComparisonFieldIndex)
{
    try
    {
        //Build the new datatable that will be returned
        DataTable dtReturn = new DataTable();
        for (int i = 0; i < dt.Columns.Count; i++)
        {
            dtReturn.Columns.Add(dt.Columns[i].ColumnName, System.Type.GetType("System.String"));
        }

        //Loop through each record in the datatable we have been passed
        foreach (DataRow dr in dt.Rows)
        {
            bool Found = false;
            //Loop through each record already present in the datatable being returned
            foreach (DataRow dr2 in dtReturn.Rows)
            {
                bool Identical = true;
                //Compare the column specified to see if it matches an existing record
                if (!(dr2[ComparisonFieldIndex].ToString() == dr[ComparisonFieldIndex].ToString()))
                {
                    Identical = false;
                }
                //If the record found identically matches one we already have, don't add it again
                if (Identical)
                {
                    Found = true;
                    break;
                }
            }
            //If we didn't find a matching record, we'll add this one
            if (!Found)
            {
                DataRow drAdd = dtReturn.NewRow();
                for (int i = 0; i < dtReturn.Columns.Count; i++)
                {
                    drAdd[i] = dr[i];
                }

                dtReturn.Rows.Add(drAdd);
            }
        }
        return dtReturn;
    }
    catch (Exception)
    {
        //Return the original datatable if something failed above
        return dt;
    }
} 
```

此外，这适用于所有列而不是特定列索引：

```
/// <summary>
/// Takes a datatable and returns a datatable without duplicates
/// </summary>
/// <param name="dt">The datatable containing duplicate records</param>
/// <returns>A datatable object without duplicated records</returns>
public DataTable duplicateRemoval(DataTable dt)
{
    try
    {
        //Build the new datatable that will be returned
        DataTable dtReturn = new DataTable();
        for (int i = 0; i < dt.Columns.Count; i++)
        {
            dtReturn.Columns.Add(dt.Columns[i].ColumnName, System.Type.GetType("System.String"));
        }

        //Loop through each record in the datatable we have been passed
        foreach (DataRow dr in dt.Rows)
        {
            bool Found = false;
            //Loop through each record already present in the datatable being returned
            foreach (DataRow dr2 in dtReturn.Rows)
            {
                bool Identical = true;
                //Compare all columns to see if they match the existing record
                for (int i = 0; i < dt.Columns.Count; i++)
                {
                    if (!(dr2[i].ToString() == dr[i].ToString()))
                    {
                        Identical = false;
                    }
                }
                //If the record found identically matches one we already have, don't add it again
                if (Identical)
                {
                    Found = true;
                    break;
                }
            }
            //If we didn't find a matching record, we'll add this one
            if (!Found)
            {
                DataRow drAdd = dtReturn.NewRow();
                for (int i = 0; i < dtReturn.Columns.Count; i++)
                {
                    drAdd[i] = dr[i];
                }

                dtReturn.Rows.Add(drAdd);
            }
        }
        return dtReturn;
    }
    catch (Exception)
    {
        //Return the original datatable if something failed above
        return dt;
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-20T18:09:42.947

为了完成，我附上了一个基于此处已有的一些答案的示例。当其余列可能不同时，此解决方案按 fieldKey1 将表过滤为 N。但也过滤重复中匹配的第一个，其他两列的最小值：

```
return dt.AsEnumerable()
    .Distinct(DataRowComparer.Default)
    .GroupBy(r => new
    {
        fieldKey1 = r.Field<int>("fieldKey1"), 
        fieldKey2 = r.Field<string>("fieldKey2"), 
        fieldKeyn = r.Field<DateTime>("fieldKeyn")
    })
    .Select(g =>  
        g.OrderBy( dr => dr.Field<int>( "OtherField1" ) )
            .ThenBy( dr => dr.Field<int>( "OtherField2" ) )
                .First())
    .CopyToDataTable(); 
```

所以数据表dt：

| 字段键1 | 字段键2 | 字段键 | 其他字段1 | 其他字段2 | 其他领域3 |
| --- | --- | --- | --- | --- | --- |
| 1 | 二 | 31-12-2020 | 4 | 3 | xyz7 |
| 2 | 其他 | 31-12-2021 | 4 | 3 | xyz100 |
| 1 | 二 | 31-12-2020 | 2 | 2 | xyz3 |
| 1 | 二 | 31-12-2020 | 2 | 3 | xyz4 |
| 1 | 二 | 31-12-2020 | 1 | 2 | xyz1 |
| 1 | 二 | 31-12-2020 | 1 | 4 | xyz2 |
| 1 | 二 | 31-12-2020 | 3 | 3 | xyz5 |
| 1 | 二 | 31-12-2020 | 3 | 3 | xyz6 |

将返回：

| 字段键1 | 字段键2 | 字段键 | 其他字段1 | 其他字段2 | 其他领域3 |
| --- | --- | --- | --- | --- | --- |
| 1 | 二 | 31-12-2020 | 1 | 2 | xyz1 |
| 2 | 其他 | 31-12-2021 | 4 | 3 | xyz100 |

# php - 如何向 joomla 联系页面添加其他文本

> ID：340225
> 
> 赞同：0
> 
> 时间：2008-12-04T11:06:12.967
> 
> 标签：php, joomla

这是我第一次使用 joomla。我不知道我是否以错误的方式使用了联系人的概念，但我创建了一个“联系我们”菜单，并在其中添加了联系人详细信息。我希望添加一个句子联系方式和电子邮件联系表上方的或两个文本。似乎没有办法通过管理页面执行此操作。我在做正确的事吗？如果我想要这个，我需要做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T11:13:23.373

不完全在联系信息上方，而是在电子邮件表格上方，您可以使用“杂项信息”字段放置任何额外的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T12:17:27.443

如果您真的希望它高于联系方式，则必须使用布局覆盖。无法通过管理后端执行此操作。在 Joomla 1.0 中，只有通过 hack 才有可能，现在在 Joomla 1.5 中，可以覆盖布局。

[本文](http://docs.joomla.org/How_to_override_the_output_from_the_Joomla!_core)展示了它是如何完成的。

如果您想实时查看它，请安装 beez 模板，它覆盖了 Joomla 的几乎所有核心​​组件。所以你可以检查 beez 是如何做的，然后用你自己的模板做类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T11:02:00.000

您可以尝试制作自己的自定义联系表格。您必须制作自定义 HTML 联系表格并使用 PHP 的 sendmail() 函数。您会在网上找到许多基于 PHP 的联系表格。使用“Jumi”插件将发送按钮与 php 代码链接。一切都像它应该的那样完美。我用它来制作我的联系表格之一。

# jquery - 动画不透明度，插入html，动画不透明度

> ID：340232
> 
> 赞同：2
> 
> 时间：2008-12-04T11:09:50.247
> 
> 标签：jquery, animation, opacity

使用我的 jquery，我试图通过将消息的不透明度设置为动画，插入 loading.gif 并将不透明度重新设置为动画，使从消息到加载功能的转换变得容易。它失败了。

```
$('#powerSearchSubmitButton').click(function(ev) {
    startLoad();
    return false;
});
function startLoad() {
    $('.message').each(function(i) {
        $(this).animate({opacity: 0}, 500, function() {
            $(this).html("<img src=\"/content/pics/loadingBig.gif\" alt=\"loading\" style=\"opacity:0\"/>");
            $(this).animate({opacity: 1},500);
        });
    };
    return true;
}; 
```

当我离开`.html()`电话时，它工作正常（当然图像不存在除外；所以我认为这是因为没有插入 html`opacity:0;`但是当我插入它时`style="opacity:0"`它不能淡入...

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T17:03:05.820

尝试这个：

```
$(this).fadeOut(500, function() {
     $(this).html("<img src='content/pics/loadingBig.gif' alt='loading'/>");
    });
$(this).fadeIn(500); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T11:46:17.723

改为将动画应用到容器，或使用 .css() 方法设置不透明度（内联样式可能会干扰 jQuery 为相应属性设置动画的能力）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T11:49:46.703

不要给图片 style="opacity:0;" - 它的父级隐藏时不可见，并且，正如您所发现的，一旦父级淡入，它将保持 0 不透明度。

您还可以使用 jQuery 的[fadeIn](http://docs.jquery.com/Effects/fadeIn)和[FadeOut](http://docs.jquery.com/Effects/fadeOut)函数来代替手动制作动画。

# asp.net - 尽管设置了滑动过期时间，但存储在 ASP.NET 缓存中的对象永不过期的一些可能原因是什么？

> ID：340237
> 
> 赞同：1
> 
> 时间：2008-12-04T11:13:02.347
> 
> 标签：asp.net, caching

我使用 ASP.NET 缓存缓存了一个值，代码如下：

```
Cache.Insert("TEST_VALUE", 150, null, Cache.NoAbsoluteExpiration, TimeSpan.FromSeconds(120)); 
```

据我了解，这应该意味着如果在 120 秒内没有任何东西访问该对象，它将过期并返回 null。

但是，如果我在 10 分钟后运行一个从缓存中写出该值的页面，它仍然存在（实际上在一小时后仍然存在）。我知道没有其他东西可以访问它，因为这一切都在我机器上的本地服务器上。

谁能告诉我为什么这些值没有从缓存中清除？

* * *

谢谢，我明白你的意思，但我的 HttpModule 在将任何内容插入缓存之前检查请求的类型，因此它只会在表单上传时发生。

无论如何，我已经尝试了您的建议，当我刷新显示缓存值的页面时，断点永远不会被击中。

我假设即使从缓存中读取也应该延长对象的寿命，所以我在刷新“调试”页面之前将其保留 5-10 分钟，但值仍然存在！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T12:58:03.490

只是一个调试提示：将缓存对象的值设置为 DateTime.Now 当您插入它以查看它何时插入。这样，您可以轻松确定它是否以某种方式重新插入，或者某个地方是否不断访问，从而迫使它留在缓存中。

结合我关于订阅缓存到期事件和写入日志文件的建议，应该可以为您提供足够的信息来定位问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-03T17:05:25.613

这是您的正确假设。你在哪里做缓存？

我问的原因是，如果您在 Global.asax 中执行此操作，例如在 Application_Start 中，并且应用程序在页面视图之间被回收，它会表现出相同的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T12:36:12.507

在所有缓存读取实例上设置断点以查看它们是否被意外命中（从而延长对象的寿命）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T11:34:14.330

在这里复制您的原始问题：

[尽管设置了滑动到期时间，但我的 ASP.NET 缓存永不过期的原因是什么？](https://stackoverflow.com/questions/337897/whats-the-reason-for-my-aspnet-cache-never-expiring-despite-having-a-sliding-ex)

建议您提供有关缓存上下文的更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T12:05:36.903

您绝对确定您不只是在每次点击页面时将项目插入缓存吗？

我问的原因是因为您提到它是在 HttpModule 中完成的，并且它们通常在每个页面命中时执行。

据我所知，这是唯一可以解释这种行为的事情。

我建议您在 Cache.Insert 发生的行上设置一个断点，看看它是否在您点击页面时执行。您还可以订阅缓存的删除回调并在文件过期时写入文件。如果你这样做，你可以执行一次页面；以便插入该项目，然后坐下来观看文件以查看它是否被删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T17:01:37.603

好的，我想我已经弄清楚了，但我不确定这是为什么：

我按照你们俩的建议做了——肯定没有从缓存中读取任何内容，所以我编写了一个回调，将删除时间写入日志文件并将其订阅到过期事件。我还将每个项目添加到缓存中的时间写到同一个日志中，这样我就可以看到内容在那里停留了多长时间。

在我最初在代码中将值分配给缓存之后，然后有一个循环，我在每次迭代中为同一个对象分配一个新值，使用：

```
Cache["TEST_VALUE"] = counter; 
```

然而，使用这种语法，一旦发生这种情况，日志文件就会显示该项目已从缓存中删除，即使它仍然可以被刚刚写出缓存对象值的单独页面访问？

我不明白为什么会这样 - 我知道上面的语法只会更新缓存中对象的值，但也许我错了？

乱七八糟，我更改了代码，以便循环中的上述行现在变为：

```
Cache.Insert("TEST_VALUE", newvalue, null, Cache.NoAbsoluteExpiration, TimeSpan.FromSeconds(120)); 
```

现在在日志中我收到相同的删除通知，然后立即收到另一个添加通知，并且该项目在 120（ish）秒后正确过期，并且不再可以从其他页面访问。

我很困惑，但感谢您的帮助:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T09:11:02.153

核实

```
<cache disableExpiration="true"/> 
```

没有在您的 web.config 中设置？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-14T07:25:12.973

只要您的计算机处于打开状态并且内存块没有被其他数据替换。缓存永远不会过期。即使您关闭浏览器并重新打开它，您也可以检索它。

例如

*   `cache("Key") = 10`
*   关闭浏览器
*   打开浏览器
*   `textbox.text = cache("Key")`.

# c# - What is the best method for formatting email when using System.Net.Mail

> ID：340250
> 
> 赞同：3
> 
> 时间：2008-12-04T11:18:09.853
> 
> 标签：c#, asp.net, css, system.net.mail

Hi I'm using `System.Net.Mail` to send some HTML formatted emails.

What is the correct method for inserting css into the email message?

I know I can apply formatting to each item, but I'ld rather use style sheets..

**EDIT** I should have mentioned that this is for an internal application, and I expect 99% of users to be using Outlook or other client, but never hotmail or gmail etc.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T11:23:07.007

I've always found that strictly using **HTML 3.0 compatible tags and formatting** works best for all email readers and providers.

nevertheless here is a [**CSS in Email** article](http://www.alistapart.com/articles/cssemail) that may answer your question, you will find solutions to your css problems.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-04T11:25:22.243

The email clients don't use CSS in a uniform way so it's difficult to use CSS. This article can help - [http://www.alistapart.com/articles/cssemail/](http://www.alistapart.com/articles/cssemail/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T12:06:43.843

[This reference](http://www.campaignmonitor.com/css/) is the best one I've found to see what works in what when it comes to CSS in emails.

To be honest though, CSS support is so, so flaky that you're better off doing as the previous poster says and sticking to basic HTML (and yes, that means using outdated font tags etc). Especially as you mention Outlook and that (at least the latest version) is the worst culprit when it comes to terrible CSS support.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T12:00:21.593

You could keep styles in a normal CSS file, load them with [File.ReadAllText](http://msdn.microsoft.com/en-us/library/system.io.file.readalltext.aspx) and insert them to a HTML letter template

```
string letter = File.ReadAllText(Request.PhysicalApplicationPath + "letter.html");
string style = File.ReadAllText(Request.PhysicalApplicationPath + "style.css");

MailMessage message = new MailMessage();
message.Body = letter.Replace("{STYLE}", style); 
```

The letter template should contain {STYLE} in appropriate place

```
<head>
    <title></title>
    <style type="text/css">
        {STYLE}
    </style>
</head>
<body> 
```

# wpf - 在 wpf 控件中嵌入谷歌地图

> ID：340257
> 
> 赞同：3
> 
> 时间：2008-12-04T11:22:12.390
> 
> 标签：wpf, google-maps

我正在尝试创建一个 wpf 控件，该控件将使用谷歌地图显示地图图像。我希望能够将地图以应用程序指定的经度和纬度为中心。理想情况下，控件将允许用户移动地图标记并将标记的纬度/经度存储在应用程序中。

我能想到的唯一方法是使用 WebBrowser 控件并在运行时创建一个 HTML 字符串，以显示所需位置的地图。这似乎是一个尴尬的解决方案，并且不允许我轻松检索标记位置。有谁知道更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-27T11:05:27.563

使用 XAML 在 Microsoft WPF 应用程序中托管 Google 地图 [http://code.google.com/apis/maps/articles/flashmapinwpf.html](http://code.google.com/apis/maps/articles/flashmapinwpf.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T20:39:48.270

我对此不是 100% 确定，但我认为这样做会违反 Google Map 的服务条款。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T20:47:39.190

Windows 窗体和 Microsoft Virtual Earth 之间有很好的集成（[此处为示例](http://mtaulty.com/communityserver/blogs/mike_taultys_blog/archive/2005/08/01/5547.aspx)。）商业产品存在许可注意事项，但这肯定更多或“交钥匙”选项。您还需要查看 Windows Forms Host 以将 Forms 控件放入 WPF 应用程序中。

# connection - 是否需要维护长期 JMS 连接？

> ID：340266
> 
> 赞同：2
> 
> 时间：2008-12-04T11:24:35.240
> 
> 标签：connection, integration, jms

我保持 JMS 连接始终打开，因为上面有一个 MessageListener。

是否普遍需要担心使用长期 JMS 连接来最小化应用程序的维护？

我正在考虑尝试从一些可能常见的众所周知的故障中恢复，例如临时连接故障。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T13:05:57.187

一个好的 JMS 提供者将处理网络中断，例如丢失的套接字或消息代理故障转移或重新启动。例如，这是在[Apache ActiveMQ中](http://activemq.apache.org/)[启用自动重新连接](http://activemq.apache.org/how-do-i-configure-automatic-reconnection.html)的方法。

重新创建所有 JMS 资源（连接、会话、生产者、消费者）通常很痛苦——JMS 提供者为你做这件事要容易得多。

如果您必须使用不支持此功能的提供程序 - 请考虑切换或使用 Spring JMS 帮助程序类，它可以为您完成其中的一些工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T12:44:17.233

您将需要处理两种情况：

1.  您和 JMS 服务器之间的防火墙。大多数防火墙会在几个小时后切断“空闲”连接。如果是这种情况，请每隔一小时左右发送一条消息，或者，如果可以，启用 TCP_KEEPALIVE。这是一个 TCP/IP 选项，它将导致底层套接字在一段时间后发送测试消息。
2.  另一台服务器重新启动。发生这种情况时，当您尝试发送下一条消息时，您将收到“连接丢失”错误。在这种情况下，只需再次打开连接并重试。

我建议安装本地 JMS 服务器（任何都可以），将您的应用程序连接到它并停止服务器。这将为您提供案例 #2 的错误消息。[然后用MockRunner](http://mockrunner.sourceforge.net/)编写一个单元测试来确保你的错误处理是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T16:48:55.443

我所知道的标准 JMS 规范中没有任何内容可以确保应用程序不会看到连接问题。也许有一些供应商将其作为扩展（正如 James Strachan 所建议的那样）。

如果您想要一个不依赖于供应商扩展的健壮 JMS 客户端，您需要处理错误并进行重新连接。请参阅[将 JMS 侦听器重新连接到 JBossMQ](https://stackoverflow.com/questions/47683/reconnecting-jms-listener-to-jbossmq#117503)（尽管标题如此，但它不是 JBossMQ 特定的）。

# .net - 对于这个简单的数学结果，我应该使用十进制、浮点还是双精度？

> ID：340270
> 
> 赞同：5
> 
> 时间：2008-12-04T11:27:21.177
> 
> 标签：.net, floating-point, double, decimal

我正在做一些非常简单的数学运算并将结果保存到 MS SQL2008 DB。

我正在*平均*一些数字，它们是 1<->5 之间的字节值。我希望只记录小数点后 2 位。我不关心小数点后第二位的四舍五入（例如 1.155 == 1.5 或 1.6 .. 我不太分阶段）。

所以..我应该将平均结果存储为浮点数、小数还是双精度？

当我检查 LINQ 返回的内容时，它可以返回所有三个值！

最后，还有什么是相关的 SQL 数据类型字段。

干杯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T15:59:01.737

您需要的是 DECIMAL 数据类型：

```
declare @val decimal(10,2)
select @val = 10.155
select @val 
```

输入值时，您可以依赖内置的舍入，也可以明确决定您想要的舍入：

```
select val = round(10.155, 2, 0) -- rounded
select val = round(10.155, 2, 1) -- truncated 
```

小数（10,2）表示可以使用十位数字，其中两位视为小数点后。即十进制（4,2）可以包含的最大数字是99.99。尝试将其设置为 100 将导致算术溢出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T11:41:54.877

我会选择浮点数而不是双精度数，可能是浮点数而不是十进制数：。Id 去 Floatalthough 都应该给出相同的结果。

看看这两个页面的[浮点数](http://www.yoda.arachsys.com/csharp/floatingpoint.html) 和[小数](http://www.yoda.arachsys.com/csharp/decimal.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T16:02:56.893

小数主要用于货币。虽然它会起作用，但人们可能会感到困惑。在这种情况下，我认为浮动会是一个更好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T11:32:44.367

十进制 - 这是最简单的，但是任何提到的都可以完成这项工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T11:43:32.907

如果您想使用尽可能少的空间存储结果，您可以执行以下操作（伪代码）：

```
integer = ( sum(all_values) / all_values.count().float ) * 100; 
```

这将为您提供平均 3.52 的值 352，因此您可以将其存储为整数（我猜字节会足够大），当您想要显示它时只需将其除以 100。

另一方面，如果您不关心平均值的存储，则使用浮点值可能会更快。（测试两者以查看您的系统上实际最快的是什么。）

# php - 如何从 PHP 为 Bugzilla 设置 HTTP 环境变量？

> ID：340271
> 
> 赞同：0
> 
> 时间：2008-12-04T11:27:42.847
> 
> 标签：php, perl, apache, joomla, bugzilla

bugzilla（基于 perl）系统具有使用 http 服务器环境变量自动登录的功能。如果您填写正确的 ID 或用户名，您将自动登录。

我的服务器运行 Joomla（基于 PHP）并且拥有所有关于谁登录的信息。它在一个子框架内运行 bugzilla。

那么，如何从 PHP 脚本中设置这个环境值呢？

换句话说，以下脚本如何在 PHP 的会话中的其他地方返回我自己设置的变量：

```
#!/usr/bin/perl -wT
print "Content-type: text/html\n\n";
while (($key, $val) = each %ENV) {
        print "$key = $val&lt;BR&gt;\n";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T13:48:42.983

这只是一个猜测，但是（假设您使用的是 Apache2）您可以使用[`apache_setenv()`](http://php.net/manual/en/function.apache-setenv.php). 但是，这只会持续到当前 http 请求的整个生命周期，所以我不确定你是如何让它工作的——从你的浏览器框架中对 bugzilla 页面的请求将被 Apache 认为是完全独立的。您可能可以使用[`virtual()`](http://php.net/function.virtual)调用 Bugzilla 的子请求，然后应该能够看到该环境变量。我不确定您是否需要对每个 Bugzilla 页面请求执行此操作，或者只对启动登录的请求执行此操作。

对不起，如果我错过了重点或弄错了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T14:34:07.150

我不确定您需要做什么才能在 Bugzilla 中创建会话，但我知道在 Joomla! 结束时需要做什么：您需要创建一个响应 onLoginUser 事件的用户插件。有关此操作的示例，请查看 plugins/user/joomla.php 中的 onLoginUser 函数。

（注意，这仅适用于 Joomla！1.5）

# security - ClickOnce 安装

> ID：340272
> 
> 赞同：7
> 
> 时间：2008-12-04T11:30:22.123
> 
> 标签：security, clickonce, signing

我有点卡在这里，我有一个 .net 3.5 sp1 应用程序，我想使用 ClickOnce 在本地部署到我网络上的其他机器。

在安装时，他们会收到一条警告消息，指出此应用程序来自未知发布者等。

我的老板不想买威瑞信证书。他只是想安装它而不提示即绕过安全消息。

这可能吗？？？

Microsoft 网站上的一些注释表明该区域已进行了更改，即

“ClickOnce 应用程序发布者现在可以决定不签署和散列 ClickOnce 清单，因为他们认为适合他们的场景。”

谢谢

蒂姆

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T14:31:16.890

由于您在自己的网络上，因此您可以创建自己的受信任证书发布者。为此，请在您的一台服务器上安装证书颁发机构服务并创建代码签名证书。默认情况下，您用户的计算机不会信任该证书，因此请在每台计算机上运行以下命令：

certmgr.exe -add -c MYRootCertificate.cer -s -r localMachine root

certmgr.exe -add -c MyCodeSigningCert.cer -s -r localMachine TrustedPublisher

第一个是让您的计算机信任您的内部 CA 服务器（摆脱“不受信任的发布者”消息），第二个是让它信任由您的证书签名的应用程序。

之后，您的任何已签名应用程序都将在没有安全警告的情况下运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T19:14:28.640

Mitchell 的回答很好，但是除非您有企业版服务器，否则您无法自定义模板并且代码签名模板被标记为“不可导出”。这意味着您不能在 Visual Studio 中使用证书，并且必须有一个后处理来签署您的清单。

现在这是一个功能，而不是错误，不要搞错。典型的软件商店不希望开发人员在 Visual Studio 中签署清单以供公众使用。也就是说，我个人在一家我**确实**想要那种功能的商店里。幸运的是，我设法弄清楚如何导出具有代码签名权限[的 pfx 密钥文件。](http://theruntime.com/blogs/jacob/archive/2006/12/04/creating-a-domain-publisher-cert-for-a-small-internal-software-shop.aspx)如果你发现你需要它，它会很有用。

# c# - 无法删除由 SharpZipLib (FastZip) 创建的 Zip 文件

> ID：340274
> 
> 赞同：2
> 
> 时间：2008-12-04T11:31:06.210
> 
> 标签：c#, file, sharpziplib

我正在使用 SharpZipLib 中的 FastZip 类创建一个 zip 文件，一旦我关闭程序后，我就无法删除该文件，因为：

“无法删除 zip.zip：它正被其他人或程序使用。关闭所有可能正在使用该文件的程序，然后重试。”

生成文件的代码就是这样的：

```
fZip.CreateEmptyDirectories = true;
fZip.CreateZip(filesPath + "\\" + this.zipName, filesPath, false, this.zipFilter); 
```

我尝试使用：

```
 using (FastZip fZip = new FastZip())
            {
                try
                {
                    fZip.CreateEmptyDirectories = true;
                    fZip.CreateZip(filesPath + "\\" + this.zipName, filesPath, false, this.zipFilter);
                }
                catch (Exception)
                {
                }
            } 
```

但它不会转换为 iDisposable

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T23:43:43.297

看起来它可能是 SharpZipLib 的一个错误。FastZip.CreateZip 方法具有三个重载，其中两个创建使用 File.Create，例如：

```
CreateZip(File.Create(zipFileName), // ... 
```

它似乎没有关闭流，所以你最好使用：

```
string zipFileName = System.IO.Path.Combine(filesPath, this.zipName);
using (Stream stream = File.Create(zipFileName))
{
    fZip.CreateZip(stream, filesPath, false, this.zipFilter, null);
    stream.Close();
} 
```

从技术上讲，您不需要在 using 块中调用 Close，但我喜欢明确说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-15T15:34:20.443

我实际上只是自己解决了这个问题。原来它不是 SharpZipLib/FastZip。我正在通过 System.Net.Mail 发送一封电子邮件，并将 FastZipped 文件作为附件附加到该电子邮件。当我试图删除附件时，我遇到了您收到的错误。事实证明，我所要做的就是在发送电子邮件后调用 MailMessage.Dispose() 。

查看代码中可能锁定文件的任何其他项目；如果可能，尝试 dispose() 或 close() 这些项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T11:37:02.827

也许防病毒软件正忙于检查文件？如果没有，请获取一个可以告诉您哪些程序打开了文件的程序。

你可以看看：

*   [解锁器](http://www.emptyloop.com/unlocker/)
*   [IARSN 任务信息](http://www.iarsn.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T12:08:41.483

我不熟悉 FastZip API（所以这只是一个平局），但你需要用 fZip.Close(); 之类的东西关闭存档吗？

我原以为关闭程序会做同样的事情，但只是猜测。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T12:19:21.073

确保在完成后关闭 SharpZipLib*流*，您可以通过将其构造包装在“使用”语句中来做到这一点......

```
using(Stream s = new SharpZipLibStream())
{
   /*...do stuff, zip stuff.../
} 
```

# javascript - 如何使用 jquery 向父窗口中的选择框添加选项？

> ID：340275
> 
> 赞同：0
> 
> 时间：2008-12-04T11:32:35.660
> 
> 标签：javascript, jquery

在我的孩子窗口中，我有

```
$('#opfile').addOption("someval",sometext"); 
```

问题是#opfile 是一个父窗口，我无法让它进行通信

我试过

window.opener.$('#opfile').addOption("someval",sometext");

但没有运气任何想法？

更新

尴尬，但我让上面的工作可能一直在缓存一些东西

感谢您的建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T11:48:23.850

这可能会有所帮助。

[浏览器窗口之间的通信](http://www.sfpeter.com/2008/03/13/communication-between-browser-windows-with-jquery-my-new-plugin/)

虽然这与选择框示例没有直接关系，但这些概念可以在这里应用。

如果有人有更好的解决方案，我会关注这个空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T15:32:04.473

通过更改选项中的数组来试试这个

window.opener.document.getElementById("opfile").options[0] = new Option("someval",sometext");

# java - 混合java版本JTable

> ID：340277
> 
> 赞同：0
> 
> 时间：2008-12-04T11:33:27.250
> 
> 标签：java, jtable

我想使用 Java 6 中新增的 JTable 行排序器。但我还需要它在 Mac OSX 中与 Java 5 兼容。

是否可以在运行时找出 JVM 版本，并为带有和不带有行排序器的 JTable 使用不同的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T12:35:48.543

您总是可以使用[SwingX](https://swingx.dev.java.net/)库中的 JXTable。[它具有内置的排序功能](http://www.javalobby.org/java/forums/t18819.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T12:17:35.430

1.  您可以在系统属性“java.version”中找到 JVM 版本。

2.  将 JTable 排序器对象的源复制到您的项目中并使用它。请注意，除非您拥有 Sun 的许可证，否则您不得分发此文件。因此，这对于您只在自己或公司内部使用的东西是可以的。出售或将其放在网上供下载是不行的。[伊纳尔](http://en.wikipedia.org/wiki/IANAL)。

3.  编写一个实现排序器接口的辅助类。在这个类中，放置以下代码：

    类 sorterClass = Class.forName("javax.swing.table.TableRowSorter");

当这引发 ClassNotFoundException 时，则该类不可用。如果是，请使用 Reflection on`sorterClass`创建一个实例并将其安装在桌子上。

注意：您不得在任何地方导入任何 Java 6 类！如果这样做，加载帮助程序类将失败。此外，您必须使用 Java 5 编译代码。

# c++ - i = ++i + ++i; 在 C++ 中

> ID：340282
> 
> 赞同：18
> 
> 时间：2008-12-04T11:35:55.903
> 
> 标签：c++, puzzle, operator-precedence

有人可以向我解释为什么这段代码会打印 14 吗？我只是被另一个学生问了，我想不通。

```
int i = 5;
i = ++i + ++i;
cout<<i; 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-04T11:44:17.587

C++ 中未定义副作用的顺序。此外，在单个表达式中修改变量两次没有定义的行为（参见[C++ 标准](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1905.pdf)，§5.0.4，物理页 87/逻辑页 73）。

解决方法：在复杂的表达式中不要使用副作用，在简单的表达式中不要使用多个。启用编译器可以给你的所有警告也没有什么坏处：在命令行中添加`-Wall`(gcc) 或`/Wall /W4`(Visual C++) 会产生合适的警告：

```
test-so-side-effects.c: In function 'main':
test-so-side-effects.c:5: warning: operation on 'i' may be undefined
test-so-side-effects.c:5: warning: operation on 'i' may be undefined 
```

显然，代码编译为：

```
i = i + 1;
i = i + 1;
i = i + i; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-04T11:47:18.203

这是未定义的行为，结果会因您使用的编译器而异。例如，参见[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/misc-technical-issues.html#faq-39.15)。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-04T16:40:09.907

在一些答案/评论中，讨论了“未定义行为”的含义以及这是否会使程序无效。所以我发布了这个相当长的答案，详细说明了标准所说的一些注释。我希望它不会太无聊...

该标准的引用位来自当前的 C++ 标准 (ISO/IEC 14882:2003)。C标准中有类似的措辞。

根据 C++ 标准，在一组序列点内多次修改一个值会导致未定义的行为（第 5 节第 4 段）：

> 除非另有说明，单个运算符的操作数和单个表达式的子表达式的求值顺序以及副作用发生的顺序是未指定的。53) 在前一个和下一个序列点之间，一个标量对象应修改其存储值最多一次通过表达式的评估。此外，只能访问先验值以确定要存储的值。对于完整表达式的子表达式的每个允许排序，都应满足本段的要求；否则行为未定义。[例子：
> 
> ```
> i = v[i++]; // the behavior is unspecified
> i = 7, i++, i++; // i becomes 9
> i = ++i + 1; // the behavior is unspecified
> i = i + 1; // the value of i is incremented 
> ```
> 
> ——结束示例]

请注意，第二个示例“ `i = 7, i++, i++;`”是定义的，因为逗号运算符是一个序列点。

以下是 C++ 标准所说的“未定义行为”的含义：

> 1.3.12 未定义的行为 [defns.undefined]
> 
> 行为，例如在使用错误程序结构或错误数据时可能出现的行为，本国际标准对此没有要求。当本国际标准省略对任何明确的行为定义的描述时，也可能会出现未定义的行为。[注意：允许的未定义行为范围从完全忽略具有不可预测结果的情况，到在翻译或程序执行期间以环境特征的记录方式表现（有或没有发出诊断消息），到终止翻译或执行（发出诊断消息）。许多错误的程序结构不会产生未定义的行为；他们需要被诊断出来。]

换句话说，编译器可以为所欲为，包括

1.  吐出错误信息，
2.  做一些定义和记录的实现，
3.  具有完全不可预测的结果

第二项涵盖了大多数编译器具有的语言扩展，但标准中当然没有定义。

所以我想严格来说，表现出未定义行为的东西并不是“非法的”，但根据我的经验，只要 C/C++ 程序中有东西表现出“未定义行为”（除非它是扩展）——它就是一个错误。我认为将这样的构造称为非法并不令人困惑、误导或误导。

另外，我认为试图解释编译器为达到值 14 所做的工作并不是特别有帮助，因为这没有抓住重点。编译器几乎可以做任何事情；事实上，当编译器使用不同的优化选项运行时，编译器可能会得到不同的结果（或者可能会产生崩溃的代码——谁知道呢？）。

对于那些想要一些额外参考或呼吁权威的人，这里有一些提示：

从 1995 年开始，Steve Summit（comp.lang.c 常见问题的维护者）对这个主题的长篇回答：

*   [http://www.eskimo.com/~scs/readings/undef.950321.html](http://www.eskimo.com/~scs/readings/undef.950321.html)

以下是 Bjarne Stroustrup 对此事的看法：

*   [http://www.research.att.com/~bs/bs_faq2.html#evaluation-order](http://www.research.att.com/~bs/bs_faq2.html#evaluation-order)

* * *

*脚注*：C++ 标准只使用了一次“非法”这个词——在描述 C++ 和标准 C 之间关于类型声明的使用`static`或`extern`类型声明的差异时。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-04T11:47:15.710

简单...您的编译器在执行求和之前评估**两个**增量，而不缓存中间结果。这意味着当您添加 i 两次时，它现在的值是 7。

如果你这样做

```
int j=++i; 
int k=++i;

i = j+k; 
```

你会按预期看到 13。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T11:44:52.080

在您的特定编译器上，它选择先执行两个 ++ 操作，然后是加法。它将代码解释为：

```
int i = 5;
++i;
++i;
i = i + i;
cout << i; 
```

这是完全有效的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T17:31:18.730

一个更好的问题是，它会一直如此`14`吗？

```
int i = 5;
i = ++i + ++i;
cout<<i;

i = ++i   + ++i   ;
i = ++(5) + ++(5) ;
i =    6  +    6  ;
i = 12;

i = ++i   + ++i   ;
i = ++i   + ++(5) ;
i = ++i   +   (6) ;
i = ++(6) +    6  ;
i =   (7) +    6  ;
i = 13;

i = ++i   + ++i   ;
i = ++i   + ++(5) ;
i = ++(6) +   (6) ;
i =   (7) +   (7) ;
i = 14; 
```

很可能它会是`14`，因为它*稍微*更有意义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-05T13:39:34.577

我认为，从语法树的角度来看问题，问题的答案就更清晰了：

我
|
=
|
+
|
一元表达式 - 一元表达式

一元表达式：一元运算符表达式

在我们的例子中，表达式归结为变量 i。

现在发生的情况是两个一元表达式都修改了相同的操作数，因此在添加两个一元表达式的结果之前，代码在计算一元表达式时会执行两次 ++i 。

所以代码所做的确实是

++i;
++i;
我 = 我 + 我;

对于 i = 5，这意味着

i = i + 1；//i <- 6
i = i + 1; //i <- 7
i = i + i; //i <- 14

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-04T11:43:24.517

因为前缀增量具有优先权：

```
int i = 5;
i = i+1; // First ++i, i is now 6
i = i+1; // Second ++i, i is now 7
i = i + i // i = 7 + 7
cout << i // i = 14 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-04T12:43:24.240

```
 i = i++ + i; //11  

 i = i++ + i++; //12

 i = i++ + ++i; //13

 i = ++i + i++; //13

 i = ++i + ++i; //14 
```

# c - 避免 fork()/SIGCHLD 竞争条件

> ID：340283
> 
> 赞同：14
> 
> 时间：2008-12-04T11:36:07.790
> 
> 标签：c, fork

请考虑以下`fork()`/`SIGCHLD`伪代码。

```
 // main program excerpt
    for (;;) {
      if ( is_time_to_make_babies ) {

        pid = fork();
        if (pid == -1) {
          /* fail */
        } else if (pid == 0) {
          /* child stuff */
          print "child started"
          exit
        } else {
          /* parent stuff */
          print "parent forked new child ", pid
          children.add(pid);
        }

      }
    }

  // SIGCHLD handler
  sigchld_handler(signo) {
    while ( (pid = wait(status, WNOHANG)) > 0 ) {
      print "parent caught SIGCHLD from ", pid
      children.remove(pid);
    }
  } 
```

在上面的例子中有一个竞争条件。" "有可能`/* child stuff */`在 " " 开始之前完成，`/* parent stuff */`这可能导致孩子的 pid 在退出后被添加到孩子列表中，并且永远不会被删除。当应用程序关闭时，父母将无休止地等待已经完成的孩子完成。

我能想到的一种解决方案是有两个列表：`started_children`和`finished_children`. 我会添加到`started_children`我现在添加到的同一个地方`children`。但是在信号处理程序中，不是从`children`我删除，而是*添加*到`finished_children`. 当应用程序关闭时，父母可以简单地等到`started_children`和之间的差异`finished_children`为零。

我能想到的另一个可能的解决方案是使用共享内存，例如共享父母的孩子列表并让孩子`.add`和`.remove`他们自己？但我对这方面了解不多。

编辑：另一个可能的解决方案，这是我首先想到的，就是`sleep(1)`在开头添加一个，`/* child stuff */`但这对我来说很有趣，这就是我忽略它的原因。我什至不确定这是 100% 修复。

那么，您将如何纠正这种竞争条件？如果有一个完善的推荐模式，请告诉我！

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-04T12:20:24.597

最简单的解决方案是在处理 pid 之后在父代码中阻止 SIGCHLD 信号`fork()`并在父代码中取消阻止它。`sigprocmask()`

如果孩子死了，SIGCHLD 的信号处理程序将在您解除阻塞信号后被调用。这是一个关键部分的概念-在您的情况下，关键部分在之前开始`fork()`并在之后结束`children.add()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-09T01:29:10.577

如果您不能使用关键片段，也许一个简单的计数器可以完成这项工作。添加时+1，删除时-1，无论哪一个先发生，完成后你最终可以得到零。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-04T11:46:49.080

除了现有的“儿童”之外，还添加了一个新的数据结构“早逝”。这将保持孩子的内容干净。

```
 // main program excerpt
    for (;;) {
      if ( is_time_to_make_babies ) {

        pid = fork();
        if (pid == -1) {
          /* fail */
        } else if (pid == 0) {
          /* child stuff */
          print "child started"
          exit
        } else {
          /* parent stuff */
          print "parent forked new child ", pid
          if (!earlyDeaths.contains(pid)) {
              children.add(pid);
          } else {
              earlyDeaths.remove(pid);
          }
        }

      }
    }

  // SIGCHLD handler
  sigchld_handler(signo) {
    while ( (pid = wait(status, WNOHANG)) > 0 ) {
      print "parent caught SIGCHLD from ", pid
      if (children.contains(pid)) {
          children.remove(pid);
      } else {
          earlyDeaths.add(pid);
      }
    }
  } 
```

编辑：如果您的进程是单线程的，这可以简化——earlyDeaths 不必是一个容器，它只需要保存一个 pid。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-02T18:21:33.953

也许是一个乐观的算法？尝试 children.remove(pid)，如果失败，继续生活。

或者在尝试删除它之前检查 pid 是否在儿童中？

# iphone - 如何将两个图像组合成一个图像对象？

> ID：340284
> 
> 赞同：1
> 
> 时间：2008-12-04T11:36:18.867
> 
> 标签：iphone, cocoa-touch

如何合并两张图片？

我的意思是我有两张图片：一张小，一张大。我想在特定点将小图像添加到大图像上，我需要得到一个`UIImage`结果。

我已经尝试过`CGCreateImageFromMask`，但这会使小图像完全覆盖更大的图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T12:05:45.720

您将要使用`UIGraphicsBeginImageContext()`来生成`CGContextRef`，然后使用`UIGraphicsGetCurrentContext()`来获取对它的引用。

现在将您当前的图像绘制到上下文中。完成后，用于从该上下文`UIGraphicsGetImageFromCurrentContext()`生成一个并进行清理。`UIImage``UIGraphicsEndImageContext()`

请参阅[Apple 的 UIKit 函数参考文档](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIKitFunctionReference/UIKitFunctionReference.pdf)。

# c# - 以正确的顺序获取数据集子行

> ID：340285
> 
> 赞同：2
> 
> 时间：2008-12-04T11:36:29.520
> 
> 标签：c#, .net, dataset

我在两个表之间输入了具有 1:N 关系的数据集。子表有“顺序”列，我在将数据加载到数据集时用于在 SP 中进行排序（排序依据）。据我了解，使用数据集时无法保证此顺序。我需要父行的 GetChildRows 并确保行按顺序列中定义的特定顺序。现在我执行以下操作：

```
class Program
{
    static void Main(string[] args)
    {
        DataSet1 ds = new DataSet1();
        //load data
        DataSet1.ParentTableRow parentRow = ds.ParentTable.FindByID(1);
        DataSet1.ChildTableRow[] childRows = parentRow.GetChildTableRows();
        Array.Sort<DataSet1.ChildTableRow>(childRows, new ChildTableCoparer());
        //Enumerate fields is right order
    }
}

public class ChildTableCoparer : IComparer<DataSet1.ChildTableRow>
{
    public int Compare(DataSet1.ChildTableRow x, DataSet1.ChildTableRow y)
    {
        if (x.Order > y.Order) return 1;
        if (x.Order < y.Order) return -1;
        return 0;
    }
} 
```

使用 GetChildRows() 时是否有更好的方法来确保顺序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T20:54:34.840

您可以在从中选择行之前尝试对子表进行排序。这样，当您从中选择行时，希望数组将被预先排序。

例如：

```
DataSet1 ds = new DataSet1();

//load data
DataSet1.ChildTable.SortExpression = "Order";

DataSet1.ParentTableRow parentRow = ds.ParentTable.FindByID(1);
DataSet1.ChildTableRow[] childRows = parentRow.GetChildTableRows();
Array.Sort<DataSet1.ChildTableRow>(childRows, new ChildTableCoparer());
//Enumerate fields is right order 
```

或者，您可以编写一个 LINQ 表达式来对结果数组进行排序

# java - 为什么我在 Java BasicTableUI$Handler.setValueIsAdjusting 中不断收到 NullPointerException？

> ID：340286
> 
> 赞同：1
> 
> 时间：2008-12-04T11:37:02.733
> 
> 标签：java, swing, exception

我在我的应用程序中不断得到这个 NPE，我似乎无法摆脱它，因为它没有出现在我的任何源代码中。正如您从堆栈跟踪中看到的那样，它没有发生在我的代码中，而是发生在 Swing plaf 中。你们有没有人遇到过这个问题，也许知道这里发生了什么？

```
 11:28:23,273 [AWT-EventQueue-0] ERROR [is.althingi.styran.utlit.styran.StyranImpl]
   - uncaughtException
   java.lang.NullPointerException
    at javax.swing.plaf.basic.BasicTableUI$Handler.setValueIsAdjusting(Unknown Source)
    at javax.swing.plaf.basic.BasicTableUI$Handler.mouseReleased(Unknown Source)
    at java.awt.AWTEventMulticaster.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T21:06:19.000

我设法解决了这个问题！

问题是我在`ListSelectionListener`我的`JTable`; `valueChanged`然后在我的听众的方法中调用`scrollRectToVisible`then `updateUI`，这会导致我的异常。

我所做的是在通话`invokeLater`周围添加，**不再有例外**！`updateUI`

 **像这样：

```
 SwingUtilities.invokeLater(new Runnable() {
    public void run() {
      updateUI();
    }
  }); 
```

现在我有了问题的“答案”（尽管我不确定我是否仍然理解为什么会有`invokeLater`帮助？），我认为我的问题还不够好。我没有提供有关我的问题的足够信息，以便任何人都能够回答这个问题。在我问之前我应该​​更多地研究这个问题吗？我不知道。

也许我提供对我有帮助的解决方案就足够了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T11:55:39.890

我从来没有遇到过这个特殊的问题，但是当我遇到这些“隐藏”错误时，我总是最终会查看原始源代码并试图找出问题所在......

从这个[来源](http://www.docjar.com/html/api/javax/swing/plaf/basic/BasicTableUI.java.html)你可以看到产生异常的函数：

```
private void setValueIsAdjusting(boolean flag) {
    table.getSelectionModel().setValueIsAdjusting(flag);
    table.getColumnModel().getSelectionModel().
    setValueIsAdjusting(flag);
} 
```

你能确认一下你的表选择模型吗？柱模型；列选择模型不为空？

# sql-server - MS SQL 问题 - 字段长度受到限制

> ID：340297
> 
> 赞同：1
> 
> 时间：2008-12-04T11:42:15.720
> 
> 标签：sql-server, triggers

我有一个带有各种表的 MS SQL DB，特别是一个字段让我很伤心。

数据类型设置为 varchar(100)，但该字段限制为 60 个字符。

如果我尝试将任何超过 60 个字符的字符串放入字段中，则会出现异常，“字符串或二进制数据将被截断”。尽管字符串比显式设置的数据类型短，但它仍然会引发异常。

也许有一个数据库设置可以做到这一点？什么可能导致显式设置的数据类型被覆盖？

**编辑：**
*触发器不复制值或将其插入另一个表，它们也不使用数据。*- （不正确）

小于 60 个字符的字符串可以正常工作。

所有具有 varchar(100) 的列都会出现相同的问题，但所有其他列都接受正确的值。varchar(10) 列工作正常。

如果我尝试使用超过 60 个字符的字符串更新字段，则此表中的任何行都会引发异常。

我正在尝试使用 SQL Server Management Studio 将数据直接插入到字段中。

不涉及填充。

**回答：**

第二个表的列设置为 60。更新触发器称为存储过程，将数据插入“非规范化”表。

感谢所有的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T11:47:12.323

也许您需要 NVARCHAR(100) 或更确切地说是 NVARCHAR(60)。

NVARCHAR 中的单个字符是 VARCHAR 大小的两倍。如果您的输入数据是 unicode，您将使用 NVARCHAR

**编辑：**

根据您的评论，使用 nvarchar 似乎不是问题的解决方案，而且很难猜测到目前为止提供的信息存在什么问题：

您能否使用约束和触发器编写表格并发布代码，这肯定有助于找到问题的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T13:10:47.770

元数据函数 COL_LENGTH 说的是该列的定义大小？

您对该列有任何默认长度限制吗？

从前面的答案中假设这不是触发器问题或 nvarchar 问题，并且您认为截断长度为 60，那么使用长度为 60 和 61 的 SUBSTRING 更新该单列有什么作用？这可能会验证或使您的理论无效。

或者，自插入原始数据以来，数据库排序规则和/或编码设置可能已更改。这可能会导致一些特殊性。你说这是原始数据库的副本。它是否位于不同的 SQL Server 实例上？如果是这样，两个 SQL Server 实例是否具有相同的排序规则和编码设置？

**编辑**：不推荐使用您讨论的[ANSI_PADDING 设置](http://msdn.microsoft.com/en-us/library/ms187403.aspx)，并且该设置将在 SQL Server 的未来版本中永久启用。但是您正在查看的事实表明您尝试插入的值以某种方式填充，可能带有尾随空格。但是，这与您的 SUBSTRING 实验结果不一致，该结果显示 60 个字符的截止值。所以我不确定这个设置是否相关，特别是因为它对于 nvarchar 列总是打开的。

任何 61 个字符的字符串都会导致更新异常吗？此外，尽管您已经检查了立即表触发器，但是否有任何可能导致此异常的级联（间接）触发器？

# interpreted-language - 为什么这么多网络语言是解释而不是编译的？

> ID：340298
> 
> 赞同：35
> 
> 时间：2008-12-04T11:42:34.127
> 
> 标签：interpreted-language

为什么像 C 这样的语言最终没有被用于 Web 开发？编译后的速度提升肯定对重负载站点有用吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-04T11:50:18.060

另一个很好的理由是，在大型服务器上，执行速度与其说是连接速度问题，不如说是连接速度问题。大部分时间都花在发送和接收数据上，而不是数字运算上。实际上，在某些进行大量计算的 Web 服务中*，*硬运算可能*是*作为编译程序运行的。

另外，解释型语言不需要编译（在大型项目中可能需要时间），因此它更适合 Web 解决方案的典型敏捷开发。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-12-04T12:34:11.073

大多数 Web 应用程序都与数据库通信。绝大多数这些应用程序几乎将所有时间都花在与数据库通信上。因此，对于应用程序的任何给定请求，应用程序服务器中的处理量很小，然后在等待数据库时会出现长时间的停顿。由于任何请求的一小部分时间都花在了实际的应用程序服务器代码上，因此通过用 C/C++ 编写代码来优化该代码只会在响应时间上获得很小的、可能不明显的改进。

因此，与其专注于 C/C++ 并节省最后一个 CPU 周期，不如担心开发人员的工作效率。开发人员非常昂贵。而且，它们在脚本语言甚至 Java 中的生产力通常比在 C/C++ 中高得多。

当然，这也有例外。如果对您的应用程序的某些请求是 CPU 或内存密集型的，它们应该用 C/C++ 编写。但是，对于您的应用程序的其余部分，您最好专注于优化您的算法、数据结构、与数据库的通信以及开发人员的生产力，而不是优化您的语言。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-04T12:24:02.810

与 C 相比，脚本语言具有以下优点：

1.  更快的发展
2.  今天，所有与这个问题相关的内容都是在运行时编译的。在某些情况下，这可以使它们比等效的 C 程序更快，因此性能不再是问题。
3.  维护成本低得多
4.  您可以使用敏捷方法（如单元测试）进行开发，这会产生更好的代码。是的，你也可以在 C 中做到这一点，但要付出更多的努力。
5.  当您进行 Web 开发时，您拥有可以为您完成大部分工作的庞大框架。
6.  他们更愿意改变。实施一项新功能可能需要几分钟时间。
7.  如果出现问题，您可以登录服务器，在控制台中启动文本编辑器并修复问题，有时无需重新启动。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-04T11:48:23.337

C 早期用于 Web 应用程序 - 我在其中编写了各种 CGI 脚本。

然而，随着时间的推移，效率更高的语言（例如 C# 和 Java - 当然不只是那些）已被证明对于 Web 应用程序来说“足够高效”。请注意，C# 和 Java 都被编译为中间代码，然后进行 JIT 编译，从而实现“大致”本机代码性能。为什么我们要使用 C 来代替？

据我所知，即使是传统的“真正解释”的语言，如 PHP，现在也经常在执行时编译。（特别是我对 PHP 的了解都是二手的。也许它总是被编译过......同样我确信有些网络平台仍然总是被解释。）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-04T11:45:18.740

至少在最初，后端代码（我假设您正在谈论的内容）所做的很多工作都是面向文本的。他们要么直接从头开始构建页面，要么将数据库中的数据与模板结合起来。

C 并不...总是非常适合文本处理。C 字符串是非常基本的，虽然 C 中的文本处理当然可以快速执行，但开发起来通常需要更长的时间，并且需要一些更深的技能才能正确，而不是帮助你更多的语言。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-04T12:30:10.693

好问题。原因基本上是由于网络的发展。分步骤思考：

1）“网络”上的基本文本 -> 2）添加到文本中的一些“标记” -> 3）“中心”标签和“选框”形成！！！什么进展！！！-> 4) 在客户端编写脚本！！！5) -> 嗯...在服务器上编写脚本！！！

虽然我形成这个答案有点愚蠢，但这是真的。互联网，尤其是“网络”，是一个惊人的进化过程。确实，**对**更强大的语言（和更高性能的语言）的需求只是最近才出现的。

另外，看看工具。我在记事本（和其他一些简单的应用程序）中做了我的 PHP。当我第一次做 Web 开发时，我的电脑没有足够的硬盘空间来支持 Visual Studio 2008 :)

旁白但是：那里有“.exe”应用程序（我认为“ [SunBiz](http://www.sunbiz.org/) ”发布到“exe”），并且有一段时间编译了cgi应用程序，但它们要少得多。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-12-04T14:05:28.723

值得指出的是，大多数脚本语言（Python、Ruby 等）很容易（几乎是微不足道地）桥接到 C。（我刚刚为 Python 程序编写了一些 C 扩展，它的简单程度给我留下了深刻的印象。）如果网站/Web 应用程序由于使用“慢”脚本语言确实存在一些瓶颈，通常可以使用 C 等更快的语言编写性能关键部分。事实上，这就是 Google 搜索、Facebook 等大型应用程序等等，确实如此——他们用脚本语言编写界面，并使用 C 等其他语言完成繁重的工作。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-12-04T12:00:56.603

这主要是因为动态更改它们既快速又简单。编译语言需要一个必须与服务器匹配的开发环境。使用脚本，您可以使用 ftp 工具直接编辑文本然后保存。这种从任何操作系统或类型​​的任何计算机上执行此操作的能力已经多次挽救了我的生命（或者正确地说是我的网站生命）。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-12-04T12:50:14.740

尝试在 Perl/PHP 中的 C 中进行一些字符串解析/操作，您就会知道。

BTW：为什么这么多人说性能不再是问题？对于小型主页/博客，我可能不是问题，但是大型 Web 应用程序仍然需要针对性能（cpu/网络/内存）进行调整，无论它们是用 java、php 还是 ruby​​ 编写的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-04T14:50:27.633

> 因此，与其专注于 C/C++ 并节省最后一个 CPU 周期，不如担心开发人员的工作效率。开发人员非常昂贵。而且，它们在脚本语言甚至 Java 中的生产力通常比在 C/C++ 中高得多。

哦，非常非常真实。如果使用更动态的语言将开发人员的一周时间缩短，那么您无需支付的那一周的程序员时间将为您购买额外的服务器。甚至多台服务器，如果您喜欢大量便宜的服务器而不是一些庞大的野兽。

对于世界上的大部分地区（即，不是谷歌/亚马逊/eBay/等），一台额外的服务器将足以弥补语言选择可能导致的任何原始性能损失。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-04T13:34:11.983

以下是我对这个问题的看法：

*   原始的 CGI 应用程序需要自己的操作系统进程，这当然是一种资源消耗。使用原生代码尝试将所有内容捆绑到一个进程中也不容易，因为如果应用程序出现问题，很容易导致整个服务器瘫痪。使用解释器或虚拟机更容易处理这些事情。你当然可以对本机代码做同样的事情，但我想实现框架会困难得多。最后，您将最终实现类似于解释器或 VM 的东西。
*   解释语言可以跨操作系统移植。
*   当然，最大的好处是您通过使用现代语言获得的生产力提升。
*   性能当然很重要。然而，解释或 VM 语言在这方面变得越来越好（使用 JIT 编译等技术）并且正在接近本机代码的性能。此外，仅比较执行过程中花费的时间也是不公平的。您需要测量整个序列：接收来自服务器的请求、委托给适当的应用程序、执行、将结果返回给服务器。在所有这些方面，本机应用程序会更快吗？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-04T15:01:58.733

动态语言的许多非常有用的特性，比如内省和像 eval() 这样的函数真的很难/不可能吗？以编译为本机代码的语言实现。

话虽如此，大多数“脚本”语言确实（即时）编译为某种中间代码，然后将其解释为（Python、Ruby、Perl），甚至可能 JIT 编译为本机代码（JSP、.NET）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-04T13:41:10.377

我的公司为我们的 webapp 使用 C++（一个 ISAPI 扩展）。几乎所有内容都在编译后的二进制文件中完成。我们还将 JavaScript 引擎用于需要编写脚本的系统部分（是的，服务器端 JavaScript）。引用此设计的原因是速度，但年龄也是一个因素……这是一个旧代码库。此外，我们将我们的产品分发给我们的一些客户以托管他们自己，因此对其进行编译可以保护我们的源代码（许多解释语言可以简单地反编译，或者在 PHP 和 Perl 的情况下，根本不会编译）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-11-06T00:07:41.497

因为业界普遍认为执行速度无关紧要（正如公认的答案所证明的那样）。

我认为真正的原因是，如果您使用现有的框架，解释型语言更容易上手，并且它们使在 Web 应用程序上工作看起来很容易和有趣。

在很多很多情况下，您确实需要在 Web 应用程序中进行数字运算，但开发人员最终要么不这样做（因为它们很昂贵）和/或将任务委托给外部服务器：要么是数据库服务器，要么是一些其他服务器。

这可以从最近所谓的“微服务”架构的激增中看出。

* * *

## 回答 #15

> 赞同：-9
> 
> 时间：2008-12-04T11:54:50.453

很久以前，脚本语言是 Web 开发的唯一选择。现在我们有了其他选择（Java、.NET ..），所以情况还不错。

C 作为一个平台对于 Web 开发来说并不是很成功，因为很难构建一个可以从 Web/应用程序服务器加载和执行的模块，但是构建动态 Web 应用程序的第一个框架之一是 Microsoft IIS 的 ISAPI 模块，主要是用 C++ 开发并编译。

# javascript - 点击两次激活？javascript onclick问题

> ID：340309
> 
> 赞同：2
> 
> 时间：2008-12-04T11:46:05.010
> 
> 标签：javascript, jquery, validation, jquery-validate

我目前正在使用 jQuery 的[验证](http://plugins.jquery.com/project/validate)插件的项目遇到问题，当出现验证错误时，我正在通过 onclick 对其动态应用锚标记。而它的这个onclick就是问题所在......

第一次出现验证错误时，我必须单击链接两次才能触发 onclick 事件。

我通过 IE 开发人员工具栏查看了该页面，并且锚正确地包装了验证消息，并附上了 onlick 和所有必要的 javascript 文件

怎么回事？任何建议将不胜感激:)

编辑：添加代码片段

```
jQuery(document).ready(function() {
        jQuery('#group-edit-form').validate({
            rules: {
                title: {
                    required: true,
                    remote: '<%=Url.Action("ValidateGroupName", new { id = ViewData["GroupId"] }) %>?parentId=' + getParentId()
                }
            },
            messages: {
                title: {
                    required: getMessage (7002),
                    remote: '<%= ((MessagingModel)ViewData["Messages"]).GetMessage (9001) %>'
                }
            }
        })

    });
    function getMessage(messageId) {
        var message = "<a id='errorMessageAnchor_" + messageId + "' onclick='messageBuilder(" + messageId + ")'><%= ((MessagingModel)ViewData["Messages"]).GetMessage (7002) %></a>";

        return message;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T17:44:26.377

干扰锚点点击的是模糊事件。

您可以选择以下选项之一：

*   禁用对模糊事件的验证`onfocusout:false`
*   禁用将焦点设置在无效元素上`focusInvalid:false`

# php - 将 PHP 应用程序重写为 Python 是一个富有成效的步骤吗？

> ID：340318
> 
> 赞同：6
> 
> 时间：2008-12-04T11:48:19.967
> 
> 标签：php, python

我有一些用 PHP 编写的旧应用程序，我正在考虑将它们转换为 Python——它们都是从简单的静态 html 开始的网站，然后发展到 PHP，现在包括带有管理区域、rss 等的博客。我正在考虑重写它们在 Python 中提高可维护性以及利用我增加的经验来更健壮地编写东西。

这值得努力吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-04T11:54:58.907

你需要在这里考虑一些部分，

1.  你会从重写中获得什么
2.  这是一个经济明智的决定
3.  对于新程序员来说，代码会更容易处理吗
4.  在性能方面，这是一个不错的选择吗？

这四点很重要，重写代码后工作效率会不会更高？大概。但重新开发的成本值得吗？

要遵循的一个重要步骤，如果您决定重新编写，制作3个文档，首先分析项目，需要做什么？一切应该如何运作？然后提出一个文档，里面有需求，我们具体需要什么，应该怎么做？最后但同样重要的是，设计文档，您放置所有最终类图、系统操作以及页面的设计和流程应该如何工作。

这将帮助新开发人员和老开发人员真正思考“我们真的需要重新编写吗？”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T11:51:27.480

一定要抵制[第二系统效应](http://en.wikipedia.org/wiki/Second-system_effect)，你应该是安全的。

重写现有项目可为您提供可达到的目标。你知道你要去哪条路。但不要试图一次做太多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T11:57:32.817

好吧，这取决于... ;) 如果您要将旧代码与新的 Python 代码一起使用，它可能会很有用，不是为了速度，而是为了更容易集成。但通常：“如果它没有坏，就不要修复它”。Allso 重写可以产生更好的代码，但只有在需要时才这样做。

作为一个爱好项目当然值得，因为过程就是目标。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T12:17:20.453

重写非常昂贵：您花费大量时间做一些对您没有直接帮助的事情。Joel Spolsky 对此进行了详细说明：

[你不应该做的事情，第一部分](http://www.joelonsoftware.com/articles/fog0000000069.html)

如果收益大于成本，您应该这样做；请注意不要低估成本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T13:39:05.983

正如其他人所说，看看你为什么这样做。

例如，在工作中，我将我们现有的库存/销售系统重写为 Python/django 后端。为什么？因为现有的 PHP 代码库已经过时，并且随着我们业务的发展而扩展性很差（加上它是在我们的业务模型不同时构建的，然后进行了修补以匹配我们当前的需求，这导致了一些意大利面条式代码）

所以基本上，如果你认为你会从它中受益，而不仅仅是“甜蜜的现在在 python 中！” 然后去吧。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T11:53:50.953

您的目标纯粹是为了改进应用程序，还是您想学习/使用 Python？

如果是第一个，我会说你应该坚持使用 PHP，因为你已经知道了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T14:07:12.167

如果您要为已经工作的代码添加更多功能，那么将其移植到 python 可能是个好主意。毕竟，它会让你提高生产力。你只需要权衡它，重写任务是否会超过潜在的收益......

而且，当您这样做时，请尝试尽可能多地进行单元测试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T14:40:13.550

正如其他人所说，重写将花费比您想象的更长的时间，并且修复所有错误并使用旧版本中的所有功能将需要更长的时间。您最好简单地改进和重构您拥有的 php 代码。将项目从一种语言移植到另一种语言只有几个很好的理由：

1.  表现。有些语言只是比其他语言快，而且到了一个点，没有什么可以优化的，并且在问题上扔硬件不再有效。
2.  可维护性。有时很难找到懂一些晦涩语言的好人，这些语言是您编写遗留代码所用的。在这种情况下，用更流行的语言重新编写它以简化以后的维护可能是个好主意。
3.  移植到不同的平台。如果你突然需要让你的旧 VB 程序在 OS X 和 Linux 以及 Windows 上运行，那么你可能正在考虑用不同的语言重写

在您的情况下，上述任何一点似乎都不成立。当然，如果它是一个不重要的应用程序，并且你想为学习体验做它，那么一定要去做，但从商业或经济的角度来看，我会仔细研究这样的重写会带来什么成本以及您希望获得什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-04T19:55:51.057

我为我的公司在 PHP 站点和 Turbogears(Python) 站点之间进行了转换。这样做的最初原因有两个，首先是重新设计会更容易，其次是可以轻松添加功能。完成完全转换确实需要一段时间，但我们最终得到的是一个非常灵活的后端和一个更加灵活和可读的前端。我们添加了几个在 PHP 中会非常困难的特性，并且我们目前正在对前端进行全面检修，结果证明这非常容易。

简而言之，这是我会推荐的东西，我的老板可能会说同样的话。不过，这里有些人提出了很好的观点。Python 的速度不如 PHP 所能提供的那么快，但它在性能方面的不足之处更多地弥补了它的多功能性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T14:14:49.733

其他问题包括应用程序的业务关键程度以及找到维护者的难度。如果页面是您的爱好，那么我看不出您不应该重写它们的理由，因为如果您引入错误或重写没有按计划进行，企业就不会赔钱。如果应用程序是业务的核心，我不会重写它，除非您遇到当前设计的限制，如果没有完全重写就无法克服，此时语言选择次要于您需要抛出的事实几年的工作，因为它不可维护并且不再满足您的需求。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-04T15:03:10.680

尚未提出的一项是当前代码库的大小。根据有多少代码应该会影响您的决定。

[Joel Spolsky](http://www.joelonsoftware.com/articles/fog0000000069.html)永不重写的论点在 Netscape 大小的代码库的上下文中是有效的。而较小的代码库代码会从重写中显着受益。

# dependency-injection - DI 和复合组件 - 设计

> ID：340324
> 
> 赞同：2
> 
> 时间：2008-12-04T11:49:29.027
> 
> 标签：dependency-injection, law-of-demeter

我正在为系统设计一个新组件，尝试遵循有关 DI 的各种准则，以便我们在隔离、模拟等方面获得回报。

所以我有以下组件（说明为抽象）：

*   Fetcher - 支持 IFetcher，它从特定数据源获取数据。返回 IDataSource。
*   Builder - 支持 IBuilder，它从 IDataSource 构建结构。

我想将它们包装在一个“Performer”（因为想要一个更好的名字）组件中，它会执行以下操作：

```
IDataSet Performer.Perform(IFetcher fetcher, IBuilder builder)
{
  IDataSource ds = fetcher.Fetch();
  return builder.BuildDataSet(ds);
} 
```

为了遵守 Dependency Injection 和 LoD 指南（据我所知），我同时传入了 IFetcher 和 IBuilder 组件。

我的问题 - 这听起来像一个可以接受的设计吗？与工作同事的对话是“是的，听起来不错”，但不是 100% 相信 Performer 类的封装。

在我看来，Performer 是一个复合控件，它将几个不同的组件粘合在一起，这应该是可以接受的。唯一的问号是我是否应该有一个“Performer Factory”，但考虑到可以模拟实际组件（Ifetcher 和 IBuilder），这似乎有点过分了。

任何想法将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T12:08:27.727

从 DI 的角度来看，我唯一要改变的是在执行器构造函数中获取 fetcher 和 builder。IE

```
public class Performer { 

    private IFetcher fetcher; 
    private IBuilder builder;        

    public Performer(IFetcher fetcher, IBuilder builder) {
       this.fetcher = fetcher;
       this.builder = builder;
    }

    public IDataSet Perform(DataSource ds){
       IDataSource ds = fetcher.Fetch();
       return builder.BuildDataSet(ds); 
    }
} 
```

并使用 DI 框架。不，我认为您不需要工厂方法。只需在需要时调用 IPerformer，DI 框架就会为您构建它。

# python - 抑制 Paramiko SSHClient 类的输出

> ID：340341
> 
> 赞同：4
> 
> 时间：2008-12-04T11:56:59.747
> 
> 标签：python, paramiko

当我调用 Paramiko`SSHClient`类的 connect 函数时，它会输出一些关于建立连接的日志数据，我想抑制这些数据。

有没有办法通过 Paramiko 本身或一般的 Python 来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T15:08:27.487

Paramiko 默认不输出任何内容。您可能已经调用了日志记录模块，设置了一个在 paramiko 设置它自己的日志记录时继承的日志级别。

如果你想在 paramiko 记录器上覆盖设置：

```
logger = paramiko.util.logging.getLogger() 
```

还有一个方便的功能可以将所有内容记录到文件中：

```
paramiko.util.log_to_file('filename.log') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T14:48:33.940

我不知道 Paramiko 是什么，肯定有一个日志级别设置，但是如果你绝望并寻找临时解决方案并且你的应用程序是单线程的

```
import sys
dev_null = sys.stdout = sys.stderr = open('/dev/null', 'w')
try:
.
. connect()
.
finally:
  dev_null.close() 
```

如果您在没有“/dev/null”的操作系统上，您也可以使用 StringIO 进行输出

# reporting-services - SSRS 性能

> ID：340344
> 
> 赞同：6
> 
> 时间：2008-12-04T11:57:41.943
> 
> 标签：reporting-services, ssrs-2008, ssrs-2008-r2

我创建了一个 SSRS 报告，用于使用存储过程检索 55000 条记录。从存储过程执行时只需 3 秒，但从 SSRS 报告执行时需要一分钟以上。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-22T20:39:40.707

额外的时间可能是由于 Reporting Services 除了查询数据之外还呈现报表。例如，如果您为报表返回了 55,000 行，然后报表服务器必须对这些行进行分组、排序和/或过滤以呈现报表，那么这可能需要额外的时间。

我会看看数据在报告中的分组和过滤方式，然后查看您的存储过程，看看您是否可以将一些处理卸载到 SQL 代码，也许使用一些参数。尝试并旨在将返回到报表的行数减少到呈现报表所需的最小值，并且最好尽量避免在报表本身中进行分组和过滤。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T11:24:31.383

由于我的 SP 中的参数嗅探，我遇到了这样的问题。在 SQL Management Studio 中，当我运行我的 SP 时，我使用新的执行计划重新创建它（并且调用非常快），但我的报告使用旧的错误计划（用于另一个参数序列）并且加载时间比 SQL MS 中长得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T07:04:30.150

在 ReportServerDB 中，您将找到一个名为 ExecutionLog 的表。您必须查找报告的目录 ID 并检查最新的执行实例。这可以告诉您所用时间的细分 - 用于数据检索、处理、渲染等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-24T06:04:03.437

使用[SSRS 性能仪表板](http://sqlconcept.com/tools/ssrs-performance-dashboard/)报告来调试您的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-05T17:06:00.503

我遇到了类似的问题：返回 4,000 行并在 1 秒内自行运行的查询在 SSRS 中花费了很长时间，以至于超时。

事实证明，这个问题是由 SSRS 处理多值参数的方式引起的。有趣的是，如果用户选择了多个值，报告会快速呈现（约 1 秒），但如果只选择一个值，则报告需要几分钟才能呈现。

这是原始查询的渲染时间超过了应有的 100 倍：

```
SELECT ...
FROM   ...
WHERE  filename IN (@file);
-- @file is an SSRS multi-value parameter passed directly to the query 
```

我怀疑问题在于 SSRS 引入了整个源表（超过 100 万行），然后执行客户端过滤器。

为了解决这个问题，我最终通过表达式将参数传递到查询中，这样我就可以自己控制过滤器。也就是说，在“数据集属性”窗口的“参数”屏幕上，我将参数值替换为以下表达式：

```
=JOIN(Parameters!file.Value,",") 
```

...（我还给结果起了一个新名称：filelist），然后我更新了查询，如下所示：

```
SELECT ...
FROM   ...
WHERE  ',' + @filelist + ',' LIKE '%,' + FILENAME + ',%';
-- @filelist is passed to the query as the following expression:
-- =JOIN(Parameters!file.Value,",") 
```

我猜想将查询移动到存储过程也是缓解问题的有效方法（因为 SSRS 在将多值参数传递给存储过程之前基本上会执行相同的 JOIN）。但就我而言，在报告中处理这一切要简单一些。

最后，我应该指出，LIKE 运算符可能不是过滤项目列表的最有效方法，但它的编码肯定比拆分字符串方法简单得多，并且报告现在运行大约一秒钟，因此拆分字符串似乎不值得付出额外的努力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-18T08:58:08.170

过时的问题，但因为这样的事情有点反复出现，我改进 SSRS 的“快速而肮脏”的解决方案，它在大型企业环境中完美运行（我正在渲染每天最多可以有 100.000 多行的报告）是正确设置**InteractiveSize**页面的大小（例如，将其设置为 A4 尺寸 -21 cm ）。当 InteractiveSize 设置为 0 时，所有结果都将呈现为单页，这实际上会扼杀 SSRS 的性能。在这种情况下，在您的数据库上可能需要几秒钟的查询可能需要永远呈现（或导致内存不足异常，除非您的 SSRS 服务器上有大量冗余硬件）。因此，如果查询/SP 在直接调用时执行速度相当快并检索大量行，请设置 InteractiveSize，您将无需为其他更复杂的解决方案而烦恼。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-09T21:22:54.313

我遇到了同样的问题。查询在 SQL 中运行得很好，但在 SSRS 中运行速度很慢。您是否在数据集中使用 SSRS 参数？我发现如果您在某些查询中直接使用报告参数，则会对性能造成巨大影响。

相反，如果您在数据集中有一个名为 @reportParam 的报表参数，只需执行以下操作：

```
declare @reportParamLocal int
set @reportParamLocal = @reportParam

select * from Table A where A.field = @reportParam 
```

这有点奇怪。我不太清楚它为什么有效，但它对我有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-04T11:09:47.270

显然，让报告正确运行（即花费相同数量级的时间来选择与 SSMS 相同的数据）将是可取的，但作为一种解决方法，您的报告是否支持执行快照（即没有参数，或报告中存储的参数默认值)?

这将允许预先检索和存储数据的计划快照，这意味着 SSRS 只需要在用户打开报告时处理和呈现报告。应该将等待减少到几秒钟（取决于报告需要什么处理。YMMV，测试看看你是否获得了性能改进）。

转到报表管理器中的报表属性选项卡，选择执行，更改为从报表执行快照呈现此报表，指定您的计划。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-29T07:47:21.400

加速 SSRS 报告的主要解决方案是**缓存**报告。如果这样做（例如，我在早上 7:30 预加载缓存）或缓存命中的报告，则会**发现加载速度大幅提升。**

请注意，**我每天都在专业地做这件事，**而不是简单地在 SSRS 上打蜡

在 SSRS 中缓存 [http://msdn.microsoft.com/en-us/library/ms155927.aspx](http://msdn.microsoft.com/en-us/library/ms155927.aspx)

预加载缓存 [http://msdn.microsoft.com/en-us/library/ms155876.aspx](http://msdn.microsoft.com/en-us/library/ms155876.aspx)

如果您不喜欢需要很长时间的初始报告并且您的数据是静态的，即每日总账等，这意味着数据在一天内相对静态，**您可以增加缓存寿命**。

**最后**，您还可以选择让业务经理改为通过**电子邮件订阅**接收这些报告，这将向他们发送一个时间点 Excel 报告，他们可能会发现该报告更容易、更系统。

您还可以在 SSRS 中使用参数，以便用户轻松解析并加快查询速度。在您希望参数化的过滤器列下的查询生成器类型 IN(@SSN) 中，您将在 BIDS GUI 左上角的数据源上方的参数文件夹中找到它。[如果您在 SSRS 中看不到数据源部分，请按 CTRL+ALT+D。

在此处查看几乎相同的问题：[SSRS 的性能问题](https://stackoverflow.com/questions/976133/performance-issuses-with-ssrs/11229634#11229634)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-23T10:55:51.657

可以做以下几件事来提高报表的性能： 1\. 在报表管理器上启用缓存并设置刷新缓存的时间段。2\. 对报表中用作源的所有后端数据库表应用索引，尽管您的存储过程在呈现数据方面已经花费了非常少的时间，但仍然应用索引可以进一步提高后端级别的性能。3\. 使用共享数据集而不是使用报表中的嵌入数据集，并对所有这些数据集应用缓存。4\. 如果可能，将参数设置为加载默认值。5\. 尽量减少存储过程选择的数据，例如，如果报告中包含无用的历史数据，可以添加过滤器以排除该数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-05-10T16:54:02.563

您可能想要快速查看的一件事是您的报告中的元素是否会减慢执行速度。

例如，我在 dateTimes 之间转换时发现了巨大的执行时间差异。报告中的任何元素是否使用 CDate 函数？如果是这样，您可能需要考虑在 sql 级别进行格式化。

一般来说，转换可能会导致速度大幅下降，因此请花时间查看您的数据集，看看可能是什么问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-03-07T03:44:05.417

这有点混合了上面的答案，但尽最大努力以最简单和最完整的格式从存储过程中获取数据。我在服务器上进行所有的排序、分组和过滤。服务器是为此而构建的，我只是让报告服务完成漂亮的显示工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-07-02T07:35:32.760

除了@RomanBadiornyi 的回答，尝试添加

```
OPTION (RECOMPILE) 
```

到存储过程中的主查询结束。

这将确保每次为不同的参数重新编译查询，以防不同的参数需要不同的执行计划。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-04-25T17:20:39.957

我有同样的问题......这确实是渲染时间，但更具体地说，这是因为 SORT 在 SSRS 中。尝试将排序移动到存储过程并从 SSRS 报告中删除任何排序。在 55K 行上，这将显着改善它。

# c# - Web 服务无法打开命名管道 - 访问被拒绝

> ID：340345
> 
> 赞同：1
> 
> 时间：2008-12-04T11:57:46.343
> 
> 标签：c#, .net, c++, winapi, named-pipes

我有一个 C++ 服务，它为具有 NULL SECURITY_ATTRIBUTES 的客户端提供命名管道，如下所示：

`hPipe = CreateNamedPipe( lpszPipename, PIPE_ACCESS_DUPLEX | FILE_FLAG_OVERLAPPED, PIPE_TYPE_BYTE | PIPE_READMODE_BYTE | PIPE_WAIT, PIPE_UNLIMITED_INSTANCES, BUFSIZE, BUFSIZE, 0, NULL);`

有一个 dll 使用这个管道来获取服务。

有 ac# GUI 使用 dll 并且工作正常。

有一个 .net 网站也使用此 dll（在同一台 PC 上完全相同），但在尝试打开管道时总是被拒绝权限。

任何人都知道为什么会发生这种情况以及如何解决它？

也有人知道关于 SECURITY_ATTRIBUTES 的好教程，因为我还不了解 msdn 信息。

谢谢，帕特里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T12:02:40.890

检查 ASP.NET 网站上使用的身份验证类型，以及该网站的 web.config 文件中的模拟设置。很可能，ASP.NET 代码在不允许在您的计算机上创建命名管道的帐户下运行。

您可以通过向 ASP.NET 应用程序正在使用的帐户授予更多权限，或者通过将该 Web 应用程序配置为使用不同的（更高权限的）帐户来修复它。话虽如此，您真的希望您网站的远程访问者能够创建命名管道吗？我不会教你，我想你已经考虑过了。

我见过的对 SECURITY_ATTRIBUTES 最平易近人、最彻底的描述是在 Keith Brown 的这本书中...... [http://www.amazon.co.uk/gp/product/0201604426](http://www.amazon.co.uk/gp/product/0201604426)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T01:31:56.560

命名管道的默认 ACL（您使用空安全描述符获得的内容）仅授予 LocalSystem、管理员和管道的所有者/创建者的写访问权限。除非您的 Web 应用程序在其中一个帐户下运行（默认情况下不会），否则您将无法获得写入权限。（我假设你要求读/写。）

有几个选择...

1.  让 Web 应用程序在与创建管道的服务相同的帐户下运行。

2.  将 Web 应用程序配置为使用模拟，方法是在 web.config 中指定具有写入权限的特定用户，或者将其设置为使用 IIS 传入的用户（并从具有写入权限的用户帐户访问应用程序）。

3.  在管道访问期间手动模拟具有写访问权限的用户（例如，使用 WindowsIdentity.Impersonate）。

4.  在授予每个人（或运行应用程序的特定帐户，尽管设置起来会更复杂）的写访问权限的管道上使用非默认安全描述符。

[这里](http://msdn.microsoft.com/en-us/library/aa446595.aspx)有一个创建简单安全描述符的示例；您应该能够对其进行修改以满足您的需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-08T16:15:03.870

添加行：

<身份模拟=“真”/>

到 web.config 文件的 <system.web> 部分允许访问管道。我不建议其他人使用它，因为我不确定安全隐患，但它现在适合我们的要求。

感谢 Eric 和 Martin 为我指明了正确的方向。

# interpreted-language - 怎么可能出售用解释语言编写的代码？

> ID：340347
> 
> 赞同：7
> 
> 时间：2008-12-04T11:59:08.010
> 
> 标签：interpreted-language

在我看来，如果您使用解释性语言编写软件，那么销售软件肯定很困难，因为购买它的任何人都可以轻松编辑/更改/转售它。

你如何解决这个问题？我有几个 PHP 应用程序我不愿意卖给人们，因为他们似乎太容易更改/阅读/编辑/出售我制作的内容。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-04T12:09:31.030

几乎没有人出售代码。我们出售创建、编辑、支持和理解代码的能力。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-04T12:24:47.257

作为您的应用程序的潜在买家，我可能会发现这些功能很有吸引力：

*   更改代码以满足我的需要的能力
*   阅读代码以更好地理解它在做什么的能力

... 是的 ...

*   出售我的修改的能力

这三个都是*特征*。

第三个可能是您无法提供给我的功能。通过法律措施而不是技术措施来解决这个问题。这就是许可的用途。您还可以出售允许转售的更昂贵的许可证。

您可以采取一些措施来删除前两个功能，但请记住，这样做会降低产品对某些人的整体价值，从而降低其售价。

对许多人来说，使用开源软件的主要原因不是它不花钱——而是你可以获得源代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-04T12:01:04.980

人们一直在出售创建网站的服务。此外，即使是编译语言也可以更改，只是更加困难。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-04T12:08:01.063

大多数情况下，用户群不了解如何进行更改或如何处理脚本，因此您实际上是在出售有关如何安装和更改脚本的知识。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-04T12:05:27.827

不卖软件，卖“许可证”。

我将尝试更好地解释，构建 Web 应用程序但为其提供托管。这样您的客户将永远不会“持有”源代码。

如果你真的必须提供源代码，那么混淆是要走的路；）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-04T14:08:14.583

可能的路线：

*   转换为字节码、二进制或混淆格式

例如，[Splunk](http://www.splunk.com)主要是用 Python 编写的，并分发字节码。[EVE 在线](http://www.eve-online.com)客户端使用Stackless Python 编译为可执行二进制文件。

*   自己托管解决方案

建个网站，收费使用。

*   许可软件

他们获得源，但不能合法地修改或重新分发源。

*   开源解决方案

任何人都可以更改代码，但您是其事实上的权威，您可以通过销售支持、咨询和定制服务来赚钱。

您还可以考虑多种方法的组合。例如，将您的解决方案分成几个独立的包，然后将其中的一些开源，并出售其他部分的字节码版本。然后您销售的是完整的解决方案以及其他服务，有些人可能会受益并增强解决方案的其他部分。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-04T14:01:52.100

许多公司从解释语言的应用程序中赚钱，并愉快地与它们一起分发源代码。不要个人认为，但您的程序可能不会流行到足以拥有大量海盗。任何盗版您的软件的人*可能*一开始都不会购买它。如果他们不能盗版，他们就会盗版别人。

无论您做什么，**请**不要混淆您的代码。这不是防止侵权的有效手段，除了让您和您的客户的生活变得悲惨之外，它不会做任何事情。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-04T14:06:09.377

保护你的秘密比特变得越来越困难。

恕我直言，您的解决方案实际上取决于您的目标市场。如果您的目标是业务，只需向他们提供具有良好许可证的代码，并且可能存在某种类型的缺陷，这样您就可以确定谁泄露了您的代码，如果发生这种情况。企业大多会为您的应用付费以保持合规性；这不值得法律上的麻烦。如果一个人免费获得你的应用程序，那可能是一件好事，因为他们会试图说服他们现在和未来的雇主购买它。

如果您以个人为目标，并且可以将其作为 Web 应用程序（显然您使用 PHP）进行，则将其作为托管服务进行，并出售每月订阅或允许免费访问并找到另一种货币化方式。

如果您出于某种原因确实需要或想要将其分发给个人，您可以免费赠送，并尝试通过自定义、加载项和其他支持功能获利。

这是一个已经被讨论过很多的问题，几个小时的真正专注的谷歌搜索应该会揭示所有当前的哲学。

我希望这有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-04T12:01:28.987

[混淆](http://en.wikipedia.org/wiki/Obfuscation)可能是一个好方法

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T12:17:15.803

对于 PHP，您可以选择使用[Zend Guard](http://www.zend.com/en/products/guard/) for PHP。我相信它以类似于 php 解释器的方式编译源代码，因此它也应该提高性能。当然，600 美元的价格可能对你来说太贵了 ;-)

无论如何，我认为您没有理由不使用开源许可证分发您的代码（有关可用许可证的列表，请参阅[开源计划）。](http://www.opensource.org/licenses/alphabetical)您可以找到一个禁止您的客户重新分发您的应用程序的方法。

**编辑：**
正如 Novelocrat 在他的评论中指出的那样，禁止分发的许可证是*根据定义*而不是开源许可证，*开源*一词不仅仅指源代码的可用性。（另请参阅[此相关问题](https://stackoverflow.com/q/5920737/22114)的答案以进行进一步讨论）。

# java - 插入 Java 编译器

> ID：340353
> 
> 赞同：6
> 
> 时间：2008-12-04T12:01:37.753
> 
> 标签：java, compiler-construction, annotations, instrumentation

我有一个操作生成类的 Java 字节码的后编译步骤。我想让图书馆消费者的生活尽可能轻松，所以我正在寻找可以使这个过程自动化并且（如果可能的话）编译器不可知的方法。

[Annotation Processing API](http://java.sun.com/javase/6/docs/api/javax/annotation/processing/package-summary.html)提供了许多所需的特性（自动服务发现；由 Eclipse 支持）。不幸的是，这是针对代码生成器的，[不支持对现有人工制品的操作](http://java.sun.com/javase/6/docs/api/javax/annotation/processing/Filer.html)：

> 该工具的初始输入被认为是由第零轮创建的；因此，尝试创建与这些输入之一对应的源文件或类文件将导致 FilerException。

API 推荐的装饰器模式不是一个选项。

我可以看到如何使用运行时代理/仪器执行该步骤，但这是比手动构建步骤更糟糕的选择，因为它需要任何被 API 接触的人以不明显的方式配置他们的 JVM。

有没有办法插入或包装[javac](http://java.sun.com/javase/6/docs/technotes/tools/)调用的[编译器工具](http://java.sun.com/javase/6/docs/api/javax/tools/JavaCompiler.html)？不管文档怎么说，有没有人成功地颠覆了注释处理器来操纵字节码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T12:36:48.637

Groovy 编译器是唯一允许挂钩到编译过程的字节码编译器（例如：[生成字节码以支持单例模式](http://svn.codehaus.org/groovy/trunk/groovy/groovy-core/src/main/org/codehaus/groovy/transform/SingletonASTTransformation.java)）

Annotation Processing API 并不意味着更改代码。正如您已经发现的那样，您所能做的就是安装一个类加载器，在运行时检查字节码并对其进行操作。这是脑死亡，但它的工作原理。这遵循了“我们害怕开发人员会尝试一些愚蠢的事情”的一般主题，您会在整个 Java 中找到该主题。没有办法扩展 javac。相关的类要么是私有的、最终的，要么会随着 Java 的下一个版本而改变。

另一种选择是编写带注释的 Java，例如您编写一个类“ExampleTpl.java”。然后，您使用预编译器扩展该文件中的注释以获得“Example.java”。在其余代码中，您使用`Example`并忽略`ExampleTpl`.

对于 Eclipse，有一个[错误报告可以自动执行此步骤](https://bugs.eclipse.org/bugs/show_bug.cgi?id=116143)。我不知道这方面的任何其他工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-09T04:58:09.947

可以办到。

看看我的博客文章[Roman Numerals，在我们的 Java](http://www.iam.unibe.ch/~akuhn/blog/2008/roman-numerals-in-your-java)中，注释处理器用于重写代码。限制是它仅适用于 Sun 的 javac。

# javascript - Opener.Location.Reload(); 在 java 脚本中显示 Permission denied 错误

> ID：340354
> 
> 赞同：5
> 
> 时间：2008-12-04T12:01:38.817
> 
> 标签：javascript

我有两个域名。domain1 和 domain2，我从 domain1/default.aspx 页面打开 domain2/index.aspx 页面作为弹出窗口。在关闭 domain2 页面时，我需要重新加载 domain1 页面，我将 javascript 代码指定为“Opener.Location.Reload();”。我收到**Permission denied** javascript 错误。关于这个问题的任何想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-06T15:55:10.210

我发现在弹出窗口中设置一个 parentUrl 变量（从查询字符串中获取），然后使用：

```
window.opener.location.href = parentUrl; 
```

作品。

我不知道为什么，我认为它很神奇，但它有效（在 IE、chrome 和 Firefox 上测试）。您无法读取 window.opener.location.href 的值，但您可以将其设置为您想要的任何 url。我用这个奇怪的东西来刷新。

希望能帮助到你

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T12:21:22.847

某些属性和操作在跨域场景中被特别阻止。您*可以*做的是在父级上创建一个执行您想要的代码的函数，然后从子级调用该函数。

例子：

```
// On the parent...
function DoTheRefresh()
{
    location.reload();
} 
```

然后，在孩子身上：

```
opener.DoTheRefresh(); 
```

我过去做过这个，所以我不确定它是否仍然是一个选择。我希望它对你有用:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-31T03:43:08.127

您可以通过在父窗口中放置代码来检测子窗口何时关闭来完成此操作。

```
var win2;

function openWindow()
{
  win2 = window.open('http://...','childwindow',...);
  checkChild();    
}

function checkChild() {
  if (win2.closed) {
    window.location.reload(true);
  } else setTimeout("checkChild()",1);
} 
```

# windows - 使 CreateProcess 继承调用进程的控制台

> ID：340356
> 
> 赞同：7
> 
> 时间：2008-12-04T12:02:06.647
> 
> 标签：windows, console, createprocess

当我在 Windows 中调用 CreateProcess 时，新进程似乎没有继承调用进程的控制台。我制作了一个运行“ruby xtest”的测试程序，xtest 是一个将“hello”写入标准输出的脚本。我从 Emacs 运行了这个测试程序，但没有得到任何输出。我还尝试了以下调用 GetStdHandle 的代码，但同样没有输出。然后我尝试将 dwCreationFlags 中的 CREATE_NEW_CONSOLE 传递给 CreateProcess，它使用 Ruby 输出创建了一个全新的窗口。最后，我做了一个简单的 fork/exec 测试程序，并使用 Cygwin 的 GCC 编译它。该程序有效：Ruby 输出按预期显示在 Emacs 中。我试图在[http://cygwin.com/cgi-bin/cvsweb.cgi/src/winsup/cygwin/spawn.cc?rev=1.268&content-type=text/x-cvsweb-markup&中破译 Cygwin 源代码](http://cygwin.com/cgi-bin/cvsweb.cgi/src/winsup/cygwin/spawn.cc?rev=1.268&content-type=text/x-cvsweb-markup&cvsroot=src)但失败了。那么，如何让新进程继承父进程的控制台，以使子进程的输出按预期显示？

```
STARTUPINFO si;
PROCESS_INFORMATION pi;
memset(&si, 0, sizeof(si));
memset(&pi, 0, sizeof(pi));
si.dwFlags |= STARTF_USESTDHANDLES;
si.hStdInput = GetStdHandle(STD_INPUT_HANDLE);
si.hStdOutput = GetStdHandle(STD_OUTPUT_HANDLE);
si.hStdError = GetStdHandle(STD_ERROR_HANDLE);
if(!CreateProcess(0, "ruby xtest", 0, 0, 1, 0, 0, 0, &si, &pi)) die("CreateProcess"); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-21T11:40:49.343

我知道，这个线程相当老，但是，我遇到了同样的问题。

就像 TS 一样，控制台句柄是继承的，并且在 Cygwin 下可以正常工作，但在 Windows 控制台上却不行。相反，既没有显示 stdout 上的输出，也没有报告任何错误。继承的管道句柄仍然可以正常工作。

我花了一些时间来确定（现在很明显的）问题：使用 CREATE_NO_WINDOW 调用了 CreateProcess()。删除此标志，控制台输出就可以了。（不过，根据 TS 的代码，他们一开始就没有设置这个标志。）

希望这可能对像我一样偶然发现此线程的人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-25T08:27:33.710

根据微软文档，*lpCommandLine*（2.参数）：

> 此函数的 Unicode 版本 CreateProcessW 可以修改此字符串的内容。因此，此参数不能是指向只读内存的指针（例如 const 变量或文字字符串）。如果此参数是一个常量字符串，该函数可能会导致访问冲突。

当我在这里停止使用常量时，它对我有用。我不需要 STARTF_USESTDHANDLES 和 GetStdHandle 东西。

来自控制台 prg 的此代码在同一控制台中运行并输出另一个控制台 exe：

```
FillChar(SI, SizeOf(SI), 0);
SI.cb:=SizeOf(SI);
FillChar(PI, SizeOf(PI), 0);
if CreateProcess(nil, CmdLineVar, nil, nil, False, 0, nil, nil, SI, PI) then ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T06:35:01.450

我通过传入 、 和 的管道`hStdInput`并`hStdOutput`手动`hStdError`将数据从`hStdOutput`和`hStdError`管道路由到控制台来完成此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T21:03:04.850

不确定 debeige 是否解决了这个问题，但我需要同样的东西，但是启动另一个线程来监听 stdout 输出，只是把它放在 stdout 上对我来说似乎很疯狂。

以下内容对我有用，与他最初发布的内容略有不同。起初我以为如果你不设置 si.cb 它将不起作用，但当我在我的评论中，它仍然有效，所以...... YMMV。

```
 STARTUPINFO siStartInfo;
   ZeroMemory( &siStartInfo, sizeof(STARTUPINFO) );
   siStartInfo.cb = sizeof(STARTUPINFO); 
   siStartInfo.hStdError = GetStdHandle(STD_OUTPUT_HANDLE); 
   siStartInfo.hStdOutput = GetStdHandle(STD_OUTPUT_HANDLE); 
   siStartInfo.hStdInput = g_hChildStd_IN_Rd;  // my outgoing pipe
   siStartInfo.dwFlags |= STARTF_USESTDHANDLES;

// Create the child process. 

   bSuccess = CreateProcess(
      NULL,         
      szCmdline,    
      NULL,         
      NULL,         
      TRUE,         
      0,            
      NULL,         
      NULL,         
      &siStartInfo, 
      &piProcInfo); 
```

# c# - 如何在.net 中获取 cpu 信息？

> ID：340359
> 
> 赞同：19
> 
> 时间：2008-12-04T12:05:03.503
> 
> 标签：c#, .net, vb.net

比如它是奔腾还是AMD等。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T13:41:31.530

**请注意，这是来自 VS2003：**

```
using(ManagementObjectSearcher win32Proc = new ManagementObjectSearcher("select * from Win32_Processor"),         
    win32CompSys = new ManagementObjectSearcher("select * from Win32_ComputerSystem"),
        win32Memory = new ManagementObjectSearcher("select * from Win32_PhysicalMemory"))
            {
                foreach (ManagementObject obj in win32Proc.Get())
                {
                    clockSpeed = obj["CurrentClockSpeed"].ToString();
                    procName = obj["Name"].ToString();
                    manufacturer = obj["Manufacturer"].ToString();
                    version = obj["Version"].ToString();
                } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T12:29:35.483

[System.Management 命名空间](http://msdn.microsoft.com/en-us/library/system.management.aspx) 提供对一组丰富的管理信息和管理事件的访问，这些管理信息和管理事件与检测到 Windows Management Instrumentation (WMI) 基础结构的系统、设备和应用程序有关。

[Win32 处理器](http://msdn.microsoft.com/en-us/library/aa394373(VS.85).aspx)WMI 类表示可以解释在 Windows 操作系统上运行的计算机上的一系列指令的设备。在多处理器计算机上，每个处理器都有一个 Win32_Processor 类的实例。该类包括一个`Processor family type`字段，对诸如*AMD Opteron Processor Family*之类的内容进行编码。

页面末尾是[C# 发出 WMI 查询](http://msdn.microsoft.com/en-us/library/system.management.aspx)的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-11T13:41:10.880

**此代码将获取 CPU 属性**

```
Imports System.Management

    Private Sub InsertInfo()
                lstView.Items.Clear()

                Dim searcher As New ManagementObjectSearcher("select * from Win32_Processor")

                Try
                    For Each share As ManagementObject In searcher.Get()

                        Dim grp As ListViewGroup
                        Try
                            grp = lstView.Groups.Add(share("Name").ToString(), share("Name").ToString())
                        Catch
                            grp = lstView.Groups.Add(share.ToString(), share.ToString())
                        End Try

                        If share.Properties.Count <= 0 Then
                            MessageBox.Show("No Information Available", "No Info", MessageBoxButtons.OK, MessageBoxIcon.Information)
                            Return
                        End If

                        For Each PC As PropertyData In share.Properties

                            Dim item As New ListViewItem(grp)
                            If lstView.Items.Count Mod 2 <> 0 Then
                                item.BackColor = Color.White
                            Else
                                item.BackColor = Color.WhiteSmoke
                            End If

                            item.Text = PC.Name

                            If PC.Value IsNot Nothing AndAlso PC.Value.ToString().Length > 0 Then
                                Select Case PC.Value.GetType().ToString()
                                    Case "System.String[]"
                                        Dim str As String() = DirectCast(PC.Value, String())

                                        Dim str2 As String = ""
                                        For Each st As String In str
                                            str2 += st & " "
                                        Next

                                        item.SubItems.Add(str2)

                                        Exit Select
                                    Case "System.UInt16[]"
                                        Dim shortData As UShort() = DirectCast(PC.Value, UShort())

                                        Dim tstr2 As String = ""
                                        For Each st As UShort In shortData
                                            tstr2 += st.ToString() & " "
                                        Next

                                        item.SubItems.Add(tstr2)

                                        Exit Select
                                    Case Else

                                        item.SubItems.Add(PC.Value.ToString())
                                        Exit Select
                                End Select
                            Else
                                Continue For
                            End If
                            lstView.Items.Add(item)
                        Next
                    Next

                Catch exp As Exception
                    MessageBox.Show("can't get data because of the followeing error " & vbLf & exp.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Information)
                End Try

                End Sub 
```

# sql - SQL Select：如果存在则更新，如果不存在则插入 - 使用日期部分比较？

> ID：340366
> 
> 赞同：6
> 
> 时间：2008-12-04T12:06:06.093
> 
> 标签：sql, sql-server, sql-update

我需要使用以下字段更新数据库中的记录

```
[ID] int (AutoIncr. PK)
[ScorerID] int
[Score] int
[DateCreated] smalldatetime 
```

如果存在今天日期的记录（只应检查日期部分，而不是时间）和给定的得分手，我想更新这个人和这一天的得分值。如果得分手没有今天的记录，我想创造一个新的记录。

我正试图弄清楚如何将其放入单个（这可能吗？）sql语句中。顺便说一句，我使用的是 MSSQl 数据库和`ExecuteNonQuery()`发出查询的方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-04T12:12:45.283

```
IF EXISTS (SELECT NULL FROM MyTable WHERE ScorerID = @Blah AND CONVERT(VARCHAR, DateCreated, 101) = CONVERT(VARCHAR, GETDATE(), 101))
    UPDATE MyTable SET blah blah blah
ELSE
    INSERT INTO MyTable blah blah blah 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T14:11:01.223

其他人已经介绍了 2005（和之前）兼容的 T-SQL/方法。我只想补充一点，如果您有幸使用 SQL Server 2008，您可以利用新的 Merge（有时称为 Upsert）语句。

我很难找到进一步解释它的博客条目或文章，但我确实发现这个[(1) 很有帮助的条目](http://www.sqlservercurry.com/2008/05/sql-server-2008-merge-statement.html)。官方 MSDN 条目是[(2) 这里。](http://msdn.microsoft.com/en-us/library/bb510625.aspx)

(1) [ [http://www.sqlservercurry.com/2008/05/sql-server-2008-merge-statement.html]](http://www.sqlservercurry.com/2008/05/sql-server-2008-merge-statement.html])
(2) [ [http://msdn.microsoft.com/en-us/library/ bb510625.aspx]](http://msdn.microsoft.com/en-us/library/bb510625.aspx])

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T12:17:38.720

```
CREATE PROCEDURE InsertOrUpdateScorer(@ScorerID INT, @Score INT)
AS
BEGIN
  IF EXISTS (
    SELECT 1 
    FROM Scorer 
    WHERE ScorerID = @ScorerID AND DATEDIFF(dd, GETDATE(), DateCreated) = 0
  )
  BEGIN
    UPDATE
      Scorer
    SET 
      Score = @Score
    WHERE
      ScorerID = @ScorerID

    RETURN @ScorerID
  END
  ELSE
  BEGIN
    INSERT 
      Scorer 
      (ScorerID, Score, DateCreated)
    VALUES
      (@ScorerID, @Score, GETDATE())

    RETURN SCOPE_IDENTITY()
  END
END 
```

使用过程的返回值来获取新的 ScorerId。

```
SqlCommand UpdateScorer = New SqlCommand("InsertOrUpdateScorer", DbConn);
UpdateScorer.CommandType = CommandType.StoredProcedure;

SqlParameter RetValue = UpdateScorer.Parameters.Add("RetValue", SqlDbType.Int);
RetValue.Direction = ParameterDirection.ReturnValue;

SqlParameter Score = UpdateScorer.Parameters.Add("@Score", SqlDbType.Int);
Score.Direction = ParameterDirection.Input;

SqlParameter ScorerId = UpdateScorer.Parameters.Add("@ScorerID", SqlDbType.Int);
ScorerId.Direction = ParameterDirection.Input;

Score.Value = 15;    // whatever
ScorerId.Value = 15; // whatever

UpdateScorer.ExecuteNonQuery();
Console.WriteLine(RetValue.Value); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-20T09:52:55.300

对于需要一次更新或插入所有值的情况，不仅仅是一条记录，我使用了这个片段

第一次运行更新脚本

```
更新表1
设置 OPIS = T1.OPIS
从
    表 1 AS T
内部联接
    表2 AS T1
    在
        T.col = T1.col；

```

然后执行插入脚本

```
插入表 1
选择 * 从
    (
        选择 T1.* 表 2 作为 T1
        LEFT JOIN Table1 AS T2 ON (T2.col = T1.col)
        T2.col 为空
    ) 作为 T;

```

希望有人发现这很有用。

MySql 中的 this 等价物（在某些情况下）是这样的：

```
插入表 (a,b,c) 值 (1,2,3)
  重复密钥更新 c=c+1;

```

有人可以发现这与[SQL Server 上的 INSERT OR UPDATE 解决方案中的文章有关](https://stackoverflow.com/questions/108403/solutions-for-insert-or-update-on-sql-server)

[使用MERGE (Transact-SQL) 的](http://msdn.microsoft.com/en-us/library/bb510625.aspx)更新版本：

```
DECLARE @USER_ID AS INT=76;
DECLARE @TYPE AS NVARCHAR(MAX)='set.global';
DECLARE @FKEY AS NVARCHAR(MAX)='21';
DECLARE @DATA AS NVARCHAR(MAX)='test';

        begin tran
            MERGE UserData
            USING (SELECT @USER_ID, @TYPE, @FKEY, @DATA) AS Source([UserId], [Type], [FKey], [Data])
            ON (UserData.[UserId] = Source.[UserId] AND UserData.[Type] = Source.[Type] AND (UserData.[FKey] = Source.[FKey] OR (Source.[FKey] IS NULL AND UserData.[FKey] IS NULL)))
            WHEN MATCHED
            THEN
                UPDATE SET [Data] = Source.[Data]
            WHEN NOT MATCHED BY TARGET THEN
                INSERT 
                           ([UserId]
                           ,[Type]
                           ,[FKey]
                           ,[Data])
                     VALUES
                           ( Source.[UserId]
                           ,Source.[Type]
                           ,Source.[FKey]
                           ,Source.[Data]);

        commit tran 
```

# visual-studio - 在 VS 2005 中自动跟踪内部版本号？

> ID：340368
> 
> 赞同：1
> 
> 时间：2008-12-04T12:06:47.293
> 
> 标签：visual-studio, build-process, versioning

在 Visual Studio 2005 中，是否有一种简单的方法可以在成功构建后自动增加程序集/文件的内部版本号？

强调***容易***。我想跟踪我的构建版本，而不必设置 CruiseControl 或一些类似的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T12:19:03.383

您可以使用此项目并将其包含在您的 .proj 文件中

这个 url 可能有用[更新 Porj 内部版本号](http://geekswithblogs.net/narent/archive/2006/02/15/69532.aspx)

这不符合我的需求，我开始将其添加为 build.proj，它可以作为一种享受

```
<?xml version="1.0" encoding="utf-8"?> <Project DefaultTargets="Build"  
         xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/> <PropertyGroup>
    <Major>1</Major>
    <Minor>0</Minor>
    <Build>0</Build>
    <Revision>0</Revision>   </PropertyGroup>   <PropertyGroup>
    <BuildDir>C:\svn\Infrastructure</BuildDir> </PropertyGroup>

  <ItemGroup>
    <SolutionsToBuild Include="Infrastructure.sln"/>   </ItemGroup>

  <Target Name="Build" DependsOnTargets="ChangeDataAccessAssemblyInfo">
    <RemoveDir Directories="$(BuildDir)\Builds" Condition="Exists('$(BuildDir)\Builds')" />
    <MSBuild Projects="@(SolutionsToBuild)" Properties="Configuration=Debug" Targets="Rebuild" />   </Target>

  <ItemGroup>
    <TestAssemblies Include="Build\Logging\Logging.UnitTests.dll" />   </ItemGroup>

  <Target Name="ChangeDataAccessAssemblyInfo" >
    <Message Text="Writing ChangeDataAccessAssemblyInfo file for 1"/>
    <Message Text="Will update $(BuildDir)\DataAccess\My Project\AssemblyInfo.vb" />
    <AssemblyInfo CodeLanguage="VB"
       OutputFile="$(BuildDir)\DataAccess\My Project\AssemblyInfo_new.vb"          

       AssemblyTitle="Data Access Layer"
       AssemblyDescription="Message1"
       AssemblyCompany="http://somewebiste"
       AssemblyProduct="the project"
       AssemblyCopyright="Copyright notice"
       ComVisible="true"
       CLSCompliant="true"
       Guid="hjhjhkoi-9898989"
       AssemblyVersion="$(Major).$(Minor).1.1"
       AssemblyFileVersion="$(Major).$(Minor).5.7"
       Condition="$(Revision) != '0' "
       ContinueOnError="false" />

    <Message Text="Updated Assembly File Info" 
             ContinueOnError="false"/>   </Target>   </Project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T12:21:47.933

发布选项可能是您想要的...（定义可用于 C#，不确定 Abuut C++）。

在工作室中，右键单击项目文件，然后转到“属性”，然后选择“发布”选项卡。那里有一个自动递增修订号的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T12:17:17.350

编写一个增加版本的小宏怎么样？

或者这个 VS [AddIn](http://yogesh.jagotagroup.com/blog/page/Solution-level-Auto-build-increment-Add-In.aspx)怎么样？

# math - 我可以计算这些数字的平均值吗？

> ID：340376
> 
> 赞同：7
> 
> 时间：2008-12-04T12:08:37.943
> 
> 标签：math, average

我想知道如果我有这个，是否可以计算一些数字的平均值：

```
int currentCount = 12;
float currentScore = 6.1123   (this is a range of 1 <-> 10). 
```

现在，如果我收到另一个分数（比如说 4.5），我可以重新计算平均值，这样它会是这样的：

```
int currentCount now equals 13
float currentScore now equals ????? 
```

或者这是不可能的，我仍然需要记住分数列表？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-04T12:14:59.443

以下公式允许您根据您的要求仅从存储的平均值和计数中跟踪平均值。

```
currentScore = (currentScore * currentCount + newValue) / (currentCount + 1)
currentCount = currentCount + 1 
```

这取决于您的平均值当前是您的总和除以计数的事实。因此，您只需将计数乘以平均值即可得到总和，将新值相加并除以 (count+1)，然后增加计数。

所以，假设你有数据`{7,9,11,1,12}`，你唯一要保留的是平均值和计数。随着每个数字的添加，您会得到：

```
+--------+-------+----------------------+----------------------+
| Number | Count |   Actual average     | Calculated average   |
+--------+-------+----------------------+----------------------+
|      7 |     1 | (7)/1           =  7 | (0 * 0 +  7) / 1 = 7 |
|      9 |     2 | (7+9)/2         =  8 | (7 * 1 +  9) / 2 = 8 |
|     11 |     3 | (7+9+11)/3      =  9 | (8 * 2 + 11) / 3 = 9 |
|      1 |     4 | (7+9+11+1)/4    =  7 | (9 * 3 +  1) / 4 = 7 |
|     12 |     5 | (7+9+11+1+12)/5 =  8 | (7 * 4 + 12) / 5 = 8 |
+--------+-------+----------------------+----------------------+ 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-04T12:13:41.427

我喜欢存储总和和计数。它避免了每次额外的乘法。

```
current_sum += input;
current_count++;
current_average = current_sum/current_count; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T12:15:48.710

当您查看平均值的公式时，这真的很容易：`A1 + A2 + ... + AN/N`. 现在，如果您有旧平均值和 N（数字计数），您可以轻松计算新平均值：

```
newScore = (currentScore * currentCount + someNewValue)/(currentCount + 1) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T12:14:14.047

您可以存储 currentCount 和 sumScore 并计算 sumScore/currentCount。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T12:45:34.890

或者......如果你想傻，你可以在一行中做到：

```
 current_average = (current_sum = current_sum + newValue) / ++current_count; 
```

:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T12:15:09.163

浮动 currentScore 现在等于 (currentScore * (currentCount-1) + 4.5)/currentCount ？

# java - .net/java 程序员必备的时事通讯订阅有哪些？

> ID：340381
> 
> 赞同：5
> 
> 时间：2008-12-04T12:11:10.153
> 
> 标签：java, .net, newsletter

我认为有几篇时事通讯的内容非常好。

编辑：如[http://www.javaspecialists.eu/archive/archive.jsp](http://www.javaspecialists.eu/archive/archive.jsp)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T12:28:46.513

老实说，我从来没有读过我订阅过的时事通讯，它们把我的收件箱弄得乱七八糟。我已经被与工作相关的电子邮件淹没了！

当我准备好时，我更喜欢使用我的 RSS 阅读器拉取在时事通讯（无广告）中找到的那种信息，而不是在我没有准备好时将其推送给我。

只是我的两分钱！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T12:14:59.693

在公然的自我推销中，我推荐我的 Java 技巧[http://solidsimplesafe.com/](http://solidsimplesafe.com/)。您可以通过时事通讯或 RSS 订阅。

我最近被另一个项目分心了。但是我有很多新材料等着被塑造和添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T13:30:27.543

对于 .NET，我会订阅 Scott Guthrie 的 [博客，](http://weblogs.asp.net/scottgu/)

特别是如果它的 ASP.NET！

# javascript - JavaScript 对象可以有一个原型链，但也可以是一个函数吗？

> ID：340383
> 
> 赞同：20
> 
> 时间：2008-12-04T12:12:37.873
> 
> 标签：javascript, inheritance

```
function a () {
    return "foo";
}

a.b = function () {
    return "bar";
}

function c () { };
c.prototype = a;

var d = new c();
d.b(); // returns "bar"
d(); // throws exception, d is not a function 
```

有没有办法`d`成为一个函数，但仍然从 继承属性`a`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-06T19:46:07.173

实际上，事实证明这**是可能的**，尽管是以**非标准**方式。

Mozilla、Webkit、Blink/V8、Rhino 和 ActionScript 提供了一个非标准**`__proto__`**属性，允许在对象创建后更改其原型。在这些平台上，可以使用以下代码：

```
function a () {
    return "foo";
}

a.b = function () {
    return "bar";
}

function c () {
    return "hatstand";
}
c.__proto__ = a;

c(); // returns "hatstand"
c.b(); // returns "bar"; inherited from a 
```

这可能对不需要担心跨平台兼容性的人有用。

但是请注意，只能继承对象的**属性**。例如：

```
var d = {};
d.__proto__ = a;
d.b(); // returns "bar"
d(); // throws exception -- the fact that d is inheriting from a function
     // doesn't make d itself a function. 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T14:53:19.390

简短的回答：不可能。

这行代码：

```
var d = new c(); 
```

自动假定这`d`是一个对象。除非`c`是内置对象的构造函数，例如`Function`. 但是如果`c`已经被语言定义了，你就不能操纵它的原型，也不能从你喜欢的任何东西“继承”它。好吧，在某些解释器中你可以，但你不能在所有解释器中安全地做到这一点——标准说：“你不要弄乱标准对象，否则解释器会打你！”。

内置对象是“唯一的”，JavaScript 不提供复制它们的方法。如果不使用不兼容的诡计，就不可能重新创建字符串、数字、函数等。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-09-05T21:43:11.427

基于关于[meta](https://meta.stackoverflow.com/questions/356167/why-was-this-edit-rejected-with-a-seeming-unrelated-generic-response/356168?noredirect=1#comment511249_356168) [关于类似问题](https://stackoverflow.com/questions/37625164/object-createfunction-prototype-create-function-which-inherits-properties)的讨论，我根据[@alexander-mills](https://stackoverflow.com/users/1223975/alexander-mills) original在此处发布此答案

* * *

# 这现在可以以符合标准的方式完成

首先创建一个继承的对象`Function`

```
const obj = Object.create(Function.prototype);  // Ensures availability of call, apply ext 
```

然后将您的自定义方法和属性添加到`obj`

接下来声明函数

```
const f = function(){
    // Hello, World!
}; 
```

并设置`obj`为原型`f`

```
Object.setPrototypeOf(f,obj); 
```

# 示范

```
const obj = Object.create(Function.prototype);

// Define an 'answer' method on 'obj'
obj.answer = function() {
  // Call this object
  this.call(); // Logs 'Hello, World'
  console.log('The ultimate answer is 42');
}

const f = function() {
  // Standard example
  console.log('Hello, World');
};

Object.setPrototypeOf(f, obj);

// 'f' is now an object with an 'answer' method
f.answer();
// But is still a callable function
f();
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-11T05:24:56.437

是的，如果您使用`__proto__`Daniel Cassidy 提到的财产，这是可能的。诀窍是`c`实际返回一个`a`附加到其原型链的函数。

```
function a () {
    return "foo";
}

a.b = function () {
    return "bar";
}

function c () {
    var func = function() {
        return "I am a function";
    };
    func.__proto__ = a;
    return func;
}
c.prototype = a;

var d = new c();
d.b(); // returns "bar"
d(); // returns "I am a function" 
```

但是，如果您想`instanceof`返回更好的结果，则需要对原型链进行更多调整。

```
d instanceof c // true
d instanceof a // false
c instanceof a // false 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T15:45:32.500

它实际上必须是原型链吗？您可以使用 mixin 模式来使函数具有 a 的所有属性。如果你真的想要的话，你甚至可以用一个很好的“新”语法包装它来伪造它。

```
function a () {
    return "foo";
}

a.b = function () {
    return "bar";
}

function c () {
    var f = function(){
        return a();
    };

    //mixin all properties on a
    for(var prop in a){
        f[prop] = a[prop];
    }

    return f; //just returns the function instead of "this"
};

var d = new c(); //doesn't need the new keyword, but just for fun it still works

alert(d()); //show "foo"

alert(d.b()); //shows "bar" 
```

您可以在不影响 a 的情况下向 d 添加属性。这与您想要的唯一区别是对 a 的更改不会影响 c 的现有“实例”。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-01-29T21:01:39.050

这是我一段时间以来一直在尝试做的事情。特别感谢以上作者的投入。

这是使用“可调用对象”的链式实现：

```
var $omnifarious = (function(Schema){

    var fn = function f(){
        console.log('ran f!!!');
        return f;
    };

    Schema.prototype = {
        w: function(w){ console.log('w'); return this; },
        x: function(x){ console.log('x'); return this; },
        y: function(y){ console.log('y'); return this; }
    };
    fn.__proto__ = (new Schema()).__proto__;

    return fn;
})(function schema(){ console.log('created new schema', this); });

console.log(
    $omnifarious()().w().x().y()()()
); 
```

此外，通过这种“模式”方法，可以`interface`使用`Object.freeze()`on或对象创建可重用`Schema`的对象。这可能看起来像这样：-- 这不是一个实际的例子，可能需要更多。也就是说，这是一个不同的讨论。试试看，让我知道！`prototype``__proto__``fn.__proto__ = Object.freeze(new Schema().__proto__)`

希望这会有所帮助。

# excel - 将包含换行符的文本文件导入excel

> ID：340400
> 
> 赞同：4
> 
> 时间：2008-12-04T12:17:34.993
> 
> 标签：excel, vba

我有一个如下所示的纯文本文件：

```
"some  
 text  
 containing  
 line  
 breaks" 
```

我正在尝试`excel 2004 (Mac, v.11.5)`正确打开此文件。我希望只看到一个包含上述所有内容的单元格（A1）（不带引号）......

但唉，我做不到，因为 Excel 似乎坚持使用 CR 作为行分隔符，即使我将文本限定符设置为双引号。我有点希望 Excel 能够理解这些换行符是值的一部分——它们嵌入在双引号中，这应该使它们成为值的一部分。所以我的 Excel 表有 5 行，这不是我想要的。

我也试过这个Applescript无济于事：

```
tell application "Microsoft Excel"
    activate
    open text file filename ¬
    "Users:maximiliantyrtania:Desktop:linebreaks" data type delimited ¬
    text qualifier text qualifier double quote ¬
    field info {{1, text format}} ¬
    origin Macintosh with tab
end tell 
```

如果我可以告诉 Excel 使用除 CR（或 LF）以外的行分隔符，那么我会是一个快乐的露营者，但 excel 似乎只允许更改字段分隔符，而不是行分隔符。

任何指针？

谢谢，

Max Excel 打开

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T13:31:47.247

看起来我只是自己找到了解决方案。我需要将初始文件保存为“.csv”。Excel 使用 CSV 文件正确处理换行符。通过 applescript 打开它们也可以。

再次感谢回复的人。

最大限度

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T12:45:28.570

另一种选择是创建一个宏来处理开口。打开文件进行输入，然后使用 Range 对象将文本读入工作表，根据需要进行解析。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-03T09:56:42.270

如果您的文件包含由列表分隔符分隔的列（逗号，但某些非英语区域设置的分号），请将其重命名为 .csv 并在 Excel 中打开它。如果您的文件包含由 TAB 分隔的列，请将其重命名为 .tab 并在 Excel 中打开它。导入（而不是打开）csv 或 tab 文件似乎无法理解文本分隔符之间的换行符。:-(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T12:34:16.893

只是一个文件吗？如果是这样，请不要导入它。只需将文本文件的内容复制粘贴到第一个单元格中（按 f2，然后粘贴）。

如果您绝对必须编写此脚本，Excel 实际上只使用这两个字符（cr、lf）中的一个作为行分隔符，但我不确定是哪个。尝试首先使用外部 util 去除 lf（留下 cr），然后导入它......如果这不起作用，去除 cr（留下 lf）然后导入它。

# nhibernate - 来自多个表的 NHibernate 映射

> ID：340403
> 
> 赞同：3
> 
> 时间：2008-12-04T12:18:57.860
> 
> 标签：nhibernate

考虑下面的表结构......

```
Appointment
-----------
ID integer
Description nvarchar
StatusID smallint

Status
------
ID smallint
DisplayText nvarchar 
```

现在，无论好坏，我们希望这种情况映射到一个看起来像这样的类

```
class Appointment
{  
    public int ID {g;s;}
    public string Description { g;s; }
    public string Status { g; private s; }
} 
```

即我们想将规范化的状态显示文本直接拉到实体中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T12:19:52.930

显而易见的答案是创建一个 Status 实体并使约会类具有对其的引用并以正常方式对其进行映射。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T02:59:40.283

不要创建实体类。[使用枚举和 EnumStringType，如此处](http://codebetter.com/blogs/jeffrey.palermo/archive/2006/03/14/140949.aspx)所示。我想这正是你想要的。

# silverlight - Silverlight Control 无法正常工作

> ID：340412
> 
> 赞同：3
> 
> 时间：2008-12-04T12:20:38.917
> 
> 标签：silverlight, controls

我有这个问题，我有一个带有滚动条的小菜单..里面有几个带有复选框的项目..在遍历这些复选框时，我得到一个空错误。似乎这是由于复选框不属于菜单thingy的可见空间..就像Silverlight一样，只有在您向下滚动时才会启动复选框，所以它是可见的..

任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T08:56:42.930

遍历复选框时，请尝试添加检查以查看您是否实际上正在处理复选框而不是元素树中的其他内容。

```
Loop thru children
  if(child is CheckBox){ 
  // Do what you want with the checkbox
  } 
```

# c++ - How do C/C++ compilers handle type casting between types with different value ranges?

> ID：340413
> 
> 赞同：13
> 
> 时间：2008-12-04T12:20:44.470
> 
> 标签：c++, c, types, casting, compiler-construction

How do type casting happen without loss of data inside the compiler?

For example:

```
 int i = 10;
 UINT k = (UINT) k;

 float fl = 10.123;
 UINT  ufl = (UINT) fl; // data loss here?

 char *p = "Stackoverflow Rocks";
 unsigned char *up = (unsigned char *) p; 
```

How does the compiler handle this type of typecasting? A low-level example showing the bits would be highly appreciated.

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-04T17:01:20.770

Well, first note that a cast is an *explicit request to convert a value of one type to a value of another type*. A cast will also always produce a new object, which is a temporary returned by the cast operator. Casting to a reference type, however, will not create a new object. The object referenced by the value is reinterpreted as a reference of a different type.

Now to your question. Note that there are two major types of conversions:

*   *Promotions*: This type can be thought of casting from a possibly more narrow type to a wider type. Casting from char to int, short to int, float to double are all promotions.
*   *Conversions*: These allow casting from long to int, int to unsigned int and so forth. They can in principle cause loss of information. There are rules for what happens if you assign a `-1` to an unsigned typed object for example. In some cases, a wrong conversion can result in undefined behavior. If you assign a double larger than what a float can store to a float, the behavior is not defined.

Let's look at your casts:

```
int i = 10; 
unsigned int k = (unsigned int) i; // :1

float fl = 10.123;
unsigned int  ufl = (unsigned int) fl; // :2

char *p = "Stackoverflow Rocks"; 
unsigned char *up = (unsigned char *) p; // :3 
```

1.  This cast causes a conversion to happen. No loss of data happens, since 10 is guaranteed to be stored by an `unsigned int`. If the integer were negative, the value would basically wrap around the maximal value of an unsigned int (see **4.7/2**).
2.  The value `10.123` is truncated to 10\. Here, it *does* cause lost of information, obviously. As 10 fits into an unsigned int, the behavior is defined.
3.  This actually requires more attention. First, there is a deprecated conversion from a string literal to `char*`. But let's ignore that here. (see [here](https://stackoverflow.com/questions/308279/c-vs#308724)). More importantly, what does happen if you cast to an unsigned type? Actually, the result of that is unspecified per **5.2.10/7** (note the semantics of that cast is the same as using reinterpret_cast in this case, since that is the only C++ cast being able to do that):

> A pointer to an object can be explicitly converted to a pointer to an object of different type. Except that converting an rvalue of type “pointer to T1” to the type "pointer to T2" (where T1 and T2 are object types and where the alignment requirements of T2 are no stricter than those of T1) and back to its original type yields the original pointer value, the result of such a pointer conversion is unspecified.

So you are only safe to use the pointer after you cast back to `char *` again.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T12:44:32.207

The two C-style casts in your example are different kinds of cast. In C++, you'd normally write them

```
unsigned int uf1 = static_cast<unsigned int>(fl); 
```

and

```
unsigned char* up = reinterpret_cast<unsigned char*>(p); 
```

The first performs an arithmetic cast, which truncates the floating point number, so there is data loss.

The second makes no changes to data - it just instructs the compiler to treat the pointer as a different type. Care needs to be taken with this kind of cast: it can be very dangerous.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-04T12:31:15.013

"Type" in C and C++ is a property assigned to variables when they're handled in the compiler. The property doesn't exist at runtime anymore, except for virtual functions/RTTI in C++.

The compiler uses the type of variables to determine a lot of things. For instance, in the assignment of a float to an int, it will know that it needs to convert. Both types are probably 32 bits, but with different meanings. It's likely that the CPU has an instruction, but otherwise the compiler would know to call a conversion function. I.e. `& __stack[4] = float_to_int_bits(& __stack[0])`

The conversion from char* to unsigned char* is even simpeler. That is just a different label. At bit level, p and up are identical. The compiler just needs to remember that *p requires sign-extension while *up does not.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T17:45:17.140

Casts mean different things depending on what they are. They can just be renamings of a data type, with no change in the bits represented (most casts between integral types and pointers are like this), or conversions that don't even preserve length (such as between double and int on most compilers). In many cases, the meaning of a cast is simply unspecified, meaning the compiler has to do something reasonable but doesn't have to document exactly what.

A cast doesn't even need to result in a usable value. Something like `char * cp; float * fp; cp = malloc(100); fp = (float *)(cp + 1);` will almost certainly result in a misaligned pointer to float, which will crash the program on some systems if the program attempts to use it.

# javascript - 如何在页面加载时？

> ID：340415
> 
> 赞同：0
> 
> 时间：2008-12-04T12:21:11.600
> 
> 标签：javascript, jsp, html-select

我有一个`JSP`页面，其中包含`HTML` `<select>`从数据库加载的所有国家/地区。例如，在“创建用户”中，所有国家/地区值都加载到选择菜单中，我选择了 5 个国家/地区。这 5 个值被加载到该特定用户的数据库中。

现在，当我再次单击该用户 ID 的“修改用户”时，将出现一个选择菜单，所有国家/地区都将加载到选择菜单中，但应突出显示/选择这 5 个国家/地区。

我如何使用 来完成此操作`javascript`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T13:01:23.017

我不确定我是否正确理解了这个问题，但这里有一个多选列表：

```
<select multiple="multiple">
  <option value ="UK">UK</option>
  <option value ="France" selected="selected">France</option>
  <option value ="Germany">Germany</option>
  <option value ="Italy" selected="selected">Italy</option>
</select> 
```

据我了解，不需要javascript。如果要使用 AJAX 动态更新列表，则需要将 selected 属性添加到需要突出显示的项目中。您可以使用 javascript 库轻松做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T13:02:01.657

`javascript`可能不是最好的答案，尽管这样肯定是可行的。

在`JSP`页面中，我假设您有一个填充`HTML` `<select>`选项的循环。在该循环中，进行测试以查看是否为用户选择了当前值。如果是这样，请为该国家/地区添加一个`selected="selected"`属性/值对`<option>`。

如果您真的想在 中执行此操作`javascript`，则适用相同的逻辑：循环遍历 的`option`元素`select`，并将适当的元素设置`selected`为 true。

作为替代方案，您可以让您`JSP`生成适当的`javascript`行以仅设置那些`options`被选中的行，从而在页面加载时保存遍历所有国家/地区的循环。

通过事件调用 javascript 函数，`page load`以便在显示页面时进行选择。

# sql-server - ADO.NET 检查是否可以回滚

> ID：340425
> 
> 赞同：2
> 
> 时间：2008-12-04T12:24:52.840
> 
> 标签：sql-server, ado.net, transactions, rollback

我问自己是否可以在 ADO.NET 中检查当前事务是否可以回滚。

msdn 建议以下实现：

```
private static void ExecuteSqlTransaction(string connectionString)
{
    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();

        SqlCommand command = connection.CreateCommand();
        SqlTransaction transaction;

        // Start a local transaction.
        transaction = connection.BeginTransaction("SampleTransaction");

        // Must assign both transaction object and connection
        // to Command object for a pending local transaction
        command.Connection = connection;
        command.Transaction = transaction;

        try
        {
            command.CommandText =
                "Insert into Region (RegionID, RegionDescription) VALUES (100, 'Description')";
            command.ExecuteNonQuery();
            command.CommandText =
                "Insert into Region (RegionID, RegionDescription) VALUES (101, 'Description')";
            command.ExecuteNonQuery();

            // Attempt to commit the transaction.
            transaction.Commit();
            Console.WriteLine("Both records are written to database.");
        }
        catch (Exception ex)
        {
            Console.WriteLine("Commit Exception Type: {0}", ex.GetType());
            Console.WriteLine("  Message: {0}", ex.Message);

            // Attempt to roll back the transaction.
            try
            {
                transaction.Rollback();
            }
            catch (Exception ex2)
            {
                // This catch block will handle any errors that may have occurred
                // on the server that would cause the rollback to fail, such as
                // a closed connection.
                Console.WriteLine("Rollback Exception Type: {0}", ex2.GetType());
                Console.WriteLine("  Message: {0}", ex2.Message);
            }
        }
    }
} 
```

另外还有一点需要注意：回滚事务时应始终使用 Try/Catch 异常处理。如果连接终止或事务已在服务器上回滚，则回滚会生成 InvalidOperationException。

但我真的不敢相信 try/catch 是检查是否可以回滚的推荐解决方案。

我知道在 SQL Server 实现中，如果事务是“僵尸”，则 SQLTransaction 对象在 Connection 属性上返回 null。

但这是非常具体的实现，它只适用于 SQL Server。

那么是否有一种独立于数据库的方法来检测事务是否可以回滚？

蒂亚·马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T13:09:22.720

[许多这种复杂性是通过在“使用”语句中使用 TransactionScope 对象来处理的——在MSDN](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)上查看它。需要注意的是，当需要时，TransactionScope 会自动“扩展”以使用分布式事务 - 有时这是可取的，有时则不是，因此如果嵌套 TransactionScope，请小心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T10:49:07.713

问题是在非 SQL 2005 中，事务范围被提升为分布式事务，这是相当大的开销。

# forms - 是否可以将 VBA 表单作为 .exe 文件运行

> ID：340428
> 
> 赞同：4
> 
> 时间：2008-12-04T12:25:40.030
> 
> 标签：forms, vba

是否可以将 VBA 中的表单保存为 .exe 文件然后运行它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T12:56:45.240

不，不是本地人。

有一些方法可以模拟 EXE：

*   **Excel**：声称能够将工作簿编译为 EXE 的第 3 方工具：[DoneEx XCell Compiler](http://www.soft14.com/Business_and_Finance/Spreadsheets/DoneEx_XCell_Compiler_11134_Review.html)。您还可以创建一个自动宏 Auto_Open，以便在打开工作簿时运行。
*   **Access**：Microsoft 曾经有一种方法可以将 Access 数据库作为可执行文件提供（工具的名称让我无法理解），因此您可以将数据库部署到未安装 Access 的桌面上，但我认为他们不提供此功能了。您可以将 MDB 转换为 MDE 并设置启动属性以隐藏数据库窗口和菜单等以模拟 EXE，但您的用户将需要安装 Access。
*   **Word**：您可以`/m`在启动时使用要运行的宏的名称将开关传递给 Word。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T12:39:59.097

我认为至少有两种方式

将代码移动到 Visual Basic 6 并编译它或使用[Visual Studio Tool for Office](http://msdn.microsoft.com/en-us/office/aa905533.aspx)看看你能做什么。

如果这 2 个解决方案对您来说是不行的，那么您就不走运了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T12:35:39.713

不。VBA 是应用程序的一个插件，以支持 VB 形式的“脚本”。因此，除非您的应用程序支持将内部脚本另存为外部 EXE 的方法，否则您将不走运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-03T21:26:39.110

我认为 DoneEx 仍然需要安装 Excel，它只是将某些内容引导到 xls 文件，或者将其引导到某些内容并将其包装为 exe ???/..

正如我认为的那样。 [http://cpap.com.br/orlando/XLtoExeMore.asp](http://cpap.com.br/orlando/XLtoExeMore.asp)

但至少第二个是免费的！

我没有在没有办公室的个人电脑上测试过。

你想要完成什么可能有另一种方法？

谢谢罗斯

# sql-server - SQL Server 链接服务器

> ID：340431
> 
> 赞同：1
> 
> 时间：2008-12-04T12:27:05.737
> 
> 标签：sql-server

我想使用 sp_addlinkedserver 过程在一个 sql server 中创建一个链接服务器到另一个。当我访问远程服务器时，我希望它以我的身份登录（即使用我的 Windows 帐户）。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T12:34:46.067

您可以使用 sp_addlinkedsrvlogin 过程执行此操作：

```
EXEC master.dbo.sp_addlinkedsrvlogin 
      @rmtsrvname=N'<your linked server name>',
      @useself=N'True',
      @locallogin=NULL,
      @rmtuser=NULL,
      @rmtpassword=NULL 
```

这假设您使用 Windows 身份验证登录到创建链接的服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T18:40:38.213

继上面的 Ed Harper 之后：

您需要为 SQL 服务帐户设置“[安全帐户委托](http://msdn.microsoft.com/en-us/library/ms189580(SQL.90).aspx)”以使其能够通过您的登录令牌。

编辑：

这不是 SQL 问题。委派/通过身份验证是 Windows/AD 功能。

它还用于使 Intranet 网站能够使用最终用户 Windows 登录来验证 SQL 框，其中（当然）Web 服务器是一个单独的框。在这种情况下，您为委派配置 Web 服务器。

在 OP 的场景中，我们启用第一个 SQL 框将凭据委托给第二个框。

编辑2：

另一个线程也解释了这一点。

最后，与 SQL 登录无关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T18:09:23.097

这可能会令人抓狂。检查这个相关问题：

[https://stackoverflow.com/questions/33153/sql-server-to-sql-server-linked-server-setup](https://stackoverflow.com/questions/33153/sql-server-to-sql-server-linked-server-setup)

不幸的是，使用 2K3 域上的 Sql Server 2005，设置链接服务器的最安全方法可能是使用老式的 Sql Login。您必须对域安全设置进行很多我认为有风险的更改，才能使其与域帐户一起使用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-04T12:33:29.627

使用 SQL Management Studio 查看链接服务器的属性。在那里您将找到您的登录信息

# c++ - 函数声明中缺少“虚拟”限定符

> ID：340437
> 
> 赞同：4
> 
> 时间：2008-12-04T12:30:23.437
> 
> 标签：c++, inheritance, virtual

在浏览一些旧代码时，我遇到了类似于以下内容的内容：

```
class Base
{
public:
    virtual int Func();
    ...
};

class Derived : public Base
{
public:
    int Func(); // Missing 'virtual' qualifier
    ...
}; 
```

代码编译良好（MS VS2008），没有警告（级别 4），它按预期工作 -`Func`即使派生类中缺少虚拟限定符，它也是虚拟的。现在，除了引起一些混乱之外，这段代码是否有任何危险，或者我应该全部更改，添加`virtual`限定符？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T12:33:51.137

这`virtual`将被传递到派生类中的所有重写函数。添加关键字的唯一真正好处是表明您的意图，派生类定义的偶然观察者会立即知道这`Func`是虚拟的。

即使是扩展 Derived 的类也将具有虚拟 Func 方法。

参考： MSDN 上的[虚拟功能](http://msdn.microsoft.com/en-us/library/0y01k918.aspx)。向下滚动页面查看

> 在派生类中声明重写函数时可以使用**virtual关键字，但不是必需的；**虚函数的覆盖总是虚函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T12:49:29.250

这是不需要将覆盖函数声明为虚拟的有趣结果：

```
template <typename Base>
struct Derived : Base
{
    void f();
}; 
```

Derived 的 f 是否为虚函数取决于 Derived 是否使用具有正确签名的虚函数 f 的 Base 实例化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T12:37:00.040

曾经有人告诉我，非常旧的 C++ 编译器不符合规范，需要为所有子类设置 virtual。这不再是问题了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T02:09:50.330

遵循这种做法的一个危险是，人们可能没有意识到他们需要虚拟函数的 virtual 关键字。这很可能是来自没有非虚拟函数概念的语言（例如：Java、REALbasic）的人。作为推论，您无法判断何时故意省略了 virtual ，因为函数应该是非虚拟的。

我怀疑一些代码分析工具也可能不够聪明，无法识别继承的虚拟性。

# nhibernate - 使用 NHibernate 对象进行依赖注入

> ID：340461
> 
> 赞同：8
> 
> 时间：2008-12-04T12:41:34.040
> 
> 标签：nhibernate, dependency-injection

我想知道如何告诉 NHibernate 解决对我的 POCO 域对象的依赖关系。

我发现CalculateOrderTax 之类的方法应该在Domain 对象中，因为它们对特定于域的业务规则进行编码。但是一旦我有两个，我就违反了 SRP。

将这些方法提取到 Strategy 类中没有问题，但我想知道如何让 NHibernate 加载这些方法。

在将对象移交给更高层之前，循环遍历存储库中的对象列表以执行基于 get/set 的依赖注入似乎不是一个好的解决方案。

我现在也在使用 Castle Windsor 进行依赖注入。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T15:36:04.343

我一直在使用拦截器来完成类似的任务：

修改加载实体的拦截器：

```
public class MyInterceptor : EmptyInterceptor
{
    public override bool OnLoad(object entity, object id, object[] state, string[] propertyNames, IType[] types)
    {
        return InjectDependencies(entity as MyEntity);
    }
} 
```

将其与会话关联：

```
nhSessionFactory.OpenSession(myInterceptor); 
```

我还在某处读到，在即将发布的 2.1 版本中会更好地支持自定义构造函数注入，但我现在似乎找不到参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T14:29:14.993

由于目前似乎没有人能够回答您的问题，我想我建议您重组您的代码，以消除订单计算自己的税款的需要。

您可以将它委托给 OrderTaxService，它接受一个 Order 对象并返回一个 OrderValue 对象或类似的东西。

这会将逻辑保留在您的域中，但无需将其附加到您的 Order 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T17:49:23.887

我同意 Garry 的观点，即您应该尽可能地从域对象中删除服务依赖项。有时它是有意义的，例如加密/解密。在这种情况下，您可以使用拦截或 IUserType 将其隐藏在基础架构中。我认为后者在您可以使用时是有利的。 [本文](http://ayende.com/Blog/archive/2008/07/31/Entities-dependencies-best-practices.aspx)详细介绍了如何做到这一点。我正在这样做，它工作得很好。

# php - 如何从 bash 和 php 脚本更新 Bugzilla 错误？

> ID：340471
> 
> 赞同：2
> 
> 时间：2008-12-04T12:48:42.917
> 
> 标签：php, web-services, bash, integration, bugzilla

我们的开发过程通过大量的 bash 和 php 脚本（包括 subversion 挂钩脚本）实现了高度自动化。这些脚本做了很多事情来与我们的 Bugzilla 3.0 安装集成。

但是当前的集成方法是一堆直接更新 bugzilla 数据库的 SQL 调用——这显然有很多缺点——包括让我担心升级到 3.2，以防数据库模式发生变化！

例如，要向错误添加注释，我正在对 longdescs 表执行 INSERT。

所以我的（有点啰嗦）的问题是：

*   我应该使用 Bugzilla WebServices 吗（如果是这样，除了 Bugzilla API 文档之外是否还有其他没有让我快速上手的好的文档）
*   或者，我是否应该使用其他一些 Bugzilla API（直接 perl 调用？） - 再说一次，这有什么像样的 doco 吗？
*   或者，我是否应该继续做我正在做的事情（直接 SQL 调用），因为 db 并没有发生太大变化并且它“完成了工作”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T12:06:43.500

根据 Bugzilla WebServices API，一些所需的功能（例如更改错误状态）尚不可用，因此目前，直接 SQL 调用似乎是最合适的选择。

数据库模式在 3.0 和 3.2 版本之间没有显着变化，因此这是一种实用的前进方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T17:27:07.257

仅供参考，在 Bugzilla 3.2 发行版中，有一个`contrib/bz_webservice_demo.pl`文件旨在“展示如何通过 XMLRPC 与 Bugzilla 对话”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-01T23:41:29.170

当心！一些数据库更改也意味着其他更改。通过向 longdescs 添加一行来为错误添加注释是可行的，但您还应该更新表错误中的 delta_ts。

在 Web 服务可用之前，我会这样做：使用您想从 shell 执行的 UI 执行操作。（假设 MySQL）使用 'mysqlbinlog' 查看数据库的二进制日志，您会看到 Bugzilla 在执行任何操作时通常会执行哪些语句。

如果您希望您添加的评论在下次有人进行更改时被邮寄，请不要理会 bugs.last_diffed。如果您不希望您添加的评论被邮寄出去，请像对 bugs.delta_ts 所做的那样更新 bugs.last_diffed。

Bugzilla 在数据库中有许多微妙的依赖关系，您必须尊重这些依赖关系，否则您可能会得到一些意想不到的结果。

# c# - 将 XML 传递给 Web 服务的最佳方法？

> ID：340489
> 
> 赞同：2
> 
> 时间：2008-12-04T12:56:07.630
> 
> 标签：c#, xml, web-services, xml-serialization

我在一个目录中有 XML 文件，我希望转到服务器上的 web 服务，该服务器将验证它们并返回关于它们在构造和值等方面是否有效的真/假。服务器端处理的原因是验证规则可能会不时更改，并且需要在一个地方而不是所有客户端计算机上进行调整。

这样做的最佳机制是什么？

目前我想知道是否将 XMLDocument 对象从客户端作为参数传递给 web 服务可能是要走的路？

我在 C# 中为此使用 .net 3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T12:59:33.037

您可能会考虑使用 WCF 服务之类的东西并使用 GZipStream 流式传输 xml。我正在做与此类似的事情，并且运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T12:58:31.447

普通的字符串还不够吗？在我看来，序列化/反序列化整个 XDoc 实例有点过头了。当然，您也可以压缩整个内容以减小请求的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T14:41:53.110

根据您的验证规则，将它们封装在类似于托管在公共 URL 上的 XML 模式中可能更明智。

这样，客户端可以在一行代码中验证模式，而不必连接到 Web 服务。

# ms-access - 从 access 数据库中导出制表符分隔的文件

> ID：340491
> 
> 赞同：0
> 
> 时间：2008-12-04T12:57:22.353
> 
> 标签：ms-access, vbscript

这段代码：

```
db = "C:\Dokumente und Einstellungen\hom\Anwendungsdaten\BayWotch4\Neuer Ordner\baywotch.db5"
TextExportFile = "C:\Dokumente und Einstellungen\hom\Anwendungsdaten\BayWotch4\Neuer Ordner\Exp.txt"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cn.Open _
   "Provider = Microsoft.Jet.OLEDB.4.0; " & _
   "Data Source =" & db

strSQL = "SELECT * FROM tblAuction1"

rs.Open strSQL, cn, 3, 3

Set fs = CreateObject("Scripting.FileSystemObject")

Set f = fs.CreateTextFile(TextExportFile, True, True)

a = rs.GetString

f.WriteLine a

f.Close 
```

生成制表符分隔文件，但不适合导入 mysql。我希望它生成一个类似于访问宏生成的文件的文件，可以在这里看到：

[http://www.yousendit.com/download/TTZtWmdsT01kMnVGa1E9PQ](http://www.yousendit.com/download/TTZtWmdsT01kMnVGa1E9PQ)

vbscript 生成的文件在这里：

[http://www.yousendit.com/download/TTZtWmdsT00wVWtLSkE9PQ](http://www.yousendit.com/download/TTZtWmdsT00wVWtLSkE9PQ)

我还想知道为什么文件大小相差 50k 左右。

**编辑：** vbscript 文件的结果使用记事本无法识别的换行符，因此查看时上面的内容看起来更加混乱。该宏似乎没有导出 html 代码，这解释了为什么它是一个较小的文件，但是 vbscript 似乎没有制表符分隔，因为它不会导入 mysql。

**编辑：**文件在linux系统下看起来不错，所以它可能与windows处理有关。然而它仍然不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T15:09:23.553

对我来说，这似乎是一个编码问题。我看到您在创建文本文件时传递了 Unicode 参数，但两个文件之间显然存在编码差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T13:11:17.363

这两个文件都包含看起来像制表符分隔的数据以及 HTML 代码（由某些 MS Office 应用程序生成，从外观上看）。tblAuction1 是否存储任何 OLE 对象？也许当您导出这些对象时，它正在导出文件内容？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T18:53:48.060

这个项目的目标是什么？创建文件的目的是什么？如果您只是想将数据从 Access 移动到 MySQL，为什么不直接使用这样的东西呢？

```
 Const Access = "Provider=Microsoft.Jet.OLEDB.4.0;Persist Security Info=False;Data Source=C:\Dokumente und Einstellungen\hom\Anwendungsdaten\BayWotch4\Neuer Ordner\baywotch.db5"
Const SQLServer = "Provider=SQLOLEDB.1;Integrated Security=SSPI;Data Source=.\SQLEXPRESS"
Dim arrFields

Set SQLConn = CreateObject("ADODB.Connection")
WITH SQLConn
    .ConnectionString = SQLServer
    .Open
End WITH
Set AccessConn = CreateObject("ADODB.Connection")
WITH AccessConn
    .ConnectionString = Access
    .Open
End WITH
Set SQLRS = CreateObject("ADODB.Recordset")
WITH SQLRS
    .CursorType = 3
    .LockType = 3
End WITH
Set AccessRS = CreateObject("ADODB.Recordset")
WITH AccessRS
    .ActiveConnection = AccessConn
    .CursorType = 3
    .LockType = 3   
End WITH

strSQL = "SELECT * FROM tblAuction1" 
AccessRS.Open strSQL

If AccessRS.RecordCount <> 0 Then
    AccessRS.MoveFirst
    ReDim arrFields(AccessRS.Fields.Count)
    Do Until AccessRS.BOF OR AccessRS.EOF
        For i = 0 To AccessRS.Fields.Count - 1
            If AccessRS.Fields(i).Type = 202 Then 
                arrFields(i) = Chr(39) & AccessRS.Fields(i).Value & Chr(39)
            Else
                arrFields(i) = AccessRS.Fields(i).Value
            End If
        Next
        strSQL1 = "INSERT INTO {Table in mySQL} VALUES("
        For j = 1 To UBound(arrFields) - 2 
            strSQL1 = strSQL1 & arrFields(j) & ","
        Next
        strSQL1 = strSQL1 & arrFields(UBound(arrFields) - 1) & ")"
        SQLRS = SQLConn.Execute(strSQL1)
        AccessRS.MoveNext
    Loop
Else
    MsgBox "No records found"
End If 
```

这会将记录集返回的所有记录添加到 SQLExpress 数据库中的表中，调整您的需求应该不难（如果您的需求是将数据从一个数据库传输到另一个数据库）。

# testing - 使用类似 Watin 的工具创建页面截图

> ID：340501
> 
> 赞同：3
> 
> 时间：2008-12-04T13:01:02.470
> 
> 标签：testing, watin

我需要通过向命令行工具提供页面 URL 来创建页面的屏幕截图。我找到了以下应用程序：[将 HTML 转换为图像](http://www.converthtmltoimage.com/)。这个工具还可以，但需要更灵活的应用程序。我需要有能力执行以下操作：

1.  转到下一页。
2.  单击按钮。
3.  截屏并保存。

我想创建一个应用程序，通过 URL 测试站点，拍摄照片，然后将图像发送到电子邮件。

有没有人有解决此类问题的经验？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-13T22:16:54.030

Watin 可以截取屏幕截图：

ie.CaptureWebPageToFile("c:\tmp\watin main page.jpg");

更多信息：

[http://watin.sourceforge.net/releasenotes-1-2-0-4000.html](http://watin.sourceforge.net/releasenotes-1-2-0-4000.html) [http://fwdnug.com/blogs/ddodgen/archive/2008/06/19/watin-api-capturewebpagetofile.aspx](http://fwdnug.com/blogs/ddodgen/archive/2008/06/19/watin-api-capturewebpagetofile.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T19:32:22.840

我是 WatiN 项目的贡献者，也是 WatiN 测试记录器的作者。为了做你想做的事，我建议使用类似 csExWB2 ( [http://code.google.com/p/csexwb2/](http://code.google.com/p/csexwb2/) ) 的东西。该演示将为您提供基本的浏览器，您可以在您喜欢的地方添加屏幕截图。电子邮件不包括在内，但这应该很容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-13T03:32:35.363

我知道这是一个很老的帖子，但我想给这个帖子的访问者留言。PhantomJS 是一种选择 (http://www.phantomjs.org)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T13:08:25.327

根据 WatiN 功能页面：

*   支持创建网页截图

我会指导您查看更具体的文档，但文档网络不适用于 Firefox，所以我无法搜索它。

# javascript - 使用 CSS 隐藏文本和更改图像

> ID：340505
> 
> 赞同：0
> 
> 时间：2008-12-04T13:02:44.527
> 
> 标签：javascript, html, css

我正在尝试使用 css 生成一个 html 页面，该页面用作图像预览之类的东西。一个例子在这里：

[http://www.nomorepasting.com/getpaste.php?pasteid=22463](http://www.nomorepasting.com/getpaste.php?pasteid=22463)

然而，这种方法有几个缺点。其中之一是文本必须始终小于图像。我在这里尝试使用不同的尝试：

[http://www.nomorepasting.com/getpaste.php?pasteid=22464](http://www.nomorepasting.com/getpaste.php?pasteid=22464)

但无法让它工作。有人可以向我展示如何修改第二个链接中的代码以作为第一个链接工作，或者建议一个整体更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T13:42:05.227

第二个错误是你没有`specified`height `attribute`。尝试以下方法，它对我有用。

```
.class1{
   color:#000;
   background-image:url('images/2.jpg');height:1000px;
} 
```

看不到背景图的原因是，div 里面什么都没有，而且高度不是0。尝试`specified`在`height`div 中放一些元素，你会看到 div`image`正在显示。

拉姆吉

# c# - 继承相等比较器

> ID：340507
> 
> 赞同：2
> 
> 时间：2008-12-04T13:02:47.477
> 
> 标签：c#, .net, linq

我有一个客户课程。

```
public class Customer
{
    private string _id;
    private string _name;
    // some more properties follow 
```

我继承了 EqualityComparer 表单 MyEqualityComparer(of Customer)。
我打算在 LINQ 查询中使用它。
MyEqualityComparer 用于两个对象之间的部分检查。
如果 customer.id 和 customer.name 匹配，我将对象视为平等。

```
public class MyComparer : System.Collections.Generic.EqualityComparer<Customer>
{
    public override bool Equals(Customer x, Customer y)
    {
        if (x.Id == y.Id && x.Name == y.Name)
            return true;
        else
            return false;
    }

    public override int GetHashCode(Customer obj)
    {
        return string.Concat(obj.Id,obj.Name).GetHashCode();
    }

} 
```

我提到了 [生成 hashcode](https://stackoverflow.com/questions/16340/how-do-i-generate-a-hashcode-from-a-byte-array-in-c)。
我不太确定连接字符串并将其用作哈希码。
这是我想要做的安全和健全的事情吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T13:10:34.247

有关基于多个字段返回一个哈希码的非常简单的方法，请参阅[有关哈希码的这个问题。](https://stackoverflow.com/questions/263400)

话虽如此，我不会从`EqualityComparer<T>`我自己那里得到——我只是`IEqualityComparer<T>`直接实施。`EqualityComparer<T>`除了实现非泛型`IEqualityComparer`.

还有几件事：

*   您应该在 Equals 中处理无效性
*   您现在的 Equals 代码可以简化为：

    ```
    return x.Id == y.Id && x.Name == y.Name; 
    ```

Equals 的更完整的实现可能是：

```
public override bool Equals(Customer x, Customer y)
{
    if (object.ReferenceEquals(x, y))
    {
        return true;
    }
    if (x == null || y == null)
    {
        return false;
    }
    return x.Id == y.Id && x.Name == y.Name;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T13:09:36.480

您应该从可能的“冲突”的角度来看待它，例如当两个不同的对象获得相同的哈希码时。这可能是“1,2any”和“12, any”这样的对的情况，对中的值是“id”和“name”。如果您的数据无法做到这一点，那么您就可以开始了。否则，您可以将其更改为：

```
return obj.Id.GetHashCode() ^ obj.Name.GetHashCode(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T13:16:34.810

Resharper（来自 JetBrains 的出色重构插件）认为它应该是：

```
public override int GetHashCode(Customer obj)
{
    unchecked
    {
        return ((obj.Id != null ? obj.Id.GetHashCode() : 0) * 397) 
            ^ (obj.Name != null ? obj.Name.GetHashCode() : 0);
    }
} 
```

我不得不承认，我几乎总是让 Resharper 为我生成相等和哈希码实现。我已经对他们的实现进行了大量测试，发现它与我手写的任何东西一样好，如果不是更好的话。所以我通常会采用我不必输入的实现。

# dojo - 我可以创建一个带有指向不同端口或服务器的 url 的 dojox.data.XmlStore

> ID：340510
> 
> 赞同：0
> 
> 时间：2008-12-04T13:04:00.860
> 
> 标签：dojo, xmlstore

在下文中，我想`/books.xml`用类似`http://server:port/books`. 本质上，XmlStore 将由其他服务器或端口提供服务，而不是提供服务的服务器或端口

```
<div dojoType="dojox.data.XmlStore" url="/books.xml" jsId="fileStore_book" rootItem="book"></div>
<div dojoType="dojox.grid.data.DojoData" jsId="model_fileStore_book" store="fileStore_book" query="{title:'*'}"></div>
<div
    id="fileGrid_book"
    dojoType="dojox.Grid"
    model="model_fileStore_book"
    rowsPerPage="10"
    style="width: 400px; height: 300px;"
>
    <script type="dojo/method">this.setStructure([{cells: [[{field: "isbn", name: "ISBN", width: 10}, {field: "author", name: "Author", width: 10}, {field: "title", name: "Title", width: 'auto'}]]}]);</script>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T14:33:09.057

与 Web 应用程序中的所有数据源一样，数据存储受到“同源”限制的约束。您应该使用您的服务器代理其他服务器，或者考虑其他数据访问方式，例如 JSONP 或窗口名称传输。

# cvs - 我是否应该将完整的 Tornado 树置于版本控制之下？

> ID：340516
> 
> 赞同：2
> 
> 时间：2008-12-04T13:07:11.273
> 
> 标签：cvs, vxworks

我终于有了一个对控制固件感兴趣的硬件人员。

这是针对 vxworks 固件的。tornado (2.2.1) gui 创建一个项目文件，其中包含已修改的文件列表，但它们似乎来自整个目录树。

所以我很想控制这些文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T13:10:32.827

在我看来，检查整个 Tornado 目标树是一个好主意。最大的优势是，服务包和补丁会自动传播给其他团队成员，并且_even_more_important_会自动传播到构建机器。另一个优点是，如果您需要在旧版本中调试某些东西，您有正确的头文件和库。

参见[VxWorks / Tornado II FAQ - 1.12 版本控制](http://www.xs4all.nl/~borkhuis/vxworks/vxw_pt1.html#1.12)

# architecture - 我们应该引入 BizTalk/ESB 吗？

> ID：340518
> 
> 赞同：6
> 
> 时间：2008-12-04T13:07:59.510
> 
> 标签：architecture, biztalk, soa, esb

我的公司即将实施一个新架构，我们在其中提出了 BizTalk（我们是一家微软商店）作为 SOA（请不要引用面向服务的歧义）环境中的企业服务总线 (ESB)。

我们的业务是通过我们的新订单捕获 GUI 接收订单，该 GUI 必须连接到我们的客户数据库、产品目录、订购系统和其他一些辅助系统，每个系统都将作为 WCF 服务公开，然后将订单传递给我们的订单管理和其他用于履行的下游系统，最后到我们的计费系统进行开发票。目前，每个系统都有自己的 GUI，并使用手动过程在它们之间传递信息，为了实现自动化和集成，自然的想法是引入 ESB 来连接它们。

我对 ESB 的一些基本原理是，总线会担心如何连接系统（每个系统都是不可知的，并且对任何其他系统一无所知）以及如何格式化/翻译信息。将来，很有可能将某些现有系统替换为我们公司家族中的新系统或系统。

这对我来说似乎很有意义，但我现在遇到了一些阻力，即为什么在点对点解决方案足够时引入它。

不幸的是，在公司历史上（在我任命之前），引入 BizTalk 的初步尝试失败了，但我相信它有一席之地并且我可以交付它。

我的问题可能不是关于 BizTalk，而是 ESB 在我所描述的场景中是否是一个好主意，什么时候引入 ESB 才有意义？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-05T03:31:56.613

好的。来自规范架构组的 Biztalk 的 ESB 指南 - [http://msdn.microsoft.com/en-us/library/cc487894.aspx](http://msdn.microsoft.com/en-us/library/cc487894.aspx)

我们在我工作的地方使用 BizTalk 来做很多事情。他有一些简单的积分。我们与高度定制的适配器和管道进行了一些更复杂的点集成。我们有针对客户主数据、产品信息和价格以及订单报价的部门企业系统集成。这些都是单独的 BizTalk 应用程序。有些很小，有些很大。我们主要使用 BizTalk 进行点对点/多点解决方案，而不使用 ESB 模式。ESB 的实现意味着总线本身的治理水平和总线上允许的企业消息标准。如果您将与具有大量不同格式的大量系统交互 - ESB 非常有意义。如果您想要实现的集成不那么雄心勃勃，那么 ESB 可能是矫枉过正。话虽如此，它是一个干净且可扩展的架构。您必须做出成本价值决定。

BizTalk 也是一个复杂的野兽，但所有的移动部件都具有一定程度的灵活性，非常棒。但要为学习曲线或一些顾问费用做好准备。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-24T13:13:12.620

我刚刚被同事问了同样的问题，这就是我对他说的：

> 在大多数集成方案中，您可以在使用诸如 BizTalk 之类的东西之前走得更远。在使用 BizTalk 之前，我会确保不能更简单地进行集成。
> 
> 仅当集成解决方案似乎需要以低延迟扩展到大容量时（它具有出色的异步发布-订阅机制），并且您需要容错（它具有冗余、扩展和消息重试功能）和对解决方案的治理（它有业务活动监控）你真的有强烈的论据来考虑使用 BizTalk。而且，如果您知道将来需要进行多种集成，那么使用 BizTalk 就会变得非常有吸引力。
> 
> 另一方面，您需要确保具备操作该事物的技能。对于系统的开发人员来说，学习和范式转变需要一段时间。然而，它是在 .NET 和 SQL Server 中从头开始构建的，因此对工具和概念非常熟悉。
> 
> 我认为关键是要正确考虑解决方案的概念架构，同时考虑到性能、可用​​性、可扩展性、弹性、健壮性和可扩展性等非功能性需求，并确保技术设计能够正确解决它们。您可能会发现，为 BizTalk 提供的开箱即用功能支付每个 CPU 许可证 35k 美元比为所有这些 NFR 进行开发更便宜。

此外，我最近在一个客户端实现了新的 ESB Toolkit 2.0，对此我感到非常满意。Itinerary（请参阅 Routing Slip 模式[http://www.enterpriseintegrationpatterns.com/RoutingTable.html](http://www.enterpriseintegrationpatterns.com/RoutingTable.html)）处理功能确实使编写 Web 服务变得容易、灵活和快速。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T18:04:08.023

我认为根据您描述的要求拥有一个数据代理是有意义的，但我个人认为 BizTalk 不是您情况下的最佳选择。对于您描述的集成类型，我将查看硬件数据代理设备。我见过运行良好的有 IBM DataPower、Vordel 的设备和 Layer7 的设备。对于您将使用它的呼叫类型，设备是理想的。它们提供路由、转换和翻译，此外它们还可以防止模式中毒等问题。他们还将通过将其链接到您的用户存储来处理授权、身份验证和审核（我猜您有一个基于您描述的环境的 Active Directory 用户存储，但它也适用于 LDAP）

就拥有成本（无支持成本）而言，设备将是 BizTalk 或任何其他软件解决方案，并且任何设备的性能都可能比 BizTalk 高一个数量级。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T10:25:16.483

我倾向于避免使用 ESB 术语，因为我认为它严重超载；归根结底，在我听到的所有各种描述中，它只是一种模式，曾经 BizTalk 非常支持它。

那么 - 我认为 BizTalk 是否适合您想要做的事情？绝对是的。我认为避免点对点连接是正确的吗？也是的，但是，就像任何重用重构练习（包括任何 SOA 计划）一样，您必须考虑您期望有多少变化和现在多少重用来决定多远你正在“脱钩”练习。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T17:20:29.227

您需要谈论延迟和吞吐量。其他一切都只是废话。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T05:18:44.350

这是一个非常独特的模式。通常，当您从系统 A 向系统 B 发送消息时，您会将系统 A 的格式直接转换为系统 B 想要的格式。当您拥有 ESB 时，您将系统 A 的消息转换为 ESB 格式（即通用 PO、订单等），然后转换为系统 B 所需的格式。这是对 1 的两次转换，而且总线模式需要每个消息都有一个动词（即添加、删除、更新等）。这是一个真正重要的区别，也是使 ESB 在与许多参与系统的集成中非常有用的原因。

# asp.net - ASP.NET GridView“删除时客户端确认”停止工作 ie - 怎么回事？

> ID：340520
> 
> 赞同：0
> 
> 时间：2008-12-04T13:08:52.300
> 
> 标签：asp.net, gridview

几个月前，我根据这篇 msdn 文章编写了一个带有自定义“删除”链接按钮和客户端 JavaScript 确认的 ASP.NET GridView：

[http://msdn.microsoft.com/en-us/library/bb428868.aspx（2007](http://msdn.microsoft.com/en-us/library/bb428868.aspx)年 4 月发布）

或者例如[在 asp:ButtonField click 之前的 Javascript](https://stackoverflow.com/questions/218733/javascript-before-aspbuttonfield-click)

代码如下所示：

```
<ItemTemplate>
  <asp:LinkButton ID="deleteLinkButton" runat="server" 
    Text="Delete"
    OnCommand="deleteLinkButtonButton_Command"   
    CommandName='<%# Eval("id") %>'
    OnClientClick='<%# Eval("id", "return confirm(\"Delete Id {0}?\")") %>'
  />
</ItemTemplate> 
```

令人惊讶的是，“取消”不再适用于我的 ie（版本`6.0.2900.2180.xpsp_sp2_qfe.080814-1242`：） - 它总是删除该行。使用 Opera（9.62 版），它仍然可以按照预期和 msdn 文章中的描述工作。更令人惊讶的是，在同一个 ie 版本的同事机器上，它仍然有效（“取消”不会删除该行）。

生成的代码看起来像

```
<a onclick="return confirm(...);" href="javascript:__doPostBack('...')"> 
```

由于 confirm(...) 在“取消”时返回 false，我希望不会触发 href 中的 __doPostBack 事件。是否有任何奇怪的 ie 设置我不小心改变了？还有什么可能是导致这种奇怪行为的原因？或者这是“请重新安装 WinXP”的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T14:23:31.993

尝试这个 ：

```
<asp:LinkButton ID="DeleteButton" runat="server" CausesValidation="False"
    CommandName="Delete" Text="Delete"
    OnClientClick="return confirm('Delete Id : '<%# (string)Eval('id')%>')" >

</asp:LinkButton> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T10:11:55.353

终于在[http://forums.asp.net/t/1161858.aspx找到了解决办法](http://forums.asp.net/t/1161858.aspx)

在该线程中，问题的根源最终归咎于“原因是 McAfee Phising Filter”。

我不得不更换明显的线

```
OnClientClick='<%# Eval("id", "return confirm(\"Delete Id {0}?\")") %>' 
```

使用这条神秘的线（我还必须研究如何转义花括号），因为“event.returnValue=false; 有所作为”：

```
OnClientClick='<%# Eval("zahlungid", "if(confirm(\"Delete Id {0}?\")==false){{event.returnValue=false;return false;}}else{{return true;}}") %>' 
```

# .net - 如何在 WCF 中自动重新连接命名管道绑定

> ID：340521
> 
> 赞同：12
> 
> 时间：2008-12-04T13:09:21.033
> 
> 标签：.net, wcf, wcf-binding

我正在编写一个只会从本地主机接听电话的服务。性能很重要，所以我想我会尝试使用[NetNamedPipeBinding](http://msdn.microsoft.com/en-us/library/system.servicemodel.netnamedpipebinding.aspx)而不是[NetTcpBinding](http://msdn.microsoft.com/en-us/library/system.servicemodel.nettcpbinding.aspx)，看看是否能看到任何明显的性能提升。

如果客户端在向服务器执行了一个或多个请求后，长时间处于空闲状态，则下一个请求似乎由于绑定中的一些空闲超时而失败。重新启动服务时也会发生同样的事情。

我需要我的客户能够在允许的时间内保持连接打开，以避免与设置新连接相关的开销。我还需要能够不时重新启动服务，并让客户端在注意到连接已终止时自动重试。

我知道 NetTcpBinding 中的可靠性内容支持这一点，但是如何在 NetNamedPipeBinding 中获得相同级别的重新连接可靠性？甚至可能吗？

这个问题有点学术，因为它不是使用 NetNamedPipes 的要求，我可以很容易地采用它来使用 tcp 绑定，但它很痒，我真的很想从头开始。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2011-01-05T21:55:52.917

我的经验是，当使用 NetNamedPipes 时，绑定功能上的“ReceiveTimout”类似于“Inactivity Timeout”而不是接收超时。请注意，这与 NetTCPBinding 的工作方式不同。使用 TCP，它确实是一个接收超时，并且有一个单独的不活动超时，您可以通过可靠的消息传递来配置。（这似乎也与 SDK 文档相反，但好吧）。

要解决此问题，请在创建绑定时将 RecieveTimout 设置为较大的值。
例如，如果您在程序上创建绑定...

```
NetNamedPipeBinding myBinding = new NetNamedPipeBinding(NetNamedPipeSecurityMode.None);
myBinding.ReceiveTimeout = TimeSpan.MaxValue; 
```

或者，如果您关心以声明方式创建绑定...

```
<netNamedPipeBinding>
    <binding name="myBinding" receiveTimeout="infinite">
    </binding>
</netNamedPipeBinding> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-04T15:01:37.453

我没有在 WCF 中使用过 NetNamedPipes，但我花在学习 NetTcp 超时值上的时间比我关心的要多。我为我的 NetTcpBindings 使用以下配置，并祝连接保持活跃。

服务器：

```
<binding name="MyBindingName" sendTimeout="00:00:30" receiveTimeout="infinite">
    <reliableSession enabled="true" inactivityTimeout="00:05:00" ordered="true" />
    <security mode="None" />
</binding> 
```

客户：

```
<binding name="MyBindingName" closeTimeout="00:00:30" openTimeout="00:00:30" receiveTimeout="infinite" sendTimeout="00:00:30">
    <reliableSession enabled="true" inactivityTimeout="00:01:00" ordered="true" />
    <security mode="None" />
</binding> 
```

我花费最多时间的重要设置是 sendTimeout 和 receiveTimeout。如果您的 receiveTimeout 与您的 send 相同或小于您的 send，则一旦达到该超时，通道将丢弃。如果接收更高并且发送高于阈值，则通道将触发传输级别保持活动。根据我的测试，sendTimeout 阈值为 30 秒。任何小于此的内容都不会发送keepalives。

此外，我有一个基于计时器的 keepalive 调用，我每分钟执行一次，以确保通道正常运行。该调用只是对布尔返回成员的调用：

```
[OperationContract(IsOneWay = false, IsInitiating = false, IsTerminating = false)]
bool KeepAlive();

public bool KeepAlive()
{
    return true;
} 
```

您还可以获取频道事件（如果您在正确的时间获得它们）并在发生不良情况时重新打开连接：

```
InstanceContext site = new InstanceContext(this);
_proxy = new MyServiceChannel(site);
if (_proxy != null) 
{
    if (_proxy.Login()) 
    {
        //Login was successful
        //Add channel event handlers so we can determine if something goes wrong
        foreach (IChannel a in site.OutgoingChannels) 
        {
            a.Opened += Channel_Opened;
            a.Faulted += Channel_Faulted;
            a.Closing += Channel_Closing;
            a.Closed += Channel_Closed;
        }
    }
} 
```

我希望其中的一些内容可以转化为 NetNamedPipes 并为您提供价值。

编辑：用于捕获服务器重新启动问题的更多选项

当服务器重新启动时，它应该导致客户端的通道关闭或出现故障。在客户端捕获这些事件将使您可以选择使用重新连接计时器，直到服务再次可用。

```
private void Channel_Faulted(object sender, EventArgs e)
{
    IChannel channel = sender as IChannel;
    if (channel != null) 
    {
        channel.Abort();
        channel.Close();
    }

    //Disable the keep alive timer now that the channel is faulted
    _keepAliveTimer.Stop();

    //The proxy channel should no longer be used
    AbortProxy();

    //Enable the try again timer and attempt to reconnect
    _reconnectTimer.Start();
}

private void _reconnectTimer_Tick(object sender, System.EventArgs e)
{
    if (_proxy == null) 
    {
        InstanceContext site = new InstanceContext(this);
        _proxy = new StateManagerClient(site);
    }
    if (_proxy != null) 
    {
        if (_proxy.Login()) 
        {
            //The connection is back up
            _reconnectTimer.Stop();
            _keepAliveTimer.Start();
        }
        else 
        {
            //The channel has likely faulted and the proxy should be destroyed
            AbortProxy();
        }
    }
}

public void AbortProxy()
{
    if (_proxy != null) 
    {
        _proxy.Abort();
        _proxy.Close();
        _proxy = null;
    }
} 
```

您需要确保重新连接计时器的登录尝试是在后台线程上异步完成的，这样它们就不会在每次尝试登录时都挂起 UI。YMMV

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-01-14T16:30:38.680

I have been looking into the problem of dropped TCP connections for two days now and came to the conclusion that a lot of people are missing a crutial point when setting up connections in WCF. What everybody seems to be doing is create a channel once and then trying to hold on to it for the lifetime of the application, playing all sorts of dirty tricks to keep the TCP session alive. This is not how it was meant to be.

You should create a channel, perform one (or some more shortly after the first) calls on your service, then close and dispose the channel. This will give you (virtually) stateless operation and you don't have to be bothered with keeping sessions alive, which you should not want in the first place.

You will find that the overhead of creating and closing a channel (from a reused ChannelFactory) is negligible, taking only some tens of nanoseconds on a typical machine.

The receiveTimeout attribute that everyone is cranking up defines the time a channel can remain idle before it is automatically dropped, which tells you channels are not meant to be kept open for very long (the default is 1 minute). If you set receiveTimeout to TimeSpan.MaxValue it will keep your channel open longer but this is not what it is for nor what you want in a practical scenario.

What finally got me on the right track was [http://msdn.microsoft.com/en-us/library/ms734681.aspx](http://msdn.microsoft.com/en-us/library/ms734681.aspx) which provides a horribly buggy example yet does show how one should go about using ChannelFactory. Responders point out the bugs and set the record straight so all in all you can get everything you need here.

And then, all my problems were over. No more "An operation was attempted on something that is not a socket" and no more "An existing connection was forcibly closed by the remote host".

# c# - 从 MethodCallExpression 访问调用对象

> ID：340525
> 
> 赞同：1
> 
> 时间：2008-12-04T13:10:32.920
> 
> 标签：c#

我正在尝试了解表达式树，并且我创建了一种方法，该方法需要

```
Expression<Func<bool>> 
```

并在满足某些条件时执行它 - 请参见下面的代码。

```
 private static void TryCommand(Expression<Func<bool>> expression)
        {
            var methodCallExpression = expression.Body as MethodCallExpression;
            if (methodCallExpression == null)
            {
                throw new ArgumentException("expression must be a MethodCallExpression.");
            }

            if (methodCallExpression.Object.Type != typeof (MyClass))
            {
                throw new ArgumentException("expression must be operating on an instanceof MyClass.");                
            }

            var func = expression.Compile();
            var success = func.Invoke();

            if(!success)
            {
                Console.WriteLine(methodCallExpression.Method.Name + "() failed with error code " + (func.Target as MyClass).GetError());
            }
        } 
```

那个问题

```
(func.Target as MyClass) 
```

一片空白。显然我做错了什么！如何访问该方法正在运行的实例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-14T16:50:42.473

Akash，一旦你有了 MethodCallExpression，恢复方法调用者就很简单了。您必须恢复 MemberExpression 并构建对其进行评估的表达式树。

请看下面的代码：

```
 MethodCallExpression methodCallExpression = (MethodCallExpression)expression.Body;
MemberExpression memberExpression = (MemberExpression)methodCallExpression.Object;

Expression<Func<Object>> getCallerExpression = Expression<Func<Object>>.Lambda<Func<Object>>(memberExpression);
Func<Object> getCaller = getCallerExpression.Compile();
MyClass caller = (MyClass)getCaller(); 

```

希望这可以帮助，

里卡多·拉塞尔达·布兰科堡

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T13:26:26.023

方法调用的目标是 MyClass 的一个实例，但委托本身不是方法调用。它会在执行时执行方法调用。

如果您查看 func.Target，您会发现它是一个[System.Runtime.CompilerServices.ExecutionScope](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.executionscope.aspx)。

现在您*可以*对其进行测试，对其进行强制转换，然后获取 Locals 或 Globals（不确定哪个）来获取目标。但是，我怀疑只是更改为使用 a `Func<int>`（或任何类型的错误代码）并在您首先执行委托时返回错误代码会更干净。那么你甚至不需要表达式树。

编辑：鉴于您的意见，我建议：

```
public static void TryCommand(Expression<Func<MyClass,bool>> command,
                              MyClass c)
{
    // Code as before to find the method name etc.

    Func<MyClass, bool> compiled = command.Compile();

    if (!compiled(c))
    {
        Console.WriteLine(methodCallExpression.Method.Name
            + "() failed with error code " + c.GetError());
    }
} 
```

然后，您可以使用以下命令调用它：

```
TryCommand(x => x.SomeMethod(), myClass); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T21:26:30.673

目标为空，因为方法是静态的。在静态 MethodInfo 上的反射 Invoke(..) 将忽略目标。这可能是一种扩展方法，在这种情况下，第一个参数是推断的目标。

由于大多数 LINQ 都基于扩展方法，因此您会经常看到这种情况随着反射的发展而发展。

# c# - C# 自动属性 - 为什么我必须编写“get; set;”？

> ID：340528
> 
> 赞同：49
> 
> 时间：2008-12-04T13:10:50.923
> 
> 标签：c#, c#-3.0, automatic-properties

如果在 C# 自动属性中 get 和 set 都是强制性的，为什么我必须费心指定“get; set;” 有吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-12-04T13:12:29.953

因为您可能需要一个只读属性：

```
public int Foo { get; private set; } 
```

或只写属性：

```
public int Foo { private get; set; } 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-12-04T14:06:09.547

**错误：属性或索引器不能作为 out 或 ref 参数传递**

如果您没有指定`{get; set;}`，那么编译器将不知道它是字段还是属性。这很重要，因为当它们“看起来”相同时，编译器会以不同的方式对待它们。例如，在属性上调用“InitAnInt”会引发错误。

```
class Test
{
    public int n;
    public int i { get; set; }
    public void InitAnInt(out int p)
    {
        p = 100;
    }
    public Test()
    {
        InitAnInt(out n); // This is OK
        InitAnInt(out i); // ERROR: A property or indexer may not be passed 
                          // as an out or ref parameter
    }
} 
```

您不应该在类上创建公共字段/变量，您永远不知道何时将其更改为具有 get 和 set 访问器，然后您不知道要破坏哪些代码，尤其是如果您有针对您的 API 进行编程的客户端。

您还可以为 get & set 设置不同的访问修饰符，例如 {get; **private** set;} 使 get public 和 set 对声明类私有。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-12-04T17:08:49.633

只是想我会分享我在这个话题上的发现。

像下面这样对属性进行编码，是一个 .net 3.0 快捷方式调用“<strong>自动实现的属性”。

```
public int MyProperty { get; set; } 
```

这可以为您节省一些打字时间。声明一个属性的漫长方法是这样的：

```
private int myProperty;
public int MyProperty 
{
  get { return myProperty; }
  set { myProperty = value; } 
} 
```

当您使用“自动实现的属性”时，编译器会生成代码来连接 get 并设置为某个“k_BackingField”。下面是使用 Reflector 的反汇编代码。

```
public int MyProperty
{
    [CompilerGenerated]
    get
    {
        return this.<MyProperty>k__BackingField;
    }
    [CompilerGenerated]
    set
    {
        this.<MyProperty>k__BackingField = value;
    }
} 
```

*来自 IL 的反汇编 C# 代码*

还为 setter 和 getter 连接了一个方法。

```
[CompilerGenerated]
public void set_MyProperty(int value)
{
    this.<MyProperty>k__BackingField = value;
}
[CompilerGenerated]
public int get_MyProperty()
{
    return this.<MyProperty>k__BackingField;
} 
```

*来自 IL 的反汇编 C# 代码*

当您声明一个只读的自动实现属性时，通过将 setter 设置为私有：

```
 public int MyProperty { get; private set; } 
```

所有编译器都将“ **set** ”标记为私有。setter 和 getter 方法说的一样。

```
public int MyProperty
{
    [CompilerGenerated]
    get
    {
        return this.<MyProperty>k__BackingField;
    }
    private [CompilerGenerated]
    set
    {
        this.<MyProperty>k__BackingField = value;
    }
} 
```

*来自 IL 的反汇编 C# 代码*

所以我不确定为什么框架需要get；并设置；在自动实现的属性上。如果没有提供 set 和 setter 方法，他们可能就不会编写它。但是可能有一些编译器级别的问题使这变得困难，我不知道。

如果您查看声明只读属性的漫长过程：

```
public int myProperty = 0;
public int MyProperty
{
    get { return myProperty; }
} 
```

然后看反汇编代码。二传手根本不在那里。

```
public int Test2
{
    get
    {
        return this._test;
    }
}

public int get_Test2()
{
    return this._test;
} 
```

*来自 IL 的反汇编 C# 代码*

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-12-04T13:13:18.967

因为您需要一些方法来将其与普通字段区分开来。

拥有不同的访问修饰符也很有用，例如

```
public int MyProperty { get; private set; } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-04T13:12:36.363

编译器需要知道您是否希望它生成 getter 和/或 setter，或者可能正在声明一个字段。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-04T13:13:48.903

如果属性没有访问器，编译器如何将它与字段分开？什么将它与一个领域分开？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-04T22:26:39.570

好吧，显然您需要一种消除字段和属性之间歧义的方法。但是必填关键字真的有必要吗？例如，很明显这两个声明是不同的：

```
public int Foo;
public int Bar { } 
```

那可以工作。也就是说，这是一种编译器可以理解的语法。

但是随后您会遇到空块具有语义含义的情况。这似乎岌岌可危。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-30T00:51:13.793

由于没有人提到它......你可以使自动属性虚拟并覆盖它：

```
public virtual int Property { get; set; } 
```

如果没有获取/设置，它将如何被覆盖？请注意，您可以 [覆盖 getter 而不是 setter](https://stackoverflow.com/questions/3884025/partially-overriding-a-virtual-auto-property-in-a-child-class)：

```
public override int Property { get { return int.MinValue; } } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-12-04T10:25:36.250

此外，因为从 C# 6.0 开始（在 Visual Studio 2015 中，在最终预览版中提供此答案时），您可以实现真正的只读属性：

```
public string Name { get; }
public string Name { get; } = "This won't change even internally"; 
```

...与当前使用公共 getter/private setter 对的不完美解决方法相反：

```
public string Name { get; private set; }

public Constructor() { Name="As initialised"; }
public void Method() { Name="This might be changed internally. By mistake. Or not."; } 
```

下面的示例（[在此处](http://ideone.com/GVfo26)在线编译和可执行）。

```
using System;

public class Propertier {
    public string ReadOnlyPlease { get; private set; }

    public Propertier()  { ReadOnlyPlease="As initialised"; }
    public void Method() { ReadOnlyPlease="This might be changed internally"; }
    public override string ToString() { return String.Format("[{0}]",ReadOnlyPlease); }
}

public class Program {
    static void Main() {
        Propertier p=new Propertier();
        Console.WriteLine(p);

//      p.ReadOnlyPlease="Changing externally!";
//      Console.WriteLine(p);

        // error CS0272: The property or indexer `Propertier.ReadOnlyPlease' cannot be used in this context because the set accessor is inaccessible
        // That's good and intended.

        // But...
        p.Method();
        Console.WriteLine(p);
    }
} 
```

有关 C# 6.0 的其他精彩新闻可[在此处](http://channel9.msdn.com/Events/Visual-Studio/Connect-event-2014/116)作为官方预览视频获得。

# html - 如何使用 RegExp 从嵌套的类似 HTML 的元素中检索值的集合？

> ID：340543
> 
> 赞同：1
> 
> 时间：2008-12-04T13:15:58.743
> 
> 标签：html, regex, parsing

我在为以下任务创建正则表达式时遇到问题：

假设我们有类似 HTML 的文本：

```
<x>...<y>a</y>...<y>b</y>...</x> 
```

我想获取`<y></y>`位于给定`<x>`标签内的标签内的值集合，因此上述示例的结果将是两个元素 ["a","b"] 的集合。

此外，我们知道：

*   `<y>`标签不能包含在其他`<y>`标签 中
*   `...`可以包含任何文本或其他标签。

如何使用 RegExp 实现这一目标？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-04T13:23:43.267

这是[HTML/XML 解析器](http://htmlparsing.icenine.ca/)的工作。你*可以*用正则表达式来做，但这会很混乱。我链接到的页面中有示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T13:38:49.290

我相信你的话：

```
"y" tags cannot be enclosed in other "y" tags

input looks like: <x>...<y>a</y>...<y>b</y>...</x> 
```

*以及其他所有内容也没有*嵌套和正确格式化的事实。（免责声明：如果不是，那不是我的错。）

首先，找到任何 X 标记的内容，并在此匹配项上循环：

```
<x[^>]*>(.*?)</x> 
```

然后（在循环体中）从上面找到“外部”匹配的匹配组 1 中的任何 Y 标记：

```
<y[^>]*>(.*?)</y> 
```

伪代码：

```
input = "<x>...<y>a</y>...<y>b</y>...</x>"
x_re  = "<x[^>]*>(.*?)</x>"
y_re  = "<y[^>]*>(.*?)</y>"

for each x_match in input.match_all(x_re)
  for each y_match in x_match.group(1).value.match_all(y_re)
    print y_match.group(1).value
  next y_match
next x_match 
```

伪输出：

```
a
b 
```

* * *

评论中的进一步澄清表明，任何 X 元素中都有任意数量的 Y 元素。这意味着没有一个正则表达式可以匹配它们*并*提取它们的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T13:24:12.393

简短而简单：使用 XPath :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T00:45:09.023

如果我们知道您使用的语言或工具会有所帮助；语法、语义和功能有很多变化。这是在 Java 中执行此操作的一种方法：

```
String str = "<y>c</y>...<x>...<y>a</y>...<y>b</y>...</x>...<y>d</y>";
String regex = "<y[^>]*+>(?=(?:[^<]++|<(?!/?+x\\b))*+</x>)(.*?)</y>";
Matcher m = Pattern.compile(regex).matcher(str);
while (m.find())
{
  System.out.println(m.group(1));
} 
```

一旦我匹配了 a `<y>`，我就使用前瞻来确认`</x>`前面有某个地方，但`<x>`当前位置和它之间没有。假设伪 HTML 格式合理，这意味着当前匹配位置在 "x" 元素内。

我大量使用所有格量词，因为它们使这样的事情变得更容易，但正如你所看到的，正则表达式仍然有点像怪物。除了 Java，我所知道的支持所有格量​​词的唯一正则表达式风格是 PHP 和 JGS 工具（RegexBuddy/PowerGrep/EditPad Pro）。另一方面，许多语言提供了一次获取所有匹配项的方法，但在 Java 中，我必须为此编写自己的循环。

因此，*可以*使用一个正则表达式来完成这项工作，但这是一个非常复杂的正则表达式，并且正则表达式和封闭代码都必须根据您正在使用的语言进行定制。

# c# - 如何在 C# 中的 new 和 override 之间进行选择？

> ID：340546
> 
> 赞同：5
> 
> 时间：2008-12-04T13:16:54.187
> 
> 标签：c#

建议在 C# 中使用 override 而不是 new 关键字。为什么有这个规则？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T13:22:08.233

“新”意味着就 CLR 而言，您有两种完全不同的方法——它们恰好具有相同的名称，但它们在继承方面不相关。这意味着如果你运行：

```
Base b = new Derived();
Derived d = new Derived();
b.MyMethod(); // Calls Base.MyMethod
d.MyMethod(); // Calls Derived.MyMethod 
```

这可能会导致一些非常难以理解的代码。

通常，如果您想要不同的方法，请称它们为不同的东西。使用相同名称（和签名）的正常原因是重写基类方法的行为。那时您别无选择，只能保持名称/签名相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T13:24:26.403

除了可怕的骇客之外，我仍在尝试找出“新”的用例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T13:24:51.177

这实际上*不是*你的*选择*。这是通过创建基类强加给您的。如果存在具有相同名称的方法并且它被标记为“虚拟”，那么您应该使用覆盖，除非您希望在人们开始将您的类的对象转换为基类时出现一些非常有趣的错误......

尽管如果该方法未标记为“虚拟”，那么创建新方法的唯一方法是使用“新”关键字。请注意，虽然这不会替换引用类型为（基类）的方法调用到您的方法。所以这主要只是语法糖来创建一个具有相同名称和相同签名的新方法......

虽然当代码碰到你的熨斗时，它只不过是一个完全不同的方法，具有相同的名称和相同的签名。重写的方法会将*每个调用*（包括基类程序集中的调用）替换为*您的新*方法...

所以比较它们就像比较汽车和呃……*鸟*什么的……

# perl - 有没有什么方法可以在没有计划的情况下使用 Test::More 中的 diag() ？

> ID：340548
> 
> 赞同：3
> 
> 时间：2008-12-04T13:18:40.003
> 
> 标签：perl, unit-testing

我正在用 Perl 编写一些测试，这些测试具有相当多的设置。这个设置都存在于测试脚本的模块中`use`。我希望能够从模块打印一些诊断信息，并打算`diag`使用`Test::More`. 问题是，当你`use Test::More`写计划时，我得到

> 您尝试在 lib/MyTest.pm 第 15 行进行两次计划。

有什么方法可以使用`diag`（或有等效方法），还是我坚持`print STDERR`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T13:57:09.363

对我来说，以下代码：

```
 #!/usr/bin/perl
  use strict;
  use Test::More;
  diag('hello'); 
```

只是打印

```
 # hello 
```

`Test::More`除非您告诉它，否则不会打印该计划。这是通过将 args 传递给其导入来完成的：

```
 use Test::More tests => 30; 
```

或者通过显式调用计划。

```
 use Test::More;
  plan(tests => 30); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T18:17:12.193

```
use Test::More qw(no_plan) 
```

# asp-classic - 是否可以在经典 ASP 页面上使用 GZIP 压缩？

> ID：340550
> 
> 赞同：2
> 
> 时间：2008-12-04T13:20:00.793
> 
> 标签：asp-classic, compression, gzip

我们有一个经典的 ASP 应用程序，它输出一些非常大的报告，其中生成的 HTML 为几 MB。通过减少无关的 HTML，我们在减少这种情况方面取得了很大进展，但我想知道是否有任何方法可以在这些动态 .asp 页面上启用 GZIP 压缩。我确信压缩它们会对文件大小产生巨大的好处。

我看到的所有 GZIP 压缩信息都只涉及支持文件或 .aspx 页面。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T13:40:15.403

当然，这只是在 IIS 中打开压缩的问题。例如，请参阅此[MSDN](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/25d2170b-09c0-45fd-8da4-898cf9a7d568.mspx?mfr=true)页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T02:39:31.130

我推荐使用[Port 80 Software e 的 HttpZip](http://www.port80software.com/products/httpzip/)。它基本上只是在 IIS 中启用压缩，但从 GUI 而不是进入元数据库。我在一个大型企业 ASP 应用程序的网络农场中使用了它。

# http - 从 Windows Powershell 发送 HTTP 请求的最佳方式是什么？

> ID：340553
> 
> 赞同：26
> 
> 时间：2008-12-04T13:21:57.937
> 
> 标签：http, networking, powershell

从 Windows Powershell 发送 HTTP 请求的最佳方式是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-04T13:29:11.463

找到了一种方法：

```
$page = (New-Object System.Net.WebClient).DownloadString("http://localhost/") 
```

感谢 Steven Murawski 的评论：

> 正如下面的两个答案所指出的那样，最好的方法实际上取决于您要完成的任务。 **WebClient**是最简单的，但 **HttpWebRequest**是最灵活的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-02-18T15:15:09.960

在 PowerShell 3.0+ 中，您可以使用[Invoke-WebRequest](http://technet.microsoft.com/en-us/library/hh849901.aspx)

```
$page = Invoke-WebRequest "http://localhost/" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T13:37:01.853

System.Net.WebClient 是简单 GET 请求的最简单方法。但是，如果您需要对表单执行 POST 请求，则需要使用 System.Net.HttpWebRequest。

# java - java中类之间的方法可见性

> ID：340562
> 
> 赞同：1
> 
> 时间：2008-12-04T13:25:01.317
> 
> 标签：java, visibility

在Java中（一般来说）有没有办法让一个类如此公开以至于它的方法等......可以从周围的小类访问，甚至不实例化它？哈，我的意思是......如果我有一个爸爸类，它有一个方法`draw()`，它实例化一个名为 Hand 的婴儿类和一个名为 Deck 的婴儿类，然后 Deck 实例化一个名为 Card 的婴儿类，它有一个方法`play()`，有没有办法`Play()`然后`Draw()`从爸爸班打电话？

这里的想法是......爸爸类说“Deck！play（card）！” 然后甲板说“卡！玩（）！” 然后play转身说：“嘿，爸爸！Draw()！”

PS这个想法是......在CCG中，每张卡都有一个不同的“play（）”方法，但它们基本上都以相同的方式调用。打牌的机会来了，你就打牌。但是卡本身并没有做任何内部的事情：不，不，它从游戏规则中调用了许多方法，这是可见的。所以，就像万智牌中的一张牌，上面写着“抓一张牌。对目标玩家造成一次伤害。” 正在调用 draw(player, 1) 和 dealDamage(player, 1) ，它们可能不在卡片本身中......因为它们会影响可能由玩家在开始游戏时实例化的变量，并就生命总数和规则等达成一致“画”是什么意思？

（元问题：像往常一样，有人可以重命名这个问题，以便它反映我的要求......作为一个初学者真是令人沮丧！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T13:34:43.120

当 Daddy 类实例化 Baby 类时，它（Daddy）可以将对自身的引用传递给 Baby 构造函数，从而使 Baby 可​​以访问其所有公共方法。

```
class Daddy {
    public foo(){...}
    public createBaby(){
        Baby baby = new Baby(this);
        // baby now has a reference to Daddy
    }
}

class Baby {
    Daddy daddy;
    public Baby(Daddy daddy){
        this.daddy = daddy;
    }
    ...
    public callDaddy(){
        daddy.foo();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T13:31:22.207

你可以：

*   通过构造函数传递对象引用。或者通过 getter 和 setter。或者直接给函数。
*   使用继承。
*   使用静态类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T13:37:55.517

从面向对象的角度来看，我会说使用继承。一种方法是创建一个不实现子类行为不同的方法的抽象类；并实现对所有子类行为相同的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T13:56:20.300

看起来您正在尝试实现某种[双重调度](http://en.wikipedia.org/wiki/Double_dispatch)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T13:57:13.387

您还可以定义内部和外部类。然后内部类可以访问外部类的所有字段。

```
public class OuterClass{
    int x
    private class InnerClass{
        InnerClass(){
            x = 10;
        }
    }
} 
```

However, you're probably going to be better off using either a Singleton pattern, where you have a static reference to a single resource (like the deck for most card games, although CCGs tend to have one per player), or else passing in the shared resource in the object's constructor. In the case of MTG or something similar, I'd probably give each card a cast() method that takes a Player and a list of targets. The Player is the caster, so a spell like Brainstorm could then invoke draw() on the Player to get them to draw cards, while a permanent spell could then assign itself under control of the Player. The targets then would be for any other targets the spell would possibly need and could potentially be null or the empty list (whichever you think is more appropriate).

# performance - 对网站进行压力测试的最佳方法

> ID：340564
> 
> 赞同：218
> 
> 时间：2008-12-04T13:25:54.667
> 
> 标签：performance, stress-testing, qa

这可能是一个错误的问题，但是，在 asp.net Web 应用程序上复制大量负载的最佳方法是什么？有没有一种简单的方法可以模拟特定页面上的许多请求？还是最好使用分析器跟踪单个请求，然后在性能正常的情况下从中解决？

了解 Web 应用程序与服务器规范的配合情况会很好。我希望能够在我的测试服务器上模拟大量流量，以便我可以确定生产服务器是否足够好（特别是 iis/asp.net 而不是 db 性能）。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2011-06-11T07:20:47.230

尝试到目前为止我发现的最好的[http://loadimpact.com](http://loadimpact.com)，但我找不到它的替代品。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-12-04T13:34:11.640

我的建议是让你先做一些自动化测试。使用[硒](http://docs.seleniumhq.org/)。

然后部署 selenium 网格在多台计算机上同时进行测试。

虽然 Selenium 作为一个自动化测试工具会运行得相当快，做一个迷你压力测试。如果您同时在网络上的几台计算机上运行相同的自动化，您将能够看到它的行为方式。

如果你想记录响应时间，他们有一个很酷的 api，你可以用它来编写一些脚本来运行你的自动化。

编辑：Selenium 非常易于使用，如果您想测试内容，它会断言页面内容。如果您愿意，它还会复制您在页面中的移动（这是我的建议），只需多次浏览页面，然后将其保存以供自动化使用。避免放置断言，这样 selenium 可能会运行得更快。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2008-12-04T13:33:35.540

[JMeter](http://jakarta.apache.org/jmeter/)就是这样一种工具。学习和配置可能有点困难，但通常是值得的。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-12-04T13:36:45.957

[ab](http://httpd.apache.org/docs/2.0/programs/ab.html) （apache bench）工具允许您向单个页面发送许多请求，并指定要使用多少个客户端以及需要多少个并发连接。

这可能是开发网站的第一步。只需测试一些具有特定负载的页面。这种基准测试方式可能存在一些问题，例如缓存被过度使用。

稍后您可能需要一个模拟一些具体流量而不是单个页面的工具。我还没有对此类工具的参考。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-04T13:45:00.260

也许[磨床](http://grinder.sourceforge.net/)会有所帮助？您可以通过线程和轻量级进程模拟并发请求或在多台机器上分发测试。我每次都成功地广泛使用它。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-04T14:08:27.187

我们尝试了一些应用程序，包括商业产品的试用和免费提供的产品。最终，我们试用的是[Team Test Load Agent](http://www.microsoft.com/downloads/details.aspx?FamilyID=572E1E71-AE6B-4F92-960D-544CABE62162&displaylang=en)软件的试用版。它绝对工作得很好，而且使用起来相当简单。从长远来看，它支持了我们迁移到 Team Foundation Server 并为部门的所有部分配备适当工具的论点。

然而，明显的缺点是价格。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-02-05T11:32:22.023

我已经将[WebLOAD](http://www.radview.com)用于此类项目。创建脚本很容易，并且它内置了对监视 ASP.NET 统计信息的支持

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-09-16T08:16:48.557

对于 Web 服务测试、soap rest 或 WCF（包括 WebHttpBinding），请试用 SOA Cleaner。可以从：http://xyrow.com[下载](http://xyrow.com)。有一个免费版本，它不需要任何安装。它还可以执行负载测试。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-05-16T12:24:23.983

我喜欢的另一个工具是 Open STA： http: [//opensta.org/](http://opensta.org/)

它主要专注于性能测试，并且是免费的。

**2018 年更新：**

由于答案很老，OpenSTA 项目似乎不是很活跃（但是该工具仍然可用），但现在我还推荐另外两个工具：

*   [加特林](https://gatling.io)“负载测试即代码”
*   [NeoLoad](https://www.neotys.com/neoload) “负载测试平台”

在我看来，Gatling 似乎更好，因为没有限制，他们还提供商业企业解决方案并适合 Jenkins 等持续集成工具。

相反，NeoLoad 有一个免费版本，但仅限于 50 个用户（在某些情况下就足够了）。完整的功能比较[在这里](https://www.neotys.com/neoload/pricing)。

# c# - 对使用 AES 加密进行 Zip 的廉价/免费 .NET 库的建议？

> ID：340568
> 
> 赞同：10
> 
> 时间：2008-12-04T13:26:54.337
> 
> 标签：c#, .net, vb.net, encryption, zip

我正在尝试找到[适合美国联邦政府使用的带有加密](http://www.networkworld.com/careers/2004/0315manonline.html)的 zip 压缩和加密组件，所以我不能使用 Zip 2.0 加密，它必须是 AES 或类似的。我已经找到了[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)（不能进行 AES 加密）和[Chilkat](http://www.chilkatsoft.com/downloads.asp)（可以进行 AES 加密，但要花钱）。我错过了任何其他选择吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-04T04:16:50.063

您愿意为 DotNetZip 中的 AES 支付多少费用？;)

DotNetZip 支持 AES 加密，具有 128 位或 256 位密钥。

[http://www.codeplex.com/DotNetZip](http://www.codeplex.com/DotNetZip)

示例代码：

```
 using (ZipFile zip = new ZipFile())
  {
    zip.AddFile("ReadMe.txt"); // no password for this entry

    // use a password for subsequent entries
    zip.Password= "This.Encryption.is.FIPS.197.Compliant!";
    zip.Encryption= EncryptionAlgorithm.WinZipAes256;
    zip.AddFile("Rawdata-2008-12-18.csv");
    zip.Save("Backup-AES-Encrypted.zip");
  } 
```

DotNetZip 生成的 AES 加密 zip 文件可以被 WinZip 读取和提取，反之亦然。

您也可以只创建没有加密的常规 zip 文件。

哦，它是免费的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T13:32:30.677

[如果钱是个大问题，你可以使用像http://www.codeplex.com/DotNetZip](http://www.codeplex.com/DotNetZip)这样的开源库，它现在支持 AES

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-04T13:32:45.090

[7-Zip](http://www.7-zip.org/)呢？它在 LGPL 下是开源的（因此应该可以在您的项目中使用），并且根据规范它支持带有 AES 加密的 ZIP。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T17:18:36.587

查看有关[Stream Pipeline](http://msdn.microsoft.com/en-us/magazine/cc163290.aspx)的这篇很棒的文章。它不仅定义了一种以多线程方式将流相互链接的酷方法，使用的示例是压缩后加密。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-17T13:14:00.347

您可以使用 #ZipLib ( [https://icsharpcode.github.io/SharpZipLib/](https://icsharpcode.github.io/SharpZipLib/) )，它是 DotNetZipLib 的轻量级替代品。

它提供了 FastZip 类，可将使用 AES 加密的 HDD 上的文件夹压缩减少到 2-3 行代码。

请参阅 wiki 以供参考： [https ://github.com/icharpcode/SharpZipLib/wiki/FastZip](https://github.com/icsharpcode/SharpZipLib/wiki/FastZip)

如果您需要更多功能，#ZipLib 会比 DotNetZipLib 复杂一点，但在我的情况下，后者会创建损坏的 ZIP 文件，所以我还是使用 SharpZipLib。

# visual-studio-2008 - Visual Studio 滚动条

> ID：340571
> 
> 赞同：2
> 
> 时间：2008-12-04T13:29:19.373
> 
> 标签：visual-studio-2008, resharper

我最近将 VS 2005 升级到 VS 2008。不幸的是，我有一个非常基本的问题：在 codeview 窗口中，我的垂直滚动条看起来不像普通的传统滚动条，而是某种代码预览窗口。它比普通滚动条宽四倍。问题是我的 ReSharper (4.1) 似乎不适用于这个滚动条。一旦我启用 ReSharper，滚动条就会冻结。关闭整个垂直滚动条也不是一种选择，因为我曾经有一个滚动条：/我真的很想摆脱这种新型滚动条并将其恢复为正常滚动条。有没有人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T13:35:53.320

您使用的是[RockScroll](http://www.hanselman.com/blog/IntroducingRockScroll.aspx)插件吗？如果是这样，请禁用它。 ![替代文字](https://www.hanselman.com/blog/content/binary/WindowsLiveWriter/IntroducingRockScroll_C29C/RockScroll_5.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T13:43:16.130

你已经安装了 RockScroll。- 尝试更新 RockScroll

[http://www.hanselman.com/blog/IntroducingRockScroll.aspx](http://www.hanselman.com/blog/IntroducingRockScroll.aspx)

如果不只是删除它

Scott 确实注意到 RockScroll 是 Works on my Machine 版本！

[呸！]

# calendar - 我的日历控件被切断

> ID：340572
> 
> 赞同：0
> 
> 时间：2008-12-04T13:30:08.403
> 
> 标签：calendar, controls, foreground

我有一个带有日历弹出窗口和其他功能的自己的控件。

我已将该控件放入另一个页面内容的网格中。

我现在的问题是，日历控件被切断了。所以我只看到日历的一半。我怎样才能把它带到前线？像普通的 DatePicker Control 一样？

**更新：**

我正在尝试构建的是类似`DatePickerControl`但具有更多功能的东西。到目前为止看起来还不错，控件本身工作正常，但是在内容区域中实现它会削减日历控件。当文本框具有焦点时，日历控件应该是可见的，我需要找到的是一种将日历放在前面以为控件创建叠加层的方法。如果有人知道如何做到这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T14:12:34.120

如果它是在 asp.net 网格中使用的日历控件，则为您的日历控件指定固定大小并相应地设置网格列的宽度。

# asp.net - .NET 中每个 SQL 语句的 SQL 存储过程？

> ID：340575
> 
> 赞同：3
> 
> 时间：2008-12-04T13:30:49.027
> 
> 标签：asp.net, database, stored-procedures

对 .NET 应用程序中的每个 SQL 调用都使用存储过程是最佳实践吗？

出于性能原因并减少 SQL 注入攻击的表面积（在 Web 应用程序中），是否鼓励这样做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-04T14:32:28.917

与参数化查询相比，存储过程有一些优点：

1.  *独占*使用时，您可以关闭应用程序帐户的 CREATE、INSERT、SELECT、UPDATE、ALTER、DROP、DELETE 等访问权限，这样可以增加少量安全性。

2.  当您有多个应用程序使用同一个数据库时，它们提供了一致的、可管理的界面。

3.  即使在部署应用程序之后，使用过程也允许 DBA 管理和调整查询。

4.  部署小的更改和错误修复要简单得多。

它们也有一些缺点：

1.  程序的数量会迅速增长到难以维护的程度，并且当前的工具没有提供足够的文档的简单方法。

2.  参数化查询将数据库代码放在使用它的位置旁边。存储过程将其分开，使得查找相关代码更加困难。

3.  存储过程更难版本化。

您需要为您的系统权衡这些成本/收益。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T13:32:44.577

不。

如果您将查询作为参数化查询发送到 SQL Server，SQL Server 将缓存执行计划并正确清理您的参数输入以避免 SQL 注入攻击。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-04T14:02:18.103

我更喜欢存储过程而不是内联 SQL，因为这样 SQL 是一个统一的地方；但是，我更喜欢使用像 nHibernate 这样的工具，它会自动为我生成 SQL，那么你就不用担心 SQL 了！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-04T14:54:35.177

还有一个优势 - 当涉及到调优时，尤其是针对每个客户，使用 SP 可以轻松完成（通过添加提示甚至重写代码）。使用嵌入式 SQL 几乎是不可能的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T13:39:19.790

这只是做事的一种方式。好处包括将所有 SQL 代码保存在一个地方，在创建时验证 procs 的语法，以及能够对 procs 设置权限，这通常代表某种“动作”并且非常适合概念安全模型。

缺点包括适用于任何中型或大型应用程序的大量 proc，以及随之而来的所有内务管理。

我雇主的产品在所有事情上都使用 procs，我必须说，只要有正确的做法，它是可以忍受的。

# .net - Application.Exit 没有杀死消息泵？

> ID：340576
> 
> 赞同：5
> 
> 时间：2008-12-04T13:31:20.320
> 
> 标签：.net, wpf, winforms, windbg

我有线程异常处理程序，它保存异常堆栈跟踪并应该关闭应用程序。我调用 Applicatoin.Exit，但这只会关闭窗口，让应用程序无窗口运行。

我知道，这通常是因为一些后台线程仍在运行。我将windbg附加到无窗口进程，似乎只有两个托管线程，其中一个看起来像gc终结器线程，第二个看起来像消息泵？？？有人明白这个吗？

调用 Application.Exit 和用户关闭主窗口之间有区别吗？

```
0:005> !线程
线程数：2
未启动线程：0
背景线程：1
待处理线程：0
死线：0
托管运行时：否
                                      PreEmptive GC 分配锁
       ID OSID ThreadOBJ State GC Context Domain Count APT Exception
   0 1 284 002e9668 6020 启用 021a7268:021a7fe8 002e4c68 0 STA
   2 2 d48 002f9890 b220 启用 00000000:00000000 002e4c68 0 MTA（终结器）
0:001> ~0 秒
*** 错误：找不到符号文件。默认为 C:\Windows\system32\MSCTF.dll 导出符号 -
eax=02162530 ebx=002e9668 ecx=02162530 edx=02162530 esi=0019ef9c edi=0019ee3c
eip=77589a94 esp=0019edcc ebp=0019ede8 iopl=0 nv up ei pl zr na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00000246
ntdll!KiFastSystemCallRet:
77589a94 c3 雷特
0:000> !clrstack
操作系统线程 ID：0x284 (0)
ESP EIP     
0019ef24 77589a94 [ComPlusMethodFrameGeneric: 0019ef24] MS.Win32.UnsafeNativeMethods+ITfMessagePump.GetMessageW(System.Windows.Interop.MSG ByRef, Int32, Int32, Int32, Boolean ByRef)
0019ef44 56d61937 System.Windows.Threading.Dispatcher.GetMessage（System.Windows.Interop.MSG ByRef，IntPtr，Int32，Int32）
0019ef90 56d617e3 System.Windows.Threading.Dispatcher.PushFrameImpl（System.Windows.Threading.DispatcherFrame）
0019efe0 56d616c7 System.Windows.Threading.Dispatcher.PushFrame（System.Windows.Threading.DispatcherFrame）
0019effc 56d6162d System.Windows.Threading.Dispatcher.Run()
0019f008 5533ddb0 System.Windows.Application.RunInternal（System.Windows.Window）
0019f034 5533dbe5 System.Windows.Application.Run（System.Windows.Window）
0019f044 5533d836 System.Windows.Application.Run()
0019f04c 01ea00ad UI.App.Main()
0019f268 79e7c74b [GCFrame: 0019f268]

```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T13:37:22.117

我解决了。我应该调用 System.Windows.Application.Shutdown()，而不是调用 System.Windows.Forms.Application.Exit()。消息泵线程属于 wpf，您可以从该线程的堆栈跟踪中看到它。

换句话说，System.Windows.Forms.Application.Exit() 不会关闭 WPF 消息泵。

# c# - windows xp 和 vista 任务栏上的工具栏

> ID：340601
> 
> 赞同：1
> 
> 时间：2008-12-04T13:37:57.280
> 
> 标签：c#, windows, windows-xp, toolbar

我已经制作了一个工具栏，我想从用 C# 编写的系统托盘应用程序启用它，实际的工具栏启用是使用 [DLLImport] 从 C++ 部分完成的。

当前我使用：

```
SHLoadInProc(__uuidof(MyBandLoader)) 
```

但这在 vista 上失败（不再实现 SHLoadInProc），以及在带有 IE6 的 Windows XP SP2 上（重新启动后快速启动工具栏消失）。

在 Vista 上，我尝试使用：CocreateInstance() 和 BandSite->AddBand()，但是使用工具栏 dll 的 guid 给了我一个分段错误或地址栏。

在 XP 和 Vista 上是否有另一种方法可以从另一个程序启用工具栏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T17:42:39.487

在 Vista 上，有一个新的文档记录不佳的界面，称为 ITrayDeskBand。

通过 CoCreateInstance 创建一个实例，然后在返回的指针上调用 ShowDeskBand([CLSID of your toolbar])（在 C++ 中 - 我不确定如何在 C# 中为 PInvoke 创建所有相关位 - 可能更容易编写一个简单的 C++ dll 来公开这个函数）

但这仅适用于 Vista，在 XP 上您需要继续使用上面的 SHLoadInProc 方法，因此您需要测试操作系统版本并执行适当的操作。

如果您从该 codeproject 文章中提取代码，请小心 - 它充满了微妙的错误，尽管其中许多在评论中进行了讨论

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-22T13:31:06.913

永远不要使用 .Net 在 Explorer 进程中创建任何 COM 对象。如果有另一个使用不同框架版本的 .net 组件已经加载到资源管理器进程中，这将不起作用。每个进程只有一个 .net 框架。MS 不应该用任何 .net 语言宣传有关开发桌带的示例。

在 Vista 上一个 up 的唯一方法是使用 ITrayDeskBand 界面来显示工具栏。但是，这将向用户显示一个确认框，他可以拒绝显示工具栏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T11:52:31.530

我用过那个，但它只告诉你必须制作一个工具栏，而不是如何从另一个程序启用它。

# c# - 使用 C# 的 SQL 的动态参数计数

> ID：340608
> 
> 赞同：2
> 
> 时间：2008-12-04T13:41:10.970
> 
> 标签：c#, sql, sql-server, linq-to-sql, stored-procedures

所以我正在考虑创建一个动态 sql 问题，这意味着我希望参数的数量是动态的。

看过这个：[参数化一个 SQL IN 子句](https://stackoverflow.com/questions/337704/parameterizing-a-sql-in-clause#337725)我认为使用 like '%x%' 很慢而且不好。

我实际上想做的是使用 IN 关键字并让它有点像这样：

从 NameTable 中选择 UserId，其中 Name IN (@List_of_names)

@List_of_names 可以包含的地方，即

*   菲利普·艾克伯格
*   菲利普
*   埃克伯格菲利普
*   埃克伯格
*   约翰·艾克伯格
*   约翰

（我的第二个名字是约翰，这就是它在那里的原因，））

所以所有这些都应该与 Johan Filip Ekberg 相匹配。

我想使用 C# 使用 LINQ to SQL 或 LINQ to SQL（存储过程）。

请提出建议和想法！

----------------- 场景和表格的清除 -------------------------

想象一下，我有以下内容：一个带有用户的表、一个带有名称的表和一个将名称连接到某个用户的表。

所以通过拥有

```
[User Table]
User ID   Full Name
1         Johan Filip Ekberg
2         Anders Ekberg

[Names]
Name ID   Name
1         Filip
2         Ekberg
3         Johan
4         Anders

[Connect Names]
Name ID   User ID
1         1
2         1
3         1
2         4
2         2 
```

所以如果我想寻找：Ekberg

回报应该是：

*   约翰·菲利普·埃克伯格
*   安德斯·艾克伯格

如果我想寻找 Johan Ekberg

*   约翰·菲利普·埃克伯格

如果我想寻找安德斯

*   安德斯·艾克伯格

“搜索名称”的数量可以是无限的，如果我有这个名字：Johan Anders Carl Filip Ekberg（这只是一个有很多名字的人）并且我只是传入“Carl Filip”，我想找到那个用户。

这会让一切变得更清楚吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T15:35:22.223

看起来 SQL 2008 是一个选项，因此传递表参数可能是您最好的选择。对于那些还不能迁移到 2008 年的人来说，另一种可能的解决方案是编写一个表值 UDF，它从分隔字符串生成一个表。然后你可以做这样的事情：

```
SELECT DISTINCT
     CN.user_id
FROM
     dbo.Names N
INNER JOIN dbo.Connect_Names CN ON CN.name_id = N.name_id
INNER JOIN dbo.GetTableFromNameList(@names) T ON T.name = N.name 
```

这将为您提供任何传递的名称与任何用户名称匹配的用户 ID。如果您想更改它以使其仅在所有传递的名称与用户名称之一匹配时才给出匹配，那么您可以执行以下操作：

```
SELECT
     CN.user_id
FROM
     dbo.Names N
INNER JOIN dbo.Connect_Names CN ON CN.name_id = N.name_id
INNER JOIN dbo.GetTableFromNameList(@names) T ON T.name = N.name
GROUP BY CN.user_id
HAVING COUNT(*) = (SELECT COUNT(*) FROM dbo.GetTableFromNameList(@names)) 
```

我还没有测试第二个查询，所以你可能需要摆弄它。此外，您可能希望创建一个本地表并用函数填充它，这样您就不必多次运行该函数。

如果需要，我可以将我自己的字符串版本发布到表函数中。此外，如果您想使用 LIKE 而不是完全匹配，您可以这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T13:49:57.210

我听说 SQL Server 2008 有一个称为表参数的功能，因此您可以将表作为参数传递给函数或存储过程。

在那之前，您可以使用经典：

```
SELECT UserId FROM NameTable WHERE CHARINDEX( '|' + Name + '|', '|Filip Ekberg|Filip|Ekberg Filip|') > 0 
```

这意味着列名可以是列表中的任何值。

您还可以通过 OPENXML 命令将 XML 参数传递到存储过程中，然后将其用作代码中的表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T15:07:22.763

你说你想用 IN ？IN 寻找完全匹配，所以如果你使用 IN('Ekberg')

你只会找到 Ekberg 而不是 Anders Ekberg。

如果您希望以上内容找到 Anders Ekberg，您需要 Like '%Ekberg'

事实上，在你的第二个例子中，你有名字 ABC 并且你通过 AC 你希望它找到 AB C。

真的，您希望在您通过的每个单词上都点赞。还有其他方法可以实现您所需要的。介意我首先询问您正在运行的数据库吗？：） 谢谢

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T16:32:24.353

来自类似的仅限 SQL 的问题：[SQL 查询：在多行上模拟“AND”而不是子查询](https://stackoverflow.com/questions/163887/sql-query-simulating-an-and-over-several-rows-instead-of-sub-querying#163907)

试试这个。

```
List<string> targets = new List<string>() {"Johan", "Ekberg"};
int targetCount = targets.Count;
//
List<Users> result = 
  dc.Names
    .Where(n => targets.Contains(n.Name))
    .SelectMany(n =>
      dc.ConnectNames.Where(cn => cn.NameId == n.NameId)
    )
    .GroupBy(cn => cn.UserId)
    .Where(g => g.Count() == targetCount)
    .SelectMany(g =>
      dc.Users.Where(u => u.UserId == g.Key)
    )
    .ToList(); 
```

这是徒手代码，因此其中可能存在一些语法错误。

# c# - 自动创建空的 C# 事件处理程序

> ID：340610
> 
> 赞同：74
> 
> 时间：2008-12-04T13:41:28.817
> 
> 标签：c#, events, delegates, clr

不可能在 C# 中触发没有附加处理程序的事件。因此，在每次调用之前，有必要检查事件是否为空。

```
if ( MyEvent != null ) {
  MyEvent( param1, param2 );
} 
```

我想保持我的代码尽可能干净并摆脱那些空检查。我认为它不会对性能产生太大影响，至少在我的情况下不会。

```
MyEvent( param1, param2 ); 
```

现在我通过手动为每个事件添加一个空的内联处理程序来解决这个问题。这很容易出错，因为我需要记住这样做等等。

```
void Initialize() {
  MyEvent += new MyEvent( (p1,p2) => { } );
} 
```

有没有办法使用反射和一些 CLR 魔法为给定类的所有事件自动生成空处理程序？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2008-12-04T13:44:15.223

我在另一篇文章中看到了这个，然后无耻地窃取了它并在我的大部分代码中使用它：

```
public delegate void MyClickHandler(object sender, string myValue);
public event MyClickHandler Click = delegate {}; // add empty delegate!

//Let you do this:
public void DoSomething() {
    Click(this, "foo");
}

//Instead of this:
public void DoSomething() {
    if (Click != null) // Unnecessary!
        Click(this, "foo");
} 
```

~~* 如果有人知道这种技术的起源，请在评论中发布。我真的相信消息来源会得到应有的信任。~~

（**编辑：**我从这篇文章[Hidden Features of C#? 中得到它？](https://stackoverflow.com/questions/9033/hidden-features-of-c#9282)）

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-12-04T13:53:10.557

符号：

```
if ( MyEvent != null ) {
  MyEvent( param1, param2 );
} 
```

不是线程安全的。你应该这样做：

```
EventHandler handler = this.MyEvent;
if ( null != handler ) { handler( param1, param2 ); } 
```

我明白，这很麻烦，所以你可以做辅助方法：

```
static void RaiseEvent( EventHandler handler, object sender, EventArgs e ) {
    if ( null != handler ) { handler( sender, e ); }
} 
```

然后调用：

```
RaiseEvent( MyEvent, param1, param2 ); 
```

如果您使用的是 C# 3.0，则可以将辅助方法声明为扩展方法：

```
static void Raise( this EventHandler handler, object sender, EventArgs e ) {
    if ( null != handler ) { handler( sender, e ); }
} 
```

然后调用：

```
MyEvent.Raise( param1, param2 ); 
```

您还可以为其他事件处理程序创建下一个扩展/帮助方法。例如：

```
static void Raise<TEventArgs>( this EventHandler<TEventArgs> handler,
    object sender, TEventArgs e ) where TEventArgs : EventArgs
{
    if ( null != handler ) { handler( sender, e ); }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-06-09T08:19:43.243

在 C# 6.0 中，由于有条件的 null 运算符，无需使用这些长度中的任何一个来进行 null 检查`?.`

[文档](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/null-conditional-operators)解释说，调用`MyEvent?.Invoke(...)`会将事件复制到临时变量，执行 null 检查，如果不为 null，则调用`Invoke`临时副本。这不一定在任何意义上都是线程安全的，因为有人可能在复制到临时变量之后添加了一个新事件，而该临时变量不会被调用。它确实保证您不会调用`Invoke`null 。

简而言之：

```
public delegate void MyClickHandler(object sender, string myValue);
public event MyClickHandler Click;

public void DoSomething() {
    Click?.Invoke(this, "foo");
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-04T13:44:39.920

你可以写成：

```
MyEvent += delegate { }; 
```

我不确定你想要做什么是正确的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-31T15:11:25.390

对于不同的事件处理程序，您不需要几种扩展方法，您只需要一种：

```
public static class EventHandlerExtensions {
  public static void Raise<T>(this EventHandler<T> handler, object sender, T args) where T : EventArgs {
    if (handler != null) handler(sender, args);
  }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-04T13:53:46.170

这是一个坏主意，因为使用该事件的代码现在期望带有该事件的对象已默认使用操作进行编码。如果您的代码永远不会被其他任何人使用，那么我想您可以侥幸逃脱。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-28T02:00:11.863

不幸的是，C# 事件声明包含许多众所周知的安全问题和低效率。[我在委托上设计了许多扩展方法来安全地调用它们，并以线程安全的方式注册/注销委托](http://higherlogics.blogspot.com/2010/12/sasa-v093-released.html)。

您的旧事件引发代码：

```
if (someDelegate != null) someDelegate(x, y, z); 
```

您的新代码：

```
someDelegate.Raise(x, y, z); 
```

您的旧活动注册码：

```
event Action fooEvent;
...
lock (someDummyObject) fooEvent += newHandler; 
```

您的新代码：

```
Action fooEvent;
...
Events.Add(ref fooEvent, newHandler); 
```

不需要锁定，没有编译器插入的用于锁定事件的虚拟对象。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-07-23T20:44:59.900

您可以使用 PostSharp 在构建时添加这个魔法。这是最好的方法。

# database - 代码控制下的数据库脚本的最佳实践是什么

> ID：340614
> 
> 赞同：23
> 
> 时间：2008-12-04T13:42:21.310
> 
> 标签：database, svn, version-control

我们目前正在审查如何在 subversion 中存储我们的数据库脚本（表、过程、函数、视图、数据修复），我想知道对于最佳方法是否有任何共识？

我们需要考虑的一些因素包括：

*   我们应该签入“创建”脚本还是使用“更改”脚本签入增量更改
*   我们如何跟踪给定版本的数据库状态
*   对于任何给定的发布版本，从头开始构建数据库应该很容易
*   数据库中是否应该存在一个表，列出针对它运行的脚本，或者数据库的版本等。

显然这是一个非常开放的问题，所以我很想听听人们的经验教会了他们什么。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-04T14:10:03.143

经过几次迭代，我们采取的方法大致是这样的：

每个表和每个存储过程一个文件。还要为其他事情分开文件，例如设置数据库用户，用他们的数据填充查找表。

表的文件以 CREATE 命令开始，并随着模式的发展而添加一系列 ALTER 命令。在测试表或列是否已经存在时，这些命令中的每一个都用括号括起来。这意味着每个脚本都可以在最新的数据库中运行，并且不会更改任何内容。这也意味着对于任何旧数据库，脚本都会将其更新为最新模式。对于空数据库，CREATE 脚本会创建表，并且会跳过 ALTER 脚本。

我们还有一个程序（用 Python 编写）扫描充满脚本的目录并将它们组合成一个大脚本。它解析 SQL 以推断表之间的依赖关系（基于外键引用）并适当地对它们进行排序。结果是一个怪物 SQL 脚本，它可以一次性使数据库达到规范。脚本组装程序还计算输入文件的 MD5 哈希，并使用它来更新写入列表中最后一个脚本的特殊表中的版本号。

除非发生意外，结果是给定版本的源代码的数据库脚本创建了该代码旨在与之互操作的模式。这也意味着有一个（有点大的）SQL 脚本可以提供给客户来构建新数据库或更新现有数据库。（这在这种情况下很重要，因为会有很多数据库实例，每个客户都有一个。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T14:43:14.403

这个链接有一篇有趣的文章： [https ://blog.codinghorror.com/get-your-database-under-version-control/](https://blog.codinghorror.com/get-your-database-under-version-control/)

它提倡基线“创建”脚本，然后签入“更改”脚本并在数据库中保留版本表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T13:55:28.507

我倾向于检查初始创建脚本。然后，我的数据库中有一个 DbVersion 表，如果需要，我的代码使用它在初始连接时升级数据库。例如，如果我的数据库是版本 1，而我的代码是版本 3，我的代码将应用 ALTER 语句将其带到版本 2，然后是版本 3。为此，我使用了一个简单的 fallthrough switch 语句。

这样做的好处是，当您部署应用程序的新版本时，它将自动升级旧数据库，您不必担心数据库与软件不同步。它还保留了一个非常明显的更改历史记录。

这对所有软件都不是一个好主意，但可以应用变体。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T13:53:17.373

您可以通过阅读如何使用[Ruby On Rails 的迁移](http://guides.rubyonrails.org/migrations.html)来获得一些提示。理解这一点的最好方法可能是自己尝试一下，然后手动检查数据库。

您的每个因素的答案：

*   存储 CREATE 脚本。如果您想检查版本 xyz，那么只需运行您的创建脚本即可立即设置数据库会很好。您*也可以*添加 ALTER 脚本以从上一个版本转到下一个版本（例如，您提交版本 3，其中包含版本 3 CREATE 脚本和版本 2 → 3 更改脚本）。
*   请参阅 Rails 迁移解决方案。基本上他们将表版本号保存在数据库中，所以你总是知道的。
*   使用创建脚本。
*   使用版本号可能是最通用的解决方案——脚本名称和路径会随着时间而改变。

我的两分钱！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T13:53:50.243

升级脚本选项

将数据库中的每个更改存储为单独的 sql 脚本。将每组更改存储在编号文件夹中。使用脚本一次应用更改一个文件夹，并在数据库中记录已应用的文件夹。

优点：全自动、可测试的升级路径

缺点：很难查看每个元素的完整历史记录 必须从头开始构建一个新数据库，遍历所有版本

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-16T01:09:24.780

我们在 Subversion 中创建了一个分支，并且下一个版本的所有数据库更改都被脚本化并签入。所有脚本都是可重复的，因此您可以多次运行它们而不会出错。

我们还将更改脚本链接到问题项或错误 ID，以便我们可以在需要时保留更改集。然后，我们有一个自动构建过程，它查看我们正在发布的问题项，并从 Subversion 中提取更改脚本，并创建一个 SQL 脚本文件，其中所有更改都经过适当排序。

然后使用这个单一文件来促进对测试、QA 和生产环境的更改。自动构建过程还创建记录版本的数据库条目（分支加上构建 ID。）我们认为这是企业开发人员的最佳方法。关于我们如何做到这一点的更多细节可以在[这里找到](http://www.digitaltools.com/ReleaseManager.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T14:00:28.593

我们公司签入它们只是因为有人决定将其放入我们所做的某些 SOX 文档中。这对我来说毫无意义，除非可以作为参考文件。我看不出有什么时候我们会把它们拉出来并尝试再次使用它们，如果我们这样做了，我们就必须知道哪个先运行，然后再运行哪个。备份数据库比保留 Alter 脚本更重要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-03T10:26:38.240

对于每个版本，我们需要提供一个 update.sql 文件，其中包含所有新的表脚本、更改语句、新/修改的包、角色等。此文件用于将数据库从 1 版本升级到 2。

我们在 update.sql 文件中包含的所有这些语句都需要转到各个文件。像 alter 语句必须作为新列进入表（必须修改表脚本，而不是在文件中创建表脚本后添加 Alter 语句）以相同的方式新表、角色等。

因此，每当用户想要升级时，他都会使用第一个 update.sql 文件进行升级。如果他想从头开始构建，那么他将使用已经包含上述所有语句的 build.sql，它使数据库同步。

sriRamulu Sriramis4u@yahoo.com

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-04T13:51:50.327

创建脚本选项：

使用创建脚本从头开始构建最新版本的数据库，除了默认的查找数据外，它是空的。

使用标准版本控制技术来存储、分支、标记版本并查看对象的历史记录。

升级实时数据库时（您不想丢失数据），在新版本中创建数据库的第二个空白副本并使用诸如 red-gate[链接文本之类的工具](http://www.red-gate.com/products/SQL_Compare/index.htm)

优点：以类似标准源代码的方式跟踪对文件的更改

缺点：依赖手动使用第 3 方工具进行实际升级（没有/很少自动化）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-15T13:51:10.033

就我而言，我为这项工作构建了一个 SH 脚本：[https ://github.com/reduardo7/db-version-updater](https://github.com/reduardo7/db-version-updater)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-03T17:17:57.590

开放式问题如何

就我而言，我正在尝试创建一些易于开发人员使用的简单的东西，我按照以下方案进行操作

我测试的东西：使用 GitlabCI 在 git 中进行基于文件的脚本处理

*   它不起作用，会产生冲突，管理部分必须手动完成，以防发生灾难，开发部分太复杂

*   通过 mysql 客户端使用权限和访问 对数据库的更改没有可追溯性，并且到生产的过渡是手动的

*   此处提到的程序的使用它们需要上传结构和许多调整，通常您最终会得到更改控制，就像这个词一样

*   存储库使用 无法控制 DRP 部分 我无法正确控制备份 我认为将备份放在同一台服务器上并不是一个好主意，并且您会为该过程生成高延迟

*   > > 这是最有效的

*   管理每个用户的权限并生成发送到数据库的所有内容的可追溯性

*   多平台

*   使用开发-生产-QA数据库

*   每次修改前始终支持

*   管理用于变更控制的开放存储库

*   多服务器

*   通过端点停用/激活对网页或应用程序的访问

*   最初的项目在：

*   > > 如果评论经理阅读了这部分，我理解自我推销，但请删除这部分并留下其余部分，因为我认为它符合帖子中对问题作出反应的答案...... [https://hub.docker .com/r/arelis/gitdb](https://hub.docker.com/r/arelis/gitdb)

我希望这能传达给你，因为我看到有几个

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-09-05T20:47:05.720

有一篇带有新 URL 的有趣文章：[https ://blog.codinghorror.com/get-your-database-under-version-control/](https://blog.codinghorror.com/get-your-database-under-version-control/)

它有点旧，但概念仍然存在。好读！

# usability - 子/嵌套网格的可用性

> ID：340619
> 
> 赞同：0
> 
> 时间：2008-12-04T13:44:26.940
> 
> 标签：usability

想要就我现在正在开发的 UI 功能达成共识。一般的想法是我有一个项目列表，你可以选择一个项目，并对其进行操作。目前，子功能被实现为浏览器弹出窗口。我们发现我们的用户通常不喜欢有大量弹出窗口。

因此，在这个新版本中，我正在考虑将功能从单独的弹出窗口移动到一个子网格中，您可以使用每个网格项进行扩展。但是，我担心这只是用一组可用性问题换另一组。我考虑过做经典的主/细节风格视图......但我个人真的不喜欢那些，因为你从选择主记录到处理细节的时间太远了。

那么……有没有人想分享任何想法、经验或想法？:-D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T13:54:25.843

我已经使用了您在网格中提到的场景。客户很高兴，我们注意到当颜色组合正确时，即使用户没有任何问题。我们使用了 Telerik 网格并为此提供了功能。

您可以在此处查看来自 Telerik 的演示：http: [//demos.telerik.com/aspnet-ajax/Grid/Examples/DataEditing/UserControlEditForm/DefaultCS.aspx](http://demos.telerik.com/aspnet-ajax/Grid/Examples/DataEditing/UserControlEditForm/DefaultCS.aspx)

让我知道它是否适合你？

拉姆吉

# keyboard-shortcuts - 用于快速调用层次结构的 Intellij 快捷方式

> ID：340622
> 
> 赞同：93
> 
> 时间：2008-12-04T13:45:26.750
> 
> 标签：keyboard-shortcuts, intellij-idea

是否有快捷键可以在快速菜单格式中调出与代码内联的方法的调用层次结构，而不是调出调用层次结构面板？

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2008-12-04T14:00:32.257

我不认为内联方法调用层次结构存在（如果我错了请赐教）。

*   `Ctrl`++在工具窗口`Alt`中`H`显示调用层次结构
*   `Alt`+`F7`打开对话框以查找用法
*   `Ctrl`+`F7`在同一文件中查找用法

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-12-04T13:50:56.443

如果您只想跳转到方法的调用者之一，`CTRL`++是要走的路`ALT`。`F7`在 Mac 上，使用：`Command`+ `Option`+`F7`

“帮助”菜单上有一个“默认键盘映射参考”

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-06-21T17:49:34.630

要完整：对于 Mac 用户

按`command`+ `alt`+`F7`

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-01-27T03:34:17.813

对于 Mac： ++`Ctrl`选择 “Callee Methods Hierarchy”会更好。`Option``H`

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-05-04T15:31:31.697

不要忘记，您始终可以使用`Command`++`Shift`进行动作名称搜索，`A`并搜索“呼叫”以及其他命令。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-10-23T15:08:45.807

*   **调用层次结构**：
    *   macOS：`^`+`⌥</kbd> + `H``
    *   窗户：`Ctrl`+ `Alt`+`H`
*   **查找用法**：
    *   苹果系统：`⌥</kbd> + `F7``
    *   窗户：`Alt`+`F7`
*   **声明**：
    *   从声明中，显示用法的下拉菜单
    *   从用法，跳转到声明
    *   苹果系统：`⌘</kbd> + `B``
    *   窗户：`Ctrl`+`B`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-03-20T11:45:31.630

`⌥` +`⌘</kbd> + `F7`

PS: Modified terms (e.g. no more `alt`) in newer Macs`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-24T11:12:28.297

**类型层次**有时也很有用（显示当前类的父类和子类）：

按`Ctrl`+`H`

# c# - 编程到接口。如何决定它需要在哪里？

> ID：340623
> 
> 赞同：10
> 
> 时间：2008-12-04T13:46:15.657
> 
> 标签：c#, .net, interface

我知道对接口进行编程有助于松散耦合。但是，是否有一个指南可以解释何时最有效？

例如，我有一个简单的 Web 应用程序，它收集有关员工的数据、他们的培训计划、费用并计算他们当年的费用等。这是一个相当简单的应用程序，我当然可以使用一个界面，但想知道是否会有任何利用。我会为了使用它而使用它。

总是可以争辩说，随着应用程序的复杂性增加并且我传递对象，传递类型（接口）比传递实现更有意义。那么，我应该等待应用程序变得复杂还是立即使用它？我想知道最佳实践可能会变成“这家伙做事已经结束了”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T14:13:59.220

如果您曾经对测试驱动开发感兴趣，那么“对接口编程”的需求就会变得很明显。如果您希望在隔离其依赖项的情况下测试一个类，则需要传递接口而不是对象。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-04T13:49:22.857

对接口进行编程的原因是为了使高级类与低级类的变化隔离开来。如果您完全不期望较低级别的类发生变化，那么在这种情况下*不*编程到接口是合理的。这篇[文章 (PDF)](http://www.objectmentor.com/resources/articles/dip.pdf)详细阐述了这个想法，创造了依赖倒置原则这个术语。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-04T14:00:39.513

一个让我对接口大开眼界的简单例子是这个

```
class SimpleClass
{
  public int A { get; set; }
  public int B { get; set; }
  public int C { get; set; }
}

List<SimpleClass> Calc(IEnumerable<SimpleClass> list)
{
  foreach(SimpleClass item in list)
  {
     item.C = item.A * item.C:
  }
  return list.ToList();
} 
```

注意 IEnumerable 输入参数。通过使用它，我可以传入任何实现 IEnumerable 作为 in 参数的集合。`List<SimpleClass>, SimpleClass[], Collection<SimpleClass>`.

IEnumerable 接口保证我可以使用 foreach 循环，这样我的函数就更通用了，我必须更改此代码的机会也更少，因为 IEnumerable 更改的机会小于 f.ex。列出更改。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-04T14:13:02.903

在您不打算交换实现的简单应用程序中对接口进行编程可能看起来有点矫枉过正。

当你进入单元测试时，你会很高兴能够针对接口进行编程，因为它使你能够更轻松地使用测试替身模拟真实对象。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-04T13:53:05.440

如果应用程序很有可能会变得更复杂，那么尽早设置脚手架比稍后设置更容易。但是，如果应用程序不复杂并且不太可能变得复杂，则投资回报率可能不存在。您可以随时重构。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T14:26:50.503

我通常是这样想的——只有两件事将接口与实现分开：

1.  一个对象可以继承多个接口，但只能继承一个基类；
2.  接口不允许默认实现，而基类允许。

现在考虑将从您的“结构”继承的对象。什么对他们来说更重要？他们会从方法的默认实现中受益最多，还是如果他们可以拥有其他基类会更好？

在大多数情况下，很清楚哪一个是更重要的因素。如果你碰巧在两者之间的细线上......运气不好。Microsoft[建议使用](http://msdn.microsoft.com/lv-lv/library/ms229013(en-us).aspx)基类而不是接口。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T14:46:46.597

对于任何属于 API 的内容，无论是外部客户还是其他重用您的代码的团队，都尽可能多地使用接口。这是值得的，因为它尽可能地隐藏了你的实现是如何工作的，并让你在未来有更大的自由来增强它们。只公开一个小的具体（可能是静态的）类，从中可以获取实例。

对于设计的内部部分，您可以选择从各处的具体类引用开始，并且只在对设计有意义的地方引入接口。

但另一个需要考虑的重要事情是单元测试。您可以在 CLR 中完全“模拟”一个界面而没有技术难度，但模拟其他事物要么是不可能的，要么需要一些严重的技巧。所以要考虑的一个学科是测试驱动开发：随着你的发展为你的代码编写测试，你会发现你需要通过接口来表达某些东西，这样你就可以提供它们的模拟版本。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T13:56:48.880

您必须将接口视为合同。本合同定义了签署本合同的人需要履行的一组规则和操作，无论它是如何完成的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-05T21:53:23.033

浏览《**Head-First Design Patterns** 》一书……您会看到使用与 TDD 或多态无关的接口的好论据。

接口允许您在运行时更改对象的行为......想想您需要处理特定行为的地方，但可能直到运行时才知道需要什么行为。在计算员工费用的情况下......经理可能比普通员工有更高的“娱乐”费用津贴。

如果您的 Employee 对象引用了 IExpenseCalculator 接口，您可以在运行时为其分配经理的计算器或员工的计算器。调用 Employee.GetExpenses() 将为经理提供与普通员工不同的计算结果。在内部，代码如下所示：

```
public class Employee {
  private IExpenseCalculator expenses;

  public ExpenseSheet GetExpenses() {
    return expenses.CalcExpenses();
  }
} 
```

此示例假定“费用”作为属性公开，并且 IExpenseCalculator 具有用于 CalcExpenses() 的方法。

接口也与对象工厂的概念密切相关……想想数据库层。将数据层配置为工厂后，您可以在运行时根据配置设置创建对象以动态连接到 Sql Server、Oracle 或 MySql。但是客户端需要数据库层对象的具体句柄...进入接口。

接口是一种强大的工具，但经常被滥用。正确使用它们将改变您的思维方式，但可以极大地帮助您的应用程序结构。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-04T15:41:04.707

如果您希望能够测试您的应用程序并且不必使用（并且随后不必构建）完整的员工对象，您可以创建 IEmployee 接口，然后创建轻量级测试友好的模拟员工对象以进行测试. 如果手动或没有数据库很难甚至不可能创建员工，这可能是一个很大的收获。

另一个很好的理由是它可以帮助您定义您在员工类别中所依赖的确切内容。您可能认为您只使用了几个公共方法，但后来发现您使用了 10 种方法并且它们比您想象的更紧密耦合。

最后，如果您需要更改代码以使用 SuperEmployee 而不是 Employee，如果您一直在使用接口，那么您需要做的就是让 SuperEmployee 实现 IEmployee，然后您就可以设置了。

# ruby - 你在 Ruby 中是把括号留在里面还是外面？

> ID：340624
> 
> 赞同：89
> 
> 时间：2008-12-04T13:46:18.637
> 
> 标签：ruby, coding-style, choice

如果可能的话..您是否在Ruby中留下或留下括号？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-12-04T23:51:38.023

来自[Ruby 风格的元素](https://web.archive.org/web/20100420090330/http://www.pathf.com/blogs/2008/10/elements-of-ruby-style/ "红宝石风格的元素")

> **Ruby 允许你省略括号，一般来说，抵制这种诱惑。**
> 
> 括号使代码更容易理解。一般 Ruby 风格是使用它们，但以下情况除外：
> 
> *   总是省略空括号
> *   括号可以不包含在由 ERb 分隔符包围的单个命令中——ERb 标记确保代码仍然可读
> *   可以不带括号编写作为单个命令和单个简单参数的行。就个人而言，我发现我这样做的次数越来越少，但它仍然完全可读。我倾向于不喜欢有多个参数且没有括号的常规 ruby​​ 代码中的单行。
> *   许多基于 Ruby 的领域特定语言（例如 Rake）不使用括号来为其语句保留更自然的语言感觉。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-12-08T15:52:50.967

我用parens作为评论来帮助未来的我......谁的脑细胞可能比现在的我少:-)

没有什么比查看您在 2 年前编写的一些代码并误解它更糟糕的了，以至于您在修改它时破坏了某些东西。

如果括号能在未来为我节省几分钟（或几小时）的时间，我会根​​据需要添加尽可能多的内容，以使声明一目了然。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-04T14:56:56.963

当我在做 DSL 的东西时，我把它们排除在外，比如 t.column 或 rails 中的 has_many。其余时间，它通常归结为清晰，而且可能是平分秋色。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-04T13:54:55.263

如果您的意思是在函数调用中，我总是加上括号，因为它总是更容易阅读。如果您的意思是条件（如果，同时），我只在必要时加上括号。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-04T13:52:53.880

我想我两者都做，但如果它增加可读性并避免看起来模棱两可的陈述，我肯定会保留它们。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-04T13:59:09.843

如果可能的话，我尽量把它们排除在外。我认为它使代码更容易阅读（一般来说）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-04T13:53:31.587

通常哪个更易读。

但是当我将函数调用嵌套在其他参数中时，我总是使用括号

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-08T01:49:14.587

在进行诸如 assert_equal 之类的断言时，我倾向于将它们排除在外。也许是让它成为特定领域的语言。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-11T16:04:40.710

如果您已经编程了很长时间，您可能会“痒”添加括号，并且在许多情况下有充分的理由。

在我看来，代码看起来更容易，而且我还没有遇到问题——如果你需要括号，在你必须运行调试脚本之前你会事先知道它。

# xml - 在 XSLT 中使用正则表达式

> ID：340627
> 
> 赞同：4
> 
> 时间：2008-12-04T13:49:16.320
> 
> 标签：xml, regex, xslt

我需要解析 Visual Studio 自动生成的 XML 文档来创建报告。我决定使用 XSLT，但我对它很陌生，需要帮助。常用模板为：

```
<doc>
  <members>
    <member name="F:MyNamespace">
      <summary>Some text</summary>
    </member> 
  </members>
</doc> 
```

我想隔离名称以某个单词开头的成员，例如 P:Interfaces.Core。我决定在 select 语句中使用 RegExp。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns:fn="http://www.w3.org/TR/xpath-functions/">
    <xsl:template match="/" >
        <html xmlns="http://www.w3.org/1999/xhtml">
            <body style="font-family:Tahoma">
                <p>Interfaces list:</p>
                <table>
                    <xsl:for-each select="doc/members/member">
                        <xsl:sort order="ascending" />
                        <xsl:value-of select="fn:matches(., 'P\..+')" />
                        <br />
                    </xsl:for-each>
                </table>
            </body>
        </html>
    </xsl:template>
</xsl:stylesheet> 
```

为什么我收到错误：

> 命名空间[http://www.w3.org/TR/xpath-functions](http://www.w3.org/TR/xpath-functions)不包含任何函数 >

我哪里错了？我在示例中找到了这样的代码，包括 w3c.org！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T14:59:22.373

**如果您使用 Visual Studio X 执行转换**，其中 X 不大于 2008，这将由[**XSLT 1.0**](http://www.w3.org/TR/xslt)处理器（.NET[**`XslCompiledTransform`**](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xslcompiledtransform.aspx)或[**`XslTransform`**](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xsltransform.aspx)）处理。XSLT 1.0 使用[**XPath 1.0**](http://www.w3.org/TR/xpath)，而不是[**XPath 2.0**](http://www.w3.org/TR/xpath20/)及其[**F&O**](http://www.w3.org/TR/xpath-functions/)（函数和操作），去年才成为 W3 推荐标准。

**你有两个选择**：

1.  *使用兼容的 XSLT 2.0 处理器*。如果您更喜欢留在 .NET 平台内，那么合适的选择是[**Saxon.NET**](http://saxon.sourceforge.net/)

2.  *只需使用 XPath 1.0 的功能* [**`starts-with()`**](http://www.w3.org/TR/xpath#section-String-Functions)，就足以解决当前的问题。如果上下文节点的字符串值以字符串 'P:Interfaces' 开头，则
    表达式：`starts-with(., 'P:Interfaces')`被评估，否则被评估。`true()``false()`

另一个对此类处理可能派上用场的 Xpath 1.0 函数是函数[**`contains()`**](http://www.w3.org/TR/xpath#section-String-Functions)。

Xpath 2.0 的功能[**`ends-with()`**](http://www.w3.org/TR/xpath-functions/#func-ends-with)可以通过以下方式在 XPath 1.0 中模拟：

`ends-with(s1, s2)`==== `substring`(s1, `string-length`(s1)- `string-length`(s2)+1)=s2

其中“ `===`”表示“等同于”。

这里我们还使用了 XPath 1.0 函数[**`substring()`**](http://www.w3.org/TR/xpath#section-String-Functions)和[**`string-length()`**](http://www.w3.org/TR/xpath#section-String-Functions).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T14:02:18.480

如果您只在 MS XML 中工作，您可以添加以您选择的 .net 语言编写的自定义函数。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms256042.aspx)上的示例（他们使用 JScript）。然后你可以使用正则表达式。

但是，您应该能够使用[starts-with](http://zvon.org/xxl/XSLTreference/Output/index.html) xslt 函数来完成您需要的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T14:01:02.117

这些函数来自 XSLT 2.0 中的 XPath 2.0。.NET XSLT 为 1.0，您的 xsl 命名空间反映了这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T14:07:16.067

然而，.net 有一个 outofjail.get() ：总是有可能将任务传递给[Extension Object](http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=64)。

不是很好的做法，因为它是 XSLT 的扩展，但有时您必须选择可行的方法。

# c# - 在没有名义类的 Silverlight 中绑定 XML

> ID：340645
> 
> 赞同：3
> 
> 时间：2008-12-04T13:55:01.317
> 
> 标签：c#, xml, silverlight, linq-to-xml, xml-binding

假设我有一个简单的 XML 块：-

```
<root>
   <item forename="Fred" surname="Flintstone" />
   <item forename="Barney" surname="Rubble" />
</root> 
```

在 Silverlight 中获取此 XML 后，我想将其与此类[XAML](http://en.wikipedia.org/wiki/Extensible_Application_Markup_Language)绑定：-

```
<ListBox x:Name="ItemList" Style="{StaticResource Items}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">           
                <TextBox Text="{Binding Forename}" />
                <TextBox Text="{Binding Surname}" />  
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

现在我可以简单地使用 LINQ to XML 和一个名义类进行绑定：-

```
public class Person {
     public string Forename {get; set;} 
     public string Surname {get; set;}
} 
```

没有这个类可以吗？

换句话说，Silverlight 代码和输入 XML 之间的耦合仅限于 XAML，其他源代码与项元素上的属性集无关。

**编辑**：建议使用 XSD，但最终它的数量相同。XSD->生成的类。

**编辑**：匿名类不起作用，Silverlight 无法绑定它们。

**编辑**：这需要有两种方式，用户需要能够编辑值并且这些值最终出现在 XML 中。（在上面的示例中将原始 TextBlock 更改为 TextBox。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T17:07:36.840

您可以使用 IValueConverter 执行此操作。这是一个简单的：

```
public class XAttributeConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        var xml = value as XElement;
        var name = parameter as string;
        return xml.Attribute(name).Value;
    }
} 
```

然后在您的 Xaml 中，您可以引用类型转换器并将属性名称作为参数传递：

```
<ListBox x:Name="ItemList">
    <ListBox.Resources>
        <local:XAttributeConverter x:Name="xcvt" />
    </ListBox.Resources>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Converter={StaticResource xcvt}, ConverterParameter=forename}" />
                <TextBlock Text="{Binding Converter={StaticResource xcvt}, ConverterParameter=surname}" />
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

这是当您绑定到 XElement 中加载的 xml 时：

```
XElement xml = XElement.Parse("<root><item forename='Fred' surname='Flintstone' /><item forename='Barney' surname='Rubble' /></root>");

ItemList.ItemsSource = xml.Descendants("item"); 
```

不是一个超级优雅的绑定语法，但它确实有效并且比映射到类更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-05T18:58:57.930

有关信息，请参阅*[绑定到 Silverlight](http://grahammurray.wordpress.com/2010/05/30/binding-to-anonymous-types-in-silverlight/)*中的匿名类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T14:24:57.903

据我所知，Silverlight 绑定缺少 WPF 中的 XPath 属性，因此没有直接绑定到 XML 的好方法。当我遇到这个问题时，我使用 xsd.exe 针对模式来生成我的类，然后使用 Xml 序列化来填充它们。这并不理想，但至少我不是自己编写和维护类和映射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T17:58:55.443

你能做一些类似于 Bryant 建议的使用匿名类的查询吗？

IE：

```
var data = from c in xml.Descendants("item")
                       select new  { Forename = c.Attribute("forename").Value, 
                                     Surname = c.Attribute("surname").Value };
ItemList.ItemsSource = data 
```

我认为这应该可行，但我无法测试它。如果没有，有人告诉我为什么，因为现在我很感兴趣。

# c# - 如何在 C# 中连接 WAV 文件

> ID：340646
> 
> 赞同：4
> 
> 时间：2008-12-04T13:55:03.080
> 
> 标签：c#, merge, wav

我有 2 个 wav 文件，我想将它们与两个音轨连接成一个文件。

是否有任何用于该任务的 api 或 .NET 中的一些内置命令，我可以以某种天才的方式使用这些命令来使该任务成为可能？

非常感谢您的帮助。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T14:48:36.670

如果我没记错的话，您可以将第二个文件中的字节附加到第一个文件的末尾。如果有任何标题数据，您需要排除它（请参阅[此处](http://filext.com/file-extension/WAV)）

请注意，您可能会听到两个剪辑之间的咔嗒声或爆裂声，因为不会有混合。您可能可以通过淡化（逐渐将最后几毫秒的值降低到中心值）来解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T19:56:31.103

如果您只需要这样做一次，那么最好的选择是使用一些专门用于该任务的软件。[Praat](http://www.fon.hum.uva.nl/praat/)或[Audacity](http://audacity.sourceforge.net/)会这样做（加入或合并两条轨道）。

Praat 也可以编写脚本，因此可以编写 Praat 脚本，然后从 .Net 应用程序中调用 Praat 和脚本。

抢

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-04T19:43:20.553

直接的方法是解释 wav 文件头，提取样本并将两个文件中的样本交织到一个新的样本流中，然后将其写入新的 wav 文件。您还可以逐个样本添加两个源 wav 文件的样本值，以将两个文件“混合”到一个轨道中。wav 文件格式并没有那么复杂，所以编写这段代码应该不会太难。此外，还有很多开源项目包含读写 wav 文件的代码。请注意，由于两个源 wav 文件具有不同的采样率，事情会变得有些棘手。检查[此](http://www-mmsp.ece.mcgill.ca/Documents/AudioFormats/WAVE/WAVE.html)以获取 wav 格式的描述。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-05-12T12:35:44.657

是的，您可以将第二个 wav 的数据（不包括其标题）附加为 sais Jon B，但您还必须修改第一个文件的标题以指示新长度，否则某些音频播放器将在第一个结束时停止部分。

对于动态连接，由于您不知道开头总 wav 的大小，您可以在第一个文件的标题上放置一个假长度，例如放置 10 小时的持续时间。

然后音频播放器应该等到您附加每个数据。它至少适用于ffmpeg

# flash - Actionscript - 从左到右滚动图像

> ID：340651
> 
> 赞同：1
> 
> 时间：2008-12-04T13:56:40.813
> 
> 标签：flash, actionscript-2, gallery

我制作了一个 Flash 库，可以从 xml 文件加载图像并将它们淡入淡出。但是我被要求让它从左到右淡入（即隐藏一点图像，同时慢慢地显示整个图像）。代码如下：

```
_root.onEnterFrame=function () {        

        var picLoaded = thisLoader.getBytesLoaded(), picBytes = thisLoader.getBytesTotal();

        if (isNaN(picBytes) || picBytes < 4)
            return;

        updateLoader( (picLoaded/picBytes)*100 );

        if ( picLoaded / picBytes >= 1 ) {
            endLoader();
            setButtonOn( eval("_level0.NavContainer.btnContainer.btn_"+(currentPicture)+".lbl_"+(currentPicture)) );
            centerMovie( thisLoader );
            swapPlace();
            alphaTween = new mx.transitions.Tween(thisLoader, "_alpha", mx.transitions.easing.Regular.easeIn,0,100,2,true);
            timerInterval = setInterval( imageGen, hold*1000 );
            updateDescription();
            lastPicture = ( currentPicture > 1 ? currentPicture - 1 : 1 );
            currentPicture = ( currentPicture == maxPicture ? 1 : currentPicture + 1 );
            if( maxPicture>1 ){
                eval("_container.movie"+( showing == 2 ? 1 : 2 ))._alpha = 0;
            }
            btn_previous.enabled = true;
            btn_next.enabled = true;
            delete this.onEnterFrame;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T16:29:56.467

您可以创建具有渐变 alpha 值的蒙版，然后使用补间动画在图像上移动它。使用正确的混合模式，这将使它像你想要的那样淡入。

# c# - 任何域对象都应该是不可序列化的吗？

> ID：340657
> 
> 赞同：3
> 
> 时间：2008-12-04T13:58:18.923
> 
> 标签：c#, .net-3.5, serialization, c#-3.0

有没有办法告诉编译器，我希望我的对象默认是可序列化的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T21:38:55.670

几乎每个序列化引擎都想知道您的对象是否合适。这可以采取以下形式：

*   `[Serializable]`/ `ISerializable`( `BinaryFormatter`, `SoapFormatter`)
*   `[Serializable]`/ `IXmlSerializable`(和`public`) ( `XmlSerializer`)
*   `[DataContract]`/ `[MessageContract]`（或以上大部分）（`DataContractSerializer`和变体）

AFAIK，没有办法避免这一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T14:04:37.053

不，您需要使用 Serializable 属性来装饰对象。仅供参考，默认情况下所有对象都是 Xml 可序列化的。Xml 序列化程序不需要该属性。

我不确定 DataContracts 但最后我检查了你是否也需要装饰它们。

# flash - 使用 Flash 显示 SVG 渐变？

> ID：340658
> 
> 赞同：2
> 
> 时间：2008-12-04T13:58:24.023
> 
> 标签：flash, svg, linear-gradients, gradient, radial-gradients

我正在使用 AS3 (Flash)**读取 SVG 文件**并**显示**它们。问题是正确显示**线性/径向渐变。**

以下是SVG 中从**Red**到**Blue的简单****线性渐变**示例。

 ****```
<linearGradient id="GRADIENT_1" gradientUnits="userSpaceOnUse"
x1="107.3938" y1="515.5684" x2="105.2488" y2="428.8614"
gradientTransform="matrix(0.9988 0.0485 0.0485 -0.9988 0.8489 711.6634)">

    <stop  offset="0" style="stop-color:red"/>
    <stop  offset="1" style="stop-color:blue"/>

</linearGradient> 
```

我已经能够从渐变中读取**颜色**（stop 的样式），以及它们在渐变中的**间距**（stop 的偏移量）。

好的，所以现在我有了一个**很好的渐变**，**颜色****正确，它们之间的空间量**也恰到好处，但**没有旋转或缩放**，而且它**的位置不正确！**.

答案是将[矩阵**输入**](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/geom/Matrix.html#createGradientBox())到 Flash 的渐变函数中。

* * *

### 方法 1：使用提供的矩阵

SVG**[提供](http://www.w3.org/TR/SVG11/coords.html#TransformMatrixDefined)**的矩阵， [**gradientTransform="matrix(a,b,c,d,e,f)"**](http://www.w3.org/TR/SVG11/coords.html#TransformAttribute)似乎实际上没有用，因为当您将该**矩阵**输入 Flash 的[**beginGradientFill() 函数**](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Graphics.html#beginGradientFill())时，它会显示在形状上**拉伸**的渐变如此之多，以至于只有渐变的中心颜色可见，就像实心填充一样。

* * *

### 方法 2：使用 2 个梯度点生成矩阵

*   **x1, y1**标签可能是屏幕上**渐变开始的点**。
***   **x2、y2**标签可能是屏幕上**渐变结束**的点。**

 ****当我说“2 个渐变点”时，我指的是 x1,y1 和 x2,y2，它们主要告诉您渐变**在形状上的**哪个位置**开始和结束。**

有一个[**Matrix.createGradientBox()**函数](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/geom/Matrix.html#createGradientBox())，它创建一个用于渐变的矩阵，但参数与 SVG给我的参数**非常不同。**它想要：

1.  **宽度**--- 这里使用了 2 个渐变点之间的相对距离（X 轴）
2.  **高度** --- 这里使用了 2 个渐变点之间的相对距离（Y 轴），*但得到了不正确的结果*--- 也尝试了这里使用**2 个渐变点之间的距离**，但我不知道在宽度中填充什么！
3.  **旋转角度**——使用了 2 个渐变点的角度，以弧度为单位，*结果不正确！*
4.  **翻译 x** -- 尝试了第一个梯度点的 X，也尝试了 0，*结果不正确！*
5.  **平移 y** -- 尝试了第一个梯度点的 Y，也尝试了 0，但*结果不正确！*

* * *

## 我可以使用哪些 SVG 数据为 Flash 生成渐变矩阵？

**（看看上面的 SVG 片段，**这就是我描述渐变的所有数据）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T11:30:56.613

## 如何使用 2 个渐变点绘制线性渐变

1.  **x1,y1 和 x2,y2是****屏幕坐标空间**上的 2 个点，渐变将从那里绘制到。
2.  使用SVG 提供的**变换矩阵来****偏移 x1,y1 和 x2,y2 点。**-- *gradientTransform="矩阵(a,b,c,d,e,f)*
3.  绘制从 x1,y1 到 x2,y2 的渐变。

*IE*

> x1, y1, x2, y2 表示坐标系中的值，该值是由于 在渐变元素的时间为引用渐变的元素（通过“填充”或“描边”属性）**采用当前用户坐标系而产生的**引用，**然后应用属性 gradientTransform 指定的变换。**

通过[W3C 文档](http://www.w3.org/TR/SVG11/pservers.html#GradientStops)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T17:22:16.717

## SVG渲染引擎！

[也许这里](https://stackoverflow.com/questions/58910/converting-svg-to-png-using-c#58912)有一些可以提供帮助的答案。

# .net - 如何在多进程系统上使用单个进程进行调试？

> ID：340662
> 
> 赞同：1
> 
> 时间：2008-12-04T14:00:27.080
> 
> 标签：.net, visual-studio, multithreading, debugging

我的开发机器是一个四核系统，但我刚刚遇到（而且我还在调试），当我的应用程序部署到单处理器系统时出现问题。我得到一个死锁。

我希望能够仅使用单个处理器进行调试，而不必构建开发 VM 进行调试。

是否可以告诉 Visual Studio 在运行调试会话时仅使用单个处理器，或者是否有任何工具可以帮助查找死锁。

一般来说，我想在同一台机器上测试单核和多核场景，我正在寻找提示、技巧和工具。

我应该提到我正在使用 .NET 3.5 SP1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T14:03:46.743

更改进程的 CPU 亲和性应该可以工作。有一个用于此目的的 WinAPI 函数[SetProcessAffinityMask](http://msdn.microsoft.com/en-us/library/ms686223.aspx)，对于一次性的事情，您还可以使用任务管理器来更改给定进程的亲和力。

# entity-framework - 为实体框架拆分 EDMX - 将对象层拆分为单独的文件 - 可能吗？

> ID：340673
> 
> 赞同：2
> 
> 时间：2008-12-04T14:02:54.203
> 
> 标签：entity-framework

是否可以将拆分 edmx 的 objectlayer.cs 中的部分类分解为每个类的文件？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-22T17:39:06.627

到目前为止，大多数答案似乎都在讨论将 EDMX 拆分成各个部分。从您的问题看来，您想将生成的类分解为单独的文件。目前不支持此功能，但您可以在 4.0 中使用带有 EF 的 T4 模板来实现。您已经可以使用 Damien Guard 的用于 LINQ to SQL 的 L2ST4 模板来执行此操作。

吉姆·伍利

www.ThinqLinq.com

# operating-system - 创建自定义操作系统的障碍

> ID：340674
> 
> 赞同：19
> 
> 时间：2008-12-04T14:02:57.760
> 
> 标签：operating-system, osdev

在我看来，程序员（尤其是 Comp. Sci. grads）试图解决的最常见的过于雄心勃勃的项目是构建自己的操作系统。（尝试创建自己的编程语言 + 编译器可能更常见，但远没有那么雄心勃勃。）

对于那些（像我一样）愚蠢到尝试尝试的人：除了庞大的规模之外，**您在尝试从头开始创建自己的操作系统时遇到****的最大*问题或意外障碍是什么？***

**编辑：**一个很棒的操作系统问题：[操作系统开发入门有哪些资源？](https://stackoverflow.com/questions/43180/how-to-get-started-in-operating-system-development/)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-04T14:40:42.007

能够从实际经验中说话（[AROS](http://www.aros.org/)，最大的障碍是：

*   母鸡和鸡蛋（没有操作系统 <-> 没有应用程序 <-> 没有用户 <-> 无法吸引开发人员）
*   为什么还要尝试与 Windows 竞争？苹果没有成功，他们有很多钱，Linux 也没有成功，尽管有一个庞大而热情的社区。
*   大公司根本没有兴趣将他们的应用程序带到您的操作系统（Adobe Acrobat Reader、MS Office、Macromedia Flash、Sun 的 Java）。没有这些，也没有好的 OSS 替代品，就无法吸引用户。
*   这需要很长时间。就我而言，获得 1.0 大约需要 15 年（我们还不是 100%）。
*   兼容性。为了获得任何用户，您必须与现有的东西兼容（以便人们可以继续使用他们的数据等）。如果您兼容，为什么要更改*您的*操作系统？

所以如果你打算编写自己的操作系统，你应该考虑这个：

*   这将需要很长时间
*   在最长的时间里，你将是一个人。我很幸运，因为我有一个非常狂热和专注的 Amiga 社区，它不会松懈。
*   您必须找到一个可以提供其他操作系统无法提供的服务的利基市场。
*   能做到这一点的人通常会得到更好的工作机会，因为人们认为“编写操作系统很难”:)
*   您将成为一小群精英程序员中的一员，他们可以说“我编写了自己的操作系统，它可以做的不仅仅是打印‘Hello world！’”

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-21T20:59:25.973

去过也做过。至少对我来说，最大的障碍是设备驱动程序。对操作系统内核进行编码是“有趣的部分”，但是如果不能进行 I/O（至少是磁盘、键盘、视频、网络），它就毫无用处。今天，如果我再次有时间和意愿参与这样的项目，我可能会瞄准 Xen VM 而不是原始硬件——如果没有别的原因，那么因为它隐藏了 x86 和硬件的许多丑陋特质。Xen 提供了一个很好的统一的、独立于硬件的 I/O 设备视图，并且仍然给您足够的自由来玩“有趣的”操作系统部分（mm、进程管理、同步、中断等）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-05T18:48:43.453

最大的路障？我认为这是当您发现规范中有多少差距以及各种实现中有多少错误时。

说真的，即使您拥有所有组件的所有规格（即 USB、DMA、IRQ、您的 CPU ......），您也会发现 a) 有些东西没有指定（即如果您发送某个序列到您的 USB 设备）和 b）有些东西只是被窃听了，您需要解决它们（即英特尔和 AMD 发布的 CPU 勘误表中详细说明的 CPU 中的数十个错误）

我不知道现代操作系统中有多少错误解决方法，但由于 Linux 和 *BSD 是开源的，它们的驱动程序会告诉你很多，即[这个](http://kerneltrap.org/mailarchive/freebsd-hackers/2007/11/1/377849). [并期望得到像这样](http://www.linux-magazine.com/online/news/opensuse_11_1_beta_can_damage_intel_e1000e_network_cards)的一些严重的负面副作用。

所以，是的，如果您尝试编写操作系统，请准备好诅咒硬件制造商并开始对现代 PC 的质量失去信心 :-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-05T18:38:28.170

我认为现在很多本来是优秀程序员的人都不知道他们对计算机的工作原理知之甚少。您需要认真掌握基础知识才能让机器从磁盘引导您的操作系统，而如今这种类型的知识传播得非常少。现在你也找不到关于它的书架。

有趣的是，几周前我问了一个关于 SO 的问题，其中涉及 10 到 15 年前严肃 PC 编程的基础知识类型，一位评论者说他们认为这是一个*硬件*问题。

我根本没有敲他们，但我认为这是对技能如何变化的有趣反思。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-18T21:12:03.733

我认为到目前为止，最大的障碍是用户——在你构建了大部分工作系统之前，你不太可能拥有任何用户。没有用户，您就没有功能请求、错误报告，因此动力有限。但是，即使您确实构建了一个可以工作的操作系统，也不能保证您会获得用户群，除非您能找到一个吸引人们的钩子 - 是什么让您的操作系统与众不同，让人们愿意尝试测试版，坚持下去当几乎没有任何工作应用程序移植到它时，等等。

您可能有兴趣查看[SkyOS](http://skyos.org/?q=node/407) - 它主要由单个开发人员（现在是一个小型开发团队）开发。维基[百科的文章](http://en.wikipedia.org/wiki/SkyOS)也有很好的总结。我认为这是一个很好的例子，说明如何可以承担如此艰巨的任务并取得相当好的结果。他们用 SkyOS 做了一些有趣的事情，看到这在很大程度上来自一个人在业余时间的努力，这特别酷。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T15:46:20.950

编写操作系统会遇到与其他大型软件项目相同的问题。

它缺乏明确定义的目标，并且由于缺乏经验而存在时间表/估计问题。

程序员首先创建一个“hello world”类型的操作系统也是有用的，这样他/她就可以学习操作系统开发背后的概念，然后可以专注于开发操作系统（而不是学习操作系统概念）。

# c# - 无法在 Vista x64 的 C# 应用程序中加载 C++ DLL

> ID：340687
> 
> 赞同：1
> 
> 时间：2008-12-04T14:07:19.140
> 
> 标签：c#, c++, dll, side-by-side

我有一个用 C++ 编写的 DLL，需要由 C# 中的应用程序使用。它在 Vista x86 下运行良好，但在 x64 下无法加载。因此，我构建了 DLL 的 x64 版本，并检测操作系统是 x86 还是 x64，并对适当的 DLL 使用适当的互操作调用。这在 Vista x86 下工作正常，但在 Vista x64 下，当它尝试加载 DLL 时出现“并排”错误。为什么它无法加载它，可以做些什么来纠正这个问题？（如果您需要更多信息，请告诉我，我不确定哪些信息与解决此问题相关。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T14:19:27.273

第一个想法：您能否尝试将项目的 C# 部分中的“平台目标”设置为“x86”，看看它是否会在 Vista 64 机器上以 32 位兼容模式运行？

有关 SxS 错误的更多信息会很有用 - 它可能与未安装的某些特定（32 位？）运行时库版本有关？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T14:48:53.750

MadKeithV 答案的一些进一步信息：

在 Windows x64 中，进程可以作为 32 位或 64 位进程启动。64 位进程只能加载 64 位 dll，32 位进程只能加载 32 位 dll。

如果您的 .Net 应用程序的平台目标（例如在项目属性中指定）设置为“任何 CPU”，则中间代码将根据目标平台编译为 32 位或 64 位代码，即在 x64 系统上，64 位代码将被生成。

因此，代码无法再加载 32 位 dll。

如果您的代码加载非托管程序集，您应该始终明确指定目标平台。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T14:55:16.797

如果没有其他工作..你可以试试[Process Monitor 。](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)它向您显示未找到哪个文件（依赖项）..这可能会给您带来继续进行的机会。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T20:41:31.497

需要在客户端计算机上安装适用于 x64 的 VC90 的 redist。就清单而言，我认为您可以对其进行更改以删除 processorArchitecture 标记。要么，要么让它说“任何”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T14:52:49.610

并排错误更可能是由您的 c++ dll 清单文件设置引起的，或者它们没有被嵌入，或者您选择不嵌入清单并且正在使用 32 位版本的清单。

简单的解决方案是将您的 c# 应用程序标记为 x86 杯并使用 32 位 dll 运行。

# .net - Asp:TextBox and VNI-Times, 越南文字问题

> ID：340689
> 
> 赞同：1
> 
> 时间：2008-12-04T14:08:23.460
> 
> 标签：.net, asp.net, encoding, localization, text-editor

我需要能够允许用户在文本框中输入越南语文本。

我被指示使用 VNI-Times 并提供了一个带有越南文本的示例 word 文档。

当我将示例文档中的文本粘贴到文本框中时，它的编码不正确。我尝试在我的机器和服务器上安装字体（VNI-Times），并更改浏览器的编码，但均无济于事。此问题不仅限于浏览器，还限于记事本。

到目前为止，我找到了一种解决方案，在页面上放置了一个所见即所得的编辑器，但我希望使用 asp:TextBox 控件。

用户提交文本后，它会显示为服务器生成的图像，这些图像也没有正确生成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T20:30:50.140

需要在服务器 (Windows Server 2003) 上安装亚洲语言包。

将服务器迁移到 Windows Server 2008 后，安装 VNI-Times 字体就足以解决此问题。

这也允许正确生成图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T15:18:12.557

该问题与使用剪贴板复制文本有关。当您将非 Unicode 文本文件中的文本复制到假定 Unicode 的文本框时，没有编码转换并且字节字符串被​​错误地查看。你会用键盘直接在输入控件（asp:TextBox）中输入越南语文本吗？

诀窍是在开始复制和粘贴之前将文本文档转换为 Unicode。确保首先转换示例 Word 文档，并且输入控件将正确显示文本。

[http://vietunicode.sourceforge.net/howto/unicodeconversion.html](http://vietunicode.sourceforge.net/howto/unicodeconversion.html)

# c - 您可以静态编译 cygwin 应用程序吗？

> ID：340696
> 
> 赞同：25
> 
> 时间：2008-12-04T14:09:12.473
> 
> 标签：c, linker, cygwin

cygwin 是否允许静态编译的二进制文件？这将防止 cygwin1.dll 出现在目标机器的 PATH 上。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-04T14:14:16.207

不，目前无法静态链接到 cygwin1.dll；如果您的应用程序不使用 unix 仿真（即纯 win32），您可以将 -mno-cygwin 传递给编译器。

另请参阅常见问题解答： http:
[//cygwin.com/faq/faq.html#faq.programming.win32-no-cygwin](http://cygwin.com/faq/faq.html#faq.programming.win32-no-cygwin)
[http://cygwin.com/faq/faq.html#faq.programming.static-linking](http://cygwin.com/faq/faq.html#faq.programming.static-linking)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-12-09T02:56:22.243

Cygwin 的 GCC 不再支持`-mno-cygwin`.

尝试改用 mingw-gcc，例如[Cygwin FAQ](https://cygwin.com/faq/faq.html#faq.programming.win32-no-cygwin)`x86_64-w64-mingw32-gcc`中提到的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-19T18:14:26.377

对于安装了 mingw32 的 Cygwin，您的命令行将采用以下形式

```
x86_64-w64-mingw32-gcc.exe main.c -o main.exe 
```

这完全绕过了对 cygwin1.dll 的需求。

# shell - Clearcase 多文件重命名

> ID：340706
> 
> 赞同：2
> 
> 时间：2008-12-04T14:12:05.637
> 
> 标签：shell, cygwin, clearcase

我在 ClearCase 目录结构中有大量文件，我需要将所有“makefile”更改为“Makefile”。我正在考虑该`find . -name makefile`命令与 exec 标志的某种组合，但我很难提出 exec 命令。cleartool mv 命令不会自动签出目录，所以我需要先签出然后再执行 mv。但据我所知，我唯一需要使用的是 %CLEARCASE_PN% 符号，它为我提供了完整的路径名。所以我需要从中解析出目录。我希望比我更擅长 shell 的人能比我想办法更快地提出正确的命令。

我在这里可以使用 cleartool、Windows cmd 和 Cygwin。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T14:20:43.043

我猜你的 cygwin 环境中有 bash 。如果你这样做了，你可以使用这个对上一个问题的[答案](https://stackoverflow.com/questions/284662/how-do-you-normalize-a-file-path-in-bash#284671)编写一个小的 bash 脚本，如下所示：

```
#!/bin/bash
FILE=$1
DIR_NAME=$( dirname $FILE )
FILE_NAME=$( basename $FILE )

#checkout directory $DIR_NAME with whatever the cleartool command is
#rename with cleartool $DIR_NAME/$FILE to $DIR_NAME/new_name

/usr/atria/bin/cleartool checkout -nc $DIR_NAME; 
/usr/atria/bin/cleartool mv $DIR_NAME/$FILE_NAME $DIR_NAME/Makefile; 
```

然后调用脚本：

```
find . -name orig_name -exec myscript.sh {} \; 
```

警告：

*   已经签出的目录在再次签出时会触发错误消息（可以忽略）
*   您必须在此过程中签入所有签出的目录，否则没有人会看到移动的结果（访问当前视图的除外）

# asp.net - ASP.NET jQuery - 绑定控件

> ID：340708
> 
> 赞同：0
> 
> 时间：2008-12-04T14:12:37.240
> 
> 标签：asp.net, jquery, gridview, autocomplete

我想将 jQuery 与包含文本框的 GridView 一起使用，但我一直坚持如何为所选行上的每个文本框注册事件侦听器。我在想我可以在 GridView 的 Unload 事件中使用 StingBuilder 做一些事情，但我无法让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T14:41:29.057

为什么不给每个 TextBox 添加一个 CSS 类并使用 jQuery 选择器来查找它们呢？

```
<asp:GridView runat="server">
  <Columns>
    <asp:BoundField ControlStyle-CssClass="someclass" DataField="xxx" />
  </Columns>
</asp:GridView> 
```

那你应该可以做...

```
$().ready(function() {
  $(".someclass").function() {
   //do something interesting
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T14:53:57.407

如果您有很多文本框（听起来像您这样做），最好将事件委托给某个父容器，而不是附加大量事件（事件委托） 从[这里开始阅读](http://www.danwebb.net/2008/2/8/event-delegation-made-easy-in-jquery)

# version-control - Other uses of version control than for code?

> ID：340717
> 
> 赞同：7
> 
> 时间：2008-12-04T14:14:19.110
> 
> 标签：version-control, reusability

Seeing this: [http://www.suckless.org/wiki.html](http://www.suckless.org/wiki.html). A wiki based on Mercurial. Are there any other non-code related use to version control? Is there any other projects that uses version control tools inside instead of programming their own specific solution?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-04T14:16:27.077

A couple that come to mind

1.  Documentation
2.  specifications
3.  test databases

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T14:24:49.337

Simple bug-tracking system with a file per bug, folder structure to handle an statuses and naming convention for simpler searching.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-04T14:16:42.210

Putting `/etc` or other configuration directories/files under Version Control can be useful when done correctly.

Also some people like to [put their home directory under version control](http://joey.kitenet.net/svnhome/).

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-04T14:20:52.763

Going further down the "non-code" path, how about GTD?

If you keep your tasks, contexts, next actions, etc. in plain text, you could use version control to maintain and replay your project activities. The commit log(s) could provide a nice activity summary if you have to report such things.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-04T14:17:20.057

Configuration files. Nice way to document the changes to your system. And always being able to revert the changes.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-11-25T00:53:41.203

As a soon-to-graduate student looking for work, I'm using version control for my resume.

Why I'm doing it:

1.  I can maintain a single default resume for most job applications (the "trunk").
2.  If I want to play with different formatting options, I can branch out and play there without affecting the trunk
3.  If I need a latest copy at short notice, the trunk always has a stable version
4.  If some job opening requires specific skills, I can branch off a version where I highlight those
5.  I can create tags to keep track of what versions I sent specific companies, which can help me prepare for interviews
6.  It's fun to see how my resume evolves over time :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T14:21:10.750

At my office we use it as a form of at-times disconnected file sharing. There's about 4GB of files in the HEAD revision and it works brilliantly. Having the full version history for *all* your documents is a great backup tool.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T15:11:12.147

We have a group of graphics designers that we are currently trying to convert to use Team Foundation Server, via Teamprise.

Also, don't think of it just as code in a traditional sense. Database scripts, indexing scripts for search appliances, etc. all can be captured and versioned, as well. In conjunction with a good build process, you can take a lot of the manual effort out of deploying these artifacts, too.

And, as others have mentioned, documentation, test data, etc.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-04T14:15:25.270

I would use VC to implement an archival (or backup) feature for data on disk.

Also:

*   Any document related to a project.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T14:43:06.477

Not what you are talking about, but version control software could be an easy platform for file-sharing with a friend or small network.

For PURELY LEGAL REASONS ONLY, of course.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-04T15:02:48.263

Anything that goes through versions (documents, code, presentations, ads, images...) can all benefit from version control. If there is more that one person using/editing the piece, then you definitely need version control. Really, they need to be able to show differences, and track history independent of the editing program.

Thanks to [this](http://www.randsinrepose.com/archives/2008/11/25/dumbing_down_the_cloud.html) post from Rands in Repose ("Dumbing Down the Cloud[sic]"), I've looked into [dropbox](http://getdropbox.com) which is free online storage with version history tracking, rollback and sharing. For someone like my wife, a professor working with coworkers on papers across the country, this is a huge step forward in their work flow.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-04T21:23:07.107

My company stores all Life Cycle documentation for each product release in version control. These are items created during the development, testing and release of products.

We started this to support development, but ended up liking having version control and history for documentation, test cases, etc.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-09-28T14:49:19.153

Bit of a late answer, but I felt this belonged here:

Some time ago, I used Git to track time spent gaming. I tied the games' shortcuts to a small program which monitored the processes and the game saves. Every time a game was started, it switched to a branch named after that game, and committed the saves every 10 minutes even if they were not changed. When the game was exited, it stopped and switched back to master.

Simply opening a "`git tree`" of the repository would show me how long a game had run, as well as keep a versioned archive of its saves, which is really useful to go "back in time" if necessary.

# java - 在java框架中设置unicode字符

> ID：340739
> 
> 赞同：3
> 
> 时间：2008-12-04T14:19:31.313
> 
> 标签：java, unicode, frame

如何在没有日语语言包的 Windows XP m/c 中的 java swing 中的 JFrame 标题中显示 unicode 字符（例如日语）？看起来将标题文本设置为日文 unicode 字符而将字体设置为 MS Mincho 是不够的。虽然这就是在 Swing 标签中显示 unicode 字符所需的全部内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T14:26:56.400

“没有日语语言包”？

看来您至少必须**[下载语言字体](http://regumindtrail.wordpress.com/2007/01/30/writing-a-java-swing-application-to-display-japanese-characters/)**...

![替代文字](https://regumindtrail.files.wordpress.com/2007/01/japanese-swing-app.gif)

> 字体是唯一需要安装在客户端计算机上才能运行应用程序的东西。
> 
> 与 AWT 不同，在 Swing 中使用字体要容易得多。
> 对于 AWT 组件，即具有本地对等体的组件，您需要自定义 JRE 的设置，即修改 /jre/lib 下的 font.properties 以包含您在每种字体类型下安装的字体。
> 
> 在您的 Swing 应用程序中，您只需要在设置其文本之前设置 Swing 组件的字体。

文章开头的链接包含一个完整的示例。
小提取物：

```
JFrame frame = new JFrame();
String string = "\u30b7\u30f3\u30d7\u30eb\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf";
JLabel label = new JLabel();
label.setFont(new Font("MS Mincho",Font.PLAIN, 12));
label.setText(string);
frame.getContentPane().add(label);
frame.setFont(new Font("MS Mincho",Font.PLAIN, 12));
frame.setTitle(string); 
```

* * *

java J2SE6 (1.6.0) 的通用文档在[这里](http://java.sun.com/javase/6/docs/technotes/guides/intl/index.html)，包括**[字体配置文件](http://java.sun.com/javase/6/docs/technotes/guides/intl/fontconfig.html)**

从 Java5 及更高版本开始，您不再需要 font.properties 文件，因为您可以加载字体文件以创建/使用字体。

```
String fontFileName = "yourfont.ttf";
InputStream is = this.getClass().getResourceAsStream(fontFileName);
Font ttfBase = Font.createFont(Font.TRUETYPE_FONT, is);
Font ttfReal = ttfBase.deriveFont(Font.PLAIN, 24); 
```

# c# - VS2005 代码分析：CA1063（调用 dispose(true) 并抑制 finalize）- 带日志记录

> ID：340745
> 
> 赞同：2
> 
> 时间：2008-12-04T14:22:09.623
> 
> 标签：c#, visual-studio-2005, code-analysis, fxcop

我正在尝试遵守新项目的 VS2005 代码分析规则。我有这个方法：

```
public void Dispose()
{
    Console.WriteLine("Dispose() called");
    Dispose( true );
    GC.SuppressFinalize(this);
} 
```

*（控制台调用将在某个时候变成 log4net 调用，我们总是对记录某些类型的 dispose 感兴趣）。*

控制台调试行的存在会触发此错误：

*错误 1 ​​CA1063：Microsoft.Design：修改 PerfectDisposableClass.Dispose():Void 使其调用 Dispose(true)，然后在当前对象实例（VB 中的“this”或“Me”）上调用 GC.SuppressFinalize，然后返回. F:\Visual Studio 2005\Projects\DisposeAndFinalize\DisposeAndFinalize\PerfectDisposableClass.cs 26 DisposeAndFinalize*

如果不求助于 pragma 指令，有没有办法解决这个问题？也许写我自己的规则？另外，我可以用反射器查看组件中的现有规则吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T14:31:40.137

您可以将 log 语句放在 Dispose(bool disposing) 方法中以保持在准则范围内：

```
public void Dispose(bool disposing)
{
  if (disposing)
  {
     Console.WriteLine("...");
  }
  ...
} 
```

# java - 酷还是傻？捕获（异常[命名异常，创建异常] e）

> ID：340748
> 
> 赞同：4
> 
> 时间：2008-12-04T14:23:32.820
> 
> 标签：java, programming-languages, exception-handling

我正在编写一些代码，我注意到异常处理中的一种模式让我思考：

```
try{

        // do stuff... throws JMS, Create and NamingException

} catch (NamingException e) {

        log1(e);
    rollback();
        doSomething(e)
} catch (CreateException e) {

        log1(e);
    rollback();
        doSomething(e)
} 
```

JMSException 将处理堆栈中的某个位置。

是不是只写：

```
try{

        // do stuff... throws JMS, Create and NamingException
} catch Exception[NamingException, CreateException] e) {

        log1(e);
    rollback();
        doSomething(e)
} 
```

而不是把它放在 tu 一个辅助方法中：

```
try{

        // do stuff... throws JMS, Create and NamingException
} catch (NamingException e) {

        helper_handleError1(e)
} catch (CreateException e) {

        helper_handleError1(e)
} 
```

请注意，我想传播原始 JMSException 的堆栈跟踪，并且我不“感觉”使用第三个 catch 子句创建一个新的 JMSException :)

有硬汉吗？这是一个只会污染 Java 语法的极端情况，还是只是一个很酷的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T14:43:42.030

他们正在考虑为 Java 7 扩展这种类型。

见：[http ://tech.puredanger.com/java7#catch](http://tech.puredanger.com/java7#catch)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T14:52:48.673

只要我们正在编造语法，我希望看到它是这样的：

```
try
{
   // do stuff ...
}
catch (NamingException e)
catch (CreateException e)
{
   log1(e);
   rollback();
   doSoemthing(e);
} 
```

类似于 switch 语句或 C#`using`块的失败。当然，这里变量 e 声明了两次是有问题的，但我认为可以解决一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T14:31:38.217

我想是否可以对异常类型进行一些模式匹配作为语法附加。就像是

```
尝试 {
  ...
} 捕捉 ((IOException && !FileNotFoundException) || IllegalArgumentException ) {
  ... 处理它
}

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T14:37:08.377

我建议使用“Execute Around”成语​​。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T14:37:26.833

试试这个：

```
try {
  ...
} catch ( Exception e) {
  if typeof(e) not in ('MyException', 'SpecialException') {
    throw e
  }
  doSomething()
} 
```

（伪代码）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T14:39:57.840

首先，

```
} catch Exception[NamingException, CreateException] e) { 
```

缺少 '(' 字符。

其次，为什么是“Exception[NamingException, CreateException] e”而不仅仅是“[NamingException, CreateException] e”？

这个想法可能很好，但需要一些改进。例如，假设我用函数“doYellow()”声明“MyException”类，用函数“doYellow()”声明“OtherException”类。是否允许这样的功能（考虑到超类中没有“doYellow（）”功能）。如果是这样，如果仅在其中一个上声明“doYellow()”，是否允许？这就是 [] 字符之前的“异常”吗？另外，假设有这个声明：

```
void doYellow(NamingException e);
void doYellow(CreateException e); 
```

（注意它们是不同的功能）是否允许调用它？

你真的应该提供更多的细节。但是，在某些情况下它可能很有用（并不罕见）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T14:45:54.600

另一种做法。

将低级异常转换为您自己的高级异常，并进行处理。

```
try{
    try{
        // do stuff... throws JMS, Create and NamingException
    } catch (NamingException e) {
            throw new MyException(e);
    } catch (CreateException e) {
            throw new MyException(e);
    }
} catch (MyException e) {
    // something on e or e.getCause();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T14:46:30.620

为什么不只是

```
try
{
   // do stuff... throws JMS, Create and NamingException
}  catch (JMSException e) 
{   
   if (e instanceof CreateException || e instanceof NamingExcption)
   {    
     log1(e);
     rollback();
     doSomething(e);
   }
   else
     throw e;
} 
```

# java - 在 Java 中使用 XPath 解析 XML

> ID：340787
> 
> 赞同：9
> 
> 时间：2008-12-04T14:38:28.810
> 
> 标签：java, xml, xpath

我有一个类似于以下结构的 XML：

```
<category>
   <subCategoryList>
      <category>

      </category>
      <category>
         <!--and so on -->
      </category>
   </subCategoryList>
</category> 
```

我有一个包含`subcategory`列表 ( `List<Category>`) 的 Category 类。我正在尝试使用 XPath 解析此 XML 文件，但我无法获取某个类别的子类别。

我怎样才能用 XPath 做到这一点？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-05-12T11:18:43.340

[这个链接](http://www.roseindia.net/tutorials/xPath/java-xpath.shtml)有你需要的一切。简而言之：

```
 public static void main(String[] args) 
   throws ParserConfigurationException, SAXException, 
          IOException, XPathExpressionException {

    DocumentBuilderFactory domFactory = 
    DocumentBuilderFactory.newInstance();
          domFactory.setNamespaceAware(true); 
    DocumentBuilder builder = domFactory.newDocumentBuilder();
    Document doc = builder.parse("persons.xml");
    XPath xpath = XPathFactory.newInstance().newXPath();
       // XPath Query for showing all nodes value
    XPathExpression expr = xpath.compile("//person/*/text()");

    Object result = expr.evaluate(doc, XPathConstants.NODESET);
    NodeList nodes = (NodeList) result;
    for (int i = 0; i < nodes.getLength(); i++) {
     System.out.println(nodes.item(i).getNodeValue()); 
    }
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T14:52:19.063

我相信 XPath 表达式将是“ `//category/subCategoryList/category`”。如果您只想要根节点的子`category`节点（假设它是文档根节点），请尝试“ `/category/subCategoryList/category`”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T14:52:37.143

这将为您工作：

```
NodeList nodes = (NodeList) xpath.evaluate("//category//subCategoryList/category",
inputSource, XPathConstants.NODESET); 
```

然后，您可以根据需要解析类别的孩子。

# wpf - 如何将方法调用委托给另一个线程？

> ID：340790
> 
> 赞同：1
> 
> 时间：2008-12-04T14:39:45.767
> 
> 标签：wpf, multithreading, synchronization

我有以下问题：多线程 WPF 应用程序，模型视图演示器实现。Presenters 和 Views 属于一起在单独的线程上创建并获得单独的 Dispatcher。现在有人从另一个线程调用 Presenter 上的方法。我正在拦截呼叫，现在开始出现问题：如果呼叫来自与演示者相同的线程，我想继续呼叫，否则在 Dispatcherthread 上调用呼叫，这样我就不需要关心UI 调用。我已经阅读了有关 SynchronizationContext 的使用，但这似乎对我不起作用，因为如果调用线程不是 UI 线程，我无法比较这两个上下文。什么是可能的、有效的和优雅的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T15:23:28.800

```
if( presenterDispatcherObject.CheckAccess() )
   Doit();
else
  presenterDispatcherObject.BeginInvoke( DispatcherPriority.Normal, () => DoIt() ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T02:36:40.187

如果您希望 Dispatcher 调用阻塞（等待返回），我会使用 Invoke 而不是 BeginInvoke。这将模拟更多实际直接调用函数的行为。Invoke 阻塞调用线程，直到函数完成（更像是 Win32 SendMessage）。BeginInvoke 只是发布并返回而不等待函数返回（如 Win32 PostMessage）。

CheckAccess 很慢。我会通过减少不同线程上的调用来限制 CheckAccess。

```
public delegate bool MyFuncHandler(object arg);

bool ThreadedMyFunc(object arg)
{
    //...

    bool result;

    //...

    // use dispatcher passed in,  I would pass into the contructor of your class
    if (dispatcher.CheckAccess())
    {
        result = MyFunc(arg);
    }
    else
    {
        result = dispatcher.Invoke(new MyFuncHandler(MyFunc), arg);
    }

    return result;
}

bool MyFunc(object arg)
{
    //...
} 
```

# asp.net - 如何解决“无法加载 DLL...”？

> ID：340794
> 
> 赞同：0
> 
> 时间：2008-12-04T14:41:17.760
> 
> 标签：asp.net, deployment, dependencies

我为我的 ASP.NET 应用程序部署了更新，并开始在使用 foo.dll 的页面上看到此错误：

> 无法加载 foo.dll。指定的模块无法找到。（来自 HRESULT 的异常：0x8007007E）

foo.dll 在我的 system32 和应用程序 bin 目录中（在路径环境变量中）。

是什么赋予了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T14:45:51.853

每当您在加载程序集时遇到问题，请查看[融合日志。](http://msdn.microsoft.com/en-us/library/e74a18c4(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T14:41:47.823

事实证明 foo.dll 依赖于另一个丢失的 dll。

我使用[Dependency Walker](http://www.dependencywalker.com/)来发现丢失了哪些文件。一旦我复制了丢失的文件，页面就开始正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T15:14:28.647

Fuslogvw，正如威尔所说。通常问题不在于找不到 foo.dll，而在于缺少 foo.dll 的依赖项。如果这是一个非托管 DLL，这通常是 C 运行时库（您需要用于构建的 Visual Studio 版本的正确版本，以及相应的调试或发布版本，具体取决于您的构建配置）。

# visual-studio - 团队系统 2008 和 VS 2005 代码

> ID：340802
> 
> 赞同：1
> 
> 时间：2008-12-04T14:43:28.350
> 
> 标签：visual-studio, version-control

我们公司正在从 VS 2005 转换代码。我知道他们将无法使用 VS 2008 访问它，但我们已将补丁用于启用 TFS 2008 的 Web 访问，并将其应用于我们的 TFS 服务器。这意味着他们可以通过 Web 访问源代码，但在 VS 2005 中进行工作。

代码最终会在 VS 2008 中重写，但我们需要使用源代码控制工具来维护遗留代码。SVN 不是一个可接受的解决方案，因为我们是一个 .NET 团队系统公司。

有人看到这有什么问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T18:37:07.753

VS2005 与 TFS2008 配合得很好，唯一需要注意的是在 Team Build 区域，您可能需要安装几个 VS2008 客户端来帮助您管理构建。VS2008 和 VS2005 可以在同一台机器上愉快地并存。

希望有帮助，

马丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T17:31:43.580

我不明白您所说的“转换代码”... VS2008 不会更改 VS2005 项目/解决方案中的任何代码，只会更改项目/解决方案文件。为什么您只为您的一些人迁移到 VS2008？让每个人都转向VS2008似乎更好。我怀疑您的任何开发人员都会抱怨迁移到 VS2008，除非他们运行的是旧硬件或其他东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T14:52:41.823

从 2005 年到 2008 年，我们进行了多次升级，没有遇到任何实际问题。只需在 2008 年打开解决方案并让它进行升级。然后在 TFS 中创建一个新项目，并将升级后的源代码添加到其中。我们保留旧的 TFS 项目和源代码以供参考，但实际上我们很少需要返回它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T19:49:51.163

Where did you hear that VS2005 can't work with TFS 2008, and that VS2008 won't open VS2005 projects? Like sliderhouserules said, only the project files are changed, and even then not in a way that VS 2005 can't open them.

I always test new tools when they come out, and with VS2008 I was able to run it side by side with the other dev's in my department and they never knew.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T19:34:31.693

Hrm....我不希望项目转换。有人提到他们想使用 TFS 做源代码控制，但不想将项目迁移到 2008。我想获得一种即将使用 TFS 2008 和 2005 项目的感觉。

我知道我可以在 2008 年运行 2.0 框架。我只是不希望它转换到 2008 年，因为我们计划重新编写应用程序。我将尝试再次打开解决方案而不升级它。

谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T19:48:44.283

你有TFS08的构建吗？我记得看到一个帖子说 SLN 中的构建顺序没有得到构建的尊重。我认为建议是指定自己要构建的项目。

# c# - C# 发送键盘输入

> ID：340816
> 
> 赞同：11
> 
> 时间：2008-12-04T14:48:35.903
> 
> 标签：c#, windows

如何将键盘输入消息发送到当前选择的窗口或先前选择的窗口？

我有一个程序，我用它来输入键盘上不存在的一些字符，如果我可以直接发送输入而不是一直复制和粘贴，我希望它。

编辑：

此应用程序是键入德语变音符号。我是美国人，我在德国工作。我正在使用美式键盘，有时我必须输入变音符号/欧元符号/尖锐的 S。目前我有一个简单的 WinForms 应用程序，其中包含一个文本字段和一些带有额外字符的按钮。我在文本字段中输入内容，然后可以按按钮将文本附加到文本字段。然后我复制文本并将其粘贴到任何地方。但是，如果我只需按下其中一个按钮，它就会将文本发送到我正在输入/正在输入的任何地方，那该多好。当前的程序运行良好，但我可以做得更好。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-04T14:56:25.623

[SendKeys.Send](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send.aspx)将帮助您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T14:58:42.750

查看 System.Windows.Forms.SendKeys.Send(string)。这允许将按键发送到当前活动的应用程序。

更新：刚刚在 MSDN 论坛上找到了这个：[MSDN 论坛](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2766639&SiteID=1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T15:04:10.617

如果它不在您的键盘上，您可以简单地添加一个按钮并将此字符的代码键发送到您要附加此字符的引用对象。给我们一个你想要的例子，我们也许可以向你展示一些代码。

代码的简短示例：

```
myField.Text += "®"; //This is a char that I do not have on my keyboard 
```

# java - Java Cipher - AES 填充问题

> ID：340820
> 
> 赞同：6
> 
> 时间：2008-12-04T14:49:24.890
> 
> 标签：java, encryption, aes, padding

我正在使用 16 字节块大小的 AES 密码。

如果我尝试加密一个 16 字节的字符串，我没有问题，但任何其他长度不是 16 的倍数都会引发异常。

我知道使用 3-DES，您可以将填充类型指定为算法的一部分，并且无需额外工作即可处理（例如 DES/CBC/PKCS5Padding），但是有没有办法用 AES 指定它？

或者我是否需要手动将 pytes 填充到 16 的倍数，然后在解密时剥离它们？这是一个简短的代码示例。

```
encrypt = Cipher.getInstance("AES", provider);
encrypt.init(Cipher.ENCRYPT_MODE, key) ;
byte[] encrypted = encrypt.doFinal(plainTxt.getBytes()) ; 
```

任何和所有的答复表示赞赏！

在此先感谢， Ciarán

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-05T01:13:05.690

它应该与 AES 完全相同，即填充模式必须与密码一起指定。实现哪些填充模式取决于提供者，并应在其文档中进行描述。

根据 JCE 文档： http: [//java.sun.com/j2se/1.5.0/docs/guide/security/jce/JCERefGuide.html#AppA](http://java.sun.com/j2se/1.5.0/docs/guide/security/jce/JCERefGuide.html#AppA) 标准填充模式，如 PKCS5Padding 应该始终受到支持（至少，这就是我解释它）。

# c# - 将文本从英文字符转换为希伯来字符

> ID：340825
> 
> 赞同：2
> 
> 时间：2008-12-04T14:51:09.487
> 
> 标签：c#, cultureinfo, hebrew

使用 C#，当用户在普通文本框中键入文本时，您如何看到该文本的希伯来语等价物？

我想在数据输入表单上使用此功能，当秘书使用英文字符输入客户姓名以使其在另一个文本框中自动转换为希伯来语表示时。

也许与 CultureInfo("he-IL") 相关...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T15:16:16.007

我什至不知道有[Hebraization](http://en.wikipedia.org/wiki/Hebraization_of_English)这样的东西——谢谢你提出这个问题 :-)

.NET Framework 不提供此功能，因此恐怕您必须自己构建它。你必须知道英语的发音才能提供正确的希伯来语音译——我认为这不是一件容易的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T15:35:50.460

我猜这几乎是不可能的，我不懂希伯来语，但我确实从其他语言中知道，人名的发音（以及音译）通常（实际上经常）与一般发音有很大不同这些信。这是因为名称的变化比书写系统慢，而书写系统的变化也比口头语言慢。

音译时，您*必须*基于语音而不是其他书写系统的怪癖来进行音译，因此音译者必须在某种程度上了解两种语言，而教计算机*口头*理解语言可能*还很遥远*。您当然可以任意选择一个可以代表两种语言的声音的符号，但这会（毫无疑问）产生 hillarius 结果，并且可能不会有太大帮助。

许多语言（尤其是英语）都有非常复杂和不规则的发音规则（在英语的情况下；显然完全随机*）并且书写系统之间从来没有精确的一对一关系（如果你可能在谈论符号字体不是实际的书写系统），因此除非您的计算机能够流利地说两种语言，否则自动音译的机会不大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T15:44:56.290

您需要更好地定义您的需求。英语的希伯来语音译并非微不足道（因为英语中的歧义，而不是希伯来语：希伯来语实际上定义明确）。即使您想将语音翻译成希伯来语，您仍然需要解决一些问题（taf vs. tet，heh vs chet vs chaf (khaf)）。以色列没有我能找到的官方标准。路标经常出现不一致的音译（从希伯来语到英语，但我也看到过）

There is a fairly well defined translation set in Rabbinic literature; believe it or not, the validity of a Rabbinic divorce document ("get") depends on it being perfectly accurate, which means that over the past few hundred years, Rabbis have standardized which sounds get mapped to which letters, but it's often influenced by Yiddish, and has extra letters put in (alephs, mostly) which modern Israelis would find puzzling.

I'm a native English speaker living in Israel, if that helps justify my skepticism.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-13T18:35:26.477

You would be able to solve this problem using the IPA (International Phonetic Alphabet) in the middle. So, for example you can get the IPA from an english name through an API translator and then making an IPA to hebrew translation through this table: [https://en.wikipedia.org/wiki/Help:IPA/Hebrew](https://en.wikipedia.org/wiki/Help:IPA/Hebrew)

# java - 以单个超时（在所有线程上运行最多 30 秒）运行多个任务（线程）的最佳实践是什么？

> ID：340826
> 
> 赞同：1
> 
> 时间：2008-12-04T14:51:34.853
> 
> 标签：java, multithreading, concurrency

我想出了一个解决方案，但我想看看是否有人有更好的方法或更标准的方法来做到这一点。

main 方法演示了我将如何使用这个类。在此的生产版本中，我将保持线程池打开并继续重用它，而不是在调用后将其关闭。

```
public class MultiCallManager<T>
{

private ExecutorService service;
private Map<String, Future<T>> futureResults;
private Map<String, T> results;
private Map<String, Exception> errors;

public MultiCallManager(ExecutorService inService)
{
    service = inService;
    futureResults = new LinkedHashMap<String, Future<T>>();
    results = new LinkedHashMap<String, T>();
    errors = new LinkedHashMap<String, Exception>();
}

public void add(String key, Callable<T> task)
{
    Future<T> result = service.submit(task);
    futureResults.put(key, result);
}

public boolean hasErrors()
{
    return !errors.isEmpty();
}

public T getResult(String key)
{
    return results.get(key);
}

public Exception getException(String key)
{
    return errors.get(key);
}

public void waitUntilDone(long timeout)
{
    for (Entry<String, Future<T>> entry : futureResults.entrySet())
    {
        if (timeout < 0)
        {
            timeout = 0;
        }
        long start = System.currentTimeMillis();
        try
        {
            results.put(entry.getKey(), entry.getValue().get(timeout, TimeUnit.MILLISECONDS));
        }
        catch (Exception e)
        {
            errors.put(entry.getKey(), e);
        }
        long end = System.currentTimeMillis();
        long time = end - start;
        timeout = timeout - time;
    }
}

public static void main(String[] args) throws Exception
{
    ExecutorService service = Executors.newFixedThreadPool(5);

    MultiCallManager sandbox = new MultiCallManager(service);

    final String value = "AWESOME!";

    Callable<Object> c1 = new Callable<Object>()
    {

        @Override
        public String call() throws Exception
        {
            Thread.sleep(5000);
            return value;
        }
    };

    Callable<Object> c2 = new Callable<Object>()
    {

        @Override
        public Object call() throws Exception
        {
            Thread.sleep(6000);
            return value;
        }
    };

    Callable<Object> c3 = new Callable<Object>()
    {

        @Override
        public Object call() throws Exception
        {
            Thread.sleep(2000);
            return value;
        }
    };

    sandbox.add("c1", c1);
    sandbox.add("c2", c2);
    sandbox.add("c3", c3);
    sandbox.waitUntilDone(5000);

    if (sandbox.getResult("c1") != null)
    {
        System.out.println(sandbox.getResult("c1"));
    }
    else
    {
        sandbox.getException("c1").printStackTrace();
    }
    if (sandbox.getResult("c2") != null)
    {
        System.out.println(sandbox.getResult("c2"));
    }
    else
    {
        sandbox.getException("c2").printStackTrace();
    }
    if (sandbox.getResult("c3") != null)
    {
        System.out.println(sandbox.getResult("c3"));
    }
    else
    {
        sandbox.getException("c3").printStackTrace();
    }
    service.shutdownNow();
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T15:01:41.790

看看 CompletionService 和/或 CountDownLatch 他们会用更好的代码完成你正在做的一些事情。

*   [CountdownLatch 示例](http://programmingexamples.wikidot.com/countdownlatch)
*   [带有 CompletionService 示例的文章](http://www.chrisellsworth.com/blogs/devblog/archive/2006/10/31/Java-Concurrency-API-Example.aspx)

CompletionService 提供了一个类似于 BlockingQueue 的接口，因此可以使用[poll(long timeout, TimeUnit unit)](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CompletionService.html#poll(long,%20java.util.concurrent.TimeUnit))方法。每次轮询时，您都希望将超时设置为所有线程的剩余时间，并在时间到时退出。

这实质上取代了您的 waitUntilDone 方法，执行相同的工作。

# c# - 如何最小起订量索引属性

> ID：340827
> 
> 赞同：98
> 
> 时间：2008-12-04T14:51:36.163
> 
> 标签：c#, tdd, mocking, moq

我试图模拟对索引属性的调用。即我想起订量以下：

```
object result = myDictionaryCollection["SomeKeyValue"]; 
```

以及设置器值

```
myDictionaryCollection["SomeKeyValue"] = myNewValue; 
```

我这样做是因为我需要模拟我的应用程序使用的类的功能。

有谁知道如何用最小起订量做到这一点？我尝试了以下变体：

```
Dictionary<string, object> MyContainer = new Dictionary<string, object>();
mock.ExpectGet<object>( p => p[It.IsAny<string>()]).Returns(MyContainer[(string s)]); 
```

但这不编译。

我想通过最小起订量实现什么，有人有我如何做到这一点的例子吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-12-11T12:06:39.673

目前尚不清楚您要做什么，因为您没有显示模拟的声明。你想模拟字典吗？

`MyContainer[(string s)]`不是有效的 C#。

这编译：

```
var mock = new Mock<IDictionary>();
mock.SetupGet( p => p[It.IsAny<string>()]).Returns("foo"); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-14T02:29:11.083

Ash，如果你想模拟 HTTP Session，那么这段代码就可以了：

```
/// <summary>
/// HTTP session mockup.
/// </summary>
internal sealed class HttpSessionMock : HttpSessionStateBase
{
    private readonly Dictionary<string, object> objects = new Dictionary<string, object>();

    public override object this[string name]
    {
        get { return (objects.ContainsKey(name)) ? objects[name] : null; }
        set { objects[name] = value; }
    }
}

/// <summary>
/// Base class for all controller tests.
/// </summary>
public class ControllerTestSuiteBase : TestSuiteBase
{
    private readonly HttpSessionMock sessionMock = new HttpSessionMock();

    protected readonly Mock<HttpContextBase> Context = new Mock<HttpContextBase>();
    protected readonly Mock<HttpSessionStateBase> Session = new Mock<HttpSessionStateBase>();

    public ControllerTestSuiteBase()
        : base()
    {
        Context.Expect(ctx => ctx.Session).Returns(sessionMock);
    }
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-06-03T08:44:49.683

正如您正确发现的那样，有不同的方法可以分别初始化 getter`SetupGet`和`SetupSet`setter。虽然`SetupGet`旨在用于属性，而不是索引器，并且不允许您处理传递给它的键。准确地说，索引器无论如何`SetupGet`都会调用：`Setup`

```
internal static MethodCallReturn<T, TProperty> SetupGet<T, TProperty>(Mock<T> mock, Expression<Func<T, TProperty>> expression, Condition condition) where T : class
{
  return PexProtector.Invoke<MethodCallReturn<T, TProperty>>((Func<MethodCallReturn<T, TProperty>>) (() =>
  {
    if (ExpressionExtensions.IsPropertyIndexer((LambdaExpression) expression))
      return Mock.Setup<T, TProperty>(mock, expression, condition);
    ...
  }
  ...
} 
```

为了回答您的问题，这是一个使用底层`Dictionary`存储值的代码示例：

```
var dictionary = new Dictionary<string, object>();

var applicationSettingsBaseMock = new Mock<SettingsBase>();
applicationSettingsBaseMock
    .Setup(sb => sb[It.IsAny<string>()])
    .Returns((string key) => dictionary[key]);
applicationSettingsBaseMock
    .SetupSet(sb => sb["Expected Key"] = It.IsAny<object>())
    .Callback((string key, object value) => dictionary[key] = value); 
```

如您所见，您必须明确指定键来设置索引器设置器。详细信息在另一个 SO 问题中描述：[Moq an indexed property and use the index value in the return/callback](https://stackoverflow.com/questions/29697406/moq-an-indexed-property-and-use-the-index-value-in-the-return-callback)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-05-06T20:09:48.617

它并不难，但花了一点时间才找到它:)

```
var request = new Moq.Mock<HttpRequestBase>();
request.SetupGet(r => r["foo"]).Returns("bar"); 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-03-16T08:39:30.933

看来我试图用最小起订量做的事情是不可能的。

本质上，我试图最小化一个 HTTPSession 类型的对象，其中被设置为索引的项目的键只能在运行时确定。访问索引属性需要返回先前设置的值。这适用于基于整数的索引，但基于字符串的索引不起作用。

# java - 使用 Oracle 10g 长字段填充 Grails 域对象时的空指针

> ID：340837
> 
> 赞同：0
> 
> 时间：2008-12-04T14:53:07.940
> 
> 标签：java, hibernate, grails, oracle10g

我们正在尝试从 oracle 10g 数据库中填充域对象。有问题的字段被定义为域对象中的字符串，具有以下约束。

zdata（空白：假，最大尺寸：3000000）

数据的大小约为 70K 的 XML。

表定义如下所示：

ZDATA NOT NULL LONG()

我们使用 grails 生成的 getter 来访问表：

reportData = ReportData.get(reportDataId)

进行此调用时，我们得到一个空指针异常。这是我们的堆栈跟踪的一部分。java.lang.NullPointerException 在 java.lang.String.(String.java:176) 在 oracle.sql.CharacterSet.AL32UTF8ToString(CharacterSet.java:1518) 在 oracle.jdbc.driver.DBConversion.CharBytesToString(DBConversion.java:610 ) 在 oracle.jdbc.driver.T4CLongAccessor.getString(T4CLongAccessor.java: 426) 在 oracle.jdbc.driver.OracleResultSetImpl.getString(OracleResultSetImpl.java:403) 在 oracle.jdbc.driver.OracleResultSet.getString(OracleResultSet.java:1515) 在 org.apache.commons.dbcp.DelegatingResultSet.getString(DelegatingResultSet .java：

我们正在使用 oracle 驱动程序 10.2.0.3.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T14:34:37.833

This is a known limitation of the oracle jdbc driver as listed in the release notes for version 10.2.0.1.0\.

This known limitation has been fixed according to the release notes of Oracle JDBC Driver release 11.1.0.7.0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T22:57:55.417

为什么在 Oracle 中使用长字段？Long 已经过时了，你应该使用 clob。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T03:53:10.620

如果您在 Oracle 中存储 XML，请使用 XmlType 列，该列可以轻松转换为 CLOB，并且可以与 JDBC 10g 驱动程序完美配合，因为这是我们目前在生产环境中使用的。

# eclipse - 如何根据 Eclipse 中的文件类型设置不同的代码样式？

> ID：340839
> 
> 赞同：0
> 
> 时间：2008-12-04T14:53:29.467
> 
> 标签：eclipse, eclipse-cdt

我们正在使用 CMake 来管理我们的构建，并且有一个相当大的项目，其中包含为我们的嵌入式平台构建软件基础所需的几乎所有东西，除了工具链。使用 CMake 构建 CDT 项目时，它会将所有内容放入一个大型项目中，而不是根据 CMake 规范将其拆分为单个项目。

我们的问题是我们在项目中有 C 和 C++ 代码，并且我们对这些语言有不同的代码样式。我无法找到如何告诉 Eclipse 根据文件类型而不是项目来选择代码样式，这使得我们很难使用 Eclipse，因为您必须记住手动切换整个样式如果你想从 C 项目切换到 C++ 项目，反之亦然。

是否可以根据文件类型设置代码样式，而不仅仅是针对整个项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T23:01:08.747

您可以使用新建文件夹对话框的“链接到文件系统中的文件夹”高级选项。

基本上创建一个项目 build-c，然后在那里创建一个名为 build 的新文件夹并链接到位于其他地方的构建源文件。然后对于 build-c 项目，您可以将代码样式更改为 build 项目以外的其他内容。

如果这变得令人困惑，您可以创建另一个名为 build-cpp 的项目并执行相同的操作（创建一个名为 build 的文件夹并链接到构建源文件的实际位置）。然后，您可以通过工作集（一个工作集包括 build-c 项目，另一个工作集称为 build-cpp）来使用过滤项目。

由于两个项目中的文件夹只是链接到构建文件的原始位置，因此您不必担心项目之间的多个副本。但是，您仍然只能从主构建项目中签入文件。它还需要用户根据他们对更改感兴趣的内容手动将工作集从 c 切换到 cpp。

# delphi - 如何在重写的虚函数中调用“继承”祖先方法？

> ID：340842
> 
> 赞同：8
> 
> 时间：2008-12-04T14:53:46.767
> 
> 标签：delphi

这有效：

```
constructor TMyObj.Create;
begin
 inherited;
end; 
```

为什么这也不起作用？

```
function TMyObjEx.Import(CONST FileName: string; CONST x, y, z: Integer): string;
begin
 result:= inherited; // Import(FileName, x, y, z);  <--- Compiler says: "incompatible types"
 //do other stuff here
end; 
```

TMyObjEx 的声明是这样的：

```
TYPE

TMyObj = class(TChObj)
      private
      protected
      public
       function Import (CONST FileName: string; CONST x, y, z: Integer): string; virtual;     
     end;

TMyObjEx= class(TMyObj)
          private
          protected
          public
           function Import(CONST FileName: string; CONST x, y, z: Integer): string; override;   
         end; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-04T21:04:43.977

这是正确的答案。

执行此操作的正确方法是您在上面提到的：

```
function TMyObjEx.Import(CONST FileName: string; CONST x, y, z: Integer): string;
begin
 result:= inherited Import(FileName, x, y, z); 
 //do other stuff here
end; 
```

语言不支持您想要的方式。

所以最终回答了你的问题“为什么这也不起作用？” 是因为这不是语言的设计方式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T15:08:57.987

当您需要方法的结果时，自动传递参数不起作用。需要填写方法名和参数，不好意思。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-05T07:04:56.120

至于为什么不支持，Hallvard几年前在他的博客中写了一个[似是而非的解释：](http://hallvards.blogspot.com/2006/03/virtual-methods-and-inherited.html "虚拟方法和继承")

> 对“继承”的一个警告；语法是函数不支持它。对于函数，您必须使用显式语法，包括方法名称和任何参数。例如：
> 
> [一些代码]
> 
> 这可能看起来像是 Delphi 语言设计中的疏忽，但我认为这是故意的。其背后的基本原理可能是，如果 TMyClass.MethodC 是抽象的（或将来变得抽象），则后代类中的 Result 赋值将被删除，因此 Result 突然具有未定义的值。这肯定会导致微妙的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T15:07:34.150

起初我认为`inherited`如果您对函数的结果不感兴趣，您可以使用，但事实并非如此。调用继承的函数方法需要方法名和参数。就是那样子。如果您传递的参数与当前方法接收的参数不同，或者您正在调用完全不同的方法，您还需要提及方法名称。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-04T17:27:23.557

似乎 Delphi 文档有另一个黑洞......（哦，这有什么好消息？）

我的测试表明使用**继承**的关键字在它只适用于**构造函数、析构函数和过程**方​​法之后没有任何内容。在**Function方法上，它*****根本***不起作用。

但是，我从来没有检测到它，因为我有完全调用继承方法的习惯，即使我不需要它（动机：能够使用*Ctrl+左键单击* 它并更轻松地遵循代码流程调试）。

# python-3.x - Python 3.0 - dict 方法返回视图 - 为什么？

> ID：340850
> 
> 赞同：13
> 
> 时间：2008-12-04T14:56:10.663
> 
> 标签：python-3.x, dictionary, iterator, language-features, dictview

> dict 方法 dict.keys()、dict.items() 和 dict.values() 返回“视图”而不是列表。 [http://docs.python.org/dev/3.0/whatsnew//3.0.html](http://docs.python.org/dev/3.0/whatsnew//3.0.html)

首先，视图与迭代器有何不同？其次，这种变化有什么好处？仅仅是出于性能原因吗？

这对我来说似乎并不直观，即，我要一份东西清单（把你所有的钥匙给我），然后我又得到了别的东西。这会让人们感到困惑吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-04T14:59:04.603

你实际上得到了一份清单。它只是不是内部列表的副本，而是充当列表但仅代表内部状态的东西。

这与它在 Java 中实现的方式相同（可能还有许多其他语言/环境）。

主要原因是对于许多用例来说，返回一个完全分离的列表是不必要且浪费的。它需要复制整个内容（可能很多，也可能不多）。

如果您只是想遍历键，则无需创建新列表。如果您确实需要它作为单独的列表（作为副本），那么您可以轻松地从视图中创建该列表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-01-26T18:53:12.993

Joachim Sauer 的回答很好地解释了为什么`list`不返回 a 。但这留下了一个问题，为什么这些函数不会返回迭代器，就像`iteritems`Python 2 中的 etc. 那样。

迭代器比容器更具限制性。例如，一个迭代器不允许超过一次传递；如果你尝试第二遍，你会发现它是空的。因此，容器支持诸如此类的操作`elem in cont`，但迭代器不支持：一旦您检查一个元素是否在迭代器中，迭代器就会被销毁！

另一方面，获取容器*通常*需要制作副本，例如从字典的键中创建一个列表。

该`view`对象具有两全其美的优点：它充当容器，但不会复制字典！事实上，它是一种通过链接到底层字典来工作的虚拟只读容器。我不知道它是否在标准 Python 中的其他任何地方都可以看到。

编辑：

@AntonyHatchkins：它不返回生成器函数的原因是它不允许快速`in`操作。是的，`in`适用于生成器函数（当你调用它们时）。也就是说，您可以这样做：

```
def f():
  for i in range(10):
    yield i

5 in f() # True 
```

但是根据 的定义`in`，如果右边是生成器，python 会遍历`n`生成器的所有项——导致`O(n)`时间复杂度。您对此无能为力，因为这是任意生成器唯一有意义的行为。

另一方面，在字典视图的情况下，您可以实现`in`任何您喜欢的方式，因为您对所管理的数据了解得更多。实际上是使用哈希表`in`实现的复杂性。`O(1)`您可以通过运行检查它

```
>>> d = dict(zip(range(50000000), range(50000000)))
>>> 49999999 in d
True
>>> 49999999 in iter(d) # kinda how generator function would work
True
>>> 
```

并注意到第一个`in`与第二个相比有多快`in`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-24T17:44:11.490

正如在相关问题中已经提到的那样，视图具有`len()`迭代器缺少的方法（但列表有）。

返回视图而不是列表的另一个好处是，至少对于键而言，它在 O(1) 操作中优化了成员资格测试，而不是列表（或迭代器）的 O(N)。

# asp.net-mvc - 寻找学习 ASP.NET MVC 的好资源

> ID：340858
> 
> 赞同：10
> 
> 时间：2008-12-04T14:57:23.937
> 
> 标签：asp.net-mvc

在过去的几周里，我一直在使用 ASP.NET MVC，边做边学，从教程中学习，主要是反复试验。

我有点在黑暗中摸索，因为我在 MVC 框架方面没有其他经验，而且我只是盲目地前进，试图在前进的过程中弄清楚事情。

因此，我正在寻找更好、更有条理的资源来学习该平台及其功能，以及总体而言 MVC 结构以及框架如何实现它，但尚未发布有关该主题的书籍，并且都将在最好几个月。

有谁知道任何好的、全面的资源，我可以从中扩展我对 ASP.NET MVC 框架的知识？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-04T15:10:30.510

我尽量让我的文章简单明了：

概念/入门：

*   [现实世界中的 ASP.NET MVC](http://www.singingeels.com/Articles/ASPNET_MVC_in_the_Real_World.aspx)

*   [构建自定义 ASP.NET MVC 控件](http://www.singingeels.com/Articles/Building_Custom_ASPNET_MVC_Controls.aspx)

稍微高级一点/使用的好处：

*   [带有 ASP.NET MVC 的 AJAX 面板](http://www.singingeels.com/Articles/AJAX_Panels_with_ASPNET_MVC.aspx)

*   [优雅降级的 MVC AJAX 站点](http://www.singingeels.com/Articles/MVC_AJAX_Sites_That_Gracefully_Degrade.aspx)

*   [使用 ASP.NET MVC 操作过滤器进行日志记录](http://www.singingeels.com/Articles/Logging_with_ASPNET_MVC_Action_Filters.aspx)

*   [使用 ASP.NET MVC 进行测试驱动开发](http://www.singingeels.com/Articles/Test_Driven_Development_with_ASPNET_MVC.aspx)

*   [在 ASP.NET MVC 中创建自定义视图引擎](http://www.singingeels.com/Articles/Creating_a_Custom_View_Engine_in_ASPNET_MVC.aspx)

其中每一个都有一个完全可下载的示例项目。大部分都有屏幕截图。

编辑：我还应该补充一点，[乔纳森卡特](http://www.lostintangent.com/)（我的一个朋友，在雷德蒙德为微软工作）是你应该 RSS 的人。这是他关于 MVC 的一篇文章：[ASP.NET MVC - Action Filters](http://lostintangent.com/2008/07/08/aspnet-mvc-action-results/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-04T15:03:42.707

Rob Conery 有他的[ASP.NET MVC Storefront](http://blog.wekeroad.com/mvc-storefront/)系列，这是我用来弄湿我的脚的。它已经长了大约二十几部分。

他带你扔掉了应用程序的整个概念设计和执行，这是了解事物如何应用于现实世界的一种不可思议的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T15:02:26.237

个人发现[http://www.asp.net/mvc/](http://www.asp.net/mvc/)对我来说是最好的资源，示例应用程序和其他内容非常有帮助

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T15:04:05.733

通常，codeproject 有一个非常好的关于 ASP.net MVC 的教程：http: [//www.codeproject.com/KB/aspnet/aspnet_mvc.aspx](http://www.codeproject.com/KB/aspnet/aspnet_mvc.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-16T12:01:57.340

微软开发人员的 NerdDinner - Phil Haack、Hanselman 和 ScottGu。

[http://haacked.com/archive/2009/03/10/chapter-one-pro-aspnetmvc.aspx](http://haacked.com/archive/2009/03/10/chapter-one-pro-aspnetmvc.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T15:01:20.857

我从 Scott Hanselman 的[MVC 截屏视频](http://www.hanselman.com/blog/ASPNET35ExtensionsPlusMVCHowToScreencast.aspx)中学到了很多东西。它是在去年 12 月创建的，它有点过时了，但它很好地融入了框架。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-04T15:08:35.460

Scott Gunnerson 的博客是一个很棒的资源。[这篇文章](http://weblogs.asp.net/scottgu/archive/2008/12/02/dec-2nd-links-asp-net-asp-net-dynamic-data-asp-net-ajax-asp-net-mvc-visual-studio-silverlight-wpf.aspx)会让你顺利上路

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-04T17:21:14.817

得到这本书：

[http://manning.com/palermo/](http://manning.com/palermo/)

还可以查看 Ben Scheirman 的博客：

[http://flux88.com/](http://flux88.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-26T04:02:41.223

我敢打赌，你找不到比 Steven Sanderson 的“Pro ASP NET MVC Framework”更好的书了。我读了很多书，但从来没有读过这么好的书。

# windows - powershell exchange：如何设置计划任务来运行 exchange2007 powershell？

> ID：340878
> 
> 赞同：0
> 
> 时间：2008-12-04T15:03:15.017
> 
> 标签：windows, powershell, scheduled-tasks, exchange-server-2007

我在操作选项卡下设置计划任务（现在称为任务计划程序）以在 Windows 2007 服务器上运行时遇到问题。它还具有交换服务器 2007。

我试过设置

程序/脚本：C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe 添加参数（可选）：-psconsolefile exshell.psc1 -command "& {c:\mes-detail\emsbilling08.ps1}" 开始于（可选）：“C:\Program Files\Microsoft\Exchange Server\Bin\

我意识到 exshell.psc1 可能还需要一个显式路径，所以我也尝试过：

-psconsolefile C:\Program Files\Microsoft\Exchange Server\Bin\exshell.psc1 -command "& {c:\mes-detail\mailall3.ps1}" 但这也不起作用

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T18:10:26.433

我想我会在这里分享决议以完成开始的工作。

> 1）在您的 .ps1 文件中放置 Add-PSSnapin *交换*
> 
> 2) 对于计划任务，执行以下操作： 程序/脚本：C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe 添加参数（可选）：-noprofile -Noninteractive c:\mes-detail\emsbilling08.ps1开始（可选）：“C:\Program Files\Microsoft\Exchange Server\Bin\

如果它仍然不起作用，请运行以下检查：

> 开始...运行 C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -noprofile
> 
> 获取-PSSnapin -Registered
> 
> 你看到 Microsoft.Exchange.Management.PowerShell.Admin Microsoft.Exchange.Management.Powershell.Support
> 
> 如果是这样，做 add-pssnapin*交换*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T16:41:19.983

什么不起作用？您是否尝试过手动运行其中一个命令，看看会发生什么？

（顺便说一句：建议，您可能希望将其带到 minasi.com/forum 或 powershelcommunity.org 上的 PowerShell 论坛。您可能会询问更多了解该主题的受众，因为这对于 StackOverflow 的程序员来说有点边界-以人口为中心）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-19T07:58:57.110

> PS C:\Windows\System32\WindowsPowerShell\v1.0> add-pssnapin exchange Add-PSSnapin : 计算机上未安装 Windows PowerShell 管理单元交换。在 line:1 char:13 + add-pssnapin <<<< 交换

在脚本中写下全名：

```
Add-PSSnapin Microsoft.Exchange.Management.PowerShell.Admin
Add-PSSnapin Microsoft.Exchange.Management.PowerShell.Support 
```

# mobile - 如何检测用户是在电脑上还是手机上

> ID：340881
> 
> 赞同：1
> 
> 时间：2008-12-04T15:03:58.340
> 
> 标签：mobile, wap, xhtml-mp

我正在开发一个站点并开发一个组件，该组件将使用户使用 wap 或 xhtml-mp 并将他们重定向到专门为这些设备设置的站点。是否有一种很好的标准方法来检测用户正在使用哪些？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T15:12:40.350

因为无论您做什么，迟早都会出错，因此网站的每个版本都应该包含一个指向用户可以选择适当格式的页面的链接。一旦他们选择了，就对他们进行 cookie，如果存在，使用该 cookie 作为用户代理嗅探会告诉您的任何内容的覆盖。

如果您的网站涉及登录，除了用户代理嗅探之外，您还可以永久存储该偏好并在登录时根据需要重新对它们进行 cookie。如果从用户代理字符串中很明显就使用它，如果不是，请让他们从可用选项列表中进行选择并将他们的选择存储为默认值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T15:06:20.253

总是有用户代理字符串。但这意味着要跟上所有最新的浏览器，区分它们并不总是那么简单。

与其重定向到完全不同的页面，不如尝试在样式表中使用媒体选择器来调整小屏幕的正常内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-05T09:54:55.327

检查[这个](https://stackoverflow.com/questions/142273/standard-way-to-detect-mobile-browsers-in-a-web-application-based-on-the-http-r)和[WURFL](http://wurfl.sourceforge.net/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T15:06:51.297

[用户代理](http://en.wikipedia.org/wiki/User_agent) [嗅探](http://en.wikipedia.org/wiki/Browser_sniffing)

# django - 在 django 中导航

> ID：340888
> 
> 赞同：115
> 
> 时间：2008-12-04T15:06:42.530
> 
> 标签：django, navigation

我刚刚在 django 中完成了我的第一个小 webapp，我喜欢它。我即将开始将一个旧的生产 PHP 站点转换为 django，作为其模板的一部分，有一个导航栏。

在 PHP 中，我在模板代码中根据当前 URL 检查每个导航选项的 URL，如果它们对齐，则应用 CSS 类。太乱了。

有没有更好的 django 或处理模板中代码的好方法？

首先，我将如何获取当前 URL？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-01-25T14:00:34.060

您不需要 if 来执行此操作，请查看以下代码：

标签.py

```
@register.simple_tag
def active(request, pattern):
    import re
    if re.search(pattern, request.path):
        return 'active'
    return '' 
```

网址.py

```
urlpatterns += patterns('',
    (r'/$', view_home_method, 'home_url_name'),
    (r'/services/$', view_services_method, 'services_url_name'),
    (r'/contact/$', view_contact_method, 'contact_url_name'),
) 
```

base.html

```
{% load tags %}

{% url 'home_url_name' as home %}
{% url 'services_url_name' as services %}
{% url 'contact_url_name' as contact %}

<div id="navigation">
    <a class="{% active request home %}" href="{{ home }}">Home</a>
    <a class="{% active request services %}" href="{{ services }}">Services</a>
    <a class="{% active request contact %}" href="{{ contact }}">Contact</a>
</div> 
```

就是这样。有关实施细节，请查看：
[gnuvence.wordpress.com](http://gnuvince.wordpress.com/2007/09/14/a-django-template-tag-for-the-current-active-page)
[110j.wordpress.com](http://110j.wordpress.com/2009/01/25/django-template-tag-for-active-class)

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-12-04T19:26:08.327

我使用模板继承来自定义导航。例如：

base.html

```
<html>
    <head>...</head>
    <body>
        ...
        {% block nav %}
        <ul id="nav">
            <li>{% block nav-home %}<a href="{% url 'home' %}">Home</a>{% endblock %}</li>
            <li>{% block nav-about %}<a href="{% url 'about' %}">About</a>{% endblock %}</li>
            <li>{% block nav-contact %}<a href="{% url 'contact' %}">Contact</a>{% endblock %}</li>
        </ul>
        {% endblock %}
        ...
    </body>
</html> 
```

about.html

```
{% extends "base.html" %}

{% block nav-about %}<strong class="nav-active">About</strong>{% endblock %} 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-03-17T22:49:06.803

我喜欢上面 110j 的清洁度，所以我采用了大部分并进行了重构，以解决我遇到的 3 个问题：

1.  正则表达式将“家”网址与所有其他网址进行匹配
2.  我需要**将多个 URL 映射到一个导航选项卡**，因此我需要一个更复杂的标签，该标签采用可变数量的参数
3.  修复了一些网址问题

这里是：

标签.py：

```
from django import template

register = template.Library()

@register.tag
def active(parser, token):
    args = token.split_contents()
    template_tag = args[0]
    if len(args) < 2:
        raise template.TemplateSyntaxError, "%r tag requires at least one argument" % template_tag
    return NavSelectedNode(args[1:])

class NavSelectedNode(template.Node):
    def __init__(self, patterns):
        self.patterns = patterns
    def render(self, context):
        path = context['request'].path
        for p in self.patterns:
            pValue = template.Variable(p).resolve(context)
            if path == pValue:
                return "active" # change this if needed for other bootstrap version (compatible with 3.2)
        return "" 
```

网址.py：

```
urlpatterns += patterns('',
    url(r'/$', view_home_method, {}, name='home_url_name'),
    url(r'/services/$', view_services_method, {}, name='services_url_name'),
    url(r'/contact/$', view_contact_method, {}, name='contact_url_name'),
    url(r'/contact/$', view_contact2_method, {}, name='contact2_url_name'),
) 
```

base.html：

```
{% load tags %}

{% url home_url_name as home %}
{% url services_url_name as services %}
{% url contact_url_name as contact %}
{% url contact2_url_name as contact2 %}

<div id="navigation">
    <a class="{% active request home %}" href="home">Home</a>
    <a class="{% active request services %}" href="services">Services</a>
    <a class="{% active request contact contact2 %}" href="contact">Contact</a>
</div> 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-04-11T17:16:45.353

**我是**专门为解决这个问题而写的**[django-lineage的作者：D](https://github.com/marcuswhybrow/django-lineage)**

我在自己的项目中使用（完全可以接受的）jpwatts 方法感到恼火，并从 110j 的回答中汲取了灵感。血统看起来像这样：

```
{% load lineage %}
<div id="navigation">
    <a class="{% ancestor '/home/' %}" href="/home/">Home</a>
    <a class="{% ancestor '/services/' %}" href="/services/">Services</a>
    <a class="{% ancestor '/contact/' %}" href="/contact/">Contact</a>
</div> 
```

`ancestor`如果参数与当前页面 URL 的开头匹配，则简单地替换为“活动”。

`{% url %}`还支持可变参数和完整类型的反向解析。我撒了一些配置选项，把它充实了一点，打包起来供大家使用。

如果有人感兴趣，请在以下位置阅读更多信息：

# >> [github.com/marcuswhybrow/django-lineage](https://github.com/marcuswhybrow/django-lineage)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-09-26T09:08:07.017

从[Django 1.5 开始](https://docs.djangoproject.com/en/1.5/releases/1.5/#new-view-variable-in-class-based-views-context)：

> 在所有通用的基于类的视图（或任何从 ContextMixin 继承的基于类的视图）中，上下文字典包含一个指向 View 实例的视图变量。

因此，如果您使用此类视图，您可以添加类似的内容`breadcrumbs`作为类级别字段并在模板中使用它。

示例视图代码：

```
class YourDetailView(DetailView):
     breadcrumbs = ['detail']
     (...) 
```

在您的模板中，您可以这样使用它：

```
<a href="/detail/" {% if 'detail' in view.breadcrumbs %}class="active"{% endif %}>Detail</a> 
```

如果要另外“突出显示”父导航项，则需要扩展`breadcrumbs`列表：

```
class YourDetailView(DetailView):
     breadcrumbs = ['dashboard', 'list', 'detail']
     (...) 
```

...并在您的模板中：

```
<a href="/dashboard/" {% if 'dashboard' in view.breadcrumbs %}class="active"{% endif %}>Dashboard</a>
<a href="/list/" {% if 'list' in view.breadcrumbs %}class="active"{% endif %}>List</a>
<a href="/detail/" {% if 'detail' in view.breadcrumbs %}class="active"{% endif %}>Detail</a> 
```

这是一个简单而干净的解决方案，并且与嵌套导航配合得很好。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-04T19:09:33.647

您可以将 class 或 id 应用于页面的 body 元素，而不是特定的导航项。

HTML：

```
<body class="{{ nav_class }}"> 
```

CSS：

```
body.home #nav_home,
body.about #nav_about { */ Current nav styles */ } 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-12-06T20:52:53.360

我这样做：

```
<a class="tab {% ifequal active_tab "statistics" %}active{% endifequal %}" href="{% url Member.Statistics %}">Statistics</a> 
```

然后我所要做的就是在我看来添加`{'active_tab': 'statistics'}`到我的上下文字典中。

如果您正在使用[`RequestContext`](http://docs.djangoproject.com/en/dev/ref/templates/api/#id1)，您可以在模板中获取当前路径：

```
{{ request.path }} 
```

在您看来：

```
from django.template import RequestContext

def my_view(request):
    # do something awesome here
    return template.render(RequestContext(request, context_dict)) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-11-25T22:59:11.183

我从上面的 nivhab 中获取了代码并删除了一些奇怪的东西，并将其制成一个干净的模板标签，修改它以便 /account/edit/ 仍然使 /account/ 选项卡处于活动状态。

```
#current_nav.py
from django import template

register = template.Library()

@register.tag
def current_nav(parser, token):
    import re
    args = token.split_contents()
    template_tag = args[0]
    if len(args) < 2:
        raise template.TemplateSyntaxError, "%r tag requires at least one argument" % template_tag
    return NavSelectedNode(args[1])

class NavSelectedNode(template.Node):
    def __init__(self, url):
        self.url = url

    def render(self, context):
        path = context['request'].path
        pValue = template.Variable(self.url).resolve(context)
        if (pValue == '/' or pValue == '') and not (path  == '/' or path == ''):
            return ""
        if path.startswith(pValue):
            return ' class="current"'
        return ""

#template.html
{% block nav %}
{% load current_nav %}
{% url home as home_url %}
{% url signup as signup_url %}
{% url auth_login as auth_login_url %}
<ul class="container">
    <li><a href="{{ home_url }}"{% current_nav home_url %} title="Home">Home</a></li>
    <li><a href="{{ auth_login_url }}"{% current_nav auth_login_url %} title="Login">Login</a></li>
    <li><a href="{{ signup_url }}"{% current_nav signup_url %} title="Signup">Signup</a></li>
</ul>
{% endblock %} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-12-07T15:12:45.057

这只是上面 Toba 提出的 css 解决方案的一种变体：

在基本模板中包含以下内容：

```
<body id="section-{% block section %}home{% endblock %}"> 
```

然后在扩展基本用途的模板中：

```
{% block section %}show{% endblock %} 
```

然后，您可以使用 css 根据 body 标签突出显示当前区域（例如，如果我们有一个 id 为 nav-home 的链接）：

```
#section-home a#nav-home{
 font-weight:bold;
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-04T15:31:47.457

您可以使用带有适当参数的[reverse 函数](http://docs.djangoproject.com/en/dev/topics/http/urls/?from=olddocs#reverse)来获取当前 url。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-05T09:24:12.597

感谢您到目前为止的回答，先生们。我又去了一些稍微不同的东西..

在我的模板中：

```
<li{{ link1_active }}>...link...</li>
<li{{ link2_active }}>...link...</li>
<li{{ link3_active }}>...link...</li>
<li{{ link4_active }}>...link...</li> 
```

一旦我确定了我在逻辑中的哪个页面（通常在 urls.py 中），我将 `class="selected"`作为上下文的一部分以正确的名称传递给模板。

例如，如果我在 link1 页面上，我将附加`{'link1_active':' class="selected"'}`到模板的上下文中以舀取并注入。

它似乎工作并且*相当*干净。

编辑：为了将 HTML 排除在我的控制器/视图之外，我对此进行了一些修改：

```
<li{% if link1_active %} class="selected"{% endif %}>...link...</li>
<li{% if link2_active %} class="selected"{% endif %}>...link...</li>
... 
```

它使模板的可读性降低了一点，但我同意，最好不要从 urls 文件中推送原始 HTML。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-03-22T04:45:45.080

我发现最好的方法是使用包含标签：

`templates/fnf/nav_item.html`

```
<li class="nav-item">
    <a class="nav-link {% if is_active %}active{% endif %}" href="{% url url_name %}">{{ link_name }}</a>
</li> 
```

这只是我希望渲染的基本引导导航项目。

它获取 href 值，以及可选的 link_name 值。`is_active`是根据当前请求计算的。

`templatetags/nav.py`

```
from django import template

register = template.Library()

@register.inclusion_tag('fnf/nav_item.html', takes_context=True)
def nav_item(context, url_name, link_name=None):
    return {
        'url_name': url_name,
        'link_name': link_name or url_name.title(),
        'is_active': context.request.resolver_match.url_name == url_name,
    } 
```

然后在导航中使用它： `templates/fnf/nav.html`

```
{% load nav %}
<nav class="navbar navbar-expand-lg navbar-light bg-light">
        <ul class="navbar-nav mr-auto">
                {% nav_item 'dashboard' %}
            </ul> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-04-21T03:18:15.943

我在同一页面上有多个通过循环动态创建的菜单。上面与上下文相关的帖子给了我一个快速修复。希望这可以帮助某人。（除了活动模板标签外，我还使用它——我的修复解决了动态问题）。这似乎是一个愚蠢的比较，但它确实有效。我选择将变量命名为 active_something-unique 和 something-unique，这样它就可以与嵌套菜单一起使用。

这是视图的一部分（足以理解我在做什么）：

```
def project_list(request, catslug):
    "render the category detail page"
    category = get_object_or_404(Category, slug=catslug, site__id__exact=settings.SITE_ID)
    context = {
        'active_category': 
            category,
        'category': 
            category,
        'category_list': 
            Category.objects.filter(site__id__exact=settings.SITE_ID),

    } 
```

这是来自模板：

```
<ul>
  {% for category in category_list %}
    <li class="tab{% ifequal active_category category %}-active{% endifequal %}">
      <a href="{{ category.get_absolute_url }}">{{ category.cat }}</a>
    </li>
  {% endfor %}
</ul> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-22T21:04:27.557

我的解决方案是编写一个简单的上下文处理器来根据请求路径设置一个变量：

```
def navigation(request):
"""
Custom context processor to set the navigation menu pointer.
"""
nav_pointer = ''
if request.path == '/':
    nav_pointer = 'main'
elif request.path.startswith('/services/'):
    nav_pointer = 'services'
elif request.path.startswith('/other_stuff/'):
    nav_pointer = 'other_stuff'
return {'nav_pointer': nav_pointer} 
```

（不要忘记将您的自定义处理器添加到 settings.py 中的 TEMPLATE_CONTEXT_PROCESSORS。）

然后在基本模板中，我为每个链接使用一个 ifequal 标记来确定是否附加“活动”类。当然，这种方法严格限于路径结构的灵活性，但它适用于我相对适度的部署。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-09-09T17:51:05.143

我只是想分享我对 nivhab 帖子的小改进。在我的应用程序中，我有子导航，我不想只使用 CSS 来隐藏它们，所以我需要某种“if”标签来显示某个项目的子导航。

```
from django import template
register = template.Library()

@register.tag
def ifnaviactive(parser, token):
    nodelist = parser.parse(('endifnaviactive',))
    parser.delete_first_token()

    import re
    args = token.split_contents()
    template_tag = args[0]
    if len(args) < 2:
        raise template.TemplateSyntaxError, "%r tag requires at least one argument" % template_tag
    return NavSelectedNode(args[1:], nodelist)

class NavSelectedNode(template.Node):
    def __init__(self, patterns, nodelist):
        self.patterns = patterns
        self.nodelist = nodelist

    def render(self, context):
        path = context['request'].path
        for p in self.patterns:
            pValue = template.Variable(p).resolve(context)
            if path == pValue:
                return self.nodelist.render(context)
        return "" 
```

您可以基本上以与活动标签相同的方式使用它：

```
{% url product_url as product %}

{% ifnaviactive request product %}
    <ul class="subnavi">
        <li>Subnavi item for product 1</li>
        ...
    </ul>
{% endifnaviactive %} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-02-12T14:59:47.767

只是原始解决方案的另一个增强。

这接受多种模式，最好也是未命名的模式，写成用 '"' 包裹的相对 URL，如下所示：

```
{% url admin:clients_client_changelist as clients %}
{% url admin:clients_town_changelist as towns %}
{% url admin:clients_district_changelist as districts %}

<li class="{% active "/" %}"><a href="/">Home</a></li>
<li class="{% active clients %}"><a href="{{ clients }}">Clients</a></li>
{% if request.user.is_superuser %}
<li class="{% active towns districts %}">
    <a href="#">Settings</a>
    <ul>
        <li><a href="{{ towns }}">Towns</a></li>
        <li><a href="{{ districts }}">Districts</a></li>
    </ul>
</li>
{% endif %} 
```

标签是这样的：

```
from django import template

register = template.Library()

@register.tag
def active(parser, token):
    args = token.split_contents()
    template_tag = args[0]
    if len(args) < 2:
        raise template.TemplateSyntaxError, "%r tag requires at least one argument" % template_tag
    return NavSelectedNode(args[1:])

class NavSelectedNode(template.Node):
    def __init__(self, urls):
        self.urls = urls

    def render(self, context):
        path = context['request'].path

        for url in self.urls:
            if '"' not in url:
                cpath = template.Variable(url).resolve(context)
            else:
                cpath = url.strip('"')

            if (cpath == '/' or cpath == '') and not (path == '/' or path == ''):
                return ""
            if path.startswith(cpath):
                return 'active'
        return "" 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2012-11-11T21:02:54.387

我使用 jquery 来突出显示我的导航栏。此解决方案只是将 css 类“活动”添加到适合 css 选择器的项目。

```
<script type="text/javascript" src="/static/js/jquery.js"></script>
<script>
    $(document).ready(function(){
        var path = location.pathname;
        $('ul.navbar a.nav[href$="' + path + '"]').addClass("active");
    });
</script> 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-02-15T12:16:54.830

[对@tback](https://stackoverflow.com/questions/340888/navigation-in-django/20161408#20161408)的答案进行了一点改进，没有任何`%if%`标签：

```
# navigation.py
from django import template
from django.core.urlresolvers import resolve

register = template.Library()

@register.filter(name="activate_if_active", is_safe=True)
def activate_if_active(request, urlname):
  if resolve(request.get_full_path()).url_name == urlname:
    return "active"
  return '' 
```

像这样在您的模板中使用它：

```
{% load navigation %}
<li class="{{ request|activate_if_active:'url_name' }}">
  <a href="{% url 'url_name' %}">My View</a>
</li> 
```

并包含`"django.core.context_processors.request"`在您的`TEMPLATE_CONTEXT_PROCESSORS`设置中。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-06-02T10:43:40.123

稍微修改 Andreas 的答案，看起来您可以将 urls.py 中的路由名称传递给模板标签。在我的示例`my_tasks`中，然后在模板标记函数中使用反向函数来计算 URL 应该是什么，然后您可以将其与请求对象中的 URL 进行匹配（在模板上下文中可用）

```
from django import template
from django.core.urlresolvers import reverse

register = template.Library()

@register.tag
def active(parser, token):
    args = token.split_contents()
    template_tag = args[0]
    if len(args) < 2:
        raise template.TemplateSyntaxError, "%r tag requires at least one argument" % template_tag
    return NavSelectedNode(args[1:])

class NavSelectedNode(template.Node):
    def __init__(self, name):
        self.name = name

    def render(self, context):

        if context['request'].path == reverse(self.name[1]):
            return 'active'
        else:
            return '' 
```

**网址.py**

```
url(r'^tasks/my', my_tasks, name = 'my_tasks' ), 
```

**模板.html**

```
<li class="{% active request all_tasks %}"><a href="{% url all_tasks %}">Everyone</a></li> 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-11-23T10:52:45.517

我知道我迟到了。我不喜欢任何流行的解决方案：

[块方法](https://stackoverflow.com/a/341748/246241)似乎是错误的：我认为导航应该是自包含的。

[template_tag 方法](https://stackoverflow.com/a/477719/246241)似乎是错误的：我不喜欢我必须先从 url-tag 获取 url。另外，我认为 css-class 应该在模板中定义，而不是标签。

因此，我编写了一个没有上述缺点的过滤器。如果 url 处于活动状态，它会返回`True`，因此可以用于`{% if %}`：

```
{% load navigation %}
<li{% if request|active:"home" %} class="active"{% endif %}><a href="{% url "home" %}">Home</a></li> 
```

编码：

```
@register.filter(name="active")
def active(request, url_name):
    return resolve(request.path_info).url_name == url_name 
```

只需确保`RequestContext`在带有导航的页面上使用或在您的`settings.py`

```
TEMPLATE_CONTEXT_PROCESSORS = (
    ...
    'django.core.context_processors.request',
) 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-06-15T17:25:31.160

我看过[jpwatts](https://stackoverflow.com/a/341748/1528682)、[110j](https://stackoverflow.com/a/477719/1528682)、[nivhab](https://stackoverflow.com/a/656328/1528682)和[Marcus Whybrow](https://stackoverflow.com/a/15954946/1528682)的答案，但他们似乎都缺少一些东西：根路径呢？为什么总是活跃？

所以我做了另一种方式，更简单，让“控制器”自己决定，我认为它解决了大部分大问题。

这是我的自定义标签：

```
## myapp_tags.py

@register.simple_tag
def nav_css_class(page_class):
    if not page_class:
        return ""
    else:
        return page_class 
```

然后，“控制器”声明需要的 CSS 类（事实上，最重要的是它向模板声明了它的存在）

```
## views.py

def ping(request):
    context={}
    context["nav_ping"] = "active"
    return render(request, 'myapp/ping.html',context) 
```

最后，我在导航栏中渲染它：

```
<!-- sidebar.html -->

{% load myapp_tags %}
...

<a class="{% nav_css_class nav_home %}" href="{% url 'index' %}">
    Accueil
</a>
<a class="{% nav_css_class nav_candidats %}" href="{% url 'candidats' %}">
    Candidats
</a>
<a class="{% nav_css_class nav_ping %}" href="{% url 'ping' %}">
    Ping
</a>
<a class="{% nav_css_class nav_stat %}" href="{% url 'statistiques' %}">
    Statistiques
</a>
... 
```

所以每个页面都有自己的`nav_css_class`值要设置，如果设置了，模板会呈现活动状态：不需要`request`在模板上下文中，没有 URL 解析，也没有更多关于多 URL 页面或根页面的问题。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2018-01-03T13:19:21.140

受此[解决方案](https://stackoverflow.com/a/9801473/5739875)的启发，我开始使用这种方法：

```
**Placed in templates as base.html**

{% block tab_menu %}
<ul class="tab-menu">
  <li class="{% if active_tab == 'tab1' %} active{% endif %}"><a href="#">Tab 1</a></li>
  <li class="{% if active_tab == 'tab2' %} active{% endif %}"><a href="#">Tab 2</a></li>
  <li class="{% if active_tab == 'tab3' %} active{% endif %}"><a href="#">Tab 3</a></li>
</ul>
{% endblock tab_menu %}

**Placed in your page template**

{% extends "base.html" %}

{% block tab_menu %}
  {% with active_tab="tab1" %} {{ block.super }} {% endwith %}
{% endblock tab_menu %} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-03-14T07:37:49.300

这是我的尝试。我最终在我的视图中实现了一个包含我的导航结构（带有一些元数据）的类。然后我将它注入模板并渲染出来。

我的解决方案涉及 i18n。它可能应该再抽象一点，但我并没有真正为此烦恼。

视图.py：

```
from django.utils.translation import get_language, ugettext as _

class Navi(list):
    items = (_('Events'), _('Users'), )

    def __init__(self, cur_path):
        lang = get_language()
        first_part = '/' + cur_path.lstrip('/').split('/')[0]

        def set_status(n):
            if n['url'] == first_part:
                n['status'] == 'active'

        for i in self.items:
            o = {'name': i, 'url': '/' + slugify(i)}
            set_status(o)
            self.append(o)

# remember to attach Navi() to your template context!
# ie. 'navi': Navi(request.path) 
```

我使用这样的包含定义了模板逻辑。基本模板：

```
{% include "includes/navigation.html" with items=navi %} 
```

实际包含（includes/navigation.html）：

```
 <ul class="nav">
     {% for item in items %}
         <li class="{{ item.status }}">
             <a href="{{ item.url }}">{{ item.name }}</a>
         </li>
     {% endfor %}
 </ul> 
```

希望有人会发现这很有用！我想扩展这个想法来支持嵌套层次结构等会很容易。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-10-01T12:50:09.163

创建一个包含模板“intranet/nav_item.html”：

```
{% load url from future %}

{% url view as view_url %}
<li class="nav-item{% ifequal view_url request.path %} current{% endifequal %}">
    <a href="{{ view_url }}">{{ title }}</a>
</li> 
```

并将其包含在 nav 元素中：

```
<ul>
    {% include "intranet/nav_item.html" with view='intranet.views.home' title='Home' %}
    {% include "intranet/nav_item.html" with view='crm.views.clients' title='Clients' %}
</ul> 
```

您需要将其添加到设置中：

```
from django.conf import global_settings
TEMPLATE_CONTEXT_PROCESSORS = global_settings.TEMPLATE_CONTEXT_PROCESSORS + (
    'django.core.context_processors.request',
) 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-02-21T05:33:36.370

这是非常简单的解决方案，[https://github.com/hellysmile/django-activeurl](https://github.com/hellysmile/django-activeurl)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-10-28T13:48:22.773

从这个[SO 问题](https://stackoverflow.com/questions/7665514/django-highlight-navigation-based-on-current-page/7665655#7665655)

```
{% url 'some_urlpattern_name' as url %}
<a href="{{url}}"{% if request.path == url %} class="active"{% endif %}>Link</a> 
```

根据需要对每个链接重复。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-11-25T22:42:41.387

我还使用 jQuery 来突出显示它，发现它比使用非语义 Django 模板标签混乱模板更优雅。

下面的代码适用于引导程序 3 中的嵌套下拉菜单（突出显示父元素和子`<li>`元素。

```
// DOM Ready
$(function() {
    // Highlight current page in nav bar
    $('.nav, .navbar-nav li').each(function() {
        // Count the number of links to the current page in the <li>
        var matched_links = $(this).find('a[href]').filter(function() {
            return $(this).attr('href') == window.location.pathname; 
        }).length;
        // If there's at least one, mark the <li> as active
        if (matched_links)
            $(this).addClass('active');
    });
}); 
```

为当前页面添加`click`事件`return false`（或将`href`属性更改为）也很容易，无需更改模板/html 标记：`#`

```
 var matched_links = $(this).find('a[href]').filter(function() {
            var matched = $(this).attr('href') == window.location.pathname;
            if (matched)
                $(this).click(function() { return false; });
            return matched;
        }).length; 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-05-10T18:21:35.633

我将此 mixin 组合用于基于类的视图：

```
class SetActiveViewMixin(object):
    def get_context_data(self, **kwargs):
        context = super(SetActiveViewMixin, self).get_context_data(**kwargs)
        context['active_nav_menu'] = {
            self.request.resolver_match.view_name: ' class="pure-menu-selected"'
        }
        return context 
```

在模板中使用这个：

```
<ul>
    <li{{active_nav_menu.node_explorer }}><a href="{% url 'node_explorer' '' %}">Explore</a></li>
    <li{{active_nav_menu.node_create }}><a href="{% url 'node_create' path %}">Create</a></li>
    <li{{active_nav_menu.node_edit }}><a href="{% url 'node_edit' path %}">Edit</a></li>
    <li{{active_nav_menu.node_delete }}><a href="{% url 'node_delete' path %}">Delete</a></li>
</ul> 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-11-14T15:15:46.427

我的有点类似于之前提交的另一种 JS 方法......只是没有 jQuery......

假设我们在 base.html 中有以下内容：

```
<div class="pure-u-1 pure-menu pure-menu-open pure-menu-horizontal header" >
    <ul class="">
        <li id="home"><a href="{% url 'article:index' %}">Home</a></li>
        <li id="news"><a href="{% url 'article:index' %}">News</a></li>
        <li id="analysis"><a href="{% url 'article:index' %}">Analysis</a></li>
        <li id="opinion"><a href="{% url 'article:index' %}">Opinion</a></li>
        <li id="data"><a href="{% url 'article:index' %}">Data</a></li>
        <li id="events"><a href="{% url 'article:index' %}">Events</a></li>
        <li id="forum"><a href="{% url 'article:index' %}">Forum</a></li>
        <li id="subscribe"><a href="{% url 'article:index' %}">Subscribe</a></li>
    </ul>
    <script type="text/javascript">
        (function(){
            loc=/\w+/.exec(window.location.pathname)[0];
            el=document.getElementById(loc).className='pure-menu-selected';         
        })();   
    </script>
</div> 
```

我只是让我的层次结构遵循特定的 URL 模式......在主机地址之后......我有我的主要类别，例如家庭、新闻、分析等，而正则表达式只是将第一个单词拉出位置

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-10-04T09:15:10.227

**

只需像这样以 jinja 格式添加 url 和 name

**

> ```
>  <ul class="nav navbar-nav">
>         <li>
>            <a href="{% url 'index' %}">Cities</a>
>         </li>
>         <li>
>            <a href="{% url 'all_cafes' %}">Cafes</a>
>         </li>
>     </ul> 
> ```

# c# - 你用什么（免费）来格式化 C# 代码？

> ID：340911
> 
> 赞同：1
> 
> 时间：2008-12-04T15:11:04.660
> 
> 标签：c#, visual-studio, format

是否有任何 VS.NET 插件可以格式化用于打印或发送电子邮件的代码选择并且也是免费的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T15:13:21.020

你检查过 VS 提供的内置格式吗？选择代码并输入键和弦 Ctrl+K、Ctrl+F。

或转到（菜单）编辑->高级->格式选择或编辑->高级->格式文档

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T15:42:30.680

如果从 Visual Studio 复制代码并将其粘贴到 Word 中，将保留语法突出显示。

或者，您可以查看[Copy Source As HTML](http://www.jtleigh.com/people/colin/software/CopySourceAsHtml/)加载项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T15:43:26.963

这只是使用空格而不是制表符来缩进代码的问题吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T16:25:24.430

尝试艺术风格 1.22，[http://astyle.sourceforge.net/](http://astyle.sourceforge.net/)

它易于使用，具有 3 或 4 种预定义样式并且可配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T15:52:05.807

使用某种制表符到空格的功能，并确保打印或电子邮件使用`monospaced`（又名打字机或控制台）字体。

我很确定 VisualStudio 有一个（隐藏得很少）功能，可以将缩进从制表符转换为空格，反之亦然。

我通常在你可以使用的地方使用[vim ：](http://www.vim.org/)

```
:set expandtab
:%retab 
```

用空格替换制表符和：

```
:set noexpandtab
:%retab 
```

将空格替换为制表符。

空格更适合发送电子邮件等，因为没有人可以就选项卡的长度（以空格为单位）达成一致。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T18:12:13.590

要将制表符变为空格，请选择代码并使用`Editor -> Advanced -> Untabify Selected Lines`.

# asp.net - 使用 ASP.NET 进行缓存

> ID：340915
> 
> 赞同：1
> 
> 时间：2008-12-04T15:11:48.870
> 
> 标签：asp.net, caching

我有显示几个关键字的表单（很少更改的标准选择列表集）。大约有 4 个这样的字段，每个字段大约有 20 个左右的选择。

我在想缓存关键字是否有助于提高性能/最佳实践？是否有确定何时缓存的策略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T15:18:40.493

首先，您应该查看这些关键字的成本。

*   您是从数据库中单独查询它们吗？
*   您是否将他们作为一个群体进行查询？
*   它们是您简单写出的常量吗？

通常，在优化（IE 缓存）时，寻找能够为您带来最大回报的项目。

还要看看旧的 80-20 规则；大约 80 项数据只是杯水车薪，而 800,000 项数据的列表值得一看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T16:09:32.857

您可以在页面指令中使用 ASP.NET 输出缓存。

```
 <%@ OutputCache Duration="60" VaryByParam="Keyword" %> 
```

这将为每个关键字 GET/POST 请求创建页面的服务器端缓存，每个缓存将持续 1 分钟。

因此，如果有人访问`my-page.aspx?Keyword=Cards`asp.net 将呈现页面并将其作为 HTML 保存在内存中 60 秒。如果有人访问`my-page.aspx?Keyword=Books`它，它将在 HTML 中创建一个单独的页面版本并缓存它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T16:03:20.777

使用带有适当字段的惰性初始化单例来存储您的数据。例如 [http://www.yoda.arachsys.com/csharp/singleton.html上的这个单例](http://www.yoda.arachsys.com/csharp/singleton.html)

您可以将属性设置为类型

```
"IDictionary<string, IList<string>" 
```

如果您希望它们按类别组织并按关键字迭代。

您可以使用

```
"IDIctionary<string, IDictionary<string, string>" 
```

词典

如果您想按类别和关键字进行搜索。如果我正确阅读了您的问题，这对您来说是一个合适的选择

# modeling - M的有趣用途？

> ID：340924
> 
> 赞同：1
> 
> 时间：2008-12-04T15:13:52.860
> 
> 标签：modeling, m

我知道 M 是 Microsoft 的一种新语言，它的目标是作为一种建模解决方案，但我对用法/基本原理/优势仍然有些模糊。这就是为什么我要寻找人们用 M 做过的有趣的事情，这样我可以更好地理解它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T15:15:37.643

正如你所说，它是新的，所以你很难找到已经完成的事情。您最好的选择可能是看看 Microsoft 本身是如何使用该语言的。

# unit-testing - 使用数据库的 Web 应用程序中的单元测试

> ID：340930
> 
> 赞同：13
> 
> 时间：2008-12-04T15:15:18.207
> 
> 标签：unit-testing, dependency-injection

我正在构建一个 Web 应用程序，该应用程序将数据库用于用户、安全/角色并存储内容。

开始单元测试的道路对我来说似乎有点令人生畏，因为我必须确保我的数据库已正确初始化，以便我的测试运行。

在这方面有哪些常见的做法可以提供帮助？

即在开发/测试时，我可能会删除一个用户，但要让我的测试通过，该用户必须在数据库中，以及他的个人资料、安全设置等。

我知道我可以创建一个设置脚本，重新创建数据库等。

**我不想最终花费我的全部时间来维护我的测试并确保我的数据库处于同步状态**

或者这就是单元测试/TDD 的成本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-04T15:20:13.907

解决方案是模拟。模拟“替换”连接。被测单元将“连接”到 Mock 并执行其语句。Mock 返回正常的结果集

测试后，mock 可以为您提供所有方法的列表，这些方法由被测单元调用。[Easymock.org](http://www.easymock.org)

正如另一个所说：数据库连接不是单元测试。所以放下它，用 Mocking 对象在本地做

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T15:20:04.813

如果您要测试多个单元，则它不是单元测试。

通常，您将有一个组件（您的页面或业务层）与负责实际连接和查询数据库的数据层对象通信。我的建议是为第一个组件开发一个单元测试，使用依赖注入来传入 DataLayer 的*模拟*版本（它作用于硬编码的数据，或者你传入的 List 等）。这样，您就可以在与其他组件**隔离的情况下测试更高级别的代码。**

然后，您可以自由地为数据层开发其他单元测试（和集成测试），以确保它正确处理其工作（写入数据库）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-04T15:24:47.563

我们使用内存数据库 (hsqldb) 进行单元测试。在设置中，我们用测试数据填充它，然后在每个测试用例之前我们开始一个事务，在每个测试用例之后我们将它回滚。这意味着每个测试用例都有一个干净的数据库启动。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T16:09:15.650

听起来您实际上想要功能/集成测试。对于 Web 应用程序，我建议您研究[Selenium](http://selenium.seleniumhq.org/)或[Canoo WebTest](http://webtest.canoo.com/)。

这些也非常适合自动化您在 Web 上执行的任务。我有一个设置套件和一个拆卸套件，它们可以创建业务实体并通过管理界面测试用户以及面向客户的站点的测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T15:20:00.630

[Michael Feathers](http://www.artima.com/weblogs/viewpost.jsp?thread=126923)认为，与数据库通信的测试*不是*定义上的单元测试。这样做的主要原因是您提出的观点：单元测试应该简单且易于运行。

这并不是说您*不应该*测试数据库代码。但是您不想考虑它们的**单元**测试。因此，如果您进行任何数据库测试，您希望将测试与其余的单元测试分开。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T16:12:25.207

由于我使用 Doctrine 进行我的 PHP 数据库工作，并且由于 Doctrine 有一个查询抽象层（称为 DQL），我可以换掉后端而不必*过多*担心兼容性问题。因此，在这种情况下，对于我的单元测试，我会在测试开始时将架构和固定装置加载到 SQLlite 数据库中，测试我的模型，并在测试结束时丢弃 SQLlite 数据库。

通过这种方式，我测试了我的模型和数据访问，以确保它们的查询格式正确。

现在测试特定的数据库实例以确保当前模式正确是另一回事，恕我直言，它可能不属于您的单元测试，就像它属于您的部署任务列表一样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T15:26:05.393

单元测试/TDD 的代价是你必须改变你的设计，以便在数据库和领域层之间有一个清晰的分离，这样你就可以创建一个假的，允许你创建不会命中的测试数据库。

但更清洁的设计只是成本的开始。之后，您必须创建测试，既可以帮助您使代码在第一时间正常工作，又可以在有人破坏以前可以正常工作的东西时提醒您。

在您拥有一个良好的基础设计并通过测试保护您现有的功能之后，您会发现自己正在清理代码以使其更易于使用，并且确信您不会在此过程中破坏任何东西。

等等等等……随着时间的推移，单元测试/TDD 的成本不断增加。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T15:32:50.683

对于 Java，您可能还想查看 dbunit。[http://www.dbunit.org/](http://www.dbunit.org/)

# windows - 任何用于将任何文件递归转换为 tiff / 图像的好工具或库？

> ID：340931
> 
> 赞同：1
> 
> 时间：2008-12-04T15:15:19.017
> 
> 标签：windows, image, tiff, file-conversion

我们必须将所有内容转换为图像以进行存档。DOC、HTML、电子邮件、ZIP、PDF、TXT 以及您可以在计算机上阅读/查看的任何文档。此外，它必须对所有在 zip 中嵌入的附件和文件进行递归处理。

我只知道 ImgMaker。这是最好的还是我可以有更好的？我的老板让我搜索除了 ImgMaker 之外还有其他选择。

欢迎任何开源或盈利建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T22:28:35.223

围绕这种类型的功能建立了一个完整的行业，并且有许多服务提供商对每个文档收取费用来进行这种类型的转换。你最好购买而不是自己建造。

转换 Everything 的想法基本上是徒劳的，因为您需要一个可以渲染曾经创建的每种文件类型的单个程序（本质上是重新创建曾经编写数据文件的每个软件并重新创建每个版本的每个版本）。此外，并非每种文件格式都具有直接呈现形式的格式。例如，您如何处理数据库文件、DLL、XML 文件、WAV 文件？

如果您正在寻找可以对大量格式进行合理工作的东西，那么有两个主要的 OEM 工具包，但两者都非常昂贵，而且都不直接支持 Java 平台。如果您有任何其他问题，我会使用前者。

Stellent（现为 Oracle）OutsideIn：[http ://www.oracle.com/technologies/embedded/outside-in.html](http://www.oracle.com/technologies/embedded/outside-in.html)

Autonomy KeyView：[http ://www.autonomy.com/content/Products/idol-modules-keyview-viewing/index.en.html](http://www.autonomy.com/content/Products/idol-modules-keyview-viewing/index.en.html)

另一个可能的选择是像[Black Ice](http://www.blackice.com/Printer%20Drivers/PrinterDriverProducts.htm)这样的图像打印驱动程序，但它有几个问题，包括需要在运行代码的机器上的每个软件应用程序的副本，以及操作员关闭所有不可避免的对话框您在本机应用程序中打开文件。此外，对于 Excel 电子表格之类的内容，您通常需要对电子表格进行一些手动调整以使打印输出看起来正确（否则，您会在 tiff 中添加 900 页，而额外的一列不适合）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T16:20:53.050

我不知道这是否会有所帮助，因为听起来您想要完全自动化的东西，但是有许多伪打印机驱动程序可以创建 TIFF 图像作为输出。例如：

[http://sourceforge.net/projects/pdfcreator/](http://sourceforge.net/projects/pdfcreator/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T15:19:36.513

呃？您希望如何将 zip 存档转换为图像？像素应该显示什么？它应该是无损的，所以你可以转换回来吗？如果是为了存档，我猜这是一个要求，但这听起来很奇怪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T15:20:39.117

之后 tiff 图像会发生什么？假设您想以某种方式管理它们，在我看来，您最好寻找一些完整的文档管理产品，这些产品可以将这些文档类型作为输入并管理/存档（大概）大量图像会有。

否则你似乎在重新发明轮子。

如果你想要开源，比如[Alfresco](http://www.alfresco.com/products/solutions/ecm/im/)

请注意下面基于服务器的转换功能

> Alfresco 提供了一个集成存储库来管理图像管理、文档管理、Web 内容管理和电子邮件存储库中的所有格式的内容。该存储库是一个现代平台，具有：

*   任何数字资产的一个存储库
*   业界最具可扩展性、基于标准的 JSR-170 内容存储库
*   对 JSR-170、Web 服务和 REST 的标准支持
*   高可用性、容错性和可扩展性——自动故障转移和集群
*   通过 Web 服务、HTTP 和 HTTPS 进行安全分布式捕获
*   重复使用 Alfresco 业务政策规则
*   **基于服务器的多种格式之间的转换，包括 TIFF、JPEG、GIF、PNG、MS-Office、PDF 和 FLASH**
*   元数据提取和管理
*   自动分类框架

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-11-24T20:37:31.253

find 结合从 imagemagick takeit 转换来做递归会让你走得很远。我想要支持所有你想要的，你需要编写一个调用正确程序的脚本。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-12-04T16:19:25.237

所提出的问题无法明智地回答。一个明显的解决方案是通过附加 .tiff 来简单地重命名每个文件。例如，您可以获得 ringtone.mp3.tiff。虽然很疯狂，但没有多少更好的方法可以将 .mp3 转换为 .tiff。

请注意，这不是 IT 问题。业务假设一切都是图像，而音乐只是不存在的事物的微不足道的例子。

（澄清一下 - 这是假设一个自动设置，例如出于法律原因存档传入的电子邮件。如果需要，您也必须存档传入的 MP3。如果你有人类参与，这个问题不属于编程论坛. )

# c++ - 堆上的 C++ 多维数组

> ID：340943
> 
> 赞同：24
> 
> 时间：2008-12-04T15:18:41.397
> 
> 标签：c++, arrays, memory, heap-memory, allocation

我将如何动态分配多维数组？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-04T15:30:38.440

如果你已经知道嵌套维度的大小，你也可以使用 new 来分配一个多维数组：

```
typedef int dimensions[3][4];

dimensions * dim = new dimensions[10];
dim[/* from 0 to 9 */][/* from 0 to 2 */][/* from 0 to 3 */] = 42;
delete [] dim; 
```

代替`10`，可以传递运行时确定的值。因为它不是类型运算符 new 返回的一部分，所以这是允许的。例如，如果您知道列数，但又想保持行数可变，这很好。typedef 使代码更容易阅读。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-04T15:39:20.810

请参阅： [Marshall Cline 的 C++ 常见问题解答](https://isocpp.org/wiki/faq/freestore-mgmt#multidim-arrays)

请参阅“如何使用 new 分配多维数组？” 和“但是之前的常见问题解答的代码非常棘手且容易出错！难道没有更简单的方法吗？” 部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-04T16:20:43.333

为了完整起见，当您提前知道数组边界时，这是在 C++ 中执行此操作的更好方法。使用以下类的好处是您不必关心在数据上调用 delete[]。这意味着这个类将是异常安全的，以及所有其他关于[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)的好东西。

```
template<typename T, int width, int height>
class MultiArray
{
    private:
        typedef T cols[height];
        cols * data;
    public:
        T& operator() (int x, int y) { return data[x][y]; }
        MultiArray() { data = new cols[width]; }
        ~MultiArray() { delete [] data; }
};
```

用法：

```
MultiArray<int, 10, 10> myArray;
myArray(2, 3) = 4;
cout << myArray(2, 3);
```

**编辑：**并且，当我在这里时，如果您在运行时之前*不*知道数组边界，则可以使用以下设置：

```
template<typename T>
class Array2D
{
    private:
        const int width;
        T * data;
    public:
        T& operator() (int x, int y) { return data[y*width + x]; }
        Array2D(const int w, const int h) : width(w) { data = new T[w*h]; }
        ~Array2D() { delete [] data; }
};
```

用法：

```
Array2D myArray(10, 10);
myArray(3, 4) = 42;
cout << myArray(3, 4);
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-06T01:05:03.303

使用 Boost.Multiarray 怎么样？我相信它很好地满足了您的需求！ [http://www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/user.html#sec_introduction](http://www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/user.html#sec_introduction)

这是文档页面的摘录：

```
 #include < boost/multi_array.hpp >

 #include < cassert >

int main () 

{

  // Create a 3D array that is 3 x 4 x 2

  typedef boost::multi_array< double, 3 > array_type;

  typedef array_type::index index;

  array_type A(boost::extents[3][4][2]);

  // Assign values to the elements

  int values = 0;

  for(index i = 0; i != 3; ++i) 

    for(index j = 0; j != 4; ++j)

      for(index k = 0; k != 2; ++k)

        A[i][j][k] = values++;

  // Verify values

  int verify = 0;

  for(index i = 0; i != 3; ++i) 

    for(index j = 0; j != 4; ++j)

      for(index k = 0; k != 2; ++k)

        assert(A[i][j][k] == verify++);

  return 0;

} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-04T15:52:27.307

`std::vector<std::vector<int> >`应该提到，因为它通常是最简单的方法。但是，请注意它是非矩形的。并非每个人都`std::vector<int>`需要具有相同的长度。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-04T17:53:29.790

我很惊讶还没有人提到`boost::multi_array`。就在上周，我在一个程序中需要一个 2D 数组，发现它比我之前提出的自制解决方案更容易，编码也更快（所有这些都在其他评论中提到） .

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-04T15:23:57.910

这是我的实现；我声明了一个连续的`int`s 块，而不是在我的 for 循环中创建新块，所以我不会在所有地方造成页面错误。感谢 eJames 指出此代码最初被破坏的原因。

```
int width = 10, height = 10, totalSize = width*height;
int **myArray = new int*[width];
int *data = new int[totalSize];

for ( int i = 0; i < height; ++i )
{
    myArray[i] = data + (i*width);
}

// do some things here

delete[] data;
delete[] myArray; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-04T15:35:57.010

您的循环不会`myArray`正确写入指针值。我建议改为：

```
int width = 10;
int height = 10;
int ** myArray = new int*[width];
int * data = new int[width*height];
int * index = data;
for (int i = 0; i < width; i++)
{
    myArray[i] = index;
    index += height;
}

// ...

delete[] data;
delete[] myArray;
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-06T02:21:52.663

作为另一种选择，[STLSoft](http://www.stlsoft.org/)包括一个[fixed_array_2d](http://www.stlsoft.org/doc-1.9/classstlsoft_1_1fixed__array__2d.html)类（以及 3D 和 4D 版本）。与这里给出的自制解决方案相比，它具有类似的实现，但功能集更完整（完全支持迭代器等）。与 boost::multi_array 相比，它在不完全兼容的 C++ 编译器上更轻、更容易，但（故意）缺少 multi_array 的一些特性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T17:20:41.713

如果您只是在正确数量的元素上留出空间，则可以将一维索引为 2、3 或 N 维。例如，如果我有 10 行和 10 列，我知道如果我在第 3 行，我将必须遍历至少 30 个元素才能到达它。

不知何故，我更喜欢这种表示法用于简单的二维数组，因为我不需要担心指针的嵌套级别。缺点是更混乱的索引符号。这是一个具有 n 行和 m 列的二维数组的示例：

```
int *matrix = new int[n*m];

//set element (3,7) to 10
matrix[3*m+7] = 10;

//print the matrix
for (int i = 0; i < n; i++) {
  for (int j = 0; j < m; j++) {
    cout << matrix[i*m+j] << ' ';
  }
  cout << '\n';
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-05T14:31:47.067

这是另一个帖子上的帖子的复制。它完全符合您的要求，无需提前知道数组尺寸，也无需使用 boost 或 STL。

这是一个例程，它在连续的内存空间中分配维度为 N1 x N2 x N3 的 3D 数组，同时允许您使用 a[i][j][k] 语法进行运算符访问。该数组是动态但连续的，因此它比 vector<> 方法和 new[] 调用循环具有巨大优势。

```
template <class T> T ***Create3D(int N1, int N2, int N3)
{
    T *** array = new T ** [N1];

    array[0] = new T * [N1*N2];

    array[0][0] = new T [N1*N2*N3];

    int i,j,k;

    for( i = 0; i < N1; i++) {

        if (i < N1 -1 ) {

            array[0][(i+1)*N2] = &(array[0][0][(i+1)*N3*N2]);

            array[i+1] = &(array[0][(i+1)*N2]);

        }

        for( j = 0; j < N2; j++) {     
            if (j > 0) array[i][j] = array[i][j-1] + N3;
        }

    }

    cout << endl;
    return array;
};

template <class T> void Delete3D(T ***array) {
    delete[] array[0][0]; 
    delete[] array[0];
    delete[] array;
}; 
```

稍后在您的实施例程中...

```
int *** array3d;
int N1=4, N2=3, N3=2;

int elementNumber = 0;

array3d = Create3D<int>(N1,N2,N3);

//equivalently, a 'flat' array could be obtained with
//int * array = array3d[0][0];

cout << "{" << endl;
for (i=0; i<N1; i++) {
    cout << "{";
    for (j=0; j<N2; j++) {
        cout << "{";
        for (k=0; k<N3; k++) {
            array3d[i][j][k] = elementNumber++;
            cout << setw(4) << array3d[i][j][k] << " ";

            //or if you're using the flat array:
            //array[i*N2*N3 + j*N3 + k] = elementNumber++;

        }
        cout << "}";
    }
    cout << "}";
    cout << endl ;
}
cout << "}" << endl;

Delete3D(array3d); 
```

给出输出：

```
{
{{   0    1 }{   2    3 }{   4    5 }}
{{   6    7 }{   8    9 }{  10   11 }}
{{  12   13 }{  14   15 }{  16   17 }}
{{  18   19 }{  20   21 }{  22   23 }}
} 
```

# sql-server - 将数据从 SQL2005 存储过程导出到 CSV

> ID：340945
> 
> 赞同：0
> 
> 时间：2008-12-04T15:19:12.613
> 
> 标签：sql-server, sql-server-2005, csv, reporting

我想找到一种方法让我们的报告人员将从存储过程返回的数据导出到 CSV 文件中。该过程将需要一个（日期）参数传递给它。

是否有我可以让他使用的数据导出向导，或者 SQL2005 中的其他一些用户友好的方式，他可以生成 CSV（在提供一些参数之后）。

数据不一定必须来自存储过程，可以是视图或其他东西，但他必须能够在生成 CSV 文件时轻松提供一些预设约束。

感谢你们提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T15:44:41.017

根据您正在查看的工具，只需给他 SQL Server Management Studio。然后他可以执行存储过程并将结果保存为 CSV 格式。这是您能够以动态方式完成它的最优雅的方式。

否则，如果值不经常更改，您可能会考虑创建一个 SSIS 包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T16:15:40.473

查看 SQL Server 报告服务。您可以将报告结果导出到 Excel。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T16:19:07.547

我会设置一个带有几个过滤器选项和一个导出到 Excel 的按钮的小型 Web 应用程序。

这将消除对您的报告人员在 SQL Server 中工作的能力的任何依赖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-24T00:38:08.143

尝试

sqlcmd -S 服务器名（-E 或 -U -p） -d 数据库 -Q"exec storedprocedure" -s ","-o 文件名

从命令行

# asp.net-mvc - 在 ASP.NET MVC 中有哪些错误处理选项？

> ID：340947
> 
> 赞同：2
> 
> 时间：2008-12-04T15:19:35.670
> 
> 标签：asp.net-mvc

在 ASP.NET MVC 中我有哪些错误处理选项？

我是否在错误页面上调用 GetLastError 并发送电子邮件或记录它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T15:41:10.837

为什么不是[错误处理过滤器](http://quickstarts.asp.net/previews/mvc/mvc_HowToImplementHandleErrorFilter.htm)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T17:55:01.130

在您的 Global.asax 中，您可以实现以下内容：

```
protected void Application_Error()
{
    Exception lastException = Server.GetLastError();
    GetLogger().Fatal(lastException); // your custom loggin code
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T23:18:36.250

[McvContrib](http://www.codeplex.com/MVCContrib)具有“救援”属性——这是从 Monorail 借来的一个想法。你可以这样做：

```
[Rescue("default", AutoLocate = true)]
public class MyController : ConventionController 
```

然后根据约定创建救援视图，如下所示：

*   视图/共享/救援/Exception.aspx
*   视图/共享/救援/MyCustomException.aspx

等等。当控制器中发生未处理的异常时，救援过滤器将呈现与异常类型同名的页面。如果未找到完全匹配，则呈现 Exception.aspx。（我认为它可能会影响继承层次结构，直到找到匹配项。）

这些救援视图实现了 ViewPage<HandleErrorInfo>，因此在视图页面中，您可以将异常作为 ViewData.Model.Exception 访问。这是我将代码放在代码隐藏中的一个地方——记录异常——因为它提供了一个很好的应用程序边界。

如果不想使用 MvcContrib，可以研究代码实现自己的解决方案。

# eclipse - 如何在 ubuntu 和 windows xp 之间共享工作空间？

> ID：340959
> 
> 赞同：4
> 
> 时间：2008-12-04T15:21:51.640
> 
> 标签：eclipse, ubuntu, windows-xp

我正在使用 ubuntu 8.04 和 windows xp。我将包含 Eclipse 工作区的 fat32 磁盘安装到 ubuntu。但我发现我无法使用工作区，也许我无权使用它。

我安装的fat32磁盘有755正确，我尝试使用chmod将其更改为777但失败了。我尝试将其安装到 777 模式，但我发现 vfat 选项中的模式没有任何内容。

接下来我该怎么做？我如何共享工作空间？帮我。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-09T08:17:43.070

我建议不要尝试在两个不同的系统之间共享原始工作区数据，而是像在典型的大型软件开发项目中那样做。使用版本控制系统来存储您的代码并在该版本控制系统中提交/更新，而不是共享文件。

这可能不是您最初感兴趣的答案，但请放心，一段时间后您会注意到该版本控制系统的许多优点，包括：

*   在今天的“天才”变化之前轻松回到代码版本，这最终并没有真​​正起作用
*   有你的项目的备份，以防你的工作站死机
*   您甚至可以从完全不同的机器/位置访问您的项目。

如果您的项目要开源，您甚至可以使用[Sourceforge.net](http://sourceforge.net)等公共服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T19:31:46.893

I believe that the fat32 doesn't support the same kind of permissions as the linux ones you are familiar with. Once you have sorted out the `rw` option in `/etc/mtab` then I think you will have a better time.

However, the step after that is to have two different installations of Eclipse working on the same workspace.

I haven't had a lot of success with this (though haven't tried you're exact scenario), but I would be careful to:

*   keep the Eclipse versions in synch
*   only use relative paths, and relative to the workspace. This is probably good practice any way, but is worth repeating.

If all goes well, then you should be sharing everything, including preferences across both installations.

There are two refinements I can think of, which may be useful to reason about, if not actually do:

*   you could probably share most of the installation of eclipse (the `plugins` and `features` directory, if not the `config.ini` and `eclipse.ini` files). If you can't put both executables in the same directory, consider the `-install` and `-configuration` runtime options.
*   if you can't do any of these things, then you may need to work on two parallel workspaces. You can keep them in synch with tools such as `rsync` or even a distributed source control like Mercurial.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T13:41:27.440

我同意*bananeweizen.myopenid*，并有以下提示要添加：

创建构建路径条目时，请使用类路径变量引用所有外部资源（例如，jarfile）。这将允许您在环境之间移动 .classpath 文件（*如果您是唯一的开发人员*，甚至可以将其签入源代码管理），而不会遇到路径名问题。

要通过变量引用 JARFile，请进入构建路径的“库”选项卡，删除对该库的任何现有引用，然后单击“添加变量...”。您将需要定义公共变量，例如 M2_REPO 或 LOCAL_LIBS，并且您需要确保这些定义在您的所有环境中都可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T13:46:43.857

也许你遇到的问题是大写。请务必先在 Ubuntu 中创建工作区。这应该排除任何文件名大写问题。

# iphone - 无线电拨号类型功能，如在哪里？应用程序

> ID：340962
> 
> 赞同：1
> 
> 时间：2008-12-04T15:21:58.257
> 
> 标签：iphone, objective-c, cocoa-touch, user-interface

直截了当的问题。我正在尝试更多地了解 UI 设计以及如何使其与代码一起使用。特别是曾经有一个应用程序经历了几次设计会议，名为 Where To? 通过 Tap Tap Tap。他们有一张桌子，他们把它变成了一个收音机拨号盘，截图：

[![](https://i.stack.imgur.com/ymc2r.png)](https://i.stack.imgur.com/ymc2r.png)
[（来源：[taptaptap.com](http://www.taptaptap.com/blog/media/the-easy-way-to-get-into-the-iphone-app-game/WhereToSmall.png)）]

我的问题是，这只不过是 22 张左右的图像，不同的状态放在 UIView 之上吗？每个 UIImageView 都是一个按钮？这样的东西怎么组合起来？我喜欢关于以编程方式将图像转换为实际动作的教程。如果有任何描述该过程的书籍或博客，那对我来说将是一个理想的答案。

对上述如何完成有任何见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T15:59:23.237

我实际上认为这是一个单一的图像，它的图层响应触摸事件而旋转，然后根据与原始位置的径向距离计算哪个是活动按钮。这不是非常复杂的代码（触摸集改变是向左或向右并相应地旋转，修改 hittest 方法以尊重径向增量）但数学比我在六杯咖啡之前做的要多。

# dns - 如何远程管理 DNS 服务器？

> ID：340969
> 
> 赞同：3
> 
> 时间：2008-12-04T15:23:47.970
> 
> 标签：dns, bind

我想在一台服务器上创建一个 Web 界面来管理另一台服务器上的几个 dns 服务器。

### 如何以编程方式远程管理绑定 dns 服务器？

*   我想添加/编辑/删除区域。
*   我看到有 rndc 但只允许重新加载区域而不是添加/删除。
*   我可以 NFS 从 dns 服务器挂载区域并对其进行编辑，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-04T16:08:49.223

如果从头开始编写这样的东西没有硬性要求，为什么不简单地使用已经存在的接口而不必重新发明轮子呢？对关键字 bind dns web interface 进行简单的[Google 搜索会](http://www.google.com/search?q=bind+dns+web+interface)在第一个结果链接中生成完整的开源项目列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T12:25:40.420

IETF 正在为基于 Netconf 框架的名称服务器远程控制定义一个标准。看：

*   [https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-name-server-management-reqs](https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-name-server-management-reqs)
*   [https://datatracker.ietf.org/doc/html/draft-dickinson-dnsop-nameserver-control-00.txt](https://datatracker.ietf.org/doc/html/draft-dickinson-dnsop-nameserver-control-00.txt)

要求包括添加/删除区域的能力等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T15:59:52.517

您可以设置一些执行远程 SSH 命令的东西吗？不过，这可能有点不安全，除非运行命令的服务器本身已使用 SSH 密钥进行了预身份验证，这是您访问服务器的唯一方式。

# python - Python 3.0 的哪些特性会改变你的日常编码？

> ID：340972
> 
> 赞同：17
> 
> 时间：2008-12-04T15:24:42.057
> 
> 标签：python, python-3.x

Py3k[刚刚问世，](http://mail.python.org/pipermail/python-list/2008-December/518408.html)并且有很多[整洁的新东西](http://docs.python.org/3.0/whatsnew/3.0.html)！我很好奇，SO pythonistas 最兴奋的是什么？哪些功能会影响您每天编写代码的方式，或者您是否一直期待？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-04T15:55:35.847

有几件事我很感兴趣：

*   *文本和数据*而不是*unicode 和 8 位*
*   [扩展的可迭代解包](http://www.python.org/dev/peps/pep-3132)
*   [函数注解](http://www.python.org/dev/peps/pep-3107/)
*   二进制文字
*   [新的异常捕获语法](http://www.python.org/dev/peps/pep-3110/)
*   许多 Python 2.6 特性，例如：*with*语句

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-08T10:30:49.307

我希望[异常链](http://www.python.org/dev/peps/pep-3134/)能够流行起来。由于下面介绍的反模式而丢失异常堆栈跟踪一直是我的烦恼很长一段时间：

```
try:
   doSomething( someObject)
except:
   someCleanup()

   # Thanks for passing the error-causing object,
   # but the original stack trace is lost :-(

   raise MyError("Bad, bad object!", someObject) 
```

我知道，我知道，向原始异常添加一些上下文信息**并**保留原始堆栈跟踪是可能的，但它需要一个非常丑陋的 hack。现在你可以（而且**应该！**）只是：

```
raise MyError("Bad, bad object!", someObject) from original_exception 
```

并轻松获得上述两者。因此，作为我针对丢失堆栈跟踪的神圣使命的一部分：

伙计们，在重新提出异常时不要忘记**from**子句！谢谢你。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-04T16:57:32.400

坦率地说，没有。虽然我可能会发现自己使用了一些新语法，但我主要使用 Python 来编写快速简单的脚本和正则表达式。

我认为新功能将使很多小事对很多人来说更容易一些，而一些大事对少数人来说会更容易。然而，我对任何声称很多人最终会在生产力方面获得巨大收益的说法持怀疑态度。

简而言之，我认为这些变化总体上会让事情变得更好一些，但不要指望任何奇迹。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-08T08:40:24.413

没有那么多功能，但我认为库清理会很有帮助，尤其是。给新的 Python 程序员。在不止一次的情况下，我想在 python 中做一些事情，只是为了找到两个提供该功能的包含库，没有明显的理由为什么我应该选择一个而不是另一个。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-08T07:04:11.160

尽管他们为使用解释语言实现尽可能小的迁移过程做了什么，但我发现 python3 的整个版本是十年痛苦的迁移路径。所以我觉得它不是特别吸引人。

他们所做的改进都是好的和重要的。两种不同类型的字符串一直是无处不在的烦恼的真正来源，因此他们摆脱了 unicode 对象并引入了 bytes 对象，现在 unicode str 是很好的。

bignum 与 num 的变化是为了方便，我认为这也是一个不错的选择。总的来说，他们从过去十年中积累的有害成分中清除了语言。

他们做的第二件最糟糕的事情是实现速度慢了 10%，好像速度已经不是 python 的问题了。

我相信 python3 的发布会降低而不是提高 python 的声誉。现在，当涉及到库支持时，他们又回到了他们的语言的起点。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-08T09:48:06.147

不用做那么多..

*   不必担心使用`unicode()`or `u""`。

*   不必搜索文档`urllib` `urllib2`并`httplib`找到我需要对文件进行编码并通过 POST 请求上传的功能

*   不必担心是否`except TypeError, something:`会捕获一个`TypeError`and `something`，或者`TypeError`进入 `something..

相反，不得不再次查看文档！我现在对 python 已经足够了解了，我可以在不参考 pydoc 的情况下做大部分事情，但是每次我这样做时，我都会发现一些其他有用的模块或函数。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-04T23:33:58.170

打印声明。 `<sniff>`我已经开始想念它了。

实际上，甚至在进入 Python 2.6 之前，我们就已经`print`开始支持`logging.debug`. 这只是为了摆脱`print`随意使用调试、支持和开发的习惯。

剩下的是一些实际在标准输出上产生东西的程序。对于这些，我们可能会在我们的一个库中引入与 2.6/3.0 兼容的“打印”功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-08T07:08:09.247

字典理解不一定是惊天动地的，但它们非常好。

While`{k: v for k, v in list}`比`dict(list)`它更灵活和不言自明。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-08T11:35:09.223

Python 3 最被低估的特性之一是抽象基类的引入。这不会立即彻底改变 Python 编程，但代表了从松散的鸭子类型方法到更好定义的接口方向的有趣转变。

更多信息可以在[PEP 3119](http://www.python.org/dev/peps/pep-3119/)中找到。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-04T16:57:21.183

几乎所有这些都是因为我将 Python 3 的发布作为学习这门语言的动力。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-08T12:19:22.957

Unicode (utf-8) 对于生活在非英语国家的人们来说非常重要。

我不喜欢在文件开头指定编码，因为我总是忘记。通常我的文本与 ASCII 兼容，因为我使用的是 UTF-8，所以它在没有编码规范的情况下工作。但是如果我写我的名字（带重音）或€ 符号，它会中断......我最终用他们的 \uxxxx 表示写了 unicode 字符，但它有点神秘！

# economics - 供需模型

> ID：340975
> 
> 赞同：2
> 
> 时间：2008-12-04T15:25:25.817
> 
> 标签：economics

我想我会要求 SO 社区帮助我完成我目前正在从事的项目。我需要在市场情况下为小部件的价格建模。小部件的价格应该是当前供需的结果。用户将能够以固定价格购买和出售小部件。随着用户购买小部件，需求将随着价格上涨。相反，当用户出售小部件时，供应量会增加，价格会下降。小部件的数量和当前价格将与小部件的买卖总数一起存储在数据库中。

Protrade.com 有一个很好的购买和交易小部件（球员和球队）的例子，我想以类似的方式为我的系统建模。

是否有任何好的编程库可以根据供需情况准确地模拟市场？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T15:36:17.243

不幸的是，我不知道任何库，但也许您可以利用 Excel 的统计功能。

我的意见如下。

这就是为什么经济学如此无聊，一切都是供求关系。

以下内容应该作为开始：

```
ListPrice = (Cost + Profit) * (demand/supply * economic-factor) 
```

其中`economic-factor`是一些确定的常数。

如果您有一些历史数据，例如每日供需比率，您可以将其考虑在内，也许使用一些基于时间的尺度。

# java - 向打印机发送 JPanel

> ID：340981
> 
> 赞同：1
> 
> 时间：2008-12-04T15:27:46.810
> 
> 标签：java, swing, printing

是否可以仅将 JPanel 或任何其他组件发送到打印机？还是我必须手动实现对图形对象的所有绘图？

我尝试使用 JPanel 的 Print* 功能打印到图形对象，但打印的页面是空白的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-05T03:23:21.293

查看 Java 打印 API[和教程](http://java.sun.com/docs/books/tutorial/2d/printing/gui.html)以及 JComponent.print(Graphics)。

这是一个基本类，它将打印任何适合 1 页的组件（我不能对此表示赞赏，我从[Marty Hall 的教程](http://courseweb.xu.edu.ph/courses/ics10/swing/Printing.htm)中获得了代码）：

```
import java.awt.*;
import java.awt.print.*;
import javax.swing.*;

/**
 * Generic component printer.  This object allows any AWT or Swing component  (or DCT system)
 * to be printed by performing it pre and post print responsibilities.
 * <p>
 * When printing components, the role of the print method is nothing more than to scale the Graphics, turn off double
 * buffering, and call paint.  There is no particular reason to put that print method in the component being printed.  A
 * better approach is to build a generic printComponent method to which you simply pass the component you want printed.
 * <p>
 * With Swing, almost all components have double buffering turned on by default. In general, this is a great benefit,
 * making for convenient and efficient painting. However, in the specific case of printing, it can is a huge problem.
 * First, since printing components relies on scaling the coordinate system and then simply calling the component's
 * paint method, if double buffering is enabled printing amounts to little more than scaling up the buffer (off-screen
 * image) which results in ugly low-resolution printing like you already had available. Secondly, sending these huge
 * buffers to the printer results in huge print spooler files which take a very long time to print. Consequently this
 * object globally turns off double buffering before printing and turns it back on afterwards.
 * <p>
 * Threading Design : [x] Single Threaded  [ ] Threadsafe  [ ] Immutable  [ ] Isolated
 */

public class ComponentPrinter
extends Object
implements Printable
{

// *****************************************************************************
// INSTANCE PROPERTIES
// *****************************************************************************

private Component                       component;                              // the component to print

// *****************************************************************************
// INSTANCE CREATE/DELETE
// *****************************************************************************

public ComponentPrinter(Component com) {
    component=com;
    }

// *****************************************************************************
// INSTANCE METHODS
// *****************************************************************************

public void print() throws PrinterException {
    PrinterJob                          printJob=PrinterJob.getPrinterJob();

    printJob.setPrintable(this);
    if(printJob.printDialog()) {
        printJob.print();
        }
    }

public int print(Graphics gc, PageFormat pageFormat, int pageIndex) {
    if(pageIndex>0) {
        return NO_SUCH_PAGE;
        }

    RepaintManager                      mgr=RepaintManager.currentManager(component);
    Graphics2D                          g2d=(Graphics2D)gc;

    g2d.translate(pageFormat.getImageableX(),pageFormat.getImageableY());
    mgr.setDoubleBufferingEnabled(false);                                       // only for swing components
    component.paint(g2d);
    mgr.setDoubleBufferingEnabled(true);                                        // only for swing components
    return PAGE_EXISTS;
    }

// *****************************************************************************
// STATIC METHODS
// *****************************************************************************

static public void printComponent(Component com) throws PrinterException {
    new ComponentPrinter(com).print();
    }

} // END PUBLIC CLASS 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-04T15:51:19.147

[本教程](http://java.sun.com/docs/books/tutorial/2d/printing/gui.html)提到了翻译`Graphics`对象。你试过吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-20T07:35:03.117

请考虑将[这个答案](https://stackoverflow.com/a/49378186/1273555)打印`Component`到多页：

```
import java.awt.Component;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.print.*;

import javax.swing.RepaintManager;

public class PrintMultiPageUtil implements Printable, Pageable {
    private Component componentToBePrinted;
    private PageFormat format;
    private int numPages;

    public PrintMultiPageUtil(Component componentToBePrinted) {
        this.componentToBePrinted = componentToBePrinted;

        // get total space from component  
        Dimension totalSpace = this.componentToBePrinted.getPreferredSize();

        // calculate for DIN A4
        format = PrinterJob.getPrinterJob().defaultPage();
        numPages = (int) Math.ceil(totalSpace .height/format.getImageableHeight());
    }

    public void print() {
        PrinterJob printJob = PrinterJob.getPrinterJob();

        // show page-dialog with default DIN A4
        format = printJob.pageDialog(printJob.defaultPage());

        printJob.setPrintable(this);
        printJob.setPageable(this);

        if (printJob.printDialog())
            try {
                printJob.print();
            } catch(PrinterException pe) {
                System.out.println("Error printing: " + pe);
            }
    }

    public int print(Graphics g, PageFormat pageFormat, int pageIndex) {
        if ((pageIndex < 0) | (pageIndex >= numPages)) {
            return(NO_SUCH_PAGE);
        } else {
            Graphics2D g2d = (Graphics2D)g;
            g2d.translate(pageFormat.getImageableX(), pageFormat.getImageableY() - pageIndex * pageFormat.getImageableHeight());
            disableDoubleBuffering(componentToBePrinted);
            componentToBePrinted.paint(g2d);
            enableDoubleBuffering(componentToBePrinted);
            return(PAGE_EXISTS);
        }
    }

    public static void disableDoubleBuffering(Component c) {
        RepaintManager currentManager = RepaintManager.currentManager(c);
        currentManager.setDoubleBufferingEnabled(false);
    }

    public static void enableDoubleBuffering(Component c) {
        RepaintManager currentManager = RepaintManager.currentManager(c);
        currentManager.setDoubleBufferingEnabled(true);
    }

    @Override
    public int getNumberOfPages() {
        // TODO Auto-generated method stub
        return numPages;
    }

    @Override
    public PageFormat getPageFormat(int arg0) throws IndexOutOfBoundsException {
        return format;
    }

    @Override
    public Printable getPrintable(int arg0) throws IndexOutOfBoundsException {
        // TODO Auto-generated method stub
        return this;
    }
} 
```

# jquery - 使用 jQuery 切换图像

> ID：340983
> 
> 赞同：14
> 
> 时间：2008-12-04T15:28:48.150
> 
> 标签：jquery, image

是否有更好、更 jQuery 风格的方式来处理这种图像替换？

```
var image = $(obj).children("img");
if ($(image).attr("src") == "Images/TreeCollapse.gif")
   $(image).attr("src", "Images/TreeExpand.gif");
else
   $(image).attr("src", "Images/TreeCollapse.gif"); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-04T15:56:58.153

为什么在不需要时设置变量？

```
$(obj).children("img").toggle(
  function(){ $(this).attr("src", "Images/TreeExpand.gif"); },
  function(){ $(this).attr("src", "Images/TreeCollapse.gif"); }
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T15:45:51.203

更多 jQueryish？也许！更清晰？我不知道！

```
var image = $(obj).children("img");
$(image).toggle(
  function () { $(image).attr("src", "Images/TreeExpand.gif");},
  function () { $(image).attr("src", "Images/TreeCollapse.gif");}
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T15:51:24.983

你可以做这样的事情

例如

```
$(function()
    {
       $(obj)
       .children("img")
       .attr('src', swapImage );    
    });

function swapImage(){
    return ( 
              $(this).attr('src') == "Images/TreeCollapse.gif" ?
                                     "Images/TreeExpand.gif" :
                                     "Images/TreeCollapse.gif");
} 
```

请注意，在您的问题中，您多次执行 $(image) 。最好将查找缓存在 var 中，例如 var $image=$(obj).children("img"); 然后使用 $image 从那里开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T15:52:00.130

您的**图像**对象已经是一个 jQUery 实例，因此您无需再次通过**$(...)**传递它。

一个好的做法是在作为 jquery 实例的变量前面加上 $，然后直接使用它们。

```
var $image = $(obj).children("img");
if ($image.attr("src") == "Images/TreeCollapse.gif")
   $image.attr("src", "Images/TreeExpand.gif");
else
   $image.attr("src", "Images/TreeCollapse.gif"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T15:40:39.730

并不真地。

我知道...非常有帮助的答案。您正在做的事情非常简洁，我不确​​定是否有任何东西可以使它像您问的那样更加“jQueryish”。

现在，如果您对多个图像实例执行此操作，则取决于您如何迭代它，这可能是一些 jQuery 优化的地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-04T15:51:32.267

可能的替代方案：

*   使用[toggleClass](http://docs.jquery.com/Attributes/toggleClass#class)并将图像作为背景图像放在样式表中。
*   使用 2 张图像并[切换](http://docs.jquery.com/Effects/toggle)它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T15:54:53.383

哇。答案飞来飞去，不是吗？以上所有方法都可以，但是您可以尝试将其用于单线（未经测试）...

```
image.setAttribute("src", "Images/Tree" + ((image.getAttribute("src").indexOf("Collapse")>0) ? "Expand" : "Collapse") + ".gif"); 
```

更新：我刚刚对此进行了测试并且它有效，那么投票否决它的人会关心解释他们为什么这样做吗？

# asp.net-mvc - 允许使用 ASP-MVC 和表单身份验证访问特定页面

> ID：340984
> 
> 赞同：5
> 
> 时间：2008-12-04T15:29:12.687
> 
> 标签：asp.net-mvc, security, forms-authentication

这是我的视图的目录布局的简单概述：

项目

*   第 1 页
*   第2页
*   RSS

问题

*   第 1 页
*   第2页
*   RSS

我正在使用表单身份验证来拒绝对所有未经身份验证的用户的访问，这很好。但是，我希望能够向所有人授予对 RSS 视图的访问权限（这样他们就可以通过谷歌阅读器和其他东西订阅）

我了解您可以通过将以下页面添加到您的 web.config 来授予对页面的访问权限

```
 <location path="TOURPAGE.aspx">
<system.web>
  <authorization>
    <allow users="*" />
    <allow users="?" />
  </authorization>
</system.web> 
```

但是，我将如何使用动态制作的 URL 来执行此操作，例如：

```
Issues/RSS/chrisj 
```

*   该路径映射到称为 RSS 的问题中的控制器，该控制器接受用户名并吐出有关问题的 RSS ......

**编辑**

我认为一些答案已经解决了它，但是：

看来，至少在我的情况下，您仍然需要身份验证 cookie 才能看到该页面。只要您有 cookie，您就可以退出并查看它。

这对我没有好处，我需要页面完全公开，因为它是一个 RSS 提要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T15:38:54.213

这实际上比我想象的要简单得多。似乎.net很聪明，我尝试了以下方法：

```
 <location path="Issues/RSS">
<system.web>
  <authorization>
    <allow users="*" />
    <allow users="?" />
  </authorization>
</system.web> 
```

它奏效了:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T21:00:30.470

忘记 <location><allow /><deny /> 的东西......听起来你需要在你的动作上使用 [Authorize] 属性。

查看这些页面了解更多信息： [http ://www.asp.net/learn/mvc/tutorial-17-cs.aspx](http://www.asp.net/learn/mvc/tutorial-17-cs.aspx) [http://www.pnpguidance.net/post/ASPNETMVCFrameworkPreview4HandleErrorAuthorizeOutputCacheActionFilterAttributes.aspx](http://www.pnpguidance.net/post/ASPNETMVCFrameworkPreview4HandleErrorAuthorizeOutputCacheActionFilterAttributes.aspx)

此外，该属性也可以应用于控制器级别，因此您不必将其应用于每个单独的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T15:39:53.650

```
<location path="/Issues/RSS/">
<system.web>
<authorization>
<allow users="*" />
</authorization>
</system.web>
</location> 
```

编辑：顺便说一句，这是因为 .NET 假设 URL 进入一个目录，并且上面的这个位置标签说“'Issues/RSS'目录中的任何东西都是安全的 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T17:43:31.327

这可能无法按预期工作。

看来，至少在我的情况下，您仍然需要身份验证 cookie 才能看到该页面。只要您有 cookie，您就可以退出并查看它。

这对我没有好处，我需要页面完全公开，因为它是一个 RSS 提要。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T05:13:33.577

我同意 Charlino 的观点，即 [Authorize] 标签可能会解决您的问题。

如果您对 RSS 和页面都使用单个控制器操作（并且只是基于某些参数呈现不同的 ActionResult），您可以检查用户是否通过 验证`HttpContext.Current.User.Identity.IsAuthenticated`，并在控制器操作中使用它来决定是否继续并允许访问。

# performance - Elisp 在 Windows 和 Linux 上的性能

> ID：340989
> 
> 赞同：3
> 
> 时间：2008-12-04T15:30:31.763
> 
> 标签：performance, emacs, cross-platform, lisp, elisp

我有以下简单的 elisp 函数；第一个从当前段落中删除填充中断，第二个循环遍历当前文档，依次将第一个应用于每个段落，实际上从文档中删除所有单个换行符。它在我使用 emacs 22.3 的低规格 Puppy Linux 机器上运行得很快（600 页 Thomas Aquinas 需要 10 秒），但是当我使用 emacs 21.3 使用功能强大的 Windows XP 机器时，它需要将近一个小时才能完成相同的文档。我该怎么做才能让它在带有 emacs 21.3 的 Windows 机器上运行？

```
(defun remove-line-breaks () 
  "Remove line endings in a paragraph."
  (interactive) 
  (let ((fill-column 90002000)) 
    (fill-paragraph nil))) 
```

：

```
(defun remove-all-line-breaks ()
  "Remove all single line-breaks in a document"
  (interactive)
  (while (not (= (point) (buffer-end 1)))
       (remove-line-breaks)
       (next-line 1))) 
```

原谅我可怜的elisp；我在学习 Lisp 并开始使用 emacs 的力量时玩得很开心，但我还是新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T15:35:20.850

作为第一次尝试，您应该为您的 Windows 机器下载并安装 Emacs 22.3，然后比较速度。

升级后速度差异应该不会那么大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T15:42:47.573

也许这是您分配给 fill-column 的大值（他们建议小于 80）。

# apache-flex - 错误 #2099：加载对象未充分加载以提供此信息

> ID：340993
> 
> 赞同：2
> 
> 时间：2008-12-04T15:31:23.680
> 
> 标签：apache-flex, flash, actionscript-3

我有一个由 AS3 组件组成的 Flash 应用程序，我试图在 Flex 中运行。

在 Flash 中，将主要组件添加到舞台后，加载器对象 (loaderInfo.loader) 为空，这很好，我处理了它。

在 Flex 中，在 applicationComplete 事件中，我将主要组件添加到阶段，加载器对象的 getter 引发异常 - 错误 #2099：加载对象未充分加载以提供此信息。

此外，当加载的 SWF 文件的属性和方法可访问时调度的 INIT 事件未触发，这可能是问题的一部分。但我无法弄清楚为什么它没有被发送。

任何想法为什么相同的代码有两个不同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T21:45:16.790

我不确定这是否与 INIT 事件有关，但我知道在 flash player 9 中，我假设它是您的 SWF 版本？通过自己的 evt 目标引用加载程序存在错误。基本上，如果您正在加载某些内容并且您尝试通过 evt.target.loaderInfo.loader 访问加载程序的属性，它永远无法找到自己并抛出您在问题中描述的错误。我相信这是 flash player 9 的一个已知错误，已在 CS4 和 flash player 10 的发布中修复。

这是一个描述一些问题的线程的链接，希望对您有所帮助

[http://www.actionscript.org/forums/showthread.php3?t=137599](http://www.actionscript.org/forums/showthread.php3?t=137599)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T01:22:41.520

嗯，这似乎是一个令人沮丧的问题。当您说“主要组件”时，我想您是指 Flash 中的文档类？

我对 flex 的了解不足，无法评论您描述的问题，但我可以建议您尝试使用`ADDED_TO_STAGE`而不是`INIT`作为您的事件...

```
public class MainFlashClass extends Sprite {
  public function MainFlashClass() {
    addEventListener(Event.ADDED_TO_STAGE, onInit);
  }
  public function onInit(e:Event):void {
    removeEventListener(Event.ADDED_TO_STAGE, onInit);

    // do your initialisation code here
  }
} 
```

这可能适用于这两种情况。我发现`ADDED_TO_STAGE`它更有帮助，因为它总是被触发，无论是在执行 swf 时已经加载了类（如文档类），还是使用`Loader`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T09:07:17.717

您肯定需要发布代码，以便我们看得更清楚。

话虽如此，在 addChild 之后，您是在尝试为“主要组件”还是为您的 mx:Application 获取 loaderInfo？

伪

```
//onApplicationComplete event handler
var myswf:SWFLoader = new SWFLoader();
myswf.load(...);
addChild(nmyswf);

trace(myswf.loaderInfo.loader);
//end onApplicationComplete 
```

那是你在做什么？如果是这样，您需要向“主要组件”添加一个事件侦听器（假设是外部加载的 swf），以了解 Event.COMPLETE 何时发生。

```
var myswf:SWFLoader = new SWFLoader();
myswf.addEventListener(Event.COMPLETE, onMySWFComplete);
//..rest of code 
```

希望有帮助。如果没有，请发布代码。

# windows - MFC CFindReplaceDialog 销毁

> ID：340996
> 
> 赞同：0
> 
> 时间：2008-12-04T15:32:19.640
> 
> 标签：windows, mfc

如何`CFindReplaceDialog`正确销毁指向对象的指针？

例如我有课：

```
class CjumpView : public CRichEditView
{
   CFindReplceDialog *m_pFRDlg;
   // ...
}; 

CjumpView::CjumpView()
            : m_pFRDlg(NULL)
{

}

CjumpView::~CjumpView()
{
   if(m_pFRDlg != NULL)
   {
      m_pFRDlg->DestroyWindow();
      delete(m_pFRDlg);
   }
}

void CjumpView::OnEditFind()
{
    if(m_pFRDlg == NULL)
    {
        const bool fShowFind = true;
        m_pFRDlg = new CFindReplaceDialog();
        m_pFRDlg->Create(fShowFind, m_sFind, NULL, NULL, this)
    }

}

LRESULT CjumpView::OnFind(WPARAM, LPARAM lParam)
{
    LPFINDREPLACE lpFindReplace = reinterpret_cast<LPFINDREPLACE>(lParam);
    if(lpFindReplace->Flags & FR_DIALOGTERM)
    {
        m_pFRDlg->DestroyWindow();
            delete(m_pFRDlg);
            m_pFRDlg = NULL;
        return NULL;
    }
    lpFindReplace->Flags = 0;
    return NULL;
} 
```

在 Visual Studio`CFindReplaceDialog`帮助文章中，据说应该使用`new`运算符在堆中创建此类的对象。然后`Create`应该调用成员函数。

我的`OnFind`函数对关闭此查找对话框作出反应。它调用`DestroyWindow()`函数，试图删除对话框对象。

但是当我尝试调用或调用析构函数时`DestoyWindow()`，`OnFind()`我遇到了一个异常：

> 地址访问冲突...

如何销毁此对话框并删除指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T19:07:17.193

如果有人像我一样对这个问题感兴趣，那么解决方案很简单。实际上，您不必`CFindReplaceDislog*`在使用后删除指针。

关闭后，它会收到`WM_NCDESTROY`消息。并且就它的派生而言`CWnd`，`CWnd::OnNcDestroy()`处理程序被调用。在最后一行它调用`PostNcDestroy()`which 在 中什么都不做`CWnd`，但在 中被覆盖`CFindReplaceDialog`。它在那里删除'this'指针，如下所示：

```
void CFindReplaceDialog::PostNcDestroy()
{
    ASSERT(m_hWnd == NULL);
    delete this;
} 
```

因此，您不必在`delete(m_pFRDlg)`任何地方调用。

# java - Java堆中的constantPoolClass？

> ID：340997
> 
> 赞同：9
> 
> 时间：2008-12-04T15:32:31.963
> 
> 标签：java, memory

我继承了一个 Java 小程序（一个实际的 <APPLET>），它在运行大约 4 天后引发 OutOfMemory 异常。小程序的本质是人们真的会长时间打开它。

在运行了将近两天后， jmap -histo 将顶部堆消费者显示为：

```
    num #instances #bytes 类名
    --- ---------- ------ ----------
      1：14277 7321880 <常量池类>
      2：59626 5699968 <constMethodKlass>
      3：14047 5479424 <常量池缓存类>
      4：14277 5229744 <instanceKlassKlass>
      5：59626 4778944 <方法类>
      6：71026 3147624 <符号类>

```

问题是，我不明白这些东西是什么。至少有两件事发生：constantPoolKlass+constantPoolCacheKlass+instanceKlassKlass 出现相关，constMethodKlass+methodKlass 也是如此。从名称来看，它们似乎与类加载器有关。

如果我不得不猜测，我会说这个小程序创建了大约 14,277 个对象，其中每个对象有大约 4 个方法，总共大约 59626 个方法。然而，jmap 输出没有显示任何具有如此大量实例的类，看起来其他类对象的总和也不等于 14277。所以也许我对这些对象的作用不正确。有人可以解释吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-04T20:30:43.267

是的，看起来你正在泄漏类加载器。如果您实际上并没有在自己的代码中创建类加载器（通常通过 URLClassLoader.newInstance 或 XSLT），那么它可能与重新加载小程序有关（尽管您通常会得到相同的类加载器）。泄漏的可能原因是 ThreadLocal、JDBC 驱动程序和 java.beans。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-05T00:55:36.413

当场 - 显然是一个 ClassLoader 问题。不过，在小程序中看到这一点很奇怪；通常这只是应用服务器或 IDE 的问题。

2 种调试方法：要么得到一个真正的堆分析器，它可以显示你的失控类数据在哪里被引用，或者按照这里的描述修补 API 类： [http ://www.onjava.com/pub/a/onjava/2004 /06/30/classloader2.html?page=2](http://www.onjava.com/pub/a/onjava/2004/06/30/classloader2.html?page=2)

# sql - 将字符插入现有单元格

> ID：340998
> 
> 赞同：1
> 
> 时间：2008-12-04T15:32:42.510
> 
> 标签：sql, sql-server

我需要通过将相同的两个字符插入所有单元格来更新一组单元格，但我只是在如何做到这一点上画了一个空白。有人能指出我正确的方向吗？

**老细胞**
HI.1
HI.2
HII.1

**新电池**
H08I.1
H08I.2
H08II.1

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-04T15:37:31.237

```
UPDATE Cells SET Cell = LEFT(Cell, 1) + '08' + SUBSTRING(Cell, 1, LEN(Cell)-1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T15:36:49.800

如果您的所有单元格看起来像这样：

```
update cells
set cell = Replace(cell,'H','H08'); 
```

（但请注意，替换并不关心“H”出现在哪里）。

注意：我假设我们在这里谈论的是 SQL 和表 - 也许“单元格”是别的东西？***********