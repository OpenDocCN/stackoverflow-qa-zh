# StackOverflow 问答 1016000-1016999

# asp-classic - 经典 ASP 错误 405

> ID：1016008
> 
> 赞同：3
> 
> 时间：2009-06-19T01:32:51.410
> 
> 标签：asp-classic, iis-5

我的 wix XP 笔记本电脑上有几个开发站点（都是经典的 asp）。有谁知道为什么我需要输入 localhost/site/default.asp（我在 iis 5.1 上不断收到 405 错误）而不仅仅是 localhost/site

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T01:36:04.977

您需要添加“Default.asp”作为默认文档。 [从这个页面](http://www.webmasterworld.com/forum23/1678.htm)...

> 对于 iis 4.0 和 iis 5.0，更改执行如下：
> 
> 1.  启动 Internet 服务管理器（开始 - 程序 - 管理工具 - Internet 服务管理器）。
> 2.  展开计算机并选择网站。
> 3.  右键单击它并选择属性。
> 4.  选择文档选项卡。
> 5.  选中启用默认文档框并单击添加以添加新的默认名称。单击向上和向下箭头可以更改搜索顺序。
> 6.  单击应用，然后单击确定。

根据评论...好的，请[根据本文](http://www.somacon.com/p126.php)检查您的脚本映射设置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T01:35:08.210

听起来您需要将 IIS 中的默认文档类型配置为 default.asp。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T08:35:46.783

首先，我们需要清理网站的事情。您只有一个*网站*，即默认网站。（可以在 XP 上使用元数据库创建多个网站，但 IIS 5.1 将只为其中一个提供服务，其他的则必须停止）。

您有多个*应用程序*，它们是通用默认网站下的虚拟目录。

您是否检查过 Default.asp 是否在**应用程序**而不是网站的默认文档列表中？在 IIS 管理器中打开每个应用程序虚拟目录的属性对话框并检查那里的配置。

如果你有，那么你手上有一个奇怪的。在这一点上，我总是建议检查权限。应用程序是否允许匿名访问，如果允许，匿名用户是否有权访问文件夹和文件？

这可能看起来很奇怪，因为直接访问 default.asp 可以工作，但根据我的经验，当配置看起来不错并且应该可以工作但不是 90% 的时间是权限设置不正确的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-29T03:36:33.733

405 http 响应状态代码表示“方法不允许”。维基百科文章[HTTP 状态代码列表对](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_Client_Error)错误有以下定义：

> 使用该资源不支持的请求方法对该资源发出请求；例如，在需要通过 POST 呈现数据的表单上使用 GET，或者在只读资源上使用 PUT。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T04:38:03.767

你可以试试第三个XP PRO IIS Admin，它可以在IIS 5.1中添加多个站点，你可以毫不费力地切换站点。

# java - 用于 XML 的 Swing GUI 生成器

> ID：1016010
> 
> 赞同：1
> 
> 时间：2009-06-19T01:34:05.480
> 
> 标签：java, xml, swing, schema, dtd

我的应用程序有一个 XML 配置文件，用户现在可以在文本编辑器中对其进行编辑。我想提供一个（Swing）表单来编辑这个配置。我有一个用于 XML 的 DTD，但应用程序不接受由 DTD 验证的所有 XML 文档，即应用程序施加的限制比 DTD 中的限制更多。

我正要开始破解以了解如何进行此操作，但我想我会四处询问其他人使用过的方法。在给定 DTD 的情况下，是否有生成编辑器的库？任何提示，想法等？

**PS：**我的问题与[这个问题](https://stackoverflow.com/questions/983399/create-a-gui-from-a-xml-schema-automatically)类似，只是我需要一个 Swing GUI。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T04:29:00.667

除了您的基本 SAX 或 DOM 类型库之外，我认为没有这样的解决方案。有一个基于 DTD 的万能解决方案可能会有点困难，因为 XML 中的数据组织不一定直接对应于该数据的使用或实现。

# iphone - 与 UIFont 和 UIColor 相关的新手问题

> ID：1016017
> 
> 赞同：1
> 
> 时间：2009-06-19T01:38:49.667
> 
> 标签：iphone, cocoa-touch

我有几个与 UIColor 和 UIFont 相关的问题。

1.  我想知道如果我在启动时分配一堆 UIFonts 和 UIColors 对系统有多大影响，这是我在应用程序运行期间需要的。

2.  在运行时创建 UIFont 和 UIColor 是否昂贵？如果我预先分配相同的东西，它会以任何方式提高性能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T05:10:26.150

在需要时创建它们。请记住，内存很重要，Apple 会为您完成一些繁重的工作。相信操作系统对颜色和字体的优化。

# windows - 域后缀添加到 DNS 查询

> ID：1016026
> 
> 赞同：2
> 
> 时间：2009-06-19T01:50:50.360
> 
> 标签：windows, active-directory, dns

我有一个反复出现的 DNS 问题，一直困扰着我们的用户，有时会导致他们的笔记本电脑将我们公司的域附加到所有 DNS 查询的末尾。该问题仅在用户不在现场并且看起来相当随机时才会出现。它将工作一天，然后，它会突然显示无效条目。这主要影响 Windows XP 用户，但最近也出现在 Vista 上。这是一个使用 nslookup 的示例。

C:\Users\用户名>nslookup www.yahoo.com 服务器：Linksys 地址：192.168.0.1

非权威回答：名称：www.yahoo.com.MYDOMAIN.COM 地址：999.999.999.999

我已经用占位符替换了报告的 IP 地址，但我可以告诉你它返回的是默认的 *. 进入我们的网络解决方案配置。由于明显的 www.yahoo.com.MYDOMAIN.COM 不存在，因此这使得。我相信用户的内部设备运行正常。在内部，我们运行带有基于 Windows 的 DHCP 和 DNS 服务器的 Windows 2k3 Active Directory。最终问题通常会在几个小时或多次重新启动后自行解决。

有没有人见过这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:53:18.353

我在 Win XP 上遇到了同样的问题。我通过安装“便携式 DNS 缓存和防火墙”并指定阻止“*.com.mydomain.com”的规则来修复它。这会阻止所有对“.com”域的查询，这些查询试图解析为贵公司的子域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T02:26:05.080

我没有，但想到的情况是，您的系统可能正试图通过查看它们是否可以检索 .com TLD 的 NS 记录来确定是否附加域后缀，然后导致间歇性网络故障那张支票上的假阴性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T03:33:48.297

也可能是 DHCP/DNS 问题。部分 DHCP 回复可以包含有关搜索域的信息。通常，PC 在将查询发送到 DNS 服务器之前会尝试猜测是否需要附加搜索域。也可能需要调查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T04:08:54.830

还有很多可能性，所以看看你是否可以缩小范围。

您需要将问题隔离到特定系统上的特定应用程序。

您可能有一个错误配置的 DHCP 服务器（您可以将 DHCP 服务器上的租用日志与活动窗口进行比较）。您可能有一个行为不良的应用程序，它在没有 FQDN（应以句点结束）的情况下组成对解析器的调用。如果您的第一个查询失败（假设 DNS 请求超时），那么解析器可能会导致第二个查询将您的字符串视为 PQDN 并将其字面化为您看到的更长的 FQDN。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T19:34:59.113

nslookup 的默认行为是将域后缀附加到您的查询中。它会这样做，直到它得到某个问题的答案。

看来您可能暂时断开了网络。然后主机尝试解析一个名称，由于它无法解析 www.yahoo.com，它开始向其添加已知域后缀。您应该看到 www.yahoo.com.SUBDOMAIN.MYDOMAIN.COM、www.yahoo.com.MYDOMAIN.COM 和 www.yahoo.com.COM

如果一切正常（网络和 DNS 服务器），这应该不是问题。

# c# - 如何检测程序正在运行？

> ID：1016031
> 
> 赞同：1
> 
> 时间：2009-06-19T01:53:16.753
> 
> 标签：c#, detection

我编写了一个程序，它是一种非官方的、独立的应用程序插件。它允许客户获得比供应商拥有的服务价格更低的替代服务。我的程序不违反任何 TOS，当然也不是病毒、广告软件或类似的东西。话虽如此，供应商当然不高兴我参加他的比赛，并试图阻止我的应用程序运行。

他已经尝试了一些策略来阻止人们和他一起运行我的应用程序。他这样做了，所以如果检测到它，他的应用程序会抛出一个假错误。

首先，他通过寻找具有正确标题的打开窗口来检查我的程序是否正在运行。我通过在启动时随机化程序标题来反驳这一点。

接下来，他查找正在运行的进程名称。我通过在应用程序以 [random string].exe 启动时复制自身然后运行它来反驳这一点。

无论如何，我的问题是：他还能做些什么来检测我的程序是否正在运行？我知道您可以阅读窗口文本（即状态栏、标签）。我准备通过用图像替换标签来解决这个问题（呃，还有其他方式吗？）。

但还有什么？你能检测出程序加载了哪些 .dll 文件吗？如果是这样，这可以通过在加载它们之前随机化 dll 名称来解决吗？

我知道可以在内存中获取程序的签名并以这种方式对其进行跟踪（如病毒扫描程序），但他这样做的机会可能并不好，因为这听起来很先进。

尽管他这样做有点蹩脚，但它很有趣。这就像一个书呆子的拳头战斗。

**编辑：** 当我说它是一个插件时，这只是我使用的（不正确的）术语。这是一个独立的EXE。我的程序和另一个程序之间的“API”只是将数据输入控件（如文本框等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T02:09:28.187

我觉得回答这个问题有点脏，但已经晚了，我正在等待驱动器副本完成所以......

他可以使用校验和来识别您的可执行文件/dll。这绕过了重命名技巧。

您可以通过在启动时随机修改程序中的位来解决此问题（例如，更改资源、使用嵌入式版本等...）。

如果我是他，我也会开始寻找网络流量的模式；例如，如果您将客户引导至竞争对手，您正在从某个地方查找该信息，因此如果插件访问黑名单上的站点，请终止该过程和/或卸载库。

如果你玩猫捉老鼠的游戏足够远（例如，如果它被删除，shell 挂钩可以重新创建你的可执行文件/库），你可能会被防病毒软件标记为病毒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T02:34:35.780

你的竞争对手不是很运动。

将您的项目部署为未编译的加密源代码。编写一个解密和部署程序，可以随机化、重命名类、重新排列代码以避免任何特定的签名检测。

然后在客户端机器上使用 CSharpCodeProvider 编译代码来编译你的代码。您可以生成具有完全随机函数签名的随机程序集（我建议使用一个包含真实、常见单词的大型字典，而不是完全随机的。您可以将它们连接在一起以获得更多乐趣。例如 Live、Virtual、Space、Office、Network、 Utility.Space.Live.Network.dll、Utility.Virtual.Live.dll）。

每个客户端上的每个版本的程序都会有所不同。确保隐藏您的部署程序。也许它应该在安装您的自定义版本后自行删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T02:20:27.243

> 无论如何，我的问题是：他还能做些什么来检测我的程序是否正在运行？

*   你的程序是EXE还是DLL？
*   你称它为插件：插入什么？
*   您的程序是如何启动/启动/运行的？
*   您的程序如何“插入”？
*   你的程序和其他程序之间的 API 是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-09T22:08:28.670

*这不是对您最后一个问题的回答，而是对所描述问题的回答。*

如何修复其他应用程序。在标题中找到它正在寻找的字符串并更改其中的一些字母。

通过向他们提供对其他应用程序而不是您自己的应用程序的修复，让您的客户知道问题出在哪里。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-19T02:29:12.530

@ryeguy ...最好的防守是好的进攻恕我直言。在禁用你的进程之前，尽你所能禁用他的进程。

# c# - 在值类型上定义的扩展方法不能用于创建委托 - 为什么不呢？

> ID：1016033
> 
> 赞同：32
> 
> 时间：2009-06-19T01:56:23.033
> 
> 标签：c#, .net, extension-methods, delegates, value-type

扩展方法可以分配给与其在对象上的用法相匹配的委托，如下所示：

```
static class FunnyExtension {
    public static string Double(this string str) { return str + str; }
    public static int Double(this int num) { return num + num; }
}

Func<string> aaMaker = "a".Double;
Func<string, string> doubler = FunnyExtension.Double;

Console.WriteLine(aaMaker());       //Prints "aa"
Console.WriteLine(doubler("b"));    //Prints "bb" 
```

如果他们扩展的类型是值类型，它将不起作用：

```
Func<int> eightMaker = 4.Double;    //Error CS1113: Extension methods 'FunnyExtension.Double(int)' defined on value type 'int' cannot be used to create delegates
Func<int, int> intDoubler = FunnyExtension.Double;  //Works 
```

这给

> 错误 CS1113：在值类型“int”上定义的扩展方法“FunnyExtension.Double(int)”不能用于创建委托。

为什么他们不能？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-19T07:31:50.983

在回应我的其他回答时，埃里克史密斯正确地指出：

> “......因为它需要隐式装箱接收器类型参数......”。如果您执行以下操作，无论如何都会发生这种情况： Func f = 5.ToString; 这是完全合法的。

想到这一点，我有了一个新的答案。试穿这个尺寸：

结构上的普通“实例”方法在 CIL 级别采用“托管指针”（类型`&`）作为接收器参数。这是必要的，以便结构上的实例方法可以分配给结构的字段。参见[第 II 部分，第 13.3 节](http://download.microsoft.com/download/7/3/3/733AD403-90B2-4064-A81E-01035A7FE13C/MS%20Partition%20II.pdf)。

类似地，类上的实例方法将“对象引用”（type `O`）作为接收器参数（不同之处在于这是指向托管堆的指针，需要为 GC 进行跟踪）。

由于 CIL`&`和`O`s 都可以（并且正在）由指针实现，所以对于委托实现来说，一切都是笨拙的。不管委托是捕获静态方法、类实例方法还是结构实例方法，它所要做的就是将指向它的指针传递给`_target`函数的第一个参数。

但是我们正在讨论的场景破坏了这一点。`int`将 an作为第一个参数的静态扩展方法需要一个类型为 CIL 的参数`int32`（参见第 III 部分，第 1.1.1 节）。**这就是事情出轨的地方。**我看不出有什么理由让委托的实现*不可能*意识到这种情况正在发生（例如，通过检查与被捕获的 MethodInfo 关联的元数据）并发出一个可以拆箱`_target`并通过的 thunk作为第一个参数，但是*对于结构上的经典实例方法的委托来说，这不是必需的，因为它们无论如何都需要一个指针*并且没有出现（根据我之前不正确答案中的示例判断）要实施。显然，所讨论的特定值类型将控制所需 thunk 的确切性质。

除非我错过了一个更根本的实施障碍（例如，我可以想象它会给验证者带来问题），否则似乎可以提出一个合理的案例来扩展运行时以支持这种情况，但所有迹象都是指出这是运行时的限制，而不是 C# 编译器本身的限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T02:30:09.487

**编辑 2** 我不再相信这个答案，但我把它留在这里，所以这个线程仍然有意义，这样人们就会明白为什么它不正确。有关此事的不同看法，请参阅我的其他答案。

**原来的**

因为它需要对值类型接收器参数进行隐式装箱（因为保存接收器参数的 System.Delegate 类型中的 _target 字段属于 System.Object 类型），如果您没有预料到，这可能会导致一些奇怪的别名行为它。

**编辑**

这里还有其他事情发生。我运行了这个示例程序：

```
class Program
{
    public static int Combine(int a, int b)
    {
        return a + b;
    }

    static void Main(string[] args)
    {
        var combineMethod = typeof(Program).GetMethod("Combine");
        var add4 = Delegate.CreateDelegate(
                              typeof(Converter<int, int>),
                              4,
                              combineMethod) as Converter<int, int>;

        for (int i = 0; i < 10; i++)
        {
            Console.WriteLine(add4(i));
        }
        Console.ReadLine();
    }
} 
```

并得到一个 ArgumentException：“错误绑定到目标方法。” 在调用 CreateDelegate 时。我不知道为什么，因为相关的方法是一种`internalcall`方法，Reflector 并没有多大帮助。[CreateDelegate](http://msdn.microsoft.com/en-us/library/74x8f551.aspx)的文档也没有多大帮助。我确定这与接收器的拳击有关，也许了解转子源的人可以帮助解释原因？

# vector - 确定二维向量的大致方向

> ID：1016039
> 
> 赞同：2
> 
> 时间：2009-06-19T02:00:27.020
> 
> 标签：vector, 2d

我有一个相当简单的问题要问你。我觉得我早就应该找到答案，但不知何故我无法解决这个微不足道的问题。

给定一个向量 v = (x,y) ，我想知道它的“一般”方向。即“上”、“下”、“左”或“右”

如果矢量的方向在 45 到 135 度之间，则矢量的一般方向为“向上”。“左”在 135 到 225 度之间。“向下”在 225 到 315 度之间。“右”在 315 到 45 度之间。

我真的不关心角度正好是 45、135、225 或 315 度的情况。

问题是，我不想使用三角函数。我很确定有一个简单的解决方案。

我认为一个解决方案可以将整个圈子分成八部分。这是我到目前为止所拥有的。

```
if(x > 0 && y > x)
    return Up
if(x > 0 && y > 0 && y < x )
    return Right

... etc ... 
```

基本上，我知道我可以找到解决方案。我对你自己解决这个问题的方法更感兴趣。

谢谢 ！

**编辑**：使用的向量未标准化。您可以使用一对点来表示任何向量。简单地假设向量的原点是（0,0）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T02:26:50.367

确实有办法。你所要意识到的是，如果 abs(y) > abs(x)，那么方向是垂直的，否则方向是水平的。如果是垂直的，y 上的符号将指示上/下，否则，x 上的符号将指示左/右。所以：

```
if (abs(y) > abs(x)) {
  if (y > 0) up else down
} else {
  if (x > 0) right else left
} 
```

45ish 角总是向左或向右。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T02:17:38.340

我知道你说过你想避免触发，但你曾经使用过[atan2](http://www.cplusplus.com/reference/clibrary/cmath/atan2/)函数吗？确定矢量的角度非常容易：

```
double ldAngle = atan2(vector.y, vector.x) * 180 / PI; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T02:18:32.613

假设您正在做一个归一化的向量空间（**编辑：**意味着您的向量由[单位向量](http://en.wikipedia.org/wiki/Unit_vector)组成），您的方法是正确的，并且是最常用于 2d 游戏和动画的方法。不过，我会验证你的真值表。

@Daniel 的方法是更优雅的 IMO。

# iphone - 在 iphone 应用程序中下载多个文件（目标 c）

> ID：1016040
> 
> 赞同：4
> 
> 时间：2009-06-19T02:00:27.940
> 
> 标签：iphone, cocoa, cocoa-touch

在我的 iPhone 应用程序中，我想下载 IIS 上具有身份验证的多个文件。在一个按钮上单击我想开始下载过程。

我知道如何通过身份验证下载文件。

```
 NSURLRequest* request =
               [NSURLRequest requestWithURL:mMovieURL 
                             cachePolicy:NSURLRequestUseProtocolCachePolicy 
                             timeoutInterval:60.0];
    movieConnection =
            [[NSURLConnection alloc] initWithRequest:request delegate:self ]; 
```

我有几个使用上述代码的委托方法。

但是如何同时进行多个下载。

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T04:00:44.183

我不熟悉`MultipleDownload`，但如果它不能满足您的需求，我认为您有一个对象是 many 的委托`NSURLConnections`，并且您想知道如何保持它们的正确性。

委托方法都返回`NSURLConnection`自身作为它们的第一个参数。`NSURLConnection`因此，您可以通过测试哪些数据回电来跟踪哪些数据去了哪里。一种方法是`NSDictionary`将连接映射到其`NSMutableData`对象。现在的诀窍是，您不能将 an`NSURLConnection`作为字典中的键，因为它不符合`NSCopying`（而且您不希望它符合）。解决此问题的一种方法是使用连接的地址，例如：

```
NSString *key = [NSString stringWithFormat:@"%p", connection]; 
```

这将为任何对象返回一个唯一键（其地址的十六进制表示）。有些人`description`为此目的使用，但我不喜欢这样，因为它不是一个定义明确的接口。没有保证它是独一无二的。在我经常这样做的系统中，我`-stringWithFormat:`在一个名为的方法中实现上述内容，`-uniqueIdentifier`并使其成为一个类别，`NSObject`以便可以在字典中跟踪任何内容。

`NSURLConnection`我经常发现创建一个小的包装对象更容易，这样每个对象都可以控制自己`MultipleDownload`的任何其他有委托的东西。

**编辑：如 Peter 所述，将我上面的 %x 替换为 %p 。他是对的，我的想法不正确。仔细检查我的代码，我实际上一直在使用 %p，之前遇到过这个错误......**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T03:16:29.173

当我想同时下载 10 个 XML 文件时，我曾经这样做过（这比将它们一个接一个地排队下载要快得多）。我使用了这里找到的库：

[http://github.com/leonho/iphone-libs/tree/master](http://github.com/leonho/iphone-libs/tree/master)

它们很容易实现，首页上有一些示例代码可以帮助您入门。

```
self.urls = [NSMutableArray arrayWithObjects:
    @"http://maps.google.com/maps/geo?output=json&q=Lai+Chi+Kok,Hong+Kong",
    @"http://maps.google.com/maps/geo?output=json&q=Central,Hong+Kong",
    @"http://maps.google.com/maps/geo?output=json&q=Wan+Chai,Hong+Kong",
    nil];

self.downloads = [[MultipleDownload alloc] initWithUrls: urls];
self.downloads.delegate = self; 
```

祝你好运。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T14:30:47.020

我认为最简单的方法是使用 NSOperation - 和 NSOperationQueue。

这意味着您可以指定每个操作是顺序发生还是并行发生。您甚至可以限制并行操作的数量 - 以便一次最多运行 5 个（比如说），然后其他操作在后面排队。

这确实是让操作系统处理多个活动的好方法——并且与 iPhone 操作系统的延迟加载类型理念配合得很好。

然后，您可以让每个操作在完成时进行回调 - 甚至在主线程上进行进度回调。

我现在已经将我的代码更改为以这种方式工作，并发现它更加健壮且用户友好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-10T02:08:20.383

> 我不熟悉 MultipleDownload，但如果它不能满足您的需求，我认为您有一个对象是许多 NSURLConnections 的委托，并且您想知道如何保持它们正常。
> 
> 委托方法都返回 NSURLConnection 本身作为它们的第一个参数。因此，您可以通过测试哪个 NSURLConnection 给您回电来跟踪哪些数据去了哪里。一种方法是使用 NSDictionary 将连接映射到其 NSMutableData 对象。现在的诀窍是你不能让 NSURLConnection 成为字典中的键，因为它不符合 NSCopying （而且你不希望它这样做）。解决此问题的一种方法是使用连接的地址，例如：
> 
> NSString *key = [NSString stringWithFormat:@"%p", connection];

更好的方法是`NSValue`与`valueWithNonretainedObject`构造函数一起使用。这样，您可以从必要时访问密钥对象`NSDictionary`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T23:32:58.647

`NSURLConnection`是异步的并`init`立即退出。只需运行它多次。

```
NSArray *connections = [[NSArray alloc] initWithObjects:
  [[NSURLConnection alloc] initWithRequest:request1 delegate:self ],
  [[NSURLConnection alloc] initWithRequest:request2 delegate:self ],
  [[NSURLConnection alloc] initWithRequest:request3 delegate:self ],
  [[NSURLConnection alloc] initWithRequest:request4 delegate:self ],
  nil]; 
```

# sharepoint - “所有人”中不存在用户的 SharePoint 403 错误

> ID：1016041
> 
> 赞同：1
> 
> 时间：2009-06-19T02:00:28.877
> 
> 标签：sharepoint, profile, http-status-code-403

它很复杂，我将尝试在这里描述它。

1.  如果用户和他的组对 SP 站点上的任何内容都没有访问权限，则用户将在登录时获得正确的“错误：拒绝访问”SharePoint 页面。
2.  如果用户可以通过他的组成员身份访问某些东西，那么 a. 如果用户列在“所有人”列表中，则用户可以毫无问题地登录和使用该站点。湾。如果用户未在所有人列表中列出，则用户将获得 IIS 403 错误页面。回到服务器上，将出现“服务应用程序池'[IIS 应用程序池名称]'的进程与万维网发布服务发生致命通信错误”事件，这表明 IIS 应用程序池发生崩溃。如果用户热衷并不断尝试，他可能会频繁崩溃应用程序池，最终导致应用程序池停止，应用程序宕机！！！

我们正在使用表单身份验证和 Asp.net 成员提供程序和角色提供程序。看来，当 2b 发生时，SP 反复（应该只有一次）调用会员提供程序 GetUser 方法（直到出现致命的通信错误，我猜）。我相信它是用于 initila 用户配置文件导入的。发生 2a 时，不会调用 GetUser 方法。

我们可以手动执行一些操作，例如将用户添加到访客组，然后将用户从访客组中取出，这会将用户添加到所有人列表中，以便他能够登录。在手动过程中，成员资格提供程序 GetUesr 也被调用，但只调用一次并且工作正常。

这个问题最近才开始出现，并且只在一个环境中（生产！）。一切都很好，其他环境 UAT 和培训环境都没有这个问题。我们已经比较了环境并检查了所有明显的情况，找不到任何可能导致这种情况的差异。该产品有大约 110 个用户，比其他环境多，但仍然不多。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T04:39:12.903

Cause of the problem found. The advanced setting on All People list has got Item Level Edit permission set to none.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T03:00:11.297

根据下面的评论，在调用 Web 服务**之后**，GetUser 的自定义实现中似乎发生了错误。它也只发生在拥有最多数据的环境中。

因此，接下来要检查的是调用 Web 服务和返回 getuser 之间的代码。你有设置最大长度的数组吗？您是否对数组中的特定项目包含哪些数据做出任何假设？您如何检查/记录 Web 服务是否返回有效结果？

希望这可以帮助

设拉子

# javascript - Javascript 日期/时间函数是否依赖于客户端机器？

> ID：1016043
> 
> 赞同：13
> 
> 时间：2009-06-19T02:00:55.300
> 
> 标签：javascript, jquery, datetime

我想知道 Javascript 日期/时间函数是否将始终返回[正确的通用日期/时间](http://www.google.com/search?hl=en&rlz=1C1GGLS_enUS291US305&q=current+time&aq=f&oq=&aqi=g10) ，或者 Javascript 作为客户端语言，它们是否取决于客户端机器的日期设置。

如果它依赖于客户端机器，那么获得正确通用时间的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-19T03:17:23.323

Javascript 只知道它当前运行的环境的正确时间，并且 Javascript 是**[客户端的](http://en.wikipedia.org/wiki/Client-side_scripting)**。

因此，Javascript 受用户在他们正在浏览的 PC 上具有正确时间和时区设置的支配。

如果用户的时区不正确，但时间正确，则 getUTCDate() 等依赖于时区的函数将不正确。

如果用户的时间不正确，那么 Javascript 中所有与时间相关的函数都会不正确。

然而，有人可能会提出这样的论点，即如果用户想要在他们的 PC 上设置正确的时间，他们就会设置正确的时间。与之相反的是，用户可能不知道该怎么做。

2020 年 6 月编辑：现在操作系统从时间服务器自动更新计算机的系统时间很常见，这大大减少了客户端时间错误的可能性。仍然可能存在不正确的时*区*，但这也经常在安装过程中被系统以某种方式进行地理检测和/或与用户在其相关在线帐户中提供的居住国家/地区相关联。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T04:27:37.077

正如 thomasrutter 所说，javascript 日期函数依赖于客户端的机器。但是，如果您想获得一个权威的日期，您可以向您的服务器发出 ajax 请求，该请求只返回日期字符串。然后，您可以使用以下内容将日期字符串转换为日期对象

```
var ds = ... // Some ajax call
var d = new Date(ds); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T02:09:22.897

> 或者，Javascript是否是一种客户端语言，它们取决于客户端机器的日期设置。

是的，这是正确的。

> 如果它依赖于客户端机器，那么获得正确通用时间的最佳方法是什么？

从权威来源获取时间/日期，而不是从客户端计算机。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T02:03:04.207

这些方法做他们记录在案的事情。获取 UTC 信息的最佳方式显然是使用 UTC 方法：

[getUTCFullYear()](http://www.w3schools.com/jsref/jsref_getUTCFullYear.asp)、[getUTCMonth()](http://www.w3schools.com/jsref/jsref_getUTCMonth.asp)、[getUTCDate()](http://www.w3schools.com/jsref/jsref_getUTCDate.asp)等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-12T18:18:37.653

Javascript 的 date() 构造函数将始终获取本地机器的时间。

获得世界时间的最佳方法是

1）通过ajax调用从您的服务器获取时间。无论您的用户在哪里，此方法都会始终显示您的服务器时间。

2) 从第三方服务器获取时间。使用第三方服务器从世界任何时区/国家/地区获取时间。在这里，我通过使用普通的 javascript 和 axios 来解释这种方法。我使用的服务是[worldtimeapi.org/](http://worldtimeapi.org/)

**香草JS**

```
function getTime(url) {
    return new Promise((resolve, reject) => {
        const req = new XMLHttpRequest();
        req.open("GET", url);
        req.onload = () =>
            req.status === 200
                ? resolve(req.response)
                : reject(Error(req.statusText));
        req.onerror = (e) => reject(Error(`Network Error: ${e}`));
        req.send();
    });
} 
```

现在使用此函数进行 ajax 调用

```
let url = "http://worldtimeapi.org/api/timezone/Etc/GMT";

getTime(url)
    .then((response) => {
        let dateObj = JSON.parse(response);
        let dateTime = dateObj.datetime;
        console.log(dateObj);
        console.log(dateTime);
    })
    .catch((err) => {
        console.log(err);
    }); 
```

**AXIOS**

```
axios({
    url:"http://worldtimeapi.org/api/timezone/Etc/GMT",
    method: "get",
})
    .then((response) => {
        let dateObj = response.data;
        let dateTime = dateObj.datetime;
        console.log(dateObj);
        console.log(dateTime);
    })
    .catch((err) => {
        console.log(err);
    }); 
```

希望有帮助。但请记住一件事，[worldtimeapi.org/](http://worldtimeapi.org/)是第三方服务。如果他们选择终止他们的服务，您的代码将会中断。快乐编码。

# uml - 是否有任何具有版本控制支持的良好 UML 建模工具？

> ID：1016045
> 
> 赞同：2
> 
> 时间：2009-06-19T02:03:03.723
> 
> 标签：uml

我一直在互联网上搜索支持版本控制系统（如 svn）的 UML 建模工具，但我没有找到任何相关信息。有谁知道一个好的 uml 建模工具，最好是免费的，支持版本控制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T02:37:38.643

不是免费的，但 EnterpriseArchitect [Sparx Systems](http://www.sparxsystems.com.au)非常便宜，并且可以很好地与各种版本控制系统配合使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T14:47:49.230

你可以试试 BOUML：[http ://bouml.free.fr](http://bouml.free.fr)

它有一个“文件控制”插件，应该可以在 cvs、svn 和其他插件中发挥作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T02:06:07.380

如果你在 Mac 上，OmniGraffle 工作得很好，但我不会称它为全功能。

至于SVN，你为什么不把UML布局文件本身保存在SVN中，这样你就不需要集成了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T02:29:25.447

只是在黑暗中拍摄，但 Visual Paradigm 可能会成功。

# java - 本机进程的 Java 内存使用情况

> ID：1016053
> 
> 赞同：4
> 
> 时间：2009-06-19T02:08:38.453
> 
> 标签：java, windows, memory-management

调整使用本机 C++ 库的 Java 编写的服务器应用程序的最佳方法是什么？

环境是具有 4GB RAM 的 32 位 Windows 机器。JDK 是 Sun 1.5.0_12。

Java 进程在启动时获得 1024MB 内存 (-Xmx)，但由于堆空间不足，我经常看到 OutOfMemoryErrors。如果内存增加到 1200MB，则会由于交换空间不足而发生 OutOfMemoryErrors。JVM 和本机进程之间如何共享内存？

Windows /3GB 开关是否对本机进程和 Sun JVM 有任何影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T20:43:47.273

我在这个设置上遇到了很多麻烦（32 位系统上的 Java - msw 和其他），它们都通过为 JVM 保留不到 1GB 的 RAM 来解决。

否则，如前所述，该进程在系统中实际占用的内存将超过 2GB；在那一点上，我对这个过程进行了“无声的死亡”——没有错误，没有警告，只是这个过程非常安静地终止。

在同一个系统上运行多个 JVM（每个 JVM 的 RAM 低于 1GB）时，我获得了更高的稳定性和性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:31:23.227

我在这里找到了一些关于[JNI 内存管理](https://stackoverflow.com/questions/214699/jni-memory-management-using-the-invocation-api)的信息，这里是关于内存管理的 JVM JNI[部分](http://java.sun.com/j2se/1.5.0/docs/guide/jni/spec/design.html#wp16785)。

拥有 3GB 用户空间而不是 2GB 用户空间应该会有所帮助，但如果您遇到 2GB 交换空间不足的问题，我认为 3GB 只会让情况变得更糟。你的页面文件有多大？是极限了吗？

通过将 jconsole 连接到 jvm，您可以更好地了解堆分配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T03:59:16.383

> JVM 和本机进程之间如何共享内存？

Sun 的 JVM 的垃圾收集器是标记和清除的，具有启用并发和增量 GC 的选项。

好吧，更准确地说，它是分阶段的，以上仅适用于终身（长期）对象。对于年轻对象，GC 仍然使用停止和复制收集器来完成，这对于处理短期对象（并且所有典型的 Java 程序都会创建许多短期对象）要好得多。

复制收集器遍历堆中的所有元素，如果它们被引用，则将它们复制到新堆，然后丢弃以前的堆。因此，1M 的活动对象需要高达 2M 的实际内存：如果每个对象都处于活动状态，那么在垃圾收集期间将有所有内容的两个副本。

因此，JVM 需要的系统内存远远多于 VM 中运行的代码可用的内存，因为管理和垃圾收集的开销很大。

> Windows /3GB 开关是否对本机进程和 Sun JVM 有任何影响？

`/3GB`允许用户虚拟内存地址空间为 3GB，但仅适用于标头标有`IMAGE_FILE_LARGE_ADDRESS_AWARE`. 据我所知，Sun`java.exe`不是。我这里没有Windows系统，所以无法验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T04:20:47.857

不幸的是，你没有很好地解释你的问题。真正的问题是 --- 为什么 Java 进程增长如此之快。你有内存泄漏吗？你有真正的理由在 JVM 中拥有这么多数据吗？

Is the C++ library allocating its own memory from the C stack, or is it allocating memory from the Java object space, or is it doing something else entirely?

# svn - 虚拟主机上的 SVN

> ID：1016055
> 
> 赞同：5
> 
> 时间：2009-06-19T02:09:07.733
> 
> 标签：svn

我最近一直在接触 SVN。我决定要在我的虚拟主机空间上安装 SVN 服务器。我的主人是godaddy。所以这是我的问题：如何在 Godaddy 上安装 SVN。我可以通过 SSH 连接到服务器，并且服务器正在运行 Red Hat 4。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T02:26:41.460

我会联系godaddy，看看他们是否支持这一点。支持这样的应用程序确实取决于网络主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-06T02:29:24.740

在 redhat ES4 上，如果您有 root 访问权限，请 ssh 进入服务器并运行“yum install svn”。那应该获取并安装所有软件包和所需的依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T02:13:31.330

我没有为此使用 GoDaddy。但是，您应该能够使用 yum 或[http://www.collab.net/downloads/subversion/redhat.html](http://www.collab.net/downloads/subversion/redhat.html)上的二进制文件来安装它。另请参阅[this previous SO question](https://stackoverflow.com/questions/114555/setting-up-subversion-on-a-red-hat-system)。

一旦你安装了它，你可以将服务器设置为[svn+ssh](http://svnbook.red-bean.com/en/1.0/ch06s03.html)

编辑：你有root访问权限吗（例如su）？如果是这样，请尝试我链接的协作包。如果没有，您可能需要咨询 GoDaddy。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T02:21:34.667

取决于网络托管的类型。如果您拥有的只是虚拟 HTTP 托管，您可能可以将其下载到 SSH shell、构建它，然后将其安装到本地目录。然后你可以得到类似viewsvn CGI 引擎的东西，并将它指向你定制的subversion 可执行文件。

我最近不得不在 1and1.com 上使用 git 和 gitweb 进行此操作。这绝对是可能的。可能不如拥有自己的服务器那么灵活，而且您可能无法让 Subversion DAVFS 正常工作（这真是令人遗憾）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-26T15:17:34.147

对于那些希望设置 SVN 存储库然后使用 访问的人来说`SSH`，这里有一个很棒的教程。即使这篇文章不是来自 GoDaddy，设置也不会有太大的不同。

*   创建存储库/连接到存储库：[https ://www.a2hosting.co.uk/kb/developer-corner/version-control-systems1/configuring-subversion](https://www.a2hosting.co.uk/kb/developer-corner/version-control-systems1/configuring-subversion)
*   生成用于身份验证的 SSH 密钥：[https ://www.a2hosting.co.uk/kb/getting-started-guide/accessing-your-account/using-ssh-keys](https://www.a2hosting.co.uk/kb/getting-started-guide/accessing-your-account/using-ssh-keys)

**创建存储库，**

```
svnadmin create /home/USERNAME/REPOSITORY 
```

**使用工具（如[TortoiseSVN ）通过 SSH 连接到存储库](https://tortoisesvn.net/downloads.html)**

```
svn co svn+hosting://USERNAME@example.com/home/USERNAME/REPOSITORY 
```

# .net - 独立数据库

> ID：1016063
> 
> 赞同：10
> 
> 时间：2009-06-19T02:13:03.997
> 
> 标签：.net, database

我目前正在.Net 中设计一个小型应用程序，过去我一直使用 MSAccess 作为独立数据库，可以随程序一起提供。但是我想知道在这个时代是否没有替代解决方案，如易于集成到 .Net 应用程序中，对用户透明，并且可能在大量数据时获得更好的性能？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-19T02:18:10.570

您的选择是：

*   [方镁石](http://www.sqlite.org)
*   [火鸟](http://www.firebirdsql.org/)
*   Sql Server CE -已[弃用](https://connect.microsoft.com/SQLServer/feedback/details/776328/port-sql-compact-to-windows-rt)，最新版本，[4.0 SP1](https://www.microsoft.com/en-us/download/details.aspx?id=30709)已于 2012 年 8 月 31 日发布
*   [VistaDB](http://www.gibraltarsoftware.com/VistaDB) - 商业
*   [ESE](https://technet.microsoft.com/library/cc961824) - 很难与 .Net 集成

当您需要多线程写入时，SQL CE 和 Firebird 会快很多，sqlite 是单线程访问或多线程读取的王者。VistaDb 是 100% 托管的，因此您可以在嵌入式设备上发布它。

通常，这些数据库将为您提供更好的可靠性和访问性能。我强烈建议不要通过网络共享使用这些数据库中的任何一个。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T02:15:13.573

SQLite！这正是它的目的。

[http://www.sqlite.org/](http://www.sqlite.org/)

[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T02:15:58.827

是的。我会推荐[System.Data.SQLite](http://sqlite.phxsoftware.com/)，它是 SQLite 的 ADO.NET 包装器，[SQLite](http://www.sqlite.org/)是一种用 C 语言编写的流行嵌入式数据库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T02:19:38.213

[VistaDb](http://www.vistadb.net/)是另一个

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T02:15:37.940

SQLite 似乎符合您的需求——请参阅[此处](http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/)了解更多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T02:21:20.377

总是有[SQL Server CE ......](http://www.microsoft.com/Sqlserver/2008/en/us/compact.aspx)但我发现 SQLite 更容易使用，尤其是使用 System.Data.Sqlite

# apache-flex - getCharBoundaries 上的神秘坐标偏移

> ID：1016064
> 
> 赞同：0
> 
> 时间：2009-06-19T02:13:14.310
> 
> 标签：apache-flex, flash, actionscript-3, text

我在使用 getCharBoundaries 时遇到了一个奇怪的问题，我无法弄清楚从函数返回的坐标在哪个坐标空间中。我尝试过的一切都无法与我的预期相匹配。所以我做了一个新项目，并添加了简单的代码来突出显示文本字段中的最后一个字符，突然之间它工作得很好。然后，我尝试将导致我出现问题的 TextField 复制到新项目中。现在同样奇怪的偏移量出现在 x 轴上 50px 处。其他一切都恰到好处。因此，在比较了两个 TextField 之后，我根本看不出它们的属性或转换有什么不同。

所以我希望现在有人可能会影响 getCharBoundaries 返回的坐标。

我正在使用 Flash CS4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-06T13:34:56.050

那么 getCharBoundaries 返回文本字段坐标系中的边界。原点是文本字段的左上角。
getCharBoundaries 不考虑滚动。您需要检查其父级（textarea）上是否有滚动条，如果有，请重新定位。一种快速的方法是使用 localtoglobal 和 globaltolocal。使用第一个从文本字段坐标系转换到应用程序坐标系，然后使用第二个从应用程序坐标系转换到文本字段父级的坐标系，即文本区域。我正在微调我的方法来获取字符边界我今天将在我的博客 [http://flexbuzz.blogspot.com/上发布它](http://flexbuzz.blogspot.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-27T07:56:13.077

我刚刚遇到了完全相同的问题，并认为我会通过提供我的发现来提供帮助。在这个线程的帮助下，我试图找到关于我正在使用的文本字段的所有不是“默认”的内容。我发现当我将 TextFormatAlign（或 IDE 中的“align”）和 TextFieldAutoSize 属性切换为“LEFT”而不是“CENTER”时，它解决了问题。

也许在游戏中有点晚了，但对于遇到同样问题的人来说值得知道。这是我能找到的唯一一个引发正确标志的线程......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T02:42:52.050

为我工作（tm）（Flex Builder AS3 项目）：

```
[Embed(systemFont="Segoe UI", fontWeight="bold", fontName="emb",
    mimeType="application/x-font")]
private var EmbeddedFont:Class;

public function ScratchAs3()
{
    stage.scaleMode = 'noScale';
    stage.align = 'tl';

    var m:Matrix = new Matrix(.8, .1, -.1, 1.1, 26, 78);

    var t:TextField = new TextField();
    t.autoSize = 'left';
    t.wordWrap = false;
    t.embedFonts = true;
    t.defaultTextFormat = new TextFormat("emb", 100, 0, true);
    t.transform.matrix = m;
    t.text = "TEST STRING.";
    addChild(t);

    var r:Rectangle = t.getCharBoundaries(8);
    var tl:Point = m.transformPoint(r.topLeft);
    var tr:Point = m.transformPoint(new Point(r.right, r.top));
    var bl:Point = m.transformPoint(new Point(r.left, r.bottom));
    var br:Point = m.transformPoint(r.bottomRight);
    graphics.beginFill(0xFF, .6);
    graphics.moveTo(tl.x, tl.y);
    graphics.lineTo(tr.x, tr.y);
    graphics.lineTo(br.x, br.y);
    graphics.lineTo(bl.x, bl.y);
    graphics.lineTo(tl.x, tl.y);
} 
```

从字面上回答你的问题，它返回 TextField 坐标系中的坐标，而不是它的父级，并且它受 DisplayObject.transform.matrix 的影响，它是 .x, .y, .scaleX, .scaleY, 的支持。 width、.height 和 .rotation 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-10T10:59:31.413

解决方案是什么，添加一个新的 TextField 很简单，从来没有发现是什么属性搞砸了一切。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-15T19:52:06.530

在大多数情况下，第一个答案是正确的。但是，如果您的字段是另一个影片剪辑的父级，它仍可能返回错误的 y 坐标。试试这个代码：

```
//if this doesn't work:

myTextFormat = new TextFormat();
myTextFormat.align = TextFormatAlign.LEFT; 
myFieldsParent.myField.autoSize = TextFieldAutoSize.LEFT;
myFieldsParent.myField.setTextFormat( myTextFormat);

//try this:
var x = myFieldsParent.myField.getCharBoundaries(o).x;
var y = myFieldsParent.myField.getCharBoundaries(o).y;

var myPoint:Point = new Point(myField.getCharBoundaries(o).x,myField.getCharBoundaries(o).y);

var pt:Point = new Point(myFieldsParent.myField.getCharBoundaries(o).x, myFieldsParent.myField.getCharBoundaries(o).y);
pt = myFieldsParent.myField.localToGlobal(pt);

//pt is the variable  containing the coordinates of the char in the stage's coordinate space. You may still need to offset it with a fixed value but it should be constant. 
```

我没有测试这段代码，因为我已经从嵌入到我的项目中的代码中改编了这个示例，所以如果我遗漏了什么，我深表歉意......

# html - 为什么需要 HTML 字符实体？

> ID：1016080
> 
> 赞同：10
> 
> 时间：2009-06-19T02:19:11.847
> 
> 标签：html, xml, xhtml, encoding, standards

为什么需要 HTML 字符实体？它们有什么好处？我不明白这一点。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-19T02:24:05.350

两个主要的东西。

1.  它们允许您使用当前字符集中未定义的字符。例如，您可以合法地使用 ASCII 作为字符集，并且仍然可以通过实体包含任意 Unicode 字符。
2.  正如 Simon 所指出的，它们允许您引用 HTML 赋予特殊含义的字符。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-19T02:20:30.067

“ `1 &lt; 2`”让您将“ `1 < 2`”放入您的页面。

长答案：

由于 HTML 使用 ' ' 打开标签，如果你想将它作为文本`<`，你不能只输入 ' '。`<`因此，您必须有一种方式来表达“我想要页面中的*文本* `<`”。设计 HTML 的人（或者，实际上是 SGML，HTML 的前身）决定使用 ' `&`*something*`;` '，所以你也可以放置诸如不间断空格之类的东西：' `&nbsp;`'（不折叠或允许换行的空格）。当然，现在你需要有办法说' `&`'，所以你得到' `&amp;`'......

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-19T12:01:42.093

它们不是，除了`&amp;`, `&lt;`,`&gt;`和`&quot;`可能`&nbsp;`。对于所有其他字符，只需使用 UTF-8。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T22:55:21.047

在 SGML 和 XML 中，它们不仅仅用于字符。它们是通用的包含机制，它们用于特殊字符只是众多情况之一。

```
<!ENTITY signature "<hr/><p>Regards, <i>&myname;</i></p>">
<!ENTITY myname "John Doe"> 
```

这种实体对网站没有用处，因为它们仅在 XML 模式下工作，并且您不能在浏览器配置中不启用“验证”解析模式的情况下使用外部 DTD 文件。

* * *

实体可以递归扩展。这允许使用 XML 进行被称为“Billion Laughs Attack”的拒绝服务攻击。

* * *

Firefox 在内部（在 XUL 等中）使用实体来实现国际化和与品牌无关的消息（让 Flock 和 IceWeasel 的生活更轻松）：

```
<!ENTITY hidemac.label "Hide &brandShortName;">
<!ENTITY hidewin.label "Hide - &brandShortName;"> 
```

* * *

在 HTML 中，您只需要`&lt;`,`&amp;`并`&quot;`避免文本和标记之间的歧义。

所有其他实体基本上都被 Unicode 编码所淘汰，并且仅作为便利（但一个好的文本编辑器应该有可以替换它们的宏/片段）。

* * *

在 XHTML 中，除了基本的少数实体之外，所有实体都存在问题，因为它们不能与独立的 XML 解析器一起工作（例如`&nbsp;`，不能工作）。

要解析所有 XHTML 实体，您需要*验证*XML 解析器（选项通常称为“解析外部”），它速度较慢并且需要设置 DTD 目录。如果您忽略或搞砸了您的 DTD 目录，您将参与[W3C 服务器的 DDoS](http://www.w3.org/blog/systeam/2008/02/08/w3c_s_excessive_dtd_traffic)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T02:28:35.527

字符实体用于表示保留用于编写 HTML for.ex 的字符。<, >, /, & 等，如果你想在你的内容中表示这些字符，你应该使用字符实体，这将有助于解析器**区分内容和标记**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T02:41:07.793

您使用实体来帮助解析器区分字符何时应表示为 HTML，以及您真正想向用户显示的内容，因为 HTML 将为自己保留一组特殊的字符。

在 HTML 中逐字输入

> 我不是那个意思</sarcasm>

会导致“</sarcasm>”标签消失，

例如

> 我不是那个意思

因为 HTML 没有这样定义的标签。在这种情况下，使用实体将允许文本正确显示。

例如

> 不完全是！</讽刺>

给

> 不完全是！</讽刺>

如预期的。

# zend-framework - 学习 Zend Framework 1.8 时的难点

> ID：1016081
> 
> 赞同：5
> 
> 时间：2009-06-19T02:19:18.760
> 
> 标签：zend-framework

我是 Zend 框架的新手。

我下载了 Zend Framework，然后按照官方的快速入门教程构建了一个非常简单的注册表单。但在那之后，我发现很难学习 Zend Framework 的不同元素。

许多教程在引导文件中提到了 frontController 和 registerAutoload()。但是，我在 1.8 版本的代码中似乎再也看不到它了（在[官方快速入门教程](http://framework.zend.com/docs/quickstart/create-a-model-and-database-table)和[Zend Framework 1.8 入门中](http://akrabat.com/zend-framework-tutorial/)）。许多教程包含旧版本的代码，并且在 v1.8 中看起来非常不同。

我从编写带有密码确认的注册表单开始。我阅读了官方文档并找到了[用于密码确认的自定义验证器](http://framework.zend.com/manual/en/zend.form.elements.html)。它只是把课程放在那里，并没有提到我如何使用它。我不知道我应该把这个文件放在哪里，而且我在谷歌中找不到任何提示。“找不到类”错误总是让我感到恶心（我尝试过 addPrefixElement、set_include_path 但它们不起作用）。

用户注册、电子邮件激活、登录、访问控制是非常常见的任务。但是我什至没有找到可以在我的机器上运行的 v1.8 中的一段示例代码。我对 Zend 框架感到非常沮丧。

有人给我一些建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T02:36:17.617

我也刚开始学习zend框架。我还发现很多旧教程使学习变得混乱和困难，但是有一些资源可以帮助我学习 zend 框架：

*   [http://www.zendcasts.com/](http://www.zendcasts.com/) - 他们已经有关于 ZF1.8 的教程，比如使用 Zend_Application 进行引导等。

一些有用的博客可能会有所帮助：

*   [http://weierophinney.net/matthew/](http://weierophinney.net/matthew/)
*   [http://www.thomasweidner.com/flatpress/index.php](http://www.thomasweidner.com/flatpress/index.php)
*   [http://smartycode.com/zf/](http://smartycode.com/zf/)
*   [http://codeutopia.net/blog/](http://codeutopia.net/blog/)

论坛问你的问题：

*   [http://www.nabble.com/Zend-Framework-Community-f16154.html](http://www.nabble.com/Zend-Framework-Community-f16154.html) - 很多 ZF 开发人员似乎在这里回答您的问题 :) 比下面的 Zend 官方论坛要多得多......
*   [http://forums.zend.com/viewforum.php?f=69](http://forums.zend.com/viewforum.php?f=69&sid=e4855288290843a48c9b3032dae21ac5)

至于找不到类，我想你没有自动加载？

*   [http://framework.zend.com/manual/en/zend.loader.autoloader-resource.html](http://framework.zend.com/manual/en/zend.loader.autoloader-resource.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T07:56:04.367

Zend Framework 的部分内容在 1.8 版本中略有变化，但一切都应该向后兼容，因此使用 1.* 版本系列编写的所有代码示例都应该在很少或不需要修改的情况下仍然可以工作。不同的主要领域是

*   Zend Loader（与 register_autoload 相关）现在有一些与性能相关的改进，并且其 API 有一些细微差别（如果您使用旧方法，则会出现 PHP 警告）。作为初学者，我不会太担心这一点 - 只需按照教程或继续使用 include/require 语句，直到您对一直添加它们感到厌烦！

*   Zend 应用程序基本上允许您轻松创建设置和初始化代码。同样，您不必使用它，您可以愉快地编写一个手动引导类来让您习惯框架的组合方式。

关于入门，我强烈建议您了解 Zend 控制器组件，尤其是前端控制器部分和[此图](http://framework.zend.com/manual/en/zend.controller.basics.html)。对于身份验证，请参见[Zend Auth](http://framework.zend.com/manual/en/zend.auth.html)，对于电子邮件，请参见[Zend Mail](http://framework.zend.com/manual/en/zend.mail.html)，对于访问控制，请参见[Zend Acl](http://framework.zend.com/manual/en/zend.acl.html)，对于表单和验证，请参见[Zend Form](http://framework.zend.com/manual/en/zend.form.html)、[Zend Validate](http://framework.zend.com/manual/en/zend.validate.html)和[Zend Filter](http://framework.zend.com/manual/en/zend.filter.html)。表单和验证组件将解释路径并添加您自己的自定义验证器和表单元素。

另一个重要的领域是[Zend Db](http://framework.zend.com/manual/en/zend.db.html)，它允许您将数据持久保存到数据库中。还有代表 MVC 堆栈中的视图层的[Zend View 。](http://framework.zend.com/manual/en/zend.view.html)在我看来，这些是基本 ZF 应用程序的关键组件。从那里您可以在需要时探索其他组件。

不要忘记 Zend 框架是专门为松散耦合而设计的，并且很容易将来自另一个项目的不同组件用于特定任务。有时也有必要编写自己的组件。如果有一个组件您更愿意使用 Zend 组件，那么请继续这样做。

老实说，文档非常好，尽管对于初学者来说很难导航。一旦你了解了核心组件，一切都会变得更加清晰。

也尝试遵循[本教程](http://blog.astrumfutura.com/archives/351-An-Example-Zend-Framework-Blog-Application-Part-1-Introductory-Planning.html)。它将有助于解释许多基础知识。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-17T14:25:46.903

我推荐一个叫 Alex 的人提供的这些视频教程，他会保持更新并一直发布新的，它们都与 ZF 1.8 和 1.9 相关。

他甚至有一个详细的视频教程，涵盖 ACL、登录表单等（多亏了他，我在 Zend 的第一步变得更容易了！）

[http://alex-tech-adventures.com/development/zend-framework.html?start=15](http://alex-tech-adventures.com/development/zend-framework.html?start=15) - 他的网站有点令人困惑，但值得花时间弄清楚:)

干杯罗马

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-21T16:23:03.053

一些技巧：

**这是一个很好的调度过程图**

[http://nethands.de/download/zenddispatch_en.pdf](http://nethands.de/download/zenddispatch_en.pdf)

**如果您在 OOP / OOP 设计模式方面有经验，则更容易理解 ZF**

当我第一次偶然发现 ZF 时，我对 OOP 知之甚少。ZF 促使我学习 OOP，这是一件非常好的事情。

**区分 ZF 的“魔力”和实际的 ZF 架构**

尽管我对 ZF 类有很好的理解，但当 ZF 将其“魔法”添加到组合中时，我仍然感到困惑。

当我说“魔法”时，我指的是诸如

*   如果未指定，则加载和使用的默认对象，以及
*   url-controllername-filepath-filename 变形/命名约定。
*   配置设置到类实例化映射

ZF 有点像一个老牌经销商，“入门教程”让您立即上瘾。他们表演了如此多的魔法，让你觉得.oO（哇 - 多么简单！这个框架很酷！）

然后，一旦你开始尝试做自己的事情——魔法就开始变得非常混乱。

所以 - 我的策略是尽可能多地消除 ZF 魔法。如果您可以选择指定要使用的类或要使用的路由器，请指定它。不要让 Zend 为你做这件事。

然后，当发生奇怪的事情时，您可以更轻松地找到错误。

此外，如果您将类/路径的位置指定为（而不是让 ZF 神奇地改变路径并查找脚本），那么您不必担心“将其放在哪里？，放在哪里？- 你只要把东西放在你想要的地方，然后明确地将 ZF 指向它们。

随着您对 ZF 越来越熟悉，您可能希望让它接管并为您施展魔法。只有这样你才能真正理解为什么那个魔法很方便。

正如蒂姆·沃德尔在另一个答案中所说的那样——在你真正需要它之前，赞成使用要求语句而不是 zend 加载器。

如果您是一家每周生产 10 个网站项目的 PHP 设计公司，那么 ZF Magic 会非常有用。如果您正在设计您的第一个 ZF 应用程序，那么“降低复杂性”是比“可重用性”更重要的设计目标。

**浏览代码**

这似乎很明显，但了解 ZF 的最佳方法之一是查看代码。

再次，ZF 魔法可能会妨碍 - 我经常想查看方法的参数以发现我需要传递的内容，只是发现它需要一个模棱两可的“选项数组”（并不完全有帮助）。但是，过了一会儿，您开始注意到“选项键”如何与 getter/setter 方法结合使用的约定。因此，请继续查看代码并熟悉“ZF 方式”。

我'操作'帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-01T16:43:58.340

[Front Range PHP Users Group 网站上有一些关于 Zend 框架的演示文稿](http://www.frontrangephp.org/presentations)，可能有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-13T15:09:17.253

比利，我非常同情你。我是新手，旧方式和新方式之间的混淆几乎无法处理。另请参阅此处以了解指出一些主要区别的人：

[http://crossfunctional.wordpress.com/2009/05/](http://crossfunctional.wordpress.com/2009/05/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-02T17:34:02.417

所有文档，尤其是 Zend 的文档，都非常糟糕。这一切都假设您“知道”将它们所指的片段放在哪里以及它们如何协同工作。如果我已经知道这些事情，我就不需要文档了。没有可以下载和修改的具有身份验证等的完整示例应用程序。我非常后悔花时间尝试学习这个框架。我能找到的所有示例显然都是针对旧版本的。我在 youtube 上关注了一个专为 1.8 设计的身份验证。它无法在 1.9.x 中工作。不能让它为我的生活工作。Zend 框架彻底失望了！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-23T16:30:51.733

Zend Framework 已经从一个相对容易访问和简单的系统转变为一个更复杂的实体。在过去的几年里，它经历了许多快速的发展，留下了很多旧的文档。

我们有一些项目停留在 1.7.x 版本上，因为该版本与最新版本之间的差异太大，这使得开发和测试时间过于昂贵。

我喜欢 Zend Framework，因为它有很多深度，但对于初学者来说绝对是一把两刃剑。

我当然建议利用其他用户的专业知识并搜索一些简单的框架示例。ZF*具有*很强的适应性，但您需要尝试从最简单的情况开始工作以满足您的需求。

我认为 Matthew Weier o'Phinney（搜索“Phly, boy, phly”）是开发团队中比较平易近人的成员之一，并且在他的网站上有大量示例和想法。

祝你好运！

# php - 如何对 zend 框架中的不同模块使用不同的引导

> ID：1016083
> 
> 赞同：0
> 
> 时间：2009-06-19T02:19:59.600
> 
> 标签：php, zend-framework

我有两个模块，默认和 mojo。
在两个模块相同的初始引导代码之后，例如，我希望为每个模块使用不同的布局（或使用不同的凭据检查等）。
我在哪里放这个： IF(module=='mojo') 做这个 ELSE 做那个

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T07:30:45.977

如果您使用 Zend_Application（在 ZF1.8 中），那么您应该能够使用模块特定的配置选项来提供此功能，如[文档中相关部分中所述](http://framework.zend.com/manual/en/zend.application.available-resources.html#zend.application.available-resources.modules)。

这将要求您在配置中设置布局，使其看起来像

```
mojo.resources.layout.layout = "mojo"

anothermodule.resources.layout.layout = "anotherlayout" 
```

然后布局将由引导程序自动设置。

另一种选择是使用实现 preDispatch() 方法的前端控制器插件来根据模块名称设置布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T02:44:23.217

嗯我没试过这个

[http://www.nabble.com/Quick-Guide-How-to-use-different-Layouts-for-each-module-to23443422.html#a24002073](http://www.nabble.com/Quick-Guide-How-to-use-different-Layouts-for-each-module-to23443422.html#a24002073)

我现在这样做的方式是通过前端控制器插件

就像是

```
开关 ($request->getModuleName()) {
   案子 ””：
      // 设置布局 ...
}

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T10:42:47.927

几天前我研究了这个主题，试图让它单独在引导配置上工作。最大的问题是所有引导文件都已加载，因此在使用布局时会产生一些奇怪的结果。

我的结论是你可以有适当的配置，但你需要使用 FrontController 插件或 ActionController 助手。如果你想使用在 application.ini 中设置的配置并且你想通过引导程序加载配置，那么 helpers 是唯一的方法。然后，您可以从帮助程序加载 ActionController 并在其上执行 getInvokeArgs 以加载引导程序。很多麻烦... :)

无论如何，我在博客文章中做了一个小实现作为示例：[http ://blog.keppens.biz/2009/06/create-modular-application-with-zend.html](http://blog.keppens.biz/2009/06/create-modular-application-with-zend.html)

祝你好运，

杰伦

# cocoa - 如何在 main() 但在 NSApplicationMain 之外使用 NSLog？

> ID：1016093
> 
> 赞同：1
> 
> 时间：2009-06-19T02:26:01.680
> 
> 标签：cocoa, logging

我已阅读[questions/559482/why-doesnt-an-iphone-apps-main-function-ever-get-a-chance-to-finish](https://stackoverflow.com/questions/559482/why-doesnt-an-iphone-apps-main-function-ever-get-a-chance-to-finish)，这解释了为什么`NSApplicationMain`从未真正返回。同样的事情发生在桌面可可应用程序中（出于同样的原因），这就是我正在做的事情。

考虑到这一点，**当我的应用程序退出时，我****将如何使用它来输出一些最终的调试消息？`NSLog`**

具体来说，我想做这样的事情：

```
int myDebugVariable = 0;

int main(int argc, char *argv[])
{
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    CMLog(@"application begin");

    int exitCode = NSApplicationMain(argc,  (const char **) argv);

    CMLog(@"application end. Debugging variable = %d", myDebugVariable);

    [pool release];
    return exitCode;
} 
```

在此示例中，“应用程序开始”行打印到控制台，但“应用程序结束”。行不行。

**注意 #1：**在我的实际代码中，我使用的东西比`myDebugVariable`. 这是一个简化的示例，说明了我想要达到的效果。

**注意＃2：**我熟悉该`ApplicationWillTerminate`方法，当应用程序即将退出时会调用该方法，但它不适合我的需要。我的调试代码依赖于一些自定义类的方法，所以在调用`dealloc`after 之前它不会发挥作用。`ApplicationWillTerminate`

* * *

**更新：**

[亚当罗森菲尔德的回答](https://stackoverflow.com/questions/1016093/how-can-i-use-nslog-in-main-but-outside-of-nsapplicationmain/1016110#1016110)成功了。为了完整起见，这是一个可行的解决方案：

```
int myDebugVariable = 0;

void my_exit_handler(void)
{
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    CMLog(@"application end: Debugging variable = %d", myDebugVariable);

    [pool release];
}

int main(int argc, char *argv[])
{
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    CMLog(@"application begin");
    atexit(my_exit_handler);

    int exitCode = NSApplicationMain(argc,  (const char **) argv);

    [pool release];
    return exitCode;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T02:31:48.827

用于[`atexit(3)`](http://linux.die.net/man/3/atexit)注册退出处理程序。当您的应用程序退出时，它将自动调用，方法是完成 main 或调用`exit(3)`. 例如：

```
void my_exit_handler(void)
{
    NSLog(@"about to exit, x = %d\n", x);
}

// at some point during app initialization...
atexit(&my_exit_handler); 
```

# ruby-on-rails - 考虑到 v3 merb 合并的 Rails 开发

> ID：1016096
> 
> 赞同：0
> 
> 时间：2009-06-19T02:26:42.270
> 
> 标签：ruby-on-rails, merb

我正处于设计新 Web 应用程序的初步阶段，还没有开始任何形式的实施。该应用程序对一个相当复杂的域进行建模，使用 ruby​​ DataMapper ORM（在 .net 世界中使用 NHibernate）等工具比使用 Rails Active Record 更舒服。我也更喜欢 jquery 而不是原型。当然，所有这些考虑都指向使用 Merb，但我知道 Merb 正在合并到 Rails 版本 3 中，并且将不再作为一个独特的框架存在。

鉴于 Rails 发生了相当深刻的变化，现在开始实施应用程序有什么意义吗？我真的很想知道是否值得现在开始在 Merb 中进行开发，然后将其移植到 Rails，但我还没有找到任何暗示这可能有多困难的东西。另一种方法是现在在 Rails 中开始在域上工作，并且仅在 v3 发布后才考虑 ORM 和前端。

本质上，我想知道一个 Merb 应用程序对于 Rails 3 的可移植性，但我知道除了核心开发人员之外的任何人都知道这一点可能还为时过早。

任何想法将不胜感激。谢谢 ：）

- - - - - - - 编辑 - - - - - - - -

Merb 项目的首席开发人员 Yehuda Katz 在他的博客上这样说：

> 计划是立即开始在 Rails 上工作，并在此期间继续修复错误并解决 Merb 中的其他主要问题。我们还将发布专门用于帮助轻松过渡到 Rails 3 的 Merb 版本。
> 
> 特别是，我们将发布带有弃用通知和其他过渡机制的 Merb 版本，以帮助开发人员追踪将在 Merb 1.x 和 Rails 3 之间发生的变化。预计会有一些临时版本越来越接近 Rails 3，并且期望将部分 Merb（最显着的助手）移植到 Rails 3 上运行，以进一步减少摩擦。
> 
> 明确地说：我们并没有放弃 Merb 项目。有许多在 Merb 上运行的生产应用程序都依赖于及时的错误修复和通向未来的清晰道路。**如果您今天使用 Merb，请继续使用 Merb。如果您正在考虑将 Merb 用于项目，因为它可以更好地满足您的需求，请使用 Merb**。您不会被冷落，我们将尽一切努力确保您的应用程序不会被困在过去。
> 
> 如果您已经学习过 Merb，我们将努力确保您可以将这些知识运用到 Rails 3 中。在 Engine Yard，我们完全打算继续将 Merb 用于我们的内部应用程序，直到 Rails 3 推出，但我们会使用那些（非平凡的）应用程序来确保每个人的体验都是流畅的。不会有巨大的跳跃，您也不需要从头开始重写您的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T03:16:57.393

真的，现在不是在框架上启动复杂应用程序的好时机。似乎总会有重大升级或其他一些竞争框架可能是更好的选择。如果您在 Merb 上取得了更大的成功，那么现在就坚持下去，并毫无畏惧地开发您的项目！随着 Rails 3 的发布，Rails 和 Merb 社区都将不得不应对项目的合并，但这将是一段时间。

然而，项目合并并不意味着 Merb 会消失。Yehuda Katz 将不再担任首席开发人员，但有人会接管该项目。只要您关注官方的 Merb 开发人员存储库，您至少可以期待几年的安全补丁和错误修复。很可能，在 Rails 3 发布之后，您会发现关于将 Rails 2.x/Merb 1.x 应用程序升级到 Rails 3 的精彩演练。

# iphone - 最佳（任何）方式将 tableview 部分标题混合到分组 tableview 的顶部

> ID：1016102
> 
> 赞同：0
> 
> 时间：2009-06-19T02:29:02.313
> 
> 标签：iphone, cocoa-touch, uitableview

我想将部分标题添加到我的分组表视图的部分，但我希望它们看起来无缝（见图）。我们都知道，默认设置是分组表格视图单元格的第一行的圆顶角，因此当您合并它们时，它最终看起来像废话。

有什么方法可以指定何时 indexPath.row = 0 UITableViewCell 应该使用行样式“中间”或类似的东西？

如果没有，那么我有什么选择？我想我可以从头开始并使用第 0 行作为准标题，然后将我的数组数据 +1 来填充表格的其余部分？我宁愿不要从头开始自己动手……如果可能的话。

[样本表 http://img35.imageshack.us/img35/8181/sampletable.png](http://img35.imageshack.us/img35/8181/sampletable.png)

编辑：

“废话”看起来像这样：

[替代文字 http://img25.imageshack.us/img25/9748/crapsection.png](http://img25.imageshack.us/img25/9748/crapsection.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T08:06:15.563

1.  不要做你正在做的事，这是针对HIG的

2.  好的，好的，我会告诉你怎么做：

你会想要做你自己的单元格背景视图。默认分组的不是您想要的。

当 tableview 向您询问单元格时，请将其 backgroundView 和 selectedBackgroundView 设置为看起来适合其在 tableview 中的位置的内容。

通常，这意味着带有适当图像的 UIImageView，尽管您可以在这里使用自定义视图疯狂，但有一些陷阱。

所以在你的情况下，你会做

```
if (indexPath.row > sectionRowCount - 1) {
    //Not the last row
    //Put in the middle background
} else {
    //Put in the end background
} 
```

然后你会想要一个自定义的表格部分标题，但这很容易。

在您的情况下，您可能不必担心何时只有一排，这样事情就更容易了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:37:41.190

看看这里的教程： [cocoa with love](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html) 基本上你需要的是 3 个不同的图像。一个用于顶行，一个用于底部，第三个用于中间行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T20:02:46.547

您也可以不使用节标题，而是使用自定义单元格作为节的第一个单元格。因此，当 ([indexPath row] == 0) 时，返回一个作为“标题”的自定义单元格，然后返回其余的“常规”单元格（偏移一行）。您还必须调整 numberOfRowsInSection 函数以返回 +1。

# python - python导入相关模块

> ID：1016105
> 
> 赞同：0
> 
> 时间：2009-06-19T02:29:29.160
> 
> 标签：python, python-import, relative-path, python-module

我在同一目录中有 Python 模块 a.py 和 b.py。鉴于 a.py 可能已从另一个目录导入或直接执行，我如何可靠地从 a.py 导入 b.py？该模块将被分发，因此我无法对单个路径进行硬编码。

我一直在玩`__file__`sys.path 和 os.chdir，但感觉很乱。而且`__file__`并不总是可用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T02:37:02.967

实际上，`__file__`可用于导入的模块，但前提是它是从 .py/.pyc 文件导入的。如果该模块是内置的，它将不可用。例如：

```
>>> import sys, os
>>> hasattr(os, '__file__')
True
>>> hasattr(sys, '__file__')
False 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:05:03.300

使用[检查](http://docs.python.org/library/inspect.html)模块将使内置模块更加明显：

```
>>> import os
>>> import sys
>>> inspect.getfile(os)
'/usr/local/lib/python2.6/os.pyc'
>>> inspect.getfile(sys)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.6/inspect.py", line 407, in getfile
    raise TypeError('arg is a built-in module')
TypeError: arg is a built-in module 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-24T03:37:49.547

将包含两者的目录放在您的 python 路径中......反之亦然。

# java - 在哪里可以下载 common-annotations.jar

> ID：1016112
> 
> 赞同：2
> 
> 时间：2009-06-19T02:33:35.407
> 
> 标签：java, jakarta-ee

有一个 Spring 2.5 webapp，它在 1.6 下运行良好，但在 1.5 下它找不到 PostConstruct 类。

发现以下建议我需要 common-annotations.jar (JSR-250) 但找不到任何地方下载它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T02:39:46.503

参考实现可在此处获得：http: [//jcp.org/aboutJava/communityprocess/final/jsr250/index.html](http://jcp.org/aboutJava/communityprocess/final/jsr250/index.html)

参考实现 (RI) 和技术兼容性套件是[glassfish](http://glassfish.java.net/)的一部分。

换句话说，您最终可能不得不下载 GlassFish Application Server 来获取单个 jar 文件。

# java - 如何从 Emma 中删除/过滤/忽略某些包（代码覆盖率）

> ID：1016117
> 
> 赞同：6
> 
> 时间：2009-06-19T02:35:28.757
> 
> 标签：java, ant, filter, code-coverage, emma

我试图**从我的报告中删除一些包**并且遇到了问题。

有人能给我一些帮助吗？

我在我的*ant*进程中使用 EMMA。

* * *

`<!-- Generate the emma report both in xml and html -->
<emma>
  <report
    sourcepath="${build.report.src}"
    metrics="class:${coverage.classes.min},method:${coverage.methods.min}">     <fileset dir="${build.report.junit.data.dir}">
      <include name="*.emma"/>
    </fileset>
    <html outfile="${build.report.reports}/emma/raw.html" depth="method"/>
    <xml outfile="${build.report.tmp}/emma.xml" depth="method"/>
  </report>
</emma>` 

* * *

我试过使用： `<filter excludes="com.my.package.*"/>`

但**没有**成功:(

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-07-08T12:06:42.103

Emma 允许在**检测**阶段使用过滤器来指定一组需要检测的文件。相反，您正在尝试在**报告生成**阶段执行此操作。上面给出的 [链接](http://emma.sourceforge.net/reference/ch02s06s02.html#n11405)描述了如何定义检测集。

我使用过这样的过滤器：

```
<property name="emma.filter" value="-*.unittest.* -*.unittests.* -*.TST* -*TestCase -*Test -*TestSuite" />

<emma>
    <instr instrpath="${build.dir}"
        mode="overwrite"
        metadatafile="${build.dir}/coverage.em"
        filter="${emma.filter}" />
</emma> 
```

您还可以在 <instr> 下使用嵌套的 <filter> 元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T03:40:37.223

我假设您已经尝试过[文档中的](http://emma.sourceforge.net/reference/ch02s06s02.html#n11405)*所有*变体......？

如果是这样，我希望您可能有错字，或类似的东西。您能否提供正在使用的代码*以及*不起作用的排除语法，以及错误包含的类的源文件的标头？

# java - Java 脚本引擎在哪里使用？

> ID：1016128
> 
> 赞同：10
> 
> 时间：2009-06-19T02:39:47.563
> 
> 标签：java, scripting

如何有效地使用 Java 中的“脚本引擎”？

使用脚本引擎的所有正确用例是什么？

是否有使用“脚本引擎”的开源项目？

想到的一件事是“闭包，函数式编程”支持是可能的，但它更多的是技术用途而不是“应用程序需求”。

可配置的插件没问题。但是仍然有很多高级模式（访问者，装饰者）可以做同样的事情。

我不太了解需求...它在 Java EE 模式中的使用效率如何...它可以与现有模式相辅相成。

此外，我希望看到更多关于一些业务用例的答案。可能就像在销售期间根据会员资格或位置为产品找到复杂的折扣一样。查找复杂算法的排名。特别是为什么在某些情况下不是 Java？（或 .NET 世界中的 C#）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-19T09:54:45.250

在 Java 6 中，内置了脚本引擎支持。例如，

```
 // Create a script engine manager
    ScriptEngineManager factory = new ScriptEngineManager();

    // Create a JavaScript engine
    ScriptEngine engine = factory.getEngineByName("JavaScript");

    // Evaluate JavaScript code from String
    engine.eval("print('Hello, World')"); 
```

你为什么要用一个？一些原因：

1.  你有一个脚本语言的库，你想在 Java 中使用（例如，你可以通过 Jython 运行的 Python 库）
2.  您想为客户提供可配置的编程机制，以便他们可以提供简短的代码片段。例如，我过去曾这样做，允许客户使用 JavaScript 编写过滤器（例如 x < 2 和 y > 5 和 z > 10 ？）。
3.  您可以通过直接在配置文件中编写脚本，在 Ant 等工具中实现更复杂的逻辑
4.  您可以使用更适合该领域的语言实现解决方案（例如，通过 Clojure 使用 lambdas），但保持对 JVM 的依赖。

实现包括 Rhino（Javascript 的 Java 实现）、Jython（Java Python）等等。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-03-29T17:53:37.000

以下是我使用过的一些案例。

**1）Java要调用脚本语言，例1。**我有一个通过 WMD JavaScript 小部件接受用户评论的 Java 应用程序。（实际上与 StackOverflow 使用的小部件相同。）用户以 Markdown 格式输入评论，名为 Showdown 的 JavaScript 库在两个地方将其转换为 HTML：（1）在客户端，以支持实时预览；(2) 在服务器上，因为我希望客户端将纯 Markdown 发送到服务器并将其存储在那里，以便用户稍后可以编辑 Markdown（而不必以某种方式将 HTML 反转为 Markdown）。在服务器上存储评论时，我也会在那里运行转换，并将 HTML 存储在 Markdown 旁边，因此在显示评论列表时不必动态转换 Markdown。为了确保服务器上的 HTML 与客户端上的 HTML 匹配，我想使用完全相同的 Showdown 库。

**2) Java 想要调用脚本语言，示例 2。**我正在开发一个部署自动化应用程序，该应用程序涉及不同角色的利益相关者，例如开发人员、系统管理员和发布工程师。整个应用程序（工作流程和 UI）是一个 Java 应用程序，但在不同位置它调用各种脚本（例如 Ruby、bash），例如用于推送包、验证配置、安装包、冒烟测试等。这部分是因为脚本在表达目录创建、复制、移动、wgetting 等方面更好/更经济，部分原因是拥有该特定部分的人知道如何使用脚本语言而不是 Java。所以我们在这里使用 Java 的 Scripting API 调用脚本。诚然，在这种情况下，我们可以只在 Java 之外执行脚本，但请参见下面的 #3。

**3）脚本语言想调用Java。**在上述部署应用程序中，我们有基于 Web 的部署日志，并且我们付出了很多努力使部署日志尽可能易于阅读和理解，因为大量的开发人员/SQA/发布工程师会消耗这些日志，并且不是每个人都了解部署的所有细节。漂亮的印刷和颜色编码是该方法的一部分。我们在 Java 中实现了一个漂亮的打印部署日志 API，但我们希望能够让脚本调用它。因此，例如，当 Ruby 推送脚本运行时，我们希望它将其进度记录到漂亮打印机。在 JRuby 中运行 Ruby 允许 Ruby 脚本查看 Java 漂亮打印机 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T02:46:02.950

“使用脚本引擎的所有正确用例是什么？” 这是一个相当模糊的问题。有很多用例。以下是我能马上想到的几个：

1.  插件/扩展系统
2.  IDE
3.  带有现场演示的编程教程

我假设您特别指的是[JSR 223](http://jcp.org/en/jsr/detail?id=223)。如果是这样，您应该查看[scripting.dev.java.net](https://scripting.dev.java.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T11:47:51.730

我没有专门使用 JavaScript，但我已将 Groovy 集成到我的应用程序框架中以提供领域特定语言 (DSL)。我已经创建了挂钩到我的应用程序的函数和类。

允许用户在应用程序（宏）中编写常见操作脚本，并实现轻量级处理以避免更繁重的代码-编译器-jar-部署解决方案。如果用户对我的处理框架的插件有想法，他们可以通过 Groovy 实时进行原型制作，并在有时间（或需要速度时）移回 Java（甚至可能是本机）。请记住，脚本通常比 Java/C#/C/C++ 慢几个数量级

# .net - SQL Server 作为 Web 服务客户端

> ID：1016134
> 
> 赞同：3
> 
> 时间：2009-06-19T02:42:33.737
> 
> 标签：.net, sql-server, sql-server-2005, web-services, soap

假设给定一个 URL，[http ://test.org/service.asmx](http://test.org/service.asmx)

如何在 SQL Server 中使用 SOAP 方法访问服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T02:51:23.750

您可以[编写托管代码](http://www.devsource.com/c/a/Using-VS/Introducing-SQL-Server-2005s-CLR-Integration/)（C# 或 VB.NET）并从 SQLServer 运行它。当然，您可以使用 .NET 编写 SOAP 客户端。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T13:53:07.670

这也应该工作

```
Declare @Object as Int ;

Declare @ResponseText as Varchar(8000) ;

Exec sp_OACreate 'MSXML2.XMLHTTP', @Object OUT ;
Exec sp_OAMethod @Object, 'open', NULL, 'get',
    'http://www.webservicex.com/stockquote.asmx/GetQuote?symbol=MSFT', --Your Web Service Url (invoked)
    'false'
Exec sp_OAMethod @Object, 'send'
Exec sp_OAMethod @Object, 'responseText', @ResponseText OUTPUT

Select  @ResponseText

Exec sp_OADestroy @Object 
```

但我也认为最好编写一个您从 sp 中使用的 CLR 函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-30T10:59:12.493

我使用上述技术成功创建了一个 Web 服务 (SQL Server 2005)，它在 InfoPath 预览模式下填充列表框效果很好。当我将表单发布到 SharePoint 时，只有第一行填充列表框，而不是整个记录集。好文章，我真的很喜欢。我正在直接对 Web 服务进行一些研究，并且我发现宏测试 www.macrotesting.com 也是非常好的来源。谢谢你的文章......

问候...

梅加纳森..

# rule-engine - 与规则引擎相关的所有开放标准是什么？

> ID：1016139
> 
> 赞同：2
> 
> 时间：2009-06-19T02:44:01.860
> 
> 标签：rule-engine

如果我们需要使用可插入的规则引擎，与之相关的开放标准有哪些。

如何为每个平台“不重写规则”迁移规则引擎？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-24T15:41:59.650

JSR-94 是唯一广泛使用的标准，但遗憾的是，它不会帮助您重写规则，因为它只是调用引擎的标准。如果您想在支持多个规则引擎或从一个规则引擎迁移到另一个规则引擎时避免重写规则，那么您需要研究其他几个标准： [生产规则表示](http://www.omg.org/spec/PRR/)(PRR) 是 OMG 正在开发的标准。这定义了规则引擎中规则和规则集的基本结构，以便可以传递包含规则的 XML 结构。这是测试版，并且得到了大多数主要规则供应商的支持（尽管我认为还没有发布支持）。 [规则交换格式](http://www.w3.org/2005/rules/wiki/RIF_Working_Group)(RIF) 是 W3C 正在开发的标准。这与 PRR 保持同步，并专注于规则的语法 - 如何指定条件等。这也得到广泛支持，但类似的支持尚未发布。这个想法以及两个团队合作的原因是允许根据 PRR 构建规则（允许它们在建模工具和规则引擎之间共享），同时将特定于规则引擎的语法导出到 RIF，以便特定规则可以从语法转移到语法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T02:51:47.990

[维基百科](http://en.wikipedia.org/wiki/Business_rules_engine)说

> 大多数基于 Java 的规则引擎提供基于[JSR-94](http://jcp.org/en/jsr/detail?id=94)应用程序编程接口 (API) 标准的技术调用级接口，以允许与不同的应用程序集成，并且许多规则引擎允许通过 Web 进行面向服务的集成WSDL 和 SOAP 等基于标准的标准。

总的来说，这仍处于早期阶段，我认为该领域还没有主导标准。另请参阅[规则标记倡议 (RuleML)](http://ruleml.org/)。除了 JSR-94 和 RuleML，[业务规则管理系统](http://en.wikipedia.org/wiki/Business_Rule_Management_System)还提到了 OMG 业务动机模型（BMM）、OMG SBVR、OMG 生产规则表示（PRR）、W3C RIF 和 PMML。

您可能还对[BPEL](http://en.wikipedia.org/wiki/Business_Process_Execution_Language)、[工作流引擎](http://en.wikipedia.org/wiki/Workflow_engine)、[工作流应用程序](http://en.wikipedia.org/wiki/Workflow_application)和[业务流程管理](http://en.wikipedia.org/wiki/BPMS)等主题感兴趣。

# c# - 在 C# 中将对象集合转换为 javascript 数组的创造性方法

> ID：1016141
> 
> 赞同：1
> 
> 时间：2009-06-19T02:44:42.843
> 
> 标签：c#, javascript, asp.net-mvc, arrays, json

我有一个用户列表，`List<Users>`我需要创建一个包含所有用户 ID 的 javascript 数组。

我知道我可以使用 stringbuilder 手动构建它并循环，然后将其保存到变量并在我的 asp.net-mvc 视图页面上显示。

还有其他更有创意的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T03:07:54.433

JsonConvert.SerializeObject，来自[Json.NET](http://james.newtonking.com/pages/json-net.aspx)。

下面的简化示例：

```
using System;
using System.Linq;
using System.Collections.Generic;

using Newtonsoft.Json;

class Users
{
    public string Name {get; set;}
    public int UserID {get; set;}
    public Users(string Name, int UserID)
    {
        this.Name = Name;
        this.UserID = UserID;
    }
}

    List<Users> users = new List<Users>();
    users.Add(new Users("John", 1));
    users.Add(new Users("Mary", 2));
    ...     

    string json = JsonConvert.SerializeObject(from user in users select user.UserID);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T02:47:16.223

您可以使用 Json(list) 转换为 JSON，然后在您的 javascript 中解析它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T04:33:19.310

你也可以这样做

```
var jsArray = String.Format("var userIds=new Array({0});", String.Join(",", users.Select(x =>x.UserId.ToString()).ToArray())) 
```

# iphone - 有没有办法实现两个tableview的并行滚动？

> ID：1016142
> 
> 赞同：0
> 
> 时间：2009-06-19T02:45:08.380
> 
> 标签：iphone, uitableview, uiscrollview

比方说，我在滚动视图中有两个表格视图。在我向上和向下滚动 tableview1，然后触摸并滑动以将滚动视图水平滚动到 tableview2 后，我希望 tableview2 具有与 tableview1 相同的垂直（向上和向下）位置。有没有办法做到这一点？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T03:47:28.580

您可以将代码放在 UITableViews 的`viewWillDisplay:`方法中，以获取另一个表视图的滚动位置（在滚动视图用语中称为“内容偏移”）并调用`setContentOffset:animated:`. 这样，每当任一滚动视图出现在屏幕上时，它都会自动滚动到另一个视图的位置。

# actionscript-3 - 在 Actionscript 3 中将像素转换为贝塞尔曲线

> ID：1016149
> 
> 赞同：1
> 
> 时间：2009-06-19T02:47:44.723
> 
> 标签：actionscript-3, flash-cs4, trace, bezier, pixels

好的，所以我会尽量做到描述性。

我正在为需要上传图像的 jibjab 样式遮罩功能的客户开发一个项目。

我希望能够生成一个包含贝塞尔形状的锚点/控制位置的数据库可存储对象，因此我可以稍后将其拉出并重新屏蔽该对象。这一切都很容易做到，除了一个问题：我需要从用户绘制的轮廓创建贝塞尔对象。

到目前为止，这是我想象的过程：

在鼠标按下时，创建一个新的精灵、beginFill 和 moveTo 鼠标位置。

在鼠标移动时，lineTo 是一个 XY 坐标。

在鼠标上，endFill。

这一切都很好。我可以在这里存储信息，但我会看到一个巨大的对象，里面装满了大量非常无用的 x/y 坐标，除了在每个像素上放置句柄之外，没有办法真正进行微调更改。（我不妨给最终用户一个铅笔工具......）

就贝塞尔曲线计算而言，这就是我的想法：

1：弄清楚何时需要开始一条新曲线，并在此间隔上跟踪像素的 xy。我想象这只是一个像素数，也许只是在每次鼠标移动时增加一个计数变量，然后每 x 个像素创建一个新变量。这里的问题是一些曲线不准确，而另一些则不必要，但我真的只需要一个一般区域，而不是一个精确的表示，所以它可以工作。不过，我会更高兴一些更聪明的东西。

2：获取每个新的 x/y，将其存储为锚点，并计算出控件将在何处生成此锚点和最后一个锚点之间的直线曲线。这是我真正挂断电话的地方。我敢肯定有人已经在 Flash 中完成了这项工作，但似乎再多的谷歌搜索也无法帮助我找到完成这项工作的方法。我已经画了很多草图，还有什么小数学可以让我的大脑环绕，但似乎无法找到将像素转换为贝塞尔曲线的方法。

这可能吗？我真正需要的是接近相同形状的东西。我正在考虑可能只在下一个像素的角度相对于当前线或其他东西的角度超过 180 度时才放置锚点，并且只是抓住这些变化之间的弧线边缘，但无论我多么努力，我似乎无法弄清楚如何让它工作！

感谢您的帮助，我一定会在这里发布我的进展，我认为这在许多应用程序中都非常有用，只要它实际上是可行的......

杰西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T03:01:20.937

将像素变成贝塞尔曲线听起来需要做很多工作。您可以尝试使用线性最小二乘算法之类的方法。[http://en.wikipedia.org/wiki/Linear_least_squares](http://en.wikipedia.org/wiki/Linear_least_squares)

换一种方式，你能让你的用户画矢量图形吗？这样您就可以将形状存储在数据库中。

将光栅转换为矢量的另一种很酷的方法是这样的迭代程序：[http ://rogeralsing.com/2008/12/07/genetic-programming-evolution-of-mona-lisa/](http://rogeralsing.com/2008/12/07/genetic-programming-evolution-of-mona-lisa/)

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:15:10.847

在我对[这个问题](https://stackoverflow.com/questions/891643/twitter-image-encoding-challenge)的回答中，我讨论了使用[自动跟踪](http://autotrace.sourceforge.net/)将位图转换为贝塞尔曲线。我建议通过服务器上的这个程序传递您的用户绘图。Autotrace 在跟踪和简化方面做得非常出色，因此无需在这里尝试重新发明轮子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-27T16:25:29.553

感谢您的回答，虽然我想我可能应该更具体地了解应用程序，但我真的只需要遮罩的轮廓，因此将图像转换为矢量或多边形，尽管这很酷，并不能真正解决我的问题问题。线性最小二乘算法非常酷，我认为这可能更接近我正在寻找的东西。

我现在有一个基本的解决方法，我只是计算鼠标移动，然后每个 X（玩它以获得最理想的曲线）移动，我抓住 xy 位置。然后，我把所有其他存储的 xy 变成一个锚，剩下的 xy 变成控件。这产生了一些理想的结果，但有一些小问题，因为绘制蒙版的速度会影响手柄的数量，而且它实际上只是获得一个一般区域，而不是精确拟合。有趣的是，对于更精确的形状，用户似乎画得更慢，所以这个解决方案比我想象的要好得多，但它并没有想象中的那么好。这将适用于客户，所以虽然没有理由进一步追求它，但我喜欢学习新事物，并且会花一些下班时间研究线性最小方程，看看我是否可以召集一个可以为我做这些计算的类。如果有人遇到此类事情的一些 AS3 代码，或者想要我的一些代码，请告诉我，这是一个有趣的谜题。

# .net - 从 2.0 转换到 3.5 后的 .NET 3.5 优化

> ID：1016153
> 
> 赞同：0
> 
> 时间：2009-06-19T02:50:41.770
> 
> 标签：.net, vb.net, optimization, .net-3.5

我将我们的项目从 .NET 2.0 转换为 3.5，并正在寻找可以利用 3.5 框架完成的优化。我可以用 3.5 做些什么，就像在数据结构中一样。除了 LINQ to SQL 之外，还有使用 DataAccess 的任何建议。任何建议/指针都会很棒。我不是在看任何具体的优化，只是一般的 . 我也在使用 VB.NET :(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T03:02:42.667

这有点依赖于 C#，因为您不能在 VB.Net 中编写迭代器。但对我来说，一个很大的性能改进是迭代器 + 扩展方法 + lambda 表达式组合。.Net 2.0 中也提供了迭代器，但是当您将它们与 IEnumerable 扩展方法结合使用时，您会突然拥有一个非常强大的优化工具。

例如，假设您有代码来读取文件并获取包含某些特定文本的所有行。在 .Net 2.0 中，您可以使用`File.ReadAllLines`或迭代流阅读器。在 .Net 3.5 中，您可以使用迭代器包装流阅读器并编写如下代码：

```
ReadLines(@"C:\MyFile.txt").Where(l => l.Contains("search text") ); 
```

现在这并不是那么特别，因为您可以在 .Net 2.0 中编写接近它的代码。但真正酷的是你可以继续添加过滤器：

```
var query = ReadLines(@"C:\MyFile.txt")
                            .Where(l => l.Contains("search text") )
                            .Select(l => int.Parse(l.SubStrin(5,8))
                            .Where(i => i > 10 );

int sum=0;
foreach (int value in query) 
{
    sum += value;
} 
```

小测验——该代码将迭代文件结果多少次？答案正是一个。添加新的`.Where()`或`.Select()`不会导致它再次循环结果。相反，它推迟执行以为您的枚举创建一种管道。

要在 .Net 2.0 中获得类似的性能，您必须编写一个更长的函数，包括打开和读取文件，有一个更复杂的类来实现 IEnumerable，或者广泛使用大多数程序员不会的自定义委托不明白。

这允许您以一种非常简单且非常可重用的方式抽象出读取文件的代码，从而使该语言现在适合编写高效的代码。有趣的是，您*可以*从 VB.Net 中使用它：您只需要在某个地方有一个 C# 程序集来保存您想要编写的迭代器，然后您的 VB.Net 代码将如下所示：

```
Dim query = ReadLines("C:\MyFile.txt") _
                      .Where(Function(l) l.Contains("search text") ) _
                      .Select(Function(l) Integer.Parse(l.SubString(5,8) ) _
                      .Where(Function(i) i > 10 )

Dim sum As Integer = 0
For Each value As Integer In query
    sum += value
Next value 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T02:56:12.257

我不完全确定您所说的优化是什么意思。你能澄清一下吗？

3.5 框架和相应的 VB.Net 编译器与其说是关于优化，不如说是关于围绕 LINQ（语言集成查询）的概念。这是一种定义通用查询语言的方法，有点类似于 SQL，可用于各种不同的来源。

例如，假设您有一个学生列表，并且想要获取具有特定名称的学生。在 LINQ 之前，您会编写如下内容

```
Dim list As New List<Student>()
For Each cur in col
  if cur.Name = SomeName Then
    list.Add(cur)
  End If
Next 
```

LINQ 通过让您编写以下代码大大简化了这一点

```
Dim result = From cur in col Where cur.Name = SomeName 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T03:03:29.077

此链接几乎一目了然地为您提供了所有新的 VB 9.0 功能：

[http://msdn.microsoft.com/en-us/library/ms364068.aspx](http://msdn.microsoft.com/en-us/library/ms364068.aspx)

*   隐式类型的局部变量
*   对象和数组初始化器
*   匿名类型
*   深度 XML 支持
*   查询理解扩展
*   方法和 Lambda 表达式
*   可空类型
*   轻松的代表

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T03:25:22.900

VB 9 有一个很酷的 XML 原始类型，可以让您执行以下操作：

```
Dim book As XElement = _
    <book category="fiction" isbn=<%= isbnNumber %>>
        <modifiedDate><%= modifiedDate %></modifiedDate>
    </book> 
```

这很酷！（代码取自[msdn](http://msdn.microsoft.com/en-us/library/bb384964.aspx)）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T16:27:38.263

如果您在 2.0 中使用远程处理或序列化，您现在可以将其切换到 WCF 远程处理/序列化，从我所读到的内容中，您会看到性能得到很好的提升。

# eclipse - 什么是 Perl 的良好开发环境？

> ID：1016165
> 
> 赞同：14
> 
> 时间：2009-06-19T02:56:12.477
> 
> 标签：eclipse, perl, ide

我使用 PHP 或 Java 开发应用程序，并将第一次学习 Perl。

PHP和Java都有Eclipse等集成开发环境，调试环境规范得很好，但是Perl的情况下，人们使用什么样的开发环境呢？

有推荐的IDE吗？

我更喜欢免费的调试环境。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-19T03:17:13.260

正如 Sinan 所说，有一些 Perl 的 IDE。[帕德雷](http://padre.perlide.org/)值得一提。Perl 社区正在积极开发它。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-19T03:05:41.600

Perl 有很好的调试支持。阅读[perldoc perldebug](http://perldoc.perl.org/perldebug.html)了解详细信息。

有很多 IDE，例如[ActiveState 的 Komodo](http://www.activestate.com/komodo/)、[EPIC](http://www.epic-ide.org/)等，但我更喜欢将[GVim](http://www.vim.org/)（另见[.vimrc for Perl 程序员](http://www.perlmonks.org/?node_id=540167)）与命令行结合使用。其他人更喜欢[Emacs](http://www.perlfoundation.org/perl5/index.cgi?emacs)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-19T18:34:50.920

来自[perlfaq3：是否有 IDE 或 Windows Perl 编辑器？](http://faq.perl.org/perlfaq3.html#Is_there_an_IDE_or_W)，看起来好多了。

如果[Padre](http://en.wikipedia.org/wiki/Padre_(software))人想要他们的东西在这里，只需添加正确的位。源代码位于[我的 perlfaq github repo](http://github.com/briandfoy/perlfaq/tree/master)中。你可以 fork 它，直接在[GitHub](http://en.wikipedia.org/wiki/GitHub)中编辑文件，然后向我发送拉取请求。

* * *

是否有 IDE 或 Windows Perl 编辑器？

Perl 程序只是纯文本，所以任何编辑器都可以。

如果你在 Unix 上，你已经有一个 IDE——Unix 本身。Unix 哲学是几个小工具的哲学，每个工具都做一件事并且做得很好。它就像一个木匠的工具箱。

如果您想要一个 IDE，请检查以下内容（按字母顺序，而不是优先顺序）：

[蚀](http://e-p-i-c.sf.net/)

```
    Eclipse Perl 集成项目集成了 Perl
    使用 Eclipse 进行编辑/调试。

```

[网站](http://www.enginsite.com/)

```
    EngInSite 的 Perl Editor 是一个完整的集成开发
    用于创建、测试和调试 Perl 的环境 (IDE)
    脚本；该工具在 Windows 9x/NT/2000/XP 或更高版本上运行。

```

[科莫多](http://www.ActiveState.com/Products/Komodo/)

```
    ActiveState 的跨平台（截至 2004 年 10 月，即 Windows，
    Linux 和 Solaris），多语言 IDE 支持 Perl，包括
    正则表达式调试器和远程调试。

```

[打开 Perl IDE](http://open-perl-ide.sourceforge.net/)

```
    Open Perl IDE 是一个用于编写的集成开发环境
    并使用 ActiveState 的 ActivePerl 调试 Perl 脚本
    在 Windows 95/98/NT/2000 下分发。

```

[OptiPerl](http://www.optiperl.com/)

```
    OptiPerl 是一个带有模拟 CGI 环境的 Windows IDE，包括
    调试器和语法高亮编辑器。

```

[PerlBuilder](http://www.solutionsoft.com/perl.htm)

```
    PerlBuidler 是 Windows 的集成开发环境
    支持 Perl 开发。

```

[visiPerl+](http://helpconsulting.net/visiperl/)

```
    来自帮助咨询，适用于 Windows。

```

[可视化 Perl](http://www.activestate.com/Products/Visual_Perl/)

```
    Visual Perl 是来自 ActiveState 的 Visual Studio.NET 插件。

```

[宙斯](http://www.zeusedit.com/lookmain.html)

```
    Zeus for Window 是另一个 Win32 多语言编辑器/IDE
    附带对 Perl 的支持

```

对于编辑：如果你在 Unix 上，你可能已经有 vi 或 vi 克隆，也可能有[Emacs](http://en.wikipedia.org/wiki/Emacs)，所以你可能不需要下载任何东西。在任何 Emacs 中，`cperl-mode`( `M`- `x` `cperl-mode`) 可能为您提供了任何编辑器中可用的最佳 Perl 编辑模式。

如果您使用的是 Windows，则可以使用任何允许您处理纯文本的编辑器，例如记事本或写字板。诸如 Microsoft Word 或 WordPerfect 之类的文字处理器通常不起作用，因为它们会插入各种幕后信息，尽管有些允许您将文件保存为“纯文本”。您还可以下载专为编程设计的文本编辑器，例如[Textpad](http://www.textpad.com/) 和[UltraEdit](http://www.ultraedit.com/)等。

如果您使用的是[Mac OS](http://en.wikipedia.org/wiki/Mac_OS)，同样的问题也适用。MacPerl（用于经典环境）带有一个简单的编辑器。流行的外部编辑器是 [BBEdit](http://www.bbedit.com/)或[Alpha](http://www.his.com/~jguyer/Alpha/Alpha8.html)。[Mac OS X](http://en.wikipedia.org/wiki/Mac_OS_X)用户也可以使用 Unix 编辑器。

[GNU Emacs](http://www.gnu.org/software/emacs/windows/ntemacs.html)

[微EMACS](http://www.microemacs.de/)

[XEmacs](http://www.xemacs.org/Download/index.html)

[杰德](http://space.mit.edu/~davis/jed/)

或 vi 克隆，例如

猫王[FTP](ftp://ftp.cs.pdx.edu/pub/elvis/) _ [_](http://www.fh-wedel.de/elvis/)

[卑鄙的](http://dickey.his.com/vile/vile.html)

[维姆](http://www.vim.org/)

对于一般的 vi 爱好者，Windows 或其他地方：[vi](http://www.thomer.com/thomer/vi/vi.html)

[nvi](http://www.bostic.com/vi/)（可从 CPAN 中获得`src/misc/`）是另一个 vi 克隆，遗憾的是不适用于 Windows，但在 Unix 平台中您可能有兴趣尝试一下，首先因为严格来说它不是 vi 克隆，它是真正的 vi，或者它的新化身，其次是因为您可以将 Perl 嵌入其中以使用 Perl 作为脚本语言。不过，nvi 并不孤单：至少 vim 和 vile 也提供嵌入式 Perl。

以下是支持 Perl 的 Win32 多语言编辑器/IDES：

[代码作家](http://www.borland.com/codewright/)

[多重编辑](http://www.MultiEdit.com/)

[光滑编辑](http://www.slickedit.com/)

还有一个用 Perl 编写的基于 toyedit 文本小部件的编辑器，它与 CPAN 上的 Tk 模块一起分发。ptkdb是一个[基于](http://ptkdb.sourceforge.net/)Perl/tk 的调试器，充当各种开发环境。 [Perl Composer](http://perlcomposer.sourceforge.net/)是一个用于创建 Perl/Tk GUI 的 IDE。

除了编辑器/IDE，您可能对更强大的 Win32 shell 环境感兴趣。您的选择包括

[Cygwin 包](http://sources.redhat.com/cygwin/)中的 Bash

[MKS Toolkit](http://www.mks.com/)中的 Ksh或[U/WIN 环境](http://www.research.att.com/sw/tools/uwin/)的 Bourne shell

[Tcsh](ftp://ftp.astron.com/pub/tcsh/)，另请参阅[使用 csh 和 tcsh](http://www.primate.wisc.edu/software/csh-tcsh-book/)

[Zsh](http://www.zsh.org/)

MKS 和 U/WIN 是商业的（U/WIN 可免费用于教育和研究目的），Cygwin 受 GNU 公共许可证的保护（但这对于 Perl 的使用而言无关紧要）。Cygwin、MKS 和 U/WIN 都包含（除了 shell）一套全面的标准 UNIX 工具包实用程序。

如果您使用 FTP 在 Unix 和 Windows 之间传输文本文件，请确保以 ASCII 模式传输它们，以便适当地转换行尾。

在 Mac OS 上，MacPerl 应用程序带有一个简单的 32k 文本编辑器，其行为类似于一个基本的 IDE。与 MacPerl 应用程序相比，MPW Perl 工具可以将 MPW 本身的 Shell 用作编辑器（没有 32k 限制）。

[Affrus](http://www.latenightsw.com)是一个完整的 Perl 开发环境，具有完整的调试器支持。

[Alpha](http://www.his.com/~jguyer/Alpha/Alpha8.html)是一个用 Tcl 编写和可扩展的编辑器，它内置了对包括 Perl 和 HTML 在内的几种流行标记和编程语言的支持。

[BBEdit](http://web.barebones.com/)和[BBEdit Lite](http://web.barebones.com/)是 Mac OS 的文本编辑器，具有 Perl 敏感模式。

[Pepper](http://www.hekkelman.com/)和[Pe](http://www.hekkelman.com/)分别是 Mac OS X 和 BeOS 的编程语言敏感文本编辑器。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-19T10:12:10.503

Padre 正在变得越来越好，但目前与 Komodo 或 EPIC 相比还不是很好。

也就是说，它在这一点上与 Ultraedit 或 Notepad++ 相当，距离编写第一行代码不到一年。

大约有 30 人积极参与，35-40 个插件已发布或正在开发中，以及 20 种语言的翻译，它的发展速度也令人难以置信。

所以现在，我同意 EPIC 可能是要走的路，因为您已经使用过 Eclipse。

但到明年这个时候，情况可能会有所不同。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-06-19T07:04:15.720

如果您已经熟悉 Eclipse 中的调试，那么[EPIC 插件](http://www.epic-ide.org/download.php)正是您正在寻找的。

[它在 Debug 透视图中进行了分步调试，就像Eclipse](http://en.wikipedia.org/wiki/Eclipse_(software))中的其他语言一样。它不如 Java 支持那么强大，但它比“perl -d”（调试 Perl 的“标准”方法）更容易学习，甚至学习像 Emacs 这样的新编辑器，它的 Perl 调试集成。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-19T03:27:28.340

我使用的——以及大多数其他认真的 Perl 开发人员使用的印象——是一个很好的*文本编辑器*。我唯一的“集成”是通过用户定义的工具。对于 Perl，就是这些：

```
perl -Mstrict -cw <file>  # Perl "lint"
perl <file>               # run file
perl -d <file>            # run file in debugger 
```

我还有其他人可以将文件签入/签出版本控制、浏览历史记录等。一个好的可配置编辑器（我偏爱[UltraEdit](http://www.ultraedit.com)）将允许您使用所需的工具构建自己的环境，而不是强加一个包罗万象的工具给你解决方案。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-19T16:29:54.470

[Komodo Edit](http://www.activestate.com/komodo_edit/)是来自 Active State 的免费编辑器，可能不像完整的 IDE 那样功能丰富，但我发现它对 Perl 开发非常有用，并且它支持多种语言。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-28T09:33:29.293

您没有指定您在哪个平台上，但在[Macintosh](http://en.wikipedia.org/wiki/Macintosh)上，TextMate 是 Perl 开发的一个非常流行的选择。对我来说它完全取代了[Vim](http://en.wikipedia.org/wiki/Vim_(text_editor))，虽然它不是一个完整的 IDE，但它在专门针对 Perl 开发的捆绑包中有很多巧妙的集成。

# unit-testing - 如何对业务规则进行单元测试？

> ID：1016167
> 
> 赞同：5
> 
> 时间：2009-06-19T02:56:31.913
> 
> 标签：unit-testing, business-rules

我需要一个单元测试来确保我正确地累积假期时间。但是假期时间是根据业务规则累积的，如果规则改变，那么单元测试就会中断。

这可以接受吗？我是否应该通过一个方法公开规则，然后从我的代码和测试中调用该方法以确保单元测试不那么脆弱？

我的问题是：对可能发生变化的业务规则进行单元测试的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T03:19:10.120

您的测试应确保代码正确遵守业务规则。因此，我不会编写绕过业务规则或依赖业务规则代码本身的测试。相反，当业务规则发生变化时，我会首先更改测试以反映新的业务规则，然后当我的代码不再通过测试时，去修复代码以使其通过测试。

您不希望发生的事情是编写测试，以便当您更改相同业务规则的应用方式时，您的测试会中断。这说起来容易做起来难，但本质上你想要测试的是实现规则所需的最低要求，而不是太狭隘地规定代码是如何实现的。但是，如果规则的结果不同，那么您应该先更改测试，然后再更改与之匹配的代码。

您也不希望测试与特定数据耦合。假设在进行税收计算时，您的测试不应该假设被测类使用 5% 作为税收。相反，您应该编写测试以提供税收百分比，然后检查计算是否正确。据推测，您将有一系列值进行测试，以确保也捕获超出范围的值。这样做的一个结果是您将拥有更好的设计，因为这将帮助您避免硬编码值并使您的生产代码更灵活地适应数据的变化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T03:02:37.080

我有类似的设置 - 但是我的业务规则已编译但具有可配置选项（您的可能不同）。当一个业务规则改变了它运行的核心方式时，我的单元测试就会中断。这实际上是意料之中的——而且很好！这意味着我可以隔离整个系统中的任何意外涟漪，并更新测试以匹配更改。

如果您的规则是外部的（某种脚本语言或数据库存储过程），那么您需要将它们包装在集成测试中并连接集成测试以自动执行。虽然不再是单元测试，但集成测试也相当重要，它将以与单元测试相同的方式帮助您防止由于业务规则更改而导致的意外涟漪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T20:26:41.980

听起来您有业务规则，然后您有这些业务规则的客户。如果这两者可以独立变化，那么相应地设计您的 API 将是明智之举。

如前所述，您的问题听起来可以通过适当使用策略模式来解决。策略代表您的业务规则，因此您可以在纯上下文中对这些规则进行单元测试，而无需担心客户端。

当业务规则发生变化时，简单地保留旧策略（以防以后再次需要它）并编写（和单元测试）一个代表新业务规则的全新策略可能更有意义。

当您完全完成新策略后，您可以替换客户端中的策略。

在对客户端进行单元测试时，您应该针对测试双重策略（如 Mock 或 Stub）执行此操作，以验证客户端是否与策略正确交互，而不依赖于任何特定的策略实现。

通过这种方式，您可以清晰地分离关注点，并使单元测试保持可维护性。您还遵守开放/封闭原则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T03:18:33.507

如果规则被更改，测试失败听起来是正确的——这是意料之中的。

如果您在测试本身中使用数据夹具而不是硬编码值，您可以更轻松地在未来维护测试。例如，如果你的方法应该返回 foo，你可以在夹具中拥有它。当您更改业务逻辑时，您只需更改夹具，您不必通过单元测试本身。

当然，这在很大程度上取决于您正在测试的逻辑类型，并且可能并不总是适用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-06-28T08:17:08.867

我认为这是一个不正确的问题业务规则和单元测试处于不同的抽象级别。业务规则处于最高抽象级别（业务建模），但单元测试用于测试处于最低抽象级别的代码单元，因此***您不能使用单元测试来验证或验证业务规则。*** 另外一个业务规则经过分析和设计后可能会影响到几个代码单元，所以你**不能再用单元测试来验证或验证一个业务规则**。我认为您可以使用测试用例或 BDD 场景来验证和验证业务规则。

# jquery - 从所有以用户名开头的 ID 中删除一个类-

> ID：1016169
> 
> 赞同：2
> 
> 时间：2009-06-19T02:57:16.623
> 
> 标签：jquery

我有一堆看起来像的元素

```
<div id="username-2343"></div> 
```

我需要遍历页面上的所有这些并使用**jQuery**从它们中删除一个类。

我怎样才能做到这一点？**我不知道所有的 ID，所以我需要搜索所有匹配的用户名。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T02:59:25.310

这应该使用[`attributeStartsWith`](http://docs.jquery.com/Selectors/attributeStartsWith#attributevalue)选择器来完成：

```
$('div[id^=username-]').removeClass('myclass'); 
```

但是，大概您可以控制这些`<div>`s，因为它们被打印到页面上。简单地给他们一个表示他们是“用户div”的类会更好，所以你可以这样做：

```
$('div.user').removeClass('myclass'); 
```

这将更快更清洁。

# sql - 如何表示 RDBMS 中的预定事件？

> ID：1016170
> 
> 赞同：6
> 
> 时间：2009-06-19T02:57:31.567
> 
> 标签：sql, database-design, relational-database, rdbms

我必须存储可以每周、每天或每月组织的预定活动（例如上课时间）。例如，事件可能发生在每个星期一和星期三，或者每个月的第二个星期四。有没有办法将此信息存储在符合 3NF 的 RDBMS 中？

编辑：这不是作业；我正在和一个朋友一起为我们自己的教育构建一些东西，我们希望它在 3NF 中。

具体来说，我正在尝试在 RC 教区存储弥撒和忏悔时间的时间表。这些可以通过多种方式安排，例如每个星期日的 x 时间或每个星期二/星期四的不同时间。有时它只是每月的第三个星期五，而其他人只在一年中的某个时间提供一次。我不仅需要存储这些信息，还需要查询它，这样我就可以快速获得接下来一天或一周或其他任何时间的可用时间的完整列表。

我想严格来说 3NF 不是必需的，但如果是这样对我们来说会更容易，并且最好立即纠正它而不是稍后更改我们的模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T03:21:00.833

是的，我已经通过以下方式与我的同事解决了这个问题：

```
CREATE TABLE [dbo].[Schedule](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [StartDate] [datetime] NOT NULL,
    [EndDate] [datetime] NULL
)

CREATE TABLE [dbo].[ScheduleInterval](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [ScheduleID] [int] NOT NULL,
    [ScheduleIntervalUnitID] [int] NOT NULL,
    [Interval] [smallint] NOT NULL
)

CREATE TABLE [dbo].[ScheduleIntervalUnit](
    [ID] [int] NOT NULL,
    [Name] [varchar](50) NULL
)

INSERT INTO ScheduleIntervalUnit (ID, Name)
SELECT '1' AS [ID], 'Day' AS [Name] UNION ALL
SELECT '2' AS [ID], 'Week' AS [Name] UNION ALL
SELECT '3' AS [ID], 'Month' AS [Name] 
```

时间表跨越一段时间，并且在该时间长度内发生间隔。调度间隔单位确定间隔的长度（天，如“每隔”（2）或“每隔三分之一”（3）等），周（一周中的某一天，如星期一、星期二等），以及月（日历年）。使用它，您可以对数据库进行查询和逻辑以检索时间表。

如果您的日程安排需要更好的解决方案 - 低至几小时、几分钟、几秒 - 请查看`cron`. 我最初是沿着这条路线开始的，但发现上面的方法更加简单和可维护。

单个日期/时间跨度 - 例如从 9 月 9 日开始到 11 月 4 日结束的定义的学期 - 可以包含多个时间表（因此艺术课每周一，物理课“每隔一天” - 但你需要做考虑假期和周末的更多工作！）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T03:28:02.740

要记录“周期性重复”的规则，您可以从[crontab](http://www.manpagez.com/man/5/crontab/)的格式中获取灵感，当然您不需要限制分钟和小时，而是需要一周中的某天、某月中的某天等。由于日程表中可能包含多个（例如）工作日，因此出于 NF 目的，您将需要用于表示多对多关系的典型中间表，即每行只有两个外键（一个到主事件表） ，一个到一个工作日表）——当然也同样适用于一个月中的几天，等等。

大概每个预定的事件也会有一个持续时间、一个类别、可能是一个位置、一个名称或描述描述。

形式的“正常程度”（一旦您处理了具有上述多对多关系的“集合”）主要取决于这些不同的属性是否以及如何相互依赖 - 例如，如果某个事件中的每个事件类别具有相同的持续时间，您将希望有一个单独的辅助表，其中包含 id、类别和持续时间，并在该表中使用外键而不是重复配对信息。但是从你所说的来看，我没有看到任何内在违反正常形式规则的情况，除了这种依赖可能性（这不是你对事件调度指定的很少内容所固有的）。

# php - 使用 PHP 在对象上调用更改函数名称：如何？

> ID：1016184
> 
> 赞同：2
> 
> 时间：2009-06-19T03:04:54.923
> 
> 标签：php

我将如何做这样的事情：

```
class Test
{

    public function test($methodName) {
        $this->$methodName;
    }

    private function a() {
        echo("a");
    }

    private function b() {
        echo("b");
    }

}

$testObj = new Test();
$testObj->test("a()");
$testObj->test("b()"); 
```

也许我应该只传递一个参数“TYPE”并使用“IF 语句”，但我只是好奇！:)

如果“动态函数名”有一个或多个参数怎么办？

更新：谢谢大家！:)

**更新 #2 - 答案：**

```
class Test
{

    public function testOut($methodName) {
        $this->$methodName();
    }

    private function a() {
        echo("a");
    }

    private function b() {
        echo("b");
    }

}

$testObj = new Test();
$testObj->testOut("a");
$testObj->testOut("b"); 
```

该类的问题是有一个名为“Test”的方法（与类名相同）......我改变了它并且它起作用了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T03:09:47.597

```
class Test
{

    public function test($methodName) {
        $this->$methodName();
    }

    private function a() {
        echo("a");
    }

    private function b() {
        echo("b");
    }

}

$testObj = new Test();
$testObj->test("a");
$testObj->test("b"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:11:07.813

退房`call_user_func()`- 它应该做你想做的事。

[文档在这里](http://nz.php.net/manual/en/function.call-user-func.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T03:11:15.767

**[call_user_func](http://nz.php.net/manual/en/function.call-user-func.php)**允许你做这样的事情。

例如，

```
funcname = 'a';
call_user_func(array($testObj, $funcname)); 
```

另一种选择是使用**[可变方法](http://php.mirrors.ilisys.com.au/manual/en/functions.variable-functions.php)**

例如，

```
$funcname = 'a';
$testObj->$funcname(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T03:14:21.567

如果你有一个带有多个参数的“动态函数名”，你可以使用 call_user_func_array，像这样：

```
//in class context..
//$parameters can be an array like array(1,2)
call_user_func_array(array($this, $methodName), $parameters); 
```

您想要使用 call_user_func_array 而不是 call_user_func 的原因是您可以将函数作为数组的参数传递，而不是作为附加参数，因此您可以轻松地拥有可变数量的参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T03:24:14.573

按照您的特定示例和用例，实现这一目标的唯一方法是：

```
$testObj = new Test();
$testObj->test("a()");
$testObj->test("b()"); 
```

将使用[eval()](http://www.php.net/eval)：

```
class Test
{

    public function test($methodName) {
        eval($methodName);
    }

    private function a() {
        echo("a");
    }

    private function b() {
        echo("b");
    }

}

$testObj = new Test();
$testObj->test("a()");
$testObj->test("b()"); 
```

其他人指出了使用[`call_user_func()`](http://nz.php.net/manual/en/function.call-user-func.php)和正确的解决方案。同样显然，它比使用 eval() 进行函数调用要快。读这个：

[http://nz.php.net/manual/en/function.call-user-func.php#64415](http://nz.php.net/manual/en/function.call-user-func.php#64415)

# c# - Silverlight ComboBox 的 SelectedItem 和 ItemTemplate 的不同 UI

> ID：1016188
> 
> 赞同：0
> 
> 时间：2009-06-19T03:09:31.933
> 
> 标签：c#, xaml, silverlight-3.0

基本上我只是在 SL3 ComboBox 中寻找“SelectedItemTemplate”。不幸的是，那不存在。

我想要的是 SelectedItem 看起来像这样：值

下拉框中的项目看起来像这样：价值+额外信息

后者很容易通过使用 ItemTemplate 完成，但 SelectedItem 看起来也是如此。我该如何预防/解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:36:43.607

您可以通过创建自己的 SelectionBoxItemTemplate 附加属性，然后为 ComboBox 定义一个新的样式/控件模板，该模板在内容呈现器中为选择框区域使用该模板。

这是一个合适的附加属性：

```
public class ComboBoxExt
{
    public static DataTemplate GetSelectionBoxItemTemplate(DependencyObject obj)
    {
        return (DataTemplate) obj.GetValue(SelectionBoxItemTemplateProperty);
    }

    public static void SetSelectionBoxItemTemplate(DependencyObject obj, DataTemplate value)
    {
        obj.SetValue(SelectionBoxItemTemplateProperty, value);
    }

    public static readonly DependencyProperty SelectionBoxItemTemplateProperty =
        DependencyProperty.RegisterAttached("SelectionBoxItemTemplate", typeof (DataTemplate), typeof (ComboBoxExt),
                                            new PropertyMetadata(null));

} 
```

要更新 ComboBox 控件模板，请`ContentPresenter`在一个名为的元素中查找名为的元素（您可以在[此处](http://msdn.microsoft.com/en-us/library/dd334408%28v=vs.95%29.aspx)`ContentPresenterBorder`找到 ComboBox 的默认样式）。您需要删除 ContentPresenter 的名称（否则 ComboBox 将通过代码显式设置其属性的值，而忽略您设置的数据绑定）。

调整后的控件模板中的 ContentPresenter 元素应如下所示：

```
<ContentPresenter Margin="{TemplateBinding Padding}" 
                  Content="{Binding Path=SelectedItem, RelativeSource={RelativeSource TemplatedParent}}"
                  ContentTemplate="{Binding (a:ComboBoxExt.SelectionBoxItemTemplate), RelativeSource={RelativeSource TemplatedParent}}"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
</ContentPresenter> 
```

最后，要使用它，您可以执行以下操作：

```
<ComboBox 
   Style="{StaticResource MyAdjustedComboBoxStyle}"
   ItemTemplate="{StaticResource MyDropDownAreaTemplate}"
   Behaviors:ComboBoxExt.SelectionBoxItemTemplate="{StaticResource MySelectionAreaTemplate}"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:23:10.423

你在找`.`[`SelectionBoxItemTemplate`](http://msdn.microsoft.com/en-us/library/system.windows.controls.combobox.selectionboxitemtemplate.aspx)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-18T06:35:43.703

`SelectionBoxItemTemplate`在 Silverlight4 中可用，但无法从代码隐藏设置此属性的值，因为它是只读属性。它也不是依赖属性，因此无法使用`comboBox.SetValue()`方法设置值。关于如何在代码隐藏中为该属性赋值的任何想法？

# c++ - GCC如何从静态库中导出函数

> ID：1016191
> 
> 赞同：2
> 
> 时间：2009-06-19T03:10:19.343
> 
> 标签：c++, macos, linker, shared-libraries, symbols

我想在 OS X 下使用 GCC 从几个静态库创建一个共享库。

在一些静态库中，共享库中没有代码调用它，我只想导出这些静态库中的符号。这在调试模式下有效，但在发布模式下无效（尤其是当我启用死代码条带化时）。我可以理解原因，gcc 认为静态库上的这些函数从未使用过。但是我怎样才能强制 gcc 包含这些符号？

我已经尝试为加载程序添加 -u 选项，但它只生成一个“本地”符号。如何使链接器生成导出符号？

另外，我想知道是否有办法在源代码中添加链接器指令，就像 MSVC`#pragrma comment(linker, "/INCLUDE:xxxx")`

我在静态库中定义的函数是这样的：

```
extern "C"
void test() {} 
```

提前致谢！-强尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T03:18:09.577

你试过`--whole-archive`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:18:27.477

使用 ar 将静态库反汇编成它们的组成目标文件。然后将这些对象链接在一起以创建共享库。

```
ar -x libstatic.a
（产生一堆 *.o 文件）
gcc -shared -olibshared.so *.o # Linux
ld -dylib -olibshared.dylib *.o # Mac OSX

```

# .net - ASP.Net 应用程序状态对象的回收选项

> ID：1016194
> 
> 赞同：0
> 
> 时间：2009-06-19T03:12:13.333
> 
> 标签：.net, asp.net, database-connection, recycle, application-state

回收 ASP.Net 应用程序状态对象的选项有哪些？我正在使用该对象来存储基于 Web 服务的数据访问层的数据库连接队列。我担心在几天/几周/几个月内，我最终会在与不再使用的数据库的连接上分配越来越多的内存。连接是根据需要自动生成的，因此保留它们并不是非常重要。

有选择地解析应用程序状态并丢弃我不需要的东西会很酷。但实际上，简单地删除整个对象并重新开始也可以。但是，我需要注意清除过程不会终止当前正在使用的连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T03:27:18.810

在您开始缓存连接之前发生了什么？缓存它们是否会导致性能或资源利用率的任何可衡量的改进？考虑到 ADO.NET 会为您提供连接池，如果确实如此，我会有点惊讶。

应用程序状态没有回收选项。它是每个服务器、每个 AppDomain 的。

对于另一个缓存选项，请考虑使用 Cache 对象。它也是每个应用程序的，但您可以将缓存条目设置为在一段时间后过期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T12:45:02.893

我做了一些测试，看起来应用程序对象确实驻留在应用程序池中。（回收应用程序池清除了应用程序对象中的数据。）

# c++ - 使用 CppUnit 链接测试库

> ID：1016197
> 
> 赞同：6
> 
> 时间：2009-06-19T03:14:25.950
> 
> 标签：c++, linux, unit-testing, cppunit

我正在使用 CppUnit 设置一堆单元测试，但遇到的问题是没有一个测试正在运行。该项目分为几个小库，我计划以相同的方式划分单元测试类，然后将它们全部链接到一个单独的测试程序中。问题是，然后测试类在他们自己的库中，除非我明确调用它们，否则它们不会链接到主测试程序中，即我必须放入

`runner.addTest( TestClass::suite() );`

单独为每个测试类，不能使用 TestFactoryRegistry 的 makeTests() 方法来获取测试列表。如果我只是在顶层目录中将它们全部编译在一起，那么 makeTests() 方法可以正常工作，但如果我能提供帮助，我不想将所有测试类放在一个位置。

CppUnit 文档给出了以下小提示

> 使用 Helper 宏时的链接问题？
> 
> 当您创建一个项目并编写它的单元测试套件时，通过使用所谓的帮助宏使工作变得更容易：CPPUNIT_TEST_SUITE_NAMED_REGISTRATION、CPPUNIT_REGISTRY_ADD 和 CPPUNIT_REGISTRY_ADD_TO_DEFAULT。问题是，如果您在 TestFixture 类的源代码文件中使用这些宏（例如 MyTest），并且如果您使用这样的一行
> 
> ```
> runner.addTest( CppUnit::TestFactoryRegistry::getRegistry().makeTest() 
> ```
> 
> );
> 
> 在 main.cpp 文件中的 main() 函数中，根本不会有测试运行！
> 
> 原因很简单，如果您的 main.cpp 中没有未定义的符号，则链接阶段（构建过程的步骤之一）不要在最终的可执行文件中插入目标文件（.obj 或 .o 文件）。
> 
> 这样，包含 AutoRegister 静态变量实例化的目标代码不是最终可执行文件的一部分，并且无法在 main() 函数中将自己插入到运行器中。
> 
> 您必须在 main.cpp 中创建一个未定义的符号，以便 mytest.o 文件与 main.o 集成到最终的可执行文件中。
> 
> 米歇尔·诺拉德犯下的诡计

但没有说如何使这项工作，我只是足够密集，无法自己弄清楚或在网上找到一个例子。

现在我可以为每个库单独做一个可执行的测试，最后我可能会这样做，但我想先让它工作，所以我只需要运行一个测试程序来测试整个事情。有关如何使其发挥作用的任何想法/示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-24T14:36:40.967

通过向 main 添加一个未定义的符号，他只是意味着创建任何随机外部符号来强制链接器搜索包含测试代码的外部库。

例如，假设有两个测试库 fred 和 barney，在 fredTestLib.cpp 中您只需添加以下行：

```
int fredDummyInt = 0; // declare a unique symbol for the linker to resolve 
```

在 barneyTestLib.cpp 中，您将添加类似的行：

```
int barneyDummyInt = 0; // a different unique symbol for the linker to resolve 
```

您可以在不同的步骤中分别编译每个库。然后在主测试程序中强制链接器解析它们。因此，将这些行添加到 main.cpp：

```
extern int fredDummyInt;
extern int barneyDummyInt;
...
main () {
    ...
    fredDummyInt++; // give the linker some symbols to resolve
    barneyDummyInt++;
    ... 
```

这个想法（根据上述技巧的作者所说）是因为链接器已经在 fredTest.lib 中搜索 fredDummyInt，它也会找到并解决您自动注册的测试。

注意：我没有尝试过这个，看看它是否有效！我只是在回答你关于外部的问题。

要考虑的另一种方法是在 DLL 中创建测试，并使用 LoadLibrary() 显式地将它们带入运行。对于矫枉过正，如果您使用 MfcUi::TestRunner，您可能会构建一个小的下拉 GUI 东西，让您选择要加载的库，加载它，然后显示要在该库中运行的测试，然后运行它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T21:46:44.687

我意识到这篇文章现在已经很老了，但是对于遇到它的其他人来说：在代码中没有引用的情况下解决这个问题的一种方法是指示（强制）链接器将整个静态库包含在二进制文件中。详细信息区域可从 gcc 和 ld 手册页获得，这篇文章也涵盖了它： [How to force gcc to link unreferenced, static C++ objects from a library](https://stackoverflow.com/questions/4767925/how-to-force-gcc-to-link-unreferenced-static-c-objects-from-a-libraray)

根据 ld 的手册页，考虑明确关闭该选项很重要（也显示在上面的示例之一中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-25T14:09:49.980

这个问题的解决方案就像之前所说的那样简单（但可能不是很优雅）。对于位于外部库中的每个 TestFixture，您必须在主模块中添加以下两行代码

```
#include <CppUnitTestFixtureExample.h>
CppUnitTestFixtureExample Test1; 
```

它创建了一个未使用的虚拟变量，它只是强制链接器链接测试夹具。现在位于主模块中的测试运行器能够运行测试。

# iphone - 如何使 deleteRowsAtIndexPaths: 与 GenericTableViewController 一起使用？

> ID：1016200
> 
> 赞同：22
> 
> 时间：2009-06-19T03:15:30.660
> 
> 标签：iphone, objective-c, cocoa-touch

我正在使用 Matt Gallagher 的`GenericTableViewController`想法来控制我的`UITableViews`. 我的数据源是一个`NSFetchedResultsController`.

[http://cocoawithlove.com/2008/12/heterogeneous-cells-in.html](http://cocoawithlove.com/2008/12/heterogeneous-cells-in.html)

一切正常，直到我尝试删除一个单元格。

我的视图控制器中有以下代码：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

  if (editingStyle == UITableViewCellEditingStyleDelete) {

        // Delete the managed object.
        NSManagedObjectContext *context = [wineryController managedObjectContext];
        [context deleteObject:[wineryController objectAtIndexPath:indexPath]];

        NSError *error;
        if (![context save:&error]) {
            // Handle the error.
        }
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
  }   
} 
```

最后一行在控制台中以相当冗长的解释崩溃：

```
*** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，  
原因：'无效更新：第0节中的行数无效。行数   
更新后包含在现有节中的 (5) 必须等于数字  
更新前该部分中包含的行数 (5)，加上或减去数字  
从该部分插入或删除的行数（0 插入，1 删除）。
```

好的，我明白它在说什么......一行没有被删除（我会假设），因为我没有将一些消息转发到正确的位置（因为我已经从它的“正常”位置移动了一些代码）.. . 有人知道是哪一个吗？我完全被这个难住了。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-06-19T03:47:06.647

嗯，呸。我刚刚找到[**了这个**](https://stackoverflow.com/questions/998603/how-to-deal-with-non-visible-rows-during-row-deletion-uitableviews)不一样的答案，但让我朝着正确的方向前进。我会把这个留给以后遇到类似麻烦的人。

关键是用开始和结束标签包装 deleteRowsAtIndexPaths，并强制模型在同一个块内更新，结果是：

```
[tableView beginUpdates];
[self constructTableGroups];
[tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath]
        withRowAnimation:UITableViewRowAnimationFade];
[tableView endUpdates]; 
```

这导致问题消失，并且动画完美地工作。

# tfs - 填充 TFS WorkItem 修订集合

> ID：1016201
> 
> 赞同：1
> 
> 时间：2009-06-19T03:16:04.353
> 
> 标签：tfs

我正在编写一个需要访问 TFS 工作项模板的所有修订的工具。

Workitem 有一个 Revisons 集合，以及返回修订数的 Rev 属性。

当我尝试通过集合进行 foreach 时，即使它在我的测试工作项中包含 6 个“条目”，该集合也是空的。

为了解决这个问题，我使用 GetWorkItem(WorkItemID, RevisionID)，在 for 循环中增加修订 ID 以获取修订。我必须这样做似乎很疯狂，而且那里的集合不包含它应该包含的内容。

我在这里遗漏了什么，或者这只是 TFS 客户端 API 中的一个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-21T13:36:43.563

经过大量挖掘，我现在很清楚，如果你想获得一个工作项的所有修订，你必须显式加载你想要的修订（2），这使得修订集合几乎没有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T11:01:27.613

根据您检索工作项的方式，它可能仅被部分加载。在访问 Revisions 集合之前尝试在工作项上调用 Open 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-15T14:48:04.333

你从哪里得到工作项？我知道当我使用 sourceControl.QueryHistory 获取文件的版本历史记录时，我必须将我的参数之一（布尔包括 Changes）设置为 true 才能获得变更集中的更改。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-01-15T06:04:32.113

我正在使用 Microsoft.TeamFoundation.Controls.PickWorkItemsControl 来选择我需要的工作项。之后，revsionsCollectoin 完成。也许这有帮助：

```
// select the workitems using the picker
ArrayList workItems = _workItemPicker.Control.SelectedWorkItems();

// after that use a foreach and output all history included in each revision
private void PrintHistory(WorkItem workitem)
{

        RevisionCollection revisions = workitem.Revisions;

        foreach (Revision revision in revisions)
        {
            String history = (String) revision.Fields["History"].Value;
            Console.WriteLine("**** Revision {0}", revision.Fields["Title"], revision.Fields["Changed Date"]);

            foreach (Field field in revision.Fields)
            {
                Console.WriteLine("* field {0}:{1} ", field.Name, field.Value);
            }

            Console.WriteLine("****");
            Console.WriteLine();
        }

} 
```

# iphone - 升级到 iPhone SDK 3.0 导致 UIKit 问题

> ID：1016204
> 
> 赞同：6
> 
> 时间：2009-06-19T03:16:39.173
> 
> 标签：iphone, xcode, iphone-sdk-3.0

我有一个正在处理的现有项目，我最近决定更新我的 iPhone SDK 并更新到最新的 3.0 SDK。

我更新了我的 SDK 并打开了我现有的项目。果然有一些问题，包括一些证书问题等等。无论如何，谷歌和我能够解决其中的大部分问题，但我希望成为我的最后一个问题没有任何运气。

在模拟器中运行我的程序时，我现在得到

> dyld：库未加载：/System/Library/Frameworks/UIKit.framework/UIKit 引用自：/Developer/iGameLib/iGameLib/build/Debug-iphonesimulator/iGameLib.app/iGameLib 原因：找不到图像

现在，我发现 UIKit 已移至

> /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator3.0sdk/System/Library/FrameWorks/UIKit

我已经更新了我的目标和项目设置以指向那个新的框架位置，但是当我构建它时，没有运气。

我也尝试清除模拟器的应用程序和设置，但仍然没有运气。

当我运行“干净”菜单项时，引用 .app 被清除，我已经确认了这一点，所以很明显我的项目设置中的某些东西仍然指向使用旧的 UIKit 位置。

**我应该在哪里寻找？**

我已经尽我所能来帮助自己，但恐怕我在这里不知所措。我在目标设置、项目设置、plist 或项目中的任何其他文件下都看不到它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-03-12T08:38:37.227

我遇到了同样的错误

dyld：库未加载：/System/Library/Frameworks/UIKit.framework/UIKit

我的解决方案只是退出 Xcode 并重试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T20:24:15.843

好的，所以我有答案了！！！

很简单，Xcode 没有正确更改实际 .xcodeproj 文件中的所有变量。所以，这是我采取的步骤。

离开 Xcode，你必须在终端上完成这项工作。打开一个终端并转到您的项目所在的位置。找到您的 .xcodeproj 并像目录一样进入它。它看起来像 finder 中的实际文件，但它是那些包目录之一。

现在，我无法让 textedit 允许我编辑它，但你可以进入 nano，就像我一样

sudo nano project.pbxproj 位于我的 .xcodeproj 文件/文件夹/包/whatever 下。

在此文件中，您需要找到设置 SDKROOT 的位置。可能有几个地方引用了它，但您正在寻找 SDKROOT = iphoneos2.2.1 或类似的东西。将所有这些（有几个）更改为 SDKROOT = iphoneos3.0

现在，你已经成功了一半。执行 ctrl x 并保存文件。接下来，您将执行 ls 并找出 .pbxuser 文件是什么。我的是 myname.pbxuser。运行相同的命令

sudo nano myname.pbxuser

在这个文件中，有大量对 2.1 iphone sdk 目录的引用。搜索/替换 iPhoneSimulatorOLDVERSION.sdk，在我的例子中是 iPhoneSimulator2.1.sdk 并将 2.1 更改为 3.0。不过要非常小心，我不想知道当你把这个文件弄乱时会发生什么。

保存并打开 xcode。清理项目并构建并运行。快！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T07:57:40.697

1.  检查您的目标设置
    确保您实际上链接到目标中的所有这些框架（在“链接二进制文件与库”下检查）

2.  确保您已选择 3.0 sdk 作为您的基础 SDK

3.  创建一个空白项目并像以前一样添加您的框架；如果您仍有问题，可能是 SDK 安装错误

顺便说一句，您不必重新添加 sdk 框架，因为路径是相对于当前 SDK

只是想提供帮助......不确定我可以从这里调试:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-11T09:23:15.067

我刚刚从“Frameworks”文件夹中删除了 UIKit.framework，右键单击并再次将其添加回来。干净的构建，没有问题..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T07:13:06.840

我在 Xcode 上遇到过一些类似的问题，似乎没有明显的原因。事实是，Xcode 仍然到处都有 bug，有时你会碰壁。

**我的经验：**与您的情况有点类似，在一个特定的场合，我正在工作的一个 Xcode 项目由于某种神秘的原因而停止构建，并且没有任何清理、谷歌搜索或 SO-ing 为我提供任何答案。所以我简单地创建了一个 FRESH，NEW 项目，并将我损坏的项目中的源代码填充到新项目的源代码中。新项目使用相同的源、库、资源、设置，请注意——但它的构建没有任何问题。转移大约需要 20 到 25 分钟，但考虑到我花了几个小时试图解决一个不会在损坏的项目中显示出来的错误，所以时间非常值得。

所以，我建议做我所做的事情：也许尝试创建一个新项目并将您的旧源和资源转移过来。

祝你好运

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-28T09:06:55.710

在没有调试的情况下启动我的应用程序时出现同样的问题。以我的经验，生成的二进制文件似乎不是罪魁祸首。

我从 xcode 向导创建了一个应用程序，它确实在模拟器中启动正常（我们称之为 testApp，我的应用程序被称为 myApp），我试图找出与我的应用程序的区别在哪里。

`otool -L myApp` 为框架提供正确的（相对路径），与 testApp 相同

`ps -E` 与启动 testApp 时这些变量的值相比，ld 定位框架所需的 DYLD_ROOT_PATH、DYLD_FALLBACK_FRAMEWORK_PATH、DYLD_FRAMEWORK_PATH、DYLD_LIBRARY_PATH 环境变量对于 myApp 来说是可以的

我怀疑问题出在应用程序启动后 XCode 和模拟器之间的通信中……尽管我找不到问题所在……

有效的解决方案（至少对我来说）肯定有一些很大的副作用，但它是：退出 xcode 浏览包 myApp.xcodeproj 的内容解锁 .model1v3 和 .pbxuser 进行修改（信息面板中的锁定（cmd-我在文件上））删除这两个文件启动 xcode 并重试从那里启动您的应用程序

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-10T23:45:26.843

我在使用 Xcode 3.2.1 时遇到了同样的问题，但它以更简单的方式解决了。我意识到我最近禁用了目标的环境变量，特别是与内存调试有关的环境变量（NSDebugEnabled、NSZombieEnabled、NSAutoreleaseFreedObjectCheckEnabled、MallocStackLogging、MallocStackLoggingNoCompact）。删除环境变量后，该应用程序在模拟器中运行了一次，但此后再也没有运行过。

退出 Xcode、模拟器、重新启动 Xcode 并彻底清除目标（包括它的依赖项）使我回到了一个良好的状态。

# c# - 为 ASP.NET 升级 Telerik RAD 控件

> ID：1016206
> 
> 赞同：2
> 
> 时间：2009-06-19T03:16:59.733
> 
> 标签：c#, asp.net, vb.net, telerik, rad-controls

有人能告诉我如何升级 Telerik ASP.NET 控件吗？我目前使用的是 2008 年第三季度的版本，而我最近刚刚购买了 2009 年第一季度的 SP1 版本。如何升级我的项目？我需要卸载旧的并安装新的还是只安装新的？另外我的项目如何升级？另外，我“活”的项目呢？我只需要上传新的 DLL 并更改我的 web.config 吗？任何指导都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T08:50:41.717

如果您有多个实时站点，我建议将它们全部保存在相同版本的 Telerik RadControls 中。如果您将已编译的程序集部署到您的站点，并且您使用站点的 /bin 或服务器的 GAC 中找到的不同版本的 RadControls 进行编译，您将收到错误消息。（我猜至少没有程序集重定向）

在过去的一年中，我通过以下过程多次升级了 RadControls：

1.  在开发机器中完全安装新的 RadControls 版本
2.  将项目中的 Telerik.Web.UI.dll 替换为新版本。
3.  重新编译和测试。有惊喜，特别是在控件的外观和感觉方面。皮肤也可以更改，并且您可能引用了不再存在的皮肤，从而导致错误。
4.  将新编译的 dll 和 Telerik.Web.UI.dll 同时部署到生产环境
5.  从开发机器卸载旧 Radcontrols 版本

我只使用 Visual Studio Web 应用程序项目，并在站点的 /bin 文件夹中引用 Telerik.Web.UI.dll。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T04:41:12.153

将 RadControls for ASP.NET 更新到另一个版本或许可证 [http://www.telerik.com/support/kb/aspnet-ajax/general/updating-radcontrols-for-asp-net-to-another-version-or-license .aspx](http://www.telerik.com/support/kb/aspnet-ajax/general/updating-radcontrols-for-asp-net-to-another-version-or-license.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T05:21:31.613

您将获得一个发行说明以及新版本。只需检查此版本和该文档的兼容性部分中的新增内容，看看该版本中是否存在任何重大更改（您不会有任何 ，但最好看看双重确保）。您需要做的就是将最新的 DLL 放入 GAC 并更改 Web.Config 文件，然后测试您的应用程序。如果每件事看起来都一样，那么在生产中也做同样的事情。如果您在 dll 项目中使用 Telerik dll。尝试在 Web 配置中添加程序集重定向条目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-19T19:28:57.203

Telerik TV 上还有几个视频向您展示如何手动和自动升级使用 RadControls 的项目：

[http://tv.telerik.com/search?q=upgrade](http://tv.telerik.com/search?q=upgrade)

希望有帮助。

# internet-explorer - 如何在网络浏览器上获取最近查看的图片？

> ID：1016212
> 
> 赞同：2
> 
> 时间：2009-06-19T03:18:41.340
> 
> 标签：internet-explorer, caching

我想从 IE 中检索最近查看的图片。我知道 IE 中的所有文件都存在于 Internet 临时目录中，通常路径为“C:\Documents and Settings[account]\Local Settings\Temporary Internet Files”。

对我来说奇怪的事情来了。我写了一个C++程序来检索上面的目录，结果说它包含三个子目录和一个文件。这些子目录分别是Content.IE5、OIS、OLK145，每一个都包含很多图片，我想是我最近在网上浏览的那些。唯一的文件是desktop.ini，这不是我关心的。但是，当我在文件系统中打开目录时，根本没有子目录，而是有很多文件，与程序检索到的子目录中的文件不同。

我有几个问题。首先，为什么临时互联网文件的内容看起来不同？关于目录的实际情况是什么？其次，我发现在文件系统资源管理器中，目录中的文件似乎与网络上的文件有一些链接，实际上并不存在于我的计算机上，这是真的吗？最后，我怎样才能得到最近用C++从IE浏览的图片，以及它们的原始url？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T03:47:57.520

如果您熟悉 C++ 和 COM，则可以使用 WinInet 调用。

[`FindFirstUrlCacheEntry`](http://msdn.microsoft.com/en-us/library/aa384026(VS.85).aspx)会让你开始......[完整的参考资料在 msdn 上](http://msdn.microsoft.com/en-us/library/aa385483(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-09T07:17:19.830

explorer 有许多 shell 扩展，这会阻止它显示某些文件夹的真实内容，例如“临时 Internet 文件”。实际上，当您单击其文件夹时，shell 扩展程序会激活并告诉资源管理器查看其他内容。您可以通过在 start->run 中键入地址来查看真实内容。看看“IECacheView”。它是一个小程序，用于检索缓存文件的内容和原始 url。

# php - 用 php 启动类

> ID：1016213
> 
> 赞同：0
> 
> 时间：2009-06-19T03:18:44.850
> 
> 标签：php, oop

我有一个启动另一个类的类，我不关心对象的引用我只需要方法并且必须传入新参数。

```
class A {
     __set .....
}

class B extends A {
     $anotherA = new A;
     $anotherA->myName = 'stackoverflow';
} 
```

简而言之，我想让 B 类扩展 A，初始化 A 的新实例，但我不想每次都输入“new”，我看到了以下语法：

```
B::A // something like that 
```

但不知道如何使用它或者这是否会做我想做的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T03:28:04.643

您可以做的是在返回新实例的类上定义一个静态方法。它基本上是一个“捷径”，但它在后台的作用完全相同。

```
class C {
   public static function instance()
   {
      return new C();
   }

   public function instanceMethod()
   {
      echo 'Hello World!';
   }
} 
```

现在你可以这样称呼它：

```
C::instance()->instanceMethod(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:50:53.947

下面是一些静态函数的例子——它们可以在不使用'new A'或'new B'的情况下被调用。

```
class A {
    static function message($msg = 'I am Alpha') {
        echo "hi there, $msg\n";
    }
}

class B {
    static function message() {
        A::message("I am Beta");
    }
}

A::message();
B::message(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T03:26:33.320

由于您在 B 中扩展 A，因此可以调用 A 类的方法：

```
class B extends A {
    public function someMethod() {
        parent::someMethodName();
    }
} 
```

或者，您可以在类中创建一个静态方法：

```
class A {
    public static function someStaticMethod() { ... }
}

A::someStaticMethod(); 
```

如果您真的想要*A 的新实例*，*则必须*使用`new`运算符。这就是它的用途。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T09:01:05.217

我会在 B 的构造函数中创建 A 的实例，然后你可以使用它的构造函数或 static 实例化 B `B::create()`，这只是一个快捷方式。如果您希望所有实例化都通过，您可以将构造函数设为私有`create()`。

```
class A {
    // __set .....
}

class B extends A {
     public function __construct() {
         parent::__construct();
         $anotherA = new A;
         $anotherA->myName = 'stackoverflow';
     }

     public static function create() {
         return new self();
     }
}

new B();
B::create(); 
```

# css - 运行 Quirks 模式的 IE8 的 CSS 问题

> ID：1016217
> 
> 赞同：0
> 
> 时间：2009-06-19T03:22:09.507
> 
> 标签：css, internet-explorer-8

**在IE8 和 Quirks Mode 下**运行时，两个图像之间有一些神秘的填充。这两张图片作为我未来网站的标志。

我已将问题隔离到单个 html 文件 [http://etcbc.org/ie_problem/ie.html](http://etcbc.org/ie_problem/ie.html)中。

应该说是“东多伦多浸信会”。如您所见，“toro”“nto”之间目前有一个空格。是什么导致 IE8 中出现这个空间并在 Quirks 模式下运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T03:27:03.130

非 IE 浏览器在该页面上的表现更差。

您的图像都在各自的`<a />`标签中，其样式为“ `display: block;`”。显示块通常将每个元素放在自己的行上（取决于应用到它们的其他样式）。

要解决此问题，请从元素中删除“显示：块”样式。

```
<a href="http://www.etcbc.org/">
    <img style="border-bottom: 0px; border-left: 0px; padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; border-top: 0px; border-right: 0px; text-decoration: none; padding-top: 0px" src="logo_1.png" />
</a>
<a href="http://www.etcbc.org/">
    <img style="border-bottom: 0px; border-left: 0px; padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; border-top: 0px; border-right: 0px; text-decoration: none; padding-top: 0px" src="logo_2.png" />
</a> 
```

如果您需要您的图像是块级元素，请使用浮动将它们彼此对齐，然后解决由于在页面上放置浮动元素而导致的任何（潜在）布局问题，请使用[这个聪明的解决方案](http://www.quirksmode.org/blog/archives/2005/03/clearing_floats.html)。

如果可能，您应该考虑为您的样式使用类而不是内联它们。就目前的情况而言，它们将成为维护的噩梦。

此外，如果您对此有控制权，请在页面的 HTML 中[放置一个 doctype](http://www.w3schools.com/tags/tag_DOCTYPE.asp)（我建议使用 XHTML 1.0 Transitional。所有酷孩子都在这样做！），这样您就不会打开 Quirks Mode。开启 Quirks Mode 可能会引起很多麻烦，尤其是当您尝试使用“新”技术让您的网站更好地为用户服务时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:30:38.943

使用有效的 DOCTYPE 并退出 quirksmode：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-12T08:51:01.427

只是与 quirksmode 所做的一些事情的快速链接：

[http://www.cs.tut.fi/~jkorpela/quirks-mode.html](http://www.cs.tut.fi/~jkorpela/quirks-mode.html)

它在那里说，quirksmode 中图像的默认水平边距是 3 像素。而那个填充在 CSS 中被忽略了，所以，可能就是这样。

# stack - 无堆栈语言如何工作？

> ID：1016218
> 
> 赞同：62
> 
> 时间：2009-06-19T03:22:14.483
> 
> 标签：stack, language-design, stackless

我听说过无堆栈语言。但是我不知道如何实现这种语言。有人可以解释吗？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-06-27T16:38:20.913

我们拥有的现代操作系统（Windows、Linux）使用我所说的“大堆栈模型”运行。这种模型有时是错误的，它激发了对“无堆栈”语言的需求。

“大堆栈模型”假定编译后的程序将在内存的连续区域中为函数调用分配“堆栈帧”，使用机器指令非常快速地调整包含堆栈指针（和可选堆栈帧指针）的寄存器。这导致快速的函数调用/返回，代价是为堆栈提供一个大的、连续的区域。因为在这些现代操作系统下运行的所有程序中有 99.99% 在大堆栈模型下运行良好，所以编译器、加载程序甚至操作系统都“知道”这个堆栈区域。

所有此类应用程序的一个常见问题是，*“我的堆栈应该有多大？”* . 由于内存非常便宜，大多数情况下会为堆栈留出一大块（MS 默认为 1Mb），而典型的应用程序调用结构永远不会接近使用它。但是如果一个应用程序确实用完了它，它就会因非法的内存引用而死掉（“对不起，戴夫，我不能那样做”），因为它已经超出了堆栈的末尾。

大多数所谓的“无堆栈”语言并不是真正的无堆栈语言。他们只是不使用这些系统提供的连续堆栈。相反，他们所做的是在每次函数调用时从堆中分配一个堆栈帧。每个函数调用的成本有所上升；如果功能通常很复杂，或者语言是解释性的，那么这个额外的成本是微不足道的。（也可以在程序调用图中确定调用 DAG 并分配一个堆段来覆盖整个 DAG；这样您就可以获得堆分配和调用 DAG 内所有调用的经典大堆栈函数调用的速度）。

对堆栈帧使用堆分配有几个原因：

1.  如果程序根据它正在解决的特定问题进行深度递归，则很难预先分配“大堆栈”区域，因为所需的大小是未知的。人们可以笨拙地安排函数调用来检查是否还有足够的堆栈，如果没有，则重新分配一个更大的块，复制旧堆栈并重新调整所有指针到堆栈中；这太尴尬了，我不知道任何实现。分配堆栈帧意味着应用程序永远不必说对不起，直到实际上没有可分配的内存。

2.  该程序分叉子任务。每个子任务都需要自己的堆栈，因此不能使用提供的一个“大堆栈”。因此，需要为每个子任务分配堆栈。如果您有数千个可能的子任务，您现在可能需要数千个“大堆栈”，而内存需求突然变得荒谬。分配堆栈帧解决了这个问题。通常，子任务“堆栈”引用父任务来实现词法作用域；作为子任务分叉，“子堆栈”树被创建，称为“仙人掌堆栈”。

3.  你的语言有延续。这些要求以某种方式保留当前函数可见的词法范围内的数据以供以后重用。这可以通过复制父堆栈帧、爬上仙人掌堆栈并继续来实现。

我实现的[PARLANSE](http://www.semanticdesigns.com/Products/PARLANSE)编程语言做了 1) 和 2)。我正在研究3）。有趣的是，PARLANSE 从一个访问速度非常快的每个线程的堆中分配堆栈帧。它通常需要 4 条机器指令。当前的实现是基于 x86 的，分配的帧被放置在 x86 EBP/ESP 寄存器中，这与其他传统的基于 x86 的语言实现非常相似。所以它确实以块的形式使用硬件“连续堆栈”（包括推送和弹出）。它还为预先知道堆栈需求的大量生成的实用程序代码生成“帧本地”子例程调用，不要切换堆栈。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-19T03:29:47.573

[Stackless Python](http://www.stackless.com/)仍然有一个 Python 堆栈（虽然它可能有尾调用优化和其他调用帧合并技巧），但它完全脱离了解释器的 C 堆栈。

Haskell（通常实现）没有调用堆栈；评估基于[图形缩减](http://en.wikibooks.org/wiki/Haskell/Graph_reduction)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-27T20:24:45.760

有一篇关于[语言框架 Parrot](https://web.archive.org/web/20100706035639/http://www.linux-mag.com/cache/7373/1.html)的好文章。Parrot 不使用堆栈进行调用，本文稍微解释了该技术。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-19T03:24:56.880

在我或多或少熟悉的无堆栈环境（图灵机、装配和 Brainfuck）中，实现自己的堆栈是很常见的。在语言中内置堆栈没有什么基本的。

在其中最实用的汇编中，您只需选择一个可用的内存区域，将堆栈寄存器设置为指向底部，然后递增或递减以实现您的推送和弹出。

编辑：我知道有些架构有专用的堆栈，但它们不是必需的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-09T04:20:05.143

称我为古老的，但我记得 FORTRAN 标准和 COBOL 何时不支持递归调用，因此不需要堆栈。确实，我记得没有堆栈的 CDC 6000 系列机器的实现，如果您尝试递归调用子例程，FORTRAN 会做一些奇怪的事情。

作为记录，CDC 6000 系列指令集使用 RJ 指令来调用子程序，而不是调用堆栈。这将当前 PC 值保存在调用目标位置，然后分支到它后面的位置。最后，子程序将间接跳转到调用目标位置。重新加载保存的 PC，有效地返回给调用者。

显然，这不适用于递归调用。（我记得如果您尝试递归，CDC FORTRAN IV 编译器会生成损坏的代码......）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-27T20:35:47.890

这篇文章有一个易于理解的延续描述：http: [//www.defmacro.org/ramblings/fp.html](http://www.defmacro.org/ramblings/fp.html)

延续是您可以在基于堆栈的语言中传递给函数的东西，但也可以被语言自己的语义使用以使其“无堆栈”。当然堆栈仍然存在，但正如 Ira Baxter 所描述的，它不是一个连续的大段。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-01-29T11:44:26.733

假设您想实现无堆栈 C。首先要意识到这不需要堆栈：

```
a == b 
```

但是，这样吗？

```
isequal(a, b) { return a == b; } 
```

不会。因为智能编译器会内联对 的调用`isequal`，将它们转换为`a == b`. 那么，为什么不直接内联所有内容呢？当然，您会生成更多代码，但如果摆脱堆栈对您来说是值得的，那么这很容易，只需稍作权衡即可。

递归呢？没问题。尾递归函数，如：

```
bang(x) { return x == 1 ? 1 : x * bang(x-1); } 
```

仍然可以内联，因为实际上它只是一个变相的 for 循环：

```
bang(x) {
    for(int i = x; i >=1; i--) x *= x-1;
    return x;
} 
```

理论上，一个非常聪明的编译器可以为你解决这个问题。但是一个不太聪明的人仍然可以将其压扁为 goto：

```
ax = x;
NOTDONE:
if(ax > 1) {
    x = x*(--ax);
    goto NOTDONE;
} 
```

在一种情况下，您必须进行小幅权衡。这不能内联：

```
fib(n) { return n <= 2 ? n : fib(n-1) + fib(n-2); } 
```

Stackless C 根本无法做到这一点。你放弃很多吗？并不真地。这也是普通 C 语言做不到的。如果您不相信我，请致电`fib(1000)`，看看您宝贵的计算机会发生什么。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-09-12T04:41:39.067

如果我错了，请随时纠正我，但我认为在堆上为每个函数调用帧分配内存会导致严重的内存抖动。操作系统毕竟必须管理此内存。我认为避免这种内存抖动的方法是缓存调用帧。所以如果你无论如何都需要一个缓存，我们不妨让它在内存中是连续的，并称它为堆栈。

# asp.net-ajax - 母版页中的脚本管理器和用户控件中的更新面板。部分回发未发生

> ID：1016237
> 
> 赞同：1
> 
> 时间：2009-06-19T03:33:37.377
> 
> 标签：asp.net-ajax, user-controls, updatepanel, master-pages

我有一个带有以下 scriptmanager 标签的母版页：

```
<asp:ScriptManager ID="scriptManger" EnablePartialRendering="true" runat="server" >
    <Scripts>
        <asp:ScriptReference Path="~/common/js/jquery-1.3.2.js" />
        <asp:ScriptReference Path="~/common/js/validation.js" />
    </Scripts>
</asp:ScriptManager> 
```

我的 aspx 页面是：

```
 <%@ Page Language="C#" AutoEventWireup="true" MasterPageFile="~/common/MasterPages/Login.master" CodeBehind="SecurityQuestionsEnroll.aspx.cs" Inherits="Login.SecurityQuestionsEnroll" %>

    <%@ Register src="~/controls/Views/Login/SecurityQuestions.ascx" tagname="SecurityQuestions" tagprefix="uc1" %> 
```

这是用户控件：

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server" ChildrenAsTriggers="true" UpdateMode="always"  >
<ContentTemplate>  
    <asp:DataList ID="dlSecurityQuestions" runat="server" AutoPostBack="true" OnSelectedIndexChanged ="dlSecurityQuestions_SelectedIndexChanged">
        <ItemTemplate>
            <div>
                <asp:Label ID="lbl_question" AssociatedControlID="lst_question" runat="server"><%# DataBinder.Eval(Container.DataItem, "QuestionName")%></asp:Label>
                <asp:DropDownList ID="lst_question" runat="server" AutoPostBack="true" >
                    <asp:ListItem Value="0">Select a Question...</asp:ListItem>
                    <asp:ListItem Value="1">Select a Question1..</asp:ListItem>
                </asp:DropDownList>
            </div>
            <div>
                <asp:Label ID="lbl_answer1" AssociatedControlID="txt_answer" runat="server">Answer *</asp:Label>
                <asp:TextBox ID="txt_answer" runat="server" />
                <div id="validate"></div>
            </div>
        </ItemTemplate>
    </asp:DataList>
</ContentTemplate>
</asp:UpdatePanel> 
```

我已经尝试了谷歌推荐的大多数选项，但我无法进行部分回发。每次更改 selectedindex 时，它都会进行整页回发。如您所见，下拉菜单位于 itemtemplate 中并被重复。你认为我做错了什么，它没有触发更新面板的回发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-25T10:21:14.637

如果您有更新面板但没有脚本管理器，则此方法有效：

```
<asp:ScriptManager ID="scriptManger" EnablePartialRendering="true" runat="server" >

</asp:ScriptManager> 
```

但我也有一个母版页。所以我想知道是不是因为我需要脚本管理器的母版页

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T15:16:58.967

我建立了一个小测试项目，稍微模仿你的文件。我没有使用 DataList，我已将需要更新的区域移到单独的 div 中（这意味着如果您保留 DataList，我认为您的问题/答案不会像您一样位于 DataList 中现在就拥有它。所以现在，我构建的示例只是从下拉列表中获取文本，并使用用户选择的选项更新 UpdatePanel 中的文字。

这是我的代码：

母版页：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site1.master.cs" Inherits="UpdatePanelTest.Site1" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <asp:ScriptManager ID="scriptManger" EnablePartialRendering="true" runat="server" >
        <Scripts>
            <asp:ScriptReference Path="~/common/js/jquery-1.3.2.min.js" />
        </Scripts>
    </asp:ScriptManager>

    <div>
        <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server">

        </asp:ContentPlaceHolder>
    </div>

    </form>
</body>
</html> 
```

默认页面（代码隐藏中没有其他代码）：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site1.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="UpdatePanelTest.Default" %>
<%@ Register src="Selector.ascx" tagname="Selector" tagprefix="uc1" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">

    <uc1:Selector ID="Selector1" runat="server" />

</asp:Content> 
```

用户控制（HTML）：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Selector.ascx.cs" Inherits="UpdatePanelTest.Selector" %>
<asp:UpdatePanel ID="UpdatePanel1" runat="server" ChildrenAsTriggers="true" UpdateMode="always"  >
<ContentTemplate>  
    <asp:DropDownList ID="lst_question" runat="server" AutoPostBack="true" 
    onselectedindexchanged="lst_question_SelectedIndexChanged" >
        <asp:ListItem Value="0">Option 1</asp:ListItem>
        <asp:ListItem Value="1">Option 2</asp:ListItem>
    </asp:DropDownList>

    <div>
        <asp:Literal ID="Literal1" runat="server"></asp:Literal>
    </div>
</ContentTemplate>
</asp:UpdatePanel> 
```

用户控制（代码隐藏）：

```
using System;
using System.Web.UI.WebControls;

namespace UpdatePanelTest
{
    public partial class Selector : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void lst_question_SelectedIndexChanged(object sender, EventArgs e)
        {
            var ddl = sender as DropDownList;
            Literal1.Text = "You selected " + ddl.SelectedItem.Text;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-16T17:44:24.597

我`<asp:UpdatePanel ID="id" runat="server" ChildrenAsTriggers="true" UpdateMode="always" >`在您的`UpdatePanel`定义中看到 -`UpdateMode="Conditional"`如果您希望 UpdatePanel 异步工作，则必须如此。不知道为什么 ASP:NET 开发人员一开始没有将其设置为 Conditional 作为默认值（我有时仍然会忘记它）。

也许已经是这样了？

# c# - 如何创建打开表单的自定义 PropertyGrid 编辑器项？

> ID：1016239
> 
> 赞同：38
> 
> 时间：2009-06-19T03:33:56.690
> 
> 标签：c#, winforms, propertygrid

我有一个 List<> （我的自定义类）。我想在 PropertyGrid 控件的框中显示此列表中的特定项目。在框的末尾，我想要 [...] 按钮。单击时，它会打开一个表单，除其他外，该表单将允许他们从列表中选择一个项目。关闭时，PropertyGrid 将更新以反映所选值。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-06-19T04:31:07.140

您需要实现一个 modal `UITypeEditor`，使用`IWindowsFormsEditorService`服务来显示它：

```
using System.ComponentModel;
using System.Drawing.Design;
using System.Windows.Forms;
using System.Windows.Forms.Design;
using System;

class MyType
{
    private Foo foo = new Foo();
    public Foo Foo { get { return foo; } }
}

[Editor(typeof(FooEditor), typeof(UITypeEditor))]
[TypeConverter(typeof(ExpandableObjectConverter))]
class Foo
{
    private string bar;
    public string Bar
    {
        get { return bar; }
        set { bar = value; }
    }
}
class FooEditor : UITypeEditor
{
    public override UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context)
    {
        return UITypeEditorEditStyle.Modal;
    }
    public override object EditValue(ITypeDescriptorContext context, System.IServiceProvider provider, object value)
    {
        IWindowsFormsEditorService svc = provider.GetService(typeof(IWindowsFormsEditorService)) as IWindowsFormsEditorService;
        Foo foo = value as Foo;
        if (svc != null && foo != null)
        {            
            using (FooForm form = new FooForm())
            {
                form.Value = foo.Bar;
                if (svc.ShowDialog(form) == DialogResult.OK)
                {
                    foo.Bar = form.Value; // update object
                }
            }
        }
        return value; // can also replace the wrapper object here
    }
}
class FooForm : Form
{
    private TextBox textbox;
    private Button okButton;
    public FooForm() {
        textbox = new TextBox();
        Controls.Add(textbox);
        okButton = new Button();
        okButton.Text = "OK";
        okButton.Dock = DockStyle.Bottom;
        okButton.DialogResult = DialogResult.OK;
        Controls.Add(okButton);
    }
    public string Value
    {
        get { return textbox.Text; }
        set { textbox.Text = value; }
    }
}
static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Form form = new Form();
        PropertyGrid grid = new PropertyGrid();
        grid.Dock = DockStyle.Fill;
        form.Controls.Add(grid);
        grid.SelectedObject = new MyType();
        Application.Run(form);
    }
} 
```

注意：如果您需要访问有关属性上下文（父对象等）的内容，这就是`ITypeDescriptorContext`(in `EditValue`) 提供的内容；它告诉你所涉及的`PropertyDescriptor`and `Instance`(the `MyType`)。

# sql - MS SQL 2005 中的神秘 CPU 活动

> ID：1016240
> 
> 赞同：1
> 
> 时间：2009-06-19T03:34:05.253
> 
> 标签：sql, sql-server, database, sql-server-2005

我正在查看 MS SQL Management Studio 2005 中的活动监视器，我看到一个来自我创建的登录名的条目，它正在使用 tempdb，最后一个命令始终是“SELECT INTO”。每次我在活动监视器中点击“刷新”时，该条目的“CPU”列都会增加 60 倍。该活动的“程序”是“MS SQL Management Studio”。

我试图杀死那个进程，但它不允许我说“不能被杀死”。我断开与数据库的连接并重新连接，该过程仍然存在。

由于持续的活动，它最终会导致我的 SQL Server 崩溃吗？有没有人熟悉这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T03:41:39.263

这是绝对正常的。Select Into 将数据选择到临时表中，以显示您在活动监视器中看到的内容。无需恐慌。它不会使您的 SQL Server 崩溃。

拉吉

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:37:04.890

那是你。更具体地说，SSMS。通常，它会使用`SELECT INTO`一些临时表（它调用的东西，实际上会这样做），以便从服务器获取数据以显示给您。打开另一个 SSMS，您应该会看到其中两个。

# sql-server - 如何将不一致的 nvarchar 数据读取为十进制数据

> ID：1016241
> 
> 赞同：0
> 
> 时间：2009-06-18T22:56:48.287
> 
> 标签：sql-server, tsql, reporting-services

对于`SSRS 2005`报告，我如何`nvarchar`从数据库中读取不一致的数据值作为一致的数字十进制数据以绘制折线图？

该`nvarchar`列有实验室读数作为`nvarchar(15)`数据类型绘制在图表上。

数据不一致的示例列，如图所示

```
columnvalues
00123
102
(NULL)
333
456
N/R
No Result
567
589 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T02:22:00.167

我的老板帮我解决了这个问题。您可以根据数据中的不一致情况在以下查询的末尾添加更多子句。

使用数据库 go select convert(decimal (10,2), ltrim(rtrim(columnname))) from table where isumeric(columnname) = 1 and ltrim(rtrim(columnname)) <> '.'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T18:42:12.470

假设您的表是 LabData 并且您的数字列名为 LabReading：

```
SELECT
    LabReadingValue =
        CASE 
            WHEN ISNUMERIC(LabReading)=1
            THEN CAST(LabReading AS DECIMAL(15,4))
            ELSE NULL 
        END
FROM
    LabData 
```

如果要过滤掉非数字值，可以添加：

```
WHERE ISNUMERIC(LabReading)=1 
```

# unix - 用于查找字符串集交点或异常值的 Unix 命令？

> ID：1016244
> 
> 赞同：21
> 
> 时间：2009-06-19T03:37:35.480
> 
> 标签：unix, grep, set

是否有与 UNIX 命令相当的

```
sort | uniq 
```

查找字符串集的交点或“异常值”。

一个示例应用程序：我有一个 html 模板列表，其中一些有 {% load i18n %} 字符串，其他没有。我想知道哪些文件没有。

**编辑：** grep -L 解决了上述问题。

这个怎么样：

文件1：

```
mom
dad
bob 
```

文件2：

```
dad 
```

% 相交文件 1 文件 2

```
dad 
```

%left-unique file1 file2

```
mom
bob 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-19T05:07:15.813

似乎`grep -L`解决了海报的真正问题，但对于提出的实际问题，找到两组字符串的交集，您可能需要查看“comm”命令。例如，如果`file1`和`file2`each 包含一个排序的单词列表，每行一个单词，那么

```
$ comm -12 file1 file2 
```

将产生两个文件共有的单词。更一般地说，给定排序的输入文件`file1`和`file2`，命令

```
$ comm file1 file2 
```

产生三列输出

1.  仅在 file1 中的行
2.  仅在 file2 中的行
3.  file1 和 file2 中的行

`N`您可以使用该`-N`选项抑制输出中的列。因此，上面的命令`comm -12 file1 file2`, 抑制了第 1 列和第 2 列，只留下两个文件共有的单词。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T04:27:17.017

相交：

```
# sort file1 file2 | uniq -d
dad 
```

左唯一：

```
# sort file1 file2 | uniq -u
bob
mom 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-20T05:13:59.567

来自[http://www.commandlinefu.com/commands/view/5710/intersection-between-two-files](http://www.commandlinefu.com/commands/view/5710/intersection-between-two-files)：

两个（未排序的）文件之间的交集：

```
grep -Fx -f file1 file2 
```

file2 中不在 file1 中的行：

```
grep -Fxv -f file1 file2 
```

解释：

*   该`-f`选项告诉 grep 从文件中读取要查找的模式。这意味着它为 file1 中的每一行执行 file2 搜索。
*   该`-F`选项告诉 grep 将搜索词视为固定字符串，而不是模式，因此`a.c`只会匹配`a.c`而不匹配`abc`，
*   该`-x`选项告诉 grep 进行整行搜索，以便 file1 中的“foo”与 file2 中的“foobar”不匹配。
*   默认情况下，grep 将只显示匹配的行，为您提供交集。该`-v`选项告诉 grep 只显示*不匹配*的行，为您提供 file2 独有的行。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-19T03:40:15.587

也许我误解了这个问题，但为什么不只使用 grep 来查找字符串（使用 -L 选项让它打印其中没有字符串的文件的名称）。

换句话说

```
grep -L "{% load i18n %}" file1 file2 file3 ... etc 
```

或根据需要为文件名使用通配符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T03:46:57.973

从男人`grep`

```
-L, --files-without-match 
```

> 抑制正常输出；而是打印通常不会打印输出的每个输入文件的名称。扫描将在第一次匹配时停止。

因此，如果您的模板是您想要的 .html 文件：

```
grep -L '{% load i18n %}' *.html 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-05-22T12:34:20.947

路口：

```
comm -12 <(cat file1 | sort | uniq) <(cat file2 | sort | uniq) 
```

3 列的所有行（文件 1 | 文件 2 | 交集）：

```
comm <(cat file1 | sort | uniq) <(cat file2 | sort | uniq) 
```

如果您的文件未排序和/或如果其中一个文件中可能有重复但未出现在另一个文件中的行 - 此单行命令将对您的文件进行排序，删除重复的行，您将直接得到你想要的结果。

# refactoring - 在进行代码重构时需要隐藏多少信息？

> ID：1016255
> 
> 赞同：1
> 
> 时间：2009-06-19T03:42:21.290
> 
> 标签：refactoring, information-hiding

需要隐藏多少信息？在删除记录之前，我有样板代码，如下所示：

```
 public override void OrderProcessing_Delete(Dictionary<string, object> pkColumns)
    {
        var c = Connect();

        using (var cmd = new NpgsqlCommand("SELECT COUNT(*) FROM orders WHERE order_id = :_order_id", c)
            { Parameters = { {"_order_id", pkColumns["order_id"]} } } )
        {
            var count = (long)cmd.ExecuteScalar();

            // deletion's boilerplate code...
            if (count == 0) throw new RecordNotFoundException();
            else if (count > 1) throw new DatabaseStructureChangedException();
            // ...boiler plate code
        }

        // deleting of table(s) goes here...
    } 
```

注意：样板代码是代码生成的，包括“使用（var cmd = new NpgsqlCommand（...）”

但我正在认真考虑重构样板代码，我想要一个更简洁的代码。这就是我设想重构代码的方式（使用扩展方法变得更好（不是唯一的原因；））

```
 using (var cmd = new NpgsqlCommand("SELECT COUNT(*) FROM orders WHERE order_id = :_order_id", c)
        { Parameters = { {"_order_id", pkColumns["order_id"]} } } )
    {
              cmd.VerifyDeletion(); // [EDIT: was ExecuteWithVerification before]
    } 
```

我希望执行标量和样板代码进入扩展方法。

对于我上面的代码，它是否需要代码重构/信息隐藏？我的重构操作看起来太不透明了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T03:53:18.520

如果你的新单行代码替换了程序中许多地方的几行代码，我会说你的重构非常好。特别是因为所有这些地方的功能都是相同的。

追随你并查看你的代码的程序员只会查看扩展方法的定义以找出它的作用，现在他知道这段代码是在一个地方定义的，所以它不可能与地方不同放置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T04:17:21.037

如果你必须尝试，但我的感觉不是简洁，而是你是否每次或大部分时间都想**强制执行该行为。**并且通过扩展，如果验证条件发生变化，它可能会全面改变。

基本上，减少一小部分样板代码并不一定会让事情变得更简洁。这只是开发人员必须经历和理解的又一点抽象。

作为开发人员，我不知道“ExecuteWithVerify”是什么意思。我们到底在验证什么？我必须查一下并记住它。但是通过样板代码，我可以查看代码并准确了解发生了什么。

通过不将其简化为单独的方法，我还可以针对需要针对不同条件引发异常的情况调整样板代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T04:07:05.200

当您提取或重构代码时，它不会隐藏信息。只有在重构后开始限制对扩展定义的访问时，它才会隐藏信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-11-21T18:20:08.493

应不惜一切代价避免类中的“新”运算符（构造函数除外）。这就是您需要在这里重构的内容。

# php - RESTful 流程？

> ID：1016258
> 
> 赞同：1
> 
> 时间：2009-06-19T03:45:17.383
> 
> 标签：php, rest

所以...

我一直在阅读一些关于[REST](http://www.infoq.com/articles/rest-introduction)的内容，它背后的想法听起来不错，但问题是，它能否轻松集成到网页的标准流程中？

例如，用户创建了某种项目、博客文章或您拥有的东西，现在他想删除它，因此他单击页面上的“删除”链接。怎么办？我们如何发出删除请求，比如说，`http://mysite.com/posts/5`？我们如何处理这个请求？我没有使用 cURL 或任何东西的经验，但从外观上看，我必须`curl_init('http://mysite.com/posts/5')`做一些魔术。但是我什至会把那个脚本放在哪里？那必须在另一个页面上，这会破坏 REST 的整个想法。然后我只是在`GET`ing 另一个页面，而这又会`DELETE`是我最初想要的页面？

这就是人们很少使用的原因`REST`还是实际上有一个很好的方法来做到这一点？

* * *

看来我需要澄清一下。人们建议我在 URL 中包含“DELETE”和“POST”之类的词。我相信 REST 规定我们对每个*资源*都有一个唯一的 URL，而*不是*对该资源的每个操作。我假设这也意味着我们对于每个资源只有*一个*且只有*一个URL。*即我希望能够从*一个*URL 删除或查看特定帖子的内容（通过发送 DELETE、PUT、POST 或 GET），而不是带有附加参数的不同 URL

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T05:20:10.070

使用 restful 服务器，相同的 url（比如 /books/1）可以响应许多不同的动词。这些动词 GET、POST、PUT 和 DELETE 与路径一起指示*您要对服务器上的数据执行什么操作*。响应会告诉您对您的请求的回答。

REST 是以可预测和合理的方式访问数据。

如果您来自强大的 PHP 背景，其中每个 url 都必须映射到特定文件，那么您是对的，这没有任何意义。两个最明显的 RESTful 开发环境，ASP.NET MVC 和 Rails，每个都有特殊的服务器（或服务器逻辑）来读取动词并为您执行特殊的路由。这就是让应用程序的“正常流程”按您所期望的那样进行的原因。对于 PHP，有一些框架可以帮助解决这个问题，例如[WSO2 的 WSF](http://wso2.org/projects/wsf/php)。

## REST 如何与 Web 浏览器一起工作

以你的例子为例。我们有帖子，我们想删除一个。

1.  我们首先访问 /posts/4 之类的 url。正如我们所料，这显示了帖子 4、它的属性以及您可以对其采取的一些操作。呈现此 url 的请求如下所示`GET /posts/4`。响应包含描述该项目的 HTML。

2.  用户单击 HTML 的一部分“删除项目 4”链接。这会向`DELETE /posts/4`服务器发送一个请求。注意，这里重用了`/posts/4`url，但逻辑一定不同。

    在 HTML 表单和 Web 浏览器中，许多默认情况下会将带有 method="delete" 的链接更改为 method="post" 链接。您将需要使用 Javascript（类似[这样](https://stackoverflow.com/questions/523843/how-do-you-send-a-request-with-the-delete-http-verb/535312#535312)的东西）来更改动词。作为替代， Ruby on Rails 使用隐藏的输入字段 ( `_method`) 来指示要在表单上使用哪种方法。

3.  在服务器端，执行“删除项目”逻辑。它知道要执行此操作，因为请求 ( `DELETE`) 中的动词与正在执行的操作相匹配。这是 REST 的一个关键点，即 HTTP 动词变得有意义。

4.  删除项目后，您可以回复“是的，完成”或“不，抱歉，您不能这样做”这样的页面，但对于浏览器来说，将您放在其他地方更有意义。被删除的项目，通过重定向响应是`GET /posts`很有意义的。

如果你查看服务器日志，就会很清楚每个人对服务器做了什么，但这并不重要...

## REST 如何处理任意数据

REST 的另一个关键点是它可以很好地处理多种数据格式。假设您正在编写一个想要以编程方式阅读博客并与之交互的程序。您可能希望以 XML 格式提供所有帖子，而不必从 HTML 中获取信息。

`GET /posts/4.xml`很直观：“服务器，请给我描述帖子 #4 的 xml。” 响应将是那个 xml。RESTful 服务器使如何获取所需信息变得一目了然。

当您提出`DELETE /posts/4.xml`请求时，您是在询问“服务器，请删除第 4 项”。像“好的，当然”这样的回应通常足以表达发生的事情。然后程序可以决定它还想要什么并发出另一个请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T03:49:26.037

根据您使用的框架，有一些模型可以确定如何处理每个资源的操作。

基本上使用另一个参数，您想向资源发送要执行的操作。例如，该参数可以通过 AJAX/JS 发送。

如果您想在**没有**javascript/ajax 的情况下执行此操作（以防它被禁用），那么表单 POST 方法也可以工作，向资源发送额外的 ACTION 参数。

当然，在这两种情况下，您都必须考虑安全性，并确保他们不会向资源发送他们不应该执行的操作。确保对后端进行检查，并发送适当的响应或错误消息。

客户端脚本，无论是通过 JS/Ajax 还是表单 POST 或其他方法，都需要额外的安全预防措施。

海报澄清后编辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T03:52:45.943

一种方法是使用 DELETE 方法进行 AJAX 调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T03:53:03.603

我不认为很少使用 REST。你现在在 StackOverflow 上使用它。就您的具体示例而言，您可以在支持它的浏览器中通过 XMLHttpRequest 发送 DELETE 请求。当 JS 关闭时，或者对于不兼容的浏览器，您可以执行以下操作：

[发布](http://foo.com/delete?post=5)http://foo.com/delete?post=5

不理想，但仍然比许多网站更安静。

编辑：更改为 POST

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T04:05:53.873

Facebook 的 REST 服务器是一个伪服务器，您可以像他们一样进行操作，要求 post 方法：POST、GET 等，以及该请求所需的操作和其他值。

为什么我说 facebook 是一个伪 REST 服务器？: 嗯，REST 的原则之一说

> *   每个资源都可以使用用于超媒体链接的通用语法进行唯一寻址

在 facebook 你只有 /server.php 并且有你提出请求的地方，即使是（POST，GET，PUT，DELETE ...）

另一种方法是使用 mod_rewrite 并解析客户端请求的 url

编辑：刚刚发现[这个](http://www.lornajane.net/posts/2008/PHP-Rest-Server-part-1-of-3)，看起来很有趣。玩得开心！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T04:50:04.400

不要想太多。您无法使用直接的 HTML 表单和浏览器来执行此操作。[它们不支持 DELETE 方法](http://dev.aol.com/using-rest-with-ajax)。阿贾克斯可以做到。

> 我希望能够从一个 URL 删除以查看特定帖子的内容（通过发送 DELETE、PUT、POST 或 GET），而不是带有附加参数的不同 URL

删除查看？我不确定我是否理解它，但您的删除应该通过标题完成，而不是通过 URL。delete 方法不应返回视图。REST 是一种**服务**，并非所有请求都用于视觉消费。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T12:56:00.063

如果您真的别无选择使用 DELETE 动词，那么我会建议如下内容：

```
POST http://mysite.com/Trashcan?resourceUrl=/Customer/75 
```

您使用的 url 对 REST 来说并不重要，但是，如果您的 url 完全避免动词，则更容易理解 REST 交互方式。

我从 Rails 和 ASP.NET MVC 用户那里看到了很多需要超越标准“动作”的问题，并且很想在控制器上添加一个新动作。这样做的问题是你只是抛弃了 REST 的统一接口约束。

垃圾桶隐喻并不是轻松删除的唯一方法，但我认为它与在 url 中放置“删除”一样清晰。

这里有一些替代动词的更多“基于名词”的方法。

```
POST http://mysite.com/Printer/75/PrintQueue?url=http://mysite.com/Document/xyz
POST http://mysite.com/CurrentLogins?user=bob
POST http://mysite.com/QueryProcessor?query=FindMyInformation
POST http://mysite.com/SearchEngine?searchTerms=cat,blue,furry
POST http://mysite.com/OrderProcessor?cart=http://mysite.com/user/2323/cart 
```

有时你必须想出一些开箱即用的想法才能想出一个基于名词的 url，尝试这样做可能看起来很迂腐，但对我来说，好处来自管理我的变量的能力。我将在我的界面中拥有可变数量的资源，无论我做什么，如果我可以修复可以对这些资源进行操作的动词的数量，那么我会减少我的一个变量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-15T18:37:36.963

另一种方法是，假设基于 web/webapplication 的请求，有 2 个提交按钮。由于 PUT 和 DELETE 使用相同的 uri/url。您可以添加特定的删除表单并将特定名称附加到此删除按钮，因此当通过帖子发送时，您可以使用此按钮名称将操作转换为 DELETE

# windows - 尝试 vcvarsall.bat 后，Unicode-Map-0.112 仍然存在问题

> ID：1016260
> 
> 赞同：0
> 
> 时间：2009-06-19T03:46:36.057
> 
> 标签：windows, perl, module, nmake

非常感谢 ehemient 推荐尝试 vcvarsall.bat。

在 DOS 中成功运行 vcvarsall.bat，它是 MS C++ Express 2008 的一部分

接下来我继续尝试通过使用 ppm 来遵循 PerlMonks 的建议，即[http://www.perlmonks.org/?node_id=434813](http://www.perlmonks.org/?node_id=434813)

所以我尝试再次制作，真的是nmake Unicode-Map-0.112。我又收到了一个问题：

C:\perl\lib\core\win32.h (61)：致命错误 C1083：无法打开包含文件：'windows.h'：没有这样的文件或目录。NMAKE: 致命错误 U1077: 'C:\Program Files\Microsoft Visual Studio 9.0\VC\Bin\Cl.exe: return code '0x2' Stop

我发现我确实有 Windows.h 文件：Windows.h 位于 C:\Program Files\Microsoft SDKs\Windows\v6.0A\Include

我猜我也只需要 Windows.h 到 PATH 。

这听起来是否正确，或者当我跌跌撞撞地前进时，我应该走另一条路线吗？

再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T03:59:17.380

沿着这条路线走的问题是你`perl`是使用不同的编译器编译的。您最好下载包并`ppm`按照我在[如何使用 MS C++ Express 2008 在 Windows 上构建 Perl Unicode::Map 中的描述进行安装。](https://stackoverflow.com/questions/1014637/using-ms-c-express-2008-to-make-perl-unicode-map-0-112-module-on-windows/1015828#1015828).

至于编译工作，您需要在`SetEnv.cmd`脚本之后调用您可以在`Bin`您的平台 SDK 安装目录中找到的`vcvarsall.bat`脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T03:52:10.500

您需要从使用您正在使用的 SDK 版本的变量初始化的环境中调用 nmake。（在您的情况下为 v6.0A）。

在开始菜单中，转到“Microsoft Windows SDK *”菜单文件夹，然后从那里启动 CMD shell。

在该 CMD shell 中，`cd`到您的代码目录并从那里运行 nmake。

# ajax - 通过 AJAX/innerHTML 显示部分 Unicode 编码的数据

> ID：1016265
> 
> 赞同：1
> 
> 时间：2009-06-19T03:47:59.330
> 
> 标签：ajax, unicode, innerhtml

我试图通过 AJAX 调用从服务器获取一些数据，然后使用 responseDiv.innerHTML 显示结果。来自服务器的数据部分使用 Unicode 元素编码，例如：za\u010Dat test。通过设置响应 div 的 innerHTML，这将按原样显示。也就是说，Unicode 不会转换为浏览器中的实际表示。

包含页面的字符集设置为 UTF-8。我已经尝试了大多数其他的东西，比如将 unicode 表示转换为 HTML 实体，但这似乎也不起作用。

我还应该提到，来自服务器的文本也混合了 HTML 标记。HTML 标记应得到尊重。例如，如果来自服务器的文本为`<b>Bold this!</b>`，则文本为粗体。

任何帮助表示赞赏。

维克拉姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T03:55:58.270

你能用'č'替换'\u010D'吗？

如果您正在设置innerHTML，来自服务器的HTML标签应该可以工作。

这对我有用：

```
document.getElementById('info').innerHTML = "&#x010D; <b>Bold this</b>"; 
```

顺便说一句 - 您可以使用 Fiddler 或 Firebug 之类的东西来确保您从服务器获得预期的结果。

更新：使用正则表达式查找 unicode 字符并将其替换为 HTML 实体：

```
$.get('data.txt', function(data) {
    data = data.replace(/\\u([0-9A-F])([0-9A-F])([0-9A-F])([0-9A-F])/g, '&#x$1$2$3$4;');
    document.getElementById('info').innerHTML = data;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-24T01:48:19.937

只需将 unicode 文字直接转换为字符：

`'H\u0065\u006Clo, world!'.replace(/\u([0-9a-fA-F]{4})/, function() {`
    `return String.fromCharCode(parseInt(arguments[1],16));`
`});`

# php - 在 PHP 中将对象转换为字符串

> ID：1016271
> 
> 赞同：3
> 
> 时间：2009-06-19T03:50:56.117
> 
> 标签：php, mysql, caching

我想在 PHP 中将对象转换为字符串。具体来说，我正在尝试获取 mysql 查询响应，并尝试将其转换为可以写入文件并稍后使用的内容。

当然，当您尝试将 Object 写入文件时，PHP 会适当地大喊：**Catchable fatal error: Object of class DB_result could not be convert to string in .....**

或者，如果有其他方法可以将 mysql 查询的结果写入文件，那也可以。我正在玩一个自制的缓存项目:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T03:54:18.580

也许[序列化](http://us.php.net/manual/en/function.serialize.php)？它将接受一个对象/数组并将其转换为一个字符串（然后可以稍后将其反序列化）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T13:54:22.647

json_encode 和 json_decode 也将通过序列化完成您正在寻找的许多属性。优点是您可以将 JSON 编码的数据发送到 Web 浏览器，并且 JavaScript 可以像原生 JavaScript 对象一样查看和修改属性。此外，JSON 比序列化数据更轻，因为它的语法更紧凑。

# java - 如何将 HTML 表单中的多个“记录集”发布到 JSP 或 Java Servlet？

> ID：1016272
> 
> 赞同：2
> 
> 时间：2009-06-19T03:51:41.607
> 
> 标签：java, jsp, servlets, httprequest

JSP 或任何相关的*轻量级*技术（如 JSTL）是否执行 HTTP POST “数据分组”，或者像 PHP 那样支持表单元素“索引”？

例如，您可以使用以下输入创建 HTML 表单：

```
<input type="text" name="person[1][name]" />
<input type="text" name="person[1][age]" />
<input type="text" name="person[2][name]" />
<input type="text" name="person[2][age]" /> 
```

... PHP 会自动将其解析为嵌套关联数组。JSP、Java Servlets 或任何相关规范或工具是否提供这种开箱即用的翻译？

目标是在一个表单中提交多个“记录组”，并在 JSP 或 Servlet 中在服务器端处理它们。

* * *

要求：

*   该功能*不能*依赖于 JavaScript
*   没有像 Spring、Struts 等完整的框架
*   我试图避免用我自己的命名约定和手动字符串解析/正则表达式重新发明轮子

* * *

相关链接：

*   [这是如何在 PHP 中完成的](https://stackoverflow.com/questions/751381/posting-an-arbitrary-number-of-records-from-an-html-form)
*   [ONLamp 的另一个 PHP 示例](http://www.onlamp.com/pub/a/php/2003/03/13/php_foundations.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T03:56:50.423

试试这个，

```
<input type="text" name="personNames" />
<input type="text" name="personAges" />
<input type="text" name="personNames" />
<input type="text" name="personAges" /> 
```

您应该考虑使用循环创建输入字段，您不需要后缀**`name`**偶数。并在您的 servlet 中获取这样的参数值，

```
String[] names = request.getParameterValues("personNames");
String[] ages = request.getParameterValues("personAges"); 
```

它的顺序与您的 HTML 中定义的顺序相同。然后像下面这样循环它，

```
for( String name : names) {
   System.out.println(name);
} 
```

# matlab - 如何在 MATLAB 中从文本文件创建矩阵？

> ID：1016277
> 
> 赞同：11
> 
> 时间：2009-06-19T03:52:50.407
> 
> 标签：matlab, file-io, matrix

我有一个包含 4 列的文本文件，每列有 65536 个数据点。行中的每个元素都用逗号分隔。例如：

```
X,Y,Z,AU
4010.0,3210.0,-440.0,0.0
4010.0,3210.0,-420.0,0.0
etc. 
```

所以，我有**65536**行，每行有 4 个数据值，如上所示。我想将其转换为矩阵。我尝试将数据从文本文件导入 excel 文件，因为这样很容易创建矩阵，但我丢失了一半以上的数据。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-19T15:22:37.927

如果文件中的所有条目都是数字，则可以简单地使用`a = load('file.txt')`. 它应该创建一个 65536x4 矩阵`a`。它甚至比`csvread`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-03-23T13:09:30.557

你有没有试过使用'importdata'？您只需要文件名和分隔符的参数。

```
>> tmp_data = importdata('your_file.txt',',')

tmp_data = 

          data: [2x4 double]
      textdata: {'X'  'Y'  'Z'  'AU'}
    colheaders: {'X'  'Y'  'Z'  'AU'}

>> tmp_data.data

ans =

        4010        3210        -440           0
        4010        3210        -420           0

>> tmp_data.textdata

ans = 

    'X'    'Y'    'Z'    'AU' 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-19T04:47:28.097

您应该能够将文本文件直接读取到 MATLAB 中（使用函数[FOPEN](http://www.mathworks.com/help/techdoc/ref/fopen.html)、[FGETL](http://www.mathworks.com/help/techdoc/ref/fgetl.html)、[FSCANF](http://www.mathworks.com/help/techdoc/ref/fscanf.html)和[FCLOSE](http://www.mathworks.com/help/techdoc/ref/fclose.html)），而不是弄乱 Excel：

```
fid = fopen('file.dat','rt');  %# Open the data file
headerChars = fgetl(fid);      %# Read the first line of characters
data = fscanf(fid,'%f,%f,%f,%f',[4 inf]).';  %'# Read the data into a
                                              %# 65536-by-4 matrix
fclose(fid);  %# Close the data file 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-19T04:16:54.533

最简单的方法是使用 MATLAB 的[`csvread`](http://www.mathworks.com/help/techdoc/ref/csvread.html)函数。

还有[这个](http://www.mathworks.com/matlabcentral/fileexchange/6012)工具可以读取 CSV 文件。

你也可以自己做，没有太多困难：只需遍历文件中的每一行，用逗号分割，然后把它放在你的数组中。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-23T14:41:18.127

建议您熟悉[`dlmread`](http://www.mathworks.com/help/techdoc/ref/dlmread.html)和[`textscan`](http://www.mathworks.com/help/techdoc/ref/textscan.html)。

`dlmread`就像`csvread`但是因为它可以处理任何分隔符（制表符、空格等），我倾向于使用它而不是`csvread`.

`textscan`是真正的主力：很多选项，+它适用于打开的文件，并且在处理“坏”输入（例如文件中的非数字数据）方面更加稳健。它可以像`fscanf`gnovice 的建议一样使用，但我认为它更快（尽管不要引用我的话）。

# java - 这是用 Java 重写文件内容的最佳方法吗？

> ID：1016278
> 
> 赞同：46
> 
> 时间：2009-06-19T03:52:53.230
> 
> 标签：java, file-io, rewrite

我想重写文件的内容。

到目前为止我想到的是这样的：

1.  保存文件名
2.  删除现有文件
3.  新建一个同名的空文件
4.  将所需内容写入空文件

这是最好的方法吗？或者有没有更直接的方式，即不用删除和创建文件，只需更改内容？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-06-19T03:59:01.733

用 FileOutputStream 覆盖文件 foo.log：

```
File myFoo = new File("foo.log");
FileOutputStream fooStream = new FileOutputStream(myFoo, false); // true to append
                                                                 // false to overwrite.
byte[] myBytes = "New Contents\n".getBytes(); 
fooStream.write(myBytes);
fooStream.close(); 
```

或使用 FileWriter ：

```
File myFoo = new File("foo.log");
FileWriter fooWriter = new FileWriter(myFoo, false); // true to append
                                                     // false to overwrite.
fooWriter.write("New Contents\n");
fooWriter.close(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-19T04:34:38.610

我强烈建议为此使用 Apache Common 的 FileUtil。我发现这个包非常宝贵。它易于使用，同样重要的是，当您稍后返回时，它很容易阅读/理解。

```
//Create some files here
File sourceFile = new File("pathToYourFile");
File fileToCopy = new File("copyPath");

//Sample content
org.apache.commons.io.FileUtils.writeStringToFile(sourceFile, "Sample content");

//Now copy from source to copy, the delete source.
org.apache.commons.io.FileUtils.copyFile(sourceFile, fileToCopy);
org.apache.commons.io.FileUtils.deleteQuietly(sourceFile); 
```

更多信息请访问： [http ://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T04:00:01.953

请参阅：[java.io.RandomAccessFile](http://java.sun.com/j2se/1.5.0/docs/api/java/io/RandomAccessFile.html)

您需要以读写方式打开文件，因此：

```
RandomAccessFile raf = new RandomAccessFile("filename.txt", "rw");
String tmp;
while (tmp = raf.readLine() != null) {
    // Store String data
}
// do some string conversion
raf.seek(0);
raf.writeChars("newString"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T03:59:04.760

除非您只是在最后添加内容，否则这样做是合理的。如果要追加，请使用追加构造函数尝试[FileWriter 。](http://java.sun.com/javase/6/docs/api/java/io/FileWriter.html)

稍微好一点的顺序是：

1.  生成新文件名（例如 foo.txt.new）
2.  将更新的内容写入新文件。
3.  将 foo.txt.new 原子重命名为 foo.txt

不幸的是，renameTo[不能保证](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6463971)进行原子重命名。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T04:00:06.960

在下面的示例中，“false”会导致文件被覆盖，true 会导致相反的结果。

```
File file=new File("C:\Path\to\file.txt");
DataOutputStream outstream= new DataOutputStream(new FileOutputStream(file,false));
String body = "new content";
outstream.write(body.getBytes());
outstream.close(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-20T13:53:06.900

有时可能希望保留一个巨大的空文件，以避免操作系统根据需要分配空间的额外成本。这通常由数据库、虚拟机以及在处理和写入批量数据的批处理程序中完成。这将显着提高应用程序的性能。在这些情况下，编写一个新文件并重命名它并没有真正的帮助。相反，必须填充空文件。那是必须进入覆盖模式的时候。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-11-04T11:34:57.723

[`java.nio.file.Files`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/nio/file/Files.html)由于 Java 7 和新的文件 API，使用该类非常简单：

```
Files.write(Path.of("foo.log"), "content".getBytes(StandardCharsets.UTF_8)); 
```

Java 8 中用于编写 UTF-8 字符串列表的新功能：

```
Files.write(Path.of("foo.log"), List.of("content line 1", "content line 2")); 
```

Java 11 中用于编写 UTF-8 字符串的新功能：

```
Files.writeString(Path.of("foo.log"), "content"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-30T14:22:05.427

[Guava](https://github.com/google/guava) [Files.write](https://google.github.io/guava/releases/22.0/api/docs/com/google/common/io/Files.html#write-byte:A-java.io.File-) “用字节数组的内容覆盖文件”：

```
Files.write(bytes, new File(path)); 
```

# math - 矩阵变换；概念和理论，有没有免费的学习资源？

> ID：1016284
> 
> 赞同：27
> 
> 时间：2009-06-19T03:56:40.203
> 
> 标签：math, matrix, coordinates, hyperlink

最近，我一直在享受从坐标中渲染图表和图形的乐趣，而且我对使用矩阵来转换坐标空间非常着迷。

我已经能够成功地缩放和反转二维坐标空间，但现在我的胃口被激起了。:)

我在哪里可以找到关于矩阵、矩阵数学（尤其是适用于 2 维和 3 维空间）的清晰、信息丰富、（免费）的教育材料？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-06-20T22:52:25.540

**原始答案：**我不确定您是否会喜欢数学课程通常如何介绍矩阵。作为一名程序员，你可能会更高兴抓住任何一本像样的 3D 图形书。它当然应该有非常具体的 3x3 矩阵。另外，找出可以教你[投影变换](http://en.wikipedia.org/wiki/Projective_transformations)的那些（投影几何是一个非常漂亮的低维几何领域并且易于编程）。

# 使用 Python 3 的矩阵数学迷你课程

**内容：**

1.  **矩阵** `[Vector, __add__, reflect_y, rotate, dilate, transform]`
2.  **矩阵：重载** `[Matrix, __add__, __str__, __mul__, zero, det, inv, __pow__]`
3.  **奖励：复数**
4.  **矩阵：（R）进化**。它已经在制作中（最后有一个摘要）

**前言：**根据我的教学经验，我认为别人参考的课程都是非常好的*课程*。这意味着，如果您的目标是像数学家那样理解矩阵，那么您一定要掌握整个课程。但是，如果您的目标更谦虚，这是我尝试更适合您的需求的东西（但仍以传达许多理论概念为目标，这与我最初的建议相矛盾。）

**如何使用：**

*   这篇文章很长。您可能会考虑打印这个并慢慢来，比如一天一份。
*   代码是必不可少的。这是一门面向程序员的课程。锻炼也是必不可少的。
*   您应该**[查看](http://mit.edu/%7Eunknot/www/matrices.py)**包含所有这些代码以及更多内容的代码伴侣
*   它是“2 for 1”的特别之处：你也可以在这里学习 Python 3。和复数。
*   我会非常重视阅读这篇文章的任何尝试（我是否正式有资格获得有史以来最长的帖子？），所以如果您不理解某些内容（以及如果您理解），请随时发表评论。

1.  矩阵 =

## 矢量图

在矩阵之前是向量。您肯定知道如何处理 2 维和 3 维向量：

```
class Vector:
    """This will be a simple 2-dimensional vector.

    In case you never encountered Python before, this string is a
    comment I can put on the definition of the class or any function.
    It's just one of many cool features of Python, so learn it here!

    """

    def __init__(self, x, y): 
        self.x = x
        self.y = y 
```

现在你可以写了

```
v = Vector(5, 3)
w = Vector(7, -1) 
```

但它本身并没有多大乐趣。让我们添加更多有用的方法：

```
 def __str__(self: 'vector') -> 'readable form of vector':
        return '({0}, {1})'.format(self.x, self.y)

    def __add__(self:'vector', v: 'another vector') -> 'their sum':
        return Vector(self.x + v.x, self.y + v.y)

    def __mul__(self:'vector', number: 'a real number') -> 'vector':
        '''Multiplies the vector by a number'''
        return Vector(self.x * number, self.y * number) 
```

这让事情变得更有趣，因为我们现在可以写：

```
print(v + w * 2) 
```

并将答案`(19, 1)`很好地打印为向量（如果示例看起来不熟悉，请考虑此代码在 C++ 中的外观）。

## 转型

现在能够编写一切都很酷，`1274 * w`但是您需要对图形进行更多的矢量操作。以下是其中的一些：您可以围绕点翻转矢量，可以围绕或轴`(0,0)`反射它，可以顺时针或逆时针旋转它（在这里画图是个好主意）。`x``y`

我们来做一些简单的操作：

```
 ...

    def flip(self:'vector') -> 'vector flipped around 0':
        return Vector(-self.x, -self.y)

    def reflect_x(self:'vector') -> 'vector reflected around x axis':
        return Vector(self.x, -self.y)

print(v.flip(), v.reflect_x()) 
```

*   **问题：**是否可以`flip(...)`使用我下面的操作来表达？怎么样`reflect_x`？

现在你可能想知道为什么我省略了`reflect_y`. 嗯，这是因为我想让你停下来写下你自己的版本。好的，这是我的：

```
 def reflect_y(self:'vector') -> 'vector reflected around y axis':
        return self.flip().reflect_x() 
```

看，如果你看看这个函数是如何计算的，它实际上是非常微不足道的。但是突然发生了一件令人惊奇的事情：我能够仅使用现有的转换`flip`和`reflect_x`. 无论如何，我关心的是，`reflect_y`可以在没有访问权限的派生类中定义`x`并且`y`它仍然可以工作！

数学家将这些函数称为*运算符*。他们会说这`reflect_y`是一个由运算符*组合*得到的运算符`flip`，`reflect_x`用`reflect_y = flip ○ reflect_x`（你应该看到小圆圈，一个 Unicode 符号`25CB`）表示。

*   **注意：**从现在开始，我将完全自由地使用该`=`符号来表示两个操作产生相同的结果，就像上面的段落一样。这是一个“数学`=`”，[不能用程序来表达](http://en.wikipedia.org/wiki/List_of_undecidable_problems)。

所以如果我这样做

```
print(v.reflect_y()) 
```

我得到了结果`(-5, 3)`。去画吧！

*   **问题：**考虑一个作文`reflect_y ◦ reflect_y`。你会怎么命名它？

## 旋转

这些操作很好也很有用，但你可能想知道为什么引入旋转这么慢。好的，我开始：

```
 def rotate(self:'vector', angle:'rotation angle') -> 'vector':
        ?????? 
```

此时，如果您知道如何旋转矢量，您应该继续填写问号。否则，请耐心等待一个更简单的情况：逆时针旋转`90`度数。这个在一张纸上并不难画：

```
 def rotate_90(self:'vector') -> 'rotated vector':
        new_x = - self.y
        new_y =   self.x
        return Vector(new_x, new_y) 
```

试

```
x_axis = Vector(1, 0)
y_axis = Vector(0, 1)

print(x_axis.rotate_90(), y_axis.rotate_90()) 
```

现在给`(0, 1) (-1, 0)`. 自己运行吧！

*   **问：**证明`flip = rotate_90 ◦ rotate_90`.

无论如何，我不会再隐藏秘密成分了：

```
import math   # we'll need math from now on
  ...

class Vector:

      ...

    def rotate(self:'vector', angle:'rotation angle') -> 'rotated vector':
        cos = math.cos(angle)
        sin = math.sin(angle)
        new_x = cos * self.x - sin * self.y
        new_y = sin * self.x + cos * self.y
        return Vector(new_x, new_y) 
```

现在让我们尝试一些类似的东西：

```
print(x_axis.rotate(90), y_axis.rotate(90)) 
```

如果你期待和以前一样的结果`(0, 1) (-1, 0)`，你一定会失望的。该代码打印：

```
(-0.448073616129, 0.893996663601) (-0.893996663601, -0.448073616129) 
```

男孩，它丑吗！

*   **符号：**我会说我们在上面的例子中应用`rotate(90)`了操作`x`。我们获得的知识是`rotate(90) != rotate_90`。

*   **问题：**这里发生了什么？`rotate_90`用什么来表达`rotate`？`flip`用什么来表达`rotate`？

## 扩张

这些旋转当然很有用，但它们并不是您需要做的所有事情，即使是 2D 图形也是如此。考虑以下转换：

```
 def dilate(self:'vector', axe_x:'x dilation', axe_y:'y dilation'):
        '''Dilates a vector along the x and y axes'''
        new_x = axe_x * self.x
        new_y = axe_y * self.y
        return Vector(new_x, new_y) 
```

这`dilate`件事以一种可能不同的方式扩张`x`和`y`轴。

*   **练习：**`dilate(?, ?) = flip`在,中填上问号`dilate(?, ?) = reflect_x`。

我将使用这个`dilate`函数来演示数学家称之为*交换*性的东西：也就是说，对于参数的每个值`a`, `b`, `c`,`d`你可以确定

```
dilate(a, b) ◦ dilate(c, d) = dilate(c, d) ◦ dilate(a, b) 
```

*   **练习：**证明它。此外，对于所有可能的参数值，以下参数是否成立？

    *   ```
         `rotate(a) ◦ rotate(b) = rotate(b) ◦ rotate(a)` 
        ```

    *   ```
         `dilate(a, b) ◦ rotate(c) = rotate(c) ◦ dilate(a, b)` 
        ```

    *   ```
         `rotate(a) ◦ __mul__(b) = __mul__(b) ◦ rotate(a)` 
        ```

## 矩阵

让我们总结一下我们在这里拥有的所有东西，我们*在向量上的运算符`x`*

*   `flip`, `reflect_x`, `*`, `rotate(angle)`,`dilate(x, y)`

从中可以做出一些非常疯狂的东西，例如

*   `flip ◦ rotate(angle) ◦ dilate(x, y) ◦ rotate(angle_2) ◦ reflect_y + reflect_x = ???`

当您创建越来越复杂的表达式时，人们会希望某种顺序可以突然将所有可能的表达式简化为有用的形式。不要害怕！神奇的是，上面表格的每个表达式都可以简化为

```
 def ???(self:'vector', parameters):
        '''A magical representation of a crazy function'''
        new_x = ? * self.x + ? * self.y
        new_y = ? * self.x + ? * self.y
        return Vector(new_x, new_y) 
```

用一些数字和/或参数代替`?`s。

*   **示例：**找出“？”的值是什么？是给`__mul__(2) ◦ rotate(pi/4)`
*   **另一个例子：**同样的问题 `dilate(x, y) ◦ rotate(pi/4)`

这允许我们编写一个通用函数

```
 def transform(self:'vector', m:'matrix') -> 'new vector':
        new_x = m[0] * self.x + m[1] * self.y
        new_y = m[2] * self.x + m[3] * self.y
        return Vector(new_x, new_y) 
```

这将采用任何 4 元组的数字，称为**matrix**，并将*其*应用于 vector `x`。这是一个例子：

```
rotation_90_matrix = (0, -1, 1, 0)
print(v, v.rotate_90(), v.transform(rotation_90_matrix)) 
```

打印`(5, 3) (-3, 5) (-3, 5)`。请注意，如果您将`transform`任何矩阵应用于原点，您仍然会得到原点：

```
origin = Vector(0, 0)
print(origin.transform(rotation_90_matrix)) 
```

*   **练习：**`m`描述`flip`, `dilate(x, y)`,的元组是什么`rotate(angle)`？

当我们与`Vector`课程分开时，这里有一个练习，适合那些想要测试他们的向量数学知识和 Pythonic 技能的人：

*   **最后的战斗：**将您可以提出的所有向量操作添加到`Vector`类中（您可以为向量重载多少标准操作符？查看我的答案）。

2.  矩阵：重载 =

正如我们在上一节中所发现的，矩阵可以被认为是一种速记，它允许我们以简单的方式对向量运算进行编码。例如，`rotation_90_matrix`将旋转编码 90 度。

## 矩阵对象

现在，当我们将注意力从向量转移到矩阵时，我们当然也应该有一个矩阵类。此外，在上面的那个函数`Vector.transform(...)`中，矩阵的作用在某种程度上被歪曲了。在向量变化时固定更常见`m`，所以从现在开始我们的转换将是矩阵类的方法：

```
class Matrix:

    def __init__(self:'new matrix', m:'matrix data'):
        '''Create a new matrix.

        So far a matrix for us is just a 4-tuple, but the action
        will get hotter once The (R)evolution happens!

        '''
        self.m = m

    def __call__(self:'matrix', v:'vector'):
        new_x = self.m[0] * v.x + self.m[1] * v.y
        new_y = self.m[2] * v.x + self.m[3] * v.y
        return Vector(new_x, new_y) 
```

如果您不了解 Python，请`__call__`重载`(...)`for 矩阵的含义，以便我可以使用标准表示法来表示*作用*于向量的矩阵。此外，矩阵通常使用单个大写字母编写：

```
J = Matrix(rotation_90_matrix)
print(w, 'rotated is', J(w)) 
```

*   **练习：**用上一个练习中的矩阵重复这个例子。

## 添加

现在，让我们看看我们还能用矩阵做什么。请记住，矩阵`m`实际上只是对向量进行编码的一种方式。请注意，对于两个函数`m1(x)`，`m2(x)`我可以创建一个新函数（使用[lambda notation](http://en.wikipedia.org/wiki/Lambda_calculus)）`m = lambda x: m1(x) + m2(x)`。事实证明，如果`m1`和`m2`由矩阵编码，*您也可以`m`使用矩阵*对其进行编码！

*   **练习：**想一想你对这个陈述可能遇到的任何困难。

你只需要添加它的数据，比如`(0, 1, -1, 0) + (0, 1, -1, 0) = (0, 2, -2, 0)`. 以下是在 Python 中添加两个元组的方法，其中包含一些非常有用且高度 Pythonic 的技术：

```
 def __add__(self:'matrix', snd:'another matrix'):
        """This will add two matrix arguments.

        snd is a standard notation for the second argument.
        (i for i in array) is Python's powerful list comprehension.
        zip(a, b) is used to iterate over two sequences together

        """

        new_m = tuple(i + j for i, j in zip(self.m, snd.m))
        return Matrix(new_m) 
```

现在我们可以编写类似`J + J`or even`J + J + J`的表达式，但要查看结果，我们必须弄清楚如何打印一个 Matrix。一种可能的方法是打印一个 4 元组的数字，但是让我们从`Matrix.__call__`函数中得到一个提示，即数字应该被组织成一个`2x2`块：

```
 def as_block(self:'matrix') -> '2-line string':
        """Prints the matrix as a 2x2 block.

        This function is a simple one without any advanced formatting.
        Writing a better one is an exercise.

        """

        return ('| {0} {1} |\n' .format(self.m[0], self.m[1]) +
                '| {0} {1} |\n' .format(self.m[2], self.m[3]) ) 
```

如果您查看此功能的实际运行情况，您会发现还有一些改进空间：

```
print((J + J + J).as_block()) 
```

*   **练习：**编写一个更好的函数`Matrix.__str__`，将数字四舍五入并将它们打印在固定长度的字段中。

现在您应该能够编写旋转矩阵：

```
def R(a: 'angle') -> 'matrix of rotation by a':
    cos = math.cos(a)
    sin = math.sin(a)
    m = ( ????? )
    return Matrix(m) 
```

*   **练习：**检查代码`Vector.rotate(self, angle)`并填写问号。测试

    ```
     from math import pi        
      print(R(pi/4) + R(-pi/4)) 
    ```

## 乘法

我们可以用单参数函数做的最重要的事情是组合它们：`f = lambda v: f1(f2(v))`. 如何用矩阵反映它？这需要我们检查它是如何`Matrix(m1) ( Matrix(m2) (v))`工作的。如果你展开它，你会注意到

```
m(v).x = m1[0] * (m2[0]*v.x + m2[1]*v.y) + m1[1] * (m2[2]*v.x + m2[3]*v.y) 
```

同样对于`m(v).y`, 如果你打开括号，它看起来与`Matrix.__call__`使用一个新的 tuple 非常相似`m`，例如`m[0] = m1[0] * m2[0] + m1[2] * m2[2]`. 因此，让我们以此作为新定义的提示：

```
 def compose(self:'matrix', snd:'another matrix'):
        """Returns a matrix that corresponds to composition of operators"""

        new_m = (self.m[0] * snd.m[0] + self.m[1] * snd.m[2],
                 self.m[0] * snd.m[1] + self.m[1] * snd.m[3],
                 ???,
                 ???) 
        return Matrix(new_m) 
```

*   **练习：**在这里填写问号。测试它

    ```
     print(R(1).compose(R(2)))
      print(R(3)) 
    ```

*   **数学练习：**证明`R(a).compose(R(b))`总是与 相同`R(a + b)`。

现在让我说实话：这个`compose`函数实际上是数学家决定矩阵*相乘的方式。*这作为一个符号是有意义的：`A * B`是一个描述 operator 的矩阵，`A ○ B`正如我们接下来将看到的，还有更深层次的理由将其称为“乘法”。

要开始在 Python 中使用乘法，我们所要做的就是在一个`Matrix` 类中对其进行排序：

```
 class Matrix:

          ...

        __mul__ = compose 
```

*   **练习：**计算`(R(pi/2) + R(pi)) * (R(-pi/2) + R(pi))`。试着自己先在一张纸上找到答案。

## 规则`+`和`*`

让我们为与`dilate(a, b)`运算符对应的矩阵起一个好名字。现在 没有什么问题`D(a, b)`，但我将借此机会介绍一个标准符号：

```
def diag(a: 'number', b: 'number') -> 'diagonal 2x2 matrix':
    m = (a, 0, 0, b)
    return Matrix(m) 
```

试着`print(diag(2, 12345))`看看为什么它被称为*对角*矩阵。

由于之前发现操作的组合并不总是可交换的，`*`因此运算符对于矩阵也不总是可交换的。

*   **练习：**如有必要，返回并刷新*交换性事物。*然后给出矩阵`A`, `B`, 由`R`和组成的例子`diag`，这样`A * B`不等于`B * A`。

这有点奇怪，因为数字的乘法总是可交换的，并且提出了是否`compose`真的值得被称为的问题`__mul__`。*这里*`+`有很多满足的规则：`*`

 *1.  `A + B = B + A`
2.  `A * (B + C) = A * B + A * C`
3.  `(A + B) * C = A * C + B * C`
4.  `(A * B) * C = A * (B * C)`
5.  有一个操作叫做`A - B`and`(A - B) + B = A`

*   **练习：**证明这些陈述。如何`A - B`定义`+`,`*`和`diag`? `A - A`等于什么？将方法添加`__sub__`到类`Matrix`。如果你计算会发生什么`R(2) - R(1)*R(1)`？它应该等于什么？

`(A * B) * C = A * (B * C)`等式称为*关联*性，特别好，因为这意味着我们不必担心将括号放在以下形式的表达式中`A * B * C`：

```
print(R(1) * (diag(2,3) * R(2)))
print((R(1) * diag(2,3)) * R(2)) 
```

让我们找到常规数字`0`和`1`减法的类似物：

```
zero = diag(0, 0)
one = diag(1, 1) 
```

通过以下易于验证的添加：

1.  `A + zero = A`
2.  `A * zero = zero`
3.  `A * one = one * A = A`

规则变得完整，因为它们有一个简称：*环公理*。因此，数学家会说矩阵形成一个*环*，他们确实总是使用符号`+`和`*`在谈论环时，我们也应该如此。

使用规则可以轻松计算上一节中的表达式：

```
(R(pi/2) + R(pi)) * (R(-pi/2) + R(pi)) = R(pi/2) * R(-pi/2) +  ... = one + ... 
```

*   **练习：**完成这个。证明`(R(a) + R(b)) * (R(a) - R(b)) = R(2a) - R(2b)`。

## 仿射变换

是时候回到我们如何定义矩阵了：它们是一些你可以用向量做的操作的捷径，所以它是你可以实际绘制的东西。您可能想拿起笔或查看其他人建议的材料，以查看不同平面变换的示例。

在这些变换中，我们将寻找*仿射*变换，那些在任何地方看起来都“相同”（没有弯曲）的变换。例如，围绕某个点的旋转是`(x, y)`合格的。现在这个不能表示为`lambda v: A(v)`，但可以写成`lambda v: A(v) + b`一些矩阵`A`和向量的形式`b`。

*   **练习：**找到`A`和`b`使得`pi/2`围绕该点的旋转`(1, 0)`具有上述形式。它们是独一无二的吗？

请注意，对于每个向量都有一个仿射变换，它是向量的*移位*。

仿射变换可能会拉伸或扩张形状，但它应该在任何地方都以相同的方式进行。现在我希望你相信任何图形的面积在变换下都会变化一个常数。对于由矩阵给出的变换，`A`该系数称为 的*行列式*，`A`可以将面积公式应用于两个向量`A(x_axis)`和来计算`A(y_axis)`：

```
 def det(self: 'matrix') -> 'determinant of a matrix':
        return self.m[0]*self.m[3] - self.m[1] * self.m[2] 
```

作为健全性检查，`diag(a, b).det()`等于`a * b`。

*   **练习：**检查这个。当参数之一为 0 时会发生什么？什么时候是负数？

如您所见，旋转矩阵的行列式始终相同：

```
from random import random
r = R(random())
print (r, 'det =', r.det()) 
```

一件有趣的事情`det`是它是乘法的（如果你冥想的时间足够长，它就会从定义中得出）：

```
A = Matrix((1, 2, -3, 0))
B = Matrix((4, 1, 1, 2))
print(A.det(), '*', B.det(), 'should be', (A * B).det()) 
```

## 逆

你可以用矩阵做的一件有用的事情是编写一个由两个线性方程组成的系统

```
A.m[0]*v.x + A.m[1]*v.y = b.x
A.m[2]*v.x + A.m[3]*v.y = b.y 
```

以更简单的方式：`A(v) = b`. 让我们在（一些）高中教书时求解系统：将第一个方程乘以`A.m[3]`，第二个乘以 -Am [1](http://en.wikipedia.org/wiki/Projective_transformations)，然后加上（如果有疑问，请在纸上做）以求解`v.x`。

如果你真的尝试过，你应该得到`A.det() * v.x = (A.m[3]) * b.x + (-A.m[1]) * b.y`，这表明你总是可以`v`通过乘以`b`其他矩阵来得到。该矩阵称为的*逆*`A`矩阵：

```
 def inv(self: 'matrix') -> 'inverse matrix':
        '''This function returns an inverse matrix when it exists,
        or raises ZeroDivisionError when it doesn't. 

        '''
        new_m = ( self.m[3] / self.det(), -self.m[1] / self.det(),
                  ????? )
        return Matrix(new_m) 
```

如您所见，当矩阵的行列式为零时，此方法会失败。如果您真的想要，您可以通过以下方式捕获此异常：

```
try:
    print(zero.inv())
except ZeroDivisionError as e: ... 
```

*   **练习：**完成方法。证明当 时逆矩阵不存在`self.det() == 0`。编写划分矩阵的方法并测试它。使用逆矩阵求解方程`A(v) = x_axis`（`A`如上定义）。

## 权力

逆矩阵的主要性质是`A * A.inv()`总是等于`one`

*   **练习：**自己检查。从逆矩阵的定义中解释为什么会这样。

这就是数学家用 -1 表示`A.inv()`的`A`^(原因)。我们如何编写一个很好的函数来使用^n`A ** n`的表示法？请注意，天真的周期是 O(|n|)，这肯定太慢了，因为这可以通过复杂度来完成：`A`^(`for i in range(n): answer *= self``log |n|`)

```
 def __pow__(self: 'matrix', n:'integer') -> 'n-th power':
        '''This function returns n-th power of the matrix.

        It does it more efficiently than a simple cycle. A
        while loop goes over all bits of n, multiplying answer
        by self ** (2 ** k) whenever it encounters a set bit.

        ... 
```

*   **练习：**在此函数中填写详细信息。测试它

    `X, Y = A ** 5, A ** -5` `print (X, Y, X * Y, sep = '\n')`

此函数仅适用于 的整数值`n`，即使对于某些矩阵，我们也可以定义分数幂，例如平方根（换句话说，`B`这样的矩阵`B * B = A`）。

*   **练习：**求 的平方根`diag(-1, -1)`。这是唯一可能的答案吗？找一个*没有*平方根的矩阵的例子。

# 奖励：复数

在这里，我将在一个部分中向您介绍该主题！由于是复杂的题目，我很可能会失败，所以请提前原谅我。

首先，类似于我们如何拥有矩阵`zero`和`one`，我们可以通过执行 由任何实数组成一个矩阵`diag(number, number)`。这种形式的矩阵可以加、减、乘、反转，结果将模拟数字本身发生的情况。因此，出于所有实际目的，可以说，例如，`diag(5, 5)` *是*5。

但是，Python 还不知道如何处理形式的表达式`A + 1`或`5 * B`where`A`和`B`are 矩阵。如果你有兴趣，你应该去做下面的练习或者看看我的实现（它使用了一个很酷的 Python 特性，叫做*decorator*）；否则，只知道它已被实施。

*   **大师练习：**更改`Matrix`类中的运算符，以便在其中一个操作数是矩阵而另一个操作数是数字的所有标准操作中，数字会自动转换为`diag`矩阵。另外，添加相等性比较。

这是一个示例测试：

```
print( 3 * A - B / 2 + 5 ) 
```

现在这是第一个有趣的**复数**：矩阵`J`，在开头介绍并等于`Matrix((0, 1, -1, 0))`，有一个有趣的属性`J * J == -1`（试试看！）。这意味着`J`当然不是一个正常的数字，但是，正如我刚才所说，矩阵和数字很容易混合在一起。例如，

```
(1 + J) * (2 + J) == 2 + 2 * J + 1 * J + J * J = 1 + 3 * J 
```

使用之前列出的规则。如果我们在 Python 中测试它会发生什么？

```
(1 + J) * (2 + J) == 1 + 3*J 
```

那应该高兴地说`True`。另一个例子：

```
(3 + 4*J) / (1 - 2*J) == -1 + 2*J 
```

正如您可能已经猜到的那样，数学家不会称这些“疯狂数字”，但他们会做类似的事情——他们称形式为`a + b*J` *复数*的表达式。因为这些仍然是我们`Matrix`类的实例，所以我们可以用它们做很多操作：加法、减法、乘法、除法、幂——它们都已经实现了！矩阵不是很神奇吗？

我忽略了如何打印操作结果的问题 `E = (1 + 2*J) * (1 + 3*J)`，使其看起来像一个表达式`J`而不是`2x2`矩阵。如果您仔细检查它，您会发现您需要以格式打印该矩阵的左列`... + ...J`（还有一件好事：它正是`E(x_axis)`！）那些知道两者之间的区别`str()`并且`repr()`应该看到命名一个函数是很自然的这将产生这种形式的表达，如`repr()`。

*   **练习：**编写一个`Matrix.__repr__`完全可以做到这一点的函数，并用它进行一些测试，例如`(1 + J) ** 3`，首先在纸上计算结果，然后用 Python 进行尝试。

*   **数学问题：**的行列式是`a + b*J`什么？如果您知道复数的*绝对值是什么：它们是如何连接的？*的绝对值是`a`多少？的`a*J`？

3.  矩阵：（R）进化=

在这三部曲的最后一部分，我们将看到一切都是矩阵。我们将从一般`M x N`矩阵开始，并找出如何将向量视为`1 x N`矩阵以及为什么数字与对角矩阵相同。作为旁注，我们将把复数作为`2 x 2`矩阵进行探索。

最后，我们将学习使用矩阵编写仿射和投影变换。

所以计划的课程是`[MNMatrix, NVector, Affine, Projective]`。

我想如果你能忍受我直到这里，你可能会对这部续集感兴趣，所以我想听听我是否应该继续这个（以及在哪里，因为我很确定我已经超越了什么被认为是单个文档的合理长度）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T04:04:35.153

[麻省理工学院在http://ocw.mit.edu/OcwWeb/Mathematics/](http://ocw.mit.edu/OcwWeb/Mathematics/)上有很多他们的数学课程资料。一旦你掌握了基础知识，他们也会在线提供物理笔记。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-19T04:48:26.820

这是[http://en.wikipedia.org/wiki/Computer_graphics](http://en.wikipedia.org/wiki/Computer_graphics)。其中两个关键概念是[http://mathworld.wolfram.com/LinearTransformation.html](http://mathworld.wolfram.com/LinearTransformation.html)和[http://mathworld.wolfram.com/AffineTransformation.html](http://mathworld.wolfram.com/AffineTransformation.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-24T06:51:33.090

这份 MIT 文档是深入了解转换基础知识的必备工具。

[http://stellar.mit.edu/S/course/6/fa08/6.837/courseMaterial/topics/topic2/lectureNotes/03_transform/03_transform.pdf](http://stellar.mit.edu/S/course/6/fa08/6.837/courseMaterial/topics/topic2/lectureNotes/03_transform/03_transform.pdf)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-26T22:57:27.597

最适合初学者的书籍之一是 Carl Meyer 的“矩阵分析和应用线性代数”。

你可以在这里在线查看整本书（虽然它有版权水印）： http: [//www.matrixanalysis.com/DownloadChapters.html](http://www.matrixanalysis.com/DownloadChapters.html)

您可能想看看第 5 章 pg。326 - 332 涵盖 3 维计算机图形中的旋转

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-26T01:00:37.267

您可能想看看I-Hsiung Lin, Yixiong Lin 的*Geometric linear algebra* (ISBN : 9812560874)。这本书专门针对您想要的东西（2 维和 3 维向量空间的线性变换），并用几何方法全面、渐进地处理它（每个维度 300 页）。恐怕它不是免费购买的，但你应该可以在任何好的大学图书馆找到它。否则[，Bookfinder](http://bookfinder.com)应该可以帮助您以相对适中的价格获得它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-26T20:27:21.207

Jim Hefferon 的免费[线性代数](http://joshua.smcvt.edu/linearalgebra/)教科书非常好。与太多的免费电子书不同，Jim 显然花时间制作了一本优秀的阅读器并介绍了线性代数。正式的数学写作并没有过多的负担，因为定理和证明往往过于密集而难以理解。它还包含许多非常出色的线性代数在现实世界应用中的示例——坐标变换只是其中一个示例。您无法超越价格，它还附带练习的可选解决方案。

PS如果坐标变换是你的事，在你完成线性代数之后，你可能会对微分几何感兴趣。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-26T21:21:56.977

这些是我找到的信息。其中一些可能对您有价值：

理论：

*   [Woflrams 有关矩阵](http://mathworld.wolfram.com/Matrix.html)的信息和[维基百科上的其他信息](http://en.wikipedia.org/wiki/Matrix_%28mathematics%29)
*   [Pam Norton 的矩阵](http://books.google.pl/books?id=aCVOxM0rT3EC&pg=PA1&lpg=PA1&dq=matrices&source=bl&ots=4KdmhNGwv5&sig=AEh45A_JYzFG5eQPHhDAEPPOHhA&hl=pl&ei=KjFFStvYAdC2sgaG66Um&sa=X&oi=book_result&ct=result&resnum=19)- 非常好的书，可在 Google 图书免费获得。
*   [正交投影和透视投影](http://www.codeguru.com/cpp/misc/misc/math/article.php/c10123/)
*   [MSDN 上的 3D 转换](http://msdn.microsoft.com/en-us/library/bb172489%28VS.85%29.aspx)

（在 Google 书籍中搜索[“矩阵”](http://books.google.pl/books?ei=KjFFStvYAdC2sgaG66Um&ct=result&q=matrices&btnG=Wyszukaj+ksi%C4%85%C5%BCki)会为您提供很多讲座，其中一些与转换直接相关 -[这](http://books.google.pl/books?id=fqUTMxPsjt0C&printsec=frontcover&dq=matrices)是第一个结果，但我鼓励您检查更多。）

*   像[这样的](http://home10.inet.tele.dk/moelhave/tutors/3d/transformations/transformations.html)文章，或者也许[这样](http://wally.cs.iupui.edu/n351/3D/matrix.html)或[这样](http://www.ruthless.zathras.de/facts/apps/polygonesia/3d-transformation-matrix.php)的文章在谷歌的帮助下很容易找到，所以我不会发布更多。
*   StackOverflow.com 上关于矩阵的问题也很少：[使用 3d 变换矩阵](https://stackoverflow.com/questions/584481/using-3d-transformation-matrices)和[如何应用变换矩阵？](https://stackoverflow.com/questions/850179/how-to-apply-a-transformation-matrix)只是最初的几个例子，你可以找到更多寻找[矩阵](https://stackoverflow.com/questions/tagged/matrix)或[数学](https://stackoverflow.com/questions/tagged/math)标签。

我也鼓励（我不知道这是不是正确的词，我只是在学习英语）你，在其中一本书中寻找这种信息（虽然它们不是免费的，但你可以找到大部分谷歌图书上的旧书）：

1.  [游戏编程宝石 7](https://rads.stackoverflow.com/amzn/click/com/1584505273)
2.  [游戏编程宝石 6](https://rads.stackoverflow.com/amzn/click/com/1584504501)
3.  [游戏编程宝石 5](https://rads.stackoverflow.com/amzn/click/com/1584503521)
4.  [游戏编程宝石 4](https://rads.stackoverflow.com/amzn/click/com/1584502959)
5.  [游戏编程宝石 3](https://rads.stackoverflow.com/amzn/click/com/1584502339)
6.  [游戏编程宝石2](https://rads.stackoverflow.com/amzn/click/com/1584500549)
7.  [游戏编程宝石](https://rads.stackoverflow.com/amzn/click/com/1584500492)

每一个都有关于数学宝石的部分——那里有很多巧妙的技巧。这些书值得每一分钱。

还有 GPU Programming gems，所以你也可以试试。

实践：

*   [Wikipedia 上的OpenGl Book有关于 OpenGl 中的矩阵的部分（此外，在](http://en.wikibooks.org/wiki/Category:OpenGL_Programming)[此处](http://www.songho.ca/opengl/gl_transform.html)和[此处](http://www.morrowland.com/apron/tutorials/gl/gl_matrix.php)描述了在 OpenGl 中使用矩阵）
*   [在 DirectX 中绘制 3D 房间](http://gregs-blog.com/2008/06/15/directx-9-c-graphics-tutorial-part-3-drawing-a-simple-3d-room/)+ 有关矩阵变换的信息。

如果我能找到更多，我会在这里编辑和添加链接，但老实说 - 我在使用谷歌大约 10 分钟内找到了这些链接。世界上最流行的浏览器存储关于一切的数据——是的，“一切”也意味着矩阵。

队友的欢呼声。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-26T22:59:07.077

我认为您应该花几天时间在 3D 中使用向量进行点积和叉积。然后学习三角和向量之间的关系。在那之后，矩阵对你来说会更有意义。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-28T17:30:25.997

Gilbert Strang 的 MIT-OCW 线性代数课程。一个不可思议的人的不可思议的讲座；如果您对矩阵的理解完全来自编程资源（如 MATLAB），那么线性代数课程肯定会为您提供用矩阵做疯狂事情的​​基础知识。

[http://www.ocw.cn/OcwWeb/Mathematics/18-06Spring-2005/VideoLectures/index.htm](http://www.ocw.cn/OcwWeb/Mathematics/18-06Spring-2005/VideoLectures/index.htm)*

# java - 在 GWT 中导入 Gears API 时找不到 org.apache.xerces.jaxp.SAXParserFactoryImpl

> ID：1016286
> 
> 赞同：8
> 
> 时间：2009-06-19T03:56:51.547
> 
> 标签：java, gwt, xerces

我使用 Eclipse 创建了一个[GWT](http://code.google.com/appengine/docs/)项目，该项目运行良好（我能够在托管模式和 Google App Engine 上运行它），直到我尝试[为 Google Web Toolkit 导入 Gears API](http://code.google.com/docreader/#p=gwt-google-apis&s=gwt-google-apis&t=GearsGettingStarted)。将以下行添加到我的 java 源文件后：

```
import com.google.gwt.gears.client.geolocation.Geolocation; 
```

尝试编译时出现以下错误：

```
19-Jun-2009 3:36:09 AM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: failed com.google.apphosting.utils.jetty.DevAppEngineWebAppContext@1c7d682{/,C:\Documents and Settings\Geoff Denning\workspace\TaskPath\war}
javax.xml.parsers.FactoryConfigurationError: Provider org.apache.xerces.jaxp.SAXParserFactoryImpl not found 
```

我已经将 gwt-gears.jar 文件添加到了我的 \war\WEB-INF\lib 目录中，并且我在 Eclipse 中引用了它，如下所示：

[![Eclipse 中的 Java 构建路径](../Images/03873887037d39386463b8f73532eec3.png)](https://i.stack.imgur.com/CkEA7.png)

我什至打开了 gwt-gears.jar 文件并确认 org/apache/xerces/jaxp/SAXParserFactoryImpl.class 确实存在。谁能给我任何关于我为什么会收到上述错误的指示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T04:36:45.083

检查 Xerces 是否存在于：

```
$JAVA_HOME/lib/endorsed 
```

听起来像是 Java 5 的问题。还要检查 Java 系统属性：

```
javax.xml.parsers.SAXParserFactory 
```

它应该是：

```
org.apache.xerces.jaxp.SAXParserFactoryImpl 
```

如果不是，那是您的问题，请确保您设置了系统属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T02:24:45.883

显然这是 jre 1.5 中的一个错误。我可以通过将 Eclipse 中的默认 JRE 从 1.5.0_06 切换到 1.6.0_03 来解决问题，如下所示：

[![Eclipse 安装的 JRE](../Images/ed01445cca0fcf1b1750bbd378662e8f.png)](https://i.stack.imgur.com/8YdWE.png)

感谢[Jon](https://stackoverflow.com/users/82865/jon)和[Rahul](https://stackoverflow.com/users/24424/rahul)为我指明了正确的方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-23T00:13:43.957

这发生在我身上。我的工作区中有冲突的 JAR。我删除了一个并繁荣它工作。该消息没有很好地说明错误的根源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-12T04:52:32.337

我的**SAXParserFactoryImpl 问题**是由我的引导类路径中的 gwt-gadgets.jar 引起的。从引导类路径中删除这个 JAR 为我解决了这个问题。基本上，您必须**从构建路径（用户库）中删除任何包含 SAXParserFactoryImpl 类的 JAR**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-09T08:39:35.863

删除 $JAVA_HOME/jre/lib/jaxp.properties 修复了该问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-19T18:59:12.680

看看[Selenium (XercesImpl) 和 Google App Engine](https://stackoverflow.com/questions/6165358/trouble-with-selenium-xercesimpl-and-google-app-engine)的麻烦。我在 GWT / GAE 上遇到了类似的问题（未找到 SAXParserFactoyImpl）并通过以下方式解决了它；

1.  将jar导入war/WEB-INF/lib
2.  将 jar 添加到构建路径

# xcode - 如何在 Xcode 中向后导航？

> ID：1016289
> 
> 赞同：11
> 
> 时间：2009-06-19T03:58:45.430
> 
> 标签：xcode, keyboard-shortcuts

在 Visual Studio 中，我可以按+**向后导航**。这在检查函数定义然后立即返回我正在处理的代码时非常有用。 `Ctrl``-`

我怎样才能在 Xcode 中做到这一点？（我使用的是 3.1.2 版）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-06-02T20:58:09.490

***如果使用 Xcode 4 的人需要其版本的答案，请编写此代码：

在 Xcode 4 首选项中，它被配置为`^`+`⌘</kbd> + `←</kbd> (control-command-left arrow) to navigate back and `^` + `⌘</kbd> + `→</kbd> (control-command-right arrow) to navigate forwards.````

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T22:45:16.340

Xcode 3.1.x 在这方面确实有点弱。令人高兴的是，*@zoul*提到的导航（标题栏中的后退/前进箭头，或⌘⌥←和⌘⌥→）在 Snow Leopard 中得到了显着改进，并且应该提供您希望的更细粒度的导航。~~抱歉，没有立即的解决方案，但希望知道修复即将到来会有所帮助...~~

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T04:25:53.270

有一个`Cmd`++可以追溯到编辑器历史，反之++`Alt`可以向前浏览。（不确定这是否正是您要查找的内容。）在头文件和实现文件之间切换的++效果很好。`←``Cmd``Alt``→``Cmd``Alt``↑`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T04:37:20.590

Xcode 中编辑器窗格的左上角有小箭头。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-05-25T07:53:20.767

在带有多点触控板的 Mac 上，您还可以使用三指左右滑动来浏览文件历史记录。

另请回复：MrDatabase 对 stefanB[响应](https://stackoverflow.com/questions/1016289/how-can-i-navigate-backwards-in-xcode/1016360#1016360)的评论，如果您实际上是从定义跳转到定义（例如，通过按住 Command 并单击符号）而不是仅仅滚动，我相信文件历史记录应该跟踪导航即使在同一个文件中......也许这是 Xcode 3.1.3 中的一个变化。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-18T19:43:21.137

Control + Command + 箭头键对我有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T04:10:36.463

除了[“完整的快捷方式列表”](http://www.1729.us/xcode/Xcode%20Shortcuts.pdf)，我不知道。

你可以用 找到以前的`⇧⌘G`，但这并不是我想的那样。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-03-05T03:42:41.550

在**Xcode 13.0.0 中**，您可以使用：（操作系统：Mac 11.6）

`Control`+ `Command`+`→</kbd> or `←</kbd>``

希望这有帮助！

# c# - 如何组织我的课程？

> ID：1016290
> 
> 赞同：0
> 
> 时间：2009-06-19T03:58:59.190
> 
> 标签：c#, asp.net-mvc, oop, principles

我正在 ASP.NET MVC 中开发一个小项目来管理照片，但我不知道如何在命名空间中组织我的类。

我有 2 个基类（照片和类别）。我应该把这些类放到哪个命名空间中？领域？POCO/POJO？

对于数据访问，我在 DAO 命名空间中有更多的 2 个类，PhotoDAO 和 CategoryDAO。（这样对吗？）

我应该把我的业务逻辑类放在哪个命名空间以及如何命名它们？

有人对我必须使用/学习哪些设计模式有任何建议吗？

我很抱歉问了这么基本的问题。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T04:04:46.727

我坚定地支持简单/按需重构的方法。

在这种方法中，您只需将所有类放入一个命名空间中，并让您的代码正常工作。在开发周期的任何时候，您开始感到“杂乱无章”，请考虑您拥有的类，并在逻辑上将它们分成一个或两个与您对每个组的看法相匹配的命名空间。

随着您的继续，定期/根据需要重复此过程，当您的总文件数增加时，您可以考虑构建文件夹以反映您的命名空间。

这可能不是每个人都适合的方式，但如果完成然后微调的想法对您有吸引力，那么我会推荐这种方法。

更新：

链接到[MVC 教程](http://www.asp.net/learn/mvc/#MVC_Overview)，这将使您了解他们建议的工作方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T04:39:11.653

考虑将类别设为枚举（照片可以有一组类别）。考虑一个专辑类。允许一张照片出现在多个相册中。使用 mvc 迷你架构。看看 picasa。

# iphone - 是否可以检测蜂窝网络是否可用？

> ID：1016299
> 
> 赞同：4
> 
> 时间：2009-06-19T04:02:36.447
> 
> 标签：iphone, cocoa-touch

我正在开发一个 iPhone 应用程序，我希望能够检查手机是否能够拨打电话（如果不能，则警告用户）。这可能是由于没有可用的蜂窝服务或用户将手机置于“飞行模式”。

我查看了 Apple 的文档，但找不到任何可以让我检查的内容。我是否遗漏了什么，或者 Apple 没有将这些信息暴露给应用程序？

编辑：强调一下，我对检查 IP 网络连接不感兴趣，但想确定我的应用程序是否可以拨打电话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T04:31:41.603

查看**可达性.m**。虽然我对细胞信号强度并不肯定，但如果存在类似的东西，它会包含在这个文件中。

以下是如何使用它来检测网络可达性的示例：[http ://www.raddonline.com/blogs/geek-journal/iphone-sdk-testing-network-reachability/](http://www.raddonline.com/blogs/geek-journal/iphone-sdk-testing-network-reachability/)

可达性.m：

```
/*

===== IMPORTANT =====

This is sample code demonstrating API, technology or techniques in development.
Although this sample code has been reviewed for technical accuracy, it is not
final. Apple is supplying this information to help you plan for the adoption of
the technologies and programming interfaces described herein. This information
is subject to change, and software implemented based on this sample code should
be tested with final operating system software and final documentation. Newer
versions of this sample code may be provided with future seeds of the API or
technology. For information about updates to this and other developer
documentation, view the New & Updated sidebars in subsequent documentation
seeds.

=====================

File: Reachability.m
Abstract: SystemConfiguration framework wrapper.

Version: 1.4

Disclaimer: IMPORTANT:  This Apple software is supplied to you by Apple Inc.
("Apple") in consideration of your agreement to the following terms, and your
use, installation, modification or redistribution of this Apple software
constitutes acceptance of these terms.  If you do not agree with these terms,
please do not use, install, modify or redistribute this Apple software.

In consideration of your agreement to abide by the following terms, and subject
to these terms, Apple grants you a personal, non-exclusive license, under
Apple's copyrights in this original Apple software (the "Apple Software"), to
use, reproduce, modify and redistribute the Apple Software, with or without
modifications, in source and/or binary forms; provided that if you redistribute
the Apple Software in its entirety and without modifications, you must retain
this notice and the following text and disclaimers in all such redistributions
of the Apple Software.
Neither the name, trademarks, service marks or logos of Apple Inc. may be used
to endorse or promote products derived from the Apple Software without specific
prior written permission from Apple.  Except as expressly stated in this notice,
no other rights or licenses, express or implied, are granted by Apple herein,
including but not limited to any patent rights that may be infringed by your
derivative works or by other works in which the Apple Software may be
incorporated.

The Apple Software is provided by Apple on an "AS IS" basis.  APPLE MAKES NO
WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION THE IMPLIED
WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE, REGARDING THE APPLE SOFTWARE OR ITS USE AND OPERATION ALONE OR IN
COMBINATION WITH YOUR PRODUCTS.

IN NO EVENT SHALL APPLE BE LIABLE FOR ANY SPECIAL, INDIRECT, INCIDENTAL OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
ARISING IN ANY WAY OUT OF THE USE, REPRODUCTION, MODIFICATION AND/OR
DISTRIBUTION OF THE APPLE SOFTWARE, HOWEVER CAUSED AND WHETHER UNDER THEORY OF
CONTRACT, TORT (INCLUDING NEGLIGENCE), STRICT LIABILITY OR OTHERWISE, EVEN IF
APPLE HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

Copyright (C) 2008 Apple Inc. All Rights Reserved.

*/

#import <sys/socket.h>
#import <netinet/in.h>
#import <netinet6/in6.h>
#import <arpa/inet.h>
#import <ifaddrs.h>
#include <netdb.h>

#import "Reachability.h"
#import <SystemConfiguration/SCNetworkReachability.h>

static NSString *kLinkLocalAddressKey = @"169.254.0.0";
static NSString *kDefaultRouteKey = @"0.0.0.0";

static Reachability *_sharedReachability;

// A class extension that declares internal methods for this class.
@interface Reachability()
- (BOOL)isAdHocWiFiNetworkAvailableFlags:(SCNetworkReachabilityFlags *)outFlags;
- (BOOL)isNetworkAvailableFlags:(SCNetworkReachabilityFlags *)outFlags;
- (BOOL)isReachableWithoutRequiringConnection:(SCNetworkReachabilityFlags)flags;
- (SCNetworkReachabilityRef)reachabilityRefForHostName:(NSString *)hostName;
- (SCNetworkReachabilityRef)reachabilityRefForAddress:(NSString *)address;
- (BOOL)addressFromString:(NSString *)IPAddress address:(struct sockaddr_in *)outAddress;
- (void)stopListeningForReachabilityChanges;
@end

@implementation Reachability

@synthesize networkStatusNotificationsEnabled = _networkStatusNotificationsEnabled;
@synthesize hostName = _hostName;
@synthesize address = _address;
@synthesize reachabilityQueries = _reachabilityQueries;

+ (Reachability *)sharedReachability
{
    if (!_sharedReachability) {
        _sharedReachability = [[Reachability alloc] init];
        // Clients of Reachability will typically call [[Reachability sharedReachability] setHostName:]
        // before calling one of the status methods.
        _sharedReachability.hostName = nil;
        _sharedReachability.address = nil;
        _sharedReachability.networkStatusNotificationsEnabled = NO;
        _sharedReachability.reachabilityQueries = [[NSMutableDictionary alloc] init];
    }
    return _sharedReachability;
}

- (void) dealloc
{   
    [self stopListeningForReachabilityChanges];

    [_sharedReachability.reachabilityQueries release];
    [_sharedReachability release];
    [super dealloc];
}

- (BOOL)isReachableWithoutRequiringConnection:(SCNetworkReachabilityFlags)flags
{
    // kSCNetworkReachabilityFlagsReachable indicates that the specified nodename or address can
    // be reached using the current network configuration.
    BOOL isReachable = flags & kSCNetworkReachabilityFlagsReachable;

    // This flag indicates that the specified nodename or address can
    // be reached using the current network configuration, but a
    // connection must first be established.
    //
    // As an example, this status would be returned for a dialup
    // connection that was not currently active, but could handle
    // network traffic for the target system.
    //
    // If the flag is false, we don't have a connection. But because CFNetwork
    // automatically attempts to bring up a WWAN connection, if the WWAN reachability
    // flag is present, a connection is not required.
    BOOL noConnectionRequired = !(flags & kSCNetworkReachabilityFlagsConnectionRequired);
    if ((flags & kSCNetworkReachabilityFlagsIsWWAN)) {
        noConnectionRequired = YES;
    }

    return (isReachable && noConnectionRequired) ? YES : NO;
}

// Returns whether or not the current host name is reachable with the current network configuration.
- (BOOL)isHostReachable:(NSString *)host
{
    if (!host || ![host length]) {
        return NO;
    }

    SCNetworkReachabilityFlags      flags;
    SCNetworkReachabilityRef reachability =  SCNetworkReachabilityCreateWithName(NULL, [host UTF8String]);
    BOOL gotFlags = SCNetworkReachabilityGetFlags(reachability, &flags);

    CFRelease(reachability);

    if (!gotFlags) {
        return NO;
    }

    return [self isReachableWithoutRequiringConnection:flags];
}

// This returns YES if the address 169.254.0.0 is reachable without requiring a connection.
- (BOOL)isAdHocWiFiNetworkAvailableFlags:(SCNetworkReachabilityFlags *)outFlags
{       
    // Look in the cache of reachability queries for one that matches this query.
    ReachabilityQuery *query = [self.reachabilityQueries objectForKey:kLinkLocalAddressKey];
    SCNetworkReachabilityRef adHocWiFiNetworkReachability = query.reachabilityRef;

    // If a cached reachability query was not found, create one.
    if (!adHocWiFiNetworkReachability) {

        // Build a sockaddr_in that we can pass to the address reachability query.
        struct sockaddr_in sin;

        bzero(&sin, sizeof(sin));
        sin.sin_len = sizeof(sin);
        sin.sin_family = AF_INET;
        // IN_LINKLOCALNETNUM is defined in <netinet/in.h> as 169.254.0.0
        sin.sin_addr.s_addr = htonl(IN_LINKLOCALNETNUM);

        adHocWiFiNetworkReachability = SCNetworkReachabilityCreateWithAddress(NULL, (struct sockaddr *)&sin);

        query = [[[ReachabilityQuery alloc] init] autorelease];
        query.hostNameOrAddress = kLinkLocalAddressKey;
        query.reachabilityRef = adHocWiFiNetworkReachability;

        // Add the reachability query to the cache.
        [self.reachabilityQueries setObject:query forKey:kLinkLocalAddressKey];
    }

    // If necessary, register for notifcations for the SCNetworkReachabilityRef on the current run loop.
    // If an existing SCNetworkReachabilityRef was found in the cache, we can reuse it and register
    // to receive notifications from it in the current run loop, which may be different than the run loop
    // that was previously used when registering the SCNetworkReachabilityRef for notifications.
    // -scheduleOnRunLoop: will schedule only if network status notifications are enabled in the Reachability instance.
    // By default, they are not enabled. 
    [query scheduleOnRunLoop:[NSRunLoop currentRunLoop]];

    SCNetworkReachabilityFlags addressReachabilityFlags;
    BOOL gotFlags = SCNetworkReachabilityGetFlags(adHocWiFiNetworkReachability, &addressReachabilityFlags);
    if (!gotFlags) {
        // There was an error getting the reachability flags.
        return NO;
    }

    // Callers of this method might want to use the reachability flags, so if an 'out' parameter
    // was passed in, assign the reachability flags to it.
    if (outFlags) {
        *outFlags = addressReachabilityFlags;
    }

    return [self isReachableWithoutRequiringConnection:addressReachabilityFlags];
}

// ReachabilityCallback is registered as the callback for network state changes in startListeningForReachabilityChanges.
static void ReachabilityCallback(SCNetworkReachabilityRef target, SCNetworkReachabilityFlags flags, void *info)
{
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    // Post a notification to notify the client that the network reachability changed.
    [[NSNotificationCenter defaultCenter] postNotificationName:@"kNetworkReachabilityChangedNotification" object:nil];

    [pool release];
}

// Perform a reachability query for the address 0.0.0.0\. If that address is reachable without
// requiring a connection, a network interface is available. We'll have to do more work to
// determine which network interface is available.
- (BOOL)isNetworkAvailableFlags:(SCNetworkReachabilityFlags *)outFlags
{
    ReachabilityQuery *query = [self.reachabilityQueries objectForKey:kDefaultRouteKey];
    SCNetworkReachabilityRef defaultRouteReachability = query.reachabilityRef;

    if (!defaultRouteReachability) {

        struct sockaddr_in zeroAddress;
        bzero(&zeroAddress, sizeof(zeroAddress));
        zeroAddress.sin_len = sizeof(zeroAddress);
        zeroAddress.sin_family = AF_INET;

        defaultRouteReachability = SCNetworkReachabilityCreateWithAddress(NULL, (struct sockaddr *)&zeroAddress);

        ReachabilityQuery *query = [[[ReachabilityQuery alloc] init] autorelease];
        query.hostNameOrAddress = kDefaultRouteKey;
        query.reachabilityRef = defaultRouteReachability;

        [self.reachabilityQueries setObject:query forKey:kDefaultRouteKey];
    }

    // If necessary, register for notifcations for the SCNetworkReachabilityRef on the current run loop.
    // If an existing SCNetworkReachabilityRef was found in the cache, we can reuse it and register
    // to receive notifications from it in the current run loop, which may be different than the run loop
    // that was previously used when registering the SCNetworkReachabilityRef for notifications. 
    // -scheduleOnRunLoop: will schedule only if network status notifications are enabled in the Reachability instance.
    // By default, they are not enabled. 
    [query scheduleOnRunLoop:[NSRunLoop currentRunLoop]];

    SCNetworkReachabilityFlags flags;
    BOOL gotFlags = SCNetworkReachabilityGetFlags(defaultRouteReachability, &flags);
    if (!gotFlags) {
        return NO;
    }

    BOOL isReachable = [self isReachableWithoutRequiringConnection:flags];

    // Callers of this method might want to use the reachability flags, so if an 'out' parameter
    // was passed in, assign the reachability flags to it.
    if (outFlags) {
        *outFlags = flags;
    }

    return isReachable;
}

// Be a good citizen an unregister for network state changes when the application terminates.
- (void)stopListeningForReachabilityChanges
{
    // Walk through the cache that holds SCNetworkReachabilityRefs for reachability
    // queries to particular hosts or addresses.
    NSEnumerator *enumerator = [self.reachabilityQueries objectEnumerator];
    ReachabilityQuery *reachabilityQuery;

    while (reachabilityQuery = [enumerator nextObject]) {

        CFArrayRef runLoops = reachabilityQuery.runLoops;
        NSUInteger runLoopCounter, maxRunLoops = CFArrayGetCount(runLoops);

        for (runLoopCounter = 0; runLoopCounter < maxRunLoops; runLoopCounter++) {
            CFRunLoopRef nextRunLoop = (CFRunLoopRef)CFArrayGetValueAtIndex(runLoops, runLoopCounter);

            SCNetworkReachabilityUnscheduleFromRunLoop(reachabilityQuery.reachabilityRef, nextRunLoop, kCFRunLoopDefaultMode);
        }

        CFArrayRemoveAllValues(reachabilityQuery.runLoops);
    }
}

/*
 Create a SCNetworkReachabilityRef for hostName, which lets us determine if hostName
 is currently reachable, and lets us register to receive notifications when the 
 reachability of hostName changes.
 */
- (SCNetworkReachabilityRef)reachabilityRefForHostName:(NSString *)hostName
{
    if (!hostName || ![hostName length]) {
        return NULL;
    }

    // Look in the cache for an existing SCNetworkReachabilityRef for hostName.
    ReachabilityQuery *cachedQuery = [self.reachabilityQueries objectForKey:hostName];
    SCNetworkReachabilityRef reachabilityRefForHostName = cachedQuery.reachabilityRef;

    if (reachabilityRefForHostName) {
        return reachabilityRefForHostName;
    }

    // Didn't find an existing SCNetworkReachabilityRef for hostName, so create one ...
    reachabilityRefForHostName = SCNetworkReachabilityCreateWithName(kCFAllocatorDefault, [hostName UTF8String]);

    NSAssert1(reachabilityRefForHostName != NULL, @"Failed to create SCNetworkReachabilityRef for host: %@", hostName);

    ReachabilityQuery *query = [[[ReachabilityQuery alloc] init] autorelease];
    query.hostNameOrAddress = hostName;
    query.reachabilityRef = reachabilityRefForHostName;

    // If necessary, register for notifcations for the SCNetworkReachabilityRef on the current run loop.
    // If an existing SCNetworkReachabilityRef was found in the cache, we can reuse it and register
    // to receive notifications from it in the current run loop, which may be different than the run loop
    // that was previously used when registering the SCNetworkReachabilityRef for notifications.
    // -scheduleOnRunLoop: will schedule only if network status notifications are enabled in the Reachability instance.
    // By default, they are not enabled. 
    [query scheduleOnRunLoop:[NSRunLoop currentRunLoop]];

    // ... and add it to the cache.
    [self.reachabilityQueries setObject:query forKey:hostName];
    return reachabilityRefForHostName;
}

/*
 Create a SCNetworkReachabilityRef for the IP address in addressString, which lets us determine if 
 the address is currently reachable, and lets us register to receive notifications when the 
 reachability of the address changes.
 */
- (SCNetworkReachabilityRef)reachabilityRefForAddress:(NSString *)addressString
{
    if (!addressString || ![addressString length]) {
        return NULL;
    }

    struct sockaddr_in address;

    BOOL gotAddress = [self addressFromString:addressString address:&address];
    // The attempt to convert addressString to a sockaddr_in failed.
    if (!gotAddress) {
        NSAssert1(gotAddress != NO, @"Failed to convert an IP address string to a sockaddr_in: %@", addressString);
        return NULL;
    }

    // Look in the cache for an existing SCNetworkReachabilityRef for addressString.
    ReachabilityQuery *cachedQuery = [self.reachabilityQueries objectForKey:addressString];
    SCNetworkReachabilityRef reachabilityRefForAddress = cachedQuery.reachabilityRef;

    if (reachabilityRefForAddress) {
        return reachabilityRefForAddress;
    }

    // Didn't find an existing SCNetworkReachabilityRef for addressString, so create one ...
    reachabilityRefForAddress = SCNetworkReachabilityCreateWithAddress(kCFAllocatorDefault, (struct sockaddr *)&address);

    NSAssert1(reachabilityRefForAddress != NULL, @"Failed to create SCNetworkReachabilityRef for address: %@", addressString);

    ReachabilityQuery *query = [[[ReachabilityQuery alloc] init] autorelease];
    query.hostNameOrAddress = addressString;
    query.reachabilityRef = reachabilityRefForAddress;

    // If necessary, register for notifcations for the SCNetworkReachabilityRef on the current run loop.
    // If an existing SCNetworkReachabilityRef was found in the cache, we can reuse it and register
    // to receive notifications from it in the current run loop, which may be different than the run loop
    // that was previously used when registering the SCNetworkReachabilityRef for notifications.
    // -scheduleOnRunLoop: will schedule only if network status notifications are enabled in the Reachability instance.
    // By default, they are not enabled. 
    [query scheduleOnRunLoop:[NSRunLoop currentRunLoop]];

    // ... and add it to the cache.
    [self.reachabilityQueries setObject:query forKey:addressString];
    return reachabilityRefForAddress;
}

- (NetworkStatus)remoteHostStatus
{
    /*
     If the current host name or address is reachable, determine which network interface it is reachable through.
     If the host is reachable and the reachability flags include kSCNetworkReachabilityFlagsIsWWAN, it
     is reachable through the carrier data network. If the host is reachable and the reachability
     flags do not include kSCNetworkReachabilityFlagsIsWWAN, it is reachable through the WiFi network.
     */

    SCNetworkReachabilityRef reachabilityRef = nil;
    if (self.hostName) {
        reachabilityRef = [self reachabilityRefForHostName:self.hostName];

    } else if (self.address) {
        reachabilityRef = [self reachabilityRefForAddress:self.address];

    } else {
        NSAssert(self.hostName != nil && self.address != nil, @"No hostName or address specified. Cannot determine reachability.");
        return NotReachable;
    }

    if (!reachabilityRef) {
        return NotReachable;
    }

    SCNetworkReachabilityFlags reachabilityFlags;
    BOOL gotFlags = SCNetworkReachabilityGetFlags(reachabilityRef, &reachabilityFlags);
    if (!gotFlags) {
        return NotReachable;
    }

    BOOL reachable = [self isReachableWithoutRequiringConnection:reachabilityFlags];

    if (!reachable) {
        return NotReachable;
    }
    if (reachabilityFlags & ReachableViaCarrierDataNetwork) {
        return ReachableViaCarrierDataNetwork;
    }

    return ReachableViaWiFiNetwork;
}

- (NetworkStatus)internetConnectionStatus
{
    /*
     To determine if the device has an Internet connection, query the address
     0.0.0.0\. If it's reachable without requiring a connection, first check
     for the kSCNetworkReachabilityFlagsIsDirect flag, which tell us if the connection
     is to an ad-hoc WiFi network. If it is not, the device can access the Internet.
     The next thing to determine is how the device can access the Internet, which
     can either be through the carrier data network (EDGE or other service) or through
     a WiFi connection.

     Note: Knowing that the device has an Internet connection is not the same as
     knowing if the device can reach a particular host. To know that, use
     -[Reachability remoteHostStatus].
     */

    SCNetworkReachabilityFlags defaultRouteFlags;
    BOOL defaultRouteIsAvailable = [self isNetworkAvailableFlags:&defaultRouteFlags];
    if (defaultRouteIsAvailable) {

        if (defaultRouteFlags & kSCNetworkReachabilityFlagsIsDirect) {

            // The connection is to an ad-hoc WiFi network, so Internet access is not available.
            return NotReachable;
        }
        else if (defaultRouteFlags & ReachableViaCarrierDataNetwork) {
            return ReachableViaCarrierDataNetwork;
        }

        return ReachableViaWiFiNetwork;
    }

    return NotReachable;
}

- (NetworkStatus)localWiFiConnectionStatus
{
    SCNetworkReachabilityFlags selfAssignedAddressFlags;

    /*
     To determine if the WiFi connection is to a local ad-hoc network,
     check the availability of the address 169.254.x.x. That's an address
     in the self-assigned range, and the device will have a self-assigned IP
     when it's connected to a ad-hoc WiFi network. So to test if the device
     has a self-assigned IP, look for the kSCNetworkReachabilityFlagsIsDirect flag
     in the address query. If it's present, we know that the WiFi connection
     is to an ad-hoc network.
     */
    // This returns YES if the address 169.254.0.0 is reachable without requiring a connection.
    BOOL hasLinkLocalNetworkAccess = [self isAdHocWiFiNetworkAvailableFlags:&selfAssignedAddressFlags];

    if (hasLinkLocalNetworkAccess && (selfAssignedAddressFlags & kSCNetworkReachabilityFlagsIsDirect)) {
        return ReachableViaWiFiNetwork;
    }

    return NotReachable;
}

// Convert an IP address from an NSString to a sockaddr_in * that can be used to create
// the reachability request.
- (BOOL)addressFromString:(NSString *)IPAddress address:(struct sockaddr_in *)address
{
    if (!IPAddress || ![IPAddress length]) {
        return NO;
    }

    memset((char *) address, sizeof(struct sockaddr_in), 0);
    address->sin_family = AF_INET;
    address->sin_len = sizeof(struct sockaddr_in);

    int conversionResult = inet_aton([IPAddress UTF8String], &address->sin_addr);
    if (conversionResult == 0) {
        NSAssert1(conversionResult != 1, @"Failed to convert the IP address string into a sockaddr_in: %@", IPAddress);
        return NO;
    }

    return YES;
}

@end

@interface ReachabilityQuery ()
- (CFRunLoopRef)startListeningForReachabilityChanges:(SCNetworkReachabilityRef)reachability onRunLoop:(CFRunLoopRef)runLoop;
@end

@implementation ReachabilityQuery

@synthesize reachabilityRef = _reachabilityRef;
@synthesize runLoops = _runLoops;
@synthesize hostNameOrAddress = _hostNameOrAddress;

- (id)init
{
    self = [super init];
    if (self != nil) {
        self.runLoops = CFArrayCreateMutable(kCFAllocatorDefault, 0, NULL);
    }
    return self;
}

- (void)dealloc
{
    CFRelease(self.runLoops);
    [super dealloc];
}

- (BOOL)isScheduledOnRunLoop:(CFRunLoopRef)runLoop
{
    NSUInteger runLoopCounter, maxRunLoops = CFArrayGetCount(self.runLoops);

    for (runLoopCounter = 0; runLoopCounter < maxRunLoops; runLoopCounter++) {
        CFRunLoopRef nextRunLoop = (CFRunLoopRef)CFArrayGetValueAtIndex(self.runLoops, runLoopCounter);

        if (nextRunLoop == runLoop) {
            return YES;
        }
    }

    return NO;
}

- (void)scheduleOnRunLoop:(NSRunLoop *)inRunLoop
{
    // Only register for network state changes if the client has specifically enabled them.
    if ([[Reachability sharedReachability] networkStatusNotificationsEnabled] == NO) {
        return;
    }

    if (!inRunLoop) {
        return;
    }

    CFRunLoopRef runLoop = [inRunLoop getCFRunLoop];

    // Notifications of status changes for each reachability query can be scheduled on multiple run loops.
    // To support that, register for notifications for each runLoop.
    // -isScheduledOnRunLoop: iterates over all of the run loops that have previously been used
    // to register for notifications. If one is found that matches the passed in runLoop argument, there's
    // no need to register for notifications again. If one is not found, register for notifications
    // using the current runLoop.
    if (![self isScheduledOnRunLoop:runLoop]) {

        CFRunLoopRef notificationRunLoop = [self startListeningForReachabilityChanges:self.reachabilityRef onRunLoop:runLoop];
        if (notificationRunLoop) {
            CFArrayAppendValue(self.runLoops, notificationRunLoop);
        }
    }
}

// Register to receive changes to the 'reachability' query so that we can update the
// user interface when the network state changes.
- (CFRunLoopRef)startListeningForReachabilityChanges:(SCNetworkReachabilityRef)reachability onRunLoop:(CFRunLoopRef)runLoop
{   
    if (!reachability) {
        return NULL;
    }

    if (!runLoop) {
        return NULL;
    }

    SCNetworkReachabilityContext    context = {0, self, NULL, NULL, NULL};
    SCNetworkReachabilitySetCallback(reachability, ReachabilityCallback, &context);
    SCNetworkReachabilityScheduleWithRunLoop(reachability, runLoop, kCFRunLoopDefaultMode);

    return runLoop;
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-18T12:17:11.577

找到了解决这个问题的好方法。代码来自 Xamarin/Mono，因此如果您正在使用，请将语法转换为 Objective-c。

```
CTTelephonyNetworkInfo netInfo = new CTTelephonyNetworkInfo ();
string currentRadio = netInfo.CurrentRadioAccessTechnology; 
```

如果您的手机没有移动信号覆盖或处于飞行模式，“currentRadio”将为空。如果您有 Wifi 或其他网络访问但没有移动连接，这也适用，因此它非常适合 OP 的用例（与我的相同）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T09:49:48.647

canOpenURL: 将测试是否有可以处理 tel: URL 的应用程序，但您可能已经知道了。

您很可能无法检测到用户的通话帐户中是否有足够的资金来实际拨打电话（即预付卡上没有信用），但我认为您不太可能想知道这一点;-)

如果有无线广域网 (WWAN) 连接，您不能假设您可以拨打电话吗？您可以使用可达性示例测试 WWAN 可用性。

# blackberry - 在黑莓应用程序中将基于 GUI 的启动代码放在哪里？

> ID：1016300
> 
> 赞同：2
> 
> 时间：2009-06-19T04:04:06.290
> 
> 标签：blackberry, event-handling, startup

我想知道在我的黑莓应用程序中放置基于 GUI 的顺序启动代码的正确位置。

```
In main(), I create MyApp and enterEventDispatcher()
I have UiApplication (MyApp)
In the MyApp CTOR:
- I create a MainScreen (MyMain)
- I call pushScreen() on MyMain 
```

当事件分派器启动时，是否有一个我可以在 MainScreen 中监听的事件，它会给我一个事件线程，我可以在其中愉快地执行同步启动任务？

我可以使用 invokeLater() 但我希望每个调用都被阻止，因为它们的顺序在这个阶段很重要。在我尝试使用它的大多数情况下，invokeAndWait() 都会引发异常。

我尝试了下面的代码，但尝试在“Testing 1 2 3”行上运行时出现异常。

```
    公共类 MyApp 扩展 UiApplication {

        静态公共无效主要（字符串[]参数）{
            新的 MyApp().enterEventDispatcher();
        }

        公共我的应用程序（）
        {
            MyView theView = new MyView();
            theView.startUpdateTimer();
            推屏（视图）；

            Dialog.alert("测试 1 2 3");
        }
    }

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:56:42.000

如果它是非常快速的 UI 内容（创建一个屏幕，将其推送到堆栈上），请在调用 enterEventDispatcher 之前从主线程执行此操作。实际上，您可以随心所欲地做任何事情，只是如果您的应用程序需要很长时间，用户体验会更差。

调用 enterEventDispatcher 的线程基本上变成了事件调度线程，因此在调用 enterEventDispatcher 之前，您可以安全地在该线程上执行任何 GUI 操作。

具体来说，不要从主线程调用 invokeAndWait - 这会导致死锁并且可能会导致异常。

# python - 通用编程语言 (Python) 与定制语言 (PureData/MaxMSP/ChucK) 的综合

> ID：1016301
> 
> 赞同：6
> 
> 时间：2009-06-19T04:04:12.297
> 
> 标签：python, chuck, puredata

我正在学习 Python，因为它对我作为一名数学家很有吸引力，但它也有许多用于科学计算、图像处理、Web 应用程序等的有用库。

令我沮丧的是，对于我的某些兴趣（电子音乐或装置艺术），有一些非常特定的编程语言似乎更适合这些目的，例如 Max/MSP、PureData 和 ChuckK——所有这些都非常吸引人。

我的问题是，应该如何处理这些不同的语言？我应该简单地学习 Python 并通过在其中使用插件和 Python 解释器来管理其他的吗？是否有整合语言的好工具，或者只是学习所有语言的正确方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T04:14:48.057

我会说把它们都学起来。虽然许多语言确实可以做很多事情，但专业语言通常更具表现力并且更容易用于特定任务。典型的例子是，虽然大多数语言都允许 shell 交互和进程控制，但很少有人像 bash 脚本一样适合这项任务。

插件和库可以弥合通用语言和专业语言之间的差距，但根据我的经验，这并非总是没有缺点——无论是速度、稳定性还是复杂性。必须编译其他库或应用补丁或使用不受信任且支持不佳的模块并不少见。生成的界面仍然比原始语言更难使用也很常见。

我精通大约 15 种语言，其中一些非常精通。当另一种更合适时，我不使用我喜欢的语言。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-11T17:30:02.380

这个线程有点老了，但我想指出大多数成熟的音频开发环境，例如 supercollider/max-msp/pure data 可以通过开放的声音控制来控制。您可以在 Google 上找到更好的 OSC 描述，但只要说它允许您将控制数据发送到在这些环境中构建的合成器，类似于 MIDI 的工作方式，但范围更广。这并不能解决在 python 本身中实际构建合成器的问题，但它允许您“驱动”这些其他环境，而无需了解语言的来龙去脉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T04:26:51.133

完全有可能构建从 Python 到此类专用语言的良好接口：一个恰当的例子是[RPy](http://rpy.sourceforge.net/)，它可以让您从 Python（用于各种通用用途的东西）驱动 R（用于统计）。

当然，一个人必须精通两种语言——不幸的是，对于每一对给定的一种通用语言和一种专用语言，这种桥梁并不存在。“全学”，要全*用*，还是王道！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T04:31:37.873

Python 将是一门很好的学习语言，因为它可以与许多其他语言一起很好地工作。它既是一种出色的通用语言，也是一种“胶水”语言。花时间学习你感兴趣的语言，并保持 Python 知识的灵活性和强大。除非您真的有时间，否则我不建议您尝试全部学习它们。

您可能想知道 PureData 有一个[python 扩展](http://puredata.info/Members/thomas/py/)。

# c++ - 列表迭代器 Remove()

> ID：1016307
> 
> 赞同：14
> 
> 时间：2009-06-19T04:07:03.467
> 
> 标签：c++, list, stl

我有一个列表迭代器，它遍历一个列表并删除所有偶数。我可以使用列表迭代器很好地打印出数字，但我不能使用列表的 remove() 并传入取消引用的迭代器。

我注意到当 remove() 语句生效时，*itr 被破坏了？有人可以解释一下吗？

```
#include <iostream>
#include <list>

#define MAX 100

using namespace std;

int main()
{
    list<int> listA;
    list<int>::iterator itr;

    //create list of 0 to 100
    for(int i=0; i<=MAX; i++)
        listA.push_back(i);

    //remove even numbers
    for(itr = listA.begin(); itr != listA.end(); ++itr)
    {
        if ( *itr % 2 == 0 )
        {
            cout << *itr << endl;
            listA.remove(*itr);    //comment this line out and it will print properly
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-19T04:20:20.850

上面的代码存在一些问题。首先，这`remove`将使指向已删除元素的任何迭代器无效。然后继续使用迭代器。在一般情况下（尽管不是在您的情况下）很难判断哪些元素`remove`会被删除，因为它可以删除多个。

其次，您可能使用了错误的方法。Remove 将遍历列表中的所有项目以查找任何匹配的元素-在您的情况下这将是低效的，因为只有一个。看起来您应该使用该`erase`方法，您可能只想擦除迭代器位置处的项目。好处`erase`是它返回一个迭代器，它位于下一个有效位置。使用它的惯用方式是这样的：

```
//remove even numbers
for(itr = listA.begin(); itr != listA.end();)
{
    if ( *itr % 2 == 0 )
    {
        cout << *itr << endl;
        itr=listA.erase(itr);
    }
    else
      ++itr;
} 
```

最后，您也可以使用`remove_if`to 做同样的事情：

```
bool even(int i) { return i % 2 == 0; }

listA.remove_if(even); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T04:15:04.203

删除它引用的元素后，您不能使用迭代器。

但是，在 a 之后引用未删除项的列表迭代器`remove()`应该保持有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:58:40.323

我们可以使用这样的东西：

```
container.erase(it++); 
```

我试过这个例子：

```
int main(){

 list<int>*a=new list<int>;
 a->push_back(1);
 a->push_back(2);
 a->push_back(3);

 list<int>::iterator I;

 I=a->begin(); ++I;

 a->erase(I++);
 cout<<*I<<endl;
} 
```

如我所愿，它显示为 3。现在我不知道这是否有效，或者是“有时有效，有时无效”的有效方法之一。

编辑：也许是因为编译器。例如，我正在使用的编译器 (GNU gcc-g++) 将列表 (std::) 视为循环，即如果我在 list->end() 之后增加迭代器，它会将您置于开头。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-06-19T04:16:13.313

由于迭代器依赖于结构的长度保持不变，因此大多数迭代器不允许在使用迭代器时更改列表。如果要遍历并更改列表，则必须使用独立于迭代器的循环。

# database-design - 如何用 RDBMS 建模这种多重继承关系？

> ID：1016309
> 
> 赞同：2
> 
> 时间：2009-06-19T04:07:12.237
> 
> 标签：database-design, inheritance, data-modeling, rdbms, multiple-inheritance

我正在查看我提出的这个数据模型并且感觉不舒服。我已经更改了实体名称，所以它（希望）更有意义。无论如何，您将如何建模以下内容？

我有 3 个实体。政府客户、私人客户、公共客户。私人客户和公共客户都是公司客户。企业和政府客户是账户。所有帐户共享相同的密钥空间（因此，如果 PrivateCustomer 的 PK 为 1，那么 Public 或 GovernmentCustomer 的 PK 不应该为 1）。CorporateCustomer 有一些GovernmentCustomer 没有的1:M 关系。PublicCustomers 有一些 PrivateCustomers 没有的 1:M 关系。

传承：

```
Account
  CorporateCustomer
    PrivateCustomer
    PublicCustomer
  GovernmentCustomer 
```

现在我的模型有 5 张桌子。“Account”表是这个层次结构的根，每个子表的 PK 是其父 PK 的 FK。所以所有的表都有相同的PK。

所以，是的，你将如何建模？我希望这里没有出现严重错误:)。

编辑：

另外： - 我希望数据库负责参考完整性而不是应用程序。- 如果没有私人或公共客户，CorporateCustomer 就不可能存在。它的抽象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T04:29:14.660

一种方式可能是：

```
ACCOUNTS -> ACCOUNT_CUSTOMERS <- CUSTOMERS 
```

使 CUSTOMERS 具有类型为 Corporate(C)、Private(P)、Public(Z)、Government(G) 的 CUSTOMER_TYPE 列。由于所有公共和私人客户也是企业，如果您需要获得所有企业客户，您可以执行以下操作：

```
SELECT *
  FROM ACCOUNTS
     , ACCOUNT_CUSTOMERS
     , CUSTOMERS
 WHERE ACCOUNTS.ID = ACCOUNT_CUSTOMERS.ACCT_ID
   AND CUSTOMERS.ID = ACCOUNT_CUSTOMERS.CUST_ID
   AND CUSTOMERS.CUSTOMER_TYPE in ('C','P','Z') 
```

我使用了 ORACLE 语法，但我想你明白了。

```
In response to your edit: 
```

听起来您只有两种类型的客户。企业和政府。这更容易。我会在 CUSTOMERS 上使用一个名为 PUBLIC_IND 的布尔指标，当 false 为私有时，或者其他类型（如 ENTITY_TYPE）可能是 Private(P)、Public(Z) 或 None(N)。然后，如果您想获得所有公共企业客户用户：

```
SELECT *
      FROM ACCOUNTS
         , ACCOUNT_CUSTOMERS
         , CUSTOMERS
     WHERE ACCOUNTS.ID = ACCOUNT_CUSTOMERS.ACCT_ID
       AND CUSTOMERS.ID = ACCOUNT_CUSTOMERS.CUST_ID
       AND CUSTOMERS.CUSTOMER_TYPE in ('C')
       AND CUSTOMERS.ENTITY_TYPE = 'Z' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-28T22:46:24.920

在您承诺将每个类放在同一个表中之前，我会查看它们所涉及的*关系- 而不是属性。*如果记录类型为“X”，则将某些字段保留为空是微不足道的，但尝试建立仅适用于表中某些记录的关系是非常笨拙的。

如果类与其他实体的关系完全相同，那么您可以将它们全部填充到一个表中，而没有真正的缺点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-20T06:03:45.833

我知道这个问题已经很老了，但是由于它还没有一个公认的答案，所以我有几个想法。

一种可能性是使用 ORDBMS 特性——换句话说，使用表继承。在 PostgreSQL 中，你可以这样建模：

（请参阅有关 PostgresSQL 继承的文档[http://www.postgresql.org/docs/9.3/static/ddl-inherit.html](http://www.postgresql.org/docs/9.3/static/ddl-inherit.html)）

```
CREATE TABLE account
(
   account_id INT,
   PRIMARY KEY(account_id)
);

CREATE TABLE corporate_customer
(
   company_name VARCHAR(32),
   country_code CHAR(2),
   PRIMARY KEY(company_name)
) INHERITS(account);

CREATE TABLE private_corp_customer
(
   private_comp_id INT,
   company_owner VARCHAR(32),
   PRIMARY KEY(private_comp_int)
) INHERITS(corporate_customer);

CREATE TABLE public_corp_customer
(
   stock_ticker VARCHAR(6),
   PRIMARY KEY(stock_ticker)
) INHERITS(corporate_customer);

CREATE TABLE government_customer
(
   dept_nbr INT,
   country CHAR(2),
   PRIMARY KEY(dept_nbr)
) INHERITS(account); 
```

不同的 DBMS 供应商将以不同的方式实现这一点。在 PostgresSQL 中，这里描述了一些重要的警告：

[http://ledgersmbdev.blogspot.com/2012/08/postgresql-or-modelling-part-3-table.html](http://ledgersmbdev.blogspot.com/2012/08/postgresql-or-modelling-part-3-table.html)

特别要注意关于主键和外键不被继承的部分。

如果您不喜欢 DBMS 的限制或正在使用不具有对象关系功能的 DBMS，那么另一种选择是使用上面文章中建议的替代方法并使用辅助键。那将是这样建模的：

```
CREATE TABLE account
(
   account_id INT,
   account_type INT NOT NULL,
   PRIMARY KEY(account_id),
   UNIQUE (account_id, account_type)
);

CREATE TABLE corporate_customer
(
   account_id INT,
   account_type INT NOT NULL CHECK(account_type IN (1,2)),
   company_name VARCHAR(32),
   country_code CHAR(2),
   PRIMARY KEY(account_id, account_type),
   FOREIGN KEY(account_id, account_type) REFERENCES account(account_id, account_type),
   UNIQUE(account_id, account_type, company_name)
);

CREATE TABLE private_corp_customer
(
   account_id INT,
   account_type INT NOT NULL CHECK(account_type = 1),
   company_name VARCHAR(32),
   company_owner VARCHAR(32),
   PRIMARY KEY(account_id, account_type, company_name),
   FOREIGN KEY(account_id, account_type, company_name) REFERENCES corporate_customer (account_id, account_type, company_name)
);

CREATE TABLE public_corp_customer
(
   account_id INT,
   account_type INT NOT NULL CHECK (account_type = 2),
   company_name VARCHAR(32),
   stock_ticker CHAR(6),
   PRIMARY KEY(account_id, account_type, company_name),
   FOREIGN KEY(account_id, account_type, company_name) 
   REFERENCES corporate_customer (account_id, account_type, company_name)
) INHERITS(corporate_customer);

CREATE TABLE government_customer
(
   account_id INT,
   account_type INT NOT NULL CHECK(account_type = 3),
   dept_nbr INT,
   country_code CHAR(2),
   PRIMARY KEY(account_id, account_type),
   FOREIGN KEY(account_id, account_type) REFERENCES account(account_id, account_type),
   UNIQUE(account_id, account_type, dept_nbr)
 ); 
```

上述设计也有一些重要的限制（在上面的文章中也有描述）。一方面，虽然不可能拥有不是私人、公共或政府客户的帐户，但有可能这样做；你可以只拥有既不是公共也不是私人的帐户、公司帐户……维护起来简直就是一场噩梦。约束也会影响性能，`CHECK`您会注意到子实体中存在数据重复，以及公司子实体 (country_code) 中缺少信息。

您选择哪些限制将取决于您的 DBMS 供应商以及您想要管理的头痛程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T04:58:49.503

我同意其他人的观点，即如果不同类型的客户相似，customerType 字段就足够了。

也就是说，也许只有企业客户共享一个表，但政府客户的差异很大，需要在自己的表中定义。如果这是有保证的，帮助您实施 PK 约束的一种设计是拥有一个 MasterAccount 表，该表将通过 id 引用所有客户（PK 约束），并在下一级引用他们的类型层次结构（公司或政府）。

您仍然需要映射 1-* 关系，您可以使用另外两个表来执行此操作 - 关系表和帐户关系映射表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T04:21:34.860

除非在不同类型的客户之间跟踪的属性存在显着差异，否则我只会有一个名为 Account 的表，其中包含一些 CustomerType 字段。您可以通过具有 FK 到 AccountID 的明细表来表达 1:m 关系。

编辑：现代数据库可以在 FK 参照完整性之外添加数据完整性规则。例如，对于 SQL Server，您可以添加[CHECK 约束](http://msdn.microsoft.com/en-us/library/ms188258.aspx)以强制 AccountType 成为某个明细表主控的 GovernmentCustomer。它可能看起来像这样：

```
CREATE FUNCTION EnforceGovernmentCustomer(@AccountID int)
RETURNS bit
AS 
BEGIN
   DECLARE @retval bit
   SELECT @retval = 0
   SELECT @retval = 1
   FROM Account
   WHERE AccountID = @AccountID AND AccountType = 3

   RETURN @retval
END;
GO
ALTER TABLE GovernmentCustomerDetail
ADD CONSTRAINT chkGovernmentCustomer CHECK (dbo.EnforceGovernmentCustomer(AccountID) = 1);
GO 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T04:22:35.017

我认为您应该只有一个 Account 和一个 Customer 表，以及一个 CustomerRelationship 表。不同类型的客户可以使用某种类型代码来区分，并且可以使用 CustomerRelationship 表来维护关系。

# sql - 限制关联实体的查询

> ID：1016311
> 
> 赞同：0
> 
> 时间：2009-06-19T04:09:30.427
> 
> 标签：sql, hibernate

我想形成一个关联集合受到限制的查询，最好使用 Hibernate Criteria 或 HQL，但我对如何在 SQL 中执行此操作感兴趣。例如，假设我有一个 Boy 类，它与 Kites 类具有双向的一对多关联。我想获得风筝长度在一定范围内的男孩名单。

问题是我知道的 HQL/Criteria 只能让我得到带有完整（无限制）风筝集的 Boy 对象，如这两个示例中给出的（HQL 是猜测）。即，我得到了在正确范围内拥有风筝的男孩，但对于每个这样的男孩，我得到*了所有*的风筝，而不仅仅是范围内的风筝。

```
select new Boy(name) from Boy b 
       inner join Kite on Boy.id=Kite.boyId 
             where b.name = "Huck" and length >= 1;

Criteria crit = session.createCriteria(Boy.class);
crit.add(Restrictions.eq("name", "Huck"))
    .createCriteria("kites")
    .add(Restrictions.ge("length", new BigDecimal(1.0)));
List list = crit.list(); 
```

现在，我必须获得正确的风筝长度集的唯一方法是遍历男孩列表，并为每个男孩重新查询风筝以查找范围内的风筝。我希望一些 SQL/HQL/Criteria 向导知道更好的方法。我更愿意得到一个 Criteria 解决方案，因为我真正的“Boy”构造函数有很多参数，并且拥有初始化的 Boys 会很方便。

我的底层数据库是 MySQL。不要以为我对 SQL 或 Hibernate 了解很多。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T04:21:32.223

我不是休眠专家，但正如您所说，您也对 SQL 解决方案感兴趣......：

在 SQL 中，我假设您的意思是（添加索引、键等）：

```
CREATE TABLE Boys (Id INT, Name VARCHAR(16))
CREATE TABLE Kites(Length FLOAT, BoyID INT, Description TEXT) 
```

当然还有其他在这里无关紧要的列 &c。

所有拥有 1 个以上长度在 1.0 和 1.5 之间的风筝的男孩：

```
SELECT DISTINCT Boys.*
FROM Boys
JOIN Kites ON(Kites.BoyID=Boys.ID AND Kites.Length BETWEEN 1.0 AND 1.5) 
```

如果您还想查看相关风筝的描述，每个男孩拥有 N 行这样的风筝：

```
SELECT Boys.*, Kites.Length, Kites.Description
FROM Boys
JOIN Kites ON(Kites.BoyID=Boys.ID AND Kites.Length BETWEEN 1.0 AND 1.5) 
```

希望有人可以帮助您将这些与 hybernate 集成......！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-07T22:44:24.087

事实证明，最好通过反转连接来完成：

```
Criteria crit = session.createCriteria(Kite.class);
crit.add(Restrictions.ge("length", new BigDecimal(1.0))
.createCriteria("boy")
.add(Restrictions.eq("name", "Huck")));
List<Kite> list = crit.list(); 
```

请注意，列表的 Kites 需要聚合到 Boys 中，这可以使用 HashMap 轻松完成。

# vba - 从 vba 到平面文件的 Unicode 字符串

> ID：1016326
> 
> 赞同：3
> 
> 时间：2009-06-19T04:17:37.230
> 
> 标签：vba, unicode, flat-file

我想将 unicode 字符串存储在来自 excel/vba 宏的 windows 框中的平面文件中。该宏将普通字符串转换为 unicode 表示，需要将其存储在文件中并稍后检索。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T19:14:31.320

如前所述，您可以使用 Microsoft 脚本运行时 (scrrun.dll)。我在下面发布了一些示例。有些人还喜欢原生文件 IO 功能。这里有一个广泛的（而且相当全面的线程）线程：[http ://www.xtremevbtalk.com/showthread.php?t=123814](http://www.xtremevbtalk.com/showthread.php?t=123814)

但是对于 Unicode 文件，使用 Textstreams 可能是最不痛苦的:)

```
Public Sub StringToTextFile(ByVal path As String, ByVal value As String)
    'Requires reference to scrrun.dll
    Dim fso As Scripting.FileSystemObject
    Dim ts As Scripting.TextStream
    Set fso = New Scripting.FileSystemObject
    Set ts = fso.CreateTextFile(path, False, True)
    ts.Write value
    ts.Close
End Sub

Public Sub LazyMansWay(ByVal path As String, ByVal value As String)
    'Reference counting will cause the objects to be destroyed. The termination
    'events of the classes will cause the connections to be closed.
    CreateObject("Scripting.FileSystemObject").CreateTextFile(path, False, True).Write value
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T04:26:56.733

添加对“Microsoft Scripting Runtime”COM 组件 (scrrun.dll) 的引用。

它具有创建/读取/写入文件的所有类（特别是 FileSystemObject/TextStream）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T11:03:01.367

我能想到的最佳解决方案是将字符串读入字节数组并将每个字节写入二进制文件

```
Private Function WriteBinaryFile(ByRef szData As String)
    Dim bytData() As Byte
    Dim lCount As Long

    bytData = szData
    Open PwdFileName For Binary As #1
        For lCount = LBound(bytData) To UBound(bytData)
            Put #1, , bytData(lCount)
        Next lCount
    Close #1
End Function 
```

通过以二进制模式打开文件并将每个字节读入字节数组然后将其转换为字符串来读取它。

```
Sub ReadBinaryFile(ByRef gszData As String)
Dim aryBytes() As Byte
Dim bytInput As Byte
Dim intFileNumber
Dim intFilePos

intFileNumber = FreeFile

Open PwdFileName For Binary As #intFileNumber
intFilePos = 1

Do
    Get #intFileNumber, intFilePos, bytInput
    If EOF(intFileNumber) = True Then Exit Do
    ReDim Preserve aryBytes(intFilePos - 1)
    aryBytes(UBound(aryBytes)) = bytInput
    intFilePos = intFilePos + 1
Loop While EOF(intFileNumber) = False
Close #intFileNumber

gszData = aryBytes
End Sub 
```

# windows - 适用于 Windows 的补丁堆栈工具

> ID：1016327
> 
> 赞同：2
> 
> 时间：2009-06-19T04:18:35.453
> 
> 标签：windows, linux, patch

Windows 世界中是否有任何类似的补丁堆栈管理工具，如 Linux 的被子？我正在尝试为我们的环境提出一些开发工作流程，这些工作流程需要在 Linux 和 Windows 上运行。我可以使用被子等为 Linux 提供一个漂亮的系统，但除非我能找到一种在 Windows 上复制它的方法（包括所有命令行恐惧症开发人员的漂亮 GUI），否则我基本上被卡住了.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T04:29:16.440

也许 Mercurial 的[队列](http://www.selenic.com/mercurial/wiki/MqExtension)可以提供帮助？我相信他们也可以在 Mercurial 的 Windows 实现中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-20T18:09:09.897

我通过[Cygwin](http://cygwin.com/)在 Windows 上使用被子。

# c# - 如何确定当前 Windows 会话是否被锁定？

> ID：1016331
> 
> 赞同：6
> 
> 时间：2009-06-19T04:20:11.460
> 
> 标签：c#, .net, windows, winapi

我有一个每小时在 Windows XP 机器上运行的应用程序。要正常运行，此应用程序需要解锁当前会话。所以我想知道是否有办法知道当前的 Windows 会话是否被 C# 和 .NET 3.5 锁定。

更新：应用程序无法监听 SessionNotification 事件。该应用程序可以随时启动并在完成后终止。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T04:33:30.013

这些未经我测试，但看起来很有趣。我会给他们一个测试，但我的 Visual Studio 目前似乎对我不太满意。

*   ~~[程序有什么方法可以知道计算机是否被锁定？](http://webcache.googleusercontent.com/search?q=cache:http://www.eggheadcafe.com/forumarchives/platformsdksecurity/Jan2006/post24990381.asp)（谷歌缓存链接，感谢@hometoast）~~（链接永久失效）
*   [这个线程中有很多信息](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework/topic52723.aspx)
*   如果您的应用程序可以一直运行并每小时“唤醒”一次，那么[SystemEvents.SessionSwitch](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.sessionswitch(VS.80).aspx)事件可能会帮助您，上面的线程中有一个示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T04:53:00.760

我曾经使用该[`GetForegroundWindow()`](http://msdn.microsoft.com/en-us/library/ms633505(VS.85).aspx)功能来确定屏幕保护程序是否正在运行。如果返回值为`NULL`，则屏幕保护程序（或者可能是锁定的工作站）处于活动状态。请注意，这是在早期的 Windows NT 中，没有记录到这样做，并且不能保证它今天仍然会做同样的事情。

查看 Win32 API 参考，您可能可以使用类似[`OpenInputDesktop()`](http://msdn.microsoft.com/en-us/library/ms684309(VS.85).aspx)获取`HDESK`当前活动桌面的方法。如果您无法获得桌面的句柄，或者它与您的线程桌面不同，那么您的应用程序正在非活动桌面中运行（并且工作站可能处于屏幕保护程序状态或被锁定）。不能保证这种方法会起作用，但它可能值得研究。

# jquery - 重复的正则表达式组

> ID：1016336
> 
> 赞同：1
> 
> 时间：2009-06-19T04:23:46.173
> 
> 标签：jquery, regex

我有一个这样的模式，它匹配多组值：

```
(((\w+) (\d+))+) 
```

我认为这将匹配：

```
one 1 two 2 three 3 four 4 five 5 
```

但是因为我不知道有多少重复，所以我不知道在输出中放什么。

例如，我需要将结果变成这样：

```
<span class="one">1</span>
<span class="two">2</span>
<span class="three">3</span>
<span class="four">4</span>
<span class="five">5</span> 
```

所以是这样的：

```
/(((\w+) (\d+))+)/ig, "<span class=\"$3\">$4</span>" 
```

行不通，因为我需要创建可变数量的跨度元素。

我在这里缺少什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T11:00:31.983

你缺少的是你的正则表达式匹配整个字符串，当你想一块一块地替换它时：

*   `/(\w+) (\d+)/`匹配`"five 5"`or `"one 1"`，但不匹配`"one 1two 2"`
*   `/(?:(\w+) (\d+))+/`匹配`"one 1"`or`"one 1two 2"`或`"one 1two 2three 3"`等

`+`匹配前面的模式 1 次或多次。

（旁注：`(?:...)`就像`(...)`除了它不将任何内容捕获到`$1`,`$2`等之外，它只是对事物进行分组。）

因此，对于您的问题，您只需要删除`+`：

```
/(\w+) (\d+)/ig, "<span class=\"$1\">$2</span>" 
```

（`/g`全局）标志将负责在每次模式匹配时重复您的替换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T04:32:40.760

我认为在这种情况下你只想用空格分割：

```
s = "one 1 two 2 three 3 four 4 five 5";

// Replace runs of whitespace with a single space, and trim...
s.replace(/\s+/g, ' ');
s.replace(/^\s+|\s+$/g, '')

// And split string into an array
var parts = "one 1 two 2 three 3 four 4 five 5".split(' ')

for (var i=0; i<parts.length; i++){

    // Get your pieces
    var name = parts.shift();
    var num = parseInt(parts.shift());

    // Create your span
    var span = $('<span></span>').attr('class', name).text(num);

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T06:36:18.480

不要尝试重复匹配，只需`(\w+) (\d+)`多次使用并重复替换（这是`g`全局替换标志的作用）。

注意：`i`您拥有的标志是多余的，因为 \w 包括两种情况，而 \d 只是数字。

假设页面的所有其他部分设置正确并且 $j 是 jQuery 对象，这将按需要工作：

```
var MyText = $j(something).text();

HtmlContent = MyText.replace( /(\w+) (\d+)/g , '<span class="$1">$2</span>' );

$j(something).html( HtmlContent ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T04:43:52.137

你的问题没有给出你的答案吗？我只是在使用 javascript 控制台进行测试：

```
>>> "one 1 two 2 three 3 four 4 five 5".replace(/(((\w+) (\d+))+)/ig, "<span class=\"$3\">$4</span>")
<span class="one">1</span> <span class="two">2</span> <span class="three">3</span> <span class="four">4</span> <span class="five">5</span>

>>> "one 1 two 2 three 3 four 4".replace(/(((\w+) (\d+))+)/ig, "<span class=\"$3\">$4</span>" )
<span class="one">1</span> <span class="two">2</span> <span class="three">3</span> <span class="four">4</span>

>>> "one 1 two 2 three 3".replace(/(((\w+) (\d+))+)/ig, "<span class=\"$3\">$4</span>" )
<span class="one">1</span> <span class="two">2</span> <span class="three">3</span>

>>> "one 1 two 2 three 3 foo five 5".replace(/(((\w+) (\d+))+)/ig, "<span class=\"$3\">$4</span>" )
<span class="one">1</span> <span class="two">2</span> <span class="three">3</span> foo <span class="five">5</span> 
```

它似乎完全符合您的要求。

编辑：下面的原始答案；我错过了 jquery 标签，认为这是一个正则表达式问题......

不要试图一次匹配它们；让 /g 处理...

```
bash$ echo "one 1 two 2 three 3 four 4 five 5" | \
      sed -e 's/\([[:alpha:]]\+\)\s*\([[:digit:]]\+\)\s*/<span class="\1">\2<\/span>\n/g' 
```

这使

```
<span class="one">1</span>
<span class="two">2</span>
<span class="three">3</span>
<span class="four">4</span>
<span class="five">5</span> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T04:46:10.703

以下在 VIM 中工作。

```
:%s/\(\w\+\) \(\d\+\)/<span class="\1">\2<\/span>\r/ig 
```

类似的应该在jquery中工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T04:47:04.930

为什么你不把它们放在一个数组中，这更有意义（如果你实际上是在用数字制作一堆跨度）：

```
var arr = ['one','two','three','four','five','six','seven','eight','nine','ten'];

$.each(arr, function(i, val) {
   var $span = $('<span></span>').attr('class', val).text(i+1);
   $('#someDiv').append($span);
}); 
```

# sql-server - 如何将新的查询脚本与 SSMS 加载项连接？

> ID：1016343
> 
> 赞同：3
> 
> 时间：2009-06-19T04:28:55.223
> 
> 标签：sql-server, add-in, ssms

我正在尝试创建一个 SSMS 加载项。我想做的一件事是创建一个新的查询窗口并以编程方式将其连接到服务器实例（在 SQL 登录的上下文中）。我可以很好地创建新的查询脚本窗口，但如果不先手动连接到其他东西（如对象资源管理器），我找不到如何连接它。

因此，换句话说，如果我手动将 Obect Explorer 连接到 SQL 实例，然后执行创建查询窗口的加载项的方法，我可以使用以下代码连接它：

```
ServiceCache.ScriptFactory.CreateNewBlankScript(
     Editors.ScriptType.Sql,
     ServiceCache.ScriptFactory.CurrentlyActiveWndConnectionInfo.UIConnectionInfo,
     null); 
```

但我不想依赖 CurrentActiveWndConnectionInfo.UIConnectionInfo 进行连接。我想以编程方式设置 SQL 登录用户名和密码。

有没有人有任何想法？

**编辑：**

我设法通过将最后一个参数设置为 System.Data.SqlClient.SqlConnection 的实例来连接查询窗口。但是，连接使用上次连接的登录的上下文，而不是我试图以编程方式设置的上下文。也就是说，它连接的用户是您在单击“新建查询”按钮并且没有连接对象资源管理器时在“连接对话框”中选择的用户。

**编辑2：**

我正在编写（或希望编写）一个加载项，以在针对我们的生产服务器运行时自动将 SQL 语句和执行结果发送到我们的案例跟踪系统。我的一个想法是删除写入权限并通过此加载项分配登录名，这也将强制用户输入 case # 如果它不存在则取消该语句。我刚刚想到的另一个想法是检查 ServiceCache.ScriptFactory.CurrentlyActiveWndConnectionInfo.UIConnectionInfo 中的服务器名称，并将其与我们的生产服务器列表进行比较。如果匹配且没有大小写 # 则取消查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-03T18:06:28.463

以防万一其他人正在寻找一种以编程方式创建和连接查询窗口的方法 - SSMS 2012 的简短示例：

```
UIConnectionInfo u =new UIConnectionInfo();

u.ServerName = "TestPC\\ServerInstance";

u.ServerType = new Guid("8c91a03d-f9b4-46c0-a305-b5dcc79ff907");

u.AuthenticationType = 0;//Use AuthenticationType = 1 for SQL Server Authentication

u.AdvancedOptions.Set("DATABASE", "AdventureWorks2012");

IScriptFactory scriptFactory = ServiceCache.ScriptFactory;

if(scriptFactory != null)
{
  scriptFactory.CreateNewBlankScript(ScriptType.Sql, u, null);
} 
```

此代码段将打开一个新的查询窗口，该窗口使用 Windows 身份验证连接到指定的服务器和数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T16:32:40.727

我还没有找到一种方法来做到这一点，因为似乎没有办法连接到连接对话框窗口。

你在做什么？

编辑：如果我理解正确，您想拦截正在运行的查询，如果它与生产服务器匹配，请取消它，否则将文本和结果发送到数据库？嗯......虽然这是可能的，但在背后是一个真正的主要痛苦，我不会为此使用加载项。加上可以禁用，卸载等加载项。您最好尝试在生产服务器上使用适当的安全设置来执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-15T01:53:26.313

我还没有尝试过，但不知道你是否尝试过。

```
Microsoft.SqlServer.Management.Smo.RegSvrEnum.UIConnectionInfo u = 
    new Microsoft.SqlServer.Management.Smo.RegSvrEnum.UIConnectionInfo(); 
```

应该允许您建立自己的连接。但就像我说的，我还没有测试过。您需要参考`Microsoft.SqlServer.RegSvrEnum.dll`.

让我知道它是否有效。

# xmpp - Jabber 使用随机名称自动登录

> ID：1016362
> 
> 赞同：2
> 
> 时间：2009-06-19T04:40:35.023
> 
> 标签：xmpp, ejabberd

我正在使用[JSJaC](http://blog.jwchat.org/jsjac/)和[ejabberd](http://www.ejabberd.im/)构建实时聊天。除了为所有网站访问者提供帐户“访客”之外，一切正常。如果两个访问者尝试同时进行实时聊天，则响应会变得混乱或第一个用户已注销。

我可以随机设置客人姓名，但我需要检查该姓名是否已注册或自动注册，并希望它之前没有注册过。我尝试将每个登录名分配给一个随机资源名称，但这仍然合并了对话。

简而言之，我正在寻找最简单的方法来允许多个匿名登录开始与 livechat 帐户的个人对话。如果实时聊天可以在主要实时聊天帐户处于聊天状态时轮询到不同的用户，那就更好了（但可选）。

该解决方案可以是基于 Web 客户端或服务器的，我不在乎，因为我控制了两者（并且 ejabberd 支持各种模块）。

顺便说一句，当我尝试自动注册注册帐户时，JSJaC simpleclient 演示返回：

```
An error occured:
Code: 409
Type: cancel
Condition: conflict 
```

我还没有确定这是否可以忽略或使用自定义客户端或服务器设置覆盖。我想我可以检测到这个错误并在没有自动注册的情况下重试，但我想听听更好/更简单的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T05:07:11.070

尝试在您的 ejabberd 服务器上启用[匿名登录模式？](https://support.process-one.net/doc/display/MESSENGER/Anonymous+users+support)然后您不必注册客户帐户，只需选择任何随机的用户名和密码，ejabberd 就会接受它们......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-11T17:00:54.577

我想你可以在 ejabberd 中使用外部身份验证我处于同样的情况：我希望匿名用户能够登录服务器，但一些特殊用户也能够登录以执行管理任务......所以我决定写一个 php 脚本作为 ejabberd 的身份验证处理程序。然后它将接受名称以 anon_* 开头的所有登录名，并针对数据库对其他用户进行身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-24T09:25:57.320

我们在一个项目中遇到了类似的问题——我们希望用户能够登录而无需任何帐户创建或冲突——自动注册对我们不起作用，因为名称可能会发生冲突。最后，我们在 ejabberd 中选择了带有 SASL 身份验证的匿名登录 - 它允许匿名登录和动态帐户创建，我相信这些帐户不会留在系统上（它们仅在连接打开时才有效），但是据我所知服务器将为用户生成一个随机 ID。

GUID JID 问题可能可以通过使用[昵称来解决](http://xmpp.org/extensions/xep-0172.html)

[设置 SASL](http://www.process-one.net/en/ejabberd/guide_en#saslanonymous)

[Ejabberd 支持页面 - SASL](https://support.process-one.net/doc/display/MESSENGER/Anonymous+users+support)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T02:55:31.783

如果您无法让 ejabberd 的匿名模式正常工作，您可以尝试为每个用户的基本名称创建一个[GUID](http://en.wikipedia.org/wiki/Guid)，并即时注册用户。您将需要一个定期脚本来从数据库中删除旧的未使用帐户。

# java - PrintServiceLookup.lookupDefaultPrintService() 返回 null

> ID：1016372
> 
> 赞同：4
> 
> 时间：2009-06-19T04:48:28.177
> 
> 标签：java, printing, applet

`PrintServiceLookup.lookupDefaultPrintService()`返回`NULL`，因为我安装了打印机并设置为默认打印机。

如果我在一个简单的程序中使用它，它可以正常工作，但是当我尝试在基于小程序的程序中使用它时，它会返回`NULL`.

请给我一些解决这个问题的好方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-10T10:37:09.630

为了访问打印机（或主机上的任何资源），必须对 applet 代码所在的 jar 文件进行签名，并且用户必须接受签名者作为受信任方。要对 jar 文件进行签名，请使用 jarsigner 程序，它是 JDK 的一部分。Jarsigner 使用自己的密钥库，因此如果您有自己的证书，则必须先将证书导入密钥库。它也可以生成证书，以防您没有任何其他证书来签署 jar 文件。

[jarsigner 工具的文档可以在这里找到。](http://download.oracle.com/javase/1.3/docs/tooldocs/win32/jarsigner.html)

请注意，较新的 Java 运行时确实会询问用户是否允许代码访问打印机，但我发现无论答案如何，未签名的 jar 文件中的代码都无法访问资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-15T11:45:22.800

此代码在具有 1.7.0_55 的 Windows 中的签名小程序中运行：

```
import javax.print.Doc;
import javax.print.DocFlavor;
import javax.print.DocPrintJob;
import javax.print.PrintService;
import javax.print.PrintServiceLookup;
import javax.print.SimpleDoc;
import javax.print.attribute.HashDocAttributeSet;
import javax.print.attribute.HashPrintRequestAttributeSet;

...

HashDocAttributeSet docAttr=new HashDocAttributeSet();
HashPrintRequestAttributeSet reqAttr=new HashPrintRequestAttributeSet();

try {
    PrintService pserv = PrintServiceLookup.lookupDefaultPrintService();
    if (pserv == null) {
        System.out.println("ERROR-01: no default print service");
    }
    System.out.println("Printer: " + pserv.getName());

    DocPrintJob job = pserv.createPrintJob();
    DocFlavor flavor = DocFlavor.BYTE_ARRAY.AUTOSENSE;
    String content = makeZplLabel();
    Doc doc = new SimpleDoc(content.getBytes(), flavor, docAttr);

    job.print(doc, reqAttr);

} catch (Exception e) {
    System.out.println("ERROR-02:" + e.getMessage());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T05:22:56.433

您必须首先更改 Java 小程序的安全设置。默认情况下，Java 小程序无法打印。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-27T21:00:10.410

确保 printer.conf 定义`<DefaultPrinter name>`而不是`<Printer name>`. JVM 似乎只能找到这样定义的默认打印机。

此代码段可以帮助快速验证它是否有效：

```
import javax.print.PrintServiceLookup;

public class checkDefaultPrinter {
    public static void main(String[] args) {
        System.out.println(PrintServiceLookup.lookupDefaultPrintService());
    }
} 
```

# php - 启动php，apache？

> ID：1016375
> 
> 赞同：1
> 
> 时间：2009-06-19T04:49:05.210
> 
> 标签：php, mysql, apache

我刚刚开始阅读有关 php 的内容，它需要我安装 php、apache 和 MySql 才能运行任何 php 脚本。任何人都可以建议我安装 php、apache 和 MySql 的最简单方法，以便我可以晒出那些 php 脚本。我已经尝试过 php.net 中的 zip 文件，是否需要离线运行脚本来练习脚本？我该怎么办？我觉得在同一个网站上给出的东西有点复杂，并且无法运行脚本。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T04:50:38.890

我假设您使用的是 Windows - 获取[wamp](http://www.wampserver.com/en/) - 它正是您需要的：

*   阿帕奇
*   MySQL
*   PHP

Wamp 带有一个漂亮的托盘控制器应用程序，您可以使用它来访问最常见的任务，例如重新启动服务、编辑配置等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T05:14:02.700

没有足够的代表发表评论，但想在 Artem 对 Wampserver 的推荐中添加一些内容。这是我在我的 Windows 机器上使用的，我发现它最好的一点是能够将多个版本的 apache、php 和 mysql 作为插件安装在一起，然后选择要运行的版本任何时候。它使我可以轻松模拟任何给定项目的最终托管环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T04:56:15.827

相当于 Artem 的帖子，只是不同的组织对其进行了不同的包装。还有我的偏好。它被称为[XAMPP](http://www.apachefriends.org/en/xampp.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T04:56:55.933

如果您使用的是 Windows，则可以安装[XAMPP](http://www.apachefriends.org/en/xampp.html)为您设置环境。然后你需要学习如何启动服务器（基本上是执行 XAMPP 控制面板程序），将你的 PHP 脚本复制到正确的目录中（对于 XAMPP，它是 C:/[xampp 安装目录]/htdocs） ，访问 MySQL 并创建必要的 MySQL 数据库（您可以通过包含的 PhpMyAdmin 访问 MySQL）。

您可能可以[参考这里的教程](http://www.youtube.com/watch?v=KWRB-maTVyM)（这是一个 YouTube 视频，顺便说一句）。

# python - 带有隐藏窗口的跨平台子进程

> ID：1016384
> 
> 赞同：38
> 
> 时间：2009-06-19T04:52:50.353
> 
> 标签：python, windows, linux, cross-platform, subprocess

我想在后台打开一个进程并与之交互，但是这个进程在Linux和Windows中都应该是不可见的。在 Windows 中，您必须使用 STARTUPINFO 做一些事情，而这在 Linux 中无效：

> ValueError: startupinfo 仅在 Windows 平台上受支持

有没有比为每个操作系统创建单独的 Popen 命令更简单的方法？

```
if os.name == 'nt':
    startupinfo = subprocess.STARTUPINFO()
    startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW
    proc = subprocess.Popen(command, startupinfo=startupinfo)
if os.name == 'posix':
    proc = subprocess.Popen(command) 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-19T06:48:07.477

你可以减少一行:)

```
startupinfo = None
if os.name == 'nt':
    startupinfo = subprocess.STARTUPINFO()
    startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW
proc = subprocess.Popen(command, startupinfo=startupinfo) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-08-09T18:49:16.710

请注意：对于**Python 2.7**，我必须使用`subprocess._subprocess.STARTF_USESHOWWINDOW`而不是`subprocess.STARTF_USESHOWWINDOW`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T05:00:22.640

我不确定你能比你所做的简单得多。您正在谈论优化可能 5 行代码。为了钱，我会继续我的项目，并接受这是跨平台开发的结果。如果你经常这样做，那么创建一个专门的类或函数来封装逻辑并导入它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T06:38:02.813

你可以把你的代码变成：

```
params = dict()

if os.name == 'nt':
    startupinfo = subprocess.STARTUPINFO()
    startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW
    params['startupinfo'] = startupinfo

proc = subprocess.Popen(command, **params) 
```

但这也好不到哪里去。

# javascript - 以椭圆旋转一组图像

> ID：1016397
> 
> 赞同：0
> 
> 时间：2009-06-19T04:58:47.977
> 
> 标签：javascript

如何在不使用 jquery 的情况下旋转椭圆中的一组图像？如何在某个中心（x，y）点获取椭圆上的每个点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T08:52:55.093

椭圆上以 (x,y) 为中心的任意点的坐标为 (x + a cos(c), y + b sin(c) )，其中 a 和 b 定义椭圆的大小，c 定义角度在 [0,2pi] 中。

对于 n 个图像，角度将采用 (2pi/n)i + delta 的形式，其中 i 在 [0,n] 中，并且 delta 从原始位置的移动，您将用于动画。

# asp.net-mvc - 在 IIS 中将不同的页面作为不同的域名提供服务（6 或 7）

> ID：1016399
> 
> 赞同：1
> 
> 时间：2009-06-19T04:59:00.003
> 
> 标签：asp.net-mvc, iis, networking, url-rewriting, dns

我有一个 ASP.Net MVC 应用程序，它为用户页面提供 URL，例如 -

www.myapp.com/user/rob/index,
www.myapp.com/user/rob/article/1

和

www.myapp.com/user/scott/index,
www.myapp.com/user/scott/article/1

现在我希望这个应用程序能够从外部向两个不同的域提供页面。像 -

www.RobWebSite.com/Index
www.RobWebSite.com/article/1

www.scottBlogSiteNoOne.com/Index
www.ScottBlogSiteNoOne.com/article/1

我需要设置什么样的设置/重定向/代理，因此当用户键入已发布的域名 (www.RobWebSite.com) 时，它会在内部转换为我的应用程序 (www.myapp.com/user/rob/)。我想保持浏览器中的 url 与他们键入的内容相同，而只是查询字符串参数发生变化。

谢谢和问候，
阿杰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T05:34:04.407

每个用户的域名都需要在其 DNS 中指向 myapp.com 的 CNAME 记录。（Google 使用 CNAME 记录将自定义域名指向 Blogger.com 博客，因此这似乎是一个不错的方法。）

然后您的代码需要查看 Request 对象以识别正在使用的域名并进行查找以查找该域属于哪个用户。这不会真正转化为 myapp.com/user/name/。它将使用域名来确定用户，而不是通常使用 MVC 进行的路由解析。

我不是 100% 确定 Request 对象会给你正确的域名。你必须尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T17:06:59.350

您也可以只设置您的代码，以便您的 url 指定相对路径而不是绝对 URL。这将使浏览器中的域名保持不变并提高性能。

# bash - bash 函数可以在不同的脚本中使用吗？

> ID：1016404
> 
> 赞同：41
> 
> 时间：2009-06-19T05:02:23.853
> 
> 标签：bash, function

我有一个要在不同脚本中引用和使用的函数。有没有办法做到这一点？我不想为不同的脚本重写相同的函数。谢谢。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-06-19T05:07:39.773

当然 - 在你的脚本中，你想使用这个函数，你可以写一个命令，比如

```
source function.sh 
```

这相当于`function.sh`在运行命令时将 的内容包含在文件中。请注意，`function.sh`需要在 ; 中的目录之一`$PATH`中 如果不是，则需要指定绝对路径。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-19T05:35:41.067

是的，您可以将所有功能本地化在一个（或多个）通用文件中。这正是我对所有实用程序函数所做的。我的主目录中有一个`utility.shinc`，我的所有程序都使用它：

```
. $HOME/utility.shinc 
```

它在当前 shell 的上下文中执行脚本。这很重要 - 如果您只是运行包含脚本，它将在子 shell 中运行，并且任何更改都不会传播到当前 shell。

您可以对脚本组执行相同的操作。如果它是“产品”的一部分，我倾向于将所有脚本以及任何包含的脚本放在一个 shell 目录中，以确保所有内容都本地化。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2017-09-04T12:40:22.727

是的你可以！在脚本中添加**源函数名称。**我更喜欢创建变量 eg.VAR=$(function_name)，如果你在 #!/bin/bash 之后添加源函数名，那么你的脚本首先执行导入的函数任务，然后是你当前的脚本任务，所以最好创建变量并在任何地方使用在脚本中。谢谢你..希望它对你有用:)

# ruby - Ruby访问嵌套函数中的外部变量

> ID：1016408
> 
> 赞同：42
> 
> 时间：2009-06-19T05:04:36.783
> 
> 标签：ruby, nested, scope

我相信对此有一个简单的答案；我似乎无法找到它。我在 Ruby 中创建了一个嵌套函数，但在从内部函数内部的外部函数访问变量时遇到了问题：

```
def foo(x)
  def bar
    puts x
  end
  bar
  42
end

foo(5) 
```

我得到：`NameError: undefined local variable or method`x' for main:Object`

类似的 Python 代码可以工作：

```
def foo(x):
  def bar():
    print x
  bar()
  return 42

foo(5) 
```

那么我如何在 Ruby 中做同样的事情呢？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-06-19T05:07:12.257

据我所知，在函数中定义命名函数不会让您访问任何局部变量。

你可以做的是使用 Proc：

```
def foo(x)
  bar = lambda do
    puts x
  end
  bar.call
  42
end

foo(5) 
```

# html - 在不影响另一个 html 表的情况下，将 css 用于 html 表的最快方法

> ID：1016409
> 
> 赞同：8
> 
> 时间：2009-06-19T05:05:01.183
> 
> 标签：html, css

我的 css 位于[http://sillybean.net/css/seaglass.css](http://sillybean.net/css/seaglass.css)，我想将此 css 仅用于一个 html 表，在同一页面上我有多个 html 表，所以我不想影响其他 html表。[在http://sillybean.net/css/seaglass.css](http://sillybean.net/css/seaglass.css)上进行较少修改的最快方法是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-19T05:07:33.473

您可以将一个类应用于您想要影响的表，然后在您的 CSS 中使用该类吗？

在您的 HTML 中，您可以输入：

```
<table class="mytable">
... CONTENT OF THE TABLE, AS NORMAL ...
</table> 
```

然后，将类选择器添加到您的 CSS 中：

```
table.mytable { border-collapse: collapse; border: 1px solid #839E99;
                background: #f1f8ee; font: .9em/1.2em Georgia, "Times New Roman", Times, serif; color: #033; }
.mytable caption { font-size: 1.3em; font-weight: bold; text-align: left; padding: 1em 4px; }
.mytable td,
.mytable th { padding: 3px 3px .75em 3px; line-height: 1.3em; }
.mytable th { background: #839E99; color: #fff; font-weight: bold; text-align: left; padding-right: .5em; vertical-align: top; }
.mytable thead th { background: #2C5755; text-align: center; }
.mytable .odd td { background: #DBE6DD; }
.mytable .odd th { background: #6E8D88; }
.mytable td a,
.mytable td a:link { color: #325C91; }
.mytable td a:visited { color: #466C8E; }
.mytable td a:hover,
.mytable td a:focus { color: #1E4C94; }
.mytable th a,
.mytable td a:active { color: #fff; }
.mytable tfoot th,
.mytable tfoot td { background: #2C5755; color: #fff; }
.mytable th + td { padding-left: .5em; } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T05:10:38.787

在您的 CSS 中定义一个 ID 或 CLASS 会影响相关表。

然后，在你的 HTML 代码中，说

```
<table id="theid"... /> 
```

或者

```
<table class="theclass" ... /> 
```

CSS ID 看起来像

```
#theid
{
  //attributes
} 
```

类看起来像：

```
.theclass
{
  //attributes
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T05:10:06.497

这正是 id 和 class 属性的用途。如果您无法更改标记（例如设置 myspace 的样式），则需要使用选择器来更精确地定位一个表。选择器的选择是您需要自己决定的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-15T18:46:28.240

对于多个表和类

**HTML 表格**

```
<table id="tableId1">
--Table Content--
</table>

<table id="tableId2">
--Table Content--
</table>

<table class="tableClass1">
--Table Content--
</table>

<table class="tableClass2">
--Table Content--
</table> 
```

**CSS 脚本**

```
#tableId1, #tableId2
{
  //attributes
}

.tableClass1, .tableClass2
{
  //attributes
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T05:13:41.593

下面是类选择器和标记，它们将设置第一个表的样式，而不是第二个表：

```
<style>
table.special { border: 1px solid #839E99; ... }
table.special caption { font-size: 1.3em; ... }
...
</style>
<table class="special">...</table>
<table>...</table> 
```

或者您可以以类似的方式使用 ID 选择器：

```
<style>
#my-special-table { border: 1px solid #839E99; ... }
#my-special-table caption { font-size: 1.3em; ... }
...
</style>
<table id="my-special-table">...</table>
<table>...</table> 
```

有时，一场宗教战争会爆发关于使用这两种方法中的哪一种。两者都可以满足您的需求。根据规范，您最多只能将给定 ID 放在 HTML 中的一个元素上（但大多数浏览器允许您打破该规则）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T05:08:58.167

将类名应用到要应用 css 的表上，其余的很好...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T05:42:21.480

虽然您应该向要影响的表添加一个类，但假设您只能修改 css。[在这种情况下，您可以使用selectors](http://www.w3.org/TR/css3-selectors/#nth-child-pseudo)变得非常漂亮。但并非所有[浏览器都支持](http://dev.l-c-n.com/CSS3-selectors/browser-support.php#pC)它们。您可以看到[CSS 2 选择器](http://www.w3.org/TR/CSS2/selector.html)不支持第 n 个子概念。否则，如果你有像这样的 html：

```
<html><head></head><body>
<table><tr><td>First</td></tr></table>
<table><tr><td>Second</td></tr></table>
<table><tr><td>Third</td></tr></table>
</body></html> 
```

您可以使用 CSS2 选择器定位第一个，但第二个和第三个只能使用 CSS3 选择器定位。

```
table:first-child td {background-color:red;} /* CSS2, pretty wide support */
table:nth-child(2) td {background-color:red;} /* CSS3, limited support */ 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-07-24T18:14:52.010

按类选择表格以设置所需表格的样式，例如，如果您有表格：

```
<table class="tableOne"></table>
<table class="tableTwo"></table> 
```

然后在 CSS 中，您将使用如下内容：

```
.classOne {
  /* do your stuff here*/
}

.classTwo {
  /* do your stuff here*/
} 
```

# sql - 如何在条件下查找 Sum(field) 即“从 sum(field) < 150 的表中选择 *”

> ID：1016419
> 
> 赞同：2
> 
> 时间：2009-06-19T05:09:32.283
> 
> 标签：sql, mysql

我必须只检索 size 字段的总和值为 <=150 的特定记录。我有如下表...

```
userid size
1       70
2      100   
3       50
4       25
5      120
6       90 
```

输出应该是...

```
userid size
1       70
3       50
4       25 
```

例如，如果我们添加 70,50,25，我们得到 145，即 <=150。

我将如何编写查询来完成此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T05:39:58.033

这是一个将产生上述结果的查询：

```
SELECT * FROM `users` u
WHERE (select sum(size) from `users` where size <= u.size order by size) < 150
ORDER BY userid 
```

但是，您描述的希望选择最适合给定尺寸的用户的问题是[装箱问题](http://en.wikipedia.org/wiki/Bin_packing_problem)。这是一个[NP-Hard](http://www.codinghorror.com/blog/archives/001187.html)问题，用 ANSI SQL 不容易解决。然而，上面似乎返回了正确的结果，但实际上它只是从最小的项目开始，并继续添加项目，直到 bin 满为止。

一个通用的、更有效的装箱算法是从最大的项目开始，然后继续添加适合的较小的项目。该算法将选择用户 5 和 4。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T05:13:31.280

您正在寻找的是一个[贪心算法。](http://en.wikipedia.org/wiki/Greedy_algorithm) 您不能用一条 SQL 语句真正做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T05:21:52.457

它类似于[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)。你肯定会进入指​​数时间......

> 有几种方法可以解决 N 中时间指数的子集总和。最简单的算法是循环遍历 N 个数字的所有子集，并检查每个子集的总和是否为正确的数字。运行时间为 O(2^N*N)，因为有 2N 个子集，为了检查每个子集，我们最多需要对 N 个元素求和。

除非您可以将问题限制在较小的子集上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T05:27:51.060

根据您的定义，您可以获得以下任何表格：

```
userid size    userid size
1       70     2      100   

userid size    userid size
3       50     4       25

userid size    userid size
5      120     6       90

userid size    userid size
1       70     2      100   
3       50     3       50

userid size    userid size
1       70     2      100   
4       25     4       25

userid size    userid size
1       70     4       25
3       50     6       90
4       25

userid size    userid size
4       25     3       50
5      120     6       90 
```

SQL 不擅长猜测。你的意思是说你想要最多的用户总大小在某个限制之下？您需要创建一个包含所有用户组合的临时表，然后选择总大小小于限制的那些，然后选择用户最多的一个，可能还有最低的用户 ID 或其他东西。无论哪种方式，由于第一步，它都不会很快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T12:44:29.807

但是你想最大化结果的数量还是最小化或者你根本不在乎？前两种情况是约束优化，应该有使用 SQL 的解决方案，后者（如上所述）需要贪婪策略。

# iphone - 在游戏循环中停止并自然删除精灵

> ID：1016427
> 
> 赞同：0
> 
> 时间：2009-06-19T05:12:24.510
> 
> 标签：iphone, objective-c, cocos2d-iphone

我正在用 cocos2d 制作游戏，我有一堆想要删除的精灵。例如，我可能在屏幕上有一堆角色，但是当我的游戏结束时，我想清理它们。现在我已经创建了一个特殊效果（粒子系统）来分散注意力，但是因为它是透明的并且不会覆盖所有的屏幕，所以当我将它们从图层中移除时，你可以看到并看到精灵消失。

此外，由于指令对用户的执行速度如此之快，它看起来好像精灵在粒子效果开始之前就消失了！

对我的 2 个问题有什么建议吗？谢谢。

```
NSMutableArray *toRemove = [[NSMutableArray alloc] init]; // array of sprites that I collect to remove

spriteCount = 0;
    if([self findAllSprites:parent forRemoval:toRemove] > 0){ // is there is at least one sprite to delete. If not then don't do anything
        [self specialEffect]; // runs for maybe 3 seconds. 
                    // how can I stall here so that the sprites aren't removed "instantaneously"?
        for (Character* aCharacter in toRemove) {
            [aCharacter.parent remove:aCharacter];      
        } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T05:20:10.740

您需要在线程中执行“特殊效果”，以便它*与*您的精灵删除一起运行。查找 NSThread 以获取更多信息，但这将使您能够同步两个进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:19:33.077

您可以使用 performSelector:withObject:afterDelay: 延迟删除操作。例如：

```
 NSMutableArray *toRemove = [[NSMutableArray alloc] init]; // array of sprites that I collect to remove
    spriteCount = 0;
    if([self findAllSprites:parent forRemoval:toRemove] > 0){ // is there is at least one sprite to delete. If not then don't do anything
        [self specialEffect]; // runs for maybe 3 seconds. 
        [self performSelector:@selector(removeSprites:) withObject: toRemove afterDelay:1.0];
    }
    [toRemove release];

- (void) removeSprites: (NSArray*) toRemove
{
    for (Character* aCharacter in toRemove) {
        [aCharacter.parent remove:aCharacter];          
    }
} 
```

请注意 performSelector:withObject:afterDelay: 将保留 toRemove 对象并使其保持活动状态，直到它调用 removeSprites，因此您不必对 toRemove 执行任何特殊操作（除非您仍然需要释放它，因为您拥有它以及）。

# c# - 返回大量数据的Web服务界面设计

> ID：1016435
> 
> 赞同：0
> 
> 时间：2009-06-19T05:17:37.563
> 
> 标签：c#, web-services, wcf

我正在设计一个返回所有订单状态的WCF接口（订单数据结构包括两个成员，一个字符串类型ID和一个枚举订单状态，设计为DataContract），订单总数非常大，大约10M。如果客户端调用此接口 API 以获取所有订单状态并频繁调用此 API，我担心流量和对服务器端的影响。

有什么建议吗？

我正在使用 VSTS 2008 + C# + .Net 3.5 + WCF。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T05:34:07.447

我会支持 ozczecho - 你为什么要返回 1000 万条记录？您的客户真的想要筛选 1000 万个订单吗？我对此表示高度怀疑......

限制数量 - 例如日期范围（从 1Q/09 开始的所有订单）或任何其他标准。仅仅因为您可以返回 10M 行并不意味着它真的是一个好主意。

此外，与 SQL Server 一起，您可以轻松实现分页，例如，您可以让您的 WCF 服务发回前 100 行，并发回一个指示还有更多行的标志，然后让您的客户端请求第 101 到 200 行等。它需要一点逻辑，但它会使沟通变得更容易（和更快）！

此外，在 WCF 中，您必须定义最大消息大小 - 它们通常为 64K。这样做的原因是，在能够传输之前，需要将消息完整地组装在内存中。想象一下，您有 50 个客户端访问您的服务器 - 您可以真正为服务器上的“消息组装”留出多少内存？

马克

**更新：**
在服务中实现分页的一种方法是通过如下调用：

```
[OperationContract]
public List<Orders> GetOrders(string searchCriteria, string sortExpression, 
                              int skipFirstRows, int takeRows) 
```

这是受到 LINQ 引入的 .Skip() 和 .Take() 扩展方法的启发。

在这种情况下，您可以调用 GetOrders 并定义一些搜索条件（也可以是一个类，而不仅仅是一个字符串）来匹配您的订单，您可以通过指定来定义如何对订单进行排序`sortExpression`，然后告诉服务您想跳过前 n 行，然后取 x 行。

于是打了个电话

```
List<Orders> result = GetOrders(criteria, sort, 0, 50) 
```

将获取前 50 行。完成后，您可以再次调用：

```
List<Orders> result = GetOrders(criteria, sort, 50, 50) 
```

现在您将跳过前 50 行（您已经显示/报告过），然后选择接下来的 50 行（第 51-100 行）。

当然，如果后端的 WCF 服务使用 LINQ，则可以将其直接转换为对 LINQ 查询的 .Skip() 和 .Take() 调用！:-)

**更新 2：**
您是否使用 SQL Server 2005 或更高版本？查看公用表表达式 (CTE)，它基本上是 LINQ 的基础。这允许您在数据上定义“虚拟”视图并仅选择数据集的某个部分。

在此处查看更多信息：

*   [来自罗拉的 4 个人](http://www.4guysfromrolla.com/webtech/071906-1.shtml)
*   [简单的谈话](http://www.simple-talk.com/sql/sql-server-2005/sql-server-2005-common-table-expressions/)
*   [Troy DeMonbreun 的博客文章](http://blog.troyd.net/Use+A+Common+Table+Expression+Along+With+ROWNUMBER+To+Paginate+Records+In+Your+SQL+Server+Queries.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T05:19:42.240

*   不要返回所有 10m 记录。
*   使用分页技术...

# sql-server - Microsoft SQL Server“Express”版本是否可以免费开发？

> ID：1016436
> 
> 赞同：6
> 
> 时间：2009-06-19T05:18:40.197
> 
> 标签：sql-server, sql-server-express

我可以在 Microsoft SQL Server 2005/2008 Express 版数据库上免费开发软件吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T05:20:20.727

是的你可以。

但 Express 版本几乎没有限制

1.  SQL Server 一次只使用一个 CPU
2.  最大内存为 1GB
3.  数据库大小限制为 4GB

您可以重新分发 SQL Server，但您必须在 Microsoft 注册。

**更新 - SQL Server 2008 R2**

数据库大小限制为 10GB

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T05:27:18.173

是的，这是一个相关的[常见问题](http://www.microsoft.com/express/support/faq/)。

您可以自由地在商业上重新分发您的应用程序...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T05:29:39.777

是的，SQL Server Express 可以免费开发、免费使用、免费发送给您的客户 - 全面免费！:-)

除了 MicTech 的限制列表之外，SQL Server Express（目前）仅支持 32 位。

至于数据库的 4 GB 限制，这是针对每个数据库的，因此您可以在同一台机器上轻松地在 SQL Server Express 中拥有多个数据库 - 每个数据库的大小最多为 4 GB。而在 SQL Server Express 2008 中，存储在 FILESTREAM 文件组（存储在磁盘上的 BLOB）中的数据不考虑此限制。

马克

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T05:21:11.130

错误答案：据我所知，只要您不以商业方式重新分发代码，您就可以在任何 Microsoft Express Edition 中自由开发。

编辑：我发誓我不久前读过一份许可证，上面说你不能。他们一定是在我身上改变了它，或者我正在考虑我的学生版的许可证。对于那个很抱歉。

另一个编辑：只是澄清一下，我原来的答案是完全错误的，我把我的 MS 许可证弄糊涂了。据我昨晚阅读许可证所了解的，您可以使用 Microsoft Express Edition 软件进行开发。

# java - 在 Java 字符串中查找标记

> ID：1016439
> 
> 赞同：3
> 
> 时间：2009-06-19T05:20:01.630
> 
> 标签：java, string

有没有一种很好的方法来提取以预定义字符串开头并以预定义字符串结尾的标记？

例如，假设开始字符串是“[”，结束字符串是“]”。如果我有以下字符串：

“你好[世界]这[[是]我”

输出应该是：

令牌[0] =“世界”

令牌[1] =“[是”

（注意：第二个标记中有一个“开始”字符串）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T05:58:34.483

我认为您可以使用[StringUtils](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html)中存在的[Apache Commons Lang](http://commons.apache.org/lang/)功能：

```
substringsBetween(java.lang.String str,
                  java.lang.String open,
                  java.lang.String close) 
```

API 文档说：

> 在字符串中搜索由开始和结束标记分隔的子字符串，返回数组中所有匹配的子字符串。

Commons Lang substringsBetween API 可以在这里找到：

[http://commons.apache.org/lang/apidocs/org/apache/commons/lang/StringUtils.html#substringsBetween(java.lang.String,%20java.lang.String,%20java.lang.String)](http://commons.apache.org/lang/apidocs/org/apache/commons/lang/StringUtils.html#substringsBetween(java.lang.String,%20java.lang.String,%20java.lang.String))

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T05:43:45.563

这是我避免依赖公共语言的方法。

```
public static String escapeRegexp(String regexp){
    String specChars = "\\$.*+?|()[]{}^";
    String result = regexp;
    for (int i=0;i<specChars.length();i++){
        Character curChar = specChars.charAt(i);
        result = result.replaceAll(
            "\\"+curChar,
            "\\\\" + (i<2?"\\":"") + curChar); // \ and $ must have special treatment
    }
    return result;
}

public static List<String> findGroup(String content, String pattern, int group) {
    Pattern p = Pattern.compile(pattern);
    Matcher m = p.matcher(content);
    List<String> result = new ArrayList<String>();
    while (m.find()) {
        result.add(m.group(group));
    }
    return result;
}

public static List<String> tokenize(String content, String firstToken, String lastToken){
    String regexp = lastToken.length()>1
                    ?escapeRegexp(firstToken) + "(.*?)"+ escapeRegexp(lastToken)
                    :escapeRegexp(firstToken) + "([^"+lastToken+"]*)"+ escapeRegexp(lastToken);
    return findGroup(content, regexp, 1);
} 
```

像这样使用它：

```
String content = "hello[world]this[[is]me";
List<String> tokens = tokenize(content,"[","]"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T05:25:30.453

[StringTokenizer](http://java.sun.com/j2se/1.4.2/docs/api/java/util/StringTokenizer.html)？将搜索字符串设置为“[]”并将“包含令牌”标志设置为`false`，我想你已经设置好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T05:28:52.213

普通字符串标记器无法满足他的要求，但您必须对其进行调整或编写自己的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T05:32:20.943

有一种方法可以做到这一点。它不是特别漂亮。它涉及的是逐个字符地遍历字符串。当您到达“[”时，您开始将字符放入新标记中。当你到达一个“]”时，你停下来。这最好使用数据结构而不是数组来完成，因为数组是静态长度的。

另一种可能的解决方案是将正则表达式用于字符串的拆分拆分方法。我唯一的问题是想出一个正则表达式，它会按照你想要的方式拆分。我能想到的是 {]string of characters[) XOR (string of characters[) XOR (]string of characters) 每组括号表示不同的正则表达式。您应该按此顺序评估它们，以免意外删除您想要的任何内容。我不熟悉 Java 中的正则表达式，所以我使用“字符串”来表示括号之间有字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T05:41:33.663

尝试像这样的正则表达式：

```
(.*?\[(.*?)\]) 
```

第二个捕获应该包含 [] 集之间的所有信息。但是，如果字符串包含嵌套的 []，这将无法正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T05:44:38.013

StringTokenizer 不会因指定的行为而削减它。你需要自己的方法。就像是：

```
public List extractTokens(String txt, String str, String end) {
    int                      so=0,eo;
    List                     lst=new ArrayList();

    while(so<txt.length() && (so=txt.indexOf(str,so))!=-1) {
        so+=str.length();
        if(so<txt.length() && (eo=txt.indexOf(end,so))!=-1) {
            lst.add(txt.substring(so,eo);
            so=eo+end.length();
            }
        }
    return lst;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T20:59:17.180

正则表达式`\\[[\\[\\w]+\\]`给了我们 [world] 和 [[is]

# rdbms - 关于 RDBMS 的一些基本问题

> ID：1016444
> 
> 赞同：0
> 
> 时间：2009-06-19T05:20:44.360
> 
> 标签：rdbms

我浏览过 Date 和 Silberschatz，但似乎找不到我这些具体问题的答案。

1.  如果 2 个数据库用户发出查询——比如，'select * from AVERYBIGTABLE;' -- 查询的结果一般会存储在哪里...即，与结果集的大小无关？

    一种。在 DBMS 服务器的操作系统管理的物理/虚拟内存中？

    湾。在 DBMS 管理的临时文件中？

2.  每个连接都维护查询结果集吗？

3.  如果查询结果集确实是每个连接都维护的，那么如果连接池有效（通过位于 DBMS 上方的一层代码）怎么办？那么，不是每个查询（而不是每个连接）都维护结果集吗？

4.  如果数据库在其用户同时发出选择查询时实时更改，那么查询发出者已经执行但尚未（完全）“消费”的查询会发生什么？例如，假设结果集有 50,000 行；用户当前在第 100 次迭代，当另一个用户并行执行插入/删除时，如果 DBMS 的任何用户重新发出较早的查询，它将导致多于/少于 50,000 行？

5.  另一方面，如果数据库不会实时更改，如果 2 个用户发出相同的查询，每个查询都具有相同但非常大的结果集，DBMS 是否会维护 2 个相同的结果集副本，还是只有一个共享副本？

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T05:34:52.563

您在 Date 等中找不到它的原因是因为它们可能会在 DBMS 产品之间发生变化，关系模型理论中没有关于池连接到数据库或如何维护查询的结果集（如缓存等）。唯一被部分覆盖的点是 4 - 读取级别将发挥作用（例如读取未提交），但这仅适用于生成结果集之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:03:16.037

其中一些可能特定于 Oracle。

1.  查询的完整结果不需要复制每个用户都会获得一个游标（如指针），该游标维护哪些行已被检索，哪些行仍需要获取。数据库将缓存尽可能多的数据，因为它从表中读取数据。与两个用户相同的主体在文件上具有只读文件句柄。

2.  每个连接都会维护游标，下一行的数据可能已经在内存中，也可能不在内存中。

3.  大多数连接是单线程的，一次只有一个客户端可以使用一个连接。如果同一查询在同一连接上执行两次，则光标位置将被重置。

4.  如果游标在正在更新的表上打开，则旧行将被复制到单独的空间（Oracle 中的撤消）并在游标的生命周期内维护，或者至少直到它用完空间来维护它。（Oracle 会给出快照太旧的错误）

5.  数据库永远不会复制存储在缓存中的数据，在 Oracle 的游标共享的情况下，只有一个缓存游标，每个客户端游标只需保持其在缓存游标中的位置。

[Oracle 数据库概念](http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14220/toc.htm)

问题 1、2、5 见 8 记忆

见 13 数据并发和一致性（问题 3、4）

# php - 生成用户名

> ID：1016449
> 
> 赞同：2
> 
> 时间：2009-06-19T05:22:00.583
> 
> 标签：php, facebook

我们有一个社交网站，并希望集成 facebook connect 以节省用户需要选择性别等的时间，并且还使用 FB Connect 作为跳过注册我们的方法。

我们网站上的每个用户都有一个唯一的用户名，他们使用的用户名......我无法理解的一件事是，如果有人使用 Facebook 连接登录，我如何为他们分配用户名？我的意思是，如果他们不想使用他们的真实姓名怎么办？（假设我会使用他们的名字姓氏，如果它已经存在，则在其后面添加一个数字。即：johnsmith 或 johnsmith1 等）

也许我很困惑，或者遗漏了什么……那么我如何生成用户名？

我的 facebook 连接按钮正在工作，当他们登录时它会弹出一大堆朋友的 id...

那么有没有好的非 facebook 制作的代码示例？他们拥有的跑步者应用程序一团糟......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T05:55:43.193

请参阅[Facebook Connect 文档](http://wiki.developers.facebook.com/index.php/Facebook_Connect)，尤其是[如何编写一个好的 Connect 应用程序](http://wiki.developers.facebook.com/index.php/How_To_Write_A_Good_Connect_App)和[链接帐户和寻找朋友。](http://wiki.developers.facebook.com/index.php/Account_Linking)

据我了解，Facebook Connect 就像 stackoverflow 使用的 OpenID。链接是使用电子邮件地址的哈希完成的，但是对于您的应用程序的用户名，您可以选择任何您想要的。您可以模仿 stackoverflow 的功能，并将其暂时设置为“未知（Facebook）”，直到用户选择一个唯一的用户名。用户可以继续使用 Connect 重新登录到您的站点，因此她可以永远保持“未知 (Facebook)”，有些人在此站点上也这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-22T20:33:51.537

我认为您可以使用从 Facebook 收到的电子邮件地址；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T00:05:55.940

您遇到的问题似乎是您要生成的这个用户名在您的系统中必须是唯一的。如果您也执行 stackoverflow 所做的操作并且没有唯一的用户名，而是使用带有一些随机字符串前缀的“显示名称”，那么遵循 Mike 的想法就可以了。例如 /users/xxxxxx/用户名

如果您正在寻找更像 twitter 的东西，其中用户名是唯一的并且没有人可以拥有相同的用户名，那么您将不得不在 Facebook Connect 过程中提示用户并要求用户选择一个用户名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T09:13:48.867

Facebook 允许用户拥有一个用户名（即对于拥有像 facebook.com/xxx 这样的个人资料链接的用户）。如果您查询 Facebook API，如果用户有用户名，您可以轻松地从那里获取用户名。否则，要求用户创建自己的用户名。

查看我的 FB 个人资料的查询：http: [//graph.facebook.com/60506094](http://graph.facebook.com/60506094) 注意到“用户名”字段了吗？

# blackberry - 在黑莓上：在没有 J2ME 的情况下在应用程序中根据用户操作拨打电话？

> ID：1016450
> 
> 赞同：0
> 
> 时间：2009-06-19T05:22:43.187
> 
> 标签：blackberry, phone-call

有没有办法在使用浏览器应用程序开发的应用程序中拨打电话？（例如，使用类似于 'mailto:user@example.com' 的协议的链接，但这会拨打电话而不是发送邮件。）

如果没有，是否可以使用快速应用程序开发拨打电话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T13:20:42.073

如果这是一个托管在浏览器中的应用程序，Blackberry 会遵守 WAP 对电话号码进行编码的约定。

下面是一个示例片段，用于显示可通过 Blackberry 设备调用的号码：

> <a href='wtai://wp/mc;5551231367' title='呼叫'>555.123.1367</a>

我已经使用这种方法一段时间了，它对我有用。当用户单击该链接时，操作系统会弹出一个对话框，询问您是否要拨打此号码。

**附加信息**
我还建议查看 Blackberry 的有关开发的附加资源。由于与 iPhone/Android 相比，当前的浏览器仍处于石器时代，因此值得一试。 [http://na.blackberry.com/eng/support/docs/subcategories/?userType=21&category=BlackBerry+Browser](http://na.blackberry.com/eng/support/docs/subcategories/?userType=21&category=BlackBerry+Browser)

# c++ - 将 _HAS_ITERATOR_DEBUGGING 设置为 0

> ID：1016463
> 
> 赞同：2
> 
> 时间：2009-06-19T05:27:51.467
> 
> 标签：c++

如何将 _HAS_ITERATOR_DEBUGGING 设置为 0

我尝试在 main.cpp 的开头使用 #define _HAS_ITERATOR_DEBUGGING 0 设置我尝试设置预处理器定义

:(但没有成功

提前致谢

乌代

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T05:56:08.450

您需要在包含任何标题之前定义它。
另请注意，如果您使用的是预编译头文件，

```
#define _HAS_ITERATOR_DEBUGGING 0
#include <stdafx.h> 
```

（其中 stdafx.h 是预编译头文件）

不会*工作*。预编译的头文件必须是文件中的第一个东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:12:45.787

对不起这是我的错

我必须在预处理器定义中写这个 __HAS __ITERATOR __DEBUGGING=0; __SECURE_SCL=0;

不是

__HAS __ITERATOR __DEBUGGING 0; __SECURE _SCL 0;

# .net - 从 wsdl 创建代理时出错

> ID：1016464
> 
> 赞同：0
> 
> 时间：2009-06-19T05:28:15.117
> 
> 标签：.net, web-services

我正在使用 .net 2.0 客户端从 wsdl 文件创建代理。此 wsdl 包含其他 xsd 文件中的某些类型。

当我创建代理时，会创建 xsd 文档中指定的类型，即使它们在 wsdl 中被引用。我尝试了其他一些客户端，例如 Soap UI、java。他们都工作正常。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-29T00:04:09.327

在与 Microsoft 支持人员交谈后，他们说这在 .net 2.0 中是不可能的，要么我们必须使用 wcf，要么创建一个包含所有类型的整体 wsdl。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T05:43:57.483

请提供一个精简的示例（仅几行 wsdl 和几行重现问题的 xsd）。

要回答这个问题，我们需要查看实际的类型定义以及它们是如何包含在 wsdl 中的。

我经常发现将示例简化为仅是基本要素会暴露问题。

# php - MySQL 或 SQL Server 更适合企业应用程序？

> ID：1016466
> 
> 赞同：1
> 
> 时间：2009-06-19T05:28:35.893
> 
> 标签：php, mysql, sql-server

我正在使用 PHP 开发一个大型应用程序。MySQL 或 SQL Server 是最好用的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T05:55:39.823

两者都不。使用 PostgreSQL。:)

不过老实说，PostgreSQL 的扩展性比 MySQL 好得多。我不知道您所说的“企业”是什么意思，但正如您所说，我认为缩放对于“大型”Web 应用程序很重要，而 PostgreSQL 在这方面做得很好。MySQL 无法处理太多的并发连接。（尽管如果这对您来说不是问题，请使用 MySQL 以方便使用。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T05:29:21.120

MySQL 和 PHP 可以很好地协同工作。我会推荐这种组合。

我宁愿选择开源解决方案，也不愿依赖 MS。也就是说，如果需要，您也可以使用 PostgreSQL，或者您的需求使您朝着它前进。我们需要更多细节来了解您真正需要什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T05:40:33.603

虽然这有点主观，但我建议使用 MySQL。

我之所以这么说是因为传统上你会看到人们使用 LAMP 设置。LAMP 当然是 Linux + Apache + MySQL + PHP

PHP 有一些很棒的内置功能来处理 MySQL 数据库，因此它可能对您来说更容易。然后，您还可以使用 PhpMyAdmin 将 Web 界面绑定到您的数据库进行一些基于 Web 的工作

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T07:05:45.140

使用您和您的团队在开发和管理方面**最有经验的那个。**

如果你从头开始，我会选择*PostgreSQL*。

在您的选择之间，我会选择*SQL Server*，特别是如果您在 Windows 环境中工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T11:04:41.037

MySQL 肯定更适合与 PHP 一起使用。但是 MS 正在努力在 Windows 平台上更好地支持 PHP。

SQL Server 绝对是大型企业解决方案的更好选择，因为它有更好的集群和管理支持。我们出于成本原因使用 MySQL，但我真的想要一些更简单的管理和集群支持。

另一方面，它就像计算机一样：您需要比较许多功能是否适合您的需求 - 以及您的钱包。

如果您正在进行单人表演：远离 SQL Server。它只适用于企业。以 MySQL 或 PostgreSQL 为例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T06:20:35.913

这将取决于您的应用程序的需求。我对各种 SQL 引擎之间的差异没有特别深入的研究，但据我所知，MySQL 对于 SELECT 查询更快（如果您有一个主要是只读类型的应用程序）。另一方面，MSSQL 和 PostgreSQL 都对事务有更好的支持，如果你有大量的插入/更新发生，也许还有更好的性能。此外，据说 MSSQL 和 PostgreSQL 可以更好地扩展，但有各种成功的应用程序似乎可以很好地使用 MySQL（例如 Facebook 和 Flickr）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T07:12:03.753

MySQL 和 SQL Server Express 可免费用于生产。在我看来，最好的建议是尝试它们并自己决定。许多人可以使用轻量级 RDBMS 过得很愉快，其中 MySQL/Express 之类的解决方案可能是合适的。

从纯粹的技术角度来看，所有主要的 RDBMS 供应商（Oracle、Sybase、DB2、SQL Server 等）都比 MySQL 当前或在可预见的将来可以合理预期的能力要强得多。

这并不*意味着*您不应该将 MySQL 用于特定工作。一个很好的类比是继续使用多年前发布的 Microsoft Office 版本。对于大多数人来说，旧版本可以满足他们想要的一切，即使新版本“更好”并且具有更多功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T06:06:29.777

对于大多数 IT 主管来说，一个重大决定将是您可以在您所在的地区/在线/已经拥有的内部获得最好的支持，以及您可以获得最长的正常运行时间。持续成本通常高于部署成本，因此可能不值得担心许可证成本；除非您使用 ia64 或更好的类型系统，否则当 CPU 数量开始使 SQL 看起来非常昂贵时。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T07:27:47.620

这就像决定要买什么电脑一样，无论您选择什么品牌，它们现在都几乎相同。数据库几乎相同，它们都支持轻量级 Web 应用程序所需的大部分内容。

到目前为止，我已经将 MySQL 用于我所有的 php 应用程序，并且没有任何问题。我曾多次想测试 PostgreSQL，但一直没有尝试过，但我听说过关于它的好消息。但是我从不接触MS产品，所以没有意见（不是我过敏，我只是小气。）。

# c# - 如何比较IP地址

> ID：1016471
> 
> 赞同：1
> 
> 时间：2009-06-19T05:30:37.250
> 
> 标签：c#, sockets, ip-address

如何将存储在 Ip[0] 数组中的 IP 地址与远程端点进行比较？请帮我。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T05:42:18.797

像这样的东西应该工作......

```
var ips = new[] { IPAddress.Parse( "127.0.0.1"),
                   IPAddress.Parse( "192.168.1.1"),
                   IPAddress.Parse( "10.0.0.1" ) };

var ep = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 0);

if (ips[0].Equals(ep.Address))
{
    Console.WriteLine("Equal!");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T05:38:00.783

我假设您已通过以下方式检索了 IP 地址

> ```
> System.Net.EndPoint ep = client.Client.RemoteEndPoint;
> System.Net.IPEndPoint ip = (System.Net.IPEndPoint)ep; 
> ```

如果是这种情况，您可以通过比较

> ```
> System.Net.IPEndPoint ip = (System.Net.IPEndPoint)ep;
> ip.ToString();
> if(Ip[0] == ip.toString()); 
> ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T06:14:46.640

所有上述变体都可以使用，但这里没有提到另一个选项：使用 IpAddress GetAddressBytes 方法以字节形式获取地址并进行比较。如果您需要进行其他处理（例如确定 Ip 是否属于 IP 类或类似的东西），这可能很有用..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T05:35:31.720

那么你可以得到它们： ToString() 然后比较它们。或者，您可以遍历 IPV4 ip 拥有的 4 个数字，并进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-28T20:53:12.837

您可以使用此类来扩展 IpAddress ：

[http://www.codeproject.com/Articles/26550/Extending-the-IPAddress-object-to-allow-relative-c](http://www.codeproject.com/Articles/26550/Extending-the-IPAddress-object-to-allow-relative-c)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-19T05:36:54.747

只需比较结构的每个成员。

# testing - Webkit 浏览器和自动化

> ID：1016472
> 
> 赞同：4
> 
> 时间：2009-06-19T05:31:09.887
> 
> 标签：testing, browser, webkit, automation

有没有人遇到过用于 Webkit 浏览器测试自动化的开源工具/框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T06:17:57.370

有（未尝试过）[WebAii 自动化框架](http://www.artoftest.com/products/webaii.aspx)，其中[当前的 Beta 2.0.0.1](http://www.artoftest.com/community/blogs/09-03-25/WebAii_2_0_Beta_Released.aspx)在 Windows 上添加了 Safari 3 支持（它是免费的，但我不认为它是开源的）。

如果你想自己做：

在 Apple 上，您应该能够编写 AppleScript 或从

MAC OS X > 10.4：有[**Automator**](http://en.wikipedia.org/wiki/Automator_(software))

在 Windows 上，您可能会考虑使用[**P/Invoke**](http://msdn.microsoft.com/en-us/library/aa446536.aspx)并查看 WebKitTools 中的[WinLauncher](http://trac.webkit.org/browser/trunk/WebKitTools/WinLauncher)工具

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-10T22:22:16.890

哪个WebKit？Selenium 似乎有几个基于 WebKit 的浏览器的驱动程序。

WebKit 本身有一个测试套件，由每个平台实现，WebKit 文档将其称为[DRT 或 DumpRenderTree](http://trac.webkit.org/wiki/Writing%20Layout%20Tests%20for%20DumpRenderTree)（另请参见 LayoutTestController）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T05:44:39.447

我还没有看到运行测试的框架，但如果你正在寻找输入来测试，除了传统的[酸测试之外，还有 Ian Hickson 的](http://www.acidtests.org/)[adhoc](http://hixie.ch/tests/adhoc/)和[evil](http://hixie.ch/tests/evil/)测试套件。

# ruby-on-rails - 每个 http 请求都会调用 environment.rb 吗？

> ID：1016473
> 
> 赞同：1
> 
> 时间：2009-06-19T05:31:12.803
> 
> 标签：ruby-on-rails, initialization, environment-variables

我想知道我应该使用什么文件来确保我的初始化代码只会在应用程序启动时执行一次。environment.rb 是要使用的正确文件，还是会在每个 http 请求上调用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T05:52:26.707

`environment.rb`仅在应用程序首次启动时加载。对文件的后续更改`environment.rb`需要重新启动。你只想执行一次什么样的代码？

您可能想通读 Ruby on Rails[配置 Rails 应用程序](http://guides.rubyonrails.org/configuring.html)指南，其中讨论了放置初始化代码的不同位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T12:03:57.440

查看 config/initializers 以获取推荐的位置自定义启动代码。

`Rails::Initializer.run`除非您明确添加或更改在块中定义的项目，否则请尽可能保留 environment.rb 。

如果您想在各种环境中管理自定义设置，例如，您希望生产和开发具有不同的设置，那么`config/environments`目录应该是您的第一个调用端口。

# c++ - 为什么 C++ 允许将算术或枚举值隐式转换为布尔值？

> ID：1016496
> 
> 赞同：2
> 
> 时间：2009-06-19T05:44:22.973
> 
> 标签：c++, boolean

C++ 标准在第 4.12 节中说，

*算术、枚举、指针或指向成员类型的指针的右值可以转换为 bool 类型的右值。零值、空指针值或空成员指针值转换为假，任何其他值都转换为真。*

这意味着以下代码是有效的，

```
if(5)
  std::cout << "WOW!"; 
```

它在语法上是有效的，但在语义上没有任何意义。我的问题是为什么 C++ 允许这样奇怪的事情？AFAIK，它没有带来任何优势，而不是制造混乱。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-19T05:47:26.013

我*认为*这是历史性的，并且是 C 用来评估类似布尔概念的副产品...

C 过去没有布尔类型，并且在 C 的“底层”范式中，设置为 NULL 的指针和数字类型等也是隐式的`false`。

如果您将其视为“无/零== `false`”和“其他任何== `true`”，它实际上是有道理的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T05:53:04.070

实际上，在许多语言中，包括 C/Python/Perl/BASIC 非零整数/指针值总是被认为是真，0 被认为是假。

这是许多编程语言中已知的约定，所以没有理由，为什么这不应该在 C++ 中？

问题是为什么在 Java 中不是这样？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T06:04:27.343

它来自C的产品。

还要注意，这些是（如果不是计算上的话，逻辑上）等价的：

如果 (x && y || z)

如果 (x * y + z)

（我知道这一点是因为 TI99/4a BASIC 没有 AND 或 OR 操作，所以 * 和 + 必须执行双重任务，并且在 TI99/4a BASIC 中，布尔值在 C 中工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T12:48:21.703

我认为原因是历史。可能值得注意的是，下一个 C++ 版本（C++0x、C++1x）引入了不允许隐式转换为整数的作用域枚举，使得以下代码格式错误

```
enum class X { A, B, C };
if(X::B) { ... } 
```

不过，数字允许隐式转换为布尔值对我来说很有意义，但对我来说枚举没有多大意义，因为主要目的是枚举值列表 - 仅次要枚举器的实际值我相信大部分时间都很有趣。范围枚举将需要强制转换

```
if(static_cast<bool>(X::B)) { ... } 
```

这增加了一些迄今为止所需的枚举的 C 兼容性所不允许的类型安全（我想如果禁止普通枚举，这会破坏很多代码）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T07:31:52.560

这是特定硬件限制的产物。

术语“int”、“short”、“bool”等。人。只要编译器正在工作，它就只有真正不同的语义含义——在运行时，它只是一个 1 字（8 位）值、2 字（16 位）值、4 字（32 位）值等。

所以这里真正的问题不是“为什么 C++ 除了 5 作为布尔值”，而是“为什么是 C？” 答案是，由于内存对齐，不可能在所有情况下都在任何地方存储一个位，所以编译器只使用了一个完整的单词。在 C++ 中有一个指定的“bool”类型的事实只是一些词汇上的挥手。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T11:13:31.817

这是猜想，但我相信这是因为 C 被设计为一种极简语言。

首先，布尔求值和算术求值非常相似，以至于它们实际上在 C 解析器中组合在一起，这减小了解析器的整体大小 - C++ 继承了这一点。

其次，在汇编中测试非零结果通常使用单个操作码来测试寄存器的零值，如果为真，则跳转到语句的“else”部分。如果该值不为零，则执行自然会进入语句的“if-true”部分。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T11:29:20.253

从历史上看，C 是一种相对弱[类型的语言](http://en.wikipedia.org/wiki/Weakly-typed_(programming_languages))，其设计目的是为了简单和高效，而不是健壮性。Pascal 和类似语言的类型更强——枚举、指针、整数和布尔值不能在表达式中随机混合和匹配。

C（和许多 C++）程序员都是在这种背景下长大的，你会经常看到像这样的惯用代码：

```
while (1)
   dosomething(); // repeats forever 
```

.. 或者...

```
char * pointer;

if (pointer)  // tests pointer for being != 0, which equals NULL.
  fred = *pointer; 
```

就个人而言，尽管使用 C/C++ 超过 20 年，我仍然觉得这第二个习语很难看，因为它在一行中做了两个“隐藏”转换/假设 - (NULL == 0) 和 (0==FALSE ）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T14:32:59.883

我找不到确切的引用，但人们总是说 C 结合了汇编语言的所有强大功能和灵活性以及汇编语言的安全性和易用性。

通常处理器没有布尔、整数、ptr 类型。它们都只是内存或寄存器中的数字。

就个人而言，我一直很喜欢这个成语：

```
some_obj * thingy;
if (thingy) ... 
```

这似乎是表达“事物存在”或“已初始化”的一种自然而简洁的方式。但是后来，我花了很多时间在汇编语言上。

尽管我确实倾向于在 Objective-C、Java、C# 中使用“thingy == null”（或 nil），因为您只是感觉不太确定这些语言中发生了什么，离硬件更远。在某些语言中，甚至有人可以覆盖“==”运算符。

您可以将“if (ptr)...”视为调用隐式“强制转换为布尔”运算符...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-20T22:55:53.600

那里有很好的答案，但我想再指出一件事：即使你不能说`boolean = number`，拥有或构造`boolean = pointer`仍然有意义。`if(number)``if(pointer)`

# android - 在黑莓和安卓上：从网络浏览器调用本机应用程序？

> ID：1016497
> 
> 赞同：1
> 
> 时间：2009-06-19T05:44:27.263
> 
> 标签：android, browser, blackberry, native

在 iPhone 上，应用程序可以将新的协议名称与自身关联，这样如果用户在 Web 浏览器中键入“myapp://xxx”，它就会调用该应用程序。

黑莓或安卓有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T07:47:45.693

对于 Android，请查看此问题的答案：

[Android 在 Intent 中响应 URL](https://stackoverflow.com/questions/525063/android-respond-to-url-in-intent)

以及以下页面，尤其是在此页面上有关 android:scheme 的“数据类型”部分：

[http://developer.android.com/guide/topics/intents/intents-filters.html](http://developer.android.com/guide/topics/intents/intents-filters.html)

对于您的应用，您可以在 AndroidManifest.xml 中添加如下内容：

```
<intent-filter><action android:name="android.intent.action.VIEW"></action>
<category android:name="android.intent.category.DEFAULT"></category>
<category android:name="android.intent.category.BROWSABLE"></category>
<data android:scheme="myapp"></data>
</intent-filter> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T14:05:06.243

对于 BlackBerry - 是的，在某种程度上，请查看 net.rim.device.api.browser.plugin 包（JDE 4.0.0 及更高版本）。它允许您为给定的 MIME 类型和其他参数指定回调接口。

基本上，您将 BrowserContentProvider 子类化以指示您想要接收的 MIME 类型，并在 BrowserContentProviderRegistery 中注册。

我在这方面没有太多经验——但看起来你可能仅限于提供自定义渲染功能——这对你来说可能没问题。我不确定你做其他事情的能力会有多有限——你必须尝试一下。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-06-19T13:35:24.260

对于运行 4.0 或更高版本的黑莓设备（所有“轨迹球”设备并且至少运行 4.2），您只需要以下代码：

```
// Get the default sessionBrowserSession
net.rim.blackberry.api.browser.browserSession = Browser.getDefaultSession();
// now launch the URL
browserSession.displayPage("http://www.BlackBerry.com"); 
```

由于这是一个非常可重用的代码段，我建议将其放置在以下函数中：

```
public static void loadURL(String url)
{
    try{
        net.rim.blackberry.api.browser.BrowserSession bSession = net.rim.blackberry.api.browser.Browser.getDefaultSession();
        bSession.displayPage(url);
        bSession.showBrowser();
    }
    catch (Exception ex){
        System.out.println("Error loading url [" + url + "]: " + ex.getMessage());
    }
} 
```

# xml - 这可能使用 XSLT 吗？

> ID：1016503
> 
> 赞同：1
> 
> 时间：2009-06-19T05:51:01.920
> 
> 标签：xml, xslt

我有 2 个 xml 文件。当两个文件中的 Field4 和 field5 和 field6 相同时，我想要 wite xsl 程序从 SearchApp_LA_Request 中消除（并创建一个新的 xml）SearchApp_MA_Request 的所有节点。

SearchApp_LA_Request.xml

```
<Request>
    <Rows>
        <Row1>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row1>
        <Row2>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row2>
        <Row3>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row3>
        <Row4>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row4>
    </Rows>
</Request> 
```

SearchApp_MA_Request.xml

```
<Request>
    <Rows>
        <Row1>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row1>
        <Row2>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row2>
        <Row3>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row3>
        <Row4>
            <Field1>Item1</Field1>
            <Field2>Item2</Field2>
            <Field3>Item3</Field3>
            <Field4>Item4</Field4>
            <Field5>Item5</Field5>
            <Field6>Item6</Field6>
        </Row4>
    </Rows>
</Request> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T06:14:13.337

是的，

我用谷歌搜索了你的问题（使用关键字合并 xml xslt），发现这个资源似乎触及了你的问题：'合并两个文件' [http://www.dpawson.co.uk/xsl/sect2/merge.html#d7584e19](http://www.dpawson.co.uk/xsl/sect2/merge.html#d7584e19)

[来自以上链接的传真]

```
Michael Kay

> I have two documents, file A and file B.  I want to join them 
> on the id of
> the first, but only if a matching id is in the 2nd.  How do I do this?
> 
> File A              File B               Desired Output
> <id> A </id>        <id> A </id>         <id> A </id>
> <id> B </id>        <id> C </id>         <id> D </id>
> <id> D </id>        <id> D </id>
> 

<xsl:copy-of select="document('a.xml')//id[.=document('b.xml')//id]"/> 
```

该解决方案使用 xslt 函数 document() 可以访问 xml 文档中的节点。您可以在 w3school 上找到更多信息：http: [//www.w3schools.com/Xsl/func_document.asp](http://www.w3schools.com/Xsl/func_document.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T05:55:54.783

我不知道是否有任何现成的 XSLT 解析器会按照您的建议执行...

您可能希望将其中一个文档读入 DOM 树，然后读入另一个，将每个子文档添加进去。

然后，您可以直接在内存中操作 DOM，或者将其写入一个文档，然后进行 XSL 转换以获取唯一值...

至少我会这样处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T06:40:37.223

据我了解，您需要使用 XSLT 合并 2 个 xml 文件。

看看 XSLT 中的“document()”函数。

干杯

# c# - 阻止 IP 地址

> ID：1016504
> 
> 赞同：1
> 
> 时间：2009-06-19T05:51:08.410
> 
> 标签：c#, sockets

当服务器正在发送消息时，如何阻止连接到服务器的一个 IP 地址。我的发送消息选项程序如下所示。

私人无效按钮SendMsg_Click（对象发送者，EventArgs e）{

```
 try
        {
            Object objData = richTextBoxSendMsg.Text;
            byData = System.Text.Encoding.ASCII.GetBytes(objData.ToString());
            for (int i = 0; i < m_clientCount; i++)
            {
                if (m_workerSocket[i] != null)
                {
                    if (m_workerSocket[i].Connected)
                    {

                        m_workerSocket[i].Send(byData);
                    }
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T06:05:15.503

这取决于服务器。您可能可以在防火墙级别执行此操作（如果您有正确的路由器，也可能是路由器级别）。阻止 IP 的一种相当简单的方法是在连接正常出现的任何地方都不接受来自它的连接。在您自己的应用程序中，这意味着在打开 IP 之前检查它。如果您愿意，大多数服务器都允许您阻止 ips（例如，IIS 允许您为每个网站/应用程序创建一个阻止列表（或允许列表）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T08:04:24.223

正如布赖恩所说，这应该是服务器问题，而不是应用程序问题。服务器可以在低得多的层阻止事物，并且更易于配置。

# cruisecontrol.net - 直接链接到日志文件？

> ID：1016511
> 
> 赞同：0
> 
> 时间：2009-06-19T05:54:29.357
> 
> 标签：cruisecontrol.net

我正在使用 Cruise control.NET，我只想知道我们是否可以指定一个链接，直接将我们引导到 webdashbaord 中的日志文件，而不是用户单击并导航很长一段路以查看日志文件。因此，如果有人可以分享任何想法，只需单击邮件中指定的链接即可引导用户直接检查日志文件。

如果提到的疑问不清楚，请回复我。

感谢和问候麦迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-17T16:51:03.350

我明白你在说什么链接。您是否考虑过将日志文件通过电子邮件发送给他们？

在您的电子邮件发布者中，您可以将日志文件和附件添加到发送的电子邮件中。如果他们需要查看它，您可以附加正确的日志文件并将其保存在导航中。

```
<xslFiles>
   <file>xsl\header.xsl</file>
   <file>xsl\compile.xsl</file>
   <file>xsl\unittests.xsl</file>
   <file>xsl\modifications.xsl</file>
</xslFiles>

<attachments>
    <file>C:\Data\AFile.txt</file>
    <file>Relative.txt</file>
</attachments> 
```

此外，另一种解决方案是尝试发送完整的报告。这在电子邮件发布者中默认为 false。这可能会发送您通过查看日志文件尝试查看的确切信息。

```
<includeDetails>true</includeDetails> 
```

有关电子邮件发布者的更多信息，请转到[此处](http://confluence.public.thoughtworks.org/display/CCNET/Email+Publisher)

# html - HTML 5 - 在可能的情况下尽早采用 - 好还是坏？

> ID：1016515
> 
> 赞同：16
> 
> 时间：2009-06-19T05:55:57.093
> 
> 标签：html, cross-browser, w3c-validation

这个问题受到了这个问题的启发[，](https://stackoverflow.com/questions/992115/custom-attributes-yay-or-nay)其中最受好评的答案建议使用 HTML 5 中的功能。这对我来说当然是一个好方法，但它让我对使用未来规范中的功能感到好奇。

HTML 5 提供了许多不错的改进，其中许多可以在当前浏览器中使用而不会引起问题。

一些例子：

```
// new, simple HTML5 doctype (puts browsers in standards mode)
<!doctype HTML>

// new input types,  for easy, generic client side validation
<input type="email" name="emailAddress"/>
<input type="number" name="userid"/>
<input type="date" name="dateOfBirth"/>

// new "required" attribute indicates that a field is required
<input type="text" name="userName" required="true"/>

// new 'data-' prefixed attributes
// for easy insertion of js-accessible metadata in dynamic pages
<div data-price="33.23"> 
    <!-- -->
</div>
<button data-item-id="93024">Add Item</button> 
```

许多这些新功能旨在使浏览器能够自动验证表单，并为它们提供更好的输入（例如日期选择器）。有些只是方便，似乎是为未来做好准备的好方法。

它们目前在当前浏览器中没有破坏任何东西（据我所知），它们允许干净、通用的客户端代码。

然而，即使它们在 HTML 5 中都有效，但它们对 HTML 4 无效，而且 HTML 5 在这一点上仍然是草稿。

**尽早使用这些功能是个好主意吗？**

是否存在我没​​有意识到的浏览器实现问题？

我们现在应该开发利用 HTML 5 草稿特性的网页吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-19T10:33:15.530

有几件事情需要考虑：

1.  首先，验证并不意味着太多，因为 HTML 页面很可能是有效的，但编写不当、无法访问等。请参阅[*对*](http://www.cs.tut.fi/~jkorpela/html/validation.html#icon)[“有效 HTML”图标](http://www.cs.tut.fi/~jkorpela/html/validation.html#icon)[说不](http://www.cs.tut.fi/~jkorpela/html/validation.html#icon)*和将[XHTML 作为文本/html 视为有害](http://hixie.ch/advocacy/xhtml)（参考另一个回复中提到的 hobo-web 测试）*
**   鉴于此，我强烈推荐使用新的 DOCTYPE：在 HTML5 中使用它的唯一原因是它是在浏览器中触发标准模式的最小的东西，所以如果你想要标准模式，那就去吧；你几乎没有理由使用另一个冗长、容易出错的 DOCTYPE*   至于表单增强，您可以使用 Weston Ruter 的[webforms2](http://code.google.com/p/webforms2/) JS 库将其带到非感知浏览器*   最后，关于`data-*`属性，它 a) 适用于所有浏览器（只要您使用`getAttribute()`），b) 仍然比滥用`title`or`class`属性更好，并且 c) 不会像我们之前所说的那样用验证来打扰您，验证不是t*那*很重要（当然是，但如果有效性错误是故意的，那么您的页面无效并不重要；并且您已经可以在 W3C 验证器中使用 HTML5 验证，所以...）；所以也没有真正的理由不使用它们。*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T06:00:32.250

好问题！

简而言之：这取决于您的背景和风险承受能力:)

稍微长一点：

*   我*认为*在早期采用技术方面突破极限总是好的。它让你在商业世界中比后来者更有优势，也让你在影响技术出现时有更多的影响力。

*   如果您不想重新编写代码或更新源代码，那么早期采用可能不适合您。想要编写可靠、稳定且无需更改的代码是非常值得尊敬的，但这完全取决于您（以及您的业务环境）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T06:11:45.943

如果您的页面严重依赖搜索引擎放置，则可能值得考虑某些引擎优先验证 HTML（来源： http: [//www.hobo-web.co.uk/seo-blog/index.php/official- google-prefers-valid-html-css/](http://www.hobo-web.co.uk/seo-blog/index.php/official-google-prefers-valid-html-css/)）。

此外，值得考虑的是，依赖新的日期输入元素（例如 Opera 中的那些，可能还有其他元素）可以为开发人员提供更多便利，它通常会排除更复杂的 Javascript 控件，这些控件可以更好地为旧浏览器提供服务（通常回退到一个简单的文本输入字段）。

当然，一如既往，不要依赖浏览器端检查并验证所有输入服务器端。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-22T12:28:02.350

在您至少可以在一个浏览器中进行测试之前，请不要使用这些新功能。例如，如果您使用现在表单功能，请务必在 Opera 中进行测试。否则，你可能会因为贡献有毒的遗产而弊大于利。

当某个功能已经在浏览器中实现并且您正在使用这些浏览器进行测试时，当然，请使用新功能。

另请参阅[较旧的答案](https://stackoverflow.com/questions/186264/is-it-time-to-start-using-html5/186367#186367)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T06:04:18.763

请参阅[稳健性原则](http://en.wikipedia.org/wiki/Robustness_Principle)：

> [在 RFC 761（传输控制协议，1980 年）中，美国计算机科学家 Jon Postel 总结了 Internet 协议（参见 IEN 111 1](http://en.wikipedia.org/wiki/Robustness_Principle) ，RFC 760）所需的互操作性标准的早期通信如下：
> 
> TCP 实现应该遵循稳健性的一般原则：*在你所做的事情上保持保守，在你从他人那里接受的事情上保持自由*。

所以，恕我直言，不。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-09T18:18:16.810

**至少在所有主流浏览器都支持之前，我不会从 HTML 中实现新功能。**

客户不关心您的页面是否有效，他们更关心它是否可以跨浏览器工作。即使我们努力实施最新标准，仍然会有客户和公司永远不会放弃他们的 IE6，而且 IE6 将在他们的浏览器需求列表中停留一段时间。

欢迎使用新的表单类型，但必须在服务器端检查表单。

将现有文档传递到 HTML5 需要大量的努力和适应，而且我估计不会在一夜之间发生。预计至少需要 3 年才能成为主流。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-09T18:24:46.063

我会使用 HTML 5 只是为了好玩和学习，但我肯定不会用这个新标准来接触我的任何生产代码（现有代码），至少现在直到我有正当理由支持这一举措。*

# php - PHP + ie6 + cookies：cookie 的 hello world 失败

> ID：1016522
> 
> 赞同：2
> 
> 时间：2009-06-19T06:01:22.903
> 
> 标签：php, cookies, internet-explorer-6, setcookie

我试过了，没有用！**我的问题是 php 的 setcookie() 在 IE6 中失败。**它在 Firefox 3 和 IE7/8 上运行良好（尽管有问题）。以下是代码。IE6 显示失败。简单的问题：为什么？

```
<?
    header('P3P: CP="DEV PSAi NAV STP DEM OTRo NOI IDC 
                     DSP COR CURa ADMa OUR IND PHY ONL COM STA"'); 

    setcookie('hello', 'poopoo');

    echo $_COOKIE['hello'];
?> 
```

**我怀疑 P3P**（[链接](http://www.sitepoint.com/article/p3p-cookies-ie6/2/)），**或者可能是时区的一些错误**——IE6 javascript 没有将时间转换为 php 使用的相同标准（因此所有服务器发出的 cookie 都会自动过期）。

这是我所做的： 对于 p3p 问题，我插入了上面的标题标签。我还创建了一个策略文件和一个策略参考，并通过 w3c 的 p3p 检查器运行我的网站，没有任何错误。

对于时区问题，我在 browscap.ini 中重置了时区。我还将时钟向前和向后调整了 24 小时。

如果您能给我任何新的尝试，将不胜感激。我只需要一个适用于 IE6 的 Hello World cookie 设置器。

我很感激。

*更新：**我听说独立的 IE6 存在与此匹配的问题。任何使用 IE6 的人都可以快速检查您是否可以在我的[alpha](http://mgxvideo.com/mgxcopy-alpha)上将商品添加到购物车？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T17:30:10.897

**最终更新：在 vista 上运行独立 ie6 导致的错误。Dl'ed 官方 msft 虚拟电脑和虚拟高清和网站运行完美。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T09:56:45.433

IE 的安全设置是什么？

会不会是它上面的安全设置不允许你为它写cookie？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T15:15:39.300

$_COOKIE 数组在脚本初始化期间填充。它不会被 setcookie 更改：该值将在下一页加载时更改。

[有关setcookie](http://us.php.net/setcookie)函数，请参阅 php 手册：

> 一旦设置了 cookie，就可以在**下一页**加载时使用 $_COOKIE 或 $HTTP_COOKIE_VARS 数组访问它们。

# linq-to-sql - 三层架构中的 LINQ to SQL

> ID：1016525
> 
> 赞同：4
> 
> 时间：2009-06-19T06:02:17.007
> 
> 标签：linq-to-sql

我目前使用 3 层架构（DAL、BLL、表示层）。

我想知道如何使用 LINQ to SQL 实现 3 层架构。我不知道 LINQ 应该在 DAL 还是 BLL 中。LiNQ 似乎是 DAL 和 BLL 的融合。

以前有人在 3 层架构中实现过 LINQ 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T06:42:28.953

我使用 Linq-to-SQL/XML，我认为我的应用程序是 3 层。与 pre-Linq 应用程序的区别在于，现在数据访问层更小更轻，这实际上是一件非常好的事情！

在我的旧 DAL 中，我会有如下方法：

```
public virtual int CountCustomersInCountry(string country) {
    // Plug in raw SQL.
}

public virtual List<Customer> GetCustomersInCountry(string country) {
    // Plug in raw SQL.
}

public virtual int CountCustomersForDepartment(string department) {
    // Plug in raw SQL.
}

public virtual List<Customer> GetCustomersForDepartment(string department) {
    // Plug in raw SQL.
}

etc. etc. ad-infinitum 
```

我现在有以下几种方法：

```
public virtual int Count(Expression<Func<T, bool>> where) {
    // Plug in Linq-to-SQL DataContext here.        
}

public virtual T Get(Expression<Func<T, bool>> where) {
     // Plug in Linq-to-SQL DataContext here.   
}

public virtual List<T> Get(Expression<Func<T, bool>> where,  string orderByField, int offset, int count) {
    // Plug in Linq-to-SQL DataContext here.   
} 
```

要调用新的 DAL 方法并借助 DynamicLinq 的一点帮助，我使用：

```
int countryCount = Count(c => c.Country == country);
List<Customer> customers = Get(c => c.Country == country, "inserted", 0, 25);
int departmentCount = Count(c => c.Department == department);
List<Customer> customers = Get(c => c.Department == department, "inserted", 0, 25); 
```

所有这一切都在您开始使用 Linq2SQL 成为单行调用的添加、更新和删除之前！我的 DAL 现在由 10 种方法组成，而以前很容易为我的 DAL 所照顾的每个对象获取多达 20 到 30 种方法！我强烈建议您尝试一下，因为它确实可以为您节省大量代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T08:00:34.967

LINQ-to-SQL 实际上主要是关于 DAL - 它是一种数据访问技术。然而，在一个足够简单的应用程序中，没有什么能阻止您将 LINQ 创建的对象传递到业务层，甚至将它们绑定到您的 UI。为什么不？

但是，您需要注意，在这种情况下，您将自己与 LINQ-to-SQL 紧密联系在一起。如果这对您的场景没问题 - 太好了，使用它！这是您需要根据项目需求为自己做出的设计决策。

如果系统变得更复杂，特别是如果您从数据库表创建的 LINQ 对象与您的业务对象不匹配 1:1，您总是可以使用业务层从您的 LINQ 对象“组装”真实的业务对象。借助[AutoMapper](http://www.codeplex.com/AutoMapper)之类的工具，您甚至可以编写大量左右分配的“猴子”代码 :-)

另一方面，如果您处于这种情况，您可能还想查看 ADO.NET Entity Framework 而不是 LINQ-to-SQL。EF 为您提供了许多这些更高级的功能，这些功能对于小型应用程序来说可能是多余的，但对于企业应用程序来说可能绝对至关重要。诸如支持多个数据库供应商之类的事情，诸如将您的业务对象映射到数据库中的不同物理表示之类的事情等等。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T06:22:00.360

LiNQ 创建的对象通常被描述为业务层对象，尽管它们与数据层的耦合确实比通常建议的要高。但是，如果您的结构比 LiNQ 中直接表示的结构更高，那么额外的控制器可以将其作为业务层进行操作，而 LiNQ 则更像是数据层。

这实际上取决于数据库中表示的对象的范围，以及您希望达到的耦合程度。因为 LiNQ 强调可查询，它可能会过度渗透到应用程序中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T06:18:31.160

我认为这取决于您如何看待使用 LINQ。在正常的计划中，我认为它确实位于 DAL 中，因为它紧跟底层数据结构。然后，您可以在 BLL 中对其进行抽象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T06:23:18.563

LINQ 不适合 3 层架构。它最适合 2 层架构。

我个人在 3 层做我的学位项目并决定使用 LINQ，但后来我因为很多问题放弃了这个想法。最大的问题是“乐观并发控制”

因为 LINQ 的实体对象工作在 DataContext 的连接环境中。所以在更新和删除逻辑期间。它给出了错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T08:12:36.563

我在 DAL 项目中添加实体并为我需要的访问权限创建一个存储库。如果您真的不想在 BLL 中使用 Linq to SQL 对象，则需要使用双重映射技术。使用存储库模式可以轻松模拟 DAL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-27T07:14:21.280

我使用 linq 和 3 层编写了一个简单的电话簿，您可以下载它，如果您对此有任何疑问，请随时问我。

它位于：[http ://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=7597&lngWId=10](http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=7597&lngWId=10)

# datagridview - 如何在 Windows C# 的 DataGridView 中添加掩码文本框控件？

> ID：1016527
> 
> 赞同：0
> 
> 时间：2009-06-19T06:02:38.190
> 
> 标签：datagridview, maskedtextbox

我想在 windows 应用程序的 datagridview 中添加 Mask 文本框。

掩码文本框将保存时间值的掩码。

如何在 Windows 的 datagridview 中做到这一点？有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T06:05:37.327

很简单：只需将其添加到模板列中

```
 <asp:GridView ID="gv" runat="server">
        <Columns>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:TextBox ID="txt" runat="server" />
                    <ajaxtoolkit:maskededitextender targetcontrolid="txt" mask="9,999,999.99" messagevalidatortip="true"
                        onfocuscssclass="MaskedEditFocus" oninvalidcssclass="MaskedEditError" masktype="Number"
                        inputdirection="RightToLeft" acceptnegative="Left" displaymoney="Left" errortooltipenabled="True" />
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView> 
```

**你改变了**......现在你说 Windows 应用程序：D

对于 Windows 窗体，您应该[阅读这篇文章](http://www.codeproject.com/KB/grid/DataGridViewMaskedText.aspx)

# php - 评级系统，无需重新加载页面

> ID：1016529
> 
> 赞同：0
> 
> 时间：2009-06-19T06:03:41.980
> 
> 标签：php

我有一个页面，我有一些评分功能，比如喜欢帖子的人可以评分或不评分的人。

在那个链接上，我调用了一个带有在锚标记中传递的一些参数的 php 文件。然后在那个 php 文件中，我在数据库中用 +1 或 -1（视情况而定）保存该评分，然后我重定向到我们评分的第一页。现在整个功能正在重新加载我不想要的整个页面。有什么方法可以在不重新加载页面的情况下进行此评分，我希望当一个人点击评分时，点击评分后应该根据用户刚刚做了什么（+ 或 -），也没有重新加载整个页面。有没有办法在 php 中做到这一点？？？？？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T06:05:35.003

是的，它被称为“Ajax”。但是，您不会在服务器端使用 PHP 执行此操作，而是使用 JavaScript 在客户端执行此操作。周围有[很多教程](http://www.google.com/search?q=ajax+tutorial&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)，我建议你看看。

请注意，有许多 JavaScript 库可以使这非常容易。我建议看一下[jQuery](http://jquery.com/)，因为我个人发现它是最容易学习和使用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T06:17:37.573

似乎已经发布了一些推荐不同库的答案。如果您希望避免包含库的（公认最小的）开销，以下教程将展示如何使用简单的 XMLHttpRequest 对象。

[http://www.xul.fr/en-xml-ajax.html](http://www.xul.fr/en-xml-ajax.html)

“xhr.responseText”是您将从 php 处理中收到的内容（通常在与主页分开的小型、单一用途的脚本中完成）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T06:17:54.077

您可以使用 Javascript 或 AJAX 执行此操作。网上有很多免费脚本可以帮助您做到这一点，而无需从头开始构建整个东西。

此页面 ( [http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=364](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=364) ) 有一个很好的列表，其中列出了您可以选择的不同星级评分脚本。你可以谷歌了解更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T06:22:01.950

这是我在回答其他问题时遇到的另一个相关教程：

[http://docs.jquery.com/Tutorials:Getting%5FStarted%5Fwith%5FjQuery#Rate%5Fme:%5FUsing%5FAjax](http://docs.jquery.com/Tutorials:Getting%5FStarted%5Fwith%5FjQuery#Rate%5Fme:%5FUsing%5FAjax)

# web-services - 其他公司/产品/网站是否通过 Google 数据 API 提供访问权限？

> ID：1016539
> 
> 赞同：0
> 
> 时间：2009-06-19T06:05:39.607
> 
> 标签：web-services, rest, api, google-data-api

Google 使用基于 XML/RSS/Atom 的[Google Data API](http://code.google.com/apis/gdata/overview.html)来提供对其各种服务的编程访问。

因为是 Google 做的，所以这些 API 变得非常流行，例如：有很多客户端应用程序支持它。谷歌甚至自己提供了很多客户端库。

也应该可以将 API 用于其他（非 Google）数据源。

有人这样做吗？

如果我必须为我的日历网站提供 API，那么使用 Google 的 API 代替 CalDAV 是否​​是一个不错的举措，CalDAV 是一个“适当的”标准，但可能更难使用？

或者 Google API 是否过于 Google 特定，没有足够的文档记录，或者由于其他原因不合适？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T06:08:54.560

对于日历，CalDAV 协议和 ICS 文件格式在应用程序和服务之间建立良好且可移植。我不会尝试完全复制 Google 的 API 所做的事情，因为它们可以是特定的。提供支持 XML/Atom 的基于 REST 的 API 并不是一个糟糕的选择。可能一切都取决于你想要做什么。对于日历，CalDAV/ICS 可能是最佳选择。

# php - 在 PHP 中包含问题

> ID：1016542
> 
> 赞同：0
> 
> 时间：2009-06-19T06:07:16.497
> 
> 标签：php, .htaccess, include

我需要打开 allow_url_include 。我怎样才能做到这一点？我可以访问 .htaccess 和 php.ini。

我正在使用 PHP 版本 5.2.9

我试过添加

php_value allow_url_include 开启

在 .htaccess 和

allow_url_include = 开启

在 php.ini 中。

这两个文件都在我网站的根目录下。

有没有办法使用 curl/get page 功能作为解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T06:11:08.643

你确定你正在获取正确的 php.ini 文件吗？

如果您使用的是 linux 机器，那么您可能会抓错一个。我在过去看到过这种情况。如果您确实在使用 Linux，请打开终端并键入

```
which httpd
which php 
```

然后你会知道你是否指向正确的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:24:31.027

根据您尝试用作要包含的文件的内容，您需要同时启用 url_fopen 和 url_include。

相关的 php 文档条目可在此处获得：

[http://www.php.net/manual/en/filesystem.configuration.php](http://www.php.net/manual/en/filesystem.configuration.php)

# php - 任何人都可以在 php 中建议最好的图像调整大小脚本吗？

> ID：1016544
> 
> 赞同：1
> 
> 时间：2009-06-19T06:07:44.017
> 
> 标签：php, image, resize

你好

我需要在 php 中调整所有类型的图像大小脚本

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T07:16:42.870

> [WideImage](http://wideimage.sourceforge.net/wiki/MainPage)是一个面向对象的图像处理库，用 PHP 5 编写/为 PHP 5 编写。它是一个纯 PHP 库，除了 GD2 扩展之外不需要任何外部库。

我曾经在一个私人项目中使用过它，对我来说工作得相当好。

### 样品

```
// Chaining operations:
wiImage::load('image.png')->resize(50, 30)->saveToFile('new-image.jpg', 30);

// Load, crop, flip and output to browser in one line (no http headers included):
echo wiImage::load('image.png')->crop(30, 30, '50%', '50%')->flip()->asString('png');

// watermarking
$img = wiImage::load('pic.jpeg');
$watermark = wiImage::load('watermark.jpg');
$new_img = $img->merge($watermark, 40, 80); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T06:23:34.693

如果您使用的是 unix 系统，我强烈建议您查看[ImageMagick](http://www.imagemagick.org/)及其各种接口。世界上最快和最广泛使用的图像处理工具。

具体来说，请查看[MagickWand](http://www.magickwand.org/)，它是 PHP 接口之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T06:48:08.507

我肯定会使用 ImageMagick 的任何包装器而不是 PHP GD 库，因为后者要求您将内存设置得非常高，而且如果您在 webhotels 租用地方，您并不总是被允许这样做。除了调整大小之外，ImageMagick 还具有许多功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T02:14:51.750

有一个简单易用的开源库，名为[PHP Image Magician](http://phpimagemagician.jarrodoberto.com/)，它有一些不错的特性和文档。

基础用法示例：

```
$magicianObj = new imageLib('racecar.jpg');
$magicianObj -> resizeImage(100, 200, 'crop');
$magicianObj -> saveImage('racecar_small.png'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-27T11:46:36.937

This is quite easy: [https://github.com/elboletaire/Watimage](https://github.com/elboletaire/Watimage)

```
$wm = new Watimage('test.png');
// Resize image to 400x400px
$wm->resize(array('type' => 'resizecrop', 'size' => 400));
// Flip it horitzontally
$wm->flip('horizontal');
// Rotate 90 degrees
$wm->rotate(90);
// Generate and save image
$wm->generate('test2.png'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T06:31:53.960

显而易见的基于 PHP 的解决方案是使用 GD 读取文件、获取尺寸、计算新尺寸、缩放图像并输出。

前提是您有 GD 扩展名，即：[http ://de3.php.net/manual/en/book.image.php](http://de3.php.net/manual/en/book.image.php)

还有一个 Imagic 扩展，它允许非常简单的调整大小：[http ://de3.php.net/manual/en/function.imagick-scaleimage.php](http://de3.php.net/manual/en/function.imagick-scaleimage.php)

# postgresql - 如果时间部分是可选的，如何将日期时间存储在数据库中？

> ID：1016546
> 
> 赞同：1
> 
> 时间：2009-06-19T06:08:33.390
> 
> 标签：postgresql, datetime, timestamp, schema

我应该将它存储在单个时间戳/日期时间字段还是单独的日期和时间字段中？我更喜欢将其存储为单个时间戳字段，但我需要知道用户何时没有输入时间部分。

如何最好地将其存储在数据库中？我正在使用postgresql。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T14:50:47.803

这是一个坏主意肯定有原因。您的选择有限也是有原因的。这是一个坏主意，因为它是单个数据项，并且更实际的原因是，如果您有两个字段，则无法存储时区。

如上所述，空值是使用两个字段的明显好处。

您可能还需要考虑使用单个日期时间字段并存储一个标志来指示用户是否输入了时间。这可能是一个布尔标志。但是，您仍然需要考虑如何使用这些数据 - 仅在日期时间字段中输入日期会导致时间组件设置为午夜。这将对排序和选择产生影响。此外，如果您要存储时区，则在使用数据时必须非常小心。

为了满足您了解是否输入时间的要求，您需要有两个字段。不过，您不需要第二个字段是时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T06:13:31.620

显而易见的答案是使用两个单独的字段；那么您可以使用 NULL 值。

如果您选择使用一个字段，您将需要选择一个表示“未输入实时”的魔术时间部分，这有与实时重合的危险（但不太可能）。

此外，如果您打算经常单独使用日期和时间部分，那么使用单独的字段也可能很方便；否则，您通常需要使用选择功能来提取字段的相关部分。

# visual-studio - Visual Studio 2008 的 Prefast

> ID：1016553
> 
> 赞同：4
> 
> 时间：2009-06-19T06:12:28.220
> 
> 标签：visual-studio, prefast

在哪里可以找到适用于 Visual Studio 2008 的 Prefast 的下载？我无法通过 Google 或 MSDN 网站找到它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T06:58:24.137

PREfast 包含在 Windows 驱动程序工具包 (WDK) 中。从这里开始获取有关如何获取 WDK 的说明：

*   [http://www.microsoft.com/whdc/devtools/wdk/wdkpkg.mspx](http://www.microsoft.com/whdc/devtools/wdk/wdkpkg.mspx)

我不确定集成到 Visual Studio 中是否容易。Visual Studio 2008 包含一个 C/C++ 分析函数（/analyze 选项），它在某些方面与 PREfast 相似（但我不确定有多相似——许多文章似乎表明它是同一件事）。

# c# - 用于验证 url 的正则表达式

> ID：1016555
> 
> 赞同：0
> 
> 时间：2009-06-19T06:13:25.973
> 
> 标签：c#, .net, regex

我是正则表达式的初学者。我的要求是使用查询字符串、方括号等验证简单的网址到网址。例如，

www.test.com?waa=[样本数据]

我写的正则表达式只适用于简单的网址。带有方括号的那个失败了。任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-24T12:00:18.477

你真的需要使用正则表达式吗？

```
bool isUri = Uri.IsWellFormedUriString("http://...", UriKind.RelativeOrAbsolute) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T06:15:51.820

我建议更好地查看以下站点

[http://www.regular-expressions.info/dotnet.html](http://www.regular-expressions.info/dotnet.html)

如果没有实际看到您正在使用的正则表达式，我无法提供太多见解。给你答案也不会真正教会你太多。给一个男人一个正则表达式，你帮助他一点。教他正则表达式，他对生活有好处

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T06:16:17.263

看看以下内容：

[http://www.geekzilla.co.uk/view2D3B0109-C1B2-4B4E-BFFD-E8088CBC85FD.htm](http://www.geekzilla.co.uk/view2D3B0109-C1B2-4B4E-BFFD-E8088CBC85FD.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T06:23:05.473

非常感谢fr的回复..这是我写的..也适用于查询字符串...但是在添加[]时失败了..

/^(https?|ftp)://(?#)(([a-z0-9$ *.+!*\'(),;\?&=-]|%[0-9a-f]{ 2})+(?#)(:([a-z0-9$* .+!*\'(),;\?&=-]|%[0-9a-f]{2})+)? (?#)@)?(#)((([a-z0-9][a-z0-9-] *[a-z0-9].)* (#)[az]{2}[a-z0 -9-] *a-z0-9|(\d|[1-9]\d|1\d{2}|2[0-4][0-9]|25[0-5].){ 3}(?#)(\d|[1-9]\d|1\d{2}|2[0-4][0-9]|25[0-5])(?#))( :\d+)?(?#))(((/+([a-z0-9$_.+!*\'(),;:@&=-]|%[0-9a-f]{ 2})* ) *(?# )(\?([a-z0-9$_.+!*\'(),;:@&=-]|%[0-9a-f]{2})* ) (?#)?)?)?(?#)(#([a-z0-9$_.+!*\'(),;:@&=-]|%[0-9a-f]{ 2})*)?(?#)$/i

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T06:31:30.623

如果您想要带有 http 的 url，请使用它

http(s)?://([\w-]+.)+[\w-]+(/[\w- ./?%&=]*)?

如果 oyu 不想要 URL 中的 http 然后去

?://([\w-]+.)+[\w-]+(/[\w- ./?%&=]*)?

# javascript - 可拖动+可排序和可滚动的 div

> ID：1016559
> 
> 赞同：3
> 
> 时间：2009-06-19T06:14:17.827
> 
> 标签：javascript, jquery, scroll, jquery-ui-sortable, draggable

我有一个带有可拖动项目列表的容器和一个带有可排序项目列表的容器。可拖动对象和可排序列表是连接的，允许用户将可拖动对象的克隆拖动到已排序列表中。

可拖动项目出现在垂直列表中，但可排序项目出现在水平列表中，通过将它们向左浮动来实现。可排序项目的容器将其溢出设置为自动，如果内容溢出，则会产生水平滚动条。两个容器紧挨着出现，左侧是可拖动的，右侧是可排序的。

我遇到的问题是，当可排序项的容器向右滚动时，从可拖动项的容器中拖动会立即触发可排序项的事件。看起来好像 sortables 容器的内容被移动到 draggables 容器后面。

这是我的代码：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
    <title>Sortables in scrollable divs</title>
    <script type="text/javascript" language="JavaScript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
    <script type="text/javascript" language="JavaScript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>
    <script type="text/javascript" language="javascript">
        $(function() {
            $("#sortable").sortable({
                start: function(event, ui) {
                    if (ui.helper !== null) console.log("sortable \"" + ui.helper.text() + "\" drag start");
                },
                stop: function(event, ui) {
                    if (ui.helper !== null) console.log("sortable \"" + ui.helper.text() + "\" drag stopped");
                    if (ui.item !== null) console.log("sortable item \"" + ui.item.text() + "\" drag stopped");
                }
            });

            $("#sortable").sortable("disable");

            $("#draggable li").draggable({
                connectToSortable: '#sortable',
                helper: 'clone',
                revert: 'invalid',
                cursor: "default",
                cursorAt: { top: -5, left: -5 },
                start: function(event, ui) {
                    if (ui.helper !== null) console.log("draggable \"" + ui.helper.text() + "\" drag start");
                },
                stop: function(event, ui) {
                    if (ui.helper !== null) console.log("draggable \"" + ui.helper.text() + "\" drag stopped");
                }
            });

            $("#container2").mouseenter(function() {
                console.log("enter sortable container");
                $("#sortable").sortable("enable");
            }).mouseleave(function() {
                console.log("leaving sortable container");
                $("#sortable").sortable("disable");
            });

            $("#draggable, #sortable").disableSelection();
        });
    </script>
    <style type="text/css">
        html, body, p, td, th, li, input, select, option, textarea
        {
            font-family: Verdana, Arial, Helvetica, sans-serif;
            font-size: 11px;
            color:#343E41;
        }

        .wrapper
        {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            height: expression(this.parentNode.offsetHeight + "px");
        }

        .scroll-wrapper
        {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: auto;
            height: expression(this.parentNode.offsetHeight + "px");
        }

        #container1
        {
            float:left;
            width:200px;
            height:400px;
            overflow:auto;
            border:solid #000 1px;
            margin:5px;
        }

        #container2
        {
            float:left;
            width:600px;
            height:400px;
            overflow:auto;
            border:solid #000 1px;
            margin:5px;
        }

        ul#draggable
        {
            padding:0;
            margin:0;
            list-style-image:none;
            list-style-position:outside;
            list-style-type:none;
        }

        ul#draggable li
        {
            display:block;
            margin:5px;
            border:solid #000 1px;
            height:50px;
            width:150px;
        }

        ul#sortable
        {
            padding:0;
            margin:0;
            list-style-image:none;
            list-style-position:outside;
            list-style-type:none;
            height:380px;
            width:744px;
        }

        ul#sortable li
        {
            display:block;
            float:left;
            margin:5px;
            border:solid #000 1px;
            height:370px;
            width:50px;
            text-align:center;
        }
    </style>
</head>
<body>
    <form id="form1" action="">
        <div id="container1">
            <ul id="draggable">
                <li>1A</li>
                <li>2A</li>
                <li>3A</li>
                <li>4A</li>
                <li>5A</li>
                <li>6A</li>
                <li>7A</li>
                <li>8A</li>
                <li>9A</li>
                <li>10A</li>
                <li>11A</li>
                <li>12A</li>
            </ul>
        </div>
        <div id="container2">
            <ul id="sortable">
                <li class="ui-state-default">1</li>
                <li class="ui-state-default">2</li>
                <li class="ui-state-default">3</li>
                <li class="ui-state-default">4</li>
                <li class="ui-state-default">5</li>
                <li class="ui-state-default">6</li>
                <li class="ui-state-default">7</li>
                <li class="ui-state-default">8</li>
                <li class="ui-state-default">9</li>
                <li class="ui-state-default">10</li>
                <li class="ui-state-default">11</li>
                <li class="ui-state-default">12</li>
            </ul>
        </div>
    </form>
</body> 
```

在将项目拖到可排序容器上之前，如何避免触发可排序事件？

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-11-24T09:56:18.063

自从我发布这个问题以来已经有很长时间了，从那时起，jQuery 和 jQuery UI 的新版本已经发布。

此外，jQuery UI 的开发团队添加了一个与 sortables 连接的可拖动示例，被添加。

因此，我更新了上面的原始示例代码并对其进行了修改，以使其适合我的场景。我想要一个水平滚动的可排序部分，它会在添加新项目时自动展开。

下面的示例解决了我的问题，代码看起来更简洁：

```
$(function () {
            $("#sortable").sortable({
                revert: true,
                start: function (event, ui) {
                    $(this).width($(this).width() + ui.helper.width() + 12);
                },
                stop: function (event, ui) {
                    var w = 0;
                    $(this).children("li").each(function () {
                        w += $(this).width() + parseInt($(this).css("margin-left")) + parseInt($(this).css("margin-right")) + 2;
                    });
                    $(this).width(w);
                }
            });

            var w = 0;
            $("#sortable").children("li").each(function () {
                w += $(this).width() + parseInt($(this).css("margin-left")) + parseInt($(this).css("margin-right")) + 2;
            });
            $("#sortable").width(w);

            $("#draggable li").draggable({
                connectToSortable: "#sortable",
                helper: "clone",
                revert: "invalid"
            });
            $("ul, li").disableSelection();
        });
```

```
html, body, p, td, th, li, input, select, option, textarea
                {
                        font-family: Verdana, Arial, Helvetica, sans-serif;
                        font-size: 11px;
                        color:#343E41;
                }

                .wrapper
                {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        overflow: hidden;
                        height: expression(this.parentNode.offsetHeight + "px");
                }

                .scroll-wrapper
                {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        overflow: auto;
                        height: expression(this.parentNode.offsetHeight + "px");
                }

                #container1
                {
                        float:left;
                        width:200px;
                        height:400px;
                        overflow:auto;
                        border:solid #000 1px;
                        margin:5px;
                }

                #container2
                {
                        float:left;
                        width:600px;
                        height:400px;
                        overflow:auto;
                        border:solid #000 1px;
                        margin:5px;
                }

                ul#draggable
                {
                        padding:0;
                        margin:0;
                        list-style-image:none;
                        list-style-position:outside;
                        list-style-type:none;
                }

                ul#draggable li
                {
                        display:block;
                        margin:5px;
                        border:solid #000 1px;
                        height:50px;
                        width:150px;
                }

                ul#sortable
                {
                        padding:0;
                        margin:0;
                        list-style-image:none;
                        list-style-position:outside;
                        list-style-type:none;
                        height:380px;
                }

                ul#sortable li
                {
                        display:block;
                        float:left;
                        margin:5px;
                        border:solid #000 1px;
                        height:370px;
                        width:50px;
                        text-align:center;
                }
```

```
 <script type="text/javascript" language="JavaScript" src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
        <script type="text/javascript" language="JavaScript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js"></script>

    <form id="form1" action="">
    <div id="container1">
    <ul id="draggable">
    <li>1A</li>
    <li>2A</li>
    <li>3A</li>
    <li>4A</li>
    <li>5A</li>
    <li>6A</li>
    <li>7A</li>
    <li>8A</li>
    <li>9A</li>
    <li>10A</li>
    <li>11A</li>
    <li>12A</li>
    </ul>
    </div>
    <div id="container2">
    <ul id="sortable">
    <li class="ui-state-default">1</li>
    <li class="ui-state-default">2</li>
    <li class="ui-state-default">3</li>
    <li class="ui-state-default">4</li>
    <li class="ui-state-default">5</li>
    <li class="ui-state-default">6</li>
    <li class="ui-state-default">7</li>
    <li class="ui-state-default">8</li>
    <li class="ui-state-default">9</li>
    <li class="ui-state-default">10</li>
    <li class="ui-state-default">11</li>
    <li class="ui-state-default">12</li>
    </ul>
    </div>
    </form>
```

认为某人，某处可能喜欢做同样的事情并需要一些帮助：D

# c# - C#：Regasm 为我的 COM DLL 中的每个类生成注册表项？

> ID：1016568
> 
> 赞同：3
> 
> 时间：2009-06-19T06:17:40.943
> 
> 标签：c#, .net, com, registry, regasm

我正在用 C# 编写一个类库 (IE BHO)，目前正在处理我认为来自 REGASM 生成的注册表项的大量垃圾输出。

简短的版本是这样的：我只想向 IE（以及 COM 的其余部分）公开少数类（目前：一个类）。只有一个类设置了 ClassInterfaceAttribute 和 GUID，我可以测试该插件只需要该类的 COM 注册表项——然而，REGASM 为整个项目中的每个类生成 GUID 和注册表项。

这很烦人而且有点令人不安，因为我不希望我的类名出现在用户的注册表中，除非他们绝对*必须*在那里。

公平地说，许多其他类被标记为公共，因为我在同一解决方案中另一个项目的驱动程序应用程序中使用它们，以解决 IE 的调试黑洞......

总的来说，我对 COM 仍然很陌生（尤其是与 .Net 相关），我想知道隐藏我所有其他类以防止 regasm 的最佳方法是什么？或者，至少，当我没有为它们设置任何 COM 标志时，为什么这些类——即使它们被标记为公共——会出现？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T06:27:51.690

`internal`对不需要修饰符的东西使用访问`public`修饰符。对于真正需要`public`访问的内容，请使用 ComVisible 属性部分隐藏它。

例如：

```
[ComVisible(false)]
public class ClassToHide {
    //whatever
};

public class ClassToExpose {

     public void MethodToExpose() {}

     [ComVisible(false)]
     public void MethodToHide() {}
}; 
```

默认情况下，所有公共类的所有公共成员函数和成员变量都是 COM 可见的。因此，首先考虑将它们设为内部，如果您真的需要它们，请使用 ComVisible 将它们从 COM 中隐藏起来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T08:21:20.633

尝试使用 /regfile 开关 - 这将输出一个 reg 文件，而不是直接将所有类名写入注册表。

当您拥有 .reg 文件时，您可以删除您不想添加到目标系统注册表的任何条目，并仅将这些值部署到目标计算机。根据您选择部署软件的方式，这可能会更容易，并且您不必更改任何类型的代码。

事实上，如果您无法访问源代码，这将是实现这一目标的唯一方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-22T05:41:26.620

我写了一个有同样问题的 COM 组件。

我将所有非 COM 函数分离到一个单独的辅助 DLL 中。COM DLL 只包含需要注册的代码。其他所有内容都通过帮助程序 DLL 访问。

我发现这是一种确保未来代码不会被意外标记为`public`而不是`internal`显示在注册表中的简单方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-03T17:41:05.127

在 AssemblyInfo 文件中将 ComVisible 属性设置为 false，并仅为所需的类设置应用 ComVisible。

# java - 是否有适用于 Android 1.5 VideoView/MediaPlayer 类的工作示例？

> ID：1016584
> 
> 赞同：2
> 
> 时间：2009-06-19T06:23:01.853
> 
> 标签：java, android, android-widget, media

我是 Android 开发新手。

[MediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html)有一个非常漂亮的状态图，但我一生都无法弄清楚如何实际使用这个类来播放视频。

'net 周围有一个视图示例，但它们似乎适用于以前版本的 SDK。我也检查了[官方样品](http://developer.android.com/guide/samples/index.html)，但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-23T05:54:22.443

是的。VideoView 和 MediaPlayer 的示例代码在：

```
<android-sdk>/platforms/android-1.5/samples/ApiDemos/src/com/example/android/apis/media/ 
```

这些在在线帮助中的任何地方都没有链接，因为那里的示例与实际发货的内容不同步。

编辑：请注意样本存在，但它们在 Android 1.5 中不起作用，请参阅此[错误](http://code.google.com/p/android/issues/detail?id=2570&q=videoview&colspec=ID%20Type%20Version%20Security%20Status%20Owner%20Summary)。

# asp.net - 在 ASP.NET 中发送压缩响应

> ID：1016589
> 
> 赞同：1
> 
> 时间：2009-06-19T06:24:16.923
> 
> 标签：asp.net, iis, compression

我在 IIS6 上为 ASP.NET 应用程序运行一个网站，并启用了压缩，这对于 .aspx 网页效果很好。

不工作的是作为回发响应的一部分传输的下载的二进制文件：例如链接按钮是“下载到 excel” - 用户单击并且代码生成一个二进制文件，执行 Response.Clear() 然后写入文件到 Response.OutputStream。

浏览器可以看到响应，但它始终是零字节。因此，我假设 Web 浏览器期待压缩响应，并且由于原始二进制文件不是有效的压缩流，它会失败。我很困惑，如果我清除了响应，为什么会这样 - 当然响应标头（指定压缩）也被清除了？

于是出现了两个问题：

1）如何压缩二进制文件以发送压缩响应？2) 如何在运行时检查是否启用了 IIS 压缩？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T06:38:34.543

我会禁用压缩并检查这是否仍然有效，只是为了隔离这确实是由于 IIS 压缩造成的。我告诉你，因为我正在运行一个支持 IIS/压缩的站点，它可以毫无问题地提供 PDF 文件（二进制）。

无论如何，这是对我有用的代码部分。

```
 Response.Clear();
 Response.ClearHeaders();

 Response.AddHeader("Content-Disposition", "attachment; filename=\"" + fileName + "\"");
 Response.AddHeader("Content-Length", fileInfo.Length.ToString());
 Response.AddHeader("Content-transfer-encoding", "8bit");
 Response.AddHeader("Cache-Control", "private");
 Response.AddHeader("Pragma", "cache");
 Response.AddHeader("Expires", "0");  

 Response.ContentType = "application/pdf";
 Response.WriteFile(filePath);

 Response.Flush();
 Response.Close();
 HttpContext.Current.ApplicationInstance.CompleteRequest(); 
```

# c - 如何在 C 中为我的应用程序修复内存大小？

> ID：1016590
> 
> 赞同：5
> 
> 时间：2009-06-19T06:24:20.027
> 
> 标签：c

我想为我的应用程序（使用 C 开发）分配一个固定内存。假设我的应用程序不应该超过 64MB 的内存占用。而且我应该避免使用更多的 CPU 使用率。怎么可能？

问候马塞尔。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T06:40:58.033

unix下：“ulimit -d 64M”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T06:35:15.110

我可以确保在您的应用程序中不超过最大内存阈值的一种相当低技术的方法是定义您自己的特殊`malloc()`函数，该函数记录已分配的内存量，如果超过阈值则返回 NULL 指针. 这当然取决于您`malloc()`每次调用它时检查的返回值，这通常被认为是一种好的做法，因为不能保证`malloc()`会找到您请求的大小的连续内存块。

但这并不是万无一失的，因为它可能不会考虑字对齐的内存填充，因此您可能会在函数报告您已经达到它之前很久就达到 64MB 内存限制。

此外，假设您使用的是 Win32，可能有一些 API 可用于获取当前进程大小并在您的自定义`malloc()`函数中进行检查。请记住，将这种检查开销添加到您的代码很可能会导致它使用更多 CPU 并且运行速度比正常慢很多，这很好地导致了您的下一个问题 :)

> 而且我应该避免使用更多的 CPU 使用率。

这是一个非常普遍的问题，没有简单的答案。你可以编写两个不同的程序，它们本质上做同样的事情，由于所使用的算法，一个程序的 CPU 密集度可能是另一个程序的 100 倍。最好的技术是：

1.  设置一些性能基准。
2.  编写你的程序。
3.  测量它是否达到您的基准。
4.  如果它没有达到您的基准，请优化并转到步骤 (3)。

您可以使用分析程序来帮助您确定算法需要优化的地方。Rational Quantify 是一个商业例子，但也有许多免费的分析器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T06:43:21.133

如果您在 POSIX、System V 或 BSD 派生系统上，您可以使用`setrlimit()`与资源`RLIMIT_DATA`类似的`ulimit -d`.

还要看看`RLIMIT_CPU`资源 - 它可能是你需要的（类似于`ulimit -t`）

检查`man setrlimit`详情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T14:11:15.887

对于 CPU，我们有一个非常低优先级的任务（低于其他所有任务），除了计数之外什么都不做。然后您可以查看该任务运行的频率，并且您知道您的其余进程是否消耗过多的 CPU。如果您想在其他进程正在运行时将进程限制为 10%，则此方法不起作用，但如果您想确保有 50% 的 CPU 空闲，那么它可以正常工作。

对于内存限制，您要么被困在 malloc 之上实现自己的层，要么以某种方式利用您的操作系统。在 Unix 系统上 ulimit 是你的朋友。在 VxWorks 上，我敢打赌，您可能会想出一种方法来利用任务控制块来查看应用程序正在使用多少内存……如果还没有这样的功能的话。在 Windows 上，您至少可以设置一个监视器来报告您的应用程序是否超过 64 MB。

另一个问题是：你会怎么做？如果超过 64Mb，您的应用程序会崩溃吗？您是否希望这只是帮助您限制自己的指南？这可能会在选择“强制执行”方法与“监控和报告”方法之间产生差异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T06:36:04.923

唔; 好问题。我可以看到如何使用自定义版本的 malloc 和 free 对堆外分配的内存执行此操作，但我也不知道在堆栈上强制执行它。

管理CPU仍然更难......

有趣的。

# asp.net - 空白的 Asp.net MVC 模板

> ID：1016593
> 
> 赞同：3
> 
> 时间：2009-06-19T06:25:07.903
> 
> 标签：asp.net, asp.net-mvc

有没有办法可以得到一个空白的 VS2008 的 MVC 模板？就像 MVC 附带的唯一一样，很高兴看到 MVC 的全部内容，但是当您想要创建自己的网站并且您首先必须删除它们为您生成的所有废话时，它会变得很烦人。

就像我想使用自己的身份验证内容一样，因为我了解正在发生的事情以及我自己的样式表和内容。

所以我必须一次性完成并删除所有内容，所以我想知道有没有人知道我可以获得的模板，它只有 mvc 的基本结构和 web.config 文件中所需的最少内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T06:30:26.460

我不知道目前有什么可用的，但至少您可以通过创建自定义[**Visual Studio Template**](http://msdn.microsoft.com/en-us/library/6db0hwky.aspx)来创建所需的模板。

**本质上，在删除所有不需要的文件后，执行 File | 在 Visual Studio 中导出模板，按照向导前往应许之地。**

如果你最终这样做，我相信其他人会喜欢它。我只是懒得自己做，也没有真正创建很多新的 MVC 项目，只是在同一个项目上工作了几个月。:)

* * *

更新：回复您的评论：虽然我并没有真正深入研究它，但我不知道为什么您不能在项目模板中包含对测试项目向导的访问。我破解了默认的 ASP.NET MVC 项目模板元数据文件，并在底部附近找到了这个：

```
<WizardExtension>
   <Assembly>Microsoft.VisualStudio.Web.Extensions, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35</Assembly>
   <FullClassName>Microsoft.VisualStudio.Web.Mvc.TemplateWizard</FullClassName>
</WizardExtension> 
```

如果他们能做到，我不知道你为什么做不到。我有兴趣进一步研究这个问题，但现在我要去睡觉了——考虑到我得了严重的胸部感冒，我已经起床太晚了。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T06:32:05.460

[这](http://www.west-wind.com/weblog/posts/740022.aspx)是您可以创建自己的模板的方式。我很确定某个地方已经存在一个，但如果不是，那就自己烤吧。不应该这么难。

# wcf - 从 silverlight 通过 wcf 发送图像时出现问题

> ID：1016594
> 
> 赞同：1
> 
> 时间：2009-06-19T06:25:09.993
> 
> 标签：wcf, silverlight, image, upload, send

Silverlight 将 WCF 与**basicHttpBinding结合使用**

```
<basicHttpBinding>              
    <binding name="BasicHttpBinding_BugsService" 
             maxBufferSize="2147483647" 
             maxReceivedMessageSize="2147483647">                  
       <security mode="None"/>
    </binding>              
</basicHttpBinding> 
```

我将图像作为 发送`byte[]`，只要图像小于 20KB，它就可以工作

但是当它更大时，我得到了错误：

> 远程服务器返回错误：NotFound

在 Reference.cs

```
public bool EndSave(System.IAsyncResult result) 
{
    object[] _args = new object[0];
    bool _result = ((bool)(base.EndInvoke("Save", _args, result))); // error
    return _result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T06:27:57.603

请在接口实现中捕获 wcf 端的异常并将其发布。

该错误可能与此问题有关：“ [WCF Message Size Issue](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/bc717eb1-f0a6-4932-868b-8d63b44f598d) ”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T06:28:39.270

检查绑定配置上的“maxReceivedMessageSize”属性（以字节为单位表示大小）。如果您的数据超过该大小，则该消息将被丢弃。

# javascript - 在 JavaScript 对象中使用构造函数有什么好处？

> ID：1016597
> 
> 赞同：0
> 
> 时间：2009-06-19T06:27:25.827
> 
> 标签：javascript, optimization, function, constructor

像这样使用构造函数有什么好处：

```
var MyLibrary = new function(){
    var self = this;
    self.MyLibrary = function(){
         // init code
    }

} 
```

而不是简单地在对象内部编写代码？

```
var MyLibrary = new function(){
    // init code
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T07:08:49.703

好吧，如果您使用原型继承来创建新类，您将执行以下操作：

```
function MyBaseClass() {
    // common stuff here
}

function MySubClass() {
    // subclass-specific stuff here
}

MySubClass.prototype = new MyBaseClass(); 
```

最后一行是建立继承链所必需的。但是，它也有执行 的主体的副作用`MyBaseClass`，这可能会导致问题（特别是如果`MyBaseClass`函数需要参数）。

如果您不希望这种情况发生，请执行以下操作：

```
function MyBaseClass() {
    this.init = function() {
        // initialisation stuff here
    }
    // common stuff here
}

function MySubClass() {
    // subclass-specific stuff here
    this.init();
}

MySubClass.prototype = new MyBaseClass(); 
```

初始化代码`init`现在仅在您创建`MySubClass`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T07:11:11.353

这些都不是很正确，虽然第二个可能有效，但不是真正的对象，更像是一个单例（但以一种奇怪的方式）。这是一个带有构造函数的类的示例：

```
// Class & Constructor definition
function Rectangle(w,h) {
    this.width = w;
    this.height = h;
}

// Now your class methods go on the prototype object
Rectangle.prototype.area = function() {
    return this.width * this.height;
} 
```

现在使用这个类：

```
var myRect = new Rectangle(3,4);
myRect.area(); 
```

您还可以通过使用匿名函数而不是命名函数将“构造函数”保存到 var 来定义类：

```
// Class & Constructor definition
var Rectangle = function(w,h) {
    this.width = w;
    this.height = h;
}

// Now your class methods go on the prototype object
Rectangle.prototype.area = function() {
    return this.width * this.height;
} 
```

# c# - Ref和Out之间的差异是什么？

> ID：1016601
> 
> 赞同：5
> 
> 时间：2009-06-19T06:28:35.900
> 
> 标签：c#, .net, syntax

> **可能重复：**
> [“ref”和“out”关键字有什么区别？](https://stackoverflow.com/questions/388464/whats-the-difference-between-the-ref-and-out-keywords)

`ref`和 和有什么不一样`out`？我对何时使用`ref`和感到困惑`out`。所以请说明如何使用`ref`and `out`，以及在哪些情况下使用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-19T06:33:36.127

*   当您传递一个初始化参数并且您希望方法/函数修改它时，您使用**Ref 。**
*   当您传递未初始化的参数时使用**Out**并且该方法必须初始化并填充该参数（否则您会收到警告甚至错误）。

    bool IsUserValid（字符串用户名）；

    void IsUserValid(string username, out bool valid);

上面的声明大致相同。返回值更容易，因此在这种情况下，您将使用返回类型。但是，如果您的方法还需要返回用户的出生日期，则不能在返回中返回两个参数，则必须使用 out 参数来返回其中一个参数（或使方法无效并将两者都返回为 out）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T07:11:07.077

需要注意的一件事是何时（不）将“ref”与引用类型参数一起使用。“ref”用于引用本身，而不是引用指向的对象的内容。

如果您“按值”传递引用（即，没有“ref”或“out”），则无法更改**引用**（因此“新”将无法在调用中存活），但是您仍然可以更改值此引用指向的属性（如果类允许）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T06:31:03.777

有什么更好的方式向您展示给您一个[MSDN 链接](http://msdn.microsoft.com/en-us/vcsharp/aa336814.aspx);)

从那个链接：

> ref 和 out 之间的区别是**微妙但重要的**。每种参数传递模式都旨在应用于略有不同的编程场景。out 和 ref 参数之间的重要区别是每个参数使用的明确分配规则。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T07:30:29.567

通常不赞成使用（或滥用） out 和 ref，通常返回结构或简单类要干净得多，其中包含您需要“返回”的多个字段。

至于 ref vs. out，out 需要一个未初始化的变量，除非在退出函数之前设置 out 参数，否则代码不会编译。

因此，下面的代码将***无法***编译：

```
bool TryParse(string text, out int result)
{
  if (text == null)
    return false;
  else
  {
     // do the parsing
  }
} 
```

ref's 不需要您设置它们。此外，正如 Hans 所提到的，您实际上可以在使用 ref 时“新建”引用类型的对象（因为您获得了对引用的引用，它大致等于 C++ 中的 object** 指针）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-27T12:20:37.627

实际上有 3 种方法可以将参数传递给方法：*按引用*、*按值*和*作为输出*。

*按值*是默认值，在 C# 中没有关键字（它在 VB.Net: 中有`ByVal`） - 它传递值类型的副本：

```
public void SomeMethod1(int num) 
{
    num = 2;
}

int myNum = 1;
SomeMethod1( myNum  );
// myNum is still 1, we just set a new one 
```

令人困惑 -*按值*传递引用类型*的引用副本。*这意味着您对引用类型的更改指向实例，但您只有一个指向引用的实际指针的副本：

```
public void SomeMethod1(MyClass instance) 
{
    // changes the name on the instance
    instance.Name = "test 1";

    // we're only nulling the copy passed to this method
    instance = null;
}

public void SomeMethod2(MyClass instance) 
{
    // changes the name on the instance
    instance.Name = "test 2";

    // this is a new instance only in this method
    instance = new MyClass { Name = "new instance" };
}

MyClass myInst = new MyClass { Name = "original" };
SomeMethod1( myInst );
// myInst.Name is now "test 1"

SomeMethod2( myInst );
// myInst.Name is now "test 2" 
```

好的，现在*通过引用*（`ref`在 C# 或`ByRef`VB.Net 中）传递对结构值的引用：

```
public void SomeMethod1(ref int num) 
{
    num = 2;
}

int myNum = 1;
SomeMethod1( ref myNum  );
// myNum is now 2, we changed the reference 
```

很简单，但对于引用类型*，通过引用*传递实际指针到实例，而不是副本：

```
public void SomeMethod1(ref MyClass instance) 
{
    // changes the name on the instance
    instance.Name = "test 1";

    // we're nulling the reference passed to this method
    instance = null;
}

public void SomeMethod2(ref MyClass instance) 
{
    // changes the name on the instance
    instance.Name = "test 2";

    // this is a new instance replacing the original
    instance = new MyClass { Name = "new instance" };
}

MyClass myInst = new MyClass { Name = "original" };
SomeMethod1( ref myInst );
// myInst.Name will now throw a NullReferenceException because myInst is null

SomeMethod2( ref myInst );
// myInst.Name is now "new instance" 
```

因此，虽然*通过引用*和*按值*对于引用类型来说都是相似的，但如果您更改引用本身（而不是您所指的内容），则行为是非常不同的。

最后*作为输出*是一个额外的返回变量，就像实际的返回一样。这两个基本相同：

```
public int SomeMethod1() 
{
    return 1;
}

public void SomeMethod2(out int num) 
{
    num = 1;
} 
```

如果你有一个 out 参数，它必须由方法填充（就像返回一样）。

# java - 如何制作一个永不结束的迭代器？

> ID：1016605
> 
> 赞同：12
> 
> 时间：2009-06-19T06:29:46.743
> 
> 标签：java, iterator, infinite

我只是想知道无限期地迭代一个集合的最简单方法是什么，即当它到达末尾时它`next();`调用第一个对象。我假设这不是 Java 中已经预定义的函数，所以只是寻找在 Java 中实现它的最简单方法。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-06-19T06:47:04.157

优秀的[Google Collections](https://github.com/google/guava)库中有一个方法可以做到这一点：

```
Set<String> names = ...;
Iterable<String> infinite = Iterables.cycle(names); 
```

（我不能强烈推荐 Google Collections 库。它非常困难。我在为 Google 工作时有偏见，但我认为几乎每个编写 Java 的 Google 人都会告诉你这些集合有多么有用。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T11:55:25.367

```
Iterator it = mylist.iterator();
while (it.hasNext())
{
  MyType t = (MyType)it.next();

  // do something

  if (!it.hasNext())
    it = mylist.iterator();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-19T09:04:25.863

[`EndlessIterator`](http://static.javadoc.io/org.cactoos/cactoos/0.10/org/cactoos/list/EndlessIterator.html)从[Cactoos](http://www.cactoos.org)尝试：

```
Iterator<String> names = new EndlessIterator<>("John"); 
```

它会永远回来`"John"`，永远不会结束。

此外， check [`EndlessIterable`](http://static.javadoc.io/org.cactoos/cactoos/0.10/org/cactoos/list/EndlessIterable.html)，它实现`Iterable`并执行相同的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T06:31:09.563

如果您正在创建迭代器，则在下一个方法中，您可以使用 if 条件来检查列表中是否存在另一个对象。如果有，则返回该对象，如果没有，则返回列表的开头并返回该对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T06:32:11.027

这是我能想到的...

```
iterator = set.getIterator
//other code
if (iterator.hasNext())
    //do code here
else
    iterator = set.getIterator(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-21T21:51:18.427

我认为你想要的永远不会帮助你可以用你的迭代器做任何事情，这很容易，但你必须小心你添加的任何新东西，我不使用这种风格，但这就是你想要的：

if (! It.hasNext() ) { while ( It.hasPrevious() ) { It = It.Previous(); } } else { 它 = It.Next(); }

如果您真的有兴趣，那么这种方式没什么用，您应该在推送新列表时始终将最后一个指针指向第一个指针。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-25T05:55:57.277

怎么样 ？

```
List<String> list = // ArraysList
Interator<String> it = null;

while(true) {
 it = list.iterator();
 while(it.hasNext()) {
   System.out.println(it.next());
 }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-13T18:45:21.823

如果您不想使用 Guava 但仍想要可重用的解决方案：

```
public static class CyclicIterator<E, C extends Collection<E>> implements Iterator<E> {
    final private C mElements;
    private Iterator<E> mIterator;

    public CyclicIterator(C elements) {
        mElements = elements;
        mIterator = elements.iterator();
    }

    @Override
    public boolean hasNext() {
        if (! mIterator.hasNext()) {
            mIterator = mElements.iterator();
        }
        return mIterator.hasNext();
    }

    @Override
    public E next() {
        if (! mIterator.hasNext()) {
            mIterator = mElements.iterator();
        }
        return mIterator.next();
    }
} 
```

注意：这不支持 remove() 方法，但如果需要可以轻松添加。它也不是线程安全的。

# python - 寻找火狐版本

> ID：1016609
> 
> 赞同：1
> 
> 时间：2009-06-19T06:30:56.303
> 
> 标签：python, firefox

如何使用 python 查找 Firefox 版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T22:05:49.153

我尝试了 Alan 的代码片段，但它对我不起作用。它的一个问题是，为了使“-v 或 -version”标志起作用，您必须有一个调试版本的 firefox。有关详细信息，请参见[此处](https://developer.mozilla.org/En/Command_Line_Options)的“杂项”。

尝试以下操作，它使用 win32 库直接从 .exe 文件中读取 Product Version 字符串：

```
import win32api

def get_version(filename):
    info = win32api.GetFileVersionInfo(filename, "\\")
    ms = info['ProductVersionMS']
    ls = info['ProductVersionLS']
    return win32api.HIWORD(ms), win32api.LOWORD(ms), win32api.HIWORD(ls), win32api.LOWORD(ls)

if __name__ == '__main__':
    print ".".join([str (i) for i in get_version(r"C:\Program Files\Mozilla Firefox\firefox.exe")]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T06:39:53.183

试试下面的代码片段：

```
import os
firefox_version = os.popen("firefox --version").read() 
```

# c# - 根据输入到文本框中的值动态更改网格视图

> ID：1016610
> 
> 赞同：0
> 
> 时间：2009-06-19T06:31:01.733
> 
> 标签：c#

我有一个文本框和一个网格视图。根据在文本框中输入的值填充网格视图。假设我在文本框中输入任何名称。当我在文本框中输入名称时，网格中的结果应该会动态变化。例如，如果我在文本框中输入 John，在输入 Jo 后，网格应该填充以 Jo 开头的结果，如果我输入 h，网格应该用 Joh 填充结果，依此类推。请为此建议我一个解决方案（在c＃中）。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T11:36:22.907

[这是一个很好的将 DataGridView 绑定到 Collection](http://www.switchonthecode.com/tutorials/csharp-tutorial-binding-a-datagridview-to-a-collection)的参考网站。这具有您正在寻找的两种方式绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T07:03:36.327

您需要处理 txtBox 的文本更改事件。并使用与文本框匹配的数据重新绑定数据网格

```
private void txtBox_TextChanged(object sender, EventArgs e)
{
    string strValue = this.txtBox.Text;
    DataSet ds = ... // Get the dataset that matches strValue 
    this.dgrid.DataSource = ds;
} 
```

但是，在用户键入每个字母后重新加载数据网格将是一项非常昂贵的操作。我建议在用户输入文本后提供一个重新加载按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T07:35:43.907

如果您的数据不是很频繁地更改（例如用户在表单或页面上进行的许多更改），那么您可以获取所有数据并将其缓存在您自己中。然后，您只需根据输入到文本框中的值过滤此数据集：

```
 private void textBox1_TextChanged(object sender, EventArgs e)
    {
        if (tb.Text == "")
        {
            //Unfilter the data
            gv.DataSource = dtb;
            return;
        }
        //Get default view of your data table and filter
        DataView dv = dtb.DefaultView;

        //Suppose your column name is "Value"
        dv.RowFilter = "Value like '" + tb.Text + "%'";

        gv.DataSource = dv;
    } 
```

但是您不认为在每次按键时过滤大量数据很繁重。您可以在文本框的焦点丢失（模糊）或用户按下回车键时执行此操作。只是我的想法...

# iphone - AVAudioPlayer 只能在模拟器中播放，但不能在设备中播放，为什么？！(iPhone-SDK)

> ID：1016618
> 
> 赞同：2
> 
> 时间：2009-06-19T06:32:07.970
> 
> 标签：iphone, audio

我有以下播放声音的简单代码

```
NSString *soundPath = [[NSBundle mainBundle] pathForResource:@"sound" ofType:@"wav"];
    player =[[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath: soundPath] error:nil];
    player.volume = 1;
    player.numberOfLoops = 0;
[player prepareToPlay];
        [player play]; 
```

出于某种原因，此代码仅在模拟器中播放，但不在设备中播放，有什么想法吗？

* * *

更新：实际上我在 3.0 上安装了 AvTouch，一个来自 Apple 的示例应用程序，但它也不起作用。AVAudioPlayer 有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T06:40:04.760

当音频文件使用的编解码器在 OS X 上可用，但在 iPhone 上不可用时，就会发生这种情况。当扩展名与文件的实际内容不匹配时也会引起这种情况。逐步使用调试器并观察调试控制台中的编解码器错误，或使用`afconvert`.

# sql - 需要选择查询

> ID：1016620
> 
> 赞同：0
> 
> 时间：2009-06-19T06:32:52.743
> 
> 标签：sql, sql-server, select

考虑以下带有数据的表结构 -

```
AdjusterID  |  CompanyID  |  FirstName  | LastName | EmailID
============================================================
1001        | Sterling    | Jane        | Stewart  | janexxx@sterlin.com
1002        | Sterling    | David       | Boon     | dav@sterlin.com
1003        | PHH         | Irfan       | Ahmed    | irfan@phh.com
1004        | PHH         | Rahul       | Khanna   | rahul@phh.com
============================================================ 
```

其中 AdjusterID 是主键。没有。一家公司的调整员。

我需要一个查询，列出每家公司的单个调整器。即我需要得到结果 -

```
========================================================
1001 | Sterling  | Jane  | Stewart | janexxx@sterlin.com
1003 | PHH       | Irfan | Ahmed   | irfan@phh.com
======================================================== 
```

如果有人可以帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T06:51:34.570

单程：

```
SELECT * FROM Adjusters 
WHERE AdjusterID IN(SELECT min(AdjusterID) 
                    FROM Adjusters GROUP BY CompanyID) 
```

还有一些涉及联合和迭代的其他方法，但是这个很简单，可以让您入门。

编辑：根据您的示例，这假设您想要具有最低 ID 的调节器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T07:00:43.040

我知道杰里米的回答是有效的，所以我不会重复。但是您可以使用所谓的 tie-breaker 尝试另一个：

```
--//using a tie-breaker. Should be very fast on the PK field
--// but it would be good to have an index on CompanyID
SELECT  t.* 
FROM    MyTable t
WHERE   t.AdjusterID = (SELECT TOP 1 x.AdjusterID FROM MyTable x WHERE x.CompanyID = t.CompanyID ORDER BY AdjusterID) 
```

在性能方面可能会更好。但更有用的是，如果您在表中有另一列，并且您不仅要为每家公司选择一个，而且要为每家公司选择*最好*的列，并使用其他列排名作为标准。因此`ORDER BY AdjusterID`，您将按其他列排序，而不是 。

# silverlight-3.0 - 如何在项目中编译链接的 Silverlight 页面

> ID：1016621
> 
> 赞同：0
> 
> 时间：2009-06-19T06:33:02.993
> 
> 标签：silverlight-3.0, navigation

我有两个项目，一个是 SL 导航应用程序，另一个是包含一些 SL 导航页面的 SL 库。如何让导航应用程序在运行时可以在其他库中找到导航页面？

我试图将该页面添加为链接项，但它也无法导航到该页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T20:17:06.537

您是否在 SL 导航应用程序中添加了 SL 库作为参考？

# sql - 如何加快对聚集列的大规模更新？

> ID：1016631
> 
> 赞同：7
> 
> 时间：2009-06-19T06:37:40.457
> 
> 标签：sql, sql-server, performance, indexing

我有一个非常大的表：20+ 百万行，我需要更新其中的 5% - 或 100 万行。

不幸的是，我正在更新用作聚集索引的 (int) 列。

**我的问题是：更新这些行的最快方法是什么？**

我试过直接更新行：

```
update t1
set t1.groupId = t2.groupId
from
    table t1
join newtable t2 on t1.email = t2.email 
```

但这需要太长时间（我在 3 小时后停止了它）

我认为这是因为每次更新都会移动整行（有 2 个日期时间、2 个 varchar 和 2 个整数）。

如果我先删除聚集索引，然后进行更新，然后重新创建聚集索引会怎样？那会更快吗？

注意：我在电子邮件上有一个非聚集索引，以防有人认为查询的选择部分很慢。它不是。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T07:57:23.613

这是我所做的（而且速度要快得多）：

1.  我删除了聚集索引。
2.  我还删除了外键引用（另外两个 int 列）。
3.  我运行了更新语句
4.  我重新创建了索引，这比预期的要快。（这是我首先问 SO 的最初原因）。

这将整个过程缩短到几秒钟。 **是的，大约 15 秒内大约 100 万行。**

第二步至关重要，因为外键迫使更新对相关表进行某种假脱机，每个表也有大量行。

由于这些外键查找，物理读取的数量增加了两倍。

我不确定 SQL Server 为什么需要这样做，但我的猜测是，即使我没有更新该列但我正在移动整行（聚集列更新），它仍然会执行完整性检查。

* * *

附带说明一下，我还尝试过批量运行更新：

```
update top(1000) t1
set t1.groupId = t2.groupId
from
    table t1
join newtable t2 on t1.email = t2.email 
```

这很好（并且似乎每批扩大到大约 10K），但它仍然是每批 1-2 分钟的数量级。

* * *

总而言之，我了解到对于批量更新，暂时删除索引会很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T07:57:09.887

我认为前面的评论是正确的。你已经回答了你自己的问题。

因为

> 聚集索引根据键值对表中的数据行进行排序和存储（源 msdn），

您最好只删除聚集索引（将索引保留在电子邮件中）。操作完成后，重新创建聚集索引。只要 groupid 不涉及任何其他索引，我就不会碰它们。如果组 id 涉及其他索引，则删除它们。我至少会在电子邮件上留下一个索引，只是为了快速加入。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-19T07:12:54.483

为什么不执行以下操作：

*   将不同的列（varchar 之一）设为聚集索引
*   在您的 groupId 上创建索引
*   更新
*   然后反转这个过程。

这应该更快。

# java - 单击表单按钮打开新的浏览器窗口

> ID：1016644
> 
> 赞同：1
> 
> 时间：2009-06-19T06:42:59.233
> 
> 标签：java, javascript, html, window.open

我想打开一个新浏览器并从文件系统加载一个页面（将在单击该按钮时创建）。我的应用程序是一个 java servlet。基本上我允许用户在他们的网站上更改一些 HTML。单击按钮后，用户将看到一个预览页面，该页面显示了页面在进行更改后的样子。

什么是最简单的方法，您可以看到哪些问题，以及我们可能如何解决这些问题。

我看到一个问题，例如，如果浏览器窗口试图立即打开文件，它甚至都不存在。所以在尝试读取文件之前可能需要一些延迟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T06:48:38.130

这可以使用 java 脚本来完成

window.open('url','name',....)

您可以在此函数中传递参数。

谷歌“javascript window.open 函数”

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:54:05.377

也许您可以使用 jQuery/AJAX 或类似的技术先将数据发布到服务器，然后在新窗口中打开它。

有关示例，请参见 jQuery 文档：[jQuery Post 示例](http://docs.jquery.com/Ajax/jQuery.post#urldatacallbacktype)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T06:57:02.890

如果预览页面没有太多数据要传递，您可以将其作为 url 参数传递，而不是使用 jQuery。如果数据很大，最好使用 jQuery。:)

作为[http://www.xyz.com?name=](http://www.xyz.com?name=) “名称”.....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T06:58:38.100

我不熟悉java servlet，但是您不能将上传的html保存在服务器端会话变量中，在预览页面中显示内容，然后在用户接受后将变量的内容保存到文件系统中变化 ？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-15T22:56:00.967

你可以使用 JavaScript。在您添加的按钮上：

```
onClick="doMyOpenWindowFuncion();" 
```

并在页面的脚本部分中编写一个函数，例如

```
function doMyOpenWindowFunction() {
    // if you want the client to wait, heres the place to do so.
    // I assume you can make your servlet wait so the next line opens a window to the servlet
    openWindow('/MyFancyPreviewServlet', 'Preview Window');
} 
```

在您的 Servlet 中，您只需等待文件出现，然后再交付它。

# sockets - UDP 套接字上的套接字错误 10052

> ID：1016655
> 
> 赞同：12
> 
> 时间：2009-06-19T06:48:59.690
> 
> 标签：sockets

我们有一个 .NET 2.0 桌面应用程序，它通过 UDP 发送和接收网络数据包。

一些用户报告了偶尔的套接字错误 10052，当代码在 UDP 套接字上调用 socket.BeginReceiveFrom 时会发生这种错误。

这是什么意思？

套接字错误 10052 的官方 MS 文档说 - 引用：“WSAENETRESET (10052) 重置时网络断开连接。由于在操作进行时检测到故障的保活活动，连接已断开。它也可以通过以下方式返回如果尝试在已经失败的连接上设置 SO_KEEPALIVE，则设置sockopt。"

这对于 UDP 套接字没有多大意义，因为 UDP 是一个无连接协议。

我知道另一个与 UDP 套接字相关的关闭错误代码 10054 意味着收到了 ICMP 消息“端口不可达”，我想知道 10052 是否可能映射到另一个 ICMP 消息？

我已经用谷歌搜索了几个月，阅读网络书籍等，但找不到任何东西。请帮助 - UDP套接字上的套接字错误10052是什么意思？

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-06-20T12:21:47.143

请参阅[http://msdn.microsoft.com/en-us/library/ms740120%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms740120%28v=vs.85%29.aspx)，其中描述了**recvfrom**函数。它说 WSAENETRESET （这是 winsock 错误 10052）：

> 对于数据报套接字，此错误表示生存时间已过期。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T08:14:32.967

发送 UDP 数据报时，请确保 TTL 值足够高。

如果您使用的是 UdpClient 类。然后在发送数据报之前使用以下内容：

```
myUdpClient.Ttl = 255; 
```

注意：255 是 TTL 的最大值。如果该值不够，则存在一些网络问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-12T03:13:04.440

WSAE **NET** RESET 表明它是由于网络接口本身的重置而发生的。您的程序坐在那里绑定到一个 UDP 端口，所以从某种意义上说，它*是*连接的，但连接到网络接口而不是远程对等点。

尝试启动您的程序，使其到达将要进行此 BeginReceiveFrom 调用的位置，然后在设备管理器中禁用您的 NIC 并重新启用它。或者，使用 Wi-Fi，断开并重新建立与 WAP 的连接。它甚至可能通过将以太网电缆拔到您的机器上来发生，因为最新版本的 Windows 默认会在发生这种情况时终止通过该 NIC 连接的所有套接字。

它将解释来自该领域的罕见问题报告。这可能仅在硬件级别存在一些本地网络故障时才会发生。

# c# - 限制 Textarea 不接受 250 个字符

> ID：1016656
> 
> 赞同：7
> 
> 时间：2009-06-19T06:49:30.780
> 
> 标签：c#, .net, asp.net, javascript, html

我在 C# 中有一个 textarea，请参见下面的代码：

```
<asp:Label ID="lblQuestions" runat="server" CssClass="addinfo">
                    Question & Comments</asp:Label>
<asp:TextBox ID="txtQuestions" Rows="5" Columns="5" TextMode="MultiLine" runat="server" MaxLength="250"></asp:TextBox> 
```

现在我希望 textarea 不应接受超过 250 个字符，无论用户通过 WRITING 和 DRAG & DROP 等方式进行复制和粘贴，如果用户尝试复制或拖放超过 250 个字符，则应将前 250 个字符复制到 textarea . 我知道 TEXTAREA 中没有 MAXLENGTH 属性。如果无法使用 .NET，则使用 javascript 或 Jquery 的解决方案将起作用。

请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T06:53:34.723

您必须为事件连接函数

您要执行此操作的区域的 onpaste、onkeyup 和 onfocus。

对于 asp 文本框，我认为您只需要考虑 OnTextChanged 事件。

对于文本区域

```
<INPUT id="counterMessage" readOnly size="3" value="250" name="counterMessage">                                                                                                     
<TEXTAREA onpaste="PasteCounter(this.form.txtAreaMessage,this.form.counterMessage,250);"
                                                                                                                            id="txtAreaMessage" onkeyup="textCounter(this.form.txtAreaMessage,this.form.counterMessage,250);"
                                                                                                                            style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; OVERFLOW: hidden; BORDER-LEFT: 0px; WIDTH: 99%; BORDER-BOTTOM: 0px; HEIGHT: 95px; TEXT-ALIGN: justify"
                                                                                                                            onfocus="textCounter(this.form.txtAreaMessage,this.form.counterMessage,250);" name="txtAreaMessage"
                                                                                                                            rows="3" runat="server"></TEXTAREA>

function PasteCounter(field, countfield, maxlimit)
        {
            var len;
            var txt = clipboardData.getData("Text");
            txt = field.value + txt
            len = parseInt(txt.length);
            if ( len >  maxlimit )
            {
                event.returnValue=false;
                txt = txt.substring(0, maxlimit);       
                field.value = txt;                  
                alert("Only " + maxlimit + " characters are allowed");
            }
            countfield.value = maxlimit - txt.length;
        }    
        function textCounter(field, countfield, maxlimit)
        {
            if (field.value.length > maxlimit )
            {      
                field.value = field.value.substring(0, maxlimit );
                alert("Only " + maxlimit + " characters are allowed");
            }
            countfield.value = maxlimit - field.value.length;
        } 
```

计数字段文本框用于显示剩余字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-08T19:36:54.700

您可以使用 jQuery 一次绑定到多个事件

```
$("#txtQuestions").bind("keyup change blur input paste", function() {
  // fire this off a few ms after the event happens
  setTimeout(
   (function(el){ // closure to store "this" as "el"
     return function() { if (el.value.length>250) el.value.length = 250; }
   })(this), 10);
}); 
```

那里有一个[库（jQuery.charcounter）](http://www.tomdeater.com/jquery/character_counter/)，它会自动将剩余的字符以及不添加到 DOM 的字符添加到 DOM 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T07:24:32.917

您也可以使用 ASP.NET 验证器执行此操作：

```
<asp:TextBox ID="MyTextBox" runat="server" TextMode="MultiLine" Rows="4" />
<asp:RegularExpressionValidator Display="Dynamic" ID="RegularExpressionValidator1" ControlToValidate="MyTextBox" Text="<p>A maxiumum of 250 characters is allowed.</p>"  runat="server" ValidationExpression="^(.|\s){0,250}$" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T07:16:33.900

1) 一个非常简单的处理方法是从 onChange 事件开始：

```
<textarea id="yourTextArea" onchange="this.value.length = Math.min(this.value.length, 250)"></textarea> 
```

这里的主要缺点是，直到焦点离开 textarea，textarea 才会更新。

2) 您应该能够将上面的示例改编为表单验证函数，该函数在表单的 onSubmit 事件上触发。

```
<script type="text/javascript">
    document.forms[0].onsubmit = function() { document.getElementById("yourTextArea").value.length = Math.min(this.value.length, 250); }
</script> 
```

3) 如果你想在服务器端做这个验证，你真的只需要获取 textarea 的值并截断它。

```
string validText = yourTextArea.Value.Substring(0, 250); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-27T20:18:00.977

扩展@gnarf的答案：

```
<textarea class="max-length" cols="30" id="comment-box" maxlength="250" rows="10"></textarea></span>
<span id="comment-box-chars-left">250</span> characters left
<script type="text/javascript>
    function updateCharsLeft(id, maxChars, length) {
        $('#' + id + '-chars-left').html(maxChars - length);
    }

    $(document).ready(function() {
        $('.max-length').each(function() {
            updateCharsLeft($(this).attr('id'), $(this).attr('maxLength'), $(this).val().length);
        });

        $('.max-length').bind('keyup change blur input paste', function() {
            var maxChars = $(this).attr('maxLength');

            // fire this off a few ms after the event happens
            setTimeout((function(el) { // closure to store "this" as "el"
                return function() {
                    if (el.value.length > maxChars) {
                        el.value = el.value.substring(0, maxChars);
                    }
                    updateCharsLeft(el.id, maxChars, el.value.length);
                }
            })(this), 10);
        });
    });
</script> 
```

这使用属性来指定最大字符数并更新显示剩余字符数的标签。文本区域必须具有类 max-length 并且将显示剩余字符数的元素必须与相应的文本区域具有相同的 id 并附加 -chars-left 。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T07:16:45.850

对于交互式反馈，您应该在 javascript 中执行上述操作，因为有线控件在回传到服务器之前不会做出反应（需要重新加载页面）。如果您在每次击键时更新字符计数，这可能会导致相当多的服务器负载。

下面是一个粗略的 js 实现，它将简单地计算每次更改时的 ASCII 字符数。如果由于剪切和粘贴而修改了文本区域，这也将起作用：

```
<script type="text/javascript">
function countWords() {
var text = document.getElementById("txtBox1").value;
if (text.length > 250) text = text.substr(0,250);
document.getElementById("txtBox1").value = text;
}
</script>

<textarea id="txtBox1" onkeyup="countWords();" >text here</textarea> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-15T12:19:20.157

```
<asp:TextBox
    onkeypress="return value.length<=10;"
    onpaste="return (value.length+clipboardData.getData('Text').length)<=10"
    TextMode="MultiLine"
    runat="server"  
/> 
```

# c# - c#中一些数据的映射

> ID：1016669
> 
> 赞同：1
> 
> 时间：2009-06-19T06:56:09.787
> 
> 标签：c#, list, mapping

我正在寻找在 c# 中映射数据的良好解决方案。
起初我有一个字符“a”和一个角度“0.0”度。
映射的最佳解决方案是什么？一个列表 ？

一个要求是，如果学位不在“列表”中，我必须搜索它，然后我添加一个新的..等等

感谢帮助 ：）

**编辑：我必须找出角度是否存在！如果角度不存在，则添加一个新字符**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T06:58:45.087

字典<double,char>

例子：

```
Dictionary< double, char> dic = new Dictionary< double, char>();
//Adding a new item
void AddItem(char c, double angle)
{
    if (!dic.ContainsKey(angle))
        dic.Add(angle,c);
}
//Retreiving an item
char GetItem(double angle)
 {
    char c;
    if (!dic.TryGetValue(angle, out c))
        return '';
    else
        return c;   
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T06:59:37.270

使用字典。

```
var d =new Dictionary<string,double> ()` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T07:02:31.103

字典应该没问题：

```
Dictionary<string, float> dict = new Dictionary<string, float>();
dict.Add("a", 0.0);
float angle = dict["a"]
if( !dict.Contains("b"))
{
  dict["b"] = 1.0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T07:02:37.920

也许一个`SortedDictionary`.?

```
 private SortedDictionary<string, double> _myStuff;

...

if (!_myStuff.ContainsValue(0))
... 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-19T07:00:37.520

[Hashtable](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)看起来就是您正在寻找的东西。将学位设置为 Hashkey，您以后可以很容易地搜索它。

```
 Hashtable ht = new Hashtable();
if (!ht.ContainsKey(angle))
    ht.Add(key, value);
```

# mysql - 如何使用 -initWithContentsOfURL 获取 MySQL 查询结果？

> ID：1016670
> 
> 赞同：0
> 
> 时间：2009-06-19T06:56:18.383
> 
> 标签：mysql, xml, iphone

我有一个从 MySQL 表中获取结果的服务器端 php 脚本。我正在尝试从 iPhone OS 应用程序中检索这些结果。我正在使用以下方法：

```
NSURL *myURL = [NSURL URLWithString:@"http://www.someurl.com/login.php?id=anid"];
NSArray *sqlResults = [[NSArray alloc] initWithContentsOfURL:myURL];

//Show me what went into the Array
NSLog(@"%@", [sqlResults ObjectAtIndex:0]); 
```

*底部的 NSLog 是我试图查看刚刚发生的事情。NSLog 语句正在打印出来（空）——所以我被卡住了。我的问题是我不知道我到底要对结果的 NSArray 做什么，而且我可能做错了很多事情。是否暗示了互联网连接（有蜂窝网络和 Wi-Fi）？所以，我的问题是：我应该怎么做才能使用 -initWithContentsOfURL 获取 MySQL 查询结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T07:08:05.353

您的 PHP 脚本以哪种格式返回 MySQL 结果？看起来 [NSArray initWithContentsOfURL:] 要求数据采用非常特定的“属性列表”格式。如果您改用 NSString，您是否尝试过查看得到的输出？：

```
[NSString initWithContentsOfURL:encoding:error:] 
```

这至少应该向您展示您从 PHP 脚本中得到了什么。最后，看一看[属性列表格式](http://en.wikipedia.org/wiki/Property_list#Mac_OS_X)。您可能需要按照 BJ Homer 的建议在服务器端脚本中执行转换或解析 iPhone 上的 PHP 结果集格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T07:06:36.870

根据`-[NSArray initWithContentsOfURL:]`say的文档；

> 由 aURL 标识的位置的数组表示必须仅包含属性列表对象（NSString、NSData、NSArray 或 NSDictionary 对象）。

据我了解，这意味着它必须是 plist 格式。如果您的结果不是 plist 格式，请尝试`-[NSString initWithContentsOfURL:]`改用。如果您想根据行拆分它，您可以调用`[downloadedString componentsSeparatedByString:@"\n"]`

# c - 将指针传递给函数

> ID：1016676
> 
> 赞同：1
> 
> 时间：2009-06-19T06:57:42.187
> 
> 标签：c, pointers

我对我的程序有疑问

```
#include<stdio.h>

int myFunc(char **);
main()
{
    char *a[2]={"Do","While"};
    myFunc(a);
}

int myFunc(char **P)
{
    /* Here I want to print the strings passed but I'm unable to
       print the strings I just tried the below statement which
       printed just the first letter which is 'D'*/
       printf("%c",**P);
} 
```

当我尝试

```
printf("%s",**P); 
```

我收到运行时错误。所以有人可以帮我吗？

谢谢马杜

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T07:03:01.117

将大小作为参数，让函数知道您的数组中有多少个字符串。然后，您应该迭代数组并打印每个数组。

```
int myFunc( char** p, int size)
{
  for( int i = 0; i < size; ++i)
  {
     printf("%s", p[i]);
  }
} 
```

*稍后编辑（根据要求:-)）*

```
int main( int, char**)
{
   char *a[2]={"Do","While"};
   myFunc( a, 2); // Could be myFunc( a, sizeof(a)/sizeof(char*));
   // ...
   return 0; 
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T07:02:37.687

星星太多 - 试试

```
printf("%s",*P); 
```

而且您需要`%s`格式说明符 -`%c`仅适用于单个字符。

如果要打印所有字符串，则需要在数组中传递字符串数，然后从循环中打印这些字符串。

检查 Cătălin Pitiş 建议的代码。要传递字符串的数量，您可以像这样调用函数：

```
myFunc(a, sizeof(a)/sizeof(a[0])); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T07:02:19.450

```
for( int i = 0; i < 2; i++ ) {
    char* string = P[i];
    printf( "%s", string );
} 
```

你应该使用某种方式将数组的大小传递给函数——或者将它作为一个 int 参数传递，

```
int myFunc(char **P, int size)
{
    for( int i = 0; i < size; i++ ) {
        //whatever here
    }
} 
```

或始终将零值附加到数组，并且仅循环直到找到该零值。

```
char* array[] = { "String1", "String2", 0 }; 
```

否则你将很难维护代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T07:22:59.410

我喜欢 Objective-C 风格的 nil (0) 终止数组：

```
void myFunc(char **P)
{
    while (*P)                   // loop to iterate over all strings until 0
       printf("%s\n",*P++);      // print and move to next element in array
}

int main()
{
    char *a[]={"Do","While",0};  // added 0 to null terminate array,
    myFunc(a);                   // kind of like string
} 
```

输出：

```
Do
While 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T07:10:29.217

首先，好消息： 的类型`a`等价于`char **`，因此您将有效参数传递给`myFunc()`。

第一个问题是`%c`格式说明符，表示打印单个字符。由于`**P`是一个计算结果为单个字符的表达式，因此您的第一个版本完全按照您的要求执行。那不是你想要的。

第二个版本在语法上接近正确。它应该是`printf("%s", *P)`，其中`*P`是一个表达式，其计算结果为指向一个以 nul 结尾的 ASCII 字符串的指针。在这种情况下，它评估为“Do”。此版本不会打印两个字符串。

尽管数组的名称确实与指向其第一个元素的指针相同，但这是一种“对学生的谎言”。将数组传递给函数不会也不能传达数组的长度。为此，您需要包含长度的第二个参数，或者像字符串上的 nul 终止符这样的约定来指示数组的结尾。通过该更改，您可以修改`myFunc()`为对传递的元素使用循环并打印每个元素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T07:26:01.743

您的代码中的问题是您想要打印一个字符串 (char*) 但您给它一个 char。请记住，P 是一个 char* 数组。当您取消引用一次时，您会得到一个 char*; 当您第二次执行此操作时，您只会在 char* 的开头得到 char。

当您尝试将 char 值与 %s 说明符一起使用时，它会将值视为指针，并尝试取消引用该值。因此，它将尝试在内存位置 X 打印“字符串”，其中 X 是 char 的值（即从 0 到 255 的值）。这会给您一个访问冲突/分段错误（您在运行时看到的错误）。

[正如Cătălin Pitiş](https://stackoverflow.com/questions/1016676/passing-of-pointers/1016695#1016695)和[RBerteig](https://stackoverflow.com/questions/1016676/passing-of-pointers/1016708#1016708)所指出的，最好的解决方法是：

*   传递另一个参数来指定数组的长度
*   在数组末尾添加一个额外的 null。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T12:03:17.597

如果您不想保留和传递数组大小::

```
int myFunc(char **);
main()
{
    char *a[2]={"Do","While", NULL};
    myFunc(a);
}

int myFunc(char **P)
{
    if( !P )
        return 0;
    while(*P != NULL)
    {
        printf("%s",*P);
        P++;
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T07:03:45.423

错误答案：我认为您可能必须在打印时取消引用 P，尽管我可能是错的。

编辑：我累了，现在是凌晨 3 点，但我不想睡觉，所以我在这里试图回答问题。在阅读了批评之后，我重新阅读了这个问题并注意到他确实取消了 P，但正如另一个答案中所述，它被取消了太多。当一个人想要打印一个 char 字符串时，一个人想要传递一个指针，因为 char 字符串实际上是一个数组。

另一个编辑：我还想指出，提出问题的人在我回答后进行了编辑，当我第一次回答时，它没有读到“printf(“%s”，**P);” 它读作“printf(”%s", P);” 最后一部分是粗体的。

# linux - 内核参数

> ID：1016681
> 
> 赞同：6
> 
> 时间：2009-06-19T06:59:24.837
> 
> 标签：linux, linux-kernel, boot, bootstrapping, bootloader

内核是否需要从引导加载程序中获取任何内容。通常内核能够从头开始启动系统，那么为什么它需要引导加载程序中的任何内容呢？我见过这样的内核启动消息。

```
"Fetching vars from bootloader... OK" 
```

那么传递的变量***到底是什么？***另外，如何从引导加载程序传递变量？是通过堆栈吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T07:01:47.830

Linux 内核从引导加载程序接受了一些参数，我现在能记住的是`vga`参数。例如：

```
kernel /vmlinuz-2.6.30 root=/dev/disk/by-uuid/3999cb7d-8e1e-4daf-9cce-3f49a02b00f2 ro vga=0x318 
```

看看[你应该知道的关于 Linux 内核的 10 个启动时间参数，](http://www.cyberciti.biz/tips/10-boot-time-parameters-you-should-know-about-the-linux-kernel.html)它解释了一些常见的参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T10:20:30.767

内核接受所谓的基于文本的命令行选项。这非常有用，因为您无需重新编译内核就可以做很多事情。至于参数传递，它取决于架构。在 ARM 上，它是通过指向内存中某个位置或内存中固定位置的指针来完成的。

这是它在[ARM](http://www.simtec.co.uk/products/SWLINUX/files/booting_article.html)上的完成方式。通常内核不能从头开始引导机器。可能来自bios，但不是从头开始。它需要一些初始化，这是引导加载程序的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T01:03:09.863

对于 Linux 内核，引导加载程序必须告诉内核一些事情。它包括诸如内核命令行之类的东西（正如其他几个人已经提到的那样），在内存中已加载[initrd](http://en.wikipedia.org/wiki/Initrd)的位置及其大小，如果正在使用 initrd（内核无法自行加载它；通常在使用 initrd 时） ，访问存储设备所需的模块位于 initrd 中，并且在能够访问存储之前还必须进行一些相当复杂的设置），以及一些杂乱无章的事情。

有关传统 x86 架构（32 位和 64 位）的更多详细信息，包括如何将这些变量传递给内核设置代码，请参阅[Documentation/x86/boot.txt （链接到 2.6.30 的版本）。](http://lxr.linux.no/linux+v2.6.30/Documentation/x86/boot.txt)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-28T21:15:38.693

引导加载程序不使用堆栈将参数传递给内核。至少在 Linux 的情况下，引导加载程序填充了一个相当复杂的内存结构，内核知道如何解析。这就是引导加载程序将内核指向其命令行的方式。有关详细信息，请参阅[Documentaion/x86/boot.txt](http://lxr.linux.no/#linux+v2.6.31/Documentation/x86/boot.txt#L508)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T07:13:33.437

Linux 接受来自引导加载程序的变量以允许使用某些选项。我知道您可以做的其中一件事就是让您不必登录（恢复模式），还有其他几个选项。它主要只是允许在出现问题或更改密码时进行修复。如果您选择使用其他选项，这就是 Ubuntu Live-CD 引导 Linux 的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T12:21:22.347

通常这些参数称为命令行参数，它是从引导加载程序传递给内核模块的。Bootloader 使用许多 BIOS 中断来检测，

```
memory
HDD
Processor
Keyboard
Screen
Mouse
ETC... 
```

并且所有硬件细节都将在启动时检测到，即在实模式下，然后将此参数传递给内核。

# .net - 如何提高 FtpWebRequest 的性能？

> ID：1016690
> 
> 赞同：34
> 
> 时间：2009-06-19T07:02:26.283
> 
> 标签：.net, ftp, ftpwebrequest

我有一个用 .NET 3.5 编写的应用程序，它使用 FTP 从服务器上传/下载文件。该应用程序运行良好，但存在性能问题：

1.  连接到 FTP 服务器需要很长时间。FTP 服务器位于不同的网络上，并具有 Windows 2003 Server (IIS FTP)。当多个文件排队等待上传时，从一个文件到另一个文件的更改使用 FTPWebRequest 创建一个新连接，这需要很长时间（大约 8-10 秒）。

2.  是否可以重新使用连接？我不太确定 KeepAlive 属性。哪些连接保持活动和重用。

3.  Windows Server 2003 上的 IIS-FTP 不支持 SSL，因此任何人都可以通过 WireShark 等数据包嗅探器轻松查看用户名/密码。我发现 Windows Server 2008 在 IIS 7.0 的新版本中支持 SSL over FTP。

我基本上想提高我的应用程序的上传/下载性能。任何想法将不胜感激。

** 请注意，3 不是问题，但我希望人们对此发表评论

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2010-06-23T01:32:10.983

I have done some experimentation (uploading about 20 files on various sizes) on FtpWebRequest with the following factors

**KeepAlive** = true/false

```
ftpRequest.KeepAlive = isKeepAlive; 
```

**Connnection Group Name** = UserDefined or null

```
ftpRequest.ConnectionGroupName = "MyGroupName"; 
```

**Connection Limit** = 2 (default) or 4 or 8

```
ftpRequest.ServicePoint.ConnectionLimit = ConnectionLimit; 
```

**Mode** = Synchronous or Async

see [this example](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)

**My results:**

1.  Use ConnectionGroupName,KeepAlive=true took (21188.62 msec)

2.  Use ConnectionGroupName,KeepAlive=false took (53449.00 msec)

3.  No ConnectionGroupName,KeepAlive=false took (40335.17 msec)

4.  Use ConnectionGroupName,KeepAlive=true;async=true,connections=2 took (11576.84 msec)

5.  Use ConnectionGroupName,KeepAlive=true;async=true,connections=4 took (10572.56 msec)

6.  Use ConnectionGroupName,KeepAlive=true;async=true,connections=8 took (10598.76 msec)

**Conclusions**

1.  `FtpWebRequest` has been designed to support an internal connection pool. To ensure, the connection pool is used, we must make sure the `ConnectionGroupName` is being set.

2.  Setting up a connection is expensive. If we are connecting to the same ftp server using the same credentials, having the keep alive flag set to true will minimize the number of connections setup.

3.  Asynchronous is the recommended way if you have a lot of files to ftp.

4.  The default number of connections is 2\. In my environment, a connection limit of 4 will give to me the most overall performance gain. Increasing the number of connections may or may not improve performance. I would recommend that you have the connection limit as a configuration parameter so that you can tune this parameter in your environment.

Hope you would find this useful.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-25T08:07:12.013

只要您可以并行启动多个连接，单个连接是否需要很长时间才能连接并不重要。[如果您有许多项目要传输（例如数百个），那么使用BeginGetRequestStream](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.begingetrequeststream.aspx)和[BeginGetResponse](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.begingetresponse.aspx)等异步方法并行启动数十甚至数百个 WebRequest 是有意义的。我从事的项目面临类似问题（连接/身份验证时间长），但通过并行发出许多调用，总体吞吐量实际上非常好。

如果您[使用异步方法](http://msdn.microsoft.com/en-us/library/ms998562.aspx#scalenetchapt10_topic12)或同步方法，一旦您有许多（数十，数百）个请求，它也会产生巨大的差异。这不仅适用于您的 WebRequests 方法，还适用于您在获取上传/下载流后将使用的 Stream[读](http://msdn.microsoft.com/en-us/library/system.io.stream.beginread.aspx)/[写方法。](http://msdn.microsoft.com/en-us/library/system.io.stream.beginwrite.aspx)[提高 .Net 性能和可扩展性](http://msdn.microsoft.com/en-us/library/ms998530.aspx)这本书有点过时了，但它的大部分建议仍然有效，并且可以在线免费阅读。

需要考虑的一件事是，[ServicePointManager](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.aspx)类潜伏在 Framwework 中，其唯一目的是：破坏您的性能。确保[获取 URL 的 ServicePoint](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.findservicepoint.aspx)并将[ConnectionLimit](http://msdn.microsoft.com/en-us/library/system.net.servicepoint.connectionlimit.aspx)更改为合理的值（至少与您想要的并发请求数一样高）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-28T20:15:25.233

**调试网络**

简单网络调试的一些技巧：

1.  检查从应用程序服务器 ping FTP 服务器时的响应时间。
2.  检查跟踪路由的响应时间（`tracert`来自 DOS shell）。
3.  使用命令从命令行传输文件`ftp`。
4.  通过 Telnet 连接到 FTP 服务器：`telnet server 21`。

结果将为解决问题提供线索。

**网络硬件**

对于慢速跟踪路由：

*   确定两台计算机出现网络问题的原因。
*   升级最慢链接之间的网络硬件。

**网络配置**

对于缓慢的 ping：

*   检查每台机器上的网络配置。
*   确保设置是最佳的。

**验证 API**

缓慢的命令行 FTP 会话会告诉您问题与您正在使用的 FTP API 无关。它不会消除 API 作为潜在问题，但肯定会降低它的可能性。

**网络错误**

如果数据包在源和目标之间被丢弃，ping 会告诉你。您可能必须将数据包大小增加到 1500 字节才能看到任何错误。

**FTP 队列服务器**

如果您无法控制目标 FTP 服务器，请让中间服务器接收上传的文件。然后中介以任何速度将文件发送到远程服务器。这给人一种文件正在快速发送的错觉。但是，如果文件一上传就必须存在于远程服务器上，则此解决方案可能不可行。

**FTP 服务器软件**

在 FTP 服务器上使用不同的 FTP 守护程序，例如将[ProFTPd](http://www.proftpd.org/)作为[Windows 服务](http://www.fuzzybuckets.org/fuzzybuckets/archives/2005/11/setting_up_prof.html)。（ProFTPd 具有用于各种数据库的插件，允许使用 SQL 查询进行身份验证。）

**FTP 服务器操作系统**

基于 Unix 的操作系统可能比基于 Microsoft 的操作系统更好。

**FTP客户端软件**

有许多不同的 API 用于通过 FTP 发送和接收文件。可能需要一些工作才能使您的应用程序足够模块化，以便您可以简单地插入新的文件传输服务。这里列出了几个不同的 API 作为答案。

**备用协议**

如果 FTP 不是绝对要求，请尝试：

*   Windows 网络驱动器
*   HTTPS
*   scp、rsync 或类似程序（可能需要[Cygwin ）](http://www.cygwin.com/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-13T12:23:36.187

此链接描述 ConnectionGroupName 和 KeepAlive 影响： [WebRequest ConnectionGroupName](https://web.archive.org/web/20110201193440/http://markitup.com/Posts/Post.aspx?postId=c98db0ca-f3a8-4f49-bb96-641574274c1a)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-23T08:23:59.527

您绝对应该查看[BITS](http://en.wikipedia.org/wiki/Background_Intelligent_Transfer_Service)，它是对 FTP 的重大改进。明文密码并不是 FTP 的唯一弱点。还有一个问题是预测它将为被动上传或下载打开的端口，以及客户端使用 NAT 或防火墙时的整体困难。

BITS 使用 IIS 扩展通过 HTTP/HTTPS 工作，并支持可以以低优先级安排的排队上传和下载。如果您在客户端和服务器上使用 Windows，它总体上比 FTP 灵活得多。

[用于 PowerShell 的 BITS](http://blogs.msdn.com/wmi/archive/2009/01/23/introducing-bits-powershell-cmdlets.aspx)

[.NET 的 BITS](http://sharpbits.codeplex.com/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-15T04:34:42.513

我强烈建议[.NET 和 Mono 的 Starksoft FTP/FTPS 组件](http://www.starksoft.com/prod_ftp.html)。它有一个可以缓存和重用的连接对象。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-22T11:59:20.410

就我个人而言，我已经迁移了我们所有的应用程序，不再使用 FTP 进行文件上传/下载，而是推出了基于 ASP.NET 中的 XML Web Services 的解决方案。

性能大大提高，安全性与您想要编码的一样多或少（并且您可以使用内置于 .NET 的东西）并且它都可以毫无问题地通过 SSL。

我们让客户的连接通过他们自己的防火墙的成功率远高于运行 FTP。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-28T19:08:01.097

看看这个页面 - [http://www.ietf.org/rfc/rfc959.txt](http://www.ietf.org/rfc/rfc959.txt)

它说在连接时使用不同的端口以便能够重用连接。
那样有用吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-04T12:18:45.030

要解决有关性能的问题，您只需设置：

`ftpRequest.ConnectionGroupName = "MyGroupName"; ftpRequest.KeepAlive = false; ftpRequest.ServicePoint.CloseConnectionGroup("MyGroupName");`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-27T15:23:01.823

我建议切换到[rsync](http://www.samba.org/rsync/)。
优点：
针对减少传输时间进行了优化。
支持 SSH 进行安全传输
使用 TCP 让您的 IT 部门/防火墙人员更快乐

缺点：
没有原生 .NET 支持
面向 linux 服务器安装 - 尽管有像[DeltaCopy这样的不错的 Windows 端口](http://www.aboutmyip.com/AboutMyXApp/DeltaCopy.jsp)

总的来说，虽然它是比 FTP 更好的选择

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-27T16:06:58.407

我使用 EDT 的 ftp 库取得了不错的效果：

[http://www.enterprisedt.com/products/edtftpnet/overview.html](http://www.enterprisedt.com/products/edtftpnet/overview.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-09-20T22:21:25.313

我知道这是一个旧线程，但我最近不得不经历类似的情况。

我们需要在 25 分钟内从 ftp 服务器下载 70 多个 XML 文件，而在此期间打开的连接不超过 5 个。

这些是我们尝试过的所有替代方案：

*   wget - 它很快，但每个 GET 都意味着一个新的连接。由于创建的连接数量，我们不得不停止。我们在使用 GETM 时遇到了一些问题，这些问题在网络上有很好的记录，所以这不是一个选择。
*   FtpWebRequest - 每个 Create 调用都会记录一个新连接，即使我们使用了 KeepAlive 和 ConnectionGroupName 属性。另外，它非常慢。
*   Webclient - 我们没有检查它是否为每个文件创建了一个新连接（尽管我认为它确实如此），但它复制了 1 个文件/分钟。所以这不是一个选择。

我们最终使用了老式的 ftp 批处理脚本。它很快，我只使用一个连接来下载所有文件。它不灵活，但比我尝试过的所有其他方法都要快得多（20 分钟内 75 个文件）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-23T08:10:31.783

KeepAlive 正在工作。FtpWebRequest 在内部缓存连接，因此可以在一段时间后重用它们。有关此机制的详细信息和说明，您可以查看[ServicePoint](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.servicepoint.aspx)。

另一个很好的信息来源是查看 FtpWebRequest 源（您可以在 VS2008 上进行）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-27T15:08:04.630

AFAIK，每个 FtpWebRequest 都必须建立一个新的连接——包括登录到服务器。如果您想加快 FTP 传输速度，我建议您使用备用 FTP 客户端。其中一些备用客户端可以登录，然后使用相同的命令连接执行多个操作。

此类客户端的示例包括： http: [//www.codeproject.com/KB/IP/FtpClient.aspx](http://www.codeproject.com/KB/IP/FtpClient.aspx)，其中还很好地解释了为什么这些库可以比标准 FtpWebRequest 和[http://www.codeproject 运行得更快。 com/KB/macros/ftp_class_library.aspx](http://www.codeproject.com/KB/macros/ftp_class_library.aspx)看起来也很简单。

就我个人而言，在引入 FtpWebRequest 之前的 .NET 1.1 天，我将自己的 FTP 实现回滚到了 .NET 2.0 之后的版本中。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-02-21T10:51:03.617

单点建议：

较低的缓冲区/块大小会显着降低性能

原因：更多的磁盘 i/o、内存 i/o、ftp 流初始化和更多的因素

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-09-27T20:49:22.887

我为此工作了几天......速度真的很低，与FileZilla相比没有什么可比性......最后我用多线程解决了。10 个线程为下载建立连接给了我很好的速度，甚至可以改进更多.. 使用标准的 ftprequest 配置

```
PeticionFTP.ConnectionGroupName = "MyGroupName"
PeticionFTP.ServicePoint.ConnectionLimit = 4
PeticionFTP.ServicePoint.CloseConnectionGroup("MyGroupName")

PeticionFTP.KeepAlive = False 
PeticionFTP.UsePassive = False

PeticionFTP.UseBinary = True

PeticionFTP.Credentials = New NetworkCredential(lHost.User, lHost.Password) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-05-08T18:14:37.837

我对 FtpWebRequest 做了一些基准测试，类似于上面@Sid 的响应。将 KeepAlive 设置为 true 确实有所改善，但在我的测试中没有异步调用。测试包括

1) FtpWebRequest 用于检查文件是否存在 2) FtpWebRequest 用于上传 3) FtpWebRequest 用于重命名服务器上的文件

`Test FTP client 30 files of size 5 Kbytes took ... 14.897 seconds Test upload (alive true, connection name) 30 files of size 5 Kbytes took ... 34.229 seconds Test async(alive true, connection name) 30 files of size 5 Kbytes took ... 40.659 seconds Test send thread (alive true, connection name) 30 files of size 5 Kbytes took ... 38.926 seconds, 30 files`

改进的是使用 Socket 类实现的 FTP 客户端

基准在这里

[https://github.com/pedro-vicente/ftp_t](https://github.com/pedro-vicente/ftp_t)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-02-15T12:09:39.103

试试下面的代码，你会得到更好的性能：

```
private void Upload144_Click(object sender, EventArgs e)
{
    OpenFileDialog fileobj = new OpenFileDialog();
    fileobj.InitialDirectory = "C:\\";
    //fileobj.Filter = "Video files (*.mp4)";
    //fileobj.ShowDialog();

    if (fileobj.ShowDialog() == DialogResult.OK)
    {
        if (fileobj.CheckFileExists)
        {
            string test = Properties.Settings.Default.Connection;
            SqlConnection con = new SqlConnection(test);
            con.Open();
            string correctfilename = System.IO.Path.GetFileName(fileobj.FileName);
            SqlCommand cmd = new SqlCommand("Insert into Path(ID,Path5) VALUES   ((select isnull(MAX(id),0) + 1 from Path),'\\Videos\\" + correctfilename + "')", con);

            cmd.ExecuteNonQuery();

            string path = Application.StartupPath.Substring(0, Application.StartupPath.Length - 10);
            con.Close();

            //For Progressbar
            DataTable dt = new DataTable();
       //   SqlDataAdapter da = new SqlDataAdapter(cmd);
       //   da.Fill(dt);

            timer5.Enabled = true;

            // FOR FtpServer File Upload::
            string uploadfile = fileobj.FileName;
            string uploadFileName = new FileInfo(uploadfile).Name;

            string uploadUrl = "ftp://ftp.infotech.com/";
            FileStream fs = new FileStream(uploadfile, FileMode.Open, FileAccess.Read);
            try
            {
                long FileSize = new FileInfo(uploadfile).Length; // File size of file being uploaded.
                Byte[] buffer = new Byte[FileSize];

                fs.Read(buffer, 0, buffer.Length);

                fs.Close();
                fs = null;
                string ftpUrl = string.Format("{0}/{1}", uploadUrl, uploadFileName);
                FtpWebRequest requestObj = FtpWebRequest.Create(ftpUrl) as FtpWebRequest;
                requestObj.Method = WebRequestMethods.Ftp.UploadFile;
                requestObj.Credentials = new NetworkCredential("test@sample.com", "test@123");
                Stream requestStream = requestObj.GetRequestStream();
                requestStream.Write(buffer, 0, buffer.Length);

                requestStream.Flush();
                requestObj = null;
            }
            catch (Exception ex)
            {
                //MessageBox.Show("File upload/transfer Failed.\r\nError Message:\r\n" + ex.Message, "Succeeded", MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
        }
    }
} 
```

# .net - 为什么人们一直建议使用 appConfig 而不是使用设置文件？（。网）

> ID：1016707
> 
> 赞同：28
> 
> 时间：2009-06-19T07:09:34.303
> 
> 标签：.net, .net-2.0, app-config, appsettings, application-settings

我经常看到这样的问题的答案：“我应该如何在我的 .NET 应用程序中存储设置？” 是通过手动将条目添加到 app.config（或 web.config）来编辑 app.config 文件，如下所示：

```
<configuration> 
  <appSettings>
    **<add key="ConfigValueName" value="ABC"/>**
  </appSettings>
</configuration> 
```

然后，像这样访问它们：

```
string configValue = Configuration.AppSettings["ConfigValueName"]; 
```

我将上述方法称为“app.config”方法。我很少看到人们建议在项目中添加“设置”文件。我在网上和 stackoverflow 上看到过很多次......我开始怀疑我是否遗漏了什么......因为我不确定你为什么要使用这种方法而不是使用“设置” “ 文件。我直到 VS2005 才进入 .NET，所以我的一个理论是这就是 VS2003 中的事情是如何完成的，人们从未切换过？

人们推荐 app.config 方法的示例：

*   [在 Windows 窗体 C# 应用程序中拥有配置文件的最简单方法](https://stackoverflow.com/questions/114527/simplest-way-to-have-a-configuration-file-in-a-windows-forms-c-application)
*   [最佳实践：我应该如何在 C#（格式/类型）中存储设置？](https://stackoverflow.com/questions/535685/best-practices-how-should-i-store-settings-in-c-format-type)

**从我的角度来看，“设置文件”方法**有以下优点：

 **1.  可用于应用程序设置（所有用户通用的设置）和来自同一界面的用户设置。
2.  能够在 Visual Studio 中使用设置设计器支持。恕我直言，直接编辑 XML 文件更不容易出错。
3.  重构 - 您可以重命名特定设置名称，它会自动更新代码中的引用。
4.  编译类型检查。
5.  自动完成支持。
6.  属性网格功能。我发现 PropertyGrid 控件是制作快速选项表单的一种非常简单的方法。你只是做`propertyGrid1.SelectedObject = Settings1.Default;`了，你就完成了。

如果您不确定我所说的“设置”文件方法是什么意思，请参阅[这篇文章](https://stackoverflow.com/questions/577782/where-to-store-configuration-information/597835#597835)，这是有人建议使用设置文件而不是 app.confg 的少数示例之一。

**编辑：请理解：本主题的目的是弄清楚为什么人们会使用上面概述的 app.config 方法而不是设置文件方法。我遇到了设置文件方法的限制，有时不得不推出自己的自定义解决方案。*那是完全不同的讨论*。**

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-19T07:17:01.293

我认为两者最大的区别在于应用程序不能更改`app.config`. 这些值是在运行时读取的，并且没有内置支持将新值写入配置文件。

可以使用`Save()`命令更改设置文件。

对设置文件的内置支持的一个主要问题是设置文件的存储位置。如果您查看您的 APPDATA 文件夹，您会看到有一个包含公司名称的文件夹，然后是一个带有产品名称的子文件夹，然后是一个带有半随机名称和版本信息的子文件夹.

每当您发布新版本时，由于设置文件的存储位置，它不会从以前的版本中找到设置文件。也无法更改设置文件的存储位置。

我在一个项目中使用了它，发现创建自己的使用 XML 文件进行设置的 AppSettings 类更有用。我可以控制文件的格式和位置。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-19T12:20:31.773

还有比 AppSettings 或 Properties 更好的第三种方法：[自定义配置部分](http://msdn.microsoft.com/en-us/library/2tw134k3.aspx)。与 AppSettings 相比的优势：

1）强类型访问

2) 模式和表单的内置验证机制。

3) 基于 POCO，使其具有高度可测试性——只需新建您自己的测试配置。

4) 不依赖魔弦。并不是说您不能轻松地将 AppSettings 包装在一个类中并以这种方式访问​​它，但 95% 的开发人员不这样做。

5) 一旦你进行了十几个设置，配置中的 XML 就会变得更容易理解。也比属性位恕我直言更容易理解。

6）不依赖视觉工作室使其正常工作。

当然，我从来没有真正使用过属性，因为我首先接触了自定义配置部分。

顺便说一句，如果您还没有听说过这些，那么您仍然每天都在使用它们——您认为 .NET 配置文件中的标准配置部分是什么？

_____澄清部分

首先，其中大部分是针对 AppConfig 方法的，我并不清楚重读。我认为我们通常站在同一边——避免使用松散的名称-值包进行配置，因为它太容易坏了。我还应该补充一点，我是一个网络人，所以用户设置对我来说是存在于应用程序层而不是配置中的东西。

1) 没错，属性和自定义配置部分都具有强类型访问权限。AppSettings 没有。AppSettings 不好，Props/CC 好。

2）当你加载一个配置节时，如果应用程序没有暴露必要的信息或不适当的信息，它会抛出一个配置异常。就像你搞砸 app.config 或 web.config 一样。还有一些我没有使用的验证基础设施，因为我喜欢早早地失败或根本不失败。

3) POCO 是普通的旧 C# 对象，以防有人错过了过去几年。无论如何，因为配置设置是装饰性的并通过属性声明，所以您的配置设置可以很容易地测试，因为您只需要删除一个新的 MyConfigSection() 并根据需要设置属性等。据我了解属性，您需要在其中拥有带有正确 xml 的配置文件，否则您就是 sol.xml。另一个优点是自定义配置部分可以与你可以用 POCO 做的所有其他简洁的东西一起使用，比如接口和依赖注入。

4) 是的，属性和自定义配置部分都是强类型的，AppSettings 不是。AppSettings 不好，Props/CC 好。

5）真正针对AppSettings。我继承了一些应用程序，`<add name="foo" value="bar" />`配置中只有 2 页。与属性吐出的 xml 乱码相比，这很容易。另一方面，您的自定义配置部分可以是相当语义化和不言自明的，因为您要声明部分名称和属性。我可以很容易地在生产服务器上的记事本中对其进行编辑，并且在紧要关头开枪打自己的脚时不会太紧张。

因此，除了没有基于 VS 的属性网格（我认为这是一件坏事——为什么需要网格来编辑配置？）之外，与属性相比，自定义配置部分有很多优点，没有真正的缺点。自定义配置部分和属性都比 AppSettings 具有巨大的优势。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T07:47:57.143

不讨论，那么答案是：

“因为它更容易。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T07:42:26.827

因为设置文件基础结构 (1) 更复杂，并且 (2) 鉴于其复杂性而没有充分记录。

默认情况下，设置文件的工作方式对小型应用程序很有用。对于较大的，您通常需要更改此默认值。设置文件基础架构*可以满足*您的需求，但即使有良好的文档，也会涉及陡峭的学习曲线。没有文档，它几乎是无用的。

我只是参考[这篇](http://www.codeproject.com/Articles/16466/Unraveling-the-Mysteries-of-NET-2-0-Configuration)文章来总结。随意粘贴一些有用的链接到概念性 MSDN 文档来反驳我的论点。

* * *

更新：

我需要公平并提供一个我没有找到记录的特定用例：

我喜欢应用程序设置设计器。我也喜欢存储设置的 XML 格式。我想保留这些功能，但使用其他位置来存储设置。我没有找到任何提示是否支持此用例，如果支持，如何完成任务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T11:48:59.483

两种情况：

*   配置设置为默认值的客户端应用程序。该应用程序提供了一个 UI 来修改单个用户或所有用户的设置。

在这里，“设置”方法赢得了胜利。

*   由几个相对独立的程序集组成的应用程序，每个程序集都需要一些简单的配置设置。这些设置通常由管理员设置，部署后不会被应用程序修改。

在这里，“appSettings”可以更简单地管理。使用“设置”方法，每个可配置程序集都会有一个部分添加到主应用程序的配置文件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T07:20:41.567

不正确：设置文件方法的部分问题在于它要求应用程序位于特定位置并且设置文件位于正确位置。如果其中之一被意外移动，则设置可能会永久丢失，就像它被删除一样。还可能存在文件夹中具有相同名称的多个设置文件的问题，导致其中一个被覆盖。如果软件依赖于设置文件，这尤其糟糕。这些问题在安装的软件中几乎没有那么明显，但在未安装的软件中，只是下载并运行它可能是一个主要问题。想象一下，如果有人将其中几个程序下载到同一个目录并且它们都使用相同的设置文件名。

编辑：正如与提出问题的人所讨论的那样，这个答案是不正确的，因为问题是指两种不同的保存到设置文件的方式。当我给出答案时，我以为他指的是两个不同的文件。关于我能提供的唯一其他答案是，这是个人喜好问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-17T20:03:24.077

我还想指出 app.Config 和设置窗口之间的一个区别。如果您在“设置”下保存任何内容，则设置将保存在以下位置。

Win XP: c:\Documents and Settings\%Username%\Local Settings\Application Data{Publisher Name}\

Win 7: C:\Users\%Username%\AppData\Local{Publisher Name}\

虽然 app.config 设置仅保存在配置文件中。**

# language-agnostic - 网站应该如何处理本地化设置？（来自“什么是常见的 UI 误解和烦恼？”）

> ID：1016709
> 
> 赞同：14
> 
> 时间：2009-06-19T07:10:29.980
> 
> 标签：language-agnostic, localization, globalization, user-experience

我选择将其作为一个问题本身，因为它在[原始帖子](https://stackoverflow.com/questions/1011167/what-are-common-ui-misconceptions-and-annoyances)的评论中引起了如此多的争论。

有趣的是，SO 上的很多人（他们是开发人员）只是没有获得本地化。这是我对它应该如何工作的看法：

在我查看过的所有浏览器中（以及那里的 .NET 开发人员），当您查看用户的文化偏好时，它采用以下格式：语言-文化。

所以我们有：

*   zh-CN - 英语 - 英国文化
*   en-US - 英语 - 美国文化
*   en - 英语 - 不变的文化。
*   fr-FR – 法语 – 法国文化
*   fr-CH – 法语 – 瑞士文化
*   de-CH – 德语 – 瑞士文化
*   de-DE – 德语 – 德国文化

有关.NET 框架支持的完整列表，请参阅[MSDN 。](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo(VS.71).aspx)

当我访问一个网站时，它知道我想要从 en 部分开始使用英语，并且它知道我对它偏向英国感兴趣（数字格式、日期格式）。因此，当我访问 google.com 并将我带到 google.de（因为我的 IP 地址）时，如果 google.de 以英语向我显示所有内容但由于 google.de 是德语完全错误，那完全没问题。我几乎无法控制我的 IP 地址，但可以完全控制我的语言和文化设置。如果您有兴趣，Microsoft 的新搜索引擎 (bing.com) 会处理得当。让我们希望微软可以像谷歌一样学习如何进行搜索，或者谷歌可以像微软一样学习本地化；）

[MSDN](http://msdn.microsoft.com/en-us/library/ms978628.aspx)有另一篇好文章在这里了解更多信息

那么您对网站应如何处理本地化有什么建议？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-29T19:36:02.180

这里的解决方案非常简单，开发人员做任何其他事情都很烦人。

1.  尊重浏览器设置。如果它说英语，那么上帝就是英语。

2.  如果您绝对必须，那么只需在顶部添加一个按钮即可选择其他内容。然后，只有这样，你才覆盖浏览器。

3.  如果你认为你的方法更好。停下来，让别人打你一巴掌。它不是。根据需要重复。

4.  摆脱那些要求某人所在国家/地区的网页启动页面。只需根据浏览器默认值显示您的正常页面，然后查看上面的第 2 项。 ~~我还没有遇到真正重要的网站。~~ **更新：** *几年后，现在有理由这样做。2013 年，英国制定了有关 cookie 的政策，网站运营商需要尊重位于该国家/地区的网站，这些网站为来自该国家/地区的访问者提供页面。因此，请注意您所在国家/地区的法律。*

5.  如果您碰巧有一个站点确实由多个国家/地区的多台服务器提供服务，那么您可能可以检测到您的哪一台服务器确实更接近提供服务。如果你做不到，就停止重定向的疯狂，然后不要试图为他们做出决定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-13T19:37:14.237

如果本地化设置可用 - 包括但不限于 HTTP Accept-Language 标头 - 那么网站绝对应该尊重它们。

反对这一点的常见论点是“普通用户”不够聪明，无法找到语言设置并配置它们以匹配他们自己的偏好，因此这些设置通常是不正确的（除非用户恰好在我们）。

那是错误的解决方案。

如果很大一部分用户找不到（或懒得找）他们的浏览器语言设置，那么正确的反应是*让他们更容易找到*，而不是让网站忽略他们的设置到。也许可以从程序的顶级菜单直接访问语言设置，而不是将其隐藏在过于复杂的“首选项”对话框中。也许在程序第一次运行时询问语言偏好。也许使用操作系统的本地化设置。或者可能是完全不同的东西，如果这就是几乎可以肯定浏览器将发送有关用户偏好的正确信息所需要的。但不要只是举手，说“没用，修不了！

其他答案谈到让用户在网站上的个人资料中选择语言或区域设置，这也很重要并且绝对应该是标准的，但这只是为了为用户的正常设置提供特定于站点的覆盖。但是，如果用户没有在网站上覆盖此设置，正确的操作是默认为其浏览器设置中指定的最喜欢的可用语言/区域设置，而不是基于其 IP 地址的地理位置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-26T17:58:49.397

在我职业生涯的某一时刻，我维护了部分 TCP/IP 堆栈。这让我非常了解 IP 地址不应该用作网络层地址以外的任何东西。IP 地址和位置之间的任何关联几乎都是巧合——它是地址分配方式的产物，而不是 IP 地址含义的任何基本部分。

（它们也不能用作计算机的唯一标识符，但那是另一回事）

我建议将地理位置排除在外。HTTP 标准包括一种让浏览器或其他用户代理在每个请求中包含用户文化偏好的方法（请记住，它是加权偏好列表，不一定只是一种文化）。由于浏览器比您更接近用户，因此您应该尊重此请求，至少作为默认请求。

然后可以允许用户临时或永久更改他们对您网站的偏好。甚至可以允许用户选择查看具有不同文化设置的不同内容。一个疯狂的例子是一个同时包含政治新闻和技术信息的网站。有人想要他们的“自然”语言的新闻，但想要英语的技术信息，这是很合理的。

最后，可以有一个后备模式。例如，如果您有一个根据用户所在地区（例如经销商）为用户提供服务的网站，那么日语内容可能只存在于您的亚洲地区子网站上。访问您的 EMEA 网站的说日语的用户可能只是卡在看到英文内容，这很可能是他的最后选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-31T06:25:03.263

在我创建的网站上，我通常遵循以下模式：

*   每个页面都有一个唯一的 URL，其中包含某处的语言，通常类似`/en/page`或不同的（子）域
*   如果用户打开一个未指定语言的 URL，就像`/page`我开始猜测的那样：
    *   上一个会话的 cookie 是否可用？
    *   如果没有，是否`Accept-Language`可用，我可以将其映射到网站上可用的语言吗？
    *   如果没有，如果有可能，我可以通过 IP 猜测吗？
    *   如果不是，则默认为站点的默认语言。
*   我使用猜测的语言设置了一个 cookie，并将用户重定向到具有适当 URL 的站点
*   我在每个页面上都设置了语言开关，因此`/en/page`可以轻松切换到`/xx/page`
    *   如果用户切换到不同的页面，Cookie 会得到更新

理想情况下，我只需要猜测一次，然后使用用户的 cookie，或者用户直接访问所需的页面。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-23T00:01:35.753

我同意，让用户有机会在您的应用中使用用户偏好来覆盖它们。这对于您无法从浏览器设置中获得的时区本地化问题特别方便。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T23:50:41.153

我冒着被认为不礼貌的风险，但我认为我[关于这个主题的帖子](https://stackoverflow.com/questions/1020494/how-should-sites-google-and-or-you-treat-accept-language-header)会有更多信息丰富的答案，主要是因为我的帖子真的是一个问题。我很抱歉，虽然我之前没有找到那个帖子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-22T17:28:57.683

智能默认值与用户覆盖它们的能力之间存在差异。在我从事过的大型应用程序中，我从浏览器设置、地理位置等假设用户的区域设置——但总是为用户提供一种轻松切换的方式。

我不知道别人会怎么做。不给用户机会来纠正你的假设是很成问题的，因为你有时会弄错。

添加：

我认为您的问题是，虽然您可以编辑您的语言环境设置，但如果它们看起来与默认设置基本相同，那么应用程序开发人员无法判断您是否有意保留它，或者因为您不知道如何或者为什么要改变它。

我建议尊重用户的本地化设置，*除非*设置是压倒性的默认设置，用户可能不会更改。例如，我相信绝大多数 (90+%) 的用户`en-us`在越南的地理位置设置几乎总是会通过查看越南内容而不是美国英语内容得到更好的服务，只要有一种简单的方式来切换区域设置。另一方面，如果位于美国的用户具有越南语设置，请务必向他或她提供越南语内容。

这对越南的美国英语用户来说是不是很烦人？当然。但这也是对大多数人的最大好处，并有助于确保普通的非技术用户获得最佳的真实体验。直到我们可以用枪指着用户的脑袋并迫使他们在打开计算机之前诚实地声明他们的语言/文化偏好，我们将需要这样的启发式方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-07T10:43:35.003

我已经看到来自客户的足够有力的错误报告，当调查结果是其中一个用户的浏览器文化设置错误时，我们现在让客户使用配置设置覆盖浏览器。浏览器的文化设置经常出错，以至于它不是很有用，对于大多数最终用户来说也很难找到或更改它。

# php - 如何确定 PHP 中的 mySQL 准备语句结果列名？

> ID：1016717
> 
> 赞同：1
> 
> 时间：2009-06-19T07:13:33.173
> 
> 标签：php, mysqli, prepared-statement

也就是说，使用如下准备好的语句：

```
select col1,...coln from table where col3 = ? 
```

我相信我可以使用 $mysqli->field_count 来获取返回的列数（没有尝试过）。

但是有没有办法将每个列名链接到 bind_results 中返回的值？我总是可以尝试从命令本身解析列名，但这不是我想走的路。

### 语境：

我希望能够定义一个 PHP 接口，将类属性映射到从数据库返回的列名。所以给定

```
class A implements IColumnMapped{
    public $prop1, $prop2; private $map;
    public function __construct() {
        $map = array();
        $map['col1'] = & $this->prop1;
        $map['col2'] = & $this->prop2;
    }
    public function getMap() { return $this->map;}
} 
```

和

```
$mysqli->prepare("select col0, col1, col2, col3 from table"); 
```

我可以使用 bind_results 然后做类似的事情（伪代码）

```
for($resultColumns as $columnName) {
    if(isset($map[$columnName])) $map[$columnName] = $results[$columnName];
} 
```

只取出我需要的两列（col1 和 col2）并将它们分配给 A 类的正确属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T07:33:14.927

我相信[mysqli_stmt::result_metadata](https://www.php.net/manual/en/mysqli-stmt.result-metadata.php)和[mysqli_result::fetch_fields](https://www.php.net/manual/en/mysqli-result.fetch-fields.php)可以帮助你。

# c# - XmlSerializer.Serialize 不明确

> ID：1016721
> 
> 赞同：5
> 
> 时间：2009-06-19T07:14:09.957
> 
> 标签：c#, .net, xml, xml-serialization

我创建了具有 3 个类的测试应用程序

*   车
*   收音机
*   SportCar：汽车（有收音机）

作为创建 XmlSerializer 对象实例时的序列化过程，我使用 2 个对象进行测试

```
XmlSerializer xmlSerializer = new XmlSerializer(typeof(SportCar)); 
```

和

```
XmlSerializer xmlSerializer = new XmlSerializer(
    typeof(SportCar), 
    new Type[] { typeof(Car), typeof(Radio) }); 
```

这2种方法的结果是相同的，所以我想知道这2个构造函数或需要使用#2构造函数的临界点有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T07:23:38.847

最大的区别是当您需要讲述`XmlSerializer`子*类*时- 例如：

```
XmlSerializer xmlSerializer = new XmlSerializer(typeof(Car),
     new Type[] { typeof(SportCar), typeof(Radio) }); 
```

在这里，如果没有额外的信息 if 不会知道（只是从`Car`）关于`SportCar`or `Radio`- 所以如果你给它一个实际上是 a 的对象`SportCar`，它会失败：

```
Car car = new SportCar {...};
xmlSerializer.Serialize(destination, car); 
```

您也可以通过设置类型定义`[XmlInclude(typeof(SportCar))]`来做到这一点：`Car`

```
[XmlInclude(typeof(SportCar))]
public class Car {...} 
```

这更容易，但只有当`Car`类型位于知道`SportCar`. 但是您通常*确实*知道这一点，因此`XmlInclude`首选选项也是如此。

此外：还有一些效率优势`XmlInclude`；系统在后台使用动态类型生成来`XmlSerializer`提高效率。出于这个原因，您通常应该保留（并重用）`XmlSerializer`您创建的实例；例如，通过将其存储在静态字段中。但是，系统会自动为默认用法 ( `new XmlSerializer(typeof(Car))`) 执行此操作 - 即，无论您使用此构造函数多少次，它只会生成一次动态代码。如果您使用更复杂的构造函数 ( `new XmlSerializer(typeof(Car),new Type[] { typeof(SportCar), typeof(Radio) })`)，它将每次都进行类型生成。

# sql-server-2005 - 我是否应该将升级后的数据库的兼容级别从 8 更改为 9？

> ID：1016722
> 
> 赞同：4
> 
> 时间：2009-06-19T07:16:00.330
> 
> 标签：sql-server-2005, sql-server-2000, compatibility-level

我计划将 SQL Server 2000 实例**升级**到 SQL Server 2005 实例。

我不会更改任何数据库代码，因此不会利用任何 SQL2005 特定语法。是否有任何理由将我的兼容性设置得更高（至 9 级）？或者可以离开兼容级别 8 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T07:22:14.170

有两种方法可以查看：

*   如果您将来想更改代码（或安装一些协作的 SQL2005/2008 服务器），您的兼容模式将影响该决定
*   如果您没有运行 Upgrade Adviser，您可能无法升级 :) 兼容级别 9 *禁用*了 8 中可用的某些语法和功能。

所以，简单的答案是不，你不必提高你的兼容水平，但你也必须考虑你的未来与这个盒子:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T07:20:00.180

在您希望升级之前，可以将其保留为 8。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T07:43:22.583

只是一点点 - 兼容级别 90 放弃了对旧的 ANSI-89 外连接语法 ( `*=`, `=*`) 的支持。如果您决定切换，请确保您首先检查了您的代码库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T15:20:44.397

嗯 90级得到的报告，非常好……仅此一项就是升级的动力……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-25T21:27:12.497

兼容性级别不仅仅是一个偏好问题，它与您如何使用数据库有关，您可以在此链接上查看更改的内容：

[http://msdn.microsoft.com/en-us/library/bb510680.aspx](http://msdn.microsoft.com/en-us/library/bb510680.aspx)

因此，除非您知道更改兼容性级别不会破坏您应该明确升级的任何内容。因此，请在冒险之前进行彻底检查。

# php - 通过 php 更新 Facebook 状态

> ID：1016730
> 
> 赞同：8
> 
> 时间：2009-06-19T07:19:21.150
> 
> 标签：php, api, facebook, google-talk, chatbot

我想开发一个机器人，它将使用 php 更新 facebook 帐户的状态。

请指导我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T12:07:20.990

@Porkchop 是正确的，您可能需要 Facebook Connect API。要更新 Facebook 上的用户状态，您应该查看[Status.set](http://wiki.developers.facebook.com/index.php/Status.set) API 调用。

对于用 php 编写 googletalk 机器人，有一些文章可以帮助您入门：

*   [Twitter PHP Jabber 机器人教程](http://www.jazzychad.com/twitter/bots/)
*   [Jabber Simple - 一个 PHP 库](http://www.thenullpointer.net/blog/jabber-simple-a-php-library)

但也可以考虑使用[IMified](http://www.imified.com/)，它为您创建和运行聊天机器人做了很多工作。

* * *

如果您感兴趣的只是一种从 Google Talk 状态更新 Facebook 状态的简单方法，您可能不需要完成所有工作 - 只需安装“ [Google Talk Status Synchronizer](http://www.facebook.com/apps/application.php?id=33855239494) ”Facebook 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-17T19:40:41.010

您可以通过外包来廉价雇用某人来做这件事，我的意思是当我不知道代码时我会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-23T07:10:22.957

由于您使用 PHP 进行编码，因此我建议使用 Jaxl（Jabber XMPP 库）。它支持使用 X-FACEBOOK-PLATFORM 的机器人身份验证，并且更新 facebook 状态应该是使用该库的单行任务。[http://github.com/abhinavsingh/JAXL](http://github.com/abhinavsingh/JAXL)

# sql-server - 如何将子查询结果字段连接到父查询？

> ID：1016749
> 
> 赞同：4
> 
> 时间：2009-06-19T07:27:41.630
> 
> 标签：sql-server, sql-server-2008, subquery, concatenation

数据库：SQL Server 2008。

我有一个像这样的真正（假）常规查询：-

```
SELECT CarId, NumberPlate
    (SELECT Owner
     FROM Owners b
     WHERE b.CarId = a.CarId) AS Owners
FROM Cars a
ORDER BY NumberPlate 
```

这就是我想要得到的......

```
=> 1    ABC123     John, Jill, Jane
=> 2    XYZ123     Fred
=> 3    SOHOT      Jon Skeet, ScottGu 
```

所以，我尝试使用

AS`[Text()] ... FOR XML PATH('')`但那包括奇怪的编码字符（例如回车）。...所以我对此不是 100% 满意。

我还尝试查看是否有 COALESCE 解决方案，但我所有的尝试都失败了。

所以 - 有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2019-04-24T03:14:51.583

回答一个旧帖子，只是认为它需要更新 SQL Server 的新版本：

对于 SQL Server 2017 使用 STRING_AGG(*表达式*,*分隔符*)

GROUP_CONCAT 是 MySQL。

在 SQL 2017 之前，您还可以执行以下操作（从我们当前基于 SQL Server 2016 的代码库中截取）：

```
SELECT CarId, NumberPlate,
    (STUFF(( SELECT ', ' + b.Owner
        FROM Owners b
        WHERE b.CarId = a.CarId
        FOR XML PATH('')
        )
        ,1,2,'') AS Owners
FROM Cars a
ORDER BY NumberPlate 
```

STRING_AGG 的链接 [https://database.guide/the-sql-server-equivalent-to-group_concat/](https://database.guide/the-sql-server-equivalent-to-group_concat/) [https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact -sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql?view=sql-server-2017)

链接到 STUFF： [https ://docs.microsoft.com/en-us/sql/t-sql/functions/stuff-transact-sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/functions/stuff-transact-sql?view=sql-server-2017)

最后链接到 FOR XML： [https ://docs.microsoft.com/en-us/sql/relational-databases/xml/for-xml-sql-server?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/relational-databases/xml/for-xml-sql-server?view=sql-server-2017)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T07:35:58.963

尝试解决这个问题：

[如何创建 SQL Server 函数以将子查询中的多行“加入”到单个分隔字段中？](https://stackoverflow.com/questions/6899/is-there-a-way-to-create-a-mssql-function-to-join-multiple-rows-from-a-subquery)

:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-03-23T13:10:11.873

采用`GROUP_CONCAT`

```
SELECT CarId, NumberPlate
    (SELECT GROUP_CONCAT(Owner)
     FROM Owners b
     WHERE b.CarId = a.CarId) AS Owners
    FROM Cars a
ORDER BY NumberPlate 
```

# flash - 从动作脚本获取 IE 代理设置

> ID：1016753
> 
> 赞同：1
> 
> 时间：2009-06-19T07:28:14.860
> 
> 标签：flash, actionscript-3, actionscript

在我们的产品中，我们使用一个小型闪存小程序与服务器应用程序 (rpc) 进行实时通信。我们将此产品出售给具有内部安全警察的公司客户，有时很奇怪:) 据我所知（但不确定）闪存套接字直接连接到指定的主机，如果需要，使用系统（或 Intranet）代理设置。这很适合我们，但在一家公司，代理设置直接在浏览器 (IE) 中设置，系统代理阻止任何外部请求。为了防止这种情况，我们需要让我们的小程序理解 IE（如果可能的话，任何浏览器）代理设置，并通过它与我们的应用程序通信。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T07:37:31.923

没办法，你检测不到当前浏览器的代理设置。

解决方案可能是向您的应用程序添加一个选项窗口。在这种情况下，用户可以定义新的代理条目并且您的应用程序可以使用它。

# jquery - 有 RoR 或 JQuery 的绘图插件吗？

> ID：1016757
> 
> 赞同：4
> 
> 时间：2009-06-19T07:29:54.543
> 
> 标签：jquery, ruby-on-rails, ajax, canvas

我正在使用 Ruby on Rails 编写一个基于 Web 的应用程序。在其中一种形式中，用户需要用鼠标绘制一些东西并用一些文本标记对象。简而言之，我需要一个

1.  像应用程序一样简单的油漆，我可以用鼠标在上面绘图。
2.  写简单的文字。
3.  将绘制的图表存储为文件以供将来编辑。
4.  将绘制的图表导出为 gif/jpeg 图像。

可以在[http://charles-harvey.co.uk/examples/paint/](http://charles-harvey.co.uk/examples/paint/)找到一个示例。以下是我的问题：

1.  是否有任何 RoR 插件可以让我在表单中添加类似绘画的对象？
2.  如果没有，是否有任何 JQuery 插件具有简单的绘画之类的应用程序，我可以将其包含在 rails 中？
3.  还有更多指针吗？

我可以编写一个简单的画布应用程序，但我的截止日期非常紧迫，我更喜欢使用已经过测试的东西。

PS：我找到了这样一个应用程序的链接，但忘了给它添加书签。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-12T16:15:53.533

我正在寻找类似的东西 - 今天遇到了这个看起来很有用的网站：

[http://detexify.kirelabs.org/classify.html](http://detexify.kirelabs.org/classify.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T07:37:13.017

1.  我不知道绘画插件。这个问题在 Rails 论坛上更好
2.  [http://caimansys.com/painter/](http://caimansys.com/painter/)这里可以下载源代码 :)
3.  我希望我能帮助你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-21T12:37:02.283

这个博客有一个使用 jquery 的好例子：http: [//motyar.blogspot.com/2010/01/draw-with-jquery.html](http://motyar.blogspot.com/2010/01/draw-with-jquery.html)

# python - 如何在 python 中使用 cookielib 和 httplib “保持活动”？

> ID：1016765
> 
> 赞同：1
> 
> 时间：2009-06-19T07:32:11.823
> 
> 标签：python, cookies, urllib2, httplib

在python中，我使用httplib，因为它“保持活动”http连接（与urllib（2）相反）。现在，我想将 cookielib 与 httplib 一起使用，但它们似乎互相讨厌！（无法将它们连接在一起）。

有谁知道该问题的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T08:26:38.500

[支持 keep-alive 的 urllib2 的 HTTP 处理程序](http://urlgrabber.baseurl.org/help/urlgrabber.keepalive.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-27T20:51:39.607

您应该尽早考虑使用该[`Requests`](http://docs.python-requests.org/en/latest/)库来重构您的代码。同时;

黑客警报！:)

我会采用其他建议的方式，但我做了一个 hack（尽管出于不同的原因），它确实在[httplib](https://docs.python.org/2/library/httplib.html)和[cookielib](https://docs.python.org/2/library/cookielib.html)之间创建了一个接口。

我所做的是`HTTPRequest`用最少的所需方法创建一个假货，这样[`CookieJar`](https://docs.python.org/2/library/cookielib.html#cookielib.CookieJar)它就可以识别它并根据需要处理 cookie。我使用了那个假请求对象，设置了 cookielib 所需的所有数据。

这是该类的代码：

```
class HTTPRequest( object ):
"""
Data container for HTTP request (used for cookie processing).
"""

    def __init__( self, host, url, headers={}, secure=False ):
        self._host = host
        self._url = url
        self._secure = secure
        self._headers = {}
        for key, value in headers.items():
            self.add_header(key, value)

    def has_header( self, name ):
        return name in self._headers

    def add_header( self, key, val ):
        self._headers[key.capitalize()] = val

    def add_unredirected_header(self, key, val):
        self._headers[key.capitalize()] = val

    def is_unverifiable( self ):
        return True

    def get_type( self ):
        return 'https' if self._secure else 'http'

    def get_full_url( self ):
        port_str = ""
        port = str(self._host[1])
        if self._secure:
            if port != 443:
                port_str = ":"+port
        else:
            if port != 80:
                port_str = ":"+port
        return self.get_type() + '://' + self._host[0] + port_str + self._url

    def get_header( self, header_name, default=None ):
        return self._headers.get( header_name, default )

    def get_host( self ):
        return self._host[0]

    get_origin_req_host = get_host

    def get_headers( self ):
        return self._headers 
```

请注意，该课程仅支持 HTTPS 协议（目前我只需要）。

使用此类的代码是（请注意另一个 hack 以使响应与 cookielib 兼容）：

```
cookies = CookieJar()

headers = {
    # headers that you wish to set
}

# construct fake request
fake_request = HTTPRequest( host, request_url, headers )

# add cookies to fake request
cookies.add_cookie_header(fake_request)

# issue an httplib.HTTPConnection based request using cookies and headers from the fake request
http_connection.request(type, request_url, body, fake_request.get_headers())

response = http_connection.getresponse()

if response.status == httplib.OK:
    # HACK: pretend we're urllib2 response
    response.info = lambda : response.msg

    # read and store cookies from response
    cookies.extract_cookies(response, fake_request)

    # process response... 
```

# perl - 如何将“1..15,16”之类的字符串扩展为数字列表？

> ID：1016766
> 
> 赞同：6
> 
> 时间：2009-06-19T07:32:15.817
> 
> 标签：perl, string, range, numbers

我有一个 Perl 应用程序，它从命令行获取输入：

```
application --fields 1-6,8 
```

我需要在命令行上显示用户请求的字段。

我想用'..'代替'-'，这样我就可以将它们存储在数组中，例如

```
$str = "1..15,16" ;
@arr2 = ( $str ) ;
@arr = ( 1..15,16 ) ;
print "@arr\n" ;
print "@arr2\n" ; 
```

这里的问题是@arr 可以正常工作（应该如此），但在@arr2 中，整个字符串不会扩展为数组元素。

我尝试过使用转义序列，但没有运气。

可以这样做吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-19T08:13:41.007

如果这是用户输入，如果您有任何安全问题，请不要在其上使用字符串 eval。

尝试使用[Number::Range](http://search.cpan.org/perldoc/Number::Range)代替：

```
 use Number::Range;

 $str = "1..15,16" ;
 @arr2 = Number::Range->new( $str )->range;
 print for @arr2; 
```

为避免在无效范围内死亡，请执行以下操作：

```
 eval { @arr2 = Number::Range->new( $str )->range; 1 } or your_error_handling 
```

还有[Set::IntSpan](http://search.cpan.org/perldoc/Set::IntSpan)，它使用 - 而不是 ..：

```
 use Set::IntSpan;

 $str = "1-15,16";
 @arr2 = Set::IntSpan->new( $str )->elements; 
```

但它要求范围是有序且不重叠的（它是为 .newsrc 文件而编写的，如果有人记得那些是什么的话）。它还允许无限范围（字符串开始的地方 -*数字*或结束*数字*- ），元素方法将在这些范围内发牢骚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T07:46:00.940

您正在考虑`@arr2 = eval($str);` 由于您正在接受输入并对其进行评估，因此您需要小心。你应该可能`@arr2 = eval($str) if ($str =~ m/^[0-9.,]+$/)`

PS 我不知道 Number::Range 包，但它[很棒](http://kobesearch.cpan.org/htdocs/Number-Range/Number/Range.pm.html#new-)。编号::范围 ftw。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-21T01:15:42.670

在处理 Bit::Vector::to_Enum 的输出时，我遇到了同样的问题。我通过这样做解决了它：

```
$range_string =~ s/\b(\d+)-(\d+)\b/expand_range($1,$2)/eg; 
```

然后也在我的文件中：

```
sub expand_range
{
    return join(",",($_[0] .. $_[1]));
} 
```

所以“1,3,5-7,9,12-15”变成了“1,3,5,6,7,9,12,13,14,15”。

我非常努力地将扩展放在 s/// 的第二部分，所以我不需要那个额外的功能，但我无法让它工作。我喜欢这个，因为虽然 Number::Range 可以工作，但这样我就不必为应该微不足道的事情引入另一个模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T07:37:57.540

```
@arr2 = ( eval $str ) ; 
```

工作，当然你必须非常小心 eval()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T07:39:17.787

你可以使用评估：

```
$str = "1..15,16" ;
@arr2 = ( eval $str ) ;
@arr = ( 1..15,16 ) ;
print "@arr\n" ;
print "@arr2\n" ; 
```

虽然如果这是用户输入，您可能需要先对输入字符串进行一些验证，以确保他们没有输入任何不可靠的内容。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-06-19T07:35:05.533

使用拆分：

```
@parts = split(/\,/, $fields);

print $parts[0];
1-6
print $parts[1];
8 
```

你不能只把一个包含 ',' 的字符串放在一个数组中，然后期望它变成元素（除非你使用一些 Perl 黑魔法，但我们不会在这里讨论）

但是 Regex 和 split 是你的朋友。

# asp.net-mvc - 在 Asp.Net Mvc 中递归渲染局部视图是个坏主意吗？

> ID：1016771
> 
> 赞同：3
> 
> 时间：2009-06-19T07:34:35.377
> 
> 标签：asp.net-mvc, recursion, partial-views

我想输出一个看起来像这样的菜单结构

```
<ul>
   <li>
      MenuItemName1
      <ul>
        <li>Child Item</li>
      </ul>
   </li>
   <li>
      MenuItemName2
   </li>
</ul> 
```

我有一个 menuitem 类，其中包含名称、url 和子菜单项。我想创建一个局部视图，将每个项目呈现为像上面一样的无序列表，我会递归调用它来遍历整个树。

这是一个坏主意吗？会不会很慢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T07:49:45.503

我正在这样做，它似乎并不特别慢，但它不是一个高容量的站点。将是连接一些缓存的好地方。

查看[我关于同一主题的问题](https://stackoverflow.com/questions/942489/recursion-in-an-asp-net-mvc-view)的答案。我认为 HTMLHelper 扩展方法可能比嵌套的局部视图执行得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:12:38.627

懒惰并为自己节省一些重复性工作总是一个好主意。

它不应该比直接在其上包含所有元素且没有部分渲染调用的视图慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-31T08:44:14.727

我不确定 MVC 但对于传统的 ASP.Net 2.0，如果您将用户控件嵌套得太深，您可能会破坏堆栈。我在大约 10 层以上的嵌套中看到过这种情况。

# java - 如何更改小程序打印的策略文件

> ID：1016777
> 
> 赞同：-1
> 
> 时间：2009-06-19T07:36:38.757
> 
> 标签：java

Java 小程序默认不支持打印。如何更改用于小程序打印的 java.policy 文件？我想从小程序打印。

此外，此方法为我返回 NULL：

```
PrintServiceLookup.lookupDefaultPrintService() 
```

请提供参考资料和示例代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T08:09:30.453

取决于您需要在哪里使用该小程序。如果您只需要一个工作站，那么您最好将其作为应用程序而不是小程序运行。

如果可行，您还可以在每台客户端计算机上部署匹配策略或使用签名的小程序。

这里有一些相关的链接

[Java 插件指南](http://java.sun.com/j2se/1.5.0/docs/guide/plugin/developer_guide/contents.html)-> 尤其是第三部分

[签名小程序：Java 词汇表](http://mindprod.com/jgloss/signedapplets.html)

[Java 教程签名小程序](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/signed.html)-> 有点过时的教程

[默认策略实施和策略文件语法](http://java.sun.com/javase/6/docs/technotes/guides/security/PolicyFiles.html)-> 所有您可能想知道的有关策略文件以及如何制作它们的信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T06:00:57.217

我遇到了同样的问题，我通过在 Java.policy 文件中添加以下行来解决它：

```
permission java.security.AllPermission; 
```

但仍然无法找出所需的确切许可。授予所有权限对于小程序来说是不安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T09:32:13.767

当您尝试从小程序打印时，应向用户显示一个要求打印的对话框。IIRC，如果被拒绝，`SecurityException`将照常抛出。

# git - 从 git-diff 中排除文件

> ID：1016798
> 
> 赞同：62
> 
> 时间：2009-06-19T07:47:06.600
> 
> 标签：git

我正在用 git 跟踪一个项目。我想继续跟踪工作副本中的一些 Xcode 项目文件，但不想在差异中看到，因为总是有几十行我不感兴趣的更改行。有没有一种简单的方法可以`git-diff`跳过这些文件？我尝试设置一个自定义的“静默”差异工具：

```
$ 猫 .git 属性
Project.xcodeproj/* diff=nodiff

$ 猫 ~/.gitconfig
[差异“nodiff”]
    命令 = /bin/true

```

但：

```
$混帐差异
外部差异死了，停在 Project.xcodeproj/zoul.mode1v3。

```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-06-19T12:23:20.740

问题是`/bin/true`它将立即返回而不读取其输入。`git diff`因此，相当合理地认为，它已经过早死亡。

您真正想要做的是取消设置 diff 属性，而不是将其设置为虚假命令。在你的试试这个`.gitattributes`：

```
Project.xcodeproj/* -diff 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T08:57:15.710

您可以在 .git/config 中使用别名

```
[alias]
        mydiff = !git diff | filterdiff -x "*/Project.xcodeproj/*" 
```

你需要 filterdiff （来自 patchutils）这个技巧。

```
sudo apt-get install patchutils 
```

差异仍然不完美，它留下了一些垃圾：

```
yannick@yannick-desktop:~/git-filter-test$ git mydiff
diff --git a/Project.xcodeproj/dummy.txt b/Project.xcodeproj/dummy.txt
index 3e1f9e6..89dfed9 100644
diff --git a/dummy2.txt b/dummy2.txt
index 91966ce..d9588a9 100644
--- a/titi.txt
+++ b/titi.txt
@@ -1,3 +1,3 @@
 aaaaaaaaaa
-bbbbbbbbb
 cccccc
+ddd 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-07-26T20:58:22.137

另一种无需任何外部工具即可产生干净输出的解决方案（添加到`.git/config`）：

```
[alias]
    mydiff = !git diff -- $(git diff --name-only | grep -Ev "Project.xcodeproj/") 
```

然后运行它：

```
git mydiff 
```

请注意，这`git diff --name-only`比`git ls-files`因为它会将更短的文件列表传递给更好`git diff`，因为只有被修改的文件才会被包括在内。在使用`git ls-files`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-25T02:56:22.667

以防其他人有与我们一样的痛苦。我们想排除一个已经提交的文件。

这篇文章更有用： [使用 .git/info/exclude 太晚了](https://stackoverflow.com/questions/1158857/working-with-git-info-exclude-too-late)

具体来说，您需要忽略文件实际上是使用命令 git remove 参见**git rm** ( [http://www.kernel.org/pub/software/scm/git/docs/git-rm.html](http://www.kernel.org/pub/software/scm/git/docs/git-rm.html) )

你去测试它

**`git rm --dry-run *.log`**
（如果您说要排除所有日志文件）

如果您运行它，这将输出*将被*排除的内容。

然后

你通过去运行它

**`git rm *.log`**
（或您想要的任何文件名路径/表达式）

# c# - 在 Dispose 方法中关闭数据库连接是否正确？

> ID：1016800
> 
> 赞同：5
> 
> 时间：2009-06-19T07:47:36.067
> 
> 标签：c#, .net, database-connection, dispose

我怀疑在我们的一个应用程序中使用的数据库连接并不总是关闭。我去看了代码，发现了一个`DataProvider`有`SqlConnection`对象的类。连接在此类的构造函数中打开并在其`Dispose`方法中关闭（不要判断，我知道保持打开的连接是邪恶的，这不是我的代码，也不是问题的重点）。该`Dispose`方法是这样实现的：

```
protected virtual void Dispose(bool disposing)
{
    if (!_disposed)
    {
        if (disposing)
        {
            if (_conn != null)
                _conn.Close();
        }

        _disposed = true;
    }
} 
```

问题是：
它总是保证连接是关闭的吗？
这段代码对吗？

我认为应该`_conn.Dispose()`调用 - 我是对的，它会影响不关闭连接（可能不会）吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T08:09:53.793

Dispose 永远不会被自动调用。

在显式调用对象的 Dispose 方法或在 using() 块中使用您的类之前，连接不会关闭

更安全的方法是在终结器中调用 dispose 方法，并确保在调用 Dispose 方法时抑制终结器。

[本文](http://www.codeproject.com/KB/cs/idispose.aspx)介绍了实现该模式的正确方法

希望能帮助到你 ！

塞德里克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T07:57:07.640

`conn.Dispose();`也将关闭连接，因此更改它以遵循处置模式不会有什么坏处。

但是在功能上是等效的，所以在其他地方肯定有问题。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.close.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.close.aspx)

> 如果 SqlConnection 超出范围，它不会被关闭。因此，您必须通过调用 Close 或 Dispose 显式关闭连接。Close 和 Dispose 在功能上是等效的。如果连接池值 Pooling 设置为 true 或 yes，则将底层连接返回到连接池。另一方面，如果 Pooling 设置为 false 或 no，则与服务器的底层连接将关闭。

# php - 如何按相关性对MYSQL全文搜索结果进行排序

> ID：1016804
> 
> 赞同：24
> 
> 时间：2009-06-19T07:48:27.597
> 
> 标签：php, mysql, sorting, full-text-search

我对 MYSQL 比较陌生，并且遇到了一个困扰我一段时间的问题。我已经尝试在整个地方搜索答案，但到目前为止还没有找到可接受的解决方案。

这是我目前正在运行的查询，以查找给定搜索词的最佳匹配项：

```
$query="SELECT * from `vocabulary` WHERE translation = 'word' OR translation LIKE '%word%'"; 
```

它返回的结果很全面，包括所有相关行。但是，它们没有按任何特定顺序排序，当我在 PHP 中打印结果时，我希望首先显示完全匹配的那些。像这样：

* * *

1 | 单词 <-精确匹配
2 | 填字游戏 <- 部分匹配按字母顺序排序 /
3 | 话
4 | 文字匠

* * *

非常感谢您的帮助。

-macspacejunkie

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-19T08:31:29.677

LIKE 不是[全文搜索](http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html)。在全文搜索中，`MATCH(...) AGAINST(...)`返回一个可以大致近似为相关性的匹配分数。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-19T08:41:38.800

您可以通过创建全文索引然后匹配您的搜索词来获得良好的相关性搜索。

所以这样的事情应该有效。

```
ALTER TABLE `vocabulary` ADD FULLTEXT INDEX `SEARCH`(`translation`);

SELECT *, MATCH(translation) AGAINST ('+word' IN BOOLEAN MODE) AS relevance 
FROM `vocabulary`
WHERE MATCH(translation) AGAINST ('+word' IN BOOLEAN MODE)
ORDER BY relevance DESC 
```

更多信息可以在[MySQL 参考手册](http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html)中找到。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-06-19T07:58:39.230

```
SELECT * from vocabulary 
WHERE translation like 'word'  
union all
SELECT * from vocabulary 
WHERE translation LIKE '%word%' and translation not like 'word' 
```

将首先列出完全匹配

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-03-05T15:33:21.060

我一直在研究同样的问题，但还没有找到适合我情况的完美答案，但这可能对你有用。我对全文搜索也很陌生，所以任何专家也可以帮助我。

我在 select 中执行两个 MATCH() AGAINST() 语句，并将每个语句的分数组合起来形成总相关性。分配不同的乘数允许我配置每组结果的重要性。

我的第一个 MATCH() 将使用双引号检查文字（或精确）搜索词。我的第二场比赛会正常检查。我对第一个匹配项应用了更高的乘数，因此如果找到它应该具有更高的相关性值。

像这样的东西。

```
SELECT *, ((MATCH(indexes) AGAINST ('"search_terms"' IN BOOLEAN MODE) * 10)  
           + (MATCH(indexes) AGAINST ('search_terms' IN BOOLEAN MODE) * 1.5)) AS relevance  
FROM ...
WHERE ...  
      AND (MATCH (indexes) AGAINST ('"search_terms"' IN BOOLEAN MODE) > 0  
           OR MATCH (indexes) AGAINST ('search_terms' IN BOOLEAN MODE) > 0)  
      ...
ORDER BY relevance DESC 
```

如果你使用 EXPLAIN 来检查查询是如何工作的，你应该会发现额外的 MATCH() AGAINST() 子句实际上并没有因为 MySQL 的工作方式给查询增加任何开销。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-05T15:30:24.083

您的查询只需稍作修改即可获得您要查找的订单。

```
SELECT * 
FROM vocabulary
WHERE translation LIKE '%word%'
ORDER BY translation <> 'word', translation; 
```

如果`translation`恰好是`'word'`，它将位于结果的顶部。这是因为`translation <> 'word'`当有一个**精确***匹配*出现在**1**之前，它将为所有其他结果返回。由于.***`, translation`***

 ***此查询避免像所选答案对其`UNION`. 此外，您的查询不需要，`translation = 'word' OR translation LIKE '%word%'`因为后半部分将始终执行并且是第一部分的超集。

对于那些寻找使用*实际*全文搜索的答案的人，请参阅其他更受好评的答案。***

# fonts - Carbon/Cocoa 字体看起来不同

> ID：1016812
> 
> 赞同：2
> 
> 时间：2009-06-19T07:52:56.400
> 
> 标签：fonts, macos-carbon

我正在尝试使用 Carbon 应用程序中的 ATSU api 绘制当前选择的系统字体。并且字体比所有其他本地应用程序都更大胆。这是我正在谈论的屏幕截图示例：

[![](../Images/a46c68bd11e028ac0e261b71d472d920.png)](https://i.stack.imgur.com/wy9Gj.png)
[（来源：[memecode.com](http://memecode.com/images/blog/carbon-fonts.png)）]

最上面一行是 XCode，中间是我使用非粗体字体的应用程序，底部是我使用粗体字体的应用程序。我使用了相同的文本，以便轻松查看它们之间的重量差异。我用来创建我绘制的样式的代码是：

```
if (Face() AND !(e = ATSUCreateStyle(&d->hFont)))
{
    // Lookup ID
    ATSUFontID atsuFont = 0;
    e = ATSUFindFontFromName(Face(),
                            strlen(Face()),
                            kFontFamilyName,
                            (FontPlatformCode)kFontNoPlatform,
                            (FontScriptCode)kFontNoScript,
                            (FontLanguageCode)kFontNoLanguage,
                            &atsuFont);
    if (!e)
    {
        Fixed Size;
        Size = PointSize() << 16;
        Boolean IsBold = Bold();
        Boolean IsItalic = Italic();
        Boolean IsUnder = Underline();

        // Set style attr
        ATSUAttributeTag Tags[]         = {kATSUFontTag,     kATSUSizeTag, kATSUQDItalicTag, kATSUQDUnderlineTag, kATSUQDBoldfaceTag};
        ATSUAttributeValuePtr Values[]  = {&atsuFont,        &Size,        &IsItalic,        &IsUnder,            &IsBold};
        ByteCount Lengths[]             = {sizeof(atsuFont), sizeof(Size), sizeof(IsItalic), sizeof(IsUnder),     sizeof(IsBold)};
        if (!(e = ATSUSetAttributes(d->hFont,
                                    CountOf(Tags),
                                    Tags,
                                    Lengths,
                                    Values)))
        {
            GDisplayString ds(this, "A");
            d->Height = ds.Y();
            return true;
        }
    }
} 
```

其中“Face()”返回一个包含字体名称的 C 字符串，“PointSize()”返回一个包含我想要的点大小等的整数。我正在使用以下代码检索这些值：

```
Str255 Name;
SInt16 Size;
Style St;
OSStatus e = GetThemeFont(  kThemeSmallSystemFont,
                            smSystemScript,
                            Name,
                            &Size,
                            &St);
if (e) printf("%s:%i - GetThemeFont failed with %i\n", __FILE__, __LINE__, e);
else
{
    Info.Face(p2c(Name));
    Info.PointSize(Size);
    Status = true;
} 
```

它返回有效的外观/点大小信息，实际上字体看起来是正确的，只是它看起来比其他应用程序更粗。它可能看起来没什么大区别，但是当您的整个应用程序充满文本时，它就会变得很明显。我的旗舰产品是一个电子邮件客户端......因此有很多文字。

创建布局并最终调用 ATSUDrawText 的绘图代码很长，我不确定它是否会导致问题..我认为它与样式更相关......但如果需要，我稍后会发布指向该来源的链接.

任何人都可以帮助我的字体看起来不那么粗体吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-15T21:17:08.373

我已将 cocoa ATSU 示例代码转换为 carbon 并与我自己的代码一起运行。它看起来是正确的，所以我改进了该代码并找出了我做的不同之处。事实证明，这是将字体名称转换为 ATSUFontID 的初始阶段。显然我正在使用 ATSUFindFontFromName 这似乎是完全合理的，但它看起来与操作系统的其余部分不同。替换代码的正确下降是：

```
CFStringRef fontName = CFStringCreateWithBytes( kCFAllocatorDefault,
                                                (UInt8*)Face(),
                                                strlen(Face()),
                                                kCFStringEncodingUTF8,
                                                false);
ATSFontRef atsFont = ATSFontFindFromName(fontName, kATSOptionFlagsDefault);
CFRelease(fontName);
ATSUFontID font = FMGetFontFromATSFontRef(atsFont); 
```

所以现在我的应用看起来很棒:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-19T09:45:41.790

实际上，这就是您在应用程序的上一行看到的粗体字。这是[照片证据](http://boredzo.org/screenshots/ItReallyIsBold.png)，右边是 TextEdit 中的 Lucida Grande Bold 11。您的应用程序中的下一行是添加了人造粗体的行。

而且您知道 Carbon 已被弃用，对吗？

# python - python中的“意外缩进”怎么办？

> ID：1016814
> 
> 赞同：155
> 
> 时间：2009-06-19T07:53:20.207
> 
> 标签：python, indentation

如何纠正python中的错误“意外缩进”？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2009-06-19T11:03:01.273

Python 使用行首的间距来确定代码块的开始和结束时间。您可能会遇到的错误是：

**意外缩进。**这行代码开头的空格比前面的多，但前面的不是子块的开头（例如 if/while/for 语句）。块中的所有代码行必须以完全相同的空白字符串开头。例如：

```
>>> def a():
...   print "foo"
...     print "bar"
IndentationError: unexpected indent 
```

这在以交互方式运行 python 时特别常见：确保在命令之前不要放置任何额外的空格。（复制粘贴示例代码时非常烦人！）

```
>>>   print "hello"
IndentationError: unexpected indent 
```

**Unndent 不匹配任何外部缩进级别。**这行代码开头的空格比前一行少，但同样它与它可能属于的任何其他块都不匹配。Python 无法决定它的去向。例如，在下面，最终的打印是否应该是 if 子句的一部分？

```
>>> if user == "Joey":
...     print "Super secret powers enabled!"
...   print "Revealing super secrets"
IndendationError: unindent does not match any outer indentation level 
```

**需要一个缩进的块。**这行代码在开头的空格数与前一行相同，但最后一行应该开始一个块（例如 if/while/for 语句、函数定义）。

```
>>> def foo():
... print "Bar"
IndentationError: expected an indented block 
```

如果您想要一个不执行任何操作的函数，请使用“no-op”命令*pass*：

```
>>> def foo():
...     pass 
```

允许混合制表符和空格（至少在我的 Python 版本中），但 Python 假定制表符长度为 8 个字符，这可能与您的编辑器不匹配。**只需对标签说“不”。**大多数编辑器允许它们自动替换为空格。

避免这些问题的最佳方法是在缩进子块时始终使用一致数量的空格，并且最好使用可以为您解决问题的良好 IDE。这也将使您的代码更具可读性。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-19T08:00:08.227

在 Python 中，间距非常重要，它给出了代码块的结构。当您弄乱代码结构时会发生此错误，例如：

```
def test_function() :
   if 5 > 3 :
   print "hello" 
```

您的文件中可能还会混合使用制表符和空格。

我建议您使用 Python 语法感知编辑器，例如[PyScripter](http://code.google.com/p/pyscripter/)或[Netbeans](http://www.netbeans.org/)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2011-09-21T11:31:51.487

使用 -tt 选项运行您的代码，以了解您是否在不一致地使用制表符和空格

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-06-19T11:25:47.843

**在您使用的任何编辑器中打开可见空白并打开用空格替换制表符。**

虽然您可以将标签与 Python 混合使用标签和空格，但通常会导致您遇到的错误。用 4 个空格替换制表符是编写 Python 代码的推荐方法。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-06-19T07:58:22.753

通过使用正确的缩进。Python 可以识别空格，因此您需要遵循其对块的缩进指南，否则您会收到缩进错误。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-03-14T22:25:42.517

如果你正在使用 Sublime 编写 Python 并遇到缩进错误，

查看 -> 缩进 -> 将缩进转换为空格

我描述的问题是由 Sublime 文本编辑器引起的。同样的问题也可能是由其他编辑引起的。从本质上讲，这个问题与 Python 希望根据空格处理缩进与各种编辑器根据制表符对缩进进行编码有关。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-04-20T08:12:17.407

运行以下命令来解决它：

```
autopep8 -i <filename>.py 
```

这将更新您的代码并解决所有缩进错误:)

希望这会解决

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-09-16T14:33:24.257

确保在编辑器中使用“插入空格而不是制表符”选项。然后您可以选择您想要的选项卡宽度，例如 4。您可以在 gedit 中的 edit-->preferences-->editor 下找到这些选项。

底线：使用空格而不是标签

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2018-02-05T17:07:19.323

似乎没有提到的一个问题是，由于与缩进无关的代码问题，可能会出现此错误。

例如，采用以下脚本：

```
def add_one(x):
    try:
        return x + 1
add_one(5) 
```

`IndentationError: unexpected unindent`当问题当然是缺少`except:`语句时，这将返回。

我的观点：检查上面报告意外（未）缩进的代码！

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-01-17T18:32:25.460

将某些内容粘贴到 Python 解释器（终端/控制台）时也会发生此错误。

请注意，解释器将空行解释为表达式的结尾，因此如果您粘贴类似

```
def my_function():
    x = 3

    y = 7 
```

解释器会将之前的空行解释`y = 7`为表达式的结尾，即您已经完成了函数的定义，而下一行 -`y = 7`将有不正确的缩进，因为它是一个新表达式。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-06-19T11:21:56.823

有一个技巧一直对我有用：

如果你得到了意外的缩进并且你看到所有的代码都被完美地缩进了，试着用另一个编辑器打开它，你会看到哪一行代码没有缩进。

当我使用 vim、gedit 或类似的编辑器时，它发生在我身上。

尝试仅对您的代码使用 1 个编辑器。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-06-19T11:15:26.460

如果缩进看起来没问题，那么看看你的编辑器是否有“查看空白”选项。启用此功能应该可以找到空格和制表符混合的位置。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-10-19T12:03:16.657

这取决于上下文。另一个尚未涵盖的场景如下。假设您有一个文件，其中包含一个包含特定方法的类

```
class Scraper:
    def __init__(self):
        pass

    def scrape_html(self, html: str):
        pass 
```

在文件的底部你有类似的东西

```
if __name__ == "__main__":
    # some
    # commands
    # doing
    # stuff 
```

使整个文件看起来像这样

```
class Scraper:
    def __init__(self):
        pass

    def scrape_html(self, html: str):
        pass

if __name__ == "__main__":
    # some
    # commands
    # doing
    # stuff 
```

例如，如果在 scrape_html() 中打开 if/else 语句

```
class Scraper:
    def __init__(self):
        pass

    def scrape_html(self, html: str):
        if condition:
            pass
        else:

if __name__ == "__main__":
    parser = argparse.ArgumentParser() 
```

您需要在`pass`else 语句中添加或添加任何您想要的内容，否则您将得到

> 预期的缩进块

[![在此处输入图像描述](../Images/89aab55f3fd151dacaf6fbb25d2b4d0f.png)](https://i.stack.imgur.com/7tHQb.png)

> 未预期不缩进

[![在此处输入图像描述](../Images/031e8a6a6524e4c370a940d2403eb2f9.png)](https://i.stack.imgur.com/lfG8E.png)

> 预期表达

[![在此处输入图像描述](../Images/8b9ec8c1df14c00a993e9e6811d1c66a.png)](https://i.stack.imgur.com/KXoA1.png)

并且在第一行

> 意外缩进

[![在此处输入图像描述](../Images/46cf2c909787a4b17baea662804c2039.png)](https://i.stack.imgur.com/5rI5a.png)

添加它`pass`可以解决所有这四个问题。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-04-22T15:49:14.637

您需要做的就是从以下代码的开头删除空格或制表符空格

```
from django.contrib import admin

# Register your models here.
from .models import Myapp
admin.site.register(Myapp) 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-02-11T12:40:59.600

只需复制您的脚本并将您的整个代码“””放在“””下...

在变量中指定这一行.. 像，

```
a = """ your python script """
print a.replace('here please press tab button it will insert some space"," here simply press space bar four times")
# here we replacing tab space by four char space as per pep 8 style guide.. 
```

现在在 Sublime Editor 中使用 ctrl+b 执行此代码，现在它将在控制台中打印缩进代码。而已

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-09-17T23:38:25.763

Notepad++ 给出了正确的制表符空间，但最终在 Sublime 文本编辑器中发现了缩进问题。

使用 Sublime 文本编辑器并逐行执行

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2021-05-08T04:17:18.550

这取决于上下文，但缩进错误通常是由使用制表符而不是空格引起的。

您可以采取以下步骤来纠正此问题：

1.  复制导致错误的制表符或空格
2.  在您的 IDE 中进行查找和替换（通常是 Ctrl + H）。
3.  将复制的制表符或空格粘贴到“查找”搜索栏中，然后将它们全部替换为 4 个空格（假设您的 IDE 使用 4 个空格作为“好的”缩进）

如果您将代码从外部源复制并粘贴到 IDE 中，也会经常发生此错误，因为其他地方的格式可能与您的 IDE 定义的“良好”缩进不匹配。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-04-16T07:26:16.197

**Python 中的缩进**很重要，与许多其他编程语言不同，这并不是为了代码的可读性。如果连续命令之间的代码中有任何空格或制表符，python 将给出此错误，因为 Python 对此很敏感。当我们将代码复制并粘贴到任何 Python 时，我们可能会收到此错误。 **确保使用 Notepad++ 等文本编辑器识别并删除这些空格，或者从出现错误的代码行中手动删除空格。**

```
Step1 :Gives error 
L = [[1, 2, 3], [4, 5, 6], [7, 8, 9, 10]]
print(L[2: ])

Step2: L = [[1, 2, 3], [4, 5, 6], [7, 8, 9, 10]]print(L[2: ])

Step3: No error after space was removed
L = [[1, 2, 3], [4, 5, 6], [7, 8, 9, 10]]
print(L[2: ])
OUTPUT: [[7, 8, 9, 10]] 
```

谢谢！

# c# - C# - 如何重命名我启动的进程窗口？

> ID：1016823
> 
> 赞同：6
> 
> 时间：2009-06-19T07:57:16.407
> 
> 标签：c#, process, window, titlebar

有什么方法可以重命名已启动的应用程序的窗口标题栏？即，如果我启动 Notepad.exe，我可以将其标题栏从“Untitled - Notepad”重命名为“New Notepad Name”。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-19T08:11:50.670

您可以使用 P/Invoke 执行此操作：

```
[DllImport("user32.dll")]
static extern int SetWindowText(IntPtr hWnd, string text);

private void StartMyNotepad()
{
    Process p = Process.Start("notepad.exe");
    Thread.Sleep(100);  // <-- ugly hack
    SetWindowText(p.MainWindowHandle, "My Notepad");
} 
```

代码示例中丑陋的 hack 的背景是，似乎您在启动进程后立即调用 SetWindowText，标题不会改变。也许消息在记事本的消息队列中结束得太早了，所以记事本会在之后再次设置标题。

另请注意，这是一个非常简短的更改；如果用户选择 File -> New（或执行任何其他会导致记事本更新窗口标题的操作），则原始标题将返回...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T08:11:46.503

实际上，我自己对其进行了排序，并且效果很好。不管怎么说，还是要谢谢你。

```
[DllImport("user32.dll")]
static extern SetWindowText(IntPtr hWnd, string windowName);

IntPtr handle = p.MainWindowHandle;
SetWindowText(handle, "This is my new title"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T08:12:33.037

您不能在 C# 中执行此操作，但您可以使用低级 API 执行此操作。在进程中注入一个线程，从中调用[SetWindowText()](http://msdn.microsoft.com/en-us/library/ms633546%28VS.85%29.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-07-20T12:18:15.100

正如@Fredrik Mörk 认为的那样，问题在于需要等待窗口可以接收消息才能设置其标题。等待 100 毫秒可能会破坏程序的内部消息循环，这只是一种解决方法。要接收消息，窗口必须有一个用于引用该窗口的句柄，因此您可以简单地等待窗口的句柄，它在启动时应该是`IntPtr.Zero`（一个空的句柄）。

这是这种方法的一个示例：

```
Process p = Process.Start("notepad.exe");
while (p.MainWindowHandle == IntPtr.Zero)
    Application.DoEvents();
SetWindowText(p.MainWindowHandle, "My Notepad"); 
```

使用`Application.DoEvents()`该程序将继续接收和处理系统消息，因此它不会阻塞（也不会崩溃），尽管它不是异步的。

您还可以考虑通过用调用替换`while`语句来避免 CPU 开销`SpinWait.SpinUntil`（因此，您需要 import `System.Threading`）：

```
Process p = Process.Start("notepad.exe");
SpinWait.SpinUntil(() => p.MainWindowHandle != IntPtr.Zero);
SetWindowText(p.MainWindowHandle, "My Notepad"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-02T17:26:42.923

我实施了@Davide Cannizo 解决方案，并发现一个问题可能与其他循环的解决方案也一样——该过程可能在意识到`MainWindowHandle`非零之前就已经完成。当我并行运行许多进程并且一两个进程非常短暂时，这发生在我身上。具体问题是 a`SystemAggregrationError`因为检查`p.MainWindowHandle != IntPtr.Zero`导致多个`InvalidOperationError`'.

解决方案是添加对进程是否退出的检查。寻找`p.HasExited`以下内容。

```
using System;
using System.Runtime.InteropServices;

class Program
{
  [DllImport("user32.dll")]
  static extern int SetWindowText(IntPtr hWnd, string text);

  static void Main(string[] args)
  {
    using (System.Diagnostics.Process p = new System.Diagnostics.Process())
    {
      p.StartInfo = new System.Diagnostics.ProcessStartInfo()
      {
        FileName = @"notepad.exe",
        Arguments = @""
      };

      string window_title = "notepad demo";
      p.Start();
      System.Threading.SpinWait.SpinUntil(() => p.HasExited || p.MainWindowHandle != IntPtr.Zero);
      if (!p.HasExited)
        SetWindowText(p.MainWindowHandle, window_title);
      p.WaitForExit();
    }
  }
} 
```

另外两点需要注意：

*   在开发这个时，我首先尝试使用 .NET Core。那失败了——`p.MainWindowHandler`总是0。我不得不切换到.NET Framework。
*   如果进程退出，我不相信这`SetWindowText(p.MainWindowHandle, window_title)`会导致异常。根据[此处](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowtexta)的文档，它可能会失败，但只会返回 0 而不是非零。这意味着如果我们完成了`SpinUntil`因为`MainWindowHandle`是非零的，但是在那个点和`SetWindowText`进程退出之间，它不会导致异常。但是，在我的测试中，我确实必须添加该`if (!p.HasExited)`行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-05T06:45:33.700

我必须使用以下代码才能使其工作：

```
while (p.MainWindowHandle == IntPtr.Zero)
      Thread.Sleep(100); 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-06-19T08:06:57.590

不。

这将要求目标应用程序完全允许修改窗口标题。许多程序使用它们的标题来显示有用的信息（例如在记事本中打开以进行编辑的文件的名称，或`<TITLE>`在 Firefox 中打开的 HTML 文档的名称）。

我知道的一种情况是让用户在很少限制的情况下设置标题文本是在控制台窗口中运行的 CMD.EXE。CMD 支持`TITLE`根据其参数设置窗口标题的内置命令。但是，如果不将击键注入特定的控制台窗口，则无法通过第二个窗口来完成，通常不建议这样做。

**编辑：**

由于这个想法是浮动的，它`SetWindowText()`会为你做这件事，让我澄清一下。

该 API 函数确实会更改顶级窗口的标题栏。事实上，像记事本这样的应用程序可能会在它认为标题已更改时使用它来设置自己的标题。

我声称这**不是**解决方案的原因是记事本确实会在需要时更改标题。支持任意更改其标题的应用程序将具有某种机制来记住标题已更改，而不是任意恢复其首选标题字符串。

# .net - 在 MVVM 中，DataTemplates 是否将 Views 视为 UserControls 是 Views？

> ID：1016828
> 
> 赞同：7
> 
> 时间：2009-06-19T07:58:21.490
> 
> 标签：.net, wpf, mvvm, viewmodel, datatemplate

在 MVVM 中，每个 View 都有一个 ViewModel。我理解的视图是一个**窗口、页面或用户控件**，您可以将视图模型附加到其中，视图从中获取其数据。

但是**DataTemplate**也可以呈现 ViewModel 的数据。

所以我理解 DataTemplate 是另一个“视图”，但似乎存在**差异**，例如 Windows、Pages 和 UserControls 可以定义自己的 .dll，一种类型通过附加模板与 DataContect 绑定，以便 Windows、Pages , UserControls 可以通过**ServiceLocator/Container**等动态附加到 ViewModels。

**在 UI 上呈现 ViewModel 的数据时，DataTemplates 与 Windows/Pages/UserControls 有何不同？除了这四种之外，还有其他类型的“视图”吗？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T10:02:38.167

我使用它的方式，DataTemplate 实际上是将 View 链接到 ViewModel 的方式。通常我在 MVVM 中的 DataTemplates 看起来像这样：

```
<DataTemplate DataType="{x:Type vm:FooViewModel}">
    <v:FooView />
</DataTemplate> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T06:16:17.557

在过渡到 MVVM 时，对我来说最有意义的是：

UserControls：将视图和控件组合在一起，旨在为用户执行整个过程。我将用户控件用于我创建的滑出式抽屉，它允许用户翻阅不同分类的零件（其中每个主要零件类别都通过自己的选择过程/向导引导用户）。另请查看图表控件。

视图：基本上是一个网格，它对相关数据和控件进行分组，以最小的级别填充所需数据，以便可以重复使用。

DataTemplates：对“项目”的事实进行分组，例如在列表框或 GridView 中。我认为这只是文本如何代表您试图在列表中获取信息的对象。因此，控制模板将包装数据模板块以控制该数据模板包装项目集合的显示行为。

我是这么理解的，但是界限很模糊。我喜欢 Andrew Troelson 的 Apress 书***Pro Expression Blend 4***。不过，他并没有真正给出任何大量数据的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-18T14:59:58.990

我不建议使用 DataTemplate 将视图绑定到视图模型。我目前在使用这种方法时遇到性能问题，因为每次视图获得焦点时都会刷新视图。正如你[在这里](https://stackoverflow.com/questions/2770387/binding-tabcontrol-itemssource-to-an-observablecollection-of-viewmodels-causes-co)和[这里所看到的](https://stackoverflow.com/questions/2835430/value-of-text-box-disapears-binding-viewmodel-to-a-tab-content-control)

不幸的是，我还没有找到更好的选择。

# php - 搜索引擎重定向

> ID：1016835
> 
> 赞同：0
> 
> 时间：2009-06-19T07:59:33.890
> 
> 标签：php, html, search, search-engine

我不知道这被称为什么的官方术语，但非常感谢任何建议。

场景如下：我的域上有一个 index.html 页面作为“建设中”页面，而我在 index.php 页面上使用 Drupal 开发了该页面背后的网站。

有什么方法可以让我在开发 index.php 时让 Google 索引 index.php 上的链接，或者这是一种愚蠢的做事方式？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T08:09:26.367

这可能违反 Google 的标准，并可能导致您的网站从 Google 的列表中删除 - 向用户提供一种类型的内容，而向 Google 的 Spider 提供另一种类型的内容。

可以使用 .htaccess 重写来完成

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T08:10:41.887

我会非常犹豫向谷歌提供不同的页面而不是普通访问者。虽然由于 Google 的保密性，细节很粗略，但您的网站可能会在 Google 的搜索引擎中受到处罚。

此外，如果这些链接所指向的页面上还没有有用的内容，那么您不太可能从任何主要搜索引擎中获得太多好处。如果您已经拥有该内容，您不妨将其放到网上（软启动）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T08:10:04.773

[使用在Google 网站管理员工具](http://www.google.com/webmasters)上提交的 sitemap.xml ？

我会考虑的另一件事是从 index.html 到 index.php 的 302 重定向。不过，您必须小心处理它的方式-以前的评论者的担忧是正确的...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T08:27:59.870

正如您从其他答案中看到的那样，您可以查看用户代理并提供不同的内容，但您不应该这样做，Google 不喜欢这样。

您可以尝试添加带有要索引的链接的[站点地图（查看链接以获取更多信息）](http://www.sitemaps.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T08:07:10.973

您可以检查 PHP 中的用户代理字符串，例如[此代码检查 GoogleBot](http://are.ehibou.com/php-script-to-detect-and-verify-googlebot/)。搜索“检测 GoogleBot”以获取更多类似脚本。

# sql - 更新 SQL 中游标选择的行

> ID：1016837
> 
> 赞同：2
> 
> 时间：2009-06-19T08:00:21.097
> 
> 标签：sql, oracle

在 oracle 中，如果我定义了一个游标，同时如果表上有更新，那么我的游标会发生什么？它是否变得无效或更新无关紧要？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T08:17:24.637

Oracle 中的每个查询都与一个时间点（通常是查询的开头）一致。

在您的情况下，如果您打开游标并在获取它时有人修改了行，Oracle 将重建数据的逻辑副本，就像您打开游标时一样。您将不会看到在此时间点之后对数据所做的修改。

这种读取一致性是 Oracle 引擎的基本部分。

从[概念指南](http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/intro.htm#sthref133)，读取一致性：

*   保证语句看到的数据集相对于单个时间点是一致的，并且在语句执行过程中不发生变化（语句级读一致性）
*   确保数据库数据的读取者不会等待相同数据的写入者或其他读取者
*   确保数据库数据的写入者不会等待相同数据的读取者
*   确保写入者仅在尝试更新并发事务中的相同行时才等待其他写入者

# unit-testing - 下一步是由编辑触发的测试吗？

> ID：1016841
> 
> 赞同：8
> 
> 时间：2009-06-19T08:01:08.287
> 
> 标签：unit-testing, testing, ide, tdd, infinitest

我刚刚阅读了 Michael C. Feathers 的好书[Working Effectively with Legacy Code](https://rads.stackoverflow.com/amzn/click/com/0131177052)，这是一本将测试引入遗留代码的圣经。在这本书中，他描述了一种叫做**编辑触发测试的**东西：

> *如果这本书出版时还没有出版，我怀疑有人很快就会开发出一个 IDE，它允许您指定一组在每次击键时运行的测试。这将是关闭反馈循环的一种不可思议的方式。*
> 
> *它必须发生。这似乎是不可避免的。已经有 IDE 检查每次击键的语法并在出现错误时更改代码的颜色。下一步是编辑触发的测试。*

当我读到这篇文章时，我还没有听说过任何支持这一点的 IDE 或工具。但是，我刚刚找到了一个名为[Infinitest](http://infinitest.org/web/guest/home)的项目，它支持 Java 的这一功能。

我的问题是：

1.  是否有任何其他工具/框架支持这一点（希望也适用于 Visual Studio）？
2.  您对这种测试有什么经验（高效、减慢 IDE 等）？
3.  这是TDD的下一步吗？

**更新：**

*   看一下这个[截屏视频](http://infinitest.org/web/guest/blogs/-/blogs/quick-start-screencast-for-eclipse?_33_redirect=%2Fweb%2Fguest%2Fblogs)，了解 Infinitest 在 Eclipse 中的实际应用。
*   刚找到一个博客，Brett Schuchert 分享了[Infinitest 的一些经验](http://blog.objectmentor.com/articles/2009/06/18/infinitest-for-java-have-you-tried-it)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:02:36.533

自最初的问题以来已经有几年了，并且有一些可用于 .NET 的工具（我认为这个空间也适用于其他语言）。

有一个名为[AutoTest.NET的 .NET 版本的 Autotest（](https://github.com/continuoustests/AutoTest.Net)[本线程前面提到过](https://stackoverflow.com/a/1016958/516740)） ，它已被分叉并更新为一个功能更全面的工具，称为[ContinuousTests](http://continuoustests.com/)。大约一年前我尝试过它，当时它看起来有很大的潜力，但不幸的是，听起来他们已经决定停止开发。然而，从好的方面来说，它现在是[免费](http://codebetter.com/gregyoung/2012/06/23/mighty-moose-free/)的！

我没有使用[过 NCrunch](http://www.ncrunch.net/)，但它是一个似乎正在积极开发的商业产品。

有一些[基于脚本的工具](http://timross.wordpress.com/2009/08/04/continuous-testing-in-net/)也可能符合您的要求

另请参阅此问题： [如何在 .NET 中进行持续测试？](https://stackoverflow.com/questions/3044141/how-do-i-do-continuous-testing-in-net)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T08:45:27.497

红宝石有[自动测试](http://www.zenspider.com/ZSS/Products/ZenTest/)。它在您编辑文件时不断运行单元测试，使用一些简单的约定将源文件映射到测试文件。还有一个插件，我已经看到它在 emacs 中以交互方式将测试代码着色为红色或绿色。我认为这种在代码编辑器本身中通过/失败的即时视觉反馈的想法很棒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T08:21:59.900

嗯，它本质上是测试驱动的开发，测试在你输入的时候连续运行？所以我不会说“编辑触发测试”是一种新的开发技术，而仅仅是你的 IDE 的一个特性。

关于这个功能的速度，我想这真的取决于你的项目有多复杂，你使用的是什么编译器和语言，以及你做了什么改变。如果您正在修改整个项目中使用的某些基础库，您的编译器将不得不重新编译大部分程序，以便能够使用您的代码在其他库中运行测试。

# javascript - 将 .NET 日期时间转换为 JSON

> ID：1016847
> 
> 赞同：244
> 
> 时间：2009-06-19T08:05:27.687
> 
> 标签：javascript, json, datetime

> **可能重复：**
> [如何格式化 JSON 日期？](https://stackoverflow.com/questions/206384/how-to-format-a-json-date)

我的网络服务将 DateTime 返回到 jQuery 调用。服务以这种格式返回数据：

```
/Date(1245398693390)/ 
```

如何将其转换为对 JavaScript 友好的日期？

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2009-06-19T08:29:02.023

返回的是自纪元以来的毫秒数。你可以这样做：

```
var d = new Date();
d.setTime(1245398693390);
document.write(d); 
```

有关如何完全按照您的需要格式化日期，请参阅[http://www.w3schools.com/jsref/jsref_obj_date.asp](http://www.w3schools.com/jsref/jsref_obj_date.asp)`Date`上的完整参考

您可以通过解析整数（[如此处建议](https://stackoverflow.com/a/2316066/88001)）来去除非数字：

```
var date = new Date(parseInt(jsonDate.substr(6))); 
```

或应用以下正则表达式（来自评论中的 Tominator）：

```
var jsonDate = jqueryCall();  // returns "/Date(1245398693390)/"; 
var re = /-?\d+/; 
var m = re.exec(jsonDate); 
var d = new Date(parseInt(m[0])); 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-06-19T08:21:01.010

我一直在使用这种方法一段时间：

```
using System;

public static class ExtensionMethods {
  // returns the number of milliseconds since Jan 1, 1970 (useful for converting C# dates to JS dates)
  public static double UnixTicks(this DateTime dt)
  {
    DateTime d1 = new DateTime(1970, 1, 1);
    DateTime d2 = dt.ToUniversalTime();
    TimeSpan ts = new TimeSpan(d2.Ticks - d1.Ticks);
    return ts.TotalMilliseconds;
  }
} 
```

假设您正在针对 .NET 3.5 进行开发，则它是直接复制/粘贴。您可以以其他方式移植它。

您可以将其封装在 JSON 对象中，或者直接将其写入响应流。

在 Javascript/JSON 方面，您只需将刻度传递给新的 Date 对象即可将其转换为日期：

```
jQuery.ajax({
  ...
  success: function(msg) {
    var d = new Date(msg);
  }
} 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2010-09-07T01:57:04.527

使用带有反向引用的 String.replace 解析日期字符串：

```
var milli = "/Date(1245398693390)/".replace(/\/Date\((-?\d+)\)\//, '$1');
var d = new Date(parseInt(milli)); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2010-07-23T16:33:46.377

如果您将`DateTime`.Net 代码中的 a 传递给 javascript 代码，C#：

```
DateTime net_datetime = DateTime.Now; 
```

javascript 将其视为字符串，例如`"/Date(1245398693390)/"`：

您可以将其转换为流动的：

```
// convert the string to date correctly
var d = eval(net_datetime.slice(1, -1)) 
```

或者：

```
// convert the string to date correctly
var d = eval("/Date(1245398693390)/".slice(1, -1)) 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2010-03-09T18:14:38.550

如果您在获取时间信息时遇到问题，可以尝试以下方法：

```
 d.date = d.date.replace('/Date(', '');
    d.date = d.date.replace(')/', '');  
    var expDate = new Date(parseInt(d.date)); 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2011-10-03T23:21:36.100

我认为从 1970,1,1 的转换需要双舍入到零小数位

```
DateTime d1 = new DateTime(1970, 1, 1);
DateTime d2 = dt.ToUniversalTime();
TimeSpan ts = new TimeSpan(d2.Ticks - d1.Ticks);
return Math.Round( ts.TotalMilliseconds,0); 
```

在我使用的客户端

```
new Date(+data.replace(/\D/g, '')); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-09-09T03:26:44.743

[http://stevenlevithan.com/assets/misc/date.format.js](http://stevenlevithan.com/assets/misc/date.format.js)

```
var date = eval(data.Data.Entity.Slrq.replace(/\/Date\((\d )\)\//gi, "new Date($1)"));  
alert(date.format("yyyy-MM-dd HH:mm:ss"));  
alert(dateFormat(date, "yyyy-MM-dd HH:mm:ss")); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-06-19T08:11:52.370

您可以尝试像[json.net](http://www.codeplex.com/Json)这样的 3rd 方库 项目站点上有文档。它确实说它需要.net 3.5。

否则还有另一个叫 Nii.json，我相信它是来自 java 的一个端口。我在[这个博客上找到了一个链接](http://www.amundsen.com/blog/archives/607)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-06-10T18:50:37.437

前面的答案都表明您可以执行以下操作：

```
var d = eval(net_datetime.slice(1, -1)); 
```

但是，这在 Chrome 或 FF 中都不起作用，因为从字面上评估的是：

```
// returns the current timestamp instead of the specified epoch timestamp
var d = Date([epoch timestamp]); 
```

正确的方法是：

```
var d = eval("new " + net_datetime.slice(1, -1)); // which parses to

var d = new Date([epoch timestamp]); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-12-07T02:36:07.547

以为我会添加我一直在使用的解决方案。

如果您使用的是，`System.Web.Script.Serialization.JavaScriptSerializer()`则返回的时间不会特定于您的时区。要解决此问题，您还需要将`dte.getTimezoneOffset()`其恢复到正确的时间。

```
String.prototype.toDateFromAspNet = function() {
    var dte = eval("new " + this.replace(/\//g, '') + ";");
    dte.setMinutes(dte.getMinutes() - dte.getTimezoneOffset());
    return dte;
} 
```

现在你只需打电话

```
"/Date(1245398693390)/".toDateFromAspNet(); 
```

> 2009 年 6 月 19 日星期五 00:04:53 GMT-0400（东部夏令时间）{}

# iphone - 从 iphone beta 升级到完整 3.0

> ID：1016853
> 
> 赞同：1
> 
> 时间：2009-06-19T08:07:14.173
> 
> 标签：iphone, upgrade, beta-testing

所以我一直在针对 iphone 3.0 beta 进行开发，并且刚刚升级到本周发布的最终版本。

但是在 iTunes 中，它说我目前使用的是最新版本。

任何 iphone 开发人员都知道如何升级到 3.0 的最终版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T09:16:07.373

我发现如果我恢复了 iTunes 下载并安装了最新的操作系统的 3.0GM 设备。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T11:18:46.970

获取 nevan 指向的文件 - [http://appldnld.apple.com.edgesuite.net/content.info.apple.com/iPhone/061-6578.20090617.VfgtU/iPhone1,2_3.0_7A341_Restore.ipsw](http://appldnld.apple.com.edgesuite.net/content.info.apple.com/iPhone/061-6578.20090617.VfgtU/iPhone1,2_3.0_7A341_Restore.ipsw)

将您的 iPhone 插入 iTunes，如果使用 Mac，请按住 Option 键，然后单击 iTunes 中的恢复按钮。如果您使用的是 Windows，我相信它是 ALT 按钮。从这里您将获得一个文件对话框，您可以在其中指向 IPSW 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T08:27:42.447

我上周下载了 GM 种子，这应该是最新版本 - 但像你一样，我找不到 3.0 的任何图像。由于 iTunes 认为该版本是最新的，我认为可以假设 GM 种子版本是最新的。

让我有点担心的是，您在使用 beta 版本时会从 iTunes 得到相同的答案——也许我的假设是不正确的。

我想我们会在某个时候获得软件映像——当然，我们还需要可用的 2.x 映像，以便我们可以恢复到这些配置。

更新：我确认 GM 与最终版本相同的内部版本号等 (7A341) - 如果你没有得到，你将不得不从 iTunes 获取更新。如果您有 iPod，那么您将不得不支付更新费用或等待图像添加到开发站点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T09:10:54.637

这是新的 3.0 ipsw 的直接下载链接：

[http://appldnld.apple.com.edgesuite.net/content.info.apple.com/iPhone/061-6578.20090617.VfgtU/iPhone1,2_3.0_7A341_Restore.ipsw](http://appldnld.apple.com.edgesuite.net/content.info.apple.com/iPhone/061-6578.20090617.VfgtU/iPhone1,2_3.0_7A341_Restore.ipsw)

注意最后的 7A341。它与您在“设置”->“常规”->“关于”中看到的版本号相同

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T13:41:08.053

3.0GM 版本与通过 iTunes 发布的版本完全相同 - 没有区别，甚至版本号都相同（3.0GM 在设置 > 常规 > 关于中显示 7A341，3.0 官方也显示 7A341）。

# wcf - 添加 Web 服务引用后，我需要签入哪些文件？

> ID：1016861
> 
> 赞同：5
> 
> 时间：2009-06-19T08:11:32.433
> 
> 标签：wcf, web-services, version-control

我有一个（新）项目，它有一个 Web 服务参考。它具有以下结构：

```
<Folder: project folder>
    <File: source file 1>
    <File: source file 2>
    <File: source file .>
    Folder: Web References
        Folder: MyService
            File: Reference.map
            File: Reference.cs
            File: MyService.xsd
            File: MyService0.xsd
            File: MyService.wsdl
            File: MyService0.wsdl
            File: MyService0.disco 
```

我即将将源代码签入版本控制系统。我必须签入哪些文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T20:47:47.533

只是为了添加不同的意见，以防有人与我的情况相似。

我在一个项目中积极开发了一个 Web 服务 API，我们使用 Perforce 作为我们的源代码控制。这在更新服务引用时导致了许多问题，我们每天都会这样做很多次。我们通过仅签入两个文件来简化此过程：

```
Reference.cs 
```

因为它包含所有生成的编译代码，并且：

```
Reference.svcmap 
```

因为它包含代码生成的配置，例如用于刷新引用的端点、要使用的集合类型等。

据我所知，所有其他文件只是代码生成期间创建的工件，对可执行代码没有影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T08:13:55.437

他们都是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-01T08:10:53.750

在 TFS 中，我们只签入以下 2 个文件：

*   服务 .wsdl 文件
*   Reference.cs 文件

# wpf - WPF 可以直接打印 PDF 和 Office 文件吗？

> ID：1016873
> 
> 赞同：2
> 
> 时间：2009-06-19T08:13:55.673
> 
> 标签：wpf, pdf, printing, ms-office

如何允许 WPF 应用程序的用户打印**PDF、Word、Excel 和 Powerpoint**文件而不打开它们，即显示所有可用文件的组合框，用户单击一个，打印对话框打开，用户单击确定并打印到他的想要的打印机？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T08:27:54.100

只是一个猜测：使用带有动词“print”的 ShellExecute(Ex)。我不知道 System.Diagnostics.Process 是否支持指定动词，但您可以将原始函数导入 .NET 应用程序。这取决于用户安装了适当的应用程序，但是，如果您不想打开文件，则必须由其他人打开。

我猜你不想要通过办公自动化的路线，是吗？在这种情况下，一旦你了解了它的工作原理并了解了它的怪癖，你就有了一种更强大的方法来做应用程序支持的任何事情。

# unit-testing - .NET Framework 3.5 的单元测试框架是什么？

> ID：1016877
> 
> 赞同：1
> 
> 时间：2009-06-19T08:16:56.947
> 
> 标签：unit-testing, .net-3.5, frameworks, nunit

我在 .NET Framework 3.5 中有一个项目，我可以看到 nUNIT 还不支持它。你会推荐什么单元测试框架来满足我的需求？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T08:26:39.313

NUnit 在 .NET 3.5 中运行良好 - 自 VS2008 测试版以来，我一直在使用它（使用 ReSharper 运行测试）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-20T20:16:14.780

.NET 3.5 的其他一些单元测试工具是：

*   MS Test - Visual Studio 中的内置单元测试框架。它并不像它的声誉那么糟糕。
*   [xUnit.NET](http://www.codeplex.com/xunit)，它有一个非常好的 API。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T08:20:04.693

我一直在尝试[Gallio](http://www.gallio.org/)，它似乎工作得很好。它也与 ReSharper 的单元测试运行器配合得很好。

[编辑]

只是想我会提到 Gallio 是 MbUnit 的下一个进化步骤，所以它不是一个全新的东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-13T13:30:01.223

我也遇到了这个问题，并且能够在 NUnit 2.5 中解决它。

在 NUnit GUI 中，在 Tools > Settings... 下打开 Visual Studio 支持。

现在选择 File > Open Project... 将文件过滤器从“Projects & Assemblies”更改为“Solutions”，然后加载您的解决方案文件。您应该能够运行所有测试。

现在选择 File > Save As... 并将当前设置保存为 NUnit 项目。您现在可以进入 Project > Edit... 并删除非测试程序集或进行您需要的任何其他更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T06:22:19.140

正如乔恩所说，NUnit 在 3.5 中运行良好。

您需要记住以下几点：

1.  当您升级到更高版本的框架时，有一些（非常少的）模糊的重大更改，通常是由于使用了已弃用的 API 或非标准方法。以我的经验，一旦你发现它的来源，修复这些重大变化通常是相当简单的。

2.  如果您在 NUnit 中遇到特定错误，请将其隔离在一个小型测试套件中。在寻找错误时，我通常认为是我的错，而且我通常是对的。

3.  nunit 的源代码在那里，您可以编译和调试问题。一般来说，测试框架相当直接且易于遵循。

4.  还有很多其他的单元测试框架。更自以为是的[XUnit](http://www.codeplex.com/xunit)框架越来越受欢迎。就个人而言，我喜欢[流利的断言](http://iridescence.no/post/Fluent-Ubiquitous-Assertions-with-xUnit.aspx)，但它是个人品味的事情，也可以通过 NUnit 来实现。

5.  您总是可以使用 VS 附带的 Microsoft 内置单元测试框架。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-04T15:38:13.387

就个人而言，我使用 MSTest，因为它内置在 Visual Studio 中。它只是让它变得容易，因为您无需安装任何东西即可使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-04T15:35:30.240

我得到相同的空引用错误，全新的 3.5 项目带有一个简单的 Assert.IsTrue(true)....当我尝试将程序集添加到 guirunner 中的 NUnit 项目时，我得到：

System.NullReferenceException... 在 NUnit.Util.TestLoader.ReloadTest（RuntimeFramework 框架）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-30T07:13:27.193

在 .net framework 3.5 中构建 dll 后，如果我们在 NUnit 中使用它，它可以正常工作，但如果要将 NUnit 与 Visual Studio IDE 集成，则需要更改配置文件才能执行。但我不知道该怎么做

# iphone - 将 iPhone 应用程序从 2.2 移动到 3.0 模拟器时的 EXC_BAD_ACCESS

> ID：1016880
> 
> 赞同：0
> 
> 时间：2009-06-19T08:17:29.800
> 
> 标签：iphone, iphone-sdk-3.0, ios-simulator

好吧，我有一个在 iPhone SDK 2.2 中开发的应用程序，我最近在 3.0 模拟器中构建并启动了它。基本 SDK 仍设置为 2.2。我认为这样可以避免问题。相反，我得到

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x00000000a1b1c1f3
Crashed Thread:  0

Thread 0 Crashed:
0   libobjc.A.dylib                 0x92f4b688 objc_msgSend + 24
1   Foundation                      0x305085bd -[NSCFString isEqualToString:] + 61
2   HappyApp                        0x00002c27 -[CombinationsTableViewController loadData] + 220 (CombinationsTableViewController.m:64) 
```

崩溃发生在一条非常简单的线路上`total`，`UITextField`

```
if (![total.text isEqualToString:@""] ) { 
```

有没有人遇到过这个？我觉得这是一个线程争用问题，或者我的整个应用程序没有正确编译。它适用于 2.2.1 模拟器。如果事实证明这不是在 OS 3.0 中测试 2.2 应用程序的方法，那么除了切换该下拉框之外我应该做什么？

**更新**：Andrew Pouliot 是正确的，因为这是一个已发布的参考问题。调试器指向一条线，所以我得到了错误的提示。罪魁祸首实际上是第一行：

```
if(!([total.text isEqual:totalTextCache]
  && [divisions.text isEqual:divisionsTextCache])) {
  //Loads the data for the table only if the values were actually changed
  totalTextCache = total.text; //ditto for divisions
} 
```

这些行是 的唯一用途`totalTextCache`，如果`total.text`更改则无效。这从未在 2.2.1 sim 中引起问题，可能是因为旧`total.text`版本在更改值时从未被运行时释放。但是这段代码是错误的。我通过将其更改为完全按照我认为 isEqual 正在做的事情来修复它：

```
if(!(total.text==totalTextCache && divisions.text==divisionsTextCache)) 
```

因为我实际上并不想复制`NSString`s，而只是检查它们是否已更改（因此引用会更改，这是可行的。错误的代码在 2.2.1 运行时运行良好，因为旧的引用仍然可以它的哈希属性由 . 检查和比较`isEqual`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T08:36:21.570

当我安装我的 3.0 SDK 时，我的 2.0 工具消失了，所以不确定这是否适用，但我不认为模拟器构建旨在与未来的运行时兼容。

尽管问题可能出在您的代码中。如果是这样，我可以说你有内存管理问题而不是“线程争用”。一切都发生在 UIKit 的主线程上（不是线程安全的）。

检查您设置总变量的位置；当您使用此方法时，它可能已经发布。确保您的 retainCount 是合理的。

为 3.0 构建时是否有同样的错误？

# wpf - 文本框中的 WPF 命令参数

> ID：1016881
> 
> 赞同：10
> 
> 时间：2009-06-19T08:17:52.747
> 
> 标签：wpf, mvvm, textbox, command

我正在使用 MVVM 模式，并且我在父窗口中有一个文本框，并且想要将一些文本发送到将出现在 Textchanged 上的弹出窗口。

我尝试使用命令参数，但它不适合我。

请帮忙..

谢谢沙拉特

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-19T11:10:48.543

如果我希望在用户按下回车时执行命令，我喜欢使用它。注意 IsDefault 绑定的巧妙使用 :-)

```
<TextBox x:Name="inputBox"/>
<Button Command="{Binding CutCommand}" 
        CommandParameter="{Binding Text, ElementName=inputBox}" 
        Content="Cut" 
        IsDefault="{Binding IsFocused, ElementName=inputBox}" /> 
```

如果您不希望按钮可见，当然可以将其可见性设置为折叠。我认为如果你按回车它仍然会执行命令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-18T15:36:46.560

这段代码对我有用

```
<UserControl x:Class="Test"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             Height="Auto" Width="Auto">
  <UserControl.InputBindings>
    <KeyBinding Key="Enter" Command="{Binding ScanCommand}" CommandParameter="{Binding Text, ElementName=tbBarcode}"/>
  </UserControl.InputBindings>
  <Grid Name="LayoutRoot">
    <TextBox x:Name="tbBarcode" Height="23"/>
  </Grid>
</UserControl> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T08:43:34.410

你试过什么？这段代码对我有用：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Window.CommandBindings>
        <CommandBinding Command="Cut" Executed="CommandBinding_Executed" />
    </Window.CommandBindings>
    <StackPanel>
        <TextBox x:Name="textBox1" />
        <Button Command="Cut" 
                CommandParameter="{Binding Text,ElementName=textBox1}" 
                Content="Cut" />
    </StackPanel>
</Window> 
```

使用此事件处理程序：

```
private void CommandBinding_Executed(object sender, ExecutedRoutedEventArgs e)
{
    MessageBox.Show(e.Parameter.ToString());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-03-04T10:27:43.010

您可以在不声明任何名称的情况下执行此操作`TextBox`。

```
<TextBox>
    <TextBox.InputBindings>
        <KeyBinding Command="{Binding SomeCommand}"
                    CommandParameter="{Binding Text, RelativeSource={RelativeSource AncestorType={x:Type TextBox}}}"
                    Key="Return" />
    </TextBox.InputBindings>
</TextBox> 
```

# c - 无需复制的 Windows 环形缓冲区

> ID：1016888
> 
> 赞同：6
> 
> 时间：2009-06-19T08:21:05.547
> 
> 标签：c, windows, memory, circular-buffer

在[Ring Buffer 的 Wikipedia entry](http://en.wikipedia.org/wiki/Ring_buffer)中，有一个[示例代码显示了](http://en.wikipedia.org/wiki/Ring_buffer#Exemplary_POSIX_Implementation)[UNIX](http://en.wikipedia.org/wiki/UNIX)系统的一个 hack，其中一块内存的相邻虚拟内存被[映射](http://en.wikipedia.org/wiki/Memory-mapped_file)到相同的物理内存，从而实现了一个不需要任何[memcpy](http://en.wikipedia.org/wiki/Memcpy#Functions)等的环形缓冲区。我想知道如果有办法在[Windows](http://en.wikipedia.org/wiki/Windows)中进行类似的操作？

谢谢，弗雷泽

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T08:53:50.863

我并没有真正遵循维基百科中示例的所有细节。考虑到这一点，您可以使用[CreateFileMapping](http://msdn.microsoft.com/en-us/library/aa366537(VS.85).aspx)和[MapViewOfFile](http://msdn.microsoft.com/en-us/library/aa366761(VS.85).aspx)在 Windows 中映射内存，但是 MapViewOfFile 不允许您为映射指定基地址。[MapViewOfFileEx](http://msdn.microsoft.com/en-us/library/aa366763(VS.85).aspx)可用于指定基地址，因此也许您可以使用类似的技术。

我无法判断这是否真的有效：

```
// determine valid buffer size
SYSTEM_INFO info;
GetSystemInfo(&info);

// note that the base address must be a multiple of the allocation granularity
DWORD bufferSize=info.dwAllocationGranularity;

HANDLE hMapFile = CreateFileMapping(
             INVALID_HANDLE_VALUE,
             NULL,
             PAGE_READWRITE,
             0,
             bufferSize*2,
             L"Mapping");

BYTE *pBuf = (BYTE*)MapViewOfFile(hMapFile,
                    FILE_MAP_ALL_ACCESS,
                    0,                   
                    0,                   
                    bufferSize);
MapViewOfFileEx(hMapFile,
                    FILE_MAP_ALL_ACCESS,
                    0,                   
                    0,                   
                    bufferSize,
                    pBuf+bufferSize); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-19T07:38:41.277

哎呀，这是最近很让我担心的话题。我需要在 Windows 上进行 posix 优化的环形缓冲区，主要是因为它的随机访问接口，但从来不知道如何实现它。现在，@1800 INFORMATION 提出的代码有时有效，有时无效，但无论如何这个想法很棒。

问题是，`MapViewOfFileEx`有时会因 ERROR_INVALID_ADDRESS 而失败，这意味着它无法将视图映射到`pBuf+bufferSize`. 这是因为被`MapViewOfFile`调用的 before 选择了一个`bufferSize`长度为（从 开始`pBuf`）的空闲地址空间，但它不保证这个地址空间很`bufferSize*2`长。为什么我们需要`bufferSize*2`虚拟内存？因为我们的环形缓冲区需要换行。这就是第二个映射视图的用途。当读或写指针离开第一个视图时，它进入第二个视图（因为它们在内存中是连续的），但实际上它从相同的映射开始。

```
UINT_PTR addr;
HANDLE hMapFile;
LPVOID address, address2;

hMapFile = CreateFileMapping (    // create a mapping backed by a pagefile
    INVALID_HANDLE_VALUE,
    NULL,
    PAGE_EXECUTE_READWRITE,
    0,
    bufferSize*2,
    "Local\\mapping" );
if(hMapFile == NULL) 
    FAIL(CreateFileMapping);

address = MapViewOfFile (    // find a free bufferSize*2 address space
    hMapFile,
    FILE_MAP_ALL_ACCESS,
    0,                   
    0,                   
    bufferSize*2 );
if(address==NULL) 
    FAIL(MapViewOfFile);
UnmapViewOfFile(address);
// found it. hopefully it'll remain free while we map to it

addr = ((UINT_PTR)address);
address = MapViewOfFileEx (
    hMapFile,
    FILE_MAP_ALL_ACCESS,
    0,                   
    0,                   
    bufferSize, 
    (LPVOID)addr );

addr = ((UINT_PTR)address) + bufferSize;        
address2 = MapViewOfFileEx (
    hMapFile,
    FILE_MAP_ALL_ACCESS,
    0,                   
    0,                   
    bufferSize,
    (LPVOID)addr);  

if(address2==NULL)      
    FAIL(MapViewOfFileEx);

// when you're done with your ring buffer, call UnmapViewOfFile for 
// address and address2 and CloseHandle(hMapFile) 
```

# flash - Flash 游戏适用于某些计算机，但不适用于其他计算机

> ID：1016892
> 
> 赞同：0
> 
> 时间：2009-06-19T08:22:11.427
> 
> 标签：flash, actionscript-3, flash-cs4, flash-cs3

我有一个非常奇怪的问题，只是无法解决，想知道这里是否有人知道解决方案。

我面临的问题如下。

我们有一个 Flash 游戏，它可以在办公室的电脑上运行（flash player 10 和 flash player 9.0.159）

但是，当我们尝试在其中一台笔记本电脑上运行它时，它会失败，并且不会加载我们尝试加载的内容（但是相同的版本可以在其他计算机上运行）。笔记本电脑上的版本是 flash player 9.0.159

这是一个主要问题，因为我们拥有的一些客户也经历过同样的事情。但我完全被难住了，有人有什么想法吗？

干杯马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T16:54:38.817

只是为了让大家知道。我发现问题是因为在拆分加载后我正在读取的 xml 文件太大（20000 行）它工作正常。

因此，在闪存中执行脚本的 15 秒时间限制之前，在较慢的 PC 上读取文件之前

感谢人们提供的所有帮助。问候马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T14:22:12.620

您是否在单个帧内进行可能超时的大型渲染或处理？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T08:34:26.317

防火墙，网络问题？也许您的办公室比客户/远程用户获得的某些所需资源的访问权限更高？提供详细信息。

# android - 如何在Android中将屏幕尺寸作为像素获取

> ID：1016896
> 
> 赞同：1925
> 
> 时间：2009-06-19T08:25:57.347
> 
> 标签：android, layout, screen, pixel, dimensions

我创建了一些自定义元素，我想以编程方式将它们放置在右上角（`n`来自顶部边缘的`m`像素和来自右边缘的像素）。因此我需要获取屏幕宽度和屏幕高度，然后设置位置：

```
int px = screenWidth - m;
int py = screenHeight - n; 
```

我如何在主要活动中获得`screenWidth`和？`screenHeight`

* * *

## 回答 #1

> 赞同：3547
> 
> 时间：2009-06-19T08:41:04.510

如果您想要以像素为单位的显示尺寸，您可以使用[`getSize`](http://developer.android.com/reference/android/view/Display.html#getSize%28android.graphics.Point%29)：

```
Display display = getWindowManager().getDefaultDisplay();
Point size = new Point();
display.getSize(size);
int width = size.x;
int height = size.y; 
```

如果您不在，您可以通过以下`Activity`方式获得默认值：`Display``WINDOW_SERVICE`

```
WindowManager wm = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
Display display = wm.getDefaultDisplay(); 
```

如果您在片段中并且想要完成此操作，只需使用 Activity.WindowManager（在 Xamarin.Android 中）或 getActivity().getWindowManager()（在 java 中）。

在`getSize`引入之前（在 API 级别 13 中），您可以使用现在已弃用的`getWidth`和方法：`getHeight`

```
Display display = getWindowManager().getDefaultDisplay(); 
int width = display.getWidth();  // deprecated
int height = display.getHeight();  // deprecated 
```

但是，对于您所描述的用例，布局中的边距/填充似乎更合适。

另一种方式是：[DisplayMetrics](http://developer.android.com/reference/android/util/DisplayMetrics.html)

> 描述有关显示的一般信息的结构，例如其大小、密度和字体缩放。要访问 DisplayMetrics 成员，请像这样初始化一个对象：

```
DisplayMetrics metrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(metrics); 
```

我们可以`widthPixels`用来获取以下信息：

> “显示的绝对宽度，以像素为单位。”

**例子：**

```
Log.d("ApplicationTagName", "Display width in px is " + metrics.widthPixels); 
```

**API 级别 30 更新**

```
final WindowMetrics metrics = windowManager.getCurrentWindowMetrics();
 // Gets all excluding insets
 final WindowInsets windowInsets = metrics.getWindowInsets();
 Insets insets = windowInsets.getInsetsIgnoreVisibility(WindowInsets.Type.navigationBars()
         | WindowInsets.Type.displayCutout());

 int insetsWidth = insets.right + insets.left;
 int insetsHeight = insets.top + insets.bottom;

 // Legacy size that Display#getSize reports
 final Rect bounds = metrics.getBounds();
 final Size legacySize = new Size(bounds.width() - insetsWidth,
         bounds.height() - insetsHeight); 
```

* * *

## 回答 #2

> 赞同：387
> 
> 时间：2011-01-31T02:01:11.193

一种方法是：

```
Display display = getWindowManager().getDefaultDisplay(); 
int width = display.getWidth();
int height = display.getHeight(); 
```

它已被弃用，您应该尝试以下代码。前两行代码为您提供了`DisplayMetrics`对象。此对象包含 , 等`heightPixels`字段`widthPixels`。

```
DisplayMetrics metrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(metrics);

int height = metrics.heightPixels;
int width = metrics.widthPixels; 
```

**API 30 级更新**

```
final WindowMetrics metrics = windowManager.getCurrentWindowMetrics();
 // Gets all excluding insets
 final WindowInsets windowInsets = metrics.getWindowInsets();
 Insets insets = windowInsets.getInsetsIgnoreVisibility(WindowInsets.Type.navigationBars()
         | WindowInsets.Type.displayCutout());

 int insetsWidth = insets.right + insets.left;
 int insetsHeight = insets.top + insets.bottom;

 // Legacy size that Display#getSize reports
 final Rect bounds = metrics.getBounds();
 final Size legacySize = new Size(bounds.width() - insetsWidth,
         bounds.height() - insetsHeight); 
```

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2011-04-06T21:23:00.800

它可能无法回答您的问题，但如果您需要 View 的尺寸但您的代码在其布局尚未布局时正在执行，那么了解（当我遇到这个问题时我自己正在寻找它）可能会很有用（例如在 中`onCreate()`）您可以设置一个`ViewTreeObserver.OnGlobalLayoutListener`with`View.getViewTreeObserver().addOnGlobalLayoutListener()`并将需要视图尺寸的相关代码放在那里。布局布局后，将调用侦听器的回调。

* * *

## 回答 #4

> 赞同：111
> 
> 时间：2012-07-24T03:14:27.097

（2012 回答，可能已过时）如果您想支持 pre Honeycomb，则需要在 API 13 之前提供向后兼容性。例如：

```
int measuredWidth = 0;
int measuredHeight = 0;
WindowManager w = getWindowManager();

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB_MR2) {
    Point size = new Point();
    w.getDefaultDisplay().getSize(size);
    measuredWidth = size.x;
    measuredHeight = size.y;
} else {
    Display d = w.getDefaultDisplay();
    measuredWidth = d.getWidth();
    measuredHeight = d.getHeight();
} 
```

当然，不推荐使用的方法最终会从最新的 SDK 中删除，但是虽然我们仍然依赖于大多数用户拥有 Android 2.1、2.2 和 2.3，但这就是我们剩下的。

* * *

## 回答 #5

> 赞同：75
> 
> 时间：2013-03-29T08:15:43.890

我尝试了所有可能的“解决方案”均未成功，我注意到 Elliott Hughes 的“Dalvik Explorer”应用程序始终在任何 Android 设备/操作系统版本上显示正确的尺寸。我最终查看了他的开源项目，可以在这里找到：[https ://code.google.com/p/enh/](https://code.google.com/p/enh/)

以下是所有相关代码：

```
WindowManager w = activity.getWindowManager();
Display d = w.getDefaultDisplay();
DisplayMetrics metrics = new DisplayMetrics();
d.getMetrics(metrics);
// since SDK_INT = 1;
widthPixels = metrics.widthPixels;
heightPixels = metrics.heightPixels;
try {
    // used when 17 > SDK_INT >= 14; includes window decorations (statusbar bar/menu bar)
    widthPixels = (Integer) Display.class.getMethod("getRawWidth").invoke(d);
    heightPixels = (Integer) Display.class.getMethod("getRawHeight").invoke(d);
} catch (Exception ignored) {
}
try {
    // used when SDK_INT >= 17; includes window decorations (statusbar bar/menu bar)
    Point realSize = new Point();
    Display.class.getMethod("getRealSize", Point.class).invoke(d, realSize);
    widthPixels = realSize.x;
    heightPixels = realSize.y;
} catch (Exception ignored) {
} 
```

编辑：略微改进的版本（避免在不支持的操作系统版本上触发异常）：

```
WindowManager w = activity.getWindowManager();
Display d = w.getDefaultDisplay();
DisplayMetrics metrics = new DisplayMetrics();
d.getMetrics(metrics);
// since SDK_INT = 1;
widthPixels = metrics.widthPixels;
heightPixels = metrics.heightPixels;
// includes window decorations (statusbar bar/menu bar)
if (Build.VERSION.SDK_INT >= 14 && Build.VERSION.SDK_INT < 17)
try {
    widthPixels = (Integer) Display.class.getMethod("getRawWidth").invoke(d);
    heightPixels = (Integer) Display.class.getMethod("getRawHeight").invoke(d);
} catch (Exception ignored) {
}
// includes window decorations (statusbar bar/menu bar)
if (Build.VERSION.SDK_INT >= 17)
try {
    Point realSize = new Point();
    Display.class.getMethod("getRealSize", Point.class).invoke(d, realSize);
    widthPixels = realSize.x;
    heightPixels = realSize.y;
} catch (Exception ignored) {
} 
```

* * *

## 回答 #6

> 赞同：52
> 
> 时间：2014-11-26T10:47:10.837

最简单的方法：

```
 int screenHeight = getResources().getDisplayMetrics().heightPixels;
 int screenWidth = getResources().getDisplayMetrics().widthPixels; 
```

* * *

## 回答 #7

> 赞同：48
> 
> 时间：2013-08-27T13:12:30.370

为了访问 Android 设备的状态栏高度，我们更喜欢以编程方式获取它：

### 示例代码

```
int resId = getResources().getIdentifier("status_bar_height", "dimen", "android");
if (resId > 0) {
    result = getResources().getDimensionPixelSize(resId);
} 
```

该变量`result`给出了像素的高度。

### 为了快速访问

![在此处输入图像描述](../Images/d8ec94fe00c6eb54fcfe325da33a4c81.png)

有关高度的更多信息，`Title bar`请查看*[Android 设备屏幕尺寸](http://www.emirweb.com/ScreenDeviceStatistics.php)*。`Navigation bar``Content View`

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2009-06-19T08:38:30.083

首先获取视图（例如 by `findViewById()`），然后您可以在视图本身上使用[**getWidth() 。**](http://developer.android.com/reference/android/view/View.html#getWidth%28%29)

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2012-10-17T14:44:20.433

我有两个函数，一个用于发送上下文，另一个以像素为单位获取高度和宽度：

```
public static int getWidth(Context mContext){
    int width=0;
    WindowManager wm = (WindowManager) mContext.getSystemService(Context.WINDOW_SERVICE);
    Display display = wm.getDefaultDisplay();
    if(Build.VERSION.SDK_INT>12){
        Point size = new Point();
        display.getSize(size);
        width = size.x;
    }
    else{
        width = display.getWidth();  // Deprecated
    }
    return width;
} 
```

和

```
public static int getHeight(Context mContext){
    int height=0;
    WindowManager wm = (WindowManager) mContext.getSystemService(Context.WINDOW_SERVICE);
    Display display = wm.getDefaultDisplay();
    if(Build.VERSION.SDK_INT>12){
        Point size = new Point();
        display.getSize(size);
        height = size.y;
    }
    else{
        height = display.getHeight();  // Deprecated
    }
    return height;
} 
```

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2011-12-22T06:11:08.033

对于使用 XML 进行动态缩放，有一个名为“android:layout_weight”的属性

下面的示例根据 synic 在[此线程](https://stackoverflow.com/questions/2581481/assign-width-to-half-available-screen-width-declaratively)上的响应进行了修改，显示了一个占据 75% 屏幕（重量 = .25）的按钮和一个占据剩余 25% 屏幕（重量 = .75）的文本视图。

```
<LinearLayout android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">

    <Button android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight=".25"
        android:text="somebutton">

    <TextView android:layout_width="fill_parent"
        android:layout_height="Wrap_content"
        android:layout_weight=".75">
</LinearLayout> 
```

* * *

## 回答 #11

> 赞同：19
> 
> 时间：2012-12-27T14:31:01.057

这是我用于该任务的代码：

```
// `activity` is an instance of Activity class.
Display display = activity.getWindowManager().getDefaultDisplay();
Point screen = new Point();
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB_MR2) {
    display.getSize(screen);
} else {            
    screen.x = display.getWidth();
    screen.y = display.getHeight();
} 
```

看起来足够干净，但要注意弃用。

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2013-05-12T20:16:20.783

这不是更好的解决方案吗？[DisplayMetrics](http://developer.android.com/reference/android/util/DisplayMetrics.html)提供了您需要的一切，并且从 API 1 开始工作。

```
public void getScreenInfo(){
    DisplayMetrics metrics = new DisplayMetrics();
    getActivity().getWindowManager().getDefaultDisplay().getMetrics(metrics);

    heightPixels = metrics.heightPixels;
    widthPixels = metrics.widthPixels;
    density = metrics.density;
    densityDpi = metrics.densityDpi;
} 
```

[您还可以使用getRealMetrics](http://developer.android.com/reference/android/view/Display.html#getRealMetrics%28android.util.DisplayMetrics%29)获得实际显示（包括屏幕装饰，例如状态栏或软件导航栏），但这仅适用于 17+。

我错过了什么吗？

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2012-03-16T07:15:23.577

只是添加到弗朗切斯科的答案。如果您想找出窗口中的位置或屏幕中的位置，另一个更合适的观察者是 [ViewTreeObserver.OnPreDrawListener()](http://developer.android.com/reference/android/view/ViewTreeObserver.OnPreDrawListener.html)

这也可用于查找在 onCreate() 时大部分未知的视图的其他属性，例如滚动位置、缩放位置。

* * *

## 回答 #14

> 赞同：17
> 
> 时间：2012-03-19T14:58:56.330

在活动中使用以下代码。

```
DisplayMetrics metrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(metrics);
int height = metrics.heightPixels;
int wwidth = metrics.widthPixels; 
```

* * *

## 回答 #15

> 赞同：17
> 
> 时间：2012-06-18T04:42:48.230

查找屏幕的宽度和高度：

```
width = getWindowManager().getDefaultDisplay().getWidth();
height = getWindowManager().getDefaultDisplay().getHeight(); 
```

使用它，我们可以获得最新及以上的 SDK 13。

```
// New width and height
int version = android.os.Build.VERSION.SDK_INT;
Log.i("", " name == "+ version);
Display display = getWindowManager().getDefaultDisplay();
int width;
if (version >= 13) {
    Point size = new Point();
    display.getSize(size);
    width = size.x;
    Log.i("width", "if =>" +width);
}
else {
    width = display.getWidth();
    Log.i("width", "else =>" +width);
} 
```

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2013-12-18T10:30:33.183

```
DisplayMetrics dimension = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(dimension);
int w = dimension.widthPixels;
int h = dimension.heightPixels; 
```

* * *

## 回答 #17

> 赞同：14
> 
> 时间：2012-01-06T19:35:27.923

我发现这可以解决问题。

```
Rect dim = new Rect();
getWindowVisibleDisplayFrame(dim); 
```

* * *

## 回答 #18

> 赞同：14
> 
> 时间：2012-06-27T12:18:12.173

```
public class AndroidScreenActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        DisplayMetrics dm = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics(dm);
        String str_ScreenSize = "The Android Screen is: "
                                   + dm.widthPixels
                                   + " x "
                                   + dm.heightPixels;

        TextView mScreenSize = (TextView) findViewById(R.id.strScreenSize);
        mScreenSize.setText(str_ScreenSize);
    }
} 
```

* * *

## 回答 #19

> 赞同：14
> 
> 时间：2013-03-16T02:21:42.937

需要说，如果您不在 中`Activity`，但在`View`（或在您的范围内有类型变量`View`），则不需要使用`WINDOW_SERVICE`. 那么你至少可以使用两种方式。

第一的：

```
DisplayMetrics dm = yourView.getContext().getResources().getDisplayMetrics(); 
```

第二：

```
DisplayMetrics dm = new DisplayMetrics();
yourView.getDisplay().getMetrics(dm); 
```

我们在这里调用的所有这些方法都没有被弃用。

* * *

## 回答 #20

> 赞同：14
> 
> 时间：2017-09-04T11:21:01.153

要获取屏幕尺寸，请使用显示指标

```
DisplayMetrics displayMetrics = new DisplayMetrics();
if (context != null) 
      WindowManager windowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
      Display defaultDisplay = windowManager.getDefaultDisplay();
      defaultDisplay.getRealMetrics(displayMetrics);
    } 
```

以像素为单位获取高度和宽度

```
int width  =displayMetrics.widthPixels;
int height =displayMetrics.heightPixels; 
```

* * *

## 回答 #21

> 赞同：12
> 
> 时间：2013-08-16T21:44:02.923

这不是 OP 的答案，因为他想要以真实像素显示尺寸。[我想要“设备独立像素”中的尺寸，并从这里https://stackoverflow.com/a/17880012/253938](https://stackoverflow.com/a/17880012/253938)和这里[https://stackoverflow.com/a/6656774/253938](https://stackoverflow.com/a/6656774/253938)我想出了答案有了这个：

```
 DisplayMetrics displayMetrics = Resources.getSystem().getDisplayMetrics();
    int dpHeight = (int)(displayMetrics.heightPixels / displayMetrics.density + 0.5);
    int dpWidth = (int)(displayMetrics.widthPixels / displayMetrics.density + 0.5); 
```

* * *

## 回答 #22

> 赞同：11
> 
> 时间：2017-10-09T14:09:44.150

您可以使用以下方法获取**高度**大小：

```
getResources().getDisplayMetrics().heightPixels; 
```

和**宽度**大小使用

```
getResources().getDisplayMetrics().widthPixels; 
```

* * *

## 回答 #23

> 赞同：10
> 
> 时间：2012-12-19T14:39:49.120

使用 DisplayMetrics (API 1) 有一种不被弃用的方法，可以避免 try/catch 混乱：

```
 // initialize the DisplayMetrics object
 DisplayMetrics deviceDisplayMetrics = new DisplayMetrics();

 // populate the DisplayMetrics object with the display characteristics
 getWindowManager().getDefaultDisplay().getMetrics(deviceDisplayMetrics);

 // get the width and height
 screenWidth = deviceDisplayMetrics.widthPixels;
 screenHeight = deviceDisplayMetrics.heightPixels; 
```

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2013-04-21T13:42:35.050

我会像这样包装 getSize 代码：

```
@SuppressLint("NewApi")
public static Point getScreenSize(Activity a) {
    Point size = new Point();
    Display d = a.getWindowManager().getDefaultDisplay();
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        d.getSize(size);
    } else {
        size.x = d.getWidth();
        size.y = d.getHeight();
    }
    return size;
} 
```

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2013-09-09T09:02:51.107

对于谁正在搜索没有**状态栏**和**操作栏的***可用屏幕尺寸*（也感谢 Swapnil 的回答）：

 ****```
DisplayMetrics dm = getResources().getDisplayMetrics();
float screen_w = dm.widthPixels;
float screen_h = dm.heightPixels;

int resId = getResources().getIdentifier("status_bar_height", "dimen", "android");
if (resId > 0) {
    screen_h -= getResources().getDimensionPixelSize(resId);
}

TypedValue typedValue = new TypedValue();
if(getTheme().resolveAttribute(android.R.attr.actionBarSize, typedValue, true)){
    screen_h -= getResources().getDimensionPixelSize(typedValue.resourceId);
} 
```

* * *

## 回答 #26

> 赞同：8
> 
> 时间：2018-10-01T11:43:00.660

## 科特林

```
fun getScreenHeight(activity: Activity): Int {
    val metrics = DisplayMetrics()
    activity.windowManager.defaultDisplay.getMetrics(metrics)
    return metrics.heightPixels
}

fun getScreenWidth(activity: Activity): Int {
    val metrics = DisplayMetrics()
    activity.windowManager.defaultDisplay.getMetrics(metrics)
    return metrics.widthPixels
} 
```

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2012-12-17T11:22:09.263

首先加载 XML 文件，然后编写以下代码：

```
setContentView(R.layout.main);      
Display display = getWindowManager().getDefaultDisplay();
final int width = (display.getWidth());
final int height = (display.getHeight()); 
```

根据您的屏幕分辨率显示宽度和高度。

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2013-11-07T16:31:43.627

请遵循以下方法：

```
public static int getWidthScreen(Context context) {
    return getDisplayMetrics(context).widthPixels;
}

public static int getHeightScreen(Context context) {
    return getDisplayMetrics(context).heightPixels;
}

private static DisplayMetrics getDisplayMetrics(Context context) {
    DisplayMetrics displayMetrics = new DisplayMetrics();
    WindowManager wm = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
    wm.getDefaultDisplay().getMetrics(displayMetrics);
    return displayMetrics;
} 
```

* * *

## 回答 #29

> 赞同：6
> 
> 时间：2013-05-22T12:16:47.460

在活动的 onCreate 中，有时您需要知道布局可用空间的精确尺寸。经过一番思考，我想出了这种方法。

```
public class MainActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        startActivityForResult(new Intent(this, Measure.class), 1);
        // Return without setting the layout, that will be done in onActivityResult.
    }

    @Override
    protected void onActivityResult (int requestCode, int resultCode, Intent data) {
        // Probably can never happen, but just in case.
        if (resultCode == RESULT_CANCELED) {
            finish();
            return;
        }
        int width = data.getIntExtra("Width", -1);
        // Width is now set to the precise available width, and a layout can now be created.            ...
    }
}

public final class Measure extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
       // Create a LinearLayout with a MeasureFrameLayout in it.
        // Just putting a subclass of LinearLayout in works fine, but to future proof things, I do it this way.
        LinearLayout linearLayout = new LinearLayout(this);
        LinearLayout.LayoutParams matchParent = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.MATCH_PARENT);
        MeasureFrameLayout measureFrameLayout = new MeasureFrameLayout(this);
        measureFrameLayout.setLayoutParams(matchParent);
        linearLayout.addView(measureFrameLayout);
        this.addContentView(linearLayout, matchParent);
        // measureFrameLayout will now request this second activity to finish, sending back the width.
    }

    class MeasureFrameLayout extends FrameLayout {
        boolean finished = false;
        public MeasureFrameLayout(Context context) {
            super(context);
        }

        @SuppressLint("DrawAllocation")
        @Override
        protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
            super.onMeasure(widthMeasureSpec, heightMeasureSpec);
            if (finished) {
                return;
            }
            finished = true;
            // Send the width back as the result.
            Intent data = new Intent().putExtra("Width", MeasureSpec.getSize(widthMeasureSpec));
            Measure.this.setResult(Activity.RESULT_OK, data);
            // Tell this activity to finish, so the result is passed back.
            Measure.this.finish();
        }
    }
} 
```

如果出于某种原因您不想在 Android 清单中添加其他活动，您可以这样做：

```
public class MainActivity extends Activity {
    static Activity measuringActivity;

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        Bundle extras = getIntent().getExtras();
        if (extras == null) {
            extras = new Bundle();
        }
        int width = extras.getInt("Width", -2);
        if (width == -2) {
            // First time in, just start another copy of this activity.
            extras.putInt("Width", -1);
            startActivityForResult(new Intent(this, MainActivity.class).putExtras(extras), 1);
            // Return without setting the layout, that will be done in onActivityResult.
            return;
        }
        if (width == -1) {
            // Second time in, here is where the measurement takes place.
            // Create a LinearLayout with a MeasureFrameLayout in it.
            // Just putting a subclass of LinearLayout in works fine, but to future proof things, I do it this way.
            LinearLayout linearLayout = new LinearLayout(measuringActivity = this);
            LinearLayout.LayoutParams matchParent = new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
            MeasureFrameLayout measureFrameLayout = new MeasureFrameLayout(this);
            measureFrameLayout.setLayoutParams(matchParent);
            linearLayout.addView(measureFrameLayout);
            this.addContentView(linearLayout, matchParent);
            // measureFrameLayout will now request this second activity to finish, sending back the width.
        }
    }

    @Override
    protected void onActivityResult (int requestCode, int resultCode, Intent data) {
        // Probably can never happen, but just in case.
        if (resultCode == RESULT_CANCELED) {
            finish();
            return;
        }
        int width = data.getIntExtra("Width", -3);
        // Width is now set to the precise available width, and a layout can now be created. 
        ...
    }

class MeasureFrameLayout extends FrameLayout {
    boolean finished = false;
    public MeasureFrameLayout(Context context) {
        super(context);
    }

    @SuppressLint("DrawAllocation")
    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        if (finished) {
            return;
        }
        finished = true;
        // Send the width back as the result.
        Intent data = new Intent().putExtra("Width", MeasureSpec.getSize(widthMeasureSpec));
        MainActivity.measuringActivity.setResult(Activity.RESULT_OK, data);
        // Tell the (second) activity to finish.
        MainActivity.measuringActivity.finish();
    }
} 
```

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2013-06-26T18:35:05.657

如果您不想要 WindowManagers、Points 或 Displays 的开销，您可以获取 XML 中最顶层 View 项的 height 和 width 属性，前提是它的 height 和 width 设置为 match_parent。（只要您的布局占据整个屏幕，情况就是如此。）

例如，如果您的 XML 以这样的开头：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/entireLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" > 
```

然后`findViewById(R.id.entireLayout).getWidth()`将返回屏幕的宽度并`findViewById(R.id.entireLayout).getHeight()`返回屏幕的高度。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2013-11-02T19:55:00.290

我有一个以 LinearLayout 作为根视图的初始屏幕活动，其宽度和高度具有*match_parent*。这是该`onCreate()`活动的方法中的代码。我在应用程序的所有其他活动中使用这些措施。

```
int displayWidth = getRawDisplayWidthPreHoneycomb();
int rawDisplayHeight = getRawDisplayHeightPreHoneycomb();
int usableDisplayHeight = rawDisplayHeight - getStatusBarHeight();
pf.setScreenParameters(displayWidth, usableDisplayHeight);

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
    LinearLayout myView = (LinearLayout) findViewById(R.id.splash_view);
    myView.addOnLayoutChangeListener(new OnLayoutChangeListener() {
        @Override
        public void onLayoutChange(View v, int left, int top, int right, int bottom, int oldLeft, int oldTop, int oldRight, int oldBottom) {
            if (left == 0 && top == 0 && right == 0 && bottom == 0) {
                return;
            }
            int displayWidth = Math.min(right, bottom);
            int usableDisplayHeight = Math.max(right, bottom);
            pf.setScreenParameters(displayWidth, usableDisplayHeight);
        }
    });
} 
```

以下是您在上面看到的方法的实现：

```
private int getRawDisplayWidthPreHoneycomb() {
    WindowManager windowManager = getWindowManager();
    Display display = windowManager.getDefaultDisplay();
    DisplayMetrics displayMetrics = new DisplayMetrics();
    display.getMetrics(displayMetrics);

    int widthPixels = displayMetrics.widthPixels;
    int heightPixels = displayMetrics.heightPixels;

    return Math.min(widthPixels, heightPixels);
}

private int getRawDisplayHeightPreHoneycomb() {
    WindowManager w = getWindowManager();
    Display d = w.getDefaultDisplay();
    DisplayMetrics metrics = new DisplayMetrics();
    d.getMetrics(metrics);

    int widthPixels = metrics.widthPixels;
    int heightPixels = metrics.heightPixels;

    return Math.max(widthPixels, heightPixels);
}

public int getStatusBarHeight() {
    int statusBarHeight = 0;

    int resourceId = getResources().getIdentifier("status_bar_height", "dimen", "android");
    if (resourceId > 0) {
        statusBarHeight = getResources().getDimensionPixelSize(resourceId);
    }

    return statusBarHeight;
} 
```

这会导致所有 API 版本和不同类型的设备（手机和平板电脑）的可用显示的高度和宽度，不包括任何类型的栏（状态栏、导航栏）。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2017-07-29T07:07:10.447

如果 Display 类不起作用，则上述答案将不起作用，那么您可以通过以下方法获取宽度和高度。

```
private static final int WIDTH_INDEX = 0;
private static final int HEIGHT_INDEX = 1;

    public static int[] getScreenSize(Context context) {
        int[] widthHeight = new int[2];
        widthHeight[WIDTH_INDEX] = 0;
        widthHeight[HEIGHT_INDEX] = 0;

        try {
            WindowManager windowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
            Display display = windowManager.getDefaultDisplay();

            Point size = new Point();
            display.getSize(size);
            widthHeight[WIDTH_INDEX] = size.x;
            widthHeight[HEIGHT_INDEX] = size.y;

            if (!isScreenSizeRetrieved(widthHeight))
            {
                DisplayMetrics metrics = new DisplayMetrics();
                display.getMetrics(metrics);
                widthHeight[0] = metrics.widthPixels;
                widthHeight[1] = metrics.heightPixels;
            }

            // Last defense. Use deprecated API that was introduced in lower than API 13
            if (!isScreenSizeRetrieved(widthHeight)) {
                widthHeight[0] = display.getWidth(); // deprecated
                widthHeight[1] = display.getHeight(); // deprecated
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        return widthHeight;
    }

    private static boolean isScreenSizeRetrieved(int[] widthHeight) {
        return widthHeight[WIDTH_INDEX] != 0 && widthHeight[HEIGHT_INDEX] != 0;
    } 
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2020-07-10T14:39:24.207

上述代码已在 API 级别 30 中弃用。现在您可以使用以下代码

```
 val width = windowManager.currentWindowMetrics.bounds.width()
 val height = windowManager.currentWindowMetrics.bounds.height() 
```

此方法报告窗口大小包括所有系统栏区域，同时`Display#getSize(Point)`报告不包括导航栏和显示剪切区域的区域。`Display#getSize(Point)`可以使用以下方法获得报告的值：

```
 val metrics = windowManager.currentWindowMetrics
 // Gets all excluding insets
 val windowInsets = metrics.windowInsets
 var insets: Insets = windowInsets.getInsets(WindowInsets.Type.navigationBars())
 val cutout = windowInsets.displayCutout
 if (cutout != null) {
    val cutoutSafeInsets = Insets.of(cutout.safeInsetLeft, cutout.safeInsetTop, cutout.safeInsetRight, cutout.safeInsetBottom)
    insets = Insets.max(insets, cutoutSafeInsets)
 }

 val insetsWidth = insets.right + insets.left
 val insetsHeight = insets.top + insets.bottom

 // Legacy size that Display#getSize reports
 val legacySize =  Size(metrics.bounds.width() - insetsWidth, metrics.bounds.height() - insetsHeight) 
```

来源：[WindowManager#getCurrentWindowMetrics()](https://developer.android.com/reference/android/view/WindowMetrics#getBounds())

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2014-06-11T17:19:01.307

**简单的功能也兼容低版本。**

```
/**
 * @return screen size int[width, height]
 *
 * */
public int[] getScreenSize(){
    Point size = new Point();
    WindowManager w = getWindowManager();

    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB_MR2){
        w.getDefaultDisplay().getSize(size);
        return new int[]{size.x, size.y};
    }else{
        Display d = w.getDefaultDisplay();
        //noinspection deprecation
        return new int[]{d.getWidth(), d.getHeight()};
    }
} 
```

**要使用：**

```
int width = getScreenSize()[0];
int height = getScreenSize()[1]; 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2016-01-05T05:31:41.497

此函数返回以英寸为单位的近似屏幕尺寸。

```
public double getScreenSize()
{
        DisplayMetrics dm = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics(dm);
        int width=dm.widthPixels;
        int height=dm.heightPixels;
        int dens=dm.densityDpi;
        double wi=(double)width/(double)dens;
        double hi=(double)height/(double)dens;
        double x = Math.pow(wi,2);
        double y = Math.pow(hi,2);
        double screenInches = Math.sqrt(x+y);
        return screenInches;
} 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2017-10-14T20:13:45.903

这是对 Kotlin 实现中上述一些答案的简单改编。如上所述，它需要清单中的 windowsSoftInput="adjustResize" ：

```
class KeyboardWatcher(private val layoutRooView: View) {

    companion object {
        private const val MIN_KEYBOARD_HEIGHT = 200f
    }

    private val displayMetrics: DisplayMetrics = layoutRooView.resources.displayMetrics
    private var stateVisible = false

    var observer: ((Boolean) -> Unit)? = null

    init {
        layoutRooView.viewTreeObserver.addOnGlobalLayoutListener {
            val heightDiff = layoutRooView.rootView.height - layoutRooView.height
            if (!stateVisible && heightDiff > dpToPx(MIN_KEYBOARD_HEIGHT)) {
                stateVisible = true
                observer?.invoke(stateVisible)
            } else if(stateVisible) {
                stateVisible = false
                observer?.invoke(stateVisible)
            }
        }
    }

    private fun dpToPx(valueInDp: Float): Float {
        return TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, valueInDp, displayMetrics)
    }
} 
```

并使用：

```
val activityRootView = findViewById<ViewGroup>(R.id.activityRoot)
KeyboardWatcher(activityRootView).observer = { visible ->
    if (visible) do something here ...
} 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2020-02-22T05:34:24.287

创建**Kotlin 扩展**函数来获取屏幕宽度和高度 -

```
fun Context?.screenWidthInPx(): Int {
    if (this == null) return 0
    val dm = DisplayMetrics()
    val wm = this.getSystemService(Context.WINDOW_SERVICE) as WindowManager
    wm.defaultDisplay.getMetrics(dm)
    return dm.widthPixels
}
//comment
fun Context?.screenHeightInPx(): Int {
    if (this == null) return 0
    val dm = DisplayMetrics()
    val wm = this.getSystemService(Context.WINDOW_SERVICE) as WindowManager
    wm.defaultDisplay.getMetrics(dm)
    return dm.heightPixels
} 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2020-11-23T16:53:17.627

现在在**Api 30 级别上**，应该这样做

```
final WindowMetrics metrics = windowManager.getCurrentWindowMetrics();
 // Gets all excluding insets
 final WindowInsets windowInsets = metrics.getWindowInsets();
 Insets insets = windowInsets.getInsetsIgnoreVisibility(WindowInsets.Type.navigationBars()
         | WindowInsets.Type.displayCutout());

 int insetsWidth = insets.right + insets.left;
 int insetsHeight = insets.top + insets.bottom;

 // Legacy size that Display#getSize reports
 final Rect bounds = metrics.getBounds();
 final Size legacySize = new Size(bounds.width() - insetsWidth,
         bounds.height() - insetsHeight); 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2021-10-24T22:17:40.583

以下是 API 30 以下/以上代码的 Kotlin 扩展函数：

```
fun Activity.getScreenWidth(): Int {
    return if (Build.VERSION.SDK_INT < 30) {
        val displayMetrics = DisplayMetrics()
        windowManager.defaultDisplay.getMetrics(displayMetrics)
        displayMetrics.widthPixels
    } else {
        val metrics = windowManager.currentWindowMetrics
        val insets = metrics.windowInsets
            .getInsetsIgnoringVisibility(WindowInsets.Type.systemBars())
        metrics.bounds.width() - insets.left - insets.right
    }
}

fun Activity.getScreenHeight(): Int {
    return if (Build.VERSION.SDK_INT < 30) {
        val displayMetrics = DisplayMetrics()
        windowManager.defaultDisplay.getMetrics(displayMetrics)
        displayMetrics.heightPixels
    } else {
        val metrics = windowManager.currentWindowMetrics
        val insets = metrics.windowInsets
            .getInsetsIgnoringVisibility(WindowInsets.Type.systemBars())
        metrics.bounds.height() - insets.top - insets.bottom
    }
} 
```

对应的 Java 辅助方法：

```
public int getScreenWidth(Activity activity) {
    if (Build.VERSION.SDK_INT < 30) {
        DisplayMetrics displayMetrics = new DisplayMetrics();
        activity.getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
        return displayMetrics.widthPixels;
    } else {
        WindowMetrics metrics = activity.getWindowManager().getCurrentWindowMetrics();
        Insets insets = metrics.getWindowInsets()
                .getInsetsIgnoringVisibility(WindowInsets.Type.systemBars());
        return metrics.getBounds().width() - insets.left - insets.right;
    }
}

public int getScreenHeight(Activity activity) {
    if (Build.VERSION.SDK_INT < 30) {
        DisplayMetrics displayMetrics = new DisplayMetrics();
        activity.getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
        return displayMetrics.heightPixels;
    } else {
        WindowMetrics metrics = activity.getWindowManager().getCurrentWindowMetrics();
        Insets insets = metrics.getWindowInsets()
                .getInsetsIgnoringVisibility(WindowInsets.Type.systemBars());
        return metrics.getBounds().height() - insets.bottom - insets.top;
    }
} 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2014-09-02T10:48:08.300

```
DisplayMetrics dm = getResources().getDisplayMetrics();
float fwidth = dm.density * dm.widthPixels;
float fheight = dm.density * dm.heightPixels; 
```

如果`getSize`由于您的 minSDKVersion 导致您出错并且您不想使用已弃用的方法 ( `getWidth`& `getHeight`)，则该`getMetrics`解决方案最初由 Balaji.K 于 2011 年发布...并且 Nik 添加了一条评论，解释`getDisplayMetrics`还考虑了状态栏的大小。

其他一些评论指的是乘以比例（**密度**）以获得尺寸的精确浮点值。在 Android v2.2 (API 8) 和 v4.0 中测试，结果良好，**没有错误/警告**。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2018-07-19T07:44:37.393

我使用了上述建议并为我们的问题创建了一个 kotlin 版本。希望这能为那些使用 kotlin 的人提供一些额外的帮助：

```
private val screenDimensions: Int by lazy {
    val display = (context.getSystemService(Context.WINDOW_SERVICE) as WindowManager).defaultDisplay
    Point()
        .also { size ->
            when {
                Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR1 -> display.getRealSize(size)
                else -> display.getSize(size)
            }
        }
}

screenDimensions.x // width
screenDimensions.y // height 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2019-02-27T08:35:08.400

我觉得最简单

```
private fun checkDisplayResolution() {
    val displayMetrics = DisplayMetrics().also {
        windowManager.defaultDisplay.getMetrics(it)
    }

    Log.i(TAG, "display width: ${displayMetrics.widthPixels}")
    Log.i(TAG, "display height: ${displayMetrics.heightPixels}")
    Log.i(TAG, "display width dpi: ${displayMetrics.xdpi}")
    Log.i(TAG, "display height dpi: ${displayMetrics.ydpi}")
    Log.i(TAG, "display density: ${displayMetrics.density}")
    Log.i(TAG, "display scaled density: ${displayMetrics.scaledDensity}")
} 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2020-12-01T09:57:25.350

## •`Kotlin Version`通过`Extension Property`

在 android 中有多种实现屏幕尺寸的方法，但我认为最好的解决方案可能是独立于`Context`实例，因此您可以在代码中的任何地方使用它。在这里，我通过 kotlin 扩展属性提供了一个解决方案，它可以轻松了解以像素为单位的屏幕大小以及`dp`：

### [DimensionUtils.kt](https://github.com/aminography/CommonUtils/blob/master/library/src/main/java/com/aminography/commonutils/DimensionUtils.kt)

```
import android.content.res.Resources
import android.graphics.Rect
import android.graphics.RectF
import android.util.DisplayMetrics
import kotlin.math.roundToInt

/**
 * @author aminography
 */

private val displayMetrics: DisplayMetrics by lazy { Resources.getSystem().displayMetrics }

val screenRectPx: Rect
    get() = displayMetrics.run { Rect(0, 0, widthPixels, heightPixels) }

val screenRectDp: RectF
    get() = displayMetrics.run { RectF(0f, 0f, widthPixels.px2dp, heightPixels.px2dp) }

val Number.px2dp: Float
    get() = this.toFloat() / displayMetrics.density

val Number.dp2px: Int
    get() = (this.toFloat() * displayMetrics.density).roundToInt() 
```

### 用法：

```
class MainActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        val widthPx = screenRectPx.width()
        val heightPx = screenRectPx.height()
        println("[PX] screen width: $widthPx , height: $heightPx")

        val widthDp = screenRectDp.width()
        val heightDp = screenRectDp.height()
        println("[DP] screen width: $widthDp , height: $heightDp")
    }
} 
```

### 结果：

当设备处于**`portrait`**定向状态时：

```
[PX] screen width: 1440 , height: 2392
[DP] screen width: 360.0 , height: 598.0 
```

当设备处于**`landscape`**定向状态时：

```
[PX] screen width: 2392 , height: 1440
[DP] screen width: 598.0 , height: 360.0 
```

* * *

## 如果你不是 kotlin 的粉丝，请使用 java 版本：

```
import android.content.res.Resources;
import android.graphics.Rect;
import android.graphics.RectF;
import android.util.DisplayMetrics;

/**
 * @author aminography
 */
public class DimensionUtils {

    private static DisplayMetrics displayMetrics;

    private static DisplayMetrics getDisplayMetrics() {
        if (displayMetrics == null) {
            displayMetrics = Resources.getSystem().getDisplayMetrics();
        }
        return displayMetrics;
    }

    public static Rect screenRectPx() {
        return new Rect(0, 0, getDisplayMetrics().widthPixels, getDisplayMetrics().heightPixels);
    }

    public static RectF screenRectDp() {
        return new RectF(0f, 0f, px2dp(getDisplayMetrics().widthPixels), px2dp(getDisplayMetrics().heightPixels));
    }

    public static float px2dp(int value) {
        return value / getDisplayMetrics().density;
    }

    public static int dp2px(float value) {
        return (int) (value * getDisplayMetrics().density);
    }
} 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2021-05-11T07:27:47.440

**科特林**

```
fun getScreenHeight(activity: Activity): Int {
    val metrics = DisplayMetrics()
    activity.windowManager.defaultDisplay.getMetrics(metrics)
    return metrics.heightPixels
}

fun getScreenWidth(activity: Activity): Int {
    val metrics = DisplayMetrics()
    activity.windowManager.defaultDisplay.getMetrics(metrics)
    return metrics.widthPixels
} 
```

**JAVA**

```
DisplayMetrics dimension = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(dimension);
int w = dimension.widthPixels;
int h = dimension.heightPixels; 
```

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2022-01-03T16:52:23.277

创建一个类和一个方法，如下所示：

```
public MyPoint getScreenDimensionsAsPixel(Context context){
        WindowManager windowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
        Display display = windowManager.getDefaultDisplay();

        Point point = new Point();
        display.getSize(point);

        return new MyPoint(point.x, point.y);
    }

    public class MyPoint{
        private int width;
        private int height;

        public MyPoint(int width, int height) {
            this.width = width;
            this.height = height;
        }

        public int getWidth() {
            return width;
        }

        public void setWidth(int width) {
            this.width = width;
        }

        public int getHeight() {
            return height;
        }

        public void setHeight(int height) {
            this.height = height;
        }
    } 
```

然后在您的代码中使用它们：

```
MyPoint myPoint = getScreenDimensionsAsPixel(MainActivity.this);
                Toast.makeText(MainActivity.this, "width: " + String.valueOf(myPoint.getWidth()) + "|" +
                        "height: " + String.valueOf(myPoint.getHeight()), Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2022-02-03T00:32:59.643

在 Kotlin 中要简单得多。

```
val displayMetrics = Resources.getSystem().displayMetrics
displayMetrics.heightPixels
displayMetrics.widthPixels 
```****

# java - 在 Derby 中自动将 VARCHAR 截断为特定长度

> ID：1016901
> 
> 赞同：2
> 
> 时间：2009-06-19T08:27:32.133
> 
> 标签：java, string, varchar, derby, javadb

如何使用 SQL 在 Derby 中将 VARCHAR 自动截断为表字段长度？

再具体一点：

```
CREATE TABLE A ( B VARCHAR(2) );
INSERT INTO A B VALUES ('1234'); 
```

会抛出一个 SQLException：

```
A truncation error was encountered trying to shrink VARCHAR '123' to length 2. 
```

有没有一种简单的方法来抑制这个异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T08:52:48.697

不，你应该在检查元数据后把它砍掉。或者，如果您不想每次都检查元数据，那么您必须使代码和数据库保持同步。但这没什么大不了的，这是验证者的常见做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T08:51:47.670

您可以在插入之前修剪 varchar。在插入脚本/过程中使用修剪功能。

我对 Derby 不熟悉，但在 MSSQL 中我做了完全相同的事情，使用 trim 来避免截断错误（仅在我不需要完整数据的情况下），增加 varchar 的长度更可取

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-15T12:59:55.313

您可以使用`SUBSTR`：

```
CREATE TABLE A ( B VARCHAR(2) );
INSERT INTO A B VALUES (SUBSTR('1234', 1, 2)); 
```

如果您使用准备好的语句：

```
INSERT INTO A B VALUES (SUBSTR(?, 1, 2)); 
```

# xml - 如何从 Perl 中的字符串中去除无效的 XML 字符？

> ID：1016910
> 
> 赞同：10
> 
> 时间：2009-06-19T08:31:17.667
> 
> 标签：xml, perl

我正在寻找在将字符串写入 XML 文件之前从字符串中去除无效字符的标准、认可和健壮的方法。我在这里谈论的是包含退格 (^H) 和换页符等的文本块。

*必须*有一个标准库/模块函数来执行此操作，但我找不到它。

我正在使用[XML::LibXML](http://search.cpan.org/dist/XML-LibXML)构建一个 DOM 树，然后将其序列化到磁盘。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-09-25T13:34:42.270

删除无效 xml-1.0 字符的完整正则表达式是：

```
# #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]
$str =~ s/[^\x09\x0A\x0D\x20-\x{D7FF}\x{E000}-\x{FFFD}\x{10000}-\x{10FFFF}]//go; 
```

对于 xml-1.1，它是：

```
# allowed: [#x1-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]
$str =~ s/[^\x01-\x{D7FF}\x{E000}-\x{FFFD}\x{10000}-\x{10FFFF}]//go;
# restricted:[#x1-#x8][#xB-#xC][#xE-#x1F][#x7F-#x84][#x86-#x9F]
$str =~    s/[\x01-\x08\x0B-\x0C\x0E-\x1F\x7F-\x84\x86-\x9F]//go; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T09:46:49.417

正如几乎所有其他人所说，使用正则表达式。老实说，它还不够复杂，不值得添加到库中。使用替换对文本进行预处理。

您对上述换行符的评论表明格式对您很重要，因此您可能必须准确决定要替换某些字符的内容。

XML 规范中明确定义了无效字符列表（例如，此处为[http://www.w3.org/TR/REC-xml/#charsets](http://www.w3.org/TR/REC-xml/#charsets)）。不允许使用的字符是 ASCII 控制字符栏回车、换行和制表符。因此，您正在查看 29 个字符的正则表达式字符类。这肯定不是太糟糕。

就像是：

```
$text =~ s/[\x00-\x08 \x0B \x0C \x0E-\x19]//g; 
```

应该这样做。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-06-11T19:31:20.123

我找到了一个解决方案，但它使用`iconv`命令而不是 perl。

```
$ iconv -c -f UTF-8 -t UTF-8 invalid.utf8 > valid.utf8 
```

上面给出的基于**正则表达式的解决方案都行不通！！**，请考虑以下示例：

```
$ perl -e 'print "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<root>\x{A0}\x{A0}</root>"' > invalid.xml
$ perl -e 'use XML::Simple; XMLin("invalid.xml")'
invalid.xml:2: parser error : Input is not proper UTF-8, indicate encoding !
Bytes: 0xA0 0xA0 0x3C 0x2F
$ perl -ne 's/[^\x09\x0A\x0D\x20-\x{D7FF}\x{E000}-\x{FFFD}\x{10000}-\x{10FFFF}]//go; print' invalid.xml > valid.xml
$ perl -e 'use XML::Simple; XMLin("valid.xml")'
invalid.xml:2: parser error : Input is not proper UTF-8, indicate encoding !
Bytes: 0xA0 0xA0 0x3C 0x2F 
```

事实上，这两个文件`invalid.xml`和`valid.xml`是**相同**的。

问题是范围 "\x20-\x{D7FF}" 匹配那些 unicode 字符的*有效*表示，但不匹配例如无效字符序列 "\x{A0}\x{A0}"。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T14:21:45.600

翻译比正则表达式替换*要*快得多。特别是如果您只想删除字符。使用蝾螈的集合：

```
$string_to_clean =~ tr/\x00-\x08\x0B\x0C\x0E-\x19//d; 
```

像这样的测试：

```
cmpthese 1_000_000
       , { translate => sub { 
               my $copy = $text; 
               $copy =~ tr/\x00-\x08\x0B\x0C\x0E-\x19//d; 
           }
           , substitute => sub { 
               my $copy = $text; 
               $copy =~ s/[\x00-\x08\x0B\x0C\x0E-\x19]//g; 
           }
         }; 
```

屈服：

```
 Rate substitute  translate
substitute  287770/s         --       -86%
translate  2040816/s       609%         -- 
```

我需要删除的字符越多，tr 就越快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T08:38:16.357

如果您使用 XML 库来构建您的 XML（而不是字符串连接、简单模板等），那么它应该会为您处理好这些。重新发明轮子是没有意义的。

*   [XML::LibXML](http://search.cpan.org/~pajas/XML-LibXML/)
*   [XML::树枝](http://search.cpan.org/~mirod/XML-Twig-3.32/Twig.pm)
*   [XML::智能](http://search.cpan.org/~gmpassos/XML-Smart-1.6.9/lib/XML/Smart.pm)
*   [XML::简单](http://search.cpan.org/~grantm/XML-Simple-2.18/lib/XML/Simple.pm)
*   ETC

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-19T16:38:25.080

好的，这似乎已经回答了，但是，嘿。如果要创作 XML 文档，则**必须**使用 XML 库。

```
#!/usr/bin/perl
use strict;
use XML::LibXML;

my $doc = XML::LibXML::Document->createDocument('1.0');
$doc->setURI('http://example.com/myuri');
$doc->setDocumentElement($doc->createElement('root-node'));

$doc->documentElement->appendTextChild('text-node',<<EOT);
    This node contains &, ñ, á, <, >...
EOT

print $doc->toString; 
```

这会产生以下结果：

```
$ perl test.pl
<?xml version="1.0"?>
<root-node><text-node>    This node contains &amp;, &#x6C821;, &lt;, &gt;...
</text-node></root-node> 
```

**编辑：**我现在看到您已经在使用 XML::LibXML。这应该可以解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T08:45:20.693

您可以使用正则表达式来删除控制字符，例如 \cH 将匹配 \cL 或 \x08 和 \x0C 都分别匹配退格和换页符。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T09:15:51.710

您可以使用简单的[正则表达式](http://perldoc.perl.org/perlre.html)来查找和替换文本块中的所有控制字符，将它们替换为空格或完全删除它们 -

```
# Replace all control characters with a space
$text =~ s/[[:cntrl:]]/ /g;

# or remove them
$text =~ s/[[:cntrl:]]//g; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T16:14:00.120

我以前没有对包含“无效”字符的 XML 做很多工作，但在我看来，这里有两个完全不同的问题。

首先，您的数据中有您可能不想要的字符。您应该独立于任何 XML 限制来决定它们是什么以及如何删除/替换它们。例如，您可能有一些事情`x^H_y^H_z^H_`，例如您决定要同时删除退格键和后面的字符。或者，您实际上可能不想调整数据，但因为需要用 XML 表示它而感到被迫。

更新：我为后代保留了以下段落，但它们是基于一个误解：我认为只要正确编码，就可以在 XML 数据中包含任何字符，但似乎有些字符是完全禁止的，甚至编码？XML::LibXML 去掉了这些（至少当前版本这样做了），除了 nul 字符，它将它视为字符串的结尾，丢弃它和后面的任何内容:(

其次，您的数据中可能包含需要在 XML 中编码的字符。理想情况下，您使用的任何 XML 模块都会为您执行此操作，但如果不是，您应该能够手动执行此操作，例如：

```
use HTML::Entities "encode_entities_numeric";
$encoded_string = encode_entities_numeric( $string, "\x00-\x08\x0B\x0C\x0E-\x19"); 
```

但这实际上只是权宜之计。使用适当的 XML 模块；例如看[这个答案](https://stackoverflow.com/questions/1016910/stripping-invalid-xml-characters-from-strings-in-perl/1018910#1018910)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-13T20:14:41.690

Axeman 使用 tr 是正确的，但他和 newt 在反转 XML 规范的合法字符范围时犯了一个小错误。[http://www.w3.org/TR/REC-xml/#charsets](http://www.w3.org/TR/REC-xml/#charsets)给出

```
Char ::= #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF] 
```

并且由于之前的十六进制数`\x20`是`\x1F`（不是`\x19`！）你应该使用

```
$string_to_clean =~ tr/\x00-\x08\x0B\x0C\x0E-\x1F//d; 
```

# apache-flex - 弹性界面问题

> ID：1016913
> 
> 赞同：2
> 
> 时间：2009-06-19T08:31:41.253
> 
> 标签：apache-flex, actionscript, interface, instance

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Label id="lb" text="check"/>
    <mx:Script>
        <![CDATA[
            import mx.managers.BrowserManager;
            import mx.managers.IBrowserManager;
            public var brm:IBrowserManager = BrowserManager.getInstance();
        ]]>
    </mx:Script>
</mx:WindowedApplication> 
```

上面代码中，IBrowserManager是一个接口，BrowserManager.getInstance()返回一个IBrowserManager类型的对象。但是，根据我对接口的了解，不能创建接口的实例吗？那么，我怎么能在这里创建一个接口的实例呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T14:45:41.590

假设您有一个接口 IPerson，它定义了两个成员——姓名和性别：

```
public interface IPerson
{
    function get name():String;
    function set name(value:String):void;

    function get gender:String;
    function set gender(value:String):void;
} 
```

...你有两个具体的类，女人和男人，它们都实现了 IPerson 接口。

```
public class Man implements IPerson
{
    private var _name:String;
    private var _gender:String;

    public function Man(name:String, gender:String)
    {
        this.name = name;
        this.gender = gender;   
    }

    public function get name():String
    {
        return _name;
    }

    public function set name(value:String):void
    {
        _name = value;
    }

    public function get gender()
    {
        return _gender;
    }

    public function set gender(value:String):void
    {
        _gender = value;
    }
} 
```

和

```
public class Woman implements IPerson
{
    private var _name:String;
    private var _gender:String;

    public function Woman(name:String, gender:String)
    {
        this.name = name;
        this.gender = gender;   
    }

    public function get name():String
    {
        return _name;
    }

    public function set name(value:String):void
    {
        _name = value;
    }

    public function get gender()
    {
        return _gender;
    }

    public function set gender(value:String):void
    {
        _gender = value;
    }
} 
```

然后，您最终可以执行以下操作：

```
var crowdOfPeople:ArrayCollection = YourCrowdOfPeopleClass.getInstance();

for each (var p:IPerson in crowdOfPeople)
{
    trace(p.name);
    trace(p.gender);
} 
```

...也就是说，对 Man 和 Woman 的具体实现采取行动（在这种情况下，跟踪其属性），就好像它们是同一种对象一样，因为它们都符合 IPerson 接口（即两者定义名称和性别属性）。

它是面向对象的[多态性](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)原则在起作用——有时您会听到它作为信条，“编程到接口，而不是实现”。希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T09:35:32.950

您不创建接口的实例。你得到的是一个实现该接口的类的实例。您可以分配给 IBrowserManager 类型的变量，这是很自然的，它是实现 IBrowserManager 的 BrowserManager 类的实例。

# c# - 在excel xml中设置日期单元格格式

> ID：1016914
> 
> 赞同：5
> 
> 时间：2009-06-19T08:31:58.193
> 
> 标签：c#, excel

我需要将数据集导出到 excel 文件。我在数据集中有日期列。我需要确保单元格的日期格式具有区域设置：英语（英国），日期格式为 dd/mm/yyyy。目前我正在使用 dd/mm/yyyy 设置格式

```
<Style ss:ID="DateLiteral">
 <NumberFormat ss:Format="dd/mm/yyyy;@"/>
</Style> 
```

在工作簿元素中。如何设置所需的语言环境？如果我知道如何使用 C#.net 使用用户机器的当前文化设置所需的语言环境，那也很好。

谢谢 ：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-07T16:36:26.823

不必强制使用自定义格式，您可以使用默认 Excel 日期或时间格式之一

*   一般日期
*   长日期
*   中日期
*   短日期
*   很久
*   中等时间
*   短时间

这些格式的日期和/或时间根据打开电子表格的用户的系统日期格式显示。

例如，日期为 2009 年 12 月 31 日，格式为“短日期”，在美国将显示为 2009 年 12 月 31 日，在英国显示为 2009 年 12 月 31 日。

电子表格 XML 如下所示：

```
<Style ss:ID="DateLiteral">
 <NumberFormat ss:Format="Short Date"/>
</Style>

<Row>
 <Cell ss:StyleID="DateLiteral">
  <Data ss:Type="DateTime">2009-12-31T00:00:00.000</Data>
 </Cell>
</Row> 
```

# upload - Google Gears 拖放上传

> ID：1016915
> 
> 赞同：5
> 
> 时间：2009-06-19T08:32:25.150
> 
> 标签：upload, file-upload, google-gears

我最近从 google i/o 观看了 google wave 视频，他们说您可以将文件从 Windows 资源管理器拖放到浏览器并使用齿轮上传它们。有人可以指出我自己做这件事的正确方向吗？我浏览了谷歌代码上的 gears api 页面，找不到任何接近这个的例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-03T22:33:05.803

你在这里有一些信息：http: [//fvisticot.blogspot.com/2009/06/google-gears-desktop-drag-and-drop.html](http://fvisticot.blogspot.com/2009/06/google-gears-desktop-drag-and-drop.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-22T16:35:10.220

您可能想尝试一下 plupload，它允许您使用 HTML5 Gears、Silverlight、Flash、BrowserPlus 或普通表单上传文件，提供上传进度、图像大小调整和分块上传等功能。（见[http://www.plupload.com/](http://www.plupload.com/)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T08:50:24.960

我也一直在寻找 - 到目前为止我发现的最好的是这个，但它没有很好的记录

[http://code.google.com/p/jquerymultiupload/](http://code.google.com/p/jquerymultiupload/)

乔什

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-22T18:08:23.860

这是一篇关于使用 ASP.NET 进行齿轮拖放上传的好文章

[http://coderbag.com/Web-Development/Drag-Drop-file-Upload-With-Google-Gears-and-ASP-NET](http://coderbag.com/Web-Development/Drag-Drop-file-Upload-With-Google-Gears-and-ASP-NET)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-06-22T17:38:24.007

我最终找到了不同的解决方案。

我刚刚使用了[SWFUpload](http://www.swfupload.org/)（在 Google 上找到）。不像拖放那样流畅，但设置起来要容易得多，并且允许用户一次执行多个文件。

# html - 我应该对网站内的页面使用相对路径吗？或者没关系？

> ID：1016917
> 
> 赞同：1
> 
> 时间：2009-06-19T08:32:57.350
> 
> 标签：html, url, path, relative-path, absolute-path

我只是想知道定义链接到域名内页面的 url 的最佳方法是什么。例如，对于域 www.example.com .. 我可以有类似的链接

`<a href="http://www.domain.com/test.html">test</a>`

或者

`<a href="test.html">test</a>`

我遇到的一个问题是，在使用模板时..如果我使用带有相对链接的 html 模板，那么我不能对目录 www.example.com/directory2 使用相同的模板，因为公共链接不起作用对于那个页面..既不是css文件也不是javascripts文件。

我要么必须复制模板，要么绝对设置路径。我选择了绝对路径。所以模板路径以[http://www.mydomain.com/](http://www.mydomain.com/)开头。这是否会导致任何性能问题，如多个 http 请求、域解析或任何其他问题？您对此有何建议/评论？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T08:34:09.093

您可以根植所有路径

```
eg <a href="/test.html">test</a> 
```

这将与放置域相同。

[编辑] 如果需要，您可以使用 mod rewrite 将站点移动到不同的文件夹 - 请参阅 [http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritebase](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritebase)

乔什

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T08:41:22.373

**绝对使用相对路径。**

这将为您提供同样多的功能，并且在您的域名更改时将阻止您遇到问题，并且允许您在不同的服务器上进行**测试**，而不是在现场......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T08:39:39.520

我想你应该使用相对路径。因为如果您的域已经消失/更改，该站点仍然可以正常工作，而且更重要的是，html 中的路径会短得多。

如果你想适应改变文件结构的情况。假设您正在使用 html 开发网站。我想您可以使用 shtml / 服务器端包含来分隔常见项目，例如：菜单

这样当结构发生变化时，您只需修改 menu.shtml

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T09:09:08.680

虽然使用绝对路径不会增加任何额外的开销，但本地链接的公认做法是使用相对链接。相对链接可以通过 wget 或 Down-Them-All（网站下载工具）等工具与绝对链接区别对待。

但是，如果您的模板解决方案最适合使用绝对链接，那么坚持使用它们并非闻所未闻。试探性地，如果您的网站内容通过链接回您的原始页面（来源： http: [//www.navegabem.com/linking-strategy.html](http://www.navegabem.com/linking-strategy.html)）而被抓取，那么绝对链接可能对您有利。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T08:40:40.453

Josh 的建议是可以的，但是如果您的网站位于虚拟目录下，它将失败。我建议始终使用相对路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T08:41:27.690

始终使用您的相对路径来引用您站点中的资源（页面、css 文件、js 文件）。

原因：

1.  这使您可以随时更改域名而不会引起巨大的头痛
2.  让您非常轻松地重组您的页面。

但是，如果您的网站真的那么大，您将需要有一个链接和链接 ID 的数据库，以免在移动资源时放错链接。这就是微软在 microsoft.com 上所做的。

jrh

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T08:43:05.050

我在 Josh.... 指定相对于应用程序根目录的路径：/myfolder/myfile.html

就我而言，这具有在我的开发机器上工作的额外优势，其中每个站点都是我的默认站点之外的应用程序 (IIS)，以及在实时站点本身上工作。

# c++-cli - 有什么直接的方法可以做 pin_ptr 的工作吗？

> ID：1016928
> 
> 赞同：1
> 
> 时间：2009-06-19T08:36:27.217
> 
> 标签：c++-cli

pin_ptr 的行为可以直接在 C++/CLI 中实现吗？例如，是否可以直接编写 CLR 代码，比如`asm`原生应用程序？

我想做的一个例子是 a 的包装器`pin_ptr`（由于对`pin_ptr`s 的限制，这是不可能的）。

```
class WrappedPtr
{
public:
    explicit WrappedPtr(String^ s)
    {
        pin = PtrToStringChars(s);
        // I want to pin s for the lifetime of this object (only used on the stack)
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-10T15:31:24.537

使用[GCHandle.Alloc](http://msdn.microsoft.com/en-us/library/1246yz8f.aspx)。与[GCHandleType.Pinned](http://msdn.microsoft.com/en-us/library/83y4ak54.aspx)。然后，您可以使用[GCHandle.AddrOfPinnedObject](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle.addrofpinnedobject.aspx)来获取 .NET 对象的地址。

# mapi - Winmail.dat 从通讯簿发送给某些收件人

> ID：1016944
> 
> 赞同：0
> 
> 时间：2009-06-19T08:41:31.623
> 
> 标签：mapi, winmail.dat

我正在为 Outlook（2003 和 2007）制作一个插件，它正在更改在 ItemSend 事件处理程序中发送的消息的正文和主题。我在接收 html 内容的 winmail.dat 文件时遇到问题。我在论坛上发现，为避免这种情况，我需要将消息的 UseTnef 属性设置为 false，将收件人的 PR_SEND_RICH_INFO 属性设置为 false。我已经设法通过扩展 MAPI 做到了前者，但我正在为后者而苦苦挣扎。使用 McfMapi，我可以看到联系人通讯录中的 PR_SEND_RICH_INFO 为 false，但是当我检查收件人表 (GetMessageRecipients) 并迭代槽属性时，对于某些收件人，属性标记为 0x34a0000a，这表示错误或缺少属性。在发件箱中创建邮件后，对于具有错误标记的收件人，此属性设置为 true，并且他们会在其客户端中接收 winmail.dat。我什至尝试将属性标记更改为 0x3a40000b 并将其设置为 false，使用更改后的表作为参数调用 ModifyRecipients 但没有效果。

你有什么想法或建议可以帮助我解决这个问题吗？

提前致谢

弗拉基米尔医生

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-05T05:33:07.310

您可能应该[在此处](http://social.msdn.microsoft.com/Forums/en-US/outlookdev/)发布 以获得更好的响应。Dmitry 是回答您问题的合适人选。

# c# - C# WM6 Compact Framework 跨线程通信问题

> ID：1016946
> 
> 赞同：0
> 
> 时间：2009-06-19T08:41:49.593
> 
> 标签：c#, .net, multithreading, windows-mobile-6

我在从使用创建的线程更新我的 ui 上的控件时遇到问题

```
ThreadPool.QueueUserWorkItem 
```

在这个线程里面我打电话

```
addControlToPanel(li); 
```

如此处所示

```
private delegate void addControlToPanelDelegate(ListItem li);
private void addControlToPanel(ListItem li)
{
    if (panel1.InvokeRequired)
    {
        addControlToPanelDelegate d = new addControlToPanelDelegate(addControlToPanel);
        panel1.Invoke(d, new object[] { li });
    }
    else
    {
        panel1.Controls.Add(li);
    }
} 
```

在 addControlToPanel() panel1.InvokeRequired == true 的第一个条目上，一个委托被实例化然后被调用，现在在 addControlToPanel() 的这个条目上， panel1.InvokeRequired == false 所以我将控件添加到面板。

我的问题是，即使在针对控件和 panel1.InvokeRequired 为 false 调用之后，我在

```
panel1.Controls.Add(li); 
```

说明通常的行

Control.Invoke 必须用于与在单独线程上创建的控件进行交互。

有人能发现问题吗？使用调用来访问另一个线程上的控件是我以前做过很多次的事情，但是这个让我很难过！

TIA

OneSHOT

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T13:43:34.447

似乎问题是在调用上传递了一个控件（ListItem 是我创建的一个表单控件），而不是我重构了代码，而不是创建控件并将其传递给

```
addControlToPanel() 
```

方法，我在调用后传递了在方法内部创建控件所需的所有信息

```
private delegate void addControlToPanelDelegate(string picname, string thumburl, PicasaEntry entry, Int32 top, EventHandler clickevent);
private void addControlToPanel(string picname, string thumburl, PicasaEntry entry, Int32 Ordinal,EventHandler clickevent)
{
    if (panel1.InvokeRequired)
    {
        addControlToPanelDelegate d = new addControlToPanelDelegate(addControlToPanel);
        this.Invoke(d, new object[] { picname, thumburl, entry, Ordinal, clickevent });
        //panel1.Invoke(d, new object[] { li });
    }
    else
    {
        ListItem li = new ListItem(picname, thumburl, entry);
        li.Top = Ordinal * li.Height;
        li.Click += clickevent;
        panel1.Controls.Add( li);
    }
} 
```

干杯

OneSHOT

# pdf - 在使用 cfpdfform action="read" 之前检查 ColdFusion 中是否存在交互式表单

> ID：1016947
> 
> 赞同：2
> 
> 时间：2009-06-19T08:41:49.827
> 
> 标签：pdf, forms, coldfusion

我正在使用 cfpdfform 从在 Adob​​e LiveCycle 创建的上传 PDF 表单中读取值，然后使用 Adob​​e Acrobat 填写。

要读取表单值，我使用以下命令：

```
<cfpdfform source="#pathToNewPDFFile#" action="read" xmlData="xmlFields" /> 
```

但是，如果上传了没有表单的 PDF（即其他一些 PDF）ColdFusion 会出现以下错误：

```
The source PDF document is not an interactive form. 
```

有什么方法可以在 ColdFusion 中测试 PDF 中是否存在表单，而无需捕获和解释此错误？

我试过`cfpdf action="pdfinfo"`了，但没有一个变量似乎在交互式和非交互式形式之间发生变化。

谢谢，

汤姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T10:04:53.357

我会做一个简单的

```
<cftry>
  <cfpdfform source="#pathToNewPDFFile#" action="read" xmlData="xmlFields" />
  <cfcatch>
    <cfset xmlFields = XmlNew()>
  </cfcatch>
</cftry> 
```

# c# - 这种将异步方法转换为同步方法的方法是否正确？

> ID：1016949
> 
> 赞同：4
> 
> 时间：2009-06-19T08:43:20.667
> 
> 标签：c#, multithreading, asynchronous, closures

我有一个使用[基于事件的异步方法模式](http://msdn.microsoft.com/en-us/library/wewwczdw.aspx)实现的方法。我还想提供该方法的同步版本，但不想重写它（因为该方法涉及从 Silverlight 调用 WCF，所以异步版本必须是主要方法）。

我想出了以下通用方法将基于事件的异步调用转换为同步调用：

```
 Func<TArg1, TArg2, TArg3, TEventArgs> 
    CreateSynchronousMethodFromAsync<TArg1, TArg2, TArg3, TEventArgs>(
       Action<TArg1, TArg2, TArg3, EventHandler<TEventArgs>> asyncMethod) 
         where TEventArgs : AsyncCompletedEventArgs
    {
        Func<TArg1, TArg2, TArg3, TEventArgs> syncMethod = (arg1, arg2, arg3) =>
         {
             TEventArgs eventArgs = null;

             using (var waitHandle = new ManualResetEvent(false))
             {
                 asyncMethod(arg1, arg2, arg3, (sender, e) =>
                                          {
                                              eventArgs = e;
                                              waitHandle.Set();
                                          });

                 waitHandle.WaitOne();

                 return eventArgs;
             }
         };

        return syncMethod;
    } 
```

所以如果我有这个异步方法：

```
void ConnectAsync(string address, 
     string userName, 
     string password, 
     EventHandler<ConnectCompletedEventArgs> completionCallback) 
```

我可以将它转换成这样的同步调用：

```
public void Connect(string address, string userName, string password)
{
    Func<string, string, string, ConnectCompletedEventArgs> connect = 
        CreateSynchronousMethodFromAsync<string, string, string, ConnectCompletedEventArgs>(ConnectAsync);

    var connectResult = connect(address, userName, password);

    if (connectResult.Error != null)
    {
        throw connectResult.Error;
    }
} 
```

我担心的是在闭包中捕获的 eventArgs 变量的使用。它被设置在一个线程中，并从另一个线程访问。一旦发出事件信号，我对 ManualResetEvent 的使用是否足以保证正确读取值，还是我需要做其他事情？

好吧，您已经完成了，您可能想在此处评论异常处理。我的计划是 Async 方法将在 ConnectionException 或类似的东西中包装在堆栈下方发生的异常，所以我的想法是在这种情况下重新抛出异常是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T08:50:43.803

根据您提到的页面上讨论的异步模式，这看起来是包装异步调用的一个很好的尝试。

然而让我犹豫的是方法的名称' `BeginConnect`'; 一些 .NET 类有 ' `BeginXxx`' / ' `EndXxx`' 对来处理异步调用，这些通常指定正确的操作**需要**从回调处理程序调用' `EndXxx`' 调用，这是您的方案不满足的。

如果您要包装的调用确实符合链接页面上讨论的模式，那么这应该可以工作，如果您要包装的调用是第二种调用之一，那么您并不完全在那里......

# wpf - 我怎样才能让这个 DataTrigger 工作？

> ID：1016954
> 
> 赞同：8
> 
> 时间：2009-06-19T08:44:52.847
> 
> 标签：wpf, mvvm, binding, triggers, datatrigger

如果 ViewModel 属性 =“**无效**” ，我希望我的 TextBox 具有**红色背景**。我必须改变什么才能使它起作用？

 **这个版本告诉我**Background 没有限定类型名称**。

```
<TextBox
    Width="200"
    Text="{Binding FieldEmail, UpdateSourceTrigger=PropertyChanged}">
    <TextBox.Triggers>
        <DataTrigger Binding="{Binding FieldEmailValidationStatus}" Value="invalid">
            <Setter Property="TextBox.Background" Value="Tomato"/>
        </DataTrigger>
    </TextBox.Triggers>
</TextBox> 
```

当我添加“文本框”时。它告诉我我**必须有一个 EventTrigger**：

```
<TextBox
    Width="200"
    Text="{Binding FieldEmail, UpdateSourceTrigger=PropertyChanged}">
    <TextBox.Triggers>
        <DataTrigger Binding="{Binding FieldEmailValidationStatus}" Value="invalid">
            <Setter Property="Background" Value="Tomato"/>
        </DataTrigger>
    </TextBox.Triggers>
</TextBox> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-19T08:48:18.317

请允许我回答这个问题，我忘了把它全部包装成一种风格，然后它就很好用了：

```
<TextBox
    Width="200"
    Text="{Binding FieldEmail, UpdateSourceTrigger=PropertyChanged}">
    <TextBox.Style>
        <Style>
            <Style.Triggers>
                <DataTrigger Binding="{Binding FieldEmailValidationStatus}" Value="invalid">
                    <Setter Property="TextBox.Background" Value="Tomato"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBox.Style>
</TextBox> 
```

或这个：

```
<Style x:Key="FieldEmailStyle" TargetType="TextBox">
    <Style.Triggers>
        <DataTrigger Binding="{Binding FieldEmailValidationStatus}" Value="invalid">
            <Setter Property="TextBox.Background" Value="Yellow"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding FieldEmailValidationStatus}" Value="valid">
            <Setter Property="TextBox.Background" Value="LightGreen"/>
        </DataTrigger>
    </Style.Triggers>
</Style>

    <TextBox
        Width="200"
        Style="{StaticResource FieldEmailStyle}"
        Text="{Binding FieldEmail, UpdateSourceTrigger=PropertyChanged}">
    </TextBox> 
```**

# java - 在Java中用外文代替英文字符的方法？

> ID：1016955
> 
> 赞同：2
> 
> 时间：2009-06-19T08:45:16.467
> 
> 标签：java, string, special-characters, character

在 PHP 中我会使用这个：

```
$text = "Je prends une thé chaud, s'il vous plaît";
$search = array('é','î','è'); // etc.
$replace = array('e','i','e'); // etc.
$text = str_replace($search, $replace, $text); 
```

但是 Java String 方法“replace”似乎不接受数组作为输入。有没有办法做到这一点（不必诉诸 for 循环来遍历数组）？

请说是否有比我尝试的方法更优雅的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T09:13:25.473

一个非常好的方法是使用Apache Commons Lang 2.4 中[`replaceEach()`的类中的方法。`StringUtils`](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/StringUtils.html#replaceEach(java.lang.String,%20java.lang.String[],%20java.lang.String[]))

```
String text = "Je prends une thé chaud, s'il vous plaît";
String[] search = new String[] {"é", "î", "è"};
String[] replace = new String[] {"e", "i", "e"};
String newText = StringUtils.replaceEach(text, 
                search, 
                replace); 
```

结果是

```
Je prends une the chaud, s'il vous plait 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T09:13:13.570

标准 API 中没有与 PHP 相同的方法，尽管 Apache Commons 中可能有一些方法。您可以通过单独替换字符来做到这一点：

```
s = s.replace('é','e').replace('î', 'i').replace('è', 'e'); 
```

一种更复杂的方法不需要您枚举要替换的字符（因此更有可能不会错过任何内容）但确实需要一个循环（无论如何都会在内部发生，无论您使用什么方法）将`java.text.Normalizer`用于分隔字母和变音符号，然后去掉所有字符类型为`Character.MODIFIER_LETTER`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T10:03:29.290

我不是 Java 人，但我建议使用[Normalizer 类](http://java.sun.com/javase/6/docs/api/java/text/Normalizer.html)分解重音字符然后删除[Unicode](http://unicode.org/faq/normalization.html) “组合”字符的通用解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T08:55:03.233

你将不得不做一个循环：

```
String text = "Je prends une thé chaud, s'il vous plaît";
Map<Character, String> replace = new HashMap<Character, String>();
replace.put('é', "e");
replace.put('î', "i");
replace.put('è', "e");
StringBuilder s = new StringBuilder();
for (int i=0; i<text.length(); i++) {
  char c = text.charAt(i);
  String rep = replace.get(c);
  if (rep == null) {
    s.append(c);
  } else {
    s.append(rep);
  }
}
text = s.toString(); 
```

**注意：**某些字符被替换为多个字符。例如，在德语中，u-umlaut 转换为“ue”。

**编辑：**使它**更有**效率。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T09:10:59.783

你需要一个循环。

一个有效的解决方案如下所示：

```
 Map<Character, Character> map = new HashMap<Character, Character>();
    map.put('é', 'e');
    map.put('î', 'i');
    map.put('è', 'e');

    StringBuilder b = new StringBuilder();
    for (char c : text.toCharArray())
    {
        if (map.containsKey(c))
        {
            b.append(map.get(c));
        }
        else
        {
            b.append(c);
        }
    }
    String result = b.toString(); 
```

当然，在实际程序中，您可以将地图的构建和替换封装在它们各自的方法中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T08:59:45.737

据我所知，没有标准方法，但这里有一个类可以满足您的要求：

[http://www.javalobby.org/java/forums/t19704.html](http://www.javalobby.org/java/forums/t19704.html)

# c# - 什么设计模式？

> ID：1016959
> 
> 赞同：4
> 
> 时间：2009-06-19T08:45:28.620
> 
> 标签：c#, design-patterns

我有一个 A 类维护 B 类的对象列表。但是 B 类的每个对象都可以在 A 类的任何对象中引用。B 类还维护一个 A 类对象的列表，其中它被引用。该程序可以并且将“随意”创建（几个）A 类和 B 类的对象，并删除它们。

如果我使用 C#，我可以使用以下代码从两个类中添加和删除对象

```
public class A
{
    private List<B>ListOfObjects_B;
    public bool Add(B Object)
    {
       bool bAdd = false;
       if ((Object != null) && (ListOfObjects_B.IndexOf(B) <0))
       {
          ListOfObjects_B.Add(Object);
          Object.Add(this);
          bAdded = true;
       }
       return bAdded;
    }

    public bool Delete(B Object)
    {
       bool bDeleted = ListOfObjects_B.Remove(Object);
       if (bDeleted == true) Object.Delete(this);
       return bDeleted;
    }
}

public class B
{
    private List<A>ListOfObjects_A;
    public bool Add(A Object)
    {
        bool bAdd = false;
        if ((Object != null) && (ListOfObjects_A.IndexOf(A) <0))
        {
            ListOfObjects_A.Add(Object);
            Object.Add(this);
            bAdded = true;
        }
        return bAdded;
   }

   public bool Delete(A Object)
   {
       bool bDeleted = ListOfObjects_A.Remove(Object);
       if (bDeleted == true) Object.Delete(this);
       return bDeleted;
   }
} 
```

这将起作用，因为将对象删除/添加到 ListOfObjects 第二次（通过递归）该函数将被调用，它将无法删除/添加，从而避免无限循环。

但我不喜欢这段代码，即使 A 和 B 对另一个类“了解不多”并且只是调用删除/添加函数。

我想这种问题是普遍的，并且存在一种设计模式来处理它，这样可以避免递归并且更新两个列表会“更好”。我应该使用什么设计模式？如果也添加一些代码，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T08:55:02.767

您可以通过将“对象关联关注点”移动到专用类来简化事情。这就是我的想法。

定义一个名为 AssociationTable 的类。此类将维护一个对列表，其中每对包含对 A 对象的引用和对 B 对象的引用。

每个 A 对象（和每个 B 对象）都将持有对 AssociationTable 对象的引用。A.Add(B) 将被实现为 table.add(this, b); B.Add(A) 将被实现为 table.add(a, this);

删除将被实现为 table.delete(this, b) 或 table.delete(a, this)

```
class Pair { 
  A a; B b; 
  Pair(A a, B b) { this.a = a; this.b = b; } 
  // Also override Equals(), HashCode()
}

class AssociationTalbe {
  Set<Pair> pairs = ...;

  void add(A a, B b) { pairs.add(new Pair(a, b)); }
  void remove(A a, B b) { pairs.remove(new Pair(a, b)); }
}

class A {
  AssociationTable table;

  public A(AssociationTable t) { table = t; }

  void add(B b) { table.add(this, b); }
  void remove(B b) { table.remove(this, b); }
} 
```

编辑：这个设计的问题是垃圾收集。该表将保存对对象的引用，从而抑制它们的集合。在 Java 中，您可以使用 Wea​​kReference 对象来克服这个问题。我很确定 .Net 世界中也有类似的东西

此外，该表可以是单例。我不太喜欢单身人士。在这里，单例将使 AB 关联在您的程序中独一无二。这可能是不受欢迎的，但这取决于您的具体需求。

最后，（只是把事情放在上下文中）这种设计的工作方式与关系数据库中的多对多关系相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T09:37:17.453

我最近写[了一个类来处理类似的问题](http://www.thomaslevesque.com/2009/06/12/c-parentchild-relationship-and-xml-serialization/)。它实际上是一个更简单的场景（父/子关系与引用其父的子关系），但您可能可以根据需要对其进行调整。主要区别在于`Parent`我的实现中的属性应该被父集合替换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T09:06:36.253

关于我能想到的唯一一件事是使用调解器模式，这样 A 就不会将自己添加到 B 中。这是一个示例：

```
public class Mediator {

    public void Add(A List, B Object) {
        if(list.Add(Object)) {
            object.Add(List);
        }
    }

    public void Delete(A List, B Object) {
        if(List.Delete(Object)) {
            Object.Delete(List);
        }
    }
} 
```

在此之后，您将删除读取“Object.Add(this);”的代码行 和“如果（bDeleted == true）Object.Delete（this）；” 这也有利于减少每个方法被调用的次数，因为对象 A 的方法被调用了两次，因为对象 B 也在对象 A 上调用这些方法。

编辑：经过进一步审查，我意识到您已经在某种程度上使用了观察者设计模式。对象 A 是观察者，对象 B 是可观察对象。对象 A 维护一个其观察对象的列表，对象 B 维护一个观察它的对象列表。唯一的事情是我没有看到任何额外的功能，尽管可能有一些。基本上，对象 B 将通知所有观察它的对象 A 它已更改，并且所有这些对象 A 都会要求更改。如果这是您要查找的内容，那么您需要做的就是删除“Object.Add(this);”行 和“if(bDeleted == true) Object.Delete(this);” 从 B 代码，因为它是不必要的。

# sharepoint - MetaStorm Ework 和 SharePoint 2007

> ID：1016960
> 
> 赞同：1
> 
> 时间：2009-06-19T08:46:26.060
> 
> 标签：sharepoint

有没有人在 SharePoint 2007 中使用过 MetaStorm Ework Web 部件？

我被要求看一下这个，并且很想知道你对解决这个问题的最佳方法的想法。

一切顺利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-29T01:58:31.047

我无法回答，但您可能可以在我们的 Metastorm BPM 论坛上找到答案，或者在此处发布问题，您可以获得快速回复：

[http://metastorm.processmapping.com.au/](http://metastorm.processmapping.com.au/)

# zend-framework - DataMapper 模式会破坏 MVC 吗？

> ID：1016966
> 
> 赞同：8
> 
> 时间：2009-06-19T08:50:22.697
> 
> 标签：zend-framework, activerecord, domain-driven-design, dry, model-view-controller

我一直在阅读多个 PHP 框架，尤其是 Zend 框架，但我对前进的正确方法感到困惑。

Zend Framework 不使用 ActiveRecords，而是使用 Table Data Gateway 和 Row Data Gateway 模式，并使用 DataMapper 将 Row Data Gateway 的内容映射到模型，因为当您的模型没有 1 时 ActiveRecord 会崩溃： 1 映射到您的数据库表。Zend 快速入门指南中有一个[示例。](http://framework.zend.com/docs/quickstart/create-a-model-and-database-table)

对我来说，他们的例子看起来非常臃肿，到处都是大量的 getter 和 setter。我遇到了各种关于域驱动设计的博客文章，他们认为使用这么多的 getter 和 setter 是不好的做法，因为它会将所有内部模型数据暴露给外部，因此它与公共属性相比没有优势。[这是一个例子](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html)。

我的问题：如果你删除那些 getter 和 setter，你将如何呈现你的视图？在某些时候，数据必须到达视图，以便您可以向用户实际展示一些内容。遵循 DDD 建议似乎打破了 MVC 中 M 和 V 之间的分离。遵循 MVC 和 Zend 示例似乎破坏了 DDD，让我为我的所有模型输入了大量的 getter、setter 和 DataMapper。除了大量的工作之外，它似乎也违反了 DRY。

我真的很感激一些（链接到）好的例子或更多关于它们如何组合在一起的信息。我正在努力提高我的建筑和设计技能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T22:45:36.427

你不需要实现所有的getter/setter，你可以使用__get() 和__set()。那有什么问题呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-23T18:06:30.633

使用值对象，您可以消除其中一些公共 setter 方法。这是对[Entity 和 Value Objects 之间区别](http://devlicio.us/blogs/casey/archive/2009/02/13/ddd-entities-and-value-objects.aspx)的描述。值对象是不可变的，通常与实体相关联。如果使用构造函数传入所有值，则无需从外部代码设置这些属性。

一些额外的东西，与答案没有直接关系，但更专注于 DDD：

（免责声明：我对 Zend 框架的唯一了解是我在链接文章中读到的内容。） Zend 框架使用 DataMappers 而不是 Repositories。这真的是 DDD 式的吗？好吧，[福勒对存储库的解释](http://martinfowler.com/eaaCatalog/repository.html)可能会说不。但是，Eric Evans 表示 DDD 存储库可以非常简单。最简单的，存储库*是*一个 DataMapper（参见 DDD 书）。有关更复杂且仍为 DDD 的内容，请参阅 Fowler 文章。DDD 有一个可能与模式定义不同的概念存储库。

我敦促您继续阅读有关领域驱动设计的内容。我认为 getter 和 setter 违反 DDD 的假设存在缺陷。DDD 是关于专注于领域模型和实现这一目标的最佳实践。访问器只是一个小细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T19:31:58.730

从我对帖子的阅读来看，这个问题更具哲学性而不是实际性。

我没有时间深入写，但这是我的两分钱。虽然我同意您希望限制 get 和 set 请求的数量，因为类应该隐藏其内部，但您还需要考虑 Java 和 PHP 是不同的工具并且具有不同的用途。在 Web 环境中，每个请求都会构建和删除您的类，因此您编写的代码不应依赖于巨大的类。在您指出的文章中，作者建议将视图逻辑放在类中。这在网络上可能没有意义，因为我可能希望以多种格式（rss、html 等）呈现视图。因此，使用访问器方法（get & set）是必要的。你仍然想慎重地使用它们，这样你就不会在脚下开枪了。关键是尝试让您的班级为您完成工作，而不是试图强迫他们在外部完成工作。通过使用方法而不是直接访问您的属性，您可以隐藏您想要的内部结构。

同样，这篇文章可以使用一些示例，但我现在没有时间。

其他人可以提供一些为什么访问器方法不邪恶的例子吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-09T21:26:31.887

这里有两种方法：我称之为“告诉不问方法”，另一种是 ViewModel/DTO 方法。本质上，问题围绕着您认为的“模型”是什么。告诉不问要求对象可以外化的唯一方法是从对象本身。换句话说，要渲染一个对象，您将有一个渲染方法，但该渲染方法需要与接口对话。像这样的东西：

```
class DomainObject {
   ....
   public function render(DomainObjectRenderer $renderer) {
        return $renderer->renderDomainObject(array $thegorydetails);
   }
} 
```

在 Zend Framework 的上下文中，您可以继承 Zend_View 并让您的子类实现这个接口。

我以前做过这个，但它有点笨拙。

第二个选项是将您的域模型转换为 ViewModel 对象，这就像您的数据的简化、扁平化、“串出”视图，为每个特定视图定制（每个视图一个 ViewModel），并在返回的路上，将 POST 数据转换为 EditModel。

这是 ASP.NET MVC 世界中非常流行的模式，但它也类似于用于在应用程序中的“层”之间传输数据的类“DTO”模式。您需要创建映射器来为您完成繁琐的工作（实际上与 DataMapper 不同）。在 PHP 5.3 中，您可以使用反射来更改私有属性，因此您的 DomainObject 甚至不需要暴露自己！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-09T21:42:01.173

在我看来，实现 getter 和 setter 有两个优点：

1.  您可以选择公开哪些属性，因此您不必公开所有模型的内部结构
2.  如果您使用带有自动完成功能的 IDE，那么当您开始键入“get”或“set”时，所有可用的属性都将在一个 TAB 之外——这对我来说就足够了。

# wcf - 使用 Windows 服务中托管的 WCF 服务

> ID：1016976
> 
> 赞同：0
> 
> 时间：2009-06-19T08:53:21.800
> 
> 标签：wcf, windows-services, installation, wcf-binding

我编写了 WCF 服务并托管在 Windows 服务中。我需要知道如何在我的客户端应用程序中使用这个 Windows 服务。

* * *

### 笔记：

我写了网络管道绑定服务。

* * *

### 编辑：

如何编写用于网络管道绑定的客户端应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T16:39:59.523

您需要执行几个简单的步骤：

*   启动托管 WCF 服务的 Windows 服务
*   在 Visual Studio（2008 或更高版本）中，右键单击解决方案资源管理器中的项目节点并选择“添加服务引用”
*   输入可以访问您的服务的 URL

这就是全部，真的。Visual Studio 将转到您正在运行的服务，获取它需要的所有元数据（假设您已启用 MEX 端点以进行元数据交换），并将创建一个客户端代理类供您用于将您的客户端连接到您的服务。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T15:57:38.780

需要使用 ChannelFactory 创建代理，然后才能使用代理执行 wcf 任务。

```
ChannelFactory<IWCFService> pipeFactory = new ChannelFactory<IWCFService>(
                                                  new NetNamedPipeBinding(), 
                                                  new EndpointAddress("net.pipe://localhost/PipeWCFService"));

IWCFService pipeProxy = pipeFactory.CreateChannel();
pipeProxy.RunWCFServiceMethod();} 
```

[http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communication](http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communication)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T08:55:45.103

您可以像使用任何其他 WCF 服务一样使用它。用于托管 WCF 服务的方法与客户端无关。

如果您需要有关如何实际构建客户端的详细信息，请告诉我，我会更新帖子。

编辑：从**[这里](http://msdn.microsoft.com/en-us/library/ms734691.aspx)**开始学习如何构建 WCF 客户端。

# c# - OpenFileDialog 文件名为 UTF8

> ID：1016978
> 
> 赞同：1
> 
> 时间：2009-06-19T08:54:10.927
> 
> 标签：c#, windows, unicode, utf-8

C#问题在这里..

我有一个 UTF-8 字符串，它正在由 C++ 中的非 Unicode 程序解释。这个文本显示不正确，但据我所知，它是完整的，然后作为输出文件名应用。

无论如何，在 C# 项目中，我试图用*System.Windows.Forms.OpenFileDialog*对象打开这个文件。我从该对象的*.FileNames[]*获得的文件名采用 Unicode (UCS-2) 格式。但是，这个字符串被误解了。例如，如果原始字符串是**0xe3 0x81 0x82**，则 FileName[].ToCharArray() 显示它现在是**0x00e3 0x0081 0x201a** .... .. 它可能看起来像 OpenFileDialog对象只是填充它，但它不是。在 OpenFileDialog 产生的第三个字符中，它是不同的，我无法弄清楚这个字节发生了什么......

我的问题是：有没有办法将 OpenFileDialog 框中突出显示的文件名视为 UTF-8？

我认为这无关紧要，但如果您需要知道，字符串是日文的..

谢谢，

克雷布

**更新**

首先，感谢所有在这里提出建议的人，非常感谢他们。

现在，要回答修改 C++ 应用程序以正确处理字符串的建议，这似乎不可行。对字符串执行此操作的不仅仅是一个应用程序。实际上，我的公司中有很多这样的应用程序需要我处理，这需要大量的人力和时间，而这根本不是可用的。但是，如果我要走这条路，sean e 的想法可能是最好的选择。

@Remy Lebeau：我想一针见血，我会尝试您提出的解决方案并报告回来.. :) 我想您的解决方案需要注意的是*默认*编码必须与 C# 应用程序环境中的默认编码相同创建文件的 C++ 应用程序环境，这当然是有意义的，因为它必须使用相同的代码页。

@Jeff Johnson：我没有将文件名从 C++ 应用程序粘贴到 C# 应用程序。我正在调用 OpenFileDialog.ShowDialog() 并在 DialogResult.OK 上获取 OpenFileDialog.FileNames 。我确实尝试使用 Encoding.UTF8。 GetBytes()，但就像 Remy Lebeau 指出的那样，它不起作用，因为原始的 UTF8 字节丢失了。

@其他人：感谢您的想法.. :)

克雷布

**更新**

@Remy Lebeau：你的想法很完美！只要 C++ 应用程序的环境与 C# 应用程序的环境相同（非 Unicode 程序的区域设置相同），我就能够检索正确的文本.. :)

现在我有更多的问题..哈哈..有没有办法确定字符串的编码？该代码现在适用于被错误解释为 ANSI 字符串的 UTF8 字符串，但会破坏 UCS-2 字符串。我需要能够确定编码并相应地处理每个。GetEncoding() 似乎没有用.. =/ StreamReader 的 CurrentEncoding 属性也不是（总是说 UTF-8）..

PS我应该在新帖子中打开这个新问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T21:58:08.933

0x201a 是 Unicode“低单逗号引号”字符。0x82 是该字符的 Latin-1（ISO-8859-1，Windows 代码页 1252）编码。这意味着文件名的字节被解释为普通的 Ansi 而不是 UTF-8，因此被相应地从 Ansi 解码为 Unicode。这并不奇怪，因为文件系统没有 UTF-8 的概念，而且 Windows 假定非 Unicode 文件名使用操作系统的默认 Ansi 编码。

要执行您要查找的内容，您需要访问原始 UTF-8 编码字节，以便正确解码它们。您可以尝试的一件事是将 FileName 传递给 System.Text.Encoding.Default 的 GetBytes() 方法（理论上，即使用与解码文件名相同的编码，因此它应该能够生成与原始字节相同），然后将生成的字节传递给 System.Text.Encoding.UTF8 的 GetString() 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T09:11:51.093

我认为你的问题是在开始：

> 我有一个 UTF-8 字符串，它正在由 C++ 中的非 Unicode 程序解释。这个文本显示不正确，但据我所知，它是完整的，然后作为输出文件名应用。

如果您使用非 unicode 程序加载 UTF-8 字符串然后对其进行序列化，它将包含非 unicode 字符。

您的 C++ 程序有什么方法可以处理 Unicode？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T09:37:43.973

您能否使用 System.Text 命名空间的成员（例如，UTF8Encoding 类）将 .NET 框架的内部字符串表示形式与包含您选择的编码中的文本的字节数组进行转换？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T15:40:26.317

如果您确定 C++ 输出正常，那么在您的 C# 应用程序中，您应该使用[.NET 编码类](http://msdn.microsoft.com/en-us/library/system.text.encoding.aspx)将其从 UTF-8 转换为 UTF-16 ，并以 Windows 本机格式使用它。

如果您可以修改 C++ 应用程序，那可能会更好 - 提供不需要重新编码的 C# 应用程序输入。其中，UTF8 到 Unicode 的转换可以通过[MultiByteToWideChar](http://msdn.microsoft.com/en-us/library/dd319072(VS.85).aspx)处理，使用 CP_UTF8 作为 CodePage 参数，但它仅在没有为 dwFlags 设置任何标志时才有效（为 dwFlags 指定 0）。整个应用程序不需要是 Unicode。即使它不是编译的 unicode，您也可以选择性地使用 Unicode API。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T16:38:30.697

回答您的问题“有没有办法将文件名视为 utf-8？” 试试这个代码：

```
 List<byte[]> utf8FileNames = new List<byte[]>();
    foreach (string fileName in openFileDialog1.FileNames)
    {
        utf8FileNames.Add(Encoding.UTF8.GetBytes(fileName));
    }
    // Each byte array in utf8FileNames is a sequence of utf-8 bytes matching each file name chosen 
```

从打开的文件对话框中获取文件名后，您将如何处理它们？您可以发布该代码吗？

# python - Django 开发附加组件

> ID：1016980
> 
> 赞同：6
> 
> 时间：2009-06-19T08:54:49.147
> 
> 标签：python, django

我遇到过各种[Django](http://en.wikipedia.org/wiki/Django_%28web_framework%29)开发插件，特别是，

*   [django 扩展](http://github.com/django-extensions/django-extensions/tree/master)

*   [django-烦人的](http://bitbucket.org/offline/django-annoying/)

*   [django-调试工具栏](http://github.com/robhudson/django-debug-toolbar/tree/master)

*   [django 工具](http://code.google.com/p/greatlemers-django-tools/)

我还没有完全使用所有这些。

我认为将 Django 的漂亮错误页面与 iPythonEmbed shell 相结合所获得的简单性和强大功能是难以超越的。

您使用这些或其他工具中的哪些进行开发，您从中受益的确切功能是什么？

也欢迎自行编写的命令和脚本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T13:41:58.863

I use [django-extensions](http://github.com/django-extensions/django-extensions/tree/master) in every project. There's a lot of stuff in there I never use, but it's worth it for the management commands [shell_plus](http://github.com/django-extensions/django-extensions/blob/ebf37ffb52e4d41c3c678c12dfb1138abdff1ea9/django_extensions/management/commands/shell_plus.py) and [runserver_plus](http://github.com/django-extensions/django-extensions/blob/ebf37ffb52e4d41c3c678c12dfb1138abdff1ea9/django_extensions/management/commands/runserver_plus.py) alone.

Shell_plus just autoloads all your models: a major timesaver (**EDIT**: forgot something equally important: it also makes use of [ipython](http://ipython.scipy.org/) if installed, for tab completion and other conveniences). Runserver_plus (requires Werkzeug) gives you an interactive 500 error debug page. You can jump into an AJAX console at any point in the traceback - brilliant.

The [print_user_for_session](http://github.com/django-extensions/django-extensions/blob/ebf37ffb52e4d41c3c678c12dfb1138abdff1ea9/django_extensions/management/commands/print_user_for_session.py) command is also handy if you get an error email off a live site and want to contact the user who experienced the error.

**update**: Django's built-in management shell also now uses IPython if available. And it's relatively easy to create an IPython user profile to auto-import models and anything else you want auto-imported. I no longer use django-extensions.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T09:06:24.147

我一方面喜欢[django-annoying](http://bitbucket.org/offline/django-annoying/)的`render_to`方法。

```
@render_to('template.html')
def foo(request):
    bar = Bar.objects.all() 
    return {'bar': bar}

# equivalent to
def foo(request):
    bar = Bar.objects.all() 
    return render_to_response('template.html',
                              {'bar': bar},
                              context_instance=RequestContext(request)) 
```

尽管我一直在查看 django-debug-toolbar，但我还没有使用过其他任何一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T13:30:00.447

I have found [django-logging](http://code.google.com/p/django-logging/wiki/Overview) to be a big help during development

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T14:42:46.620

```
from IPython.Shell import IPShellEmbed
ipshell = IPShellEmbed()

ipshell() # This call anywhere in your program will start IPython. 
```

这样，当您在视图中时，您可以进入那里的命令行并进行探索。无论如何，所有必需的模型都将被导入，并且很容易替换`shell_plus`. 对我来说，它甚至取代了`runserver_plus`of `django-command-extensions`。

（因为我发现我经常使用的不是一个普遍流行的想法，所以我自己回答了。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-22T13:12:30.567

试试[djangodevtools](http://os4d.org/djangodevtools)，包括命令`Alias`, `Coverage`, `itest`,`selenium`等。一些额外的命令非常酷！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-26T06:01:19.403

我们使用的最有用的 Django 开发插件是 [django-evolution](http://code.google.com/p/django-evolution/)。它是一种模式更新解决方案，可以从现有模型的更改中消除大量手动工作。它为我节省了无数小时的工作时间。

# delphi - 为什么我在 Indy Sockets 9 IdTcpServer ServerExecute 中出现 AccessViolation？

> ID：1016985
> 
> 赞同：0
> 
> 时间：2009-06-19T08:56:07.663
> 
> 标签：delphi, tcp, indy, access-violation

第一个问题：

以下例程是 Indy 9 IdTcpServer.OnExecute 例程的正确实现吗？

```
procedure TMyConnServer.ServerExecute(AContext: TIdPeerThread);
var
  buffSize: integer;
  str:      string;
begin
  AContext.Connection.ReadFromStack(True, 600, False);
  buffSize := AContext.Connection.InputBuffer.Size;
  if (buffSize > 0) then
    { Extract input buffer as string }
    str := AContext.Connection.ReadString(buffSize);

    { Notify connection object of received data }
    if (AContext.Data <> nil) then
    begin
      TConnectionHandler(AContext.Data).Read(str);
    end;
  end;
end; 
```

第二个（实际上更重要的）问题：

现在偶尔会出现访问冲突（从地址 000000 读取）。显然在这条线上：

```
 AContext.Connection.ReadFromStack(True, 600, False); 
```

但检查 AContext / Connection / InputBuffer / IOHandler = nil BEFORE 是否为假。调用之后（以及引发异常之后），IOHandler 为 nil。

我们正在使用 RAD Studio / Delphi 2007。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T12:25:29.940

好吧，我拥有的最简单的 onExecute 处理程序就是这样。（请原谅 C++ 而不是 Delphi，但你会明白的。

```
void __fastcall MyPanel::DoTCPExecute(TIdPeerThread * AThread)
{
  AnsiString text =AThread->Connection->ReadLn();
  // now do something with text
} 
```

我能看到的唯一明显的问题是你试图使用数据的“时间”来确定你什么时候有一个完整的字符串。这对 TCP 来说是一个真正的禁忌。您可能只有字符串的第一个字节，或者您可能同时发送了多个字符串。使用 TCP 并不能保证每个“发送”最终在另一端作为单个“接收”。

您需要以其他方式“分隔”您的字符串。Readln 使用换行符作为终止符——另一种方法是为每个数据块添加一个长度字段的前缀。您读取长度，然后读取剩余数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T13:08:39.290

代码就是这样工作的，但我认为这不是一个干净的选择：

```
 if (AContext.Connection.Connected) then
  begin
    try
      AContext.Connection.ReadFromStack(false, 1, false);
    except on E: EAccessViolation do
      // ignore
    end;
  end; 
  buffSize := AContext.Connection.InputBuffer.Size; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:16:23.983

IOHandler 可以像您描述的那样变为 nil 的唯一方法是，如果您的应用程序中的另一个线程在您的工作线程仍在运行时在连接上调用 Disconnect()。

# xsd - 在 XSD 模式中，如何说一个元素可能具有必须从某种类型继承的任意数量的子元素？

> ID：1016988
> 
> 赞同：5
> 
> 时间：2009-06-19T08:57:27.160
> 
> 标签：xsd

假设我在 XSD 中定义了这些类型：

```
<complexType name="NamedEntity">
    <attribute name="ix" type="positiveInteger"></attribute>
    <attribute name="sName" type="string"></attribute>
    <attribute name="txtDesc" type="string"></attribute>
</complexType>

<complexType name="Node">
    <complexContent>
        <extension base="tns:NamedEntity">
        </extension>
    </complexContent>
</complexType>

<complexType name="Source">
    <complexContent>
        <extension base="tns:NamedEntity">
            <attribute name="dt" type="dateTime"></attribute>
        </extension>
    </complexContent>
</complexType> 
```

现在我想表达一个`Node`元素可能有零个或多个子元素，它们的类型可能是`Node`or `Source`。

如果我必须以某种方式枚举子项的允许类型，那将是可以的，但由于我有更多继承自的类型，`NamedEntity`如果我可以只指定基本类型，那就太好了。

***编辑：****我宁愿不在`xsi:type`文档中使用，但在元素名称和类型之间有明确的关系。相当多的 XML 处理似乎依赖于此，而且我还发现它更具可读性。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T10:12:11.720

如果可以避免，请*不要*使用。`xsi:type`这是[邪恶](http://blog.whatfettle.com/2006/11/29/xsitype-is-evil/)的。好吧，也许我夸大了，但它确实使得在不熟悉架构的情况下解析文档是不可能*的*，这在实践中已经够糟糕的了。

对您*有*帮助的是：[`substitutionGroup`](http://www.xfront.com/ElementHierarchy.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T09:14:57.733

在架构中，让`Node`元素包含零个或多个 type 的子元素`NamedEntity`。在实际文档中，使用`xsi:type`属性 ( ) 为每个`xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"`选择子类型 (`"Node"`或)。`"Source"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T10:08:23.727

这*可能*超出了 XSD 的能力。您是否考虑过使用[Schematron](http://en.wikipedia.org/wiki/Schematron)进行额外验证？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T10:14:27.003

我想你想要一个[替代组](http://www.w3schools.com/Schema/schema_complex_subst.asp)。

# c# - 我可以将一个抽象类子类化，该抽象类具有另一个子类的抽象类吗？（C＃）

> ID：1016990
> 
> 赞同：1
> 
> 时间：2009-06-19T08:58:02.930
> 
> 标签：c#, oop

假设我想设计一个抽象系统来计算文档中的部分。我设计了两个类，*Document*和*Section*，文档有一个节列表和一个计算它们的方法。

```
public abstract class Document {
  List<Section> sections;

  public void addSection(Section section) { 
    sections.Add(section);
  }
  public int sectionCount() { 
    return sections.count;
  } 
}
public abstract class Section {
  public string Text;
} 
```

现在，我希望能够在多种场景中使用此代码。例如，我有带有章节的书籍。Book 是 Document 的子类，Chapter 是 Section 的子类。这两个类都将包含额外的字段和功能，与节数无关。

我现在偶然发现的问题是，因为 Document 包含部分，而不是 Chapters，所以 Chapter 的添加功能对我来说毫无用处，它只能*作为*部分添加到 Book。

我正在阅读有关垂头丧气的文章，但真的认为这不是正确的方法。我在想也许我完全采取了错误的方法。

我的问题是这样的：我如何设计这样一个抽象系统，可以被子类对象重用，这是要走的路吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T09:03:20.423

你需要泛型：

```
public abstract class Document<T> where T : Section

public abstract class Section

public class Book : Document<Chapter>

public class Chapter : Section 
```

您可能*还*想让一个部分知道它可以是哪种文档的一部分。不幸的是，这变得更加复杂：

```
public abstract class Document<TDocument, TSection>
    where TDocument : Document<TDocument, TSection>
    where TSection : Section<TDocument, TSection>

public abstract class Section<TDocument, TSection>
    where TDocument : Document<TDocument, TSection>
    where TSection : Section<TDocument, TSection>

public class Book : Document<Book, Chapter>

public class Chapter : Section<Book, Chapter> 
```

我不得不在 Protocol Buffers 中执行此操作，这很麻烦 - 但它确实允许您以强类型的方式引用这两种方式。如果您可以摆脱它，我会选择第一个版本。

# php - 在保留 DOM 的同时解析 XML 时如何获取详细的错误信息？

> ID：1016993
> 
> 赞同：2
> 
> 时间：2009-06-19T08:59:27.983
> 
> 标签：php, xml, domdocument

我正在构建一个 Web 表单，我的站点上的管理员可以在其中将 XML 添加到 textarea 并将其提交以存储在数据库表中，但我对解析 XML 的最佳方法有点困惑。

PHP 脚本需要解析 XML，如果有任何解析错误，它应该将错误消息和解析器停止的行/列返回给提交表单的管理员。解析之后，它需要访问 DOM 以使用 XPath 运行多个节点和属性的存在性检查。

如果我使用`xml_create_parser()`and `xml_parse()`，如果返回 false ，我可以获得详细的错误信息。但是，解析后我无法访问 XML 的 DOM。如果我使用`DOMDocument::loadXML()`，从我读过的内容来看，它不会为解析错误抛出异常，它只是将它们输出到 PHP 日志。

考虑到文件大多小于 10KB，少数为 10-20KB，如果我第一次尝试`xml_parse()`然后如果成功，运行会不会对性能造成很大的影响？`DOMDocument::loadXML()`有谁知道更好的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T09:02:11.270

您可以启用[libxml_use_internal_errors](http://php.net/libxml_use_internal_errors)然后 -if DOMDocument::load() failed- 使用[libxml_get_errors()查询详细的错误消息](http://php.net/libxml_get_errors)

```
<?php
$xml = '<a>
  <b>xyz</b>
  <c>
</a>';

libxml_use_internal_errors(true);
$doc = new DOMDocument;
if ( !$doc->loadxml($xml) ) {
  $errors = libxml_get_errors();
  var_dump($errors);
}
```

# smalltalk - 用数组初始化对象

> ID：1016996
> 
> 赞同：1
> 
> 时间：2009-06-19T09:00:15.970
> 
> 标签：smalltalk, squeak

我正在阅读（使用 Squeak）[发现更好的代码：Ron Jeffries 的 Smalltalk 系列保龄球](http://wiki.squeak.org/squeak/3501)，但我无法通过[第三篇](http://www.xprogramming.com/xpmag/BowlingForSmalltalkIII.htm)文章。

正在创建一个新类（称为 Frame），它在构造函数中将数组作为参数。

```
Frame class>>new: anArray
  ^self new setRolls: anArray

Frame>>setRolls: anArray
  rolls := anArray 
```

当我尝试在一个简单的测试中运行它时：

```
testFrame
  | frame rolls |
  rolls := Array with: 5 with: 4.
  frame := Frame new: rolls. 
```

我收到以下错误：

[替代文字 http://files.getdropbox.com/u/120566/junk/error.png](http://files.getdropbox.com/u/120566/junk/error.png)

我应该如何修改 #new 消息才能使用数组初始化 Frame 对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T12:28:42.787

我猜您未能将方法 new: 正确添加到 Frame 类。您确定将其放在类端（Frame class）而不是实例端（Frame）吗？为此，请在添加新方法之前单击“类”按钮：。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T16:31:56.200

你真的不想在`new:`这里覆盖。 `new:`传统上是为“创建一个这个整数大小的项目”保留的，我并不惊讶它会在你身上爆炸。

您想要的构造函数的一个更传统的名称是`fromArray:`，或者甚至`fromCollection:`可能会按照您的意愿工作。

# python - 从生成器生成

> ID：1016997
> 
> 赞同：2
> 
> 时间：2009-06-19T09:00:33.660
> 
> 标签：python, generator

我有一个生成器，它将一个数字作为参数并产生其他数字。我想使用这个生成器产生的数字并将它们作为参数传递给同一个生成器，创建一个一定长度的链。

例如，mygenerator(2) 产生 5、4 和 6。将 mygenerator 应用于这些数字中的每一个，一遍又一遍地应用于产生的数字。生成器总是产生比作为参数传递的更大的数字，并且对于 2 个不同的数字将永远不会产生相同的数字。

我的发电机（2）：4 5 我的发电机（4）：10 11 12 我的发电机（5）：9 300 500

所以集合 (9,10,11,12,300,500) 与原始数字 2 的“距离”为 2。如果我将其应用于数字 9，我将得到一组与原始数字 2 的距离为“3”的数字。

基本上我想要的是创建一个与给定数字具有指定距离的集合，但我在弄清楚如何在 Python 中做到这一点时遇到了问题。非常感谢帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T09:13:34.210

假设我们的生成器产生给定数字的正方形和立方体，它将输出唯一的，所以如果我们想在最简单的情况下获取 dist D 处的数字，我们可以递归地获取 dist D-1 处的数字，然后将生成器应用于它们

```
def mygen(N):
    yield N**2
    yield N**3

def getSet(N, dist):
    if dist == 0:
        return [N]

    numbers = []
    for n in getSet(N, dist-1):
        numbers += list(mygen(n))

    return numbers

print getSet(2,0)
print getSet(2,1)
print getSet(2,2)
print getSet(2,3) 
```

输出是

```
[2]
[4, 8]
[16, 64, 64, 512]
[256, 4096, 4096, 262144, 4096, 262144, 262144, 134217728] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T09:29:45.363

此解决方案不需要将所有结果保存在内存中：（以防它不适合内存等）

```
def grandKids(generation, kidsFunc, val):
  layer = [val]
  for i in xrange(generation):
    layer = itertools.chain.from_iterable(itertools.imap(kidsFunc, layer))
  return layer 
```

例子：

```
def kids(x): # children indices in a 1-based binary heap
  yield x*2
  yield x*2+1

>>> list(grandKids(3, kids, 2))
[16, 17, 18, 19, 20, 21, 22, 23] 
```

顺便说一句，Haskell 中的解决方案：

```
grandKids generation kidsFunc val =
  iterate (concatMap kidsFunc) [val] !! generation 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T09:06:58.840

我刚刚开始学习 Python，如果我的回答看起来有点业余，请多多包涵。您可以做的是使用列表列表来填充从 myGenerator 函数返回的值。

所以例如。以 2 作为起始参数，您的数据结构将类似于

```
resDataSet = [[2], 
              [4, 5],
              [9, 10, 11, 12, 300 , 500]
              ...
             ] 
```

行索引应该为您提供距离，您可以使用扩展等方法将更多数据添加到列表中。