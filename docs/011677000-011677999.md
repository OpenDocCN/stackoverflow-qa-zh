# StackOverflow 问答 11677000-11677999

# objective-c - 访问服务器端文本文件 Objective-C

> ID：11677000
> 
> 赞同：0
> 
> 时间：2012-07-26T19:52:11.233
> 
> 标签：objective-c, ios, xcode, share, fileserver

我正在尝试从内部网络上的共享驱动器中读取一个简单的文本文件。

```
NSString *filePath = @"/Users/myName/Desktop/App_Data/text.txt"; 

    NSFileManager *filemgr;

    filemgr = [NSFileManager defaultManager];

    if ([filemgr fileExistsAtPath:filePath] == YES)
        NSLog (@"File exists");
    else
        NSLog (@"File not found"); 
```

我的桌面上有一个名为 App_Data 的文件夹的快捷方式，该文件夹连接到服务器，但实际文件在服务器上，无法通过快捷方式文件夹访问该文件。我正在尝试使用 Objective-C 为 iPad 执行此操作。有没有更好的方法来访问服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:36:42.403

在机器上使用您要访问的文件运行 FTP 服务器，并从 iPad 创建到该文件的 FTP 连接。

这是一个来自 Apple 的“简单”FTP 示例[SimpleFTPSample](http://developer.apple.com/library/ios/#samplecode/SimpleFTPSample/Introduction/Intro.html)，它同时使用了 NSURLConnection 和 CFFTPStream API。

# jquery - jQuery彗星推送，没有彗星服务器

> ID：11677005
> 
> 赞同：0
> 
> 时间：2012-07-26T19:52:30.057
> 
> 标签：jquery, push-notification, prototype, server-push

`PUSH`当我的 mongodb 添加条目时，我想做的是通过 jQuery。我看到了很多 jQuery 插件，但他们`LONG POLLING`没有`PUSH`。

我很想知道这里是怎么发生[的](http://demo.hiteshjoshi.com/codeigniter_chat)（如果你打开两个不同的窗口并尝试聊天你就会知道）

这个人写了[这个示例代码](http://bit.ly/QeNEMK)。

他正在使用`prototype.js`，我在后端代码中看到，没有什么特别的。只是 MySQL select 语句，但每当 MySQL 数据库更改原型彗星对象时都会对此做出响应。

我们可以在 jQuery 中做类似的事情吗？我相信这不是投票，而是`PUSH`通过`prototype.js`.
或者它就像原型连接到套接字？抱歉，我不太了解套接字是什么，但是`PUSH`当我的 mongodb 添加条目时，我真正想做的是通过 jQuery。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-26T20:39:05.167

让我们一劳永逸地解决这个问题。由于我不是原型用户，因此我必须阅读文档才能提出这一点。

您可以从 JavaScript 控制台以这种方式访问​​底层[XMLHttpRequestRedirected 。](https://developer.mozilla.org/en/xmlhttprequest)

```
$ comet.ajax.transport.readyState
1 
```

`readyState`是`1`代表`OPENED`。

想测试一下吗？覆盖`XMLHttpRequestRedirected.onreadystatechanged`避免它重新连接（并保持打开等待。）

```
$ comet.ajax.transport.onreadystatechange = function(){
  console.log("Don't reconnect");
}; 
$ comet.ajax.transport.abort(); 
```

您将看到该`Don't reconnect`消息并且长轮询将停止。

现在尝试发送消息。什么都不会发生。

# database - 在 Access 2010 数据库中自动执行查询

> ID：11677007
> 
> 赞同：2
> 
> 时间：2012-07-26T19:52:39.787
> 
> 标签：database, ms-access, ms-access-2010

我在每晚运行的数据库中有 6 个查询，保存并发布文件以在其他地方使用。有谁知道我可以在哪里获得一些关于设置自动化的指导？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T03:21:29.530

3 个简单的步骤，无需编码：

1.  在 Access 中创建一个宏对象以运行所有 6 个查询。
2.  将宏对象拖放到桌面或 Windows 资源管理器中的任何文件夹。这将创建一个“可执行”快捷方式来打开数据库并运行宏。
3.  创建一个新的计划任务以启动快捷方式文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T22:03:01.333

1.  [在您的数据库中创建一个 autoexec 宏。](http://office.microsoft.com/en-us/access-help/create-a-macro-that-runs-when-you-open-a-database-HA010341574.aspx)
    这只是一个常规宏，但将其命名为“autoexec”会导致 Access 在您打开数据库时执行它（按 SHIFT 键可避免执行）。
    在宏中，您可以选择希望宏执行的操作。
    有一个运行查询的操作，以及一个关闭 Access 的操作。
    我从未在 Access 2010 中创建过宏，但在 Access 2003 中，这些操作被称为`OpenQuery`和`Quit`.
    --> 插入六个`OpenQuery`操作（每个查询一个）和一个`Quit`最后关闭 Access 的操作。

2.  使用 Windows 任务计划程序运行数据库。
    它将自动执行 autoexec 宏，它将运行您的所有查询并再次关闭 Access。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T19:55:14.890

您可以在 VBScript 中运行它们并将其设置为使用任务计划程序运行。或者，使用命令行开关启动数据库：/x 宏 ( [http://support.microsoft.com/kb/209207](http://support.microsoft.com/kb/209207) )

# c# - 水晶报表无法刷新数据

> ID：11677012
> 
> 赞同：1
> 
> 时间：2012-07-26T19:53:00.937
> 
> 标签：c#, crystal-reports

我正在使用 WPF 生成 Crystal Report 查看器，并且能够在报表查看器中加载数据。但是当我试图创建一个事件来动态刷新报表时，数据无法刷新。

基本上我所做的是创建一个与 MSSQL Server 连接的数据集![在此处输入图像描述](../Images/3b3a27ac02314e772ba50297fcaab518.png)

然后生成一个水晶报表文件：![在此处输入图像描述](../Images/dff140b051f85b0c41c201efe024cf79.png)

然后尝试将数据导入 MainWindow 中的 Crystal 报表查看器。这是代码：

```
public partial class MainWindow: Window
{
   DataSet1TableAdapters.BordierSheetTableAdapter TA = new      DataSet1TableAdapters.BordierSheetTableAdapter();
     ReportDocument reportDoc = new ReportDocument();
  public MainWindow()
    {
        InitializeComponent();
        Data_Binding();
    }
  public void button2_Click(object sender, RoutedEventArgs e) 
    {
       reportDoc.Refresh();
       crystalReportsViewer1.ViewerCore.RefreshReport();
    }
  void Data_Binding()
     {

         DataSet empDataSet = new DataSet();

         using (SqlConnection conn = new SqlConnection())
         {
             conn.ConnectionString = "Data Source=YATONGHOU\\SQLEXPRESS;Initial Catalog=messagedb;Integrated Security=True";
             conn.Open();

             string sqlStr = "select * from BordierSheet";
             SqlDataAdapter dataAdapter = new SqlDataAdapter(sqlStr,conn);

             dataAdapter.Fill(empDataSet, "BordierSheet");
         }

         string reportDataSource = @"C:\\Users\\yatong\\Work\\LogAnalytics\\BordierSheetReport\\BordierSheetReport\\CrystalReport1.rpt";

         reportDoc.Load(reportDataSource);
         reportDoc.SetDataSource(empDataSet);

         this.crystalReportsViewer1.ViewerCore.ReportSource = reportDoc;

     }
} 
```

当我更新我的数据库然后单击窗口中的按钮（触发 button2_Click(object sender, RoutedEventArgs e) 函数）时，没有更新任何数据。那么有人可以帮我解决这个问题吗？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-11T06:08:14.620

尝试这个：

```
reportDoc.Load(reportDataSource);
reportDoc.SetDataSource(empDataSet);
this.crystalReportsViewer1.ViewerCore.ReportSource = reportDoc;
crystalReportsViewer1.RefreshReport(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:11:34.317

Have you tried doing :

```
reportDoc.Refresh() 
```

after doing the data load?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-22T04:36:50.223

试试这个..这是工作！

转到 Crystal Report Design > File > 取消选中 Save Data with Report。

就是这样，然后再次保存..它将起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-21T14:38:43.043

删除数据源并重新添加，如：

```
 if ( reportViewer1.LocalReport.DataSources.Count > 0)
        reportViewer1.LocalReport.DataSources.RemoveAt(0);

  reportViewer1.LocalReport.DataSources.Add(new ReportDataSource()
{
            Name = "ds",
            Value = MyDataSource
   }); 
```

# .net - 如何对 JsonArray 进行排序

> ID：11677020
> 
> 赞同：2
> 
> 时间：2012-07-26T19:53:16.867
> 
> 标签：.net, asp.net-mvc-3, system.json

我们正在使用 System.JSON 来使用 api 调用，但似乎没有办法对数据进行排序。

在 C# ASP.NET 4 和 ASP.NET MVC 3 中运行。

以下是 out 数据调用的示例：

```
string requestURL = /*URL to the API*/;
    WebRequest request = HttpWebRequest.Create(requestURL);
    using (var response = request.GetResponse()) {
        return JsonObject.Load(response.GetResponseStream());
    } 
```

这个函数返回一个 JsonValue，它持有一个 JsonArray，这是我想要排序的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T06:40:19.787

您还没有展示您的 JSON 的外观，也没有展示您想要订购的属性。假设您有以下 JSON：

```
[
    {
        "Id": 1,
        "Text": "item 1"
    },
    {
        "Id": 2,
        "Text": "item 2"
    },
    {
        "Id": 3,
        "Text": "item 3"
    },
    {
        "Id": 4,
        "Text": "item 4"
    },
    {
        "Id": 5,
        "Text": "item 5"
    }
] 
```

并且您想按 Id 属性按降序排序。例如，可以这样做：

```
class Program
{
    static void Main(string[] args)
    {
        string requestURL = "/URL to the API/";
        WebRequest request = HttpWebRequest.Create(requestURL);
        using (var response = request.GetResponse()) 
        {
            var result = JsonArray.Load(response.GetResponseStream());
            var orderedResult = result.OrderByDescending(x => x.Value["Id"].ReadAs<int>());
            foreach (var item in orderedResult)
            {
                Console.WriteLine("{0} : {1}", item.Value["Id"], item.Value["Text"]);
            }
        }
    }
} 
```

# javascript - 如何访问特定列中的表格单元格以转换格式

> ID：11677027
> 
> 赞同：-1
> 
> 时间：2012-07-26T19:53:58.880
> 
> 标签：javascript

我从 AJAX 查询中得到了这样的字符串：

> var ansverStr = "[1,\"贝德福德街\",\"牛津马戏团、格林公园或威斯敏斯特\",\"15\",\"摄政街\",1343329406000]\r\n[1,\" Bedford Street\",\"Oxford Circus, Green Park or Westminster\",\"13\",\"Golders Green\",1343329883000]\r\n[1,\"Bedford Street\",\"Oxford Circus , Green Park or Westminster\",\"176\",\"Tottenham Ct Rd\",1343329612000]\r\n[1,\"Bedford Street\",\"Oxford Circus, Green Park or Westminster\", \"91\",\"Trafalgar Sq\",1343329514000]\r\n[1,\"Bedford Street\",\"Oxford Circus, Green Park or Westminster\",\"11\",\"Fulham百老汇\",1343329434000]\r\n[1,\"贝德福德街\",\"牛津马戏团,格林公园或威斯敏斯特\",\"87\",\"Wandsworth\",1343330102000]\r\n[1,\"贝德福德街\",\"牛津马戏团、格林公园或威斯敏斯特\",\"6 \",\"Willesden Gar\",1343329673000]\r\n[1,\"Bedford Street\",\"Oxford Circus, Green Park or Westminster\",\"91\",\"Trafalgar Sq\" ,1343329871000]\r\n[1,\"Bedford Street\",\"Oxford Circus, Green Park or Westminster\",\"11\",\"Fulham Broadway\",1343329743000]"格林公园或威斯敏斯特\",\"91\",\"特拉法加广场\",1343329871000]\r\n[1,\"贝德福德街\",\"牛津马戏团,格林公园或威斯敏斯特\",\" 11\",\"富勒姆百老汇\",1343329743000]"格林公园或威斯敏斯特\",\"91\",\"特拉法加广场\",1343329871000]\r\n[1,\"贝德福德街\",\"牛津马戏团,格林公园或威斯敏斯特\",\" 11\",\"富勒姆百老汇\",1343329743000]"

然后为它创建了一个动态表

> 变量元素；
> 
> element = '' + ansverStr.split('\r\n').map(function(line){ return '' + JSON.parse(line).map(function(cell){ return '' + cell + '' ; }).join('') + ''; }).join('') + ''; document.getElementById("bStop").innerHTML=element;

ansverStr 子字符串中的最后一个字段是时间。

**问题：如何访问动态表中的这些值以将它们转换为时间格式**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:59:54.940

使用正确的 Json 格式将使检索结果变得非常简单[http://jsfiddle.net/wzBFC/1/](http://jsfiddle.net/wzBFC/1/)

```
var myJSONObject = {"results": [
     {"street_number": 1,"street":"Bedford Street","city":"Oxford Circus, Green Park or Westminster","address2":"15","street2":"Regent  Street","timestamp":1343329406000},
     {"street_number": 1,"street":"Bedford Street","city":"Oxford Circus, Green Park or Westminster","address2":"15","street2":"Regent  Street","timestamp":1343329407000}
     ] };    

     timeStamp = new Date(myJSONObject.results[1].timestamp);    
     alert(timeStamp); 
```

# java - Java 堆/池大小

> ID：11677028
> 
> 赞同：0
> 
> 时间：2012-07-26T19:54:04.323
> 
> 标签：java, garbage-collection, jvm, jvm-hotspot, jvm-arguments

当我启动 JVM 时，它至少会保留 {{xms}} 内存，对吗？这意味着这个内存对于 JVM 进程是私有的（它是 malloced），是吗？当 JVM 需要在保留（mallocs）更多内存时增加堆。但是多少钱？我不相信它的储备完全符合它的需要，可能有一定的步长（池？）大小。

如何配置这个“步长”？

在达到 {{xmx}} 并抛出 OOM 之前，所有这一切都会发生，对吧？

JVM什么时候启动GC？不是涉及到 xml，而是涉及到保留的堆大小（这个池的顶部）？

如果是这样，最好将 xms 设置为接近 xmx 以防止许多无用的 GC。我将拥有一个巨大的 GC 而不是许多小的 GC，每个 GC 的错误都会冻结我的 JVM，所以最好有一个，对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:05:08.383

> 当 JVM 需要在保留（mallocs）更多内存时增加堆。但是多少钱？

你不应该真的在乎。它只是*工作*。许多建议使用 equal `Xmx`，`Xms`以便 JVM 在启动时分配所有内存。这是合理的，请进一步阅读。

> 如何配置这个“步长”？

它不能，它完全是实现并且可能依赖于操作系统。

> JVM什么时候启动GC？不是涉及到 xml，而是涉及到保留的堆大小（这个池的顶部）？

GC 比你想象的要复杂一些。*当年轻代*被填满时执行 Minor GC 。*Major GC 称为老年代*没有剩余空间。

> 在达到 {{xmx}} 并抛出 OOM 之前，所有这一切都会发生，对吧？

不，当`Xmx`达到时，JVM 会稳定下来，不会发生任何错误。`OutOfMemoryError`在 GC 之后立即抛出，JVM 无法为新对象找到足够的空间（这是一个主要的简化）。

> 如果是这样，最好将 xms 设置为接近 xmx 以防止许多无用的 GC。

再次，您必须了解 GC 的工作原理。使用`Xmx`equal to`Xms`是一个不错的选择，因为它可以在应用程序运行时避免不必要的分配（一切都发生在启动时，没有进一步的开销）。GC与此无关。

> 而不是很多小错误，每次 GC 都会冻结我的 JVM，所以最好有一个，对吧？

没有。Minor GC 通常需要几十毫秒并且几乎是不可见的，除非您在实时系统上工作。Major (stop-the-world) GC 可能需要几秒钟，并且对于最终用户来说肯定是显而易见的。在正确调整的 JVM 中，主要 GC 应该很少发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:03:57.637

您对开关的含义是正确的。

我记得开关的方式是

xm* *s* * = 以 "s" 结尾，如 "* *s* *tarting memory"。

xm* *x* * = 以“x”结尾，例如“ma* *x* *imum memory”

由给定的 JVM 决定如何从起始内存移动到最大内存。假设这两者不是很接近，分配将在我知道的所有 JVM 上逐步进行。

我不知道有任何选项可以控制任何 JVM 中的步骤大小。当然没有标准选项。

不同的 JVM 有不同的 GC 策略。一些 JVM 允许您使用由命令行开关控制的多种 GC 策略之一。

# java - 在方法/函数中使用 Class 变量会创建对源的引用而不是重复它？

> ID：11677029
> 
> 赞同：0
> 
> 时间：2012-07-26T19:54:04.200
> 
> 标签：java, android, class

我在问我是否创建了一个自定义类对象，其中包含 100 个整数值。

如果我将该变量传递给包含相同类型的对象的方法，我只是传递对源对象的引用，我不会复制这 100 个变量，对吗？

```
 class BigClass {
    int A;
    int B;
    ...
  }

   BigClass ThisClass = new BigClass();

   private void DoSomething(BigClass b) {
          BigClass ThatClass = b; 
   }

   **************

   DoSomething(ThisClass); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T19:59:22.917

正确，只是对您的类实例的引用将被传递/复制。不会复制您班级的实际内容。

[请参阅 Jon Skeet 关于Java 中的参数传递](http://www.yoda.arachsys.com/java/passing.html)的文章，它很好地解释了一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T19:59:54.840

那是对的。当您将对象传递给另一个类时，您只是传递了对它的引用。

# javascript - 使用 jquery.each() 循环创建对象键

> ID：11677033
> 
> 赞同：6
> 
> 时间：2012-07-26T19:54:22.950
> 
> 标签：javascript, jquery, undefined

我在 javascript 中创建一个命名空间来循环一个表单并创建一个对象。调用该函数的目标是遍历所有特定的表单类型并构造一个对象，该对象的键是 html 输入的名称，值是其当前值。但是，它一直返回未定义。

任何帮助将不胜感激：

```
get_form_data.radio = function(container) { //will return the value 
    var data = {}; //function data object to return
    container.find('input[type="radio"]:checked').each(function() {

        var current_object = {}; //loop temporary object
        var current = $(this); //current element
        var current_key = current.attr('name'); //property category
        var current_value = current.attr('value'); //value to update the database with
        current_object[current_key] = current_value; //temporary object
        console.log(current_object.length); //RETURNS UNDEFINED
        $.extend(data, current_object);

    });

    console.log(data.length); //returns undefined
    return data;
}​ 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T19:59:37.413

你想从电话中得到`var current_object = {};`声明`.each()`。函数的每次迭代都会`.each()`重新声明它，并有效地删除它。并且忘记`$.extend()`为好。

```
var data = {};
container.find('input[type="radio"]:checked').each(function() {
    data[this.name] = this.value;
});
return data; 
```

尽管通过快速浏览您当前的代码，但未经测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T19:57:49.487

您需要指定键和索引值，例如：

```
array.each(function(index, value) { 
  alert(index + ': ' + value); 
}); 
```

在你的情况下：

```
get_form_data.radio = function(container) { //will return the value 
    var data = {}; //function data object to return
    container.find('input[type="radio"]:checked').each(function(index,value) {

        var current_object = {}; //loop temporary object
        var current = value; //current element
        var current_key = current.attr('name'); //property category
        var current_value = current.attr('value'); //value to update the database with
        current_object[current_key] = current_value; //temporary object
        console.log(current_object.length); //RETURNS UNDEFINED
        $.extend(data, current_object);

    });

    console.log(data.length); //returns undefined
    return data;
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T04:07:49.473

通过查看全局范围解决了问题。上面的代码似乎有效，但我的全局命名空间`current = $(this)`在每个循环和 this.data 中令人困惑，这是表单数据的全局对象。

这是我的 form_submit 命名空间：

```
this.data = {};

this.property_status = function() {

        var property_status = {};

        this.container.children('form').each(function() {
            var current = $(this);
            property_status[current.attr('data-property_id')] = get_form_data.radio(current);
        });

        $.extend(this.data, property_status);
    }; 
```

和 get_form_data 命名空间：

```
 get_form_data.radio = function(container) {//will return the value 

    var form_data = {};//function data object to return

    container.find('input[type="radio"]:checked').each(function() {

        form_data[this.name] = this.value;
    });

    return form_data;
} 
```

关于优化这个有什么建议吗？

# java - 将套接字对象传递给 Android 上的另一个活动

> ID：11677034
> 
> 赞同：2
> 
> 时间：2012-07-26T19:54:24.710
> 
> 标签：java, android, eclipse, sockets

并提前感谢您的帮助。

在 Android 中的活动之间传递对象的最佳做法是什么？我读到了将可序列化对象作为字符串传递的可能性，方法是通过 putExtras 将它们添加到包中，而不是用它开始下一个意图。但是 Socket 是可序列化的吗？

我想在主要活动打开连接和输入/输出流之后传递 Socket 、 PrintWriter 、 BufferedReader 的实例，因此下一个意图可以关闭等。

我还想知道是否还有其他/更好的选择可以考虑，因为我想有。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:08:30.827

您必须使用公共静态变量或使用单例模式的包装类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-02T20:24:26.827

如果您不想启动服务，您可以创建一个全局变量。

为该套接字创建一个单例模式，如下所示：

```
public class SocketSingleton {

private static Socket socket;

public static void setSocket(Socket socketpass){
    SocketSingleton.socket=socketpass;
}

public static Socket getSocket(){
    return SocketSingleton.socket;
    //return socket;
} 
```

}

然后在代码中更改全局值：

```
 public void changeScreen(Socket socket, String ip, int port) {
        SocketSingleton.setSocket(socket);
        Intent i = new Intent(getActivity().getApplicationContext(), ControlActivity.class);
        i.putExtra("ip", ip);
        i.putExtra("port",port);
        startActivity(i);
    } 
```

# mysql - 我无法在山狮上运行 rake db:create

> ID：11677041
> 
> 赞同：1
> 
> 时间：2012-07-26T19:54:56.990
> 
> 标签：mysql, ruby-on-rails, ruby, macos, osx-mountain-lion

我已经将我的 OSX 更新为山狮和我的 mysql 了。所以现在我无法运行任何 db rake 命令...

```
diego@diego-imac vanilla (work) $ rake db:create

(in /Users/diego/Documents/v2v/projects/vanilla)
Couldn't create database for {"encoding"=>"utf8", "username"=>"root", "adapter"=>"mysql", "database"=>"v2v_vanilla_dev", "password"=>nil}, charset: utf8, collation: utf8_unicode_ci (if you set the charset manually, make sure you have a matching collation) 
```

我在网上找到了很多解决方案，但没有一个能解决我的问题。谁能帮我？

谢谢

一些信息：

> 服务器版本：5.1.60 MySQL 社区服务器（GPL）

```
mysql (2.8.1)
    Author: TOMITA Masahiro
    Rubyforge: http://rubyforge.org/projects/mysql-win
    Homepage: http://mysql-win.rubyforge.org
    Installed at: /Users/diego/.rvm/gems/ruby-1.8.7-p352@v2v

    This is the MySQL API module for Ruby 
```

> 导轨 (2.3.11)
> 
> diego@diego-imac vanilla (work) $ which mysql /usr/local/mysql/bin/mysql

```
diego@diego-imac local (master) $ ls -lha | grep mysql 

lrwxr-xr-x   1 root   wheel    24B 26 Jul 15:31 mysql -> mysql-5.1.60-osx10.6-x86
drwxr-xr-x  16 root   wheel   544B 29 Out  2011 mysql-5.1.60-osx10.6-x86 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:46:46.650

确保更新后 MySql 仍在运行：单击系统偏好设置 -> 其他 -> MySql 或仅在终端中运行：

```
ps ax|grep mysqld|grep -v grep 
```

（输出不应为空）。

如有必要，运行它（使用首选项或`sudo /usr/local/mysql/bin/mysqld_safe`终端中的开始按钮）。

# cocoa - NSWindowController 的窗口立即释放

> ID：11677043
> 
> 赞同：3
> 
> 时间：2012-07-26T19:55:13.977
> 
> 标签：cocoa, osx-lion, automatic-ref-counting, nswindowcontroller

我正在尝试在我的应用程序委托中使用 NSWindowController 打开一个窗口。我创建了一个带有关联 NIB 的基本 NSWindowController 并尝试以这种方式显示窗口：

```
@implementation MyAppDelegate
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Show the main window from a separate nib
    MyWindowController * theWindowController = [[MyWindowController alloc] initWithWindowNibName:@"MyWindowController"];
    [theWindowController showWindow:self];
}
@end 
```

当我启动应用程序时，MyWindowController 的窗口只出现几分之一秒（似乎一启动就被释放）。

使用 ARC，我怎么能强迫窗户粘在周围而不是马上被冲走？我不使用 NSDocuments，我希望能够同时使用其中的许多 MyWindowController。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T19:59:47.320

您需要向您的应用程序委托（或将在您的应用程序的整个生命周期中保留的其他对象）添加一个保留 WindowConroller 的属性。例如：

```
@interface MyAppDelegate : NSObject

@property (strong, nonatomic) MyWindowController * windowController;

@end 
```

然后在初始化窗口控制器时设置此属性。

```
@implementation MyAppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Show the main window from a separate nib
    self.windowController = [[MyWindowController alloc] initWithWindowNibName:@"MyWindowController"];
    [theWindowController showWindow:self];
}

@end 
```

# c - C 链接器的行为很奇怪，给出了不应该解决的外部问题

> ID：11677050
> 
> 赞同：0
> 
> 时间：2012-07-26T19:55:32.470
> 
> 标签：c, visual-studio-2010

我在链接程序时遇到问题，奇怪的是链接器无法解析的函数位于同一个文件中，靠近已解决且没有问题的函数。

我不能在消息中自己发布文件，因为它们非常大，尽管 ===>[这里](https://docs.google.com/open?id=0ByVHzYDa6azxYlVxR0FpdVFheHM)<=== 是准备构建的项目。

以下是构建错误：

```
error LNK2019: unresolved external symbol _leveldb_filterpolicy_destroy referenced in function _main
error LNK2019: unresolved external symbol _leveldb_options_set_filter_policy referenced in function _main
error LNK2019: unresolved external symbol _leveldb_filterpolicy_create_bloom referenced in function _main
error LNK2019: unresolved external symbol _leveldb_filterpolicy_create referenced in function _main
error LNK2019: unresolved external symbol _leveldb_filterpolicy_create referenced in function _main 
```

[这](https://i.stack.imgur.com/iEz76.png)是显示错误消息的全尺寸屏幕截图 ![在此处输入图像描述](../Images/036675e0395fa4c3a4ff8d8cb3a8320b.png)

[下面](https://i.stack.imgur.com/zbkrh.png)是找不到的函数的实现： ![在此处输入图像描述](../Images/a02225d9307ac0b4411e205b0334c189.png)

[这](https://i.stack.imgur.com/CMZh2.png)是位于同一文件中的函数的实现，链接器很容易找到： ![在此处输入图像描述](../Images/c99841622813c74876d1c59aed9b6b1e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:34:01.657

我找到了导致问题的原因，我已将 leveldb 的版本更新为较新的版本。较新的版本引入了几个新功能（尚未解决的功能）。但是我没有更新包含所有导出的 .def 文件，因此没有导出函数......

# eclipse - Eclipse 项目导入/导出问题

> ID：11677057
> 
> 赞同：1
> 
> 时间：2012-07-26T19:55:57.353
> 
> 标签：eclipse

我正在尝试将项目导入 Eclipse。我第一次导入工作区。然后它有一个关于`.classpath`只读的错误。

所以我决定不导入我的工作区，而是访问它在 svn 上的位置。所以我试图删除它。

现在，当我从另一个位置导入时，它说它无法完成，因为它存在于工作区中。这个日食问题以前在我身上发生过很多次。我现在需要手动从工作区中删除文件吗？

现在更疯狂的是，导入项目对话框无法关闭！它导入了一个平板电脑项目，现在说必须单击取消（已经完成）。日食团队一路走好！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:25:38.870

看起来您的 Eclipse 没有为您的项目进行彻底删除。在尝试再次导入之前，关闭（或终止）Eclipse 并转到此文件夹：

```
<workspace>\.metadata\.plugins\org.eclipse.core.resources\.projects 
```

从上一个项目中查找一个文件夹（应该具有相同的名称）。如果有，请删除它。还要从工作区本身删除项目的任何剩余部分，然后再次尝试导入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:01:00.923

是的。当您从 Eclipse 中删除项目时，您可以选择从工作区目录中删除文件。默认情况下，它不被选中。

# javascript - 在 Visual Studio 中调试 Javascript

> ID：11677060
> 
> 赞同：-3
> 
> 时间：2012-07-26T19:56:06.897
> 
> 标签：javascript, asp.net

以下 Javascript 在我的 Visual Studio 中的 aspx.cs 中，我已经添加了一个新脚本，但我不确定我的脚本是否正常工作..所以有人可以告诉我如何调试以下代码……

```
 sb.AppendFormat("function chkQuoteBinderValidUntilDateOverridden_OnClick()", this.chkQuoteBinderValidUntilDateOverridden.ClientID);
            sb.AppendLine("{");
            sb.AppendLine("    var chkQuoteBinderValidUntilDateOverridden = document.getElementById('" + chkQuoteBinderValidUntilDateOverridden.ClientID + "');");
            sb.AppendLine("    var wdcQuoteBinderValidUntilDate = document.getElementById('" + wdcQuoteBinderValidUntilDate.ClientID + "');");
            sb.AppendLine("    var wdcQuoteBinderValidUntilDate_input = document.getElementById('" + wdcQuoteBinderValidUntilDate.ClientID + "_input');");
            sb.AppendLine("    var wdcQuoteBinderValidUntilDate_container = document.getElementById('" + wdcQuoteBinderValidUntilDate.ClientID + "_container');");
            sb.AppendLine("    var wdcQuoteBinderValidUntilDate_img = document.getElementById('" + wdcQuoteBinderValidUntilDate.ClientID + "_img');");
            sb.AppendLine("    var wdcQBValidUntilDate = igdrp_getComboById('" + this.wdcQuoteBinderValidUntilDate.ClientID + "');");
            sb.AppendLine("    var hiddenWDCQBValidUntilDate = document.getElementById('" + this.HiddenWDCQuoteBinderValidUntilDate.ClientID + "');");
            sb.AppendLine("    var hiddenQBValidUntilDate = new Date(hiddenWDCQBValidUntilDate.value);");
            sb.AppendLine("    if(chkQuoteBinderValidUntilDateOverridden.checked == true) {");
            sb.AppendLine("        setDateChooserDisabled(wdcQuoteBinderValidUntilDate,false);");
            sb.AppendLine("        wdcQuoteBinderValidUntilDate_img.setAttribute('src', wdcEnabledImageUrl);");
            sb.AppendLine("    }");
            sb.AppendLine("    else {");
            sb.AppendLine("    var now = new Date();");
            sb.AppendLine("        setDateChooserDisabled(wdcQuoteBinderValidUntilDate,true);");
            sb.AppendLine("        wdcQuoteBinderValidUntilDate_img.setAttribute('src', wdcDisabledImageUrl);");
            sb.AppendLine("        if(hiddenQBValidUntilDate) {");            
            sb.AppendLine("             wdcQBValidUntilDate.setValue(hiddenQBValidUntilDate);");
            sb.AppendLine("             if (lblQuoteBinderExpiresIn == null) {");
            sb.AppendLine("                     lblQuoteBinderExpiresIn = document.getElementById('" + lblQuoteBinderExpiresIn.ClientID + "');");
            sb.AppendLine("             }");
            sb.AppendLine("             dif = ((hiddenQBValidUntilDate - now)/(86400*1000));");
            sb.AppendLine("             dif = (dif - ( dif % 1 )) + 1;");
            sb.AppendLine("             lblQuoteBinderExpiresIn.innerText = '(' + dif.toString() + ' days)';");
            sb.AppendLine("         }");
            sb.AppendLine("    }");
            sb.AppendLine("}");

            sb.AppendLine("function wdcQuoteBinderValidUntilDate_OnBlur(oDateChooser , dummy, oEvent) {");
            sb.AppendLine("    var now = new Date();");
            sb.AppendLine("    var wdcQuoteBinderValidUntilDate = oDateChooser.getValue();");                       
            sb.AppendLine("    if (lblQuoteBinderExpiresIn == null) {");
            sb.AppendLine("    lblQuoteBinderExpiresIn = document.getElementById('" + lblQuoteBinderExpiresIn.ClientID + "');");
            sb.AppendLine("    }");
            sb.AppendLine("    if(wdcQuoteBinderValidUntilDate != null)  {"); 
            sb.AppendLine("         dif = ((wdcQuoteBinderValidUntilDate - now)/(86400*1000));");
            sb.AppendLine("         dif = (dif - ( dif % 1 )) + 1;");
            sb.AppendLine("         lblQuoteBinderExpiresIn.style.visibility = 'visible';");
            sb.AppendLine("         lblQuoteBinderExpiresIn.innerText = '(' + dif.toString() + ' days)';");
            sb.AppendLine("    }");
            sb.AppendLine("    else {");
            sb.AppendLine("         lblQuoteBinderExpiresIn.style.visibility = 'hidden';");
            sb.AppendLine("    }");
            sb.AppendLine("}");

            sb.AppendLine("function wdcQuoteBinderValidUntilDate_CalendarValueChanged(oCalendar, oDate, oEvent) {");
            sb.AppendLine("    var now = new Date();");
            sb.AppendLine("    if (lblQuoteBinderExpiresIn == null) {");
            sb.AppendLine("        lblQuoteBinderExpiresIn = document.getElementById('" + lblQuoteBinderExpiresIn.ClientID + "');");
            sb.AppendLine("    }");
            sb.AppendLine("    dif = ((oDate - now)/(86400*1000));");
            sb.AppendLine("    dif = (dif - ( dif % 1 )) + 1;");
            sb.AppendLine("    lblQuoteBinderExpiresIn.innerText = '(' + dif.toString() + ' days)';");
            sb.AppendLine("}");

            sb.AppendLine("function colInsuredState_OnChange(isNewYork) {");
            sb.AppendLine("    var chkNewYorkFreeTradeZone = document.getElementById('" + chkNewYorkFreeTradeZone.ClientID + "');");
            sb.AppendLine("    var lblNewYorkFreeTradeZone = document.getElementById('" + lblNewYorkFreeTradeZone.ClientID + "');");
            sb.AppendLine("    var ddlPolicyType = document.getElementById('" + ddlPolicyType.ClientID + "');");
            sb.AppendLine("    var txtClassCode = document.getElementById('" + txtClassCode.ClientID + "');");
            sb.AppendLine("    var lnkClassCodePrompt = document.getElementById('" + lnkClassCodePrompt.ClientID + "');");
            sb.AppendLine("    var policyTypeId = ddlPolicyType.value;");
            sb.AppendLine("");
            sb.AppendLine("    if(isNewYork) {");
            sb.AppendLine("        chkNewYorkFreeTradeZone.style.visibility = 'visible';");
            sb.AppendLine("        chkNewYorkFreeTradeZone.checked = false;");
            sb.AppendLine("        lblNewYorkFreeTradeZone.style.visibility = 'visible';");
            sb.AppendLine("        txtClassCode.style.visibility = 'visible';");
            sb.AppendLine("        txtClassCode.disabled = false;");
            sb.AppendLine("        lnkClassCodePrompt.disabled = false;");
            sb.AppendLine("        lnkClassCodePrompt.style.visibility = 'visible';");
            sb.AppendLine("        if(policyTypeId == " + (int)Model.REF.EnumPolicyTypes.ENODPL + " ) {");
            sb.AppendLine("             chkNewYorkFreeTradeZone.checked = true;");
            sb.AppendLine("             chkNewYorkFreeTradeZone.disabled = true;");
            sb.AppendLine("             }");
            sb.AppendLine("    }");
            sb.AppendLine("    else {");
            sb.AppendLine("        chkNewYorkFreeTradeZone.parentElement.style.visibility = 'hidden';");
            sb.AppendLine("        chkNewYorkFreeTradeZone.style.visibility = 'hidden';");
            sb.AppendLine("        chkNewYorkFreeTradeZone.checked = false;");
            sb.AppendLine("        lblNewYorkFreeTradeZone.style.visibility = 'hidden';");
            sb.AppendLine("        txtClassCode.value = '';");
            sb.AppendLine("        txtClassCode.disabled = true;");
            sb.AppendLine("        txtClassCode.style.visibility = 'hidden';");
            sb.AppendLine("        lnkClassCodePrompt.disabled = true;");
            sb.AppendLine("        lnkClassCodePrompt.style.visibility = 'hidden';");
            sb.AppendLine("    }");
            sb.AppendLine("");
            sb.AppendLine("}"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:24:21.453

1.  在 Internet Explorer 中：工具 -> Internet 选项 -> 高级

    取消选中“禁用脚本调试（Internet Explorer）”
    取消选中“禁用脚本调试（其他）”

2.  在你的 JavaScript 脚本的任何地方，添加这个：`debugger;`

3.  运行项目并使用 Internet Explorer 打开网页，当提示调试页面时单击是，将打开另一个 VS 实例进行调试：

    ![在此处输入图像描述](../Images/a8a453f7441bfce52039b679cc3fe3f6.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T19:59:07.743

使用 Firefox 和[Firebug](http://getfirebug.com/)插件轻松调试您的 JavaScript。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:04:13.620

您可以直接在 VS2008 及更高版本中调试 javascript，但您必须使用 Internet Explorer 作为默认浏览器进行调试。
如果 IE 当前不是您的默认浏览器，请右键单击解决方案资源管理器中的文件，选择“浏览方式...”，选择 Internet Explorer 并单击“设置为默认值”。现在当你开始在 VS 中调试时，会弹出 IE 并命中 javascript 中的断点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T20:07:08.977

这只是一个字符串。您不能从视觉 sutdio 调试字符串。string is string :) 您可以在浏览器上使用以下工具进行调试、监视、添加断点等

1.  火狐——萤火虫
2.  IE - 开发者工具(F12)
3.  Chrome - 开发者工具

# php - 直接访问PHP文件下载

> ID：11677061
> 
> 赞同：0
> 
> 时间：2012-07-26T19:56:08.697
> 
> 标签：php, .htaccess, download

我非常清楚 PHP 是一种服务器端语言，因此不应允许下载 php 文件。但是，在 Chrome 中直接访问 PHP 文件时，它会下载文件的混淆版本，这是我想阻止的。有没有办法阻止文件被提供？

**代码如下。**
该系统在 WordPress 中运行完美，但如果我打开 Chrome（我想是其他人）并直接访问 update.php 文件，它会下载。

值得注意的是，我试图回显一个 HTML 页面，但它扰乱了系统的工作方式。我希望对此有某种 .htaccess 技巧。

```
if (isset($_POST['action'])) {
  switch ($_POST['action']) {
    case 'version':
      echo '1.1';
      break;
    case 'info':
      $obj = new stdClass();
      $obj->slug = 'plugin.php';
      $obj->plugin_name = 'plugin.php';
      $obj->new_version = '1.1';
      $obj->requires = '3.0';
      $obj->tested = '3.3.1';
      $obj->downloaded = 12540;
      $obj->last_updated = '2012-01-12';
      $obj->sections = array(
        'description' => 'The new version of the Auto-Update plugin',
        'another_section' => 'This is another section',
        'changelog' => 'Some new features'
      );
      $obj->download_link = 'http://localhost/update.php';
      echo serialize($obj);
    case 'license':
      echo 'false';
      break;
  }
} else {
    header('Cache-Control: public');
    header('Content-Description: File Transfer');
    header('Content-Type: application/zip');
    readfile('update.zip');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:00:43.313

您的代码，如果没有收到`$_POST['action']`，则发送`update.zip`到浏览器`else`。

不是通过 POST 访问文件时看到的不是混淆的 PHP。相反，它将文件的内容发送`update.zip`到浏览器以供下载。但是由于代码没有在标题中提供文件名提示，所以它不会出现`update.zip`，而是可能看起来像一个与您的脚本同名的 .php 文件。

如果您想`update.zip`看起来像一个 zip 文件，`filename`请在`Content-Disposition`输出标头中添加一个：

```
header('Cache-Control: public');
header('Content-Description: File Transfer');

// Change to attachment disposition, with filename
header('Content-Disposition: attachment; filename=update.zip');
header('Content-Type: application/zip');
readfile('update.zip'); 
```

现在，如果您*根本不*希望它发送，请从底部`update.zip`删除整个`else {}`块，并将其替换为类似

```
else {
  echo "You must supply an action...";
} 
```

### 更新：限制仅访问推荐人`wp_autoupdate.php`

咨询`$_SERVER['HTTP_REFERRER']`，但知道这个值可以被欺骗。这不能以 100% 的可靠性使用。

```
if (strpos($_SERVER['HTTP_REFERER'], 'wp_autoupdate.php') !== FALSE) {
  // Include all your exsiting code
}
else {
  // Don't do anything, or redirect somewhere else
  header("Location: /");
  exit();
} 
```

要实现 100% 的可靠性，您可能需要修改`wp_autoupdate.php`以设置会话变量，然后由 进行检查`update.php`，确保请求来自正确的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:00:46.713

您将内容类型设置为 application/zip，在大多数浏览器中都会提示下载。您是否有可能没有通过 POST 传递“动作”，这就是为什么它会触及 else 部分？

我看到的另一件事是你没有

```
break; 
```

在您的第二个开关/案例中。

```
 $obj->download_link = 'http://localhost/update.php';
      echo serialize($obj);
      break;  // <------ this is missing!
    case 'license':
      echo 'false';
      break; 
```

* * *

您是否查看过这篇文章： http: [//konstruktors.com/blog/wordpress/2538-automatic-updates-for-plugins-and-themes-hosted-outside-wordpress-extend/](http://konstruktors.com/blog/wordpress/2538-automatic-updates-for-plugins-and-themes-hosted-outside-wordpress-extend/)

* * *

关于将文件的访问权限限制为除 WordPress 之外的所有人，不知道您是否托管 WordPress 网站。如果这样做，您可以在 .htaccess 文件中限制对 localhost 或 127.0.0.1 的访问。如果它托管在 WordPress.com 上，您可以找到他们的 IP 或主机名并进行更改。

```
<Files update.php>
    Order allow,deny
    Deny from all
    Allow from 127.0.0.1
</Files> 
```

# c# - 嵌入滚动查看器时，文本框当前行不可见

> ID：11677063
> 
> 赞同：0
> 
> 时间：2012-07-26T19:56:17.383
> 
> 标签：c#, textbox, silverlight-5.0

我有一个用于文本输入的`TextBox`内部 a 。`ChildWindow`当文本不适合在里面时，我无法让文本框滚动，所以我将它包裹在一个`ScrollViewer`

```
 <ScrollViewer Height="200" VerticalScrollBarVisibility="Auto">
        <TextBox Name="TaskDescription" AcceptsReturn="True"></TextBox>
    </ScrollViewer> 
```

当文本框已满时，它会滚动，这是预期的。但是，我没有看到当前编辑的行。 ![在此处输入图像描述](../Images/786fb6e6eacc39aad254be0746750291.png)

我阅读了有关制作`ScrollViewer`自动滚动的文章，但这将使我的`TextBox`滚动到最后，这将不允许在中间的某个地方编辑文本，因为一旦键入一个键，它就会跳到最后。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:05:24.977

ScrollViewer 正在尝试适应文本框的大小，该大小正在增加。不使用滚动查看器并让文本框在需要时自然放置滚动条的更好选择。什么都不应该做，所以文本框。

# c++ - 如何使用 fftw 包编写函数来计算模板 (T) 和 2D 图像 (imin) 之间的 2D 卷积？

> ID：11677068
> 
> 赞同：0
> 
> 时间：2012-07-26T19:56:40.250
> 
> 标签：c++, image-processing, signal-processing, fft, fftw

我正在做一个项目，其中有一个小模板（T）和一个图像（imin）。目的是使用沿 fft 的卷积来找到 imin 中最相似模式的位置。为此，我想在 C++ 中使用 FFTW 代码。但是，我是 C++ 新手，不知道我应该如何使用这个工具箱来实现这个目标。

* * *

谢谢保罗。实际上，我想将 FFT 用于我的 3D 案例，其中我有一个大的 3D 矩阵并希望与一个小的 3D 矩阵匹配。这就是我想使用 FFT 的原因。既然我应该尽快完成，你知道任何用于此目的的 C++ 代码吗？2D 和 3D（通过 FFT）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:04:04.583

我相信除了上一篇文章中概述的步骤之外，您还必须确保在计算 FFT 之前移动内核，否则结果中会出现一半内核大小的位移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T08:06:45.217

与其使用 FFTW，不如考虑使用[OpenCV](http://opencv.willowgarage.com/wiki/)，它通常是用于计算机视觉和图像处理的更高级别的 API，并且比从 FFT 等低级构建块构建自己的例程更容易使用。OpenCV 已经有一个模板匹配函数[cvMatchTemplate](http://opencv.willowgarage.com/documentation/c/object_detection.html)，它可以在需要的地方“在后台”使用高效的 FFT 实现，因此性能应该不是问题。

如果您确实必须使用 FFTW，那么请准备好大量阅读文档和最初陡峭的学习曲线。互相关的步骤（我假设这是您要用于模板匹配的步骤）通常是：

*   为更大的图像尺寸创建正向/反向 FFT 计划
*   使用前向 FFT 计划对目标图像进行 FFT
*   用零将模板图像填充到目标图像的大小
*   使用前向 FFT 计划对填充模板图像进行 FFT
*   采用填充图像模板 FFT 输出的复共轭
*   将目标图像 FFT 输出乘以填充图像模板 FFT 输出的复共轭
*   使用反向 FFT 计划对产品进行 IFFT

然后，您可以检查一个或多个峰值的结果，该峰值应对应于目标图像中模板图像的位置。

请注意，为了获得更好的结果，您应该考虑使用*归一化*互相关，但这在频域中实现起来相当复杂。

# python - 将空字典作为关键字参数传递是否总是安全的？

> ID：11677071
> 
> 赞同：4
> 
> 时间：2012-07-26T19:56:56.403
> 
> 标签：python, argument-passing

是否有任何情况

```
f(arg1, arg2..., argN) 
```

工作并产生结果

```
f(arg1, arg2..., argN, **{} ) 
```

产生不同的结果，还是导致错误？

我假设 a`**kwds`还没有出现在参数列表中。

上下文是我正在编写一个函子，它包含一个函数，它是以后评估的参数，并且想要支持可选关键字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T19:58:55.513

是的，这样做总是安全的。这两个调用是完全等价的，函数`f()`没有办法区分它们（当然自省源代码除外）。

# c++ - 连接 const char * 字符串

> ID：11677074
> 
> 赞同：1
> 
> 时间：2012-07-26T19:57:08.353
> 
> 标签：c++, string, char, constants, concatenation

我对`char *`和感到困惑`const char *`。在我的示例中，我不确定如何将它们组合在一起。我有几个`const char *`字符串要连接到最终`const char *`字符串。

```
struct MyException : public std::exception
{
  const char *source;
  int number;
  const char *cause;

  MyException(const char *s, int n)
      : source(s), number(n) {}
  MyException(const char *s, const char *c)
      : source(s), number(0), cause(c) {}

  const char *what() const throw()
  {
    if (number != 0) {
      char buffer[1024];
      // why does this not work?
      cause = strerror_r(number, buffer, 1024);
    }

    // how to concatenate the strings?
    return source + ": " + cause;
  }
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:07:06.150

您可以存储 a`std::string`并仍然`const char *`从您的 what 函数返回 a。

```
struct MyException : public std::exception
{
private:
  std::string message;  

public:    
  MyException(const char *s, int n) {
    char buffer[1024];
    strerror_r(n, buffer, 1024);
    message.reserve(strlen(s) + 2 + strlen(buffer));
    message = s;
    message += ": ";
    message += buffer;
  }

  MyException(const char *s, const char *c) {
    message.reserve(strlen(s) + 2 + strlen(c));
    message = s;
    message += ": ";
    message += c;
  }

  const char *what() const throw()
  {
    return message.c_str();
  }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:09:48.197

这就是我实现它的方式：

```
struct MyException : public std::exception
{
public:
  const char *source;
  int number;
  const char *cause;
private:
  char buffer[1024]; // #1
  std::string message; // #2

  std::string build_message() {
    if (number != 0) {
      cause = strerror_r(number, buffer, 1024); // use the member buffer
    }
    std::string s; // #3
    s.reserve(strlen(source) + 2 + strlen(cause));
    return s + source + ": " + cause;
  }

public:
  MyException(const char *s, int n)
      : source(s), number(n), cause(), message(build_message()) {}
  MyException(const char *s, const char *c)
      : source(s), number(0), cause(c), message(build_message()) {}

  const char *what() const throw()
  {
    return message.c_str(); // #4
  }
}; 
```

注意事项：

1.  原始代码使用*局部变量*作为缓冲区。这是一个坏主意，因为存储在其中的指针将在`cause`作用域[结束时无效](https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope/6445794#6445794)。

2.  对于级联消息，将需要动态分配。这也意味着需要清理该存储。我抓住了一个现有的工具，它可以做到这一点并提供类似字符串的操作：`std::string`.

3.  `std::string`可以使用操作`+`符进行连接。请注意我如何要求它为预期大小保留内存。这是内存优化，不是必需的：无论哪种方式，字符串都会分配足够的内存。

4.  `what`不能抛出异常，否则`std::unexpected`会出现调用。所以这里不能分配字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T20:03:52.283

只需使用**string.h**`strcat()`中的`strcpy()`函数。

 **[http://www.cplusplus.com/reference/clibrary/cstring/strcat/](http://www.cplusplus.com/reference/clibrary/cstring/strcat/) http://www.cplusplus.com/reference/clibrary/cstring/strcpy/

此外，由于您不必修改原始字符串，因此`const char*`和之间的区别`char*`并不重要。

也不要忘记`malloc()`（保留空间）所需大小的目标字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T20:08:48.493

如果您必须使用`char*`指针，您将需要使用`strcat`. `strcat`接受两个参数 a`char*`和 a`const char*`并将指向的字符串附加`const char*`到`char*`. 这意味着您首先需要复制您的第一个字符串。

你会想做这样的事情：

```
char* Concatenate(const char* first, const char* second)
{
  char* mixed = new char[strlen(first) + strlen(second) + 2 /* for the ': ' */ + 1 /* for the NULL */];
  strcpy(mixed, first);
  strcat(mixed, ": ");
  strcat(mixed, second);

  return mixed;
} 
```

这不只是丑陋吗？而且，请记住，因为您已经动态分配了该函数返回的 char*，所以调用者必须记住`delete[]`它。这种丑陋和确保调用者以正确方式清理的需要是为什么最好使用字符串实现，例如`std::string`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T20:06:21.680

分配一个大小的缓冲区`strlen(source) + strlen(cause) + 3`并用于`sprintf`创建您的消息。实际上，您可以将此代码移至构造函数，以便`what`成为简单的 getter。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T20:08:29.923

如果你真的必须使用 c 字符串，你应该考虑`strcat()`将它们连接在一起。但是，由于您正在创建自定义异常，因此考虑使用它是合理的，`std::string`因为它在 C++ 中使用更友好。**

# c# - 什么.net版本VS2005用于C#项目

> ID：11677076
> 
> 赞同：2
> 
> 时间：2012-07-26T19:57:09.477
> 
> 标签：c#, .net, visual-studio

我正在将一个基于 VS2008 构建的项目移植到 VS2005，因为我们的次要 .NET 版本必须是 2.0 而不是 3.5，并且我们的其余代码是在 VS2005 上构建的。所以我在 .sln 文件中修改了 Visual Studio 版本从 2008 到 2005

```
Microsoft Visual Studio Solution File, Format Version 9.00
# Visual Studio 2005 
```

所以我可以将 .sln 加载到 VS2005 中。我有一些构建问题，主要是“var”，在我用真实数据类型修改这些行之后，代码编译并运行。

但是在项目程序集参考。我发现我的代码仍然是来自 .NET 3.5 的引用 Linq：

```
C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v3.5\System.Xml.Linq.dll 
```

当我打开对话框添加新引用时，我可以看到 .NET 版本 2.0、3.5 甚至 4.0（尽管在大多数情况下 CLR 运行时版本是 2.0.50727。有时是 1.x，有时是 4.0，Linq 的运行时版本是 2.0.50727）。

我认为 VS2005 仅支持 .NET 2.0，但在这里似乎并非如此。所以我想我怎样才能确保我的应用程序只需要 .NET 2.0 框架。确保我只参考 .NET 2.0 及以下参考就足够了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:00:15.543

只要目标框架是 .NET 2.0**并且**您不引用任何针对更高 .NET 框架版本的库，您的应用程序应该可以在 .NET 2.0 上正常运行*。*

也就是说，我相信 Visual Studio 2008 支持多目标，因此您应该能够使用 VS2008，但仍将 .NET 2.0 作为您的输出类型。此外，VS2010 和 VS2012RC 还支持仅 .NET 2.0 的项目。

为了回答标题中的确切问题（为了那些通过标题找到此页面的人的利益），Visual Studio 2005 中默认使用的 .NET 版本是 .NET v2.0。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T20:00:24.140

您仍然可以使用 VS2008。VS2008 完全支持 2.0-only 项目（只需更改项目设置）。在 2.0 模式下，VS 将禁用任何 3.0 和 3.5 程序集以及任何依赖于 3.0 或 3.5 库类的 C# 语言功能（例如扩展方法，但有一种解决方法可以让那些使用 2.0 的程序集）。

我会说 VS2010 也支持 2.0-only 项目。

# java - 使用 Java 应用程序从 iPhone 到 PC 的传感器数据

> ID：11677077
> 
> 赞同：1
> 
> 时间：2012-07-26T19:57:15.793
> 
> 标签：java, string, user-interface, numbers, sensors

我找到了一个名为“SensorLogger”的 iPhone 应用程序，它可以记录大多数 iPhone 传感器的数据，然后通过电子邮件发送它们，但它也可以使用 UDP 数据包通过网络广播它，这是代码（Java ）我用来接收该数据：

```
import java.io.*;
import java.net.*;

public class Main {
    public static void main(String[] args) throws UnknownHostException, SocketException, IOException {
        DatagramSocket socket = new DatagramSocket(5555, InetAddress.getByName("0.0.0.0"));
        byte[] buf = new byte[64];
        DatagramPacket packet = new DatagramPacket(buf, buf.length);
        while (true) {
            socket.receive(packet);
            String data = new String(packet.getData());
            System.out.println(java.util.Arrays.toString(data.split(",")));
        }
    }
} 
```

它运行良好，这是 iPhone 上运行的应用程序的输出：

```
[1343331999601, 4, 0.0013, -0.0049, -0.00237]
[1343331999636, 4, -0.0024, 0.0049, -0.00477]
[1343331999670, 4, -0.0073, 0.0073, -0.00377]
[1343331999704, 4, -0.0036, 0.0024, -0.00247] 
```

第一个数字有点像时间戳，但我不知道这些数字是什么意思，它与 iPhone 上的日期/时间不匹配……第二个数字表示使用的传感器，1 是 GPS 位置， 2是指南针，3是加速度计，4是陀螺仪。最后的数字是来自传感器的值（由第二个数字定义）。现在，我想做一个小型 GUI 应用程序，它会以更用户友好的方式显示所有这些值……但是，这是我第一次用 Java 编程，我不知道该怎么做……可以任何人都请发送示例代码，以便我了解如何执行此操作并为所有值重复该操作。

谢谢，祝大家有个愉快的一天。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:46:35.307

问题解决了，我终于使用了这段代码：

```
import java.io.*;
import java.net.*;
import java.util.*;

public class Main {
    public static void main(String[] args) throws UnknownHostException, SocketException, IOException {
        DatagramSocket socket = new DatagramSocket(5555, InetAddress.getByName("0.0.0.0"));
        byte[] buf = new byte[64];
        DatagramPacket packet = new DatagramPacket(buf, buf.length);
        while (true) {
            socket.receive(packet);
            String data = new String(packet.getData());
            String[] dataParsed = data.split(",");
            float timestamp = Float.parseFloat(dataParsed[0]);
            float sensortype = Float.parseFloat(dataParsed[1]);
            float x = Float.parseFloat(dataParsed[2]);
            float y = Float.parseFloat(dataParsed[3]);
            float z = Float.parseFloat(dataParsed[4]);
            String sensorname = new String();
            if (sensortype == 1) {
                sensorname = "GPS";
            }
            else if (sensortype == 2) {
                sensorname = "Magnetometer";
            }
            else if (sensortype == 3) {
                sensorname = "Accelerometer";
            }
            else if (sensortype == 4) {
                sensorname = "Gyroscope";
            }
            else if (true) {
                sensorname = "Unknown";
            }
            Date date = new Date();String line = ("Timestamp " + timestamp + ", local date " + date.toString() + ", sensor " + sensorname + ", x " + x + ", y " + y + ", z " + z);
            System.out.println(line);

        }
    }
} 
```

# android - 传感器功率/通知率问题

> ID：11677084
> 
> 赞同：1
> 
> 时间：2012-07-26T19:57:51.317
> 
> 标签：android

我正在编写一个扩展 SensorEventListener 接口的应用程序，以监听气压计的变化，我将其登录到日志文件中。在开始记录之前，我以毫秒为单位添加一个系统时间（我们称之为毫秒时间戳 1，或 MT1），在记录完成后，我附加另一个以毫秒为单位的系统时间戳（我们称之为毫秒时间戳 2，或 MT2）。

SensorEvent 在 MT1 和 MT2 之间有自己的时间戳（我将其称为纳秒时间戳或 NT），我也记录了该时间戳。

问题是这样的：如果手机在记录期间进入睡眠状态，SensorEvent 速率似乎不再以我设置的速率发生（例如，SENSOR_DELAY_FASTEST）。此外，即使 SensorEvent 时间戳应该代表手机重启后的正常运行时间的纳秒，也存在“缺失”纳秒——MT2 和 MT1 之间的时间间隔通常是 NTN 之间的两倍或更多（其中 N 是样本数）和 NT1。

我已经能够通过使用 PowerManager.Wakelock() 来解决这个问题，但这会导致我的应用程序成为一个巨大的耗电者，并且看起来像是一个非常笨拙的黑客攻击。有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:12:17.770

如果设备进入睡眠状态，或者即使屏幕关闭（但 CPU 不一定还没有断电），传感器也不能保证工作。该行为未记录在案，并且肯定似乎因设备而异。

要么满足于成为“耗电大户”，要么重新设计你的应用程序，使其不需要传感器读数，除非屏幕打开。

Android 中的传感器绝对是为前台应用程序主动使用而设计的，而不是用于长期记录或监控目的。

# iphone - 将 NSString 从一个 ViewController 传递到另一个 VC NSMutableArray

> ID：11677085
> 
> 赞同：0
> 
> 时间：2012-07-26T19:57:51.613
> 
> 标签：iphone, objective-c, ios, xcode, nsmutablearray

我是一名初级 iOS 开发人员，我想了解 NSMutableArray 的想法。具体来说，我想将 NSString 值从一个 VC 传递给属于另一个视图控制器的 NSMutableArray。我还希望 NSMutableArray 在其视图上填充 UITableView。任何想法如何做到这一点？例如，我有用户从第一个视图中触发的这个动作

```
- (IBAction)addToFav:(id)sender {  
} 
```

我想将 NSString myBookString 的值传递给第二个视图中的 NSMutableArray 数组。任务相当简单，但我不太明白为什么不能将值传递给 NSMutableArray，而不是`- (void)insertObject:(id)anObject atIndex:(NSUInteger)index`Apple 参考文档中提到的这种方法。提前致谢！

编辑：我的观点是同时属于 UITabBar 和 UINavigationController 的不同 VC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:11:17.560

您需要两个控制器之间的通信。有几种解决方案。选择以下之一。我推荐代理。

来自[http://www.hollance.com/](http://www.hollance.com/)

当你有两个对象 A 和 B，比如两个视图控制器，你想互相交谈时，你可以从以下选项中进行选择：

NS通知中心。

*   这是匿名的一对多通信。对象 A 向 NSNotificationCenter 发布通知，然后将其分发给侦听该通知的任何其他对象，包括对象 B。A 和 B 不必相互了解任何信息，因此这是一种非常松散的耦合。也许有点太松了……</li>

KVO（键值观察）。

*   一个对象观察另一个对象的属性。这是一个非常紧密的耦合，因为现在对象 B 可以直接窥视对象 A。KVO 的优点是对象 A 根本不需要意识到这一点，因此不需要发送任何通知—— KVO 机制在幕后处理这个问题。

直接指针。

*   对象 A 有一个指向对象 B 的指针，并在感兴趣的事情发生时直接向它发送消息。这是可能的最紧密耦合，因为 A 和 B 不能在没有彼此的情况下运行。对于视图控制器，您通常希望避免这种情况。

代表们

*   对象 B 是对象 A 的委托。在这种情况下，对象 A 对对象 B 一无所知。它只知道某个对象执行其委托的角色，它会愉快地向该委托发送消息，但它不知道知道——或者关心——这是对象 B。委托模式通常是在视图控制器之间进行通信的首选方式，但它需要一些工作来设置。

块。

*   基本上与委托相同的方法，除了对象 B 现在给对象 A 一个或多个块（闭包）以在某些事件发生时执行。没有正式的委托协议，对象 A 看到的对象 B 的唯一内容就是它被赋予的块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:04:10.960

NSMutableArray 就是这样，一个标准的可变数组实现。它具有您期望从任何其他语言/框架中获得的所有功能。[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html)。

向数组添加元素的方式有什么问题？`[array addObject:object]`如果您不介意将其添加到尾部，您也可以这样做。

要回答您的其余问题，有很多方法可以将数据从一个控制器传输到另一个控制器。您的导航是如何设置的？您使用的是 UITabBarController 还是 UINavigationController？这些观点如何相互关联？如果它们是嵌套的，您可以将数据直接从一个传递到另一个。如果没有，您可以使用类似于您的应用程序委托的东西来保存数据并传递它。

# java - 如何在java中将wav文件从一个目录复制到另一个目录？

> ID：11677087
> 
> 赞同：0
> 
> 时间：2012-07-26T19:57:54.887
> 
> 标签：java, copy, wav, jsch

在我的程序中，我使用了 JSch 包文档中[一个示例](http://www.jcraft.com/jsch/examples/ScpFrom.java.html)的改编版本，该包描述了如何将文件从远程服务器复制到本地计算机。尽管该程序似乎可以运行，但文件似乎在复制过程中已损坏，当我尝试从 bash 播放它们时，我收到一条错误消息，显示为“播放失败格式：无法打开输入文件 `79_97_729.wav' ：WAVE：未找到 RIFF 标头”。

我的复制方法如下：

```
public void copyFile(File file, String newName) throws JSchException, IOException{

    String prefix = null;
    if (new File(destination).isDirectory()){
        prefix = destination + File.separator;
    }

    JSch jsch = new JSch();
    Session session = jsch.getSession("username", "network");
    session.setUserInfo(new MyUserInfo());
    session.connect();

    String command = "scp -f " + file.getAbsolutePath();
    Channel channel = session.openChannel("exec");
    ((ChannelExec)channel).setCommand(command);

    OutputStream out = channel.getOutputStream();
    InputStream in = channel.getInputStream();

    channel.connect();

    byte[] buf = new byte[1024];

    // send '\0'
    buf[0]=0; out.write(buf, 0, 1); out.flush();

    while(true){
        int c=checkAck(in);
        if(c!='C'){
            break;
        }

        // read '0644 '
        in.read(buf, 0, 5);

        long filesize=0L;
        while(true){
            if(in.read(buf, 0, 1)<0){
                // error
                break;
            }
            if(buf[0]==' ')break;
            filesize=filesize*10L+(long)(buf[0]-'0');
        }

        // send '\0'
        buf[0]=0; out.write(buf, 0, 1); out.flush();

        // read a content of lfile
        fos=new FileOutputStream(prefix == null ? destination : prefix + newName);
        int foo;
        while(true){
            if(buf.length<filesize) foo=buf.length;
            else foo=(int)filesize;
            foo=in.read(buf, 0, foo);
            if(foo<0){
                // error
                break;
            }
            fos.write(buf, 0, foo);
            filesize-=foo;
            if(filesize==0L) break;
        }
        fos.close();
        fos=null;

        // send '\0'
        buf[0]=0; out.write(buf, 0, 1); out.flush();
    }

    session.disconnect();
} 
```

我可以做一些调整来控制我正在复制的文件是 wav 格式的事实吗？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:03:23.947

这就是我使用的：

```
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.regex.Pattern;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.jcraft.jsch.Channel;
import com.jcraft.jsch.ChannelExec;
import com.jcraft.jsch.JSchException;
import com.jcraft.jsch.Session;

public class Scp {
    private static final Logger log = LoggerFactory.getLogger( Scp.class );
    private static final Pattern validMode = Pattern.compile( "^[0-8]{3,4}$" );
    private Session session;
    private String message;
    private String mode = "0664";
    private int bufferSize = 1024;

    public Scp( Session session ) {
        log.trace( "creating scp object" );
        this.session = session;
    }

    public String getMessage() {
        return message;
    }

    public String getMode() {
        return mode;
    }

    public int send( String localPath, String remotePath )
            throws JSchException, IOException {
        log.trace( "copying '{}' to '{}'", localPath, remotePath );
        int ack = 0;

        Channel channel = null;
        try {
            channel = session.openChannel( "exec" );
            ((ChannelExec) channel).setCommand( new StringBuilder( "scp -p -t " )
                    .append( remotePath ).toString() );
            OutputStream channelOut = channel.getOutputStream();
            InputStream channelIn = channel.getInputStream();

            channel.connect();

            if ( (ack = checkAck( channelIn )) != 0 ) return ack;

            File localFile = new File( localPath );
            channelOut.write( new StringBuilder( "C" )
                    .append( mode )
                    .append( " " )
                    .append( localFile.length() )
                    .append( " " )
                    .append( localFile.getName() )
                    .append( "\n" )
                    .toString().getBytes() );
            channelOut.flush();

            if ( (ack = checkAck( channelIn )) != 0 ) return ack;

            FileInputStream fileIn = new FileInputStream( localFile );
            try {
                byte[] buffer = new byte[bufferSize];
                int bytesRead;
                while ( (bytesRead = fileIn.read( buffer, 0, bufferSize )) >= 0 ) {
                    channelOut.write( buffer, 0, bytesRead );
                }

                // finish the stream by writing a null terminator
                buffer[0] = 0;
                channelOut.write( buffer, 0, 1 );
                channelOut.flush();
            }
            finally {
                if ( fileIn != null ) {
                    try {
                        fileIn.close();
                    }
                    catch ( Exception e ) {
                        log.warn( "failed to close filehandle: {}", e );
                    }
                }
                fileIn = null;
            }

            if ( (ack = checkAck( channelIn )) != 0 ) return ack;
        }
        finally {
            if ( channel != null && channel.isConnected() ) {
                channel.disconnect();
            }
        }

        message = "success";
        return ack;
    }

    private int checkAck( InputStream in ) throws IOException {
        int b = in.read();

        if ( b == 1 || b == 2 ) {
            StringBuilder builder = new StringBuilder();
            int c;
            while ( (c = in.read()) != '\n' ) {
                builder.append( (char) c );
            }
            message = builder.toString();
        }

        return b;
    }

    public void setBufferSize( int bufferSize ) {
        this.bufferSize = bufferSize;
    }

    /**
     * Sets the mode of the destination file. By default, it is 0664.
     * 
     * @param mode
     *            The mode to set the destination file to.
     */
    public void setMode( String mode ) {
        if ( !validMode.matcher( mode ).matches() ) {
            throw new IllegalArgumentException( "invalid mode, must be 3 or 4 octal numbers (/^[0-8]{3,4}$/)" );
        }
        this.mode = (mode.length() == 3) ? ("0" + mode) : mode;
    }
} 
```

它可以可靠地传输所有类型的媒体。

**- - - - - 编辑 - - - - -**

这是一个单元测试，证明这适用于 wav 文件：

```
import static org.junit.Assert.assertTrue;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.security.NoSuchAlgorithmException;
import java.util.Arrays;

import javax.crypto.NoSuchPaddingException;

import org.junit.Test;
import org.mitre.asias.sch.Scp;

import com.jcraft.jsch.JSch;
import com.jcraft.jsch.JSchException;
import com.jcraft.jsch.Session;

public class ScpTest {
    @Test
    public void testScpWav() throws JSchException, IOException, NoSuchAlgorithmException, NoSuchPaddingException {
        String dotSshDir = "C:/Cygwin/home/me/.ssh";
        JSch jsch = new JSch();
        jsch.setKnownHosts( dotSshDir + "/known_hosts" );
        jsch.addIdentity( dotSshDir + "/id_dsa" );

        Session session = jsch.getSession( "me", "localhost" );
        session.connect();

        Scp scp = new Scp( session );
        scp.send( "data/SpeechOn.wav", "/tmp/" );

        assertTrue( Arrays.equals( readFileFully( "data/SpeechOn.wav" ), readFileFully( "C:/Cygwin/tmp/SpeechOn.wav" ) ) );
    }

    public byte[] readFileFully( String fileName ) throws IOException {
        InputStream is = null;
        try {
            is = new FileInputStream( new File( fileName ) );
            ByteArrayOutputStream buffer = new ByteArrayOutputStream();

            int nRead;
            byte[] data = new byte[16384];

            while ( (nRead = is.read( data, 0, data.length )) != -1 ) {
                buffer.write( data, 0, nRead );
            }

            buffer.flush();

            return buffer.toByteArray();
        }
        finally {
            if ( is != null ) {
                is.close();
            }
        }

    }
} 
```

您应该能够在修改源/目标文件的位置时对这个单元测试进行修改，`dotSshDir`并且它应该可以工作。它对我有用。

# xcode - 在 xcode 4.3.3 中是否有在 Organizer 和 IDE 之间切换的键盘快捷键？

> ID：11677090
> 
> 赞同：0
> 
> 时间：2012-07-26T19:58:08.893
> 
> 标签：xcode, ide

我是 Mac 新手.. 我已经弄清楚应用程序之间的命令+tab 切换.. 但是两个月后，我还没有弄清楚如何在 Organizer 和 IDE 之间切换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:07:34.530

您可以使用 (command-shift-2) 启动管理器和 (command-w) 关闭任何活动窗口。然后，您可以使用 (command-`)<-tilde 如上所述在 OS X 中任何打开的应用程序（包括 Xcode）中的活动窗口之间切换。

# facebook - 集成社交网络登录，但使用现有凭据进行身份验证

> ID：11677095
> 
> 赞同：0
> 
> 时间：2012-07-26T19:58:43.500
> 
> 标签：facebook

我们正在寻求将 Facebook、Google、Twitter 整合到现有网站中。

与大多数实现不同，用户必须是能够使用 Facebook、Google 等登录之前的客户。当前的数据库设计如下；

`userid | username | password | customerno`

所以这个想法是，如果用户决定使用 Facebook 登录，我们需要使用他们的字母数字客户编号来验证他们也是现有客户。一旦通过身份验证，他们就不再需要使用他们的客户编号进行身份验证。如果他们还不是客户，他们首先需要在我们这里创建一个帐户。

1.  我需要为每个提供者设计一个新表吗？如果是这样，设计应该是什么样子？
2.  如何验证已使用 Facebook 登录并使用其现有客户编号的用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:59:11.913

> 如何验证已使用 Facebook 登录并使用其现有客户编号的用户？

这取决于您必须将某人视为客户的标准......</p>

恕我直言，将 Facebook 用户连接到其他页面上的现有帐户的最佳和最简单的方法是电子邮件地址。如果您没有，并且没有其他可靠的方法可以使用 Facebook 可以提供的数据将某人识别为客户，那么也许您可以在连接他们的 Facebook 帐户之前在您的网站上向用户*询问他们的客户 ID。*

至于您的数据库设计——如果您在每次连接/登录时阅读电子邮件地址，那么您只需查找它即可找到您的用户 ID。否则，您可以在现有的用户表中添加额外的字段，在其中保存某人的 Facebook/Google/... 用户 ID。但是如果你想使用多个服务，也许最好把这些数据放到第二个表中，比如

```
userid | foreign_user_id | type 
```

其中 type 将是“facebook”、“google”等之一，以识别 foreign_user_id 来自的登录提供程序。

# assembly - 如何解密此加密例程？

> ID：11677101
> 
> 赞同：-4
> 
> 时间：2012-07-26T19:59:18.383
> 
> 标签：assembly

有谁知道如何解密以下加密例程？基本上我有一个加密密钥，我输入它，然后我被要求输入一个 6 个字母的单词，然后被加密。我该如何解密这个？谢谢

加密：

```
 push edx 
      push ecx 
      not eax 
      add eax,0x04 
      mov edx,eax 
      pop eax 
      xor eax,edx 
      pop edx 
      rol al,1 
      rol al,1
      rol al,1 
      sub al,0x02 
      ret 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:20:14.897

编辑：对于新代码，见底部

这段代码很奇怪，但它似乎在做这样的事情：（未测试）

```
char encrypt(char a, int c)
{
    int t = 4 + ~a;        // the NOT and the ADD
    int t2 = (c ^ t) & 0xFF;  // the XOR
    int t3 = ((t2 << 3) | (t2 >> 5)) & 0xFF;  // the three ROL's
    return (char)(t3 - 2);   // the SUB
} 
```

我认为相应的解密看起来像这样：（未测试）

```
char decrypt(char a, int c)
{
    int t = (a + 2) & 0xFF;
    int t2 = ((t >> 3) | (t << 5)) & 0xFF;
    int t3 = t2 ^ c;
    return (char)~(t3 - 4);
} 
```

组装中的哪个可能是这样的：（未经测试，没有混乱）

```
add al, 2
ror al, 3   ; or three times ror al, 1
xor al, cl
sub al, 4
not al
ret 
```

或者您可以在“主要是 32 位”中执行此操作：（也未测试）

```
add eax, 2
ror al, 3
xor eax, ecx
sub eax, 4
not eax
movzx eax, al  ; or just ignore everything but the low byte
ret 
```

根本没有测试任何东西，但我使用的一般策略是：弄清楚代码在做什么，然后逐步考虑如何撤消这些事情，从最后开始。如果向左旋转 3，则向右旋转 3。如果它们加 4，则减 4。XOR 和 NOT 是它们自己的逆。

* * *

因为我弄错了密钥和数据，所以我弄错了。其实应该是这样的：（也未测试）

```
; eax = EKey, cl = char
decryptB:
  add ecx, 2   // undo sub 2
  ror cl, 3    // undo rol
  not eax      // actually do not
  add eax, 4   // actually do add 4
  xor eax, ecx // undo xor
  ret 
```

因为对密钥进行的操作*不*应该是逆运算。

# powershell - 使用带有分号和撇号的参数的 Powershell 脚本

> ID：11677103
> 
> 赞同：1
> 
> 时间：2012-07-26T19:59:27.387
> 
> 标签：powershell

我在调用带有两个参数的 PS 脚本时遇到问题。这两个参数都是标准的 SMTP 地址，但第一个参数可以有多个地址，用分号分隔。

如果每个参数中只有一个地址，则脚本运行良好。如果我在参数周围加上单引号，如果第一个参数有多个地址，我可以让它正常工作。

我遇到的问题是第一个参数是否有多个地址，并且其中一个（或多个）地址有撇号（即 o'brien@foo.com）。

有没有办法可以将第一个参数括起来，以便它可以同时包含撇号和分号？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:06:33.250

您可以使用反引号 (`) 对其进行转义，也可以使用双引号将其括起来。听起来我们在谈论 To 和 From 类型参数？这是一个可能很接近的示例：

```
Send-MailCommandThing -sendTo 'One@one.com;two@two.com' -sendFrom "o'brien@foo.com" 
```

# python - 如何在狮身人面像中制作彩色盒子

> ID：11677104
> 
> 赞同：1
> 
> 时间：2012-07-26T19:59:27.593
> 
> 标签：python, python-sphinx

我正在尝试使用 Sphinx for Python 制作彩色盒子。

例如，这个网站有很多灰色的 div 或框（不是 Note 的）：[http ://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html](http://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html)

我想知道他们是如何设法创建这些盒子的，因为这个网站也是使用 sphinx 创建的。

我发现的一件事是，Sphinx 内置了彩色框，如下所示：http: [//openalea.gforge.inria.fr/doc/openalea/doc/_build/html/source/sphinx/rest_syntax.html#colored-boxes -note-seealso-todo-and-warnings](http://openalea.gforge.inria.fr/doc/openalea/doc/_build/html/source/sphinx/rest_syntax.html#colored-boxes-note-seealso-todo-and-warnings)。如果这些框的开头没有“Note:”、“SeeAlso”或“Warning”的话，它们对我来说非常适合。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-27T08:05:51.140

诸如注释、警告之类的东西称为[警告](http://docutils.sourceforge.net/docs/ref/rst/directives.html#admonitions)。不幸的是，您不能创建没有标题的标题，因为它是 reStructuredText 所要求的。

该页面上的其他框来自[代码块](https://www.sphinx-doc.org/en/master/usage/restructuredtext/directives.html#showing-code-examples)。代码块通过[Pygments](http://pygments.org/)颜色语法荧光笔运行。

还有其他几种方法可以得到你想要的。您可以[嵌入原始 HTML](http://docutils.sourceforge.net/docs/ref/rst/directives.html#raw-data-pass-through)，但这是不受欢迎的。另一种选择可能是[编写一个扩展](https://www.sphinx-doc.org/en/master/development/tutorials/helloworld.html)来创建一个指令，为您提供所需的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:08:18.553

这是一个简单的[源代码块](https://www.sphinx-doc.org/en/1.8/usage/restructuredtext/directives.html#directive-code-block)。

# php - Yii 为另一个模型中存在的字段创建 CButton 列

> ID：11677106
> 
> 赞同：0
> 
> 时间：2012-07-26T19:59:38.407
> 
> 标签：php, mysql, yii, cbuttoncolumn

我正在尝试添加以下功能，但是我不确定从哪里开始。任何建议、示例或方向将不胜感激。

我想在这种情况下向主模型的 cgridview 添加按钮。此模型的 cgridview 中可用的每个记录都有一个名为 lot 的唯一属性，例如 R3XSEF9

我的数据库中还有另一个辅助表/模型，其中包含具有相同批次属性的记录。但是，该表仅具有所有可能记录中的某些记录，有时会重复，并且具有一组不同的属性。

我想做的是，使用批次属性，例如我的 cgridview 中的批次 R3XSEF9，搜索辅助表以查看是否有一个或多个对应的行包含相同的批次 R3XSEF9。

如果是这样，我希望该按钮显示在我的 CButtonColumn 中并链接到辅助表的那些相应模型的视图。如果没有，我不希望出现任何按钮。

谢谢你的帮助。如果需要任何澄清，我很乐意这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T04:21:44.257

首先，您需要使用模型类中的“关系”函数链接表。如果您在已填充的数据库关系中使用 FOREIGN KEY 约束。

SQL 语句：

```
CREATE TABLE Model1
(
    ...
    FOREIGN KEY(lot) REFERENCES MainModel(lot) ON UPDATE CASCADE ON DELETE RESTRICT,
    ...
) 
```

型号类：

```
 class MainModel extends CActiveRecord
 {
         ...

    public function relations()
    {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array(
            'lots' => array(self::HAS_MANY, 'Model2', 'lot'),
        );
    } 
```

然后你可以在你的网格（查看文件）中使用自定义按钮列，如下所示：

```
<?php $this->widget('zii.widgets.grid.CGridView', array(
    'id' => 'main-grid',
    'dataProvider' => $model->search(),
    'filter' => $model,
    'columns' => array(
    ...
    array(
        'class' => 'CButtonColumn',
        'template' => '{lots}',
        'header' => 'Lots',
        'buttons' => array(
            'lots' => array(
                'label' => 'Lots',
                'imageUrl' => Yii::app()->request->baseUrl.'/img/....png',
                'url' => 'Yii::app()->createUrl("controller1/lotlistbymainid", array("id" => $data->id))',
                'visible' => 'count($data->lots) > 0',
            ),
        ),
    ), 
```

要通过“按钮”数组传递的按钮参数说明，您可以在[此处](http://www.yiiframework.com/doc/api/1.1/CButtonColumn)找到。特别是这部分：

按钮属性

公共数组 $buttons;

附加按钮的配置。每个数组元素指定一个按钮，其格式如下：

```
'buttonID' => array(
    'label'=>'...',     // text label of the button
    'url'=>'...',       // a PHP expression for generating the URL of the button
    'imageUrl'=>'...',  // image URL of the button. If not set or false, a text link is used
    'options'=>array(...), // HTML options for the button tag
    'click'=>'...',     // a JS function to be invoked when the button is clicked
    'visible'=>'...',   // a PHP expression for determining whether the button is visible
) 
```

# visual-studio-2010 - 支持 Team Foundation Server 2010 中的错误

> ID：11677108
> 
> 赞同：0
> 
> 时间：2012-07-26T19:59:49.630
> 
> 标签：visual-studio-2010, tfs, bug-tracking

遇到 Team Foundation Server 2010 的问题，我希望社区中的某个人提出了一个解决方案，我可以将其作为补丁添加到服务器。

在我正在进行的一个项目中，我们有 2-3 名 QA 人员，其中 1 人正在运行 TFS 以解决您所期望的错误……如果她发现问题并且已经记录，她会继续前进。问题是 IT 团队的其他成员认为她没有做任何事情，我不希望她没有得到应有的赞誉。

有什么我可以插入 TFS 2010 的东西，她可以支持这个问题，这样她就可以得到至少解决错误的功劳？任何建议都会很棒（可能不是 Stackoverflow 问题，但在这种情况下，让我们把它交给程序员或类似的东西）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:26:20.017

您可以在 TFS 项目模板中定义一个**自定义**字段（即一个新的下拉菜单），该字段可以用作“upvoting”机制。

“upvoting”错误的问题在于它可能与其优先级混淆。此外，这不一定能解决她是否获得信用的问题（从技术上讲，她可以通过错误队列并为每个项目投票 - 并不意味着她自己发现了错误）。作为替代方案（虽然不理想），她可以简单地使用 TFS 项目中的“Notes”选项卡来确认她遇到了同样的问题。

# c# - HttpClient HttpResponseMessage 地址/URI

> ID：11677112
> 
> 赞同：10
> 
> 时间：2012-07-26T20:00:02.543
> 
> 标签：c#, httpclient, windows-runtime, .net-4.5

我正在开发一个 C# WinRT 应用程序，它向网络服务器发出 POST 和 GET 请求。

有谁知道在使用 HttpClient 对象时是否有办法获取响应 URI/地址？

如果我使用 HttpWebRequest / HttpWebResponse 类，那么我可以获取此信息（通过 HttpWebResponse 中的 ResponseUri 属性），但我看不到如何使用 HttpClient / HttpResponseMessage 类获取它。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-08-13T21:45:11.610

这是两年前的事了，但我刚刚以完全相同的愿望遇到了这个问题，[@PeterRitchie在](https://stackoverflow.com/users/5620/peter-ritchie)[评论](https://stackoverflow.com/questions/11677112/httpclient-httpresponsemessage-address-uri#comment15482091_11677112)中回答了这个问题，所以我将其复制给未来的访客。

> 我认为您可以从 HttpResponseMessage.RequestMessage.RequestUri 获得重定向的 UI

# box-api - V2 文档错误？

> ID：11677116
> 
> 赞同：0
> 
> 时间：2012-07-26T20:00:17.257
> 
> 标签：box-api

我正在开发一个将使用 V2 Box API 的应用程序，并注意到对于某些调用，我从 API 获得的响应与文档不同。

你希望我如何处理我发现的东西？你想让我把这些观点作为单独的主题发布在这里吗？或者有其他方法可以提供反馈吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:40:26.247

您可以将您发现的任何文档错误发送到 API[at]BOXdotCOM。

# c++ - OpenCV example code for find contours: vector deallocation issue

> ID：11677118
> 
> 赞同：11
> 
> 时间：2012-07-26T20:00:23.373
> 
> 标签：c++, memory, image-processing, opencv

I'm trying to get started with contour detection in OpenCV 2.4.2\. To this end, I set up a project for OpenCV and copied the whole example code found in the [documentation](http://docs.opencv.org/doc/tutorials/imgproc/shapedescriptors/find_contours/find_contours.html#find-contours). For future reference, here is the code:

```
#include "opencv2/highgui/highgui.hpp"
#include "opencv2/imgproc/imgproc.hpp"
#include <iostream>
#include <stdio.h>
#include <stdlib.h>

using namespace cv;
using namespace std;

Mat src; Mat src_gray;
int thresh = 100;
int max_thresh = 255;
RNG rng(12345);

/// Function header
void thresh_callback(int, void* );

/** @function main */
int main( int argc, char** argv )
{
  /// Load source image and convert it to gray
  src = imread( argv[1], 1 );

  /// Convert image to gray and blur it
  cvtColor( src, src_gray, CV_BGR2GRAY );
  blur( src_gray, src_gray, Size(3,3) );

  /// Create Window
  char* source_window = "Source";
  namedWindow( source_window, CV_WINDOW_AUTOSIZE );
  imshow( source_window, src );

  createTrackbar( " Canny thresh:", "Source", &thresh, max_thresh, thresh_callback );
  thresh_callback( 0, 0 );

  waitKey(0);
  return(0);
}

/** @function thresh_callback */
void thresh_callback(int, void* )
{
  Mat canny_output;
  vector<vector<Point> > contours;
  vector<Vec4i> hierarchy;

  /// Detect edges using canny
  Canny( src_gray, canny_output, thresh, thresh*2, 3 );
  /// Find contours
  findContours( canny_output, contours, hierarchy, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE, Point(0, 0) );

  /// Draw contours
  Mat drawing = Mat::zeros( canny_output.size(), CV_8UC3 );
  for( int i = 0; i< contours.size(); i++ )
     {
       Scalar color = Scalar( rng.uniform(0, 255), rng.uniform(0,255), rng.uniform(0,255) );
       drawContours( drawing, contours, i, color, 2, 8, hierarchy, 0, Point() );
     }

  /// Show in a window
  namedWindow( "Contours", CV_WINDOW_AUTOSIZE );
  imshow( "Contours", drawing );

  contours.clear(); // Error!!
} 
```

It compiles fine in Visual Studio 11 RC (Windows 7 SP1), but I get an error at the end of the `thresh_callback` function. Here is the stacktrace:

```
msvcr110d.dll!_CrtIsValidHeapPointer(const void * pUserData) Line 2036
msvcr110d.dll!_free_dbg_nolock(void * pUserData, int nBlockUse) Line 1322
msvcr110d.dll!_free_dbg(void * pUserData, int nBlockUse) Line 1265
msvcr110d.dll!operator delete(void * pUserData) Line 54
std::allocator<cv::Point_<int> >::deallocate(cv::Point_<int> * _Ptr, unsigned int __formal) Line 586
std::_Wrap_alloc<std::allocator<cv::Point_<int> > >::deallocate(cv::Point_<int> * _Ptr, unsigned int _Count) Line 888
std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > >::_Tidy() Line 1542
std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > >::~vector<cv::Point_<int>,std::allocator<cv::Point_<int> > >() Line 901
std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > >::`scalar deleting destructor'(unsigned int)
std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > >::destroy<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > >(std::<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _Ptr) Line 624
std::allocator_traits<std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > > >::destroy<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > >(std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > > & _Al, std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _Ptr)758
std::_Wrap_alloc<std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > > >::destroy<std::vector<cv::Point_<int>,std::allocator<cv::Poin> > > >(std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _Ptr) Line 909
std::_Destroy_range<std::_Wrap_alloc<std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > > > >(std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _First, std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _Last, std::_Wrap_alloc<std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::<int> > > > > & _Al, std::_Nonscalar_ptr_iterator_tag __formal) Line 89
std::_Destroy_range<std::_Wrap_alloc<std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > > > >(std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _First, std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _Last, std::_Wrap_alloc<std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::<int> > > > > & _Al) Line 80
std::vector<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > >,std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> >::_Destroy(std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _First, std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > * _Last) Line 1480
std::vector<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > >,std::allocator<std::vector<cv::Point_<int>,std::allocator<cv::Point_<int> > > > >::c Line 1416
thresh_callback(int __formal, void * __formal) Line 143
opencv_highgui242d.dll!icvUpdateTrackbar(CvTrackbar * trackbar, int pos) Line 1938
opencv_highgui242d.dll!HGToolbarProc(HWND__ * hwnd, unsigned int uMsg, unsigned int wParam, long lParam) Line 1982 
```

(Note that actually I have a slightly modified version of the example code, added a few printf-s, and a `contours.clear()` call, which is at line 143, and which triggers the vector deallocation [that would happen automatically at the end of the function] which seems to be the source of the problem. The very same issue occurs with the exact example code as well.)

The problem seems to be with the deallocation of the `contours` vector. The same occurs if I try to call `contours.clear()`. I have examined the variable's contents in the VS debugger, but there's nothing unusual as far as I can tell.

I tried to clear the vector as soon as it was no longer needed (after the `for` loop), but it didn't help. I also tried to switch the Platform Toolset to Visual Studio 10, which in turn won't even compile with error messages that are beyond me:

```
error C1083: Cannot open include file: 'SDKDDKVer.h': No such file or directory (C:\<project path>\targetver.h) (Line 8, Column 1)
IntelliSense: cannot open source file "SDKDDKVer.h" (C:\<project path>\targetver.h) (Line 8, Column 1)
IntelliSense: cannot open source file "windows.h" (C:\<opencv path>\build\include\opencv2\core\operations.hpp (Line 83, Column 3) 
```

Any help would be greatly appreciated. Please note that I'm not a C++ programmer: I have very little knowledge, and even less experience with C++ programming and native programming in general.

**Edit**: it turns out that the debugger displayed the wrong line as the source of error. I should have seen in the call stack that the problem was with vector >. So the problematic vector is `contours`, not `hierarchy`!

**Edit #2**: I also tried to reproduce the issue with a minimal code that creates a `vector<vector<cv::Point> >`, puts some items in it, then clears it, but I couldn't reproduce the problem.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-26T20:48:50.180

You're building your application in debug mode and linking against the Multithreaded Debug DLL CRT. Do you know which CRT the OpenCV DLL(s) are linked against? If it's linked against a static CRT it'll fill up the vector with data allocated from a separate heap, which causes an assertion in the Debug CRT you're using.

If you build your application in Release mode you should no longer see the assert, but you might end up leaking memory. The best thing would be to ensure that both your application and the OpenCV DLL(s) are linked against the same Multithreaded DLL CRT.

EDIT: If you can't rebuild OpenCV to use the same CRT as your application you could try telling the linker to use the same CRT version as OpenCV for your application by modifying the application manifest. See [How to Enforce C++ compiler to use specific CRT version?](https://stackoverflow.com/questions/730134/how-to-enforce-c-compiler-to-use-specific-crt-version) for more information on how to do that.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-21T14:13:18.493

Go into your solution-options, there the c-runtime (CRT) settings and check the linking (CRT as mentioned above)... if your project was/is (once) created with VS10 and you use a newer version, just edit the links not to be 10, but 11 or 12 ..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-07T22:29:08.660

Add to System Path (as an example): H:\Source\opencv_v2_4_13_2\output\bin\Debug

where directory: "H:\Source\opencv_v2_4_13_2\output" is used from CMake as destination directory for visual Studio 14 (2015) opencv projects.

Your project uses opencv dll files, but is not find: opencv_core2413d.dll

# xml - WCF - xml响应中的同名标签

> ID：11677123
> 
> 赞同：0
> 
> 时间：2012-07-26T20:00:33.763
> 
> 标签：xml, wcf, rest, response

我是新手。请在这方面帮助我。在 WCF 休息应用程序中，我想要以下响应

```
<parameterList>    
        <parameter>        
            <Question> Occupation </Question> 

            <Choice> Student/Others </Choice>      
            <Choice> Retired/housewife </Choice>       
            <Choice> Salaried/SelfEmployed </Choice>        
            <Choice> Doctor/CA/Socially Important Person </Choice> 

        </parameter>    
</parameterList> 
```

我想要 4 个具有不同内容的相同“选择”标签。我得到的只是最后一个“选择”标签。

### IService.cs

```
[OperationContract]
[WebInvoke(Method = "GET",
ResponseFormat = WebMessageFormat.Xml,
BodyStyle = WebMessageBodyStyle.Wrapped,
UriTemplate = "/getQuestion")]
[return: MessageParameter(Name = "parameterList")]
List<parameter> getQuestion(); 
```

### 服务.svc.cs

```
public List<parameter> getQuestion()
    {
        List<parameter> lstParameter = new List<parameter>();
        parameter param = new parameter();
        param.Question = " Occupation ";
        param.Choice = " Student/Others ";
        param.Choice = " Retired/housewife ";
        param.Choice = " Salaried/SelfEmployed ";
        param.Choice = " Doctor/CA/Socially Important Person ";
        lstParameter.Add(param);
        return lstParameter;
    } 
```

### 参数.cs

```
public class parameter
{
    public string Question
    {
        get{ } set{ }
    }

    public string Choice
    {
        get{ } set{ }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T07:38:26.187

解决了

```
 [XmlElement("Choice")]

        public List<string> Choice
        {
            get { return aChoice; }
            set { aChoice = value; }
        } 
```

只需在属性上方添加 [XmlElement("")] 即可重命名 Xml 元素。

谢谢詹姆斯。你很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:11:04.737

您继续使用新字符串覆盖 Choice。您的 Choice 属性必须是 List

```
 public List<string> Choice
        {
            get { return new List<string>();}
        } 
```

然后你可以添加到列表中

```
param.Choice.add(" Occupation ");
param.Choice.add(" Retired/housewife "); 
```

ETC....

之后，您必须遍历所有选择并将它们添加到您的 XML

# upload - nicUpload 说“无效的上传 ID”，不能让它工作

> ID：11677128
> 
> 赞同：0
> 
> 时间：2012-07-26T20:00:47.273
> 
> 标签：upload, wysiwyg, nicedit

我尝试使用 nicupload 插件实现 nicEdit，但是当我选择要上传的文件时，它显示“上传图像失败”，并且服务器响应显示“上传 ID 无效”。

这是调用脚本并初始化的代码：

```
<script src="http://js.nicedit.com/nicEdit-latest.js" type="text/javascript"></script>
<script type="text/javascript">//<![CDATA[
bkLib.onDomLoaded(function() {
new nicEditor({uploadURI : '../../nicedit/nicUpload.php'}).panelInstance('area1');
});
//]]>
</script> 
```

nicUpload.php 的路径是正确的，代码是可以在文档中找到的那个：http: [//nicedit.com/src/nicUpload/nicUpload.js](http://nicedit.com/src/nicUpload/nicUpload.js)

我对上传文件夹进行了更改，并设置了写入权限。根据文档（[http://wiki.nicedit.com/w/page/515/Configuration%20Options](http://wiki.nicedit.com/w/page/515/Configuration%20Options)），仅此而已，但我不断收到错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T12:22:28.290

在寻找解决方案很长时间后（很多帖子没有真正的解决方案），我现在自己修复了代码。我现在可以将图像上传到我自己的服务器。感谢萤火虫和日食;-)

主要问题是 nicUpload.php 是旧的，不能与当前的 nicEdit-Upload 函数一起使用。

*缺少的是错误处理，请随时添加...*

将**nicEditor 添加到您的 php 文件并将其配置**为使用 nicEdit.php：

```
new nicEditor({iconsPath : 'pics/nicEditorIcons.gif', uploadURI : 'script/nicUpload.php'} 
```

下载**未压缩的 nicEdit.js**并在 nicEdit.js 中更改以下行：

```
uploadFile : function() {
var file = this.fileInput.files[0];
if (!file || !file.type.match(/image.*/)) {
  this.onError("Only image files can be uploaded");
  return;
}
this.fileInput.setStyle({ display: 'none' });
this.setProgress(0);

var fd = new FormData(); 
fd.append("image", file);
fd.append("key", "b7ea18a4ecbda8e92203fa4968d10660");
var xhr = new XMLHttpRequest();
xhr.open("POST", this.ne.options.uploadURI || this.nicURI);

xhr.onload = function() {
  try {
    var res = JSON.parse(xhr.responseText);
  } catch(e) {
    return this.onError();
  }
  //this.onUploaded(res.upload); // CHANGE HERE
  this.onUploaded(res);
}.closure(this);
xhr.onerror = this.onError.closure(this);
xhr.upload.onprogress = function(e) {
  this.setProgress(e.loaded / e.total);
}.closure(this);
xhr.send(fd); 
```

},

```
onUploaded : function(options) {
this.removePane();
//var src = options.links.original; // CHANGE HERE
var src = options['url'];
if(!this.im) {
  this.ne.selectedInstance.restoreRng();
  //var tmp = 'javascript:nicImTemp();';
  this.ne.nicCommand("insertImage", src);
  this.im = this.findElm('IMG','src', src);
}
var w = parseInt(this.ne.selectedInstance.elm.getStyle('width'));
if(this.im) {
  this.im.setAttributes({
    src : src,
    width : (w && options.image.width) ? Math.min(w, options.image.width) : ''
  });
} 
```

}

**像这样更改nicUpload.php**

```
<?php
/* NicEdit - Micro Inline WYSIWYG
 * Copyright 2007-2009 Brian Kirchoff
 *
 * NicEdit is distributed under the terms of the MIT license
 * For more information visit http://nicedit.com/
 * Do not remove this copyright message
 *
 * nicUpload Reciever Script PHP Edition
 * @description: Save images uploaded for a users computer to a directory, and
 * return the URL of the image to the client for use in nicEdit
 * @author: Brian Kirchoff <briankircho@gmail.com>
 * @sponsored by: DotConcepts (http://www.dotconcepts.net)
 * @version: 0.9.0
 */

/* 
* @author: Christoph Pahre
* @version: 0.1
* @description: different modification, so that this php file is working with the newest nicEdit.js (needs also modification - @see) 
* @see http://stackoverflow.com/questions/11677128/nicupload-says-invalid-upload-id-cant-make-it-works
*/

define('NICUPLOAD_PATH', '../images/uploadedImages'); // Set the path (relative or absolute) to
                                      // the directory to save image files

define('NICUPLOAD_URI', '../images/uploadedImages');   // Set the URL (relative or absolute) to
                                      // the directory defined above

$nicupload_allowed_extensions = array('jpg','jpeg','png','gif','bmp');

if(!function_exists('json_encode')) {
    die('{"error" : "Image upload host does not have the required dependicies (json_encode/decode)"}');
}

if($_SERVER['REQUEST_METHOD']=='POST') { // Upload is complete

    $file = $_FILES['image'];
    $image = $file['tmp_name'];
    $id = $file['name'];

    $max_upload_size = ini_max_upload_size();
    if(!$file) {
        nicupload_error('Must be less than '.bytes_to_readable($max_upload_size));
    }

    $ext = strtolower(substr(strrchr($file['name'], '.'), 1));
    @$size = getimagesize($image);
    if(!$size || !in_array($ext, $nicupload_allowed_extensions)) {
        nicupload_error('Invalid image file, must be a valid image less than '.bytes_to_readable($max_upload_size));
    }

    $filename = $id;
    $path = NICUPLOAD_PATH.'/'.$filename;

    if(!move_uploaded_file($image, $path)) {
        nicupload_error('Server error, failed to move file');
    }

    $status = array();
    $status['done'] = 1;
    $status['width'] = $size[0];
    $rp = realpath($path);
    $status['url'] =  NICUPLOAD_URI ."/".$id;

    nicupload_output($status, false);
    exit;
} 

// UTILITY FUNCTIONS

function nicupload_error($msg) {
    echo nicupload_output(array('error' => $msg)); 
}

function nicupload_output($status, $showLoadingMsg = false) {
    $script = json_encode($status);
    $script = str_replace("\\/", '/', $script);
    echo $script;

    exit;
}

function ini_max_upload_size() {
    $post_size = ini_get('post_max_size');
    $upload_size = ini_get('upload_max_filesize');
    if(!$post_size) $post_size = '8M';
    if(!$upload_size) $upload_size = '2M';

    return min( ini_bytes_from_string($post_size), ini_bytes_from_string($upload_size) );
}

function ini_bytes_from_string($val) {
    $val = trim($val);
    $last = strtolower($val[strlen($val)-1]);
    switch($last) {
        // The 'G' modifier is available since PHP 5.1.0
        case 'g':
            $val *= 1024;
        case 'm':
            $val *= 1024;
        case 'k':
            $val *= 1024;
    }
    return $val;
}

function bytes_to_readable( $bytes ) {
    if ($bytes<=0)
        return '0 Byte';

    $convention=1000; //[1000->10^x|1024->2^x]
    $s=array('B', 'kB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB');
    $e=floor(log($bytes,$convention));
    return round($bytes/pow($convention,$e),2).' '.$s[$e];
}

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:54:40.247

您可以手动将 id 传递给您的脚本：例如 nicUpload.php?id=introPicHeader，它将在您定义的图像文件夹中变为 introPicHeader.jpg（或适当的扩展名）。

但是，我注意到此脚本已损坏，如果在 nicEditorAdvancedButton.extend({ 期间直接在 nicEdit.js 中指定，则无法访问配置选项 uploadURI。这会导致访问相对路径的“未知”资源，从而导致错误。

文档另有暗示，并且在此处为 imgur.com 指定了 nicURI 的事实（可能是默认设置）给我的印象是，我还可以在一个地方而不是在每个编辑器实例中添加对 nicUpload.php 脚本的 uploadURI 引用.

**更新**

如果您在实例化期间传递它，这将起作用，我猜这确实允许轻松的动态 id 填充。

不幸的是，nicUpload.php 充满了错误，它的输出不是 JSON。编辑器希望解析 JSON 并找到带有意外标记“<”的脚本标记和错误。

我将尝试识别大量其他错误：

在 nicEdit.js

1.  A.append("image") 实际上应该是 A.append("nicImage")
2.  this.onUploaded(D.upload) 应该变成 this.onUploaded(D)
3.  this.onUploaded(D) 应该移到 var D=JSON.parse(C.responseText) 之后的 try 块内以修复变量范围问题
4.  B.image.width 需要变成 B.width

在 nicUpload.php

1.  JSON 输出格式不正确，注释掉 html 输出，只输出 json_encode($status)。
2.  JSON 输出需要返回一个名为 links 而不是 url 的键/值对，尽管在 nicEdit.js 中将 var D=B.links 重命名为 var D=B.url 也足以解决问题。

php 和 javascript 代码都有很多不足之处，我经常遇到很多错误，并且一直在自己修复它们。

# ruby-on-rails-3 - gmaps4rails - 许多标记，一个位置 - 如何查看？

> ID：11677129
> 
> 赞同：4
> 
> 时间：2012-07-26T20:00:49.677
> 
> 标签：ruby-on-rails-3, gmaps4rails

我想知道如何处理一个位置可能有很多标记的情况。

我正在使用 gmaps4rails 和 rails 3

这与 gmap 的“do_clustering”属性有关吗？

谢谢！

亚当

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T14:22:59.030

太好了，刚刚在文档中找到“随机化”！完美的：

{:data => @json, :options => { :do_clustering => true, randomize: true} }) %>

# python - 在 Windows 中将希伯来文文件名作为命令行参数传递

> ID：11677130
> 
> 赞同：1
> 
> 时间：2012-07-26T20:00:59.943
> 
> 标签：python, unicode, command-line-arguments, hebrew

我有一个小的 Python 程序。我使用 Windows 注册表来启用使用右键单击上下文菜单打开文件。我的注册表项：

> C:\Users\me\projects\mynotepad\notepad.exe "%1"

当我尝试使用右键单击上下文菜单打开具有希伯来语名称的文件时，我将文件名作为问号获取，并且在尝试获取文件大小时出现异常。

这是我的代码：

```
file_name = sys.argv[1]
file_size = os.path.getsize(unicode(file_name)) 
```

我试过这个：

```
file_name = sys.argv[1].decode("cp1255").encode('utf-8')
file_size = os.path.getsize(unicode(file_name)) 
```

但它没有用。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:04:31.847

原来这是一个问题。请参阅[此处](https://stackoverflow.com/questions/846850/read-unicode-characters-from-command-line-arguments-in-python-2-x-on-windows)了解解决方案。您需要借助 Windows API 来获取参数。

# c++ - QTextEdit - 获取选择行号

> ID：11677134
> 
> 赞同：5
> 
> 时间：2012-07-26T20:01:09.363
> 
> 标签：c++, qt, text, qt4, qtextedit

我有以下代码（在 mouseReleaseEvent 中实现）来检测用户何时选择了文本行：

```
 QTextCursor cursor = this->textCursor();
    int start = cursor.selectionStart();
    int end = cursor.selectionEnd();

    if(!cursor.hasSelection())
        return; // No selection available

    qWarning() << "start: " << start << " end: " << end << endl; 
```

问题是：我需要选择开始和结束的行号。我一直在努力解决问题，但什么也没解决，你能给我一个线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-28T13:06:08.517

有可能，它不是最好的解决方案，但它似乎对我有用。该变量`selectedLines`将包含选择了多少行。

```
QTextCursor cursor = ui->plainTextEdit->textCursor();
int selectedLines = 0; //<--- this is it 
if(!cursor.selection().isEmpty())
{
    QString str = cursor.selection().toPlainText();
    selectedLines = str.count("\n")+1;
} 
```

我希望，这会有所帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:57:55.990

我看到了使用 2 个 QTextCursor 方法链的简单方法 - setPosition 和 blockNumber。

```
QTextCursor cursor = this->textCursor();
int start = cursor.selectionStart();
int end = cursor.selectionEnd();

if(!cursor.hasSelection())
    return; // No selection available

cursor.setPosition(start);
int firstLine = cursor.blockNumber();
cursor.setPosition(end, QTextCursor::KeepAnchor);
int lastLine = cursor.blockNumber();
qWarning() << "start: " << firstLine << " end: " << lastLine << endl; 
```

升级版：

```
 cursor.setPosition(start);
 cursor.block().layout()->lineForTextPosition(start).lineNumber();
 // or
 cursor.block().layout()->lineAt(<relative pos from start of block>).lineNumber(); 
```

将位置设置为选择的开始。获取当前块，获取块布局并使用 Qt API 获取行号。我不知道返回的行号对于整个文档或布局是绝对的。如果仅用于布局，则需要一些额外的过程来计算先前块的行号。

```
for (QTextBlock block = cursor.block(). previous(); block.isValid(); block = block.previous())
    lines += block.lineCount(); 
```

# ruby-on-rails - 使用 rack 从同一个 Rails 应用程序中运行获取请求？

> ID：11677138
> 
> 赞同：0
> 
> 时间：2012-07-26T20:01:19.360
> 
> 标签：ruby-on-rails, ruby, rack

我正在尝试找到一种方法，在清晨的特定时间通过电子邮件将我们应用程序的请求结果通过电子邮件发送给用户。我想从应用程序中执行此操作，返回的数据取决于它是哪个用户以及请求的参数。我可以使用 Rack 并设置会话并运行 get 吗？我怎么做？指向网络上任何有用的文档的指针。该应用程序位于 Rails 2.3 中。谢谢！

# java - 触发Java垃圾收集的简单程序

> ID：11677139
> 
> 赞同：1
> 
> 时间：2012-07-26T20:01:26.307
> 
> 标签：java, garbage-collection

我正在测试一些 JDK，需要多次触发垃圾回收。我怎样才能在一个简单的程序中轻松做到这一点？示例将非常有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:13:27.573

有关垃圾收集的精彩讨论，请参见[此处](http://blog.dynatrace.com/2011/05/11/how-garbage-collection-differs-in-the-three-big-jvms/)。您可以要求运行它（如先前的答案所述），但这不是保证，因此您不应对调用做出过多假设。您最好的选择是多次创建和销毁新对象。为了让它们被销毁，在一个块中创建它们并再次关闭它。也许是这样的：

```
for(int i = 0; i < MAX; ++i) {
    {
        Integer i = new Integer(0);
    }
} 
```

您可以从外部监控内存使用情况吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:03:13.730

您可以使用`System.gc()`来请求垃圾收集

在您的问题的背景下，这个[SO 讨论](https://stackoverflow.com/questions/66540/system-gc-in-java)可能很有趣

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:04:11.693

从[Oracle 文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#gc%28%29)使用`System.gc()`

```
public static void gc() 
```

> 运行垃圾收集器。调用 gc 方法表明 Java 虚拟机花费精力回收未使用的对象，以便使它们当前占用的内存可用于快速重用。当控制从方法调用返回时，Java 虚拟机已尽最大努力从所有丢弃的对象中回收空间。
> 
> 调用 System.gc() 实际上等效于调用：
> 
> Runtime.getRuntime().gc()

# java - 何时以及为什么未实现 (java.lang.reflect.InvocationTargetException) 发生？

> ID：11677143
> 
> 赞同：0
> 
> 时间：2012-07-26T20:01:57.510
> 
> 标签：java, eclipse, jform-designer

在 Eclipse 中打开 JFD 文件时，我得到“未实现（java.lang.reflect.InvocationTargetException）”。你能告诉我它何时以及为什么会发生吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:04:16.667

这意味着您正在调用的方法会引发该异常，而您对此没有做任何事情。您要么需要将方法调用放在 try/catch 块中，要么需要重新抛出异常以供其他人处理。

# c - Libnet 基本使用

> ID：11677144
> 
> 赞同：0
> 
> 时间：2012-07-26T20:02:18.740
> 
> 标签：c, macos, gcc, libnet

我一直在查看 libnet 提供的示例源，但是，我不清楚如何处理以下内容。

```
length+=LIBNET_TCP_H;
t = libnet_build_tcp(
    0x6666,                                     /* source port */
    179,                                        /* destination port */
    0x01010101,                                 /* sequence number */
    0x02020202,                                 /* acknowledgement num */
    TH_SYN,                                     /* control flags */
    32767,                                      /* window size */
    0,                                          /* checksum */
    0,                                          /* urgent pointer */
length,                                     /* TCP packet size */
    NULL,                                       /* payload */
    0,                                          /* payload size */
    l,                                          /* libnet handle */
    0);                                         /* libnet id */ 
```

这似乎是一个 tcp 标头结构，但是，如果我想更改 dst 端口，我应该在 #179 处进行，还是有更好的方法？

另外，这是编译的正确方法吗：

gcc -Wall `libnet-config --defines`arp-new-new.c `libnet-config --libs`-lpcap -lnet

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T18:29:30.023

在我对libnet的一点经验中，您拥有dst端口的字段是179，而我自己的编译命令是：$ gcc -Wall -std=gnu99 -pedantic disect5.c -lpcap `libnet-config --defines` `libnet-config --libs`-lnet -o disect5（对于一个名为 disect5) gretz 的 C 程序

# javascript - 通过将字符串添加到动态 id 来使用 JavaScript 控制文本框

> ID：11677145
> 
> 赞同：0
> 
> 时间：2012-07-26T20:02:18.413
> 
> 标签：javascript, textbox

我不知道我为什么要为此苦苦挣扎。我应该采取不同的方法吗？我有一个基于数据库在 vb 中生成的表单，然后我试图简单地禁用一个文本框，除非你选中一个复选框。

[这](http://jsfiddle.net/mikesearcy/ve9Gz/)是我到目前为止所拥有的。它需要是动态的（我已经注释掉了）。

我似乎无法让它工作。困难的部分是参考

```
document.form1.el.id.toString() + "_other".disabled 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:10:12.987

`disabled`是二元属性，而不是属性。

您必须使用`disabled='disabled'`或删除该属性才能启用该元素。它不是真/假值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:11:55.680

这是一种方法：

[http://jsfiddle.net/C2WaU/1/](http://jsfiddle.net/C2WaU/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:08:36.963

如果我理解你是正确的，这应该对你有用：

```
function enable_text(el) {
    var textbox_name = el.id.toString() + "_other";
    document.getElementById(textbox_name).disabled = 
       (el.checked) ? "" : "disabled"; 
}​ 
```

一个工作示例：http: [//jsfiddle.net/ve9Gz/3/](http://jsfiddle.net/ve9Gz/3/)

# java - 与 ExecutorService 并发消费消息

> ID：11677151
> 
> 赞同：2
> 
> 时间：2012-07-26T20:02:58.163
> 
> 标签：java, multithreading, rabbitmq

我正在尝试使用 Java 中的 RabbitMQ 运行一个非常基本的应用程序。我很想使用 Java 同时使用消息`ExecutorService`。我的项目使用的是 Spring，所以我定义了我的`ThreadPoolExecutorFactoryBean`类似：

```
<bean class="org.springframework.scheduling.concurrent.ThreadPoolExecutorFactoryBean"
        destroy-method="destroy">
    <property name="corePoolSize" value="8"/>   
    <property name="keepAliveSeconds" value="600"/>
    <property name="maxPoolSize" value="16"/>
    <property name="threadGroupName" value="CallbackQueue-Group"/>
    <property name="threadNamePrefix" value="CallbackQueue-Worker-"/>
</bean> 
```

我正在使用正在执行以下操作的类将这个 bean 注入到我的主消息队列中：

```
this.connection = getConnectionFactory().newConnection(getQueueExecutor());
this.channel = this.connection.createChannel();
this.channel.queueDeclare(getQueueName(), true, false, false, null);
this.channel.basicConsume(getQueueName(), false, new DefaultConsumer(this.channel) {
    @Override public void handleDelivery(String consumerTag, Envelope envelope, 
            BasicProperties properties, byte[] body) throws IOException {
        logger.debug("Received message {}", properties.getCorrelationId());

        try { Thread.sleep(3000); } catch (InterruptedException e) {};

        getChannel().basicAck(envelope.getDeliveryTag(), false);
    }
}); 
```

简而言之，当我将多条消息发布到队列时，我应该看到日志语句非常接近地发生，即使任务需要一段时间才能执行。但是，我看到我的消费者一次只处理*一项任务*，尽管`ExecutorService`！更奇怪的是，我实际上在池服务队列中看到了不同的线程，尽管从来没有同时出现：

```
12:43:40.650 [CallbackQueue-Worker-2] DEBUG MyApplication - Received message 65bfbba29b4965eb0674c082c73dad7c
12:43:43.737 [CallbackQueue-Worker-3] DEBUG MyApplication - Received message 2a0b29012b13857c5a0ae8060f66dbaa
12:43:46.755 [CallbackQueue-Worker-3] DEBUG MyApplication - Received message 3c0742f9a284ac9c6b602200254c70db
12:43:49.769 [CallbackQueue-Worker-3] DEBUG MyApplication - Received message a462236fab19d51ba4bfea1582410a64
12:43:52.783 [CallbackQueue-Worker-3] DEBUG MyApplication - Received message 1a4713e1066dfc9e4ec1302098450a1f 
```

我在这里做错了什么？`ThreadPoolExecutorFactoryBean`我在我的或我的 RabbitMQ 代码中是否遗漏了一些额外的配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:22:33.917

根据 com.rabbitmq.client.Channel 的描述：

> 虽然一个 Channel 可以被多个线程使用，但确保只有一个线程同时执行一个命令很重要。命令的并发执行可能会导致抛出 UnexpectedFrameError。

这可能是一个原因吗？您的日志显示使用了不同的工人（我们看到 2 和 3），但一次只使用一个工人。

# ms-access-2003 - 比较 2 个列表框并在第 3 个列表框中显示不匹配的值

> ID：11677152
> 
> 赞同：1
> 
> 时间：2012-07-26T20:02:58.807
> 
> 标签：ms-access-2003

我已经为此工作了 2 天。基本上我有 2 个列表框，我想要一个命令按钮来比较值并显示不匹配的值（那些出现在第一个列表框中但不在第二个列表框中的值）并将它们列出在第三个列表框中。我不确定这是否是最好的方法，但这是我的代码。它与以下消息一致：

> 参数数量错误或属性分配无效

我的列表框被命名为 CompList1、CompList2 和 CompList3。

```
Dim BoolAdd As Boolean, I As Long, j As Long
'Set initial Flag
BoolAdd = True
'If CompList2 is empty then abort operation
If CompList2.ListCount = 0 Then
MsgBox "Nothing to compare"
Exit Sub
'If CompList1 is empty then copy entire CompList2 to CompList3
ElseIf CompList1.ListCount = 0 Then
For I = 0 To CompList2.ListCount
CompList3.AddItem CompList2.Value
Next I
Else
For I = CompList2.ListCount - 1 To 0 Step -1
For j = 0 To CompList1.ListCount
If CompList2.ListCount(I) = CompList1.ListCount(j) Then
'If match found then abort
BoolAdd = False
Exit For
End If
DoEvents
Next j
'If not found then add to CompList3
If BoolAdd = True Then CompList3.AddItem CompList2.Value
DoEvents
Next I
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:06:49.330

一些注意事项：

```
Dim tdf1 As TableDef
Dim tdf2 As TableDef
Dim db As Database

Set db = CurrentDb

Set tdf1 = db.TableDefs(Me.CompList1.RowSource)
For Each fld In tdf1.Fields
    sFields = sFields & ";" & fld.Name
Next

sFields = sFields & ";"

Set tdf2 = db.TableDefs(Me.CompList2.RowSource)
For Each fld In tdf2.Fields
    sf = ";" & fld.Name & ";"
    sFields = Replace(sFields, sf, ";")
Next

Me.CompList3.RowSource = Mid(sFields,2) 
```

编辑：

![字段列表，组合属性](../Images/fdd59c117f33ca518c4c9c31b21fffbf.png)

# delphi - 禁用功能区的 Powerpoint 保护模式 - 在 Delphi 中自动化

> ID：11677153
> 
> 赞同：0
> 
> 时间：2012-07-26T20:03:02.003
> 
> 标签：delphi, user-interface, automation, ms-office, powerpoint

我正在寻找一种使用 Delphi 通过自动化保护 powerpoint 演示文稿的方法。
在 Word 中，我可以发出以下命令：

```
 If (WordDocument.ProtectionType = wdNoProtection)
    Then WordDocument.Protect (3, VarTrue, VarProtectPass); 
```

在 Excel 中，我可以发出以下命令：

```
 { If the file was NOT protected, then protect it }
  For SheetIndex := 1 To ExcelWorkbook.Sheets.Count Do Begin

    VarSheet := SheetIndex;

    { Connect to the work sheet }
    ExcelWorksheet.ConnectTo (ExcelWorkbook.Worksheets.Item [VarSheet] As _Worksheet);

    ExcelWorksheet.Protect ()... 
```

问题是我找不到使用 OfficeXP.pas 组件的方法。我们在各种系统上运行 Office 2010。有任何想法吗？

我需要的是打开演示文稿的PowerPoint，1）对于MenuItem1，禁止用户进行任何编辑。此外，不允许他们将其重新保存到其他地方。2) 对于 MenuItem2，允许用户编辑演示文稿。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T16:01:47.983

一种方法是通过捕获事件的加载项：

捕获 PresentationBeforeSave 事件，如果需要，取消保存。

捕获 WindowSelectionChange 事件，测试以查看已选择的内容（由事件传递），并且在大多数情况下，DE-select 选择。如果用户不能选择某些东西，他们就不能编辑/更改它。

可以根据状态变量启用/禁用事件处理例程；您可能会捕获 PresentationOpen 事件，测试以查看新演示文稿是否是您的“受保护”演示文稿之一，如果是，则设置 boolIsProtected = True; 您的其他事件处理程序可以测试此变量并在为 False 时停止处理该事件。

# database - 使用 F# 创建插入语句

> ID：11677155
> 
> 赞同：2
> 
> 时间：2012-07-26T20:03:09.833
> 
> 标签：database, f#

我每隔几个月左右使用一次 F#，在这期间我似乎忘记了一切，所以我希望你能原谅我的无知。我下面的代码是从雅虎提取数据。这是一个很好的例子，代表了我需要做的事情。返回的第一行具有列标题。我需要获取数据（列表的尾部）并将其插入数据库。根据返回的列标题（列标题与数据库列名匹配）生成插入语句的最佳方法是什么？

在下面的示例中 dataWithHeaders.[0] 将包含“日期、打开、高、低、关闭、音量、调整关闭”。我是否应该只使用该字符串并在标题周围加上括号来创建插入？然后在 insertData 添加值作为参数？有没有更优雅的解决方案？

```
let url = System.String.Format("http://ichart.finance.yahoo.com/table.csv?s={0}&g=d&ignore=.csv", "FB")

let splitLineIntoArray (line : string) = 
    line.Split(",".ToCharArray())

let insertData (data : string[]) =
    // insert data
    ()

let client = new WebClient()
let dataWithHeaders = 
    client.DownloadString(url).Split(Environment.NewLine.ToCharArray())

let data =
    dataWithHeaders
    |> Array.toList
    |> List.tail
    |> List.map(splitLineIntoArray)
    |> List.iter insertData 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T20:18:16.843

If you're loading the data into SQL Server you can use [this excellent CSV reader](http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader) (free) and the [`SqlBulkCopy`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx) class. It's simple and efficient.

```
let loadStockPrices ticker =
  use client = new WebClient()
  let url = sprintf "http://ichart.finance.yahoo.com/table.csv?s=%s&g=d&ignore=.csv" ticker
  use stringReader = new StringReader(client.DownloadString(url))
  use csvReader = new CsvReader(stringReader, hasHeaders=true)
  use con = new SqlConnection("<connection_string>")
  con.Open()
  use bulkCopy = new SqlBulkCopy(con, DestinationTableName="<destination_table>")
  bulkCopy.WriteToServer(csvReader) 
```

The destination table should have the same columns as the incoming data (OHLC, etc).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T20:06:25.970

编辑：类型提供者可能是一个不错的方法，但 SqlBulkCopy 是定义。以其简单而闻名。

为插入键入提供程序代码：http: [//msdn.microsoft.com/en-us/library/hh361033 (v=vs.110).aspx#BKMK_UpdateDB](http://msdn.microsoft.com/en-us/library/hh361033(v=vs.110).aspx#BKMK_UpdateDB)

```
type dbSchema = SqlDataConnection<"Data Source=MYSERVER\INSTANCE;Initial Catalog=MyDatabase;Integrated Security=SSPI;">
let db = dbSchema.GetDataContext()

// Enable the logging of database activity to the console.
db.DataContext.Log <- System.Console.Out

let newRecord = new dbSchema.ServiceTypes.Table1(Id = 100,
                                                 TestData1 = 35, 
                                                 TestData2 = 2.0,
                                                 Name = "Testing123")
let newValues =
    [ for i in [1 .. 10] ->
          new dbSchema.ServiceTypes.Table3(Id = 700 + i,
                                           Name = "Testing" + i.ToString(),
                                           Data = i) ]
// Insert the new data into the database.
db.Table1.InsertOnSubmit(newRecord)
db.Table3.InsertAllOnSubmit(newValues)
try
    db.DataContext.SubmitChanges()
    printfn "Successfully inserted new rows."
with
   | exn -> printfn "Exception:\n%s" exn.Message 
```

我做了类似的事情。实际上，这段代码是我在观看 Luca Bolognese 的 F# 演示时编写的。这实际上会刮掉雅虎的提要并返回标准开发。和股票价格的差异。

完整项目在这里：[https ://github.com/djohnsonm/Stock-Ticker-App](https://github.com/djohnsonm/Stock-Ticker-App)

```
open System.Net
open System.IO

let internal loadPrices ticker = async {
let url = @"http://ichart.finance.yahoo.com/table.csv?s=" + ticker + "&d=6&e=22&f=2011&g=d&a=2&b=13&c=1986&ignore=.csv"
let req = WebRequest.Create(url)
let resp = req.GetResponse()
let stream = resp.GetResponseStream()
let reader = new StreamReader(stream)
let csv = reader.ReadToEnd()
let prices = 
    csv.Split([|'\n'|])
    |> Seq.skip 1
    |> Seq.map (fun line -> line.Split([|','|]))
    |> Seq.filter(fun values -> values |> Seq.length = 7)
    |> Seq.map(fun values ->
        System.DateTime.Parse(values.[0]),
        float values.[6])
return prices}

type StockAnalyzer (lprices, days) =
    let prices =
        lprices
        |> Seq.map snd
        |> Seq.take days
    static member GetAnalyzers (tickers, days) =
        tickers
        |> Seq.map loadPrices
        |> Async.Parallel
        |> Async.RunSynchronously
        |> Seq.map (fun prices -> new StockAnalyzer(prices, days))
    member s.Return =
        let lastPrice = prices |> Seq.nth 0
        let startPrice = prices |> Seq.nth(days-1)
        lastPrice / startPrice - 1.
    member s.StdDev =
        let logRets =
            prices
            |> Seq.pairwise
            |> Seq.map (fun (x,y) -> log(x/y))
        let mean = logRets |> Seq.average
        let sqr x = x * x
        let var = logRets |> Seq.averageBy (fun r -> sqr (r-mean))
        sqrt var 
```

# javascript - 将一个简单的 html 表格集成到 javascript 中

> ID：11677158
> 
> 赞同：0
> 
> 时间：2012-07-26T20:03:16.207
> 
> 标签：javascript, html

我被要求使用 javascript 创建一个表，该表显示用户给我的变量的简单算术，我确信我的语法在我的 document.write 中是关闭的，但我不确定在哪里以及如何。我的错误控制台说我在第 18 行缺少一个结束的 ')'，这根本不是真的。我看到在其他情况下，为此目的使用 document.write 函数是不受欢迎的，但它明确指出我应该这样做作为完成本实验的要求的一部分，所以我对这种违规行为事先表示诚挚的歉意.

代码如下 - 在此先感谢您的所有帮助：

```
<script>  
     var  e1="", e2="", e3="", e4="", e5="", e6="", e7="", e8="", e9="";

    e1 = prompt("Enter your first name in lower case", "");
    var e1u = substr(0, 1);
    e1 = e1u.toUpperCase() + e1.substr(1, e1.length-1);
    e2 = prompt(e1 + ", enter an integer from 1 to 9", "");
    e3 = prompt("Now enter 5 numbers delineated by a comma!", "");
    e4 = prompt("Now enter 3 colors delineated by a comma!");
    e5 = new date();
    e6 = e3.split(',');
    e7 = e4.split(',');
    document.write(""Today's Date = " + e5.getMonth()+1 + "/" + e5.getDay() +
    "/" + e5.getFullYear() + "\n" + "The number in e2 is " + e2 + "\n"
    + "<table><caption>Times Table for the number + e2 + "</caption>"");
    for(var i=0; i<13; i++)
    {
            document.write(""<tr>""<td>" + e2 + "</td>" + "<td>" + i + "</td>" + "<td>" + "=" + "</td>" + "<td>" + (e2 * 1) * i + "</td>""</tr>"");
    }               

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:06:02.407

我为您修复了以下内容：

```
document.write("Today's Date = " + e5.getMonth()+1 + "/" + e5.getDay() +
"/" + e5.getFullYear() + "\n" + "The number in e2 is " + e2 + "\n"
+ "<table><caption>Times Table for the number" + e2 + "</caption>"); 
```

和

```
document.write("<tr><td>" + e2 + "</td>" + "<td>" + i + "</td>" + "<td>" + "=" + "</td>" + "<td>" + (e2 * 1) * i + "</td></tr>"); 
```

不要重复引用，并使用语法高亮的编辑器。它将为您节省大量时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:06:20.730

这看起来不对：

```
+ "</td>""</tr>"" 
```

也许你想要

```
+ "</td></tr>" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:17:55.610

日期（），而不是日期（）

e1.substr，不只是 substr，我会使用 substring，而不是 substr

数字 e2 后缺少报价

我会这样做 [http://jsfiddle.net/mplungjan/eggWj/](http://jsfiddle.net/mplungjan/eggWj/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-26T20:06:52.097

表必须具有以下嵌套结构：

```
<table>
   <tr>
       <td> ... </td>
   </tr>
</table> 
```

您`<caption>`不能被放置在它所在的位置，并且可能完全属于 TD 或桌子之外。

# css - 用于在 deck.js 中嵌套幻灯片的轮播

> ID：11677161
> 
> 赞同：1
> 
> 时间：2012-07-26T20:03:41.733
> 
> 标签：css, carousel, css-transforms, deck.js

我正在使用 deck.js 进行演示。对于一张幻灯片，我想要一个带有数字/图像的静态标题，我可以轮播浏览。这是相关的HTML：

```
<section class="carousel slide">
  <h2>Static Title</h2>
  <figure class="slide"><figcaption>Text for first image</figcaption><img src="images/first_image.png" alt=""></figure>
  <figure class="slide"><figcaption>Text for second image</figcaption><img src="images/second_image.png" alt=""></figure>
  <figure class="slide"><figcaption>Text for third image</figcaption><img src="images/third_image.png" alt=""></figure> 
</section> 
```

这是我添加到deck.js 中的JS，以使其与deck.js 附带的水平滑动主题一起工作。

```
.carousel .deck-before {
    -webkit-transform: translate3d(-400%, 0, 0);
    -moz-transform: translate(-400%, 0);
    -ms-transform: translate(-400%, 0);
    -o-transform: translate(-400%, 0);
    transform: translate3d(-400%, 0, 0);
    height:0;
}

.carousel .deck-after {
    -webkit-transform: translate3d(400%, 0, 0);
    -moz-transform: translate(400%, 0);
    -ms-transform: translate(400%, 0);
    -o-transform: translate(400%, 0);
    transform: translate3d(400%, 0, 0);
    height:0;
}

.carousel .deck-next {
    -webkit-transform: translate3d(200%, 0, 0);
    -moz-transform: translate(200%, 0);
    -ms-transform: translate(200%, 0);
    -o-transform: translate(200%, 0);
    transform: translate3d(200%, 0, 0);
    height:0;
}

.carousel .deck-previous {
    -webkit-transform: translate3d(-200%, 0, 0);
    -moz-transform: translate(-200%, 0);
    -ms-transform: translate(-200%, 0);
    -o-transform: translate(-200%, 0);
    transform: translate3d(-200%, 0, 0);
    height:0;
} 
```

当图像的轮播正在前进时，这非常有用。但是，当我返回时，移出屏幕的图像会向下移动，因此它位于新图像进入的位置下方。

如何使从屏幕右侧移出的图像与从左侧出现在屏幕上的图像保持水平？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T00:55:18.150

问题的根源在于`height`没有过渡的事实，因此在类更改发生的那一刻，前一个元素立即具有高度，向下推仍未过渡到视野之外的幻灯片。

这是一个[相当难以解决](https://github.com/imakewebthings/deck.js/issues/23)的问题。您需要根据自己的需要做出一些选择。

首先，`height:0`从你的每一个之前/之后/上一个/下一个中取出，然后说`.carousel .slide { height: 0 }`.

**你需要deck.scale 扩展来工作，还是轮播后有幻灯片内容？**如果是这样，你需要给出`.carousel`一个高度来补偿。

**你事先知道那个高度吗？**只需在 CSS 中设置即可。

**不知道高度，或者只是想到处使用这个而不必每次都手动设置高度？**编写一个检查轮播内容并设置高度的小脚本。像这样的东西（未经测试，当心）：

```
$(window).load(function() {
  $('.carousel').each(function(carousel) {
    var $carousel = $(carousel);
    var maxHeight = 0;

    $carousel.each(function() {
      var height = $(this).height();
      maxHeight = Math.max(height, maxHeight);
    });

    $carousel.height(maxHeight);
  });
}); 
```

使用这样的脚本，请务必`height:0`从 CSS 中完全删除声明。

# android - 如何更新我自己的应用程序android？

> ID：11677165
> 
> 赞同：0
> 
> 时间：2012-07-26T20:03:56.070
> 
> 标签：android, google-play

我想为android创建一个游戏，但是这个游戏会有一个级别。如果我将我的应用程序放在 Android 电子市场中，我如何在它已经上传后更新这个应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:09:46.280

您必须提供将用户数据保存到文件或数据库的机制，使用户能够从他/她更新前的位置继续玩游戏。之后，当您拥有使用相同密钥签名的应用程序的新版本并上传到 android play 商店时，用户将收到通知并能够下载和更新您的应用程序。Android 设备上预装的 PlayStore 应用程序将完成该任务。每次用户启动您的应用程序时，检查设置文件并为用户设置应用程序的属性以继续播放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:19:36.920

You publish your apk via the [Developer Console](http://developer.android.com/distribute/googleplay/publish/console.html). You can upload unpublished drafts of your app without disturbing the published version. Once you choose to publish an update, then the Google Play store will offer the update to your existing users. Migrating your user's data is as described by [Maxim](https://stackoverflow.com/users/323128/maxim).

You can sign up for a Google Play publisher account here: [https://play.google.com/apps/publish](https://play.google.com/apps/publish)

# android - 恢复 Android Phonegap 应用程序的正确方法是什么？

> ID：11677175
> 
> 赞同：7
> 
> 时间：2012-07-26T20:04:30.273
> 
> 标签：android, cordova

我不确定这是否是预期的，是否是错误以及是否有解决方法。

当用户在我们的 Android Phonegap 应用程序中点击主页按钮时，应用程序会正确最小化。当用户单击图标启动应用程序时，它会从头开始重新启动。这是不可取的。

用户通过单击主页按钮最小化应用程序后，应用程序将通过两种方式正常恢复：

1.  长按主页按钮并单击应用程序将恢复应用程序的最后状态。
2.  单击状态栏中的通知（推送通知）将恢复应用程序的最后状态。

所以我的问题是，当用户从桌面单击应用程序图标时，我们需要做什么才能以与上述两项相同的方式恢复应用程序？正如上面列出的第 1 项所证实的那样，该应用程序正在运行且运行良好。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-27T10:00:05.597

我有同样的问题 。当我单击应用程序图标以在后台重新启动已经运行的应用程序时，我的应用程序正在重新启动。

基本上，如果`android:launchMode`设置为标准或未设置，则会为应用程序创建一个新意图，并且不会恢复应用程序的旧暂停状态。

所以我发现最好的方法是申请

> android:launchMode="singleTask"

在 AndroidManifest.xml -> 里面 `<activity>`。

请考虑这个例子：

```
 <activity android:name="Example" android:label="@string/app_name"
                 android:theme="@android:style/Theme.Black.NoTitleBar"
               android:configChanges="orientation|keyboardHidden|keyboard|screenSize|locale"
                 android:launchMode="singleTask">
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
                 <category android:name="android.intent.category.LAUNCHER" />
             </intent-filter>
         </activity> 
```

# php - 如何更改 Wordpress walker 菜单中子菜单锚点的输出？

> ID：11677177
> 
> 赞同：0
> 
> 时间：2012-07-26T20:04:41.113
> 
> 标签：php, wordpress, drop-down-menu

我将如何去除出现在子菜单中的锚点？它们应该只围绕顶层的锚点，但不幸的是它会像这样添加到所有锚点：

```
<ul class="menu">
    <li>
        <h2><a>First Item</a><h2>
        <ul class="sub-menu">
            <li><h2><a>Sub item</a><h2><li>     //<----- h2 tag, bad. :(
        <ul>
    <li>
</ul> 
```

我正在努力实现：

```
 <ul class="menu">
    <li>
        <h2><a>First Item</a><h2>
        <ul class="sub-menu">
            <li><a>Sub item</a><li>   //<----- no h2, good. :)
        <ul>
    <li>
</ul> 
```

* * *

目前使用这个walker类：

```
class Description_Walker extends Walker_Nav_Menu
{
/**
 * Start the element output.
 *
 * @param  string $output Passed by reference. Used to append additional content.
 * @param  object $item   Menu item data object.
 * @param  int $depth     Depth of menu item. May be used for padding.
 * @param  array $args    Additional strings.
 * @return void
 */
function start_el(&$output, $item, $depth, $args)
{
    $classes     = empty ( $item->classes ) ? array () : (array) $item->classes;

    $class_names = join(
        ' '
    ,   apply_filters(
            'nav_menu_css_class'
        ,   array_filter( $classes ), $item
        )
    );

    ! empty ( $class_names )
        and $class_names = ' class="'. esc_attr( $class_names ) . '"';

    $output .= "<li id='menu-item-$item->ID' $class_names>";

    $attributes  = '';

    ! empty( $item->attr_title )
        and $attributes .= ' title="'  . esc_attr( $item->attr_title ) .'"';
    ! empty( $item->target )
        and $attributes .= ' target="' . esc_attr( $item->target     ) .'"';
    ! empty( $item->xfn )
        and $attributes .= ' rel="'    . esc_attr( $item->xfn        ) .'"';
    ! empty( $item->url )
        and $attributes .= ' href="'   . esc_attr( $item->url        ) .'"';

    // insert description for top level elements only
    // you may change this
    $description = ( ! empty ( $item->description ) and 0 == $depth )
        ? '<small class="nav_desc">' . esc_attr( $item->description ) . '</small>' : '';

    $title = apply_filters( 'the_title', $item->title, $item->ID );

    $item_output = $args->before
        . "<h2><a $attributes>"
        . $args->link_before
        . $title
        . '</a></h2>'
        . $args->link_after
        . $description
        . $args->after;

    // Since $output is called by reference we don't need to return anything.
    $output .= apply_filters(
        'walker_nav_menu_start_el'
    ,   $item_output
    ,   $item
    ,   $depth
    ,   $args
    );
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:23:33.110

试试这个，基本上如果在类名中找到子菜单，它会去除 h2，否则将其保留。

```
$pos = strpos($class_names, "sub-menu");

if ($pos === false) {    
       $item_output = $args->before
        . "<h2><a $attributes>"
        . $args->link_before
        . $title
        . '</a></h2>'
        . $args->link_after
        . $description
        . $args->after;
} else {
         $item_output = $args->before
            . "<a $attributes>"
            . $args->link_before
            . $title
            . '</a>'
            . $args->link_after
            . $description
            . $args->after;
} 
```

# .net-3.5 - 如何根据与数据表中的给定值匹配的 A 列获取 B 列的值？

> ID：11677179
> 
> 赞同：0
> 
> 时间：2012-07-26T20:04:45.977
> 
> 标签：.net-3.5, lambda, datatable

我想在 A 列 =“123”找到的第一行中获取 B 列的值。

我试过：

```
dataTable.AsEnumerable().Select(row => row["value"].ToString() == "123").ToString(); 
```

但我得到**Expression cannot contain lambda expressions**。

任何帮助将不胜感激，谢谢。

编辑：

我基本上是在寻找 SQL 等价物：

```
Select ColumnB
From MyTable
Where ColumnA = '123' 
```

对于使用 lambda 表达式的数据表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T05:25:40.900

看看[`FirstOrDefault`方法](http://msdn.microsoft.com/en-us/library/bb549039.aspx)：

```
var foundRow = dataTable.AsEnumerable().FirstOrDefault(row => string.Equals (row["ColumnA"].ToString(), "123", StringComparison.OrdinalIgnoreCase ));
if (foundRow != null) {
    // We found a match, do something with it.
    var colBValue = foundRow["ColumnB"].ToString(); 
} 
```

`FirstOrDefault`返回与指定条件匹配的第一个元素，在这种情况下，它在 DataTable 的 [ColumnA] 列中查找字符串“123”。如果没有元素符合条件，`FirstOrDefault`则返回对象的默认值，对于 DataTable 是`null`。

我不知道为什么你会得到你显示的异常，当我试图重现它时我没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:09:18.057

我相信你正在寻找`Where`方法

```
dataTable.AsEnumerable().Select(row=>row["Value"].ToString()).Where(row => row["value"].ToString() == "123"); 
```

# android - 适用于 Android 2.3 的 Android 日历

> ID：11677182
> 
> 赞同：0
> 
> 时间：2012-07-26T20:05:04.280
> 
> 标签：android, android-calendar

我正在寻找要在屏幕上显示的日历。据我所知，CalenderView 小部件可从 API 级别 11 获得。CalendarView 可以与 API 10（Android 2.3.3）兼容吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:14:47.463

除非他们把它放在下一个版本的支持库中，否则答案是否定的。您将需要另一个像这样的日历小部件

[http://code.google.com/p/android-calendar-view/](http://code.google.com/p/android-calendar-view/)

说明：[http ://code.google.com/p/android-calendar-view/wiki/HowToUse](http://code.google.com/p/android-calendar-view/wiki/HowToUse)

# c++ - C++ - 定义 2 个模板参数但仅使用 1 个调用

> ID：11677188
> 
> 赞同：3
> 
> 时间：2012-07-26T20:05:18.690
> 
> 标签：c++, templates

在做一个项目时，我遇到了这段代码，我试图弄清楚：

```
enum Attributes { ACTIVE, COMPLETE, POSITION }
template<Attributes NN,typename TT>  
TT& Set(TT&& t) 
{ 
    return typeList.get<NN>()=t; //typeList is a boost tuple
} 
```

稍后调用

```
object.Set<ACTIVE>(true); 
```

里面只有一个模板参数！怎么可能用两个参数指定一个模板，然后只用一个参数调用它？我认为 Set 方法应该采用 2 个模板参数（属性和类型名），例如 std::map。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:06:42.190

第二个是从传递给函数的参数类型推导出来的，在这种情况下`bool`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:07:31.120

调用函数模板模板参数时，可以从参数的类型自动推断出函数参数的类型，调用函数时：

```
object.Set<ACTIVE>(true); //same as object.Set<Active,bool>(true);
object.Set<ACTIVE>(5);    //same as object.Set<Active,int>(5); 
```

这就是可以使用标准库中的模板函数的原因，`std::max`无论`std::copy`是否明确提及参数的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:14:15.130

读这个。

> 当一个函数模板特化被引用时，所有的模板参数都应该有值。这些值可以明确指定，或者在某些情况下，可以从使用中推导出来或从默认模板参数中获取。

```
[ Example:
void f(Array<dcomplex>& cv, Array<int>& ci) {
sort(cv); // calls sort(Array<dcomplex>&)
sort(ci); // calls sort(Array<int>&)
}
and
void g(double d) {
int i = convert<int>(d); // calls convert<int,double>(double)
int c = convert<char>(d); // calls convert<char,double>(double)
}
—end example ] 
```

和本文档的 14.8.2 标准。[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)

# objective-c - iOS 正则表达式：定位货币名称

> ID：11677189
> 
> 赞同：0
> 
> 时间：2012-07-26T20:05:19.490
> 
> 标签：objective-c, ios, regex

简单的正则表达式问题。你的回答将帮助我理解未来的表达方式......

假设我有这个字符串“Send today @ 1 USD to 13.6512 MXN”，我想定位 USD 和 MXN。是否有一个正则表达式可以同时返回两个值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:07:25.410

我现在没有办法自己检查它，但是 /[AZ]{3}/ 这样的东西应该可以工作，因为它们都是 3 个字符长。

编辑：删除 ^ 和 $ 就像 mason81 说的。

# javascript - cubism.js 和 Internet Explorer

> ID：11677193
> 
> 赞同：0
> 
> 时间：2012-07-26T20:05:45.637
> 
> 标签：javascript, cross-browser, d3.js, cubism.js

上周我完成了一个使用 d3.js 和 cubism.js 的网站。在开发过程中，我偶然发现了一些问题，但总是能够解决它们。在项目的最后一次会议上，我的同事产生了用微软的 Internet Explorer 打开网站的想法。它完全失败了。一些功能没有执行，似乎没有任何效果。IE 抛出了一大堆“Script87：无效参数”错误，它们起源于 d3 和 cubism 的代码。我知道 IE 的缺点和它可能导致的问题。

有没有办法让 d3.js 和 cubism.js 与 IE 一起工作？这些库是否有可能与 IE 兼容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T00:02:05.543

由于缺乏 SVG 支持，d3 不支持 IE 8 或更早版本。见[https://github.com/mbostock/d3/issues/42](https://github.com/mbostock/d3/issues/42)

# php - 对于每个循环学习者

> ID：11677198
> 
> 赞同：0
> 
> 时间：2012-07-26T20:06:02.453
> 
> 标签：php, for-loop

我目前正在尝试获取以下内容

```
['orders.customerlock'] from the following information

string(3145) "{"recsonpage":"6","6":{"orders.orderid":"x","entity.customerid":"x","entity.entityid":"x","orders.endtime":"x","orders.resellerlock":"false","orders.timestamp":"2012-07-16 18:30:36.76788+00","orders.customerlock":"true","entity.entitytypeid":"3","entity.currentstatus":"Active","entitytype.entitytypekey":"domcno","orders.transferlock":"true","orders.creationtime":"1342463436","entitytype.entitytypename":".COM Domain Name","orders.creationdt":"1342463436","entity.description":"x"},"5":{"orders.orderid":"x","entity.customerid":"x","entity.entityid":"44331779","orders.endtime":"1370362990","orders.resellerlock":"false","orders.timestamp":"2012-06-04 16:23:12.282333+00","orders.customerlock":"true","entity.entitytypeid":"3","entity.currentstatus":"Active","entitytype.entitytypekey":"domcno","orders.transferlock":"true","orders.creationtime":"1338826990","entitytype.entitytypename":".COM Domain Name","orders.creationdt":"1338826990","entity.description":"estavisapplication.com"},"4":{"orders.orderid":"x","entity.customerid":"x","entity.entityid":"44199575","orders.endtime":"1369853889","orders.resellerlock":"false","orders.timestamp":"2012-05-29 18:58:11.219513+00","orders.customerlock":"true","entity.entitytypeid":"3","entity.currentstatus":"Active","entitytype.entitytypekey":"domcno","orders.transferlock":"true","orders.creationtime":"1338317889","entitytype.entitytypename":".COM Domain Name","orders.creationdt":"1338316103","entity.description":"x"},"3":{"orders.orderid":"x","entity.customerid":"x","entity.entityid":"43923731","orders.endtime":"1368676977","orders.resellerlock":"false","orders.timestamp":"2012-06-04 16:47:25.45736+00","orders.customerlock":"true","entity.entitytypeid":"2","entity.currentstatus":"Suspended","entitytype.entitytypekey":"dominfo","orders.transferlock":"true","orders.creationtime":"1337140977","entitytype.entitytypename":".INFO Domain Name","orders.creationdt":"1337140977","entity.description":"x"},"2":{"orders.orderid":"x","entity.customerid":"x","entity.entityid":"43885152","orders.endtime":"1400025600","orders.resellerlock":"false","orders.timestamp":"2012-05-14 18:40:40.744535+00","orders.customerlock":"false","entity.entitytypeid":"64","entity.currentstatus":"Active","entitytype.entitytypekey":"thirdleveldotuk","orders.transferlock":"false","orders.creationtime":"1336953600","entitytype.entitytypename":"ThirdLevel DotUK Domain Name","orders.creationdt":"1337019369","entity.description":"x"},"recsindb":"6","1":{"orders.orderid":"x","entity.customerid":"x","entity.entityid":"x","orders.endtime":"1397779200","orders.resellerlock":"false","orders.timestamp":"2012-04-18 01:31:08.774762+00","orders.customerlock":"false","entity.entitytypeid":"64","entity.currentstatus":"Active","entitytype.entitytypekey":"thirdleveldotuk","orders.transferlock":"false","orders.creationtime":"1334707200","entitytype.entitytypename":"ThirdLevel DotUK Domain Name","orders.creationdt":"1334705745","entity.description":"x"}}" 
```

我们遇到的唯一问题是，当我们尝试使用以下内容时：

```
<? foreach ($json_a as $person_name => $person_a) {
echo $person_a['orders.customerlock'];
echo "<br>";
}

?> 
```

它显示以下内容：

```
6
true
true
true
true
false
6
false 
```

6 和其他 6 来自页面上的其他字段，有什么办法可以阻止 foreach 拾取这些

对文本的大小表示歉意，我认为最好让您查看完整的文本集，以便您可以查看有哪些参考资料

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:12:23.363

如果您`$json_a`是帖子中的字符串，那么您必须使用`json_decode()`函数将其解码为 php 数组。手册中的更多内容：http: [//php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:21:37.450

```
$json_a = '{"recsonpage":"6","6":{"orders.orderid":"45034426","entity.customerid":"8557610","entity.entityid":"45034426","orders.endtime":"1373999436","orders.resellerlock":"false","orders.timestamp":"2012-07-16 18:30:36.76788+00","orders.customerlock":"true","entity.entitytypeid":"3","entity.currentstatus":"Active","entitytype.entitytypekey":"domcno","orders.transferlock":"true","orders.creationtime":"1342463436","entitytype.entitytypename":".COM Domain Name","orders.creationdt":"1342463436","entity.description":"jaimeservices.com"},"5":{"orders.orderid":"44331779","entity.customerid":"8392441","entity.entityid":"44331779","orders.endtime":"1370362990","orders.resellerlock":"false","orders.timestamp":"2012-06-04 16:23:12.282333+00","orders.customerlock":"true","entity.entitytypeid":"3","entity.currentstatus":"Active","entitytype.entitytypekey":"domcno","orders.transferlock":"true","orders.creationtime":"1338826990","entitytype.entitytypename":".COM Domain Name","orders.creationdt":"1338826990","entity.description":"estavisapplication.com"},"4":{"orders.orderid":"44199575","entity.customerid":"8371124","entity.entityid":"44199575","orders.endtime":"1369853889","orders.resellerlock":"false","orders.timestamp":"2012-05-29 18:58:11.219513+00","orders.customerlock":"true","entity.entitytypeid":"3","entity.currentstatus":"Active","entitytype.entitytypekey":"domcno","orders.transferlock":"true","orders.creationtime":"1338317889","entitytype.entitytypename":".COM Domain Name","orders.creationdt":"1338316103","entity.description":"listmyhost.com"},"3":{"orders.orderid":"43923731","entity.customerid":"8308173","entity.entityid":"43923731","orders.endtime":"1368676977","orders.resellerlock":"false","orders.timestamp":"2012-06-04 16:47:25.45736+00","orders.customerlock":"true","entity.entitytypeid":"2","entity.currentstatus":"Suspended","entitytype.entitytypekey":"dominfo","orders.transferlock":"true","orders.creationtime":"1337140977","entitytype.entitytypename":".INFO Domain Name","orders.creationdt":"1337140977","entity.description":"wso-shell.info"},"2":{"orders.orderid":"43885152","entity.customerid":"8301781","entity.entityid":"43885152","orders.endtime":"1400025600","orders.resellerlock":"false","orders.timestamp":"2012-05-14 18:40:40.744535+00","orders.customerlock":"false","entity.entitytypeid":"64","entity.currentstatus":"Active","entitytype.entitytypekey":"thirdleveldotuk","orders.transferlock":"false","orders.creationtime":"1336953600","entitytype.entitytypename":"ThirdLevel DotUK Domain Name","orders.creationdt":"1337019369","entity.description":"com-bios.co.uk"},"recsindb":"6","1":{"orders.orderid":"43312036","entity.customerid":"8183814","entity.entityid":"43312036","orders.endtime":"1397779200","orders.resellerlock":"false","orders.timestamp":"2012-04-18 01:31:08.774762+00","orders.customerlock":"false","entity.entitytypeid":"64","entity.currentstatus":"Active","entitytype.entitytypekey":"thirdleveldotuk","orders.transferlock":"false","orders.creationtime":"1334707200","entitytype.entitytypename":"ThirdLevel DotUK Domain Name","orders.creationdt":"1334705745","entity.description":"phsd.co.uk"}}';

$json_a = json_decode($json_a, true);

foreach ($json_a as $person_name => $person_a) {
    if (is_array($person_a)) {
        echo $person_a['orders.customerlock'] . "<br>";
    }
} 
```

# c - c中内存地址的近乎完美或完美散列

> ID：11677201
> 
> 赞同：6
> 
> 时间：2012-07-26T20:06:16.293
> 
> 标签：c, perfect-hash

我有一个从 0xc0003000 到 0xc04a0144 的内存地址列表，列表中有很多间隙和 < 4096 个条目。它在编译时就知道了，我想为它做一个完美的哈希。

然而，在网上查找完美散列给我的信息主要与散列字符串相关，而且它们似乎翻译得不好。

为了清楚起见，我希望能够在运行时获取内存地址并快速检查它是否在散列中。目前我正在使用平均大约 8 个循环来找到答案的二进制搜索。

任何想法我应该吠叫什么树？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T20:31:36.860

这是一个示例 gperf 程序。我在示例数据中包含了一个 NUL 和一个换行符，以证明它们不会导致它失败。

```
%{
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <inttypes.h>
#include <arpa/inet.h>
%}
%%
"\xc0\x01\x02\x03"
"\xc0\xff\xff\xff"
"\xc0\xff\x00\xff"
"\xc0\x0a\xff\xff"
%%
int main(int argc, const char **argv)
{
    int i;

    for(i=1;i<argc;++i) {
        uint32_t addr = ntohl(strtoul(argv[i], 0, 16));
        if(in_word_set((char *)&addr, 4))
            printf("0x%08"PRIx32" is in the list.\n", htonl(addr));
        else
            printf("0x%08"PRIx32" is not in the list.\n", htonl(addr));
    }
    return 0;
} 
```

另存为`addrs.gperf`，编译和测试

```
gperf -l addrs.gperf > addrs.c
gcc addrs.c -o addrs
./addrs c0000000 c0010203 c0ffffff c00affff c0ff0aff c0ffff00 c0ff00ff 
```

# excel - 从多个excel表更新数据

> ID：11677206
> 
> 赞同：0
> 
> 时间：2012-07-26T20:06:37.383
> 
> 标签：excel, vba

我对如何将多个 Excel 工作表中的数据更新到主工作表中的一列有疑问。每当我们输入新行时，我希望它在主表中自动更新。该值是 id 因此它在多个工作表中是唯一的。例如：

Excel表1：

```
ID
---
1
2
3
4
5 
```

Excel表2：

```
ID
---
12
23
34
41
53 
```

Excel表3：

```
ID
---
123
215
324
445
562 
```

主 Excel 表：

```
ID
---
1
2
3
4
5
12
23
34
41
53
123
215
324
445
562 
```

每当我输入新值（如 6（对于工作表 1））时，它将更新为主工作表。

我可以这样做吗？我们需要使用宏吗？谢谢。

使用 SheetChange() 更新代码

* * *

```
 With DataEntrySheet

         '** Set variables for using the Find method in a loop
        Set loopRng = DataEntrySheet.Columns(1)
        Set lookRng = MasterSheet.Columns(2)

         '** Set the range which will be used to write data if found
        Set OldLastCell = DoNotEditSheet.Range( _
        "C65536").End(xlUp).Offset(1)

         '** Start the Find loop
        For Each iCel In loopRng

             '** Using the Find method to find the cell value.
            Set foundRng = lookRng.Find(iCel.Value, lookRng.Cells(1), _
            xlValues, xlWhole, MatchCase:=True)

             '** Test if the variable 'foundRng' is Nothing.  If the value
             '   was not found, the variable will be Nothing, or else it
             '   will be the Range Object of that (first) found value.
            If foundRng Is Nothing Then

                 '** Use the two ranges to transfer data (faster than Copy/Paste).
                OldLastCell.Value = iCel.Value
                OldLastCell.Offset(, -1).Value = iCel.Offset(, -1).Value
                OldLastCell.Offset(, 2).Value = iCel.Offset(, 1).Value
                OldLastCell.Offset(, 5).Value = iCel.Offset(, 2).Value
                OldLastCell.Offset(, 10).Value = iCel.Offset(, 3).Value

                 '** Reset the variable to be one row below where we wrote the
                 '   data to.  This will keep the data organized by rows.
                Set OldLastCell = OldLastCell.Offset(1)

            End If

             '** This MUST be set to Nothing before the next iteration.  If not,
             '   and a match is not found (following a good find) then you may
             '   have mismatched iterations with false results.
            Set foundRng = Nothing
        Next iCel
    End With
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:34:15.037

您可以使用该`SheetChange()`事件来更新主工作表，但这可能会大大减慢数据输入的速度。

`SheetChange`每次有人输入数据并移动到另一个单元格时，该事件都会运行您的代码。理想情况下，您只想在数据集中的每一列都完成时检查新数据。

我建议使用一个按钮，当新行输入完成并准备好输入主表时，您可以按下该按钮。网络上有许多代码示例，它们会将不匹配的行添加到新工作表中。

# mysql - 有没有办法自下而上搜索 mySQL 行并根据参数更改结果？

> ID：11677207
> 
> 赞同：1
> 
> 时间：2012-07-26T20:06:39.913
> 
> 标签：mysql, database, joomla, joomla-extensions

有没有办法将所选内容 0 或 1 转换为 no 或 yes 并从表格底部向上搜索？

```
UPDATE #__comprofiler   
SET cb_trainingpass =   ( SELECT c_passed
FROM #__quiz_r_student_quiz
WHERE #__quiz_r_student_quiz.c_student_id = #__comprofiler.user_id)
WHERE EXISTS
  ( SELECT c_passed
FROM #__quiz_r_student_quiz
WHERE #__quiz_r_student_quiz.c_student_id = #__comprofiler.user_id); 
```

当用户进行测试时，他们会得到 0 = 未通过或 1 = 通过的结果。我将其发送到 cb_trainingpass 字段，并希望它是 yes（通过）或 no。此外，用户多次参加测试，他们的最新结果就是我想要提取的结果，不幸的是，这个查询会拉出顶部的结果或第一个结果，永远不会找到最新的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:21:15.737

尝试类似的东西

```
UPDATE #__comprofiler   
SET cb_trainingpass =   ( SELECT if(c_passed=1,'yes','no')
FROM #__quiz_r_student_quiz
WHERE #__quiz_r_student_quiz.c_student_id = #__comprofiler.user_id
order by #__quiz_r_student_quiz.YOURDATEFIELD desc)
WHERE EXISTS
  ( SELECT c_passed
FROM #__quiz_r_student_quiz
WHERE #__quiz_r_student_quiz.c_student_id = #__comprofiler.user_id); 
```

# ruby-on-rails - postgres 偏移量/限制与 mysql 的工作方式不同吗？

> ID：11677212
> 
> 赞同：0
> 
> 时间：2012-07-26T20:06:46.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, postgis

我有一个带有评分列（整数）的帖子模型的 Rails 应用程序（postgres + postGIS）。如果我进入控制台并执行以下操作：

```
Post.order("rating DESC").map(&:id)
=> [9, 15, 19, 6, 17, 5, 4, 16, 1, 3, 13, 20, 14, 10, 8, 12, 7, 2, 18, 11] 
```

但是，如果我尝试通过限制和偏移一次循环遍历那些，我会得到奇怪的结果。

```
Post.order("rating DESC").limit(1).offset(0)
=> [#<Post id: 5, body: "Hi", rating: 4, location: #<RGeo::Geographic::SphericalPointImpl:0x81bb34c0 "POINT (-118.495 34.017)">, user_id: 8, created_at: "2012-07-25 22:43:41", updated_at: "2012-07-25 22:43:41">] 
```

为什么那个帖子是#5？应该是#9。无论如何，当我应用偏移量时，它会变得更加古怪。

```
>Post.order("rating DESC").limit(1).offset(1)
=> [#<Post id: 5, body: "Hi", rating: 4, location: #<RGeo::Geographic::SphericalPointImpl:0x81bb34c0 "POINT (-118.495 34.017)">, user_id: 8, created_at: "2012-07-25 22:43:41", updated_at: "2012-07-25 22:43:41">]

>Post.order("rating DESC").limit(1).offset(2)
=> [#<Post id: 5, body: "Hi", rating: 4, location: #<RGeo::Geographic::SphericalPointImpl:0x81bb34c0 "POINT (-118.495 34.017)">, user_id: 8, created_at: "2012-07-25 22:43:41", updated_at: "2012-07-25 22:43:41">]

>Post.order("rating DESC").limit(1).offset(3)
=> [#<Post id: 5, body: "Hi", rating: 4, location: #<RGeo::Geographic::SphericalPointImpl:0x81bb34c0 "POINT (-118.495 34.017)">, user_id: 8, created_at: "2012-07-25 22:43:41", updated_at: "2012-07-25 22:43:41">]

>Post.order("rating DESC").limit(1).offset(4)
=> [#<Post id: 15, body: "I luv coffee", rating: 4, flagged: 0, location: #<RGeo::Geographic::SphericalPointImpl:0x82260df4 "POINT (-118.495 34.017)">, user_id: 1, created_at: "2012-07-25 22:43:41", updated_at: "2012-07-25 22:43:41">] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:35:23.420

你注意到`rating`你展示的唯一结果是 4 吗？您在`rating`没有辅助排序键的情况下进行排序，因此无法保证将出现什么顺序关系，甚至无法保证在两个不同的调用中关系会以相同的方式排序。

尝试在您的`order`:

```
Post.order('rating DESC, id') 
```

然后包含`rating`在您正在查看的内容中：

```
Post.order('rating desc, id').select('id, rating').map { |p| [ p.id, p.rating ] }
Post.order('rating desc, id').select('id, rating').limit(1).offset(3).map { |p| [ p.id, p.rating ] }
#... 
```

这应该会给你合理和一致的结果。

# jquery - 计算父 div 的宽度和高度并相应地应用于图像

> ID：11677222
> 
> 赞同：2
> 
> 时间：2012-07-26T20:07:07.987
> 
> 标签：jquery, scale

我有一个父 div，它具有响应宽度和固定高度，其中包含一些图像。在运行时，我需要一个 Jquery 函数来计算 div 的宽度和高度，并将宽度（px）和高度（px）参数应用于图像。即我现在的代码是

```
<div id="slider-wrapper" class="someclass">
    <img src="/image1.jpg" alt="" />
    <img src="/image2.jpg" alt="" />
    <img src="/image3.jpg" alt="" />
</div> 
```

我需要的生成代码是

```
 <div id="slider-wrapper" class="someclass">
    <img src="/image1.jpg" height="300px" width="total-div-width(px)" alt="" />
    <img src="/image2.jpg" height="300px" width="total-div-width(px)" alt="" />
    <img src="/image3.jpg" height="300px" width="total-div-width(px)" alt="" />
</div> 
```

谢谢你的期待

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T20:09:41.057

使用 jQuery，您可以使用`.height()`,`.innerHeight()`或`.outerHeight()`.

区别在于：

*   `height()`仅返回元素的高度，无边框，无边距，无内边距
*   `innerHeight()`返回元素高度和填充
*   `outerHeight()`返回元素高度、内边距和边框
*   `outerHeight(true)`返回元素高度、内边距、边框和边距

[我有更多详细信息，包括在这篇文章](https://stackoverflow.com/a/11248902/448144)中使用 jsFiddle 的输出示例。

`width()`对于宽度，您可以使用`innerWidth()`或`outerWidth()`。
与高度相同的逻辑适用。

所有值都以像素为单位。

要获得高度/宽度，您可以使用它类似于：

```
// The below is an example, you need to add your element references as required.

// Use height(), innerHeight() or outerHeight() as needed.
var newHeight = $("#slider-wrapper").height();

// Use width(), innerWidth() or outerWidth() as needed.
var newWidth = $("#slider-wrapper").width(); 
```

要设置高度/宽度，您可以使用类似于：

```
// The below is an example, you need to add your element references as required.
var newHeight = $("#slider-wrapper img").height(newHeight);
var newWidth = $("#slider-wrapper img").width(newWidth); 
```

# c++ - C++——我可以使用没有在头文件中实现的模板函数吗？

> ID：11677223
> 
> 赞同：5
> 
> 时间：2012-07-26T20:07:07.647
> 
> 标签：c++, templates

> **可能重复：**
> [将 C++ 模板函数定义存储在 .CPP 文件中](https://stackoverflow.com/questions/115703/storing-c-template-function-definitions-in-a-cpp-file)
> [为什么模板只能在头文件中实现？](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)
> [为什么模板类的实现和声明应该在同一个头文件中？](https://stackoverflow.com/questions/3749099/why-should-the-implementation-and-the-declaration-of-a-template-class-be-in-the)

我有三个文件。在一个 base.h 中，我有一个类，它有一个使用模板的成员：

```
class Base {
    protected:
        template <class T>
            void doStuff(T a, int b);
}; 
```

在 base.cpp 中，我实现了 Base::doStuff()：

```
#include "base.h"

template <class T>
void Base::doStuff(T a, int b) {
    a = b;
} 
```

然后我尝试在我的项目的另一个类中使用它：

```
#include "base.h"

void Derived::doOtherStuff() {
    int c;
    doStuff(3, c);
} 
```

但我收到一个链接错误，指出它找不到'doStuff（int，int）'

据我所知，如果不将此函数的实现移动到头文件中，这在 C++03 中是不可能的。有没有一种干净的方法可以做到这一点？（我可以使用 C++11x 功能）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:11:39.007

Its a common idiom to place template definitions into an `.inl` file along with inline function definitions, and include it at the end of `.h` file:

base.h

```
#ifndef BASE_H
#define BASE_H

class Base {
    protected:
        template <typename T>
        void doStuff(T a, int b);
};

#include "base.inl"

#endif 
```

base.inl

```
template <typename T>
void Base::doStuff(T a, int b) {
    a = b;
} 
```

# java - Java 资源 - 在目录树中使用远处的文件

> ID：11677225
> 
> 赞同：1
> 
> 时间：2012-07-26T20:07:12.060
> 
> 标签：java, resources, classpath

**我有一个新手 Java 问题。**

我必须为我们在 SQL Server 中使用的一些存储过程制作一套 J/DBUnit 测试。这些测试在我最初放置在与我的 Java 项目相同的目录中的几个子目录中使用一些 XML 文件。

无论如何，在签入这些测试后，我们的 SVN 管理器希望将 .java 文件保留在树的一部分中，并将资源（如 XML 文件和所需的 JAR）保留在树的另一部分中。

因此，我的测试最初使用相对路径引用了 XML 文件，但现在不起作用。

**我的问题是：**

1.  我可以通过 CLASSPATH 使包含我的 XML 文件的目录可用（我希望如此）。
2.  假设可行，我如何在我的代码中引用以这种方式包含的文件？
3.  如果我不应该为此使用 CLASSPATH，我愿意接受其他解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:13:00.910

忘记类路径。为您的测试提供一个参数/配置，该参数/配置定义了 XML 文件的相对路径的根目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:37:34.433

使用classpath没问题，标准的maven项目布局如下：

*   源代码
    *   主要的
        *   爪哇
        *   资源
    *   测试
        *   爪哇
        *   资源
*   目标
    *   班级
    *   测试类

编译器将 src/main/java 编译为 target/classes，将 src/main/resources 的资源复制到 target/classes 文件夹，测试类似。如果测试有一个包含类和测试类的类路径，那么一切正常。

您的项目布局如何，如何构建？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:15:53.210

不，您不应该在这种情况下使用 CLASSPATH，因为它是由 Java 使用的。但是，您可以通过从环境变量或配置文件中加载一个值来使用类似的方法，该值指示存储 XML 文件的目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T20:38:52.027

您可以在不更改类路径的情况下执行此操作。想法是将资源文件存储在单独的目录中，但在运行构建过程时将它们复制到类路径中的目录中。

这是一个示例配置：

```
source Directory is ${basedir}/src/main/java

resource directory is ${basedir}/src/main/resources 
```

在您的构建脚本中，将*.java 文件和资源文件 (* .xml) 复制到类路径中的目录中，例如：

```
${basedir}/target/classes 
```

您的测试代码针对目标目录运行。目标目录未签入 SVN，让您的 SVN 管理员满意，并且您不必更改代码。

# ruby-on-rails-3 - 使用 Rails 检测新会话

> ID：11677232
> 
> 赞同：1
> 
> 时间：2012-07-26T20:07:32.733
> 
> 标签：ruby-on-rails-3, session

我有一个背景工作，可以抓住用户的 Facebook 朋友。

我希望每次登录用户启动新的浏览器会话时触发此后台作业。我不确定什么构成 Rails 的“新”会话的技术定义，但理想情况下，只要用户在一段时间不活动后（例如，自上次访问以来超过 30 分钟）点击该站点，它就会触发。

如何在 Rails 中检测到这样的新会话？感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T01:10:42.997

这是我能做的最好的解决它。我正在使用会话变量。我的 application_controller 中有这个方法和 before_filter。似乎工作得很好，但我注意到有一些特殊的东西（例如，Pusher）会重置会话变量，所以一定要监控是否使用这个解决方案。如果有人有更好的解决方案，我会全力以赴。

```
def call_set_facebook_friends
  if session[:new_session] == nil && signed_in?
    current_user.background_set_facebook_friends
    session[:new_session] = true
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:42:41.057

如果您使用的是设计，`last_sign_in_at`则表中有一列`users`。您的后台作业可以使用它来检查用户最近是否访问过您的站点。

# php - 如何使用 Ajax/JS 清除表单

> ID：11677235
> 
> 赞同：2
> 
> 时间：2012-07-26T20:07:38.417
> 
> 标签：php, jquery, ajax, forms

> **可能重复：**
> [用于清除表单所有字段的 jQuery/Javascript 函数](https://stackoverflow.com/questions/6653556/jquery-javascript-function-to-clear-all-the-fields-of-a-form)

提交后我需要清除表单，但我见过的方法都不适合我。我正在使用我购买的脚本，但作者没有回答我的请求。我有这个 JS 文件：

```
$('#contact_form').submit(function () {
        $.ajax({
            type: 'POST',
            url: 'contact.php',
            data: {
                name: $('#contact_form input#name').val(),
                email: $("#contact_form input#email").val(),
                text: $("#contact_form textarea").val()
            },
            success: function(data) {
                if ( data == 'sent' ) {
                    $('#contact_form .status').html('Thanks');
                } else if ( data == 'invalid' ) {
                    $('#contact_form .status').html('Invalid.');
                } else {
                    $('#contact_form .status').html('Can't send message.');                 
                }
            },
            error: function () {
                $('#contact_form .status').html('Can't send message.');
            }
        });
        return false;
    });

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T20:09:45.927

你的意思是除了基本的`document.getElementById("contact_form").reset()`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:30:41.140

```
$('#contact_form').submit(function () {
    $.ajax({
        type: 'POST',
        url: 'contact.php',
        data: $('#contact_form').serialize(),
        success: function(data) {
            if ( data == 'sent' ) {
                $('#contact_form .status').html('Thanks');
            } else if ( data == 'invalid' ) {
                $('#contact_form .status').html('Invalid.');
            } else {
                $('#contact_form .status').html("Can't send message.");
            }
            $('#contact_form').trigger("reset");
        },
        error: function () {
            $('#contact_form .status').html("Can't send message!");
        }
    });
    return false;
}); 
```

# sql - 循环更新多列？

> ID：11677236
> 
> 赞同：0
> 
> 时间：2012-07-26T20:07:40.777
> 
> 标签：sql, loops

我有一个 select 语句，我想将它转换为 table 中所有具有 name 的列的更新语句`Variable[N]`。

例如，我想做这些事情：

1.  我希望能够将下面的 SQL 转换为更新语句。
2.  我有`n`名为 的列`variable[N]`。下面的示例仅更新 column `variable63`，但我想在不知道我提前有多少列的情况下动态地对所有具有名称`variable1`的列运行更新。此外，在下面的示例中，我将更新的结果放入. 如果可能的话，我实际上想用结果更新相应的变量列，在下面的示例中。`variableN``variable[N]``NewCol``variable63`

我想要一个包装器循环遍历列`variable1`并`variableN`在所有这些列上执行相同的相应更新操作：

```
SELECT  
     projectid
    ,documentid
    ,revisionno
    ,configurationid
    ,variable63
    ,ISNULL(Variable63, 
            (SELECT TOP 1 
             variable63 
             FROM table1 
             WHERE 
                 documentid = t.documentid 
             and projectid=t.projectid
             and configurationid=t.configurationid 
             and cast(revisionno as int) < cast(t.revisionno as int) 
             AND Variable63 is NOT NULL 
             ORDER BY 
              projectid desc
             ,documentid desc
             ,revisionno desc
             ,configurationid desc
             )) as NewCol
FROM    table1 t; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T21:13:49.357

好的，我想我明白了。循环遍历列并为每列运行更新命令的函数。

```
DECLARE @sql NVARCHAR(1000),
@cn NVARCHAR(1000)--,
--@r NVARCHAR(1000),
--@start INT

DECLARE col_names CURSOR FOR
SELECT column_name
FROM information_schema.columns
WHERE table_name = 'PIVOT_TABLE'
ORDER BY ordinal_position

--SET @start = 0
DECLARE @op VARCHAR(max)
SET @op=''

OPEN col_names FETCH next FROM col_names INTO @cn

WHILE @@FETCH_STATUS = 0
BEGIN
    --print @cn
    IF UPPER(@cn)<> 'DOCUMENTID' and UPPER(@cn)<> 'CONFIGURATIONID' and UPPER(@cn)<> 'PROJECTID' and UPPER(@cn)<> 'REVISIONNO'
    BEGIN
        SET @sql = 'UPdate pt
        set pt.' + @cn + ' = ((SELECT TOP 1 t.' + @cn + ' FROM pivot_table t WHERE t.documentid = pt.documentid and t.projectid=pt.projectid
        and t.configurationid=pt.configurationid and cast(t.revisionno as int) < cast(pt.revisionno as int) AND t.' + @cn + ' is NOT NULL 
        ORDER BY revisionno desc)) from PIVOT_TABLE pt where pt.' + @cn + ' is NULL;'
        EXEC Sp_executesql
        @sql
        --print @cn
    END
    FETCH next FROM col_names INTO @cn
END

CLOSE col_names
DEALLOCATE col_names; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:59:11.140

没有通用的方法来遍历 SQL 中的变量，您应该确切地知道要修改什么。在某些数据库中，可以查询系统表以动态构建更新语句（我知道如何在 InterBase 和它的前身 Firebird 中做到这一点），但是您没有告诉我们您正在使用哪个数据库引擎。

下面是一种可以更新几个为空的字段的方法，COALESCE 和 CASE 是做同样事情的两种方法，就像使用 LEFT JOIN 或 NOT EXISTS 一样。使用您和您的数据库引擎最熟悉的那些。请注意，所有记录都将被更新，因此如果您的数据库包含数百万条记录，每条记录很大并且您希望此查询被执行很多次，这不是一个好的解决方案。

```
UPDATE table1 t
SET t.VARIABLE63 = 
  COALESCE(t.VARIABLE63, 
           (SELECT VARIABLE63
            FROM table1 t0
            LEFT JOIN table1 tNot 
                   ON tNot.documentid = t.documentid
                  AND tNot.projectid=t.projectid        
                  AND tNot.configurationid=t.configurationid
                  AND cast(tNot.revisionno as int) > cast(t0.revisionno as int)
                  AND cast(tNot.revisionno as int) < cast(t.revisionno as int)
                  AND tNot.Variable63 is NOT NULL
            WHERE t0.documentid = t.documentid
              AND t0.projectid=t.projectid        
              AND t0.configurationid=t.configurationid
              AND cast(t0.revisionno as int) < cast(t.revisionno as int)
              AND t0.Variable63 is NOT NULL
              AND tNot.Variable63 is NULL)),
    t.VARIABLE64 = CASE WHEN t.VARIABLE64 IS NOT NULL then t.VARIABLE64
                        ELSE (SELECT VARIABLE64
                              FROM table1 t0
                              WHERE t0.documentid = t.documentid
                                AND t0.projectid=t.projectid        
                                AND t0.configurationid=t.configurationid
                                AND cast(t0.revisionno as int) < cast(t.revisionno as int)
                                AND t0.Variable64 is NOT NULL
                                AND NOT EXISTS(SELECT 1 
                                               FROM table1 tNot 
                                               WHERE tNot.documentid = t.documentid
                                                 AND tNot.projectid=t.projectid        
                                                 AND tNot.configurationid=t.configurationid
                                                 AND cast(tNot.revisionno as int) > cast(t0.revisionno as int)
                                                 AND cast(tNot.revisionno as int) < cast(t.revisionno as int)
                                                 AND tNot.Variable64 is NOT NULL)) END 
```

# android - android布局：嵌套权重或相对视图

> ID：11677240
> 
> 赞同：0
> 
> 时间：2012-07-26T20:08:02.493
> 
> 标签：android, layout

我正在尝试组装一个相当容易使用权重的布局，因为所有内容都是其父级的 1/2、1/4 或 1/8，但我听说做嵌套权重不利于加载/performance 并且相对布局更好。

老实说，我不喜欢相对布局。我知道如何在我已经放下的东西旁边或上面安排东西，但很难理解如何以类似于加权的方式安排东西。

这是我希望我的布局看起来像侧面测量值的粗略图。我可以轻松地进行左侧分组（标题、名称、图像、类型、等级/层），但我不确定如何安排另一侧，尤其是如何保持描述框的高度，以便下面的其余部分不会如果该框的内容发生变化，则移动。

[编辑]* 我会将其设置为始终处于横向模式 ![我的粗略布局图](../Images/a4dfc34ae6266c6e13b2499811281c5a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:17:41.220

你可以有两个RelativeLayouts。一个用于左侧，一个用于右侧。当然，这仅适用于横向模式，在这种情况下，滚动将是纵向的唯一其他选项。所以你可以做

**景观**

* * *

```
<LinearLayout
    android:layout_width=""
    android:layout_height=""
    android:orientation="horizontal" >

    <RelativeLayout..> RelativeLayout/>
    <RelativeLayout..> <RelativeLayout/>
<LinearLayout/> 
```

**肖像**

* * *

```
<LinearLayout
    android:layout_width=""
    android:layout_height=""
    android:orientation="vertical" >

    <RelativeLayout..> <RelativeLayout/>
    <RelativeLayout..> <RelativeLayout/>
<LinearLayout/> 
```

所以你仍然可以控制视图在每个部分的位置，但它们仍然分别位于每一侧。

# ios - 如何仅使用用户名和密码从简单的 RestKit 调用中获得响应？

> ID：11677245
> 
> 赞同：1
> 
> 时间：2012-07-26T20:08:30.273
> 
> 标签：ios, restkit

在进行任何 GET 或 POST 之前，有没有办法从非常基本的 RestKit 调用中获取响应？我只是非常困惑，因为我想要进行一堆 RESTful 调用，但它们都需要 user_id 作为调用的一部分。我如何从初始服务器交互中获得响应，我假设它将包含 user_id。

我们是否需要构建一个接受用户名和密码并返回 user_id 的 GET API 调用，或者有没有办法通过 RestKit 来完成这部分？我觉得应该通过 RestKit 客户端来完成......

更新：我们缺少所需的 API 调用。哦！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T08:37:44.427

我不明白你想知道什么：

“有没有办法从一个非常基本的 RestKit 调用中得到响应？” - 这个 RestKit 调用到底是什么？您的每个 restKit 调用委托响应或错误大多使用以下`RKRequestDelegate`方法：

```
- (void)request:(RKRequest *)request didLoadResponse:(RKResponse *)response {
      RKLogInfo(@"Yay! We Got a response"); 
 }
- (void)request:(RKRequest*)request didFailLoadWithError:(NSError *)error { 
      RKLogInfo(@"Oh no! We encountered an error: %@", [error localizedDescription]);
 } 
```

“我如何从初始服务器交互中获得响应，我假设它将包含 user_id。” 您的初始服务器交互到底是什么，服务器回答您收到什么？当然，您的服务器应该为您提供这个 user_id。

在您的情况下，它是否可能是登录过程的解决方案：

看起来配置它的正确方法如下..

```
RKObjectManager* objectManager = [RKObjectManager objectManagerWithBaseURL:@"http://apihost.com" ]; 
objectManager.client.username = @"your-user-name"; 
objectManager.client.password = @"your-password"; 
```

# javascript - 在 Javascript 中绘制可缩放的音频波形时间线

> ID：11677246
> 
> 赞同：3
> 
> 时间：2012-07-26T20:08:30.240
> 
> 标签：javascript, graph, html5-canvas

我有来自歌曲的原始 44,1 kHz 音频数据作为 Javascript 数组，我想从中创建一个可缩放的时间线。

来自 Audacity 的示例时间表：

![来自 Audacity 的样本波形](../Images/8833fcf4d12d51c041d5a2c2592eff67.png)

由于有数百万个时间点，普通的 Javascript 图形库可能不会削减它：我认为，不确定，普通的图形库会在这么多的时间点上死掉。但是是否已经存在用于 JS 的这种可视化的库？Canvas、webGL、SVG 都是可接受的解决方案。

最好使用缩放和平移的解决方案。

请注意，这严格发生在客户端，服务器端解决方案是不可接受的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T16:40:21.067

我已经非常广泛地研究了同样的问题。据我所知，现有的唯一一个接近你想要的项目是[wavesurfer.js](https://github.com/katspaugh/wavesurfer.js#readme)。我没用过，但截图和描述听起来很有希望。

另请参阅[此问题](https://stackoverflow.com/questions/9516324/webaudio-library-to-visualize-and-interact-with-waveforms)。

祝你好运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-16T20:53:33.360

您不能简单地获取波形数据并渲染所有数据点，这是非常低效的。

变量解释：

*   **width** : 以像素为单位绘制区域宽度，max 为屏幕宽度
*   **height**：与宽度相同，但与绘图区域的高度相同
*   **spp**：每个像素的样本，这是您的缩放级别
*   **分辨率**：每个像素样本范围内的样本数，调整性能与准确性。
*   **scroll**：您将需要虚拟滚动以获得性能，这是以 px 为单位的滚动位置
*   **data**：原始音频数据数组，可能有几百万个样本长
*   **drawData** : 用于绘制的缩减音频数据

您将只需要从音频数据中获取视口中的样本并减少这些样本。通常这会产生一个 2 * 宽度的数据集，您可以使用此数据集来渲染图像。缩小增加spp，放大减少它。更改滚动值会对其进行平移。

以下代码具有 O(RN) 复杂度，其中 N 是宽度，R 是分辨率。最大精度为 spp <= 分辨率。

代码看起来像这样，它得到峰值，你也可以做 rms 或平均值。

```
let reduceAudioPeak = function(data, spp, scroll, width, resolution) {
    let drawData = new Array(width);
    let startSample = scroll * spp; 
    let skip = Math.ceil(spp / resolution);

    // For each pixel in draw area
    for (let i = 0; i < width; i++) {
        let min = 0; // minimum value in sample range
        let max = 0; // maximum value in sample range
        let pixelStartSample = startSample + (i * spp);

        // Iterate over the sample range for this pixel (spp) 
        // and find the min and max values. 
        for(let j = 0; j < spp; j += skip) {
           const index = pixelStartSample + j;
           if(index < data.length) {
               let val = data[index];
               if (val > max) {
                  max = val;
               } else if (val < min) {
                  min = val;
               }
           }
        }

        drawData[i] = [min, max];
    }
    return drawData;
} 
```

有了这些数据，您可以像这样绘制它，您可以使用线条、svg 等：

```
let drawWaveform = function(canvas, drawData, width, height) {
   let ctx = canvas.getContext('2d');
   let drawHeight = height / 2;

   // clear canvas incase there is already something drawn
   ctx.clearRect(0, 0, width, height);
   for(let i = 0; i < width; i++) {
      // transform data points to pixel height and move to centre
      let minPixel = drawData[i][0] * drawHeigth + drawHeight;
      let maxPixel = drawData[i][1] * drawHeight + drawHeight;
      let pixelHeight = maxPixel - minPixel;

      ctx.fillRect(i, minPixel, 1, pixelHeight);
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:05:09.530

我在浏览器中使用[RaphaelJS](http://raphaeljs.com/)进行 SVG 渲染，它的表现非常好。这就是我想要的。希望 SVG 能够胜任这项任务。

# windows-ce - windows ce的好开发工具

> ID：11677257
> 
> 赞同：0
> 
> 时间：2012-07-26T20:09:35.693
> 
> 标签：windows-ce

我刚刚开始涉足 Windows CE 开发并且有很多问题。

我们正在尝试在 Windows CE（带有条形码扫描仪的移动计算机）上开发应用程序，我正在寻找开发工具。我有 ASP.Net/WinForms 背景，我确实使用 C#/VS2008 构建了另一个应用程序，我希望看看是否有类似的工具可以用来加速开发。我们正在尝试做的应用程序具有中等复杂性，一个理想的工具是我可以结合使用的工具，让我们说一些我可以自己编码的 C# 表单。

我查看了一些工具，其中大多数都是为简单的应用程序量身定制的，除了它们没有给我添加代码的灵活性并且选项相当有限。

有没有像我正在寻找的工具，或者我可以用于 CE 的好工具。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T22:13:07.177

Windows CE 应用程序事实上的标准开发环境是 Visual Studio 2008 Professional。它为本地 (C/C++) 和托管 (C# 和 VB.NET) 应用程序提供工具和编译器。

# c# - 焦点标签显示虚线作为边框

> ID：11677259
> 
> 赞同：1
> 
> 时间：2012-07-26T20:09:42.027
> 
> 标签：c#, wpf, xaml, border

我以编程方式将焦点发送到 WPF 标签。但是，当我这样做时，标签周围会出现一条虚线。我不相信这是边框画笔，尤其是因为我明确将其设置为透明。有人知道我怎样才能摆脱这条虚线/虚线吗？

如果有帮助，破折号仅出现在左侧和右侧。而且，标签位于 StackPanel 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:21:08.023

你试过清除它`FocusVisualStyle`吗？

```
<Label FocusVisualStyle="{x:Null}">
    My Label
</Label> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:21:17.933

请参阅[FrameworkElement.FocusVisualStyle 属性](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.focusvisualstyle.aspx)。您可以将其设置为`Null`.

# magento - 在 magento 观察者上包含外部代码

> ID：11677260
> 
> 赞同：0
> 
> 时间：2012-07-26T20:09:42.757
> 
> 标签：magento

我想在 Magento 观察者模型中包含一个外部配置文件

我的观察者在 magento/app/code/local/Mycompany/Mymodulue/Model/Observer.php 我想把我的代码放在 magento/scripts/examplename.php

我不想使用帮助程序，因为此代码也将在该文件夹中的其他脚本中使用，并且代码重复不是一个好习惯

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T06:30:46.057

Magento 是一个 php 应用程序，您可以在代码中的任何地方使用`include()`，`require()`但是将类和意大利面条代码包含在服务器上的随机位置是一个坏主意，因为如果您遵循命名约定，Magento 已经包含 lib 文件夹和自动加载器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T17:57:14.480

我发现做我正在寻找的事情的方式是：

```
require_once BP.DS.'scripts'.DS.'examplename.php'; 
```

其中 BP 和 DS 是 Magento 常量，BP=基本路径和 DS= 目录分隔符

# xml - xml xsl xslt eclipse 仅替换/返回 1 个值

> ID：11677267
> 
> 赞同：1
> 
> 时间：2012-07-26T20:09:57.527
> 
> 标签：xml, eclipse, xslt, transform

嗨，伙计们，我一直在尝试使用 eclipse 也使用 saxon 来转换这个 xml 数据，但是当我尝试使用 saxon xslt2.0 进行转换时，我得到一个内存错误，我在 eclipse.ini 中增加了内存，但没有看 xml 我试图如果我使用默认的 eclipse xslt 转换运行它，alter 为 500M，它运行打印完成且没有错误，我返回一个没有节点的 xml，并且一个 url 正确更改但没有在节点中，并且没有其他数据我在这里遗漏了什么吗？

这是 xsl 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
    <xsl:variable name="replacedURL">
        <xsl:call-template name="string-replace-all">
            <xsl:with-param name="text" select="/products/product/buy_link/text()"/>
            <xsl:with-param name="replace" select="'[[PARTNERID]]'"/>
            <xsl:with-param name="by" select="'12345'"/>
        </xsl:call-template>
    </xsl:variable>
    <xsl:value-of select="$replacedURL"/>
   </xsl:template>
   <xsl:template name="string-replace-all">
    <xsl:param name="text"/>
    <xsl:param name="replace"/>
    <xsl:param name="by"/>
    <xsl:choose>
        <xsl:when test="contains($text, $replace)">
            <xsl:value-of select="substring-before($text,$replace)"/>
            <xsl:value-of select="$by"/>
            <xsl:call-template name="string-replace-all">
                <xsl:with-param name="text" select="substring-after($text,$replace)"/>
                <xsl:with-param name="replace" select="$replace"/>
                <xsl:with-param name="by" select="$by"/>
            </xsl:call-template>
        </xsl:when>
        <xsl:otherwise>
            <xsl:value-of select="$text"/>
        </xsl:otherwise>
    </xsl:choose>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:52:16.417

**原始递归转换通常会以堆栈溢出异常结束**（通常有 N 次嵌套递归调用，其中 N 约为 1000）。

**在 XSLT 2.0 中使用最有效的、基于 RegEx 的 XPath 2.0 函数[`replace()`](http://www.w3.org/TR/xpath-functions/#func-replace)**。

**这是一个小例子**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
     <t><xsl:sequence select=
      "replace(., '\[\[PARTNERID\]\]', '12345')"/>
      </t>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<t>dadasdas [[PARTNERID]] sfsdfsffs [[PARTNERID]]  sdsdfffsdf [[PARTNERID]]</t> 
```

**产生了想要的正确结果：**

```
<t>dadasdas 12345 sfsdfsffs 12345  sdsdfffsdf 12345</t> 
```

**说明**：

RegEx 处理使用常规自动机，它只需要有限数量的内存（用于自动机），这与基于堆栈的处理不同，后者在堆栈上的每次“推送”时消耗更多内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T14:29:02.790

如果您希望生成的 XML 除了对某些节点进行一些特定更改之外与输入相同，那么最简单的方法是创建一个样式表，如下所示：

1.  使用 [恒等变换](http://www.w3.org/TR/xslt/#copying)将输入原样复制到输出，然后
2.  选择性地覆盖要更改的节点的模板。

在这种情况下，将输入 XML 原样复制到输出，仅在匹配 XPath 表达式的节点中应用字符串替换，`/products/product/buy_link/text()`如下所示：

```
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <!-- the identity template -->
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/products/product/buy_link/text()">
    <xsl:variable name="replacedURL">
      <xsl:call-template name="string-replace-all">
        <xsl:with-param name="text" select="."/>
        <xsl:with-param name="replace" select="'[[PARTNERID]]'"/>
        <xsl:with-param name="by" select="'12345'"/>
      </xsl:call-template>
    </xsl:variable>
    <xsl:value-of select="$replacedURL"/>
  </xsl:template>

  <xsl:template name="string-replace-all">
    <xsl:param name="text"/>
    <xsl:param name="replace"/>
    <xsl:param name="by"/>
    <xsl:choose>
      <xsl:when test="contains($text, $replace)">
        <xsl:value-of select="substring-before($text,$replace)"/>
        <xsl:value-of select="$by"/>
        <xsl:call-template name="string-replace-all">
          <xsl:with-param name="text" select="substring-after($text,$replace)"/>
          <xsl:with-param name="replace" select="$replace"/>
          <xsl:with-param name="by" select="$by"/>
        </xsl:call-template>
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="$text"/>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

</xsl:stylesheet> 
```

# c# - 如何在c#中将对象与null进行比较

> ID：11677268
> 
> 赞同：1
> 
> 时间：2012-07-26T20:09:59.987
> 
> 标签：c#, object, null

这似乎应该是非常直截了当的。

如果我有：

```
object obj = *get value from somewhere*

if(obj == null){
    MessageBox.Show("NULL");
} 
```

即使当我调试并看到 obj 为 null 时，代码也永远不会进入 if 语句。

在将对象与 null 进行比较时，您是否做了一些不同的事情？（因为对象可以是任何类型？）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T20:17:04.203

好的，评论放弃了：

> 好的，在执行此操作时，我注意到当我在调试模式下将鼠标悬停在变量上时，值为 null，但是当它 ISNT 工作时，值为 {null}... {null} 是什么意思？

这表明它实际上是一个包含单个空引用的数组（或可能是另一个集合类型），例如

```
object obj = new object[] { null }; 
```

的值`obj`不是空引用，因此它*不会*进入`if`语句的主体。

你应该如何处理这取决于你想要达到的目标。你真的*需要* `obj`静态类型`object`吗？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-26T20:10:39.020

你需要

```
if(obj == null){
    MessageBox.Show("NULL");
} 
```

您编写了类型*对象*而不是变量*obj*

**更新**

根据您的编辑（这大大改变了问题），您的代码肯定可以工作。尝试分配

```
obj = null; 
```

就在您的*if*语句之前，并看到它进入 MessageBox.Show()

这将证明*if*确实按您的预期工作。

**更新 2**

@Jon 击中了它，您可能已经分配了一个带有一个元素 null 的数组。它以这种方式显示的原因是调试器正在尝试可视化数组。

例如，如果数组有两个字符串元素“Hello”和“World”，调试器将显示

{“你好世界”}

由于数组只有一个元素 null，因此调试器将其可视化为

{空值}

# html - 如何让盒子放在页面上

> ID：11677275
> 
> 赞同：0
> 
> 时间：2012-07-26T20:10:52.833
> 
> 标签：html, css

我目前有[http://twclaimer.com/twopcenter/internal/index.html](http://twclaimer.com/twopcenter/internal/index.html)，如您所见，右侧的广告将所有内容向下推。如果您查看页面底部，这些框符合我的要求。

我怎样才能让右边的广告不把所有的内容都往下推？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:19:18.170

When using `float`, when elements need to go to a new line they clear down to the bottom of the tallest element from the previous line.

In other words, there's no way for you to have the boxes where you say you want them if you keep using `float`.

It's okay to use `float: right` for the ad box, but for the rest you may be better off using `display:inline-block` instead.

# sql-server - SSIS 作业调度程序失败，但在 BIDS 和 MSDB 集成服务中运行良好

> ID：11677279
> 
> 赞同：2
> 
> 时间：2012-07-26T20:11:07.370
> 
> 标签：sql-server, sql-server-2008, ssis, bids

我创建了一个 SSIS 包，将其从 Oracle 10g 服务器导出到 SQL SERVER 2008。该包运行良好，当我通过 Microsoft BIDS 运行它时，它运行良好，当我创建它的一个包并在集成服务中运行它时。只有当我通过作业调度程序（SQL Server 代理）安排它时它才会失败

```
Date,Source,Severity,Step ID,Server,Job Name,Step Name,Notifications,Message,Duration,Sql Severity,Sql Message ID,Operator Emailed,Operator Net sent,Operator Paged,Retries Attempted
07/26/2012 15:20:12,PATH JOB,Error,0,DSSSERVER,PATH JOB,(Job outcome),,The job failed.        
 The Job was invoked by User HHSH\user7199\.  The last step to run was step 1 (PATH JOB).,00:00:01,0,0,,,,0
07/26/2012 15:20:12,PATH JOB,Error,1,DSSSERVER,PATH JOB,PATH JOB,,Executed as user: HHSH\DSSSERVER$. Microsoft (R) SQL Server Execute Package Utility  Version 10.50.1600.1 for 64-bit  Copyright (C) Microsoft Corporation 2010\. All rights reserved.    Started:  3:20:12 PM  Error: 2012-07-26 15:20:12.93     Code: 0xC0047062     Source: CLINICS ADO NET Source [1]     
Description: Microsoft.SqlServer.Dts.Runtime.DtsCouldNotCreateManagedConnectionException: Could not create a managed connection manager.     
at Microsoft.SqlServer.Dts.Runtime.ManagedHelper.GetManagedConnection(String assemblyQualifiedName<c/> String connStr<c/> Object transaction)     
at Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100.AcquireConnection(Object pTransaction)     
at Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter.AcquireConnections(Object transaction)     
at Microsoft.SqlServer.Dts.Pipeline.ManagedComponentHost.HostAcquireConnections(IDTSManagedComponentWrapper100 wrapper<c/> Object transaction)  End Error  Error: 2012-07-26 15:20:12.93     
Code: 0xC0047017     Source: CLINICS SSIS.Pipeline     Description: component "ADO NET Source" (1) failed validation and returned error code 0x80131500\.  End Error  Error: 2012-07-26 15:20:12.93     
Code: 0xC004700C     Source: CLINICS SSIS.Pipeline     Description: One or more component failed validation.  End Error  Error: 2012-07-26 15:20:12.93     Code: 0xC0024107     Source: CLINICS      
Description: There were errors during task validation.  End Error  DTExec: The package execution returned DTSER_FAILURE (1).  Started:  3:20:12 PM  Finished: 3:20:12 PM  Elapsed:  0.624 seconds.  The package execution failed.  
The step failed.,00:00:01,0,0,,,,0
07/26/2012 15:18:21,PATH JOB,Error,0,DSSSERVER,PATH JOB,(Job outcome),,The job failed.  The Job was invoked by User HHSH\user7199\.  The last step to run was step 1 (PATH JOB).,00:00:01,0,0,,,,0
07/26/2012 15:18:22,PATH JOB,Error,1,DSSSERVER,PATH JOB,PATH JOB,,Executed as user: HHSH\DSSSERVER$. 
Microsoft (R) SQL Server Execute Package Utility  Version 10.50.1600.1 for 64-bit  Copyright (C) Microsoft Corporation 2010\. All rights reserved.    Started:  3:18:22 PM   
Error: 2012-07-26 15:18:22.76     Code: 0xC0047062     Source: CLINICS ADO NET Source [1]     Description: 
Microsoft.SqlServer.Dts.Runtime.DtsCouldNotCreateManagedConnectionException: Could not create a managed connection manager.     
at Microsoft.SqlServer.Dts.Runtime.ManagedHelper.GetManagedConnection(String assemblyQualifiedName<c/> String connStr<c/> Object transaction)     
at Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100.AcquireConnection(Object pTransaction)     
at Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter.AcquireConnections(Object transaction)     
at Microsoft.SqlServer.Dts.Pipeline.ManagedComponentHost.HostAcquireConnections(IDTSManagedComponentWrapper100 wrapper<c/> Object transaction)  End Error  Error: 2012-07-26 15:18:22.76     
Code: 0xC0047017     Source: CLINICS SSIS.Pipeline     Description: component "ADO NET Source" (1) failed validation and returned error code 0x80131500\.  End Error  Error: 2012-07-26 15:18:22.76     
Code: 0xC004700C     Source: CLINICS SSIS.Pipeline     Description: One or more component failed validation.  End Error  Error: 2012-07-26 15:18:22.76     Code: 0xC0024107     
Source: CLINICS      Description: There were errors during task validation.  End Error  DTExec: The package execution returned DTSER_FAILURE (1).  Started:  3:18:22 PM  Finished: 3:18:22 PM  Elapsed:  0.655 seconds.  The package execution failed.  The step failed.,00:00:00,0,0,,,,0
07/24/2012 13:48:00,PATH JOB,Error,0,DSSSERVER,PATH JOB,(Job outcome),,The job failed.  
The Job was invoked by Schedule 23 (JOb Schedule for LAb PAthology).  The last step to run was step 1 (PATH JOB).,00:00:00,0,0,,,,0
07/24/2012 13:48:00,PATH JOB,Error,1,DSSSERVER,PATH JOB,PATH JOB,,Executed as user: HHSH\DSSSERVER$. Microsoft (R) SQL Server Execute Package Utility  Version 10.50.1600.1 for 64-bit  Copyright (C) Microsoft Corporation 2010\. All rights reserved.    Started:  1:48:00 PM  Error: 2012-07-24 13:48:00.72     Code: 0xC0047062     Source: CLINICS ADO NET Source [1]     Description: 
Microsoft.SqlServer.Dts.Runtime.DtsCouldNotCreateManagedConnectionException: Could not create a managed connection manager.     
at Microsoft.SqlServer.Dts.Runtime.ManagedHelper.GetManagedConnection(String assemblyQualifiedName<c/> String connStr<c/> Object transaction)     at Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100.AcquireConnection(Object pTransaction)     at Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter.AcquireConnections(Object transaction)     at Microsoft.SqlServer.Dts.Pipeline.ManagedComponentHost.HostAcquireConnections(IDTSManagedComponentWrapper100 wrapper<c/> Object transaction)  End Error  Error: 2012-07-24 13:48:00.72     Code: 0xC0047017     Source: CLINICS SSIS.Pipeline     Description: component "ADO NET Source" (1) failed validation and returned error code 0x80131500\.  End 
 Error  Error: 2012-07-24 13:48:00.72     Code: 0xC004700C     Source: CLINICS SSIS.Pipeline     Description: One or more component failed validation.  End Error  Error: 2012-07-24 13:48:00.72     Code: 0xC0024107     Source: CLINICS      Description: There were errors during task validation.  End Error  DTExec: The package execution returned DTSER_FAILURE (1).  Started:  1:48:00 PM  Finished: 1:48:00 PM  Elapsed:  0.639 seconds.  The package execution failed.  The step failed.,00:00:00,0,0,,,,0 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-23T19:12:36.943

在 BIDS 中运行良好但在 SQL 作业中运行良好的大多数问题是由于以下情况引起的：

*   数据源连接或文件访问问题（当运行 sql 代理的用户没有对 db 或目标文件的正确权限时）。

*   包保护级别（pwd 是敏感数据，有时根据保护级别不复制）。

*   64 位问题（由于没有适用于 64 位系统的 Jet 驱动程序，因此在 64 位操作系统上运行时，您需要在 sql 作业中使用 32 位 DTEXEC 或设置“使用 32 位运行时”选项，当您在“执行选项”选项卡上'正在创建一个 SSIS 作业步骤，请查看下面链接上的图像以查看它）。

[32 位运行时选项图像](http://1.bp.blogspot.com/-WHsiqaOI8gA/T8_GuvdMMZI/AAAAAAAAAPE/SoqxcClaSvI/s1600/ssis.jpg)

有关此主题的信息，我建议您查看以下文章，其中包含有关此类情况的详细信息。

[如何对 SQL 代理作业中的 SSIS 包执行失败进行故障排除？](http://social.technet.microsoft.com/Forums/en-US/sqlintegrationservices/thread/e13c137c-1535-4475-8c2f-c7e6e7d125fc)

希望这可以帮助你..

亲切的问候，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-24T20:04:14.867

SQL Server 代理有一个小故障，我有一个类似的问题，所以我所做的只是再次构建项目，如果你有任何脚本，我再次构建它然后再次构建项目，删除包的路径正在引用，使用位于 bin 文件夹中的包重新创建路径，然后安排作业运行并且确实如此，有时 SQL Server 代理无法正确缓存请求。我知道这篇文章是两年前提出的，但这是针对目前有问题的人。当您将其安排为作业时，如果您在包中有 sendemail 任务并且如果您不是分发列表的一部分，则包也不会运行，您也发送电子邮件。

# html - 有两个是有效的 HTML elements inside your HTML tag?

[问问题](https://stackoverflow.com/questions/ask)问问题 2012-07-26T20:11:11.5679687 次This question shows research effort; it is useful and clear14This question does not show any research effort; it is unclear or not usefulBookmark this question.Show activity on this post.

Is it valid to have two `<style>` tags inside of an HTML head tag?

For example I am trying to write an HTML page for email clients with no external stylesheets added. Due to the way our template system works it is much easier for us to have

```
<head>
 <style>
 .someStyle{}
 </style>
 <style>
 .someOtherStyle{}
 </style>
</head> 
```

instead of this...

```
<head>
 <style>
 .someStyle{}
 .someOtherStyle{}
 </style>
</head> 
```

If option 2 is the only way of doing this I will do that but option 1 for various reasons works better for our framework code.

[html](/tags/html "show questions tagged 'html'")[css](/tags/css "show questions tagged 'css'")[styles](/tags/styles "show questions tagged 'styles'")4

## 3 回答 3

This answer is useful11

在你的`<head>`和`</head>`标签之间有多个样式元素是非常好的。您可以拥有任意数量的元素，以及`<link>`或`<script>`元素。

于 2012-07-26T20:14:56.823 回答This answer is useful7

没有一个答案引用任何来源，因此 OP 无法确定。（请注意，“CSS”的“级联”部分和浏览器容忍许多`STYLE`元素的事实都不能证明任何事情；例如，它们也容忍（谢天谢地，顺便说一句！）`STYLE`元素`BODY`，即使规范认为这是异端，除非使用了`scoped`attr. ，尽管它是有效的，但浏览器基本上不支持它......）

以下是[当前 HTML 规范](https://dev.w3.org/html5/spec-LC/semantics.html#the-style-element)今天 (2017-02-08) 所说的内容：

> 可以使用此元素的上下文：
> 
> *   如果没有作用域属性：需要元数据内容的地方。
> *   如果 scoped 属性不存在：在作为 head 元素的子元素的 noscript 元素中。
> *   如果存在范围属性：预期流内容的位置，但在除其他样式元素和元素间空白之外的任何其他流内容之前。

这实际上意味着原始问题的答案确实是：**是**。:)

于 2017-02-08T00:24:09.217 回答This answer is useful5

是的，这是完全有效的。CSS 代表“级联样式表”（如在彼此之上分层。）多个`<style>`标签允许您包含多个样式表或多个样式声明。

于 2012-07-26T20:16:12.133 回答

#### Related

[2](/questions/10043961 "Question score (upvotes - downvotes)")[wix - Wix：无法列出使用 C# 自定义操作创建的属性](/questions/10043961)[2](/questions/10043963 "Question score (upvotes - downvotes)")[python - 类 ClassName 与类 ClassName(object)](/questions/10043963)[5](/questions/10043965 "Question score (upvotes - downvotes)")[mongodb - 如何在 MongoDB 集合中获取特定的嵌入文档？](/questions/10043965)[3](/questions/10043966 "Question score (upvotes - downvotes)")[netbeans - 在用户目录中创建新文件（在 NB 平台上使用 InstalledFileLocator）](/questions/10043966)[2](/questions/10043967 "Question score (upvotes - downvotes)")[matlab - 使用 MATLABR2010a 进行图像处理](/questions/10043967)[1](/questions/10043972 "Question score (upvotes - downvotes)")[xml - Perl XML::Writer 打印错误字符](/questions/10043972)[2](/questions/10043974 "Question score (upvotes - downvotes)")[cuda - 如何以软件模式在 ATI 或 Intel 卡上运行我的 CUDA 应用程序？](/questions/10043974)[3](/questions/10043981 "Question score (upvotes - downvotes)")[php - 将数据插入表并使用该数据更新另一个表。](/questions/10043981)[4](/questions/10043984 "Question score (upvotes - downvotes)")[sql - SQL将选择从列方向更改为行](/questions/10043984)[2](/questions/10043991 "Question score (upvotes - downvotes)")[search-engine - 在生产级别打开搜索服务器？](/questions/10043991)

#### Reference

[php](https://php.github.net.cn) × 1429865[c/c++](https://c-cpp.com) × 756500[nginx](https://nginx.github.net.cn) × 49975[mongodb](https://mongodb.net.cn) × 159057[mybatis](https://mybatis.net.cn) × 3233[anaconda](https://anaconda.org.cn) × 13410[pycharm](https://pycharm.net.cn) × 14671[python](https://python.github.net.cn) × 1902243[vscode](https://vscode.github.net.cn) × 56040[docker](https://dockerdocs.cn) × 110988[github](https://github.net.cn) × 49000[flask](https://flask.github.net.cn) × 49129[ffmpeg](https://ffmpeg.github.net.cn) × 24037[jmeter](https://jmeter.net) × 16910[matplotlib](https://matplotlib.net) × 63493[bootstrap](https://getbootstrap.net) × 54641[](https://stackoverflow.com)

##### [Stack Overflow 中文网](https://stackoverflow.org.cn)

遵从 CC BY-SA 知识共享许可协议。

> ID：11677284
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# search - TYPO3 4.7 +“索引搜索”不起作用

> ID：11677289
> 
> 赞同：0
> 
> 时间：2012-07-26T20:11:40.123
> 
> 标签：search, typo3

我在 TYPO3 4.7 安装中安装了扩展“索引搜索”，但它不起作用。当我在列中添加插件时，“起点”字段不会出现。

我想我可以用打字稿来设置它，所以我将它添加到模板中：

```
page.config.index_enable = 1
plugin.tx_indexedsearch{
    show{
        advancedSearchLink = 0
        rules = 0
        alwaysShowPageLinks = 1
    }
    search{
        rootPidList = 1
        skipExtendToSubpagesChecking = 1
    }
    view.defaultPid = 81
    result_link_target = 81
} 
```

但它还没有索引任何东西。我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:38:22.600

我得到了它！我必须激活缓存！

```
config.no_cache = 0 
```

# session - 安全登录页面和用户会话

> ID：11677291
> 
> 赞同：0
> 
> 时间：2012-07-26T20:11:57.263
> 
> 标签：session, login, security

我的第一个问题是关于提供安全登录页面的标准步骤。我熟悉的两件事是设置密码字段以防止有人从背后监视，以及通过 https 传输数据。为了拥有一个完全安全的登录站点，是否还应该包括其他任何事情？

此外，一旦我们登录，会话是如何维护的，即当用户点击某物时，我们的服务器知道它应该再次生成基于用户的内容？考虑到什么时候登录，我们还需要维护https等安全措施吗？

感谢您的回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:19:18.910

恐怕有人可以写一本关于它的书...

仅解决会话问题：会话通常由随每个连续请求发送的一些 cookie 维护。并且由于用户是否登录的信息基于会话 cookie（或独立用户 cookie），因此被盗的 cookie 可用于模拟登录。因此，您需要在会话的其余部分保持 https 连接（以保护 cookie）或至少采取一些次要的安全预防措施（例如验证会话是否来自与以前相同的 IP 地址）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:24:16.977

可以做各种各样的事情来使网站更安全，但即使你做了所有这些事情，你也不能保证你的网站是“完全”安全的。

例如，如果您将用户登录信息存储在数据库中：您是否针对 SQL 注入进行了保护？如果您的登录页面还包含一个注册表单：您是否有针对 XSS 攻击的保护？密码是否必须满足最低要求，或者用户可以自己制作（通常非常糟糕且容易猜到）密码？有些事情您可以自己掌握，但不幸的是，在某些事情被实际利用之前，您不会想到要保护它们（因为没有人会想到它们）。一个站点有无数的攻击路线，以及相同数量的防御方法，我要花很长时间才能深入研究所有这些路线（并不是说我自己就是那么精通安全）。

正如其他答案所指出的，会话由会话 ID 维护，会话 ID 存储在客户端的 cookie 中。会话启动时，会生成 ID；然后，客户端的浏览器使用此 ID 来识别存储在服务器端的数据是否属于该浏览器。为防止此 ID 被盗，应使用 HTTPS 对连接进行加密；但是，需要注意的是，如果您的页面中有任何对外部资源的引用（例如：来自另一个站点的图像、来自另一个站点的脚本等），则连接只会被*部分*加密（即，不是外部资源的部分）。由于显而易见的原因，这不如完全加密安全；为了防止这种情况，我尽可能将所有外部资源下载到本地目录中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:19:27.170

是的，密码字段和 https 绝对是登录的好方法。我现在也想不出别的办法，除了可能是验证码，以确保它不是机器人脚本，试图猜测密码。

关于会话管理：有一个 '$_SESSION' 变量，它对每个连接都是唯一的，并由 PHP 自动维护，在你调用 'session_start();' 之后 在脚本的开头。

该命令非常重要，否则 $_SESSION 将始终为空...如果我没记错的话，它会向浏览器询问标识信息（SessionID 或类似的东西），然后将存储的信息与之匹配会话 ID。

您可以像使用任何其他 Superglobal 一样使用此会话变量。

```
$_SESSION['ID'] = $ID;
$_SESSION['AccessRights'] = $AR; 
```

等等。实际的会话数据专门存储在服务器端，除了 PHP 脚本之外不能更改。将您需要了解的有关用户的所有信息存储在 $_SESSION 中，您应该没问题。

关于“保持 HTTPS”：这不应该是必要的，因为所有“关键数据”都已传输。

但请注意，一旦您处理敏感数据或个人数据（如更改密码或其他类似内容），您可能希望再次返回 HTTPS。然而，根据经验，HTTPS 的实际开销在当今系统中相当小，除非您期望大量流量，否则保持“开启”绝不是一个坏主意。

现在，我在这个问题上可能是错的，但这是我对此事的看法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T21:57:00.387

正如@Kuba 所说 - 这是一个巨大的话题。会话固定、会话存储、保护 cookie、密码安全、无效登录的响应时间、以非安全方式访问登录页面、XSS、sql 注入以及可能还有数千个我不知道。

我的建议：不要自己做。每种可能的语言都有大量的安全框架。选择一个，阅读他们的操作指南页面并使用它。它将帮助您完成最常见的任务。但是应用程序的安全性并没有在登录页面上结束。整个应用程序应该被保护写得正确以得到保护。

# c# - 通过枚举扩展访问 GridView 行单元格是个好主意吗？

> ID：11677294
> 
> 赞同：0
> 
> 时间：2012-07-26T20:12:08.267
> 
> 标签：c#, gridview, enums

这里的新手，所以不确定这里潜在的性能问题是什么，以及最佳实践是什么。

这是一个好主意吗？想法？

从这里：（当单元格代码到处都是和/或gridview更改时容易出现手动错误）

```
row.Cells[1].Visible = false;   // CustomerId
row.Cells[9].Visible = false;   // OrderNumber
row.Cells[10].Visible = false;  // ProductId
. . .
int matchId = row.Cells[11].Text;
. . . 
```

对此：（更具可读性和可管理性，只需确保枚举与 gridview 同步）

```
row.Cells[Col.CustomerId.GetVal()].Visible = false;     
row.Cells[Col.OrderNumber.GetVal()].Visible = false; 
row.Cells[Col.ProductNumber.GetVal()].Visible = false;  
. . .
int matchId = row.Cells[Col.CustomerName.GetVal()].Text;
. . .

public enum Col
{
    MatchId = 1,
. . .
    ServiceCode = 9,
    CustomerId = 10,
    CustomerName = 11,
. . .

}

public static class ColExt
{
    static public int GetVal(this Col col)
    {
        return (int)col;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T13:13:13.623

如果在网格中使用大量列，或者在使用相同网格的情况下在许多页面上使用，这是个好主意。id 将很容易从枚举更改列值，它将反映到所有网格....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T14:40:34.447

在我看来，使用枚举的代码更具可读性。但重要的是你有一个枚举的代码生成器。否则，如果你有很多列要处理，你会犯很多错误。

# ruby-on-rails-3 - 阻止用户访问其他用户帐户

> ID：11677305
> 
> 赞同：1
> 
> 时间：2012-07-26T20:13:31.503
> 
> 标签：ruby-on-rails-3, authentication

我有一个普遍的问题...

我已经使用 Michael Hartl 的教程示例构建了我的用户模型。我遇到的麻烦是更改 url 并产生其他用户信息。我正在使用从 id -> name 更改的 Friendly_id，但是如果我将顶部的名称更改为另一个用户，它将显示他们的主页。我想限制我的用户这样做。

如果没有实施 Devise 或 CanCan 等，这可能吗？尝试进行验证以检查用户是否尝试更改 url 栏上的名称，即检查名称是否是当前登录的用户，如果不是，则重定向回当前用户。

如果您需要型号信息，请告诉我。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:28:14.810

您想要限制为特定用户的所有模型都应该与您的 User 模型具有belong_to关联，以便在您的控制器中执行

```
current_user.cars 
```

并且您永远不应该在 URL 中传递用户 ID。这假设您正在使用设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:24:05.497

您可以像这样`before_filter`验证`UsersController`这种情况：

```
# Each time you make an action on your UsersController this filter will run
before_filter :validate_url_hack

def validate_url_hack
  # Check the params hash to see if the passed :id matches the current user's id
  # (note the .to_i on params[:id], as you are comparing against a Fixnum)
  unless params[:id].to_i == current_user.id
    # This line redirects the user to the previous action
    redirect_to request.referer
  end
end 
```

这只是一个猜测，但我相信这样的事情应该可行。

# c# - 忘记密码

> ID：11677306
> 
> 赞同：0
> 
> 时间：2012-07-26T20:13:33.790
> 
> 标签：c#, asp.net, active-directory, forgot-password

我正在尝试创建一个 Web 应用程序以使用`System.Web.Security`API 根据问题/答案重置密码。

我得到一个例外：

> DirectoryServicesCOMException (0x8007202f)：发生约束冲突”如果用户对问题提供了错误的答案。

如果我将值重置`attributeMapFailedPasswordAnswerCount`为未设置，则该帐户再次变为活动状态。

AD 中的帐户锁定阈值设置为 20 次登录尝试。

我是 AD 知识的新手，如果有人能指导我如何解决这个问题，我将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T15:59:36.907

我猜你正在使用 ASP.NET？我真的没有任何经验，也没有太多的 .NET 经验（我仍在学习自己），但这是一个非常有用的链接，提供了各种 Active Directory API 的示例（[链接](http://www.codeproject.com/Articles/18102/Howto-Almost-Everything-In-Active-Directory-via-C#46)）。包括重置用户密码。这是 DirectoryEntry 类的链接，如果您不确定如何设置它（[链接](http://msdn.microsoft.com/en-us/library/system.directoryservices.directoryentry.aspx)）。另外，浏览[命名空间文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)是非常非常有帮助的（[链接](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)）。可能我唯一喜欢微软的就是他们的好文档。

我通常会这样做（在 IronPython 中，因此它不会直接转换为您可以使用的代码）：

```
ou = System.DirectoryServices.DirectoryEntry("LDAP://ou=Users,dc=whatever,dc=something,dc=localetc")
search = System.DirectoryServices.DirectorySearcher(ou, "(samAccountName="+acc"+")", Array[str](["distinguishedName"]]))
result = search.FindAll() # note 1
if result.Count != 1:
    raise BadError
else:
    ent = System.DirectoryServices.DirectoryEntry(result[0].Properties["distinguishedName"][0])
    ent.Username = admin # note 2
    ent.Password = pwd
    ent.Invoke("SetPassword", Array[object](["newpassword!"]))
    ent.Properties["LockOutTime"].Value = 0
    ent.CommitChanges() 
```

笔记：

1.  如果这会返回多个结果，那么您就会遇到问题。

2.  仅当运行此的帐户无权更改用户时，才需要此和密码。我在一个非私有帐户上运行这些，所以我必须在脚本中包含我的管理员凭据（不用担心，它们不是硬编码的）

哦，你的帐户锁定阈值相当高。我会建议 3-5，这取决于您的用户的能力。

# .net - 如果在 IE 中运行的 ActiveX 控件调用其他库，这些库是否需要实现 IObjectSafety？

> ID：11677308
> 
> 赞同：0
> 
> 时间：2012-07-26T20:13:37.293
> 
> 标签：.net, activex, webbrowser-control

我有一个在浏览器 (IE) 中运行的 .NET ActiveX 控件。它调用其他库（也通过站点传递）来执行日志记录等功能，这需要写入磁盘。这些其他库是否也需要实现 IObjectSafety？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:33:12.240

最简洁的答案是不。似乎只有公开的程序集需要这个。

经过大量调试后发现，我遇到的真正问题是由于 ActiveX 库在使用类 ID 实例化为 ActiveX 时没有正确解析 .NET 依赖路径。我通过将以下内容添加到我的 ActiveX 库的构造函数中解决了这个问题，现在它工作正常：

```
public YourActiveXLibrary()
{
    AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(LoadInstallDependency);
}

private static Assembly LoadInstallDependency(object sender, ResolveEventArgs args)
{
    string installPath = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);
    string dependencyPath = Path.Combine(installPath, new AssemblyName(args.Name).Name + ".dll");
    return File.Exists(dependencyPath) ? Assembly.LoadFrom(dependencyPath) : null;
} 
```

# html - 为什么即使图像存在，浏览器预览中也会缺少 div 的 CSS 背景图像？

> ID：11677311
> 
> 赞同：0
> 
> 时间：2012-07-26T20:14:05.467
> 
> 标签：html, css, dreamweaver, 960.gs

我正在尝试使用 Dreamweaver CS6 设置带有 CSS 的垂直导航栏，但我对 CSS 非常陌生，并且直到最近才离开 Dreamweaver 版本 3。我在此导航栏中为顶部、中间和底部图像设置了单独的类。我使用[这种技术](https://stackoverflow.com/questions/9228730/how-do-i-make-entire-div-a-link)使每个按钮的整个 div 成为一个链接。

中间按钮在设计视图、实时模式和浏览器预览中显示得很好。但顶部和底部按钮仅显示在设计视图中。悬停和活动状态适用于所有按钮。我检查并仔细检查了所有文件路径，清除了 Dreamweaver 的缓存，并重新启动了 Dreamweaver。

为什么会发生这种情况？我该如何解决？

这是相关的源代码。我正在使用 12 列[960 网格](http://960.gs)系统。

```
<!-- This is inside a container_12 div with the site's header/navigation, then a clear, then an <h3> -->
<div class="container_12">
    <!-- Header with site's logo and navigation goes here -->

    <div class="clear"></div>

    <h3>Page header</h3>

    <div class="grid_9 prefix_2 suffix_1">
        <!-- Several paragraphs of copy using <p> tags -->

        <div class="homePageVerticalButtonTop">
            <div class="verticalNavigationText"><a style="display:block" href="top.html">top link</a></div>
        </div>
        <div class="homePageVerticalButtonMiddle">
            <div class="verticalNavigationText"><a style="display:block" href="middle1.html">middle link 1</a></div>
        </div>
        <!-- Several more middle links -->
        <div class="homePageVerticalButtonBottom">
            <div class="verticalNavigationText"><a style="display:block" href="bottom.html">bottom link</a></div>
        </div>
    </div>
</div> <!-- end container_12 --> 
```

这是相关的CSS：

```
.homePageVerticalButtonTop {
    /* Why is the background not showing up? */
    background: url(../images/homePageTopButton_normal.png) no-repeat left top;

    width: 24.125em;
    height: 4.125em;
    background-size: 100%;

    display: block;
}

.homePageVerticalButtonTop:hover {
    /* This works fine */
    background: url(../images/homePageTopButton_mouseOver.png) no-repeat left top;
    width: 24.125em;
    height: 4.125em;
    background-size: 100%;
}

.homePageVerticalButtonTop:active {
    /* So does this */
    background: url(../images/homePageTopButton_mouseDown.png) no-repeat left top;
    width: 24.125em;
    height: 4.125em;
    background-size: 100%;
}

.homePageVerticalButtonMiddle {
    /* And so does the rest of these even though homePageVerticalButtonMiddle and homePageVerticalButtonTop are analogous cases and both PNGs are there. */
    background: url(../images/homePageMiddleButton_normal.png) no-repeat left top;
    width: 24.125em;
    height: 4.125em;
    background-size: 100%;
}

.homePageVerticalButtonMiddle:hover {
    background: url(../images/homePageMiddleButton_mouseOver.png) no-repeat left top;
    width: 24.125em;
    height: 4.125em;
    background-size: 100%;
}

.homePageVerticalButtonMiddle:active {
    background: url(../images/homePageMiddleButton_mouseOver.png) no-repeat left top;
    width: 24.125em;
    height: 4.125em;
    background-size: 100%;
}

/* Bottom omitted for brevity, but it's analogous to Top and only works on the hover and active states too. */

.verticalNavigationText {
    color: #FFFFFF;
    font-family: inherit;
    font-size: 1.75em;
    padding: 0.59375em 0 0.59375em 0.625em;
} 
```

**编辑**：请保留有关主题的答案，解决这些图像丢失的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:25:05.410

Dreamweaver 永远不应该被信任用于预览，它自己的行为是无关紧要的，因为其他人都将使用浏览器。话虽如此，您的设计模式需要一些关注。

```
<div class="homePageVerticalButtonTop">
    <div class="verticalNavigationText"><a style="display:block" href="top.html">top link</a></div>
</div> 
```

可以更清楚地表示为：

```
<div class="homePageVerticalButtonTop">
  <a href="top.html">top link</a>
</div> 
```

您应用到链接的 CSS 然后可以表示为：

```
.homePageVerticalButtonTop a {
     display:block
} 
```

...以及您的链接的其他其他样式应该放在那里，例如应用于冗余“verticalNavigationText”div的样式。避免内联 CSS。

# postgresql - 如何在没有超级用户帐户的情况下创建 postgresql 超级用户？

> ID：11677314
> 
> 赞同：3
> 
> 时间：2012-07-26T20:14:12.947
> 
> 标签：postgresql, postgresql-9.1, osx-mountain-lion

好的...刚刚安装了山狮。我注意到的第一件事是登录屏幕中缺少我的 Postgres 用户帐户。然后我验证了我的 postgres 安装不再工作。所以我在我的 Mac 上创建了一个新的 postgres 用户帐户，并设置了所有正确的权限来启动 postgres 服务器。它启动但立即服务器关闭。我检查了日志文件，它说角色“postgres”不存在。

我不知道如何在数据库中创建这个用户，因为数据库不允许我在不使用超级用户帐户的情况下访问它。我尝试了“createuser postgres”，但得到了相同的消息，“角色'postgres'不存在”。我现在不知道该怎么办。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:26:12.533

发现了我的问题。在升级到山狮的过程中，不知何故，我的 postgres db 用户确实被删除了。但是，我能够使用与登录系统相同的名称登录数据库。不幸的是，我发现我的数据库在升级过程中也被删除了。我不知道为什么，但升级确实影响了我的 postgresql 安装。登录后发现postgres db和template1 db没有关系可查。现在将我的数据库重新组合在一起......幸运的是我仍处于开发模式。注意：将来在升级系统之前进行数据库备份。

# c# - 'string' 在遍历 ViewBag 时不包含 helper 的定义

> ID：11677316
> 
> 赞同：1
> 
> 时间：2012-07-26T20:14:18.250
> 
> 标签：c#, asp.net-mvc, razor

我有一个独特的'字符串'不包含定义问题。

采取以下查看代码：

```
@if (ViewBag.Stories != null)
{
    if (ViewBag.Stories.Count > 0)
    {
    <h2>Stories (@ViewBag.Stories.Count)</h2>
    <ul>
        @foreach (var item in ViewBag.Stories)
        {
            <li>
                @("test".ToString().ToSeoUrl())
                <h2>@(item.Title.ToString().ToSeoUrl())</h2>
            </li>
        }
    </ul>
    }
} 
```

如果我从 item.Title 中删除 '.ToString().ToSeoUrl()' 我得到：

*   测试

    标题

*   测试

    标题

*   测试

    标题

如果我把它加回来。我得到了例外

> “/”应用程序中的服务器错误。
> 
> “字符串”不包含“ToSeoUrl”的定义

我正在使用 Razor 并在视图中注册了以下帮助程序类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;
using System.Web.Mvc;

namespace MyNamespace.Helpers
{    
    public static class StringExtensions
    {
        public static string ToSeoUrl(this string url)
        {
        // make the url lowercase
        string encodedUrl = (url ?? "").ToLower();

        // replace & with and
        encodedUrl = Regex.Replace(encodedUrl, @"\&+", "and");

        // remove characters
        encodedUrl = encodedUrl.Replace("'", "");

        // remove invalid characters
        encodedUrl = Regex.Replace(encodedUrl, @"[^a-z0-9]", "-");

        // remove duplicates
        encodedUrl = Regex.Replace(encodedUrl, @"-+", "-");

        // trim leading & trailing characters
        encodedUrl = encodedUrl.Trim('-');

        return encodedUrl;
        }
    }
} 
```

item 是一个名为 Story 的自定义类，带有一个公共字符串 Title

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:32:42.017

扩展方法不能动态调度。因为您正在使用`ViewBag`which is`dynamic`和`ToSeoUrl`which is 扩展方法，所以您得到一个`RuntimeBinderException`.

有两种方法可以解决这个问题：

1.  使用 cast:`<h2>@(((string)item.Title).ToSeoUrl())</h2>`调用`ToString()`是不够的，因为它还会被动态调度。
2.  在没有扩展方法语法的情况下调用扩展方法作为普通静态方法：`<h2>@(StringExtensions.ToSeoUrl(item.Title))</h2>`

# android - Robolectric 和 IntentServices

> ID：11677320
> 
> 赞同：14
> 
> 时间：2012-07-26T20:14:54.960
> 
> 标签：android, unit-testing, broadcastreceiver, intentservice, robolectric

使用 Robolectric，如何测试一个将意图广播为响应的 IntentService？

假设以下类：

```
class MyService extends IntentService {
    @Override
    protected void onHandleIntent(Intent intent) {
        LocalBroadcastManager.getInstance(this).sendBroadcast(new Intent("action"));
    }
} 
```

在我的测试用例中，我试图做这样的事情：

```
@RunWith(RobolectricTestRunner.class)
public class MyServiceTest{
    @Test
    public void testPurchaseHappyPath() throws Exception {

        Context context = new Activity();

        // register broadcast receiver
        BroadcastReceiver br = new BroadcastReceiver() {

            @Override
            public void onReceive(Context context, Intent intent) {
                // test logic to ensure that this is called
            }

        };
        context.registerReceiver(br, new IntentFilter("action"));

        // This doesn't work
        context.startService(new Intent(context, MyService.class));

    }

} 
```

MyService 永远不会使用这种方法启动。我对 Robolectric 比较陌生，所以我可能遗漏了一些明显的东西。在调用 startService 之前我必须做某种绑定吗？我已经通过在上下文中调用 sendBroadcast 来验证广播是否有效。有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-17T12:42:30.790

您无法像尝试那样测试服务初始化。当你在 Robolectric 下创建一个新的活动时，你得到的活动实际上是一种[`ShadowActivity`](https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowActivity.java)（一种）。这意味着当您调用时`startService`，实际执行的方法是[this](https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowContextWrapper.java#L129)，它只是调用 into [`ShadowApplication#startService`](https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowApplication.java#L178)。这是该方法的内容：

```
@Implementation
@Override
public ComponentName startService(Intent intent) {
    startedServices.add(intent);
    return new ComponentName("some.service.package", "SomeServiceName-FIXME");
} 
```

您会注意到它实际上并没有尝试启动您的服务。它只是指出您试图启动该服务。这对于某些被测代码应该启动服务的情况很有用。

如果你想测试实际的服务，我认为你需要为初始化位模拟服务生命周期。像这样的东西可能会起作用：

```
@RunWith(RobolectricTestRunner.class)
public class MyServiceTest{
    @Test
    public void testPurchaseHappyPath() throws Exception {

        Intent startIntent = new Intent(Robolectric.application, MyService.class);
        MyService service = new MyService();
        service.onCreate();
        service.onStartCommand(startIntent, 0, 42);

        // TODO: test test test

        service.onDestroy();
    }
} 
```

我不熟悉 Robolectric 如何处理`BroadcastReceiver`s，所以我把它省略了。

**编辑**`@Before`：在 JUnit /方法中进行服务创建/销毁可能更有意义`@After`，这将允许您的测试仅包含`onStartCommand`和“测试测试测试”位。

# android - 如何引导用户添加小部件？

> ID：11677323
> 
> 赞同：2
> 
> 时间：2012-07-26T20:15:01.590
> 
> 标签：android, android-widget

我有一个应用程序，它主要有两件事：一个可以添加到 hone 屏幕的小部件，以及一个由图像组成的 how-to-add-widget 活动。

正如我所注意到的，根据设备/安卓版本，有不同的方法可以将小部件添加到主屏幕。因此，我的活动的引导图像将根据设备而有所不同。

*   您对如何在正确的设备中显示正确的操作方法有什么建议吗？
*   是否有编程方式向用户打开设备的小部件列表？

谢谢。

# stata - 有没有办法在 Stata 中获取 Unix 时间戳？

> ID：11677326
> 
> 赞同：0
> 
> 时间：2012-07-26T20:00:07.347
> 
> 标签：stata

我在网上搜索并找到[了几个](http://www.stata.com/statalist/archive/2002-09/msg00518.html) 关于将 Unix 时间戳转换为各种可行格式的[资源，但没有一个资源允许我从 Stata 中真正获得这样的时间戳。](http://log.tofias.net/post/486823675/time-stamp-in-stata)截至目前，我使用变体

```
local curr_date = c(current_date)
local curr_time = c(current_time) 
```

将时间戳应用于日志、数据集等，但如果可能的话，我想以秒为单位使用 Unix 时间戳。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:24:44.807

你熟悉[帮助日期时间](http://www.stata.com/help.cgi?datetime)吗？我的理解是 Unix 时间戳将类似于

```
display %12.0g clock("`c(current_date)' `c(current_time)'", "DMY hms" )/1000 - clock("1 Jan 1970", "DMY" )/1000 
```

当然，您也可以在其他情况下使用。（我不是 C 程序员，我是 Stata 用户，但我确实明白，对于这个站点上的大多数人来说，编写[一段](https://stackoverflow.com/a/11688606/874882)进入 Stata 内部的 C 代码片段比编写 RTFM 更容易......当然，从我坐的地方来看，它以自己的方式令人钦佩。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T13:21:59.990

实现这一点的一种方法是编写一个简单的插件。在名为的文件中编译此代码`unixtimestamp.c`

```
#include "stplugin.h"
#include <stdlib.h>
#include <time.h>
#include <stdio.h>

STDLL stata_call(int argc, char *argv[])
{
    time_t seconds;
    seconds = time(NULL);
    char buf[33];
    sprintf(buf, "%d", seconds);

    SF_display(buf);
    return(0);
} 
```

使用此命令将[stplugin.h](http://www.stata.com/plugins/stplugin.h)和[stplugin.c](http://www.stata.com/plugins/stplugin.c)放在同一目录中（对于 Linux 系统）：

```
gcc -O3 -shared -DSYSTEM=OPUNIX -fPIC stplugin.c unix_timestamp.c -o unixtimestamp.plugin 
```

创建插件的[指南](http://www.stata.com/plugins/#sect5b)使用以下命令：

```
gcc -shared -DSYSTEM=OPUNIX stplugin.c unixtimestamp.c -o unixtimestamp.plugin 
```

但在某些系统上，这会给出一个错误，指示您使用该`-fPIC`标志，这就是我将它包含在我的命令中的原因。此外，对于这样一个简单的插件，优化并不是真正必要的，但无论如何我都将它们包括在内。

`unixtimestamp.plugin`应该放在`ado/personal/`目录中。运行 Stata 的`sysdir`函数来找到它的位置。在我的系统上，`HOME/ado/personal/`所以我在那里复制了插件。然后，从 Stata 加载插件：

```
program unixtimestamp, plugin 
```

如果未显示错误消息，请使用以下命令运行插件：

```
plugin call unixtimestamp 
```

与任何 Stata 命令一样，如果您打算经常使用此命令，也可以使用宏来简化此操作：

```
local unixtime plugin call unixtimestamp
`unixtime' 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-07T11:11:04.923

我使用以下内容获取日期/时间戳：

```
di "DateTime: $S_DATE $S_TIME" 
```

**更新：** 您可以直接在 Stata 中使用 Unix shell 命令，方法是在它们前面加上一个感叹号。要回显 Unix 时间，请尝试：

```
!date +%s
1344341160 
```

# clojure - 将多个惰性序列放入一个映射中

> ID：11677327
> 
> 赞同：4
> 
> 时间：2012-07-26T20:15:25.513
> 
> 标签：clojure

给定密钥

```
:id
:tag
:name 
```

和三个惰性序列产生形式的输出

```
(id1 id2 id3 ...)
(name1 name2 name3 ...)
(type1 type2 type3 ...) 
```

我该怎么做才能得到表格中的一系列地图

```
({id: id1 :name name1 :type type1}
{id: id2 :name name2 :type type2}
{id: id3 :name name3 :type type3}
...) 
```

我尝试了应用、映射、关联等的各种组合，但没有得到它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T20:36:09.927

你只需要`map`：

```
(map (fn [id name type] {:id id :name name :type type})
     (id1 id2 id3 ...)
     (name1 name2 name3 ...)
     (type1 type2 type3 ...)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T23:35:19.817

我的答案与 mtyaka 的答案非常相似，但在我看来，它更短，更模块化。

```
(map (fn [& vs] (zipmap [:id :name :type] vs))
     (id1 id2 id3 ...)
     (name1 name2 name3 ...)
     (type1 type2 type3 ...)) 
```

在这里，`zipmap`使用固定键序列和可变值序列创建地图，在“第一步”期间将是`(id1 name1 type1)`，在“第二步”期间将是`(id2 name2 type2)`等等。

这仅在您的三个惰性序列彼此隔离时才有效。如果您有一系列惰性序列，即`((id1 id2 ...) (name1 name2 ...) (type1 type2 ...))`，那么您将不得不对`apply`这个序列进行上述操作，如下所示：

```
(apply map (fn [& vs] (zipmap [:id :name :type] vs))
       ((id1 id2 id3 ...)
        (name1 name2 name3 ...)
        (type1 type2 type3 ..))) 
```

在这里，`apply`只是简单地将代码添加`map (fn [& vs] (zipmap [:id :name :type] vs))`到惰性序列序列的前面，这成为要评估的表达式。换句话说，它产生的表达式与第一个代码块完全相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:41:38.223

我会去：

```
(map hash-map (repeat :id) seq1 (repeat :name) seq2 (repeat :type) seq3) 
```

假设 seq1、seq2 和 seq3 是包含后续键值的惰性序列。

# excel - 在excel中格式化单元格

> ID：11677328
> 
> 赞同：0
> 
> 时间：2012-07-26T20:15:26.717
> 
> 标签：excel, formatting

我有包含数千行和数千列数字数据的 Excel 表，需要对这些数据进行一些计算。但是在少数文件中，即使包含数字，也会有一两个单元格的格式为文本。数据如此庞大，以至于无法检查每个单元格的格式。那么有没有办法纠正这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:33:51.110

如果您使用 Excell 2007 或更高版本，请使用搜索和替换。

留空`Find What`，在find what format中`Replace with`选择，在replace with format中选择（或其他数字格式）。`Text``General`

运行`Replace All`并完成！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:23:14.107

使用 ASAP 实用程序 www.asap-utilities.com/

他们有宏把文本变成数字

你也可以使用价值函数

```
=value(A1) 
```

它将文本转换为数字

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:24:30.673

我将首先选择您希望格式化为数字的特定行/列标题。然后，只需从允许您选择单元格类型的下拉菜单中选择“数字”。这将应用该特定行/列中所有值单元格的格式。

这当然是假设所有读取为文本的单元格都是有效数字。否则，您将不得不使用额外的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T20:40:54.993

或者，将值复制到新工作表，但在此之前，您需要将所有单元格格式化为数字格式并使用“选择性粘贴”选项，选择“值”对话框选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T21:38:08.500

如果您没有任何公式，只有值，您可以运行此代码

```
Sub MakeValues()

    ActiveSheet.UsedRange.NumberFormat = "General"
    ActiveSheet.UsedRange.Value = ActiveSheet.UsedRange.Value

End Sub 
```

# sql-server - 在 SQL Server 集成服务包中解析 JSON 数据？

> ID：11677333
> 
> 赞同：12
> 
> 时间：2012-07-26T20:16:03.440
> 
> 标签：sql-server, json, ssis

我正在尝试设置一个 SSIS 作业，该作业将从 MailChimp 中提取 JSON 编码的邮件列表，将其与我们的 CRM 数据库（SQL Server）中的客户列表进行比较，并通过 JSON 上传尚未存在的任何新客户。除了编写脚本任务之外，我似乎在 SSIS 中找不到任何关于序列化/反序列化 JSON 的内容，而且似乎我无法将 .Net 序列化库导入脚本。有什么建议么？提前致谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-05-21T16:36:46.330

几件事情要在这里解决：

首先，您在脚本组件中添加新库的问题。我假设您正在使用 VS 2008 进行 SSIS 开发并希望使用 .net 3.5 库来执行此操作。你去项目，添加参考，你看不到任何你需要的dll。这可能部分是因为您使用的是 Windows 7 和 compact 3.5 框架。.net 3.5.1 随 Windows 7 一起提供，您只需启用它。转到控制面板、程序和功能。在该屏幕中，您将看到打开或关闭 Windows 功能，单击它。在该窗口中检查 Microsoft .NET Framework 3.5.1，这种方式需要几分钟才能运行。完成后查找类似于这些 C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v3.5\Profile\Client 和 C:\Program Files (x86)\Reference Assemblies\Microsoft\ 的目录框架\v3.5。在这两个目录之间，您将找到 JSON 序列化/反序列化所需的任何 dll。这些可以通过转到项目->添加引用->浏览选项卡添加到您的项目中，然后导航到 v3.5 目录并选择您需要的 dll (System.Web.Extensions.dll(v3.5.30729.5446 )在本例中使用)。

要从 Web 服务获取 JSON，对其进行反序列化并将数据发送到您的 CRM 数据库，您必须使用脚本组件作为数据流中的源，并将列添加到将用于保存数据的输出缓冲区来自 JSON 提要（在输入和输出屏幕上）。在代码中，您需要重写 CreateNewOutputRows 方法。以下是如何执行此操作的示例：

说你的 JSON 看起来像这样......`[{"CN":"ALL","IN":"Test1","CO":0,"CA":0,"AB":0},{"CN":"ALL","IN":"Test2","CO":1,"CA":1,"AB":0}]`

我会首先定义一个类来镜像这个 JSON 提要属性（以及您在输入和输出屏幕上定义的列），一旦您反序列化，最终将保存这些值......如下所示：

```
class WorkGroupMetric
{
    public string CN { get; set; }

    public string IN { get; set; }

    public int CO { get; set; }

    public int CA { get; set; }

    public int AB { get; set; }
} 
```

现在您需要调用 Web 服务并使用 HttpWebRequest 和 Stream 获取 JSON 提要：

```
string wUrl = "YOUR WEB SERVICE URI";
string jsonString;
HttpWebRequest httpWReq = (HttpWebRequest)WebRequest.Create(wUrl);
HttpWebResponse httpWResp = (HttpWebResponse)httpWReq.GetResponse();
Stream responseStream = httpWResp.GetResponseStream();
using (StreamReader reader = new StreamReader(responseStream))
            {
                jsonString = reader.ReadToEnd();
                reader.Close();
            } 
```

现在我们将我们的 json 反序列化为一个 WorkGroupMetric 数组

```
JavaScriptSerializer sr = new JavaScriptSerializer();
WorkGroupMetric[] jsonResponse = sr.Deserialize<WorkGroupMetric[]>(jsonString); 
```

反序列化后，我们现在可以将行输出到输出缓冲区：

```
 foreach (var metric in jsonResponse)
        {

            Output0Buffer.AddRow();
            Output0Buffer.CN = metric.CN;
            Output0Buffer.IN = metric.IN;
            Output0Buffer.CO = metric.CO;
            Output0Buffer.CA = metric.CA;
            Output0Buffer.AB = metric.AB;
        } 
```

这是所有代码放在一起的样子（我在[这里](http://dennysjymbo.blogspot.com/2013/05/using-json-feed-as-data-source-in-ssis.html)有一个分步示例）：

```
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;
using System.Net;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;
using System.IO;
using System.Web.Script.Serialization;

 [Microsoft.SqlServer.Dts.Pipeline.SSISScriptComponentEntryPointAttribute]
 public class ScriptMain : UserComponent
 {

public override void CreateNewOutputRows()
{
    string wUrl = "YOUR WEB SERVICE URI";

    try
    {
        WorkGroupMetric[] outPutMetrics = getWebServiceResult(wUrl);

        foreach (var metric in outPutMetrics)
        {

            Output0Buffer.AddRow();
            Output0Buffer.CN = metric.CN;
            Output0Buffer.IN = metric.IN;
            Output0Buffer.CO = metric.CO;
            Output0Buffer.CA = metric.CA;
            Output0Buffer.AB = metric.AB;
        }

    }
    catch (Exception e)
    {
        failComponent(e.ToString());
    }

}

private WorkGroupMetric[] getWebServiceResult(string wUrl)
{

    HttpWebRequest httpWReq = (HttpWebRequest)WebRequest.Create(wUrl);
    HttpWebResponse httpWResp = (HttpWebResponse)httpWReq.GetResponse();
    WorkGroupMetric[] jsonResponse = null;

    try
    {

        if (httpWResp.StatusCode == HttpStatusCode.OK)
        {

            Stream responseStream = httpWResp.GetResponseStream();
            string jsonString;

            using (StreamReader reader = new StreamReader(responseStream))
            {
                jsonString = reader.ReadToEnd();
                reader.Close();
            }

            JavaScriptSerializer sr = new JavaScriptSerializer();
            jsonResponse = sr.Deserialize<WorkGroupMetric[]>(jsonString);

        }

        else
        {
            failComponent(httpWResp.StatusCode.ToString());

        }
    }
    catch (Exception e)
    {
        failComponent(e.ToString());
    }
    return jsonResponse;

}

private void failComponent(string errorMsg)
{
    bool fail = false;
    IDTSComponentMetaData100 compMetadata = this.ComponentMetaData;
    compMetadata.FireError(1, "Error Getting Data From Webservice!", errorMsg, "", 0, out fail);

}
}
 class WorkGroupMetric
 {
public string CN { get; set; }

public string IN { get; set; }

public int CO { get; set; }

public int CA { get; set; }

public int AB { get; set; }
 } 
```

这现在可以用作数据目的地（您的 CRM 数据库）的输入。在那里，您可以使用 SQL 比较数据并查找不匹配项，将数据发送到另一个脚本组件进行序列化，并将您需要的任何更新发送回 Web 服务。

或者

您可以在脚本组件中执行所有操作，而不是将数据输出到输出缓冲区。在这种情况下，您仍然需要反序列化 JSON，但将数据放入某种集合中。然后使用实体框架和 LINQ 来查询您的数据库和集合。确定不匹配的内容，对其进行序列化，并将其发送到同一脚本组件中的 Web 服务。

# javascript - mongodb流星集合中的重复键

> ID：11677334
> 
> 赞同：2
> 
> 时间：2012-07-26T20:16:04.050
> 
> 标签：javascript, node.js, mongodb, uuid, meteor

我目前正在开发一个流星应用程序，有时我的服务器会出现以下错误：

调用方法'/songs/insert'时出现异常 MongoError: E11000 重复键错误索引：megan.songs.$ *id* dup key: { : "399dc507-b1fe-4e0f-a2c4-fa3dabd2bdf5" }

插入方法是这样调用的：

Songs.insert({name: vid, score: weight, title:title, listkey:Session.get('listkey')});

有谁能够帮我？

提前致谢，

话题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T07:15:46.247

哪个键被复制了？ObjectId (_id) 字段不能重复。它是 listkey 字段吗？可能您在 listkey 字段上设置了唯一索引，并且您的 Session.get() 以某种方式返回现有密钥，这就是您的插入失败的原因..您可以执行：

```
db.Songs.find({listkey:"399dc507-b1fe-4e0f-a2c4-fa3dabd2bdf5"}); 
```

并检查是否返回了多个文件？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-14T04:21:11.130

并不是说这是您的解决方案，但是...如果您使用 SimpleSchema 并且您在该字段上指定了“唯一”或“索引”，则可能会遇到此问题。即使您已修改 SimpleSchema 对象以删除约束，您也需要 .drop() 。

# mediawiki - MediaWiki 的 AccessControl 扩展的问题

> ID：11677336
> 
> 赞同：2
> 
> 时间：2012-07-26T20:16:07.230
> 
> 标签：mediawiki, acl, access-control

我已经安装了[AccessControl](http://www.mediawiki.org/wiki/Extension:AccessControl) MediaWiki 扩展，但是如果您搜索甚至包含在受访问控制的页面中的任何内容，它似乎会导致访问被拒绝错误。

有人使用这个扩展吗？

我想做的就是对除 5 个人之外的所有人隐藏 wiki 中的一页。

MediaWiki 版本 1.18.0 访问控制版本 2.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:52:30.180

我通过添加另一个命名空间来放置我需要保护的页面来解决它。然后我通过实现 searchablenamespaces 钩子将命名空间从可搜索中删除。

通过这样做，仅通过搜索恰好位于访问受控页面中的文本就不会显示访问被拒绝页面。

这是 $IP/extensions/NoSearchNameSpace/NoSearchNameSpace.php 的代码

```
<?php
// This is a quick hack to remove certain listed namespaces from being searchable
// Just set a list of namespace IDs in the wgNoSearchNamespaces array in LocalSettings
// ie $wgNoSearchNamespaces = array(500,501) would remove 500 and 501 from being searched
$wgHooks['SearchableNamespaces'][] = 'noSearchNameSpace';
function noSearchNameSpace($arr){
    global $wgNoSearchNamespaces;
    foreach($wgNoSearchNamespaces as $ns){
        unset($arr[$ns]);
    }

    return $arr;
} 
```

示例 LocalSettings.php 条目：

```
// Add two custom namespaces. One for ACL pages.
// one for pages that will be ACL'd that should not be searched.
$wgExtraNamespaces[500] = "ACL";
$wgExtraNamespaces[501] = "NoSearch";

// Include the NoSearchNamespace extension
require_once("extensions/NoSearchNamespace/NoSearchNameSpace.php");
$wgNoSearchNamespaces = array('500','501'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T10:49:13.770

我用 1.20.2 尝试过，当我正在搜索的页面包含正在搜索的文本时出现问题，将其放在搜索结果列表中，这引发了错误，因为 AccessControl.php 中的“hookUserCan”函数没有返回一个值。为了解决这个问题，我将 AccessControl.php ("return doRedirect('accesscontrol-info-anonymous');" 的第 341 行修改为 "return false;"。这会强制搜索结果只返回页面的标题，如果未经授权的用户尝试打开它，则会出现权限错误。这不是一个完美的解决方案，但对于我的目的来说已经足够了。

编辑，这是一个更好的答案：

我对 AccessControl.php 程序进行了一些修改，现在它似乎可以与 MediaWiki 用户组一起使用。剩下的问题是受保护页面的标题显示在搜索结果中。这可以在主要的 MediaWiki 源代码（SpecialSearch.php，第 562 行附近）中修复，但根据该代码中的注释，它会搞砸分页。

这是我的git目录，可以解压到$IP/extensions/AccessControl：

[https://ejc.s3.amazonaws.com/AccessControlGit.zip](https://ejc.s3.amazonaws.com/AccessControlGit.zip)

这里只是 AccessControl.php 文件： http: [//pastebin.com/WnyB6gBw](http://pastebin.com/WnyB6gBw)

请注意，这仅在 MediaWiki 1.20.2 中（简单地）测试过。我希望扩展的作者能够审查我所做的并解决仍然存在的任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-23T14:08:16.193

我通过添加修复了这个错误

```
return false; 
```

在所有说的话之后

```
doRedirect( 'accesscontrol-info-anonymous' ); 
```

# objective-c - Xcode 加载查看功能

> ID：11677339
> 
> 赞同：0
> 
> 时间：2012-07-26T20:16:17.790
> 
> 标签：objective-c, xcode, loading

不久前我正在阅读一个教程，我看到了一个我很想实现的功能。这是一个采用 UIAlertView 形式的加载视图，您可以自定义其中的图像和文本。如果有人知道那是什么课程，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:39:09.763

您可能正在寻找[UIAlertView Custom Graphics](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-uialertview-custom-graphics/)或[Create a Custom Alert](http://joris.kluivers.nl/blog/2009/04/23/subclass-uialertview-to-create-a-custom-alert/)。

# objective-c - 我正在尝试使用 nsparser 从网页中提取数据

> ID：11677343
> 
> 赞同：0
> 
> 时间：2012-07-26T20:16:48.873
> 
> 标签：objective-c, nsstring, uitextview

```
 -(NSMutableArray *)titlesFromString:(NSString *) pageData
{
    NSMutableArray *foundTitles=[[NSMutableArray alloc] init];
 NSScanner *scaningPage = [NSScanner scannerWithString:pageData];

    NSString *title;
    for (int i =0;i<4;i++) {
    [scaningPage scanUpToString:@"class='topic_title" intoString:NULL];
    [scaningPage scanUpToString:@">" intoString:NULL];
    scaningPage.scanLocation++;
    [scaningPage scanUpToString:@"</a></h4>" intoString:&title];
    [foundTitles addObject:title];
    }

   status.text = [[NSNumber numberWithInt:[foundTitles count]] stringValue];
    for (NSString *titlesLife in foundTitles){
        [results.text stringByAppendingString:@"\n"];
        [results.text stringByAppendingString:titlesLife];
    }
   return(nil);

} 
```

现在我返回 nil 直到让它工作。我从connectionDidFinishLoading 调用这个方法。

在文档中，他们使用 while 循环 while ([theScanner isAtEnd] == NO){} 但他们也在常规数据集上执行此操作，其中扫描的最后一件事位于字符串的末尾，所以我猜那是为什么我遇到了界限问题。我还看到了 RegexKit 框架，它可能比解析器工作得更好。直到我得到while循环才发现我有一个for循环来获取一些信息。我在想我需要检查是否存在另一个元素，如果没有，则进行扫描，以免扫描仪超出范围。

我也很困惑，为什么我需要在将“>”扫描为空时增加扫描仪位置，否则我最终会得到类似“> 现在正在播放什么歌曲？”之类的字符串 当我认为使用 initWithContentsOfUrl 可能更简单时，我也在使用 NSURLConnection 来获取数据，但是获得连接路由的经验很好。

第二块是我试图将我的结果添加到结果 UITextView 这似乎不起作用。我不应该 setNeedsDisplay 应该吗？我以为那只是在代码中绘制视图时。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:19:46.893

第 2 部分：

您正在将额外的文本添加到标签的文本中，然后将其丢弃:)

尝试这样的事情：

```
results.text = [results.text stringByAppendingString:@"\n"]; 
```

第 1 部分要复杂得多。

处理 HTML 是一个出了名的棘手问题 :( 但是，[在堆栈溢出问题上](https://stackoverflow.com/a/1618272/13000)，您的问题有一个很好的答案。我从未使用过该库，但 +61 票可能是一个很好的迹象 :)

# serialization - EJB。当我使用 var List 调用会话 Bean 时，抛出：this javax.ejb.EJBException: java.rmi.MarshalException

> ID：11677345
> 
> 赞同：2
> 
> 时间：2012-07-26T20:16:51.783
> 
> 标签：serialization, persistence, ejb, javabeans, stateless-session-bean

我在 netbeans 中创建了一个 java web 项目，我创建了我的实体 bean，然后部署了我的项目来生成我的数据库，这项工作是成功的。

然后我生成了会话 bean 来访问创建的数据库。我创建了一个主类来测试会话 bean，当我测试通过会话 bean 接口调用的方法“find”时，我注意到一些类抛出异常，并且我注意到带有 vars List 的实体类抛出好像它们无法序列化的异常。

我想给我带来实体列表是一个请求。

我在同一个项目中拥有实体 bean，该项目具有我的会话 bean，在 Web 应用程序中......

我使用 Glass Fish 3.1.2
Netbeans 7.1.2
EclipseLink 2.0

实体持久性是：

```
@Entity

public class UserApplication implements Serializable {

private static long serialVersionUID = 1L;

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Long idUserApplication;
@Basic(optional=false)
@Column(nullable=false)
private String dcn;
@Basic(optional=false)
@Column(nullable=false)
private String password;
@Basic(optional=false)
@Column(nullable=false)
private String title ;
@Basic(optional=false)
@Column(nullable=false)
private String firstName;
@Basic(optional=false)
@Column(nullable=false)
private String lastName;
@Basic(optional=false)
@Column(nullable=false)
private String ci;
@Basic(optional=false)
@Column(nullable=false)
private String personalEmail;
@Basic(optional=false)
@Column(nullable=false)
private String workEmail;

@OneToMany
@JoinColumn(name = "userApplication_id", nullable = false)
private List<Account> accounts;
@OneToMany
@JoinColumn(name = "userApplication_id", nullable = true)
private List<CreditCard> creditCards = null;

@ManyToMany
@JoinTable(name="UserApplication_BeneficiaryThird", joinColumns=@JoinColumn
        (name="userApplication_id", nullable = false), inverseJoinColumns=
        @JoinColumn(name="beneficiaryThird_id", nullable = false))
private List<BeneficiaryThird> beneficiariesThird = null;

@OneToMany
@JoinColumn(name = "userApplication_id_beneficiary", nullable = true)
private List<BeneficiaryBankItself> beneficiariesBankItself = null;

@ManyToMany
@JoinTable(name="UserApplication_TransactionRule", joinColumns=@JoinColumn
        (name="userApplication_id", nullable = false), inverseJoinColumns=
        @JoinColumn(name="transactionRule_id", nullable = false))
private List<TransactionRule> transactionRules = null;

@OneToOne(mappedBy = "userApplication", optional = true, cascade = CascadeType.ALL)
private SessionCookie cookieId = null;................ 
```

主类是：

```
public class Main {

public static void main(String[] args) {

    long id = 2;

    bank.setId(id);
    UserApplication userApplication = GetBean.getUserFacade().find(id);
    System.out.println("user: " + userApplication.getFirstName());

    }

} 
```

GetBean 是实用程序类，是：

```
public class GetBean {

public static BankFacadeLocal getBankFacade() {

    BankFacadeLocal bankFacade = null;
    String jndiName = beans.BankFacadeLocal.class.getName();
    try {
         //bankFacade = (BankFacadeLocal) new InitialContext().lookup("java:global/IntegrationBanking/BankFacade!sessionBeans.BankFacadeLocal");
          bankFacade = (BankFacadeLocal) new InitialContext().lookup(jndiName);        
    } catch (NamingException ex) {
        Logger.getLogger(GetBean.class.getName()).log(Level.SEVERE, null, ex);
    }

    return bankFacade;
 }

 public static UserApplicationFacadeLocal getUserFacade() {

    UserApplicationFacadeLocal userFacade = null;
    String jndiName = UserApplicationFacadeLocal.class.getName();
    try {
         // userFacade = (UserApplicationFacadeLocal) new InitialContext().lookup("java:global/IntegrationBanking/UserApplicationFacade!beans.UserApplicationFacadeLocal");
         userFacade = (UserApplicationFacadeLocal) new InitialContext().lookup(jndiName);        
    } catch (NamingException ex) {
        Logger.getLogger(GetBean.class.getName()).log(Level.SEVERE, null, ex);
    }

    return userFacade;
} 
```

}

坚持单位：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
<persistence-unit name="BankingIntegrationPU" transaction-type="JTA">
<provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
<jta-data-source>sqlServer</jta-data-source>
<properties>
  <property name="eclipselink.ddl-generation" value="create-tables"/>
</properties>
</persistence-unit>
</persistence> 
```

例外是：

```
jul 26, 2012 2:55:38 PM com.sun.corba.ee.spi.orbutil.logex.WrapperGenerator handleFullLogging
Advertencia: IOP00810011: Exception from readValue on ValueHandler in CDRInputStream
org.omg.CORBA.MARSHAL: Advertencia: IOP00810011: Exception from readValue on ValueHandler in CDRInputStream  vmcid: OMG  minor code: 11 completed: Maybe
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)............
Caused by: java.io.IOException: Mismatched serialization UIDs : Source (Rep. IDRMI:entities.UserApplication:5CDFA7C871B53786:F07C8D07E21B75FA) = F07C8D07E21B75FA whereas Target (Rep. ID RMI:entities.UserApplication:4357CF2703B83ACF:180694EF6A1B61BC) = 180694EF6A1B61BC
    at com.sun.corba.ee.impl.util.RepositoryId.useFullValueDescription(RepositoryId.java:679)
    at com.sun.corba.ee.impl.util.RepositoryId.useFullValueDescription(RepositoryId.java:639)
    at com.sun.corba.ee.impl.io.ValueHandlerImpl.useFullValueDescription(ValueHandlerImpl.java:360)
    at com.sun.corba.ee.impl.io.IIOPInputStream.simpleReadObject(IIOPInputStream.java:422)........
jul 26, 2012 2:55:38 PM com.sun.corba.ee.spi.orbutil.logex.WrapperGenerator handleFullLogging
Advertencia: ORBIO00013: Stream corrupted
java.io.StreamCorruptedException: Advertencia: ORBIO00013: Stream corrupted
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)............
jul 26, 2012 2:55:38 PM com.sun.corba.ee.spi.orbutil.logex.WrapperGenerator handleFullLogging
Advertencia: IOP00810011: Exception from readValue on ValueHandler in CDRInputStream
org.omg.CORBA.MARSHAL: Advertencia: IOP00810011: Exception from readValue on ValueHandler in CDRInputStream  vmcid: OMG  minor code: 11 completed: Maybe
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)............
Caused by: java.io.StreamCorruptedException: Advertencia: ORBIO00013: Stream corrupted
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)...........
Exception in thread "main" javax.ejb.EJBException: java.rmi.MarshalException: CORBA MARSHAL 1330446347 Maybe; nested exception is: 
    org.omg.CORBA.MARSHAL: Advertencia: IOP00810011: Exception from readValue on ValueHandler in CDRInputStream  vmcid: OMG  minor code: 11 completed: Maybe
    at beans._BeneficiaryBankItselfFacadeLocal_Wrapper.find(beans/_BeneficiaryBankItselfFacadeLocal_Wrapper.java)....................
Caused by: java.rmi.MarshalException: CORBA MARSHAL 1330446347 Maybe; nested exception is: 
    org.omg.CORBA.MARSHAL: Advertencia: IOP00810011: Exception from readValue on ValueHandler in CDRInputStream  vmcid: OMG  minor code: 11 completed: Maybe
    at com.sun.corba.ee.impl.javax.rmi.CORBA.Util.mapSystemException(Util.java:267)...........
Caused by: org.omg.CORBA.MARSHAL: Advertencia: IOP00810011: Exception from readValue on ValueHandler in CDRInputStream  vmcid: OMG  minor code: 11 completed: Maybe
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)..................
Caused by: java.io.StreamCorruptedException: Advertencia: ORBIO00013: Stream corrupted
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57).................... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-21T19:44:42.167

我的回答可能不正确，但我遇到了这个问题并解决了它。对我来说，问题只是我的数据库没有连接！我在 Glassfish 中对此进行了测试，确认了数据库连接问题并修复了它，然后这个错误就消失了。

就理解为什么*这*是我们得到的神秘错误消息而言，以下解释可能会有所帮助：

*   首先，实体 bean（现在被使用 Java Persistence API 取代）是一种 EJB，因此在 EJB 容器中运行。
*   您的主类存在于 EJB 容器之外，因此必须“调用”一个 EJB。它通过使用 CORBA（通用对象请求代理体系结构）来做到这一点
*   CORBA 是围绕您可以远程实例化和操作对象的想法构建的。例如，您可以创建 EJB 实例、设置其成员属性、运行其方法，所有这些都来自EJB 容器*外部的 main 方法。*CORBA 是理论上任何“客户端”都可以使用的通用标准（例如，进行符合 CORBA 的调用的 C++ 程序理论上可以在这里工作。但当然，Java 世界中的大多数人只是使用 CORBA 来访问EJB 容器。
*   你得到的特定错误是`ORBIO00013: Stream corrupted`，我不完全理解，但我认为它的意思是你的主程序成功连接到 EJB 容器，EJB 容器抛出异常，然后返回了 CORBA 没有预料到的东西，这损坏了用于发送响应的流。
*   真正的问题是 CORBA 没有很好地处理 EJB 中抛出的异常，因此解决此问题的唯一方法是调试程序并找到 EJB 中抛出异常的位置，然后查看异常直接在调试器中。

完成所有这些最终帮助我理解了一个简单的数据库连接问题（！）是问题所在。

希望这会有所帮助，乔希

# salesforce - Salesforce 应用程序关注停止工作

> ID：11677349
> 
> 赞同：1
> 
> 时间：2012-07-26T20:17:09.027
> 
> 标签：salesforce

我的公司有一个应用程序，他们从应用程序交换（注意：在我开始之前）下架，允许您在 salesforce.com 中关注或取消关注大量案例/帐户/机会等。据说以前有效，现在无效。我需要了解每个按钮的代码有什么问题。如果我无法修复它们，有什么替代应用的想法吗？该应用程序不再在应用程序交换中。

这是关注按钮的代码：

```
{!REQUIRESCRIPT("/soap/ajax/18.0/connection.js")}

//EDIT THE FOLLOWING LINE TO ALTER THE CODE FOR OTHER OBJECTS. USE THE PICKLISTS ABOVE        TO SELECT FIELD TYPE = $ObjectType AND THE OBJECT NAME THEN REPLACE "$ObjectType.Case" WITH   YOUR NEW OBJECT NAME
var records = {!GETRECORDIDS( $ObjectType.Case)};

function LBox() {
var box = new parent.SimpleDialog("steve"+Math.random(), true);
parent.box = box;`

 box.setTitle("Follow Records");

box.createDialog();
box.setWidth(220);

box.setContentInnerHTML("<img src='/img/loading32.gif' alt='' /> Running");

box.setupDefaultButtons();`

box.show();
}

function CBox(){
box.setContentInnerHTML("You are now following "+follow_count+" records<br /><br /><a href=\"#\" onclick=\"box.hide();\">Close</a>");
}

if (records[0] == null) { 
alert("Please select at least one record.");
} 
else { 
var follow_count = 0;

LBox();

for (var i = 0; i < records.length; i++){ 
var fol=new sforce.SObject("EntitySubscription");
fol.ParentId = records[i];
fol.SubscriberId = '{!User.Id}';

try{
sforce.connection.create([fol]); 
follow_count++;
}
catch(e){
alert(e);
}
}
CBox();

}

here's the unfollow button:
{!REQUIRESCRIPT("/soap/ajax/18.0/connection.js")}

// EDIT THE FOLLOWING LINE TO ALTER THE CODE FOR OTHER OBJECTS. USE THE PICKLISTS ABOVE TO SELECT FIELD TYPE = $ObjectType AND THE OBJECT NAME THEN REPLACE "$ObjectType.Case" WITH YOUR NEW OBJECT NAME
var records = {!GETRECORDIDS( $ObjectType.Case)};

// display running message popup
function LBox() {
var box = new parent.SimpleDialog("steve"+Math.random(), true);
parent.box = box;`

box.setTitle("Unfollow Records");

box.createDialog();
box.setWidth(220);

box.setContentInnerHTML("<img src='/img/loading32.gif' alt='' /> Running");

box.setupDefaultButtons();

box.show();
}

// display output message
function CBox(){
if (unfollow_count < records.length)
box.setContentInnerHTML("You have now unfollowed "+unfollow_count+" records. You were not following the other selected records. <br /><br /><a href=\"#\" onclick=\"box.hide();\">Close</a>");
else
box.setContentInnerHTML("You have now unfollowed "+unfollow_count+" records. <br /><br /><a href=\"#\" onclick=\"box.hide();\">Close</a>");
}

if (records[0] == null) {
alert("Please select at least one record.");
}
else {
var unfollow_count = 0;`

LBox();

try {
// find following records
var searchstring = "SELECT Id FROM EntitySubscription WHERE (ParentId IN (";
for (var i = 0; i < records.length - 1; i++) {
searchstring += "'" + records[i] + "',";
}
searchstring += "'" + records[records.length - 1] + "') AND SubscriberId ='{!User.Id}')";
var resultRecords = sforce.connection.query(searchstring).getArray("records");

// delete following records
var recordIds = [];
for (var i = 0; i < resultRecords.length; i++) {
recordIds.push(resultRecords[i].Id);
unfollow_count++;
}
sforce.connection.deleteIds(recordIds);
} catch(e) {
alert(e);
}

CBox();
} 
```

第一个错误消息与权限有关，我没有收到此错误，因为我有管理员权限，第二个错误仅在帐户选项卡的按钮上。我更担心权限问题，有什么关于权限的吗？任何帮助都很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:43:33.967

非系统管理员用户对 EntitySubscription 的查询必须包含 LIMIT。如果您将按钮中的查询代码更改为以下内容，它应该可以工作：

```
// find following records
var searchstring = "SELECT Id FROM EntitySubscription WHERE (ParentId IN (";
for (var i = 0; i < records.length - 1; i++) {
   searchstring += "'" + records[i] + "',";
}
searchstring += "'" + records[records.length - 1] + "') AND SubscriberId ='{!User.Id}') LIMIT 1000"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:05:05.733

我认为问题是[SFDC](http://na12.salesforce.com/help/doc/en/salesforce_app_limits_cheatsheet.pdf)中的限制，您只能跟踪每个用户一定数量的记录。如果这个应用程序是按照您描述的那样设计用于大量跟踪记录，那么您可能会踩到油门，这是我从您的同事收到的错误中得到的一种印象`at most 1000`，如果它以前有效，那将是有道理的您已达到组织/用户的最大限制

# git - Tower 给我一个奇怪的错误信息

> ID：11677352
> 
> 赞同：0
> 
> 时间：2012-07-26T20:17:24.030
> 
> 标签：git, git-tower

我在 Tower 的错误目录中添加了一个子模块。所以我将其删除并尝试将其添加到正确的子文件夹中。当我粘贴子模块的 url 时，Tower 告诉我“子模块的目标路径已经存在”。但它不存在。塔是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T23:11:56.757

我通过在这个关于[如何删除 git submodule](https://stackoverflow.com/questions/1260748/how-do-i-remove-a-git-submodule)的 stackoverflow 答案上执行步骤 #2 解决了这个问题，然后输入我希望它创建的目录名称来存储子模块。

# asp.net - 搜索框像谷歌搜索一样工作

> ID：11677353
> 
> 赞同：-10
> 
> 时间：2012-07-26T20:17:25.200
> 
> 标签：asp.net, sql

我有一个 sql 查询应该返回用户文本的结果（如自由文本搜索），它可以是单个字符或单词或单词的组合。
例如，如果我有名为“主题”的列并且它的值为`Very long test`，那么我想要一个查询，如果我在下面的查询中输入`test`or`t`或 `e'

```
 select Subject from [dbo].[Email] where Contains(Subject,'%usertext%') 
```

我尝试在后面的代码中处理，然后将其作为参数发送到查询。由于投反对票太多，我正在编辑这个问题。如果您不理解这个问题，请简单评论，以便我可以尝试更清楚地询问。那会帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T09:55:15.427

您不需要该`%`角色，因为该功能`Contains`已经暗示了这一点。
所以 ：

```
select Subject from [dbo].[Email] where Contains(Subject,'t') 
```

`%`用于`LIKE`功能_

```
select Subject from [dbo].[Email] where Subject LIKE '%t%' 
```

# jquery - jQuery：隐藏/显示不尊重 maxHeight/maxWidth 选项

> ID：11677354
> 
> 赞同：0
> 
> 时间：2012-07-26T20:17:29.427
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

我有一个对话框，该对话框中有一些复选框。当复选框被选中时，它们会使用 show() 展开以显示更多内容。我将对话框的高度选项设置为“自动”，将 maxHeight 设置为 900。问题是，当您单击复选框时，对话框会变得大于其最大高度。

```
$("#some-id").dialog({
   height: 'auto',
   maxHeight: 900
}); 
```

我无法将高度设置为一个明确的值，因为我不知道它最初会有多大。

为什么 hide()/show() 违反了 maxHeight，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:57:28.910

从 maxHeight 选项的描述来看，我认为它只与对话框是否可以由用户调整大小有关。您可能必须使用 css 在包含您的内容的对话框中的元素上设置 max-height。

# css - 重置 CSS box-sizing：通用选择器与 .box 类

> ID：11677359
> 
> 赞同：0
> 
> 时间：2012-07-26T20:17:51.663
> 
> 标签：css, performance, user-interface

> **可能重复：**
> [CSS 的通用选择器对性能有何影响？](https://stackoverflow.com/questions/2951997/what-is-the-performance-impact-of-csss-universal-selector)

我[`box-sizing`](http://css-tricks.com/box-sizing/)在我的样式表上使用该属性，因为它使所有内容更容易布局。

我这样做的方法是制作所有对布局至关重要的元素，然后将类`class="box"`重置为. 我的理由是，最好的做法是尽可能具体。但我最近看到有人用这个：`.box``border-box`

```
* { 
    -webkit-box-sizing: border-box; 
    -moz-box-sizing: border-box;   
    box-sizing: border-box;         
} 
```

这是理想的，因为它重置*所有*元素并采取 0 后端摆弄，但就性能而言，这不是一个坏主意吗？整个文档的通用选择器到底有多贵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:32:29.010

就性能而言，通用选择器是您可以使用的最昂贵的选择器。

这里的基准：http: [//perfectionkills.com/profiling-css-for-fun-and-profit-optimization-notes/](http://perfectionkills.com/profiling-css-for-fun-and-profit-optimization-notes/)

但这就是说，这取决于您所说的“性能”是什么意思。如果您的网站明显变慢，除了样式表之外，可能还有其他原因，除非它们写得*非常糟糕。*

# php - Valum php AJAX 上传：将文件名和路径存储到 mySQL 数据库中

> ID：11677364
> 
> 赞同：1
> 
> 时间：2012-07-26T20:18:05.187
> 
> 标签：php, mysql, sql, ajax, upload

我正在使用来自以下网址的 Valum AJAX 上传脚本：[https](https://github.com/valums/file-uploader) ://github.com/valums/file-uploader 我在如何获取存储到 mySQL 数据库中的文件名和路径时遇到了麻烦。

* * *

使用 php.php 我看到已经有 $pathinfo 和 $filename

```
$pathinfo = pathinfo($this->file->getName());
$filename =  rawurlencode(str_replace(' ', '-', strtolower($pathinfo['filename']))); 
```

我尝试这样做，将其存储到我的数据库中，但它似乎没有存储任何东西。

```
<?php require_once('../../Connections/connSQL.php'); ?>
<?php

/**
 * Handle file uploads via XMLHttpRequest
 */
class qqUploadedFileXhr {
    /**
     * Save the file to the specified path
     * @return boolean TRUE on success
     */
    function save($path) {    
        $input = fopen("php://input", "r");
        $temp = tmpfile();
        $realSize = stream_copy_to_stream($input, $temp);
        fclose($input);

        if ($realSize != $this->getSize()){            
            return false;
        }

        $target = fopen($path, "w");        
        fseek($temp, 0, SEEK_SET);
        stream_copy_to_stream($temp, $target);
        fclose($target);

        return true;
    }
    function getName() {
        return $_GET['qqfile'];
    }
    function getSize() {
        if (isset($_SERVER["CONTENT_LENGTH"])){
            return (int)$_SERVER["CONTENT_LENGTH"];            
        } else {
            throw new Exception('Getting content length is not supported.');
        }      
    }   
}

/**
 * Handle file uploads via regular form post (uses the $_FILES array)
 */
class qqUploadedFileForm {  
    /**
     * Save the file to the specified path
     * @return boolean TRUE on success
     */
    function save($path) {
        if(!move_uploaded_file($_FILES['qqfile']['tmp_name'], $path)){
            return false;
        }
        return true;
    }
    function getName() {
        return $_FILES['qqfile']['name'];
    }
    function getSize() {
        return $_FILES['qqfile']['size'];
    }
}

class qqFileUploader {
    private $allowedExtensions = array();
    private $sizeLimit = 10485760;
    private $file;

    function __construct(array $allowedExtensions = array(), $sizeLimit = 10485760){        
        $allowedExtensions = array_map("strtolower", $allowedExtensions);

        $this->allowedExtensions = $allowedExtensions;        
        $this->sizeLimit = $sizeLimit;

        $this->checkServerSettings();       

        if (isset($_GET['qqfile'])) {
            $this->file = new qqUploadedFileXhr();
        } elseif (isset($_FILES['qqfile'])) {
            $this->file = new qqUploadedFileForm();
        } else {
            $this->file = false; 
        }
    }

    private function checkServerSettings(){        
        $postSize = $this->toBytes(ini_get('post_max_size'));
        $uploadSize = $this->toBytes(ini_get('upload_max_filesize'));        

        if ($postSize < $this->sizeLimit || $uploadSize < $this->sizeLimit){
            $size = max(1, $this->sizeLimit / 1024 / 1024) . 'M';             
            die("{'error':'increase post_max_size and upload_max_filesize to $size'}");    
        }        
    }

    private function toBytes($str){
        $val = trim($str);
        $last = strtolower($str[strlen($str)-1]);
        switch($last) {
            case 'g': $val *= 1024;
            case 'm': $val *= 1024;
            case 'k': $val *= 1024;        
        }
        return $val;
    }

    /**
     * Returns array('success'=>true) or array('error'=>'error message')
     */
    function handleUpload($uploadDirectory, $replaceOldFile = FALSE){
        if (!is_writable($uploadDirectory)){
            return array('error' => "Server error. Upload directory isn't writable.");
        }

        if (!$this->file){
            return array('error' => 'No files were uploaded.');
        }

        $size = $this->file->getSize();

        if ($size == 0) {
            return array('error' => 'File is empty');
        }

        if ($size > $this->sizeLimit) {
            return array('error' => 'File is too large');
        }

        $pathinfo = pathinfo($this->file->getName());
        $filename =  rawurlencode(str_replace(' ', '-', strtolower($pathinfo['filename'])));
        //$filename = md5(uniqid());
        $ext = $pathinfo['extension'];

        if($this->allowedExtensions && !in_array(strtolower($ext), $this->allowedExtensions)){
            $these = implode(', ', $this->allowedExtensions);
            return array('error' => 'File has an invalid extension, it should be one of '. $these . '.');
        }

        if(!$replaceOldFile){
            /// don't overwrite previous files that were uploaded
            while (file_exists($uploadDirectory . $filename . '.' . $ext)) {
                $filename .= rand(10, 99);
            }
        }

        if ($this->file->save($uploadDirectory . $filename . '.' . $ext)){
            return array('success'=>true);
        } else {
            return array('error'=> 'Could not save uploaded file.' .
                'The upload was cancelled, or server error encountered');
        }

    }    
}

// list of valid extensions, ex. array("jpeg", "xml", "bmp")
$allowedExtensions = array();
// max file size in bytes
$sizeLimit = 10 * 1024 * 1024;

$uploader = new qqFileUploader($allowedExtensions, $sizeLimit);
$result = $uploader->handleUpload('uploads/');
// to pass data through iframe you will need to encode all html tags
echo htmlspecialchars(json_encode($result), ENT_NOQUOTES);

?>
<?php
if (!function_exists("GetSQLValueString")) {
function GetSQLValueString($theValue, $theType, $theDefinedValue = "", $theNotDefinedValue = "") 
{
  if (PHP_VERSION < 6) {
    $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue;
  }

  $theValue = function_exists("mysql_real_escape_string") ? mysql_real_escape_string($theValue) : mysql_escape_string($theValue);

  switch ($theType) {
    case "text":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;    
    case "long":
    case "int":
      $theValue = ($theValue != "") ? intval($theValue) : "NULL";
      break;
    case "double":
      $theValue = ($theValue != "") ? doubleval($theValue) : "NULL";
      break;
    case "date":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;
    case "defined":
      $theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue;
      break;
  }
  return $theValue;
}
}

$editFormAction = $_SERVER['PHP_SELF'];
if (isset($_SERVER['QUERY_STRING'])) {
  $editFormAction .= "?" . htmlentities($_SERVER['QUERY_STRING']);
}

  $updateSQL = sprintf("UPDATE filefolder SET file_title=%s, file_url=%s WHERE m_id=%s",
                       GetSQLValueString($row_Recordset1['m_id'], "text"),
                       GetSQLValueString($row_Recordset1['m_id'], "text"),
                       GetSQLValueString($row_Recordset1['m_id'], "int"));

  mysql_select_db($database_connSQL, $connSQL);
  $Result1 = mysql_query($updateSQL, $connSQL) or die(mysql_error());

mysql_select_db($database_connSQL, $connSQL);
$query_Recordset1 = "SELECT *, (filefolder.file_url) AS m_file FROM member INNER JOIN filefolder ON member.m_id = filefolder.m_id";
$Recordset1 = mysql_query($query_Recordset1, $connSQL) or die(mysql_error());
$row_Recordset1 = mysql_fetch_assoc($Recordset1);
$totalRows_Recordset1 = mysql_num_rows($Recordset1);
?>

<?php
mysql_free_result($Recordset1);
?> 
```

它上传成功，只是不存储。谁能指出我的问题或提供替代解决方案？

非常感谢您提前提供的帮助！

最好的，

-交流

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:22:31.053

我想你的查询失败了，因为你没有单引号你在 SQL 查询中插入的字符串值，试试这个：

```
UPDATE filefolder SET file_title='%s', file_url='%s' WHERE m_id=%s 
```

在对 SQL 查询进行故障排除时，它可以节省大量时间来简单地转储结果查询字符串并直接在 MySQL 中尝试以查看其是否损坏。MySQL 会给你很好的提示，告诉你可能出了什么问题。您还可以获取 mysql_error 信息以了解您遇到的 SQL 问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T21:03:01.540

在网上搜索了一段时间后，我找到了解决方案：

显然，在 valums 脚本中有两种上传方法，`qqUploadedFileXhr`如果`qqUploadedFileForm.`您使用示例脚本，则使用默认的一种：`qqUploadedFileXhr.`

因此，要获取文件信息，您可以使用： $file_name = $_GET['qqfile']; 就是这样，只是文件名。

但是，如果使用 'qqUploadedFileForm'，您可以获得文件信息： -`$_FILES['qqfile']['name']`文件名 -`$_FILES['qqfile']['size']`大小 - 等等

**全文在这里：**

```
$file_name = $_GET['qqfile'];
$uploader = new qqFileUploader($allowedExtensions, $sizeLimit);
$m_id = $row_RecUser['m_id'];
$file_type = $_REQUEST['param1'];

if (strcmp($file_type,'resume') == 0) {
$result = $uploader->handleUpload('uploader/files/resume'); }
else if (strcmp($file_type,'certificates') == 0) {
$result = $uploader->handleUpload('uploader/files/certificates/'); }

    $insertSQL = sprintf("INSERT INTO filefolder (m_id, file_type, file_title) VALUES (%s, %s, %s)",
                    GetSQLValueString($m_id, "int"),
                    GetSQLValueString($file_type, "text"),
                    GetSQLValueString($file_name, "text")); 
```

# css - 流体表单元格 div 中的额外空格

> ID：11677366
> 
> 赞同：-1
> 
> 时间：2012-07-26T20:18:11.243
> 
> 标签：css, layout, mobile, html

请看看我的小提琴。我试图在 32x32 图标旁边有一个输入字段。出于某种原因，我的 div 底部有一个空白区域。div 和图像都应该是 32x32px 我怀疑它是我的浏览器，但我无法弄清楚：

[http://jsfiddle.net/WbhgA/1/](http://jsfiddle.net/WbhgA/1/)

这就是我所看到的

[http://i.imgur.com/3C1eN.jpg](http://i.imgur.com/3C1eN.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:27:58.927

您在输入 div 上有 20px 的 padding-right

所以

```
.inputHolder {
   display:table-cell;
   width:100%;
   height:32px;
} 
```

在这里[摆弄 http://jsfiddle.net/WbhgA/13/](http://jsfiddle.net/WbhgA/13/)

更新：哦那个空间

你只需要垂直对齐它

```
.inputHolder {
   display:table-cell;
   width:100%;
   height:32px;
   border:1px solid red; 
   vertical-align: middle;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:29:55.040

试试这个 - [http://jsfiddle.net/WbhgA/15/](http://jsfiddle.net/WbhgA/15/)

```
.inputHolder {
    height: 32px;
    margin-right: 60px;            
}

.inputHolder input {
    border: 1px solid;
    border-radius: 6px;  
    width:100%;  
    height: 32px;
    line-height: 32px;
}

.icon {
    border: 1px solid red;
    border-radius: 6px;
    width: 32px;
    height: 32px;
    float: right;
    margin-top: -32px;
    background: transparent url(http://icons-search.com/img/fasticon/icomic_lnx.zip/icomic_lnx-icons-32X32-web.png-32x32.png);
} 
```

# c# - 如何使用循环计算 pi 到 C# 中的 N 个位置

> ID：11677369
> 
> 赞同：9
> 
> 时间：2012-07-26T20:18:25.767
> 
> 标签：c#, .net, algorithm, math, loops

我该如何在 C# 中将 PI 计算到一定的小数位？

我希望能够将一个数字传递给一个方法并取回计算到该小数位数的 PI。

```
public decimal CalculatePi(int places)
{
    // magic
    return pi;
}

Console.WriteLine(CalculatePi(5)); // Would print 3.14159

Console.WriteLine(CalculatePi(10)); // Would print 3.1415926535 
```

ETC...

我不在乎程序的速度。我只是希望它尽可能简单易懂。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-26T22:32:32.440

首先，假设您想要 pi 的任意位数，并且我们不希望受限于任何各种浮点数的精度，让我们将 Pi 函数定义为字符串而不是任何数字类型。

我在搜索这项技术时发现的最酷的算法之一是[Stanley Rabinowitz 和 Stan Wagon-Spigot 算法](http://www.mathpropress.com/stan/bibliography/spigot.pdf)。它不需要浮点数学，并且主要是一种迭代方法。它确实需要一些内存来在中间计算中存储整数数组。

无需花时间精简或清理代码，这里是算法的实现（注意结果不添加小数点）。

如果您打算将此代码用于个人用途以外的任何用途，请务必引用算法和本网站。

## C# 代码

```
public static string CalculatePi(int digits)
{   
    digits++;

    uint[] x = new uint[digits*10/3+2];
    uint[] r = new uint[digits*10/3+2];

    uint[] pi = new uint[digits];

    for (int j = 0; j < x.Length; j++)
        x[j] = 20;

    for (int i = 0; i < digits; i++)
    {
        uint carry = 0;
        for (int j = 0; j < x.Length; j++)
        {
            uint num = (uint)(x.Length - j - 1);
            uint dem = num * 2 + 1;

            x[j] += carry;

            uint q = x[j] / dem;
            r[j] = x[j] % dem;

            carry = q * num;
        }

        pi[i] = (x[x.Length-1] / 10);

        r[x.Length - 1] = x[x.Length - 1] % 10; ;

        for (int j = 0; j < x.Length; j++)
            x[j] = r[j] * 10;
    }

    var result = "";

    uint c = 0;

    for(int i = pi.Length - 1; i >=0; i--)
    {
        pi[i] += c;
        c = pi[i] / 10;

        result = (pi[i] % 10).ToString() + result;
    }

    return result;
} 
```

## 更新

我终于开始解决 35 位数字后发生的“进位错误”。实际上，链接文档的第 6 页专门讨论了这里发生的情况。我已经测试了 1000 位数的最终版本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-26T20:21:39.590

```
Math.Round(Math.PI, places) 
```

如果您需要更高的精度，您将无法使用双精度数据类型，因为它支持某个最大值。精度（由 Math.PI 提供）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-26T23:13:57.533

经过大量搜索，我发现了这个小片段：

```
public static class BigMath
{
    // digits = number of digits to calculate;
    // iterations = accuracy (higher the number the more accurate it will be and the longer it will take.)
    public static BigInteger GetPi(int digits, int iterations)
    {
        return 16 * ArcTan1OverX(5, digits).ElementAt(iterations)
            - 4 * ArcTan1OverX(239, digits).ElementAt(iterations);
    }

    //arctan(x) = x - x^3/3 + x^5/5 - x^7/7 + x^9/9 - ...
    public static IEnumerable<BigInteger> ArcTan1OverX(int x, int digits)
    {
        var mag = BigInteger.Pow(10, digits);
        var sum = BigInteger.Zero;
        bool sign = true;
        for (int i = 1; true; i += 2)
        {
            var cur = mag / (BigInteger.Pow(x, i) * i);
            if (sign)
            {
                sum += cur;
            }
            else
            {
                sum -= cur;
            }
            yield return sum;
            sign = !sign;
        }
    }
} 
```

到目前为止，它就像一个魅力。您只需从 GAC 添加 System.Numerics 库即可解析 BigInteger 类型。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-01-04T15:18:58.300

与 nicholas 相同的算法，但使用 yield 进行惰性求值

```
 static public IEnumerable<uint> Pi()
    {
        uint[] x = new uint[short.MaxValue];
        uint[] r = new uint[short.MaxValue];

        for (int j = 0; j < short.MaxValue; j++)
            x[j] = 20;

        for (int i = 0; i < short.MaxValue; i++)
        {
            uint carry = 0;
            for (int j = 0; j < x.Length; j++)
            {
                uint num = (uint)(x.Length - j - 1);
                uint dem = num * 2 + 1;

                x[j] += carry;

                uint q = x[j] / dem;
                r[j] = x[j] % dem;

                carry = q * num;
            }

            yield return (x[x.Length - 1] / 10);

            r[x.Length - 1] = x[x.Length - 1] % 10; ;
            for (int j = 0; j < x.Length; j++)
            {
                x[j] = r[j] * 10;
            }                    
        }
    } 
```

我使用 short.MaxValue 作为位置数的上限，但那是因为我的机器虚拟内存不足。更好的机器应该能够容纳最多 int.MaxValue。

该函数可以这样调用：

```
 class Program
{
    static void Main(string[] args)
    {
        foreach (uint digit in Calculator.Pi().Take(100))
        {
            Console.WriteLine(digit);
        }

        Console.Read();
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-26T20:41:00.093

如果你对原生数学库提供的位数感到满意，那很简单；只需四舍五入到所需的位数。如果您需要更多数字（数十、数百或数千），则需要一种每次吐出一个数字的插口算法。Jeremy Gibbons 给出了一个[算法](http://web.comlab.ox.ac.uk/people/Jeremy.Gibbons/publications/spigot.pdf)，我在我的博客中[实现](http://programmingpraxis.com/2009/02/20/the-digits-of-pi/) [了两次](http://programmingpraxis.com/2012/06/19/digits-of-e/)，在那里你可以找到用 Scheme、C、Python、Haskell、Perl 和 Forth 编写的代码（但不是 C#，抱歉）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-26T21:53:56.457

最简单的方法是将大量数字 pi 存储在字符串常量中。然后，每当您需要`n`精确的数字时，您只需从 0 到`n+2`.

# c# - Deserialize String Array using Newtonsoft's JSON

> ID：11677371
> 
> 赞同：0
> 
> 时间：2012-07-26T20:18:34.083
> 
> 标签：c#, json, windows-phone-7, json.net

I am attempting to deserialize the prices data from the foursquare Menu's API. However, no matter what I try I get a null value in place of the price.

The data I am trying to parse looks like this:

```
"prices": [
    "(single) $5.00",
    "(double) $9.00"
] 
```

I have tried code such as:

```
[JsonProperty("prices")]
public List<string> Prices { get; set; } 
```

as well as a variety of other's including replacing List[string] with string and List[string] with a List[ProductPrice] that contained a string. None of these attempts worked.

Does anyone have any clue what I'm doing wrong?

Note: The rest of my code works and the menu is deserialized correctly except for the prices so it is not a problem with my web request etc.

# neo4j - 如何检索由关系链接的所有节点

> ID：11677375
> 
> 赞同：1
> 
> 时间：2012-07-26T20:18:46.183
> 
> 标签：neo4j

我正在使用 neo4j，我有两个属性的节点：名称和 id。我有一个关于 id 的索引。我与属性“CALL”有关系：“by_test”。此属性可以采用不同的值（任何节点的 id）。

**两个节点可以有多个**具有不同 by_test 属性值的 CALL 关系。

因此，假设我有 1..N 个由相同 CALL.by_test 属性值链接的节点。

节点 1 -> 节点 2 -> 节点 3 -> .. -> 节点 N

*   我怎样才能得到所有这些节点？

    1.  我需要在关系上放置索引吗？

    2.  我必须创建动态关系吗？而不是 CALL.by_test=value，使用 value 有关系。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T13:54:14.073

使用 Cypher，您可以像这样查询该列表：

```
START n=node:node_auto_index(name="one") 
MATCH p=(n)-[r:CALL*1..]->(m)
WHERE ALL(x in r WHERE x.by_test = 3)
RETURN n,m 
```

在`MATCH`您将术语绑定`r`到`CALL`关系中，然后在`WHERE`子句中使用它来检查`by_test`每个关系的属性。

正如 Michael Hunger 所指出的，`r`是关系的集合，因此`WHERE`需要使用`ALL`来检查每个关系。

# database - failure - test failed: the network adapter could not establish the connection

> ID：11677378
> 
> 赞同：2
> 
> 时间：2012-07-26T20:19:10.277
> 
> 标签：database, oracle, oracle-sqldeveloper

I installed oracle 11g in my machine and created tablespaces and user. Evereything ran succesfully. Now im trying to create a new conenction thru sqlDeveloper but i get this error. I checked the SID name and changed them according to tnsnames.ora. what else might go wrong?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T10:05:47.707

使用基本连接类型，连接名称中不要使用连字符“-”，而使用下划线“_”。然后再次尝试连接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T08:23:55.560

不要使用 tnsnames.ora 并将连接类型设置为“基本”。相应地输入您的连接详细信息（SID、端口、主机、用户名和密码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-07T17:56:44.057

如果数据库在您的机器上，而您仍在谈论 11g，那么您可以简单地执行以下操作：

[![在此处输入图像描述](../Images/fc716a55267796899ff73b6119a2550a.png)](https://i.stack.imgur.com/geDOg.png)

连接类型：基本主机名：localhost（您说数据库在您的机器上，是吗？）端口：1521（这是默认值，除非您更改它） SID：orcl 用于常规数据库或 xe 用于 Express 版本服务名称：使用此if 12c 带有可插拔数据库

或者用户名和密码的课程： 用户名：系统（默认的 ADMIN 帐户，比 SYS 危险性低） 密码：创建数据库时提供的任何内容

如果要以 SYS 身份登录，则必须将角色从默认更改为 SYSDBA。

如果您有 TNSNames.ora 文件，我们应该会找到它，您可以将连接类型设置为 TNS，然后从下拉列表中选择您的数据库。

[![在此处输入图像描述](../Images/dcb0adea061f5a37716d898184b0c2e7.png)](https://i.stack.imgur.com/HRfft.png)

可以想象，当您有许多数据库时，TNS 路径要容易得多，但您需要维护此文件。否则，Basic 是最简单的方法。

# javascript - 页面加载后是否可以取消 body onunload 操作？

> ID：11677386
> 
> 赞同：2
> 
> 时间：2012-07-26T20:19:39.137
> 
> 标签：javascript, jquery

所以我有一个页面，其正文标签中包含以下内容：

在 iframe 中...

```
<body onunload="parent.foobar();"> 
```

...

是否有可能在页面的后面，我构建了一个这样的点击功能：

```
<a href="#" onclick="NoFooBar();"> Do not run foobar if this page is unloaded </a>

<script> 
```

在父页面...

```
function NoFooBar()
{
$("#ifrm").contents().find('body').removeAttr("onunload");
}

</script> 
```

这似乎不起作用？是否可以稍后更改 body 属性并期望它相应地采取行动？或者它已被缓存并且将始终遵循初始设置？

有没有办法以其他方式实现我期望发生的事情？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:21:56.670

你应该试试`document.body.onunload = null;`。

# instance - iOS access a single instance of an object from two different classes

> ID：11677387
> 
> 赞同：0
> 
> 时间：2012-07-26T20:19:51.860
> 
> 标签：instance, nsobject, nsinputstream

Is it possible to create an instance of an object in class A and access that same instance of the object from class B? I am trying to develop an app that creates a TCP Socket using NSInputStream and NSOutputStream and need more than one class to be able to access it.

Thank you, Travis Elliott

**edit**

Here is the code I am working with. Its a program that deals with socket connections. I basically need to be able to communicate to the same socket from my appDelegate and View controller. Here is the code I have based on your help. I am using the appDelegate as the control(D in your example), perhaps I cannot do this. CommunicationHub is the class I need to control the same instance of from both AppDelegate and ViewController.

AppDelegate.h

```
#import <UIKit/UIKit.h>
#import "ViewController.h"
#import "CommunicationHub.h"

@interface AppDelegate : UIResponder <UIApplicationDelegate>{

ViewController *viewController;
CommunicationHub *cHub;
}

@property (strong, nonatomic) UIWindow *window;
@property (strong, retain) ViewController *viewController;
@property (strong, retain) CommunicationHub *cHub;

-(void)CreateInstances;

@end 
```

AppDelegate.m

```
#import "AppDelegate.h"
#import "ViewController.h"

@implementation AppDelegate
@synthesize viewController;
@synthesize cHub;

@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [self CreateInstances];
    // Override point for customization after application launch.
    return YES;
}

-(void)CreateInstances{
    NSLog(@"Inside CreateInstances");
    CommunicationHub *cHub = [[CommunicationHub alloc] init];
    viewController = [[ViewController alloc] init];
    [viewController initWithcHub:cHub];
    NSLog(@"ID of cHub in AppDelegate is %i", cHub);

}

- (void)applicationWillResignActive:(UIApplication *)application
{
    NSLog(@"Application Will Resign Active");
    [cHub disconnect];
}

@end 
```

ViewController.h

```
#import <UIKit/UIKit.h> 
#import "CommunicationHub.h"

@interface ViewController : UIViewController 
{
    CommunicationHub *cHub;
}

@property (strong, nonatomic) IBOutlet UITextField *IPAddress;
@property (strong, nonatomic) IBOutlet UITextField *PortNumber;
- (IBAction)goAwayKeyBoard:(id)sender;
- (IBAction)touchBackground:(id)sender;
-(void) initWithcHub:(CommunicationHub *)ptr;
- (IBAction)connectSocket:(id)sender;
- (IBAction)disconnectSocket:(id)sender;

@end 
```

ViewController.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize IPAddress;
@synthesize PortNumber;

-(void) initWithcHub:(CommunicationHub *)ptr
{
    cHub = [[ptr retain]init];
    NSLog(@"id of cHub in ViewController is %i", cHub);
}

- (IBAction)connectSocket:(id)sender 
{
    //Called by button on UI.
    int portNumber = [PortNumber.text intValue];

    [cHub Connect:(int *)portNumber ipAddress:(IPAddress.text)];
}

- (IBAction)disconnectSocket:(id)sender 
{
    //Called by button on UI.
    [cHub disconnect];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [self setIPAddress:nil];
    [self setPortNumber:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
    } else {
        return YES;
    }
}

-(IBAction)goAwayKeyBoard:(id)sender{

    [self resignFirstResponder];
}

- (IBAction)touchBackground:(id)sender {
    [IPAddress resignFirstResponder];
    [PortNumber resignFirstResponder];
}

@end 
```

CommunicationHub.h

```
#import <UIKit/UIKit.h>

NSInputStream *inputStream;
NSOutputStream *outputStream;

@interface CommunicationHub : NSObject <NSStreamDelegate>

- (void)Connect:(int *)port ipAddress:(NSString *)ipAddress;
- (void) disconnect;

@end 
```

CommunicationHub.m

```
#import "CommunicationHub.h"

@implementation CommunicationHub

- (void)Connect:(int *)port ipAddress:(NSString *)ipAddress 
{
    NSLog(@"inside connect method");

    if ([inputStream streamStatus] == 0 ||[inputStream streamStatus] ==  5 ||[inputStream streamStatus] == 6 ||[inputStream streamStatus] == 7) 
    {
        NSString *myString = ipAddress;
        CFStringRef *myCFString = (__bridge CFStringRef)myString;
        CFReadStreamRef readStream;
        CFWriteStreamRef writeStream;
        CFStreamCreatePairWithSocketToHost(NULL, myCFString, port, &readStream, &writeStream);
        inputStream = (__bridge NSInputStream *)readStream;
        outputStream = (__bridge NSOutputStream *)writeStream;
        [inputStream setDelegate:self];
        [outputStream setDelegate:self];

        [inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
        [outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
        [inputStream open];
        [outputStream open];
    }
}

- (void) disconnect
{
    NSLog(@"inside disconnect method");

    if (inputStream != nil) {
        if ([inputStream streamStatus] == 2) {
            NSLog(@"Disconnecting Streams");
            [inputStream close];
            [outputStream close];
        }else {
            NSLog(@"Stream is not Open");
            int status = [inputStream streamStatus];
            NSLog(@"Stream Status is %i", status);
        }

    }else {
        NSLog(@"Input Stream equals Nil");
    }

}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:28:20.070

长话短说：假设你有 A、B 和 C 类。

C 需要可从 A 和 B 访问。现在，假设我们有控制器 D，它实例化 A 和 B。让 D 先实例化 C，并将其存储在变量中。

```
C *C_Class = [[[C alloc] init] autorelease]; 
```

接下来，用 C 实例化 A 和 B（我在这里假设“保留属性”）

```
self.A_Class = [[[A alloc] initWithC:C_Class] autorelease];
self.B_Class = [[[B alloc] initWithC:C_Class] autorelease]; 
```

在这两个类中，您都需要实例方法：

```
- (id)initWithC:(C *)C_Class; 
```

在 .m 文件中：

```
- (id)initWithC:(C *)C_Class {
    C_C = [C_Class retain]; //Assuming a regular instance variable
}

- (void) dealloc {
    [C_C release];  //All that is retained, must be released.
} 
```

从这一刻起，您可以通过名称“C_C”访问 A 类和 B 类中 C 类的一个实例。

现在，请注意，这只是我脑后写的，容易出错，但应该没问题。

我希望它有帮助:)

编辑：由于 OP 似乎对这些代码片段有问题，我将添加更完整的代码。

让我们从控制类“D”开始。

DH：

```
#import "A.h"
#import "B.h"

@interface D : NSObject

-(void)CreateInstances;

@property (strong, retain) A *A_Class;
@property (strong, retain) B *B_Class;

@end 
```

米：

```
#import "D.h"
#import "C.h"

@implementation D

-(void)CreateInstances {
    C *C_Class = [[C alloc] init] autorelease];
    self.A_Class = [[[A alloc] initWithC:C_Class] autorelease];
    self.B_Class = [[[B alloc] initWithC:C_Class] autorelease];
}

@end 
```

啊（Bh 反映了这种行为，也许可以考虑对两者都使用超类）

```
#import "C.h"

@interface A : NSObject {
    C *C_Class;           //Class Reference to the C-Object
}

-(id) initWithC:(C *)ptr; //Initialization method, which takes a 'C'-Object.

@end; 
```

是

```
#import "A.h"

@implementation A

- (id) initWithC:(C *)ptr {
    C_Class = [ptr retain]; //So the object doesn't get released prematurely.
}

- (void) dealloc {
    [C_Class release];      //To avoid memory leaks.
}

@end 
```

现在，请记住，我是在脑海中写下这个并没有通过编译器运行它，但它应该可以工作，保存拼写错误等。

另一个编辑：在 OP 添加他自己的代码后，我将在此处发布相关的“更正”代码。

AppDelegate.m

```
-(void)CreateInstances{
    NSLog(@"Inside CreateInstances");
    cHub = [[CommunicationHub alloc] init]; //We're using the instance variable. Not the local one.
    viewController = [[ViewController alloc] initWithcHub:cHub];
    //[viewController initWithcHub:cHub];  //You may want to rethink your function names.
    NSLog(@"ID of cHub in AppDelegate is %i", cHub);
} 
```

视图控制器.m

```
//If a method names STARTS with 'init', it SHOULD initialize the object.
-(id) initWithcHub:(CommunicationHub *)ptr
{
    self = [super init];     //Calls the 'init' from the parent class.
    if(self) {
        cHub = [ptr retain]; //Just retain. After all, the object IS initialized already.
        NSLog(@"id of cHub in ViewController is %i", cHub);
    }
    return self;
}

- (void) dealloc {
    [cHub release]; //Basic rule of memory management: ALL that is retained, must be released. In dealloc, at latest.
}

- (IBAction)connectSocket:(id)sender 
{
    //Called by button on UI.
    //Do not pass a pointer to anything, unless you mean to use a pointer.
    [cHub Connect:[PortNumber.text intValue] ipAddress:(IPAddress.text)];
} 
```

其余的应该是正确的，或者至少不是这个问题的主题。

# jquery - jquery从.each（）循环中计算第一级元素

> ID：11677392
> 
> 赞同：0
> 
> 时间：2012-07-26T20:20:15.950
> 
> 标签：jquery, each

有谁知道如何从 .each() 循环中计算元素的第一级子级？

例如，我的页面上有几个列表，就像这样......

```
<ul>
    <li><a href="#">item1</a></li>
    <li><a href="#">item2</a></li>
    <li><a href="#">item3</a></li>
    <li><a href="#">item4</a></li>
</ul>
<ul>
    <li><a href="#">item1</a></li>
    <li><a href="#">item2</a></li>
    <li><a href="#">item3</a></li>
    <li><a href="#">item4</a></li>
    <li><a href="#">item5</a></li>
    <li><a href="#">item6</a></li>
</ul>
<ul>
    <li><a href="#">item1</a></li>
    <li><a href="#">item2</a></li>
    <li><a href="#">item3</a></li>
</ul> 
```

我试图遍历每个列表并确定它有多少列表项，除了使用 jQuery .size() 也将标签计为元素。我只需要知道存在多少列表项。

此外，我不确定如何执行此操作，因为无法从 .each() 循环中访问 jQuery('ul > li').size() 之类的东西，因为我使用 jQuery(这）。有没有办法做类似 jQuery(this ' > li') 的事情？因为那对我也不起作用:)

这是我一直在尝试的，但我没有任何运气：

```
jQuery('ul').each(function() {
    var count = jQuery(this).find('li').size();
    alert(count);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:23:19.303

你可以使用[`length`](http://api.jquery.com/length/)属性：

```
$('ul').each(function() {
    var count = $(this).find('li').length;
    alert(count);
}); 
```

或者如果你想选择直接子 li 标签，你可以尝试：

```
$('ul').each(function() {
    var count = $('> li', this).length;
    alert(count);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:26:11.633

'>'[立即子选择器](http://api.jquery.com/child-selector/)

您可以在使用`$('> li')`时使用`$(this).find()`或交替使用，

```
$('ul').each(function(){
  var length = $('>li', this).length;
  alert(length);
  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-21T10:53:03.653

试试这个。我觉得好多了。

```
var rt = 0;
$('ul').each(function() {
    rt++;    
});

alert(rt); 
```

# mysql - MySQL 使用不相关的表数据更新列

> ID：11677393
> 
> 赞同：0
> 
> 时间：2012-07-26T20:20:16.777
> 
> 标签：mysql, sql

我在mysql中有两个这样的表

```
a.cardnumber (unique)
a.position (numerical 3 digits or null)
a.serial

b.serial (unique)
b.lastused 
```

我想更新“a”中位置高于 600 且“a.serial”为空白的任何行，其中“b.serial”中的“b.lastused”为空或超过 30 天前的任何序列。当序列被复制到“a.serial”时，我想用今天的日期更新“b.lastused”，所以我知道今天已经使用了相关的“b.serial”。

除了序列号之外，这两个表没有任何关系，b 中的任何序列都可以与 a 中的任何卡号一起使用。

我已经使用我对 mysql 的有限知识进行了尝试，但是我的 mysql 桌面程序不断收到错误消息，说我的查询中有错误:(

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T22:21:11.693

我在这里假设您希望对`b.serial`要更新的每一行使用单独的`a`. （这没有具体说明，但在我看来最有可能；如果它是错误的，请随时纠正我的假设。）

我设置了一个小例子。不清楚每列的数据类型是什么，所以我在不确定的地方使用了 INT。我使用 DATE 数据类型（而不是 DATETIME）作为 lastused。

```
CREATE TABLE a (`cardnumber` VARCHAR(10) NOT NULL PRIMARY KEY, `position` INT, `serial` INT);
CREATE TABLE b (`serial` INT NOT NULL PRIMARY KEY, lastused DATE);
INSERT INTO a VALUES ('x0000',555,NULL),('x0001',700,123),('a1111',601,NULL),('a2222',602,NULL);
INSERT INTO b VALUES (100,'2012-07-15'),(101,NULL),(102,'2010-01-01'),(103,NULL),(104,NULL);
SELECT * FROM a;
SELECT * FROM b; 
```

根据您提供的条件，卡号为“a1111”和“a2222”的行应更新，其他两行不应更新（位置 <= 600，序列已分配）。

在我们运行 UPDATE 之前，我们希望首先运行一个 SELECT，它返回要更新的行以及将分配的值。一旦我们得到它，我们就可以将其转换为多表 UPDATE 语句。

```
SELECT a.cardnumber AS `a.cardnumber`
     , a.position   AS `a.position`
     , a.serial     AS `a.serial`
     , b.serial     AS `b.serial`
     , b.lastused   AS `b.lastused`
  FROM (
         SELECT @i := @i + 1 AS i
              , aa.*
           FROM a aa
           JOIN (SELECT @i := 0) ii
          WHERE aa.position > 600   /* assuming `position` is numeric datatype */
            AND aa.serial IS NULL   /* assuming 'blank' represented by NULL    */
          ORDER BY aa.cardnumber
       ) ia
  JOIN (
         SELECT @j := @j + 1 AS j
              , bb.serial
              , bb.lastused
           FROM b bb
           JOIN (SELECT @j := 0) jj
          WHERE bb.lastused IS NULL 
             OR bb.lastused < DATE_ADD(NOW(),INTERVAL -30 DAY)
          ORDER BY bb.serial
       ) jb
    ON ia.i = jb.j
  JOIN a ON a.cardnumber = ia.cardnumber
  JOIN b ON b.serial = jb.serial 
```

要将其转换为 UPDATE，请将其替换为`SELECT ... FROM`，`UPDATE`并添加一个`SET`子句以将新值分配给表。

```
UPDATE (
         SELECT @i := @i + 1 AS i
              , aa.*
           FROM a aa
           JOIN (SELECT @i := 0) ii
          WHERE aa.position > 600
            AND aa.serial IS NULL
          ORDER BY aa.cardnumber
       ) ia
  JOIN (
         SELECT @j := @j + 1 AS j
              , bb.serial
              , bb.lastused
           FROM b bb
           JOIN (SELECT @j := 0) jj
          WHERE bb.lastused IS NULL 
             OR bb.lastused < DATE_ADD(NOW(),INTERVAL -30 DAY)
          ORDER BY bb.serial
       ) jb
    ON ia.i = jb.j 
  JOIN a ON a.cardnumber = ia.cardnumber
  JOIN b ON b.serial = jb.serial
   SET a.serial = b.serial
     , b.lastused = DATE(NOW())

-- 4 row(s) affected 
```

您可以单独运行内联视图的查询（ia、jb），以验证这些查询是否正在获取您要更新的行。

从 ia 到 a 以及从 jb 到 b 的连接应该在主键唯一键上。

ia 和 jb 内联视图的目的是获取分配给这些行的序列号，以便我们可以将它们相互匹配。

连接到`a`和`b`是返回到原始表中的行，这就是我们想要更新的内容。

`serial`（显然，如果不是 INT，或者`lastused`是 DATETIME 而不是 DATE ，则需要进行一些调整。）

但这是我将如何进行您想要执行的 UPDATE 的一个示例（据我所知）。

* * *

**注意：**此方法适用于支持子查询的 MySQL 版本。对于 MySQL 4.0，您需要分步运行，将“ia”和“jb”内联视图（子查询）的结果存储到实际表中。然后在查询中引用这些表来代替内联视图。可以删除 ii 和 jj 子查询，并`SELECT @i := 0, @j := 0`在执行引用这些变量的查询之前用单独的语句替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:31:31.077

让我知道这个是否奏效

```
Update table_a
set serial = 
(
    select b.serial from table_b b
    where b.lastused = NULL 
    OR b.lastused < (current date - 30) limit 1
)
where cardnumber in 
(
select a.cardnumber
from table_a a
where a.position > 600
and a.serial = NULL
)

update table_b b
set b.lastused = current date
where b.lastused = NULL 
      OR b.lastused < (current date - 30) 
```

# java - Read part of a JSON String using Jackson

> ID：11677395
> 
> 赞同：24
> 
> 时间：2012-07-26T20:20:36.950
> 
> 标签：java, json, jackson

The JSON string is as follows

```
{
   "rank":"-text_relevance",
   "match-expr":"(label 'star wars')",
   "hits":{
      "found":7,
      "start":0,
      "hit":[
         {"id":"tt1185834",
             "data":{
                "actor":["Abercrombie, Ian","Baker, Dee","Burton, Corey"],
                "title":["Star Wars: The Clone Wars"]
             }
         },
         .
         .
         .
         {"id":"tt0121766",
             "data":{
                "actor":["Bai, Ling","Bryant, Gene","Castle-Hughes, Keisha"],
                "title":["Star Wars: Episode III - Revenge of the Sith"]
             }
         }
       ]
    },
    "info":{
       "rid":"b7c167f6c2da6d93531b9a7b314ad030b3a74803b4b7797edb905ba5a6a08",
       "time-ms":2,
       "cpu-time-ms":0
    }
    } 
```

It has many fields, but I just have want the Data field. This won't work:

```
mapper.readvalue(jsonString,Data.class); 
```

How do I make Jackson read just the "Data" field?

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2015-07-30T23:08:57.463

Jackson 2.3 现在有一个可以使用的 JsonPointer 类。[他们的发布快速概述](http://www.cowtowncoder.com/blog/archives/2013/11/entry_483.html)中有一个简单的示例。

> 用法很简单：对于 JSON 之类的
> 
> ```
> {
>     "address" : { "street" : "2940 5th Ave", "zip" : 980021 },   
>     "dimensions" : [ 10.0, 20.0, 15.0 ] 
> } 
> ```
> 
> 您可以使用以下表达式：
> 
> ```
>  JsonNode root = mapper.readTree(src); 
>   int zip =root.at("/address/zip").asIntValue(); 
>   double height = root.add("/dimensions/1").asDoubleValue();// assuming it's the second number in there 
> ```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-26T21:08:55.937

我认为最简单的方法是使用 Jackson [TreeModel](http://wiki.fasterxml.com/JacksonTreeModel)：假设对数据结构有一定了解，让 Jackson 将 JSON 输入解析为[`JsonNode`](http://jackson.codehaus.org/1.3.4/javadoc/org/codehaus/jackson/JsonNode.html)您然后查询的对象。通过这种方式，您可以忽略大部分数据，向下查找`JsonNodes`您想要的数据。

```
// String input = The JSON data from your question
ObjectMapper mapper = new ObjectMapper();

JsonNode rootNode = mapper.readValue(input.getBytes(), JsonNode.class); 

// can also use ArrayNode here, but JsonNode allows us to get(index) line an array:
JsonNode hits = rootNode.get("hits");

// can also use ObjectNodes here:
JsonNode oneHit = null;
JsonNode dataObj = null;

int idx = 0;

Data data = null;

if (hits != null)
{
    hits = hits.get("hit");

    if (hits != null)
    {
        while ((oneHit = hits.get(idx)) != null)
        {
            dataObj = oneHit.get("data");
            System.out.println("Data[" + idx + "]: " + dataObj);
            idx++;
        }
    }
} 
```

输出：

```
 Data[0]: {"id":"tt1185834","data":{"actor":["Abercrombie, Ian","Baker, Dee","Burton, Corey"],"title":["Star Wars: The Clone Wars"]}}
 Data[1]: {"id":"tt0121766","data":{"actor":["Bai, Ling","Bryant, Gene","Castle-Hughes, Keisha"],"title":["Star Wars: Episode III - Revenge of the Sith"]}} 
```

您仍然可以使用您的`Data`类实现，但我相信这将需要获取`String`每个代表`data`- 如上依赖`toString`或使用`JsonNode.getText()`- 并使用重新解析它`ObjectMapper`：

```
mapper.readValue(dataArray, Data.class)); 
```

另一种方法是使用杰克逊流模型，并自己拦截节点，直到您看到标记每个`data`元素开始的输入部分，然后使用字符串并调用`objectMapper.readValue`每个字符串的内容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-27T00:06:49.943

对于这种要求，Json-path 可能是一个很好的选择 - 如果您对 Jackson 以外的解决方案没问题，那就是：[http ://code.google.com/p/json-path/](http://code.google.com/p/json-path/)

# jquery - Jquery Ajax，“SyntaxError: invalid object initializer” with dataTable & “posting” data

> ID：11677397
> 
> 赞同：0
> 
> 时间：2012-07-26T20:20:43.990
> 
> 标签：jquery, ajax, datatable

我认为这很简单，但对错误有点困惑，因为我使用 dataTables 请求使用 Ajax 函数的方式。Jquery，带有Ajax POST 功能的Tabledata。

作品：

```
$('#example').dataTable( {
        "sDom": 'T<"clear">lfrtip',
        "oTableTools": {
            "sSwfPath": "DataTables-1.9.2/extras/TableTools/media/swf/copy_csv_xls_pdf.swf"
        },
    "sAjaxSource": "rquery_v1.php",
    "fnServerData": function ( sSource, aoData, fnCallback ) {
        $.ajax( {
            "dataType": 'json', 
            "type": "POST", 
            "url": sSource, 
            "data": aoData,
            "success": fnCallback
        } );
    }
} ); 
```

当我尝试传递一个附加字段“qid”时，它失败了

失败：

```
$('#example').dataTable( {
        "sDom": 'T<"clear">lfrtip',
        "oTableTools": {
            "sSwfPath": "DataTables-1.9.2/extras/TableTools/media/swf/copy_csv_xls_pdf.swf"
        },
    "sAjaxSource": "rquery_v1.php",
    "fnServerData": function ( sSource, aoData, fnCallback ) {
        $.ajax( {
            "dataType": 'json', 
            "type": "POST", 
            "url": sSource, 
            "data": { aoData, qid: 1 },
            "success": fnCallback
        } );
    }
} ); 
```

它是/被要求在“数据”周围加上引号，所以这有点令人困惑。但它因“SyntaxError：无效的对象初始化程序”而失败

谢谢，这是一个简单的问题，因为它是语法。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:37:13.850

您需要一个`aoData`参数的密钥，例如

```
'data':{myCoolArray:aoData, qid:1} 
```

...这为您的 aoData 数组提供了一个名称`myCoolArray`，您可以通过该名称在服务器上访问它。

干杯

# python - Python，lxml - 访问文本

> ID：11677411
> 
> 赞同：3
> 
> 时间：2012-07-26T20:21:19.220
> 
> 标签：python, text, html-parsing, lxml

我目前有点没有想法，我真的希望你能给我一个提示：最好用一小段示例代码来解释我的问题：

```
from lxml import etree
from io import StringIO

testStr = "<b>text0<i>text1</i><ul><li>item1</li><li>item2</li></ul>text2<b/><b>sib</b>"
parser = etree.HTMLParser()
# generate html tree
htmlTree   = etree.parse(StringIO(testStr), parser)
print(etree.tostring(htmlTree, pretty_print=True).decode("utf-8"))
bElem = htmlTree.getroot().find("body/b") 
print(".text only contains the first part: "+bElem.text+ " (which makes sense in some way)")
for text in bElem.itertext():
    print(text) 
```

**输出：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
  <body>
    <b>text0<i>text1</i><ul><li>item1</li><li>item2</li></ul>text2<b/><b>sib</b></b>
  </body>
</html>

.text only contains the first part: text0 (which makes sense in some way)
text0
text1
item1
item2
text2
sib 
```

**我的问题：**

我想`"text2"`直接访问，或获取所有文本部分的列表，仅包括可以在父标签中找到的部分。到目前为止，我只发现`itertext()`，它确实显示`"text2"`。

有没有其他方法可以检索`"text2"`？

现在你可能会问我为什么需要这个：基本上`itertext()`已经在做我想做的事了：

*   创建一个列表，其中包含在元素的子元素中找到的所有文本
*   但是，我想处理使用不同函数遇到的表和列表（随后创建这样的列表结构：`["text0 text1",["item1","item2"],"text2"]`或表（1\. 1 列的行，2\. 2 列的行）`["1\. row, 1 col",["2\. row, 1\. col","2\. row, 2. col"]]`：）

也许我采取了完全错误的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T21:37:47.413

如有必要，您可以重新实现`itertext()`函数并插入特殊处理程序：`ul``table`

```
from lxml import html

def itertext(root, handlers=dict(ul=lambda el: (list(el.itertext()),
                                                el.tail))):
    if root.text:
        yield root.text
    for el in root:
        yield from handlers.get(el.tag, itertext)(el)
    if root.tail:
        yield root.tail

print(list(itertext(html.fromstring(
                "<b>text0<i>text1</i><ul><li>item1</li>"
                "<li>item2</li></ul>text2<b/><b>sib</b>")))) 
```

### 输出

```
['text0', 'text1', ['item1', 'item2'], 'text2', 'sib'] 
```

注意：`yield from X`可以替换为`for x in X: yield x`早于 Python 3.3 的版本。

要连接相邻的字符串：

```
def joinadj(iterable, join=' '.join):
    adj = []
    for item in iterable:
        if isinstance(item, str):
            adj.append(item) # save for later
        else:
            if adj: # yield items accumulated so far
                yield join(adj)
                del adj[:] # remove yielded items
            yield item # not a string, yield as is

    if adj: # yield the rest
        yield join(adj)

print(list(joinadj(itertext(html.fromstring(
                "<b>text0<i>text1</i><ul><li>item1</li>"
                "<li>item2</li></ul>text2<b/><b>sib</b>"))))) 
```

### 输出

```
['text0 text1', ['item1', 'item2'], 'text2 sib'] 
```

要允许表，`<ul>`处理程序中的嵌套列表应`itertext()`递归调用：

```
def ul_handler(el):
    yield list(itertext(el, with_tail=False))
    if el.tail:
        yield el.tail

def itertext(root, handlers=dict(ul=ul_handler), with_tail=True):
    if root.text:
        yield root.text
    for el in root:
        yield from handlers.get(el.tag, itertext)(el)
    if with_tail and root.tail:
        yield root.tail

print(list(joinadj(itertext(html.fromstring(
                    "<b>text0<i>text1</i><ul><li>item1</li>"
                    "<li>item2<ul><li>sub1<li>sub2</li></ul></ul>"
                    "text2<b/><b>sib</b>"))))) 
```

### 输出

```
['text0 text1', ['item1', 'item2', ['sub1', 'sub2']], 'text2 sib'] 
```

# javascript - Raphael JS PieChart 选择部分

> ID：11677416
> 
> 赞同：0
> 
> 时间：2012-07-26T20:21:45.510
> 
> 标签：javascript, html, css, raphael

我已经使用 JS 库 Raphael 创建了一个饼图。我想为每个扇区分配一些文本，以便当您将鼠标悬停在特定部分上时，我可以在圆圈中间显示文本。所以首先我需要选择圆的特定部分并将其分配为变量并向其添加文本。谁能帮我弄清楚如何选择圆圈中的第一部分？

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>g·Raphaël Dynamic Pie Chart</title>
        <link rel="stylesheet" href="demo.css" media="screen">
        <link rel="stylesheet" href="demo-print.css" media="print">
        <script src="raphael.js"></script>
        <script src="g.raphael.js"></script>
        <script src="g.pie.js"></script>

        <style type="text/css">

        body {
    background: #fff;
    font: 100.01% "Fontin Sans", Fontin-Sans, "Myriad Pro", "Lucida Grande", "Lucida Sans Unicode", Lucida, Verdana, Helvetica, sans-serif;
    color: #000;
    margin: 10px 0 0 0;
    padding: 0;
    text-align: center;
}

#holder {
    margin: 0 auto;
    width: 640px;
    height: 480px;
}

p {
    text-align: left;
    margin: .5em 2em;
}

        </style>

        <script>
        //BUG FOUND if the user scrolls over where the original sector would be and keeps going in and out of the original region
        //the sector keeps getting bigger and bigger....it is tougher to do with a smaller animation time

            window.onload = function () {
                //creates raphael canvas located at the specified id
                var r = Raphael("holder"),
                    //creates piechart in raphael (x, y, radius) [  amounts which are distributed according to sum ]  ??legend?? ??href??
                    pie = r.piechart(320, 240, 100, [70,20,5,5], { legend: ["%%.%% - Enterprise Users", "IE Users"], legendpos: "southeast", href: ["http://raphaeljs.com", "http://g.raphaeljs.com"]});

                    //inner circle
                    innner = r.circle(320,240, 60).attr("fill", "red");
                    //invisible circle for text
                    innertext = r.circle(320,240,60).attr({"fill-opacity":"0"});

                //writes text at specified location
                r.text(320, 100, "Interactive Pie Chart").attr({ font: "20px sans-serif" });
                pie.hover(function () {
                    //if the user tries hovering over while the animation is finishing up in the specified time for the
                    //animation to last the user will not get the desired effect.  this says that the animation is over
                    //once the function is called again
                    this.sector.stop();
                    //describes how big the sector will be when hovered over
                    this.sector.scale(1.1, 1.1, this.cx, this.cy);

                    //does the same as above telling the legends to stop and what to do during animation
                    if (this.label) {
                        this.label[0].stop();
                        this.label[0].attr({ r: 7.5 });
                        this.label[1].attr({ "font-weight": 800 });
                    }
                }, function () {
                    //tells the selected sector to animate at the given speed and animation type
                    this.sector.animate({ transform: 's1 1 ' + this.cx + ' ' + this.cy }, 500, "bounce");

                    //creates the labesls in the legend and describes how they will be animated
                    if (this.label) {
                        this.label[0].animate({ r: 5 }, 500, "linear");
                        this.label[1].attr({ "font-weight": 400 });
                    }
                });
            };
        </script>
    </head>
    <body class="raphael" id="g.raphael.dmitry.baranovskiy.com">
        <div id="holder"></div>
        <p>
            Pie chart with legend, hyperlinks on two first sectors and hover effect.
        </p>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:10:16.890

没关系，我在这篇文章中找到了我正在寻找的答案......

[Raphael JS Pie：将 ID 添加到路径切片](https://stackoverflow.com/questions/5789832/raphael-js-pie-add-id-to-path-slices)

这个人基本上是在找同样的东西。感谢所有试图帮助我的人。

# c - 守护进程/后台通过另一个程序的脚本启动的进程

> ID：11677420
> 
> 赞同：1
> 
> 时间：2012-07-26T20:22:00.977
> 
> 标签：c, perl, bash, daemon, background-process

我很犹豫要不要发布这个问题，因为我认为某个地方已经有人问过了，但是经过大量的搜索，我发现它是空的，所以就在这里。

背景：我正在运行一个本地代理（用 C 编写，通过 TCP 侦听），它允许远程执行少量脚本/命令。（具体来说，通过 Web 界面。）脚本本身是二进制文件、bash 或 perl 脚本的混合体，只要列表中允许它们，代理本身并不真正关心。

（这是在公司内部网络上，处于早期阶段，所以此时请不要争论安全性的优点。）

启动进程的 C 代理代码是这样的：

```
sprintf(mrun, "%s %s 2>&1", file, args);
mexec = popen(mrun, "r");
[read some returned buffer]
pclose(mexec); 
```

这种方法适用于外部 bash 和 perl 脚本，前提是脚本只执行命令（或在前台执行操作）。但是，我最近需要扩展一个脚本以包含一个守护进程的重新启动，在本例中，命名为。

脚本本身（bash）很简单：

```
#!/bin/bash
pkill -9 named
/local/mnt/named/sbin/named -c /local/mnt/named/var/named.conf &
echo "restarted" 
```

我遇到的问题是脚本在通过 C 代理运行时永远不会完成（即重新启动永远不会回显），因此永远不会返回控制并且 TCP 套接字永远不会被释放。就代理而言，该进程仍在运行。如果我从终端运行脚本，它可以正常工作，并且控制权会返回给我。

我是否遗漏了一些可以让脚本在从 C 守护程序分叉时正常执行而不是从 bash 终端调用的东西？

我知道 nohup 并且我想如果所有其他方法都失败了可以使用它，但我很好奇是否有其他类型的解决方法可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:52:21.663

根据上述评论的反馈，我能够在启动守护进程后让脚本继续工作，这要归功于一些额外的重定向：

```
/local/mnt/named/sbin/named -c /local/mnt/named/var/named.conf </dev/null &> /dev/null & 
```

所以，感谢 fork0 提供的那一点知识。

之后，我注意到即使脚本完成工作，TCP 套接字连接也不会正确关闭。在下面的一些更多信息并进行大量研究之后，事实证明子进程将从父进程（包括套接字）继承（并保持打开）文件描述符。

我到处寻找与子进程断绝关系的方法，但并没有真正找到任何对我有用的方法（或者不构成对代理的整个重写）。

最后，我偶然发现了这个问题，这是相关的，但与我使用的编程语言无关：

[os.execute 不继承父级的 fds](https://stackoverflow.com/questions/4835608/os-execute-without-inheriting-parents-fds)

这基本上涉及子进程关闭代码中任何打开的文件描述符，从而释放它们以由父进程关闭。（我认为？）

在开始命名之前，我在 bash 脚本中添加了几行来执行此操作，它确实有效。

```
for i in `nawk 'BEGIN{ for(i=1;i<=255;i++) print i}'`
do
eval exec `echo $i | sed -e 's/.*/&<\&-/'`
done 
```

（我会使用 nawk 而不是 seq 因为我需要它在 Solaris 和 Linux 上运行。）

一些基本测试表明，这已经解决了套接字无法关闭的主要问题，但我需要进一步研究这是否会产生我不知道的任何其他后果。也可能有更好、更安全的方法来实现这一目标，但至少我走在正确的轨道上。

# java - 需要注册 LocationListener 吗？

> ID：11677422
> 
> 赞同：0
> 
> 时间：2012-07-26T20:22:16.077
> 
> 标签：java, android, location

在我的应用程序中，我只需要在`Location`单击某个按钮时获得一个。我还需要注册一个`LocationListener`，还是我可以使用这个？

```
LocationManager lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
Location position = lm.getLastKnownLocation(LocationManager.GPS_PROVIDER); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:23:39.380

这取决于您需要该位置的目的。LastKnown Location 可能来自 10 分钟前。这对您的目的是否足够好？还是你现在需要打开GPS，因为我的理解是通话不会打开GPS。

# ruby-on-rails - Ruby中的日期减法

> ID：11677423
> 
> 赞同：3
> 
> 时间：2012-07-26T20:22:18.543
> 
> 标签：ruby-on-rails, ruby, datetime, date

我有一个有两个参数的类：`start_date`和`end_date`.

这些格式类似于 - 2012-07-12 和 2012-07-24。

`end_date`我要从中减去`start_date`。

以前的谷歌搜索让我高高在上。我应该将这些转换为其他东西来做减法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T20:31:28.647

将它们转换为日期并减去它们：

```
require 'date'

start_date = Date.parse('2012-07-12')
end_date = Date.parse('2012-07-24')

(start_date - end_date).to_i

=> -12 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:29:12.163

如果你想要天数`(end_date-start_date).days`应该可以正常工作。你可能会得到`Rational`几天，在这种情况下你可以使用`to_i`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:29:48.037

如果我不是 miskaten，则参数以 a 的形式出现`String`，因此您必须将其转换为 a `Date`,`DateTime`或`Time`对它们进行数学运算。
您可以参考此问题以了解更多详细信息。
[如何在 Ruby 中找到两个 Date 对象之间的天数？](https://stackoverflow.com/questions/4502245/number-of-days-between-two-date-objects-ruby)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T20:30:23.670

您可以只减去两个 DateTime 对象

使用 1.9

```
require 'date'
DateTime.parse(end_date) - DateTime.parse(start_date) 
```

# r - 如何在 data.table 中使用未知数量的键列

> ID：11677424
> 
> 赞同：4
> 
> 时间：2012-07-26T20:22:17.950
> 
> 标签：r, data.table

我想做与[此处](https://stackoverflow.com/questions/10438969/fastest-way-to-add-rows-for-missing-values-in-a-data-frame)解释的相同的操作，即将缺失的行添加到 data.table。我面临的唯一额外困难是我希望关键列的数量，即用于自连接的那些行，是灵活的。

这是一个小例子，基本上重复了上面提到的链接中所做的事情：

```
df <- data.frame(fundID   = rep(letters[1:4], each=6),
                 cfType   = rep(c("D", "D", "T", "T", "R", "R"), times=4),
                 variable = rep(c(1,3), times=12),
                 value    = 1:24)
DT <- as.data.table(df)
idCols <- c("fundID", "cfType")
setkeyv(DT, c(idCols, "variable"))
DT[CJ(unique(df$fundID), unique(df$cfType), seq(from=min(variable), to=max(variable))), nomatch=NA] 
```

困扰我的是最后一行。我想要`idCols`灵活（例如，如果我在函数中使用它），所以我不想`unique(df$fundID), unique(df$cfType)`手动输入。但是，我只是没有找到任何解决方法。我所有尝试根据`df`需要`CJ`自动*将作为键列类型。*

```
CJ(sapply(df[, idCols], unique))
CJ(unique(df[, idCols]))
CJ(as.vector(unique(df[, idCols])))
CJ(unique(DT[, idCols, with=FALSE])) 
```

我也尝试自己构建表达式：

```
str <- ""
for (i in idCols) {
  str <- paste0(str, "unique(df$", i, "), ")
}
str <- paste0(str, "seq(from=min(variable), to=max(variable))")
str
[1] "unique(df$fundID), unique(df$cfType), seq(from=min(variable), to=max(variable))" 
```

但是后来我不知道如何使用`str`. 这一切都失败了：

```
CJ(eval(str))
CJ(substitute(str))
CJ(call(str)) 
```

有谁知道一个好的解决方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:11:19.300

迈克尔的回答很棒。`do.call`确实需要以`CJ`这种方式灵活调用，afaik。

要清除表达式构建方法并从您的代码开始，但删除`df$`部分（不需要并且在链接答案中未完成，因为`i`在 范围内评估`DT`）：

```
str <- "" 
for (i in idCols) { 
  str <- paste0(str, "unique(", i, "), ") 
} 
str <- paste0(str, "seq(from=min(variable), to=max(variable))") 
str 
[1] "unique(fundID), unique(cfType), seq(from=min(variable), to=max(variable))" 
```

然后是：

```
expr <- parse(text=paste0("CJ(",str,")"))
DT[eval(expr),nomatch=NA] 
```

或者动态地构建和评估整个查询：

```
eval(parse(text=paste0("DT[CJ(",str,"),nomatch=NA"))) 
```

如果这样做很多，那么可能值得为自己创建一个辅助函数：

```
E = function(...) eval(parse(text=paste0(...))) 
```

减少到：

```
E("DT[CJ(",str,"),nomatch=NA") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T22:18:12.910

我从来没有使用过 data.table 包，所以如果我错过了这里的标记，请原谅我，但我想我已经明白了。这里发生了很多事情。从阅读开始`do.call`，它允许您以一种非传统方式评估任何函数，其中参数由提供的列表指定（列表中的每个元素在位置上与函数参数匹配，除非明确命名）。另请注意，我必须指定`min(df$variable)`而不仅仅是`min(variable)`. 阅读[Hadley 的关于范围界定的页面，](https://github.com/hadley/devtools/wiki/Evaluation)以了解这里的问题。

```
CJargs <- lapply(df[, idCols], unique)
names(CJargs) <- NULL
CJargs[[length(CJargs) +1]] <- seq(from=min(df$variable), to=max(df$variable))
DT[do.call("CJ", CJargs),nomatch=NA] 
```

# .net - C++/CLI：返回 Nullable 来自泛型方法的对象

> ID：11677425
> 
> 赞同：3
> 
> 时间：2012-07-26T20:22:19.860
> 
> 标签：.net, visual-c++, c++-cli

请考虑以下代码：

```
public ref class Factory
{
public:
    generic <typename T> where T : value class, System::ValueType
    static System::Nullable<T> Create()
    {
        return System::Nullable<T>();
    }
}; 
```

Visual C++ 2008 吐出以下错误：

```
error C2440: 'return' : cannot convert from 'System::Nullable<T>' to 'System::Nullable<T>' 
```

如果我用用户定义的类型替换“System::Nullable”类型，它就可以正常工作：

```
generic <typename T> where T : value class, System::ValueType
public value class MyType 
{ };

public ref class Factory
{
public:
    generic <typename T> where T : value class, System::ValueType
    static MyType<T> Create()
    {
        return MyType<T>();
    }
}; 
```

这是某种 VC++ 错误，还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:01:43.997

对于那些可能遇到同样问题的人，您可以使用以下解决方法：

```
public ref class Factory
{
public:
    generic <typename T> where T : value class, System::ValueType
    static System::Nullable<T> Create()
    {
        return Workaround<T>::Nullable();
    }

private:
    generic <typename T> where T : System::ValueType, value class
    value struct Workaround {
        typedef System::Nullable<T> Nullable;
    };
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:25:16.357

你有没有尝试过：

```
public ref class Factory
{
public:
    generic <typename T> where T : value class, System::ValueType
    static System::Nullable<T> Create()
    {
        return Null;
    }
}; 
```

# c# - 产生意想不到的额外运动的图像动画

> ID：11677433
> 
> 赞同：0
> 
> 时间：2012-07-26T20:22:49.350
> 
> 标签：c#, wpf, animation

我正在尝试创建一个函数，通过将每个人的位置与其邻居的位置交换来移动以放射状布局排列的图像。最后的效果是图像围绕一个圆圈旋转。当按下 S（逆时针）或 D（顺时针）键时，变换被激活。我正在使用一个数组来跟踪图像的位置，并将这些坐标发送到一个实际执行转换的函数。

任一方向的第一次旋转都可以正常工作。但是在同一方向上的任何连续旋转都会产生奇怪的不需要的运动。本质上，随着每一次新的旋转，图像都会向内移动到圆的中心，然后再次向外移动以占据最终位置。每按一次键，向内运动的量就会变得更糟。

由于我不允许在这封电子邮件中附加图片，因此我在此处发布了一张图片：http: [//i1266.photobucket.com/albums/jj532/ik_al/screencap.jpg](http://i1266.photobucket.com/albums/jj532/ik_al/screencap.jpg)

该图显示了一系列截图来说明这一现象。请注意，屏幕截图都发生在 ONE 轮换中。

这是我的 XAML 文件：

```
<Window x:Class="radialLayout.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:MyNamespace="clr-namespace:radialLayout"
      Title="MainWindow" Height="350" Width="525" KeyUp="Window_KeyUp">
<Grid Width="1024" Height="768"> 

    <MyNamespace:RadialPanel Margin="27,21,31,32" MouseWheel="RadialPanel_MouseWheel" x:Name="ImagePanel">
        <!--Must use same namespace declared above-->

      <!--Each image must have a unique name-->
        <Image Height="49" Name="image1" Width="74" Source="/radialLayout;component/Images/profile.jpg" />
        <Image Height="49" Name="image2" Width="74" Source="/radialLayout;component/Images/IMG_0841.JPG" />
        <Image Height="49" Name="image3" Width="74" Source="/radialLayout;component/Images/profile.jpg" />
        <Image Height="49" Name="image4" Width="74" Source="/radialLayout;component/Images/IMG_0841.JPG" />
        <Image Height="49" Name="image5" Width="74" Source="/radialLayout;component/Images/profile.jpg" />
        <Image Height="49" Name="image6" Width="74" Source="/radialLayout;component/Images/IMG_0863.JPG" />
        <Image Height="49" Name="image7" Width="74" Source="/radialLayout;component/Images/profile.jpg" />
        <Image Height="49" Name="image8" Width="74" Source="/radialLayout;component/Images/IMG_1043.JPG" />
        <Image Height="49" Name="image9" Width="74" Source="/radialLayout;component/Images/profile.jpg" />
        <Image Height="49" Name="image10" Width="74" Source="/radialLayout;component/Images/IMG_0863.JPG" />
        <Image Height="49" Name="image11" Width="74" Source="/radialLayout;component/Images/profile.jpg" />
        <Image Height="49" Name="image12" Width="74" Source="/radialLayout;component/Images/IMG_0863.JPG" />

    </MyNamespace:RadialPanel> 
```

这是函数调用和函数实现：

```
 for (int o = 0; o < VisualTreeHelper.GetChildrenCount(ImagePanel); o++)
            {
                Visual childVisual = (Visual)VisualTreeHelper.GetChild(ImagePanel, o);
                MyExtensions.MoveTo((Image)childVisual, lastPosition[o, 0], lastPosition[o, 1], ImagePanel.imageCoordinates[o, 0], ImagePanel.imageCoordinates[o, 1]);

            }

        public static void MoveTo(this Image target, double currentX, double currentY, double newX, double newY)
    {
        Vector offset = VisualTreeHelper.GetOffset(target);
        var top = offset.Y;
        var left = offset.X;
        TranslateTransform trans = new TranslateTransform();
        target.RenderTransform = trans;
        DoubleAnimation anim1 = new DoubleAnimation(0, newY - top, TimeSpan.FromSeconds(1));
        DoubleAnimation anim2 = new DoubleAnimation(0, newX - left, TimeSpan.FromSeconds(1));
        trans.BeginAnimation(TranslateTransform.YProperty, anim1);
        trans.BeginAnimation(TranslateTransform.XProperty, anim2);
    } 
```

有谁知道是什么导致了这种行为或如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T18:01:54.163

经过大量调查，我终于弄清楚我在代码中做错了什么。

我不明白在使用 translateTranform 时，图像的原始位置被保留为所有连续变换的起点；我认为它已更新到最新的最新位置。此外，此起点始终由坐标 (0,0) 引用。

因此，为了解决我的动画问题，我必须通过从屏幕上图像的当前位置（存储在数组中）减去每个图像的原始位置（第一次变换之前）来偏移图像的**开始**和**停止位置。**对于第一次通过，这些值将始终加起来为 0。

我已经完成了**停止**位置的偏移，因为即使是第一次转换也需要工作。但事实证明，这个减法也需要更新**起始**位置。

在代码中，图像的原始位置存储在分别引用 X 和 Y 坐标的**left**和**top变量中。**

这是我更改的代码部分：

```
 DoubleAnimation anim1 = new DoubleAnimation(currentY-top, newY - top, TimeSpan.FromSeconds(1));
        DoubleAnimation anim2 = new DoubleAnimation(currentX-left, newX - left, TimeSpan.FromSeconds(1)); 
```

这个错误的有趣之处在于，当所有 12 个图像一起转换时生成的动画比单独移动每个图像时要复杂和有趣得多。因此，在计算图像变换的方式之间必须存在一些相互作用，从而产生紧急输出。我看到的输出让我认为解决方案比实际复杂得多。

# c# - NHibernate，使用带有 Future 的 QueryOver 获取孙子集合

> ID：11677434
> 
> 赞同：5
> 
> 时间：2012-07-26T20:22:59.390
> 
> 标签：c#, nhibernate

我正在尝试检索父实体的所有集合（非笛卡尔积），但无法弄清楚如何获得孙子。表结构如下：

![在此处输入图像描述](../Images/33ee2c796ef4ce52ca93418bcf56ca10.png)

以下代码获取我的父母及其 Child1 和 Child2 集合，以及它的 ParentChild3 集合，但我不知道如何构造查询以获取 Child3 孙子（并将它们推迟到 Future()）。

```
var parent = _session
    .QueryOver<Parent>()
    .Where(x => x.Id == id)
    .Future<User>();

var children1 =_session
    .QueryOver<Parent>()
    .Where(x => x.Id == id)
    .Fetch(x => x.Children1).Eager
    .Future<Parent>();

var children2 =_session
    .QueryOver<Parent>()
    .Where(x => x.Id == id)
    .Fetch(x => x.Children2).Eager
    .Future<Parent>();

var parentChildren3 =_session
    .QueryOver<Parent>()
    .Where(x => x.Id == id)
    .Fetch(x => x.ParentChildren3).Eager
    .Future<Parent>();

// how to get children3, now?

return parent.SingleOrDefault(); 
```

半相关：这是获得所有收藏的最佳方式吗？使用通过连接获得结果的查询是否更好（并且可能）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T06:32:43.677

**如何获得Children3：**

```
ParentChildren alias = null;
var parentChildren3 =_session
    .QueryOver<Parent>()
    .Where(x => x.Id == id)
    .JoinAlias(x => x.ParentChildren3, () => alias)
    .Fetch(() => alias.Children3).Eager
    .Future<Parent>(); 
```

**半相关：**这是我所知道的最好的方式。

如果 ParentChild 表没有其他列，那么您可以将其映射为标准多对多。NHibernate 将不需要链接表的实体，并且急切的获取会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-09T20:31:15.737

尝试这个：

```
var parentChildren3 =
        _session
            .QueryOver<Parent>()
            .Fetch(x => x.ParentChildren3).Eager
            .Fetch(x => x.ParentChildren3.First().Child3).Eager
            .Where(x => x.Id == id)
            .Future<Parent>(); 
```

如本论坛主题所述：[https ://groups.google.com/forum/?fromgroups=#!topic/nhusers/ER5BvVnCT5Q](https://groups.google.com/forum/?fromgroups=#!topic/nhusers/ER5BvVnCT5Q)

# java - NamedQuery 报错

> ID：11677439
> 
> 赞同：0
> 
> 时间：2012-07-26T20:23:19.753
> 
> 标签：java, web-services, named-query

> **可能重复：**
> [如何在 NamedQuery 中编写 NamedQuery hasrsine 公式？](https://stackoverflow.com/questions/11657256/how-to-write-namedquery-haversine-formula-in-namedquery)

我想在命名查询下运行：

```
List<Object> result= em.createQuery("select sum(u.mlatitude) from UserGpsLocation u").getResultList();
return result.get(0); 
```

谁能帮助我并告诉我它有什么问题？

# svn - Cygwin的根目录，关于共享文件夹和SVN的位置

> ID：11677443
> 
> 赞同：2
> 
> 时间：2012-07-26T20:23:58.403
> 
> 标签：svn, cygwin

我有一个双虚拟系统：`Windows`和`Ubuntu`，它们共享一个文件夹。在 下`Windows`，对共享文件夹的访问是通过`Z:\SharedFolder\`。下`Ubuntu`，其访问权限为`/mnt/hgfs/SharedFolder`。

`Programs`我在其中放置了许多代码的 subsubsub 文件夹，`SharedFolder`其中大多数是通过`svn`远程服务器管理的。

我刚刚安装`Cygwin`下`Windows`为了生成 Windows 的二进制文件，我设置`C:\cygwin`为`Root Directory`. 但似乎在 Cygwin 终端中，我无法去管理外部文件`C:\cygwin`，例如`Z:\SharedFolder\...\Programs\`. 如果我错了，请纠正我。

这使问题复杂化，因为我想在`Z:\SharedFolder\...\Programs\`. 优点是避免复制过去，并且能够通过`svn`.

有人对`Root Directory`of有好主意`Cygwin`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:29:51.607

要访问 Windows 驱动器，请使用`/cygdrive/<driveletter>`where `<driveletter>`is the drive's on Windows 。`:`Cygwin在路径名（以及一般的 Windows 样式路径）中使用该字符时存在问题，因此您必须`/cygdrive/`在某些上下文中使用该格式。

[http://cygwin.com/cygwin-ug-net/using.html#cygdrive](http://cygwin.com/cygwin-ug-net/using.html#cygdrive)

# jquery - 基于 if/else 的不同提交调用

> ID：11677446
> 
> 赞同：0
> 
> 时间：2012-07-26T20:24:08.303
> 
> 标签：jquery, google-analytics

在我们的登录页面上，我们有两个输入字段（用户名和密码），但是在提交并验证第一个输入之前，第二个字段不可见。相同的按钮用于提交两次，一次仅使用用户名，一次使用用户名和密码。

我想根据提交的字段使用不同的提交调用。

代码目前看起来像这样：

```
if($('input[name=password]').size() > 0)
    $('input[name=password]').focus();
else
    $('input[name=username]').focus();

$('#login-button').click(function() {
    $('form').submit();
}); 
```

但是，对于谷歌分析跟踪，我想在只提交用户名时使用不同的提交调用（第一次提交）。备用提交看起来像这样：

```
$('#login-button').click(function() {
    $('form').submit(function() {
     _gaq.push('_trackPageview', 'PageName');
}); 
```

我可以以某种方式简单地将提交内容放入 if/else 中吗？我怀疑还有更多的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:25:36.243

这样的事情应该这样做：

```
$('#login-button').click(function() {
    $('form').submit(function() {
        if($('input[name=username]').size() > 0)
         _gaq.push('_trackPageview', 'PageName');
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T23:35:30.317

如果您想检查是否只有用户名而没有密码，您可以检查密码字段是否可见？也就是说，如果您想在屏幕上显示密码字段之前进行跟踪。

```
$('input[name=password]').is(':visible'); 
```

所以：

```
$('#login-button').click(function() {
    $('form').submit(function() {
        if ($('input[name=username]').size() > 0 && !$('input[name=password]').is(':visible')) {
            _gaq.push('_trackPageview', 'PageName');
        }
    });
}); 
```

但是，如果不是这种情况，并且您的意思是一旦密码字段在屏幕上可见就进行跟踪，您可以使用上面的示例并在 (if) 语句中添加 (&&) 子句。

```
if ($('input[name=username]').size() > 0 && $('input[name=password]').size() < 1) {
    //do some tracking
} 
```

# symfony - 区分 Symfony 2 表单主题中的冒泡错误和字段错误？

> ID：11677447
> 
> 赞同：0
> 
> 时间：2012-07-26T20:24:09.090
> 
> 标签：symfony, twig, symfony-forms

如何区分字段错误和冒泡（表单）错误？AFAIK 唯一`block`控制它的是：

```
{% block field_errors %}
{% spaceless %}
    {% if errors|length > 0 %}
    <ul>
        {% for error in errors %}
        ...
        {% endfor %}
    </ul>
    {% endif %}
{% endspaceless %}
{% endblock field_errors %} 
```

我想我不能依赖`errors|length`：通常是 1 表示字段错误，但也可以是 1 表示表单错误 :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:52:17.663

在我看来，默认情况下您无法区分这些错误。但是您可以扩展基本的[FormError](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/FormError.php)类并添加一些属性，它将定义错误出现的确切位置。

# c# - C# 中的简单面板滑块

> ID：11677448
> 
> 赞同：0
> 
> 时间：2012-07-26T20:24:11.617
> 
> 标签：c#, winforms

我目前正在开发一个 C# 应用程序。现在我正在尝试实现一个简单的滑块：

```
|--------------------------|
|                          |
|  |--------------------|  |
|  |                    |  |
|  |       Panel1       |  |
|  |       Panel2       |  |
|  |                    |  |
|  |--------------------|  |
|           x x x          |
|--------------------------| 
```

我有两个尺寸完全相同的面板。Panel1 仅用于显示边框并为 panel2 设置边界，然后动态交换。

如果单击第二个 x，则 panel2 应向左移动，而 panel3 应从右侧移动并向左移动。

基本上我有以下代码：

```
Panel panel2 = panelArray[0];
Panel panel3 = panelArray[1]; 
```

下面的代码现在应该执行幻灯片：

```
for (int i = 0; i <= 100; i++)
{
    panel2.Location = new Point(panel2.Location.X - i, panel2.Location.Y);
    System.Threading.Thread.Sleep(10);
}

for (int i = 0; i <= 100; i++)
{
    panel3.Location = new Point(100 - i, panel3.Location.Y);
    System.Threading.Thread.Sleep(10);
} 
```

不知何故，第一个面板完美滑出，但 panel2 没有滑动。它只是在循环执行后显示。

知道为什么 panel2 不执行幻灯片吗？我正在使用 WinForms。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:30:15.473

尝试`Application.DoEvents`在位置更改后添加循环体。UI 需要有机会迎头赶上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:31:38.610

问题是您不允许通过强制睡眠来运行消息泵。建议`Application.DoEvents`触发消息泵，但这不是一个好的解决方案，因为您的代码大部分时间仍然阻塞，您甚至可能以这种模式在无限循环中运行（例如，如果`DoEvents`重新输入您从中调用它的事件） .

而不是使用`Thread.Sleep`你应该使用 (Winforms) `Timer`。这将解决 UI 更新问题，并在滑块移动时保持 UI 活动。

# javascript - 可以在 FireBug 和 Chrome 的控制台中启用“严格模式”吗？

> ID：11677452
> 
> 赞同：24
> 
> 时间：2012-07-26T20:24:23.553
> 
> 标签：javascript, console, strict-mode

使用此页面：

```
<!DOCTYPE html>
<html>
  <head>
    <script>
        "use strict";
        var foo = 2;
        delete foo;
    </script>
  </head>
  <body></body>
</html> 
```

Firebug 控制台提供：

```
applying the 'delete' operator to an unqualified name is deprecated
>>> foo
ReferenceError: foo is not defined
foo 
```

但是这样就成功了：

```
>>> var bar = 2;
undefined
>>> delete bar;
true 
```

即使您注释掉`delete foo;`以使脚本不会中断，删除`bar`仍然成功，尽管它“是全局对象的属性，因为它是通过变量声明创建的，因此具有[DontDelete 属性](http://perfectionkills.com/understanding-delete/#property_attributes)”：

```
>>> foo
2
>>> delete foo
false
>>> var bar = 2;
undefined
>>> delete bar
true 
```

是否可以在 FireBug 和/或 Chrome 的控制台中启用“严格模式”？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T20:44:18.030

firebug 控制台通过将所有代码包装在“eval”调用中来工作，因此脚本中的第一条语句不再是“use strict” - 因此它被禁用。您可以尝试将代码包装在一个函数中以对该特定函数强制“使用严格”，但我所知道的最佳解决方案是跳过控制台并直接在页面本身中进行测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-10-26T02:31:17.393

使用 shift+enter 输入“使用严格”

像这样 [![在此处输入图像描述](../Images/25167dc692cfad9c930334b8b290181a.png)](https://i.stack.imgur.com/Rn7ch.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-23T19:18:41.027

如果你只是在控制台中测试一个函数，你也可以把'use strict'作为函数声明的第一行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-02T12:17:54.210

Chrome：`'use strict';`在您的代码行中添加前缀（和/或 shift+enter 用于多行）

```
'use strict'; var foo = 2; delete foo;
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2018-09-08T12:37:37.190

在 Chrome 上，转到“chrome://flags”，然后“启用实验性 JavaScript”。重新启动。

# ruby-on-rails - 在 rails/paperclip 中处理一系列图像

> ID：11677453
> 
> 赞同：0
> 
> 时间：2012-07-26T20:24:25.893
> 
> 标签：ruby-on-rails, image, paperclip, file-handling

我允许我网站上的用户最多上传三张图片。所以在我的表格中，我有这些元素：

```
<label>Additional Images*<span class="note">(Maximum: 3, 200 pixels wide)</span></label>
<%= f.file_field :images, { :multiple => "", :accept => "image/*" } %>
<div id="images"></div> 
```

我有一些 javascript 验证只选择了 3 张或更少的图像，它还创建图像的缩略图并将它们作为子项添加到 div#images。当用户提交表单时， :images 参数会填充一个图像信息数组，如下所示：

```
[ #<ActionDispatch::Http::UploadedFile:0x00000007269588
   @original_filename="test_banner.jpeg",
   @content_type="image/jpeg",
   @headers="Content-Disposition: form-data; name=\"custom_form[images][]\"; filename=\"test_banner.jpeg\"\r\nContent-Type: image/jpeg\r\n",
   @tempfile=#<File:/tmp/RackMultipart20120726-7134-3hqdve>>,
  #<ActionDispatch::Http::UploadedFile:0x00000007269510
   @original_filename="test_portrait.jpeg",
   @content_type="image/jpeg",
   @headers="Content-Disposition: form-data; name=\"custom_form[images][]\"; filename=\"test_portrait.jpeg\"\r\nContent-Type: image/jpeg\r\n",
   @tempfile=#<File:/tmp/RackMultipart20120726-7134-18fcs0m>>,
  #<ActionDispatch::Http::UploadedFile:0x00000007269498
   @original_filename="test_signiture.jpeg",
   @content_type="image/jpeg",
   @headers="Content-Disposition: form-data; name=\"custom_form[images][]\"; filename=\"test_signiture.jpeg\"\r\nContent-Type: image/jpeg\r\n",
   @tempfile=#<File:/tmp/RackMultipart20120726-7134-1q5fy2f>> ] 
```

在我的模型中，我有 3 个属性：

```
has_attached_file :image1,
  ...

has_attached_file :image2,
  ...

has_attached_file :image3,
  ... 
```

我正在尝试获取它，以便将与表单一起发送的 images 参数中的信息拆分并发送到模型中的相应图像属性，如果用户只上传了一个或两个图像，则其他属性为零。有没有办法可以使用回形针在轨道上完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:29:43.900

我强烈建议您只制作 3 x file_fields。然后一切都排好，你的验证就可以正常工作了。我知道它不是那么光滑，但对于 1-3 张图像......并不是什么大不了的事。

# android - ZXing 相机通过 IntentIntegrator 设置焦点和灯光设置

> ID：11677458
> 
> 赞同：1
> 
> 时间：2012-07-26T20:24:31.787
> 
> 标签：android, android-intent, android-camera, zxing

我想告诉 ZXing 在打开手电筒并关闭自动对焦（最好设置为微距）的情况下加载相机。有没有办法做到这一点？我尝试将“preferences_front_light”的 SharedPreferences 设置为 true，但 com.google.zxing.client.android.camera.CameraConfigurationManager 似乎无法读取它，因为我不确定 SharedPrefrences 组的名称是什么，并且我的应用程序上下文与加载的意图不同。

我确实意识到为此加载了用户设置，但我更愿意为我正在编写的应用程序覆盖这些设置。

任何指导都会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T22:35:56.813

没有办法做到这一点。这个想法是用户而不是呼叫者处于决定是否打开灯的最佳位置。与焦点相同。您不能更改标记为私有的应用的首选项。

# android - 滚动视图Android中的多个自定义视图

> ID：11677459
> 
> 赞同：0
> 
> 时间：2012-07-26T20:24:35.813
> 
> 标签：android, scrollview, android-custom-view

我创建了自定义视图，并希望将多个数字插入到滚动列表中，但始终只显示一个视图：

```
 <ScrollView 
  android:layout_width="match_parent"
  android:layout_height="wrap_content"
  android:layout_below="@+id/buttonsPart"
  android:id="@+id/scrollView1"
  android:background="@drawable/greylayer">

  <LinearLayout 
      android:layout_width="match_parent"
      android:layout_height="wrap_content">

       <com.test.app.canvas.MatchCanvas
      android:layout_width="fill_parent"
      android:layout_height="400px"/>

      <com.test.app.canvas.MatchCanvas
      android:layout_width="fill_parent"
      android:layout_height="400px"/>

  </LinearLayout> 
```

我相信向 ScrollView 插入尽可能多的自定义视图很容易，但不知何故，我仍然只有 1 个 MatchCanvas 实例。我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:27:54.030

默认情况下，LinearLayout 是水平的，因此添加`android:orientation="vertical"`到 LinearLayout 以解决问题。

# android - 如何从适配器强制更新 ListView 中的数据？

> ID：11677462
> 
> 赞同：0
> 
> 时间：2012-07-26T20:24:52.520
> 
> 标签：android, multithreading, bitmap, android-listview

我在那里有 ListView 的自定义适配器，我有下载位图的线程。它工作不好，因为当位图加载时它没有显示在列表视图中，如果我想看到它，我必须滚动列表。

所以问题是如何强制重新生成视图。在这种认识中，有很多困难。这有可能改变吗？

有我的代码：

```
import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.net.Uri;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;

import java.io.IOException;
import java.net.URL;
import java.util.List;

public class Adapter extends ArrayAdapter<Place> {
    private Activity mActivity;
    private List<Place> mList;

    public Adapter(Activity context, List<Place> objects) {
        super(context, R.layout.row, objects);
        mActivity = context;
        mList = objects;
    }

    static class ViewHolder {
        private TextView mTextViewName;
        private TextView mTextViewAddress;
        private TextView mTextViewWeb;
        private ImageView mImageButtonPhoto;
    }
    ViewHolder viewHolder;
    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {

        if (convertView == null) {
            LayoutInflater inflator = mActivity.getLayoutInflater();
            convertView = inflator.inflate(R.layout.row, null);
            viewHolder = new ViewHolder();
            viewHolder.mTextViewName = (TextView) convertView.findViewById(R.id.textView1);
            viewHolder.mTextViewAddress = (TextView) convertView.findViewById(R.id.textView2);
            viewHolder.mTextViewWeb = (TextView) convertView.findViewById(R.id.textView3);
            viewHolder.mImageButtonPhoto = (ImageView) convertView.findViewById(R.id.imageButton1);
            convertView.setTag(viewHolder);
        } else {
            viewHolder = (ViewHolder) convertView.getTag();
        }
        viewHolder.mTextViewName.setText(mList.get(position).getName());
        viewHolder.mTextViewAddress.setText(mList.get(position).getAddress());
        viewHolder.mTextViewWeb.setText(mList.get(position).getUrl().toString());
        viewHolder.mTextViewWeb.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent i = new Intent(Intent.ACTION_VIEW);
                i.setData(Uri.parse(mList.get(position).getUrl().toString()));
                mActivity.startActivity(i);
            }
        });
        URL url = mList.get(position).getPhoto_url();
        final URL finalUrl = url;
        new Thread(new Runnable() {
            public void run() {
                final Bitmap b;
                try {
                    b = BitmapFactory.decodeStream(finalUrl.openConnection().getInputStream());
                    viewHolder.mImageButtonPhoto.post(new Runnable() {
                        public void run() {
                            viewHolder.mImageButtonPhoto.setImageBitmap(b);
                        }
                    });
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }).start();
        return convertView;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:33:45.137

给适配器提供数据后，您是否尝试过调用`notifyDataSetChanged()`适配器？

它将调用`invalidate()`每个项目的`View`，这会使它们重绘。

编辑：没关系，您需要使用该`add(item)`方法。

当您准备好更新数据时，请执行一个`for`循环：

```
for (int i = 0; i < mList.getCount(); i++) {
    adapter.add(mList.getItem(i));
} 
```

# java - 如何使用四叉树对图进行分区？

> ID：11677469
> 
> 赞同：1
> 
> 时间：2012-07-26T20:25:40.200
> 
> 标签：java, graph, partitioning, graph-algorithm, quadtree

我有一个程序，允许用户在大小为 1000 x 750 的 JFrame 上绘制顶点和边。现在我需要使用四叉树根据单个象限中有多少个顶点来划分输入图。如果有人能指出如何实现这一目标的正确方向，我将不胜感激？

附加信息：我有一个 Edge 类，它存储：源（顶点）、目标（顶点）和权重。我有一个 Vertex 类，它存储：名称、x 坐标、y 坐标和 Ed​​ge[] 相邻列表。我还有一个 Graph 类，它存储两个 ArrayList：边和顶点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T16:49:04.463

我最近实现了代码，应该可以解决您的问题。在我最近的博客文章中可以免费下载。空间分解的四叉树，Java 实现[http://kirstywilliams.co.uk/blog/2012/08/quadtrees-java-implementation/](http://kirstywilliams.co.uk/blog/2012/08/quadtrees-java-implementation/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T10:30:38.860

更多的四叉树实现都是 apache 许可的：

*   [Apache SIS](http://svn.apache.org/repos/asf/incubator/sis/trunk/sis-core/src/main/java/org/apache/sis/storage/QuadTree.java) - 无需测试，速度很快，但[需要进行一些改进](https://issues.apache.org/jira/browse/SIS-45)
*   [GraphHopper](https://github.com/karussell/GraphHopper/blob/master/core/src/main/java/de/jetsli/graph/trees/QuadTreeSimple.java) - 通过测试，内存消耗更少，但可能会慢一些。距离计算是可插拔的。

但是，如果您已经在内存中有一个连通图，您可以创建一个内存效率更高（但也有点复杂）的解决方案。零件在[此处](https://github.com/karussell/GraphHopper/blob/master/core/src/main/java/de/jetsli/graph/storage/Location2IDQuadtree.java)实现，更多详细信息可[在此处](https://stackoverflow.com/a/11881799/194609)获得。

另一个[有趣的 repo](https://github.com/neo4j/graph-collections/tree/master/src/main/java/org/neo4j/collections)（但我认为是 neo4j 本身是 AGPL），其中包含一些空间集合。

# c# - 通过网络代理使用 C# 发送电子邮件

> ID：11677470
> 
> 赞同：0
> 
> 时间：2012-07-26T20:25:43.747
> 
> 标签：c#, email, networking, proxy, smtp

我正在尝试创建一个程序来查询数据库并将报告导出到 Excel，然后通过电子邮件发送状态，我被困在电子邮件部分。我不断收到“发送邮件失败”并且 smtpException 未处理“。我相信这是因为我正在做这件事的公司有一个网络代理。我可以访问互联网。我只是无法发送电子邮件。有什么我需要的添加以允许它通过代理发送它？这是错误：

```
 System.Net.Mail.SmtpException was unhandled
  Message=Failure sending mail.
  Source=System
  StackTrace:
       at System.Net.Mail.SmtpClient.Send(MailMessage message)
       at WindowsFormsApplication1.Form1.button1_Click(Object sender, EventArgs e) in C:\Documents and Settings\DavidPaquette\My Documents\Visual Studio 2010\Projects\TestMail\TestMail\Form1.cs:line 47
       at System.Windows.Forms.Control.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
       at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
       at System.Windows.Forms.Control.WndProc(Message& m)
       at System.Windows.Forms.ButtonBase.WndProc(Message& m)
       at System.Windows.Forms.Button.WndProc(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
       at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
       at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.Run(Form mainForm)
       at WindowsFormsApplication1.Program.Main() in C:\Documents and Settings\DavidPaquette\my documents\visual studio 2010\Projects\TestMail\TestMail\Program.cs:line 18
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: System.Net.WebException
       Message=Unable to connect to the remote server
       Source=System
       StackTrace:
            at System.Net.ServicePoint.GetConnection(PooledStream PooledStream, Object owner, Boolean async, IPAddress& address, Socket& abortSocket, Socket& abortSocket6, Int32 timeout)
            at System.Net.PooledStream.Activate(Object owningObject, Boolean async, Int32 timeout, GeneralAsyncDelegate asyncCallback)
            at System.Net.PooledStream.Activate(Object owningObject, GeneralAsyncDelegate asyncCallback)
            at System.Net.ConnectionPool.GetConnection(Object owningObject, GeneralAsyncDelegate asyncCallback, Int32 creationTimeout)
            at System.Net.Mail.SmtpConnection.GetConnection(ServicePoint servicePoint)
            at System.Net.Mail.SmtpTransport.GetConnection(ServicePoint servicePoint)
            at System.Net.Mail.SmtpClient.GetConnection()
            at System.Net.Mail.SmtpClient.Send(MailMessage message)
       InnerException: System.Net.Sockets.SocketException
            Message=A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond 173.194.70.108:587
            Source=System
            ErrorCode=10060
            NativeErrorCode=10060
            StackTrace:
                 at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
                 at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception)
            InnerException: 
```

这是代码的电子邮件部分：

```
MailMessage message = new MailMessage();

    message.To.Add(new MailAddress("email@gmail.com"));
    message.From = new MailAddress("email@gmail.com");
    //Attachment attachment = new Attachment(FileUpload1.PostedFile.FileName);
    message.Subject = "Subject";
    message.Body = "This is a test"; 

    //message.Attachments.Add(attachment);     
    SmtpClient client = new SmtpClient();

    client.Port = 587; // Gmail works on this port   
    client.Host = "smtp.gmail.com";   
    System.Net.NetworkCredential nc = new System.Net.NetworkCredential("email@gmail.com", "pass"); 
    client.EnableSsl = true;     
    client.UseDefaultCredentials = false;  
    client.Credentials = nc;  
    client.Send(message); 
```

以下是包括：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.IO;
using System.Windows.Forms;
using System.Net;
using System.Collections;
using System.Text.RegularExpressions;
using System.Net.Mail; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:40:06.620

您可以将代理服务器添加到您的 web.config 文件中， http: [//msdn.microsoft.com/en-us/library/kd3cf2ex.aspx](http://msdn.microsoft.com/en-us/library/kd3cf2ex.aspx)

```
<configuration>
  <system.net>
    <defaultProxy>
      <proxy
        usesystemdefault="true"
        proxyaddress="http://192.168.1.10:3128"
        bypassonlocal="true"
      />
      <bypasslist
        <add address="[a-z]+\.contoso\.com" />
      </bypasslist>
    </defaultProxy>
  </system.net>
</configuration> 
```

一旦您添加并配置了它，所有传出呼叫（到您的 SMTP 服务器）都将通过代理服务器（除非您将其添加到绕过列表...）。

/维克托

# batch-file - 如何在不知道变量名称的情况下批量查找变量的值

> ID：11677473
> 
> 赞同：1
> 
> 时间：2012-07-26T20:25:55.090
> 
> 标签：batch-file

我正在制作一个简单的批处理游戏，并试图找出如何使用名称未知的变量的值。示例：
我不知道`var1`变量的名称或值，因为它是在游戏早期自动生成的。
我唯一知道的是第 3 行：`set var3=var2`.
我需要我的游戏在 if 语句中使用“var1”的值，如最后一行所示。
我该怎么做？

```
set var1=5
set var2=var1
set var3=var2
if ??? EQU something something... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T23:29:55.480

它进行了一些编辑，但我终于想出了一个真正的防弹选项（方法 5）。

在方法 5 中，如果 var3 被替换为包含的变量名，`"`那么您将不得不转义一些引号。但是，如果您足够老练，可以在变量名中加上引号，那么您已经知道该怎么做 :-)

```
@echo off
setlocal

set var1=5
set var2=var1
set var3=var2

::method 1 - Without using delayed expansion. (this is relatively slow and unsafe)
::           the initial expansion uses 1 % and no CALL
::           the 2nd expansion uses CALL and 2 %%
::           the 3rd expansion uses CALL and 4 %%%%
::           each additional expansion would require another CALL and doubled percents
call call set "test=%%%%%%%var3%%%%%%%
if "%test%"=="5" echo Method 1 works: Value of "unknown var"=%test%

::The remaining methods use delayed expansion. They are safer and faster.
setlocal enableDelayedExpansion

::method 2 - Using normal and delayed expansion and a temp variable.
::           Almost always works, but can fail in rare cases where variable
::           name contains "
set "test=!%var3%!"
if "!%test%!"=="5" echo Method 2 works: Value of "unknown var"=!%test%!

::method 3 - Using normal and delayed expansion without using any temp variable.
::           This works for sensible variable names, but fails if name contains
::           * or ?. Also can fail if variable name contains "
for %%A in ("!%var3%!") do if "!%%~A!"=="5" echo Method 3 works: Value of "unknown var"=!%%~A!

::method 4 - Using normal and delayed expansion without using any temp variable.
::           This almost always works, but can fail in rare cases where variable
::           name contains "
for /f "eol==delims=" %%A in ("!%var3%!") do if "!%%A!"=="5" echo Method 4 works: Value of "unknown var"=!%%A!

::method 5 - Using delayed expansion without using any temp variable.
::           This always works!
for /f "eol==delims=" %%A in ("!var3!") do for /f "eol==delims=" %%B in ("!%%A!") do if "!%%B!"=="5" echo Method 5 works: Value of "unknown var"=!%%B! 
```

# html - 知道为什么这两个框是偏移的吗？

> ID：11677477
> 
> 赞同：0
> 
> 时间：2012-07-26T20:26:08.763
> 
> 标签：html, css, height, width, overflow

在下面的小提琴中，我有两个大小相同的内联块 DIV。它们已将溢出设置为自动并在其中包含内容。第二个 DIV 有一个相当大的 Y 偏移，但我不知道为什么。它们应该紧挨着。

[http://jsfiddle.net/nT4ku/](http://jsfiddle.net/nT4ku/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:28:05.400

在并排的`inline-block`div 上指定垂直对齐应该可以为您解决这个问题。`vertical-align: top;`

这是我对您的 jsfiddle 的编辑：http: [//jsfiddle.net/nT4ku/1/](http://jsfiddle.net/nT4ku/1/)

# ruby-on-rails - Xcode 4.4 和 OSX 10.8 安装后 - 安装 libv8 时“无法构建 gem 原生扩展”

> ID：11677480
> 
> 赞同：7
> 
> 时间：2012-07-26T20:26:14.693
> 
> 标签：ruby-on-rails, ruby

我最近将 OSX 升级到 Mountain Lion (10.8) 和 Xcode (4.4)，但在尝试让我的 rails 环境正常工作时遇到了问题。我开始运行并在安装库`bundle install`时遇到错误。`libv8`以下是完整错误的粘贴。我四处搜索并寻找类似的问题，但到目前为止我在 stackoverflow 上发现的内容并未适用于我的问题。以下是我迄今为止尝试过的几件事无济于事：

*   安装 Xcode 命令行工具
*   安装 MySQL
*   安装 X11
*   通过 gemfile 安装不同版本的 libv8

现在我的问题似乎超出了我的红宝石技能。如果有人对我可以尝试的方法有什么想法或遇到类似问题，我希望您能提供帮助。谢谢！

这是我的 gemfile 的样子：

```
source 'https://rubygems.org'

gem 'rails', '3.2.6'
gem 'bundler'
gem 'rake'
gem 'sqlite3'
gem 'haml'
gem 'nokogiri'
gem 'whenever'
gem 'mysql'
gem 'mysql2'
gem 'jquery-rails'
gem 'capistrano'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end 
```

这是尝试安装 gems 时的错误日志：

```
sudo bundle install
Password:
Fetching source index for https://rubygems.org/
Using rake (0.9.2.2) 
Using i18n (0.6.0) 
Using multi_json (1.3.6) 
Using activesupport (3.2.6) 
Using builder (3.0.0) 
Using activemodel (3.2.6) 
Using erubis (2.7.0) 
Using journey (1.0.4) 
Using rack (1.4.1) 
Using rack-cache (1.2) 
Using rack-test (0.6.1) 
Using hike (1.2.1) 
Using tilt (1.3.3) 
Using sprockets (2.1.3) 
Using actionpack (3.2.6) 
Using mime-types (1.19) 
Using polyglot (0.3.3) 
Using treetop (1.4.10) 
Using mail (2.4.4) 
Using actionmailer (3.2.6) 
Using arel (3.0.2) 
Using tzinfo (0.3.33) 
Using activerecord (3.2.6) 
Using activeresource (3.2.6) 
Using bundler (1.0.15) 
Using highline (1.6.13) 
Using net-ssh (2.5.2) 
Using net-scp (1.0.4) 
Using net-sftp (2.0.5) 
Using net-ssh-gateway (1.1.0) 
Using capistrano (2.12.0) 
Using chronic (0.6.7) 
Using coffee-script-source (1.3.3) 
Using execjs (1.4.0) 
Using coffee-script (2.2.0) 
Using rack-ssl (1.3.2) 
Using json (1.7.3) 
Using rdoc (3.12) 
Using thor (0.15.4) 
Using railties (3.2.6) 
Using coffee-rails (3.2.2) 
Using haml (3.1.6) 
Using jquery-rails (2.0.2) 
Installing libv8 (3.3.10.4) with native extensions /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/installer.rb:482:in `build_extensions': ERROR: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)

/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb 
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby
extconf.rb:13: uninitialized constant Gem (NameError)
Checking for Python...

Gem files will remain installed in /Library/Ruby/Gems/1.8/gems/libv8-3.3.10.4 for inspection.
Results logged to /Library/Ruby/Gems/1.8/gems/libv8-3.3.10.4/ext/libv8/gem_make.out
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/installer.rb:445:in `each'
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/installer.rb:445:in `build_extensions'
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/installer.rb:197:in `install'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/source.rb:101:in `install'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/rubygems_integration.rb:78:in `preserve_paths'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/source.rb:91:in `install'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/installer.rb:58:in `run'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/rubygems_integration.rb:93:in `with_build_args'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/installer.rb:57:in `run'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/spec_set.rb:12:in `each'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/spec_set.rb:12:in `each'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/installer.rb:49:in `run'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/installer.rb:8:in `install'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/cli.rb:222:in `install'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/vendor/thor/task.rb:22:in `send'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/vendor/thor/task.rb:22:in `run'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/vendor/thor.rb:246:in `dispatch'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/lib/bundler/vendor/thor/base.rb:389:in `start'
    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.15/bin/bundle:13
    from /usr/bin/bundle:19:in `load'
    from /usr/bin/bundle:19 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T10:16:52.780

尝试添加

```
gem 'therubyracer', '0.11.0beta5'
gem 'libv8', '~> 3.11.8' 
```

到您的 Gemfile。它对我有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T20:55:33.497

这是有关如何在 10.8 上运行 rails 的快速指南：[http ://robots.thoughtbot.com/post/27985816073/the-hitchhikers-guide-to-riding-a-mountain-lion](http://robots.thoughtbot.com/post/27985816073/the-hitchhikers-guide-to-riding-a-mountain-lion)

从指南：

> 如果您需要安装任何早于 1.9.3 的 Ruby，例如 1.9.2、1.8.7 或 REE，则需要安装 GCC 4.2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T22:52:24.910

好的，经过一番挖掘，发现我不是唯一一个有问题的人，我找到了解决方案。最终，这是因为“therubyracer”gem 引用了一个未在 Mountain Lion 上编译的 libv8 版本。修复是更新 gem 以使用 gem 的 beta 版本，该版本使用更新版本的 libv8。这是 github 上问题的链接：[https ://github.com/cowboyd/therubyracer/issues/181](https://github.com/cowboyd/therubyracer/issues/181)

我保留了一份关于让轨道重新启动和运行的整个过程的婴儿床笔记清单，这里有一个简短的清单，供任何人参考。

*   卸载并重新安装 Brew（它不会更新到 0.9 `brew update`，因此需要手动重新安装）
*   安装 @Joe 提到的不再包含的 GCC 编译器 - chown /Library/Caches 目录
*   安装 MySQL
*   安装 X11
*   更新 Gemfile 以使用 'therubyracer' gem "therubyracer", "~> 0.11.0beta5" 的 beta 版本
*   修复 Nokigiri 和 LibXML 冲突的问题，如下所述： [警告：Nokogiri 是针对 LibXML 版本 2.7.3 构建的，但已动态加载 2.7.8](https://stackoverflow.com/questions/11452380/warning-nokogiri-was-built-against-libxml-version-2-7-3-but-has-dynamically-lo)

`bundle install`赢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T22:20:57.280

我有几个建议。`rvm`使用 Ruby 的系统版本或`rbenv`代替系统版本可能会有所帮助：

`/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby`

另一个建议是使用最新版本的 libv8 和将针对它进行编译的 therubyracer 的预发布版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T23:32:08.550

虽然它没有更新到最新的构建环境。（Xcode 4.4），按照 [这个答案（关于问题：使用 Xcode 4.3.1 在 Mac 上更新 Ruby 的问题）](https://stackoverflow.com/questions/9651670/issue-updating-ruby-on-mac-with-xcode-4-3-1/9651747#9651747)可能会有所帮助。

虽然 Xcode 版本不同，但基本设置相同。

我正在尝试使用 Xcode 4.4 构建环境，此时特定 gem(capybara-webkit) 存在小问题。将更新答案。

# wcf - 数据协定、共享类和 DTO 的 WCF 最佳实践

> ID：11677483
> 
> 赞同：3
> 
> 时间：2012-07-26T20:26:20.423
> 
> 标签：wcf, domain-driven-design, dto, datacontract

在我破坏我的应用程序之前，我当前的命名空间看起来像这样：

```
CompanyAbc.Core
CompanyAbc.AppXyz.Web
CompanyAbc.AppXyz.Business 
```

CompanyAbc.Core 命名空间包含我们公司所有应用程序使用的通用代码。一个例子是一个名为“ClientMessage”的类，我们用它作为容器将消息从一层传送到另一层（例如，在将数据保存到数据层时，抽象出来并支持显示成功或错误消息。 UI层）

我们现在将 CompanyAbc.AppXyz.Business 制作成 WCF 服务。我的问题是：“共享”（或不共享）这些基本/通用实体的最佳做法是什么？

例如，您是否会：

a) 将 [DataContract] 属性直接添加到 CompanyAbc.Core 命名空间中的类，即使它与 WCF 无关。

```
 CompanyAbc.Core.Entities
            ClientMessage.cs 
```

或者

b) 创建一个与 CompanyAbc.Core 命名空间完全相同的数据传输对象？

```
 CompanyAbc.Core.Entities
            ClientMessage.cs
   CompanyAbc.AppXyz.Business.DataContracts
            ClientMessageDto.cs 
```

或者

c) 其他选择？

另一个复杂性是我们打算共享这些程序集。但是为了强制解耦而不共享程序集/业务实体，你会全力以赴做这样的事情吗？

```
 CompanyAbc.Core
   CompanyAbc.Core.Shared.Entities
      ClientMessage.cs

   CompanyAbc.AppXyz.Web
   CompanyAbc.AppXyz.Web.Entities
      ClientMessage.cs --> derives from the Core.Shared, or just duplicate code?

   CompanyAbc.AppXyz.Business.Entities
      ClientMessage.cs --> derives from the Core.Shared, or just duplicate code?
   CompanyAbc.AppXyz.Business.DataContracts
      ClientMessageDto.cs 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-29T00:42:19.320

我建议您在程序集中创建“层次结构组”，以使其更简洁且使用更直观。例如：（以@learner 示例为基础）

```
ABC.Common (It communicates better the intention)
ABC.Core
ABC.Core.Web
ABC.Core.Windows
ABC.Services.DataContracts
ABC.Services.ServicesContracts 
```

等等 ...

建立一个清晰的层次结构会刺激开发人员使用它，因为它适合之前已经部署的程序集。查看 .NET 程序集以供参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:11:26.913

这是我的命名空间的样子，因为我到目前为止使用它：

```
ABC.Core
ABC.Data
ABC.Business
ABC.Web;
ABC.Services (common)
ABC.Services.DTO (common)
    ABC.Services.Svc1
        ABC.Services.Svc1.DTO
    ABC.Services.Svc2
        ABC.Services.Svc2.DTO 
```

在实践中，您不希望在服务之间有这么多共享类，因为它们可能希望彼此分开。彼此独立越好，您可以更好地对它们进行版本控制，但确实需要在每个服务的 DTO 级别中使用一些重复的代码。许多人使用 Automapper 将 Core 类投影到 DTO 中。

让我知道你的想法。

# java - PageAdapter，findViewById返回null，还有什么办法

> ID：11677485
> 
> 赞同：0
> 
> 时间：2012-07-26T20:26:49.363
> 
> 标签：java, android, android-layout

[我已经按照这篇文章](http://mobile.tutsplus.com/tutorials/android/android-user-interface-design-horizontal-view-paging/)的描述使用了 PageAdapter 。

在我的一个布局页面中有一个 ListView，我想在运行时在其中添加项目。通常我会这样做：-

```
lv = (ListView) findViewById(R.id.list); 
```

但这不起作用，因为没有设置 ContentView
**有没有其他方法可以获取列表视图**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:55:37.363

您必须使用 layoutinflator 来获取 setContent 视图未设置的视图，例如 ListView lv = Layoutinflator.from(mContext).inflate(R.id.list, null);

# c# - 减少位顺序逻辑

> ID：11677487
> 
> 赞同：4
> 
> 时间：2012-07-26T20:26:53.893
> 
> 标签：c#, logic, bit, flags

我有以下代码，我想知道是否有更简洁、简化的方法来编写此代码：

（FontStyle 是一个带有 Flags 属性的 .NET 枚举）

```
lblPrompt.Font.Style = FontStyle.Regular;

if (chkBold.Checked)
    lblPrompt.Font.Style |= FontStyle.Bold;
if (chkItalics.Checked)
    lblPrompt.Font.Style |= FontStyle.Italic;
if (chkUnderline.Checked)
    lblPrompt.Font.Style |= FontStyle.Underline; 
```

我觉得答案在于在 CheckBox.Checked 和所需标志之间正确应用 and & 运算符，类似于以下内容：

```
lblPrompt.Font.Style =
    (chkBold.Checked & FontStyle.Bold)
    | (chkItalics.Checked & FontStyle.Italic)
    | (chkUnderline.Checked & FontStyle.Underline); 
```

然而，这不起作用，因为编译器显然不喜欢我直接应用带有 bool 和 Flag/Enum 类型的 & 符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:31:39.080

沿着这些思路怎么样：

```
lblPrompt.Font.Style |=
    (chkBold.Checked ? FontStyle.Bold : 0)
    | (chkItalics.Checked ? FontStyle.Italic : 0)
    | (chkUnderline.Checked ?  FontStyle.Underline : 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:35:02.370

我能想到的唯一方法是使用三元运算符，如下所示：

```
lblPrompt.Font.Style = FontStyle.Regular
             | (chkBold.Checked      ? FontStyle.Bold      : FontStyle.Regular)
             | (chkItalics.Checked   ? FontStyle.Italic    : FontStyle.Regular)
             | (chkUnderline.Checked ? FontStyle.Underline : FontStyle.Regular); 
```

类似地缩进表达式的相似部分是我所做的一种风格化的事情，你没有义务将它带到你自己的代码中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:47:33.670

如果您有比这三个更多的选择，那么可能值得做一个表驱动的解决方案：

```
var table = new [] {
        new { box = chkBold, style = FontStyle.Bold },
        new { box = chkItalics, style = FontStyle.Italic },
        new { box = chkUnderline, style = FontStyle.Underline }
    };

foreach(var combo in table)
{
  if(combo.box.Checked) 
        lblPrompt.Font.Style |= combo.style;        
} 
```

这不一定更*简洁*，但它可以防止你重复自己。

# c++ - Doxygen 的 param[out]、引用和构造函数

> ID：11677488
> 
> 赞同：0
> 
> 时间：2012-07-26T20:26:58.753
> 
> 标签：c++, doxygen

请考虑以下示例：

```
class Example
{
    int &_m;

public:
    /**
     * An example constructor.
     *
     * @param myint Reference to some int.
     */
    Example(int& myint)
        : _m(myint)
    {
    }

    void change()
    {
        _m = 5;
    }
}; 
```

我应该标记`myint`参数`@param[out]`吗？构造函数本身不使用它作为输出参数，但是它存储在类中并且可以被`change()`方法修改。

以下经验法则是否有意义：`@param[in]`对于`const`指针和引用，`@param[in,out]`对于非指针和引用`const`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:30:34.533

该文档是为您和您班级的读者准备的，因此它应该提供最清楚正在发生的事情的信息。该对象似乎旨在写入引用。因此将其标记为`out`参数并非没有道理。如果它准确地传达了参考参数的预期用途，那么您应该这样使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:32:36.337

> 以下经验法则是否有意义：@param[in] 用于 const 指针和引用，@param[in,out] 用于非 const 指针和引用？

是的，但是如果您读取和写入引用对象，那么它是 [in,out]。如果你只是写，那么它是[out]。

# php - PHP通过href传递变量

> ID：11677492
> 
> 赞同：0
> 
> 时间：2012-07-26T20:27:14.637
> 
> 标签：php, href

我在将查询的参数传递到另一个页面时遇到了一点问题。

我想让餐厅的名称成为一个链接，该链接将传递产品名称以处理下一页上的查询。

```
echo "<p class='p2'><a class='link' href='restaurant.php?name=". $row['name'] ."'><strong>". $row['name'] ."</strong></a> 
```

在餐厅页面上

```
<?php
require ("db.php");
$name = $_GET['name'];

$query = "SELECT * FROM restaurant WHERE name =\"$name\"";
$result = mysql_query($query);
$row = mysql_fetch_array($result);   
?> 
```

但什么也没有显示。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:29:30.290

首先，请注意：您应该传递一个 ID 而不是名称，因为某些字符在 URL 中不是很好。

其次，尝试`urlencode()`在名称上使用。

```
echo "<p class='p2'><a class='link' href='restaurant.php?name=". urlencode($row['name']) ."'><strong>". $row['name'] ."</strong></a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:31:31.610

当然它不会显示任何内容，因为您的文件中没有任何`print`函数（echo、print、var_dump、...）。

* * *

无论如何，您可能认为您的查询不起作用。如果是这样，请尝试`echo`您的`$row['name']`. 如果一切正常，请检查您的变量是否已设置，但可能不是因为您获得了`null`.

要解决该问题，请使用[`isset()`](http://php.net/manual/en/function.isset.php)或[`empty()`](http://php.net/manual/en/function.empty.php)。

例子：

```
if(!empty($_GET['name'])) $name = $_GET['name'];
else die('Variable name is empty'); 
```

还可以尝试添加`ini_set('display_errors', true)`到页面顶部以查看是否有任何错误。

* * *

请注意，您的代码非常不安全且易受攻击。[`mysql_real_escape_string()`](http://php.net/manual/en/function.mysql-real-escape-string.php)在执行查询之前使用。

例子：

```
$name = mysql_real_escape_string($_GET['name']); 
```

# python - PySide Qt：TextEdit 小部件的自动垂直增长，以及垂直布局中小部件之间的间距

> ID：11677499
> 
> 赞同：9
> 
> 时间：2012-07-26T20:27:59.403
> 
> 标签：python, qt, qt4, pyqt, pyside

![在此处输入图像描述](../Images/bbe9b7c68b4ddcad59a156e772e5a5c3.png)

我需要用上面的小部件解决两个问题。

1.  我希望能够定义图像中显示的帖子小部件之间的空间量（它们看起来很好，但我想知道它已经完成了）。
2.  我想根据它们包含的文本量垂直增长文本编辑而不水平增长。

对于 1，填充小部件的代码如下：

```
self._body_frame = QWidget()
self._body_frame.setMinimumWidth(750)
self._body_layout = QVBoxLayout()
self._body_layout.setSpacing(0)
self._post_widgets = []
for i in range(self._posts_per_page):
    pw = PostWidget()
    self._post_widgets.append(pw)
    self._body_layout.addWidget(pw)

    self._body_frame.setLayout(self._body_layout) 
```

SetSpacing(0) 不会使事情变得更近，但是 SetSpacing(100) 确实会增加它。

**编辑**

（对于问题 2）我没有提到这一点，但我希望父小部件有一个垂直滚动条。

我已经回答了我自己的问题，但它罗嗦，并且基于因果关系。一个适当的写得很好的教程风格的答案来解决这两点得到赏金：D

**编辑 2**

在下面使用我自己的答案，我已经解决了这个问题。我现在将接受我自己的答案。

![在此处输入图像描述](../Images/b2c69998874e7b459a1e7bbc3b96c3dc.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-01T17:29:57.203

## 1) 布局

此处的另一个答案非常不清楚，并且可能与布局边距的工作方式有关。它实际上非常简单。

1.  布局有内容边距
2.  小部件具有内容边距

这两个都定义了围绕它们包含的内容的填充。布局上的边距设置为 2 意味着所有边都有 2 个像素的填充。如果您有父子小部件和布局（在您编写 UI 时总是如此），则每个对象都可以有特定的边距，这些边距单独生效。也就是说...指定边距为 2 的父布局，指定边距为 2 的子布局将有效地显示 4 个像素的边距（如果小部件有框架，则显然在其间绘制一些框架。

一个简单的布局示例说明了这一点：

```
w = QtGui.QWidget()
w.resize(600,400)

layout = QtGui.QVBoxLayout(w)
layout.setMargin(10)
frame = QtGui.QFrame()
frame.setFrameShape(frame.Box)
layout.addWidget(frame)

layout2 = QtGui.QVBoxLayout(frame)
layout2.setMargin(20)
frame2 = QtGui.QFrame()
frame2.setFrameShape(frame2.Box)
layout2.addWidget(frame2) 
```

![布局图像示例](../Images/16a8891a0025ac7df6c3cb9e4807a7bd.png)

可以看到顶层边距每边10，子布局每边20。在数学方面没有什么复杂的。

保证金也可以在每边的基础上指定：

```
# left: 20, top: 0, right: 20, bottom: 0
layout.setContentsMargins(20,0,20,0) 
```

还可以选择在布局上设置间距。间距是放置在布局的每个子项之间的像素量。将其设置为 0 意味着它们相互对立。间距是布局的一个特征，而边距是整个对象的一个​​特征。布局可以在其周围有边距，并且在其子级之间也可以有间距。而且，小部件的子级可以有自己的边距，这些边距是它们各自显示的一部分。

```
layout.setSpacing(10) # 10 pixels between each layout item 
```

## 2) 自动调整 QTextEdit

现在是你问题的第二部分。我确信有几种方法可以创建自动调整大小的 QTextEdit。但一种方法是观察文档中的内容变化，然后根据文档高度调整小部件：

```
class Window(QtGui.QDialog):

    def __init__(self):
        super(Window, self).__init__()
        self.resize(600,400)

        self.mainLayout = QtGui.QVBoxLayout(self)
        self.mainLayout.setMargin(10)

        self.scroll = QtGui.QScrollArea()
        self.scroll.setWidgetResizable(True)
        self.scroll.setVerticalScrollBarPolicy(QtCore.Qt.ScrollBarAlwaysOn)
        self.mainLayout.addWidget(self.scroll)

        scrollContents = QtGui.QWidget()
        self.scroll.setWidget(scrollContents)

        self.textLayout = QtGui.QVBoxLayout(scrollContents)
        self.textLayout.setMargin(10)

        for _ in xrange(5):
            text = GrowingTextEdit()
            text.setMinimumHeight(50)
            self.textLayout.addWidget(text)

class GrowingTextEdit(QtGui.QTextEdit):

    def __init__(self, *args, **kwargs):
        super(GrowingTextEdit, self).__init__(*args, **kwargs)  
        self.document().contentsChanged.connect(self.sizeChange)

        self.heightMin = 0
        self.heightMax = 65000

    def sizeChange(self):
        docHeight = self.document().size().height()
        if self.heightMin <= docHeight <= self.heightMax:
            self.setMinimumHeight(docHeight) 
```

我对`QTextEdit`->进行了子类`GrowingTextEdit`化，并将从其文档发出的信号连接到一个`sizeChange`检查文档高度的插槽。我还包括了一个 heightMin 和 heightMax 属性，让您可以指定它允许自动增长的大小。如果您尝试一下，您会看到当您在框中键入时，小部件将开始自行调整大小，并且在您删除行时也会缩小。如果需要，您也可以关闭滚动条。现在，除了父滚动区域之外，每个文本编辑都有自己的栏。另外，我认为您可以向 中添加一个小的 pad 值，`docHeight`以便它扩展得刚好足以不显示内容的滚动条。

这种方法并不是真正的低级。它使用小部件的常用信号和子成员来接收状态更改的通知。利用信号扩展现有小部件的功能是很常见的。

![自动增长小部件示例图片](../Images/417aa1c68e6cfaf53532f60e3dad0a1f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T22:18:36.750

解决问题 1：

除了布局本身的间距参数外，父控件和布局都有边距。从某些原因和影响测试 显然，边距既适用于父区域的外部区域，也适用于内部区域。

因此，例如，如果为父级指定了 2 像素的边距，则垂直边框`<--2 pixel | 2 pixel -->`除了布局的边距外还有边距（在这种情况下为 HBoxLayout）。如果布局也有 2 像素的边距，那么水平线周围的区域将如下所示：

`<-- 2 pixel | 2 pixel --> <-- 2 pixel (L) 2 pixel--> (W)`

**编辑**也许更像这样：`| 2 pixel --> (L) 2 pixel --> <-- 2 pixel (W)`

其中`|`父级`(L)`的竖线是Layout的竖线，`(W)`是水平布局中嵌入widget的边框。

布局的间距是一个附加参数，它控制在布局的小部件之间插入多少空间以及任何布局边距。

上面的描述可能不准确（所以请随意编辑它不准确的地方），但是将父级和布局的边距设置为零以及布局间距为零会产生您所追求的结果。

对于第 2 点：

我认为没有直接的方法来解决这个问题（您可能不得不求助于较低级别的挂钩，这需要对 API 有更深入的了解）。我认为您应该使用`QLabel`小部件而不是`QTextEdit`小部件。标签没有视图，因此可以根据需要扩展，至少默认情况下它们是这样工作的，只要父对象的移动不受限制。

因此，更改`QTextEdit`to`Qlabel`并向父级添加滚动视图，一切都应该按您的意愿工作。我有一种感觉，你选择`QTextEdit`它是因为它的背景。研究 HTML 在 QT 小部件中的工作方式，您也许可以通过 HTML 更改背景。

**编辑**

![在此处输入图像描述](../Images/4b8b2d80b7d042480633dad782c41f61.png)

这个小部件（请原谅大小）是由带有 PyQT 的 OS X 上的以下代码创建的：

```
import sys
from PyQt4 import Qt

class PostMeta(Qt.QWidget):
    posted_at_base_text = "<b> Posted At:</b>"
    posted_by_base_text = "<b> Posted By:</b>"

    def __init__(self):
        Qt.QWidget.__init__(self)
        self._posted_by_label = Qt.QLabel()
        self._posted_at_label = Qt.QLabel()
        layout = Qt.QVBoxLayout()
        layout.setMargin(0)
        layout.setSpacing(5)
        layout.addWidget(self._posted_by_label)
        layout.addWidget(self._posted_at_label)
        layout.addStretch()
        self.setLayout(layout)
        self._posted_by_label.setText(PostMeta.posted_by_base_text)
        self._posted_at_label.setText(PostMeta.posted_at_base_text)

class FramePost(Qt.QFrame):
    def __init__(self):
        Qt.QFrame.__init__(self)
        layout = Qt.QHBoxLayout()
        layout.setMargin(10)
        self.te = Qt.QLabel()
        self.te.setStyleSheet("QLabel { background : rgb(245,245,245) }")
        self.te.setFrameStyle( Qt.QFrame.Panel |  Qt.QFrame.Sunken)
        self.te.setLineWidth(1)
        self._post_meta = PostMeta()
        layout.addWidget(self._post_meta)
        vline = Qt.QFrame()
        vline.setFrameShape(Qt.QFrame.VLine)
        layout.addWidget(vline)
        layout.addWidget(self.te)
        self.te.setText(
            """            line one
            line two
            line three
            line four
            line five
            line six
            line seven
            line eight
            line nine
            line ten
            line eleven
            line twelve
            line thirteen""")
        self.setLayout(layout)

        self.setFrameStyle(Qt.QFrame.Box)
        self.setLineWidth(2)

app = Qt.QApplication(sys.argv)
w = Qt.QWidget()
layout = Qt.QHBoxLayout()
fp = FramePost()
layout.addWidget(fp)
w.setLayout(layout)
w.show()
app.exec_() 
```

左侧小部件中的标签显示了已完成的间隔和边距调整，我已将 a`QLabel`用于发布文本。请注意，我已调整标签使其看起来更像默认标签`QTextEdit`

# c# - 正则表达式 - 积极的前瞻在某些情况下不起作用

> ID：11677500
> 
> 赞同：2
> 
> 时间：2012-07-26T20:28:02.983
> 
> 标签：c#, regex

我正在遍历一组 C# 关键字，并为每个关键字应用一个正则表达式。（我正在研究语法高亮。）

我只想匹配，如果：

*   关键字是该行的第一个单词**或**前面的字符是空格、句点或左括号

    **和**

*   关键字后面的字符是空格、句点或左括号。

这是我想出的：

```
 foreach (string keyword in keyWords)
    {
        regex = new Regex(@"(?<=[\s\.(])" + keyword + @"(?=[\s\.(])");
        foreach (Match match in regex.Matches(code))
        {
            code = code.Replace(match.Value, "<span class='keyword'>" + match.Value + "</span>");
        }
    } 
```

因此，在以下文本的情况下：

**“foreach（ss 中的字符串 s）{}”**

单词“foreach”匹配，但关键字“in”嵌套在单词“string”匹配 - 但这不好，因为之前和之后的字符不匹配标准。

有趣的是，在以下文本的情况下：

**“xforeachx（ss 中的字符串 s）{}”**

“foreach”这个词不匹配。

那么为什么“string”这个词中的“in”匹配，而第二个例子中的“foreach”却不匹配呢？我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:01:07.020

这是我在评论中引用的一个非常简单的演示：

```
StringBuilder sb = new StringBuilder();
sb.AppendLine("using System;");
sb.AppendLine();
sb.AppendLine("namespace Foo.Bar");
sb.AppendLine("{");
sb.AppendLine("\tpublic class Baz");
sb.AppendLine("\t{");
sb.AppendLine("\t\tpublic static void Main()");
sb.AppendLine("\t\t{");
sb.AppendLine("\t\t\tString[] a = new[]{\"foo\",\"bar\",\"baz\"};");
sb.AppendLine("\t\t\tforeach (var b in a) Console.WriteLine(b);");
sb.AppendLine("\t\t}");
sb.AppendLine("\t}");
sb.AppendLine("}");

Console.Write(sb.ToString());
Console.WriteLine();

String[] keywords = new String[]{
  "using", "namespace", "for", "if", "else", "foreach"
};
String code = sb.ToString();
foreach (String keyword in keywords){
  String pattern = @"(?<=^|[\s\.\(])(" + Regex.Escape(keyword) + @")(?=[\s\.\)])";
  String replacement = "<span class='keyword'>$1</span>";
  code = Regex.Replace(code, pattern, replacement);
}
Console.WriteLine(code); 
```

导致：

```
<span class='keyword'>using</span> System;

<span class='keyword'>namespace</span> Foo.Bar
{
  public class Baz
  {
    public static void Main()
    {
      String[] a = new[]{"foo","bar","baz"};
      <span class='keyword'>foreach</span> (var b in a) Console.WriteLine(b);
    }
  }
} 
```

这就是我*认为*你所追求的。我使用了静态正则表达式方法，但您可以根据需要重构它。我想指出一些事情：

*   我强烈建议[`Regex.Escape`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape.aspx)您在不是自己构建的正则表达式语句中间插入值时使用。即使关键字只是字母，以后的一些更改也可能会破坏它。安全总比后悔好。
*   如果您打算使用 Regex 来查找关键字，也可以使用它来替换它。这可确保如果找到“for”（并且是关键字），则替换*该*for 实例（带有look(ahead|behind) 验证，而不是在字符串中找到杂散的“for”（也许它们有一个名为`foreshadow` - 谁知道。
*   我稍微修改了您的后视功能，以包括`^|`匹配行首或在类中找到的内容。
*   我还稍微修改了您的模式以包含一个捕获组，以便替换有一些东西可以定位。

# android - 使用已使用的 id (`contentview`) 注册组件。确保现有 cmpnt 已被销毁`Ext.Component#destroy()

> ID：11677507
> 
> 赞同：0
> 
> 时间：2012-07-26T20:28:23.450
> 
> 标签：android, sencha-touch, sencha-touch-2

出错

```
[WARN][Ext.Component#constructor] Registering a component with a id (`contentview`) which has already been used. Please ensure the existing component has been destroyed (`Ext.Component#destroy()`. 
```

我的问题是，如果我直接使用 json 加载联系人页面，它会显示正常，并且 ontap 也可以正常工作。但是，如果我在此联系人页面之前添加一个登录屏幕，例如如果登录成功，我会将登录页面重定向到联系人页面。在这种情况下，在该列表的 ontap 上出现错误。

在我的联系人视图中，一旦我从联系人视图中选择一个列表项，我就会在联系人视图中获得一个列表，我必须在显示页面中获取详细信息。这就是我正在尝试做的事情，但是出现错误请检查这个。

我的视图文件是

```
Ext.define(
'AddressBook.view.Contacts',
{
    extend : 'Ext.List',
    xtype : 'contacts',
     requires: ['AddressBook.view.contact.Show'],
    config : {
        title : 'Address Book',
        cls : 'x-contacts',
        store : 'Contacts',
        itemTpl : [
                '<div class="deal"><div class="headshot" style="background-image:url({offer_image});"></div>',
                '<div class="name">{title}, {location}</div>',
                '<div class="endtime">{startTime}</div></div>'].join(''),
        items : [{
            xtype : "toolbar",
            docked:"top",
            title : '<img src="resources/images/logo.png" width="130px"/>  '
        }]
    }
}); 
```

显示列表项详细信息：

```
Ext.define('AddressBook.view.contact.Show', {
    extend: 'Ext.Container',
    xtype: 'contact-show',

    config: {
        title: 'Information',
        baseCls: 'x-show-contact',
        layout: 'vbox',

        items: [
            {
                id: 'contentview',
                tpl: [
                    '<div class="top">',
                        '<div class="headshot" style="background-image:url({offer_image});"></div>',
                        '<div class="name">{location} {lastName}<span>{title}</span></div>',
                    '</div>'
                ].join('')
            }
        ],

        record: null
    },

    updateRecord: function(newRecord) {
        if (newRecord) {
            this.down('#contentview').setData(newRecord.data);
        }
    }
}); 
```

我的控制器上的 ontap 事件：

```
 onContactSelect: function(list, index, node, record) {
       this.showContact = Ext.create('AddressBook.view.contact.Show');
        // Bind the record onto the show contact view
        this.showContact.setRecord(record);

        // Push the show contact view into the navigation view
        this.getMain().push(this.showContact);
    }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T09:15:25.737

在 app.js 文件中声明新视图

# neural-network - 为什么 sigmoid 函数在神经网络中起作用？

> ID：11677508
> 
> 赞同：22
> 
> 时间：2012-07-26T20:28:29.313
> 
> 标签：neural-network, backpropagation

我刚刚开始为神经网络编程。我目前正在研究反向传播 (BP) 神经网络的工作原理。虽然在 BP 网络中训练的算法非常简单，但我找不到任何关于该算法为何有效的文本。更具体地说，我正在寻找一些数学推理来证明在神经网络中使用 sigmoid 函数的合理性，以及是什么让它们模仿了几乎所有扔给它们的数据分布。

谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-27T07:24:57.597

sigmoid 函数在网络中引入了非线性。如果没有非线性激活函数，网络只能学习作为其输入线性组合的函数。结果被称为`universal approximation theorem`or `Cybenko theorem`，以 1989 年证明它的那位先生的名字命名。[维基百科](http://en.wikipedia.org/wiki/Universal_approximation_theorem)是一个很好的起点，它有一个指向原始论文的链接（虽然证明有点涉及）。使用 sigmoid 而不是其他东西的原因是它是连续且可微的，它的导数计算速度非常快（与具有相似属性的 tanh 的导数相反）并且范围有限（从 0至 1，独占）

# json - Backbone.js 在集合上使用 fetch() 不返回模型、200 OK 和空响应

> ID：11677512
> 
> 赞同：0
> 
> 时间：2012-07-26T20:28:46.897
> 
> 标签：json, backbone.js, fetch

我正在使用 Backbone.js 构建一个评论对象。集合中的 URL 返回如下所示的 json：

```
 {'type': 'comment', 
        'data': [{"body": "commment number 1!", 
                "create_dt": 1343166264000, 
                "comment_id": 1, "depth": 0, 
                "user": {"sid": "1", 
                    "uid": "1", 
                    "name": "Amie C", 
                    "level": "2"}, 
                "sid": 1
                }, 
                {"body": "commment number 1-1!", 
                "create_dt": 1343166361000, 
                "comment_id": 4, 
                "depth": 1, 
                "user": {"sid": "1", 
                        "uid": "1", 
                        "name": "lila M", 
                        "level": "2"}, 
                "sid": 1}
                }]
        } 
```

该网址在浏览器中有效，我能够看到我所有的 json 都回来了。但是，我遇到的问题是加载comment.js 时没有数据返回。我会看到一个红色但显示 200 OK 并且响应中没有正文的 Get 请求。我的模型的长度也是0。

非常感谢先进。

这是comment.js：

```
 //default comment model
    var Comment = Backbone.Model.extend({
        defaults: {
            body: "",
            create_dt: null,
            comment_id: null,
            depth: null,
            user: null,
            sid: null
        }
    });

    //instaitiate a new comment
    var comment = new Comment;

    //default event view
    var CommentView = Backbone.View.extend({
        tagName: "li",
        className: "comment",
        initialize: function(){
            this.render();
        },
        render: function(){
            $(this.el).html(this.model.toJSON());
            return this;
        }
    });

    //default comments collection
    var Comments = Backbone.Collection.extend({
        model: Comment,
        initialize: function(){
        },
        url:"http://127.0.0.1/test/objects/json/comments.json",
        parse: function(resp) {
            return resp.data;
        }
    });

    //default eventsview for events collection's view
    var CommentsView = Backbone.View.extend({
        tagName: "ul",
        className:"comments",
        intialize: function(){
            this.render();
        },
        render: function(){
            _.each(this.collection.models, function(comment){
                //init the CommentView and passed in its model here
                var commentView = new CommentView({model: comment});
                $(this.el).prepend(commentView.render().el)
            }, this);

            return this;
        }
    });

    //instantiate new events collection
    var comments = new Comments;
    var commentsView = new CommentsView({collection: comments});

    //on the new events collection, we fetch the data from URL
    comments.fetch({
        error:function(response, xhr){
            console.log(response);
            console.log(xhr)
        },
        success:function(){
            console.log("success");
            $('.comments_container').html(commentsView.render().el);
        }
    }); 
```

html看起来像这样：

```
 <!DOCTYPE html>
    <head>
      <meta charset="utf-8">
        <title>Share</title>
        <link rel="stylesheet" href="share.css" type="text/css"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script src="http://documentcloud.github.com/underscore/underscore-min.js"></script>
        <script src="http://backbonejs.org/backbone-min.js"></script>​
        <script src="js/comment.js"></script>
    </head>
    <body>
        <div class="main_app">
            <div class="comments_container"></div>
        </div>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:18:21.340

我认为的问题在这里`CommentView`：

```
 render: function(){
        $(this.el).html(this.model.toJSON());
        return this;
    } 
```

`this.model.toJSON()`不返回字符串，因此当您将其直接放入 html 时不会显示。

试试这个：

```
 $(this.el).html(JSON.stringify(this.model)); 
```

# ruby-on-rails - “不包含在列表中”当 fields_for 为一对多时

> ID：11677515
> 
> 赞同：1
> 
> 时间：2012-07-26T20:29:08.803
> 
> 标签：ruby-on-rails

这是在rails 2.3上。我剪掉了一堆代码，希望能解决问题。当我在具有 1 个或多个 EmailPreferences 的用户对象上单击保存时，我得到

1 个错误禁止保存此用户

以下字段存在问题：

通知类型未包含在列表中

```
class User < ActiveRecord::Base
  has_many :email_preferences
  accepts_nested_attributes_for :email_preferences
  attr_accessible :email_preferences_attributes
end

class EmailPreference < ActiveRecord::Base
  # receives is a boolean, notification_type is a string.
  attr_accessible :user_id, :receives, :notification_type
  belongs_to :user
end

class UsersController < ApplicationController
  def new
    @user = User.new
    @user.email_preferences.build :receives=>false, :notification_type=>"outage"
  end

  def edit
    @user = User.find(params[:id])
  end
end

# app/views/user/_form.rhtml
<% form_for :user, user do |f| -%>
  <% f.fields_for :email_preferences do |preference_form| -%>
    <dd>
      <%= preference_form.check_box :receives %>
      <!-- I just want to display the notification type. I do not want to edit it. -->
      <%= preference_form.object.notification_type %>
    </dd>
  <% end -%>
  <%= form_submit f.object, :cancel => companies_path %>
<% end -%> 
```

*编辑*

更好的是，您将如何调试没有那么有用的错误消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:45:49.720

好吧，添加隐藏输入似乎确实有效。如果电子邮件首选项已经在数据库中，Rails 看起来也不需要隐藏的 notification_type。所以也许规则是对于新的子对象，您需要包含所有必需的字段。

```
<% f.fields_for :email_preferences do |preference_form| -%>
  <dd>
    <%= preference_form.check_box :receives %>
    <!-- I just want to display the notification type. I do not want to edit it. -->
    <%= preference_form.object.name %>
    <%= preference_form.hidden_field :notification_type %>
  </dd>
<% end -%> 
```

# c# - 使用多个带有继承的基本页面是正确的选择吗？

> ID：11677519
> 
> 赞同：4
> 
> 时间：2012-07-26T20:29:13.320
> 
> 标签：c#, asp.net

我应该使用具有继承的多个基本页面还是有更好的策略？

人为的例子：

目前我有 20 个网页，它们都使用我的基本页面“BasePage”。

即）Page1：BasePage

BasePage 提供的功能：

*   函数1()
*   函数2()
*   函数3()

现在我决定我的 20 个网页中有 5 个需要 BasePage 函数以及 3 个附加函数和一个 Page_Load()：

*   函数4()
*   函数5()
*   函数6()
*   Page_Load()

我现在是否创建另一个像这样的基本页面：

MySecondBasePage : BasePage

然后把Function4()、Function5()、Function6()和Page_Load()放进去？

还是有更好/“适当”的策略来做到这一点？我应该使用课程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T13:24:25.387

是的，在您的情况下，创建`MySecondBasePage`继承自`BasePage`似乎是正确的方法。然后，在 5 个“特殊”页面中，您继承`MySecondBasePage`而不是`BasePage`.

这是适合您情况的正确类层次结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T13:30:00.323

是的。

继承不仅仅是关于重用（因为我们有其他方法可以做到这一点），而且还涉及管理复杂性。这是一个很好的简单层次结构（假设您的真实姓名比“SecondPageBase”好一点）将有助于清楚发生的事情在哪里以及为什么发生。

# ios - 如何将 UTC 日期字符串转换为本地时间 (systemTimeZone)

> ID：11677520
> 
> 赞同：12
> 
> 时间：2012-07-26T20:29:26.117
> 
> 标签：ios, objective-c, swift, date, timezone

输入字符串：2012 年 6 月 14 日 - 01:00:00 UTC

输出本地字符串：2012 年 6 月 13 日 - 21:00:00 EDT

我喜欢从

```
NSTimeZone* destinationTimeZone = [NSTimeZone systemTimeZone];
NSLog(@"Time Zone: %@", destinationTimeZone.abbreviation); 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-26T20:56:52.033

这应该做你需要的：

```
NSDateFormatter *fmt = [[NSDateFormatter alloc] init];
fmt.dateFormat = @"LLL d, yyyy - HH:mm:ss zzz";
NSDate *utc = [fmt dateFromString:@"June 14, 2012 - 01:00:00 UTC"];
fmt.timeZone = [NSTimeZone systemTimeZone];
NSString *local = [fmt stringFromDate:utc];
NSLog(@"%@", local); 
```

请注意，您的示例不正确：UTC 时间 6 月 14 日凌晨 1 点，美国东部标准时间 6 月 13 日仍然是 6 月 13 日，标准时间晚上 8 点或夏令时晚上 9 点。在我的系统上，这个程序打印

```
Jun 13, 2012 - 21:00:00 EDT 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-15T11:06:51.183

**斯威夫特 3**

```
var dateformat = DateFormatter()
dateformat.dateFormat = "LLL d, yyyy - HH:mm:ss zzz"
var utc: Date? = dateformat.date(fromString: "June 14, 2012 - 01:00:00 UTC")
dateformat.timeZone = TimeZone.current
var local: String = dateformat.string(from: utc)
print(local) 
```

**Swift 4** : 日期扩展 UTC 或 GMT ⟺ 本地

```
//UTC or GMT ⟺ Local 

extension Date {

    // Convert local time to UTC (or GMT)
    func toGlobalTime() -> Date {
        let timezone = TimeZone.current
        let seconds = -TimeInterval(timezone.secondsFromGMT(for: self))
        return Date(timeInterval: seconds, since: self)
    }

    // Convert UTC (or GMT) to local time
    func toLocalTime() -> Date {
        let timezone = TimeZone.current
        let seconds = TimeInterval(timezone.secondsFromGMT(for: self))
        return Date(timeInterval: seconds, since: self)
    }

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-26T20:36:54.957

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
dateFormatter.dateFormat = @"MMMM d, yyyy - HH:mm:ss zzz"; // format might need to be modified

NSTimeZone* destinationTimeZone = [NSTimeZone systemTimeZone];
[dateFormatter setTimeZone:destinationTimeZone];

NSDate *oldTime = [dateFormatter dateFromString:utcDateString];

NSString *estDateString = [dateFormatter stringFromDate:oldTime]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T20:36:01.483

这从 GMT 转换为本地时间，您可以将其修改为 UTC 时间

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init]; 
dateFormatter.dateFormat = @"yyyy-MM-dd'T'HH:mm";

NSTimeZone *gmt = [NSTimeZone timeZoneWithAbbreviation:@"GMT"]; 
[dateFormatter setTimeZone:gmt]; 
NSString *timeStamp = [dateFormatter stringFromDate:[NSDate date]]; 
[dateFormatter release]; 
```

取自[iPhone：NSDate 将 GMT 转换为本地时间](https://stackoverflow.com/questions/3901474/iphone-nsdate-convert-gmt-to-local-time)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-06T10:28:45.383

```
func timeConverter() -> 
{
    let zone = TimeZone.current
    let sec = -TimeInterval(zone.secondsFromGMT(for: self)
    return Date(timeInterval: sec , since : self)
} 
```

# redirect - 页面似乎已被黑客入侵，我如何找到导致它的代码？

> ID：11677521
> 
> 赞同：0
> 
> 时间：2012-07-26T20:29:26.197
> 
> 标签：redirect

我似乎找不到 JS 代码，我尝试在源代码中搜索 url，但似乎找不到任何可以解释重定向的内容。等待一秒钟后，页面会自动重定向。

此外，看起来无法转到上一页，这很奇怪。

有什么方法可以让我获得执行该重定向的实际 JS 行，还是有其他原因导致这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T21:14:29.503

可以使用元标记在不使用任何 JavaScript 的情况下进行延迟重定向。

```
<META HTTP-EQUIV="refresh" CONTENT="seconds;URL=the-other-url"> 
```

例如，这将在 2 秒后重定向...

```
<HTML>
<HEAD>
<!-- stuff here -->
    <META HTTP-EQUIV="refresh" CONTENT="2;URL=http://www.{somesite.com}/xxxxxx">
<!-- more stuff -->
</HEAD>
<BODY>
<!-- yet more stuff -->
</BODY>
</HTML> 
```

您可以在此处阅读有关该标签的更多信息：http: [//www.internetofficer.com/seo/html-redirect/](http://www.internetofficer.com/seo/html-redirect/)

# php - Mod-Rewrite 和 .htaccess 问题

> ID：11677523
> 
> 赞同：0
> 
> 时间：2012-07-26T20:29:39.110
> 
> 标签：php, apache, .htaccess, mod-rewrite

Mod_Rewrite 有一些问题。我必须承认这是我第一次尝试这个模块，所以我可能会遇到一些愚蠢的事情。我一直试图让它自己工作一天左右，我不知道为什么这不起作用。

我收到以下错误：

**注意：未定义索引：第 31 行 D:\wamp\www\WildForFashion\Portal\Index.php 中的目录**

我想要完成的是能够拥有一个模板页面 (index.php) 并让 Mod_Rewrite 为我更改 url，以便它可以搜索友好并简化编码和设计。

当根本没有加载图像/ CSS文件时，我也遇到了问题，我确实读到使用绝对 url 会起作用。

截至目前，我首先在 PORTAL 目录中工作（这是一个用于网站维护的管理页面），然后将移动到根目录。我不确定是否需要一个或两个 .htaccess 文件（一个在根目录中，第二个在门户目录中）。

DIR 文件夹用于保存网站的每个类别和页面，如下所示：

```
Domain.com/{CATAGORY}/{PAGE}/
ROOT / DIR / {CATAGORY} / {Page}.php

Domain.com/Portal/{CATAGORY}/{PAGE}/
ROOT / Portal / DIR / {CATAGORY} / {Page}.php 
```

### .htaccess 之前

```
RewriteEngine on
RewriteRule ^/Portal/$      Portal/Index.php?Dir=Portal&Page=Home   [L,QSA]
RewriteRule ^Portal/(.*)/(.*)$  Portal/Index.php?Dir=$1&Page=$2 [L,QSA]
RewriteRule ^Portal/(.*)/$      Portal/Index.php?Dir=$1&Page=Home   [L,QSA] 
```

### .htaccess 之后（使用例外情况）

```
RewriteEngine on
RewriteRule Portal/$     Portal/Index.php?Dir=Portal&Page=Home   [L,QSA]
RewriteRule Portal/([^/]+)/$     Portal/Index.php?Dir=$1&Page=Home   [L,QSA]
RewriteRule Portal/([^/]+)/([^/]+)/$     Portal/Index.php?Dir=$1&Page=$2 [L,QSA] 
```

### 索引.php

```
<?php
include_once("DIR/" . $_GET['Dir'] . "/" . $_GET['Page'] . ".php");
?> 
```

### 目录树

> *   CSS
> *   目录
> *   IMG
> *   JS
> *   SRC
> *   门户网站
>     *   CSS
>     *   目录
>         *   门户网站
>         *   存货
>         *   统计数据
>         *   订单
>     *   IMG
>     *   JS
>     *   SRC
>     *   索引.php
>     *   .htaccess
> *   索引.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:33:09.843

您在不需要存在的匹配规则中包含正斜杠，并将它们从需要存在的重定向路径中排除。尝试这个：

```
RewriteRule Portal/$      Portal/Index.php?Dir=Portal&Page=Home   [L,QSA]

RewriteRule Portal/(.*)/(.*)$  Portal/Index.php?Dir=$1&Page=$2 [L,QSA]

RewriteRule Portal/(.*)/$      Portal/Index.php?Dir=$1&Page=Home   [L,QSA] 
```

请注意，我从重写规则的匹配部分中删除了 ^，因为这表明 taht 应该是 URI 的开头。我还删除了替换模式前面的“/”。

# sql-server - 将值传递给派生表

> ID：11677527
> 
> 赞同：3
> 
> 时间：2012-07-26T20:29:46.747
> 
> 标签：sql-server, tsql, derived-table

有没有办法将值传递给派生表查询？

在派生表中，我想`([docSVsys].[sID])`从外部查询中引用一个值。

我收到一个错误：

> 消息 4104，级别 16，状态 1，第 7 行 无法绑定多部分标识符“docSVsys.sID”。

是的，我知道这个查询可以简化为无循环。
有一个游标必须循环并尝试将其转换为如此设置。

```
select top 10 [docSVsys].[sID], [sI].[count]
from docSVsys 
join 
(
    select count(*) as [count]   
    from docSVenum1 as [sIt]
    where  [sIt].[sID] = [docSVsys].[sID] 
) as [sI] 
on  '1' = '1'
order by [docSVsys].[sID] 
```

交叉应用似乎可以解决问题。它比游标版本快 1/3。下面使用交叉应用的真实查询。

```
SELECT [sO].[sID], [sI].[max], [sI].[avg], [sI].[stdev]
FROM docSVsys as [sO] with (nolock)
cross apply 
( 
    select [sO].[sID], max(list.match) as 'max', avg(list.match) as 'avg', stdev(list.match) as 'stdev'
    from
    (
        select #SampleSet.[sID], [match] = 200 * count(*) / CAST ( #SampleSetSummary.[count] + [sO].[textUniqueWordCount]  as numeric(8,0) ) 
        from #SampleSet with (nolock) 
        join FTSindexWordOnce as [match] with (nolock) -- this is current @sID
            on match.wordID  = #SampleSet.wordID
            and [match].[sID] = [sO].[sID]
        join #SampleSetSummary with (nolock)  -- to get the word count from the sample set
            on #SampleSetSummary.[sID] = #SampleSet.[sID] 
        group by #SampleSet.[sID], #SampleSetSummary.[count] 
    ) as list
    having max(list.match) > 60 
) as [sI]  
where [textUniqueWordCount] is not null and [textUniqueWordCount] > 4 and [sO].[sID] <= 10686
order by [sO].[sID] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:46:33.190

您可以使用 CROSS APPLY 而不是 JOIN 来做您想做的事情：

```
select top 10 [docSVsys].[sID], [sI].[count] 
from docSVsys  
cross apply 
( 
    select count(*) as [count]    
    from docSVenum1 as [sIt] 
    where  [sIt].[sID] = [docSVsys].[sID]  
) as [sI]  
order by [docSVsys].[sID] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:32:41.363

将 ID 添加到派生表中，然后加入该表：

```
select top 10 [docSVsys].[sID], [sI].[count]
from docSVsys 
join 
(
     select [sIt].[sID], count(*) as [count]   
     from docSVenum1 as [sIt]
     group by [sIt].[sID]
) as [sI] 
on [sI].[sID] = [docSVsys].[sID] 
order by [docSVsys].[sID] 
```

# sql-server - 尝试使用集成安全性设置 IIS7 以进行远程 sql 服务器访问

> ID：11677529
> 
> 赞同：1
> 
> 时间：2012-07-26T20:29:48.480
> 
> 标签：sql-server, security, iis-7, integrated

我有一个 Intranet 站点，我正在尝试设置为使用 Windows 身份验证并通过远程 SQL 服务器模拟用户。我过去已经设置了这些，但是 Web 服务器和 SQL 服务器一直在同一个盒子上。我已经搜索了谷歌尝试不同的设置，但我得到密码提示或用户“NT AUTHORITY\ANONYMOUS LOGON”的登录失败（用户的身份在网站上是正确的，但它没有通过 SQL 进行身份验证，因为它认为它是匿名的）。以下是我的设置，因此非常感谢任何见解。

网络配置

```
<authentication mode="Windows" />
<authorization>
    <allow users="*" />
</authorization>
<identity impersonate="true" /> 
```

IIS7

```
Anonymouse Authentication - Disabled
ASP.NET Impersonation - Enabled
Basic Authentication - Disabled
Forms Authentication - Disabled
Windows Authentication - Enabled
- Advanced Settings: Extended Protection=Off and Enable Kernal-mode authentication=Checked
- Providers: Negotiate and NTLM (I came across a blog to use Negotiate:Kerberos but that didn't work) 
```

连接字符串

```
SqlConnection m_oConnection = new SqlConnection("Data Source=" + ConfigurationServer + ";Failover Partner=" + ConfigurationServerFailover + ";Initial Catalog=Master;Trusted_Connection=Yes;persist security info=False;"); 
```

我遇到了另一篇文章，让网络管理员更改 IIS 服务器的 Active Directory 记录，说“信任这台计算机进行委派”。还是不行。

有没有办法让我在没有密码提示的情况下使用 Windows 身份验证将安全性集成到远程 SQL 服务器的 ASP.NET 应用程序中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:20:44.777

我们的网络管理员最终弄清楚了这一点。他必须向 SQL 服务器注册一个 SPN（服务主体名称）。对此知之甚少，但集成安全性现在可以工作。它仅适用于 IE，不适用于 Chrome、Firefox 或 Safari，但我暂时满足，并将查看其他非 Microsoft 浏览器是否可以允许集成安全性。我讨厌网络！！！:)

# jquery - Jquery DateTimePicker 不适用于 asp.net 母版页和内容页

> ID：11677533
> 
> 赞同：0
> 
> 时间：2012-07-26T20:30:06.620
> 
> 标签：jquery, asp.net, jquery-ui-datepicker

我一直在努力让日期时间选择器与 Asp.net 4.0 一起使用。我在脚本文件夹中添加了 jquery-1.5.2.min.js 和 jquery-datepicker.js。我收到错误消息

```
Microsoft JScript runtime error: Object doesn't support this property or method 
```

在 jquery-1.5.2.min.js 里面。

我经历了stackoverflow中发布的类似问题，但仍然无法解决答案。我确定脚本路径没有得到正确解析。我尝试了不同的组合，在主页面和内容页面中添加脚本标签。它仍然不起作用。我还在内容页面中尝试了 ResolveUrl，它仍然失败。

更新的代码 - 仍然给我错误。' type="text/javascript">
' type="text/javascript">
' rel="stylesheet" type="text/css" />

```
 $(document).ready(function ()
        {
           $("#<%=TextBox1.ClientID %>").datepicker(); 
        });     

         </script>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" Runat="Server"> 
        <script type="text/javascript" src="../Scripts/jquery-1.5.2.min.js" ></script> 
         <script type="text/javascript" src="../Scripts/jquery-datepicker.js" ></script>
        <script type="text/javascript" language="javascript"> 
        $(document).ready(function () 
       {

     $(function () {
         $("#<%=txtDateFrom.ClientID %>").datepicker();             
     });

 }); /*----------------------End of Document Ready----------------------------*/
</script> 
```

使用过主页面和内容页面并在内容页面中包含 jquery 日期时间选择器的人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:34:35.353

除非有特定原因不能使用像 Google 或 jQuery 这样的存储库，否则我建议您从其中添加 jQuery 库。

```
<script src="http://code.jquery.com/jquery-latest.js"></script> 
```

编辑：好像你在页面的正文中有这个。尝试将其添加到标题（可能是 Content1 contentplaceholder？）

祝你好运！

编辑：我现在创建了一个名为 Course 的文件夹和一个名为 Course.aspx 的页面，这对我有用：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.master" AutoEventWireup="true"
        CodeFile="Course.aspx.cs" Inherits="Course_Course" %>

        <asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="Server">
            <script type="text/javascript" src="//code.jquery.com/jquery-latest.js"></script>
            <script src='=<%Response.Write(Page.ResolveUrl("~/Scripts/jquery.ui.datepicker.js")); %>' type="text/javascript"></script>
            <script src='<%Response.Write(Page.ResolveUrl("~/Scripts/jquery-ui-1.8.22.custom.min.js"));%>' type="text/javascript"></script>
            <link href='<%Response.Write(Page.ResolveUrl("~/Styles/jquery-ui-1.8.22.custom.css")); %>' rel="stylesheet" type="text/css" />
            <script language="javascript" type="text/javascript">
                $(document).ready(function () {
                    $("#<%=TextBox1.ClientID %>").datepicker();
                });
            </script>
        </asp:Content>
        <asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="Server">
            <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        </asp:Content> 
```

祝你好运！

# javascript - Javascript 发布和订阅 - 如何避免魔术字符串

> ID：11677534
> 
> 赞同：3
> 
> 时间：2012-07-26T20:30:10.617
> 
> 标签：javascript, publish-subscribe

当使用松散耦合的 Javascript 模块（在 Web 浏览器中）使用 Pub/Sub 库时，是否有任何模式可以说明如何避免事件名称的魔术字符串？

我正在使用 require.js 和 amplify.js 来开发基于模块化的 Web 应用程序。我正在使用放大来发布和订阅事件，但这当然要求发布者和订阅者都知道事件标签是什么。我想避免对这些事件标签使用魔术字符串。我在想每个模块都会有一个关联的“eventsList.js”文件，或者类似的东西会列出模块将发布的事件。对于任何想要订阅其他模块事件的模块，它会为每个感兴趣的模块导入每个事件列表，这也将防止事件标签泄漏到全局命名空间中。

我特别想避免在我的应用程序中的每个模块都有一个“主事件列表”。

有没有人取得类似的成就？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T21:11:19.510

我还担心在我的主题中使用魔术字符串。您是否找到了合适的解决方案？我目前已经参加了我不太满意的主要活动列表：

```
var app = {
    events: {
        mod1: {
            topica: 'topic-a',
            topicb: 'topic-b'
        },
        mod2: {
            topicx: 'topic-x',
            topicy: 'topic-y'
        }
    }
}

//usage
amplify.publish(app.events.mod1.topica) 
```

# node.js - 多用户登录passport.js

> ID：11677538
> 
> 赞同：0
> 
> 时间：2012-07-26T20:30:26.723
> 
> 标签：node.js, passport.js

如何设置passport.js，以便如果我有两个不同的用户登录，这将是两个不同的帐户。现在我遇到了一个奇怪的错误，其中一个用户登录。如果第二个用户登录，并且第一个用户刷新页面，第一个用户将成为第二个用户......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T01:29:58.660

没有代码很难说，但您的验证回调可能有问题。验证回调位于您初始化策略的地方。您可能将所有经过身份验证的用户 ID 分配给服务器上的同一用户。

```
passport.use(new LocalStrategy(
  function(username, password, done) {
    // The problem is probably in here
  }
)); 
```

第二个最有可能的地方是`deserializeUser`

```
passport.deserializeUser(function(id, done) {
  // could be here, too
}); 
```

最后检查的地方可能是`serializeUser`上述方法的伴侣。

# vb.net - 将曲目添加到“跳转到文件”队列 winamp - vb.net

> ID：11677545
> 
> 赞同：0
> 
> 时间：2012-07-26T20:30:43.423
> 
> 标签：vb.net, winamp

是否可以使用 vb.net 应用程序将歌曲列表添加到 winamp 的跳转到文件框中？我尝试了几种方法，但总是失败，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T19:33:00.873

在 winamp 首选项中设置选项

# actionscript-3 - ActionScript 3：UIScrollBar 错误（？） - 容器宽度返回 +85px

> ID：11677547
> 
> 赞同：0
> 
> 时间：2012-07-26T20:31:02.020
> 
> 标签：actionscript-3, scrollbar, uicomponents

使用 Flash CS5，我今天遇到了一些奇怪的事情。

UIScrollBar 组件的刚性宽度为 15px。当您将它添加到诸如 Sprite 之类的容器中时，您会期望 sprite 的宽度返回 15，但它却返回 100！

这是一个示例代码。

```
import flash.display.Sprite;
import fl.controls.UIScrollBar;

var spr:Sprite = new Sprite();
addChild(spr);
trace('spr.width:',spr.width);

var bar:UIScrollBar = new UIScrollBar();
spr.addChild(bar);
trace('bar.width',bar.width);
trace('spr.width:',spr.width); 
```

有趣的是，输出是

> spr.width: 0
> bar.width 15
> spr.width: 100

有人知道那里发生了什么吗？这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T03:15:30.157

发现这是一个错误。发生的情况是，它需要一些时间才能在舞台上绘制/渲染组件，因此只有在绘制后才能访问其大小。作为记录，在我的计算机中需要 1 毫秒。直到它返回预期值。

另一个令人惊讶的问题是，UIScrollBar 返回 15px 作为其宽度，而容器精灵返回 16px。对于那些寻找原因的人来说，这可能与使用`thickness=1`和绘制的条形轮廓有关`scaleMode=LineScaleMode.NONE`。我写的一个类也有同样的问题，我必须通过在每个超级方法的返回值上加 1 来覆盖宽度和高度 getter。

# php - PHP - 在没有直接链接到文件的情况下拒绝文件夹访问？

> ID：11677548
> 
> 赞同：1
> 
> 时间：2012-07-26T20:31:02.670
> 
> 标签：php, apache, .htaccess

我正在创建一个文件托管网站。我不希望人们访问该目录

```
public_html/quick/files 
```

除非他们有上传文件的直接下载链接。我该怎么办？

对于其他人：换句话说，拒绝对所有文件进行索引的权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:36:45.703

使用以下内容创建一个名为`.htaccess`in`public_html`文件夹的文件：

```
Options -Indexes 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:35:06.923

在目录中创建一个空白 index.html 文件。

如果认为有必要，创建一个指向错误页面的重定向。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>Your Page Title</title>
<meta http-equiv="REFRESH" content="0;url=<URL_ERROR_PAGE>"></HEAD>
<BODY>
    Optional page text here.
</BODY>
</HTML> 
```

# jqgrid-asp.net - TableToGrid 最初很难看。然后它的格式正确。如何在一切准备就绪之前隐藏桌子

> ID：11677549
> 
> 赞同：0
> 
> 时间：2012-07-26T20:31:04.533
> 
> 标签：jqgrid-asp.net

我特别喜欢使用 jqGrid 和 TableToGrid。获取 Json 数据也很好，我在我的 asp.net MVC4 应用程序的几个视图中使用了该功能，但是，我有 jqGrid TableToGrid 的一个页面。唯一的问题是，当您第一次加载页面或刷新带有表格到网格页面的页面时，表格看起来很丑，然后稳定下来。有没有办法可以隐藏表格或显示加载屏幕，直到完全准备好查看...我知道常规 jqGrid 有一个加载文本选项，但那只是当您的表格通过 ajax 加载时...您可以在网格上放置一个加载对话框......但是我在 document.ready 上弹出了我的加载对话框，并且最初看起来丑陋的网格仍然存在。也许有一种方法可以在 $(document).ready 之前隐藏表格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:41:23.130

也许您可以将整个网格放入具有可见性：隐藏或显示：无的 div 中，然后在 document.ready 中使用 jquery 显示该 div。

**[更新]** 您可以在 jqgrid 的 gridComplete 事件中显示 div。根据他们的文档“*这会在所有数据加载到网格中并且所有其他过程都完成后触发。事件也独立于数据类型参数和排序分页等之后触发。* ”

查看他们的维基了解更多信息[http://www.trirand.com/jqgridwiki/doku.php?id=wiki:events](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:events)

# c++ - 什么是二叉树，它们为什么有用？

> ID：11677557
> 
> 赞同：1
> 
> 时间：2012-07-26T20:31:42.963
> 
> 标签：c++, data-structures, binary-tree

> **可能重复：**
> [二叉树的应用是什么？](https://stackoverflow.com/questions/2130416/what-are-the-applications-of-binary-trees)

什么是二叉树？为什么它们有用？为什么有些 STL 容器使用它们来存储元素？为什么搜索一棵树需要 O(log *n* ) 的时间？

# jquery - 一页水平站点不以调整大小为中心

> ID：11677560
> 
> 赞同：1
> 
> 时间：2012-07-26T20:32:04.797
> 
> 标签：jquery, html, css, resize

我正在使用[jQuery](http://jquery.com/)和[scrollTo](http://demos.flesler.com/jquery/scrollTo/)插件开发我的第一个单页水平网站。该站点有 3 个屏幕并以居中开始（显示中间屏幕）。为了做到这一点，对我来说合乎逻辑的方法是让每个屏幕`<body>`都有. 当您单击 a时，jQuery 会将您发送到另一个屏幕，向左或向右。`width:300%;``width:33.3333%;``<a>`

这很好用，但是当我尝试调整窗口大小时，我失去了所有结构，宽度不再有意义。我想知道我能做些什么来解决这个问题，但更重要的是我想了解为什么会发生这种情况。

这是[小提琴先生](http://jsfiddle.net/Cthulhu/rKF2q/1/)。调整窗口大小，您会发现问题所在。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:38:13.473

如果您使用的是 scrollTo 插件，为什么在指定滚动位置时不使用“A DOM 元素（逻辑上是可滚动元素的子元素）”？那是：

```
 $('html, body').scrollTo($('div#right'), 800); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:41:03.510

正如您在关于卢克的回答的评论之一中提到的那样，我重新评估了这一点，您需要记住您最后的位置。

您需要跟踪您所在的位置，然后在重新调整大小后返回那里。
使用与此类似的代码：

```
var lastPosition = "middle";
var $body = $('html, body');

window.scrollTo(($(document).width() - $(window).width()) / 2, 0);

$('#go_left').click(function() {
    $body.scrollTo('0px', 800);
    lastPosition = "left";
});
$('#go_right').click(function() {
    $body.scrollTo('100%', 800);
    lastPosition = "right";
});
$('#left_link').click(function() {
    $body.scrollTo('50%', 800);
    lastPosition = "middle";
});
$('#right_link').click(function() {
    $('html, body').scrollTo('50%', 800);
    lastPosition = "middle";
});

$(window).off('resize.menu').on('resize.menu', function() {    
    switch(lastPosition)
    {
        case "left":
            $body.scrollTo('0px', 0);
            break;
        case "middle":
            $body.scrollTo('50%', 0);
            break;
        case "right":
            $body.scrollTo('100%', 0);
            break;
    }
})​ 
```

见[**演示**](http://jsfiddle.net/vaxtQ/1/)

我还缓存了 body 元素，因此您不必在滚动时不断地重新遍历它，但这增加了一点性能提升。

和以前一样，请记住在离开页面时取消绑定事件，否则最终可能会导致内存泄漏。

我仍然没有设法摆脱滞后的重新定位，但这是之后要做的事情。

**编辑**
终于找到了一种方法来最小化调整大小时的滞后/闪烁。

在调整大小方法中使用`scrollLeft()`它会更好，不是完美/完美，但要好得多：

```
$(window).off('resize.menu').on('resize.menu', function() {    
    var elementToScrollTo = "div#main";

    switch(lastPosition)
    {
        case "left":
            elementToScrollTo = "div#left";
            break;
        case "middle":
            elementToScrollTo = "div#main";
            break;
        case "right":
            elementToScrollTo = "div#right";
            break;
    }

     $(window).scrollLeft($(elementToScrollTo).position().left);
}) 
```

更新[了演示](http://jsfiddle.net/vaxtQ/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:46:03.980

`$(window).resize(function() { $('html, body').scrollTo('50%', 0); });`

这可能比弗朗索瓦的回答稍微慢一点，因为您不必重新计算宽度，因为几乎每个像素都会调用此代码，窗口大小会更改为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T01:28:45.600

添加这个：

[http://jsfiddle.net/EAzS9/1/](http://jsfiddle.net/EAzS9/1/)

```
$(window).resize( function () {
    window.scrollTo(($(document).width() - $(window).width()) / 2, 0);
});
​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T20:41:18.567

当您使用 scrollTo 时，即使您输入了一个百分比值，它也会被设置为绝对像素值。调整窗口大小不会改变绝对像素值，除非您在“resize”事件的事件处理程序中编码以重新计算滚动值。不过，如果我是你，我会为这样的事情使用绝对像素值。以像素为单位定义每个`.page`div 的宽度，并将它们全部包裹在一个宽度非常大的 div 中，以确保将来的页面适合。然后，设置`left`包装器的偏移量，而不是滚动。最初的[尾声滑块](http://kevinbatdorf.github.com/codaslider/)使用了这种技术，我想现在的滑块仍然如此。

# json - 使用 Titanium DB 上的数据生成 PDF 文档

> ID：11677561
> 
> 赞同：0
> 
> 时间：2012-07-26T20:32:05.090
> 
> 标签：json, pdf, xml-parsing, titanium

我正在使用 Titanium 创建一个移动应用程序。我使用的是sqlite的钛数据库。这个 pdf 需要有框来构造我使用应用程序获取的数据和图像。

我假设我需要做的是将数据转换为钛上的 json，将其上传到 Web 服务器并插入到 mysql/phpmysql 数据库中，然后使用某种现有的脚本来读取 Web 数据库并创建一个pdf并将其发送回手机

那正确吗？

如果是这样...我需要整个过程的帮助哈哈...关于数据库上传到网络数据库过程的任何好的教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T05:03:47.107

[检查文档](http://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.Network.HTTPClient)，HTTPClient 是您需要使用的，它是一个标准。

第一步是在您的服务器上创建一个解析 JSON 格式的 Web 服务。您必须做的大部分工作与 Titanium 无关，但这里是使用来自 Titanium 应用程序的 POST 将 JSON 对象发送到某些 Web 服务的代码。

```
var xhr_getstep = Titanium.Network.createHTTPClient();
xhr_getstep.onload = function(e) {
    // Do something with the response from the server
    var responseBlob = this.responseText;
};
xhr_getstep.onerror = function() {
    Ti.API.info('[ERROR] WebService failed.');
};
xhr_getstep.open("POST", 'http://yourwebsite.com/yourwebserviceentry.php');
xhr_getstep.setRequestHeader("Content-Type", "application/json");

// Create your object with info on how to create the PDF
var objSend = {title : 'Amazing Title'};
xhr_getstep.send(obj); // Send it all off 
```

# java - 将速度和位置向量转换为经度和纬度？

> ID：11677565
> 
> 赞同：5
> 
> 时间：2012-07-26T20:32:35.367
> 
> 标签：java, math, gps, physics, latitude-longitude

我一直在玩卫星跟踪程序。你给它 TLE 信息和 Julian 日期，它会返回给定卫星的 3 部分的位置矢量和速度矢量。例如，在撰写本文时国际空间站的位置和速度矢量是：

```
Position Vector:
1.43201229062465434E18
-2.13926476354018432E17
-9.0494444352008358E17

Velocity Vector:
3.191614378202316E-10
3.0853260273024627E-10
2.1811338307505537E-10 
```

我想将其与在线跟踪器作为经度和纬度进行对比，并检查其是否正确。但我不知道如何将这些转换为 long 和 lat。任何火箭科学家可以帮助我吗？甚至可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T21:08:47.133

轨道位置通常以[地心地球固定 (ECEF)](http://en.wikipedia.org/wiki/ECEF)（笛卡尔）坐标表示。您似乎希望将该表示转换为纬度经度高度 (LLA) 表示。[Mathworks 对从 ECEF 到 LLA](http://www.mathworks.com/help/toolbox/aeroblks/ecefpositiontolla.html?nocookie=true)以及[从 LLA 到 ECEF](http://www.mathworks.com/help/toolbox/aeroblks/llatoecefposition.html?nocookie=true)的转换有很好的描述。海军研究生院有一个[网络应用程序](http://www.oc.nps.edu/oc2902w/coord/llhxyz.htm)可以在两种表示之间进行转换。

对于轨道动力学，时间并没有真正进入 ECEF 和 LLA 之间的转换。这仅用于确定轨道上的物体在那个时间点的位置（通常在 ECEF 中）。此外，随着物体绕地球运行，速度矢量会随时间变化，但这也不会影响转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-12T06:03:38.323

首先确保位置向量在ECEF或ECI框架中......如果在ECEF中，直接将其转换为Lat Long Alt。在 ECI 的情况下，通过使用朱利安日期计算本地恒星时间将其转换为 ECEF 帧，然后继续进行 ECEF2LLA 转换......

# java - 是否有从 AST 生成类文件的 Java 库？

> ID：11677567
> 
> 赞同：10
> 
> 时间：2012-07-26T20:32:37.830
> 
> 标签：java, parsing, code-generation, javac

[这个页面](https://blogs.oracle.com/yj/entry/yet_another_way_to_hack)描述了我如何使用 javac 中的代码生成器来生成代码，因为我可以构建一个 AST（使用我编写的单独的解析器）。该技术涉及编辑 javac 的源代码以基本上绕过 Java 解析器，以便可以将他/她自己的 AST 提供给代码生成器。这可以工作，但我希望以一种更清洁的方式来做。我想将 javac 的代码生成部分作为库包含在我的项目中，这样我就可以使用它来生成代码，而无需携带 javac 的其余源代码。

有没有办法用 javac 做到这一点，或者是否有更好的库？

另外，请随意更改问题的标题。我想不出更好的，但它有点模棱两可。如果您建议编辑以获得更好的标题，我会接受。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T17:29:22.793

我认为您可能感兴趣的是像[BCEL](http://commons.apache.org/bcel/)（字节码工程库）这样的 java 库

当我在编译器构造上学习一个类时，我玩过它，基本上，它有一个很好的包装器来生成常量池，将命名字节码指令插入一个方法等等，然后当你完成后，你可以加载这个类在运行时使用自定义类加载器，或以正常方式将其写入文件。

使用 BCEL，从语法树到 Java 字节码应该相对容易，尽管有点乏味，但在某些情况下，您可能只想使用 BCEL 生成原始字节码而不构建树。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-29T03:05:07.197

另一个很酷的框架是[ASM](http://asm.ow2.org/)，一个字节码分析和操作框架。

如果您不想使用框架，截至目前（2014 年），无法使用[此处](http://mail.openjdk.java.net/pipermail/compiler-dev/2014-June/008869.html)所述的 com.sun.source.tree.* 的任意表示从树生成字节码。

# http - 为错误的协议返回什么 HTTP 代码

> ID：11677571
> 
> 赞同：4
> 
> 时间：2012-07-26T20:32:53.967
> 
> 标签：http, http-status-codes

我想为在仅 HTTPS 域上点击 HTTP 的用户返回 HTTP 代码，反之亦然。哪个[HTTP 代码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)适合这个？

我不想重定向到正确的协议，因为它会促进不良/不安全的链接，而且我的服务器设置不允许我禁用域上的协议。

我在想 400、403、406 或 500。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:40:19.020

它认为您正在寻找：[403 Forbidden](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.4)（至少我会选择这个）

> 服务器理解请求，但拒绝执行。授权将无济于事，并且不应重复请求。如果请求方法不是 HEAD 并且服务器希望公开请求未完成的原因，它应该在实体中描述拒绝的原因。如果服务器不希望向客户端提供此信息，则可以使用状态码 404（未找到）代替

# java - 在 Java/Maven 中处理“Xerces hell”？

> ID：11677572
> 
> 赞同：777
> 
> 时间：2012-07-26T20:32:59.723
> 
> 标签：java, maven, classloader, dependency-management, xerces

在我的办公室里，仅仅提到 Xerces 这个词就足以激起开发人员的杀气。粗略浏览一下关于 SO 的其他 Xerces 问题似乎表明几乎所有 Maven 用户在某个时候都被这个问题“触动”了。不幸的是，理解这个问题需要对 Xerces 的历史有一点了解......

# 历史

*   Xerces 是 Java 生态系统中使用最广泛的 XML 解析器。几乎每个用 Java 编写的库或框架都以某种方式使用 Xerces（如果不是直接传递，也可以传递）。

*   直到今天，[官方二进制文件](http://xerces.apache.org/mirrors.cgi#binary)中包含的 Xerces jar 还没有版本控制。例如，Xerces 2.11.0 实现 jar 名为`xercesImpl.jar`而不是`xercesImpl-2.11.0.jar`.

*   Xerces 团队[不使用 Maven](https://issues.apache.org/jira/browse/XERCESJ-1454?focusedCommentId=12881865&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12881865)，这意味着他们不会将正式版本上传到[Maven Central](http://search.maven.org/)。

*   Xerces 曾经[作为单个 jar](http://xerces.apache.org/xerces2-j/faq-general.html#faq-3) ( `xerces.jar`) 发布，但被拆分为两个 jar，一个包含 API ( `xml-apis.jar`)，另一个包含这些 API 的实现 ( `xercesImpl.jar`)。许多较旧的 Maven POM 仍然声明对`xerces.jar`. 在过去的某个时候，Xerces 也以 . 的形式发布`xmlParserAPIs.jar`，一些较旧的 POM 也依赖于它。

*   那些将 jar 部署到 Maven 存储库的人分配给 xml-apis 和 xercesImpl jar 的版本通常是不同的。例如，xml-apis 可能被赋予 1.3.03 版本，而 xercesImpl 可能被赋予 2.8.0 版本，即使两者都来自 Xerces 2.8.0。这是因为人们经常用它实现的规范版本来标记 xml-apis jar。这里有一个非常好的但不完整的[细分](http://web.archive.org/web/20140113103608/http://swordsystems.com/2011/06/29/xerces-and-xml-api-dependency-hell/)。

*   更复杂的是，Xerces 是用于 Java API for XML Processing (JAXP) 的参考实现中的 XML 解析器，包含在 JRE 中。实现类在`com.sun.*`命名空间下重新打包，这使得直接访问它们很危险，因为它们在某些 JRE 中可能不可用。但是，并非所有 Xerces 功能都通过`java.*`和`javax.*`API 公开；例如，没有公开 Xerces 序列化的 API。

*   更令人困惑的是，几乎所有的 servlet 容器（JBoss、Jetty、Glassfish、Tomcat 等）都在其一个或多个`/lib`文件夹中附带了 Xerces。

# 问题

### 解决冲突

由于上述某些（或全部）原因，许多组织在其 POM 中发布和使用 Xerces 的自定义构建。如果您有一个小型应用程序并且只使用 Maven Central，这并不是一个真正的问题，但它很快成为 Artifactory 或 Nexus 代理多个存储库（JBoss、Hibernate 等）的企业软件的问题：

![由 Artifactory 代理的 xml-apis](../Images/d7a0de5e79b162a8bb8e59ab5a3b4179.png)

例如，组织 A 可能发布`xml-apis`为：

```
<groupId>org.apache.xerces</groupId>
<artifactId>xml-apis</artifactId>
<version>2.9.1</version> 
```

同时，组织 B 可能会发布与以下内容相同`jar`的内容：

```
<groupId>xml-apis</groupId>
<artifactId>xml-apis</artifactId>
<version>1.3.04</version> 
```

虽然 B 的`jar`版本比 A 的版本低`jar`，但 Maven 并不知道它们是同一个工件，因为它们 `groupId`的 s 不同。因此，它无法执行冲突解决，并且两个 `jar`s 都将被包含为已解决的依赖项：

![使用多个 xml-api 解决依赖关系](../Images/a814fade115be65cede2899f97730a48.png)

### 类加载器地狱

如上所述，JRE 在 JAXP RI 中随 Xerces 一起提供。虽然最好将所有 Xerces Maven 依赖项标记为`<exclusion>`s 或`<provided>`，您所依赖的第三方代码可能与您正在使用的 JDK 的 JAXP 中提供的版本一起工作，也可能不工作。此外，您可以在 servlet 容器中提供 Xerces jar 以应对。这给您留下了许多选择：您是否删除了 servlet 版本并希望您的容器在 JAXP 版本上运行？离开 servlet 版本是否更好，并希望您的应用程序框架在 servlet 版本上运行？如果上面列出的一两个未解决的冲突设法溜进您的产品（在大型组织中很容易发生），您很快就会发现自己陷入了类加载器的地狱，想知道类加载器在运行时选择了哪个版本的 Xerces 以及它是否将在 Windows 和 Linux 中选择相同的 jar（可能不会）。

# 解决方案？

我们已经尝试将所有 Xerces Maven 依赖项标记为`<provided>`或，但鉴于工件具有如此多的别名（ 、、、等）`<exclusion>`，这很难实施（尤其是对于大型团队）。此外，我们的第三方库/框架可能无法在 JAXP 版本或 servlet 容器提供的版本上运行。`xml-apis``xerces``xercesImpl``xmlParserAPIs`

**我们如何用 Maven 最好地解决这个问题？我们是否必须对依赖项进行如此细粒度的控制，然后依赖分层类加载？是否有某种方法可以全局排除所有 Xerces 依赖项，并强制我们所有的框架/库使用 JAXP 版本？**

* * *

**更新**：Joshua Spiewak 已将 Xerces 构建脚本的补丁版本上传到[XERCESJ-1454](https://issues.apache.org/jira/browse/XERCESJ-1454)，允许上传到 Maven Central。投票/观看/为这个问题做出贡献，让我们一劳永逸地解决这个问题。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2013-03-07T07:30:21.040

自 2013 年 2 月 20 日以来，Maven Central 中有 Xerces的 2.11.0 JAR **（和源 JAR！） ！**请参阅[Maven Central 中的 Xerces](http://search.maven.org/#artifactdetails|xerces|xercesImpl|2.11.0|jar)。我想知道他们为什么没有解决[https://issues.apache.org/jira/browse/XERCESJ-1454](https://issues.apache.org/jira/browse/XERCESJ-1454) ...

我用过：

```
<dependency>
    <groupId>xerces</groupId>
    <artifactId>xercesImpl</artifactId>
    <version>2.11.0</version>
</dependency> 
```

并且所有依赖项都已解决 - 甚至是正确的`xml-apis-1.4.01`！

最重要的是（过去并不明显）——Maven Central 中**的 JAR 与官方`Xerces-J-bin.2.11.0.zip`发行版**中的 JAR 相同。

但是我找不到版本 -由于附加依赖关系，`xml-schema-1.1-beta`它不能是 Maven版本。`classifier`

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-07-26T22:18:36.327

坦率地说，我们遇到的几乎所有东西都可以在 JAXP 版本中正常工作，所以**我们*总是*排除** `xml-apis`和`xercesImpl`.

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2012-07-27T16:28:38.507

您可以将 Maven 强制插件与禁止依赖规则一起使用。这将允许您禁止所有您不想要的别名，而只允许您想要的别名。违反这些规则时，您的项目的 Maven 构建将失败。此外，如果此规则适用于企业中的所有项目，您可以将插件配置放在企业父 pom.xml 中。

看：

*   [http://maven.apache.org/plugins/maven-enforcer-plugin/](http://maven.apache.org/plugins/maven-enforcer-plugin/)
*   [http://maven.apache.org/enforcer/enforcer-rules/bannedDependencies.html](http://maven.apache.org/enforcer/enforcer-rules/bannedDependencies.html)

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2015-04-24T06:54:38.963

我知道这并不能完全回答这个问题，但是对于来自谷歌的 ppl 碰巧使用 Gradle 进行依赖管理：

我设法摆脱了 Gradle 的所有 xerces/Java8 问题，如下所示：

```
configurations {
    all*.exclude group: 'xml-apis'
    all*.exclude group: 'xerces'
} 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-07-26T20:49:39.367

我想你需要回答一个问题：

**是否存在您应用程序中的所有内容都可以使用的 xerces*.jar？**

如果不是这样，你基本上就完蛋了，不得不使用 OSGI 之类的东西，它允许你同时加载不同版本的库。请注意，它基本上用类加载器问题替换了 jar 版本问题......

如果存在这样的版本，您可以让您的存储库为所有类型的依赖项返回该版本。这是一个丑陋的 hack，最终会在你的类路径中多次使用相同的 xerces 实现，但比拥有多个不同版本的 xerces 更好。

您可以将每个依赖项排除在 xerces 中，并将一个添加到您要使用的版本中。

我想知道您是否可以编写某种版本解析策略作为 maven 的插件。这可能是最好的解决方案，但如果可行的话需要一些研究和编码。

对于运行时环境中包含的版本，您必须确保将其从应用程序类路径中删除，或者在考虑服务器的 lib 文件夹之前首先考虑应用程序 jar 以进行类加载。

所以总结一下：这是一团糟，不会改变。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-06-14T13:51:53.637

您应该首先进行调试，以帮助确定您的 XML 地狱级别。在我看来，第一步是添加

```
-Djavax.xml.parsers.SAXParserFactory=com.sun.org.apache.xerces.internal.jaxp.SAXParserFactoryImpl
-Djavax.xml.transform.TransformerFactory=com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl
-Djavax.xml.parsers.DocumentBuilderFactory=com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderFactoryImpl 
```

到命令行。如果可行，则开始排除库。如果没有，那么添加

```
-Djaxp.debug=1 
```

到命令行。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-10-02T09:52:51.990

这里还没有探讨另一个选项：在 Maven 中将 Xerces 依赖项声明为*可选*：

```
<dependency>
   <groupId>xerces</groupId>
   <artifactId>xercesImpl</artifactId>
   <version>...</version>
   <optional>true</optional>
</dependency> 
```

基本上，这样做是强制所有依赖项声明*他们*的 Xerces 版本，否则他们的项目将无法编译。如果他们想覆盖这种依赖关系，欢迎他们这样做，但是他们将拥有潜在的问题。

这为下游项目创造了强大的动力：

*   做出积极的决定。他们是使用相同版本的 Xerces 还是使用其他东西？
*   实际测试他们的解析（例如通过单元测试）和类加载，以及不要弄乱他们的类路径。

并非所有开发人员都跟踪新引入的依赖项（例如 with `mvn dependency:tree`）。这种做法会立即引起他们的注意。

它在我们的组织中运行良好。在介绍之前，我们曾经生活在 OP 所描述的同一个地狱中。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-02-05T11:58:43.507

每个 maven 项目都应该停止依赖于 xerces，他们可能不会。XML API 和 Impl 自 1.4 以来一直是 Java 的一部分。无需依赖 xerces 或 XML API，就像说您依赖 Java 或 Swing。这是隐含的。

如果我是一个 maven repo 的老板，我会编写一个脚本来递归地删除 xerces 依赖项并写一个读我说这个 repo 需要 Java 1.4。

任何由于通过 org.apache 导入直接引用 Xerces 而实际中断的东西都需要代码修复以将其提升到 Java 1.4 级别（并且自 2002 年以来已经完成）或通过认可的库而不是 maven 在 JVM 级别的解决方案。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-06-22T02:59:50.853

除了排除之外，什么会有所帮助的是模块化依赖关系。

对于一个平面类加载（独立应用程序）或[半分层（JBoss AS/EAP 5.x）](https://community.jboss.org/wiki/JBossClassLoaderHistory)，这是一个问题。

但是对于像[OSGi](http://en.wikipedia.org/wiki/OSGi)和[JBoss Modules](http://planet.jboss.org/view/post.seam?post=modularized_java_with_jboss_modules)这样的模块化框架，这不再那么痛苦了。这些库可以独立地使用他们想要的任何库。

当然，仍然最推荐只使用一个实现和版本，但如果没有其他方法（使用更多库中的额外功能），那么模块化可能会节省您的时间。

JBoss 模块的一个很好的例子自然是[JBoss AS 7](https://docs.jboss.org/author/display/MODULES/Module+descriptors) / [EAP 6](http://www.jboss.org/products/eap) / [WildFly 8](http://www.wildfly.org/)，它主要是为此开发的。

示例模块定义：

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.1" name="org.jboss.msc">
    <main-class name="org.jboss.msc.Version"/>
    <properties>
        <property name="my.property" value="foo"/>
    </properties>
    <resources>
        <resource-root path="jboss-msc-1.0.1.GA.jar"/>
    </resources>
    <dependencies>
        <module name="javax.api"/>
        <module name="org.jboss.logging"/>
        <module name="org.jboss.modules"/>
        <!-- Optional deps -->
        <module name="javax.inject.api" optional="true"/>
        <module name="org.jboss.threads" optional="true"/>
    </dependencies>
</module> 
```

与 OSGi 相比，JBoss 模块更简单、更快。虽然缺少某些功能，但对于大多数（大部分）由一个供应商控制的项目来说已经足够了，并且允许惊人的快速启动（由于并行依赖解决）。

*请注意，[Java 8 正在进行模块化工作](http://www.slideshare.net/mfrancis/java-8-modules-jigsaw-and-osgi-neil-bartlett)，但 AFAIK 主要是为了模块化 JRE 本身，不确定它是否适用于应用程序。*

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-05-18T14:08:24.733

我的朋友这很简单，这里举个例子：

```
<dependency>
    <groupId>xalan</groupId>
    <artifactId>xalan</artifactId>
    <version>2.7.2</version>
    <scope>${my-scope}</scope>
    <exclusions>
        <exclusion>
        <groupId>xml-apis</groupId>
        <artifactId>xml-apis</artifactId>
    </exclusion>
</dependency> 
```

如果您想在终端（此示例的 Windows 控制台）中检查您的 Maven 树是否没有问题：

```
mvn dependency:tree -Dverbose | grep --color=always '(.* conflict\|^' | less -r 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-10-04T16:45:02.570

显然`xerces:xml-apis:1.4.01`不再在 Maven 中心，但这就是`xerces:xercesImpl:2.11.0`参考。

这对我有用：

```
<dependency>
  <groupId>xerces</groupId>
  <artifactId>xercesImpl</artifactId>
  <version>2.11.0</version>
  <exclusions>
    <exclusion>
      <groupId>xerces</groupId>
      <artifactId>xml-apis</artifactId>
    </exclusion>
  </exclusions>
</dependency>
<dependency>
  <groupId>xml-apis</groupId>
  <artifactId>xml-apis</artifactId>
  <version>1.4.01</version>
</dependency> 
```

# php - 使用 php 在 html 代码中定位标签的结尾

> ID：11677573
> 
> 赞同：1
> 
> 时间：2012-07-26T20:33:03.057
> 
> 标签：php, wordpress

我正在修改 Wordpress 主题，我想在主页上的故事中显示有限数量的字符，并包含指向故事其余部分的链接。这应该自动完成，无需作者指定中断发生的点。但是，我想允许使用 html 标签，但我不想在标签关闭之前拆分故事。

我正在使用的代码包含`strip_tags`确保字符中断不会发生在 html 标记中间的函数。但是，内容作者希望能够包含一些标签，并且随着时间的推移，之前的网站管理员修改了主题以允许一些标签，例如`<p>`，`<i>`等。然而，现在我正在网站上工作，内容作者真的希望能够包含链接和图像等内容。我尝试注释掉该`strip_tags`命令，但现在明白了为什么包含它，因为如果文本位于标签中间或标签未正确关闭，则在任意点拆分文本可能会出现问题。

我试图弄清楚php是否有确保标签关闭的规定，所以我可以在拆分文本之前做到这一点。或者也许是其他一些选择。我正在使用的代码片段如下所示。

```
$content = get_the_content('', $stripteaser, $more_file);
$content = apply_filters('the_content', $content);
$content = str_replace(']]>', ']]&gt;', $content);

//Commenting out following line causes problems
//$content = strip_tags($content, '<p><br><b><i><strong><em>');

if ((strlen($content)>$max_char) && ($espacio = strpos($content, " ", $max_char ))) {
    $content = substr($content, 0, $espacio);
    $content = $content;
    echo "<p>";
    echo $content;
    echo "...";
    echo "&nbsp;<a rel='nofollow' href='";
    the_permalink();
    echo "'>".$more_link_text."</a>";
    echo "</p>";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:21:02.860

如果您不想使用 the_excerpt()，您可以阅读更多关于[More Tag](http://codex.wordpress.org/Customizing_the_Read_More)来完成您所描述的所有事情，而无需使用过滤器或正则表达式。

但是，如果您真的对使用正则表达式来检测更多标签感到好奇，那么这将是您需要的字符串：

```
/<span id="more-\d+"><\/span>|<!--more-->/i 
```

# perl - “没有警告；” 在安全隔间

> ID：11677576
> 
> 赞同：5
> 
> 时间：2012-07-26T20:33:27.133
> 
> 标签：perl, warnings, eval

我正在使用Perl 的[Safe模块中的](https://metacpan.org/module/Safe)[reval](https://metacpan.org/module/Safe#reval-STRING-STRICT-)，如果无法解析正在评估的字符串，我想阻止它生成警告（实际上，我想阻止它生成任何警告）。

例如，下面的代码：

```
use strict; use warnings;
use Safe;    
use feature qw/say/;
my $cft = Safe->new;

my $x = $cft->reval(') 1' );
my $y = $cft->reval('2'   );
say "x: $x";
say "y: $y"; 
```

结果是：

```
Number found where operator expected at (eval 5) line 1, near ") 1"
    (Missing operator before 1?)
Use of uninitialized value $x in concatenation (.) or string at ./test line 12.
x: 
y: 2 
```

我想要实现的是让 $x = undef 和 $y = 2，并且没有警告。我试图提出“没有警告；” 在新范围内，但它对 reval 内产生的警告没有影响（尽管正如@DavidO 所指出的，它使“未初始化值”警告静音）：

```
use strict; use warnings;
use Safe;    
use feature qw/say/;
my $cft = Safe->new;
{
    no warnings;
    my $x = $cft->reval(') 1' );
    my $y = $cft->reval('2'   );
    say "x: $x";
    say "y: $y";
} 
```

我想不知何故，“无警告”必须在保险箱内，所以我也尝试在“无警告”前面加上“无警告”；到被评估的字符串：

```
use strict; use warnings;
use Safe;
use feature qw/say/;
my $cft = Safe->new;
{
    my $x = $cft->reval( 'no warnings;' . ') 1' );
    my $y = $cft->reval( 'no warnings;' . '2'   );
    say "x: $x";
    say "y: $y";
} 
```

这样 reval 不会发出任何警告，但两个变量都是 undef：

```
Use of uninitialized value $x in concatenation (.) or string at ./test line 10.
x: 
Use of uninitialized value $y in concatenation (.) or string at ./test line 11.
y: 
```

我不知道还有什么可以尝试的，我希望问题描述足够清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:46:58.130

`no warnings`禁止`use warnings`编译指示生成的所有警告。您可能还想删除任何`strict`尿素。但是严重的解析错误会以任何方式弹出。

如果你想执行任何代码，无论多么病态，没有任何输出到 STDERR，你应该在本地修改信号处理程序：

```
{
  # I know what I'm doing!
  local $SIG{__WARN__} = sub {}; # locally ignore any warnings
  eval $code; # catches all "die"
} 
```

或者我们可以重新`STDERR`打开`/dev/null`：

```
{
  # I know what I'm doing!
  open my $oldSTDERR, '>&' \*STDERR or die;
  close STDERR or die;
  open STDERR, '>', '/dev/null' or die;

  eval $code;

  close STDERR or die;
  open STDERR, '>&', $oldSTDERR or die;
  close $oldSTDERR;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T21:25:16.830

如果你检查`$@`你会看到`$cft->reval( 'no warnings;' . ') 1' );`失败。 `'require' trapped by operation mask at (eval 5) line 1.`. 换句话说，Safe 正在完成它的工作并阻止该代码尝试加载库。

`$cft->reval( 'BEGIN { warnings->unimport; } ) 1' );`会起作用，假设警告已经加载到隔间外。但是，这不会消除编译时错误。不像`eval`，`reval`似乎让他们通过。使用 amon 的静默 STDERR 技术。

# dynamic-language-runtime - Sympl 示例 - 源代码？

> ID：11677577
> 
> 赞同：0
> 
> 时间：2012-07-26T20:33:29.507
> 
> 标签：dynamic-language-runtime

我正在探索 DLR 运行时，我看到有一个关于 Sympl 语言的很好的文档。有谁知道我在哪里可以找到这个示例项目的源代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T04:20:30.097

我找到了 Sympl 的这个文档，其中有很多以非常简单和有用的方式解释的示例。它可能对你有帮助。

[http://www.codeplex.com/Download?ProjectName=dlr&DownloadId=74709](http://www.codeplex.com/Download?ProjectName=dlr&DownloadId=74709)

# php - PHP Facebook FQL Multquery 和处理 foreach 和变量

> ID：11677581
> 
> 赞同：0
> 
> 时间：2012-07-26T20:33:38.360
> 
> 标签：php, facebook, foreach, facebook-fql

好吧，所以我想弄清楚这一点。基本上，除了将封面照片添加到每个 DIVS 之外，我的一切都运行良好。基本上我有 2 个使用 FQL 的查询，这是我的代码。

```
$query = 
   '{"query1":"SELECT aid, cover_pid, name, description FROM album WHERE owner=$fbowner",
     "query2":"SELECT src FROM photo WHERE pid IN (SELECT cover_pid FROM #query1)"}';

$fqlResult = $facebook->api(array(
    'method' => 'fql.multiquery',
'queries' => $query));          

$fql = $fqlResult[0]['fql_result_set'];
$covers = $fqlResult[1]['fql_result_set'];

$the_count = count($fql);
$i = 0;
foreach($fql as $value) {
 $album_cover = $value['src'];
 echo "<div class='fb_block'>";
 echo "<a href='" . $url . "?action=list_pics&aid=" . $value['aid'] . "&album_name=" . $value['name'] . "'>";
 echo "<img src='{$covers[$i]['src']}' border='1'>";
 echo "</a>";
 echo "<h3>".$value['name']."</h3>";
 echo "<p>".$value['description']."</p>";
 echo "</div>";
 $i++;
} 
```

现在效果很好，但是如果我把它放在混合中，除非我让 $i = 1，否则封面照片都会关闭。

```
$i = 0;
foreach($fql as $value) {
if($value['name'] != 'Wall Photos'){
 $album_cover = $value['src'];
 echo "<div class='fb_block'>";
 echo "<a href='" . $url . "?action=list_pics&aid=" . $value['aid'] . "&album_name=" . $value['name'] . "'>";
 echo "<img src='{$covers[$i]['src']}' border='1'>";
 echo "</a>";
 echo "<h3>".$value['name']."</h3>";
 echo "<p>".$value['description']."</p>";
 echo "</div>";
 $i++;
}
} 
```

如果我在混合中添加另一个 foreach，它会抓取所有封面照片并将它们粘贴到每个 div 中。那么，按顺序获取与相册节点关联的封面照片的最简单解决方案是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T01:02:54.097

我也试过这个。您不能依赖这两个查询之间的索引是一致的。

为了使它工作，首先修改`query2`为也 return `pid`，然后在你的代码中替换这一行：

```
echo "<img src='{$covers[$i]['src']}' border='1'>"; 
```

有了这个：

```
foreach($covers as $cover) {
  if ($value['cover_pid'] === $cover['pid']) {
    echo "<img src='{$cover['src']}' border='1'>";
    break;
  }
 } 
```

# android - 选择时如何使图片聚焦

> ID：11677582
> 
> 赞同：0
> 
> 时间：2012-07-26T20:33:38.327
> 
> 标签：android

当我实现这个答案时，我找到了堆栈溢出的解决方案，下面的链接我发现了一个错误（R.styleable.Gallery1）它是什么？它是任何特定值或单独的文件夹吗？ [android圆形画廊？](https://stackoverflow.com/questions/3633370/answer/submit)是单独的文件夹还是任何特定值？代码是这样的：

```
public class TestGallery extends Activity {
    /** Called when the activity is first created. */

    private Integer[] mImageIds = { R.drawable.sample_1, R.drawable.sample_2,       
    R.drawable.sample_3, R.drawable.sample_4 }; 

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Gallery g = (Gallery) findViewById(R.id.gallery); 
        g.setAdapter(new ImageAdapter(this)); 

        g.setOnItemClickListener(new OnItemClickListener() { 
            public void onItemClick(AdapterView parent, View v, int position, long id) { 
                if (position >= mImageIds.length) { 
                    position = position % mImageIds.length; 
                }
                Toast.makeText(TestGallery.this, "" + position, Toast.LENGTH_SHORT).show(); 
            } 
        });
    }

    public class ImageAdapter extends BaseAdapter { 
         int mGalleryItemBackground; 
         private Context mContext; 

        public ImageAdapter(Context c) { 
            mContext = c; 
            TypedArray a = obtainStyledAttributes(R.styleable.Gallery1); 
            mGalleryItemBackground =     
        a.getResourceId(R.styleable.Gallery1_android_galleryItemBackground, 0); 

            a.recycle(); 
        } 

        public int getCount() { 
            return Integer.MAX_VALUE; 
        } 

        public Object getItem(int position) { 
            if (position >= mImageIds.length) { 
                position = position % mImageIds.length; 
            } 
            return position; 
        } 

        public long getItemId(int position) { 
            if (position >= mImageIds.length) { 
                position = position % mImageIds.length; 
            } 
            return position; 
        } 

        public View getView(int position, View convertView, ViewGroup parent) { 
            ImageView i = new ImageView(mContext); 
            if (position >= mImageIds.length) { 
                position = position % mImageIds.length; 
            } 
            i.setImageResource(mImageIds[position]); 
            i.setLayoutParams(new Gallery.LayoutParams(80, 80)); 
            i.setScaleType(ImageView.ScaleType.FIT_XY); 
            i.setBackgroundResource(mGalleryItemBackground); 
            return i; 
         } 

         public int checkPosition(int position) { 
            if (position >= mImageIds.length) { 
                position = position % mImageIds.length; 
            } 
            return position; 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:47:25.087

在您的图库中设置以下代码

```
g.setFocusable(true);
g.setFocusableInTouchMode(true); 
```

将聚焦图像。

它适合我。

# scala - scala演员阻塞当前线程

> ID：11677584
> 
> 赞同：4
> 
> 时间：2012-07-26T20:33:39.640
> 
> 标签：scala, concurrency, actor

我尝试实现一个基于 Scala 的 Actor API 的计时器，当前线程 Actor (Actor.self) 作为计时器，一个匿名 Actor 执行需要及时完成的​​工作。我有以下 Scala 程序

```
import scala.actors.Actor.self
import scala.actors.TIMEOUT

object Main {
  def main(args: Array[String]): Unit = {
    val thiz = self
    actor {
      // do heavy work here
      thiz ! "finish"
    }
    self.reactWithin(1000) { 
      case "finish" => println("complete")
      case TIMEOUT  => println("timeout")
    }
  }
} 
```

当我运行程序时，我收到了

```
Exception in thread "main" scala.actors.SuspendActorControl
scala.actors.ActorProxy@1d99a4d: caught java.lang.InterruptedException 
```

请告诉我解决问题的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T00:58:23.037

你有两种通过 scala-actors 传递的控制，**thread-blocking**或**thread-suspension**。后者意味着抛出一个控制异常（线程再次对线程池管理器可用），并且当消息进入其邮箱时重新执行actor主体。有关更多详细信息，请参阅[演员教程](http://www.scala-lang.org/node/242)，尤其是。“使其无线程！”部分。

该`receiveWithin`方法使用线程阻塞和`reactWithin`暂停。您在这里遇到的问题是没有捕获异常的外部管理参与者。这仅适用于“适当的”actor，不适用于为主线程创建的代理。因此，如果您想在显式参与者之外等待主线程，则需要使用线程阻塞 / `receiveWithin`：

```
self.receiveWithin(1000) { ... } 
```

# php - Php pdo 语句与 MsSQL 转义？

> ID：11677586
> 
> 赞同：1
> 
> 时间：2012-07-26T20:33:49.187
> 
> 标签：php, sql, pdo

以前可能已经问过类似的问题，并为此感到抱歉。需要确保我正确地防止 SQL 注入。

我刚刚将我的 php sql 语句转换为 pdo 语句。对于我曾经使用的旧 sql 查询`mysql_real_escape_string`，`strip_tags()`也许`htmlenteties()`（不确定 id 是否为 html）。

是否有必要在 pdo 语句中使用这样的东西。听说有些地方pdo不需要这个。什么是真/假？

并且：我一直习惯于编写如下第一个示例的查询：

```
SELECT `id` , `password` FROM  `users` WHERE `username` = '$username'
SELECT id, password FROM users WHERE username = '$username' 
```

示例 1 比示例 2 更安全（来自 sql 注入）还是只是浪费时间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:36:16.847

如果您使用的是 PDO，则应该使用带参数的准备好的语句。[文档](http://www.php.net/manual/en/pdo.prepare.php)中有一些示例。

```
/* Execute a prepared statement by passing an array of values */
$sql = 'SELECT name, colour, calories
    FROM fruit
    WHERE calories < :calories AND colour = :colour';
$sth = $dbh->prepare($sql, array(PDO::ATTR_CURSOR => PDO::CURSOR_FWDONLY));
$sth->execute(array(':calories' => 150, ':colour' => 'red'));
$red = $sth->fetchAll();
$sth->execute(array(':calories' => 175, ':colour' => 'yellow'));
$yellow = $sth->fetchAll(); 
```

如果您使用这种方法，则无需转义字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:39:00.403

他们说您不需要在 PDO 中转义字符串，因为它们使用[准备好的语句](http://php.net/manual/en/pdo.prepared-statements.php)。如果你只是使用`query()`mysql 中的 PDO 方法，那并不比只使用 mysql 更安全。至于您给出的示例，它们都同样**不安全**；他们都同样容易受到注射（而且他们*非常*容易受到注射）。在切线点上，`mysqli`扩展有一个优势，`PDO`因为您*不能*执行多个 SQL 语句而不是一个`mysqli_query()`. 这提供了一些（不是完全的）保护来防止一些（同样，不是全部）注入尝试，尤其是那些让新的超级用户等的尝试。

# php - wordpress 中的自定义搜索选项

> ID：11677593
> 
> 赞同：0
> 
> 时间：2012-07-26T20:34:06.537
> 
> 标签：php, wordpress

我正在本地电脑上的 wordpress 网站上工作。现在我想添加带有不同项目的组合框的自定义搜索选项，例如：查看最多的帖子、最近发布的帖子、评论最多的帖子等。

我将从组合框中选择一个选项，然后单击搜索/查找按钮。然后根据所选值显示结果。我怎样才能构建功能任何想法.... ??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T22:58:27.083

您可以传递给 WP_Query() 's' => $searchterm 以及 'orderby' => 'comment_count'（对于大多数评论）或 'orderby' => 'date' 或 'modified'（对于最近的）。

对于大多数查看，检查这个[问题](https://wordpress.stackexchange.com/questions/25645/how-do-i-get-a-list-of-popular-posts-by-views)

# android - Android - 如何在 ImageView 中实现垂直滚动

> ID：11677599
> 
> 赞同：0
> 
> 时间：2012-07-26T20:34:29.373
> 
> 标签：android, imageview

我正在创建一个应用程序，在该应用程序中单击我正在显示图像的列表视图项目。现在这些图像的大小通常是宽度：480，高度是可变的，大多数时候 > 800。我正在使用 ImageView 来显示这些图像。

现在，如果我使用简单的 imageview 并将图像显示为 setContentView(R.image)，则图像完全适合 480x800，这会导致图像内容失真。

我试图实现在 [Android 上给出的建议：Scrolling an Imageview](https://stackoverflow.com/questions/3058164/android-scrolling-an-imageview)

但再次没有运气。在这里，我可以获得 ImageView 的滚动，但不是我想要的。

我想要的是图像不会改变它的像素比。它只是在屏幕上（全屏宽度）向用户显示，并通过垂直滚动来查看超过 800 像素比例的内容。请建议我应该在 ImageView XML 和我的活动类中做什么以实现相同的目标。目前我正在[Android 中实现所有内容：滚动 Imageview](https://stackoverflow.com/questions/3058164/android-scrolling-an-imageview)，因此代码与那里的代码相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T20:37:20.110

尝试`ImageView`将`ScrollView`.

并且不要忘记将`ImageView`的比例类型设置为`FitXY`.

# matlab - 如何始终在 X 轴上显示“标签”

> ID：11677601
> 
> 赞同：2
> 
> 时间：2012-07-26T20:34:37.613
> 
> 标签：matlab, plot, label, zooming

如果我放大几次图表，X 轴上的所有标签都会消失（消失）并且没有可见的 X 轴标签，因此无法理解我在哪里的图表部分。

如何强制 matlab 始终在 X 轴上显示标签并在缩放时自动更新它们并显示足够的数字，因此“邻居”标签必须不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-26T14:26:38.010

即使在新版本的 MATLAB（r2014）上，我也遇到了同样的问题。放大时，MATLAB 不会显示足够的 x 轴刻度标签。经过几次实验，我发现了以下解决方法。以下是实施解决方案之前的情节。MATLAB 仅在 x 轴上显示三个 XTick 标签，即使有足够的空间放置更多标签（当您放大时，标签通常会更少）。 ![放大后 ML 在 x 轴上仅显示三个 XTick 标签，即使有足够的空间容纳更多。](../Images/d2fdc2ef75cff1fce7c81adc884cf3d1.png)

怀疑 MATLAB 认为它没有足够的空间来显示更多标签，解决方法可以是旋转标签。为此，在您发出绘图命令后，例如

```
plot(tsX);
hold on;
plot(tsY);
plot(tsZ); 
```

添加以下命令

```
set(gca,'XTickLabelRotation',90); 
```

现在 MATLAB 绘制更多标签 ![旋转 X Tick 标签后，当您放大时，MATLAB 会绘制更多标签。](../Images/86805df653c945255958d9f39360ebb2.png)

我将把它作为一个错误报告给 MATLAB 人员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:07:53.393

这取决于，您是否自己手动设置刻度线（`'XTick'`和`'XTickLabel'`轴属性）？

试试这个简单的例子

```
plot(sin(1:10), 'o-') 
```

无需更改任何内容，您可以随意缩放，并且刻度标签将始终可见

* * *

### 编辑

问题的根本原因与您在[其他问题](https://stackoverflow.com/q/11683119/97160)中提出的问题相同，`datetick`功能将手动设置刻度标签，从而禁用缩放/平移的自动更新。

好消息是已经在[FEX上](http://www.mathworks.com/matlabcentral/fileexchange/20422-datetick-with-zooming-panning-and-subplots)[提交](http://www.mathworks.com/matlabcentral/fileexchange/15029-datetickzoom-automatically-update-dateticks)了尝试使用 DATETICK 解决这个确切问题的意见书

# macos - 导出路径不起作用

> ID：11677603
> 
> 赞同：1
> 
> 时间：2012-07-26T20:34:48.740
> 
> 标签：macos, bash, unix, osx-lion

我正在尝试解决此处询问/回答的问题：

[升级到 OSX 10.7 Lion 后修复 Postgresql](https://stackoverflow.com/questions/6770649/repairing-postgresql-after-upgrading-to-osx-10-7-lion)

它建议我使用`export`on `PATH`。但是，这就是我得到的：

```
$ which psql
/usr/bin/psql
$ export PATH=/opt/local/lib/postgresql91/bin:$PATH
$ which psql
/usr/bin/psql 
```

......我真的很困惑。为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:09:56.927

解决这个直接问题最有效的方法是使用

```
export PATH=export PATH=/opt/local/lib/postgresql91/bin: 
```

但请注意..这几乎把所有其他命令都搞砸了——它实际上只是解决了眼前的问题（路径没有得到更新）。我认为这不是一个很好的长期解决方案，非常感谢其他答案。

另一方面，指定主机解决了上面链接的问题的问题：

`psql -h localhost -U postgres`

# python - 更新 Pyqt 状态栏小部件

> ID：11677604
> 
> 赞同：4
> 
> 时间：2012-07-26T20:34:51.430
> 
> 标签：python, qt, pyqt

如何更新状态栏小部件？另外我如何使用信号和线程而不是按钮？谢谢！谁能帮帮我，我的代码不起作用，当我按下按钮时没有任何反应，我也收到错误消息：

```
Error:
    self.a = QtGui.QStatusBar.showMessage("System Status | Normal")
    TypeError: QStatusBar.showMessage(QString, int msecs=0): first argument of unbound method must have type 'QStatusBar'

from PyQt4 import QtGui,QtCore
import sys

class main_window(QtGui.QWidget):
    def __init__(self,parent=None):
        #Layout       
        QtGui.QWidget.__init__(self,parent)
        self.bt=QtGui.QPushButton('crash')
        self.lbl=QtGui.QLabel('count')
        ver=QtGui.QHBoxLayout(self)
        ver.addWidget(self.bt)

        self.cnt=0
        self.running=False
        self.connect(self.bt,QtCore.SIGNAL("clicked()"),self.count)

        self.a = QtGui.QStatusBar.showMessage("System Status | Normal")
        ver.addWidget(self.a)
        self.timer = QtCore.QTimer()
        self.timer.timeout.connect(self.count)
        # check every second
        self.timer.start(1000*1)       

    def count(self):
        a = open("connection_cpu.txt","r")
        if a == "CPU Overclocked":
            abnormal_label = QtGui.QLabel("System Status | Normal")  
            abnormal_label.setStyleSheet(' QLabel {color: red}')
            QtGui.QStatusBar.addWidget(abnormal_label)
            self.repaint()
        else:
            normal_label = QtGui.QLabel("System Status | Normal")
            QtGui.QStatusBar.addWidget(normal_label)
            self.repaint()

if __name__ == '__main__':

    app = QtGui.QApplication(sys.argv)
    mw=main_window()
    mw.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T07:51:02.347

你有这个代码：

```
 self.a = QtGui.QStatusBar.showMessage("System Status | Normal")
    ver.addWidget(self.a) 
```

`showMessage`不是类方法，您需要一个`QStatusBar`实例。我想你想这样做：

```
 self.a = QtGui.QStatusBar(self)
    ver.addWidget(self.a)
    self.a.showMessage("System Status | Normal") 
```

也许子类化会更容易`QMainWindow`？然后你可以使用[`QMainWindow.statusBar`](http://doc.qt.io/qt-4.8/qmainwindow.html#statusBar)：

```
class MainWindow(QtGui.QMainWindow):

    def __init__(self, parent=None):
        QtGui.QMainWindow.__init__(self, parent)

        self.bt = QtGui.QPushButton('crash')
        self.lbl = QtGui.QLabel('count')

        self.cnt = 0
        self.running = False

        self.bt.clicked.connect(self.count) # new style signal/slot connection

        # http://doc.qt.nokia.com/4.7-snapshot/qmainwindow.html#statusBar
        self.statusBar().showMessage("System Status | Normal") 

        #Layout
        vert_layout = QtGui.QHBoxLayout()
        vert_layout.addWidget(self.bt)
        self.main_widget = QtGui.QWidget(self)
        self.main_widget.setLayout(vert_layout)
        self.setCentralWidget(self.main_widget)

        self.timer = QtCore.QTimer()
        self.timer.timeout.connect(self.count)
        # check every second
        self.timer.start(1000*1)

    def count(self):
        a = open("connection_cpu.txt", "r").read()
        if a == "CPU Overclocked":
            abnormal_label = QtGui.QLabel("System Status | Normal")  
            abnormal_label.setStyleSheet(' QLabel {color: red}')
            self.statusBar().addWidget(abnormal_label)
            self.repaint()
        else:
            normal_label = QtGui.QLabel("System Status | Normal")
            self.statusBar().addWidget(normal_label)
            self.repaint() 
```

# xml - EXTJS XML 映射

> ID：11677606
> 
> 赞同：1
> 
> 时间：2012-07-26T20:34:58.817
> 
> 标签：xml, extjs4.1

我想使用 Ext.data.Model 将这个 XML 读取到 ExtJS 存储中：

```
<interfaces>
    <green> 
        <name>Eth0</name>
        <enabled>true</enabled>
    </green>

    <red>
        <name>Eth1</name>
        <enabled>true</enabled>
    </red>
</interfaces> 
```

我想在我的接口网格的“名称”列中显示“Eth0”和“Eth1”。

此映射 {name: 'interface', mapping: 'green> name'} 仅显示 Eth0。

如何进行映射以在网格中显示 Eth0 和 Eth1？我不应该修改 xml 文件结构。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T03:18:52.570

的`record`配置`XmlReader`是相对于`root`标签指定的选择器。

要将根的所有子标签读取为一条记录，无论标签的名称如何，我们都可以使用`> *`选择器选择所有子标签。

```
Ext.define('MyModel', {
    extend: 'Ext.data.Model',
    fields: [ 'name', 'enabled' ],
    proxy: {
        type: 'ajax',
        reader: {
            type: 'xml',
            root: 'interfaces',
            record: '> *'
        }
    }
}); 
```

*   [例子](http://jsfiddle.net/msjj9/)

# scala - 如何在 Scala 中打印扩展宏？

> ID：11677609
> 
> 赞同：19
> 
> 时间：2012-07-26T20:35:01.563
> 
> 标签：scala, macros, scala-2.10

我正在用 Scala 编写一个宏，但是当我调用它时，我收到一条错误消息，上面写着“Double 不接受参数”。很明显，宏构建 AST 的方式有问题。那么我怎样才能看到扩展的宏呢？有没有办法在运行时调用宏实现？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-26T21:47:44.980

向编译器提供`-Ymacro-debug-lite`或选项。`-Ymacro-debug-verbose`

在我的脑海中，打印的 AST 的细化由`-Yshow-trees-compact`、`-Yshow-trees-stringified`、`-Xprint-types`和. 您可以通过运行和（或在[https://github.com/scala/scala/blob/2.10.x/src/compiler/scala/tools/nsc/settings/ScalaSettings.scala](https://github.com/scala/scala/blob/2.10.x/src/compiler/scala/tools/nsc/settings/ScalaSettings.scala)检查 scala 设置的来源来找到其他 gem ）。`-uniqid``-Yshow-symkinds``scala -X``scala -Y`

此外，尽管本质上是一个宏，但具体化有自己的跟踪机制，可以通过`-Yreify-copypaste`和配置`-Yreify-debug`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T21:10:07.667

[Macrocosm 的 desugar](https://github.com/retronym/macrocosm/blob/master/src/main/scala/com/github/retronym/macrocosm/Macrocosm.scala)可以显示您的源代码（包括但不限于宏）是如何转换成的。

```
 println("TRANSFORMATION:\n"+ desugar{
        println("a string") 
        MY_MACRO("something")
    }) 
```

# php - 打印类似计数而不刷新页面

> ID：11677616
> 
> 赞同：0
> 
> 时间：2012-07-26T20:35:39.380
> 
> 标签：php, javascript, jquery, ajax

我的网站上有一个喜欢/不喜欢的帖子，当我点击喜欢按钮时，我希望 check2 的值显示在 like 旁边，而无需刷新页面即可查看。目前我会点击喜欢并插入数据，但只显示在页面刷新上。我对这种东西绝望了。

这是按执行顺序排列的代码。

谢谢你的帮助。

发布喜欢

```
echo "<div class='stream_option'><a id='likecontext_".$streamitem_data['streamitem_id']."' style='cursor:pointer;' onClick=\"likestatus(".$streamitem_data['streamitem_id'].",this.id);\">";
if($checklikes>0){
echo "Unlike";
}else{
echo "Like";
}
echo "</a> ";
$check2 = user_core::print_like_count($streamitem_data['streamitem_id']);
if($check2>0){
echo "(".$check2.")";
} 
```

阿贾克斯函数

```
function likestatus(postid,contextid){
var obj = document.getElementById(contextid);
if(obj.innerHTML=="Like"){
obj.innerHTML="Unlike";
}else{
obj.innerHTML="Like";
}
$.post("../include/like_do.php", { streamitem_id: postid} );
} 
```

喜欢做

```
$check = user_core::check_liked($_SESSION['id'],$_POST['streamitem_id'],1);

user_core::do_like($_SESSION['id'],$_POST['streamitem_id'],1);

    if($check==0){
    ?>
    <?php
    }else{
    ?>
    <?php
    }
}
else{
echo "<script>alert('Error liking post');</script>";
}
?> 
```

USER_CORE

```
 function check_liked($id,$streamid,$value){

            $check      =   "SELECT feedback_id FROM streamdata_feedback WHERE feedback_streamid=$streamid AND feedback_userid=$id AND feedback_rating=$value";
            $check1     =    mysql_query($check);
            $check2     =    mysql_num_rows($check1);
        return $check2;
        }

        function print_like_count($streamid){
                $check      =   "SELECT feedback_id FROM streamdata_feedback WHERE feedback_streamid=$streamid AND feedback_rating=1";
                $check1     =    mysql_query($check);
                $check2     =    mysql_num_rows($check1);
                if($check2>0){
                echo "(".$check2.")";
                }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:39:35.773

您正在寻找的是使用 DHTML 更改点赞值的 AJAX 提交。

```
<script language="javascript">
    $(".likeButton").click(function() {
        $.post("likeProcessor.php", {
            id: $(this).attr('id')
        }, function(data) {
            $("#likeIndicator" + $(this).attr('id')).html(data);
        });
</script> 
```

然后，您的 likeProcessor 脚本将简单地返回该项目的点赞数。

**注意：**这是伪代码，可让您了解需要发生的事情。有关 jQuery 和 Ajax 的更多信息，RTM 分别位于[http://www.w3schools.com/jquery/default.asp](http://www.w3schools.com/jquery/default.asp)和[http://www.w3schools.com/ajax/default.asp](http://www.w3schools.com/ajax/default.asp)。

# ios - 当我的 SSL 证书过期时，ASIFormDataRequest 是否仍然有效？

> ID：11677618
> 
> 赞同：0
> 
> 时间：2012-07-26T20:35:46.057
> 
> 标签：ios, ssl-certificate, asihttprequest

我正在使用[ASIHTTPRequest 库](http://allseeing-i.com/ASIHTTPRequest/)`ASIFormDataRequest`中的类通过 HTTPS 连接与 .NET Web 服务通信。

我想制定一个解决方案，消除对 SSL 安全性的需求，但 SSL 证书的到期时间比我获得 AppStore 更新的时间要早​​。

我想知道当应用程序`ASIFormDataRequest`在证书过期后会发生什么。会抛出错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T16:26:06.953

如果启用了证书检查（这是默认设置），那么对具有过期 ssl 证书的服务器的任何请求都将失败并出现错误。

# wpf - 样式数据触发到数据网格上的颜色行

> ID：11677621
> 
> 赞同：1
> 
> 时间：2012-07-26T20:36:03.890
> 
> 标签：wpf, datagrid, datatrigger

我有代码：

```
 <UserControl x:Class="MediaNet.View.MusicWindow.MusicWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:musicVM="clr-namespace:MediaNet.ViewModel.MusicWindowViewModel"
    xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
                 mc:Ignorable="d"
                 d:DesignHeight="350" d:DesignWidth="557">
        <UserControl.DataContext>
            <musicVM:MusicWindowViewModel />
        </UserControl.DataContext>
        <UserControl.Resources>
            <musicVM:TimeSpanConverter x:Key="TimeSpanConverter" />
            <musicVM:CurrentSongIndexConverter x:Key="CurrentSongIndexConverter" />
        </UserControl.Resources>
             <DataGrid Grid.Row="1" AutoGenerateColumns="True" VerticalAlignment="Top"  ItemsSource="{Binding Path=MusicItems}" SelectedIndex="{Binding Path=SelectedIndex}" >
        <DataGrid.RowStyle>
            <Style TargetType="DataGridRow">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding Path=CurrentSongIndex, Converter={StaticResource CurrentSongIndexConverter}, RelativeSource={RelativeSource Mode=Self}}"  Value="True">
                        <Setter Property="Background"  Value="Red"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </DataGrid.RowStyle>
        <DataGrid.ContextMenu>
            <ContextMenu >
                <MenuItem Command="Delete">
                    <MenuItem.Icon>
                        <Image  />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Song options">
                    <MenuItem Header="Play to this song" Command="{Binding SetStopPositionCommand}"  />
                </MenuItem>
            </ContextMenu>
        </DataGrid.ContextMenu>
    </DataGrid> 
```

音乐项是

```
ObservableCollection<Song> 
```

查看模型：

```
namespace MediaNet.ViewModel.MusicWindowViewModel
{
    public class MusicWindowViewModel : INotifyPropertyChanged, IDisposable
    {
 #region CurrentSongIndex
        private int _currentSongIndex;
        public int CurrentSongIndex
        {
            get { return _currentSongIndex; }
            set
            {
                _currentSongIndex = value;
                if (PropertyChanged != null)
                {
                    PropertyChanged(this, new PropertyChangedEventArgs("CurrentSongIndex"));
                }
            }
        }
        #endregion
 }
} 
```

转换器：

```
namespace MediaNet.ViewModel.MusicWindowViewModel
{
    class CurrentSongIndexConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            int CurrentSongIndex = (int)value;
            return CurrentSongIndex > 0;
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
} 
```

这应该将背景颜色设置为数据网格中的行，但现在可以使用。我怎么能告诉触发器它应该改变哪一行的背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:57:32.547

将`Style`应用于`DataGrid`. `Binding`in`DataTrigger`应该是相对于每一`DataContext`行的。这确保了对于每一行，绑定都会被评估。

请澄清/验证以下内容：

*   这究竟是如何“不起作用”的？是否没有突出显示行，所有行都突出显示？
*   你的转换器好用吗？您是否已验证它是否`true`在预期正确评估触发器绑定时返回？

**更新**

查看您更新的代码示例，问题在于`CurrentSongIndex`不在`DataContext`each 中`DataGridRow`。根据您的 XAML，您拥有`ItemsSource="{Binding Path=MusicItems}"`.

当网格的每一行都是数据绑定时，`DataGridRow.DataContext`设置为对应的`Song`. 发生这种情况时，绑定不再具有访问权限，`CurrentSongIndex`因为它是`MusicWindowViewModel`.

尝试将您的数据触发器绑定更改为以下内容：

```
{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}, Path=DataContext.CurrentSongIndex, Converter={StaticResource CurrentSongIndexConverter}} 
```

这将强制绑定查看包含该属性的`DataContext`窗口。`DataContext``MusicWindowViewModel``CurrentSongIndex`

# javascript - 打开/关闭谷歌地图标记

> ID：11677628
> 
> 赞同：3
> 
> 时间：2012-07-26T20:36:52.180
> 
> 标签：javascript, html, map, toggle, markers

我希望使用切换标记设置我的地图，以便当用户选中/取消选中地图下的一系列复选框时，选中的复选框是显示的标记类别，因此如果选中了 4 个复选框中的 3 个，即：酒吧、学校、餐厅，这些是按类别显示的标记，如果有人取消选中第 4 个标记或其中任意数量的标记，它们将“在某种意义上”变得不可见，这是行不通的，我翻遍了，找不到任何有帮助的参考资料。我是 javascript 新手，并且精通 PHP。我将位置 [] 数组设置为 4 列并且无限向下。所以对我来说，要获得“地点类型”它的位置[i][4]......我已经在这几天了，我无法变得更好。我尝试了我能想到的所有可能的组合。就像我说的 。我是一个 php 脚本编写者。

```
<script type="text/javascript">
//PHP - Lat,Lng ARRAY
var locations = [
<?php
$x = 0; $i = 0; $j = 0; $y = 0; $z = 0; $a = 0; $b = 0; $c = 0;
for($aa = 0; $aa < $count; $aa++) {
$content = '<div class="coupon"><div class="ribbon"><div class="ribbon-stitches-top"></div><strong class="ribbon-content"><h1>'.$deal[$y].'</h1></strong><div class="ribbon-stitches-bottom"></div></div><div class="picture_coupon"><img src="'.$deal_photo[$b].'" width="150" height="100" /></div><div class="deal"><center><h1>'.$deal[$y].'</h1>'.$deal_info[$a].'<b>Expires: '.$deal_expiration[$c].'</b></center></div></div>';

echo "['" . $business_name[$x] . "'," . $lat[$i] . "," . $lng[$j] . "," . "'$content'" . ",".$type[$id]. "],";
$x++; $i++; $j++; $id++; $y++; $z++; $a++; $b++; $c++;
}
?>
['' , , ,'' , '']
];  
//PHP - Lat,Lng ARRAY 
  var map;

  function initialize() {
    var myOptions = {
      zoom: 13,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById('map_canvas'),
        myOptions);

    // Try HTML5 geolocation
    if(navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        var pos = new google.maps.LatLng(position.coords.latitude,
                                         position.coords.longitude); 
```

// 反码 PHP 动态

```
var infowindow = new google.maps.InfoWindow();

var marker, i;

//Marker Icon Generation.. Will be changed WHEN make new colors
var blue = '../images/map-icons/blue.png';

for (i = 0; i < locations.length; i++) {  
  marker = new google.maps.Marker({
    position: new google.maps.LatLng(locations[i][1], locations[i][2]),
    map: map,
    icon: blue // iconType[$num] 
  });

  google.maps.event.addListener(marker, 'click', (function(marker, i) {
    return function() {
      infowindow.setContent(locations[i][3]);
      infowindow.open(map, marker);
    }
  })(marker, i));
} 
```

// 逆代码 PHP 动态 // 地理位置设置中心和错误处理

```
 map.setCenter(pos);
      }, function() {
        handleNoGeolocation(true);
      });
    } else {
      // Browser doesn't support Geolocation
      handleNoGeolocation(false);
    }
  }

  function handleNoGeolocation(errorFlag) {
    if (errorFlag) {
      var content = 'Error: The Geolocation service failed.';
    } else {
      var content = 'Error: Your browser doesn\'t support geolocation.';
    } 
```

// 地理位置设置中心和错误处理

```
 }

  google.maps.event.addDomListener(window, 'load', initialize); 
```

//=================ATTEMPT AT 切换标记复选框

// == 显示特定类别的所有标记，并确保选中复选框 ==

```
 function show(category) {

    for (var i=0; i<locations.length; i++) {

      if (locations[i].mycategory == category) {

        locations[i].setVisible(true);

      }

    }

    // == check the checkbox ==

    document.getElementById(category+"box").checked = true;

  }

  // == hides all markers of a particular category, and ensures the checkbox is cleared ==

  function hide(category) {

    for (var i=0; i<locations.length; i++) {

      if (locations[i].mycategory == category) {

        locations[i].setVisible(false);

      }

    }

    // == clear the checkbox ==

    document.getElementById(category+"box").checked = false;

    // == close the info window, in case its open on a marker that we just hid

    infowindow.close();

  }

  // == a checkbox has been clicked ==

  function boxclick(box,category) {

    if (box.checked) {

      show(category);

    } else {

      hide(category);

    }

    // == rebuild the side bar

    makeSidebar();

  }  
 /*HTML*/<input type ="checkbox" name="resturauntbox" onclick="boxclick(this,'resturaunt')"><label></label>
     <input type ="checkbox" name="barbox" onclick="boxclick(this,'bar')"><label></label> 
```

//=============================================CHECKBOX //HTML

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T08:17:29.077

我只是设置了一个带有变量的 php for 循环来捕获所有类别，一个用来打开它们，另一个用来隐藏它们。

```
function checkAll(field) {
  for (j = 0; j < field.length; j++) {
    field[j].checked = true;

  }

  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(true);
      }
    }
  }
}

function uncheckAll(field) {

  for (j = 0; j < field.length; j++) {
    field[j].checked = false;

  }

  for (var index = 0; index < 1; index++) {
    category = "American";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "Asian";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "Deli - Cafe";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "Ethnic";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "Italian";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "Mexican";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "Seafood";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
  for (var index = 0; index < 1; index++) {
    category = "Sushi";
    for (var i = 0; i < locations.length; i++) {
      if (locations[i][4]) {
        markers[i].setVisible(false);
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:45:55.233

无意冒犯，但这是一个非常令人困惑的问题。但是，只是离开标题，您似乎想要添加和删除标记。要添加标记，您可以使用以下内容：

```
var marker = new google.maps.Marker({
    position: map.getCenter(), // center marker in map
    map: map,
    shadow: shadow, // MarkerImage type
    icon: image // MarkerImage type
}); 
```

然后，当您想从地图中删除标记时，可以使用以下命令：

```
marker.setMap(null); 
```

因此，您可以创建一个函数来打开和关闭标记，如下所示：

```
function toggleMarker(marker, map) {
    if (marker.getMap() == null)
        marker.setMap(map); // marker isn't visible on map, so make it visible
    else
        marker.setMap(null); // marker is visible on map, so make it invisible
} 
```

如果这不是你想要的，我很抱歉。我发现很难理解你的问题。

# java - 来自 Java 的 MS Access - 表达式中未定义的函数

> ID：11677632
> 
> 赞同：1
> 
> 时间：2012-07-26T20:36:58.333
> 
> 标签：java, sql, ms-access, jdbc

我在 Access mdb 文件中有一个 vba 函数。我正在尝试从 jdbc 运行查询。虽然查询在访问中运行良好，但从 jdbc 我收到一条错误消息：

```
[Microsoft][ODBC Microsoft Access Driver] Undefined function 'fun' in expression 
```

这是我的代码片段：

```
Class.forName ("sun.jdbc.odbc.JdbcOdbcDriver");
    String database = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)};DBQ=xyz.mdb;";
    Connection conn = DriverManager.getConnection(database,"","");  
Statement select = conn.createStatement();
    ResultSet result = select
    .executeQuery("SELECT * FROM table where fun()=1"); 
```

# .net - 如何解决 JScript.NET 程序集引用错误 JS1259？

> ID：11677633
> 
> 赞同：3
> 
> 时间：2012-07-26T20:36:59.437
> 
> 标签：.net, compiler-errors, jscript.net

我从一[本书](http://books.google.com/books?id=_ybRMWJufiEC&pg=PA308&lpg=PA308&dq=%22listing+15.1+launching+a+basic+windows+form%22&source=bl&ots=UF1a15tXdh&sig=Vc8FmlajxNLf4nQTiaBfKJ1d1K4&sa=X&ei=PzYSUPCdDoiCmQWEk4HYAg&redir_esc=y#v=onepage&q=%22listing%2015.1%20launching%20a%20basic%20windows%20form%22&f=false)中复制了这个小应用程序：

```
import System;
import System.Drawing;
import System.Windows.Forms;

public class BasicForm extends Form 
{
    public function BasicForm()
    {
        InitializeComponent();
    }
    private function InitializeComponent() : void 
    {
        this.Text = "Basic Windows Forms";
        this.Height = 400;
        this.Width = 500;
        this.WindowState = FormWindowState.Normal;
        this.StartPosition = FormStartPosition.CenterScreen;
    }
    public STAThreadAttribute() static function Main(Args:String[]) : void 
    {
        Application.Run(new BasicForm());
    }
}

BasicForm.Main(Environment.GetCommandLineArgs()); 
```

当我尝试用 jsc 编译它时，我得到了这个错误：

> 错误 JS1259：引用的程序集依赖于另一个未引用或找不到的程序集

是什么导致了这个错误，我该如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T04:48:12.333

导入“辅助功能”命名空间。

导入 Accessibility 命名空间时，代码使用 jsc.exe v2.0.50727 和 v4.0.30319 进行编译。

没有它，编译器会生成以下内容：

> ```
> Microsoft (R) JScript 编译器版本 8.00.50727
> 适用于 Microsoft (R) .NET Framework 版本 2.0.50727
> 版权所有 (C) Microsoft Corporation 1996-2005。版权所有。
> 
> 错误 JS1259：引用的程序集要求您还引用“辅助功能，版本 = 2.0.0.0，文化 = 中性，PublicKeyToken = b03f5f7f11d50a3a”
> 
> ```

或者

> ```
> Microsoft (R) JScript 编译器版本 10.00.30319
> 适用于 Microsoft (R) .NET Framework 版本 4.0.30319
> 版权所有 (C) 微软公司。版权所有。
> 
> 错误 JS1259：引用的程序集依赖于另一个未引用或找不到的程序集
> 
> ```

`import Accessibility;`

# android - Android：恢复已加载的图像

> ID：11677634
> 
> 赞同：0
> 
> 时间：2012-07-26T20:36:59.177
> 
> 标签：android, image, caching

我想从 imageView 中的 URL 加载和缩放图像。

然后，当用户触摸该图像时，我想在其他 imageView 或 webView 中加载图像（无比例）。

问题是我不想加载图像两次。第一次，它下载到某个地方（缓存？），我想恢复没有做两个请求......

一些例子？建议？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:51:01.550

您应该考虑首先加载图像的缩略图，然后等待下载真实的图像，直到用户真正想要看到它。

缓存见[LruChache](http://developer.android.com/reference/android/util/LruCache.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:51:18.667

本教程应该有助于缓存：[http ://codehenge.net/blog/2011/06/android-development-tutorial-asynchronous-lazy-loading-and-caching-of-listview-images/](http://codehenge.net/blog/2011/06/android-development-tutorial-asynchronous-lazy-loading-and-caching-of-listview-images/)

如果您有很多图像，请考虑使用`LruCache`. 它有助于管理大量缓存数据。

# ios - 指定 armv7 时为 armv6 构建 iOS 项目（目标是 iOS 5.1）

> ID：11677635
> 
> 赞同：0
> 
> 时间：2012-07-26T20:37:01.233
> 
> 标签：ios, architecture, build, compiler-errors, arm

我得到一长串错误，这些错误（对于我拥有的每个源文件）链接器错误到`.o`文件（源于上述来源）。每个人的错误基本上都解决了这个问题：

`CompiledSource.o, file was built for i386 which is not the architecture being linked (armv7)`

除了从技术上讲，这个问题实际上是警告。但是，在编译/链接阶段结束时，项目拒绝构建一个简单的`Linker command failed with exit code 1`错误。

在过去的 2 个小时里，我一直在试图弄清楚这一点。

在`Targets->ProjectName->Architectures->Valid Architectures`我选择了 armv6 和 armv7。我还为 iOS 5.1 设置了构建目标。

在我`Targets->ProjectName->Build Phases->Copy Bundle Resources`的 中，我添加了所有资源（我假设这是添加图像和 nib/xib 文件等资源的地方）。

**对此我能做些什么吗？**我已经尝试清理项目，从 XCode 根目录中的文件夹中删除所有文件`DataDerived`，甚至清理`/var/folders`. 诚然，这个项目直到 2011 年才被触及。

我应该注意，我对 iOS 的东西（以及 Xcode）还很陌生。不幸的是，这个项目也在保密协议下，所以我不能透露太多信息。但是，如果有人有任何问题，我会尽力回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:02:17.450

你确定它是一个iOS应用程序吗？因为这听起来像是链接到一个为 i386（OSX-intel）构建的自定义框架，它可能永远不会在 iOS 上运行。

您是否尝试过产品->清洁？或 [alt] 产品->清理构建文件夹？

也许看看苹果的一些示例代码，看看这些 iOS 项目是如何构建的。

# javascript - Jquery/Javascript 计时器

> ID：11677636
> 
> 赞同：0
> 
> 时间：2012-07-26T20:37:03.643
> 
> 标签：javascript, jquery, javascript-events

我编写了一个简单的函数，它使用淡入/淡出效果转换三个 div 元素。当用户单击链接时触发该事件。这是我的代码：

```
$(".link1").click(function () {
   $(".feature1").fadeIn(1000);
   $(".feature2").fadeOut(1000);
   $(".feature3").fadeOut(1000);
});

$(".link2").click(function () {
   $(".feature1").fadeOut(1000);
   $(".feature2").fadeIn(1000);
   $(".feature3").fadeOut(1000);
});

$(".link3").click(function () {
   $(".feature1").fadeOut(1000);
   $(".feature2").fadeOut(1000);
   $(".feature3").fadeIn(1000);
}); 
```

我需要能够设置某种计时器，以便这些转换每 8 秒左右自动发生一次。我还希望它们本质上“循环”，这样如果我们到达集合中的第三个 div，它就会返回到第一个 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:45:05.103

setInterval（表达式，超时）；以间隔运行函数，它们之间的超时长度

例子：

```
var intervalID = setInterval(alert('heelo'), 3000); // will alert hello every 3 seconds 
```

// clearInterval(intervalID); // 将清除计时器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:45:56.977

尝试以下操作：

```
var i = 0;
var transition = setInterval(function(){
                     i++;
                     if (i == 4) {i = 1}
                     $(".feature"+i).stop().fadeIn(1000, function(){
                        $(this).delay('6000').fadeOut(1000)
                     })
                  }, 8000) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:49:22.777

尝试使用 setTimeout() 函数。

```
var timer = null;

function foo_loop(div, timeout) {
  if (div > 3) div = 1;
  $(".feature"+div).fadeIn(1000);
  $("div[class^=feature]:not(.feature"+div+")").fadeOut(1000);
  clearTimeout(timer);
  timer = setTimeout(function() {
    foo_loop(div + 1, timeout);
  }, timeout);
} 
```

像这样运行（从第一个 div 和 8 秒超时开始）：

```
foo_loop(1, 8000); 
```

停止循环的功能：

```
function stop_loop() {
  clearTimeout(timer);
} 
```

当您需要停止循环时运行它（例如单击 id="stop" 的元素）：

```
$('#stop').bind('click', stop_loop); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T20:46:23.217

不确定我完全理解您何时希望它们循环或多久循环一次，但我认为这应该对您有所帮助...每 8 秒循环一次动画...

```
function fadeLoop(selectors, animations, times, index) {
    index = index || 0;
    if(index == selectors.length) return;
    $((selectors[index])[animations[index]](times[index], function() {
        fadeLoop(selectors, animations, times, index + 1);
    });
}

setInterval(function() {
    fadeLoop(
        ['.feature1', '.feature2', '.feature3'],
        ['fadeIn', 'fadeOut', 'fadeOut'],
        [1000, 1000, 1000]
    );

    fadeLoop(
        ['.feature1', '.feature2', '.feature3'],
        ['fadeOut', 'fadeIn', 'fadeOut'],
        [1000, 1000, 1000]
    );

    fadeLoop(
        ['.feature1', '.feature2', '.feature3'],
        ['fadeOut', 'fadeOut', 'fadeIn'],
        [1000, 1000, 1000]
    );
}, 1000 * 8); 
```

# c# - 如何在 Asterisk.NET 库中启用日志记录？

> ID：11677637
> 
> 赞同：1
> 
> 时间：2012-07-26T20:37:05.627
> 
> 标签：c#, asterisk

我正在编写一个 FastAGI 脚本，它利用 Asterisk.NET 程序集来处理 AGI 部分。我在 Asterisk.NET 脚本中看到了对“Logger”对象的引用，它应该为我提供大量的调试信息，但我在应用程序输出中什么也没有。

我已经使用`Console.WriteLine`'s 来删除一些调试信息，但此时我有一个异常，我无法打印有关的信息，因为 Asterisk.NET FastAGI 处​​理程序似乎默默地隔离所有异常，而不是让它们崩溃并给我修复它们所需的信息！

有谁知道如何正确启用 Logger 类？如果做不到这一点，有谁知道我如何指示 Asterisk.NET 库不要默默地丢弃异常？在这两种情况下，我都无法找到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T09:44:30.340

转到项目的属性，名为 Build 的选项卡，然后将 LOGGER 写入“条件编译符号”。Logger 类包含在 Asterisk.NET 中。

# c++ - 通过串行连接进行双向 C++ 通信

> ID：11677639
> 
> 赞同：14
> 
> 时间：2012-07-26T20:37:08.850
> 
> 标签：c++, linux, serial-port, arduino

我正在尝试编写一个非常简单的 C++ 应用程序来与 Arduino 进行通信。我想向 Arduino 发送一个它立即发回的字符。我从教程中获取的 Arduino 代码如下所示：

```
void setup()
{
    Serial.begin(9600);
}

void loop()
{
    //Have the Arduino wait to receive input
    while (Serial.available()==0);

    //Read the input
    char val = Serial.read();

    //Echo
    Serial.println(val);
} 
```

我可以使用 GNU 屏幕轻松与 Arduino 进行通信，因此我知道基本通信一切正常：

> $屏幕/dev/tty.usbmodem641 9600

我拥有的（损坏的）C++ 代码如下所示：

```
#include <fstream>
#include <iostream>
int main()
{
    std::cout << "Opening fstream" << std::endl;
    std::fstream file("/dev/tty.usbmodem641");
    std::cout << "Sending integer" << std::endl;
    file << 5 << std::endl; // endl does flush, which may be important
    std::cout << "Data Sent" << std::endl;
    std::cout << "Awaiting response" << std::endl;
    std::string response;
    file >> response;
    std::cout << "Response: " << response << std::endl;

    return 0;
} 
```

它编译得很好，但是在运行它时，Arduino 上的一些灯会闪烁，并且终端只是挂在：

> 打开 fstream

我哪里错了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-29T17:05:24.160

有三点：

**第一：**你没有在 Linux 端初始化串口（TTY）。没有人知道它处于什么状态。

在您的程序中执行此操作，您必须使用`tcgetattr(3)`和`tcsetattr(3)`。您可以在此站点、Arduino 站点或 Google 上使用这些关键字找到所需的参数。但*只是为了快速测试*，我建议在您调用自己的命令之前发出此命令：

```
stty -F /dev/tty.usbmodem641 sane raw pass8 -echo -hupcl clocal 9600 
```

尤其是丢失`clocal`可能会阻止您打开 TTY。

**第二：**当设备打开时，你应该稍等片刻再发送任何东西。默认情况下，当串行线打开或关闭时，Arduino 会重置。你必须考虑到这一点。

该`-hupcl`部件将在大多数情况下阻止此重置。但是至少需要一次复位，因为`-hupcl`只有在 TTY 已经打开并且此时 Arduino 已经收到复位信号时才能设置。因此`-hupcl`，“仅”会阻止未来的重置。

**第三：**您的代码中*没有*错误处理。请在 TTY 上的每个 IO 操作之后添加代码，以检查错误并且 - 最重要的部分 - 使用`perror(3)`或类似功能打印有用的错误消息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T01:28:58.483

我找到了 Jeff Gray 的一个很好的例子，说明如何使用`boost::asio`. 原始[代码清单可以在 boost 用户组中找到](http://boost.2283326.n4.nabble.com/Simple-serial-port-demonstration-with-boost-asio-asynchronous-I-O-td2582657.html)。这允许与原始帖子中提到的 GNU Screen 示例中的 Arduino 进行连接和通信。

代码示例（如下）需要与以下链接器标志链接

> -lboost_system-mt -lboost_thread-mt

...但是通过一些调整，对 boost 的一些依赖可以被新的 C++11 标准特性所取代。当我找到它时，我会发布修订版。就目前而言，这是一个坚实的基础。

```
/* minicom.cpp 
        A simple demonstration minicom client with Boost asio 

        Parameters: 
                baud rate 
                serial port (eg /dev/ttyS0 or COM1) 

        To end the application, send Ctrl-C on standard input 
*/ 

#include <deque> 
#include <iostream> 
#include <boost/bind.hpp> 
#include <boost/asio.hpp> 
#include <boost/asio/serial_port.hpp> 
#include <boost/thread.hpp> 
#include <boost/lexical_cast.hpp> 
#include <boost/date_time/posix_time/posix_time_types.hpp> 

#ifdef POSIX 
#include <termios.h> 
#endif 

using namespace std; 

class minicom_client 
{ 
public: 
        minicom_client(boost::asio::io_service& io_service, unsigned int baud, const string& device) 
                : active_(true), 
                  io_service_(io_service), 
                  serialPort(io_service, device) 
        { 
                if (!serialPort.is_open()) 
                { 
                        cerr << "Failed to open serial port\n"; 
                        return; 
                } 
                boost::asio::serial_port_base::baud_rate baud_option(baud); 
                serialPort.set_option(baud_option); // set the baud rate after the port has been opened 
                read_start(); 
        } 

        void write(const char msg) // pass the write data to the do_write function via the io service in the other thread 
        { 
                io_service_.post(boost::bind(&minicom_client::do_write, this, msg)); 
        } 

        void close() // call the do_close function via the io service in the other thread 
        { 
                io_service_.post(boost::bind(&minicom_client::do_close, this, boost::system::error_code())); 
        } 

        bool active() // return true if the socket is still active 
        { 
                return active_; 
        } 

private: 

        static const int max_read_length = 512; // maximum amount of data to read in one operation 

        void read_start(void) 
        { // Start an asynchronous read and call read_complete when it completes or fails 
                serialPort.async_read_some(boost::asio::buffer(read_msg_, max_read_length), 
                        boost::bind(&minicom_client::read_complete, 
                                this, 
                                boost::asio::placeholders::error, 
                                boost::asio::placeholders::bytes_transferred)); 
        } 

        void read_complete(const boost::system::error_code& error, size_t bytes_transferred) 
        { // the asynchronous read operation has now completed or failed and returned an error 
                if (!error) 
                { // read completed, so process the data 
                        cout.write(read_msg_, bytes_transferred); // echo to standard output 
                        read_start(); // start waiting for another asynchronous read again 
                } 
                else 
                        do_close(error); 
        } 

        void do_write(const char msg) 
        { // callback to handle write call from outside this class 
                bool write_in_progress = !write_msgs_.empty(); // is there anything currently being written? 
                write_msgs_.push_back(msg); // store in write buffer 
                if (!write_in_progress) // if nothing is currently being written, then start 
                        write_start(); 
        } 

        void write_start(void) 
        { // Start an asynchronous write and call write_complete when it completes or fails 
                boost::asio::async_write(serialPort, 
                        boost::asio::buffer(&write_msgs_.front(), 1), 
                        boost::bind(&minicom_client::write_complete, 
                                this, 
                                boost::asio::placeholders::error)); 
        } 

        void write_complete(const boost::system::error_code& error) 
        { // the asynchronous read operation has now completed or failed and returned an error 
                if (!error) 
                { // write completed, so send next write data 
                        write_msgs_.pop_front(); // remove the completed data 
                        if (!write_msgs_.empty()) // if there is anthing left to be written 
                                write_start(); // then start sending the next item in the buffer 
                } 
                else 
                        do_close(error); 
        } 

        void do_close(const boost::system::error_code& error) 
        { // something has gone wrong, so close the socket & make this object inactive 
                if (error == boost::asio::error::operation_aborted) // if this call is the result of a timer cancel() 
                        return; // ignore it because the connection cancelled the timer 
                if (error) 
                        cerr << "Error: " << error.message() << endl; // show the error message 
                else 
                        cout << "Error: Connection did not succeed.\n"; 
                cout << "Press Enter to exit\n"; 
                serialPort.close(); 
                active_ = false; 
        } 

private: 
        bool active_; // remains true while this object is still operating 
        boost::asio::io_service& io_service_; // the main IO service that runs this connection 
        boost::asio::serial_port serialPort; // the serial port this instance is connected to 
        char read_msg_[max_read_length]; // data read from the socket 
        deque<char> write_msgs_; // buffered write data 
}; 

int main(int argc, char* argv[]) 
{ 
// on Unix POSIX based systems, turn off line buffering of input, so cin.get() returns after every keypress 
// On other systems, you'll need to look for an equivalent 
#ifdef POSIX 
        termios stored_settings; 
        tcgetattr(0, &stored_settings); 
        termios new_settings = stored_settings; 
        new_settings.c_lflag &= (~ICANON); 
        new_settings.c_lflag &= (~ISIG); // don't automatically handle control-C 
        tcsetattr(0, TCSANOW, &new_settings); 
#endif 
        try 
        { 
                if (argc != 3) 
                { 
                        cerr << "Usage: minicom <baud> <device>\n"; 
                        return 1; 
                } 
                boost::asio::io_service io_service; 
                // define an instance of the main class of this program 
                minicom_client c(io_service, boost::lexical_cast<unsigned int>(argv[1]), argv[2]); 
                // run the IO service as a separate thread, so the main thread can block on standard input 
                boost::thread t(boost::bind(&boost::asio::io_service::run, &io_service)); 
                while (c.active()) // check the internal state of the connection to make sure it's still running 
                { 
                        char ch; 
                        cin.get(ch); // blocking wait for standard input 
                        if (ch == 3) // ctrl-C to end program 
                                break; 
                        c.write(ch); 
                } 
                c.close(); // close the minicom client connection 
                t.join(); // wait for the IO service thread to close 
        } 
        catch (exception& e) 
        { 
                cerr << "Exception: " << e.what() << "\n"; 
        } 
#ifdef POSIX // restore default buffering of standard input 
        tcsetattr(0, TCSANOW, &stored_settings); 
#endif 
        return 0; 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T07:21:52.933

您应该检查您是否有权访问`/dev/tty.usbmodem641`. Linux 中的常用方法是将用户添加到正确的组中`adduser`。

顺便说一句，我知道要访问串行端口，需要打开`/dev/ttyS0`（对于 COM1），直到`/dev/ttyS3`. 例如，请参见[C 中的此示例](http://www.comptechdoc.org/os/linux/programming/c/linux_pgcserial.html)。

# ios - Apple 会阻止我的 Game Kit 请求吗？

> ID：11677640
> 
> 赞同：1
> 
> 时间：2012-07-26T20:37:11.157
> 
> 标签：ios, game-center

当我为用户 Game Center 个人资料图片请求图像时出现此错误：

> 使用游戏中心检索玩家 ID G:188370944 的玩家图像失败：错误域 = GKErrorDomain 代码 = 3“由于与服务器通信时出错，无法完成请求的操作。”

我之前有它工作过。是否有可能我发送了太多请求并且 Apple 阻止了我访问沙盒开发服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-18T18:21:40.137

当播放器没有图像时会出现该错误。尝试在 Game Center 中上传玩家图像（尽管由于某种原因它将被 Apple 在沙盒中的默认图像替换）。

# javascript - 为什么这个javascript不能工作？

> ID：11677643
> 
> 赞同：0
> 
> 时间：2012-07-26T20:37:18.220
> 
> 标签：javascript

我正在尝试检测特定cookie“abc”的存在。我为此使用的代码是

```
var iterations = 0;
var interval = setInterval(checkCookie, 1000);
var cookie=getCookie("abc");
function checkCookie() {
    iterations++;    
    if (iterations >= 3 || cookie !=null || cookie !="")
        clearInterval(interval);
    alert("Iteration " + iterations );
} 
```

这段代码的唯一问题是它没有检测到 cookie 的存在。即使我将 cookie 名称更改为已经存在的名称。您可以在此处查看[http://jsfiddle.net/aMZj3/](http://jsfiddle.net/aMZj3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:40:16.130

您只在循环之前调用 GetCookie 一次，您希望将其移动到 checkCookie 函数中以在每次迭代时检查它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:01:47.813

**请注意：**据我所知，如果您在域 D1 下工作，那么您将无法读取另一个域 D2 设置的 cookie。这意味着如果 cookie “abc”是由您正在工作的同一个域设置的，那么您将能够读取它。

# iphone - 依赖分析错误

> ID：11677646
> 
> 赞同：2
> 
> 时间：2012-07-26T20:37:22.967
> 
> 标签：iphone, code-signing, provisioning-profile, archiving

向应用商店提交的项目收到了有关无效二进制文件的电子邮件。修复了错误，现在在尝试归档项目时**出现依赖分析错误**：

```
codesignerror: code signing is required for product type application in SDK iOS 5.1. 
```

**如何修复此错误？**

# vba - 从硬盘打开一个 csv 文件而不给出 csv 文件的位置

> ID：11677659
> 
> 赞同：-1
> 
> 时间：2012-07-26T20:38:42.663
> 
> 标签：vba, excel

如何使用 VBA 从硬盘打开 csv 文件而不给出文件的具体位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:46:10.973

```
Sub GetCSV()

    Dim sFile As String
    Dim wb As Workbook

    'You can get fancier with the "filter" argument, see the internet for more info
    sFile = Application.GetOpenFilename("*.csv,*.csv")

    'False means they clicked cancel
    If sFile <> "False" Then
        Set wb = Workbooks.Open(sFile)
        'do stuff
        wb.Close
    End If

End Sub 
```

# php - 使用 PHP 提交表单

> ID：11677664
> 
> 赞同：0
> 
> 时间：2012-07-26T20:38:58.527
> 
> 标签：php, jquery, html, json

我有一个实例，在该实例中，我使用单击提交按钮的事件在表单中的字段中填充值。但是，现在，我无法同时提交表单。我能做些什么？

[http://jsfiddle.net/cmfZX/14/](http://jsfiddle.net/cmfZX/14/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T20:41:44.307

只是不要`false`从表单的提交处理程序返回。

[http://jsfiddle.net/cmfZX/15/](http://jsfiddle.net/cmfZX/15/)

没有太多要说的了……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:42:18.480

您的事件处理程序返回`false`. 事件处理程序应返回除或不返回*任何*`false`内容，以使默认行为发生。

[这篇文章](http://fuelyourcoding.com/jquery-events-stop-misusing-return-false/)可能适合您阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:43:47.830

最后一个`return false`是阻止表单提交。一旦你把它拉出来，它应该运行得很好。您可能还需要考虑在第一个 onclick 事件中使用 JSON 更新表单字段，这样您就不必在提交时执行任何特殊操作。

# database - 在 Django 中，如何在导入和验证期间对夹具数据运行自定义清理函数？

> ID：11677667
> 
> 赞同：1
> 
> 时间：2012-07-26T20:39:09.580
> 
> 标签：database, django, validation, fixture

在 ModelForm 中，我可以编写一个`clean_<field_name>`成员函数来自动验证和清理用户输入的数据，但是在`manage.py loaddata`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:54:19.550

假设加载的夹具`loaddata`包含不需要验证的干净数据（通常作为先验的逆操作`dumpdata`），因此简短的回答是，如果您需要清理输入，则 loaddata 不是您想要的方法。

但是，您可能可以在实现自定义数据清理代码时使用 loaddata 的一些基础——我相信您可以使用 Django[序列化库](https://docs.djangoproject.com/en/dev/topics/serialization/)轻松编写脚本来读取现有数据文件并正常保存生成的对象数据清理完毕后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:54:21.283

如果其他人想做类似的事情，我定义了一个模型方法来进行清理（因此可以从 ModelForms 调用它）

```
MAX_ZIPCODE_DIGITS = 9
MIN_ZIPCODE_DIGITS = 5

def clean_zip_code(self, s=None):
    #s = str(s or self.zip_code)
    if not s: return None
    s = re.sub("\D","",s)
    if len(s)>self.MAX_ZIPCODE_DIGITS: 
        s = s[:self.MAX_ZIPCODE_DIGITS]
    if len(s) in (self.MIN_ZIPCODE_DIGITS-1,self.MAX_ZIPCODE_DIGITS-1):
        s = '0'+s # FIXME: deal with other intermediate lengths
    if len(s)>=self.MAX_ZIPCODE_DIGITS:
        s = s[:self.MIN_ZIPCODE_DIGITS]+'-'+s[self.MIN_ZIPCODE_DIGITS:] 
    return s 
```

`clean_`然后编写了一个独立的 python 脚本来使用模型中找到的任何方法来清理我的遗留 json 文件。

```
import os, json

def clean_json(app = 'XYZapp', model='Entity', fields='zip_code', cleaner_prefix='clean_'):
    # Set the DJANGO_SETTINGS_MODULE environment variable.
    os.environ['DJANGO_SETTINGS_MODULE'] = app+".settings"
    settings = __import__(app+'.settings').settings
    models   = __import__(app+'.models').models

    fpath    = os.path.join( settings.SITE_PROJECT_PATH, 'fixtures', model+'.json')
    if isinstance(fields,(str,unicode)):
        fields = [fields]
    Ns = []
    for field in fields:
        try:
            instance = getattr(models,model)()
        except AttributeError:
            print 'No model named %s could be found'%(model,)
            continue
        try:
            cleaner = getattr(instance, cleaner_prefix+field)
        except AttributeError:
            print 'No cleaner method named %s.%s could be found'%(model,cleaner_prefix+field)
            continue
        print 'Cleaning %s using %s.%s...'%(fpath,model,cleaner.__name__)
        fin = open(fpath,'r')
        if fin:
            l = json.load(fin)
            before = len(l)
            cleans = 0
            for i in range(len(l)):
                if 'fields' in l[i] and field in l[i]['fields']:
                    l[i]['fields'][field]=cleaner(l[i]['fields'][field]) # cleaner returns None to delete records
                    cleans += 1
            fin.close()
            after = len(l)
            assert after>.5*before
            Ns += [(before, after,cleans)]
            print 'Writing %d/%d (new/old) records after %d cleanups...'%Ns[-1]
            with open(fpath,'w') as fout:
                fout.write(json.dumps(l,indent=2,sort_keys=True))
    return Ns

if __name__ == '__main__':
    clean_json() 
```

# haml - 哈姆尔复巢

> ID：11677669
> 
> 赞同：0
> 
> 时间：2012-07-26T20:39:12.813
> 
> 标签：haml, nested

我在haml中阅读了一些简单的嵌套方式，但是当嵌套变得复杂时，我感到非常迷茫。

想用haml写这样的东西，但我一直失败

```
<p><div id="icon"></div>Subject: <span id="new_color">item name</span></p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:46:54.633

```
%p
  #icon
  Subject:&nbsp;
  %span#new_color
    item name 
```

# java - 我们应该在什么时候使用“public static final String”？

> ID：11677670
> 
> 赞同：56
> 
> 时间：2012-07-26T20:39:27.067
> 
> 标签：java, final

我见过很多人们编写`public static final String mystring = ...` 然后只使用一个值的代码。

为什么他们必须这样做？为什么他们必须在`final`使用之前初始化值？

**更新**

好的，谢谢大家的回答，我理解这些键的含义（公共静态最终）。我不明白的是为什么人们会使用它，即使常量只会在一个地方并且只在同一个类中使用。为什么要宣布它？为什么我们不只使用变量？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-07-26T20:40:51.177

`final`表示变量的值不会改变 - 换句话说，一个*常量*，其值在声明后无法修改。

`public final static String`当你想创建一个时使用`String`：

1.  属于类（`static`：不需要使用它的实例），即
2.  不会改变 ( `final`)，例如，当您想要定义一个`String`可用于该类的所有实例以及使用该类的其他对象的常量时，并且
3.  将是该类向世界展示的界面的可公开访问的部分。

例子：

```
public final static String MY_CONSTANT = "SomeValue";

// ... in some other code, possibly in another object, use the constant:
if (input.equals(MyClass.MY_CONSTANT) 
```

相似地：

```
public static final int ERROR_CODE = 127; 
```

不需要*使用*，但它可以`final`防止常量在程序执行期间被无意更改，并用作变量是否为常量的指示符。

即使该常量仅在当前类和/或仅在一个地方使用（读取），最好将所有常量声明为`final`：它更清晰，并且在代码的生命周期中，该常量可能最终被用于不止一处。

此外，使用`final`可以允许实现执行一些优化，例如通过内联使用常量的实际值。

最后请注意，这`final`只会从原始类型中生成真正的常量值，并且`String`是不可变的。应用于`final`对象（例如 a `HashMap`）将使*引用*不可变，但对象的状态不可变：例如可以更改对象的数据成员，可以更改数组元素，可以操作和更改集合。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-04-05T22:49:18.613

1.  静态意味着..您可以在不实例化类或使用任何对象的情况下使用它。
2.  final ..它是一个关键字，用于使字符串保持不变。您不能更改该字符串的值。看下面的例子：

    ```
     public class StringTest { 
               static final String str = "Hello"; 
      public static void main(String args[]) { 
               // str = "world"; // gives error 
               System.out.println(str); // called without the help of an object                       
               System.out.println(StringTest.str);// called with class name  
                 } 
             } 
    ```

谢谢

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-26T21:07:28.930

关键字*final*表示该值是恒定的（不能更改）。它类似于 C 中的 const。

您可以将*静态*视为具有范围的全局变量。这基本上意味着，如果您为一个对象更改它，它将像全局变量一样对所有对象进行更改（受范围限制）。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-26T20:43:34.900

`static`意味着该对象只会被创建一次，并且没有包含它的实例对象。当您拥有类的所有对象通用且永远不会改变的东西时，最好使用您编写的方式。它甚至可以在根本不创建对象的情况下使用。

通常最好在您期望的时候使用 final ，`final`这样编译器就会强制执行该规则并且您肯定知道。`static`如果所有对象的值相同，则确保您不会浪费内存来创建许多相同的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-26T20:42:05.893

`final`表示该值一旦设置就不能更改。 `static`允许您设置该值，并且该值对于使用它的类的所有实例都是相同的。此外，您可以访问没有`public static`类实例的字符串的值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-05-28T05:52:23.850

 **public**使其可以跨其他类访问。您可以在不实例化类或使用任何对象的情况下使用它。

 **静态**使其在所有类实例中具有统一的值。如果所有对象的值都相同，它可以确保您不会浪费内存来创建许多相同的东西。

 **final**使其值不可修改。这是一个“常量”值，在所有类实例中都是相同的，不能修改。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-08-09T04:01:47.970

您不必*使用*`final`，但它向`final`其他所有人（包括编译器）表明这是一个常量，这是它的好习惯。

为什么*即使常量只在一个地方并且只在同一个类中使用，*人们也会这样做：因为在许多情况下它仍然有意义。例如，如果您知道它在程序运行期间将是最终的，但您打算稍后更改该值并重新编译（更容易找到），并且以后可能会更频繁地使用它。它还在突出和组合的地方向其他程序员告知程序流程中的核心价值。

不幸的是，其他答案遗漏的一个方面是，使用组合`public final`需要**非常小心**，特别是如果其他类或包将使用您的类（可以假设，因为它是`public`）。

原因如下：

1.  因为它被声明为`final`，所以编译器会在编译期间将该字段内联到任何读取该字段的编译单元中。到现在为止还挺好。
2.  人们容易忘记的是，由于该字段也被声明`public`，编译器也会将此值内联到任何其他编译单元中。这意味着使用该字段的*其他类。*

后果是什么？

想象一下你有这个：

```
class Foo {
  public static final String VERSION = "1.0";
}

class Bar {
  public static void main(String[] args) {
    System.out.println("I am using version " + Foo.VERSION);
  }
} 
```

编译运行后`Bar`得到：

```
I am using version 1.0 
```

现在，您改进`Foo`并将版本更改为“1.1”。重新编译后`Foo`，你运行`Bar`并得到这个错误的输出：

```
I am using version 1.0 
```

发生这种情况，因为`VERSION`是声明`final`的，所以它的实际值已经在`Bar`第一次编译运行期间内联。因此，要让`public static final ...`字段示例在实际更改声明的内容后正确传播`final`（您撒谎！；），您需要*使用它重新编译每个类*。

我已经看过几次了，很难调试。

如果你的意思是一个*可能*在你的程序的更高版本中改变`final`的常量，一个更好的解决方案是：

 *```
class Foo {
  private static String version = "1.0";
  public static final String getVersion() {
    return version;
  }
} 
```

这样做的性能损失可以忽略不计，因为 JIT 代码生成器将在运行时内联它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-26T20:42:50.420

通常用于定义常量，您可以在许多地方重用它们，使其成为单点更改，在单个类中使用或跨包共享。使变量最终避免意外更改。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-17T23:26:25.960

为什么人们在类中使用常量而不是变量？

可读性和可维护性，

在你的代码中有一些像 40.023 这样的数字并不能说明这个数字代表什么，所以我们用大写的单词替换它，比如“USER_AGE_YEARS”。稍后当我们查看代码时，很清楚该数字代表什么。

为什么我们不只使用变量？好吧，如果我们知道这个数字会改变，但如果它的某个数字不会改变，比如 3.14159.. 我们会确定它是最终的。

但是如果它不是像字符串这样的数字呢？在这种情况下，它主要是为了可维护性，如果您在代码中多次使用字符串（并且它不会在运行时更改），那么将它作为类顶部的最终字符串很方便。这样当你想改变它时，只有一个地方可以改变它而不是很多。

例如，如果您的代码中有一条错误消息多次打印，则最终 String ERROR_MESSAGE = "Something go bad." 更容易维护，如果您想将其从“出现问题”更改。到“为时已晚，吉姆他已经死了”，您只需要更改那一行，而不是您将使用该评论的所有地方。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-02-17T19:07:35.817

`public`使其可以跨其他类访问。 `static`使其在所有类实例中具有统一的值。 `final`使其成为不可修改的值。所以基本上它是一个“**常量**”值，在所有类实例中都是相同的，并且不能修改。关于您的关注“我不明白的是为什么人们使用它，即使常量只在一个地方并且只在同一个类中使用。为什么要声明它？为什么我们不只使用变量？” 我想说，因为它是一个公共字段，所以常量值也可以使用 ClassName.value 在其他类的其他地方使用。例如：一个名为 Math 的类可能将 PI 作为最终的静态 long 值，可以作为 Math.PI 访问。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-02-20T06:13:40.953

这是一种标准/最佳实践。已经有列出场景的答案，但是对于您的第二个问题：

> 为什么他们必须这样做？为什么他们必须在使用之前将值初始化为最终值？

声明时初始化的公共常量和字段应该是“静态最终”，而不仅仅是“最终”

以下是它应该是这样的一些原因：

1.  将公共常量设置为 final 而不是 static final 会导致为类的每个实例复制其值，从而无用地增加执行应用程序所需的内存量。

2.  此外，当非公共的 final 字段也不是静态的时，这意味着不同的实例可以具有不同的值。[但是，由于final](https://stackoverflow.com/a/15655032/5511336)字段的行为，在其声明中初始化非静态 final 字段会强制每个实例具有相同的值。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-08T10:51:44.740

这与代码的语义有关。通过命名将其分配给具有有意义名称的变量的值（即使它仅在一个地方使用），您就可以赋予它意义。当有人阅读代码时，该人将知道该值的含义。

通常，在代码中使用常量值不是一个好习惯。想象一个充满字符串、整数等值的代码。一段时间后，没有人会知道这些常数是什么。当值在多个地方使用时，值中的拼写错误也可能成为问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-03T15:12:36.320

我想这些都是清楚的解释。但是，让我通过给出一个 java inbuild 示例来澄清它。

在 java 中，大多数人会使用 System.out.println()

**system**是一个类，out**是**一个 PrintStream 类。

所以 java 说的是我将负责 out 对象（PrintStream）的初始化，并在 System 类中将初始化保持为我自己的私有。

```
public final class System {

    public final static PrintStream out = null;

    //Some initialization done by system class which cannot be changed as it is final.
} 
```

您只需静态访问**println**方法，而不用担心它的初始化。*

# eclipse - 为什么我的进口商品无法识别

> ID：11677673
> 
> 赞同：7
> 
> 时间：2012-07-26T20:39:38.273
> 
> 标签：eclipse, jersey, eclipse-wtp

首先使用 EClipse：我创建了一个动态 Web 项目并将 soem JAR 文件（Jersey Jar 文件）复制到该项目的 WebContent\WEB-INF\lib 文件夹中。

![在此处输入图像描述](../Images/c8c2bbfa7931e27f00b000bc8c8ea241.png)

然后我创建了一个新类，在它之上我使用了一些导入，例如：

```
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType; 
```

但它在所有错误旁边显示一些红色 X 错误，表示无法解决导入问题。

这就是我所做的一切。我应该做任何其他设置来修复这些错误吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-08-07T19:45:58.403

Jersey 新手的附加信息：这些导入来自 javax.ws.rs-api-2.0.jar，它位于 Jersey 下载的“api”目录中，而不是 jersey-*.jar 的“lib”目录中罐子。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-26T20:49:44.340

首先，确保您对项目运行“刷新”。如果没有找到 JAR，则在 Eclipse 的项目资源管理器中导航到它们，右键单击它们并在弹出菜单中使用“构建路径”>“添加到构建路径”。

# spring - 在保持先前功能的同时扩展 Spring 集成？

> ID：11677675
> 
> 赞同：0
> 
> 时间：2012-07-26T20:39:40.340
> 
> 标签：spring, spring-integration, enterprise-integration

所以我是 Spring Integration 的新手，而且主要是 Spring 的新手，所以我可能不会掌握所有的术语，但我遇到了以下场景：

我有一个带有三个 SI 流的小型 Spring Integration 应用程序......每个流都有自己的网关，每个网关都有自己的请求通道和回复通道。这些流接收一个空调用（出于所有密集目的......基本上只是一个“GO”信号/空消息）并回复一个状态消息，具体取决于（微不足道的）业务逻辑结果。

我现在想将这些流中的每一个连接在一起，以便在一个“主流”中运行，给定一个请求，而不剥夺它们单独运行的能力，我想通过注释/XML（IE.给定一个调用主网关服务接口的控制器，不需要在注释/ XML 配置之外编写额外的代码。）

这是否可行，我应该使用哪些集成组件来做到这一点，和/或我是否应该只是调整每个网关的预期通道以端到端地相互会面（如果是这样，该策略将如何补偿以允许根据具体情况调用每个流）？

此外，如果这不可行，是否适合使用服务激活器来调用每个子流？我想避免更多地编码，但如果这是唯一的选择，我想它必须这样做。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:33:31.423

可能最简单的方法是使用 Spring Profiles（Spring 3.1 的一个特性）。当以独立模式部署时，最终元素可以是“通往无处的桥梁”......

```
<int:bridge input-channel="app1Final" /> 
```

...当流中的最后一个元素没有输出通道时，消息将返回到网关的回复通道。如果您更喜欢显式配置网桥以指向网关的回复通道，那也可以；它只是不需要。

在“链接”配置文件中，您可以这样配置网桥...

```
<int:bridge input-channel="app1Final" output-channel="app2Inbound"/> 
```

...其中 app2Inbound 与该应用程序的网关的请求通道相同。

```
<beans profile="default">
    <int:bridge input-channel="app1Final" />
</beans>

<beans profile="linked">
    <int:bridge input-channel="app1Final" output-channel="app2Inbound"/>
</beans> 
```

要使用链接的配置文件运行，请将系统属性“spring.profiles.active”设置为“链接”

# c# - 从另一个服务重新启动 NetworkService 服务

> ID：11677680
> 
> 赞同：0
> 
> 时间：2012-07-26T20:40:06.240
> 
> 标签：c#, .net, windows-services

我有一个作为 NetworkService 运行的 Windows 服务 MyService（用 C# 实现）。MyService 需要启动另一个第三方服务 TheyService，它也作为 NetworkService 运行。尝试使用以下代码从 MyService 尝试启动 TheyService 失败并出现访问被拒绝错误：

```
 public static bool StartService(string serviceName, TimeSpan timeout)
    {
        bool started = false;
        try
        {
            using (ServiceController sc = new ServiceController(serviceName))
            {
                if (sc != null)
                {
                    sc.Refresh();
                    if (sc.Status == ServiceControllerStatus.Running)
                    {
                        // Stop service
                        Trace.TraceInformation("Util.StartService Stopping service '{0}'...", serviceName);
                        sc.Stop();
                    }

                    sc.WaitForStatus(ServiceControllerStatus.Stopped, timeout);
                    sc.Refresh();

                    // Start service
                    Trace.TraceInformation("Util.StartService Starting service '{0}'...", serviceName);
                    sc.Start();

                    sc.WaitForStatus(ServiceControllerStatus.Running, timeout);
                    sc.Refresh();

                    started = (sc.Status == ServiceControllerStatus.Running);
                }
            }

        }
        catch (Exception e)
        {
            Trace.TraceError("Util.StartService Exception occurred while starting service '{0}'.\n{1}\n{2}", serviceName, e.Message, e.StackTrace);
        }

        Trace.TraceInformation("Util.StartService Service '{0}' restarted? {1}", serviceName, started);
        return started;
    } 
```

他们的服务的 SID 信息：

```
C:\>sc showsid TheirService
NAME: TheirService
SERVICE SID: S-1-5-80-3034156332-2544749427-1608259134-1317875859-4063208518 
```

有没有办法从 C# 以编程方式从 MyService 启动TheyService？

编辑：目标 - 作为 MyService 安装的一部分，我希望能够重新启动 TheyService。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:45:04.060

服务设置为以何种方式运行并不重要。您需要提升为管理员才能启动/停止 Windows 服务。

或者，您可以[授予 NetworkService](http://msmvps.com/blogs/erikr/archive/2007/09/26/set-permissions-on-a-specific-service-windows.aspx)控制它的权限，但这些授权需要由管理员进行，也许在安装您的服务时。它还削弱了第 3 方服务的安全性，因为任何作为 NetworkService 运行的人都可以重新启动它，这违背了 NetworkService 帐户的最低权限目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:51:42.537

您需要提升此服务的权限。一个黑客将拥有一个中间的“本地系统”服务，它执行你想要的并从你的网络服务接收命令。

**编辑：** 如果可以修改“TheirService”，那么您可以从您的服务向它发送一个命令，然后它会根据[这个答案](https://stackoverflow.com/questions/220382/how-can-a-windows-service-programmatically-restart-itself)自行重启。

# r - cat() 输出整数而不是 R 中的列表值

> ID：11677685
> 
> 赞同：2
> 
> 时间：2012-07-26T20:40:38.887
> 
> 标签：r, console, terminal, cat

这是我的列表的输入：

```
structure(c(5L, 3L, 1L), .Label = c("id0", "id1", "id2", "id3",
"id4"), class = "factor") 
```

其中，当我们使用`print()`输出时

```
[1] id4 id0 id2 
```

这是我想要的减去`[1]`

为了摆脱它，我使用`cat()`，但是当我这样做时，这是输出

```
5 3 1 
```

这似乎对应于`c(5L,3L,1L)`上面的位，但我不明白为什么。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:10:01.400

因为您的“列表”确实是一个因素……将其转换为字符，您将得到您所期望的。

```
> l <- structure(c(5L, 3L, 1L), .Label = c("id0", "id1", "id2", "id3",
+ "id4"), class = "factor")
> cat(l, "\n")
5 3 1
> cat(as.character(l),"\n")
id4 id2 id0 
```

# twitter - 有没有办法用 socialite.js 异步加载 twitter 小部件？

> ID：11677687
> 
> 赞同：1
> 
> 时间：2012-07-26T20:40:46.883
> 
> 标签：twitter, widget, social-networking, feed, asynchronous

嗨，我使用了 socialite.js 插件来显示社交网络按钮，但这与标准的 twitter 小部件/提要冲突。无论如何，是否可以使用社交名流加载小部件并尽可能异步执行？谢谢你的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T14:32:13.390

我最近写了一篇关于这个确切插件的文章。在以下位置查看：

[http://www.deanhume.com/Home/BlogPost/lazy-loading-social-sharing-buttons/73](http://www.deanhume.com/Home/BlogPost/lazy-loading-social-sharing-buttons/73)

它仅涵盖在社交按钮位于视口中时加载它，但也有一些其他选项可用。

# gridview - Telerik Edit 命令需要解决

> ID：11677712
> 
> 赞同：1
> 
> 时间：2012-07-26T20:42:33.127
> 
> 标签：gridview, telerik, radgrid

嗨，我有一个表格，它接受所有带有提交和重置按钮的员工详细信息。当用户点击提交时，数据将显示在表格下方的telerik 网格中。

来到 Telerik 网格，我只有 empid 和 empname 、编辑、删除按钮。

当用户单击编辑按钮时，要求是使用他们输入的原始数据加载表单并希望在表单中对其进行编辑，当他们单击提交按钮时，他们希望完成更新操作。

当我在单击编辑时添加 radgrid_edicommand 时，它会列出 2 个文本框（我在网格中），其中包含员工 ID 和员工姓名。如何在顶部屏幕中加载数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T09:36:31.843

请检查下面的代码片段。

.aspx

```
<div>
    <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
    <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
    <asp:Button ID="Button4" runat="server" Text="SAVE" OnClick="Button4_Click" />
    <telerik:RadGrid ID="RadGrid1" runat="server" AutoGenerateColumns="false" OnNeedDataSource="RadGrid1_NeedDataSource"
        OnItemCommand="RadGrid1_ItemCommand">
        <MasterTableView DataKeyNames="ID">
            <Columns>
                <telerik:GridBoundColumn HeaderText="Name" DataField="Name" UniqueName="Name">
                </telerik:GridBoundColumn>
                <telerik:GridBoundColumn HeaderText="ID" DataField="ID" UniqueName="ID">
                </telerik:GridBoundColumn>
                <telerik:GridEditCommandColumn>
                </telerik:GridEditCommandColumn>
            </Columns>
        </MasterTableView>
        <ClientSettings>
        </ClientSettings>
    </telerik:RadGrid>
</div> 
```

.aspx.cs

```
protected void RadGrid1_NeedDataSource(object sender, GridNeedDataSourceEventArgs e)
{
    dynamic data = new[] {
            new { ID = 1, Name ="Name1"},
            new { ID = 2, Name = "Name2"},
            new { ID = 3, Name = "Name3"}
        };

    RadGrid1.DataSource = data;
}
protected void RadGrid1_ItemCommand(object sender, GridCommandEventArgs e)
{
    if (e.CommandName == RadGrid.EditCommandName)
    {
        GridDataItem item = e.Item as GridDataItem;
        // using DataKey get ID
        Label1.Text = item.GetDataKeyValue("ID").ToString();
        // using Column Get name
        TextBox1.Text = item["Name"].Text;
        e.Canceled = true;
    }
}
protected void Button4_Click(object sender, EventArgs e)
{
    //your logic
} 
```

如果这不是您的情况，请查看以下链接。 [http://demos.telerik.com/aspnet-ajax/grid/examples/dataediting/templateformupdate/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/grid/examples/dataediting/templateformupdate/defaultcs.aspx)

让我知道是否有任何问题。

# ios - 一种从 Bonjour 搜索结果中排除自我的方法

> ID：11677715
> 
> 赞同：2
> 
> 时间：2012-07-26T20:42:48.657
> 
> 标签：ios, cocoa-touch, bonjour

当同一个应用程序同时充当启用 Bonjour 的服务和客户端时，在侦听套接字的同时浏览类似自我的服务，有什么好方法可以从服务搜索结果中排除自我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-30T13:54:02.853

在您的 NSNetServiceBrowserDelegate 中，您只需询问传入服务是否与您发布的服务相同：

```
-(void)netServiceBrowser:(NSNetServiceBrowser *)netServiceBrowser didFindService:(NSNetService *)netService moreComing:(BOOL)moreComing
{
    if ([netService isEqual:self.publishedNetService])
        return;
    …
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T12:53:40.180

在服务器部分，当我向 Bonjour 注册我的服务时，我会生成一个 10 个字符的随机字母数字字符串 - 一个 cookie。我将其作为广告服务名称的一部分，如对`[NSNetService initWithDomain:type:name:port:]`. 结果名称类似于“Joe 的 iPhone\txYbG56HjaE 上的 MyApp”。制表符之前的部分用于显示，之后的部分是cookie。然后我存储的 cookie 是一个全局可见的变量。由于服务器初始化发生在应用程序启动时，cookie 值在早期可用。

在服务发现部分，当我找到一个服务时，我检查它的名字；如果 cookie 与存储的全局 cookie 相同，我将跳过此服务。这个想法是程序的其他运行实例将具有不同的 cookie 值，因为随机性。

自然，当在 UI 中显示发现的服务名称时，我会跳过制表符后面的部分。

# java - if和逻辑运算符之间的性能差异是什么

> ID：11677717
> 
> 赞同：2
> 
> 时间：2012-07-26T20:42:54.010
> 
> 标签：java, performance

我想知道当我使用逻辑运算符而不是几个 if 语句时是否会有性能差异。我看到了一个不错的[链接](http://jacksondunstan.com/articles/810)，这也适用于 java 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T21:00:58.947

我刚刚创建了类

```
class Test{
    static java.util.Random r=new java.util.Random();
    boolean test(){
        return r.nextBoolean();
    }
    void test1(){
        if (test() && test() && test())
            System.out.println("3x yes");
    }
    void test2(){
        if (test())
            if (test()) 
                if (test())
                    System.out.println("3x yes");
    }
} 
```

编译它然后通过**javap -c Test**反编译并得到这些结果

```
class Test {
  static java.util.Random r;

  Test();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":
()V
       4: return

  boolean test();
    Code:
       0: getstatic     #2                  // Field r:Ljava/util/Random;
       3: invokevirtual #3                  // Method java/util/Random.nextBoole
an:()Z
       6: ireturn

  void test1();
    Code:
       0: aload_0
       1: invokevirtual #4                  // Method test:()Z
       4: ifeq          29
       7: aload_0
       8: invokevirtual #4                  // Method test:()Z
      11: ifeq          29
      14: aload_0
      15: invokevirtual #4                  // Method test:()Z
      18: ifeq          29
      21: getstatic     #5                  // Field java/lang/System.out:Ljava/
io/PrintStream;
      24: ldc           #6                  // String 3x yes
      26: invokevirtual #7                  // Method java/io/PrintStream.printl
n:(Ljava/lang/String;)V
      29: return

  void test2();
    Code:
       0: aload_0
       1: invokevirtual #4                  // Method test:()Z
       4: ifeq          29
       7: aload_0
       8: invokevirtual #4                  // Method test:()Z
      11: ifeq          29
      14: aload_0
      15: invokevirtual #4                  // Method test:()Z
      18: ifeq          29
      21: getstatic     #5                  // Field java/lang/System.out:Ljava/
io/PrintStream;
      24: ldc           #6                  // String 3x yes
      26: invokevirtual #7                  // Method java/io/PrintStream.printl
n:(Ljava/lang/String;)V
      29: return

  static {};
    Code:
       0: new           #8                  // class java/util/Random
       3: dup
       4: invokespecial #9                  // Method java/util/Random."<init>":
()V
       7: putstatic     #2                  // Field r:Ljava/util/Random;
      10: return
} 
```

如您所见`test1`和`test2`的字节码相同，因此使用没有区别

```
 if (test() && test() && test()) 
```

或者

```
 if (test())
        if (test()) 
            if (test()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:57:40.687

它取决于实现 - 因此您需要确定基准。

话虽如此，大多数 JIT 编译器都足够聪明，可以非常有效地优化布尔比较，因此您不太可能看到任何差异。

逻辑运算符可能提供显着优势的唯一领域是您使用它们执行按位计算的情况。这可能非常有效，因为它可能导致利用硬件指令的无分支代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T01:37:45.673

两种形式都编译为相同的代码。与其他答案中的建议相反，这不是“优化”，如果不同的编译器做了不同的事情，那将是令人惊讶的。编译 && 只有一种明智的方法，那就是将其与另一个“if”相同。我什至想不出一个不明智的方法。

# java - 不可解析的父 POM：找不到工件

> ID：11677734
> 
> 赞同：14
> 
> 时间：2012-07-26T20:43:58.147
> 
> 标签：java, maven, build, jar, agent

我最近研究了[Gorilla Logic 的](http://gorillalogic.com)开源测试工具，需要进行一些更改才能将某些内容记录到控制台。我已经从“Android 代理”的源代码控制中检查了代码，现在我正在寻找构建一个新的 .jar 代理文件。我需要使用
`mvn clean install`来构建 .jar 文件。当我尝试构建它时，命令行给出了这个错误
`Non-resolvable parent POM: Could not find artifact com.gorillalogic.monkeytalk:monkeytalk:pom:1.0.12-SNAPSHOT and 'parent.relativePath' points at wrong local POM @ line 6, column 10 -> [Help 2]`

谁能帮我解决这个问题或让我知道这意味着什么？谢谢。:) 我不懂 maven，只想知道它是什么意思。

这是 pom.xml 文件第 6-10 行

```
<parent> 
<groupId>com.gorillalogic.monkeytalk</groupId>
    <artifactId>monkeytalk</artifactId>
    <version>1.0.12-SNAPSHOT</version>
    <relativePath>/Users/henry/Desktop/monkeytalk-agent-android/parent/pom.xml</relativePath>
</parent> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T20:52:01.317

这个项目似乎是另一个 maven 项目“moneytalk”下的模块项目。由于本项目可以继承父项目的属性、依赖管理信息、插件信息，maven会尝试读取父pom.xml。如果父 pom.xml 在指定位置不可用，maven 构建将失败。

一种选择是检查所有项目，包括父项目。其他选项是将父项目的 pom.xml 放在所需位置（在您的情况下为 /Users/henry/Desktop/monkeytalk-agent-android/parent/pom.xml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-02T19:17:10.387

如果项目背后有很多依赖项，则必须在构建主项目之前先对它们进行模式化。

清理、编译和安装此类依赖项（来自 IDE 右侧的“Maven”窗格）。首先将其项目中包含的此类依赖项移动到相同的主项目目录。

最后，清理、编译和安装主项目。

# java - 寻求正确的模式以将相同的规则应用于不同的数据集

> ID：11677735
> 
> 赞同：0
> 
> 时间：2012-07-26T20:44:01.617
> 
> 标签：java, algorithm, design-patterns

假设您有 a `List<Elements>`in memory 和 a `List<Files>`，每个都是一个序列化的表示`List<Elements>`

目标是对每个元素执行相同的算法。

假设工作是计算元素

```
int i = 0;
for (Element e : list) {
       ++i;
}

for (File f : directory()) {
    for (Element e : listWeSomehowGetFromTheFile) {
           ++i;
    }
} 
```

这可以以某种方式进一步抽象吗？本质上，算法是相同的（`++i`）。有没有办法清理这个？

我当然可以拥有它自己的类`Counter(List<Element>)`，它具有`count ()`在列表中运行算法的方法。这样我们可以：

```
 i+=Counter.count(list);
 for (File f : directory()) {
   i+=Counter.count(listWeSomehowGetFromTheFile);
 } 
```

但即使这样似乎也可以改进。

出于本示例的目的，假设所有操作（其中一堆）都将在内存中的列表和来自相同目录中相同文件的列表上执行。唯一会改变的是算法。

哪种模式最适合处理这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:47:30.157

当您想对集合中的每个项目执行某些操作时，[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)非常流行。

访问者模式也很好，因为它允许您扩展您可以执行的计算，而无需重写访问者操作的类。

如果您不需要完全遵循正式模式，

1）定义一个接口，就像一个接受一个元素并进行操作`Operation`的方法一样。 2）您的计算是. 3）循环你的元素，将元素传递给你的操作实现。`calculate`
`Operation`

如果计算的结果是累积的（取决于先前对其他元素的计算调用），您可以修改`calculate`以获取包含计算状态的对象，然后在`calculate`针对元素触发时更新状态。您不断将相同的状态对象传递给每个计算调用。

作为大纲（这不会编译）：

```
public Interface Operation {
   // don't necessarily need state
   public void calculate (Element e, State state);
}

CountOp extends Operation {
   count = 0;

   public void calculate(Element e, State state){
      // not using element or state because this is so simple....
      count++;
   }
}

Operation op = new CountOp();
State state = new SomeStateImpl();
for (File f : directory()) {
    for (Element e : listWeSomehowGetFromTheFile) {
          op.calculate(e, state);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T22:57:10.460

我可能会误解，但我处理这个问题的方法是根据（惰性）序列编写函数 - 将文件中的列表和数据都制作成惰性值序列很容易。

在更实际的情况下，java 中的惰性流通常实现为可迭代对象（或迭代器，如果您不需要重新启动），并且 guava 库有许多[实用程序](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterators.html)可以处理这些。

this assumes that elements are of the same type. the visitor pattern is more suited for when the data structure you are processing has different types (the visitor is where you do type based dispatch; that's not necessary for a single type, so the visitor pattern for a single type is equivalent to generating a stream of data - in that case it's simpler to use existing iterators).

# json - Ext JS 4：返回 .NET 可为空的 DateTime？从 web 方法作为 JSON 对象到 ExtJS 不在 Ext.grid.Panel 中显示

> ID：11677738
> 
> 赞同：0
> 
> 时间：2012-07-26T20:44:13.607
> 
> 标签：json, datetime, date, extjs, grid

我正在通过 Ext JS JSON 代理从 JSON Web 服务返回 .NET 序列化对象（项目对象）列表。 ***我无法让我的 Ext.grid.Panel 正确显示我的日期格式字段。为什么会这样？*** 在下面搜索“这个”。所有其他字段都在我的 Ext 网格中正确显示。当我从日历控件中保存日期时，它会将日期正确地存储在数据库中。为了排除其他问题，我在我的对象中为您硬编码了日期。

**序列化类：**

```
 [Serializable]
    public class Project
    {
        public string project_id;
        public string project_number;
        public string project_name;
        public string description;
        public DateTime? date_start;
    } 
```

**网络方法：**

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json, UseHttpGet = false, XmlSerializeString = false)]
    public List<Project> GetProjects(string myTest, string bar)
    {
        Database db = DatabaseFactory.CreateDatabase("HIMC-DEV");

        DbCommand cmd = db.GetStoredProcCommand("project_get_list");
        db.AddInParameter(cmd, "@user_id", DbType.String, "");

        DataSet ds = db.ExecuteDataSet(cmd);
        DataTable dt = ds.Tables[0];
        List<Project> projectList = new List<Project>();
        foreach (DataRow row in dt.Rows)
        {
            Project p = new Project();
            p.project_id = row[0].ToString();
            p.project_number = row[1].ToString();
            p.project_name = row[2].ToString();
            p.description = row[3].ToString();
            p.date_start = new DateTime(2012, 1, 12);  // <=== this one
            projectList.Add(p);
        }

        return projectList;
    } 
```

**分机型号：**

```
Ext.define('Project', {
    extend: 'Ext.data.Model',
    fields: [
        { name: 'project_id' },
        { name: 'project_name' },
        { name: 'project_number' },
        { name: 'description' },
        { name: 'date_start', type: 'date' }
    ]
}); 
```

**JSON代理：**

```
Ext.define('Ext.ux.AspWebAjaxProxy', {
    extend: 'Ext.data.proxy.Ajax',
    require: 'Ext.data',

    buildRequest: function (operation) {
        var params = Ext.applyIf(operation.params || {}, this.extraParams || {}),
                                request;
        params = Ext.applyIf(params, this.getParams(params, operation));
        if (operation.id && !params.id) {
            params.id = operation.id;
        }

        params = Ext.JSON.encode(params);

        request = Ext.create('Ext.data.Request', {
            params: params,
            action: operation.action,
            records: operation.records,
            operation: operation,
            url: operation.url
        });
        request.url = this.buildUrl(request);
        operation.request = request;
        return request;
    }
}); 
```

**带有嵌入式表单的 Ext Window：**

```
 Ext.define('ProjectEdit', {
        extend: 'Ext.window.Window',

        alias: 'widget.projectedit',
        title: 'Edit Project',
        layout: 'fit',
        autoShow: true,
        closable : true,

        initComponent: function () {
            this.items = [
                {
                    xtype: 'form',
                    width: 650,
                    height: 300,
                    bodyPadding: 20,
                    items: [
                        {
                            xtype: 'textfield',
                            name: 'project_id',
                            fieldLabel: 'Project ID'
                            //disabled: true
                        },
                        {
                            xtype: 'textfield',
                            name: 'project_number',
                            fieldLabel: 'Project Number'
                        },
                        {
                            xtype: 'textfield',
                            name: 'project_name',
                            fieldLabel: 'Project Name'
                        },
                        {
                            xtype: 'datefield',
                            format: 'm/d/Y',
                            allowBlank: true,
                            name: 'date_start',
                            fieldLabel: 'Start Date'
                        },
                        {
                            xtype: 'combo',
                            fieldLabel: 'Manager',
                            emptyText: 'select keyword',
                            store: keywordStore,
                            valueField: 'name',
                            displayField: 'name',
                            mode: 'remote',
                            autoSelect: false,
                            selectOnFocus: true,
                            shadow: true,
                            forceSelection: true,
                            triggerAction: 'all',  // not sure what this is?
                            hideTrigger: true,
                            //multiSelect:true,
                            typeAhead: true,
                            minChars: 1,
                            renderTo: document.body
                        },
                        {
                            xtype: 'htmleditor',
                            name: 'description',
                            fieldLabel: 'Description',
                            enableColors: false,
                            enableAlignments: false,
                            width: '100%'
                        }
                    ]

                }
            ];
... 
```

**外部网格：**

```
 Ext.define('ProjectGrid', {
        extend: 'Ext.grid.Panel',

        initComponent: function () {
            var me = this;

            Ext.applyIf(me, {
                store: store,
                columns: [
                    { text: 'Project ID', dataIndex: 'project_id', sortable: true },
                    { text: 'Project Number', dataIndex: 'project_number', sortable: true },
                    { text: 'Project Name', dataIndex: 'project_name', sortable: true, width: 300 },
                    { text: 'Start Date', dataIndex: 'date_start', sortable: true, width: 300, renderer: Ext.util.Format.dateRenderer('Y-m-d') },
                    { text: 'Description', dataIndex: 'description', sortable: true, width: 500 }
                ],
                listeners: {
                    //itemdblclick: this.editProject
                    itemdblclick: function(view, record, item, index, e) {
                        //var w = new ProjectEdit();
                        var w = Ext.widget('projectedit');
                        w.show();  // show the window
                        w.down('form').loadRecord(record);  // load the record in the form
                        w.callback = Ext.bind(this.editProject, this); // bind lets you set the scope of the callback (for the project that was double clicked)
                    }
                }
            });

            me.callParent(arguments);
        },

...

    }); 
```

**来自 Firebug NET 选项卡的 JSON 请求图像（在新选项卡中打开以使其更大）：**

![在此处输入图像描述](../Images/09bb8a3f34e4a72fe5b116573c012ec6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:55:15.417

您遇到的问题似乎与此日期字段的日期格式有关。
默认情况下，ExtJS 期望以不同于 .Net 使用的格式发送日期。

通过以下方式更新模型应该会有所帮助：

```
{ name: 'date_start', type: 'date', dateFormat: 'MS' } 
```

或者

```
{ name: 'date_start', type: 'date', dateFormat: 'U' } 
```

请参阅 ExtJS API 了解[dateFormat](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.Field-cfg-dateFormat)及其可能的[值](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.Date)。

# php - 通过 php 下载 Google Play APK

> ID：11677743
> 
> 赞同：2
> 
> 时间：2012-07-26T20:44:43.513
> 
> 标签：php, download, apk, google-play

我需要通过 php 下载 google play android 文件 (APK)，但如您所知，它不承诺通过 pc 来完成。它是如何工作的，如何通过 php 下载 apk？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:47:25.460

您可能会从中获得一些提示：[http](http://codekiem.com/2012/02/24/apk-downloader/) ://codekiem.com/2012/02/24/apk-downloader/ - 可以解压缩扩展的 crx 文件。它包含 javascript 形式的源代码，它执行一些 HTTP 操作来下载 APK。应该可以在 PHP 中复制它。

笔记：

1.  这违反了市场 ToS
2.  这需要一个谷歌帐户和一个设备 ID

# mysql - 使用地理跟踪和 SQL 查询

> ID：11677745
> 
> 赞同：0
> 
> 时间：2012-07-26T20:45:01.557
> 
> 标签：mysql, search, geolocation, geocoding

我正在构建一个数据库，用户将能够在其中输入他们正在寻找的搜索字段，并且我需要以最接近用户的人将首先显示的方式列出结果，并进一步工作从用户的当前位置。

所以我正在寻找一种在查询中包含（因素）地理位置的方法。该数据库将有许多字段可供搜索，包括每个字段的位置。

这整个过程将很像谷歌的地图位置搜索（即搜索“我附近的餐厅”）。

我试过用谷歌搜索这个答案，我在其他论坛上问过，我已经搜索了 stackoverflow，但还没有找到帮助来完成这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:50:06.940

您可以使用 MySQL Spatial Extensions 按距离对结果进行排序

[http://dev.mysql.com/doc/refman/5.5/en/spatial-extensions.html](http://dev.mysql.com/doc/refman/5.5/en/spatial-extensions.html)

这使您可以执行以下查询

```
SELECT name, AsText(location), SQRT(POW( ABS( X(location) - X(@center)), 2) + POW( ABS(Y(location) - Y(@center)), 2 )) AS distance 
FROM Points 
WHERE Intersects( location, GeomFromText(@bbox) ) 
AND SQRT(POW( ABS( X(location) - X(@center)), 2) + POW( ABS(Y(location) - Y(@center)), 2 )) < @radius 
ORDER BY distance; 
```

[http://howto-use-mysql-spatial-ext.blogspot.com/](http://howto-use-mysql-spatial-ext.blogspot.com/)

# scala - 在 Scala 宏中使用 LabelDef (2.10)

> ID：11677750
> 
> 赞同：5
> 
> 时间：2012-07-26T20:45:24.707
> 
> 标签：scala, macros, scala-2.10, scala-macros

我正在尝试使用 scala 2.10 宏功能。不过，在某些情况下，我无法使用**LabelDef 。**在某种程度上，我偷看了编译器的代码，阅读了[Miguel Garcia 的论文](http://lampwww.epfl.ch/~magarcia)节选，但我仍然卡住了。

*如果我的理解是正确*的，伪定义将是：
`LabelDef(labelName, listOfParameters, stmsAndApply)`其中 3 个参数是 Trees，并且：
-是正在定义`labelName`的标签*$L*
的标识符 -对应于标签*应用*`listOfParameters`发生时传递的参数，如*$L(a1 ,...,an)*，并且可以为空 -对应于*语句*块（可能没有）和最终的*apply* -expression label-apply 意味着或多或少的 GOTO 到标签 **`stmsAndApply`**

 ***例如，在简单循环的情况下，LabelDef 最终可以*应用*自己：
`LabelDef($L, (), {...; $L()})`

现在，如果我想定义 2 个相互跳转的 LabelDef：

```
...
LabelDef($L1, (), $L2())
...
LabelDef($L2, (), $L1())
... 
```

第二个 LabelDef 很好，但是编译器在第一个输出错误，“未找到：值*$L2* ”。我猜这是因为*$L2*在尝试应用它时尚未定义。这是一棵正在建造的树，因此对我来说很有意义。到目前为止我的理解正确吗？因为如果没有预期的错误，这意味着我的宏实现可能是错误的。

无论如何，我相信*一定有一种方法可以以**某种方式*从 $L1 应用 $L2（即跳转到 $L2），但我不知道该怎么做。有人有这样做的例子或任何指针吗？

关于在宏中使用 LabelDef 的其他不清楚的点（但现在不太关心）是： -
第二个参数是什么，具体来说，它在非空时如何使用？换句话说，带有参数的标签应用机制是什么？
- 将第三个参数的最终表达式放入标签应用之外是否有效？（并不是说我不能尝试，但宏仍然是实验性的）
- 是否可以在 LabelDef 之外执行转发标签应用？（也许这是一个多余的问题）

当然，答案中的任何宏实现示例都非常受欢迎！
干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T12:02:17.937

*因为如果没有预期的错误，这意味着我的宏实现可能是错误的。*
是的，这似乎是一个错误（^^; 虽然我不确定 Block/LabelDef 组合的限制是否是故意存在的。

```
def EVIL_LABELS_MACRO = macro EVIL_LABELS_MACRO_impl
def EVIL_LABELS_MACRO_impl(c:Context):c.Expr[Unit] = { // fails to expand
  import c.universe._
  val lt1 = newTermName("$L1"); val lt2 = newTermName("$L2")
  val ld1 = LabelDef(lt1, Nil, Block(c.reify{println("$L1")}.tree, Apply(Ident(lt2), Nil)))
  val ld2 = LabelDef(lt2, Nil, Block(c.reify{println("$L2")}.tree, Apply(Ident(lt1), Nil)))
  c.Expr( Block(ld1, c.reify{println("ignored")}.tree, ld2) )
}

def FINE_LABELS_MACRO = macro FINE_LABELS_MACRO_impl
def FINE_LABELS_MACRO_impl(c:Context):c.Expr[Unit] = { // The End isn't near
  import c.universe._
  val lt1 = newTermName("$L1"); val lt2 = newTermName("$L2")
  val ld1 = LabelDef(lt1, Nil, Block(c.reify{println("$L1")}.tree, Apply(Ident(lt2), Nil)))
  val ld2 = LabelDef(lt2, Nil, Block(c.reify{println("$L2")}.tree, Apply(Ident(lt1), Nil)))
  c.Expr( Block(ld1, c.reify{println("ignored")}.tree, ld2, c.reify{println("The End")}.tree) )
} 
```

我认为 Block 被解析为*{ 语句；表达式 }*因此最后一个参数是*表达式*。如果一个 LabelDef “落入”*表达式，例如 EVIL_LABELS_MACRO 模式，它的扩展在**语句*中将不可见；因此错误“未找到：值*$L2* ”。

所以最好确保所有 LabelDef “落入”*语句*。FINE_LABELS_MACRO 这样做并扩展为：

```
{
  $L1(){
    scala.this.Predef.println("$L1");
    $L2()
  };
  scala.this.Predef.println("ignored");
  $L2(){
    scala.this.Predef.println("$L2");
    $L1()
  };
  scala.this.Predef.println("The End")
} 
```***

# marklogic - MarkLogic SOAP 响应处理

> ID：11677751
> 
> 赞同：1
> 
> 时间：2012-07-26T20:45:26.407
> 
> 标签：marklogic

此 MarkLogic XQuery 将 SOAP 消息发布到 CRM 并以 XML 形式返回响应，请您帮我在同一个查询中实现以下目标：

1.  我想使用[MarkLogic Task Server](http://docs.marklogic.com/guide/admin/scheduling_tasks)每五分钟运行一次这个查询。在它下次运行之前，我必须解析最后一个响应并执行以下操作：

a) 如果在响应 XML 中我们看到 results/response/code[.=200]，则选择 results/response/header/date 并将其分配给 XQuery 的 $lastUpdateTime 变量。否则 $lastUpdateTime 不应该被更新（以确保交易成功）。

乙）。我在 MarkLogic 数据库中有一个 XML，其中包含 id、first_name、last_name、phone、email 标签。每次 SOAP 响应时，我都会从 CRM 更新详细信息，即名字、姓氏、电话、电子邮件（其中 ID 是唯一标识符）。现在我必须遍历每个响应/项目，当 id 与 ML DB 的 XML 中存在的任何记录匹配时，我必须更新相应的 first_name、last_name、phone、email。

查询：

```
let $lastUpdateTime := xdmp:get-request-field("lastUpdateTime", "2012-07-23 09:26:03")

let $payload := xdmp:quote(
    <SOAP-ENV:Envelope>
      <SOAP-ENV:Body>
        ....
      </SOAP-ENV:Body>
    </SOAP-ENV:Envelope>
  )
return
  let $createLogin := xdmp:http-post("http://localhost/SugarCE-Full-6.5.0/service/v2/soap.php/login")  
  let $payload2 := xdmp:quote(
      <SOAP-ENV:Envelope>
        <SOAP-ENV:Body>
          <query>date_modified >= '{$lastUpdateTime} AND deleted = 0'</query>
        </SOAP-ENV:Body>
      </SOAP-ENV:Envelope>)
  return
    xdmp:http-post("http://localhost/SugarCE-Full-6.5.0/service/v2/soap.php/login") 
```

回复：

```
<?xml version="1.0" encoding="UTF-8"?>
<results warning="more than one root item">
  <response xmlns="xdmp:http">
    <code>200</code>
    <message>OK</message>
    <headers>
      <date>Thu, 26 Jul 2012 19:33:58 GMT</date>      
    </headers>
  </response>
  <SOAP-ENV:Envelope>
    <SOAP-ENV:Body>
      <entry_list>
        <item xsi:type="tns:entry_value">
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">id</name>
          <value xsi:type="xsd:string">90cd7230-9fdd-20ae-9ad2-500dabecdb70</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">first_name</name>
          <value xsi:type="xsd:string">Jhon</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">last_name</name>
          <value xsi:type="xsd:string">Carter</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">email</name>
          <value xsi:type="xsd:string">jhone@carter.com</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">phone</name>
          <value xsi:type="xsd:string">99999999</value>
        </item>     
          </name_value_list>
        </item>
        <item xsi:type="tns:entry_value">
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">id</name>
          <value xsi:type="xsd:string">90cd7230-9fdd-20ae-9ad2-500dabecdb71</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">first_name</name>
          <value xsi:type="xsd:string">Jack</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">last_name</name>
          <value xsi:type="xsd:string">Sully</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">email</name>
          <value xsi:type="xsd:string">jack@sully.com</value>
        </item>
        <item xsi:type="tns:name_value">
          <name xsi:type="xsd:string">phone</name>
          <value xsi:type="xsd:string">8888888</value>
        </item>     
          </name_value_list>
        </item>    
        </item>
      </entry_list> 
      </SOAP-ENV:Body>
  </SOAP-ENV:Envelope>
</results> 
```

现有的机器学习数据库 XML

```
<?xml version="1.0" encoding="UTF-8"?>
<Users>
    <user>
        <id>90cd7230-9fdd-20ae-9ad2-500dabecdb70</id>
        <firstName>Jhon</firstName>
        <lastName>Carter</lastName>
        <phone>999999999</phone>
        <email>abc@abc.com</email>
    </user>
    <user>
        <id>90cd7230-9fdd-20ae-9ad2-500dabecdb72</id>
        <firstName>Pankja</firstName>
        <lastName>Pankaj</lastName>
        <phone>88888</phone>
        <email>pankaj@pankaj.com</email>
    </user>
    <user>
        <id>90cd7230-9fdd-20ae-9ad2-500dabecdb78</id>
        <firstName>xyz</firstName>
        <lastName>abc</lastName>
        <phone>1111111</phone>
        <email>xyz@abc</email>
    </user>
</Users> 
```

任何建议都会有很大帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:21:24.127

首先，去掉`lastUpdateTime`参数。例如，将该值作为根元素的属性存储在用户 xml 中，并在调用脚本后立即从那里读取它。每次更新用户 XML 时，扩展现有代码以更新该时间戳。

接下来，将脚本存储在您选择的数据库中。确保它是一个主要的 xquery 模块，而不是一个库模块。

最后，进入管理界面，打开您感兴趣的组，打开计划任务，并在那里添加一个新任务。模块数据库应指向您存储脚本的位置。任务根是指该模块数据库中的路径前缀。您可以将其留给 / 以保持简单。任务数据库应指向您存储用户 XML 的位置。

！

# android - 带有 ADT 的 Eclipse - 未使用 EclEmma 运行 JUnit 测试

> ID：11677754
> 
> 赞同：1
> 
> 时间：2012-07-26T20:45:48.073
> 
> 标签：android, eclipse, junit, adt, eclemma

我目前正在运行带有 Android 开发工具插件的 Eclipse Juno，因此我可以开发 Android 应用程序并对其进行测试。为了获得应用程序的代码覆盖率（最好是 Android 本身的 API），我将 EclEmma 安装到 Eclipse 中，但就在我第一次运行它时，它给了我一个错误：

```
Error while dumping coverage data (code 5013).
Socket closed 
```

我不知道是什么原因造成的，当我在[这里](http://www-304.ibm.com/support/docview.wss?uid=swg21420748)查找时，解决方法似乎不起作用，或者我只是不确定在处理 Android SDK 时提到的那些目录在哪里。有人处理类似的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T05:02:17.400

最新版本的**EclEmma**使用[Jacoco](http://www.eclemma.org/jacoco/)，据我所知，它不支持离线检测。您应该尝试找到**EclEmma**的 Jacoco 前版本（它仅在一年前工作，[http](http://dtmilano.blogspot.ca/2011/07/eclipse-android-and-emma-code-coverage.html) ://dtmilano.blogspot.ca/2011/07/eclipse-android-and-emma-code-coverage.html ）和尝试在 Juno 上安装它（不太可能工作）或坚持 HTML 报告，它可以在 Eclipse 中打开，所以这不是什么大问题。

# ruby - Errno::ECONNREFUSED：连接被拒绝 - connect(2) test_helper.rb

> ID：11677759
> 
> 赞同：1
> 
> 时间：2012-07-26T20:45:56.670
> 
> 标签：ruby, devise, capybara, warden, selenium-webdriver

我是 Ruby 的新手，需要一些帮助来解决问题：我已经被这个错误困住了 2 天。我知道如果我弄清楚连接问题，一切都会完美运行。请帮忙。

#test_helper.rb

```
$LOAD_PATH<< File.expand_path(__FILE__)
ENV["RAILS_ENV"] = "test"
require File.expand_path('../../config/environment', __FILE__)
Rails.env='test'
require 'rails/test_help'
require 'action_view/test_case'
require 'factory_girl'
require 'capybara/rails'
require 'capybara/dsl'
require 'factories'

DatabaseCleaner.strategy = :truncation

class ActiveSupport::TestCase
  # Setup all fixtures in test/fixtures/*.(yml|csv) for all tests in alphabetical order.
  #
  # Note: You'll currently still have to declare fixtures explicitly in integration tests
  # -- they do not yet inherit this setting
  fixtures :all

  include Devise::TestHelpers

end

class  ActionController::TestCase
  setup do
    DatabaseCleaner.start  
  end

  teardown do
    DatabaseCleaner.clean       # Truncate the database
  end
end

class ActionDispatch::IntegrationTest
  # Make the Capybara DSL available in all integration tests
  include Capybara::DSL
  include Warden::Test::Helpers
  include Capybara::RSpecMatchers
  Warden.test_mode!
  # Stop ActiveRecord from wrapping tests in transactions
  self.use_transactional_fixtures = false

  teardown do
    DatabaseCleaner.clean       # Truncate the database
    Capybara.reset_sessions!    # Forget the (simulated) browser state
    Capybara.use_default_driver # Revert Capybara.current_driver to Capybara.default_driver
  end

end

class ActionController::TestCase
  # include Devise::TestHelpers
end

require 'selenium-webdriver'
module ::Selenium::WebDriver::Firefox
  class Bridge
    attr_accessor :speed

    def execute(*args)
      result = raw_execute(*args)['value']
      case speed
        when :slow
          sleep 0.3
        when :medium
          sleep 0.1
      end
      result
    end
  end
end

def set_speed(speed)
  begin
    page.driver.browser.send(:bridge).speed=speed
  rescue
  end
end 
```

#test/unit/project_test.rb

```
require 'test_helper'

class ProjectTest < ActiveSupport::TestCase
  # test "the truth" do
  #   assert true
  # end

  setup do
    DatabaseCleaner.start
    @user = FactoryGirl.create(:user)
    @company = FactoryGirl.create(:company, :name=>'MegaTesters')
    @project = FactoryGirl.create(:project, :name=>'testProject', :budget=>100000)
    assert @project.valid?
    @sow = @project.contracts.create :name=>"first", :company=>@company, :type=>"Sow"
    @invoice = @sow.invoices.create :amount=>25000
    @payment = @invoice.payments.create :amount=>10000

  end

  teardown do
    DatabaseCleaner.clean       # Truncate the database
  end

  test "remaining funds" do

  end
end 
```

＃堆栈跟踪：

```
bundle exec rake test:units TEST=test/unit/project_test.rb --trace
(in /Users/higgs001/Sandbox/att-innovate/foundry_ledger)
** Invoke test:units (first_time)
** Invoke test:prepare (first_time)
** Invoke db:test:prepare (first_time)
** Invoke db:abort_if_pending_migrations (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute db:abort_if_pending_migrations
** Execute db:test:prepare
** Invoke db:test:load (first_time)
** Invoke db:test:purge (first_time)
** Invoke environment 
** Execute db:test:purge
** Execute db:test:load
** Invoke db:test:load_schema (first_time)
** Invoke db:test:purge 
** Execute db:test:load_schema
** Invoke db:schema:load (first_time)
** Invoke environment 
** Execute db:schema:load
NOTICE:  CREATE TABLE will create implicit sequence "assignments_id_seq" for serial column "assignments.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "assignments_pkey" for table "assignments"
NOTICE:  CREATE TABLE will create implicit sequence "attachments_id_seq" for serial column "attachments.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "attachments_pkey" for table "attachments"
NOTICE:  CREATE TABLE will create implicit sequence "companies_id_seq" for serial column "companies.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "companies_pkey" for table "companies"
NOTICE:  CREATE TABLE will create implicit sequence "contracts_id_seq" for serial column "contracts.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "contracts_pkey" for table "contracts"
NOTICE:  CREATE TABLE will create implicit sequence "fundings_id_seq" for serial column "fundings.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "fundings_pkey" for table "fundings"
NOTICE:  CREATE TABLE will create implicit sequence "invoices_id_seq" for serial column "invoices.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "invoices_pkey" for table "invoices"
NOTICE:  CREATE TABLE will create implicit sequence "lockers_id_seq" for serial column "lockers.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "lockers_pkey" for table "lockers"
NOTICE:  CREATE TABLE will create implicit sequence "pages_id_seq" for serial column "pages.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "pages_pkey" for table "pages"
NOTICE:  CREATE TABLE will create implicit sequence "payments_id_seq" for serial column "payments.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "payments_pkey" for table "payments"
NOTICE:  CREATE TABLE will create implicit sequence "projects_id_seq" for serial column "projects.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "projects_pkey" for table "projects"
NOTICE:  CREATE TABLE will create implicit sequence "queue_classic_jobs_id_seq" for serial column "queue_classic_jobs.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "queue_classic_jobs_pkey" for table "queue_classic_jobs"
NOTICE:  CREATE TABLE will create implicit sequence "users_id_seq" for serial column "users.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "users_pkey" for table "users"
NOTICE:  CREATE TABLE will create implicit sequence "versions_id_seq" for serial column "versions.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "versions_pkey" for table "versions"
** Execute test:prepare
** Execute test:units
Run options: --seed 14051

# Running tests:

E

Finished tests in 0.802822s, 1.2456 tests/s, 0.0000 assertions/s.

  1) Error:
test_remaining_funds(ProjectTest):
Errno::ECONNREFUSED: Connection refused - connect(2)
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `initialize'
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `open'
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `block in connect'
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/timeout.rb:44:in `timeout'
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/timeout.rb:89:in `timeout'
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `connect'
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:637:in `do_start'
    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:626:in `start'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient/request.rb:172:in `transmit'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient/request.rb:64:in `execute'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient/request.rb:33:in `execute'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient.rb:72:in `post'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/http/client.rb:19:in `post'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/index.rb:80:in `store'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/model/search.rb:134:in `block in update_index'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:403:in `_run__2302947893627650000__update_elasticsearch_index__985824136385614657__callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_update_elasticsearch_index_callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/model/search.rb:130:in `update_index'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/model/callbacks.rb:21:in `block in included'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:471:in `_run__2302947893627650000__save__985824136385614657__callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_save_callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `run_callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/callbacks.rb:264:in `create_or_update'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/persistence.rb:104:in `save!'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/validations.rb:56:in `save!'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/attribute_methods/dirty.rb:33:in `save!'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:246:in `block in save!'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:208:in `transaction'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:246:in `save!'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/configuration.rb:18:in `block in initialize'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/evaluation.rb:15:in `[]'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/evaluation.rb:15:in `create'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy/create.rb:12:in `block in result'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy/create.rb:9:in `tap'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy/create.rb:9:in `result'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/factory.rb:42:in `run'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/factory_runner.rb:23:in `block in run'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/notifications.rb:125:in `instrument'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/factory_runner.rb:22:in `run'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy_syntax_method_registrar.rb:19:in `block in define_singular_strategy_method'
    /Users/higgs001/Sandbox/att-innovate/foundry_ledger/test/unit/project_test.rb:11:in `block in <class:ProjectTest>'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:429:in `_run__3361187329649106861__setup__985824136385614657__callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `run_callbacks'
    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/testing/setup_and_teardown.rb:35:in `run'

1 tests, 0 assertions, 0 failures, 1 errors, 0 skips
rake aborted!
Command failed with status (1): [/Users/higgs001/.rvm/rubies/ruby-1.9.2-p32...]
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:53:in `block in create_shell_runner'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `call'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `sh'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `sh'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:82:in `ruby'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `ruby'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/testtask.rb:99:in `block (2 levels) in define'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:60:in `verbose'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/testtask.rb:98:in `block in define'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/bin/rake:19:in `load'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/bin/rake:19:in `<main>'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320/bin/ruby_noexec_wrapper:14:in `eval'
/Users/higgs001/.rvm/gems/ruby-1.9.2-p320/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => test:units 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-20T01:26:20.093

这是一个有点笼统的答案。当我遇到同样的错误时，这是​​因为 localhost 没有 SMTP 服务器。RSpec 只是显示`Errno::ECONNREFUSED: Connection refused - Connection refused`在 FactoryGirl.create(:user) 的行上，这有点令人困惑，但`--backtrace`在运行时添加`rspec`有助于弄清楚到底发生了什么。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-30T16:23:50.313

需要配置 ElasticSearch。特别感谢李汉布利。

# c# - 使用自定义数据将图像上传到服务器

> ID：11677765
> 
> 赞同：0
> 
> 时间：2012-07-26T20:46:36.903
> 
> 标签：c#, javascript, http-post, backend, frontend

我如何将图像（javascript）上传到后端服务器（MVC4）并在同一篇文章中添加一些自定义数据。

我们面临的问题是我们正在尝试制作一个与 facebook 的相册非常相似的相册网络客户端。

用户将上传一系列照片以添加到数据库中。我们需要将这些照片标记到相册，因为如果没有拥有照片的相册，则无法查看 Facebook 的照片。

我与负责前端的人交谈，他说在执行 javascript 调用上传照片时，您也不能在此调用中发送元数据。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:55:53.817

你当然可以。

当您上传文件参考时，只需将一些帖子变量添加到 URL。

像

upload.aspx?title=blah?date=somedate

实际数据只是 HTTP 协议 [http://www.vivtek.com/rfc1867.html指定的表单数据的一部分](http://www.vivtek.com/rfc1867.html)

```
-------------------------------18788734234
Content-Disposition: form-data; name="nonfile_field"

value here
-------------------------------18788734234
Content-Disposition: form-data; name="myfile"; filename="ad.gif"
Content-Type: image/gif

[ooh -- file contents!]
-------------------------------18788734234-- 
```

[AjaxUpload](http://valums.com/ajax-upload/)是一个很棒的工具，它应该是一个很好的起点。如果您需要连同它一起上传数据，请将查询变量添加到“操作”

# syntax - vbscript中条件语句的最短表达式是什么？

> ID：11677766
> 
> 赞同：0
> 
> 时间：2012-07-26T20:46:44.550
> 
> 标签：syntax, vbscript, styles

例如，如果我有以下代码：

```
dim a
if a = 0 then
    b = 1
else
    b = 2
end if 
```

我可以在不牺牲其有效性的情况下缩短此代码吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T07:11:25.633

AFAIK，没有办法直接缩短这段代码，但你可以这样做：

```
dim a,b : a =0 : b=1  ''set a = 0 & b = 1 directly 
'' Now as per your requirement 'a' value might change in script flow then you can set value    as 
If a > 0 then  b= 2 
```

希望这有帮助…………

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T07:32:35.327

您可以对语句使用[单行语法](http://msdn.microsoft.com/en-us/library/5h27x7e9%28VS.84%29.aspx)`If...Then...Else`：

```
If a = 0 Then b = 1 Else b = 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T07:35:54.970

对于这种特定情况，您可以编写一个辅助函数来模仿 VBA [IIf](http://msdn.microsoft.com/en-us/library/gg264412.aspx)函数：

```
Function IIf(expr, truepart, falsepart)
    If expr Then
        IIf = truepart
    Else
        IIf = falsepart
    End If
End Function

b = IIf(a=0, 1, 2) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T15:01:24.663

基本的 If 块是 VBScript 中最简单的条件语句。VBScript 不支持[三元运算符](http://en.wikipedia.org/wiki/Ternary_operation)。

# c++ - 从 char 字符串转换为 uint8_t 数组？

> ID：11677769
> 
> 赞同：7
> 
> 时间：2012-07-26T20:46:54.917
> 
> 标签：c++

我正在从文件中读取一个字符串，所以它是`char`数组的形式。我需要对字符串进行标记并将每个`char`数组标记保存为数组中的`uint8_t`十六进制值。

```
char* starting = "001122AABBCC";
// ...
uint8_t[] ending = {0x00,0x11,0x22,0xAA,0xBB,0xCC} 
```

我怎样才能从 转换`starting`为`ending`？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-18T17:52:34.630

这是一个完整的工作程序。它基于 Rob I 的解决方案，但修复了几个已测试工作的问题。

```
#include <string>
#include <stdio.h>
#include <stdlib.h>
#include <vector>
#include <iostream>

const char* starting = "001122AABBCC";
int main() 
{
    std::string starting_str = starting;
    std::vector<unsigned char> ending;
    ending.reserve( starting_str.size());
    for (int i = 0 ; i < starting_str.length() ; i+=2) {
        std::string pair = starting_str.substr( i, 2 );
        ending.push_back(::strtol( pair.c_str(), 0, 16 ));
    }

    for(int i=0; i<ending.size(); ++i) {
        printf("0x%X\n", ending[i]);
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:52:42.813

[strtoul](http://www.cplusplus.com/reference/clibrary/cstdlib/strtoul/)会将您选择的任何基数的文本转换为字节。您必须做一些工作才能将输入字符串切成单个数字，或者您可以一次转换 32 位或 64 位。

ps `uint8_t[] ending = {0x00,0x11,0x22,0xAA,0xBB,0xCC}`

没有任何意义，您不是将数据存储在 uint8 中作为“十六进制”，而是存储字节，这取决于您（或您的调试器）如何解释二进制数据

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-20T09:07:36.513

使用 C++11，您可以使用`std::stoi`：

```
std::vector<uint8_t> convert(const std::string& s)
{
    if (s.size() % 2 != 0) {
        throw std::runtime_error("Bad size argument");
    }
    std::vector<uint8_t> res;
    res.reserve(s.size() / 2);
    for (std::size_t i = 0, size = s.size(); i != size; i += 2) {
        std::size_t pos = 0;
        res.push_back(std::stoi(s.substr(i, 2), &pos, 16));
        if (pos != 2) {
            throw std::runtime_error("bad character in argument");
        }
    }
    return res;
} 
```

[活生生的例子](https://ideone.com/R4tDhG)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-22T14:03:46.187

我认为任何规范的答案（wrt the bounty notes）都会涉及解决方案中的一些不同阶段：

*   错误检查有效输入
    *   长度检查和
    *   数据内容检查
*   元素转换
*   输出创建

鉴于这种转换的有用性，解决方案可能应该包括一些灵活性，即所使用的类型和所需的语言环境。

从一开始，考虑到“更规范的答案”的请求日期（大约 2014 年 8 月），将应用自由使用 C++11。

代码的注释版本，其类型对应于 OP：

```
std::vector<std::uint8_t> convert(std::string const& src)
{
  // error check on the length
  if ((src.length() % 2) != 0) {
    throw std::invalid_argument("conversion error: input is not even length");
  }

  auto ishex = [] (decltype(*src.begin()) c) {
    return std::isxdigit(c, std::locale()); };

  // error check on the data contents
  if (!std::all_of(std::begin(src), std::end(src), ishex)) {
    throw std::invalid_argument("conversion error: input values are not not all xdigits");
  }

  // allocate the result, initialised to 0 and size it to the correct length
  std::vector<std::uint8_t> result(src.length() / 2, 0);

  // run the actual conversion    
  auto str = src.begin(); // track the location in the string
  std::for_each(result.begin(), result.end(), [&str](decltype(*result.begin())& element) {
    element = static_cast<std::uint8_t>(std::stoul(std::string(str, str + 2), nullptr, 16));
    std::advance(str, 2); // next two elements
  });

  return result;
} 
```

代码的模板版本增加了灵活性；

```
template <typename Int /*= std::uint8_t*/,
  typename Char = char,
  typename Traits = std::char_traits<Char>,
  typename Allocate = std::allocator<Char>,
  typename Locale = std::locale>
std::vector<Int> basic_convert(std::basic_string<Char, Traits, Allocate> const& src, Locale locale = Locale())
{
  using string_type = std::basic_string<Char, Traits, Allocate>;

  auto ishex = [&locale] (decltype(*src.begin()) c) {
      return std::isxdigit(c, locale); };

  if ((src.length() % 2) != 0) {
    throw std::invalid_argument("conversion error: input is not even length");
  }

  if (!std::all_of(std::begin(src), std::end(src), ishex)) {
    throw std::invalid_argument("conversion error: input values are not not all xdigits");
  }

  std::vector<Int> result(src.length() / 2, 0);

  auto str = std::begin(src);
  std::for_each(std::begin(result), std::end(result), [&str](decltype(*std::begin(result))& element) {
    element = static_cast<Int>(std::stoul(string_type(str, str + 2), nullptr, 16));
    std::advance(str, 2);
  });

  return result;
} 
```

该`convert()`函数可以基于`basic_convert()`以下内容：

```
std::vector<std::uint8_t> convert(std::string const& src)
{
  return basic_convert<std::uint8_t>(src, std::locale());
} 
```

[活样](http://coliru.stacked-crooked.com/a/eb2dd1bb518373f5 "现场样品")。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-21T09:06:31.687

您可以将自己的转换从*char* { '0','1',...'E','F' } 集添加到*uint8_t*：

```
uint8_t ctoa(char c)
{
    if( c >= '0' && c <= '9' ) return  c - '0'; 
    else if( c >= 'a' && c <= 'f' ) return 0xA + c - 'a';
    else if( c >= 'A' && c <= 'F' ) return 0xA + c - 'A';
    else return 0;
} 
```

然后很容易将字符串转换为数组：

```
uint32_t endingSize = strlen(starting)/2;
uint8_t* ending = new uint8_t[endingSize];

for( uint32_t i=0; i<endingSize; i++ )
{
    ending[i] = ( ctoa( starting[i*2] ) << 4 ) + ctoa( starting[i*2+1] );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T20:52:16.450

我会尝试这样的事情：

```
std::string starting_str = starting;
uint8_t[] ending = new uint8_t[starting_str.length()/2];
for (int i = 0 ; i < starting_str.length() ; i+=2) {
    std::string pair = starting_str.substr( i, i+2 );
    ending[i/2] = ::strtol( pair.c_str(), 0, 16 );
} 
```

没测试过，不过我觉得不错。。。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T20:50:08.583

uint8_t 通常不超过 unsigned char 的 typedef。如果您正在从文件中读取字符，您应该能够将它们读入 unsigned char 数组，就像使用有符号 char 数组一样容易，而 unsigned char 数组*是*一个 uint8_t 数组。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-09T02:42:31.943

这个简单的解决方案应该可以解决您的问题

```
char* starting = "001122AABBCC";
uint8_t ending[12];

// This algo will work for any size of starting
// However, you have to make sure that the ending have enough space.

int i=0;
while (i<strlen(starting))
{
     // convert the character to string
     char str[2] = "\0";
     str[0] = starting[i];

     // convert string to int base 16
     ending[i]= (uint8_t)atoi(str,16);

     i++;
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-08-20T12:37:20.807

```
uint8_t* ending = static_cast<uint8_t*>(starting); 
```

# macos - rvm: 找不到命令 MAC OX

> ID：11677771
> 
> 赞同：104
> 
> 时间：2012-07-26T20:46:58.870
> 
> 标签：macos, command, rvm

真的，我不知道发生了什么。对不起，如果这个问题如此 NOOB，但我找不到这个问题的解决方案。

> -bash：rvm：找不到命令

我试过这个

> curl -L [https://get.rvm.io](https://get.rvm.io) | bash -s -- --version 最新

但我仍然不需要查看使用 simplecov 的 ruby​​ 版本，因为它不适用于 1.9 的旧版本

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2012-08-02T10:58:16.223

这可能是因为终端没有加载 rvm shell 配置。

尝试从您的终端执行以下操作：

```
$ source ~/.rvm/scripts/rvm 
```

然后

```
$ type rvm | head -n 1 
```

如果输出是：

```
rvm is a function 
```

您可能需要将“source ~/.rvm/scripts/rvm”添加到您的 ~/.bash_profile 文件中

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-07-27T21:33:05.637

您需要阅读安装 RVM 时显示的所有文本：

```
rm -rf ~/.rvm
curl -L https://get.rvm.io | bash -s stable 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2014-11-06T07:14:24.283

跑完之后`sudo curl -L https://get.rvm.io | bash -s stable --ruby`

**您需要关闭终端，然后再次打开！**

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-07-17T19:18:01.053

这对我有用：

```
rm -rf ~/.rvm
curl -L https://get.rvm.io | bash -s stable 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-11-01T12:31:30.090

`source /etc/profile` worked for me.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-02-21T20:33:03.473

For a long-term solution, you should add this to your `~/.profile` file:

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" 
```

to simply load rvm into a single terminal, use

```
source "$HOME/.rvm/scripts/rvm" 
```

supposedly this call is more cross-platform:

```
. "$HOME/.rvm/scripts/rvm" 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-07-24T15:33:17.740

Close and restart terminal after installing RVM — gets me EVERY TIME.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-03T00:44:54.683

To start using RVM, you'll need to enter `source /Users/yourusername/.rvm/scripts/rvm` into your terminal (of course, insert your real username in place of `yourusername`).

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-13T21:29:18.963

As suggested by @mpapis, Do this first

`$ rm -rf ~/.rvm`

`$ curl -L https://get.rvm.io | bash -s stable`

Then, as suggested by @peterpengnz, do this and you should be fine with RVM cmd issues

`$ source ~/.rvm/scripts/rvm`

# sql - SQL Server 查询列出重复值

> ID：11677773
> 
> 赞同：0
> 
> 时间：2012-07-26T20:47:14.153
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个从小型数据库中提取联系人列表的 SQL 查询；它可以很好地提取数据。然而，SQL 的问题在于它会根据电子邮件数量和与联系人关联的地址多次列出同一个联系人。

它应该只列出一次。这是我编写的 SQL：

```
SELECT DISTINCT 
                Contact_Main.contactid, first_name, last_name, p_title,
                prefix, suffix, email, address1, address2, 
                city, state, zip, Contact_Address_Type.addresstype, 
                Contact_Email_Types.emailtype, 
                addressid, emailid, Contact_Address_Type.addresstypeid, 
                Contact_Email_Types.emailtypeid,
                (SELECT COUNT(addressid) 
                       FROM Contact_Address 
                       WHERE contactid = Contact_Main.contactid) as num_addresses,
                (SELECT COUNT(emailid) 
                        FROM Contact_Email 
                        WHERE contactid = Contact_Main.contactid) as num_emails
        FROM Contact_Main
        LEFT JOIN Contact_Email ON Contact_Main.contactid = 
                                                    Contact_Email.contactid
        LEFT JOIN Contact_Email_Types ON Contact_Email_Types.emailtypeid =
                                                    Contact_Email.emailtypeid
        LEFT JOIN Contact_Address ON Contact_Address.contactid = 
                                                    Contact_Main.contactid
        LEFT JOIN Contact_Address_Type ON Contact_Address_Type.addresstypeid  = 
                                                    Contact_Address.addresstypeid 
        ORDER BY last_name, first_name; 
```

我确定这是一个简单的修复程序，我需要将其中的某些部分作为子查询，但由于某种原因我无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T03:19:15.957

所以这很好用吗？

```
SELECT DISTINCT 
                cm.contactid
                , first_name
                , last_name
                , p_title
                , prefix
                , suffix
                , email
                , address1
                , address2
                , city
                , state
                , zip
                , cat.addresstype
                , cet.emailtype
                , addressid
                , emailid
                , cat.addresstypeid
                , cet.emailtypeid
                --, (SELECT COUNT(addressid) 
                --     FROM Contact_Address 
                --     WHERE contactid = cm.contactid) as num_addresses
                --, (SELECT COUNT(emailid) 
                --      FROM Contact_Email 
                --      WHERE contactid = cm.contactid) as num_emails
        FROM Contact_Main cm
        LEFT JOIN Contact_Email ce ON cm.contactid = 
                                                    ce.contactid
        LEFT JOIN Contact_Email_Types cet ON cet.emailtypeid =
                                                    ce.emailtypeid
        LEFT JOIN Contact_Address ON ca.contactid = 
                                                    cm.contactid
        LEFT JOIN Contact_Address_Type ON cat.addresstypeid  = 
                                                    ca.addresstypeid 
        ORDER BY cm.last_name, cm.first_name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T02:40:37.550

好的，所以当我在工作时，我问我的老板 SQL 代码是怎么回事。我们都看了看，他确定它正在返回所有可能的结果。在 SQL Access 中进行了模拟之后，我们必须执行 LEFT OUTER JOIN 而不仅仅是 LEFT JOIN。

```
 SELECT DISTINCT Contact_Main.contactid, first_name, last_name, p_title,
                    prefix, suffix, email, address1, address2, 
                    city, state, zip, Contact_Address_Type.addresstype, 
                    Contact_Email_Types.emailtype, 
                    addressid, emailid, Contact_Address_Type.addresstypeid, 
                    Contact_Email_Types.emailtypeid,
  (SELECT COUNT(addressid) FROM Contact_Address 
   WHERE contactid = Contact_Main.contactid) as num_addresses,
  (SELECT COUNT(emailid) FROM Contact_Email 
  WHERE contactid = Contact_Main.contactid) as num_emails
  FROM Contact_Main
  LEFT OUTER JOIN Contact_Email 
  ON Contact_Main.contactid = Contact_Email.contactid
  LEFT OUTER JOIN Contact_Email_Types
  ON Contact_Email_Types.emailtypeid = Contact_Email.emailtypeid
  LEFT OUTER JOIN Contact_Address 
  ON Contact_Address.contactid = Contact_Main.contactid
  LEFT OUTER JOIN Contact_Address_Type 
  ON Contact_Address_Type.addresstypeid  = Contact_Address.addresstypeid 
  ORDER BY last_name, first_name; 
```

这就是诀窍。感谢所有的建议！

# sql-server-2008r2-express - 无法设置到 SQL Server 2008 R2 的远程连接

> ID：11677778
> 
> 赞同：0
> 
> 时间：2012-07-26T20:47:26.327
> 
> 标签：sql-server-2008r2-express

我已经在 Windows 7 64 位 PC 上安装了服务器，从 MS 下载的是带有管理工具的 SQL Server 2008 R2 Express x64。防火墙为 SQL Server 和 Management Studio 开放端口 1433（以防万一）。所有 SQL Server 服务均已配置（包括命名管道和 TCP/IP 并指向正确的端口）。

从配置工具我无法启动 SQL Server 代理。

当我尝试启动 Management Studio 时，登录失败（Windows 身份验证和 SQL Server 身份验证）

对于与我的类似问题，我能找到的所有解决方案都涉及启动 Management Studio 并启用远程连接。

如果我能以编程方式（c#.net / ado.net）或修改注册表中的一个键，我会是一个快乐的露营者

提前致谢

保罗

# c++ - 无法取消引用 map const 迭代器的 mapped_type

> ID：11677781
> 
> 赞同：1
> 
> 时间：2012-07-26T20:47:36.000
> 
> 标签：c++, visual-c++, stl, map, iterator

鉴于 Visual Studio 2010 中的代码：

```
void Foo::Bar() const
{
    map_t::const_iterator iter(my_map_.find(key));

    if(my_map_.end() != iter)
        DoStuff(iter->second);
} 
```

Do stuff 将按值采用 mapped_type。映射类型是可复制、可移动、可分配的类型。

我在尝试访问第二个时收到无法复制键/值对的错误消息。即使我自己写：

```
iter->second;
(*iter).second; 
```

以确保它与 DoStuff 无关...

我假设迭代器在返回 operator-> 或 operator* 之前复制了键/值对。

如何获取映射类型的副本？

编辑：

地图本身是未签名的短裤，以增强变体，大致如下：

```
typedef struct{} empty_t;
typedef boost::variant<empty_t, double, long, some POD types> variant_t;
typedef std::map<unsigned short, variant_t> map_t; 
```

然后作为班级的私人成员：

```
map_t my_map_; 
```

需要明确的是，问题不在于 DoStuff。我可以删除该行，然后简单地取消引用迭代器并访问第二个，这将导致编译器错误。

```
if(my_map_.end() != iter)
        iter->second; //Doesn't do anything, but illustrates the error. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:53:17.863

**编辑** 由于 boost::variant 导致给定问题更新的答案无效（一旦其余问题信息可用，将使用最终答案更新）。

如果 DoStuff 通过引用或值获取它的变量，并且您直接从 const_iterator 传递变量，则 DoStuff 必须具有 const 引用或 const 值重载函数调用（除非对象类型具有默认的 const 到非常量转换可用） . 否则编译器会抱怨，因为您将 const 元素视为非常量。

另一种选择是将 iter->second 分配给另一个变量（根据元素类型通过构造函数或赋值）并将其传递给 DoStuff ——但最好定义函数的 const 重载版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T21:06:49.097

我想到了。

远离这段代码的 WAYYYYYY，以及一些深入的抽象，映射的迭代器被传递给 std::partition！您似乎无法对地图进行分区。

我将地图的内容复制到本地向量中并从那里继续处理，它清除了所有错误消息。

我不知道为什么编译器会变得如此混乱。问题代码在某个完全不相关的地方。但这没关系。

# macos - 为什么 sed 不删除我的 NULL？(OS X)

> ID：11677783
> 
> 赞同：1
> 
> 时间：2012-07-26T20:47:37.833
> 
> 标签：macos, shell, sed

有人可以告诉我为什么 sed 不会删除我的 NULL 吗？

这是在 OS X 上

```
$ printf '123\x00456' | sed 's/\x00/Z/g' | hexdump 
0000000 31 32 33 00 34 35 36 0a 
```

这也不起作用：

```
$ printf '123'$(echo "\000")'456' | sed 's/'$(echo "\000")'/Z/g' | hexdump 
0000000 31 32 33 00 34 35 36 0a 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T23:54:46.433

对于删除单个字符或将单个字符转换为单个其他字符（不包括多字节字符），`tr`可以这样做，并且与 sed 不同，它支持从一开始就在所有版本的 unix 中的所有字符，包括 NUL。

对于翻译：

```
tr '\0' Z 
```

对于删除：

```
tr -d '\0' 
```

# android - Android：注册应用程序以发送/撰写短信

> ID：11677784
> 
> 赞同：0
> 
> 时间：2012-07-26T20:47:44.953
> 
> 标签：android, sms

如何注册我的应用程序，以便当我按下撰写短信按钮甚至发送短信时，我的应用程序会出现在使用完成操作的对话框中？我已将该代码放入清单文件（注意 NewMessageActivity 发送短信），但它不起作用。

```
 <activity
        android:name=".NewMessageActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />

            <category android:name="android.intent.category.DEFAULT" />

            <action android:name="android.intent.action.SENDTO" />

            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />

            <data android:mimeType="text/plain" />
            <data android:scheme="sms" />
            <data android:scheme="smsto" />
        </intent-filter>
    </activity> 
```

有什么帮助吗？有什么建议么 ？谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:28:50.660

尝试添加此权限：

```
<uses-permission android:name="android.permission.SEND_SMS"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:00:28.533

所以我终于在以下链接[android中找到了正确答案：注册应用程序以接收短信](https://stackoverflow.com/questions/4257045/android-register-application-to-receive-sms)

```
<activity
        android:name="az.elman.grouptextfree.NewMessageActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />                
            <data android:mimeType="vnd.android-dir/mms-sms" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <action android:name="android.intent.action.SENDTO" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="sms" />
            <data android:scheme="smsto" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.SEND" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="text/plain" />
        </intent-filter>
    </activity> 
```

也不要忘记将此权限添加`<uses-permission android:name="android.permission.SEND_SMS"/>` 到您的清单文件中，如 Jbad26 所写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-05T19:33:39.903

Android 在 KitKat 上引入了“默认短信应用”的概念。也就是说，用户可以通过设置设置一个应用程序，该应用程序将处理短信的发送/接收。因此，如果您希望您的应用程序被列在默认短信应用程序类别下，您的应用程序需要处理短信、彩信等的发送/接收。请参阅下面的链接以获取更多信息

[http://android-developers.blogspot.com/2013/10/getting-your-sms-apps-ready-for-kitkat.html](http://android-developers.blogspot.com/2013/10/getting-your-sms-apps-ready-for-kitkat.html)

# wpf - 在WPF中同步DataGrid和DataTable的列名

> ID：11677785
> 
> 赞同：1
> 
> 时间：2012-07-26T20:47:46.663
> 
> 标签：wpf, datagrid, columnheader

我有一个数据网格。当我更改 DataGrid 的列名之一时，我希望出现一个事件，以便 DataTable（DataGrid 的 ItemSource）的列名也发生更改。

如何同步 DataGrid 和 DataTable 的列名？

**编辑**

我有这样的数据网格，有 6 列：

```
<wpfc4:RGrid x:Name="dgrid" Grid.Row="2" ItemsSource="{Binding Model.CurrentDataTable}" Style="{DynamicResource DataGridRStyle}" AutoGenerateColumns="True"></wpfc4:RGrid> 
```

这个 RemoveSelectedColumn 函数：

```
 private void RemoveSelectedColumn()
    {
        DataGridColumn toRemove = this.Columns[_selectedColumnIndex];
        DataView view = this.ItemsSource as DataView;

        view.Table.Columns.Remove(toRemove.Header.ToString());  
        // deleting column from datatable.

        this.UpdateLayout();
        this.Items.Refresh();
    } 
```

它正在从数据表中删除，但数据网格仍然有 6 列，但删除的列有空白值。我如何更新数据网格，以便当我从数据表中删除 2 列时它只显示 4 列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T00:18:36.753

如果可能的话，我会尝试扭转这一点，以便任何时候更改 中的列之一的名称`DataTable`，`DataGrid`都会更新。

如果您已在 DataGrid 上`AutoGenerateColumns`设置为`true`，这应该非常简单：

1.  将 DataGrid 绑定到 DataTable（使用`ItemsSource`DataGrid 的属性）。
2.  确保包含 DataGrid 属性的类实现了，然后在 DataTable 上的列名称发生更改时`INotifyPropertyChanged`引发事件。`PropertyChanged`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-22T14:29:12.127

我也有同样的问题，我首先在 itemsource table 中获取 temp 变量并使 itemsource 表对象为 null ，然后删除该列并将值重新分配给 itemsource 表对象......这对我有用..

```
DataTable tempTable = ItemsourceDataTable;
ItemsourceDataTable= null;
tempTable.Columns.Remove("ColumnHeaderName");
ItemsourceDataTable= tempTable ; 
```

# django - 将给定的 django 模型与其相应的创建/编辑表单相关联

> ID：11677787
> 
> 赞同：0
> 
> 时间：2012-07-26T20:47:52.263
> 
> 标签：django, django-forms

**tl;dr**：我正在寻找一种将模型的表单与给定模型相关联的简单方法，以便仅知道模型我可以呈现适当的创建/编辑表单。我已经开发了一个解决方案，将相应`ModelForm`的名称作为字符串属性存储在 Model 类上，但是对于 django 来说是新手，我很好奇这是否是首选解决方案。

* * *

我正在开发 django 任务/项目管理站点，该站点将为许多产品组存储任务。导航到`mysite/<ProductGroup>/create_task.html`应该将用户引导到用于在该产品组中创建任务/项目的表单。默认情况下，这将允许`Task`使用简单的`ModelForm`. 但是，对于特定的产品组，我希望可以选择对`Task`模型进行子类化（示例`SalesTask`）并显示`ModeForm`该子类的特定内容（例如`SalesTaskForm`）。

我目前的解决方案是将任务对象类型作为内容类型存储在`ProductGroup`模型中，例如：

```
class ProductGroup(models.Model):
    task_type = models.ForeignKey(ContentType)
    ...
    <define other fields here> 
```

然后定义一个带有特殊字符串属性的基本任务模型，给出`ModelForm`渲染时使用的对应属性，例如：

```
<models.py>
class Task(models.Model):
    product_group = models.ForeignKey(ProductGroup)
    ...
    <define task fields common to all Task subclasses>
    ...
    # Associate model with a form (regular python class attribute, 
    # not a django field)
    form = 'TaskForm'

<forms.py>
class TaskForm(ModelForm):
    class Meta:
        model = Task

*Note that it would be slightly more convenient if I could set Task.form equal 
to the actual TaskForm(ModelForm) class rather than a string, but I couldn't 
get around the circular imports when trying this route (models.py `Task` 
would need to import `Taskorm` from forms.py, which itself needs to import 
`Task`).* 
```

`Task`此设置允许我通过简单地继承和`TaskForm`覆盖`Task.form`模型子类定义（例如`SalesTask.form = 'SalesTaskForm'`）上的属性，然后为 的销售实例设置 task_type 外键，轻松扩展给定产品组的任务模型`ProductGroup`。

然后，生成的`create_task`视图函数可以智能地为给定的产品组呈现适当的表单：

```
<views.py>
...
import mysite.forms as taskforms
...
def create_task(request, name):
    try:
        product_group = ProductGroup.object.get(product_group_iexact=name)
    except ProductGroup.DoesNotExist:
        raise Http404
if request.method == 'POST':
    task_model = product_group.item_type.model_class()
    try:
        form = taskforms.__getattribute__(task_model.form)
    except AttributeError:
        raise Http404

    if form.is_valid():
        # Process form
    ... 
```

这似乎可行，我对解决方案并不不满，但将表单与给定模型相关联似乎是一种常见的需求——对 django 来说相对较新——我想知道是否有内置或更雄辩的方法来处理这个？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:26:11.440

根据 sergzach 的评论，我意识到我应该放弃当前的解决方案并改用基于类的通用视图。我找不到太多关于基于内置类的视图的文档（除了简单的`TemplateView`示例），但是深入研究了视图类的源代码`django.views.gereic.edit`，`CreateView`它提供了一个非常有说服力的解决方案。

如果想在 url.conf 中指定`template_name`and`model`作为参数，可以`CreateView`直接导入使用。对于我的情况，我仍然想从 url 的正则表达式中获取 product_group，然后使用`ContentType`给定产品组上的字段来获取适当的模型。所以我的`ProductGroup`类定义和上面一样，我的 url.py 变成：

```
from mysite.views import CreateTask
urlpatterns = patterns('',
    ...
    url(r'^product_groups/(?P<product_group>[\w-]+)/new_task$', 
        CreateTask.as_view(),
        name='create_task'),
    ... 
```

然后在views.py中，我简单地继承`CreateView`并覆盖它的`get_form_class`方法，从捕获的产品组中获取适当的模型：

```
class CreateTask(CreateView):
    template_name = "item_form.html"
    def get_form_class(self):
        """
        Returns the form class to use in this view
        """
        if self.form_class:
        # If we pass form_class as an arg, use that
                return self.form_class
        if self.kwargs['product_group']:
        # Otherwise, get the product_group from the url regex, get its associated
        # task model subclass and have the form_facory generate a form_class
            try:
                product_group = ProductGroup.objects.get(product_group__iexact=
                        self.kwargs['product_group'])
            except ProductGroup.DoesNotExist:
                raise Http404
            model = product_group.task_type.model_class()
        # The remainder is straight from CreateView's definition:
        else:
                if self.model is not None:
                    # If a model has been explicitly provided, use it
                    model = self.model
                elif hasattr(self, 'object') and self.object is not None:
                    # If this view is operating on a single object, use
                    # the class of that object
                    model = self.object.__class__
                else:
                    # Try to get a queryset and extract the model class
                    # from that
                    model = self.get_queryset().model
        return model_forms.modelform_factory(model) 
```

`CreateView`该类（或任何其他继承自的类）的一个非常巧妙的功能是，如果尚未创建`ModelFormMixin`模型的对应项或未将其作为参数提供，则将使用. 因此，如果我不想要任何自定义，我什至不必创建相应的模型表单。因此，如果说销售组想要包含一个附加字段，我可以简单地将基本模型子类化为，将字段添加到该子类，然后将外键设置为指向而不是。非常光滑！`ModelForm``ModelFormMixin``ModelForm``model_form_factory``budget``Task``SalesTask``budget``task_type``SalesTask``Task`

# haskell - 什么是 Just in Haskell，为什么没有它这个函数就不能工作？

> ID：11677789
> 
> 赞同：4
> 
> 时间：2012-07-26T20:48:09.970
> 
> 标签：haskell, types, maybe

我有以下函数，其作用类似于索引运算符：

```
let {
  index :: [a]->Int->Maybe a
  index [] i = error "Empty list"
  index l i = if i <= ((length l) - 1) && i >= 0 then 
      Just(l !! i) 
    else
      error "Index out of bounds"
} 
```

现在，最初我没有使用就写了这个`Just`（我仍然不明白谷歌搜索后它是什么）：

```
let {
  index :: [a]->Int->Maybe a
  index [] i = error "Empty list"
  index l i = if i <= ((length l) - 1) && i >= 0 then
      (l !! i) 
    else
      error "Index out of bounds"
} 
```

对我来说，上述功能非常有意义。因为这里我有一个函数，它接受一个“通用类型”列表，`a`一个`Int`是索引并返回`Maybe`类型的值`a`或引发运行时异常。但是，我不明白 GHCi 告诉我的地方：

```
<interactive>:1:120:
Couldn't match type `a' with `Maybe a'
  `a' is a rigid type variable bound by
      the type signature for index :: [a] -> Int -> Maybe a
      at <interactive>:1:34
Expected type: [Maybe a]
  Actual type: [a]
In the first argument of `(!!)', namely `l'
In the expression: (l !! i) 
```

现在，为什么 GHCi 会与 type 的类型混淆，`l`为什么它需要一个 type 的列表`Maybe a`？最后，如何`Just`解决问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T20:52:57.413

您在类型注释中明确说明您的函数`index`返回一个`Maybe a`.

Maybe 是 Haskell 中定义的一种数据类型：

```
data Maybe a = Just a | Nothing 
```

也就是说，它有两个值构造函数，`Just :: a -> Maybe a`并且`Nothing :: Maybe a`. 因此，为了让您的功能正常工作，它必须返回 a`Just a`或 a `Nothing`。

这也意味着您应该能够稍微考虑一下删除错误语句并将实际错误编码为`Nothing`（即我们超出范围，这里没有元素！）并且仅`Just a`在有意义的情况下返回结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T03:50:34.777

您告诉 GHC 的返回类型为`index`as `Maybe a`。这意味着`(l !! i)`（返回的值`index`）必须是类型`Maybe a`。

由于从`(l !! i)`列表中选择单个元素`l`，这意味着`l`必须是 type`[Maybe a]`才能使其元素之一成为`Maybe a`。

但是`l`是第一个参数`index`，你也告诉 GHC 是输入的`[a]`。

这正是你的错误。GHC 试图将索引编译为 a`[Maybe a]`以获得 a `Maybe a`，但发现被索引的东西是 a `[a]`。

`Just`解决这个问题的原因是它`Just`的类型`a -> Maybe a`。因此，当您说 时`Just (l !! i)`，GHC 现在看到您索引 a`[a]`以获得 a `a`，然后按预期应用`Just`到导致 a 的结果。`Maybe a`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T20:53:34.573

从文档中，[Data.Maybe](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-Maybe.html)：

> Maybe 类型封装了一个可选值。Maybe a 类型的值要么包含 a 类型的值（表示为 Just a），要么为空（表示为 Nothing）。

如果您正在寻找一种类型`Maybe Int`，那么您的函数将返回`Nothing`, 或`Just Int`。

> 它是一种简单的错误单子，所有错误都由 Nothing 表示。

本质上，如果`Nothing`返回，则发生了某些事情，导致函数无法找到结果。`Just`限定符允许您对这些类型`Maybe`进行操作。

# visual-studio-2010 - VB.net / C# 中断变量或对象更改

> ID：11677791
> 
> 赞同：0
> 
> 时间：2012-07-26T20:48:20.467
> 
> 标签：visual-studio-2010, debugging, breakpoints, visual-studio-debugging

假设我有一个包含 30 多个项目的 Visual Studio 解决方案，并且每个项目都有更多的代码，你可以摇一摇。如果我知道我的代码中的对象或变量在某行代码之后发生更改，我可以告诉 Visual Studio 设置断点并在此变量或对象更改时停止吗？我可以告诉它在单个方法范围之外的某些条件下中断和停止吗？

我在工作中修复 bug 的 90% 时间是因为需要很长时间才能弄清楚它在哪里发生了变化，而且一旦我知道我可以从那里去哪里并且通常会很快修复它。

*   Visual Studio 是否具有托管代码（VB.net / C#）的此功能？
*   视觉工作室有类似的东西吗？
*   Visual Studio 甚至有能力进行“智能”调试吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T15:57:52.780

看来你不能这样做。你只能做条件断点。您可以在事件处理程序中编程并获得属性更改的触发器，但这只是为了调试某些东西而做的很多工作。

# css - 导航栏中的滑动突出显示

> ID：11677793
> 
> 赞同：1
> 
> 时间：2012-07-26T20:48:24.777
> 
> 标签：css

我目前在我正在制作的网页上有这个：

**HTML**

```
<div id="pageHeader">
    <nav id="siteNav">
        <ul>
            <li id="currentNavTab"><a href="index.php"><span>Home</span></a></li>
            <li><a href="services.php"><span>Services</span></a></li>
            <li><a href="gallery.php"><span>Gallery</span></a></li>
            <li class="LastNavTab"><a href="contact.php"><span>Contact</span></a></li>
        </ul>
    </nav>
</div> 
```

**CSS**

```
nav#siteNav {
list-style: none;
margin: 0;
padding: 0;
text-align: center;
}

nav#siteNav ul {
padding: 0;
background-image: url('NavTabsBG.jpg');
box-shadow: inset 0px 2px 8px 2px rgba(0, 0, 0, 0.4);
border-radius: 8px;
}

nav#siteNav li {
display: inline;
width: 240px;
padding-left: 50px;
padding-right: 50px;
}

nav#siteNav a {
display: inline-block;
padding: 10px;
color: rgb(255, 235, 200);
font-size: 36px;
text-shadow: 0px 2px 0px rgba(0, 0, 0, 0.6);
} 
```

代码结果如下： ![当前网页外观](../Images/900f38d3fb1c2bb11577774f1fe31906.png)

我想要它，以便当前选择的选项卡具有突出显示，可以是位图或使用背景渐变生成；像这样的样机：

![我希望页面看起来像什么](../Images/6f52a5f91ddb24872c455530fb63ab23.png)

我的布局有问题。我试图将背景放在 li 的后面，但显示不正确：

![什么没用](../Images/3c1c853c91d0bf79f0dd8db939884ff5.png)

作为 web 开发的相对业余爱好者，我不知道如何解决这个问题并获得我想要的结果。另一个问题是我希望突出显示在圆形边框内被掩盖。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:04:21.030

这是一个小提琴。[http://jsfiddle.net/57VC8/1/](http://jsfiddle.net/57VC8/1/)

我做了什么：

1.  在 li 上设置 display inline-block。为什么？将内联块或块（即具有其中一种显示的元素）放在内联元素中可能会给您带来一些难以理解的问题。
2.  在元素上设置所有宽度和填充，`a`而不是在`li`.
3.  向当前选定的链接添加了一个“当前”类，您可以通过它应用您想要的任何样式。

# heroku - 我可以使用 Heroku buildpacks 部署到我自己的本地服务器吗？

> ID：11677798
> 
> 赞同：6
> 
> 时间：2012-07-26T20:48:50.820
> 
> 标签：heroku, amazon-ec2, setup-deployment

[我真的很喜欢Heroku](http://www.heroku.com)的部署架构。

是否可以使用熟悉的命令将 Heroku 的 buildpack 之一（例如[Heroku 的 buildpack for Ruby](https://github.com/heroku/heroku-buildpack-ruby)）部署到我自己的服务器（本地 Linux 或运行 Ubuntu 的 EC2）

```
linux> git push localserver master 
```

其中**localserver**是一个 git 端点，我可以将我的存储库推送到该端点。

如果是这样，是否有任何地方记录了设置本地或 EC2 服务器以将其作为可重复的过程来执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T08:53:47.637

也许我不是很有帮助，但只想提一下 Heroku 自己关于 buildpacks 的博客文章说（[http://blog.heroku.com/archives/2012/7/17/buildpacks/](http://blog.heroku.com/archives/2012/7/17/buildpacks/)）：

> 使用 buildpack 可以方便地利用现有的开源代码向您自己的平台添加新的语言和框架支持。[Stackato](http://www.activestate.com/stackato)是 ActiveState 的平台即服务，[最近宣布支持 Heroku buildpacks](http://www.marketwatch.com/story/activestate-introduces-stackato-support-for-heroku-buildpacks-2012-06-19)。
> 
> 您还可以在本地工作站或使用[Mason](https://github.com/ddollar/mason)的传统基于服务器的环境中运行 buildpack 。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-07-27T09:40:41.980

不，但我知道有几个开源 Heroku 克隆可以在自己的服务器上使用。尽管如此，快速的谷歌并没有透露任何信息。

# java - Java：如何从 ArrayList 写入 csv 文件

> ID：11677799
> 
> 赞同：0
> 
> 时间：2012-07-26T20:48:51.280
> 
> 标签：java, file, csv

我有一个 ArrayList（实际上是一个 ArrayList 的 ArrayList），每个都有整数、双精度和字符串。我想将这些写入 csv 文件。

似乎`PrintWriter`需要数据是`CharSequence`. 或者，当我尝试使用 的`write()`功能时`BufferedWriter`，它要求我指定类型，例如`int`或`String`。

有没有办法可以将不同的类型写入 csv 文件？如果可能的话，我宁愿避免使用 3rd-party 实用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:51:32.417

您需要事先将要输出的每种类型转换为字符串表示形式。如果它是您自己的类，您尝试转换为字符串，请为其创建一个`public String toString()`方法，该方法将在附加到字符串或传递给需要字符串的任何内容时自动调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:53:56.917

CSV 文件不关心值类型是什么，因此您应该将所有数据写入字符串。对于非字符串值，这很简单

```
printWriter.write("" + <integer or float variable>); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:51:40.363

在写入之前使用 String.valueof(elementList) 转换 String 中的每个值？

# html - mvc4 - 显示来自 ienumerable 的文本，而不是值

> ID：11677802
> 
> 赞同：0
> 
> 时间：2012-07-26T20:48:58.567
> 
> 标签：html, asp.net-mvc, ienumerable, asp.net-mvc-4

我有一个 IEnumerable

```
 public static IEnumerable<SelectListItem> getDefaultCraft
    {
        get
        {
            List<SelectListItem> defaultCrafts = new List<SelectListItem>();
            defaultCrafts.Add(new SelectListItem() { Text = "BOTTLEWATCH", Value = "1" });
            defaultCrafts.Add(new SelectListItem() { Text = "CLERK", Value = "2" });
            defaultCrafts.Add(new SelectListItem() { Text = "EXPEDITOR", Value = "4" });
            defaultCrafts.Add(new SelectListItem() { Text = "CRANE OPERATOR", Value = "3" });
            defaultCrafts.Add(new SelectListItem() { Text = "FIELD ACCOUNTANT", Value = "5" });
            defaultCrafts.Add(new SelectListItem() { Text = "FOREMAN – CRANE/RIGG", Value = "6" });
            defaultCrafts.Add(new SelectListItem() { Text = "WELDER", Value = "7" });
            return defaultCrafts;
        }
    } 
```

在一个表单上有一个下拉菜单

```
@Html.DropDownListFor(q1 => q1.positionAppliedFor, ORCA.Models.lookUps.getDefaultCraft) 
```

在另一个表单上，我想显示文本。这将显示值`@Html.Label("Position", cf.positionAppliedFor, new { style = "width:3in;display:inline-block" })` 如何获取文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:31:29.157

该值是唯一从表单回传以进行保存的内容。您需要创建一个函数/字典来将值转换回文本。或者让文本和值相同并将其存储在后端系统中以供以后检索。

一种可能的解决方案如下：

```
public static string GetDefaultCraftByValue(int id){
 switch(id){
   case 1:
    return "BOTTLEWATCH";
   case 2:
    return "CREEK";
   //etc....
 }
} 
```

然后在您定义的另一个函数中，您可以将其更新为以下

```
 public static IEnumerable<SelectListItem> getDefaultCraft
    {
        get
        {
            List<SelectListItem> defaultCrafts = new List<SelectListItem>();
            defaultCrafts.Add(new SelectListItem() { Text = GetDefaultCraftByValue(1), Value = "1" });
            defaultCrafts.Add(new SelectListItem() { Text = GetDefaultCraftByValue(2), Value = "2" });
            defaultCrafts.Add(new SelectListItem() { Text = GetDefaultCraftByValue(3), Value = "4" });
            defaultCrafts.Add(new SelectListItem() { Text = GetDefaultCraftByValue(4), Value = "3" });
            defaultCrafts.Add(new SelectListItem() { Text = GetDefaultCraftByValue(5), Value = "5" });
            defaultCrafts.Add(new SelectListItem() { Text = GetDefaultCraftByValue(6), Value = "6" });
            defaultCrafts.Add(new SelectListItem() { Text = GetDefaultCraftByValue(7), Value = "7" });
            return defaultCrafts;
        }
    } 
```

最后，在您的视图中（或您填充视图模型的任何位置）

```
@Html.Label("Position", GetDefaultCraftByValue(cf.positionAppliedFor), new { style = "width:3in;display:inline-block" }) 
```

这为您提供了一个定义从数值到文本 (DRY) 的映射的位置，并在显示透视图方面完成了您需要的工作。

# .net - F# 版本的 Haskell 列表解构

> ID：11677806
> 
> 赞同：6
> 
> 时间：2012-07-26T20:49:25.150
> 
> 标签：.net, haskell, f#, functional-programming

我如何在 F# 中执行此操作：

```
f acc (x:y:z:xs) = f (acc-x+y*z) xs
f acc [] = acc 
```

那里的算法是任意的，重要的一点是选择列表的前 3 个和尾部，因为我需要使用所有它们和尾部。

我是否必须在 F# 中使用重复的头部调用以弹出 xy 和 z 来强制编写它？

编辑：请评论这种技术在haskell中的正式名称，我会将它放在问题标题中以供其他人未来搜索，我不记得了。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-26T20:54:25.773

当模式匹配失败时你想做什么？你可能想要这个：

```
let rec f acc = function
  | x::y::z::xs -> f (acc-x+y*z) xs
  | _ -> acc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T20:52:46.743

像这样？

```
let rec f acc (x::y::z::xs) = f(acc - x + y * z) xs 
```

但请注意，此函数将始终以 MatchFailureException 结束，因为它会尝试急切地评估 f 直到它到达小于 3 个元素的尾部

# python - 在 Scientific Linux 5 (Redhat 5) 上安装 Python 2.6 和 Python-devel？

> ID：11677808
> 
> 赞同：1
> 
> 时间：2012-07-26T20:49:38.820
> 
> 标签：python, linux

我必须使用 Scientific Linux 5.8 32 位（一些硬件兼容性问题长话短说）。但是，SL-5.8 带有 python 2.4，我需要 python 2.5 或更高版本。

首先我做了 yum install gcc

然后我安装了 python 2.6: ./configure 然后 make install

然后当我尝试运行 yum install python-devel

我得到以下信息： Package python-devel-2.4.3-46.el5_8.2.i386 already installed and latest version 无事可做

其中很多对我来说都是新的，所以如果有人有任何帮助，最好是最容易执行的解决方案。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:28:40.660

我不认为这是最好的方法。

您可以使用安装 python 2.6

```
# yum install python26 
```

然后是开发头文件

```
# yum install python26-devel 
```

我不确定这些是在[EPEL](http://fedoraproject.org/wiki/EPEL)中还是在基本发行版中 - 如果您需要有关如何添加 EPEL 存储库的更多详细信息，我可以进一步解释。

# c# - 使用 C#.net 查找以下时间的所有美国时区的 UTC 时间

> ID：11677813
> 
> 赞同：0
> 
> 时间：2012-07-26T20:49:55.823
> 
> 标签：c#, utc, localtime

我如何在所有这些时间里找到所有这些 TimeZone 的 UTC 时间

*   上午 8 点（所有美国时区的 UTC 时间）
*   下午 5 点（所有美国时区的 UTC 时间）
*   晚上 10 点（所有美国时区的 UTC 时间）

**美国时区**

1.  夏威夷时间
2.  阿拉斯加时间
3.  太平洋时间
4.  山地时间
5.  中部时间
6.  东部时间

我需要使用 C#.net 找到它

**更多细节：**
对于所有好奇我在这些时间做什么的人。 我必须在每天上午 8 点、下午 5 点和晚上 10 点
的这些时间运行预定的作业， 而这个时间应该是用户当地时间。 因此，如果我找到 6 个区域的所有 UTC 时间， 我虽然可以在所有这些 UTC 时间运行我的预定作业。 那将是**6 个区域 x 3 次（8,5,10）= 18 次我将运行我的批次** 希望这种方法对您有意义。

 **谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:44:07.807

如需在时区之间转换的帮助，请查看这篇文章。 [http://www.danrigsby.com/blog/index.php/2008/08/24/timezone-vs-timezoneinfo-in-net/](http://www.danrigsby.com/blog/index.php/2008/08/24/timezone-vs-timezoneinfo-in-net/)

如果您只想检查现在是否是UTC的某个时间

`DateTime.UtcNow.Hour`可能会很有帮助。**

# java - 如何在我的 Java 代码中使用多线程/并发

> ID：11677814
> 
> 赞同：1
> 
> 时间：2012-07-26T20:49:57.653
> 
> 标签：java, multithreading

这是我的代码的简化：

```
for(int i = 0; i < 500; i++) {
    someMethod(i);
} 
```

`someMethod()`执行需要很长时间，所以我想使用多线程将 for 循环分解为 5 个 100 的间隔：

```
for(int i = 0; i < 100; i++) {
    someMethod(i);
}

for(int i = 100; i < 200; i++) {
    someMethod(i);
}

...

for(int i = 400; i < 500; i++) {
    someMethod(i);
} 
```

所以我可以`someMethod()`同时执行不同的`i`.

如何使用多线程来完成此任务？

请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T20:52:33.403

建议在`ExecutorService`这种情况下使用出色的代码。您所做的是将所有任务（0 到 499）提交到线程池中，它们将由池中的 5 个线程同时运行。

类似于以下内容：

```
// create a thread pool with 5 workers
ExecutorService threadPool = Executors.newFixedThreadPool(5);
// submit all of your jobs here
for (int i = 0; i < 500; i++) {
    threadPool.submit(new MyJob(i));
}
// once we have submitted all jobs to the thread pool, it should be shutdown
threadPool.shutdown();
// if you need to wait for the pool you can do
threadPool.awaitTerminatation(Long.MAX_VALUE, TimeUnit.MILLISECONDS); 
```

```
private static class MyJob implements Runnable {
   private int i;
   public MyJob(int i) {
       this.i = i;
   }
   public void run() {
       // do the thread stuff here
   }
} 
```

# c# - c#网络适配器列表

> ID：11677815
> 
> 赞同：9
> 
> 时间：2012-07-26T20:50:00.153
> 
> 标签：c#, list, networking

我有代码，它正在使用`System.Net`和`System.Net.NetworkInformation`引用，它会生成我的网络连接名称列表。

一切似乎都很好并且工作正常，但是当我编写了一个此类代码并将值导出到`listbox1`添加的项目时，我只有一个网络连接名称，但实际上我有四个。

我怎么解决这个问题？

```
private void button1_Click(object sender, EventArgs e)
{
    Adapters obj = new Adapters();
    var value = obj.net_adapters();
    listBox1.Items.Add(value);
}

public class Adapters
{
    public string net_adapters()
    {
        string value = string.Empty;
        foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
        {
            value = nic.Name;
        }
        return value;
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-26T20:56:16.787

我会修改您当前拥有的代码：

```
public string net_adapters() 
{ 
    string value = string.Empty; 
    foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces()) 
    { 
        // bug in your original code right here is `=`
        // you proably meant to do something like value += ", " + nic.Name
        // which would not work well with listbox Items collection
        value = nic.Name; 
    } 
    return value; 
} 
```

变成这样：

```
public System.Collections.Generic.List<String> net_adapters() 
{ 
    List<String> values = new List<String>();
    foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces()) 
    { 
        values.Add(nic.Name);
    } 
    return values; 
} 
```

一种更奇特的方式（尽管它可能无关紧要，因为 GetAllNetworkIntefaces 可能会阻塞，直到它有一个完整的列表）是使用`IEnumerable<T>`and `yield return`：

```
public IEnumerable<String> net_adapters() 
{ 
    foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces()) 
    { 
        yield return nic.Name;
    } 
    yield break;
} 
```

无论哪种方式，您都会像这样使用它：

```
var obj = new Adapters();    
var values = obj.net_adapters();
listBox1.ItemsSource = values; 
```

（附带说明，我建议您使用[.NET Framework 命名指南](http://msdn.microsoft.com/en-us/library/ms229002.aspx)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T20:52:33.450

您只返回最后一项`value = nic.Name;`您应该使用数组或列表来返回所有项目

```
public List<string> net_adapters()
{
     List<string> values = new List<string>();
     foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
     {
         values.Add(nic.Name);
     }
     return values;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-29T10:26:46.673

复制和粘贴[https://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkinterface(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkinterface(v=vs.110).aspx)

```
public static void ShowNetworkInterfaces()
{
IPGlobalProperties computerProperties = IPGlobalProperties.GetIPGlobalProperties();
NetworkInterface[] nics = NetworkInterface.GetAllNetworkInterfaces();
Console.WriteLine("Interface information for {0}.{1}     ",
        computerProperties.HostName, computerProperties.DomainName);
if (nics == null || nics.Length < 1)
{
    Console.WriteLine("  No network interfaces found.");
    return;
}

Console.WriteLine("  Number of interfaces .................... : {0}", nics.Length);
foreach (NetworkInterface adapter in nics)
{
    IPInterfaceProperties properties = adapter.GetIPProperties();
    Console.WriteLine();
    Console.WriteLine(adapter.Description);
    Console.WriteLine(String.Empty.PadLeft(adapter.Description.Length,'='));
    Console.WriteLine("  Interface type .......................... : {0}", adapter.NetworkInterfaceType);
    Console.WriteLine("  Physical Address ........................ : {0}", 
               adapter.GetPhysicalAddress().ToString());
    Console.WriteLine("  Operational status ...................... : {0}", 
        adapter.OperationalStatus);
    string versions ="";

    // Create a display string for the supported IP versions. 
    if (adapter.Supports(NetworkInterfaceComponent.IPv4))
    {
         versions = "IPv4";
     }
    if (adapter.Supports(NetworkInterfaceComponent.IPv6))
    {
        if (versions.Length > 0)
        {
            versions += " ";
         }
        versions += "IPv6";
    }
    Console.WriteLine("  IP version .............................. : {0}", versions);
    ShowIPAddresses(properties);

    // The following information is not useful for loopback adapters. 
    if (adapter.NetworkInterfaceType == NetworkInterfaceType.Loopback)
    {
        continue;
    }
    Console.WriteLine("  DNS suffix .............................. : {0}", 
        properties.DnsSuffix);

    string label;
    if (adapter.Supports(NetworkInterfaceComponent.IPv4))
    {
        IPv4InterfaceProperties ipv4 = properties.GetIPv4Properties();
        Console.WriteLine("  MTU...................................... : {0}", ipv4.Mtu);
        if (ipv4.UsesWins)
        {

            IPAddressCollection winsServers = properties.WinsServersAddresses;
            if (winsServers.Count > 0)
            {
                label = "  WINS Servers ............................ :";
                ShowIPAddresses(label, winsServers);
            }
        }
    }

    Console.WriteLine("  DNS enabled ............................. : {0}", 
        properties.IsDnsEnabled);
    Console.WriteLine("  Dynamically configured DNS .............. : {0}", 
        properties.IsDynamicDnsEnabled);
    Console.WriteLine("  Receive Only ............................ : {0}", 
        adapter.IsReceiveOnly);
    Console.WriteLine("  Multicast ............................... : {0}", 
        adapter.SupportsMulticast);
    ShowInterfaceStatistics(adapter);

    Console.WriteLine();
} 
```

# html - 正文元素不在页面顶部

> ID：11677816
> 
> 赞同：3
> 
> 时间：2012-07-26T20:49:59.687
> 
> 标签：html, css

试图对我的第一个 HTML/CSS uni 作业进行排序，但对此有点卡住了。我的正文标签不在页面顶部。我可以通过给它一个负边距来确保它确实如此，但我不应该这样做，对吧？任何帮助将不胜感激，谢谢。

```
<!DOCTYPE html PUBLIC "-//w3c//DTD XHTML 1.0 strict//EN" "http://www.w3.org/TR/xhtml/DTD/xhtml-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>PhotArt</title>
<link href="main.css" type="text/css" rel="stylesheet" />
</head>
<body>
<!--begin container -->
<div id="navigationContainer">  

<!-- begin navigation bar -->
     <div id="navigationBar">       
        <ul>
            <li><a class="logo" href="index.html">PhotArt</a></li>
            <li><a class="active" href="index.html">Home</a></li>
            <li><a href="#">Create your art</a></li>
            <li><a href="#">Framing</a></li>
            <li><a href="#">Originals</a></li>
            <li><a href="#">About us</a></li>
            <li><a href="#">Contact us</a></li>
        </ul> 
```

在此之后还有其他几段，但我怀疑 html 是否会导致任何问题。

然后 CSS 看起来像这样：

```
html {
    margin: 0;
    padding: 0;
}

body {
    margin: 0;
    padding: 0;
    border: 0;
}

#navigationContainer {
    background-color: #2f2f38;
    padding: 0;
    margin: 0 auto;
}

#navigationBar {
    padding: 0em 0em 10em 0em;
    background-color: #2f2f38;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
}

#navigationBar ul {
    margin-left: auto;
    margin-right: auto;
    width: 900px;
    padding: none;
}

#navigationBar li {
    list-style-type: none;
    display: inline;
    font: 1em "Trebuchet MS", Helvetica, sans-serif;
}

#navigationBar .active {
    color: #ffffff;
}

#navigationBar .logo {
    font: 3.5em "Trebuchet MS", Helvetica, sans-serif;
    color: #fcfcfc;
}

#navigationBar li a {
    text-decoration: none;
    color: #a6a4a4;
    margin-right: 30px;
}

#navigationBar li a:hover,
#navigationBar li a:active {
    color: #ffffff;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:57:24.803

您需要编辑 CSS 并添加 margin-top: 0px; 到导航栏：

```
#navigationBar ul {
margin-top: 0px;
margin-left: auto;
margin-right: auto;
width: 900px;
padding: none;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T20:57:41.453

尝试添加 margin-top:0px; 到#navigationBar

我还假设您已经在您提供给我们的代码中关闭了所有 div/标签。

# vb.net - 登录前在 Windows 启动时加载应用程序

> ID：11677817
> 
> 赞同：0
> 
> 时间：2012-07-26T20:50:04.497
> 
> 标签：vb.net, winforms, startup

我正在编写一个 VB.NET 应用程序，我想在用户登录之前在 Windows 启动时加载它。它将在服务器上运行并启动其他进程并根据需要杀死并重新启动它们以解决内存泄漏问题。它还需要有一个 GUI 来查看其管理的进程的当前状态。

现在，我可以在用户登录时加载应用程序，但这不是很有帮助，因为服务器可能由于某种原因重新启动并且没有用户会登录，但是这个应用程序仍然需要在后台运行。

我该怎么做呢？我需要将其编写为服务，还是有其他方法？我尝试编写一个 WinForms 应用程序，但直到用户登录后它才会加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:56:18.980

您需要编写一个服务。此外，最好编写第二个应用程序，该应用程序将与服务交互并提供一个 GUI 来控制它的作用。

# php - 裁剪图像创建背景颜色的功能

> ID：11677820
> 
> 赞同：0
> 
> 时间：2012-07-26T20:50:14.037
> 
> 标签：php

我有这个功能，当我传递一个小于我想要创建的裁剪的图像时，它会生成更大尺寸的图像，没关系，但其余没有图像的地方，它填充黑色，你知道吗如何使用 fe array(255,255,255) 强制它创建白色或特定颜色？

这是它为你创建的图片，让你直接看到我的意思。

![床](../Images/7ffd41fef84330a92dcab5466cd97583.png)

```
public function crop($x, $y, $width, $height)
{
    $copy=imagecreatetruecolor($width,$height);
    //$this->img = imagecolorallocate($this->img, 23, 123, 456);
    if (imagecopy($copy, $this->img, 0, 0, $x, $y, $width, $height)) {
        $this->img=$copy;
        return true;
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:56:09.140

用于[`imagefill`](http://www.php.net/manual/en/function.imagefill.php)在创建图像后设置图像的颜色。

```
public function crop($x, $y, $width, $height)
{
    $copy=imagecreatetruecolor($width,$height);
    imagefill($copy, 0, 0, imagecolorallocate($copy, 255, 255, 255));// fill with white
    //$this->img = imagecolorallocate($this->img, 23, 123, 456);
    if (imagecopy($copy, $this->img, 0, 0, $x, $y, $width, $height)) {
        $this->img=$copy;
        return true;
    }

    return false;
} 
```

# javascript - 使用 body onload 打开一个新窗口

> ID：11677822
> 
> 赞同：-2
> 
> 时间：2012-07-26T20:50:15.447
> 
> 标签：javascript

编辑-这是代码

```
<html> 
<head> 

<script type="text/javascript"> 
var prodURL = "https://blah"; 

function postwith (to, params) { 
var myForm = document.createElement("form"); 
myForm.method = "post"; 
myForm.target = "_self"; 
myForm.action = to; 

for (var p in params) { 
var myInput = document.createElement("input"); 
myInput.setAttribute("name", p); 
myInput.setAttribute("value", params[p]); 
myInput.setAttribute("type", "hidden"); 
myForm.appendChild(myInput); 
} 

document.body.appendChild(myForm); 
myForm.submit(); 

} 
</script> 

<style type="text/css"> 
#overlayPageLoad { 
background: none repeat scroll 0 0 white; 
height: 100% !important; 
left: 0; 
position: absolute; 
text-align: center; 
top: 0; 
width: 100% !important; 
} 
#overlayPageLoad .middle { 
color: #888888; 
font-size: 16px; 
left: 0; 
position: absolute; 
top: 50%; 
width: 100%; 
} 
</style> 

</head> 

<body onload= "postwith(prodURL, {SF_SESSION:'{!$Api.Session_ID}',SF_ENDPOINT:'{!$Api.Partner_Server_URL_120}'})"; > 

<div id="overlayPageLoad"> 
<span class="middle"> 
<img src="https://prettypicture"> 
&nbsp;Connecting... 
</span> 
</div> 

</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:51:59.237

现代浏览器只允许打开新窗口以直接响应特定的用户生成的操作，例如`click`事件。您无法在其他时间（例如窗口加载或卸载）打开它​​们，因为以前浏览器允许这样做，并且很快就被滥用了。所以现在我们有了弹出窗口拦截器。

**更新**：回复您的评论：

> ...企业当前在现有窗口中打开了该链接，现在他们希望在另一个窗口中打开该链接。

*你*能做到的。您在链接到新窗口中所需页面的页面中执行此操作，而不是正在打开的页面，如下所示：

```
<a href="..." target="_blank">text of link</a> 
```

查看元素的[`target`属性](http://www.w3.org/TR/html5/links.html#attr-hyperlink-target)。`a`

# python - 无法使用子进程进行连续调用

> ID：11677825
> 
> 赞同：2
> 
> 时间：2012-07-26T20:50:31.330
> 
> 标签：python, subprocess

我在使用多个子进程调用时遇到问题。

这两个工作正常：

```
subprocess.call(["gmake", "boot-tilera"], cwd="/home/ecorbett/trn_fp")
p = subprocess.Popen(["gmake", "run-tilera"], stdout=subprocess.PIPE, cwd="/home/ecorbett/trn_fp") 
```

但是，当我尝试在以下之后直接运行此调用时出现错误：

```
time.sleep(10)
subprocess.call(["./go2.sh"], cwd="/home/ecorbett/trn_fp/kem_ut") 
```

我在那里添加了睡眠，因为我需要几秒钟才能运行“./go2.sh”程序。不确定这是否是问题所在。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T23:25:45.520

您的 shell 脚本在命令行上运行的一个可能原因是 shebang 行没有正确编写（或根本没有编写）。查看脚本可以从命令行运行但不能作为 Python 子进程运行的示例：[这是在 Python 中运行 shell 脚本的正确方法吗？](https://stackoverflow.com/questions/4834483/is-this-the-right-way-to-run-a-shell-script-inside-python)

如果您的 shell 脚本没有指定 shebang 行，它可以从命令行运行，因为在您的环境中设置了 $SHELL 并且脚本将其作为默认设置。从 python 子进程运行时，python 不知道它是什么并且失败并显示`OSError: [Errno 8] Exec format error`. 之所以`subprocess.call()`起作用`gmake`，是因为它是二进制程序而不是 shell 脚本。使用参数`shell=True`给出了一个指令，可以像在 shell 中一样解释参数。

`shell=True`但是，使用in时要小心，`subprocess.call()`因为在某些情况下它可能不安全：[subprocess Python docs](http://docs.python.org/library/subprocess.html)。

# jquery - css nth-child(2n+1) 过滤掉列表项后重绘css

> ID：11677827
> 
> 赞同：4
> 
> 时间：2012-07-26T20:50:35.623
> 
> 标签：jquery, css, filter, css-selectors, jquery-isotope

我有一个 20 多个项目的列表。背景颜色使用 :nth-child(2n+1) 选择器改变。（即偶数项黑色，奇数项白色）。当我单击一个按钮以使用 jQuery Isotope 插件过滤掉特定项目时，它会向我要过滤掉的项目添加一个 .isotope-hidden 类，这会将列表项的位置更改为 0,0 并将不透明度更改为 0。

发生这种情况时，其余项目将保留原始的黑色/白色背景颜色，现在不再按顺序排列。

有谁知道在不包含 .isotope-hidden 类的项目上使用 :nth-child(2n+1) 选择器“重绘”css的方法。

我试过了

```
#element tr:not(.isotope-hidden):nth-child(2n+1) 
```

无济于事。

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:57:07.190

Nth-child 在处理组的过滤选择时可能会违反直觉。

使用 .each() 来绕过它的限制：

```
var count = 1;
$('#element tr:not(.isotope-hidden)').each(function(){
    if ( count++ % 2 == 1 ) $(this).css('background-color','white')
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T17:19:17.280

CSS 选择器——尤其是伪类，尤其是伪`:not()`类`:nth-*()`家族——不能用作“过滤器”；[这里](https://stackoverflow.com/questions/5217086/css-selector-involving-pseudo-class-first-child-and-dropcap/5217102#5217102)有一点解释，虽然回想起来似乎有点尴尬。这是一个更好的解释。

*序列中的简单选择器不会按照它们一一*写入的顺序进行处理；*相反，它们*是元素必须匹配的一组条件才能应用样式，并且元素必须按原样匹配所有这些条件。或者除了将它们称为*条件*，您还可以将它们称为*描述符*，但是当涉及到 CSS 选择器时，我会认为“过滤器”是用词不当。

您的选择器意味着：

> 当且仅当它位于`#element`其中并且匹配所有这些条件时，才选择此元素：
> 
> *   它是一个`tr`元素
> *   它没有类`isotope-hidden`
> *   它是其父级的第 (2n+1) 个子级

这并不意味着：

> 1.  看看里面的内容`#element`
> 2.  选择所有`tr`元素
> 3.  过滤掉这些元素中没有类`isotope-hidden`的元素
> 4.  将样式应用于这些过滤元素中的每 (2n+1) 个子元素

即使您可以在过滤掉样式后“重新绘制”或重新应用样式，它也不会起作用。这是因为无论一个元素是否属于`isotope-hidden`类（甚至它是否是一个`tr`！），`:not(.isotope-hidden)`选择器都不会改变这样一个事实，即一个元素是`:nth-child(1)`其父元素在 DOM 中的第一个子元素，一个元素is`:nth-child(2)`是其父级在 DOM 中的第二个子级，以此类推。

如果您需要顺序过滤器，您将无法使用纯 CSS 选择器执行此操作；您必须使用专为此目的而设计的[jQuery 过滤器方法](http://api.jquery.com/category/traversing/filtering)，将一个类添加到相应的元素中，然后您可以使用它来应用您的样式：

```
$('#element tr').not('.isotope-hidden').filter(':even'); 
```

顺便说一句，这也可以重写为单个 jQuery 选择器，使用它的[过滤器选择器](http://api.jquery.com/category/selectors/basic-filter-selectors)：

```
$('#element tr:not(.isotope-hidden):even'); 
```

但是，尽管语法相似，但真正的 CSS 选择器和 jQuery 过滤器之间存在*巨大*差异，[此答案](https://stackoverflow.com/questions/9983297/difference-between-css-selector-and-jquery-filter/10835694#10835694)中对此进行了概述。

# javascript - 如何使外部按钮仅影响类的一个实例？

> ID：11677829
> 
> 赞同：0
> 
> 时间：2012-07-26T20:50:44.600
> 
> 标签：javascript, jquery

我对此很陌生，自学，并且真的可以使用一些指导。我有一系列滑块，每个滑块都有一个信息按钮。按下“信息按钮”时显示信息，按下“关闭按钮”时再次隐藏信息。问题是，我目前必须使用不同的类名（cover1、cover2、cover3 等）为每个滑块编写新代码，因为我不知道如何自动执行此操作。

这是可怕的代码当前正在做的事情：

```
$('.infobtn').click(function(){
    $('.cover', '.boxgrid').stop().animate({top:'0px'},{queue:false,duration:360});
    $(this).hide();
    $('.closebtn').show();
    $(".cover", '.boxgrid').css("pointer-events", "auto");
});
$('.closebtn').click(function(){
    $(".cover", '.boxgrid').stop().animate({top:'455px'},{queue:false,duration:360});
    $(this).hide();
    $('.infobtn').show();
    $(".cover", '.boxgrid').css("pointer-events", "none");
});

$('.infobtn2').click(function(){
    $(".cover2", '.boxgrid').stop().animate({top:'0px'},{queue:false,duration:360});
    $(this).hide();
    $('.closebtn2').show();
    $(".cover2", '.boxgrid').css("pointer-events", "auto");
});
$('.closebtn2').click(function(){
    $(".cover2", '.boxgrid').stop().animate({top:'455px'},{queue:false,duration:360});
    $(this).hide();
    $('.infobtn2').show();
    $(".cover2", '.boxgrid').css("pointer-events", "none");
}); 
```

等等

如果有帮助，这是其中一个标题的 HTML：

```
<div class="boxgrid captionfull" style="z-index: 51;">
    <div id="info" class="cover boxcaption">
        <div id="infotext">
            <h3>Sed eu rutrum velit. Nunc leo massa nunc. Lorem ipsum
            dolor sit amet, consectetur adipiscing elit. Nullam laoreet, nibh
            vitae volutpat euismod, risus leo porta nunc, in hendrerit diam sem
            commodo orci. Cras vitae tincidunt sapien. Integer dolor nisl,
            egestas sit amet mollis a, viverra sed sem. Pellentesque rhoncus
            ursus justo, sit posuere.</h3>
        </div>
    </div>
</div>

<div id="btn" class="infobtn">
    <img src="images/info.png" />
</div>

<div id="btn" class="closebtn" style="display: none;">
    <img src="images/close.png" />
</div> 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:21:48.443

或者你可以让它更简单

```
function bind_events() {
  $('div.infobtn').each(function(index, ele) {
    $($(".cover", '.boxgrid')[index]).stop().animate({top:'0px'},{queue:false,duration:360});
    $(ele).hide();
    $($('.closebtn')[index]).show();
    $($(".cover2", '.boxgrid')[index]).css("pointer-events", "auto");
  });

  $('div.closebtn').each(function(index, ele) {
    $($(".cover", '.boxgrid')[index]).stop().animate({top:'455px'},{queue:false,duration:360});
    $(ele).hide();
    $($('.infobtn')[index]).show();
    $($(".cover", '.boxgrid')[index]).css("pointer-events", "none");
  });
} 
```

这样您就不需要为每种类型的元素创建一个以上的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:05:48.257

您可以使用事件绑定功能，因为您在类名中有模式。

```
function bind_events() {
  $('div[class^=infobtn]').each(function() {
    var num = $(this).attr('class').match(/\d+/)[0];
    if (num == null) num = '';

    $(".cover"+num, '.boxgrid').stop().animate({top:'0px'},{queue:false,duration:360});
    $(this).hide();
    $('.closebtn'+num).show();
    $(".cover2"+num, '.boxgrid').css("pointer-events", "auto");
  });

  $('div[class^=closebtn]').each(function() {
    var num = $(this).attr('class').match(/\d+/)[0];
    if (num == null) num = '';

    $(".cover"+num, '.boxgrid').stop().animate({top:'455px'},{queue:false,duration:360});
    $(this).hide();
    $('.infobtn'+num).show();
    $(".cover"+num, '.boxgrid').css("pointer-events", "none");
  });
} 
```

# asp.net-mvc-3 - MVC3 - 具有复杂类型列表的视图模型

> ID：11677831
> 
> 赞同：18
> 
> 时间：2012-07-26T20:50:54.423
> 
> 标签：asp.net-mvc-3, viewmodel, model-binding, checkboxfor

抱歉，如果之前有人问过这个问题；有一百万种表达方式，因此事实证明很难找到答案。

我有一个具有以下属性的视图模型：

```
public class AssignSoftwareLicenseViewModel
{
    public int LicenseId { get; set; }
    public ICollection<SelectableDeviceViewModel> Devices { get; set; }
} 
```

SelectableDeviceViewModel 的简化版本是这样的：

```
public class SelectableDeviceViewModel
{
    public int DeviceInstanceId { get; set; }
    public bool IsSelected { get; set; }
    public string Name { get; set; }
} 
```

在我的视图中，我试图在输入表单中显示 Devices 属性的可编辑复选框列表。目前，我的视图如下所示：

```
@using (Html.BeginForm())
{
    @Html.HiddenFor(x => Model.LicenseId)
    <table>
        <tr>
            <th>Name</th>
            <th></th>
        </tr>
        @foreach (SelectableDeviceViewModel device in Model.Devices)
        {
            @Html.HiddenFor(x => device.DeviceInstanceId)
            <tr>
                <td>@Html.CheckBoxFor(x => device.IsSelected)</td>
                <td>@device.Name</td>
            </tr>
        }
    </table>

    <input type="submit" value="Assign" />
} 
```

问题是，当模型被发送回控制器时，Devices 为空。

我的假设是这种情况正在发生，因为即使我正在编辑其内容，Devices 属性也从未明确包含在表单中。我尝试将它包含在 HiddenFor 中，但这只是导致模型有一个空列表而不是 null。

知道我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-27T06:23:45.327

> My assumption is that this is happening because even though I'm editing its contents, the Devices property is never explicitly included in the form.

No, your assumption is wrong. The reason this doesn't get bound properly is because your input fields doesn't have correct names. For example they are called `name="IsSelected"` instead of `name="Devices[0].IsSelected"`. Take a look at the correct wire format that needs to be used to bind to collections: [http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

> But why this happens?

It happens because of the `foreach` loop that you used in your view. You used `x => device.IsSelected` as lambda expression for the checkbox but this doesn't take into account the Devices property at all (as you can see by looking at the generated source code of your web page).

> So what should I do?

Personally I would recommend you using editor templates as they respect the navigational context of complex properties and generate correct input names. So get rid of the entire `foreach` loop in your view and replace it with a single line of code:

```
@Html.EditorFor(x => x.Devices) 
```

and now define a custom editor template that will automatically be rendered by ASP.NET MVC for each element of the Devices collection. Warning: the location and name of this template are very important as this works by convention: `~/Views/Shared/EditorTemplates/SelectableDeviceViewModel.cshtml`:

```
@model SelectableDeviceViewModel
@Html.HiddenFor(x => x.DeviceInstanceId)
<tr>
    <td>@Html.CheckBoxFor(x => x.IsSelected)</td>
    <td>@Html.DisplayFor(x => x.Name)</td>
</tr> 
```

* * *

Another approach (which I don't recommend) is to change your current `ICollection` in your view model to an *indexed* collection (such as an `IList<T>` or an array `T[]`):

```
public class AssignSoftwareLicenseViewModel
{
    public int LicenseId { get; set; }
    public IList<SelectableDeviceViewModel> Devices { get; set; }
} 
```

and then instead of the foreach use a `for` loop:

```
@for (var i = 0; i < Model.Devices.Count; i++)
{
    @Html.HiddenFor(x => x.Devices[i].DeviceInstanceId)
    <tr>
        <td>@Html.CheckBoxFor(x => x.Devices[i].IsSelected)</td>
        <td>@Html.DisplayFor(x => x.Devices[i].Name</td>
    </tr>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T06:42:26.473

EditorFor templates work and keep the code clean. You don't need the loops and the model is posted back correctly.

However, has anyone had problems with validation on complex viewmodels (nested EditorFor templates)? I'm using Kendo Validator and am running into all sorts of jquery errors.

# python - 以科学记数法格式显示数组

> ID：11677833
> 
> 赞同：12
> 
> 时间：2012-07-26T20:51:06.387
> 
> 标签：python, numpy

我想以科学记数法（例如 1.2e3）显示我的结果。我的数据是数组格式。是否有类似的函数`tolist()`可以将数组转换为浮点数，以便我可以使用 %E 来格式化输出？

这是我的代码：

```
import numpy as np
a=np.zeros(shape=(5,5), dtype=float)
b=a.tolist()
print a, type(a), b, type(b)
print '''%s''' % b 
# what I want is 
print '''%E''' % function_to_float(a or b) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T22:31:27.917

If your version of Numpy is 1.7 or greater, you should be able to use the `formatter` option to [`numpy.set_printoptions`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.set_printoptions.html#numpy.set_printoptions). ~~1.6 should definitely work -- 1.5.1 may work as well.~~

```
import numpy as np
a = np.zeros(shape=(5, 5), dtype=float)
np.set_printoptions(formatter={'float': lambda x: format(x, '6.3E')})
print a 
```

Alternatively, if you don't have `formatter`, you can create a new array whose values are formatted strings in the format you want. This will create an entirely new array as big as your original array, so it's not the most memory-efficient way of doing this, but it may work if you can't upgrade numpy. (I tested this and it works on numpy 1.3.0.)

To use this strategy to get something similar to above:

```
import numpy as np
a = np.zeros(shape=(5, 5), dtype=float)
formatting_function = np.vectorize(lambda f: format(f, '6.3E'))
print formatting_function(a) 
```

`'6.3E'` is the format you want each value printed as. You can consult the [this documentation](http://docs.python.org/library/string.html#formatspec) for more options.

In this case, `6` is the minimum width of the printed number and `3` is the number of digits displayed after the decimal point.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T21:31:56.947

您可以用科学记数法格式化数组的每个*元素，然后根据需要显示它们。*列表不能转换为浮点数，它们内部可能有浮点数。

```
import numpy as np
a = np.zeroes(shape=(5, 5), dtype=float)
for e in a.flat:
    print "%E" % e 
```

或者

```
print ["%E" % e for e in a.flat] 
```

# android - isFinishing 方法

> ID：11677840
> 
> 赞同：0
> 
> 时间：2012-07-26T20:51:27.950
> 
> 标签：android

`isFinishing()`方法允许检查`finish()`方法是否被调用或者是否`Activity`被系统杀死。

区分这两种情况的目的是什么？

`finish()`调用和杀死`Activity`by系统有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:58:20.297

其实写法是：

> 检查此活动是否正在完成过程中，或者是因为您在其上调用了 finish() ，或者其他人已请求它完成。

它只是说明有两种不同的情况会导致您的应用程序进入“完成”状态。

1.  你造成的
2.  或者是别人造成的

或者，我不理解你的问题。（可能）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T21:40:45.090

> 调用完成（）和被杀死的活动之间的区别

您`finish()`在活动完成并应该关闭时调用。

当用户切换到不同的应用程序时，您的 Activity 将被 Android（系统）杀死，因此您的 Activity 需要被杀死。

# jquery - 创建一个 Facebook Like 访问页面“插件”？

> ID：11677845
> 
> 赞同：0
> 
> 时间：2012-07-26T20:51:41.037
> 
> 标签：jquery, facebook, facebook-like

我正在制作一个下载页面，用户可以在其中从我的网站（不是我的 FB 页面，而是我的 www.myurl.com/download 页面）下载歌曲。是否可以创建一个带有“赞”按钮的灯箱，一旦用户赞了特定的 Facebook 页面，灯箱就会消失，然后他们可以访问该页面并下载歌曲？我知道那里有喜欢下载插件，但我找不到一个干净的。

现在我想了想，如果有什么东西可以做一些事情，如果用户喜欢这个页面，它确实有 xyz 功能，那也可以。

关于这是否可能以及是否有任何想法？

# python - 在保留可挑选性的同时向 python 类添加方法

> ID：11677847
> 
> 赞同：0
> 
> 时间：2012-07-26T20:51:42.960
> 
> 标签：python, inheritance, instance, pickle

我有一个非常复杂的类 A 的实例，我希望向它添加一个函数并能够腌制它。我尝试了两种方法，但都不起作用。首先是去类继承，这似乎并没有复制我想要的一切：

```
import pickle, StringIO

class A:
    def __init__(self):
        self.i=1

class B(A):
    def __init__(self, a):
        self = a

    def printi(self):
        print self.i

a = A()
b = B(a)

out = StringIO.StringIO()
pickle.dump(b,out)
b.printi() # error, cannot find i 
```

另一种策略是直接将新函数添加到实例中。但这不会腌制。

```
import types, pickle, StringIO

a = A()

def printi(self):
    print self.i

a.printi = types.MethodType(printi, a)
a.printi()
out = StringIO.StringIO()
pickle.dump(a,out) # will not pickle 
```

有谁知道将方法添加到类并同时保持可腌制的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:58:20.733

你有没有试过这个：

```
import types, pickle, StringIO

class A(object):
    ## your code here
    pass
a = A()

def printi(self):
    print self.i

A.printi = printi ## sorry this must be the class
a.printi()
out = StringIO.StringIO()
pickle.dump(a,out) # will pickle ? 
```

# facebook-graph-api - 从 FB 相册分享大照片

> ID：11677849
> 
> 赞同：0
> 
> 时间：2012-07-26T20:51:47.307
> 
> 标签：facebook-graph-api, photo

我正在创建一个网络应用程序，我想在其中 1）将照片上传到 Facebook 上特定于应用程序的相册，然后 2）将该照片作为大项目/图像（不是缩略图）分享到用户的时间轴上。我知道这可以通过用户生成的照片可选参数来实现，但是对于网络应用程序还有其他方法可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:14:03.523

没有什么可以阻止 Web 应用程序使用用户生成的照片发布 Open Graph 操作。这是一个简单的过程：

1.  在您的网站上设置 Facebook 身份验证，您最简单的选择是[将 Javascript SDK](https://developers.facebook.com/docs/reference/javascript/)与 getLoginStatus 一起使用。确保向`publish_actions`用户请求许可。
2.  [创建 Open Graph 操作](https://developers.facebook.com/docs/opengraph/define-actions/)和您的[OG 对象类型](https://developers.facebook.com/docs/opengraph/define-objects/)
3.  当用户采取适当的行动时，进行以下形式的 API 调用（使用用户访问令牌和 POST 签名）： `https://graph.facebook.com/me/YOUR_APP_NAMESPACE:YOUR_APP_ACTION? YOUR_OBJECT_TYPE=YOUR_OBJECT_URL& image[0][url]=YOUR_PHOTO_URL& image[0][user_generated]=true`

第 1 步是最难的部分，如果您不遵循 Open Graph 操作路线，无论如何您都必须这样做。

例如，Instagram 将`took`其用作他们的动作和`a photo`对象。他们的对象 URL 只是 Instagram 网站上的各个照片页面。所以他们的 API POST 调用看起来像这样：

`https://graph.facebook.com/me/instagram:took? photo=http://instagram.com/p/ABCD1234/& image[0][url]=http://distilleryimage.instagram.com/somerandomstring.jpg& image[0][user_generated]=true`

正如[用户生成的照片文档](https://developers.facebook.com/docs/opengraph/usergeneratedphotos/)中提到的，这将在用户时间轴和提要上显示为一张大的全角照片。

从 Web 应用程序执行所有这些 API 调用的最简单方法是使用[Javascript SDK](https://developers.facebook.com/docs/reference/javascript/)和[FB.api 函数](https://developers.facebook.com/docs/reference/javascript/FB.api/)。在这种情况下，您根本不需要使用任何服务器端代码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T18:52:38.137

只需在您的照片标题上填写此代码

“用@[124024574287414:0]拍了一张@@[0:[124024574287414:1:photo]]”

（没有双引号）它可以点击到instagram网站，这是我自己的自定义代码，我做了一个星期:(

# pdf - ImageMagick 转换错误：resolveR 中的 /rangecheck，PDF 大于 600KB

> ID：11677854
> 
> 赞同：1
> 
> 时间：2012-07-26T20:52:03.757
> 
> 标签：pdf, imagemagick, thumbnails, ghostscript

在大于约 600KB 的 PDF 上使用此命令时

```
<? passthru("convert -verbose -scale '200x200+0+0>' ".$pdf."[0] $image"); ?> 
```

我得到这个错误输出：

```
ERROR: /rangecheck in resolveR
Operand stack:
   PageCount   4763294   47   46
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1   3   %oparray_pop   1   3   %oparray_pop   1   3   %oparray_pop   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--
Dictionary stack:
   --dict:1129/1686(ro)(G)--   --dict:0/20(G)--   --dict:107/200(L)--   --dict:107/200(L)--   --dict:104/127(ro)(G)--   --dict:241/347(ro)(G)--   --dict:16/24(L)--
Current allocation mode is local 
```

有人对这些较大的文件有解决方法吗？我需要从 4 MB 大的文件中提取第 1 页的缩略图。

下面的 Per Kurt 我也尝试直接访问 gs：

```
<?
    $image = "3.jpg";
    $pdf = '3/ABS_Survey_for_Load_Lines_CIB_100.pdf';
    if (!file_exists($image)) {
        echo passthru("gs \
-sOutputFile=$image \
-sDEVICE=jpeg \
-g200x200 \
-dPDFFitPage \
 $pdf");
    }
?> 
```

这给出了同样的错误：

```
ESP Ghostscript 815.02 (2006-04-19)
Copyright (C) 2004 artofcode LLC, Benicia, CA.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
ERROR: /rangecheck in resolveR
Operand stack:
   PageCount   4763294   47   46
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1   3   %oparray_pop   1   3   %oparray_pop   1   3   %oparray_pop   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--
Dictionary stack:
   --dict:1122/1686(ro)(G)--   --dict:0/20(G)--   --dict:107/200(L)--   --dict:107/200(L)--   --dict:104/127(ro)(G)--   --dict:241/347(ro)(G)--   --dict:16/24(L)--
Current allocation mode is local 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:26:49.830

坏消息！我正在使用有问题的 PDF 使用在线转换器，它给出了“错误的 pdf”错误。请注意，所有 PDF 都将在 Acrobat 中打开，但我拿走了一些有问题的文件，并使用我的 Acrobat 9 重新保存了它们，瞧瞧，缩略图的创建没有问题……

所以这个问题与造船厂用来制作 PDF 的任何软件有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T21:08:59.520

ImageMagick`convert`本身不会打开和处理 PDF 文件。相反，它用作 PDF 输入 Ghostscript 的 *代表*。

您显示的错误是典型的 Ghostscript 错误消息。

要调试这个，你应该先尝试*直接*运行Ghostscript ，看看是否*真的*是Ghostscript的错：

```
gs \
  -dBATCH \
  -dNOPAUSE \
  -sOutputFile=200x200px-output.jpeg \
  -sDEVICE=jpeg \
  -g200x200 \
  -dPDFFitPage \
   2000-kilobyte-input.pdf 
```

另外，查找您拥有的 Ghostscript 版本：`gs -v`. （您应该使用最新版本，例如 9.05）

* * *

**更新：**

由于您的 Ghostscript 版本（ESPGS 8.15.2）...

*   ...超过 6 年（当时 PDF-1.6 和 Acrobat 7 是 PDF 的最新版本），
*   ...但是由于您很可能正在处理最新的 PDF 格式（PDF-1.7 和 Acrobat X 现在是最新的），

...建议您也将 Ghostscript（必须使用此类新文件）升级到当前版本。

# wmi - WQL 在目录中查找文件

> ID：11677855
> 
> 赞同：1
> 
> 时间：2012-07-26T20:52:04.420
> 
> 标签：wmi, wmi-query, wql

如何使用 WMI 查询语言在目录中查找文件？

这是我到目前为止所拥有的：

```
select * from Cim_DataFile
 where path = "\\\\C:\\Users\\name\\" 
```

查询不返回任何结果。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T21:08:25.250

您必须删除属性的驱动器并在`Path`属性中指定该值`Drive`，因此将您的 WQL 语句重写为

> SELECT * from Cim_DataFile where path = "\\Users\\name\\" and Drive="C:"

# python - 从另一个列表中的对应值中减去一个列表中的值

> ID：11677860
> 
> 赞同：33
> 
> 时间：2012-07-26T20:52:29.650
> 
> 标签：python, list

我有两个清单：

```
A = [2, 4, 6, 8, 10]
B = [1, 3, 5, 7, 9] 
```

如何从另一个列表中的相应值中减去一个列表中的每个值并创建一个列表，以便：

```
C = [1, 1, 1, 1, 1] 
```

谢谢。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-07-26T20:53:51.797

最简单的方法是使用列表推导

```
C = [a - b for a, b in zip(A, B)] 
```

或`map()`：

```
from operator import sub
C = map(sub, A, B) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-26T21:01:00.263

由于您似乎是一名工科学生，因此您可能想熟悉[numpy](http://numpy.scipy.org)。如果你已经安装了它，你可以这样做

```
>>> import numpy as np
>>> a = np.array([2,4,6,8])
>>> b = np.array([1,3,5,7])
>>> c = a-b
>>> print c
[1 1 1 1] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-16T14:39:24.727

也许这可能有用。

```
C = []
for i in range(len(A)):
    difference = A[i] - B[i]
    C.append(difference) 
```

# android - 使用 Intent 和 scheme 启动应用程序 android

> ID：11677863
> 
> 赞同：2
> 
> 时间：2012-07-26T20:52:36.823
> 
> 标签：android, android-intent

我正在尝试获取一个 Web URL 来为我的应用程序打开/启动一个活动，但它不起作用。URL 类似于以下内容：

[https://zzz.yyy.com/activate?user="123123123"&token="absdi24](https://zzz.yyy.com/activate?user=) "

我只需要在“激活”点之前识别链接。我的意图如下：

```
<intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="https" android:host="zzz.yyy.com"
            android:path="/activate*"/>
        </intent-filter> 
```

我已经在“路径”末尾尝试了使用和不使用通配符 (*) 的代码，但到目前为止没有任何效果。什么不见​​了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:09:14.150

`android:path`是一个字面上的完整路径。尝试`android:pathPrefix`或`android:pathPattern`——在这种情况下，`pathPrefix`似乎就足够了。

# jquery - 使用 jQuery 拖放后的 DOM 修改

> ID：11677870
> 
> 赞同：0
> 
> 时间：2012-07-26T20:52:59.400
> 
> 标签：jquery, jquery-ui, drag-and-drop, draggable, jquery-ui-draggable

我是 jQuery 的新手。我已经实现了一个拖放场景。我的问题是 jQuery 是否在成功执行拖放操作后自动修改内部 DOM。

这是我的场景。最初我的可放置元素#droppableContainer 是空的。但是在我将一些元素放入其中之后，可放置元素仍然是空的！！！

下面是我编写的一些测试代码，用于遍历我的 droppable 的所有子元素：

```
$('#droppableContainer').children().each(function(item) {
        alert($(this).attr('id'));

}); 
```

上面的测试代码在所有可拖动和可放置事件之后单独执行，但没有打印任何内容。

提前致谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:00:25.400

`drop`如果存在可放置元素，您应该访问可放置容器：

```
$(function() {
    $( "#droppableContainer" ).droppable({
        drop: function( event, ui ) {
            console.log($(this)); // $(this) being the #droppableContainer
        }
    });
});​ 
```

# php - php多数组搜索

> ID：11677871
> 
> 赞同：0
> 
> 时间：2012-07-26T20:53:04.553
> 
> 标签：php, arrays, multidimensional-array

如何在多维数组中搜索值。

我想收到所有在 [created] 中寻找特定日期 Ex(2012-07-25) 的密钥

并接收 array[0][0] 和 array[0][1]

```
Array
(
[0] => Array
    (
        [0] => Array
            (
                [id_store] => 3
                [id_product] => 11
                [monitored] => 0
                [created] => 2012-07-25
            )

        [1] => Array
            (
                [id_store] => 3
                [id_product] => 12
                [monitored] => 0
                [created] => 2012-07-25
            )

        [2] => Array
            (
                [id_store] => 4
                [id_product] => 11
                [monitored] => 0
                [created] => 2012-07-26
            )
    )

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:03:10.333

像这样的东西应该适用于[`array_filter()`](http://php.net/array_filter)：

```
$target = '2012-07-25';
$matches = array_filter( $array[0], function( $el) use( $target) {
    return $el['created'] == $target;
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:09:31.390

尚未对此进行测试，但它应该可以工作：

```
$results = search_date($my_array, $my_date); 
```

`

```
function search_date($array, $date, &$result=array())
{
    foreach($array as $key=>$value)
    {
        if($key == 'created' && $value == $date)
        {
            $result[]=$array;
            continue;
        }
        if(is_array($item))
        {
            search_date($item, $date, $result);
        }
    }
    return $result;
} 
```

就个人而言，我会完全放弃您的数据格式并使用更适合该任务的对象模型。

# java - 从作为第一个对象中的字段的对象访问对象的字段

> ID：11677873
> 
> 赞同：0
> 
> 时间：2012-07-26T20:53:09.443
> 
> 标签：java, object, encapsulation

我想知道在java中是否可以从它自己的一个字段（即对象本身）访问对象的字段。让我提供一个示例代码：

假设我有一个类（我在这里压缩代码，所以我知道呈现的代码不会编译）

```
public class Driver{
// constructor
public Driver(){
}
// method
public double findArea(){
return ???; <<--line #1 in question  How do I get the length and width fields in here?
}
}// end driver class

public class Car{
 public double length; 
 public double width;
 public Driver me;
public Car(){
length=20.5;
width=11.2;
me = new Driver();
}
} 
```

所以在主要部分，我们会有类似的东西

```
public static void main(String arg[]){

car = new Car();
car.me.findArea();  << ---line #2 in question
} 
```

所以在问题的第 2 行中，将执行一个公共方法 .findArea() ，然后需要以某种方式进入调用对象的字段并提取数值（有问题的第 1 行）。

通过Java有可能吗？如果不是，这个问题的最佳概念解决方案是什么？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:57:13.047

如果我正确理解你的问题...

不，没有办法从 of 的实例向后导航`Driver`到具有引用它`Car`的`driver`字段的 a 。毕竟，可能有*几个*这样`Car`的例子，或者根本没有。

如果您想`Driver`知道`Car`它属于哪个部分，则需要有一个字段`Driver`来表示该信息，然后通过（例如）将其传递`this`给构造函数`Car`来设置它。`Driver`不过要小心 - 允许*在*`this`构造函数中转义（您从构造函数调用构造函数）可能很危险，因为您在对象完全初始化之前宣传它的存在。*`Driver``Car`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:59:17.307

您需要引用第一个对象。您可以执行以下操作：

```
public class Driver {

    private Car car;

    public Driver(Car car){
        this.car = car;
    }

    public double findArea(){
        return car.getLength() * car.getWidth();
    }

}

public class Car {

    public double length; 
    public double width;
    public Driver me;

    public Car(){
        length=20.5;
        width=11.2;
        me = new Driver(this);
    }

    // getters and setters

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T21:07:17.400

其他人已经回答了你的问题。我只想指出，`public`数据成员在面向对象编程中被认为是一件坏事（TM）。正如弗朗西斯科所说明的那样，您应该改用 getter 和 setter，并更改成员变量本身以进行`private`访问。

话虽如此，我相信你的设计不是最好的。Driver为什么要计算汽车的面积？Car 不应该负责计算自己的面积，特别是因为它已经知道它的宽度和长度吗？如果您以这种方式设计代码，您将完全消除导致原始问题中问题的问题。*

# javascript - 使用 URL 锚点深度链接相册，无需劫持返回按钮

> ID：11677874
> 
> 赞同：0
> 
> 时间：2012-07-26T20:53:14.777
> 
> 标签：javascript, html, browser

我正在创建一个允许深度链接的照片幻灯片。当用户浏览幻灯片时，URL 栏中的锚标记也会更新，如果有人访问带有锚标记的 URL，则首先显示该幻灯片。示例网址：

[http://domain.com/news/some-article-slug/#/slide5](http://domain.com/news/some-article-slug/#/slide5)

我通过简单地传递`window.location.hash`给对象来做到这一点：

```
start: window.location.hash.substring(7), // eg. "#/slide5"

// ...

var startingSlide;
this.start = 0;
this.deeplink = this.options.start != null;

if (this.deeplink) {
  startingSlide = Number(this.options.start);
  if (startingSlide > 0 && startingSlide <= this.total) {
    // use that number as the starting slide
  }
}

// ...

this.slides.bind("switch", function(idx) {
  if (_this.deeplink) {
    return window.location.hash = "/slide" + (idx + 1);
  }
}); 
```

这一切都很好。我的问题如下：

当用户查看幻灯片和 URL 锚点更新时，这一切都记录在浏览器的历史记录中，因此使用浏览器的后退按钮只是通过锚点返回。我希望后退按钮返回到最后加载的页面。

Imgur 具有我正在寻找的确切行为。这是一个真实的例子：

[http://imgur.com/a/XCUET#0](http://imgur.com/a/XCUET#0)

不过，Imgur 的 javascript 都被缩小了，所以我无法通过阅读真正了解它是如何完成的。

谢谢！

**更新**

我最终使用了这样的东西：

```
var slidePath;

if (this.deeplink) {
  slidePath = [window.location.pathname, "/slide" + (idx + 1)].join("#");
  window.history.replaceState(null, window.title, slidePath);
} 
```

我决定不使用 History.js 有几个原因——我试图在我的页面上不再包含任何 JS 库，当我尝试包含它时，它也给我带来了一些麻烦。对旧浏览器缺乏支持对我来说是可以的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:15:47.127

您应该可以使用 history.js [https://github.com/browserstate/History.js/](https://github.com/browserstate/History.js/) 查看他们的演示页面[http://browserstate.github.com/history.js/demo/](http://browserstate.github.com/history.js/demo/)来完成它。

**replaceState**功能将满足您的需求。

history.js 也将模拟 HTML4 浏览器中的 replaceState 功能——包括 IE8 和 IE9。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T21:11:41.330

您可以使用[history.replaceState()](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history#section_7)来完成此操作。

```
this.slides.bind("switch", function(idx) {
  if (_this.deeplink) {
    var newUrl = window.location + "#/slide" + (idx + 1);
    return window.history.replaceState(null, window.title, newUrl);
  }
}); 
```

# opencl - OpenCL gemm 内核本地内存变慢

> ID：11677877
> 
> 赞同：0
> 
> 时间：2012-07-26T20:53:33.933
> 
> 标签：opencl

编辑：这是我的卡的错......本地内存内核快了几倍，对不起！

我正在编写一个简单的 sgemm (square, alpha=1, beta=0)，它应该利用本地内存，但它的执行速度是原始版本的一半。

以下是内核：

```
 const char* matrixMultiplySource = 
    "__kernel\n"
    "   void matrixMultiply(__global float* A, __global float* B, __global float* C)\n"
    "   {\n"
    "   int i = get_local_id(0);\n"
    "   int j = get_local_id(1);\n"
    "   int ig = get_global_id(0);\n"
    "   int jg = get_global_id(1);\n"
    "   int sizeG0 = get_global_size(0);\n"
    "   __local float localA[BLOCK_SIZE][BLOCK_SIZE];\n"
    "   __local float localB[BLOCK_SIZE][BLOCK_SIZE];\n"
    "   float val=0.0f;\n"
    "   for ( int index = 0; index < sizeG0; index += BLOCK_SIZE )\n"
    "   {\n"
    "       localA[j][i] = A[ig + sizeG0 * (index+j)];\n"
    "       localB[j][i] = B[index+i + sizeG0 * jg];\n"
    "       barrier(CLK_GLOBAL_MEM_FENCE);\n"
    "       #pragma unroll\n"
    "       for ( int kk = 0; kk < BLOCK_SIZE; ++kk)\n"
    "       {\n" 
    "           val = val + localA[kk][i] * localB[j][kk];\n"
    "       }\n"
    "       barrier(CLK_GLOBAL_MEM_FENCE);\n"
    "   }\n"
    "   C[ig + sizeG0 * jg] = val;\n"
    "}\n"
    ;

const char* matrixMultiplySource2 = 
    "__kernel\n"
    "   void matrixMultiply(__global float* A, __global float* B, __global float* C)\n"
    "   {\n"
    "   int ig = get_global_id(0);\n"
    "   int jg = get_global_id(1);\n"
    "   int sizeG0 = get_global_size(0);\n"
    "   float val=0;\n"
    "   for ( int k = 0; k < sizeG0; k++)\n"
    "   {\n"
    "       val = val + A[ig + k * sizeG0] * B[k + jg * sizeG0];\n"
    "   }\n"
    "   C[ig + sizeG0 * jg] = val;\n"
    "}\n"
    ; 
```

BLOCK_SIZE 是 16，我正在使用 1024x1024 矩阵以及热身。

```
 // Create OpenCL context 
context = mycl::myclCreateContext( NULL, ret_num_devices, devices, NULL, NULL, &ret);

// Create Command Queue 
command_queue = mycl::myclCreateCommandQueue(context, devices[0], 0, &ret);

// Create Memory Buffer 
memobjA = mycl::myclCreateBuffer(context, CL_MEM_READ_ONLY, widthA * heightA * sizeof(float), NULL, &ret);
memobjB = mycl::myclCreateBuffer(context, CL_MEM_READ_ONLY, widthB * heightB * sizeof(float), NULL, &ret);
memobjC = mycl::myclCreateBuffer(context, CL_MEM_READ_WRITE, widthC * heightC * sizeof(float), NULL, &ret);

// Copy the lists A and B to their respective memory buffers
ret = mycl::myclEnqueueWriteBuffer(command_queue,memobjA, CL_TRUE, 0,
        widthA * heightA * sizeof(float), A, 0, NULL, NULL);
ret = mycl::myclEnqueueWriteBuffer(command_queue, memobjB, CL_TRUE, 0,
        widthB * heightB * sizeof(float), B, 0, NULL, NULL);

// Create Kernel Program from the source 
program = mycl::myclCreateProgramWithSource(context, 1, (const char **)&matrixMultiplySource,
        NULL, &ret);

// Build Kernel Program 
ret = mycl::myclBuildProgram(program, ret_num_devices, devices, "-D BLOCK_SIZE=16", NULL, NULL);
if(ret != CL_SUCCESS){cout << "PROBREM! " << ret << endl;return -1;}

// Create OpenCL Kernel 
kernel = mycl::myclCreateKernel(program, "matrixMultiply", &ret);

size_t globalThreads[2] = {heightA, widthB};
size_t localThreads[2] = {BLOCK_SIZE, BLOCK_SIZE};

// Set OpenCL Kernel Arguments 
ret = mycl::myclSetKernelArg(kernel, 0, sizeof(cl_mem), (void *)&memobjA);
ret = mycl::myclSetKernelArg(kernel, 1, sizeof(cl_mem), (void *)&memobjB);
ret = mycl::myclSetKernelArg(kernel, 2, sizeof(cl_mem), (void *)&memobjC);   

// Time the kernel
struct timeval timev1, timev2;
float time_seconds = 0.0f;
mycl::myclEnqueueNDRangeKernel(command_queue, kernel, 2, NULL, globalThreads, localThreads, 0, 0, NULL);
mycl::myclFinish(command_queue);
gettimeofday(&timev1, NULL);

ret = mycl::myclEnqueueNDRangeKernel(command_queue, kernel, 2, NULL, globalThreads, localThreads, 0, 0, NULL);
if(ret != CL_SUCCESS){cout << "fail! " << ret << endl;}
ret = mycl::myclFinish(command_queue);  
if(ret != CL_SUCCESS){cout << "fail! " << ret << endl;}

gettimeofday(&timev2,NULL);
time_seconds=(timev2.tv_sec-timev1.tv_sec)+0.000001*(timev2.tv_usec- timev1.tv_usec); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-07T21:42:00.830

You use

```
barrier(CLK_GLOBAL_MEM_FENCE); 
```

where I would expect to see

```
barrier(CLK_LOCAL_MEM_FENCE); 
```

as you write in the loop to local memory. Further I doubt that the copy to localA does help you -- at one time every items there is only accessed once.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T13:37:07.867

您是否查看过 AMD APP KernelAnalyzer 或等效工具中的两个内核？这些工具编译内核并显示其预测的性能特征

# javascript - 无法让 JavaScript 将 ID 读取为变量名

> ID：11677880
> 
> 赞同：1
> 
> 时间：2012-07-26T20:53:42.827
> 
> 标签：javascript, jquery

> **可能重复：**
> [变量名作为 Javascript 中的字符串](https://stackoverflow.com/questions/4602141/variable-name-as-a-string-in-javascript)

我想要做的是有一个输入字段来编辑一些信息。我正在设置它，以便随着每个字段的更改（文本框和复选框的组合），AJAX 更新信息并在配置文件框中显示更改（服务器负载低，这里不关心效率）。如果用户点击 Escape，我希望文本框中的值恢复为原始值（如果他们正在编辑一个他们改变主意的字段）。对于文本框，我遇到了一个变量问题 - 我知道我可以使用数组或隐藏字段，但现在我想知道如何使这个版本工作:)

我设置了我的变量：

```
 var first_name = "' || i.instructor_fname || '"; 
```

我有我的输入字段：

```
<input type="text" id="first_name" value="' || i.instructor_fname ||'"> 
```

和转义功能：

```
if (e.keyCode == 27) { 
   if (document.activeElement.id != "" ) {
       $("#" + document.activeElement.id)
                 .val(document.activeElement.id);
   }
} 
```

对于 first_name，输出为 first_name。该值设置正确，因为文本框已正确填充。似乎我没有将 'first_name' 作为变量读取，而是作为字符串读取。我已经尝试了一些将文字加入其中的组合，但仍然没有运气。有什么想法吗？同样，我知道我可以为此使用其他技术，但似乎弄清楚这一点对于其他项目可能会派上用场。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:58:24.797

我不确定我是否理解，但也许您需要在 document.activeElement.id 上调用 eval()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:14:20.060

我也不确定我是否理解，但是这有多接近呢？

[http://jsfiddle.net/PXcD8/](http://jsfiddle.net/PXcD8/)

html:

```
<input type="text" id="foobar"> 
```

js：

```
$(function()
{
    $(':text').each(function()
    {
        var text = $(this);
        text.keyup(function(event)
        {
            if (event.which == 27)
                reset_textbox();
        });

        reset_textbox();

        function reset_textbox()
        {
                text.val(text.attr('id'));            
        }
    });
}); 
```

这会将文本字段的文本设置为与其最初的 id 相同的值，并且当用户按下转义键使其聚焦时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T21:26:48.900

更合适的解决方案是创建`field_id -> value`地图。这可以通过对象轻松完成：

```
var field_values = {
    first_name: "' || i.instructor_fname || '",
    last_name: "...',
    // ...
}; 
```

然后，您可以通过简单地使用括号表示法来获取值：

```
$("#" + document.activeElement.id)
    .val(field_values[document.activeElement.id]); 
```

假设执行的处理程序绑定到您要修改的元素，代码变得如此简单：

```
$(this).val(field_values[this.id]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T21:45:09.837

如果您正在寻找替代解决方案，为什么不简单地在您的输入中包含一个*默认值*属性。

```
<input type="text" id="first_name" value="' || i.instructor_fname ||'"
    default-value="' || i.instructor_fname ||'" /> 
```

然后在您的 Escape 键处理程序中

```
if (e.keyCode == 27) if (document.activeElement.id != "" ) {
    var e = $("#" + document.activeElement.id);
    e.val(e.attr('default-value'));
} 
```

就个人而言，这感觉比让 javascript 变量浮动更优雅/更干净。

**此外...**

考虑假设*默认值*始终与输入元素初始*值*匹配的实现，那么您甚至不需要更改服务器为您的页面呈现标记的方式。即仍然呈现您的原始输入元素（减去*默认值*属性）。

```
<input type="text" id="first_name" value="' || i.instructor_fname ||'" />​ 
```

您只需要以下启动脚本

```
$(document).ready(function() {
    $('input').each(function() {
        var e = $(this);
        e.attr('default-value', e.val());
    });
}) 
```

# xml - eclipse中的webharvest实现

> ID：11677881
> 
> 赞同：0
> 
> 时间：2012-07-26T20:53:47.243
> 
> 标签：xml, screen-scraping, webharvest

我有一个 XML 配置（ScreenScraper），可以在 WebHarvest 的可执行版本中正确执行我想要的操作。我对如何通过 Java 执行它感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T23:02:31.683

您只需要从库中导入一些类：

```
import org.webharvest.definition.ScraperConfiguration;
import org.webharvest.runtime.Scraper;
import org.webharvest.runtime.variables.Variable; 
```

使用您的 config.xml 文件创建对象 ScraperConfiguration：

```
 ScraperConfiguration config = null;
    try {
        config = new ScraperConfiguration("/path/to/config.xml");
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } 
```

创建具有工作目录路径的对象刮板：

```
 Scraper scraper = new Scraper(config, "/tmp/"); 
```

并执行配置：

```
 scraper.execute(); 
```

您还可以在配置执行后访问变量：

```
 String stringVar =
        ((Variable)scraper.getContext().getVar("my_string_var")).toString();
    List<Variable> listVar =
        ((Variable) scraper.getContext().getVar("my_list_var")).toList(); 
```

[您可以在此处查看示例](http://web-harvest.sourceforge.net/usage.php)

[还有这里的 API](http://web-harvest.sourceforge.net/doc/index.html)

# css - Twitter Bootstrap：容器中的 div 高度为 100%

> ID：11677886
> 
> 赞同：150
> 
> 时间：2012-07-26T20:54:14.967
> 
> 标签：css, twitter-bootstrap, height

使用 twitter bootstrap (2)，我有一个带有导航栏的简单页面，在里面`container`我想添加一个 100% 高度的 div（到屏幕底部）。我的 css-fu 生锈了，我无法解决这个问题。

简单的 HTML：

```
<body>
  <div class="navbar navbar-fixed-top">
   <!-- Rest of nav bar chopped from here -->
  </div>
  <div class="container fill">
    <div id="map"></div> <!-- This one wants to be 100% height -->
  </div>
</body> 
```

当前的 CSS：

```
#map {
    width: 100%;
    height: 100%;
    min-height: 100%;
}

html, body {
    height: 100%;
}

.fill { 
    min-height: 100%;
} 
```

*   编辑 *

我已经按照下面的建议为填充类添加了高度。但是，问题是我在 body 中添加了一个 padding-top 来说明顶部的固定导航栏。这会影响“地图”div 的 100% 高度，并意味着添加了滚动条 - 如下所示：http: [//jsfiddle.net/S3Gvf/2/](http://jsfiddle.net/S3Gvf/2/)谁能告诉我如何解决？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2012-07-26T21:07:16.557

将班级设置`.fill`为`height: 100%`

```
.fill { 
    min-height: 100%;
    height: 100%;
} 
```

[JSFiddle](http://jsfiddle.net/S3Gvf/)

（我放了一个红色背景，`#map`所以你可以看到它占据了 100% 的高度）

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2018-05-27T14:57:27.033

**2019 年更新**

在**Bootstrap 4**中，flexbox 可用于获得填充剩余空间的*全高布局。*

首先，容器**（父级）**需要是全高的：

选项 1_ 为`min-height: 100%;`. 请记住， min-height*仅*在父级具有定义的高度时才有效：

```
html, body {
  height: 100%;
}

.min-100 {
    min-height: 100%;
} 
```

[https://codeply.com/go/dTaVyMah1U](https://codeply.com/go/dTaVyMah1U)

选项 2_ 使用`vh`单位：

```
.vh-100 {
    min-height: 100vh;
} 
```

[https://codeply.com/go/kMahVdZyGj](https://codeply.com/go/kMahVdZyGj)

同样在 Bootstrap 4.1 中，`vh-100`和`min-vh-100`类都包含在 Bootstrap 中，因此不需要额外的 CSS

然后，使用容器上的 flexbox 方向列`d-flex flex-column`，以及要填充剩余高度的`flex-grow-1`任何子div（即**：） 。**`row`

另请参阅：
[Bootstrap 4 导航栏和内容填充高度 flexbox](https://stackoverflow.com/questions/49191957)
[Bootstrap - 在页眉和页脚之间填充流体容器](https://stackoverflow.com/questions/15641142/)
[如何使行拉伸剩余高度](https://stackoverflow.com/questions/42194886/bootstrap-4-how-to-make-the-row-stretch-remaining-height/42195475#42195475)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-05-12T10:07:47.197

这很简单。您可以使用

```
.fill .map 
{
  min-height: 100vh;
} 
```

您可以根据需要更改高度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-17T13:34:33.423

您需要将 padding-top 添加到“填充”元素，并添加 box-sizing:border-box - 此处[为 bootply示例](http://www.bootply.com/GzZ5KYhZHP)

# facebook - Facebook 缓存问题

> ID：11677891
> 
> 赞同：0
> 
> 时间：2012-07-26T20:54:35.463
> 
> 标签：facebook, caching, facebook-opengraph

> **可能重复：**
> [Facebook Open Graph 未清除缓存](https://stackoverflow.com/questions/5776567/facebook-open-graph-not-clearing-cache)

为什么即使在向页面添加开放图元标记后，我们仍然会看到 Facebook 缓存问题。我们有解决这个问题的办法吗？它经常发生。它在使用 URL linter 后工作。但这不能总是用来解决问题。请帮忙。

# css - CSS：如何在 CSS 中获得这种效果渐变？

> ID：11677892
> 
> 赞同：-1
> 
> 时间：2012-07-26T20:54:36.043
> 
> 标签：css

![效果渐变css](../Images/32e817915a98152e2efe63e23defae0d.png)

我想得到紫色或白色的渐变效果，从强烈的色调开始，逐渐直到变暗似乎消失或变得透明，你看到后面的背景。这可能吗？

我希望我已经解释了！

问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:08:45.903

我建议使用 CSS 渐变生成器。

试试这个： http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

它有许多预设，其中一些看起来可能对您有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:13:03.027

```
div {
   height: 500px;
   width: 300px;
   background-image: -o-linear-gradient(#8860af, #4e91cc, #c7deee);
   background-image: -moz-linear-gradient(#8860af, #4e91cc, #c7deee);
   background-image: -webkit-linear-gradient(#8860af, #4e91cc, #c7deee);
} 
```

**现场演示：[Tinkerbin](http://tinkerbin.com/3zt4PRh3)**

**[在这里](http://www.slideshare.net/LeaVerou/mastering-css3-gradients)**阅读更多。

# java - 从 AsyncTask 中设置新位图的引用

> ID：11677895
> 
> 赞同：1
> 
> 时间：2012-07-26T20:54:49.333
> 
> 标签：java, android, android-asynctask

这可能更像是一个 Java 问题而不是 Android 问题，但是我无法检索在 AsyncTask 中创建的位图以存储在另一个类（一个活动）中，以便在我使用完它时可以回收它。

AsyncTask 在 doInBackground() 中创建 Bitmap，并在 onPostExecute() 中将其设置为 ImageView 的位图，ImageView 通过构造函数传入。但完成后，我希望在 Activity 中可以访问位图。Activity 有一个 ImageViews 的 ArrayList 和另一个 Bitmaps，但是由于 AsyncTask 创建了一个新的 Bitmap，我找不到在 Activity 的 Bitmaps 的 ArrayList 中获取这个新对象的简单方法。目前，我通过将 ArrayList 以及列表中的索引传递给 AsyncTask 构造函数来使其工作，并且 doInBackground 只是将数组中的该条目设置为新创建的位图。

不过我不喜欢这个解决方案，因为我希望能够将这个 AsyncTask 用于不同的事情，也许是 Activity 没有位图的 ArrayList。而且我不能简单地给 AsyncTask 构造函数一个 Bitmap，因为 Java 按值传递引用，并且将其设置为新的 Bitmap 对象将不允许调用者访问。

我怎样才能更优雅地做到这一点？

这是相关的代码。为清楚起见，省略了与此问题无关的行。

```
public class LoadCachedImageTask extends AsyncTask<String, Void, Void> {
    private Context context;
    private ImageView image;
    private ArrayList<Bitmap> bitmaps;
    int index;

    public LoadCachedImageTask(Context context, ImageView image, ArrayList<Bitmap> bitmaps, int index) {
        this.context = context;
        this.image = image;
        this.bitmaps = bitmaps;
        this.index = index;
    }

    protected Void doInBackground(String... urls) {
        String url = urls[0];
        Bitmap bitmap = null;

        // Create the bitmap
        File imageFile = new File(context.getCacheDir(), "test");
        bitmap = BitmapFactory.decodeFile(imageFile.getAbsolutePath());

        // Set the bitmap to the bitmap list
        bitmaps.set(index, bitmap);

        return null;
    }

    protected void onPostExecute(Void arg) {
        // Display the image
        image.setImageBitmap(bitmaps.get(index));
    }

    protected void onCancelled() {
        if (bitmaps.get(index) != null) {
            bitmaps.get(index).recycle();
            bitmaps.set(index, null);
        }
    }
} 
```

这是一个使用它的示例 Activity。

```
public class SampleActivity extends Activity {
    private ArrayList<ImageView> images;
    private ArrayList<Bitmap> bitmaps;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        images = new ArrayList<ImageView>();
        bitmaps = new ArrayList<Bitmap>();
        int numImages = 15;

        // Create the images and bitmaps
        for (int i = 0; i < numImages; i++) {
            images.add(new ImageView(this));
            bitmaps.add(null);
        }

        // Load the bitmaps
        for (int i = 0; i < numImages; i++) {
            new LoadCachedImageTask(this, images.get(i), bitmaps, i).execute("http://random.image.url");
        }
    }
} 
```

我没有测试上面的代码，所以它可能不起作用，但我认为它明白了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:17:27.830

`ImageViews`据我了解，您正在尝试将大量位图异步加载到大量位图中。我认为这可以通过一个单独的类来完成，`AsyncTask`每个类都可以多次使用`ImageView`。

你`AsyncTask`应该是这样的：

```
 public class LoadCachedImageTask extends AsyncTask<String, Void, Bitmap> {
    private final WeakReference<ImageView> mImgView;

    public LoadCachedImageTask(ImageView image) {
      mImageView = new WeakReference<ImageView>(image);
    }

    protected Void doInBackground(String... urls) {
      if(urls == null || urls.length < 1) 
        return;

      // Create the bitmap
      final Bitmap bitmap = BitmapFactory.decodeFile(url);

      return bitmap;
    }

    protected void onPostExecute(Bitmap bmp) {
        // Display the image
      if(bmp != null) {
        final ImageView imageView = (ImageView) mImgView.get();
        if(imageView != null) // needed in case the weakreference is removed
          imageView.setImageBitmap(bmp);
    }
} 
```

然后用这样的东西填充你的 ImageViews 数组：

```
for(ImageView imgView : images) {
   (new LoadCachedImageTask<String, Void, Bitmap>)(imgView).execute(getBitmapUrl());
} 
```

for 循环将遍历每个`ImageView`引用并将其传递给一个全新的`AsyncTask`引用。然后它将使用给定的 url 执行 AsyncTask 到您需要的任何位图。只要 ImageView 存在，asynctask 就会保留对 ImageView 的引用。如果由于某种原因，您的 ImageView 被破坏，位图仍将加载，然后立即被丢弃。

# android - 如何增加或减少 ImageView 的大小？

> ID：11677896
> 
> 赞同：0
> 
> 时间：2012-07-26T20:54:49.303
> 
> 标签：android

我想知道如何放大已经在`ImageView`.

我有这个：

```
m_imageView.setImageBitmap(imagen); 
int newHeight = getWindowManager().getDefaultDisplay().getHeight() / 2;
int orgWidth = m_imageView.getDrawable().getIntrinsicWidth();
int orgHeight = m_imageView.getDrawable().getIntrinsicWidth();
int newWidth = (int) Math.floor((orgWidth * newHeight) / orgHeight);
//Use RelativeLayout.LayoutParams if your parent is a RelativeLayout
LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(
                newWidth, newHeight);
m_imageView.setLayoutParams(params);
//m_imageView.setScaleType(ImageView.ScaleType.FIT_START); 
```

但它什么也没做，图像保持不变。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:28:20.740

您是否使视图无效？在您的活动中使用 invalidate() 或 postInvalidate()？

# facebook - Instagram 的帖子未显示在 Facebook Open Graph API 上

> ID：11677898
> 
> 赞同：12
> 
> 时间：2012-07-26T20:54:53.897
> 
> 标签：facebook, api, instagram, facebook-opengraph, facebook-feed

我对 Facebook OpenGraph API 有疑问。每当我使用“/home”或“/feed”请求数据时，Instagram 上的帖子都没有出现。

我一直在谷歌搜索，显然有些人提出了同样的问题，但还没有解决方案。我读到了一些问题，不仅影响来自 Instagram 的帖子，还影响其他第三方应用程序/设备/平台。

甚至在 Facebook 的开发页面上发布的票似乎也有些死了（没有继续）。链接：[https ://developers.facebook.com/bugs/110563582419837/](https://developers.facebook.com/bugs/110563582419837/)

如果你们中的任何人也偶然发现了这个问题并且有一些想法/指针/链接，请分享并讨论它。

非常感激。干杯!

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T17:33:41.390

Facebook 的错误跟踪器中有两个关于此的错误报告： [https](https://developers.facebook.com/bugs/110563582419837) ://developers.facebook.com/bugs/110563582419837和[https://developers.facebook.com/bugs/202119973248747](https://developers.facebook.com/bugs/202119973248747)

核心原因是照片作为[用户生成的照片附加到](https://developers.facebook.com/docs/opengraph/usergeneratedphotos/)[Open Graph](https://developers.facebook.com/docs/concepts/opengraph/)操作，而不是通过常规的照片上传 API。

因此，常规照片权限不会授予对它们的访问权限，并且您需要用户专门允许您访问发布操作的应用程序的 Open Graph 活动。接受上面的错误报告是因为这似乎是对用户生成的照片的操作的疏忽，但也可能是设计使然，在这种情况下，我在下面概述的解决方法将是唯一支持的这样做的方法：

如果您特别需要为用户请求 Instagram（或其他 Open Graph 照片应用）照片，您可以请求访问该应用发布的操作的[权限。](https://developers.facebook.com/docs/reference/login/open-graph-permissions/)

对于 Instagram 照片，您可以通过请求`user_actions:instapp`权限来执行此操作，一旦完成，**Instagram 照片**相册将不再显示为空，并且 Instagram 活动将出现在`feed`连接中。

要找出任意应用程序的命名空间，请访问`https://graph.facebook.com/<APP ID>`并查找该`namespace`字段，

例如对于 instagram，调用`https://graph.facebook.com/124024574287414/?fields=id,namespace`返回：

```
{
  "id": "124024574287414", 
  "namespace": "instapp"
} 
```

使用, ,权限`/feed`检索到的来自我自己的连接的示例照片是：`read_stream``user_photos``user_actions:instapp`

```
{
  "data": [
    {
      "id": "[SNIPPED]", 
      "from": {
        "name": "[SNIPPED]", 
        "id": "[SNIPPED]"
      }, 
      "picture": "[SNIPPED]", 
      "link": "https://www.facebook.com/photo.php?fbid=[SNIPPED]", 
      "icon": "https://fbstatic-a.akamaihd.net/rsrc.php/v2/yb/x/StEh3RhPvjk.gif", 
      "privacy": {
        "value": ""
      }, 
      "type": "photo", 
      "object_id": "[SNIPPED]", 
      "application": {
        "name": "Instagram", 
        "namespace": "instapp", 
        "id": "124024574287414"
      }, 
      "created_time": "2013-01-07T17:33:04+0000", 
      "updated_time": "2013-01-07T17:33:04+0000", 
      "comments": {
        "count": 0
      }
    }, 
```

我还可以使用`/photos`相同的权限访问我的“Instagram 照片”相册的连接，并且可以访问所有 Instagram 的“执行”操作（即照片）`/me/instapp:take`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:05:51.580

Facebook员工在这里。查看正在跟踪此问题的内部任务，我现在只能说这是我们目前意识到并正在调查的问题。如果您想收到任何更新的通知，请务必单击错误报告上的“订阅”。

目前，我建议找到名为“Instagram Photos”的用户的相册 ID，然后调用`GET`请求`/INSTAGRAM_ALBUM_ID/photos`以获取他们的 Instagram 照片。在 Graph API Explorer 工具上，我确认我能够获取我所有的 instagram 图片。由于我的相册是公开的，您应该也可以[查看它们](http://developers.facebook.com/tools/explorer/?method=GET&path=3267420798620/photos)。

# forms - 以 oracle 形式 6i 调用画布

> ID：11677901
> 
> 赞同：0
> 
> 时间：2012-07-26T20:55:04.890
> 
> 标签：forms

我在一种形式中有许多画布我想知道按钮（按下时）如何在画布之间交换，例如如果我想要调用表单，语法是 call_form 但我不知道调用画布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T19:41:32.203

你不能移动到画布，你应该移动到另一个块，这个块必须有一个项目显示在你想要显示的画布上。

```
Go_Block('Name_Block'); 
```

# javascript - JS内部jQuery函数的程序顺序

> ID：11677907
> 
> 赞同：-1
> 
> 时间：2012-07-26T20:55:20.843
> 
> 标签：javascript, jquery

> **可能重复：**
> [Ajax 中的异步是什么意思？](https://stackoverflow.com/questions/3393751/what-does-asynchronous-means-in-ajax)
> [jQuery ajax 返回值](https://stackoverflow.com/questions/4982983/jquery-ajax-return-value)

尝试执行一个包含 jQuery 函数 ( `getJson()`) 作为其一部分的函数，但是当我运行它时，我的 javascript 函数*在*调用`getJson()`. 我想知道为什么 getJson 没有按顺序调用，以及如何解决它。

```
function getUsers(screen_name){
user_list=[]  
var id_list =[]

    $.getJSON(url,  function(json)
    {   
        //do stuff here, I have breakpoint #1 here
    });

    return user_list //breakpoint #2 is here
} 
```

从控制台运行它时：`getUsers('myUser')`它首先到达断点#2，然后到达断点#1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:57:20.877

`getJSON()`默认情况下是异步的。这意味着调用它只是开始操作，其余的 javascript 继续运行。一段时间后，异步操作完成并使用返回的数据调用成功处理程序。

任何需要访问返回数据的代码都必须位于成功处理程序中或您从成功处理程序调用的函数中。您不能使用异步函数而只返回`user_list`您想要的。

相反，您必须重新考虑代码的组织方式，以便使用 的代码`user_list`位于成功处理程序中或从成功处理程序中调用。

`getJSON()`可以设置为同步，但这通常是用 javascript 编程的一种不好的方式，因为它会在网络调用期间锁定浏览器，这通常是一种糟糕的用户体验。相反，如果您正确编写代码来处理它是异步的，那么浏览器将在 ajax 调用的整个持续时间内保持完全交互。

# tomcat - 有人可以帮我理解 Tomcat MBean 吗？

> ID：11677915
> 
> 赞同：0
> 
> 时间：2012-07-26T20:55:57.227
> 
> 标签：tomcat, monitoring, jmx, mbeans

不久前，我发布了[这个](https://stackoverflow.com/questions/11057213/simple-tool-to-monitor-a-tomcat-server-using-jmx)关于监控 Tomcat 服务器的问题。从那时起，我玩了一点，想出了一个程序，它可以将一堆 JMX 信息（MBeanServer 名称、MBean 名称、MBean 属性、它们的描述和值......）输出到一个文本文件中。这是一次很棒的学习经历，但是我无法通过我生成的大量信息来确定哪些信息对确定 Tomcat 服务器和部署在其上的应用程序的运行状况而言真正有用。谁能告诉我 Tomcat MBean 属性描述了什么 a) Tomcat 服务器的整体健康状况，以及 b) 部署在所述服务器上的 webapps 的健康状况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:27:56.900

所以，这就是我发现的。我最初获得的所有信息都严格来自 Tomcat MBean。这些信息在一定程度上很有用，但我没有意识到还有其他类型的 MBean。通过查看 RuntimeMXBeans、ThreadMXBeans 和 MemoryMXBeans，我发现了很多有用的信息。

# c# - linq 查询 n.element 的后代

> ID：11677938
> 
> 赞同：0
> 
> 时间：2012-07-26T20:57:21.217
> 
> 标签：c#, wpf, linq, web-services, rest

嗨，任何人都可以帮助进行 linq 查询，通常我会像这样从客户端填充我的数据网格，以获取对 web 服务的 GET 请求：

```
 {
        string uri = "http://localhost:8002/Service/Customer";
        XDocument xDoc = XDocument.Load(uri);
        var customer = xDoc.Descendants("Customer")
            .Select(n => new
            {
                CustomerID = n.Element("CustomerID").Value,
                Firstname = n.Element("FirstName").Value,
                Surname = n.Element("LastName").Value,
                Age = n.Element("Age").Value,
                //Time = DateTime.Parse(n.Element("TimeAdded").Value)
            })
            .ToList();

        dataGrid1.ItemsSource = customer;
    } 
```

哪个工作正常，但现在我已将客户链接到雇用日期，我的 xml 看起来像这样：

```
<ArrayOfCustomer>
<Customer>
<CustomerID>1</CustomerID>
<FirstName>G</FirstName>
<LastName>Graam</LastName>
<Age>27</Age>
      <CustomerHireDate>
      <HireDate>
      <HireFromDate>15.07.2012</HireFromDate>
      <HireToDate>29.07.2012</HireToDate>
      </HireDate>
      </CustomerHireDate>
</Customer>
</ArrayOfCustomer> 
```

到目前为止，我坚持以下尝试用后代的后代填充数据网格的方法：

```
 string uriShowCarHires = "http://localhost:8002/Service/Customer/{anything}";
            string Uri = uriShowCarHires.Replace("{anything}", textBox1.Text);
            XDocument xDoc = XDocument.Load(Uri);
            foreach (var node in xDoc.Descendants("Customer"))
            {

              \\..... how do you get the descendants of descendants for each n.element?
            } 
```

我不确定这是否会按照我的想法填充数据网格，我希望避免在其中一个数据网格单元格中获取“数组”。我正在寻找这样的输出：

```
Name etc | HireFromDate | HireToDate
G           09.12.2012    01.01.2013 
```

如果有人可以帮助将不胜感激谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:04:10.297

我认为您正在寻找这样的东西（它不是最有效的，但它应该可以工作）：

```
var customer = xDoc.Descendants("Customer")
        .Select(n => new
        {
            Firstname = n.Element("FirstName").Value,
            Surname = n.Element("LastName").Value,
            HireFromDate = n.Element("CustomerHireDate")
                            .Descendents("HireDate").First()
                            .Descendents("HireFromDate").First().Value,
            HireFromDate = n.Element("CustomerHireDate")
                            .Descendents("HireDate").First()
                            .Descendents("HireToDate").First().Value
        })
        .ToList(); 
```

# php - Facebook贴在墙上£显示为特殊字符

> ID：11677944
> 
> 赞同：3
> 
> 时间：2012-07-26T20:57:40.267
> 
> 标签：php, facebook, facebook-graph-api, special-characters

我正在尝试向其中包含 £ 符号的 facebook 提要/墙/时间线发布一条消息。

我试过了：

```
mb_internal_encoding("UTF-8");
$message = "TEST: £ &pound; &#163;"; 
```

和设置：

```
mb_internal_encoding("UTF-8");
mb_http_output( "UTF-8" ); 
```

没运气...

PHP 文档保存为 UTF8。

任何人都知道如何通过 php 脚本在墙上贴一个 £ 符号？帖子机制工作正常。

所以 facebook 获得的数组中的一个值是：

```
$message = "TEST: £ &pound; &#163;";
$DataArray["message"] = $message; 
```

FB命令是：

```
$result = $facebook->api("/me/feed", "post", $DataArray); 
```

结果是带有 ? 在里面。� 对于£符号，其他人只是写出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:15:55.180

> �</p>

这通常是无效 UTF-8 字符的标志。

我敢打赌，您的 PHP 文件是 ISO-8859-1 编码的。井号在 ISO-8859-1 中的代码点与在 UTF-8 中不同。在 UTF-8 上下文中使用 PHP 文件中的数据时，井号无效。

使用 UTF-8 编码保存 PHP 文件 - 这通常可以在编辑器的“另存为”对话框中设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:27:02.080

找到了原因。我正在使用 ScriptFTP 批量上传文件，Filezilla 对其进行了整理。它一定是在上传过程中改变了格式或其他东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T23:25:57.230

我有一个类似的问题，但在我的情况下，我的 php 文件是用 ANSI 编码的，我只需要将文件编码更改为 UTF-8

如果他无效，请记住在您有特殊字符时执行此操作，因此请记住在更改文件编码后编辑这些字符

我帮助过你或其他人 xD

# c# - 在 ItemDataBound 之后触发 control.click

> ID：11677946
> 
> 赞同：0
> 
> 时间：2012-07-26T20:57:42.000
> 
> 标签：c#, asp.net

我有一个显示多行的转发器对象。我在中继器后面还有一个按钮，允许添加新的中继器行。在单击事件之前触发 ItemDataBound 事件的问题。因此，当页面重新加载时，它没有通常会显示的最新项目。查看项目的唯一方法是刷新页面。

数据绑定代码：

```
protected void default_ItemDataBound(object source, RepeaterItemEventArgs e)
        {

            // Bind the controls
            if (e.Item.ItemType == ListItemType.AlternatingItem
                    || e.Item.ItemType == ListItemType.EditItem
                    || e.Item.ItemType == ListItemType.Item
                    || e.Item.ItemType == ListItemType.SelectedItem)
            {

                XElement otherStructureElement = XML.XPathSelectElement(e.Item.DataItem.ToString());

              HtmlAnchor lnkRemove = e.Item.FindControl("lnkRemoveForm") as HtmlAnchor;
              if (lnkRemove != null && otherStructureElement != null)
                  lnkRemove.Attributes.Add("onclick", string.Concat("return deleteOtherStructure('",otherStructureElement.Attribute("id").Value, "');"));

            }
        } 
```

和点击事件

```
 protected void SaveOtherStructuress_Click(object sender, EventArgs e)
    {
        AddOtherStructure();
    } 
```

有没有办法在 ItemDataBound 之前触发 click 事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:16:28.033

> “在单击事件之前触发 ItemDataBound 事件的问题”

你为什么在回发时对转发器进行数据绑定`page_load`？您应该仅通过按钮单击等事件处理程序执行此操作（如果有的话）。

如果[`EnableViewState`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.enableviewstate)是`true`（默认），则不需要在每次回发时都对其进行数据绑定。

# facebook - 为什么回显工具说签名错误？

> ID：11677947
> 
> 赞同：0
> 
> 时间：2012-07-26T20:57:47.007
> 
> 标签：facebook, authentication, authorization, connect, signature

我才刚刚开始学习FB应用程序开发，我的目标是制作一个画布应用程序。[我从这里](https://developers.facebook.com/docs/authentication/signed_request/)了解了回显工具（在该页面上的“调试”标题下）

这是我在前面提到的同一页面上访问回显工具的链接： [https ://developers.facebook.com/tools/echo?signed_request=vlXgu64BQGFSQrY0ZcJBZASMvYvTHu9GQ0YM9rjPSso.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIIIjAiOiJwYXlsb2FkIn0](https://developers.facebook.com/tools/echo?signed_request=vlXgu64BQGFSQrY0ZcJBZASMvYvTHu9GQ0YM9rjPSso.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIsIjAiOiJwYXlsb2FkIn0)

现在，据我了解，URL 中“echo”变量的值是 Facebook 自己根据我的帐户详细信息和官方 Facebook 开发者应用程序的密钥生成的，对吧？

如果是，那么这个页面必须显示签名的请求是有效的，对吧？

但这就是我所看到的：

我收到以下消息：

> 参数
> 
> 作为 GET 和 POST 传递到此页面的参数是：
> 
> {“签名请求”：“vlXgu64BQGFSQrY0ZcJBZASMvYvTHu9GQ0YM9rjPSso.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIIjAiOiJwYXlsb2FkIn0”
> 
> > }
> 
> 签名请求
> 
> 签名错误
> 
> 您的 signed_request 可能未使用我们的 app_id 113869198637480 进行签名。这是有效负载：
> 
> {“算法”：“HMAC-SHA256”，“0”：“有效载荷”}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T03:26:05.737

这仅仅是因为`signed_request`已经用虚拟秘密“秘密”签署了

来自[https://developers.facebook.com/docs/authentication/signed_request/](https://developers.facebook.com/docs/authentication/signed_request/)

> > **你有什么例子吗？**
> > 开头的示例使用秘密作为字符串秘密进行编码，并且数据应该以 {"0":"payload"} 的形式出现。

# batch-file - 在任务计划程序下运行的批处理文件在批处理文件完成后继续运行

> ID：11677951
> 
> 赞同：26
> 
> 时间：2012-07-26T20:58:04.073
> 
> 标签：batch-file

[这是对我之前的问题（链接](https://stackoverflow.com/questions/11676789/is-it-possible-to-show-the-command-prompt-window-when-launching-a-batch-file-fro)）的跟进。

为了进行测试，我制作了这个简单的批处理文件，以确保任务计划程序正确执行批处理文件：

```
cd "C:\Users\user\Desktop"
echo. 2>test.txt 
```

所以在`test.txt`桌面上创建文档后，批处理文件应该结束但它会继续运行：

![运行任务列表](../Images/db614671cfdd7f6f5aa812be0b770a62.png)

有没有办法，无论是在批处理文件的末尾还是任务属性中的设置，都可以确保 cmd 进程退出？

谢谢！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2016-12-04T03:34:47.253

我遇到了完全相同的问题。然而，当我读到 Trevor778 在这篇文章中写的内容时，我感到被欺骗了：

我遇到了同样的问题 - 任务有效，但状态一直显示正在运行。一个简单的尝试是单击左栏中的任务计划程序库。单击操作/刷新。快速。状态更改为就绪。对我来说就是这样，任务运行良好，只是状态没有更新。希望这可以帮助。

参考：[https ://social.technet.microsoft.com/Forums/en-US/2f6dc29c-3b8b-45f5-a2a7-53e076acc062/task-scheduler-scheduler-status-is-being-running-always?forum=winservergen](https://social.technet.microsoft.com/Forums/en-US/2f6dc29c-3b8b-45f5-a2a7-53e076acc062/task-scheduler-scheduler-status-is-being-running-always?forum=winservergen)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-11-06T08:46:02.250

您可以将“退出”添加到脚本的最后一行

```
cd "C:\Users\user\Desktop"
echo. 2>test.txt
exit 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-26T23:41:58.347

运行`TASKKILL /F /IM cmd.exe`将杀死所有 cmd.exe 进程，无论它是否是生成此批处理文件的进程。这可能不是可取的行为。:-)

从您的最后一个问题来看，我猜您仍在使用 运行您的任务`cmd.exe /k`，这将使该窗口无限期地打开。对于无人值守的任务，`cmd.exe /c`是更好的选择。当批处理文件完成时，该过程应该结束。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-11-25T11:17:55.493

在 Windows 7 上相同。将所有批处理文件放在用户运行任务的用户特定路径中的目录中

运行 programm = " **cmd.exe** " (没有路径)

你的演员，我的 where = " **/c "C:\Users[username]\whatever\your_batchfile.bat" >> log.txt"** "

“ **>> log.txt** ” 这样我就可以看到批处理的输出...

开始于 = " **C:\Users[用户名]\whatever** "

我还检查了“以最高权限运行”框

之后一切正常:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-25T09:09:45.037

使用以下

```
exit /B 
```

您可以在 Windows 控制台区域找到更多信息，然后键入：`exit/?`

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-07-26T21:35:12.123

我找到的解决方案是在批处理文件的最后添加这一行：

```
TASKKILL /F /IM cmd.exe 
```

现在批处理文件任务运行并完成后，它不再在所有正在运行的任务列表中，状态返回到“就绪”而不是停留在“正在运行”。

### 警告：

该命令将**杀死所有正在运行的命令处理器实例**，因此它可能是有害的！

# playframework-2.0 - 如何在 Play Framework 2.0.2 中安装 SecureSocial 模块？

> ID：11677952
> 
> 赞同：2
> 
> 时间：2012-07-26T20:58:12.797
> 
> 标签：playframework-2.0, securesocial

我得到了这个模块[https://github.com/jaliss/securesocial/](https://github.com/jaliss/securesocial/)，我什至不知道如何使它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T22:42:24.933

`SecureSocial`与[样品](https://github.com/jaliss/securesocial/tree/master/samples)一起交付：`Java`和`Scala`，您应该检查它们并复制所需的元素。

我上次正在测试样品，可以确保您可以很好地替代详细的文档和`how-to's`

# windows-phone-7 - Windows phone 7 开发打开邮件附件的应用程序

> ID：11677956
> 
> 赞同：0
> 
> 时间：2012-07-26T20:58:24.447
> 
> 标签：windows-phone-7, mime-types, email-attachments

可能吗？我希望如果附件是特定的 mime 类型，我的应用程序会打开它，否则它将被列为可能的查看器选择之一......我用谷歌搜索但我什么也没找到，所以我问自己是否可以在 windows phone 上.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:28:02.667

这是不可能的...打开具有已知 MIME 类型的文件的唯一方法是使用 Web 浏览器任务并传递 Uri。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T05:11:47.750

您不能在 Windows Phone 7 的应用程序中直接关联 MIME 类型。最好的办法是让用户通过您的应用程序下载文件。

简单地说，您可以采取一种潜在的解决方法，即旁加载一个“伪造”在系统级别关联的应用程序的 GUID 的应用程序。[我在这里](http://www.windowsphonegeek.com/news/how-to-trick-windows-phone-os-part-ii--adobe-readers-turn-and-a-general-conclusion)写过。但是，您的问题是，如果没有适当的权限，您将无法访问文件系统。

# json - 在服务器上生成 Core Data Sqlite 数据库

> ID：11677957
> 
> 赞同：0
> 
> 时间：2012-07-26T20:58:39.517
> 
> 标签：json, core-data, sqlite, plist

我有一个将 Core Data 与 Sqlite 结合使用的 iPad 应用程序。当在`managedobjectcontext`. 错误是sql error (19) 约束失败。我发现一些网站引导我修改生成代码并更新`Z_MAX`表中的字段`Z_PRIMARYKEY`。Core Data 在幕后还有其他类似的事情吗？

注意：是的，我知道我不应该这样做，但部分问题是核心数据数据库超过 5 MB，处理来自 plist 的数据需要很长时间。（也许 JSON 会更快？）

*编辑*我刚刚注意到 Z_ENT 是实体 ID。我也必须将其添加到一代中。

*编辑 2*去映射的实体，但我仍然收到错误。即使它看起来是有效的，它也无法进行删除和更新。

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T05:00:13.297

似乎只是应用程序本身的问题。

# xml - 为 XSL-FO 保留相同的 xml 结构

> ID：11677960
> 
> 赞同：-1
> 
> 时间：2012-07-26T20:59:00.470
> 
> 标签：xml, xslt, xsl-fo

我有以下`XML`结构：

```
 <xml>
   <node level="1" companyname="A">
      <node level="2" companyname="b"></node>
  </node>
  <node level="1" companyname="c"> 
 </node> 
```

我需要应用`XSL-FO`转换，以获取 pdf 格式的输出。但是我需要保留`XML`数据的格式。请告诉我如何做到这一点。

这是所需的输出：

> *   一个
>     *   乙
> *   C

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T03:16:06.060

如果*“我需要保存 XML 数据的格式”。*意味着您需要保留层次结构，那么您应该能够使用基本列表。

这个非常基本的例子应该让你开始......

**XML 输入**（修改为格式良好）

```
<xml>
    <node level="1" companyname="A">
        <node level="2" companyname="b"/>
    </node>
    <node level="1" companyname="c"/>
</xml> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:fo="http://www.w3.org/1999/XSL/Format">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="/xml">
        <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
            <fo:layout-master-set>
                <fo:simple-page-master master-name="my-page" page-width="8.5in" page-height="11in">
                    <fo:region-body margin="1in" margin-top="1.5in" margin-bottom="1.5in"/>
                </fo:simple-page-master>
            </fo:layout-master-set>
            <fo:page-sequence master-reference="my-page">
                <fo:flow flow-name="xsl-region-body">
                    <fo:list-block>
                        <xsl:apply-templates/>
                    </fo:list-block>
                </fo:flow>
            </fo:page-sequence>
        </fo:root>
    </xsl:template>

    <xsl:template match="node">
        <fo:list-item>
            <fo:list-item-label end-indent="label-end()">
                <fo:block>&#x2022;</fo:block>
            </fo:list-item-label>           
            <fo:list-item-body start-indent="body-start()">
                <fo:block><xsl:value-of select="translate(@companyname,'abcdefghijklmnopqrstuvwxyz','ABCDEFGHIJKLMNOPQRSTUVWXYZ')"/></fo:block>
                <xsl:if test="node">
                    <fo:list-block>
                        <xsl:apply-templates select="node"/>
                    </fo:list-block>
                </xsl:if>
            </fo:list-item-body>
        </fo:list-item>     
    </xsl:template> 

</xsl:stylesheet> 
```

**XSL-FO 输出**

```
<fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <fo:layout-master-set>
      <fo:simple-page-master master-name="my-page" page-width="8.5in" page-height="11in">
         <fo:region-body margin="1in" margin-top="1.5in" margin-bottom="1.5in"/>
      </fo:simple-page-master>
   </fo:layout-master-set>
   <fo:page-sequence master-reference="my-page">
      <fo:flow flow-name="xsl-region-body">
         <fo:list-block>
            <fo:list-item>
               <fo:list-item-label end-indent="label-end()">
                  <fo:block>•&lt;/fo:block>
               </fo:list-item-label>
               <fo:list-item-body start-indent="body-start()">
                  <fo:block>A</fo:block>
                  <fo:list-block>
                     <fo:list-item>
                        <fo:list-item-label end-indent="label-end()">
                           <fo:block>•&lt;/fo:block>
                        </fo:list-item-label>
                        <fo:list-item-body start-indent="body-start()">
                           <fo:block>B</fo:block>
                        </fo:list-item-body>
                     </fo:list-item>
                  </fo:list-block>
               </fo:list-item-body>
            </fo:list-item>
            <fo:list-item>
               <fo:list-item-label end-indent="label-end()">
                  <fo:block>•&lt;/fo:block>
               </fo:list-item-label>
               <fo:list-item-body start-indent="body-start()">
                  <fo:block>C</fo:block>
               </fo:list-item-body>
            </fo:list-item>
         </fo:list-block>
      </fo:flow>
   </fo:page-sequence>
</fo:root> 
```

**PDF 输出**（我使用 XEP，但 FOP 应该产生相同的结果）

![so_fo-pdf.png](../Images/96f67bed393026a716ae55d4469d09dd.png)

另外，我不确定这是否是一个错字，但在您的输入`b`中`c`是小写字母，在您的输出中是大写字母。如果您不必强制大小写，则可以删除`translate()`. 此外，如果您可以使用 XSLT 2.0，则可以`upper-case()`使用`translate()`.

# ruby-on-rails - 如何使用formtastic为textarea指定一个值？

> ID：11677961
> 
> 赞同：1
> 
> 时间：2012-07-26T20:59:02.857
> 
> 标签：ruby-on-rails, formtastic

尝试使用 formtastic rails 帮助器为 textarea 提供一些默认文本。我不能像在其他输入上那样使用值，那么我该如何实现呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T06:37:14.673

我认为这可能是 Formtastic 中的一个限制或缺失的功能。对于像`:string`你可以做的输入`:input_html => { :value => 'whatever' }`，但 a 的“值”`textarea`不是用 HTML 属性设置的。

试试看（我们将`:input_html`选项传递给内置的 Rails 助手，也许他们会做正确的事情），否则，请在 Github 上提交问题或拉取请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:10:17.130

尝试`:placeholder => placeholder_text`

# java - 如何根据使用 JSP 的特定 struts 动作设置变量？

> ID：11677962
> 
> 赞同：0
> 
> 时间：2012-07-26T20:59:05.730
> 
> 标签：java, spring, jsp, servlets, struts

我有一些“模板”JSP 文件用于多个 struts 操作。我有另一个 JSP 文件，我想根据被调用的特定操作进行设置。例如：

```
<% if(this is one.action) { int testVar = 1; } %>
<% if(this is two.action) { int testVar = 2; } %> 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T12:03:40.560

**使用 Struts 2 的解决方案**

```
import com.opensymphony.xwork2.ActionInvocation;
import com.opensymphony.xwork2.interceptor.Interceptor;

public class MyLoggingInterceptor implements Interceptor {
    private static final long serialVersionUID = 1L;
    public String intercept(ActionInvocation invocation) throws Exception {
        String className = invocation.getAction().getClass().getName();
        System.out.println("Before calling action: " + className);
                    int pageNo = 0 ;
                    if(className.equals("Login")) {
                       pageNo = 1;
                    } else if(className.equals("Login")) {
                       pageNo = 2;
                    } // so on for other pages

                    String result = invocation.invoke();        
                    final ActionContext context = invocation.getInvocationContext ();
                    HttpServletRequest request = (HttpServletRequest) context.get(HTTP_REQUEST);
                    request.setAttribute("pageNo", pageNo);
        return result;
    }

    public void destroy() {
        System.out.println("Destroying ...");
    }
    public void init() {
        System.out.println("Initializing ...");
    }
} 
```

现在，在您想要的任何 jsp 页面中，您都将使用

```
request.getAttribute("pageNo"); 
```

**Struts 1 的解决方案**

而不是 Interceptor 使用 RequestProcessor 将 pageNo 变量放在请求范围内

```
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.struts.action.RequestProcessor; 

public class CustomRequestProcessor extends RequestProcessor { 

public boolean processPreprocess(HttpServletRequest request, HttpServletResponse response) {
        System.out .println("Called the preprocess method before processing the request");
        String path = processPath(request, response);
        if (path == null) {
           return;
        }
        int pageNo = 0 ;
        if(path.equals("Login")) {
            pageNo = 1;
        } else if(path.equals("Login")) {
            pageNo = 2;
        } // so on for other pages
        request.setAttribute("pageNo", pageNo);

        return super.processPreprocess(request,response);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:36:04.210

一种解决方案是让两个操作文件都实现一个通用方法，比如说：

```
public Integer getPageID() {
    return pageID;
} 
```

然后在你的 JSP 中：

```
<s:if test="%{pageID == 0}">
  <s:set name="testVar" value="1"/>
</s:if>
<s:elseif test="%{pageID == 1}">
  <s:set name="testVar" value="2"/>
</s:elseif> 
```

如果您只设置一个变量，那么您应该考虑直接使用动作类中的变量。

# yaws - Erlang yaws 在另一个节点中调用函数

> ID：11677966
> 
> 赞同：0
> 
> 时间：2012-07-26T20:59:21.507
> 
> 标签：yaws

遇到这个问题...

rpc:call('app@anothernode',模块,函数,参数)

..来自 .yaws 文件。

（'module' 只返回一个 ehtml 片段）

问题是我找不到在哪里设置 erlang 魔术 cookie 以连接到另一个节点“另一个节点”。

如果我用'yaws -sname yaws'之类的东西开始偏航，然后发出这个......

erlang:set_cookie(node(),erlang_magic_cookie)。

然后确保我可以 ping 另一个节点，然后发出 rpc 调用（从 yaws 节点内），它连接并返回片段。

我已经阅读了 yaws doco pdf，搜索了 stackoverflow 论坛并在 Google 上搜索了它，但没有成功。

问题：我如何告诉 yaws erlang 魔术 cookie 是 'erlang_magic_cookie' ？

脑？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T03:27:46.550

您可以将“erlang_magic_cookie”放在不透明部分的 yaws.conf 服务器部分中。

然后创建一个模块，然后使用服务器配置中的 start_mod= 行开始。这将调用 yourmodule:start(SConf)。

#sconf 记录有一个不透明部分，它是一个元组列表。从中读取您的 cookie 值并进行设置。

有关 start_mod 和 opaque 数据的详细信息，请参见 yaws.conf 手册页。

我自己没有使用过这种方法，但是我使用 start_mod 来启动我自己的模块，并从 yaws.conf 传递配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T03:09:28.310

是的，在 Windows 上运行这个特定节点所以放弃了，只是将包含魔法 cookie 的文件“.erlang.cookie”放入 C:\Documents and Settings\TheUser 文件夹。

# visual-c++ - erand48 窗口等效

> ID：11677969
> 
> 赞同：0
> 
> 时间：2012-07-26T20:59:39.080
> 
> 标签：visual-c++, random

我正在寻找相当于erand48的windows。在我的代码中，我有一行： `erand48(u.us);` 它给出了错误 error C3861: 'erand48': identifier not found。我发现这是因为 erand48 用于 Unix 而不是 Windows。我相信它会在某个范围内生成一个随机数，但我无法确定。有谁知道解决这个问题的最佳方法是什么？我正在使用 Windows Visual Studios 将多个项目从 Unix 移植到 Visual C++。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:47:31.057

根据描述，[erand48](http://linux.about.com/library/cmd/blcmdl3_erand48.htm)是一个 48 位 RNG，返回一个 double。我不太了解 VC++，不知道它是否重现了 erand48 使用其参数来存储工作值。鉴于参考提供了大纲，自己编写代码应该不会太难。

# c# - 编译表达式树的性能

> ID：11677970
> 
> 赞同：7
> 
> 时间：2012-07-26T20:59:45.493
> 
> 标签：c#, lambda, expression

我有一个简单的场景，我试图在股票对象列表上测试表达式编译树的性能。下面是代码

表达式编译树的性能比静态 lambda 调用慢 5 倍。我不确定这是否是表达式编译树的标准性能。将不胜感激任何见解。

```
LambdaExpression();
List<Stock> stocks = new List<Stock>();
for (int ctr = 0; ctr <= 5000000; ctr++)
{
    Stock stk1 = new Stock() { Price = ctr, Symbol = "A", CloseDate = DateTime.Now, FaceValue = ctr } ;
    stocks.Add(stk1);
}
CompileTimeLamda(a);
DynamicLambda(a);

public static void LambdaExpression()
{
    ParameterExpression CS1 = Expression.Parameter(typeof(Stock), "d");

    var line1 = Expression.Equal(Expression.Property(CS1, typeof(Stock).GetProperty("Symbol")), Expression.Constant("MSFT", typeof(string)));
    var line2 = Expression.GreaterThan(Expression.Property(Expression.Property(CS1, typeof(Stock).GetProperty("CloseDate")),typeof(DateTime).GetProperty("Millisecond")), 
                                 Expression.Constant(0, typeof(int)));
    var line3 = Expression.GreaterThan(Expression.Property(CS1, typeof(Stock).GetProperty("Price")), Expression.Constant((double)0, typeof(double)));
    var line4 = Expression.And(line1,line2);
    var line5 = Expression.OrElse(line4, line3);

    func = Expression.Lambda<Func<Stock, bool>>(line5, new ParameterExpression[] {  CS1 } ).Compile();
}

public static void DynamicLambda(List<Stock> stks)
{
    Stopwatch watch = new Stopwatch();
    watch.Start();
    foreach (var d in stks)
    {
        func(d);
    }
    watch.Stop();
    Console.WriteLine("Dynamic Lambda :" + watch.ElapsedMilliseconds);
}

public static void CompileTimeLamda(List<Stock> stks)
{
    Stopwatch watch = new Stopwatch();
    watch.Start();
    foreach (var d in stks)
    {
        if (d.Symbol == "MSFT" && d.CloseDate.Millisecond > 0 ||
                                  (d.Price) > 0) ;
    }
    watch.Stop();
    Console.WriteLine("Compile Time Lamda " +watch.ElapsedMilliseconds);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T22:23:13.313

我对自己进行了一些测试，比较了 lambda 表达式、编译表达式树、直接函数调用和内联代码。结果非常有趣。我几乎认为我的测试有问题，因为表达式树更快，但我想这并非不可能。lambda 表达式是最慢的！！有趣的是，表达式树比函数调用快，只比内联代码慢一点。完全不是我所期望的。

**编辑：实际上我会认为 lambda 和编译函数在下面的结果中速度相等**

```
 void TestIt()
    {
        var ints = new int[10000000];
        Random rand = new Random();
        for (int i = 0; i < ints.Length; i++)
            ints[i] = rand.Next(100);

        Func<int, int> func1 = i => i + 2;
        Func<int, int> func2 = CompileIt();

        var stopwatch = new Stopwatch();

        for (int x = 0; x < 3; x++)
        {
            stopwatch.Restart();
            for (int i = 0; i < ints.Length; i++)
                ints[i] = func1(ints[i]);
            stopwatch.Stop();
            Console.Write("Lamba                       ");
            Console.Write(stopwatch.ElapsedMilliseconds);
            ShowSum(ints);

            stopwatch.Restart();
            for (int i = 0; i < ints.Length; i++)
                ints[i] = func2(ints[i]);
            stopwatch.Stop();
            Console.Write("Lambda from expression tree ");
            Console.Write(stopwatch.ElapsedMilliseconds);
            ShowSum(ints);

            stopwatch.Restart();
            for (int i = 0; i < ints.Length; i++)
                ints[i] = AddTwo(ints[i]);
            stopwatch.Stop();
            Console.Write("Compiled function           ");
            Console.Write(stopwatch.ElapsedMilliseconds);
            ShowSum(ints);

            stopwatch.Restart();
            for (int i = 0; i < ints.Length; i++)
                ints[i] = ints[i] + 2;
            stopwatch.Stop();
            Console.Write("Compiled code               ");
            Console.Write(stopwatch.ElapsedMilliseconds);
            ShowSum(ints);
        }
    }

    private int AddTwo(int value)
    {
        return value + 2;
    }

    private void ShowSum(int[] ints)
    {
        Console.WriteLine("    Sum = " + ints.Sum(i => i).ToString());
    }

    private Func<int, int> CompileIt()
    {
        var param1 = Expression.Parameter(typeof(int));
        Expression body = Expression.Add(param1, Expression.Constant(2));
        return Expression.Lambda<Func<int, int>>(body, new [] { param1 }).Compile();
    } 
```

3次运行的结果是：

```
Lamba                       164    Sum = 515074919
Lambda from expression tree 86    Sum = 535074919
Compiled function           155    Sum = 555074919
Compiled code               54    Sum = 575074919

Lamba                       153    Sum = 595074919
Lambda from expression tree 88    Sum = 615074919
Compiled function           156    Sum = 635074919
Compiled code               53    Sum = 655074919

Lamba                       156    Sum = 675074919
Lambda from expression tree 88    Sum = 695074919
Compiled function           157    Sum = 715074919
Compiled code               54    Sum = 735074919 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T21:37:54.080

如果您在编译时而不是在运行时编译，差异与编译器拥有更多信息并花费更多精力优化代码有关......此外，使用 lambda，您将拥有一个更“灵活”的程序（您可以在运行时选择 lambda）。这是以额外的函数调用为代价的，并且失去了许多潜在的优化。

为了进行更“公平”的比较，您可以使用以下方式比较静态 lambda 与动态 lambda：

```
Func<Stock, bool> compileTime = (Stock d) => (d.Symbol == "MSFT" && d.CloseDate.Millisecond > 0) || d.Price > 0; 
```

而不是硬编码的代码..

在那里你也会发现差异，但稍微小一点......差异是出于相同的原因（更多优化）......您可以通过手动优化您的 lambda 来减少差异（尽管这并不总是可能的，因为编译器可以创建无法使用 lambda 手动创建的有效 CLI 代码）。

但是例如，如果您将动态 lambda 从以下位置更改：

```
var line5 = Expression.OrElse(line4, line3); 
```

到：

```
var line5 = Expression.OrElse(line3, line4); 
```

您将看到 lambda 如何在原始编译代码的 1 倍和 2 倍之间执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-24T11:45:21.760

这里是利用手动访问表达式并发出有效代码[的替代方法。](https://stackoverflow.com/a/33892716/2492669)

# c# - 大数的 BigInteger 日志问题

> ID：11677972
> 
> 赞同：3
> 
> 时间：2012-07-26T20:59:47.990
> 
> 标签：c#, .net, math, biginteger, logarithm

下面的代码采用 BigInteger`n`并找到小于该数字的数字`n`也是`power of 2`. 它适用于小数字，但语句的第一个分支`if`不适用于 int.MaxValue 及更高版本。对于较大的数字，显然减去`1`( `BigInteger.Log(n - 1)`) 是不够的。

我怎样才能计算出一个足够大的数字来减去它以产生影响，同时也可以处理较小的数字？

```
public BigInteger FindNearestPowerOfTwo (BigInteger n)
{
    double number = 0;
    BigInteger big = 0;

    if (n.IsPowerOfTwo)
    {
        number = BigInteger.Log(n - 1) / BigInteger.Log(2);
    }
    else
    {
        number = BigInteger.Log(n) / BigInteger.Log(2);
    }

    number = Math.Floor(number);

    big = BigInteger.Pow(2, (int) number);

    return (big);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:39:14.910

您可以使用`ToByteArray`来获得明确的表示，然后清除除最高位之外的所有位。

```
public BigInteger FindNearestPowerOfTwo (BigInteger n) {
    Byte[] a = n.ToByteArray();
    int len = a.Length;
    if (a[len - 1] == 0) len--; // leading zero to maintain sign
    for (int i = 0; i < len - 1; i++) a[i] = 0;
    int x = a[len - 1] & 255;
    int y = 1;
    while (x > 1) {
      x >>= 1;
      y <<= 1;
    }
    a[len - 1] = y;
    return new BigInteger(a);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T21:18:18.627

在`if`分支中，您可以从商中减去一些东西，

```
number = BigInteger.Log(n)/BigInteger.Log(2) - 0.9; 
```

例如（我会小心减去 1.0，因为`BigInteger.Log(x)`不准确，商可能有点太小，然后减去 1.0 会给你 2 的错误幂）。这也适用于相当大的数字（但 a`double`只有 53 位精度，因此对于大于 2^(2^54) 的数字，肯定会失败 - 但是，这比当前可用的内存要多得多）。

但当然更容易

```
if (n.IsPowerOfTwo) {
    return n/2;
} 
```

但是，`else`分支是有问题的。如果`n`非常接近 2 的幂，

```
BigInteger.Log(n) / BigInteger.Log(2) 
```

可能有点太大或太小，将商在最接近的整数上移动到确切的结果。您应该检查它`big`确实小于`n`，如果不是，则除以 2。

这可能[`BigInteger.Log(n, 2.0)`](http://msdn.microsoft.com/en-us/library/dd268364.aspx)比除以两个自然对数产生更精确的结果。（我不知道实现。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T22:33:48.250

或者懒人的版本：

```
public static BigInteger FindNearestPowerOfTwo(BigInteger number) {
    bool isPower = number.IsPowerOfTwo;
    int count = 0;
    while(!number.IsZero) {
        Console.WriteLine(number);
        number = number >> 1;
        count ++ ;
    }
    return BigInteger.Pow(2, count - (isPower ? 2: 1));
} 
```

# .net - 全屏 Windows 窗体在单击之前忽略键盘输入

> ID：11677975
> 
> 赞同：1
> 
> 时间：2012-07-26T20:59:52.687
> 
> 标签：.net, windows, winforms, keyboard, kiosk

问题是，一旦登录表单出现，用户就会看到密码文本框中的光标闪烁（以编程方式设置焦点），并输入密码，但在用鼠标单击文本框之前，键盘输入会被完全忽略。

在开发盒中，这不会发生，即使机器只有一台显示器。我有一个`System.Windows.Forms.Form`带有用户名组合框和密码文本框的典型登录表单（扩展）。在生产机器中，应用程序在各种信息亭环境中运行，没有 Windows 资源管理器（我们使用 .bat 和注册表项让我们的应用程序仅在 Windows 启动时启动）。这肯定与问题有关，但我不知道如何。我以这种方式配置了一个笔记本，以便重现和测试该问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:36:20.447

在黑暗中随机拍摄：在表单的 Shown 事件的事件处理程序中调用 this.Activate()。这确保了窗口被激活并在前台。

# php - 如何缩进/美化动态生成的 HTML？

> ID：11677976
> 
> 赞同：3
> 
> 时间：2012-07-26T21:00:06.583
> 
> 标签：php, html

我将 HTML 与 PHP 结合起来生成了一个网页。我的 PHP 代码是：

```
public function generateSelect()
{
    $data = "<select>\n";

    for ($i = 2000;$i<=2012;$i++)
    {
        $data .= "\t<option value='$i'>$i</option>\n";
    }
    $data .= "</select>";
    $this->data = $data;
    return $this;
} 
```

这是我的 HTML：

```
<div>
    <?= $data ?>
</div> 
```

这是结果：

```
<div>
    <select>
    <option value='2000'>2000</option>
    <option value='2001'>2001</option>
    <option value='2002'>2002</option>
    <option value='2003'>2003</option>
    <option value='2004'>2004</option>
    <option value='2005'>2005</option>
    <option value='2006'>2006</option>
    <option value='2007'>2007</option>
    <option value='2008'>2008</option>
    <option value='2009'>2009</option>
    <option value='2010'>2010</option>
    <option value='2011'>2011</option>
    <option value='2012'>2012</option>
</select>
</div> 
```

我知道它可以用`\t`and修复`\n`。但我想知道是否有任何方法可以自动完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T21:01:59.297

它可以用PHP的**[`tidy`](http://il.php.net/manual/en/book.tidy.php)**类来完成。以及PHP的**[`DOM`](http://il.php.net/dom)**扩展。

```
<?php

    $html = <<<HTML
<div>
    <select>
        <option value='2000'>2000</option>
        <option value='2001'>2001</option>
        <option value='2002'>2002</option>
        <option value='2003'>2003</option>
        <option value='2004'>2004</option>
        <option value='2005'>2005</option>
        <option value='2006'>2006</option>
        <option value='2007'>2007</option>
        <option value='2008'>2008</option>
        <option value='2009'>2009</option>
        <option value='2010'>2010</option>
        <option value='2011'>2011</option>
        <option value='2012'>2012</option>
    </select>
</div>
HTML;

    $dom = new DOMDocument();
    $dom->loadXML($html);

    $dom->formatOutput = true;
    echo $dom->saveHTML(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T21:03:27.780

就像 ceejayoz 说的那样，没有必要，但是如果你想在没有 \t 和 \n 的情况下这样做：

```
for ($i = 2000;$i<=2012;$i++)
{
    $data .= "
    <option value='$i'>$i</option>";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-19T12:36:02.237

不要为生产环境中的标记缩进而烦恼。不要使用 HTML 美化过滤器来隐藏代码的潜在问题。

如果您需要在开发环境中缩进代码，请注意前面提到的库（Tidy 和 DOM）会尝试修复您的标记（这是它们的主要目的；缩进是副产品）。

[Dindent](https://github.com/gajus/dindent)不会尝试清理或以其他方式操纵您的输出超出缩进。该库旨在使调试更容易。不要在生产中使用它。

```
$parser = new \Gajus\Dindent\Parser();
$output = $parser->indent('<p>Your HTML</p>'); 
```

# javascript - 仅使用 javascript 隐藏基于 ALT TAG 的元素？

> ID：11677979
> 
> 赞同：0
> 
> 时间：2012-07-26T21:00:48.180
> 
> 标签：javascript

我有一个 wordpress 网站，一个插件使用 cufon 文本替换。（我不完全确定它执行此操作的实际方式，但这并不重要）。

我只想在一两个特定的单词上使用“display:none”。例如，在移动主题上，我想将“联系我们”更改为仅“联系”。即时隐藏它的唯一方法是使用 alt 标签，因为没有类或 ID。

那么我可以使用 JavaScript 来检测 alt 标签“Us”并显示：none 吗？下面的示例代码。

```
<cufon class="cufon cufon-canvas" alt="Us" style="width: 20px; height: 14px; "><canvas width="32" height="17" style="width: 32px; height: 17px; top: -2px; left: -2px; "></canvas><cufontext>Us</cufontext></cufon> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:12:41.883

如果您知道要搜索的元素标签（我假设您有此信息），您可以在文档中查找所有这些标签并检查 alt 属性值。当您找到您正在搜索的特定元素时，您可以随心所欲地使用它。在此示例中，我更改了`textContent`属性。

```
(function () {
  var li = document.getElementsByTagName('li');

  for ( var i = 0, length = li.length; i < length; i++ )
  {
    if ( li[i].getAttribute('alt') === 'two' ) 
      li[i].textContent = 'New Text';
  }

}).call(this); 
```

直播：http: [//jsbin.com/ixitut/2/edit](http://jsbin.com/ixitut/2/edit)

`document`您还可以通过更改为更具体的标签来缩小此搜索的范围。

```
var searchWithin = document.getElementById(/**/)
var tags = searchWithin.getElementsByTagName(/**/) 
```

[https://developer.mozilla.org/en/DOM/element.getElementsByTagName](https://developer.mozilla.org/en/DOM/element.getElementsByTagName)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:04:56.520

我们假设您在谈论图像，因为这是唯一`alt`相关的地方属性。

[`.getAttribute()`](https://developer.mozilla.org/en/DOM/element.getAttribute)在所有标签上使用`cufon`，您可以匹配字符串`Us`：

```
var cufons = document.getElementsByTagName("cufon");
// Loop over and look for the attr
var num = cufons.length;
for (var i=0; i<num; i++) {
  // If it has an alt attr and matches Us inside word boundaries...
  if (cufons[i].getAttribute('alt') && /\bUs\b/.test(cufons[i].getAttribute('alt'))) {
    // set to display:none
    cufons[i].style.display = "none";
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T21:30:15.027

我认为您需要将标签更改为`text`并确定您需要使用标志，在这种情况下我认为您可以使用，即`<a href="...">Contact Us</a>``Contact``link``rel attribute`

```
​&lt;a href="#" rel="us">Contact Us</a> 
```

和javascript更改`Contact Us`为`Contact`您可以使用以下代码

```
​var links=document.getElementsByTagName('a');
for(var i=0;i<links.length;i++)
{
    var rel=links[i].getAttribute('rel');
    if(rel && rel.match(/^us$/i)) links[i].innerHTML='Contact';
} 
```

[**演示**](http://jsfiddle.net/heera/yGzhh/1/)。

或者，不使用任何属性，您只需检查 的`innerHTML`，`a tag`如果它包含，`Contact US`则将其更改`Contact`为如下

```
<a href="#">Contact Us</a> 
```

和javascript更改`Contact Us`为`Contact`您可以使用以下代码

```
var links=document.getElementsByTagName('a');
for(var i=0;i<links.length;i++)
{
    var rel=links[i].innerHTML;
    if(rel && rel.match(/^Contact Us$/i)) links[i].innerHTML='Contact';
} 
```

[**演示**](http://jsfiddle.net/heera/yGzhh/2/)。

**更新：**

我认为默认情况下你可以保留你的`link text as Contact`代替`Contact Us`并检查是否不在任何移动设备中（在桌面浏览器中时）然后将其更改`Contact`为`Contact Us`using `javascript`，即

```
var ismobile=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i); // May be these are not enough but only an example
if(!ismobile){
    // one of above code snippets
} 
```

# android - Android 平板电脑上的 HTML/CSS/JS/Java IDE 可能吗？

> ID：11677981
> 
> 赞同：5
> 
> 时间：2012-07-26T21:00:55.373
> 
> 标签：android, ide

**编辑：**找到了几个很棒的 IDE：

*   [AIDE - Android Java IDE（伟大的 IDE）](https://play.google.com/store/apps/details?id=com.aide.ui&feature=search_result)
*   [网站管理员的 HTML 编辑器精简版](https://play.google.com/store/apps/details?id=com.welant.webmaster.DEMO&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS53ZWxhbnQud2VibWFzdGVyLkRFTU8iXQ..)
*   [DroidEdit（免费版）](https://play.google.com/store/apps/details?id=com.aor.droidedit&feature=related_apps#?t=W251bGwsMSwxLDEwOSwiY29tLmFvci5kcm9pZGVkaXQiXQ..)

因此，在对谷歌进行了一些研究之后，我找不到任何适用于 android 的应用程序来帮助我编写 HTML/CSS/JS 代码。换句话说，没有我们可以加载的支持某种智能感知或自动完成功能的 IDE 应用程序，标签突出显示。

我知道我们有在线 IDE，我们可以将其用于这样的事情，***但是是否有可能没有一个开发人员尝试 Google Play 商店的 IDE？*

> 编辑：出于某种原因，我的平板电脑没有显示我上面显示的任何 IDE，那里有很多这就是为什么我在上面列出了谁正在寻找类似的东西。

我觉得它会很好用；一个完美且非常强大的例子是“ [Autodesk 的 SketchBook](https://play.google.com/store/apps/details?id=com.adsk.sketchbookhd&hl=en) ”，它当然与软件开发无关，但我的观点是——他们在用户界面上的创新表现。他们实现了 Maya 的巨大菜单系统，该系统使用空格键弹出一个精美的 UI 圆圈，该圆圈易于访问并快速提供大多数工具。

类似于 Autodesk 的方法将非常适合作为 Web 开发 IDE。

所以，底线：

**1)**你知道任何用于 Android 平板电脑的当前/正在进行中的 IDE 吗？

**2)**任何有利于希望在 7 英寸平板电脑上尝试内容创建的 Web 开发人员的建议！？我知道很疯狂；0)

**3）**请列出与此问题相关的最有用的 android 工具。

谢谢！

[https://play.google.com/store/apps/details?id=com.adsk.sketchbookhd&hl=en](https://play.google.com/store/apps/details?id=com.adsk.sketchbookhd&hl=en)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-07T19:54:49.263

查看我的应用程序 - [Android Web Developer](https://play.google.com/store/apps/details?id=org.kidinov.awd)。我想这正是你要找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T21:57:58.373

1）你检查过[终端IDE](https://play.google.com/store/apps/details?id=com.spartacusrex.spartacuside&feature=nav_other#?t=W251bGwsMSwyLDYsImNvbS5zcGFydGFjdXNyZXguc3BhcnRhY3VzaWRlIl0.)吗？

# php - Linux php codeigniter权限403错误

> ID：11677989
> 
> 赞同：0
> 
> 时间：2012-07-26T21:01:08.523
> 
> 标签：php, linux, codeigniter, permissions

我正在尝试让 php5 和 codeigniter 在 Arch linux 上工作。现在所有的目录权限都搞砸了。当我得到权限列表时

```
 ls -l

drwxrwxrwx 16 ytsejam users 4096 Jul 26 23:45 public_html 
```

我的 test.php 正在工作，但现在我不断得到：

```
Access forbidden!

You don't have permission to access the requested object. It is either read-protected or not readable by the server. Error 403. 
```

你能帮助我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T23:21:58.270

在文件夹所在的目录上使用以下命令，然后（在阅读有关 Web 服务器的文件权限之后）继续逐渐限制权限，直到您可以确认一切正常。不要***将***您的权限保留为 777。

```
chmod -R 777 /path/to/your/public_html 
```

如果在该命令之后它不起作用，那么还有更多问题。

# php - PHP&AJAX：如何使用未知数量的参数动态调用方法

> ID：11677990
> 
> 赞同：0
> 
> 时间：2012-07-26T21:01:17.187
> 
> 标签：php, ajax, dynamic, methods, loading

我编写了通用类加载器，用于控制和加载 PHP 类（“自动加载”）等。部分代码，简化：

PHP 文件：

```
 namespace Ajax;

 require_once '../Loader.php';

 class Loader extends \Loader{

 static public function getAjaxResponse($Post){

    if (!\Checker::isClassName($Post['className']) || !\Checker::isMethodName($Post['method']) ){
        return '';
    }

    Loader::loadClass($Post['className']);
    $class = '\\'.$Post['className'];

    $handler = array($class, $Post['method']);
    if (is_callable($handler) ){
        $oClass = new $class(true);
        return $oClass->$Post['method']($Post['params']);
    }        
   }
 }

 new Loader;
 echo Loader::getAjaxResponse($_POST); 
```

JS文件：

```
 var requestData = {
   className : 'Menu',
   method : 'assignItemToMenu',
   params : { IdItem: $('input[name="IdItem"]').val(), IdParent:$('select[name="IdParent"]').val() }
 };

 if ($('#itemsSortOrder').children().length == 0){
  $.extend(requestData.params, {addButtons : true} );
 }

 $.post('../classRepository/Ajax/Loader.php?open=' + $_GET['open'], requestData)
    .success(function(data){
       document.write(data);
       window.alert(data);
    })
    .error(function(){
       window.alert('Retrieving data failed.');
    }); 
```

它什么时候起作用？当您在 AJAX 请求中只发送一个参数时，JS 代码包含：

```
 var requestData = {
   className : 'Vocabulary',
   method : 'getReport',
   params : $('#report').val()
 }; 
```

什么时候不起作用？当您需要发送超过 1 个参数时。我尝试使用 call_user_func_array()，但它不适用于 $this-> inside object，该方法必须是静态的。我尝试使用反射，但没有任何成功。

我知道一个地狱的方式，如何做到这一点： eval(); 但这比 eval 更邪恶 :)) ，代码如下所示：

```
 $params = array();
 foreach ($_POST['params'] as $param){
    if (is_string($param) ){
       $params[] = '"'.$param.'"';
    }
    else{
       $params[] = $param;
    }
 }
 $params = implode(',',$params);

 $oClass = new $class;
 eval ('$oClass->$_POST["method"]('.$params.')'); 
```

有谁认识你，怎么解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:42:08.623

我不知道您尝试了什么不起作用，但这应该可以成功替换您的`eval()`：

```
call_user_func_array(array($oClass, $_POST["method"]), $params); 
```

# javascript - 无法识别移动键盘中的冒号键

> ID：11677993
> 
> 赞同：2
> 
> 时间：2012-07-26T21:01:49.297
> 
> 标签：javascript, dom-events, keyboard-events

我有一个按键事件处理程序，我很难确定用户是否在手机键盘（例如 iPhone）中按下了冒号

问题是浏览器为冒号和分号返回相同的`event.keyCode`值（或`event.which`，取决于浏览器）。并且由于在`keydown`事件处理程序触发时，该值尚未添加到`HTMLInputElement's` `value`属性中，我无法使用简单的 get-the-last-character-and-check-if-its-a-colon 逻辑。

并且使用`String.fromCharCode()`for 186（这是`event.which`iPhone上冒号按钮的值）不会给我一个分号而是一个奇怪的圆圈字符。但是打印 `String.fromCharCode(59)` *确实*给了我一个冒号。

这是我的代码的简单版本：

```
isColon : function(event)
                {
                    // first check for desktop browsers 
                    if (event.shiftKey && event.which == constants.KEYS.COLON) //the constant is 186 or 59 depending on browser, this works on all desktop browsers
                        return true;
                    //this doesnt work as event.which=186 which is NOT giving a ":"  when I say String.fromCharCode(event.which)
                    if (String.fromCharCode(event.which) == ":")
                        return true;
                    return false;
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T04:53:10.573

改用按键；您仍然可以 event.preventDefault() 防止字符出现在输入中。

# php - 如何在 do-while 循环中动态更改顺序变量？(PHP)

> ID：11677994
> 
> 赞同：1
> 
> 时间：2012-07-26T21:01:50.050
> 
> 标签：php, variables

> **可能重复：**
> [循环使用通用名称的变量](https://stackoverflow.com/questions/4394547/loop-through-variables-with-common-name)

所以我有这些变量，即$a1、$a2、$a3等等。

在do-while循环中，是否可以根据增量$i调用$aXX变量？

```
$a1 = ...
$a2 = ...
...
$i = 1
do {
   ...
   ... echo $a(<--- here I want to change from 1 to 2, 3, etc according to $i-->)
$i++;
} while ( $i < ....) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T21:07:23.310

使用数组：

```
$a[0] = 0;
$a[1] = 1;
$a[2] = 2;
foreach($a as $res){
    echo $res." / ";
} 
```

或者，正如一些人所建议的：

```
$a0 = 0;
$a1 = 1;
$a2 = 2;

for($i=0;$i<3;$i++)
   echo ${'a' . $i}." / "; 
```

但我会坚持使用数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T21:09:42.153

您可以使用

```
echo ${"a$i"}; 
```

但正如@FelixKling 和@madfriend 评论的那样，您应该改用数组。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-26T21:10:12.500

[变量变量](http://php.net/manual/en/language.variables.variable.php)来拯救！

```
$a1 = ...
//...
$i = 1;
do {
    echo ${'a'.$i};
    $i++;
} while ($i < something); 
```

# matlab - 在 Matlab 中使用 Globals 而不是传递大型数组

> ID：11677996
> 
> 赞同：3
> 
> 时间：2012-07-26T21:01:54.437
> 
> 标签：matlab, global-variables, parameter-passing, pass-by-reference, large-data

我正在使用大型数组（每个大约 70 MB）并且担心将它们传递给函数。我的理解是 Matlab 使用按值传递函数参数，为被调用函数制作本地副本。

作为一种肮脏的解决方法，我一直将大型数组声明为全局数组，并在计算完成时手动取消分配它们。

我的问题：有没有办法在 Matlab 中使用指针？这就是我在 C/C++ 中的做法。如果没有，还有其他更节省内存的方法吗？我读过全局变量通常是一个坏主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T18:03:08.340

@mutzmatron 在评论中回答了我的问题，所以这是一个转发：

实际上Matlab通过引用传递，除非它决定它需要通过值传递......请参阅此处的解释： [http://www.mathworks.com/matlabcentral/answers/...](http://www.mathworks.com/matlabcentral/answers/152-can-matlab-pass-by-reference)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-28T00:02:11.273

我还到处读到全球通常也是一个坏主意。而且，具体来说，我不同意。每个工具都有自己的用途。

我一直致力于优化代码，并发现在所有“更好的选择”中，在我的应用程序中使用 global 可以将代码的执行速度提高 20%！

该代码用于处理 GPS 信号……所有定义 GPS 信号某些特征的函数都使用了许多参数。此外，还有许多嵌套函数和对这些函数的迭代调用。

将单个参数传递给函数可能比该函数访问全局变量要快一些。在我的例子中，每个函数访问它需要的 3 或 4 个全局变量比将所有 10 个参数一直传递到嵌套函数链要快得多。

使用全局变量 8.5 秒的 tic-toc 比使用参数传递或嵌套函数的 10.5 秒快。那么，坏主意？我要表演，谢谢。

我的观点？如果全局变量工作得更好，请使用全局变量。无论哪种方式都可以尝试...但是当您更改函数中的大数组时，该数组现在会在本地复制，而不仅仅是被引用。我宁愿查找一个全局然后制作一个 70MB 的副本。

在低级语言中，我同意尽可能避免使用全局变量……但这些语言提供指针和常量。MATLAB 并不是为真正知道如何编程和如何优化的人设计的。如果口译员没有为您优化；看来你是SOL。

# php - PHP数组拒绝将数字字符串视为数值

> ID：11677998
> 
> 赞同：-1
> 
> 时间：2012-07-26T21:01:57.657
> 
> 标签：php, xml, arrays, curl, var

我正在尝试将 PHP 数组输出转换为一个数字 PHP 变量，以便我可以对其进行算术运算，然后将其全局存储以在购物车中使用。

这是生成和操作数组的代码：

```
<?php
function ups($dest_zip,$service,$weight,$length,$width,$height) {
$AccessLicenseNumber = 'XXXXXXXXXXXXX'; // Your license number
$UserId = 'XXXXXXXX'; // Username
$Password = 'XXXXXXXX'; // Password
$PostalCode = 'XXXXXX'; // Zipcode you are shipping FROM
$ShipperNumber = 'XXXXX'; // Your UPS shipper number

    $data ="<?xml version=\"1.0\"?>
    <AccessRequest xml:lang=\"en-US\">
        <AccessLicenseNumber>$AccessLicenseNumber</AccessLicenseNumber>
        <UserId>$UserId</UserId>
        <Password>$Password</Password>
    </AccessRequest>
    <?xml version=\"1.0\"?>
    <RatingServiceSelectionRequest xml:lang=\"en-US\">
        <Request>
            <TransactionReference>
                <CustomerContext>Bare Bones Rate Request</CustomerContext>
                <XpciVersion>1.0001</XpciVersion>
            </TransactionReference>
            <RequestAction>Rate</RequestAction>
            <RequestOption>Rate</RequestOption>
        </Request>
    <PickupType>
        <Code>01</Code>
    </PickupType>
    <Shipment>
        <Shipper>
            <Address>
                <PostalCode>$PostalCode</PostalCode>
                <CountryCode>US</CountryCode>
            </Address>
        <ShipperNumber>$ShipperNumber</ShipperNumber>
        </Shipper>
        <ShipTo>
            <Address>
                <PostalCode>$dest_zip</PostalCode>
                <CountryCode>US</CountryCode>
            <ResidentialAddressIndicator/>
            </Address>
        </ShipTo>
        <ShipFrom>
            <Address>
                <PostalCode>$PostalCode</PostalCode>
                <CountryCode>US</CountryCode>
            </Address>
        </ShipFrom>
        <Service>
            <Code>$service</Code>
        </Service>
        <Package>
            <PackagingType>
                <Code>02</Code>
            </PackagingType>
            <Dimensions>
                <UnitOfMeasurement>
                    <Code>IN</Code>
                </UnitOfMeasurement>
                <Length>$length</Length>
                <Width>$width</Width>
                <Height>$height</Height>
            </Dimensions>
            <PackageWeight>
                <UnitOfMeasurement>
                    <Code>LBS</Code>
                </UnitOfMeasurement>
                <Weight>$weight</Weight>
            </PackageWeight>
        </Package>
    </Shipment>
    </RatingServiceSelectionRequest>";
    $ch = curl_init("https://www.ups.com/ups.app/xml/Rate");
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch,CURLOPT_POST,1);
    curl_setopt($ch,CURLOPT_TIMEOUT, 60);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, 0);
    curl_setopt ($ch, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($ch,CURLOPT_POSTFIELDS,$data);
    $result=curl_exec ($ch);        
   $upsout = (explode('USD', $result, 15));    
    $handling = $upsout[3];
   echo "<br><br>Shipping: $";
    echo $handling; 
   echo " USD<br><br>";       
   curl_close($ch);
   var_dump( $handling);
// print_r ($upsout);}?> 
```

$handling 的输出始终是 00.00 或 000.00 格式的数字，当然，零是数字。我真的需要它才能在算术函数中工作并能够存储以用作数字。

我知道它不起作用，因为如果我这样做

```
$test = $handling *2;
echo $test; 
```

我得到“0”作为输出，而不是 $handling 的两倍......

编辑：

如果我运行 var_dump(htmlentities($handling));

输出是：

字符串（222）“33.35”

如果我运行 var_dump($handling);

输出是

字符串（168）“33.35”

所以....我需要找到一种方法来解析这个数组条目中的垃圾，这样我就可以代数地操纵它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:45:27.400

我打赌你的字符串中有 HTML 标签，这就是你得到这个的原因`var_dump()`：

```
string(168) "33.35" 
```

第一个数字表示您的字符串长度为 168 个字符，而`33.35`占用 5 个字符。所以那里还有其他东西，不仅仅是一个数字。

其中一个解决方案会起作用，但我不能确定字符串的实际外观，所以我抛出了一堆想法。

```
$haystack0 = strip_tags( $haystack); 
echo '0\. ' . $haystack0 * 2; echo "<br />\n";

$haystack1 = trim( strip_tags( $haystack)); 
echo '1\. ' . $haystack1 * 2; echo "<br />\n";

preg_match( '/\b(\d+\.\d+)\b/', $haystack, $match);
$haystack2 = $match[1];
echo '2\. ' . $haystack2 * 2; echo "<br />\n";

$haystack3 = preg_replace( '/[^\d\.]+/', '', $haystack); 
echo '3\. ' . $haystack3 * 2; echo "<br />\n"; 
```

**编辑：**这是实际的字符串：

```
string(222) "</CurrencyCode><MonetaryValue>33.35</MonetaryValue></TotalCharges><GuaranteedDaysToDelivery/><ScheduledDeliveryTime/><RatedPackage><TransportationCharges><CurrencyCode>" 
```

所以，我们把它放入`$haystack`并去掉 XML 标签：

```
$haystack = "</CurrencyCode><MonetaryValue>33.35</MonetaryValue></TotalCharges><GuaranteedDaysToDelivery/><ScheduledDeliveryTime/><RatedPackage><TransportationCharges><CurrencyCode>";
$haystack = strip_tags( $haystack);
var_dump( $haystack); 
```

我们得到[输出](http://codepad.org/dQ7aklrP)：

```
 string(5) "33.35" 
```

所以，现在，我们可以将它乘以 2，[得到](http://codepad.org/6F1Fqg3S)：

```
 float(66.7) 
```

问题解决了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:03:50.877

我刚刚对此进行了测试并且工作正常，但是您会丢失十进制值：

```
<?php
$handling = '12.24';

echo intval($handling) * 2; // prints 24
echo floatval($handling) * 2; // prints 24.48

?> 
```

要解决您的问题，您应该使用 floatval() 函数包装 $handling：

```
<?php function ups($dest_zip,$service,$weight,$length,$width,$height)
    </RatingServiceSelectionRequest>";
    $ch = curl_init("https://www.ups.com/ups.app/xml/Rate");
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch,CURLOPT_POST,1);
    curl_setopt($ch,CURLOPT_TIMEOUT, 60);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, 0);
    curl_setopt ($ch, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($ch,CURLOPT_POSTFIELDS,$data);
    $result=curl_exec ($ch);        
    $upsout = (explode('USD', $result, 15));    
    $handling = floatval($upsout[3]);  // <--- recommend wrap here if you need to use variable later in math
    echo "<br><br>Shipping: $";
    echo $handling;
    echo " USD<br><br>";       
    curl_close($ch);
    // print_r ($upsout);}
 ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T21:10:00.280

**编辑：**再想一想，你确定你的示例代码与 $test 确实是这样发生的吗？ [类型杂耍](http://php.net/manual/en/language.types.type-juggling.php)应该允许您将字符串乘以一个数字并返回一个数字。如果您将示例代码的测试行更改为：

```
print "handling is $handling \n calculated value is $test"; 
```

**原文：**由于这似乎是您从 UPS 退回的成本，它很可能不是整数，因为会有美分（您提到该值是形式`00.00`或`000.00`似乎也证实了这一点）。

因此，您需要使用以下方法之一将其转换为浮点数：

```
$test = (float)$handling * 2;
$test2 = floatval($handling) * 2; 
```